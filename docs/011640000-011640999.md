# StackOverflow 问答 11640000-11640999

# iphone - 图片太多导致UIWebView在加载网页时闪白

> ID：11640000
> 
> 赞同：1
> 
> 时间：2012-07-24T22:02:30.827
> 
> 标签：iphone, ios, ios5, jquery-mobile, uiwebview

我们通过基本上将网站包装在 UIWebView 中来构建 iPhone 应用程序。我们没有使用 PhoneGap，只是一个 UIWebView 来加载使用 jQuery 和 jQuery Mobile 构建的移动应用程序。

如果我们一次显示两个以上的图像，网页会闪烁白色一秒钟。如果我们将加载的图片数量限制为两个，则没有flash，页面加载正常。

UIWebView 在图像中渲染超过 X MB 时是否有问题？

任何线索为什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T22:54:07.497

在 css 表中应用它可能更容易，因此它会影响您的所有 div 和图像。当我遇到离屏渲染问题时，我发现它对我很有帮助

```
 div, img {
    -webkit-transform:translateZ(0);    
 } 
```

编辑：

对于图像，将“src”更改为“data-src”，然后将此脚本添加到页脚，假设您正在运行 jquery：

```
$(document).ready(function() {
    $('img').each(function(){
        var $imgSrc = $(this).attr("data-src");
        $(this).attr("src", $imgSrc);
    });
}); 
```

这将使图像在原始正文代码加载后加载，这将花费不到一秒钟的时间，并且有望防止白色闪光问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T07:50:27.617

不知道为什么会这样，但是将页面高度限制在 460 像素（iPhone 应用程序）消除了闪光灯。也许与 JQM 和高度设置有些冲突？

# ms-access - 在表的字段名称中查找和替换数据

> ID：11640001
> 
> 赞同：3
> 
> 时间：2012-07-24T22:02:37.727
> 
> 标签：ms-access, replace, vba, ms-access-2010

我对 Access 2010 中的 VBA 非常陌生。我正在尝试更改表的字段名称中的值。以下是详细信息：

```
Table Name: WeeklySaleT
Field Name: SitusPreDirection 
```

SitusPreDirection 中的可能值：“E”“N”“S”“W”

希望更改以下“E”=“East”，“N”=“North”，“S”=“South”和“W”=“West”的每次出现

我将如何在 VBA 中做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T23:02:47.010

如果您不熟悉 VBA，最好使用查询。首先，复制您的表格。然后将表格添加到查询设计窗口中，从工具栏中选择更新查询并通过双击或拖动将 SitusPreDirection 添加到设计网格中。例如，将 Criteria 设置为 "E" "N" "S" "W" 之一，并将 Update To 设置为匹配值 "east"。

如果切换到 SQL 视图，您将看到如下内容：

```
UPDATE WeeklySaleT SET SitusPreDirection = "East" 
WHERE SitusPreDirection = "E" 
```

您可以像这样在 VBA 中使用它：

```
Dim db As Database
Set db = CurrentDB

sSQL = "UPDATE WeeklySaleT SET " _ 
      & "SitusPreDirection = ""East"" WHERE SitusPreDirection = ""E"""

db.Execute sSQL, dbFailOnError 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-25T02:25:05.953

使用路线查找表，您可以使用单个 UPDATE 查询。

`SitusPreDirection_lookup`：

```
SitusPreDirection long_name
E                 East
N                 North
S                 South
W                 West 
```

然后创建一个新查询，切换到 SQL 视图并粘贴到这个 UPDATE 语句中。您可以在 SQL、设计和数据表视图之间切换，以试验对查询设计的更改并查看这些更改的结果。

```
UPDATE WeeklySaleT
SET SitusPreDirection = DLookup("long_name",
    "SitusPreDirection_lookup", 
    "SitusPreDirection = '" & SitusPreDirection & "'") 
```

如果您不想创建查找表，可以使用[Switch Function](http://office.microsoft.com/en-us/access-help/switch-function-HA001228918.aspx)构建查询。然后，如果没有单独的表，您实际上将在查询中嵌入查找对。但我认为一张桌子更容易维护。考虑如果您需要将方向扩展到包括 NE、SE、SW 和 NW 会发生什么。使用表，您只需为每个查询添加一行，相同的查询将继续无缝工作。但是在查询中嵌入查找数据时，您需要修改查询的 SQL。

# magento - 如何找出链接名称以从“我的帐户”页面中删除链接？

> ID：11640005
> 
> 赞同：0
> 
> 时间：2012-07-24T22:02:47.733
> 
> 标签：magento, magento-1.7

我的第一个目标是从帐户仪表板中删除一些链接。我已经搜索过它并找到了一些解决方案。应用此：[从我的帐户中删除导航链接](https://stackoverflow.com/questions/5887664/remove-navigation-links-from-my-account)

它就像一个魅力，没有问题。

问题是如何找到正确的链接名称？

例如，我需要删除“我的标签”链接。那叫什么名字？尝试了一些变化并且“标签”有效。

但找不到“我的应用程序”的任何解决方案。

有这种链接名称的列表吗？

谢谢，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T12:01:11.440

这不是最好的方法，但它有效：

打开文件/app/design/frontend/your/theme/template/customer/account/navigation.php

插入这一行：

```
<?php unset($_links['OAuth Customer Tokens']); ?> 
```

在这一行之后：

```
<?php $_links = $this->getLinks(); ?> 
```

所以这里的结果：

```
<div class="block-content">
<ul>
<?php $_links = $this->getLinks(); ?>
<?php unset($_links['OAuth Customer Tokens']); ?>
<?php $_index = 1; ?>
<?php $_count = count($_links); ?> 
```

在此页面中，数组 $_links 有一个“for”循环，我只是删除了“我的应用程序”链接的对象。

干杯

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-10-22T14:18:10.303

我知道我参加聚会有点晚了，但我希望这会有所帮助。您可以在此处找到有关链接名称以及如何删除它们的一些有用信息：http: [//www.kerstner.at/en/2014/08/remove-customer-account-navigation-links-in-magento/](http://www.kerstner.at/en/2014/08/remove-customer-account-navigation-links-in-magento/)

我的帐户链接的具体名称是：

*   我的账号：账号
*   帐户编辑：account_edit
*   地址簿：address_book
*   我的订单：订单
*   我的标签：标签
*   我的愿望清单：愿望清单
*   我的应用程序：OAuth 客户令牌
*   重复配置文件：recurring_profiles
*   计费协议：billing_agreements
*   我的可下载产品：downloadable_products
*   我的评论：评论
*   我的邀请：邀请
*   时事通讯订阅：时事通讯
*   注销：注销

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-26T12:12:31.023

您可以使用 IDE（例如 Eclipse PHP）并搜索特定文本。我相信你会得到你的搜索结果。之后，您只需要删除/修改文本。

希望，这个技巧可以帮助你。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-06-17T07:21:07.587

我通过使用扩展来实现这一点。[前端链接管理器](http://www.magentocommerce.com/magento-connect/MagePsycho/extension/7905/frontend_links_manager)扩展用于打开/关闭前端链接（顶部链接、页脚链接、客户）。

明显的好处是不需要使用此解决方案编辑核心文件。

但是，如上所述，这不会删除“我的应用程序”链接。为了使用此应用程序删除我的应用程序，您需要做 3 件事。

1.  修改 app\design\frontend[your theme]e\layout\xmllinks.xml 并添加 `<action method="removeLinkByName" ifconfig="xmllinks/customer_navigation/my_applications"><name>OAuth Customer Tokens</name></action>` 到 customer_account 下

2.  修改 app\code\local\MagePsycho\Xmllinks\etc\system.xml 并添加到 my_wishlist 下面

    ```
    <label>My Applications</label>

    <frontend_type>select</frontend_type>

    <source_model>xmllinks/system_config_source_yesno</source_model>

    <sort_order>105</sort_order>

    <show_in_default>1</show_in_default>

    <show_in_website>1</show_in_website>

    <show_in_store>1</show_in_store>

    </my_applications> 
    ```

3.  最后向数据库中的 core_config_data 表添加一条记录。只需复制 my_wishlist 记录并插入新记录并将 my_wishlist 更改为 my_applications

    清除缓存、注销、登录和禁用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-31T09:17:37.247

如果您想删除标签和我的可下载产品，只需添加以下行：

> 未设置（$_links['tags']）；
> 
> 未设置（$_links['downloadable_products']）；

再见

# ruby-on-rails - 在 /lib 目录中访问 Rails 模块的问题

> ID：11640008
> 
> 赞同：0
> 
> 时间：2012-07-24T22:03:10.733
> 
> 标签：ruby-on-rails, ruby-on-rails-3, autoload

我在这里发现了很多类似的问题，但没有一个答案能解决我的问题。

在 /user/2 加载我的页面时出现以下错误

```
NoMethodError in User_data#data

Showing /Users/Jimmy/Documents/Launchpad Toys/LPT_Repositories/orbit-analytics/app/views/user_data/data.erb where line #108 raised:

undefined method `<' for nil:NilClass

Extracted source (around line #108):

105:            </div>
106:       </div>
107:       
108:       <% if @videos_number < 1 %><p style="font-size: 18px; margin-top: 25px;">This user has no approved videos.</p>
109:       
110:       <% else %>
111: 
```

此错误是由控制器为我在视图中调用的任何和所有实例变量返回空值引起的。

这是相关控制器的开头：

```
class UserDataController < ApplicationController

    require 'analytics_helper'

    include AnalyticsHelper

    def data

        require "date"

        @user_id = params[:user_id] 
```

该错误似乎是由于控制器未能找到位于 lib/analytics_helper.rb 的模块 AnalyticsHelper 引起的。这是模块的开头：

```
Module AnalyticsHelper

    # Average analytics calculations for a given set of videos

    def analytics_tracker(video_ids)        
        total_likes, total_views, total_flags, total_days_visible = 0, 0, 0, 0
        total_characters, total_unique_characters, total_recurring_characters, total_custom_characters, total_custom_backgrounds = 0, 0, 0, 0, 0
        total_energy_level, total_emotions, total_scenes, total_duration = 0, 0, 0, 0 
```

我取消了 application.rb 中自动加载 Rails 3 /lib 目录中文件的行的注释：

```
config.autoload_paths += %W(#{config.root}/lib) 
```

我知道这个问题是由模块无法加载引起的，但我找到的解决方案都没有帮助我解决我的问题。任何帮助表示赞赏。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T22:38:35.253

`module``analytics_helper.rb`文件开头不应大写。尝试：

```
 module AnalyticsHelper
      # ...
    end 
```

# javascript - 通过 xmlhttprequest 提交带有重音字符的表单

> ID：11640010
> 
> 赞同：0
> 
> 时间：2012-07-24T22:03:23.190
> 
> 标签：javascript, html, xmlhttprequest, form-data

我实现了这个使用 xmlhttpreqeust 的表单提交方法。我看到了新的 html5 功能 FormData，它允许将文件与表单一起提交。凉爽的！但是，重音字符存在问题，特别是 Word 制作的那些愚蠢的智能引号（是的，我对这些字符有点偏见）。我曾经让它提交给一个隐藏的 iframe，这是老式的方式，而且我从来没有对放入其中的各种奇怪的字符有任何问题。但我认为这会更好。事实证明这是一个更大的头痛：-/

让我们看一下代码。我的 javascript 函数（注意注释掉的行）：

```
var xhr = new XMLHttpRequest();
var fd = new FormData(form);

xhr.addEventListener("error", uploadFailed, false);
xhr.addEventListener("abort", uploadCanceled, false);
xhr.addEventListener("load", uploadComplete, false); 

xhr.open($(form).attr('method'), $(form).attr('action'));

//xhr.setRequestHeader("Content-Type", "application/x-www-form-urlencoded; charset=ISO-8859-1");
xhr.send(fd); 
```

这是一个简短的视图，请查看[http://archive.cyark.org/sitemanager/sitemanager.js](http://archive.cyark.org/sitemanager/sitemanager.js)的第 1510 行以查看整个函数。

然后在接收 php 页面上，我在顶部：

```
header('Content-Type: text/html; charset=ISO-8859-1'); 
```

接下来是一些基本的 php 以使用帖子数据构建一个字符串并将其作为更新提交给 mysql。

那我该怎么办？如果我取消注释 javascript 中的内容类型设置，它会完全破坏我的 php 脚本中的 POST 数据。我不知道问题出在 javascript、php 还是 mysql 中。有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T22:52:39.107

编码问题有时很难调试。简而言之，最好的解决方案是在*任何地方都*使用 UTF8 作为编码。也就是说，*应用程序堆栈的每个组件*。

您的页面似乎以 ISO-LATIN-1（通过您的网络服务器的 HTTP 标头发送）形式交付，这导致浏览器使用 latin1 或某些 Windows 等效项，例如 windows-1252，即使您的 HTML 的 HEAD 中可能有 META 元素告诉用户代理使用 UTF8。HTTP 标头优先。检查您的其他文件格式（尤其是 .js）的交付是否为 UTF8。如果在将所有与客户端相关的内容（HTML、JS、XHR 等）配置为使用 UTF8 后问题仍然存在，则必须开始检查服务器端是否存在问题。

这可能包括一些简单的问题，例如 PHP 文件不是正确的 UTF8（我想说在 linux 服务器上不太可能），但通常包括 mysql 配置（服务器和客户端）、数据库和表默认编码（和排序规则）以及正确的问题连接设置。问题也可能是由不正确的 PHP ini 或 mbstring 配置设置引起的。

示例（不完整；这里使用 mysql 作为常见的数据库示例）：

MySQL 配置

```
[mysqld]
default_character_set = utf8
character_set_client = utf8
character_set_server  = utf8
[client]
default_character_set = utf8 
```

请注意，这些设置对于 mysql 5.1 和 5.5 版本是不同的，并且在使用错误的变量时可能会阻止 mysqld 启动。请参阅[http://dev.mysql.com/doc/refman//5.5/en/server-system-variables.html](http://dev.mysql.com/doc/refman//5.5/en/server-system-variables.html)和[http://dev.mysql.com/doc/refman/5.1/en/server-system- variables.html](http://dev.mysql.com/doc/refman/5.1/en/server-system-variables.html)了解详情。

您可以通过 CLI 检查您的 mysql 变量：

```
mysql> SHOW VARIABLES LIKE '%char%';
Variable_name Value
character_set_client utf8
character_set_connection utf8
character_set_database utf8
character_set_filesystem binary
character_set_results utf8
character_set_server utf8
character_set_system utf8 
```

创建数据库和表时，尝试使用类似的东西

```
CREATE DATABASE $db /*!40100 DEFAULT CHARACTER SET utf8 */ 
```

PHP.ini 设置（应该已经是默认设置）：

```
default_charset = "utf-8" 
```

PHP 的 MB-String 扩展默认使用 latin1，如果使用应该重新配置：

```
[mbstring]
mbstring.internal_encoding = UTF-8
mbstring.http_output = UTF-8
...some more perhaps... 
```

网络服务器设置（以 Apache 为例，也适用于其他服务器）：

```
# httpd.conf
AddDefaultCharset UTF-8 
```

PHP 源代码可能会使用以下*标头*设置：

```
header('Content-type: text/html; charset=UTF-8'); 
```

外壳（bash）设置：

```
# ~/.profile
export LC_CTYPE=en_US.UTF-8
export LANG=en_US.UF-8 
```

此处列出的上述列表只是为了提示您在某些情况下可能会遇到哪些陷阱。您使用的 Web 堆栈的每个组件都必须能够使用 UTF8，并且应该正确配置才能这样做。尽管如此，通常一个简单正确的 UTF8 HTTP 标头就足以解决大多数问题。祝你好运！:-)

# join - 内连接限制为一行

> ID：11640012
> 
> 赞同：1
> 
> 时间：2012-07-24T22:03:39.677
> 
> 标签：join

我有两个表 t1 和 t2。

t1 有字段`position`

t2 有字段`start`&`stop`

我的内部连接如下：

```
select  t1.* 
from    t1 inner join t2 on t1.position >= t2.start AND t1.Pos <= t2.stop 
```

比如说：

*   `t1.position`= 8中的记录之一
*   t2 中有两条记录`t2.start = 1`和`t2.end = 15`; 并且`t2.start = 5`和`t2.end = 10`

我的查询将返回两行，分别为 1 < 8 < 15 和 5 < 8 < 10。

我想要的只是第一行？

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T22:12:23.850

```
select t1.* from t1
inner join t2 
on t1.position >= t2.start 
AND t1.Pos <= t2.stop
LIMIT 1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T22:13:57.330

您可以对结果集执行不同的操作，也可以先使用内部查询。如果您正在处理小型数据集，我会使用不同的，否则使用内部查询。

清楚的：

```
select distinct t1.* from t1 inner join t2 on t1.position >= t2.start AND t1.Pos <= t2.stop 
```

内部查询：

```
select t1.*
from t1
inner join
(
    select t1.position
    from t1
    inner join t2 on t1.position >= t2.start
        AND t1.position <= t2.stop
) t2 on t2.position = t1.position 
```

# fgetcsv - fgetcsv 的问题

> ID：11640014
> 
> 赞同：1
> 
> 时间：2012-07-24T22:03:52.617
> 
> 标签：fgetcsv

我有一个包含 2 列值的 csv excel 文件：纬度和经度。我需要分别访问每个单独的纬度和经度值。

但我什至无法将 csv 文件正确读入数组。由于我使用的是mac，我开始使用：

```
ini_set("auto_detect_line_endings", true);  
$handle = fopen("countlook.csv", "r");
$data = fgetcsv($handle, 100000, ","); 
```

它只返回第一行（列标题）“纬度，经度”，没有任何实际值。

不知道我哪里错了。任何建议都会非常受欢迎。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-25T19:46:20.820

`fgetcsv`逐行读取文件，因此将其放入循环中以获取所有数据很重要。

```
$headers = array();
$rows = array();
$c = 0;
while ($data = fgetcsv($handle, 0, ",")) {

        if ($c == 0) {
            $headers = $data;

        } else {
            $rows[] = $data;
        }

       $c ++;
    }
fclose($handle); 
```

您现在应该在 headers 变量中拥有标题，并且在 rows 变量中拥有所有数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-26T14:18:43.277

尝试以下操作：

```
if (($handle = fopen($_FILES["file"]["tmp_name"], "r")) !== FALSE) {
    $data = array();
    while (($rawdata = fgetcsv($handle, 0, $delimiter)) !== FALSE) {
         for ($i=0; $i < count($rawdata); $i++) {
              $data[$i][] = trim($rawdata[$i]);
         }
    }
    fclose($handle);
    var_dump($data)
} 
```

# c# - 右括号 Visual Studio

> ID：11640015
> 
> 赞同：0
> 
> 时间：2012-07-24T22:03:59.113
> 
> 标签：c#, visual-studio, visual-studio-2008

我正在使用 C# 编程语言在 Visual Studio 2008 中工作。我遇到了一个大问题，因为当我打开一个括号时，Visual Studio 不会像往常一样自动关闭它。我在包含许多括号（if else/for）的大方法中遇到了很大的困难。

很感谢任何形式的帮助！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-24T22:08:46.207

一个好的策略是先成对输入括号：

```
public void foo()
{
} 
```

然后添加内容：

```
public void foo(List<int> values)
{
     foreach ()
     {
     }
} 
```

有一些键盘快捷键可以让您更快地执行此操作。尝试键入`foreach`，然后按`Tab`两次。

如果您仍然感到困惑，那可能是因为您的方法太长了。您可以将代码重构为更小的方法。使用“提取方法”重构工具来帮助您做到这一点。

您可能还想偶尔“格式化文档”。这将为您排列大括号，并缩进您的代码。这将使哪些大括号匹配更明显。

您可能还需要考虑安装第三方扩展，例如[Resharper](http://www.jetbrains.com/resharper/)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-24T22:08:45.737

你试过[生产力电动工具](http://visualstudiogallery.msdn.microsoft.com/d0d33361-18e2-46c0-8ff2-4adea1e34fef/)吗？看起来他们在 10.0.10710.22 中添加了自动大括号完成。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-24T22:09:25.523

我建议您安装[Productivity Power Tools](http://visualstudiogallery.msdn.microsoft.com/d0d33361-18e2-46c0-8ff2-4adea1e34fef/)或[Resharper](http://www.jetbrains.com/resharper/)。这两个扩展都支持这一点。

# c++ - 什么是一个好的、优化的 C/C++ 算法，用于将 24 位位图转换为带抖动的 16 位？

> ID：11640017
> 
> 赞同：8
> 
> 时间：2012-07-24T22:03:59.813
> 
> 标签：c++, c, bitmap, gdi+, dithering

我一直在寻找一种优化（即快速）算法，该算法使用抖动将 24 位 RGB 位图转换为 16 位 (RGB565) 位图。我正在寻找 C/C++ 中的一些东西，我可以在其中实际控制如何应用抖动。GDI+ 似乎提供了一些方法，但我不知道它们是否抖动。而且，如果他们做抖动，他们使用什么机制（弗洛伊德-斯坦伯格？）

有没有人有一个很好的使用抖动进行位图颜色深度转换的例子？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-07-03T02:29:48.390

我建议使用**有序抖动**（[http://en.wikipedia.org/wiki/Ordered_dithering](http://en.wikipedia.org/wiki/Ordered_dithering)），因为**Floyd-Steinberg** *需要更多的处理*和计算，并且只适用于静止图像/不适用于动画或显示器上的常量更改.

我创建了我自己的优化有序抖动，从 24/32 位 RGB 颜色到 16 位 RGB565 颜色，将阈值分成子像素（在我的[AROMA 项目](https://github.com/amarullz/AROMA-Installer)中使用）。它比 Floyd-Steinberg 快得多，因为没有昂贵的计算（特别是**没有乘法和 div 计算**），并且能够用于动画，因为它使用了固定的门槛。

它的质量也比维基上定义的有序抖动算法好得多。

**这是抖动结果的示例：**

![在此处输入图像描述](../Images/b846643e00fbabc34c25ecdfc5fed6b6.png)

**这里是来源。享受！**

```
/* Dither Tresshold for Red Channel */
static const BYTE dither_tresshold_r[64] = {
  1, 7, 3, 5, 0, 8, 2, 6,
  7, 1, 5, 3, 8, 0, 6, 2,
  3, 5, 0, 8, 2, 6, 1, 7,
  5, 3, 8, 0, 6, 2, 7, 1,

  0, 8, 2, 6, 1, 7, 3, 5,
  8, 0, 6, 2, 7, 1, 5, 3,
  2, 6, 1, 7, 3, 5, 0, 8,
  6, 2, 7, 1, 5, 3, 8, 0
};

/* Dither Tresshold for Green Channel */
static const BYTE dither_tresshold_g[64] = {
  1, 3, 2, 2, 3, 1, 2, 2,
  2, 2, 0, 4, 2, 2, 4, 0,
  3, 1, 2, 2, 1, 3, 2, 2,
  2, 2, 4, 0, 2, 2, 0, 4,

  1, 3, 2, 2, 3, 1, 2, 2,
  2, 2, 0, 4, 2, 2, 4, 0,
  3, 1, 2, 2, 1, 3, 2, 2,
  2, 2, 4, 0, 2, 2, 0, 4
};

/* Dither Tresshold for Blue Channel */
static const BYTE dither_tresshold_b[64] = {
  5, 3, 8, 0, 6, 2, 7, 1,
  3, 5, 0, 8, 2, 6, 1, 7,
  8, 0, 6, 2, 7, 1, 5, 3,
  0, 8, 2, 6, 1, 7, 3, 5,

  6, 2, 7, 1, 5, 3, 8, 0,
  2, 6, 1, 7, 3, 5, 0, 8,
  7, 1, 5, 3, 8, 0, 6, 2,
  1, 7, 3, 5, 0, 8, 2, 6
};

/* Get 16bit closest color */
BYTE closest_rb(BYTE c) { 
  return (c >> 3 << 3); /* red & blue */
}
BYTE closest_g(BYTE c) {
  return (c >> 2 << 2); /* green */
}

/* RGB565 */
WORD RGB16BIT(BYTE r, BYTE g, BYTE b) {
  return ((WORD)((r>>3)<<11)|((g>>2)<<5)|(b>>3));
}

/* Dithering by individual subpixel */
WORD dither_xy(
  int x, 
  int y, 
  BYTE r, 
  BYTE g, 
  BYTE b
){
  /* Get Tresshold Index */
  BYTE tresshold_id = ((y & 7) << 3) + (x & 7);

  r = closest_rb(
          MIN(r + dither_tresshold_r[tresshold_id], 0xff)
       );
  g = closest_g(
          MIN(g + dither_tresshold_g[tresshold_id], 0xff)
       );
  b = closest_rb(
          MIN(b + dither_tresshold_b[tresshold_id], 0xff)
       );
  return RGB16BIT(r, g, b);
}

/* Dithering Pixel from 32/24bit RGB 
 *
 * GetR, GetG, GetB -> Function to get individual color in pixel
 *
 */
WORD dither_color_xy(int x, int y, DWORD col) {
  return dither_xy(x, y, GetR(col), GetG(col), GetB(col));
}

/* EXAMPLES */
void ExampleDither1(WORD * dest, DWORD * src, int width, int height){
  int x, y;
  for (y=0; y<height; y++){
    for (x=0; x<width; x++){
      int pos = y * width + x;
      dest[pos] = dither_color_xy(x,y,src[pos]);
    }
  }
}
void ExampleDither2(WORD * dest, BYTE * src, int width, int height){
  int x, y;
  for (y=0; y<height; y++){
    for (x=0; x<width; x++){
      int pos = y * width + x;
      dest[pos] = dither_xy(x,y,src[pos*3],src[pos*3+1],src[pos*3+2]);
    }
  }
} 
```

另一个结果（Top 24bit - Bottom Ordered RGB565-16bit）： ![在此处输入图像描述](../Images/727c09863ef3af9375eec1af6b1b8a2a.png) [查看全分辨率图像](https://i.stack.imgur.com/M1X4K.png)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-25T13:27:29.537

正如您所提到的，Floyd-Steinberg 抖动方法很受欢迎，因为它简单快速。对于 24 位和 16 位颜色之间的细微差别，结果在视觉上几乎是最佳的。

有人建议我使用示例图片[Lena](http://en.wikipedia.org/wiki/Lenna)，但我决定不这样做；尽管它作为测试图像的历史悠久，但我认为它对于现代情感来说过于性别歧视。相反，我展示了我自己的照片。首先是原始的，然后转换为抖动的 RGB565（并转换回 24 位进行显示）。

![原来的](../Images/072597c4bd8b52ffea57b56ff26769b8.png) ![Floyd-Steinberg 抖动 RGB565](../Images/8cdd4316c6cf3176d2c828f972c9dc7b.png)

以及 C++ 中的代码：

```
inline BYTE Clamp(int n)
{
    n = n>255 ? 255 : n;
    return n<0 ? 0 : n;
}

struct RGBTriplet
{
    int r;
    int g;
    int b;
    RGBTriplet(int _r = 0, int _g = 0, int _b = 0) : r(_r), g(_g), b(_b) {};
};

void RGB565Dithered(const BYTE * pIn, int width, int height, int strideIn, BYTE * pOut, int strideOut)
{
    std::vector<RGBTriplet> oldErrors(width + 2);
    for (int y = 0;  y < height;  ++y)
    {
        std::vector<RGBTriplet> newErrors(width + 2);
        RGBTriplet errorAhead;
        for (int x = 0;  x < width;  ++x)
        {
            int b = (int)(unsigned int)pIn[3*x] + (errorAhead.b + oldErrors[x+1].b) / 16;
            int g = (int)(unsigned int)pIn[3*x + 1] + (errorAhead.g + oldErrors[x+1].g) / 16;
            int r = (int)(unsigned int)pIn[3*x + 2] + (errorAhead.r + oldErrors[x+1].r) / 16;
            int bAfter = Clamp(b) >> 3;
            int gAfter = Clamp(g) >> 2;
            int rAfter = Clamp(r) >> 3;
            int pixel16 = (rAfter << 11) | (gAfter << 5) | bAfter;
            pOut[2*x] = (BYTE) pixel16;
            pOut[2*x + 1] = (BYTE) (pixel16 >> 8);
            int error = r - ((rAfter * 255) / 31);
            errorAhead.r = error * 7;
            newErrors[x].r += error * 3;
            newErrors[x+1].r += error * 5;
            newErrors[x+2].r = error * 1;
            error = g - ((gAfter * 255) / 63);
            errorAhead.g = error * 7;
            newErrors[x].g += error * 3;
            newErrors[x+1].g += error * 5;
            newErrors[x+2].g = error * 1;
            error = b - ((bAfter * 255) / 31);
            errorAhead.b = error * 7;
            newErrors[x].b += error * 3;
            newErrors[x+1].b += error * 5;
            newErrors[x+2].b = error * 1;
        }
        pIn += strideIn;
        pOut += strideOut;
        oldErrors.swap(newErrors);
    }
} 
```

我不能保证这段代码是完美的，我已经不得不修复我在另一条评论中提到的那些细微错误。但是它确实产生了上述结果。它采用 Windows 使用的 BGR 顺序中的 24 位像素，并以小端顺序生成 R5G6B5 16 位像素。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-24T22:19:50.667

**弗洛伊德-斯坦伯格抖动**

```
for each y from top to bottom
   for each x from left to right
      oldpixel := pixel[x][y]
      newpixel := find_closest_palette_color(oldpixel)
      pixel[x][y] := newpixel
      quant_error := oldpixel - newpixel
      pixel[x+1][y] := pixel[x+1][y] + 7/16 * quant_error
      pixel[x-1][y+1] := pixel[x-1][y+1] + 3/16 * quant_error
      pixel[x][y+1] := pixel[x][y+1] + 5/16 * quant_error
      pixel[x+1][y+1] := pixel[x+1][y+1] + 1/16 * quant_error 
```

我敢打赌，你可以轻松实现这一点！

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2021-06-30T10:20:46.427

这是我使用 16x16 矩阵进行有序（拜耳）抖动的代码。它产生每像素输出 15 位。输入和输出都是每像素 3 个字节。输出使用 32 个值，缩放到范围 0..255 以进行可视化。您可以通过替换以下 3 行轻松更改输出：

```
pixels[x * 3 + 0]   = i1 * 8;
pixels[x * 3 + 1]   = i2 * 8;
pixels[x * 3 + 2]   = i3 * 8; 
```

该代码针对速度进行了优化，可用于实时处理。

左图是原图，右图是抖动的。 [![拜耳抖动 15bpp 颜色](../Images/f977389c8dd861f4ef34532977db2393.png)](https://i.stack.imgur.com/rHah0.png)

这是代码：

```
#ifndef MIN
#define MIN(a,b)            (((a) < (b)) ? (a) : (b))
#endif

#ifndef MAX
#define MAX(a,b)            (((a) > (b)) ? (a) : (b))
#endif

#ifndef CLAMP
//  This produces faster code without jumps
#define     CLAMP( x, xmin, xmax )      (x) = MAX( (xmin), (x) );   \
                                        (x) = MIN( (xmax), (x) )
#endif

const   int BAYER_PATTERN_16X16[16][16] =   {   //  16x16 Bayer Dithering Matrix.  Color levels: 256
                                                {     0, 191,  48, 239,  12, 203,  60, 251,   3, 194,  51, 242,  15, 206,  63, 254  }, 
                                                {   127,  64, 175, 112, 139,  76, 187, 124, 130,  67, 178, 115, 142,  79, 190, 127  },
                                                {    32, 223,  16, 207,  44, 235,  28, 219,  35, 226,  19, 210,  47, 238,  31, 222  },
                                                {   159,  96, 143,  80, 171, 108, 155,  92, 162,  99, 146,  83, 174, 111, 158,  95  },
                                                {     8, 199,  56, 247,   4, 195,  52, 243,  11, 202,  59, 250,   7, 198,  55, 246  },
                                                {   135,  72, 183, 120, 131,  68, 179, 116, 138,  75, 186, 123, 134,  71, 182, 119  },
                                                {    40, 231,  24, 215,  36, 227,  20, 211,  43, 234,  27, 218,  39, 230,  23, 214  },
                                                {   167, 104, 151,  88, 163, 100, 147,  84, 170, 107, 154,  91, 166, 103, 150,  87  },
                                                {     2, 193,  50, 241,  14, 205,  62, 253,   1, 192,  49, 240,  13, 204,  61, 252  },
                                                {   129,  66, 177, 114, 141,  78, 189, 126, 128,  65, 176, 113, 140,  77, 188, 125  },
                                                {    34, 225,  18, 209,  46, 237,  30, 221,  33, 224,  17, 208,  45, 236,  29, 220  },
                                                {   161,  98, 145,  82, 173, 110, 157,  94, 160,  97, 144,  81, 172, 109, 156,  93  },
                                                {    10, 201,  58, 249,   6, 197,  54, 245,   9, 200,  57, 248,   5, 196,  53, 244  },
                                                {   137,  74, 185, 122, 133,  70, 181, 118, 136,  73, 184, 121, 132,  69, 180, 117  },
                                                {    42, 233,  26, 217,  38, 229,  22, 213,  41, 232,  25, 216,  37, 228,  21, 212  },
                                                {   169, 106, 153,  90, 165, 102, 149,  86, 168, 105, 152,  89, 164, 101, 148,  85  }
                                            };

//  Color ordered dither using 15 bits per pixel (5 bit per color plane)
void    makeDitherBayerRgb15bpp( BYTE* pixels, int width, int height )  noexcept
{
    for( int y = 0; y < height; y++ )
    {
        int row = y & 15;   //  y % 16

        for( int x = 0; x < width; x++ )
        {
            int col = x & 15;   //  x % 16

            const int   t       = BAYER_PATTERN_16X16[col][row];
            const int   corr    = (t / 31);

            const int   blue    = pixels[x * 3 + 0];
            const int   green   = pixels[x * 3 + 1];
            const int   red     = pixels[x * 3 + 2];

            int i1  = (blue  + corr) / 8;       CLAMP( i1, 0, 31 );
            int i2  = (green + corr) / 8;       CLAMP( i2, 0, 31 );
            int i3  = (red   + corr) / 8;       CLAMP( i3, 0, 31 );

            pixels[x * 3 + 0]   = i1 * 8;   // Scale blue  back to 0..255
            pixels[x * 3 + 1]   = i2 * 8;   // Scale green back to 0..255
            pixels[x * 3 + 2]   = i3 * 8;   // Scale red   back to 0..255
        }

        pixels  += width * 3;
    }
} 
```

您可以查看这篇文章以获取更多抖动算法：

[抖动实现和演示](https://www.codeproject.com/Articles/5259216/Dither-Ordered-and-Floyd-Steinberg-Monochrome-Colo)

# ruby-on-rails - 正在发送错误的查询，电子邮件为空

> ID：11640018
> 
> 赞同：1
> 
> 时间：2012-07-24T22:04:05.410
> 
> 标签：ruby-on-rails, activerecord

我正在尝试将新用户添加到现有数据库。每当我为此使用注册表单时，它都会导致查找电子邮件为 NULL 的用户。

```
(0.1ms)  begin transaction
User Exists (0.1ms)  SELECT 1 AS one FROM "users" WHERE "users"."email" IS NULL LIMIT 1
(0.1ms)  rollback transaction 
```

查看服务器日志，它实际上说明了有效的电子邮件地址：

```
Parameters: {"utf8"=>"✓",
"authenticity_token"=>"epYmQoIfibeimZEFYo5MdSIqjJM3sLZgTtj79rMpvyQ=", "user"=>
 {"name"=>"Herp Derp", "email"=>"lang.martin@herpderp.de", "password"=>"[FILTERED]",      
 "password_confirmation"=>"[FILTERED]"}, "commit"=>"Create User"} 
```

user.rb 看起来像这样：

```
class User < ActiveRecord::Base
  attr_accessible :name, :email, :password, :password_confirmation
  has_secure_password

  before_save { |user| user.email = email.downcase }

  validates :name, presence: true,
                   length: {maximum: 40}

  VALID_EMAIL_REGEX = /\A[\w+\-.]+@[a-z\d\-.]+\.[a-z]+\z/i
  validates :email, presence: true,
          format: { with: VALID_EMAIL_REGEX },
          uniqueness: { case_sensitive: false }

  validates :password, length: {minimum: 6}
  validates :password_confirmation, presence: true
end 
```

输入表格如下：（使用Formtastic）

```
%h1 Sign Up
%div.row
  %div.span6.offset3
    = semantic_form_for @user do |f|
      = f.inputs do
        = f.input :name
        = f.input :email
        = f.input :password
        = f.input :password_confirmation
        = f.action :submit 
```

用户控制器.rb

```
 def create
    @user = User.new(params[:users])
    if @user.save
      redirect_to @user
    else
      render 'new'
    end
  end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T00:01:42.823

我实际上发现了错误：

```
def create
   @user = User.new(params[:users])
  if @user.save
  redirect_to @user
else
  render 'new'
end 
```

参数更改为 :user 并完成。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T22:19:20.573

您是否尝试在 rails 控制台（rails s）中创建新用户？

# ios - iOS - 串行通信集成到 Xcode 项目中

> ID：11640024
> 
> 赞同：2
> 
> 时间：2012-07-24T22:05:15.490
> 
> 标签：ios, xcode, serial-port

好的，所以我找到了访问 iPhone 上的串行端口的[教程](http://devdot.wikispaces.com/Iphone+Serial+Port+Tutorial)。我通过创建一个`Serial.c`文件将代码合并到我的 Xcode 项目中。现在如何将串行通信的 get 输出转换为`textview`? 我的 Xcode 项目可以在[这里找到](http://www.chrisrjones.com/files/KegCop-Test.zip)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T23:46:55.453

我认为如果没有串行电缆另一端的 Apple 安全协处理器，这是不可能的。为了让 iOS 设备开始与配件通信，配件必须具有安全协处理器。

您可能想查看具有 Apple 要求的身份验证芯片的[Redpark](http://redpark.com/c2db9.html)串行电缆。这对于原型设计或黑客攻击将是一个很好的解决方案。

# java - 如何使用 Java HttpServer/HttpExchange 在 GET 中获取查询字符串？

> ID：11640025
> 
> 赞同：26
> 
> 时间：2012-07-24T22:05:21.910
> 
> 标签：java, get, query-string, httpserver

我正在尝试在 Java 中创建一个简单的 HttpServer 来处理 GET 请求，但是当我尝试获取请求的 GET 参数时，我注意到 HttpExchange 类没有相应的方法。

有人知道读取 GET 参数（查询字符串）的简单方法吗？

这就是我的处理程序的样子：

```
public class TestHandler{
  @Override
  public void handle(HttpExchange exc) throws IOxception {
    String response = "This is the reponse";
    exc.sendResponseHeaders(200, response.length());

    // need GET params here

    OutputStream os = exc.getResponseBody();
    os.write(response.getBytes());
    os.close();
  } 
} 
```

..和主要方法：

```
public static void main(String[] args) throws Exception{
  // create server on port 8000
  InetSocketAddress address = new InetSocketAddress(8000);
  HttpServer server = new HttpServer.create(address, 0);

  // bind handler
  server.createContext("/highscore", new TestHandler());
  server.setExecutor(null);
  server.start();
} 
```

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2013-07-04T14:08:58.077

以下：`httpExchange.getRequestURI().getQuery()`

将以类似于以下格式返回字符串：`"field1=value1&field2=value2&field3=value3..."`

所以你可以简单地自己解析字符串，这就是解析函数的样子：

```
public Map<String, String> queryToMap(String query) {
    if(query == null) {
        return null;
    }
    Map<String, String> result = new HashMap<>();
    for (String param : query.split("&")) {
        String[] entry = param.split("=");
        if (entry.length > 1) {
            result.put(entry[0], entry[1]);
        }else{
            result.put(entry[0], "");
        }
    }
    return result;
} 
```

这就是您可以使用它的方式：

```
Map<String, String> params = queryToMap(httpExchange.getRequestURI().getQuery()); 
System.out.println("param A=" + params.get("A")); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-01-12T10:32:26.963

与 annon01 的答案相反，这个答案正确地解码了键和值。它不使用`String.split`，而是使用 扫描字符串`indexOf`，这样更快。

```
public static Map<String, String> parseQueryString(String qs) {
    Map<String, String> result = new HashMap<>();
    if (qs == null)
        return result;

    int last = 0, next, l = qs.length();
    while (last < l) {
        next = qs.indexOf('&', last);
        if (next == -1)
            next = l;

        if (next > last) {
            int eqPos = qs.indexOf('=', last);
            try {
                if (eqPos < 0 || eqPos > next)
                    result.put(URLDecoder.decode(qs.substring(last, next), "utf-8"), "");
                else
                    result.put(URLDecoder.decode(qs.substring(last, eqPos), "utf-8"), URLDecoder.decode(qs.substring(eqPos + 1, next), "utf-8"));
            } catch (UnsupportedEncodingException e) {
                throw new RuntimeException(e); // will never happen, utf-8 support is mandatory for java
            }
        }
        last = next + 1;
    }
    return result;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-08-31T09:10:06.533

基于@anon01 的回答，这是在 Groovy 中的操作方法：

```
Map<String,String> getQueryParameters( HttpExchange httpExchange )
{
    def query = httpExchange.getRequestURI().getQuery()
    return query.split( '&' )
            .collectEntries {
        String[] pair = it.split( '=' )
        if (pair.length > 1)
        {
            return [(pair[0]): pair[1]]
        }
        else
        {
            return [(pair[0]): ""]
        }
    }
} 
```

这是如何使用它：

```
def queryParameters = getQueryParameters( httpExchange )
def parameterA = queryParameters['A'] 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-09-20T07:20:08.203

偶然发现了这一点，并想我会在这里扔一个[Java 8 / Streams](https://docs.oracle.com/javase/8/docs/api/java/util/stream/Stream.html)实现，同时添加一些额外的位（不是在以前的答案中）。

**Extra 1**：我添加了一个过滤器以避免处理任何空参数。不应该发生的事情，但它允许更清晰的实现而不是不处理问题（并发送空响应）。这方面的一个例子看起来像`?param1=value1&param2=`

**额外 2**：我利用[String.split(String regex, int limit)](https://docs.oracle.com/javase/8/docs/api/java/lang/String.html#split-java.lang.String-int-)进行第二次拆分操作。这允许诸如`?param1=it_has=in-it&other=something`传递查询参数。

```
public static Map<String, String> getParamMap(String query) {
    // query is null if not provided (e.g. localhost/path )
    // query is empty if '?' is supplied (e.g. localhost/path? )
    if (query == null || query.isEmpty()) return Collections.emptyMap();

    return Stream.of(query.split("&"))
            .filter(s -> !s.isEmpty())
            .map(kv -> kv.split("=", 2)) 
            .collect(Collectors.toMap(x -> x[0], x-> x[1]));

} 
```

**进口**

```
import java.util.Map;
import java.util.Collections;
import java.util.stream.Stream;
import java.util.stream.Collectors; 
```

# android - 试运行失败：试运行未能完成。预期 1 次测试，收到 0

> ID：11640028
> 
> 赞同：13
> 
> 时间：2012-07-24T22:05:42.057
> 
> 标签：android, junit, robotium

我尝试为我的应用程序启动 JUnit 测试（robotium）：

```
public class MainTest extends ActivityInstrumentationTestCase2<MainActivity> {
    private Solo solo;

    public MainTest() {
        super("nix.android.contact", MainActivity.class);// TODO Auto-generated constructor stub
    }

    protected void setUp() throws Exception {
        super.setUp();
        solo = new Solo(getInstrumentation(), getActivity());
    }

    public void AddContact() {
        solo.assertCurrentActivity("main", MainActivity.class);
    }
} 
```

显现

```
 <instrumentation
    android:name="android.test.InstrumentationTestRunner"
    android:targetPackage="nix.android.contact" />

<application
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name" >
    <uses-librar

y android:name="android.test.runner" />
    </application> 
```

当我尝试运行测试时，这是我在控制台中遇到的错误：

```
Test run failed: Test run failed to complete. Expected 1 tests, received 0 
```

我尝试创建另一个测试一个不同的应用程序（非常简单的应用程序）并且它有效。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-10T20:00:43.153

当我没有无参数构造函数时，我遇到了这个问题。

```
public class MainActivityTest extends
    ActivityInstrumentationTestCase2<MainActivity_> {

public MainActivityTest() {
    super(MainActivity_.class);
}
... 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-06-19T10:29:05.500

*在 Android (@RunWith(AndroidJUnit4.class)* )上运行仪器测试时我遇到了同样的问题。

我有以下错误：

```
Tests on Nexus_5X_API_26(AVD) - 8.0.0 failed: 
Test run failed to complete. Expected 156 tests, received 152 
```

问题是其中一个测试类在标有*@BeforeClass*的方法中失败，因此没有为该特定类执行任何测试。此外， @ *BeforeClass*中引发的异常并没有出现在测试输出/报告中。这就是为什么很难找到“*预期 N 次测试，收到 M* ”错误消息的原因。

因此，如果您遇到同样的问题 - 检查您的 @Before 和 @BeforeClass 实现 - 可能是异常原因。希望这可以帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-24T22:14:12.993

问题出在您的电话中

```
super("nix.android.contact", MainActivity.class); 
```

在我的代码中，我有

```
super("nix.android.contact", Class.forName("nix.android.contact.MainActivity")); 
```

我也这样做了，而不必为 ActivityInstrumentationTestCase 2 命名 Generic

```
public class TestApk extends ActivityInstrumentationTestCase2 {

    private static final String TARGET_PACKAGE_ID = "nix.android.contact";
    private static final String LAUNCHER_ACTIVITY_FULL_CLASSNAME = "nix.android.contact.MainActivity";

    private static Class<?> launcherActivityClass;
    static{
            try {
                    launcherActivityClass = Class.forName(LAUNCHER_ACTIVITY_FULL_CLASSNAME);
            } catch (ClassNotFoundException e) {
                    throw new RuntimeException(e);
            }
    }

    @SuppressWarnings("unchecked")
    public TestApk() throws ClassNotFoundException {
            super(TARGET_PACKAGE_ID, launcherActivityClass);
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-01-25T17:49:16.160

我有这个错误，我修复了它从构造方法中删除了参数，它是由 Eclipse 向导创建的：

```
public OptionsActivityTest( String name ) { 
```

我只需要删除“字符串名称”以使我的测试再次工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-09-26T12:19:54.183

检查您是否没有保护您的测试构造器所依赖的方法，但应用程序中没有使用任何东西 - logcat 会抱怨您的应用程序包中缺少类或方法。

尝试卸载目标包，以检查它不是从备用构建中遗留下来的（例如，如果您使用 Maven 和 Eclipse）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-04-19T05:49:36.537

我在测试我的应用程序时遇到了同样的问题。
有时它可以工作，但大多数时候测试失败并引发相同的错误。

> *测试未能完成。
> 原因：'测试运行未能完成。预期 1 个测试，收到 0'。
> 检查设备 logcat 以获取详细信息*

我检查了所有测试类中的测试名称，两个类中的测试名称相同，我更改了测试名称，当我再次开始测试时它可以工作。

当我的设备与计算机断开连接时，它也可能会出错。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2012-10-07T11:15:07.203

我有同样的错误信息。问题是我的测试方法名称需要以“test”开头。

例如： `testMethod1()`工作同时`method1Test()`给出错误。

* * *

## 回答 #8

> 赞同：-3
> 
> 时间：2013-04-25T06:58:32.833

所有测试名称都应以前缀“test”开头。

# java - 带有 java aws 导入的 Eclipse 属性

> ID：11640029
> 
> 赞同：0
> 
> 时间：2012-07-24T22:05:48.843
> 
> 标签：java, jakarta-ee, amazon-web-services

我正在尝试用 java 编写一个程序，该程序在 Amazon aws 服务中创建和监视实例，但问题是它显示以下错误：

导入 EC2.cloudEC2Connector；导入监视器.monitorEC2；

并且据此，整个代码仅在我的 Mac 机器中充满了错误，但它在我的 Linux 和 Windows 合作伙伴机器中运行良好……有人能告诉我如何解决这个问题吗？

谢谢 ....

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-14T23:38:12.117

这些类不是适用于 Java 的 AWS 开发工具包的一部分，所以这不是问题。看起来您缺少您的合作伙伴从您的类路径中拥有的另一个库。

# python - uWSGI+Flask+boto - 线程安全

> ID：11640031
> 
> 赞同：3
> 
> 时间：2012-07-24T22:05:59.497
> 
> 标签：python, flask, boto, uwsgi

假设我有一个 Flask 应用程序，由 uWSGI 使用多个进程提供服务，例如：

```
uwsgi --socket 127.0.0.1:3031 --file flaskapp.py --callable app --processes 4 
```

我的 Flask 应用程序是这样组织的：

```
/flaskapp
    app.py
    /db
        __init__.py
        somefile.py
        somefile2.py
        ... 
```

我正在使用 boto 连接到 DynamoDB。该`__init__.py`文件是空的，每个`somefilexxx.py`文件的开头是这样的：

```
db = boto.connect_dynamodb()
table = db.get_table('table')
def do_stuff_with_table(): 
```

我不在应用程序中使用线程，并且我不认为 uWSGI 使用线程，除非我明确地使用`--threads`. 这个设置有意义吗？使用 urllib 是否有任何线程问题我必须担心（你可能会猜我对线程知之甚少......）？

或者，调用文件并仅加载文件中的表`connect_dynamodb()`是否更有意义？`__init__.py``somefile.py`

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-26T09:48:29.443

由于您尚未在 uWSGI 中启用线程（请参阅：`--enable-threads`，`--threads`），因此此处没有 Python 线程（在 Boto 或其他方式中。）

我建议使用`--lazy`，这将导致您的应用程序加载到每个工人后叉中。然后，您可以简单地依靠该行为来确保每个工作人员都有适当的连接/池/等。无需担心共享状态即可使用。

# android - Android App Highscore 与 facebook 好友的比较

> ID：11640032
> 
> 赞同：1
> 
> 时间：2012-07-24T22:06:01.120
> 
> 标签：android, facebook

我正在开发一个非常简单的安卓游戏。一切都是为了获得高分。

现在我几乎完成了游戏并且一切正常，我想实现一个高分列表，人们可以登录到他们的 Facebook 帐户并查看同样玩游戏的朋友的高分。就像在与朋友一起画画一样。

我必须采取哪些步骤才能实现这一目标？我需要额外的服务器吗？是否有教程如何做到这一点，或者有人可以帮忙吗？

提前致谢

# api - 使用 BitBucket 的 API 分叉存储库

> ID：11640035
> 
> 赞同：3
> 
> 时间：2012-07-24T22:06:14.400
> 
> 标签：api, bitbucket, bitbucket-api

有什么方法可以使用 BB 的 API 分叉存储库？

根据我在 API 文档上阅读的内容，没有任何明确的文档：[https ://confluence.atlassian.com/display/BITBUCKET/Repositories](https://confluence.atlassian.com/display/BITBUCKET/Repositories)

我的想法是创建一个新的 repo 并指出它是另一个 repo 的分支，因此我可以稍后创建拉取请求。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2015-11-25T08:42:49.373

您可以使用 API 派生存储库，使用基本授权或 OAuth。

分叉存储库的方法：

使用带有所需发布数据“名称”的授权 POST 请求。 [https://bitbucket.org/api/1.0/repositories/](https://bitbucket.org/api/1.0/repositories/) {accountname}/{repo_slug}/fork/

此处包含可选参数的完整文档： [http ://restbrowser.bitbucket.org/](http://restbrowser.bitbucket.org/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-25T23:17:26.700

所以..

尝试通过 Twitter 和 API 页面上的评论联系支持人员。没有得到答案...

而且似乎他们真的没有创建分叉的方法。

我的解决方案：

*   创建了一个 cURL 接口来与 BitBucket 的网站交互，然后我可以从那里分叉并创建拉取请求

如果您对此有更好的解决方案，或者他们实际上在 API 上有该方法，请在此处随意放弃您的答案。

跟进：[https ://bitbucket.org/site/master/issue/4376/api-method-to-fork-a-repository](https://bitbucket.org/site/master/issue/4376/api-method-to-fork-a-repository)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-02-11T13:56:18.763

.

您可以使用 Bitbucket API 分叉存储库，而无需用户名和密码，仅使用 bitbucket 应用程序。

这里有发布新[叉子](https://confluence.atlassian.com/display/BITBUCKET/repository+Resource+1.0#repositoryResource1.0-POSTanewfork)的文档。

此外，您还需要具备 OAuth 的基础知识，以下链接很有帮助。

1.  [Bitbucket 上的 OAuth](https://confluence.atlassian.com/display/BITBUCKET/OAuth+on+Bitbucket)

2.  [使用 Bitbucket REST API](https://confluence.atlassian.com/display/BITBUCKET/Use+the+Bitbucket+REST+APIs)

3.  [Bitbucket API 版本 1](https://confluence.atlassian.com/display/BITBUCKET/Version+1)

4.  [Bitbucket API 版本 2](https://confluence.atlassian.com/display/BITBUCKET/Version+2)

5.  [Bitbucket REST API 浏览器](http://restbrowser.bitbucket.org/)

如果你是 wordpress 开发者，[这个插件](http://wordpress.org/plugins/wp-bucket/)对你很有帮助。

.

[![代码.png](../Images/438b637875c5339921a243b26b8f1a6d.png)](https://bitbucket-assetroot.s3.amazonaws.com/repository/LboRq/362553853-code.png?Signature=c08XJKZKxshidgX3hK7ggTm%2BPFg%3D&Expires=1392127144&AWSAccessKeyId=0EMWEFSGA12Z1HF1TZ82)

# jquery - jQuery Tablesorter 过滤器不更新寻呼机

> ID：11640039
> 
> 赞同：3
> 
> 时间：2012-07-24T22:06:22.940
> 
> 标签：jquery, jquery-plugins, tablesorter

我有一个表，其中添加了[tablesorter 插件](http://mottie.github.com/tablesorter/docs/)。我已经启用了[过滤器小部件](http://mottie.github.com/tablesorter/docs/example-widget-filter.html)和[寻呼机插件](http://mottie.github.com/tablesorter/docs/example-pager.html)。

我遇到的问题是，当在过滤器输入中放入一个值时，它不会更新寻呼机（总结果，如果更多，则寻呼机设置页数）。
此外，它似乎只过滤分页结果，而不是整个表格。

有可能让它以这种方式工作吗？
我查看了文档，但看不到该怎么做（我的 js 也不是那么好）。

任何和所有的帮助表示赞赏。

我的tablesorter设置：

```
var pagerOptions = { 

            // target the pager markup - see the HTML block below 
            container: $(".pager"),  

            // output string - default is '{page}/{totalPages}'; possible variables: {page}, {totalPages}, {startRow}, {endRow} and {totalRows} 
            output: '{startRow} to {endRow} ({totalRows})', 

            // apply disabled classname to the pager arrows when the rows at either extreme is visible - default is true 
            updateArrows: true, 

            // starting page of the pager (zero based index) 
            page: 0, 

            // Number of visible rows - default is 10 
            size: 10, 

            // if true, the table will remain the same height no matter how many records are displayed. The space is made up by an empty 
            // table row set to a height to compensate; default is false 
            fixedHeight: true, 

            // remove rows from the table to speed up the sort of large tables. 
            // setting this to false, only hides the non-visible rows; needed if you plan to add/remove rows with the pager enabled. 
            removeRows: true, 

            // css class names of pager arrows 
            cssNext: '.next', // next page arrow 
            cssPrev: '.prev', // previous page arrow 
            cssFirst: '.first', // go to first page arrow 
            cssLast: '.last', // go to last page arrow 
            cssPageDisplay: '.pagedisplay', // location of where the "output" is displayed 
            cssPageSize: '.pagesize', // page size selector - select dropdown that sets the "size" option 

            // class added to arrows when at the extremes (i.e. prev/first arrows are "disabled" when on the first page) 
            cssDisabled: 'disabled' // Note there is no period "." in front of this class name 

        }; 

        $.tablesorter.addParser({
            id: "datetime",
            is: function(s) {
                return false; 
            },
            format: function(s,table, cell) {
                s = s.replace(/\-/g,"/");
                s = s.replace(/(\d{1,2})[\/\-](\d{1,2})[\/\-](\d{4})/, "$3/$2/$1");
                return $.tablesorter.formatFloat(new Date(s).getTime());
            },
            type: "numeric"
        });

        $("#results").tablesorter({

        // initialize zebra striping and filter widgets
        widgets: ["zebra", "filter"],

        // headers: { 5: { sorter: false, filter: false } },

        widgetOptions : {

            // css class applied to the table row containing the filters & the inputs within that row
            filter_cssFilter : 'tablesorter-filter',

            // If there are child rows in the table (rows with class name from "cssChildRow" option)
            // and this option is true and a match is found anywhere in the child row, then it will make that row
            // visible; default is false
            filter_childRows : true,

            // Set this option to true to use the filter to find text from the start of the column
            // So typing in "a" will find "albert" but not "frank", both have a's; default is false
            filter_startsWith : false,

            // Set this option to false to make the searches case sensitive
            filter_ignoreCase : true,

            // Delay in milliseconds before the filter widget starts searching; This option prevents searching for
            // every character while typing and should make searching large tables faster.
            filter_searchDelay : 300,

            // See the filter widget advanced demo on how to use these special functions
            filter_functions : {
                            4 : function(e, n, f, i) { 
                                alert(e);
                                console.log(e);
                                if (e != "") {
                                    return e === f; 
                                }
                            }
                        },

                        empty: 'bottom',

                        dateFormat : "ddmmyyyy"

        },
                widthFixed: true
    })
        .tablesorterPager(pagerOptions) 

        // bind to pager events 
        // ********************* 
        .bind('pagerChange pagerComplete', function(e,c){ 
            console.log(e);
            console.log(c);

        var msg = '" event triggered, ' + (e.type === 'pagerChange' ? 'going to' : 'now on') + 
            ' page ' + (c.page + 1) + '/' + c.totalPages; 
        $('#display') 
            .append('<li>"' + e.type + msg + '</li>') 
            .find('li:first').remove(); 
        }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-03-21T19:50:04.770

过滤器小部件和寻呼机插件/小部件现在可以一起工作，但寻呼机[`removeRows`选项](http://mottie.github.io/tablesorter/docs/#pager-removerows)必须设置为`false`. 此选项的作用是保留表中的所有行，而不是仅将当前页面（可见）行添加到 DOM。

[Bootstrap 主题演示](http://mottie.github.io/tablesorter/docs/example-widget-bootstrap-theme.html)

在“近期”版本中，该`removeRows`选项将不再是必需的，因为过滤器小部件将访问存储的缓存行而不是表中的行。

# javascript - 动态 Facebook 评论计数器链接

> ID：11640042
> 
> 赞同：1
> 
> 时间：2012-07-24T22:06:51.467
> 
> 标签：javascript, jquery, facebook

我想在系列类中找到 href，然后用相同的链接替换 ​​[PAGEURL]。我还需要这个来为页面上的每个 .details 类重复该功能。

这是我正在使用的 JavaScript -

```
$(function() {
  var links = $('.details'),
    matchExp = /\[PAGEURL\]/,
    currentURL = $('.series').attr('href');

  links.each(function() {
    var currentHREF = $(this).attr('href');
    if (currentHREF.match(matchExp)) {
        $(this).attr('href',currentHREF.replace(matchExp,currentURL));
    }
  });
}); 
```

这是HTML

```
<div class="details">
  <div class="series">
    <a href="MyLink.php">text</a>
  </div>
  <fb:comments-count href=[PAGEURL]></fb:comments-count>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T21:23:45.650

我认为您不需要在这种情况下使用正则表达式。
jQuery 为您提供了足够的工具来完成工作。

以下是我如何在某些链接占位符上完成“搜索和替换”功能：

鉴于以下 HTML -

```
<div class="details">
  <div class="series"><a href="my_cool_page.php">text</a></div>
  <fb:comments-count href="[PAGEURL]"></fb:comments-count>
</div>

<div class="details">
  <div class="series"><a href="awseome_content.php">text</a></div>
  <fb:comments-count href="[PAGEURL]"></fb:comments-count>
</div>

<div class="details">
  <div class="series"><a href="interesting_stuff.php">text</a></div>
  <fb:comments-count href="[PAGEURL]"></fb:comments-count>
</div> 
```

这个 jQuery 可以解决问题 -

```
$(function(){
    // this grabs all the div elements with the class "details"
    $("div.details").each(function(index,elem){

      // within each details <div>, we look for an <a> element, and
      // we save its href value in currentURL
      var currentURL = $(this).find('div.series > a').attr('href');

      // again within the details <div>, we search for any element who's href
      // property contains [PAGEURL] and replace is with the value
      // we got from the series <a> tag.
      $(this).find('*[href*="[PAGEURL]"]').attr('href',currentURL);
    });
});​ 
```

最终期望的结果应该是这样的 -

```
<div class="details">
  <div class="series"><a href="my_cool_page.php">text</a></div>
  <fb:comments-count href="my_cool_page.php"></fb:comments-count>
</div>

<div class="details">
  <div class="series"><a href="awseome_content.php">text</a></div>
  <fb:comments-count href="awseome_content.php"></fb:comments-count>
</div>

<div class="details">
  <div class="series"><a href="interesting_stuff.php">text</a></div>
  <fb:comments-count href="interesting_stuff.php"></fb:comments-count>
</div> 
```

## [jsFiddle 演示](http://jsfiddle.net/WNWtC/)

我根据您的问题对实际 HTML 进行了一项更改。`href`财产（以及与此相关的任何财产）的价值应始终用引号引起来。

`<fb:comments-count href=`**"** `[PAGEURL]`**"**`></fb:comments-count>`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T17:45:33.600

如果您使用 jQUery，这非常简单：

```
$('.series').each(function() {
    $(this).next('fb:comments-count').href = this.href;
}); 
```

不确定 jQuery 选择器 'fb:comment-count' 是否真的有效。您可能希望简单地向该元素添加一个类名并在该类名上使用选择器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T17:53:03.857

如果您在 PHP 中生成此页面，则仅在服务器端包含 URL 会容易得多。在不了解您的脚本的情况下，它将类似于：

```
<?php $url='...'; ?>
<div class="details">
<div class="series"><a href="<?php echo $url; ?>">text</a></div>
<fb:comments-count href="<?php echo $url; ?>"></fb:comments-count>
</div> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-25T17:32:57.170

不幸的是，您尝试做的事情不会像 FB 一样工作：标签会在 dom 加载时发送到 Facebook。然后，这会在您可以更改的 iframe 中创建 fb 元素。

但是，如果您有多个链接和多个按钮，那么您应该将它们硬编码，但我假设您想要一个带有多个链接的 fb 按钮，这些链接将修改其 url。

如果是这种情况，那么你坚持加载 dom 上的所有按钮，然后显示你想要的那个

```
<div class="details">
    <div class="series"><a href="MyLink1.php" id="MyLink1">text</a></div>
    <div class="fb MyLink1"><fb:comments-count href=[PAGEURL]"></fb:comments-count></div>

    <div class="series"><a href="MyLink2.php" id="MyLink2">text 2</a></div>
    <div class="fb MyLink2"><fb:comments-count href=[PAGEURL]"></fb:comments-count></div>

    <div class="series"><a href="MyLink3.php" id="MyLink3">text 3</a></div>
    <div class="fb MyLink3"><fb:comments-count href=[PAGEURL]"></fb:comments-count></div>
</div> 
```

然后隐藏所有 fb 框并在点击时显示您想要的框

```
$(".fb").hide();
 $(".fb").eq(0).show();

    $(".details . series a").click(function(){
        $(".fb").hide();
        $("."+$(this).attr("id")).show();
    }); 
```

然后将 fb 按钮定位在某个绝对某个位置

```
.fb{
    position:absolut; top:0; left:0;
} 
```

# arrays - Node + Mongo：将记录添加到集合内的数组

> ID：11640043
> 
> 赞同：1
> 
> 时间：2012-07-24T22:07:31.493
> 
> 标签：arrays, node.js, mongodb, collections

我正在写一个博客系统。现在我正在处理帖子的评论。这是每个帖子的架构：

```
{
"topic": "Post Topic",
"post": "<p>\r\n\tPost text</p>\r\n",
"time_added": 1343167025,
"author": "Ashley Brooks",
"_id": {
    "$oid": "500f1a315759c73805000001"
} 
```

}

现在，我想为这篇文章添加评论。我想存储评论的最佳方式是：

```
{
"topic": "Post Topic",
"post": "<p>\r\n\tPost text</p>\r\n",
"time_added": 1343167025,
"author": "Ashley Brooks",
"_id": {
    "$oid": "500f1a315759c73805000001"
},
"comments" : [
    {
        "author":"James Brown",
        "comment":"My awesome comment"
    },
    {
        "author":"Jimmy White",
        "comment":"And this is my comment"
    }
]
} 
```

我已经阅读了 Mongo 的一些文档，但是我找不到添加新评论的正确方法。这就是我现在的做法：

```
exports.post = function(req, res) {
if (req.currentUser) {
    db.collection("posts", function (err, collection) {
        var obj_id = BSON.ObjectID.createFromHexString(req.params.id);
        console.log(obj_id);
        collection.findAndModify(
            {_id: obj_id}, // query for a post
            {$push: {
                comments: [ {author: req.body.comment, name: "testname" } ]
                }
            },
            function(err, object) {
                if (err){
                    console.warn(err.message);
                }else{
                    res.redirect('/');
                }
            });
    });
} else {
    res.redirect('/');
} 
```

};

它返回给我这样的错误：

```
exception: must specify remove or update 
```

我做错了什么？

PS顺便说一句，我认为用任何唯一的ID或类似的东西标记单独的评论会很好。如何指定 Mongo 为每个添加评论添加 obj_id 参数？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T22:26:53.857

使用“更新”并且它有效：

```
collection.update(
            {_id: obj_id}, // query
            {$push: {
                comments: {comment: req.body.comment, name: "testname" }
                }

            }, 
```

# angularjs - 在 AngularJS 中为具有 templateURL 的指令设置绑定

> ID：11640047
> 
> 赞同：1
> 
> 时间：2012-07-24T22:07:56.240
> 
> 标签：angularjs

我没有任何运气在从 templateUrl 获取模板的指令中设置绑定。

这是我的绑定代码内部的样子：

```
templateUrl : '/path/to/template.html',
link : function($scope, element, attrs) {
  $scope.title = 'test';
} 
```

这是模板本身的样子：

```
<div>
  <h4>{{title}}</h4>
</div> 
```

该指令针对 data-video 属性触发。指令本身被触发并下载模板，但范围绑定不会被替换。

关于如何做到这一点的任何想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T23:10:19.747

您对我来说看起来不错，这里有一些建议：

*   如果`{{title}`不是错字，请确保您使用`{{title}}`。
*   [指令文档](http://docs.angularjs.org/guide/directive)底部的演示显示了类似的内容，以防万一。
*   通过进行一些明显的更改并确保您在刷新时看到它，确保您的模板没有被缓存并导致混乱。
*   如果您已设置，请确保您的 html 文件在[此帖子](https://stackoverflow.com/questions/11426114/angularjs-why-doesnt-replace-true-work-with-templateurl-property)`replace: true`的根级别之外没有任何评论。
*   链接函数的范围不需要 $ 但我认为这不会影响任何事情：`function(scope, element, attrs)`

# mysql - 选择最近 7 天的最大值

> ID：11640050
> 
> 赞同：1
> 
> 时间：2012-07-24T22:08:33.053
> 
> 标签：mysql

我通过每小时插入描述这些项目的记录作为 cron 作业来跟踪一些项目。

我有一张桌子

```
steamid(int),
eventid(auto_increment),
itemid(int),
value(int),
time(unix format). 
```

我正在使用每小时统计数据生成一个图表来显示 24 小时概览。

现在我正在尝试生成一个 7 天的历史视图。

如何选择过去 7 天每天发生的最大值？

或者，如果这更容易，我怎么可能选择过去 7 天内每天的第一个或最后一个条目？

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-24T22:12:39.123

```
SELECT   DATE(FROM_UNIXTIME(time)) AS daygroup, 
         MAX(value) AS max_value, 
         MIN(value) AS min_value
FROM     tbl
WHERE    time >= UNIX_TIMESTAMP(CURDATE() - INTERVAL 7 DAY)
GROUP BY daygroup 
```

这将获得`value`过去 7 天内每天的最小值和最大值。

**编辑：**更新解决方案以获取整行数据：

```
SELECT a.*
FROM tbl a
INNER JOIN
(
    SELECT   DATE(FROM_UNIXTIME(time)) AS daygroup, 
             MAX(value) AS max_value 
    FROM     tbl
    WHERE    time >= UNIX_TIMESTAMP(CURDATE() - INTERVAL 7 DAY)
    GROUP BY daygroup
) b ON DATE(FROM_UNIXTIME(a.time)) = b.daygroup AND a.value = b.max_value 
```

# objective-c - 在 Cocoa 中重用非平凡代码的机制？

> ID：11640053
> 
> 赞同：0
> 
> 时间：2012-07-24T22:08:39.193
> 
> 标签：objective-c, xcode, cocoa, modularity, reusability

所以我最近致力于扩展 List/Details 应用程序模式的功能：在 Details 视图上实现滑动以移动到父列表中的上一个或下一个项目。

我的解决方案需要在 Details 视图中添加一个属性，在 List 视图中添加 3 个属性，在每个属性中实现几个新功能，并确保一些代码在两者的 ViewDidLoad 以及表格视图的 DidSelect 方法中运行。

我一直在研究 Cocoa 和 XCode 4 中可用于重用的明显机制（片段、子类化和类别），以使此代码（几乎是独立的）更容易添加到其他屏幕和应用程序中，但没有似乎适合它。我想不出任何机制可以封装所有需要的更改，或者简化其他屏幕或项目的代码重用。

以下是具体的缺点：

Snippets：只能插入单个代码块，因此不适用于需要在多个文件中更改的代码，甚至是同一文件中的多个点。

类别：可以添加新方法（或重新定义现有方法）但不能添加新属性。

子类化：可以添加新的方法和属性，但不解决跨多个类的更改以实现解决方案。

可以使用混合方法（使用片段、类别和子类），但没有将此类代码修改打包在一起的机制！

即使它们来自其他语言或 IDE，了解其他地方使用的任何方法也会很有趣。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T22:14:34.740

类别通常可以通过[关联引用](http://developer.apple.com/library/ios/#documentation/cocoa/conceptual/objectivec/Chapters/ocAssociativeReferences.html)添加属性。这是解决各种问题的好方法。

* * *

编辑：如果您只是希望某些对象具有特殊行为，并且您知道在创建它们时可以控制它们的创建，那么这听起来像是子类化。如果您希望特定实例具有特殊行为并且您不控制它们的创建，或者您不知道它们在创建时需要该行为，那么有一个工具可以做到这一点。它被称为 ISA swizzling，这就是 KVO 的实现方式。

[iOS:PTL](http://iosptl.com)的第 20 章对此进行了相当多的介绍，但是如果您想要一些示例代码来展示它是如何完成的，请参阅[ISASwizzle](https://github.com/rnapier/ios5ptl/tree/master/ch20/ISASwizzle)示例代码。Robbie Hanson 也对该主题进行了[简短易懂](http://deusty.blogspot.com/2008/05/casting-subclassing-and-isa-field.html)的讨论。这是一种相当先进的技术，应该小心使用，但它非常强大。

# objective-c - NSString dataUsingEncoding 不编码转义引号

> ID：11640054
> 
> 赞同：0
> 
> 时间：2012-07-24T22:08:40.657
> 
> 标签：objective-c, ios

我有一个 iOS 应用程序试图向 Rails 服务器发出发布请求。请求方法的集合体如下所示。

```
- (void)setBody:(NSString *)body{
    requestString = body;
    NSLog(@"request string: %@",requestString);
    [request setHTTPBody:[requestString dataUsingEncoding:NSUTF8StringEncoding]];
} 
```

当我检查日志中的请求字符串时，我看到它正确输出为：

```
{"commit":"Create Order","order":{"price":"1","street_address":"(null)","state":"(null)","country":"USA","city":"(null)","zipcode":"(null)"}} 
```

但是，当数据到达我的 Web 应用程序时，我得到的是原始的未转义引号。

```
Parameters: {"{\"commit\":\"Create Order\",\"order\":{\"price\":\"1\",\"street_address\":\"(null)\",\"state\":\"(null)\",\"country\":\"USA\",\"city\":\"it\",\"zipcode\":\"(null)\"}}"=>nil} 
```

我怀疑这是一个 Rails 问题，尽管它可能是一种可能性。

有什么建议么？

原始字符串在别处声明为

```
NSString *order = [NSString stringWithFormat:@"{\"commit\":\"Create Order\",\"order\":{\"price\":\"%@\",\"street_address\":\"%@\",\"state\":\"%@\",\"country\":\"%@\",\"city\":\"%@\",\"zipcode\":\"%@\"}}",@"1",streetAddressFieldText,stateFieldText,@"USA",cityFieldText,zipFieldText]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T23:05:57.603

问题解决了。问题实际上是带有导轨的服务器端。我没有声明内容类型，这样做解决了这个问题。

```
[request setValue:@"application/json" forHTTPHeaderField:@"content-type"]; 
```

在请求执行之前添加它会导致 Rails 正确识别转义的 json。

# linux - 如何在 Arm 架构硬件上进行内存测试？（类似于 Memtest86）

> ID：11640062
> 
> 赞同：9
> 
> 时间：2012-07-24T22:09:11.760
> 
> 标签：linux, arm

有没有办法在 android 设备 RAM 上进行完整的内存测试？

我正在开发一个驱动程序，但有时我得到某些物理地址的值错误，导致驱动程序进入错误状态。当我遇到问题时，我正在尝试从 RAM 中读取。我认为我设备上 ram 的某些部分已损坏。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-28T15:33:09.103

*完整*是一个模棱两可的词。这可能意味着不同的温度、电压以及具有不同组件公差的一系列设备。当您站点*MemTest86*时，我想我明白了。我见过的大多数项目都是基于*C*的，无法测试所有内容。

这是在*Linux*下运行的一个- [http://www.madsgroup.org/~quintela/memtest/](http://www.madsgroup.org/~quintela/memtest/)

记录了诸如*walk bits*等算法。很大程度上取决于您的 RAM 类型。我猜你有某种类型的 SDRAM。[SDRAM](http://en.wikipedia.org/wiki/Synchronous_dynamic_random-access_memory)有许多不同的周期。有单拍读/写、银行间转账、终止突发等。

就个人而言，我们有一个系统，当通过以太网 (DMA) 进行 SSH 传输时，有 5% 的板会出现问题。SSH 涉及到 CPU/内存密集型的加密，并且 DMA 引擎通常执行与 CPU（带有缓存）不同的 SDRAM 周期。

这里有一些要求，

1.  用于驻留代码的非 SDRAM 内存。
2.  裸机框架（无缓存、中断、DMA 等）
3.  关闭 DCache。
4.  打开代码的 ICache。

另一个限制要求是运行*时间*。一个*完整*的SDRAM 测试可能需要数年才能在一块板上运行。我发现伪随机地址/数据测试效果很好。只需取与 SDRAM 大小相对质数的数字并将其用作增量。最简单的情况是`1`。您可能希望找到其他不断变化的设备`rows`，`banks`以及设备大小；`bank size-1`例如; 然而，质数会更好，因为你有不同数量的比特一直在变化。在缓存关闭的情况下，您可以使用`char`、`short`、`int`和`long long`指针来测试一些不同的突发长度。这些测试会很慢。您将需要使用`ldm/stm`对来模拟完整的*SDRAM 突发*，这些在*缓存上*更常见，因此您应该使用它们来模拟它们`ldm/stm`。这也是最快的测试之一。

```
typedef 无符号字符 b8;
typedef 无符号短 b16；
typedef unsigned long b32;
typedef unsigned long long b64;

/* 使用宏来加速代码。编译器将使用常量
 * _incr 和 _wrap 而不是导致溢出的寄存器。一个
 * 宏集中了内存测试逻辑。
 */
#define MEMTEST（名称，类型，_incr，_wrap）...

/* 顺序测试。*/
MEMTEST(do_mem_seq8, b8, 97, 1)
MEMTEST(do_mem_seq16, b16, 50839, 1)
MEMTEST(do_mem_seq32, b32, 3999971, 1)
MEMTEST(do_mem_seq64, b64, 3999971, 1)

/* 随机测试。这些测试试图随机化数据和
 * 地址访问。
 */

/* 97/0x61 用于 char 和 9999991/0x989677 用于 64MB。*/
MEMTEST(do_mem_rnd8,b8,97,9999991)
/* 64k 的 50839/C697 大素数和 64MB 的 9999991/0x989677 素数。*/
MEMTEST(do_mem_rnd16,b16,50839,9999991)
/* 64MB 的 3999971/3D08E3 素数和 9999991/0x989677 素数。*/
MEMTEST(do_mem_rnd32,b32,3999971,9999991)
/* 64MB 的 3999971/3D08E3 素数和 9999991/0x989677 素数。*/
MEMTEST(do_mem_rnd64,b64,3999971,9999991)

```

`incr`是数据增量，`wrap`是地址增量。*突发*的算法将是相同的。这是一些*内联 gcc 汇编器*，

```
 register ulong t1 asm ("r0")  = 0;                              \
    register ulong t2 asm ("r4")  = t1 + incr;                      \
    register ulong t3 asm ("r6")  = t2 + incr;                      \
    register ulong t4 asm ("r8")  = t3 + incr;                      \
        /* Run an entire burst line. */                             \
        __asm__ (" stmia  %[ptr], {%0,%1,%2,%3}\r\n" : :            \
                 "r" (t1), "r" (t2), "r" (t3), "r" (t4),            \
                 [ptr]"r" (start + (addr<<2)) :                     \
                 "memory" );                                        \
        /* Read four 32 bits values. */                             \
        __asm__ (" ldmia   %[ptr], {%0, %1, %2, %3}\r\n" :          \
                 "=r" (t1), "=r" (t2), "=r" (t3), "=r" (t4) :       \
                 [ptr]"r" (start + (addr<<2)) );                    \ 
```

这些测试很简单，应该适合代码缓存，这将最大限度地增加 RAM 的压力。我们的主要问题是 DQS 延迟，这对 DDR-SDRAM 至关重要，并且可能与温度和电压有关，并且会随 PCB 布局和材料而变化。

如果您使用 SDRAM 芯片优化内存控制器寄存器，则可以使用[Cachbench 。](http://icl.cs.utk.edu/projects/llcbench/cachebench.html)它也可能对测试有用。

另请参阅：[Unix Stack Exchange（相同的问题）](https://unix.stackexchange.com/questions/38887/how-can-i-test-the-ram-for-data-corruption-on-an-arm-based-system)。我在 Linux 下使用了这些基于*C*的测试套件，但在我们的案例中它们没有暴露任何问题。[memtest86 算法](http://www.memtest86.com/tech.html)可能没有我上面描述的那么紧张（对于 PCB 故障）；尽管测试***7***或**burnBX**测试已经接近。我认为**memtest86**可以解决 DRAM 芯片问题，而不是电路板设计问题。

***编辑：***另一个问题是与 SDRAM 芯片的瞬态/串扰。如果您的设备驱动程序是大电流或高频设备，则 SDRAM 接口可能会产生串扰，或者由于电源变化而**获得双时钟。**因此， *RAM 测试*可能不会显示任何问题，并且 SDRAM 错误仅在使用硬件的特定部分时才会发生。还要注意 Android 设备不使用动态时钟并更改 SDRAM 频率。随着时钟的变化，信号可能会发生共振。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2020-08-16T22:42:51.883

Das U-Boot 可能是 ARM 板上使用最广泛的引导加载程序，它包括一些内存测试功能。

有趣的是，它的[自述文件](https://gitlab.denx.de/u-boot/u-boot/-/raw/master/doc/README.memory-test)提出了一种可能更便携和/或更有效的替代方法：

> 对这样的系统施加压力的最著名的测试用例是在 NFS 上安装根文件系统启动 Linux，然后在本地构建一些更大的软件包（例如，在系统上编译 Linux 内核）——这将导致足够的上下文切换，网络流量（以及因此来自网络控制器的 DMA 传输）、不同的 RAM 使用等来触发该区域的任何薄弱环节。

在构建 linux 内核时，您可能对该选项感兴趣，该`CONFIG_MEMTEST=y`选项会导致构建内置内存测试。这曾经仅适用于 x86 架构，但我相信最近的版本也支持它在其他架构上，甚至可能是 ARM。

memtester工具已经在[一些 Linux 发行版](https://packages.debian.org/sid/memtester)[中](http://pyropus.ca/software/memtester/)构建并可用，适用于各种架构，包括 ARM。

[kernel-memtest](https://github.com/neuhalje/kernel-memtest)项目可能也会让您感兴趣。

请记住，没有工具可以测试它正在运行的内存（因此正在运行的操作系统中的程序将有很大的盲点），并且基本的读/写测试不会揭示每种类型的缺陷或其他错误。相应地设置您的期望，如果您有理由怀疑记忆力不好，请考虑尝试几种不同的测试工具。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-02-10T05:44:12.270

截至 2021 年 2 月，有一个基于 ARM 的[MemTest86](https://www.memtest86.com/)版本。它与 x86 磁盘映像在同一个包中。

但是，您需要一台带有 UEFI BIOS 的机器来启动它。因此，在大多数台式机和服务器级机器上都可以，但在没有内置 BIOS 的基于 ARM 的小型设备上则不行。

# ms-access - 在同一报告行上打印多个条目

> ID：11640068
> 
> 赞同：0
> 
> 时间：2012-07-24T22:10:01.673
> 
> 标签：ms-access, vba

我正在尝试与我的访问数据库一起制作一个报告，该数据库将显示所有用户的名称和用户 ID。由于数据字段不需要太多空间来显示，我试图在报告的单行上显示多个条目，以便它看起来像：

`Last1, First1 ID1 Last2, First2 ID2 Last3, First3 ID3`

`Last4, First4 ID4 Last5, First5 ID5 Last6, First6 ID6`

到目前为止，我已经尝试使用“页面设置”下的“列”属性，但是当我尝试使用它时，我要么得到它，所以只出现一行，所以它看起来像：

`Last1, First1 ID1`

 `Last2, First2 ID2` 

`Last3, First3 ID3`

或者我会得到它，这样只有一列会出现，看起来像：

`Last1, First1 ID1 Last2, First2 ID2 Last3, First3 ID3`

我还尝试使用 iif 语句，以便每行只打印出每三个条目：

`=IIf([ID] Mod 3=0,[Last Name] & ", " & [First Name] & " " & [UID] ,Null)`

这确实给出了我想要的条目，但是当返回 Null 案例时，它会留下一个我不想要的小间隙。

任何人都可以帮助我让列功能正常工作，或者如何让我的声明中的 Null 案例不会在我的报告中造成小的差距？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T16:06:34.477

To print a report header across all columns in MS Access 2010 using A4 210mm × 297mm based on a two column report.

1.  Create your report in the normal way and switch to design view
2.  Select the report header and choose columns from the page set-up tab
3.  Set columns to 2 and uncheck same as detail. I prefer down the accross, but that is uo to you.
4.  Select detail and set the column width to 9.55\. This is calculated by 19.709cm, the page width less the margins, minus 0.635, the gutters, divided by 2 columns.
5.  Squash all the detail control into 9.55cm on the left side of the page.
6.  Arrange the header to suit.

# c++ - 为 C++ 类创建最小的发布就绪头文件

> ID：11640069
> 
> 赞同：0
> 
> 时间：2012-07-24T22:10:03.790
> 
> 标签：c++, osx-lion, static-libraries, header-files

我制作了一个 C++ 类，并将其放入它自己的静态库中。

我还决定创建一个最小的头文件，让其他人可以看到`public:`课程的一部分。所以我基本上取了原始的头文件（它相当长，包含类的`private:`和`public:`部分等），并剥离了除`public:`部分之外的所有内容（很短，只有构造函数/析构函数和一个公共函数）。

为了进行测试，我创建了一个使用该库的虚拟项目。问题是，每当我在该项目中使用最小的头文件时，它都会崩溃并显示如下消息：

```
test(44349) malloc: *** error for object 0x7fdab2c242e8: incorrect checksum for freed object - object was probably modified after being freed.
*** set a breakpoint in malloc_error_break to debug 
```

但是每当我包含原始头文件时，它都可以正常工作。

可能是什么问题呢？`-Wall`它使用最小和原始头文件都可以很好地编译（即使使用 也没有警告）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-24T22:18:37.797

这是行不通的，并且违反了*单一定义规则*：每个类都必须有一个精确的定义，并且每个翻译单元必须看到完全相同的定义，否则您的程序格式不正确，更糟糕的是，不需要诊断。

使用 PIMPL 习语可能会更好地为您服务，通过它将您的类分成两部分，并且您不需要公开实现组件：

```
// Ship this:

class FooImpl;

class Foo
{
    std::unique_ptr<FooImpl> impl;
public:
    Foo();
    void do_magic();
};

// Don't ship this:

class FooImpl { void magic(); };
void FooImpl::magic() { /* secret code */ }

Foo::Foo() : impl(new FooImpl) { }
void Foo::do_magic() { impl->magic(); } 
```

请参阅 Herb Sutter 的[GotW #101](http://herbsutter.com/gotw/_101/)，了解 PIMPL 类的通用框架。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T22:12:43.430

您不能从接口中删除类的私有/受保护部分：使用该接口的编译器必须知道（私有/受保护）成员变量和虚函数，否则会对类实例和虚表有错误的认识.

# http-live-streaming - Http Live Streaming ts 段不是以关键帧开头

> ID：11640072
> 
> 赞同：2
> 
> 时间：2012-07-24T22:10:24.197
> 
> 标签：http-live-streaming, keyframe, mpeg2-ts

我正在使用苹果的 http 直播将实时视频流式传输到 ipad/iphone。其中一个重要步骤是将传输流与播放列表一起分割成几个 ts 段。根据苹果的文档，推荐的 ts 段持续时间为 10 秒。然而，更长的持续时间总是意味着更多的延迟，所以我试图将这个持续时间减少到 2 甚至 1 秒。

Apple 文档还要求在关键帧边界之间进行分割，这意味着每个 ts 片段都应该以关键帧开头，这样才能独立播放。冲突的部分来了，传输流每隔一两秒就有一个关键帧几乎是不可能的，而且也是浪费的。所以我的问题是，如果 ts 段不以关键帧开头，http 直播仍然可以工作吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-25T07:40:13.587

视频流每隔一两秒就有一个关键帧是非常容易的。例如，广播电视通常每半秒就有一个关键帧。编码器的配置参数将被称为“GOP”（图片组）大小或关键帧间隔。

使用更频繁的关键帧会降低编码效率（达到相同质量需要更多字节），但它确实提高了查找性能。

直接回答您的问题：不。如果 ts 段不以关键帧开头，HLS 将无法正常工作。这有两个原因。

1.  必须可以搜索任何段并具有可以立即解码的有效数据。

2.  必须可以在任何段边界的不同比特率之间切换。不能引用不同的流，因为缓存的数据是无效的。

# ruby-on-rails-3 - nginx-passenger-rails 应用程序不会显示

> ID：11640074
> 
> 赞同：0
> 
> 时间：2012-07-24T22:10:31.027
> 
> 标签：ruby-on-rails-3, nginx, passenger

我正在从服务器故障中恢复（机架空间云服务器 Ubuntu 10.04），我在浏览器中看到以下消息：

“页面未正确重定向 Firefox 检测到服务器正在以永远不会完成的方式重定向对该地址的请求。”

浏览器控制台日志显示了一堆这样的条目：“ [16:08:44.886] GET [https://staging.mydomain.net/](https://staging.mydomain.net/) [HTTP/1.1 302 Found 563ms] [16:08:45.455] GET [http:/ /staging.mydomain.net/](http://staging.mydomain.net/) [HTTP/1.1 301 永久移动 94 毫秒] [16:08:45.557] GET [https://staging.mydomain.net/](https://staging.mydomain.net/) [HTTP/1.1 302 找到 47 毫秒] [16:08:45.609] GET [http://staging.mydomain.net/](http://staging.mydomain.net/) [HTTP/1.1 301 永久移动 47ms] [16:08:45.658] GET [https://staging.mydomain.net/](https://staging.mydomain.net/) [HTTP/1.1 302 找到 47ms] [16:08: 45.711] GET [http://staging.mydomain.net/](http://staging.mydomain.net/) [HTTP/1.1 301 永久移动 47ms] "

在 nginx 日志中，我没有看到任何问题。rails 日志确实显示了一些信息。请参阅下面的评论。

我的问题：如何收集更多信息来调试它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T21:57:36.920

问题解决了。在我的 rails apps/controllers/application_controller 我有一行：“include SslRequirement”

这导致了潜在的无限重定向循环。由于某种原因，ssl 身份验证失败，重定向到主页，然后再次尝试 ssl 身份验证。

这与 nginx 配置文件中的行密切相关：

```
server {
  listen 80;
  server_name mydomain.net;
  passenger_enabled on;
  rewrite ^/(.*) https://mydomain.net/$1 permanent; 
} 
```

特别感谢马特的帮助。他引导我走向正确的道路。

# jquery-masonry - 如何重新排序/重新排序同位素中的元素以填补空白？

> ID：11640076
> 
> 赞同：1
> 
> 时间：2012-07-24T22:10:54.273
> 
> 标签：jquery-masonry, jquery-isotope

如何修复下面 jsfiddle 示例中的空白：

* * *

[http://jsfiddle.net/3443Y/1/](http://jsfiddle.net/3443Y/1/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T23:24:34.267

砌体和同位素是为了最大限度地增加一列中的砖块数量，而不是尽量减少底部或顶部或中间的间隙。您只能更改积木的顺序或添加另一列，即更改周围容器的宽度。例如，用书籍装满书架是一个 np 问题，一个好的解决方案的快速算法是 1d bin-packing 或 kd-tree。在这里查看 kd-tree 的一个很好的描述：http: [//www.blackpawn.com/texts/lightmaps/default.html](http://www.blackpawn.com/texts/lightmaps/default.html)。

# sql - 多个选择查询与在单个查询中选择多个变量

> ID：11640079
> 
> 赞同：0
> 
> 时间：2012-07-24T22:11:03.790
> 
> 标签：sql

```
SELECT A,B,C,D from Table1 Where Constraint1 
```

对比

```
SELECT A from Table1 Where Constraint1
SELECT B from Table1 Where Constraint1
SELECT C from Table1 Where Constraint1
SELECT D from Table1 Where Constraint1 
```

有什么性能差异吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T22:21:22.927

我认为第一个更快，但是..让我们测试一下！

考虑在第二组选择中返回 A、B、C 和 D。

输入`SQL SERVER 2008 R2`：

让我们尝试一下：

```
Create Table Test 
(
A int not null,
B int not null,
C int not null,
D int not null,
)

insert into Test values (1,2,3,5) 
```

第一个运行执行计划：

```
select A, B, C, D from Test 
```

这导致：

![在此处输入图像描述](../Images/12348a45be07e00611ed9be095e0d443.png)

它是西班牙语，但你可以看到数字。CPU 成本为`0.0000796`

所以，让我们试试第二个：

```
select A from Test
select B from Test
select C from Test
select D from Test 
```

这导致：

![在此处输入图像描述](../Images/07107f4d28b601f0b1d204cb2d87b866.png)

如您所见，每个选择使用相同的 CPU 成本，但是..这里必须进行 4 次选择。有一点点，你不会看到区别，但是，让我更新一下，用更多的数据

**更新**

现在，我做了几个插入，现在我们有：

```
select count(*) from test

76183 rows 
```

让我们做同样的事情：我们得到了第一个`select`，在执行计划中，我们得到了：

![在此处输入图像描述](../Images/88f0176ba567fd56ffab45cda01bbb97.png)

如您所见，我们得到了更多`CPU COST`（当然，更多行！）

然后让我们检查 4 个选择：

![在此处输入图像描述](../Images/01d407196ad9779614dde2a5ae703f6c.png)

同样，我们得到了相同的结果`CPU COST`，但我们运行了 4 次！！

总而言之，显示一个或四个字段没有区别，但是我们在做一个`select`对 4 个时有很大的不同。

我知道这是一个简单的问题，但我想做一些“科学/研究”

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T22:15:50.003

有一个很大的区别——第一种方法只需要扫描一次表，而第二种方法必须扫描表 4 次。

虽然 SQL 提供程序可以对此进行优化，但我怀疑它们中的任何一个都可以，而且无论如何，SQL 通常是从宿主语言激活的，并且每个查询都是单独发送给提供程序的 - 所以提供程序没有办法一起优化单独的查询...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T22:16:02.407

假设您的第二种情况有错字，第一种情况会更快，因为您只执行一个查询，因此只建立一个连接。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-24T22:16:37.767

我假设您要检索 A 四次。

在第一个选项中，只进行 1 个查询，而在第二个选项中，您有 4 个，这意味着数据库必须多次执行查询。

除非您有一个非常大的表并且需要全表扫描来返回所有 4 列，否则第一个选项应该总是更快。在这种情况下，如果 A 被索引，则 4 次往返的组合结果可能比获取所有列更快。

如果您的第二个选项中有错字，那么 1\. 应该总是更快。

# php - 解析 XML/RSS 时由于某种原因删除了斜线

> ID：11640081
> 
> 赞同：0
> 
> 时间：2012-07-24T22:11:18.017
> 
> 标签：php, xml, parsing

我得到了这个函数来通过 RSS 提要并输出数据。

```
function parseRSS($xml) {
$max = 6;
     for($i=0; $i<$max; $i++) {
          $url = $xml->channel->item[$i]->link;
          $title = $xml->channel->item[$i]->title;  
          echo '<li><a href="'.$url.'">'.$title.'</a></li>';
     }
} 
```

出于某种原因，$url 会输出这样的域：http://www.domain.com/blabla

（注意 http: 之后缺少的双精度 // ）

我仔细检查了源代码，那里的链接没问题，就在输出（出于某种原因）时，一个斜线被删除了。

任何人都知道是什么原因造成的以及如何解决？（在回显之前，我正在考虑使用 str_replace 并用 http:// 替换 http:// ，有人知道如何做到这一点吗？）

# objective-c - 在字符串中搜索字符串并创建数组

> ID：11640094
> 
> 赞同：0
> 
> 时间：2012-07-24T22:12:51.450
> 
> 标签：objective-c, arrays, string

我有这个脚本。因为我想从网站上取消我的议程，我需要从基础开始。所以我需要知道如何找到字符串。我已经有类似的东西了。我的工作也没有错。但是因为议程有 30/31 天，所以我不想放弃一天。

下面你会看到我的脚本，结果只是：Jamal Entingh

我喜欢将所有名称放入一个数组中。

我的议程将在数组中包含变量，例如我在 L2040 和时间 12:00 - 18:45 的轮班以及位置等其他内容。

我正在考虑一个 for 循环或 while 循环来解决这个问题。

如此短，naam 和 end 之间的所有内容都必须设置在一个数组中。

```
NSString *Field = @"naamJamal EntinghendnaamUlrich EsajasendnaamSerginho Herbertend";

NSString *Names = [[[[Field componentsSeparatedByString:@"naam"]objectAtIndex:1] componentsSeparatedByString:@"end"]objectAtIndex:0];

txtveld.text = Names; 
```

我对从网站上抓取的数组有这个问题。

我不打算放完整的html，而是一个例子

```
<ul class="rsevent">

<li class="rsevent"><a href="url 1"><strong>Partys going on</strong></a> <small>(5 augustus 2012)</small><small><p>The party is going on people be there.</p>
</small></li>

<li class="rsevent"><a href="url 2"><strong>Borgoe Party: vrijdag 31 augustus 2012</strong></a> <small>(31 augustus 2012)</small><small><p>Off Corso in Rotterdam is going down borgoe party</p>
</small></li>

<li class="rsevent"><a href="url 3"><strong>Dutch Kizomba Festival</strong></a> <small>(7 september 2012)</small><small><p>Dutch Kizomba Festival. The place where you need to be</p>
</small></li>

</ul> 
```

这是我从网站上为活动摘录的部分。

```
NSString *AanvraagUrl = [NSString stringWithFormat:@"http://www.thewebsite.org/category/events/"];

NSString *CodeerUrl = [AanvraagUrl stringByAddingPercentEscapesUsingEncoding:NSUTF8StringEncoding];

NSURL *Url = [NSURL URLWithString:CodeerUrl];

NSString *Scrapper = [NSString stringWithContentsOfURL:Url encoding:NSASCIIStringEncoding error:nil];

NSString *Scrapdeel = [[[[Scrapper componentsSeparatedByString:@"<div class=\"agenda\">"]objectAtIndex:1]componentsSeparatedByString:@"div>"]objectAtIndex:0];

NSString *Events = [[[[Scrapdeel componentsSeparatedByString:@"<ul class=\"rsevent\">"]objectAtIndex:1]componentsSeparatedByString:@"</ul>"]objectAtIndex:0]; 
```

这就是我所拥有的。我希望将所有数据放入数组中，但我的问题如何。这里有些像这样

```
NSArray *EventDate
NSArray *EventSubject
NSArray *EventInfo 
```

我再次使用 CompenentsSeperatedByString 尝试了不同的循环，但它给了我 1 个重复的结果。有小伙伴帮帮我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T23:02:10.847

有两个不同的分隔符，“naam”和“end”，处理起来有点困难，但这样的事情应该给你一个开始：

```
NSString *field = @"naamJamal EntinghendnaamUlrich EsajasendnaamSerginho Herbertend";
NSArray *split = [field componentsSeparatedByString:@"end"];
for (NSString *s in split) {
    if ([s length] > 0) {
        NSLog(@"Name: %@", [s substringFromIndex:[@"naam" length]]);
    }
} 
```

# php - PCRE 正则表达式匹配看起来像注释的字符串

> ID：11640102
> 
> 赞同：1
> 
> 时间：2012-07-24T22:14:08.487
> 
> 标签：php, regex

我正在尝试从通过 ReflectionClass::getDocComment 检索到的文档块中解析自定义注释。我想将 preg_match_all 与`"/(@\w+)\s+([^@]+)/"`带有`PREG_SET_ORDER`标志的正则表达式一起使用会做我想要的。我在交互式外壳中对其进行了测试，它看起来很金黄。

我没想到要测试的是`@author`来自 phpdoc 的标签。作者标签的可选电子邮件地址（显然）有一个`@`。我不能`\b`在正则表达式的字符类中使用要求`@`be 在单词的开头，因为它不会被解释为单词边界字符而是退格。

我需要一些灵感！

* * *

更新：

谢谢 Arne，您的回答给了我一些想法，但我更喜欢通用解决方案，而不是仅适用于手头特定问题的解决方案。

到目前为止，我提出了两种可能性。第一个仅在当前存在尾随空格时才有效，但我不确定我能否保证总会有。第二个似乎无论如何都可以工作，但要少得多……精巧。

第一个正则表达式是`"/(@\w+)\s+((?:[^@]\S*?\s+)*)/"`

第二个正则表达式是`"/(@\w+)\s+((?:[^@]\S*?(?:\s|$)+)*)/"`

也许有人可以帮我清理第二个。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T22:44:03.270

\b as word boundary can't be used inside a character class, because \b as word boundary is a pattern, not a character.

I guess you want to match something like

```
@import file @author firstname lastname <mail@address.com> 
```

and your interested in the annotations name and parameter.

If you simply extend your character family to not contain the `<` and append an optional pattern for the mail address, you may end up with something like this:

```
(@\w+)\s+([^<@]+(?:<[^>]+>)?) 
```

I don't know if this matches all annotations of your interest, but may be it's a starting point.

# mysql - 在 Mysql 中仅输出具有空值的字段名称

> ID：11640105
> 
> 赞同：0
> 
> 时间：2012-07-24T22:14:18.453
> 
> 标签：mysql

我的表结构如下：

```
CREATE TABLE IF NOT EXISTS `credit_limit` (
  `l_id` int(11) NOT NULL AUTO_INCREMENT,
  `cl_id` int(11) NOT NULL,
  `used_credit_bal` varchar(10) NOT NULL,
  `0` int(11) NOT NULL,
  `1` int(11) NOT NULL,
  `2` int(11) NOT NULL,
  `3` int(11) NOT NULL,
  `4` int(11) NOT NULL,
  `5` int(11) NOT NULL,
  `6` int(11) NOT NULL,
  `7` int(11) NOT NULL,
  `8` int(11) NOT NULL,
  `9` int(11) NOT NULL,
  PRIMARY KEY (`l_id`),
  KEY `cl_id` (`cl_id`)
); 
```

现在我只需要返回结果集中为 Null 或 0 的字段。

# functional-programming - 将变量/类型添加到打字环境

> ID：11640106
> 
> 赞同：1
> 
> 时间：2012-07-24T22:14:19.483
> 
> 标签：functional-programming, inference, formal-languages, formal-semantics

我有一个环境，其中包含一组我已经遇到过的令牌；当我查看一个新令牌时，我想将该令牌添加到当前环境中。基本上我想在我执行解析的环境上表达一个集合联合操作。

像Γ' = {Γ, x}

如果我想删除变量“x”（从环境中删除 x）

Γ' = Γ - x 如果 x ∈ Γ 。

写这两种形式的正确方法是什么。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T22:55:01.717

基本上，您希望将您的环境实现为一些支持插入、删除和搜索的数据结构，并将该数据结构传递给您的解析器。我想在您的解析器中，您会查看当前令牌，对环境进行适当的更新，然后在下一个令牌上递归调用解析器，然后传入*更新*的环境。

使用哪种特定的数据结构取决于您，二叉搜索树或其变体会很好，或者如果您不关心性能，您可以使用 Haskell 的内置列表类型。

编辑：要正式写下这个过程，你可以借鉴类型规则以及它们是如何编写的，这里是一个[参考](http://en.wikipedia.org/wiki/Type_rule)。例如，我们可以表示一个程序被成功解析`Γ ⊢ program:OK`（我不确定你是否想在这里处理实际类型）。然后，要将令牌添加到环境中，您可以编写

```
 Γ,id ⊢ program:OK
-------------------------
  Γ ⊢ add id, program:OK 
```

要删除令牌，您可以编写

```
 Γ ⊢ program:OK
------------------------------
  Γ,id ⊢ remove id, program:OK 
```

# database - 跟踪记录

> ID：11640108
> 
> 赞同：0
> 
> 时间：2012-07-24T22:14:36.677
> 
> 标签：database, delphi, loops, records

我在让我的程序通过依赖于记录中的值的数据库跟踪记录方面遇到了一点问题，简而言之，这就是我想要实现的目标。

这是我正在使用的表格的简化版本：

```
Record Name  |  Val1  | Val2  | Link |  Prev Link |
Rec1         |   5    |  3    | Rec2 |            |
Rec2         |   2    |  4    | Rec6 |  Rec1      |
Rec3         |   1    |  8    | Rec4 |            |
Rec4         |   1    |  1    |      |  Rec3      |
Rec5         |   8    |  3    |      |            |
Rec6         |   9    |  3    |      |  Rec2      | 
```

我的程序需要遍历上表，将信息保存在一条特定记录上，转到它的链接记录，清除前一条记录的值，然后将它们添加到新记录中（它应该一直这样做直到它结束链），作为一个例子，运行我的程序后应该发生什么。

```
Record Name  |  Val1  | Val2  | Link |  Prev Link |
Rec1         |   0    |  0    | Rec2 |            |
Rec2         |   0    |  0    | Rec6 |  Rec1      |
Rec3         |   0    |  0    | Rec4 |            |
Rec4         |   2    |  9    |      |  Rec3      |
Rec5         |   8    |  3    |      |            |
Rec6         |   16   |  10   |      |  Rec2      | 
```

我正在使用的当前程序可以在以下位置找到：http: [//pastebin.com/A10hW0C6](http://pastebin.com/A10hW0C6)

我面临的主要问题是我无法让程序遍历每条记录，点击任何链接，然后返回到它离开的地方以确保它不会错过任何内容，我怎样才能让程序忽略记录它已经作为循环的一部分结束？

任何帮助，将不胜感激 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T02:18:15.560

好吧，您可以做的是有一个单独的查询来保存链接开始的记录，例如：

```
qry1.sql := 'select * from table where prev_link is null;'; 
```

这给

```
Record Name  |  Val1  | Val2  | Link |  Prev Link |       
Rec1         |   5    |  3    | Rec2 |            |       
Rec3         |   1    |  8    | Rec4 |            |       
Rec5         |   8    |  3    |      |            | 
```

然后您可以跟踪结果数据集，在另一个查询 (query2) 上查找/定位，并在那里应用您的处理逻辑。

当您完成结果日期集时，您就完成了。当然，这是假设您的数据是合法的，即没有损坏的链接、没有循环链接等。

一些增强。您可以添加一个名为“状态”的列来反映记录的状态。例如，status = 0 表示“未处理”，“1”表示已处理，“2”表示断开的链接，“3”表示循环链接等。您可以先将所有状态列填充为 0（未处理）。

如果您无法通过在“链接”列中查找/定位来找到该记录（可能以某种方式被删除），那么您可以将状态标记为“2”。

每次点击链接时，请跟踪关注的记录。例如，您可以使用列表。在关注“链接”列中的记录之前，请检查列表。如果记录在列表中，则您有一个循环链接。停止关注，将状态标记为“3”（循环链接），清除列表，然后从 query1 中的下一条记录开始。处理循环链接很重要，否则您的程序可能会卡在它上面（永远不会结束）。

完成处理链接链后，将列表中所有记录的状态标记为“1”。

您可以利用数据库事务（开始事务...结束事务），因此当您在链接链中遇到死链接或循环链接时，您可以回滚更改的值，并相应地标记状态。

完成后，您可以查看状态栏。如果全“1”表示一切都好（已处理）。如果没有，那么您可以决定下一步该做什么。

列状态可用于过滤掉另一个后续操作中已处理的记录，因此可以更改上面的查询：

```
qry1.sql := 'select * from table where prev_link is null and status = 0;'; 
```

当然这是一个初步的策略，你可以修改它以适合你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-25T08:05:44.597

根据您使用的数据库，这可以完全通过服务器上的 SQL 来解决。这是 Firebird 的一个示例（假设链接是一致的，并且没有可以通过引用完整性约束和触发器强制执行的无限递归 - 这些不包括在此处）。

```
/* metadata */
set sql dialect 3;

create table test (
    id       integer not null,
    val1     integer,
    val2     integer,
    next_id  integer,
    prev_id  integer
);

alter table test add constraint pk_test primary key (id);
alter table test add constraint fk_test_next_id foreign key (next_id) references test (id) on update cascade;
alter table test add constraint fk_test_prev_id foreign key (prev_id) references test (id) on update cascade;

/* data */
insert into test (id, val1, val2, next_id, prev_id) values (1, 5, 3, 2, null);
insert into test (id, val1, val2, next_id, prev_id) values (2, 2, 4, 6, 1);
insert into test (id, val1, val2, next_id, prev_id) values (3, 1, 8, 4, null);
insert into test (id, val1, val2, next_id, prev_id) values (4, 1, 1, null, 3);
insert into test (id, val1, val2, next_id, prev_id) values (5, 8, 3, null, null);
insert into test (id, val1, val2, next_id, prev_id) values (6, 9, 3, null, 2);

/* update statement (could also be a stored procedure) */
execute block
as
  declare variable id integer;
  declare variable val1 integer;
  declare variable val2 integer;
begin
  for with recursive test_list (
    id,
    val1,
    val2,
    next_id
  )
  as (
    select
      t.id,
      t.val1,
      t.val2,
      t.next_id
    from test t
    where (t.prev_id is null)
    union all
    select
      t.id,
      t.val1 + tl.val1,
      t.val2 + tl.val2,
      t.next_id
    from test t
    join test_list tl on (tl.id = t.prev_id)
  )
  select
    tl.id,
    iif(tl.next_id is null, tl.val1, 0) val1,
    iif(tl.next_id is null,  tl.val2, 0) val2
  from test_list tl
  order by tl.id
  into
    :id, 
    :val1,
    :val2
  do
    update test set
      val1 = :val1,
      val2 = :val2
    where (id = :id);
end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-25T08:57:49.523

TOndrej 给了你很好的答案，但你需要很好地了解 SQL。这是值得的——正确的 SQL 将使您的数据库可靠，您的程序中的错误不会损坏数据库数据。但是你会有时间学习。此外，他的 SQL 使用了 Firebird 最新版本的功能，这个词几乎不适用于 NexusDB 或其他服务器。

这是一个更愚蠢的方法。你也可以试试。

所以，如果我理解你的任务，表格会分成一组链吗？这里你有三个链：*Rec1->Rec2->Rec6*和*Rec3->Rec4*和*Rec5*。

当你添加新元素时，它**总是**在尾部，所以它将是*Rec1->Rec2->Rec6->NewRec7*，但**永远**不能是*NewRec7->Rec1->Rec2->Rec6*也不是*Rec1->Rec2->NewRec7- >Rec6*。

都是这样吗？

然后你可以添加列距离根

```
Record Name  |  Val1  | Val2  | Link |  Prev Link | Dist |
Rec1         |   5    |  3    | Rec2 |            |  0   |
Rec2         |   2    |  4    | Rec6 |  Rec1      |  1   |  
Rec3         |   1    |  8    | Rec4 |            |  0   |  
Rec4         |   1    |  1    |      |  Rec3      |  1   |  
Rec5         |   8    |  3    |      |            |      |  
Rec6         |   9    |  3    |      |  Rec2      |  2   | 
```

您可以在 SQL 触发器或程序中计算和更新它。SQL 触发器更好——更可靠。但是你需要掌握它们。 **任何时候您将添加记录、删除记录或更改记录链接 - 您必须重新计算所有受影响记录的距离。例如，如果我使用 Rec6，将其剪切并重新连接到 Rec1->Rec2、Rec6->Rec3->Rec4，则必须重新计算 Rec6 和 Rec3 和 Rec4 的距离**

1) 从数据库中获取 max(dist)。

> 从 THE_TABLE 中选择 MAX(DIST)

2) 对于从 0 到 max(dist)-1 的每个 selected_dist

2.1) 对于每条具有这种距离的记录

> 从 THE_TABLE 中选择 RecordName、Link、Val1、Val2，其中 dist = :choosen_dist 并且链接不为空

2.1.1）更新下一个链接的增加值

> 更新表格集 Val1 = Val1 + :PrevLinked_Val1; Val2 = Val2 + :PrevLinked_Val2 WHERE RecordName = :NextLink

2.1.2）更​​新选择的，清除值

> 更新表集 Val1 = 0; Val2 = 0 WHERE RecordName = :CurrentRecordName

这种方法更糟糕：

1.  没那么快 - 许多单独的语句重复而不是捆绑到一个过程中并调用一次；
2.  不是那么快且不太可靠 - 如果您从程序中一行接一行地调用它，那么数据将通过网络从服务器到程序并返回，而不是服务器内部的所有计算
3.  计算距离时必须**非常小心。**直到将它们**全部**删除并重新计算是否有问题。

它也更好：

1.  SQL 新手更容易理解

2.  只使用非常基本的 SQL，因此可以进入任何服务器：NexusDB、Firebird、SQLite，无论你选择什么

# javascript - Ajax on Rails 控制器和更新 d3.js 图

> ID：11640109
> 
> 赞同：2
> 
> 时间：2012-07-24T22:14:51.913
> 
> 标签：javascript, ruby-on-rails, ajax, d3.js

这是场景：我有一个 Rails 控制器，它使用开始和结束日期作为@data 来存储数据的 json。在我看来，我有 d3.js 将其制成图表。

我的目标：我试图在图表下方创建一个带有开始和结束日期的表单。一旦我点击提交，我想让它用它必须从控制器中提取的新数据（使用开始和结束日期输入）重新加载图表。

现在我的 AJAX 表单看起来像这样，但返回 500：

```
<% form_remote_tag :url => developers_dashboard_path(:host => developers, :action => :get_data),
    :html => {:action => {:controller => 'dashboard', :action => 'page'}, :id => 'test', :class => 'date-form'} do %>

    <%= text_field "start_date", "name", :value => @start_date.strftime("%m/%d/%Y"), :class => "input datepicker fleft" %>

    <%= text_field "end_date", "name", :value => @end_date.strftime("%m/%d/%Y"), :class => "input datepicker fleft" %>

    <%= submit_tag 'Apply' %>

<% end %> 
```

# mongodb - 带有 NLog.LogManager.GetCurrentClassLogger() 的 Mongo C# 驱动程序 NullReferenceException

> ID：11640111
> 
> 赞同：0
> 
> 时间：2012-07-24T22:14:56.110
> 
> 标签：mongodb, linq, nullreferenceexception, nlog, mongodb-.net-driver

Mongo C# 驱动程序（版本 1.4.2）从 NLog.LogManager.GetCurrentClassLogger() 抛出 NullReferenceException
错误仅在发布版本中发生。与调试版本一起工作正常。
不确定它是否与[NLog vs. Structuremap有关](http://nlog-forum.1685105.n2.nabble.com/NLog-vs-Structuremap-td6603597.html)

堆栈跟踪，

System.NullReferenceException
at NLog.LogManager.GetCurrentClassLogger()
at lambda_method(Closure)
at MongoDB.Bson.Serialization.BsonClassMap.CreateInstance() in C:\work\10gen\mongodb\mongo-csharp-driver\Bson\Serialization\BsonClassMap。 cs：
C:\work\10gen\mongodb\mongo-csharp-driver\Bson\Serialization\BsonClassMapSerializer.cs 中 MongoDB.Bson.Serialization.BsonClassMapSerializer.Deserialize(BsonReader bsonReader, TypenominalType, Type actualType, IBsonSerializationOptions options) 的第 429 行:
C:\work\10gen\mongodb\mongo-csharp-driver\Bson\Serialization\BsonClassMapSerializer.cs 中 MongoDB.Bson.Serialization.BsonClassMapSerializer.Deserialize(BsonReader bsonReader, TypenominalType, IBsonSerializationOptions options) 的第 111 行：第 78 行
在 C:\work\10gen\mongodb\mongo-csharp-driver\Bson\Serialization\BsonSerializer.cs: MongoDB.Driver 中的 MongoDB.Bson.Serialization.BsonSerializer.Deserialize(BsonReader bsonReader, TypenominalType, IBsonSerializationOptions options
) .Internal.MongoReplyMessage 1.GetReply(MongoConnection connection, MongoRequestMessage message) in C:\work\10gen\mongodb\mongo-csharp-driver\Driver\Core\MongoCursorEnumerator.cs: MongoDB.Driver.MongoCursorEnumerator 的第 296 行1.MoveNext( ) 在 C:\work\10gen\mongodb\mongo-csharp-driver\Driver\Core\MongoCursorEnumerator.cs: System.Linq.Enumerable.FirstOrDefault[TSource] 的第 141 行（IEnumerable`1 源） `1.ReadFrom(BsonBuffer buffer, IBsonSerializationOptions serializationOptions) in C:\work\10gen\mongodb\mongo-csharp-driver\Driver\Internal\MongoReplyMessage.cs:line 105
at MongoDB.Driver.Internal.MongoConnection.ReceiveMessage[TDocument](BsonBinaryReaderSettings readerSettings, IBsonSerializationOptions serializationOptions) in C:\work\10gen\mongodb\mongo-csharp-driver\Driver\Internal\MongoConnection.cs:line 442
at MongoDB.Driver.MongoCursorEnumerator`
`1.GetFirst() in C:\work\10gen\mongodb\mongo-csharp-driver\Driver\Core\MongoCursorEnumerator.cs:line 251
at MongoDB.Driver.MongoCursorEnumerator`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T00:02:02.643

该异常实际上不是由 C# 驱动程序引发的，而是由驱动程序外部的某些代码引发的。

查看堆栈跟踪，我们可以看到 C# 驱动程序已经从数据库中读取了一个文档并试图反序列化它（请参阅堆栈跟踪上的 BsonSerializer.Deserialize）。作为反序列化的一部分，它需要创建您的类的实例（请参阅堆栈跟踪上的 BsonClassMapSerializer.CreateInstance）。对象的构造函数（或者可能是对象类的静态构造函数）正在抛出 NullReferenceException。

您可能知道您在这里使用的是什么类，并且可以查看您的源代码以找出为什么 NLog.LogManager（它**不是**C# 驱动程序的一部分）抛出 NullReferenceException。

# emacs - 如何在 Emacs 中打开和编辑图像

> ID：11640112
> 
> 赞同：6
> 
> 时间：2012-07-24T22:14:58.860
> 
> 标签：emacs

我已经搜索了很多关于在 Emacs 中打开图像的信息。我认为[ImageMagick](http://www.imagemagick.org)可以解决问题，但我似乎无法找到一种在 Emacs 中使用它的方法以及如何将它与 Emacs 集成？！

此外，任何更好的选择将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-24T22:28:19.967

Are you looking for something like the [Emacs Image Manipulation mode](http://www.emacswiki.org/emacs/EmacsImageManipulation)? It uses mogrify from ImageMacgick.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-25T11:03:03.410

使用[Image-Dired](http://www.markus-gattol.name/ws/emacs_notes_cheat_sheets.html#sec8)。

它已经包含在 Emacs 中。只需键入`M-x image-dired`并选择适当的目录。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-02T00:15:42.897

我不确定你的意思。您可以像打开任何其他文件一样“在 Emacs 内”打开图像，只是`C-x C-f`为了找到它，并`C-c C-c`切换位图渲染。

代码方面，它看起来像这样：

```
(defimage test-image
    ((:file "~/Pictures/greenbug.xpm")))

(insert-image test-image) 
```

或者更简单

```
(insert-image (create-image "~/Pictures/greenbug.xpm")) 
```

# java - 如何限制 DynamicBody 不相互反弹（但仍然碰撞）？

> ID：11640114
> 
> 赞同：0
> 
> 时间：2012-07-24T22:15:20.780
> 
> 标签：java, box2d, libgdx

所以，我有一些我想从地图边缘反弹的圆圈（即矩形），但它们不应该相互反弹。

问题是，我仍然需要捕获圆-圆碰撞并对此类事件执行一些任务。

谁能指出我应该去的方向？

为了澄清：

我正在使用 libGDX 和 Box2D，圆圈是 DynamicBodies。在地图的中间可能有一些静态物体，圆圈通常也应该与之碰撞（从它们反弹）。

我尝试的是在联系开始时将两个圆圈的恢复原状设置为 0，并在联系结束时恢复原状（在我的 ContactListener 子类中）。还尝试将临时设置的圆圈作为传感器。不过，我不确定为什么它不起作用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-29T10:18:05.137

您可以为您的圈子设置过滤器，这样它们会与地图边缘发生碰撞，但不会与自己发生碰撞。如何做到这一点，您可以阅读 box2d 手册[http://www.box2d.org/manual.html](http://www.box2d.org/manual.html)的“过滤”部分。

要捕获圆-圆碰撞，您可以执行以下操作：

1.  在每个世界步骤中，您的圈子一个接一个。
2.  在查看某个圆圈时，通过它的 AABB 进行 AABB 查询。什么是 AABB 查询以及如何使其查看 box2d 手册的“AABB 查询”部分。要获得圆的 AABB，请调用 b2Fixture::GetAABB。
3.  AABB 查询后，您将获得灯具数量，可能与您的圈子发生碰撞。要进行某些测试，请使用 b2TestOverlap 函数，或简单计算中心之间的距离。

祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T18:13:32.630

感谢 iforce2d 的评论，我可以在以下线程中找到正确的答案：[如何检测碰撞但在 box2d 中不发生碰撞？](https://stackoverflow.com/questions/11062252/how-to-detect-collision-but-do-not-collide-in-box2d)

如问题所示：我想对碰撞事件做出反应，但让圆圈不会同时相互碰撞。所以，传感器不是答案，也不是改变身体的物理属性。正确的答案是在*CollisionListener* ( *contact.setEnabled(false) ) 的**preSolve*方法中禁用联系。就那么简单。

 *** * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T22:25:35.650

从高级的角度来看，您可以在应用程序逻辑中编写类似的程序：

从地图反弹是使用一些 if 条件完成的：例如检查圆心的 x 值减去其半径是否小于地图的 x 分量；如果是这种情况，请反转圆周运动矢量的 x 方向。

两个圆的碰撞检测只是将两个圆心之间的连接向量的长度与两个半径之和进行比较；如果它更小或相等，则它们彼此相交。

编辑：哦，对不起，我没有看到您使用某种物理库。我没有使用过 libgdx，但是在其他框架中，您可以定义碰撞组来指定哪些对象可以相互碰撞，然后相应地处理这些组中对象的碰撞。也许 libgdx 也提供了类似的概念？**

# android - 将 ArrayList 保存到 android 上的文件

> ID：11640122
> 
> 赞同：11
> 
> 时间：2012-07-24T22:15:51.290
> 
> 标签：android, arraylist, save, sharedpreferences

我有一个充满字符串的 ArrayList，用户使用它填充它，以便在 ListView 中的不同活动中使用，以查看他们保存的字符串。我希望保存他们填充的 ArrayList，但我对如何让它工作感到迷茫。我试过 FileOutputStream、SharedPreferences。我看了很多例子。

例如我有

```
ArrayList<String> give = new ArrayList<String>(); 
```

并保存我尝试过的数组列表

```
FileOutputStream fos = openFileOutput(MYFILENAME, Context.MODE_PRIVATE);
fos.write(give.getBytes());
fos.close(); 
```

但这根本不起作用

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-07-25T15:25:35.313

这是一些获取可序列化对象并将其写入文件的代码，这可能是您需要的。使用 ArrayList 对其进行了测试，它工作正常。您还可以修改输出，而不是将其写入文件，您可以使用 extras 或其捆绑包将其传递给活动。我将此方法用于 android 版本 < 3.0。

读取已经包含序列化对象的文件：

```
String ser = SerializeObject.ReadSettings(act, "myobject.dat");
if (ser != null && !ser.equalsIgnoreCase("")) {
    Object obj = SerializeObject.stringToObject(ser);
    // Then cast it to your object and 
    if (obj instanceof ArrayList) {
        // Do something
        give = (ArrayList<String>)obj;
    }
} 
```

要将对象写入文件，请使用：

```
String ser = SerializeObject.objectToString(give);
if (ser != null && !ser.equalsIgnoreCase("")) {
    SerializeObject.WriteSettings(act, ser, "myobject.dat");
} else {
    SerializeObject.WriteSettings(act, "", "myobject.dat");
} 
```

序列化对象的类：

```
import java.io.BufferedReader;
import java.io.ByteArrayInputStream;
import java.io.ByteArrayOutputStream;
import java.io.FileNotFoundException;
import java.io.FileOutputStream;
import java.io.IOException;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.io.ObjectInputStream;
import java.io.ObjectOutputStream;
import java.io.OutputStreamWriter;
import java.io.Serializable;

import android.content.Context;
import android.util.Base64InputStream;
import android.util.Base64OutputStream;
import android.util.Log;

/**
 * Take an object and serialize and then save it to preferences
 * @author John Matthews
 *
 */
public class SerializeObject {
    private final static String TAG = "SerializeObject";

    /**
     * Create a String from the Object using Base64 encoding
     * @param object - any Object that is Serializable
     * @return - Base64 encoded string.
     */
    public static String objectToString(Serializable object) {
        ByteArrayOutputStream out = new ByteArrayOutputStream();
        try {
            new ObjectOutputStream(out).writeObject(object);
            byte[] data = out.toByteArray();
            out.close();

            out = new ByteArrayOutputStream();
            Base64OutputStream b64 = new Base64OutputStream(out,0);
            b64.write(data);
            b64.close();
            out.close();

            return new String(out.toByteArray());
        } catch (IOException e) {
            e.printStackTrace();
        }
        return null;
    }

    /**
     * Creates a generic object that needs to be cast to its proper object
     * from a Base64 ecoded string.
     * 
     * @param encodedObject
     * @return
     */
    public static Object stringToObject(String encodedObject) {
        try {
            return new ObjectInputStream(new Base64InputStream(
                    new ByteArrayInputStream(encodedObject.getBytes()), 0)).readObject();
        } catch (Exception e) {
            e.printStackTrace();
        }
        return null;
    }

    /**
     * Save serialized settings to a file
     * @param context
     * @param data
     */
    public static void WriteSettings(Context context, String data, String filename){ 
        FileOutputStream fOut = null; 
        OutputStreamWriter osw = null;

        try{
            fOut = context.openFileOutput(filename, Context.MODE_PRIVATE);       
            osw = new OutputStreamWriter(fOut); 
            osw.write(data); 
            osw.flush(); 
            //Toast.makeText(context, "Settings saved",Toast.LENGTH_SHORT).show();
        } catch (Exception e) {       
            e.printStackTrace(); 
           // Toast.makeText(context, "Settings not saved",Toast.LENGTH_SHORT).show();
        } 
        finally { 
            try { 
                if(osw!=null)
                    osw.close();
                if (fOut != null)
                    fOut.close(); 
            } catch (IOException e) { 
                   e.printStackTrace(); 
            } 
        } 
    }

    /**
     * Read data from file and put it into a string
     * @param context
     * @param filename - fully qualified string name
     * @return
     */
    public static String ReadSettings(Context context, String filename){ 
        StringBuffer dataBuffer = new StringBuffer();
        try{
            // open the file for reading
            InputStream instream = context.openFileInput(filename);
            // if file the available for reading
            if (instream != null) {
                // prepare the file for reading
                InputStreamReader inputreader = new InputStreamReader(instream);
                BufferedReader buffreader = new BufferedReader(inputreader);

                String newLine;
                // read every line of the file into the line-variable, on line at the time
                while (( newLine = buffreader.readLine()) != null) {
                    // do something with the settings from the file
                    dataBuffer.append(newLine);
                }
                // close the file again
                instream.close();
            }

        } catch (java.io.FileNotFoundException f) {
            // do something if the myfilename.txt does not exits
            Log.e(TAG, "FileNot Found in ReadSettings filename = " + filename);
            try {
                context.openFileOutput(filename, Context.MODE_PRIVATE);
            } catch (FileNotFoundException e) {
                e.printStackTrace();
            }
        } catch (IOException e) {
            Log.e(TAG, "IO Error in ReadSettings filename = " + filename);
        }

        return dataBuffer.toString();
    }

} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-24T22:18:16.453

您可以使用**SharedPreferences**链接下面有一个示例

[将 ArrayList 保存到 SharedPreferences](https://stackoverflow.com/questions/7057845/save-arraylist-to-sharedpreferences)

# php - Symfony2 学说 mysql IN 查询

> ID：11640131
> 
> 赞同：2
> 
> 时间：2012-07-24T22:17:01.010
> 
> 标签：php, mysql, symfony

我有一系列产品 ID。我必须这样查询：

```
SELECT * FROM products WHERE pid IN (1, 2, 8, 4, ...) // etc 
```

我在变量 $pids 中有我的 ID。

```
$qb = $em->createQueryBuilder();
$query = $qb->select('p.pid')
            ->from('SRC\MainBundle\Entity\Product', 'p')
            ->where('p.name IN :pids') // error is HERE
            ->setParameter('pids', $pids)
            ->getQuery(); 
```

不工作。我收到一个错误：

```
[Syntax Error] line 0, col 66: Error: Expected Doctrine\ORM\Query\Lexer::T_OPEN_PARENTHESIS, got ':pids' 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-07-24T22:25:40.147

如果你尝试怎么办

```
->where('p.name IN (:pids)') // error is HERE 
```

它明确告诉你它期望`parentheses`但得到`placeholder`

# php - 使用 URL 中的 ID 从 mySQL 中选择数据

> ID：11640133
> 
> 赞同：1
> 
> 时间：2012-07-24T22:17:08.843
> 
> 标签：php, mysql, url, sql-injection

我有一个包含列的表

```
GroupID | GroupName | GroupDesc | Overs |
-----------------------------------------
1       | Test Group|Description| Yes   | 
```

我有一个名为 list.php 的页面，它当前为组表（上图）中数据库中的每一行创建 URL。

该代码不是最漂亮的，但我认为它有效，这是他的代码

列表.php

```
<?php 
    $result = mysql_query("SELECT * FROM groups");

    while($row = mysql_fetch_array($result))
        {
            echo "<div class=\"divider\">";
            echo "<a href=\"group.php?id=";
            echo $row['GroupID'];
            echo "\">";
            echo $row['GroupName'];

            echo "</a>";
            echo "<br><br>";
            echo $row['GroupDesc'];
            echo "<br>";
            echo "Over 18's: ";
            echo $row['AgeRes'];
            echo "</div>";
        }
?> 
```

然后创建一个 URL，例如[http://domainname.com/group/group.php?id=1](http://domainname.com/group/group.php?id=1)

这就是我的问题所在 - 我将如何使用 URL 中的 ID 部分从上面的数据库中选择相关行？

我的第二个问题是我们如何阻止它成为 SQL 可注入的？

我对这一切都很陌生，所以我很想得到关于这个和任何好的阅读资源的答案，这样我就可以进一步发展我的技能。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T22:23:01.117

要回答第一个问题，您需要在查询中使用 where 子句。我不确定我使用的列名是否正确，但我相信你明白了。有大量免费的在线交互式 SQL 教程可供您了解如何编写查询代码。

要回答您的第二个问题，您可以使用该`mysql_real_escape_string()`函数来整理正在传递的变量。然而，更好的方法是更改​​连接到数据库的方式。[PDO](http://php.net/manual/en/book.pdo.php)和[mysqli](http://php.net/manual/en/book.mysqli.php)在连接数据库方面做得更好。你应该考虑学习那些 - 特别是如果你刚刚开始。

```
<?php 
    $id=mysql_real_escape_string($_GET['id']);
    $result = mysql_query("SELECT * FROM groups where id=".$id.";");
    // Am not 100% sure if that is the right column name to use for your database.

    while($row = mysql_fetch_array($result))
    {
        echo "<div class=\"divider\">";
        echo "<a href=\"group.php?id=";
        echo $row['GroupID']; 
        echo "\">";
        echo $row['GroupName'];

        echo "</a>";
        echo "<br><br>";
        echo $row['GroupDesc'];
        echo "<br>";
        echo "Over 18's: ";
        echo $row['AgeRes'];
        echo "</div>";
    }
?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T22:23:35.000

Q1：您需要检索请求变量并包含在您的 SQL 查询中：

```
$result = mysql_query("SELECT * FROM groups WHERE id = '" . $_GET['id'] . "'"); 
```

Q2：您应该先转义值，然后再将其包含在查询中：

```
$id = (int)mysql_real_escape_string($_GET['id']); 
```

然后将您的查询更改为以下内容：

```
$result = mysql_query("SELECT * FROM groups WHERE id = '" . $id . "'"); 
```

# objective-c - OBJ-C：NSStrings - stringByAppendingString 方法

> ID：11640134
> 
> 赞同：0
> 
> 时间：2012-07-24T22:17:09.280
> 
> 标签：objective-c, c, nsstring

为什么这种语法有效

```
 NSString* newDisplayText = [currentDisplayText stringByAppendingString:digit]; 
```

而这个，（首先将数字 NSStrin 分配给新字符串，然后使用 stringByAppendingString 方法向其发送消息）。不工作？

```
 NSString* newDisplayText = digit;
  [newDisplayText stringByAppendingString:currentDisplayText]; 
```

发送这个方法会覆盖我之前设置的值吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T22:20:08.327

`stringByAppendingString:`返回一个`NSString`对象。它不会修改接收器，因为`NSString`它是不可变的。

在您的情况下，您需要将结果分配给`stringByAppendingString`to `newDisplayText`。

```
NSString* newDisplayText = digit;
newDisplayText = [newDisplayText stringByAppendingString:currentDisplayText]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T22:20:45.487

我很难弄清楚你在问什么，但这里有一个尝试：

该方法`-stringByAppendingString:`不会修改其接收器。它构造一个新`NSString*`对象并返回它。所以说

```
[newDisplayText stringByAppendingString:currentDisplayText]; 
```

绝对什么都不做，因为您正在丢弃新创建的字符串。

# javascript - 如何在 UIWebView 中暂停媒体播放

> ID：11640135
> 
> 赞同：3
> 
> 时间：2012-07-24T22:17:35.080
> 
> 标签：javascript, objective-c, ios, uiwebview, media-player

我目前正在开发支持 iPad 上多个选项卡的浏览器。问题是 iOS 不允许多个选项卡同时播放音频/视频，尝试这样做会导致出现问题，例如所有音频都停止并且不再返回。

我注意到 Google Chrome 的浏览器实际上停止了处于非活动状态的选项卡中的媒体。我想知道他们是怎么做的。我知道可以通过`[webView loadRequest:NSURLRequestWithString(@"about:blank")];`声明完全停止媒体，但这会导致页面显示空白屏幕。我只想暂停媒体。

是否有一些我可以执行的 javascript 会停止 UIWebView 中的媒体？如果是这样，它会是什么样子（我以前从未接触过 javascript）？

提前致谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-24T23:28:16.543

既然你能做到`[webView stringByEvaluatingJavaScriptFromString:]`，那就有她简单的方法。

例如，您可以这样做：

```
[webview stringByEvaluatingJavaScriptFromString: @"document.querySelector('video').pause();"] 
```

当然，这只会停止第一个视频，因此在 iPad 上，脚本需要更复杂一些，并循环播放页面上的所有视频。

```
var videos = document.querySelectorAll("video");
for (var i = videos.length - 1; i >= 0; i--){
        videos[i].pause();
}; 
```

# c - 获取 C 中的目录列表

> ID：11640140
> 
> 赞同：1
> 
> 时间：2012-07-24T22:18:24.930
> 
> 标签：c, visual-studio-2010, directory

我不得不相信这个问题一定已经被回答过多次了，但我找不到。使用 Visual Studio C（不是 C++ 或 C#），如何获取另一个目录中的目录列表？我试过搜索“获取目录列表”和“获取文件夹列表”和“在目录中查找文件夹”。

有人可以告诉我 1) 实际上得到一个目录列表和 2) 我在选择搜索词时做错了什么，我无法找到我认为应该是一个相对常见的问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T22:32:52.767

EX：编译为Dirc.exe，用法：dirc -d [目录]

```
#include <stdio.h>
#include <dirent.h>

int main();
void get_args();
void help();

void get_args(int argc, char** argv)
{
    int i;
        for (i = 1; i < argc; i++) {

            if (argv[i][0] == '-') {

                switch (argv[i][1]) {

        case 'd': for (i = 2; i < argc; i++){
              struct dirent *dp;
                      DIR *dfd = opendir(argv[i]);
                        if(dfd != NULL) {
                      while((dp = readdir(dfd)) != NULL)
                  printf("%s\n", dp->d_name);
                      closedir(dfd);
                        }
              }
                break;

        default:    
        fprintf(stderr,
                "\nERROR: Unknown switch %s\n", argv[i]);
                help();
        }

      } else {
                for (i = 1; i < argc; i++){
                printf("%s ", argv[i]);}
            }
    }
}

int main(int argc, char** argv)
{
        get_args(argc, argv);
        if (argc==1){ help();}
}

void help()
{
    printf("\n Usage: dirc.exe [Arguments] [Dir]\n");
    printf(" Example: dirc -y words\n");
    printf("\n Arguments:");
        printf("\n -d |Directory|");
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-25T10:37:35.463

*NTDLS*的答案应该可以解决您的问题：
[Listing directory contents using C and Windows](https://stackoverflow.com/questions/2314542/listing-directory-contents-using-c-and-windows)

您必须更改功能，以便跳过文件，但这不应该是问题。如果您不想列出子目录的所有文件夹：在 if 语句中省略递归调用。

# android - 在启动时启动 Android 服务 Android 4.0

> ID：11640142
> 
> 赞同：0
> 
> 时间：2012-07-24T22:18:39.140
> 
> 标签：android, service, time, device, boot

我正在尝试在设备启动时在 android 4.0 中启动一个 android 服务，但这是不可能的，我已经使用了很多代码，复制和粘贴。我使用了这里的代码，其他示例和问题的堆栈溢出，但对我来说是不可能的。我在 Acer Iconia A501 表中使用 android 4.0.1。我把我的代码放在这里。有人可以试试这个代码吗？？？这是页面：[请这个页面，很简单](http://ambellido.blogspot.com.es/2011/10/iniciar-un-servicio-en-android-al.html)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T22:40:07.223

您需要为启动时广播的意图注册一个广播接收器。毫无疑问，这是您需要做的。

请参阅： [BroadcastReceiver 未收到 BOOT_COMPLETED](https://stackoverflow.com/questions/5051687/broadcastreceiver-not-receiving-boot-completed)

你需要做同样的事情。注册一个广播接收器并首先确保您正在捕获 BOOT_COMPLETED 事件。然后它只是做一个startService的问题。

问题很可能出现在 Manifest 中。检查您是否为所有内容提供了正确的名称。注意 . 在像 .MyBroadcastReceiver 这样的名称中，这些很重要。缺少一件事会导致问题。

Receiver 和 Service 定义都必须是完美的。还要检查 logcat 并告诉我们那里有什么错误。

# php - fnDraw 重绘从 DB 填充的数据表

> ID：11640144
> 
> 赞同：1
> 
> 时间：2012-07-24T22:18:46.520
> 
> 标签：php, mysql, jquery-datatables

我使用 fnDraw 重绘表格。看看下面的代码。这个线程与我之前的线程相似，但它提供了一个扩展的解决方案。这个想法是首先调用更新数据库的“estimate.php”，然后重新加载从数据库填充的表。问题是我可以成功调用“estimate.php”，但是 ajax 的“成功”部分表现不佳，数据表保持不变。

```
<div id="refresh">
    <button id="refresh-table">Refresh</button>
    <br>
</div>

<script type="text/javascript" charset="utf-8">
         $(document).ready(function(){
              $('#newspaper-b').dataTable({
              "sPaginationType":"full_numbers",
              "aaSorting":[[5, "asc"]],
              "bJQueryUI":true
              });

              $("#refresh-table").button().click(function() {
                    $.ajax({
                        url: "callpage.php?page=estimate.php",
                        success: function(html) {
                            var table=$("#newspaper-b").dataTable();
                            table.fnReloadAjax();
                            table.fnDraw();
                        }
                    }); 
              });

     });
</script> 
```

# android - WXGA 与 Nexus 7 之间的 Android 显示差异

> ID：11640147
> 
> 赞同：1
> 
> 时间：2012-07-24T22:18:55.320
> 
> 标签：android, android-layout

我有一台 Nexus 7 平板电脑，其分辨率应为 1280 像素 x 800 像素 (WXGA)。我在 Eclipse 上开发，我的布局设置为在 WXGA 上显示。然后，我可以放置我的按钮和对象，并根据我在 Eclipse 显示屏上看到的内容选择它们的大小。问题是我在 Eclipse 中看到的与平板电脑上的显示非常不同。平板电脑上的一切都大得多，这给我带来了很多麻烦。

我想知道是否有人对此有想法？

***编辑***

出于某种原因，7 英寸 WSVGA 似乎是我的 Nexus 7 屏幕的精确复制品。这很奇怪，因为它只提供 964×544 像素，而 Nexus 7 应该提供 1280x800

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T22:33:26.463

WXGA 本身没有任何意义。你也应该看看密度。Nexus 7 是 213dpi (tvdpi) 而 Galaxy Nexus 是相同的分辨率但 240dpi (hdpi)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T22:44:57.907

You should try to detect the screen size that the Android device has and then run code to re-position screen elements accordingly

In Unity scripting you would get the vars Screen.Width and Screen.Height , I'm not sure what the vars are called in normal android , but you would then set your screen elements to react to what ever size the screen it .

# extjs4 - 从窗口获取字段值

> ID：11640148
> 
> 赞同：0
> 
> 时间：2012-07-24T22:18:55.740
> 
> 标签：extjs4, extjs4.1, extjs-mvc

我有一个窗户。以及其中的一些字段（文本字段和按钮）。现在我想提交这些细节。

我收到此错误：

```
TypeError: button.up("form").getValues is not a function 
```

按钮功能

```
buClicked : function (button,record) {
var val= button.up('form').getValues();
console.log(val.textfieldValue);
} 
```

我的寡妇定义

```
Ext.define('MyApp.view.WindowForm', {
    extend: 'Ext.window.Window',
    alias: 'widget.winform',
    id: 'winformid', 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T23:23:07.327

```
var val= button.up('form').getForm().getValues(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-25T11:57:31.167

您正在扩展`Window's class` 这没关系，但还要在其中添加项目配置，您将包括`xtype:form`其配置具有以下内容的内容`the textfield and the buttons config`：

```
Ext.define('MyApp.view.WindowForm',
       {
           extend:'Ext.window.Window',
           id:'myformvin',
           items:[
               {xtype:'form',items:[{xtype:'textfield',fieldLabel:'My name',name:'myname'}],
                buttons:[{xtype:'button',text:'save',handler:function(btn){
                        var val =  btn.up('form').getForm().getValues(); 
                        console.log(val); //to confirm that you have the values
                    }
                }]
               }
           ]
       }
); 
```

# asp.net-mvc - 从 ASP.NET MVC 3 应用程序使用 ASMX 服务

> ID：11640151
> 
> 赞同：0
> 
> 时间：2012-07-24T22:19:04.960
> 
> 标签：asp.net-mvc, asp.net-mvc-3, asmx

正如标题所示，我正在尝试从 MVC 3 应用程序中使用 ASMX 服务。我的问题是我不断收到错误消息，告诉我该位置没有服务。但是，有。这是我的 AJAX 服务调用：

```
$.ajax({
            type: "POST",
            url: "/UI.Web/services/ProgramCycles.asmx/SaveProgramCycles",
            data: "{'pc_json':'" + JSON.stringify(cycles) + "'}",
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (msg) {

            } 
```

该服务存在于我的 MVC 3 应用程序根目录中的一个文件夹中，但调用仍然出错，它无法找到它。这是我的服务方法：

```
 [WebMethod]
    public string SaveProgramCycles(string pc_json)
    {
        List<ProgramCycle> intakeBenefits = JSONHelper<ProgramCycle>.DeserializeListFromJsonToList(pc_json);

        return "It worked!";
    } 
```

# javascript - 我的“JSON”不起作用

> ID：11640153
> 
> 赞同：1
> 
> 时间：2012-07-24T22:19:36.657
> 
> 标签：javascript, jquery, json

我正在通过 JSON 在页面上加载大量项目，但它不起作用。这是我第一次使用 JSON，我认为 JSON 只是一个大对象，所以我将之前在变量中的对象复制到一个文件中，并将其命名为 fun.js。

您可以在此处查看 JSON：

[http://justpaste.it/15zc](http://justpaste.it/15zc)

我正在使用 jQuery 来获取 JSON：

```
$.getJSON('fun.js', function(data){
alert(data)
}); 
```

没有什么是警觉的，事实上……警觉根本没有发生。有谁知道为什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-24T22:22:49.860

对于初学者，您的 JSON 没有验证。将其粘贴到此处并修复您的错误：http: [//jsonformatter.curiousconcept.com/](http://jsonformatter.curiousconcept.com/)

其次，您可以将 onError 参数传递给用户[jQuery.Ajax](http://api.jquery.com/jQuery.ajax/)，因此您将收到 JSON 未通过的警告。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T22:31:02.470

您是否验证过 JSON 是问题所在？打开 Firebug 或 Chrome 开发工具并刷新页面。您可能会看到一条消息，指出未找到文件或存在解析异常或安全错误。

*   如果找不到该文件，您可以在代码中修复它。
*   如果存在解析错误，请使用 JSON 验证器。
*   如果存在安全问题，请参阅我对[Get a JSON file from URL and display 的](https://stackoverflow.com/questions/11456862/get-a-json-file-from-url-and-display/11456989#11456989)回答。您需要更新您的服务器策略或配置您的浏览器以允许在您的测试中访问文件 URL。

# iphone - 从 JSON 中过滤 NSArray？

> ID：11640160
> 
> 赞同：3
> 
> 时间：2012-07-24T22:20:33.723
> 
> 标签：iphone, objective-c, ios, json, filter

我正在尝试在我的应用程序中实现可搜索的表格视图，当有人可以搜索位置并获得结果时。它看起来像这样：

![在此处输入图像描述](../Images/438c8e5d37949b8675fd1e698b8d669f.png)

我从基因组.com 获得我的资源，它提供的不仅仅是城市，它还有公园、建筑物、县等。我只想显示城市的位置。

数据是由 JSONKit 解析的 JSON 文件。整个文件进入（最多 20 个对象），然后可搜索的表格视图显示它。我不确定是否应该以不同的方式解析 JSON 文件，或者是否应该让表格视图仅显示所需的结果。（在这种情况下，性能不是问题。）。JSON 文件被转换为 NSArray。

这是数组的一部分：

```
 {
    adminCode1 = MA;
    adminCode2 = 027;
    adminName1 = Massachusetts;
    adminName2 = "Worcester County";
    adminName3 = "";
    adminName4 = "";
    adminName5 = "";
    continentCode = NA;
    countryCode = US;
    countryName = "United States";
    elevation = 178;
    fcl = A;
    fclName = "country, state, region,...";
    fcode = ADMD;
    fcodeName = "administrative division";
    geonameId = 4929431;
    lat = "42.2000939";
    lng = "-71.8495163";
    name = "Town of Auburn";
    population = 0;
    score = "53.40083694458008";
    timezone =         {
        dstOffset = "-4";
        gmtOffset = "-5";
        timeZoneId = "America/New_York";
    };
    toponymName = "Town of Auburn";
}, 
```

我想要做的是如果“fcl”（在数组中看到）等于 P，那么我希望它在表格视图中显示。如果“fcl”是其他字符，那么我不希望它出现在表格视图中。我很确定 if 语句可以做到这一点，但我不知道如何获取它以便过滤其中的一部分。

任何帮助，将不胜感激！谢谢

编辑：截至目前，这是要搜索的代码：

```
 - (void)delayedSearch:(NSString*)searchString
{
    [self.geoNamesSearch cancel];
    [self.geoNamesSearch search:searchString
                        maxRows:20
                       startRow:0
                       language:nil];
}

- (BOOL)searchDisplayController:(UISearchDisplayController *)controller shouldReloadTableForSearchString:(NSString *)searchString
{
    self.searchDisplayController.searchBar.prompt = NSLocalizedStringFromTable(@"ILGEONAMES_SEARCHING", @"ILGeoNames", @"");
    [self.searchResults removeAllObjects];

    // Delay the search 1 second to minimize outstanding requests
    [NSObject cancelPreviousPerformRequestsWithTarget:self];
    [self performSelector:@selector(delayedSearch:) withObject:searchString afterDelay:0];

    return YES;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T22:38:00.843

你的问题基本上是，你如何从搜索栏字符串中过滤你的数组？如果是这样，您可以检测文本何时更改`UISearchBarDelegate`，然后通过您的数组复制包含您正在查找的字符串的那些对象，即

这是您想要的委托方法：`searchBar:textDidChange:`.

```
[filterArray removeAllObjects];
for(int i = 0; i < [normalArray count]; i++){
    NSRange textRange;
    textRange =[[[[normalArray objectAtIndex:i] objectForKey:@"name"] lowercaseString] rangeOfString:[searchBarString lowercaseString]];
    //I wasn't sure which objectForKey: string you were looking for, just replace the one you want to filter.
       if(textRange.location != NSNotFound)
       {

        [filterArray addObject:[normalArray objectAtIndex:i]];

       }
}

filterTableView = YES;
[tableView reloadData]; 
```

注意`filterTableView`bool 值，这是为了让您的 tableView 知道是正常加载还是您刚刚制作的过滤版本。你实现这个：

```
tableView:numberOfRowsInSection:  //For number of rows.
tableView:cellForRowAtIndexPath:  //For the content of the cells. 
```

希望这就是你要找的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-24T23:31:36.887

```
NSMutableArray* filtered = [[NSMutableArray alloc] autorelease];

for (int i=0;i<[data count];i++)
{
   NSDictionary* item=[data objectAtIndex:i];

   if (@"P" == [item objectForKey:@"fcl"] )
  {
    [filtered addObject:item];
  }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-24T22:36:44.090

因此，每次搜索字段更改时，您都会计算一个新数组，然后重新加载您的 tableview。行数将是过滤数组中的行数。

要计算新数组，您可以这样做（假设一个字典数组）：

```
NSString *searchString; // from the search field
NSMutableArray *array = [NSMutableArray arrayWithCapacity:[origArray count]];
for(NSDictionary *dict in origArray) {
  NSString *val = [dict objectForKey:@"fcl"];
  if([val length] >= searchString) {
    NSString subString = [val substringToIndex:[searchString length]];
    if([subString isEqualToString:val]) [array addObject:dict];
  }
} 
```

然后每个单元格将从新数组中获取其值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-24T22:36:30.480

只需将您的 json 放入 NSDictionary 中，然后简单地执行以下操作：

```
if ([[yourJson objectForKey:@"fcl"] stringValue] == @"A")
    //doSomething 
```

# python - 在 PyGame (SDL) 中使用 Cairo 时的字节顺序

> ID：11640161
> 
> 赞同：3
> 
> 时间：2012-07-24T22:20:39.697
> 
> 标签：python, sdl, pygame, cairo, pycairo

我目前有一些使用 pycairo 绘制并通过 PyGame 呈现到 SDL 表面的代码。这在 Linux 和 Windows 上运行良好，但 Mac 让我头疼。一切都只是蓝色或粉红色字节顺序似乎是 BGRA 而不是 ARGB，我尝试使用 pygame.Surface.set_masks 和 set_shifts 无济于事。这仅在 mac (osx 10.6) 上被破坏：

```
import cairo
import pygame

width = 300
height = 200

pygame.init()
pygame.fastevent.init()
clock = pygame.time.Clock()
sdl_surface = pygame.display.set_mode((width, height))

c_surface = cairo.ImageSurface(cairo.FORMAT_ARGB32, width, height)
ctx = cairo.Context(c_surface)

while True:
    pygame.fastevent.get()
    clock.tick(30)
    ctx.rectangle(10, 10, 50, 50)
    ctx.set_source_rgba(0.0, 0.0, 0.0, 1.0)
    ctx.fill_preserve()

    dest = pygame.surfarray.pixels2d(sdl_surface)
    dest.data[:] = c_surface.get_data()
    pygame.display.flip() 
```

我可以通过阵列切片或使用 PIL 来修复它，但这会降低我的帧速率。有没有办法就地或通过设置做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T14:25:00.877

经过大量的头发撕裂后，我有一个解决方法，它不会通过简单地反转阵列而对我的帧速率造成太大影响：

```
import cairo
import pygame

width = 300
height = 200

pygame.init()
pygame.fastevent.init()
clock = pygame.time.Clock()
sdl_surface = pygame.display.set_mode((width, height))

c_surface = cairo.ImageSurface(cairo.FORMAT_ARGB32, width, height)
ctx = cairo.Context(c_surface)

while True:
    pygame.fastevent.get()
    clock.tick(30)
    ctx.rectangle(10, 10, 50, 50)
    ctx.set_source_rgba(1.0, 0.0, 0.0, 1.0)
    ctx.fill_preserve()

    dest = pygame.surfarray.pixels2d(sdl_surface)
    dest.data[:] = c_surface.get_data()[::-1]
    tmp = pygame.transform.flip(sdl_surface, True, True)
    sdl_surface.fill((0,0,0))    #workaround to clear the display
    del dest     #this is needed to unlock the display surface
    sdl_surface.blit(tmp, (0,0))
    pygame.display.flip() 
```

我必须从临时 Surface 中删除数组和 blit 的事实似乎不正确，但这是翻转显示的唯一方法。如果有人在这里有更清洁的建议，请发表评论。

# android - Android bringToFront 导致闪烁

> ID：11640162
> 
> 赞同：2
> 
> 时间：2012-07-24T22:20:44.853
> 
> 标签：android, animation, flicker

我正在为三个相互堆叠的视图制作动画。当我点击一个不是前视图的视图时，一个或两个视图会向上或向下滑动以打开被点击的视图，将被点击的视图放在前面，然后将所有内容返回到它们的原始位置。其中大部分工作正常。只有当我将一个我刚刚动画化的视图带到前面时，我才会看到明显的闪烁。

我已经阅读了至少一百篇文章，但没有一篇包含解决方案。我发布此内容是为了将每个建议的解决方案整合到一个地方，并希望找到解决方案。

我知道动画不会动画视图本身，而只是一个图像。视图保持在其原始位置。这肯定与此有关。仅在将刚刚移动的视图置于前面时才会发生这种情况。

在开始动画之前或动画结束之后将视图移动到动画结束位置并没有一点帮助。

它也与`AnimationListener.onAnimationEnd`错误无关，因为我得出了自己的观点并`onAnimationEnd`在那里拦截。

我正在使用`Animation.setFillAfter`并将`Animation.setFillEnabled`最终图像保留在动画结束位置。

我试过使用`Animation.setZAdjustment`，但那个只适用于整个屏幕，而不是屏幕内的视图。

从我了解到的情况来看，我怀疑问题`bringToFront()`本身就是`removeChild()/addChild()`父视图。可能是`removeChild`导致重绘显示没有删除子项的视图的原因。

**所以我的问题是：**有没有人看到我错过的任何可以解决这个问题的东西？*Android*是否可能有命令暂时停止绘图并稍后恢复绘图。有点像一`setUpdateScreen(false) / setUpdateScreen(true)`对？这将允许我跳过*闪烁*阶段。

演示效果的最少代码如下。点击白色可以看到红色在白色后面上下移动而不*闪烁*（白色出现在前面但不移动）。然后点击红色以查看红色从白色后面向上移动，当它被带到前面时闪烁，就在它滑回白色之前。奇怪的是，当使用蓝色而不是红色时，同样的事情并不总是发生。

***MainActivity.java***

```
package com.example.testapp;

import com.example.testapp.ImagePanel.AnimationEndListener;
import android.app.Activity;
import android.os.Bundle;
import android.view.View;
import android.view.animation.TranslateAnimation;

public class MainActivity extends Activity
{
  private static final int ANIMATION_TIME = 1000;

  private ImagePanel mRed;
  private ImagePanel mWhite;
  private ImagePanel mBlue;
  private int mFrontPanelId;

  private void animate(final ImagePanel panel, final int yFrom, final int yTo,
      final AnimationEndListener animationListener)
  {
    final TranslateAnimation anim = new TranslateAnimation(0, 0, 0, 0, 0, yFrom, 0, yTo);
    anim.setDuration(ANIMATION_TIME);
    anim.setFillAfter(true);
    anim.setFillEnabled(true);
    if (animationListener != null)
    {
      panel.setAnimListener(animationListener);
    }
    panel.startAnimation(anim);
  }

  public void onClick(final View v)
  {
    final int panelId = v.getId();
    if (mFrontPanelId == panelId)
    {
      return;
    }
    final ImagePanel panel = (ImagePanel) v;

    final int yTop = mWhite.getTop() - mRed.getBottom();
    final int yBot = mWhite.getBottom() - mBlue.getTop();

    final boolean moveRed = panelId == R.id.red || mFrontPanelId == R.id.red;
    final boolean moveBlue = panelId == R.id.blue || mFrontPanelId == R.id.blue;

    animate(mBlue, 0, moveBlue ? yBot : 0, null);
    animate(mRed, 0, moveRed ? yTop : 0, new AnimationEndListener()
    {
      public void onBegin()
      {
      }

      public void onEnd()
      {
        // make sure middle panel always stays visible
        if (moveRed && moveBlue)
        {
          mWhite.bringToFront();
        }

        panel.bringToFront();

        animate(mBlue, moveBlue ? yBot : 0, 0, null);
        animate(mRed, moveRed ? yTop : 0, 0, new AnimationEndListener()
        {
          public void onBegin()
          {
          }

          public void onEnd()
          {
          }
        });

        mFrontPanelId = panelId;
      }
    });
  }

  @Override
  public void onCreate(final Bundle savedInstanceState)
  {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    mRed = (ImagePanel) findViewById(R.id.red);
    mWhite = (ImagePanel) findViewById(R.id.white);
    mBlue = (ImagePanel) findViewById(R.id.blue);
    mFrontPanelId = R.id.red;
  }
} 
```

***图像面板.java***

```
package com.example.testapp;

import android.content.Context;
import android.util.AttributeSet;
import android.widget.ImageView;

public class ImagePanel extends ImageView
{
  public interface AnimationEndListener
  {
    public void onBegin();

    public void onEnd();
  }

  private AnimationEndListener mAnim = null;

  public ImagePanel(final Context context)
  {
    super(context);
  }

  public ImagePanel(final Context context, final AttributeSet attrs)
  {
    super(context, attrs);
  }

  public ImagePanel(final Context context, final AttributeSet attrs, final int defStyle)
  {
    super(context, attrs, defStyle);
  }

  @Override
  protected void onAnimationEnd()
  {
    super.onAnimationEnd();
    clearAnimation();
    if (mAnim != null)
    {
      final AnimationEndListener anim = mAnim;
      mAnim = null;
      anim.onEnd();
    }
  }

  @Override
  protected void onAnimationStart()
  {
    super.onAnimationStart();
    if (mAnim != null)
    {
      mAnim.onBegin();
    }
  }

  public void setAnimListener(final AnimationEndListener anim)
  {
    mAnim = anim;
  }
} 
```

**activity_main.xml**

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/main"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent" >

    <com.example.testapp.ImagePanel
        android:id="@+id/blue"
        android:layout_width="300dp"
        android:layout_height="300dp"
        android:layout_alignParentBottom="true"
        android:layout_centerHorizontal="true"
        android:background="#000080"
        android:src="@drawable/testpattern"
        android:onClick="onClick" />

    <com.example.testapp.ImagePanel
        android:id="@+id/white"
        android:layout_width="300dp"
        android:layout_height="300dp"
        android:layout_centerHorizontal="true"
        android:layout_centerVertical="true"
        android:background="#808080"
        android:src="@drawable/testpattern"
        android:onClick="onClick" />

    <com.example.testapp.ImagePanel
        android:id="@+id/red"
        android:layout_width="300dp"
        android:layout_height="300dp"
        android:layout_alignParentTop="true"
        android:layout_centerHorizontal="true"
        android:adjustViewBounds="true"
        android:background="#800000"
        android:src="@drawable/testpattern"
        android:onClick="onClick" />

</RelativeLayout> 
```

***测试模式.xml***

```
<?xml version="1.0" encoding="utf-8"?>
<shape xmlns:android="http://schemas.android.com/apk/res/android"
    android:shape="oval" >

    <gradient

        android:startColor="#00000000"
        android:endColor="#ffffffff" />

</shape> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T05:23:53.557

您是否需要随时可见所有图像？您可以将它们的可见性设置为不可见，这样它们就不会打扰您。一旦你需要它们，你就可以让它们再次可见。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-29T19:04:29.253

尝试呼入`animation.cancel()`。`onAnimationEnd`我记得前段时间我在执行代码后遇到了类似的动画闪烁问题，`onAnimationEnd`这就是诀窍。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-23T14:56:06.097

`bringToFront()`在动画期间调用时，我观察到了同样的问题。

我可以通过使用包含我正在制作动画的孩子的`setChildrenDrawingOrderEnabled(boolean enabled)`和来解决我的问题。`getChildDrawingOrder(int childCount, int i)``ViewGroup`

# ruby-on-rails-3 - 总体布局中的导轨形式

> ID：11640166
> 
> 赞同：0
> 
> 时间：2012-07-24T22:21:01.930
> 
> 标签：ruby-on-rails-3, forms

我知道这是一个新手问题，只是不确定我错过了什么，并决定在我通常通过谷歌搜索后发布。我正在尝试从应用程序页脚中的表单（对于时事通讯）将内容发布到数据库，因此在整个应用程序中重复视图。现在，当我提交表单时，会在数据库中创建一个新对象，但所有字段都是“NULL”。看来我需要将*@newsletter*变量放在某个地方，我只是不确定在哪里。

**部分我在视图中渲染**

```
<%= form_tag({:controller => "newsletters", :action => "create"}, :method => "post", :id => "footer_email_form") do %>

    <%= text_field_tag :first_name, '', id: "footer_email_firstname" %>
    <%= text_field_tag :last_name, '', id: 'footer_email_lastname' %>
    <%= text_field_tag :email, '', id: 'footer_email_address' %>
    <%= submit_tag "Submit", :name => nil, id: 'footer_email_submit', class: "btn btn-primary" %>
<% end %> 
```

**控制器（创建动作）**

```
class NewslettersController < ApplicationController

  def create
    @newsletter = Newsletter.new(params[:newsletter])

      if @newsletter.save
          format.html { redirect_to 'pages#home', notice: 'Thank You for signing up for our newsletter' }
          format.json { render json: @newsletter, status: :created, location: @newsletter }
        else
          format.json { render json: @newsletter.errors, status: :unprocessable_entity }
      end
  end
end 
```

**路线**

```
resources :newsletters, :only => [:create, :destroy] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T05:34:12.453

使用这样的东西：

```
<%= form_for Newsletter.new do |f| %>
    <%= f.text_field :first_name %>
    <%= f.text_field :last_name %>
    <%= f.text_field :email %>
    <%= f.submit_tag "Submit", class: "btn btn-primary" %>
<% end %> 
```

您的原始表单的工作方式参数是这样提交的：

```
params = {
  :first_name => 'A',
  :last_name  => 'B',
  :email      => 'C',
  # and so on...
} 
```

现在，如果您什么都不做`@newsletter = Newsletter.new(params[:newsletter])`，因为`params[:newsletter]`是`nil`，因此您的所有属性都将是`nil`（并显示`NULL`在数据库中）。

您应该始终关注开发日志。它将帮助您调试此类错误。

# php - PHP中的编码理论：需要为多个队列引导流量（多路复用）

> ID：11640172
> 
> 赞同：4
> 
> 时间：2012-07-24T22:21:50.790
> 
> 标签：php, multiplexing

我正在为我们的员工整理一个界面，以上传他们需要行业统计数据的产品列表（目前一次手动执行一个）。
然后，每个产品都将通过 webservice api 提供给我们的统计引擎。
我会回复的。Stat 的引擎将从我的 api 请求“下一个受害者”。

用户上传的每个列表将有 50 到 1000 个产品，并且将是自己的队列。
目前，队列/列表可能每天大约添加（并通过完成删除）10-20 次。
如果成功，几个月后流量可能会增加到每天 700-900 个列表。

我们只是计划采用一种简单的循环方法来将流量均匀地引导到队列中。*多路复用器将从List A*
中获取顶部项目，然后是*List B*，然后是*List C*等等，直到再次循环回到*List A* ......请记住，可以随时添加/删除列表/队列。

 ***我面临的问题只是概念化管理。
我考虑将每个队列存储为一个平面文件并通过关系数据库（MySQL）管理轮换。想过反过来做。考虑过使用完全平面文件或完全关系数据库......底线，我很灵活。
无论如何，当我尝试无国籍地将可变的参与者列表与循环旋转融合在一起时，我的大脑只是蒸汽锁定（我刚从一个短暂的假期回来，我认为我的大脑还没有回家；）

有没有人做过这样的事情？
你是怎么处理的呢？
如果你必须再做一次，你会改进什么？

欢迎任何和所有提示/建议/建议。

注意：由于来自我们统计引​​擎/工具的每个请求都将相隔很多秒，如果不是几分钟的话，我需要保持这个无状态。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T23:02:14.717

当然，列表数据应该存储在数据库中。您的 PHP 端应该有一个显示系统状态的视图，以及添加列表的表单。

由于每个请求都成为自己的队列，并且所有请求队列的优先级都被认为是相同的，因此理想的表数可能是三个。一个列出**请求**及其相对于另一个的优先级（以确定谁在轮询中下一个）和处理状态，另一个列出每个请求的尚未处理的**内容**（列表项），第三个表列出每个队列中已**处理的项目**。

您还需要一个执行实际处理的脚本，该脚本不是由用户请求驱动，而是由系统调度的定期执行的作业（限制为您想要的任何内容）驱动。这当然也可以在 PHP 中。您可以在此处设置一次 10 次列表检查和更新。

处理将类似于：

1.  从最高优先级队列中选择下一组最多 10 个项目。
2.  处理它们，在它们完成时更新它们的数据库状态。
3.  更新上述队列的优先级，使其现在是最低优先级。

如果添加新队列，它们将以最低优先级添加。

优先级可以用整数表示。

您的用户需要耐心等待他们的列表得到处理，然后查看或下载结果。您可以在视图页面上为此设置一个自动刷新脚本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-25T01:37:42.977

听起来您正在尝试实现[Gearman](http://gearman.org/)已经做得很好的东西。对于每个上传/请求，您可以简单地将作业发送到 Gearman 服务器以进行排队。

Gearman 可以配置为持久的（以防万一事情变糟），这应该消除您在关系数据库中记录请求的需要。

然后，您可以根据需要启动任意数量的工人。我知道您建议串行运行所有作业，您仍然可以这样做，但您也可以并行化工作，这样您的用户就不会像所有作业都以串行方式处理时那样久坐时尚。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-25T12:46:52.370

经过一夜好眠后，我现在对自己有了智慧（我希望:)。
一个简单的解决方案是优先级的平面文件。
有一个文本文件，每行只有一个列表/队列 ID。*从*列表的一端
馈送，然后添加*到*另一端......简单。

 **欢迎批评；o)

感谢@Trylobot 和@Chris_Henry 的反馈。*****

# ravendb - 如何在 RavenDB 中完成此查询

> ID：11640173
> 
> 赞同：1
> 
> 时间：2012-07-24T22:21:53.847
> 
> 标签：ravendb

我在 RavenDb 中有这样的东西：

路径 [hasMany] 目标 [hasMany] 成就

所以我有一份包含目标和成就的文件。

如果它是传统数据库，我可以进行此查询

```
select g.id, count(a.id)
from path p
join goals g on p.id = g.pathId
join achievement a on a.id = g.id
group by goal.id 
```

如何在 ravendb 中进行此查询？

现在我正在这样做：

```
Path path = RavenSession.Load<Path>(pathId);

path.Goals.Select(x => new
{
    Id = x.Id,
    Name = x.Name,
    TOnCourse = x.Achievements.Where(y => y.Resolution == Resolution.OnCourse).Count(),
    TAstray = x.Achievements.Where(y => y.Resolution == Resolution.Astray).Count()
}); 
```

我不想这样做，因为我认为我正在加载所有“目标”和“成就”，而我只想在数据库中进行聚合（ravendb）

如果你想知道我的模型中真正的路径、目标和成就是我的“宠物”项目[http://dpath.apphb.com/](http://dpath.apphb.com/)

**编辑** 我想我会得到那些“计算”的值并将它们作为属性放在目标中，因为我认为计算将非常普遍，因此保持简单，因为无法删除成就，并且用户将具有“关系” 有目标和成就的数量以获得“我的统计数据”

不过，我想知道您将如何在 RavenDb 中完成该查询

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T12:05:51.740

为此，您只加载了一个文档，因此这可能不是问题。您没有加载任何其他内容。

您可以在索引中执行此操作，然后从那里加载存储的字段，但我认为您不需要这个，除非您的文档*非常*大。

# image - 上传的 FTP 文件不反映在网站上

> ID：11640174
> 
> 赞同：4
> 
> 时间：2012-07-24T22:21:59.993
> 
> 标签：image, file, web, ftp, updating

上传的文件不会反映在网站上。

我做了一些离线编辑，并通过 FTP 将更改上传到我的网站。显示了一些更改，但未显示在导航、徽标和标题背景（图像）上。我已经完全按照应有的方式复制了每个文件，但它并没有反映在网站上。

该网站位于：[http ://www.vargasjpr.com](http://www.vargasjpr.com)

对此有什么帮助吗？我将不胜感激。

编辑：

该标志应该显示公司的标志，而不是“灵感”标志。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-24T22:26:33.000

在浏览器中按住 SHIFT 按钮，然后用鼠标单击 url 附近的 REFRESH 按钮。我怀疑您正在查看旧图像的缓存副本，只需要清除缓存。

另一种方法是工具 -> Internet 选项 ... 通过浏览器菜单。

* * *

这是我看到的徽标 URL： [http ://www.vargasjpr.com/images/logo.png](http://www.vargasjpr.com/images/logo.png)

如果缓存不好，您可以做的另一件事是将徽标文件的名称和代码中的名称更改为 logo2.png，但清除缓存应该可以。

# c# - C#多线程返回

> ID：11640175
> 
> 赞同：0
> 
> 时间：2012-07-24T22:22:08.670
> 
> 标签：c#, multithreading

我不熟悉多线程。Image 我有一种方法可以对字符串进行深入搜索，并返回 2 个整数列表作为输出参数。

```
public static void CalcModel(string s, out List<int> startPos, out List<int> len)
    {
        // Do some intensive search
    } 
```

对长字符串的搜索非常耗时。所以我想把字符串分成几个片段，用多线程搜索，然后重新组合结果（相应地调整 startPos）。

如何在这种过程中集成多线程？谢谢

我忘了提到以下两件事：

1.  我想设置一个字符串长度截止，并让代码决定它需要多少个片段。
2.  我很难将每个片段（在原始字符串上）的 startPos 与线程相关联。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T22:32:57.070

通常，您不会过于拘泥于细节，而是向每个线程发送一个“返回对象”。一旦你启动了所有线程，你就阻塞它们并等待它们全部完成。

在每个线程运行时，线程修改其工作对象并在产生输出时终止。

大致就是这样（我不能确切地说你想如何拆分它，所以也许你可以修改它）：

```
public class WorkItem {
    public string InputString;
    public List<int> startPos;
    public List<int> len;
}

public static void CalcLotsOfStrings(string s, out List<int> startPos, out List<int> len)
{
    WorkItem wi1 = new WorkItem();
    wi1.InputString = s;
    Thread t1 = new Thread(InternalCalcThread1);
    t1.Start(wi1);
    WorkItem wi2 = new WorkItem();
    wi2.InputString = s;
    Thread t2 = new Thread(InternalCalcThread2);
    t2.Start(wi2);

    // You can now wait for the threads to complete or start new threads
    // When you're done, wi1 and wi2 will be filled with the updated data
    // but make sure not to use them until the threads are done!
}

public static void InternalCalcThread1(object item)
{
    WorkItem w = item as WorkItem;
    w.startPos = new List<int>();
    w.len = new List<int>();

    // Do work here - populate the work item data
}

public static void InternalCalcThread2(object item)
{
    // Do work here
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T22:34:01.267

你可以试试这个，但我不确定这些方法的性能

```
Parallel.Invoke(
           () => CalcModel(s,startPos, len), 
           () => CalcModel(s,startPos, len)
               ); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T22:36:19.293

创建和运行多个线程是一项非常简单的任务。您所需要的只是作为线程起点的方法。

假设您拥有`CalcModel`原始帖子中定义的方法，那么您只需要做：

```
// instantiate the thread with a method as starting point
Thread t = new Thread(new ThreadStart(CalcModel));

// run the thread
t.Start(); 
```

但是，如果您希望线程返回一些值，您可能会应用一个小技巧，因为您不能像使用`return`语句或`out`参数那样直接返回值。

您可以将线程“包装”在自己的类中，并让他将其数据存储在类的字段中：

```
public class ThreadClass {

    public string FieldA;
    public string FieldB;
    //...

    public static void Run () {

        Thread t = new Thread(new ThreadStart(_run));
        t.Start();
    }

    private void _run() {

        //...
        fieldA = "someData";
        fieldB = "otherData"
        //...
    }
} 
```

这只是一个非常粗略的例子来说明这个想法。我不包括任何用于线程同步或线程控制的部分。

我想说更困难的任务是考虑`CalcModel`以一种可以并行化的方式拆分您的方法，然后可能更重要的是如何将部分结果连接在一起以形成一个单一的最终解决方案。

# facebook - 如何获取用户观看或与应用程序关联的所有 Open Graph 视频？

> ID：11640178
> 
> 赞同：0
> 
> 时间：2012-07-24T22:22:20.023
> 
> 标签：facebook, facebook-graph-api, video

抱歉，如果之前已回答过此问题。

我知道如何从给定用户那里获取手表操作：

[https://graph.facebook.com/me/video.watches](https://graph.facebook.com/me/video.watches)

我的问题是您如何获得观看的视频？通过遍历我在 video.watches 中返回的列表来这样做是荒谬的，因为可能存在重复等。

在开放图形文档中，它说您可以执行类似 /me/recipebox:cook/recipes 的操作

（取自[https://developers.facebook.com/docs/opengraph/objects/](https://developers.facebook.com/docs/opengraph/objects/) - 检索一组对象）

但我似乎无法弄清楚如何将其应用于 video.watches （类型是“video.other”）

获取在整个应用程序中观看的视频列表也可以。

提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-17T18:53:24.057

该调用`me/video.watches`应为您提供所有应用程序中的所有手表。很可能您`user_actions.video`缺少权限。它不应该返回重复项。如果它确实考虑提交错误。

# python - Python-ldap 搜索：超出大小限制

> ID：11640187
> 
> 赞同：1
> 
> 时间：2012-07-24T22:23:34.983
> 
> 标签：python, ldap, python-ldap

我正在使用 python-ldap 库连接到我们的 LDAP 服务器并运行查询。我遇到的问题是，尽管对搜索设置了大小限制，但在任何会返回太多结果的查询中，我都会不断收到 SIZELIMIT_EXCEEDED 错误。我知道查询本身正在运行，因为如果查询返回一小部分用户，我将得到结果。即使我将大小限制设置为荒谬的值，例如 1，我仍然会在那些更大的查询中获得 SIZELIMIT_EXCEEDED。我在下面粘贴了我的查询的通用版本。关于我在这里做错了什么的任何想法？

```
result = self.ldap.search_ext_s(self.base, self.scope, '(personFirstMiddle=<value>*)', sizelimit=5) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T10:04:39.400

当 LDAP 客户端请求大小限制时，称为“客户端请求的”大小限制。客户端请求的大小限制不能覆盖服务器设置的大小限制。服务器可以为整个服务器、特定授权身份或其他原因设置大小限制——无论哪种情况，客户端都不能覆盖服务器大小限制。可能必须使用`simple paged results`控件或`virtual list view`控件在多个部分中发出搜索请求。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-05-15T21:03:10.530

这是我在大量编辑我在[此处](https://blog.ls-al.com/python-ldap-query-active-directory/)和[官方文档](https://www.python-ldap.org/en/latest/reference/ldap.html)中找到的内容后提出的 Python3 实现。在撰写本文时，它适用于 pip3 包[python-ldap](https://pypi.org/project/python-ldap/)版本 3.2.0。

```
def get_list_of_ldap_users():
    hostname = "google.com"
    username = "username_here"
    password = "password_here"
    base = "dc=google,dc=com"

    print(f"Connecting to the LDAP server at '{hostname}'...")
    connect = ldap.initialize(f"ldap://{hostname}")
    connect.set_option(ldap.OPT_REFERRALS, 0)
    connect.simple_bind_s(username, password)
    connect=ldap_server
    search_flt = "(personFirstMiddle=<value>*)" # get all users with a specific middle name
    page_size = 500 # how many users to search for in each page, this depends on the server maximum setting (default is 1000)
    searchreq_attrlist=["cn", "sn", "name", "userPrincipalName"] # change these to the attributes you care about
    req_ctrl = SimplePagedResultsControl(criticality=True, size=page_size, cookie='')
    msgid = connect.search_ext(base=base, scope=ldap.SCOPE_SUBTREE, filterstr=search_flt, attrlist=searchreq_attrlist, serverctrls=[req_ctrl])

    total_results = []
    pages = 0
    while True: # loop over all of the pages using the same cookie, otherwise the search will fail
        pages += 1
        rtype, rdata, rmsgid, serverctrls = connect.result3(msgid)
        for user in rdata:
            total_results.append(user)

        pctrls = [c for c in serverctrls if c.controlType == SimplePagedResultsControl.controlType]
        if pctrls:
            if pctrls[0].cookie: # Copy cookie from response control to request control
                req_ctrl.cookie = pctrls[0].cookie
                msgid = connect.search_ext(base=base, scope=ldap.SCOPE_SUBTREE, filterstr=search_flt, attrlist=searchreq_attrlist, serverctrls=[req_ctrl])
            else:
                break
        else:
            break
    return total_results 
```

这将返回所有用户的列表，但您可以根据需要对其进行编辑以返回您想要的内容而不会遇到`SIZELIMIT_EXCEEDED`问题:)

# objective-c - 在 Objective-C 中使用 std::string 作为数据成员

> ID：11640188
> 
> 赞同：0
> 
> 时间：2012-07-24T22:23:55.410
> 
> 标签：objective-c, objective-c++, stdstring

我想在我的 Objective-C 代码中使用 C++ 字符串对象而不是 NSString，所以我不需要隐藏它（我更经常需要 std::string），我尝试这样做：

```
using namespace std;

@interface InstrumentGridViewController : UIViewController {   
string* trackName; // also tried using std::string, didn't work
@property (nonatomic, assign) string* trackName;
} 
```

不过，我遇到了错误，`string* trackName;`语句和`@property`行都给了我`Expected specifier-qualifier-list 'string'`.

**编辑：**我忘了添加`#include <string>`，但添加这给了我错误`String: no such file or directory`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T23:01:02.673

重要的是包含此头文件的源文件。如果此头文件包含在普通的 Objective-C 源文件（.m 扩展名）中，编译器将如您所描述的那样阻塞。如果你仔细检查 Xcode 中的错误，你可以准确地看到这个头文件在哪个或哪些源文件中编译失败。

这就是为什么经常建议不要在旨在供 Objective C 代码使用的头文件中使用 C++ 对象的原因。头文件中的 C++ 往往会在您的代码库中流血，并迫使您编译所有目标 C++（.mm 扩展名）。请注意，使用现代运行时和类扩展，很容易解决这个问题。只需移动您的：

```
@property (nonatomic, assign) string* trackName; 
```

到 InstrumentGridViewController.mm 文件中的类扩展，并删除`trackName`现代运行时不需要的 ivar 声明。然后，您的标头是 Objective C 干净的，并且可以包含在您的其余代码中。Rob Napier 在[Wrapping C++ Final Edition](http://robnapier.net/blog/wrapping-cppfinal-edition-759)中有更多讨论。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-25T16:48:52.790

如果您想将所有内容编译为 Obj-c++ 并且不想经历更改所有文件扩展名的繁琐过程，只需将`-x objective-c++`标志提供给编译器（项目设置 -> 其他 c 标志）并与 stdlibc++ 链接。这样您就可以使用 c++ 所有其他代码而无需担心

# javascript - jQuery Validation - 获取 invalidHandler 中错误字段的列表

> ID：11640189
> 
> 赞同：18
> 
> 时间：2012-07-24T22:23:57.137
> 
> 标签：javascript, jquery, .net, validation, jquery-validate

我在页面上使用 jQuery 验证。在调用 invalidHandler 期间，我希望能够访问所有未通过验证的表单元素的列表。

此函数作为选项之一传递给 jQuery.validate() 方法...

```
invalidHandler: function (form) {
    var validator = $("#AddEditFinancialInstitutionForm").validate();
    validator.showErrors();
    console.log(validator);
} 
```

我试图在生成的验证器对象中的某处找到此信息，但我似乎找不到它。还有其他方法可以访问此信息吗？

谢谢

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-07-25T15:12:04.943

在 中`invalidHandler`，您被传递了两个参数，a`jQuery.Event`和`validator`对象。您不需要在您的 invalidHandler 中调用 validate 来获取 validate 对象。此外，验证器对象有一个名为`errorList`and的属性`errorMap`，其中包含您要查找的信息。

```
invalidHandler: function(e,validator) {
    //validator.errorList contains an array of objects, where each object has properties "element" and "message".  element is the actual HTML Input.
    for (var i=0;i<validator.errorList.length;i++){
        console.log(validator.errorList[i]);
    }

    //validator.errorMap is an object mapping input names -> error messages
    for (var i in validator.errorMap) {
      console.log(i, ":", validator.errorMap[i]);
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-25T03:42:47.220

如果您使用的是默认错误类并且只找到无效元素，请使用

```
 $(this).find("input.error") // inside invalidHandler 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-10-26T05:03:43.957

使用它来获取错误字段的整个元素及其属性。

```
 var formerrorList = $("#FORM_ID_HERE").data("validator").errorList;
        $.each(formerrorList, function (key, value) {
            console.log(formerrorList[key].element.id);
        }); 
```

# java - JPQL 表连接查询

> ID：11640190
> 
> 赞同：1
> 
> 时间：2012-07-24T22:24:00.117
> 
> 标签：java, hibernate, jpa-2.0, eclipselink

如何让 JPA 和 JPQL 将完整的连接查询传递给 RDBMS？例如，

```
SELECT e
FROM Employee e
WHERE a.runkey = e.runkey
  AND e.middle = 'M'
  AND a.state = 'MA' 
```

使用以下 Employee 类

```
@Entity
public class Employee implements Serializable {

  blah ... blah

  @OneToOne
  @JoinColumn(
    name = "runkey",
    referencedColumnName = "runkey",
    insertable=false, updatable=false)
  private Address address;
} 
```

和 JPQL，

```
SELECT e
FROM Employee e
INNER JOIN FETCH e.address AS a
WHERE a.state = :state
 AND e.middle = :middle 
```

我能够让 Hibernate JPA 按预期提取数据。

但是，eclipselink 抱怨它无法遍历关联的字段“地址”。

如果是这样，那么我应该如何设计 Employee 实体以及我应该如何使用 JPQL 来让 eclipselink 在两个表上执行带有 WHERE 过滤器的表连接？

（咆哮：否则Eclipselink JPA并不比JDO好！！！）

~

**进一步编辑**：这篇文章对我的情况有什么意义....
[https://forums.oracle.com/forums/thread.jspa?threadID=1568659](https://forums.oracle.com/forums/thread.jspa?threadID=1568659)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T22:59:35.387

问题是您正在尝试对根据 JPQL 规范不允许的连接提取进行别名。无论如何，Hibernate 都允许这样做。您仍然可以使用[查询提示](http://wiki.eclipse.org/EclipseLink/UserGuide/JPA/Basic_JPA_Development/Query_Hints#Join_Fetch)通过 EclipseLink 获得所需的行为。

看看以下帖子：

*   [jpa fetch 连接查询](https://stackoverflow.com/questions/8195252/jpa-fetch-join-query)
*   [EclipseLink JPQL (Glassfish v3)：加入获取语法问题？](https://stackoverflow.com/questions/2319913/eclipselink-jpql-glassfish-v3-join-fetch-syntax-problem)

以下链接也很有用：

[http://wiki.eclipse.org/EclipseLink/Examples/JPA/QueryOptimization](http://wiki.eclipse.org/EclipseLink/Examples/JPA/QueryOptimization)

# android - ActionBarSherlock setCustomView 在 Android 3.2 中不起作用

> ID：11640191
> 
> 赞同：14
> 
> 时间：2012-07-24T22:24:10.290
> 
> 标签：android, android-3.0-honeycomb, android-actionbar, android-4.0-ice-cream-sandwich, actionbarsherlock

我最近升级了我的应用程序以使用 ActionBarSherlock 4.1。由于在 Honeycomb 上运行应用程序的升级用户在操作栏上设置自定义视图时会由于空指针异常而强制关闭。

我向操作栏添加了一个包含两个微调器的自定义视图，这适用于 Android 4.0 和 4.1，但不适用于 3.2。

```
 bar.setCustomView(R.layout.custom_action_bar);// spinners
            actionBarViewHolder= new CustomActionBarViewHolder();
            actionBarViewHolder.categorySpinner = (Spinner) findViewById(R.id.actionbar_catergory);
            actionBarViewHolder.sortBySpinner = (Spinner) findViewById(R.id.actionbar_sortby); 
```

在 Android 3.2 上，尚未在 4.0 和 4.1 上找到微调器，它们的视图已找到并且一切运行顺利。

我没有在 3.0 模拟器上尝试过该应用程序，但我认为问题仍然存在。

任何想法可能是什么问题？

```
<LinearLayout android:id="@+id/linearLayout1"
    android:layout_width="wrap_content" android:layout_height="match_parent"
    android:gravity="center_vertical|center_horizontal"
    android:layout_weight="0.5">

    <TextView android:id="@+id/textView1" android:layout_width="wrap_content"
        android:layout_height="wrap_content" android:text="Category:" />

    <Spinner android:id="@+id/actionbar_catergory"
        android:layout_width="wrap_content" android:layout_height="wrap_content"
        android:entries="@array/actionbar_spinner_catergory"
        android:background="@drawable/spinner_background" />
</LinearLayout>

<LinearLayout android:id="@+id/linearLayout1"
    android:layout_width="wrap_content" android:layout_height="match_parent"
    android:gravity="center_vertical|center_horizontal"
    android:layout_weight="0.5">

    <TextView android:id="@+id/textView2" android:layout_width="wrap_content"
        android:layout_height="wrap_content" android:text="Sort By:" />

    <Spinner android:id="@+id/actionbar_sortby"
        android:layout_width="wrap_content" android:layout_height="wrap_content"
        android:entries="@array/actionbar_spinner_sortby" android:background="@drawable/spinner_background" />

</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-06-15T09:24:17.320

试试这个，它在所有设备上都能正常工作，或者你可以在[这里查看演示代码](http://www.androiddevelopersolution.com/2013/07/actionbarsherlock-with-custom-view.html)

```
getSupportActionBar().setCustomView(R.layout.actionbar_top); // load your layout
getSupportActionBar().setDisplayOptions(ActionBar.DISPLAY_SHOW_CUSTOM); 
```

图片

![在此处输入图像描述](../Images/8c9080bcdf2583aaffc0b2939fce5218.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-22T12:43:54.437

使用 actionbarsherlib 为 setCustomView 使用下面的代码。它也适用于 android 3.2 版本。

```
 getSupportActionBar().setDisplayShowCustomEnabled(true);
    View view = getLayoutInflater().inflate(R.layout.custom_view, null);
    Button mybutton = (Button)view.findViewById(R.id.button1);            
    mybutton.setOnClickListener(new OnClickListener()
    {
            @Override
            public void onClick(View v)
            {
            /** Your click actions here. */
            }
    });
    getSupportActionBar().setCustomView(view); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-03T09:04:38.987

这是我如何使用 actiobBarSherlock 创建自定义操作栏的代码

```
 private void createCustomActionBar() {

    List<SiteLink> links = new ArrayList<SiteLink>();
    links.add(...)  
    LinksAdapter linkAdapter = new LinksAdapter(this, R.layout.external_link, links);

    View customNav = LayoutInflater.from(this).inflate(R.layout.custom_show_action_bar, null);
    IcsSpinner spinner = (IcsSpinner)customNav.findViewById(R.id.spinner);
    spinner.setAdapter(linkAdapter);

    ImageView refresh = (ImageView) customNav.findViewById(R.id.refresh);
    refresh.setOnClickListener(new View.OnClickListener() {
        @Override
        public void onClick(View view) {
            ...
        }
    });

    ImageView settings = (ImageView) customNav.findViewById(R.id.settings);
    settings.setOnClickListener(new View.OnClickListener() {
        @Override
        public void onClick(View view) {
            ...
        }
    });

    getSupportActionBar().setCustomView(customNav, new ActionBar.LayoutParams(Gravity.RIGHT));
    getSupportActionBar().setDisplayShowCustomEnabled(true);

} 
```

适配器

```
private static class LinksAdapter extends ArrayAdapter<SiteLink> {

    private List<SiteLink> strings;
    private Context context;

    private LinksAdapter(Context context, int textViewResourceId, List<SiteLink> objects) {
        super(context, textViewResourceId, objects);
        this.strings = objects;
        this.context = context;
    }

    @Override
    public int getCount() {
        if (strings == null) return 0;
        return strings.size();
    }

    @Override
    public SiteLink getItem(int position) {
        return super.getItem(position);
    }

    // return views of drop down items
    @Override
    public View getDropDownView(int position, View convertView, ViewGroup parent) {

        final SiteLink siteLink = strings.get(position);
        LayoutInflater inflater = (LayoutInflater) context.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
        // at 0 position show only icon

        TextView site = (TextView) inflater.inflate(R.layout.external_link, null);
        site.setText(siteLink.getName());

        site.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View view) {
                Intent i = new Intent(Intent.ACTION_VIEW, Uri.parse(siteLink.getUrl()));
                context.startActivity(i);
            }
        });
        return site;

    }

    // return header view of drop down
    @Override
    public View getView(int position, View convertView, ViewGroup parent) {
        LayoutInflater inflater = (LayoutInflater) context.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
        return inflater.inflate(R.layout.icon, null);
    }
} 
```

布局

```
<?xml version="1.0" encoding="utf-8"?>

<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
              android:layout_width="fill_parent"
              android:layout_height="fill_parent"
               android:gravity="right"
        >

    <com.actionbarsherlock.internal.widget.IcsSpinner
        android:id="@+id/spinner"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:paddingRight="20dp"
        android:layout_gravity="center"
            />

     <ImageView  android:layout_width="fill_parent"
                 android:layout_height="fill_parent"
                 android:src="@drawable/ic_navigation_refresh"
                 android:paddingRight="20dp"
                 android:paddingLeft="10dp"
                 android:layout_gravity="center"
                 android:background="@drawable/action_buttons_background"
                 android:id="@+id/refresh"/>

    <ImageView  android:layout_width="fill_parent"
                android:layout_height="fill_parent"
                android:src="@drawable/ic_action_settings"
                android:paddingRight="20dp"
                android:background="@drawable/action_buttons_background"
                android:layout_gravity="center"
                android:id="@+id/settings"/>

</LinearLayout> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-30T09:48:01.543

尝试这个：

```
final View view = inflater.inflate(R.layout.custom_action_bar, null);
bar.setCustomView(view);// spinners
actionBarViewHolder= new CustomActionBarViewHolder();
actionBarViewHolder.categorySpinner = (Spinner) view.findViewById(R.id.actionbar_catergory);
actionBarViewHolder.sortBySpinner = (Spinner) view.findViewById(R.id.actionbar_sortby); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-05-06T21:05:20.313

你有没有试过把你的两个孩子`LinearLayout`放在一个主要的里面`LinearLayout`？也尽量不要重复孩子的 id `LinearLayout`，因为你正在让你的 id 系统哭泣。但我几乎可以肯定您的问题是您在 XML 文件中有多个主要布局。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-07-10T11:03:34.953

这是我的代码。在这里我将 Sherlock 条库添加到我的项目中。然后，我在这里用于在标题（顶部）上设置我的标题。像这样.. 试试这样.. 将目标 SDK 设置为 Android 3.2（版本 14）或更高版本..

```
 getSupportActionBar().setDisplayHomeAsUpEnabled(true);
    getSupportActionBar().setDisplayOptions(ActionBar.DISPLAY_SHOW_CUSTOM); 
    getSupportActionBar().setCustomView(R.layout.header_sherlock_xmllayout);
    header_tvleft = (TextView) findViewById(R.id.header_tvleft);
    header_tvleft.setText("Back"); 
```

试试这个方法....

# user-interface - Qt 和 GTK+，哪个更好？

> ID：11640193
> 
> 赞同：1
> 
> 时间：2012-07-24T22:24:16.067
> 
> 标签：user-interface

我正处于十字路口。我必须选择把时间花在学习 UI 库上。我在谷歌上搜索了很多关于这个主题的信息，但大部分信息已经过时或不够完整。我还在这个网站上阅读了一些问题，但我很高兴能获得更新的信息。
主要问题是：哪个 UI 库值得学习和学习？从工作的角度来看，公司要求关于这个主题的哪些知识（GTK+、Qt 或其他 UI lib/toolkit）？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T22:34:45.487

这真的取决于你对他们做了什么。

QT 支持 android 和 windows CE。虽然 GTK 没有。然而 GTK 是 GNOME 的默认设置。

此外，如果您查看两者的性能，GTK 的启动时间似乎要差得多。

[这是比较两者的绝佳链接](http://www.wikivs.com/wiki/GTK_vs_Qt)

如果您的目标只是学习更受欢迎的工作，我会根据确实趋势[QT](http://www.indeed.com/jobtrends?q=QT&l=) Vs [GTK建议 QT](http://www.indeed.com/jobtrends?q=GTK&l=)

老实说，我认为您应该在每一天或两天内对每一个进行一次秒杀，看看您更喜欢哪一个，然后选择那个。如果你学会了一个，你可以很容易地学习另一个。但是，出于自己的意愿，您会为自己喜欢的人付出更多的努力。

# javascript - 如何在每个 div 中显示一个元素？

> ID：11640194
> 
> 赞同：0
> 
> 时间：2012-07-24T22:24:24.010
> 
> 标签：javascript, jquery, mouseover

我的代码是：

```
<div id="post">
<a href="./?act=remove&post_id=13" id="remove">Delete</a>
<b>Admin</b> says:
"Hi to all my frends!"
<br>
7 hours ago &middot; 
<a id="like" href="./?act=like&id=13" title="No one likes">Like</a> &middot; 
<a id="dislike" href="./?act=dislike&id=13" title="No one dislikes">Dislike</a>
</div> 
```

我也有多个类似上面的帖子...我如何使用 jQuery 制作，每次我“鼠标悬停”#post 时，#post 中的#remove*就会*出现？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T22:27:48.613

首先，我认为您想使用`class="post"`，并且`class="remove"`如果您有多个类似的帖子。然后你可以这样做（[jsfiddle上的代码](http://jsfiddle.net/MKbCg/3/)）：

```
$(".post").on("mouseover", function(){
    $(this).find(".remove").show();
}).on("mouseout", function(){
    $(this).find(".remove").hide();
}); 
```

您可能想要研究的一些 jQuery 函数：[.on()](http://jqapi.com/#p=on)、[.mouseover()](http://jqapi.com/#p=mouseover)、[.mouseout()](http://jqapi.com/#p=mouseout)、[.hover()](http://jqapi.com/#p=hover)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-24T22:27:59.107

我为你做了一个例子：

[http://jsfiddle.net/BumbleB2na/a5vuD/1/](http://jsfiddle.net/BumbleB2na/a5vuD/1/)

您想使用类而不是 ID 来支持多个帖子。此外，您应该在启动时隐藏“删除”元素。

# windows - 如何跟踪不同目录中的 git 存储库？

> ID：11640195
> 
> 赞同：2
> 
> 时间：2012-07-24T22:24:46.907
> 
> 标签：windows, git, git-submodules

所以我有一个项目是一个 git repo，其中包含另一个 git 存储库。所以结构是这样的：

```
/gitProject
    /other
    /stuff
    /anotherGitProject 
```

目前，我已经将另一个 GitProject 设置为 gitProject 的子模块。我的问题是我必须将 anotherGitProject 部署到硬盘的另一部分。由于 anotherGitProject 作为附加组件，我只需将 anotherGitProject 的内容直接复制到另一个项目的目录树中：

```
/gitProject
    /other
    /stuff
    /anotherGitProject
/otherProject
    /(contents of anotherGitProject+otherProject) 
```

我的问题是：如何在 gitProject 中跟踪我对 anotherGitProject 所做的更改？这看起来真的很令人费解，但我需要在 otherProject 之上对 anotherGitProject 进行更改，否则这不会成为问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-25T06:30:55.443

这个想法是：

*   克隆`anotherGitProject`in `otherProject`，
    甚至*作为*otherProject （如果`anotherGitProject`需要直接 在其中的内容`otherProject`，在这种情况下：
    *   `otherProject`重 命名 `otherProject.tmp`
    *   克隆 `anotherGitProject`为`otherProject`
    *   将其余 `otherProject.tmp`内容 复制到`otherProject`
    *   添加 .gitignore 以忽略任何不是`anotherGitProject`原始内容的内容
*   添加到`anotherGitProject`初始存储库（作为子模块的那个`gitProject`）[**远程**](http://git-scm.com/docs/git-remote)指向`otherProject`

这样，您可以`otherProject`直接取回/拉回`anotherGitProject`

如果 `anotherGitProject`是，作为一个插件，一个简单的子目录 `otherProject`，这个过程就简单得多，因为正如我在第一点中提到的，你可以简单地 `anotherGitProject`直接克隆到目标（在`otherProject`）中。
远程步骤是一样的：

```
cd /gitProject/anotherGitProject
git add remote anotherGitProjectDeployed /path/to/otherProject/anotherGitProject 
```

# http - .htaccess 重定向仅在浏览器警告后执行

> ID：11640198
> 
> 赞同：9
> 
> 时间：2012-07-24T22:25:06.327
> 
> 标签：http, .htaccess, mod-rewrite

我有一个强制 HTTPS 和 www 的重写规则。SSL 证书适用于网站的 www 版本。整个站点需要是 HTTPS。

问题是如果请求是[https://example.com/](https://example.com/)，浏览器会在重定向执行之前显示一个警告页面。（Firefox 中的“此连接不受信任”和 Chrome 中的“这可能不是您要查找的站点！”）

如果用户在 Firefox 中添加异常或忽略 Chrome 中的错误，则会执行重写规则，并将他们重定向到具有 100% 安全页面的网站的 www 版本。

```
RewriteEngine on

RewriteCond %{HTTP_HOST} ^example.com$ [OR]
RewriteCond %{HTTPS} !on
RewriteRule ^(.*)$ https://www.example.com/$1 [R=301,L]

RewriteCond %{HTTP_HOST} ^www.example.com$
RewriteCond %{HTTPS} !on
RewriteRule ^(.*)$ https://www.example.com/$1 [R=301,L] 
```

我一直在测试网站上的规则以及[http://martinmelin.se/rewrite-rule-tester/](http://martinmelin.se/rewrite-rule-tester/)

如何在浏览器警告之前执行重定向？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-25T11:20:07.100

`https://example.com`从to的重定向`https://www.example.com`只能在客户端向 发出初始成功请求后发生`https://example.com`。

这是因为 HTTPS 是基于 TLS/SSL 的 HTTP（请参阅[RFC 2818](https://www.rfc-editor.org/rfc/rfc2818)），它首先在发送任何 HTTP 流量之前建立 SSL/TLS 连接。`mod_rewrite`将始终在 SSL/TLS 连接建立后应用。不这样做实际上是一个安全问题，因为攻击者可以在证书验证之前重写和重定向客户端。即使 TLS 升级在 HTTP（RFC 2817，实际上从未使用/支持且不是 https）内，您仍然希望重定向来自受信任的实体。

为了使这个初始连接正常工作，服务器`https://example.com`必须有一个有效的证书`example.com`，否则，这个连接甚至不会发生（并且服务器不会发送重定向响应）。

为了实现您的目标，您需要请求`https://example.com`出示有效的证书`example.com`和请求`https://www.example.com`出示有效的证书`www.example.com`。

有两种解决方案：

*   通过使用不同的 IP 地址或使用服务器名称指示，为每个主机使用两个不同的证书。这里的缺点是并非所有客户端都支持 SNI，即使它越来越普遍。
*   `example.com`使用对和均有效的单一证书`www.example.com`。这可以通过获取具有多个主题备用名称 (SAN) DNS 条目的证书来实现（它不能使用，`*.example.com`因为点不是通配符模式的一部分）。

后者当然是最简单的解决方案。CA 为两者颁发具有 SAN 条目的证书是很常见的`example.com`，`www.example.com`当您申请其中一个或另一个时，有时无需额外费用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T22:28:20.507

[这篇文章](http://www.webmasterworld.com/apache/3566342.htm)解决了您的问题，并提供了以下答案：

> 如果您想避免无效证书问题，您将需要 example.com 的证书。出于安全原因，不允许在身份验证之前进行重定向。

~~另一种选择可能是获取通配符证书，这将允许您匹配`*.example.com`.~~ （显然这行不通。谢谢@Giel）

您可以`http://example.com/`重定向到`https://www.example.com/`，但如果您已经有用户访问，这可能对您没有帮助`https://example.com/`。

# css - 如何根据 div 的边界半径“剪切”元素

> ID：11640200
> 
> 赞同：0
> 
> 时间：2012-07-24T22:25:16.657
> 
> 标签：css, html

我有这张图片的代码：

**CSS**：

```
section.content {
    min-height: 500px;
    width: 73%;
    float: right;
    margin-bottom:0px;
    padding: 5px;
    background: white;
    -webkit-border-top-left-radius: 100px;
    -webkit-border-bottom-right-radius: 100px;
    -moz-border-radius-topleft: 100px;
    -moz-border-radius-bottomright: 100px;
    border-top-left-radius: 100px;
    border-bottom-right-radius: 100px;
    -webkit-box-shadow: 0px 0px 18px rgba(50, 50, 50, 0.79);
    -moz-box-shadow:    0px 0px 18px rgba(50, 50, 50, 0.79);
    box-shadow:         0px 0px 18px rgba(50, 50, 50, 0.79);
}

#map {
    width: 100%;
    height: 200px;
    margin-top: 15px;
    background: #F6F6F6;
    border-radius: 4px;
} 
```

**HTML**：

```
<section class="content" id="contentContact">
    <div id="map"></div>
    <form id="contactForm" /></form>
</section> 
```

![边界半径 div](../Images/e916d7ea3444e64e3756b8a0aae4f178.png)

然后，我想根据 div 的边界半径而不是 div 来“切割”元素。我希望我已经解释了！谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T22:27:29.200

Just add this to your CSS for the outer or parent div that has the rounded corners.

```
overflow:hidden 
```

For the google map it's not as easy.

Have a look at a few different options:

[http://maps.forum.nu/temp/gm_rounded_corners.html](http://maps.forum.nu/temp/gm_rounded_corners.html)

[Is there any trick to put rounded corners on a Google map?](https://stackoverflow.com/questions/4579330/is-there-any-trick-to-put-rounded-corners-on-a-google-map)

[Transparent rounded corners on Google Map](https://stackoverflow.com/questions/6894439/transparent-rounded-corners-on-google-map)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T22:41:08.843

设置`border-radius`为`iframe`元素。

这是[jsFiddle中的一个示例](http://jsfiddle.net/DNXkW/5/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-11-24T20:29:12.503

为所有内部元素（子元素）制作 css：

```
opacity:0.99; 
```

或任何不透明度 < 1。

# for-loop - 将 Windows 批处理文件复制到 c:\*.pst 并将它们复制到网络驱动器，而不会有重复名称的文件相互覆盖

> ID：11640211
> 
> 赞同：0
> 
> 时间：2012-07-24T22:26:45.820
> 
> 标签：for-loop, batch-file, duplicates, xcopy

我的最终用户将 Outlook pst 文件分散在他们的 c 驱动器上。我想出了这个批处理文件来找到它们并将它们复制到最终用户的 M 驱动器。

```
rem **************************************************
@echo off
if not exist m:\migration mkdir m:\migration
if not exist m:\migration\pst mkdir m:\migration\pst
c:
dir /b c:\*.pst /s > m:\migration\pathdata.txt

pause

for /f "tokens=1 delims=" %%a in (m:\migration\pathdata.txt) do (copy "%%a" m:\migration\pst) 

pause 
```

但是如果文件具有相同的名称，这个微不足道的解决方案将无法处理，这是可以预料的（archive.pst）

我希望使用 xcopy 来复制它们并在驱动器 M 上创建它们的目录结构，这样同名的文件就不会相互覆盖。但我失败了。

有任何想法吗？谢谢你帮我解决这个问题

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T07:38:17.613

我用这个博客寻求帮助，请检查这个。它将搜索文件，然后复制到网络位置

[http://tshootissues.blogspot.com](http://tshootissues.blogspot.com)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-13T16:31:56.920

`dir /b c:\*.pst /s > m:\migration\pathdata.txt` 如果你打开你的 pathdata.txt 或者`for /f "tokens=1 delims=" %a in (m:\migration\pathdata.txt) do @echo %i`你会注意到你有这样的路径，你应该注意一些事情：

```
C:\Documents and Settings\USERNAME\AppData\Local\Application Data\Application Data\Application Data\Microsoft\Outlook\FILENAME.pst
C:\Users\USERNAME\AppData\Local\Application Data\Application Data\Application Data\Application Data\Microsoft\Outlook\FILENAME.pst 
```

依此类推，但请注意它实际上是同一个文件。发生这种情况是因为`dir /b c:\*.pst /s`将通过文件夹快捷方式，因此您将拥有一个 .txt 文件，其中包含许多指向同一个 .pst 的路径名，并且当您`xcopy`将多次复制同一个文件时。

您可以查看解决问题的[帖子](https://stackoverflow.com/questions/18747723/making-a-for-batch-file-search-creates-an-infinite-loop-how-do-i-stop-it)，然后您可以根据`robocopy`需要进行回答或修改。

由于您有多个用户，并且如果您的 M 驱动器是网络驱动器，您可以使用`m:\migration\%username%\pst`它来由用户复制它。这样，如果用户的 pst 与另一个用户的 pst 具有相同的名称，您将不会覆盖它，并且您将识别它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T22:56:01.167

```
XCopy /-U c:\*.pst m:\migration\pst 
```

/U 选项将仅复制已存在的文件。/-U 应该只复制那些不存在的。

或者

```
echo n|copy /-y c:\*.pst m:\migration\pst 
```

来源：[http ://www.dostips.com/forum/viewtopic.php?t=537](http://www.dostips.com/forum/viewtopic.php?t=537)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-09-20T04:57:45.560

一般警告 PST 文件可能会在网络驱动程序或服务器上受到易受攻击的威胁。这个道理也被 MVP 和微软所接受。因此，它只能在本地驱动器上使用，以避免出现任何问题。

# riak - Riak - Riak 未能在 15 秒内启动，

> ID：11640213
> 
> 赞同：1
> 
> 时间：2012-07-24T22:27:02.537
> 
> 标签：riak

尽管看似容易遵循 riak 的 ubuntu 安装说明，但我收到以下错误。

```
service riak start
Riak failed to start within 15 seconds,
see the output of 'riak console' for more information.
If you want to wait longer, set the environment variable
WAIT_FOR_ERLANG to the number of seconds to wait. 
```

1）我更新了 vm.args 和 app.config 文件中的 ip 地址并重新启动了 riak 2）我运行了以下内容：

```
riak-admin reip riak@xxx.xxx.xxx.xxx 
Attempting to restart script through sudo -u riak
Usage riak-admin reip <old_nodename> <new_nodename> 
```

[来自https://wiki.basho.com/Basic-Cluster-Setup.html](https://wiki.basho.com/Basic-Cluster-Setup.html)的 riak 文档告诉我什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T23:49:19.313

> 有关更多信息，请参阅“riak 控制台”的输出。

'riak 控制台'中有什么值得分享的吗？

> 使用 riak-admin reip

这需要两个参数。看起来你只提供了一个。

如果您需要一些实时帮助，请随时在 freenode 上访问#riak。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-19T11:11:53.150

这对我[有用http://comments.gmane.org/gmane.comp.db.riak.user/9102](http://comments.gmane.org/gmane.comp.db.riak.user/9102)

这是 RIAK 打包问题，您必须删除 RIAK 节点的 ring 文件夹并重新启动。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-01T20:39:56.677

我有同样的问题，原来是我忘记安装libssl0.9.8。

尝试使用以下命令：

```
sudo apt-get install libssl0.9.8

sudo service riak restart 
```

在早期版本中，如果没有 libssl0.9.8，甚至无法安装 Riak，但在最新版本 1.2.0 中，我没有看到任何依赖警告，只要您只绑定到 127.0.0.1，Riak 就会启动。至少这是我观察到的，实际的根本原因可能是别的。

祝你好运！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-28T13:34:07.223

如果您正在使用（当前是最新的）Riak 1.1.4，请尝试下拉之前的 1.1.2 版本。

我遇到了同样的错误，并尝试了 Erlang 和 Riak 版本的各种组合；使用早期版本的 Riak 似乎可以解决问题。

# redis - 从 redis 集中返回新的、唯一的项目

> ID：11640215
> 
> 赞同：1
> 
> 时间：2012-07-24T22:27:08.360
> 
> 标签：redis

我正在使用 redis 将项目列表存储在一组中。我定期向集合添加一个非常相似的列表，显然，排序集合仅在新项目不存在时才添加它们。有没有办法获得刚刚添加的新项目列表？那些不存在于集合中的？

丹科舒恩。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T22:30:34.453

[`ZADD`](http://redis.io/commands/zadd) command, if called with one score/member pair, returns 1 if member was new and 0 if it already existed. You can use this. Add elements one by one and check return values.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-25T20:00:04.877

除了按照 Sergio 的描述迭代新列表之外，您还可以将排序集中的键存储在一个集合中，将新列表存储在一个集合中，并对它们执行 sdiff 或 sdiffstore 以获得差异。

哪条路线更好是根据您的代码和数据集对您的判断。如果新列表很短，可能会使用像 Sergio 描述的 zadd 命令进行简单迭代。否则我会测试看看哪个更适合我的用例。

# c++ - How to check if starts with a certain string using C++

> ID：11640218
> 
> 赞同：4
> 
> 时间：2012-07-24T22:27:13.127
> 
> 标签：c++, visual-c++

> **Possible Duplicate:**
> [how to check string start in C++](https://stackoverflow.com/questions/8095088/how-to-check-string-start-in-c)

I need to check if wstring begins with a particular string.

```
const wstring str = "Hello World";
wstring temp="Hello "; 
```

How I can check `str` begins with `temp` or not?

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-24T22:32:31.527

开始使用宽字面量；然后轻而易举：

```
std::wstring const str = L"Hello World";

// one method:
if (str.substr(0, 6) == L"Hello ") { /* yay */ }

// another method, better:
if (str.find(L"Hello ") == 0) { /* hooray */ } 
```

# ajax - Handling forms with many fields

> ID：11640219
> 
> 赞同：1
> 
> 时间：2012-07-24T22:27:27.217
> 
> 标签：ajax, yii, jeditable, flyweight-pattern

I have a very `large webform` that is the center of my `Yii` web application. **The form actually consists of multiple html form elements, many of which are loaded via AJAX as needed.**

Because of the form's size and complexity, having multiple save or submit buttons isn't really feasible. I would rather update each field in the database as it is edited by asynchrously AJAXing the new value to the server using jeditable or jeditable-like functionality.

Has anyone done anything like this? In theory I'm thinking I could set up an `AJAX` endpoint and have each control pass in its name, its new value, and the `CRUD` operation you want to perform. Then the endpoint can route the request appropriately based on some kind of map and return the product. It just seems like someone has to have solved this problem before and I don't want to waste hours reinventing the wheel.

Your thoughts on architecture/implementation are appreciated, thanks for your time.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T06:21:29.987

在类似的情况下，我决定使用[CActiveForm](http://www.yiiframework.com/doc/api/1.1/CActiveForm/)仅用于 Yii 标准的简单验证（它可以使用 Ajax 验证），避免使用“ `required`”属性。当然，要保持表单的逻辑结构良好。

总的来说，你是对的。我手动使用 jQuery 向控制器生成 AJAX 请求（和任何其他操作），并根据需要在那里处理它们。

因此，您可以在控制器（分析请求中的参数）和自定义 jQuery（使用组选择器）中使用 CRUD，但您几乎不能`CActiveForm`直接在其中使用（这很好：压缩不一定总是击败模型的逻辑和结构） .

任何在 PHP 中使用 javascript 的复合解决方案都会影响您非平凡应用程序的灵活性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-25T15:39:07.240

昨晚睡了之后，我发现了这个帖子：

[jQuery 聚焦/模糊表单，而不是单个输入](https://stackoverflow.com/questions/5049172/jquery-focus-blur-on-form-not-individual-inputs)

我在客户端使用它的修改版本通过 AJAX 更新每个表单，而不是更新每个字段。每个表单在两秒钟不活动后自动提交其数据。缺点是如果他们的浏览器崩溃，客户端可能会丢失一些数据，但好处是我可以主要使用 Yii 的内置控制器操作，我不必编写很多自定义 PHP。由于我的表格很小，但有很多，到目前为止它似乎运作良好。

感谢 Alexander 的出色投入，感谢 Afnan 的帮助 :)

# c# - 多线程；将对象传递给另一个对象

> ID：11640221
> 
> 赞同：2
> 
> 时间：2012-07-24T22:27:31.050
> 
> 标签：c#, multithreading

我需要将一个对象传递给另一个对象。我知道我必须传递`c`给`t1`. 我该怎么做呢

```
Thread t = new Thread(t1);
t.Start();

private static void t1(Class1 c)
{
    while (c.process_done == false)
    {
        Console.Write(".");
        Thread.Sleep(1000);
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-24T22:33:48.660

你可以简单地做：

```
Thread t = new Thread(new ParameterizedThreadStart(t1));
t.Start(new Class1());

public static void t1(object c)
{
  Class1 class1 = (Class1)c;
  ...
} 
```

MSDN：[参数化线程启动委托](http://msdn.microsoft.com/en-us/library/system.threading.parameterizedthreadstart.aspx)

* * *

甚至更好：

```
Thread thread = new Thread(() => t1(new Class1()));

public static void t1(Class1 c)
{
  // no need to cast the object here.
  ...
} 
```

这种方法允许多个参数，并且不需要您将对象强制转换为所需的类/结构。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-24T22:52:05.470

好的，每个人都错过了在线程外使用对象的要点。这样，必须同步，避免跨线程异常。

因此，解决方案将是这样的：

```
//This is your MAIN thread
Thread t = new Thread(new ParameterizedThreadStart(t1));
t.Start(new Class1());
//...
lock(c)
{
  c.magic_is_done = true;
}
//...

public static void t1(Class1 c)
{
  //this is your SECOND thread
  bool stop = false;
  do
  {
    Console.Write(".");
    Thread.Sleep(1000);

    lock(c)
    {
      stop = c.magic_is_done;
    }
    while(!stop)
  }
} 
```

希望这可以帮助。

问候

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-24T22:35:34.293

```
private static void DoSomething()
{
    Class1 whatYouWant = new Class1();
    Thread thread = new Thread(DoSomethingAsync);
    thread.Start(whatYouWant);
}

private static void DoSomethingAsync(object parameter)
{
    Class1 whatYouWant = parameter as Class1;
} 
```

# c# - 将 DLL 引用添加到 Visual Studio 宏

> ID：11640222
> 
> 赞同：1
> 
> 时间：2012-07-24T22:27:34.433
> 
> 标签：c#, visual-studio-2010, dll, reference, visual-studio-macros

我需要在visual studio中创建很多宏，问题是我不知道visual basic那么好。

到目前为止我一直在做的是：

> 在控制台应用程序上创建我计划在 C# 上使用的算法“代码”。我编译它，然后用[反射器](http://www.reflector.net/)将它反编译成 Visual Basic。
> 
> 当我反编译代码时，我会丢失注释，而且有时我必须重新参考代码，这变得难以管理。

我厌倦了编译和反编译，而且我必须时不时地做一些 twick。我想创建一个可以在某处引用的服务或库：

![在此处输入图像描述](../Images/8399bf28e7884115d84a0fa1cda0d294.png)

**当我右键单击参考并选择添加参考时，无法选择我自己的自定义 dll**。也许有一种通过代码引用dll的方法。

**我一直在尝试做的是尝试注册 dll，以便我的 dll 出现在：** ![在此处输入图像描述](../Images/8adfb316e96fcf0d042eea0e3bcf22bc.png)

如果我设法注册 dll，将我的宏提供给其他人会更容易......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T22:47:14.823

你的答案可能在这里...

[http://social.msdn.microsoft.com/Forums/is/vsx/thread/7b5d4c41-3a05-4a82-9a7d-aa6266fdbd25](http://social.msdn.microsoft.com/Forums/is/vsx/thread/7b5d4c41-3a05-4a82-9a7d-aa6266fdbd25)

....将您的程序集复制到

C:\Program Files\Microsoft Visual Studio 8\Common7\IDE\PublicAssemblies

（根据需要更改路径中的 Visual Studio 版本号）

相关链接：

*   [C# 用于在 Visual Studio 中编写宏？](https://stackoverflow.com/questions/1441944/c-sharp-for-writing-macros-in-visual-studio)

# python - 如何为单元测试期间调用的方法提供默认返回值？- Python

> ID：11640226
> 
> 赞同：4
> 
> 时间：2012-07-24T22:27:57.290
> 
> 标签：python

这是一个简化我所拥有的示例类：

*类.py*

```
class MyClass(object):

    @staticmethod
    def getDictionary():
        #some calculations, returns a dictionary 

    def checkConfiguration(self):
        #some code
        self.getDictionary()
        #some other code
        return value 
```

现在我正在对以下内容进行单元测试`checkConfiguration`：

*类测试.py*

```
import class
import unittest

class TestMyClass(unittest.TestCase):

    def setUp(self):
        self.classTest = class.MyClass() 

    def test_CheckConfiguration(self):
        #What to put here? 
```

原来的`CheckConfiguration`来电`getDictionary`。有没有办法告诉`test_CheckConfiguration(self)`如果`getDictionary`被调用，它应该自动返回我可以输入的字典？就像是：

```
 def test_CheckConfiguration(self):
        if method getDictionary is called: 
            return {'a':123, 'b':22}
        checkValue = self.classTest.checkConfiguration() 
```

我知道这在 Java 中是可能的，尽管我在这方面没有足够的经验。谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T22:34:19.170

我认为您需要一个模拟框架。我建议[PyMock](http://theblobshop.com/pymock/)。

以下是您可以使用它的方法：

*类测试.py*

```
import class
import pymock
import unittest

class TestMyClass(pymock.PyMockTestCase):

    def setUp(self):
        self.classTest = class.MyClass() 

    def test_CheckConfiguration(self):
        self.override(self.classTest, 'getDictionary')
        pymock.expectAndReturn(self.classTest.getDictionary(), {'a':123, 'b':22})
        self.replay()
        checkValue = self.classTest.checkConfiguration()
        self.verify() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T22:36:45.760

[https://groups.google.com/forum/?fromgroups#!topic/comp.lang.python/WBhc1xAc8Hw](https://groups.google.com/forum/?fromgroups#!topic/comp.lang.python/WBhc1xAc8Hw)建议对您的测试类进行子类化并覆盖`__getattribute__`以您需要的任何方式记录每个呼叫。不知道还有什么可以工作...

# process - 抢占式优先级调度中如何计算平均等待时间

> ID：11640228
> 
> 赞同：3
> 
> 时间：2012-07-24T22:28:06.883
> 
> 标签：process, scheduling

给定下表：

![在此处输入图像描述](../Images/2faa497fb72394734c2a30c3972d0727.png)

我想计算抢占式优先级调度的平均等待时间。

在上表中，数字越大（在优先级列中），优先级越高。

部分解决方案：

```
|p1|p3|p1|p2|p5|p4|
0  8  29 33 52 67 80 
```

我从这里做什么？

谢谢

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-24T22:34:59.223

您是否了解您发布的部分解决方案（实际时间表）？

`Waiting time of a process = finish time of that process - execution time - arrival time`

一旦你对所有过程都有这个，然后取平均值。这将为您提供此实例的调度算法的平均等待时间

更多细节：

这里的过程`p1`没有等待前 8 秒。然后在 t=9 它被抢占。`p3`在进程执行期间，它从时间 t=9 到 t=29 处于等待模式。所以`p1`在执行时等待了 21 秒`p3`。在 t=29 时，`p1`再次开始并在 t=33 时完成。总共`p1`等了21秒。根据公式，我们得到等待时间为 33-12-0=21。基本上，对于每个过程，我们都会查看它到达和完成之间的时间。此时间间隔之间的任何时间，当它不执行时都是等待时间

# css - How to find out the actual font being rendered by Chrome?

> ID：11640232
> 
> 赞同：1
> 
> 时间：2012-07-24T22:28:28.177
> 
> 标签：css, google-chrome, web-inspector

> **Possible Duplicate:**
> [How do I tell which font Chrome is using?](https://stackoverflow.com/questions/9129966/how-do-i-tell-which-font-chrome-is-using)

I am trying to figure out, using Chrome’s web inspector, what font my site is actually rendering – not simply the CSS font-family spec.

In my case, I happen to know that the first two fonts in the font-family listing are not on my machine. But I shouldn’t have to leave the browser to figure that out. Is there a feature in web inspector, or elsewhere, that offers this?

# php - Processing JSON retrieved with curl

> ID：11640233
> 
> 赞同：0
> 
> 时间：2012-07-24T22:28:35.840
> 
> 标签：php, json, curl

I am using curl function to get the data from gotowebinar url. here is the code

```
 $data=curl_exec($curl);

   @curl_close($curl);

   $newdata=json_decode($data, true);
   print_r($newdata); 
```

I am getting this output:

```
[
    {
        "registrantKey": 12345,
        "firstName": "xxx",
        "lastName": "xxx",
        "email": "xxx@yahoo.com",
        "status": "WAITING",
        "registrationDate": "2012-07-11T16:54:11Z",
        "joinUrl": "https://www1.gotomeeting.com/join/123/456",
        "timeZone": "America/New_York"
    },
    {
        "registrantKey": 12345,
        "firstName": "xxx",
        "lastName": "xxx",
        "email": "xxx@yahoo.com",
        "status": "WAITING",
        "registrationDate": "2012-07-05T23:55:23Z",
        "joinUrl": "https://www1.gotomeeting.com/join/123/456",
        "timeZone": "America/New_York"
    },
    {
        "registrantKey": 12345,
        "firstName": "xxx",
        "lastName": "xxx",
        "email": "xxx@yahoo.com",
        "status": "WAITING",
        "registrationDate": "2012-07-11T23:27:56Z",
        "joinUrl": "https://www1.gotomeeting.com/join/123/456",
        "timeZone": "America/Chicago"
    },
    {
        "registrantKey": 12345,
        "firstName": "xxx",
        "lastName": "xxx",
        "email": "xxx@visioninvesting.com",
        "status": "WAITING",
        "registrationDate": "2012-07-11T23:29:40Z",
        "joinUrl": "https://www1.gotomeeting.com/join/123/456",
        "timeZone": "America/Chicago"
    },
    {
        "registrantKey": 12345,
        "firstName": "xxx",
        "lastName": "xxx",
        "email": "xxx@yahoo.com",
        "status": "WAITING",
        "registrationDate": "2012-07-11T18:14:32Z",
        "joinUrl": "https://www1.gotomeeting.com/join/123/456",
        "timeZone": "America/Chicago"
    },
    {
        "registrantKey": 12345,
        "firstName": "test",
        "lastName": "1",
        "email": "xxx@yahoo.com",
        "status": "WAITING",
        "registrationDate": "2012-06-29T21:07:10Z",
        "joinUrl": "https://www1.gotomeeting.com/join/123/456",
        "timeZone": "America/Denver"
    }
] 
```

I used `json_decode` to format the data but it did not work. I want to format the output so that I can use its values in program.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T22:52:35.923

这是一些简单的 PHP 代码，用于循环调用`json_decode`.

```
$newdata = json_decode($data);

foreach($newdata as $entry) {
    echo "{$entry->firstName} is {$entry->status}.  " .
         "Their key is {$entry->registrantKey}.<br />\n";
} 
```

您可以从解码的对象访问您在返回的 json 中看到的任何属性。

由于您获得了一个对象数组，因此您可以遍历每个条目（如上所示），或者像这样访问特定条目：

```
$third = $newdata[2]->firstName; 
```

希望这有助于您入门。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T23:53:08.233

尝试先将其转换为数组：

```
$newdata = (array) json_decode($data, true); 
```

# c++ - SQL Column 在第一个字符后截断 Varchar 值

> ID：11640235
> 
> 赞同：0
> 
> 时间：2012-07-24T22:28:53.133
> 
> 标签：c++, sql, unicode, odbc

我试图插入一列，我只看到我插入的字符串的第一个字符。一段时间以来，我一直在努力解决这个问题。

在我的程序中定义了 Unicode。我正在使用 ODBC 和 Sybase SQLAnywhere。该程序运行时没有编译器错误，并且我尝试插入的列采用 varchar。我在 Windows Server 2003 上使用来自 odbc32.lib 的 SQLBindParameter（警告：：遗留代码传入）。

验证只是我定义的一个断言。EFields 是一个 std::map ，其中 TSTRING 定义为

```
typedef std::basic_string<TCHAR> TSTRING; 
```

这是我的 ODBC 代码。

```
bufSize = sizeof(TCHAR) * (EFields.find(_T("clientipaddress"))->second.length()); //not null terminated
VERIFY(::SQLBindParameter(hstmt, 3, SQL_PARAM_INPUT, SQL_C_TCHAR, SQL_VARCHAR, EFields.find(_T("clientipaddress"))->second.length() , 0 , 
        (SQLPOINTER)EFields.find(_T("clientipaddress"))->second.c_str(), bufSize, NULL) == SQL_SUCCESS); 
```

传入的字符串是一个 IP（这个以 10.1 开头）。我被要求使用 varchar，以便当 IPV6 变得更普遍使用时代码不会中断。提前谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T00:48:27.543

在数据库中从 Varchar 更改为 Nvarchar 解决了我的问题。

# javascript - 错误或功能？jQuery + Chrome 根据缩放报告不同的字体大小

> ID：11640236
> 
> 赞同：1
> 
> 时间：2012-07-24T22:28:53.717
> 
> 标签：javascript, jquery, google-chrome

我将此代码放入 Chrome 中。

```
setInterval( function() { 
  console.log( $('#element').css('font-size') ); 
}, 500 ); 
```

如果我使用 ctrl+鼠标滚轮放大和缩小，它会随机将字体大小更改为：

*   12.222222328186035px
*   11.818181991577148px
*   24像素

正确的是 12px。如果我在 FF 中运行它，看起来缩放是阻塞的，因此间隔只吐出 12px。这似乎是我应该向 Chrome 报告的错误，但想知道是否有一些我不知道的规范。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T22:36:28.100

也发生在 safari 中，似乎是一个 webkit 错误。`.getComputedStyle`缩放的实现不应该以这种方式泄漏。

这里已经报道[了](https://bugs.webkit.org/show_bug.cgi?id=91091)

# jquery - 如何停止无样式内容的闪烁

> ID：11640238
> 
> 赞同：7
> 
> 时间：2012-07-24T22:29:07.943
> 
> 标签：jquery, html, css

这只是一个简短的问题，我没有真正的示例，但我使用的是定制的 cms，目前我们无法访问网页的头部，因此必须将一些 css 放在头部之外，导致闪烁页面加载时未设置样式的内容。

只是想知道她身上是否有人知道用 jquery 快速修复或阻止这种情况。

我知道将 CSS 放在非内联是不好的做法，但我想知道是否有一个工作回合。

任何帮助表示赞赏

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-24T22:33:16.583

处理 FOUC 的基本解决方案是将其隐藏起来，直到其样式正确。

我假设您可以控制无样式显示的内容？在这种情况下，将其包装在`<div id="some-div" style="display:none">... content ... </div>`. 然后在整个文档准备好时使用 jQuery 显示它：

```
$(function() { $("#some-div").show(); }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-11-21T15:37:43.530

在名为 的内容中添加一个类，在公共 CSS 文件`no-fouc`中将类设置为`display: none`，然后在页面加载时删除该类。此解决方案的优点是它可以处理任意数量的元素，并且可以在所有页面上重复使用。

```
$(function() {
  $('.no-fouc').removeClass('no-fouc');
  $('#dialog').dialog();
});
```

```
.no-fouc {
  display: none;
}
```

```
<link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>

<div class="no-fouc">
  <div id="dialog" title="Basic dialog">
    <p>This is the default dialog which is useful for displaying information. The dialog window can be moved, resized and closed with the 'x' icon.</p>
  </div>
</div>
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2022-01-20T17:59:12.453

哟它只是倒退。

在您的页面上执行此操作

```
<style>
html{visibility: visible;opacity:1;}
</style> 
```

对于最后一个 .css 文件，请执行此操作

```
/* no fouc */
html {
visibility: hidden;
opacity: 0;
transition: all 2s ease-in-out;
} 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2018-11-18T19:26:52.877

修复不需要 javascript 的 FOUC：

在 HTML 的顶部：

```
<!doctype html> 
<html> 
<head>
     <style>html{visibility: hidden;opacity:0;}</style> 
```

在最后一个 .css 文件的末尾：

```
html {
     visibility: visible;
     opacity: 1; } 
```

[https://gist.github.com/electrotype/7960ddcc44bc4aea07a35603d1c41cb0](https://gist.github.com/electrotype/7960ddcc44bc4aea07a35603d1c41cb0)

# c# - C# mongodb where OR List

> ID：11640241
> 
> 赞同：0
> 
> 时间：2012-07-24T22:29:42.563
> 
> 标签：c#, mongodb

My document has a property that is of the type `List<string>`. I want to return all documents from a collection where a set of strings match any item from this `List<string>` property.

I would like to construct this like the following question, but in C#:

[MongoDB find where key equals string from array](https://stackoverflow.com/questions/10932854/mongodb-find-where-key-equals-string-from-array)

I know this is off, but it's my best attempt:

```
var queryItems = new List<QueryComplete>();
queryItems.Add(Query.EQ("PropertyName", "test"));
var query= Query.Or(queryItems.ToArray());
var qd = new QueryDocument(new BsonDocument { query.ToBsonDocument() });
var result = GetCollection<CollectionName>().FindAs<Type>(qd) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T15:37:59.643

如果由于某种原因您不想使用 LINQ，则可以使用查询生成器来编写它，如下所示：

```
var setOfStrings = new BsonValue[] { "a", "b", "c" };
var query = Query.Or(
    Query.EQ("PropertyName", "test"),
    Query.In("List", setOfStrings)
);
var cursor = collection.FindAs<C>(query); 
```

如果您想仔细检查本机 MongoDB 查询的外观，您可以使用：

```
var json = query.ToJson(); 
```

在这种情况下，这表明等效的 MongoDB 查询是：

```
{ "$or" : [
    { "PropertyName" : "test" },
    { "List" : { "$in" : ["a", "b", "c"] } }
] } 
```

如果这不是您要查找的本机 MongoDB 查询，请告诉我。

ps 1.5 版中有一个新的查询生成器，而 QueryComplete 现已过时。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-25T07:06:23.960

看起来您正在寻找的内容如下所述：

[包含任何](http://www.mongodb.org/display/DOCS/CSharp+Driver+LINQ+Tutorial#CSharpDriverLINQTutorial-ContainsAny%28LINQtoMongoDBextensionmethod%29)

此方法用于测试数组（或类似数组）字段或属性是否包含任何提供的值。

```
var query =
    from c in collection.AsQueryable<C>()
    where c.A.ContainsAny(new[] { 1, 2, 3 })
    select c;
// or
var query =
    collection.AsQueryable<C>()
    .Where(c => c.A.ContainsAny(new[] { 1, 2, 3 })); 
```

# java - Java: sharing workers in thread pool for several recursive tasks

> ID：11640242
> 
> 赞同：1
> 
> 时间：2012-07-24T22:30:04.067
> 
> 标签：java, recursion, executorservice

There is one fixed thread pool (let it be with size=100), that I want to use for all tasks across my app. It is used to limit server load.

Task = web crawler, that submits first job to thread pool.
That job can generate more jobs, and so on.
One job = one HTTP I/O request.

**Problem**
Suppose that there is only one executing task, that generated 10000 jobs.
Those jobs are now queued in thread pool queue, and all 100 threads are used for their execution.

Suppose that I now submit a second task.
The first job of the second task is 10001th in the queue.
It will be executed only after the 10000 jobs that the first task queued up.
So, this is a problem - I don't want the second task to wait so long to start its first job.

**Idea**
The first idea on my mind is to create a **custom BlockingQueue** and pass it to the thread pool constructor.
That queue will hold several blocking queues, **one for each task**.
Its **take** method will then choose a random queue and take an item from it.
My problem with this is that I don't see how to remove an empty queue from this list when its task is finished. This would mean some or all workers could get blocked on the take method, waiting for jobs from tasks that are finished.

**Is this the best way to solve this problem?**
I was unable to find any patterns for it in books or on the Internet :(

Thank you!

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T22:39:57.733

我会使用多个队列并从包含项目的随机队列中抽取。或者，您可以优先考虑哪个队列应该获得最高优先级。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T00:39:05.550

我建议使用单个[PriorityBlockingQueue](http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/PriorityBlockingQueue.html)并使用递归任务的“深度”来计算优先级。对于单个队列，当队列为空并且不需要围绕多个队列进行随机化逻辑时，工作人员会被阻塞。

# python - PANDAS 绘制多个 Y 轴

> ID：11640243
> 
> 赞同：83
> 
> 时间：2012-07-24T22:30:16.603
> 
> 标签：python, pandas

我知道 pandas 支持辅助 Y 轴，但我很好奇是否有人知道在绘图上放置第三 Y 轴的方法......目前我正在使用 numpy+pyplot 实现这一点......但是对于大型数据集来说速度很慢。

这是为了在同一张图上用不同的单位绘制不同的测量值，以便于比较（例如相对湿度/温度/和电导率）

所以真的很好奇是否有人知道这是否可能在`pandas`没有太多工作的情况下实现。

[编辑]我怀疑有办法做到这一点（没有太多开销）但是我希望被证明是错误的，这可能是 matplotlib 的限制......

* * *

## 回答 #1

> 赞同：100
> 
> 时间：2012-07-25T06:28:37.937

我认为这可能有效：

```
import matplotlib.pyplot as plt
import numpy as np
from pandas import DataFrame
df = DataFrame(np.random.randn(5, 3), columns=['A', 'B', 'C'])

fig, ax = plt.subplots()
ax3 = ax.twinx()
rspine = ax3.spines['right']
rspine.set_position(('axes', 1.15))
ax3.set_frame_on(True)
ax3.patch.set_visible(False)
fig.subplots_adjust(right=0.7)

df.A.plot(ax=ax, style='b-')
# same ax as above since it's automatically added on the right
df.B.plot(ax=ax, style='r-', secondary_y=True)
df.C.plot(ax=ax3, style='g-')

# add legend --> take advantage of pandas providing us access
# to the line associated with the right part of the axis
ax3.legend([ax.get_lines()[0], ax.right_ax.get_lines()[0], ax3.get_lines()[0]],\
           ['A','B','C'], bbox_to_anchor=(1.5, 0.5)) 
```

输出：

[![输出](../Images/1d9efa92c6810e8eb06ffc7943485c4a.png)](https://i.imgur.com/s56jamN.png)

* * *

## 回答 #2

> 赞同：51
> 
> 时间：2018-06-02T10:11:34.273

一个更简单的解决方案，没有`plt`：

```
ax1 = df1.plot()

ax2 = ax1.twinx()
ax2.spines['right'].set_position(('axes', 1.0))
df2.plot(ax=ax2)

ax3 = ax1.twinx()
ax3.spines['right'].set_position(('axes', 1.1))
df3.plot(ax=ax3)

.... 
```

使用函数来实现这一点：

```
def plot_multi(data, cols=None, spacing=.1, **kwargs):

    from pandas.plotting._matplotlib.style import get_standard_colors

    # Get default color style from pandas - can be changed to any other color list
    if cols is None: cols = data.columns
    if len(cols) == 0: return
    colors = get_standard_colors(num_colors=len(cols))

    # First axis
    ax = data.loc[:, cols[0]].plot(label=cols[0], color=colors[0], **kwargs)
    ax.set_ylabel(ylabel=cols[0])
    lines, labels = ax.get_legend_handles_labels()

    for n in range(1, len(cols)):
        # Multiple y-axes
        ax_new = ax.twinx()
        ax_new.spines['right'].set_position(('axes', 1 + spacing * (n - 1)))
        data.loc[:, cols[n]].plot(ax=ax_new, label=cols[n], color=colors[n % len(colors)], **kwargs)
        ax_new.set_ylabel(ylabel=cols[n])

        # Proper legend position
        line, label = ax_new.get_legend_handles_labels()
        lines += line
        labels += label

    ax.legend(lines, labels, loc=0)
    return ax 
```

例子：

```
from random import randrange

data = pd.DataFrame(dict(
    s1=[randrange(-1000, 1000) for _ in range(100)],
    s2=[randrange(-100, 100) for _ in range(100)],
    s3=[randrange(-10, 10) for _ in range(100)],
))

plot_multi(data.cumsum(), figsize=(10, 5)) 
```

输出：

[![多个 Y 轴](../Images/2de4e13d24d00f3b10838eab4ec66677.png)](https://i.stack.imgur.com/qiggO.png)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-10-30T23:58:34.307

我稍微修改了上面的答案，使其接受自定义 x 列，有据可查，并且更灵活。

您可以复制此代码段并将其用作函数：

```
from typing import List, Union

import matplotlib.axes
import pandas as pd

def plot_multi(
    data: pd.DataFrame,
    x: Union[str, None] = None,
    y: Union[List[str], None] = None,
    spacing: float = 0.1,
    **kwargs
) -> matplotlib.axes.Axes:
    """Plot multiple Y axes on the same chart with same x axis.

    Args:
        data: dataframe which contains x and y columns
        x: column to use as x axis. If None, use index.
        y: list of columns to use as Y axes. If None, all columns are used
            except x column.
        spacing: spacing between the plots
        **kwargs: keyword arguments to pass to data.plot()

    Returns:
        a matplotlib.axes.Axes object returned from data.plot()

    Example:
    >>> plot_multi(df, figsize=(22, 10))
    >>> plot_multi(df, x='time', figsize=(22, 10))
    >>> plot_multi(df, y='price qty value'.split(), figsize=(22, 10))
    >>> plot_multi(df, x='time', y='price qty value'.split(), figsize=(22, 10))
    >>> plot_multi(df[['time price qty'.split()]], x='time', figsize=(22, 10))

    See Also:
        This code is mentioned in https://stackoverflow.com/q/11640243/2593810
    """
    from pandas.plotting._matplotlib.style import get_standard_colors

    # Get default color style from pandas - can be changed to any other color list
    if y is None:
        y = data.columns

    # remove x_col from y_cols
    if x:
        y = [col for col in y if col != x]

    if len(y) == 0:
        return
    colors = get_standard_colors(num_colors=len(y))

    if "legend" not in kwargs:
        kwargs["legend"] = False  # prevent multiple legends

    # First axis
    ax = data.plot(x=x, y=y[0], color=colors[0], **kwargs)
    ax.set_ylabel(ylabel=y[0])
    lines, labels = ax.get_legend_handles_labels()

    for i in range(1, len(y)):
        # Multiple y-axes
        ax_new = ax.twinx()
        ax_new.spines["right"].set_position(("axes", 1 + spacing * (i - 1)))
        data.plot(
            ax=ax_new, x=x, y=y[i], color=colors[i % len(colors)], **kwargs
        )
        ax_new.set_ylabel(ylabel=y[i])

        # Proper legend position
        line, label = ax_new.get_legend_handles_labels()
        lines += line
        labels += label

    ax.legend(lines, labels, loc=0)
    return ax 
```

这是使用它的一种方法：

```
plot_multi(df, x='time', y='price qty value'.split(), figsize=(22, 10)) 
```

# android - @Override annotation error

> ID：11640245
> 
> 赞同：2
> 
> 时间：2012-07-24T22:30:26.617
> 
> 标签：android, overriding

I get an error on every line that has the `@Override` annotation.

For example, the following message appears as the error popup:

> Multiple markers at this line - The method onClick(DialogInterface, int) of type new DialogInterface.OnClickListener(){} must override a superclass method - implements android.content.DialogInterface.OnClickListener.onClick

The Compiler compliance level is set to *1.7*.

I've read that this problem was occurring when *eclipse* defaults to *1.5* and it should be set to *1.6*. But in the case of *1.7* what would the solution be?

Also, can I just remove the `@Override` annotation and be trouble free?

# javascript - Is there a way to capture the alert ok button click event?

> ID：11640248
> 
> 赞同：14
> 
> 时间：2012-07-24T22:30:57.103
> 
> 标签：javascript, jquery

Is there a way to capture the alert ok button click event? In jQuery?

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-07-24T22:37:12.787

该`alert()`函数是`synchronous`并且您无法验证单击了什么（它不返回任何内容），因此调用下面的代码将在关闭后执行（确定或关闭按钮）。警报不用于获取用户输入。它是一个警报，是给用户的消息。如果您需要检查用户想要什么，您应该使用`confirm()`. 请注意，函数名称告诉它的用途，如警报。

就像是：

```
// if the ok button is clicked, result will be true (boolean)
var result = confirm( "Do you want to do this?" );

if ( result ) {
    // the user clicked ok
} else {
    // the user clicked cancel or closed the confirm dialog.
} 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2017-10-27T11:56:37.297

Alert 是一个**阻塞**函数，意思是如果你不关闭它，下面的代码就不会执行。所以你不必捕获警报关闭事件，只需在警报下方写下代码，当警报窗口关闭时，下面的代码将自动执行。

请参见下面的示例：

```
alert("Close Me");
// Write down the code here, which will executed only after the alert close
console.log("This code is executed after alert")
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-07-24T22:41:18.800

**免责声明：**这是一件非常糟糕的事情。

从技术上讲，您可以使用以下代码挂钩：

```
window.alert = function(al, $){
    return function(msg) {
        al(msg);
        $(window).trigger("okbuttonclicked");
    };
}(window.alert, window.jQuery);

$(window).on("okbuttonclicked", function() {
    console.log("you clicked ok");
});

alert("something"); 
```

​</p>

演示：http: [//jsfiddle.net/W4d7J/1/](http://jsfiddle.net/W4d7J/1/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-24T22:36:53.857

window.alert() 没有事件。基本上，当他们单击确定时调用它之后的下一行。我不知道你为什么需要听它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-05-29T09:24:06.157

您可以使用[JAlert](https://htmlguyllc.github.io/jAlert/)并将单击处理程序分配给确定按钮。

就像是

```
jAlert("Alert message goes here."); 
$('#popup_ok').bind('click',function(){
   //Do operation after clicking ok button.
   function_do_operation();
}); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-10-31T19:10:55.177

我在我创建的网站中尝试了这个，它运行良好：

```
<a href="javascript:var rslt=confirm('Cancel Appointment Creation');if(rslt){window.open('http://www.the_website_I_want_to_navigate_to.com')}else{}"> << Back </a> 
```

# nosql - riak 和原子增量

> ID：11640253
> 
> 赞同：1
> 
> 时间：2012-07-24T22:31:34.187
> 
> 标签：nosql, riak

我将 redis 用于前端 Web 应用程序，但对于后端，我想使用 riak，但不清楚它是否支持与原子增量的最终一致性。我想做计数器，但不必像 redis 那样快。如果 riak 做不到，谁能做到？当然除了redis。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-25T01:02:53.713

这有帮助吗。

[http://lists.basho.com/pipermail/riak-users_lists.basho.com/2012-January/007157.html](http://lists.basho.com/pipermail/riak-users_lists.basho.com/2012-January/007157.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-31T20:05:01.647

这是不可能的。我们无法锁定 riak 键值对以防止其他进程同时递增。使用不同的产品。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-31T12:50:58.117

Riak 确实支持原子提交，但仅适用于单个键/值。您需要记住的是，当您向 Riak 写入数据时，您正在写入一个最终一致的集群。您可能会在向一个节点写入值的同时将值写入另一个节点的相同位置。假设在存储桶上`allow_mult`设置为`true`，这将导致*读取*时发生冲突，这需要由您的应用程序解决。

# java - Oracle Java EE First Cup Tutorial 2.1--GlassFish 3.1.2 Errors

> ID：11640255
> 
> 赞同：0
> 
> 时间：2012-07-24T22:32:07.930
> 
> 标签：java, jakarta-ee, netbeans, glassfish, glassfish-3

I'm pretty familiar with Java SE and am just starting to learn Java EE and doing the First Cup Tutorial. I followed all of the instructions carefully. I am running this on my work computer (Windows 7) with a work firewall (Windows Firewall).

When I attempt to launch the GlassFish server I get this output in NetBeans:

```
Launching GlassFish on Felix platform
INFO: Running GlassFish Version: GlassFish Server Open Source Edition 3.1.2.2 (build 5)
INFO: Registered org.glassfish.ha.store.adapter.cache.ShoalBackingStoreProxy for persistence-type = replicated in BackingStoreFactoryRegistry
INFO: Grizzly Framework 1.9.50 started in: 9ms - bound to [0.0.0.0:3700]
INFO: Grizzly Framework 1.9.50 started in: 19ms - bound to [0.0.0.0:4848]
INFO: Grizzly Framework 1.9.50 started in: 51ms - bound to [0.0.0.0:8080]
INFO: Grizzly Framework 1.9.50 started in: 33ms - bound to [0.0.0.0:8181]
INFO: Grizzly Framework 1.9.50 started in: 2ms - bound to [0.0.0.0:7676]
INFO: The Admin Console is already installed, but not yet loaded.
INFO: SEC1002: Security Manager is OFF.
INFO: SEC1010: Entering Security Startup Service
INFO: SEC1143: Loading policy provider com.sun.enterprise.security.provider.PolicyWrapper.
INFO: SEC1115: Realm [admin-realm] of classtype [com.sun.enterprise.security.auth.realm.file.FileRealm] successfully created.
INFO: SEC1115: Realm [file] of classtype [com.sun.enterprise.security.auth.realm.file.FileRealm] successfully created.
INFO: SEC1115: Realm [certificate] of classtype [com.sun.enterprise.security.auth.realm.certificate.CertificateRealm] successfully created.
INFO: SEC1011: Security Service(s) Started Successfully
INFO: WEB0169: Created HTTP listener [http-listener-1] on host/port [0.0.0.0:8080]
INFO: WEB0169: Created HTTP listener [http-listener-2] on host/port [0.0.0.0:8181]
INFO: WEB0169: Created HTTP listener [admin-listener] on host/port [0.0.0.0:4848]
INFO: WEB0171: Created virtual server [server]
INFO: WEB0171: Created virtual server [__asadmin]
INFO: WEB0172: Virtual server [server] loaded default web module []
INFO: Registering the Jersey servlet application, named org.netbeans.rest.application.config.ApplicationConfig, at the servlet mapping, /resources/*, with the Application class of the same name
INFO: WEB0671: Loading application [dukes-age] at [/DukesAgeService]
INFO: CORE10010: Loading application dukes-age done in 2,585 ms
INFO: GlassFish Server Open Source Edition 3.1.2.2 (5) startup time : Felix (1,388ms), startup services(3,239ms), total(4,627ms)
INFO: HV000001: Hibernate Validator 4.3.0.Final
INFO: Created EjbThreadPoolExecutor with thread-core-pool-size 16 thread-max-pool-size 32 thread-keep-alive-seconds 60 thread-queue-capacity 2147483647 allow-core-thread-timeout false 
INFO: WEB0169: Created HTTP listener [http-listener-1] on host/port [0.0.0.0:8080]
INFO: Grizzly Framework 1.9.50 started in: 3ms - bound to [0.0.0.0:8080]
INFO: Initiating Jersey application, version 'Jersey: 1.11.1 03/31/2012 06:49 PM'
INFO: WEB0169: Created HTTP listener [http-listener-2] on host/port [0.0.0.0:8181]
INFO: Grizzly Framework 1.9.50 started in: 2ms - bound to [0.0.0.0:8181]
INFO: REST00001: Listening to REST requests at context: /management/domain
INFO: The Admin Console is already installed, but not yet loaded.
INFO: The Admin Console is starting. Please wait.
**SEVERE: Exception while deploying the app [__admingui]
SEVERE: Failed to start Bundle Id [336]  State [INSTALLED]   [org.glassfish.main.admingui.glassfish-osgi-console-plugin(Glassfish OSGI Console Plugin):3.1.2.1-SNAPSHOT]
com.sun.enterprise.module.ResolveError: Failed to start Bundle Id [336]  State [INSTALLED]   [org.glassfish.main.admingui.glassfish-osgi-console-plugin(Glassfish OSGI Console Plugin):3.1.2.1-SNAPSHOT]
    at org.jvnet.hk2.osgiadapter.OSGiModuleImpl.start(OSGiModuleImpl.java:177)
    at org.jvnet.hk2.osgiadapter.OSGiModuleImpl$2$1$1.loadClass(OSGiModuleImpl.java:344)
    at com.sun.hk2.component.LazyInhabitant.loadClass(LazyInhabitant.java:124)
    at com.sun.hk2.component.LazyInhabitant.fetch(LazyInhabitant.java:111)
    at com.sun.hk2.component.EventPublishingInhabitant.get(EventPublishingInhabitant.java:135)
    at com.sun.hk2.component.AbstractInhabitantImpl.get(AbstractInhabitantImpl.java:78)
    at com.sun.enterprise.v3.server.ClassLoaderHierarchyImpl.createApplicationParentCL(ClassLoaderHierarchyImpl.java:200)
    at org.glassfish.deployment.common.DeploymentContextImpl.createClassLoader(DeploymentContextImpl.java:216)
    at org.glassfish.deployment.common.DeploymentContextImpl.createDeploymentClassLoader(DeploymentContextImpl.java:199)
    at com.sun.enterprise.v3.server.ApplicationLifecycle.deploy(ApplicationLifecycle.java:346)
    at com.sun.enterprise.v3.server.ApplicationLoaderService.processApplication(ApplicationLoaderService.java:375)
    at com.sun.enterprise.v3.admin.adapter.InstallerThread.load(InstallerThread.java:210)
    at com.sun.enterprise.v3.admin.adapter.InstallerThread.run(InstallerThread.java:108)
Caused by: org.osgi.framework.BundleException: Cannot start bundle org.glassfish.main.admingui.glassfish-osgi-console-plugin [336] because its start level is 2, which is greater than the framework's start level of 1.
    at org.apache.felix.framework.Felix.startBundle(Felix.java:1807)
    at org.apache.felix.framework.BundleImpl.start(BundleImpl.java:944)
    at org.jvnet.hk2.osgiadapter.OSGiModuleImpl.start(OSGiModuleImpl.java:169)
    ... 12 more

SEVERE: Exception while deploying the app [__admingui]
INFO: The Admin Console application is loaded.
INFO: JMX005: JMXStartupService had Started JMXConnector on JMXService URL service:jmx:rmi://MW7FVCH7MQLSJX.dir.svc.accenture.com:8686/jndi/rmi://MW7FVCH7M**QLSJX.dir.svc.accenture.com:8686/jmxrmi
INFO: Registered org.glassfish.osgi.felixwebconsoleextension.GlassFishBrandingPlugin@591e1b
INFO: defaultVirtualServer = server
INFO: No default web.xml
INFO: standardContext = StandardEngine[glassfish-web].StandardHost[server].StandardContext[/osgi]
INFO: No default web.xml
INFO: standardContext = StandardEngine[glassfish-web].StandardHost[__asadmin].StandardContext[/osgi] 
```

The output lines that begin with "SEVERE:" look pretty bad. But then again, I'm a Java EE newbie.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T17:17:57.197

还有一个 GlassFish JIRA 问题与解决方法：

[http://java.net/jira/browse/GLASSFISH-18880](http://java.net/jira/browse/GLASSFISH-18880)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T22:43:43.520

您发布的堆栈中的最终结果是：

```
Cannot start bundle org.glassfish.main.admingui.glassfish-osgi-console-plugin [336] because its start level is 2, which is greater than the framework's start level of 1. 
```

您可能想对框架的启动级别进行一些研究。查看： [如何定义 OSGi 包启动级别？](https://stackoverflow.com/questions/7462259/how-is-the-osgi-bundle-start-level-defined)或[https://issues.apache.org/jira/browse/FELIX-2942](https://issues.apache.org/jira/browse/FELIX-2942)。

# java - How do I make JAVA perform an action based on MySQL data

> ID：11640256
> 
> 赞同：0
> 
> 时间：2012-07-24T22:32:15.417
> 
> 标签：java, mysql, if-statement

I would like to make a java code that has different outcomes that are determined by data inside of a MySQL column. I have everything set up and I can connect to the database and view data. I don't know how I would use "If" with a mysql column. Here is my code: [http://pastebin.com/UsJC7Qzx](http://pastebin.com/UsJC7Qzx)

What I'm trying to do specifically: I want to make the code print "Thanks for voting" if the MySQL column "given" is equal to 0 and then it will set the column to 1\. And if the column is equal to 1 it will say "Thanks again for voting."

This is just a simple base for a voting reward system I'm doing for my video game.

If you don't have very good understanding of what I am trying to say read my notes inside of the code.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T22:37:38.627

它看起来像这样：

```
while (given.next()) {
    if (given.getInt("given") > 0) {
        System.out.println("Thanks again for voting");
    } else {
        System.out.println("Thanks for voting");
    }
} 
```

建议您将`given`结果集重命名为“resultSet”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T22:40:45.933

我想你快到了。只需要多几行。

`st.executeQuery(give);`返回一个结果集。如果你保证你的查询只会返回一个结果，你可以简单地做

```
ResultSet result = st.executeQuery(give);
if ( result.next() ) { // advances the resultset to the first result.
     int actualVal = given.getInt('given');
     if ( actualVal == 0 ) {
        System.out.println("Thanks for voting");
        // do the update here
        st.executeUpdate("update has_voted set given = 1 where ...........");
     }
     else
        System.out.println("Thanks again for voting");
} 
```

# .net - 关键字作为标识符无效：VB2010

> ID：11640259
> 
> 赞同：9
> 
> 时间：2012-07-24T22:32:29.747
> 
> 标签：.net, visual-studio-2010

您好，我们正在尝试对我们的一个字符串进行排序以获取错误消息：

```
 Public ERROR As String 
```

但我们一直在点击消息 Keyword is not valid as an identifier - 是否存在此错误，因为名称无法从 ERROR 更改为字符串

谢谢

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-07-24T22:38:02.513

您可以使用：

> 公共 [错误] 作为字符串

C# 版本将是：

> 公共字符串@ERROR；

# wordpress - Wordpress Plugin: Thethe Image slider - image links

> ID：11640260
> 
> 赞同：0
> 
> 时间：2012-07-24T22:32:30.033
> 
> 标签：wordpress, plugins, permissions, slider

I have moved my wordpress site onto a new domain - everything else is working fine, except for my sliders made with "The The image slider". It imported the sliders, along with their slides. however - the image paths of the images still point to the "old" site, and therefore the image slides are not showing?

I have tried to adjust the permissions of the cache folder in CPanel, and all the permissions seem in order. I have also done a "search and replace" with a plugin and according to the plugin result, all the paths are changed? I can open the slides images by using the new path which shows that the images are in the new upload folder, however the path to the images is still the "old" path in the plugin's slider settings

Is there someway I could perhaps change the image paths to the new domain?

[http://wordpress.org/extend/plugins/thethe-image-slider/](http://wordpress.org/extend/plugins/thethe-image-slider/)

# jquery - 使用 jQuery ajax 和 node.js 发送 POST 请求

> ID：11640262
> 
> 赞同：2
> 
> 时间：2012-07-24T22:32:47.553
> 
> 标签：jquery, ajax, node.js, post, xmlhttprequest

我有以下内容`myserver/index.js`（我使用节点运行）：

```
server.configure(function() {
  server.use(express.methodOverride());
  server.use(express.bodyParser());
  server.use(server.router);
  server.use(express.static(__dirname + '/public'));
  server.use(express.errorHandler({ dumpExceptions: true, showStack: true }));
});

server.post('/signup/submit', function(req, res) {
  console.log(req);
  res.send(req.body);
});

server.listen(process.env.PORT || 12345, function() {
  console.log('Server listening');
}); 
```

我的文件`<script>`部分中有以下内容`myserver/public/signup/index.html`

```
function submit() {
  $.ajax({
    url: "submit",
    type: "POST",
    contentType: "application/xml",
    data: '<?xml version="1.0"?><user>John Smith</user>',
    dataType: "xml",
    success: function(data, textStatus, jqXHR) { alert(data); },
    error: function(jqXHR, textStatus, errorThrown) { alert(errorThrown); }
}); 
```

当 submit() 被调用时，会弹出一个警告说“错误：无效的 XML：{}”。从 的控制台转储中`req`，我看到`body`确实是空的，但进一步检查表明它已收到所有其他数据。这是标题：

```
headers: 
{ host: 'localhost:12345',
  connection: 'keep-alive',
  'content-length': '44',
  origin: 'http://localhost:12345',
  'x-requested-with': 'XMLHttpRequest',
  'user-agent': 'Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/536.11 (KHTML, like Gecko) Chrome/20.0.1132.57 Safari/536.11',
  'content-type': 'application/xml',
  accept: 'application/xml, text/xml, */*; q=0.01',
  referer: 'http://localhost:12345/signup/',
  'accept-encoding': 'gzip,deflate,sdch',
  'accept-language': 'en-US,en;q=0.8',
  'accept-charset': 'ISO-8859-1,utf-8;q=0.7,*;q=0.3' } 
```

我是 Ajax、jQuery 和 Node.js 的新手，所以我不知道我做错了什么。我觉得这是我缺少的一些东西。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T22:54:07.350

试试这个：

```
$.ajax({
    url: "submit",
    type: "POST",
    contentType: "application/xml",
    data: "<user>John Smith</user>", // remove <?xml ...
    dataType: "xml",
    success: function(data, textStatus, jqXHR) { alert(data); },
    error: function(jqXHR, textStatus, errorThrown) { alert(errorThrown); }
}); 
```

# html - 如何在 XCode 中从 rss 提要中提取和使用标签？

> ID：11640265
> 
> 赞同：0
> 
> 时间：2012-07-24T22:33:01.953
> 
> 标签：html, xcode, ios5, rss, tags

我今天需要一些帮助，我的问题是如何从 RSS 提要中提取 imgs 标签和其他可能的标签，我搜索了谷歌，我确实使用 NSScanner 找到了一些东西，但它没有解释如何在我的代码中使用它。

提取标签后，我还想在表格单元格中使用文本。

我该怎么做呢？

我是 xcode 的初学者，所以除非写得很清楚，否则我不确定如何调整代码。

我还应该声明这是针对 iOS 项目的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T01:23:58.797

与其重新发明轮子，不如尝试合并一个 3rd 方库来阅读 RSS 提要。我在一个项目中使用了[MWFeedParser](https://github.com/mwaterfall/MWFeedParser/)并取得了巨大的成功。

# windows-phone-7 - WP7同时录放音

> ID：11640268
> 
> 赞同：0
> 
> 时间：2012-07-24T22:33:09.317
> 
> 标签：windows-phone-7, xna

我需要在录制声音时反复播放短音（模拟节拍器）。我为节拍器所做的基本上是设置一个具有特定间隔的 DispatcherTimer，并且每个滴答声都会触发一个 SoundEffect。对于记录器，我每 33 毫秒调用一次 XNA 的 FrameworkDispatcher.Update 方法（也为此使用 DispatcherTimer）。

我运行节拍器，它工作正常，然后当我开始录制时 - 播放声音有一个短暂的中断（很难说它是否会延迟间隔或只是静音），过了一会儿（当已经录制时），节拍器继续滴答作响，但声音更加“扁平”。

这是硬件限制，还是我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T07:03:52.353

我认为这与硬件有关。我正在制作一个应用程序来在捕获声音时对其进行修改。当我使用连接到设备的耳机（带麦克风）时，播放时有很大的回声。当我只使用耳机（和设备麦克风）时，一切都很好。它在 HTC 和诺基亚上进行了测试 - 结果相同，但 HTC 稍微好一点:)

# python - 使用python多处理库让父进程在子进程之前返回

> ID：11640276
> 
> 赞同：1
> 
> 时间：2012-07-24T22:33:26.020
> 
> 标签：python, multiprocessing

当从 python 使用多处理库创建进程时，父进程在返回之前等待其子进程返回。事实上，文档建议加入所有孩子。但我想让父母在其子进程完成*之前返回。*

有没有办法“分离”子进程。

我知道使用 subprocess.Popen 可以创建分离的子进程，但我想使用多处理库中的功能，如队列、锁等。

我举了两个例子来说明区别。

第一个示例使用多处理库。调用此脚本时，它会打印父消息，等待 5 秒，然后打印子消息，然后才返回。

```
# Using multiprocessing, only returns after 5 seconds
from multiprocessing import Process
from time import sleep, asctime

def child():
    sleep(5.0)
    print 'Child end reached on', asctime()

if __name__ == '__main__':
    p = Process(target = child)
    p.start()
    # Detach child process here so parent can return.
    print 'Parent end reached on', asctime() 
```

第二个示例使用 subprocess.Popen。调用此脚本时，它会打印父消息，返回 (!!!) 并在 5 秒后打印子消息。

```
# Using Popen, returns immediately.
import sys
from subprocess import Popen
from time import sleep, asctime

def child():
    sleep(5)
    print 'Child end reached on', asctime()

if __name__ == '__main__':
    if 'call_child' in sys.argv:
        child()
    else:
        Popen([sys.executable] + [__file__] + ['call_child'])
        print 'Parent end reached on', asctime() 
```

如果我可以传递队列、管道、锁、信号量等，第二个例子是可以接受的。

IMO，第一个示例还导致代码更清晰。

我在 Windows 上使用 python 2.7。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2019-04-19T02:57:40.683

只需从当前进程对象的 _children 集合中移除进程对象，父进程就会立即退出。

多处理模块管理私有集中的子进程，并在当前进程退出时加入它们。如果您不关心孩子，您可以从集合中移除孩子。

```
process = multiprocessing.Process(target=proc_main)
multiprocessing.current_process()._children.discard(process)
exit(0) 
```

# ruby-on-rails-3 - 如何在 bootstrap-sass gem 中包含 js 函数

> ID：11640277
> 
> 赞同：0
> 
> 时间：2012-07-24T22:33:44.763
> 
> 标签：ruby-on-rails-3, twitter-bootstrap-rails

我对 Rails 比较陌生，我发现这个宝石[`bootstrap-sass`](https://github.com/thomas-mcdonald/bootstrap-sass/)在布局上似乎非常好。但我想让`Carousel`js 插件工作。我发现它记录在网站上，但我不太明白我需要放在哪里

// 加载所有 Bootstrap javascript

```
//= require bootstrap 
```

谢谢，

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-25T01:12:39.630

如果您使用的是 rails >= 3.1，请将该行添加到您的`application.js`文件（或您在布局中包含的任何文件）中，通常位于`app/assets/javascripts`

`app/assets/javascripts/application.js`这是我在任何新应用程序中的典型基础。

```
//= require jquery
//= require jquery-ui
//= require jquery_ujs
//= require bootstrap 
```

# matrix - XMPP 匿名会话 JID RID SID 与 Matrix XMPP SDK

> ID：11640282
> 
> 赞同：1
> 
> 时间：2012-07-24T22:34:32.127
> 
> 标签：matrix, xmpp

请帮助我使用 Matrix XMPP SDK 检索 XMPP 匿名会话 JID、RID 和 SID

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T07:03:43.397

这篇博文应该回答你的问题： [http ://www.ag-software.de/2012/01/31/bosh-prebind-in-matrix-and-attach-to-strophe/](http://www.ag-software.de/2012/01/31/bosh-prebind-in-matrix-and-attach-to-strophe/)

# eclipse - Eclipse 项目资源管理器在打开文件时保持焦点

> ID：11640286
> 
> 赞同：2
> 
> 时间：2012-07-24T22:34:50.223
> 
> 标签：eclipse

通过双击在 Eclipse 的 Project Explorer 中打开文件会在内置编辑器中打开该文件，但不会将焦点转移到该文件以便立即进行编辑。相反，焦点仍保留在 Project Explorer 中，并且需要在编辑器窗口或选项卡中进一步单击，然后才能编辑或在文档中移动。我想这是设计使然，但我希望有某种选择或解决方法。谢谢。

使用 Eclipse 3.7.2 和安装在 Ubuntu 12-04 上的 C++ 开发工具

# javascript - Bxslider 变量/增量宽度

> ID：11640296
> 
> 赞同：0
> 
> 时间：2012-07-24T22:36:21.883
> 
> 标签：javascript, jquery, css, bxslider

我正在尝试制作一个与[此类](http://www.31philliplim.com/collections/womens-pf12-ready-to-wear)`bxSlider`似的滑块（使用）。

似乎`div`包含滑块会根据用户浏览器的宽度以相等的增量更改其宽度。换句话说，它`div`永远不会部分地切断图像，它总是显示完整的图片或隐藏它。

有谁知道这是如何工作的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T22:51:12.527

您可以使用[媒体查询](https://developer.mozilla.org/en/CSS/Media_queries/)

为此，您必须知道图像的宽度，以便计算滑块容器的宽度。

只是一个简单的例子 - 你的图像是 200 像素宽。因此，对于 800 到 1000px 之间的屏幕，您的图像容器必须是`800px`- 只有 4 个图像可以不裁剪。对于 1000 到 1200 像素之间的屏幕 - `1000px`，因此适合 5 个图像，等等。

# ruby-on-rails - 在尝试遍历所有用户时，为每个用户显示所有隐藏的表数据

> ID：11640297
> 
> 赞同：0
> 
> 时间：2012-07-24T22:36:24.400
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.2

所以我试图列出在我的网站上注册的所有用户，但我在我的视图页面上获取每个用户的所有表格数据。

用户控制器.rb：

```
class UsersController < ApplicationController
    before_filter :authenticate_user!

    def index
        @users = (current_user.blank? ? User.all : User.find(:all, :conditions => ["id != ?", current_user.id]))
  end

    def show
      if params[:id].nil? && current_user
        @user = current_user
      else
        @user = User.find(params[:id])
      end
      @cereal = current_user.cereals.build if signed_in?
      @cereals = @user.cereals.paginate(page: params[:page])
  end

  def first_time
      if params[:id].nil? && current_user
        @user = current_user
      else
        @user = User.find(params[:id])
      end
  end

    def edit
        if params[:id].nil? && current_user
            @user = current_user
        else
            @user = User.find(params[:id])
        end
  end

    def profile
        @username = params[:id]
        @friends = current_user.friends || []
        @title = "User Profile for #{@username}"
        @user = User.find_by_username(@username)
        @users = User.all :conditions => ["id != ?", current_user.id]
  end 

end 
```

用户.rb（模型）

```
class User < ActiveRecord::Base
    include Amistad::FriendModel
  mount_uploader :avatar, AvatarUploader
  has_many :cereals, dependent: :destroy

  # Include default devise modules. Others available are:
  # :token_authenticatable, :confirmable,
  # :lockable, :timeoutable and :omniauthable
  devise :database_authenticatable, :registerable,
         :recoverable, :rememberable, :trackable, :validatable, :authentication_keys => [:login]

  # Setup accessible (or protected) attributes for your model
  attr_accessible :email, :password, :password_confirmation, :remember_me, :username, :login, :avatar, :avatar_cache, :remove_avatar, :firstname, :lastname, :phone, :urlname
  # attr_accessible :title, :body

  attr_accessor :login

  def self.find_first_by_auth_conditions(warden_conditions)
      conditions = warden_conditions.dup
      if login = conditions.delete(:login)
        where(conditions).where(["lower(username) = :value OR lower(email) = :value", { :value => login.downcase }]).first
      else
        where(conditions).first
      end
    end

            def update_with_password(params={})
        current_password = params.delete(:current_password)

        if params[:password].blank?
          params.delete(:password)
          params.delete(:password_confirmation) if params[:password_confirmation].blank?
        end

                result = if params[:password].blank? || valid_password?(current_password) 
          update_attributes(params)
        else
          self.attributes = params
          self.valid?
          self.errors.add(:current_password, current_password.blank? ? :blank : :invalid)
          false
        end

        clean_up_passwords
        result
      end
    end 
```

视图/用户/索引：

```
= @users.each do |user|
    %li
        = user.username 
```

任何人都知道为什么当我为用户打开索引页面时，数据库中用户表中的所有内容都被显示？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T22:48:14.660

这是在快速浏览您的代码之后，但我不禁想尝试从索引视图中删除 = 。它应该是

```
- @users.each do |user| 
```

# iphone - FMDB、GCD 与 NSOperationQueue

> ID：11640306
> 
> 赞同：0
> 
> 时间：2012-07-24T22:36:51.140
> 
> 标签：iphone, fmdb

我有很多数据需要插入到我的 sqlite 数据库的两个表中。我想把这项工作放在后台。我的流程基本上是这样的：（伪代码）

```
while (files in database are not parsed) {

if (fileType == type1) {
   parseType1;
   showProgress;
}
else {
   parseType2;
   showProgress;
}
} 
```

我得到了最新版本的 FMDB，我想我可以像这样将我的数据排入队列：

```
FMDatabaseQueue *queue = [FMDatabaseQueue databaseQueueWithPath:[self databasePath]];

BOOL oldshouldcachestatements = _db.shouldCacheStatements;
[_db setShouldCacheStatements:YES];
[_db beginTransaction];
NSString *insertQuery = [[NSString alloc] initWithFormat:@"INSERT INTO %@ values(null, ?, ?, ?, ?);", tableName];
[tableName release];

__block BOOL success;

// Parse each line by tabs
for (NSString *line in lines) {
    NSAutoreleasePool *pool = [[NSAutoreleasePool alloc] init];
    NSArray *fields = [line componentsSeparatedByString:@"\t"];

    // Need to check since some of the .txt files have an empty newline at the EOF.
    if ([fields count] == NUM_FIELDS) {
        NSNumber *start = [NSNumber numberWithInteger:[[fields objectAtIndex:1] integerValue]];
        NSNumber *end = [NSNumber numberWithInteger:[[fields objectAtIndex:2] integerValue]];
        NSNumber *length = [NSNumber numberWithInteger:([end integerValue] - [start integerValue])];

        NSArray *argArray = [[NSArray alloc] initWithObjects:ID, start, end, length, nil];

        [queue inDatabase:^(FMDatabase *db) {
            success = [_db executeUpdate:insertQuery withArgumentsInArray:argArray];
        }];

        [argArray release];

    }
    [pool drain];
} 
```

我的两种 parseType 方法都是这样的。当我自己运行它时，我收到 FMDatabase 当前正在使用的错误。是因为我需要将两者都放在同一个方法而不是单独的方法中吗？我也尝试过这样的事情：

```
dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_LOW, 0) ^{
   parseType1;
});
dispatch_async(dispatch_get_main_queue, ^{
   update UI;
}); 
```

但是我遇到了与当前正在使用的数据库相同的问题。我是否正确使用了 FMDatabaseQueue？还是我需要做一些不同的事情？如果我在这里使用 NSOperationQueue 而不是 GCD 会更好吗？谢谢！

# python - Amazon AWS - 带龙卷风的 dynamoDB

> ID：11640308
> 
> 赞同：1
> 
> 时间：2012-07-24T22:37:01.197
> 
> 标签：python, amazon-web-services, tornado

有这个开源项目 asyncdynamo

[http://word.bitly.com/post/18861837158/introducing-asyncdynamo](http://word.bitly.com/post/18861837158/introducing-asyncdynamo)

[https://github.com/bitly/asyncdynamo](https://github.com/bitly/asyncdynamo)

但它已经过时了，它使用龙卷风 1.2.1。我还不能测试它，因为我没有信用卡。

.

是否可以将龙卷风与 dynamoDB 一起使用？*（没有异步发电机）*

.

如果是，与其他服务器解决方案相比，tornado 是否给我带来了性能优势？*（使用 dynamoDB 时）*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-09-04T19:03:13.550

我已经将[asyncboto](https://github.com/almost/asyncboto)与 Tornado（版本 3.1）一起使用。它需要对代码进行一些重组以利用回调。此外，您必须添加装饰器以允许在 Tornado 中进行异步调用（请参阅[此处](http://tornado.readthedocs.org/en/latest/gen.html)或 StackOverflow 上的其他地方）

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-11-22T03:52:07.200

您始终可以使用[boto](https://github.com/boto/boto)。它是一个第三方库，应该可以与任何 python 程序一起正常工作。

对于龙卷风部分，服务器的性能与 dynamoDB 无关，而与它本身和您的代码有关。[您可以在此处](http://nichol.as/benchmark-of-python-web-servers)找到许多 python wsgi 服务器的详细基准测试。

# javascript - html 选择 - 范围为 0-10

> ID：11640309
> 
> 赞同：2
> 
> 时间：2012-07-24T22:37:06.657
> 
> 标签：javascript, html

如果我想在五个不同的选择中选择 0-10，是否有 HTML 代码（非 HTML5）允许我不重复五个选择中的每一个的选择，还是我必须重复此代码？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-24T22:38:34.847

不幸的是，如果您只使用 HTML，则必须重复代码

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-24T22:46:00.477

真的，考虑使用 JS。

一些示例html：

```
<select id="someSelect">

</select> 
```

你的脚本：

```
var options = "";
for(var i = 1; i<11; i++ ) {
    options += "<option value="+i+">+i+</option>"; 
```

//编辑摘要：没有字符串连接

```
} 
```

然后只需将您的选择的 html 值设置为等于该变量：

```
document.getElementById('someSelect').innerHTML = options; 
```

或者如果您使用的是 jquery：

```
$('#someSelect').html( options ); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-07-23T15:32:42.297

您可以为此使用[angularjs](http://angularjs.org/)及其指令“ng-repeat”。

```
<div ng-repeat="choice in choices">
   <p>something with {{choice}}</p>
</div> 
```

# iphone - 滚动uitableview时图像会增长

> ID：11640310
> 
> 赞同：0
> 
> 时间：2012-07-24T22:37:08.163
> 
> 标签：iphone, xcode, uitableview

我有一个大问题。在我的应用程序中，当您触摸文本字段时，它会出现在键盘上方，并且我的 tableview 向上滚动，并且我的图像也在 tableview 中。

它运作良好。但是，当我使用 de return 键时，tableview 也会向下滚动文本字段，但是当滚动结束时，我的图像会变大，图像会恢复到正确的大小

返回键的代码：

```
-(BOOL)textFieldShouldReturn:(UITextField *)textField {

[messageField resignFirstResponder];
[UIView beginAnimations:nil context:NULL];
[UIView setAnimationDuration:0.3];
toolbar.frame = CGRectMake(0, 323, 320, 44);
dialogueTb.frame = CGRectMake(0, 0, 320, 372);
[UIView commitAnimations];
return YES; 
```

}

编辑：

我在 textFieldShouldReturn 中发现了问题：

如果我这样做没问题：

```
 -(BOOL)textFieldShouldReturn:(UITextField *)textField {

[messageField resignFirstResponder];
[UIView beginAnimations:nil context:NULL];
[UIView setAnimationDuration:0.3];
toolbar.frame = CGRectMake(0, 323, 320, 44);
[UIView commitAnimations];<<====================== change place
dialogueTb.frame = CGRectMake(0, 0, 320, 372);
//[UIView commitAnimations] 
return YES;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T00:48:36.667

我的猜测是它与 UIImageView 的 autoresizingMask 有关。尝试这个：

```
imageView.autoresizingMask = UIViewAutoresizingNone; 
```

# cakephp - cakephp hasmany 关系给出错误

> ID：11640312
> 
> 赞同：1
> 
> 时间：2012-07-24T22:37:19.360
> 
> 标签：cakephp, cakephp-model

我有一个有一些关系的数据库。在这个例子中我有两个表：

```
activity_ingredients   ingredient_aliases
---------------        ---------------
id                     id
ingredient_id          ingredient_id 
```

我想在我的模型中设置一个条件，以通过字段“ingredient_id”连接表。我已经在这种模式下完成了：

```
class ActivityIngredients extends AppModel{
        public $name = 'ActivityIngredients'; 
        public $useTable = 'activity_ingredients';

        public $hasMany = array (
        'IngredientAlias' => array (
            'className'     => 'IngredientAlias',
            'foreignKey'   => false,
            'conditions' => array('ActivityIngredients.ingredient_id = IngredientAlias.ingredient_id')
        )
        );
    }   

class IngredientAlias extends AppModel {

    public $name = 'IngredientAlias';
    public $useTable = 'ingredient_aliases';
    public $belongsTo = array(
         'ActivityIngredients' => array(
            'className'    => 'ActivityIngredients',
            'foreignKey'   => false
        )

    );  
} 
```

如果我写这段代码给我一个这样的错误：

> 未找到列：1054“where 子句”中的未知列“ActivityIngredients.ingredient_id”

但是，如果我写 hasOne 而不是 hasMany，它不会返回任何错误并且是完美的。但是我的关系是hasMany..为什么？

为了检索数据，我对我的 UserController 进行了查询。用户通过hasMany与Activity关联，Activity与ActivityIngredients在这种模式下关联：

```
public $hasOne = array(
            'ActivityIngredients' => array(
                'className' => 'ActivityIngredients',
                'conditions' => '',
                'dependent' => true,
                'foreignKey'   => 'activity_id'
            ) 
```

要检索数据，我目前正在使用此查询，但我认为我现在必须更改所有查询

```
$this->User->Activity->recursive = 2;
        $activity = $this->User->Activity->findAllByUser_id($id);
        $this->set('activity', $activity); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T04:12:02.537

在定义模型类时，首先应该使用单数词。这意味着模型名称应该是`ActivityIngredient`而不是`ActivityIngredients`。

虽然如果**在`activity_ingredients`表中如果`ingredient_id`id 是属于`ingredient_aliases`表的外键。那么它应该被命名为`ingredient_alias_id`. 同样，如果您在`ingredient_aliases`表中执行相同操作，即外键名称将是`activity_ingredient_id`.** 那么就完全没有问题了。

但是，我正在为您的问题提供解决方案。请检查和验证。

然后您的代码应如下所示：

```
class ActivityIngredient extends AppModel{
    public $name = 'ActivityIngredient'; 
    public $useTable = 'activity_ingredients'; // if you use singular term then no need to define $useTable

    public $hasMany = array (
    'IngredientAlias' => array (
        'className'     => 'IngredientAlias',
        'foreignKey'   => false,
        'finderQuery' => 'select * from ingredient_aliases as `IngredientAlias`
                          where `IngredientAlias`.`ingredient_id` = {$__cakeID__$}'
                               )
    );
}   

class IngredientAlias extends AppModel {

    public $name = 'IngredientAlias';
    public $useTable = 'ingredient_aliases';
    public $belongsTo = array(
                      'ActivityIngredient' => array(
                                   'className'    => 'ActivityIngredient',
                                   'foreignKey'   => 'ingredient_id' 
                                                   )
                             );  
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-25T04:34:29.367

你用过

条件' => 数组（'ActivityIngredients.ingredient_id = IngredientAlias.ingredient_id'）

它应该是

条件' => array('ActivityIngredients.ingredient_id => IngredientAlias.ingredient_id')

使用下面的代码

```
 public $hasMany = array (
            'IngredientAlias' => array (
                'className'     => 'IngredientAlias',
                'foreignKey'   => false,
                conditions' => array('ActivityIngredients.ingredient_id => IngredientAlias.ingredient_id')
            )
            );
        }   

    class IngredientAlias extends AppModel {

        public $name = 'IngredientAlias';
        public $useTable = 'ingredient_aliases';
        public $belongsTo = array(
             'ActivityIngredients' => array(
                'className'    => 'ActivityIngredients',
                'foreignKey'   => false
            )

        );  
    }
    ?> 
```

# backbone.js - 返回时不呈现主干集合

> ID：11640319
> 
> 赞同：1
> 
> 时间：2012-07-24T22:38:04.960
> 
> 标签：backbone.js, backbone-views

我有一个我正在使用 Trigger.io 构建的 Backbone 应用程序，当我单击手机工具栏中的后退按钮时，为什么数据会消失有点困惑。

这是设置：

我有一个视图 SearchResultsView，看起来像这样（为简洁起见，删除了 Trigger.io 代码）：

```
window.SearchResultsView = Backbone.View.extend({

initialize: function() {
    this.template = _.template($('#searchResultsView-template').html());
},

render: function() {

    var self = this;
    var renderedContent = this.template();
    $(this.el).html(renderedContent);

    if (window.resultsCollection) {
        self.drawList(window.resultsCollection);
    }

    return this;
},

events: {
    "click #submitQuery" : "processClick"
},

drawList: function(collection) {

        collection.each(function(place){
            window.console.log(place.get("name"));
            $("#resultsList").append("<li><a href='#locationdetail/"+place.id+"' class='link'>" + place.get("name") +"</a></li>");
        });
},

processClick: function() {

    var self=this;
    this.querystring = $("#searchBox").val(); //get the query

    window.resultsCollection = new Places(null, {query: this.querystring}); 
    window.resultsCollection.fetch(); //this is fetching via a call to the FourSquare API, and populating the models in the collection with that data

    window.resultsCollection.bind('reset', function(collection){
        self.drawList(collection);
    });
}

}); 
```

这是模板：

```
<script type="text/template" id="searchResultsView-template">
<div id="searchbar"></div>
<h1>Results Bitch</h1>
    <input type="text" id="searchBox"></input>
    <input type="submit" id="submitQuery"></input>
    <ul data-role="listview" id="resultsList">
    </ul>
    <a href="locationdetail">Click me</a>
</script> 
```

这是路由器：

```
searchresults: function() {
    this.searchresults = new SearchResultsView({});
    $('#container').empty();
    $('#container').append(this.searchresults.render().el);
}, 
```

以下是它在实践中的工作方式：当我最初加载页面时，没有结果列表（应该是这样）。我输入查询并执行搜索，它会返回并按应有的方式填充列表。然后，我将单击一个项目以转到另一个视图，当我单击“返回”时，列表再次为空。

我正在尝试做的是测试该集合是否仍然存在，如果存在，请继续并重新渲染列表，但它永远不会渲染列表。该集合*确实*存在，因为我可以将它记录到控制台并查看数据。

我怀疑#resultsList 元素尚不可用，因此当它将结果附加到它时，它找不到它，因此没有显示任何内容。

所以：

*   这听起来对吗？
*   为什么？当一切正常时，这与初始负载有何不同？

希望我足够清楚。为了简短起见，我没有包括模型和集合。如果这些有帮助，我很乐意将它们包括在内（尽管，我倾向于认为这是一个观点问题）。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T04:58:18.783

问题在于您在调用方法中附加渲染视图的方式。

在下面的路由器方法中

```
searchresults: function() {
        this.searchresults = new SearchResultsView({});
        $('#container').empty();
        $('#container').append(this.searchresults.render().el);
    }, 
```

**您应该首先将初始化视图的 el 附加到父视图中的元素，然后渲染它**。

这是必要的，因为有时子视图可能会在其自身创建和附加的 html 中搜索 html 元素（如您的情况）。如果在渲染之前未附加视图，则渲染时创建的 html 实际上不会是 windows.document 的一部分，因此不可搜索（它只是在内存中）。

在您的情况下，您正在尝试搜索尚未属于 window.document 的元素。

```
 var SearchResultsView = Backbone.View.extend({
    ...
        drawList: function(collection) {
                collection.each(function(place) {
                    window.console.log(place.get("name")); // this proves the collection is still here. But, it's not rendering? Because the DOM isn't finished rendering yet?
                    $("ul#resultsList").append("<li><a href='#locationdetail/" + place.id + "' class='link'>" + place.get("name") + "</a></li>");
                });
            },
...
}); 
```

以下更改应该可以解决问题。

```
 searchresults: function() {
                this.searchresults = new SearchResultsView({});
                $('#container').empty();
                $('#container').append(this.searchresults.el);
                this.searchresults.render();
            }, 
```

SearchResultsView 的 el 现在是 window.document 的一部分。在视图中创建和附加的任何 html 也是 window.document 的一部分并且可搜索。

这是我根据您的代码编写的带有主干代码的示例工作 html 文件。

[http://jsfiddle.net/venkat_kotra/rHWPL/](http://jsfiddle.net/venkat_kotra/rHWPL/)

# android - 使用 viewpager 滑动图像（不是布局）

> ID：11640327
> 
> 赞同：3
> 
> 时间：2012-07-24T22:39:16.763
> 
> 标签：android, android-fragments, android-viewpager

**我的代码做了什么：**

这是我的代码，用于在 xml 布局（命名为 left.xml、right.xml 和 center.xml）之间滑动的 viewpager。

**我想让它做什么**

我想在图像之间滑动（存储在可绘制文件夹中）。当我用 R.drawable.image 替换 R.layout.xml 时，我的应用程序崩溃了。任何人都可以帮我弄清楚吗？

```
public class MainActivity extends Activity {

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    MyPagerAdapter adapter = new MyPagerAdapter();
    ViewPager myPager = (ViewPager) findViewById(R.id.myfivepanelpager);
    myPager.setAdapter(adapter);
    myPager.setCurrentItem(0);
}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    getMenuInflater().inflate(R.menu.activity_main, menu);
    return true;
}

class MyPagerAdapter extends PagerAdapter {

    public int getCount() {
        return 3;
    }

    public Object instantiateItem(View collection, int position) {

        LayoutInflater inflater = (LayoutInflater) collection.getContext()
                .getSystemService(Context.LAYOUT_INFLATER_SERVICE);

        int resId = 0;
        switch (position) {
        case 0:
            resId = R.layout.left;
            break;
        case 1:
            resId = R.layout.center;
            break;
        case 2:
            resId = R.layout.right;
            break;
        }

        View view = inflater.inflate(resId, null);

        ((ViewPager) collection).addView(view, 0);

        return view;
    }

    @Override
    public void destroyItem(View arg0, int arg1, Object arg2) {
        ((ViewPager) arg0).removeView((View) arg2);

    }

    @Override
    public boolean isViewFromObject(View arg0, Object arg1) {
        return arg0 == ((View) arg1);

    }

    @Override
    public Parcelable saveState() {
        return null;
    }
} 
```

}

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-24T22:56:53.697

如果您使用相同的实现并且只是添加`R.drawable.XXX`而不是，`R.layout.YYY`那么问题就在那里。您正在使用`LayoutInflater`to inflate `ImageView`s，布局 inflater 因为它自己声明它会在单个`View`.

与其这样做，不如尝试`ImageView`通过代码创建对象，然后`return`返回新创建的`ImageView`. 一些示例代码是：

```
public Object instantiateItem(View collection, int position) {

    ImageView img = new ImageView(context); //this is a variable that stores the context of the activity
    //set properties for the image like width, height, gravity etc...

    int resId = 0;
    switch (position) {
        case 0:
            resId = R.drawable.img1;
            break;
        case 1:
            resId = R.drawable.img2;
            break;
        case 2:
            resId = R.drawable.img3;
            break;
    }

    img.setImageResource(resId); //setting the source of the image
    return img;
} 
```

如果您只是使用特定数量的图像或页面，您应该考虑将它们添加到包含`ViewPager`而不是动态创建`ViewPager`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T22:57:59.853

我认为一种选择是使用 ImageView 将每个图像插入到自己的布局中，然后膨胀图像所在的布局而不是图像本身。

# android - 即使有事务，SQLite 插入也会变慢

> ID：11640328
> 
> 赞同：6
> 
> 时间：2012-07-24T22:39:29.293
> 
> 标签：android, database, performance, sqlite, transactions

即使是事务，我也遇到了 sqlite 插入性能的问题。我的 android 应用程序从 Web 服务接收大约 23.000 行，我必须将它们插入到单个表中。

Web 服务是分区的，因此我在对 WS 的每个请求中收到大约 2000 行，并且我将 2000 个插入包装在一个事务中。在这些插入完成后，我将新请求发送到 WS 并再次为新的 2000 行使用新事务。

一开始它工作正常。它每秒执行很多插入操作。但随着时间的推移，它变得越来越慢，最终以每秒 4 或 3 次插入结束，直到完成 23000 行。

桌子大小有问题吗？当它变大时，插入变慢？有什么方法可以提高大量数据的性能吗？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-29T19:36:20.477

在[如何提高 SQLite 的性能？](https://stackoverflow.com/questions/1711631/how-do-i-improve-the-performance-of-sqlite)这很好。如果您还没有使用它们，我至少会选择准备好的语句。

但是，由于您使用的是 Android，我猜您可能会遇到一些写入闪存的 I/O 瓶颈。尝试在不同制造商的几个不同设备上运行代码，看看是否有任何极端变化。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-26T05:14:39.587

您应该使用数据分区。因为您可以插入 100 - 100 个插入，因此过程将很顺利，不会发生数据丢失问题。

我假设您正在使用异步（可以是其他）线程的另一件事。

或者您也可以在最后一种情况下使用服务来一次使用所有数据。

# objective-c - 无法在 iOS 4 中从一个选项卡移动到另一个选项卡

> ID：11640329
> 
> 赞同：0
> 
> 时间：2012-07-24T22:39:48.127
> 
> 标签：objective-c, ios5, ios4

我有一个在 iOS 5 中运行良好的应用程序，但是当我在 iOS 4 中尝试它时，我得到一个 EXC_BAD_ACCESS 错误。我在 AppDelegate 中添加了一个标签栏，如下所示：

```
self.window = [[[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]] autorelease];
self.window.backgroundColor = [UIColor whiteColor];
[[UIApplication sharedApplication] setStatusBarStyle:UIStatusBarStyleDefault animated:NO];

UITabBarController *tabBarController=[[UITabBarController alloc] init];

searchTableViewController = [[SearchTableViewController alloc] initWithStyle:UITableViewStylePlain];
UINavigationController *navControllerSearch=[[UINavigationController alloc] initWithRootViewController:searchTableViewController];

firstviewcontroller = [[FirstViewController alloc] initWithStyle:UITableViewStyleGrouped] ;
UINavigationController *navFirstView=[[UINavigationController alloc] initWithRootViewController:firstviewcontroller];
[[FirstViewController tableView] setScrollEnabled:NO];

secondViewController = [[SecondViewController alloc] initWithStyle:UITableViewStyleGrouped];
UINavigationController *navsecondView=[[UINavigationController alloc] initWithRootViewController:secondViewController];
[[SecondViewController tableView] setScrollEnabled:NO];

[tabBarController setViewControllers:[NSArray arrayWithObjects:navFirstView, navSecondView, navControllerSearch, nil]];

[self.window setRootViewController:tabBarController]; 
```

当我尝试从第一个选项卡移动到第二个选项卡时，应用程序崩溃了。在 iOS 5 中它运行良好。iOS 部署目标属性是 iOS 4.0。

如果我运行 Instruments 并寻找 Zombies，我可以找到具有以下信息的 Zombie：

```
#   Address Category    Event Type  RefCt   Timestamp   Size    Responsible      Library    Responsible Caller
1   0x5a21880   CALayer Zombie  -1  00:10.816.545   0   QuartzCore  -[CALayerArray copyWithZone:]

0 CoreFoundation ___forwarding___
1 CoreFoundation _CF_forwarding_prep_0
2 CoreFoundation CFRetain
3 CoreFoundation +[__NSArrayI __new::]
4 QuartzCore -[CALayerArray copyWithZone:]
5 CoreFoundation -[NSObject(NSObject) copy]
6 UIKit -[UIView(Hierarchy)  _makeSubtreePerformSelector:withObject:withObject:copySublayers:]
7 UIKit -[UIView(Hierarchy) _makeSubtreePerformSelector:withObject:withObject:copySublayers:]
8 UIKit -[UIView(Hierarchy) _makeSubtreePerformSelector:withObject:withObject:copySublayers:]
9 UIKit -[UIView(Hierarchy) _makeSubtreePerformSelector:withObject:withObject:copySublayers:]
10 UIKit -[UIView(Hierarchy) _makeSubtreePerformSelector:withObject:withObject:copySublayers:]
11 UIKit -[UIView(Hierarchy) _makeSubtreePerformSelector:withObject:withObject:copySublayers:]
12 UIKit -[UIView(Hierarchy) removeFromSuperview]
13 UIKit -[UITransitionView _didCompleteTransition:]
14 UIKit -[UITransitionView transition:fromView:toView:]
15 UIKit -[UITransitionView transition:toView:]
16 UIKit -[UITabBarController transitionFromViewController:toViewController:transition:shouldSetSelected:]
17 UIKit -[UITabBarController transitionFromViewController:toViewController:]
18 UIKit -[UITabBarController _setSelectedViewController:]
19 UIKit -[UITabBarController _tabBarItemClicked:] 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T03:10:34.930

您可能想检查第二个 ViewController 中的代码，也许有什么东西在加载时让您崩溃，看起来崩溃是在转换完成后发生的。尝试调试您的 viewWillApear 或 viewDidLoad。其他选项卡也会崩溃吗？

# iphone - 为什么这段代码运行缓慢？

> ID：11640341
> 
> 赞同：0
> 
> 时间：2012-07-24T22:40:56.640
> 
> 标签：iphone, objective-c, performance, cocoa, ipad

我在弄清楚为什么这段代码运行缓慢时遇到了一些麻烦。我在下面做的是从 yahoo Finance 获取 4 家公司的 JSON 数据。从 JSON 数据中，我只是提取了 4 家公司的名称。然而，当我 NSLog 4 家公司的名称时，它需要将近 2 秒的时间！他们在代码中的某些东西我做错了吗？我怎样才能让代码运行得更快？

```
for (int i=0; i<4; i++) {
    //download JSON data
    NSData* data = [NSData dataWithContentsOfURL: 
                    [NSURL URLWithString:@"http://query.yahooapis.com/v1/public/yql?q=select%20*%20from%20yahoo.finance.quotes%20where%20symbol%20in%20(%22AAPL%22,%22GOOG%22,%22GE%22,%22MCD%22)%0A%09%09&env=http%3A%2F%2Fdatatables.org%2Falltables.env&format=json"]];

    //parse out the json data
    NSError* error;
    NSDictionary* json = [NSJSONSerialization 
                          JSONObjectWithData:data //1

                          options:kNilOptions 
                          error:&error];

    //Get the relavent data from JSON
    NSString* companyName = [[[[[json objectForKey:@"query"] objectForKey:@"results"] objectForKey:@"quote"] objectAtIndex:i] objectForKey:@"Name"] ;

    NSLog(@"company name is %@", companyName);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T22:45:05.937

正如理查德所说，不要下载文件 4 次。作为第一次迭代，试试这个：

```
 //download JSON data
    NSData* data = [NSData dataWithContentsOfURL: 
                    [NSURL URLWithString:@"http://query.yahooapis.com/v1/public/yql?q=select%20*%20from%20yahoo.finance.quotes%20where%20symbol%20in%20(%22AAPL%22,%22GOOG%22,%22GE%22,%22MCD%22)%0A%09%09&env=http%3A%2F%2Fdatatables.org%2Falltables.env&format=json"]];

    //parse out the json data
    NSError* error;
    NSDictionary* json = [NSJSONSerialization 
                          JSONObjectWithData:data //1

                          options:kNilOptions 
                          error:&error];

for (int i=0; i<4; i++) {

    //Get the relavent data from JSON
    NSString* companyName = [[[[[json objectForKey:@"query"] objectForKey:@"results"] objectForKey:@"quote"] objectAtIndex:i] objectForKey:@"Name"] ;

    NSLog(@"company name is %@", companyName);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T22:46:27.830

`NSLog`会减慢应用程序的速度，并且数据请求方法`+dataWithContentsOfURL:`是同步的，这意味着您的应用程序会坐在那里等待响应返回，然后再进行其余的循环。

使用[异步请求](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/nsurlconnection_Class/Reference/Reference.html)获取网络数据，将您的 JSON 解析代码放入处理响应的委托方法中。这将使应用程序看起来运行得更快，通过在结果进入后立即处理。

# mysql - 我的 Rails 应用程序中的随机 MySQL 异常

> ID：11640342
> 
> 赞同：5
> 
> 时间：2012-07-24T22:40:56.803
> 
> 标签：mysql, ruby-on-rails, exception

我的 Rails 应用程序的 MySQL 后端出现问题。

基本上每次部署时，我都会开始遇到奇怪的异常，例如

```
ActiveRecord::StatementInvalid: Mysql2::Error: 
NoMethodError: undefined method `fields' for nil:NilClass
ActiveModel::MissingAttributeError: missing attribute: created_at
ActiveRecord::StatementInvalid: Mysql2::Error: Lost connection to MySQL server during query
ActiveRecord::UnknownPrimaryKey: Unknown primary key for table users in model User.
RuntimeError: Session collision on '"017fab6b21d2ef20d30e6119f7bf...."' 
```

我不确定这是否是由于突然加载而发生的，我的 MySQL 实例无法承受，但是当我在部署后重新启动应用程序时会发生 99%。

这可能是什么原因造成的？我有 Rails 3.2.6、Ubuntu 12.04、MySQL 5.1.63

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T02:54:43.870

最近几周我遇到了类似的问题，不知道它来自哪里。昨天我调整了 unicorn 配置（我们的服务器在 Debian + unicorn + MySQL 上运行），将 worker 数量更改为 4，并将每个 worker 的并发连接数限制为 2（在 config/database.yml 中）。今天早上我发现问题消失了，不再发生这样的随机异常。所以我猜是因为太多的并发连接使 MySQL 不稳定。

我刚刚在[我的博客](http://blog.zellux.me/)上发布了关于它的信息。希望这也可以帮助你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T22:48:33.690

错误似乎表明缺少“属性”。您的数据库架构和类结构是否都处理“created_at”变量或列？我会专门看一下用户类/表。

# delphi - 使用 TWebBrowser Delphi 组件下载 XML 文件

> ID：11640347
> 
> 赞同：1
> 
> 时间：2012-07-24T22:41:21.863
> 
> 标签：delphi, webbrowser-control

我不知道如何使用 Delphi 从 TWebBrowser ActiveX 组件中检索 XML 内容。

如果结果是 HTML，我可以使用：

```
 iall := (WebBrowser1.Document AS IHTMLDocument2).body;
 while iall.parentElement <> nil do
 begin
   iall := iall.parentElement;
 end;
 memo1.Text := iall.outerHTML; 
```

但是 URL 返回一个 XML 文件，而 .body 什么也不返回。

下面的代码缺少什么？

```
var S:String;
begin
   WebBrowser1.Navigate('http://192.168.0.35:8000/api/');
   if Assigned(WebBrowser1.Document) then
   begin
     Doc := (WebBrowser1.Document as IHTMLDocument2);
     XMLText := ???
   end;
end; 
```

备注：我无法使用 Indy HTTPClient 组件，因为该程序将在不同的代理配置上运行，并且很难处理许多配置。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-24T23:14:14.820

这似乎适用于本地 XML 文件，也应该适用于 URL：

```
procedure TForm3.FormShow(Sender: TObject);
begin
  WebBrowser1.Navigate('file:///d:/temp/TestFile.xml');
end;

procedure TForm3.WebBrowser1DocumentComplete(ASender: TObject;
  const pDisp: IDispatch; const URL: OleVariant);
var
  HTML: IHtmlDocument2;
  XMLText: String;
begin
  HTML := WebBrowser1.Document as IHTMLDocument2;
  XMLText := HTML.body.outerText;

  // Just for display purposes, obviously. 
  ShowMessage(XMLText);
end; 
```

# c - 使用 -Wl,--wrap 对包装函数的未定义引用

> ID：11640350
> 
> 赞同：0
> 
> 时间：2012-07-24T22:41:49.560
> 
> 标签：c, unit-testing, gcc, linker, wrapper

我正在使用 GCC 4.4.6-3 运行 RHEL 6.2。我正在对一些遗留代码进行单元测试，并试图用 with 包装函数`-Wl`，`--wrap=function`。其中函数可能是系统调用，如`close`, 或`malloc`，但主要是在我的链接对象文件中定义的其他函数。

我的测试 check_GetRequestID.c 类似于：

```
#include<stdlib.h>

int __wrap_getpid()
{
   return 10; 
}
int main(void)
{
    int x = API_GetRequestID();
    return 0;

} 
```

`API_GetRequestID()`调用`getpid()`所以我将它包装成为*unit-testing*仔细定义的东西。

编译命令为：

> gcc -m64 -pthread -DLITTLEEND -fPIC -I。-Iother/include/folders -Wall -Wformat -DFIU_ENABLE=1 -D_GNU_SOURCE -D_THREAD_SAFE -DLINUX -Wpointer-arith -pthread -c check_GetRequestID.c
> 
> gcc -m64 -pthread -DLITTLEEND -fPIC -I。-Iother/include/folders -Wall -Wformat -DFIU_ENABLE=1 -D_GNU_SOURCE -D_THREAD_SAFE -DLINUX -Wpointer-arith -pthread -L。-Lother/lib/paths -lcrypt -lutil -Wl,--wrap=getpid -Wl,--wrap=otherfunctions object.o object2.o ... -o check_GetRequestID

在链接命令中，每个调用包装函数的函数都会出错。如果一个函数 in`object2.o`调用`getpid()`，那么它会为`__wrap_getpid`in抛出未定义的引用`object2.o`。这包括`API_GetRequestID`，这是我试图*单元测试*的功能。

关于更改源代码或制作文件的任何建议，这将允许我正在单元测试的函数在调用`__wrap_getpid`时调用`getpid()`？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T22:49:07.170

您也可以只定义一个与 getpid() 本身具有完全相同原型的函数。这样*动态*链接器将首先找到您的定义并停止在链接库中搜索它。

如果使用 getpid() 的代码驻留在动态库中，该策略可能不起作用。

# python - 从 Python 中的 URL 中删除 utm_* 参数

> ID：11640353
> 
> 赞同：8
> 
> 时间：2012-07-24T22:42:52.883
> 
> 标签：python

我一直在尝试从 URL 列表中删除所有 utm_* 参数。我发现的最接近的是：[https](https://gist.github.com/626834) ://gist.github.com/626834 。

有任何想法吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-24T23:03:47.143

它有点长，但使用 url* 模块，并避免使用 re's。

```
from urllib import urlencode
from urlparse import urlparse, parse_qs, urlunparse

url = 'http://whatever.com/somepage?utm_one=3&something=4&utm_two=5&utm_blank&something_else'

parsed = urlparse(url)
qd = parse_qs(parsed.query, keep_blank_values=True)
filtered = dict( (k, v) for k, v in qd.iteritems() if not k.startswith('utm_'))
newurl = urlunparse([
    parsed.scheme,
    parsed.netloc,
    parsed.path,
    parsed.params,
    urlencode(filtered, doseq=True), # query string
    parsed.fragment
])

print newurl
# 'http://whatever.com/somepage?something=4&something_else' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T23:00:08.930

```
import re
from urlparse import urlparse, urlunparse

url = 'http://www.someurl.com/page.html?foo=bar&utm_medium=qux&baz=qoo'
parsed_url = list(urlparse(url))
parsed_url[4] = '&'.join(
    [x for x in parsed_url[4].split('&') if not re.match(r'utm_', x)])
utmless_url = urlunparse(parsed_url)

print utmless_url  # 'http://www.someurl.com/page.html?foo=bar&baz=qoo' 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-24T23:12:11.883

简单，有效，并且根据您发布的链接，但它是重新......所以，不确定它不会因为某种我无法想到的原因而中断:)

```
import re

def trim_utm(url):
    if "utm_" not in url:
        return url
    matches = re.findall('(.+\?)([^#]*)(.*)', url)
    if len(matches) == 0:
        return url
    match = matches[0]
    query = match[1]
    sanitized_query = '&'.join([p for p in query.split('&') if not p.startswith('utm_')])
    return match[0]+sanitized_query+match[2]

if __name__ == "__main__":
    tests = [   "http://localhost/index.php?a=1&utm_source=1&b=2",
                "http://localhost/index.php?a=1&utm_source=1&b=2#hash",
                "http://localhost/index.php?a=1&utm_source=1&b=2&utm_something=no#hash",
                "http://localhost/index.php?a=1&utm_source=1&utm_a=yes&b=2#hash",
                "http://localhost/index.php?utm_a=a",
                "http://localhost/index.php?a=utm_a",
                "http://localhost/index.php?a=1&b=2",
                "http://localhost/index.php",
                "http://localhost/index.php#hash2"
            ]

    for t in tests:
        trimmed = trim_utm(t)
        print t
        print trimmed
        print 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-10-29T09:03:46.960

这个怎么样。很好很简单：

```
url = 'https://searchengineland.com/amazon-q3-ad-revenues-surpass-1-billion-roughly-2x-early-2016-285763?utm_source=feedburner&utm_medium=feed&utm_campaign=feed-main'

print url[:url.find('?utm')]

https://searchengineland.com/amazon-q3-ad-revenues-surpass-1-billion-roughly-2x-early-2016-285763 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-02-15T21:49:48.237

使用正则表达式

```
import re
def clean_url(url):
    return re.sub(r'(?<=[?&])utm_[^&]+&?', '', url) 
```

这是怎么回事？我们使用正则表达式来查找字符串的所有实例，这些实例看起来像 utm_somekey=somevalue ，前面有“？” 或者 ”＆”。

测试它：

```
tests = [   "http://localhost/index.php?a=1&utm_source=1&b=2",
            "http://localhost/index.php?a=1&utm_source=1&b=2#hash",
            "http://localhost/index.php?a=1&utm_source=1&b=2&utm_something=no#hash",
            "http://localhost/index.php?a=1&utm_source=1&utm_a=yes&b=2#hash",
            "http://localhost/index.php?utm_a=a",
            "http://localhost/index.php?a=utm_a",
            "http://localhost/index.php?a=1&b=2",
            "http://localhost/index.php",
            "http://localhost/index.php#hash2"
        ]

for t in tests:
    print(clean_url(t))

http://localhost/index.php?a=1&b=2
http://localhost/index.php?a=1&b=2#hash
http://localhost/index.php?a=1&b=2&
http://localhost/index.php?a=1&b=2#hash
http://localhost/index.php?
http://localhost/index.php?a=utm_a
http://localhost/index.php?a=1&b=2
http://localhost/index.php
http://localhost/index.php#hash2 
```

# java - MongoDB Java：如何在 DBObject 中表示 $in 查询？

> ID：11640355
> 
> 赞同：0
> 
> 时间：2012-07-24T22:43:22.727
> 
> 标签：java, mongodb

我的架构看起来像

```
Id:
date_created:
vars: {
      NAME:
      VALUE:
      EDITABLE:
      .....

} 
```

我知道使用`command-line`我们可以选择一系列文档，例如

```
.find({'Id': {$in: ['a', 'b', ...]}}) 
```

[是否可以使用DBObject](http://api.mongodb.org/java/2.8.0/com/mongodb/DBObject.html)做类似的事情？

这是因为我想对多个文档执行**更新**`Id` **，其中包含** `a', 'b',' 'c', ...`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T22:45:48.360

刚找到[http://api.mongodb.org/java/2.8.0/com/mongodb/QueryBuilder.html#in(java.lang.Object](http://api.mongodb.org/java/2.8.0/com/mongodb/QueryBuilder.html#in(java.lang.Object) )

# google-maps - 谷歌地图 fitBounds() 坏了还是..？

> ID：11640356
> 
> 赞同：0
> 
> 时间：2012-07-24T22:43:29.390
> 
> 标签：google-maps

```
<!DOCTYPE html>
<html>
<head>
<title>Google Maps JavaScript API v3 Example: Map Simple</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<meta charset="UTF-8">
<style type="text/css">
#map_canvas {
    width: 500px;
    height: 500px;
}
</style>
<script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?sensor=false&libraries=geometry"></script>
<script type="text/javascript">
    var map;
    function initialize() {
        var myOptions = {
            zoom : 8,
            center : new google.maps.LatLng(-34.397, 150.644),
            mapTypeId : google.maps.MapTypeId.ROADMAP
        };
        map = new google.maps.Map(document.getElementById('map_canvas'), myOptions);

        var locationA = {
            latitude : 37.788081 + 0.0049,
            longitude : -83.001709 + 0.00019
        };
        var locationB = {
            latitude : 37.788081,
            longitude : -83.001709
        };

        var sw = new google.maps.LatLng(locationA.latitude, locationA.longitude);
        var ne = new google.maps.LatLng(locationB.latitude, locationB.longitude);

        var distance = google.maps.geometry.spherical.computeDistanceBetween(sw, ne);
        console.log("Distance between SW & NE: " + distance);

        var bounds = new google.maps.LatLngBounds(sw, ne);
        console.log(bounds);
        map.fitBounds(bounds);
    }

    google.maps.event.addDomListener(window, 'load', initialize);
</script>
</head>
<body>
    <div id="map_canvas"></div>
</body>
</html> 
```

以上返回： ![在此处输入图像描述](../Images/37dd9a856a079a986c9291fe19b58e31.png)

在开发测试期间意外得到它，清理了该“错误”周围的所有内容，但它似乎确实是一个错误。

谁能解释一下？

设置为确实显示有效`locationA.longitude`的地图，所以这就是问题所在。`0.00019``0`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T23:42:55.360

你的界限是无效的，南大于北，东大于西。如果将加号切换为减号，它将加载。我只会创建一个`LatLngBounds`没有参数的，然后使用`bounds.extend`。

```
var bounds = new google.maps.LatLngBounds();
    bounds.extend(sw);
    bounds.extend(ne); 
```

# visual-studio-2010 - w3wp.exe 的含义：所有未完成的 func-evals 尚未完成

> ID：11640357
> 
> 赞同：6
> 
> 时间：2012-07-24T22:43:42.760
> 
> 标签：visual-studio-2010, iis-7.5, w3wp.exe

在我使用 Visual Studio 以及附加和分离进程的这些年中，我不记得看到这个错误，这就是为什么当我刚刚从 IIS .NET 4.0 网站项目分离时它对我来说很突出。

我对这个错误消息非常好奇，并在寻找它的含义的解释，以及引用的“func-evals”是什么。

![在此处输入图像描述](../Images/ef6617e7100873297ce766d66a6d677d.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-16T13:58:52.867

信息：

```
FuncEval is, quite simply, the process of invoking a method while stopped in the debugger. 
```

~ [http://blogs.msdn.com/b/ansonh/archive/2006/09/22/765986.aspx](http://blogs.msdn.com/b/ansonh/archive/2006/09/22/765986.aspx)

该方法可以在 VS IDE 中的不同位置调用，但不限于：

*   即时窗口
*   观察窗口

虽然我没有找到有关错误消息的更多信息，但似乎我可能在中断模式下调用了代码中的一个方法，并试图在完成之前从进程中分离，导致 Visual Studio 提示我等待。

# python - Working with Outlook Redemption in Python

> ID：11640359
> 
> 赞同：1
> 
> 时间：2012-07-24T22:43:44.610
> 
> 标签：python, outlook-redemption

Okay, so here is my current problem which can be broken down into several parts, and any advice on any part would be greatly appreciated!

1.  Overview of general problem: I have several PST files in which every email contained within the PST files has a tag that I need to remove. The end goal is a PST file minus the tag (the tag is 3 lines of text in each email bracketed on the top and bottom by lines of *).

2.  To solve this, I wanted to be able to manipulate the PSTs in Python.

3.  In order to manipulate in Python, I found out that i could use [Outlook Redemption](http://www.dimastr.com/redemption/home.htm) and its MAPI tables (I have not used any MAPI tables before).

4.  Outlook Redemption is deployed in a DLL file, and I have never had to import a DLL file into Python before, so I checked Stack Overflow and got [this answer](https://stackoverflow.com/questions/252417/how-can-i-use-a-dll-from-python). However, I don't understand these lines:

    ```
    # Actually map the call ("HLLAPI(...)") to a Python name. 
    hllApi = hllApiProto (("HLLAPI", hllDll), hllApiParams) 
    ```

    What should I put in the space denoted by "...", and does he mean anything special by mapping it to a Python name?

Like I said, any help / advice / suggestions / pity would be greatly appreciated.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T14:46:18.600

我不使用 Python，但看起来您可以像使用任何其他 COM 对象一样使用 Redemption： [从 Python 修改 Microsoft Outlook 联系人](https://stackoverflow.com/questions/405724/modifying-microsoft-outlook-contacts-from-python)

```
import win32com.client 
import pywintypes 

session = win32com.client.Dispatch("Redemption.RDOSession") 
... 
```

# java - Is it possible to connect a existing java android app with an AS3 android app?

> ID：11640361
> 
> 赞同：1
> 
> 时间：2012-07-24T22:43:54.380
> 
> 标签：java, android, actionscript-3

I would like to know if it's possible to get data from an already existing android application that is written in java and be used in an application that i am writing in action script. Basically what i want to do is for exemple when a button is pressed in my AS3 app i want it to call another app that i have written but in java have it doing his thing and then close it and have it return to the AS3 app.

Has any one done this before? Any pointers and insides are very welcome.

Thank you!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T22:58:14.327

首先。应用程序在 Android 中有点像海市蜃楼。Android 操作系统正在运行，它会根据用户操作（如按下主页等）来决定打开或关闭哪个应用程序。

这里有一些建议。用于应用程序之间的通信。它们都可以绑定到远程服务。在安装其中一个应用程序后，可以安装远程服务或请求安装。使用远程服务允许两个应用程序之间的事件通信。当第二个应用程序完成处理时，它可以关闭其活动，因此它不具有优先权。或者，您将拥有应用程序的无视图模式。发出请求的主要活动将等待通过回调返回的事件。

所以是的，它可以做到。它只是一点工作。

# php - 卡在 ISO-8859-9 字符集的 Jquery Ajax Db 编码

> ID：11640363
> 
> 赞同：0
> 
> 时间：2012-07-24T22:44:05.310
> 
> 标签：php, jquery, html, ajax, asp-classic

我正在尝试通过我的 Jquery 应用程序将数据传递给 db。我在编码方面遇到了严重的问题。

当前页面编码为 iso-8859-9。我已将我的 ajax 页面编码为 iso-8859-9 并传递 .ajax 数据`contentType: "application/x-www-form-urlencoded;charset=ISO-8859-9"`

它像每次尝试一样存储`İZİN`价值。`Ä°ZÄ°N`

如果我创建一个 PHP 页面并使用标题设置编码，它是否有效？

PS：我正在处理 HTML 页面上的数据。处理器页面是一个 ASP 页面，我猜是使用 MsSQL db。我无权访问处理器页面或数据库。只需通过表单发布输入数据。

**İZİN**词和其他一些类似的词在 WHERE 子句的其他一些页面上用于 sql 查询。所以我无法将字符转换为 HTML 代码。我必须使用 İ 作为 İ。

感谢您的建议！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-30T09:14:08.140

`application/x-www-form-urlencoded`没有字符集。它只是ASCII字符。在那里指定字符集将无济于事。

jQuery 通常会按照[指定](http://en.wikipedia.org/wiki/Percent-encoding#Current_standard)对您的数据进行 urlencode ：

1.  编码为 UTF-8
2.  百分比编码

所以：

```
$.post( "test.php", {data: 'İZİN'}); //Shorthand for $.ajax 
```

实际上将其发布到服务器：

```
data=%C4%B0Z%C4%B0N 
```

当您使用`$_POST['data']`php 访问时，它们已被转换为字节（`0xC4B05AC4B04E`），因此回显它们会给您提供格式错误的数据：

```
header("Content-Type: text/html; charset=ISO-8859-9");
echo $_POST['data'];
// Ä°ZÄ°N 
```

您可以通过以下方式测试这是真的：

```
header("Content-Type: text/html; charset=ISO-8859-9");
echo "\xC4\xB0\x5A\xC4\xB0\x4E";
// Ä°ZÄ°N 
```

在 PHP 中，您需要在收到它后立即将其转换为 ISO-8859-9：

```
<?php
header("Content-Type: text/html; charset=ISO-8859-9");
$data =  "\xC4\xB0\x5A\xC4\xB0\x4E"; //$_POST['data'];
$proper = mb_convert_encoding( $data, "ISO-8859-9", "UTF-8" );
echo $proper;
//İZİN 
```

请注意，在任何地方都使用 UTF-8 要容易得多，因为它几乎是最好的编码，并且网络喜欢它。如果您使用任何其他编码，那么您将必须始终保持警惕。

# sql-server-2008 - SELECT: Which runs faster?

> ID：11640365
> 
> 赞同：0
> 
> 时间：2012-07-24T22:44:47.087
> 
> 标签：sql-server-2008

Employees are going to read data (a whole row) from the server through a website.

The data to be read by them, the rows, is the result of quite a few joins involving something more than 10 tables.

**Question:**

**1.** Should I create and refresh a new table containing the end-resulta data to be read so at presentation layer we just do Select top 1 from table?

**2.** Or should I execute a Select... and a large series of joins, multiplication, etc in order to get that one row?

* * *

I'm about to start with this and the first idea I have to admint was to build a big new table with the data, but this question popped up since I'm being carefull with normalization through tables, and building the new one would result in redundancy of data.

Have to say that the desired product is for the Employees webpage to access the data as fast as possible (this is why at first I thought about creating and refreshing a new table)

Thanks.

* * *

**EDIT**

about 300 (maybe 1k in the future) people is going to access the website. They will query this one row, do what they have to do with it and then hit OK so they get a new row (guess it will be 2 minutes between query and query). What we don't want to happen is: Employees are gonna get coached all the time, and one of those coaching factors is the time they take to work on a row (client I must say). So, if the query takes too long (a matter of seconds between every refresh would be "too long" for them) then I'd have to build a new way to take this into consideration. And of course I'd prefer not to.

* * *

**EDIT 2**

Once they hit OK, another query triggers to update data in the DataBase, then the original query so another row is sent to the webpage.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T22:50:13.900

我会先从常规视图开始，只有当我遇到性能问题时，我才会实现它（索引视图或手动创建一个新表并用数据填充它）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T22:51:02.010

我宁愿拥有一个规范化的数据库并运行一个*可能*比非规范化数据和更快的查询更昂贵的查询。我认为第二种情况可能会遇到维护/可读性问题，不仅是为了确保您的缓存表是最新的，而且必须写入该数据的所有核心逻辑以解决这些情况。

如果它被大量访问，您可能希望在检索此数据的客户端（asp.net？）上实现缓存，以防止不必要的调用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-24T22:47:10.337

> 不得不说，想要的产品是让员工网页尽可能快地访问数据

为什么它必须尽可能快？如果它在 0.1 秒内运行，那还不够快吗？

是因为您正在循环运行查询吗？如果是这样，那么我建议您更改策略以批量获取数据，而不是一次获取一行。

如果您出于某种原因确实需要它尽可能快，那么是的，准备好预先计算的结果将比从原始数据源进行查询要快。填充表是实现此目的的一种方法。另一种方式是使用缓存机制，使得请求只有第一次慢，但重复请求相同数据会更快。

请注意，预先计算结果或使用缓存都会提高性能，但可能会在原始数据更改时给您带来陈旧数据的问题。

# javascript - Uncaught Error: NOT_FOUND_ERR: DOM Exception 8 for appendChild call

> ID：11640367
> 
> 赞同：11
> 
> 时间：2012-07-24T22:45:05.063
> 
> 标签：javascript

> **Possible Duplicate:**
> [javascript appendChild doesn't work](https://stackoverflow.com/questions/7041740/javascript-appendchild-doesnt-work)

The error occurs on the last line of this snippet:

```
 var anchor = "<a id=\"hostname\" href=\"" + destination + "\"> "+ imagename + "</a>";
 var specialdiv = document.getElementById("specialdiv");
 console.log("div: " + specialdiv);
 specialdiv.appendChild(anchor); 
```

There's really nothing else going on... I verified that `specialdiv` isn't null or something like that. Can anyone explain why I'm getting this error on that line?

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-07-24T22:50:43.783

不要传递字符串，而是传递元素

```
var link = document.createElement('a');
link.innerHTML = imagename;
link.id = "hostname";
link.href = destination;

var specialdiv = document.getElementById("specialdiv");
specialdiv.appendChild(link); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-24T22:48:46.153

您收到该错误是因为`appendChild`需要 DOM 元素，而不是字符串。在使用`appendChild`.

```
var anchor = document.createElement('a');
anchor.id = "hostname";
anchor.href = destination;
anchor.innerHTML = imagename;

var specialdiv = document.getElementById("specialdiv");
specialdiv.appendChild(anchor); 
```

# android - 自 JellyBean 以来 Canvas.drawBitmap 中的错误？

> ID：11640370
> 
> 赞同：0
> 
> 时间：2012-07-24T22:45:23.130
> 
> 标签：android, android-4.2-jelly-bean

我在更新为 Jelly Bean 的设备上的一个应用程序上有一个奇怪的行为。这个游戏做了一个：canvas.drawBitmap(bitmap, locationX ,locationY, null); 我的位图可以有 2 种尺寸：40x15 和 60x15。

在 Jelly Bean 设备上（我在 Galaxy Nexus 和 Nexus S 上试过），使用 60x15 的位图时，drawBitmap 什么也不画。如果我将大小调整为 40x15，它可以正常工作。

我对较低版本的android没有任何问题。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T11:04:22.773

我通过将所有图形的副本存储在“/drawable-nodpi”中找到了解决方法。然后果冻豆给他们看。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-08T02:22:57.800

Jellybean 似乎为 drawBitmap() 引入了新的缓存行为。现在它尝试在硬件中为每个位图对象缓存纹理。

这意味着如果您重绘同一个位图对象，它将重新使用之前的纹理。但是它不会检查位图对象的内容是否发生了变化，它只是使用指针来查找缓存。

在我看来，这完全被打破了，但他们显然出于性能原因决定这样做。类似的逻辑适用于 drawPath()。

我怀疑不同大小的行为是因为当您调整位图大小时，它会导致分配一个新的缓冲区。

# symfony - 在 Symfony 2 错误定制中应该覆盖哪些模板？

> ID：11640372
> 
> 赞同：1
> 
> 时间：2012-07-24T22:45:27.293
> 
> 标签：symfony, twig

从[文档](http://symfony.com/doc/current/cookbook/controller/error_pages.html)中：

> 所有的错误模板都存在于 TwigBundle 中。要覆盖模板，我们只需依靠标准方法来覆盖捆绑包中的模板。

和：

> 要查看默认错误模板的完整列表，请参阅 TwigBundle 的 Resources/views/Exception 目录。

查看后面提到的目录，[我可以找到几个文件](https://github.com/symfony/symfony/tree/master/src/Symfony/Bundle/TwigBundle/Resources/views/Exception)。我对 403、404 和 500 错误的自定义模板感兴趣，所以我创建了`error.html.twig`(父模板) 和`error403.html.twig`,`error404.html.twig`并且`error500.html.twig`从`'TwigBundle:Exception:error.html.twig'`(被我的自定义父模板覆盖) 扩展。

它是否正确？如果抛出另一种错误或异常会发生什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-24T23:16:51.917

是的，它是正确的。

所有其他类型的异常都将被内核捕获并呈现 error500.html.twig 页面。

要测试它，您可以暂时关闭调试，方法是切换传递给 app_dev.php 中的 AppKerner 构造函数的第二个参数

> $kernel = new AppKernel('dev', false);

那么你就可以

1.  输入错误的地址来测试 404 错误页面
2.  抛出任何异常以测试 500 错误页面

> 抛出新的 \Exception(); // 测试 500 错误页面

1.  扔

> 抛出新的 \Symfony\Component\HttpKernel\Exception\AccessDeniedHttpException();
> 或
> 抛出新的 \Symfony\Component\HttpKernel\Exception\HttpException(403); //测试403错误页面

# histogram - 大型数据集的词袋对象识别

> ID：11640374
> 
> 赞同：0
> 
> 时间：2012-07-24T22:45:49.370
> 
> 标签：histogram, object-recognition

我正在用词袋直方图实现对象识别。直方图由每张图像 200 个“单词”组成，kmeans 来自描述符。问题是对于一个大型数据集，比如 5000 张图像，我们突然在直方图中有 200x5000=1,000,000 个单词。这意味着每个对象都将由一个 1,000,000 长度的直方图表示。

这在某些时候变得太大而且太麻烦了。有什么办法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-28T04:01:05.837

通常，您选择的码本大小与训练图像的数量无关。您将通过在从所有训练数据中提取的一组描述符上运行 k-means（或其他一些字典学习方法）来构建码本。

因此，在您的示例中，如果您有 5000 个训练图像，并且从每个图像中提取了大约 1000 个描述符，那么您可以使用 k-means 对您进行聚类的 5,000,000 个描述符。

这可能非常耗时，因此您可以选择使用描述符的随机子集进行聚类。

# java - UDP Stop-and-Wait：识别虚假消息

> ID：11640385
> 
> 赞同：0
> 
> 时间：2012-07-24T22:46:45.377
> 
> 标签：java, security, authentication, udp

我目前正在构建一个快节奏的多人游戏，其中安全性是一个大问题。

我已经在 J​​ava 中通过 UDP 实现了停止等待（为简单起见，这是一种临时措施）。

但是，我担心恶意方可能会分别向发送者或接收者发送错误的确认或消息，从而使序列号不同步——本质上导致消息丢失（游戏崩溃！）或发送者重新发送无限期地。

在我的应用程序中，每个参与者都由 RSA 公钥标识，因此我可以为每条消息添加签名哈希以进行身份​​验证……但这大大增加了标头大小并在一定程度上混淆了我的架构层。

这是一种常见的方法吗？这个问题有众所周知的解决方案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T01:40:43.947

乔纳森所说的。一般来说，在使用 UDP 时，您需要提供自己的方法来防御乱序或丢包。没有一种“标准”的方式来处理这个问题——除了使用 TCP 来代替。正如您所说，您可以在每个数据包上验证客户端的身份 - 但请记住验证客户端的身份，即使使用 RSA 之类的东西 - 并不能帮助您对抗恶意客户端。他们可以连接到游戏服务器，验证自己，然后开始发送垃圾。毕竟，他们就是他们所说的那样。

对于大多数游戏服务器设计，据我（尽管有限）理解，通常服务器具有“tick”的概念——客户端可以注册某些事件在tick内发生，并且服务器针对客户端发送的内容执行规则. 但是当滴答结束时，服务器接收到的与该滴答相对应的任何事件都将被丢弃。这增加了一个竞争元素，它不会增加系统的实际安全性，但确实增加了一个使其更加困难的元素。

当然，使任何像这样“安全”的系统，因为客户端无法欺骗其来源，本质上需要做一个 TLS 隧道，我认为这不会满足您的性能要求。

# mysql - PG::Error: ERROR: invalid byte sequence for encoding "UTF8": 0xed2020 (Sequel::DatabaseError) while importing MySQL into PostgreSQL via Taps

> ID：11640387
> 
> 赞同：0
> 
> 时间：2012-07-24T22:46:52.573
> 
> 标签：mysql, ruby, database, postgresql, taps

我一直在尝试将我的 MySQL 迁移到 Postgres，并且从我发现的[水龙头](https://github.com/ricardochimal/taps/)gem。

不幸的是，它基本上在每个包含用户数据的表上都失败了，但存在某种异常

```
PG::Error: ERROR:  invalid byte  sequence for encoding "UTF8": 0xed2020 (Sequel::DatabaseError) 
```

每个表中的无效字符都不同，但例外是相同的。

**这不是其他`PG::Error: ERROR: invalid byte sequence for encoding`问题的重复，因为每个问题都提到了使用`Iconv.iconv("UTF8...", content)`来强制编码。但我不能这样做，因为我正在使用水龙头进行导入。**

*还有一个侧面说明，我试过做`mysqldump --compatible=postgres`，但是当我尝试将它导入回 Postgres 时，它在每个查询中都失败了。*

我正在使用 MySQL 5.1.63 和 PostgreSQL 9.1.4。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-16T09:36:54.143

看到这个问题：[https ://github.com/ricardochimal/taps/issues/110](https://github.com/ricardochimal/taps/issues/110)

在启动 taps 服务器时添加一个显式的 utf-8 编码设置应该会有所帮助：

```
taps server mysql://user:password@host/dbname?encoding=utf8 httpuser httpass 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-25T00:23:07.510

您可以尝试使用 SQL_ASCII 编码而不是 UTF8 创建 PostgreSQL 数据库，看看是否可以解决问题。

基本上，您的问题似乎是您的 MySQL 数据库中包含非 UTF8 编码的文本，并且您正在尝试将其导入使用 UTF8 编码的 PostgreSQL 数据库中。如果您真的想将 PostgreSQL 数据库保持为 UTF8 编码，则需要在尝试插入之前将您在 MySQL 中使用的任何编码转码为 UTF8。

假设问题出在数据库级别。如果问题出在 ruby​​ 级别，您可以尝试使用 ruby​​ 1.8（如果您使用的是 ruby​​ 1.9），看看是否会有所不同。

# android - 线程对象在完成后不会被垃圾收集

> ID：11640390
> 
> 赞同：10
> 
> 时间：2012-07-24T22:47:15.517
> 
> 标签：android, debugging, memory-leaks, garbage-collection, ddms

我注意到我的应用程序正在泄漏内存。这可以在 DDMS 中看到，我设法得到了 OutOfMemoryError。

我找到了泄漏的来源。其中一个活动有一个在后台运行的线程。该线程在`onDestroy()`. 它完成运行，如在 DDMS 中所见。

现在，如果线程启动，就会发生泄漏，Activity被销毁后不会被垃圾回收，因为它是被线程引用的。如果线程根本没有启动，一切都很好。

这是一个简单的例子来证明这一点：

```
public class MainActivity extends Activity {

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        getMenuInflater().inflate(R.menu.activity_main, menu);
        return true;
    }

    volatile boolean finished = false;
    byte[] memoryEater = new byte[4 * 1024 * 1024];

    Thread thread = new Thread(new Runnable() {

        @Override
        public void run() {
            while (!finished) {
                try {
                    Thread.sleep(100);
                } catch (InterruptedException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                }
            }
            Log.d(getClass().getName(), "Thread finished");
        }
    });

    @Override
    protected void onDestroy() {
        super.onDestroy();
        finished = true;
    }

    public void startActivity(View view) {
        startActivity(new Intent(this, MainActivity.class));
    }

    public void startThread(View view) {
        thread.start();
    }
} 
```

添加一个用于启动新活动的按钮和一个用于启动线程的按钮。开始新的活动。回去之后，只有在线程没有启动的情况下才会清理内存。

这种行为的原因是什么？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-10-10T06:38:34.593

我刚刚发现了同样的问题。

Tomasz，你在正确的轨道上。DDMS 中没有错误，您的程序中也没有内存泄漏。

真正的问题是你在调试模式下运行你的程序（在 Eclipse 下）。不知何故，当 Android 在调试模式下运行时，即使退出 run() 方法，线程也不会被垃圾收集。我想这可能是 Android 需要保留 Thread 才能使某些调试功能正常工作。

但是如果你在 RUN 模式下运行你的应用程序（仍然在 Eclipse 下），线程垃圾收集就会发生。线程将被完全释放，您的活动将被完全释放。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-27T06:25:40.430

我一直在调查，我的发现真的很令人惊讶。似乎没有真正的内存泄漏。仅当应用程序在 DDMS 中处于调试模式时才会发生。

DDMS 似乎以某种方式持有对那些完成的胎面的引用，从而防止它们被 GC 编辑。当我断开电话并再次连接时，我可以看到所有“泄漏”的资源都已释放。

它看起来像 DDMS 中的一个错误。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-24T22:55:25.227

线程使用的匿名可运行类将引用活动（“this”）。由于线程被活动引用，并且线程中的可运行对象引用了活动，GC 永远不会收集它们中的任何一个。

尝试做更多这样的事情：

```
private static RunnableClass implements Runnable
{
    @Override
    public void run() {
        while (!finished) {
            try {
                Thread.sleep(100);
            } catch (InterruptedException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
        }
        Log.d(getClass().getName(), "Thread finished");
    }
});

Thread thread = new Thread(new RunnableClass()); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-24T23:38:28.103

当按下“返回”或发送任何其他意图以将其从堆栈顶部删除时，活动不会被破坏。我认为在您的 Android 操作系统内存不足之前不会调用您覆盖的 onDestroy() 方法。从[文档](http://developer.android.com/guide/components/activities.html)中可以提取：

> 正如下面关于 Activity 生命周期的部分所讨论的，Android 系统会为您管理 Activity 的生命周期，因此您无需完成自己的 Activity。调用这些方法可能会对预期的用户体验产生不利影响，并且只应在您绝对不希望用户返回此活动实例时使用。

通常，每个 Activity 实例在初始创建后都在内存中，并经过`onStart()...onStop()`循环而不会被销毁。实现`onStop()`并调用`finish()`它`MainActivity`以释放要释放的线程并因此收集垃圾。

**更新**：上面的陈述不正确。根据问题中提供的代码，没有理由不应该对 Activity 进行 GC-ed。

# wcf - WCF 数据服务 5.0 + DbContext：如何返回相关实体？

> ID：11640393
> 
> 赞同：0
> 
> 时间：2012-07-24T22:47:51.103
> 
> 标签：wcf, entity-framework, entity-framework-4, wcf-data-services, odata

我正在使用带有 EF DbContext 的 WCF 数据服务 5.0。

我看到旧文章说您可以使用 Expand 和 LoadProperty 让 WCF 在一个请求中返回相关实体。

我在 DbContext 中看到的唯一等价物是 Include，但这似乎不起作用。

使用 DbContext 时，有没有办法加载所有相关记录？

我正在使用以下代码（一个 CategoryGroup 可以包含许多 Category 实体）：

```
[WebGet]
    public IQueryable<CategoryGroup> GetAllCategories(string activationCode)
    {
        try
        {
            var db = this.CurrentDataSource;

            var licence = db.Licenses
                .Include("Contact")
                .FirstOrDefault();

            if (licence != null)
            {
                var customerId = licence.Contact.CustomerId;

                return db.CategoryGroups.Include("Categories").Where(r => r.CustomerId == customerId);
            }
        }
        catch(Exception ex)
        {

        }

        return new List<CategoryGroup>().AsQueryable();
    } 
```

此函数仅返回 OData 格式的 CategoryGroup 实体（没有相关的 Category 实体）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T09:58:05.290

目前 WCF DS 服务器无法自动扩展。因此，在上面的代码中包含 Include 对服务操作的响应没有影响。扩展只能由客户端通过 $expand 查询选项来请求。

# ruby - Aptana Studio 3 嵌入式终端使用错误版本的 ruby

> ID：11640397
> 
> 赞同：0
> 
> 时间：2012-07-24T22:48:14.890
> 
> 标签：ruby, terminal, version, aptana

我刚刚在 Windows 7 上安装了带有 pik 的 ruby​​ 1.9.3。

当我在 cmd 提示符下运行 ruby​​ -v 时，我按预期返回了 ruby​​ 版本 1.9.3。但是当我在 Aptana Studio 3 的嵌入式终端中运行 ruby​​ -v 时，我得到了 1.9.2。

**如何让嵌入式终端使用 ruby​​ 1.9.3？**

我认为这与它是 cygwin 或类似的东西有关，因为它可以运行 curl 而其他命令 cmd.exe 不能。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-18T11:36:31.117

您必须单独更新终端。因为它不同于窗户。使用 Linux 命令在 aptana 中更新您的终端。

# c# - 如何将在代码后面创建的控件放置在页面上？

> ID：11640399
> 
> 赞同：1
> 
> 时间：2012-07-24T22:48:21.557
> 
> 标签：c#, asp.net

```
protected void Page_Load(object sender, EventArgs e)
{

Label myLabel = new Label();
myLabel.Text = "Testing 1 2 3";
} 
```

如果我在后面的代码中创建了这个 Label 对象，并且它在主页上没有 < asp:Label > 标签，我怎样才能把这个 Label 放在页面上的某个地方？

我想根据数据库中的信息动态创建控件。从那里，我想将控件放在网页上。我无法为它们预定义位置，因为控件的数量和类型会发生变化。

最好的方法是什么？

如果我的页面上已经有一些东西，例如表格，并且我想将控件放置在表格的末尾之后怎么办。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-24T22:49:38.750

您必须将它添加到页面的某个地方的控件集合中。

```
this.Controls.Add(myLabel); 
```

我不会将其直接添加到页面中，而是使用`PlaceHolders`or`Panels`作为容器控件。`page_load`您需要最迟在每次回发时使用与以前相同的 ID 重新创建动态创建的控件（以重新加载 ViewState 和触发事件）。

您应该使用 CSS 来控制控件的布局。

另一种方法是使用[Web 数据绑定控件](http://msdn.microsoft.com/en-us/library/ms228214.aspx)，这样`Repeater`更容易并自动维护控件及其状态。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T23:17:02.363

如果您使用占位符，则可以根据需要向其中添加任意数量的控件。如果为每个控件分配 CSS，则可以轻松地将控件放置在页面上所需的任何位置。

```
Label myLabel = new Label();
myLabel.Text = "Testing 1 2 3";
myLabel.cssClass ="myClass1"
Label myLabel2 = new Label();
myLabel2.Text = "Testing 4 5 6";
myLabel2.cssClass ="myClass2"
plHolder.controls.add(myLabel)
plHolder.controls.add(myLabel2) 
```

# ruby-on-rails - 给定我的应用程序中的 URL，我如何通过我的 Routes 运行它并检查它的控制器？

> ID：11640401
> 
> 赞同：0
> 
> 时间：2012-07-24T22:48:29.637
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.2

我**不是**想看看当前的控制器是什么。有问题的 URL 代表*先前*的请求。

例如：输入`/foo/6`

输出：（显示控制器的哈希`FooController`，操作`show`，id `6`）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T22:51:18.293

看[`recognize_path`](http://apidock.com/rails/ActionDispatch/Routing/RouteSet/recognize_path)

```
Rails.application.routes.recognize_path('/foo/6') 
```

输出：

```
{:action=>"show", :controller="foo", :id="6"} 
```

# charts - Highstock - 比较图表并非从 0% 开始

> ID：11640405
> 
> 赞同：1
> 
> 时间：2012-07-24T22:48:52.833
> 
> 标签：charts, comparison, highstock

我正在尝试使用 HighStock 比较图 ( [http://www.highcharts.com/stock/demo/compare](http://www.highcharts.com/stock/demo/compare) ) 创建性能图表。y 轴是一个百分比值，图表上的第一个点应始终从 0% 开始。我遇到问题的部分是图表看起来总是在第二个日期从 0% 开始。

这是我正在使用的示例。[http://jsfiddle.net/hPC4x/](http://jsfiddle.net/hPC4x/) 我看到两个问题 1) 图表上的第一个数据点超出了默认 1y 范围的日期范围。范围是 2011 年 7 月 23 日 - 2012 年 7 月 23 日，但图表上的第一个数据点从 2011 年 7 月 22 日开始。2) 2011 年 7 月 22 日图表的开始是负值。图表应从 0% 开始。

我不明白为什么首先会显示一个过时的范围点。我要解决的主要问题是让图表从 0% 开始。我想如果我可以让图表只在日期范围内显示，那么我可能就能解决这个问题。

有没有人遇到过这个问题？有什么建议么？

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T07:22:31.353

> 1) 图表上的第一个数据点超出了默认 1y 范围的日期范围。范围是 2011 年 7 月 23 日 - 2012 年 7 月 23 日，但图表上的第一个数据点从 2011 年 7 月 22 日开始

日期范围之外的数据是已知问题。我不知道他们是否仍然归类为错误。

我已经在 Highstock 官方论坛上发布了这个问题。

这是供您参考的[链接。](http://highslide.com/forum/viewtopic.php?f=12&t=18261)

> 2) 2011 年 7 月 22 日的图表开始为负值。图表应从 0% 开始。

我不知道，但它应该与第一个有关。

# twitter-bootstrap - 如何单独使用 Twitter Bootstrap 组件和插件？

> ID：11640408
> 
> 赞同：0
> 
> 时间：2012-07-24T22:49:15.670
> 
> 标签：twitter-bootstrap

是否可以在不是使用 Twitter Bootstrap 构建但使用 jQuery 的应用程序中使用 Twitter Bootstrap 的*片段*（例如，*只是工具提示和垂直选项卡）？*还是您必须包含/使用整个框架？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-24T22:52:01.350

您可以自定义 Bootstrap 以仅使用您需要的内容。

因此，您可以通过选择所需的组件和 jQuery 插件来构建自己的 Bootstrap。

然后，您将获得 Bootstrap 的一部分，而不是完整的存储库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-10-26T14:53:49.330

您可以通过引用各自的`*.js`文件来单独使用 Boostrap JavaScript 插件（工具提示、模式等）。但是，请注意某些插件和 CSS 组件依赖于其他插件。如果您单独包含插件，请确保在文档中检查这些依赖项。

为此，您必须使用 npm 或从 bootrap 网站下载 boostrap 的完整源文件夹。

# vba - 哪种方式更快？if elseif 或 select case

> ID：11640413
> 
> 赞同：10
> 
> 时间：2012-07-24T22:49:26.967
> 
> 标签：vba, excel

对于以下代码，

```
If Sheets("sheet1").Range("A1").Value = "option_1" Then
    Sheets("sheet1").Range("A1").Value = "option_2"
ElseIf Sheets("sheet1").Range("A1").Value = "option_2" Then
    Sheets("sheet1").Range("A1").Value = "option_3"
ElseIf Sheets("sheet1").Range("A1").Value = "option_3" Then
    Sheets("sheet1").Range("A1").Value = "option_4"
...
End IF 
```

和

```
Select Case Sheets("sheet1").Range("A1").Value
    Case Is = "option_1"
        Sheets("sheet1").Range("A1").Value = "option_2"
    Case Is = "option_2"
        Sheets("sheet1").Range("A1").Value = "option_3"
    Case Is = "option_3"
        Sheets("sheet1").Range("A1").Value = "option_4"
    ...
End Select 
```

问题：

1）我想知道哪种方式会更快。如果可能的话，可以解释技术细节吗？

2）无论效率如何，在这种情况下我应该使用哪种方法，以获得更好的编码。

3）从数组中圈出值的任何其他“简单”方法？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-07-24T22:58:27.917

1.  Case 语句应该最小化处理器尝试更改其命令位置的次数。这样做会导致它浪费时钟周期，直到引用正确的命令。除非您正在编写需要极度优化的东西，否则您不会注意到其中的差异。
2.  我倾向于案例陈述，因为它们更容易阅读。（少读=>更容易阅读）
3.  如果这是您使用的确切数据，您可以拆分“_”上的值并将最后一位“mod”增加为可能的最高值。将字符串重新组合在一起以获得结果。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-24T22:53:50.133

For just a few items, it doesn't matter. For larger arrays, use switch. [More of the technical details here.](https://stackoverflow.com/questions/767821/is-else-if-faster-than-switch-case)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-11-02T08:12:33.773

正如 Bazinga 所说，对于一些项目，这并不重要。无论如何，在这种情况下，您应该添加 With...end With 语句：

```
With Sheets("sheet1").Range("A1")
If .Value = "option_1" Then
 .Value = "option_2"
ElseIf .Value = "option_2" Then
 .Value = "option_3"
ElseIf .Value = "option_3" Then
 .Value = "option_4"
...
End If
End With 
```

这应该更快，更具可读性。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2019-09-15T22:24:59.147

我使用简单的“for loop”和“mod”函数运行了多个场景，将“IF”语句与“Case”语句进行了比较。检查的记录数和条件数（# of ifElse/# of case）不同。下表显示了场景和每个场景的结果。请注意，表中提到的速度是 100 次运行的平均值。

我们可以看到“IF”语句和“Case”语句在性能上几乎相似。“IF”语句略优于“Case”语句（快约 5%）。

[![在此处输入图像描述](../Images/0aa599678f775ac067bba0505c88ad58.png)](https://i.stack.imgur.com/UDbCG.png)

Excel 版本：Office 365 版本 1908 build 11929.20300

使用的处理器：英特尔 i9-9900K

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-10-25T16:25:21.217

有点太晚了，但在具体的例子中，最快的应该是将选项存储为一个数字，并在需要时增加它。可以将单元格的自定义数字格式更改`"option_"0;;;`为将数字显示为 option_#。

在几乎所有情况下，我都希望它`Select Case`稍微慢一点，并编译成与 If Else 语句非常相似的东西。

这两个示例中的情况并非如此，因为它们做的事情略有不同。在第一个示例中，每个 If 语句都将查找工作表“sheet1”并获取范围“A1”的值，但该`Select Case`示例在开始时仅获取该值一次，然后比较该值。`Select Case`当单元格值不是“option_1”时，这应该会导致示例快几倍。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-01-09T04:41:22.837

而不是必须输入所有的可能性，为什么不这样做呢。（假设下一项总是1加最后一项）

```
Public Sub Test()
    With ThisWorkbook.Worksheets("Sheet1").Range("A1")
        .Value = "option_" & Val(Mid(.Value, InStrRev(.Value, "_") + 1)) + 1
    End With
End Sub 
```

这更可靠、更高效，并且会变得无穷无尽，而无需无穷无尽的代码行。

# microsoft-commerce-server - 如何创建加密密钥

> ID：11640414
> 
> 赞同：0
> 
> 时间：2012-07-24T22:49:28.697
> 
> 标签：microsoft-commerce-server

我遵循了 Commerce Server 2009 R2 三层安装的所有步骤。

一切都很好，Commerce 服务器运行良好，所有 .wsp 都已成功部署并创建了 Web 应用程序。我正在使用自行创建的证书。

但是，当我尝试浏览该站点时，会出现这样的错误（Sharepoint Log Viewer）：

```
Name=Request (GET:http://wfe1:8000/)

System.Configuration.ConfigurationErrorsException: The encryption key for secureCookieEncryptionKey is required.
 at Microsoft.Commerce.Server.CommerceUserRecognition.Initialize()
 at Microsoft.Commerce.Server.CommerceUserRecognition.GetAnonymousUserId()
 at Microsoft.Commerce.Server.CommerceUserRecognitionModule.GetAnonymousUserId()
 at Microsoft.Commerce.Server.CommerceUserRecognitionModule.OnPostAuthenticateRequest()
 at System.Web.HttpApplication.SyncEventExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute()
 at System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously)

Site=/

Unknown SPRequest error occurred. More information: 0x80070005

Leaving Monitored Scope (Request (GET:http://wfe1:8000/)). Execution Time=20.6327200803454 
```

如何创建加密密钥？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T16:38:16.673

看起来这在 msdn 社交 [http://social.msdn.microsoft.com/Forums/en-US/commserver2009/thread/c62cf52a-b52f-4eda-9c9c-e4e99321d6fb/上得到了回答](http://social.msdn.microsoft.com/Forums/en-US/commserver2009/thread/c62cf52a-b52f-4eda-9c9c-e4e99321d6fb/)

# r - 使用 R 生成具有 iid 正态随机变量的矩阵

> ID：11640415
> 
> 赞同：21
> 
> 时间：2012-07-24T22:33:56.373
> 
> 标签：r, random, normal-distribution

有没有办法在不使用循环的情况下在 R 中生成具有正态分布随机值的数据集？每个条目将代表一个具有正态分布的独立随机变量。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-07-24T23:23:21.293

要创建iid 正态随机变量`N`的矩阵，请键入：`M`

```
matrix( rnorm(N*M,mean=0,sd=1), N, M) 
```

根据需要调整平均值和标准差。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-24T22:57:42.863

让我们`mu`成为均值`sigma`向量和标准开发者向量

```
mu<-1:10
sigma<-10:1
sample.size<-100
norm.mat<-mapply(function(x,y){rnorm(x,y,n=sample.size)},x=mu,y=sigma) 
```

将产生一个矩阵，其中包含相关样本的列

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-05-11T18:58:44.753

您可以使用：

```
replicate(NumbOfColumns,rnorm(NumbOfLines)) 
```

You can replace `rnorm` with other distribution function, for example `runif`, to generate matrices with other distributions.

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2013-04-11T18:43:54.390

注意：每个条目都是独立的。所以你不能避免使用 for 循环，因为你必须为每个自变量调用一次 rnorm。如果你只是调用 rnorm(n*m) 那就是来自同一个随机变量的 n*m 个样本！

# ruby-on-rails - Rspec - 测试 rails_admin 自定义

> ID：11640419
> 
> 赞同：1
> 
> 时间：2012-07-24T22:49:46.690
> 
> 标签：ruby-on-rails, rspec, rails-admin

我在我的应用程序上安装了功能性和自定义的 Rails 管理员，为了确保一切正常，我想为它做一些测试

我正在尝试完成这样的事情

```
require 'spec_helper'

describe RailsAdmin::MainController do
  render_views

  let(:admin) { FactoryGirl.create(:admin_user) }

  describe "should manage a dashboard" do

    before :each do
      sign_in admin
    end

    it "should render dashboard" do
      get :dashboard
      response.should be_success
    end
  end
end 
```

这是工作时间，但突然每次运行规范我都会收到此错误

```
Failure/Error: get :dashboard
  ActionController::RoutingError:
    No route matches {:controller=>"rails_admin/main", :action=>"dashboard"} 
```

这是我的规范助手的副本 [https://gist.github.com/3173172](https://gist.github.com/3173172)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-29T18:14:04.250

我相信在控制器规范中测试这些东西（实际上是控制器的单元测试）是一个坏主意。请求规范将是一个更好的地方。

您可以查看我的示例项目：[https](https://github.com/lucassus/locomotive/blob/master/spec/requests/admin/manage_users_spec.rb) ://github.com/lucassus/locomotive/blob/master/spec/requests/admin/manage_users_spec.rb在这里您有 active_admin 用户部分自定义的示例请求规范。

# c++ - 在模板化类型的 CRTP 中定义类型

> ID：11640427
> 
> 赞同：1
> 
> 时间：2012-07-24T22:50:44.597
> 
> 标签：c++, templates, crtp

我正在尝试创建一个 CRTP 类，其中包含一个未定义的类 --- 由派生类定义，如下所示：

```
#include <memory> // unique_ptr

template<typename T>
class crtp
{
    public:
        class inside;

        crtp();

        std::unique_ptr<inside> m;
}; 
```

这适用于非模板数据类型。

但是，如果我尝试将模板类传递给它，例如：

```
template<>
template<typename T>
class crtp<test::TestClass<T>>::inside
{
    public:
        inside()
        {
            std::cout << "Instantiated." << std::endl;
        }
}; 
```

它给出了以下错误：

```
error: invalid class name in declaration of ‘class crtp<test::TestClass<T> >::inside’ 
```

我正在使用 gcc 4.6.1。

我在这里想念什么？我觉得这与模板的实例化方式有关，但我不确定我应该寻找什么。

编辑：澄清一下，像crtp的构造函数之类的东西已经在别处定义了（我应该发布它吗？它只是初始化unique_ptr）。我唯一需要专门化的是内部类的定义。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T23:11:22.167

您不能部分特化外部模板来定义嵌套类；只允许完全专业化（例如`template <> class crtp<int>::inside`）。相反，您可以提供整个模板的部分特化：

```
template <typename T>
class crtp<test::TestClass<T>>
{
public:
    class inside { /* ... */ };
    // ...
}; 
```

# objective-c - cellForRowAtIndexPath 在模型还是视图中？

> ID：11640431
> 
> 赞同：1
> 
> 时间：2012-07-24T22:51:07.180
> 
> 标签：objective-c, uitableview, model

我想符合模式 MVC，我问我，“cellForRowAtIndexPath”方法必须去哪里：/因为目前，这个方法在控制器文件中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T23:15:07.497

你问它是否应该在模型（M）或控制器（C）中，我假设。这是一个有趣的问题，因为 UITableView 有两个协议：

```
UITableViewDelegate
UITableViewDataSource 
```

好吧，UITableViewDelegate 协议适用于视图的“所有者”，通常是控制器——我没有看到任何其他假设的代码。

那么 UITableViewDataSource 应该放在哪里呢？这是定义的协议

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath 
```

现在，如果 Apple 开发人员认为它会进入 Controller，为什么不直接将其合并到 UITableViewDelegate 协议中呢？文档是这样说的（用我的粗体字）：

> UITableViewDataSource 协议被**一个对象采用，该对象为 UITableView 对象调解应用程序的数据模型**。数据源为表视图对象提供构造和修改表视图所需的信息。
> 
> 作为数据模型的代表，数据源提供了关于表格视图外观的最少信息。表视图对象的委托——一个采用 UITableViewDelegate 协议的对象——提供了该信息。

所以这似乎表明它应该位于模型中 - 但实际上通过说“调解应用程序的数据模型”意味着它应该位于控制器中 - 但可能不是实际管理`UITableView`（通过`UITableViewDelegate`协议）的同一个控制器。在我看来，您可以灵活地以几种不同的方式进行布局 - 但是一般的结论是，在我见过的 99% 的代码中，它位于也是`UITableViewDelegate`委托的 Controller 中。

这是关于 MVC 的一些 Apple 文档：http: [//developer.apple.com/library/mac/documentation/General/Conceptual/CocoaEncyclopedia/Model-View-Controller/Model-View-Controller.html#//apple_ref/doc/uid /TP40010810-CH14-SW9](http://developer.apple.com/library/mac/documentation/General/Conceptual/CocoaEncyclopedia/Model-View-Controller/Model-View-Controller.html#//apple_ref/doc/uid/TP40010810-CH14-SW9)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T23:03:57.383

控制器对象（MVC 中的 C）的目标是协调模型对象和视图对象。因此，cellForRowAtIndexPath 方法的性质，它用数据（来自模型）填充给定的单元格（这是一个视图）决定它属于控制器。

这种方法在 Apple 与 UITableViews 和 UITableViewControllers 相关的所有示例代码中都得到了演示。

# mongodb - MongoDB Shell：“$or”查询和解释错误（）

> ID：11640432
> 
> 赞同：3
> 
> 时间：2012-07-24T22:51:11.987
> 
> 标签：mongodb, mongodb-shell

我正在尝试对 MongoDB "$or" 查询进行一些分析，但在 Mongo shell 中使用 'explain()' 命令时遇到问题。当我使用 find 命令运行查询时，它按预期工作并返回一条记录。但是，当我在 find() 末尾添加“explain()”时，出现以下错误：

> 未捕获的异常：错误：{“$err”：“无效运算符：$or”，“code”：10068}

我正在尝试以下查询：

```
db.people.find({"query" : 
                   {"$or" : [ 
                       {"site" : "mysite", "site_id" : "587125722"}, 
                       {"user_id" : ObjectId("4fb811aae4b0b628b485a58d")}
                   ]}, 
                "$orderby" : { "global_id" : 1, "user_id" : 1}
                }) 
```

如果我将“$or”更改为“or”，explain() 工作正常，但查询返回 0 个结果。我的印象是，无论有无解释（），它们的语法都应该相同，那么我做错了什么？我使用的是 2.0.4 版。感谢任何能够提供帮助的人。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-25T01:47:16.187

关键字“query”在内部用于打包“query”（请求服务器进行搜索）的“query”（搜索内容的规范）部分，以使其在发送到的 BSON 文档中保持不同。服务器，但 shell 帮助程序（例如 .explain）强制此“打包”发生在您指定的任何内容上。通过将其包裹在“查询”本身中，您将丢失所需的查询（在其中直接使用“查询”）。

马特的回答通过解开您的预先包装的请求来避免这种情况，并且是这样做的正常方式......只需在马特的重写末尾添加“.explain（）”，它应该可以按预期工作。

如果你想保持你的格式，你可以像使用“$orderby”而不是“.sort”一样将“$explain:true”添加到文档中。

```
db.people.find({"query" : 
                   {"$or" : [ 
                       {"site" : "mysite", "site_id" : "587125722"}, 
                       {"user_id" : ObjectId("4fb811aae4b0b628b485a58d")}
                   ]}, 
                "$orderby" : { "global_id" : 1, "user_id" : 1},
                "$explain" : true
                }) 
```

查看 shell 助手“.explain”的 JavaScript 代码以了解它的作用：

```
> db.foo.find().explain
function (verbose) {
    var n = this.clone();
    n._ensureSpecial();
    n._query.$explain = true;
    n._limit = Math.abs(n._limit) * -1;
    var e = n.next();

    function cleanup(obj) {
        if (typeof obj != "object") {
            return;
        }
        delete obj.allPlans;
        delete obj.oldPlan;
        if (typeof obj.length == "number") {
            for (var i = 0; i < obj.length; i++) {
                cleanup(obj[i]);
            }
        }
        if (obj.shards) {
            for (var key in obj.shards) {
                cleanup(obj.shards[key]);
            }
        }
        if (obj.clauses) {
            cleanup(obj.clauses);
        }
    }

    if (!verbose) {
        cleanup(e);
    }
    return e;
}
> db.foo.find()._ensureSpecial
function () {
    if (this._special) {
        return;
    }
    var n = {query:this._query};
    this._query = n;
    this._special = true;
}
> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T22:59:54.397

你可能混淆了`runCommand()`和`find()`。尝试这个：

```
db.people.find( { "$or" : [ { site : "mysite", site_id : "587125722" }, 
                            { user_id : ObjectId("4fb811aae4b0b628b485a58d") } ] }
              ).sort( { global_id : 1, user_id : 1 } ) 
```

# mysql - 表之间的多个连接

> ID：11640434
> 
> 赞同：0
> 
> 时间：2012-07-24T22:51:14.817
> 
> 标签：mysql, sql, database-design, join

我有以下表格，每个表格都有多条记录（~50k）并且表格正在增长。

```
Table1
BatchID ID Record1

Table 2 
BatchID ID Record2

Table 3
BatchID ID Record3

Table 4 
BatchID ID Record4 
```

以下查询需要永远运行（因为连接是四个表的笛卡尔积）。

```
Select table1.batchid,
table1.ID,
table1.Record1, 
table2.Record2,
Table3.Record3, 
Table4.Record4 
from Table1 JOIN Table 2
on table1.batchID = table2.batchID and table1.ID = table2.ID
JOIN table3 
on table1.BatchID=table3.batchID and table1.ID = table3.ID 
JOIN table4 
on table1.ID = table4.ID and table1.batchID = table4.batchID 
```

什么应该是最好的方法来做到这一点。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T22:56:26.627

您应该为`ON`子句中使用的两列添加索引。例如：

```
ALTER TABLE `table2` ADD INDEX `IDX_batchid-ID` (`batchid`, `ID`); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-24T22:56:35.310

第一个想法是您希望在所有四个表上的 (batchid, id) 上都有一个复合索引。这将最匹配查询中的连接条件。

表中有多少条记录相互匹配，具有相同的 batchid 和 id？可能有其他方式来表达查询。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-25T10:07:35.730

你真的*需要*所有这些 JOIN 吗？你不能把这四个表合并在一起吗？

例如：

```
CREATE TABLE MergedTable (
    BatchID INT,
    ID INT,
    Record1 ... ,
    Record2 ... ,
    Record3 ... ,
    Record4 ... ,
    PRIMARY KEY (BatchID, ID)
) 
```

接着：

```
INSERT INTO MergedTable <your query> 
```

您现在可以直接从 MergedTable 中选择，而无需任何 JOIN。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-24T22:59:31.520

您的加入看起来不错。尝试在 BatchID 和 ID 的组合上创建索引。

[开发者.mysql.com](http://dev.mysql.com/doc/refman/5.0/en/multiple-column-indexes.html)

# ruby-on-rails - 配置 ckeditor - config/application.rb

> ID：11640440
> 
> 赞同：0
> 
> 时间：2012-07-24T22:51:48.463
> 
> 标签：ruby-on-rails, ckeditor

当我添加行

```
config.autoload_paths += %W(#{config.root}/app/models/ckeditor) 
```

到`config/application.rb`（就像在[cdkeditor gem ruby​​doc](http://rubydoc.info/gems/ckeditor/3.7.1/frames)的描述中一样），当我尝试启动 rails 服务器时出现此错误：

```
> $ rails s
> /home/bhamster/Arbeitsfläche/ruby/ContentManagement/ContentManagement/config/application.rb:5:in
>
> `<top (required)>': undefined local variable or method `config' for
> main:Object (NameError)   from
>
> /home/bhamster/.rvm/gems/ruby-1.9.3-p194/gems/railties-3.2.6/lib/rails/commands.rb:53:in
> `require'   from
>
> /home/bhamster/.rvm/gems/ruby-1.9.3-p194/gems/railties-3.2.6/lib/rails/commands.rb:53:in
> `block in <top (required)>'   from
>
> /home/bhamster/.rvm/gems/ruby-1.9.3-p194/gems/railties-3.2.6/lib/rails/commands.rb:50:in
> `tap'   from
>
> /home/bhamster/.rvm/gems/ruby-1.9.3-p194/gems/railties-3.2.6/lib/rails/commands.rb:50:in
> `<top (required)>'  from script/rails:6:in `require'  from
>
> script/rails:6:in `<main>' 
```

在另一个项目中它工作得很好！找不到任何区别。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T03:53:36.120

```
config.autoload_paths += %W(#{config.root}/app/models/ckeditor) 
```

不会进入`Line 5`您的（您在*[http://pastebin.com/78b9Q2RR](http://pastebin.com/78b9Q2RR)*`config/application.rb` *中提到过）*。将上面的行移动到类**内**的任何位置`ContentManagement::Application`：

```
module ContentManagement
  class Application < Rails::Application
    config.autoload_paths += %W(#{config.root}/app/models/ckeditor)

    # the rest of your config
  end
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T22:55:43.053

尝试这个：

```
config.autoload_paths += "#{Rails.root}/app/models/ckeditor" 
```

而不是您发布的行并重新启动服务器，....

您在错误的位置添加了该行，.. 尝试这样将行放入`Application < Rails::Application`类中：

```
require File.expand_path('../boot', __FILE__)

    require 'rails/all'

    if defined?(Bundler)
      # If you precompile assets before deploying to production, use this line
      Bundler.require(*Rails.groups(:assets => %w(development test)))
      # If you want your assets lazily compiled in production, use this line
      # Bundler.require(:default, :assets, Rails.env)
    end

    module ContentManagement
      class Application < Rails::Application
        config.autoload_paths += %W(#{config.root}/app/models/ckeditor)

        # Settings in config/environments/* take precedence over those specified here.
        # Application configuration should go into files in config/initializers
        # -- all .rb files in that directory are automatically loaded.

        # Custom directories with classes and modules you want to be autoloadable.
        # config.autoload_paths += %W(#{config.root}/extras)

        # Only load the plugins named here, in the order given (default is alphabetical).
        # :all can be used as a placeholder for all plugins not explicitly named.
        # config.plugins = [ :exception_notification, :ssl_requirement, :all ]

        # Activate observers that should always be running.
        # config.active_record.observers = :cacher, :garbage_collector, :forum_observer

        # Set Time.zone default to the specified zone and make Active Record auto-convert to this zone.
        # Run "rake -D time" for a list of tasks for finding time zone names. Default is UTC.
        # config.time_zone = 'Central Time (US & Canada)'

        # The default locale is :en and all translations from config/locales/*.rb,yml are auto loaded.
        # config.i18n.load_path += Dir[Rails.root.join('my', 'locales', '*.{rb,yml}').to_s]
        # config.i18n.default_locale = :de

        # Configure the default encoding used in templates for Ruby 1.9.
        config.encoding = "utf-8"

        # Configure sensitive parameters which will be filtered from the log file.
        config.filter_parameters += [:password]

        # Enable escaping HTML in JSON.
        config.active_support.escape_html_entities_in_json = true

        # Use SQL instead of Active Record's schema dumper when creating the database.
        # This is necessary if your schema can't be completely dumped by the schema dumper,
        # like if you have constraints or database-specific column types
        # config.active_record.schema_format = :sql

        # Enforce whitelist mode for mass assignment.
        # This will create an empty whitelist of attributes available for mass-assignment for all models
        # in your app. As such, your models will need to explicitly whitelist or blacklist accessible
        # parameters by using an attr_accessible or attr_protected declaration.
        config.active_record.whitelist_attributes = true

        # Enable the asset pipeline
        config.assets.enabled = true

        # Version of your assets, change this if you want to expire all your assets
        config.assets.version = '1.0'
      end
    end 
```

# php - 使用 preg_replace 清理小部件输出 HTML

> ID：11640441
> 
> 赞同：3
> 
> 时间：2012-07-24T22:51:49.260
> 
> 标签：php, wordpress, preg-replace

我正在开发一个使用插件/侧边栏小部件的 wordpress 网站。我遇到的问题是小部件生成的 HTML 无效，下面是一个示例...

```
<p>
<div>I am item 1</div>
<div>I am item 2</div>
<div>I am item 3</div>
<div>I am item 4</div>
<p></p> 
```

据我了解，这段代码有两个问题，第一个是它在段落中使用了 div（块级元素）。第二个是最后没有关闭的额外 P 标签。

我已经与小部件开发人员进行了交谈，尽管它是一个昂贵且付费的插件，但并不急于解决这个问题。

我将尝试使用 preg_replace 来清理代码，我想知道是否有人有任何示例或教程来执行此操作并仅针对小部件容器中的代码？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T23:02:48.697

首先，当我看到您的数据（项目列表）时，我认为 `<ul> <li>`会更好：

```
<ul>
<li>I am item 1</li>
<li>I am item 2</li>
<li>I am item 3</li>
<li>I am item 4</li>
</ul> 
```

对于您的 preg_replace，如果您简单地使用 str_replace （更便宜），它会更好

```
str_replace(array("<div>","</div>","<p>","</p>"), array("<li>","</li>","<ul>","</ul>"),$yourHtml) 
```

然后你删除空的`<p></p>`（现在`<ul></ul>`）`str_replace("<ul></ul>", "",$yourHtml)`

但更好的解决方案是自己编辑插件并定义不同的输出！

* * *

[不过，另一个“更好”的解决方案是使用preg_match_all](http://www.php.net/manual/fr/function.preg-match-all.php)获取数组中的所有项目。

例子：

```
$html="<p>
<div>my item 1</div>
<div>my item 2</div>
<div>my item 3</div>
<p></p>";

preg_match_all("#<div>(.*)</div>#",$html,$matchs);

var_dump($matchs[1]);
//var_dump output : array(3) { [0]=> string(9) "my item 1" [1]=> string(9) "my item 2" [2]=> string(9) "my item 3" } 
```

如果您没有（我`<div>`的意思是 : ）此代码可以正常工作。`<div>``<div> my <div>item 1</div></div>`

通过这种方式，您可以将所有数据放在一个数组中，并且它们更易于操作。我不知道你的 php 学位，但只是执行一个 foreach 循环

```
 foreach($matchs[1] as $v){
      //$v is one item
   } 
```

# php - 正则表达式的可变长度lookbehind-assertion替代方案

> ID：11640447
> 
> 赞同：49
> 
> 时间：2012-07-24T22:52:34.817
> 
> 标签：php, javascript, python, regex, perl

Python/PHP/JavaScript 中是否有正则表达式的实现支持可变长度的lookbehind-assertion？

```
/(?<!foo.*)bar/ 
```

如何编写具有相同含义但不使用后向断言的正则表达式？

这种类型的断言是否有可能在某一天实现？

事情比我想象的要好得多。

**更新：**

(1) 已经有支持变长lookbehind-assertion的正则表达式实现。

Python 模块[正则表达式](http://pypi.python.org/pypi/regex)（不是标准`re`的，而是附加`regex`模块）支持这样的断言（并具有许多其他很酷的特性）。

```
>>> import regex
>>> m = regex.search('(?<!foo.*)bar', 'f00bar')
>>> print m.group()
bar
>>> m = regex.search('(?<!foo.*)bar', 'foobar')
>>> print m
None 
```

正则表达式中有一些东西是 Perl 做不到而 Python 可以做到的，这对我来说是一个非常大的惊喜。也许，Perl 也有“增强的正则表达式”实现？

（感谢并 +1 给 MRAB）。

(2) 现代正则表达式有一个很酷的特性`\K`。

这个符号意味着当你进行替换时（从我的角度来看，断言最有趣的用例是替换），之前找到的所有字符都`\K`不能更改。

```
s/unchanged-part\Kchanged-part/new-part/x 
```

这几乎就像一个后视断言，但当然不是那么灵活。

更多关于`\K`：

*   [Perl 正则表达式 \K 技巧](http://www.cybersprocket.com/perl-regular-expression-k-trick/)
*   [PCRE 正则表达式聚焦：\K](http://www.phpfreaks.com/blog/pcre-regex-spotlight-k)

据我了解，您不能在同一个正则表达式中使用 \K 两次。而且你不能说你想“杀死”你找到的角色。那总是直到行的开头。

（感谢并 +1 ikegami）。

我的其他问题：

*   有没有可能说哪一点一定是最终的`\K`效果点？
*   Perl/Ruby/JavaScript/PHP 的增强正则表达式实现怎么样？类似于`regex`Python 的东西。

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2012-07-24T22:57:50.290

大多数情况下，您可以通过使用`\K`.

```
s/(?<=foo.*)bar/moo/s; 
```

将会

```
s/foo.*\Kbar/moo/s; 
```

直到最后`\K`遇到的任何东西都不会被视为匹配的一部分（例如，出于替换的目的`$&`，等等）

负面的lookbehinds有点棘手。

```
s/(?<!foo.*)bar/moo/s; 
```

将会

```
s/^(?:(?!foo).)*\Kbar/moo/s; 
```

因为`(?:(?!STRING).)*`是`STRING`那样。`[^CHAR]*`_`CHAR`

* * *

如果你只是匹配，你甚至可能不需要`\K`.

```
/foo.*bar/s

/^(?:(?!foo).)*bar/s 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-07-25T00:21:31.403

对于 Python，有一个支持可变长度后视的正则表达式实现：

[http://pypi.python.org/pypi/regex](http://pypi.python.org/pypi/regex)

它被设计为与标准 re 模块向后兼容。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-07-24T23:44:47.763

您可以反转字符串和模式并使用可变长度前瞻

`(rab(?!\w*oof)\w*)`

粗体匹配：

> raboof rab7790oof **raboo** **rabo** **rab** **rabo** raboooof **rabo**

据我所知的原始解决方案：

> Jeff 'japhy' Pinyan

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-24T23:03:26.417

您显示的正则表达式将找到其`bar`前面没有的*任何*`foo`实例。

一个简单的替代方法是首先匹配`foo`字符串，然后找到第一次出现的索引。然后搜索`bar`，看看是否可以找到该索引*之前的事件。*

如果您想查找`bar`不*直接*以开头的实例，我还可以为此提供一个正则表达式（不使用lookbehind `foo`），但这会非常难看。基本上，颠倒`/foo/`- 即`/[^f]oo|[^o]o|[^o]|$/`。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-01-19T04:18:35.440

```
foo.*|(bar) 
```

如果`foo`首先在字符串中，则正则表达式将匹配，但不会有组。

否则，它将找到`bar`并将其分配给一个组。

因此，您可以使用此正则表达式并在找到的组中查找结果：

```
>>> import re
>>> m = re.search('foo.*|(bar)', 'f00bar')
>>> if m: print(m.group(1))
bar
>>> m = re.search('foo.*|(bar)', 'foobar')
>>> if m: print(m.group(1))
None
>>> m = re.search('foo.*|(bar)', 'fobas')
>>> if m: print(m.group(1))
>>> 
```

[来源。](https://stackoverflow.com/a/34866700/2213647)

# objective-c - Application does not own action type

> ID：11640454
> 
> 赞同：2
> 
> 时间：2012-07-24T22:52:50.480
> 
> 标签：objective-c, ios, facebook-opengraph

I am working with an application that uses facebook opengraph to post custom objects to a user's wall with a respective custom action. While working in an iOS environment, I am attempting to use the SDK function call:

`- (FBRequest*)requestWithGraphPath:(NSString *)graphPath andParams:(NSMutableDictionary *)params andHttpMethod:(NSString *)httpMethod andDelegate:(id <KC_FBRequestDelegate>)delegate;`

to post the object. I specified the GraphPath as:

```
"me/[APP_NAME]:[APP_ACTION]" 
```

and supplied the Params with a correct access token, api_key, and url to the object to be posted on the user's wall.

I then receive the error message:

```
{"error":{"message":"(#100) Application does not own 479077275455517 action type","type":"OAuthException","code":100}} 
```

in the response from Facebook.

Any insights?

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-01T10:58:40.963

在学习 iOS SDK 集成[教程时，我在通过](http://developers.facebook.com/docs/tutorials/ios-sdk-tutorial/publish-open-graph-story/)[Graph API Explorer](http://developers.facebook.com/tools/explorer/)运行测试时遇到了同样的问题，直到我终于注意到教程中的一句话：“转到 Graph API Explorer 并从“应用程序”中选择您的应用程序列表。”

本质上，我试图向 Graph API Explorer 应用程序本身发布一个操作，因此出现错误，因为显然我没有访问该应用程序的权限。

话虽如此，很可能在您项目中 Facebook sdk 设置的某个地方，您没有输入或错误地输入您的 Facebook 应用程序 ID，这会产生您看到的错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-06T15:44:28.693

我知道这篇文章很旧，但我遇到了同样的问题，最近解决了。请务必检查正确的 [APP_NAME] 的 FB API 调用。就我而言，我有一个测试应用程序和一个实时应用程序，并且我在我的 FB API 调用中编写了实时 [APP_NAME] 代码：

FB.api("我/[APP_NAME]:[APP_ACTION]"...

因此，即使我在 init 中有我的测试应用程序 ID，我也在我的 FB API 调用中调用 prod 应用程序命名空间。

是的，[APP NAME] 代表应用程序的命名空间。

希望这有助于澄清遇到此问题的其他任何人。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-25T12:50:30.283

> 应用程序不拥有**479077275455517**操作类型

这是你行动的*名称吗？*我对此表示怀疑。看起来它可能是您的应用程序 ID。

这清楚地指出了错误构建的 Graph URL。把它写在某个地方进行调试，看看它*真正*包含什么。

# scala - In Scala how do you write a init function?

> ID：11640457
> 
> 赞同：7
> 
> 时间：2012-07-24T22:53:03.753
> 
> 标签：scala, initialization

For example, in Ruby I can write

```
def initialize(price)
    @Current_price = price
end 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-07-24T22:57:44.267

在 scala 中，您将所有初始化都写在类/特征/对象主体中：

```
class Foo(price: Int) {
  val currentPrice = price
} 
```

或者干脆

```
class Foo(val currentPrice: Int) {

} 
```

正如 DNA 所说，您可以将类体视为主要的构造方法。

# video - How can I generate a video file directly from an FFmpeg filter with no actual input file?

> ID：11640458
> 
> 赞同：26
> 
> 时间：2012-07-24T22:53:27.373
> 
> 标签：video, ffmpeg

FFmpeg has a number of video generating filters, listed in the documentation as "[video sources](http://ffmpeg.org/ffmpeg-filters.html#Video-Sources)":

*   cellauto
*   color
*   mptestsrc
*   fei0r_src
*   life
*   nullsrc, rgbtestsrc, testsrc

Those are great for using with other filters like overlay, but is there any way that I can generate a movie consisting of just one of those video sources without any input video?

Something like:

```
ffmpeg -vf color=red" red_movie.mp4 
```

Except that that errors out with **`At least one input file must be specified`**.

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2013-08-09T06:55:43.710

在最近的版本中，选项似乎略有变化。

要使用过滤器输入源，您必须：

1.  使用以下命令将输入​​格式设置为 libavfilter 虚拟设备：`-f lavfi`
2.  `-i`使用标志设置过滤器输入源（不是`-vf`）
3.  提供参数作为**完整的键值对**，例如：`color=color=red`

这`ffplay`也适用于测试您的过滤器图： `ffplay -f lavfi -i color`

# 例子

在这些示例中，我添加`-t 30`了指定我只想要 30 秒的输出。

## 红色）

```
ffmpeg -f lavfi -i color=color=red -t 30 red.mp4
                     ^     ^    ^
                     |     |    |
                   filter key value 
```

密钥可以缩短为其缩写形式：`-i color=c=red`

## SMPTE 彩条图案

```
ffmpeg -f lavfi -i smptebars -t 30 smpte.mp4 
```

## 测试源模式

```
ffmpeg -f lavfi -i testsrc -t 30 -pix_fmt yuv420p testsrc.mp4 
```

![](../Images/7f022e2186fd3fa38a113de00c6c4340.png)

为了让它可靠地播放，您可能需要设置像素格式：`-pix_fmt yuv420p`

默认情况下，ffmpeg 将使用 yuv444p (x264, High 4:4:4 Predictive)，[一些玩家还不能解码](http://ffmpeg.org/pipermail/ffmpeg-user/2013-June/015690.html)。

例如，它创建的视频导致 VLC 2.0.7 崩溃，并且在 QuickTime Player 10.2 (Mac OS X 10.8.4) 中只有 30 秒的黑屏。

更多关于测试源的信息在[这里](https://trac.ffmpeg.org/wiki/FilteringGuide#TestSource)。

## RGB 测试源

```
ffmpeg -f lavfi -i rgbtestsrc -pix_fmt yuv420p -t 30 rgbtestsrc.mp4 
```

与上一个示例一样，这可能对您不起作用，除非您将像素格式设置为 yuv420p，如图所示。

对于后代，这是我正在使用的版本：

```
ffmpeg version 1.2.1
libavutil      52\. 18.100 / 52\. 18.100
libavcodec     54\. 92.100 / 54\. 92.100
libavformat    54\. 63.104 / 54\. 63.104
libavdevice    54\.  3.103 / 54\.  3.103
libavfilter     3\. 42.103 /  3\. 42.103
libswscale      2\.  2.100 /  2\.  2.100
libswresample   0\. 17.102 /  0\. 17.102
libpostproc    52\.  2.100 / 52\.  2.100 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2012-07-24T22:53:27.373

Though hinted at in the documentation, this isn't explicitly spelled out. I was pleased to figure it out, so I thought I'd share.

The key is to use the special format [`lavfi`](http://ffmpeg.org/ffmpeg-devices.html#lavfi):

> Libavfilter input virtual device.
> 
> This input device reads data from the open output pads of a libavfilter filtergraph.
> 
> For each filtergraph open output, the input device will create a corresponding stream which is mapped to the generated output. Currently only video data is supported. The filtergraph is specified through the option ‘graph’.

Essentially, `lavfi` format causes the input to be treated as a video filter instead of a filename.

Thus, to make a movie consisting of nothing but red, the command is:

```
ffmpeg -f lavfi -i color=red -frames:v 200 red_movie.mp4 
```

(Specifying the number of frames or otherwise limiting the input is *crucial* as filters generally have no fixed "end" point, and will happily go on generating video forever.)

# mysql - Can transactional applications (like e commerce/ money transfer etc) be built on no sql db

> ID：11640460
> 
> 赞同：1
> 
> 时间：2012-07-24T22:53:31.583
> 
> 标签：mysql, nosql, transactional

So I want to know whether transaction based web applications can have no sql databases instead of my sql. Or is there a rule of thumb to use My sql, taking into care for standard compliance?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T23:20:42.633

OP ( ) 的第一句话`...transaction based web applications...`在某种意义上回答了这个问题。您将需要一个支持事务的 NoSQL 实现，以便您可以保证跨多个数据条目的原子更新。对评论的回复似乎表明 MongoDB 是正在考虑的数据库。这[似乎不是交易的好选择](http://docs.mongodb.org/manual/faq/developers/#how-do-i-do-transactions-and-locking-in-mongodb)。

除非有某种附加组件提供 ACID 事务支持，否则它将使某些操作变得困难。一个明显且被过度使用的例子是从一个帐户中借记并贷记另一个帐户。如果这不能在单笔交易中完成，那么您很可能会赔钱（或者如果您先完成了信用，您就会赚钱；）。

我不知道这个问题的“经验法则”，但我怀疑你会发现使用基于商业的系统的“传统”数据库更容易。

# android - Android billing - it says checkBillingSupported() is deprecated. What should I use instead?

> ID：11640463
> 
> 赞同：0
> 
> 时间：2012-07-24T22:53:49.103
> 
> 标签：android, android-billing

Android documentation says that this method is deprecated, but I do not see what else I can use instead.

Basically, I am trying to do something like this:

```
if (mBillingService.requestPurchase(issueProductIdPsych, Consts.ITEM_TYPE_INAPP ,  null)) 
{
   // Check what happened? Did the person finish the purchase? did they cance?
   if(mBillingService.checkBillingSupported(Consts.ITEM_TYPE_INAPP))
   {

   }                              

    //BillingHelper.requestPurchase(mContext, "android.test.purchased");
    // android.test.purchased or android.test.canceled or android.test.refunded
} 
```

What is the correct way to accomplish checking what the end of the purchase request was?

I have a buy button like this:

```
 buy.setOnClickListener(new Button.OnClickListener() 
        {  
           public void onClick(View v) 
           { 
```

But I am not really clear what needs to be done next.

Thanks!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T23:02:54.300

希望用您需要的代码替换代码更简单，但显然谷歌描述了一个替代选项。您必须实现 MarketBillingService 接口。所以这只是设计上的一点小调整。幸运的是，他们向您展示了如何实现这一点。

[http://developer.android.com/guide/google/play/billing/billing_integrate.html](http://developer.android.com/guide/google/play/billing/billing_integrate.html)

转到“创建本地服务”的主题。子类别是：

*   绑定到 MarketBillingService
*   向 MarketBillingService 发送计费请求
*   验证是否支持应用内结算 (CHECK_BILLING_SUPPPORTED)
*   发出采购请求 (REQUEST_PURCHASE)

为了解释所写的内容，我将在这里进行描述：

在类别中：“验证是否支持应用内计费（CHECK_BILLING_SUPPPORTED）”他们要求您使用 sendBillingRequest()。这允许您发送五种不同类型的计费请求：

*   CHECK_BILLING_SUPPORTED — 验证 Google Play 应用程序是否支持应用内计费以及可用的应用内计费 API 版本。
*   REQUEST_PURCHASE——发送应用内商品的购买请求。
*   GET_PURCHASE_INFORMATION — 检索购买或退款的交易信息。
*   CONFIRM_NOTIFICATIONS——确认您收到了购买或退款的交易信息。
*   RESTORE_TRANSACTIONS — 检索用户的受管购买交易历史记录。

说您必须在执行请求之前创建一个捆绑包。

以下是如何执行确认的示例：

```
Bundle request = makeRequestBundle("CONFIRM_NOTIFICATIONS");
request.putStringArray(NOTIFY_IDS, mNotifyIds);
Bundle response = mService.sendBillingRequest(request); 
```

检索响应后，检查 Bundle 中的内容，将有三个关键项：RESPONSE_CODE、PURCHASE_INTENT 和 REQUEST_ID。RESPONSE_CODE 键为您提供请求的状态，REQUEST_ID 键为您提供请求的唯一请求标识符。PURCHASE_INTENT 键为您提供了一个 PendingIntent，您可以使用它来启动结帐 UI。

# ios - AVComposition 在 Airplay 上中断

> ID：11640465
> 
> 赞同：5
> 
> 时间：2012-07-24T22:54:03.707
> 
> 标签：ios, avfoundation, airplay, avcomposition

我有一个视频作品，我想通过 Airplay 播放（没有镜像）。该应用程序在使用普通 Airplay 镜像时按预期工作，但我希望获得使用 Airplay 视频所获得的速度、可靠性和分辨率提升。

问题是当我设置

```
player.usesAirPlayVideoWhileAirPlayScreenIsActive = YES; 
```

...播放器一片空白。

笔记：

*   由于我没有为每个显示器创建单独的窗口，因此它们都试图使用相同的 AVPlayer。
*   我的 AVVideoComposition 包含不同的文件并在它们之间添加不透明度渐变。
*   这个未回答的问题表明问题更可能是由于我正在播放 AVComposition 而不是使用共享播放器：[AVComposition does not play via Airplay Video](https://stackoverflow.com/questions/9692564/avcomposition-doesnt-play-via-airplay-video)

两个问题：

1.  我必须摆脱 iPad 上的播放器吗？
2.  可以通过 AirPlay 播放 AVVideoComposition 吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-05-15T12:10:27.303

在应用程序 .plist 中创建一个名为：

`required background modes`

添加一个名为的新数组元素：

`App plays audio or streams audio/video using AirPlay`

不确定您是否已经尝试过，但您没有在帖子中提及。

干杯!

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-01T11:20:33.083

我无法发表评论，因此我不得不将其发布为答案，尽管它可能无法完全回答问题。

我有类似的问题，最后我发现`AVPlayer`播放时`AVComposition`它根本不会在外部显示器上显示任何内容。这就是为什么我必须自己通过收听`UIScreen`连接通知来做到这一点。

我不得不说一切都非常完美。我首先检查是否有多个屏幕，如果有，我只需在该屏幕上移动该`AVPlayer`屏幕，同时在设备屏幕上显示一条简单消息，说明正在播放内容......加上 AirPlay 设备的名称。这样我就可以在外接显示器上放任何我想要的东西，而且不是很复杂。同样的事情是当我收到`UIScreenDidConnectNotification`。

这很好，直到我注意到构图在外部显示器上播放得非常不稳定。即使它只包含一个视频，没有任何复杂的编辑或叠加。如果我将相同的视频保存到相机胶卷或使用`MPMoviePlayerController`.

我尝试了很多方法，例如降低分辨率，降低`renderScale`等等，但没有成功。

更困扰我的一件事是苹果实际上是如何在 iMovie 中做到这一点的——如果你启用了 AirPlay 并且你播放了一个项目（注意它仍然没有渲染，所以它必须使用合成才能显示它）在点击播放按钮后它会打开一个在外接显示器上播放内容非常流畅的播放器。但是，如果您从播放器激活 AirPlay，它会关闭并开始渲染项目。之后，它使用 MPMoviePlayerController 播放它。

我仍在努力寻找解决方案，如果我有任何成功，我会回复。

所以对于这两个问题：

1.  我不明白你为什么要摆脱。
2.  是的，它可以播放，但使用不同的技术和明显的问题。

# flash - Link that runs code to expand flash object fullscreen without refreshing

> ID：11640466
> 
> 赞同：0
> 
> 时间：2012-07-24T22:54:04.397
> 
> 标签：flash, hyperlink, fullscreen

I want to have a flash game with a link at the bottom that says "Fullscreen" and when you click it as though it was a link it will scale a flash object to be as big as your screen without stretching it, or refreshing it. My blog can be found at **bestjavascriptgames.blogspot.com** The link for fullscreen is **NOT** there right now because I don't want people asking about it. Also I have been trying out different display techniques so right now the menu only has 4 games available. It normally has more but for now it has 4.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T23:09:34.433

只要链接在 Flash 对象内，就很容易实现：

```
stage.scaleMode = StageScaleMode.NO_SCALE;

fullscreenBtn.addEventListener(MouseEvent.CLICK, goFullscreen);
function goFullscreen(e:MouseEvent):void
{
    stage.displayState = StageDisplayState.FULL_SCREEN;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T23:26:16.807

鉴于您所说的，在我的回答期间，我将假设您所需的知识需要以 HTML 的形式。

而不是一个“链接”（一个<a href=""></a>），以防止重新加载你需要的是一个<span></span>或<a></a>（没有一个href..不是技术上有效的 HTML），它只有一个 onclick 属性和您的网站需要的任何样式。

该 onclick 应该运行与您的 flash 对象交互的 JavaScript，将其称为内部全屏例程。这不会因任何重新加载而受到惩罚。我把剩下的留作一个关于如何调用 Flash 对象的研究项目——网上有很多例子，你可以根据自己的需要进行调整，我不想猜测如何为你的特定 Flash 对象做这件事。

# asp.net-mvc-3 - 使用@Html.actionlink - 调用另一个视图的动作控制器

> ID：11640469
> 
> 赞同：1
> 
> 时间：2012-07-24T22:54:12.207
> 
> 标签：asp.net-mvc-3, view

我正在努力通过向它传递一个参数来将视图中的动作调用到另一个视图动作控制器。

这是来自视图的调用（我在索引视图中并调用帐户控制器）：

```
@Html.ActionLink("parameters", "MyParameters", "Account", new { email = "test" }) 
```

我的运行时编译器说“无法解析动作 MyParameters”这是怎么回事？

这是我的帐户控制器的功能：

```
public ActionResult MyParameters(string email) {} 
```

这是我的路线：

```
 public static void RegisterRoutes(RouteCollection routes)
    {
        routes.IgnoreRoute("{resource}.axd/{*pathInfo}");

        routes.MapRoute(
            "Default", 
            "{controller}/{action}/{id}", 
            new { controller = "Home", action = "Index", id = UrlParameter.Optional } // Paramètres par défaut
        );

    } 
```

干杯

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-24T23:30:15.950

尝试：

```
@Html.ActionLink("parameters", "MyParameters", "Account", null, new { email = "test" }) 
```

过载是：

```
@Html.ActionLink("linkText", "actionName", "controller", object routeValues, object HtmlAttributes) 
```

`routeValues`用于在链接上添加查询字符串。例如，如果您想将 id=1 添加到链接，您的操作链接将如下所示：

```
@Html.ActionLink("parameters", "MyParameters", "Account", new { @id = 1 }, new { email = "test" }) 
```

这将产生以下结果：

```
<a href="Account/MyParameters?id=1" email="test">parameters</a> 
```

如果您希望电子邮件作为查询字符串，您需要这样做：

```
@Html.ActionLink("parameters", "MyParameters", "Account", new { @id = 1, @email = "test" }, null) 
```

这将产生：

```
<a href="Account/MyParameters?id=1&email=test">parameters</a> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T23:00:45.677

没有`ActionLink`需要 3 个字符串和一个对象的重载。[http://msdn.microsoft.com/en-us/library/dd505040](http://msdn.microsoft.com/en-us/library/dd505040)

该代码可能试图解释`"Account"`为 routeValues 并将您的参数解释为 htmlAttributes。我猜如果您查看实际输出的链接，您会发现它看起来不像您期望的那样。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T23:19:22.447

尝试：

> @Html.ActionLink("Controller", "Action", new { email = "test", parameters = "parameters" })

你的控制器：

> public ActionResult MyParameters（字符串电子邮件，字符串参数）{}

# checkbox - Burn：如何将复选框值存储在变量中

> ID：11640470
> 
> 赞同：3
> 
> 时间：2012-07-24T22:54:12.227
> 
> 标签：checkbox, wix, wix3.6, burn

我想知道您如何将复选框值存储在变量中？我正在使用带有自定义 RtfTheme 的WiX **Burn 。**

例如：

*RtfTheme.xml*

```
<Checkbox Name="TestCheckbox" X="-11" Y="-51" Width="246" Height="17" TabStop="yes" FontId="3" HideWhenDisabled="yes">Please select this box</Checkbox> 
```

*捆绑包.wxs*

```
<Variable Name="TestVariable" Type="numeric" Value="![CDATA[TestCheckbox]]"/> 
```

我希望“TestVariable”的值在我选择或取消选择复选框时更改值。有什么帮助吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-24T23:19:03.990

WixStdBA 自动保存出现在选项页面上的所有命名复选框控件的状态。WixStdBA 不公开任何其他复选框值。

# mysql - How to calculate a moving 4 week average every week in MySQL

> ID：11640474
> 
> 赞同：0
> 
> 时间：2012-07-24T22:55:06.407
> 
> 标签：mysql

I have a table something like this.

```

    count | date
    ------------------
     1     2012-01-01   
     4     2012-01-01   
     5     2012-01-02
    12     2012-01-03
     7     2012-01-04
     4     2012-01-05
    19     2012-01-06
     1     2012-01-07
     etc...

```

I'm looking for a way to calculate the average count per week over the previous 4 week period for each week.

The results should be something like...

```

    avg | yearweek
    ------------------
     3     201201   
     5     201202   
     6     201203
     1     201204
     11    201205
     3     201206
    18     201207
    12     201208
     etc...

```

...where each yearweek is the weekly average over the past 4 yearweeks.

Getting the weekly averages is simple enough but how do I then get that over the past 4 yearweeks? And then how to do I do that as a rolling average? Am I better off just doing this in code?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T01:55:40.623

虽然您当然可以在应用程序的代码中执行此操作，但如果您确实需要在 SQL 中执行此操作，您可以首先创建一个按周聚合的结果表，然后将其连接到自身以获得 4 周移动平均值。

这样做时，我不会存储平均值，而是存储总和和天数（一年中的第一周或最后一周可能没有 7 天——考虑边缘情况）。这样，当平均值的分母不同时，您将避免计算未加权平均值。

因此，假设您有一个表“weekly_results”，其中包含字段：yearweek、sumcount、numdays。您现在可以自行加入过去 4 周并获得总和和计数，然后从中计算平均值：

```
SELECT yearweek, sum_cnt/sum_dys as avg_moving_4wk
FROM (
    SELECT a.yearweek, sum(b.sumcount) as sum_cnt, sum(b.numdays) as sum_dys
    FROM weekly_results a
        join weekly_results b
        on a.yearweek - b.yearweek <4 and a.yearweek - b.yearweek >=0
    GROUP BY a.yearweek
) t1
GROUP BY yearweek 
```

# sql - Three SQL tables or one?

> ID：11640476
> 
> 赞同：2
> 
> 时间：2012-07-24T22:55:24.020
> 
> 标签：sql, database-schema

I have a choice of creating three tables with identical structure but different content or one table with all of the data and one additional column that distinguishes the data. Each table will have about 10,000 rows in it, and it will be used exclusively for looking up data. The key design criteria is speed of lookup, so which is faster: three tables with 10K rows each or one table with 30K rows, or is there no substantive difference? Note: all columns that will be used as query parameters will have indices.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T23:02:22.227

就查找时间而言，任何现代 RDBMS 中的 10k 或 30k 行之间应该没有实质性差异。在任何情况下都没有足够的差异来保证去规范化。索引限定符列是此类设计的常用方法。

如果您的更新模式影响您可以放入“短”表（例如，社交网络中今天的消息）中的有限数据集，您可能会考虑进行反规范化，该表中的索引很少（er），用于快速插入/更新和有一个后台进程将稳定的更新传输到一个大的、完全索引的表。*但是，如果您在写操作期间*真正获胜，那将是一个戏剧性的案例，具有非常特殊和不幸的要求。RDBMS 引擎足够复杂，可以以非常有效的方式处理大多数简单场景。30k 或 rows 听起来不像是候选人。

如果仍有疑问，很容易编写测试来检查您的特定数据库/系统设置。我认为，如果您在此处使用真实数据发布您的发现，这对您的步骤中的每个人来说都是有用的信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T23:46:51.197

除了速度问题（其他发帖人已经涵盖并且我同意）之外，您还应该考虑您在数据库中复制的业务模型，因为这可能会影响您的解决方案的维护成本。

如果 3 个“事物”有可能变成 4 个，并且您选择了单独的表格路径，那么您将不得不添加另一个表格。而如果您选择鉴别器路径，那么它就像想出一个新的鉴别器一样简单。

但是，如果您选择判别器路径，然后新要求规定“事物”之一有更多数据要存储，那么您将不得不向表中添加与其他“事物”无关的额外列。

我不能说哪条路是正确的，因为只有你知道你的商业模式。

# php - 使用 PEAR 在 php 中创建表

> ID：11640480
> 
> 赞同：1
> 
> 时间：2012-07-24T22:55:41.023
> 
> 标签：php, pear

我一直在尝试使用 PEAR 包创建表，我的表如下所示：

```
 <?php include_once 'HTML/Table.php';

    $mytable = new HTML_Table();
    $mytable->setAutoGrow(true);

    $p1 = array('0'=>"<a href='index.php'><img src='img/appicons/hme.png' /></a><p id='imgdes'>Home</p>",
        '1'=>"<a href='loginadmin.php'><img src='img/userlogin.png' /></a><p id='imgdes'>Admin Login</p>",
        '2'=>"<a href='loginuser.php'><img src='img/appicons/login_icon.png' /></a><p id='imgdes'>Member Login</p>",
        '3'=>"<a href='about.php'><img src='img/appicons/abtus.png' /></a><p id='imgdes'>About Us</p>",
        '4'=>"<a href='enquiry.php'><img src='img/appicons/contact.png' /></a><p id='imgdes'>Enquiries</p>"
        );

    $mytable->setAutoFill('');
    $mytable->setCellContents(0, 0,$p1[0]);
    $mytable->setCellContents(0, 1,$p1[1]);
    $mytable->setCellContents(1, 0, $p1[2]);
    $mytable->setCellContents(1, 1, $p1[3]);
    $mytable->setCellContents(2, 0, $p1[4]);

    echo $mytable->toHtml();
?> 
```

我的表格内容通常会在一些烦人的消息之后显示：

严格标准：不应静态调用非静态方法 PEAR::isError()，假设 $this 来自第 667 行 C:\xampp\php\PEAR\HTML\Table.php 中的不兼容上下文

严格标准：不应静态调用非静态方法 PEAR::isError()，假设 $this 来自第 413 行 C:\xampp\php\PEAR\HTML\Table\Storage.php 中的不兼容上下文。

请有人可以帮我解决这个问题或给我关于如何去做的建议吗？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T06:52:47.607

这些警告是因为 HTML_Table 不兼容 E_STRICT。不过，代码仍然有效。

避免这种情况的唯一方法是禁用 E_STRICT 错误：

```
error_reporting(error_reporting() & ~E_STRICT); 
```

# php - 警告 mysql_num_rows()：提供的参数不是有效的 MySQL 结果

> ID：11640482
> 
> 赞同：0
> 
> 时间：2012-07-24T22:55:45.653
> 
> 标签：php, sql

为什么我有这个错误以及如何解决这个问题，我已经仔细检查了一切，一切都很好

> **警告**：mysql_num_rows()：提供的参数不是 第**15**行**/home/sharinga/public_html/ccccc.com/app/like/like.php**中的有效 MySQL 结果资源您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 1 行的“like WHERE postID='81' AND userIP='2x2.2x0.x5.xxx'' 附近使用正确的语法

 **这里是sql

```
$ip_sql = mysql_query("SELECT userIP FROM like WHERE postID='$id' AND userIP='$ip'");
$count = mysql_num_rows($ip_sql) or die(mysql_error());
if($count==0)
{... 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-24T22:58:35.157

`LIKE`是一个保留字 - 转义它

```
$ip_sql = mysql_query("SELECT userIP FROM `like` WHERE postID='$id' AND userIP='$ip'"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T22:58:51.520

`LIKE`是 SQL 中的关键字，使用`´`

```
SELECT userIP FROM `like` WHERE postID='$id' AND userIP='$ip 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T23:07:53.540

先尝试连接。您在寻找 null 案例吗？如果是这样，您必须搜索某个行而不是整个 $count。

```
$conn = mysql_connect("localhost", "user", "pass");
$ip_sql = mysql_query("SELECT userIP FROM like WHERE postID='$id' AND userIP='$ip'",$conn);
$count = mysql_num_rows($ip_sql) or die(mysql_error());
if ($count['postID'}==""){
} 
```**

# mysql - 如何根据 MySQL 表中的时间戳重置主键？

> ID：11640483
> 
> 赞同：1
> 
> 时间：2012-07-24T22:55:46.703
> 
> 标签：mysql, sorting, primary-key

我知道我可以通过这种方式重置主键：

```
ALTER TABLE `users` DROP `id`;
ALTER TABLE `users` AUTO_INCREMENT = 1;
ALTER TABLE `users` ADD `id` int UNSIGNED NOT NULL AUTO_INCREMENT PRIMARY KEY FIRST; 
```

但我想知道如何调整它以根据我的时间戳列中的时间戳应用主键，即具有最旧时间戳的行获得值 1，下一个最旧的值 2，等等。

**SHOW CREATE TABLE 的输出**

```
CREATE TABLE `tracks` (
 `id` int(10) unsigned NOT NULL auto_increment,
 `timestamp` timestamp NOT NULL default CURRENT_TIMESTAMP,
 `from_user` varchar(50) NOT NULL,
 `source_filename` varchar(80) NOT NULL,
 `uploaded_page` varchar(50) NOT NULL,
 `operating_system` varchar(50) NOT NULL,
 `browser` varchar(50) NOT NULL,
 `os_browser_version` varchar(200) NOT NULL,
 `title` varchar(100) NOT NULL,
 `artist` varchar(60) NOT NULL,
 `album` varchar(120) NOT NULL,
 `genre` varchar(120) NOT NULL,
 `format` varchar(10) NOT NULL,
 `bitrate` mediumint(9) NOT NULL,
 `conversion_needed` tinyint(1) NOT NULL COMMENT 'if not mp3, or higher than 192kbps',
 `conversion_successful` tinyint(1) NOT NULL,
 `art_extracted` tinyint(1) NOT NULL,
 `art_location` varchar(200) NOT NULL,
 `file_location` varchar(200) NOT NULL,
 `status` varchar(500) NOT NULL,
 PRIMARY KEY  (`id`)
) ENGINE=MyISAM AUTO_INCREMENT=96 DEFAULT CHARSET=utf8 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T23:04:34.507

创建一个名为的新表`users2`，其结构与以下内容相同`users`：

```
CREATE TABLE users2 LIKE users; 
```

然后运行这个语句：

```
INSERT INTO users2
(col1, col2, ... coln)
SELECT col1, col2, ... coln
FROM users
ORDER BY your_timestamp 
```

对于您的特定表：

```
INSERT INTO tracks2
(`timestamp`,`from_user`,`source_filename`,`uploaded_page`,`operating_system`,`browser`,`os_browser_version`,`title`,`artist`,`album`,`genre`,`format`,`bitrate`,`conversion_needed`,`conversion_successful`,`art_extracted`,`art_location`,`file_location`,`status`)
SELECT `timestamp`,`from_user`,`source_filename`,`uploaded_page`,`operating_system`,`browser`,`os_browser_version`,`title`,`artist`,`album`,`genre`,`format`,`bitrate`,`conversion_needed`,`conversion_successful`,`art_extracted`,`art_location`,`file_location`,`status`
FROM tracks
ORDER BY timestamp 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-24T23:48:55.070

我知道您已经接受了答案，但是为了后代，我想提出一个更简单的解决方案。MySQL 允许您使用 重新排序表的行，因此您可以通过在原始示例中再[`ALTER TABLE...ORDER BY...`](http://dev.mysql.com/doc/refman/5.5/en/alter-table.html)添加一条语句轻松地做到这一点：`ALTER TABLE`

```
ALTER TABLE `users` DROP COLUMN `id`;
ALTER TABLE `users` ORDER BY `timestamp`;
ALTER TABLE `users` AUTO_INCREMENT = 1;
ALTER TABLE `users` ADD COLUMN `id` int UNSIGNED NOT NULL AUTO_INCREMENT PRIMARY KEY FIRST; 
```

# objective-c - 图像未在 UIImageView 上加载

> ID：11640486
> 
> 赞同：0
> 
> 时间：2012-07-24T22:56:09.907
> 
> 标签：objective-c, ios

我在带有缩略图的 UITableView 中显示数据。最初，当单击单元格时，我会从服务器重新加载图像，这将花费额外的时间、资源和内存。我没有这样做，而是将缩略图图像的指针传递给将在屏幕上显示并立即显示的视图，而不必重新下载它。但是，我遇到了一个问题 - 当我将新视图上的 imageView 设置为旧图像时，什么都没有加载。这是我的代码：

这是在我的 UITableView 类中：

```
CustomCell *cell = (CustomCell *)[tableView cellForRowAtIndexPath:indexPath];
NewsViewController *newsViewController = [[NewsViewController alloc] initWithNibName:@"NewsViewController" bundle:nil dictionary: dict type:d numberOfPages:1 image: cell.imageView.image]; 
```

新闻视图控制器.m：

```
- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil dictionary:(NSDictionary *)dict type:(NSInteger)type numberOfPages:(NSInteger)pages image:(UIImage *)image{
    self = [super initWithNibName:@"NewsViewController" bundle:Nil];
    if (self) {

        newsText = [dict objectForKey:@"content"];
        newsTitle = [dict objectForKey:@"title"];
        newsDate = [dict objectForKey:@"pub_date"];
        d = type;
        numberOfPages = pages;
        imageURL = [[NSMutableArray alloc] initWithCapacity:numberOfPages];
        mainImage = [[UIImage alloc] init];
        mainImage = image;
   }
   return self; 
}

- (void)viewDidLoad
{
    [super viewDidLoad];
    labelBody.text= newsText;
    titleView.text = newsTitle;
    date.text = newsDate;
    if (numberOfPages == 1) {
        imageScrollView.contentSize = CGSizeMake(320, 303);
        pageControl.numberOfPages = 1;
        CustomImageView *customImageView  = [[CustomImageView alloc] initWithFrame:imageScrollView.bounds];
        [imageScrollView addSubview:customImageView];
        customImageView.imageView.image = mainImage;
    }
} 
```

新闻视图控制器.h

```
#import <UIKit/UIKit.h>
#import "AdWhirlView.h"
#import "AdWhirlDelegateProtocol.h"

@class Reachability;

@interface NewsViewController : UIViewController<AdWhirlDelegate, UIScrollViewDelegate>{
    AdWhirlView *adView;
    IBOutlet UILabel *labelBody;
    IBOutlet UILabel *titleView;
    IBOutlet UILabel *subTitle;
    IBOutlet UILabel *date;
    IBOutlet UIScrollView *scrollView;
    IBOutlet UIScrollView *imageScrollView;
    IBOutlet UIImageView *backgroundImage;
    IBOutlet UIImage *mainImage;
    IBOutlet UIPageControl *pageControl;
    NSInteger numberOfPages;
    NSMutableArray *imageURL;

}

@property(nonatomic,retain)AdWhirlView *adView;
@property (nonatomic, retain) NSMutableArray *imageURL;  
@property (nonatomic, retain) IBOutlet UIPageControl *pageControl;
@property (nonatomic, retain) IBOutlet UIScrollView *imageScrollView;
@property (nonatomic, weak) IBOutlet UIImageView *backgroundImage;
@property (nonatomic, retain) IBOutlet UIImageView *imageView;
@property (nonatomic, retain) IBOutlet UIScrollView *scrollView;
@property (nonatomic, retain) IBOutlet UIImage *mainImage;
@property (nonatomic, strong) NSString *newsText;
@property (nonatomic, strong) NSString *newsTitle;
@property (nonatomic, strong) NSString *newsDate;
@property (nonatomic, assign) NSInteger numberOfPages;
@property (nonatomic, strong) IBOutlet UILabel *titleView;
@property (nonatomic, strong) IBOutlet UILabel *labelBody;
@property (nonatomic, strong) IBOutlet UILabel *subTitle;
@property (nonatomic, strong) IBOutlet UILabel *date;
@property (nonatomic, retain) Reachability* internetReachable;
@property (nonatomic, assign) BOOL internetActive;

-(void) checkNetworkStatus:(NSNotification *)notice;

- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil     dictionary: (NSDictionary *)dict type:(NSInteger)type numberOfPages:(NSInteger) pages image:(UIImage *)image;
- (BOOL)checkInternet;
- (void)doStuff;
- (IBAction)ad;

@end 
```

我将 mainImage 用作 (UIImage *) 并尝试用主 Image 替换我的 customImageView 类中的图像，但没有显示任何内容。我在这里想念什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T23:16:35.383

我猜你想为你的 UIImageView 构建某种缓存机制。完成所有这些工作的最简单方法之一是使用 AFNetworking 库。

AFNetworking 通过一些额外的方法扩展 UIImageView 来从远程源加载图像。AFNetworking 内置缓存，无需重新发明轮子 :)

看看以下网站：

*   [AF网络](https://github.com/AFNetworking/AFNetworking/)
*   [UIImageView (AFNetworking)](http://afnetworking.org/Documentation/Categories/UIImageView+AFNetworking.html)

# c# - 使用 MVVM、ObservableCollection 和响应式扩展 (Rx) 的无效跨线程访问

> ID：11640487
> 
> 赞同：2
> 
> 时间：2012-07-24T22:56:10.947
> 
> 标签：c#, .net, mvvm, system.reactive, reactive-programming

我目前正在开发 Windows Phone 应用程序，我想使用 Reactive Extensions 来创建异步以获得更好的 UI 体验。

我使用 MVVM 模式：我的 View 在我的 ViewModel 中有一个 ListBox 绑定到 Items 的 ObservableCollection。项目具有传统属性，如名称或 IsSelected。

```
<ListBox SelectionMode="Multiple" ItemsSource="{Binding Checklist, Mode=TwoWay}">
    <ListBox.ItemTemplate>
        <DataTemplate>
            <StackPanel Orientation="Horizontal">
                <CheckBox Content="{Binding Name}" IsChecked="{Binding IsSelected, Mode=TwoWay}"/>
            </StackPanel>
        </DataTemplate>
    </ListBox.ItemTemplate>
</ListBox> 
```

我在 App.xaml.cs 中实例化我的 MainViewModel：

```
public partial class App : Application
{
    private static MainViewModel _viewModel = null;

    public static MainViewModel ViewModel
    {
        get
        {
            if (_viewModel == null)
                _viewModel = new MainViewModel();

            return _viewModel;
        }
    }

    [...]
} 
```

我在 MainPage_Loaded 中加载我的数据。

```
public partial class MainPage : PhoneApplicationPage
{
   public MainPage()
    {
        InitializeComponent();
        this.DataContext = App.ViewModel;
        this.Loaded += new System.Windows.RoutedEventHandler(MainPage_Loaded);
    }

    private void MainPage_Loaded(object sender, System.Windows.RoutedEventArgs e)
    {
        App.ViewModel.LoadData();
    }
} 
```

我从 ViewModel 加载数据（稍后我将把代码移到模型中）：

```
public class MainViewModel : ViewModelBase
{
    public ObservableCollection<Item> _checklist;

    public ObservableCollection<Item> Checklist
    {
        get
        {
            return this._checklist;
        }
        set
        {
            if (this._checklist != value)
            {
                this._checklist = value;
            }
        }
    }

    private const string _connectionString = @"isostore:/ItemDB.sdf";

    public void LoadData()
    {
        using (ItemDataContext context = new ItemDataContext(_connectionString))
        {
            if (!context.DatabaseExists())
            {
                // Create database if it doesn't exist
                context.CreateDatabase();
            }

            if (context.Items.Count() == 0)
            {
                [Read my data in a XML file for example]

                // Save changes to the database
                context.SubmitChanges();
            }

            var contextItems = from i in context.Items
                                select i;

            foreach (Item it in contextItems)
            {
                this.Checklist.Add(it);
            }
        }
    }

    [...]
} 
```

它工作正常，项目在视图中更新。

现在我想创建异步。在我从 View 而不是 LoadData 调用的新方法中使用传统的 BeginInvoke 可以正常工作。

```
public partial class MainPage : PhoneApplicationPage
{
    [...]

    private void MainPage_Loaded(object sender, System.Windows.RoutedEventArgs e)
    {
        App.ViewModel.GetData();
    }
} 
```

我使用了一个名为 CurrentDispatcher 的属性，它在 App.xaml.cs 中填充了 App.Current.RootVisual.Dispatcher。

```
public class MainViewModel : ViewModelBase
{
    [...]

    public Dispatcher CurrentDispatcher { get; set; }

    public void GetData()
    {
        this.CurrentDispatcher.BeginInvoke(new Action(LoadData));
    }

    [...]
} 
```

但我想使用反应式扩展。因此，我尝试了 Rx 的不同元素，例如 ToAsync 或 ToObservable，但是当我将项目添加到清单时，我遇到了一些“UnauthorizedAccessException 未处理”和“无效的跨线程访问”。

我尝试观察其他线程，因为错误可能来自 UI 和后台线程之间的混合，但它不起作用。也许我不像在那种特殊情况下那样使用 Rx？

任何帮助将不胜感激。

回答后编辑：

这是一个很好用的代码！

```
public void GetData()
{
    Observable.Start(() => LoadData())
    .ObserveOnDispatcher()
    .Subscribe(list =>
    {
        foreach (Item it in list)
        {
            this.Checklist.Add(it);
        }
    });
}

public ObservableCollection<Item> LoadData()
{
    var results = new ObservableCollection<Item>();

    using (ItemDataContext context = new ItemDataContext(_connectionString))
    {
        //Loading

        var contextItems = from i in context.Items
                           select i;

        foreach (Item it in contextItems)
        {
            results.Add(it);
        }
    }

    return results;
} 
```

如您所见，我以前没有正确使用。现在我可以使用 ObservableCollection 并在订阅中使用它。这是完美的！非常感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-25T09:21:46.487

您的代码中似乎没有异步性（保存 BeginInvoke，我不认为它正在做您认为它正在做的事情）。

我假设您想使用 Rx，因为您的代码此刻全部阻塞，并且在建立与数据库的连接并加载数据时 UI 无响应 :-(

你想要做的是在后台线程上执行“繁重的工作”，然后一旦你有了值，只需将它们添加到 Dispatcher 上的 ObservableCollection 中。您可以通过以下三种方式之一执行此操作：

1.  一口气归还整个系列。然后，您使用添加到 ObservableCollection 的 foreach 循环遍历列表。如果列表太大，这可能会阻止 UI（无响应的应用程序）
2.  一次返回集合一个值，在对调度程序的独立调用中将每个项目添加到 ObservableCollection。这将使 UI 保持响应，但可能需要更长的时间才能完成
3.  以缓冲块的形式返回集合并尝试两全其美

您想要的代码*可能*如下所示

```
public IList<Item> FetchData()
{
  using (ItemDataContext context = new ItemDataContext(_connectionString))
  {
    //....
    var results = new List<Item>();
    foreach (Item it in contextItems)
    {
      results.Add(it);
    }
    return results;
  }
}
public void LoadData()
{
  Observable.Start(()=>FetchData())
            .ObserveOnDispatcher()
            .Subscribe(list=>
              {
                foreach (Item it in contextItems)
                {
                  this.Checklist.Add(it);
                }
              });
} 
```

该代码不是单元测试的理想选择，但它似乎对您不感兴趣（静态成员、带有 DB 连接的 VM 等），所以这可能行得通？！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T23:03:30.923

我自己也遇到了这个。有多种方法可以到达调度程序，我不得不使用以下方法。我直接从我的 ViewModels 调用它（没有从外部传入）。

```
Application.Current.Dispatcher.Invoke(action); 
```

# mdx - Proclarity 视图似乎与关联的数据立方体不同步

> ID：11640490
> 
> 赞同：0
> 
> 时间：2012-07-24T22:56:37.793
> 
> 标签：mdx, data-cube, proclarity

我的老板刚刚交给我一个他和我都没有经验的任务，我们也没有任何策略来解决它。问题涉及 Proclarity 和 Data Cube，这两个我都不熟悉。我会尽力提供相关信息，我很乐意应要求提供更多信息。

以下是概要 - 我们的财务报告部门提交了一份工作单，声称当他们在 Proclarity 中设置视图以显示分配给特定客户的销售人员时，他们会得到一个包含公司**所有销售人员**的结果集，而不是**单个销售人员分配给客户的人**。他们告诉我们，这并不总是发生——这是一个新的发展。

就像我之前说的 - 我真的不知道如何开始解决这个问题。在今天之前，我什至从未听说过 MDX。我去了 MSDN 并阅读了一些关于基本 MDX 查询的内容，并在 StackOverflow 上查看了一些问题。但我仍然完全不知道如何解决这个问题。我真的不指望有人马上给我一个答案，但希望有人至少能让我指出正确的大方向。

值得一提的是，He 是由 Proclarity 的 MDX 编辑器生成的 MDX 查询的副本：

```
SELECT {  } ON COLUMNS , 

{ [Customer].[Cust ID].&[WALM1000] } * { [Sales Person].[Sper Name].[All].CHILDREN } ON ROWS   

FROM [Basic Research Cube]  

WHERE ( [Measures].[Gross Sales] ) 
CELL PROPERTIES VALUE, FORMATTED_VALUE, CELL_ORDINAL, ACTION_TYPE 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T06:33:29.840

* 运算符用于做 2 组的笛卡尔积。因此，您的查询结果将包含带有空单元格的行。您可以删除这些行。

您可以`NON EMPTY`在轴表达式的开头添加：

```
SELECT { [Measures].[Gross Sales] } ON COLUMNS,
NON EMPTY { [Customer].[Cust ID].&[WALM1000] } * { [Sales Person].[Sper Name].[All].CHILDREN } ON ROWS
FROM [Basic Research Cube]
CELL PROPERTIES VALUE, FORMATTED_VALUE, CELL_ORDINAL, ACTION_TYPE 
```

如果您想学习 Mdx，我建议您阅读[此处](https://stackoverflow.com/questions/24963/how-to-learn-mdx)列出的书籍之一。

在本[文档](http://extras.springer.com/2006/978-1-84628-174-7/Documentation/GettingStartedGuide.pdf)的第 5 章中，您可以找到如何从 UI 中删除空行。

# java - Java updateUI 只工作一次

> ID：11640494
> 
> 赞同：0
> 
> 时间：2012-07-24T22:57:17.480
> 
> 标签：java, swing

这是我正在构建的应用程序[https://github.com/chrisbramm/LastFM-History-Graph](https://github.com/chrisbramm/LastFM-History-Graph)。

下面是控制器类的一部分`src/lastfmhistoryclasses`。创建`OutputGUIView`时，它会创建三个组件， a `JPanel graphPanel`， this 添加到 a`JScrollPane graphScrollPanel`和 another `JPanel autocompletePanel`。然后这些都添加到`JFrame OutputGUIView`. 然后下面的侦听器会更改首选大小，`graphPanel`并且当您第一次按下按钮时，UI 会更新以显示`graphPanel`大小增加并且滚动条`graphScrollPanel`发生了变化。

但是现在，如果您按下另一个按钮，首选尺寸会发生变化，但 UI 不会更新，如果您通过最大化它来更改窗口尺寸，它会这样做。

```
class Zoom2000 implements ActionListener{
    public void actionPerformed(ActionEvent e){
        outputGUIView.graphPanel.setPreferredSize(new Dimension(screenWidth, 2000));
        outputGUIView.graphScrollPanel.updateUI();

    }
}
class ZoomDefault implements ActionListener{
    public void actionPerformed(ActionEvent e){
        outputGUIView.graphPanel.setPreferredSize(new Dimension(screenWidth, screenHeight));
        outputGUIView.graphScrollPanel.updateUI();

    }
}
class Zoom6000 implements ActionListener{
    public void actionPerformed(ActionEvent e){
        outputGUIView.graphPanel.setPreferredSize(new  Dimension(screenWidth, 6000));
        outputGUIView.graphScrollPanel.updateUI();

    }
} 
```

我一直在尝试不同的东西，例如`invalidate/validate/revalidate`（和重新绘制）各种组件，而graphPanel 只是坐在那里，只有在您更改窗口尺寸时才会重新绘制。

任何想法我做错了什么？

编辑更新：这是 GraphPanel 类：

```
package lastfmhistoryguis;

import java.awt.Color;
import java.awt.Dimension;
import java.awt.Graphics;
import java.awt.Graphics2D;
import java.awt.geom.Line2D;
import java.awt.geom.Rectangle2D;
import javax.swing.*;

import de.umass.lastfm.*;
import lastfmhistoryclasses.*;

SuppressWarnings("serial")
public class GraphPanel extends JPanel {

private LastFMHistory graphData;
private int graphHeight;
private int graphWidth;
private int zoom;
private final int PAD = 20;

public GraphPanel(LastFMHistory model, int zoom){
    this.graphData = model;
    if (zoom != 1){
        this.zoom = zoom;
    }else{
        this.zoom = 1;
        System.out.println("getHeight() returning:" + getHeight());
    }
    System.out.println("Width" + getWidth() + "Height" + getHeight());

}

protected void paintComponent(Graphics g) {
    super.paintComponent(g);
     System.out.println("Drawing");
    Graphics2D graph = (Graphics2D) g;

    if (graphData == null) {
        System.err.println("No data found");
    } else {
        System.out.println("paintComponent Width" + getWidth() + "Height" + getHeight());
        graphWidth = getWidth() - 5 * PAD;
        //graphHeight = getHeight() - 2 * PAD;
        graphHeight = 6000 - 2* PAD;
        System.out.println(graphWidth + ", " + graphHeight);

        int x0 = graphWidth + PAD;
        graph.draw(new Rectangle2D.Double(PAD, PAD, graphWidth, graphHeight));
        double xInc = (double) (graphWidth) / (graphData.dayMax);
        double secondHeight = (double) (graphHeight) / 86400;

        for (int i = 0; i <= 86400; i++) {
            if (i % 3600 == 0) {
                graph.draw(new Line2D.Double(x0, (i * secondHeight) + PAD,
                        x0 + 10, (i * secondHeight) + PAD));
                String hour = Integer.toString(i / 3600);
                graph.drawString(hour, x0 + 15,
                        (int) ((i * secondHeight) + PAD));
            }
        }

        for (Track t : graphData.history) {
            if (t.getPlayedWhen() != null) {

                Color color = t.getColour();

                int duration = t.getDuration();
                int day = Math.abs(t.getDay());
                double dayOrigin = x0 - ((day + 1) * xInc);
                double timeOrigin = t.getGraphHeight() * secondHeight + PAD;
                double trackHeight = duration * secondHeight;
                graph.setColor(color);
                // System.out.println("PLOTTING TRACK, " + day + ", " +
                // dayOrigin + ", " + t.getGraphHeight() + ", " + timeOrigin
                // + ", " + trackHeight);
                // graph.draw(new Rectangle2D.Double(dayOrigin, timeOrigin,
                // xInc, trackHeight));
                graph.fillRect((int) dayOrigin, (int) timeOrigin,
                        (int) xInc, (int) trackHeight);
            }

        }

        for (int i = 0; i < graphData.dayMax;){
            graph.draw(new Line2D.Double(x0 - i * xInc, PAD, x0 - i * xInc, graphHeight + PAD));
            i = i + 7;
        }

    }
}
public void zoom(int zoom){
    this.zoom = zoom;
    repaint();
} 
```

}

它创建一个 Graphics2D 对象，在该对象上绘制一个大的轮廓矩形，然后将每个轨道矩形绘制到此 Graphics2D 图形对象的某个位置。现在我已经[按照这里的建议](https://stackoverflow.com/questions/7229226/should-i-avoid-the-use-of-setpreferredmaximumminimumsize-methods-in-java-swi/7229519#7229519)删除了 setPreferredSize 的使用，但是现在我遇到了一个问题，即当我手动将 GraphPanel 中的 graphHeight 设置为 6000 的高度时，graphScrollPanel 没有意识到它所包含的 graphPanel 实际上更大，因为所有 graphHeight 都是正在绘制一个大约 6000px 高的矩形。所以在这种情况下我应该使用 setPreferredSize 还是有另一种方法来设置 Graphics2D 对象的大小？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-24T23:39:24.280

不要称`updateUI`这与 UI Look and Feel API 有关，与重绘关系不大。

您尝试过/正在使用哪些布局管理器？

调用`invalidate()`,`repaint()`应该会影响父容器布局管理器并导致它们相应地重新布局组件，但您需要记住，布局管理器仅使用最小/最大/首选项大小信息作为指南。

从你的例子中我最好的客人是你应该试着打电话给

```
outputGUIView.graphPanel.invalidate();
outputGUIView.graphPanel.repaint(); 
```

和/或

```
outputGUIView.invalidate();
outputGUIView.repaint(); 
```

在滚动窗格中调用 invalidate 可能不会实现很多，因为视口负责布局内容，而不是滚动窗格。

如果你真的很绝望，你可以试试

```
outputGUIView.graphScrollPanel.getViewport().invalidate();
outputGUIView.graphScrollPanel.getViewport().repaint(); 
```

# android - ProgressDialog 崩溃的应用程序

> ID：11640495
> 
> 赞同：0
> 
> 时间：2012-07-24T22:57:19.867
> 
> 标签：android, listview, progressdialog

我试图让 ProgressDialog 在显示它之前加载我的列表视图，但我遇到了崩溃。会有更好的方法来实现这一点吗？

编辑：更新了 logcat 错误，忘记了它。

```
List<String> internetArray = new ArrayList<String>();
    private ProgressDialog p;

@Override
public void onCreate(Bundle savedInstanceState) {
            super.onCreate(savedInstanceState);
            setContentView(R.layout.main);

            ListView internetList = (ListView)findViewById(R.id.list);

            p = ProgressDialog.show(this, "Please wait..", "Loading list..", true);

            new Thread(){
                public void run(){
                    //do some extreme work before creating list

                    try {
                        sleep(5000);
                    } catch (InterruptedException e) {
                        // TODO Auto-generated catch block
                        e.printStackTrace();
                    }
                    internetArray.clear();
                    //p.dismiss();
                }

            }.start();

            getPermissions(this);
            ArrayAdapter<String> arrayAdapter = new ArrayAdapter<String>(this,android.R.layout.simple_list_item_1, internetArray);

            arrayAdapter.sort(new Comparator<String>() {    
                        public int compare(String object1, String object2) {
                            return object1.compareTo(object2);
                        };
                    });

            internetList.setAdapter(arrayAdapter); 

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T23:02:12.740

乍一看没有 logcat，这就是问题所在：`p.dismiss();`.

您正在尝试关闭 UI 元素，在您的情况下是来自后台线程的进度对话框。

尽管我确信这是原因，但您应该发布您的 logcat 以获取更多详细信息。

编辑：应该考虑上述错误，尽管在创建对话框时出现错误：`MainActivity.this`这不能​​被实例化。您可以尝试通过`this`而不是类 context传递实际上下文`MainActivity.this`。

```
p = ProgressDialog.show(this, "Please wait..", "Loading list..", true); 
```

更新：也许在您的代码行中是有效的，但您必须知道，当您尝试从后台线程访问 UI 元素时会导致内存泄漏（您甚至没有尝试通过`runOnUIThread()`方法访问它，根据我的意见）。

我不是说你根本不应该添加它，而是你应该在ui线程中添加它。对于我们现在的问题，`this`工作了吗？因为我没有看到任何新的 logcat 或其他东西...... :)

# android - 可以在没有 XML 文件的情况下实现 ListView 吗？

> ID：11640497
> 
> 赞同：0
> 
> 时间：2012-07-24T22:57:30.477
> 
> 标签：android, listview, baseadapter, listview-adapter

我正在尝试`ListView`在我的应用程序上实现 a，但我正在尝试理解和学习如何在不使用 XML 文件的情况下实现它，所有这些都使用 java 代码。

我被困在充气机部分，该`mInflater.inflate();`功能需要一个资源 xml 文件，所以，我不明白如何在不使用 XML 文件的情况下继续

我有一个`ArrayList`字符串，我只需要一个`ListView`显示包含这些字符串的列表的列表`Arraylist`，并`Button`在`String`. 如果用户按下`Button`，获取的项目将`List`被删除。

的每一项`ListView`都有两件事，一个是`TextView`用的`String`，`ArrayList`一个`Button`是删除它。

如果有人能给我代码示例，我将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T23:20:30.953

我完全同意 CommonsWare。但是您被卡住的部分是您必须为行创建行“模板”的部分`ListView`。`inflater`用于制作`View`一个完整文件的单个`layout.xml`文件。所以基本的想法是你创建一个代表每一行的xml，然后通过那段代码对其进行扩充。

在您的情况下，您需要通过代码来做到这一点。也许添加 a`LinearLayout`作为具有方向=垂直的父级添加一些宽度或高度属性，然后添加 2`TextView`以便成为具有一些附加属性的标题和副标题。然后你应该把它们添加到`LinearLayout`你那里。

你`LinearLayout`是一堆`View`动态创建的s，效果和把上面所有的代码通过一个xml文件膨胀一样。

但我真的不明白在更快、更容易、更直接、更好实施，更不用说最佳实践上大惊小怪了……

编辑：您在适配器内部的某个地方：`mInflater.inflate();`使用您提到的资源。正如我之前所说，资源决定了每一行的“模板”如何。因此，将确定列表行的普通 xml 文件将是这样的：

```
<LinearLayout android:layout_width="fill_parent"
   android:layout_height="wrap_content" android:orientation="vertical" >
   <TextView ... /> <! --some properties you want to set -->
   <TextView ... /> <! --some properties you want to set -->
</LinearLayout> 
```

此 xml 为 a 生成 2 行列表行`ListView`。使用布局充气器，上面的 xml 文件返回一个`View`包含所有包的对象。

因此，如果您想从代码创建它，那么代码段将是：

```
LinearLayout layout = new LinearLayout(context);
//layout set some properties
TextView title = new TextView(context);
//title set some properties
TextView subtitle = new TextView(context);
//subtitle set some properties
layout.add(title);
layout.add(subtitle); 
```

现在不是膨胀 xml 以将内容放入单个`View`对象中，而是`layout`代码片段中的变量包含以前通过 xml 膨胀的所有逻辑。

如果您之前创建了自定义`ListView`适配器，那么您应该熟悉创建自定义列表行及其工作原理。

编辑：适配器的示例代码`ListView`

这是`getView()`通过扩展单个布局的适配器方法的标准过程：

```
@Override
public View getView(int position, View view, ViewGroup viewgroup) {
ViewHolder holder; //our view holder of the row
if (view == null) {
   view = context.getLayoutInflater().inflate(R.layout.static_layout, null);
   holder = new ViewHolder();
   //set the views of the holder
       view.setTag(holder);
} else {
   holder = (ViewHolder) view.getTag();
}
    //rest of implementation of the View
    return view;
} 
```

动态实现：

```
@Override
public View getView(int position, View view, ViewGroup viewgroup) {
ViewHolder holder; //our view holder of the row
if (view == null) {
       LinearLayout layout = new LinearLayout(context);
       //layout set some properties
       TextView title = new TextView(context);
       //title set some properties
       TextView subtitle = new TextView(context);
       //subtitle set some properties
       layout.add(title);
       layout.add(subtitle);
   //CREATING THE LAYOUT THROUGH CODE

       view = layout; //INSTEAD OF INFLATING A LAYOUT FOR THE ROW I JUST BINDED IT TO THE RECENTLY CREATED LAYOUT 
   holder = new ViewHolder();
   //bind the views of the holder to the views of the layout
       view.setTag(holder);
} else {
   holder = (ViewHolder) view.getTag();
}
    //rest of implementation of the View
    return view;
} 
```

# php - 对话框中的jquery浮点图

> ID：11640501
> 
> 赞同：0
> 
> 时间：2012-07-24T22:57:51.957
> 
> 标签：php, jquery

问题：在对话框中显示 jquery 浮点图

我有一个使用 flot 显示水平条形图的页面，这是交互式的。当我单击任何条时，它会执行 getJSON 并在传递变量的情况下，在外部 php 页面中绘制另一个图形。我正在尝试在 jquery 对话框中显示的外部 php 页面中绘制图形。

我一直在到处寻找，但我无法找到解决方案。任何帮助表示赞赏。

```
 $.getJSON("page2.php?"+data, function(mdata) {
        $('<div></div>').html(result).dialog({ 
        autoOpen: false, 
        modal: true, 
        title: 'Page Hits - Monthly', 
        width: 450, height: 300 
    }).dialog('open'); 
```

第 2 页是绘制图表的位置，我想在对话框内的当前页面中显示图表。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T23:08:23.353

也许尝试`$.get`而不是`$.getJSON`

```
$.get('page2.php?'+data, function(response){
  $('<div></div>').html(response).dialog({ 
    autoOpen: true, 
    modal: true, 
    title: 'Page Hits - Monthly', 
    width: 450, height: 300 
  });
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T23:43:23.703

您可以创建一个 PHP 类来包含您的数据，将您的图形数据存储在该类的实例中，然后将该对象作为发布数据传递给您的对话框或弹出窗口。

然后可以创建一种方法来处理自定义数据并相应地绘制图形。

# java - java中数组和3点（可变参数）之间的区别

> ID：11640507
> 
> 赞同：69
> 
> 时间：2012-07-24T22:58:18.153
> 
> 标签：java

我无法弄清楚`...`java和数组之间的区别还有数组列表，尤其是数组列表。

两者我们都可以无限使用，但`...`很少使用。

请帮助提前谢谢。

* * *

## 回答 #1

> 赞同：142
> 
> 时间：2012-07-24T23:03:49.093

这三个点只能在方法参数中使用，称为“可变参数”。这意味着您可以传入参数数组而无需显式创建数组。

`private void method(String[] args) {}`被称为`method(new String[]{"first", "second"});`

`private void method(String... args) {}`被称为`method("first", "second");`

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2012-07-24T23:01:04.067

*   [数组](http://docs.oracle.com/javase/tutorial/java/nutsandbolts/arrays.html)是固定长度的对象集合。例如`new int[5];`
*   An[`ArrayList`](http://docs.oracle.com/javase/7/docs/api/java/util/ArrayList.html)是可变长度的对象集合。例如`new ArrayList<Integer>();`
*   [可变参数函数](http://en.wikipedia.org/wiki/Variadic_function)`...`是表示参数数组的方法签名的一部分。例如`public void printLines(String... lines)`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-01-27T19:47:31.787

换句话说，method(String...) 意味着将可变数量的参数传递给方法。

# java - 有没有办法使用 Apache 的 HttpClient 获取网站的证书？

> ID：11640513
> 
> 赞同：0
> 
> 时间：2012-07-24T22:58:55.637
> 
> 标签：java, apache-httpclient-4.x

有没有办法使用 Apache 的 HttpClient (v4) 获取网站的证书详细信息？我可以使用 获取网站证书`javax.net.ssl.HttpsURLConnection.getServerCertificates()`，但我正在使用 Apache 的[HttpClient](http://hc.apache.org/httpcomponents-client-ga/index.html)进行连接，并希望使用相同的库。

我需要证书的颁发者、到期时间、算法等信息。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-25T08:56:54.763

```
DefaultHttpClient httpclient = new DefaultHttpClient();
httpclient.addRequestInterceptor(new HttpRequestInterceptor() {

    public void process(
            HttpRequest request, HttpContext context) throws HttpException, IOException {
        HttpRoutedConnection conn = (HttpRoutedConnection) context.getAttribute(
                ExecutionContext.HTTP_CONNECTION);
        SSLSession sslsession = conn.getSSLSession();
        if (sslsession != null) {
            // Do something useful with the SSL session details
            // and if necessary stick the result to the execution context
            // for further processing
            X509Certificate[] certs = sslsession.getPeerCertificateChain();
            for (X509Certificate cert: certs) {
                System.out.println(cert);
            }
        }
    }
});
HttpResponse response = httpclient.execute(new HttpGet("https://verisign.com/"));
EntityUtils.consume(response.getEntity()); 
```

希望这可以帮助。

# php - PHP在发送前替换html电子邮件变量中的令牌

> ID：11640517
> 
> 赞同：3
> 
> 时间：2012-07-24T22:59:38.853
> 
> 标签：php, token

我有一封电子邮件要发送给我网站的订阅者。我通过从我的数据库中获取订阅者列表并循环遍历数组并一次发送一封电子邮件来做到这一点......我知道有一种方法可以一次发送所有内容，但这就是我这样做的原因我需要帮助...

HTML 电子邮件包含 2 个令牌：

`{name}`和`{date}`

我需要做的是在 HTML 电子邮件中插入日期以替换`{date}`令牌并插入名称以替换`{name}`每个电子邮件发送的名称（因为名称总是不同的）。

这就是我所拥有的：

```
 $result = $wpdb->get_results( "SELECT * FROM wp_newsletter WHERE `id` IN ( $userIds )");
        for($i = 0, $size = sizeof($result); $i < $size; ++$i){
          add_filter('wp_mail_content_type',create_function('', 'return "text/html";'));
          $to .= $result[$i]->name.'<'.$result[$i]->email.'>';
          $mail = wp_mail( $to, $subject , $message, $headers);
        } 
```

正如您在上面看到的，我有两个来自数据库的变量：

`$result[$i]->name`

`$result[$i]->email`

并且`$message`是具有需要替换的 2 个令牌的 HTML 电子邮件正文。

所以....一切都按预期进行循环和发送我只需要一些帮助来了解如何为`{name}`and进行令牌替换`{date}`。

对此的任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T23:08:58.270

这可以通过 PHP 的`str_replace`函数轻松完成，[这里的文档](http://php.net/manual/en/function.str-replace.php)。

```
...
$message = str_replace('{name}', $result[$i]->name, $message);
$message = str_replace('{date}', date('Y/m/d H:i:s'), $message);  // Or your preferred date format

$mail = wp_mail( $to, $subject , $message, $headers); 
```

请注意，如果您知道只有一个实例`{name}`和/或`{date}`您可以将第四个参数传递`$count`给`str_replace`它，它将在替换第一个匹配项后退出。

干杯

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T23:02:39.350

```
$message = str_replace('{name}',$result[$i]->name,$message);
$message = str_replace('{date}',date('Y/m/d H:i:s'),$message); 
```

* * *

```
str_replace('{name}',$result[$i]->name);
str_replace('{date}',date('Y/m/d H:i:s')); 
```

# mysql - 将多个文件中的多条记录加载到mysql表中

> ID：11640519
> 
> 赞同：1
> 
> 时间：2012-07-24T22:59:50.340
> 
> 标签：mysql, ruby

我正在尝试将不同文件中的不同数据加载到 MySQL 中的多个列中。我不是一个大数据库人，所以也许我的数据结构错误。:)

这是我的设置方式：

```
DATABASE: mydb
TABLE:    aixserver1
COLUMNS:  os, hostname, num_users, num_groups, pkg_epoch

shown from mysql:

+---------------+-----------+------+-----+-------------------+----------------+
| Field         | Type      | Null | Key | Default           | Extra          |
+---------------+-----------+------+-----+-------------------+----------------+
| id            | int(11)   | NO   | PRI | NULL              | auto_increment |
| cur_timestamp | timestamp | NO   |     | CURRENT_TIMESTAMP |                |
| pkg_epoch     | int(11)   | NO   |     | NULL              |                |
| os            | char(5)   | YES  |     | NULL              |                |
| hostname      | char(40)  | YES  |     | NULL              |                |
| num_users     | int(10)   | YES  |     | NULL              |                |
| num_groups    | int(10)   | YES  |     | NULL              |                |
+---------------+-----------+------+-----+-------------------+----------------+ 
```

所以基本上我想将 pkg_epoch、os、hostname、num_users 和 num_groups 填充到数据库中。我要加载的数据在服务器上的 5 个平面文件中。我正在使用 ruby​​ 加载数据。

我的问题是如何一次将这些文件中的所有这些值加载到我的表中。如果我一次插入一个，那么其他记录将变为 NULL。IE，我只将数据加载到主机名列中，而该行的所有其他列都变为 NULL。

我错过了什么？:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T23:14:03.467

您可以通过几种方式做到这一点，但诀窍是使用变量占位符。这是一个使用数据库的 LOAD DATA 函数的示例：

```
LOAD DATA INFILE '/PATH/TO/FILE' IGNORE INTO TABLE tableName FIELDS TERMINATED BY '\t' LINES  
TERMINATED BY '\r' (@skip, @skip, @skip, login_name, pwd, @skip, @skip, @skip, @skip, @skip, first_name, last_name); 
```

你看我只是为我不想包含在数据库中的字段设置了一个变量@skip 或@anything 并命名了我想要的列。

* * *

我可以让你做到一半，但如果你用 Ruby 构建自己的加载器，我不确定最好的方法。我建议您检索文件并使用 LOAD DATA 让 MySQL 导入，因为它的性能非常好，您可以使用上面的技巧。

# ios - 有些图钉有时不会出现在 MKMapView 上……为什么？

> ID：11640522
> 
> 赞同：0
> 
> 时间：2012-07-24T23:00:06.653
> 
> 标签：ios, annotations, mkmapview

所以我有以下代码，它分割街道、城镇、州、国家、邮编并创建一个 AddressAnnotation，这是我从注释扩展而来的一个类。

有时所有图钉都显示在地图上，有时它找不到某些地方，尽管它每次都是完全相同地址的集合。谷歌地图有时但不是一直都能找到一个地方有什么原因吗？

它在我的代码中吗？

谢谢，R

```
for (int i=0; i < [places count]-1; ++i) {

    NSArray *arrayPlace = [[places objectAtIndex:i] componentsSeparatedByString:@"***"];

    AddressAnnotation *addAnnotation = [[AddressAnnotation alloc] initWithCoordinate:
                                        [self getLocationFromAddressString:
                                         [NSString stringWithFormat:
                                          @"%@ %@ %@ %@ %@ %@",
                                          [arrayPlace objectAtIndex:3],
                                          [arrayPlace objectAtIndex:4],
                                          [arrayPlace objectAtIndex:5],
                                          [arrayPlace objectAtIndex:6],
                                          [arrayPlace objectAtIndex:7],
                                          [arrayPlace objectAtIndex:8]]]];

    [addAnnotation setWebsite:[arrayPlace objectAtIndex:2]];
    [addAnnotation setTitle:[arrayPlace objectAtIndex:0]];
    [addAnnotation setSubtitle:[arrayPlace objectAtIndex:1]];

    [mapView addAnnotation:addAnnotation];
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T07:17:46.297

不应该像这样在第一行吗？

```
for (int i=0; i < [places count]; i++) { 
```

或者更好的是：

```
for (NSArray *arrayPlace in places) { 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-25T20:26:29.770

尝试记录您正在生成的地址字符串。如果它们始终相同，则查看 getLocationFromAddressString 并查看它返回的坐标是否始终相同。如果不是，则该功能有问题。我四处寻找该功能，但谷歌只是不断将我带回 StackOverflow。它是您自己的功能还是您使用了这个问题中的功能？[带地址的 MKMapView](https://stackoverflow.com/questions/3383250/mkmapview-with-address)

# colorbox - 如何为页面加载时不存在的元素替换jquery的live

> ID：11640524
> 
> 赞同：0
> 
> 时间：2012-07-24T23:00:11.247
> 
> 标签：colorbox, jquery

我在 stackexchange 和整个网络上看到了很多建议，建议我不要使用 jquery 的`live`功能。在这一点上，[它已被弃用](http://api.jquery.com/live/)，所以我想摆脱它。此外，我试图将我的 javascript 保存在一个地方（不显眼）——所以我没有把它放在页面底部。我不清楚如何重写代码以避免`live`页面上尚不存在的元素。

在我网站的 javascript 文件中，我有这样的内容：

```
 $(function() {
    $('button.test').live('click', function(){
      alert('test');
    });
 }); 
```

`.on(`不起作用，因为该元素尚不存在。

该按钮位于我在颜色框弹出模式窗口中加载的页面中。我不确定该颜色框窗口在 DOM 中的确切位置，但我认为它靠近顶部。

我可以使用委托并将其附加到文档中——但不使用它的重点不`live`就是避免这种情况吗？

`live`在这种情况下摆脱的最佳方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T23:02:12.750

您可以使用`.on()`- [http://api.jquery.com/on/](http://api.jquery.com/on/)

```
$(document).on("click", "button.test", function() {
    alert('test');
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T23:03:51.040

如果你使用 live()，你可以使用 die()。

您也可以使用 on() 和 off()。

他们做同样的事情，但建议使用它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-25T16:25:12.660

我最终在文档级别避免了两者`live`和附件。`on`就是这样：

将特定于页面中对象的所有 jquery 代码包装在函数中的颜色框窗口中，如下所示：

```
function cboxready(){
...
} 
```

包装在此函数中的代码可以直接附加到对象（而不是在文档级别附加），因为它只会在打开颜色框窗口后运行。

然后在附加颜色框时使用颜色框的回调调用此函数，如下所示：

```
$('a.cbox').colorbox({
    onComplete:function(){ cboxready(); }
}); 
```

# coffeescript - 让 Coffeescript 在 FOR 循环中创建局部变量

> ID：11640529
> 
> 赞同：19
> 
> 时间：2012-07-24T23:01:07.603
> 
> 标签：coffeescript

如何`dealViewItem`进入 FOR 循环的范围？目前，dealViewItem 的范围在它之外，我所有的事件侦听器都添加到最后一个 dealViewItem 中。

```
 for deal in dealArray
        dealViewItem = dealViewFactory.DealDetail(deal)
        dealViewItem.addEventListener 'click', ->
          dealCart.push(deal.dealId)
          dealViewItem.setAddedToCart()
          btnTakeDeals.setEnabled = true
        dealHolder.add(dealViewItem) 
```

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-07-24T23:06:23.077

这就是`do`关键字的用途。它将立即运行一个函数，并且任何与参数之一同名的局部变量都将被传递给它，从而确保正确的闭包范围。

```
for deal in dealArray
  do (deal) ->
    dealViewItem = dealViewFactory.DealDetail(deal)
    dealViewItem.addEventListener 'click', ->
      dealCart.push(deal.dealId)
      dealViewItem.setAddedToCart()
      btnTakeDeals.setEnabled = true
    dealHolder.add(dealViewItem) 
```

在此处查看已[编译的版本](http://coffeescript.org/#try:%20%20%20%20for%20deal%20in%20dealArray%0A%20%20%20%20%20%20do%20%28deal%29%20-%3E%0A%20%20%20%20%20%20%20%20dealViewItem%20=%20dealViewFactory.DealDetail%28deal%29%0A%20%20%20%20%20%20%20%20dealViewItem.addEventListener%20%27click%27,%20-%3E%0A%20%20%20%20%20%20%20%20%20%20dealCart.push%28deal.dealId%29%0A%20%20%20%20%20%20%20%20%20%20dealViewItem.setAddedToCart%28%29%0A%20%20%20%20%20%20%20%20%20%20btnTakeDeals.setEnabled%20=%20true%0A%20%20%20%20%20%20%20%20dealHolder.add%28dealViewItem%29)

* * *

`do`也可以在循环之外用于自执行功能。

```
#coffeescript
do ->
  foo = 'bar'

// javascript
(function() {
  var foo;
  return foo = bar;
})(); 
```

# python - pip freeze 列出已卸载的软件包

> ID：11640530
> 
> 赞同：5
> 
> 时间：2012-07-24T23:01:23.670
> 
> 标签：python, macos, osx-snow-leopard, pip

在 OS X 10.6.8 上，我使用 (至少 pip 告诉我) 卸载了一个包

```
sudo pip uninstall pkg_name 
```

但是当我这样做时，包裹仍然出现

```
pip freeze 
```

我尝试再次执行上面的卸载命令，并且 pip 告诉我该软件包未安装。

这里有什么问题？如何验证软件包是否已卸载？如果是这样，我可以刷新某种点子索引来纠正它吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-25T21:15:52.097

我以为你可能有两个`pip`二进制文件，当你运行 as 时`sudo`，你的 shell 首先选择了错误的一个。`sudo`但是，如果您再次运行它并`pip`删除该软件包，则没有任何意义。你是这样做的吗？

如果您没有两次运行**相同**`pip`的命令，则可能有不同的二进制文件运行卸载和冻结。检查以下两个命令是否产生相同的输出：

```
$ sudo pip freeze
# ... sudo output
$ pip freeze
# ... normal output 
```

无论如何，您可以使用以下命令检查软件包是否已安装：

```
$ python -c 'import pkg_name' &> /dev/null && echo installed || echo not installed 
```

中没有刷新功能`pip`。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-02-17T20:12:18.983

我遇到了同样的问题，这是由于卸载文件后自制软件的符号链接损坏。

```
$ pip freeze | grep Magic
Magic-file-extensions==0.2

$ pip uninstall Magic-file-extensions
# say `y` at prompt / see it go through as success

$ pip freeze | grep Magic # still there :(
Magic-file-extensions==0.2

$ ll /usr/local/lib/python2.7/site-packages/ | grep Magic # symlink shows up red
├── [lrwxr-xr-x tomfuert   98 Feb 16 11:06]  Magic_file_extensions-0.2-py2.7.egg-info -> ../../../Cellar/libmagic/5.17/lib/python2.7/site-packages/Magic_file_extensions-0.2-py2.7.egg-info

$ rm /usr/local/lib/python2.7/site-packages/Magic_file_extensions-0.2-py2.7.egg-info

$ pip freeze | grep Magic
# nothing! 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-05-07T13:32:08.417

如果您使用虚拟环境，请尝试使用 clean 命令。不要忘记须藤。

```
sudo pipenv clean 
```

# android - 触摸 ListView 下的空白区域

> ID：11640531
> 
> 赞同：1
> 
> 时间：2012-07-24T23:01:43.877
> 
> 标签：android

如何让空白空间（如果存在）监视触摸事件？

我不想要任何特殊区域，我只想将功能添加到 ListView 下的空白区域（如果它已经存在）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T23:21:47.467

将 :width 和 :height 设置为 listView 下方空间的空 LinearLayout 可以添加一个 onTouchListener，但会显示为空白。

# python - 如何获得特定列表元素的平均值

> ID：11640539
> 
> 赞同：3
> 
> 时间：2012-07-24T23:02:17.337
> 
> 标签：python, numpy

我有以下部分输入文件（超过 500 行）：

```
L1, a, b, 10, 20, pass,
L1, c, d, 11, 21, pass,
L1, e, f, 12, 22, pass,
L1, a, b, 13, 23, pass,
L1, e, f, 14, 34, pass, 
```

我想获得重复项的平均值，即输出如下：

（对于 L1，a，b，11.5 = (10+13)/2, 21.5 = (20+23)/2）

```
L1, a, b, 11.5, 21.5
L1, c, d, 11, 21
L1, e, f, 13, 28 
```

我目前的初学者 python 代码如下 - 仍在努力更好地调整它

```
 import csv
 from collections import defaultdict
 import numpy as np

 dd = defaultdict(list)
 with open("mean.csv") as input_file:
 for row in csv.reader(input_file):
            dd[tuple(row[:3])].append(float(row[3]))
            dd[tuple(row[:3])].append(float(row[4]))

 for k, v, m in dd.iteritems():
      if len(v) > 1:
           print (' '.join(k), np.mean(v), np.mean(m)) 
```

我得到的错误是：

```
 Traceback (most recent call last):
   File "average.py", line 11, in <module>
      for k, v, m in dd.iteritems():
   ValueError: need more than 2 values to unpack 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-24T23:15:41.857

未经测试，但像这样作为基础的东西可以适用于另一列......因为这只是目前的一个。

```
import csv
from collections import defaultdict
import numpy as np

dd = defaultdict(list)
with open('in.csv') as fin:
    for row in csv.reader(fin):
        dd[tuple(row[:3])].append(float(row[3]))

for k, v in dd.iteritems():
    if len(v) > 1:
        print ' '.join(k), np.mean(v) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-25T20:00:59.683

这样会很短（[`pandas`](http://pandas.pydata.org/)而且应该很快）。

你可以做这样的事情（不知道你的列的含义或命名，所以这取决于你想用什么作为你的索引`DataFrame`）：

```
In [1]: df = pd.read_csv('mean.csv', delimiter=',', header=None)

In [2]: df
Out[2]: 
  X.1 X.2 X.3  X.4  X.5
0  L1   a   b   10   20
1  L1   c   d   11   21
2  L1   e   f   12   22
3  L1   a   b   13   23
4  L1   e   f   14   34

In [3]: df.groupby(['X.1', 'X.2', 'X.3']).mean()
Out[3]: 
              X.4   X.5
X.1 X.2 X.3            
L1   a   b   11.5  21.5
     c   d   11.0  21.0
     e   f   13.0  28.0 
```

# java - 如何在休眠中配置连接超时？

> ID：11640540
> 
> 赞同：1
> 
> 时间：2012-07-24T23:02:20.777
> 
> 标签：java, hibernate

我正在使用 Hibernate v4.1.4.final.jar 使用 Java 1.7 连接到 Oracle 10g 服务器。这是一个独立的java程序。

不幸的是，我的查询需要 30 多分钟才能运行。我想知道在哪里可以配置连接超时和读取超时，以便在运行这个独立程序时，它不会超时并抛出错误？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-25T03:03:01.113

您可以尝试以下几个选项：

1.  如果您使用的 jdbc 驱动程序支持超时功能并且可以通过属性进行配置，那么您可以使用以下方式传递属性：`hibernate.connection.<propertyname>`
2.  使用***c3p0***或***DBCP***等外部连接提供程序，并根据外部提供程序支持控制超时。
3.  将您的休眠配置为使用`DataSource`而不是普通`Connection`并通过它控制超时。

[我能为Oracle 驱动程序](http://docs.oracle.com/cd/E14072_01/appdev.112/e13995/oracle/jdbc/pool/OracleDataSource.html#getConnectionProperties__)找到的最接近的属性是`oracle.jdbc.ReadTimeout`属性。所以在你的休眠配置中，全名将是`hibernate.connection.oracle.jdbc.ReadTimeout`..希望这对你有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-02-08T19:56:08.627

默认情况下，它不会抛出任何类型的错误，FWIW ...如果您运行查询，它就会正常工作，AFAIK。

在连接超时方面，您可以在您的

`hibernate.connection.url`您的数据库的特定选项，例如：我要[添加的 Postgres](https://jdbc.postgresql.org/documentation/94/connect.html) `&connectTimeout=0`

# php - 良好、可靠的 PHP DOM 文档

> ID：11640543
> 
> 赞同：1
> 
> 时间：2012-07-24T23:02:24.240
> 
> 标签：php, dom

我一直在尝试对 HTML 文档进行一些简单的 DOM 解析，并且对它的难度感到非常震惊。

我研究了 PHP 的 DOM 类的许多替代方案中的一些（例如[简单的 xml 解析器](http://us3.php.net/manual/en/ref.simplexml.php)和[简单的 HTML DOM](http://simplehtmldom.sourceforge.net/)）。我也发现了一个非常有效的[dom2array 函数](http://www.php.net/manual/en/book.dom.php#93717)，它对于非常基本的解析非常有用，你只需要元素的原始值。

但是，这些替代方案都没有真正令人信服。

[DOM 的 PHP 文档](http://www.php.net/manual/en/book.dom.php)通常缺乏详细信息并且在很大程度上没有用处。很多评论实际上真的很有帮助。

我在网上找到的教程通常只涵盖非常非常基础的内容，例如编写 20 行 XML 文档或解析文档中的所有 p 标记。嗯。

是否有任何网站（或书籍）专门针对使用 PHP 的 DOM 库处理 DOM 进行了详细介绍？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T23:05:44.867

DOM 是一个独立于语言的接口，[由 W3C 详细记录](http://www.w3.org/TR/DOM-Level-2-Core/core.html)。

话虽如此，如果您的目标是非常简单地解析（通常）结构化信息，那么 XML 可能一开始就不是正确的格式；XML 包括各种高级特性（命名空间、DTD、XSLT、属性和文本之间的区别、标记而不是结构化信息）。如果是这种情况，请考虑[JSON](http://json.org/)，它[非常容易解析](http://php.net/manual/en/function.json-decode.php)和[生成](http://php.net/manual/en/function.json-encode.php)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T23:05:35.147

任何名称中包含“DOM”或声称支持它的东西都应该支持[W3C 定义的 DOM API](http://www.w3.org/DOM/)，并且您应该认为它们的文档对于除语言特定部分之外的所有内容都是规范的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-01T19:30:02.023

我应该将我的帖子命名为“在 PHP 中解析 HTML DOM 的最简单方法”。我知道，“最简单”不是一个很好的词。这一切都与你想要做的事情有关。我正在做的事情非常简单。我想解析独立的 HTML 文档并在不同的上下文中呈现内容。

这些是我想做的事情：

*   解析标题和正文等基本属性
*   更改所有文件引用（图像、链接、css、js）以指向有效位置
*   从标签中添加/删除属性（这里处理 1995 HTML）
*   剥离内联样式

我最终选择了[Simple HTML DOM Parser](http://simplehtmldom.sourceforge.net/)

它的学习曲线非常小，并且可以轻松地对 DOM 进行读/写访问。故事结局。不过，有时它似乎确实会卡住嵌套元素。

# android - Android AutoCompleteTextView 在项目选择上崩溃（仅在 HTC Thunderbolt 上）

> ID：11640547
> 
> 赞同：2
> 
> 时间：2012-07-24T23:02:47.683
> 
> 标签：android, autocomplete, autocompletetextview, htc-android

最近从我正在开发的一个 android 应用程序中遇到了一个非常奇怪的错误。

应用程序的一部分有一个地图视图，其中包含显示为 AutoCompleteTextView 的位置列表。在我测试的每台设备和模拟器上，此功能都按预期执行。但是，每当使用 HTC Thunderbolt 手机（运行 2.3.4）的用户尝试选择列表中的项目时，应用程序就会崩溃。

这是我收到的错误报告中的堆栈跟踪：

```
java.lang.NullPointerException 
at com.package.my.e.onItemClick(Unknown Source) 
at android.widget.AutoCompleteTextView.performCompletion(AutoCompleteTextView.java:1022) 
at android.widget.AutoCompleteTextView.access$1300(AutoCompleteTextView.java:99) 
at android.widget.AutoCompleteTextView$DropDownItemClickListener.onItemClick(AutoCompleteTextView.java:1597) 
at android.widget.AdapterView.performItemClick(AdapterView.java:284) 
at android.widget.ListView.performItemClick(ListView.java:3561) 
at android.widget.AbsListView$PerformClick.run(AbsListView.java:1812) 
at android.os.Handler.handleCallback(Handler.java:587) 
at android.os.Handler.dispatchMessage(Handler.java:92) 
at android.os.Looper.loop(Looper.java:143) 
at android.app.ActivityThread.main(ActivityThread.java:4306) 
at java.lang.reflect.Method.invokeNative(Native Method) 
at java.lang.reflect.Method.invoke(Method.java:507) 
at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839) 
at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597) 
at dalvik.system.NativeStart.main(Native Method) 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-12T01:51:07.517

这是我在 Thunderbolt 上执行 Autocompletetextview 时得到的结果。白色建议字段仅在您按下它们时显示建议。所以看起来 actv 和 Thunderbolt 是一个糟糕的组合。 ![在此处输入图像描述](../Images/fbba4058b9cdf24382020dbd74facb75.png)

# ruby-on-rails - 在 Rails 控制器中多次保存

> ID：11640552
> 
> 赞同：0
> 
> 时间：2012-07-24T23:03:13.627
> 
> 标签：ruby-on-rails, ruby, ajax

从我的客户，我正在发送一个与其他对象相关的对象：

```
变量数据 = {
  “评论”：result.comment，
  “文档”：{
    “id”：结果.doc.id
  }
  “地点”： {
    “网址”：result.site.url
  }
};

$.ajax({
  网址：'/数据'，
  类型：'POST'，
  数据：数据
});

```

这将发布到我的`/data`控制器。在`create`方法中，我有这段代码：

```
定义创建
  @data = Data.new(params[:data])
  @data.user_id = current_user.id

  respond_to 做 |格式|
    如果@data.save
      @doc = Doc.find_or_create_by_id(params[:doc])
      @doc.save
      @site = Site.new(params[:site])
      @site.doc_id = @doc.id
      @site.save

      format.html //东西
      format.json //东西
      format.js //东西
  结尾
结尾

```

我很好奇我是否正确地解决了这个问题。对于像我这样的相关对象，控制器似乎很“重”。

这个问题还有其他解决方案吗？

**编辑：**

数据模型：

```
类数据
  属于_to :site, :polymorphic => true
  属于_to：用户
结尾

```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T23:28:58.950

您的数据模型如何？你有所有嵌套属性的赋值方法吗？

```
def create
  @data = Data.new(params[:data])
  @data.user = current_user

  respond_to do |format|
    if @data.save
      @doc = Doc.find_or_create_by_id(params[:doc][:id]) 
      @site = @doc.sites.create(params[:site])

      format.html //stuff
      format.json //stuff
      format.js //stuff
  end
end 
```

[您可以在Rails 指南](http://guides.rubyonrails.org/association_basics.html#why-associations)中查看有关 Active Record 关系的更多详细信息。

# php - PHP 中的视网膜图像

> ID：11640558
> 
> 赞同：0
> 
> 时间：2012-07-24T23:03:35.340
> 
> 标签：php, retina-display

假设我正在将一张 1600x1200 像素的图片上传到网络服务器，并且我想“构建”图像本身的视网膜版本。

在代码中：

```
$imageRetina = renameForRetina($originalImage);
$imageNormal = halfResize($originalImage); 
```

可以将原始版本保留为“视网膜版本”，将半尺寸版本保留为“非视网膜”，或者我应该处理图像分辨率、dpi 等……以实现我的目标并拥有“视网膜”质量?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T23:07:43.350

调整大小（向下，以获得非视网膜）应该就足够了。至少对于我的 iOS 应用程序而言。不确定您的情况是什么，但可能没有人会注意到。

**编辑**：根据您的评论（您想添加 @2x 后缀），我猜您的目的确实是 iOS 开发。所以，是的，缩小它应该没问题 - 它对我有用。

# javascript - 在自定义标记悬停时显示工具提示

> ID：11640564
> 
> 赞同：8
> 
> 时间：2012-07-24T23:03:46.110
> 
> 标签：javascript, google-maps

我有以下谷歌地图测试：http: [//jsfiddle.net/gM6Z6/](http://jsfiddle.net/gM6Z6/)

如您所见，它获取您的位置，然后使用三个标记在地图上显示它。

我想要做的是当用户将鼠标悬停在三个标记中的任何一个上时，我想在标记头像上显示以下工具提示 NEXT：

```
var tooltipOptions={
    marker:marker,
    content: "You're here!",
    cssClass:'tooltip'
};
var tooltip = new Tooltip(tooltipOptions); 
```

我不确定如何最好地做到这一点，因为我需要它适用于所有三个标记，并且无论哪个标记悬停在同一位置。**它应该总是出现在头像旁边，就像下面的四方形屏幕截图一样，但应该根据屏幕上图标的位置向左或向右移动以使其适合。**

![在此处输入图像描述](../Images/fc56b6a8223f205134d2849537d321aa.png)

任何人都可以帮忙吗？由于文档对我的喜好有点模糊......我可以创建工具提示，但我很困惑如何最好地为所有三个标记显示它，但在相同的位置和视口感知。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-27T17:35:37.343

干得好：

[http://jsfiddle.net/nickaknudson/KVa2d/](http://jsfiddle.net/nickaknudson/KVa2d/)

```
tooltip = new Tooltip("text");
...
tooltip.open(map, marker); 
```

可通过 CSS 自定义。

**更新**

注释代码：http: [//jsfiddle.net/nickaknudson/KVa2d/12/](http://jsfiddle.net/nickaknudson/KVa2d/12/)

**更新 2**

删除了不必要的位：http: [//jsfiddle.net/nickaknudson/KVa2d/14/](http://jsfiddle.net/nickaknudson/KVa2d/14/)

```
//========================
// Tooltip Class Definition
//   extends OverlayView:
//   https://developers.google.com/maps/documentation/javascript/reference#OverlayView
//========================
var Tooltip
Tooltip = function(tip) {
    this.tip = tip;
    this.buildDOM();
};

$.extend(Tooltip.prototype, google.maps.OverlayView.prototype, {

    // build the DOM
    buildDOM: function() {
        // Body DIV
        this.bdiv = $("<div></div>").addClass('WindowBody').html(this.tip);
        // Window DIV
        this.wdiv = $("<div></div>").addClass('Window').append(this.bdiv);
        // Shadow DIV
        this.sdiv = $("<div></div>").addClass('WindowShadow');
        // Start Closed
        this.close();
    },

    // API - onAdd
    onAdd: function() {
        $(this.getPanes().floatPane).append(this.wdiv);
        $(this.getPanes().floatShadow).append(this.sdiv);
    },

    // API - onRemove
    onRemove: function() {
        this.wdiv.detach();
        this.sdiv.detach();

    },

    // API - draw
    draw: function() {
        var pos, left, top;
        // projection is accessible?
        if (!this.getProjection()) return;
        // position is accessible?
        if (!this.get('position')) return;
        // convert projection
        pos = this.getProjection().fromLatLngToDivPixel(this.get('position'));
        // top offset
        top = pos.y - this.getAnchorHeight() / 2;
        // left offset
        if (this.getMap().getCenter().lng() > this.get('position').lng()) {
            left = pos.x + this.wdiv.width() * 0.5;
        } else {
            left = pos.x - this.wdiv.width() * 1.5;
        }
        // window position
        this.wdiv.css('top', top);
        this.wdiv.css('left', left);
        // shadow position
        this.sdiv.css('top', (top - this.getAnchorHeight() / 2));
        this.sdiv.css('left', left);
        // shadow size
        this.sdiv.width(this.wdiv.width());
        this.sdiv.height(this.wdiv.height());
    },

    // open Tooltip
    open: function(map, anchor) {
        // bind to map
        if (map) this.setMap(map);
        // bind to anchor
        if (anchor) {
            this.set('anchor', anchor);
            this.bindTo('anchorPoint', anchor);
            this.bindTo('position', anchor);
        }
        // need to force redraw otherwise it will decide to draw after we show the Tooltip                    
        this.draw();
        // show tooltip
        this.wdiv.show();
        this.sdiv.show();
        // set property
        this.isOpen = true;
    },

    // close Tooltip
    close: function() {
        // hide tooltip
        this.wdiv.hide();
        this.sdiv.hide();
        // set property
        this.isOpen = false;
    },

    // correctly get the anchorPoint height
    getAnchorHeight: function() {
        // See: https://developers.google.com/maps/documentation/javascript/reference#InfoWindow
        //   "The anchorPoint is the offset from the anchor's position to the tip of the InfoWindow."
        return -1 * this.get('anchorPoint').y;
    }
}); 
```

**更新 3**

使用 outerWidth() 和 outerHeight() 更好地定位以考虑边框等。删除了阴影 div。

[http://jsfiddle.net/nickaknudson/KVa2d/16/](http://jsfiddle.net/nickaknudson/KVa2d/16/) ​</p>

```
//========================
// Tooltip Class Definition
//   extends OverlayView:
//   https://developers.google.com/maps/documentation/javascript/reference#OverlayView
//========================
var Tooltip
Tooltip = function(tip) {
    this.tip = tip;
    this.buildDOM();
};

$.extend(Tooltip.prototype, google.maps.OverlayView.prototype, {

    // build the DOM
    buildDOM: function() {
        // Window DIV
        this.wdiv = $("<div></div>").addClass('Window').append(this.tip);
        // Start Closed
        this.close();
    },

    // API - onAdd
    onAdd: function() {
        $(this.getPanes().floatPane).append(this.wdiv);
    },

    // API - onRemove
    onRemove: function() {
        this.wdiv.detach();
    },

    // API - draw
    draw: function() {
        var pos, left, top;
        // projection is accessible?
        if (!this.getProjection()) return;
        // position is accessible?
        if (!this.get('position')) return;
        // convert projection
        pos = this.getProjection().fromLatLngToDivPixel(this.get('position'));
        // top offset
        top = pos.y - this.getAnchorHeight() / 2 - this.wdiv.outerHeight()/2;
        // left offset
        if (this.getMap().getCenter().lng() > this.get('position').lng()) {
            left = pos.x + this.wdiv.outerWidth() * 0.3;
        } else {
            left = pos.x - this.wdiv.outerWidth() * 1.3;
        }
        // window position
        this.wdiv.css('top', top);
        this.wdiv.css('left', left);
    },

    // open Tooltip
    open: function(map, anchor) {
        // bind to map
        if (map) this.setMap(map);
        // bind to anchor
        if (anchor) {
            this.set('anchor', anchor);
            this.bindTo('anchorPoint', anchor);
            this.bindTo('position', anchor);
        }
        // need to force redraw otherwise it will decide to draw after we show the Tooltip                    
        this.draw();
        // show tooltip
        this.wdiv.show();
        // set property
        this.isOpen = true;
    },

    // close Tooltip
    close: function() {
        // hide tooltip
        this.wdiv.hide();
        // set property
        this.isOpen = false;
    },

    // correctly get the anchorPoint height
    getAnchorHeight: function() {
        // See: https://developers.google.com/maps/documentation/javascript/reference#InfoWindow
        //   "The anchorPoint is the offset from the anchor's position to the tip of the InfoWindow."
        return -1 * this.get('anchorPoint').y;
    }
});​ 
```

**资源**

*   [从我的 GoogleMapsiPhoneWindow 修改](https://github.com/nickaknudson/google-maps-window-iphone)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-27T00:39:27.483

您可以使用 mouseover 事件来显示您的工具提示。[（请参阅此处](https://developers.google.com/maps/documentation/javascript/events)的事件文档）。您只需为 marker2 显示它，因为它具有最高的 zIndex 值。

```
google.maps.event.addListener(marker2, 'mouseout', function() {
}); 
```

[这是一个使用](http://jsfiddle.net/chrish/BPr8d/)[InfoWindow](https://developers.google.com/maps/documentation/javascript/overlays#InfoWindows)显示工具提示的 jsFiddle 。您的示例中没有工具提示代码。您可以使用您创建的工具提示更新您的示例吗？

# java - 安卓开发。我无法处理的错误

> ID：11640570
> 
> 赞同：0
> 
> 时间：2012-07-24T23:04:15.080
> 
> 标签：java, android

我最近刚开始学习android，我正在尝试编写一个程序，但总是有不同的错误，所以我试图重写它并得到另一个错误和它的开头。我知道这个问题是“新手”，但如果你能帮助我，那就太好了。aso，这就是交易：它有点像一个游戏，我创建了从 SurfaceView 扩展的类，它实现了 SurfaceHolder.Callback 和一个我可以做所有事情的线程，但是虽然线程的 start 方法什么都不做，但我发现了一个错误。这是我的项目：[https](https://dl.dropbox.com/u/22326796/Aquarium.7z) ://dl.dropbox.com/u/22326796/Aquarium.7z 这是一些基本代码：

```
<?xml version="1.0" encoding="utf-8"?>
<FrameLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent">

    <com.skeeve.aquarium.AquariumView
        android:id="@+id/aquarium" 
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"        
        android:background="@drawable/aquarium"/>
</FrameLayout>
public class AquariumView extends SurfaceView implements SurfaceHolder.Callback {

private SurfaceHolder surfaceHolder;
private AquariumManager manager;

public AquariumView(Context context) {
    super(context);

    surfaceHolder = getHolder();
    surfaceHolder.addCallback(this);
    manager = new AquariumManager(surfaceHolder, context);      
}

public class AquariumActivity extends Activity {
/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    requestWindowFeature(Window.FEATURE_NO_TITLE);
    setContentView(R.layout.main);
} 
```

}

日志文件：[https ://dl.dropbox.com/u/22326796/log.txt](https://dl.dropbox.com/u/22326796/log.txt)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T23:36:54.850

您的错误在您的构造函数中（AquariumView.java）

改变 ：

```
public AquariumView(Context context) {
     super(context); 
```

经过：

```
 public AquariumView(Context context, AttributeSet attrs) {
     super(context, attrs); 
```

# android - 混淆使用 Spring for Android 的 Android 应用程序的问题

> ID：11640571
> 
> 赞同：0
> 
> 时间：2012-07-24T23:04:15.870
> 
> 标签：android, spring, proguard

我在我的应用程序中使用 Spring for Android，我正在尝试使用 Proguard 进行混淆/优化/缩小。我在运行时遇到以下异常：

> 原因：org.springframework.web.client.RestClientException：无法写入请求：在 org.springframework.web.client 上找不到请求类型 [com.mycompany.myproduct.AuthenticateRequest] 和内容类型 [application/json] 的合适 HttpMessageConverter .RestTemplate$HttpEntityRequestCallback.doWithRequest(RestTemplate.java:610) 在 org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:449) 在 org.springframework.web.client.RestTemplate.execute(RestTemplate.java:414 ) 在 org.springframework.web.client.RestTemplate.exchange(RestTemplate.java:390)

我猜`-keep`我的 proguard.cfg 文件中有一些我需要的东西，但我似乎无法弄清楚它们可能是什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T22:29:50.413

在我的 proguard.cfg 文件中，我添加了以下内容，并且成功了：

```
-keep class org.springframework.** { *; }
-keep class org.codehaus.jackson.** { *; } 
```

# json - 使用 JSON、AJAX 和 JQuery 的动态图像加载和事件绑定

> ID：11640573
> 
> 赞同：0
> 
> 时间：2012-07-24T23:04:58.657
> 
> 标签：json, jquery, dynamic

我想动态地将图像添加到我的网站。当用户单击按钮时，通过 jquery 对服务器进行 ajax 调用，返回一个包含图像 url 和 ids 的 json 文件。我想在我的网页上呈现这些图像，然后更改它们的样式（根据某些条件显示），然后将点击事件添加到这些图像（单个事件处理程序将捕获引发事件的图像的 id）。请帮我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T23:10:12.233

您可以按如下方式创建图像元素。

```
var img=document.createElement("img");
img.onclick=function() { /* js code here*/ };
img.src="http://example.com/example.jpg";
img.style.display="block";
/* or give css class, image.className="picture" */ 
```

然后附加在名为“imagecontainer”的div中的某个位置，例如 `<div id="imagecontainer">`

```
document.getElementById("imagecontainer").appendChild(img); 
```

然后完成:)

ps你没有ajax代码吗？这个 url 将对您有所帮助，只需将此代码附加到示例代码中，然后完成。[http://api.jquery.com/jQuery.getJSON/](http://api.jquery.com/jQuery.getJSON/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T23:17:17.887

像这样的东西：

**HTML**

```
<img id="15623" src="img/default.jpg" /> 
```

**jQuery**

```
$('img').click(function () {
    var context = $(this);
    $.getJSON('/getImage.php?id=' + $(this).attr('id'), function (json) {
        context.attr('src', json.url);
    });
}); 
```

**PHP**

```
//db connection

$id = $_GET['id'];

if (is_numeric($id)) {
    $query = mysql_query('SELECT url FROM img WHERE id = '.$id);
    $res = mysql_result($query, 0);
    return '{"url": "'.$res.'"}';
} 
```

# codeigniter - facebook sdk 3登录codeigniter - 发生错误

> ID：11640574
> 
> 赞同：0
> 
> 时间：2012-07-24T23:05:02.343
> 
> 标签：codeigniter, sdk, facebook-login

我正在使用 codeigniter 2.1.2 和 facebook api php sdk 3.1.1（最新版本）我使用了[这个链接的方式](https://stackoverflow.com/questions/9454238/using-facebook-php-sdk-3-x-to-register-login-user-with-codeigniter-2-1-0?answertab=votes#tab-top)

存在于答案中。但是当我尝试登录时，它只对我有用（当我使用我的 Facebook 帐户时）。否则当有人尝试登录时会出现此消息：

‏<strong>登录网站时出错。请稍后再试。‏</strong>

这是我网站上的链接： [http ://www.tahainshad.com/login4](http://www.tahainshad.com/login4)

这些是我的应用程序设置..

![在此处输入图像描述](../Images/ba72dcda97402abe1fcc2bd2cdb31cae.png)

![在此处输入图像描述](../Images/0c3426c17513ac9f1b5e80d0395efa5c.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T04:17:23.560

您必须添加`tahainshad.com`到**应用程序域**字段。提供顶级域就足够了，facebook 将接受重定向到该域的任何子域（如 www.）。

# jquery - jQuery 序列化数组语法

> ID：11640575
> 
> 赞同：0
> 
> 时间：2012-07-24T23:05:12.790
> 
> 标签：jquery, json, asp.net-mvc-3

通过序列化我的一个 JavaScript 对象创建的 POST 字符串在发布到我的网页时如下所示：

`bikeID=1&vehicleID=23&VIN=1HD1FB416AB666666&slotNum=0&alias=Betsy&BikeCustomizations[0][ CustomizationTypeID] =1&BikeCustomizations[0][ ManufacturerID] =4&BikeCustomizations[0][ CustomizationSubTypeID] =1&BikeCustomizations[1][ CustomizationTypeID] =2&BikeCustomizations[1][ ManufacturerID] =-1`

这已发布到我的 ASP.NET MVC 3 应用程序。我得到了基本属性“bikeID，并且我得到了正确数量的项目`BikeCustomizations`（在这种情况下为 2），但这些对象没有值。

如果我更改 POST 字符串并重新发布（使用 Fiddler）到下面，反序列化工作正常：

`bikeID=1&vehicleID=23&VIN=1HD1FB416AB666666&slotNum=0&alias=Betsy&BikeCustomizations[0].CustomizationTypeID=1&BikeCustomizations[0].ManufacturerID=4&BikeCustomizations[0].CustomizationSubTypeID=1&BikeCustomizations[1].CustomizationTypeID=2&BikeCustomizations[1].ManufacturerID=-1`

你可以看到区别是`BikeCustomizations[1][ CustomizationTypeID] =2`vs `BikeCustomizations[1].CustomizationTypeID=2`。

问题：有没有办法强制对象的字符串化不使用时髦的数组样式属性设置器语法？

这是创建对象的 JavaScript：

```
Cust.buildBike = function (bikeObj) {
if (bikeObj != undefined)
    this.bike = bikeObj;
else
    this.bike = { bikeID: -1 };

this.bike.BikeCustomizations = new Array();
var that = this;

$.each(this.customizationsArr, function (key, obj) {
    if (obj == undefined)
        return true;

    var typeID = obj.ID,
        SubTypeID = obj.SubTypeID,
        ManufacturerID = obj.ManufacturerID,
        Model = obj.Model;

    if (ManufacturerID == -1)
        SubTypeID = undefined;

    that.bike.BikeCustomizations.push({
        CustomizationTypeID: typeID,
        ManufacturerID: ManufacturerID,
        CustomizationSubTypeID: SubTypeID,
        Model: Model
    });
});

return this.bike;
}

...

$('#customizationPageNext').click(function () {
var data = Cust.buildBike(bikeObj);

$.mobile.changePage('/Selection/Calibrations/', { data: data });
}); 
```

# html - 跳过 HTML 表格

> ID：11640581
> 
> 赞同：11
> 
> 时间：2012-07-24T23:05:54.230
> 
> 标签：html, html-table

假设我有下表：

```
<table>
  <tr>
    <td>Example</td>
    </td>One</td>
  </tr>
  <tr>
    <td>Example</td>
    </td>Two</td>
  </tr>
  <tr>
    <td>Example</td>
    </td>Three</td>
  </tr>
  <tr>
    <!--
    Here I want to skip the first <td> cell; use only second. Example:
    <td>(empty, possibly &nbsp;)</td>
    <td>blah blah blah</td>
    -->
  </tr>
</table> 
```

如果您在最后一行阅读我的评论，您可以看到在最后一行中我想在表格的第二列中显示一些内容，第一列保持空白。我该怎么做呢？

作为旁注，我阅读了[这个 SO question](https://stackoverflow.com/questions/2506342/is-it-good-to-put-a-nbsp-inside-an-empty-td)中的问题/答案，但 colspan 与我想要的不同。我也不熟悉css `empty-cell`，所以如果这是一个解决方案，请提供一些示例代码。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-24T23:20:11.837

HTML

```
<tr>
   <td></td>
   <td>content here</td>
</tr> 
```

CSS

`table { empty-cells: show;}`

留下`<td>`空的，没有理由在里面放一个空间。`&nbsp;`有时会表现得有点滑稽，尤其是在桌子上。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-07-24T23:11:09.893

我看不出有任何理由不完全按照您的建议行事：使用一个空单元格，其中仅包含一个`&nbsp;`（“ *No Break Space* ”）：

```
<tr>
    <td>&nbsp;</td>
    <td>Whatever</td>
</tr> 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-24T23:09:49.623

CSS 代码：

```
table { empty-cells: show; } 
```

或者，您也可以插入`&nbsp;`.`<td>`

# c# - 如何使用 API 查找给定错误的 TFS 测试用例数量

> ID：11640585
> 
> 赞同：3
> 
> 时间：2012-07-24T23:06:37.257
> 
> 标签：c#, api, tfs

我正在尝试使用 TFS API 扫描我所有的错误工作项，并查看是否有任何没有关联的测试用例。我正在考虑使用`bug.Fields[26].Value == 0`来查看有多少相关链接，但我不确定测试用例是否是唯一被视为相关链接的东西。

如果没有与该错误相关的测试用例，我想为它创建一个测试用例。我已经知道如何创建一般的测试用例，但不知道与现有错误相关联的测试用例。

有人可以告诉我如何做这些事情吗？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-25T08:50:35.987

任何链接到您的 Bug 的工作项都被视为`RelatedLink`. [在此处](http://msdn.microsoft.com/en-us/library/microsoft.teamfoundation.workitemtracking.client.link%28v=vs.100%29.aspx)查看派生自@bryanmac 的此 SO-post 的`Link`可用[类型](https://stackoverflow.com/a/8669341/728929)。

通过以下内容，您应该能够检索错误 123456 的每个相关工作项的类型。

```
using System;
using Microsoft.TeamFoundation.Client;
using Microsoft.TeamFoundation.WorkItemTracking.Client;

namespace WorkItemLinksOfAWorkItem
{
    class Program
    {
        static void Main()
        {
            TfsTeamProjectCollection teamProjectCollection = TfsTeamProjectCollectionFactory.GetTeamProjectCollection(new Uri("http://TFSURI"));

            var workItemStore = (WorkItemStore)teamProjectCollection.GetService(typeof(WorkItemStore));

            var workItem = workItemStore.GetWorkItem(123456);
            LinkCollection links = workItem.Links;
            foreach (Link link in links)
            {
                if (!(link is RelatedLink))
                    continue;

                var relLink = link as RelatedLink;
                var relatedWI = workItemStore.GetWorkItem(relLink.RelatedWorkItemId);
                Console.WriteLine(relatedWI.Id+" "+relatedWI.Type.Name);
            }
        }
    }
} 
```

（我最初是在[Scrum Dashboard](https://scrumdashboard.codeplex.com/)中找到这些资源的基础）

为了为您的错误 123456 生成新的测试用例，您可以尝试以下操作：

```
var workItemTypes = workItemStore.Projects["TeamProjectName"].WorkItemTypes;
var workItem = new WorkItem(workItemTypes["Test Case"]) {Title = "Programmatically constructed via TFS-SDK"};

var relatedLinkToBug = new RelatedLink(123456);
var links = workItem.Links;
links.Add(relatedLinkToBug);

workItem.Save(); 
```

# c++ - QTreeView - 删除某些元素的可扩展外观

> ID：11640586
> 
> 赞同：2
> 
> 时间：2012-07-24T23:06:45.607
> 
> 标签：c++, qt, qtreeview, qfilesystemmodel

我想删除 QTreeView 中某些元素的可扩展属性（填充从 QFileSystemModel 继承的模型）。我可以在它们展开后轻松折叠这些元素，但它们在 QTreeView 中仍然可见为可展开的。我怎样才能将它们显示为不可扩展的？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-07-25T02:51:28.867

我相信您只需要覆盖派生类中的默认行为即可在`rowCount`您不想扩展的行`QFileSystemModel`中返回零行。`QModelIndex`

请参阅[http://qt-project.org/doc/qt-5.0/model-view-programming.html#models](http://qt-project.org/doc/qt-5.0/model-view-programming.html#models)特别是树模型图。

# teechart - x64 的构建错误

> ID：11640588
> 
> 赞同：0
> 
> 时间：2012-07-24T23:07:05.850
> 
> 标签：teechart

使用旧版本（v3）构建项目没有问题，其中只有一组 dll，并且项目目标设置设置为“任何 CPU”。它适用于 x86 和 x64 构建，并且在 Win32 和 Win64 机器上运行良好。

下载并想尝试最新的 Teechart 2012 版本 (4.1.2012.7136) 现在 Steema 提供 x64 和 x86 dll，我想使用优化的 x64 dll

问题1：我的理解正确吗？为什么在较新版本中有两个版本的 TeeChart dll？

构建测试 1：使用新的 x64 TeeChart dll 构建 x64 项目 将 dll 从文件夹 C:\Program Files (x86)\Steema Software\Steema TeeChart for .NET 2012\net35\x64\ 复制到项目文件夹。这是因为我想用 x64 dll 构建

构建 x64 构建时出现 2 种构建错误：Error1 'Could not load file or assembly 'TeeChart, Version=4.1.2012.7136, Culture=neutral, PublicKeyToken=9c8126276c77bdb7' 或其依赖项之一。试图加载格式不正确的程序。

错误 2：'无法加载文件或程序集'TeeChart，版本 = 3.5.3225.32185，文化 = 中性，PublicKeyToken = 9c8126276c77bdb7'或其依赖项之一。无效的指针（来自 HRESULT 的异常：0x80004003 (E_POINTER)）'

问题 2：我需要更新项目中的所有 licenses.licx 文件吗？我知道这些是在添加 TChart 时自动生成的？当我只是更新 TeeChart 库时，我该如何处理？

问题3：为什么会出现两种不同的错误？所有 licenses.licx 当前都有包含 Version=3.5.3225.32185 的文本。我尝试手动将所有 licenses.licx 文件更新到较新版本，但没有帮助。

构建测试 2：使用新的 x86 TeeChart dll 构建 x64 项目 将 dll 从文件夹 C:\Program Files (x86)\Steema Software\Steema TeeChart for .NET 2012\net35\x86\ 复制到项目文件夹。

一切都构建良好并且运行良好

问题 4：如何在没有更新项目中的 licenses.licx 文件的情况下构建良好？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T15:07:20.890

> > 除了复制程序集之外，您是否更新了项目中的 TeeChart.dll 引用？您可以尝试将其删除并将其分配给 x64 程序集。

我正在复制现有的 dll，那么为什么我会对项目中的引用有问题。无论如何，我尝试删除引用并将它们添加回来只是为了它，但这并没有使错误消失。我最终在项目引用中添加了 x86 dll，并且当然更新了 licenses.licx 以指向较新的版本，并且它可以很好地构建 x64 构建。但是，为了对 x64 框进行全面优化，我将 x64 dll 复制到应用程序文件夹中。它运行良好。

这解决了两个问题：

1：Visual Studio 设计器需要 x86 dll，因此如果我们想使用设计器对 UI 进行任何更改，则不能在项目引用中引用 x64 dll。

2：修复了如前所述的许可证编译器的构建错误。

现在我在想错误' ****无法加载文件或程序集'TeeChart，版本= 4.1.2012.7136，Culture=neutral，PublicKeyToken=9c8126276c77bdb7'或其依赖项之一。尝试加载格式不正确的程序**** " 是真实的，因为它来自许可证编译器，就像设计器一样，它在项目引用中需要 x86 dll。

你怎么看？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T11:11:57.787

> 问题1：我的理解正确吗？为什么在较新版本中有两个版本的 TeeChart dll？

这就是将所有关于可能的环境组合的选项留给用户。

> 构建测试 1：使用新的 x64 TeeChart dll 构建 x64 项目 将 dll 从文件夹 C:\Program Files (x86)\Steema Software\Steema TeeChart for .NET 2012\net35\x64\ 复制到项目文件夹。这是因为我想用 x64 dll 构建
> 
> 构建 x64 构建时出现 2 种构建错误：Error1 'Could not load file or assembly 'TeeChart, Version=4.1.2012.7136, Culture=neutral, PublicKeyToken=9c8126276c77bdb7' 或其依赖项之一。试图加载格式不正确的程序。

除了复制程序集之外，您是否更新了项目中的 TeeChart.dll 引用？您可以尝试将其删除并将其分配给 x64 程序集。

> 错误 2：'无法加载文件或程序集'TeeChart，版本 = 3.5.3225.32185，文化 = 中性，PublicKeyToken = 9c8126276c77bdb7'或其依赖项之一。无效的指针（来自 HRESULT 的异常：0x80004003 (E_POINTER)）'

您可能应该将 licenses.licx 更新到新版本或使用最小版本不可知的 licenses.licx，如教程 17 中所述。教程可以在 TeeChart 的程序组中找到。

> 问题 2：我需要更新项目中的所有 licenses.licx 文件吗？我知道这些是在添加 TChart 时自动生成的？当我只是更新 TeeChart 库时，我该如何处理？

我建议您使用之前回复中所述的无版本 licenses.licx。

> 问题3：为什么会出现两种不同的错误？所有 licenses.licx 当前都有包含 Version=3.5.3225.32185 的文本。我尝试手动将所有 licenses.licx 文件更新到较新版本，但没有帮助。

可能是因为有2个问题：1、项目找不到设置的TeeChart引用。2、发现的TeeChart程序集版本与licenses.licx设置不一致。

> 构建测试 2：使用新的 x86 TeeChart dll 构建 x64 项目 将 dll 从文件夹 C:\Program Files (x86)\Steema Software\Steema TeeChart for .NET 2012\net35\x86\ 复制到项目文件夹。
> 
> 一切都构建良好并且运行良好
> 
> 问题 4：如何在没有更新项目中的 licenses.licx 文件的情况下构建良好？

可能是因为项目 TeeChart.dll 引用尚未更新，并且仍指向 x86 TeeChart 版本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-26T15:15:42.313

> > 问题1：我的理解正确吗？为什么在较新版本中有两个版本的 TeeChart dll？这就是将所有关于可能的环境组合的选项留给用户。

我理解灵活性。我试图得到的答案是打算在较新的版本中使用单独的 dll。2008年它曾经只是一套dll。那为什么现在是x64和x86版本。我没有看到任何解释差异的帮助或发行说明。x64 dll 是否在 x64 上运行时进行了优化？

# java - 为什么我的 libVLC 程序在尝试绑定捕获设备时会死锁？

> ID：11640597
> 
> 赞同：0
> 
> 时间：2012-07-24T23:08:25.787
> 
> 标签：java, vlc, jna, libvlc, vlcj

这是我最初在 VideoLan 论坛（[线程](http://forum.videolan.org/viewtopic.php?f=32&t=102854)）上发布的一个问题，但 VideoLan 支持完全过度工作，无论如何我无法判断这是否是 libVLC、JNA 或 VLCj 实现的问题，所以我想我会问StackOverflow，看看是否有人有任何线索......

大家好，

我正在 Windows XP 上使用 VLCj 在 Groovy 中编写一个自动转码器。我的捕获设备是 Epiphan VGA2USB LR 图像采集设备，我通过 DirectShow 连接到该设备。此时我只是想将此设备中的*任何*数据记录到文件中，但到目前为止我还没有运气。我知道该设备与 VLC 兼容——我可以使用 VLC GUI 打开设备并在屏幕上查看其输出。

修复了之前困扰我的各种配置问题后，我现在发现当我尝试开始录制时 VLC 似乎挂起。这是我得到的输出，注释了在什么时间发生的事情：

```
[00384d30] main libvlc debug: VLC media player - 2.0.2 Twoflower
[00384d30] main libvlc debug: Copyright � 1996-2012 VLC authors and VideoLAN
[00384d30] main libvlc debug: revision 2.0.2-14-gbc2c368
[00384d30] main libvlc debug: configured with ../extras/package/win32/../../../configure  '--enable-update-check' '--enable-lua' '--enable-faad' '--enable-flac' '--enable-theora' '--enable-twolame' '--enable-quicktime' '--enable-avcodec' '--enable-merge-ffmpeg' '--enable-dca' '--enable-mpc' '--enable-libass' '--enable-x264' '--enable-schroedinger' '--enable-realrtsp' '--enable-live555' '--enable-dvdread' '--enable-shout' '--enable-goom' '--enable-caca' '--disable-portaudio' '--disable-sdl' '--enable-qt4' '--enable-skins2' '--enable-sse' '--enable-mmx' '--enable-libcddb' '--enable-zvbi' '--disable-telx' '--enable-sqlite' '--disable-dirac' '--host=i586-mingw32msvc' '--enable-crystalhd' 'host_alias=i586-mingw32msvc'
[00384d30] main libvlc debug: searching plug-in modules
[00384d30] main libvlc debug: loading plugins cache file C:\Documents and Settings\Administrator\digitizer\lib\libvlc-2.0.2\plugins\plugins.dat
[00384d30] main libvlc debug: recursively browsing `C:\Documents and Settings\Administrator\digitizer\lib\libvlc-2.0.2\plugins'
[00384d30] main libvlc debug: saving plugins cache C:\Documents and Settings\Administrator\digitizer\lib\libvlc-2.0.2\plugins\plugins.dat
[00384d30] main libvlc debug: plug-ins loaded: 388 modules
[00384d30] main libvlc debug: translation test: code is "C"
[00384d30] main libvlc debug: CPU has capabilities MMX MMXEXT SSE SSE2 SSE3 SSSE3 SSE4.1 SSE4.2 FPU 
[00384d30] main libvlc debug: looking for memcpy module: 4 candidates
[00384d30] main libvlc debug: using memcpy module "memcpymmxext"
[0038c568] main interface debug: looking for interface module: 1 candidate
[0038c568] main interface debug: using interface module "hotkeys"
[0038c568] main interface debug: TIMER module_need() : 0.033 ms - Total 0.033 ms / 1 intvls (Avg 0.033 ms) 
```

[这是代码中调用 play() 的地方]

```
24-07-2012 14:05:45 Digitizer: [DEBUG] Recording test-capture.mp4 start
[03f59340] main input debug: Creating an input for 'dshow://'
[03f5d578] main stream output debug: using sout chain=`transcode{vcodec=mp4v,vb=1024,scale=1}:standard{access=file,mux=mp4,dst="test-capture.mp4"}'
[03f5d578] main stream output debug: stream=`standard'
[03f4eb60] main stream out debug: looking for sout stream module: 1 candidate
[03f4eb60] main stream out debug: set config option: sout-standard-access to file
[03f4eb60] main stream out debug: set config option: sout-standard-mux to mp4
[03f4eb60] main stream out debug: set config option: sout-standard-dst to test-capture.mp4
[03f47c48] main access out debug: looking for sout access module: 1 candidate
[03f61ab8] main playlist debug: playlist threads correctly activated
[03f47c48] access_output_file access out debug: file access output opened (test-capture.mp4)
[03f47c48] main access out debug: using sout access module "access_output_file"
[03f47c48] main access out debug: TIMER module_need() : 1.176 ms - Total 1.176 ms / 1 intvls (Avg 1.176 ms)
[0038cbd8] main mux debug: looking for sout mux module: 1 candidate
[0038cbd8] mux_mp4 mux debug: Mp4 muxer opened
[0038cbd8] main mux debug: using sout mux module "mux_mp4"
[0038cbd8] main mux debug: TIMER module_need() : 0.907 ms - Total 0.907 ms / 1 intvls (Avg 0.907 ms)
[03f4eb60] stream_out_standard stream out debug: using `file/mp4://test-capture.mp4'
[03f4eb60] main stream out debug: using sout stream module "stream_out_standard"
[03f4eb60] main stream out debug: TIMER module_need() : 4.965 ms - Total 4.965 ms / 1 intvls (Avg 4.965 ms)
[03f5d578] main stream output debug: stream=`transcode'
[03f4ad70] main stream out debug: looking for sout stream module: 1 candidate
[03f4ad70] main stream out debug: set config option: sout-transcode-vcodec to mp4v
[03f4ad70] main stream out debug: set config option: sout-transcode-vb to 1024
[03f4ad70] main stream out debug: set config option: sout-transcode-scale to 1
[03f4ad70] stream_out_transcode stream out debug: codec video=mp4v 0x0 scaling: 1.000000 1024kb/s
[03f4ad70] main stream out debug: using sout stream module "stream_out_transcode"
[03f4ad70] main stream out debug: TIMER module_need() : 0.976 ms - Total 0.976 ms / 1 intvls (Avg 0.976 ms)
[03f59340] main input debug: using timeshift granularity of 50 MiB, in path 'C:\DOCUME~1\ADMINI~1\LOCALS~1\Temp'
24-07-2012 14:05:45 Digitizer: [DEBUG] Recording started
[03f59340] main input debug: `dshow://' gives access `dshow' demux `' path `'
[03f59340] main input debug: creating demux: access='dshow' demux='' location='' file='(null)'
[03f4a898] main demux debug: looking for access_demux module: 1 candidate
[03f4a898] dshow demux debug: dshow-vdev: VGA2USB LR V3U48015
[03f4a898] dshow demux debug: dshow-adev: 
[03f61ab8] main playlist debug: rebuilding array of current - root Playlist
[03f61ab8] main playlist debug: rebuild done - 0 items, index -1
[03f4a898] dshow demux debug: found device: VGA2USB LR V3U48015
[03f4a898] dshow demux debug: found device: VGA2USB LR V4U120503
[03f4a898] dshow demux debug: asking for device: VGA2USB LR V3U48015
[03f4a898] dshow demux debug: asked for VGA2USB LR V3U48015, binding to VGA2USB LR V3U48015 
```

[此时，执行停止。从不同的线程调用 player.stop() 会无限期地阻塞。]

[以下是从不同线程调用运行时关闭过程后的输出：]

```
[03f4a898] dshow demux debug: using device: VGA2USB LR V3U48015
[03f4a898] dshow demux debug: EnumDeviceCaps: output pin: Capture
[03f4a898] dshow demux debug: EnumDeviceCaps: trying pin Capture
[03f4a898] dshow demux debug: EnumDeviceCaps: input pin default format configured
[03f4a898] dshow demux debug: EnumDeviceCaps: input pin accepts chroma: RV24, width:1024, height:768, fps:59.900326
[03f4a898] dshow demux debug: CaptureFilter::JoinFilterGraph
[03f4a898] dshow demux debug: connecting filters
[03f4a898] dshow demux debug: CaptureFilter::EnumPins
[03f4a898] dshow demux debug: CapturePin::QueryDirection
[03f4a898] dshow demux debug: CapturePin::ConnectedTo [not connected]
[03f4a898] dshow demux debug: CapturePin::QueryPinInfo
[03f4a898] dshow demux debug: CaptureFilter::QueryFilterInfo
[03f4a898] dshow demux debug: CapturePin::QueryPinInfo
[03f4a898] dshow demux debug: CaptureFilter::EnumPins
[03f4a898] dshow demux debug: CapturePin::QueryDirection
[03f4a898] dshow demux debug: CapturePin::QueryDirection
[03f4a898] dshow demux debug: CapturePin::QueryAccept [OK] (width=1024, height=768, chroma=RV24, fps=59.900326)
[03f4a898] dshow demux debug: CapturePin::ReceiveConnection [OK]
[03f4a898] dshow demux debug: CapturePin::NotifyAllocator
[03f4a898] dshow demux debug: ConnectFilters: graph_builder2 available.
[03f4a898] dshow demux warning: ConnectFilters: No crossBar routes found (incompatible pin types)
[03f4a898] dshow demux debug: filters connected successfully !
[03f4a898] dshow demux debug: MEDIATYPE_Video
[03f4a898] dshow demux debug: selected video pin accepts format: RV24
[03f4a898] dshow demux debug: found device: Creative Sound Blaster PCI
[03f4a898] dshow demux debug: asking for default device: Creative Sound Blaster PCI
[03f4a898] dshow demux debug: asked for Creative Sound Blaster PCI, binding to Creative Sound Blaster PCI
[03f4a898] dshow demux debug: using device: Creative Sound Blaster PCI
[03f4a898] dshow demux debug: EnumDeviceCaps: output pin: Capture
[03f4a898] dshow demux debug: EnumDeviceCaps: input pin: Stereo Mix
[03f4a898] dshow demux debug: EnumDeviceCaps: input pin: Phone Line
[03f4a898] dshow demux debug: EnumDeviceCaps: input pin: Aux Volume
[03f4a898] dshow demux debug: EnumDeviceCaps: input pin: Video Volume
[03f4a898] dshow demux debug: EnumDeviceCaps: input pin: Mic Volume
[03f4a898] dshow demux debug: EnumDeviceCaps: input pin: Line In
[03f4a898] dshow demux debug: EnumDeviceCaps: input pin: CD Audio
[03f4a898] dshow demux debug: EnumDeviceCaps: trying pin Capture
[03f4a898] dshow demux debug: EnumDeviceCaps: input pin default format configured
[03f4a898] dshow demux debug: EnumDeviceCaps: input pin accepts format: araw, channels:2, samples/sec:44100 bits/sample:16
[03f4a898] dshow demux debug: EnumDeviceCaps: input pin accepts format: araw, channels:2, samples/sec:44100 bits/sample:16
[03f4a898] dshow demux debug: EnumDeviceCaps: input pin accepts format: araw, channels:1, samples/sec:44100 bits/sample:16
[03f4a898] dshow demux debug: EnumDeviceCaps: input pin accepts format: araw, channels:2, samples/sec:32000 bits/sample:16
[03f4a898] dshow demux debug: EnumDeviceCaps: input pin accepts format: araw, channels:1, samples/sec:32000 bits/sample:16
[03f4a898] dshow demux debug: EnumDeviceCaps: input pin accepts format: araw, channels:2, samples/sec:22050 bits/sample:16
[03f4a898] dshow demux debug: EnumDeviceCaps: input pin accepts format: araw, channels:1, samples/sec:22050 bits/sample:16
[03f4a898] dshow demux debug: EnumDeviceCaps: input pin accepts format: araw, channels:2, samples/sec:11025 bits/sample:16
[03f4a898] dshow demux debug: EnumDeviceCaps: input pin accepts format: araw, channels:1, samples/sec:11025 bits/sample:16
[03f4a898] dshow demux debug: EnumDeviceCaps: input pin accepts format: araw, channels:2, samples/sec:8000 bits/sample:16
[03f4a898] dshow demux debug: EnumDeviceCaps: input pin accepts format: araw, channels:1, samples/sec:8000 bits/sample:16
[03f4a898] dshow demux debug: EnumDeviceCaps: input pin accepts format: araw, channels:2, samples/sec:44100 bits/sample:8
[03f4a898] dshow demux debug: EnumDeviceCaps: input pin accepts format: araw, channels:1, samples/sec:44100 bits/sample:8
[03f4a898] dshow demux debug: EnumDeviceCaps: input pin accepts format: araw, channels:2, samples/sec:22050 bits/sample:8
[03f4a898] dshow demux debug: EnumDeviceCaps: input pin accepts format: araw, channels:1, samples/sec:22050 bits/sample:8
[03f4a898] dshow demux debug: EnumDeviceCaps: input pin accepts format: araw, channels:2, samples/sec:11025 bits/sample:8
[03f4a898] dshow demux debug: EnumDeviceCaps: input pin accepts format: araw, channels:1, samples/sec:11025 bits/sample:8
[03f4a898] dshow demux debug: EnumDeviceCaps: input pin accepts format: araw, channels:2, samples/sec:8000 bits/sample:8
[03f4a898] dshow demux debug: EnumDeviceCaps: input pin accepts format: araw, channels:1, samples/sec:8000 bits/sample:8
[03f4a898] dshow demux debug: EnumDeviceCaps: input pin accepts format: araw, channels:2, samples/sec:48000 bits/sample:16
[03f4a898] dshow demux debug: EnumDeviceCaps: input pin accepts format: araw, channels:1, samples/sec:48000 bits/sample:16
[03f4a898] dshow demux debug: EnumDeviceCaps: input pin accepts format: araw, channels:2, samples/sec:96000 bits/sample:16
[03f4a898] dshow demux debug: EnumDeviceCaps: input pin accepts format: araw, channels:1, samples/sec:96000 bits/sample:16
[03f4a898] dshow demux debug: CaptureFilter::JoinFilterGraph
[03f4a898] dshow demux debug: connecting filters
[03f4a898] dshow demux debug: CaptureFilter::EnumPins
[03f4a898] dshow demux debug: CapturePin::QueryDirection
[03f4a898] dshow demux debug: CapturePin::ConnectedTo [not connected]
[03f4a898] dshow demux debug: CapturePin::QueryPinInfo
[03f4a898] dshow demux debug: CaptureFilter::QueryFilterInfo
[03f4a898] dshow demux debug: CapturePin::QueryPinInfo
[03f4a898] dshow demux debug: CaptureFilter::EnumPins
[03f4a898] dshow demux debug: CapturePin::QueryDirection
[03f4a898] dshow demux debug: CapturePin::QueryDirection
[03f4a898] dshow demux debug: CapturePin::QueryAccept [OK] (channels=2, samples/sec=44100, bits/samples=16, format=araw)
[03f4a898] dshow demux debug: CapturePin::ReceiveConnection [OK]
[03f4a898] dshow demux debug: CapturePin::NotifyAllocator
[03f4a898] dshow demux debug: filters connected successfully !
[03f4a898] dshow demux debug: MEDIATYPE_Audio
[03f4a898] dshow demux debug: selected audio pin accepts format: araw
[03f4a898] dshow demux debug: Playing...
[03f4a898] dshow demux debug: CapturePin::QueryPinInfo
[03f4a898] dshow demux debug: CaptureFilter::EnumPins
[03f4a898] dshow demux debug: CapturePin::QueryDirection
[03f4a898] dshow demux debug: CapturePin::QueryPinInfo
[03f4a898] dshow demux debug: CaptureFilter::EnumPins
[03f4a898] dshow demux debug: CapturePin::QueryDirection
[03f4a898] dshow demux debug: CaptureFilter::EnumPins
[03f4a898] dshow demux debug: CapturePin::QueryDirection
[03f4a898] dshow demux debug: CapturePin::QueryPinInfo
[03f4a898] dshow demux debug: CaptureFilter::EnumPins
[03f4a898] dshow demux debug: CapturePin::QueryDirection
[03f4a898] dshow demux debug: CapturePin::QueryPinInfo
[03f4a898] dshow demux debug: CaptureFilter::EnumPins
[03f4a898] dshow demux debug: CapturePin::QueryDirection
[03f4a898] dshow demux debug: CaptureFilter::EnumPins
[03f4a898] dshow demux debug: CapturePin::QueryDirection
[03f4a898] dshow demux debug: CaptureFilter::EnumPins
[03f4a898] dshow demux debug: CapturePin::QueryDirection
[03f4a898] dshow demux debug: CapturePin::ConnectedTo [OK]
[03f4a898] dshow demux debug: CaptureFilter::EnumPins
[03f4a898] dshow demux debug: CapturePin::QueryDirection
[03f4a898] dshow demux debug: CapturePin::ConnectedTo [OK]
[03f4a898] dshow demux debug: CaptureFilter::SetSyncSource
[03f4a898] dshow demux debug: CaptureFilter::SetSyncSource
[03f4a898] dshow demux debug: CaptureFilter::Pause
[03f4a898] dshow demux debug: CaptureFilter::Pause
[03f4a898] dshow demux debug: CaptureFilter::Run
[03f4a898] dshow demux debug: CaptureFilter::Run
[03f59340] main input debug: selecting program id=0

Process finished with exit code 0 
```

通过挖掘源代码，似乎 IMoniker->BindToObject() 正在等待仅在程序终止时释放的资源 - 据我所知，阻塞的调用是 dshow.cpp:1317

```
 hr = p_moniker->BindToObject( NULL, 0, IID_IBaseFilter,
                                              (void **)&p_base_filter ); 
```

这一行是 VLC 调用 DirectShow API 来注册设备的地方，所以它为什么不返回完全超出了我的理解。在我看来， play() 操作成功完成了，但是当然，由于这是在程序终止时发生的，所以如果我们想实际录制任何内容，它是没有用的。

如果有人可以向我建议一种解决此问题的方法，或者告诉我我做错了什么导致它，我将永远感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T23:33:05.573

事实证明，这个调用是阻塞的，因为从 playMedia 调用返回后，我的程序的主线程立即等待标准输入（以实现“按 Enter 退出”类型的安排）——触发的不是 VM 关闭突然返回的调用，而是控制台读取返回的事实，因此 I/O 等待不再阻塞 DirectShow API 调用。

为什么控制台 I/O 调用会阻塞 DirectShow 中的某些内容完全超出*了*我的理解，但你去吧。这个问题可以通过在 playMedia() 调用（简单）后休眠任何执行控制台 I/O 的线程几秒钟来轻松解决，或者在从控制台读取之前检查 VLC 对象是否已完成播放操作的启动（不太容易，更可靠）。

# php - 使用 formdata 使用 ajax 将数据发送到 PHP

> ID：11640598
> 
> 赞同：0
> 
> 时间：2012-07-24T23:08:39.067
> 
> 标签：php, javascript, ajax, html

解决方案：我不得不放弃 sumbmit 按钮并使用常规按钮。此代码的其余部分有效。我还删除了 HTML 表单。

我正在尝试使用 formdata 使用 ajax 将图像 + 一些文本发送到我的 php 脚本。这就是我得到的：

```
$ajax_uploadImage = function (form)
{
    var data = new FormData();

    data.append('title', form.find('#title').val());
    data.append('comment', form.find('#comment').val());
    data.append('image', form.find('#image').prop('files')[0]);

    $.ajax({
        url: '../php/upload_image.php',
        data: data,
        type: 'POST',
        processData: false,
        contentType: false,
        success: function (data) {
            alert('something');
        }
    });
} 
```

函数参数中的表单是普通的html表单，这里是html中的表单：

```
<form enctype="multipart/form-data" id="upload_image">
    <label for="title">Title:</label>
        <input type="text" id="title" name="title" />
    <br />

    <label for="comment">Comment:</label>
    <input type="text" id="comment" name="comment" />
    <br />

    <label for="image">Image:</label>
    <input type="file" id="image" name="image" />
    <br />

    <input type="submit" value="Upload picture" name="submit">
    <hr />
</form> 
```

成功的警报永远不会触发，有人可以帮忙吗？

编辑：添加 PHP，即使它没有做任何事情：

```
<?php echo 'something'; ?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T23:35:54.047

尝试添加表单操作，例如：

```
<form enctype="multipart/form-data" id="upload_image" action="upload_image.php"> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T23:10:24.510

现在你正在存储一个`FormData`无法工作的 jQuery 对象。请改用这些元素的值。如果是文件输入，您需要使用DOM 元素属性中的`File`对象：`files`

```
data.append('title', form.find('#title').val());
data.append('comment', form.find('#comment').val());
data.append('image', form.find('#image').prop('files')[0]); 
```

# php - 搜索包含重复字段并删除它们的行的Mysql查询？

> ID：11640601
> 
> 赞同：0
> 
> 时间：2012-07-24T23:09:02.230
> 
> 标签：php, mysql

我有一个包含以下字段的数据库表：

```
username, description, password. 
```

**有时，成员会互相复制描述，以节省时间**

所以我有这个：

**约翰 - 约翰的描述 - 约翰的密码**

**迈克尔 - 约翰的描述 - 迈克尔的密码**

是否有搜索重复字段条目并删除它们的 mysql 查询？在我们处理数据时删除整行数据怎么样？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T23:37:18.523

创建一个新表，在其中移动不重复的条目，删除旧表并重命名一个新表。

**例子：**

```
CREATE TABLE `new_table` as
    SELECT * FROM `old_table` WHERE 1 GROUP BY [columns to remove duplicates by];

DROP TABLE `old_table`;

RENAME TABLE `new_table` TO `old_table`; 
```

但是，它只适合定期使用，并且不检查是否有任何重复。它只是将唯一条目分组并将它们移动到另一个表。当您想要过滤条目时，它很有用。

* * *

另一种方法是这样检查：

```
SELECT `name` FROM `table` WHERE `description` LIKE '%descriptiontexthere%' 
```

然后，如果找到一些结果，它就是重复的。
但是，有一个很大的缺点：*用户只能更改 1 个字母，查询将失败。*
但是，可以通过将描述拆分为数组来避免（不完全）该缺点。例如，每隔 100 个字符拆分一次，然后像上面的例子一样检查，但是有多个条件（例如`description LIKE 'first100chars' OR description LIKE 'second100chars'`）。

* * *

第三种方法是将描述拆分为单词数组，然后选择具有太​​多相同单词的行。具有 X 个相同单词的行可能是重复的。您可以根据输入描述的长度设置阈值。

**你永远无法确定它是否重复，除非它是完全相同的条目。**

# android - 在 FragmentPagerAdapter 中异步加载片段

> ID：11640605
> 
> 赞同：0
> 
> 时间：2012-07-24T23:09:28.797
> 
> 标签：android, android-viewpager

我正在使用 a`android.support.v4.view.ViewPager`并希望快速浏览其视图。

目前，我的 ViewPager 中的每个 ListFragment 视图都需要访问 Web 服务才能显示其列表。我通过检索数据并`setListAdapter`在 Fragments`onCreate`方法中调用来做到这一点。由于从 Web 服务检索数据的延迟，这会导致 ViewPager 在其视图之间滑动时“挂起”。

有没有办法从 Web 服务异步加载数据并在检索到所有数据时填充列表？理想情况下，我想快速翻阅 ViewPager 并显示一个加载指示器，同时每个子 ListFragment 加载其所需的数据。

注意：我尝试使用 ASyncTask 调用 Web 服务并设置列表适配器，但在从 ASyncTask 中调用 ASyncTask 时遇到了问题。人工智能在正确的轨道上还是有更好的方法？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T23:17:37.097

> 有没有办法从 Web 服务异步加载数据并在检索到所有数据时填充列表？

开始`AsyncTask`加载数据。

> 注意：我尝试使用 ASyncTask 调用 Web 服务并设置列表适配器，但在从 ASyncTask 中调用 ASyncTask 时遇到问题

您不能调用另一个`AsyncTask`from `doInBackground()`。`AsyncTask`

# .net - Microsoft Moles 不生成痣和行为程序集

> ID：11640618
> 
> 赞同：3
> 
> 时间：2012-07-24T23:10:32.327
> 
> 标签：.net, mstest, moles, pex, pex-and-moles

我的机器实际生成痣组件时遇到了一些问题。我遇到的每个教程都简单地说了以下步骤：

1) 安装它。

2) 右键单击​​参考并单击“添加 Moles 组件”。

按照这些步骤，它*应该*生成一个“.moles”文件以及一组程序集。我的 VS 2010 安装生成“.moles”文件，但根本不生成程序集（据我所知）——或者它只是没有将它们作为参考添加到项目文件中。我认为这可能是我的 Windows 7 安装的问题，因为它是公司构建的，他们往往喜欢锁定。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T23:13:28.033

单击“添加 Moles 组件”后，您是否尝试过构建解决方案？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T23:15:32.193

也许您需要管理权限或特定特权？看到这个：

[缺少 Add Moles 组件](https://stackoverflow.com/questions/9609577/missing-add-moles-assembly)

以管理员权限运行 Visual Studio...通过命令行或更改快捷方式的属性。

[http://social.msdn.microsoft.com/Forums/hu/pex/thread/364ac145-0c48-49e1-8ee8-fd549fee3184](http://social.msdn.microsoft.com/Forums/hu/pex/thread/364ac145-0c48-49e1-8ee8-fd549fee3184)

* * *

更新：对于喜欢观看有关使用 Moles 所需步骤的简短视频的人，请参阅：

[http://channel9.msdn.com/Blogs/Peli/Moles-Replace-any-NET-method-with-a-delegate](http://channel9.msdn.com/Blogs/Peli/Moles-Replace-any-NET-method-with-a-delegate)

还要记住，他们给 Moles 起了一个新名字……Microsoft Fakes Isolation Framework

[http://msdn.microsoft.com/en-us/library/hh549175(v=vs.110).aspx](http://msdn.microsoft.com/en-us/library/hh549175(v=vs.110).aspx)

# python - 是否可以使用 NetworkX 在给定图像上绘制图形？

> ID：11640620
> 
> 赞同：3
> 
> 时间：2012-07-24T23:10:57.120
> 
> 标签：python, networkx

是否可以使用 python 包 NetworkX 在给定图像（而不是空图）上绘制图形？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-25T01:10:51.647

也许你可以试试这个，但它需要 matplotlib：

```
import matplotlib.pyplot as plt
import matplotlib.image as mpimg
import networkx as nx
G = nx.cycle_graph(2)
pos =   {0:[0,0], 1:[ 300,  300]}
plt.figure(1)
img=mpimg.imread('/home/stinkbug.png')
plt.imshow(img)
nx.draw(G,pos)
plt.savefig('/home/test.png') 
```

[我在这个页面](http://matplotlib.sourceforge.net/users/image_tutorial.html)上使用了臭虫。

单独使用 networkx 可能有点棘手。也许您可以将所需的图像设置为节点（例如节点 0），然后将节点定位在原点 (0,0)。最后，将图表中的其他节点定位在它们之上。我自己没有尝试过，但它突然出现在我的脑海中。

# javascript - Kinetic.js 旋转组对象的新子级具有不正确的偏移量

> ID：11640623
> 
> 赞同：0
> 
> 时间：2012-07-24T23:11:22.840
> 
> 标签：javascript, html, html5-canvas, kineticjs

我需要用户在一个圆圈中画线，然后旋转包括线条在内的圆圈。但是，如果我使用“组”对圆圈进行分组，然后画线，则不会在圆圈中画线。

在此之后，如果我移动该组，则线条不会绘制在圆圈中，而是绘制在图层上的其他位置。

任何帮助或建议将不胜感激。谢谢

**工作副本：** 单击开始，然后单击撤消按钮旁边的圆圈旁边的两个红色圆圈

[微生物学游戏链接](http://micro-detective.hostei.com/)

这是代码：我首先在单击时获取 x 和 y 坐标，然后在鼠标移动时画一条线

```
petriDish.on("click", function(event) {        

    var item = new UndoObjects();
    item.id= this.getId();
    item.name = this.getName();
    item.Xaxis = this.getX();
    item.Yaxis = this.getY();
    item.itemLayer = 'itemsLayer';
    undoManager.push(item);

    if(petridishGroup.getLayer().getName() == 'gamePlayLayer')
    {
        CanPerformStreaking();
        petridishGroup.setDraggable(true);

        gamePlayLayer.draw();
        itemsLayer.draw();

        document.body.style.cursor = "default";
        x= event.layerX;
        y= event.layerY;
        startX = x; 
        startY = y;

        // if click and were drawing then stop drawing 
        if(drawing)
        {
            drawing = false;
            clearInterbal(mouseStopTimer);                  
        }
        else{
            drawing = true;  
            MoveStopDetector();
        }
    }else
    {
        //this.setY(notificationLayer.getY()+120);
        petridishGroup.moveTo(gamePlayLayer);            
        petriDish.setRadius(50);
        itemsLayer.draw();
    }                  

    petriDish.draggable = false; 
});

petriDish.on("mouseover mousemove", function(event) {
    document.body.style.cursor = "pointer";

    if(petridishGroup.getLayer().getName() != 'gamePlayLayer')
    {
        petriDish.setRadius(40);
        itemsLayer.draw();
    }  
    else{
        if(drawing)
        {
            clearInterval(mouseStopTimer);                    
            MoveStopDetector();
            if(x >0 && y> 0 && drawing && allowStreaking)
            {
                var redLine = new Kinetic.Line({
                    points: [x,y, event.layerX, event.layerY],
                    stroke: "red",
                    strokeWidth: 3,
                    lineCap: "round",
                    lineJoin: "round"
                });
                x = event.layerX;
                y = event.layerY;

                petridishGroup.add(redLine);
                petridishGroup.setDraggable(true);
                petriDish.draggable=false;     
                gamePlayLayer.draw();                     
            }
        }   
    }

}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T14:53:15.407

解决方案是将圆放在组的左上角，这些坐标为 0,0，这将是圆的中心。

此外，在鼠标移动时绘制线条时，获取鼠标相对于图层的坐标，然后从鼠标坐标中减去组的位置，这将给出相对于组的 x 和 y 点。

```
var newX = event.layerX - group.getX();
var newY = event.layerY - group.getY(); 
```

newX 和 newY 是相对于组坐标 0,0 的点

# javascript - 如何找到任何给定 Facebook 用户的 LinkedIn 个人资料？

> ID：11640624
> 
> 赞同：-4
> 
> 时间：2012-07-24T23:11:38.943
> 
> 标签：javascript, ruby, facebook, pattern-matching, linkedin

所以假设我有一个 Facebook 成员列表，但没有他们的实际电子邮件。在我的列表中查找每个 Facebook 用户的 LinkedIn 个人资料的最佳方法是什么？我可以使用哪些线索进行匹配？

我很感激你的意见。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T23:22:39.367

有一家名为 PIPL 的公司，它的 API 可能会有所帮助……我有一段时间没看它了，所以我不确定他们是否有关于 LinkedIn 句柄的数据。

基本上，他们从不同来源编译大量关于人的数据，并允许您使用 Facebook 句柄、电子邮件地址等内容搜索他们的数据库。例如，您可以搜索电子邮件地址列表，并且至少检索其中一些人的 Facebook 名称。

这不是 100% 准确，但他们的数据相当不错。

# ruby-on-rails - Facebook 自定义帖子

> ID：11640626
> 
> 赞同：0
> 
> 时间：2012-07-24T23:12:09.727
> 
> 标签：ruby-on-rails, facebook, facebook-graph-api

目前我正在使用 Omniauth-facebook 和 Koala 与 facebook 集成，因此代表用户发布状态更新和图片非常简单。我想知道是否有人知道如何从 rails 创建自定义帖子（例如社交摄像头或优惠券网站创建的帖子）。任何指南或教程将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T00:29:34.197

你的意思是和这篇文章类似的吗？

[https://stackoverflow.com/questions/10037655/are-custom-wall-posts-links-such-as-this-possible-with-the-api](https://stackoverflow.com/questions/10037655/are-custom-wall-posts-links-such-as-this-possible-with-the-api)

为此，您需要使用 Open Graph：

[https://developers.facebook.com/docs/opengraph/](https://developers.facebook.com/docs/opengraph/)

# scala - 用 scala 编写的多边形中的点

> ID：11640630
> 
> 赞同：2
> 
> 时间：2012-07-24T23:12:30.420
> 
> 标签：scala

我想知道将此 C# 方法转换为 Scala 函数的最佳方法，似乎使用 scala 的语法可以更简洁。

```
bool IsPointInPolygon(List<Loc> poly, Loc point)
{
    int i, j;
    bool c = false;
    for (i = 0, j = poly.Count - 1; i < poly.Count; j = i++)
    {
        if ((((poly[i].Lt <= point.Lt) && (point.Lt < poly[j].Lt)) ||
            ((poly[j].Lt <= point.Lt) && (point.Lt < poly[i].Lt))) &&
            (point.Lg < (poly[j].Lg - poly[i].Lg) * (point.Lt - poly[i].Lt) /
            (poly[j].Lt - poly[i].Lt) + poly[i].Lg))
                c = !c;
    }
    return c;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-10-10T01:16:50.133

怎么样：

```
sealed case class Loc(lat: Double, long: Double)

def isPointInPolygon(poly: List[Loc], x: Loc): Boolean = {
  (poly.last :: poly).sliding(2).foldLeft(false) { case (c, List(i, j)) =>
    val cond = {
      (
        (i.lat <= x.lat && x.lat < j.lat) ||
        (j.lat <= x.lat && x.lat < i.lat)
      ) &&
      (x.long < (j.long - i.long) * (x.lat - i.lat) / (j.lat - i.lat) + i.long)
    }

    if (cond) !c else c
  }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-25T00:10:22.203

假设您的算法是正确的，您可以观察到`boolean`每次满足特定条件时通过切换获得结果。因此，您可以*计算*这些条件。

此外，您正在成对地迭代这些点（`j`基本上`i - 1`，如果我理解代码正确，除了`j`必须回绕到的初始迭代`poly.Count - 1`）。

要获得对，如果`poly`是`scala.List`：

```
val pairs = (poly.last :: poly).sliding(2, 1) 
```

在与 形成对之前，将最后一个元素添加到列表中`sliding`，例如

```
val x = List("a", "b", "c")
(x.last :: x).sliding(2,1).toList // gives List(List(c, a), List(a, b), List(b, c)) 
```

（严格来说，`last`这不是一个非常有效的方法`scala.List`，但它有效）

那么你会有

```
pairs.count { case Seq(pi, pj) => checkCondition } % 2 == 1 
```

那里`case Seq(pi, pj)`再次为你提取相邻点，并`% 2 == 1`询问你是否计算了奇数次。

* * *

滑动的替代方法是使用该`foldLeft`方法。这可能更具表现力，因为没有创建嵌套集合，但更多的是一个聪明的解决方案。诀窍是绕过前一点*和*当前结果（`c`在您的原始代码中）：

```
poly.foldLeft(poly.last -> false) { case ((pj, c), pi) => pi -> (c ^ checkCondition)} 
```

这再次使用模式匹配 ( `case ...`) 来优雅地解包折叠的参数。

# uiviewcontroller - 添加一个新的 UIToolbar 到 UIViewController

> ID：11640631
> 
> 赞同：0
> 
> 时间：2012-07-24T23:12:37.830
> 
> 标签：uiviewcontroller, uitoolbar, uitoolbaritem

我正在开发一个基于 TabBar 的应用程序，当在第一个视图中选择一个单元格时，会出现 UIViewController 女巫。我想添加一个 UIToolBar，其中包含所选单元格的 segue 给出的一些信息（在项目中）。我已经尝试了下面的代码（在类似的问题中找到）但它不起作用：

```
if (self) {
    NSArray* toolbarItems = [NSArray arrayWithObjects:
                             [[UIBarButtonItem alloc] initWithBarButtonSystemItem:UIBarButtonSystemItemAdd 
                                                                           target:self
                                                                           action:@selector(addStuff:)],
                             [[UIBarButtonItem alloc] initWithBarButtonSystemItem:UIBarButtonSystemItemSearch 
                                                                           target:self
                                                                           action:@selector(searchStuff:)],
                             nil];
    [self setToolbarItems:toolbarItems];
    [self.navigationController setToolbarHidden:NO animated: YES];

}
return self; 
```

有谁知道另一种在导航控制器推断的 UIToolBar 上添加新 UIToolBar 的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T08:34:44.540

我通过添加 IBOutlet UIToolBar 并将其定义为视图的工具栏解决了我的问题。 `theToolBar = [[self navigationController] toolbar];`

# authentication - OAuth 与 HTTPS 和 SessionID 的优势

> ID：11640632
> 
> 赞同：0
> 
> 时间：2012-07-24T23:12:52.717
> 
> 标签：authentication, oauth, https, authorization, sessionid

使用 OAuth 与仅使用 sessionID + HTTPS 相比有什么优势？似乎有很多复杂性而没有什么好处。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T23:16:44.057

来自[维基百科](http://en.wikipedia.org/wiki/OAuth)：

> 它允许用户与另一个站点共享他们存储在一个站点上的私人资源（例如照片、视频、联系人列表），而无需分发他们的凭据，通常提供用户名和密码令牌。*每个令牌授予对特定资源（例如，仅来自特定专辑的视频）和定义的持续时间（例如，接下来的 2 小时）的特定站点（例如，视频编辑站点）的访问权限。这允许用户授予第三方站点访问他们在另一个服务提供商处存储的信息的权限，而无需共享他们的访问权限或他们的数据的全部范围*。

# java - 在 JSF 标记库中 h:c:f: 和 ui: 到底是什么意思？

> ID：11640635
> 
> 赞同：7
> 
> 时间：2012-07-24T23:13:11.980
> 
> 标签：java, jsf, jakarta-ee, servlets, facelets

在 JSF 和 Facelets 标签中，这些前缀究竟是什么？

*   H：
*   C：
*   F：
*   用户界面：

例如：`h:head` `c:catch` `f:event` `ui:decorate`等。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-24T23:34:02.173

前缀用于限定标记属于特定标记库或在 XML 中使用命名空间。前缀以某种方式在 JSF 页面的顶部声明（具体取决于您使用的是 JSP 还是 Facelets）。“h”通常对应于 HTML 库，但您可以使用任何您想要的字母（或单词）作为前缀。常见的映射有：

```
h http://java.sun.com/jsf/html
f http://java.sun.com/jsf/core
c http://java.sun.com/jsp/jstl/core
fn http://java.sun.com/jsp/jstl/functions
ui http://java.sun.com/jsf/facelets 
```

# javascript - 在 javascript 函数之间传递 Json 值

> ID：11640638
> 
> 赞同：0
> 
> 时间：2012-07-24T23:13:29.440
> 
> 标签：javascript, html, javascript-events

我正在获取 JSon 数据，我正在使用 dom 来显示数据，我想嵌入一个指向显示的每个搜索结果的链接，当单击该链接时，将该数据实例传递到另一个块并显示该结果

我的 HTML 代码是

```
<html>
<body>
<div id:block 1 >
<div id:block 2>
<div id:block 3>
</body> 
```

我的 Javascript 函数是

```
function addBooks(data) { // the data is a list of JSON objects

    var listdiv = document.createElement('li');
    listdiv.setAttribute('id', 'gBookListDiv');
    listdiv.innerHTML = ("Books Found:");
    parent.appendChild(listdiv);

    for(i = 0; i < data.length; i++) {

        //create each list item 
        var listItem = document.createElement('li');
        var link = document.createElement('a');
        listItem.setAttribute('id', 'gBookListItem');
        parent.appendChild(listItem);
        link.setAttribute('href', '#');
        link.setAttribute('onclick', 'displayBook(data[i])');

        listItem.appendChild(link);
    }
}

function displayBook(bookData) {
    alert(bookData.title);
    if(document.getElementById("block2").style.display == "block") {
        document.getElementById("block2").style.display = "none";
        document.getElementById("block3").style.display = "block";
    }
    var headerTitle = document.getElementById('book-profile-title-header');
    headerTitle.innerHTML = bookData.title;

    var title = document.getElementById('book-profile-pic');
    headerTitle.innerHTML = bookData.title;

} 
```

出于某种原因，我无法将数据实例传递给 displayBook 函数。

这是我在 chrome 上遇到的错误

> 未捕获的 ReferenceError：未定义数据

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T23:16:56.567

问题在于这段代码：

```
link.setAttribute('onclick', 'displayBook(data[i])'); 
```

处理程序在全局上下文中运行，因此`data`未在此处定义。请改用实数函数：

```
(function(i) {
    link.onclick = function() { displayBook(data[i]); }
})(i); 
```

`i`围绕它的自执行函数需要在每次迭代中单独创建。

# asp.net-web-api - 带有 URI 参数的 WebAPI RC GetAll

> ID：11640639
> 
> 赞同：3
> 
> 时间：2012-07-24T23:13:47.687
> 
> 标签：asp.net-web-api

以前在 WebAPI（测试版）中，我能够创建一个“GetAll”方法，该方法接受在 URI 上添加的可选参数：

```
http://localhost/api/product?take=5&skip=10 
```

这似乎仍然有效，但前提是我包含所有参数。在 (beta) 中，我可以省略参数 ( `http://localhost/api/product/`)，并且会调用“GetAll”方法（take & skip 将为空）。我也可以省略一些参数`http://localhost/api/product?take=5`（跳过将为空）

```
public IEnumerable<ProductHeaderDto> GetAll(int? take, int? skip)
{
    var results = from p in productRepository
                  select new ProductHeaderDto
                    {
                        Id = p.Id,
                        Version = p.Version,
                        Code = p.Code,
                        Description = p.DescriptionInternal,
                        DisplayName = p.Code + " " + p.DescriptionInternal
                    };
    if (skip != null) results = results.Skip(skip.Value);
    if (take != null) results = results.Take(take.Value);
    return results;
} 
```

在 (RC) 中，我现在得到“在与请求匹配的控制器‘产品’上找不到任何操作。” 当缺少两个或一个参数时。我尝试在方法参数上添加 [FromUri] 但这没有影响：

```
public IEnumerable<ProductHeaderDto> GetAll([FromUri] int? take, [FromUri] int? skip) 
```

我也尝试过设置默认值：

```
public IEnumerable<ProductHeaderDto> GetAll(int? take = null, int? skip = null) 
```

尝试匹配方法签名时是否可以使用某种“可选”参数属性？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T18:59:43.717

这是已在 RTM 中修复的错误。您可以通过指定默认值来获得可选参数。

```
public IEnumerable<string> Get(int? take = null, int? skip = null) 
```

[顺便说一句，您可以使用web api odata 包](http://www.nuget.org/packages/Microsoft.AspNet.WebApi.OData)中的$skip 和 $top来实现相同的功能。

# java - 在java中通过3个线程访问变量

> ID：11640640
> 
> 赞同：0
> 
> 时间：2012-07-24T23:13:58.707
> 
> 标签：java, multithreading

我有一个具有三个线程和一个存储数据的哈希图的类。其中一个线程将数据写入 hashmap，另外两个线程读取它。像这样的东西：

```
public static class collector{
  Thread writter;
  Thread reader1;
  Thread reader2;
  HashMap storage;
  ...
  public void write(String s){
    storage.put(s.hashcode(),s);
  }
  public String read(long hash){
    return storage.get(hash);
  }
  public Set readAll(){
    return storage.entrySet();
  }
} 
```

我希望第一个线程（编写器）运行第一个方法（写入），reader1 运行 read，reader 2 运行 readAll。但是我无论如何都找不到访问线程中的存储（运行方法）。如何编写线程以像这 3 种方法一样运行，同时它们都可以同时访问存储？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T23:16:29.823

首先，要使此类线程安全，您应该使用线程安全的哈希映射实现，`java.util.concurrent.ConcurrentHashMap`而不是普通的 old `java.util.HashMap`。

另一位发帖人建议`collector`在单例中保存一个实例，这相当于一个全局变量。我不会使用全局数据，而是将一个`collector`实例传递给每个线程。您可以定义一个子类，`Runnable`该子类将`collector`实例作为其构造函数的参数。将 存储`collector`在实例变量中。然后在`run()`方法中使用它。当你启动你的线程时，给`Runnable`每个线程一个不同的对象（使用适当的`Thread`构造函数）。

就像是：

```
class MyTask implements Runnable {
  private collector myCollector;
  public MyTask(collector _myCollector) {
    myCollector = _myCollector;
  }
  public void run() {
    // do something with myCollector
  }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T23:31:49.210

由于你的类是静态的，你可以简单地从线程的 run 方法调用collector.write。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T23:16:15.023

使用该变量编写一个单例类，并使用 write、read、readAll 方法。看到您在`storage`对象上同步或同步方法。从三个线程访问这个单例类。

# image - 在 Magento 中替换产品图片

> ID：11640643
> 
> 赞同：0
> 
> 时间：2012-07-24T23:14:50.370
> 
> 标签：image, magento, product

我想用已压缩（减小文件大小）的重复图像替换我的整个产品图像目录。图像名称等与现有图像相同。我不确定它是否像将新图像上传到媒体/导入一样容易？非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T17:46:01.170

如果您要运行导入，那么 media/import 中的图像会很有用。加载图像后，它们最终会出现在 media/catalog/product 目录中。在那里，您会发现一系列目录（两层深），每层都有一个字母（例如 media/catalog/product/a/a 到 media/catalog/product/z/z）。这些子目录的两个字母取自图像文件名的前两个字符。例如，如果您的图像文件名为 my_image.jpg，那么它将位于 media/catalog/product/m/y/my_image.jpg 中。

因此，您可以使用更新的图像文件替换 media/catalog/product/m/y/my_image.jpg 中的图像。那和刷新您的图像缓存应该是您正在寻找的更改。

# c - 允许用户搜索名称排序列表的程序冻结

> ID：11640645
> 
> 赞同：1
> 
> 时间：2012-07-24T23:15:03.973
> 
> 标签：c

我正在尝试编写一个程序，该程序采用名称列表，对这些名称进行排序，并允许用户从该列表中搜索名称。程序可以编译，但是一旦用户输入“y”来搜索名称并输入了他想要搜索的名称，程序就会冻结。

我很感激任何帮助！

```
#include <stdio.h>
#include <stdbool.h>
#include <string.h>

#define NUM_OF_NAMES 8
#define NAME_SIZE 5

void printNames(char names[][NAME_SIZE], int size);
void bubbleSortNames(char names[][NAME_SIZE], int last);
bool binarySearchNames(char list[][NAME_SIZE], int end, char target[], int *location);

int main()
{
    char nameList[NUM_OF_NAMES][NAME_SIZE] = {"Bob", "Sue", "Jake","Rod", "Jon", 
                                              "Ash", "Deb", "Kay"};
    char searchText[NAME_SIZE];
    char userChoice;
    int searchLocation;

    printf("\n\n\nLIST BEFORE SORTING\n");    
    printNames(nameList, NUM_OF_NAMES);
    bubbleSortNames(nameList, NUM_OF_NAMES);

    printf("\n\n\nLIST AFTER SORTING\n");
    printNames(nameList, NUM_OF_NAMES);

    printf("\n\n\nWould you like to search for a name? (y/n) ");
    scanf(" %c", &userChoice);

    while(userChoice == 'y')
    {
        printf("\n\n\nPlease try to search for a name: ");
    scanf("%c", searchText);

    if(!(binarySearchNames(nameList, NUM_OF_NAMES, searchText, &searchLocation)))
            printf("\n\n\nThe name %c was not found.\n", searchText); 
    else
    {
        printf("\n\n\nThe name %s was found at location %d!", searchText, 
                   searchLocation);
    }
    }

    printf("\n\n\nThank you for using this program.\n\n\n");

    return 0;
}

/********************************
Prints the names from the array.
********************************/
void printNames(char names[][NAME_SIZE], int size)
{
    int index;

    for(index = 0; index < size; index++)
        puts(names[index]);

    return;
}

/*******************************
Sorts the names from the array.
*******************************/
void bubbleSortNames(char names[][NAME_SIZE], int last)
{
    char temp[NAME_SIZE];
    int current;
    int walker;

    for(current = 0; current < last; current++)
    {
        for(walker = last; walker > current; walker--)
        {
            if(strcmp(names[walker], names[walker - 1]) < 0)
        {
                strncpy(temp, names[walker - 1], sizeof(temp) - 1);
        strncpy(names[walker - 1], names[walker], sizeof(names[walker - 1]) 
                        -  1);
        strncpy(names[walker], temp, sizeof(names[walker]) - 1);
            }
        }
    }

    return;
}

/*********************************
Searches for names to be printed.
*********************************/
bool binarySearchNames(char list[][NAME_SIZE], int end, char target[], int* location)
{
    int first = 0,
        last,
        mid;

    last = end;   

    while(first <= last);
    {
        mid = (first + last) / 2;

    if(strcmp(target, list[mid] > 0) 
        first = mid + 1;
    else if(strcmp(target, list[mid]) < 0)
        last = mid - 1;
    else
        first = last +  1;
    }

    *location = mid + 1;

    return (strcmp(target, list[mid]) == 0);
 } 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-24T23:17:27.027

改变这个：

```
if(strcmp(target, list[mid] > 0)) 
```

进入这个：

```
if(strcmp(target, list[mid]) > 0) 
```

注意括号（也许考虑使用一个突出匹配括号的编辑器）。

# matrix - 使用 d3.js 生成类矩阵图

> ID：11640649
> 
> 赞同：2
> 
> 时间：2012-07-24T23:15:25.320
> 
> 标签：matrix, d3.js, rect

我有一个矩阵，每个单元格都有一个 RGB 值。我想根据每个矩阵单元的 RGB 值将该矩阵投影到相应的矩形图上。最好的方法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-25T00:31:32.430

[我在http://bl.ocks.org/2605010](http://bl.ocks.org/2605010)创建了一个如何在 d3.js 中创建网格的示例。它包括通过设置填充为单元格着色的代码。

# postgresql - 是否可以使用 Liquibase 和 PostgreSQL 将列默认设置为 LOCALTIMESTAMP？

> ID：11640654
> 
> 赞同：0
> 
> 时间：2012-07-24T23:16:27.707
> 
> 标签：postgresql, liquibase

我想在 TIMESTAMP WITH TIME ZONE 类型的表上有一个列，但它默认为插入行的时间。我们使用 Liquibase，所以我想使用标准的 Liquibase 语法来完成这项工作。

我希望它看起来像：

```
<changeSet author="chuck" id="2012-07-24.1">
    <addColumn tableName="foo">
        <column name="createdOn" type="timestamp" defaultValue="LOCALTIMESTAMP">
            <constraints nullable="false"/>
        </column>
    </addColumn>
</changeSet> 
```

这将生成 SQL：

```
ALTER TABLE foo ADD "createdOn" TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT 'LOCALTIMESTAMP'; 
```

我可以修改此语句并删除 LOCALTIMESTAMP 周围的单引号，它将在 psql 中执行。

```
ALTER TABLE foo ADD "createdOn" TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT LOCALTIMESTAMP; 
```

有没有其他人在使用 Liquibase 和 PostgreSQL 时遇到过这种情况？我可以将其重写为一个声明作为一种解决方法，但我想尝试以 Liquibase 的方式执行此操作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-09-16T12:48:23.577

是的，defaultValueComputed 有效。

```
<column name="actiondate" type="timestamp with time zone" defaultValueComputed="current_timestamp"/> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-25T05:34:08.717

使用[defaultValueComputed](http://www.liquibase.org/manual/column)进行函数调用。`defaultValue`假定一个字符串值。

# c# - C# 正则表达式：用相同的值替换两个匹配项中的任何一个

> ID：11640667
> 
> 赞同：1
> 
> 时间：2012-07-24T23:17:35.077
> 
> 标签：c#, regex

尝试在字符串中进行一些正则表达式匹配和替换，从而将所有与符号、单引号和空格字符替换为破折号“-”

...和

所有重复的破折号都替换为单个破折号。

这是我正在尝试的，但它不起作用，因为重复的破折号没有被替换。任何帮助表示赞赏和感谢。

```
Regex.Replace(mystring, "([' &])|([-]{2,})", "-") 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-24T23:30:49.507

试试这个（看起来更简单）。我假设您从不希望结果中出现“--”。

```
string orig = "12467&89- 1&2467'89 12'46789 12467--89";

Regex regex = new Regex("[&' -]+");

string newString = regex.Replace(orig, "-"); 
```

输出：

```
12467-89-1-2467-89-12-46789-12467-8 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T23:25:04.817

该正则表达式应该可以工作：

你只需要完成任务：

```
mystring = Regex.Replace(mystring, "([' &])|([-]{2,})", "-"); 
```

字符串是不可变的，记得吗？

# c# - 在 ASP.net C# 中检索复选框列表的“选择”时出现问题

> ID：11640668
> 
> 赞同：0
> 
> 时间：2012-07-24T23:17:35.460
> 
> 标签：c#, asp.net, ascx

我有一个复选框列表，它使用绑定从数据库中获取其列表项，如下面的片段所示：

```
 CheckBoxList1.DataSource = GetValues();
 CheckBoxList1.DataBind(); 
```

获取值（）：

```
 var query = tran_DContext.get_ImportTabs();
    foreach (var item in query)
    {
        TabList.Add(item.TabName);
    }

    return TabList; 
```

上面的代码片段成功地检索到 TabName 列并将其放在复选框列表中。但是，当在网站上选中复选框时，“选择”值不会流向我的代码。我错过了什么吗？我有以下代码：

```
 private List<string> SelectedTabs()
{
    string strTemp = string.Empty;
    List<string> Seltabs = new List<string>();

    foreach (ListItem lst in CheckBoxList1.Items)
    {
        if (lst.Selected)
            Seltabs.Add(CheckBoxList1.SelectedValue);
    }
    return Seltabs;
} 
```

帮助？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-25T00:12:19.503

问题存在于您的 foreach 循环中。选择多个值时调用`CheckBoxList1.SelectedValue`将导致返回第一个选择的值。

试试这个：

```
foreach (ListItem lst in CheckBoxList1.Items)
{
    if (lst.Selected)
        Seltabs.Add(lst.Value);
} 
```

# c# - 字符串与双精度比较？

> ID：11640670
> 
> 赞同：0
> 
> 时间：2012-07-24T23:18:20.020
> 
> 标签：c#, linq, double

嗨，我正在尝试对我的网络服务中的某些内容进行字符串匹配，但是我在比较双精度时遇到了困难

```
public List<Customers> GetCustomer(string anything)
{
    List<Customers> customers = customermembers.Where(n =>
    string.Equals(n.CustomerID, anything, StringComparison.CurrentCultureIgnoreCase)
    || string.Equals(n.FirstName, anything, StringComparison.CurrentCultureIgnoreCase)
    || string.Equals(n.LastName, anything, StringComparison.CurrentCultureIgnoreCase)
    || double.Equals(n.Age, anything, StringComparison.CurrentCultureIgnoreCase) //this like
    ).ToList();
    return customers;
} 
```

你如何比较双标？

我的 DataContract 看起来像这样：

```
[DataMember(Name = "Age")]
public double Age { get; set; } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T23:26:58.617

像这样的东西

```
public bool DoubleEqualsString(double doubleValue, string stringValue)
{
    double convertedValue;
    if (Double.TryParse(stringValue, out convertedValue))
        return convertedValue == doubleValue;

    return false;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T23:27:58.853

代替：

```
double double1 = Age; 
```

和

```
string double1 = Age.ToString(); 
```

然后在您的比较中使用：

```
string.Equals(double1, anything, StringComparison.CurrentCultureIgnoreCase) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-24T23:30:02.597

> 你如何比较双标？

我假设您想比较两个代表年龄的双精度值，这`anything`确实不是 a`string`而是 a `double`（从问题中很难判断，因为使用的方式`anything`没有多大意义）。

您可以做的最好的事情是将`Age`from的类型切换`double`到（如果年龄是整数则`decimal`更好）。`int`这样做可以避免舍入错误。

但是，如果您想坚持使用浮点数，您可以`double`使用以下方法简单地比较两个值`==`：

```
a == b 
```

或使用静态`object.Equals`方法：

```
Equals(a, b) 
```

如果您对年龄进行计算，您可能会遇到舍入问题，然后您将不得不使用一个小的*epsilon*值来表示您要使用的舍入精度：

```
const double Epsilon = 0.0000000001;
var areEqual = Math.Abs(a - b) < Epsilon; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-24T23:26:55.963

在进行比较之前将 double 转换为 String。试试这个：将查询的最后一行替换为

```
|| String.Equals(SqlFunctions.StringConvert(n.Age), anything, StringComparison.CurrentCultureIgnoreCase) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-24T23:27:18.513

如何创建一个尝试将字符串解析为双精度并返回 -1 表示“不走运”的函数？

```
 public double ParseAge(string age){
      double parsedAge = -1;
      Double.TryParse(age, out parsedAge);
      return parsedAge;
 }

 public List<Customers> GetCustomer(string anything)
 {
    double double1 = Age;
    List<Customers> customers = customermembers.Where(n =>
                                       string.Equals(n.CustomerID, anything, StringComparison.CurrentCultureIgnoreCase)
                                       || string.Equals(n.FirstName, anything, StringComparison.CurrentCultureIgnoreCase)
                                       || string.Equals(n.LastName, anything, StringComparison.CurrentCultureIgnoreCase)
                                       || n.Age == ParseAge(anything) //this like
                                   ).ToList();
    return customers;
 } 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-24T23:27:21.300

请使用[Double.TryParse](http://msdn.microsoft.com/en-us/library/3s27fasw.aspx)方法将字符串转换为双精度，然后可以使用 == 运算符进行比较

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-07-24T23:33:08.587

在您使用它进行比较之前，我肯定会将字符串转换为双精度。

进一步 double.Equals 有点棘手，因为此方法会处理您的数字逗号后的确切位数，这意味着

```
double d1 = 0.33333d;
double d2 = 1/3;

bool result = double.Equals(d1, d2); 
```

尽管您希望它们相等，但显然是错误的。

为避免此问题，我会将逗号后位数较多的双精度数修剪为逗号后位数较少的双精度数。

例如：

```
double d1 = 0.167832;
double d2 = 0.1564; 
```

会融化成

```
double d1 = 0.1678
double d2 = 0.1564 
```

现在您可以比较它们而不必担心。

# iphone - 我的类别扩展无法正常工作

> ID：11640671
> 
> 赞同：0
> 
> 时间：2012-07-24T23:18:27.130
> 
> 标签：iphone, objective-c, xcode, cocoa-touch

我在我的 NSString 类中添加了一个类别扩展。该方法基本上以某种方式格式化字符串。我有：

```
- (NSString *)formatStringAsColor {
    NSString *formattedString = [NSString stringWithFormat:(@"%@ color", self)];
    return formattedString;
} 
```

然后我尝试在我的应用程序的其他地方调用此方法，但它说找不到。

我尝试类似： `NSString *string = [myOtherString formatStringAsColor];`

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T23:31:52.453

该代码中有几个错误。以下修复：

```
- (NSString*) formatStringAsColor {
                                                           v                 v
    NSString* formattedString = [NSString stringWithFormat: @"%@ color", self];
           v
    return formattedString;
} 
```

现在应该工作得更好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-25T01:05:27.690

确保您包含在您要使用的每个文件的头文件中：

```
#import "NSString+[nameOfExtension].h" 
```

因此，如果您的扩展/类别文件的名称是 NSString+Color，则将 [nameOfExtension] 替换为 Color。

# ruby-on-rails - 选择元素并在条件下单击链接

> ID：11640680
> 
> 赞同：-1
> 
> 时间：2012-07-24T23:19:50.613
> 
> 标签：ruby-on-rails, ruby, mechanize, mechanize-ruby

如何编写将在指定条件下单击网页上的链接的代码：

该脚本应查看每个 div.table-row 并检查 div 中的列表元素 (div.domains ul li) 是否包含特定字符串 (somedomain.com)，然后单击 div.actions 中的链接 a.delete 链接在 div.table-row 里面。

继承人的HTML结构：

```
<div class="table-row">
  <div class="domains">
    <ul>
    <li>somedomain.com</li
    <li>someotherdomain.com</li>
    </ul>
  </div>
  <div class="actions">
    <ul class="menu">
    <li><a class="delete">Delete</a></li>
  </div>
</div> 
```

如何在 ruby​​ mechanize 中编写此代码？

如果满足条件，我不知道如何选择所有 .table-rows 并遍历它们以单击删除链接？

感谢帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T23:35:29.997

您需要使用 Javascript（而不是 RoR）来遍历元素并检查正确的类名。无法以编程方式“单击”链接，但您可以使用 Javascript 执行所需的操作。

```
<div class="table-row">
 <div class="domains">
  <ul>
   <li class="domain1">somedomain.com</li>
   <li class="domain2">someotherdomain.com</li>
  </ul>
 </div>
<div class="actions">
 <ul class="menu">
  <li><a class="delete">Delete</a></li>
</div> 
```

至于 Javascript，使用 JQuery 之类的 Javascript 框架最容易做到这一点，但手动它看起来像这样：

```
<script type="text/javascript">
  function searchForDomains(domainName) {
   var divs = document.getElementsByTagName('DIV');
    for (var i = 0; i < divs.length; i++) {
     var div = divs[i];
     if (div.className == 'table-row') {
       var tableRow = div;
       var lis = tableRow.getElementsByTagName('LI');
       for (var j = 0; j < lis.length; j++) {
         var li = lis[j];
         if (li.innerHTML == domainName) {
          doDelete(tableRow);
       }
     }
    }
  }

  function doDelete(tableRow) {
    // do whatever it is that you'd like to see happen if the delete link was clicked.
  } 
```

它的作用是遍历页面上的所有 DIV，当它找到一个具有正确类的 DIV 时，它会遍历该 DIV 内的所有 LI，当它找到一个具有您要查找的域的 LI 时，它会调用执行某些操作的函数。您可以在页面加载时调用此函数，或者在响应用户操作（如按下按钮）时调用此函数。

# c++ - 将互斥保护构建到 C++ 类中的线程安全方法？

> ID：11640681
> 
> 赞同：3
> 
> 时间：2012-07-24T23:19:52.140
> 
> 标签：c++, multithreading, mutex

我正在尝试为我正在处理的项目在 C++ 中实现生产者/消费者模型多线程程序。基本思想是主线程创建第二个线程来监视串行端口的新数据，处理数据并将结果放入由主线程定期轮询的缓冲区中。我以前从未编写过多线程程序。我一直在阅读很多教程，但它们都是用 C 语言编写的。我想我已经掌握了基本概念，但我正在尝试对其进行 c++ 化。对于缓冲区，我想创建一个内置互斥保护的数据类。这就是我想出的。

1）我是不是走错了路？有没有更聪明的方法来实现受保护的数据类？

2) 如果两个线程同时尝试调用，下面的代码会发生什么`ProtectedBuffer::add_back()`？

```
#include <deque>
#include "pthread.h"

template <class T>
class ProtectedBuffer {
  std::deque<T> buffer;
  pthread_mutex_t mutex;
public:
  void add_back(T data) {
    pthread_mutex_lock(&mutex);
    buffer.push_back(data);
    pthread_mutex_unlock(&mutex);
  }
  void get_front(T &data) {
    pthread_mutex_lock(&mutex);
    data = buffer.front();
    buffer.pop_front();
    pthread_mutex_unlock(&mutex);
  }
}; 
```

编辑：感谢所有伟大的建议。我试图在下面实现它们。我还添加了一些错误检查，所以如果一个线程以某种方式设法尝试锁定同一个互斥锁两次，它将优雅地失败。我认为。

```
#include "pthread.h"
#include <deque>

class Lock {
    pthread_mutex_t &m;
    bool locked;
    int error;
public:
    explicit Lock(pthread_mutex_t & _m) : m(_m) {
        error = pthread_mutex_lock(&m);
        if (error == 0) {
            locked = true;
        } else {
            locked = false;
        }
    }
    ~Lock() {
        if (locked)
            pthread_mutex_unlock(&m);
    }
    bool is_locked() {
        return locked;
    }
};

class TryToLock {
    pthread_mutex_t &m;
    bool locked;
    int error;
public:
    explicit TryToLock(pthread_mutex_t & _m) : m(_m) {
        error = pthread_mutex_trylock(&m);
        if (error == 0) {
            locked = true;
        } else {
            locked = false;
        }
    }
    ~TryToLock() {
        if (locked)
            pthread_mutex_unlock(&m);
    }
    bool is_locked() {
        return locked;
    }
};

template <class T>
class ProtectedBuffer{
    pthread_mutex_t mutex;
    pthread_mutexattr_t mattr;
    std::deque<T> buffer;
    bool failbit;

    ProtectedBuffer(const ProtectedBuffer& x);
    ProtectedBuffer& operator= (const ProtectedBuffer& x);
public:
    ProtectedBuffer() {
        pthread_mutexattr_init(&mattr);
        pthread_mutexattr_settype(&mattr, PTHREAD_MUTEX_ERRORCHECK);
        pthread_mutex_init(&mutex, &mattr);
        failbit = false;
    }
    ~ProtectedBuffer() {
        pthread_mutex_destroy(&mutex);
        pthread_mutexattr_destroy(&mattr);
    }
    void add_back(T &data) {
        Lock lck(mutex);
        if (!lck.locked()) {
            failbit = true;
            return;
        }
        buffer.push_back(data);
        failbit = false;
    }
    void get_front(T &data) {
        Lock lck(mutex);
        if (!lck.locked()) {
            failbit = true;
            return;
        }
        if (buffer.empty()) {
            failbit = true;
            return;
        }
        data = buffer.front();
        buffer.pop_front();
        failbit = false;
    }
    void try_get_front(T &data) {
        TryToLock lck(mutex);
        if (!lck.locked()) {
            failbit = true;
            return;
        }
        if (buffer.empty()) {
            failbit = true;
            return;
        }
        data = buffer.front();
        buffer.pop_front();
        failbit = false;
    }
    void try_add_back(T &data) {
        TryToLock lck(mutex);
        if (!lck.locked()) {
            failbit = true;
            return;
        }
        buffer.push_back(data);
        failbit = false;
    }
}; 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-24T23:27:39.890

几件事：

*   您需要在构造函数中初始化`mutex`并在析构函数中[`pthread_mutex_init`](http://pubs.opengroup.org/onlinepubs/7908799/xsh/pthread_mutex_init.html)释放它。`pthread_mutex_destroy`

*   您必须使您的类不可复制和不可分配（或以其他方式正确实现复制构造函数和赋值运算符；见上文）。

*   为锁创建一个 SBRM 助手类是值得的：

    ```
    class Lock
    {
        pthread_mutex_t & m;
    public:
        explicit Lock(pthread_mutex_t & _m) : m(_m) { pthread_mutex_lock(&m); }
        ~Lock() { pthread_mutex_unlock(&m); }
    }; 
    ```

    现在您可以制作一个同步范围，例如`{ Lock lk(mutex); /* ... */ }`.

至于问题2：并发访问是通过锁定互斥锁的方式进行序列化的。竞争线程之一将在获取互斥锁时休眠。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-25T00:15:35.213

> 我会以错误的方式解决这个问题吗？有没有更聪明的方法来实现受保护的数据类？

对于您的实施，我认为您有一个良好的开端。既然您询问了 C++ifying，那么如果您有一个支持 C++11 的编译器，则可以使用新的线程支持。

您提到您希望主线程轮询此缓冲区，但我没有看到任何允许它这样做的机制。当缓冲区中没有任何`get_front`内容时应该提供错误，或者`get_buffer`应该阻止调用者直到数据可用。

```
#include <deque>
#include <mutex>
#include <condition_variable>
#include <stdexcept>

template <class T>
class ProtectedBuffer {
  std::deque<T> buffer;
  std::mutex mtx;
  std::condition_variable empty_cnd;
  void get_front_i(T &data) {
    data = buffer.front();
    buffer.pop_front();
  }
public:
  void add_back(T data) {
    std::lock_guard<std::mutex> g(mtx);
    bool was_empty = buffer.empty();
    buffer.push_back(data);
    if (was_empty) empty_cnd.notify_one();
  }
  void get_front_check(T &data) {
    std::lock_guard<std::mutex> g(mtx);
    if (buffer.empty()) throw std::underflow_error("no data");
    get_front_i(data);
  }
  void get_front_block(T &data) {
    std::lock_guard<std::mutex> g(mtx);
    std::unique_lock<std::mutex> u(mtx);
    while (buffer.empty()) empty_cnd.wait(u);
    get_front_i(data);
    if (!buffer.empty()) empty_cnd.notify_one();
  }
}; 
```

如果您想限制添加到缓冲区的数据量，您可以添加一个类似的`full_cnd`条件变量来检查`add_back`调用将等待的完整条件（如果为真）。然后，该`get_front_i`方法可以在缓冲区不再满时发出信号。

> 如果两个线程同时尝试调用 ProtectedBuffer::add_back()，下面的代码会发生什么？

由于`add_back`受到互斥保护，如果两个线程同时调用它，一个线程将被阻止调用`push_back`，直到另一个线程完成。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T23:32:56.620

你有基础知识，但我会更进一步，将互斥锁本身包装在它自己的 RAII 包装器中，例如：

```
#include <deque> 
#include "pthread.h" 

class ProtectedMutex
{
  pthread_mutex_t &mutex; 
public:
  ProtectedMutex(pthread_mutex_t &m)
    : mutex(m); 
  {
    pthread_mutex_lock(&mutex); 
  }
  ~ProtectedMutex()
  {
    pthread_mutex_unlock(&mutex); 
  }
};

template <class T> 
class ProtectedBuffer { 
  std::deque<T> buffer; 
  pthread_mutex_t mutex; 
public: 
  void add_back(T data) { 
    ProtectedMutex m(mutex); 
    buffer.push_back(data); 
  } 
  void get_front(T &data) { 
    ProtectedMutex m(mutex); 
    data = buffer.front(); 
    buffer.pop_front(); 
  } 
}; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-24T23:42:52.357

' 将结果放入由主线程定期轮询的缓冲区中' - CPU 浪费和延迟。

“我是不是走错路了？” - 是的。我不知道您的系统对辅助线程<> GUI 线程通信有什么样的支持，但总有 PostMessage() API。

当然，您需要一个 Buffer 类，它具有串行 rx 数据的数据成员和执行协议/“处理数据”的方法。你不需要太多其他东西。在您的第二个线程中，创建一个缓冲区类实例。加载它，处理数据和 PostMessage/dispatch/BeginInvoke 它指向您的 GUI 线程的指针。在串行线程的下一行代码中，在同一个实例指针 var 中创建另一个实例，以便从串行端口加载下一次数据。在 GUI 中显示/记录/任何内容之后，GUI 线程应该删除（）它收到的 *Buffer。

没有延迟，没有 CPU 浪费，没有数据复制，串行线程和 GUI 线程不可能在同一个缓冲区实例上工作，没有讨厌、复杂的缓冲区共享代码，没有锁，没有麻烦。它会运作良好。

其他任何事情都会变得混乱。

编辑-忘记了（2）-不知道，。不会用驳船杆碰它..

# perl - 从 perl 管道运行“less”

> ID：11640682
> 
> 赞同：6
> 
> 时间：2012-07-24T23:20:00.240
> 
> 标签：perl, exec, fork, pipe, dup

我正在尝试从 Perl 设置任意管道，其方式与 shell 可能相同。

这具有预期的效果，就像“echo foo | sed s/oo/ar/”：

```
#!/usr/bin/perl
use strict;

use IO::Handle;

$| = 1;

my ($first_prog, $second_prog) = ([qw(echo foo)], [qw(sed s/oo/ar/)]);
#$second_prog = ["less"];

pipe(my $second_prog_input, my $first_prog_output)   
    or die "problem setting up pipe: $!\n";

if (fork) {
    STDOUT->fdopen(fileno($first_prog_output), 'w') or die;
    exec(@$first_prog) or die;
}
else {
    STDIN->fdopen(fileno($second_prog_input), 'r') or die;
    exec(@$second_prog) or
      die "couldn't exec: $!: command was @$first_prog\n";
} 
```

但是，当我将第二个参数设为“less”时，我的终端会闪烁，并且在寻呼机中看不到输出。除了短暂的闪光之外，根本没有减少跑步的迹象。

现在我根本没有得到的是以下行为确实像“echo foo | less”：

```
pipe(my $first_prog_output, STDIN) or die "problem setting up pipe: $!\n";

my ($first_prog, $second_prog) = ([qw(echo foo)], ["less"]);

open($first_prog_output, "-|", @$first_prog) or
  die "$!: command was @$first_prog\n";

exec(@$second_prog) or
  die "couldn't exec: $!: command was @$first_prog\n"; 
```

但我根本不明白对 pipe() 的调用在做什么。第一个参数应该是“读者”，第二个参数应该是“作者”。STDIN 如何成为“作家”？

我对这一切感到非常困惑，并认为我可能遗漏或忘记了底层 Unix API 的一些基本内容。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-25T04:35:14.413

这是一个有趣的时间问题：

*   Shell fork，创建一个进程组，将终端前台组设置为它，然后执行 execs `perl`。
*   `perl`分叉和高管`less`。
*   `perl`高管`echo`。
*   `echo`退出，shell 认为工作已完成，并再次将自己设置为终端前台进程组。
*   `less`试图获取终端。它不在终端前台进程组中。 `less`失败。

最简单的解决方案：更改`fork`为`!fork`（或等效地，交换您的`if`和`else`块）。这样，管道的最后阶段就定义了作业的生命周期。（如果您仔细观察，shell 在运行管道时也会以相同的顺序分叉和执行进程。）

# node.js - 无法在 node.js 收件箱模块中加载 iconv

> ID：11640688
> 
> 赞同：1
> 
> 时间：2012-07-24T23:21:32.593
> 
> 标签：node.js, windows-7, iconv

我最近一直在 Ubuntu 12.04 上进行一些 node.js 开发，但是 Ubuntu 的 openssl 中的一个错误加上它为我的 Zenbook 提供的非常糟糕的电池寿命，我决定再次启动 Windows 7 作为我的主要操作系统。我在关闭 Linux 之前检查了我的代码，并将所有内容推送到 github。我在 Windows 上克隆了我的 github 存储库，运行 'npm install' 没有错误，然后尝试运行我的应用程序，但我收到此错误：

```
> node.js:201
>         throw e; // process.nextTick error, or 'error' event on first tick
>               ^ Error: unknown error
>     at Object..node (module.js:472:11)
>     at Module.load (module.js:348:31)
>     at Function._load (module.js:308:12)
>     at Module.require (module.js:354:17)
>     at require (module.js:370:17)
>     at Object.<anonymous> (C:\Users\Jared\Documents\GitHub\LoopMe\node_modules\inbox\node_modules\mimelib\mime-functions.js:1:75)
>     at Module._compile (module.js:441:26)
>     at Object..js (module.js:459:10)
>     at Module.load (module.js:348:31)
>     at Function._load (module.js:308:12) 
```

mime-functions.js 的第 1 行是： var Iconv = require("iconv").Iconv;

# mysql - MySQL 子查询少于 3 且放置不止一次

> ID：11640689
> 
> 赞同：1
> 
> 时间：2012-07-24T23:21:36.610
> 
> 标签：mysql, count, subquery

我有两个表，我需要查询一个名为 horse 的表，其中包含 Name 和 Horse_id 一个名为 entry 的表，其中包含 Horse_id 和 Place。（地方是马来的地方，例如第 1、第 2、第 3）。

我需要使用子查询来显示每匹多次获得第一、二或三等奖的马的名称和 ID。

到目前为止我有（我还没有进入“不止一次”的部分）

```
SELECT horse_id, name FROM 
(SELECT count(place) AS horse_id, name FROM entry)
WHERE entry.place<3; 
```

虽然这行不通。错误是“每个派生表都必须有自己的别名”。我不确定我应该命名什么，而且我发现很难找到此类查询的示例。

我也试过：

```
SELECT horse_id, name FROM horse
WHERE place IN(SELECT horse_id FROM entry WHERE entry.place<3); 
```

不知道我哪里错了

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T23:26:15.277

我很抱歉，应该更好地阅读这个问题..刚刚在我的系统上创建了表格，这很有效：

```
select name, horse_id 
FROM horse LEFT JOIN 
(select horse_id, count(horse_id) as c FROM entry where place < 4 group by horse_id) as h 
USING (horse_id) WHERE c > 1; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T23:27:52.997

最简单的解决方案是：

```
SELECT horse_id, name FROM 
(SELECT count(place) AS horse_id, name FROM entry WHERE entry.place<3) as cute_little_ponies; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T23:29:55.787

```
SELECT horse_id, name, SUM(IF(place<=3,1,0)) AS top_3_count
FROM horse
JOIN entry USING (horse_id)
GROUP BY horse_id
HAVING top_3_count > 1 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-11-06T06:15:50.907

```
SELECT Horse_id,Name FROM HORSE
WHERE Horse_id IN 
(SELECT Horse_id FROM ENTRY WHERE Place IN (1,2,3) GROUP BY Horse_id HAVING COUNT(Horse_id)>1); 
```

# java - 遍历树：Hibernate LazyFetch dto.getObjects() vs Hibernate.initialize(dto.getObjects)

> ID：11640694
> 
> 赞同：1
> 
> 时间：2012-07-24T23:22:34.040
> 
> 标签：java, hibernate

出于某种原因，当我`dto.getObjects()`在会话中使用时，它不会填充对象，但我必须使用`Hibernate.initialize(dto.getObjects)`.

有人可以向我解释原因吗？

附带问题，由于休眠没有分层查询，遍历树的最佳方法是什么。有些树有 200 个以上的节点和 4 个级别。

我需要根据它的值和一个外部变量对树中的每个节点执行一系列更新。

例子：

```
node.setB(node.getA() + abc); 
```

任何意见？我更感兴趣的是知道为什么而不是如何。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T23:52:20.667

你应该把它分成两个问题，以获得最好的答案。关于 dto.getObjects() 代理初始化：仅调用 getter 是不够的，您需要调用集合上的访问器或修改器方法之一以让 Hibernate 初始化代理。

这里的问题是，当您查询父对象时，Hibernate 介入并用代理对象替换了子集合，而不是执行查询以获取您可能需要或不需要的信息。当你在代理集合上调用一个方法，比如 size() 时，Hibernate 知道你想要实际使用这个集合，所以它会跑到 DB 并获取数据。如果您想急切地获取集合，则需要配置关系来执行此操作。有几种方法可以做到这一点，我们需要有关您的设置的以下信息以最好地帮助您：

*   实体配置（XML 与注释）
*   查询模式（Criteria、HQL 或调用 load()/get()）
*   最好是您查询方式的简短代码示例

# sql - plsql比较并获取最大值

> ID：11640703
> 
> 赞同：0
> 
> 时间：2012-07-24T23:24:40.667
> 
> 标签：sql, plsql, group-by, max

```
Student    Subj   Period  Score
-------------------------
A          Math   100        50
A          Hist   100        100
A          Sci    200        70
B          Math   100        50
B          Hist   100        50 
```

我正在尝试查询每个学生的最高分。

如果分数都相同（例如“B”，则在底部选择一个。如果不可能，请 **选择任何内容**。

我很难使用 max() 和 min() 和 group by 来获得正确的结果。结果应该是这样的

```
Student    Subj   Period    Score
-------------------------
A          Hist   100       100
B          Hist   100       50 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T23:35:31.470

您想使用分析函数（我假设这是在 Oracle 中提到的 pl/sql）：

```
select Student, Subj, Period, Score
from (select t.*,
             row_number() over (partition by student order by score desc) as seqnum
      from t
     ) t
where seqnum = 1 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-25T02:45:54.267

Gordon 的答案当然效果很好，它使用了许多数据库引擎支持的 ANSI 语法。

Oracle 有一个我认为不是 ANSI 的附加语法，但它消除了对任何子查询的需要。它的性能至少与 Gordon 的回答一样好（它可能会稍微快一些，但我不确定）。它使用 KEEP LAST 扩展来聚合函数。

```
select student,
       max(subj)   keep( dense_rank last order by score, period ) as subj,
       max(period) keep( dense_rank last order by score, period ) as period,
       max(score) as score
  from grades
 group by student
; 
```

注意 - 除非您明确想要提供随机结果，否则您应该始终构建查询以给出确定的答案，这意味着给定的数据集将始终给出相同的答案，无论数据是如何加载的。我将上述查询按最高分排序，然后是最高时段。如果仍有平局，则返回 max(subj)。

# osgi - 在 OSGi 环境中的 JavaHelp 页面中嵌入 Swing 组件？

> ID：11640704
> 
> 赞同：0
> 
> 时间：2012-07-24T23:24:45.347
> 
> 标签：osgi, javahelp

JavaHelp 是 Sun 编写的一个库，用于在 Swing 应用程序中显示 HTML 帮助页面。JavaHelp 允许将 Swing 组件嵌入到其 HTML 页面中：

```
<html>
<object classid="java:javax.swing.JButton">
   <param name="text" value="Wow, a Swing component in HTML HTML!">
</object>
</html> 
```

此处进一步讨论：http: [//docs.oracle.com/cd/E19253-01/819-0913/dev/lwcomp.html](http://docs.oracle.com/cd/E19253-01/819-0913/dev/lwcomp.html)

我在 Apache Felix 中运行一个大型 OSGi 应用程序。如上图，`classid`属性指的是我要嵌入的Swing组件类的FQN。我希望它引用我在自己的包中定义的 Swing 组件类。因为 JavaHelp 在它自己的包中运行，所以它不能引用我的包中的类。我只是`??`在HTML页面中看到，表示找不到该类。如何让 JavaHelp 包引用我的包中的类？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-25T23:15:16.140

这只是部分可能的。这就是为什么。

要解决这个问题，我们必须创建自己`HTMLEditorKit`的拦截`object`标签，然后`Component`从`object`标签的`classid`. 这是它的样子*。

```
public class OurHTMLEditorKit extends HTMLEditorKit {
    public ViewFactory getViewFactory() {
        return new HTMLEditorKit.HTMLFactory() {
            public View create(Element elem) {
                if (elem.getName().equalsIgnoreCase("object"))
                    return new InternalObjectView(elem);
                else
                    return super.create(elem);
            }
        };
    }
}

private static Object attemptToGetClass(final String className) {
    try {
        Class c = Class.forName(className);
        Object o = c.newInstance();
        return o;
    } catch (Exception e) {
        logger.error(e.getMessage());
    }
    return null;
}

private static class InternalObjectView extends ObjectView {
    public InternalObjectView(Element elem) {
        super(elem);
        logger.info(elem.toString());
    }

    protected Component createComponent() {
        AttributeSet attrs = getElement().getAttributes();
        String classname = ((String) attrs.getAttribute(HTML.Attribute.CLASSID)).trim();
        try {
            Component comp = (Component) attemptToGetClass(classname);
            setParameters(comp, attrs);
            return comp;
        } catch (Exception e) {
            logger.warn(e.getMessage());
        }
        return getUnloadableRepresentation();
    }

    // Copied from javax.swing.text.html.ObjectView with modifications to how exceptions are reported

    Component getUnloadableRepresentation() {
        Component comp = new JLabel("??");
        comp.setForeground(Color.red);
        return comp;
    }

    private void setParameters(Component comp, AttributeSet attr) {
        Class k = comp.getClass();
        BeanInfo bi;
        try {
            bi = Introspector.getBeanInfo(k);
        } catch (IntrospectionException ex) {
            logger.warn("introspector failed, ex: "+ex);
            return;             // quit for now
        }
        PropertyDescriptor props[] = bi.getPropertyDescriptors();
        for (int i=0; i < props.length; i++) {
            //      System.err.println("checking on props[i]: "+props[i].getName());
            Object v = attr.getAttribute(props[i].getName());
            if (v instanceof String) {
                // found a property parameter
                String value = (String) v;
                Method writer = props[i].getWriteMethod();
                if (writer == null) {
                    // read-only property. ignore
                    return;     // for now
                }
                Class[] params = writer.getParameterTypes();
                if (params.length != 1) {
                    // zero or more than one argument, ignore
                    return;     // for now
                }
                Object [] args = { value };
                try {
                    writer.invoke(comp, args);
                } catch (Exception ex) {
                    logger.warn("Invocation failed: " + ex.getMessage());
                    // invocation code
                }
            }
        }
    }
} 
```

* * *

但是使用 JavaHelp，不可能`HTMLEditorKit`使用`<viewregistry>`标签 [2] 来注册我们的。由于 OSGi 环境，JavaHelp 无法访问我们的`HTMLEditorKit`**。

相反，唯一可能的方法是`JEditorPane`使用我们的 创建一个，使用`HTMLEditorKit`创建我们自己的目录，并告诉在选择更改时加载帮助页面。`JTree``TOCView.parse()``JEditorPane``JTree`

* * *

*这似乎很长，但大部分代码是从`javax.swing.text.html.ObjectView`[1]复制而来的。我不得不从那里复制代码，因为`getUnloadableRepresentation`它`setParameters`是私有的，不受保护。

**由于`Dynamic-ImportPackage`清单条目 [3]，这可能是可能的。但这需要跳很多圈。首先，必须更改 JavaHelp 清单。其次，Felix 启动后，必须使用命令告诉它允许动态导入`dynamic-import`。

1.  [http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/6-b14/javax/swing/text/html/ObjectView.java#ObjectView](http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/6-b14/javax/swing/text/html/ObjectView.java#ObjectView)
2.  [http://docs.oracle.com/cd/E19253-01/819-0913/author/helpset.html#toolbar](http://docs.oracle.com/cd/E19253-01/819-0913/author/helpset.html#toolbar)
3.  [http://wiki.osgi.org/wiki/DynamicImport-Package](http://wiki.osgi.org/wiki/DynamicImport-Package)

# android - 使用 PKCS#11 的相互客户端身份验证

> ID：11640706
> 
> 赞同：0
> 
> 时间：2012-07-24T23:25:13.490
> 
> 标签：android, ssl, pkcs#11

我正在尝试创建一个浏览器应用程序，它将访问需要 TLS 相互客户端身份验证的服务器。应用程序需要能够通过 PKCS#11 接口提供客户端证书和密钥。

在查看了有关 Android 的相互 tls 的各种文章后，我相信 PKCS#11 要求排除了使用 Android KeyChain/将证书添加到 Android 上的默认密钥库（因为无法直接访问私钥）。

我有 PKCS#11 接口工作，所以我可以使用私钥来签署数据。

有没有办法拦截 Android 使用密钥对数据进行签名的调用，以便我可以使用 PKCS#11 接口？目前，我唯一的选择似乎是实现我自己的 TLS 堆栈来实现这一点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-25T02:34:15.923

这取决于:) 你的目标是什么平台？在 Jelly Bean 上，密钥库中对硬件设备有一些支持，因此您可以编写一个使用 PKCS#11 的 keymaster 模块。但是，这是一个操作系统组件，因此需要实现您自己的 ROM。您还可以开发自己的由 PKCS#11 模块支持的 JCE 提供程序。然后，在您的浏览器中，确保 SSL 引擎在进行客户端身份验证时使用您的提供程序。

# sql - 通过键值表获取行的所有属性

> ID：11640707
> 
> 赞同：0
> 
> 时间：2012-07-24T23:25:22.963
> 
> 标签：sql, sqlite, join

我有一个 Person 表和一个属性表。一个 Person 可以有 0 个或多个属性，因此我将这种关系存储在中间键值表中，例如

```
------------         --------------       ---------------
|Person     |        |key val tbl |       | attribute   |
 -----------         --------------       ---------------
|p_id|p_name|        | p_id |a_id |       | a_id |a_name|
| 1  |simon |        |  1   | 1   |       |  1   | tall |
| 2  |eric  |        |  1   | 2   |       |  2   | cool |
                     |  2   | 2   | 
```

我怎么能写一个查询来返回这样的东西？

```
|name |attr1|attr2|  
|simon|tall |cool |
|eric |     |cool | 
```

只有大约 6 个属性，这不太可能改变。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T23:38:05.340

您需要加入和聚合：

```
select p.name,
       max(case when a.a_id = 1 then a.a_name end) as attr1,
       max(case when a.a_id = 2 then a.a_name end) as attr2
from person p join
     keyval kv
     on p.key = kv.key join
     attribute a
     on kv.a_id = a.a_id
group by p.name 
```

此查询将三个表连接在一起，这将为每个人/属性对生成一个包含一行的表。最后的 group by 在人员级别聚合，“透视”行中的属性。max(case ...) 表达式只是选择 column 的属性值。

# php - PHP 中的 .toString(16)

> ID：11640708
> 
> 赞同：10
> 
> 时间：2012-07-24T23:25:39.757
> 
> 标签：php, javascript, tostring

我想`.toString(16)`在 PHP 中做与 JavaScript 相同的操作：

```
var n = 200000002713419;
console.log(n.toString(16)); 
```

这返回`b5e6211de74b`。我怎样才能用 PHP 达到同样的效果？

非常感谢。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-07-24T23:28:59.567

使用 PHP 的内置函数[`base_convert()`](http://php.net/manual/en/function.base-convert.php)或[`dechex()`](http://www.php.net/manual/en/function.dechex.php)：

```
$hex = dechex(12321313); // bc0221
$hex = base_convert(4353454654, 10, 16); // 37c723e 
```

# java - 需要包含 XYZ 的封闭实例

> ID：11640710
> 
> 赞同：1
> 
> 时间：2012-07-24T23:25:46.057
> 
> 标签：java, class, netbeans, abstract-class, instantiation

我希望有人可以帮助我。我已经研究这个问题几个小时了，似乎没有其他人遇到过同样的问题（我遇到过）。我一定犯了一些非常愚蠢的错误。

我是*Java*新手，设计了一个非常简单的*Java*程序。

我有一个名为 Student 的抽象超类。这个`Student`超类有 3 个扩展类，分别称为`Graduate`、`Undergraduate`和`PartTime`。Student 类有几个抽象方法和几个非抽象方法。我已经验证了`Students`在所有 3 个扩展类中定义的所有抽象方法都已实现。

现在我正在尝试做一些应该非常简单的事情。我正在尝试实例化这些扩展类之一。如果我这样做：

```
Student student = new Student(); 
```

*Netbeans*说`Student is abstract; can't be instantiated`。好的，好的，我明白为什么不能实例化抽象类了。然后我试试这个：

```
Student.Graduate student = new Graduate(); 
```

*Netbeans*说（`an enclosing instance that contains studentmanager.Student.Graduate is required`studentmanager 是我的包名）。我不明白那是什么意思。但是，我确实发现我可以像这样实例化 Student 而不会出错：

```
Student[] student = new Student[1]; 
```

但是，如果我尝试做下一个合乎逻辑的事情：

```
student[0] = new Graduate(); 
```

我得到同样的`an enclosing instance...`错误。

底线是我想知道如何实例化`Graduate`. 谁能帮我吗？任何见解将不胜感激！

谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-24T23:37:21.477

您是否将`Graduate`、`Undergraduate`和定义`PartTime`为 的*内部*类`Student`？也就是说，像这样：

```
public class Student {
    /* ... */
    public class Graduate extends Student { /* ... */ }
    public class Undergraduate extends Student { /* ... */ }
    public class PartTime extends Student { /* ... */ }
} 
```

内部类的实例具有对*封闭*类实例的隐式引用，因此它可以执行诸如访问封闭实例的私有字段和方法之类的事情。当您尝试实例化其中一个子类的实例时，编译器会说“嘿，等等，我不知道将隐式引用设置为什么！” 并产生错误。

有三种可能的解决方案：

*   您可以将三个子类从类中移出`Student`到它们自己的文件中定义的顶级类中。
*   您可以在子类的声明前添加关键字`static`。这告诉编译器您不希望从内部类到封闭类的隐式引用。这将阻止您执行诸如从子类访问`Student`的私有字段和方法之类的事情，但是如果您无论如何都不需要这样做，那就没有实际意义了。
*   如果*确实*需要子类来访问 的私有成员`Student`，则可以创建 的实例，`Student`然后使用这种特殊语法创建内部类的实例。

    `Student s = new Student();`
    `Graduate g = s.new Graduate();`

此`s.new`示例中的 告诉编译器 的新实例`Graduate`应该具有对 的隐式引用`s`。

请注意，在此示例中，这不太可能是您想要的。让内部类的实例可以直接修改其封闭实例的字段以执行诸如更新封闭类的状态以响应回调之类的操作通常很有用，但我怀疑这不是您的意图。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T23:40:52.657

如果您可以更改类定义，则内部类必须是静态的，以便在没有封闭实例的情况下支持实例化。例如

```
// in file Student.java
public class Student {
    public static class Graduate {}
} 
```

或将研究生移动到它自己的研究生.java文件中，会让你做

```
Student.Graduate grad = new Student.Graduate(); 
```

否则，按照 Mike D 的建议更改实例化这些类的方式。

# php - 使用 Nice Auth（CakePHP 插件）设置会话并访问会话信息。

> ID：11640712
> 
> 赞同：0
> 
> 时间：2012-07-24T23:26:12.310
> 
> 标签：php, session, cakephp, authentication

我在登录时访问会话信息时遇到问题。我正在使用 Nice Auth 的 CakePHP 插件。

我在这里遵循了一些[说明](https://stackoverflow.com/questions/1706016/how-to-find-out-my-current-user-id-in-other-page-controller-after-i-login)

我想要做的是访问用户的用户名，以便在另一个页面上他们发送支持票时不需要填写他们是谁。

这是用户控制器登录功能：

```
public function login(){
        if ($this->request->is('post') || ($this->request->is('get') && isset($this->request->query['openid_mode']))) {
            if ($this->Auth->login()) {
                $this->redirect($this->Auth->redirect());
                }
            else {
                $this->Session->setFlash(__('Invalid username or password, try again'));
                }
            }
        } 
```

这是我假设我把

```
$this->Session->write('User.id', $userId); 
```

以下是票务控制器：

```
public function send()
    {
        $userId = $this->Auth->user();
        if ( !empty($this->request->data) )
        {
            $email = new CakeEmail();
            $email->from(array('xxxx@example.com'))
                //->to($this->request->data['to'])
                ->to(array('helpdesk@example.com'))
                ->subject($this->request->data['subject']);

            if ($email->send($this->request->data['message']))
            {
                $this->Session->setFlash(__('Email Sent Successfully'),
                    'default', array('class' => 'success'));
            }
        }

    } 
```

我希望把这段代码放在哪里：

```
$userId = $this->Session->read('User.id'); 
```

然后在我的视图中显示：

```
$userId = $session->read('User.id'); 
```

现在，我已将会话组件和助手添加到文件中，因为我认为这会导致我出现问题，但没有骰子！

任何帮助是极大的赞赏。

我当前的错误消息如下所示：

```
Notice (8): Undefined variable: session [APP/View/Tickets/send.ctp, line 10] Fatal error: Call to a member function read() on a non-object in /Users/bellis/workspace/cake/app/View/Tickets/send.ctp on line 10 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T04:06:34.613

```
 set session in your $helpers array in your controller or app controller

    var $helpers=array('Session'); 

   if you have use cake 1.2 ver use above code and if you have use higher ver  like 2.0, 2.1 etc use below code

public $helpers = array('Session');

    your can set variable in controller

        $userId = $this->Session->read('User.id');

        $this->set('userid', userId );

        and directly access $userid variable in your ctp file

        OR

        You can directly access

        $userId = $this->Session->read('User.id');

        in your ctp file 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-25T04:03:57.223

使用以下方法在控制器中包含会话助手：

```
 public $helpers = array('Session',.........); 
```

并尝试在您的视图中使用以下内容：

```
$userId = $this->Session->read('User.id'); 
```

请询问它是否不适合您。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-25T17:22:04.333

事实证明，推荐的方法是这样做：

```
$userId = $this->Auth->user('id'); 
```

您可以从任何控制器通过该方法访问已登录的用户。

# scala - 如果输入文件未更改，如何使自定义任务避免重做工作？

> ID：11640715
> 
> 赞同：8
> 
> 时间：2012-07-24T23:26:16.103
> 
> 标签：scala, sbt

我有一个游戏的多项目设置。有一个名为“resources”的非常具体的子项目，它只包含要打包到 jar 中的图像、声音和 texfiles 等文件。

我有一个自定义任务来处理图像并打包它们。在“src/main”中，我使用了一个文件夹“预处理”，图像应该放在其中，而“非托管”文件夹则放在其他所有文件夹中。通过运行我的任务，“preprocess”中的所有图像都被打包并输出到“resources”，“unmanaged”中的所有内容都按原样复制。

```
val texturePacker = TaskKey[Unit]("texture-packer", "Runs libgdx's Texture Packer")

val texturePackerTask = texturePacker := {
  println("Packaging textures...")
  val inputDir = file("resources/src/main/preprocess")
  val outputDir = file("resources/src/main/resources")

  val folders = inputDir.asFile.listFiles filter (_.isDirectory)

  println("Sub-Folders:" + folders.mkString(", "))

  // Run Texture Packer
  for (subfolder <- folders) {
    println("Building assets for:" + subfolder)
    val args = Array(subfolder.toString, outputDir.toString, subfolder.getName)
    com.badlogic.gdx.tools.imagepacker.TexturePacker2.main(args)
  }

  // Copy unmanaged resources
  IO.copyDirectory(file("resources/src/main/unmanaged"), file("resources/src/main/resources"))
} 
```

然后在“资源”项目的设置中：

```
...
packageBin in Compile <<= packageBin in Compile dependsOn(texturePacker)
... 
```

其他子项目依赖于与其运行相关的 packageBin。这样，每当我运行项目时，我都会获得最新的资源状态。我不希望它按需提供。问题是每次运行都需要很长时间来处理。我知道 SBT 支持缓存[SBT 常见问题解答](https://github.com/harrah/xsbt/wiki/FAQ)，但我不明白如何使其适应我的任务。

如果文件夹列表中子文件夹中的文件未修改，如何使我的自定义任务避免重做工作？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-25T09:33:59.100

# 解决方案

这是一个可能适合您的解决方案。但是，我并不完全了解其`FileFunction.cached`工作原理（代码后的更多信息），因此这可能不是最好的解决方案：

```
val testCache = TaskKey[Unit]("test-cache", "Test SBT's cache")

val testCacheTask = testCache := {
  println("Testing cache ...")

  val inputDir = file("test/src")   /* Take direct subdirectories from here */
  val outputDir = file("test/dest") /* Create archives here */
  val cacheDir = file("test/cache") /* Store cache information here */

  /* Get all direct subdirectories of inputDir */
  val folders = inputDir.asFile.listFiles.filter{_.isDirectory}

  folders.foreach{folder =>
    /* Get all files in the folder (not recursively) */
    val files = folder.listFiles.toSet

    /* Wrap actual function in a function that provides basic caching
     * functionalities.
     */
    val cachedFun =
      FileFunction.cached(cacheDir / folder.name,
                          FilesInfo.lastModified, /* inStyle */
                          FilesInfo.exists)       /* outStyle */
                         {(inFiles: Set[File]) =>

        createJarFromFolder(folder,
                            inFiles,
                            outputDir / (folder.name + ".jar"))
      }

    /* Call wrapped function with files in the current folder */
    cachedFun(files)
  }
}

/* Creates a JAR archive with all files (this time recursively) in
 * the given folder.
 */
val createJarFromFolder = (folder: File, inFiles: Set[File], outJar: File) => {
  println("At least one of the %d files in %s have changed. Creating %s."
          .format(inFiles.size, folder, outJar))

  /* Replace this by your actual operation */
  val cmdSeq = Seq("jar", "cf", outJar.toString, "-C" , folder + "/", ".")
  println("cmdSeq = " + cmdSeq)
  println("jar: " + cmdSeq.!!)

  Set(outJar)
} 
```

# 笔记

*   我的理解`cached`是，它检查`inFiles`修改，并且如果集合中的**一个**文件发生更改，它会调用实际操作。*changed*的​​确切含义由 to 的`inStyle`参数确定`cached`。

*   最好直接将目录传递给`cached`，这样如果该目录中的任何内容发生更改，就会执行实际操作。但是，我怀疑目前是否可行。

*   我不太明白实际操作返回的文件集的行为是什么（这里：）`Set(outJar)`。我假设 to 的`outStyle`参数`cached`与此相关，并且我希望`createJarFromFolder`在 JAR 不存在时被调用（不管输入文件的更改如何），但情况似乎并非如此。也就是说，如果您删除一个 JAR 文件但不更改相应目录中的文件之一，则不会重新创建该 JAR。

*   该代码有些狡猾，因为在确定该文件夹中是否发生更改时，它只考虑位于特定文件夹顶部的文件。你可能想让那个递归。

# 结语

我很想看到使用 SBT 缓存功能的更好方法。如果您从邮件列表中获得更多信息，请在此处发布。

# php - PHP-OOP：如何在类外使用 PDO fetchAll 的结果

> ID：11640716
> 
> 赞同：0
> 
> 时间：2012-07-24T23:26:17.490
> 
> 标签：php, oop, properties, pdo, fetchall

我对 PHP 和 OOP 很陌生，我一直在使用 PDO 类来连接和检索我的 MYSQL 数据库中的信息。以下是相关文件的摘录：

歌词类.php

```
<?php 
class lyrics{

public $con;
public $kill;
public function __construct(connection $con){

    $this->con = $con->con;     
}

public function getLyricsFromURL($lyricsid){
    $results;

    $getlyrics = $this->con->prepare("SELECT * FROM `lyrics` WHERE lyrics_id = :lyricsid");
    $getlyrics->bindParam(':lyricsid',$lyricsid,PDO::PARAM_INT);
    $getlyrics->execute();
    $results = $getlyrics->fetchAll(PDO::FETCH_OBJ);

    foreach ($results as $result) {

        echo $result->lyrics_content;

    }

} 
```

索引.php：

```
<?php
include 'inc/header.php';
include 'libs/connection.class.php';
include 'libs/lyrics.class.php';

$conn = new connection();
$lyrics = new lyrics($conn);

$lyrics->getLyricsFromURL(55);

?>

<h1><?php echo $lyrics->result->lyrics_title;?></h1> 
```

**其他：** 另一个文件中有一个连接类，但我不会在这里显示它，只知道连接有效。

**问题：*我遇到的问题是我想从****歌词**类中的 **getLyricsFromURL()方法中回显单个结果列，我已经尝试过，但它不起作用。

这样做的正确方法是什么？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T23:38:48.677

该方法`getLyricsFromURL()`设置为返回元素数组，但您将返回值作为单个元素引用，试试这个：

```
public function getLyricsFromURL($lyricsid){

    // This isn't necessary
    //$results;

     // Better to use $stmt as the variable here, obviously this is subjective
     // but will serve you better when you are working on other stmt objects
     $stmt = $this->con->prepare("SELECT * FROM `lyrics` WHERE lyrics_id = :lyricsid");

     $stmt->bindParam(':lyricsid', $lyricsid,PDO::PARAM_INT);
     $stmt->execute();

     $results = $stmt->fetchAll(PDO::FETCH_OBJ);

     return $results;
}

...

// Instatiate our lyrics object
$lyric = new lyrics($conn);

// Make request for lyrics associated to row #55 and store results in local var
$lyrics = $lyric->getLyricsFromURL(55);

// Notice we are referencing the first element of the array
<h1><?php echo $lyrics[0]->lyrics_title;?></h1> 
```

# javascript - 适用于 Web 和移动设备的响应式视频介绍全屏

> ID：11640717
> 
> 赞同：1
> 
> 时间：2012-07-24T23:26:30.037
> 
> 标签：javascript, wordpress, html

我有一个正在与之合作的客户，他希望在将他们重定向回主页之前在他们的网站上有一个全屏视频介绍。他们还希望它基于 cookie，这样用户回来时只能看到一次视频。

到目前为止，我有 2 个问题：

1) 我无法让视频在 iPad 上呈现，因为 onClick() 在 iPad 上不起作用。我已经尝试过其他人，但仍然无法弄清楚。2) 他们想要一个高质量的网络视频和低质量的 ipad/iphone 渲染。

这是我目前在代码中的内容，用于在站点加载时加载视频并使其可供所有设备访问：

```
<body <?php body_class(); ?> onload="openVideo();">
 <div id="homepage-video" style="display:none;">
<img src="<?php echo get_template_directory_uri(); ?>/images/splash-page-final.jpg" class="splash-image" />
    <video id="homepage-video-file" class="video-js vjs-default-skin"  
      preload="auto">  
     <source src="http://www.somesite.com/wp-content/files/somesite-intro-1.mp4" type='video/mp4' />  
     <source src="http://www.somesite.com/wp-content/files/somesite-intro.webm" type='video/webm' />  
     <source src="http://www.somesite.com/wp-content/files/somesite-intro.ogv" type='video/ogg' />  
    </video>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T23:04:41.700

ua 嗅探实际上是不同分辨率的不错选择（如上所述）。你说的 onClick 是什么意思在 iPad 上不起作用？？？当然可以！您是否尝试自动触发点击事件来启动视频？被iOS阻止-自动播放也不起作用。用户必须手动启动视频

# jquery - 我无法在 jquery 中隐藏/显示某些元素

> ID：11640720
> 
> 赞同：1
> 
> 时间：2012-07-24T23:26:43.853
> 
> 标签：jquery, html, hide, show

我有 3 个“跨度”

```
<span class="input1" style="display:block;"><span class="round"></span></span>
<span class="input2" style="display:none;"><span class="round"></span></span>
<span class="input3" style="display:none;"><span class="round"></span></span> 
```

这是脚本：

```
$(document).ready(function() {
    act = 1;
    next = act+1;
    });

$(".round").click(function (){
         $('.input'+act).hide();
         $('.input'+next).show();
         act = next;
    }); 
```

第一次推“.round” -> “.input1” - 隐藏 & “.input2” - 显示 如果我想第二次推“.round” -> 什么也没发生。（这就是问题）

如何隐藏“.input2”并显示“.input3”？感谢您的帮助，对不起我的英语！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T23:29:29.927

我可能不会尝试通过特定的类名来做...使用 DOM 结构。

```
$(".round").click(function (){
   $(this).parent().hide().next().show();
}); 
```

JSFiddle：http: [//jsfiddle.net/U7cYN/](http://jsfiddle.net/U7cYN/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T23:29:07.823

# 解决方案

因为`next`总是等于 2。

第二次，`act == 2`等`next == 2`你隐藏然后显示相同的元素。

试试看：

```
$('.round').click(function (){
    $('.input' + act).hide();
    $('.input' + next).show();
    act = next++;
}); 
```

* * *

# 一点解释

根据[MDN](https://developer.mozilla.org/en/JavaScript/Reference/Operators/Arithmetic_Operators)：

**`++`**是一个增量运算符。

> 此运算符将其操作数递增（加一）并返回一个值。如果使用后缀，操作数后面有运算符（例如，x++），则返回递增前的值。如果在操作数之前使用带运算符的前缀（例如 ++x），则返回递增后的值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T23:40:52.270

这将起作用，在第三次单击时文本将从显示中消失：

```
$(document).ready(function() {
    act = 1;
    next = act;
});

$(".round").click(function (){
     next++;
     $('.input'+act).hide();
     $('.input'+next).show();
     act = next;
}); 
```

# ruby-on-rails - Rails refinerycms 未定义的局部变量或方法“delete_url”

> ID：11640725
> 
> 赞同：0
> 
> 时间：2012-07-24T23:27:23.640
> 
> 标签：ruby-on-rails, ruby-on-rails-3, refinerycms

尝试编辑我使用refinerycms 创建的任何引擎中的任何数据时，我不断收到以下错误。什么会导致这种情况，我该如何解决？

错误

```
 NameError in Refinery/success_stories/admin/success_stories#edit

Showing /Users/tomcaflisch/Sites/PersonalTrainingKT/app/views/refinery/admin/_form_actions.html.erb where line #59 raised:

undefined local variable or method `delete_url' for #<#<Class:0x007fd0e6282f08>:0x007fd0e33d6fd8>

Extracted source (around line #59):

56:                 :id => cancel_button_id,
57:                 :class => "close_dialog button") unless hide_cancel %>
58: 
59:     <%= local_assigns[:after_cancel_button] -%>
60:   </div>
61:   <div class='form-actions-right'>
62:     <%= local_assigns[:before_delete_button] -%> 
```

/refinery/success_stories/admin/success_stories/edit.html.erb

```
<%= render 'form' %> 
```

/refinery/success_stories/admin/success_stories/_form.html.erb

```
<%= form_for [refinery, :success_stories_admin, @success_story] do |f| -%>
  <%= render '/refinery/admin/error_messages',
              :object => @success_story,
              :include_object_name => true %>

  <div class='field'>
    <%= f.label :name -%>
    <%= f.text_field :name, :class => 'larger widest'  -%>

  </div>

  <div class='field'>
    <%= f.label :goal -%>
    <%= f.text_field :goal -%>

  </div>

  <div class='field'>
    <%= f.label :occupation -%>
    <%= f.text_field :occupation  -%>

  </div>

  <div class='field'>
    <%= f.label :age -%>
    <%= f.text_field :age  -%>

  </div>

  <div class='field'>
    <%= f.label :beginning_weight -%>
    <%= f.text_field :beginning_weight  -%>

  </div>

  <div class='field'>
    <%= f.label :current_weight -%>
    <%= f.text_field :current_weight  -%>

  </div>

  <div class='field'>
    <%= f.label :gym -%>
    <%= f.text_field :gym  -%>

  </div>

  <div class='field'>
    <%= f.label :before_image -%>
    <%= render '/refinery/admin/image_picker',
               :f => f,
               :field => :before_image_id,
               :image => @success_story.before_image,
               :toggle_image_display => false %>

  </div>

  <div class='field'>
    <%= f.label :after_image -%>
    <%= render '/refinery/admin/image_picker',
               :f => f,
               :field => :after_image_id,
               :image => @success_story.after_image,
               :toggle_image_display => false %>

  </div>

  <div class='field'>
    <div id='page-tabs' class='clearfix ui-tabs ui-widget ui-widget-content ui-corner-all'>
      <ul id='page_parts'>
        <% [:story].each_with_index do |part, part_index| %>
          <li class='ui-state-default<%= ' ui-state-active' if part_index == 0 %>'>
            <%= link_to t("#{part}", :scope => "activerecord.attributes.refinery/success_stories/success_story", :default => part.to_s.titleize), "##{part}" %>
          </li>
        <% end %>
      </ul>
      <div id='page_part_editors'>
        <% [:story].each do |part| %>
          <div class='page_part' id='<%= part %>'>
            <%= f.text_area part, :rows => 20, :class => 'wymeditor widest' -%>
          </div>
        <% end %>
      </div>
    </div>

  </div>

  <%= render '/refinery/admin/form_actions', :f => f,
             :continue_editing => false,
             :delete_title => t('delete', :scope => 'refinery.success_stories.admin.success_stories.success_story'),
             :delete_confirmation => t('message', :scope => 'refinery.admin.delete', :title => @success_story.name) %>
<% end -%>
<% content_for :javascripts do %>
  <script>
    $(document).ready(function(){
      page_options.init(false, '', '');
    });
  </script>
<% end %> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-25T00:28:18.637

在我看来，你已经覆盖了 app/views/refinery/admin/_form_actions.html.erb 并且你已经注释掉了第 33 行（在这个版本中是普通的）：

```
delete_url          ||= eval("refinery.#{Refinery.route_for_model(f.object.class)}(#{f.object.id})") 
```

如果您在开始时删除 # 注释，那么您会发现您的问题消失了 :-)

菲尔

# ios - 自定义 UITableViewCell 标签消失

> ID：11640730
> 
> 赞同：0
> 
> 时间：2012-07-24T23:27:39.447
> 
> 标签：ios, cocoa-touch, ios5

我目前正在使用自定义 UITableViewCell 构建一个 tableview。我以前做过很多次，但由于某种原因，细胞没有正确显示。另外，当我向上滚动时，文本标签开始消失，此时我不知道为什么。这是 cellForRowAtIndexPath 方法：

```
- (UITableViewCell *)tableView:(UITableView *)table cellForRowAtIndexPath:(NSIndexPath *)indexPath{
NSLog(@"Row: %i Section: %i", indexPath.row , indexPath.section);
HollerCommentCell *cell = (HollerCommentCell *)[table dequeueReusableCellWithIdentifier:@"HollerCommentCell"];
if( !cell )
{
    //Initialize a new cell
    NSArray *topLevelObjects = [[NSBundle mainBundle] loadNibNamed:@"HollerCommentCell" owner:nil options:nil];
    for( id currentObject in topLevelObjects )
    {
        if([currentObject isKindOfClass:[HollerCommentCell class]]){
            cell = (HollerCommentCell*)currentObject;
            break;
        }
    }
}
[[cell name]setText:@"Nick"];
[[cell commentText]setText:@"Hello"];
return cell;
} 
```

这也是我的 numberOfRowsInSection 方法的副本：

```
- (NSInteger)tableView:(UITableView *)table numberOfRowsInSection:(NSInteger)section{
    return ( section == 0 ) ? 5 : 0;
} 
```

这是它如何工作的屏幕截图：

![在此处输入图像描述](../Images/8da64fcb65c3924e717a5af8a1eb373d.png)

不知道现在发生了什么。想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T00:33:19.027

看起来您关闭了剪辑，并且 commentText 标签的位置太低了 44 点。效果是 commentText 出现在它应该设置的单元格正下方的行中。

也许你应该在你的单元格中查看 NSLog 视图并查看它们的框架的位置。

# uitableview - UITableView didSeectRowAtIndexPath 导致 EXC_BAD_ERROR

> ID：11640733
> 
> 赞同：0
> 
> 时间：2012-07-24T23:28:03.653
> 
> 标签：uitableview, ios5

我正在尝试使用 Xcode 4.3 和 SDK 5.1 创建一个简单的 UITableView。在较旧的 SDK 中，我没有收到以下错误，因此尽管检查了 Profiler 和 NSZombie，但我对正在发生的事情感到有些困惑。

在我的 .h 文件中

```
NSMutableArray *fruits; 
```

在我的 .m 文件中

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view from its nib.

    fruits = [[NSMutableArray alloc] init];

    [fruits addObject:@"Apples"];
    [fruits addObject:@"Bananas"];
    [fruits addObject:@"Oranges"];
    [fruits addObject:@"Kiwi Fruit"];
}

- (void)dealloc
{
    [fruits release];
    [super dealloc];
}

- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView {
    return 1;
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
    NSLog(@"%d", [fruits count]);
    return [fruits count];
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"FruitsCell";

    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

    if(cell == nil) {
        cell = [[[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier] autorelease];
    }

    NSString *title = [fruits objectAtIndex:indexPath.row];
    cell.textLabel.text = title;
    cell.accessoryType = UITableViewCellAccessoryDisclosureIndicator;

    return cell;
}

- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
    NSString *selectedOption = [fruits objectAtIndex:indexPath.row];
    NSLog(@"%@", selectedOption);
} 
```

每当我选择一个水果时，我都会收到 EXC_BAD_ERROR 并且输出显示“tableView:didSelectRowAtIndexPath:]: message sent to deallocated instance”

我简要了解了 ARC，并认为这可能是内存管理的问题，所以我删除了 dealloc，但它仍然抛出异常。我从这个简单的例子中遗漏了什么？！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T00:36:40.073

代码看起来很完美。我猜 ARC 被禁用了，因为你有 autorelease 等，即使你提到了它。我要检查的一件事是 UITableView 的委托，以查看它是否正确设置为 xib 上的视图控制器。

# .net - 将变更集中的文件签出到我的本地工作区

> ID：11640735
> 
> 赞同：3
> 
> 时间：2012-07-24T23:28:11.423
> 
> 标签：.net, vb.net, tfs

我正在研究一个 tf.exe 命令，它允许我从签入的变更集 ID 将所有文件签出到我的本地工作区。所以我可以将变更集从一个分支移动到另一个分支？

有什么命令可以让我这样做吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T01:10:30.027

在 NuGet 控制台中，您可以使用 TFS PowerTools 中的 TFS Powershell 管理单元。

```
Add-PsSnapin Microsoft.TeamFoundation.Powershell
Get-TfsChangeset <ChangesetNumber> 
```

另一种选择是打开工具 > 外部工具并添加一个外部工具，该工具调用`TF.exe changeset`和接受/提示参数以提供变更集编号，如果您想要其他分支名称，则可以完全自动完成。

**编辑：** 如果您需要签出可以使用的文件：

```
tf checkout .\* /recursive. 
```

参考：[TFS 命令行语法](http://msdn.microsoft.com/en-us/library/56f7w6be.aspx)

# javascript - 如何让它更有效率？

> ID：11640738
> 
> 赞同：0
> 
> 时间：2012-07-24T23:28:21.217
> 
> 标签：javascript, jquery, performance

我正在使用这样的代码（简化）：

```
var $form = $('form')
var els = {
  radio: $form.find('input[type=radio]'),
  check: $form.find('input[type=checkbox]')
} 
```

有`form`问题的可能包含动态添加的输入，但`els`对象在定义时是静态的，如果表单获得新的输入，`radio`并且`check`不会更改。我需要`els`在整个代码中经常使用，所以我想出了这个简单的解决方案：

```
var getEls = function () {
  return {
    radio: $form.find('input[type=radio]'),
    check: $form.find('input[type=checkbox]')
  }
}

var foo = function () {
  var els = getEls()
  // do something with `els`
} 
```

这很好用，但我认为这可能不会提供最佳性能，因为它每次都必须再次查询所有元素。有一个更好的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T00:13:48.020

如果您不调用`getEls()`循环或其他性能应该没问题。但是，由于您控制向表单添加元素，因此您有一些方法可以简化代码。

### 使用属性

使用表单上的数据属性来保存特定元素的数量，以便在完全刷新之前将其与保存的元素数量进行比较。

```
function() {
    var checkBoxCount = parseInt($form.data("checkbox-count"), 10);
    $("form").append("<input type='checkbox'>");
    // now increment the count and re-save it
    $form.data("checkbox-count", checkBoxCount+1);
}; 
```

### 更新集合

在将对象添加到 dom 时，您也可以将其添加到已保存的集合中。

```
function() {
    var $checkbox = $("<input type='checkbox'>");
    $("form").append($checkbox);
    els.check = els.check.add(checkbox);
}; 
```

# jquery - 增加 ColorBox 中标题区域的大小（高度）

> ID：11640740
> 
> 赞同：6
> 
> 时间：2012-07-24T23:28:38.523
> 
> 标签：jquery, colorbox

我正在使用 ColorBox 创建一个标题相当长的幻灯片

```
<a class="slideshow" href="image.gif" 
title="Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nam iaculis velit 
eget augue tincidunt a tempor risus volutpat. Integer tempor sapien justo. Ut 
facilisis odio nec risus aliquet nec rhoncus nunc ultrices. Nulla facilisi. Ut ac 
ligula a metus rhoncus feugiat. Praesent lacinia diam neque, sed tempor felis. Morbi 
sed sapien sem, vitae pulvinar nunc. Fusce metus dolor, iaculis eget venenatis a, 
gravida sed tellus." rel="slides">Slideshow</a> 
```

并且灯箱有效，但在所有示例中，为标题留出的空间并不多。如何使标题区域更大，以便 ColorBox 正确调整灯箱“弹性”窗口的大小？

* * *

想出了一个体面的解决方法。通过覆盖`colorbox.css`.

```
#cboxTitle { 
    text-align:justify !important;
    width:98.5% !important; 
    margin-bottom:24px !important;
    padding:5px !important;
    background-color:#333 !important;
    opacity:0.75 !important;
    filter:alpha(opacity=75) !important;
    color:#fff !important;
} 
```

我将这些覆盖基于示例 1 中提供的样式。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-02-27T11:35:07.673

遇到同样的问题。解决方案是在#cboxContent 上强制一些«outerHeight»，这将从图像的可用高度中减去。

所以：

```
#cboxContent {
    padding-bottom:50px;
} 
```

考虑到 #cboxTitle 应该是绝对的，您也可以修复它的高度：

```
#cboxTitle {
    height:50px;
} 
```

# asp.net-mvc-3 - 无法从实体框架脚手架中找到 sql 表

> ID：11640746
> 
> 赞同：0
> 
> 时间：2012-07-24T23:29:15.417
> 
> 标签：asp.net-mvc-3, entity-framework, asp.net-mvc-scaffolding

我刚刚创建了一个 asp.net mvc 3 应用程序并添加了这些类，然后添加了控制器以提供 CRUD 页面。访问这些页面时，我可以做所有预期的事情，但由于某种原因，我找不到数据的存储位置。

我检查了 App_Data（启用了显示所有文件）但那里没有 db 我搜索了我的 db 'DbTest1' 但我找不到任何具有创建代理名称的表。

有什么想法吗？

型号类：

```
public class Agent {
        public int AgentId { get; set; }

        [Required]
        [DataType(DataType.Text)]
        [Display(Name = "Agent Name")]
        public string AgentName { get; set; }
    } 
```

数据库上下文：

```
public class AgentContext : DbContext {
        public AgentContext() : base("ApplicationServices") { }
        public DbSet<Agent> Agents { get; set; }
    } 
```

连接字符串：

```
<add name="ApplicationServices" connectionString="Data Source=SMITH\SQLEXPRESS;Initial Catalog=DbTest1;Integrated Security=True;User Instance=true" providerName="System.Data.SqlClient"/> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T03:34:42.797

Try changing your connection string name to DbContext name,

```
<add name="AgentContext" connectionString="Data Source=SMITH\SQLEXPRESS;Initial Catalog=DbTest1;Integrated Security=True;User Instance=true" providerName="System.Data.SqlClient"/> 
```

# django - 由于自动完成小部件字段，Django 表单不会提交

> ID：11640750
> 
> 赞同：3
> 
> 时间：2012-07-24T23:29:23.580
> 
> 标签：django, jquery-ui, django-forms, django-widget

我想使用我使用 jquery ui 创建的自动完成小部件在我的表单中填充文本输入。一切都完全按照我的意愿工作，除非提交表单。

问题是当我提交表单时，文本输入会自动重置（我不知道为什么），然后页面重新加载说该字段是必需的（只是验证工作应该如何）。当然，如果它不重置该字段，一切都会好起来的。

我不知道我的自动完成选择事件是否工作正常，这里是代码：

```
 select : function (e, ui) {
   // I create a new attribute to store de database primary key of this option. This is
   // usefull later on.
   $('#%(input_id)s').attr('itemid', ui.item.real_value);

   // I set the input text value's.
   $('#%(input_id)s').val(ui.item.label);
 } 
```

这是自动完成的完整代码：

```
class AutocompleteTextInputWidget (forms.TextInput):

  def media(self):
    js = ("/js/autocomplete.js", "pepe.js")

  def __init__(self, source, options={}, attrs={}):
    self.options = None
    self.attrs = {'autocomplete': 'off'}
    self.source = source
    self.minLength = 1
    self.delay = 0
    if len(options) > 0:
        self.options = JSONEncoder().encode(options)

    self.attrs.update(attrs)

  def render(self, name, value=None, attrs=None):
    final_attrs = self.build_attrs(attrs)        
    options = ''

    if value:
        final_attrs['value'] = escape(value)

    if isinstance(self.source, list) or isinstance(self.source, tuple):
        # Crea un Json con las opciones.
        source = '[' 
        for i in range(0, len(self.source)):
            if i > 0:
                source += ', '
            source += '"' + self.source[i] + '"'
        source += ']'

        options = u'''
            delay : %(delay)d,
            minLength : %(minlength)s,
            source : %(source)s
        '''  % {
               'delay' : self.delay,
               'minlength' : self.minLength,
               'source' : source
        }

    elif isinstance(self.source, str):
        options = u'''
            delay : %(delay)d,
            minLength : %(minlength)s,
            source : function (request, response) {
                if ($(this).data('xhr')) {
                    $(this).data('xhr').abort();
                }
                $(this).data('xhr', $.ajax({
                    url : "%(source_url)s",
                    dataType : "json",
                    data : {term : request.term},
                    beforeSend : function(xhr, settings) {
                        $('#%(input_id)s').removeAttr('itemid');
                    },
                    success : function(data) {
                        if (data != 'CACHE_MISS') {
                            response($.map(data, function(item) {
                                return {
                                    label : item[1],
                                    value: item[1],
                                    real_value : item[0]
                                };
                            }));
                        }
                    },
                }))
            },
            select : function (e, ui) {
                $('#%(input_id)s').attr('itemid', ui.item.real_value);
                $('#%(input_id)s').val(ui.item.label);
            }
        ''' % {
               'delay' : self.delay,
               'minlength' : self.delay,
               'source_url' : self.source,
               'input_id' : final_attrs['id'],
        }
    if not self.attrs.has_key('id'):
        final_attrs['id'] = 'id_%s' % name    

    return mark_safe(u''' 
        <input type="text" %(attrs)s/>
        <script type="text/javascript">
            $("#%(input_id)s").autocomplete({
               %(options)s 
            });
        </script>
    ''' % {
           'attrs' : flatatt(final_attrs),
           'options' :  options, 
           'input_id' : final_attrs['id']
    }) 
```

**提示**：如果我写了一些文本而不从自动完成中选择它，它仍然会失败。

**另一个提示**：如果我将该字段设置为可选，它将到达空视图。

当我提交表格时，我应该怎么做才能完成这项工作？？？我花了几个小时试图完成这项工作。我怎样才能使表格识别出我已经填写了该字段？

这是表单的代码：

```
test = forms.CharField(label = "autotest", widget = AutocompleteTextInputWidget('/myjsonservice')) 
```

这是呈现的html：

```
<input type="text"  autocomplete="off" id="id_test"/>
        <script type="text/javascript">
            $("#id_test").autocomplete({

            delay : 0,
            minLength : 0,
            source : function (request, response) {
                if ($(this).data('xhr')) {
                    $(this).data('xhr').abort();
                }
                $(this).data('xhr', $.ajax({
                    url : "/myjsonservice",
                    dataType : "json",
                    data : {term : request.term},
                    beforeSend : function(xhr, settings) {
                        $('#id_test').removeAttr('itemid');
                    },
                    success : function(data) {
                        if (data != 'CACHE_MISS') {
                            response($.map(data, function(item) {
                                return {
                                    label : item[1],
                                    value: item[1],
                                    real_value : item[0]
                                };
                            }));
                        }
                    },
                }))
            },
            select : function (e, ui) {
                $('#id_test').attr('itemid', ui.item.real_value);
                $('#id_test').val(ui.item.label);
            }

            });
        </script> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T02:06:57.790

终于找到答案了，问题是“name”属性没有渲染。因此，作为请求的一部分，该字段无法访问视图。

自动完成小部件的最终代码如下所示：

```
class AutocompleteTextInputWidget (forms.TextInput):

    def media(self):
        js = ("/js/autocomplete.js", "pepe.js")

    def __init__(self, source, options={}, attrs={}):
        self.options = None
        self.attrs = {'autocomplete': 'off'}
        self.source = source
        self.minLength = 1
        self.delay = 0
        if len(options) > 0:
            self.options = JSONEncoder().encode(options)

        self.attrs.update(attrs)

    def render(self, name, value=None, attrs=None):
        final_attrs = self.build_attrs(attrs)       
        options = ''

        if value:
            final_attrs['value'] = escape(value)

        if isinstance(self.source, list) or isinstance(self.source, tuple):
            # Crea un Json con las opciones.
            source = '[' 
            for i in range(0, len(self.source)):
                if i > 0:
                    source += ', '
                source += '"' + self.source[i] + '"'
            source += ']'

            options = u'''
                delay : %(delay)d,
                minLength : %(minlength)s,
                source : %(source)s
            '''  % {
                   'delay' : self.delay,
                   'minlength' : self.minLength,
                   'source' : source
            }

        elif isinstance(self.source, str):
            options = u'''
                delay : %(delay)d,
                minLength : %(minlength)s,
                source : function (request, response) {
                    if ($(this).data('xhr')) {
                        $(this).data('xhr').abort();
                    }
                    $(this).data('xhr', $.ajax({
                        url : "%(source_url)s",
                        dataType : "json",
                        data : {term : request.term},
                        beforeSend : function(xhr, settings) {
                            $('#%(input_id)s').removeAttr('itemid');
                        },
                        success : function(data) {
                            if (data != 'CACHE_MISS') {
                                response($.map(data, function(item) {
                                    return {
                                        label : item[1],
                                        value: item[1],
                                        real_value : item[0]
                                    };
                                }));
                            }
                        },
                    }))
                },
                select : function (e, ui) {
                    $('#%(input_id)s').attr('itemid', ui.item.real_value);
                    $('#%(input_id)s').val(ui.item.label);
                }
            ''' % {
                   'delay' : self.delay,
                   'minlength' : self.delay,
                   'source_url' : self.source,
                   'input_id' : final_attrs['id'],
            }
        if not self.attrs.has_key('id'):
            final_attrs['id'] = 'id_%s' % name    

        return mark_safe(u''' 
            <input type="text" name="%(name)s" %(attrs)s/>
            <script type="text/javascript">
                $("#%(input_id)s").autocomplete({
                   %(options)s 
                });
            </script>
        ''' % {
               'attrs' : flatatt(final_attrs),
               'options' :  options, 
               'input_id' : final_attrs['id'],
               'name' : name
        }) 
```

1.  如果有人知道如何改进这个凌乱的代码，那就太好了。
2.  如果有人知道 django 1.4 的一个不错的小部件文档（除了官方的，顺便说一句很烂），那也很好。

再见，大家编码好！！！

# caching - 网站缓存图片库

> ID：11640757
> 
> 赞同：0
> 
> 时间：2012-07-24T23:29:57.603
> 
> 标签：caching, browser

我有一个向用户显示数百/数千张图像的网站。用户重新加载图库的频率很高，但他们的缓存总是不够大，无法保存每次访问的图像，并且必须缓慢地重新下载。

确保图像被缓存的好方法是什么？我已经排除了使用本地存储。你能给我什么建议？

需要明确的是，http 标头设置正确（拥有大缓存的人会立即加载），只是浏览器默认缓存不够大。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T23:47:58.973

您是否考虑过在服务器端缓存，例如在您的网络服务器前使用[清漆](https://www.varnish-cache.org/)？如果您的服务器上有足够的内存，这将对您的用户（和您的服务器负载）的下载时间有很大帮助。

或者您只是对客户端缓存感兴趣？如果是这样，如果您可以发布您的 http 缓存标头，这将有所帮助。

# jquery - Jquery在事件触发器上传递并存储一个动态变量

> ID：11640761
> 
> 赞同：2
> 
> 时间：2012-07-24T23:30:23.187
> 
> 标签：jquery, events, variables, dynamic

我在输入文本框旁边有一个复选框。如果选中该复选框，则文本框将被清空并禁用。但是，我想将之前的值存储在该文本框中，以便在用户决定取消选中该复选框时将其返回到文本框中。这是我的代码：

```
function disablePath() {
    var currentPath;
    $('#user_strategy').on('change','input[value="all"]', function(){
        var that = $(this);
        if($(this).is(':checked')) {
            currentPath = that.next().val();
            that.next().attr("disabled", "disabled").val('');
        }
        else {
            that.next().removeAttr("disabled").val(currentPath);
        }
    });
} 
```

因此，如果我只有一个复选框，后跟一个文本框，那效果就很好。如果我有多个复选框-文本框组合，我会遇到麻烦，我会这样做。如果我选中多个复选框，则仅存储最后一个文本框内容 - 因此，如果我取消选中任何先前选中的框，则相应的文本框将填充最后一个文本框的值，该文本框的相关复选框已选中，无论关系如何。有没有办法存储特定于前一个复选框的文本框的值？这是实时代码：

[http://kaboukie.net/stackoverflow/](http://kaboukie.net/stackoverflow/)

我相信我需要使用 eventData 但不确定如何使用，任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T23:46:17.623

我建议将数据附加到元素本身，这可以使用 Jquery 的 .data() 方法完成。

这是我已经测试过可以正常工作的代码；）

```
$(function() {
    function disablePath() {
        var currentPath;
        $('#user_strategy').on('change','input[value="all"]', function(){
            var that = $(this);
            if($(this).is(':checked')) {
                temp= that.next().val();
                that.data("currentPath" , temp);
                that.next().attr("disabled", "disabled").val('');
            }
            else {
                that.next().removeAttr("disabled").val(that.data("currentPath"));
            }
        });
    }
    disablePath();
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T23:43:55.530

如何将数据存储为复选框上的属性？

```
$(function() {
    function disablePath() {
        var currentPath;
        $('#user_strategy').on('change','input[value="all"]', function(){
            var that = $(this);
            if($(this).is(':checked')) {
                $(this).attr("x:savedData", that.next().val());
                that.next().attr("disabled", "disabled").val('');
            }
            else {
               that.next().removeAttr("disabled").val($(this).attr("x:savedData"));
            }
        });
    }
    disablePath();
}); 
```

[http://jsfiddle.net/ruwJT/](http://jsfiddle.net/ruwJT/)

可能不是最佳实践，但它确实有效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T23:46:59.947

问题是当您设置 currentPath 时，它不记得哪个元素负责。

为了解决这个问题，您可以为每个复选框分配一个唯一的 ID 属性，并将该 ID 作为键与文本框的值一起存储在键值对中。

或者，可以使用 jQuery 的[.data()](http://api.jquery.com/jQuery.data/)方法在任何元素上存储 abritraty 数据。见[http://jsfiddle.net/EP5bg/](http://jsfiddle.net/EP5bg/)

# android - EditText setError 消息输入后不清除

> ID：11640772
> 
> 赞同：76
> 
> 时间：2012-07-24T23:32:00.483
> 
> 标签：android

好的，所以我只有一个 EditText 字段和一个按钮，按下它会触发 AsyncTask。

```
EditText playerName = (EditText)findViewById(R.id.playerEditText);

if(playerName.getText().toString().length() == 0 )
    playerName.setError("Player name is required!");
else {
    // do async task
} 
```

问题是即使在我输入有效文本进行搜索后，错误消息似乎仍然存在。一旦 EditText 不为空，有没有办法消除错误？

* * *

## 回答 #1

> 赞同：148
> 
> 时间：2012-07-24T23:56:35.240

在你的 else 括号中， put `playerName.setError(null)`，这将清除错误。

* * *

## 回答 #2

> 赞同：54
> 
> 时间：2014-05-11T23:56:10.577

API 文档：“当任何关键事件导致 TextView 的文本发生更改时，图标和错误消息将重置为 null。” 虽然不是这样 - 因此我们可以将其视为错误。

如果您使用诸如 textNoSuggestions、textEmailAddress、textPassword 之类的 inputType，则在键入字符后会取消设置错误。几乎与记录的一样，但又不完全正确 - 当您删除一个字符时，错误仍然存​​在。看来，使用 addTextChangedListener 和 setError(null) 的简单解决方法可以获得承诺的行为。

此外还有关于 Android 4.2 上图标丢失的帖子。所以要小心使用。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2014-07-18T15:29:01.670

试试这个监听器：

```
 playerName.addTextChangedListener(new TextWatcher()
                {
                    public void afterTextChanged(Editable edt){
                        if( playerName.getText().length()>0)
                        {
                             playerName.setError(null);
                        }
                    } 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-04-15T12:34:58.127

如果要隐藏错误消息，一种方法是在编辑框上应用 onclicklistener，然后

```
editTextName.setOnClickListener(new OnClickListener() {

        @Override
        public void onClick(View v) {
            // TODO Auto-generated method stub
            editTextName.setError(Null)
        }
    }); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2018-05-18T09:28:53.570

下面的代码对我有用

```
@OnTextChanged(
            value = R.id.editTextName,
            callback = OnTextChanged.Callback.TEXT_CHANGED)
    public void afterInput(CharSequence sequence) {
        editTextName.setError(null);
        editTextName.setErrorEnabled(false);
    } 
```

'

> `editTextName.setError(null)` **将清除错误消息。**
> 
> `editTextName.setErrorEnabled(false)` **将删除额外的填充。**

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-04-09T14:07:25.760

将 TextWatcher 添加到您的 EditText 和 onError，使用`et.setError(errorMessage)`其他方式显示错误消息，您可以删除错误消息和错误图标，如下所示。

```
// to remove the error message in your EditText
et.setError(null);

// to remove the error icon from EditText.
et.setCompoundDrawables(null, null, null, null); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2022-01-02T23:00:22.080

这段代码对我有用。

textInputSetting(binding.emailEdt)

```
fun textInputSetting(view: TextInputLayout) {
    view.apply {
        this.editText!!.addTextChangedListener {
            if (this.editText!!.text.isNotEmpty()) {
                this.error = null
                this.isErrorEnabled = false
            }
        }
    }
} 
```

# ruby-on-rails - Ruby on Rails 远程表单不更新页面

> ID：11640780
> 
> 赞同：1
> 
> 时间：2012-07-24T23:32:59.927
> 
> 标签：ruby-on-rails, ruby, ajax, ruby-on-rails-3

**更新**

我必须通过更改 Model 调用来让它工作

```
@comments = VideoComment.all(:conditions => { :video_id => @video.id}, :limit => 5, :order => :created_at) 

@comments = VideoComment.last(5).reverse 
```

它有效，但它给了我**所有**视频的最后一个视频评论，而我只想要当前视频中的评论（`@video.id`）。

关于如何做到这一点的任何线索？

* * *

我有一个`Video`控制器和一个`VideoComments`管理控制器注释的`Video`控制器。我试图让我的远程表单使用 ajax 更新评论列表，但它似乎不起作用。你能找出我做错了什么吗？

显示页面的 HTML 代码：

```
- if current_user
    #comment-form
      = render 'video_comments/comment_form'
  %ul
    #comments
      = render @comments 
```

video_comments/_comment_form.html.haml

```
= form_for current_user.video_comments.build(:video_id => params[:id]), :remote => true do |f|
  .form-fields
    .comment-content
      = f.text_area :content, rows:2
    = f.hidden_field :video_id
    = f.hidden_field :user_id
    .submit-form
      = f.submit "Add a comment", :class => "btn btn-default " 
```

`Video_Comments`控制器`create`动作 ：

```
 def create
    @comment = VideoComment.create(params[:video_comment])
    @video = @comment.video
    @comments = VideoComment.all(:conditions => { :video_id => @video.id}, :limit => 5, :order => :created_at) 
    render :toggle      
 end 
```

`toggle.js.erb`管理页面更改的文件：

```
$("#comment-form").html("<%= escape_javascript render 'comment_form' %>");
$("#comments").html("<%= escape_javascript render @comments %>"); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-25T00:04:59.223

如果您使用的是 Rails 3，您可以这样做

```
@comments = VideoComment.where(:video_id => @video.id).order(:created_at).limit(5) 
```

或者，如果您有正确定义的关系，您也可以这样做

```
@comments = @video.comments.order(:created_at).limit(5) 
```

# objective-c - 将可变数量的参数传递给选择器

> ID：11640782
> 
> 赞同：2
> 
> 时间：2012-07-24T23:33:10.910
> 
> 标签：objective-c, ios, selector

我想从包含*vargs*参数列表的方法中调用选择器。有没有办法为选择器动态提供参数数量的变量？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T23:43:32.100

不幸的是，在使用 时`performSelector`，传递多个参数的唯一选择是传入 NSArray 或 NSDictionary 等。显然，您必须更改接收方法的构造函数以接受新的参数存储对象。

或者，您可以考虑使用[NSInvocation](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/nsinvocation_Class/Reference/Reference.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T23:45:03.310

您可以传递一个 NSMutableDictionary ，其中您可以有许多参数。

# php - 每个用户无限项的 MySQL 数据库结构

> ID：11640783
> 
> 赞同：3
> 
> 时间：2012-07-24T23:33:23.760
> 
> 标签：php, mysql, structure, infinite

我有一个用户越来越多的 MySQL 数据库，每个用户都有一个他们想要的项目和他们拥有的项目的列表 - 每个用户都有一个特定的 ID

当前数据库是前一段时间创建的，当前每个用户在 WANT 或 HAVE 表中都有一个特定的行，每行 50 列，用户 ID 作为主键，每个项目 WANT 或 HAVE 都有一个特定的 ID 号。

这目前限制了每个用户添加 50 个项目，并使数据库的搜索和其他功能大大复杂化

重做数据库时 - 是否可以简单地创建一个 2 列 WANT 和 HAVE 表，每行都有用户 ID 和项目 ID。这样，每个用户的项目就没有“理论”限制。

每次成员加载个人资料页面时 - 然后将使用来自 have 或 want 表的简单 SELECT WHERE ID = ##### 语句编译他们想要和拥有的项目列表

此外，我需要比较用户与用户的项目列表、最常见的项目、拥有最多项目的用户、完整的用户搜索一个用户想要而另一个用户拥有的项目...... - 等等等等

用户数量范围为 5000 - 20000

每个用户平均大约 15 - 20 个项目

这将是一个可行的 MySQL 结构还是我必须重新考虑我的策略？

非常感谢你的帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-24T23:38:08.740

这在 mysql 中肯定是一个可行的结构。它可以处理非常大量的数据。但是，当您构建它时，请确保在用户/项目 ID 上放置正确的索引，以便查询能够快速返回。

这在数据库术语中称为一对多关系。

```
Table1 holds:
 userName | ID

Table2 holds:
userID | ItemID 
```

您只需将任意多的行放入第二个表中即可。

在你的情况下，我可能会这样构建表格：

```
users
id | userName | otherFieldsAsNeeded

items
userID | itemID | needWantID 
```

这样，您可以简单地查找 needWantID - 例如 1 表示需要，2 表示需要。但稍后，您可以为愿望清单添加 3。

编辑：只需确保您没有将项目信息存储在表中`items`，只需存储用户与项目的关系即可。将所有项目信息放在一个表格中（例如 itemDetails），其中包含您的描述、价格和您想要的任何其他内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T23:39:13.313

我会推荐 2 张桌子，一张 Wants 桌子和一张 Have 桌子。每个表都有一个 user_id 和 product_id。我认为这是最规范的，并为每个用户提供“无限”项目。

或者，您可以有一个带有 user_id、product_id 和类型（'WANT' 或 'HAVE'）的表。我可能会选择选项1。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-24T23:40:11.453

你的理论是一个非常合法的数据库结构。对于一个`many to many`关系（这是你想要的），我看到这样做的唯一方法是，就像你说的那样，有一个以 user_id 和 item_it 作为列的**关系表。**您可以对其进行扩展，但这是基本思想。

这种设计更加灵活，并且允许每个用户拥有您想要的无限项。

为了处理需求和拥有，您可以创建两个表，或者您可以只使用一个表并使用第三列，该列仅包含一个字节，指示用户/项目匹配是需要还是需要。根据您项目的具体情况，任何一个都是可行的选择。

因此，您最终会得到至少以下表格：

```
Table: users
Cols:
  user_id
  any other user info

Table: relationships
Cols:
  user_id
  item_id
  type (1 byte/boolean)

Table: items
Cols:
  item_id
  any other item info 
```

希望有帮助！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-24T23:40:45.430

正如您在问题中提到的那样，是的，为 WANT 和 HAVE 分别设置一个表格会更有意义。这些表可能有一个将行与用户相关联的 Id 列，以及一个实际指示 WANT 或 HAVE 项是什么的列。这种方法将允许更多的扩展空间。

应该注意的是，如果您有很多这样的行，您可能需要增加服务器的容量以保持快速查询。如果您有数百万行，它们将对服务器造成很大的压力（取决于您的设置）。

# javascript - jQuery令牌输入rails出现错误未捕获的TypeError：对象[对象对象]没有方法'tokenInput'

> ID：11640785
> 
> 赞同：0
> 
> 时间：2012-07-24T23:33:38.880
> 
> 标签：javascript, jquery, ruby-on-rails-3, jquery-tokeninput

所以我使用[rails cast #258](http://railscasts.com/episodes/258-token-fields)作为参考，当我尝试加载页面时，将令牌输入添加到文本字段的 javascript 似乎没有正确附加。在 chrome 控制台中，我收到此错误

> 未捕获的类型错误：对象 [object Object] 没有方法“tokenInput”

如果有人对我所缺少的有任何想法，那将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T03:14:23.927

您需要包含令牌输入 jQuery 插件 - 在[http://loopj.com/jquery-tokeninput/](http://loopj.com/jquery-tokeninput/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-25T16:30:59.333

检查视图源并查看该页面中是否包含令牌输入。

如果它被包含，那么它被包含在 jquery 之后，并且还通过在 document ready 中使用 alert 来确保 jquery 不冲突。

我认为这应该可以解决您的问题。

# c# - MVC 应用程序未连接到 Facebook

> ID：11640788
> 
> 赞同：0
> 
> 时间：2012-07-24T23:34:41.940
> 
> 标签：c#, asp.net-mvc, facebook

我有一个作为 POC 构建的 MVC 应用程序。当我在 Visual Studio 中运行它时，它连接到 FB，我得到一个访问令牌，一切都运行良好。但是，当我将应用程序发布到 IIS 时，它不再连接。我得到 FB 登录弹出窗口，输入我的用户名和密码，没有任何反应。它似乎没有击中 auth.authResponseChange 更改事件。它没有击中任何警报。这是我正在使用的代码。我不知道该尝试什么。

```
<script type="text/javascript">
window.fbAsyncInit = function () {
    FB.init({
        appId: '<myappid>', // App ID
        status: true, // check login status
        cookie: true, // enable cookies to allow the server to access the session
        xfbml: true  // parse XFBML
    });

    FB.Event.subscribe('auth.authResponseChange', function (response) {
       alert("Connected!");
        if (response.status === 'connected') {
            var uid = response.authResponse.userID;
            var accessToken = response.authResponse.accessToken;
            alert(accessToken);
            window.location = "/Home/FacebookLogin?token=" + response.authResponse.accessToken;
        } else if (response.status === 'not_authorized') {
            alert("User not Authorized!");
        } else {
            alert("User not Logged in!");
        }
    });
};

// Load the SDK Asynchronously
(function (d) {
    var js, id = 'facebook-jssdk'; if (d.getElementById(id)) { return; }
    js = d.createElement('script'); js.id = id; js.async = true;
    js.src = "//connect.facebook.net/en_US/all.js";
    d.getElementsByTagName('head')[0].appendChild(js);
} (document)); 
```

家庭控制器.cs

```
public class HomeController : Controller
{
    public ActionResult Index(string token)
    {
        return View();
    }

    [HttpGet]
    public ActionResult FacebookLogin(string token)
    {
        HttpCookie accesstoken = new HttpCookie("accesstoken");
        accesstoken.Value = token;
        accesstoken.Expires = DateTime.Now.AddMinutes(10d);

        Response.Cookies.Add(accesstoken);

        return RedirectToAction("Index", "Home", new { token = token });
    }
} 
```

有什么建议么？

谢谢，

朗达

# javascript - 无法在 XML 中获取节点值，我该如何获取？

> ID：11640791
> 
> 赞同：1
> 
> 时间：2012-07-24T23:34:53.997
> 
> 标签：javascript, html, xml, xpath, xml-parsing

我目前使用 w3cschools 上的一个简单的循环 XML 脚本，效果很好：

```
 if (p1p2total == 5)
  {
if (window.XMLHttpRequest)
 {// code for IE7+, Firefox, Chrome, Opera, Safari
 xmlhttp=new XMLHttpRequest();
 }
else
 {// code for IE6, IE5
 xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
 }
xmlhttp.open("GET","xml/SearchRequest-12437.xml",false);
xmlhttp.send();
xmlDoc=xmlhttp.responseXML;

var x=xmlDoc.getElementsByTagName("item");
for (i=0;i<x.length;i++)
{
document.write("<tr><td class='c3c1'>");
document.write(x[i].getElementsByTagName("key")[0].childNodes[0].nodeValue);
document.write("</td><td class='c3c2b'>");
document.write(x[i].getElementsByTagName("priority")[0].childNodes[0].nodeValue);
document.write("</td><td class='c3c3b'>");
document.write(x[i].getElementsByTagName("customfields")[0].getElementsByTagName("customfield")

   [0].getAttributeNode("id").textContent);
document.write("</td></tr>");
}
} 
```

但是，在我的第三个节点值查询 customfields 中，我试图在我的 xml 中获取具有以下路径的节点的 textContent：

项目 -> 自定义字段 -> 自定义字段 id=10080 -> 自定义字段值

如何获取 customfieldvalue 的 textContent 值？父节点必须具有 id=10080 的属性，因为不同的项目具有不同数量的自定义字段标签，这些标签具有不同的子节点 ID。

请帮忙！！！

我只需要这个在 FireFox 中工作......

- -编辑 - -

好的，所以我发现我需要使用的 xpath 是：

```
 ./customfields/customfield[@id='customfield_10080']/customfieldvalues/customfieldvalue/text() 
```

那么我该如何更换线路

```
 document.write(x[i].getElementsByTagName("customfields")[0].getElementsByTagName("customfield")[0].getAttributeNode("id").textContent); 
```

提取我提供的 Xpath 的文本内容，同时保留在 javascript 循环中？我需要这个来为每个人拉这个 Xpath

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T23:49:43.023

就我而言，你只需要打电话

```
document.write(x[i].getElementsByTagName("customfields")[0].getElementsByTagName("customfield").text; 
```

试试看。有几种方法可以从 javascript 读取和解析 XML。我不会推荐 w3schools 来学习。去根，下次试试[MDN ;)](https://developer.mozilla.org/pt/JavaScript)

我希望它有帮助

# java - 什么在 JSF/Facelets 中充当控制器，例如 servlet 在 JSP 中充当控制器？

> ID：11640792
> 
> 赞同：3
> 
> 时间：2012-07-24T23:34:59.380
> 
> 标签：java, model-view-controller, jsf, servlets, facelets

当我们在这里使用 JSP 和 servelt 开发 Web 应用程序时，servlet 充当控制器（从 MVC 角度来看）。那么当我使用 JSF 和 Facelets 开发 Web 应用程序时，什么充当控制器......

是否与 - JSF - 请求调度程序 servlet - httprequest httpresponse 有关

或者我完全错了。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-25T00:57:47.237

嗯，有一个[`FacesServlet`](https://stackoverflow.com/questions/2095397/what-is-the-difference-between-jsf-servlet-and-jsp)（在`web.xml`文件中注册，设置 JSF 项目时的第一件事），它是最接近 MVC 控制器的 IMO。

有些人似乎也将Backing Beans视为控制器，但我不认为它们是，不是真的......虽然Backing Beans可以影响导航的结果，例如，或者可能直接将一些东西写入HttpResponse和标志着JSF 生命周期的结束，它们实际上由*Faces Servlet*实例化和使用，这是调度事物的真正责任。

**另请参阅：** [JSF、Servlet 和 JSP 之间有什么区别？](https://stackoverflow.com/questions/2095397/what-is-the-difference-between-jsf-servlet-and-jsp)

# c# - 遇到 System.MissingMethodException：找不到使用 PrivateObject 的方法

> ID：11640793
> 
> 赞同：10
> 
> 时间：2012-07-24T23:35:05.827
> 
> 标签：c#, unit-testing

基本上，我的一些测试是成功的，有些是失败的。根据 Skeet 先生的极好建议，我创建了一个完整的代码示例以确认我没有发疯。这是代码：

```
namespace ClassLibrary
{
    using System;

    public class Manager
    {
        private int SampleMethod(int id)
        {
            return id;
        }
    }
} 
```

我的测试是：

```
namespace UnitTestProject
{
    using System;
    using Microsoft.VisualStudio.TestTools.UnitTesting;

    [TestClass]
    public class UnitTest
    {
        [TestMethod]
        public void TestPasses()
        {
            var privateInfo = new PrivateObject(new ClassLibrary.Manager());
            var actual = privateInfo.Invoke("SampleMethod", 1);
        }

        [TestMethod]
        public void TestErrorsOut()
        {
            var privateInfo = new PrivateObject(new ClassLibrary.Manager());
            var actual = privateInfo.Invoke("SampleMethod", 0);
        }

        [TestMethod]
        public void TestWorksAsWell()
        {
            var privateInfo = new PrivateObject(new ClassLibrary.Manager());
            privateInfo.Invoke("SampleMethod", new object[] { 0 });
        }

        [TestMethod]
        public void TestAlsoErrorsOut()
        {
            var privateInfo = new PrivateObject(new ClassLibrary.Manager());
            var types = new Type[] { typeof(int) };
            var actual = privateInfo.Invoke("SampleMethod", types, 0);
        }
    }
} 
```

第一个测试 (TestPasses()) 有效。

第二个测试 (TestErrorsOut()) 失败并出现以下错误：{"Method 'ClassLibrary.Manager.SampleMethod' not found."}

令人费解的是错误是一致的，但实际测试几乎相同。这没有道理。我在 VS2012 RC 和 VS2010 上试过这个，结果相同。

我唯一能想到的是“0”被转换为除int之外的东西，这意味着它找不到SampleMethod的方法签名？我尝试了第三个测试来显式传递我正在寻找的类型 (TestAlsoErrorsOut())，但这也会出现同样的错误。

想法？谢谢。

**编辑以添加**

通过使用 Ian 的建议，即使用 obj[] 而不是 params obj[] 重载，它可以工作（测试 TestWorksAsWell()）。这就解释了为什么 TestAlsoErrorsOut() 会失败，因为我使用的是 params 方法，该方法不适用于 Type[]。所以，这是固定的。但为什么？为什么 params obj[] 在传递 1 而不是 0 时会起作用？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-07-25T11:40:51.200

根据文档（[http://msdn.microsoft.com/en-us/library/ms243710.aspx](http://msdn.microsoft.com/en-us/library/ms243710.aspx)），参数应该作为对象数组传递。显式传递对象数组似乎可以正常工作：

```
var actual = (int)privateInfo.Invoke("SampleMethod", new object[] {0}); 
```

自行传递 0 似乎会导致编译器选择此重载

```
Invoke(string name = "SampleMethod", System.Reflection.BindingFlags bindingFlags = Default, object[] args = {object[0]}) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-02-03T10:39:09.317

调用以下测试时，我得到了 System.MissingMethodException：

```
PrivateObject shadow = new PrivateObject(target);    
shadow.Invoke("PrivateMethod", new string[]{"arg1","arg2"}); 
```

关于目标的私有方法签名

```
private void PrivateMethod(string[] args) 
```

我必须在私有方法签名中添加参数来解决异常，如下所示：

```
private void PrivateMethod(params string[] args) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-03-04T07:54:14.157

伊恩·吉尔罗伊（Ian Gilroy）是对的，但原因是；这是因为`PrivateObject.Invoke`有很多签名，其中之一是：`Invoke(string name, Type[] types, object[] objects)`.

在我的情况下，我传递的值如下：`Invoke("MethodName", null, null)`，在这种情况下，C# 编译器更喜欢提到的签名，而不是`Invoke(string name, params object[] objects)`，这会导致错误。

# regex - 正则表达式匹配 " 但不匹配 \"

> ID：11640798
> 
> 赞同：4
> 
> 时间：2012-07-24T23:36:02.503
> 
> 标签：regex

我总是对正则表达式完全不知所措，所以我希望这里有人可以提供帮助。

Joomla 使用这个正则表达式来验证 ini 文件的行：

```
/^(|(\[[^\]]*\])|([A-Z][A-Z0-9_\-]*\s*=(\s*(("[^"]*")|(_QQ_)))+))\s*(;.*)?$/ 
```

这些行具有这种格式

```
JLIB_LOGIN_AUTHENTICATE="Username and password do not match or you do not have an account yet." 
```

显然`"`不能在值部分中被允许，但`\"`可以。目前，这与上述正则表达式匹配。我可以看到它是如何匹配的，但我无法将正则表达式修改为不匹配`\"`。我尝试添加`|(\Q\"\E)`到各个地方，但没有运气。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-24T23:41:21.803

改变这个：

```
"[^"]*"

```

对此：

```
"(\\"|[^"])*"

```

在线查看它：[ideone](http://ideone.com/ysI0j)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-24T23:41:53.283

替换`[^"]`为`([^"]|(\\"))`

# android - 启动Android Service 4.0开机时间

> ID：11640800
> 
> 赞同：0
> 
> 时间：2012-07-24T23:36:28.057
> 
> 标签：android, service, time, boot

我的英语很差。我无法在启动时启动 android 服务，我不知道问题所在。我正在尝试示例代码，但没有成功。有人可以发给我一个运行的 Java 项目吗？其他代码适用于其他人，但在我的平板电脑智能手机模拟器上它不起作用。android 4.0是否存在问题？

这是我的代码：

```
 <manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.example.service22"
    android:versionCode="1"
    android:versionName="1.0" 
    android:installLocation="internalOnly"
    >

    <supports-screens android:largeScreens="false" android:normalScreens="true" android:smallScreens="false"/>
    <uses-permission android:name="android.permission.RECEIVE_BOOT_COMPLETED"/>

    <application android:icon="@drawable/ic_launcher" android:label="@string/app_name">
            <service android:name="com.example.MyService">
                <intent-filter>
                    <action android:name="com.example.MyService">
                </action>
            </intent-filter>
        </service>
        <receiver android:name="com.example.MyReceiver">
            <intent-filter>
                <action android:name="android.intent.action.BOOT_COMPLETED">
                </action>
                <category android:name="android.intent.category.HOME">
                </category>
            </intent-filter>
        </receiver>
    </application>

</manifest>

    public class MyService extends Service 
    {

       private static final     String LOG_TAG = "::Monitor";

    @Override
    public void onCreate() {
        super.onCreate();
        Log.e(LOG_TAG, "Service created.");
    }

    @Override
    public void onStart(Intent intent, int startId) 
    {
        super.onStart(intent, startId);

        for (int i = 0 ; i < 20 ; i++)
        {
            mensaje();
        }

        Log.e(LOG_TAG, "Service started.");
    }
    @Override
    public void onDestroy() 
    {
           super.onDestroy();
           Log.e(LOG_TAG, "Service destroyed.");
    }

    @Override
    public IBinder onBind(Intent intent) 
    {
        Log.e(LOG_TAG, "Service bind.");
        return null;
    }

   public void mensaje()
   {
       Toast.makeText(this, "Hola", Toast.LENGTH_LONG).show();
   }

}

     public class MyReceiver extends BroadcastReceiver 
{
    public MyReceiver() 
    {
    }

    String LOG_TAG = "::StartAtBootServiceReceiver";

    @Override
    public void onReceive(Context context, Intent intent) 
    {

        Log.e(LOG_TAG, "onReceive:");
        if (intent.getAction().equals(Intent.ACTION_BOOT_COMPLETED)) {
            Intent i = new Intent();
            i.setAction("com.example.MyService");
            context.startService(i);
        }

    }

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T23:44:11.897

```
import android.content.BroadcastReceiver;
import android.content.Context;
import android.content.Intent;
import android.util.Log;

public class OnBootReceiver extends BroadcastReceiver {
  @Override
  public void onReceive(Context context, Intent intent) {
    Log.d("OnBootReceiver", "Hi, Mom!");
  }
} 
```

和清单文件

```
<uses-permission android:name="android.permission.RECEIVE_BOOT_COMPLETED" />
  <application android:icon="@drawable/cw"
               android:label="@string/app_name">
    <receiver android:name=".OnBootReceiver">
      <intent-filter>
        <action android:name="android.intent.action.BOOT_COMPLETED" />
      </intent-filter>
    </receiver>
  </application> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T10:12:31.663

重要提示：Android OS 3.1+ 在以下情况下仍然会忽略您的广播接收器： 1.用户从未明确启动过应用程序至少一次。
2.用户已“强制关闭”应用程序。

问题与您的实施无关。这是 Google 已关闭的 Android 中的一个潜在安全漏洞 :)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-25T07:35:34.360

我认为：

```
Intent i = new Intent();
i.setAction("com.example.MyService");
context.startService(i); 
```

还不够，您必须像这样设置意图类名称：

```
Intent i = new Intent();
i.setClassName("com.example", "com.example.MyService");
i.setAction("com.example.MyService");
context.startService(i); 
```

请尝试一下。

# node.js - 如何在 node.js 中调用 setlocale(3)？

> ID：11640808
> 
> 赞同：0
> 
> 时间：2012-07-24T23:37:35.300
> 
> 标签：node.js

我正在用 node-ncurses 编写一个程序。我想调用 setlocale(3) 来初始化 C 级语言环境以支持多字节。

在 node.js 中调用 setlocale(3) 是否有正确的方法？或者，有它的 npm 库吗？

# android - 如何使用 dedexer 解释这个反汇编的行？

> ID：11640811
> 
> 赞同：0
> 
> 时间：2012-07-24T23:37:55.533
> 
> 标签：android, dalvik, dex, jvm-bytecode, jasmin

以下是在 android 市场应用程序上使用 dedexer 反汇编的 snipcode，在 中[，](http://sourceforge.net/projects/dedexer/files/)`invoke-virtual`我不明白原始 Java 代码是什么：

`invoke-virtual {v0},[Lcom/google/android/providers/AbstractGDataSyncAdapter$ClientDiffType;/clone ; clone()Ljava/lang/Object;`

`[`应该是一个数组，那么它是在类型数组中的元素上调用方法`clone`吗`com/google/android/providers/AbstractGDataSyncAdapter$ClientDiffType`？那为什么`;`在类名和方法名之间有`clone`呢？dedexer 本身的错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T03:14:01.443

类名以“L”开头，以“;”结尾。`[Lcom/google/android/providers/AbstractGDataSyncAdapter$ClientDiffType;`数组也是如此`com.google.android.providers.AbstractGDataSyncAdapter.ClientDiffType`

我不知道'/克隆;' 语法虽然。看起来它可能是 dexer 中的一个错误。紧随其后的 clone() 显然是方法。

“那么它是否在数组中的元素上调用克隆方法” - 这是不正确的。它在整个数组上调用 clone 方法，而不是在数组中的元素上。

# android-ndk - 交叉编译freetype for android

> ID：11640819
> 
> 赞同：0
> 
> 时间：2012-07-24T23:39:03.910
> 
> 标签：android-ndk, cross-compiling, freetype

我正在尝试在 android native 中使用免费类型，并且我正在尝试遵循本教程：[http](http://en.wikibooks.org/wiki/OpenGL_Programming/Installation/Android#FreeType) ://en.wikibooks.org/wiki/OpenGL_Programming/Installation/Android#FreeType这似乎是每个人都链接到的标准教程。

我现在的问题是我之前从未交叉编译过任何东西，当我尝试使用以下命令准备交叉编译器时：make-standalone-toolchain.sh ...在cygwin（我在windows 7上）我得到：

```
-bash: make-standalone-toolchain.sh: command not found 
```

即使它肯定存在。我错过了什么？还是根本不在cygwin中完成，而是在其他地方完成？这个标准教程对我来说不够详细，谁能给我更详细的解释，说明我必须在哪里给出这些命令？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T08:49:04.453

您不能只在 Windows 环境中运行 .sh 脚本...您必须使用 sh.exe 实用程序来规划您的脚本...类似于：

```
path_to_cygwin\bin\sh make-standalone-toolchain.sh [options] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-06-19T21:53:29.747

我已经设法使用 CMake 在 ndk 中编译和使用 freetype 2.7.1 库：

```
cmake_minimum_required(VERSION 3.4.1)

set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -std=c++11")

# freetype 2.7.1
add_definitions(-DFT2_BUILD_LIBRARY)

set(FTDIR "src/main/cpp/freetype")
include_directories(${FTDIR}/include)

set(FTSRC
  ${FTDIR}/src/autofit/autofit.c
  ${FTDIR}/src/base/ftbase.c
  ${FTDIR}/src/base/ftbbox.c
  ${FTDIR}/src/base/ftbdf.c
  ${FTDIR}/src/base/ftbitmap.c
  ${FTDIR}/src/base/ftcid.c
  ${FTDIR}/src/base/ftfntfmt.c
  ${FTDIR}/src/base/ftfstype.c
  ${FTDIR}/src/base/ftgasp.c
  ${FTDIR}/src/base/ftglyph.c
  ${FTDIR}/src/base/ftgxval.c
  ${FTDIR}/src/base/ftinit.c
  ${FTDIR}/src/base/ftlcdfil.c
  ${FTDIR}/src/base/ftmm.c
  ${FTDIR}/src/base/ftotval.c
  ${FTDIR}/src/base/ftpatent.c
  ${FTDIR}/src/base/ftpfr.c
  ${FTDIR}/src/base/ftstroke.c
  ${FTDIR}/src/base/ftsynth.c
  ${FTDIR}/src/base/ftsystem.c
  ${FTDIR}/src/base/fttype1.c
  ${FTDIR}/src/base/ftwinfnt.c
  ${FTDIR}/src/bdf/bdf.c
  ${FTDIR}/src/bzip2/ftbzip2.c
  ${FTDIR}/src/cache/ftcache.c
  ${FTDIR}/src/cff/cff.c
  ${FTDIR}/src/cid/type1cid.c
  ${FTDIR}/src/gzip/ftgzip.c
  ${FTDIR}/src/lzw/ftlzw.c
  ${FTDIR}/src/pcf/pcf.c
  ${FTDIR}/src/pfr/pfr.c
  ${FTDIR}/src/psaux/psaux.c
  ${FTDIR}/src/pshinter/pshinter.c
  ${FTDIR}/src/psnames/psnames.c
  ${FTDIR}/src/raster/raster.c
  ${FTDIR}/src/sfnt/sfnt.c
  ${FTDIR}/src/smooth/smooth.c
  ${FTDIR}/src/truetype/truetype.c
  ${FTDIR}/src/type1/type1.c
  ${FTDIR}/src/type42/type42.c
  ${FTDIR}/src/winfonts/winfnt.c
  ${FTDIR}/src/base/ftdebug.c
  ${FTDIR}/include/ft2build.h
  ${FTDIR}/include/freetype/config/ftconfig.h
  ${FTDIR}/include/freetype/config/ftheader.h
  ${FTDIR}/include/freetype/config/ftmodule.h
  ${FTDIR}/include/freetype/config/ftoption.h
  ${FTDIR}/include/freetype/config/ftstdlib.h
)

add_library( freetype SHARED ${FTSRC} ) 
```

然后将其链接到您的 ndk 库：例如

```
add_library(native-lib SHARED src/main/cpp/native-lib.cpp)
target_link_libraries(native-lib freetype) 
```

# java - 按钮上的 ImageIcon 和图像问题 - JFrame

> ID：11640821
> 
> 赞同：0
> 
> 时间：2012-07-24T23:39:17.377
> 
> 标签：java, image, swing, jframe, embedded-resource

这让我一整天都发疯了，所以我想我会把它贴在这里，看看其他人是否能解决这个问题。首先，我尝试添加背景图像，默认的 ImageIcon 不起作用，所以我改用了覆盖 paint 方法。#

```
public class ImageJPanel extends JPanel { 
private static final long serialVersionUID = -1846386687175836809L;
Image image = null; 

public ImageJPanel(){ 
    addComponentListener(new ComponentAdapter() { 
    public void componentResized(ComponentEvent e) { 
        ImageJPanel.this.repaint(); 
    } 
}); 
}
//Set the image.
public ImageJPanel(Image i) { 
  image=i; 
  setOpaque(false); 
} 
//Overide the paint component.
public void paint(Graphics g) { 
  if (image!=null) g.drawImage(image, 0, 0, null); 
  super.paint(g); 
} 
```

}

一旦我使用它就可以正常工作，但是现在我想将图像添加到我的按钮中，但它不起作用。这是我的按钮的工作原理：

```
frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
Images images = new Images();
JPanel j = new ImageJPanel(images.menuBackground); 
j.setLayout(null);
JButton Button_1= new JButton("Button_1",new ImageIcon("images/gui/Button.png"));

Insets insets = j.getInsets();
Dimension size = Button_1.getPreferredSize();
Button_1.setBounds(300 + insets.left, 150+ insets.top, size.width, size.height);

Singleplayer.setSize(200, 50);

j.add(Button_1);

frame.add(j);
frame.setSize(800,600);
frame.setResizable(false);
Button_1.addMouseListener(singleplayerPressed);

frame.setVisible(true); 
```

我所有的图像都是.png，这会影响它吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T23:51:31.673

让我们从这个开始：

```
public void paint(Graphics g) { 
    if (image!=null) g.drawImage(image, 0, 0, null); 
    super.paint(g); 
} 
```

这是错误的做法。首先，你真的不想重写paint方法，除非你绝对知道这是解决你的问题的正确方法（并且不知道更多，我建议它不是）。

其次，您在组件上绘制图像，然后立即在其顶部绘制......（`super.paint(g);`可以在您的作品上绘制，我知道面板是不透明的，但这仍然是一个非常糟糕的方法）。

`paintComponent`改为使用

```
protected void paintComponent(Graphics g) { 
    super.paint(g); 
    if (image!=null) g.drawImage(image, 0, 0, null); 
} 
```

PNG 图像很好，Swing 开箱即用地支持它们。

确保您的程序可以看到图像。它是从文件源加载的还是 JAR 中的资源？

试试这个：

```
System.out.println(new File("images/gui/Button.png").exits()); 
```

如果您的程序可以看到该文件，它将返回，否则`true`程序看不到该文件，那是您的问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-24T23:53:04.243

试试这个：

```
ImageIcon image = new ImageIcon(this.getClass()
                .getResource("images/gui/Button.png")); 
```

Side note, you should override `paintComponent()` not `paint()`. Also make sure to call `super` implementation *before* doing all your painting. For more details see [Lesson: Performing Custom Painting](http://docs.oracle.com/javase/tutorial/uiswing/painting/) tutorial.

# magento - magento 注册表已经

> ID：11640822
> 
> 赞同：2
> 
> 时间：2012-07-24T23:39:19.070
> 
> 标签：magento, registry, observers

我正在为 Magento 开发一个调用 Web 服务并添加 cookie 的模块。我希望在保存用户时调用类中的方法（ customer_save_after ）。在本地主机上开发时，我能够以某种方式使其工作，但在我尝试实现它的实时站点上出现此错误：

> 法师注册表键“_singleton/Eight18_Aqui4_Model_Observer”已经存在

[这里](https://stackoverflow.com/questions/6816058/mage-registry-key-already-exists-when-firing-events)有一个类似的线程，但它忽略了如何解决问题的实际细节。

这是我的 config.xml：（customer_save_after 事件似乎是错误开始的地方）

```
<?xml version="1.0"?>
<config>
    <global>
        <helpers>
            <aqui4>
                <class>Eight18_Aqui4_Helper</class>
            </aqui4>
        </helpers>
        <modules>
                <Eight18_aqui4>
                        <version>0.1.0</version>
                </Eight18_aqui4>
        </modules>
    </global>
    <adminhtml>
    <acl>
        <resources>
            <all>
                <title>Allow Everything</title>
            </all>
        <admin>
            <children>
            <Eight18_Aqui4>
                <title>Aqui4 Module</title>
                <sort_order>10</sort_order>
            </Eight18_Aqui4>
            </children>
        </admin>
        </resources>
    </acl>
    <layout>
        <updates>
        <aqui4>
            <file>aqui4.xml</file>
        </aqui4>
        </updates>
    </layout>
    </adminhtml>

    <default>
        <main>
            <enable>1</enable>
            <siteid>0</siteid>
            <sitetoken>0</sitetoken>
        </main>
    </default>

    <frontend>
        <events>
            <customer_save_after>
            <observers>
                <aqui4_observer>
                    <class>Eight18_Aqui4_Model_Observer</class>
                    <method>start_aqui4</method>
                </aqui4_observer>
            </observers>
        </customer_save_after>
        </events>
        <routers>
            <aqui4>
                <use>standard</use>
                <args>
                    <module>Eight18_Aqui4</module>
                    <frontName>aqui4</frontName>
                </args>
            </aqui4>
        </routers>
        <layout>
            <updates>
                <aqui4>
                      <file>aqui4.xml</file>
                </aqui4>
            </updates>
            </layout>
        </frontend>
</config> 
```

/公司/模块/模型/observer.php：

```
Public function start_aqui4() {//THIS IS CALLED BY THE EVENT OBSERVER ON CUSTOMER CREATION
    // get variables
    $userEmail = Mage::helper('aqui4')->getUserEmail();
    $userFirstName = Mage::helper('aqui4')->getUserFirstName();
    $userLastName = Mage::helper('aqui4')->getUserLastName();
    $siteID = Mage::helper('aqui4')->getSiteID();
    $siteToken = Mage::helper('aqui4')->getSiteToken();
    $expire=time()+60*60*24*30.42*6;//THE LAST NUMBER IS THE MONTHS
    $randomNumber = rand(0, pow(10, 5));//SERVICE EXPECTS RAND NUMBER

    if(isset( $_COOKIE['aqui4userid'] )){//CHECK TO SEE IF USER ALREADY HAS A COOKIE
        return;
    }
    else{//CHANGE JSON DATA SO JSON_DECODE CAN READ IT
        $getContent = file_get_contents("http://www.domain.com/service.ashx?siteId=" . $siteID . "&token=" . $siteToken . "&email=" . $userEmail . "&data={\"firstName\":\"" . $userFirstName . "\",\"lastName\":\"" . $userLastName . "\",\"email\":\"" . $userEmail . "\",\"company\":\"\",\"position\":\"\",\"country\":\"\"}", true);
        $getContent = str_replace('function __authenticate() ', '', $getContent);
        $getContent = str_replace('{ return ', '', $getContent);
        $getContent = str_replace(';}', '', $getContent);
        $getContent = str_replace('\'', '"', $getContent);
        $getContent = str_replace(': "', ':"', $getContent);

        //SET THE USER ID AND ERROR VARS BASED ON DATA PASSED BACK
        $getContentArray = json_decode($getContent, true);
        $error = $getContentArray['HasError'];
        $userID = $getContentArray['UserId'];

        if($error){
            if($error != "True"){//SERVICE RETURNS NO ERROR
                setcookie("aqui4userid", $userID, $expire);
                return;
            }
            else{//NO COOKIE SET - USER WAS NOT ADDED
                return;
            }
        }
    }
} 
```

}

最后是 system.log 文件：

```
2012-07-24T23:21:52+00:00 ERR (3): Warning: include(/var/www/clients/client3/web4/web/includes/src/Eight18_Aqui4_Model_Observer.php): failed to open stream: No such file or directory  in /var/www/clients/client3/web4/web/includes/src/Varien_Autoload.php on line 93
2012-07-24T23:21:52+00:00 ERR (3): Warning: include(): Failed opening '/var/www/clients/client3/web4/web/includes/src/Eight18_Aqui4_Model_Observer.php' for inclusion (include_path='/var/www/clients/client3/web4/web/includes/src:.:/usr/share/php:/usr/share/pear')  in /var/www/clients/client3/web4/web/includes/src/Varien_Autoload.php on line 93
2012-07-24T23:21:52+00:00 ERR (3): Warning: include(/var/www/clients/client3/web4/web/includes/src/Eight18_Aqui4_Model_Observer.php): failed to open stream: No such file or directory  in /var/www/clients/client3/web4/web/includes/src/Varien_Autoload.php on line 93
2012-07-24T23:21:52+00:00 ERR (3): Warning: include(): Failed opening '/var/www/clients/client3/web4/web/includes/src/Eight18_Aqui4_Model_Observer.php' for inclusion (include_path='/var/www/clients/client3/web4/web/includes/src:.:/usr/share/php:/usr/share/pear')  in /var/www/clients/client3/web4/web/includes/src/Varien_Autoload.php on line 93
2012-07-24T23:21:54+00:00 ERR (3): Warning: include(/var/www/clients/client3/web4/web/includes/src/Eight18_Aqui4_Model_Observer.php): failed to open stream: No such file or directory  in /var/www/clients/client3/web4/web/includes/src/Varien_Autoload.php on line 93
2012-07-24T23:21:54+00:00 ERR (3): Warning: include(): Failed opening '/var/www/clients/client3/web4/web/includes/src/Eight18_Aqui4_Model_Observer.php' for inclusion (include_path='/var/www/clients/client3/web4/web/includes/src:.:/usr/share/php:/usr/share/pear')  in /var/www/clients/client3/web4/web/includes/src/Varien_Autoload.php on line 93 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-25T00:02:03.727

简短版本：您的生产系统正在“编译器模式”下运行，并且您尚未编译模块类。

您的生产服务器在 Magento 的“[编译器模式](http://alanstorm.com/magento_compiler_path)”（自链接）打开的情况下运行。您可以通过 Magento's logging 的错误消息来判断

```
ERR (3): Warning: include(): Failed opening '/var/www/clients/client3/web4/web/includes/src/Eight18_Aqui4_Model_Observer.php' 
for inclusion (include_path='/var/www/clients/client3/web4/web/includes/src:.:/usr/share/php:/usr/share/pear')  in /var/www/clients/client3/web4/web/includes/src/Varien_Autoload.php on line 93 
```

Magento 正在寻找`includes/src`课程。那是放置编译类的地方。此外，PHP 正在尝试包含一个完全下划线的文件名`Eight18_Aqui4_Model_Observer.php`。这只发生在编译器模式打开时。

当您将模块更改推送到生产环境时，您需要重新编译您的模块。你可以从

```
System -> Tools -> Compilation 
```

或使用命令行编译器脚本

```
$ php shell/compiler.php
Usage:  php -f compiler.php -- [options]

  state         Show Compilation State
  compile       Run Compilation Process
  clear         Disable Compiler include path and Remove compiled files
  enable        Enable Compiler include path
  disable       Disable Compiler include path
  help          This help 
```

# linux - 无法连接到 Linux“抽象”unix 套接字

> ID：11640826
> 
> 赞同：10
> 
> 时间：2012-07-24T23:39:41.770
> 
> 标签：linux, unix-socket

我正在尝试使用 UNIX 套接字进行线程间通信。该程序仅用于在 Linux 上运行。为了避免创建套接字文件，我想使用“抽象”套接字，如 unix(7) 中所述。

但是，我似乎无法连接到这些套接字。不过，如果我使用“路径名”套接字，一切正常。

这是代码（我没有引用任何错误处理，但已经完成）：thread#1：

```
int log_socket = socket(AF_LOCAL, SOCK_STREAM, 0);
struct sockaddr_un logaddr;
socklen_t sun_len = sizeof(struct sockaddr_un);
logaddr.sun_family = AF_UNIX;
logaddr.sun_path[0] = 0;
strcpy(logaddr.sun_path+1, "futurama");
bind(log_socket, &logaddr, sun_len);
listen(log_socket, 5);
accept(log_socket, &logaddr, &sun_len);
... // send - receive 
```

线程#2：

```
struct sockaddr_un tolog;
int sock = socket(AF_LOCAL, SOCK_STREAM, 0);
tolog.sun_family = AF_UNIX;
tolog.sun_path[0] = 0;
strcpy(tolog.sun_path+1, "futurama");
connect(sock, (struct sockaddr*)&tolog, sizeof(struct sockaddr_un)); 
```

如果我在上面的代码中所做的只是将 sun_path 更改为没有前导 \0，则一切正常。

strace 输出：

```
t1: socket(PF_FILE, SOCK_STREAM, 0)         = 0
t1: bind(0, {sa_family=AF_FILE, path=@"futurama"}, 110)
t1: listen(0, 5)
t2: socket(PF_FILE, SOCK_STREAM, 0) = 1
t2: connect(1, {sa_family=AF_FILE, path=@"futurama"}, 110 <unfinished ...>
t2: <... connect resumed> )     = -1 ECONNREFUSED (Connection refused)
t1: accept(0,  <unfinished ...> 
```

我知道connect在accept之前，这不是问题（我尝试确保在connect（）之前调用accept（），结果相同。此外，如果套接字是“路径名”，一切都很好）。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-07-24T23:39:41.770

当我发布这个问题并重新阅读 unix(7) 手册页时，这个措辞引起了我的注意：

> 抽象套接字地址的区别在于 sun_path[0] 是一个空字节 ('\0')。 **sun_path中的所有剩余字节** 都定义了套接字的“名称”

所以，如果我在填写我的名字之前对 sun_path 进行了归零，事情就开始起作用了。我认为这不一定是直截了当的。此外，正如@davmac 和@StoneThrow 正确指出的那样，可以通过仅指定足够长度的套接字地址结构来覆盖您要考虑作为地址的字节来减少这些“剩余字节”的数量。一种方法是使用`SUN_LEN`宏，但是，`sun_path`必须将 的第一个字节设置为 !0，因为`SUN_LEN`使用`strlen`.

*细化*

如果 sun_path[0] 为 \0，则内核使用 sun_path 的全部剩余部分作为套接字的名称，无论它是否以 \0 结尾，所以所有剩余部分都算在内。在我的原始代码中，我会将第一个字节归零，然后将套接字名称 strcpy() 放入位置 1 的 sun_path。分配结构时 sun_path 中的任何乱码（尤其可能包含乱码，因为它是在堆栈上分配的） ，并且包含在套接字结构的长度中（传递给系统调用），算作套接字的名称，并且在 bind() 和 connect() 中有所不同。

恕我直言，strace 应该修复它显示抽象套接字名称的方式，并显示`sun_path`从 1 到提供的结构长度的所有字节，如果`sun_path[0]`是`0`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-06-24T07:24:05.403

使抽象命名空间中的套接字工作的关键是为“绑定”和“连接”命令提供适当的长度。为避免在 sockaddr_un 的地址末尾设置 '\0' ，应使用 strncpy 或类似方法复制它。

Pawel 的回答中已经对此进行了解释，所以我将举一个例子。

服务器：

```
int main(int argc, char** argv)
{
  //to remove warning for unused variables.
  int dummy = argc;
  dummy = (int)argv;

  int fdServer = 0;
  int fdClient = 0;
  int iErr     = 0;
  int n = 0;
  socklen_t addr_len = 0;
  char buff[1024];
  char resp[1024];

  const char* const pcSocketName = "/tmp/test";

  struct sockaddr_un serv_addr; 

  //set the structure with 'x' instead of 0 so that we're able 
  //to see the full socket name by 'cat /proc/net/unix'
  //you may try playing with addr_len and see the actual name 
  //reported in /proc/net/unix
  memset(&serv_addr, 'x', sizeof(serv_addr));
  serv_addr.sun_family = AF_UNIX;
  serv_addr.sun_path[0] = '\0';
  //sizeof(pcSocketName) returns the size of 'char*' this is why I use strlen
  strncpy(serv_addr.sun_path+1, pcSocketName, strlen(pcSocketName));

  fdServer = socket(PF_UNIX, SOCK_STREAM, 0);
  if(-1 == fdServer) {
    printf("socket() failed: [%d][%s]\n", errno, strerror(errno));
    return(-1);
  }

  iErr = bind(fdServer, (struct sockaddr*)&serv_addr, offsetof(struct sockaddr_un, sun_path) + 1/*\0*/ + strlen(pcSocketName));

  if(0 != iErr) {
    printf("bind() failed: [%d][%s]\n", errno, strerror(errno));
    return(-1);
  }

  iErr = listen(fdServer, 1);
  if(0 != iErr) {
    printf("listen() failed: [%d][%s]\n", errno, strerror(errno));
    return(-1);
  }

  addr_len = sizeof(pcSocketName);
  while(1) {
    fdClient = accept(fdServer, (struct sockaddr*) &serv_addr, &addr_len);
    if(0 >= fdClient) {
      printf("accept() failed: [%d][%s]\n", errno, strerror(errno));
      return(-1);
    }

    memset(resp, 0, sizeof(resp));
    memset(buff, 0, sizeof(buff));
    n = recv(fdClient, buff, sizeof(buff), 0);
    if(0 > n) {
      printf("recv() failed: [%d][%s]\n", errno, strerror(errno));
      return(-1);
    }

    printf("[client]: %s\n", buff);
    sprintf(resp, "echo >> %s", buff);
    n = send(fdClient, resp, sizeof(resp), 0);
    if(0 > n) {
      printf("send() failed: [%d][%s]\n", errno, strerror(errno));
      return(-1);
    }
    printf("[server]: %s\n", resp);
  }

  close(fdServer);

  return(0);
} 
```

客户：

```
int main(int argc, char** argv) {
  //to remove warning for unused variables.
  int dummy = argc;
  dummy = (int)argv;

  int fdClient = 0;
  struct sockaddr_un serv_addr;
  int iErr     = 0;
  const char* const pcSocketName = "/tmp/test";

  char buff[1024];

  memset(&serv_addr, 0, sizeof(serv_addr));
  serv_addr.sun_family = AF_UNIX;
  serv_addr.sun_path[0] = '\0';
  strncpy(serv_addr.sun_path+1, pcSocketName, strlen(pcSocketName));

  fdClient = socket(PF_UNIX, SOCK_STREAM, 0);
  if(-1 == fdClient) {
    printf("socket() failed: [%d][%s]\n", errno, strerror(errno));
    return(-1);
  }

  iErr = connect(fdClient, (struct sockaddr*) &serv_addr, offsetof(struct sockaddr_un, sun_path) + 1/*\0*/ + strlen(pcSocketName));
  if(0 != iErr) {
    printf("connect() failed: [%d][%s]\n", errno, strerror(errno));
    return(-1);
  }

  memset(buff, 0, sizeof(buff));
  sprintf(buff, "Hello from client!");

  printf("[client]: %s\n", buff);
  iErr = send(fdClient, buff, sizeof(buff), 0);
  if(0 > iErr){
    printf("write() failed: [%d][%s]\n", errno, strerror(errno));
    return(-1);
  }

  iErr = recv(fdClient, buff, sizeof(buff), 0);
  if(0 > iErr){
    printf("read() failed: [%d][%s]\n", errno, strerror(errno));
    return(-1);
  }

  printf("[server]: %s\n", buff);

  return(0);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-10-25T08:36:15.520

就我而言，将*strncpy()*替换为*snprintf()*并将副本大小增加到 UNIX_PATH_MAX 解决了这个问题。

### 原来的

```
strncpy(server_addr.sun_path, SOCKET_PATH, sizeof(SOCKET_PATH)); 
```

### 修改的

```
snprintf(server_addr.sun_path, UNIX_PATH_MAX, SOCKET_PATH); 
```

希望能帮助到你。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-12-24T15:12:48.840

不确定 SOCKET_PATH 是如何定义的，但如果它是我怀疑的字符串文字，那么 sizeof(SOCKET_PATH) 将是 char* 的大小，通常为 4 或 8 个字节。

# iphone - iphone模拟器上的Sqlite3

> ID：11640828
> 
> 赞同：0
> 
> 时间：2012-07-24T23:39:49.393
> 
> 标签：iphone, sqlite, simulator

我现在在这个问题上苦苦挣扎了几天。希望我能在这里得到一些帮助。

1.  我将现有的 sqlite 数据库导入到我的 Xcode 4.3 项目中。运行模拟器。在模拟器中，我从 UI 创建了一条记录。

2.  在日志中，我看到该应用程序将数据库复制到内部目录/application.app/ 目录中。

3.  从终端我运行 sqlite3 并从该内部目录打开数据库并运行 select sql。我看到了那个记录。到目前为止很棒。

4.  我关闭应用程序模拟器并再次运行它。现在记录已经消失了！！！如何保留在模拟器中创建的数据？

提前致谢...

# java - 我的 Android 项目在 Enum 和 string.xml 之间有重复的声明

> ID：11640833
> 
> 赞同：4
> 
> 时间：2012-07-24T23:40:30.500
> 
> 标签：java, android, xml, enums

我有字符串数组用于`Spinner`等。

```
<string-array name="Animal">
    <item >Cat</item>
    <item >Dog</item>
    <item >Rabbit</item>
    <item >Bird</item>
</string-array> 
```

我有一个容器类来包含用户输入或从中选择的值`Spinner`。成员变量大多是原语或`Enum`.

```
public class Container {
    protected int index;
    protected int age;
    protected String name;
    protected Animal pet;
} 
```

这就是其中一个 Enum 类的定义方式（注意这是一个更简单的版本，在我的实际代码中，还有一些方法或变量，并且每个 Enum 实例都是大写的，如 CAT）。

```
public enum Animal {
    Cat, Dog, Rabbit, Bird,     
} 
```

如您所见，我实际上在`Enum`XML 和 XML 中重复了同样的事情。根据 DRY 的说法，这并不是很好。我应该删除哪个，应该如何删除？

在这一点上，我倾向于保留`Enum`，因为它在功能上比 XML 更通用，而且可维护性也不差。我可能担心的唯一可能的问题是它的性能。它们可能需要更多内存和一些额外的编码工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T16:41:08.420

如果要避免重复，则应保留 Enum，然后使用`for(Animal animal:Animal.values()) {...}`.

您可以使用 Enum 名称作为检索本地化标签或类似内容的键。

# prolog - prolog 中的别名 `(not)/1`

> ID：11640834
> 
> 赞同：0
> 
> 时间：2012-07-24T23:40:36.810
> 
> 标签：prolog, alias, negation

我收到了一段名为 exShell 的作业的代码。在其中，代码`(not)/1`用于否定，我目前已经替换了所有实例，`(\+)/1`但我想知道为什么首先会出现。是否可以`(\+)/1`使用`(not)/1`或者是 cprolog 或其他一些 prolog 编译器（例如 cprolog）的约定。

```
solve(not A, C, Rules, (not Proof, C), T, Ask) :- !,
    T1 is -1 * T,
    solve(A, C1, Rules, Proof, T1, Ask),
    C is -1 * C1. 
```

这是它被使用的一个例子。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T19:27:59.483

看起来`not`这里是一个一元运算符，例如用 声明`op(500,fy,not)`，因此用作`solve/6`谓词正在处理的符号数据。例如，

```
?- op(500,fy,not).

Yes
?- write( not 3).
not 3

Yes
?- write_canonical( not 3).
not(3)

Yes
?- not 3 =.. X .

X = [not, 3] 

Yes
?- 
```

# ms-word - “发行日期+3个月”的单词公式

> ID：11640840
> 
> 赞同：1
> 
> 时间：2012-07-24T23:41:28.807
> 
> 标签：ms-word, formula, excel-formula

有没有我们可以在文档中应用的单词公式来自动计算：

```
"Issue Date + 3 months = Resultant Date" 
```

例如：如果文档的发布日期是`1 July 2011`，则输出应该是`1 October 2011`。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T16:11:23.217

有很多方法可以做到这一点。可以使用域代码、书签或表单使用 VBA 计算日期。

Greg Maxey 在这里解释了所有三种方法（以及提供代码示例），做得非常出色：

[http://gregmaxey.mvps.org/word_tip_pages/calculated_dates.html](http://gregmaxey.mvps.org/word_tip_pages/calculated_dates.html)

# javascript - 什么是最好的表单元素样式库/插件（jQuery）？

> ID：11640841
> 
> 赞同：10
> 
> 时间：2012-07-24T23:41:35.517
> 
> 标签：javascript, jquery, css, forms, styles

在我目前正在处理的项目中，表单元素（如`<input>`，`<select>`等`<textarea>`）必须具有非标准的“外观”。

您可以为此推荐哪个库或插件（jQuery）？

我搜索了一些可用的库，但没有找到适合我需要的库。它们背后都有“真实”-“假”元素的想法。该项目有许多即时创建并注入到 DOM 中的表单元素。

主要要求是：

*   即时创建“假”元素。
*   能够为一个节点或 CSS 选择器（不是整个页面）应用样式。
*   假元素和真实元素之间的非侵入式事件传播。（假元素应该响应真实元素的变化，并将其上发生的事件发送到相应的真实元素，如模糊、焦点、更改、单击。库应该关心事件传播，而不是代码）
*   它应该与 IE7 及更高版本兼容。
*   应该有良好的文档和灵活的公共 API

我在一个库上苦苦挣扎，几乎“适应”了它的要求，但它缺乏文档，而且许可不清楚我是否可以修改它。

非常感谢你的帮助！

亲切的问候。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-03-04T12:35:51.343

你可能想看看那些（2014 年 2 月）：

[uniformjs.com](http://uniformjs.com) - 表单元素样式（IE7+、chrome、safari、firefox）

[github.com/emblematiq/Niceforms](http://github.com/emblematiq/Niceforms) - 表单元素样式 - （也许？）听起来很冒险，因为没有社区，只有一个提交者（IE7+、Firefox2+、Safari3+、Opera9+、Chrome0.3+）

[github.com/harvesthq/chosen](http://github.com/harvesthq/chosen)和[Harvesthq.github.io/chosen](http://harvesthq.github.io/chosen) - 表单选择/下拉框

[ivaynberg.github.io/select2](http://ivaynberg.github.io/select2) - 下拉框（IE8+），它似乎起源于 Chosen.js（需要仔细检查）

[github.com/Robdel12/DropKick](http://github.com/Robdel12/DropKick)和[robdel12.github.io/DropKick](http://robdel12.github.io/DropKick) - 表单选择/下拉框

[github.com/gfranko/jQuery.selectBoxIt.js](http://github.com/gfranko/jQuery.selectBoxIt.js) - 表单选择/下拉框

[brianreavis.github.io/selectize.js](http://brianreavis.github.io/selectize.js)或[github.com/brianreavis/selectize.js](http://github.com/brianreavis/selectize.js) - 文本框和框的混合体 - 用于标记、联系人列表、国家选择器等

[arthurgouveia.com/prettyCheckable](http://arthurgouveia.com/prettyCheckable) - 表单复选框和单选按钮样式（IE7+、Chrome、Firefox、Safari 和移动浏览器）

[http://xoxco.com/projects/code/tagsinput/](http://xoxco.com/projects/code/tagsinput/)或[https://github.com/xoxco/jQuery-Tags-Input](https://github.com/xoxco/jQuery-Tags-Input) - 标签

[Twitter Bootstrap](http://getbootstrap.com/)也可能是一个不错的选择 -[使用定制](http://getbootstrap.com/customize/)器仅加载您需要的库的一部分，阅读有关[定制 Twitter 引导组件的更多信息](http://getbootstrap.com/getting-started/#customizing)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-24T23:48:59.647

你可以看到这个！

```
http://twitter.github.com/bootstrap/base-css.html#forms 
```

Bootstrap 有非常实用的东西可以帮助你！

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-24T23:49:01.840

你可以看看[Twitter Bootstrap](http://twitter.github.com/bootstrap/)。我相信它使用 CSS 来执行它的大部分技巧，所以你不应该需要委托组件的概念（真/假的东西）来获得稍微更精致的外观和感觉。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-22T15:09:34.320

我真的很喜欢[jQtransform](http://archive.plugins.jquery.com/project/jqtransform)：你只需要包含 jQuery 库和插件 jqtransform

```
//required
<script type="text/javascript" src="js/jquery.js"></script>
<script type="text/javascript" src="js/jquery.jqtransform.min.js"></script> 
```

**然后将转换应用于所有形式**

```
<script type="text/javascript">
$(function() {
    //find all form with class jqtransform and apply the plugin
    $("form").jqTransform();
});
</script> 
```

**或特定形式**

```
<script type="text/javascript">
$(function() {
    //find all form with class jqtransform and apply the plugin
    $("form.jqtransform").jqTransform();
});
</script> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-07T10:30:57.200

如果您只想设置输入、选择和文本区域的样式，您实际上并不需要 javascript 来做到这一点。使用普通的 css（更改边框、颜色、背景、圆角等）很容易做到这一点。只有较旧的 (IE) 浏览器将无法在您的 (form) 元素上使用圆角。

如果您还希望能够为选择元素的下拉菜单设置样式，则可能需要 javascript，因为这在 CSS 中不起作用。

从我查看的所有现有库中，我发现 jqTransform 最容易使用（如前所述），因为它为表单元素提供了“最干净”的 HTML 替换。这些都很容易用 css 设置样式。

但是，我对 jqTransform 有一些问题。对于初学者来说，它包含一个错误，导致选择元素上的 onchance 事件不触发，而且它没有销毁/刷新选项。因此，您将无法对以已样式化的形式注入的新元素进行样式化。对于这两个问题，我创建了解决方法以使其正常工作。我找到了 onchange 事件的修复（stackoverflow 上的某处），我还编写了一个额外的函数来刷新 jqTransform 元素。

但是，由于这些问题以及 jqTransform 自 2009 年以来没有更新的事实，我大约一个月前决定编写自己的 jQuery 插件来为我处理此功能。

它被称为“jQuery Mighty Form Styler”，它应该适用于 jQuery 1.7 及更高版本。此时它只对 select 元素进行样式设置，因为其他表单元素可以使用 css 设置样式。那么，为什么要使用不必要的 javascript 为您的页面添加加载时间呢？我也计划添加单选框和复选框，因为仅使用 css 对它们进行样式设置并不容易（并且在很多浏览器中都可以使用）。

它已经具有刷新和销毁功能来删除假元素或刷新假元素的内容。

您可以在[http://www.binkje.nl/mfs](http://www.binkje.nl/mfs)获得它，您还可以在其中找到文档。每个人都可以免费使用。尽管我确实相信您不应该使用 javascript 来设置任何样式。那是你应该只用 CSS 做的事情。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-05-31T08:39:17.993

如果您正在寻找适用于桌面 Web 和移动设备的样式（一种响应式解决方案），请查看[Mobiscroll Forms](https://mobiscroll.com/forms)。

它附带 13 个独特的控件，从文本输入到警报、通知和可自定义的滑块。您应该为您的基本表格需求和其他需求提供保障。

另一件需要注意的是，可以使用内置主题为元素设置样式 - 适用于 iOS、Material、Windows、Web - 当然还有上面的 CSS。

*   The toolset can be downloaded from the [website](https://mobiscroll.com/forms).
*   Demos can be seen [here](https://demo.mobiscroll.com/forms).
*   If you prefer: [Github repo](https://github.com/acidb/mobiscroll/) and [NPM package](https://www.npmjs.com/package/mobiscroll-jquery).

# windows - Qt 跨平台 Windows 和 Mac：字体大小

> ID：11640843
> 
> 赞同：3
> 
> 时间：2012-07-24T23:41:56.717
> 
> 标签：windows, macos, qt, fonts, cross-platform

我正在使用 Qt 框架在 Windows 和 OS X 上开发应用程序。
问题是我已经手动设置了一些小部件的字体大小（在 ui 设计器中）。
windows下，字体是完美的，但在osx上，它们太大了。
事实上，字体系列被转换（MS Shell Dlg 2 到 Lucida Grande），但不是字体大小，如果它们是手动设置的。

所以我决定减少代码中的字体大小，使用一些#ifdef，例如：

```
#ifdef Q_OS_MAC
QFont font = ui->button->font();
font.setPixelSize(12);
ui->button->setFont(font);
#endif 
```

它可以工作，但是当你有很多小部件时它会有点烦人，所以我愿意接受任何其他想法。

我也有一个 qtextedit 有这个问题，这个解决方案不起作用，因为它是需要调整的 html 代码。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T02:54:17.680

您可以尝试在[应用程序中全局设置](http://qt-project.org/doc/qt-4.8/qapplication.html#styleSheet-prop)[样式表](http://qt-project.org/doc/qt-4.8/stylesheet.html)，或者一次尝试一个[小部件](http://qt-project.org/doc/qt-4.8/qwidget.html#styleSheet-prop)（及其子部件）。就像是：

```
#ifdef Q_OS_MAC
window->setStyleSheet("QWidget{font-size:12px}");
#endif 
```

# c# - 内存不足异常 - 为 HttpWebRequest 读取大文本文件

> ID：11640844
> 
> 赞同：2
> 
> 时间：2012-07-24T23:42:08.480
> 
> 标签：c#, httpwebrequest, streamreader

我正在尝试读取 500 MB 的文本文件以通过 HttpWebRequest 发送它的内容。根据我的要求，我不能分块发送数据。代码如下：

```
using (StreamReader reader = new StreamReader(filename))
{
    postData = reader.ReadToEnd();
}

byte[] byteArray = Encoding.UTF8.GetBytes(postData);
request.ContentType = "text/plain";
request.ContentLength = byteArray.Length;

Stream dataStream = request.GetRequestStream();
dataStream.Write(byteArray, 0, byteArray.Length);
dataStream.Close();

WebResponse response = request.GetResponse();
Console.WriteLine(((HttpWebResponse)response).StatusDescription);

dataStream = response.GetResponseStream();

using (StreamReader reader = new StreamReader(dataStream))
{
    responseFromServer = reader.ReadToEnd();
}

Console.WriteLine(responseFromServer);
dataStream.Close();
response.Close(); 
```

读取这么大的文件会给我带来内存不足的异常。有没有办法我可以做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T23:50:48.920

所有文件都以块的形式传输——这就是以太网数据包；这是一个单一的数据块。我敢打赌，该要求实际上意味着“必须在单个 Web 服务调用中传输此文件”。

假设是这种情况，您会将数据从磁盘读取到 64KB 缓冲区，然后将缓冲区写入请求。

```
request.ContentType = "text/plain";
request.ContentLength = byteArray.Length;
Stream dataStream = request.GetRequestStream();
int BUFFER_SIZE = 65536;
byte[] buffer = new byte[BUFFER_SIZE];
using (StreamReader reader = new StreamReader(filename)) {
    int count = 0;
    while (true) {
        int count = reader.Read(buffer, 0, BUFFER_SIZE);
        dataStream.Write(buffer, 0, count);
        if (count < BUFFER_SIZE) break;
    }
}
dataStream.Close(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T23:51:04.490

听起来您可能会遇到[这个记录在案的问题`HttpWebRequest`](http://support.microsoft.com/kb/908573)。根据知识库文章，尝试将`HttpWebRequest.AllowWriteStreamBuffering`属性设置为`false`.

# recursion - 递归数独求解器 - 分段错误 (C++)

> ID：11640845
> 
> 赞同：1
> 
> 时间：2012-07-24T23:42:15.670
> 
> 标签：recursion, segmentation-fault, sudoku

为了学习使用递归，我正在尝试制作数独求解器。我似乎已经让大部分代码一起工作得很好，但是当我运行程序时，我收到一个 Windows 错误，告诉我程序已经停止工作。调试表明存在分段错误，我在其他地方看到这可能是由太多递归引起的。我知道这是一种蛮力方法，但同样，我更担心让它发挥作用而不是速度。我该怎么做才能将其修复到工作水平？

```
struct Playing_grid {
    //Value of cell
    int number;
    //wether the number was a clue or not
    bool fixed;
}
grid[9][9];

    void recursiveTest(int row, int column, int testing)
    {
    //first, check to make sure it's not fixed
        if(grid[row][column].fixed == false)
        {
            if((checkRow(testing, row) | checkColumn(testing, column) | checkBox(testing,boxNumber(row,column)) | (testing > 9)) == 0)
            {
                grid[row][column].number = testing;
                moveForward(row,column,testing);
                recursiveTest(row, column, testing);
            }
            else if(testing < 9)
            {
                testing ++;
                recursiveTest(row, column, testing);
            }
            else if(testing == 9)
            {
                while(testing == 9)
               {
                moveBack(row,column,testing);
                while(grid[row][column].fixed == true)
                {
                    {
                        moveBack(row,column,test);
                    }
                }
                testing = grid[row][column].number;
                recursiveTest(row,column,testing);
               }
            }
        }
        else
        {
            moveForward(row,column,testing);
            recursiveTest(row,column,testing);
        }
    }

     void moveForward(int& row, int& column, int& test)
{
    if(column < 8)
    {
        column ++;
    }
    else if((column == 8) & (row != 8))
    {
        column = 0;
        row ++;
    }
    else if((column == 8) & (row == 8))
    {
        finishProgram();
    }
    test = 1;
}

    void moveBack(int& row, int& column, int& test)
    {
        grid[row][column].number = 0;
        if(column > 0)
            {
                column --;
            }
        else if((column == 0) & (row > -1))
            {
                column = 8;
                row --;
            }
        else
        {
            cout << "This puzzle is unsolveable!" << endl;
        }
        test++;
    } 
```

我试图包括所有相关的部分。我基本上创建了一个 9x9 矩阵，此时它填充了 81 个值，其中空槽写为 0。确认测试值在行、列和框中有效后，它填充该值并移动到下一个空间。每当它运行到 9 并且没有可能的值时，它就会返回到前一个值并遍历那个值。

为了不覆盖已知值，递归函数每次都会检查 grid[row][column].fixed 的值是否为假。

我将不胜感激有关清理，浓缩等方面的任何见解。在此先感谢！

编辑：要退出递归循环，当调用函数向前移动时，如果它已到达最后一个单元格，则完成（保存+输出）解决方案。代码已被调整以反映这一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T00:18:21.753

我通常会尝试修复你的代码，但我认为在这种情况下它存在根本缺陷，你需要回到绘图板上。

作为一般规则，像这样的递归函数的伪代码是

```
For each possible (immediate) move
  Perform that move
  Check for win state, if so store/output it and return true.
  Call this function. If it returns true then a win state has been found so return true 
  Otherwise unperform the move
Having tried every move without finding a win state, return false. 
```

# xml - XML编码不可打印的字符？

> ID：11640847
> 
> 赞同：0
> 
> 时间：2012-07-24T23:42:44.760
> 
> 标签：xml, encoding

如果我想以 HTTP Post 之类的方式发送 XML 消息，并且我想要一个二进制属性，我该如何正确编码呢？内容类型：text/xml 字符集：utf-8

我在网上阅读过很多人说我们只需要转义诸如 <、>、"、' 和 之类的东西。但是，我也读到包含不可打印的字符是不正确的，但有一些例外。

假设我想对二进制值 0x01020304 进行编码。我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T02:26:38.227

使用 base64 编码。

（填充，堆栈溢出不喜欢简短的答案）

# c++ - OpenCV vs IVT - 初学者

> ID：11640851
> 
> 赞同：0
> 
> 时间：2012-07-24T23:43:07.790
> 
> 标签：c++, opencv

我正在寻找进入图像/视频处理，并正在寻找一个好的库开始。我听说过两种，OpenCV 和 IVT。我想听听您对哪一个更好开始的意见，两者的优点/缺点是什么，以及哪一个更适合以后可能的商业用途。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-25T02:49:53.200

两者都提供非常相似的功能——大约 95% 的功能重叠。

两者都获得了 BSD(ish) 许可，并广泛用于商业软件包中。

IVT 是一种更简洁、更现代的 C++ 设计，但与 opencv 的新 c++ 绑定运行良好。Opencv 有更多的“C”类型宏，但这也意味着它可以从 C 中使用。python 和其他语言也很好地支持 Opencv，不知道 IVT。

还有[CImg](http://cimg.sourceforge.net/)。它只需要一个头文件并使用 C++ 类型模板，因此您可以编写`result = image.blur().sharpen().edge()`几乎像 Mathematica 一样的代码！
它没有相同深度的功能，尤其是在识别和机器学习等方面，但绝对更容易使用。它是 GPL/LGPL，因此可谨慎用于商业用途。

OpenCV 使用得更广泛，所以有更多的用户可以回答问题——但它也有更多的初学者提问！

对我来说，决定者是 openCV 正在转向支持（几乎）CUDA 中的所有功能（即在并行 GPU 上），这对于任何需要实时视频处理的东西来说都非常棒。

除此之外，我无法评论我没有真正对 IVT 进行足够的基准测试的性能。如果你有一个多核/超线程 CPU，OpenCV 确实使用自定义 SSE2 汇编器进行很多操作，并使用 TBB 来并行其余的操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-25T05:46:34.947

我和你一样是初学者，我个人说 OpenCV。我第一次学习 OpenCV 比 IVT 更轻松，因为文档非常简洁明了，还有常见的初学者书籍、许多教程和 OpenCV 示例项目。

# sed - sed 正则表达式模式误解

> ID：11640857
> 
> 赞同：1
> 
> 时间：2012-07-24T23:43:54.253
> 
> 标签：sed

我尝试通过 sed 解析日志 prase：

```
echo 195.236.222.1 - - [24/Jul/2012:07:35:25 +0300] "GET / HTTP/1.1" 200 387 "http://www.google.fi/url?sa=t&rct=j&q=tarinat&source=web&cd=9&ved=0CGoQFjAI&url=http%3A%2F%2Fwww.suomi24.fi%2F&ei=XyQOUKi0CeWA4gTjz4D4Cg&usg=AFQjCNE6wg5zPXup3d3PRoqU-BtpiNCccw" "Mozilla/5.0 (Windows NT 6.1; rv:13.0) Gecko/20100101 Firefox/13.0.1" |
sed -r 's/.*(\&q=.*)\&.*/\1/' 
```

我想得到 "&q=tarinat" 但不幸的是：

```
\&q=tarinat&source=web&cd=9&ved=0CGoQFjAI&url=http%3A%2F%2Fwww.suomi24.fi%2F&ei=XyQOUKi0CeWA4gTjz4D4Cg 
```

不明白为什么我得到整个字符串直到最后。任何帮助或提示将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T23:51:40.653

正则表达式`.*`是贪婪的。你不希望它贪婪，所以你应该写：

```
sed -r 's/.*(\&q=[^&]*)\&.*/\1/' 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-24T23:51:50.200

`.*`相当贪心。您可以将其替换为否定字符匹配`[^&]*`，该匹配表示匹配除`&`字符之外的任何内容

```
echo 195.236.222.1 - - [24/Jul/2012:07:35:25 +0300] "GET / HTTP/1.1" 200 387 "http://www.google.fi/url?sa=t&rct=j&q=tarinat&source=web&cd=9&ved=0CGoQFjAI&url=http%3A%2F%2Fwww.suomi24.fi%2F&ei=XyQOUKi0CeWA4gTjz4D4Cg&usg=AFQjCNE6wg5zPXup3d3PRoqU-BtpiNCccw" "Mozilla/5.0 (Windows NT 6.1; rv:13.0) Gecko/20100101 Firefox/13.0.1" |
sed -r 's/.*(\&q=[^&]*)\&.*/\1/' 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-24T23:55:02.447

一种简单的使用方法`grep`：

```
grep -o "&q=[^&]*" 
```

结果：

```
&q=tarinat 
```

# java - Android SDK Horizo ntalScrollView

> ID：11640860
> 
> 赞同：1
> 
> 时间：2012-07-24T23:44:32.503
> 
> 标签：java, android, xml, sdk, scrollview

这是我的应用程序的布局，当您滚动查看不同的专辑（紫色）时，我希望专辑和歌曲（红色和蓝色）水平移动。但是，我希望歌曲（蓝色）独立垂直移动以滚动专辑中的歌曲。

到目前为止，我的编码看起来和你期望的一样......

```
<LinearLayout
   <HorizontalScrollView
       <LinearLayout
           <LinearLayout (This layout is so the album cover is displayed correctly)
               <ImageView
               <ScrollView
                 <LinearLayout
                     <TextView   (Songs)
                     <TextView
                     <TextView
                     <TextView 
```

当我垂直滚动歌曲时会出现我的问题。当我垂直滚动时，如果我将手指向左或向右移动，它会检测到 Horizo​​ntalScrollView 并停止垂直滚动。我能做些什么来阻止这种情况？如果我无能为力，除了 Horizo​​ntalScrollView 我还能用什么？

谢谢，

-史蒂文

![在此处输入图像描述](../Images/0cc05a6abd5d30a8f321e9fecb60aa6d.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-25T00:02:00.763

我会说从根本上你需要改变你的布局。首先，每张专辑都有不同数量的歌曲，因此最好制作歌曲列表而`ListView`不是手工制作`ScrollView`。接下来，对于专辑，我将使用 a`ViewPager`并附加 a `ViewPager#OnPageChangeListener`，当页面更改时，歌曲列表也会更新。现在要修复您当前的 xml，根据我的理解，您**只**希望专辑从左到右移动，您需要这样做：

```
<LinearLayout
   <HorizontalScrollView
       <LinearLayout
           <LinearLayout (This layout is so the album cover is displayed correctly)
               <ImageView
   </HorizontalScrollView> <!-- end the album HSV here --!>
               <ScrollView
                 <LinearLayout
                     <TextView   (Songs)
                     <TextView
                     <TextView
                     <TextView
               </ScrollView> 
```

发生的事情是你无缘无故地将垂直包裹`ScrollView`在你的身上。`HorizantleScrollView`现在，如果您想要某种程度的左/右拖船会导致显示下一页的整个页面 - 我会切换到`ViewPager`. （如果您不确定我的意思，请查看 Google Play。它们是垂直`ListViews`的，您可以左右拉动新页面...

# c# - 将对象序列化为平面字典

> ID：11640861
> 
> 赞同：2
> 
> 时间：2012-07-24T23:44:34.873
> 
> 标签：c#, .net, asp.net-mvc, serialization

给定一个班级

```
public class MyClass
{
    public MyInnerClass Property1 {get;set;}
    public MyInnerClass2 Field1
    public MyInnnerClass[] Property2 {get;set;}
} 
```

我需要一个序列化器，与 MVC 序列化器将上述序列化到以下字典中不同。

```
new {
        {
            "Property1.InnerField", "1",
        },
        {
            "Field1.InnerProperty", "7/7/2007"
        },
        {
            "Property2[0].InnerProperty", "0"
        },
        {
            "Property2[1].InnerProperty", "1"
        }
} 
```

基本上它需要位置和本机值，或者进一步递归，直到找到非引用类型。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-25T00:44:31.163

谈到您的问题，我们可能会以教学的方式给出答案，并排除任何现有的序列化架构。这样，您就可以完全自由地进入对象引用树，而无需使用反射并填充结果字典。

我们需要一个简单的方法来访问一个给定的对象，然后为每个公共属性递归地调用它自己。签名应该包含一个字符串来表示当前父链（例如：）`"Property1.InnerProperty4.InnerProperty7"`，并且返回类型应该是`Dictionary<string,string>`只有来自当前和嵌套对象的东西。一开始它应该检查参数是否为值类型，在前一种情况下，只需创建一个新字典，添加一个新的 KeyValuePair(parent+name,value) 并返回；而在后一种情况下，创建一个新字典，然后 foreach 公共属性调用自身，传递当前属性、父+名称字符串，并将返回的字典与先前创建的字典连接，并在循环结束时返回这个大字典。我们可以在开始时添加另一个条件，检查传递的对象是否实现了类似 IEnumerable 接口的东西。在这种情况下，不仅仅是遍历其成员，而是遍历其索引器并为每个项目调用方法。

我找到时间来实现我昨天描述的内容。在这里，您有一个递归方法，旨在返回给定对象的（公共属性全名）-（值）对的字典。当然，它的细节可能并不完全是你想要实现的，但你会发现很多技巧、想法和概念来组成你自己的：

```
namespace MyNamespace
{
    public class ClassA {
        int p1 = 1;
        string p2 = "abcdef"; 
        List<string> p3 = new List<string>() { "ghi","lmn" };
        ClassB p4 = new ClassB();
        ClassB p5 = null;

        public int PA1 { get { return p1; } }
        public string PA2 { get { return p2; } }
        public List<string> PA3 { get { return p3; } }
        public ClassB PA4 { get { return p4; } }
        public ClassB PA5 { get { return p5; } }
    }

    public class ClassB{
        private string p1 = "zeta";
        public string PB1 { get { return p1; } }
    }

    public class Program {

        public void Main()
        {
            ClassA o = new ClassA();
            Dictionary<string, string> result = GetPropertiesDeepRecursive(o, "[o]", new List<string>() { "MyNamespace" });
        }

        /// <summary>
        /// Returns a dictionary of propertyFullname-value pairs of the given object (and deep recursively for its public properties)
        /// note: it's object oriented (on purpose) and NOT type oriented! so it will just return values of not null object trees
        /// <param name="includedNamespaces">a list of full namespaces for whose types you want to deep search in the tree</param>
        /// </summary>        
        public Dictionary<string, string> GetPropertiesDeepRecursive(object o, string memberChain, List<string> includedNamespaces)
        {

            List<string> types_to_exclude_by_design = new List<string>() { "System.string", "System.String" };

            //the results bag
            Dictionary<string, string> r = new Dictionary<string, string>();

            //if o is null just return value = [null]
            if (o == null)
            {
                r.Add(memberChain, "[null]");
                return r;
            }

            //the current object argument type
            Type type = o.GetType();

            //reserve a special treatment for specific types by design (like string -that's a list of chars and you don't want to iterate on its items)
            if (types_to_exclude_by_design.Contains(type.FullName))
            {
                r.Add(memberChain, o.ToString());
                return r;
            }

            //if the type implements the IEnumerable interface...
            bool isEnumerable =
                type
                .GetInterfaces()
                .Any(t => t == typeof(System.Collections.IEnumerable));
            if (isEnumerable)
            {
                int i_item = 0;
                //loop through the collection using the enumerator strategy and collect all items in the result bag
                //note: if the collection is empty it will not return anything about its existence,
                //      because the method is supposed to catch value items not the list itself                
                foreach (object item in (System.Collections.IEnumerable)o)
                {
                    string itemInnerMember = string.Format("{0}[{1}]", memberChain, i_item++);
                    r = r.Concat(GetPropertiesDeepRecursive(item, itemInnerMember, includedNamespaces)).ToDictionary(e => e.Key, e => e.Value);
                }
                return r;
            }

            //here you need a strategy to exclude types you don't want to inspect deeper like int,string and so on
            //in those cases the method will just return the value using the specific object.ToString() implementation
            //now we are using a condition to include some specific types on deeper inspection and exclude all the rest
            if (!includedNamespaces.Contains(type.Namespace))
            {
                r.Add(memberChain, o.ToString());
                return r;
            }

            //otherwise go deeper in the object tree...            
            //and foreach object public property collect each value
            PropertyInfo[] pList = type.GetProperties();
            foreach (PropertyInfo p in pList)
            {
                object innerObject = p.GetValue(o, null);
                string innerMember = string.Format("{0}.{1}", memberChain, p.Name);
                r = r.Concat(GetPropertiesDeepRecursive(innerObject, innerMember, includedNamespaces)).ToDictionary(e => e.Key, e => e.Value);
            }
            return r;
        }
    }
} 
```

# c++ - C++ 中 protobuf 消息的长度前缀

> ID：11640864
> 
> 赞同：13
> 
> 时间：2012-07-24T23:44:55.467
> 
> 标签：c++, sockets, message, protocol-buffers

我正在使用 protobuf 序列化通过 C++ 中的套接字连接发送的消息。对于通信，我想在消息中添加一个标头，指示消息的长度。你怎么看这个实现？我做了一些研究，这就是我总结的。

有没有更好的方法来做到这一点？这个实现会引起任何麻烦吗？我知道有对 Java 的 API 支持，但不幸的是不支持 C++。

```
bool send_message(int socket, my_protobuf::Message message)
{
  google::protobuf::uint32 message_length = message.ByteSize();
  int prefix_length = sizeof(message_length);
  int buffer_length = prefix_length + message_length;
  google::protobuf::uint8 buffer[buffer_length];

  google::protobuf::io::ArrayOutputStream array_output(buffer, buffer_length);
  google::protobuf::io::CodedOutputStream coded_output(&array_output);

  coded_output.WriteLittleEndian32(message_length);
  message.SerializeToCodedStream(&coded_output);

  int sent_bytes = write(socket, buffer, buffer_length);
  if (sent_bytes != buffer_length) {
    return false;
  }

  return true;
}

bool recv_message(int socket, my_protobuf::Message *message)
{
  google::protobuf::uint32 message_length;
  int prefix_length = sizeof(message_length);
  google::protobuf::uint8 prefix[prefix_length];

  if (prefix_length != read(socket, prefix, prefix_length)) {
    return false;
  }
  google::protobuf::io::CodedInputStream::ReadLittleEndian32FromArray(prefix,
      &message_length);

  google::protobuf::uint8 buffer[message_length];
  if (message_length != read(socket, buffer, message_length)) {
    return false;
  }
  google::protobuf::io::ArrayInputStream array_input(buffer, message_length);
  google::protobuf::io::CodedInputStream coded_input(&array_input);

  if (!message->ParseFromCodedStream(&coded_input)) {
    return false;
  }

  return true;
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-25T00:09:06.507

使用 varint （例如`WriteVarint32`）而不是 fixed32 （你有`WriteLittleEndian32`）更常见，但是通过以长度为前缀来分隔 protobuf 流的做法是合理的。

# delphi - HTTP Post 文本到 SMS 服务在文本 Delphi 2007 中获得 %20

> ID：11640868
> 
> 赞同：0
> 
> 时间：2012-07-24T23:45:29.100
> 
> 标签：delphi, http, indy10

我正在使用 Indy 发布到将发送 SMS 的 SMS 服务，但 SMS 文本最终在我的手机上以 %20 而不是空格，这是代码：

```
url,text:string;
IdHTTP1: TIdHTTP;
IdSSLIOHandlerSocketOpenSSL2: TIdSSLIOHandlerSocketOpenSSL;
 begin    
    IdSSLIOHandlerSocketOpenSSL2 := TIdSSLIOHandlerSocketOpenSSL.Create;
    IdHTTP1 := TIdHTTP.Create;
    IdSSLIOHandlerSocketOpenSSL2.SSLOptions.Method := sslvSSLv23;
    IdHTTP1.IOHandler := IdSSLIOHandlerSocketOpenSSL2;
    IdHTTP1.HandleRedirects := true;
    IdHTTP1.ReadTimeout := 5000;
    param:=TStringList.create;
    param.Clear;
    param.Add('action=create');
    param.Add('token=' + SMSToken);
    param.Add('to=' + Phone);
    param.Add('msg=' + MessageText);
    url:='https://api.tropo.com/1.0/sessions';
    try
       text:=IdHTTP1.Post(url, param); 
```

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-25T00:03:18.567

的`TStrings`版本向服务器`TIdHTTP.Post()`发送`application/x-www-form-urlencoded`请求。发布的数据默认是 url 编码的。服务器在处理之前需要对发布的数据进行解码。听起来服务器端代码没有正确执行此操作。您可以`hoForceEncodeParams`从属性中删除该标志`TIdHTTP.HTTPOptions`以禁用已发布数据的 url 编码，但我建议您将错误报告给 Tropo，以便他们修复其服务器端代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-25T07:03:41.557

TIdHTTP 本身不对发布的数据应用带引号的可打印编码，因此必须事先对要发布的数据进行带引号的可打印编码。

在 Indy 10 中，您可以使用 TIdFormDataField.Charset 属性指定如何将字符串转换为字节，然后使用 TIdFormDataField.ContentTransfer 属性指定如何对字节进行编码。对于 ContentTransfer，您可以指定 '7bit'、'8bit'、'binary'、'quoted-printable'、'base64' 或空白字符串（相当于 '7bit'，但在 MIME 中没有说明标题）。

将 TIdFormDataField.CharSet 属性设置为与您的操作系统使用的字符集匹配的字符集，然后将 TIdFormDataField.ContentTransfer 属性设置为“8bit”。

或者，使用 TIdMultipartFormDataStream.AddFormField() 的 TStream 重载版本而不是 String 重载版本，然后您可以根据需要将数据存储在输入 TStream 中，并将根据 TIdFormDataField.ContentTransfer 的值按原样编码财产。这应该删除你得到的 %20 。

# android - 如何避免在 API>10 的设备中出现重复的菜单按钮

> ID：11640870
> 
> 赞同：0
> 
> 时间：2012-07-24T23:46:05.137
> 
> 标签：android, android-3.0-honeycomb, android-actionbar

如何删除或隐藏底部栏中的软菜单按钮，但仍将溢出菜单按钮保留在`ActionBar`. 我已将目标 API 设置为：

```
android:targetSdkVersion="11" 
```

正如[这里](https://stackoverflow.com/questions/5679876/how-do-i-control-the-soft-menu-button-in-honeycomb)建议的那样。

我的应用程序确实有菜单项，所以我覆盖了`onCreateOptionsMenu()`. 菜单按钮出现在右侧`ActionBar`和底部栏中。我只是不希望屏幕底部的空间被浪费在重复的菜单按钮上。我见过像 YouTube 或 Google Play 这样的应用程序，它们只有菜单按钮，`ActionBar`所以我认为应该有办法做到这一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T20:29:45.793

将目标 API 提高到 14`(android:targetSdkVersion="14")`解决了这个问题。感谢[CommonsWare](https://stackoverflow.com/users/115145/commonsware) `

# .net - DateTime 的 WebApi 序列化 - 如何反序列化？

> ID：11640875
> 
> 赞同：2
> 
> 时间：2012-07-24T23:46:43.927
> 
> 标签：.net, datetime

这段代码：

```
public class PhotoDescriptor
{
    public DateTime DateCreatedUtc { get; set; }
}

public class PhotosController : ApiController
{
    // GET api/photos
    public IEnumerable<PhotoDescriptor> GetListOfPhotos()
    {
        return new PhotoDescriptor[]
            {
                new PhotoDescriptor
                    {
                        DateCreatedUtc = DateTime.ParseExact(
                                "2012-07-24T00:28:41.8738770Z",
                                "o",
                                CultureInfo.InvariantCulture,
                                DateTimeStyles.None).ToUniversalTime(),
                    },
                new PhotoDescriptor
                    {
                        DateCreatedUtc = DateTime.ParseExact(
                                "2012-07-24T00:28:41.0000000Z",
                                "o",
                                CultureInfo.InvariantCulture,
                                DateTimeStyles.None).ToUniversalTime(),
                    },
            };
    } 
```

返回以下 JSON：

```
[{"DateCreatedUtc":"2012-07-24T00:28:41.873877Z"},
 {"DateCreatedUtc":"2012-07-24T00:28:41Z"}] 
```

**请注意，从 datetime 中删除了尾随零**。但是当我试图解析这些字符串以取回我的 DateTime 时，我得到`FormatException - String was not recognized as a valid DateTime`：

```
var date = DateTime.ParseExact("2012-07-24T00:28:41.873877Z", "o", CultureInfo.InvariantCulture, DateTimeStyles.None); 
```

这是正确的，根据 MSDN [DateTime.ParseExact Method](http://msdn.microsoft.com/en-us/library/ms131038.aspx)：

> ***格式异常***
> 
> s 不包含与 format 中指定的模式相对应的日期和时间。

格式`"o"`定义[如下](http://msdn.microsoft.com/en-us/library/az4se3k1.aspx#Roundtrip)：

> yyyy'-'MM'-'dd'T'HH':'mm':'ss'.'fffffffK

所以应该有明显的尾随零。

它是 WebApi 中的错误，还是我做错了什么？我应该如何将日期/时间字段传递给我的 .Net 客户端？

谢谢你。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-24T23:54:30.513

是的，您正在适当地解析硬编码值 - 但是您的代码没有显示它们应该如何以 JSON 格式写出。您的“应该是”声明仅与您正在*解析*的格式有关，这当然不会在其`DateTime`自身中传播。

如果您想自己解析这些值（我不得不问为什么不为您完成...）您可以使用`F`而不是`f`：

```
DateTime value = DateTime.ParseExact(text, 
                                     "yyyy'-'MM'-'dd'T'HH':'mm':'ss'.'FFFFFFFK",
                                     CultureInfo.InvariantCulture); 
```

我并不是说这*不是*WebApi 中的错误 - 但我没有从您的帖子中看到任何迹象表明它*是*WebApi 中的错误......而[Scott Hanselman 关于 WebApi 日期的帖子](http://www.hanselman.com/blog/OnTheNightmareThatIsJSONDatesPlusJSONNETAndASPNETWebAPI.aspx)给出了“刚刚下降”的示例到第二个”，暗示这是故意的。

# iphone - 在具有内存限制的多线程 iOS 应用程序中存储大量非结构化数据的最佳方法？

> ID：11640880
> 
> 赞同：0
> 
> 时间：2012-07-24T23:47:19.840
> 
> 标签：iphone, objective-c, xcode

几个月来，我在我的应用程序中遇到了这个问题。我尝试了许多自制的解决方案，并将解释我在这里工作的内容，但我希望有人能提出我错过的更好的解决方案。

基本问题是：我（可能）有数千个项目需要我的应用随时访问。NSMutableDictionary 通常是我表示每个项目的第一种方法，因为每个项目可能有几个到数百个属性。但是其余的要求使事情变得棘手：

1.  每个项目都可能被任何线程读取或写入
2.  每个项目都需要存储到磁盘，以便可以在会话之间检索
3.  （可能）有太多的项目（和太多的数据）一次将它们全部放在内存中可能会导致内存问题

我想使用 CoreData，因为 Apple 非常喜欢它，但我遇到了很多问题。每个 Item 都没有确定的结构，因此没有很好的方法来构建数据模型。此外，查询数据会导致单个 .sqlite 文件成为瓶颈，这意味着当许多线程同时尝试检索项目时，等待时间（滞后）会很快变得荒谬。

我有一个可行的解决方案，但它有问题。这是一段代码，我将在下面解释它的作用

```
- (NSObject*) getValue:(NSString*)key {
    @synchronized(self) {
        if(!_cached_obj) { // private variable in this object
            _cached_obj = [self loadFromDisk]; // simply loads the NSDictionary from a file
        }
        _last_access = time(nil);//don't release for a while
        return [_cached_obj valueForKey:key];
    }
}
- (void) setValue:(NSObject*)value forKey:(NSString*)key {
    @synchronized(self) {
        [self getValue:key];//ensures the cache is active
        [_cached_obj setValue:value forKey:key];
        _needs_save = true;
    }
}
- (void) clean {
    if(!_cached_obj)
        return;
    @synchronized(self) {
        if(_needs_save)
        {
            [self writeToFile];//writes the cache obj to a file
            _needs_save = NO;
        }

        NSTimeInterval elapsed = time(nil) - _last_access;
        if(elapsed > 20)
        {
            [_cached_obj release];
            _cached_obj = nil;
        }
    }
} 
```

*   当我需要来自某个项目的数据时，会调用 getValue 函数。它尝试使用缓存对象（NSMutableDictionary）。如果缓存的对象为 NULL，则在返回之前从磁盘加载对象
*   setValue 函数按预期工作，但也设置了保存标志
*   “清洁”功能由后台线程在 10 秒计时器上运行。这负责将项目保存到磁盘并取消缓存数据以节省内存。

我不喜欢我的方法的一点是，基于我对@synchronized 的使用，信号量有很多等待。有时，这也意味着主线程在等待磁盘读/写时被阻塞，这很痛苦。

我是否缺少更好的数据结构或存储机制？

谢谢！

* * *

编辑：更多信息：“getValue”函数返回的速度也非常重要，即使它没有阻塞主线程。例如，考虑我在后台线程上搜索 10k 个项目的场景。我需要从 10k 个对象中的每一个中获取一个值一次。使用我目前的机制，它可以工作，但是从磁盘加载每个非缓存对象非常耗时，并且最终在我的 iPhone 4 上需要大约 20 秒。我知道这可能只是“我必须付出的代价。 " 但是，也许将数据存储在更小的块中会有所帮助？例如，不要将整个项目存储为字典，而是存储为不同对象的集合。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T01:01:49.953

据我了解，您分析了您的应用程序，并且配置文件显示 @synchronize 块是最大的性能瓶颈。对？

好吧，我并不过分惊讶：正如您指出的那样，您在持有互斥锁的同时读写文件。此外，您同时只允许一个线程，而您可以轻松地允许多个读取器或一个写入器访问您的缓存。

确定的锁定操作：

*   获取值 -> 在缓存中获取值，如果不在缓存中，则在磁盘上获取值，将值放入缓存中
*   设置值 -> 在缓存中获取值，如果不在缓存中，则在磁盘上获取值，将值放入缓存中，将新值放入缓存中
*   清理 -> 保存缓存，清空缓存

那么，基本操作是：

*   在缓存中获取值
*   在磁盘上获取价值
*   将值放入缓存
*   保存缓存
*   空缓存

确定这些简单操作的并发性非常容易，然后重新设计锁以确保一切都很好地相互配合。

您可以允许多个读取器或一个写入器访问缓存。一个线程可以读取（或写入）磁盘，而无需锁定缓存。从磁盘读取的值将在稍后作为写入器设置在缓存中。所以一个用于缓存的读写锁和一个用于文件的互斥锁。设定值序列也有点令人费解。我看不到从文件中读取旧值以立即替换它的意义。如果您需要准备好缓存数据结构，只需确保它们没有触发文件操作即可。

所有这些也可以使用 GCD 来实现，避免大部分锁（如果不是全部的话）。

在不引入大量复杂性或更改应用程序线程模型的情况下，有足够的空间来减少冲突。我认为 GCD 提供了更多机会，但您必须考虑队列和操作而不是线程，这乍一看并不总是那么容易。

我不会说重做锁就足够了，您可能还必须改进数据读取和保存到磁盘的方式，但从锁开始。你可能会感到惊讶。

# unity3d - 在 Unity3d 中计算碰撞次数

> ID：11640889
> 
> 赞同：2
> 
> 时间：2012-07-24T23:48:51.417
> 
> 标签：unity3d, collision

所以，我有一个`GameObject`命名框列表，我需要计算该列表中元素的冲突`Update()`，例如：

```
void Update()
{
    int collisionNumber = boxes[0].CountCollisions;
} 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-25T02:53:41.437

您可能会为需要使用[Collider.OnCollisionEnter计算其碰撞的每种类型（框）编写一个小脚本](http://docs.unity3d.com/Documentation/ScriptReference/Collider.OnCollisionEnter.html)

```
public int countCollisions = 0;

void OnCollisionEnter(Collision hit)
{
    if (hit.gameObject.name == "Cube" )
        countCollisions++;
} 
```

将它附加到列表中的**每个多维数据集**（可能通过 AddComponent() ）并递归调用 countCollisions 的值。

```
int totalCollisions = 0;
for (int i = 0; i != boxes.Length ;++i)
{
    totalCollisions += boxes[i].countCollisions;
} 
```

# sql-server - SQL 类别树 - 类别、类别关系和产品表 - 需要每个子目录的产品总数

> ID：11640899
> 
> 赞同：0
> 
> 时间：2012-07-24T23:49:55.980
> 
> 标签：sql-server, tsql

我有一个类别表，其中包含我感兴趣的 3 个字段：

```
ID, Name, CategoryType 
```

根节点通过 CategoryType 为 1 来标识，根节点的子节点为类型 2，子子节点为类型 3。

有第二个表 CategoryRelationship，其中重要的两列是：

`CategoryID, ParentCategoryID`.

我想要的是记录列表，以便我们拥有每个类别/子类别的名称及其 ID，如下所示

```
ID RootName1 ID SubName1 ID Sub-SubName1
ID RootName1 ID SubName1 ID Sub-SubName2
ID RootName1 ID SubName2 ID Sub-SubName1
ID RootName1 ID SubName2 ID Sub-SubName2
ID RootName1 ID SubName2 ID Sub-SubName3
ID RootName2 ID SubName1 ID Sub-SubName1
ID RootName2 ID SubName2
ID RootName2 ID SubName3 
```

ID 将是每个根和节点/子节点等

我想我已经完成了这项工作-我只是想知道这是否是“正确”的执行方式，或者这是否是更好的方式。这是针对 MS SQL 2012 express db 完成的。

```
select c.id, 
       c.name, 
       c1.Name, 
       cr1.CategoryID, 
       c2.Name, 
       cr2.CategoryID 
from Category c
left outer join CategoryRelationship cr1 on cr1.CategoryParentID = c.id
left outer join CategoryRelationship cr2 on cr2.CategoryParentID = cr1.CategoryID
inner join Category c1 on c1.ID = cr1.CategoryID
inner join Category c2 on c2.id = cr2.CategoryID
where c.CategoryTypeID = 1
order by c.name, c1.name, c2.name 
```

还有一点我需要一点帮助。第三张桌子里面有产品。每个产品都有一个与上面的 cr2.CategoryID 匹配的 SubCateoryID。我想在 Product 表中显示每个 cr2 类别的项目总数，并且我仍然想包括在 product 表中没有项目的任何类别。我不确定如何做最后一部分。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T00:25:03.963

我想我有这个：

```
select c.ID, c.Name, c1.Name, cr1.CategoryID, c2.Name, cr2.CategoryID, 
(select count(*) from Product where product.SubcategoryID = cr2.CategoryID and Deleted = 0 and StatusID = 1) 
from Category c
left outer join CategoryRelationship cr1 on cr1.CategoryParentID = c.id
left outer join CategoryRelationship cr2 on cr2.CategoryParentID = cr1.CategoryID
inner join Category c1 on c1.ID = cr1.CategoryID
inner join Category c2 on c2.id = cr2.CategoryID
where c.CategoryTypeID = 1
order by c.name, c1.name, c2.name 
```

# python - 递增的浮点数彼此不相等

> ID：11640902
> 
> 赞同：5
> 
> 时间：2012-07-24T23:50:07.333
> 
> 标签：python, if-statement, floating-point, comparison

> **可能重复：**
> [为什么十进制数不能用二进制精确表示？](https://stackoverflow.com/questions/1089018/why-cant-decimal-numbers-be-represented-exactly-in-binary)
> [程序没有进入 if 语句](https://stackoverflow.com/questions/7586221/program-not-entering-if-statement)

所以我试图运行一个有两个变量的程序，当一个变量等于另一个变量时，它会执行一个函数。在这种情况下，打印垃圾邮件。但是，由于某种原因，当我运行这个程序时，即使我知道它们是相等的，我也没有得到任何输出。

```
g=0.0
b=3.0

while g < 30.0:
    if g==b:
        print "Hi"
    g+=.1
    print g, b 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-24T23:51:16.580

您假设在 0.0 中添加足够的 0.1 次将产生 3.0。这些是浮点数，它们不准确。舍入误差使得该值永远不会完全等于 3.0。你几乎不应该用它`==`来测试浮点数。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-25T00:20:38.643

做到这一点的一个好方法是使用整数值进行计数（例如，用 i 从 0 到 300 循环 1）并仅在使用浮点值时缩放计数器（例如，设置 f = i * .1）。当你这样做时，循环计数器总是精确的，所以你得到了你想要的迭代，并且只有一个浮点舍入，它不会在迭代之间累积。

循环计数器最常见的是整数类型，因此很容易看出加法是准确的（直到达到溢出）。但是，循环计数器也可以是浮点类型，前提是您确定它的值和操作是准确的。（常见的 32 位浮点格式精确地表示从 -2 ^(24)到 +2 ^(24)的整数。除此之外，它没有精确地表示整数的精度。它不能精确地表示 .1，所以你不能用增量来计数0.1\. 但是你可以用 0.5、0.25、0.375 的增量或其他 2 的中等幂的小倍数来计算，这些都是精确表示的。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-25T00:28:36.047

为了扩展 Karoly Horvath 的评论，您可以做些什么来测试近似相等是选择一个相对于最小增量非常非常小的值（我们称之为 epsilon）。假设 epsilon 是 1.0 * 10^-6，比您的增量小五个数量级。（它可能应该基于浮点表示的平均舍入误差，但这会有所不同，这只是一个示例）。

然后你要做的是检查 g 和 b 是否小于 epsilon 不同 - 如果它们足够接近以至于它们实际上相等，那么实际上和实际之间的差异是舍入误差，你用 epsilon 来近似。

检查

```
abs(g - b) < epsilon 
```

并且您将进行几乎但不完全相等的检查，这对于大多数用途来说应该已经足够了。

# html - 使表格大小与 div 相同

> ID：11640903
> 
> 赞同：0
> 
> 时间：2012-07-24T23:50:08.653
> 
> 标签：html, css, html-table, position, overlap

这对我来说很难问。简而言之：我的 div 重叠（超出表格）。我希望根据 div 调整表格的大小。

当我尝试添加页脚时，内容会重叠。这是代码：

这是页面：[页面](http://www.turdidesigns.com/bin/ebay/hdauto/shop.html)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T00:47:46.533

`.middle`css 类将中心内容的高度设置为。`25px`因此，页脚的位置与左侧的菜单表内容相关。如果您`25px`从 css 类中删除 div 应该可以按预期工作

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-25T00:48:11.547

好的，我建议您重写您的网站，因为它完全一团糟，请使用我的模板作为初学者：

```
<div class="wrap">
<div class="header"></div>
<div class="body">
    <div class="left-side"></div>
    <div class="center"></div>
    <div class="right-side"></div>
</div>
<div class="footer"></div>
</div>​ 
```

和CSS：

```
.wrap{
    width: 400px;
    height: 500px;
    margin: 0 auto;
}
.header{
    width: 100%;
    height: 50px;
    background-color: #dddddd;
}
.body{
    width: 100%;
    height: 350px;
}
.left-side{
    position: relative;
    float: left;
    width: 20%;
    height: 100%;
    background-color: #eeeeee;
}
.center{
    position: relative;
    float: left;
    width: 60%;
    height: 100%;
    background-color: #cccccc;
}
.right-side{
    position: relative;
    float: left;
    width: 20%;
    height: 100%;
    background-color: #eeeeee;
}
.footer{
    width: 100%;
    height: 100px;
    background-color: #dddddd;
}
​ 
```

这是[jsFiddle中的实时示例](http://jsfiddle.net/mdjmc/10/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-25T08:30:26.150

好吧，@Arturas .. 我有点同意 @skmasq 为你的网站。我认为如果您不使用`table`布局会更好。但是，如果仍然想使用您当前的网站源代码，请尝试删除`.middle`' 高度属性。因为您将其设置为固定 25px，但内容超载，这就是它重叠的原因。

# java - java.lang.ArrayOutOfBounds 写入文件时出现异常

> ID：11640904
> 
> 赞同：0
> 
> 时间：2012-07-24T23:50:23.093
> 
> 标签：java, io, indexoutofboundsexception

我创建了一个写入文件的方法，如下面的代码所示。使用两个给定参数，从另一个方法调用此方法 1000 次。

然而，在其中 5 次调用中，此方法捕获错误“e”并打印出：java.lang.ArrayIndexOutOfBoundsException，在我的终端中，我得到 System.out.println(""+(double)C/T) 的结果，但在文件中，这个结果丢失了。（其他电话工作正常）

一开始我真的很困惑，因为我根本不使用数组。谷歌搜索了一下后，我发现了这个：[http ://www-01.ibm.com/support/docview.wss?uid=swg1IZ87600](http://www-01.ibm.com/support/docview.wss?uid=swg1IZ87600)

我仍然很困惑，不知道如何解决这个问题。有人帮忙吗？

```
public void myMethod(int C, int T) {   
    try {
      FileOutputStream fout = new FileOutputStream ("output.txt", true );
      PrintStream ps = new PrintStream(fout);    
      System.out.println(""+(double)C/T);
      ps.println((double)C/T+"");
      // close file
      fout.close();
    }
    catch(Exception e) {
        System.err.println(e);
    }   
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T00:01:56.043

在我的 Windows JVM 上完美地为我工作：

```
package cruft;

import java.io.FileOutputStream;
import java.io.PrintStream;

/**
 * ArrayIndexOutOfBoundsProblem
 * @author Michael
 * @link http://stackoverflow.com/questions/11640904/java-lang-arrayoutofbounds-exception-when-writing-to-a-file
 * @since 7/24/12 7:58 PM
 */
public class ArrayIndexOutOfBoundsProblem {

    public static void main(String[] args) {
        ArrayIndexOutOfBoundsProblem aioob = new ArrayIndexOutOfBoundsProblem();

        int c = ((args.length > 0) ? Integer.valueOf(args[0]) : 10);
        int t = ((args.length > 1) ? Integer.valueOf(args[1]) : 2);
        aioob.myMethod(c, t);
    }

    public void myMethod(int C, int T){
        try{
            FileOutputStream fout = new FileOutputStream("output.txt", true );
            PrintStream ps = new PrintStream(fout);
            System.out.println(""+(double)C/T);
            ps.println((double)C/T+"");
            // close file
            fout.close();
        }
        catch(Exception e)
        {
            System.err.println(e);
        }
    }
} 
```

我会这样写：符合 Java 编码标准并使用更清晰的名称：

```
package cruft;

import java.io.*;

/**
 * ArrayIndexOutOfBoundsProblem
 * @author Michael
 * @link http://stackoverflow.com/questions/11640904/java-lang-arrayoutofbounds-exception-when-writing-to-a-file
 * @since 7/24/12 7:58 PM
 */
public class ArrayIndexOutOfBoundsProblem {

    public static void main(String[] args) {
        ArrayIndexOutOfBoundsProblem aioob = new ArrayIndexOutOfBoundsProblem();

        int c = ((args.length > 0) ? Integer.valueOf(args[0]) : 10);
        int t = ((args.length > 1) ? Integer.valueOf(args[1]) : 2);
        aioob.printValues(c, t);
    }

    public void printValues(int c, int t){
        printValues(System.out, c, t);
    }

    public void printValues(String outputFilePath, int c, int t) {
        FileOutputStream fos = null;
        try {
            fos = new FileOutputStream(outputFilePath);
            PrintStream ps = new PrintStream(fos);
            printValues(ps, c, t);
        } catch (FileNotFoundException e) {
            e.printStackTrace();
        } finally {
            close(fos);
        }
    }

    public void printValues(PrintStream ps, int c, int t) {
        ps.println(String.format("c: %10d t: %10d ratio c/t: %10.4f", c, t, (double) c/t));
    }

    public static void close(OutputStream os) {
        if (os != null) {
            try {
                os.close();
            } catch (IOException e) {
                e.printStackTrace();
            }
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-25T00:07:59.037

在一个紧密的循环中打开和关闭一个文件 1000 次对我来说听起来很可疑，所以我建议您首先在循环外初始化 FileOutputStream，如下所示：

```
 private void myMethod() {

    PrintStream fos = null;

    try {
      fos = new PrintStream(new FileOutputStream("output.txt", true));

      for (int i = 0; i < 1000; i++) {
        // Calculate these appropriately...
        int c = 0;
        int t = 0;
        fos.println((double) c / t);
      }

    }
    catch (IOException e) {
      e.printStackTrace();
    }
    finally {
      if (fos != null) {
        fos.close();
      }
    }
  } 
```

如果这不起作用，请尝试使用 FileWriter 而不是 FileOutputStream，因为它可能会解决您的 VM 错误。

# java - 触发 valueChanged 事件后从 JTable 中删除行

> ID：11640905
> 
> 赞同：3
> 
> 时间：2012-07-24T23:50:24.927
> 
> 标签：java, swing, jtable, listselectionlistener

我正在使用 ListSelectionListener`JTextField`从所选行更新我的 (countryTxt)。

```
import java.awt.BorderLayout;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JScrollPane;
import javax.swing.JTable;
import javax.swing.JTextField;
import javax.swing.SwingUtilities;
import javax.swing.event.ListSelectionEvent;
import javax.swing.event.ListSelectionListener;
import javax.swing.table.DefaultTableModel;

public class App {

    JFrame frame = new JFrame();
    JTable table = new JTable();
    DefaultTableModel model = new DefaultTableModel(new Object[][] {},
            new String[] { "Country", "City", "Street" });
    JButton button = new JButton("Remove");
    JTextField countryTxt = new JTextField();

    int row;

    public App() {
        table.setModel(model);
        data();
        table.getSelectionModel().addListSelectionListener(
                new ListSelectionListener() {
                    @Override
                    public void valueChanged(ListSelectionEvent e) {
                        if (!e.getValueIsAdjusting()) {
                            row = table.getSelectedRow();
                            countryTxt.setText((String) model
                                    .getValueAt(row, 0));
                        }
                    }
                });
        button.addActionListener(new ActionListener() {
            @Override
            public void actionPerformed(ActionEvent arg0) {
                model.removeRow(row);
            }
        });
        frame.add(countryTxt,BorderLayout.NORTH);
        frame.add(new JScrollPane(table), BorderLayout.CENTER);
        frame.add(button, BorderLayout.SOUTH);
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.pack();
        frame.setVisible(true);
        frame.setLocationRelativeTo(null);
    }

    public void data() {
        model.addRow(new String[] { "USA", "New York", "First street" });
        model.addRow(new String[] { "Russia", "Moscow", "Second street" });
        model.addRow(new String[] { "Japan", "Osaka", "Osaka street" });
    }

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {
            public void run() {
                new App();
            }
        });
    }
} 
```

但是，当我选择一行并单击 a`button`时，它会出现`ArrayIndexOutOfBounds`异常。当我没有在表中选择一行并单击`button`一切正常时。`valueChanged`显然，我可以在未触发事件时删除一行。所以我的问题是：如何在`valueChanged`事件触发后删除一行。提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-25T02:53:36.930

几点观察：

*   通过键盘或鼠标选择行会`countryTxt`正确更新字段。

*   您可以使用`Control>`-`Tab`跳出表格并返回到您的`panel`.

*   不要使用`setBounds()`; 使用`pack()`.

*   我在没有 的情况下测试了您的示例`MigLayout`，但我认为这与您的发现无关。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-25T06:07:49.140

`getLeadSelectionIndex()`看一下方法的javadoc

> 返回最近调用 setSelectionInterval()、addSelectionInterval() 或 removeSelectionInterval() 的第二个索引参数

这不是你所期望的。您最好使用`JTable#getSelectedRow()`which 当然仍然需要您检查它是否与 -1 不同。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-18T08:32:57.183

不久前，我不得不追查一个涉及列表删除的类似问题。这里的主要问题是按钮侦听器的调用`model.removeRow(row)`正在向模型的选择侦听器发送一个`valueChanged`事件，然后它将尝试使用不存在的选择（即 的列表索引`-1`）来更新文本字段。我已经对您的代码进行了这些修复，并且相关部分标有注释。此代码允许在不引发异常的情况下选择/删除项目。

```
import java.awt.BorderLayout;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JScrollPane;
import javax.swing.JTable;
import javax.swing.JTextField;
import javax.swing.SwingUtilities;
import javax.swing.event.ListSelectionEvent;
import javax.swing.event.ListSelectionListener;
import javax.swing.table.DefaultTableModel;

public class App {
    JFrame frame = new JFrame();
    DefaultTableModel model = new DefaultTableModel(new Object[][] {},
            new String[] { "Country", "City", "Street" });
    JTable table = new JTable(model);
    JButton button = new JButton("Remove");
    JTextField countryTxt = new JTextField();

    public App() {
        data();
        table.getSelectionModel().addListSelectionListener(
                new ListSelectionListener() {
                    @Override
                    public void valueChanged(ListSelectionEvent e) {
                        if (!e.getValueIsAdjusting()) {
                            // get the current selected row
                            int i = table.getSelectedRow();
                            // if there is a selected row, update the text field
                            if(i >= 0) {
                               countryTxt.setText((String) model
                                    .getValueAt(i, 0));
                            }
                        }
                    }
                });
        button.addActionListener(new ActionListener() {
            @Override
            public void actionPerformed(ActionEvent arg0) {
                // get the current selected row
                int i = table.getSelectedRow();
                // if there's no selection, but there are some rows,
                // we'll just delete the first row
                if(i < 0 && model.getRowCount() > 0) {
                   i = 0;
                }

                // if we have a valid row to delete, do the deletion
                if(i >= 0) {
                    countryTxt.setText("");
                    model.removeRow(i);
                    table.revalidate();
                }
            }
        });
        frame.add(countryTxt,BorderLayout.NORTH);
        frame.add(new JScrollPane(table), BorderLayout.CENTER);
        frame.add(button, BorderLayout.SOUTH);
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.pack();
        frame.setVisible(true);
        frame.setLocationRelativeTo(null);
    }

    public void data() {
        model.addRow(new String[] { "USA", "New York", "First street" });
        model.addRow(new String[] { "Russia", "Moscow", "Second street" });
        model.addRow(new String[] { "Japan", "Osaka", "Osaka street" });
    }

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {
            public void run() {
                new App();
            }
        });
    }
} 
```

# java - 使用 openssl 命令行的 Java SHA1WithRSA

> ID：11640906
> 
> 赞同：4
> 
> 时间：2012-07-24T23:50:36.397
> 
> 标签：java, openssl, rsa, digital-signature, sha1

我有以下一段 Java 代码，我想使用 openssl 命令行工具将其转换为 shell 脚本：

```
java.security.Signature sig = java.security.Signature.getInstance("SHA1WithRSA");
sig.initSign(privateKey);
sig.update(data);
byte[] signatureBytes = sig.sign(); 
```

到目前为止，我已经尝试了以下方法：

```
openssl dgst -sha1 -binary < data.der > data.hash
openssl rsautl -sign -inkey private.key -keyform pem -in data.hash -out data.rsa 
```

但是，它不会产生相同的输出。我想这可能与格式或填充等有关。我需要做什么来更正 openssl 脚本？

上面的两个代码都产生了可重复的结果，但是 java 和 openssl shell 脚本的结果不同。

所有建议表示赞赏。

亲切的问候 Jens

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-25T17:27:29.503

其实我自己终于找到了答案。

以下 openssl 命令将执行 SHA1WithRSA 并生成与 Java 代码相同的结果：

```
openssl sha1 -sign private.key -out data.rsa data.der 
```

就这么简单，但在网上很难找到

# python - Python 包装脚本，可让程序在没有阻塞的情况下远程执行

> ID：11640910
> 
> 赞同：1
> 
> 时间：2012-07-24T23:51:03.133
> 
> 标签：python, fork

我正在寻找一个包装脚本来运行一个由 SSH 命令远​​程调用的程序，该命令无需等待程序的结果就终止。

这是我的代码：

```
#!/usr/bin/python

import sys
import os, subprocess

def main():
   print "PID_last_child", os.getpid()
   argpass = ['main_p.py']
   for a in sys.argv:
        if a.find("wrapper.py") == -1: 
            argpass.append(a)
   pid = subprocess.Popen(argpass).pid
   print "PID for the actual process: ", pid

if __name__ == "__main__":

  print "PID_MAIN:", os.getpid()

  try: 
         pid = os.fork() 
         print "FORK1: ", pid 
         if pid > 0: 
               sys.exit(0)
   except OSError, e:  
         print >>sys.stderr, "fork failed: %d (%s)" % (e.errno, e.strerror)
         sys.exit(1)

   os.chdir('/') 
   os.setsid()
   os.umask(0) 

   try:
         pid = os.fork() 
         print "FORK2: ", pid 
         if pid > 0: 
                sys.exit(0)
   except OSError, e:  
         print >>sys.stderr, "fork failed: %d (%s)" % (e.errno, e.strerror)
         sys.exit(1)

   main() 
```

我想使用双叉，我应该能够做到这一点......但到目前为止还没有运气。

非常感谢您对此的任何想法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T00:52:48.240

我完全相信这个链接在 bash 语法中的答案：[如何使用 ssh 命令启动进程作为守护进程？](http://www.unix.com/shell-programming-scripting/70523-how-starting-process-daemon-using-ssh-command.html)

你甚至不需要双叉。问题是标准输出仍然连接。这是python方法：

**包装器.py**

```
import subprocess
import os

def main():
    pid = subprocess.Popen(['nohup', '/path/to/main_p.py'], 
                            stdout = open(os.devnull, 'w+', 0),
                            stderr = subprocess.STDOUT
                            ).pid
    print pid

if __name__ == "__main__":

    main() 
```

然后 ssh 命令会调用这个包装器：

```
ssh server /path/to/wrapper.py 
```

您只需要重定向 stdout -> devull，该过程将立即返回。

# seo - 谷歌分析模拟账户

> ID：11640914
> 
> 赞同：3
> 
> 时间：2012-07-24T23:51:30.980
> 
> 标签：seo, google-analytics, web-analytics

我热衷于了解更多关于 Google Analytics 的信息，但我可以访问的帐户仅实现了 70% 的功能。

是否有可用于探索所有 GA 功能的 google 演示/测试帐户（免费服务）？

提前感谢您的任何反馈！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T08:43:12.153

没有任何官方的 Analytics 模拟账户。但是谷歌分析是免费的，所以创建一个帐户并使用它或/和学习教程！

[Google Analytics IQ 课程](http://www.google.com/intl/en/analytics/iq.html) [Google Analytics 产品导览](http://www.google.com/analytics/features/tour.html)

# ruby - 用变量名在模块中定义类方法

> ID：11640917
> 
> 赞同：1
> 
> 时间：2012-07-24T23:51:38.187
> 
> 标签：ruby, module, mixins, class-method

我创建了一个包含在类中的模块。在模块中，我试图定义一个方法，它是没有过滤器的类名的小写版本。所以 ShowFilter 会有一个名为 show 的方法，它返回类 Show。我得到**“NoMethodError：ShowFilter:Class 的未定义方法‘show’”**

```
module Filters

  module Base

    module ClassMethods

      @@filters = {}

      def filter name, &block
        @@filters[name] = block
      end

      def run query = {}
        query.each do |name, value|
          @@filters[name.to_sym].call(value) unless @@filters[name.to_sym].nil?
        end
        self
      end

      def self.extended(base)
        name = base.class.name.gsub(/filter/i, '')
        define_method(name.downcase.to_sym) { Kernel.const_get name }
      end

    end

    def self.included base
      base.extend ClassMethods
    end

  end

end

class ShowFilter
    include Filters::Base

    filter :name do |name|
        self.show.where(:name => name)
    end

end 
```

**编辑：使用示例**

```
class ShowController < ApplicationController
  def index
    ShowFilter.run params[:query]
  end
end 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-25T00:17:13.237

当您定义`Filters::Base::ClassMethods`时，它会在该上下文中评估 self ，因此您最终定义的方法是`ClassMethods.classmethods`（因为 gsub 不会做任何事情）。

就像您在 Base 中使用的包含挂钩一样，您希望在 ClassMethods 中使用扩展：

```
module Filters
  module Base
    module ClassMethods

      @@filters = {}

      def filter name, &block
        @@filters[name] = block 
      end 

      def run query = {} 
        query.each do |name, value| 
          @@filters[name.to_sym].call(value) unless @@filters[name.to_sym].nil? 
        end 
        Object.const_get(self.to_s.gsub('Filter', '')) 
      end 

      def self.extended(base) 
        define_method(base.to_s.downcase.gsub('filter', '').to_sym) do 
          Object.const_get(self.to_s.gsub('Filter', '')) 
        end 
      end 
    end 

    def self.included base 
      base.extend ClassMethods 
    end 
  end 
end
class ShowFilter 
  include Filters::Base 

  filter :title do |title| 
    self.show.where(:title => title) 
  end 
end 
```

# jquery - 动态改变图像的来源 - jQuery

> ID：11640919
> 
> 赞同：0
> 
> 时间：2012-07-24T23:51:47.733
> 
> 标签：jquery

我得到以下代码：

**HTML**

```
<div class="image">
    <img src="http://ecx.images-amazon.com/images/I/41ghiuvjdvL._SL75_SS50_.jpg" />
</div>

<br />

<div class="photo">
    <img src="http://profile.ak.fbcdn.net/hprofile-ak-ash2/27520_119569768054263_2432_q.jpg" />
</div>​ 
```

**JS**

```
// getting src of bottom image
var bottomSrc = $(".photo img").find("src");

// getting src of top image
var topSrc = $(".image img").find("src");

$(".photo").click(function() {
    // changing sources
    // topSrc.attr("src", bottomSrc);
    // topSrc.replaceWith(bottomSrc);
    topSrc.replace(bottomSrc);
})​ 
```

[小提琴](http://jsfiddle.net/LyMZd/1)

单击底部图像时，我希望将`src`顶部图像的 替换为底部图像的`src`，以便两个图像相同。

为什么提供的代码不起作用？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-24T23:54:10.230

试试这个：

```
$(".photo").click(function() {
    var src=$(this).children("img").attr("src");
    $(".image img").attr("src",src);
})​; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T23:55:50.760

[试试这个](http://jsfiddle.net/LyMZd/2/)

您需要使用 jQuery 中的 attr() 函数获取和设置 src 属性

# xcode - 关闭视图控制器时调用函数（xcode/iOS）

> ID：11640927
> 
> 赞同：0
> 
> 时间：2012-07-24T23:52:56.033
> 
> 标签：xcode

我有一个主视图控制器。当按下特定按钮时，我会呈现另一个视图控制器。当第二个视图控制器被关闭时，我想在主视图控制器中调用一个函数。最初我以为我可以只使用 presentviewcontroller 的完成处理程序，但现在我认为这不是要走的路。关于如何做到这一点的任何提示？我对此很陌生，所以任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T00:03:14.267

假设您的主视图控制器是第二个视图控制器的父级，您可以使用以下方法访问该方法：

```
[[secondViewController parentViewController] method]; 
```

请注意——如果您使用的是导航控制器，则父视图控制器将是导航控制器。在这种情况下，您将不得不查询导航控制器的堆栈。

祝你好运！

# overlay - Opera 扩展中的覆盖

> ID：11640932
> 
> 赞同：0
> 
> 时间：2012-07-24T23:53:39.140
> 
> 标签：overlay, opera, opera-extension

我是歌剧扩展开发的初学者。

歌剧中的firefox xul覆盖是否有等价物？

当我将鼠标悬停在文本上时，我想创建临时覆盖。当鼠标离开文本时，覆盖应该改变或消失。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T02:15:17.083

要与特定页面交互，您需要使用注入脚本。这是一个 JavaScript 文件（实际上是 UserScript/UserJS），位于名为`includes`.

在此文件中，您可以为纯 CSS 工具提示添加代码，例如在此处找到的代码：[http://sixrevisions.com/css/css-only-tooltips/](http://sixrevisions.com/css/css-only-tooltips/)，然后将 CSS 附加到页面中的样式元素。

这个例子应该给你一些可以建立的东西：

```
// includes/injected.js
window.addEventListener('DOMContentLoaded', function() {
    // Set the CSS for the tooltip
    var tooltipCSS = '.tooltip {position: relative;}.tooltip span {margin-left: -999em; position: absolute;} .tooltip:hover span {border-radius: 5px 5px; -moz-border-radius: 5px; -webkit-border-radius: 5px; box-shadow: 5px 5px 5px rgba(0, 0, 0, 0.1); -webkit-box-shadow: 5px 5px rgba(0, 0, 0, 0.1); -moz-box-shadow: 5px 5px rgba(0, 0, 0, 0.1); position: absolute; left: 1em; top: 2em; z-index: 99; margin-left: 0; width: 250px;} .classic {padding: 0.8em 1em;} * html a:hover {background: transparent;} .classic {background: #FFFFAA; border: 1px solid #FFAD33; color: #333333;}';

    // Set the text for the tooltip
    var tooltipText = 'This is a tooltip';

    // Add the CSS to the page
    var style = document.createElement('style');
    style.textContent = tooltipCSS;
    document.head.appendChild(style);

    // Loop through all links to add "tooltip" class and extra <span>
    var links = document.getElementsByTagName('a');
    for (var i = 0, len = links.length; i < len; i++) {
        links[i].classList.add('tooltip');
        links[i].innerHTML += '<span class="classic">' + tooltipText + '</span>';
    }
}, false); 
```

# php - 搜索mysql数据库 - php

> ID：11640933
> 
> 赞同：1
> 
> 时间：2012-07-24T23:53:49.247
> 
> 标签：php, search

我正在尝试修改搜索路由，我有两个字段，艺术家和标题，当我搜索伪装者 Foo Fighters 时，我没有得到任何结果，而如果我单独搜索，我会得到。任何帮助将不胜感激谢谢。

```
 $arraySearch = explode(" ", $searchvalue);
  $arrayFields = array(0 => "Artist", 1 => "Title");
  $countSearch = count($arraySearch);
  $a = 0;
  $b = 0;
  $query = "SELECT * FROM ".$table." WHERE (";
  $countFields = count($arrayFields);
  while ($a < $countFields)
  {
    while ($b < $countSearch)
    {
      $query = $query."$arrayFields[$a] LIKE '%$arraySearch[$b]%'";
      $b++;
      if ($b < $countSearch)
      {
        $query = $query." AND ";
      }
    }
    $b = 0;
    $a++;
    if ($a < $countFields)
    {
      $query = $query.") OR (";
    }
  }
  $query = $query.")";
  $query_result = mysql_query($query);
  echo '<h1>Your Search Results</h1>'."\n\n";
  if(mysql_num_rows($query_result) < 1)
  {
    echo '<p>No matches found for "'.$searchvalue.'"</p>';
  }
  else
  {
    echo '<p>Search Results for "'.$searchvalue.'":</p>'."\n\n";
    while($row = mysql_fetch_assoc($query_result))
    {
      // output

    }
  } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-25T00:07:19.947

这个搜索功能非常低效。由于您正在搜索通配符`%blah%`，因此必须进行全表扫描才能找到任何记录。也就是说，如果您有 100 万条记录，它必须读取所有 100 万条记录才能找到您的搜索结果。在具有大表的繁忙站点上，这可能会破坏您的性能和数据库服务器。

如果您对表使用 MyISAM 引擎，我建议将[FULLTEXT](http://dev.mysql.com/doc/refman/5.0/en/fulltext-search.html)索引添加到艺术家和标题列，然后执行如下全文搜索：

```
SELECT * FROM `table` WHERE
MATCH(`artist`, `title`)
AGAINST('foo fighters the pretender'); 
```

正如 OP 所写，这是一个按搜索查询的匹配相关性排序的查询

```
$search = $db->escape('foo fighters the pretender');

$query = "SELECT *,
          MATCH(Artist, Title) AGAINST('$search' IN BOOLEAN MODE) AS relevance
          FROM table
          WHERE
            MATCH (Artist, Title)
            AGAINST('$search' IN BOOLEAN MODE)
          ORDER BY relevance DESC"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-25T00:00:19.920

改变这个：

```
$query = $query." AND "; 
```

对此：

```
$query = $query." OR "; 
```

本质上你是在说`SELECT... WHERE (field1 like 'foo%' AND field1 like 'bar%')`。除非它们是完全相同的单词，否则您永远不会找到 field1 与两个单词相似的行。就像说`SELECT ... WHERE id=1 AND id=2`，不会拉任何结果，而`SELECT ... WHERE id=1 OR id=2`将拉第 1 行和第 2 行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-25T00:08:06.140

关闭查询的括号后，放置一个 var_dump($query) 以便您了解发生了什么。

例如：以下代码输出： string(123) "SELECT * FROM WHERE (Artist LIKE '%foo%' AND Artist LIKE '%fighters%') OR (Title LIKE '%foo%' AND Title LIKE '%fighters%' )"

```
<?php

$searchvalue = 'foo fighters';

$arraySearch = explode(" ", $searchvalue);
  $arrayFields = array(0 => "Artist", 1 => "Title");
  $countSearch = count($arraySearch);
  $a = 0;
  $b = 0;
  $query = "SELECT * FROM ".$table." WHERE (";
  $countFields = count($arrayFields);
  while ($a < $countFields)
  {
    while ($b < $countSearch)
    {
      $query = $query."$arrayFields[$a] LIKE '%$arraySearch[$b]%'";
      $b++;
      if ($b < $countSearch)
      {
        $query = $query." AND ";
      }
    }
    $b = 0;
    $a++;
    if ($a < $countFields)
    {
      $query = $query.") OR (";
    }
  }
  $query = $query.")";

  var_dump($query);
?> 
```

# android - 如何使用android ndk访问相机

> ID：11640935
> 
> 赞同：10
> 
> 时间：2012-07-24T23:54:07.220
> 
> 标签：android, c++, android-ndk, android-camera

android-NDK 是否支持直接摄像头访问？我的 NDK 文件夹中没有 Camera.h。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-25T00:41:58.373

您可能需要某种[JNI](http://en.wikipedia.org/wiki/Java_Native_Interface)操作...这是一个 SO Post 似乎解决了这个问题：[用 android ndk - camera api 拍照](https://stackoverflow.com/questions/7297577/take-a-picture-with-android-ndk-camera-api)

# wordpress - wp_list_categories 模拟偏移量

> ID：11640937
> 
> 赞同：0
> 
> 时间：2012-07-24T23:54:14.757
> 
> 标签：wordpress, wp-list-categories

据我所知，wp_list_categories（WordPress）中没有用于偏移的参数。

我要做的就是列出父类别的子类别；并且总是从第三个孩子开始。

有谁知道我该怎么做？

谢谢 -

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T01:37:23.400

这应该可以帮助您入门。只需将 $parent_cat_ID 设置为您要定位的任何类别 ID：

```
<ul id="category_list">
<?php
$categories = get_categories(array('child_of'=>$parent_cat_ID, 'hide_empty'=>0));
for($i=2;$i<count($categories);$i++)
    echo '<li class="category_item">'.$categories[$i]->cat_name.'</li>';
?>
</ul> 
```

# python - WXPython：填充列表框的问题

> ID：11640938
> 
> 赞同：1
> 
> 时间：2012-07-24T23:54:18.203
> 
> 标签：python, python-3.x, wxpython

我正在尝试使用以下代码从 python 列表中填充列表框：

```
import wx
class ListBoxFrame(wx.Frame):
def __init__(self):
    wx.Frame.__init__(self, None, -1, 'List Box Example',  size=(500, 500))
    panel = wx.Panel(self, -1)

    btn1 = wx.Button(self, 1, 'List Items', (300, 130))
    btn1.Bind(wx.EVT_BUTTON, self.ListItems)

    listBox1 = wx.ListBox(choices=[], name='listBox1', parent=self, pos=wx.Point(8,          48), size=wx.Size(184, 256), style=0)

def ListItems(self, event):
    sampleList = ['zero', 'one', 'two', 'three', 'four', 'five','six', 'seven', 'eight', 'nine', 'ten', 'eleven','twelve', 'thirteen', 'fourteen']
    for item in sampleList:
        self.listBox1.Insert(0,item) 
```

但我遇到以下错误： **AttributeError：'ListBoxFrame'对象没有属性'listBox1'** 你能告诉我我做错了什么吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T23:56:41.150

您的这一行`__init__`：

```
listBox1 = wx.ListBox(..etc..) 
```

应该：

```
self.listBox1 = wx.ListBox(..etc..) 
```

Python 中的所有实例访问都通过`self.`.

# php - Symfony2 Undefined Index Parent 渲染表单时

> ID：11640941
> 
> 赞同：0
> 
> 时间：2012-07-24T23:54:48.543
> 
> 标签：php, doctrine, twig, symfony-2.1

**Symfony 2.1 Beta 4**

当我在我的 twig 模板中渲染我的表单时，如果我尝试使用 form_widget 或 form_rest，我将收到此错误 - “在渲染模板期间引发了异常（“注意：未定义索引：MySite/vendor 中的父级/symfony/symfony/src/Symfony/Component/Form/FormView.php 第 308 行“）。” 我可以使用 form_row 手动构建表单并更新属性，但不包括 csrf 令牌。

**编辑 7/27** 看起来当我只包含 PropertyType 表单类时，form_rest 工作正常。包含 AddressType 后，我会收到上述错误。

我正在使用地址实体的嵌入形式呈现一个属性（即房屋）实体。

```
public function showAction( $property_id )
{
    $em = $this->getDoctrine()->getEntityManager();
    $property = $em->getRepository('MySystemBundle:Property')->find( $property_id );

    if( !$property ){
        throw $this->createNotFoundException('The requested property does not exist.');
    }       

    $form = $this->createForm(new PropertyType(), $property);

    $request = $this->get('request');

    if( $request->getMethod() == 'POST' ){
        $form->bind($request);

        if( $form->isValid() ){
            $em->persist($property);
            $em->flush();

            $this->get('session')->setFlash('notice', 'Your changes were saved!');
            return $this->redirect($this->generateUrl('system_propertyShow', 
                array('property_id' => $property_id)));
        }
    }

    $vars['property'] = $property;
    $vars['form'] = $form->createView();

    return $this->render('MySystemBundle:Property:show.html.twig', $vars);
} 
```

我的 PropertyType 表单类：

```
use Symfony\Component\Form\AbstractType;
use Symfony\Component\Form\FormBuilderInterface;

class PropertyType extends AbstractType
{
public function buildForm(FormBuilderInterface $builder, array $options) {
    $builder->add('purchaseAmount', 'text', array('label' => 'Purchase Amount', 'required' => false))
        ->add('depositAmount', 'text', array('label' => 'Deposit Amount', 'required' => false))
        ->add('additionalCostsAmount', 'text', array('label' => 'Additional Costs', 'required' => false))
        ->add('balanceAmount', 'text', array('label' => 'Balance', 'required' => false))
        ->add('dateBalanceDue', 'datetime', array('label' => 'Balance Due', 'widget' => 'single_text', 'required' => false))
        ->add('squareFootage', 'number', array('label' => 'Square Footage', 'required' => false))
        ->add('isOccupied', 'choice', array(
            'label' => 'Is Occupied?',
            'choices' => array('1' => 'Yes', '0' => 'No'),
            'required' => false))
        ->add('address', new AddressType());
}

public function getDefaultOptions(array $options)
{
    return array('data_class' => 'MySite\Bundle\SystemBundle\Entity\Property');
}

public function getName()
{
    return 'property';
}
} 
```

编辑 7/27：这是我的 AddressType 类：

```
use Symfony\Component\Form\AbstractType;
use Symfony\Component\Form\FormBuilderInterface;

class AddressType extends AbstractType
{
public function buildForm(FormBuilderInterface $builder, array $options)
{
    $builder->add('line1', 'text', array('label' => 'Line 1'))
        ->add('line2', 'text', array('label' => 'Line 2', 'required' => false))
        ->add('line3', 'text', array('label' => 'Line 3', 'required' => false))
        ->add('city', 'text', array('label' => 'City'))
        ->add('township', 'text', array('label' => 'Township', 'required' => false))
        ->add('zipcode', 'text', array('label' => 'Zip'))
        ->add('state', new StateType());
}

public function getDefaultOptions(array $options)
{
    return array('data_class' => 'MySite\Bundle\SystemBundle\Entity\Address');
}

public function getName()
{
    return 'address';
}
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-07T21:24:06.227

[我在 Github https://github.com/symfony/symfony/issues/5121](https://github.com/symfony/symfony/issues/5121)上发现了这个问题讨论，果然，在我的 php.ini 文件中禁用 twig 扩展解决了这个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-25T10:41:40.653

您的尖峰解决方案是使用`{{ form_widget(form._token) }}`

# jquery - jQuery/AJAX 自动填充值

> ID：11640948
> 
> 赞同：0
> 
> 时间：2012-07-24T23:56:03.367
> 
> 标签：jquery, ajax, submit

我对*jQuery*和*AJAX*有疑问。我有 3 个选择标签，其值通过*AJAX*填充。

这是我需要的情况。

当我在第一个选择标签上选择选项时，我会在第二个选择标签中获得特定值。然后，当我在第二个标签上选择选项时，我会在第三个选择标签中获得特定值。在我在第三个选择标签中选择选项后 - 提交发生。这部分有效。

当然，提交后一切都会重置。我不希望这样，所以我已将 selected 放入 select 标记中。现在我不知道如何从第一个和第二个选择标签**“实时”**读取，以便在提交选项后保持填充。

**这是我的代码*PHP/HTML*代码：**

```
<form action="<?php echo $PHP_SELF; ?>" method="POST" name="userVideos" id="userVideos" style="width: 580px; margin-left: 5px; margin-bottom: 2px;">
        <select name="brand_select" id="brand_select" style="width: 140px; margin-right: 20px;">
            <option value="">Select Brand</option>

            <?php
            $query_brands = mysql_query("SELECT DISTINCT brand FROM users_video WHERE location = '2' ORDER BY brand");
            while ($row = mysql_fetch_object($query_brands))
            {
                $name = $row->brand;  
                $sel = ($_POST['brand_name'] == $name) ? "selected='selected'" : "";
                echo "<option value='{$row->brand}' $sel>{$row->brand}</option>";   
            }
            ?>

        </select>
        <input type="hidden" value="<?php echo htmlspecialchars($_POST['brand_select']); ?>" name="brand_name" id="brand_name"/>

        <select name="series_select" id="series_select" style="width: 140px; margin-right: 20px;" disabled>
            <option value="">Select Series</option>

            <?php
            //TODO: finish code tidification
            $sel = ($_POST['series_name'] != "") ? "selected='selected'" : "";
            echo "<option value='" . htmlspecialchars($_POST['series_name']) . "' $sel>" . htmlspecialchars($_POST['series_name']) . "</option>";
            ?>

        </select>
        <input type="hidden" value="" name="series_name" id="series_name"/>

        <select name="model_select" id="model_select" style="width: 140px;  margin-right: 20px;" disabled>
            <option value="">Select Model</option>

            <?php
            $sel = ($_POST['model_name'] != "") ? "selected='selected'" : "";
            echo "<option value='" . htmlspecialchars($_POST['model_name'] != "") . "' $sel>" . htmlspecialchars($_POST['model_name']) . "</option>";
            ?>

        </select>
        <input type="hidden" value="" name="model_name" id="model_name"/>
    </form> 
```

**这是我的*jQuery*代码：**

```
jQuery(document).ready(function(){

var brand = "";
var series = "";
var model = "";
var _brand = "";
_brand = $('#brand_name').val();

$("#brand_select").live("change", function(){ 
    brand = $('select#brand_select').val();

    if (brand == "" && _brand == "")
    {
        $('select#series_select').attr('disabled','disabled');
        $('#model_select').attr('disabled','disabled');
    }
    else
    {
        $('select#series_select').removeAttr('disabled');
        $('#brand_name').val(brand);

        var grbData = $.ajax({
            type: "GET",
            url: "series.php",
            data: "brand=" + brand,
            success: function(html){
                $("#series_select").html(html);
            }
        });
    }
});

$("#series_select").change(function(){
    series = $('select#series_select').val();
    if (series != ""){
        $('#model_select').removeAttr('disabled');
        $('#series_name').val(series);

        var newData = $.ajax({
            type: "GET",
            url: "model.php",
            data: "brand=" + brand + "&series=" + series,
            success: function(html){
                $("#model_select").html(html);
            }
        });
    }else{
        $('#model_select').attr('disabled','disabled');
    }
});

$("#model_select").change(function(){
    model = $('select#model_select').val();
    if (model != ""){
        $('#model_name').val(model);
        $('#userVideos').submit();
    }
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T01:06:30.557

为简单起见尝试这样的事情。给他们所有相同的类，但使用 id 作为品牌或系列。抱歉，我在写这篇文章时没有进行测试，但是您可以将所有功能移至 1\. 您需要调整的基本理念。此外，我什至可能用静态变量把它复杂化了。但至少您可以跟踪这些值。

```
$(".series_select").change(function(){
var value = $(this).val(),
    type = $(this).attr('id'),
    data,
    self = $(this);
    if(type == "brand"){
    data = "brand=" + value;
    $(".series_select").change.brand = value;
   } else if (type == "series"){
    data = "brand=" + $(".series_select").change.brand + "&series=" + value;
    $(".series_select").change.series = value;
   } else if( type == "submit"){
      if($(".series_select").change.brand != '' && $(".series_select").change.series != ''){
      $('#userVideos').submit();
       return;
      }
 }

    $.ajax({
        type: "GET",
        url: "model.php",
        data: data,
        success: function(html){
            self.html(html);
        }
        });
    }); 
```

# ncrunch - 如何使用带有 ncrunch 的批准测试 WinMergeReporter

> ID：11640949
> 
> 赞同：3
> 
> 时间：2012-07-24T23:56:05.490
> 
> 标签：ncrunch, approval-tests

我已经在 WinMergeReporter 上使用了一段时间的批准测试，它与标准的 NUnit 运行程序可执行文件配合得很好。

我正在尝试 NCrunch 和批准。验证失败（如预期的那样）以获得新的批准。

但是，WinMerge 不会启动。

我明白失败

ApprovalTests.Core.Exceptions.ApprovalMissingException：批准失败：未找到批准文件“...\mytest.approved.txt”。在 ApprovalTests.Approvers.FileApprover.Fail()

我可以在 NUnit 运行器中运行相同的代码并启动 WinMerge。

NCrunch 带来 WinMergeReporter 的秘诀是什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-25T09:02:07.357

这实际上是设计使然，因为每次 NCrunch 失败时都会弹出 winmerge 非常烦人。尤其是当它窃取焦点时。

但是，如果您愿意，这就是它的工作原理以及如何更改它（您可以随时将其更改回来）

Approval Tests 有一个 MultiReporter 系统，它使用来自程序集的前端加载来实现 GangOfFour“责任链”模式。它会像有一个

```
[assembly: FrontLoadedReporter(typeof(NCrunchReporter))] 
```

这实际上不必存在。如果没有实际存在，批准测试将假定它为默认值。

因此，如果您想将其关闭，则可以

```
[assembly: FrontLoadedReporter(typeof(AlwaysFaillingReporter))] 
```

除了那个记者不存在（尽管制作一个:-) 是微不足道的，所以你可能只想做

```
[assembly: FrontLoadedReporter(typeof(WinMergeReporter))] 
```

祝测试愉快！

# powershell - Add-DistributionGroupMember - 找不到我的组

> ID：11640954
> 
> 赞同：0
> 
> 时间：2012-07-24T23:56:47.633
> 
> 标签：powershell, scripting, active-directory, powershell-2.0

我正在使用以下脚本：

```
import-csv "C:\users\USERNAME\desktop\dl.csv" | foreach {add-distributiongroupmember -id "My Group" -member $_.PrimarySMTPAddress} 
```

但是它返回：

Add-DistributionGroupMember：无法执行操作，因为找不到“我的组”。

如何让它找到我的组？我已经确认它已连接到我的域控制器。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T13:26:17.400

这很奇怪，但我删除了该组并使用 Exchange 管理控制台重新创建它，它现在可以工作了。

谢谢你的帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-25T07:32:18.923

群存在吗？你能得到它：

```
Get-DistributionGroup -Identity "My Group" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-01-25T17:51:19.370

对我来说，问题发生是因为该组是作为“Office 365 组”创建的，您必须将其删除并将其创建为“分发组”。

我在 Office 365 服务器上为外部电子邮件创建 DL 并尝试使用 powershell 添加成员时遇到了同样的问题。此外，我选择从管理控制台手动创建 DL，它是作为 Office 365 组创建的，因此请确保您拥有 DL。我删除了 Office 365 组并创建了一个 DL，它运行良好！希望对您有所帮助！

# c# - 使用 BinaryFormatter 序列化/反序列化类型对象

> ID：11640955
> 
> 赞同：0
> 
> 时间：2012-07-24T23:56:47.920
> 
> 标签：c#, serialization

给定某个类 A 的对象 obj，执行 typeof(obj) 会给出一个表示 A 的 System.Type 对象

```
Type objsType = obj.GetType(); 
```

我想序列化（使用 BinaryFormatter）对象 objsType 并保留在磁盘上，以便在另一个 AppDomain 中运行的另一个模块可以将其反序列化为 Type 对象，即使它没有引用定义 A 的程序集。

当我尝试反序列化时，我收到一条错误消息，指出当前正在执行的模块找不到定义 A 的程序集。

如何在不出错的情况下满足我的要求？有没有办法做到这一点？

提前非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T00:01:33.563

你真的不能那样做。.Net 中的类型与其程序集密切相关，如果不先加载它的程序集，就无法加载类型。

# android - 使用 SQLite 存储 userEvents，得到 SQLiteException

> ID：11640961
> 
> 赞同：0
> 
> 时间：2012-07-24T23:58:00.337
> 
> 标签：android, sqlite, dao, sqliteopenhelper

我的 SQLite 数据库有问题。首先，我对数据库相当陌生，我根据我的情况改编了一个最佳实践教程。我最终得到了一些 DAO 和一个数据管理器来与表进行交互。

我有 3 个表，一个 Event Task 和 Person 表，我的 Person 和 Task 表被添加到数据库中没有问题。但是当我尝试做主表（事件）时，它给了我这个错误。

```
07-24 16:55:55.055: E/AndroidRuntime(10053): Caused by: android.database.sqlite.SQLiteException: no such table: event: , while compiling: insert into event (logging_user, location, initial_time, _id) values (?, ?, ?, ?) 
```

所以我为每个表使用了一个常量（我认为你必须这样做），所以我的 eventTable 确实存在，名称为“event”。会是什么呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T00:06:47.833

这已被多次询问here。请看看这个：[关于sqlite数据库的问题，没有这样的表：](https://stackoverflow.com/questions/2342346/problem-about-sqlite-database-no-such-table)有助于解决您的问题。

# java - Libgdx 屏幕不交换

> ID：11640962
> 
> 赞同：4
> 
> 时间：2012-07-24T23:58:54.923
> 
> 标签：java, screen, libgdx

我是 Libgdx 的新手，我写了一个扩展 Game 类的类，问题是 Game 中的 setScreen() 方法没有交换屏幕，因为在我设置屏幕后，我的游戏仍然只渲染渲染方法中的内容来自游戏类，而不是屏幕类的渲染方法中的内容。这是代码：

如果运行此代码，即使我在用户触摸（单击）屏幕时更改屏幕，我也只会得到一个红屏

```
class myGame extends Game
{
    GameScreen myOtherScreen;

    public void create() 
    {
       //create other screen
       myMenuScreen = new GameScreen();
    }

    public void render(float delta) 
    {   
        // change screens if screen touched
        if(Gdx.input.justTouched())
            setScreen(myOtherScreen);

            //render red screen
        Gdx.gl.glClearColor(1, 0, 0, 1);
        Gdx.gl.glClear(GL10.GL_COLOR_BUFFER_BIT);

    }
    .
    . //other methods
    .
}

// ======= Screen Class ========

public class GameScreen implements Screen
{
     @Override
     public void render(float delta) 
     {
            //render green screen
         Gdx.gl.glClearColor(0, 1, 0, 1);
         Gdx.gl.glClear(GL10.GL_COLOR_BUFFER_BIT);      
     }
     .
     . //other methods
     .
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-25T13:46:26.640

您没有正确使用游戏类。你不应该在那里进行任何渲染，这是屏幕的任务。

您应该查看[libgdx 屏幕和游戏类 wiki 页面](http://code.google.com/p/libgdx-users/wiki/ScreenAndGameClasses)。用法应该是这样的：

```
public class MyGame extends Game {
        @Override
        public void create() {
                setScreen(new RedScreen(this));              
        }
 } 
```

并有一个像这样的红屏：

```
public class RedScreen implements Screen {
    MyGame game; 
    public RedScreen(MyGame game){
            this.game = game;
    }

    public void render(float delta) {
        if(Gdx.input.justTouched())
            game.setScreen(new GreenScreen(game);

         //render red screen
         Gdx.gl.glClearColor(1, 0, 0, 1);
         Gdx.gl.glClear(GL10.GL_COLOR_BUFFER_BIT);
    }
    // ... more screen functions
} 
```

并有一个这样的绿屏：

```
public class GreenScreen implements Screen {
    MyGame game; 
    public MainMenuScreen(MyGame game){
            this.game = game;
    }

    public void render(float delta) {
         //render green screen
         Gdx.gl.glClearColor(0, 1, 0, 1);
         Gdx.gl.glClear(GL10.GL_COLOR_BUFFER_BIT);
    }
    // ... more screen functions
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-25T20:13:14.680

发现问题的解决方案是不使用游戏类中的渲染方法，事实上你实际上必须从类中删除它相信我你必须在其他屏幕类中进行所有渲染。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-11-29T07:56:44.653

我找到了根本原因。实际上，在 Game中绘制其他东西之前，您必须添加`super.render()`Game 的方法。`render()`如果没有，您覆盖的渲染方法将不会调用 Screen 的`render()`方法。

顺便说一句：最佳实践是使用类 Screen 渲染事物。

请注意：即使在 Game 中为空`render()`也会导致此问题。因此，`render()`在您的游戏中删除或添加`super.render()`。

# java - 为画布/表面视图设置屏幕分辨率

> ID：11640971
> 
> 赞同：0
> 
> 时间：2012-07-25T00:00:25.263
> 
> 标签：java, android

我正在尝试为 android 中的手机应用程序创建动画，并创建了一个 320pix 高的图像。但是当他出现在我的 Galaxy S3 上的 0,0 位置时，他有点小……（人像模式和风景模式）。我宁愿不为如此高分辨率创建大图像，那么有没有办法将屏幕分辨率设置为 640x480 或 1024x768 之类的东西？它似乎是目前最高的分辨率。

我是 Java 和 android 的新手。（.Net 背景）。我正在使用 Canvas 和 SurfaceView。我希望有一个 SetResolution 类型的方法...希望有人可以提供帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T00:20:07.003

您无法轻松更改屏幕的分辨率（如果您正在尝试这样做）。

因此，您要么需要创建更大的图片，要么将其缩放到所需的屏幕尺寸。

你应该熟悉 Android 上的所有密度、分辨率的东西。我强烈建议您阅读有关[支持多种屏幕尺寸](http://developer.android.com/guide/practices/screens_support.html)的 Android 开发者文档。它确实包含有关该主题的许多有用信息。

它还可以帮助您了解 Android 如何为您调整图像大小。

简而言之，有关如何自行完成的一些信息：

您可以[`SurfaceHolder.Callback`](http://developer.android.com/reference/android/view/SurfaceHolder.Callback.html)在. 这个回调有一个[方法](http://developer.android.com/reference/android/view/SurfaceHolder.Callback.html#surfaceChanged%28android.view.SurfaceHolder,%20int,%20int,%20int%29)，当屏幕分辨率改变时调用。您可以创建一个静态类，将新的屏幕尺寸传递给该类。这个类可以计算屏幕的比例，你可以假设你一直在使用 800x480 的屏幕（或任何你喜欢的）。您使用类似的方法。你传递一个 x 坐标——在你假设的 800x480 屏幕内——并且该方法返回屏幕上的真实坐标，根据你传递给静态类的大小，从.[`SurfaceHolder`](http://developer.android.com/reference/android/view/SurfaceHolder.html)[`SurfaceView`](http://developer.android.com/reference/android/view/SurfaceView.html)`double MyCoord.x(int)``SurfaceHolder.Callback`

那将是您拥有的一种可能性。要找到更详细的解释和更多的可能性，你应该阅读开发者文档，在我看来，这是关于大多数主题的很好的例子:)

# nosql - Cassandra CLI 'org.apache.thrift.transport.TTransportException'

> ID：11640973
> 
> 赞同：4
> 
> 时间：2012-07-25T00:00:51.637
> 
> 标签：nosql, cassandra, command-line-interface, thrift

我使用的是最新版本的 Cassandra 1.1.2，并且我的 Cassandra 数据库中已经有数据。我想通过以下方式更新列族的元数据：

使用 column_metadata = [{column_name: timestamp, validation_class: UTF8Type}] 更新列族注释；

（之前，timestamp 是 IntegerType）

但是，Cassandra-CLI 返回：'org.apache.thrift.transport.TTransportException'

当我再次尝试该命令时，我得到：'org.apache.thrift.transport.TTransportException: java.net.SocketException: Broken pipe'

我在 Ubuntu 上运行 Cassandra。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T19:37:55.260

存储的数据可能与时间戳字段不兼容。时间戳字段是 0 或 8 字节长，表示自 Unix 纪元以来的时间。

我建议首先检查 CLI 中的值以确保它兼容。

# android - 如何将 Android PropertyValuesHolder 与 proguard 一起使用

> ID：11640977
> 
> 赞同：1
> 
> 时间：2012-07-25T00:01:33.523
> 
> 标签：android, android-animation, proguard

我正在使用 PropertyValuesHolder 为我的 Android 应用程序中的一些视图设置动画。动画在我的设备上运行良好，直到我在没有任何动画的地方进行发布构建。（我认为问题与混淆有关，因为属性名称被称为字符串名称，例如“Panel1W”）

没有抛出异常。只是没有动画。[我在http://proguard.sourceforge.net/index.html#manual/troubleshooting.html](http://proguard.sourceforge.net/index.html#manual/troubleshooting.html)上能找到的最接近的东西 是 NoSuchMethodException，我们需要在 proguard.cfg 中使用 -keep 命令。我在我的 proguard.cfg 中尝试了以下但没有成功

```
-keep public class com.mycompany.myapp.HomeActivity { java.lang.Integer getPanel1W(); }
-keep public class com.mycompany.myapp.HomeActivity { void setPanel1W(java.lang.Integer); }
-keep public class com.mycompany.myapp.HomeActivity { java.lang.Integer getPanel2W(); }
-keep public class com.mycompany.myapp.HomeActivity { void setPanel2W(java.lang.Integer); }
-keep public class com.mycompany.myapp.HomeActivity { java.lang.Integer getPanel3W(); }
-keep public class com.mycompany.myapp.HomeActivity { void setPanel3W(java.lang.Integer); } 
```

我错过了什么吗？这是下面的代码。谢谢。

```
PropertyValuesHolder[] arrayOfPropertyValuesHolder = new PropertyValuesHolder[3];
arrayOfPropertyValuesHolder[0] = PropertyValuesHolder.ofInt("Panel1W", mPanel1.getWidth(), 0);
arrayOfPropertyValuesHolder[1] = PropertyValuesHolder.ofInt("Panel2W", 360, 1280);
arrayOfPropertyValuesHolder[2] = PropertyValuesHolder.ofInt("Panel3W", 0, (int)(screenWidth * 0.65));

ObjectAnimator localObjectAnimator = ObjectAnimator.ofPropertyValuesHolder(this,
arrayOfPropertyValuesHolder).setDuration(time);
localObjectAnimator.setInterpolator(sCollapseInterpolator);
localObjectAnimator.start(); 
```

我也有 getter 和 setter 方法。

```
 public int getPanel1W() {
        return ((ViewGroup.MarginLayoutParams) mPanel1.getLayoutParams()).width;
    }

    public void setPanel1W(int paramInt) {
        ViewGroup.MarginLayoutParams lp = (ViewGroup.MarginLayoutParams) mPanel1.getLayoutParams();
        lp.width = paramInt;
        mPanel1.setLayoutParams(lp);
    }

    public int getPanel2W() {
        return ((ViewGroup.MarginLayoutParams) mPanel2.getLayoutParams()).width;
    }

    public void setPanel2W(int paramInt) {
        ViewGroup.MarginLayoutParams lp = (ViewGroup.MarginLayoutParams) mPanel2.getLayoutParams();
        lp.width = paramInt;
        mPanel2.setLayoutParams(lp);
    }  

    public int getPanel3W() {
        return ((ViewGroup.MarginLayoutParams) mPanel3.getLayoutParams()).width;
    }

    public void setPanel3W(int paramInt) {
        ViewGroup.MarginLayoutParams lp = (ViewGroup.MarginLayoutParams) mPanel3.getLayoutParams();
        lp.width = paramInt;
        mPanel3.setLayoutParams(lp);        
    } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-09-29T08:39:40.027

诀窍在于 调用的方法`PropertyValuesHolder`是`set*`or `get*`，因此`ProGuard`保留这些方法的规则是：

```
void set*(***);
*** get*(); 
```

因此，基于此，如果您的动画目标只是少数几个类之一，请为每个动画目标类添加以下内容：

```
-keep class my.package.MyClass {
    void set*(***);
    *** get*();
} 
```

如果您的所有目标都扩展了某个基类，您可以添加一条规则来保存它们：

```
-keep class * extends my.package.MyBaseClass {
    void set*(***);
    *** get*();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T09:01:26.620

请检查字符串“Panel1W”、“Panel2W”和“Panel3W”是否被proguard混合。我认为您可以在类中定义这些字符串并在proguard.cfg中定义这些字符串以保护这些字符串。

# .net - 如何在同一个 IIS 网站下合并 MVC4 站点和 WebAPI 站点？

> ID：11640985
> 
> 赞同：4
> 
> 时间：2012-07-25T00:02:03.420
> 
> 标签：.net, routing, asp.net-mvc-routing, asp.net-mvc-4, asp.net-web-api

我有一个项目（名为`Product.Api`），其中包含一些用于我们的 WebAPI 站点的控制器。控制器位于命名空间中`Product.Api.Controllers`。该项目还有一些其他的辅助工具。这被编译成一个库。

我还有另一个名为`Product.Web`. 这有控制器（在命名空间下`Product.Web.Controllers`）、模型和视图（在其相应的文件夹中）。它还有一个`Global.asax.cs`包含路由信息的。

在 IIS（.NET 4.5、IIS7、集成模式等）中创建站点时，我将`Product.Api`dll 复制到 bin 文件夹中。是`Product.Web`主要站点。

现在我希望 url [http://www.product.com/api/](http://www.product.com/api/) {Controller}/{id} 映射到 WebAPI 的东西和[http://www.product.com/](http://www.product.com/) {Controller}/{Action}/{ id} 映射到常规 MVC。

这就是我现在拥有的路线：

```
routes.MapHttpRoute(
                name: "DefaultApi",
                routeTemplate: "api/{controller}/{id}", 
                defaults: new {id = RouteParameter.Optional}
            ).Constraints["Namespaces"] = new string[] { "Product.Api.Controllers" };

            routes.MapRoute(
                name: "Default",
                url: "{controller}/{action}/{id}",
                defaults: new { controller = "Home", action = "Index", id = UrlParameter.Optional } ,
                namespaces: new[] { "Product.Web.Controllers" }
            ); 
```

不幸的是，当我访问 api url 时（在本例中，示例是[http://www.product.com/api/Tables/](http://www.product.com/api/Tables/)（或者即使我定义了一个 id），我得到一个 HTTP 404 错误。

[http://www.product.com/Home/Index](http://www.product.com/Home/Index)工作正常。

奇怪的是，我尝试了[路由调试器工具](http://haacked.com/archive/2008/03/13/url-routing-debugger.aspx)，但仍然有问题。事实上，我永远看不到调试器的输出。[http://www.product.com/Home/Index](http://www.product.com/Home/Index)和[http://www.product.com/](http://www.product.com/)都显示了视图，但所有 api/* 仍然显示 404。我还没有看到调试器的任何输出。

那么到底有没有达到想要的效果呢？

编辑：我注意到我的 global.asax.cs 文件在`Product.Web`命名空间中。我将其更改为在`Product`名称空间中，但仍然不行。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-25T07:18:55.743

```
routes.MapHttpRoute(
                name: "DefaultApi",
                routeTemplate: "api/{controller}/{id}", 
                defaults: new {id = RouteParameter.Optional}
            ).Constraints["Namespaces"] = new string[] { "Product.Api.Controllers" }; 
```

这不适用于 MapHttpRoute。

如果你想使用另一个 bin 中的 ApiController 路由，只需删除约束，运行时会自动从 bin 中获取你的 ApiControllers。MapHttpRoute 不会干扰您的 MVC 控制器，反之亦然，因此无论如何都不需要约束。

或者使用它来限制您的 HttpRoute 命名空间

```
routes.DataTokens["Namespaces"] = new string[] {"MyNamespace"}; 
```

或者使用[这个解决方案](http://www.strathweb.com/2012/06/using-controllers-from-an-external-assembly-in-asp-net-web-api/)（但只有当你把东西放在垃圾箱外面时才需要这样做。）

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-26T21:35:44.043

在 MapHttpRoute Factory 调用之前添加 System.Web.Mvc.ControllerBuilder.Current.DefaultNamespaces.Add("Namespace.Full.Controllers");

# iphone - 是否可以让工厂类负责创建一个对象集合而不是一次创建一个对象集合

> ID：11640986
> 
> 赞同：0
> 
> 时间：2012-07-25T00:02:11.440
> 
> 标签：iphone, ios, design-patterns, factory-pattern

我正在为有 4 种不同口味的咖啡的咖啡店创建一个菜单应用程序。1\. 黑咖啡 2\. 卡布奇诺 3\. 摩卡 4\. 冰咖啡。

我已经使用工厂方法来生成这些对象。

```
+ (Coffee *) getInstance:(COFFE_TYPE /*枚举*/):type{

   咖啡 *returnValue = nil;

   开关（类型）{
     黑色案例：returnValue = new Black_Coffee();
                 休息;
    案例卡布奇诺：returnValue = new Cap_Coffee();
                 休息;
    案例摩卡：returnValue = new Mocha_Coffee();
                 休息;
    冰镇案例：returnValue = new Iced_Coffee();
                 休息;

    }
    返回返回值；
}

```

在我的客户中，我必须维护所有可用 Coffee 的列表。我相信没有办法了解给定基类的子类，因此我必须手动迭代所有子类并使用工厂方法来创建每个 Object 。一旦我有 50 种不同类型的咖啡（我会的），这将变得一团糟。所以每次我添加一个新类型时，我都必须将它添加到工厂中，我的客户也需要添加哪个附加项目。

有没有办法让我可以将整个逻辑转移到一个地方。所以只有工厂方法只知道附加项目，我的客户可以在工厂类本身上调用 getAllItems 并迭代它们，或者我应该让我的客户处理项目的集合（现在就是这种情况）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T00:25:21.780

我处理这个问题的方法是创建一个静态 NSMutableDictionary，当你的应用程序启动时，你可以使用新的类方法注册已知的咖啡类型。类方法将对字典执行 setObject:forKey。为客户提供一些方法来注册任意数量的对象，因为他们知道每个“键”（名称）必须是唯一的。也就是说，他甚至可以使用相同的键覆盖您创建的初始项目（并替换与该类型关联的任何对象。

我会使用名称而不是数字（就像您现在所使用的那样），但是如果您想坚持使用只要您使用 NSNumber 作为字典中的键就可以使用的数字。

# c# - KoGrid JSON 动态小部件

> ID：11640987
> 
> 赞同：1
> 
> 时间：2012-07-25T00:02:41.927
> 
> 标签：c#, json, knockout.js

我正在使用 KOGrid 的仪表板上工作，我的想法是动态创建一堆小部件并将数据绑定到每个小部件的 kogrid 中。问题在于淘汰绑定，我在动态创建 DIV 时使用 myObsArray，并在视图模型中使用相同的，这导致所有小部件绑定到相同的数据（即，因为它是可观察的，覆盖数据所有小部件的最后一个小部件）。我所有通过关联数组来解决这个问题的尝试都是徒劳的。非常感谢您的帮助。提前一百万谢谢。

我有两个控制器（MVC4），其中第一个返回小部件名称列表，第二个返回 JSON 格式的结果（数据表）。我正在使用 JSON.Net JsonConvert 将结果转换为 json 格式，然后作为 JSON 内容结果传递。当我使用一个小部件时一切都很好，但问题是使用多个小部件时。

```
function loadWidgets(data) {
        //showLoading();
        var div1 = $("#db-col-1");
        var div2 = $("#db-col-2");
        div1.html('');
        div2.html('');
        $.each(data, function (index, item) {

            var li = "<li id='" + item.WIDGET_NAME + "_li'></li>";
            if (index % 2 == 0)
                div1.append(li);
            else
                div2.append(li);

            $("#" + item.WIDGET_NAME + "_li")
            .append("<div id= '" + item.WIDGET_NAME + "' class='example' data-      bind='koGrid: { data: myObsArray }'></div>"); //,
            LoadJson(item.WIDGET_NAME, item.WIDGET_NAME + "Arr" );

        });
    }

   function LoadJson(widgetName) {
        var wName = widgetName;
        $.getJSON('Home/GetWidgetDetails?widgetName=' + wName, 
            function (data) {
                window.viewModel = {
                        myObsArray: ko.observableArray(data) //myObsArray
                    };                                                                  
                    ko.applyBindings(viewModel);
                });        
    } 
```

谢谢，沙希

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T16:24:33.400

首先，不要调用`ko.applyBindings`可以多次调用的函数。这个调用每个视图模型应该只发生一次。这最近出现了很多，我开始认为有人在某个地方的糟糕教程中做到了这一点。

其次，您的问题是您正在覆盖您的视图模型。这一点在这里：

```
window.viewModel = {
    myObsArray: ko.observableArray(data) //myObsArray
}; 
```

第一次调用它时，它会创建您的视图模型。第二次以上，它会覆盖您的视图模型。此外，无需以编程方式创建 HTML。Knockout 更适合通过`foreach`绑定执行此任务。你似乎错过了很多淘汰赛应该做的事情，所以我鼓励你[阅读教程](http://learn.knockoutjs.com/)，如果你还没有这样做的话。最后，您的 HTML 将无效。您正在制作没有 a或将它们放入`li`的节点。`ol``ul`

这是您的问题的 MVVM 解决方案，[在 fiddle](http://jsfiddle.net/tyrsius/KGcV4/)中。它被简化以演示绑定概念，并且不使用`koGrid`.

# ruby-on-rails - 在 Ruby on Rails 中从 JSON 制作表格？

> ID：11640988
> 
> 赞同：3
> 
> 时间：2012-07-25T00:02:50.370
> 
> 标签：ruby-on-rails, ruby, json

我有一些 JSON 被拉入并读入一个对象`@items`：

```
[
 {
  {
    "id": "A",
    "description": "a_description_one"
    "value": some_alphanumeric_string
  }, 
  {
    "id": "B",
    "description": "b_description_one"
    "value": some_alphanumeric_string
  }, 
  {
    "id": "C",
    "description": "c_description_one"
    "value": some_alphanumeric_string
  }
 }, 
 {
  {
    "id": "C",
    "description": "c_description_3"
    "value": some_alphanumeric_string
  }, 
  {
    "id": "A",
    "description": "a_description_3"
    "value": some_alphanumeric_string
  }, 
  {
    "id": "B",
    "description": "b_description_3"
    "value": some_alphanumeric_string
  }
 }, 
 ...
] 
```

我的目标是在 HTML 中输出两个表格，如下所示：

```
 -----------------------------------------------------
|        A        |        B        |        C        |
|-----------------------------------------------------|
|a_description_one|b_description_one|c_description_one|
|-----------------------------------------------------|
|a_description_two|b_description_two|c_description_two|
|-----------------------------------------------------|
|a_description_3  |b_description_3  |c_description_3  |
 ----------------------------------------------------- 
```

第二张桌子：

```
 ----------------------------------------------------
|  C value  | C description  |  Count       | Change |
|----------------------------------------------------|
|some string|it's description|times appeared| change |
 ---------------------------------------------------- 
```

虽然第一个表相当简单，但由于我不知道描述符的顺序，我无法找到对其进行编码的好方法。因此，我有：

```
<table> 
  <thead> 
    <tr>
      <th>a</th>
      ...
    </tr>
  </thead>
  <tbody> 
    <% for item in @items %>
      <% for portion in item %> 
        <% if portion[0]["id"] == "A" %> 
           <% a = portion[0] %>
        <% end %>
      ...
      <% end %> 
      <tr> 
        <td><%= a["description"].to_s %></td>
        ...
      </tr> 
    <% end %>
  </tbody>
</table> 
```

这看起来很糟糕。

至于第二个表，我要做的就是查看所有 C 值，如果有多个具有相同 C 值的倍数，则将它们连接起来。我还想加载昨天的数据，我可以从服务器获取并拥有 as `@items_old`，并将具有相同值的项目数与昨天的数进行比较。我不知道该去哪里。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T00:30:58.137

听起来描述数组是乱序的，但你需要它们按顺序排列。因此，只需在遍历它们之前对数组进行排序。

```
<% for item in @items %>
  <% for portion in item.sort_by { |obj| obj['id'] } %> 
    <tr>
      <td><%= obj["description"].to_s %></td>
      ...
    </tr>
  <% end %>
<% end %> 
```

* * *

或者，ruby 数组确实有一个`Array#find`方法，它接受一个块并在块返回时返回一个项目`true`。因此，如果您想真正明确地说明它，您可以这样做：

```
<% for item in @items %>
  <% for portion in item %> 
    <tr>
      <td><%= item.find { |obj| obj['id'] == 'A' }["description"].to_s %></td>
      <td><%= item.find { |obj| obj['id'] == 'B' }["description"].to_s %></td>
      <td><%= item.find { |obj| obj['id'] == 'C' }["description"].to_s %></td>
    </tr>
  <% end %>
<% end %> 
```

但这开始变得很棘手。我强烈建议将该逻辑重构为一些辅助方法。这里的缺点是你曾经有一个`D`在那里你突然有很多代码要改变。只需遍历已排序的数组，您就不必真正关心其中有多少，这取决于您在做什么，这可能是好是坏。

* * *

最后，您可以将 ruby​​ 中的这些数据转换为您想要的格式。从这些数据中构建新的数组和散列，并将处理`@items`后的对象呈现给视图。或者甚至更好地将所有这些包装在一个类中，该类具有解析这些数据的方法，然后为其提供一个简单的接口。

如果这些数据相当复杂，并且以多种不同的方式使用，这可能是最“正确”的方法，因为它封装了远离表示逻辑的数据逻辑。

```
class Descriptions
  def initialize(json)
    @data = JSON.parse(json)
  end

  def get_description(index, id)
    description_obj = @data[index].find do |obj|
      obj['id'] == id
    end

    description_obj['description'].to_s
  end
end

my_model = Descriptions.new(json)
my_model.get_description(0, 'A') 
```

# python - f2py 包装器编译错误：设置数组的形状

> ID：11640990
> 
> 赞同：0
> 
> 时间：2012-07-25T00:03:15.670
> 
> 标签：python, fortran, f2py

我在通过 f2py 编译时遇到问题。我有一个 f90 模块，里面有几个子例程。到目前为止，它一直在编译，以便在 python 脚本中使用。但是，现在当我尝试编译它并构建它时，它会抱怨这个错误：

```
build/src.macosx-10.5-x86_64-2.7/PyCosmology/sims/fort/read_sim-f2pywrappers2.f90:355.17:

   allocate(d())
             1
Error: Shape specification for allocatable scalar at (1) 
```

它还有另外两个错误，但这些只是由于`d()`这里没有正确分配造成的。您可以看到它正在编译的文件是 f2py 包装器。更奇怪的是，当我真正查看它指向的包装文件时，第 355 行实际上是：

```
 allocate(d(s(1),s(2))) 
```

所以我不知道为什么编译器告诉我分配语句中没有形状说明符。正因为如此，我不知道如何解决它！

请注意，自从上次正确编译后，我对模块进行了一些更改，但发生此错误的数组我根本没有触及，我也没有触及它存在的特定子例程。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T02:56:01.610

弄清楚了。

我试图分配给一个整数。对不起。

# grails - Grails hasOne 和 hasMany 相同的域

> ID：11640996
> 
> 赞同：0
> 
> 时间：2012-07-25T00:03:57.737
> 
> 标签：grails, has-many, has-one

我有这样的域：

```
class Team {
 hasOne [leader: Person]
 hasMany [member: Person]
}

class Person {
 belongsTo [team: Team]
} 
```

但是生成表时，team表中没有leader_id这样的列。因此，领导者关系不会持续存在。

我应该如何解决它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-16T10:47:49.667

我想，我需要的是

```
class Team {
 belongsTo [leader: Person]
 hasMany [member: Person]
}

class Person {
 belongsTo [team: Team]
} 
```

这样 Team 表就可以将所需的“领导者”引用返回给 Person。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-25T02:04:06.213

根据[文档](http://grails.org/doc/latest/ref/Domain%20Classes/hasOne.html)：

使用 hasOne 关联将外键引用存储在子表中，而不是双向一对一的父表中。

您在这里的子表是人，而您的父表是团队。Grails 正在按预期工作。