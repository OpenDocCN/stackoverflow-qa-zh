# StackOverflow 问答 1015000-1015999

# c# - 如何正确测试 NHibernate FetchMode.Eager？

> ID：1015001
> 
> 赞同：1
> 
> 时间：2009-06-18T20:23:47.823
> 
> 标签：c#, .net, nhibernate, eager-loading

有没有办法编写集成测试来测试 FetchMode.Eager 是否正常工作？我想验证当我检索 MySubObject 时它不会进入数据库。

编码：

```
public MyObject GetEager(string name)
{
    return Session
        .CreateCriteria(typeof(MyObject))
        .SetFetchMode("MySubObject", FetchMode.Eager)
        .Add(Restrictions.Eq("Name", name))
        .UniqueResult<MyObject>();
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-19T13:49:00.300

您也可以使用`NHibernateUtil.IsInitialized`... 如本文所述

[http://nhibernate.info/doc/howto/various/lazy-loading-eager-loading.html](http://nhibernate.info/doc/howto/various/lazy-loading-eager-loading.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T11:03:01.370

像这样的东西怎么样;

```
MyObject testObject = new MyObject();
testObject.GetEager("a name");
testObject.Session.Close();
Assert.AreEqual(testObject.MySubObject.Id, 3425); 
```

通过关闭会话然后尝试访问关联的对象，如果对象没有被急切加载，它将引发异常。相反，如果它是 eagrly 加载的，NHibernate 将不会尝试访问数据库，因此不会抛出异常。

# c# - Return Enum From C# Property getters

> ID：1015016
> 
> 赞同：2
> 
> 时间：2009-06-18T20:26:31.203
> 
> 标签：c#, visual-studio

How do you return an Enum from a setter/getter function?

Currently I have this:

```
 public enum LowerCase
    {
        a,
        b,
    }
    public enum UpperCase
    {
        A,
        B,
    }

    public enum Case
    {
        Upper,
        Lower,
    }

    private Enum _Case;
    private Enum _ChosenCase;

    public Enum ChooseCase
    {
        get
        {
            if ('Condition')
            {
                return LowerCase; //[need to return LowerCase]
            }
            else
            {
                return UpperCase; //[need to return UpperCase]
            }
        }
        set
        {
            _ChosenCase = value; 
        }
    } 
```

When I try to run this I get an error:

LowerCase is a 'type' but is used like a 'variable'

Any ideas what I need to do to return an enum????

I am also not so sure about setting the value at the moment either.

If anyone can give some general advise, I would appreciate it; most people should be able to see what I am trying to do.

Thanks very much.

[Latest Edit]

Firstly thanks to all who replied.

In an attempt to simplify this question, it appears I have used the wrong analogy of upper/lower case and some of you have got the wrong idea - clearly not your fault :)

This is the code I have so far and allows you to choose between ChoiceOne and ChoiceTwo

```
 public partial class CustomControl1 : Control
    {
    public enum ChoiceOne
    {
        SubChoiceA,
        SubChoiceB,
    }
    public enum ChoiceTwo
    {
        SubChoiceC,
        SubChoiceD,
    }
    public enum Choice
    {
        ChoiceOne,
        ChoiceTwo,
    }

    private Type _subChoice;
    private Choice _choice;

    public Type SetSubChoice
    {
        get
        {
            if (_choice.Equals(Choice.ChoiceOne))
            {
                return typeof(ChoiceOne); 
            }
            else
            {
                return typeof(ChoiceTwo);
            }
        }
        set
        {
            _subChoice = value; 
        }
    }

    public Choice SetChoice
    {
        get
        {
            return _choice;
        }
        set
        {
            _choice = value;
        }
    }      
    } 
```

What happsens in VisualStudio is that property grid allows you to set the SetChoice property between ChoiceOne and ChoiceTwo which is correct.

The problem is that the SetSubChoice property is greyed out but it does set to either 'WindowsFormsApplication4.CustomControl1+ChoiceOne' or 'WindowsFormsApplication4.CustomControl1+ChoiceTwo' dependent upon what SetChoice is set to. What I want is to be able to use SetSubChoice to pick SubChoiceA or SubChoiceB or SubChoiceC or SubChoiceD depending on what SetChoice is set to.

So for example, if SetChoice is set to ChoiceOne then SetSubChoice will allow me to choose between ChoiceA or ChoiceB. Likewise if SetChoice is set to ChoiceTwo then SetSubChoice will allow me to choose between ChoiceC or ChoiceD.

Hopefully this has clarified things a little more?

We are almost there now :) keep the ideas coming.

Thanks

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-06-18T20:28:47.343

It looks like you want:

```
public Case ChooseCase
{
    get { return 'Condition' ? Case.Lower : Case.Upper; }
} 
```

Or have I missed the point completely?

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-18T20:28:42.353

The error is correct. It's basically the same as doing this

```
public int ChooseCase
{
    get{ return int; }
} 
```

What you'll want to do is use real classes - not enums - with a common base.

```
public abstract class Case
{
    public abstract string ModifyString(string value);
}

public class UpperCase : Case
{
    public override string ModifyString( string value )
    { 
        return String.ToUpper( value ); 
    }
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-18T20:49:57.630

我想你可能误解了使用枚举的原因。枚举是一种特殊类型的变量，只能采用一组特定的值。例如。布尔值是枚举的一种非常特殊的情况。布尔变量是一个只能取 2 个值的变量——“真”或“假”。

您已经定义了一个枚举：

```
公共枚举小写
    {
        一个，
        乙，
    }
```

这意味着类型变量`LowerCase`只能设置为 a 或 b。这个用处不大。

您的其他枚举更明智：

```
公共枚举案例
    {
        上，
        降低，
    }
```

Case 类型的变量可以设置为“Upper”或“Lower”。现在，当您定义枚举类型的变量时，您可以指定您想要的类型。你已经这样做了：

```
私有枚举案例；
```

但你认为你的意思是：

```
私人案例；
```

`Case`这定义了一个名为的私有变量`case`。enum 关键字仅在定义新枚举时使用，而不是在定义枚举类型的变量时使用。

同样，在您定义了属性的地方，您应该使用要返回的枚举类型：

```
公共案例选择案例
{...
```

在您尝试返回枚举值的地方，您应该这样做：

```
返回 Case.Lower
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-18T20:31:43.750

You're mixing two enumerations together which is not a good idea since it defeats the purpose of the enum type.

Definitely do **not** cast to int and do comparisons that way -- you lose the ability to change the order of your enumerated values in future versions.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-18T20:29:46.047

Use types... ie..

```
 public Type ChooseCase{
    get{ return typeof(Uppercase); }
} 

```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-18T20:30:35.157

That error is being thrown because LowerCase is a type. Imagine if you were trying to write this statement.

```
return Int32; 
```

That would not work because Int32 is a type and not a variable. You will need to create an instance of LowerCase and then you can return it.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-19T19:53:36.500

可能您应该使用基类 Case 和两个派生类，以便您的 ChooseCase 属性返回相应类的对象：

```
abstract class Case
{
    abstract char GetItem(int index);
}

class LowerCase : Case
{
    override char GetItem(int index)
    {
        // Not sure for the following
        Encoding ascii = Encoding.ASCII;
        return ascii.GetString(ascii.GetBytes("a")[0] + index)[0];
    }
}

class UpperCase : Case
{
    // The same for the upper case
}

public Case ChooseCase
{
    get
    {
        if (condition)
        {
            return new LowerCase();
        }
        else
        {
            return new UpperCase();
        }
    }
} 
```

这是你不能用枚举做的事情，因为它们都完全来自枚举。

# javascript - Ok, we can have private identifiers in javascript, but what about protected ones?

> ID：1015017
> 
> 赞同：3
> 
> 时间：2009-06-18T20:26:31.357
> 
> 标签：javascript, visibility, protected

Simple as that, can we emulate the "protected" visibility in Javascript somehow?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-18T20:28:57.093

Do this:

```
/* Note: Do not break/touch this object */
...code... 
```

Or a bit of google found this on the first page:

[http://blog.blanquera.com/2009/03/javascript-protected-methods-and.html](http://blog.blanquera.com/2009/03/javascript-protected-methods-and.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-18T20:30:07.870

[Sure](http://webreflection.blogspot.com/2008/02/how-to-inject-protected-methods-in.html) you can. Here's another [example](http://blog.blanquera.com/2009/03/javascript-protected-methods-and.html).

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-18T20:29:29.073

What could that possibly mean? You don't have *classes*.

I suppose you could analyze `caller` to determine whether it meets some set of criteria for being permitted to call a method. This will be hideously inefficient and your criteria will always be spoofable.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-26T03:06:22.150

这里有一个有趣的模式值得一提：JavaScript 构造函数可以返回任何对象（不一定是*this*）。可以创建一个构造函数，它返回一个代理对象，其中包含对“真实”实例对象的“真实”方法的代理方法。这听起来可能很复杂，但事实并非如此；这是一个代码片段：

```
var MyClass = function() {
    var instanceObj = this;
    var proxyObj = {
        myPublicMethod: function() {
            return instanceObj.myPublicMethod.apply(instanceObj, arguments);
        }
    }
    return proxyObj;
};
MyClass.prototype = {
    _myPrivateMethod: function() {
        ...
    },
    myPublicMethod: function() {
        ...
    }
}; 
```

好处是代理创建可以自动化，如果我们定义一个命名受保护方法的约定。我创建了一个这样做的小库：http: [//idya.github.com/oolib/](http://idya.github.com/oolib/)

# c# - 如何使用 .NET 读取 ASP.NET 内部服务器错误描述？

> ID：1015020
> 
> 赞同：6
> 
> 时间：2009-06-18T20:27:51.840
> 
> 标签：c#, .net, asp.net, iis, webclient

看代码：

```
using (var client = new WebClient())
{
    try
    {
        var bytesReceived = client.UploadData("http://localhost", bytesToPost);
        var response = client.Encoding.GetString(bytesReceived);
    }
    catch (Exception ex)
    {
    }
} 
```

调用 UploadData 方法时，我收到此 HTTP 500 内部服务器错误。但是在调试时，我在“ex”对象的任何地方都看不到错误描述。如何重写此代码以便阅读错误描述？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-18T20:36:23.413

Web 服务器通常会返回包含更多详细信息的错误页面（HTML 或纯文本，具体取决于服务器）。`WebException`您可以通过从其属性中捕获和读取响应流来获取它`Response`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-31T21:59:51.980

我找到了以这种方式进行调试的有用信息：

```
 catch (WebException ex)
        {
            HttpWebResponse httpWebResponse = (HttpWebResponse)ex.Response;
            String details = "NONE";
            String statusCode = "NONE";
            if (httpWebResponse != null)
            {
                details = httpWebResponse.StatusDescription;
                statusCode = httpWebResponse.StatusCode.ToString();
            }

            Response.Clear();
            Response.Write(ex.Message);
            Response.Write("<BR />");
            Response.Write(ex.Status);
            Response.Write("<BR />");
            Response.Write(statusCode);
            Response.Write("<BR />");
            Response.Write(details);
            Response.Write("<BR />");
            Response.Write(ex);
            Response.Write("<BR />");
        } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-18T20:30:49.837

尝试捕获 HttpException 并在其上调用 GetHtmlErrorMessage()

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-18T20:33:52.513

我一直很喜欢

```
Debug.WriteLine( ex.ToString() ); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-18T20:58:47.253

您应该使用 HttpWebRequest 和 HttpWebResponse。WebClient 是用于进行基本 Web 通信的最简单的东西，但它不提供您需要的功能。我认为这样做更好，因为它不会抛出异常。

# sql - Powershell SQLCMD

> ID：1015038
> 
> 赞同：2
> 
> 时间：2009-06-18T20:31:59.943
> 
> 标签：sql, powershell, batch-file, sqlcmd

我们在使用 Powershell 和 SQLCMD 时遇到问题，当 -v 参数变量中存在 sapces 时，powershell 不会运行该命令。

例如

```
sqlcmd ... -v VAR="Some space" 
```

有没有人经历过这种情况或知道如何解决这个问题？

谢谢，

乙

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-08-28T23:38:32.450

上面的语法适用于 PS 命令行，但在脚本中失败。

我们在如何使这项工作上苦苦挣扎了很长时间。我们其中一位非常聪明的 QA 人员最终提出了以下建议：

```
$variableWithSpaces="one two three"
$mySqlCmd = "sqlcmd -E -S $dbServer -i $script  -v var=```"$variableWithSpaces```" "
Invoke-Expression $mySqlCmd 
```

插头丑陋，但它的工作原理。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-18T20:54:39.693

Powershell 实际上会将参数作为`"VAR=Some space"`. 也许 sqlcmd 绊倒了这一点。通过使用

```
VAR=`"一些空间`"

```

相反，它将作为`VAR="Some space"`. 也许这可以解决问题。

# php - Query that works in SQL but not in PHP

> ID：1015041
> 
> 赞同：2
> 
> 时间：2009-06-18T20:32:29.863
> 
> 标签：php, sql, mysql

I am having trouble with an SQL query that I have inserted into a piece of PHP code to retrieve some data. The query itself works perfectly within SQL, but when I use it within my PHP script it says "Error in Query" then recites the entire SQL statement. If I copy and paste the SQL statement from the error message directly into MySQL it runs with no errors.

From my research I believe I am missing an apostrophe somewhere, so PHP may be confusing the clauses, but I am not experienced enough to know where to insert them.

The query is using a variable called $userid which is specified earlier in the PHP script.

```
$sql= <<<END

SELECT sum(final_price)  
FROM (
    SELECT Table_A.rated_user_id, Table_B.seller, Table_B.final_price
    FROM Table_A
       INNER JOIN Table_B ON Table_A.id=Table_B.id
) AS total_bought
WHERE seller != $userid
AND rated_user_id = $userid

    UNION ALL

SELECT sum(final_price)  
FROM (
    SELECT Table_A.rated_user_id, Table_C.seller, Table_C.final_price
    FROM Table_A
        INNER JOIN Table_C ON Table_A.id=Table_C.id
) AS total_bought
WHERE seller != $userid
AND rated_user_id = $userid

END; 
```

After this section the script then goes on to define the output and echo the necessary pieces as per usual. I'm happy with the last part of the code as it works elsewhere, but the problem I am having appears to be within the section above.

Can anyone spot the error?

**Edited to add the following additional information:**

All of the fields are numerical values, none are text. I have tried putting '$userid' but this only makes the error display the ' ' around this value within the error results. The issue remains the same. Adding parenthasis has also not helped. I had done a bit of trial and erorr before posting my question.

If it helps, the last part of the code bieng used is as follows:

```
$result = mysql_query($sql);
if (!$res) {
  die('Error: ' . mysql_error() . ' in query ' . $sql);
}
$total_bought = 0;
while ($row = mysql_fetch_array($result)) {
  $total_bought += $row[0];
}
$total_bought = number_format($total_bought, 0);
echo '<b>Your purchases:  '  . $total_bought . '</b>';
echo "<b> gold</b>"; 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-18T21:07:37.750

您正在检查`!$res`，它应该是`!$result`：

```
$result = mysql_query($sql);
if (!$result) {
  die('Error: ' . mysql_error() . ' in query ' . $sql);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-18T20:35:32.150

我想，您正在`echo()`某处查询并从浏览器复制粘贴它。可能是`$userid`包含 xml 标签吗？它们不会显示在浏览器中，您必须查看页面源才能发现它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-18T20:36:17.907

您应该使用引用的 $userid 进行测试，并在两个语句周围加上括号。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-18T20:43:35.800

我假设rated_user_id 是一个数字字段，但卖家是什么类型？如果它是一个字符字段，则必须按照 streetpc 的建议引用 $userid。

要检查的另一件事是，在查询的每一行的行尾之后至少有一个空格。这以前让我绊倒过。有时，当从您的编辑器/IDE 转到数据库工具时，这些问题会被默默地解决。

# java - 用java计算bittorent info_hash

> ID：1015045
> 
> 赞同：3
> 
> 时间：2009-06-18T20:34:16.990
> 
> 标签：java, hash, sha1, bittorrent, info-hash

我正在尝试计算`info_hash`种子的价值。我将整个洪流读入`StringBuffer`，然后将其剪切如下：

```
d8:announce...info[d6:length...e]e 
```

我似乎无法获得正确的哈希值。将洪流读入`StringBuffer`最后会损坏字节字符串吗？我错过了什么吗？

```
public void calculateInfoHash( ){
try{
    int index = rawData.indexOf("4:info") + 6;
    int end = rawData.length() - 1;

    String info = rawData.substring( index , end );

    MessageDigest md = MessageDigest.getInstance( "SHA" );
    md.update( info.getBytes() );
    byte[] digest = md.digest();

    for ( byte b : digest ) {
    // print byte as 2 hex digits with lead 0\. 
    //Separate pairs of digits with space
    //System.out.print( "%" );
    System.out.printf( "%02X", b & 0xff );
        }
    System.out.println( );

}catch( Exception e ) { 
    System.out.println( e.toString() );
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-18T20:40:14.497

在这种情况下，我不知道正确的算法，但是从代码的角度来看，每当您在 String 上调用 getBytes() 时，您应该始终指定一个字符集，否则它使用通常不是您想要的系统默认值。将其替换为：

```
md.update( info.getBytes("UTF-8") ); 
```

看看是否有帮助。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-06-18T20:36:58.717

您可以获取[Azureus](http://azureus.sourceforge.net/)的源代码，看看他们是如何做到的。

# python - 在 pyqt4 应用程序中记录所有异常

> ID：1015047
> 
> 赞同：11
> 
> 时间：2009-06-18T20:34:23.447
> 
> 标签：python, logging, pyqt

使用标准 python logging api 在 pyqt4 应用程序中记录所有异常的最佳方法是什么？

我尝试将 exec_() 包装在 try, except 块中，并从中记录异常，但它仅记录应用程序初始化中的异常。

作为一个临时解决方案，我将最重要的方法封装在 try 中，除了块，但这不是唯一的方法。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-06-18T21:27:06.320

你需要覆盖[`sys.excepthook`](http://docs.python.org/library/sys.html)

```
def my_excepthook(type, value, tback):
    # log the exception here

    # then call the default handler
    sys.__excepthook__(type, value, tback) 

sys.excepthook = my_excepthook 
```

# c# - 创建符合 XSD 模式的 XML 文档的最佳方法是什么？

> ID：1015054
> 
> 赞同：3
> 
> 时间：2009-06-18T20:36:02.477
> 
> 标签：c#, xml, xml-serialization, xsd

我有一个 XSD，我必须生成一个 XML 文档以发送给与我合作的公司的客户。我发送的文档将根据此 XSD 架构进行验证。

创建符合 XSD 模式的 XML 文档的最佳方法是什么？我的意思是，我正在寻找最佳实践等。我是新手，在到处“谷歌搜索”时，我发现有人使用 XmlTextWriter、DataSet.WriteXml 等。

1.  DataSet.WriteXml 似乎不适合我。这就是我所做的：

    ```
    var ds = new DataSet();
    ds.ReadXmlSchema(schemaFile);
    ds.Tables["TableName"].Rows.Add("", "", 78, true, DateTime.Now);
    ...
    ds.WriteXml("C:\\xml.xml"); 
    ```

    我发现它使用 NewDataSet 生成了一个节点，并且这些节点的顺序不正确。

2.  XmlTextWriter，我觉得它有点长......但如果没有其他选择，我会这样做。

您认为最好的方法是什么？还有其他方法可以做到吗？如果架构不是很长，并且与问题相关，我会将架构放在这里。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-18T21:11:43.683

.NET 中的主流做法是使用[XML 序列化](http://www.bing.com/search?q=)。

在你的情况下，我会这样做：

*   在 .XSD 上也运行 xsd.exe 以生成类的源代码 (xsd /c)
*   构建利用这些生成的类的应用程序。请记住，您可以通过“部分类”技术扩展这些类
*   在代码中，实例化一个 XmlSerializer，并序列化类实例。

例子：

鉴于此架构：

```
<xs:schema elementFormDefault="qualified" xmlns:xs="http://www.w3.org/2001/XMLSchema">
  <xs:element name="Foo" nillable="true" type="Foo" />
  <xs:complexType name="Foo">
    <xs:sequence>
      <xs:element minOccurs="0" maxOccurs="1" name="Bar" type="xs:string" />
      <xs:element minOccurs="0" maxOccurs="1" name="Baz" type="UntypedArray" />
    </xs:sequence>
  </xs:complexType>

  <xs:complexType name="UntypedArray">
    <xs:choice minOccurs="1" maxOccurs="unbounded">
      <xs:element name="Type1" type="Type1"                 minOccurs="1" maxOccurs="1"/>
      <xs:any     namespace="##other" processContents="lax" minOccurs="1" maxOccurs="1"/>
    </xs:choice>
  </xs:complexType>

  <xs:complexType name="Type1" mixed="true">
    <xs:sequence>
      <xs:element minOccurs="0" maxOccurs="1" name="Child" type="xs:string" />
    </xs:sequence>
  </xs:complexType>
</xs:schema> 
```

xsd.exe 生成此源代码：

```
[System.CodeDom.Compiler.GeneratedCodeAttribute("xsd", "2.0.50727.42")]
[System.SerializableAttribute()]
[System.Diagnostics.DebuggerStepThroughAttribute()]
[System.ComponentModel.DesignerCategoryAttribute("code")]
[System.Xml.Serialization.XmlRootAttribute(Namespace="", IsNullable=true)]
public partial class Foo {

    private string barField;

    private object[] bazField;

    /// <remarks/>
    public string Bar {
        get {
            return this.barField;
        }
        set {
            this.barField = value;
        }
    }

    /// <remarks/>
    [System.Xml.Serialization.XmlArrayItemAttribute("", typeof(System.Xml.XmlElement), IsNullable=false)]
    [System.Xml.Serialization.XmlArrayItemAttribute(typeof(Type1), IsNullable=false)]
    public object[] Baz {
        get {
            return this.bazField;
        }
        set {
            this.bazField = value;
        }
    }
}

/// <remarks/>
[System.CodeDom.Compiler.GeneratedCodeAttribute("xsd", "2.0.50727.42")]
[System.SerializableAttribute()]
[System.Diagnostics.DebuggerStepThroughAttribute()]
[System.ComponentModel.DesignerCategoryAttribute("code")]
public partial class Type1 {

    private string childField;

    private string[] textField;

    /// <remarks/>
    public string Child {
        get {
            return this.childField;
        }
        set {
            this.childField = value;
        }
    }

    /// <remarks/>
    [System.Xml.Serialization.XmlTextAttribute()]
    public string[] Text {
        get {
            return this.textField;
        }
        set {
            this.textField = value;
        }
    }
} 
```

在您的应用程序中，您可以实例化一个 Foo 然后序列化，如下所示：

```
 Foo foo = new Foo();
    // ...populate foo here...
    var builder = new System.Text.StringBuilder();
    XmlSerializer s = new XmlSerializer(typeof(Foo));
    using ( var writer = System.Xml.XmlWriter.Create(builder))
    {
        s.Serialize(writer, foo, ns);
    }
    string rawXml = builder.ToString(); 
```

此示例序列化为字符串。当然，您可以序列化到其他 XmlWriter，您可以写出到文件、任意流等等。

通常我会调整序列化以省略 XML 声明，省略默认的 xml 命名空间，等等。像这样：

```
 Foo foo = new Foo();
    // ...populate foo here...
    var builder = new System.Text.StringBuilder();
    var settings = new System.Xml.XmlWriterSettings { OmitXmlDeclaration = true, Indent= true };
    var ns = new XmlSerializerNamespaces();
    ns.Add("","");
    XmlSerializer s = new XmlSerializer(typeof(Foo));
    using ( var writer = System.Xml.XmlWriter.Create(builder, settings))
    {
        s.Serialize(writer, foo, ns);
    }
    string rawXml = builder.ToString(); 
```

您也可以使用 XmlSerializer 执行相反的操作 - 从 XML 文档映射到内存中的对象图。使用反序列化方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-18T20:39:09.100

我不久前写的一篇文章可能会引起您的兴趣。我不得不使用 BizTalk，发现从 XSD 生成我的类，然后通过网络（wa-la XML）序列化该类效果很好！

[http://blog.andrewsiemer.com/archive/2008/04/30/accepting-xmldocuments-from-biztalk-de-serializing-them-to-xsd-generated-serializable.aspx](http://blog.andrewsiemer.com/archive/2008/04/30/accepting-xmldocuments-from-biztalk-de-serializing-them-to-xsd-generated-serializable.aspx)

这使您可以将数据作为一个类以及随之而来的所有好处来工作。它完全允许您绕过 XML 编写器！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-24T12:29:52.323

这样一个伟大的参考.. [http://msdn.microsoft.com/en-us/library/x6c1kb0s%28v=vs.110%29.aspx](http://msdn.microsoft.com/en-us/library/x6c1kb0s%28v=vs.110%29.aspx)

我刚刚生成了带有 csharp 字段的类：

首先打开 Visual Studio 命令提示符（**programs->visualStudio->visualstudioTools->VisualstudioCommandPrompt**）

然后切换到 xsd 文件的目录，然后运行以下命令：

```
xsd /classes /fields /language:CS MyXSDSCHEMAFILE.xsd 
```

（将 MyXSDSCHEMAFILE.xsd 替换为您的 xsd 文件名）

创建cs文件后，将其复制到所有其他cs文件所在的项目文件夹中，然后通过右键单击项目并添加现有项目将其添加到Visual Studio中的项目中。完成后，转到要使用类的代码段并像这样初始化（类名是在 cs 文件中创建的类）：

```
classname myvariablename = new classname(); // so easy :)
// now you just fill with content
myvariablename.whatever.andever.field = "JaWerHatDasErfunden";// you just set a field 
```

然后序列化为 xml（网络上的大量示例）

*有用的提示：* 请注意，实例化并不总是 xsd 创建的类的一部分。
确保正确创建对象以避免空指针异常。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-18T20:54:58.727

您可以创建 XML，然后通过[我编写的 Xml Schema Validator](http://blog.josh420.com/archives/2007/10/validate-xml-stream-against-a-schema-in-vbnet.aspx)运行它。

# database - 数据库字段中的枚举存储

> ID：1015058
> 
> 赞同：3
> 
> 时间：2009-06-18T20:36:31.370
> 
> 标签：database, enums

最好将枚举*值*或枚举*名称*存储在数据库表字段中吗？

例如，我应该将“TJLeft”存储为字符串还是数据库中的等效值？

```
Public Enum TextJustification
  TJLeft
  TJCenter
  TJRight
End Enum
```

我目前倾向于这个名字，因为有些人可能会在以后出现并明确分配一个不同的值。

*编辑*-

有些枚举在我的控制之下，但有些来自第三方。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-18T21:25:44.937

存储数值的另一个原因是，如果您在枚举中使用 [Flags] 属性，您可能希望允许多个枚举值。说，例如，您想让某人选择他们在一周中的哪些日子可以做某事......

```
[Flags] 
public enum WeekDays     
{
   Monday=1,
   Tuesday=2,
   Wednesday=4,
   Thursday=8,
   Friday=16
} 
```

在这种情况下，您可以将数值存储在 db 中的任意值组合（例如，3 == 星期一和星期二）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-01-05T14:44:04.600

对于您自己的枚举，请使用数值，原因很简单：它允许`enum`功能的每个部分，开箱即用，没有麻烦。唯一需要注意的是，在`enum`定义中，必须明确地为每个成员赋予一个数值，该数值**永远不会**改变（或者，至少在你发布第一个版本之后不会改变）。我总是在持久化到数据库中的枚举中添加一个显着的注释，这样人们就不会去更改常量。

以下是数值优于字符串标识符的一些原因：

*   这是表示值的最简单方法
*   数据库搜索/排序更快
*   降低数据库存储成本（这对于某些应用程序来说可能是一个严重的问题）
*   您可以添加而不破坏`[Flags]`您`enum`的代码和/或现有数据
*   对于`[Flags]`存储在字符串字段中：
    *   归一化不良的数据
    *   进行匹配时可能会产生误报异常（即，如果您有成员“Sales”和“RetailSales”，只需对“Sales”进行子字符串搜索即可匹配任一类型）。这必须通过在单词边界上使用正则表达式来限制（使用数据库时很挑剔，而且速度很慢），或者限制在枚举本身中，这是非标准的、容易出错且非常难以调试的。
*   对于字符串字段（无论`[Flags]`是否），如果数据库被混淆，则必须处理该字段，这极大地影响了搜索/排序代码时的能力和效率，如前所述
*   您可以在不破坏数据库代码和/或现有客户端数据的情况下重命名任何成员。
*   所需的线上数据传输空间/时间更少

只有在两种情况下使用数据库中的成员名称可能是一种优势：

*   如果您要手动进行大量数据编辑……但谁来做呢？`enum`如果你是，很有可能你无论如何都不会使用。
*   第三方枚举，他们可能不那么勤奋地维护数值常量。但我不得不说，任何发布体面编写的 API 的人都极有可能足够聪明以保持`enum`值不变。（标识符必须保持不变，因为更改它们会破坏现有代码。）

在查找表上，我强烈反对，因为它们是通往维护噩梦的单向子弹头列车：

*   添加`[Flags]`功能需要使用联结表，这意味着更复杂的查询（现有的需要重写），并增加了复杂性。现有的客户数据呢？
*   如果标识符存储在数据表中，那么首先有一个查找表有什么意义？
*   如果数值存储在数据表中，您将一无所获，因为您仍然需要从查找表中查找标识符。为了使它更容易，您可以为*每个*具有`enum`值的表创建一个视图。然后让我们甚至不要考虑`[Flags]`枚举。
*   在数据库和代码之间引入任何类型的同步都是自找麻烦。现有的客户数据呢？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-18T21:35:34.620

我总是使用由字段组成的查找表

*   OID int (pk) 作为数值
*   ProgID varchar（唯一）作为 C# 中值的标识符（即 const 名称或枚举符号）
*   ID nvarchar 作为显示值 (UI)

dbscript 让我可以从查找表中生成 C# 代码，因此我的代码始终与数据库同步。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-07-09T14:02:17.930

如果您试图取回存储在数据库中的枚举值，那么试试这个

```
EnumValue = DirectCast([Enum].Parse(GetType(TextJustification), reader.Item("put_field_name_here").ToString), TextJustification) 
```

告诉我它是否适合你

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-18T20:38:54.967

存储一个 ID（值）和一个 varchar 名称；这使您可以查询任何一种方式。如果您的 ID（值）稍后可能不同步，则搜索名称是合理的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-18T20:40:26.993

最好使用整数表示...如果您必须稍后更改 Enum（添加更多值等），您可以将整数值显式分配给 Enum 值，以便您在代码中的 Enum 表示仍然与您在数据库。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-18T20:43:25.160

这取决于性能与可读性的重要性。数据库可以比字符串更容易地索引数值，这意味着您可以获得更好的性能而无需使用太多内存。它还会在一定程度上减少通过网络传输的数据量。另一方面，当您查看数据库中的数值时，您必须参考代码文件进行翻译，这可能很烦人。

在大多数情况下，我建议使用该值，但您需要确保明确设置这些值，以便将来添加值时不会改变引用。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-18T20:58:36.020

通常它取决于很多事情：

你想按枚举的自然顺序排序吗？使用数值。您是否使用低级工具直接在数据库中工作？使用名称。您是否拥有大量数据并且性能存在问题？使用号码

对我来说，最重要的问题是大部分时间的可维护性：

如果您的枚举在未来发生变化，名称将正确匹配或失败。使用数字可以添加一个枚举实例，更改所有枚举的所有数字，因此您必须更新使用枚举的所有表。几乎没有办法知道你是否错过了一张桌子。

# perl - CSV 转换成哈希

> ID：1015061
> 
> 赞同：4
> 
> 时间：2009-06-18T20:37:24.533
> 
> 标签：perl, hash

我有一个 csv，第一列是一个标签，后跟逗号分隔值：

```
LabelA,45,56,78,90
LabelB,56,65,43,32
LabelC,56,87,98,45 
```

我希望第一列（LabelA 等）成为哈希中的键，其中包含数组中的数值。

我可以将文件读入数组或标量，但我不确定之后该怎么做。建议？？

编辑：好的，所以看起来这将值分配给一个键..但是在我的示例中逗号分隔的数字呢？他们要去哪？他们在 %hash 中吗？如果是这样，您是否可以进一步降低您的解释？谢谢。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-06-18T21:13:55.957

就个人而言，我喜欢[Text::CSV_XS](http://search.cpan.org/perldoc?Text::CSV_XS)和[IO::File](http://www.perl.com/doc/manual/html/lib/IO/File.html)模块：

```
use Text::CSV_XS;
use IO::File;

# Usage example:
my $hash_ref = csv_file_hashref('some_file.csv');

foreach my $key (sort keys %{$hash_ref}){
   print qq{$key: };
   print join q{,}, @{$hash_ref->{$key}};
   print qq{\n};
}

# Implementation:
sub csv_file_hashref {
   my ($filename) = @_;

   my $csv_fh = IO::File->new($filename, 'r');
   my $csv = Text::CSV_XS->new ();

   my %output_hash;

   while(my $colref = $csv->getline ($csv_fh))
   {
      $output_hash{shift @{$colref}} = $colref;
   }

   return \%output_hash;
} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-06-18T21:07:06.860

好吧，让我们假设没有特殊字符等等。

首先打开文件：

```
open my $fh, '<', 'some.file.csv' or die "Cannot open: $!"; 
```

然后你在循环中读取它：

```
while (my $line = <$fh>) { 
```

之后，您删除尾随的白色字符（\n 和其他字符）：

```
$line =~ s/\s*\z//; 
```

并将其拆分为数组：

```
my @array = split /,/, $line; 
```

当它在数组中时，您会从数组中获取第一个元素：

```
my $key = shift @array; 
```

并将其存储在哈希中：

```
$hash{$key} = \@array; 
```

（\@array 表示对数组的引用）。

整个代码：

```
my %hash;
open my $fh, '<', 'some.file.csv' or die "Cannot open: $!";
while (my $line = <$fh>) {
  $line =~ s/\s*\z//;
  my @array = split /,/, $line;
  my $key = shift @array;
  $hash{$key} = \@array;
}
close $fh; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-18T20:57:13.060

请参阅[perlfunc split](http://perldoc.perl.org/functions/split.html)和[perldsc](http://perldoc.perl.org/perldsc.html)。

1.  阅读每一行。
2.  剁碎吧
3.  用逗号分割它。
4.  使用结果中的第一个值作为您的 HoA 的键。
5.  其他值成为数组。
6.  将数组的引用存储在键下的哈希中。
7.  ...
8.  利润！！！

对数组引用进行[哈希处理](http://perldoc.perl.org/perldsc.html#HASHES-OF-ARRAYS)：

您的数据结构应如下所示：

```
my %foo = (
    LabelA => [  2, 3,  56, 78, 90 ],
    LabelB => [ 65, 45, 23, 34, 87 ],
    LabelC => [ 67, 34, 56, 67, 98 ],
); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-08-13T21:55:30.043

## [文本::CSV::Hashify](http://search.cpan.org/~jkeenan/Text-CSV-Hashify-0.08/lib/Text/CSV/Hashify.pm)

将 CSV 文件转换为 Perl 哈希：

```
# Simple functional interface
use Text::CSV::Hashify;
$hash_ref = hashify('/path/to/file.csv', 'primary_key');

# Object-oriented interface
use Text::CSV::Hashify;
$obj = Text::CSV::Hashify->new( {
        file        => '/path/to/file.csv',
        format      => 'hoh', # hash of hashes, which is default
        key         => 'id',  # needed except when format is 'aoh'
        max_rows    => 20,    # number of records to read; defaults to all
        ... # other key-value pairs possible for Text::CSV
} );

# all records requested
$hash_ref       = $obj->all; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-10-29T15:26:16.357

我认为这也可以更轻松地工作。

$refhash 变量将是对哈希数组的引用。

每个散列包含标题（作为散列键）和一个 CSV 行的值。该数组包含 CSV 中所有行的哈希值。

```
use Text::CSV_XS qw( csv );
$refhashvariable = csv(
    in      => "$input_csv_filename",
    sep     => ';',
    headers => "auto"
);    # as array of hash 
```

这对我有用。如果 CSV 没有标题，我还没有尝试过。

# java - 使用 GWT 从/向 Java 发送对象

> ID：1015070
> 
> 赞同：5
> 
> 时间：2009-06-18T20:40:11.190
> 
> 标签：java, google-app-engine, gwt, google-cloud-datastore

为了学习 GWT 和 Google AppEngine (GAE)，我尝试使用带有两个或三个对象（实体）的 GWT 创建一个简单的应用程序。在这个应用程序中，一个对象，比如**Student**封装了其他对象的 ArrayList，比如**Classes**和**Books**。然后它创建学生列表并将其发送到 GAE 上的 Java 代码并将其存储到数据存储中。

问题：*是否可以使用 GWT + GAE + Google DataStore 来做这种事情？是否有同时使用所有这些技术的示例/教程？*

使用这项技术是否值得。此时堆栈？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-19T05:20:17.590

我建议如下：

1.  完成[GWT StockWatcher 教程](http://code.google.com/webtoolkit/tutorials/1.6/gettingstarted.html)。如果您还没有，这将帮助您了解 GWT 的基础知识。
2.  继续[学习 GWT 和 App Engine 教程](http://code.google.com/webtoolkit/tutorials/1.6/appengine.html)。这将向您展示如何修改 StockWatcher 代码以使用 Google App Engine 并将简单数据类型存储在 Google DataStore 中。
3.  最后，按照我在此[StackOverflow 答案](https://stackoverflow.com/questions/958879/problems-passing-class-objects-through-gwt-rpc/962823#962823)中概述的步骤进行操作。这将向您展示如何进一步修改 StockWatcher 代码以返回 Stock 对象的 ArrayList 而不仅仅是一个简单的字符串数组。

上述教程唯一无法帮助您的部分是将对象的 ArrayList 存储在 Google DataStore 的可持久对象中。我不确定这是否真的可行；您可能必须分别存储每个对象类型，然后使用 GQL以编程方式检索与特定**学生相关的****课程**和**书籍。**

 *** * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-18T21:52:16.113

您可能想查看[Gilead](http://noon.gilead.free.fr/gilead/)和它的[Google AppEngine 适配器](http://noon.gilead.free.fr/gilead/index.php?mact=News,cntnt01,detail,0&cntnt01articleid=7&cntnt01returnid=15)。甚至还有一个[示例项目](http://gilead.svn.sourceforge.net/viewvc/gilead/samples/trunk/GWT/SampleAppEngine.JDO/)。我已经让它在 Eclipse 中的本地机器上运行，但是在将它部署到 GAE 时我不断收到错误。**

# python - 是否可以覆盖用于调用 Django 的管理员删除确认页面的方法？

> ID：1015072
> 
> 赞同：6
> 
> 时间：2009-06-18T20:40:14.823
> 
> 标签：python, django, django-admin

在 Django 的管理页面上，我想在管理员单击对象的删除按钮时执行一个操作。换句话说，我想在到达“你确定吗？”之前执行一些代码。删除确认页面。

我意识到我可以覆盖这个对象的模板页面，但我希望有更简单的东西（即覆盖模型或表单上的方法）。

有什么想法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-18T21:37:38.780

您可以覆盖`ModelAdmin.delete_view()`方法，例如：

```
class MyModelAdmin(ModelAdmin):
    def delete_view(self, request, object_id, extra_context=None):
        # if request.POST is set, the user already confirmed deletion
        if not request.POST:
            perform_my_action()
        super(MyModelAdmin, self).delete_view(request, object_id, extra_context) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-01-16T22:16:36.040

我们可以使用 django.shortcuts.redirect 来中断删除，像这样：

```
def check_del(self, object_id):
    produkt = Produkt.objects.get(id = object_id)
    if produkt.typsklepu_set.all():
        return False
    else:
        return True

def delete_view(self, request, object_id, extra_context=None):
    # if request.POST is set, the user already confirmed deletion
    if not request.POST and self.check_del(object_id):
        return super(ProduktAdmin, self).delete_view(request, object_id, extra_context)
    elif request.POST:
        return super(ProduktAdmin, self).delete_view(request, object_id, extra_context)
    else:
        msg = u'Can not delete this object.'
        messages.error(request, msg)
        return redirect('..') 
```

# c++ - 如何在 Eclipse C++ 项目中创建两个主电源

> ID：1015074
> 
> 赞同：8
> 
> 时间：2009-06-18T20:40:42.280
> 
> 标签：c++, eclipse, makefile

我们有一个单独运行的程序，使用 execvp 命令执行。所以它需要一个主要的方法，但我认为这会给使用托管制作的 Eclipse 带来问题。我们是否必须将此代码隔离到一个单独的项目中，或者有没有办法将它合并到同一个 Eclipse 项目中？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-23T16:12:21.820

为每个具有 main() 函数的可执行文件创建一个项目，并创建一个附加项目来代表整个软件（某种“容器”项目）。Eclipse 允许您将项目指定为其他项目的依赖项，在这种情况下，您需要设置容器项目以将其他项目列为“引用项目”。

为此，请创建容器项目，然后右键单击左侧列（项目资源管理器）中的项目，然后单击“属性”。将出现一个对话框。选择左侧列表中的“Project References”项，您将看到 Eclipse 当前正在处理的所有项目的列表。选中您的各个可执行文件的项目旁边的框，然后单击“确定”。现在，当您在容器项目上执行构建时，Eclipse 也应该自动在这些依赖项目上执行构建。

当以这种方式使用子项目时，我（个人）发现创建一个包含容器项目和所有子项目的工作集很有用（这可以使搜索整个软件项目更容易）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-19T18:59:03.550

将其保存在同一个项目中，并使用预处理器定义您定义的内容，具体取决于您要在当前项目中包含的主要类型。在这里，主电源位于同一个文件中，但它们当然可以驻留在不同的文件中。

```
#if defined(MAIN_ONE)
int main()
{
    // Do stuff
}
#elif defined(MAIN_TWO)
int main()
{
    // Do some other stuff
}
#endif 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-18T21:17:50.817

如果被调用的 makefile 没有将 2 个 main() 方法编译到同一个可执行文件中，它不会导致问题。我不知道如何处理 eclipse 项目 - 如果它像 VS，其中“项目”表示单个可执行文件或库，而“解决方案”是一组“项目”，那么您似乎需要多个项目。如果，OTOH，“项目”可以包含不同的“子项目”，其中“子项目”是可执行文件或库，您应该能够轻松处理。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-21T14:25:10.227

我不知道使用 Eclipse 构建系统构建两个主要的任何简单方法。您需要做的最小更改可能是移动到 makefile 并使用 makefile 目标进行构建。

相反，我建议您转而使用 CMake。CMake 可用于生成与 eclipse 一起使用的 makefile。使用 CMake 获得的好处是，您可以轻松说明如何构建库并链接库以形成可执行文件。CMake 可以为 Eclipse、Visual Studio、代码块或 makefile 生成构建（因此您可以使用命令提示符）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-06-20T21:55:17.273

这是用 C++ 语言构建的。你必须修改它才能得到你的结果。如果这是您想要的，则可以同时做**两件事。**

# .net - 为什么 IronPython 启动时间这么慢？

> ID：1015076
> 
> 赞同：12
> 
> 时间：2009-06-18T20:41:02.670
> 
> 标签：.net, performance, ironpython

我已经使用 IronPython 有一段时间了，但真正阻碍我开发的是它的启动速度非常慢*。*我喜欢这种语言及其工作方式，但在它开始执行我的代码之前必须等待超过 20 秒是令人沮丧的。

我已经进行了一些挖掘，似乎问题不在于`import`ing，而是在那个阶段之前。

谢谢。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-06-18T21:52:31.653

我们正在努力在 2.6 中解决这个问题。您今天可以[下载 Beta 1](http://ironpython.codeplex.com/Release/ProjectReleases.aspx?ReleaseId=25126)，您可能会看到启动时间大大缩短。

问题是大部分时间一般都花在 JITing 代码上。如果您在 64 位机器上，这一点尤其明显，因为 64 位速度较慢。在 2.6 中，我们现在延迟编译，直到它们第一次真正运行，如果它们只需要一次或两次就解释它们，并且我们将在运行时生成的一堆代码移到 IronPython.dll 中，所以它太受益于ngen。应用程序越大，您可能会从所有这些更改中看到更大的改进。

如果您在安装 IronPython 时没有检查 ngen 选项，您可以通过执行“ngen install ipy.exe”从命令行返回并对其进行 ngen。ngen.exe 在 C:\Windows\Microsoft.NET\Framework\v2.0.50727\ngen.exe 或 C:\Windows\Microsoft.NET\Framework64\v2.0.50727\ngen.exe 中，如果您使用的是 64-位机。但它需要是管理员命令提示符。这将为您今天在稳定版本上带来一些好处。如果您使用的是 64 位，即使您选中了该框，您也需要执行此操作 - 存在阻止 ngen 在 64 位上正常工作的错误。

# asp.net-mvc - Linq Select 语句 - 不在的地方

> ID：1015081
> 
> 赞同：6
> 
> 时间：2009-06-18T20:42:04.680
> 
> 标签：asp.net-mvc, linq

我正在尝试编写相当于以下内容的 LINQ 语句：

```
select e.EmployeeID, EmployeeName = e.FirstName + ' ' + e.LastName
from Employees e
where e.EmployeeID not in
(
    select EmployeeID from Managers
) 
```

我认为我与以下内容非常接近：

```
from e in Employees
where e.EmployeeID !=    // This is where I'm lost
(
    from m in Managers select m.EmployeeID
)
select new
{
    e.EmployeeID,
    EmployeeName = e.FirstName + ' ' + e.LastName
} 
```

我正在尝试将其放入 Html.DropDownList 中。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-18T20:47:08.150

我不完全确定正确的查询符号是什么，但下面的扩展语法将完成工作

```
var result = Employees
  .Where( e => !Managers.Where(m => m.EmployeeId == e.EmployeeId).Any())
  .Select( e => new { EmployeeId = e.EmployeeId, EmployeeName = e.FirstName + ' ' + e.LastName); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-19T03:14:45.310

使用`Any`：

```
from e in Employees
where !Managers.Any(m => m.EmployeeID == e.EmployeeID)
select new
{
    e.EmployeeID,
    EmployeeName = e.FirstName + ' ' + e.LastName
} 
```

或者，使用左连接：

```
from e in Employees
join m in Managers on e.EmployeeID equals m.EmployeeID into managerGroup
from m in managerGroup.DefaultIfEmpty()
where m == null
select new
{
    e.EmployeeID,
    EmployeeName = e.FirstName + ' ' + e.LastName
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-22T14:46:11.663

您可以通过[Linq.Except() 的流畅实现](http://www.codeproject.com/KB/linq/Fluid_Linq_Except.aspx)获得所需的结果：

```
List<Employee> employees = new List<Employee>
    {
        new Employee { EmployeeID = 1, FirstName = "John", LastName = "Smith" },
        new Employee { EmployeeID = 2, FirstName = "Jane", LastName = "Doe" },
        new Employee { EmployeeID = 3, FirstName = "Eddie", LastName = "Punchclock" }
    };
List<Employee> managers = new List<Employee>
    {
        new Employee { EmployeeID = 2, FirstName = "Jane", LastName = "Doe" },
    };
var nonManagerEmployees = employees.Except(managers, x => x.EmployeeID)
    .Select(x => new
        {
            x.EmployeeID,
            EmployeeName = x.FirstName + " " + x.LastName
        });

foreach(var entry in nonManagerEmployees)
{
    Console.WriteLine(entry.EmployeeID+" "+entry.EmployeeName);
} 
```

输出：

```
1 John Smith
3 Eddie Punchclock 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-18T20:46:48.057

使用 .Contains() 方法并插入 ! 创建 NOT 样式语法。

这将是 {collection}.Contains(this != to that);

您也可能对此感兴趣：http: [//srtsolutions.com/blogs/billwagner/archive/2006/04/10/linq-samples-part-11.aspx](http://srtsolutions.com/blogs/billwagner/archive/2006/04/10/linq-samples-part-11.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-18T20:49:22.543

这是一篇关于在 LINQ 中使用 IN 语句的文章。用一点肘部油脂我相信你可以修改技术来做一个 NOT IN。

[http://blogs.msdn.com/alexj/archive/2009/03/26/tip-8-writing-where-in-style-queries-using-linq-to-entities.aspx](http://blogs.msdn.com/alexj/archive/2009/03/26/tip-8-writing-where-in-style-queries-using-linq-to-entities.aspx)

# android - 为什么我的动画会留下痕迹？

> ID：1015082
> 
> 赞同：9
> 
> 时间：2009-06-18T20:42:14.773
> 
> 标签：android, user-interface, animation

我正在使用翻译动画从屏幕的左侧到右侧为 ImageView 设置动画。ImageView 使用 FrameLayout 放置在我的主布局顶部的 RelativeLayout 内。

当我在模拟器上运行动画时，一切正常，但是当我在 G1 上运行它时，它会留下视觉伪影并影响其背后的文本组件的渲染。

这是一个性能问题，我过于雄心勃勃，还是我可以克服的错误？

如果是性能问题，我能做些什么来改进吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-02-17T15:34:21.193

我在 2.3 上也遇到了同样的问题。

在 Animation.applyTransformation 中使移动视图的容器无效（移动视图所在的布局）为我修复了它。

看：

[Android - 使用动画的工件](https://stackoverflow.com/questions/7652861/android-artifacts-using-animation)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-06-29T14:39:15.457

我现在这可能有点老了，但我刚刚发现：

[http://groups.google.com/group/android-developers/browse_thread/thread/5481450f8b71a26c/e750730b9953d9a8?lnk=gst&q=animation+leaves+trails#e750730b9953d9a8](http://groups.google.com/group/android-developers/browse_thread/thread/5481450f8b71a26c/e750730b9953d9a8?lnk=gst&q=animation+leaves+trails#e750730b9953d9a8)

不确定您使用的是什么 android 版本，但它可能是 android 库中的错误！

看来这就是我的问题所在！:)

... Dontcha 只是喜欢它，当它不是你的错时！:D

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-03-01T22:00:13.637

这是我发现的一种解决方法，它为我解决了这个问题：“一个简单的解决方法是在右侧/底部用一个小的（1 像素应该这样做）透明区域填充您的图像 - 这不会影响它的外观，但它会强制使比实际图像稍大的区域失效，从而弥补错误。”

[http://code.google.com/p/android/issues/detail?id=22151](http://code.google.com/p/android/issues/detail?id=22151)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-18T20:46:06.170

在没有真正看到问题的情况下，听起来好像您在写入下一帧之前没有清除显示缓冲区。对我来说，这听起来不像是性能问题。

您是否可以控制设备是否进行双缓冲？

鉴于它可以在模拟器上运行，这可能指向模拟器的问题或代码中未显示在模拟器上的错误（我认为这在技术上是模拟器的问题！）而不是性能问题.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-24T23:00:40.043

我建议使用[SurfaceView](http://developer.android.com/reference/android/view/SurfaceView.html)动画。它是双缓冲的，因此如果使用得当，它应该可以消除闪烁。如果你想要一个例子，SDK 中包含的 LunarLander 演示很好地展示了这一点。此外，如果您对代码有更具体的问题，请提出来。

至于一般的 Android 性能，很有可能有相当高的帧速率，所以你不要期望太高。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-07-09T23:43:12.453

这也发生在我身上。我正在使用 1.6 和 Google API 的模拟器，我刚刚确认它发生在运行 FRF83 的 Nexus One 上。以下是相关代码：

```
Animation a = new TranslateAnimation(0.0f, 0.0f, 100.0f, 0.0f);
a.setDuration(2000);
this.myView.startAnimation(a); 
```

下面是实例化视图的相关代码：

```
View v = new View(this.getApplication());
LinearLayout.LayoutParams params = new LinearLayout.LayoutParams(ViewGroup.LayoutParams.FILL_PARENT, 80);
v.setLayoutParams(params);
v.setBackgroundColor(0xFFFF0000);
//
LinearLayout layout = (LinearLayout)this.findViewById(R.id.theLayout);
layout.addView(v);
//
v.setOnClickListener(new View.OnClickListener() {

        public void onClick(View arg0) {
        // TODO Auto-generated method stub
        doAnimation();
    }
});
//
myView = v; 
```

所以基本上，双缓冲等是由操作系统处理的，我根本无法控制它。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-08-01T12:16:11.743

我在 Android 2.3 上遇到了类似的问题，因此该错误可能仍然存在。我正在使用带有一些透明部分的 PNG 的 ImageView。当使用 TranslateAnimation 进行动画处理时，此图像视图会留下痕迹。为图像视图使用假背景可绘制消除了痕迹（我使用可绘制作为背景）。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-03-18T00:13:31.270

我在 Jelly bean 上发现了这一点，我在执行一些动画时在画廊视图中体验到了这一点。它看起来更像是绘图问题而不是 cpu ....

让您的活动实现接口 AnimatorListener ..... 覆盖下面的方法并选择要在其中重绘视图的方法

```
 @Override
public void onAnimationEnd(Animator animation) {
    // TODO Auto-generated method stub

    mView.requestLayout();
    Toast.makeText(this, "animation ended", 0).show();
}

@Override
public void onAnimationRepeat(Animator animation) {
    // TODO Auto-generated method stub
    mView.requestLayout();
}

@Override
public void onAnimationStart(Animator animation) {
    // TODO Auto-generated method stub
    mView.requestLayout();
} 
```

# django - 保存 inlineformset_factory 数据

> ID：1015086
> 
> 赞同：2
> 
> 时间：2009-06-18T20:43:03.273
> 
> 标签：django, django-forms

```
@render_to('edit_operation.html')       
def edit_operation(request, pk):
    from forms import OpBaseForm, OperationForm
    from django.forms.models import inlineformset_factory

    op = Operation.objects.get(pk=pk)

    OpBaseFormSet = inlineformset_factory(Operation, OpBase, form=OpBaseForm, extra=5, )

    if request.method == "POST":
        form    = OperationForm(request.POST, instance=op)
        formset = OpBaseFormSet(request.POST, instance=op)

        if formset.is_valid() and form.is_valid():
            form.save()
            formset.save()   #error here

            return HttpResponseRedirect( op.get_absolute_url() )
    else:
        form    = OperationForm(instance=op)
        formset = OpBaseFormSet(instance=op)

    return {'operation': op, 'opform': form, 'formset': formset} 
```

这看起来很简单，但是每当我尝试提交数据（甚至是未更改的数据）时，我都会收到此错误：

```
环境：

请求方法：POST
请求网址：http://localhost:8000/edit/operation/1/
Django 版本：1.0.2 最终版
Python版本：2.6.2
已安装的应用程序：
['主要的'，
 'django_extensions',
 'django.contrib.comments',
 'django.contrib.admindocs',
 'django.contrib.admin',
 'django.contrib.auth',
 'django.contrib.contenttypes',
 'django.contrib.sessions',
 'django.contrib.sites',
 'django.contrib.gis',
 'django.contrib.humanize',
 '登记']
已安装的中间件：
('django.middleware.common.CommonMiddleware',
 'django.contrib.sessions.middleware.SessionMiddleware',
 'django.contrib.auth.middleware.AuthenticationMiddleware')

追溯：
get_response 中的文件“/usr/lib/python2.6/dist-packages/django/core/handlers/base.py”
  86\. 响应 = 回调（请求，*callback_args，**callback_kwargs）
包装器中的文件“/usr/lib/python2.6/dist-packages/annoying/decorators.py”
  55\. 输出 = 函数（请求，*args，**kwargs）
编辑操作中的文件“/home/chris/Websites/jobmap/main/views.py”
  68.formset.save()
保存文件“/usr/lib/python2.6/dist-packages/django/forms/models.py”
  389\. return self.save_existing_objects(commit) + self.save_new_objects(commit)
save_existing_objects 中的文件“/usr/lib/python2.6/dist-packages/django/forms/models.py”
  403\. obj = existing_objects[form.cleaned_data[self._pk_field.name]]

异常类型：/edit/operation/1/ 处的 KeyError
异常值：无

```

任何人都知道是什么导致了这个错误？如果表单集中有错误，那么`formset.is_valid()`“真”在做什么？任何人至少对如何调试它以找出问题所在有任何想法？两种形式单独使用时都可以正常工作，`{{formset.management_form}}`我的模板中有。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T01:00:33.317

只是一个快速的猜测......你的 OpBaseForm 不包括模型 pk 吗？或者，您是否缺少模板中的 pk 字段？换句话说，如果您自己布置字段，您仍然需要包含 pk 字段，即使它是隐藏的。

# reporting-services - SSRS - 如何建立一个简单的多栏报告？

> ID：1015098
> 
> 赞同：8
> 
> 时间：2009-06-18T20:45:18.277
> 
> 标签：reporting-services

我正在使用 SQL Server 2008，我想在报告的多列中显示表中的 1 个单个字段。就像我要打印标签一样。我怎样才能做到这一点？

例子：

而不是打印：

## 姓名报告

Andrea
Austin
Barbara
Bob
Bruno
Cathy
Chis
...

我想分列打印（比如 3 个固定列）：

## 姓名报告

安德里亚----布鲁诺----达伦
奥斯汀----凯茜----弗朗西斯
芭芭拉----奇斯----加布里埃尔
鲍勃----大卫----杰拉德
...... . ---- ....... ---- .......

**编辑：**如果我运行报告并单击“打印布局”按钮，我可以看到多个列。我可以将此模式设置为默认模式吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2011-03-22T18:49:13.273

For Horizontal layout of labels...

One choice is to use the columns property on the report or body elements. This doesn't always display correctly On reportviewer. I've noticed that even if it displays correctly on your IDE and when you export to PDF. In the report viewer it will display only one column. Also it snakes the labels top to bottom then left to right.

One choice is to use a matrix and group on every 3 rows (if you want 3 columns).

This one is a little complicated.

My solution of choice is to put 3 vertical lists on the page. put the same label in each list. Return the row number in your dataset. Then just filter each list on modulo 3

For example

Result set

```
RIndex Fname
1 abe
2 burt
3 fred
4 george 
```

Filter expressions

```
list 1 -> =Fields!RIndex.Value mod 3 = =1
list 2 -> =Fields!RIndex.Value mod 3 = =2
list 3 -> =Fields!RIndex.Value mod 3 = =0 
```

Result

```
Abe Burt Fred 
George 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-06-06T06:23:43.120

The method I use is a bit similar as what Vern suggested but differs enough to make it worth mentioning here.

You can combine the ROW_NUMBER with the modulo (%) operator directly in the query to fabricate the column number in which the record should get displayed. Here's an example that generates one while taking a group into account:

```
declare @numberOfColumns int = 4;

select dpc.EnglishProductCategoryName, dp.ProductAlternateKey
    , (ROW_NUMBER() OVER (
        PARTITION BY dpc.EnglishProductCategoryName
        ORDER BY dp.ProductAlternateKey) + @numberOfColumns - 1) % @numberOfColumns + 1
    as DisplayColumn
from dbo.DimProduct dp
inner join dbo.DimProductSubcategory dps on dps.ProductSubcategoryKey = dp.ProductSubcategoryKey
inner join dbo.DimProductCategory dpc on dpc.ProductCategoryKey = dps.ProductCategoryKey; 
```

To get this displayed I'm using nested tables which are then filtered on DisplayColumn.

Have a read through following article for all the details: [Creating Multiple-Column Reports](http://blog.hoegaerden.be/2012/11/01/creating-multiple-column-reports/)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-18T21:17:52.720

使用 Visual Studio 中的“报告”菜单并选择“报告属性”。您可以在“布局”选项卡中设置列。

试试这篇关于*时事通讯式报告*的 msdn 文章了解更多详细信息：http: [//msdn.microsoft.com/en-us/library/ms159107.aspx](https://docs.microsoft.com/en-us/previous-versions/sql/sql-server-2008-r2/ms159107(v=sql.105))

此方法确实有一个限制，因此在某些情况下它可能不适用：

> 只有 PDF 和图像渲染器支持时事通讯样式的报告。

编辑：所以一种方法是使用带有过滤器的多个 tablix，该过滤器检查 RowNumber 并相应地显示每个表中的特定记录。

The other way is called **Newsletter-style report** [(link)](https://docs.microsoft.com/en-us/previous-versions/sql/sql-server-2008-r2/ms159107(v=sql.105)). This formatting is retained only when report is exported as PDF or Image. It can be previewed only when you select 'Print Layout' on the Preview tab in Visual Studio. Here is an example:

1.  Create a new report with the foll. dataset: `SELECT ID,NAME FROM TABLENAME`
2.  Add a new table to the report and select the ID and Name as columns
3.  Click on the tablix and press F4 to edit the tablix properties. In the properties window, change the Size - set the width to 2in
4.  Click on the report area outside the report page boundary and press F4 to edit the report properties. In the properties window, change the Column value to 3, and column spacing value to 0.1
5.  On the report scroll to the right hand side, you will notice that there are 2 new columns (so totally 3 columns on the report - because you selected 3 in step 4 above). Now click on the margin at the start of the column 2 and pull it further to the left to bring it as close to the column 1\. This is only to reduce the need for huge page size.
6.  Right click on the report area outside the report page boundary and select Report Properties. Change the Page Size - Set the width to 10in
7.  Preview the report. Now select the 'Print Layout' tab to see the result. This formatting is retained only when report is exported as PDF or Image.

As noted in points 5 and 6 - since the report body flows into multiple columns, you must ensure that the page size is at-least equal to -> ([Original report body size times the number of columns] + all the column spacing values). Otherwise it will look messy.

# cruisecontrol.net - 如何为 CCnet 每晚构建设置 nant 目标？

> ID：1015108
> 
> 赞同：0
> 
> 时间：2009-06-18T20:46:35.793
> 
> 标签：cruisecontrol.net, nant

我有一个默认的 nant 构建，它在 CC.net 中的每次签入时运行。我想做的是每晚在同一构建下运行一个不同的 nant 任务，该任务将在第二天对代码库进行干净的检查。

cc.net 可以吗？我已经使用 TeamCity 完成了它，并且我对 cc.net 生疏了，因为我有一段时间没有使用它了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-18T20:54:12.643

是的。您可以在 CruiseControl 中创建一个运行正常构建的新项目，也可以让它运行单独的构建（根据您的需要）。然后安排此项目在特定时间（早上）运行。

试试这个：[http ://cruisecontrol.sourceforge.net/main/configxml.html](http://cruisecontrol.sourceforge.net/main/configxml.html)

或者这个：[http ://confluence.public.thoughtworks.org/display/CCNET/Schedule+Trigger](http://confluence.public.thoughtworks.org/display/CCNET/Schedule+Trigger)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T08:05:34.223

CruiseControl.Net 会将构建触发条件传递给您的 NAnt 脚本。[因此，您的构建可以根据设置为"IfModificationExists" 或 "ForceBuild"](http://confluence.public.thoughtworks.org/display/CCNET/NAnt+Task)的属性 CCNetBuildCondition 调用不同的目标。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-18T20:55:12.360

我认为您正在寻找的是将触发器设置为预设时间。有这个设置。下面的示例来自 CC.NET 站点。

```
 <scheduleTrigger time="23:30" buildCondition="ForceBuild" name="Scheduled">
       <weekDays>
           <weekDay>Monday</weekDay>
       </weekDays>
    </scheduleTrigger> 
```

您可以在需要的时候进行构建，如果您不想一次完成所有事情，您可以使用该触发器制作项目，专注于代码的较小方面。这就是让 CC.NET 在给定时间开始构建的方式。

更多关于 Confluence[网站上的 Schedule Triggers 的信息](http://confluence.public.thoughtworks.org/display/CCNET/Schedule+Trigger)

# vb.net - 强制表格出现在屏幕上

> ID：1015111
> 
> 赞同：-1
> 
> 时间：2009-06-18T20:47:07.417
> 
> 标签：vb.net

有没有办法强制表单处于活动状态并显示？

从我正在做的另一种形式：

```
Me.Hide
Form2.Show 
```

运行此代码时，Form2 被最小化。

我也试过：

```
Me.WindowState = FormWindowState.Normal 
```

在加载事件中，它仍然以最小化模式加载它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-18T20:53:46.793

试试 Me.BringToFront(); 或者您可以将属性 TopMost 设置为 true，因此表单将始终位于顶部。

# c# - Web.config 覆盖不会影响用户控件

> ID：1015115
> 
> 赞同：1
> 
> 时间：2009-06-18T20:47:08.413
> 
> 标签：c#, asp.net, web-config

我有一个子文件夹，其中包含一个 aspx 页面和一个 web.config 文件，该文件覆盖了根目录中 web.config 中的连接字符串。问题是如果 aspx 页面包含任何用户控件，用户控件仍然从根目录中的 web.config 获取连接字符串。有没有强制他们使用父 aspx 页面使用的 web.config ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-19T06:56:56.307

我想您的用户控件位于根目录或没有 web.config 的目录中，因此它们使用根 web.config。问题的原因是这样的。

对于解决方案，我认为在您的页面中，您可以通过属性将连接字符串设置为其用户控件。或者您可以让您的用户控件使用方法通过页面访问连接字符串。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T12:20:52.803

我猜你的用户控制了用户控制实现中直接从 web.config 读取的某些位置。但是，这会将信息绑定到确实与用户控件有关的用户控件。（信息是如何获取连接字符串，而不是它自己的连接字符串）。该绑定违反了单一责任原则，并且（间接）是导致您的问题的原因。而不是读取用户控件内部的连接。将连接字符串公开为属性，并在实例化控件时让页面设置它。

更进一步进入行为良好的设计。您的用户控件可能甚至不应该知道连接字符串，而是应该有一个工作类，或者甚至更好，您可能想要重写以拥有一个用于显示目的的控件、一个用于检索数据的工作人员以及一个将检索到的数据绑定到您的机制控制。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T07:31:05.617

如果它只是一个连接字符串（或只是几个设置变量），您可以将它们从父页面传递给您的控件。

在包含麻烦的用户控件的页面中，您可以在 aspx 页面中引用该控件，然后在初始化您的 aspx 页面及其控件时，您可以覆盖其构造函数/自定义函数中的连接字符串

在您的 aspx 页面中

```
<%Reference Src="path/to/your/control"%> 
```

代码端 (aspx)

```
// - check if this works first
ASP.class_name_of_control_ascx(override_connection_string); 

// Other wise - created place holder on page for control/find control on page
UserControl ctrl = new ASP.class_name_of_control_ascx();
PlaceHolderOnPage.Controls.Add(ctrl);
((ASP.class_name_of_control_ascx)ctrl).RunMethod(override_connection string); 
```

然后控制方面，只需设置您的默认构造函数和一个覆盖构造函数来接受来自父 aspx 页面的连接字符串。

在您的控制下，您只需使用此覆盖连接字符串。

# vb.net - 创建更具吸引力的 DataGridView

> ID：1015120
> 
> 赞同：1
> 
> 时间：2009-06-18T20:49:08.690
> 
> 标签：vb.net, datagridview, datagrid, spreadsheet

我的表单使用 DataGridView 如下所示：

![截屏](../Images/be8773d1196d121b8a497b2a689be760.png)

我想让它看起来更专业。有人可以为它推荐一个“改造”吗？也许有一种更有吸引力的方式来显示这些数据。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-18T20:56:23.420

我一直在使用来自[Component Factory](http://www.componentfactory.com/toolkit_datagridview.php)的免费网格控件，它具有与标准 DataGridView 相同的所有功能。网格允许对几乎所有 UI 元素进行自定义。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-18T20:52:42.303

这看起来已经很不错了。您可能想要做的是使用“属性”面板将其设置为`Dock`填充`Fill`整个表单。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-18T21:09:10.507

就个人而言，我建议稍微软化这些颜色。也许使用相同颜色的柔和版本。

另外，就像 person-b 建议的那样：Dock->Fill。

我不是不必要的行/记录选择器列的忠实粉丝。如果您不需要它，我建议您摆脱它。

最后一件事，通常我建议不要用蜡笔画你的 UI，而是让颜色默认为用户指定的任何 Windows 主题。但是，我看到在您的案例中为列着色的意义。我建议您允许用户修改颜色。我不是色盲，但有可能你的颜色对那些色盲的人来说是不可读的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-18T21:03:40.253

我的第一个想法是列颜色，颜色是否意味着什么，如果你试图区分列，我会使用两种微妙的颜色。大的颜色变化应该是有意义的（错误是粗体和红色）。字体应该使用系统字体样式，基本颜色也应该使用系统颜色。颜色和字体样式可能对您有用，但不是所有人，有些人是色盲，有些人需要更大的字体。

# c# - 集合中项目的可观察集合属性已更改

> ID：1015126
> 
> 赞同：11
> 
> 时间：2009-06-18T20:51:16.720
> 
> 标签：c#, wpf, sorting, collections, observablecollection

我有一个`ObservableCollection<T>`. 我已将其绑定到 ListBox 控件，并已添加`SortDescriptions`到 ListBox 上的 Items 集合中，以使列表按我想要的方式排序。

当子元素的任何属性发生更改时，我想在**任何**时候使用列表。

我所有的子元素都实现了`INotifyPropertyChanged`.

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-06-18T21:24:32.740

蛮力：

1.  将处理程序附加到每个子项的每个 PropertyChanged 事件
2.  从 CollectionViewSource 中获取 ListCollectionView
3.  调用刷新。

**编辑：**

1、2 的代码将存在于您的代码隐藏中。

对于＃1，您可以执行以下操作：

```
private void Source_CollectionChanged(object sender, NotifyCollectionChangedEventArgs e)
{
    switch (e.Action)
    {
        case NotifyCollectionChangedAction.Add:
            foreach( SomeItem item in e.NewItems)
            {
               item.PropertyChanged += new PropertyChangedEventHandler(_SomeItem_PropertyChanged); 
            }
            break;
....
**HANDLE OTHER CASES HERE**
....
      }
} 
```

对于 #2，在您的 CollectionChanged 处理程序中，您将执行以下操作：

```
private void _SomeItem_PropertyChanged(object sender, PropertyChangedEventArgs e)
{
    ListCollectionView lcv = (ListCollectionView)(CollectionViewSource.GetDefaultView(theListBox.ItemsSource));
    lcv.Refresh();
} 
```

EDIT2：但是，在这种情况下，我**强烈**建议您也检查 ListCollectionView.NeedsRefresh 并且仅在设置时刷新。如果您的属性已更改且不影响排序，则没有理由重新排序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-18T21:36:48.860

这行得通。每当集合发生变化时，它都会对集合进行重新排序。可能以更有效的方式可行，但这是它的要点。

```
 public partial class TestWindow : Window {
        ObservableCollection<TestClass> oc;
        public TestWindow() {
            InitializeComponent();
            // Fill in the OC for testing 
            oc = new ObservableCollection<TestClass>();
            foreach( char c in "abcdefghieeddjko" ) {
                oc.Add( new TestClass( c.ToString(), c.ToString(), c.GetHashCode() ) );
            }

            lstbox.ItemsSource = oc;
            // Set up the sorting (this is how you did it.. doesn't work)
            lstbox.Items.SortDescriptions.Add( new SortDescription("A", ListSortDirection.Ascending) );
            // This is how we're going to do it
            oc.CollectionChanged += new System.Collections.Specialized.NotifyCollectionChangedEventHandler( oc_Sort );
        }

        void oc_Sort( object sender, System.Collections.Specialized.NotifyCollectionChangedEventArgs e ) {
            // This sorts the oc and returns IEnumerable
            var items = oc.OrderBy<TestClass, int>( ( x ) => ( x.C ) );
            // Rest converst IEnumerable back to OC and assigns it
            ObservableCollection<TestClass> temp = new ObservableCollection<TestClass>();
            foreach( var item in items ) {
                temp.Add( item );
            }
            oc = temp;
        }

        private void Button_Click( object sender, RoutedEventArgs e ) {
            string a = "grrrr";
            string b = "ddddd";
            int c = 383857;
            oc.Add( new TestClass( a, b, c ) );
        }

    }

    public class TestClass : INotifyPropertyChanged {
        private string a;
        private string b;
        private int c;

        public TestClass( string f, string g, int i ) {
            a = f;
            b = g;
            c = i;
        }
        public string A {
            get { return a; }
            set { a = value; OnPropertyChanged( "A" ); }
        }
        public string B {
            get { return b; }
            set { b = value; OnPropertyChanged( "B" ); }
        }
        public int C {
            get { return c; }
            set { c = value; OnPropertyChanged( "C" ); }
        }

        #region onpropertychanged

        public event PropertyChangedEventHandler PropertyChanged;
        protected void OnPropertyChanged( string propertyName ) {
            if( this.PropertyChanged != null ) {
                PropertyChanged( this, new PropertyChangedEventArgs( propertyName ) );
            }
        }
        #endregion
    } 

```

XAML：

```
<窗口 x:Class="ServiceManager.TestWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    标题="TestWindow" 高度="500" 宽度="500">
    <停靠面板>
        <ListBox ItemsSource="{Binding}" x:Name="lstbox">
            <ListBox.ItemTemplate>
                <数据模板>
                    <StackPanel 方向="水平">
                        <标签内容="{绑定路径=A}"/>
                        <标签内容="{绑定路径=B}"/>
                        <标签内容="{绑定路径=C}"/>
                    </堆栈面板>
                </数据模板>
            </ListBox.ItemTemplate>
        </列表框>
        <Button Click="Button_Click" Content="Click" />
    </DockPanel>
</窗口>

```

# workflow-foundation - 什么是用于创建 Web 故障排除工具的好 .NET/Windows 工具？

> ID：1015129
> 
> 赞同：0
> 
> 时间：2009-06-18T20:51:59.670
> 
> 标签：workflow-foundation

有谁知道创建分步在线故障排除工具的好方法？

我的公司需要开发几个这样的工具，为几个客户定制。

最终，我们想要一种简单的方法来维护一系列问题，并具有依赖于答案的导航。

我们需要能够支持您可能想象的所有标准类型的问题（真/假；多项选择（选择一项），多项选择（选择一项以上）；等等）。

我们希望我们的业务用户能够维护问题，如果可能的话，还有流程，因此可以控制数据库驱动后端的 GUI 会很棒。

我们考虑过使用 WF 来完成这项任务，但它并没有为非技术用户提供修改工作流程的简便方法，我们甚至不确定它是否能满足我们的所有需求（例如，我们如何存储问题和可能的路径）。

我们正处于调查此问题的早期阶段，但这似乎是一个常见问题，这让我们认为有工具可以解决它。

有没有人有解决此类问题或使用我们正在寻找的任何工具的经验？

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-18T21:08:21.460

这让我想起了一个称为“知识树”的组织概念，您可以在其中轻松设置包含有价值文档的“目标叶子”，并且您可以根据给定情况提供简单的是/否或多项选择遍历。

有一家名为[Knowledge Tree](http://www.knowledgetree.com/)的公司提供他们软件的免费版本（因为没有正式的测试或技术支持），这可能会给你一个可以使用的跳板。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-18T21:00:17.407

有时，看似复杂的事情可能只需要一个简单的解决方案。老实说，我会研究各种 Wiki 解决方案。它们快速、易于编辑、熟悉、不断发展，也可以用作 CMS。

我会避免为这样的事情用正式的结构来束缚自己。你最终会遇到一些僵化的事情，并且高度依赖 IT 员工，这听起来像是你想要避免的。

我敢肯定，无论您要解决什么问题（新产品版本、相关产品等）都会随着时间而改变，并且 wiki 将足够灵活来处理这些问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-18T21:01:22.410

我创建了一个数据库驱动的工作流项目（不是 WWF）。它使用模板、步骤、问题、答案、逻辑和所有者的概念。这使您可以创建具有工作流程的各种调查，以便根据选定的答案，用户可能会被带到另一个步骤。或者，如果步骤的所有者完成了他们的步骤，模板中的下一步将通过电子邮件发送给后续步骤所有者（或所有者组）。

您可以将此概念从问题转换为陈述，以便当用户浏览他们的问题时，他们会以类似的方式引导自己找到答案。

模板（帮助项目） 步骤（帮助项目中的步骤，插入，打开，显示登录屏幕） 语句（语句可能是在一个步骤中执行的各种任务） 答案（语句中的项目供用户选择相关的到如果项目有帮助）逻辑（选择答案时会发生什么，分支，新所有者等）所有者（谁拥有哪个步骤，可以适合组）组（满足完成的步骤的所有者组）

不确定这是否是您的想法。

# python - 运行包含在字符串中的 Python 代码

> ID：1015142
> 
> 赞同：9
> 
> 时间：2009-06-18T20:55:33.420
> 
> 标签：python, pygame, exec, eval

我正在使用 pygame 和 box2d 编写游戏引擎，并且在角色构建器中，我希望能够编写将在 keydown 事件上执行的代码。

我的计划是在角色生成器中添加一个文本编辑器，让您编写类似于以下内容的代码：

```
if key == K_a:
    ## Move left
    pass
elif key == K_d:
    ## Move right
    pass 
```

我将文本编辑器的内容作为字符串检索，并且我希望代码在 Character 的这个方法中的一个方法中运行：

```
def keydown(self, key):
    ## Run code from text editor 
```

最好的方法是什么？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-06-18T20:57:11.093

您可以使用该[`eval(string)`](http://docs.python.org/library/functions.html#eval)方法来执行此操作。

## 定义

`eval(code, globals=None, locals=None)`
该代码只是标准的 Python 代码——这意味着它仍然需要正确缩进。

全局变量可以具有自`__builtins__`定义定义，这对于安全目的可能很有用。

## 例子

```
eval("print('Hello')") 
```

将打印`hello`到控制台。您还可以指定要使用的代码的局部和全局变量：

```
eval("print('Hello, %s'%name)", {}, {'name':'person-b'}) 
```

## 安全问题

不过要小心。将执行任何用户输入。考虑：

```
eval("import os;os.system('sudo rm -rf /')") 
```

有很多方法可以解决这个问题。最简单的方法是执行以下操作：

```
eval("import os;...", {'os':None}) 
```

这将引发异常，而不是擦除您的硬盘驱动器。虽然您的程序是桌面程序，但如果人们重新分发脚本，这可能是一个问题，我想这是有意的。

## 奇怪的例子

`eval`这是一个相当奇怪的使用示例：

```
def hello() : print('Hello')
def world() : print('world')
CURRENT_MOOD = 'happy'

eval(get_code(), {'contrivedExample':__main__}, {'hi':hello}.update(locals())) 
```

这在 eval 行上的作用是：

1.  给当前模块另一个名字（它变成`contrivedExample`脚本）。消费者现在可以打电话`contrivedExample.hello()`了。）
2.  它定义`hi`为指向`hello`
3.  它将该字典与执行模块中的当前全局变量列表相结合。

## 失败

事实证明（感谢评论者！）您实际上需要使用该`exec`语句。大哎呀。修改后的示例如下：

* * *

## `exec`定义

（这看起来很熟悉！） Exec 是一个语句：
`exec "code" [in scope]` 其中 scope 是本地和全局变量的字典。如果未指定，则在当前范围内执行。

该代码只是标准的 Python 代码——这意味着它仍然需要正确缩进。

## `exec`例子

```
exec "print('hello')" 
```

将打印`hello`到控制台。您还可以指定要使用的代码的局部和全局变量：

```
eval "print('hello, '+name)" in {'name':'person-b'} 
```

## `exec`安全问题

不过要小心。将执行任何用户输入。考虑：

```
exec "import os;os.system('sudo rm -rf /')" 
```

* * *

## 打印声明

正如评论者所指出的，`print`是 3.0 之前的所有 Python 版本中的声明。在 2.6 中，可以通过键入来更改行为`from __future__ import print_statement`。否则，使用：

```
print "hello" 
```

代替 ：

```
print("hello") 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-18T21:12:28.783

正如其他人指出的那样，您可以将文本加载到字符串中并使用`exec "codestring"`. 如果已经包含在文件中，使用[execfile](http://docs.python.org/library/functions.html#execfile)将避免加载它。

一个性能说明：您应该避免多次执行代码，因为解析和编译 python 源代码是一个缓慢的过程。IE。没有：

```
def keydown(self, key):
    exec user_code 
```

您可以通过将源代码编译为代码对象来稍微改进这一点（使用`compile()`并执行它，或者更好的是，通过构建一个您保留的函数，并且只构建一次。要么要求用户编写“def my_handler（args.. .)”，或者自己添加它，然后执行以下操作：

```
user_source = "def user_func(args):\n" + '\n'.join("    "+line for line in user_source.splitlines())

d={}
exec user_source in d
user_func = d['user_func'] 
```

然后后来：

```
if key == K_a:
   user_func(args) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-18T20:58:18.593

您可以使用[`eval()`](http://docs.python.org/library/functions.html#eval)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-18T20:58:38.093

评估或执行。在编程之前，您绝对应该阅读 Python 库参考。

# ruby-on-rails - 与 ActiveRecord 的同一模型的多对多关联？

> ID：1015144
> 
> 赞同：2
> 
> 时间：2009-06-18T20:55:44.933
> 
> 标签：ruby-on-rails, activerecord, many-to-many

我正在关注[本教程](http://www.jumbabox.com/2008/06/ruby-on-rails-many-to-many-tutorial/)，该教程在 has_many :through 关系中表现出色。我有正常的事情，比如 category_product 工作。

但是，我无法将这种情况概念化（也无法使其发挥作用）：我有一个具有相关类别的类别。由于每个类别都可以有 N 个类别……首先，这实际上是多对多的情况吗（我很肯定它是）？其次，这会是什么样子？我的迁移如下所示：

```
create_table :categories do |t|
  t.string :name
  t.timestamps
end

create_table :related_categories, :id => false do |t|
  t.integer :category_a_id
  t.integer :category_b_id
end 
```

我的模特的胆量是

```
has_many :related_categories, :foreign_key=>"category_a_id"
has_many :categories, :through => :related_categories, :source=>:category_a 
```

这显然是不对的，尽管它已经到达那里（即，它已 100% 损坏）。我怎样才能做到这一点？

**编辑：**我忘记了这一点，但只在这里（意思是这不是答案）：

```
class RelatedCategory < ActiveRecord::Base
  belongs_to :category_a, :class_name=>"Category"
  belongs_to :category_b, :class_name=>"Category"
end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-18T21:36:28.237

您应该尝试`:source => :category_b`在您的 has_many 声明中。

您已将其用作`category_a_id`相关类别表的外键。这基本上告诉 ActiveRecord在获取与其相关的所有相关类别记录时将表`category_a_id`上的字段与当前类别对象 id 匹配。`related_categories`此声明的 source 参数`has_many :through`指定在填充类别集合时应考虑查找（或写入）相关对象的字段。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-18T23:18:50.120

这是答案，但它并不漂亮。

```
 has_many :related_categories, :foreign_key=>"category_a_id"
  has_many :related_categories2, :class_name=>"RelatedCategory", :foreign_key=>"category_b_id"
  has_many :categories, :through => :related_categories, :source=>:category_b
  has_many :categories_backwards, :through => :related_categories2, :source=>:category_a
  has_many :category_products 
```

那么你将不得不做一些愚蠢的getter，它结合了categories + categories_backwards，或者其他东西。

**编辑 [2 分钟后]：**哇，有了吸气剂，它几乎看起来很完美！当然，问题是你必须推送到类别，而不是你从 getter 中得到的任何东西。

# unit-testing - 测试数据密集型遗留应用程序的技巧

> ID：1015153
> 
> 赞同：10
> 
> 时间：2009-06-18T20:58:16.660
> 
> 标签：unit-testing, legacy

我正在开发一个非常大的、数据密集型的遗留应用程序。代码库和数据库的规模都很大。大量业务逻辑分布在包括存储过程在内的所有层中。

是否有人对如何以有效的方式开始将“单元”测试（技术上的集成测试，因为他们需要跨层测试几乎任何给定流程的单个方面）应用到应用程序有任何建议？当前的架构不容易支持任何类型的注入或模拟。正在编写新代码以方便测试，但是遗留代码呢？由于对数据本身和数据库中的业务逻辑有很强的依赖性，我目前正在使用内联 sql 来查找要用于测试的数据，但这些都非常耗时。创建视图和/或存储过程是不够的。

您采取了哪些方法（如果适用）？什么有效？什么没有&为什么？任何建议，将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-06-18T21:24:09.197

获取Michael Feathers的[《有效使用遗留代码》](http://www.amazon.co.uk/Working-Effectively-Legacy-Robert-Martin/dp/0131177052)的副本。对于处理大型、未经测试的代码库，它充满了有用的建议。

另一本好书是[Object Oriented Reengineering Patterns](http://scg.unibe.ch/download/oorp/)。本书的大部分内容并不特定于面向对象的软件。全文可免费下载 PDF 格式。

根据我自己的经验：尝试...

*   自动化构建和部署
*   将数据库模式放入版本控制中（如果还没有的话）。通常，数据库包含事务代码在其工作之前需要存在的参考数据。也可以将其置于版本控制之下。[dbdeploy 之](http://dbdeploy.com/)类的工具可以帮助您轻松地重建模式并从一系列增量中引用数据。
*   在您的开发工作站上安装一个版本的数据库（和任何其他基础设施服务）。这将使您无需不断地通过 DBA 就可以处理数据库。它也比在远程数据中心的共享服务器上使用模式更快。所有主要的商业数据库服务器都有可在 Windows 上运行的免费（如啤酒）开发版本（如果您陷入在 Windows 上开发和在 Unix 上部署的令人羡慕的境地）。
*   在开始处理代码的某个区域之前，请编写大致涵盖您正在处理的区域的行为的端到端测试。端到端测试应该从外部运行系统——通过控制其用户界面或通过网络服务进行交互——因此您无需更改代码即可将其放置到位。它将充当（不完美的）回归测试，并让您更有信心将系统内部重构为更易于单元测试的结构。
*   如果有手动测试计划，请阅读它们并查看可以自动化的内容。大多数手动测试计划几乎完全是脚本化的，因此自动化也是唾手可得的成果
*   一旦你获得了端到端的测试覆盖率，就可以在修改和/或扩展代码时将代码重构为更松散耦合的单元。用单元测试围绕这些单元。

要避免的事情：

*   将生产数据库中的数据复制到您用于自动化测试的环境中。这将使您的测试变得不可预测。当然，针对生产数据的副本运行系统，但将其用于探索性测试，而不是回归测试。
*   在测试结束时回滚事务以将测试彼此隔离。这不会测试仅在提交事务时发生的行为，并且会丢弃对诊断测试失败有价值的数据。相反，测试应确保数据库在启动时处于已知的初始状态。
*   为要运行的测试创建一个“小”数据集。这使得测试难以理解，因为它们不能作为一个单元来阅读。随着您为不同场景添加测试，“微小”数据集很快就会变得非常大。相反，测试可以将数据插入数据库以设置测试夹具。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-11-22T06:42:33.813

“测试遗留应用程序现代化”重点介绍：

1.  在 AscentialTest 中如何创建测试的高级概述

2.  将遗留对象转换为新平台对象定义组件的方法

3.  如何确保应用程序的现代化版本产生相同的结果

有关使用测试遗留应用程序的更多详细信息，请在此处查看：

[http://application-management.cioreview.com/whitepaper/testing-legacy-application-modernization-wid-529.html](http://application-management.cioreview.com/whitepaper/testing-legacy-application-modernization-wid-529.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-08-25T05:49:35.700

如前所述，那里有一些非常好的书。强烈建议查看有效地使用旧代码。

您可以做的事情是遵循数据驱动的方法，观察您的应用程序并在您有更多“痛苦”的地方引入测试。一种您可能会发现有用的半确定性方法：[https ://link.medium.com/zY9Tysfne9](https://link.medium.com/zY9Tysfne9)

# templates - Windows批处理的heredoc？

> ID：1015163
> 
> 赞同：40
> 
> 时间：2009-06-18T21:01:31.147
> 
> 标签：templates, batch-file, heredoc

有没有办法以类似于 unix shell 中的 heredoc 的方式批量指定多行字符串。类似于：

```
cat <<EOF > out.txt
bla
bla
..
EOF 
```

这个想法是从模板文件创建一个自定义文件..

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-06-18T22:10:27.967

据我所知不是。

我所知道的最接近的是

```
> out.txt (
    @echo.bla
    @echo.bla
    ...
) 
```

（`@`防止命令外壳本身打印它正在运行的命令，并`echo.`允许您以空格开始一行。）

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2013-02-22T20:14:42.790

这是另一种方法。

```
@echo off

:: ######################################################
:: ## Heredoc syntax:                                  ##
:: ## call :heredoc uniqueIDX [>outfile] && goto label ##
:: ## contents                                         ##
:: ## contents                                         ##
:: ## contents                                         ##
:: ## etc.                                             ##
:: ## :label                                           ##
:: ##                                                  ##
:: ## Notes:                                           ##
:: ## Variables to be evaluated within the heredoc     ##
:: ## should be called in the delayed expansion style  ##
:: ## (!var! rather than %var%, for instance).         ##
:: ##                                                  ##
:: ## Literal exclamation marks (!) and carats (^)     ##
:: ## must be escaped with a carat (^).                ##
:: ######################################################

:--------------------------------------------
: calling heredoc with results sent to stdout
:--------------------------------------------

call :heredoc stickman && goto next1

\o/
 | This is the "stickman" heredoc, echoed to stdout.
/ \
:next1

:-----------------------------------------------------------------
: calling heredoc containing vars with results sent to a text file
:-----------------------------------------------------------------

set bodyText=Hello world!
set lipsum=Lorem ipsum dolor sit amet, consectetur adipiscing elit.

call :heredoc html >out.txt && goto next2
<html lang="en">
    <body>
        <h3>!bodyText!</h3>
        <p>!lipsum!</p>
    </body>
</html>

Thus endeth the heredoc.  :)
:next2

echo;
echo Does the redirect to a file work?  Press any key to type out.txt and find out.
echo;

pause>NUL
type out.txt
del out.txt

:: End of main script
goto :EOF

:: ########################################
:: ## Here's the heredoc processing code ##
:: ########################################
:heredoc <uniqueIDX>
setlocal enabledelayedexpansion
set go=
for /f "delims=" %%A in ('findstr /n "^" "%~f0"') do (
    set "line=%%A" && set "line=!line:*:=!"
    if defined go (if #!line:~1!==#!go::=! (goto :EOF) else echo(!line!)
    if "!line:~0,13!"=="call :heredoc" (
        for /f "tokens=3 delims=>^ " %%i in ("!line!") do (
            if #%%i==#%1 (
                for /f "tokens=2 delims=&" %%I in ("!line!") do (
                    for /f "tokens=2" %%x in ("%%I") do set "go=%%x"
                )
            )
        )
    )
)
goto :EOF 
```

**示例输出：**

```
C:\Users\oithelp\Desktop>heredoc

\o/
 | This is the "stickman" heredoc, echoed to stdout.
/ \

Does the redirect to a file work?  Press any key to type out.txt and find out.

<html lang="en">
    <body>
        <h3>Hello world!</h3>
        <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit.</p>
    </body>
</html>

Thus endeth the heredoc.  :) 
```

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2009-06-19T06:12:23.667

是的，很有可能。^ 是文字转义字符，只需将其放在换行符之前。在此示例中，我还添加了额外的换行符，以便在文件中正确打印：

```
@echo off
echo foo ^

this is ^

a multiline ^

echo > out.txt 
```

输出：

```
E:\>type out.txt
foo
 this is
 a multiline
 echo

E:\> 
```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2011-08-18T09:53:06.680

```
@echo off
 for /f "delims=:" %%a in (
     'findstr -n "^___" %0') do set "Line=%%a"

 (for /f "skip=%Line% tokens=* eol=_" %%a in (
       'type %0') do echo(%%a) > out.html
:: out.html
pause
goto: EOF

___DATA___
<!Doctype html>
<html>
  <head>
   title></title>
  </head>
  <body>
    <svg width="900" height="600">
        <text x="230" 
              y="150"
              font-size="100"
              fill="blue"
              stroke="gray"
              stroke-width="1">
                  Hello World              
        </text>
    </svg>
  </body>
</html> 
```

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2015-07-04T04:29:26.267

在 DosTips 上，siberia- [man](http://www.dostips.com/forum/viewtopic.php?f=3&t=6491)以`(goto) 2>nul`. Aacini 和 jeb 然后记录了一些关于奇怪行为的额外有趣发现。它的行为基本上类似于`EXIT /B`，除了它允许 CALLed 例程中的串联命令在父调用者的上下文中执行。

这是一个简短的脚本，演示了大部分要点：

```
@echo off
setlocal enableDelayedExpansion
set "var=Parent Value"
(
  call :test
  echo This and the following line are not executed
  exit /b
)
:break
echo How did I get here^^!^^!^^!^^!
exit /b

:test
setlocal disableDelayedExpansion
set "var=Child Value"
(goto) 2>nul & echo var=!var! & goto :break
echo This line is not executed

:break
echo This line is not executed 
```

- 输出 -

```
var=Parent Value
How did I get here!!!! 
```

这种惊人的行为使我能够编写一个优雅的here doc批处理模拟，其中包含许多unix可用的选项。我将 PrintHere.bat 实现为一个独立的实用程序，该实用程序应放置在 PATH 中列出的文件夹中。然后任何批处理脚本都可以轻松调用该实用程序来获取此处的文档功能。

这是使用的一般语法：

```
call PrintHere :Label
Here doc text goes here
:Label 
```

这怎么可能实现？...我的 PrintHere 实用程序`(GOTO) 2>nul`两次使用了这个技巧。

*   我第一次使用`(GOTO) 2>nul`返回给调用者，这样我就可以获得调用脚本的完整路径，以便 PrintHere 知道要从哪个文件读取。然后我第二次调用 PrintHere！

*   我第二次使用`(GOTO) 2>nul`返回给调用者并转到终止标签，以便不执行此处的文档文本。

注意 - 下面的脚本在标签的定义中包含一个制表符 (0x09)，位于标签的正下方`:start`。某些浏览器可能难以显示和复制选项卡。作为替代方案，您可以[从我的 dropbox 下载 PrintHere.bat.txt](https://www.dropbox.com/s/faexna616vxahx3/PrintHere.bat.txt?dl=0)，然后简单地将其重命名为 PrintHere.bat。

我最初在[DosTips 上发布了 PrintHere.bat](http://www.dostips.com/forum/viewtopic.php?f=3&t=6537)，您可以在其中跟踪未来的发展。

**PrintHere.bat**

```
@echo off & setlocal disableDelayedExpansion & goto :start
::PrintHere.bat version 1.1 by Dave Benham
:::
:::call PrintHere [/E] [/- "TrimList"] :Label ["%~f0"]
:::call PrintHere [/E] [/- "TrimList"] :Label "%~f0" | someCommand & goto :Label
:::PrintHere /?
:::PrintHere /V
:::
:::  PrintHere.bat provides functionality similar to the unix here doc feature.
:::  It prints all content between the CALL PrintHere :Label line and the
:::  terminating :Label. The :Label must be a valid label supported by GOTO, with
:::  the additional constraint that it not contain *. Lines are printed verbatim,
:::  with the following exceptions and limitations:
:::
:::    - Lines are lmited to 1021 bytes long
:::    - Trailing control characters are stripped from each line
:::
:::  The code should look something like the following:
:::
:::     call PrintHere :Label
:::         Spacing    and blank lines are preserved
:::
:::     Special characters like & < > | ^ ! % are printed normally
:::     :Label
:::
:::  If the /E option is used, then variables between exclamation points are
:::  expanded, and ! and ^ literals must be escaped as ^! and ^^. The limitations
:::  are different when /E is used:
:::
:::    - Lines are limited to ~8191 bytes long
:::    - All characters are preserved, except !variables! are expanded and ^! and
:::      ^^ are transformed into ! and ^
:::
:::  Here is an example using /E:
:::
:::     call PrintHere /E :SubstituteExample
:::       Hello !username!^!
:::     :SubstituteExample
:::
:::  If the /- "TrimList" option is used, then leading "TrimList" characters
:::  are trimmed from the output. The trim characters are case sensitive, and
:::  cannot include a quote. If "TrimList" includes a space, then it must
:::  be the last character in the list.
:::
:::  Multiple PrintHere blocks may be defined within one script, but each
:::  :Label must be unique within the file.
:::
:::  PrintHere must not be used within a parenthesized code block.
:::
:::  Scripts that use PrintHere must use \r\n for line termination, and all lines
:::  output by PrintHere will be terminated by \r\n.
:::
:::  All redirection associated with a PrintHere must appear at the end of the
:::  command. Also, the CALL can include path information:
:::
:::     call "c:\utilities\PrintHere.bat" :MyBlock>test.txt
:::       This line is written to test.txt
:::     :MyBlock
:::
:::  PrintHere may be used with a pipe, but only on the left side, and only
:::  if the source script is included as a 2nd argument, and the right side must
:::  explicitly and unconditionally GOTO the terminating :Label.
:::
:::     call PrintHere :PipedBlock "%~f0" | more & goto :PipedBlock
:::       text goes here
:::     :PipedBlock
:::
:::  Commands concatenated after PrintHere are ignored. For example:
:::
:::     call PrintHere :ignoreConcatenatedCommands & echo This ECHO is ignored
:::       text goes here
:::     :ignoreConcatenatedCommands
:::
:::  PrintHere uses FINDSTR to locate the text block by looking for the
:::  CALL PRINTHERE :LABEL line. The search string length is severely limited
:::  on XP. To minimize the risk of PrintHere failure when running on XP, it is
:::  recommended that PrintHere.bat be placed in a folder included within PATH
:::  so that the utility can be called without path information.
:::
:::  PrintHere /? prints out this documentation.
:::
:::  PrintHere /V prints out the version information
:::
:::  PrintHere.bat was written by Dave Benham. Devlopment history may be traced at:
:::    http://www.dostips.com/forum/viewtopic.php?f=3&t=6537
:::

:start
set "tab=   "   NOTE: This value must be a single tab (0x09), not one or more spaces
set "sp=[ %tab%=,;]"
set "sp+=%sp%%sp%*"
set "opt="
set "/E="
set "/-="

:getOptions
if "%~1" equ "" call :exitErr Invalid call to PrintHere - Missing :Label argument
if "%~1" equ "/?" (
  for /f "tokens=* delims=:" %%L in ('findstr "^:::" "%~f0"') do echo(%%L
  exit /b 0
)
if /i "%~1" equ "/V" (
  for /f "tokens=* delims=:" %%L in ('findstr /rc:"^::PrintHere\.bat version" "%~f0"') do echo(%%L
  exit /b 0
)
if /i %1 equ /E (
  set "/E=1"
  set "opt=%sp+%.*"
  shift /1
  goto :getOptions
)
if /i %1 equ /- (
  set "/-=%~2"
  set "opt=%sp+%.*"
  shift /1
  shift /1
  goto :getOptions
)
echo %1|findstr "^:[^:]" >nul || call :exitErr Invalid PrintHere :Label
if "%~2" equ "" (
  (goto) 2>nul
  setlocal enableDelayedExpansion
  if "!!" equ "" (
    endlocal
    call %0 %* "%%~f0"
  ) else (
    >&2 echo ERROR: PrintHere must be used within a batch script.
    (call)
  )
)
set ^"call=%0^"
set ^"label=%1^"
set "src=%~2"
setlocal enableDelayedExpansion
set "call=!call:\=[\\]!"
set "label=!label:\=[\\]!"
for %%C in (. [ $ ^^ ^") do (
  set "call=!call:%%C=\%%C!"
  set "label=!label:%%C=\%%C!"
)
set "search=!sp!*call!sp+!!call!!opt!!sp+!!label!"
set "cnt="
for /f "delims=:" %%N in ('findstr /brinc:"!search!$" /c:"!search![<>|&!sp:~1!" "!src!"') do if not defined skip set "skip=%%N"
if not defined skip call :exitErr Unable to locate CALL PrintHere %1
for /f "delims=:" %%N in ('findstr /brinc:"!sp!*!label!$" /c:"!sp!*!label!!sp!" "!src!"') do if %%N gtr %skip% if not defined cnt set /a cnt=%%N-skip-1
if not defined cnt call :exitErr PrintHere end label %1 not found
if defined /E (
  for /f "skip=%skip% delims=" %%L in ('findstr /n "^^" "!src!"') do (
    if !cnt! leq 0 goto :break
    set "ln=%%L"
    if not defined /- (echo(!ln:*:=!) else for /f "tokens=1* delims=%/-%" %%A in (^""%/-%!ln:*:=!") do (
      setlocal disableDelayedExpansion
      echo(%%B
      endlocal
    )
    set /a cnt-=1
  )
) else (
  for /l %%N in (1 1 %skip%) do set /p "ln="
  for /l %%N in (1 1 %cnt%) do (
    set "ln="
    set /p "ln="
    if not defined /- (echo(!ln!) else for /f "tokens=1* delims=%/-%" %%A in (^""%/-%!ln!") do (
      setlocal disableDelayedExpansion
      echo(%%B
      endlocal
    )
  )
) <"!src!"
:break
(goto) 2>nul & goto %~1

:exitErr
>&2 echo ERROR: %*
(goto) 2>nul & exit /b 1 
```

完整的文档嵌入在脚本中。下面是一些使用演示：

逐字输出

```
@echo off
call PrintHere :verbatim
    Hello !username!^!
    It is !time! on !date!.
:verbatim 
```

- 输出 -

```
 Hello !username!^!
    It is !time! on !date!. 
```

扩展变量（延迟扩展不需要启用）

```
@echo off
call PrintHere /E :Expand
    Hello !username!^!
    It is !time! on !date!.
:Expand 
```

- 输出 -

```
 Hello Dave!
    It is 20:08:15.35 on Fri 07/03/2015. 
```

展开变量并修剪前导空格

```
@echo off
call PrintHere /E /- " " :Expand
    Hello !username!^!
    It is !time! on !date!.
:Expand 
```

- 输出 -

```
Hello Dave!
It is 20:10:46.09 on Fri 07/03/2015. 
```

输出可以重定向到文件

```
@echo off
call PrintHere :label >helloWorld.bat
  @echo Hello world!
:label 
```

输出不能作为输入重定向，但可以通过管道传输！不幸的是，语法并不那么优雅，因为[管道的两端都在新的 CMD.EXE 进程中执行](https://stackoverflow.com/a/8194279/1012053)，因此`(GOTO) 2>nul`返回到子 cmd 进程，而不是主脚本。

```
@echo off
call PrintHere :label "%~f0" | findstr "^" & goto :label
  Text content goes here
:label 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2014-04-14T03:21:33.653

使用[带有参数的宏](http://www.dostips.com/forum/viewtopic.php?f=3&t=2518&p=12045#p12045)允许以更简单的方式编写“heredoc”：

```
@echo off

rem Definition of heredoc macro
setlocal DisableDelayedExpansion
set LF=^

::Above 2 blank lines are required - do not remove
set ^"\n=^^^%LF%%LF%^%LF%%LF%^^"
set heredoc=for %%n in (1 2) do if %%n==2 (%\n%
       for /F "tokens=1,2" %%a in ("!argv!") do (%\n%
          if "%%b" equ "" (call :heredoc %%a) else call :heredoc %%a^>%%b%\n%
          endlocal ^& goto %%a%\n%
       )%\n%
    ) else setlocal EnableDelayedExpansion ^& set argv=

rem Heredoc syntax:
rem
rem %%heredoc%% :uniqueLabel [outfile]
rem contents
rem contents
rem ...
rem :uniqueLabel
rem
rem Same notes of rojo's answer apply

rem Example borrowed from rojo's answer:

set bodyText=Hello world!
set lipsum=Lorem ipsum dolor sit amet, consectetur adipiscing elit.

%heredoc% :endHtml out.txt
<html lang="en">
    <body>
        <h3>!bodyText!</h3>
        <p>!lipsum!</p>
    </body>
</html>
:endHtml

echo File created:
type out.txt
del out.txt
goto :EOF

rem Definition of heredoc subroutine

:heredoc label
set "skip="
for /F "delims=:" %%a in ('findstr /N "%1" "%~F0"') do (
   if not defined skip (set skip=%%a) else set /A lines=%%a-skip-1
)
for /F "skip=%skip% delims=" %%a in ('findstr /N "^" "%~F0"') do (
   set "line=%%a"
   echo(!line:*:=!
   set /A lines-=1
   if !lines! == 0 exit /B
)
exit /B 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2011-08-18T10:45:59.613

@jeb

```
setlocal EnableDelayedExpansion
set LF=^

REM Two empty lines are required 
```

另一种变体：

```
@echo off

:)
setlocal enabledelayedexpansion
>nul,(pause&set /p LF=&pause&set /p LF=)<%0
set LF=!LF:~0,1!

echo 1!LF!2!LF!3

pause 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2015-03-29T13:50:40.537

参考 rojo 在[https://stackoverflow.com/a/15032476/3627676上的帖子](https://stackoverflow.com/a/15032476/3627676)

毫无疑问，他的解决方案是我一直在寻求的（当然，我可以尝试实现类似的东西，但懒惰会推动进步:)）。我想补充的一件事是对原始代码的小改进。我认为如果重定向到文件写在行尾会更好。在这种情况下，heredoc 起始行可能更严格，分析更简单。

```
@echo off

set "hello=Hello world!"
set "lorem=Lorem ipsum dolor sit amet, consectetur adipiscing elit."

call :heredoc HTML & goto :HTML
<html>
<title>!hello!</title>
<body>
<p>Variables in heredoc should be surrounded by the exclamation mark (^!).</p>
<p>!lorem!</p>
<p>Exclamation mark (^!) and caret (^^) MUST be escaped with a caret (^^).</p>
</body>
</html>
:HTML

goto :EOF

:: https://stackoverflow.com/a/15032476/3627676
:heredoc LABEL
setlocal enabledelayedexpansion
set go=
for /f "delims=" %%A in ( '
    findstr /n "^" "%~f0"
' ) do (
    set "line=%%A"
    set "line=!line:*:=!"

    if defined go (
        if /i "!line!" == "!go!" goto :EOF
        echo:!line!
    ) else (
        rem delims are ( ) > & | TAB , ; = SPACE
        for /f "tokens=1-3 delims=()>&| ,;= " %%i in ( "!line!" ) do (
            if /i "%%i %%j %%k" == "call :heredoc %1" (
                set "go=%%k"
                if not "!go:~0,1!" == ":" set "go=:!go!"
            )
        )
    )
)
goto :EOF 
```

我对这段代码有什么建议？让我们考虑一下。

Rojo 的代码非常严格：

*   `call`和之间的字符串中不允许有多个空格字符`:heredoc`
*   `call :heredoc`粘在行的边缘（行首不允许有任何空格）
*   允许在该行中的某处重定向到文件（不是很有用）-

我建议的事情：

*   不太严格（多个空格作为分隔符）
*   仅允许在行尾重定向到文件（允许和需要圆括号）
*   行的边缘没有粘性代码

**更新 1**：改进检查和执行 heredoc 开始：

*   重要的命令只有`call :heredoc LABEL`or `call :heredoc :LABEL`。因此，在打印 heredoc 内容后，可以跳转到另一个标签、脚本结尾或运行`exit /b`。
*   删除了未使用和不必要的命令 goto :next2

**更新 2**：

*   内部分隔符`for`是`(` `)` `>` `&` `|` `TAB` `,` `;` `=` `SPACE`
*   开关`/I`添加到`if`

**更新 3**：

通过以下链接，您可以找到完整版本的独立脚本（可以嵌入到您的脚本中）[https://github.com/ildar-shaimordanov/cmd.scripts/blob/master/heredoc.bat](https://github.com/ildar-shaimordanov/cmd.scripts/blob/master/heredoc.bat)

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2011-08-18T02:59:32.017

您可以使用 FOR /F 循环创建带引号的文本块，因此您不需要转义特殊字符，例如`<>|&`只`%`需要转义。
这有时像创建 html 输出一样有用。

```
@echo off
setlocal EnableDelayedExpansion
set LF=^

REM Two empty lines are required
set ^"NL=^^^%LF%%LF%^%LF%%LF%^^"

for /F "tokens=* delims=_" %%a in (^"%NL%
___"One<>&|"%NL%
___"two 100%%"%NL%
___%NL%
___"three "quoted" "%NL%
___"four"%NL%
") DO (
   @echo(%%~a
) 
```

输出

```
One<>&|
two 100%

three "quoted"
four 
```

我尝试解释代码。LF 变量包含一个换行符，NL 变量包含`^<LF><LF>^`.
这可以与百分比扩展一起使用，以在行尾放置一个换行符和一个插入符号。

通常一个 FOR /F 将引用的文本分成多个标记，但只有一次。
当我插入换行符时，FOR 循环也分成多行。
第一行和最后一行的引号仅用于为 FOR 循环创建正确的语法。

在任何行的前面都是`_`因为第一个字符将从前一行的多行插入符号中转义，如果引号是第一个字符，它将失去转义能力。
使用`_`分隔符，因为空格或逗号会导致 XP 出现问题（否则 XP-Bug 虚假会尝试访问垃圾文件名）。

行尾的插入符号也仅针对 XP-Bug。

`,;=<space>`当引用的文本包含未引用的字符时，XP-Bug 生效

```
for /f "tokens=*" %%a in ("a","b","c") do echo %%a 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2011-08-31T02:28:56.063

```
@echo off
cls
title Drop Bomb
echo/
echo/ creating...
::                                   Creating a batchfile from within a batchfile.
echo @echo off > boom.bat
echo cls      >> boom.bat
echo color F0 >> boom.bat
echo echo/    >> boom.bat
echo echo --- B-O-O-M !!! --- >> boom.bat
echo echo/    >> boom.bat
echo pause    >> boom.bat
echo exit     >> boom.bat
::                                     Now lets set it off
start boom.bat
title That hurt my ears.
cls
echo/
echo - now look what you've done!
pause 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2017-08-17T14:53:58.070

这是 ehemient 出色解决方案的一种变体。这允许您将多行管道传输到另一个程序，而无需实际创建文本文件并将其输入重定向到您的程序：

```
(@echo.bla
@echo.bla
) | yourprog.exe 
```

对于一个快速有效的示例，您可以替换`yourprog.exe`为`more`：

```
(@echo.bla
@echo.bla
) | more 
```

输出：

```
bla
bla 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2017-11-01T16:51:35.653

扩展ephemient post，我觉得最好，下面会做一个管道：

```
(
    @echo.line1
    @echo.line2 %time% %os%
    @echo.
    @echo.line4
) | more 
```

在 ehemient 的帖子中，他在开头重定向，这是一种不错的风格，但您也可以在末尾重定向：

```
(
    @echo.line1
    @echo.line2 %time% %os%
    @echo.
    @echo.line4
) >C:\Temp\test.txt 
```

请注意“@echo”。永远不会包含在输出和“@echo”中。本身给出一个空行。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2011-08-16T11:23:22.527

在 Microsoft NMake *makefile*中，可以使用真正的**UNIX heredocs**，因为线程所有者要求它们。例如，这是创建文件*Deploy.sed*的显式规则：

```
Deploy.sed:
    type << >$@
; -*-ini-generic-*-
;
; Deploy.sed -- Self-Extracting Directives
;

[Version]
Class=IEXPRESS
SEDVersion=3
    .
    .
[Strings]
InstallPrompt=Install $(NAME)-$(VERSION).xll to your personal XLSTART directory?
DisplayLicense=H:\prj\prog\XLL\$(NAME)\README.txt
    .
    .
<<

clean:
    -erase /Q Deploy.sed 
```

其中*<<*扩展为 NMake 在执行规则时动态创建的临时文件名。也就是说，当*Deploy.sed*不存在时。好消息是 NMake 变量也被扩展了（这里是变量*NAME*和*VERSION*）。将此保存为*makefile*。*在makefile*目录中打开一个 DOS 框并使用：

```
> nmake Deploy.sed 
```

创建文件，并且：

```
> nmake clean 
```

删除它。NMake 是所有 Visual Studio C++ 版本的一部分，包括 Express 版本。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2019-10-16T17:33:45.043

在紧要关头，我使用以下方法（不会减少任何其他方法，这只是个人喜好）：

**我通过一组字符串使用 for 循环：**

```
for %%l in (
    "This is my"
    "multi-line here document"
    "that this batch file"
    "will print!"
    ) do echo.%%~l >> here.txt 
```

*   不需要子程序，易于记忆和执行。
*   不需要临时文件。
*   在批处理脚本中工作。
*   适用于嵌入式变量。
*   但是：如果您的行中有双引号，则该方法不再有效...

这是我目前正在处理的脚本中的另一个实际示例：

```
:intc_version:
for %%l in (
    "File         : %_SCRIPT_NAME%"
    "Version      : %_VERSION%"
    "Company      : %_COMPANY%"
    "License      : %_LICENSE%"
    "Description  : %_DESCRIPTION%"
    ""
) do echo.%%~l
exit /B 0 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2013-07-22T20:07:03.740

OP 想要的是一些非常具体的东西（使用输出创建一个文本文件），并且接受的答案完美地做到了这一点，但是提出的解决方案在该特定上下文之外无法正常工作。例如，如果我想将多行输入传递给命令，我就不能使用`( echo )`语法。这就是最终为我工作的东西。

给定一个名为“echolines.pl”的 perl 脚本，包含以下内容（模拟“真实”程序）：

```
use strict;
use warnings;

while (<>) {
        chomp;
        print qq(<$_>\n);
} 
```

和一个名为“testme.bat”的批处理文件，其中包含：

```
@echo off

set FOO=foo
set BAR=bar
set BAZ=baz

echo %FOO%^
&echo %BAR%^
&echo %BAZ%|perl echolines.pl 
```

运行它会产生预期的输出：

```
C:\>testme
<foo>
<bar>
<baz> 
```

必须注意空格，以确保它在任何地方都没有杂散空间正常工作。具体来说：每个行尾应该是一个插入符号 (^) 后跟一个换行符，后续行必须立即以与号 (&) 开头，最后一行必须在要发送的最后一项之后立即开始管道。不这样做会导致参数丢失或参数前后有多余的空格。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2017-04-15T02:16:22.857

试试这个代码。（底部的 JScript 代码将“out.html”写入磁盘）

```
@if(0)==(0) echo on
cscript.exe //nologo //E:JScript "%~f0" source1 out.html
start out.html
goto :EOF

[source1]
<!DOCTYPE html>
<html>
  <head>
   title></title>
  </head>
  <body>
    <svg width="900" height="600">
        <text x="230" 
              y="150"
              font-size="100"
              fill="blue"
              stroke="gray"
              stroke-width="1">
                  Hello World              
        </text>
    </svg>
  </body>
</html>
[/source1]

@end

if (WScript.Arguments.length != 2) WScript.Quit();
var tagName = WScript.Arguments(0);
var path    = WScript.Arguments(1);
var startTag = "[" + tagName + "]"
var endTag   = "[/" + tagName + "]"
var fso = new ActiveXObject("Scripting.FileSystemObject");
var file1 = fso.OpenTextFile(WScript.ScriptFullName);
var txt = "";
var found = false;
while (!file1.AtEndOfStream) {
  var line = file1.ReadLine();
  if (!found) {
    if (line.lastIndexOf(startTag, 0) === 0) found = true;
  } else {
    if (line.lastIndexOf(endTag, 0) === 0) break;
    txt += line + "\n";
  }
}
file1.Close();
var file2 = fso.CreateTextFile(path, true, false);
file2.Write(txt);
file2.Close(); 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2022-02-25T01:31:04.677

在 .bat 文件中：

```
(
@echo.bla
@echo.bla
@echo...
) > out.txt 
```

然后

```
type out.txt 
```

生产

```
bla
bla
.. 
```

有点混乱，必须放在`@echo.`每一行的开头，但它基本上可以满足您的需求：将依赖文件滚动到脚本文件本身的能力。

还有很多其他解决方案，但所有这些都需要添加更多代码才能以更简洁的方式完成基本相同的事情。在一种情况下，甚至需要一个完整的其他 .bat 文件作为新的依赖项！

B.Reynolds 的道具，我的回答受到了他们的启发。

* * *

## 回答 #18

> 赞同：-1
> 
> 时间：2009-08-20T03:25:51.313

这更容易，并且非常类似于 cat << EOF > out.txt：

C:\>copy con out.txt
这是我的第一行文字。
这是我的最后一行文字。
^Z
已复制 1 个文件。

输出如下所示：

C:\>type out.txt
这是我的第一行文本。
这是我的最后一行文字。

（复制 con + out.txt，输入您的输入，然后按 Ctrl-Z 并复制文件）

COPY CON 表示“从控制台复制”（接受用户输入）

* * *

## 回答 #19

> 赞同：-5
> 
> 时间：2015-11-17T18:53:35.190

```
C:\>more >file.txt
This is line 1 of file
This is line 2 of file
^C

C:\>type file.txt
This is line 1 of file
This is line 2 of file 
```

**它会在最后添加一个空行，但你可以很容易地解决这个问题，只需使用 copy con 方法：

```
C:\>copy con file.txt >nul
This is line 1 of file
This is line 2 of file^Z

C:\>type file.txt
This is line 1 of file
This is line 2 of file 
```

请注意在每种情况下键入 ^C 和 ^Z 的位置。

# sql - 日期范围内的分组/聚合

> ID：1015165
> 
> 赞同：3
> 
> 时间：2009-06-18T21:02:53.687
> 
> 标签：sql, oracle

得到一列的表 ABC。“创建”日期列。所以样本值就像;

```
 created
 2009-06-18 13:56:00
 2009-06-18 12:56:00
 2009-06-17 14:02:00
 2009-06-17 13:12:23
 2009-06-16 10:02:10 
```

我想写一个查询，结果是：

```
count    created
2        2009-06-18
2        2009-06-17
1        2009-06-16 
```

基本上计算每个日期有多少条目，但忽略时间。

这是在带有 Oracle 的 PL-SQL 中。

有任何想法吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-06-18T21:06:05.957

TRUNC 函数返回 DATETIME 的 DATE。

```
select trunc(created),count(*) from ABC group by trunc(created) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-18T21:06:06.253

`select count(*), to_char('YYYY-MM-DD', created) from ABC group by to_char('YYYY-MM-DD', created)`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-18T21:45:43.100

为了完整起见，我将添加一个适用于任意定义的存储桶大小的通用变体：

```
 SELECT trunc( (created - to_date('2000.01.01', 'YYYY.MM.DD'))
                * 24
              ) / 24
         + to_date('2000.01.01', 'YYYY.MM.DD') theDate
       , count(*)
    FROM Layer
GROUP BY trunc( (created - to_date('2000.01.01', 'YYYY.MM.DD'))
                * 24
              ) / 24
         + to_date('2000.01.01', 'YYYY.MM.DD')
ORDER BY 1; 
```

上面的查询将按小时为您提供计数；使用小于 24 的值来获得更大的间隔，或使用更大的值来创建更小的间隔。通过颠倒 * 和 / 的位置，您可以使您的存储桶以天为增量（例如，使用“/7”而不是“*24”将为您提供每个一周的存储桶。

# c# - C#：带有明确添加/删除的事件！=典型事件？

> ID：1015166
> 
> 赞同：44
> 
> 时间：2009-06-18T21:03:07.463
> 
> 标签：c#, .net, events

我已经声明了一个通用事件处理程序

```
public delegate void EventHandler(); 
```

我添加了扩展方法“RaiseEvent”：

```
public static void RaiseEvent(this EventHandler self)        {
   if (self != null) self.Invoke();
} 
```

当我使用典型语法定义事件时

```
public event EventHandler TypicalEvent; 
```

然后我可以毫无问题地调用使用扩展方法：

```
TypicalEvent.RaiseEvent(); 
```

但是当我使用显式添加/删除语法定义事件时

```
private EventHandler _explicitEvent;
public event EventHandler ExplicitEvent {
   add { _explicitEvent += value; } 
   remove { _explicitEvent -= value; }
} 
```

那么扩展方法在使用显式添加/删除语法定义的事件上不存在：

```
ExplicitEvent.RaiseEvent(); //RaiseEvent() does not exist on the event for some reason 
```

当我将鼠标悬停在事件上以查看其原因时：

> 事件 'ExplicitEvent' 只能出现在 += 或 -= 的左侧

**为什么使用典型语法定义的事件与使用显式添加/删除语法定义的事件不同，为什么扩展方法不适用于后者？**

**编辑：我发现我可以通过直接使用私有事件处理程序来解决它：**

```
_explicitEvent.RaiseEvent(); 
```

但是我仍然不明白为什么我不能像使用典型语法定义的事件那样直接使用事件。也许有人可以启发我。

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2009-06-18T21:18:05.060

当您创建“类字段”事件时，如下所示：

```
public event EventHandler Foo; 
```

编译器生成一个字段*和*一个事件。在声明事件的类的源代码中，任何时候您引用`Foo`编译器都会明白您指的是*field*。但是，该字段是私有的，因此任何时候您`Foo`从*其他*类中引用它时，它都会引用事件（因此是添加/删除代码）。

如果您声明自己的显式添加/删除代码，则不会获得自动生成的字段。所以，你只有一个事件，你不能直接在 C# 中引发一个事件——你只能调用一个委托实例。事件不是委托实例，它只是一个添加/删除对。

现在，您的代码包含以下内容：

```
public EventHandler TypicalEvent; 
```

这仍然略有不同——它根本没有声明一个*事件*——它声明了一个委托类型的公共*字段*`EventHandler`。*任何人都*可以调用它，因为该值只是一个委托实例。了解字段和事件之间的区别很重要。你永远不应该编写这种代码，就像我确定你通常没有其他类型的公共字段一样，例如`string`和`int`。不幸的是，这是一个容易犯的错字，而且是一个相对难以停止的错字。您只能通过注意到编译器允许您分配或使用另一个类的值来发现它。

有关更多信息，请参阅我[关于事件和代表](http://pobox.com/~skeet/csharp/events.html)的文章。

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2009-06-18T21:10:15.437

因为您可以这样做（它不是真实世界的示例，但它“有效”）：

```
private EventHandler _explicitEvent_A;
private EventHandler _explicitEvent_B;
private bool flag;
public event EventHandler ExplicitEvent {
   add {
         if ( flag = !flag ) { _explicitEvent_A += value; /* or do anything else */ }
         else { _explicitEvent_B += value; /* or do anything else */ }
   } 
   remove {
         if ( flag = !flag ) { _explicitEvent_A -= value; /* or do anything else */ }
         else { _explicitEvent_B -= value; /* or do anything else */ }
   }
} 
```

编译器如何知道它应该如何处理“ExplicitEvent.RaiseEvent();”？答：不能。

“ExplicitEvent.RaiseEvent();” 只是语法糖，只有在事件被隐式实现时才能被谓词。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2010-12-10T14:26:25.330

那是因为你看的不对。逻辑与属性中的相同。一旦设置了添加/删除，它就不再是实际事件，而是公开实际事件的包装器（事件只能从类本身内部触发，因此您始终可以在本地访问真实事件）。

```
private EventHandler _explicitEvent;
public event EventHandler ExplicitEvent {
   add { _explicitEvent += value; } 
   remove { _explicitEvent -= value; }
}

private double seconds; 
public double Hours
{
    get { return seconds / 3600; }
    set { seconds = value * 3600; }
} 
```

在这两种情况下，具有 get/set 或 add/remove 属性的成员实际上并不包含任何数据。您需要一个“真正的”私有成员来包含实际数据。这些属性只允许您在将成员暴露给外界时编写额外的逻辑。

为什么要这样做的一个很好的例子是在不需要时停止额外的计算（没有人在听事件）。

例如，假设事件由计时器触发，如果没有人注册事件，我们不希望计时器工作：

```
private System.Windows.Forms.Timer timer = new System.Windows.Forms.Timer();
private EventHandler _explicitEvent;
public event EventHandler ExplicitEvent 
{
   add 
   { 
       if (_explicitEvent == null) timer.Start();
       _explicitEvent += value; 
   } 
   remove 
   { 
      _explicitEvent -= value; 
      if (_explicitEvent == null) timer.Stop();
   }
} 
```

您可能想用一个对象锁定添加/删除（事后）......

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-18T21:13:33.900

典型事件的“普通”声明做了一些编译器诡计。它创建一个事件元数据条目、添加和删除方法以及一个支持字段。当您的代码引用了TypicalEvent 时，编译器会将其转换为对支持字段的引用；当外部代码引用TypicalEvent（使用+= 和-=）时，编译器将其转换为对add 或remove 方法的引用。

“显式”声明绕过了这个编译器诡计。您正在拼写 add 和 remove 方法以及支持字段：实际上，正如 TcKs 指出的那样，甚至可能没有*支持*字段（这是使用显式表单的常见原因：参见 System.Windows.Forms 中的例如事件。控制）。因此编译器不能再悄悄地把对TypicalEvent的引用翻译成对支持字段的引用：如果你想要支持字段，实际的委托对象，你必须直接引用支持字段：

```
_explicitEvent.RaiseEvent() 
```

# c# - 我怎样才能加快这个直方图类？

> ID：1015170
> 
> 赞同：2
> 
> 时间：2009-06-18T21:03:46.243
> 
> 标签：c#, performance, image-processing, histogram

这应该是计算 8 位灰度图像的直方图。使用 1024x770 的测试位图，CreateTime 的结束时间约为 890 毫秒。我怎样才能让这个（方式，方式）更快？

编辑：我应该提到这实际上并没有计算直方图，它只是从位图中获取值。所以我真的应该问，从 8 位灰度图像中检索所有像素值的最快方法是什么？

```
public class Histogram {

    private static int[,] values;

    public Histogram(Bitmap b) {
        var sw = Stopwatch.StartNew();
        values = new int[b.Width, b.Height];

        for (int w = 0; w < b.Width; ++w) {
            for (int h = 0; h < b.Height; ++h) {
                values[w, h] = b.GetPixel(w, h).R;
            }
        }

        sw.Stop();
        CreateTime = (sw.ElapsedTicks /
            (double)Stopwatch.Frequency) * 1000;
    }

    public double CreateTime { get; set; }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-18T21:18:45.963

基本的直方图算法类似于：

```
int[] hist = new hist[256];
//at this point dont forget to initialize your vector with 0s.

for(int i = 0; i < height; ++i)
{
   for(int j = 0 ; j < widthl ++j)
   {
        hist[ image[i,j] ]++;
   }
} 
```

该算法总结了你有多少值为 0 的像素，有多少值为 1 等等。基本思想是使用像素值作为要计算的直方图位置的索引。

我有一个使用非托管代码为 C# 编写的算法的版本（速度很快）我不知道是否比你的更快，但请随意接受并测试，这里是代码：

```
 public void Histogram(double[] histogram, Rectangle roi)
    {
        BitmapData data = Util.SetImageToProcess(image, roi);

        if (image.PixelFormat != PixelFormat.Format8bppIndexed)
            return;

        if (histogram.Length < Util.GrayLevels)
            return;

        histogram.Initialize();
        int width = data.Width;
        int height = data.Height;
        int offset = data.Stride - width;

        unsafe
        {
            byte* ptr = (byte*)data.Scan0;

            for (int y = 0; y < height; ++y)
            {
                for (int x = 0; x < width; ++x, ++ptr)
                    histogram[ptr[0]]++;

                ptr += offset;
            }
        }
        image.UnlockBits(data);         
    }

    static public BitmapData SetImageToProcess(Bitmap image, Rectangle roi)
    {
        if (image != null)
            return image.LockBits(
                roi,
                ImageLockMode.ReadWrite,
                image.PixelFormat);

        return null;
    } 
```

我希望我能帮助你。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-18T21:09:13.940

您需要使用 Bitmap.LockBits 方法来访问像素数据。 [这](https://web.archive.org/web/20141229164101/http://bobpowell.net/lockingbits.aspx)是一个很好的过程参考。本质上，您将需要使用`unsafe`代码来迭代位图数据。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-13T16:50:54.853

这是我基于此线程提出的功能的复制/可粘贴版本。

不安全代码期望位图为 Format24bppRgb，如果不是，它将位图转换为该格式并在克隆版本上操作。

请注意，如果您使用索引像素格式（例如 Format4bppIndexed）传入位图，则会抛出对 image.Clone() 的调用。

从我的开发机器上的 9100x2048 图像中获取直方图需要大约 200 毫秒。

```
 private long[] GetHistogram(Bitmap image)
    {
        var histogram = new long[256];

        bool imageWasCloned = false;

        if (image.PixelFormat != PixelFormat.Format24bppRgb)
        {
            //the unsafe code expects Format24bppRgb, so convert the image...
            image = image.Clone(new Rectangle(0, 0, image.Width, image.Height), PixelFormat.Format24bppRgb);
            imageWasCloned = true;
        }

        BitmapData bmd = null;
        try
        {
            bmd = image.LockBits(new Rectangle(0, 0, image.Width, image.Height), ImageLockMode.ReadOnly,
                                 PixelFormat.Format24bppRgb);

            const int pixelSize = 3; //pixels are 3 bytes each w/ Format24bppRgb

            //For info on locking the bitmap bits and finding the 
            //pixels using unsafe code, see http://www.bobpowell.net/lockingbits.htm
            int height = bmd.Height;
            int width = bmd.Width;
            int rowPadding = bmd.Stride - (width * pixelSize);
            unsafe
            {
                byte* pixelPtr = (byte*)bmd.Scan0;//starts on the first row
                for (int y = 0; y < height; ++y)
                {
                    for (int x = 0; x < width; ++x)
                    {
                        histogram[(pixelPtr[0] + pixelPtr[1] + pixelPtr[2]) / 3]++;
                        pixelPtr += pixelSize;//advance to next pixel in the row
                    }
                    pixelPtr += rowPadding;//advance ptr to the next pixel row by skipping the padding @ the end of each row.
                }
            }
        }
        finally
        {
            if (bmd != null)
                image.UnlockBits(bmd);
            if (imageWasCloned)
                image.Dispose();
        }

        return histogram;
    } 
```

# asp.net - 如何跨多个 ASP.NET 站点集中 UI？

> ID：1015172
> 
> 赞同：2
> 
> 时间：2009-06-18T21:04:21.750
> 
> 标签：asp.net, themes

我在上一个雇主担任 JSP/Struts 开发人员时负责的项目之一是主题标签库（作为共享库存在于每个 WebSphere 服务器上），它让公司中的任何 Java Web 开发人员都可以使用任何标准Intranet、公共等主题，只需极少的努力。主题包括页眉、页脚、导航以及指向 css 和 javascript 的链接等。当我们给他们选项时，他们甚至可以自定义一些东西，比如选择一个选定的选项卡。

这种设置非常理想，因为我们可以对任何标准 UI 元素进行集中更改，并且所有使用主题的网站都会自动将它们拉入，而无需网站开发人员的任何努力。

随着我在 12 月开始的新工作，我转而使用 ASP.NET。我想在精神上提出与主题应用程序类似的东西，因为我们正在运行一堆不同的站点，这些站点应该具有统一的外观和感觉。

实现这一目标的最佳方法是什么？我宁愿不必重新编译任何东西来更新主题以使其工作。

# 编辑：

虽然我希望得到更好的答案，但.NET 之神显然不赞成我试图完成的工作。以下是找到的三个选项：

1.  **将母版页编译为 DLL 并将其放入 GAC：** 这在简单的情况下有效，但作为 hack，它太脆弱了。我无法让它在我们的网站上正常工作。

2.  **在每个 Web 应用程序中为母版页创建一个虚拟目录：**这确实有效，尽管它不能营造一个非常舒适的开发环境。然而，我们试图摆脱的一件事是必须在每个 Web 应用程序中创建虚拟目录。没有骰子。

3.  **创建一堆自定义控件，编译成DLL，放入GAC：**这是我选择的答案。这是最不集中的选项，每个站点的开发人员都需要做更多的工作，但它似乎是唯一受 Microsoft 支持的方式。

总之，我对 .NET 对此感到非常沮丧。在事物的宏伟计划中，母版页只是代码，我看不出有任何理由不能轻松地将它们集中在多个 Web 应用程序中使用。与 JSP/Java 相比，这似乎是一个重大损失。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-18T21:10:49.163

您可以将一些 UI 放入自定义控件或服务器控件的形式（如果不在 MVC 中），然后将它们放置在 GAC 中，从而分发它们。对该程序集中控件的所有引用都将从 gac 中的最新版本中提取。您还可以通过在服务器级别而不是应用级别控制的 Machine.config 执行操作。

# asp.net - IIS 与 ASP.NET 授权 - 保护静态文件的最简单方法？

> ID：1015173
> 
> 赞同：4
> 
> 时间：2009-06-18T21:04:43.870
> 
> 标签：asp.net, iis, authorization

假设我在 web.config 中有以下内容：

```
<allow roles="Developers" />
<deny users="*"/> 
```

这会锁定对 .aspx、.asmx 和其他 .NET 文件类型的访问，但它仍然允许未经授权的用户打开像 image.jpg 这样的静态文件。我理解为什么当有人要求 image.jpg 时不要求 web.config 提供授权信息（它不是 .NET 类型，IIS 可以绕过它），但是我怎样才能锁定整个应用程序呢？

我在网上找到的建议包括：

*   为有问题的目录创建一个`<location>`条目，IIS / .NET 会选择它。（似乎没有。）
*   您需要编写自己的 ISAPI 过滤器并将所有敏感文件的扩展名映射到该过滤器。
*   您不需要编写自己的 ISAPI 过滤器 - 只需将扩展映射到 aspnet_isapi.dll 即可。
*   您根本不需要编辑 IIS，只需在 web.config 中为您的扩展创建一个 httpHandler 条目。（我真的不想尝试对应用程序中的每个扩展都这样做。）

这些都不像我记得在 Apache 中那样容易。向访问者询问密码而不向任何没有密码的用户提供任何文件（静态或非静态文件）可能最简单的方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-18T21:12:49.220

一个不错的简单方法是升级到 IIS 7——它现在有一个集成的管道。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-18T21:21:49.017

为 IIS 6启用[通配符映射](http://weblogs.asp.net/scottgu/archive/2007/03/04/tip-trick-integrating-asp-net-security-with-classic-asp-and-non-asp-net-urls.aspx)。这将通过 ASP.NET 管道发送所有文件，保证对所有文件进行表单身份验证。它会降低性能（不知道多少）。

对于 IIS 5，嗯，升级到 IIS 6。

你列出了 4 个想法：

*   location 仅在您具有通配符映射（或映射特定扩展名）时才有效。

*   谁想写一个 isapi 过滤器？除非您有 IIS7，否则您无法轻松地使用托管语言来完成此操作。谁想写一个 c++ isapi 过滤器？

*   通配符映射确实适用于上述警告（性能）

*   同样，如果不使用 IIS 注册这些特定扩展并通过 aspnet 路由它们，最后一个选项将无法工作。

# asp.net - 为什么 Windows 资源管理器不按名称对“临时 ASP.NET 文件”目录下的目录进行排序？

> ID：1015174
> 
> 赞同：1
> 
> 时间：2009-06-18T21:04:45.133
> 
> 标签：asp.net, sorting, directory, explorer, temporary-files

当我在 Windows 资源管理器中导航到 C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\Temporary ASP.NET Files\myfirstproject\202aebd2\f0e764e2\assembly\dl3 时，有 108 个文件夹具有 8 个字符的十六进制名称。Explorer 不会按名称（或值）对该文件夹进行排序。是什么赋予了？

![替代文字](../Images/e49af291496ddd2966909b06bc438fd2.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2011-05-14T08:11:14.113

它按名称对它们*进行*排序。不幸的是，它使用了包含数字的[自然排序。](http://www.siao2.com/2006/10/01/778990.aspx)这意味着`99b6...`在 之前排序`182c...`，因为`99 < 182`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-20T17:41:15.483

我也有同样的问题。我发现至少在 XP 中，您可以通过添加注册表项来设置排序顺序。这应该可以解决您的问题。记得重新启动资源管理器。您可以终止其进程，然后通过任务管理器重新启动它。

```
User Key: [HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer]
System Key: [HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\    Explorer]
Value Name: NoStrCmpLogical
Data Type: REG_DWORD (DWORD Value)
Value Data: (1 = Windows 2000 method) 
```

最初在这里找到了答案：

[http://www.pctools.com/guides/registry/detail/1293/](http://www.pctools.com/guides/registry/detail/1293/)

**编辑：**

看起来这个答案实际上来自知识库文章。

[http://support.microsoft.com/kb/319827](http://support.microsoft.com/kb/319827)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-18T21:57:40.283

Windows 可以创建由其他目录支持的目录。例如，旧式 Internet 临时文件由 4 个单独的目录支持。知道这一点，我猜它是单独排序每个目录而不是聚合。

# .net - .net (winforms) 的轻量级richtextbox 控件

> ID：1015186
> 
> 赞同：1
> 
> 时间：2009-06-18T21:09:22.427
> 
> 标签：.net, winforms, richtextbox, performance, replace

有没有轻量版的richtextbox控件？我必须在一个应用程序中创建 300 多个这样的应用程序，这需要时间、内存并减慢一切速度……我所需要的只是拥有一个控件，使我能够更改部分文本的背景/前景...我需要在winforms中...有人知道某种替代品吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-18T21:25:05.030

它是读写的还是只读的？如果它是只读的，那么自己编写代码可能不会太难。（插头：我有一个控件，如果需要，我可以上传到某个地方：）

您可以使用该`OnPaint`事件并使用带有矩形和文本的不同画笔和钢笔。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-18T21:19:22.063

这是一个网格，还是一个单记录表单上的 300 个字段？因为如果是表格，我会建议你的设计有问题。

如果您在网格中需要它，请[考虑分页解决方案](http://www.codeproject.com/KB/miscctrl/Pagable_DatagridView.aspx)。分页解决方案将允许您的用户滚动浏览记录，并且您仍然可以使用富文本框，因为富文本框的数量将受限于当前页面上显示的记录数量。

# asp.net - 将列表框文本传递给 Javascript 弹出窗口 URL

> ID：1015195
> 
> 赞同：3
> 
> 时间：2009-06-18T21:11:37.740
> 
> 标签：asp.net, javascript, listbox, popupwindow

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-18T21:19:31.283

Simply add a client-side onclick handler to your listbox as shown below:

```
<asp:ListBox id="ListBox1" runat="server" .....
           onclick="openPopup(this)">
        ........
</asp:ListBox> 
```

Then add the following javascript code:

```
<script type="text/javascript">
    function openPopup(e){
      window.open(e.value); 
    }
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-18T21:16:41.913

Sure, this should be pretty easy with jQuery. Obviously the URL generation could be reduced to a single statement, but should give you the general idea.

```
$(document).ready(function() {
    $("your-element").click(function() {
        var str = $("#listbox-id").val();
        var url = "your-url.com/" + str;
        window.open(url);
    });
}); 
```

# sharepoint - Microsoft Dynamics CRM 集成 SharePoint

> ID：1015201
> 
> 赞同：8
> 
> 时间：2009-06-18T21:13:08.737
> 
> 标签：sharepoint, dynamics-crm, crm

你们中有人做过 MS CRM 4.0 和 SharePoint 集成吗？任何指针？我是 CRM 和 SharePoint 的新手。

经过更多研究，我想完善我的问题。我基本上想使用 IFRAME 添加一个 SharePoint 选项卡，该选项卡将显示我创建的 SharePoint 页面。关于如何做到这一点的任何提示？

另外，我将如何访问 SharePoint 中的 CRM 数据字段。即，如果我在 SharePoint 中添加一个文件，我希望它具有来自 CRM 属性页的所有元数据。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-22T09:56:16.213

CRM <-> SharePoint 集成非常普遍。MS CRM 博客是一个很好的起点：

[带有 SharePoint 标记的 MS CRM 博客文章](http://blogs.msdn.com/crm/archive/tags/SharePoint/default.aspx)

此外，Dynamics CRM Virtual PC 演示图像中包含一些 SharePoint 集成，其中显示了来自 CRM 中的 SharePoint 的页面。您可以从这里下载 VPC：

[Microsoft Dynamics CRM 4.0 虚拟机](http://www.microsoft.com/downloads/details.aspx?FamilyID=dd939ed9-87a5-4c13-b212-a922cc02b469&displaylang=en)

启动 VPC 后，我记得 Account 实体上有 SharePoint 集成 - 请查看 Customizations 中 Account 表单的 onload 事件。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-19T14:09:12.570

关于如何利用 IFrame 显示自定义 .ASPX 解决方案的问题，您可以参考以下帖子：

[Microsoft Dynamics CRM IFRAME 魔术](http://blogs.msdn.com/crm/archive/2009/04/15/microsoft-dynamics-crm-iframe-magic.aspx)

希望这可以帮助

# qt4 - Qt menuBar() 错误

> ID：1015202
> 
> 赞同：0
> 
> 时间：2009-06-18T21:13:15.833
> 
> 标签：qt4, menubar

我正在学习 Qt4 并完成他们的教程。

在本教程中：

[http://doc.trolltech.com/4.5/mainwindows-menus-mainwindow-cpp.html](http://doc.trolltech.com/4.5/mainwindows-menus-mainwindow-cpp.html)

他们有以下代码：

```
fileMenu = menuBar()->addMenu(tr("&File")); 
```

这会导致编译器抛出此错误

```
g++ -c -pipe -O2 -Wall -W -D_REENTRANT -DQT_NO_DEBUG -DQT_GUI_LIB -DQT_CORE_LIB -DQT_SHARED -I/usr/share/qt4/mkspecs/linux-g++ -I。-I/usr/include/qt4/QtCore -I/usr/include/qt4/QtGui -I/usr/include/qt4 -I. -一世。-一世。-o main.o main.cpp
g++ -c -pipe -O2 -Wall -W -D_REENTRANT -DQT_NO_DEBUG -DQT_GUI_LIB -DQT_CORE_LIB -DQT_SHARED -I/usr/share/qt4/mkspecs/linux-g++ -I。-I/usr/include/qt4/QtCore -I/usr/include/qt4/QtGui -I/usr/include/qt4 -I. -一世。-一世。-o 主窗口.o 主窗口.cpp
MainWindow.cpp：在成员函数'void MainWindow::createMenus()'中：
MainWindow.cpp:56: 错误：'((MainWindow*)this)->MainWindow::menuBar' 不能用作函数
MainWindow.cpp:61: 错误：'((MainWindow*)this)->MainWindow::menuBar' 不能用作函数
make: *** [MainWindow.o] 错误 1

```

有谁知道我该如何解决这个问题？

[编辑] 使用 g++ 添加了完整的错误消息

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-18T22:06:21.827

你确定你继承自`QMainWindow`，你没有创建或继承任何可能影响 name 的字段`menuBar`，并且你已经运行`moc`（或已经`qmake`为你这样做了）？

, `mainwindow.cpp`, `mainwindow.h`, `main.cpp`and `menus.pro`from the example,未修改，应该可以正常工作。

```
$ cd 示例/主窗口/菜单/
$ ls
main.cpp mainwindow.cpp mainwindow.h menus.pro
$ qmake
$ 制作
g++ -c -pipe -g -O2 -mtune=native -pipe -Wall -W -D_REENTRANT -DQT_NO_DEBUG -DQT_GUI_LIB -DQT_CORE_LIB -DQT_SHARED -I/usr/share/qt4/mkspecs/linux-g++ -I。-I/usr/include/qt4/QtCore -I/usr/include/qt4/QtGui -I/usr/include/qt4 -I. -一世。-o 主窗口.o 主窗口.cpp
g++ -c -pipe -g -O2 -mtune=native -pipe -Wall -W -D_REENTRANT -DQT_NO_DEBUG -DQT_GUI_LIB -DQT_CORE_LIB -DQT_SHARED -I/usr/share/qt4/mkspecs/linux-g++ -I。-I/usr/include/qt4/QtCore -I/usr/include/qt4/QtGui -I/usr/include/qt4 -I. -一世。-o main.o main.cpp
/usr/bin/moc -DQT_NO_DEBUG -DQT_GUI_LIB -DQT_CORE_LIB -DQT_SHARED -I/usr/share/qt4/mkspecs/linux-g++ -I. -I/usr/include/qt4/QtCore -I/usr/include/qt4/QtGui -I/usr/include/qt4 -I. -一世。主窗口.h -o moc_mainwindow.cpp
g++ -c -pipe -g -O2 -mtune=native -pipe -Wall -W -D_REENTRANT -DQT_NO_DEBUG -DQT_GUI_LIB -DQT_CORE_LIB -DQT_SHARED -I/usr/share/qt4/mkspecs/linux-g++ -I。-I/usr/include/qt4/QtCore -I/usr/include/qt4/QtGui -I/usr/include/qt4 -I. -一世。-o moc_mainwindow.o moc_mainwindow.cpp
g++ -Wl,--按需 -Wl,--hash-style=both -o menus mainwindow.o main.o moc_mainwindow.o -L/usr/lib64/qt4 -lQtGui -L/usr/lib64 -L/ usr/lib64/qt4 -L/usr/X11R6/lib64 -pthread -lpng -lfreetype -lgobject-2.0 -lSM -lICE -pthread -pthread -lXrender -lXrandr -lXinerama -lfontconfig -lXext -lX11 -lQtCore -lz -lm - pthread -lgthread-2.0 -lrt -lglib-2.0 -ldl -lpthread
$ ls -F
Makefile main.o mainwindow.h menus* moc_mainwindow.cpp
main.cpp mainwindow.cpp mainwindow.o menus.pro moc_mainwindow.o

```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T01:49:15.670

For some reason QMainWindow was not getting setting up correctly. This was fixed by calling the base class constructor.

# regex - 正则表达式解析空格分隔的数据

> ID：1015205
> 
> 赞同：1
> 
> 时间：2009-06-18T21:13:40.093
> 
> 标签：regex, vb.net

我已经编写了代码来将一些数据提取到数据表中并进行一些数据重新格式化。我需要一些帮助将一些文本分成适当的列。

案例 1 我有这样格式的数据，我需要分成 2 列。

```
ABCDEFGS     0298 MSD
SDFKLJSDDSFWW         0298 RFD 
```

我需要第 1 列中的数字之前的文本以及第 2 列中空格之后的数字和文本。文本和数字之间的空格数会有所不同。

案例 2 数据 我有这样的数据，需要分成 3 列。

```
00006011731 TAB FC 10MG 30UOU
00006011754  TAB FC 10MG 90UOU
00006027531  TAB CHEW 5MG 30UOU
00006071131  TAB CHEW 4MG 30UOU
00006027554  TAB CHEW 5MG 90UO
00006384130  GRAN PKT 4MG 30UOU 
```

1.  列是前 11 个字符这很容易
2.  第 2 列应包含前 11 个字符之后的所有文本，但不包括第一个数字。
3.  最后一列是第 2 列之后的所有文本

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-18T21:31:51.303

我会用这些表达式来做到这一点：

```
(?-s)(\S+) +(.+) 
```

和

```
(?-s)(.{11})(\D+)(.+) 
```

并在正则表达式注释模式下分解，它们是：

```
(?x-s)    # Flags: x enables comment mode, -s disables dotall mode.
(       # start first capturing group
 \S+     # any non-space character, greedily matched at least once.
)       # end first capturing group
[ ]+     # a space character, greedily matched at least once. (brackets required in comment mode)
(       # start second capturing group
 .+      # any character (excluding newlines), greedily matched at least once.
)       # end second capturing group 
```

和

```
(?x-s)    # Flags: x enables comment mode, -s disables dotall mode.
(       # start first capturing group
 .{11}   # any character (excluding newlines), exactly 11 times.
)       # end first capturing group
(       # start second capturing group
 \D+     # any non-digit character, greedily matched at least once.
)       # end second capturing group
(       # start third capturing group
 .+      # any character (excluding newlines), greedily matched at least once.
)       # end third capturing group 
```

（“dotall”模式（标志`s`）表示`.`匹配所有字符，包括换行符，因此我们必须禁用它以防止在最后一组中匹配过多。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-18T21:21:35.273

假设您知道如何处理 VB.NET 代码以获取分组（匹配）并且您愿意自己从分组中去除多余的空格

案例 1 的正则表达式是

```
(.*?\s+)(\d+.*) 
```

```
    .*? => 非贪婪地抓住一切，所以它会停在第一个空格
    \s+ => 一个或多个空白字符

    这两个构成第一组。

    \d+ => 一位或多位数字
    .* => 该行的其余部分

    这两个构成第二组。

```

案例 2 的正则表达式是

```
(.{11})(.*?)(\d.*) 
```

```
    .{11} => 匹配 11 个字符（您可以将其限制为仅是字母
             和带有 [a-zA-Z] 或 \d 而不是 .) 的数字

    那是第一组。

    .*? => 非贪婪匹配所有内容，在第一个之前停止
           找到数字（因为这是下一个正则表达式）

    那是第二组。

    \d.* => 一个数字（用于停止前一个 .*？）和该行的其余部分

    那是第三组。

```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-18T21:34:04.390

我会使用 Peter Boughton 的正则表达式，但要确保你有 . 匹配换行符已关闭。如果打开，请确保在末尾添加 $ :)

贪婪的正则表达式会表现得更好。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-06-18T21:34:06.167

对于您要呈现的数据类型，最简单的方法是将行拆分为空格处的字段，然后将您想要的内容重新组合在一起。 `Regex.Split(line, "\\s+")`应该返回一个字符串数组。这对于更改字段中的字符串也更加稳健，例如，如果在第二种情况下，一行读取“00006011731 TAB 3FC 10MG 30UOU”。

# .net - 条件编译与分支代码

> ID：1015207
> 
> 赞同：1
> 
> 时间：2009-06-18T21:14:01.293
> 
> 标签：.net, build-process

[由于服务器兼容性问题（ Windows Server 2000](https://en.wikipedia.org/wiki/Windows_2000#Server_family_features)和[Windows Server 2003](https://en.wikipedia.org/wiki/Windows_Server_2003)生产服务器），我们需要为 .NET 1.1 和 2.0 构建一个项目。

我正在寻求帮助，在条件编译或在源代码控制中分支代码之间做出决定。每个都有优点和缺点。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-18T21:20:30.673

会影响我的解决方案的一件事是知道我希望 1.1 解决方案能够存活多长时间以及它的目的是什么。如果解决方案处于维护模式并且真的不会添加太多新功能，我会选择一个单独的分支解决方案。然后我会小心地在两个分支之间迁移所需的更改。

但是，如果它是一个完整的版本，将具有大多数（如果不是全部）相同的功能，我会走条件编译路线。否则，您所做的每一次检查都必须在完成之前合并到另一个分支中。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-18T21:21:19.657

您有多种选择：

*   写入最小公分母，即 1.1。这应该在 .NET 2.0 上运行良好
*   在 SVN/CVS 中为 1.1 创建一个遗留分支并单独维护它。
*   使用条件编译
*   将特定于每个版本的功能隔离在单独的程序集中，并与每个版本一起提供适当的程序集
*   认真调查服务器升级到最新版本。我以前担任过这个职位，我为管理层进行了成本效益分析，结果表明做双版本比升级要花更多的钱。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-18T21:27:29.613

我要在上一个答案中添加的唯一内容是，如果您进行分支，请尽早并经常合并您的更改。

合并负责人一人。合并大量数据是痛苦的，合并少量数据通常也不是那么糟糕。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-18T21:27:24.713

条件编译只会给你带来麻烦。条件编译用#IFDEF 宏乱扔你的代码。它提示程序员在不存在的地方强制进行抽象。假设您想要创建一个泛型类，现在您想要使其与 .NET 1 兼容，因此您在所有强制转换操作中都有 ifdef。如果出现一个问题，您必须咬住的子弹是解决两个分支中的问题。希望你没有写太多的错误:)

在 .NET 1 和 2 之间没有区别的情况下，分支允许您选择使用来自针对不同平台的两种不同解决方案的共享程序文本文件 .CS。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-18T21:21:20.593

绝对要使用条件编译而不是分支（并尽可能将其隔离到特定模块中）。

分支意味着如果您在代码的不相关部分（即独立于 .NET 版本的代码）中发现错误，您必须在两个分支上都修复它。如果没有必要，不要走那条路。

我更喜欢使用定义接口和特定于平台的派生类的[抽象基类](https://en.wikipedia.org/wiki/Class_(computer_programming)#Abstract_and_concrete)(ABC)，与工厂对象/方法和全文件条件编译一起解决这些问题（我有一个 GUI 库适用于以这种方式实现的 Win32 和[X Window](https://en.wikipedia.org/wiki/X_Window_System)）。

无偿分叉从来都不是一件好事！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-18T21:27:12.390

分支通常是一场噩梦（重复工作和合并问题比比皆是）。恕我直言，它应该只用于你永远不会期望与主分支保持同步的死胡同分支（即你不希望对旧分支进行很多更改，也许只有来自主分支的最关键的错误修复分支）。

条件编译允许您在代码中“并排”查看差异，当您开始更改 #if 中的某些内容时，您还需要考虑 #else 部分，这一点立即显而易见。

# php - ORM、AR、QB 和 DM 之间有什么区别？

> ID：1015209
> 
> 赞同：6
> 
> 时间：2009-06-18T21:14:44.990
> 
> 标签：php, database, orm, activerecord, object

好的，所以每个人都认为（并且有充分的理由）海峡 SQL 是魔鬼。这给我们留下了许多在代码中放置“中间人”以将代码与数据库分开的方法。我现在要吐出我收集的所有信息，希望有人可以让我陷入困境并告诉我我建造了什么。

ORM（对象关系映射）是一系列工具（松散或紧密集成的依赖），它们将数据库行映射到应用程序中的对象。

在 AR（Active-Record）中是一种 ORM，其中数据库表或视图被包装到一个类中，因此对象实例被绑定到表中的单行。

数据映射 (DM) 是一种 ORM，它是在两个不同数据模型之间创建数据元素映射的过程。

这三个都声称像这样工作：

```
$user = new User();
$user->name = 'Fred';
$user->save(); 
```

通常使用这样的 User 类：

```
class User extends Model {
    // Specify the database table
    protected $table = "users";

    // Define your fields
    protected $fields = array(
        'id' => array('type' => 'int', 'primary' => true),
        'name' => array('type' => 'string', 'required' => true),
        'email' => array('type' => 'text', 'required' => true)
    );
} 
```

使用此设置，您无需编写 SQL 即可轻松获取行。

```
// users
$users = $user->fetch(array('id' => 3)); 
```

一些 AR 类实际上看起来更像这样：

```
$db->where('id' => 3);
$db->join('posts', 'posts.user_id = users.id');
$results = $db->get('users'); 
```

好的，现在这是它变得毛茸茸的地方。对于什么类型的代码落在哪里，每个人和他的兄弟似乎都有不同的看法。虽然大多数人都同意 AR 或 DM 是一种 ORM - 但有时区分 AR 和 DM 的线条似乎模糊不清。

我编写了一个使用单个对象 ($db) 的类，您可以在其中调用该对象并处理 SQL 创建以保存/获取结果。

```
//Fetch the users
$results = $db->select('id, name')->where('id > 4')->get('users');

//Set them active
while($user = $results->fetch()) {
    $user->active = TRUE;
    $user->save();
} 
```

所以问题是“它是什么？”，为什么人们不同意这些条款？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-08-24T22:16:50.067

It's not that straight SQL is the devil - sometimes it's pretty much required to write raw SQL to get a query to perform the way you want it to. To me, ORMs are much more about eliminating manual work than anything else (like avoiding SQL at all costs). I just don't want to have to setup all my code objects with all hand-crafted queries for every project. That's just a ridiculous amount of work and thought. Instead, ORM tools provide a nice and automated way to create data objects that would have required a lot of manual work otherwise. Now I can have automatic individual row objects that I can extend and create custom functions for, without thinking about it. I can retrieve related rows from different tables without having to hand-code that query.

It looks like your User class example is from [phpDataMapper](http://phpdatamapper.com/), and if so, it also has some other built-in niceties like auto table migrations so you don't have to distribute an SQL file for your table structures as well as a few helper functions and other things. All features included intended to save you time - that's the main goal.

The most important distinction between AR and DM is that an ActiveRecord (AR) row knows about it's own data store, and thus has saving/updating functions on each row object - $user->save() - The "record" is "active". With DataMapper (DM), on the other hand, each individual row does NOT know about it's own data store, by definition. The row is more of a dumb value object that can be worked with in your code. The mapper is responsible for translating the changes to that row back to the datastore - $mapper->save($user). That's the most significant difference - you will find most of the core ORM features to be the same in almost any implementation. It's just mostly a matter of how it's put together at the core architectural level.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-18T21:17:38.960

You might as well **make up the acronyms** ORM, RM DM whatever ... it is all just **state** transferred from one medium to another and wrapped in function/semantics.

**Sun Microsystems** and **Microsoft** do it all the time with Java and C#. Let's take something simple and give it a new name! What a great idea.

If you say ORM .. everyone knows what it is, in its many guises. Your code looks like the Linq stuff though.

No magic, but alot of buzzwords and fuss IMHO.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-18T21:25:26.713

Agreed with @Aiden Bell. But I think you are right in pointing out the differences. I use LINQ to SQL which in your definition is simply Active-Record style of ORM. For me this works great as I work on a lot of greenfield apps and start at the db to build out my classes. From there I tend to follow a Domain Driven Design approach (I know...this is a classes first concept) working with my generated classes. To me this gets me down the road quickly.

Having said this I have also worked with Entity Framework and NHybernate. Entity Framework is the UBER data mapper and NHybernate is also a data mapper but without as much complexity! I personally feel that Entity Framework has a long ways to go. If I was ever to need more complexity such as in a brownfield application where the db was fairly set in stone and I needed to get my classes to represent my application rather than my database then I would prefer to move to something more along the lines of NHybernate and its data mapping funcationality.

I think each of these tools has it's place. It is not fair to say that they are all the same as they are not. An active record is great in that it generates classes for me that directly represent my database. This works when I created the database or the database closely represents my ubiquitous terms and concepts of the application. The mapping types of orms work when I have a fixed db that doesn't make sense or clearly map to my application in which case I can encapsulate the complexity or lack there of in my database to create a rich domain via the mapping features of the ORM tool.

# wpf - WPF - 普通 [标签：输入] 控件的最佳实践

> ID：1015226
> 
> 赞同：7
> 
> 时间：2009-06-18T21:18:13.297
> 
> 标签：wpf, text, controls, label

我想知道，这是在 WPF 中获得众所周知的标签输入 [或输出，无关紧要] 组合的最好和最快的方法。它是一个简单的任务，想想“对象”ME的快速输出：

* * *

名字 - 克里斯蒂安

年龄 - 28

心情——好

* * *

我知道，我可以使用带有 TextBlocks 的 Grid。但老实说，“短” XAML 几乎是半页长（每个标签上的 RowDefinitions、ColDefs、Grid.Col）

另一种方法，使用三个 StackPanels（水平）和一个垂直似乎也有点愚蠢。在这种情况下，我必须给每个标签一个固定的宽度，以使缩进正确。它只是不“感觉”正确。

因此，鉴于上述情况，您有一个具有 3-6 个属性的自定义对象，您只想将其作为只读转储到您的 GUI，您将如何做（在 WPF 中，Silverlight 也是，如果您真的有心情:)。

当然，我可以为此编写一个用户控件。但是为什么要重新发明轮子，如果它可能已经存在的话......

最后，为了进一步说明，我刚刚在现实生活中创建的示例也是这篇文章的原因：

```
 <StackPanel>
        <StackPanel Orientation="Horizontal">
            <TextBlock Text="Log Count"  Width="100"/>
            <TextBlock Text="{Binding LastLogRun.LogMessageCount}"/>
        </StackPanel>
        <StackPanel Orientation="Horizontal">
            <TextBlock Text="Start Time" Width="100"/>
            <TextBlock Text="{Binding LastLogRun.StartTime}"/>
        </StackPanel>
        <StackPanel Orientation="Horizontal">
            <TextBlock Text="End Time" Width="100"/>
            <TextBlock Text="{Binding LastLogRun.EndTime}"/>
        </StackPanel>
    </StackPanel> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-18T21:57:01.817

您可以使用共享大小组来获得两个排列整齐的列的自动调整大小的网格行为，同时仍然能够将复杂性提取到 UserControl 中。

下面是一个使用 LabeledEdit 控件的示例，它可以满足您的需求。复杂性都被考虑到了 UserControl 中，您需要做的就是记住在 StackPanel 上设置 Grid.IsSharedSizeScope：

```
<Window x:Class="WpfApplication5.Window1"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:WpfApplication5"
        Name="Self" Title="Window1" Height="300" Width="300">
    <StackPanel Grid.IsSharedSizeScope="True">
        <local:LabeledEdit Label="Name"/>
        <local:LabeledEdit Label="Age" Text="28"/>
        <!-- and with databinding... -->
        <local:LabeledEdit Label="Width"
                           Text="{Binding Width, ElementName=Self}"/>
        <local:LabeledEdit Label="Height"
                           Text="{Binding Height, ElementName=Self}"/>
    </StackPanel>
</Window> 
```

这是 UserControl 的源代码。LabeledEdit.xaml：

```
<UserControl x:Class="WpfApplication5.LabeledEdit"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             Name="Self">
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="Auto" SharedSizeGroup="LabeledEdit_Labels"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>
        <Label Grid.Column="0" Content="{Binding Label, ElementName=Self}"/>
        <TextBox Grid.Column="1" Text="{Binding Text, ElementName=Self}"/>
    </Grid>
</UserControl> 
```

LabeledEdit.xaml.cs：

```
using System.Windows;

namespace WpfApplication5
{
    public partial class LabeledEdit
    {
        public static readonly DependencyProperty LabelProperty =
            DependencyProperty.Register("Label", typeof(object), typeof(LabeledEdit));
        public static readonly DependencyProperty TextProperty =
            DependencyProperty.Register("Text", typeof(string), typeof(LabeledEdit),
            new FrameworkPropertyMetadata("", FrameworkPropertyMetadataOptions.BindsTwoWayByDefault));

        public LabeledEdit()
        {
            InitializeComponent();
        }

        public object Label
        {
            get { return GetValue(LabelProperty); }
            set { SetValue(LabelProperty, value); }
        }
        public string Text
        {
            get { return (string)GetValue(TextProperty); }
            set { SetValue(TextProperty, value); }
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-18T21:49:30.193

如果您使用的是 3.5sp1，则可以在绑定中使用 StringFormat。像这样的东西应该工作......

```
<TextBlock Text="{Binding LastLogRun.LogMessageCount, StringFormat={}Log Count - {0}}" /> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-18T21:25:47.307

也许你应该重新考虑你的 UI。为什么要将标签 - 文本框放在同一行上？这是对空间的可怕浪费。

为什么不在*texbox*上贴标签？然后你就有了一个简单的 UI*和*简单的 XAML：

```
<StackPanel Orientation="Vertical">
  <TextBlock>Name</TextBlock>
  <TextBox />
  <TextBlock>Age</TextBlock>
  <TextBox />
  <TextBlock>Mood</TextBlock>
  <TextBox />
</StackPanel> 
```

为您的 TextBlocks 添加一些样式，您就拥有了一个漂亮、干净的 UI，几乎没有重复。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-19T06:37:43.017

[silverlight 工具包](http://www.codeplex.com/Silverlight)有一个非常酷的[DataForm控件！](http://silverlight.codeplex.com/Wiki/View.aspx?title=Silverlight%20Toolkit%20Overview%20Part%205)

# iphone - uiwebview 子类中的保留复制

> ID：1015230
> 
> 赞同：2
> 
> 时间：2009-06-18T21:18:52.000
> 
> 标签：iphone, iphone-sdk-3.0, uiwebview

对于我的应用程序，我将 UIWebView 子类化（此处描述的方法[http://ryan-brubaker.blogspot.com/2009/01/iphone-sdk-uiwebview.html](http://ryan-brubaker.blogspot.com/2009/01/iphone-sdk-uiwebview.html)）。

我这样做是为了拦截触摸事件；当我检测到某些类型的点击时，我会执行相应的自定义操作，然后将事件传递给底层的 UIWebView。

因此，例如，我可以双击视图以使工具栏出现/消失，但单击链接与常规 UIWebView 的工作方式相同。

在 3.0 下，一切都与在 2.2.1 下一样工作（我的双击 + 标准的单击和滚动操作），但按住复制没有。

我想也许 UIResponder 中有一些新的东西我必须重写，但据我所知，它是一样的。

有什么线索吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-18T22:22:36.210

只要您传递所有触摸事件，您就不必做任何特别的事情。当然可以`-webkit-user-select: none;`在您的 CSS 文件中禁用该功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-05-23T14:51:57.733

```
<style>
    body {-webkit-user-select:none;}
</style> 
```

# java - Java FileWriter 帮助

> ID：1015234
> 
> 赞同：0
> 
> 时间：2009-06-18T21:19:49.097
> 
> 标签：java, filewriter

好的......所以我有一个相当有趣的错误......我声明了一个名为 file 的 FileWriter，我让它通过以下 for 循环：

```
for (int i = 0; i < a.radtot; i++) {
    file.write("" + i * a.rstep);

    for (int n = 0; n < a.timetot; n++) {
        file.write("\t " + T[n][i]);
        System.out.println(T[n][i] + " " + n + " " + i);
    }

    file.write("\n");
} 
```

在它的最后， System.out.println 命令打印出我期望的结果，但是文件中途中断了......就像在，而不是打印出 System.out 所做的一切......它停在中间。有谁碰巧知道它为什么会这样做？难道我做错了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-18T21:21:08.923

当你完成它时，[`close()`](http://java.sun.com/javase/6/docs/api/java/io/OutputStreamWriter.html#close())你需要调用它。`FileWriter`这会强制所有输出实际写入磁盘（否则它可能会留在缓冲区中）。

```
for (int i = 0; i < a.radtot; i++) {
    file.write("" + i * a.rstep);

    for (int n = 0; n < a.timetot; n++) {
        file.write("\t " + T[n][i]);
        System.out.println(T[n][i] + " " + n + " " + i);
    }

    file.write("\n");
}
file.close(); // <-- Add this 
```

（我假设您为了简洁而省略了异常处理，所以我也做了同样的事情。`close()`通常会在一个`finally`块中以确保它始终运行。）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-18T21:21:10.140

尝试添加：

```
file.close(); 
```

[`close()`](http://file:///Users/jared/Documents/Specifications/jdk-6u10-docs/api/java/io/Writer.html#close())方法描述说：

> 关闭流，首先刷新它。

# winforms - 如何判断表单是否处于帮助模式？

> ID：1015236
> 
> 赞同：0
> 
> 时间：2009-06-18T21:19:55.947
> 
> 标签：winforms, delphi

有一个我没有来源的控件（Steema TTree），当通过表单请求帮助时，它不会发送帮助消息。（单击对话框中 X 附近的 ?，然后单击 TTree）

我可以直接在表单上调用帮助并传入我自己的帮助消息，但我不知道表单是否处于帮助模式。

表单的光标实际上是 0，即使它有 ? 在它旁边……我觉得很奇怪。

无论如何，我知道我正在努力解决这个问题，但我不在乎。我只想知道是否有办法判断用户是否正在请求帮助并且当前是否有 ? 在他们的光标旁边

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T08:00:25.263

> 表单的光标实际上是 0，即使它有 ? 在它旁边……我觉得很奇怪。

那是因为那是您的表单光标

尝试应该是活动的 Screen.Cursor 。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T13:17:01.940

[托里](http://www.swissdelphicenter.ch/torry/showcode.php?id=1225)帮了忙

```
 procedure wmNCLButtonDown(var Msg: TWMNCLButtonDown); message WM_NCLBUTTONDOWN;
 procedure wmNCLButtonUp(var Msg: TWMNCLButtonUp); message WM_NCLBUTTONUP; 
```

我覆盖了这些函数来设置一个全局变量

```
 fHelpMode : Boolean 
```

为真时

```
 if Msg.HitTest = HTHELP then
      fHelpMode := true; 
```

这让我知道用户何时请求帮助，并且我可以覆盖 TTree 上的鼠标事件来弹出帮助。

# sql - MS SQL Server 2005 - 存储过程“自发中断”

> ID：1015237
> 
> 赞同：8
> 
> 时间：2009-06-18T21:19:55.977
> 
> 标签：sql, sql-server, sql-server-2005, tsql, stored-procedures

客户端在执行存储过程时报告了重复的非常奇怪的行为实例。

他们的代码运行了易失性数据集的缓存转置。在以下情况下，将写入存储过程以按需重新处理数据集：
1\. 自上次重新处理以来数据集已更改
2\. 数据集已 5 分钟未更改

（第二个条件在变化期间停止大量重复重新计算。）

这在几周内运行良好，SP 需要 1-2 秒来完成重新处理，而且它只在需要时才这样做。然后...

*   SP 突然“停止工作”（它只是继续运行并且再也没有返回）
*   我们以一种微妙的方式改变了 SP，它再次起作用了
*   几天后它再次停止工作
*   然后有人说“我们以前见过这个，只需重新编译SP”
*   在没有更改代码的情况下，我们重新编译了 SP，它工作了
*   几天后它再次停止工作

现在已经重复了很多很多次。SP 突然“停止工作”，不再返回，客户端超时。（我们尝试通过管理工作室运行，15分钟后取消查询。）

然而，每次我们重新编译 SP 时，它突然又可以工作了。

我还没有在适当的 EXEC 语句上尝试 WITH RECOMPILE，但我不想以任何方式这样做。它每小时被调用数百次，通常什么都不做（它每天只重新处理数据几次）。如果可能的话，我想避免重新编译相对复杂的 SP 的开销“只是为了避免“不应该”发生的事情......

*   有谁之前经历过这个吗？
*   有人对如何克服它有任何建议吗？

干杯，
德姆斯。

**编辑：**

伪代码如下：

*   从 table_x 中读取“a”
*   从 table_x 中读取“b”
*   如果 (a < b) 返回
*   开始交易
*   删除表_y
*   INSERT INTO table_y <3 选择联合在一起>
*   更新表_x
*   提交交易

选择“不漂亮”，但是当在线执行时，它们会立即执行。包括当 SP 拒绝完成时。探查器显示它是 SP“停止”的 INSERT

SP 没有参数，并且 sp_lock 显示没有阻塞进程。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-18T21:37:41.060

这是参数嗅探的足迹。是的，第一步是尝试 RECOMPILE，尽管它在 2005 年并不总是以您希望的方式工作。

更新：无论如何，我都会在 INSERT 上尝试语句级重新编译，因为这可能是一个统计问题（哦，是的，检查自动统计更新是否打开）。

如果这似乎不适合参数嗅探，那么比较实际的查询计划，从它正常工作的时候开始，从它永远运行的时候开始（如果你不能得到实际的，使用估计的计划，虽然实际更好）。您正在查看计划是否更改。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-18T21:50:58.583

我完全同意参数嗅探诊断。如果您的 SP 输入参数是变化的（或者即使它们没有变化） - 请务必使用局部变量屏蔽它们并在 SP 中使用局部变量。

`WITH RECOMPILE`如果集合正在更改但查询计划不再有效，您也可以使用。

在 SQL Server 2008 中，您可以使用该`OPTIMIZE FOR UNKNOWN`功能。

此外，如果您的流程涉及填充表，然后在另一个操作中使用该表，我建议将流程分解为单独的 SP 并单独调用它们`WITH RECOMPILE`。我认为，当您填充表然后使用该表的结果执行操作时，在流程开始时生成的计划有时可能非常差（差到无法完成）。因为在最初计划时，表与最初插入后有很大不同。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-19T07:33:47.360

正如其他人所说，数据或源表统计信息的变化方式导致缓存查询计划过时。

`WITH RECOMPILE`可能是最快的解决方法 - 用于`SET STATISTICS TIME ON`在无法控制之前找出重新编译成本的实际情况。

如果这仍然不是一个可接受的解决方案，最好的选择可能是尝试重构插入语句。

你没有说你是在使用`UNION`还是`UNION ALL`在你的插入语句中。我见过`INSERT INTO`一些`UNION`奇怪的查询计划，特别是在 SQL 2005 的 SP2 之前的版本上。

*   Raj 关于删除和重新创建目标表的建议 `SELECT INTO`是一种方法。

*   您还可以尝试将三个源查询中的每一个选择到它们自己的临时表中，然后将`UNION`这些临时表一起插入。

*   或者，您可以尝试结合使用这些建议 - 将联合的结果放入带有 的临时表中`SELECT INTO`，然后从中插入到目标表中。

我已经看到所有这些方法都解决了类似场景中的性能问题。测试将揭示哪个可以根据您拥有的数据提供最佳结果。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-18T21:59:09.457

显然更改存储过程（通过重新编译）会更改导致锁定的情况。

尝试按照[此处](https://stackoverflow.com/questions/58709/how-to-log-in-t-sql)或[此处](http://vyaskn.tripod.com/code.htm#txtfile)的说明记录您的 SP 的进度。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-19T02:41:53.627

如果您正在执行以下步骤：

```
DELETE table_y
INSERT INTO table_y <3 selects unioned together> 
```

你可能想试试这个

```
DROP TABLE table_y
SELECT INTO table_y <3 selects unioned together> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-19T07:41:41.353

我同意上面在评论中给出的答案，这听起来像是一个未关闭的事务，特别是如果您仍然能够从查询分析器运行 select 语句。

听起来很像有一个打开的事务，其中 table_y 有一个挂起的删除，此时插入不能发生。

当您的 SP 锁定时，您可以对 table_y 执行插入操作吗？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-19T07:44:49.007

您有索引维护工作吗？

你的统计数据是最新的吗？一种判断方法是检查估计的和实际的查询计划是否有较大的变化。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-20T18:16:24.850

正如其他人所说，这听起来很可能是一个未提交的事务。

我最好的猜测：

您需要确保 table_y 可以完全快速地删除。

如果有其他存储过程或外部代码片段曾经在此表上保存事务，您可能会永远等待。（他们可能会出错并且永远不会关闭交易）

另一个注意事项：如果可能，请尝试使用 truncate。它使用的资源少于没有 where 子句的删除：

```
truncate table table_y 
```

此外，一旦您的 OWN 事务中发生错误，它将导致所有后续调用（显然每 5 分钟一次）“挂起”，除非您处理错误：

```
begin tran
begin try
 -- do normal stuff
end try
begin catch
 rollback
end catch
commit 
```

第一个错误将为您提供有关实际错误的信息。看到它挂在您自己的后续测试中只是次要效果。

# php - 如何评估在PHP中作为字符串传递的公式？

> ID：1015242
> 
> 赞同：37
> 
> 时间：2009-06-18T21:20:53.980
> 
> 标签：php, string, parsing, math, eval

只是想找出正确和更安全的方法来执行作为字符串传递的数学运算。在我的场景中，它是从图像 EXIF 数据中获取的值。

经过一番研究，我发现了两种方法。

首先，使用`eval`：

```
function calculator1($str){
    eval("\$str = $str;");
    return $str;
} 
```

第二，使用`create_function`：

```
function calculator2($str){
    $fn = create_function("", "return ({$str});" );
    return $fn();
}; 
```

这两个示例都需要进行字符串清理以避免恶意代码执行。是否有任何其他或更短的方式这样做？

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2009-06-18T21:28:25.570

这可能会有所帮助。

[http://www.phpclasses.org/browse/package/2695.html](http://www.phpclasses.org/browse/package/2695.html)

烦人的登录需要下载。我复制粘贴在这里给你。

*   此类可用于安全地评估数学表达式。
*   该类可以获取文本字符串中的表达式，并通过替换变量的值和计算数学函数和运算的结果来评估它。
*   它支持隐式乘法、多变量函数和嵌套函数。
*   **它可用于评估来自不受信任来源的表达式。它提供强大的错误检查，并且仅评估有限的功能集。**
*   它可用于从公式表达式生成图形。

```
 /*
    ================================================================================

    EvalMath - PHP Class to safely evaluate math expressions
    Copyright (C) 2005 Miles Kaufmann <http://www.twmagic.com/>

    ================================================================================

    NAME
        EvalMath - safely evaluate math expressions

    SYNOPSIS
        <?
          include('evalmath.class.php');
          $m = new EvalMath;
          // basic evaluation:
          $result = $m->evaluate('2+2');
          // supports: order of operation; parentheses; negation; built-in functions
          $result = $m->evaluate('-8(5/2)^2*(1-sqrt(4))-8');
          // create your own variables
          $m->evaluate('a = e^(ln(pi))');
          // or functions
          $m->evaluate('f(x,y) = x^2 + y^2 - 2x*y + 1');
          // and then use them
          $result = $m->evaluate('3*f(42,a)');
        ?>

    DESCRIPTION
        Use the EvalMath class when you want to evaluate mathematical expressions 
        from untrusted sources.  You can define your own variables and functions,
        which are stored in the object.  Try it, it's fun!

    METHODS
        $m->evalute($expr)
            Evaluates the expression and returns the result.  If an error occurs,
            prints a warning and returns false.  If $expr is a function assignment,
            returns true on success.

        $m->e($expr)
            A synonym for $m->evaluate().

        $m->vars()
            Returns an associative array of all user-defined variables and values.

        $m->funcs()
            Returns an array of all user-defined functions.

    PARAMETERS
        $m->suppress_errors
            Set to true to turn off warnings when evaluating expressions

        $m->last_error
            If the last evaluation failed, contains a string describing the error.
            (Useful when suppress_errors is on).

    AUTHOR INFORMATION
        Copyright 2005, Miles Kaufmann.

    LICENSE
        Redistribution and use in source and binary forms, with or without
        modification, are permitted provided that the following conditions are
        met:

        1   Redistributions of source code must retain the above copyright
            notice, this list of conditions and the following disclaimer.
        2\.  Redistributions in binary form must reproduce the above copyright
            notice, this list of conditions and the following disclaimer in the
            documentation and/or other materials provided with the distribution.
        3\.  The name of the author may not be used to endorse or promote
            products derived from this software without specific prior written
            permission.

        THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR
        IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
        WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
        DISCLAIMED. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT,
        INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
        (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
        SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
        HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,
        STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN
        ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
        POSSIBILITY OF SUCH DAMAGE.

    */

    class EvalMath {

        var $suppress_errors = false;
        var $last_error = null;

        var $v = array('e'=>2.71,'pi'=>3.14); // variables (and constants)
        var $f = array(); // user-defined functions
        var $vb = array('e', 'pi'); // constants
        var $fb = array(  // built-in functions
            'sin','sinh','arcsin','asin','arcsinh','asinh',
            'cos','cosh','arccos','acos','arccosh','acosh',
            'tan','tanh','arctan','atan','arctanh','atanh',
            'sqrt','abs','ln','log');

        function EvalMath() {
            // make the variables a little more accurate
            $this->v['pi'] = pi();
            $this->v['e'] = exp(1);
        }

        function e($expr) {
            return $this->evaluate($expr);
        }

        function evaluate($expr) {
            $this->last_error = null;
            $expr = trim($expr);
            if (substr($expr, -1, 1) == ';') $expr = substr($expr, 0, strlen($expr)-1); // strip semicolons at the end
            //===============
            // is it a variable assignment?
            if (preg_match('/^\s*([a-z]\w*)\s*=\s*(.+)$/', $expr, $matches)) {
                if (in_array($matches[1], $this->vb)) { // make sure we're not assigning to a constant
                    return $this->trigger("cannot assign to constant '$matches[1]'");
                }
                if (($tmp = $this->pfx($this->nfx($matches[2]))) === false) return false; // get the result and make sure it's good
                $this->v[$matches[1]] = $tmp; // if so, stick it in the variable array
                return $this->v[$matches[1]]; // and return the resulting value
            //===============
            // is it a function assignment?
            } elseif (preg_match('/^\s*([a-z]\w*)\s*\(\s*([a-z]\w*(?:\s*,\s*[a-z]\w*)*)\s*\)\s*=\s*(.+)$/', $expr, $matches)) {
                $fnn = $matches[1]; // get the function name
                if (in_array($matches[1], $this->fb)) { // make sure it isn't built in
                    return $this->trigger("cannot redefine built-in function '$matches[1]()'");
                }
                $args = explode(",", preg_replace("/\s+/", "", $matches[2])); // get the arguments
                if (($stack = $this->nfx($matches[3])) === false) return false; // see if it can be converted to postfix
                for ($i = 0; $i<count($stack); $i++) { // freeze the state of the non-argument variables
                    $token = $stack[$i];
                    if (preg_match('/^[a-z]\w*$/', $token) and !in_array($token, $args)) {
                        if (array_key_exists($token, $this->v)) {
                            $stack[$i] = $this->v[$token];
                        } else {
                            return $this->trigger("undefined variable '$token' in function definition");
                        }
                    }
                }
                $this->f[$fnn] = array('args'=>$args, 'func'=>$stack);
                return true;
            //===============
            } else {
                return $this->pfx($this->nfx($expr)); // straight up evaluation, woo
            }
        }

        function vars() {
            $output = $this->v;
            unset($output['pi']);
            unset($output['e']);
            return $output;
        }

        function funcs() {
            $output = array();
            foreach ($this->f as $fnn=>$dat)
                $output[] = $fnn . '(' . implode(',', $dat['args']) . ')';
            return $output;
        }

        //===================== HERE BE INTERNAL METHODS ====================\\

        // Convert infix to postfix notation
        function nfx($expr) {

            $index = 0;
            $stack = new EvalMathStack;
            $output = array(); // postfix form of expression, to be passed to pfx()
            $expr = trim(strtolower($expr));

            $ops   = array('+', '-', '*', '/', '^', '_');
            $ops_r = array('+'=>0,'-'=>0,'*'=>0,'/'=>0,'^'=>1); // right-associative operator?  
            $ops_p = array('+'=>0,'-'=>0,'*'=>1,'/'=>1,'_'=>1,'^'=>2); // operator precedence

            $expecting_op = false; // we use this in syntax-checking the expression
                                   // and determining when a - is a negation

            if (preg_match("/[^\w\s+*^\/()\.,-]/", $expr, $matches)) { // make sure the characters are all good
                return $this->trigger("illegal character '{$matches[0]}'");
            }

            while(1) { // 1 Infinite Loop ;)
                $op = substr($expr, $index, 1); // get the first character at the current index
                // find out if we're currently at the beginning of a number/variable/function/parenthesis/operand
                $ex = preg_match('/^([a-z]\w*\(?|\d+(?:\.\d*)?|\.\d+|\()/', substr($expr, $index), $match);
                //===============
                if ($op == '-' and !$expecting_op) { // is it a negation instead of a minus?
                    $stack->push('_'); // put a negation on the stack
                    $index++;
                } elseif ($op == '_') { // we have to explicitly deny this, because it's legal on the stack 
                    return $this->trigger("illegal character '_'"); // but not in the input expression
                //===============
                } elseif ((in_array($op, $ops) or $ex) and $expecting_op) { // are we putting an operator on the stack?
                    if ($ex) { // are we expecting an operator but have a number/variable/function/opening parethesis?
                        $op = '*'; $index--; // it's an implicit multiplication
                    }
                    // heart of the algorithm:
                    while($stack->count > 0 and ($o2 = $stack->last()) and in_array($o2, $ops) and ($ops_r[$op] ? $ops_p[$op] < $ops_p[$o2] : $ops_p[$op] <= $ops_p[$o2])) {
                        $output[] = $stack->pop(); // pop stuff off the stack into the output
                    }
                    // many thanks: http://en.wikipedia.org/wiki/Reverse_Polish_notation#The_algorithm_in_detail
                    $stack->push($op); // finally put OUR operator onto the stack
                    $index++;
                    $expecting_op = false;
                //===============
                } elseif ($op == ')' and $expecting_op) { // ready to close a parenthesis?
                    while (($o2 = $stack->pop()) != '(') { // pop off the stack back to the last (
                        if (is_null($o2)) return $this->trigger("unexpected ')'");
                        else $output[] = $o2;
                    }
                    if (preg_match("/^([a-z]\w*)\($/", $stack->last(2), $matches)) { // did we just close a function?
                        $fnn = $matches[1]; // get the function name
                        $arg_count = $stack->pop(); // see how many arguments there were (cleverly stored on the stack, thank you)
                        $output[] = $stack->pop(); // pop the function and push onto the output
                        if (in_array($fnn, $this->fb)) { // check the argument count
                            if($arg_count > 1)
                                return $this->trigger("too many arguments ($arg_count given, 1 expected)");
                        } elseif (array_key_exists($fnn, $this->f)) {
                            if ($arg_count != count($this->f[$fnn]['args']))
                                return $this->trigger("wrong number of arguments ($arg_count given, " . count($this->f[$fnn]['args']) . " expected)");
                        } else { // did we somehow push a non-function on the stack? this should never happen
                            return $this->trigger("internal error");
                        }
                    }
                    $index++;
                //===============
                } elseif ($op == ',' and $expecting_op) { // did we just finish a function argument?
                    while (($o2 = $stack->pop()) != '(') { 
                        if (is_null($o2)) return $this->trigger("unexpected ','"); // oops, never had a (
                        else $output[] = $o2; // pop the argument expression stuff and push onto the output
                    }
                    // make sure there was a function
                    if (!preg_match("/^([a-z]\w*)\($/", $stack->last(2), $matches))
                        return $this->trigger("unexpected ','");
                    $stack->push($stack->pop()+1); // increment the argument count
                    $stack->push('('); // put the ( back on, we'll need to pop back to it again
                    $index++;
                    $expecting_op = false;
                //===============
                } elseif ($op == '(' and !$expecting_op) {
                    $stack->push('('); // that was easy
                    $index++;
                    $allow_neg = true;
                //===============
                } elseif ($ex and !$expecting_op) { // do we now have a function/variable/number?
                    $expecting_op = true;
                    $val = $match[1];
                    if (preg_match("/^([a-z]\w*)\($/", $val, $matches)) { // may be func, or variable w/ implicit multiplication against parentheses...
                        if (in_array($matches[1], $this->fb) or array_key_exists($matches[1], $this->f)) { // it's a func
                            $stack->push($val);
                            $stack->push(1);
                            $stack->push('(');
                            $expecting_op = false;
                        } else { // it's a var w/ implicit multiplication
                            $val = $matches[1];
                            $output[] = $val;
                        }
                    } else { // it's a plain old var or num
                        $output[] = $val;
                    }
                    $index += strlen($val);
                //===============
                } elseif ($op == ')') { // miscellaneous error checking
                    return $this->trigger("unexpected ')'");
                } elseif (in_array($op, $ops) and !$expecting_op) {
                    return $this->trigger("unexpected operator '$op'");
                } else { // I don't even want to know what you did to get here
                    return $this->trigger("an unexpected error occured");
                }
                if ($index == strlen($expr)) {
                    if (in_array($op, $ops)) { // did we end with an operator? bad.
                        return $this->trigger("operator '$op' lacks operand");
                    } else {
                        break;
                    }
                }
                while (substr($expr, $index, 1) == ' ') { // step the index past whitespace (pretty much turns whitespace 
                    $index++;                             // into implicit multiplication if no operator is there)
                }

            } 
            while (!is_null($op = $stack->pop())) { // pop everything off the stack and push onto output
                if ($op == '(') return $this->trigger("expecting ')'"); // if there are (s on the stack, ()s were unbalanced
                $output[] = $op;
            }
            return $output;
        }

        // evaluate postfix notation
        function pfx($tokens, $vars = array()) {

            if ($tokens == false) return false;

            $stack = new EvalMathStack;

            foreach ($tokens as $token) { // nice and easy
                // if the token is a binary operator, pop two values off the stack, do the operation, and push the result back on
                if (in_array($token, array('+', '-', '*', '/', '^'))) {
                    if (is_null($op2 = $stack->pop())) return $this->trigger("internal error");
                    if (is_null($op1 = $stack->pop())) return $this->trigger("internal error");
                    switch ($token) {
                        case '+':
                            $stack->push($op1+$op2); break;
                        case '-':
                            $stack->push($op1-$op2); break;
                        case '*':
                            $stack->push($op1*$op2); break;
                        case '/':
                            if ($op2 == 0) return $this->trigger("division by zero");
                            $stack->push($op1/$op2); break;
                        case '^':
                            $stack->push(pow($op1, $op2)); break;
                    }
                // if the token is a unary operator, pop one value off the stack, do the operation, and push it back on
                } elseif ($token == "_") {
                    $stack->push(-1*$stack->pop());
                // if the token is a function, pop arguments off the stack, hand them to the function, and push the result back on
                } elseif (preg_match("/^([a-z]\w*)\($/", $token, $matches)) { // it's a function!
                    $fnn = $matches[1];
                    if (in_array($fnn, $this->fb)) { // built-in function:
                        if (is_null($op1 = $stack->pop())) return $this->trigger("internal error");
                        $fnn = preg_replace("/^arc/", "a", $fnn); // for the 'arc' trig synonyms
                        if ($fnn == 'ln') $fnn = 'log';
                        eval('$stack->push(' . $fnn . '($op1));'); // perfectly safe eval()
                    } elseif (array_key_exists($fnn, $this->f)) { // user function
                        // get args
                        $args = array();
                        for ($i = count($this->f[$fnn]['args'])-1; $i >= 0; $i--) {
                            if (is_null($args[$this->f[$fnn]['args'][$i]] = $stack->pop())) return $this->trigger("internal error");
                        }
                        $stack->push($this->pfx($this->f[$fnn]['func'], $args)); // yay... recursion!!!!
                    }
                // if the token is a number or variable, push it on the stack
                } else {
                    if (is_numeric($token)) {
                        $stack->push($token);
                    } elseif (array_key_exists($token, $this->v)) {
                        $stack->push($this->v[$token]);
                    } elseif (array_key_exists($token, $vars)) {
                        $stack->push($vars[$token]);
                    } else {
                        return $this->trigger("undefined variable '$token'");
                    }
                }
            }
            // when we're out of tokens, the stack should have a single element, the final result
            if ($stack->count != 1) return $this->trigger("internal error");
            return $stack->pop();
        }

        // trigger an error, but nicely, if need be
        function trigger($msg) {
            $this->last_error = $msg;
            if (!$this->suppress_errors) trigger_error($msg, E_USER_WARNING);
            return false;
        }
    }

    // for internal use
    class EvalMathStack {

        var $stack = array();
        var $count = 0;

        function push($val) {
            $this->stack[$this->count] = $val;
            $this->count++;
        }

        function pop() {
            if ($this->count > 0) {
                $this->count--;
                return $this->stack[$this->count];
            }
            return null;
        }

        function last($n=1) {
            return $this->stack[$this->count-$n];
        }
    } 
```

**编辑：** Jitters 想要支持反向波兰符号的版本。让我想起了我的大学时代，那时我有一个 HP 计算器 :)

```
 <?php
    /* This Class can be useful for writting RPN macros or FORTH like parsers 
           @Author: Arturo Gonzalez-Mata Santana (Spain)
                 arturogmata@gmail.com
        @copyright 2007: www.phpsqlasp.com

        It is part of a project to recover "macros" from some old aplications 

    This code is free software; you can redistribute it and/or
    modify it under the terms of the GNU General Public License
    as published by the Free Software Foundation; either version 3
    of the License, or (at your option) any later version.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with this program; if not, write to the Free Software
    Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA
    */
    class RPNstack
    {
        var $data=array();
        var $compare=0;
        function pop() {return array_shift ($this->data);}
        function push($x) {array_unshift($this->data, $x);}
        function count() {return count($this->data);}
        function first() {return $this->data[0];}
        function top() {return end($this->data);}  //last element of 
        function swap() { // interchange tow elements
            $t = $this->data[1];
            $this->data[1] = $this->data[0];
            $this->data[0] = $t;
            }
        function dup() {  // put a copy of X element in the stack
            array_unshift($this->data, $this->data[0]);
            }

        function dump(){ // dump array data for debuging
            print_r($this->data);
            }

        function parse($tok)  // execute actions with the stack for each token
        {
            $r = null;
            $tok = strtoupper(trim($tok));
            //$this->dump(); // this line is for debugging purpose only
            switch ($tok) :
                // FIRST "IF THEN" AND OTHER FLOW CONTROLS
                case ('THEN'): break;
                case('IF'):
                    if ($this->pop() == 0) do {  // if condition is false do nothing until "THEN"
                        $tok = strtoupper(strtok (" "));
                        } while ($tok <> "THEN");  // IF THERE IS NO "THEN" THIS SHALL BE AN ENLESS LOOP
                    break;

                //   basic math operators   //OPERADORES MATEMATICOS BASICOS
                case('+'):
                    $r = $this->pop() + $this->pop();
                    // $r = array_shift($this->data) + array_shift($this->data);  // is more efficient but less understable
                    break;        
                case('-'):
                    $r = $this->pop(); $r = $this->pop()-$r;
                    break;
                case('*'):
                    $r = $this->pop() *  $this->pop();
                    break;
                case('/'):
                    $r = $this->pop(); $r = $this->pop() / $r;
                    break;
                // stack operators  //OPERADORES DE PILA  
                case ('DUP'):
                    $r=$this->dup();
                    break;
                case ('SWAP'):
                    $this->swap();
                    break;

                // COMPARISON OPERATORS
                case ('='):
                    if ($this->data[0] == $this->data[1]) $r = $this->push(1);
                    else $r = $this->push(0);
                    break;
                case ('<>'):
                    if ($this->data[0] <> $this->data[1]) $r = $this->push(1);
                    else $r = $this->push(0);
                    break;
                case ('<'):
                    if ($this->data[0] < $this->data[1]) $r = $this->push(1);  
                    else $r = $this->push(0);                            
                    break;
                case ('>'):
                    if ($this->data[0] > $this->data[1])  $r = $this->push(1);  
                    else $r = $this->push(0);                            
                    break;
                case ('>='):
                    if ($this->data[0] >= $this->data[1])  $r = $this->push(1);  
                    else $r = $this->push(0);                            
                    break;
                case ('<='):
                    if ($this->data[0] <= $this->data[1])  $r = $this->push(1);  
                    else $r = $this->push(0);                            
                    break;

                // WARNING FOR NON IMPLEMENTED FUNCTIONS
                default:
                        return sprintf('I don\'t know how to "%s" ', $tok);
            endswitch;
            if (!is_null($r)) $this->push($r); 
            return $r;
        } // parse

        function parse_line($cadena)
        {
            $tok = strtok ($cadena," ");
            while ($tok!= '') {
                if (is_numeric ($tok)) {
                    $this->push($tok);
                } else {
                    $r = $this->parse($tok);
                }
                $tok = strtok (" ");
            }
            return $r;
        }

    } // class RPN

    ?> 
```

# hardware - 有没有办法以编程方式访问 DELL XPS 媒体按钮

> ID：1015253
> 
> 赞同：6
> 
> 时间：2009-06-18T21:22:48.123
> 
> 标签：hardware

如果您看过戴尔 XPS 的实际操作，您可能已经注意到它在普通键盘上方的漂亮媒体按钮：

[替代文字 http://blog.evolvedsoftwarestudios.com/wp-content/uploads/2008/03/img-1397.jpg](http://blog.evolvedsoftwarestudios.com/wp-content/uploads/2008/03/img-1397.jpg)

当笔记本启动和触摸它们时，它们会闪烁。

有人知道如何使这些按钮以编程方式闪烁吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-20T10:09:09.883

我有一台旧的 IBM 笔记本电脑，它的 LCD 框架顶部安装了一个键盘灯 LED（iSight 位于 MacBook 或 MacBook Pro 上）。我发现我可以`/proc/acpi`在 Linux 下访问这个灯。

我编写了一个简单的脚本，通过与 /proc 交互来点亮和熄灭灯光。[我的博客上](http://lambie.org/2005/07/07/flasher/)有一个帖子，里面有代码。

您可能想尝试运行 Ubuntu live CD 并查看它是否检测到按钮，以及您是否可以通过`/proc`. 快速搜索表明，较新的 XPS 系统可以在 Ubuntu 上开箱即用，因此这是一个很好的起点。

# asp.net - 是否有任何 .NET 内容管理系统专注于可用性并避免臃肿？

> ID：1015267
> 
> 赞同：6
> 
> 时间：2009-06-18T21:25:49.053
> 
> 标签：asp.net, content-management-system, usability, content-management

我在一家主要基于 .NET 的商店工作，我们正在尝试挑选一个内容管理系统来使用。这意味着我们很可能无法使用任何常见的开源 CMS 项目（Plone、phpNuke、非基于 .NET 的东西等）。

因为我是一个巨大的可用性书呆子（刚刚读完 Norman 的 The Design of Everyday Things），我一直从这个角度看待它们。坦白说，我并没有太感动。这段话总结了一下：

> 大多数开源内容管理软件都是无用的。唯一更糟糕的是我使用过的每个商业 CMS。-[杰弗里·维恩](http://adaptivepath.com/ideas/essays/archives/000365.php)

以下是我们要求的简短列表：

*   必须基于.NET
*   更喜欢开源或便宜的一面
*   有限的功能集（我们不需要太多的功能，它们使事情更难使用）
*   是否需要 Active Directory 集成和强大的权限
*   应该关注网络标准和可用性

我知道这可能是一个不可能的功能列表，但是是否有任何内容管理系统看起来不像戴森那样糟糕？

## 编辑：

这是目前的情况：

*   我要推动N2。我的 Active Directory 集成运行良好（我什至编写了自定义角色提供程序）。唯一缺少的是工作流功能。希望我能得到一些东西，因为这是最后一个症结所在。如果我能弄清楚，N2Contrib 项目可能会提供一个起点。

*   如果/当它启动时，我仍然很想查看 Stencil CMS。

*   我的一位同事试图让 Umbraco 继续前进，但运气不佳。

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-18T21:34:16.540

自插是蹩脚的，但你所描述的几乎*正是*我[准备以](http://www.stencilcms.com/)79 美元一盒的价格发布的东西。如果几周后您仍在寻找，请看一看。如果您愿意，请给我发电子邮件 (rex@stencilcms.com)。

我听说过关于[Umbraco](http://umbraco.org/)的正面和负面反馈。很多人喜欢[Graffiti](http://graffiticms.com/)，但它比成熟的 CMS 更面向博客。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-18T21:31:14.347

查看 N2 ( [http://n2cms.com/](http://n2cms.com/) )。我认为它涵盖了您的大部分（如果不是全部）需求（我认为它目前不具备 Active Directory 功能）。我们正在使用 N2，我非常喜欢它的灵活性。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-18T21:31:26.813

我的公司刚刚完成了对几个基于 .NET 的商业 CMS/门户平台的审查，虽然我无法透露其中有哪些人（感谢 NDA！），但我可以告诉你，IMO 他们都非常非常糟糕。

希望你能很快找到。我会密切关注这个线程，希望我们错过了一些东西。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-18T21:28:37.240

我们有类似的要求并选择了[Telerik Sitefinity](http://www.sitefinity.com/)。它有它的缺点，但总的来说，到目前为止我对它很满意。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-18T21:33:29.180

不幸的是，杰弗里说的是实话。这可能就是我每隔几年从头开始构建一个新的自定义 cms 的原因。基本上，“盒装” CMS 软件包的动机是拥有地球上的每一个功能，并成为每个人的一切，因此对任何人都没有做任何特别好的事情。伴随功能膨胀而来的是可用性噩梦。除非您开始自定义，然后您通常最终会分叉项目并失去社区更新的优势。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-24T12:21:52.567

Kentico CMS 根据您的列表：

*   必须基于.NET

它基于 .net，.NET Framework 2.0 或更高版本

*   更喜欢开源或便宜的一面

提供可用于商业目的的免费版本，付费许可证起价 750 美元，源代码是一个选项

*   有限的功能集（我们不需要太多的功能，它们使事情更难使用）

许多内置模块/功能，无论如何都可以轻松禁用它们以保持 UI 易于使用

*   是否需要 Active Directory 集成和强大的权限

广告、表格和实时 ID！一体化

*   应该关注网络标准和可用性

UTF-8 支持包括 RTL 语言、WAI 兼容、XHTML 兼容、XML、XHTML、HTML、XSLT、CSS。

即时在线演示或下载地址：http: [//www.kentico.com/Download.aspx](http://www.kentico.com/Download.aspx)

# windows - GNU CC 和 Windows

> ID：1015270
> 
> 赞同：3
> 
> 时间：2009-06-18T21:26:38.913
> 
> 标签：windows, cygwin, mingw, gnu

我对在 Windows 上使用 GNU CC 的选项有点困惑。

如果我想主要开发控制台应用程序（而不是 GUI 应用程序），我需要什么？Cygwin 和 MinGW 的数字在哪里？例如，如果我使用 NetBeans IDE C/C++ 选项，则需要安装 Cygwin。

是否有任何选项可以在没有 Cygwin 的情况下允许控制台应用程序开发？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-18T21:30:49.747

MinGW 和 Cygwin 都为您提供 gcc 编译器，但如果您使用 MinGW，则无需安装 Cygwin，因为它使用本地 Windows 库而不是 Cygwin 库

Cygwin 不仅仅是编译器，它试图通过在 Windows SDK 之上构建大量 UNIX 库来提供 UNIX 编程环境。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-18T21:33:58.757

您可以安装 CodeBlocks IDE 或 DevCPP ide。如果您不需要特殊的 posix api，那么您不需要安装 cygwin。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-18T21:32:44.047

你真的应该看看 Visual C++ Express。它使在 Windows 上的开发变得更加容易。它是免费的，Visual C++ 是开发 Windows 应用程序的首选方式。是的，您也可以制作控制台应用程序。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-18T22:04:27.587

这澄清了事情。我对类似 *nix 的环境不是特别感兴趣。我更感兴趣的是获得一个与 C99 密切符合的 GNU C 编译器（我相信最新的 GCC 编译器会这样做）并将其用作 C 学习练习（因此是控制台而不是 GUI 应用程序）

在我看来，NetBeans IDE/Cygwin 选项安装了早期版本的编译器。

因此，如果我想使用 GNU C，我正在寻找 MinGW。顺便说一下，免费的 Pelles C 编译器/IDE 有一个非常完整的 C99 实现。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-18T21:33:03.597

如果您愿意，可以将 vc express 用于 concole 应用程序，也可以将任何编译器用于 win 平台。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-06-28T20:24:46.247

MinGW 可以支持多种语言以及 GNU C 编译器。它还附带 msys 包，可以模拟 UNIX 环境。Cygwin 和 msys 做同样的事情。我建议您安装具有完整 msys 支持的 MinGW。

# c++ - C++容器/迭代器依赖问题

> ID：1015276
> 
> 赞同：1
> 
> 时间：2009-06-18T21:27:34.433
> 
> 标签：c++, iterator, containers

我正在研究一个看起来像这样的容器类：

```
class hexFile {
public:
    HANDLE theFile;
    unsigned __int64 fileLength;
    hexFile(const std::wstring& fileName)
    {
        theFile = CreateFile(fileName.c_str(), GENERIC_READ, FILE_SHARE_READ | FILE_SHARE_DELETE | FILE_SHARE_WRITE, NULL, OPEN_EXISTING, FILE_ATTRIBUTE_NORMAL);
        if (theFile == INVALID_HANDLE_VALUE);
        {
            throw std::runtime_error(eAsciiMsg("Could not open file!"));
        }
        BY_HANDLE_FILE_INFORMATION sizeFinder;
        GetFileInformationByHandle(theFile, &sizeFinder);
        fileLength = sizeFinder.nFileSizeHigh;
        fileLength <<= 32;
        fileLength += sizeFinder.nFileSizeLow;
    };
    ~hexFile()
    {
        CloseHandle(theFile);
    };
    hexIterator begin()
    {
        hexIterator theIterator(this, true);
        return theIterator;
    };
    hexIterator end()
    {
        hexIterator theIterator(this, false);
        return theIterator;
    };
}; 
```

还有一个与之匹配的迭代器类，如下所示：

```
class hexIterator : public std::iterator<std::bidirectional_iterator_tag, wchar_t>
{
    hexFile *parent;
public:
    bool highCharacter;
    __int64 filePosition;
    hexIterator(hexFile* file, bool begin);
    hexIterator(const hexIterator& toCopy);
    ~hexIterator();
    hexIterator& operator++()
    {
        return ++this;
    }
    hexIterator& operator++(hexIterator& toPlus);
    hexIterator& operator--()
    {
        return --this;
    }
    hexIterator& operator--(hexIterator& toMinus);
    hexIterator& operator=(const hexIterator& toCopy);
    bool operator==(const hexIterator& toCompare) const;
    bool operator!=(const hexIterator& toCompare) const;
    wchar_t& operator*();
    wchar_t* operator->();
}; 
```

我的问题是......两个类都需要根据另一个类来实现。我不确定如何在迭代器中引用容器，例如，因为定义迭代器时，容器还没有定义。

怎么可能做到这一点？

比利3

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-18T21:31:48.870

前向声明一个在另一个之前。您可以在另一个类的声明中使用对前向声明的类的引用，所以这应该有效：

```
class hexFile; // forward

class hexIterator : ,,, {
   ...
};

class hexFile {
   ...
}; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-18T21:32:37.120

使用前向引用开始您的`.h`文件：

```
class hexFile; 
```

然后跟随`class hexIterator`( 这将编译，因为它只需要一个指向的*指针*`hexFile`) 的完整定义，然后是`class hexFile`(现在编译得很好，因为到那时编译器知道所有关于`hexIterator`) 的完整定义。

在`.cpp`文件中，由于您包含`.h`当然，所有内容都将是已知的，您可以按照您希望的任何顺序实现这些方法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-18T21:33:26.730

我建议将定义与类的声明分开。在头文件中，前向声明 hexFile 类，然后在头文件中完全声明它们。然后，您可以在关联的源文件中更详细地定义各个类。

# .net - Linq To 实体查询奇数

> ID：1015279
> 
> 赞同：2
> 
> 时间：2009-06-18T21:28:11.063
> 
> 标签：.net, linq, entity-framework, linq-to-entities

我不断收到关于 Linq to Entities 的异常，它不支持这样的特定查询表达式：

```
MyDataContext db = new MyDataContext()
Brand = db.Brands.First(b => b.BrandId == Int32.Parse(brandIdString)) 
```

我不是试图将字符串解析传递给实体存储，我只是想将该字符串解析为一个整数进行比较。是唯一的解决方法是事先做这个还是我完全离开这里？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-18T21:38:17.187

最好的选择（至少对于您给出的示例）是从您的 LINQ 语句中提取操作：

```
Int32 brandId = Int32.Parse(brandIdString)
MyDataContext db = new MyDataContext()
Brand = db.Brands.First(b => b.BrandId == brandId ) 
```

*解释：*

当您使用 LINQ 时，它想找出方法将尽可能多的工作卸载到您的数据库查询中。为了做到这一点，它实际上创建了一个表达式树，其中包含您在各种 lambda 表达式中告诉它要做的所有事情。然后，当您要运行查询时，它会决定哪种 SQL 语句最适合执行您要求它执行的操作。这允许它进行一些非常花哨的优化。但是，如果它不知道如何将某些内容转换为 SQL 语句，那么当您尝试运行查询时它会生您的气。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-18T21:31:51.663

你能用这个吗？

```
MyDataContext db = new MyDataContext();
Brand b = db.Brands.Where(b => b.BrandId == Int32.Parse(brandIdString)).First(); 
```

另一种解决方案（不使用 Lambdas...）是这样的：

```
MyDataContext db = new MyDataContext();

Brand b = (from Brand b in db.Brands
           where b.BrandId == Int32.Parse(brandIdString)
           select b).First(); 
```

（此外，您在`;`每个代码行的末尾都缺少 ，并且您没有为从查询中得到的任何内容指定变量名，但我想这些只是这里的拼写错误......）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T12:49:05.150

该数据库不存在以满足字符串解析需求。在涉及之前执行所需的解析。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2009-06-18T21:31:01.557

是的。这很糟糕。我发现您必须在查询之外对数据进行解析或规范化......然后传入结果。我在尝试在查询范围内进行一些日期格式化时遇到了这个问题。我最终将它从查询中移出到一个字符串变量中，然后在已经应用了正确格式的变量中传递了它。

LAME - 实体框架还有很长的路要走！

# c# - 以 1 位深度保存 TIF 的最佳 Web 可视格式是什么？

> ID：1015280
> 
> 赞同：5
> 
> 时间：2009-06-18T21:28:19.063
> 
> 标签：c#, .net, image, tiff

我想转换`TIF`为可在网页中查看的图像类型。

`TIFs`它们是黑白的，因此`JPG`根本无法正常工作，并且在转换后最终会更大。

以下是我使用 C# 执行的一些测试并进行`Image.Save`转换：

原始`TIF`为 7KB（位深：1）。

转换成：

*   JPG：101KB（位深：24）
*   BMP：256KB（位深：1）
*   GIF：17KB（位深：8）
*   PNG：11KB（位深：1）

然后我转换了一个`TIF`有 3 页的多页。原始大小为 134KB（位深：1）。

总共转换了 3 张图像：

*   JPG：1324KB（位深：24）
*   BMP：768KB（位深：1）
*   GIF：221KB（位深：8）
*   PNG：155KB（位深：1）

我从多页开始`TIF`，我需要转换为可在浏览器中查看。`PNG`根据我上面概述的基本测试，它看起来是最好的格式。我应该使用/考虑其他图像格式吗？

我是否缺少任何其他选项来减小文件大小？

**编辑：**我已经添加了有关每种格式的位深度的更多信息。`BMP`和`PNG`保持与 相同的位深度`TIF`。有没有办法减少`GIF`或`JPG`位深度以希望显着减小大小？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-19T15:34:25.347

PNG当然是您最好的选择。

您的 PNG 最终比原始 TIF 大的原因可能是运行时没有进行所有可能的压缩。如果您确实需要压缩 PNG 文件中的每个最后一个小字节，我建议您使用[AdvancePNG](http://advancemame.sourceforge.net/comp-readme.html)或[OptiPNG 之](http://optipng.sourceforge.net/)类的工具，以便在写出 PNG 后对其进行压缩。OptiPNG 的作者写了一篇很好的文章，其中包含[一些其他 PNG 优化器](http://optipng.sourceforge.net/pngtech/optipng.html)的链接。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-19T15:28:49.867

使用 PNG，它支持 1 位颜色模式，即使在 IE4 中也可以使用（如果您不需要部分透明）。您的客户使用 IE3 吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-18T21:32:13.783

几年前我可能会避开 PNG，但现在它可以工作了。并且有大量的 hack 脚本可以让它与 IE 5 和 6 一起工作，因此您可以对大多数用户安全。如果您真的需要兼容性，请同时提供 GIF 和 PNG。

# api - Zune API ZuneCore.dll

> ID：1015286
> 
> 赞同：5
> 
> 时间：2009-06-18T21:30:28.250
> 
> 标签：api, zune, wmplib

前几天我注意到 Zune PC 软件公开了一个类型库 (ZuneCore.dll)。它似乎以某种方式与 WMPLib API 相关，但我不知道如何从 VB6 或 C# 中使用它。

有没有人试过这个并且有运气？

戴夫

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2010-07-26T02:46:38.320

可能是一个老问题，但此链接可能会有所帮助：http: [//zunelcd.codeplex.com/](http://zunelcd.codeplex.com/ "Codeplex 上的 Zune LCD")如果您下载此项目的源代码，其中一个类库是与 Zune 软件通信的不错的 API。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-10-28T23:24:07.893

我刚刚发现了这个-> [http://soapitstop.com/blogs/fleamarket/archive/2008/03/03/read-the-zune-collection-in-net-from-zune-s-own-api。 aspx](http://soapitstop.com/blogs/fleamarket/archive/2008/03/03/read-the-zune-collection-in-net-from-zune-s-own-api.aspx)但似乎有点过时 Initialize 方法现在需要一些参数，我不知道该放什么！

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-08-02T03:45:56.503

尝试从 Visual Studio 中的 .NET 项目中添加对它的引用。或许这个命名空间会神奇地出现：MicrosoftZuneLibrary

# asp.net - 在 ASP.NET MVC 中计时用户访问，初学者

> ID：1015287
> 
> 赞同：1
> 
> 时间：2009-06-18T21:30:38.500
> 
> 标签：asp.net, asp.net-mvc, time

在 ASP.NET MVC 中，有什么好方法（首选方法？？）来计算用户在特定页面上停留了多长时间？例如，我希望用户选择某事，然后只允许用户做某事 30 秒。好的链接或对书页的引用将不胜感激。

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-18T21:38:06.457

您可以跟踪用户何时去某个地方以及他们在那里停留了多长时间（或者在平衡他们的支票簿时打开页面......你明白了）。问题是您需要某种形式的客户端控制器让他们看到 XYZ 30 秒……然后将他们重定向到他们可以看到的下一页。因此，如果您希望用户在 X 时间内看到资源，您需要使用 javascript 客户端计时器在他们的时间到期时将他们从资源中带走。这可以通过静态编码到客户端的时间（可以由客户端更改）来完成，也可以通过向服务器发出 AJAX 请求来查看时间是否已过期来完成。或者可以使用嵌入式 Flash 播放器来完成。这里的关键是您的服务器端没有您所需要的对客户端的强大功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-18T21:36:23.103

一种非常简单的方法是将用户最后一次访问该页面的时间存储在数据库中 - 例如，该表可能包含字段`UserID`、`Page`和`TimeStamp`。每当用户尝试做任何您只想允许 30 秒的事情时，您都会检查数据库是否已经过了时间。（对于 30 秒这样的短时间，数据库可能有点太慢了，不过……取决于您对精度的要求，我猜……）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-18T21:40:41.193

你可以使用 JavaScript 的[`setTimeout()`](http://www.elated.com/articles/javascript-timers-with-settimeout-and-setinterval/)函数：

```
var timeOut = function() {
    alert('Time is up!');
}

setTimeout (timeOut, 30000); 
```

或者您可以使用[`<meta>`标签](http://webdesign.about.com/od/metataglibraries/a/aa080300a.htm)：

```
<meta http-equiv="refresh" content="30;url=http://www.example.com/time-is-up.html"> 
```

# c# - 正确使用属性来维护嵌套表单中的 HUD？

> ID：1015288
> 
> 赞同：0
> 
> 时间：2009-06-18T21:30:47.390
> 
> 标签：c#, winforms, oop, properties

## 编辑 1

是否可以使用 get/set 执行此操作？像下面这样的东西？这对我有用，但我担心我错过了一些东西，更不用说所有的*静态*了。

```
///<summary>
/// Class to track and maintain Heads Up Display information
///</summary>
public static class HUD
{
    ///<summary>
    ///Declare variables to store HUD values
    ///</summary>
    private static string _lastName;
    private static string _firstName;
    private static string _middleName;
    private static string _suffix;
    private static string _sSN;
    private static string _personID;
    private static string _masterID;
    private static string _enrollmentID;
    private static string _planID;

    // Store a reference to THE form that holds the HUD and is visible
    private static FrmModuleHost _frmHUDHost;

    public static string PersonId
    {
        get { return _personID; }
        set
        {
            FrmHudHost.tbxHUD_PersonID.Text = value;
            _personID = value;
        }
    }

    public static string SSn
    {
        get { return _sSN; }
        set
        {
            FrmHudHost.tbxHUD_SSN.Text = value;
            _sSN = value;
        }
    }

    public static string MiddleName
    {
        get { return _middleName; }
        set
        {
            FrmHudHost.tbxHUD_MiddleName.Text = value;
            _middleName = value;
        }
    }

    public static string FirstName
    {
        get { return _firstName; }
        set
        {
            FrmHudHost.tbxHUD_FirstName.Text = value;
            _firstName = value;
        }
    }

    public static string LastName
    {
        get { return _lastName; }
        set
        {
            FrmHudHost.tbxHUD_LastName.Text = value;
            _lastName = value;
        }
    }

    public static string Suffix
    {
        get { return _suffix; }
        set
        {
            FrmHudHost.tbxHUD_SuffixName.Text = value;
            _suffix = value;
        }
    }

    public static string MasterID
    {
        get { return _masterID; }
        set
        {
            FrmHudHost.tbxHUD_MasterID.Text = value;
            _masterID = value;
        }
    }

    public static string EnrollmentID
    {
        get { return _enrollmentID; }
        set
        {
            FrmHudHost.tbxHUD_EnrollmontPeriod.Text = value;
            _enrollmentID = value;
        }
    }

    public static string PlanID
    {
        get { return _planID; }
        set
        {
            FrmHudHost.tbxHUD_PlanID.Text = value;
            _planID = value;
        }
    }

    public static FrmModuleHost FrmHudHost
    {
        get { return _frmHUDHost; }
        set { _frmHUDHost = value; }
    }
} 
```

* * *

## 原帖

我有一个类负责更新当前选定成员信息的平视显示。我的课看起来像这样-->

```
public static class HUD
{
    ///<summary>
    ///Declare variables to store HUD values
    ///</summary>
    public static string _lastName;
    public static string _firstName;
    public static string _middleName;
    public static string _suffix;
    public static string _sSN;
    public static string _personID;
    public static string _masterID;
    public static string _enrollmentPeriod;
    public static string _planID;

    ///<summary>
    /// Method to update the display with current information
    ///</summary>
    public static void UpdateHUD (FrmModuleHost frm, params String[] args)
    {
        frm.tbxHUD_LastName.Text = args[0];
        _lastName = args[0];

        frm.tbxHUD_FirstName.Text = args[1];
        _firstName = args[1];

        frm.tbxHUD_MiddleName.Text = args[2];
        _middleName = args[2];

        frm.tbxHUD_SSN.Text = args[3];
        _sSN = args[3];

        frm.tbxHUD_PersonID.Text = args[4];
        _personID = args[4];

    }
} 
```

我想弄清楚的是如何判断正在传递的参数。您在下面看到的是从搜索页面调用的内容，因为这就是当时可用的所有内容。其他 4 个值将在不同页面上一次加载 1 个。如果有帮助，一个人有一个有计划的注册。

```
 private void GetResults()
    {
        var lName = getCurrentRowVal("Last Name");
        var fName = getCurrentRowVal("First Name");
        var pID = getCurrentRowVal("Person ID");
        var sSN = getCurrentRowVal("SSN");
        var mName = getCurrentRowVal("Middle Name");

        HUD.UpdateHUD(FrmWwcModuleHost, lName, fName, mName, sSN, pID);
    } 
```

现在，当我从注册页面调用它时，我希望所有内容都保留并添加 EnrollmentID。

```
 private void GetResults()
    {
        var enrollmentID = getCurrentRowVal("EnrollmentID");

        HUD.UpdateHUD(FrmWwcModuleHost, enrollmentID);
    } 
```

我的问题是，我该如何做到这一点并知道要调用哪个 arg[] 索引而不覆盖现有值？

是否总是像设置所有参数一样简单？所以我在注册页面上的电话看起来像这样 -->

```
 private void GetResults()
    {
        var enrollmentID = getCurrentRowVal("EnrollmentID");

        HUD.UpdateHUD(FrmWwcModuleHost, HUD._lastName, HUD._firstName, HUD._middleName, HUD._sSN, HUD._personID, enrollmentID);
    } 
```

感谢您的任何见解！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-18T21:34:23.093

您确实需要放弃 params 样式调用并为您的方法建立真正的参数。只需为您最常见的调用签名创建多个重载。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-18T21:36:05.710

也许代替

```
params String[] args 
```

你应该做

```
params KeyValuePair<String,String>[] args 
```

任何给定参数的属性将被分配如下：

```
Key = "Last Name"
Value = "Hare" 
```

然后在您的`UpdateHUD`方法中，您可以检查`Key`参数的值是什么，这样您就可以知道传递的是哪个值。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-18T21:50:30.893

您还可以创建一个单独的类来传递 params 数组。就像是：

```
public class HUDParam {
   public HUDParam(paramName, paramValue) { /*[init code here...]*/ }
   public string Name { get; set; }
   public string Value { get; set; }
} 
```

然后：

```
HUD.UpdateHUD(frm, new HUDParam("FirstName", "Tom"), 
    new HUDParam("LastName", "Thompson"); 
```

在您的更新方法中，您只需检查名称并在 HUD 中设置适当的值。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-18T23:00:01.190

我没有看到对您正在使用的特定版本的 .net 的引用。这是我在 .net 3.5 中处理这个问题的方法。

首先创建一个用于传递更新值的类，但使所有属性都可以为空（因为您的所有项目都是字符串，所以它们已经可以为空）。如果这些值可以为空，请添加实际的属性设置器和 LastNameChanged 属性。

```
 public class UpdateData {
    public string LastName { get; set;};
    public string FirstName  { get; set;};
    public string MiddleName  { get; set;};
 ...
 } 
```

现在您的方法签名如下所示：

```
public static void UpdateHUD (FrmModuleHost frm, UpdateData  data)
{
    if (!string.IsNullOrEmpty(data.FirstName) {
    frm.tbxHUD_LastName.Text = data.FirstName;
    _lastName = data.FirstName;
    }

    if (!string.IsNullOrEmpty(data.LastName) {
    frm.tbxHUD_FirstName.Text = data.LastName;
    _firstName = data.FirstName;
    }
    if (!string.IsNullOrEmpty(data.MiddleName) {
    frm.tbxHUD_MiddleName.Text = data.MiddleName;
    _middleName = data.FirstName;
    } 
```

接下来是设置 UpdateData 并调用方法：

```
UpdateHUD(FrmWwcModuleHost, new UpateData{ FirstName = "test1", LastName = "test2", ...}); 
```

Final note: you are using a lot of statics here. You might consider changing most of them. Move the static variables to an actual class with properties (but no statics), and reference the class in your code.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-18T21:35:32.250

C# 4.0 具有与 params 关键字大不相同的可选参数。Params 关键字在运行时与根本没有 params 关键字的情况没有什么不同。换句话说，你只是得到一个值数组，而无法知道哪个是哪个。Params 关键字只是编译时的 C# 便利。

虽然我还没有使用 C# 4.0 可选参数，但我想它们的行为类似于 VB.NET 可选参数的方式，因为您可以在函数中指定默认值，如果调用者未指定，则将使用该默认值它。但是调用者仍然必须指出（使用缺失值或 paramName:= 语法）他们正在指定哪个参数。

在您的情况下，我认为您最好使用普通的命名参数并在不需要它们时传递 null ，或者改为传递字典/哈希表。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-18T21:40:08.980

您可以使用 Dictionary 传递参数，您可以在其中为某个名称分配值。

最干净的版本是为每个变量创建一个方法。例如

```
void UpdateLastName(string name)
{
   frm.tbxHUD_LastName.Text = _lastName = name;
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-06-18T21:41:38.070

如果可以使用 Framework 4.0，则可以使用[可选参数和命名参数](http://msdn.microsoft.com/en-us/library/dd264739(VS.100).aspx)。在此之前，您将需要传递所有参数。

但是，我认为通过您的问题，您可能会误解正在发生的事情。您在 params 中发送的参数将作为参数进入方法。因此，它们的范围是方法本身，因此您不会“覆盖”任何东西。您用于第一次调用的数组已消失（超出范围），您用于第二次调用的数组将包含您放入的任何内容。在 4.0 之前执行可选参数的最佳方法是使用多个方法重载。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-06-18T21:54:43.457

如果您与一个值有名称关联，但可能是未知的名称值，则这是 Dictionary 的候选者。

可选参数涉及的检查不亚于检查字典是否存在键或类的成员是否为空。由于已经存在用于此的原语并且它更灵活，我认为没有理由使用可变参数或可选参数。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2009-06-18T21:33:27.823

我要做的是使用匿名类型（可以在运行时转换为字典），然后更改存在的值。

新函数定义：

```
public static void UpdateHUD (FrmModuleHost frm, object args); 
```

和客户端代码：

```
UpdateHUD(frm, new {
    MiddleName = "Jed",
    SSN = "..." }); 
```

使用[Roy Osherove 博客](http://weblogs.asp.net/rosherove/archive/2008/03/11/turn-anonymous-types-into-idictionary-of-values.aspx)中的代码，可以将其转换为字典。新的实现将类似于：

```
var dictionary = MakeDictionary(args);
if ( dictionary.ContainsKey("SSN") ) { _sSN = dictionary["SSN"]; } 
```

当然，当 C# 4.0 出来时，这一切都无关紧要了。

# javascript - 将事件处理程序代码保存在命名空间对象或闭包中的什么位置？

> ID：1015300
> 
> 赞同：0
> 
> 时间：2009-06-18T21:32:41.567
> 
> 标签：javascript

在过去的几年里，我一直使用 YUI 支持的 JavaScript 名称空间作为格式化 JavaScript 代码的默认方式。

总而言之，它在更复杂的环境中运行良好，其中许多 Web 小部件可能在不同时间粘在一起。

直到最近，我几乎总是通过从名称间隔对象本身调用处理程序来在 HTML 中使用添加的事件处理程序。

我最近一直在使用 JQuery，并且一直在 ready 函数中而不是在 HTML 中设置处理程序。

随着我越来越多地这样做，JQuery 就绪函数的关闭似乎正在取代名称空间对象。

我现在结束的（至少对于一个小部件/工具类型页面）是一个主要处理保存数据的名称空间对象和一组关闭的事件处理程序，我访问名称空间对象以用于数据特定目的。

我的问题是，处理闭包与名称空间对象的最佳实践是什么，尤其是与事件处理程序相关的？

或者，类似地，设置事件处理程序的一些最佳实践是什么，它们应该是“重量级”并自己处理处理，还是移交给更多库之类的代码。

就个人而言，很难跟踪许多单独的“重量级”事件处理程序的流程。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-09-16T00:40:44.133

这是一个非常主观的问题。话虽如此，我会尽我所能给出我认为每种方法的优点/缺点。

命名空间对象：

```
yourNamespace.events.someClickHandler = function(event) {...}
$(function() {
  $("#someElement").click(yourNamespace.events.someClickHandler);
} 
```

这种方法的第一个“缺点”之一是将事件处理程序与其连接分离。您可以通过在定义后连接每个事件来避免这种情况（就像我在上面的示例中所做的那样），但是您最终会在整个代码中使用大量的“$(function() {”行。

这种风格的另一个“缺点”是事件处理程序的长名称（例如“yourNamespace.events.someClickHandler”）。您可以使用别名：

```
var events = yourNamespace.events;
$("#someElement").click(events.someClickHandler); 
```

和更短的命名空间名称可以在一定程度上缓解这种情况，但实际上没有办法绕过它。

那么，有了所有这些缺点，为什么有人会使用命名空间模式呢？好吧，其中一个“优点”是事件是可访问的。假设（出于调试目的）您想要记录传递给单击处理程序的事件对象。使用 Firebug，您可以执行以下操作：

```
var oldHandler = yourNamespace.events.someClickHandler;
var newHandler = function(e) {console.log(e); oldHandler(e);}
$("#someElement").unbind("click");
$("#someElement").click(yourNamespace.events.someClickHandler); 
```

而且，甚至无需刷新页面，您就可以记录您的事件。

同样，这种风格还有另一个可重用性。如果你想创建一个新的点击处理程序，它与旧的类似，但也做 x、y 和 z，你可以这样做：

```
yourNamespace.events.advancedClickHandler = function(event) {
  yourNamespace.events.someClickHandler(e);
  x(); y(); z();
} 
```

现在相比之下，我们有了“闭包”风格（我更愿意称它为“匿名函数”风格）。

```
$(function() {
  $("#someElement").click(function(event) {...});
} 
```

它显然更简洁，处理程序的定义几乎与连接一样接近，而且我认为它甚至使用更少的内存，因为没有变量引用。但是，您将无法进行任何实时调试工作，您将无法将该处理程序挂接到其他任何地方，或将其扩展为一些新的处理程序或类似的东西，因为您的处理程序只存在于当下当你把它挂起来的时候。

所以，希望这会有所帮助。以我的经验，命名空间对象样式通常是首选方法，尤其是 JS 项目越硬核/严肃。但它肯定有一些缺点；目前确实没有完美的（即完全干净/可重复使用）的方式来连接 JS 中的事件。

# silverlight - Silverlight 将 Datagrid 导出到 Excel（无往返）

> ID：1015302
> 
> 赞同：1
> 
> 时间：2009-06-18T21:32:46.717
> 
> 标签：silverlight, excel, datagrid

我有一个 silverlight 2 应用程序，它带有一个 Datagrid 和一个按钮，用于通过返回服务器将其导出到 Excel。

我可以创建一个表示数据网格的 HTML 字符串。我想将此字符串附加到 html 元素，设置 MIME type=application/vnd.ms-excel 并出现提示，询问我是否要打开或保存 xls 文件。

毕竟如果 ASP 可以做到这一点......

```
<% The main feature of this technique is that %>  
<% you have to change Content type to ms-excel.%>

Response.ContentType = "application/vnd.ms-excel"
<TABLE>  
<TR><TD>2</TD></TR>  
<TR><TD>3</TD></TR>  
<TR><TD>=SUM(A1:A2)</TD></TR>  
</TABLE> 
```

...似乎我应该能够在 Silverlight 中做类似的事情，将其推送到 HTML DOM 上。

任何建议都非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-18T21:51:22.403

不，这不会发生。您将需要让浏览器从您的 SL 发布的服务器中获取某些内容。

只有当浏览器将文档创建为 HTML DOM 时，您才能将 HTML 写入浏览器托管的文档。因此，您无法让浏览器相信您正在编写的文本流是另一种文档类型，例如 Excel 电子表格。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-18T22:45:31.313

您始终可以使用 javascript 将数据网格的内容复制到用户剪贴板（只需创建一个“复制到剪贴板”按钮），然后允许他们将其粘贴到自己的电子表格中（只是为客户这样做，他们很高兴解决方案。）如果您需要，我可以发布代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-05-24T12:38:51.610

这是一个对我有用的好方法 [http://forums.silverlight.net/forums/p/179321/404357.aspx](http://forums.silverlight.net/forums/p/179321/404357.aspx)

# python - Python：绑定一个未绑定的方法？

> ID：1015307
> 
> 赞同：131
> 
> 时间：2009-06-18T21:33:18.947
> 
> 标签：python, class, methods, bind

在 Python 中，有没有办法绑定未绑定的方法而不调用它？

我正在编写一个 wxPython 程序，对于某个类，我决定将所有按钮的数据组合在一起作为一个类级别的元组列表，如下所示：

```
class MyWidget(wx.Window):
    buttons = [("OK", OnOK),
               ("Cancel", OnCancel)]

    # ...

    def Setup(self):
        for text, handler in MyWidget.buttons:

            # This following line is the problem line.
            b = wx.Button(parent, label=text).Bind(wx.EVT_BUTTON, handler) 
```

问题是，由于 的所有值`handler`都是未绑定的方法，我的程序在壮观的火焰中爆炸，我哭了。

我在网上四处寻找似乎应该是一个相对简单、可解决的问题的解决方案。不幸的是我什么也找不到。现在，我正在`functools.partial`解决这个问题，但有谁知道是否有一种干净、健康、Pythonic 的方式将未绑定的方法绑定到实例并继续传递它而不调用它？

* * *

## 回答 #1

> 赞同：194
> 
> 时间：2009-06-18T21:54:29.527

所有函数也是*描述符*，所以你可以通过调用它们的`__get__`方法来绑定它们：

```
bound_handler = handler.__get__(self, MyWidget) 
```

这是 R. Hettinger 出色的描述符[指南。](https://docs.python.org/2/howto/descriptor.html)

* * *

作为从[基思的](https://stackoverflow.com/users/834176/keith-pinson) [评论](https://stackoverflow.com/questions/1015307/python-bind-an-unbound-method#comment8431145_1015405)中提取的一个独立的例子：

```
def bind(instance, func, as_name=None):
    """
    Bind the function *func* to *instance*, with either provided name *as_name*
    or the existing name of *func*. The provided *func* should accept the 
    instance as the first argument, i.e. "self".
    """
    if as_name is None:
        as_name = func.__name__
    bound_method = func.__get__(instance, instance.__class__)
    setattr(instance, as_name, bound_method)
    return bound_method

class Thing:
    def __init__(self, val):
        self.val = val

something = Thing(21)

def double(self):
    return 2 * self.val

bind(something, double)
something.double()  # returns 42 
```

* * *

## 回答 #2

> 赞同：89
> 
> 时间：2009-06-18T21:50:36.400

这可以使用[types.MethodType](http://docs.python.org/library/types.html#types.MethodType)干净地完成。例子：

```
import types

def f(self): 
    print(self)

class C: 
    pass

meth = types.MethodType(f, C(), C) # Bind f to an instance of C
print(meth) # prints <bound method C.f of <__main__.C object at 0x01255E90>> 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2011-09-05T19:31:03.830

在其中创建一个带有 self 的闭包不会在技术上绑定函数，但它是解决相同（或非常相似）潜在问题的另一种方法。这是一个简单的例子：

```
self.method = (lambda self: lambda args: self.do(args))(self) 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-06-18T21:41:13.593

这将绑定`self`到`handler`：

```
bound_handler = lambda *args, **kwargs: handler(self, *args, **kwargs) 
```

这通过`self`作为第一个参数传递给函数来工作。`object.function()`只是 . 的语法糖`function(object)`。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-06-11T11:16:17.400

聚会迟到了，但我带着类似的问题来到这里：我有一个类方法和一个实例，并且想将该实例应用于该方法。

冒着过度简化 OP 问题的风险，我最终做了一些不那么神秘的事情，这可能对到达这里的其他人有用（警告：我正在使用 Python 3——YMMV）。

考虑这个简单的类：

```
class Foo(object):

    def __init__(self, value):
        self._value = value

    def value(self):
        return self._value

    def set_value(self, value):
        self._value = value 
```

以下是您可以使用它执行的操作：

```
>>> meth = Foo.set_value   # the method
>>> a = Foo(12)            # a is an instance with value 12
>>> meth(a, 33)            # apply instance and method
>>> a.value()              # voila - the method was called
33 
```

# c# - 你如何用只读属性模拟类？

> ID：1015315
> 
> 赞同：6
> 
> 时间：2009-06-18T21:34:15.637
> 
> 标签：c#, mocking, moq

起订量中对于带有 readonly 修饰符的类的任何想法：

```
Class myClass
{
   private  int id;
   public int Id{ get {return id;}}

  public myClass(int id)
  { this.id  = id }
} 
```

我试图模拟这个对象：

```
var myMock= new Mock<myClass>();
myMock.SetupGet(m => m.ID).Return(555); 
```

它返回给我错误：

> System.ArgumentException：不可覆盖成员 m=>m.ID 上的设置无效。

任何想法？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-06-18T21:43:05.447

问题不在于它是只读的，而在于它不是虚拟的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-22T15:11:08.057

我所知道的唯一允许更改类和密封类的非虚拟方法的模拟引擎是 Typemock。

大多数其他模拟框架与接口一起工作得更好，如果接口不可用，则被模拟的成员需要是虚拟的。

# asp.net-mvc - ASP.NET MVC Ajax

> ID：1015318
> 
> 赞同：1
> 
> 时间：2009-06-18T21:34:30.037
> 
> 标签：asp.net-mvc, ajax

我想要一个页面来检查数据库表的更新并使用 Ajax 调用刷新网格，并且当向表中插入新行时会弹出一个消息窗口。

该数据库表每 15 分钟左右更新一次新行，消息窗口让用户知道已添加一条新记录或可能不止一条记录。

我想在带有 Ajax 的 ASP.NET MVC 中执行此操作，但不知道如何设置 javascript 以检查计时器上的更新，或者是否存在 XHR 用来指示状态更改的标志。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2011-05-10T04:32:14.197

你应该试试[PokeIn](http://www.pokein.com)库。它可以帮助您根据服务器端事件通知连接的客户端。这是一个基本场景；

单个静态计时器在服务器端运行并检查数据库上的任何更改。如果有可用更新，请将其发送到连接的客户端/关联组等。

样品可[从](http://pokein.codeplex.com)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-18T21:40:51.520

这可能是一种可能的方法：

1.  将获取数据的时间存储在 javascript 的全局变量中。

2.  每 x 分钟，您使用时间戳作为参数对操作方法进行一次 javascript 调用。例如，这可以使用Rony 建议的[jQuery Timer来完成。](http://plugins.jquery.com/project/timers)

3.  action 方法检查数据库以查看是否有任何更改，并返回一个简单的布尔值 1/0。

4.  当且仅当数据已更改时，您才从另一个操作方法获取新数据并通知用户已检索到新数据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-18T21:41:24.857

您可以使用[jQuery计时器](http://plugins.jquery.com/project/timers)使用ajax检查数据库的状态，然后相应地修改表中的值

# vb.net - DataGridView 缩放

> ID：1015319
> 
> 赞同：2
> 
> 时间：2009-06-18T21:34:30.363
> 
> 标签：vb.net, winforms, .net-3.5, datagridview, scaling

在 VB.net 3.5 SP1 中，我有一个带有三个 DataGridView 控件的 Windows 窗体。一个 DGV 占据了表格的整个下半部分。另外两个共享上半部分并且并排。

我想让每个 DataGridView 适当地缩放。更具体地说，我想让列宽和行高适应表单的大小。然后我希望单元格字体根据单元格大小的变化自动填充。

我已使用 Dock 属性将控件缩放到窗体的大小。如何获取行和字体以利用增加的表单大小？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-23T18:03:56.440

您可以使用 datagridview.autosizecolumns 和 datagridview.autosizerows 来自动调整列和行的大小。查看 ColumnHeadersDefaultCellStyle、rowHeadersDefaultCellStyle 和 RowsDefaultCellStyle 以更改字体

至于改变字体大小，我不相信有任何自动的方法来处理这个问题。您只需要编写一些代码来根据数据网格的大小更改字体大小。

# c# - 如何删除 Access Db 的临时 ldb 文件

> ID：1015336
> 
> 赞同：4
> 
> 时间：2009-06-18T21:37:55.910
> 
> 标签：c#, asp.net, ms-access, ado.net, jet

我有一个 ASP.NET 项目。我正在连接到数据库，然后关闭并处理连接对象。但是当有人进入我的站点时，MS Access 会创建一个临时的 dbname.ldb。当我想从我的服务器下载我的原始 mdb 文件时，它不会让我访问 mdb 文件。如果服务器中有 ldb 文件，我将无能为力。它正在锁定 mdb 文件，我无法移动它。所以有什么问题？我正在打开连接并关闭它。那么为什么这个ldb文件在连接关闭后不删除自己。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-19T03:56:57.927

IIS 中的 Web 应用程序通过连接池保持连接打开。如果在 IIS 设置为终止您的 Web 应用程序的时间内没有进一步的连接，或者您可以重新启动应用程序（并在任何人进入之前复制文件），则 IIS 应用程序最终将关闭。

这只是 Access 不是此类应用程序数据库的好选择的一个原因。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-18T21:52:09.610

如果脚本在关闭连接之前产生任何类型的错误，则连接可以保持打开状态。检查带有自定义错误 500 页面的脚本，该页面在文本文件中记录错误，您将查看是否是这种情况。无论如何，ldb 文件并不危险，因此您可以创建一个脚本以每天一次左右删除它们。这是使用 MS Access 工作 Web 应用程序的缺点之一。如果可以，尝试迁移到 MSSQL 或迁移到 MySQL，最后一个可以从 .NET 或经典 ASP 使用，而 ADO 或 ADO.NET 与适当的驱动程序没有问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-19T01:51:05.040

该`.ldb`文件是`.mdb`Access 数据库的锁定文件。每次打开数据库时，Jet 引擎都会创建锁定文件并在有人连接时保持打开状态。一旦没有其他客户端连接到数据库，Jet 将删除锁定文件。

因此，您看到锁定文件的原因有两个：

*   有一个开放的连接。
*   连接中断，无法删除锁定文件。

如果检查服务器的错误日志没有提供任何信息，请尝试将应用程序内的所有数据库访问记录到文件中：附加有关时间、连接和其他有用调试信息的信息。
这可能是一种快速调试问题并查看连接处于打开状态的位置和时间的简单方法。

或者，您可以查看这篇 CodeProject 文章：[在 ASP.NET Web 应用程序中查找“泄漏的”数据库连接](http://www.codeproject.com/KB/database/connectionmonitor.aspx)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-19T03:51:57.427

*您可能还需要考虑连接池 - 当您关闭连接时，c# 实际上会在真正*关闭它之前将它保持打开一段时间（30 秒？60 秒？），以防它可以重新使用。这可能是一个问题。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-09-27T16:03:29.017

删除 .ldb 文件的一种解决方法是执行以下操作：

*   制作访问数据库的副本
*   删除原来的access数据库
*   删除 .ldb 文件
*   将访问数据库的副本重命名为原始数据库的名称。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2016-06-24T20:45:56.960

您需要在关闭并处理连接对象后调用***GC.Collect() :)***

# java - .class 与 .java

> ID：1015340
> 
> 赞同：47
> 
> 时间：2009-06-18T21:38:19.480
> 
> 标签：java, class, applet

.class 文件和 .java 文件有什么区别？我试图让我的小程序工作，但目前我只能在 Eclipse 中运行它，我还不能嵌入 HTML。谢谢

**编辑：那么如何使用 JVM 编译？

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2009-06-18T21:46:59.043

.class 文件是编译后的 .java 文件。

.java 是所有文本并且是人类可读的。
.class 是二进制的（通常）。

通过转到命令行，导航到 .java 文件并运行，您可以将 java 文件编译为类文件

```
javac "c:\the\path\to\your\file\yourFileName.java" 
```

您必须在计算机上安装 java SDK（从[Oracle](http://www.oracle.com/technetwork/java/javase/downloads/index.html)获取），并确保 javac.exe 文件可在计算机的 PATH 环境变量中找到。

另外，请查看 Java 的**[第 1 课：编译和运行一个简单的程序](http://java.sun.com/developer/onlineTraining/Programming/BasicJava1/compile.html)**

如果其中任何一个不清楚，请对此回复发表评论，我可以提供帮助:)

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2009-06-18T21:40:03.720

*   .class -> 已编译（用于 JVM）
*   .java -> 源代码（用于人类）

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-06-18T21:40:44.203

.java 文件包含您的 Java 源代码，而 .class 文件包含 Java 编译器生成的 Java 字节码。在 JVM 上运行以执行 Java 应用程序的是您的 .class 文件。

它是您在部署小程序时将使用的 .class 文件。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-06-18T21:40:25.857

.java 文件是源文件，而 .class 文件是编译（字节码）类。

使用[javac](https://docs.oracle.com/javase/1.5.0/docs/tooldocs/windows/javac.html)将源代码编译成字节码。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-06-18T21:40:49.150

.java 通常以明文形式保存您的代码

.class 包含 .java 的字节码。将其视为 .java 文件的编译版本

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-02-09T15:02:07.500

person 可以定义为 Person 类。此类应驻留在 Java 源代码文件 (Person.java) 中。使用这个 Java 源代码文件，Java 编译器（Windows 上的 javac.exe 或 Mac OS X/Linux/UNIX 上的 javac）生成字节码（Java 虚拟机的编译代码）并将其存储在 Person.class 中。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-11-25T09:42:36.413

Java 文件是一种人类可读的语言（例如，我们在 Eclipse/任何其他 IDE 中编写的代码）。

类文件是为 Java 虚拟机 (JVM) 编译的字节码。

# css - 我如何预测哪种类型的 CSS 选择器会起作用？

> ID：1015341
> 
> 赞同：0
> 
> 时间：2009-06-18T21:39:02.773
> 
> 标签：css, dojo

我正在使用 dojo 创建一个表单，并且我想要一个范围受限的数字输入字段。所以我用这个：

```
<input 
    id             = "sample_input"
    type           = "text"
    dojoType       = "dijit.form.NumberTextBox"
    name           = "sample_input"
    value          = "27"
    constraints    = "{min:1,max:30,places:0}"
    promptMessage  = "Enter a value"
    required       = "true" 
    invalidMessage = "Invalid value."
/> 
```

它可以工作，但是它太宽了，并且内容是左对齐的。

添加到我的 INPUT 元素中的这两行似乎都没有什么不同：

```
width              = "60"
text-align         = "right" 
```

这本身就是一个问题，但没关系，我知道我应该使用 CSS 而不是 HTML。所以我在 HEAD 部分添加了这个：

```
<style type="text/css">
    .NARROW {width:60px;}
    .RIGHT_JUSTIFIED {text-align:right;}
</style> 
```

这到 INPUT 元素：

```
class              = "NARROW RIGHT_JUSTIFIED" 
```

这解决了宽度，但不是文本对齐。

为了解决文本对齐问题，我必须改为这样做：

```
<style type="text/css">
    .NARROW {width:60px;}
    input {text-align:right;}
</style> 
```

在样式中指定`width`属性`input`也不起作用。

所以这就是我的问题。为什么内联样式在这种情况下不起作用，为什么我必须对宽度使用类选择器，而对文本对齐使用元素选择器？以及我如何预测何时适用哪个选择器？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-18T21:50:11.017

您的班级选择器中有错字。

RIGHT_JUSTIFIED 和 RIGHT-JUSTIFIED 不匹配

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-18T22:04:42.330

使用[FireBug](http://getfirebug.com/)查看是否有更具体的选择器覆盖`.RIGHT_JUSTIFIED`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-18T22:11:33.563

我试过这段代码，它似乎工作正常

```
<html>
<head>
<style type="text/css">

    .width_narrow {width:60px;}
    .align_right {text-align:right;}

</style>
</head>
<body>

<input
    name           = "sample_input"
    type           = "text" 
    class         = "width_narrow align_right" 
    id             = "sample_input"
    value          = "27"
    dojoType       = "dijit.form.NumberTextBox"
    constraints    = "{min:1,max:30,places:0}"
    promptMessage  = "Enter a value"
    required       = "true" 
    invalidMessage = "Invalid value."
/>

</body>  
</html> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-20T17:03:20.977

如果选择器不起作用，您可以进行一些快速测试来隔离问题。

首先，我尝试使用更具体的选择器来查看 CSS 不同部分中的选择器是否覆盖了您的样式。例如，

```
body #problem { ... } 
```

比更具体

```
#problem { ... } 
```

您还可以添加 !important 属性，它使该属性优先于 [几乎] 所有其他属性，无论它们多么具体：

```
#problem { width:60px !important; } 
```

如果这些都不起作用，那么要么存在更深层次的问题，要么存在偷偷摸摸的错字。在这个阶段，完全隔离 HTML 和 CSS 部分（正如您在上面的答案中所做的那样）是最有效的，但也更耗时。

# entity-framework - 如何从实体框架实体中获取鉴别器列的值

> ID：1015343
> 
> 赞同：3
> 
> 时间：2009-06-18T21:39:42.460
> 
> 标签：entity-framework

我有一个用 EDM 编写的项目。有谁知道如何从 TPH 继承树中的实体获取鉴别器列的值？我无法将该属性添加到实体。有没有其他方法可以获取价值？

谢谢，
罗伊

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-22T13:12:34.023

有一种简单的方法可以解决支持可更新视图的 DBMS 的问题。您可以简单地创建具有附加鉴别器列的视图或定义查询。原始列应映射到类属性。如果 DBMS 不支持可更新视图，您可以使用定义查询，然后为插入/更新/删除操作映射存储过程。

以下是 Oracle 数据库的示例：

```
SQL：
创建表测试.TPH_TABLE (
  编号 (9),
  COLUMN_A VARCHAR2(20),
  COLUMN_B VARCHAR2(20),
  BASE_COLUMN VARCHAR2(20),
  约束 PK_TPH_TABLE 主键 (ID)
);

EDMX：
<edmx:Edmx 版本="1.0" xmlns:edmx="http://schemas.microsoft.com/ado/2007/06/edmx">
  <!-- EF 运行时内容 -->
  <edmx:运行时>
    <!-- SSDL 内容 -->
    <edmx:StorageModels>
      <Schema Namespace="Model1.Store" Alias="Self" Provider="Devart.Data.Oracle" ProviderManifestToken="ORA" xmlns:store="http://schemas.microsoft.com/ado/2007/12/edm /EntityStoreSchemaGenerator" xmlns="http://schemas.microsoft.com/ado/2006/04/edm/ssdl">
        <EntityContainer Name="Model1StoreContainer">
          <EntitySet 名称="TPH_TABLE" EntityType="Model1.Store.TPH_TABLE" >
            <定义查询>
              选择 ID、BASE_COLUMN、COLUMN_A、COLUMN_B、
                     CASE WHEN COLUMN_A 不为 NULL THEN '1' ELSE NULL END AS "IS_TABLE_A"
                FROM TPH_TABLE
            </DefiningQuery>
          </EntitySet>
        </EntityContainer>
        <实体类型名称="TPH_TABLE">
          <键>
            <PropertyRef 名称="ID" />
          </键>
          <Property Name="ID" Type="int" Nullable="false" />
          <属性名称="BASE_COLUMN" 类型="VARCHAR2" MaxLength="20" />
          <属性名称="COLUMN_A" 类型="VARCHAR2" MaxLength="20" />
          <属性名称="COLUMN_B" 类型="VARCHAR2" MaxLength="20" />
          <属性名称="IS_TABLE_A" 类型="VARCHAR2" MaxLength="1" />
        </EntityType>
      </架构>
    </edmx:StorageModels>
    <!-- CSDL 内容 -->
    <edmx:概念模型>
      <Schema Namespace="Model1" Alias="Self" xmlns="http://schemas.microsoft.com/ado/2006/04/edm">
        <EntityContainer 名称="实体">
          <EntitySet Name="TPH_TABLE" EntityType="Model1.TPH_TABLE" />
        </EntityContainer>
        <EntityType Name="TPH_TABLE" Abstract="true">
          <键>
            <PropertyRef 名称="ID" />
          </键>
          <Property Name="ID" Type="Int32" Nullable="false" />
          <Property Name="BASE_COLUMN" Type="String" MaxLength="20" Unicode="true" FixedLength="false" />
        </EntityType>
        <EntityType Name="TABLE_A" BaseType="Model1.TPH_TABLE" >
          <Property Name="COLUMN_A" Type="String" Nullable="true" />
        </EntityType>
        <EntityType Name="TABLE_B" BaseType="Model1.TPH_TABLE" >
          <Property Name="COLUMN_B" Type="String" Nullable="true" />
        </EntityType>
      </架构>
    </edmx:概念模型>
    <!-- CS映射内容-->
    <edmx:映射>
      <映射空间="CS" xmlns="urn:schemas-microsoft-com:windows:storage:mapping:CS">
        <EntityContainerMapping StorageEntityContainer="Model1StoreContainer" CdmEntityContainer="Entities">
          <EntitySetMapping 名称="TPH_TABLE">
            <EntityTypeMapping TypeName="Model1.TABLE_A">
              <MappingFragment StoreEntitySet="TPH_TABLE">
                <ScalarProperty Name="ID" ColumnName="ID" />
                <ScalarProperty Name="BASE_COLUMN" ColumnName="BASE_COLUMN" />
                <ScalarProperty Name="COLUMN_A" ColumnName="COLUMN_A" />
                <Condition ColumnName="IS_TABLE_A" Value="1" />
              </MappingFragment>
            </EntityTypeMapping>
            <EntityTypeMapping TypeName="Model1.TABLE_B">
              <MappingFragment StoreEntitySet="TPH_TABLE">
                <ScalarProperty Name="ID" ColumnName="ID" />
                <ScalarProperty Name="BASE_COLUMN" ColumnName="BASE_COLUMN" />
                <ScalarProperty Name="COLUMN_B" ColumnName="COLUMN_B" />
                <Condition ColumnName="IS_TABLE_A" IsNull="true" />
              </MappingFragment>
            </EntityTypeMapping>
          </EntitySetMapping>
        </EntityContainerMapping>
      </映射>
    </edmx:映射>
  </edmx:运行时>
  <!-- EF Designer 内容（请勿在此处手动编辑）-->
  <edmx:Designer xmlns="http://schemas.microsoft.com/ado/2007/06/edmx">
    <edmx:连接>
      <DesignerInfoPropertySet>
        <DesignerProperty Name="MetadataArtifactProcessing" Value="EmbedInOutputAssembly" />
      </DesignerInfoPropertySet>
    </edmx:连接>
    <edmx:选项>
      <DesignerInfoPropertySet>
        <DesignerProperty Name="ValidateOnBuild" Value="true" />
      </DesignerInfoPropertySet>
    </edmx:选项>
    <!-- 图表内容（形状和连接器位置）-->
    <edmx:图表>
      <图表名称="Model4">
        <EntityTypeShape EntityType="Model1.TPH_TABLE" Width="1.5" PointX="3" PointY="0.5" Height="1.2636116536458335" IsExpanded="true" />
        <EntityTypeShape EntityType="Model1.TABLE_A" Width="1.5" PointX="1.75" PointY="2.75" Height="1.099264322916667" />
        <EntityTypeShape EntityType="Model1.TABLE_B" Width="1.5" PointX="4.25" PointY="2.75" Height="1.099264322916667" />
        <InheritanceConnector EntityType="Model1.TABLE_B" ManuallyRouted="false">
          <ConnectorPoint PointX="4.375" PointY="1.7636116536458335" />
          <ConnectorPoint PointX="4.375" PointY="2.75" />
          </继承连接器>
        <InheritanceConnector EntityType="Model1.TABLE_A" ManuallyRouted="false">
          <ConnectorPoint PointX="3.125" PointY="1.7636116536458335" />
          <ConnectorPoint PointX="3.125" PointY="2.75" />
          </InheritanceConnector></Diagram></edmx:Diagrams>
  </edmx:设计师>
</edmx:Edmx>

```

# java - Java Applet 中的音频无法播放

> ID：1015349
> 
> 赞同：0
> 
> 时间：2009-06-18T21:40:28.197
> 
> 标签：java, applet, audio

我正在尝试在 Java 小程序中播放音频，但它不工作。可能是什么问题呢？

编辑：除了 Java 可以播放的文件数量有限之外，问题是我没有意识到 bin 文件夹（在 Eclipse 工作区中）包含正在运行的 .class 文件。所以我引用 getDocumentBase() 的代码找不到音频文件。-_-”

```
import java.applet.*;
import java.awt.*;
import java.awt.event.*;

public class Viewer extends Applet
    implements MouseListener, MouseMotionListener {
    AudioClip sound1;
    AudioClip tap;
    AudioClip clap;

    public void init() {
        sound1 = this.getAudioClip(getDocumentBase(),"boom.au");
        tap = getAudioClip(getDocumentBase(), "tap.au");
        clap = getAudioClip(getDocumentBase(), "clap.au");

        this.resize(600,600);

        addMouseListener(this);

        setBackground(Color.BLACK);
    }

    public void paint (Graphics g) {

    }

    public void mouseClicked(MouseEvent e) {
        sound1.play();
        System.out.println("BOOM!");
    }
    public void mouseEntered(MouseEvent e) { }
    public void mouseExited(MouseEvent e) { }
    public void mousePressed(MouseEvent e) {
        tap.play();
        System.out.println("tap!");
    }
    public void mouseReleased(MouseEvent e) { }
    public void mouseDragged(MouseEvent e) { }
    public void mouseMoved(MouseEvent e) { }

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-18T23:32:34.167

看起来 Sun 的小程序实现对于播放的声音格式非常挑剔。具体来说[，“目前，Java [applet] API 仅支持一种声音格式：8 位、μ-law、8000 Hz、单声道、Sun“.au”文件。”](http://java.sun.com/docs/books/tutorial/deployment/applet/sound.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T00:59:19.030

如果是 Tom 提到的问题（很可能），请使用 JavaSound API 播放音频。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-01T00:41:14.460

编辑：除了 Java 可以播放的文件数量有限之外，问题是我没有意识到 bin 文件夹（在 Eclipse 工作区中）包含正在运行的 .class 文件。所以我引用 getDocumentBase() 的代码找不到音频文件。-_-”

# perl - Perl for 循环解释

> ID：1015358
> 
> 赞同：1
> 
> 时间：2009-06-18T21:42:01.440
> 
> 标签：perl, for-loop, perlsyn

我正在查看 perl 代码，我看到了这个：

```
sub html_filter {
    my $text = shift;
    for ($text) {
        s/&/&amp;/g;
        s/</&lt;/g;
        s/>/&gt;/g;
        s/"/&quot;/g;
    }
    return $text;
} 
```

在这种情况下 for 循环会做什么，为什么要这样做？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-18T21:45:48.000

该`for`循环将列表中每个元素的别名，其循环到`$_`。在这种情况下，只有一个元素，`$text`。

在体内，这允许人们写

```
s/&/&amp;/g; 
```

等等，而不必写

```
$text =~ s/&/&amp;/g; 
```

反复。另请参阅[perldoc perlsyn](http://perldoc.perl.org/perlsyn.html#Foreach-Loops)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-18T21:45:03.213

如果没有显式循环变量，则`for`循环使用名为 的特殊变量`$_`。循环内的替换语句*也*使用特殊`$_`变量，因为没有指定其他变量，所以这只是使源代码更短的一个技巧。我可能会把这个函数写成：

```
sub html_filter {
    my $text = shift;
    $text =~ s/&/&amp;/g;
    $text =~ s/</&lt;/g;
    $text =~ s/>/&gt;/g;
    $text =~ s/"/&quot;/g;
    return $text;
} 
```

这不会对性能产生影响，并且 Perl 以外的人都可以阅读。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-06-19T03:44:07.340

正如 Hewgill 先生所指出的，代码示例隐含地本地化和别名为神奇的隐含变量 $_。

他以样板代码为代价提供了一种更具可读性的替代品。

没有理由为了简洁而牺牲可读性。只需用显式版本替换隐式本地化和赋值：

```
sub html_filter {
    local $_ = shift;

    s/&/&amp;/g;
    s/</&lt;/g;
    s/>/&gt;/g;
    s/"/&quot;/g;

    return $_;
} 
```

如果我不太了解 Perl 并且遇到了这段代码，我会知道我需要查看文档，[`$_`](http://perldoc.perl.org/perlvar.html#%24_)并且-- 作为奖励，这里有一些[`local`](http://perldoc.perl.org/functions/local.html)localizing 的[示例](http://perldoc.perl.org/perlvar.html#nasty_break)。`perlvar`[`$_`](http://perldoc.perl.org/perlvar.html#nasty_break)

对于经常使用 Perl 的人来说，上面的内容应该很容易理解。

所以这里真的没有理由为了简洁而牺牲可读性。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-18T21:44:54.383

它只是用于将 $text 别名为默认变量 $_。完成是因为他们懒得使用显式变量，或者不想浪费宝贵的周期来创建新的标量。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-18T21:45:00.980

它清理 &、<、> 和引号字符，并用适当的 HTML 实体字符替换它们。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-18T21:45:59.950

它循环遍历您的文本，并用 &、< 和 <、> 用 > 和 " 用 " 替换与符号 (&)。你会这样做以输出到 .html 文档......这些是正确的实体字符。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-06-18T23:27:41.913

通过使用 wantarray 来测试所需的上下文，原始代码可以更加灵活：

```
sub html_filter {
    my @text = @_;
    for (@text) {
        s/&/&amp;/g;
        s/</&lt;/g;
        s/>/&gt;/g;
        s/"/&quot;/g;
    }
    return wantarray ? @text: "@text"; } 
```

这样您就可以在列表上下文或标量上下文中调用它并返回正确的结果，例如：

```
my @stuff = html_filter('"','>');
print "$_\n" for @stuff;

my $stuff = html_filter('&');
print $stuff; 
```

# database - 按应用程序主题组织 SQL 文件值得头疼吗？

> ID：1015364
> 
> 赞同：2
> 
> 时间：2009-06-18T21:43:59.300
> 
> 标签：database, version-control, code-organization, project-organization

在我的公司，我们将每个数据库对象（存储过程、视图等）保存为单独的 SQL 文件，并以这种方式将它们置于源代码控制之下。

到目前为止，我们的版本化文件结构中有一个非常扁平的存储模型：

*   `DatabaseProject`
    *   `Functions`
        *   （这里的所有功能；没有进一步的嵌套）
    *   `StoredProcedures`
        *   （所有存储的过程都在这里；没有进一步的嵌套）
    *   `Views`
        *   （同上）

对于一个大的新项目，我想到了另一个想法：为什么不按主题存储这些文件，而不是在这些预制平面列表中？

例如：

*   `DatabaseProject`
    *   `Reports`
        *   （个人存储过程、视图等）
        *   `SpecificReport`
            *   （这里有更多对象，必要时进一步嵌套）
    *   `SpecificApplication`
        *   （所有类型的 DB 对象，任意深度嵌套）
    *   等等....

明显的缺陷是这种文件夹结构没有对数据库对象施加任何类型的命名空间层次结构。它仅用于组织。因此，**很容易引入具有重复名称的对象**。您需要某种构建工具来调查数据库项目并死于命名冲突。

我想知道的是：有没有人尝试过这种按应用程序主题在其版本化文件结构中组织 SQL 文件的方法？它值得吗？您是否创建了一个构建工具来监督我所描述的项目？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-18T21:49:41.330

您应该为您的数据库对象定义一个命名方案，以便清楚使用视图或 SP 的位置。

这可以是描述应用程序模块的前缀，也可以是模块/功能的单独架构名称。

无需嵌套，VCS 中的名称显示与数据库中相同，并根据命名方案正确排序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-08-04T14:19:00.103

我喜欢按主题而不是按名称组织我的 SQL 脚本。通常，我什至将相关项目分组到单个文件中。这样做的主要优点是：

*   您不会将文件系统/IDE 与文件混在一起（其中许多文件只有几行）。
*   整体数据库结构显示更直观。

另一方面，可能更难找到与特定对象相关的源代码......

至于重复名称：它永远不会发生，因为您显然有[自动脚本](http://odetocode.com/Blogs/scott/archive/2008/01/30/11702.aspx)来[构建您的数据库](https://stackoverflow.com/questions/988426/how-should-you-build-your-database-from-source-control)。依靠您的文件系统来解决这个问题正在寻找麻烦......

作为结论，我想说的是，您当前的规则总比没有规则要好得多。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-04T13:42:16.867

我们将 SQL 文件保存在每个项目的“SQL”解决方案文件夹中。这样，每个项目都是单独“安装”的。

# asp.net-mvc - MVC Html.ValidationMessage 在更新时未触发

> ID：1015375
> 
> 赞同：1
> 
> 时间：2009-06-18T21:46:05.003
> 
> 标签：asp.net-mvc, validation

我遇到了一个问题，即我的验证消息在添加操作中显示良好，但是当涉及到更新页面时，验证消息没有显示：

这是我的操作，IsValid 显示为假，操作重定向到编辑视图，但没有显示任何验证消息。我的方法有问题吗？

```
 [Authorize]
    public ActionResult UpdateCar(CarDTO car)
    {
        try
        {
            _carTask.Update(car); //required Name field not set
        }
        catch (RulesException ex)
        {
            ex.AddModelStateErrors(ModelState, null);
        }

        if (!ModelState.IsValid)
        {
            return RedirectToAction(ViewNames.EditCar, new {carKey = car.carKey});
        }
        return RedirectToAction(ViewNames.Home, new {carKey =   car.carKey});
    }

 <li>
    <label for="Name">Car Name:</label>
    <%= Html.TextBoxFor(x => x.Name, new { watermark="Car Name" })%>
      <br />
       <%= Html.ValidationMessage("Name") %>
 </li> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-19T01:49:08.820

如果表单无效，那么您将重定向到一个新页面，该页面将丢失您设置的任何模式错误值。相反，只需返回视图。尚未检查语法，但类似于以下内容。

```
if (!ModelState.IsValid)
{
    return View(ViewNames.EditCar, new {carKey = car.carKey});
}

return RedirectToAction(ViewNames.Home, new {carKey =   car.carKey}); 
```

# database-design - 如何为多个领域设计数据库？

> ID：1015379
> 
> 赞同：3
> 
> 时间：2009-06-18T21:46:39.450
> 
> 标签：database-design, multi-tenant

如果我有两个或多个域和一个数据库，如何设计数据库和组织数据？所有用于电子商务目的的网站和一种商品都可以在每个网站上出售。所以我只有两个想法：

1.  我需要在几乎每个表中再创建一个字段（site_id）并重复数据。
2.  我需要为其他表中的所有其他字段创建一个包含 site_id 信息的表。

这两种想法都有很大的缺点。有任何想法吗？谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-18T21:56:30.507

这是构建多租户系统时的经典问题。关于这个问题，我听到了一些不同的意见，但它们基本上分为两个阵营：

1.  `site_id`在包含特定租户数据的每个表上使用租户 ID（在您的情况下）。这种方法的拥护者将轻松识别数据所属的租户作为主要好处，这对数据的归档方式有影响（即不同客户的不同表空间）。

2.  仅在高级表上使用租户 ID。这种方法的拥护者通常描述了更干净的数据库结构的好处。

我不喜欢为来自不同客户的相同类型的数据创建不同的物理表。这样做有许多不利的后果：

*   通过 ORM 工具创建一致的对象模型变得困难
*   这种方法不适用于大量客户——如果您有 70,000 个客户必须从单个数据库获得服务，那么您将拥有 70,000 组表。
*   必须为 SQL 语句动态生成表名。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-18T21:50:48.550

您的架构中的某处可能有少量表链接到您的所有其他表。您需要将 site_id 放入这些表，而不是数据库中的每个表。

对于（一个高度人为的）示例，如果我的架构包括一个客户表、一个发票表和一个发票行项目表，我不需要所有三个表中的 site_id。我只需要客户表中的 site_id。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-18T21:53:20.370

我认为 Wordpress 和 Drupal 使用的方法之一是为表添加前缀：

```
dom1_Customers
dom2_Customers 
```

这样，表格就不会不成比例地增长，并且您不必维护额外的 site_id 索引。也就是说，您的代码必须对其进行补偿，这可能需要进行一些重新设计（并且存储过程基本上没有任何麻烦）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-18T22:10:51.927

我的偏好是在需要的地方创建映射表。认为站点 1、站点 2 等可以存在产品。产品详细信息不会在站点之间更改。产品价格可能会！在这种情况下，价格表可能需要 SiteID 和 ProductID，其中 ProductID 可能会在不同站点上为每个条目复制。用户也可以这样说，只是用户可能会觉得这是“老大哥”的感觉。因此，虽然这可能对客户有用，但我通常建议客户在不同网站上拥有不同的帐户！有时，物理上有效的东西并不意味着它在逻辑上有效。将 SiteID 放在您需要的地方，而不是随意地把它放在任何地方。请记住，您可能在应用程序需要之外的地方需要此 SiteID... 也考虑离线查询。必须执行 5 次连接才能按 SiteID 过滤！维护索引比寻找过滤器要好！

关于通过具有相似名称的单独表的水平分区...使用 SQL Server 2005 及更高版本。它具有分区功能，因此担心数据大小不再是问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-21T21:16:14.247

多数据库是不可能的吗？它似乎是最简单和最干净的一个，您不可能将一个租户的数据与另一个租户的数据混为一谈。您将需要一个主数据库用于租户信息，每个租户一个数据库。

# c# - C#等待其他服务启动

> ID：1015381
> 
> 赞同：2
> 
> 时间：2009-06-18T21:48:20.007
> 
> 标签：c#, windows

我正在编写一个依赖于其他服务的 Windows 服务，我应该如何等待其他服务启动？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-18T22:02:49.197

我认为你应该使用这条线

安装程序.ServicesDependedOn = 新字符串 [] { "DependenceService" };

像这样：

```
using (ServiceProcessInstaller processInstaller = new ServiceProcessInstaller())
{
    processInstaller.Account = ServiceAccount.LocalSystem;
    processInstaller.Username = null;
    processInstaller.Password = null; 

    using (ServiceInstaller installer = new ServiceInstaller())
    {
        installer.DisplayName = "yourservice.";
        installer.StartType = ServiceStartMode.Automatic;
        installer.ServiceName = "YourService";

        installer.ServicesDependedOn = new string [] { "DependenceService" };
        this.Installers.Add(processInstaller);
        this.Installers.Add(installer);
    }
} 
```

祝你好运

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-18T22:04:50.253

除了已经指出的其他答案之外，如果其中一项服务是 SQL Server，您将需要确保特定数据库以及 SQL Server 服务本身可用。我使用类似于以下的函数：

```
public class DbStatus
{
    public static bool DbOnline()
    {
        const int MaxRetries = 10;
        int count = 0;

        while (count < MaxRetries)
        {
            try
            {
                // Just access the database. any cheap query is ok since we don't care about the result.
                return true;
            }
            catch (Exception ex)
            {
                Thread.Sleep(30000);
                count++;
            }
        }
        return false;
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-18T21:49:59.583

您需要指定依赖项。您可以在安装程序类中执行此操作。

**进一步澄清**

您应该在安装项目中使用 Installer 类作为自定义操作来安装服务。如果不是，请发表评论，我将通过有关如何执行此操作的步骤更新此答案。

在 Installer 类的设计器中，您应该看到两个组件：serviceInstaller 和 serviceProcessInstaller。我不记得是哪一个，但其中一个有一个属性，允许您指定一个多行字符串，该字符串列出您的服务依赖项的服务名称。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-08-20T02:13:11.943

正如其他人所说，您应该使用[ServiceInstaller Class](http://msdn.microsoft.com/en-us/library/system.serviceprocess.serviceinstaller.aspx)，但您不需要完整的安装项目。您可以使用[InstallUtil.exe](http://msdn.microsoft.com/en-us/library/50614e95(VS.80).aspx)进行快速安装，这是 .NET Framework 附带的命令行实用程序。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-18T22:04:18.820

您可以控制其他服务吗？如果是，让他们开始你，如果不是，我想你无论如何都必须开始并监控自己发生了什么。可以向 WMI 注册自己，以便在其他进程启动时得到通知 - 有一个关于它的问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-18T22:05:12.547

[在您的服务项目中，按此处所述](http://msdn.microsoft.com/en-us/library/ddhy0byf(VS.80).aspx)添加项目安装程序。您的 ProjectInstaller 的属性之一将是[ServicesDependedOn](http://msdn.microsoft.com/en-us/library/system.serviceprocess.servicecontroller.servicesdependedon.aspx)。当您将服务添加到该字符串数组时（您可以通过 IDE 执行此操作），它们将需要在您的服务启动之前启动。如果它们未启动，SCM 将尝试启动它们。

# unicode - 如何将 Unicode 字符转换为转义码

> ID：1015382
> 
> 赞同：4
> 
> 时间：2009-06-18T21:49:19.710
> 
> 标签：unicode, vb6, utf-8, rtf

所以，我有一堆这样的字符串： {\b\cf12 よろてそ } 。我想我可以遍历每个字符并用 unicode 转义码（\u###）替换任何 unicode（*编辑：任何地方* `AscW(char) > 127 or < 0`）。但是，我不确定如何以编程方式这样做。有什么建议么？

澄清：

我有一个像 {\b\cf12 よろてそ } 这样的字符串，我想要一个像 {\b\cf12 [STUFF]} 这样的字符串，当我查看 rtf 文本时，其中 [STUFF] 将显示为 よろてそ。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-19T09:15:01.320

您可以简单地使用 AscW() 函数来获得正确的值：-

```
sRTF = "\u" & CStr(AscW(char)) 
```

请注意，与 unicode 的其他转义不同，RTF 使用十进制有符号的 short int（2 字节）表示来表示 unicode 字符。这使得 VB6 中的转换非常容易。

**编辑**

正如 MarkJ 在评论中指出的那样，您只会对 0-127 之外的字符执行此操作，但您还需要对 0-127 范围内的其他字符进行特殊处理。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-30T15:14:42.757

另一种更迂回的方法是将 MSScript.OCX 添加到项目中并与 VBScript 的 Escape 函数接口。例如

```
Sub main()
    Dim s As String
    s = ChrW$(&H3088) & ChrW$(&H308D) & ChrW$(&H3066) & ChrW$(&H305D)
    Debug.Print MyEscape(s)
End Sub

Function MyEscape(s As String) As String
    Dim scr As Object
    Set scr = CreateObject("MSScriptControl.ScriptControl")
    scr.Language = "VBScript"
    scr.Reset
    MyEscape = scr.eval("escape(" & dq(s) & ")")
End Function

Function dq(s)
    dq = Chr$(34) & s & Chr$(34)
End Function 
```

Main 例程传入原始日文字符，调试输出显示：

```
%u3088%u308D%u3066%u305D 
```

高温高压

# c - 为什么 WH_MOUSE 钩子不再是全局的了？

> ID：1015393
> 
> 赞同：1
> 
> 时间：2009-06-18T21:51:07.910
> 
> 标签：c, winapi, mouse, hook, low-level

我在一个监视鼠标手势的 DLL 中有这个全局鼠标钩子设置。

一切正常，但为 WH_MOUSE_LL 设置了一个钩子，这是一个低级钩子，不​​需要在外部可注入 DLL 中。

一旦我切换到更合适的那个会说 - WH_MOUSE 鼠标钩，一切都崩溃了。一旦我在我的主应用程序（安装钩子的那个）之外单击，钩子就会损坏 - ::UnhookWindowsHookEx 将失败。

我只发现[这个人在专家交流中说](http://www.experts-exchange.com/Programming/Languages/CPP/Q_10095972.html?sfQueryTermInfo=1+mous+wh)：

> “没办法，至少在Windows XP + SVP2下WH_MOUSE不会全球化，你必须改用WH_MOUSE_LL。”

我正确设置了钩子：在使用共享数据部分的 DLL 中，从钩子过程中发布而不发送消息。

为什么这发生了变化？为什么没有记录？有人遇到过这个吗？谢谢！

顺便说一句：我对流行的[StrokeIt](http://www.tcbmi.com/strokeit/)应用程序进行了一些逆向工程，它使用了 WH_GETMESSAGE 和 WH_MOUSE 钩子的组合，并且仍然可以在 XP/Vista 上运行......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-11-28T19:32:15.377

不确定这是否会更好作为评论，但这里有：我相信根据 MSDN WH_MOUSE 在线程级别或全局受支持。

正如您自己指出的那样，有很多应用程序在使用它。

所以我的猜测是你对全局 WH_MOUSE 的具体实现有一个需要调试和修复的问题。当您说“钩子已损坏”时，究竟会发生什么？上钩的应用程序会崩溃吗？您能否将调试器附加到您期望鼠标事件来自的应用程序并检查您的钩子中真正崩溃的原因？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-10T03:13:59.093

对我来说，不再支持全局 WH_MOUSE 钩子对我来说是个新闻，因为我有一些使用它的应用程序，它们继续在 XP、Vista 和 Windows 7 上运行。

你是如何设置钩子的？你应该可以做 SetWindowsHookEx(WH_MOUSE, my_mouse_callback, g_hinstance, NULL)。

我唯一能想到的是回调函数花费的时间太长，在这种情况下，Windows 可能会删除钩子，或者它没有正确调用 CallNextHookEx。

# javascript - IE8 jQuery FadeTo

> ID：1015395
> 
> 赞同：1
> 
> 时间：2009-06-18T21:51:27.583
> 
> 标签：javascript, jquery, xhtml, internet-explorer-8

HTML 标记：

```
 <ul id="portfolio"><li class="web">
            <span class="info">August 2007 <a href="http://awebsite.com" rel="external">visit</a></span>
            <a href="/assets/image.jpg" class="fancybox" rel="web">
                <img src="/assets/imagelarge.jpg" alt="Rising Star Ranch" />
                <span class="title">Some Title</span> Some other text...
            </a>
        </li>
    </ul> 
```

jQuery：

```
$("ul#portfolio li").fadeTo("slow", 0.3); 
```

在 Firefox 3 和 3.5 以及 IE7 中，这会按预期运行，并淡出“li”中的所有元素。在 IE8 中，什么都不会褪色，调试时也不会出现 Javascript 错误。

该页面位于 [http://joecoledesign.com/portfolio](http://joecoledesign.com/portfolio)

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-18T22:14:35.540

您是否尝试过在 ul#portfolio li 周围加上引号？选择器只是一个字符串，所以它需要引号。即使在我的 Firefox 中，没有引号也不起作用。

```
$("ul#portfolio li").fadeTo("slow", 0.3); 
```

编辑：好的，尝试将淡入淡出应用于所有子元素：对于初学者来说，span 和 img 将一一应用。它确实可能是一个 IE 错误。

编辑：您还缺少 id="portfolio" 的结束语。来吧，伙计，在你发帖之前试着解决这些问题。

编辑：顺便说一句，以上在 IE8 中工作正常 - 我只是把它放在一起并将它扔到一个空白的 IE8 页面中 - 整个事情都消失了。

编辑：您页面上的其他内容很可能正在执行此操作，因为它可以独立运行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-18T22:10:02.960

非常酷的页面乔！WRT IE8 唯一想到的是 jQuery 可能没有赶上它，或者您的浏览器可能有些有趣（例如您的 javascript 设置可能被调整）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-10-20T17:37:11.207

我对 IE8 的透明度也有同样的问题。显然，IE8 设置透明度的方法与 IE6/7 不同。不幸的是，jquery 还没有办法为 IE8 设置透明度动画。为什么是微软，为什么？！？

[http://mdasblog.wordpress.com/2009/07/24/jquery-fun-with-animation-and-opacity/](http://mdasblog.wordpress.com/2009/07/24/jquery-fun-with-animation-and-opacity/)

这就是我在这个主题上发现的，在阅读之后我放弃了尝试让它工作，因为它证实了我的怀疑。希望 jquery 将在他们的下一个版本中修复这个问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-10-04T22:07:36.933

我经历了同样的事情，并且由于 Artem 的帖子发现表格的子元素没有收到 IE8 中的不透明度更改。因此，乍一看似乎什么都没有发生。我相信 Artem 的空白页示例有效而原始海报示例无效的原因是 Artem 的示例中没有孩子。

在子元素上添加 fadeTo 为我解决了这个问题。旧帖子，但它解决了我的问题，所以认为它仍然相关。

# javascript - 用javascript砍掉未使用的小数

> ID：1015402
> 
> 赞同：13
> 
> 时间：2009-06-18T21:52:59.453
> 
> 标签：javascript, decimal

我有一个货币输入，只需要返回有效数字。输入总是有两位小数，所以：

```
4.00  ->  4
4.10  ->  4.1
4.01  ->  4.01 
```

这是我目前的做法：

```
// chop off unnecessary decimals
if (val.charAt(val.length-1) == '0') { // xx.00
    val = val.substr(0, val.length-1);
}
if (val.charAt(val.length-1) == '0') { // xx.0
    val = val.substr(0, val.length-1);
}
if (val.charAt(val.length-1) == '.') { // xx.
    val = val.substr(0, val.length-1);
} 
```

这很有效，并且对它有一定的直接性，我有点喜欢，但也许有更漂亮的方式。

我想我可以使用一个循环并运行它三遍，但实际上，当我对 if 语句进行条件化时，它看起来至少会变得笨重。除此之外，还有什么想法吗？我想也有一种正则表达式的方式来做到这一点......

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-06-18T21:54:56.890

我相信[parseFloat()](http://www.w3schools.com/jsref/tryit.asp?filename=tryjsref_parsefloat)可以做到这一点。

```
parseFloat(4.00) // 4
parseFloat(4.10) // 4.1
parseFloat(4.01) // 4.01 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-06-18T21:59:19.737

您的代码还会去掉“1000”等数字中的零。一个更好的变体是只去掉小数点后的零。正则表达式的基本替换如下所示：

```
str.replace(/(\.[0-9]*?)0+$/, "$1"); // remove trailing zeros
str.replace(/\.$/, "");              // remove trailing dot 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-18T23:37:23.203

```
string to string: parseFloat(value).toFixed(2);
string to number: +(parseFloat(value).toFixed(2))
number to number: Math.round(value*100)/100;
number to string: (Math.round(value*100)/100).toFixed(2); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-08-07T13:34:00.877

我想这就是你想要的

```
 v = 33.404034
    v.toFixed(2) # v -> 33.40
    parseFloat(v.toFixed(2)) # 33.4 
```

你有

```
 v = 33.00704034
    v.toFixed(2) # v -> 33.01
    parseFloat(v.toFixed(2)) # 33.01

    v = 33.00304034
    v.toFixed(2) # v -> 33.00
    parseFloat(v.toFixed(2)) # 33 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-18T22:04:32.113

所以你从一个字符串开始，你想要一个字符串结果，对吗？

```
val = "" + parseFloat(val); 
```

那应该行得通。越简洁

```
val = "" + +val; 
```

或者

```
val = +val + ""; 
```

也可以，但是这种形式太难理解了。

这些是如何工作的？他们将字符串转换为数字，然后再转换回字符串。您可能不想使用这些，但了解 JavaScript 转换的工作原理将帮助您调试您想出的任何东西。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-18T21:58:48.940

```
String(4) // "4"
String(4.1) // "4.1"
String(4.10) // "4.1"
String(4.01) // "4.01" 
```

parseFloat 有效，但您必须将其转换回字符串。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-05-17T12:29:47.783

我现在正试图找到这样的解决方案。我就是这样来到这里的。

我在我的应用程序中使用了 Number() 函数，但看起来它与 parseFloat() 的工作方式相同

[http://jsfiddle.net/4WN5y/](http://jsfiddle.net/4WN5y/)

在检查号码之前，我删除和逗号。

```
 var valueAsNumber = Number( val.replace(/\,/g,'') ); 
```

# c# - WinForms RadioButtonList 不存在？

> ID：1015411
> 
> 赞同：10
> 
> 时间：2009-06-18T21:55:11.490
> 
> 标签：c#, winforms, radio-button, radiobuttonlist

我知道它`WebForms`有一个`RadioButtonList`控件，但我找不到一个`WinForms`。我需要将 3 个 RadioButtons 组合在一起，以便一次只能选择 1 个。我发现我必须通过代码来做到这一点，这很痛苦。我只是没有在`RadioButtonList`某个地方看到，还是它真的不存在`WinForms`？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2016-12-28T04:37:02.933

如果您只想对单选按钮进行分组，将它们放在一个容器中就足够了，那么它们将像一个组一样工作，但是如果您需要数据绑定，例如 a [`ComboBox`](https://docs.microsoft.com/en-us/dotnet/api/system.windows.forms.combobox?WT.mc_id=DT-MVP-5003235&view=netframework-4.8)or [`ListBox`](https://docs.microsoft.com/en-us/dotnet/api/system.windows.forms.listbox?WT.mc_id=DT-MVP-5003235&view=netframework-4.8)or的[`CheckedListBox`](https://docs.microsoft.com/en-us/dotnet/api/system.windows.forms.checkedlistbox?WT.mc_id=DT-MVP-5003235&view=netframework-4.8)工作方式，则需要一个`RadioButtonList`控件。

Windows 窗体没有内置`RadioButtonList`控件。`ListBox`您可以通过派生表单并使其所有者绘制和自己绘制单选按钮来创建自己的控件。这也是`CheckedListBox`被创建的方式。

这样，该控件就支持数据绑定，并将受益于 的所有功能`ListBox`，包括`DataSource`、`SelectedValue`、`DisplayMember`等`ValueMember`。例如，您可以简单地以这种方式使用它：

```
this.radioButtonList1.DataSource = peopleTable; 
this.radioButtonList1.DisplayMember = "Name"; 
this.radioButtonList1.ValueMember= "Id"; 
```

或者例如对于一个`enum`，简单地这样：

```
this.radioButtonList1.DataSource = Enum.GetValues(typeof(DayOfWeek)); 
```

在下图中，`RadioButtonList`通过设置禁用第二个`Enabled = false;`：

[![在此处输入图像描述](../Images/d01522c96761e83df0d294cb1bed6175.png)](https://i.stack.imgur.com/w8uxK.png) [![在此处输入图像描述](../Images/cb8bd8f76efeda1e23335e150c53dd69.png)](https://i.stack.imgur.com/NbzCB.png)

该控件还支持从右​​到左：

[![在此处输入图像描述](../Images/1cb6755bc3e533ad029b1b4f05656618.png)](https://i.stack.imgur.com/MKIvM.png)

它还支持多列：

[![在此处输入图像描述](../Images/2c47f0ed92efe10140be0a4ede3d086b.png)](https://i.stack.imgur.com/7S8xe.png)

## 单选按钮列表

这是控制的源代码。`ListBox`您可以通过添加项目或使用/不使用数据绑定设置数据源来像正常一样使用它：

```
using System;
using System.ComponentModel;
using System.Drawing;
using System.Windows.Forms;
using System.Windows.Forms.VisualStyles;
public class RadioButtonList : ListBox
{
    Size s;
    public RadioButtonList()
    {
        this.DrawMode = DrawMode.OwnerDrawFixed;
        using (var g = Graphics.FromHwnd(IntPtr.Zero))
            s = RadioButtonRenderer.GetGlyphSize(
                Graphics.FromHwnd(IntPtr.Zero), RadioButtonState.CheckedNormal);
    }
    protected override void OnDrawItem(DrawItemEventArgs e)
    {

        var text = (Items.Count > 0) ? GetItemText(Items[e.Index]) : Name;
        Rectangle r = e.Bounds; Point p;
        var flags = TextFormatFlags.Default | TextFormatFlags.NoPrefix;
        var selected = (e.State & DrawItemState.Selected) == DrawItemState.Selected;
        var state = selected ?
            (Enabled ? RadioButtonState.CheckedNormal : 
                       RadioButtonState.CheckedDisabled) :
            (Enabled ? RadioButtonState.UncheckedNormal : 
                       RadioButtonState.UncheckedDisabled);
        if (RightToLeft == System.Windows.Forms.RightToLeft.Yes)
        {
            p = new Point(r.Right - r.Height + (ItemHeight - s.Width) / 2,
                r.Top + (ItemHeight - s.Height) / 2);
            r = new Rectangle(r.Left, r.Top, r.Width - r.Height, r.Height);
            flags |= TextFormatFlags.RightToLeft | TextFormatFlags.Right;
        }
        else
        {
            p = new Point(r.Left + (ItemHeight - s.Width) / 2,
            r.Top + (ItemHeight - s.Height) / 2);
            r = new Rectangle(r.Left + r.Height, r.Top, r.Width - r.Height, r.Height);
        }
        var bc = selected ? (Enabled ? SystemColors.Highlight : 
            SystemColors.InactiveBorder) : BackColor;
        var fc = selected ? (Enabled ? SystemColors.HighlightText : 
            SystemColors.GrayText) : ForeColor;
        using (var b = new SolidBrush(bc))
            e.Graphics.FillRectangle(b, e.Bounds);
        RadioButtonRenderer.DrawRadioButton(e.Graphics, p, state);
        TextRenderer.DrawText(e.Graphics, text, Font, r, fc, bc, flags);
        e.DrawFocusRectangle();
        base.OnDrawItem(e);
    }
    [Browsable(false), EditorBrowsable(EditorBrowsableState.Never),
    DesignerSerializationVisibility(DesignerSerializationVisibility.Hidden)]
    public override SelectionMode SelectionMode
    {
        get { return System.Windows.Forms.SelectionMode.One; }
        set { }
    }
    [Browsable(false), EditorBrowsable(EditorBrowsableState.Never),
    DesignerSerializationVisibility(DesignerSerializationVisibility.Hidden)]
    public override int ItemHeight
    {
        get { return (this.Font.Height + 2); }
        set { }
    }
    [EditorBrowsable(EditorBrowsableState.Never), Browsable(false),
    DesignerSerializationVisibility(DesignerSerializationVisibility.Hidden)]
    public override DrawMode DrawMode
    {
        get { return base.DrawMode; }
        set { base.DrawMode = System.Windows.Forms.DrawMode.OwnerDrawFixed; }
    }
} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-06-18T21:58:20.300

[显然不是](http://bytes.com/groups/net-vb/378283-where-radiobuttonlist)。

您可以使用 GroupBox 或 Panel 将三个 RadioButton 组合在一起，[就像这里所做的那样](http://msdn.microsoft.com/en-us/library/sefz7fxc.aspx)。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-18T22:03:51.037

多个单选按钮位于同一个容器中这一简单事实使它们相互排斥，您不必自己编写此行为的代码。只需按照 Matthew 的建议将它们放在 Panel 或 GroupBox 中

# svn - 使用 phing 复制整个目录

> ID：1015412
> 
> 赞同：8
> 
> 时间：2009-06-18T21:55:14.597
> 
> 标签：svn, phing

有谁知道是否可以使用 phing 将包含文件和子文件夹（joomla 核心下载）的整个文件夹复制到另一个文件夹，但没有 .svn 文件夹。

我已经使用 SVN 下载了 joomla，我想使用 phing 将它导出到我的 joomla dev 文件夹，而无需列出每个文件类型。我的计划是使用它来让我的开发人员从主干更新。

我知道如何排除

但是无论如何都找不到包含所有文件而不列出每个文件，或者试图猜测每个文件类型，以防万一我错过了什么！

建议保罗

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-06-28T06:55:53.680

看起来phing是仿照蚂蚁的？试试这个：

```
<copy todir="my/joomla/dev">
  <fileset dir="joomla/checkout">
    <include>**</include>
    <exclude>**/.svn/**</exclude>
  </fileset>
</copy> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-18T21:57:59.567

尝试 svn export，这会将工作副本中的所有文件发送到另一个目录（sans .svn 等）。然后你就可以偷偷溜走了。

# statistics - 发生预测

> ID：1015424
> 
> 赞同：0
> 
> 时间：2009-06-18T21:57:52.763
> 
> 标签：statistics, regression, prediction

我想知道哪种方法最适合预测事件的发生。例如，给定一组来自​​ 5 年疟疾感染发生率的数据和影响发生率的其他几个因素，我想预测未来五年的疟疾感染发生率。我的想法是用模糊逻辑规则推导出一种发生因子，然后用发生因子对出现进行平均得到第一个预测的发生，然后再用预测的发生对所有的事件进行平均，并继续迭代所有五个年，但我决定在网上寻求帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-18T23:37:36.793

预测的方法有很多种，每种方法都有自己的优点和缺点。确定预测准确性的科学通常包括尽量减少错误。所有的预测都归结为使用过去作为未来的预测器，并对其进行一定程度的调整。例如，明天的温度将与今天相同，加上或减去一些量。您如何决定 +/- 会有所不同。

以下是您可能想要查看的一系列技术：

*   移动平均线（单、单、双）
*   指数平滑
*   分解（趋势+季节性+周期性+不规则）
*   线性回归
*   多重回归
*   Box-Jenkis（又名 ARIMA，自回归综合移动平均线）

对不起，对于模糊的答案，但预测是复杂的东西。

你所描述的关于将你的预测反馈到模型中以产生未来预测的内容是标准的东西。我不知道“模糊逻辑”是否能给你带来什么特别的东西。正如任何预测讲师都会告诉你的那样，有时你只是眯着眼睛看数据。上下文就是一切。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T04:58:31.580

我会使用[logit](http://en.wikipedia.org/wiki/Logit)或[probit](http://en.wikipedia.org/wiki/Probit)模型来预测给定一组外生情况的发生。不知道为什么要迭代。这基本上相当于在回归公式中包含一个滞后。你可以做到，只要系数<1，你就不会有爆炸问题。

如果要向自变量引入内生性元素，可以使用[VAR](http://en.wikipedia.org/wiki/Vector_autoregression)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-18T22:00:56.720

我认为按照您所说的想法，随着时间的推移，您将具有渐近行为。您的数据要么收敛到 0，要么会爆炸。也就是说，您可能必须先提供一些数据和/或描述其属性，然后才能有人帮助您。这基本上是一个模拟，当涉及到外推时，因素就是*一切。*

# perl - 如果我使用 backtics 调用 curl 的输出，如何将其输出到 Perl 中的变量中？

> ID：1015438
> 
> 赞同：9
> 
> 时间：2009-06-18T22:00:31.370
> 
> 标签：perl, curl, backticks, qx

我正在尝试将 curl 调用的响应转换为 perl 中的变量。

```
my $foo = `curl yadd yadda`;

print $foo; 
```

不起作用。当我在命令行上运行它时，curl 调用会在终端中正确打印其所有输出，但变量没有填充该数据。

有没有办法在不安装和调用 Perl curl 库的情况下做到这一点？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-06-18T22:03:37.417

它可能会将其内容发送到 stderr。尝试

```
my $foo = `curl yadd yadda 2>&1`; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-19T01:16:03.613

您还可以考虑查看[LWP::UserAgent](http://search.cpan.org/~gaas/libwww-perl-5.827/lib/LWP/UserAgent.pm)甚至[LWP::Simple](http://search.cpan.org/~gaas/libwww-perl-5.827/lib/LWP/Simple.pm)。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-21T11:47:24.350

你真正想做的是什么？不惜一切代价使用`curl`，还是抓取网页的内容？

一种更糟糕的方法（它不依赖于可能会或可能不会安装在您需要执行此操作的下一台机器上的任何外部程序）是：

```
use LWP::Simple;

my $content = get("http://stackoverflow.com/questions/1015438/")
   or die "no such luck\n"; 
```

如果您想查看 GET 失败的原因，或者从同一个站点获取多个页面，则需要使用更多的机器。`perldoc lwpcook`会让你开始。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-18T22:14:05.727

在 shell`2>`中意味着重定向 fileno 2。 Fileno 2 始终是程序视为 stderr 的内容。同样，fileno 0 是标准输入，fileno 1 是标准输出。因此，当您说`2>&1`您是在告诉 shell 将 stderr（fileno 2）重定向到 stdout（fileno 1）时。由于反引号操作符使用 shell 来运行你指定的命令，你可以使用 shell 重定向，所以

```
my $foo = `curl yadda yadda 2>&1`; 
```

告诉 curl 将其输出重定向到标准输出，并且由于反引号运算符捕获标准输出，因此您得到了您想要的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-08-29T21:24:41.073

很老的帖子，但是在反引号中使用 curl 的*真正*方法是使用适当的 curl 开关。

这个开关是**-o**，它定义了将输出发送到哪里。

更多来自 curl 手册页：

> 将输出指定为“-”（单破折号）将强制输出到标准输出。

这也可以防止在*$foo*中出现可能的错误，如果您将完整的 STDERR 重定向到错误的 STDOUT 会发生这种情况：

```
my $foo = `curl -o - yadd yadda`; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-18T22:06:31.313

试试这个：

```
$var = `curl "http://localhost" 2>/dev/null`; 
print length($var) 
```

`curl`在 stderr 上显示进度信息，将其重定向到 /dev/null 可以更轻松地查看正在发生的事情。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-18T22:09:28.640

这适用于我的系统：

```
#!/usr/bin/perl

use strict;
use warnings;

my $output = `curl www.unur.com`;

print $output;

__END__

C:\> z1

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
"http://www.w3.org/TR/html4/strict.dtd"><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> 
```

等等

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-05-22T05:44:20.597

您可以像打开文件一样打开管道。

```
$url = "\"http://download.finance.yahoo.com/d/quotes.csv?s=" . 
"$symbol&f=sl1d1t1c1ohgvper&e=.csv\"";

open CURL, "curl -s $url |" or die "single_stock_quote: Can't open curl $!\n";
$line = <CURL>;
close CURL; 
```

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2009-06-18T22:06:56.803

您想要捕获的某些输出可能是标准错误，而不是标准输出。试试这个：

```
my $foo = system "curl http://www.stackoverflow.com";
print $foo; 
```

# testing - 分支测试

> ID：1015441
> 
> 赞同：1
> 
> 时间：2009-06-18T22:01:06.737
> 
> 标签：testing

```
if(condition1)
    dosomething1();
if(condition2)
    dosomething2();
if(condition3)
    dosomething3(); 
```

如果我在这个例子中有两个测试用例，它是完整的分支测试吗

1.  条件1 = 条件2 = 条件3 = 真；
2.  条件1 = 条件2 = 条件3 = 假；

还是我误解了？试图找出分支测试和路径测试之间的区别。我得到了路径测试，所以希望这是正确的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-18T22:05:21.940

分支测试：

> 测试程序源代码中的所有分支至少测试一次。

是的; 您正在执行正确的分支测试，因为您的所有分支都被命中。事实上，您可以删除第二个测试用例，因为案例 1 执行所有分支。

显然，分支测试没有路径测试那么全面，因为它命中依赖项的可能性很低，因此，不应该是你唯一的测试形式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-09-30T05:47:03.633

据我了解，分支覆盖也称为决策覆盖，它涵盖了真假条件

与语句覆盖率不同。使用 IF 语句，出口可以是 TRUE 或 FALSE，具体取决于值

IF 之后的逻辑条件。

让我们举一个例子来解释分支覆盖：

如果“A > B”

打印 A 大于 B

万一

因此，100% 分支覆盖率的测试集将是：

测试用例 1：A=5，B=2 将返回 true。

测试用例 2：A=2，B=5 将返回 false。

因此，在您的情况下，分支覆盖需要测试用例 1 和 2。

只有测试用例1，它将是语句覆盖率。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-03-29T10:29:44.070

**我不同意您可以删除第二条测试线的选择答案！**

维基百科对分支测试的定义是：“分支覆盖率——每个控制结构（例如 if 和 case 语句）的每个分支（也称为 DD 路径）是否已执行？**例如，给定一个 if 语句，同时具有 true 和执行了错误分支？**换一种说法是，程序中的每一条边都执行了吗？
链接在这里：[https ://en.wikipedia.org/wiki/Code_coverage](https://en.wikipedia.org/wiki/Code_coverage)

另请查看佐治亚理工学院计算机科学项目关于分支测试的视频讲座，其中演示了这一要求。
链接在这里：[https ://www.youtube.com/watch?v=JkJFxPy08rk](https://www.youtube.com/watch?v=JkJFxPy08rk)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-08-21T18:54:48.963

要实现 100% 的基路径覆盖率，您需要定义基组。该方法的圈复杂度为四（一加决策数），因此需要定义四个线性独立的路径。为此，您选择任意的第一条路径作为基线，然后一次一个地翻转决策，直到您有了基础设置。

路径 1：任何路径都适用于您的基线，因此请选择正确的决策结果（表示为 TTT）。这是您的基组中的第一条路径。

路径 2：要找到下一个基础路径，请（仅）翻转基线中的第一个决策，为您提供所需决策结果的 FTT。

路径 3：您翻转基线路径中的第二个决策，为您的第三个基本路径提供 TFT。在这种情况下，第一个基线决策与真实结果保持不变。

路径 4：最后，您翻转基线路径中的第三个决策，为您的第四个基本路径提供 TTF。在这种情况下，第一个基线决策与真实结果保持不变。

因此，您的四个基本路径是 TTT、FTT、TFT 和 TTF。现在，组成你的测试，看看会发生什么。

请记住，基础路径测试的目标是独立地测试所有决策结果

（摘自[http://www.codign.com/pathbranchcode.html](http://www.codign.com/pathbranchcode.html)）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-18T22:05:22.937

如果我理解您的要求，那么您可能需要八个测试用例才能完全涵盖给定代码中的替代方案。例如，如果`dosomething2()`依赖于由 设置的其他状态`dosomething1()`怎么办？您的测试用例无法满足该要求。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-18T22:05:24.310

是的，你理解正确。分支测试只是“执行所有分支”。

# java - 如何获取 appengine 应用的当前服务器 URL？

> ID：1015442
> 
> 赞同：10
> 
> 时间：2009-06-18T22:01:45.020
> 
> 标签：java, google-app-engine

我正在尝试从代码中获取当前正在运行的 appengine java 应用程序的服务器 URL。也就是说，如果应用程序在我的本地开发机器上运行，我想以某种方式返回“ [http://localhost:8080](http://localhost:8080) ”，但如果它在 prod 中运行，我希望返回“ [http://myappid. apppot.com](http://myappid.appspot.com) ”。是否有任何 java 或 appengine API 可以做到这一点？我不想手动更改和读取配置文件或常量。

谢谢。

*   阿莱姆

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2011-05-20T10:42:04.827

这在 appengine 上的 Java 中为我工作：

```
String hostUrl; 
String environment = System.getProperty("com.google.appengine.runtime.environment");
if (StringUtils.equals("Production", environment)) {
    String applicationId = System.getProperty("com.google.appengine.application.id");
    String version = System.getProperty("com.google.appengine.application.version");
    hostUrl = "http://"+version+"."+applicationId+".appspot.com/";
} else {
    hostUrl = "http://localhost:8888";
} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-06-18T22:53:11.593

这是在您的请求处理程序中执行此操作的几种方法（如果您使用的是提供的`webapp`基本框架）：

```
 def get(self):
    self.response.out.write(self.request.headers.get('host', 'no host'))
    self.response.out.write('<br>\n')
    who = wsgiref.util.request_uri(self.request.environ)
    self.response.out.write(who + '<br>\n') 
```

这会发出 'localhost:8081' 或 'blabla.appspot.com' 作为第一行，而第二行则像完整的 URI，例如 ' [http://localhost:8081/zup](http://localhost:8081/zup) ' 或 ' [http://blabla 。 apppot.com/zup](http://blabla.appspot.com/zup) '。

更一般地说，您可以使用`wsgiref.util`它轻松地从任何 WSGI 环境中提取信息，并且由于 App Engine 在 WSGI 之上提供服务，因此应该总是有简单的方法可以从您选择的任何框架的离合器中撬出这样的环境；-)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-06-19T07:20:36.623

您应该能够使用 getServerName()：

```
boolean local = "localhost".equals(httpServletRequest.getServerName()); 
```

如果您需要更多信息，还可以使用其他方法，例如 getServerPort()。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-08-25T01:02:13.233

我知道这已经得到了回答，但还有一个要加入其中；

```
import com.google.apphosting.api.ApiProxy;

...

final ApiProxy.Environment env = ApiProxy.getCurrentEnvironment();
final Map<String, Object> attributes = env.getAttributes();
final String hostAndPort = (String) attributes.get("com.google.appengine.runtime.default_version_hostname");
final String url = "http://" + hostAndPort + "/"; 
```

参考：[https ://cloud.google.com/appengine/docs/java/appidentity/#Java_Asserting_identity_to_other_App_Engine_apps](https://cloud.google.com/appengine/docs/java/appidentity/#Java_Asserting_identity_to_other_App_Engine_apps)

# regex - 用于生成串联字符串变量和文字的笛卡尔积的类正则表达式语法或 CFG

> ID：1015449
> 
> 赞同：0
> 
> 时间：2009-06-18T22:04:23.237
> 
> 标签：regex, string, context-free-grammar

我正在编写一个模拟器，并想通过调用模拟器的许多实例，使用不同的命令行参数集来运行研究。我已经阅读[了这个](https://stackoverflow.com/questions/205411/random-string-that-matches-a-regexp)问题和其他几个问题，它们看起来很接近，但我实际上并不是在寻找满足特定正则表达式的随机数据，我想要与正则表达式匹配的*所有*字符串的集合。示例输入文件如下所示：

```
myprogram.{version1|version2} -arg1 {1|2|4} {-arg2|} 
```

或者：

```
myprogram.{0} -arg1 {1} {2}
0: "version1" "version2"
1: "1" "2" "4"
2: "-arg2" "" 
```

并会产生：

```
myprogram.version1 -arg1 1 -arg2
myprogram.version1 -arg1 1
myprogram.version1 -arg1 2 -arg2
myprogram.version1 -arg1 2
myprogram.version1 -arg1 4 -arg2
myprogram.version1 -arg1 4
myprogram.version2 -arg1 1 -arg2
myprogram.version2 -arg1 1
myprogram.version2 -arg1 2 -arg2
myprogram.version2 -arg1 2
myprogram.version2 -arg1 4 -arg2
myprogram.version2 -arg1 4 
```

我想像这样的东西已经存在，我只是不知道要搜索的正确术语。任何帮助将非常感激。如果需要，我可以自己实现一种抽象技术或算法，但如果它是一个预先存在的工具，我希望它是免费的（至少像啤酒一样）并在 Linux 上运行。

我知道我可能会遗漏一些细节，如果有必要，可以更具体地说明适当的事情，而不是预先用大量细节淹没人们。我完全有可能以错误的方式解决这个问题，我欢迎所有解决方案，即使它们以不同的方式解决我的问题。

最重要的是，如果我想向我生成的字符串的“叉积”添加更多参数选项，此解决方案不应该要求我编写任何额外的解析代码。我已经有一个 Perl 脚本，它在每个“变量”上使用一组嵌套`for`循环来执行此操作，每次我更改变量的数量或性质时，这些“变量”都必须更改。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-18T22:38:20.857

只要大括号没有嵌套，正则表达式就可以正常工作。如果您需要嵌套，您可以在实现语言中添加一些额外的递归。

以下是 Python 中的示例：

```
import re

def make_choices(template):
    pat = re.compile(r'(.*?)\{([^{}]+)\}',re.S)

    # tokenize the string
    last_end = 0
    choices = []
    for match in pat.finditer(template):
        prefix, alts = match.groups()
        if prefix:
            choices.append((prefix,)) # as a tuple
        choices.append(alts.split("|"))
        last_end = match.end()

    suffix = template[last_end:]
    if suffix:
        choices.append((suffix,))

    # recursive inner function
    def chooser(index):
        if index >= len(choices):
            yield []
        else:
            for alt in choices[index]:
                for result in chooser(index+1):
                    result.insert(0,alt)
                    yield result

    for result in chooser(0):
        yield ''.join(result) 
```

例子：

```
>>> for result in make_choices('myprogram.{version1|version2} -arg1 {1|2|4} {-arg2|}'):
...     print result
...
myprogram.version1 -arg1 1 -arg2
myprogram.version1 -arg1 1
myprogram.version1 -arg1 2 -arg2
myprogram.version1 -arg1 2
myprogram.version1 -arg1 4 -arg2
myprogram.version1 -arg1 4
myprogram.version2 -arg1 1 -arg2
myprogram.version2 -arg1 1
myprogram.version2 -arg1 2 -arg2
myprogram.version2 -arg1 2
myprogram.version2 -arg1 4 -arg2
myprogram.version2 -arg1 4 
```

您可以使用`os.system()`从 Python 中执行命令：

```
#!/etc/env python
import sys, os

template = ' '.join(sys.args)
failed = 0
total = 0
for command in make_choices(template):
    print command
    if os.system(command):
        print 'FAILED'
        failed += 1
    else:
        print 'OK'
    total += 1

print
print '%d of %d failed.' % (failed,total)

sys.exit(failed > 0) 
```

然后在命令行上：

```
user:/home/> template.py 'program.{version1|version2}'
program.version1
OK
program.version2
FAILED

1 of 2 failed. 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-18T23:01:20.173

您并不是真的在寻找正则表达式所设计的东西。您只是在寻找一种生成离散选项组合的工具。

根据所有可能参数的集合，实际上可能不需要详尽的组合列表。无论如何，您应该研究[成对测试](http://www.pairwise.org/)。我知道[PICT 工具](http://www.pairwise.org/tools.asp)可以为您生成详尽的列表或您想要的测试用例的成对列表。

# flash - 在单选按钮标签上设置 alpha

> ID：1015452
> 
> 赞同：0
> 
> 时间：2009-06-18T22:04:40.113
> 
> 标签：flash, actionscript-3, radio-button, alpha

我正在尝试将 AS3 中某些单选按钮的 alpha 设置为 50%。问题是单选按钮标签不会改变。

有人知道怎么修这个东西吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-18T22:15:20.530

您必须为标签使用嵌入式字体。正如文档所述：

*   客户端环境不需要安装字体。
*   嵌入的字体是抗锯齿的，这意味着它们的边缘被平滑以便于阅读。当文本较大时，这一点尤其明显。
*   **嵌入字体可以部分或完全透明。**
*   嵌入的字体可以旋转。
*   嵌入字体在缩放时提供更流畅的播放。
*   使用嵌入字体时，文本会完全按照您的预期显示。
*   嵌入字体时，您可以使用高级消除锯齿信息，在 SWF 文件中提供清晰、高质量的文本呈现。使用高级抗锯齿可以极大地提高文本的可读性，尤其是在以较小字体呈现时。有关高级抗锯齿的更多信息，请参阅使用高级抗锯齿。

[http://livedocs.adobe.com/flex/3/html/help.html?content=fonts_04.html#133099](http://livedocs.adobe.com/flex/3/html/help.html?content=fonts_04.html#133099)

希望这可以帮助。

**编辑**

回复 Kekoa：

此示例使无线电控制几乎不可见，但标签不受 alpha 变化的影响：

```
<?xml version="1.0" encoding="utf-8"?>
<mx:WindowedApplication xmlns:mx="http://www.adobe.com/2006/mxml">
    <mx:RadioButton label="Some label here" alpha=".1" />
</mx:WindowedApplication> 
```

并使用嵌入式字体（确保您有 assets/arial.ttf）：

```
<?xml version="1.0" encoding="utf-8"?>
<mx:WindowedApplication xmlns:mx="http://www.adobe.com/2006/mxml">
    <mx:Style>
        @font-face {
            src: url("assets/arial.ttf");
            fontFamily: Arial;
            fontStyle: normal;
            fontWeight: normal;
        }
        .myClass {
            fontFamily: Arial;
        }
    </mx:Style>
    <mx:RadioButton label="Some label here" alpha=".1" />
</mx:WindowedApplication> 
```

这个工作正常。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-06-18T22:18:41.693

我刚刚创建了一个空电影并在舞台上添加了一个 RadioButton 组件，给它一个实例名称，并在动作中将 .alpha 设置为 .5。

有用。

如果您不使用 RadioButtons？还是它们与您的标签分开？

# sql - 计算每组的行数

> ID：1015459
> 
> 赞同：1
> 
> 时间：2009-06-18T22:05:30.847
> 
> 标签：sql, codeigniter

使用 CodeIgniter 的 Active Record 类和 MySQL，我有一个包含`user_id`各种其他字段的帖子表，我想计算每个用户发表了多少帖子。我可以在哪里获取行`user_id = $whatever`并计算结果的数量，但我必须遍历每一个`user_id`并一遍又一遍地使用该`count_all_results()`查询。

肯定有更好的办法！如果每个字段都只有一个字段，`1`那么我可以`select_sum`向上计算该字段并进行计数。但这似乎很愚蠢。

提前谢谢了！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T08:18:05.400

使用活动记录应该是：

```
$this->db->select('field1, ... ,fieldn, count(1) as number_elements_of_row');

$this->db->group_by(array('field_group_1', ... ,'field_group_n'));

$result = $this->db->get('mytable'); 
```

所以`$result`会有你需要的！

# php - 从 AJAX 响应中删除表单

> ID：1015462
> 
> 赞同：-3
> 
> 时间：2009-06-18T22:06:30.097
> 
> 标签：php, jquery, ajax, forms

我正在尝试使用 ajax/jquery 添加一个表格行，其中包含一个表单元素。如果我在没有 ajax 的情况下设置它，一切都会正常工作，但不知何故，`<form>`标签内的所有东西都完全丢失了。

我不确定我在哪里丢失了表单（jquery 的 .html() 实际上与 innerHTML 相同，对吗？如果是这种情况，我怀疑这就是我丢失它的地方）。

无论如何，这里有一些代码：

```
var worow = document.getElementById('worow_' + row);
var wotable = document.getElementById('tbl_workorders');

// add a new row to the table underneath our existing row.
var newrow = wotable.insertRow(worow.rowIndex+1);
var x = newrow.insertCell(0);

// set up the row a little bit
x.colSpan = 13;
x.style.padding = '10px';
x.style.backgroundColor = '#ccc';
x.align = "center";

x.innerHTML = '<img src="/images/loading.gif" />';

// a little ajax cuz we're cool that way
$.post("getwotrans.php", 
{
    workorder: row
}, 
function(response)
{

    // set the value of the row = response object from the AJAX
    $(x).html(response);
}); 
```

在 getwotrans.php 中：（释义）

```
<table>
<thead><tr><td>blahblah</td></tr></thead>
<tbody><form><tr><td><input></td></tr></form></tbody>
</table> 
```

所以发生的事情是我将运行 javascript 函数来添加行，并且行添加得很好，我看到了表格标题，但是 tbody 内的“表单”不存在。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-18T22:38:45.647

表单不能是 tbody 的子元素

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T15:35:18.497

我有一些类似的问题。我使用隐藏表单和 javascript 将单击的行的值复制到隐藏表单元素，然后通过 javascript 提交表单。也许这是一个想法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-18T22:36:31.237

当您将表格放在表格之外时会发生什么？

```
<form><table>
<thead><tr><td>blahblah</td></tr></thead>
<tbody><tr><td><input></td></tr></tbody>
</table></form> 
```

只是好奇这是否会解决问题？奇怪的是，如果没有同样奇怪的东西来解决它，就会发生这种情况！

# jquery - 奇怪的 IE7 问题

> ID：1015475
> 
> 赞同：2
> 
> 时间：2009-06-18T22:12:47.087
> 
> 标签：jquery, html, css, internet-explorer-7, overflow

页面位于[此处](http://joecoledesign.com/portfolio)。

在 IE7 中，一切正常，直到您选择“过滤器”之一（例如其他）。在此之后，弹出气泡 (span.info) 在动画到图像上方时不再位于顶部。

没有溢出：隐藏在 li 或类似的东西上，并且将 z-index 应用于 span.info 没有任何区别。

您可以看出 span.info 仍然可以正常工作，因为您几乎看不到它的底部，然后它就被切断了。

这似乎是一个溢出问题，但我在开发人员工具中找不到任何类似的痕迹（在兼容模式下使用 IE8）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T00:49:39.050

也许这是一个不透明的问题？它可能与z-index无关？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T01:25:14.470

好吧，我只是决定采用与我所拥有的完全不同的解决方案。它与不透明度或 z-index (afaik) 无关......看起来溢出正在切断它，但我专门将它设置为可见。

嗯，因为 IE，另一个好主意。

# sharepoint - Sharepoint 代码生成工具

> ID：1015480
> 
> 赞同：1
> 
> 时间：2009-06-18T22:14:35.993
> 
> 标签：sharepoint, orm, sharepoint-2007, code-generation

我们的团队正在寻求为我们正在开发的当前共享点应用程序使用代码生成工具。我们希望能够生成大部分存储过程和业务实体，而不必从头开始编写它们。任何建议与共享点项目一起使用的最佳代码生成工具是什么。我熟悉 CodeSmith，但我不确定是否有更好的解决方案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-19T02:02:14.363

SharePoint 不需要代码生成，所有代码都是在 SharePoint .NET 库中生成的。

您的问题的表述意味着对 SharePoint 及其对数据库的使用存在相当严重的误解。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T06:51:18.250

如果您想通过生成的数据访问层与自定义数据库通信，我会说选择 ADO.NET 实体框架（但仅适用于 VS2008 SP1 和 .NET 3.5 SP1。自定义解决方案是[LLBLGen Pro](http://www.llblgen.com)

# c# - 如何将两个 C# 列表拼接成一个？或者也许使用不同的集合类型？

> ID：1015482
> 
> 赞同：1
> 
> 时间：2009-06-18T22:15:03.917
> 
> 标签：c#, generics, collections

```
List<string> list1 = new List<string>();
list1.Add("Blah");
list1.Add("Bleh");
list1.Add("Blih");

List<string> list2 = new List<string>();
list2.Add("Ooga");
list2.Add("Booga");
list2.Add("Wooga"); 
```

有没有一种方法可以创建第三个列表，该列表具有`{"Blah", "Bleh", "Blih", "Ooga", "Booga", "Wooga"}`或者更改`list1`为在 list2 中具有三个附加元素？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-18T22:16:36.363

我想这是解决方案：

```
list1.AddRange(list2) 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-06-18T22:17:15.940

使用 LINQ，您可以：

```
List<string> list1 = new List<string>();
list1.Add("Blah");
list1.Add("Bleh");
list1.Add("Blih");

List<string> list2 = new List<string>();
list2.Add("Ooga");
list2.Add("Booga");
list2.Add("Wooga");

var finalList = list1.Concat( list2 ).ToList(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-18T22:16:36.377

看一下 List 的 Union() 方法。

# bash - 是否可以让 Bash 文件在 crontab 中以 root 身份运行？

> ID：1015485
> 
> 赞同：20
> 
> 时间：2009-06-18T22:15:50.763
> 
> 标签：bash, crontab

我需要该[Bash](http://en.wikipedia.org/wiki/Bash_%28Unix_shell%29)文件定期运行，并且它必须以 root 身份运行。

那可能吗？

```
[root@file nutch-0.9]# locate crontab
/etc/crontab
/etc/sysconfig/crontab
/usr/bin/crontab
/usr/share/man/man1/crontab.1.gz
/usr/share/man/man1p/crontab.1p.gz
/usr/share/man/man5/crontab.5.gz
/usr/share/vim/vim71/syntax/crontab.vim
[root@file nutch-0.9]# 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-06-18T22:19:03.003

是的，只需将它添加到 root 用户的[crontab](http://en.wikipedia.org/wiki/Cron#Overview)；运行`crontab -e`命令。

cron 存储其文件的位置可能有点奇怪，所以使用该`crontab -e`命令将确保它位于正确的位置，并且我相信它会检查语法。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-06-18T22:19:10.350

你可以做

```
crontab -e 
```

作为根。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-06-18T22:26:06.373

只需将`root`以下条目指定为用户`/etc/crontab`：

```
0 0 *  * *  root  somecommand 
```

或者，您也可以使用 root 身份将该命令添加到 root 的个人 crontab `crontab -e`。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-06-18T22:33:22.460

无论如何，您都需要访问 root 用户帐户。

1.  您可以按照建议将其添加到根 crontab
2.  您可以按照建议使用 sudo
3.  您可以使用 setuid 位。setuid 位的问题是它需要是一个已编译的程序。如果已编译，您可以“chmod 4755”并将文件的所有者设置为root，它将以root身份运行。如果它没有被编译，你可以用 C（或任何其他编译的编程语言）编写一个小型包装器，它只调用你的脚本，并在包装​​器上设置 setuid，并确保包装器归 root 所有。

我的建议？使用根 crontab。这就是它的目的。

此外，在 crontab 中没有用户条目，正如 sth 所建议的那样......语法是：

```
# .---------------- minute (0 - 59) 
# |  .------------- hour (0 - 23)
# |  |  .---------- day of month (1 - 31)
# |  |  |  .------- month (1 - 12) OR jan,feb,mar,apr ... 
# |  |  |  |  .---- day of week (0 - 6) (Sunday=0 or 7)  OR sun,mon,tue,wed,thu,fri,sat 
# |  |  |  |  |
# *  *  *  *  *  command to be executed 
```

如果您想以 root 身份在 crontab 中输入某些内容，只需登录到您的 root 帐户，“crontab -e”，然后瞧……root crontab。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-18T22:19:28.337

我相信 root 的 crontab 中的所有条目都以 root 身份运行。你可以让它调用一个 Bash 脚本作为操作，它应该做你想做的事。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2009-06-18T22:21:20.627

一种方法（通过 sudo）：

1.  您需要为帐户设置 sudo 权限才能在不输入用户凭据的情况下运行
2.  添加“sudo /path/to/command”（不带“）以root身份运行命令。您还可以为命令添加参数。

# c++ - 我可以使用 Boost Signals2 和 Threads 在 C++ 中创建软件看门狗定时器线程吗？

> ID：1015494
> 
> 赞同：9
> 
> 时间：2009-06-18T22:17:48.793
> 
> 标签：c++, boost-thread, boost-signals, watchdog

我目前正在单线程应用程序中从其他人的库中运行函数 Foo 。大多数时候，我打电话给 Foo，它真的很快，有时，我打电话给 Foo，它需要很长时间。我不是一个有耐心的人，如果 Foo 要永远占用，我想停止执行 Foo 并且不使用这些参数调用它。

以受控方式调用 Foo 的最佳方法是什么（我当前的环境是 POSIX/C++），这样我可以在一定秒数后停止执行。我觉得在这里做的正确的事情是创建第二个线程来调用 Foo，而在我的主线程中，我创建了一个计时器函数，如果第二个线程超时，它最终会发出信号。

还有另一种更合适的模型（和解决方案）吗？如果没有，Boost 的 Signals2 库和 Threads 会起作用吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-19T07:58:55.123

您可以在超时的第二个线程上调用 Foo。例如：

```
#include <boost/date_time.hpp> 
#include <boost/thread/thread.hpp>

boost::posix_time::time_duration timeout = boost::posix_time::milliseconds(500);
boost::thread thrd(&Foo);

if (thrd.timed_join(timeout))
{
  //finished
}
else
{
  //Not finished;
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-09-01T07:00:23.347

您可以使用以下类：

```
class timer
{
    typedef boost::signals2::signal<void ()> timeout_slot;
public:
    typedef timeout_slot::slot_type timeout_slot_t;

public:
    timer() : _interval(0), _is_active(false) {};
    timer(int interval) : _interval(interval), _is_active(false) {};
    virtual ~timer() { stop(); };

    inline boost::signals2::connection connect(const timeout_slot_t& subscriber) { return _signalTimeout.connect(subscriber); };

    void start()
    {
        boost::lock_guard<boost::mutex> lock(_guard);

        if (is_active())
            return; // Already executed.
        if (_interval <= 0)
            return;

        _timer_thread.interrupt();
        _timer_thread.join();

        timer_worker job;
        _timer_thread = boost::thread(job, this);

        _is_active = true;
    };

    void stop()
    {
        boost::lock_guard<boost::mutex> lock(_guard);

        if (!is_active())
            return; // Already executed.

        _timer_thread.interrupt();
        _timer_thread.join();

        _is_active = false;
    };

    inline bool is_active() const { return _is_active; };

    inline int get_interval() const { return _interval; };

    void set_interval(const int msec)
    {
        if (msec <= 0 || _interval == msec)
            return;

        boost::lock_guard<boost::mutex> lock(_guard);
        // Keep timer activity status.
        bool was_active = is_active();

        if (was_active)
            stop();
        // Initialize timer with new interval.
        _interval = msec;

        if (was_active)
            start();
    };

protected:
    friend struct timer_worker;
    // The timer worker thread.
    struct timer_worker
    {
        void operator()(timer* t)
        {
            boost::posix_time::milliseconds duration(t->get_interval());

            try
            {
                while (1)
                {
                    boost::this_thread::sleep<boost::posix_time::milliseconds>(duration);
                    {
                        boost::this_thread::disable_interruption di;
                        {
                            t->_signalTimeout();
                        }
                    }
                }
            }
            catch (boost::thread_interrupted const& )
            {
                // Handle the thread interruption exception.
                // This exception raises on boots::this_thread::interrupt.
            }
        };
    };

protected:
    int             _interval;
    bool            _is_active;

    boost::mutex    _guard;
    boost::thread   _timer_thread;

    // Signal slots
    timeout_slot    _signalTimeout;
}; 
```

使用示例：

```
void _test_timer_handler()
{
    std::cout << "_test_timer_handler\n";
}

BOOST_AUTO_TEST_CASE( test_timer )
{
    emtorrus::timer timer;

    BOOST_CHECK(!timer.is_active());
    BOOST_CHECK(timer.get_interval() == 0);

    timer.set_interval(1000);
    timer.connect(_test_timer_handler);

    timer.start();

    BOOST_CHECK(timer.is_active());

    std::cout << "timer test started\n";

    boost::this_thread::sleep<boost::posix_time::milliseconds>(boost::posix_time::milliseconds(5500));

    timer.stop();

    BOOST_CHECK(!timer.is_active());
    BOOST_CHECK(_test_timer_count == 5);
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-18T22:20:21.143

您还可以在调用该函数之前设置警报，并捕获 SIGALRM。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-02-08T20:32:03.193

弗拉德，优秀的职位！您的代码已编译并且运行良好。我用它实现了一个软件看门狗定时器。我做了一些修改：

*   为了防止指针衰减，将信号存储在 boost::shared_ptr 中并将其传递给线程工作者，而不是指向计时器类的弱指针。这消除了线程工作者成为友元结构的需要，并保证信号在内存中。
*   添加参数 _is_periodic 以允许调用者选择工作线程是周期性的还是在到期后终止。
*   在 boost::atomic 中存储 _is_active、_interval 和 _is_periodic 以允许线程安全访问。
*   缩小互斥锁的范围。
*   添加 reset() 方法来“踢”定时器，防止它发出过期信号。

应用这些更改后：

```
#include <atomic>
#include <boost/signals2.hpp>
#include <boost/thread.hpp>

class IntervalThread
{
    using interval_signal = boost::signals2::signal<void(void)>;

public:
    using interval_slot_t = interval_signal::slot_type;

    IntervalThread(const int interval_ms = 60)
      : _interval_ms(interval_ms),
        _is_active(false),
        _is_periodic(false),
        _signal_expired(new interval_signal()) {};

    inline ~IntervalThread(void) { stop(); };

    boost::signals2::connection connect(const interval_slot_t &subscriber)
    {
        // thread-safe: signals2 obtains a mutex on connect()
        return _signal_expired->connect(subscriber); 
    };

    void start(void)
    {
        if (is_active())
            return; // Already executed.
        if (get_interval_ms() <= 0)
            return;

        boost::lock_guard<boost::mutex> lock(_timer_thread_guard);
        _timer_thread.interrupt();
        _timer_thread.join();

        _timer_thread = boost::thread(timer_worker(),
                static_cast<int>(get_interval_ms()),
                static_cast<bool>(is_periodic()),
                _signal_expired);
        _is_active = true;
    };

    void reset(void)
    {
        if (is_active())
            stop();
        start();
    }

    void stop(void)
    {
        if (!is_active())
            return; // Already executed.

        boost::lock_guard<boost::mutex> lock(_timer_thread_guard);
        _timer_thread.interrupt();
        _timer_thread.join();
        _is_active = false;
    };

    inline bool is_active(void) const { return _is_active; };

    inline int get_interval_ms(void) const { return _interval_ms; };

    void set_interval_ms(const int interval_ms)
    {
        if (interval_ms <= 0 || get_interval_ms() == interval_ms)
            return;

        // Cache timer activity state.
        const bool was_active = is_active();
        // Initialize timer with new interval.
        if (was_active)
            stop();
        _interval_ms = interval_ms;
        if (was_active)
            start();
    };

    inline bool is_periodic(void) const { return _is_periodic; }
    inline void set_periodic(const bool is_periodic = true) { _is_periodic = is_periodic; }

private:
    // The timer worker for the interval thread.
    struct timer_worker {
        void operator()(const int interval_ms, const bool is_periodic, boost::shared_ptr<interval_signal> signal_expired)
        {
            boost::posix_time::milliseconds duration(interval_ms);
            try {
                do {
                    boost::this_thread::sleep<boost::posix_time::milliseconds>(duration);
                    {
                        boost::this_thread::disable_interruption di;
                        signal_expired->operator()();
                    }
                } while (is_periodic);
            } catch (const boost::thread_interrupted &) {
                // IntervalThread start(), stop() and reset() throws boost::this_thread::interrupt,
                // which is expected since this thread is interrupted. No action neccessary.
            }
        };
    };

    std::atomic<int> _interval_ms;  // Interval, in ms
    std::atomic<bool> _is_active;   // Is the timed interval active?
    std::atomic<bool> _is_periodic; // Is the timer periodic?

    boost::mutex _timer_thread_guard;
    boost::thread _timer_thread;

    // The signal to call on interval expiration.
    boost::shared_ptr<interval_signal> _signal_expired;
}; 
```

# asp.net-mvc - 指定 css 类的 Html.TextBox 与表单验证 css 冲突（输入验证错误）

> ID：1015504
> 
> 赞同：0
> 
> 时间：2009-06-18T22:20:04.560
> 
> 标签：asp.net-mvc

有趣的情况。我有一个 Html.Textbox() 从视图中呈现，如下所示：

```
<%= Html.TextBox("title", Model.Title, new { @class = "txt" }) %> 
```

在我的控制器中，我对标题进行了以下稍微简化的验证。为了论证起见，假设它发现了错误，并使用模型状态错误信息重新渲染视图。

```
[AcceptVerbs(HttpVerbs.Post)]
public ActionResult EditBook(string title) {
    Model = new Book(ControllerContext.RequestContext);
    if (String.IsNullOrEmpty(title))
    {
        title = String.Empty;
        ModelState.AddModelError("title", "* Title is a required");
        modelState.SetModelValue("title", ValueProvider["title"]);
    }
    else { // show confirmation }

    if (!ModelState.IsValid)
    {
        return View("EditBook", Model);
    }
} 
```

当页面重新渲染时，我的 html 文本框正确地附加了 input-validation-error 类......但它是无用的，因为它是第一个附加的类！我需要它来覆盖我的文本框中的所有现有样式。html输出如下：

```
<input type="text" name="title" id="title" class="input-validation-error txt"/> 
```

假设已定义以下 css 样式：

```
input.txt { border: 1px; color: #000 }
.input-validation-error { border: 2px solid #fff } 
```

问题是，我原来的 css 类“txt”优先，并阻止我正确设置错误文本框的样式。

有什么想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-18T23:09:43.493

这更像是一个 CSS 问题，而不是特定于 ASP.NET MVC 的问题。您应该查看[CSS 规范](http://www.w3.org/TR/CSS21/cascade.html#cascade)的 Cascading order 部分。

考虑到这一点，您可以通过如下调整来更改样式的优先级：

```
input.txt { border: 1px; color: #000 }
input.input-validation-error { border: 2px solid #fff } 
```

将 input 元素添加到 input-validation-error 类后，两种样式的特异性将是相同的。这将导致样式的声明顺序用于确定优先级（在这种情况下，规范说最后一个声明的获胜）。

请注意，上面的示例只是您可以控制优先级的一种方式......可能有更好的方式，但我不是 CSS 专家。如果您使用 CSS 标签重新提出 CSS 问题，您可能会得到更好/更有洞察力的回复。

PS。在确定优先级时，在元素上声明类名的顺序无关紧要。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-18T23:47:30.797

如果添加 !important 修饰符，它应该有助于解决这个问题。

```
.input-validation-error { border: 2px solid #fff !important; } 
```

另外，稍微修改一下@DSO 所说的内容，我敢肯定你也可以试试这个：

```
input.txt { border: 1px; color: #000 }
input.txt.input-validation-error { border: 2px solid #fff } 
```

就像我说的，如果你有两个 CSS 类，我很确定你可以做到这一点。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-01-29T20:43:01.450

我完全没有依赖框架来呈现样式，而是采用了一种方法，我可以应用我自己的 css 类，同时仍然使用大部分 Html.ValidationMessage() 基础结构。

看起来像这样：

```
<% bool emailError = !String.IsNullOrEmpty(Html.ValidationMessage("email"));  %>
<div id="EmailMod" class="module <%= emailError ? "error" : String.Empty %>">
    <label class="text_right">Email address</label>
    <div class="input">
        <input type="text" id="Email" name="Email" class="input" tabindex="1" />
        <p id="EmailRequired" class="required <%= emailError ? "" : "hide" %>">* Please enter a valid email address.</p>
    </div>
</div> 
```

# .net - 如何从 .NET 中的 TSQL varbinary 表列流式传输字节？

> ID：1015507
> 
> 赞同：1
> 
> 时间：2009-06-18T22:20:46.977
> 
> 标签：.net, linq-to-sql, tsql, stream

在 SQL Server 2008 数据库中，我有一个包含 varbinary 类型列的表。
目前，我正在使用 LINQ to SQL 来访问数据库。
我已经知道我可以延迟列的加载。但是，我希望通过不从该值加载所有字节来消耗更少的内存。理想情况下，我希望对这些字节有一个流。
有没有办法我可以做到这一点？如果答案是肯定的，怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-18T22:24:45.707

据我所知，这是不可能使用 LINQ 的。您必须创建自己的`SqlCommand`对象并`ExecuteReader`使用`ForwardOnly`属性调用并手动输出数据。

# c++ - 用于会话管理的 C++ 库？

> ID：1015509
> 
> 赞同：4
> 
> 时间：2009-06-18T22:21:17.040
> 
> 标签：c++, session, cookies, url-rewriting

这是参考问题[如何使用 C++ 代码维护会话？](https://stackoverflow.com/questions/1005242/how-to-maintain-sessions-with-c-code)

是否有 C++ 库（如 Boost）可用于管理基于 Web 的 CGI 应用程序的会话？

在基于 Web 的 CGI 应用程序中使用 C++ 代码中的 Cookie 和 URL 重写是否可行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-09-09T07:47:52.257

只需添加另一个链接：

[http://www.webtoolkit.eu](http://www.webtoolkit.eu)

我从来没有尝试过（因为我不是在编写 webapps），但是我的一个同学使用 Wt 并且喜欢它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-24T04:03:32.103

我从来没有使用过它，但我遇到了这个：

[http://rudeserver.com/session/index.html](http://rudeserver.com/session/index.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-10-08T12:47:07.347

一种选择是使用会话变量。我不太确定它们是否可以与 C++ 一起使用，但它们是 Java 中会话管理的最佳选择之一，并且总是比 cookie 更可取，因为 cookie 是在客户端浏览器上编写的，您可能不得不妥协敏感数据的安全性。

萨钦

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-25T02:38:08.467

您也可以检查 libdodo 并取出会话部分。

[http://libdodo.org/](http://libdodo.org/)

# c# - 捕捉击键

> ID：1015513
> 
> 赞同：1
> 
> 时间：2009-06-18T22:22:42.030
> 
> 标签：c#

我需要从楔形设备中捕获按键并阻止任何控件或表单接收它们。我还需要能够知道值（char）。我尝试过覆盖 ProcessCmdKey(Keys) 和 ProcessDialogChar(char) 事件。在 ProcessCmd 事件中，如果我想要的话，我可以抑制击键，但我的字符不是事件的参数。在 ProcessDialogChar 事件中，该字符存在，但我无法阻止具有焦点的表单或控件接收密钥。建议？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-18T22:30:17.597

您需要在表单加载期间添加它：

```
Application.AddMessageFilter(this); 
```

添加这个常量：

```
private const int WM_KEYDOWN = 0x100; 
```

而这个方法：

```
public bool PreFilterMessage(ref Message m)
{
    Keys keyCode = (Keys)(int)m.WParam & Keys.KeyCode;
    bool retVal = false;

    if (m.Msg == WM_KEYDOWN)
    {
        // Handle the keypress
        retVal = true;
    }

    return retVal;
} 
```

通过返回 true，您的表单和控件将永远不会看到按键。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-02T17:50:20.767

这不是我想要的方式，但是因为我需要解决这个问题并继续前进，所以我在表单上放置了一个隐藏的文本框，一旦我看到表示我想要捕获的数据字符串可能开始的字符我将焦点设置到该文本框并响应 TextChanged 事件。如果在计时器到期之前我还没有看到结束字符，我会清除文本框并重新开始。Kludge，但它有效，让我完成了下一个任务。

# php - 更改连接的数据库

> ID：1015514
> 
> 赞同：0
> 
> 时间：2009-06-18T22:22:56.803
> 
> 标签：php, mysql, database-connection

我似乎在这方面来来回回，有时它对我有用，但通常不起作用，而且我不知道我如何/为什么有时可以让它工作，而在其他时候却不行。

我有 5 个数据库，需要在日常维护期间从每个数据库中获取数据。对于每个数据库，我都有一个外部文件，其中包含我在页面中包含的所有数据库连接代码。

包括看起来像这样

```
$SGcon = mysql_connect("localhost","root","");

如果 (!$SGcon)
  {
  die('无法连接：' . mysql_error());
  }

mysql_select_db("sGopen", $SGcon);

```

对于每个数据库，我提供不同的变量，因此下一个数据库将是

```
$PTcon = mysql_connect("localhost","root","");

如果 (!$PTcon)
  {
  die('无法连接：' . mysql_error());
  }

mysql_select_db("pTsecond", $PTcon);

```

然后当我调用我的查询时，我使用

```

mysql_query($getQuery, $PTcon);
mysql_query($secondQuery, $SGcon);

```

我遇到的问题是我没有得到用于查询的正确数据库，看来我的脚本正在使用最后添加到页面的数据库。

有没有更好的方法来切换要使用的数据库连接？

当我将一个数据库中的数据与另一个数据库中的数据进行比较时，数据库之间有很多来回，所以我也在努力提高效率。

谢谢皮特

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-18T22:24:22.010

我认为如果您在每个查询之间关闭数据库连接，您将解决问题。

如果您在数据库之间进行大量比较，那么我将只使用 1 个 select 语句一次查询所有数据库。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-18T22:31:50.340

默认情况下，如果您将与先前调用相同的参数传递给[mysql_connect](http://www.php.net/function.mysql-connect)，它将返回一个缓存连接（如果可用），而不是创建一个新连接。因此，这两个查询都针对您上次传递给的任何数据库运行`mysql_select_db`。

传递`new_link=true`将避免这种行为，尽管数据库连接可能很昂贵，因此您应该尽量保持尽可能少的打开。

new_link的详细解释：

> 如果 `mysql_connect()` 使用相同的参数进行第二次调用，则不会建立新链接，而是返回已打开链接的链接标识符。new_link 参数修改了此行为并`mysql_connect()`始终打开一个新链接，即使`mysql_connect()`之前使用相同的参数调用也是如此。在 SQL 安全模式下，此参数被忽略。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-18T22:34:15.220

除非有特定原因，否则您希望将数据库连接保持在尽可能低的水平。我会使用一个连接，并编写一个方法来扩展 mysql_query() 方法的功能。您可以将 SQL 字符串和表名传递给它，然后函数调用 mysql_select_db($tableName) 并重新使用相同的连接来处理 SQL。

# asp.net - ASP.NET：在 UpdatePanel 中重复 LinkBut tons 时“需要对象”

> ID：1015519
> 
> 赞同：0
> 
> 时间：2009-06-18T22:25:27.827
> 
> 标签：asp.net, javascript, updatepanel, repeater

我有一个 UpdatePanel，它有一个重复 LinkBut​​tons 的中继器。当我单击 LinkBut​​ton 时，页面会进行部分回发，然后我收到一个 javascript 错误：“需要对象”。我尝试调试 javascript，但无法获得调用堆栈。如果我删除 UpdatePanel，LinkBut​​tons 会进行完整的回发，然后它们会从页面中消失。我怎样才能让这个 UpdatePanel 工作？

```
<ajax:UpdatePanel ID="wrapperUpdatePanel" runat="server" UpdateMode="Always">
    <ContentTemplate>
        <asp:Repeater ID="endpointRepeater" runat="server" OnItemDataBound="EndpointDataBound">
            <HeaderTemplate>
                <div class="sideTabs">
                    <ul>
            </HeaderTemplate>
            <ItemTemplate>
                <li>
                    <asp:LinkButton ID="endpointLink" runat="server" OnClick="EndpointSelected" />
                </li>
            </ItemTemplate>
            <FooterTemplate>
                </ul>
                </div>
            </FooterTemplate>
        </asp:Repeater>
    </ContentTemplate>
</ajax:UpdatePanel> 
```

绑定代码：

```
protected void Page_Load(object sender, EventArgs e)
{
    if (!this.IsPostBack)
    {
        this.SelectedEndpoint = Factory.Get<IEndpoint>(Enums.EndPoints.Marketing);
    }
    IEndpointCollection col = EndpointCollection.GetActivelySubscribingEndpointsForPart(this.Item);

    if (this.Item.IsGdsnItem)
        col.Add(Factory.Get<IEndpoint>(Enums.EndPoints.Gdsn));

    if (col.Count > 0)
        col.Insert(0, Factory.Get<IEndpoint>(Enums.EndPoints.Marketing));

    this.endpointRepeater.DataSource = col;
    this.endpointRepeater.DataBind();

    if (this.endpointRepeater.Items.Count > 0)
    {
        LinkButton lb = this.endpointRepeater.Items[0].FindControl("endpointLink") as LinkButton;
        this.EndpointSelected(lb, new EventArgs());
    }
} 
```

谢谢，标记

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-18T22:37:57.210

这可能不是您的主要问题，但是当在需要事件的中继器中包含对象时，您不应该使用该控件的本机事件。相反，您应该使用中继器的[`OnCommand`](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.repeater.itemcommand.aspx)事件。

如果我猜的话，您的问题是由于转发器未在 PostBacks 中保持其 DataBound 状态引起的。Linkbutton 从视图中消失，因为它没有绑定到每个 PostBack 上的页面，所以当响应被发送回客户端时，它没有任何绑定。

听起来 UpdatePanel 期望从 AJAX 响应返回的标记与页面上已经返回的标记相同（或相似），因此不为转发器返回任何内容会导致问题。

尝试在其`OnInit()`方法中将您的转发器绑定到页面/控件。这应该允许在每个 PostBack 上加载转发器的 ViewState。

# java - Java：如何构建基于 Maven 的项目的独立发行版？

> ID：1015520
> 
> 赞同：8
> 
> 时间：2009-06-18T22:25:47.310
> 
> 标签：java, maven-2, build-process, build-automation

我经常遇到使用 Maven 作为构建工具的 Java 应用程序或库的发行版。

遗憾的是，其中一些不提供独立（或可再分发）的 jar。

是否可以以这样一种方式构建基于 Maven 的应用程序，即**构建结果包含所有依赖**项并且可以重新分配以开箱即用？

我尝试构建 Jackrabbit 的 OCM 模块。由于某些非常“智能”的原因，没有可下载的独立版本。**[所以我用 Maven 构建了 Jackrabbit（Jackrabbit 的源包包括 OCM），并得到了与apache 存储库](https://repository.apache.org/content/groups/public/org/apache/jackrabbit/jackrabbit-ocm/1.5.3/)**
中找到的相同的 jar 。jar**不**包含必要的依赖项，对我 来说**没用。**

 ***** * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-10T12:05:15.113

**使用 Maven 阴影插件**

...但要小心陷阱（类似于我的答案进一步描述的陷阱），这里有[一个解决方法](https://stackoverflow.com/questions/5586515/idea-to-avoid-that-spring-handlers-spring-schemas-get-overwritten-when-merging-m)。

此外，要格外小心 Shade 插件配置。我不小心用`<configuration>`了一次双标签，变形金刚根本不适用，插件也冒昧地不警告我。

**不要使用 Maven 程序集插件**

`assembly:single`将按原样解压缩您的依赖项 JAR，这可能不是您想要的。例如，诸如此类的东西`META-INF/spring.schemas`将被评估的最后一个 Spring 依赖 JAR 覆盖，因此您的 XSD 将不会被找到（当然，除了最后一个 JAR 中的那些）。这就是为什么像 Alfresco 这样的系统制作了他们的 AMP 插件，该插件将依赖项捆绑在`lib/`您正在构建的 AMP 内部。不过，后者引发了依赖管理问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-19T22:06:25.653

正如多米尼克所说，使用组装插件就可以了。您通常会在您自己的项目的 POM 中对其进行配置，以收集和打包所有必需的依赖项：

```
 ...
  <plugin>
    <artifactId>maven-assembly-plugin</artifactId>
    <configuration>
      <descriptorRefs>
        <descriptorRef>jar-with-dependencies</descriptorRef>
      </descriptorRefs>
    </configuration>
  </plugin>
  ... 
```

`jar-with-dependencies`由程序集插件预定义，并将在最终包中包含所有依赖项（请参阅 [此处](http://maven.apache.org/plugins/maven-assembly-plugin/usage.html)的文档）。

如果您不想在自己的项目中使用 Maven，则需要自己修改库的 POM 并重新打包它们（下载源代码，将上述代码段添加到 pom.xml 并运行`mvn package`）。如果您使用多个库，请注意重复或不兼容的传递依赖项。[在这种情况下可能会有所帮助（请参阅此处](http://maven.apache.org/guides/introduction/introduction-to-optional-and-excludes-dependencies.html)`exclusions`的文档）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-19T00:16:37.027

[您可能对appassembler 插件](http://mojo.codehaus.org/appassembler/appassembler-maven-plugin/)有一些运气。如果做不到这一点，请查看[组装插件](http://maven.apache.org/plugins/maven-assembly-plugin/)。这更灵活，但级别更低。如果您正在使用程序集插件，您可能会在[maven: the权威指南](http://www.sonatype.com/books/maven-book/reference/assemblies.html)中找到有关它的章节。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-07-29T06:57:27.687

正如几位发帖者所说，程序集插件是创建包含所有项目依赖项的完整 jar 文件的好方法。但是，您实际上不必修改**pom.xml**文件。只需运行：

```
mvn assembly:single -DdescriptorId=jar-with-dependencies 
```

...为了创建一个jar文件。如果你想做更高级的事情，你可能应该修改 pom.xml，并创建一个自定义程序集描述符。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-19T19:54:30.663

我相信[Maven Shade 插件](http://maven.apache.org/plugins/maven-shade-plugin/)会满足您的需求。我在构建命令行界面工具来创建 Uber JAR 时使用它，其中包括我的类以及我所有依赖项中的类。

它非常易于使用，我认为这个[例子](http://maven.apache.org/plugins/maven-shade-plugin/examples/executable-jar.html)是不言自明的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-18T22:34:33.097

更改`pom.xml`文件并使用`<Embed-Dependency>`指令。可以在[此处](http://colab.interlegis.gov.br/file/lexml/ToolKit/trunk/toolkit/pom.xml?rev=4076)找到一个类似的示例，以便您可以根据自己的情况对其进行调整。

```
<Embed-Dependency>*;scope=!test;inline=true</Embed-Dependency> 
```

我认为这应该可以解决问题。

* * *

这是上面 URL 中的示例，它似乎给出了超时。

```
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
    <modelVersion>4.0.0</modelVersion>
    <groupId>br.gov.lexml</groupId>
    <artifactId>toolkit</artifactId>
    <packaging>bundle</packaging>
    <version>3.0</version>
    <parent>
        <artifactId>lexml</artifactId>
        <groupId>br.gov.lexml</groupId>
        <version>1.0</version>
    </parent>
    <build>
        <finalName>Lexml_Toolkit-2.0</finalName>
        <plugins>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-compiler-plugin</artifactId>
                <configuration>
                    <source>1.5</source>
                    <target>1.5</target>
                </configuration>
            </plugin>
            <plugin>
                <groupId>org.apache.felix</groupId>
                <artifactId>maven-bundle-plugin</artifactId>
                <extensions>true</extensions>
                <configuration>
                    <instructions>
                        <!--_include>src/toolkit/resources/META-INF/MANIFEST.MF</_include-->

                        <Export-Package>*;-split-package:=merge-last</Export-Package>
                        <Bundle-Activator>br.gov.lexml.borda.Toolkit</Bundle-Activator>
                        <Bundle-Name>Toolkit</Bundle-Name>
                        <Private-Package />
                        <Embed-Dependency>*;scope=!test;inline=true</Embed-Dependency>
                        <Bundle-ClassPath>.,{maven-dependencies}</Bundle-ClassPath>
                    </instructions>
                </configuration>
            </plugin>
        </plugins>
    </build>
    <dependencies>
        <dependency>
            <groupId>org.apache.xmlbeans</groupId>
            <artifactId>xmlbeans</artifactId>
            <version>2.4.0</version>
        </dependency>
        <dependency>
            <groupId>org.apache.xmlbeans</groupId>
            <artifactId>xmlbeans-xmlpublic</artifactId>
            <version>2.4.0</version>
        </dependency>
        <dependency>
            <groupId>log4j</groupId>
            <artifactId>log4j</artifactId>
            <version>1.2.15</version>
        </dependency>
        <dependency>
            <groupId>br.gov.lexmlbeans</groupId>
            <artifactId>lexmlbeans</artifactId>
            <version>3.0</version>
        </dependency>
    </dependencies>
</project> 
```****

# mysql - 在大型 mysql 表中添加新列

> ID：1015521
> 
> 赞同：13
> 
> 时间：2009-06-18T22:26:02.973
> 
> 标签：mysql, performance

在大型 mysql 表中添加新列的最快方法是什么？

Alter table add column 创建一个完整表的副本，然后用新的 create table 替换旧的。当这个进程运行时，原始表是可读的，但是所有的插入和更新都停止了。

在大桌子上，复制可能需要很长时间，有什么办法可以减少它？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-18T23:14:23.797

你被困在做 ALTER TABLE 了。有效处理此问题的最佳方法是使用 MASTER-MASTER 设置。

您可以先修改 MASTER1，然后在生产中使用 MASTER2。然后你切换并做完全相反的事情。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-18T22:30:20.873

不要在活动系统上实时执行此操作。对于活动系统，请在关闭系统进行定期维护时执行此操作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-08-03T20:34:49.627

假设一个 INNODB 表：

1.  将 {Existing Table} 复制到没有数据的 {New Table}（仅模式）
2.  使用 Alter table 命令在 NEW 表上添加/更改列（应该立即工作）
3.  MYSQLDUMP 现有表（使用单事务、--no-drop-table 等）到文件
4.  将转储文件导入{New Table}（这可能需要一段时间，但在此期间旧表仍然可用）
5.  在维护期间，DROP {Old Table} 并将 {New Table} 重命名为以前的 {Old Table}。

# .net - 根据属性对对象进行分组和计数

> ID：1015526
> 
> 赞同：1
> 
> 时间：2009-06-18T22:28:50.550
> 
> 标签：.net, vb.net, visual-studio-2008

我需要迭代一组对象。基于对象的属性值，我需要将对象组合在一起。我还需要每个离散属性值的总数。我不知道会有多少组，每个组中可能有 1 到 n 个对象。

我该怎么做呢？有没有可以帮助我解决这个问题的算法？伪代码或引用都可以。

非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-18T22:34:19.993

查看[Group By Sample中的](http://msdn.microsoft.com/en-us/vcsharp/aa336754.aspx#simple1)[101 个 LINQ 示例](http://msdn.microsoft.com/en-us/vcsharp/aa336746.aspx)- 具体。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-18T23:04:07.827

这是一些可能对您有所帮助的代码。它通过属性 A 将 Target 实例分组，然后迭代分组并打印组的计数......

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace IterateCollection
{
    class Program
    {
        static void Main(string[] args)
        {
            var lst = new List<Target>() { new Target() { A=1, B=1 },
                                           new Target() { A=1, B=2 },
                                           new Target() { A=2, B=1 },
                                           new Target() { A=2, B=2 },
                                           new Target() { A=3, B=1 } };

            var grp = lst.GroupBy(t => t.A);
            var dic = grp.ToDictionary(g => g.Key);

            List<int> res = null;

            foreach (var key in dic.Keys )
            {
                res = dic[key].Select(t => t.A).ToList();

                Console.WriteLine("Number of {0} is {1}", key, res.Count);
            }

            Console.ReadLine();
        }
    }

    public class Target
    {
        public int A { get; set; }
        public int B { get; set; }
    }
} 
```

# css - 在这个网站上使用什么技术来生成字体？

> ID：1015527
> 
> 赞同：2
> 
> 时间：2009-06-18T22:29:03.310
> 
> 标签：css

有一个网站，[Web Design From Scratch](https://web.archive.org/web/20040607194512/http://webdesignfromscratch.com:80/)（存档链接，不再有以下行为），浏览器首先会渲染字体，然后很快标题文本闪烁，然后变成图像。

有谁知道这里使用的是什么技术？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-18T22:31:45.270

他们正在使用[Cufón](http://wiki.github.com/sorccu/cufon/about)：

```
<script type="text/javascript" src="/assets/cufon.js"></script>
<script src="/assets/Delicious_500.font.js" type="text/javascript"></script>
<script type="text/javascript">Cufon('h1');</script> 
```

我想，以上是将库应用于所有 h1 元素。

实现此目的的另一种流行技术是[sIFR](http://www.mikeindustries.com/blog/sifr/)，但这需要 Flash。Cufón 网站说：

> Cufón 旨在成为 sIFR 的一个有价值的替代品，尽管它有优点，但设置和使用仍然非常棘手。为了实现这一雄心勃勃的目标，制定了以下要求：
> 
> 1.  无需插件——它只能使用客户端原生支持的功能
> 2.  兼容性——它必须适用于市场上的所有主要浏览器
> 3.  易于使用——标准用例不需要或几乎为零配置
> 4.  速度——它必须很快，即使对于足够多的文本
> 
> 而现在，经过近一年的规划和研究，我们相信这些要求已经得到满足。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-18T22:31:16.503

看起来像[Cufón](http://wiki.github.com/sorccu/cufon/about)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-19T04:06:03.407

我使用了 A List Apart 中的这篇文章中描述的“动态文本替换”：[http ://www.alistapart.com/articles/dynatext/](http://www.alistapart.com/articles/dynatext/)

您提到的网站使用 Cufón。

# idisposable - 拥有托管一次性资源的 IDisposable 基类，在子类中做什么？

> ID：1015529
> 
> 赞同：0
> 
> 时间：2009-06-18T22:30:01.653
> 
> 标签：idisposable, performancecounter

我有一个拥有托管一次性资源（.NET PerformanceCounter）的基类。我了解在类上实现 IDisposable 以便我可以在资源上显式调用 Dispose。从我看到的示例中，人们通常使用私有布尔成员变量“disposed”并将其在 Dispose 内部设置为 true。稍后，如果尝试访问公共方法或属性，如果“disposed”为真，则会引发 ObjectDisposedException。

在子类中呢？子类如何在其公共方法和属性中知道它们已被释放？起初我认为子类不需要任何特殊的东西（比如实现他们自己的 Dispose 版本），因为需要处理的东西只在基类中（假设子类不会添加任何数据需要显式处理）并且基类的 Dispose 应该处理它。子类是否应该仅仅为了设置自己的“已处理”成员变量而重写基类的虚拟 Dispose 方法？

这是所讨论的类层次结构的一个非常精简的版本。

```
class BaseCounter : IBaseCounter, IDisposable
{
  protected System.Diagnostics.PerformanceCounter pc;
  private bool disposed;
  public BaseCounter(string name)
  {
    disposed = false;
    pc = CreatePerformanceCounter(name);
  }

  #region IBaseCounter
  public string Name
  {
    get 
    {
      if (disposed) throw new ObjectDisposedException("object has been disposed");
      return pc.CounterName;
    }
  }
  public string InstanceName
  {
    get
    {
      if (disposed) throw new ObjectDisposedException("object has been disposed");
      return pc.InstanceName;
    }
  }
  #endregion IBaseCounter

  #region IDisposable
  protected virtual void Dispose(bool disposing)
  {
    if (!disposed)
    {
      if (disposing)
      {
        if (pc != null)
        {
          pc.Dispose();
        }
        pc = null;
        disposed = true;
      }
    }
  }

  public void Dispose()
  {
    Dispose(true);
  }
  #endregion IDisposable
}

class ReadableCounter : BaseCounter, IReadableCounter //my own interface
{
  public ReadableCounter(string name)
    : base(name)
  {
  }

  #region IReadableCounter 
  public Int64 CounterValue()
  {
    return pc.RawValue;
  }
  #endregion IReadableCounter
}

class WritableCounter : BaseCounter, IWritableCounter
{
  public WritableCounter(string name)
    : base(name)
  {
  }

  #region IWritableCounter 
  public Increment()
  {
    pc.Increment();
  }
  #endregion IWritableCounter
} 
```

在我们的系统中，ReadableCounter 和 WritableCounter 是 BaseCounter 的唯一子类，它们只是通过代码生成过程再被子类化到一个级别。附加的子类级别只添加了一个特定的名称，以便可以创建直接对应于命名计数器的对象（例如，如果有一个计数器用于计算生成的小部件的数量，它最终被封装在一个 WidgetCounter 类中. WidgetCounter 包含允许创建“WidgetCounter”性能计数器的知识（实际上，只是作为字符串的计数器名称）。

只有代码生成的类被开发人员直接使用，所以我们会有这样的东西：

```
class WritableWidgetCounter : WritableCounter
{
  public WritableWidgetCounter
    : base ("WidgetCounter")
  {
  }
}

class ReadableWidgetCounter : ReadableCounter
{
   public ReadableWidgetCounter
     : base ("WidgetCounter")
   {
   }
} 
```

因此，您会看到基类拥有并管理 PerformanceCounter 对象（它是一次性的），而子类使用 PerformanceCounter。

如果我有这样的代码：

```
IWritableCounter wc = new WritableWidgetCounter();
wc.Increment();
wc.Dispose();
wc.Increment();
wc = null; 
```

WritableCounter 如何以增量方式知道它已被处置？ReadableCoutner 和 WritableCounter 是否应该简单地覆盖 BaseCounter 的

```
protected virtual void Dispose(bool disposing) 
```

像这样的东西：

```
protected virtual void Dispose(bool disposing)
{
  disposed = true; //Nothing to dispose, simply remember being disposed
  base.Dispose(disposing); //delegate to base
} 
```

只是设置一个 ReadableCounter/WritableCounter 级别的“disposed”成员变量？

如果基类（BaseCounter）声明为受保护（或使其成为受保护的属性）呢？这样，子类可以引用它，而不是仅仅为了记住 Dispose 已经发生而添加 Dispose 方法。

我错过了这艘船吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-19T19:29:27.173

我见过一些具有公共 IsDisposed 属性的一次性类。你可以这样做并在你的子类中检查它。

我做的另一件事是一个通用的受保护的“验证”方法，所有子类方法都调用（并且可以覆盖）。如果它返回，一切都很好，否则它可能会抛出。这将使您的子类与一次性内脏完全隔离。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T21:42:45.967

我在基类和子类中都有用于实现 IDisposable 的片段。你可能想要一个子类。

我想我从 MSDN 刷了大部分代码。

这是基类 IDisposable 的代码（不是您想要的）：

```
#region IDisposable Members
// Track whether Dispose has been called.
private bool _disposed = false;

// Implement IDisposable.
// Do not make this method virtual.
// A derived class should not be able to override this method.
public void Dispose()
{
    Dispose(true);
    // Take yourself off the Finalization queue 
    // to prevent finalization code for this object
    // from executing a second time.
    GC.SuppressFinalize(this);
}

// Dispose(bool disposing) executes in two distinct scenarios.
// If disposing equals true, the method has been called directly
// or indirectly by a user's code. Managed and unmanaged resources
// can be disposed.
// If disposing equals false, the method has been called by the 
// runtime from inside the finalizer and you should not reference 
// other objects. Only unmanaged resources can be disposed.
protected virtual void Dispose(bool disposing)
{
    // Check to see if Dispose has already been called.
    if (!this._disposed)
    {
        // If disposing equals true, dispose all managed 
        // and unmanaged resources.
        if (disposing)
        {
            // TODO: Dispose managed resources.

        }
        // Release unmanaged resources. If disposing is false, 
        // only the following code is executed.
        // TODO: Release unmanaged resources

        // Note that this is not thread safe.
        // Another thread could start disposing the object
        // after the managed resources are disposed,
        // but before the disposed flag is set to true.
        // If thread safety is necessary, it must be
        // implemented by the client.
    }
    _disposed = true;
}

// Use C# destructor syntax for finalization code.
// This destructor will run only if the Dispose method 
// does not get called.
// It gives your base class the opportunity to finalize.
// Do not provide destructors in types derived from this class.
~Program()
{
    // Do not re-create Dispose clean-up code here.
    // Calling Dispose(false) is optimal in terms of
    // readability and maintainability.
    Dispose(false);
}
#endregion 
```

这是我在子类中使用的代码（这是您想要的代码）：

```
#region IDisposable Members
// Track whether Dispose has been called.
private bool _disposed = false;

// Design pattern for a derived class.
// Note that this derived class inherently implements the 
// IDisposable interface because it is implemented in the base class.
// This derived class does not have a Finalize method
// or a Dispose method without parameters because it inherits 
// them from the base class.
protected override void Dispose(bool disposing)
{
    if (!this.disposed)
    {
        try
        {
            if (disposing)
            {
                // Release the managed resources you added in
                // this derived class here.
                // TODO: Dispose managed resources.
            }
            // Release the native unmanaged resources you added
            // in this derived class here.
            // TODO: Release unmanaged resources.
            _disposed = true;
        }
        finally
        {
            // Call Dispose on your base class.
            base.Dispose(disposing);
        }
    }
}
#endregion 
```

寻找`TODO:`标记。

# c - 简单的 C 问题

> ID：1015533
> 
> 赞同：3
> 
> 时间：2009-06-18T22:31:04.070
> 
> 标签：c

作为我正在做的项目的一部分，我不得不开始学习 C。我已经开始在其中解决“欧拉”问题，并且在[第一个](http://projecteuler.net/index.php?section=problems&id=1)问题上遇到了麻烦。我必须找到 1000 以下所有 3 或 5 的倍数之和。有人可以帮我吗。谢谢。

```
#include<stdio.h>
int start;
int sum;

int main() {
    while (start < 1001) {
        if (start % 3 == 0) {
            sum = sum + start;
            start += 1;
        } else {
            start += 1;
        }

        if (start % 5 == 0) {
            sum = sum + start;
            start += 1;
        } else {
            start += 1;
        }
        printf("%d\n", sum);
    }
    return(0);
} 
```

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2009-06-19T03:02:39.203

到目前为止，您已经得到了一些很好的答案，主要是建议如下：

```
#include <stdio.h>
int main(int argc, char * argv[])
{
  int i;
  int soln = 0;
  for (i = 1; i < 1000; i++)
  {
    if ((i % 3 == 0) || (i % 5 == 0))
    {
      soln += i;
    }
  }
  printf("%d\n", soln);
  return 0;
} 
```

所以我要采取不同的策略。我知道你这样做是为了学习 C，所以这可能有点切题。

真的，你让计算机为此工作太辛苦了:)。如果我们提前弄清楚一些事情，它可以使任务更容易。

那么，有多少个 3 的倍数小于 1000？每当 3 进入 1000 - 1 时，就有一个。

> 乘[3] = ⌊ (1000 - 1) / 3 ⌋ = 333

（⌊ 和 ⌋ 表示这是*地板*除法，或者，在编程术语中，*整数*除法，其中余数被删除）。

小于 1000 的 5 的倍数有多少？

> 乘数[5] = ⌊ (1000 - 1) / 5 ⌋ = 199

现在所有小于 1000 的 3 的倍数之和是多少？

> 总和[3] = 3 + 6 + 9 + ... + 996 + 999 = 3×(1 + 2 + 3 + ... + 332 + 333) = 3×∑<sub>i=1 到 mult [3] i

以及小于 1000 的 5 的所有倍数之和？

> 总和[5] = 5 + 10 + 15 + ... + 990 + 995 = 5×(1 + 2 + 3 + ... + 198 + 199) = 5×∑<sub>i = 1 乘以[5] i

一些 3 的倍数也是 5 的倍数。这些是 15 的倍数。由于这些数计入 mult [3]和 mult [5]（因此 sum [3]和 sum [5]），我们需要知道 mult [15]和 sum [15]以避免将它们计算两次。

> 乘[15] = ⌊ (1000 - 1) /15 ⌋ = 66
> 
> 总和[15] = 15 + 30 + 45 + ... + 975 + 990 = 15×(1 + 2 + 3 + ... + 65 + 66) = 15×∑<sub>i = 1 到 mult [15] i

那么问题的解决方案“[找到1000以下的所有3或5的倍数之和](http://projecteuler.net/index.php?section=problems&id=1)”就是

> 溶液 = 总和[3] + 总和[5] - 总和[15]

因此，如果我们愿意，我们可以直接实现：

```
#include <stdio.h>
int main(int argc, char * argv[])
{
  int i;
  int const mult3 = (1000 - 1) / 3;
  int const mult5 = (1000 - 1) / 5;
  int const mult15 = (1000 - 1) / 15;
  int sum3 = 0;
  int sum5 = 0;
  int sum15 = 0;
  int soln;

  for (i = 1; i <= mult3; i++) { sum3 += 3*i; }
  for (i = 1; i <= mult5; i++) { sum5 += 5*i; }
  for (i = 1; i <= mult15; i++) { sum15 += 15*i; }

  soln = sum3 + sum5 - sum15;
  printf("%d\n", soln);
  return 0;
} 
```

但我们可以做得更好。为了计算单个和，我们有[高斯恒等式](http://mathforum.org/library/drmath/view/57919.html)，它表示从 1 到 n（又名 ∑<sub>i = 1 到 ni）的总和是 n×(n+1)/2，所以：

> 总和[3] = 3×mult [3] ×(mult [3] +1) / 2
> 
> 总和[5] = 5×mult [5] ×(mult [5] +1) / 2
> 
> 总和[15] = 15×mult [15] ×(mult [15] +1) / 2

（请注意，我们可以在这里使用普通除法或整数除法 - 没关系，因为 n 或 n+1 之一必须能被 2 整除）

现在这很简洁，因为这意味着我们可以在不使用循环的情况下找到解决方案：

```
#include <stdio.h>
int main(int argc, char *argv[])
{
  int const mult3 = (1000 - 1) / 3;
  int const mult5 = (1000 - 1) / 5;
  int const mult15 = (1000 - 1) / 15;
  int const sum3 = (3 * mult3 * (mult3 + 1)) / 2;
  int const sum5 = (5 * mult5 * (mult5 + 1)) / 2;
  int const sum15 = (15 * mult15 * (mult15 + 1)) / 2;

  int const soln = sum3 + sum5 - sum15;
  printf("%d\n", soln);
  return 0;
} 
```

当然，既然我们已经走了这么远，我们可以手动完成整个事情：

> 总和[3] = 3×333×(333+1) / 2 = 999×334 / 2 = 999×117 = 117000 - 117 = 116883
> 
> 总和[5] = 5×199×(199+1) / 2 = 995×200 / 2 = 995×100 = 99500
> 
> 总和[15] = 15×66×(66+1) / 2 = 990×67 / 2 = 495 × 67 = 33165
> 
> 解决方案 = 116883 + 99500 - 33165 = 233168

并编写一个更简单的程序：

```
#include <stdio.h>
int main(int argc, char *argv[])
{
  printf("233168\n");
  return 0;
} 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-06-18T22:35:05.107

你可以改变你的ifs：

```
 if  ((start % 3 == 0) || (start % 5 == 0)) 
     sum += start;
 start ++; 
```

并且不要忘记将总和初始化为零并从一开始。此外，将 while 条件更改为 < 1000。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-06-18T22:35:02.160

for 循环并结合您的条件会更好地为您服务。

未测试：

```
int main()
{
  int x;
  int sum = 0;

  for (x = 1; x <= 1000; x++)
    if (x % 3 == 0 || x % 5 == 0)
      sum += x;

  printf("%d\n", sum);
  return 0;
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-18T22:51:10.753

嗯，好吧，我可以大致看到你要去的地方，我认为它唯一的问题是前面提到的。我之前在那里做过这个问题，显然你需要遍历 3 和 5 的每个倍数并将它们相加。我这样做了，它确实有效：

```
int accumulator = 0;
int i;

for (i = 0; i < 1000; i += 3)
    accumulator += i;

for (i = 0; i < 1000; i +=5) {
    if (!(i%3==0)) {
        accumulator += i;
    }
}
printf("%d", accumulator); 
```

编辑：还要注意它不是 0 到 1000 （含），< 1000 停止在 999，因为它是低于 1000 的最后一个数字，你已经通过 < 1001 反驳了这一点，这意味着你一直到 1000，这是 5 的倍数，意味着你的答案将比应有的高1000。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-06-19T11:24:30.810

答案都很好，但不会帮助您学习 C。

你真正需要了解的是如何发现自己的错误。调试器可以帮助您，C 语言中最强大的调试器称为“printf”。你想知道你的程序在做什么，而且你的程序不是一个“黑匣子”。

您的程序已经打印了总和，这可能是错误的，您想知道原因。例如：

```
printf("sum:%d start:%d\n", sum, start); 
```

代替

```
printf("%d\n", sum); 
```

并将其保存到文本文件中，然后尝试了解发生了什么问题。

*   计数是否以 1 开头并以 999 结尾？
*   它真的从 1 到 999 没有跳过数字吗？
*   它适用于较小的范围吗？

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-06-18T22:34:20.320

你还没有说程序应该做什么，或者你的问题是什么。这使得提供帮助变得困难。

猜测一下，您确实应该将 start 和 sum 初始化为零，也许 printf 应该在循环之外。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-06-19T01:57:46.837

确实，您需要一个调试器，并单步执行代码，以便您可以看到它实际在做什么。您的基本问题是控制流没有按照您的想法进行，而不是像其他人那样提供正确的代码，我将尝试解释您的代码的作用。这是一步一步发生的事情（我已经对这些行进行了编号）：

```
1:    while (start < 1001) {
2:        if  (start % 3 == 0) {
3:            sum = sum + start;
4:            start += 1;
5:        }
6:        else {
7:            start += 1;
8:        }
9:
10:       if (start % 5 == 0) {
11:           sum = sum + start;
12:           start += 1;
13:       }
14:       else {
15:           start += 1;
16:       }
17:       printf("%d\n", sum);
18:    } 
```

*   第 1 行。sum 为 0，start 为 0。循环条件为真。
*   第 2 行。 sum 为 0，start 为 0。如果条件为真。
*   第 3 行。总和为 0，开始为 0。总和 <- 0。
*   第 4 行。总和为 0，开始为 0。开始 <- 1。
*   第 5 行，sum 为 0，start 为 1。跳过“else”子句
*   第 10 行，sum 为 0，start 为 1。如果条件为 false，则跳转到“else”子句。
*   第 15 行。总和为 0，开始为 1。开始 <- 2。
*   第 16 行（跳过）
*   第 17 行，sum 为 0，start 为 2。打印“0\n”。
*   第 18 行，sum 为 0，start 为 2。跳转到循环的顶部。
*   第 1 行，sum 为 0，start 为 2。循环条件为真。
*   第 2 行，sum 为 0，start 为 2。如果条件为 false，则跳转到“else”子句。
*   第 7 行。总和为 0，开始为 2。开始 <- 3。
*   第 10 行，sum 为 0，start 为 3。如果条件为 false，则跳转到“else”子句。
*   第 15 行。总和为 0，开始为 3。开始 <- 4。
*   第 17 行，sum 为 0，start 为 4。打印“0\n”。

你看这是怎么回事？您似乎认为在第 4 行，在做之后`sum += 1`，控制回到循环的顶部。它没有，它在“if/else”构造之后进入下一件事。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-07-30T18:00:12.280

您忘记初始化变量，

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-06-19T11:10:15.737

您的代码的问题在于您将“开始”变量增加了两次。这是由于有两个 if..else 语句。您需要的是 if..else if..else 语句，如下所示：

```
 if  (start % 3 == 0) {
                    sum = sum + start;
                    start += 1;
            }
            else if (start % 5 == 0) {
                    sum = sum + start;
                    start += 1;
            }
            else {
                    start += 1;
            } 
```

或者你可以更简洁，写成如下：

```
if(start % 3 == 0)
    sum += start;
else if(start % 5 == 0)
    sum += start;
start++; 
```

这两种方法中的任何一种都应该适合你。

祝你好运！

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-06-19T16:26:43.007

这是一个适用于任意数量因素的通用解决方案：

```
#include <stdio.h>

#define sum_multiples(BOUND, ...) \
    _sum_multiples(BOUND, (unsigned []){ __VA_ARGS__, 0 })

static inline unsigned sum_single(unsigned bound, unsigned base)
{
    unsigned n = bound / base;
    return base * (n * (n + 1)) / 2;
}

unsigned _sum_multiples(unsigned bound, unsigned bases[])
{
    unsigned sum = 0;

    for(unsigned i = 0; bases[i]; ++i)
    {
        sum += sum_single(bound, bases[i]);

        for(unsigned j = i + 1; bases[j]; ++j)
            sum -= sum_single(bound, bases[i] * bases[j]);
    }

    return sum;
}

int main(void)
{
    printf("%u\n", sum_multiples(999, 3, 5));
    return 0;
} 
```

# delphi - 如何让管理员设置用户无法更改的程序选项？

> ID：1015542
> 
> 赞同：3
> 
> 时间：2009-06-18T22:33:51.350
> 
> 标签：delphi, registry, settings

我的应用程序需要在启动时读取一个选项以检查它是否应该以只读模式启动。不应允许用户更改该选项。

我现在通常使用系统注册表的 HKLM\Software 部分中设置的值来执行此操作。管理员设置该值，用户不能更改它（他们无权修改 HKLM 中的条目）。

问题是在终端服务器（或 Citrix）机器上，这会影响所有用户。我想找出一种方法来针对每个用户执行此操作。其他人如何处理这个问题？系统注册表中是否有用户无法更改的这种按用户设置的部分？

感谢您的任何建议或意见！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-19T06:08:07.400

这本质上就是`HKEY_CURRENT_USER\Software\Policies`密钥的用途，即注册表的用户特定部分中的密钥，默认情况下对用户本人是只读的。

按照惯例，密钥层次结构应该补充您已经拥有的层次结构`HKEY_CURRENT_USER\Software`，例如，如果您的常规用户首选项存储在下，`HKEY_CURRENT_USER\Software\MyCompany\MyProgram`则受保护的用户首选项（或 MS 术语中的“策略”）应存储在`HKEY_CURRENT_USER\Software\Policies\MyCompany\MyProgram`

请注意，建议仅通过组策略对象在此键下设置值，而不是通过直接注册表访问。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-19T00:00:48.540

用户无法更改的每个用户设置区域的概念实际上没有意义 - 如果它们是用户设置，“你”（用户）希望能够更改它们。

我可以想到两种选择：

*   在 HKLM 中编写您的设置，但为每个用户设置不同的设置，并为未设置设置的用户设置全局后备设置
*   将它们写入 HKCU，但使用注册表安全 API 来阻止它们写入。您可能需要比他们更大的权限，以防止他们撤消权限更改。我不太喜欢这个选项，但如果你想遵循它，你可能想从 [RegGetKeySecurity](http://msdn.microsoft.com/en-us/library/aa379313(VS.85).aspx)和 [RegSetKeySecurity](http://msdn.microsoft.com/en-us/library/aa379314(VS.85).aspx) API 开始。 [这篇文章](http://msdn.microsoft.com/en-us/magazine/cc982153.aspx)可能也很有趣。

就我个人而言，我认为第一个选项是最简单的，并且在用户的注册表树中也会涉及更少的狡猾的东西。希望有帮助！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-19T03:19:57.263

两个设置怎么样？

1) 在 HKLM 中设置一个标志，指定只读是这台机器上的默认行为。

2) 对于任何需要完全访问权限的用户，在 HKCU 中设置一个启用完全访问权限的令牌。

令牌可能是一些盐加上用户名的加密哈希，因此无法复制它以授予其他用户权限。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-19T06:14:52.350

为什么不将选项存储在自己的数据库中？这似乎很合理和方便（至少对我来说是 8））制作产品的“便携式”版本没有问题。没有用户打扰您不希望他们打扰的任何设置。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-18T22:57:02.223

HKCU而不是HKLM有什么问题？这将是每个用户。不幸的是，如果用户知道如何编辑注册表并找到密钥，则用户可能会更改它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-19T06:52:32.603

*   获取程序附带的文件之一，不应更改（至少不受限制的用户）。如果没有这样的文件，请为此目的创建一个。
*   让管理员为那些受限用户设置对该文件的只读权限。
*   在程序中检查您是否具有对该文件的写入权限。

# java - 如何生成谷歌搜索结果的时间线图片

> ID：1015543
> 
> 赞同：0
> 
> 时间：2009-06-18T22:33:53.893
> 
> 标签：java

您能否告诉我是否有任何开源库可以在 Google 搜索结果中生成“时间线图像”？（请参见下面的示例）：

[http://www.google.com/search?q=history&hl=en&sa=X&tbo=1&tbs=tl:1,tll:1400,tlh:1599&ei=oL46SsOrIIy0sgPQrrCDCw&oi=timeline_histogram_nav&ct=timeline-histogram&cd=9](http://www.google.com/search?q=history&hl=en&sa=X&tbo=1&tbs=tl:1,tll:1400,tlh:1599&ei=oL46SsOrIIy0sgPQrrCDCw&oi=timeline_histogram_nav&ct=timeline-histogram&cd=9)

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-18T22:44:38.740

该图像由 [Google Chart Server](http://code.google.com/apis/chart/)生成。您可以在 Web 应用程序中使用它。我不知道开源等效项。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-12-10T08:37:56.327

这些图表类似于基于[Edward Tufte](http://www.edwardtufte.com/bboard/q-and-a-fetch-msg?msg_id=0001OR)想法的迷你图。

有很多开源库可以生成这些，包括 JQuery。您可以通过在 Google 上搜索“sparkline [语言]”来找到更多实施链接。

# asp.net - h264 提供程序启动

> ID：1015544
> 
> 赞同：0
> 
> 时间：2009-06-18T22:34:11.240
> 
> 标签：asp.net, video-processing, h.264

我正在尝试制作可以对视频进行编码的 ffmpeg 或 x264 提供程序。好吧，我一直在研究一些工具等。我不知道..我需要制作自己的api。我为 flv1 做了相同的 4 ffmpeg，但 h264 似乎有很大不同..

谁能给我一些基础知识，从哪里以及如何开始？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-25T14:22:27.620

啊..因为我没有任何答案，我确实解决了这个..这就是我所做的..在浪费了很多时间之后，下载了很多文件，阅读了不清楚的文档等等......

这里最好和最重要的是 avisynth 工具，它可以在 directshow 下加载任何类型的视频 - 做很多事情（使用它自己的脚本语言），然后将该脚本发送到 x264.exe 编码器，它将创建视频，你需要包含 mp3（也使用 avisynth 插件提取）并使用 mp4box.exe 将其包装到 mp4 文件中。

所有这些工作都是通过从 .net 运行返回输出的进程来完成的。

我的工具列表是：avisynth - 最好的视频制作 ffmpeg - 输出图像，但如果你喜欢 x264，你可以将它用于其他事情 - 从 avs（avisynth 脚本）mp3box 中获取 x264 视频 - 组合 264 文件将 mp3 放入 h264 soundout - avi 合成器插件，用于从 avisynth 视频中提取 mp3 声音 yadif - avi 合成器插件来做一些 tihngs

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-28T10:43:24.267

我的选择是使用 Mencoder。

尝试找到对 x264 具有预编译支持的二进制版本（或编译您自己的！），以便将其用于 H.264 编码。为了查看您的 Mencoder 二进制文件支持哪些内容，请尝试使用命令

```
mencoder -ovc help 
```

如果您在该列表中的某个位置获得 x264，那么您就可以开始了。

之后，您可以使用 Mencoder 将任何类型的视频转码为 H.264。请在此处查看 mencoder 手册以开始使用：

[http://www.mplayerhq.hu/DOCS/HTML/en/menc-feat-x264.html](http://www.mplayerhq.hu/DOCS/HTML/en/menc-feat-x264.html)

# java - JPA 的 Hibernate 查询提示

> ID：1015552
> 
> 赞同：20
> 
> 时间：2009-06-18T22:36:02.250
> 
> 标签：java, hibernate, jpa, jakarta-ee

我一直在尝试为可以通过`Query.setHint(String,Object)`JPA 中的方法调用设置的所有提示找到一个明确的资源，但我的结果是空的。有谁知道一个好的参考？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-06-19T10:47:36.983

请参阅[“3.4.1.7\. 查询提示”](http://docs.jboss.org/hibernate/stable/entitymanager/reference/en/html/objectstate.html#d0e1215)。

# asp.net - 如何在 VisualStudios 之外的服务器上运行 ASP.NET 代码

> ID：1015553
> 
> 赞同：0
> 
> 时间：2009-06-18T22:36:08.757
> 
> 标签：asp.net

我能够运行 Default.aspx 但我认为我做错了。我将我的 ASPX 文件和 Global.asax 上传到 httpdocs 我做了一个简单的测试，看看是否有任何 URL 重写并且没有（除了 Default.aspx，每个页面都需要）。我不确定如何正确上传和运行它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-18T22:41:16.327

请参阅[设置您的 ASP.NET 服务器 (IIS)](http://www.geekpedia.com/tutorial25_Setting-up-your-ASP.NET-server-(IIS).html) - 本教程将帮助您在 IIS6 下设置 ASP.NET。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-18T22:38:58.313

您将需要 IIS。

[http://www.iis.net/](http://www.iis.net/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-18T22:39:17.643

在解决方案资源管理器中右键单击您的站点，然后选择“发布网站”。

# apache-flex - Flex：侦听来自尚未绑定的属性的事件

> ID：1015557
> 
> 赞同：0
> 
> 时间：2009-06-18T22:37:50.547
> 
> 标签：apache-flex, actionscript-3

我有这样的课：

```
class Foo extends UIComponent {
    var someDispatcher:*;
    ...
} 
```

而且我想监听由`someDispatcher`...触发的事件但是，当然，`someDispatcher`可能直到“稍后”才被绑定：

```
<components:Foo someDispatcher="{someOtherComponent}" /> 
```

监听事件的最佳方式是`from someDispatcher`什么？

我知道我*可以*绑定到`someDispatcher`，然后在更新时连接事件处理程序……或者我可以使用 getter/setter ……但是这些看起来都非常复杂。我希望有更好的方法。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-18T22:42:37.697

我认为让 someDispatcher 本身可绑定是最简单/最直接的解决方案。您可以在 PropertyChanged 事件的处理程序中为 someDispatcher 设置事件处理程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-18T23:08:29.940

看起来[ChangeWatcher](http://livedocs.adobe.com/flex/3/langref/mx/binding/utils/ChangeWatcher.html)类在这里会有所帮助......

# xml - MSXML2.DomDocument.3.0 无效字符

> ID：1015565
> 
> 赞同：0
> 
> 时间：2009-06-18T22:39:34.087
> 
> 标签：xml, parsing, lotusscript

将 XML 解析为来自 Web 服务的答案时，我收到以下错误。

*   在文本内容中发现无效字符。

Web 服务发送带有某些字符的答案，例如 Ψ 或带有 " 或 < 和 > 字符的 HTML 结构化测试。

使用的代码是：

```
Set var_xmlPostObject = CreateObject("MSXML2.ServerXMLHTTP.3.0")
Set var_xmlRequestDoc = CreateObject("MSXML2.DOMDocument")
Set var_xmlResponseDoc = CreateObject("MSXML2.DomDocument.3.0")
'Send xml
Call var_xmlRequestDoc.loadXML(str_xml)
Dim var_pi As Variant
Set var_pi = var_xmlRequestDoc.CreateProcessingInstruction("xml", "version='1.0' encoding='ISO-8859-1'")
Call var_xmlRequestDoc.InsertBefore(var_pi, var_xmlRequestDoc.ChildNodes(0)) 'open the POST (or GET) connection to the web server
Call var_xmlPostObject.open("POST", str_soapPost, False)
Call var_xmlPostObject.setRequestHeader("Content-Type", str_soapType)
Call var_xmlPostObject.send(var_xmlRequestDoc.xml)
'Set response properties
var_xmlResponseDoc.async = False
var_xmlResponseDoc.validateOnParse = False
var_xmlResponseDoc.resolveExternals = False
Set var_xmlResponseDoc = var_xmlPostObject.responseXML
Print "var_xmlResponseDoc.xml: " & var_xmlResponseDoc.xml
If var_xmlResponseDoc.parseError.errorCode <> 0 Then
    'Alert
Else
    'Do something
End if 
```

问题是是否有一种方法可以在解析之前检测到带来消息的字符？一些例子会非常好。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-30T13:37:34.217

您可能想采用不同的方法。Notes 8 允许您在本地使用 Web 服务并只处理一些 LotusScript（或 Java 类）。核心代码将负责编码等，因此您无需处理它。如果出于政治原因您卡在过时版本的 Lotus Notes 上，您可以使用 [Stubby][1]（Web 服务杀手）来生成代码。比 OLE 连接可靠得多。

[1]：[http:](http://www.nsftools.com/stubby/) //www.nsftools.com/stubby/ Stubby

# oop - 软件设计问题：路由器类

> ID：1015568
> 
> 赞同：1
> 
> 时间：2009-06-18T22:40:25.643
> 
> 标签：oop

在子系统设计中，我有时会看到软件设计有一个只有一个特性的高级类：它将使用该类的客户端的调用路由到客户端想要使用的另一个特定类。但是，它本身没有任何功能。采取这种情况：

假设保龄球馆子系统中有五个类：一个球道、一个球道、一个保龄球、控制台和一个得分。每当子系统外部的客户端想要向用户显示任何数据时，它只会与控制台（路由器）通信，控制台会调用它所拥有的任何类来获取客户端请求的数据（例如分数：客户端调用控制台带有 getScore()，它调用 Lane 的 getScore()，它调用 Bowler 的 getScore())。

我知道这是一个糟糕的设计决定，但我想听听现实世界的示例，这些示例说明您发现拥有此路由器类（也可以称为“中间人”）的后果。随着您正在开发的系统不断发展，您遇到了哪些问题？你会提出什么论据来说服软件设计者避免使用路由器类？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-18T22:51:39.957

我认为在某些设计中，路由器是首选的设计模式，例如在 MVC 框架中为 URL 委派处理程序。在这种情况下，它真的很有帮助，因为它在客户“看到”的内容和背后的实际逻辑之间提供了非常清晰的分离。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-18T22:49:59.837

> 每当子系统外部的客户端想要向用户显示任何数据时，它只会与控制台（路由器）通信，控制台会调用它拥有的任何类来获取客户端请求的数据

这听起来像[Facade 模式](http://en.wikipedia.org/wiki/Facade_pattern)

至于中间人，在下面的例子中，车道不会是罪魁祸首吗？

> 一个分数的例子：客户用getScore()调用控制台，它调用一个Lane的getScore()，它调用一个Bowler的getScore())

为了子系统之外的客户的利益而简化子系统的接口可以被认为是好的设计。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-07-01T00:48:50.513

Facade 模式和[Mediator](http://www.dofactory.com/Patterns/PatternMediator.aspx)模式执行与您所描述的任务类似的任务。您对中间人绰号的使用意味着中介者模式优于外观模式，因为中间人负责在两个实体之间进行协商，而两个实体都不需要知道如何与另一个实体进行通信的细节。

您可以使用其中任何一种模式来减少客户端类的耦合，这需要使用 Mediator 或 Facade 正在屏蔽的系统。在 Facade 模式的情况下，其目的是提供一种方便的方式来连接类系统。对于中介者模式，目的是从客户端抽象出执行复杂任务所需的步骤。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-18T22:46:55.443

我不知道路由方法调用*总是*这么糟糕的主意。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-18T23:04:02.490

似乎您只会遇到与任何其他抽象层相关的问题 - 抽象可能会中断，或者如果对底层的某些内容进行了更改，这可能是另一件事可能会出现错误。

我从来没有见过任何调用超过几层的东西，但我只是想象添加额外的调用会使跟踪路径信息变得更加困难，并使故障排除更加困难。

然而，一个潜在的问题是，如果每一层都实现了自己的错误处理或重试过程，那么在每一层上微不足道的东西就会成为一个整体。例如，如果 Lane 两次尝试检查投球手的得分，而桌子尝试 3 次检查得分，则投球手未能返回得分将导致 6 次查询。在投球手上添加一个 30 秒的暂停时间，您会突然等待 3 分钟，等待 30 秒。

OldNewThing 有一篇文章介绍了 Windows 操作系统中的一个示例，以及它引起的问题，但现在我似乎找不到它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-18T23:05:55.327

我认为 ASP.NET MVC 和 MVP 模式都利用了这种类型的概念，您最终得到的只是处理从一端到另一端或代表较低层到较高层执行的逻辑。这无疑使测试更容易执行，因此这本身就是一个主要的好处。这种类型的模式确实会创建一些手动或繁琐的工作，因为您可以单击一个按钮并让它执行一项任务而不是单击该按钮，让某些东西拦截该单击，然后调用一些执行某些工作的服务管理类。但是在保持你的代码干净和可读的方面，通常越多的分离越好。

如果您不是测试人员或者不太关心模式，那么请以另一种格式考虑它。您有一个将用户带到页面的链接。此链接分散在您的网站各处，因为目的地非常重要或经常使用。目的地变了。这可能是查找和替换操作...或者您可以插入一个 RedirectService （随意调用它），当有人单击链接时会进行更改并将点击器定向到正确的位置。这允许在一个位置定义一次位置，因此更改一次。查找和替换经常会改变原本不应该改变的东西！

不管你怎么看……关注点分离是个好主意。UI 是一个问题。活动的控制者是另一个问题。活动本身是另一个问题！

# php - 您如何处理有关 PEAR 的错误？

> ID：1015569
> 
> 赞同：0
> 
> 时间：2009-06-18T22:40:34.380
> 
> 标签：php, pear

当我使用 PEAR 时，它总是会产生很多错误。你如何看待他们？

1.  使用 PEAR，并忽略错误。什么是错误的东西？我看不见他们。
2.  使用 PEAR，但调整错误级别，使其不会产生错误。
3.  不要使用梨的东西。切换到 cakephp。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-18T22:56:05.940

PEAR 非常向后兼容，因此您总是会遇到很多新弃用功能的错误。

CakePHP 也会抛出很多 E_STRICT 错误，所以这种情况并不少见。

我不会仅仅忽略它们，而是会查看错误并尝试自己评估它是否是值得忽略的错误。

我个人为 PHP 5.2 STRICT 编写，所以我不使用任何 PEAR 库。我更喜欢尝试与未来兼容，而不是向后兼容，并且我假设将安装足够新的 PHP 版本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-18T23:01:25.163

例如，当使用 ldap_connect 时，我在函数前面放了一个 @。那是你的意思吗？:)

# c# - 使用 CodeDOM 的公共 getter、受保护的 setter

> ID：1015571
> 
> 赞同：2
> 
> 时间：2009-06-18T22:42:08.527
> 
> 标签：c#, .net, serialization, codedom

是否可以使用 CodeDOM 生成具有公共 getter 和受保护 setter 的属性？目标是实现类似于以下的目标。

```
[Serializable]
public class Wrapper {
  public Wrapper() { }
  private string _Field;
  public string Field { get; protected set; }
} 
```

我有一个基于 COM 的大型 API，我希望为其编译一个 .Net 包装器，以便更轻松地使用 .Net 功能，例如 LINQ、反射、继承和序列化。唯一可行的方法是通过代码生成自动化大部分工作。

这些对象包含一些我希望通过需要属性设置器的序列化公开的只读属性。但是这么长时间我还没有找到任何方法来设置 setter protected 或类似的。

一种方法可能是将属性标记为不可序列化并序列化 _Field 但由于序列化输出的一个目标是 web 我需要为私有成员分配所有**可能**的序列化器属性，这些属性会引导序列化器使用更清晰的名称（没有下划线）用于序列化。出于同样的原因，我相信自定义序列化是不可能的。

我可以准确地反序列化它并不重要，即。在反序列化期间/通过反序列化过程中，值保持其原始值并不重要。这些属性是只读的，只是为了通过防止 API 使用者尝试更改只读字段并想知道为什么它们对任何内容没有影响来减少混淆。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-07-15T18:51:28.347

只是总结一下。在 CodeDOM 中，除了原始字符串输出之外，没有办法做到这一点。

而对于 XMLSerializer 而言，序列化程序能够序列化类，但它不会使用受保护的 setter 序列化值。

所以不可能。我使用的另一种方法是为这些类中的每一个生成一个`ToSerializableType()`方法，该方法返回一个类似类的实例，该类具有读/写的所有属性。

# c++ - 从 DLL 导出的静态类变量显示为内存泄漏

> ID：1015572
> 
> 赞同：3
> 
> 时间：2009-06-18T22:42:27.590
> 
> 标签：c++

好的，我在 DLL 中有一个导出的类。此类有一个静态字符串列表，在导入过程中用于对话框的组合框。这些字符串的声明和定义如下：

```
// In header:
class MYDLL_API someClass {
public:
    static const string stringList[];
    static const int numString;
};

// In .cpp
const int someClass::numString = 3;
const string someClass::stringList[numString] = {
    "String 1",
    "String 2",
    "String 3"
}; 
```

所以实际的导出工作正常。但是，我注意到我的 VS 2008 调试器转储内存显示为

```
{129} normal block at 0x003D69F0, 32 bytes long.
Data: <String 1>

etc. 
```

因此，为了确定谁在泄漏此内存，我停止在组合框中使用它们，并检查泄漏是否仍然存在，确实存在。所以我的问题是，是否存在与从 DLL 导出静态类变量相关的问题，它被认为是内存泄漏？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-18T23:04:48.463

这可能是静态变量超出范围以及卸载 dll (mfc/crt) 的顺序问题。

看看[这个](http://www.eggheadcafe.com/software/aspnet/32623009/why-does-mfc-call-crtdum.aspx)- 它描述了您所看到的几乎相同的问题。

[这里](http://groups.google.com/group/microsoft.public.vc.mfc/browse_frm/thread/73493ddec165a5cb/e651b944da9c619d?#e651b944da9c619d)还有一个建议的解决方案，但是我不知道这是否可行。

我过去遇到过这样的问题，我能够（干净地）摆脱这些误报的唯一方法是将这些静态定义为 shared_ptr 并在全局“关闭”方法中销毁它们。

# algorithm - 创建许可证密钥的安全算法？

> ID：1015573
> 
> 赞同：24
> 
> 时间：2009-06-18T22:42:35.437
> 
> 标签：algorithm, software-distribution, product-key

我想分发一个应用程序，但有他们可以输入解锁的许可证密钥。什么是创建简洁密钥的好算法，该密钥包含有关他们购买的版本的信息，以及许可证期限等其他内容。

我意识到这种保护可以被破解，但它让诚实的人保持诚实。我可能会也可能不会实现在线激活，但我主要关心生成这些密钥的好方法。

这种情况我们都见过，什么算法效果最好？我应该询问用户的明文名称并使用它根据他们自己的信息创建唯一的产品密钥吗？

是否有一个系统可以用来使生成有效密钥几乎不可能？

也许是公钥/私钥对加密情况，只有制造商拥有私钥，并且可以通过公钥验证数据，但无法劫持公钥以创建有效密钥。

由于这是一个产品密钥，如果它相当短，64 个字符或最多 128 个字符会很棒，但越短越好，32 或更少会很棒。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-18T22:48:50.463

你没有说你在哪个平台上，但这是 Microsoft .Net 中的一个：

[.NET 真正简单的许可方案](https://web.archive.org/web/20120628140119/http://jclement.ca/devel/dotnet/reallysimplelicensing.html)

> 此页面记录了一个非常简单的许可方案，您可以将其用于您的 .NET 应用程序。它旨在相当安全、易于实施和易于扩展。示例版本允许您提供其中嵌入了客户端名称的许可证文件，但您可以轻松扩展它以添加其他识别信息、机器绑定、到期日期等。
> 
> 该方案利用了 Microsoft 的 RSA 库和 XML 签名。基本上，您将任何您想要的内容放入 XML 文档并签署该文档。然后您可以将该文件提供给您的客户，应用程序可以从该文件中读取许可信息。由于该文件是数字签名的，除非您释放您的私钥（您真的不应该这样做），否则许可证文件不能被篡改。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-07-26T19:17:24.973

### 没有互联网访问和拍摄键

*关于序列密钥大小，在短/人类可读密钥（不太安全*）和长密钥或可能的许可证文件（*更安全*）之间进行权衡。

如果您想要简短且人类可读的密钥以允许您存储诸如到期日期和功能之类的内容，您可以将 SKGL 与 Software Protector 一起使用，它们都是开源的（[https://help.cryptolens.io/faq/what-是-skgl](https://help.cryptolens.io/faq/what-is-skgl)）。

然而，缺点是他们很可能会使用对称加密和/或将密钥生成算法存储在应用程序中。这意味着最终用户可以尝试查找加密密钥和/或算法（请参阅[http://www.codeproject.com/Articles/764610/Licensing-systems-in-NET](http://www.codeproject.com/Articles/764610/Licensing-systems-in-NET)）。

### Internet 访问（或使用激活文件离线）

更好的选择是使用基于云的系统来跟踪所有许可证密钥并允许您随时修改它们。

如果您有基于 Web 的许可系统，您可以使密钥更短，并且不必在实际密钥中存储信息（大多数基于离线的系统都是这种情况）。

此外，您将能够支持更多的许可模式，例如基于订阅的模式。

解决方案是：

*   **自己构建这样的系统**- 这将花费大量时间并分散您对应用程序核心功能的注意力。

*   **使用现有的开源系统作为起点**- 虽然它可能很诱人，因为它是开源且免费的，但将它们带到云端 + 将其配置为您的特定需求 + 维护它需要时间。我观察到的开源系统往往功能非常广泛，这导致了复杂性。

*   **外包给第三方**——缺点是大部分都不是免费的。

在我看来，整个过程应该外包给专门开发该特定组件的第三方。扩展后，您可能需要更改许可逻辑。第三方可能已经支持这种方案，而不是自己开发。

有几种解决方案（*确保寻找基于网络的*解决方案），[Cryptolens](https://serialkeymanager.com/)就是一个例子。如果您正在开发 .NET 应用程序，这里是一步一步的示例：[https](https://help.cryptolens.io/examples/key-verification) ://help.cryptolens.io/examples/key-verification 。

* * *

**免责声明**：我是 SKGL/Software Protector、关于许可系统的文章和 Cryptolens 的作者。

# html - 后处理/“包装”任意网页的 AJAX 安全方式？

> ID：1015575
> 
> 赞同：0
> 
> 时间：2009-06-18T22:43:40.240
> 
> 标签：html, ajax, apache, http, filter

我为学术软件项目管理一个系统，该系统以及其他东西允许项目提供与 Trac 错误跟踪器/wiki/源浏览器实例集成的网页。这个想法是用户可以根据自己的喜好自由设计他们的主页（他们真的很喜欢），但具有一些便利/品牌功能，例如常见的导航元素，以及顶部的（不显眼的）链接栏以链接回主页和其他托管项目。为了找到更好的词，我使用“包装”来描述将导航元素和链接栏插入到文档中。我知道，我知道：重载的术语。抱歉，如果您期待回车问题；）

几年来，该系统与用户定义的用于 text/html 的 Apache 2 OutputFilter 实现的“包装”工作得相当好：当 HTML 流离开服务器时，我将输入的 HTML 解析为 DOM，稍微规范化树如果需要，然后插入适当的额外元素。有点杂乱无章，但我能找到的最好方法，到目前为止效果很好。但是，我现在想将 Trac 系统升级到 0.11，其中使用了一些简洁的 AJAX 来延迟渲染目录树而无需重新加载：效果是 AJAX HTML 流*也*被 Apache 过滤器修改，因此每次打开目录时都会添加新的“顶栏”和导航工具。这显然很糟糕，我宁愿我的用户也可以根据需要使用 AJAX，而不是破解特定于 Trac 的“忽略目录浏览 HTTP 请求”系统。

我想知道的是是否有人有更好的方法将这种后处理应用于网页......特别是在本质上可以更好地使用 AJAX 的方式，而不会限制我的用户对他们的页面做他们想做的事情的自由. 谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-18T22:46:54.383

> 当 HTML 流离开服务器时，我将输入的 HTML 解析为 DOM，如果需要，对树进行一些规范化，然后插入适当的额外元素。

我不熟悉这种技术，所以我必须问解析到底是什么？一种语言还是一组规则或什么？如果它是一种语言，您可以检查请求的标头，如果它是 AJAX 请求，您可以简单地按原样返回流，而不是添加导航。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-18T23:12:15.640

您使用什么语言？

你会很难用 DOM 来做这件事，因为它很容易改变..

我敢说..考虑改用正则表达式。

# java - Solr：从分词器中填充单独的字段

> ID：1015576
> 
> 赞同：0
> 
> 时间：2009-06-18T22:44:22.967
> 
> 标签：java, lucene, solr

我在 Solr 中创建了一个用于查找命名实体的自定义 Tokenizer。我希望能够使用此信息来填充 lucene/solr 文档中的单独字段。

例如，我想用从文本中提取的所有位置名称填充一个名为“位置”的多值字段。为了提取位置，首先对文本进行标记以分离单词并确定哪些标记是位置。在这个过程之后，我想为标记器发出标记，但也用从文本中提取的所有位置名称填充字段“位置”。

根据我所做的研究，无法从 Tokenizer 或 TokenizerFactory 访问 SolrDocument 对象，因此无法从此处填充字段。

到目前为止，我提出的解决方案是创建一个自定义 UpdateRequestProcessorFactory 来处理文本并提取字段，然后 Tokenizer 再次处理文本以获取令牌。我想找到一种方法来完成这项工作并且只处理一次文本。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-08-04T00:41:01.190

我这样做的方式不像你正在拍摄的那样优雅：

我使用命名实体识别器预处理文档并将所有实体保存在单独的文件中。然后，当我发布到 Solr 时，我只是从该文件中读取实体并填充实体字段（人员、位置和组织不同）。这可以简化，但由于我已经为其他工作完成了解析，因此重用已经存在的内容会更容易。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-18T23:40:45.600

这是一个我认为可以在 lucene 中使用的想法，但我不知道在 solr 中是否可行。您可以按照您的建议对典型令牌流链之外的字符串进行标记，然后使用[NOT_ANALYZED](http://lucene.apache.org/java/2_4_1/api/org/apache/lucene/document/Field.Index.html#NOT_ANALYZED)选项手动将令牌添加到文档中。您必须使用 document.add(...) 分别添加每个标记，lucene 会将其视为单个字段进行搜索。

# ruby-on-rails - 为什么 Rails 和 Passenger 会占用我的记忆？

> ID：1015578
> 
> 赞同：0
> 
> 时间：2009-06-18T22:44:52.250
> 
> 标签：ruby-on-rails, apache2, passenger

我在 Slicehost 的 256 片上运行 Apache 和 Passenger 来托管我的 Rails 应用程序。我不得不经常进行硬重启。当我查看此乘客记忆统计数据时。

```
--------- Passenger processes ---------
 ** [out :: welcometonewnepal.com] PID   Threads  VMSize    Private  Name
 ** [out :: welcometonewnepal.com] ---------------------------------------
 ** [out :: welcometonewnepal.com] 8246  11       <b>84.1 MB   0.1 MB   /usr/lib/ruby/gems/1.8/gems/passenger-2.2.2/ext/apache2/ApplicationPoolServerExecutable</b> 0 /usr/lib/ruby/gems/1.8/gems/passenger-2.2.2/bin/passenger-spawn-server  /usr/bin/ruby1.8  /tmp/passenger.4217
 ** [out :: welcometonewnepal.com] 8247  2        <b>57.1 MB   0.2 MB   Passenger spawn server</b>
 ** [out :: welcometonewnepal.com] 8903  1        <b>185.6 MB  9.6 MB   Passenger ApplicationSpawner:</b> /home/deploy/rails_apps/welcometonewnepal/production/current
 ** [out :: welcometonewnepal.com] 9065  1        <b>195.1 MB  76.6 MB  Rails:</b> /home/deploy/rails_apps/welcometonewnepal/production/current
 ** [out :: welcometonewnepal.com] ### Processes: 4
 ** [out :: welcometonewnepal.com] ### Total private dirty RSS: 86.43 MB 
```

看到粗体的尺寸，为什么它会占用这么多内存？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-18T22:52:52.920

仅根据这些统计数据不能肯定地说。

但为了帮助降低它：

*   在 Apache 上使用 Nginx
*   使用 Ruby 企业版——看起来你只是在使用常规的 1.8.6/7 ......这就是浪费内存

另外，您的应用程序中有很多宝石和/或插件吗？

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-08-20T22:05:54.810

它并没有占用太多内存……您需要注意的列是标记为“私有”的列。
如果将它们全部加起来（它在底部），您会看到乘客及其相关进程仅占用 86MB 内存。其中大部分也被应用程序的大小（76MB）占用。

您可能需要让我们知道您在服务器上运行的其他内容...安装 htop 并按内存排序以获得一个想法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T08:14:18.103

你需要做一些[内存分析](http://blog.pluron.com/2008/02/memory-profilin.html)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-25T14:59:56.663

如果您在 64 位环境中运行，请尝试切换到 32 位。Rails/Ruby 倾向于在 32 位环境中使用较少的内存。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-08-25T15:07:16.963

您是否调整过 Apache 或您的数据库设置？我发现一个 Wordpress 博客 + 一个小型 Rails 应用程序对于使用默认 Ubuntu 配置的 256MB 切片来说太多了。

在 Apache (Prefork MPM) 中尝试以下设置：

```
#KeepAlive On
KeepAlive Off
MaxKeepAliveRequests 100
KeepAliveTimeout 4

<IfModule prefork.c>
StartServers       5
MinSpareServers    5
MaxSpareServers    10
MaxClients         40
MaxRequestsPerChild 1
</IfModule> 
```

在我的情况下，我不得不将 MaxClients 进一步调低到 25。我曾经每周从 Slicehost 收到 2-3 封交换警告电子邮件，但自从我切换设置后的 2 周内我没有收到任何邮件。如果您使用的是 WorkerMPM 分叉，那么您的设置将有所不同。

如果您使用的是 MySQL，如果您不使用 InnoDB，请禁用 InnoDB 表。这可以为您节省相当多的内存。

# python - 使用 Pydev（Python 和 Eclipse）进行连续单元测试

> ID：1015581
> 
> 赞同：43
> 
> 时间：2009-06-18T22:46:50.637
> 
> 标签：python, unit-testing, pydev

有没有办法将后台单元测试与 Pydev Eclipse 环境集成？

我的单元测试运行良好，但我想将它们集成到基于源文件更改（例如用鼻子）在后台运行并将结果集成回 Eclipse（当测试失败时，我想用大红色 X 控制台和跟踪日志视图）。

不，旁边的命令提示符流鼻涕不算数。

在开发 RoR 的东西时，我已经有了这个 Eclipse 集成。

谢谢，

塔尔。

**编辑：**查看新的 Pydev (1.6.4) [http://pydev.org/manual_adv_pyunit.html](http://pydev.org/manual_adv_pyunit.html)

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2011-04-13T14:09:41.377

此功能已添加到 PyDev 2.0.1 中，可以选择在 python 文件更改时重新启动上次测试运行中的测试，以及仅重新运行错误的附加选项——尽管如果没有，它将运行完整的测试套件发现了错误，因为我们的想法是您解决错误，并且当所有错误都通过时，整个套件的最终启动完成（然后您可以继续执行另一项任务）。

当前的夜间版本包含此功能。

![有新动作的图片](../Images/729b78573779783f913fd23a801139e6.png)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-06-24T16:44:23.797

Pydev 确实有一些单元测试集成，但这只是作为运行配置......所以......

这不是一种非常优雅的方式，但是如果您：

1.  启用项目->自动构建
2.  在您的项目属性中，添加一个类型为 Program 的新构建器
3.  将其配置为运行测试并选择“在自动构建期间”

然后至少你会得到一些东西，在资源保存时将测试结果输出到控制台。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-06-24T19:16:37.127

我刚刚意识到 PyDev 有相当强大的脚本支持。不幸的是，我没有时间为你做这一切（但如果你完成了，请在此处发布 :)

如果您`pyedit_nose.py`在一个空文件夹中创建一个名称如下所示的文件：

```
assert cmd is not None
assert editor is not None

if cmd == 'onSave':
    from java.lang import Runtime
    from java.io import BufferedReader
    from java.io import InputStreamReader

    from org.eclipse.core.resources import ResourcesPlugin
    from org.eclipse.core.resources import IMarker
    from org.eclipse.core.resources import IResource

    proc = Runtime.getRuntime().exec('ls -al')
    extra_message = BufferedReader(InputStreamReader(proc.inputStream)).readLine()

    r = ResourcesPlugin.getWorkspace().getRoot()
    for marker in r.findMarkers(IMarker.PROBLEM, False, IResource.DEPTH_INFINITE):
        if marker.getAttribute(IMarker.MESSAGE).startsWith("Some test failed!"):
            marker.delete()

    for rr in r.getProjects():
        marker = rr.createMarker(IMarker.PROBLEM)
        marker.setAttribute(IMarker.MESSAGE, "Some test failed! " + extra_message)
        marker.setAttribute(IMarker.PRIORITY, IMarker.PRIORITY_HIGH)
        marker.setAttribute(IMarker.SEVERITY, IMarker.SEVERITY_ERROR) 
```

并设置 Preferences->PyDev->Scripting Pydev 指向此目录，每次保存文件时，您的工作区中的所有项目都会标记为错误。

通过执行以某种易于解析的格式返回测试结果的脚本，而不是`ls`解析输出，您应该能够将标记放在正确的位置。

有关一些起点，请参见此处：

*   [Pydev 中的 Jython 脚本](http://fabioz.com/pydev/manual_articles_scripting.html)
*   [IMarker](http://help.eclipse.org/stable/index.jsp?topic=/org.eclipse.platform.doc.isv/reference/api/org/eclipse/core/resources/IMarker.html)是一个标记。
*   [IResource](http://help.eclipse.org/stable/index.jsp?topic=/org.eclipse.platform.doc.isv/reference/api/org/eclipse/core/resources/IResource.html)是您将标记附加到的内容。可以为工作区、项目、文件、目录等`resource.createMarker(IMarker.PROBLEM)`创建问题标记。
*   [IProject](http://help.eclipse.org/stable/index.jsp?topic=/org.eclipse.platform.doc.isv/reference/api/org/eclipse/core/resources/IProject.html)是一种`IResource`表示项目的类型。使用`members()`方法获取内容。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-02-21T22:04:19.357

我第一次手动运行测试（*Run > Run As > Python unit test*）。在那之后，我 `Ctrl+Shift+F9`习惯于保存文件并执行测试，而不是保存`Ctrl+S`并期待一些魔法发生。

`Ctrl+Shift+F9`组合键重新启动上次运行的配置。

**免责声明**：我是 Eclipse 和 PyDev 的新手，所以我可能会提出一些愚蠢/明显/错误的建议

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-04-08T02:51:10.047

我使用[Nosy](http://pypi.python.org/pypi/nosy)（可在 pypi 上获得）：

> 每当更改源文件时运行鼻子测试发现和执行工具。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-12-02T18:29:34.530

我增强了“爱管闲事”脚本以自动构建文档并连续运行测试。没有什么出色的，但可以完成工作。在这里发布它是因为原始链接已关闭。与原始的 nosy 脚本不同，这个脚本递归地扫描目录并允许查找多种模式。

```
import os
import os.path
import sys
import stat
import time
import subprocess
from fnmatch import fnmatch

def match_patterns(pathname, patterns):
    """Returns True if the pathname matches any of the given patterns."""
    for pattern in patterns:
        if fnmatch(pathname, pattern):
            return True
    return False

def filter_paths(pathnames, patterns=["*"], ignore_patterns=[]):
    """Filters from a set of paths based on acceptable patterns and
    ignorable patterns."""
    result = []
    if patterns is None:
        patterns = []
    if ignore_patterns is None:
        ignore_patterns = []
    for path in pathnames:
        if match_patterns(path, patterns) and not match_patterns(path, ignore_patterns):
            result.append(path)
    return result

def absolute_walker(path, recursive):
    if recursive:
        walk = os.walk
    else:
        def walk(path):
            return os.walk(path).next()
    for root, directories, filenames in walk(path):
        yield root
        for directory in directories:
            yield os.path.abspath(os.path.join(root, directory))
        for filename in filenames:
            yield os.path.abspath(os.path.join(root, filename))

def glob_recursive(path, patterns=["*"], ignore_patterns=[]):
    full_paths = []
    for root, directories, filenames in os.walk(path):
        for filename in filenames:
            full_path = os.path.abspath(os.path.join(root, filename))
            full_paths.append(full_path)
    filepaths = filter_paths(full_paths, patterns, ignore_patterns)
    return filepaths

def check_sum(path='.', patterns=["*"], ignore_patterns=[]):
    sum = 0
    for f in glob_recursive(path, patterns, ignore_patterns):
        stats = os.stat(f)
        sum += stats[stat.ST_SIZE] + stats[stat.ST_MTIME]
    return sum

if __name__ == "__main__":
    if len(sys.argv) > 1:
        path = sys.argv[1]
    else:
        path = '.'

    if len(sys.argv) > 2:
        command = sys.argv[2]
    else:
        command = "make -C docs html; bin/python tests/run_tests.py"

    previous_checksum = 0
    while True:
        calculated_checksum = check_sum(path, patterns=['*.py', '*.rst', '*.rst.inc'])
        if calculated_checksum != previous_checksum:
            previous_checksum = calculated_checksum
            subprocess.Popen(command, shell=True)
            time.sleep(2) 
```

希望这可以帮助。

=)

# arrays - 在 GAWK 中扫描数组的所有元素返回数字而不是值

> ID：1015586
> 
> 赞同：0
> 
> 时间：2009-06-18T22:47:36.237
> 
> 标签：arrays, string, gawk

给定以下功能：

```
function process_pipes(text)
{
    split(text,recs,"|");
    for (field in recs){
        printf ("|%s|\n", field)
    }
} 
```

如果输入为：0987654321|57300|ERROR account number not found|GDUMARESQ|0199|9|N|0||

为什么我得到下面的数字而不是文本？

```
|4|
|5|
|6|
|7|
|8|
|9|
|10|
|1|
|2|
|3|

```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-18T23:02:21.963

因为

```
for ... in 
```

给你*钥匙*。采用

```
printf("|%s|\n",recs[field]); 
```

获取值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-18T23:04:56.483

`split``recs`在您的代码中创建一个数组，并且`recs[1]`== 0987654321 等。

`for (field in recs)`循环生成索引列表，而不是数组元素。

因此，您需要：

```
function process_pipes(text)
{
    split(text,recs,"|");
    for (field in recs){
        printf ("|%s|\n", recs[field])
    }
} 
```

# python - 为什么 Python 对象中的“self”是不可变的？

> ID：1015592
> 
> 赞同：26
> 
> 时间：2009-06-18T22:51:21.533
> 
> 标签：python, object

为什么我不能执行如下操作：

```
class Test(object):
    def __init__(self):
        self = 5

t = Test()
print t 
```

我希望它能够打印`5`，因为我们正在用它覆盖实例，但它根本不做任何事情。甚至不会抛出错误。只是忽略分配。

我知道几乎不会有任何人想要这样做的情况，但你不能这样做似乎仍然很奇怪。

**更新：**我现在明白*为什么*它不起作用，但我仍然想知道是否有任何方法可以从实例中替换实例。

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2009-06-18T22:55:06.177

**对任何函数的**任何*参数的*任何*简单赋值在 Python 中的行为方式完全相同：将该名称绑定到不同的值，并且不执行任何其他操作。正如 Python 之禅所说，“没有任何特殊情况足以打破规则”！-)*

 **因此，远非奇怪（简单地=分配给特定函数中的特定参数没有任何外部可见的影响），如果这个特定案例以任何其他方式工作，那将是完全*令人惊讶*的，只是因为有问题的功能和论点。

如果您想要创建一个构造与其自身类型不同的对象的类，这种行为当然是很有可能的——但它是通过覆盖特殊方法获得的`__new__`，**而不是** `__init__`：

```
class Test(object):
    def __new__(cls):
        return 5

t = Test()
print t 
```

这*确实*发出`5`. Python 中的`__new__`/`__init__`行为是“两步构造”设计模式的一个示例：“构造函数”本身是`__new__`（它构建并返回一个（通常未初始化的）对象（通常是所讨论的类型/类的新对象）；`__init__`是正确初始化新对象的“初始化程序”。

例如，这允许构造一旦构造就不可变的对象：在这种情况下，所有事情都必须在`__new__`构造不可变对象之前完成，因为鉴于对象是不可变的，`__init__`因此无法对其进行变异以对其进行初始化。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-06-18T22:55:28.547

它不会“忽略”任务。分配工作得很好，您创建了一个指向数据 5 的本地名称。

如果你*真的*想做你正在做的事情...

```
class Test(object):
    def __new__(*args):
        return 5 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-18T22:57:57.463

我刚刚进行了快速测试，您可以分配给 self. 在你的**init** () 方法中，打印出 self. 你会看到它是 5。

您在这里缺少的是参数在 Python 中按值传递。因此，更改函数或方法中变量的值不会为外界改变它。

话虽如此，我强烈建议不要改变自我。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-18T22:54:10.593

Egon Spengler 博士：那会很糟糕。
Peter Venkman 博士：我对整个好/坏的事情都一头雾水。你是什​​么意思，“坏”？
Egon Spengler 博士：试着想象一下，你所知道的所有生命都会瞬间停止，你体内的每个分子都以光速爆炸。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-18T23:06:41.720

有时您想这样做，但不是使用不可变类型，例如`int`：

```
>>> class Test(list):
    ... def __init__(self):
    ...    list.__init__(self, [1,2,3])   # self = [1,2,3] seems right, but isn't

>> t = Test()
>> print t
[1, 2, 3] 
```

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2009-06-18T23:12:50.353

```
class Test(object):
    def __init__(self):
        self = 5

t = Test()
print t 
```

就像拥有这个 PHP（我只知道其他语言，抱歉）

```
class Test {
    function __construct() {
            $this = 5;
        }
} 
```

我不明白这有什么意义。用值替换实例？**

# php - 使用嵌套集构建动态菜单

> ID：1015595
> 
> 赞同：1
> 
> 时间：2009-06-18T22:52:43.090
> 
> 标签：php, sql, mysql, nested-sets

我正在尝试在我的 PHP CMS 中构建一个动态菜单；页面/类别使用嵌套集模型进行组织。

全树：

```
根
 一个
 乙
  B1
   B1.1
   B1.2
  B2
   B2.1
   B2.1
 C
  C1
  C2
  C3
 D

```

我想将此结果集转换为一个无序列表，它只显示树的一部分。例如：如果我单击 B，我只想显示列表的以下部分：

```
一个
乙
 B1
 B2
C
D

```

接下来，如果我单击 B1，我希望显示此列表：

```
一个
乙
 B1
  B1.1
  B1.2
 B2
C
D

```

等等

我使用以下 SQL 查询从 (mysql) 数据库中获取所有节点：

```
选择 node.id、node.lft、node.rgt、node.name、
GROUP_CONCAT(parent.name ORDER BY parent.lft SEPARATOR "/" ) 作为路径，
(COUNT(parent.lft) - 1) 作为深度
FROM 页面作为节点，页面作为父级
在 parent.lft 和 parent.rgt 之间的 node.lft
AND (parent.hidden = "no" AND node.hidden = "no") AND parent.lft > 1
GROUP BY node.id ORDER BY node.lft
```

我设法在没有递归的情况下创建了完整列表（使用深度列），但我无法像上面显示的那样过滤菜单；我想我需要为每个节点获取父节点的 lft 和 rgt 值，并使用 PHP 过滤掉元素。但是如何在同一个查询中获取这些值？

关于如何实现这一目标还有其他建议吗？

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-25T04:35:01.333

以下查询将允许您利用 SQL 的 having 子句和 MySQL 的[group_concat](http://dev.mysql.com/doc/refman/5.0/en/group-by-functions.html#function_group-concat)函数打开任何路径（或路径集）。

以下是我使用的表定义和示例数据：

```
drop table nested_set;

CREATE TABLE nested_set (
 id INT,
 name VARCHAR(20) NOT NULL,
 lft INT NOT NULL,
 rgt INT NOT NULL
);

INSERT INTO nested_set (id, name, lft, rgt) VALUES (1,'HEAD',1,28);
INSERT INTO nested_set (id, name, lft, rgt) VALUES (2,'A',2,3);
INSERT INTO nested_set (id, name, lft, rgt) VALUES (3,'B',4,17);
INSERT INTO nested_set (id, name, lft, rgt) VALUES (4,'B1',5,10);
INSERT INTO nested_set (id, name, lft, rgt) VALUES (5,'B1.1',6,7);
INSERT INTO nested_set (id, name, lft, rgt) VALUES (6,'B1.2',8,9);
INSERT INTO nested_set (id, name, lft, rgt) VALUES (7,'B2',11,16);
INSERT INTO nested_set (id, name, lft, rgt) VALUES (8,'B2.1',12,13);
INSERT INTO nested_set (id, name, lft, rgt) VALUES (9,'B2.2',14,15);
INSERT INTO nested_set (id, name, lft, rgt) VALUES (10,'C',18,25);
INSERT INTO nested_set (id, name, lft, rgt) VALUES (11,'C1',19,20);
INSERT INTO nested_set (id, name, lft, rgt) VALUES (12,'C2',21,22);
INSERT INTO nested_set (id, name, lft, rgt) VALUES (13,'C3',23,24);
INSERT INTO nested_set (id, name, lft, rgt) VALUES (14,'D',26,27); 
```

以下查询为您提供了整个树（HEAD 除外）：

```
SELECT
  node.id
, node.lft
, node.rgt
, node.name
,  GROUP_CONCAT(parent.name ORDER BY parent.lft  SEPARATOR "/" ) AS path
,  (COUNT(parent.lft) - 1) AS depth
FROM nested_set AS node
inner join nested_set AS parent
on node.lft BETWEEN parent.lft AND parent.rgt
where parent.lft > 1
GROUP BY node.id 
```

对样本数据运行时输出以下内容：

```
+------+-----+-----+------+-----------+-------+
| id   | lft | rgt | name | path      | depth |
+------+-----+-----+------+-----------+-------+
|    2 |   2 |   3 | A    | A         |     0 |
|    3 |   4 |  17 | B    | B         |     0 |
|    4 |   5 |  10 | B1   | B/B1      |     1 |
|    5 |   6 |   7 | B1.1 | B/B1/B1.1 |     2 |
|    6 |   8 |   9 | B1.2 | B/B1/B1.2 |     2 |
|    7 |  11 |  16 | B2   | B/B2      |     1 |
|    8 |  12 |  13 | B2.1 | B/B2/B2.1 |     2 |
|    9 |  14 |  15 | B2.2 | B/B2/B2.2 |     2 |
|   10 |  18 |  25 | C    | C         |     0 |
|   11 |  19 |  20 | C1   | C/C1      |     1 |
|   12 |  21 |  22 | C2   | C/C2      |     1 |
|   13 |  23 |  24 | C3   | C/C3      |     1 |
|   14 |  26 |  27 | D    | D         |     0 |
+------+-----+-----+------+-----------+-------+ 
```

对上述查询的以下添加将为您提供打开各个部分所需的控件：

```
having
depth = 0
or ('<PATH_TO_OPEN>' =  left(path, length('<PATH_TO_OPEN>'))
   and depth = length('<PATH_TO_OPEN>') - length(replace('<PATH_TO_OPEN>', '/', '')) + 1) 
```

having 子句将过滤器应用于 group by 查询的结果。“depth = 0”部分是为了确保我们始终有基本菜单节点（A、B、C 和 D）。下一部分是控制打开哪些节点的部分。它将节点的路径与您要打开的设置路径 ('') 进行比较，以查看它是否匹配，并确保它仅在路径中打开级别。可以根据需要复制和添加带有''逻辑的整个或部分，以根据需要打开多个路径。确保 '' 不以斜杠 (/) 结尾。

以下是一些输出示例，向您展示如何构造查询以获得所需的输出：

```
=========Open B==========

SELECT
  node.id
, node.lft
, node.rgt
, node.name
,  GROUP_CONCAT(parent.name ORDER BY parent.lft  SEPARATOR "/" ) AS path
,  (COUNT(parent.lft) - 1) AS depth
FROM nested_set AS node
inner join nested_set AS parent
on node.lft BETWEEN parent.lft AND parent.rgt
where parent.lft > 1
GROUP BY node.id
having
depth = 0
or ('B' =  left(path, length('B'))
   and depth = length('B') - length(replace('B', '/', '')) + 1)

+------+-----+-----+------+------+-------+
| id   | lft | rgt | name | path | depth |
+------+-----+-----+------+------+-------+
|    2 |   2 |   3 | A    | A    |     0 |
|    3 |   4 |  17 | B    | B    |     0 |
|    4 |   5 |  10 | B1   | B/B1 |     1 |
|    7 |  11 |  16 | B2   | B/B2 |     1 |
|   10 |  18 |  25 | C    | C    |     0 |
|   14 |  26 |  27 | D    | D    |     0 |
+------+-----+-----+------+------+-------+

=========Open B and B/B1==========

SELECT
  node.id
, node.lft
, node.rgt
, node.name
,  GROUP_CONCAT(parent.name ORDER BY parent.lft  SEPARATOR "/" ) AS path
,  (COUNT(parent.lft) - 1) AS depth
FROM nested_set AS node
inner join nested_set AS parent
on node.lft BETWEEN parent.lft AND parent.rgt
where parent.lft > 1
GROUP BY node.id
having
depth = 0
or ('B' =  left(path, length('B'))
   and depth = length('B') - length(replace('B', '/', '')) + 1)
or ('B/B1' =  left(path, length('B/B1'))
   and depth = length('B/B1') - length(replace('B/B1', '/', '')) + 1)

+------+-----+-----+------+-----------+-------+
| id   | lft | rgt | name | path      | depth |
+------+-----+-----+------+-----------+-------+
|    2 |   2 |   3 | A    | A         |     0 |
|    3 |   4 |  17 | B    | B         |     0 |
|    4 |   5 |  10 | B1   | B/B1      |     1 |
|    5 |   6 |   7 | B1.1 | B/B1/B1.1 |     2 |
|    6 |   8 |   9 | B1.2 | B/B1/B1.2 |     2 |
|    7 |  11 |  16 | B2   | B/B2      |     1 |
|   10 |  18 |  25 | C    | C         |     0 |
|   14 |  26 |  27 | D    | D         |     0 |
+------+-----+-----+------+-----------+-------+

=========Open B and B/B1 and C==========

SELECT
  node.id
, node.lft
, node.rgt
, node.name
,  GROUP_CONCAT(parent.name ORDER BY parent.lft  SEPARATOR "/" ) AS path
,  (COUNT(parent.lft) - 1) AS depth
FROM nested_set AS node
inner join nested_set AS parent
on node.lft BETWEEN parent.lft AND parent.rgt
where parent.lft > 1
GROUP BY node.id
having
depth = 0
or ('B' =  left(path, length('B'))
   and depth = length('B') - length(replace('B', '/', '')) + 1)
or ('B/B1' =  left(path, length('B/B1'))
   and depth = length('B/B1') - length(replace('B/B1', '/', '')) + 1)
or ('C' =  left(path, length('C'))
   and depth = length('C') - length(replace('C', '/', '')) + 1)

+------+-----+-----+------+-----------+-------+
| id   | lft | rgt | name | path      | depth |
+------+-----+-----+------+-----------+-------+
|    2 |   2 |   3 | A    | A         |     0 |
|    3 |   4 |  17 | B    | B         |     0 |
|    4 |   5 |  10 | B1   | B/B1      |     1 |
|    5 |   6 |   7 | B1.1 | B/B1/B1.1 |     2 |
|    6 |   8 |   9 | B1.2 | B/B1/B1.2 |     2 |
|    7 |  11 |  16 | B2   | B/B2      |     1 |
|   10 |  18 |  25 | C    | C         |     0 |
|   11 |  19 |  20 | C1   | C/C1      |     1 |
|   12 |  21 |  22 | C2   | C/C2      |     1 |
|   13 |  23 |  24 | C3   | C/C3      |     1 |
|   14 |  26 |  27 | D    | D         |     0 |
+------+-----+-----+------+-----------+-------+ 
```

就是这样。您只需为需要打开的每条路径重复该部分或部分。

如果您需要有关在 MySQL 中使用嵌套集的一般信息，请参阅[http://mikehillyer.com/articles/managing-hierarchical-data-in-mysql/ 。](http://mikehillyer.com/articles/managing-hierarchical-data-in-mysql/)

如果您有任何问题，请告诉我。

高温下，

-蘸

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-09-23T21:26:36.363

我意识到这可能是一个老问题，但当我偶然发现同样的问题时，我决定提供一些意见，以便其他人也能从中受益。

-Dipins 的答案是我的进步所依据的答案，现在我认为我有一个没有所有“或”的解决方案。

只需将有部分替换为：

```
HAVING
  depth = 1
  OR
  '".$path."' LIKE CONCAT(SUBSTRING(path, 1, (LENGTH(path) - LENGTH(menu_node_name) -1)), '%')

$path = requested path. parent node's path that the user clicked, "A/B" for example

path = the path of the current node including the nodes name "A/B/B1" for example, which is a child for the node the user clicked.

menu-node-name = the name of the node in progress, "B1" for example. 
```

它的作用是比较请求的路径，比如 A/B/B1 与节点的路径。节点的路径需要一些艰苦的工作。LIKE path-of-node % 确实有效，但它只给出了上层，没有给出同层的任何其他节点。这个版本可以。

我们将 path_of_node 与通配符 (%) 连接起来，这意味着任何东西都可以在它之后出现。子字符串*删除*节点自己的名称和破折号，使 path_of_node 实际上是它的*父*节点的路径。因此，如果我们单击链接以打开新的子树，A/B/B1 将变为“A/B%”，这与我们的请求相匹配。

我有depth = 1的原因是我可能在同一棵树中有多个菜单，我不希望人们看到“菜单-富人”、“菜单-穷人”之类的东西名字是反正。我的集合的顶级节点是一种持有节点，我将它们排除在实际结果之外。

我希望这被证明对某人有用，至少我花了几个小时寻找解决方案，然后想出了它。

我想，几天后你可以通过查看[www.race.fi来确认这是否有效](http://www.race.fi)

编辑/注意：

我又测试了一些，似乎订购有问题。这是我的查询的快速复制粘贴，并具有正确的顺序。有一些不必要的东西，比如语言环境、内容和 content_localised，但关键点应该很清楚。

```
SELECT
    REPEAT('-',(COUNT(MENU.par_name) - 2)) as indt,
    GROUP_CONCAT(MENU.par_name ORDER BY MENU.par_lft  SEPARATOR '/' ) AS path,
    (COUNT(MENU.par_lft) - 1) AS depth,
    MENU.*,
    MENU.content
FROM 
    (SELECT 
        parent.menu_node_name AS par_name,
        parent.lft AS par_lft,
        node.menu_node_id,
        node.menu_node_name,
        node.content_id,
        node.node_types,
        node.node_iprop,
        node.node_aprop,
        node.node_brands,
        node.rgt,
        node.lft,
        [TPF]content_localised.content

    FROM [TPF]" . $this->nestedset_table . " AS node 
    JOIN [TPF]" . $this->nestedset_table . " AS parent
            ON node.lft BETWEEN parent.lft AND parent.rgt
    JOIN [TPF]content
        ON node.content_id = [TPF]content.content_id
    JOIN [TPF]content_localised
        ON [TPF]content.content_id = [TPF]content_localised.content_id  
    JOIN [TPF]locales 
        ON [TPF]content_localised.locale_id = [TPF]locales.locale_id

    ORDER BY node.rgt, FIELD(locale, '" . implode("' , '", $locales) . "', locale) ASC
    ) AS MENU

GROUP BY MENU.menu_node_id
HAVING depth = 1
    OR '".$path."' LIKE CONCAT(SUBSTRING(path, 1, (LENGTH(path) - LENGTH(MENU.menu_node_name) -1)), '%')
    AND depth > 0
ORDER BY MENU.lft"; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-09-23T23:17:38.423

一个朋友写的关于如何从头开始构建嵌套集合的好帖子在这里；[MySQL中的嵌套集](http://www.fliquidstudios.com/2008/12/23/nested-set-in-mysql/)

也许它对你有帮助。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-06-21T02:23:49.310

隐藏不需要的元素是否适合您的项目范围？例如（CSS）：

*   .menu li > ul {显示：无；}
*   .menu li.clicked > ul {display: block;}

然后使用 javascript 将“clicked”类添加到任何被点击的 <li> 元素。请注意，此 CSS 在 IE6 中不起作用。

# css - Div 对齐 FireFox, IE7, IE6

> ID：1015601
> 
> 赞同：1
> 
> 时间：2009-06-18T22:54:54.523
> 
> 标签：css, html, css-float

我在对齐 IE6、IE7、IE8 和 Firfox 3 中的几个 div 时遇到问题。它们都不能正确呈现 IE8 和 Firefox，而其他 IE8 和 Firefox 则不能。

是否可以通过浮动和清除来做到这一点..它们之间不需要任何间距，我只是这样画的....此外，div应该是固定宽度。

[替代文字 http://cowfarm.net/divAlign.png](http://cowfarm.net/divAlign.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-18T22:58:49.553

是的，这是可能的：

```
<table>
    <tr>
        <td></td>
        <td rowspan='2'></td>
    </tr>
    <tr>
        <td></td>
    </tr>
    <tr>
        <td colspan='2'></td>
    </tr>
</table> 
```

当然，我只是在开玩笑。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-18T23:04:54.953

2 个左 DIV 和右 DIV 的组合高度不会相等。除非你指定这些，或者如果内容产生相同的高度......但这不应该是我认为的问题吗？

**更新**

```
<style type="text/css">
    #container {float:right;position:relative;}
    #left    {float:left;}
    #left_1  {float:left;}
    #left_2  {clear:left;float:left;}
    #right   {float:right;}
    #bottom  {float:left;clear:both;}
</style>

<div id="container">
    <div id="left">
        <div id="left_1">left 1</div>
        <div id="left_2">left 2</div>
    </div>

    <div id="right">right</div>

    <div id="bottom">bottom</div>
</div> 
```

# python - 如何在 virtualenv 中使用 MinGW 编译 Python C 扩展？

> ID：1015605
> 
> 赞同：2
> 
> 时间：2009-06-18T22:55:29.187
> 
> 标签：python, mingw, virtualenv

在 Windows 上将 virtualenv 与 MinGW 编译器结合使用时，编译 C 扩展会导致以下错误：

```
C:\MinGW\bin\..\lib\gcc\mingw32\3.4.5\..\..\..\..\mingw32\bin\ld.exe：找不到-lpython25
collect2: ld 返回 1 个退出状态
错误：安装脚本退出并出现错误：命令“gcc”失败，退出状态为 1

```

应该怎样做才能成功编译 C 扩展？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-18T23:01:38.877

设置`LIBRARY_PATH`环境变量，以便 MinGW 知道在哪里可以找到系统范围的 Python `libpython25.a`。

在您的 virtualenv 中放置一行`activate.bat`：

```
set LIBRARY_PATH=c:\python25\libs 
```

或者在 Windows 中设置一个全局环境变量。

`25`如果您不使用 2.5 版，请务必更改为与您的 Python 版本相对应。

# scala - 混合面向对象和函数式编程

> ID：1015606
> 
> 赞同：36
> 
> 时间：2009-06-18T22:55:44.067
> 
> 标签：scala, functional-programming, imperative-programming

有哪些语言可以同时促进面向对象和函数式编程？我知道任何支持一流函数的语言都可以被认为是函数式的，但我正在寻找一种专门针对两种编码风格的语法。

使用这样的语言，我想象将所有状态更改隔离到单个代码部分，并让程序的其余部分纯粹是功能性的。光是想想就让我流口水（调试天堂！）。

到目前为止，我已经发现了[Scala](http://www.scala-lang.org/)，尽管我只是听说过它（而且它看起来很棒）。在这种“混合风格”范式中是否有任何大的竞争者？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-06-18T22:59:08.820

Javascript：[面向对象](https://stackoverflow.com/questions/800856/object-oriented-javascript)和[函数](https://stackoverflow.com/questions/145053/javascript-as-a-functional-language)式.

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-06-18T22:57:45.547

最著名的是[OCaml](http://en.wikipedia.org/wiki/OCaml)和[F#](http://en.wikipedia.org/wiki/F_Sharp_programming_language)（可以模糊地描述为 .NET 的 OCaml）。

还有许多其他多范式语言，例如[Oz](http://en.wikipedia.org/wiki/Oz_(programming_language))，但它们主要具有教学价值。相比之下，OCaml 非常实用。它几乎和 C 一样快，几乎和 Haskell 一样漂亮 :)

Python 和 Ruby 等流行的脚本语言也可以让您以函数式风格进行编程。但是，它们没有提供“经典”函数式语言（以及 OCaml）所具有的最强大的工具之一：[模式匹配](http://en.wikipedia.org/wiki/Pattern_matching)（不要将其误认为是正则表达式）。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-06-18T22:57:02.520

*   [OCaml](http://caml.inria.fr/)
*   [O'Haskell](http://www.cs.chalmers.se/~nordland/ohaskell/)（[即使在普通的 Haskell 中，面向对象的编程也是有可能的](http://homepages.cwi.nl/~ralf/OOHaskell/)）
*   [内梅尔](http://nemerle.org/Main_Page)
*   可能[是新的 LISP](http://www.newlisp.org/index.cgi?page=Differences_to_Other_LISPs)

此外，许多脚本语言（如 Python、Ruby、Lua 等）具有此功能，但缺少函数式语言的许多优秀特性，例如代数数据类型和模式匹配。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2010-01-28T23:23:49.033

**Haskell**: Pure functional ,pretty much no OO, but go ahead, take the dive. :D

**Scala**: Beautiful mix of OO and FP, could possibly overtake java as premier language on the JVM in a decade or 2\. I like it because it brings functional programming to the java platform, something that's sorely need IMHO.

**C#**: Awesome support for OO, as well as getting more functional (first class functions already, we'll see what improvements .net 4 brings)

**F#**: .net language Built to be functional specifically, as opposed to C#, which was originally conceived for OO stuff.

**Python**: Great for OO, but [not at all suited to FP](https://stackoverflow.com/questions/1017621/functional-programming-in-python)

**Javascript**: Supports first-class functions, but not specifically designed for FP like Scala and F#. Still slightly better than python IMHO.

Why do you want to mix OO and FP? As a stepping stone?

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2009-06-18T22:57:14.330

据我所知，OCaml 和 F# 是最流行的混合 OOP 和 FP 的语言。

大多数语言，比如 Ruby，都混合了函数式编程，但很多人甚至没有意识到这一点。我发现像这样的语言在语法方面还有很多不足之处。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2009-06-18T23:43:39.027

C＃。它是命令式的，可以很方便，但也有很多功能特性。Lambda、迭代器和 LINQ 都是函数式的。

它可能对纯粹主义者没有太大吸引力，但它对我有用。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2009-06-18T23:03:48.280

JavaScript、Python 和 Ruby 可以以这种方式使用，但[Scala](http://www.scala-lang.org/)通过静态键入函数并在 JVM 下工作，提高了一个档次。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-06-18T23:40:58.890

你真的问错问题了。您的问题的前提是“OO”和“功能”编程之间存在区别。这种区别既不有趣也不相关。事实上，按照“支持一流函数”的标准，即使是[Java 也是函数](http://code.google.com/p/functionaljava)式的。

但是你用“纯粹的功能”一针见血。这是有趣的一点。哪些语言可以为您提供这样的参考透明度和纯度？嗯，他们中的大多数，*如果你非常小心的话。*但实际上并没有多少能保证你的函数是纯的。我只能想到几种可以为您提供这种功能的语言。

其中之一是**[Haskell](http://haskell.org/)**。在 Haskell 中，您编写的程序从头到尾都是纯函数式的。副作用被委托给称为 IO 的数据结构，状态通过纯函数传递或封装在 monad 中来处理。所以你有你的“调试天堂”，你的代码只有一小部分与全局状态交互，而你的程序的其余部分是纯的，并且纯由语言强制执行。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-06-19T01:30:08.063

只要你不坚持“纯粹”，Common Lisp 就能满足你的所有需求。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2012-08-17T22:46:40.143

Python、javascript、common lisp、ruby、smalltalk、haskell 和 ocaml，让我一头雾水。这不是一个真正的异国情调的组合。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-06-18T23:09:02.763

我想知道为什么您要寻找一种特别鼓励将其混合在一起的语言，而不是仅仅使用一种可以很好地进行函数式编程和 OO 编程的语言来做它？它可以通过 Python、Ruby、Perl 或类似的解释语言轻松实现。此外，基于 C 的 OO 语言倾向于将纯 C 与 OO 特性混合在一起，例如，如果您选择，Objective C 可以很容易地以这种方式编写。

编辑：我已经意识到我不正确，我把这个答案留在这里，以防有人可以从我的错误中吸取教训 - 请参阅评论。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-11-13T06:00:43.760

根据我的经验，C# 非常适合此目的。在 c# 中，您可以委托函数，甚至使用扩展方法，您也可以模仿 OOP 行为，但要考虑 FP。

我通常构建一个具有我需要的行为的类，然后构建一些函数来使用 FP 实践围绕它做一些肮脏的工作，这很好用，正如你提到的调试天堂。

在我看来，Pure FP 和 Pure OOP 都带来了一些其他人不会的缺点。OOP 倾向于使代码复杂化，而 FP 使某些企业更难编写代码，尤其是在状态至关重要的时候。

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2009-06-18T22:58:06.700

红宝石！在 Ruby 中，一切都是对象（甚至是文字），并且它还具有完整的函数式编程支持。

# objective-c - 如何在 Objective-C 中执行回调

> ID：1015608
> 
> 赞同：124
> 
> 时间：2009-06-18T22:56:33.910
> 
> 标签：objective-c, cocoa, callback

如何在 Objective-C 中执行回调函数？

我只想看一些完整的例子，我应该理解它。

* * *

## 回答 #1

> 赞同：141
> 
> 时间：2010-10-12T14:33:55.233

为了完整起见，由于 StackOverflow RSS 只是随机地为我复活了这个问题，另一个（较新的）选项是使用块：

```
@interface MyClass: NSObject
{
    void (^_completionHandler)(int someParameter);
}

- (void) doSomethingWithCompletionHandler:(void(^)(int))handler;
@end

@implementation MyClass

- (void) doSomethingWithCompletionHandler:(void(^)(int))handler
{
    // NOTE: copying is very important if you'll call the callback asynchronously,
    // even with garbage collection!
    _completionHandler = [handler copy];

    // Do stuff, possibly asynchronously...
    int result = 5 + 3;

    // Call completion handler.
    _completionHandler(result);

    // Clean up.
    [_completionHandler release];
    _completionHandler = nil;
}

@end

...

MyClass *foo = [[MyClass alloc] init];
int x = 2;
[foo doSomethingWithCompletionHandler:^(int result){
    // Prints 10
    NSLog(@"%i", x + result);
}]; 
```

* * *

## 回答 #2

> 赞同：95
> 
> 时间：2009-06-19T01:09:15.780

通常，目标 C 中的回调是由委托完成的。这是自定义委托实现的示例；

* * *

头文件：

```
@interface MyClass : NSObject {
    id delegate;
}
- (void)setDelegate:(id)delegate;
- (void)doSomething;
@end

@interface NSObject(MyDelegateMethods)
- (void)myClassWillDoSomething:(MyClass *)myClass;
- (void)myClassDidDoSomething:(MyClass *)myClass;
@end 
```

* * *

实施 (.m) 文件

```
@implementation MyClass
- (void)setDelegate:(id)aDelegate {
    delegate = aDelegate; /// Not retained
}

- (void)doSomething {
    [delegate myClassWillDoSomething:self];
    /* DO SOMETHING */
    [delegate myClassDidDoSomething:self];
}
@end 
```

这说明了一般方法。您在 NSObject 上创建一个类别，声明您的回调方法的名称。NSObject 实际上并没有实现这些方法。这种类型的类别称为非正式协议，您只是说许多对象可能实现这些方法。它们是一种转发声明选择器类型签名的方法。

接下来，您有一些对象是“MyClass”的委托，MyClass 会根据需要调用委托上的委托方法。如果您的委托回调是可选的，您通常会在调度站点使用“if ([delegate respondsToSelector:@selector(myClassWillDoSomething:)) {”之类的东西来保护它们。在我的示例中，委托需要实现这两种方法。

除了使用非正式协议之外，您还可以使用使用 @protocol 定义的正式协议。如果您这样做，您将更改委托设置器的类型，并将实例变量更改为“ `id <MyClassDelegate>`”，而不仅仅是“ `id`”。

此外，您会注意到委托未保留。这通常是因为“拥有”“MyClass”实例的对象通常也是委托。如果 MyClass 保留了它的委托，那么就会有一个保留周期。在具有 MyClass 实例并且是清除该委托引用的委托的类的 dealloc 方法中，这是一个好主意，因为它是一个弱反向指针。否则，如果某些东西使 MyClass 实例保持活动状态，您将有一个悬空指针。

* * *

## 回答 #3

> 赞同：53
> 
> 时间：2009-06-19T21:28:17.370

这是一个将代表的概念排除在外的示例，并且只是进行了原始回调。

```
@interface Foo : NSObject {
}
- (void)doSomethingAndNotifyObject:(id)object withSelector:(SEL)selector;
@end

@interface Bar : NSObject {
}
@end

@implementation Foo
- (void)doSomethingAndNotifyObject:(id)object withSelector:(SEL)selector {
    /* do lots of stuff */
    [object performSelector:selector withObject:self];
}
@end

@implementation Bar
- (void)aMethod {
    Foo *foo = [[[Foo alloc] init] autorelease];
    [foo doSomethingAndNotifyObject:self withSelector:@selector(fooIsDone:)];
}

- (void)fooIsDone:(id)sender {
    NSLog(@"Foo Is Done!");
}
@end 
```

通常，方法 -[Foo doSomethingAndNotifyObject:withSelector:] 将是异步的，这将使回调比这里更有用。

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2016-03-31T11:33:23.003

为了让这个问题保持最新，iOS 5.0 引入了[ARC](https://en.wikipedia.org/wiki/Automatic_Reference_Counting)意味着可以更简洁地使用[Blocks来实现：](https://developer.apple.com/library/ios/documentation/Cocoa/Conceptual/ProgrammingWithObjectiveC/WorkingwithBlocks/WorkingwithBlocks.html)

```
@interface Robot: NSObject
+ (void)sayHi:(void(^)(NSString *))callback;
@end

@implementation Robot
+ (void)sayHi:(void(^)(NSString *))callback {
    // Return a message to the callback
    callback(@"Hello to you too!");
}
@end

[Robot sayHi:^(NSString *reply){
  NSLog(@"%@", reply);
}]; 
```

如果你忘记了 Objective-C 的块语法，总会有[F****ng 块语法。](http://goshdarnblocksyntax.com)

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2016-10-13T07:47:31.880

CallBack：Objective C中有4种回调类型

1.  **Selector type** : 你可以看到 NSTimer,UIPangesture 是 Selector 回调的例子。用于非常有限的代码执行。

2.  **委托类型**：Apple 框架中常见且最常用的。UITableViewDelegate，NSNURLConnectionDelegate。它们通常用于显示从服务器异步下载许多图像等。

3.  **NSNotifications** : NotificationCenter is one of features of Objective C which used to notify many receiptants at time when event occur.
4.  **Blocks** : Blocks are more commonly used in Objective C programming. It is great feature and used for executing chunk of code. You can also refer tutorial to understand : [Blocks tutorial](https://www.appcoda.com/objective-c-blocks-tutorial/)

Please let me if any other answer for it. I will appreciate it.

# email - Hudson 对 .NET 和 XCode 有用吗？

> ID：1015618
> 
> 赞同：0
> 
> 时间：2009-06-18T22:58:46.573
> 
> 标签：email, hudson

我想知道是否有一个特定的插件可以用来过滤来自 Hudson 的输出日志。

我的工程师不需要通过电子邮件发送最后 1000 多行。我想特别将失败缩小到最后一对。正则表达式或 perl 会有所帮助。像警告插件这样的东西会很棒。（但不是警告，而是错误。）

此外，有没有办法自定义 hudson 倾向于发送的电子邮件模板。我想摆脱喷溅，只是给人们一个他们可以查看的链接。

感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-16T17:11:15.617

您是否尝试过[Email-ext 插件](http://wiki.hudson-ci.org/display/HUDSON/Email-ext+plugin)？

# php - 有没有办法强制 PHP 等待 MySQL 完成事务？

> ID：1015622
> 
> 赞同：5
> 
> 时间：2009-06-18T22:59:12.097
> 
> 标签：php, sql, mysql, pdo, transactions

我承认我不是 100% 了解 PDO 和 MySQL 的内部工作原理，所以我将举一个例子让我的问题更清楚。

我正在制作一个相当粗糙的基于浏览器的策略游戏，因为我认为这是一种学习 PHP 和数据库的有趣方式。当我遇到一个相当意外的错误时，我正在对战斗脚本进行错误测试。我使用 Cron Jobs 每分钟调用一个脚本，看起来像这样：

> $sql = "从现役军队中选择军队 ID，到达地点 = 0；";

```
foreach($dbh->query($sql) as $row)
    {

        battleEngine($row["army_id"]);

    } 
```

完成基本计算后（进攻方军队与防守方军队），数据库中的六个表将被更新。我面临的问题是，当我在同一分钟内对同一目标进行多次攻击时，其中一次攻击时不时地获取过时的数据库信息（在一种极端情况下，攻击 #10 获取与攻击 #5 相同的表） .

我猜这是因为脚本比数据库快吗？有没有办法强制 PHP 等到所有相关信息都准备好后再用下一个 $row 重复该函数？

*编辑：埃米尔可能是正确的。我不能确定，因为我的 PDO 似乎不可能保持打开足够长的时间让我在 beginTransaction() 和 commit() 之间传递几个语句。但是，脏读似乎很奇怪，因为我将 InnoDB 与“REPEATABLE READ”一起使用。一些谷歌搜索建议 REPEATABLE READ 将使脏读变得不可能。在考虑了一段时间如何杀死自己之后，我选择了破解。现在，我将一个特殊值的 UPDATE 放在我的脚本顶部，另一个放在底部的大批量（大约六个 UPDATE 语句）的末尾。在运行该函数之前，我已经建立了一个 while() 循环来检查该特殊值是否设置为 0。如果不是，它会休眠 0.01 秒并重试。查看输出，while循环平均重复两次，暗示它可能真的有效？它还没有失败，但可能是因为它不是高峰时间。明天我会定期再试一次。我知道没有人关心这一切，但我觉得我应该做这个更新以防万一。=P*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-18T23:07:22.187

您所看到的称为“脏读”。使用 InnoDB 并将[隔离级别](http://dev.mysql.com/doc/refman/4.1/en/set-transaction.html)设置为可序列化。然后将所有查询包装在事务块中：

```
$dbh->beginTransaction();
// run queries
$dbh->commit(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-18T23:04:01.260

如果 PHP 完全等待，您将获得大量的 cron 作业堆积。

您*真正*想要的是使用 anachron 之类的东西，以确保在任何给定时刻只有一个脚本实例运行。您也可以执行以下操作：

```
<?php

  if (file_exists('/tmp/myscriptlock')) exit();
  touch('/tmp/myscriptlock');

  // do your stuff

  unlink('/tmp/myscriptlock'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-26T05:03:51.070

我最初的想法是简单的mysql写锁，但我对这个问题理解得不够好。无论如何，这可能会有所帮助：[http ://www.perplexedlabs.com/2008/02/06/mutex-with-php-and-mysql/](http://www.perplexedlabs.com/2008/02/06/mutex-with-php-and-mysql/)

# unix - 在没有绑定的 Emacs 模式下使用 KSH 完成选项卡

> ID：1015631
> 
> 赞同：4
> 
> 时间：2009-06-18T23:02:19.483
> 
> 标签：unix, emacs, ksh

我正在尝试在 emacs 模式下为命令行启用自动完成功能。当我尝试：

```
set -o emacs
bind '^I'=complete
bind '^I'=complete-list 
```

并重新登录，我得到“找不到绑定命令”错误。

有没有其他方法可以在 emacs 模式下自动完成选项卡，即选项卡完成第一个区别？如果没有，如何在 ksh 中安装绑定？

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-19T00:57:55.490

`bind`是特定于 Bash/readline 的。

从[ksh 常见问题解答](http://kornshell.com/doc/faq.html)中，

```
Q6。ksh 是否支持文件名完成？
A6。是的，它确实。默认键绑定是 <ESC><ESC>
        但是，从“g”点版本开始，<TAB> 也可以使用
        完成。注意，vi用户需要设置-o viraw
        为了让 <TAB> 完成工作。

```

`ksh93g`于 1994 年 4 月 30 日发布，所以如果它不适合你，我会很惊讶......你的`ksh`版本是什么？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-03-29T17:12:43.510

如您所见，在 ksh93 中引入了键绑定，

> Q5。KornShell 1993 的主要新功能是什么？
> A5。唯一主要的新交互功能是键绑定。...（[KSH-93 常见问题解答](http://kornshell.com/doc/faq.html)）

在 emacs 模式下，点击

```
<ESC>= 
```

为您提供与您输入的文本相匹配的列表。

# php - PHP 应用程序中的多模块化页面

> ID：1015633
> 
> 赞同：0
> 
> 时间：2009-06-18T23:03:47.360
> 
> 标签：php, url, module

我目前正在编写一个适用于模块的应用程序。模块部分一切正常，但我并不完全清楚在同一页面上显示多个模块的最佳方法是什么。常见的类似 MVC 的系统可以工作的方式是，像“site.com/article/full/18543/how-to-lose-weight”这样的 URL（我并不是在暗示你的任何事情 :)）-> 会启动“文章" -module 并使用参数 "18543" 和 "how-to-lose-weight" 调用它的 "full" -method。

但是，我正在编写一个应用程序，我需要在同一页面上有多个模块。目前，我让用户创建、删除和修改页面。他有一个界面（GUI）来决定页面的外观。例如，他可以将页面命名为“文章”并使其看起来像一个两列布局，他希望在侧边栏的右侧有一个喊话框，而在主体（较大的列）上有文章。现在，我将如何去构建这样的 URL？我想保留我当前的页面系统，但我发现想出一个解决方案有点困难。您会看到，如果 URL 将加载“文章”模块，则不会加载喊话框。所以，我猜 URL 是对包含有关要加载哪些模块的信息的数据库条目的引用？这是我目前的想法。所以，

这导致我有两个问题/问题。首先，URL 的其余部分“/full/18543/how-to-lose-weight”会转到“article” - 模块还是“shoutbox” - 模块？我该如何确定？第二个问题是，如果这个“shoutbox”模块有一个注册帐户的链接而不是匿名发布，那么这个链接会将用户带到哪里？

我基本上是想找出一种在不同页面、模块和 URL 之间建立关系的好方法。

目前我有：处理外观和可以放置模块的可能位置的皮肤。页面告诉哪些模块在哪个“页面”中以及它们的位置（在皮肤中）。

现在我需要确定我使用 URL 的方式。欢迎任何帮助。:)

仅供参考：如果重要的话，我正在使用 PHP 和 MySQL ......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-18T23:07:13.653

我建议肯定会使用完整的 MVC 框架。如果这个（可以说是简单的）逻辑对你来说很麻烦，试着向巨头学习。

即使你只是潜入其中学习并回答他们的概念；你可能会好一点。

例如，如果需要，CakePHP 可以在 1 个视图中使用多个控制器。它还可以使用称为“元素”的东西，允许在更大的视图中构建小视图。

想想看 :) 没有直接需要完全连接 url 和你的控制器（这就是你的模块..）。此外，您需要确保您的模块不输出任何演示标记 (html)，这就是视图的工作。

# c# - 如何避免多个应用程序实例？

> ID：1015642
> 
> 赞同：1
> 
> 时间：2009-06-18T23:05:32.520
> 
> 标签：c#, dll, mutex

我有一个应用程序“myprogram.exe”，它调用 dll 中的函数和代码，其中一个“myprogram.exe”调用的函数创建了一个新的 winform 实例“MyForm.cs”，然后使用表单显示它。显示（）;。

我可以运行“n”个“myprogram.exe”实例，但我希望每个“myprogram.exe”实例只有一个“MyForm.cs”实例。

我遇到的问题是，即使我在“MyForm.cs”中使用互斥锁来创建互斥锁，他们也会询问它的实例是否已经在运行，有时，它会创建另一个实例，尽管有互斥锁。

是否有另一种方法可以用来验证“myprogram.exe”的实例是否已经创建了“MyForm.cs”的实例。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-19T09:43:20.577

根据@Joe 的评论，问题很可能出在 Mutux 的实现中。

[这个对另一个问题的回答](https://stackoverflow.com/questions/975250/reliably-detecting-that-another-of-my-applications-is-running/975272#975272)展示了正确的方法：

> K. Scott Allen 有[一篇很好的](http://odetocode.com/Blogs/scott/archive/2004/08/20/401.aspx)文章，介绍了为此目的使用 Mutex 以及您在使用 GC 时会遇到的问题。
> 
> > 如果我只想让应用程序的一个实例在机器上的所有会话中运行，我可以将命名互斥锁放入带有前缀“Global\”的全局命名空间中。
> > 
> > ```
> > [STAThread]
> > static void Main() 
> > {
> >    using(Mutex mutex = new Mutex(false, "Global\\" + appGuid))
> >    {
> >       if(!mutex.WaitOne(0, false))
> >       {
> >          MessageBox.Show("Instance already running");
> >          return;
> >       }
> > 
> > Application.Run(new Form1());
> >    }
> > } 
> > ```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-04-13T10:11:56.523

我在下面的链接发布，因为我在 C++ 和 MFC 中找不到任何相关文章。因此，对于 C++、MFC 和 Win32，您可以使用[http://flounder.com/nomultiples.htm](http://flounder.com/nomultiples.htm)

# .net - 派生类自定义序列化

> ID：1015644
> 
> 赞同：0
> 
> 时间：2009-06-18T23:06:09.257
> 
> 标签：.net

我有实现自定义序列化的 A 类

而且我有从 A 类派生的 B、C 和 D 类，它需要在派生类上实现 ISerializable，因为基础已经实现了自定义序列化。

这是我必须实施的事情吗？还是我错过了一些技术，可以让我在这种情况下使用派生类上的 [serializable] 属性使用默认序列化。

如果您遇到过类似的情况，请您分享一些经验。

在现实生活中，我不只有 B、C、D，我有大约 20 个不同的类用于将 A 传递给不同的应用程序和服务。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-18T23:13:33.657

这取决于您如何实现自定义序列化。如果您使用反射，请列出所有字段/属性 - 然后可能所有必需的代码都在“A”类中。

但是，如果“A”类仅序列化“A”类的字段/属性，那么您需要在派生类中进行额外操作。

# c# - 调试时如何在某个点中断循环？

> ID：1015646
> 
> 赞同：7
> 
> 时间：2009-06-18T23:06:43.967
> 
> 标签：c#, visual-studio-2008, debugging, breakpoints

环境：Visual Studio 2008 - C#

我有一个`for`在字符串数组上运行 1000 多次的。

当其中一个字符串与某个术语匹配时，我想让我的应用程序中断，这样我就可以在我的代码中遍历该点。

现在我知道我可以添加一段代码来查找这个和一个断点，但是在调试器中没有办法做到这一点吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-06-18T23:09:04.040

转到您的代码

1.  创建断点
2.  右击左边的红点
3.  选择*条件*
4.  输入类似*i == 1000*

或者

在你的循环中间

写

```
if (i == 1000){
  int a = 1;
} 
```

并突破 int a = 1;

第二种方法看起来更像垃圾，但我发现它更容易更快

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-06-18T23:09:01.873

是的，你可以在调试器中。它被称为“条件断点”。基本上，右键单击红色断点并转到“条件”选项。

一个快速的谷歌把[这个](http://msdn.microsoft.com/en-us/library/7sye83ce.aspx)和[这个](http://support.microsoft.com/kb/308469)：

PS最后一个是VS 2005，但2008年还是一样。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-18T23:09:50.140

在 Visual Studio 中，您可以设置条件断点 - 在要正常中断的点设置断点，然后右键单击左边距中的棕色圆圈并选择“条件断点...”或其他任何内容。然后，您输入一个表达式，当您想要中断时，该表达式的计算结果为真（例如 i == 1000，或 MyString = "hello world"）

# php - 用于 GMT 偏移的 php 日期和时间工具

> ID：1015647
> 
> 赞同：0
> 
> 时间：2009-06-18T23:06:45.903
> 
> 标签：php, database, utc, gmt

似乎有很多方法可以在 php 中处理日期和时间按摩。我通常只处理当地时间。今天，我需要在 UTC 工作。

我正在查询 API，他们给我的关于任意记录的数据是：created: Thu, 18 Jun 2009 21:44:49 +0000 * 记录为“UTC 记录创建时间”

utc_offset: -28800 * 用户之间的差异重新

我需要将其转换为一个简单的字符串，以向用户显示数据在其本地时间提交的时间和日期。

我相信，如果在加利福尼亚州，以上内容会转化为：2009 年 6 月 18 日星期四 02:44:49 PM

我的目标是获得一个可以传递给 date() 的时间值，以便以“漂亮”格式轻松格式化。

是否真的像将上面创建的时间从纪元转换为秒，添加偏移量，然后将其传递给 date() 一样简单？有什么哥特式要注意的吗？

```
$created_time = 'Thu, 18 Jun 2009 21:44:49 +0000';
$utc_offset = -28800;
$seconds = strtotime($created_time);
$localized_time = $seconds + $utc_offset;

echo date(DATE_RFC822, $localized_time); 
```

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-18T23:10:15.850

PHP 应该自动为您做事。我也强烈推荐使用 DateTime 对象。

 ``$dt = new DateTime($created_time); echo $dt->format(DATE_RFC2822);`  `PHP 的日期和时间函数可以识别时区。确保您使用的是最新版本的 PHP，因为在改进这些系统方面已经做了很多工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T01:40:20.163

您可以使用[date_default_timezone_set](http://php.net/date_default_timezone_set)在时区之间切换。在您的情况下，您将从用户的个人资料中传递时区信息。正如 Evert 建议的那样，如果您使用的是 PHP 5>=5.2，请使用更高级的[DateTime](http://php.net/manual/en/book.datetime.php)类。

```
<?php
echo date('h:i:s')."\n";
date_default_timezone_set('Europe/Paris');
echo date('h:i:s')."\n";
date_Default_timezone_set('UTC');
echo date('h:i:s')."\n"; 
`````

# visual-studio-2008 - 如何分发使用 Team Foundation Server API 的服务？

> ID：1015648
> 
> 赞同：5
> 
> 时间：2009-06-18T23:07:01.690
> 
> 标签：visual-studio-2008, tfs

有大量使用 TFS API 创建工作项的优秀示例，这些都打包为 VS 2008 SDK 的一部分。所以，想象一下我创建了一个简单的 Web 服务，它需要一些信息，然后创建一个工作项。

一切都在本地运行得很好，但是如果我想将该 Web 服务部署到其他地方怎么办？在本地，我只是参考：

1) Microsoft.TeamFoundation.Client
2) Microsoft.TeamFoundation.WorkItemTracking.Client

有没有人幸运地弄清楚如何在没有安装 Visual Studio 或 VS SDK 的机器上使用这些库部署库或服务？是否有某种可再发行的 TFS SDK 可用？可能是一些许可原因？

顺便说一句，如果我只是将这些 dll 复制到 Web 服务器，我会收到以下错误：

System.InvalidProgramException：公共语言运行时检测到无效程序。

伊克。

提前致谢！

*编辑：* 值得注意的是，[这个人有完全相同的问题](http://forums.asp.net/p/1270758/2401344.aspx)，没有解决方案......

*编辑：* 叹息。谷歌搜索/黑客攻击了三个小时，然后发布了这个，然后五分钟后找到了我认为的答案。 [必须安装团队资源管理器？](http://social.msdn.microsoft.com/Forums/en-US/tfsworkitemtracking/thread/651f1ca7-45fa-443f-835c-a6b331f99e43) 可验证？

***最后编辑：* 是的，就是这样。安装团队资源管理器并离开它......**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-18T23:31:31.080

是的，我认为没有 TFS 可再发行版。您可以下载并安装[资源管理器客户端](http://www.microsoft.com/downloads/details.aspx?displaylang=en&FamilyID=0ed12659-3d41-4420-bbb0-a46e51bfca86)，但您仍需要拥有与该安装相关的许可证 (CAL)。

**编辑：这不再正确（2014 年）。**正如@LordHits 的回答所暗示的那样，微软现在为此提供了一个可再发行产品，明确标明“免费”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-13T20:12:35.277

以下 2 个链接可被视为 TFS 的“可再发行组件”：

[对于 TFS 2010 SP1](http://visualstudiogallery.msdn.microsoft.com/a37e19fb-3052-4fc9-bef7-4a4682069a75)

[对于 TFS 2012 更新 4](http://visualstudiogallery.msdn.microsoft.com/f30e5cc7-036e-449c-a541-d522299445aa)

# bing - Bing 在什么平台和软件堆栈上运行？

> ID：1015651
> 
> 赞同：5
> 
> 时间：2009-06-18T23:07:29.677
> 
> 标签：bing

著名的必应在运行什么？Asp.net、asp.net mvc、IIS 7、.net 3.5？使用 firebug，我想我可以分辨出 Bing 的驱动力，因为我注意到 Bing 和 Live.com 之间的速度差异。但是，不幸的是，在 firebug 中查看 HTTP 标头不会产生服务器端信息。所以你怎么看。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2011-02-23T21:08:41.897

谜团解开了——地球上排名前 5 的站点之一在 MVC/IIS 上运行。

ScottGu 在上周 MvcConf 的主题演讲中证实了这一点：

[http://channel9.msdn.com/Series/mvcConf/mvcConf-2011-Scott-Guthrie-Keynote](http://channel9.msdn.com/Series/mvcConf/mvcConf-2011-Scott-Guthrie-Keynote)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-18T23:13:13.720

Netcraft[表示](http://toolbar.netcraft.com/site_report?url=bing.com)在 Windows 2003 上运行的未知 Web 服务器（www.bing.com 表示 Linux，但也指出 www 由 Akamai 运行）。作为微软，这有点可疑，但也要考虑到微软现有的堆栈似乎都不适合谷歌级搜索的高度专业化领域。在这种特殊情况下，与产品协同作用相比，微软似乎确实更重视提供实际有效的东西（不像 Live.com）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-25T21:38:57.270

[httprecon](http://www.computec.ch/projekte/httprecon/?)显示了 100% 的匹配`Microsoft IIS 6.0`值。

编辑：[直接链接](http://w3dt.net/tools/httprecon/?host=www.bing.com&submit=Analyze)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-14T05:02:49.257

Bing.com 发布了一堆关于它的动力的图表和数据。基本上它是一个常规的 ASP.NET MVC 应用程序。向您展示管理代码的性能如何。

[http://blogs.technet.com/b/windowsserver/archive/2012/06/07/bing-com-runs-on-windows-server-2012.aspx](http://blogs.technet.com/b/windowsserver/archive/2012/06/07/bing-com-runs-on-windows-server-2012.aspx)

# jquery - 使用 jQuery 计算子元素的总宽度

> ID：1015669
> 
> 赞同：17
> 
> 时间：2009-06-18T23:12:48.807
> 
> 标签：jquery, css, dynamic, layout

我试图找到一个可以理解的答案，但放弃了。

为了在**水平网站**（如[thehorizo​​ntalway.com上）中拥有](http://www.thehorizontalway.com/)**动态**内容（如博客文章和图像），您必须为 BODY 设置固定宽度（以像素为单位），对吗？*因为您在其中使用浮动元素，否则会破坏并包裹页面，具体取决于浏览器的宽度。*

 *****编辑！**这个特定的值可以用**jQuery***计算*，谢谢 :) 在这个例子中，一个附加值被添加到总大小，它可以用于浮动元素之前的内容。现在身体得到了一个动态的宽度！

 **我最初的想法是让 jQuery 为我们计算这个：（'EACH POSTS WIDTH' * 'NUMBER OF POSTS'）+ 250（用于额外内容）

HTML 代码

```
<body style="width: ;"> <!-- Here we want a DYNAMIC value -->
<div id="container">
    <div id="menu"></div> <!-- Example of extra content before the floats -->
    <div class="post">Lorem</div>
    <div class="post">Lorem</div>
    <div class="post">Lorem</div> <!-- Floated elements that we want the sizes of -->
    <div class="post">Lorem</div>
</div>
...
<!-- So if these posts were 300px exept the last that was 500px wide, then the BODY WIDTH should be ( 300+300+300+500 ) + 250 [#menu] = 1650px --> 
```

Alconja的结果和答案

```
$(document).ready(function() {
var width = 0;
$('.post').each(function() {
    width += $(this).outerWidth( true );
});
$('body').css('width', width + 250);
}); 
```

非常感谢！

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-06-18T23:50:30.353

看起来你已经很正确了......不过有几点注意事项：

*   `.outerWidth(true)`包括填充和边距（因为你正在传递`true`），所以没有必要再次尝试并添加它。
*   `.outerWidth(...)`仅返回第一个元素的宽度，因此如果每个元素的大小不同，则将其乘以帖子数将不是总宽度的准确值。

考虑到这一点，这样的事情应该会给你你所追求的（保持你的 250 初始填充，我认为这是用于菜单和东西？）：

```
var width = 0;
$('.post').each(function() {
    width += $(this).outerWidth( true );
});
$('body').css('width', width + 250); 
```

这有帮助吗，还是您遇到其他一些具体问题（从您的问题中不太清楚）？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-06-17T00:02:58.463

你可以用这个单线计算宽度，虽然比我想要的长一点。

```
var width = $('.post').map(function(undefined, elem) {
    return $(elem).outerWidth(true);
}).toArray().reduce(function(prev, curr) {
    return prev + curr;
}, 0); 
```*****

# sql-server-2008 - 在 sql server 2008 中设置 newsequentialid() 默认值时出错

> ID：1015676
> 
> 赞同：12
> 
> 时间：2009-06-18T23:14:45.433
> 
> 标签：sql-server-2008

我在表中有一个 uniqueidentifier 列，它不是键或索引。我想使用 NEWSEQUENTIALID() 设置默认值，但出现错误：

> 验证列的默认值时出错..

但是如果我使用 NEWID() 没有错误。这是怎么回事？

编辑：您可以忽略错误对话框并继续。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2011-09-05T14:47:11.693

***引用[这个问题](https://stackoverflow.com/questions/2837559/autoincrement-uniqueidentifier-in-c)的公认答案。***

> 解决方法：在不指定任何默认值的情况下创建表，然后在普通查询窗口中键入此 T-SQL 语句并运行它：
> 
> ```
> ALTER TABLE dbo.YourTable
>     ADD CONSTRAINT DF_SerialID DEFAULT newsequentialid() FOR SerialID 
> ```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-06-19T19:13:58.827

这是设计器中的一个错误，微软没有修复。

[http://social.msdn.microsoft.com/Forums/en-US/sqltools/thread/cad8a4d7-714f-44a2-adb0-569655ac66e6](http://social.msdn.microsoft.com/Forums/en-US/sqltools/thread/cad8a4d7-714f-44a2-adb0-569655ac66e6)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-18T23:32:36.863

根据文档： http: [//msdn.microsoft.com/en-us/library/ms189786.aspx](http://msdn.microsoft.com/en-us/library/ms189786.aspx) 备注部分：

...**在 DEFAULT 表达式中使用 NEWSEQUENTIALID() 时，它不能与其他标量运算符结合使用。例如，您不能执行以下操作：**

CREATE TABLE myTable (ColumnA uniqueidentifier DEFAULT dbo.myfunction(NEWSEQUENTIALID())) ...

这是否回答你的问题？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-03-06T08:42:42.720

这是不正确的。

请按照此处的步骤操作：

[http://www.geekinterview.com/question_details/31705](http://www.geekinterview.com/question_details/31705)

# linux - 在 Linux 上的目录中获取最新文件

> ID：1015678
> 
> 赞同：246
> 
> 时间：2009-06-18T23:15:19.567
> 
> 标签：linux, shell, command-line

寻找将返回目录中单个最新文件的命令。

没有看到限制参数`ls`...

* * *

## 回答 #1

> 赞同：365
> 
> 时间：2009-06-18T23:17:57.033

```
ls -Art | tail -n 1 
```

不是很优雅，但它有效。

使用的标志：

`-A``.`列出除和之外的所有文件`..`

`-r`排序时倒序

`-t`按时间排序，最新的在前

* * *

## 回答 #2

> 赞同：216
> 
> 时间：2009-06-18T23:18:55.613

```
ls -t | head -n1 
```

该命令实际上给出了当前工作目录中最新修改的文​​件。

* * *

## 回答 #3

> 赞同：123
> 
> 时间：2014-04-12T18:15:04.773

这是一个递归版本（即它在某个目录或其任何子目录中找到最近更新的文件）

```
find /dir/path -type f -printf "%T@ %p\n" | sort -n | cut -d' ' -f 2- | tail -n 1 
```

命令行的简要外行解释：

*   `find /dir/path -type f`查找目录中的所有文件
    *   `-printf "%T@ %p\n"`为每个文件打印一行，其中`%T@`是自 1970 纪元以来的浮点秒数，`%p`是文件名路径，`\n`是换行符
    *   欲了解更多信息，请参阅`man find`
*   `|`是一个外壳`pipe`（参见`man bash`关于 的部分`Pipelines`）
*   `sort -n`表示对第一列进行排序并将标记视为数字而不是字典（请参阅`man sort`）
*   `cut -d' ' -f 2-`表示使用字符分割每一行，然后打印从第二个标记开始的所有标记（请参阅`man cut`）
    *   注意：`-f 2`只会打印第二个令牌
*   `tail -n 1`表示打印最后一行（参见`man tail`）

* * *

## 回答 #4

> 赞同：23
> 
> 时间：2016-08-17T12:28:58.373

关于可靠性的说明：

由于换行符与文件名中的任何字符一样有效，因此任何依赖于/等*行*的解决方案都是有缺陷的。`head``tail`

使用 GNU `ls`，另一种选择是使用`--quoting-style=shell-always`选项和`bash`数组：

```
eval "files=($(ls -t --quoting-style=shell-always))"
((${#files[@]} > 0)) && printf '%s\n' "${files[0]}" 
```

（如果您还想考虑隐藏文件，请添加`-A`选项）。`ls`

如果你想限制常规文件（忽略目录、fifos、设备、符号链接、套接字......），你需要求助于 GNU `find`。

使用 bash 4.4 或更新版本（for `readarray -d`）和 GNU coreutils 8.25 或更新版本（for `cut -z`）：

```
readarray -t -d '' files < <(
  LC_ALL=C find . -maxdepth 1 -type f ! -name '.*' -printf '%T@/%f\0' |
  sort -rzn | cut -zd/ -f2)

((${#files[@]} > 0)) && printf '%s\n' "${files[0]}" 
```

或递归：

```
readarray -t -d '' files < <(
  LC_ALL=C find . -name . -o -name '.*' -prune -o -type f -printf '%T@%p\0' |
  sort -rzn | cut -zd/ -f2-) 
```

最好的方法是使用`zsh`它的 glob 限定符，而不是`bash`避免所有这些麻烦：

当前目录中最新的常规文件：

```
printf '%s\n' *(.om[1]) 
```

包括隐藏的：

```
printf '%s\n' *(D.om[1]) 
```

第二个最新：

```
printf '%s\n' *(.om[2]) 
```

符号链接解析后检查文件年龄：

```
printf '%s\n' *(-.om[1]) 
```

递归：

```
printf '%s\n' **/*(.om[1]) 
```

此外，在`compinit`启用完成系统（和 co）的情况下，`Ctrl+X``m`成为扩展为最新文件的完成程序。

所以：

```
六Ctrl+Xm
```

会让你编辑最新的文件（你也有机会在按下之前查看它`Return`）。

```
六Alt+2Ctrl+Xm
```

对于第二个最新的文件。

```
vi *.cCtrl+Xm
```

对于最新的`c`文件。

```
六 *(.)Ctrl+Xm
```

对于最新的*常规*文件（不是目录，也不是 fifo/设备...），依此类推。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2012-04-29T15:31:21.813

我用：

`ls -ABrt1 --group-directories-first | tail -n1`

它只给了我文件名，不包括文件夹。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2009-06-18T23:21:35.640

`ls -lAtr | tail -1`

其他解决方案不包括以`'.'`.

此命令还将包括`'.'`and `'..'`，这可能是也可能不是您想要的：

`ls -latr | tail -1`

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2013-12-10T00:34:56.117

我喜欢 `echo *(om[1])`（`zsh`语法），因为它只给出文件名并且不调用任何其他命令。

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2015-03-13T17:46:14.997

在文件数量变得非常大（如整个文件系统）之前，查找/排序解决方案非常有效。使用 awk 来跟踪最新的文件：

```
find $DIR -type f -printf "%T@ %p\n" | 
awk '
BEGIN { recent = 0; file = "" }
{
if ($1 > recent)
   {
   recent = $1;
   file = $0;
   }
}
END { print file; }' |
sed 's/^[0-9]*\.[0-9]* //' 
```

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2016-09-07T15:41:48.250

根据 dmckee 的回答缩短变体：

```
ls -t | head -1 
```

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2020-03-17T13:19:51.040

如果您想获取最新更改的文件，还包括任何子目录，您可以使用这个小的 oneliner：

```
find . -type f -exec stat -c '%Y %n' {} \; | sort -nr | awk -v var="1" 'NR==1,NR==var {print $0}' | while read t f; do d=$(date -d @$t "+%b %d %T %Y"); echo "$d -- $f"; done 
```

如果您不想对已更改的文件执行相同的操作，但对于访问的文件，您只需更改

**%Y**参数从**stat**命令到**%X**。您最近访问的文件的命令如下所示：

```
find . -type f -exec stat -c '%X %n' {} \; | sort -nr | awk -v var="1" 'NR==1,NR==var {print $0}' | while read t f; do d=$(date -d @$t "+%b %d %T %Y"); echo "$d -- $f"; done 
```

对于这两个命令，如果您想列出多个文件，也可以更改**var="1"参数。**

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2014-10-01T09:53:29.723

我个人更喜欢尽可能少地使用非内置`bash`命令（以减少昂贵的 fork 和 exec 系统调用的数量）。`ls`按需要调用的日期排序。但是使用 of`head`并不是真正必要的。我使用以下单线（仅适用于支持名称管道的系统）：

```
read newest < <(ls -t *.log) 
```

或获取最旧文件的名称

```
read oldest < <(ls -rt *.log) 
```

（注意两个“<”标记之间的空格！）

如果还需要隐藏文件 - 可以添加 arg。

我希望这会有所帮助。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2018-02-01T08:54:10.553

使用 R 递归选项 .. 您可以将其视为在此处获得良好答案的增强

```
ls -arRtlh | tail -50 
```

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2020-07-08T15:17:08.473

只有 Bash 内置，紧跟[BashFAQ/003](https://mywiki.wooledge.org/BashFAQ/003)：

```
shopt -s nullglob

for f in * .*; do
    [[ -d $f ]] && continue
    [[ $f -nt $latest ]] && latest=$f
done

printf '%s\n' "$latest" 
```

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2014-07-31T07:07:15.470

试试这个简单的命令

```
ls -ltq  <path>  | head -n 1 
```

如果您想要文件名 - 最后修改，路径 = /ab/cd/*.log

如果您想要目录名称 - 最后修改，路径 = /ab/cd/*/

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2014-11-21T04:05:01.150

```
ls -t -1 | sed '1q' 
```

将显示文件夹中最后修改的项目。配对`grep`以查找带有关键字的最新条目

```
ls -t -1 | grep foo | sed '1q' 
```

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2016-11-17T10:52:13.943

递归：

```
find $1 -type f -exec stat --format '%Y :%y %n' "{}" \; | sort -nr | cut -d: -f2- | head 
```

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2016-04-25T12:22:20.673

根据模式在每个目录中查找最新文件，例如名称以“tmp”结尾的工作目录的子目录（不区分大小写）：

```
find . -iname \*tmp -type d -exec sh -c "ls -lArt {} | tail -n 1" \; 
```

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2018-01-26T05:29:15.323

假设您不关心以 a 开头的隐藏文件`.`

```
ls -rt | tail -n 1 
```

除此以外

```
ls -Art | tail -n 1 
```

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2019-04-15T16:56:26.543

```
ls -Frt | grep "[^/]$" | tail -n 1 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2014-10-24T13:50:56.040

所有这些 ls/tail 解决方案对于目录中*的*文件都非常有效- 忽略子目录。

为了在搜索中包含所有文件（递归），可以使用 find 。gioele 建议对格式化的查找输出进行排序。但要小心空格（他的建议不适用于空格）。

这应该适用于所有文件名：

```
find $DIR -type f -printf "%T@ %p\n" | sort -n | sed -r 's/^[0-9.]+\s+//' | tail -n 1 | xargs -I{} ls -l "{}" 
```

这按 mtime 排序，请参阅 man find：

```
%Ak    File's  last  access  time in the format specified by k, which is either `@' or a directive for the C `strftime' function.  The possible values for k are listed below; some of them might not be available on all systems, due to differences in `strftime' between systems.
       @      seconds since Jan. 1, 1970, 00:00 GMT, with fractional part.
%Ck    File's last status change time in the format specified by k, which is the same as for %A.
%Tk    File's last modification time in the format specified by k, which is the same as for %A. 
```

所以只需替换`%T`为`%C`按 ctime 排序。

* * *

## 回答 #21

> 赞同：-1
> 
> 时间：2014-10-21T01:15:31.660

我也需要这样做，我找到了这些命令。这些对我有用：

如果您希望最后一个文件在文件夹中的创建日期（访问时间）：

```
ls -Aru | tail -n 1 
```

如果您想要最后一个内容发生变化的文件（修改时间）：

```
ls -Art | tail -n 1 
```

# php - 托管传输后，ExpressionEngine 无法正常运行

> ID：1015679
> 
> 赞同：3
> 
> 时间：2009-06-18T23:15:24.917
> 
> 标签：php, iis-6, windows-server-2003, fastcgi, expressionengine

刚刚将一个 Expression Engine 网站转移到一个新的托管环境。新服务器是 Windows 2003 Standard，通过 FastCGI 和 IIS 6 运行 PHP 5.2.44。其他 PHP 站点在此服务器上运行良好（WordPress、CMSMadeSimple 等）。这是我们合作过的第一个 ExpressionEngine 站点。我们已经恢复了数据库，为其设置了用户帐户，并更新了 encore_admin/config.php 文件中的配置设置。我们使用与 MySQL Query Browser 相同的信息测试了数据库连接，没有任何问题。这是 URL，因此您可以看到我们遇到的问题：

[http://encorellc.digitalaspire.com](http://encorellc.digitalaspire.com)

[http://encorellc.digitalaspire.com/encore_admin/](http://encorellc.digitalaspire.com/encore_admin/)

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-08-13T10:39:11.813

不清楚您遇到了什么问题，但您可以尝试运行他们的[服务器测试](http://expressionengine.com/overview/requirements/)，这应该指出任何服务器不兼容问题

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-09-17T16:45:06.110

path.php 和/或 config.php 中的变量可能未正确填写

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-28T20:50:26.923

我遇到了类似的问题。

查看[这篇](http://expressionengine.com/wiki/Moving_Servers_-_A_Robust_Method/)关于迁移服务器的文章 - 它可以帮助您解决问题。

如果您遇到与我相同的问题，则问题通常是路径和存储在 EE 数据库中的字符串长度，特别是在 exp_sites 表中。

# sql-server - 如何将不一致的 nvarchar 数据读取为十进制数据

> ID：1015682
> 
> 赞同：0
> 
> 时间：2009-06-18T23:16:51.140
> 
> 标签：sql-server, tsql, reporting-services, reportingservices-2005

对于 SSRS 2005 报告，我如何从数据库中读取不一致的 nvarchar 数据值作为绘制折线图的一致数字十进制数据？

nvarchar 列的实验室读数以 nvarchar(15) 数据类型绘制在图表上。

数据不一致的示例列，如图所示

示例列值：00123 102 (NULL) 333 456 N/R 无结果 567 589

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-18T23:26:58.810

你可以试试

```
SELECT CASE WHEN ISNUMERIC(nvCol) THEN CAST(nvCol as DECIMAL(15,0))
    ELSE 0.0 END as DecData
FROM YourTable 
```

ISNUMERIC 可能对您来说太笼统了（它允许一些非常奇怪的“数字”），如果是这样，那么您可能需要添加自己的条件来过滤。您还必须正确设置 DECIMAL 的大小。最后，您可能更喜欢检查 WHERE 子句以过滤掉这些行，而不是将它们默认为 0.0。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T02:25:13.443

使用数据库去

select convert(decimal (10,2), ltrim(rtrim(columnname))) from table where isumeric(columnname) = 1 and ltrim(rtrim(columnname)) <> '.'

# c# - 是否可以确定一个对象是否被另一个对象引用？

> ID：1015683
> 
> 赞同：1
> 
> 时间：2009-06-18T23:17:28.313
> 
> 标签：c#

我的 C# 程序中存在内存泄漏，无法确定谁持有对我的对象的引用。有没有办法在运行时确定哪些对象持有对特定对象的引用？

在这种经济环境中，我的预算为零，因此本地或免费解决方案是我唯一的选择。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-18T23:20:37.230

查看[.NET 内存分析器](http://memprofiler.com/)。他们有 14 天的免费试用期（因此您的预算是安全的）。功能页面的摘录...

> 对于托管类型实例，会显示以下附加信息：
> 
> *   来自和到实例的引用

根据评论：同意 100% ......非常值得非常合理的许可费。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-18T23:32:17.987

如需免费工具，请查看[此处](http://blogs.msdn.com/ricom/archive/2004/12/10/279612.aspx)。本文讨论如何使用 MS 的免费工具 (windbg/sos) 来查找托管代码中的内存泄漏。界面并不漂亮，但它完成了工作。这是[windbg](http://www.microsoft.com/whdc/DevTools/Debugging/debugstart.mspx)的链接。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-18T23:42:32.413

我从这里学习了如何调试内存泄漏问题 [http://blogs.msdn.com/tess/archive/2008/03/17/net-debugging-demos-lab-6-memory-leak.aspx](http://blogs.msdn.com/tess/archive/2008/03/17/net-debugging-demos-lab-6-memory-leak.aspx)

使用 windows 的调试工具

学习曲线相当陡峭，但一旦你掌握了它，这是一项很棒的技能

# sql - SQL - SELECT MAX() 和伴随的字段

> ID：1015689
> 
> 赞同：6
> 
> 时间：2009-06-18T23:19:43.880
> 
> 标签：sql, database, join

我所拥有的基本上是一个可以通过多个表轻松解决的问题，但我只有一个表可以解决。

考虑以下数据库表

```
UserID UserName EmailAddress         Source
3K3S9  Ben      ben@myisp.com        user
SF13F  Harry    lharry_x@hotbail.com 3rd_party
SF13F  Harry    reside@domain.com    user
76DSA  Lisa     cake@insider.com     user
OL39F  Nick     stick@whatever.com   3rd_party
8F66S  Stan     myman@lol.com        user 
```

我需要选择所有字段，但只选择每个用户一次以及他们的一个电子邮件地址（由 MAX() 函数确定的“最大”一个）。这是我追求的结果...

```
UserID UserName EmailAddress         Source
3K3S9  Ben      ben@myisp.com        user
SF13F  Harry    lharry_x@hotbail.com 3rd_party
76DSA  Lisa     cake@insider.com     user
OL39F  Nick     stick@whatever.com   3rd_party
8F66S  Stan     myman@lol.com        user 
```

如您所见，“Harry”只显示一次，他的“最高”电子邮件地址是相应的“来源”

目前正在发生的事情是我们正在对 UserID、UserName 进行分组，并对 EmailAddress 和 Source 使用 MAX()，但是这两个字段的最大值并不总是匹配，它们需要来自同一记录。

我尝试了另一个过程，将表格与自身连接起来，但我只设法获得了正确的电子邮件地址，而不是该地址的相应“来源”。

任何帮助将不胜感激，因为我已经花了太长时间试图解决这个问题:)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-18T23:28:10.603

如果您使用的是 SQL Server 2005 或更高版本，

```
SELECT  UserID, UserName, EmailAddress, Source
FROM    (SELECT UserID, UserName, EmailAddress, Source,
                ROW_NUMBER() OVER (PARTITION BY UserID
                                   ORDER BY EmailAddress DESC) 
                    AS RowNumber
         FROM   MyTable) AS a
WHERE   a.RowNumber = 1 
```

当然，有一些方法可以在没有（SQL 标准）排名函数的情况下完成相同的任务，例如SQL Server 自 2005 年以来才实现的 - 包括嵌套的依赖查询和带有“>”的`ROW_NUMBER`自左连接和一个技巧 - - 但是排名函数使得代码可读并且（理论上）可以被 SQL Server 引擎很好地优化。`ON``WHERE ... IS NULL`

编辑：[这篇文章](http://weblogs.sqlteam.com/jeffs/archive/2007/03/28/60146.aspx)是一个很好的排名教程，但它`RANK`在示例中使用而不是`ROW_NUMBER`（或其他排名函数，`DENSE_RANK`） - 当根据排序标准在同一分区中的分组行之间存在“联系”时，区别很重要. [这篇文章](http://thehobt.blogspot.com/2009/02/rownumber-rank-and-denserank.html)很好地解释了差异。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-18T23:24:54.993

```
select distinct * from table t1
where EmailAddress = 
(select max(EmailAddress) from table t2
where t1.userId = t2.userId) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-18T23:31:21.983

```
select distinct
     *  
from    
   SomeTable a
inner join (
  select max(emailAddress), userId
  from
     SomeTable 
  group by 
     userId
) b on a.emailAddress = b.emailAddress and a.userId = b.userId 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-02-27T01:32:28.357

我想我有一个与已经提出的解决方案不同的解决方案：

```
选择 *
来自 foo
其中 id = (
  选择编号
  来自 foo F
  其中 F.bar = foo.bar
  由 F.baz 订购
  限制 1
)

```

这将为您提供与具有相同条形的其他 foo 记录相比具有最大 baz 的所有 foo 记录。

# asp.net-mvc - ASP.NET Web 应用程序开发：向承包商/自由职业者隐藏敏感信息

> ID：1015697
> 
> 赞同：3
> 
> 时间：2009-06-18T23:22:00.210
> 
> 标签：asp.net-mvc, security

我正在开发一个使用 Amazon Web Services 的 Web 应用程序。我正在使用 ASP.NET MVC。我还使用了几个 Amazon Web 服务，包括 S3、EC2 和 SQS。我计划聘请自由职业者来帮助开发。现在，我将 Amazon Web Service 密钥和密码放在 web.config 文件中，并将其连接到我的信用卡。我正在使用托管的 SVN 源代码控制和 TeamCity 进行自动构建和测试。

问题是，有没有办法让自由职业者在不知道 AWS 密钥和机密等敏感信息的情况下签出代码并进行测试？我应该把它放在不同的文件中吗？我应该把它放在数据库中并加密吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-18T23:45:31.673

1.  为您的开发提供一个测试帐户并将其提供给您的自由职业者
2.  [您可以按照此处](http://odetocode.com/Blogs/scott/archive/2006/01/08/2707.aspx)提到的步骤加密 web.config 的部分
3.  您可以将密钥移动到代码中并将图层编译为 dll 并将其提供给开发人员

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-18T23:30:54.963

自由职业者的问题是他们通常可以访问王国的钥匙。在 .net 中，您可以将所有想要保密的东西扔到一个单独的程序集中……但这可以逆转和打开。您可以将数据保存为加密格式，但在某个时间点，您必须让他们访问解密算法，以便他们在与这些服务交谈时可以使用解密的数据。如果你有一个开发人员的商店，你总是可以创建一个在自由职业者代码和你的服务层之间交互的包装器，从而在一定程度上保护你的代码和敏感数据免受不受信任的自由职业者的侵害。

最简单的方法是使用传统的抽象层。不要让你的自由职业者深入访问你的代码库，你应该很好。在您的声明中，您说您使用的是公共 SVN，这意味着您可能需要多个存储库。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-19T00:29:23.940

不要轻易解决这个问题——你不能在不花更多时间的情况下向开发人员隐藏你的密钥。如果它存储在 DLL 中，他们可以使用 Reflector 等工具对 DLL 进行反编译。如果它在 web.config 中加密，但在其他需要使用它的地方解密，他们可以使用代理工具监控网络流量，或附加调试器。虽然建议的方法对于防止密钥的意外盗窃很有用，例如由典型用户盗窃，但决心找出并有权运行您的代码的技术人员通常可以找到一种方法来获得他们想要的东西。

尝试雇用您可以信任的人。如果必须，请进行背景调查。

如果您确实需要隐藏您的密钥，请将使用它的代码保存在开发人员无法访问的单独系统上，除非通过精心设计的安全界面。基本上，您最终将通过另一个 Web 服务代理对 AWS 的访问。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-20T19:35:12.617

法律保护是您的朋友。让律师为您起草一份合同，包括保护条款和违规处罚。此外，如果您需要足够的自由职业者帮助，那么看看一家公司提供的服务可能比自由职业者的角度更安全一些。

如果做不到这一点，Rony 的第一点很好——获得第二个非生产帐户。老实说，无论如何您都应该有一个用于暂存和测试，因为您可能不希望未经测试的代码与生产数据一起玩。AWS 的真正开销在于带宽而不是单纯的存储，所以它不应该花费太多。

另一个角度，取决于您使用多少服务 API 以及您作为编码人员的技能，将抽象您自己的存储接口后面的 S3 位。为开发人员提供非 S3 支持的实现，同时将您的 s3 支持的实现保留在他们无权访问的单独存储库中，然后在适当的时候切换到 s3 支持的选项。这具有长期优势，例如在需要时可以轻松切换存储提供商。

# windows - 用于创建简单 Microsoft Windows GUI 的 Perl 模块？

> ID：1015699
> 
> 赞同：6
> 
> 时间：2009-06-18T23:23:00.487
> 
> 标签：windows, perl, user-interface

我想为我的 Perl 程序创建一个简单的 Windows GUI。它基本上需要生成一个窗口，将日志信息写入文本框，并有一个输入框和几个开始/停止按钮。

有人对我使用哪些 Perl 模块有任何提示吗？与我一起工作的人喜欢 Qt，所以这可能是一种偏好，但我并不在意。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-18T23:40:32.107

对于这样一个简单的项目，我确实使用过一次[Win32::GUI 。](http://search.cpan.org/~robertmay/Win32-GUI-1.06/docs/GUI.pod)主窗口有一个菜单、一个文本框和几个按钮和复选框。有效。

设置 GUI 的方法的摘录（只是给你一个想法）：

```
my @menu_items = (
    '&File' => 'File',
    ' > &Open'   => {
        -name    => 'FileOpen', 
        -onClick => sub { $self->onFileOpen(@_) },
    },
    ' > &Close'  => { 
        -name    => 'FileClose',
        -onClick => sub { $self->onFileClose(@_) },
    },
    ' > E&xit'   => { 
        -name    => 'FileExit',
        -onClick => sub { $self->onFileExit(@_) },
    },
    '&Help' => 'Help',
    ' > &About'  => { 
        -name    => 'About',
        -onClick => sub { $self->onHelpAbout(@_) },
    },
);

$self->set_main_menu( Win32::GUI::MakeMenu(@menu_items) );

my $window = $self->set_main_window(
    Win32::GUI::Window->new(
        -menu => $self->get_main_menu,
        -name => 'Main',
        -sizable => 0,
        -resizable => 0,
        -hasmaximize => 0,
        -maximizebox => 0,
        -title => $self->get_program_name,
        -onTerminate => sub { -1 }, 
        -onTimer => sub { $self->onTimer(@_) },
    ),
);

$self->set_log_field(
    $window->AddTextfield(
        -name => 'Log',
        -font => Win32::GUI::Font->new(
            -name => 'LogFont',
            -face => 'Courier New',
            -size => 9,
        ),
        -multiline => 1,
        -wantreturn => 1,
        -autovscroll => 1,
        -vscroll => 1,
        -readonly => 1,
    ),
);

$self->get_log_field->MaxLength(40000);

$self->set_status_bar(
    $window->AddStatusBar(
        -name => 'Status',
        -text => $self->get_program_name,
    ),
); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-18T23:41:32.790

你有几个选择：

*   [总热量](http://search.cpan.org/dist/Tk/pod/overview.pod)
*   [gtk2](http://search.cpan.org/dist/Gtk2/Gtk2.pm)
*   [Qt](http://search.cpan.org/dist/QtGui/lib/QtGui.pm)
*   [无锡](http://search.cpan.org/dist/Wx/Wx.pm)
*   [Win32::图形界面](http://search.cpan.org/dist/Win32-GUI/docs/GUI.pod)

我偏爱Gtk2。它可以通过[CamelBox](http://code.google.com/p/camelbox/)安装程序轻松安装在 MS Windows 中。

一个简单的“hello world”风格的应用程序看起来像

```
#!/usr/bin/perl

use strict;
use warnings;

use Gtk2;

Gtk2->init;

my $window = Gtk2::Window->new;
my $vbox   = Gtk2::VBox->new;
my $label  = Gtk2::Label->new("Hello World");
my $button = Gtk2::Button->new("Press me");

$window->add($vbox);
$vbox->add($label);
$vbox->add($button);

my $i;
$button->signal_connect(clicked => sub {
    $label->set_text("button pressed " . ++$i . " times");
});

$window->signal_connect(destroy => sub { Gtk2->main_quit });

$window->show_all;

Gtk2->main; 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-18T23:40:12.700

Activestate 的 Perl 5.10 预编译了 Tkx，这是一个 Gui 平台。如果您想要一个包含更多网络示例的模块，您可以下载 Perl Tk。无论您使用哪个模块，您都可以从 sourceforge 下载[GUIbuilder](http://sourceforge.net/project/showfiles.php?group_id=24918&package_id=219784)，它为 perl 编写了非常好的 Tk 或 Tkx 代码，为 python、ruby 编写了 Tk 代码。

该代码主要由 GuiBuilder 生成，作为输出代码的示例：

```
use Tkx;
Tkx::package_require('BWidget');

sub example::ui {
     my($root) = @_;

     my($_entry_box) = $root->new_entry(
     -width => 0,
     );
     my($_text_box) = $root->new_text(
         -height => 0,
         -width => 0,
     );
     my($_label) = $root->new_label(
          -text => "Hello World",
     );
     my($_textbox_horiz_scrollbar) = $root->new_scrollbar(
          -orient => "horizontal",
     );
     my($_textbox_vert_scrollbar) = $root->new_scrollbar(
     );
     my($_Start_Button) = $root->new_Button(
          -text => "Start",
          -width => 10,
     );
     my($_Stop_Button) = $root->new_Button(
          -text => "Stop",
          -width => 10,
     );

     $_entry_box->configure(
          -invalidcommand => \&_entry_box_invalidcommand
     );
     $_entry_box->configure(
          -validatecommand => \&_entry_box_validatecommand
     );
     $_entry_box->configure(
          -xscrollcommand => \&_entry_box_xscrollcommand
     );
     $_text_box->configure(
          -xscrollcommand => [ $_textbox_horiz_scrollbar => set ]
     );
     $_text_box->configure(
          -yscrollcommand => [ $_textbox_vert_scrollbar => set ]
     );
     $_textbox_horiz_scrollbar->configure(
          -command => [ $_text_box => xview ]
     );
     $_textbox_vert_scrollbar->configure(
          -command => [ $_text_box => yview ]
     );
     $_Start_Button->configure(
          -armcommand => \&_Start_Button_armcommand
     );
     $_Start_Button->configure(
          -command => \&_Start_Button_command
     );
     $_Start_Button->configure(
          -disarmcommand => \&_Start_Button_disarmcommand
     );
     $_Stop_Button->configure(
          -armcommand => \&_Stop_Button_armcommand
     );
     $_Stop_Button->configure(
          -command => \&_Stop_Button_command
     );
     $_Stop_Button->configure(
          -disarmcommand => \&_Stop_Button_disarmcommand
     );
     sub _entry_box_xscrollcommand {}

# Geometry Management
     $_entry_box->g_grid(
          -in     => $root,
          -column => 1,
          -row    => 2,
          -columnspan => 3,
          -ipadx => 0,
          -ipady => 0,
          -padx => 0,
          -pady => 5,
          -rowspan => 1,
          -sticky => "ew"
     );
     $_text_box->g_grid(
          -in     => $root,
          -column => 1,
          -row    => 3,
          -columnspan => 2,
          -ipadx => 0,
          -ipady => 0,
          -padx => 0,
          -pady => 0,
          -rowspan => 1,
          -sticky => "news"
     );
     $_label->g_grid(
          -in     => $root,
          -column => 1,
          -row    => 1,
          -columnspan => 3,
          -ipadx => 0,
          -ipady => 0,
          -padx => 0,
          -pady => 0,
          -rowspan => 1,
          -sticky => "ew"
     );
     $_textbox_horiz_scrollbar->g_grid(
          -in     => $root,
          -column => 1,
          -row    => 4,
          -columnspan => 2,
          -ipadx => 0,
          -ipady => 0,
          -padx => 0,
          -pady => 0,
          -rowspan => 1,
          -sticky => "ew"
     );
     $_textbox_vert_scrollbar->g_grid(
          -in     => $root,
          -column => 3,
          -row    => 3,
          -columnspan => 1,
          -ipadx => 0,
          -ipady => 0,
          -padx => 0,
          -pady => 0,
          -rowspan => 1,
          -sticky => "ns"
     );
     $_Start_Button->g_grid(
          -in     => $root,
          -column => 1,
          -row    => 5,
          -columnspan => 1,
          -ipadx => 0,
          -ipady => 0,
          -padx => 0,
          -pady => 0,
          -rowspan => 1,
          -sticky => ""
     );
     $_Stop_Button->g_grid(
          -in     => $root,
          -column => 2,
          -row    => 5,
          -columnspan => 2,
          -ipadx => 0,
          -ipady => 0,
          -padx => 0,
          -pady => 0,
          -rowspan => 1,
          -sticky => ""
      );

# Resize Behavior
     $root->g_grid_rowconfigure(1, -weight => 0, -minsize => 2, -pad => 0);
     $root->g_grid_rowconfigure(2, -weight => 0, -minsize => 12, -pad => 0);
     $root->g_grid_rowconfigure(3, -weight => 1, -minsize => 85, -pad => 0);
     $root->g_grid_rowconfigure(4, -weight => 0, -minsize => 4, -pad => 0);
     $root->g_grid_rowconfigure(5, -weight => 0, -minsize => 40, -pad => 0);
     $root->g_grid_columnconfigure(1, -weight => 1, -minsize => 67, -pad => 0);
     $root->g_grid_columnconfigure(2, -weight => 1, -minsize => 186, -pad => 0);
     $root->g_grid_columnconfigure(3, -weight => 0, -minsize => 2, -pad => 0);
}

my($root) = Tkx::widget->new('.');
$root->g_wm_title('stackoverflow');
example::ui($root);

Tkx::MainLoop();

1; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-23T02:38:33.267

我用过的唯一一个是 Perl Tk。它学起来很快，网上有很多例子，而且我能够快速从 Mac OS X 移植到 Windows。

缺点是 GUI 看起来过时了。它非常适合内部工具，但不适合出售给第三方。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-18T23:26:49.903

使用 Perl/Tk

# makefile - Autotools 库和目标文件输出控制

> ID：1015700
> 
> 赞同：8
> 
> 时间：2009-06-18T23:23:09.863
> 
> 标签：makefile, gnu, autotools, autoconf, automake

我的目标是将所有目标文件构建在 .objs 目录而不是 Makefile 的根目录中，并将二进制文件（和库）复制到项目的*bin/*目录中。但我一直找不到任何资源来解释如何做到这一点。我该怎么做呢？

这是我的 configure.ac 和*src/Makefile.am* - 对于两个引用的共享库，我有类似的 Makefile.am 文件。它们编译，并在将它们复制到*bin/*目录后正常工作。我只是想自动化这个过程。

**配置.ac**

```
AC_PREREQ([2.63])
AC_INIT([gtkworkbook], [0.12], [j_bellone@users.sourceforge.net])
AC_CONFIG_SRCDIR([gtkworkbook/cell.c])
AM_INIT_AUTOMAKE([gtkworkbook], [0.12])

# Checks for programs.
AC_PROG_CXX
AC_PROG_CC
AC_PROG_INSTALL
AC_PROG_MAKE_SET
AC_PROG_RANLIB
AC_PROG_LIBTOOL
AC_PROG_CC_C_O

AC_CHECK_LIB([pthread], [pthread_mutex_init], [], [
            echo "pthread library is missing. pthread is required for this program"
            exit -1])

# Checks for header files.
AC_CHECK_HEADERS([arpa/inet.h netdb.h netinet/in.h stdlib.h string.h sys/socket.h unistd.h])

# Checks for typedefs, structures, and compiler characteristics.
AC_HEADER_STDBOOL
AC_C_INLINE
AC_TYPE_SIZE_T

# Checks for library functions.
AC_CHECK_FUNCS([gethostbyname memset socket])

AC_OUTPUT([Makefile
       csv/Makefile
       gtkworkbook/Makefile
       src/Makefile]) 
```

**src/Makefile.am**

```
AUTOMAKE_OPTIONS= foreign

C_FLAGS= -I/usr/local/include -I/usr/include -I/usr/local/include/gtkextra-2.0 -I$(top_srcdir)/include `pkg-config gtk+-2.0 glib-2.0 --cflags`
L_FLAGS= -L/usr/local/lib -L/usr/lib -L$(top_srcdir)/lib `pkg-config gtk+-2.0 glib-2.0 --libs` -lgtkextra-x11-2.0

bin_PROGRAMS= gtkworkbook
gtkworkbook_SOURCES= application.c config.c main.c parse.c plugin.c
gtkworkbook_CFLAGS= -Wall -lgthread-2.0 -std=c99 $(C_FLAGS)  
gtkworkbook_LFLAGS= -ldl $(L_FLAGS)
gtkworkbook_LDFLAGS= $(L_FLAGS)
gtkworkbook_LDADD= ../gtkworkbook/libgtkworkbook.la ../csv/libcsv.la

lib_LTLIBRARIES= realtime.la
realtime_la_SOURCES= realtime/CsvParser.cpp realtime/Network.cpp realtime/Packet.cpp realtime/plugin_main.cpp \
    realtime/thread_main.cpp realtime/concurrent/Mutex.cpp realtime/concurrent/Semaphore.cpp \
    realtime/concurrent/Thread.cpp realtime/concurrent/ThreadGroup.cpp realtime/concurrent/ThreadPool.cpp \
    realtime/proactor/Dispatcher.cpp realtime/proactor/Event.cpp realtime/proactor/Proactor.cpp \
    realtime/proactor/InputDispatcher.cpp realtime/proactor/Worker.cpp realtime/network/Tcp.cpp
realtime_la_CPPFLAGS= -Wall -Wno-write-strings $(C_FLAGS)
realtime_la_LFLAGS= -lgtkworkbook -lcsv $(L_FLAGS)
realtime_la_LDFLAGS= -module -export-dynamic 
realtime_la_LIBADD= ../gtkworkbook/libgtkworkbook.la ../csv/libcsv.la 
```

所以，我的问题是如何为每个 Makefile 的编译结果指定输出目录（我希望它们被复制到*bin/*，并且目标文件在每个项目的*.obj*中而不是在 Makefile 的根目录中.

感谢您迄今为止的帮助。这个网站是一个很好的资源，我从已经提供的链接中学到了很多东西。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-06-23T13:10:18.323

GNU 构建系统不使用`obj/`目录，因此自动工具不是为支持目录而设计的。

但是我可以想到两种方法来解决这个问题。

作为安装程序，您可以通过键入从其源目录构建任何包

```
mkdir builddir
cd builddir
../path-to-sourcedir/configure
make 
```

然后将在`builddir/`目录中创建任何输出文件。这种编译方案可以编译存储在只读目录中的源代码（这在 FSF 分发带有未压缩源代码的 CD 的年代更有意义），或者用不同的设置编译相同的源代码（甚至不同的架构）。

作为一个打包者，你可以强制你的包构建所有东西的唯一方法`obj/`是把你的`Makefile.am`in `obj/`，并在那里声明你所有的构建规则。这意味着`obj/Makefile.am`看起来像：

```
bin_PROGRAMS = foo bar
foo_SOURCES = ../src/foo/main.c ../src/foo/help.c ../src/foo/list.c
bar_SOURCES = ../src/bar/bar.c 
```

等等。我记得 10 年前，Palm OS 模拟器 POSE 使用的是上述设置。我不推荐它，因为它不是真正可维护的。最好坚持工具的理念，并使用与其他 GNU 软件包一样工作的构建系统。

关于 GNU 构建系统的介绍，我推荐阅读 Automake 手册的介绍： [http ://www.gnu.org/software/automake/manual/automake.html#GNU-Build-System](http://www.gnu.org/software/automake/manual/automake.html#GNU-Build-System)

特别是用例部分。如果您不关心这些用例，我认为您最好的做法是不要使用 Automake，而是构建自己的 Makefile。否则你会一直试图强迫 Automake 做一些它不是为它设计的事情，你很快就会讨厌它。

**编辑 2013-08-26**：请注意，使用名为[using的子目录的 Automake 项目`obj/`不能移植](http://www.gnu.org/software/autoconf/manual/autoconf-2.67/html_node/obj_002f-and-Make.html)到 BSD make。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-06-18T23:30:50.627

最简单的方法是将“libdir”设置为您希望这些文件结束的目录，并使用安装目标将它们复制到那里。

不过，这会阻止您使用传统意义上的安装目标。

# c++ - boost:spirit 重用规则

> ID：1015701
> 
> 赞同：6
> 
> 时间：2009-06-18T23:23:30.783
> 
> 标签：c++, boost-spirit

嘿嘿，另一个问题：

我编写了许多非常相似的解析器，它们使用了许多通用规则。我可以将这些规则<> 对象存储在多个解析器可以访问它们的地方吗？它看起来像这样：

```
rule<> nmeaStart = ch_p('$');
rule<> nmeaAddress = alnum_p() >> alnum_p() >> !alnum_p() >> !alnum_p();
rule<> nmeaDelim = ch_p(',');
rule<> nmeaHead = nmeaStart >> nmeaAddress >> nmeaDelim;
...
/* other rules. Different for each parser*/
...
rule<> nmeaChkSumStart = ch_p('*');
rule<> nmeaChkSum = int_parser<unsigned int,16,2,2>();
rule<> nmeaTail = nmeaChkSumStart >> nmeaChkSum >> eol_p; 
```

我想将所有名为 nmea... 的规则放在一个公共位置，最好放在某个类的受保护静态变量中。我想在 Spirit 文档中称为语法的东西是关键，但老实说，我还不太了解它。

非常感谢！干杯!

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-20T11:31:29.297

它们只是普通变量，你不需要做任何特别的事情。所以在你的标题中写：

```
class nmea {
protected:
    static rule<> start, address;
}; 
```

在你的实现文件中：

```
rule<> nmea::start = ch_p('$');
rule<> nmea::address = ch_p('$');
// etc. 
```

虽然，我认为建议您使用成员变量。

# windows - Windows 任务计划程序的替代方案

> ID：1015702
> 
> 赞同：2
> 
> 时间：2009-06-18T23:23:33.467
> 
> 标签：windows, linux, user-interface, cron, scheduler

我需要一个适用于 Windows 的任务计划程序。不幸的是，内置调度程序不能满足我的需求，它们是：

*   可以每分钟/每小时运行一次任务
*   在 Linux 和 Windows 上运行
*   32 位和 64 位版本
*   图形用户界面
*   自由

很高兴拥有：

*   支持 CRON 文件
*   开源
*   执行时间的状态报告

谢谢！

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-06-18T23:48:27.767

只是对您关于 Windows 任务计划程序的声明进行了一些更正。

> *   可以每分钟/每小时运行一次任务

每隔一小时：

[![每小时运行一个任务](../Images/80bbc630f7a0dc67bfd7793d3e90a314.png)](https://i.stack.imgur.com/3PQGq.png)
[（来源：[hypftier.de](http://hypftier.de/dump/ts_every_hour.png)）]

或分钟：

[![每分钟运行一个任务](../Images/290ed2765ebe0550a12ec94e295be583.png)](https://i.stack.imgur.com/yWhwx.png)
[（来源：[hypftier.de](http://hypftier.de/dump/ts_every_minute.png)）]

> *   在 Linux 和 Windows 上运行

好的，你可能只有使用 cron 才能做到这一点。但是 Windows 和 Linux 的不同足以保证操作系统特定的东西，那么为什么还要麻烦 Windows 用户使用另一个调度程序呢？（那里已经有太多了，因为几乎每个需要计划的应用程序都包含自己的......）

但是，对于 Linux 的任意非 cron 调度程序也是如此，仅适用于两个平台。

> *   32 位和 64 位版本

Windows 任务计划程序作为服务运行，在那里一点也不成问题，因为它只启动其他进程，而这些进程并不关心它们的生成器是 32 位还是 64 位。但是，它有 64 位和 32 位版本。

> *   图形用户界面

足够的图形用户界面？

[![图形用户界面](../Images/317a4629e4007e1df54432d78f370dee.png)](https://i.stack.imgur.com/MDIjc.png)
[（来源：[hypftier.de](http://hypftier.de/dump/ts_gui_1.png)）] [（来源：][[hypftier.de](http://hypftier.de/dump/ts_gui_2.png)][）][（来源：][[hypftier.de](http://hypftier.de/dump/ts_gui_3.png)][）][（来源：][[hypftier.de](http://hypftier.de/dump/ts_gui_4.png)][）][（来源：][[hypftier.de](http://hypftier.de/dump/ts_gui_5.png)][）][![图形用户界面](../Images/6f7b2cbacbab9b971e15242224cf4c5e.png)](https://i.stack.imgur.com/b9OT3.png)
[![图形用户界面](../Images/9963dba134d6e8b45928a95ccbc6be2a.png)](https://i.stack.imgur.com/fYCqn.png)
[![图形用户界面](../Images/a2775d9429f3a905ea714dd2a9ac6dc5.png)](https://i.stack.imgur.com/iJs2L.png)
[![图形用户界面](../Images/d4580326c0b2122bb7fd922231d20eea.png)](https://i.stack.imgur.com/8xwCO.png)

> *   自由

包含在每个 Windows 安装中。应该够了，我会说。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-18T23:30:14.513

Cron 支持 Cron 文件，Cron for Windows 也是如此！

[http://cronw.sourceforge.net/](http://cronw.sourceforge.net/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-18T23:46:37.210

> 仅限 Windows：免费软件实用程序 Z-Cron 将 Windows 任务调度程序替换为更强大、类似 cron 的替代方案（但具有图形界面）。Z-Cron 附带一长串可以自动化的有用操作，例如发送电子邮件、复制文件夹、删除文件、清空垃圾箱等等，这使得编写批处理文件来为您执行这些操作实际上已经过时。Z-Cron 仅适用于 Windows 的免费下载。

[Z-Cron](http://www.z-cron.com/scheduler.html)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-09-23T07:08:19.870

令我惊讶的是每个人都在大喊“替代品！” 在 Windows 程序/功能上，即使他们不知道使用它们的第一件事。任务调度程序确实可以在 XP/Vista/Seven 中工作（当然是在受照顾的系统上，而不是那些被恶意软件、错误和常驻英国媒体报道软件感染的系统），而且它也做得很好。例如，在 XP 中甚至可以使用每小时调度以及通过 gui 和批处理命令提供的许多其他选项。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-11-11T20:54:54.650

我们使用来自 www.networkautomation.com 的 Automate。我们实际上真的很喜欢它，但我们是旧版本，新版本很贵（比如 1,800 美元）。它有一个很棒的功能集——我们还没有发现它不能做的任何事情。但是我们正在寻找其他东西，因为它太贵了。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-04-23T00:52:47.657

“仅限 Windows：免费软件实用程序 Z-Cron 用更强大、类似 cron 的替代方案（但带有图形界面）取代了 Windows 任务调度程序......”

Z-Cron 不是免费的！这是一个 14-30 天的试用期。在地球上，我们称之为共享软件。我不知道那家公司从哪里开始称其为“免费软件”。

虽然它看起来像一个很酷的程序。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-04-23T01:13:25.853

[哈德逊](http://hudson-ci.org/)

*   支持类似 cron 的调度 (5 * * * *)
*   运行任意进程
*   有一个基于网络的界面
*   免费和开源（麻省理工学院）
*   用 Java 编写并在 Linux 或 Windows 上运行
*   尚未使用 64 位进行测试，但 Hudson 不依赖本机库，因此它很有可能会正常工作
*   可能会占用比您习惯的更大的内存占用
*   可用的失败任务的状态报告，带有控制台输出
*   简易安装

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-02-01T04:33:31.793

除非 Mel 想将 Z-Cron 用于商业目的，否则他对成本的看法是错误的。从 Z-Cron 下载页面：

> 这里提供的免费程序是供个人使用的免费软件，即只能由个人免费使用。

我每天都在同一时间使用 Z-Cron 执行桌面快捷方式。Windows 7 任务计划程序不适用于同一任务。这是我书中对 Z-Cron 的投票。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-05-25T19:04:03.857

JAMS 可以轻松处理这类事情 - www.JAMSScheduler.com 但就像 Automate 一样，它并不便宜。我知道有一个免费的开发者版可供我们的许多开发者使用。我们只在一台服务器上使用该产品，但我知道它的成本相当可观。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2010-11-30T02:01:08.850

Windows 任务计划程序很棒......除非它丢失了 cookie 并忘记了您的任务的所有凭据。这个问题多年来一直存在，NT 及更高版本都有修补程序，但问题仍然存在，大约在 Server 2003 R2 左右。我不知道它是否最终在新版本中得到纠正，但它持续了太久。

不可接受。

# iphone - 在 iPhone 上的核心数据中存储二进制数据

> ID：1015713
> 
> 赞同：2
> 
> 时间：2009-06-18T23:29:12.473
> 
> 标签：iphone, core-data

如果我录制一个音频文件并且我有一个代表该录制的核心数据对象......我应该只引用磁盘上录制的 url，还是可以将它存储在核心数据中？

将其存储在核心数据中可能更容易，但听起来不是一个好主意。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-18T23:46:49.957

我会存储文件的路径。这会更好，因为您可以绕过路径，直到您真正需要播放文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-18T23:59:22.973

如果我记得的话，在 Core Data 中写下实体是原子性的。因此，如果您要保存数据，我会选择一条路径。如果应用程序只会读取相对较小到中等大小的 blob，那么我认为可以使用一对一相关的实体。

此外，由于 iPhone 内存有限，将数据保存为文件可以让您[映射](https://stackoverflow.com/questions/258091/when-should-i-use-mmap-for-file-access)它们。

# sql-server - Windows 服务中没有数据库连接

> ID：1015720
> 
> 赞同：2
> 
> 时间：2009-06-18T23:31:24.463
> 
> 标签：sql-server, windows, database, service, c++builder

我正在尝试在 CBuilder 6（目标 XP Pro）中编写服务。该服务的部分工作是监视和更新数据库中的表。我们使用直接 ODBC 连接到数据库，但问题也发生在 ADO 上，所以为了简单起见，我们将使用它。

你可以在下面看到我的代码。这是从在 ServiceStart 事件中执行的函数调用的。

我的问题是，我无法建立连接。我们的 MSSQL DB 使用域身份验证，因此我尝试使用我的域帐户运行该服务。我也尝试过明确定义我的域\用户名和密码，但这也不起作用（在服务的属性中，登录选项卡）。

任何人都可以帮助我吗？任何事情都值得赞赏。

我的另一个问题是如何调试服务？我安装了远程调试器。我是否使用 rundll32.exe 之类的东西来生成进程？再次，任何帮助表示赞赏。

非常感谢提前

斯图。

代码片段：

```
TADOConnection* DB = new TADOConnection(this);
  try
  {
    DB->ConnectionString = "Provider=MSDASQL.1;Password=password;Persist Security Info=True;User ID=usernamej;Data Source=datasource";
    DB->Connected = true;

    returnValue = DB->Connected;
    ShowMessage("Connected");
  }
  catch (Exception &exception)
  {
    ShowMessage("Not COnnected");
  } 
```

注意：connectionstring 属性仅供参考，用户名、密码和数据库已更改。在独立应用程序中使用此字符串会导致始终成功的连接，并且可以使用查询获取数据。

* * *

回应JP：

嗨，JP。

谢谢你的评论。我实际上没有在这里抛出异常（这很奇怪）。我修改了代码（见下文）以包含更多的 msgbox，我看到的唯一一个是第一个 - 尝试连接。

```
ShowMessage("Attempting Login"); 
TADOConnection* DB = new TADOConnection(NULL); 
try { 
  ShowMessage("1"); 
  DB->ConnectionString = "<as before>"; 
  ShowMessage("2"); 
  DB->Connected = true; 
  ShowMessage("Connected"); 
} catch (Exception &exception) { 
  ShowMessage(exception.Message); 
  ShowMessage("Not COnnected"); 

} 
```

有任何想法吗？我不明白为什么连接组件甚至没有被创建（注意我尝试将所有者从这个更改为 NULL 以及只是为了看看会发生什么）。

谢谢！

斯图。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-21T18:08:06.473

如果您使用域身份验证，则连接字符串中不应包含用户名或密码：

```
Server=myServerName\theInstanceName;Database=myDataBase;Trusted_Connection=True; 
```

[或来自http://www.connectionstrings.com/sql-server-2005](http://www.connectionstrings.com/sql-server-2005)的适当变体

您的计算机需要成为域的成员，并且数据库服务器需要信任该域。该服务需要在计算机所属域下的帐户下运行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-20T16:27:28.120

您遇到的是 Windows 服务权限问题。

*   本质上，服务存在于较低权限的环境中。

*   我建议您登录到事件日志。

*   仅当您将其作为本地服务运行并启用交互式桌面时，才会显示生成的窗口。

# java - 如何在使用 Google App Engine 时关闭 DataNucleus Enhancer

> ID：1015727
> 
> 赞同：14
> 
> 时间：2009-06-18T23:33:14.897
> 
> 标签：java, eclipse, google-app-engine, datanucleus

我正在 Eclipse 中使用 Google AppEngine Java 代码。每次我保存一个 java 文件时，DataNucleus Enchancer 都会启动“类增强”。这很烦人，因为当您处于全屏模式时它会带走焦点。有谁知道我怎么能关掉它？

如果我将其关闭，是否会影响我从 Eclipse 中将应用程序部署到 App Engine 的能力？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-08-02T18:08:14.580

您可以限制 DataNucleus 监视哪些类以进行更改，以便它仅在您的模型类实际更改时重新运行增强功能。

转到项目的属性，然后选择 Google->App Engine->Orm。您可以在此处指定要观看的文件的模式。

例如，我将所有模型 bean 放在一个 model/ 子目录中，因此 src/**/model 模式适合我。“添加”对话框下还有示例模式。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-18T23:48:27.330

增强器在您的项目属性中设置为构建器。我怀疑您可以在编辑时安全地禁用它，然后当您想要运行它时，您必须重新启用并再次构建以确保在您尝试运行或测试之前正确反映您对持久类所做的任何更改您在本地的应用程序。然后，您可以上传到应用引擎。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-27T14:31:40.040

这不会解决焦点问题，但会减少增强器运行的频率：

您可以将增强器配置为仅增强某些文件。您可以根据包或类名指定模式。要指定模式，请依次单击项目菜单、属性、google、应用引擎和 ORM。如果你用一个通用的后缀命名你的持久化类，你可以指定一个像“*Entity.java”这样的模式

# ssis - 从 SSIS 发送传真（使用 Right Fax COM API rfcomapi.dll）

> ID：1015729
> 
> 赞同：4
> 
> 时间：2009-06-18T23:35:46.437
> 
> 标签：ssis, gac, rightfax

我们正在尝试从 SSIS 包中自动发送传真。

[我们已经弄清楚如何使用 Right Fax COM API (rfcomapi.dll) 发送传真](https://stackoverflow.com/questions/988340/)

但我们的问题是，为了在 SSIS 中引用任何外部程序集，该程序集必须在 GAC 中，因为 SSIS 使用 VSA 而不是成熟的开发环境。

在 SSIS 中完成发送传真的选项有哪些？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-18T23:43:55.047

构建一个小控制台应用程序并使用 Execute Process Task 将其启动。利用 SSIS 表达式将 Execute Process Task 的 Arguments 属性塑造成您喜欢的样子。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T23:35:07.020

我通过执行以下操作构建了一个互操作程序集（不确定这是否是最好的方法）：

1.  开始新的空白项目
2.  将 rfcomapi.dll 包含到项目中
3.  使用新的强名称密钥签署项目程序集
4.  构建项目 - 这产生了一个 Interop.RFCOMAPILib.dll
5.  将互操作程序集安装到 GAC 中
6.  在我的 SSIS 项目中引用了 GAC 的互操作程序集。

=)

# java - 从 Ant 访问 Java 类公共成员变量并在构建任务中使用它

> ID：1015732
> 
> 赞同：5
> 
> 时间：2009-06-18T23:37:18.790
> 
> 标签：java, ant, build-process, build, build-automation

我的 Java 应用程序在几个地方显示它的版本号，所以我将它作为公共最终变量存储在应用程序的主类中。有没有办法在我的 Ant 构建任务中访问它？本着自动化构建过程的精神，我希望 Ant 使用当前版本号自动命名压缩的可分发文件，但我不确定如何。我猜它看起来像......

```
<target name="createZip" depends="build">
    <zip destfile="../dist/MyApp_${MyApp.version}.zip">
        <fileset dir="../dist">
            <include name="**/MyApp"/>
        </fileset>
    </zip>
</target> 
```

我只是不确定用什么代替*${MyApp.version}*。我意识到我可以将它放在构建属性文件中，但是能够直接从我已经存储它的类文件中提取它会方便得多。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-19T01:47:23.893

我认为没有任何内置的 Ant 任务可以满足您的需求。但是，您可以自行开发，利用 Ant 的可扩展性。

我已经编写了一个非常（而且我的意思是**非常**）肮脏的示例，您可以将其用作正确任务的跳板。

```
package q1015732;

import java.io.ByteArrayOutputStream;
import java.io.File;
import java.io.FileInputStream;
import java.io.InputStream;
import java.lang.reflect.Field;

import org.apache.tools.ant.BuildException;
import org.apache.tools.ant.Task;

/**
 * Custom ant task that binds a property name to a static member of a class file.
 * 
 * @author Montrose
 */
public class BindPropertyTask extends Task{
    private String _classFile = null;
    private String _fieldName = null;
    private String _propName = null;

    /**
     * Set the field name of the class.
     * 
     * @param fieldName
     */
    public void setFieldName(String fieldName){
        _fieldName = fieldName;
    }

    /**
     * The class file.
     * @param classFile
     */
    public void setClassFile(String classFile){
        _classFile = classFile;
    }

    /**
     * The property name to bind
     * @param propName
     */
    public void setProperty(String propName)
    {
        _propName = propName;
    }

    /**
     * Load the class file, and grab the value of the field.
     * 
     * Throws exceptions if classfile, fieldname, or property have not been set.
     * 
     * Throws more execeptions if classfile does not exist, the field does not exist, or the field is not static.
     */
    public void execute() throws BuildException{
        if(_classFile == null) throw new BuildException("ClassFile is a required attribute");
        if(_fieldName == null) throw new BuildException("FieldName is a required attribute");
        if(_propName == null)  throw new BuildException("Property is  required attribute");

        CustomLoader loader = new CustomLoader();
        Class toInspect = null;
        Field toBind = null;
        Object value = null;

        try {
            toInspect = loader.loadClass(new FileInputStream(_classFile));
        } catch (Exception e) {
            throw new BuildException("Couldn't load class ["+e.getMessage()+"], in ["+(new File(_classFile).getAbsolutePath())+"]");
        }

        try{
            toBind = toInspect.getField(_fieldName);
        }catch(NoSuchFieldException e){
            throw new BuildException("Couldn't find field, '"+_fieldName+"'");
        }

        //Let us bind to private/protected/package-private fields
        toBind.setAccessible(true);

        try{
            value = toBind.get(null);
        }catch(NullPointerException e){
            throw new BuildException("Field is not static");
        } catch (Exception e) {
            throw new BuildException("Unable to access field ["+e.getMessage()+"]");
        }

        if(value != null)
            this.getProject().setProperty(_propName, value.toString());
        else
            this.getProject().setProperty(_propName, null);
    }

    /**
     * Custom class loader, for loading a class directly from a file.
     * 
     * This is hacky and relies on deprecated methods, be wary.
     * 
     * @author Montrose
     */
    class CustomLoader extends ClassLoader{
        public CustomLoader(){
            super(ClassLoader.getSystemClassLoader());
        }

        /**
         * Warning, here be (deprecated) dragons.
         * @param in
         * @return
         * @throws Exception
         */
        @SuppressWarnings("deprecation")
        public Class loadClass(InputStream in) throws Exception{
            byte[] classData = loadData(in);
            return this.defineClass(classData, 0, classData.length);
        }

        private byte[] loadData(InputStream in) throws Exception{
            byte[] buffer = new byte[1024];
            ByteArrayOutputStream out = new ByteArrayOutputStream();
            int i;

            while((i = in.read(buffer)) != -1){
                out.write(buffer, 0, i);
            }

            return out.toByteArray();
        }
    }
} 
```

使用此任务的示例构建文件：

```
<project name="q1015732">

<target name="test">
<taskdef name="static_bind" classname="q1015732.BindPropertyTask" />

<static_bind fieldname="StringBind" classfile="C:\Users\Montrose\workspace\StackOverflow Questions\q1015732\test\DummyMain.class" property="string.value" />
<static_bind fieldname="IntBind"    classfile="C:\Users\Montrose\workspace\StackOverflow Questions\q1015732\test\DummyMain.class" property="int.value" />
<static_bind fieldname="DoubleBind" classfile="C:\Users\Montrose\workspace\StackOverflow Questions\q1015732\test\DummyMain.class" property="double.value" />

<echo message="StringBind: ${string.value}" />
<echo message="IntBind:    ${int.value}" />
<echo message="DoubleBind: ${double.value}" />

</target>

</project> 
```

DummyMain.java：

```
package q1015732.test;

public class DummyMain {
    public static String StringBind = "I'm a String!";
    public static int    IntBind    = 1024;
    public static double DoubleBind = 3.14159;
} 
```

使用 Ant 文件构建的结果：

> 测试：
> [echo] StringBind：我是一个字符串！
> [echo] IntBind：1024
> [echo] DoubleBind：3.14159
> 构建成功

这个任务有许多随机问题：它依赖于不推荐使用的方法，它使用文件而不是类名，并且错误报告还有一些不足之处。但是，您应该了解解决问题的自定义任务所需的要点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T01:03:50.970

创建一个扩展默认的[自定义 ant 任务怎么样？](http://ant.apache.org/manual/develop.html)

扩展 org.apache.tools.ant.taskdefs.Zip 类并覆盖 setDestFile() 方法，以便它获取 MyApp.version 属性并设置目标文件名以包含该信息。

另一个解决方案是使用[CVS](http://www.cs.utah.edu/dept/old/texinfo/cvs/cvs_16.html)和[SVN](http://svnbook.red-bean.com/en/1.4/svn.advanced.props.special.keywords.html)的关键字替换功能（也许 GIT 和 Mercurial 也有这个功能）并巧妙地利用这个功能，比如拥有一个类似这样的属性文件（在 SVN 中）：

```
myApp.revision=$Revision$

```

并在您的代码和构建脚本中引用该属性。

# xml - 播放列表中的 1 个文件后，Windows 媒体服务器不会停止

> ID：1015734
> 
> 赞同：0
> 
> 时间：2009-06-18T23:37:32.580
> 
> 标签：xml, windows-media-player, windows-media-server, asx

我正在播放由如下所示的 ASX 元文件触发的 Windows Media 音频：

```
<asx version="3.0" BannerBar="none">
  <title>Foo</title>
  <author>Bar</author>
  <copyright>Baz</copyright>
  <moreinfo href="http://company.com/"/>
  <entry>
    <title>Audio Stream</title>
    <ref href="mms://media1.company.com/bof.asf"/>
  </entry>
  <entry>
    <title>Audio Stream</title>
    <ref href="mms://media2.company.com/bof.asf"/>
  </entry>
  <entry>
    <title>Apology</title>
    <ref href="http://www.company.com/apology.asf"/>
  </entry>
</asx> 
```

正如您可能知道的那样，如果可以，它应该*尝试*在 media1.company.com 上播放文件，如果第一个失败，则尝试在 media2.company.com 上播放文件，如果两者都失败，则播放道歉。

*实际*发生的是，你听到所有三个。故障转移过程似乎失败了，服务器不知道第一个文件已成功播放。

可以做些什么来解决这个问题？是服务器设置吗？XML 格式有问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T00:20:38.063

这是一个“我不认为这意味着你认为它意味着什么”的案例

基本上，您创建了一个播放列表并告诉媒体播放器播放所有这些文件。

而是尝试这样的事情：

```
<entry>
<title>Audio Stream</title>
<ref href="mms://blah">
<ref href="mms://blahsecondattempt">
<ref href="mms://blahthird">
</entry> 
```

更多信息请参见[Microsoft](http://msdn.microsoft.com/en-us/library/cc189080(VS.95).aspx)。

# flash - 如何模拟 Web 浏览器或仅模拟 Flash 插件来对基于 Flash 的 Web 应用程序进行负载测试？

> ID：1015736
> 
> 赞同：0
> 
> 时间：2009-06-18T23:38:00.707
> 
> 标签：flash, load-testing, windowless

我想我不需要网络浏览器，因为网络功能内置在独立播放器中。我只需要某种 .NET 组件，它允许我以编程方式启动数百个 Flash 播放器（没有 UI）播放特定的 SWF 文件以进行负载测试。SWF 文件访问网络服务并下载其他 SWF 文件，但基本上是在加载到播放器后自行运行完成。

如果这样的组件还可以让我检测到它何时不再访问网络一段时间或收到指示 SWF 已完成其工作的消息，我将终止该实例，那就太好了。 Flash 播放器并启动一个新的。

也许我可以使用现有的 Flash 播放器，但我不想实际启动一个带有 UI 的播放器，我基本上需要编写一个没有 UI 的播放器，因为如果我要在一台机器上运行数百个播放器，我不需要实际渲染所有图形的开销。我可能会将它作为分布式应用程序在多台机器上运行。

有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-18T23:41:56.067

服务器只关心请求的顺序，这就是您要模拟的内容。

如果 SWF 对其内容请求使用 HTTP，那么 JMeter 或 siege 将是一些免费的工具来帮助解决这个问题。否则有许多商业负载测试工具。我可以告诉你我的公司使用的成本“很多”，但是我在移交给 QA 之前进行测试时倾向于使用 JMeter 或 siege。

如果您正在测试流媒体，那会变得有点复杂，您可能必须将您的系统作为单独的组件进行验证。

我向任何尝试进行负载测试的人推荐 Allspaw 书。

[http://my.safaribooksonline.com/9780596518578](http://my.safaribooksonline.com/9780596518578)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T01:38:26.377

如果您确信除了运行 Flash 电影之外什么都行不通，请获取用于生成基于浏览器的屏幕截图的脚本之一，例如 Thummer。这些将加载您在 Firefox 或 Safari 中提供的页面，您可以将它们调整为疯狂循环并允许 Flash 电影运行。

像 selenium for firefox 这样的 UI 测试工具也可以让您编写自己想做的事情并触发自动序列。

我也同意 Ditto 的观点——JMeter 不仅会模拟请求，还会在您完成后为您提供一些可用的指标。如果你用一堆浏览器自己做，你怎么知道瓶颈在哪里？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-21T01:09:31.177

如果您需要真正的浏览器（都安装了 Flash 10），请查看我的公司 BrowserMob。它有效地进行“[硒负载测试](http://seleniumhq.org)”。我们的许多客户使用我们的服务进行 Flash 自动化，这比传统的协议级负载测试要容易得多。

# jquery - 使用 CSS 的 Jquery UI 对话框中的主题元素...如何？

> ID：1015737
> 
> 赞同：1
> 
> 时间：2009-06-18T23:38:20.317
> 
> 标签：jquery, css, dialog, theming

由于旧版本显然对人们来说太难理解了，这里是 HTML、CSS 和 JavaScript 的组合：

```
$(document).ready(function() {
  $('#test').dialog({
    autoOpen: false,
    modal: true
  });
  $("#test-link").click(function() {
    $('#test').dialog('open');
  });
});
```

```
div#main div#test label {
  display: block;
}

div#main div#test input {
  padding-left: 100px;
}
```

```
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.7.2/jquery-ui.min.js"></script>

<div id="main">
  <p><a href="#" id="test-link">test</a>
    <p>
      <div id="test" title="Submit Bug or Feature Request">
        <form>
          <label for="test_desc">Short Description:</label>
          <input type="text" name="test_desc" id="test_desc" value="" />
          <input type="submit" name="" value="Submit" />
        </form>
      </div>

</div>
```

对话框工作正常，但 CSS 不行。任何想法为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T02:00:03.073

JQuery 在 DOM 树中移动对话框的 DIV 并将其包装在其他一些中。因此 CSS 选择器将不起作用。使用上面的示例，您必须执行以下操作：

```
div.ui-dialog div#test label {
    display: block;
}
div.ui-dialog div#test input {
    padding-left: 100px;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T01:01:55.093

CSS应该可以工作。这可能是css规则级联的问题。是否有更具体的选择器应用这些规则，例如“#dialog div#test label”？如果没有 html/css 的其余部分，就不可能指出细节。获取 firebug 并查看将哪些规则应用于这些元素。

# jdbc - JDBC插入两个数据库（本地和远程）之间的选择

> ID：1015738
> 
> 赞同：0
> 
> 时间：2009-06-18T23:38:58.553
> 
> 标签：jdbc

有两个数据库，一个是本地的（该死的MYOB数据文件，只能通过JDBC-ODBC连接在本地读取），另一个是运行在另一台服务器上的mysql。

同步两个数据库的最佳方法是什么？

是否可以执行“插入 _mysql.table1 select * from _myob.table1”或做类似的事情？

我讨厌从中选择，然后将结果插入填充到另一个中。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-23T12:03:42.500

这是不可能的，您可以从 2 个数据库连接创建一个语句。你可以试试[SQuirreL SQL](http://squirrel-sql.sourceforge.net/)，它有一个 DB Copy 插件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-23T12:11:58.083

我不确定您的要求是一次性的还是需要定期进行。

如果是一次，您可以将数据从 odbc 导入 Excel，另存为 csv，然后在 mysql 上使用 LOAD 命令（[http://dev.mysql.com/doc/refman/5.0/en/load-data.html](http://dev.mysql.com/doc/refman/5.0/en/load-data.html)）。

如果它是周期性的，您必须有两个连接并在本地连接上运行一个选择查询，将结果集带入您的 java 程序并在远程连接上运行插入。

# ruby-on-rails - 我们如何查看 Rails 开发日志？

> ID：1015739
> 
> 赞同：61
> 
> 时间：2009-06-18T23:39:10.610
> 
> 标签：ruby-on-rails, ruby, windows, logging, git-bash

我团队的一名成员正在 Windows XP 上开发 Rails 应用程序。我们发现，当我们运行应用程序时，无论是在 NetBeans 中启动它还是通过打开控制台并调用`script/server`，Rails 开发日志都不会滚动。只有 Webrick 启动消息。该应用程序肯定正在运行，但是当我们在浏览器中访问各个页面时，我们看不到任何日志输出。

当我在我的 OS X 系统上查看相同的应用程序时，日志输出按预期工作。

我确实确保它在 Rails“开发”环境中运行。

任何想法为什么会被禁止记录？

environment.rb 文件是否有会影响它的配置参数？

* * *

## 回答 #1

> 赞同：126
> 
> 时间：2009-06-18T23:53:53.233

查看`log/`目录 - 应该有一个`development.log`. 我敢打赌你的输出就在那里。

如果不是，请确保该目录是可写的。

关于如何在运行时查看它：如果您安装了 git bash 或其他一些 shell（如 cygwin），那么您可以打开一个 shell 并`tail -f log/development.log`在日志附加内容时滚动日志。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-06-18T23:59:24.203

[Rails 配置](http://api.rubyonrails.org/classes/Rails/Configuration.html)文档建议您可能`log_level`设置了配置之外的其他内容`:debug`。

还有一个查看请求的替代位置：Rails 应用程序中的 log/development.log 文件。如果那里什么也没写，那么你的问题一定是在配置中。在 *nix 系统上，我会运行：

```
$ tail -f log/development.log 
```

并观察运行的请求。他们告诉我有一个[Windows 版本的`tail`](http://tailforwin32.sourceforge.net/).

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-11-15T12:33:09.977

```
less -R log/development.log 
```

我刚开始用这个。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-18T23:58:34.567

我总是`log/development.log`用来查看日志。只是`tail -f`它使用cygwin或其他东西。

也许您的 Windows 环境使用 WEBrick，而 OS X 环境使用 Mongrel 或其他网络服务器。我注意到，对于某些网络服务器，日志输出（也）直接写入 shell，而对于其他服务器，日志输出仅写入日志文件。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2016-08-31T13:17:06.377

试试这个，以获取开发日志：

```
tail -f log/development.log 
```

确保您位于应用程序路径中。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-06-19T07:59:28.510

当开发日志变得太大时，Netbeans 似乎停止在控制台窗口中显示开发日志。至少那是我的经验。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2018-04-03T12:31:48.460

您可以使用以下命令查看运行时日志：

```
tailf log/development.log 
```

此外，如果您只需要日志中的第一行或最后一行，您可以使用以下命令获取这些行（日志中的第一行/最后 100 行）：

例如：

**前 100 行：**

```
head -n 100 log/development.log 
```

**最后 100 行：**

```
tail -n 100 log/development.log 
```

谢谢！

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-06-19T07:56:25.177

在不深入研究 Webrick 的源代码的情况下，我怀疑显示的信息量默认情况下并不大。你确定你在 OSX 上运行 Webrick 而不是 Mongrel 吗？

事实上，继续使用 Webrick 有什么特别的原因吗？在 Phusion Passenger 出现之前，Mongrel 已经成为*事实上*的首选前端服务器，并且在 Windows 上运行良好。如果您安装它 ( `gem install mongrel`)，Rails 将默认使用它。

在我的开发环境中，运行 Webrick（在我弄清楚了如何 - 已经很久了）我得到了非常简短的输出：只是“GET”请求的记录。切换到 Mongrel，我得到了完整的工作：请求、参数、SQL、计时等。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2016-11-23T14:01:31.350

我在 grep 中使用 tail

```
tail -f log/development.log | grep Started -A 1 
```

工作精美。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-01-25T05:57:36.483

你可以试试这个命令

```
$ tail -f development.log

$ tail -f log/development.log 
```

# java - Java：如何为 URL 启动系统的注册应用程序

> ID：1015740
> 
> 赞同：1
> 
> 时间：2009-06-18T23:39:11.017
> 
> 标签：java, url, desktop

在 Java 5 中，是否有默认方式将 URL 传递给系统并让它启动与之关联的应用程序？例如 http:// 链接通常会打开 IE 或 Firefox，但像 itms:// 这样的链接应该会打开 iTunes。

如果可能的话，我宁愿不使用 Runtime.exec() 直接启动一些外部进程，因为这将是特定于平台的。如果没有其他方法，我会要求 Windows/OS X 和 Linux 覆盖最流行的那些？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-18T23:42:50.010

使用[Java 桌面 API](http://java.sun.com/developer/technicalArticles/J2SE/Desktop/javase6/desktop_api/)

```
 Desktop desktop =  Desktop.getDesktop();
 if (desktop.isSupported(Desktop.Action.BROWSE)) {
     desktop.browse(uri);
 } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-18T23:45:01.923

我同意 ivan 的观点，即 Java Desktop API 可以工作，但它只有 6 个。

我知道如何在 Windows 上执行此操作（它涉及执行 rundll32.dll），但我做了一些快速的谷歌搜索，[这个链接](http://www.java2s.com/Code/Java/Development-Class/LaunchBrowserinMacLinuxUnix.htm)似乎是你最好的选择。

希望有帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-19T01:23:19.450

[BrowserLauncher 可以满足](http://browserlaunch2.sourceforge.net/)您的需求。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-18T23:57:17.580

对于 Java 5，请尝试[JDIC。](https://jdic.dev.java.net/)它具有跨平台支持，可[打开操作系统的已注册应用程序以获取文件。](https://jdic.dev.java.net/nonav/documentation/javadoc/jdic/org/jdesktop/jdic/desktop/Desktop.html#open(java.io.File))如果我没记错的话，这构成了 Java 6 中添加的类似 API 的基础。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-18T23:43:27.047

Windows 是“开始 [URI]”，OSX 是“打开 [URI]”，Linux 没有等价物，因为这完全取决于它们的窗口管理器。

至于 itms:// 是否打开 iTunes，那就看他们的配置了。

伊万的回答似乎比我的好得多。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-18T23:44:42.207

看起来你想要[java.awt.Desktop](http://java.sun.com/javase/6/docs/api/java/awt/Desktop.html)但我认为它是在 1.6 中引入的，在 5 中不可用...:-(

# asp.net - 为什么我的@page enableviewstate 没有覆盖 web.config 中页面的 EnableViewsate？

> ID：1015742
> 
> 赞同：7
> 
> 时间：2009-06-18T23:40:16.083
> 
> 标签：asp.net, viewstate

我想禁用几乎所有页面的视图状态，并且我在 web.config 中使用了该元素来执行此操作。

在专门使用 viewstate 的页面上，我使用了 EnableViewState=true。但是，该页面无法工作，并且依赖于视图状态的下拉列表未填充回发。

为了尝试找到一种模式，当 web.config 设置为 true 时，我能够在页面级别专门禁用视图状态，但我似乎无法在 web.config 设置为 false 和页面设置为真。

关于其他可能相互矛盾的东西的任何想法？

更新：我创建了一个新的空白项目来对此进行试验，显然 ASP.NET 已损坏或不打算以这种方式工作。如果我在 web.config 中 enableViewState=false 我无法在页面级别重新打开它。但是，如果我将其设置为 true，我可以在页面级别将其关闭。

更新更新：我让它在空白项目中工作。不完全确定是什么改变使它突然起作用。我现在将 web.config 设置为 false 并将页面设置为 true 并且页面在回发时保留视图状态。这意味着它是我更大、更复杂的项目所特有的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-23T16:16:12.880

所以答案是，如果您更改页面上的母版页而不将 MasterPage 的 EnableViewState 属性设置为页面的 EnableViewState，那么您会得到问题中描述的行为。

有一个 HttpModule 可以根据应用程序其他部分设置的某些标准更改 MasterPage。通过在母版页的 OnInit 属性中设置 MasterPage.EnableViewState = Page.EnableViewState，我能够恢复预期的行为。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T17:12:26.937

根据我在 .NET 2.0 中观察到的情况，在页面或应用程序级别禁用 ViewState 将为所有子元素禁用它，无论子元素在其 enableviewstate 属性中指定什么。

如果您希望使用视图状态，即使对于单个控件，也不能在页面或应用程序级别将 enableviewstate 设置为 false。

# sharepoint - 如何在 Sharepoint View 中设置“文件夹”属性

> ID：1015761
> 
> 赞同：0
> 
> 时间：2009-06-18T23:44:28.883
> 
> 标签：sharepoint, view

我想以编程方式设置文档库的 Folders 属性，以在特定内容类型的文件夹中显示此视图。我检查了 SPView 类。但仍然不知道该怎么做。有人知道吗？

干杯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-08-29T05:50:26.553

我发现了这个（我知道它有点晚了）但以防万一其他人想要这个：

[http://manish-sharepoint.blogspot.com/2008_07_01_archive.html](http://manish-sharepoint.blogspot.com/2008_07_01_archive.html)

```
list.Views[viewName].Scope = SPViewScope.Recursive;
list.Update(); 
```

# ide - 对新 IDE/文本编辑器的建议

> ID：1015765
> 
> 赞同：1
> 
> 时间：2009-06-18T23:45:14.233
> 
> 标签：ide, text, editor

我一直在寻找一个好的文本编辑器/IDE，它是跨平台的，支持 Mercurial、Git，或者允许我添加其他版本控制系统。

我几乎已经在免费程序上进行了挑战，现在我愿意购买一个低于 100 美元的好程序的许可证（如果适用，我有资格获得学术折扣）。

我通常从事汇编、C、C++、Java 和 yacc/lex 方面的工作。我真的很想要一种与项目 shell 脚本和 makefile 交互的方法。SSH 支持也会很棒。

我想知道是否有人对具有版本控制插件且跨平台的良好专有编辑器有建议？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-18T23:48:49.373

我可以高度推荐 Eclipse。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-19T00:05:12.587

[带有 Mercurial 的 NetBeans](http://wiki.netbeans.org/HgHowTos)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-19T00:21:24.287

使用 emacs。它有 mercurial、git 等支持。它是跨平台且免费的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-19T16:37:51.803

你可以看看[Geany](http://geany.org)。它相当轻巧，支持多种语言的语法高亮显示，并有一个适用于大多数流行版本控制系统的插件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-19T14:07:55.537

我环顾四周，发现了[SlickEdit](http://www.slickedit.com/)，我非常喜欢它的外观。

我不能使用 emacs，因为我是一个非常自豪的 vim 用户。我只是在寻找比 vim 或 emacs 更精致但不像 Netbeans 或 Eclipse 那样重量级的东西。

# c# - "\n" 和 Environment.NewLine 之间的区别

> ID：1015766
> 
> 赞同：233
> 
> 时间：2009-06-18T23:45:18.400
> 
> 标签：c#, .net, cross-platform

两者之间有什么区别（如果有的话）（相对于.Net）？

* * *

## 回答 #1

> 赞同：223
> 
> 时间：2009-06-18T23:46:48.397

取决于平台。在 Windows 上，它实际上是“\r\n”。

来自 MSDN：

> 包含“\r\n”的字符串用于非 Unix 平台，或包含“\n”的字符串用于 Unix 平台。

* * *

## 回答 #2

> 赞同：171
> 
> 时间：2014-04-05T08:34:05.070

`Environment.NewLine`从源代码的确切实现：

.NET 4.6.1 中的实现：

```
/*===================================NewLine====================================
**Action: A property which returns the appropriate newline string for the given
**        platform.
**Returns: \r\n on Win32.
**Arguments: None.
**Exceptions: None.
==============================================================================*/
public static String NewLine {
    get {
        Contract.Ensures(Contract.Result<String>() != null);
        return "\r\n";
    }
} 
```

[来源](http://referencesource.microsoft.com/#mscorlib/system/environment.cs#63a04833d43dd9d3)

* * *

.NET Core 中的实现：

```
/*===================================NewLine====================================
**Action: A property which returns the appropriate newline string for the
**        given platform.
**Returns: \r\n on Win32.
**Arguments: None.
**Exceptions: None.
==============================================================================*/
public static String NewLine {
    get {
        Contract.Ensures(Contract.Result() != null);
#if !PLATFORM_UNIX
        return "\r\n";
#else
        return "\n";
#endif // !PLATFORM_UNIX
    }
} 
```

[来源](https://source.dot.net/#System.Private.CoreLib/src/System/Environment.cs,63a04833d43dd9d3)（在`System.Private.CoreLib`）

```
public static string NewLine => "\r\n"; 
```

[来源](https://source.dot.net/#System.Runtime.Extensions/System/Environment.Windows.cs,63a04833d43dd9d3)（在`System.Runtime.Extensions`）

* * *

## 回答 #3

> 赞同：70
> 
> 时间：2009-06-19T00:14:29.870

正如其他人所提到的，`Environment.NewLine`返回一个特定于平台的字符串来开始新的一行，它应该是：

*   `"\r\n"`(\u000D\u000A) 适用于 Windows
*   `"\n"`(\u000A) 对于 Unix
*   `"\r"`(\u000D) 对于 Mac（如果存在这样的实现）

请注意，在写入控制台时，Environment.NewLine 并不是绝对必要的。`"\n"`如有必要，控制台流将转换为适当的换行序列。

* * *

## 回答 #4

> 赞同：25
> 
> 时间：2009-06-18T23:50:14.317

`Environment.NewLine`将返回运行代码的相应平台的换行符

[当您在Mono](http://www.mono-project.com/Main_Page)框架上的 linux 中部署代码时，您会发现这非常有用

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2009-06-18T23:47:08.083

从[文档](http://msdn.microsoft.com/en-us/library/system.environment.newline.aspx)...

> 包含“\r\n”的字符串用于非 Unix 平台，或包含“\n”的字符串用于 Unix 平台。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-06-19T13:35:21.000

当您尝试显示用“\r\n”分隔的多行消息时，您可能会遇到麻烦。

以标准方式做事并使用 Environment.NewLine 始终是一个好习惯

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-06-18T23:47:33.650

Environment.NewLine 在 Windows 上运行时将给出“\r\n”。如果要为基于 Unix 的环境生成字符串，则不需要“\r”。

# monitor - 监控应用程序、正常运行时间、日志文件等

> ID：1015768
> 
> 赞同：3
> 
> 时间：2009-06-18T23:45:43.950
> 
> 标签：monitor

您如何监控生产中的应用程序？日志，正常运行时间等...（我更喜欢外部应用程序，免费和开源）

例如，我想

1.  如果应用程序出现故障，能够发出警报
2.  如果 CPU 使用率 > 超过设定的阈值，则发送警报
3.  如果内存使用量 > 超过设定的阈值，则发送警报
4.  发送错误消息警报
5.  必须是可配置的，如果在 Y 时间段内发生 X 次，可能会发送警报

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-18T23:55:43.260

什么样的应用程序？

我过去使用过 Nagios。它是免费和开源的。它允许您设置警报、监控事件日志、监控特定于应用程序的日志，以及监控服务器基础设施和网络本身。

[http://www.nagios.org/](http://www.nagios.org/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-12T12:32:18.900

许多人正在转向面向数据的解决方案。虽然大多数监控工具（nagios 等）都提供静态图表，但它们更加孤岛，传统视图 - 今天的应用程序高度分布式，事务跨越多个服务器，事情可能会变得疯狂。对于超越 kpis 和简单 apis 的更多高级功能，您需要查看[Logscape](http://www.logscape.com "原木景观")或[Splunk](http://www.splunk.com "斯普伦克")等机器数据解决方案。它们允许您创建灵活的仪表板等，并且可以交互式地向下钻取以提供非常丰富的根本原因分析。查看此页面上的一些应用程序[LogscapeApps](http://community.liquidlabs.co.uk "LogScapeApps")

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T01:29:31.120

Nagios 是要走的路——有点学习曲线，但可定制且功能强大。还有一个服务器端守护进程，可以监控文件、磁盘空间等。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-19T01:52:00.983

我们有一个定制的内部监控软件。

它监视我们各种实时机器（和测试）上的事件日志，以了解我们的 Web 应用程序产生的错误。我们所有的 Web 应用程序都会将任何异常写入错误日志。它还 ping 服务器并监控驱动器空间。

每台开发机器上都有一个客户端应用程序轮询监视我们定义的所有服务器的服务器应用程序。此客户端应用程序在任务托盘中运行，并在出现任何异常时弹出消息，以便开发人员立即看到。我们还可以看到测试人员何时遇到错误，并且通常在测试人员甚至报告错误时已经修复或至少正在进行修复。

服务器还会通过电子邮件发送到通讯组，以便我们在需要时可以在不工作时查看重要错误。

它还具有抑制预定义异常/错误的能力。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2009-06-18T23:48:03.340

谷歌分析？？？

# c# - 如何使用 CreateTimerQueueTimer 在 C# 中创建高分辨率计时器？

> ID：1015769
> 
> 赞同：7
> 
> 时间：2009-06-18T23:46:23.467
> 
> 标签：c#, timer

我使用 Windows 多媒体 dll 创建了一个高分辨率计时器

**[时间设置事件（）](http://msdn.microsoft.com/en-us/library/ms713423(VS.85).aspx)**

但该`timeSetEvent()`页面建议使用：

**[CreateTimerQueueTimer()](http://msdn.microsoft.com/en-us/library/ms682485(VS.85).aspx)**

如何在 C# 中使用 CreateTimerQueueTimer() 每 10 毫秒执行一次方法？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2010-03-25T13:54:26.573

这是指向 C# 包装器的链接`CreateTimerQueueTimer`：

[http://social.msdn.microsoft.com/Forums/en-CA/csharpgeneral/thread/822aed2d-dca0-4a8e-8130-20fab69557d2](http://social.msdn.microsoft.com/Forums/en-CA/csharpgeneral/thread/822aed2d-dca0-4a8e-8130-20fab69557d2)

（向下滚动到`Hobz`示例课程的最后一篇文章）

我自己试过了，效果很好。但是，您需要添加的一件事是`timeBeginPeriod(1)`在启动计时器之前调用，以便将您的系统设置为高分辨率。 `timeSetEvent`内部调用`timeBeginPeriod`，这就是为什么有些人错误地认为它创建了一个更高分辨率的计时器。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-19T12:31:20.690

传递给 CreateTimerQueueTimer 的回调应该是一个*非托管*函数，它将在回调的生命周期内存在。托管委托可以在内存中移动，但[编组创建的底层存根不会这样做，因此无需固定委托](http://blogs.msdn.com/cbrumme/archive/2003/05/06/51385.aspx)。然而，需要防止委托被垃圾回收，因为来自非托管代码的指针不足以使其保持活动状态。因此，您必须确保委托通过维护一些托管引用保持活动状态（也许通过使用[GCHandle](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.gchandle.aspx)

传递给回调函数的 PVOID 参数必须在内存中固定，因为非托管函数希望它在函数返回后不会移动。在 .Net 中，这种固定（有效地）自动发生，但仅在被调用函数的生命周期内发生。因此，如果您正在使用对某个托管对象的引用（例如通过获取 IntPtr 到它），则必须固定基础对象（同样，GCHandle 可以以稍微不同的方式用于该对象）。要查看这是否是问题，请尝试使用 IntPtr.Zero 作为参数来测试它是否有效。

如果这可以解决问题，您需要将参数分配为非托管堆中的原始字节（并相应地编组），使用一些可安全放入大小为 PVOID（如 Int32）的 blittable 类型或使用上面的 GCHandle 技术为了维护指向托管实例的稳定指针，如果操作不当，这将对性能产生重大影响。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-03-04T23:15:46.860

最好使用 timeSetEvent，因为它的结果更加一致。在现代硬件上，对于小的间隔，间隔长度的偏差比使用 CreateTimerQueueTimer 时小大约十倍。而且这是假设你在调用 CreateTimerQueueTimer 之前没有忘记增加定时器的分辨率，否则差异会更大。所以请改用 timeSetEvent。

# mysql - Hibernate findById 没有找到它以前找到的记录

> ID：1015778
> 
> 赞同：0
> 
> 时间：2009-06-18T23:48:12.527
> 
> 标签：mysql, hibernate, tomcat

我们有一个使用“findById”的非常简单的方法。

```
public Cart getCart(long cartId) {
    Cart cart = null;

    try {

        dbSession.beginTransaction();
        cart = (Cart)dbSession.findById(Cart.class, cartId);
        dbSession.commitTransaction();

        if (logger.isDebugEnabled()) {
            logger.debug("The getCart call committed successfully");
        }

    } finally {
        if (dbSession.needsRollback()) {
            dbSession.rollbackTransaction();
        }
    }

    logGetCartResults(cartId, cart);

    return cart;
}

private void logGetCartResults(long cartId, Cart cart) {
    if (logger.isDebugEnabled()) {

        StringBuffer message = new StringBuffer("Cart id ");
        message.append(cartId)
               .append(" was ");

        if (cart != null) {
            message.append("not ");
        }

        message.append("null");

        logger.debug(message.toString());
    }
} 
```

这个方法有时会被另一个应用程序快速连续调用（它基本上是另一个加载购物车的系统）。我们有一个创建购物车的线程，将记录提交到数据库，然后应用程序为需要进入数据库的每个项目调用一次。尽管其他应用程序按顺序发送并等待响应，但 tomcat 在单独的线程上获取这些响应。

我们看到对“getCart”的初始调用实际上能够找到记录。有时，一个调用会失败，即使在其他调用成功之后也是如此。以下是一些提供更多上下文的日志：

```
 DEBUG 2009-06-18 16:10:57,145 [http-8080-Processor20] com.eroi.managers.impl.DefaultPurchaseManager: Looking for cartId 49
    DEBUG 2009-06-18 16:10:57,146 [http-8080-Processor20] com.eroi.persistors.impl.DefaultPurchasePersistor: The getCart call committed successfully
    DEBUG 2009-06-18 16:10:57,146 [http-8080-Processor20] com.eroi.persistors.impl.DefaultPurchasePersistor: Cart id 49 was not null
    ...
    DEBUG 2009-06-18 16:10:57,522 [http-8080-Processor14] com.eroi.managers.impl.DefaultPurchaseManager: Looking for cartId 49
    DEBUG 2009-06-18 16:10:57,523 [http-8080-Processor14] com.eroi.persistors.impl.DefaultPurchasePersistor: The getCart call committed successfully
    DEBUG 2009-06-18 16:10:57,523 [http-8080-Processor14] com.eroi.persistors.impl.DefaultPurchasePersistor: Cart id 49 was not null
    ...
    DEBUG 2009-06-18 16:10:57,934 [http-8080-Processor10] com.eroi.managers.impl.DefaultPurchaseManager: Looking for cartId 49    
    DEBUG 2009-06-18 16:10:57,934 [http-8080-Processor10] com.eroi.persistors.impl.DefaultPurchasePersistor: The getCart call committed successfully
    DEBUG 2009-06-18 16:10:57,934 [http-8080-Processor10] com.eroi.persistors.impl.DefaultPurchasePersistor: Cart id 49 was null 
```

所以。线程 20、14 成功，但线程 10 找不到记录。是什么赋予了？我们没有进行任何缓存（默认的第一级缓存除外）。

```
<hibernate-configuration>
    <session-factory>
        <property name="current_session_context_class">thread</property>
        <property name="hibernate.connection.datasource">java:/comp/env/jdbc/ourdb</property>
        <property name="hibernate.dialect">org.hibernate.dialect.MySQLDialect</property>
    </session-factory>
</hibernate-configuration> 
```

任何见解、想法或. . . 好吧，任何事情，都值得赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-19T16:46:00.587

是否有可能在线程 10 开始其事务时 ID 还不是完全提交的事务？所以基本上我在问 - 如果你的数据库中已经有一个购物车 49（比如在程序开始时），线程还会有这个问题吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-23T20:22:27.490

这是由于我们的代码中的事务错误。尽管看起来我们的代码在每个请求中都启动了一个新的 Session，但我们发现偶尔，这些新的 Session 不会获得新的 JDBC 连接。我们追踪了我们没有提交交易的地方。由于我们管理开始和提交调用的方式，我们本质上是在创建长期运行的事务，该事务从未完成（并且没有按预期运行）。

# iphone - Objective-c 或 iPhone 编程中的“MyIdentifier”是什么意思

> ID：1015788
> 
> 赞同：0
> 
> 时间：2009-06-18T23:51:26.077
> 
> 标签：iphone, objective-c, cocoa-touch, uitableview

我对以下行感到困惑“静态 NSString *MyIdentifier = @"MyIdentifier";” 在方法中：cellForRowAtIndexPath

那条线有什么作用？它只是创建一个指向 NSString 对象的随机指针并将其分配给字符串吗？为什么它被称为 MyIdentifier，我在很多例子中都看到了这一点。

```
#import "AddToFavorites.h"

@implementation AddToFavorites

- (id)initWithStyle:(UITableViewStyle)style {
  if (self = [super initWithStyle:style]) {
  }
  return self;
}

- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView {
  return 1;
}

- (NSInteger)tableView:(UITableView *)tableView 
numberOfRowsInSection:(NSInteger)section {
  return 5;
}

- (UITableViewCell *)tableView:(UITableView *)tableView 
cellForRowAtIndexPath:(NSIndexPath *)indexPath {

static NSString *MyIdentifier = @"MyIdentifier";

UITableViewCell *cell = [tableView 
dequeueReusableCellWithIdentifier:MyIdentifier];
if (cell == nil) {
    cell = [[[UITableViewCell alloc] initWithFrame:CGRectZero 
reuseIdentifier:MyIdentifier] autorelease];
}
// Configure the cell

return cell;
}

@end 
```

这是另一个示例，此示例具有不同的字符串 CellIdentifier。

```
- (UITableViewCell *)tableView:(UITableView *)tableView 
cellForRowAtIndexPath:(NSIndexPath *)indexPath  {

static NSString *CellIdentifier = @"TimeZoneCell";

UITableViewCell *cell = [tableView 
dequeueReusableCellWithIdentifier:CellIdentifier];

if (cell == nil) {
    cell = [self tableviewCellWithReuseIdentifier:CellIdentifier];
}

[self configureCell:cell forIndexPath:indexPath];
return cell;
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-19T00:02:18.457

UITableViews 可以自动重用单元格以节省内存。要利用这一点，您必须指定 UITableView 使用的“重用标识符”，以便能够查找现有单元格（“dequeueReusbaleCellWithIdentifier”），如果它无法找到与您将创建的单元格相同的标识符现有细胞。

该行创建了一个静态变量（全局的，因为它被所有代码路径共享并且只初始化一次，但是局部的，你只能在这个方法中访问它）来保存标识符的 NSString。我的猜测是，这是为了确保每次都使用相同的指针，因为比较指针既快速又容易，而比较字符串的内容可能需要更长的时间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T00:09:03.373

如上所述，为了提高性能，还要从编译器那里获得帮助以捕捉拼写错误。如果您使用 @""-string 文字，则不会检查您的标识符。如果您拼错静态标识符，编译器会出错。此外，codesense 将自动完成静态标识符。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T00:23:46.747

标识符是一个键或标签，允许您为不同目的拥有多个单独的单元格集合。

这可以节省您的时间和 RAM 内存 - 让我们来看看如何。

假设您有一个联系人列表应用程序，其中包含两种类型的联系人，企业和朋友。

如果你想以不同的方式显示这些，那么你可以设计两种类型的单元格 - 一种带有图片（朋友照片）和黑色字体的名称，另一种只有公司名称而没有图片或图标。

用户在使用应用程序时，可能首先需要显示名称以“AM”开头的 3 个朋友和 4 个公司，因此需要 3 个朋友单元格和 4 个公司单元格。您将这些传递给它，并使用标识符“friend”标记所有朋友单元格，并使用标识符“business”标记所有业务单元格。

当稍后视图更改并且只想要以“PT”开头的名称时，您可能只有 7 个企业。理想情况下，您将重复使用您已经创建的单元格，因此它请求 7 个带有标识符“business”的单元格，结果您已经用“business”标记了您已经创建的 4 个单元格，因此它只是重复使用这些单元格。您已经创建的其余 3 个标签错误，因此它会忽略这些（或者可能会删除它们？）并创建 3 个新的业务类型单元格并为它们提供标签“业务”。

通过以这种方式重复使用单元格，您可以节省内存（只需要每种类型一次显示尽可能多的单元格）和性能（无需在上下滚动时分配和初始化新单元格） . 您可以将其与编写此选择代码和提供事物 ID 的额外程序员工作进行权衡。

他们可以根据 Objective-C 类型自动标记单元格，但是如果您以编程方式创建单元格的内容而不是子类化或使用界面生成器来布置单元格，则这将不起作用。所以他们提供了标识符机制。

如果您的表格中只有一种类型的单元格，只需将其称为“Alice”并忘记它。

# css - HTML：“流畅地”拆分父 div

> ID：1015792
> 
> 赞同：1
> 
> 时间：2009-06-18T23:53:16.230
> 
> 标签：css, html

我想知道如何让两个子 div 共享一个父 div。

我希望左列包含来自数据库的文本（一个单词）。这可能是 1-10 个字母长。因为我希望左列的宽度完美地适合这个词，所以我没有给它一个固定的宽度。

然后，我试图让右列填充剩余空间。

是否有捷径可寻？

我不确定如何设置正确的列的 css 来实现这一点。

```
<div id="parent_div" style="width: 100px; height: 100px;">
     <div style="background-color:blue; float:left;" id="left_column">
           blue
     </div>
     <div style="background-color:red; float: left;" id="right_column">
           red
     </div>
</div> 
```

我读到你不应该在不给它设定宽度的情况下让它漂浮，但看起来我想要的东西是不可能的。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T00:18:21.030

我认为如果你不浮动第二个div，你会得到你想要的效果。

```
<body>
<div id="parent_div" style="width: 100px; height: 100px;">
<div id="left_column" style="background-color: blue; float: left;"> blue </div>
<div id="right_column" style="background-color: red;"> red </div>
</div>
</body> 
```

在 Firefox 中，这正是您想要的。红色列占用了蓝色列未占用的任何剩余空间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T00:16:22.173

好吧，首先，我建议您使右列向右浮动-应该将其放在左列旁边。虽然不确定左列的宽度。

# perl - 如何轻松地将开发目录中已卸载的 Perl 模块添加到 @INC？

> ID：1015793
> 
> 赞同：2
> 
> 时间：2009-06-18T23:53:16.823
> 
> 标签：perl, testing, path, perl-prove

我正在为现有项目编写 Perl t/*.t 测试。在开发过程中，我想使用“证明”在模块目录层次结构中的任意深度运行选择测试。我创建了一些与我想测试的 *.pm 文件深度相同的 t/ 目录。不幸的是，项目代码基础的 lib/ 不在 @INC 中。

自动检测和添加@INC 路径的最佳方法是什么？我已经查看了 -b 选项来证明和 blib 一般，但它们似乎不起作用（他们采用 pwd 并将 blib/lib 附加到它并将其添加到@INC）。理想情况下，该解决方案不需要环境变量或安装模块，并且可以容纳相同代码的多个工作副本。

我的方法错了吗？我有什么明显的遗漏吗？CPAN 模块似乎通过安装或复制 *.t 文件顶部的代码块来解决这个问题（恶心）。

编辑：

结构如下：

```
/home/user/proj/branch\_foo/lib/First/Second/Third.pm
/home/user/proj/branch\_foo/lib/First/Second/t/third.t 
```

这有效：

```
~/proj/branch\_foo/lib/First/Second$ prove -I../.. 
```

但我想：

```
~/proj/branch\_foo/lib/First/Second$ prove -r 
```

或者：

```
~/proj/branch\_foo/lib/First/Second$ prove t/third.t 
```

所以我可以这样做：

```
~/proj/branch\_foo/lib$ prove -r 
```

代替：

```
~/proj/branch\_foo/lib$ prove -I. -r 
```

也许我只需要使用`-I`和处理它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-19T00:20:45.580

[证明](http://search.cpan.org/~andya/Test-Harness-3.17/bin/prove)有一个`-I`命令行选项：

> `-I`要包含的库路径。

您可以使用该选项指定路径吗？

**更新：**

感谢您提供布局。我现在想不出一个快速的解决方案，但也许您可以使用适当目录中的[.proverc](http://search.cpan.org/~andya/Test-Harness-3.17/bin/prove#.proverc)文件来减少所需的输入。我不确定多个`.proverc`文件如何与该`-r`选项交互，但这是需要研究的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-19T18:57:59.400

这正是 blib 模块存在的原因。它在当前目录中查找，然后在其父目录中查找要添加到@INC的*blib/lib 。*它是 Perl 标准库的一部分，因此您应该已经拥有它。

从*t/*下的某个地方，您可以使用 -M 开关来加载 blib：

```
% perl -Mblib test.t 
```

如果你想用它来证明

```
% perl -Mblib prove test.t 
```

我认为这应该与证明中的 -b 开关相同，但上次我尝试它（很久很久以前）它没有用。也许他们已经将其修复为像 blib.pm 一样工作：

```
% prove -b test.t 
```

请注意，这要求您首先构建您的发行版，而不是从*lib/*进行测试，但无论如何您都应该这样做。:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T12:26:53.413

您可以设置环境变量`PERL5LIB`（如 中所述[`perldoc perlrun`](http://perldoc.perl.org/perlrun.html#ENVIRONMENT)），这将导致`perl`将冒号分隔的路径添加到您的`@INC`:

```
% export PERL5LIB=/absolute/path/to/your/libraries
% cd into/part/of/your/test/suite
% prove -r 
```

# php - 如何使用 PHP Ajax.Request onSubmit

> ID：1015795
> 
> 赞同：0
> 
> 时间：2009-06-18T23:53:58.320
> 
> 标签：php, ajax, forms

我正在尝试使用表单通过 post 将原型 ajax 请求发送到 php 脚本，然后显示成功和失败的警报窗口

我目前正在使用此代码

```
<div id="reservationRequestForm">
   <form name="requestReservationForm" method="post" onsubmit="new Ajax.Request('admin/process/process_reservation_request.php', {onSuccess: function() {alert('Success');} , onFailure: function() {alert('Failure');}, method:'post'}; return false;">

....

   <input type="submit" class="buttonGreen" value="Send Request" onClick="hideDiv('reservationRequestForm');"/>
   </form>
</div> 
```

我也不希望响应被处理（反正它是空的）。我只想知道它是成功还是失败。

此外。我希望表单在 js 被禁用时优雅地降级。

现在这段代码什么都不做。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T00:03:31.980

如果未处理 onsubmit 事件，则未提交您的表单。

您的表格中有以下内容之一吗？

```
<input type='submit' ... />

<input type='image' ... /> 
```

单击（或使用空格/输入激活）时，上面的两个元素将提交表单。然后，您拥有的 onsubmit 事件处理程序应该捕获它，并且 return false 应该停止默认操作（更改页面）。

此外，您的 ajax.Request 调用实际上似乎并未使用表单本身的任何表单信息。Ajax.Request 需要知道要发送什么信息。

**编辑** 您缺少右括号。使用以下

```
<form name="requestReservationForm" method="post" onsubmit="new Ajax.Request('admin/process/process_reservation_request.php', {onSuccess: function() {alert('Success');} , onFailure: function() {alert('Failure');}, method:'post', parameters:Form.serialize(this) }); return false;"> 
```

# c# - C# 的流利方法库

> ID：1015798
> 
> 赞同：2
> 
> 时间：2009-06-18T23:55:41.170
> 
> 标签：c#, .net

我在哪里可以找到像 Rails 中那样包含流畅方法集合的库

我在[这里找到了一些](http://fluentdatetime.codeplex.com/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-19T00:29:15.517

[CutEdge.Conditions](http://conditions.codeplex.com/)是另一个。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-18T23:59:17.107

这里 [http://ayende.com/projects/rhino-mocks.aspx](http://ayende.com/projects/rhino-mocks.aspx)

[http://flimflan.com/blog/ReadableRegularExpressions.aspx](http://flimflan.com/blog/ReadableRegularExpressions.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-19T00:04:51.683

[http://fluentnhibernate.org/](http://fluentnhibernate.org/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-19T00:29:56.547

我的最爱; 依赖项：http: [//www.ninject.org](http://www.ninject.org)

# flash - Actionscript 翻译转换

> ID：1015802
> 
> 赞同：2
> 
> 时间：2009-06-18T23:56:54.053
> 
> 标签：flash, actionscript, matrix, transformation

嗨，我正在研究动作脚本 3，我必须使用平移旋转缩放到影片剪辑。我的旋转和缩放工作正常，但是当我处理平移时，我发现平移会将对象移动到原点之外的问题，所以当我想旋转对象时，对象不再按预期旋转。实现翻译的最佳方法是什么，以便在翻译原点的同时翻译电影剪辑......

最后一件事..movi​​eclip.scale 和movieclip.transform.scale 函数有什么区别？如果我使用movieclip.scale，我还能从那个movieclip.scale 中获取movieclip.transform.matrix吗

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-19T12:15:36.603

所有矩阵变换，包括旋转和缩放，都相对于剪辑所在坐标系的原点生效。如果要围绕任何其他点进行旋转或缩放，则应将剪辑平移到该点，进行变换，然后平移回来。换句话说，这：

```
clip.rotation = 30; 
```

做同样的事情：

```
var tx:Number = clip.x;
var ty:Number = clip.y;
var m:Matrix = clip.transform.matrix;
m.translate( -tx, -ty );
m.rotate(30*Math.PI/180);
m.translate( tx, ty );
clip.transform.matrix = m; 
```

它与比例转换的工作方式完全相同。

对于您的另一个问题，MovieClip.scaleX/Y 和 Matrix.scale 之间的区别与旋转完全相同 - 您可以以任何一种方式应用旋转，但使用内置的 MC 属性，它们相对于剪辑的注册点生效，并且矩阵函数是相对于原点的。如果剪辑的注册点位于 (0,0)，则它们的工作方式相同。

# css - 如何让固定宽度 DIV 内的浮动 DIV 水平继续？

> ID：1015809
> 
> 赞同：37
> 
> 时间：2009-06-18T23:59:27.917
> 
> 标签：css, html, css-float

我有一个具有固定高度和宽度（275x1000px）的容器 DIV。在这个 DIV 中，我想放置多个浮动 DIV，每个 DIV 宽度为 300 像素，并显示一个水平（x 轴）滚动条，以允许用户左右滚动以查看所有内容。

到目前为止，这是我的 CSS：

```
div#container {
    height: 275px;
    width: 1000px;
    overflow-x: auto;
    overflow-y: hidden;
    max-height: 275px;
}

div#container div.block {
    float: left;
    margin: 3px 90px 0 3px;
} 
```

问题是浮动 DIV 不会继续超过容器的宽度。在放置三个浮动 DIV 后，它们将继续在下方。如果我将 overflow-y 更改为 auto，则会出现垂直滚动条，我可以向下滚动。

如何更改此设置以使浮动 DIV 继续运行而不会彼此下方？

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2009-06-19T00:23:48.493

```
div#container {
    height: 275px;
    width: 1000px;
    overflow: auto;
    white-space: nowrap;
}

div#container span.block {
    width: 300px;
    display: inline-block;
} 
```

这里的技巧是只有默认行为为 inline 的元素在 Internet Explorer 中设置为 inline-block 时才会正常运行，因此内部容器需要是 <span> 而不是 <div>。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-06-19T00:41:32.560

您需要一个宽大的额外 div 来包含这些块，然后它们将比容器 div 扩展得更宽，并且不会下降到新行。

**的HTML：**

```
<div id="container">
    <div id="width">
        <div class="block">
            <!-- contents of block -->
        </div>
        <div class="block">
            <!-- contents of block -->
        </div>
        <div class="block">
            <!-- contents of block -->
        </div>
        <!-- more blocks here -->
    </div>
</div> 
```

**CSS：**

```
#container {
    height: 275px;
    width: 1000px;
    overflow-x: auto;
    overflow-y: hidden;
    max-height: 275px;
}
#container #width {
    width:2000px; /* make this the width you need for x number of blocks */
}
#container div.block {
    float: left;
    margin: 3px 90px 0 3px;
} 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2015-01-16T10:40:28.273

```
#row {
    white-space: nowrap; /* important */
    overflow: auto;
}

.items {
    display: inline-block;
}
```

```
<div id="row">
    <div class="items">
        <img src="//placehold.it/200/100" alt="item 1" />
    </div>
    <div class="items">
        <img src="//placehold.it/200/100" alt="item 2" />
    </div>
    <div class="items">
        <img src="//placehold.it/200/100" alt="item 3" />
    </div>
    <div class="items">
        <img src="//placehold.it/200/100" alt="item 4" />
    </div>
    <div class="items">
        <img src="//placehold.it/200/100" alt="item 5" />
    </div>
    <div class="items">
        <img src="//placehold.it/200/100" alt="item 6" />
    </div>
    <div class="items">
        <img src="//placehold.it/200/100" alt="item 7" />
    </div>
    <div class="items">
        <img src="//placehold.it/200/100" alt="item 8" />
    </div>
    <div class="items">
        <img src="//placehold.it/200/100" alt="item 9" />
    </div>
    <div class="items">
        <img src="//placehold.it/200/100" alt="item 10" />
    </div>
</div>
```

这里的技巧是父元素的“white-space: nowrap”属性，它简单地告诉它的所有子元素水平继续，以及它的子元素的“display: inline-block”属性。您无需添加任何其他属性即可完成这项工作。

JS 小提琴：http: [//jsfiddle.net/2c4jfetf/](http://jsfiddle.net/2c4jfetf/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-19T00:39:20.427

将浮动 div 包裹在另一个宽度更宽的 div 中。

```
<div style="width:230px;overflow-x:auto;background-color:#ccc;">
    <div style="width:400px">
        <div style="height:100px;width:100px;float:left;border:1px solid #000;"></div>
        <div style="height:100px;width:100px;float:left;border:1px solid #000;"></div>
        <div style="height:100px;width:100px;float:left;border:1px solid #000;"></div>
    </div>
</div> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-19T00:03:31.887

采用：

```
 div#container {
        overflow: auto;
    } 
```

或者在三个div下面加上一个clearing div，样式如下：

```
 {
        clear: both
    } 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-19T00:13:16.347

将要滚​​动的 div 放入表格中，如下所示：

```
<div style='width:1000;border:2 solid red;overflow-x:auto'>
   <table><tr>
      <td><div style='width:300;height:200;border:1 solid black'>Cell 1&nbsp;</div></td>
      <td><div style='width:300;height:200;border:1 solid black'>Cell 2&nbsp;</div></td>
      <td><div style='width:300;height:200;border:1 solid black'>Cell 3&nbsp;</div></td>
      <td><div style='width:300;height:200;border:1 solid black'>Cell 4&nbsp;</div></td>
      <td><div style='width:300;height:200;border:1 solid black'>Cell 5&nbsp;</div></td>
   </tr></table>
</div> 
```

编辑：我尝试了其中 3 个建议的解决方案 - 它们在 Google Chrome 中都可以正常工作 - 但第一个（container1）在 IE 中不起作用（如图） - 所以 SPAN 解决方案得到了我的投票:-)：

```
<html>
<body>
<style>
div#container1 
   {
   height: 275px;
   width: 100%;
   overflow: auto;
   white-space: nowrap;
   border:2 solid red;
   }

div#container1 div.block 
   {
   width: 300px;
   height: 200px;
   display: inline-block;
   border: 1 solid black;
   }

div#container2 
   {
   height: 275px;
   width: 100%;
   overflow: auto;
   white-space: nowrap;
   border:2 solid red;
   }

div#container2 span.block 
   {
   width: 300px;
   height: 200px;
   display: inline-block;
   border: 1 solid black;
   }

div#container3 
   {
   height: 275px;
   width: 100%;
   overflow: auto;
   white-space: nowrap;
   border:2 solid red;
   }

div#container3 div.block 
   {
   width: 300px;
   height: 200px;
   display: inline-block;
   border: 1 solid black;
   }

</style>
<p>
<div id='container1'>
      <div class='block'>Cell 1&nbsp;</div>
      <div class='block'>Cell 2&nbsp;</div>
      <div class='block'>Cell 3&nbsp;</div>
      <div class='block'>Cell 4&nbsp;</div>
      <div class='block'>Cell 5&nbsp;</div>
</div>
<p>
<div id='container2'>
      <span class='block'>Cell 1&nbsp;</span>
      <span class='block'>Cell 2&nbsp;</span>
      <span class='block'>Cell 3&nbsp;</span>
      <span class='block'>Cell 4&nbsp;</span>
      <span class='block'>Cell 5&nbsp;</span>
</div>
<p>
<div id='container3'>
   <table><tr>
      <td><div class='block'>Cell 1&nbsp;</div></td>
      <td><div class='block'>Cell 2&nbsp;</div></td>
      <td><div class='block'>Cell 3&nbsp;</div></td>
      <td><div class='block'>Cell 4&nbsp;</div></td>
      <td><div class='block'>Cell 5&nbsp;</div></td>
   </tr></table>
</div>
</body>
</html> 
```

编辑2：

我通过 browsershots.org 运行了这个测试页面，看看不同的浏览器是如何处理它的。结论：浏览器兼容性很差。:-)

[http://browsershots.org/http://dot-dash-dot.com/files/test_div2.htm](http://browsershots.org/http://dot-dash-dot.com/files/test_div2.htm)

表格解决方案的工作频率更高——但 span 选项（更简洁）只在我从未听说过的浏览器上中断。:-)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-19T00:18:53.743

表解决方案应该工作得很好。

如果您不想使用表格，您还可以将所有 .block div 放在 #container 内的另一个 div 中，并在加载页面后使用 javascript 为“in-between-div”赋予一个固定的 - 计算的 - 宽度。

当然，如果您已经知道有多少个 .blocks/如果数量是固定的，则可以使用 css 为“in-between-div”提供固定宽度。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-19T03:00:17.583

听起来你正在用 div 做画廊？

你到底在用 div 做什么？

使用 ul/li 和 li 内部的 span 可能更容易获得相同的效果，而没有浮动 div 的所有麻烦。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-07-31T21:24:55.817

我的前夫：

div 宽度：850px gridview templatedcolumn ItemTemplate

```
<span class="buttonspanlt"></span><asp:Button ID="imgEditSave" runat="server" Text="Edit SubStatus" CssClass="buttoncenter" OnClick="imgEditSave_OnClick"/><span class="buttonspanrt"></span>
<span style="display:none;float:left;clear:left;" id="spangrdCancel" runat="server"><span class="buttonspanlt"></span><asp:Button ID="imgCancel" runat="server" Text="Cancel" class="buttoncenter"/><span class="buttonspanrt"></span></span> 
```

end ItemTemplate end templatedcolumn end gridview end div

该按钮具有左中间（实际按钮）右跨度，其中不浮动，因为外部 div 具有固定宽度。

我必须在按钮外使用宽度为 140px 的附加 div ，然后在 itemtemplate 内使用它。

希望这可以帮助！！！

谢谢你，哈里什

# java - 什么进入“MVC”中的“控制器”？

> ID：1015813
> 
> 赞同：194
> 
> 时间：2009-06-19T00:01:26.697
> 
> 标签：java, model-view-controller

我想我了解 MVC 的基本概念 - 模型包含应用程序的数据和行为，视图负责向用户显示它，控制器处理用户输入。我不确定的正是*控制器*中的内容。

例如，我有一个相当简单的应用程序（我特别考虑 Java，但我想同样的原则也适用于其他地方）。我将我的代码组织成 3 个包，分别称为`app.model`,`app.view`和`app.controller`.

在`app.model`包中，我有一些反映应用程序实际行为的类。这些`extends Observable`并使用`setChanged()`并`notifyObservers()`在适当的时候触发视图更新。

该`app.view`包有一个类（或几个用于不同类型显示的类），它使用`javax.swing`组件来处理显示。其中一些组件需要反馈到模型中。如果我理解正确，视图不应该与反馈有任何关系——应该由控制器处理。

那么我实际上在控制器中放入了什么？我是否`public void actionPerformed(ActionEvent e)`只需调用控制器中的方法即可将其放入视图中？如果是这样，是否应该在控制器中进行任何验证等？如果是这样，我如何将错误消息反馈回视图 - 应该再次通过模型，还是控制器应该直接将其发送回视图？

如果验证在 View 中完成，我在 Controller 中放置什么？

很抱歉这个问题很长，我只是想记录一下我对这个过程的理解，希望有人可以为我澄清这个问题！

* * *

## 回答 #1

> 赞同：556
> 
> 时间：2009-06-19T00:16:14.217

在您建议的示例中，您是对的：界面中的“用户单击了'删除此项目'按钮”基本上应该只是调用控制器的“删除”功能。然而，控制器不知道视图是什么样的，因此您的视图必须收集一些信息，例如“单击了哪个项目？”

在对话形式中：

**视图**：“嘿，控制器，用户刚刚告诉我他想删除第 4 项。”
**管制员**：“嗯，在检查了他的凭据后，他被允许这样做……嘿，模特，我希望你得到第 4 项，然后做任何你想做的事情来删除它。”
**模型**：“第 4 项……知道了。它被删除了。还给你，管制员。”
**控制器**：“在这里，我将收集新的数据集。返回给你，查看。”
**视图**：“酷，我现在将新设置展示给用户。”

在该部分的末尾，您有一个选择：视图可以发出单独的请求，“给我最新的数据集”，从而更加纯粹，或者控制器隐式返回新的数据集，并带有“删除“ 手术。

* * *

## 回答 #2

> 赞同：72
> 
> 时间：2009-06-19T02:18:07.263

问题`MVC`在于人们认为视图、控制器和模型必须尽可能相互独立。它们不 - 视图和控制器通常交织在一起 - 将其视为`M(VC)`.

控制器是用户界面的输入机制，它经常与视图纠缠在一起，尤其是与 GUI。然而，视图是输出，控制器是输入。视图通常可以在没有相应控制器的情况下工作，但控制器通常在没有视图的情况下就没那么有用了。用户友好的控制器使用视图以更有意义、更直观的方式解释用户的输入。这就是很难将控制器概念与视图分开的原因。

将一个无线电控制的机器人想象成一个密封盒子中的探测场作为模型。

该模型是关于状态和状态转换的，没有输出（显示）或触发状态转换的概念。我可以得到机器人在场上的位置，并且机器人知道如何转换位置（向前/向后/向左/向右走一步。在没有视图或控制器的情况下很容易想象，但没有任何用处

想象一个没有控制器的视图，例如，在网络上的另一个房间里，另一个房间里的某个人正在观察机器人的位置，因为 (x,y) 坐标沿着滚动控制台向下流动。这个视图只是显示模型的状态，但这家伙没有控制器。同样，很容易在没有控制器的情况下想象这个视图。

想象一个没有视图的控制器，例如有人锁在壁橱里，无线电控制器调谐到机器人的频率。该控制器正在发送输入并导致状态转换，但不知道它们对模型做了什么（如果有的话）。很容易想象，但如果没有来自视图的某种反馈，它并没有真正有用。

大多数用户友好的 UI 将视图与控制器协调以提供更直观的用户界面。例如，想象一个带有触摸屏的视图/控制器，以二维显示机器人的当前位置，并允许用户触摸屏幕上恰好位于机器人前面的点。控制器需要有关视图的详细信息，例如视口的位置和比例，以及触摸点相对于屏幕上机器人像素位置的像素位置）才能正确解释这一点（不像那个被锁在壁橱里的人）无线电控制器）。

我已经回答你的问题了吗？:-)

控制器是从用户那里获取用于使模型转换状态的输入的任何东西。尝试将视图和控制器保持分离，但要意识到它们通常是相互依赖的，所以如果它们之间的边界模糊也可以，即视图和控制器作为单独的包可能不会像你想的那样完全分离喜欢，但没关系。您可能必须接受控制器不会与视图完全分离，因为视图来自模型。

> ...是否应该在控制器中进行任何验证等？如果是这样，我如何将错误消息反馈回视图 - 应该再次通过模型，还是控制器应该直接将其发送回视图？
> 
> 如果验证在 View 中完成，我在 Controller 中放置什么？

我说链接的视图和控制器应该可以自由交互而无需通过模型。控制器接受用户的输入并应该进行验证（可能使用来自模型和/或视图的信息），但如果验证失败，控制器应该能够直接更新其相关视图（例如错误消息）。

对此的严峻考验是问自己一个独立的视图（即另一个房间里的人通过网络观察机器人位置）是否应该因为其他人的验证错误而看到任何东西（例如壁橱里的那个人）试图告诉机器人离开场地）。一般来说，答案是否定的——验证错误阻止了状态转换。如果没有状态转换（机器人没有移动），则不需要告诉其他视图。壁橱里的人只是没有得到任何反馈，表明他试图导致非法转换（没有视图 - 糟糕的用户界面），其他人也不需要知道这一点。

如果那个拿着触摸屏的人试图把机器人送出场地，他会收到一条友好的用户友好信息，要求他不要通过将机器人送出检测场地来杀死机器人，但同样，没有其他人需要知道这一点。

如果其他视图*确实*需要了解这些错误，那么您实际上是在说来自用户的输入和任何由此产生的错误都是*模型的一部分，*整个事情有点复杂......

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2009-06-19T00:12:02.043

这是一篇关于 MVC 基础知识的[好文章](https://web.archive.org/web/20090805073932/http://java.sun.com/blueprints/patterns/MVC-detailed.html)。

它指出 ...

> 控制器 - 控制器将与视图的交互转换为模型要执行的操作。

换句话说，你的业务逻辑。控制器响应用户在视图中执行的操作并做出响应。如果验证失败或成功（错误页面、消息框等），您将验证放在这里并选择适当的视图。

[Fowler 上](http://www.martinfowler.com/eaaDev/uiArchs.html#ModelViewController)还有另一篇好文章。

* * *

## 回答 #4

> 赞同：24
> 
> 时间：2009-09-01T13:25:01.057

MVC 模式只希望您**将表示**（= 视图）**与业务逻辑**（= 模型）分开。控制器部分只是为了引起混乱。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2009-06-19T00:51:32.023

实际上，我从来没有发现控制器概念是一个特别有用的概念。我在代码中使用严格的模型/视图分离，但没有明确定义的控制器。这似乎是一个不必要的抽象。

就个人而言，成熟的 MVC 似乎是工厂设计模式，因为它很容易导致设计混乱和过于复杂。不要成为[建筑宇航员](https://stackoverflow.com/questions/404210/design-patterns-architecture-astronaut)。

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2009-06-19T00:44:53.270

根据你的问题，我觉得你对模特的角色有点模糊。模型专注于与应用程序关联的数据；如果应用程序有一个数据库，模型的工作就是与它交谈。它还将处理与该数据相关的任何简单逻辑；如果您有一条规则说明所有情况下 TABLE.foo == "万岁！" 和 TABLE.bar == "Huzzah!" 然后设置 TABLE.field="W00t!"，然后你希望模型来处理它。

控制器应该处理应用程序的大部分行为。所以回答你的问题：

> 我是否只需调用控制器中的方法就将 public void actionPerformed(ActionEvent e) 放在视图中？

我会说不。我会说它应该存在于控制器中；视图应该简单地将来自用户界面的数据提供给控制器，并让控制器决定应该调用哪些方法作为响应。

> 如果是这样，是否应该在控制器中进行任何验证等？

您的大部分验证确实应该由控制器完成；它应该回答数据是否有效的问题，如果不是，则将适当的错误消息提供给视图。在实践中，您可以在 View 层中加入一些简单的健全性检查，以改善用户体验。（我主要考虑 Web 环境，您可能希望在用户点击“提交”时弹出一条错误消息，而不是等待整个提交 -> 进程 -> 加载页面循环，然后再告诉他们他们搞砸了.) 小心点；您不希望重复工作，而且在很多环境中（再次，我想到的是网络），您经常不得不将来自用户界面的任何数据视为一堆肮脏的肮脏撒谎直到你

> 如果是这样，我如何将错误消息反馈回视图 - 应该再次通过模型，还是控制器应该直接将其发送回视图？

您应该设置一些协议，其中视图不一定知道接下来会发生什么，直到控制器告诉它。用户敲击该按钮后，您会向他们显示什么屏幕？视图可能不知道，控制器也可能不知道，直到它查看刚刚获得的数据。它可能是“按预期转到此其他屏幕”或“留在此屏幕上，并显示此错误消息”。

根据我的经验，Model 和 View 之间的直接通信应该非常非常有限，并且 View 不应该直接改变 Model 的任何数据；那应该是控制器的工作。

> 如果验证在 View 中完成，我在 Controller 中放置什么？

往上看; 真正的验证应该在控制器中。并且希望您现在对应该在 Controller 中放置的内容有所了解。:-)

值得注意的是，边缘都会变得有些模糊。与大多数像软件工程一样复杂的事情一样，判断电话将比比皆是。只需使用您的最佳判断，尝试在此应用程序中保持一致，并尝试将您学到的课程应用到下一个项目中。

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2009-06-19T01:16:54.703

控制器实际上是视图的一部分。它的工作是确定需要哪些服务来满足请求，将视图中的值解组为服务接口所需的对象，确定下一个视图，并将响应编组回下一个视图可以使用的形式. 它还处理任何抛出的异常并将它们呈现到用户可以理解的视图中。

服务层是了解用例、工作单元和模型对象的东西。每种视图类型的控制器都不同——桌面、基于浏览器、Flex 或移动 UI 的控制器不会相同。所以我说它确实是 UI 的一部分。

面向服务：这就是工作完成的地方。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-06-19T01:02:49.850

这是我使用的经验法则：如果它是我将*专门*用于*此*页面上的操作的过程，它属于控制器，而不是模型。该模型应该只为数据存储提供一个连贯的抽象。

我是在使用开发人员编写的大型 web 应用程序后提出的，这些开发人员认为他们了解 MVC，但实际上并没有。他们的“控制器”减少到 8 行调用静态类方法的行，这些方法通常在其他任何地方都没有调用：-/ 使他们的模型只不过是创建命名空间的方法。正确地重构这三件事：将所有 SQL 转移到数据访问层（又名模型），使控制器代码更冗长但更易于理解，并将旧的“模型”文件减少到零。:-)

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-06-19T00:22:48.150

控制器主要用于视图和模型之间的协调。

不幸的是，它有时最终会与视图混合在一起——在小型应用程序中，虽然这还不错。

我建议你把：

```
public void actionPerformed(ActionEvent e) 
```

在控制器中。然后你的视图中的动作监听器应该委托给控制器。

至于validation部分，可以放在view里面或者controller里面，我个人觉得是属于controller里面的。

我绝对会推荐看看 Passive View and Supervising Presenter （这基本上是 Model View Presenter 被分成的部分——至少 Fowler 是这样）。看：

[http://www.martinfowler.com/eaaDev/PassiveScreen.html](http://www.martinfowler.com/eaaDev/PassiveScreen.html)

[http://www.martinfowler.com/eaaDev/SupervisingPresenter.html](http://www.martinfowler.com/eaaDev/SupervisingPresenter.html)

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-06-19T01:00:47.263

还要注意，每个 Swing 小部件可以被认为包含三个 MVC 组件：每个都有一个模型（即 ButtonModel）、一个视图（BasicButtonUI）和一个控件（JButton 本身）。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-06-19T01:12:32.590

您在控制器中放入的内容基本上是正确的。这是模型应该与视图交互的唯一方式。执行的动作可以放在视图中，但实际功能可以放在另一个类中，该类将充当控制器。如果您要这样做，我建议您研究命令模式，这是一种抽象具有相同接收器的所有命令的方法。抱歉跑题了。

无论如何，正确的 MVC 实现将仅具有以下交互：模型 -> 视图视图 -> 控制器控制器 -> 视图

唯一可能存在其他交互的地方是，如果您使用观察者来更新 View，那么 View 将需要向 Controller 询问它需要的信息。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-06-19T00:05:20.747

据我了解，控制器从用户界面操作转换为应用程序级操作。例如，在视频游戏中，控制器可能会将“将鼠标移动了这么多像素”翻译成“想要朝某个方向看”。在 CRUD 应用程序中，翻译可能是“点击某某按钮”到“打印这个东西”，但概念是一样的。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2011-05-20T16:22:49.273

我们就是这样做的，主要使用控制器来处理和响应用户驱动的输入/操作（以及 _Logic 用于其他所有内容，除了视图、数据和明显的 _Model 内容）：

(1) (response, response - webapp对用户的响应"做什么") Blog_Controller

->主（）

->handleSubmit_AddNewCustomer()

->verifyUser_HasProperAuth()

(2)（“业务”逻辑，webapp“思考”的内容和方式）Blog_Logic

->sanityCheck_AddNewCustomer()

->句柄用户名更改（）

->sendEmail_NotifyRequestedUpdate()

(3)（视图、门户、webapp 如何“出现”）Blog_View

->genWelcome()

->genForm_AddNewBlogEntry()

->genPage_DataEntryForm()

(4)（仅限数据对象，在*每个Blog* *类的_construct()中获取，用于将所有webapp/inmemory数据作为一个对象保存在一起）Blog_Meta

(5)（基础数据层，读/写数据库）Blog_Model

->saveDataToMemcache()

->saveDataToMongo()

->saveDataToSql()

->加载数据（）

有时我们对将方法放在哪里有点困惑，在 C 或 L 中。但模型坚如磐石，晶莹剔透，而且由于所有内存中的数据都驻留在 _Meta 中，所以在那里也很容易. 顺便说一句，我们最大的飞跃是采用了 _Meta 使用，因为这从各种 _C、_L 和 _Model 对象中清除了所有杂物，使得这一切在精神上易于管理，而且，它一举为我们提供了称为“依赖注入”，或一种将整个环境与所有数据一起传递的方法（其好处是轻松创建“测试”环境）。

# memcached - 什么是 memcached 中的 -b 开关

> ID：1015815
> 
> 赞同：0
> 
> 时间：2009-06-19T00:02:43.230
> 
> 标签：memcached

内存缓存.exe -h

> -b 运行托管实例（助记符：存储桶）

这到底是什么意思？谷歌搜索没有帮助:(

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-19T00:13:13.710

从源代码来看，这似乎意味着 memcached 有多个独立的存储桶。

这可能是出于安全或会计原因，允许您拥有多个并发用户的 memcached，而没有一个用户获得另一个用户缓存的结果。

[http://src.opensolaris.org/source/xref/webstack/memcached-incubator/branches/performance/server/memcached.h#51](http://src.opensolaris.org/source/xref/webstack/memcached-incubator/branches/performance/server/memcached.h#51)

# python - 通过 XSLT 传递格式化文本

> ID：1015816
> 
> 赞同：0
> 
> 时间：2009-06-19T00:02:53.637
> 
> 标签：python, xslt

我已经格式化了来自 Telnet 连接的文本（带有换行符、制表符等）。我有一个 python 脚本来管理 Telnet 连接并将 Telnet 响应嵌入到 XML 中，然后通过 XSLT 转换传递。如何在不丢失原始格式的情况下通过转换传递 XML？我可以访问转换脚本和 python 脚本，但不能访问转换调用本身。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-19T00:07:37.230

[您可以在CDATA 部分](http://www.w3schools.com/Xml/xml_cdata.asp)中嵌入您希望保持不变的文本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T08:33:52.793

存储在 XML 中的数据的输出方式与其进入的方式相同。因此，如果您将文本存储在一个元素中，除非您篡改 XSLT 中的数据，否则不会丢失空格和换行符。

在 CDATA 中包含文本是不必要的*，除非*在 XML 中存在一些无效的格式（尖括号、和号、引号）*并且*您在任何情况下都不想对文本进行 XML 转义。这取决于您，但无论如何，当使用支持 XML 的工具链处理 XML 时，XML 转义是完全透明的。

要更具体地回答您的问题，您需要显示一些输入、转换的基本部分和一些输出。

# ms-access - 为什么极少数情况下 bof/eof 之一对于新的非空记录集是正确的

> ID：1015830
> 
> 赞同：2
> 
> 时间：2009-06-19T00:09:29.130
> 
> 标签：ms-access, ado, dao

```
 set recordsetname = databasename.openrecordset(SQLString)
    if recordsetname.bof <> true and recordsetname.eof <> true then
    'do something
    end if 
```

2个问题：

1.  上面的测试可以错误地评估为假，但很少见（我的代码中潜伏了一个，今天它失败了，我相信这是 5 年来日常使用中的第一次——这就是我发现它的方式）。为什么对于非空记录集，bof/eof 中的一个偶尔会为真。它似乎如此罕见，以至于我想知道它为什么会发生。

2.  这是一个万无一失的替代品：

    ```
    if recordsetname.bof <> true or recordsetname.eof <> true then 
    ```

**编辑以添加代码的详细信息：**

客户有订单，每个订单以一个项目开始，以一个`BeginOrder`项目结束，`EndOrder`中间是订单中的项目。

SQL 是：

```
' ids are autoincrement long integers '
SQLString = "select * from Orders where type = OrderBegin or type = OrderEnd"           

Dim OrderOpen as Boolean
OrderOpen = False

Set rs = db.Openrecordset(SQLString)
If rs.bof <> True And rs.eof <> True Then
    myrec.movelast
    If rs.fields("type").value = BeginOrder Then
         OrderOpen = True
    End If
End If

If OrderOpen F False Then
    'code here to add new BeginOrder Item to Orders table '
End If

ShowOrderHistory 'displays the customer's Order history ' 
```

在这种情况下，看起来这个

```
BeginOrder
Item a
Item b
...
Item n
EndOrder

BeginOrder
Item a
Item b
...
Item n
EndOrder

BeginOrder
Item a
item b
...
Item m

BeginOrder     <----should not be there as previous order still open 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-19T02:27:45.747

该文档明确指出，如果您打开一个`Recordset`没有记录的文件：

*   `BOF`将是真的
*   `EOF`将是真的
*   `RecordCount`将会`0`

对于非空`Recordset`，在您超出第一条或最后一条记录之前，`BOF`和都不为真。`EOF`

是不是有时，其他人可能会在您刚刚打开的记录集中的一个表中添加/删除一条记录并更改结果集？
这可能是竞争条件的结果。

而不是使用`BOF`or `EOF`，您可以测试`Recordcount`: 它总是`0`如果记录集为空。
如果记录集不为空，通常会`1`在记录集打开后立即返回；`Recordcount`在这种情况下，这并不是一项昂贵的操作。
真正返回*实际*记录数的唯一方法是`MoveLast`在调用之前发出一个`Recordcount`强制加载所有记录的方法。

通常，如果我需要以只读方式遍历结果集：

```
Dim db as DAO.Database
Dim rs as DAO.RecordSet

Set db = CurrentDB()
Set rs = db.OpenRecordSet("...", dbOpenForwardOnly)
If Not (rs Is Nothing) Then
    With rs
       Do While Not .EOF
            ' Do stuff '
            .MoveNext
       Loop
       .Close
    End With
    Set rs = Nothing
End If
Set db = Nothing 
```

如果我不需要遍历记录而只需测试是否返回了任何内容：

```
Set rs = db.OpenRecordSet("...", dbOpenForwardOnly)
If Not (rs Is Nothing) Then
    With rs
       If .RecordCount > 0 Then
          ' We have a result '
       Else
          ' Empty resultset '
       End If
       .Close
    End With
    Set rs = Nothing
End If
Set db = Nothing 
```

它非常具有防御性，你必须适应你的环境，但它每次都能正常工作。

关于您的第二个问题，打开记录集后的测试（`BOF`Or `EOF`）应该比`And`版本更简单，尽管我会使用`Recordcount`自己。

**按照您修改后的问题进行编辑：**

从您添加到问题中的代码中，我看到了几个问题，主要是您的 SQL 语句丢失和`ORDER BY`子句。
问题是您希望结果集位于`Begin Order`后面的`End Order`序列中，但您的 SQL 语句并不能保证这一点。
在大多数情况下，由于您使用自动增量作为 ID，数据库引擎将按自然顺序返回数据，但不能保证：

*   它总是会这样发生
*   原始数据按预期顺序保存，导致 ID 的顺序“错误”。

因此，只要您对结果集的顺序有期望，就必须明确对其进行排序。

我还将重构这段代码：

```
' ids are autoincrement long integers '
SQLString = "select * from Orders where type = OrderBegin or type = OrderEnd"           

Dim OrderOpen as Boolean
OrderOpen = False

Set rs = db.Openrecordset(SQLString)
If rs.bof <> True And rs.eof <> True Then
   myrec.movelast
    If rs.fields("type").value = BeginOrder Then
        OrderOpen = True
    End If
End If 
```

变成一个单独的函数，类似于：

```
' Returns true if the given CustID has a Open Order, '
' false if they are all closed.'
Public Function IsOrderOpen(CustID as Long) As Boolean
    Dim result as Boolean
    result = False

    Dim sql as String
    ' Here I assume that the Orders table has a OrderDateTime field that '
    ' allows us to sort the order in the proper chronological sequence '
    ' To avoid loading the complete recordset, we sort the results in a way '
    ' that will return the last used order type as the first record.'
    sql = sql & "SELECT Type " 
    sql = sql & "FROM Orders "
    sql = sql & "WHERE ((type = OrderBegin) OR (type = OrderEnd)) "
    sql = sql & "      AND (CustID=" & CustID & ")"
    sql = sql & "ORDER BY OrderDateTime DESC, Type DESC;"

    Dim db as DAO.Database
    Dim rs as DAO.Recordset
    Set db = CurrentDB()
    Set rs = db.Openrecordset(sql, dbOpenForwardOnly)

    If Not (rs Is Nothing) Then
        If rs.RecordCount > 0 Then
            result = (rs!type = BeginOrder)
        End If
        rs.Close
    End If

    Set rs = Nothing
    Set db = Nothing

    IsOrderOpen = result
End Function 
```

这将使整个事情更加健壮。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-20T23:40:19.377

@Renaud Bompuis 的回答非常好。让我强调一点，对于非空记录集，DAO 记录计数永远不会为零，这是我在确定记录集是否返回记录时唯一测试过的。我使用 .EOF 循环遍历记录，但在我已经测试过是否返回记录之前不要开始单步执行记录。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-19T00:38:11.427

我一直使用的模式是：

```
Set rs = db.OpenRecordset(...)

Do while Not rs.EOF

    ' Rest of your code here.

    rs.MoveNext
Loop 
```

我从未见过这种失败（还没有！）。此处对此进行了描述：[如何：检测 DAO 记录集的限制](http://msdn.microsoft.com/en-us/library/bb243790.aspx)

顺便说一句，Allen Browne 的 VBA Traps: [Working with Recordsets](http://allenbrowne.com/ser-29.html)可能很有趣。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-05-11T23:38:57.750

我偶尔会在访问中遇到完全相同的错误（今天在 Access 2007 中将它链接到 sql server 后端），其中语句

如果 rst.bof 和 rst.eof

尽管 rst 表示空记录集，但计算结果为 false。当它发生时，VBA 启动并且直接窗格中的调试器显示，确实 rst.bof 为真，rst.eof 为真，所以它似乎发生了一毫秒，然后被纠正，但在测试了逻辑之后。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-19T07:27:14.143

这是DAO，对吧？我自己更像是一个 ADO 人，但 IIRC 在某些情况下（动态集？）您需要导航 EOF 以便评估最终的行数。在这种状态下，EOF 是否为真，BOF 是否为假（因为它尚未被导航），但一旦 BOF 被导航，它就为真（显然）并且 EOF 仍然为真。据推测，当预期为零行时的初始状态*应该*是瞬时的，但五年一次的异常时间事件意味着您在非常早期的初始状态中捕获了它？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-08-20T12:58:55.370

[这是一个可能的解决方案](https://stackoverflow.com/questions/1303159/why-is-the-newrecord-property-lying-to-me/1305998#1305998)

可能是您的表单或模块已损坏。导出/导入受影响的模块或表单，或尝试 /decompile 选项。在我的情况下，一个查询在不应该有的时候返回空，但我认为核心问题可能是相似的。

# iphone - 没有 Interface Builder 的 iPhone 开发最好的教程是什么？

> ID：1015831
> 
> 赞同：6
> 
> 时间：2009-06-19T00:09:39.863
> 
> 标签：iphone

我尝试了 Interface Builder，但我更愿意只编写代码。我理解这是合理的，许多 iPhone 开发人员不使用 IB。

有谁知道这方面的任何好的教程/资源？

到目前为止，我发现的只有这个视频： http: [//www.vimeo.com/3363949](http://www.vimeo.com/3363949)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-19T00:25:31.813

你需要这样的东西：http: [//lapcatsoftware.com/blog/2007/07/10/working-without-a-nib-part-5-open-recent-menu/](http://lapcatsoftware.com/blog/2007/07/10/working-without-a-nib-part-5-open-recent-menu/)

这里的相关问题：[Cocoa without Interface Builder, initialize an instance of app controller?](https://stackoverflow.com/questions/622998/cocoa-without-interface-builder-initialize-an-instance-of-app-controller)

可以在这里找到更具体的 iPhone 教程：[http ://www.iphonemusings.com/2009/01/iphone-programming-tutorial-creating.html](http://www.iphonemusings.com/2009/01/iphone-programming-tutorial-creating.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T00:29:27.560

我在 iPhone 教程中使用[了 iCodeBlog](http://icodeblog.com/category/interface-builder/)。他们工作得很好。这是界面构建器类别

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T19:59:27.300

我会推荐这本书：

**iPhone SDK 应用程序开发** 作者：Jonathan Zdziarski

[http://oreilly.com/catalog/9780596154059/](http://oreilly.com/catalog/9780596154059/)

所有示例和解释都没有界面生成器。

如果您居住在大城市（例如旧金山）、为大公司工作或正在上大学，您可能可以访问 Safari Online。这本书可以在网上找到。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-09-04T14:10:22.303

“开始 iPhone 3 开发”真的让我快速上手。

[http://iphonedevbook.com/](http://iphonedevbook.com/)

之后，Apple 指南和课程文档...

# regex - 这些 Perl 正则表达式是什么意思？

> ID：1015834
> 
> 赞同：0
> 
> 时间：2009-06-19T00:09:55.010
> 
> 标签：regex, perl

下面的语法在 Perl 中是什么意思？

```
$line =~ /([^:]+):/; 
```

和

```
$line =~ s/([^:]+):/$replace/; 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-06-19T00:13:52.850

请参阅[perldoc perlreref](http://perldoc.perl.org/perlreref.html#CHARACTER-CLASSES)

```
[^:] 
```

是匹配除 之外的任何字符的字符类`':'`。

```
[^:]+ 
```

表示匹配一个或多个这样的字符。

我不确定是否需要捕获括号。任何状况之下，

```
([^:]+): 
```

捕获一个或多个非冒号字符后跟冒号的序列。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-19T01:04:10.440

```
$line =~ /([^:]+):/; 
```

=~ 运算符称为[绑定运算符](http://perldoc.perl.org/perlop.html#Binding-Operators)，它运行[正则表达式](http://perldoc.perl.org/perlop.html#m/PATTERN/msixpogc)或对标量值（在本例中为 $line）进行[替换。](http://perldoc.perl.org/perlop.html#s/PATTERN/REPLACEMENT/msixpogce)至于正则表达式本身，请`()`指定一个捕获。捕获将匹配它们的文本放在特殊的全局变量中。这些变量从 1 开始编号，并对应于括号出现的顺序，所以给定

```
"abc" =~ /(.)(.)(.)/; 
```

`$1`变量将包含，`"a"`变量`$2`将包含`"b"`，并且`$3`变量将包含`"c"`（如果您还没有猜到`.`匹配一个字符`*`）。 `[]`指定一个字符类。字符类将匹配其中的一个字符，因此`/[abc]/`如果它是 、 或 ，则将匹配`"a"`一个`"b"`字符`"c"`。可以通过以 . 开头来否定字符类`^`。否定字符类匹配一个未在其中列出的字符，因此`[^abc]`将匹配一个不是`"a"`, `"b"`, or的字符`"c"`（例如，`"d"`将匹配）。`+`称为量词。量词告诉你前面的模式必须匹配多少次。 `+`要求模式匹配一​​次或多次。（`*`量词要求模式匹配零次或多次）。对`:`正则表达式引擎没有特殊含义，因此它仅表示文字`:`.

因此，将这些信息放在一起，我们可以看到正则表达式将匹配一个或多个非冒号字符（将此部分保存为`$1`），后跟一个冒号。

```
$line =~ s/([^:]+):/$replace/; 
```

这是一个替代品。替换有两部分，正则表达式和替换字符串。正则表达式部分遵循与普通正则表达式相同的所有规则。替换部分被视为双引号字符串。替换用替换替换与正则表达式匹配的任何内容，因此给出以下代码

```
my $line    = "key: value";
my $replace = "option";

$line =~ s/([^:]+):/$replace/; 
```

$line 变量将保存字符串`"option value"`。

您可能会发现阅读很有用[`perldoc perlretut`](http://perldoc.perl.org/perlretut.html)。

`*`除了换行符，除非使用 /m 选项，在这种情况下它匹配任何字符

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-19T00:40:45.197

我可能误解了前面的一些答案，但我认为第二个例子让人困惑。它**不会**只用 $replaced 替换捕获的项目（即，一个或多个非冒号直到冒号）。它将全部替换为`([^:]+):`-`$replace`冒号。（替换作用于比赛，而不仅仅是捕获。）

这意味着如果你不包含冒号`$replace`（并且你想要一个），你会得到一点：

```
my $line = 'http://www.example.com/';
my $replace = 'ftp';
$line =~ s/([^:]+):/$replace/;
print "Here's \$line now: $line\n"; 
```

输出：

```
Here's $line now: ftp//www.example.com/ # Damn, no colon! 
```

我不确定您是否只是在查看示例代码，但除非您打算使用捕获，否则我不确定您是否真的想要在这些示例中使用它。

如果你对正则表达式（或 Perl）非常不熟悉，你应该在[`perldoc perlrequick`](http://perldoc.perl.org/perlrequick.html)尝试之前先看一下[`perldoc perlre`](http://perldoc.perl.org/perlre.html)or [`perldoc perlretut`](http://perldoc.perl.org/perlretut.html)。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-19T00:13:55.563

第一个从一行中捕获冒号前面的部分，例如字符串“abc:foo”中的“abc”。更准确地说，它直接在冒号之前匹配至少一个非冒号字符（尽管尽可能多），并将它们放入捕获组中。

第二个替换了所述部分，尽管这次*将*冒号替换为变量的内容`$replace`。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-23T19:24:42.847

perl -MYAPE::Regex::Explain -e "打印 YAPE::Regex::Explain->new('([^:]+):')->explain"

```
The regular expression:

(?-imsx:([^:]+):)

matches as follows:

NODE                     EXPLANATION
----------------------------------------------------------------------
(?-imsx:                 group, but do not capture (case-sensitive)
                         (with ^ and $ matching normally) (with . not
                         matching \n) (matching whitespace and #
                         normally):
----------------------------------------------------------------------
  (                        group and capture to \1:
----------------------------------------------------------------------
    [^:]+                    any character except: ':' (1 or more
                             times (matching the most amount
                             possible))
----------------------------------------------------------------------
  )                        end of \1
----------------------------------------------------------------------
  :                        ':'
----------------------------------------------------------------------
)                        end of grouping
---------------------------------------------------------------------- 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-19T00:13:47.407

你想返回匹配一个或多个字符的东西，除了 : 后跟一个 : ，第二个你想做同样的事情，但用 $replace 替换它。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-19T00:14:50.757

```
$line =~ /([^:]+):/; 
```

匹配任何不包含 : before :/

如果 $line = " [http://www.google.com](http://www.google.com) "，它将匹配 http（变量 $1 将包含 http）

```
$line =~ s/([^:]+):/$replace/; 
```

这一次，替换变量$replace内容匹配的值

# makefile - 使用 makefile 分离对象和源

> ID：1015836
> 
> 赞同：2
> 
> 时间：2009-06-19T00:11:25.087
> 
> 标签：makefile, posix, sh

我一直无法让我的 makefile 以我想要的方式工作。首先，我想说这是 POSIX make，如[http://www.opengroup.org/onlinepubs/009695399/utilities/make.html](http://www.opengroup.org/onlinepubs/009695399/utilities/make.html)我需要我的构建系统同时使用 BSD 和 GNUs(Linux) .

我想要的是一个零维护的makefile。我希望它只编译 src/ 中的所有 .c 和 .asm 文件，并将目标文件放在 objs/ 中，然后将 objs/ 中的所有内容链接到二进制文件。

我可以做很多事情，但我无法将源文件和 obj 文件分开。

如果这需要一点内置的 shell 脚本（使用 POSIX 定义的 /bin/sh），我可以，但我不能让依赖项正常工作。如果源文件较新，我希望它只构建目标文件。

我最接近的是：

```
${C_OBJS}: ${HDRS} ${*:objs/%=src/%}.c
    ${CC} ${CFLAGS} -c ${*:objs/%=src/%}.c -o $*.o

```

这有一个问题，我仍然必须指定 C_OBJS=objs/foo.o 等等，而且它几乎不是 POSIX，因此用 BSD make 而不是 GNU make 编译。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-19T02:12:39.427

POSIX 版本的 make 不明确支持带有斜杠的文件名，也没有规定将不同目录中的源文件与目标文件分开。而且，正如@caskey 所指出的，它不支持使用 ' `%`' 字符的任何表示法，尽管它指出存在此类规则并建议将它们保留用作元字符。

因此，您可能无法使用标准 POSIX 做您想做的事情`make`。

`make`在实践中，您通常可以使用`makefile`.

考虑使用某种生成文件生成系统 -`cmake`或自动工具（`autoconf`、`libtool`、`automake`等）。或者是对以下基本概念的众多修改之一`make`：

*   司康
*   蚂蚁
*   蛋糕
*   厨师
*   胸罩
*   ...*还有十几个我已经忘记或没听说过*...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T00:19:23.493

POSIX make 不支持类似的构造？

```
 objs/%.o : src/%.c
    ${CC} ${CFLAGS} -c $< -o $@ 
```

忘了最后的问号，希望能让我的评论更清楚。

# updatepanel - updatepanel __dopostback 命中 .update() 但不刷新

> ID：1015839
> 
> 赞同：1
> 
> 时间：2009-06-19T00:12:29.670
> 
> 标签：updatepanel

我有一个包含两个更新面板的页面，每个更新面板都有一个动态生成的 gridview。Updatepanel1 在计时器上每十秒刷新一次。当在第一个网格中选择一个项目时，第二个更新/网格刷新。

我正在尝试使用 __doPostBack 来完成这一壮举。此方法确实到达服务器并在 updatepanel2 上运行我的 .update。我看到 updatepanel2 获取数据，但表单从未真正更新 updatepanel2。

只有当 updatepanel1 计时器滴答作响并且我将 updatepanel2 模式设置为“始终”时，我才能让 updatepanel2 显示数据。

有人有什么建议吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-24T00:31:18.737

好吧，我解决了这个问题。我修改为使用以下方法进行 doPostBack 调用。

[http://encosia.com/2007/07/13/easy-refresh-an-updatepanel-using-javascript/](http://encosia.com/2007/07/13/easily-refresh-an-updatepanel-using-javascript/)

希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-01-14T23:57:44.260

我看到你回答了你自己的问题，但是为了其他人的利益，而不是 doPostBack()，为什么不在 Timer 上设置两者以在指定的时间间隔刷新，或者作为带有“UpdatePanel1.Update()”的 Tick 事件方法在方法的最后？为此，您需要在 Default.aspx 页面代码本身中设置间隔；我选择了 10 毫秒，这样它就可以显示一个非常快速的操作的进度：

```
<asp:ScriptManager ID="ScriptManager1" runat="server" AsyncPostBackTimeout="360000" />
<asp:Button ID="btnDoSomething" runat="server" Text="Do Something" OnClick="btnDoSomething_Click" />
 <asp:UpdatePanel ID="UpdatePanel1" runat="server" OnLoad="UpdatePanel1_Load" UpdateMode="conditional"> 
    <ContentTemplate>
        <span id="spnLabel" runat="server">
        <asp:Timer ID="Timer1" runat="server" Interval="10" OnTick="Timer1_Tick"></asp:Timer> 
    </ContentTemplate>         
    <Triggers >
        <asp:AsyncPostBackTrigger ControlID="Timer1" EventName="Tick" />
    </Triggers>
 </asp:UpdatePanel> 
```

然后在有更新时调用的代码隐藏中添加 Timer1_Tick 方法 - 在此示例中，从 btnDoSomething_Click() 方法添加到 spnLabel.InnerHtml 的内容：

```
protected void btnDoSomething_Click(object sender, EventArgs e)
{
     Timer1.Enabled = true;
     Timer1.Interval = 10;
     Timer1_Tick(sender, e);
     Timer1.Enabled = false;
}
protected void Timer1_Tick(object sender, EventArgs e)
{
     spnLabel.InnerHtml = "hi";
     UpdatePanel1.Update();
} 
```

请记住，刷新由 Timer 间隔控制，而不是由您调用 Timer1_Tick(sender,e) 时控制，即使最后有一个 UpdatePanel1.Update() - 例如，如果您将间隔设置为 10000，它将更新10 秒后，即使您的操作在此之前多次使用 Timer1_Tick() 方法。不过，无论如何，您最后仍然需要一个 UpdatePanel1.Update()。

-汤姆

# javascript - 如何从字符串中删除所有字符

> ID：1015844
> 
> 赞同：11
> 
> 时间：2009-06-19T00:13:31.213
> 
> 标签：javascript, regex, string

如何使用 JavaScript RegEx 从字符串中删除不是字母的所有字符？

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2009-06-19T00:17:18.723

您可以使用以下[`replace`](http://www.w3schools.com/jsref/jsref_replace.asp)方法：

```
'Hey! The #123 sure is fun!'.replace(/[^A-Za-z]+/g, '');
>>> "HeyThesureisfun" 
```

如果你想保留空格：

```
'Hey! The #123 sure is fun!'.replace(/[^A-Za-z\s]+/g, '');
>>> "Hey The sure is fun" 
```

正则表达式`/[^a-z\s]/gi`基本上是说要匹配任何不是字母 az 或空格 (\s) 的内容，同时全局执行此操作（`g`标志）并忽略字符串的大小写（`i`标志）。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2011-12-16T03:46:16.397

[使用的RegEx](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/RegExp)实例属性`g`，`i`

> global ：是针对字符串中所有可能的匹配项测试正则表达式，还是仅针对第一个匹配项进行测试。
> 
> ignoreCase ：在尝试匹配字符串时是否忽略大小写。

[使用RegEx](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/RegExp)特殊字符`[a-z]`，`+`

> [^xyz] ：否定或补充字符集。也就是说，它匹配任何未包含在括号中的内容。您可以使用连字符指定字符范围。
> 
> 例如，`[abcd]`与 相同`[a-d]`。它们与“brisket”中的“b”和“chop”中的“c”相匹配。
> 
> + ：匹配前一项 1 次或多次。等价于 {1,}。

JavaScript[字符串替换](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/String)方法语法

> str.replace(regexp|substr, newSubStr|function[, Non-standard flags]);

非标准标志`g`&`i`可以在替换语法中传递或内置到正则表达式中。例子：

```
var re = /[^a-z]+/gi;   var str = "this is a string";   var newstr = str.replace(re, "");   print(newstr);

var str = "this is a string";   var newstr = str.replace(/[^a-z]+/, "", "gi");   print(newstr); 
```

为了匹配空白字符以及 \s 将被添加到正则表达式`[^a-z\s]+`中。

[JavaScript 参考](https://developer.mozilla.org/en/JavaScript/Reference)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2011-12-19T22:19:05.687

[ECMAScript](http://www.ecma-international.org/publications/standards/Ecma-262.htm)实现中的正则表达式在[Mozilla Developer Network（以前称为 Mozilla Developer Center）](https://developer.mozilla.org/)的[JavaScript 语言参考](https://developer.mozilla.org/en/JavaScript/Reference/)pp的[`RegExp`文章中得到了最好的解释。](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/RegExp)

但是，如前所述，前面的答案没有考虑*非英文*字母，例如变音符号和重音字母。为了不从字符串中删除这些字母，您必须将它们从字符范围中排除，如下所示：

```
var s = "Victor 1 jagt 2 zwölf 3 Boxkämpfer 4 quer 5 über 6 den 7 Sylter 8 Deich";

s = s.replace(/[^a-zäöüß]+/gi, ""); 
```

这种方法很快就会变得乏味且难以维护，尤其是在需要考虑*多种自然语言的情况下（即使在正确的英语中也有诸如“* *déjà vu* ”和“ *fiancé* ”之类的外来词）。

因此，在其他[PCRE](http://www.pcre.org/)功能中，[JSX:regexp.js允许您通过](http://pointedears.de/websvn/filedetails.php?repname=JSX&path=%2Ftrunk%2Fregexp.js)[Unicode 字符数据库 (UCD)](http://unicode.org/ucd/) 使用可以使用 Unicode 属性类的正则表达式。

然后你会写¹

```
var s = "Victor 1 jagt 2 zwölf 3 Boxkämpfer 4 quer 5 über 6 den 7 Sylter 8 Deich";

var rxNotLetter = new jsx.regexp.RegExp("\\P{Ll}+", "gi");

s = s.replace(rxNotLetter, ""); 
```

或者

```
var s = "El 1 veloz 2 murciélago 3 hindú 4 comía 5 feliz 6 cardillo 7 y 8 kiwi. La cigüeña tocaba el saxofón detrás del palenque de paja"
      + " – Съешь 1 же 2 ещё 3 этих 4 мягких 5 французских 6 булок, да 7 выпей 8 чаю.";

var rxNotLetterOrWhitespace = new jsx.regexp.RegExp("[^\\p{Ll}\\p{Lu}\\s]+", "g");

s = s.replace(rxNotLetterOrWhitespace, ""); 
```

减少对实现的大写/小写怪癖的依赖（并且更具可扩展性），对于`RegExp`排除所有非字母 Unicode 字符（以及第二个示例中的空白）的 a。

[测试用例](http://PointedEars.de/scripts/test/regexp)

请务必同时提供 Unicode 字符数据库的版本，因为它很大且不断变化，因此未内置在 regexp.js 中（JSX 包含 UCD 的详细文本和压缩脚本版本；两者都可以使用，并且后者是首选，由 regexp.js）。请注意，[符合标准的 ECMAScript 实现不需要支持基本多语言平面（U+0000 到 U+FFFF）之外的字符](http://ecma-international.org/ecma-262/5.1/#sec-2)，因此`jsx.regexp.RegExp`即使它们在 UCD 中，目前也无法支持这些字符。有关详细信息，请参阅源代码中的文档。

¹来自免费百科全书[Wikipedia的](http://wikipedia.org/)[Pangrams 。](http://en.wikipedia.org/wiki/Pangram)

# c# - 在 XAML 中设置命令目标

> ID：1015851
> 
> 赞同：8
> 
> 时间：2009-06-19T00:15:38.667
> 
> 标签：c#, wpf, xaml, routedcommand

我很难理解 RoutedCommand 的 CommandTarget 属性。

基本上，我有一些在用户控件（而不是窗口）中实现的静态命令。我在用户控件中创建了一个命令绑定。如果我在用户控件中声明按钮，那么我可以使用我的路由事件。但是，当按钮位于用户控件之外时，我无法使用路由事件。我认为命令目标将解决我的问题。

那么如何为工具栏用户控件的按钮设置commandtarget，以便调用Container的Executed和CanExecuted呢？

**使用 micahtan 更改更改的编辑代码，但我仍然无法将其转换为 CanExecute 或 Execute。**

窗口 XAML：

```
<Window x:Class="RoutedCommands.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="clr-namespace:RoutedCommands"
    xmlns:toolbar="clr-namespace:RoutedCommands.Toolbar"
    Title="Window1" Height="300" Width="300">
    <StackPanel>
        <local:Container Width="100" Height="25" x:Name="MyContainer" />
        <toolbar:Toolbar Width="100" Height="25" CommandTarget="{Binding MyContainer}" />
    </StackPanel>
</Window> 
```

工具栏 XAML：

```
<UserControl x:Class="RoutedCommands.Toolbar.Toolbar"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="clr-namespace:RoutedCommands"
    x:Name="MyToolbar"
    Height="300" Width="300">
    <Grid>
        <Button Command="{x:Static local:Commands.MyCommand}" Content="Try Me" CommandTarget="{Binding ElementName=MyToolbar, Path=CommandTarget, Mode=OneWay}" />
    </Grid>
</UserControl> 
```

工具栏 CS：

```
 public partial class Toolbar : UserControl
    {
        public Toolbar()
        {
            InitializeComponent();
        }

        // Using a DependencyProperty as the backing store for CommandTarget.  This enables animation, styling, binding, etc...
        public static readonly DependencyProperty CommandTargetProperty =
                DependencyProperty.Register("CommandTarget", typeof(IInputElement), typeof(Toolbar), new UIPropertyMetadata(null));

        public IInputElement CommandTarget
        {
            get { return (IInputElement)GetValue(CommandTargetProperty); }
            set { SetValue(CommandTargetProperty, value); }
        }
    } 
```

容器 XAML：

```
<UserControl x:Class="RoutedCommands.Container"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="clr-namespace:RoutedCommands"
    Height="300" Width="300">
    <UserControl.CommandBindings>
        <CommandBinding Command="{x:Static local:Commands.MyCommand}" CanExecute="CommandBinding_CanExecute" Executed="CommandBinding_Executed" />
    </UserControl.CommandBindings>
    <Grid>
        <Button Command="{x:Static local:Commands.MyCommand}" Content="Click Me" />
    </Grid>
</UserControl> 
```

集装箱 CS：

```
public partial class Container : UserControl
{
    public Container()
    {
        InitializeComponent();
    }

    private void CommandBinding_Executed(object sender, ExecutedRoutedEventArgs e)
    {
        Console.WriteLine("My Command Executed");
    }

    private void CommandBinding_CanExecute(object sender, CanExecuteRoutedEventArgs e)
    {
        Console.WriteLine("My Command Can Execute");
        e.CanExecute = true;
    }
} 
```

路由命令：

```
namespace RoutedCommands
{
    public static class Commands
    {
        public static readonly RoutedUICommand MyCommand = new RoutedUICommand(); 
    }
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-19T05:23:25.073

如果您想使用 CommandTargets，我将在您的自定义 UserControl 上创建一个 CommandTarget DependencyProperty，类似于在 ButtonBase 上定义的方式。

之后，将 Button 的 CommandTarget 设置为自定义 UserControl 的 CommandTarget。

**编辑：代码示例**

如果你正在做一个 MVVM 架构，Rudi 的评论是有效的——在这种情况下，RelayCommands 或其他形式的包装委托工作得很好。根据您的代码示例，您似乎并没有使用这种方法，因此是我的原始评论。

至于代码，您只需要更改您的 ToolBar 类。这假设您的 MyCommand 类继承自 RoutedUICommand。这是 XAML：

```
<UserControl
    x:Class="WPFCommandTarget.CustomToolBar"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="clr-namespace:WPFCommandTarget"
    x:Name="theControl">
    <Grid>
        <Button
            x:Name="theButton"
            Command="{x:Static local:Commands.MyCommand}"
            CommandTarget="{Binding ElementName=theControl, Path=CommandTarget, Mode=OneWay}"
            Content="Try Me" />
    </Grid>
</UserControl> 
```

这是代码隐藏：

使用 System.Windows；使用 System.Windows.Controls；

```
namespace WPFCommandTarget
{
    /// <summary>
    /// Interaction logic for CustomToolBar.xaml
    /// </summary>
    public partial class CustomToolBar : UserControl
    {
        public CustomToolBar()
        {
            InitializeComponent();
        }

        public IInputElement CommandTarget
        {
            get { return (IInputElement)GetValue(CommandTargetProperty); }
            set { SetValue(CommandTargetProperty, value); }
        }

        // Using a DependencyProperty as the backing store for CommandTarget.  This enables animation, styling, binding, etc...
        public static readonly DependencyProperty CommandTargetProperty =
            DependencyProperty.Register("CommandTarget", typeof(IInputElement), typeof(CustomToolBar), new UIPropertyMetadata(null));
    }
} 
```

请注意，我在我的测试项目中更改了一些类名/命名空间。您必须更改它们以满足您的需要。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T06:34:23.490

您是否考虑过使用 RelayCommand 或 DelegateCommand！你可能更适合你的需要？

有关使用 RelayCommand 的示例，请阅读Josh 的[这篇](http://msdn.microsoft.com/en-us/magazine/dd419663.aspx)文章

[Brian Noyes在这里](http://msdn.microsoft.com/magazine/cc785480.aspx?pr=blog)也有一篇很棒的文章

# spring - 我可以使用 AOP 注释在 spring 中注入代码吗？

> ID：1015852
> 
> 赞同：4
> 
> 时间：2009-06-19T00:15:48.057
> 
> 标签：spring, aop, spring-aop

是否可以执行以下操作：

 `````
public void doStuff(@RequirePrivilege("foo") User user) {
    // ...
} 
````  `并让它像下面这样有效地运行？

 `````
public void doStuff(User user) {
    if(!user.hasPrivilege("foo"))
        throw new UserHasInsufficientPrivileges(); // this is a RuntimeException
    // ...
} 
````  `我知道 Spring 有各种 AOP 支持，但我能找到的最好的是 AOP 代码，它经过注释，以便在特定方法之前或之后执行。我想做相反的事情并注释应该更改的代码。

最终，我可以在方法内部进行上述检查，但是注释的处理方式提供了额外的文档，这使得用户需要特定的权限而无需使文档与代码保持同步。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T00:46:39.430

我确定您的“权限不足”示例可以使用[Spring AOP](http://static.springframework.org/spring/docs/2.5.x/reference/aop.html)完成，因为这就是 Spring Security 的工作方式。您可以使用周围的建议和 AspectJ 做一些非常复杂的事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-09-24T01:44:43.003

您可以考虑使用 AspectJ 来执行此操作，因为它会匹配注释。然后，您可以使用环绕方面来确定用户是否满足使用此方法的要求。

Spring 允许您使用 AspectJ，我建议您尽可能不要在运行时执行此操作，而是在编译时执行此操作，因为在启动应用程序时没有理由为使用此方面付出代价。但是，如果你必须在运行时这样做，那么这是可行的，对我来说，我尝试尽可能多地使用编译时。

您可能想查看 AspectJ In Action ( [http://www.manning.com/laddad2/](http://www.manning.com/laddad2/) )，但这里有一个示例：签名模式：

```
* *(@RequestParam
(@Sensitive *)) 
```

描述

```
*Any method with one parameter marked with the @RequestParam annotations and the parameter’s type is marked with the @Sensitive annotation.* 
```

例子

```
void create(@RequestParam
MedicalRecord mr), assuming
MedicalRecord carries the
@Sensitive annotation. 
```````

# c# - 深度 C#：问题集？

> ID：1015857
> 
> 赞同：7
> 
> 时间：2009-06-19T00:17:26.337
> 
> 标签：c#, c#-3.0

现在我正在阅读“深度 C#”。缺少的一件事是完成一章后我可以解决的一系列问题。这将有助于我理解我刚刚学到的概念。

有什么地方可以找到 C#3.0 的好问题集吗？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-19T01:13:31.653

您可以尝试[LINQ 101 示例](http://msdn.microsoft.com/en-us/vcsharp/aa336746.aspx)，它们几乎涵盖了 C# 3.0 和 Linq 的大部分内容，您可以看到问题并尝试重写代码

# javascript - URL Bar id=1 进入 jQuery ID

> ID：1015870
> 
> 赞同：1
> 
> 时间：2009-06-19T00:22:10.290
> 
> 标签：javascript, jquery, html, hyperlink

我想从 url 栏中获取 id 并将其插入到 href

$("a[href='send_message.php?act=pm&id=$id']").colorbox({width:"500", height:"350", iframe:true});

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-19T00:24:45.387

有一个 jquery 插件可以使这变得非常简单：

见： http: [//plugins.jquery.com/project/query-object](http://plugins.jquery.com/project/query-object)

例如

```
var id = $.query.get('id');
$("a[href='send_message.php?act=pm&id="+id+"']").colorbox({width:"500", height:"350", iframe:true}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T00:37:32.677

对于那些不使用 jQuery 或任何其他 JS 库的人：

```
var searchString = document.location.search;  

// strip off the leading '?'
searchString = searchString.substring(1);

var gvPairs = searchString.split("&");
var getVars = [];

for (i = 0; i < gvPairs.length; i++)
{
    var gvPair = gvPairs[i].split("=");
    getVars[gvPair[0]] = gvPair[1];
} 
```

所以如果 URL 字符串是 index.php?id=3&page=2&display=10 那么：
`getVars['id'] = 3;`
`getVars['page'] = 2;`
`getVars['display'] = 10;`

# asp.net - 为什么服务器忽略对非 ASPX 文件的重写？

> ID：1015886
> 
> 赞同：0
> 
> 时间：2009-06-19T00:32:34.793
> 
> 标签：asp.net, iis, url-rewriting

在本地这有效，但在服务器上，当我执行 /user/profile 之类的操作时，我得到一个 404，但是如果我执行 /user/profile.aspx 它可以工作。我还将图像从 /s/example.png 重写为 /localLocation/example.png，这不起作用。如果我写 /localLocation/example.png 它确实会出现，但是它违背了我重写的目的。此外，如果我将 .aspx 附加到任何路径的末尾，我会得到一个显示重写地址的默认页面。这是正确的，但前提是我添加了 .aspx。如何让服务器将重写应用于所有路径？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-19T01:29:24.710

问题是 IIS 只为某些扩展调用 ASP .Net。

您需要配置 IIS 以使用 ASP .Net 来处理您想要重写的每个扩展。

**编辑**

如果您的 Web 主机在集成模式下运行 IIS 7（询问他们），您需要将`HttpModule`处理重写`modules`的`system.webserver`. 看[这里](http://ruslany.net/2008/09/wildcard-script-mapping-and-iis-7-integrated-pipeline/)

# c# - Visual Studio 最近的项目列表

> ID：1015888
> 
> 赞同：23
> 
> 时间：2009-06-19T00:33:10.893
> 
> 标签：c#, .net, visual-studio

在 VS2008 或任何版本的起始页中，有一种方法可以摆脱“入门”和“Visual Studio 标题”列表，并让“最近的项目”列表一直延伸到底部，所以我可以看到我最近使用过的 30 个左右的项目吗？

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2009-06-19T00:35:31.213

如果您想在该列表中显示更多项目，可以在“工具”>“选项”>“环境”>“常规”中增加它。将“最近使用列表中显示的项目”更改为 24（最大值）。

其他部分将溢出页面，您将能够滚动查看它们。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-06-19T00:37:07.250

在 Visual Studio 中，选择“工具”->“选项”。在那里，您可以选择最近使用列表中的项目数量。

除非您想自定义起始页，否则您无法摆脱其他部分，但如果您将其设置为 24，您将看到您最近的 24 个项目（它们不允许您查看超过 24 个）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-10-01T07:31:05.367

工具 > 选项 > 环境 > 常规。将“最近使用列表中显示的项目”更改为 24（最大值）。我更喜欢最多使用 12 个。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-06-19T00:36:27.297

工具->选项->启动

# iphone - iPhone SDK中如何做雷达动画？

> ID：1015890
> 
> 赞同：2
> 
> 时间：2009-06-19T00:33:42.030
> 
> 标签：iphone, animation, core-animation

有谁知道如何制作如下图所示的雷达动画？ [替代文字 http://img197.imageshack.us/img197/7124/circle0.png](http://img197.imageshack.us/img197/7124/circle0.png)

随着它向外生长？我必须使用 Quartz 或其他方式绘制圆圈？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T06:58:01.157

在`UIView`子类中绘制静态圆：

```
- (void)drawRect:(CGRect)rect
{
    CGRect rect = { 0.0f, 0.0f, 100.0f, 100.0f };
    CGContextRef context = UIGraphicsGetCurrentContext();
    CGContextSetRGBStrokeColor(context, 1.0, 0.0, 0.0, 1.0);
    CGContextSetLineWidth(context, 2.0f);
    CGContextAddEllipseInRect(context, rect);
    CGContextStrokePath(context);
} 
```

从那里您只需要使用计时器对其进行动画处理，改变矩形的大小并添加更多圆圈。

# content-type - HttpWebResponse 上的 ContentType 属性是否有枚举（“text/plain”、“application/octet-stream”等）？

> ID：1015892
> 
> 赞同：56
> 
> 时间：2009-06-19T00:35:24.787
> 
> 标签：content-type, mime-types, httpwebresponse

我能找到的最接近的东西是，`System.Net.Mime.MediaTypeNames`但它似乎没有一切（如 json），因为它似乎更关注电子邮件附件。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-06-19T00:43:15.943

枚举没有多大意义。MIME 类型是开放式的。也就是说，列表不是有限的：不时添加新类型。

请参阅[RFC4288：媒体类型规范和注册程序](http://www.ietf.org/rfc/rfc4288.txt?number=4288)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-19T00:42:34.040

[IANA 的数据库](http://www.iana.org/assignments/media-types/)很可能是完整的。目前，他们有 CSV 格式的列表，位于`https://www.iana.org/assignments/media-types/application.csv`. 我假设这是一个稳定的 URL，其内容会随着更新而改变。如果您想保持最新状态，则需要组合一个适合您需求的机制。

还有 Apache 附带的[mime.types](http://svn.apache.org/viewvc/httpd/httpd/trunk/docs/conf/mime.types?view=co)文件，它似乎是从上述列表中派生的。

# java - 如何在 Eclipse 中查看 java 日志文件

> ID：1015904
> 
> 赞同：7
> 
> 时间：2009-06-19T00:39:24.483
> 
> 标签：java, xml, eclipse, logging

我正在 Eclipse 中运行一些 JUnit 测试，并且我的代码正在使用 java 日志记录 API 生成 XML 日志文件。（java.util.logging）。除了读取原始 XML 之外，是否有一种简单的方法可以在 Eclipse 中查看此 XML 日志输出？具体来说，我希望能够轻松查看不同日志消息来自哪些线程。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-19T04:11:58.510

我一直在使用[SLF4J](http://www.slf4j.org/)日志记录 API 和[Logback](http://logback.qos.ch/)日志记录实现。SLF4J 可以配置为将 java.util.logging、log4j、jakarta commons logging 和 SLF4j API 中的日志消息映射到一个通用的中间形式。另一方面，可以通过 java.util.logging、log4j 或 Logback 生成消息。这是一种运行良好的灵活方法，尤其是当您拥有使用不同日志记录 API 的组件时。

Logback 的一个好处是您可以将其配置为将日志消息的副本发送到[Eclipse 插件](http://logback.qos.ch/consolePlugin.html)。该插件可让您以多种方式查看和过滤日志文件。消息包含生成它们的线程，因此听起来您应该检查一下。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-08-22T14:56:47.577

我想你在找我一直在找的东西。我找到了 UtilLogger4E，但我开始了自己的项目（EDevTools LogViewer），因为它缺少一些功能并且不是开源的。

它能够从文件或可配置套接字中读取 Java Util Logging XML 日志，在表格中按级别显示它们，并且一次可以显示多个日志（通过多个视图实例）。

Java Util Logging 具有将日志发送到套接字（SocketHandler）的内置功能，它只能由配置文件设置。

您可以在以下位置查看 LogViewer：http: [//sourceforge.net/projects/edevtools/](http://sourceforge.net/projects/edevtools/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-06T17:30:40.687

如果你想使用不是基于 eclipse 的日志查看器，我推荐你[OtrosLogViewer](http://code.google.com/p/otroslogviewer)。我可以导入 java.util.logging XML 格式和 SimpleFormat。

**免责声明**：我是 OtrosLogViewer 的作者

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-19T01:14:22.963

我一直希望为 java.util.logging/Eclipse 组合找到类似[Apache Chainsaw](http://logging.apache.org/chainsaw/index.html)的东西，即 Eclipse 中的一个日志查看器，它监听一个端口和一个直接写入该端口的 java.util.logging.Handler 实现。但是我还没有找到这样的东西，也没有写一个。到目前为止，我只是使用合适的纯文本格式登录到控制台。不优雅也没有方便的过滤选项，但它可以完成工作。编写自己的自定义格式化程序一点也不难。

[在 Eclipse 的测试和性能工具平台项目](http://www.eclipse.org/tptp/)（名称比首字母缩写词更糟糕）中有一些对分析日志文件的支持。我从未尝试过，但它可能对你有用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-19T01:38:14.223

顺便说一句，用于实时查看日志文件的出色工具是 baretail（本质上是 Windows 上的 tail -f），但可以设置为突出显示某些颜色模式，这真的很有帮助。[您可以在此处](http://www.baremetalsoft.com/baretail/)找到免费版本。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-19T02:14:59.673

根据您正在尝试做什么，您可能只需要为您的日志记录子系统设置一个好的日志记录设置？

我最近使用的一个框架使用 slf4j 来记录，通过提供以下 log4j 配置，我可以查看哪些线程输出了什么：

```
log4j.rootLogger = trace, default
log4j.appender.default = org.apache.log4j.ConsoleAppender
log4j.appender.default.layout = org.apache.log4j.PatternLayout
log4j.appender.default.layout.ConversionPattern = %-4r [%t] %-5p %c %x - %m%n 
```

在我的情况下，当我运行 junit 测试时，我在 eclipse 的控制台选项卡中得到类似于以下内容的输出。

```
0    [pool-1-thread-1] INFO  com.example.BaseTest  - Server listening on port 9090
35   [NioProcessor-6] INFO  org.apache.mina.filter.logging.LoggingFilter  - CREATED
35   [NioProcessor-1] INFO  org.apache.mina.filter.logging.LoggingFilter  - CREATED 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-19T00:52:27.950

我看不出 Eclipse 如何知道您的线程。如果是 XML，您需要编写一个解析器，该解析器可以使用 XPath 找到您的线程消息并将它们打印出来。但这取决于你——Eclipse 无法读懂你的想法。

您必须找到一个 XSL-T 样式表，该样式表可以获取 log4j 生成的 XML 流并提取您想要的线程。

# jquery - 使用 jQuery 在表格中查找文本

> ID：1015910
> 
> 赞同：2
> 
> 时间：2009-06-19T00:41:52.810
> 
> 标签：jquery, textnode

我有一个表，其中包含这样的行：

```
<tr id="" class="objectRow">
  <td class="bulkSelector"><input id="" type="checkbox" value=""/></td>
  <td class="favorite"></td>
  <td class="name"><a id="" class="" href="">Ut Urna Nisl</a></td>
  <td class="description"><p>Nam feugiat tincidunt massa nec venenatis. Mauris egestas consectetur magna</p></td>
  <td class="modifiedDate"><p>5/20/2009</p></td>
</tr> 
```

我想创建一个包含所有文本元素的 jQuery 包装集，然后我可以将它们发送到函数，如果它们不适合它们的单元格，它将截断它们。

我不知道如何获得包装好的套装。

正在尝试这个，但它不起作用：

```
var textNodes = $('#resultsTable .objectRow')
.contents()
.filter(function(){ return this.nodeType == 3; })
.filter(function(){return this.nodeValue != null}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-19T00:45:10.383

jQuery 的[`text`](http://docs.jquery.com/Attributes/text)函数返回元素的组合文本内容，因此您不必担心 nodeTypes 等。因此，您可以过滤所有文本内容为空白的元素：

```
$('tr.objectRow', '#resultsTable').find('td').filter(function() {
    return $.trim($(this).text()) != '';
}); 
```

这将最终为您提供行中包含任何文本的所有s，并且您可以通过再次获取表格单元格`<td>`的值来做您想做的事情。`text()`

关于您的评论，应该这样做：

```
$('tr.objectRow', '#resultsTable').find('*').contents().filter(function() {
    return $.trim($(this).text()) != '';
}); 
```

# maven-2 - 哈德逊 cobertura 报告 0

> ID：1015913
> 
> 赞同：5
> 
> 时间：2009-06-19T00:44:34.987
> 
> 标签：maven-2, hudson, cobertura

我有一个问题，当我运行 cobertura 目标 maven 时，报告总是显示 0%。我试过分叉我的 junit 测试，但没有运气。我尝试在 pom 的报告部分和构建部分配置 cobertura 插件，并尝试将其绑定到站点和包阶段。有什么想法吗？

在相关的说明中，我还注意到在 hudson 内的 Cobertura 中运行测试会导致 junit 插件报告每个测试运行两次（这使报告为运行的测试数量增加了一倍）。有什么办法吗？

谢谢，

杰夫

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-19T23:39:03.720

JDK 1.6.0_14 和 cobertura 插件存在兼容性问题。而且该插件在多线程测试方面也存在问题。0% 问题已被使用的 JDK6 的 b7 修复，也许很快就会出现针对多线程的修复（有可用的补丁）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T03:02:24.443

我认为发布您定义 Cobertura 插件的 pom.xml 的任何部分以及您在个人资料中实际使用它的位置会很有帮助。你能提供这个，以便它为某人提供一些背景信息吗？虽然我确信复制/粘贴 [ [http://mojo.codehaus.org/cobertura-maven-plugin/usage.html]](http://mojo.codehaus.org/cobertura-maven-plugin/usage.html])不会帮助我们任何人，也许提供您的 <include> 和 <excludes> 可以帮忙。

# jquery - jQuery 的数据存储是如何运作的？

> ID：1015920
> 
> 赞同：2
> 
> 时间：2009-06-19T00:50:51.107
> 
> 标签：jquery

我最近问了一个与 jquery 的数据存储相关的问题。 [如何使用 data 方法从一个元素中获取所有数据集？](https://stackoverflow.com/questions/999535/how-to-get-from-an-element-all-the-data-set-using-the-data-method)

我想更好地了解数据存储，看看我是否可以解决我的问题（数据完整性）。

我理解“指向全局哈希表的数字指针”的想法[http://james.padolsey.com/javascript/element-datastorage/](http://james.padolsey.com/javascript/element-datastorage/)

但是看着jquery源，我很困惑：

```
 data: function( key, value ){
    var parts = key.split(".");
    parts[1] = parts[1] ? "." + parts[1] : "";

    if ( value === undefined ) {
        var data = this.triggerHandler("getData" + parts[1] + "!", [parts[0]]);

        if ( data === undefined && this.length )
            data = jQuery.data( this[0], key );

        return data === undefined && parts[1] ?
            this.data( parts[0] ) :
            data;
    } else
        return this.trigger("setData" + parts[1] + "!", [parts[0], value]).each(function(){
            jQuery.data( this, key, value );
        });
}, 
```

为什么使用 triggerHandler/trigger ？开发时我在哪里可以“看到”数据？

奥利维尔

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-19T02:41:03.707

部分答案：使用 jQuery.cache 可以找到 jQuery 的数据。

# entity-framework - 实体框架-“映射片段中的问题”-错误。帮我理解这个错误的解释

> ID：1015925
> 
> 赞同：51
> 
> 时间：2009-06-19T00:53:11.023
> 
> 标签：entity-framework

> > > 错误 3007：从第 186、205 行开始映射片段时出现问题：两个片段中的非主键列 [WheelID] 被映射到不同的概念侧属性 - 数据不一致是可能的，因为相应的概念侧属性可以是独立修改。

我在网上找到了几个描述此错误的地方，但我根本不理解它们。（困惑的笑脸在这里）

[一二](http://social.msdn.microsoft.com/Forums/en-US/adodotnetentityframework/thread/2823634f-9dd1-4547-93b5-17bb8a882ac2)[三四](http://techiethings.blogspot.com/2009/03/entity-framework-error-3007.html)
[_](http://marko.unite.si/post/2008/11/19/Problem-in-Mapping-Fragments-in-Visual-Studio-2008s-Entity-Model-designer.aspx) [_](http://earthli.com/news/view_article.php?id=2167)

这里有一些非常基本的东西，我一定错过了。你能解释一下，让我明白吗？也许在下面使用我的真实生活示例？

[![替代文字](../Images/19c02a97110c79199f847f7a4048f066.png)](https://i.stack.imgur.com/cgBmc.jpg)

外键 1:N Wheels.Id -> Slices.WheelId

我将它们添加到实体框架中，并且 WheelId 在 Slices-entity 中不可见。

[![替代文字](../Images/aa23bd6f0d21f914150e7ba7e1a0e736.png)](https://i.stack.imgur.com/bZKpx.jpg)

做一些解决方法（在将表添加到 EF 之前从数据库中删除关系 - 然后重新创建它并更新 EF）我设法让 WheelId 留在 Slices 中，但后来我得到了顶部提到的错误。

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2009-06-19T12:41:26.693

由于 Slices.WheelId 是一个 FK，因此您不能在您的客户端模型中公开它。不过，有一些方法可以获得价值。

```
var wheelId = someSlice.Wheels.ID; 
```

**更新**在 EF 4 中，您可以通过使用 FK 关联而不是独立关联来执行此操作。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2010-08-26T06:40:24.613

尝试使用实体模型设计从实体集中删除外部属性列，它将解决您的问题

例如

我们有两张表，一张是**客户**，另一张是**订单**，使用实体模型设计，我们在执行此 Ado.net 实体框架时添加了客户和订单之间的关联，我将在下表中添加导航属性。

像 Customer.Orders - 这里的订单是列表 Order.Customer

一多关系。

**因此，我们需要从Order**实体集中删除名为**CustomerId** [外键列] 的属性。

 **以供参考：

[http://social.msdn.microsoft.com/forums/en-US/adodotnetentityframework/thread/2823634f-9dd1-4547-93b5-17bb8a882ac2/](http://social.msdn.microsoft.com/forums/en-US/adodotnetentityframework/thread/2823634f-9dd1-4547-93b5-17bb8a882ac2/)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2016-07-07T01:55:34.007

我能够通过以下步骤克服这个问题：右键单击设计器窗口选择“从数据库更新模型”选择添加并确保选中“在模型中包含外键列”复选框。点击完成...

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-05-13T23:05:08.743

我已经在数据库中设置了外键，但框架仍然没有正确地将它们拉入。所以我尝试自己添加关联。 ﻿

但是，当我这样做时，我会得到一个映射错误。我花了一段时间，但我想通了。我所做的是使用实体工具箱关联工具设置关联，然后您必须双击关联（一对多）行并在那里设置主键和外键。希望这可以帮助其他可能遇到同样问题的人。我在任何地方都找不到答案。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-07-13T21:18:43.203

我遇到这个问题的原因完全不同，而且信息也略有不同；它没有说“数据不一致是可能的，因为可以独立修改相应的概念侧属性。”

我的模型中有一个表，其中包含一个存储图像数据的二进制列。我只希望在需要时返回此数据（性能是一项功能），因此我使用类似于[this](http://blogs.msdn.com/b/adonet/archive/2008/12/05/table-splitting-mapping-multiple-entity-types-to-the-same-table.aspx)的方法拆分表。后来，我向该表添加了一个属性，然后从数据库中更新了模型。向导将属性添加到引用具有添加属性的表的两种实体类型。我不得不从其中一个中删除它以解决错误。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-11-17T14:41:09.210

我发生这种情况是因为实体框架更新向导**错误映射了一些键**（或者没有更新？）。结果，一些列被错误地标记为键，而实际的键列被视为普通列。

解决方案是手动打开 EDMX 文件，找到实体并更新密钥。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-03-06T19:23:35.993

无法获得使用 EF6 的任何答案。问题似乎是框架没有正确地将外键作为关联导入。我的解决方案是从表中删除外键，然后使用实体框架模型手动添加关联，使用以下步骤：[实体框架 - 手动添加导航属性](https://stackoverflow.com/questions/4465855/entity-framework-add-navigation-property-manually)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-03-07T04:10:13.997

对于 EF1 中的 LinQ to Entities 查询，我无法将外键作为属性访问的解决方法是使用以下代码，它不会生成对关联表的连接查询：

```
dbContext.Table1s.FirstOrDefault(c => (int?)c.Table2.Id == null) 
```

即生成的SQL是：

```
...WHERE ([Extent1].[Table2Id] IS NULL)... 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-04-30T08:18:05.763

解决方案是允许删除 Rule = Cascade on Sql 关联。

与在 .edmx 模型上执行的操作相同，将元素添加到关联：

```
<Association Name="FK_Wheels_Slices">
          <End Role="Wheels" Type= "your tipe here" Multiplicity="1">
          <OnDelete Action="Cascade" />
          </End>
 </Association> 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-03-09T10:07:51.183

我已经在 EF 中映射了一个表。我在先前添加的表中添加了另外两个具有外键的表。然后我得到了3007错误。

为了解决这个错误，我从 EDMX 文件中删除了所有三个表，然后将它们一起重新添加（通过“从数据库更新模型...”），而不是分阶段添加。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2018-04-16T15:05:39.280

我检查了我的错误列表窗口，发现模型中有错误。修复了它们，一切都很好

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2019-12-25T06:27:01.233

在我的情况下，我通过勾选解决了这个错误（在模型中包括外键列）

```
- update Model from database
- tick (include foreign key columns in the model)
- finish 
```

[![在此处输入图像描述](../Images/7d0ccdb002a42552970f666670df6e57.png)](https://i.stack.imgur.com/d0M42.png)**

# cookies - 现在还有很多反饼干运动吗？

> ID：1015927
> 
> 赞同：4
> 
> 时间：2009-06-19T00:54:55.747
> 
> 标签：cookies

我不确定这属于 StackOverflow 还是 ServerFault，所以我首先选择了 SO。

几年前，关于滥用 HTTP cookie 的讨论非常引人注目，导致了各种 cookie 过滤代理，并最终在 Firefox 和 Opera 等浏览器中出现了主动 cookie 过滤。即使是现在，谷歌也会承认，目前大约 7% 的最终用户会拒绝他们的跟踪 cookie，这实际上是相当多的。

我仍然审查在我的浏览器中设置的所有 cookie。我有好几年了。我个人不认识其他人这样做，但它让我对网络跟踪有了一些有趣的见解。例如，使用 Google Analytics 的网站比两年前还要多。如果您不让它们设置 cookie，仍然有一些网站（幸运的是，极少数）会出现严重故障。但特别是广告商仍在设置 cookie 以跟踪您在网络上的方式。

那么现在有很多反饼干运动吗？有没有人试图让谷歌承担起用 Analytics 设置这么多的任务？是否有人试图诋毁 Ebay 和 PayPal 等使用狡猾的跨站点 cookie 让您登录的网站？

还是我对一个愚蠢的小问题做了太多？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-19T01:23:13.817

如今，还有其他方法可以阻止这些烦恼。[Rick752 的 EasyList](http://easylist.adblockplus.org/)有 EasyPrivacy 列表，除了将订阅一次添加到[Adblock Plus](http://adblockplus.org/)之外，它可以阻止其中的大多数。[NoScript](http://noscript.net/)可以（通过一些配置，主要是删除默认白名单上的一些错误条目）轻松阻止依赖于 JavaScript 的条目。

也就是说，我将浏览器设置为在注销时清空所有 cookie。然后他们可以仅在会话期间跟踪您，除非您倾向于长时间保持浏览器打开（或始终使用会话保存/恢复），否则这将是很短的。

如果您使用 Flash，请知道它也有一种 cookie，并且管理它们的界面很可能比您的浏览器差。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T01:03:08.367

总是有人误解饼干——双方都有。最终，由浏览器正确识别 cookie 的站点。只要网站设置正确并且浏览器尊重这一点，这不是什么大问题。我认为，随着越来越多地使用处理程序细节的网络工具包（以及更好、更注重安全的浏览器），现在对于最终用户来说已经不是什么大问题了。

除此之外，随着 DHTML 和基于 XML 的部分页面加载机制（以及数据库后端等）的普及，跟踪无状态页面之间的会话的需求现在减少了。您的 Web 应用程序可以非常轻松地保持状态而不需要 cookie，这很可能部分是由 [通常被误导的] 最终用户一起阻止 cookie 的数量驱动的。

简而言之：“恕我直言，不”。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-19T01:20:57.050

我放弃了作为用户和开发者的身份。

作为用户，保持登录网站的便利性太诱人了，一些网站无法运行的痛苦太烦人了。而且我对我的隐私不是那么敏感，所以我不再关心并让所有cookies通过。

作为一名开发人员，我总是尽可能地使用 RESTful，但我不知道在没有 cookie 的情况下处理身份验证的任何体面方式。HTTP Basic Auth 太坏了，我不能一直假设 HTTPS 并且修改 URL 是痛苦和不雅的。剩下的是使用 cookie 的基于表单的身份验证。所以我的应用程序有一个 auth cookie——我不需要更多，但是如果用户想要验证自己，它本身就要求用户打开 cookie。也许 OpenID 和其他联合身份服务有一天会解决这个问题，但目前我还不能依赖其中任何一个。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-19T03:39:44.807

我对 cookie 的最大烦恼是我想阻止 Analytics cookie，但同时我需要登录到分析来管理一些客户站点。据我所知，它们是相同的 cookie（实际上它可能是所有谷歌服务中的相同 cookie）。

我真的不信任 Google cookie。他们显然是第一批将 cookie 到期时间设置为 2038 年（最大值）的大公司之一，他们的商业模式几乎完全基于广告（即定向广告）。我怀疑他们比地球上任何其他政府或组织更了解人们的日常在线活动和兴趣。

这并不是说这一切都是邪恶的或其他任何事情，但对于一个实体来说，这确实是一种很大的信任。他们可能声称这一切都是匿名的，但我很确定这种说法很难核实。无论如何，我们无法保证这些数据不会被盗窃、合法获取或在未来某个时间点以其他方式被滥用用于其他目的。

有朝一日，这种分析可以用于针对比广告更严肃的事情的人，这并非不可能。对于未来的希特勒来说，建立某些任意等级的人的 IP 地址、银行账户、学校、雇主、俱乐部会员资格等以进行监禁或更糟的情况会有多难？

So my answer is that this is not a small problem and history has already taught us many times over what can happen when you start classifying and tracking people. Cookies are not the only means but they are certainly a part of the problem and I recommend blocking them and clearing at every convenient opportunity.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-19T01:05:30.110

我不时地清除我所有的cookies。这很痛苦，因为我必须再次登录网站（或设置首选项），但这也是我或我的浏览器是否能记住登录详细信息的一个很好的测试。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-19T03:46:12.000

I am also one of the hold-outs who doesn't automatically accept cookies. I do appreciate sites that need fewer, and I am more likely to return to those sites and allow cookies from them in the future.

That said, I do think that being vigilant about cookies is not (rationally) worth the effort. (In other words, I expect I will keep doing what I'm doing because it makes me feel better, even though I don't have evidence of commensurate tangible benefit.)

# iphone - 为 UITableViewController 的子视图隐藏 UIToolBar

> ID：1015929
> 
> 赞同：1
> 
> 时间：2009-06-19T00:57:13.870
> 
> 标签：iphone

My main controller is a subclass of UITableViewController with a UIToolBar at the bottom and when a row is selected, I'd like to display another view without the toolbar. 如何在子视图中隐藏 UIToolBar？现在，它存在于所有子视图中，除非它们被创建为模态。

Toolbar 在 RootController 中创建：

```
self.toolbar = [[UIToolbar alloc] init];
// add tool bar items here
[self.navigationController.view addSubview:toolbar]; 
```

RootController 显示其子视图如下：

```
UIViewController *controller = [[UIViewController alloc] init...]
[self.navigationController pushViewController:controller animated:YES]; 
```

RootController 在应用程序委托的 applicationDidFinishLaunching 中被实例化：

```
RootController *rootcontroller = [[RootController alloc] initWithStyle:UITableViewStyleGrouped];
self.navigationController = [[UINavigationController alloc] initWithRootViewController:rootcontroller];

[rootcontroller release];

[window addSubview:[self.navigationController view]]; 
```

如果我将工具栏添加到 RootController 中的 [self.view] 而不是 navigationController 的视图，则工具栏会一起消失。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-19T01:03:42.173

您可以尝试在使用“toolbar.hidden = YES”显示我们的子视图之前隐藏工具栏，然后在 viewWillAppear 方法中使用“toolbar.hidden = NO”再次显示它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-12-09T07:51:58.280

另一种选择是使用“removeFromSuperview”

[工具栏 removeFromSuperview];

然后在要重新显示工具栏的视图中使用 viewDidAppear 方法。它比 viewWillAppear 效果更好，因为工具栏是在显示视图后添加的。（对于 viewWillAppear，工具栏是在过渡期间添加的，所以有点尴尬。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-04-08T20:21:15.510

我得到了它的工作

```
[toolbar removeFromSuperview]; 
```

检查这个

```
- (void)viewWillAppear:(BOOL)animated
{
[super viewWillAppear:animated];

//Initialize the toolbar
toolbar = [[UIToolbar alloc] init];
toolbar.barStyle = UIBarStyleDefault;

//Set the toolbar to fit the width of the app.
[toolbar sizeToFit];

//Caclulate the height of the toolbar
CGFloat toolbarHeight = [toolbar frame].size.height;

//Get the bounds of the parent view
CGRect rootViewBounds = self.parentViewController.view.bounds;

//Get the height of the parent view.
CGFloat rootViewHeight = CGRectGetHeight(rootViewBounds);

//Get the width of the parent view,
CGFloat rootViewWidth = CGRectGetWidth(rootViewBounds);

//Create a rectangle for the toolbar
CGRect rectArea = CGRectMake(0, rootViewHeight - toolbarHeight, rootViewWidth, toolbarHeight);

//Reposition and resize the receiver
[toolbar setFrame:rectArea];

//Create a button
UIBarButtonItem *infoButton = [[UIBarButtonItem alloc]
initWithTitle:@"back" style:UIBarButtonItemStyleBordered target:self action:@selector(info_clicked:)];

[toolbar setItems:[NSArray arrayWithObjects:infoButton,nil]];

//Add the toolbar as a subview to the navigation controller.
[self.navigationController.view addSubview:toolbar];

[[self tableView] reloadData];

}

- (void) info_clicked:(id)sender {

[self.navigationController popViewControllerAnimated:YES];
[toolbar removeFromSuperview];

} 
```

# c# - C# 中的 Twitter update_profile_image

> ID：1015930
> 
> 赞同：1
> 
> 时间：2009-06-19T00:57:52.713
> 
> 标签：c#, .net, twitter

我在实现 Twitter 的`[update profile image]`方法时遇到了麻烦。有没有人有任何将图像作为原始多艺术数据传递给 Twitter API 的示例代码？

我正在使用.NET。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-19T01:05:37.753

在 C# 中连接 Twitter 的一个很好的库是[tweet#](http://tweetsharp.com/)。这比直接执行此操作要简单得多。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-19T01:01:29.027

您是否查看过以下适用于 .NET 的 Twitter API 库？

*   [推特用户](http://code.google.com/p/twitterizer/)
*   [Yedda Twitter C# 库](http://devblog.yedda.com/index.php/twitter-c-library/)
*   [推特](http://rareedge.com/twitteroo/blog/)
*   [鸣叫夏普](http://code.google.com/p/tweetsharp/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-30T10:15:31.100

取自[LINQ2Twitter 项目](http://linqtotwitter.codeplex.com)，为简洁起见稍作修改。

```
 public static String UpdateAvatar(String filePath)
    {
        String avatarUrl= "http://twitter.com/account/update_profile_image.xml";
        String file = Path.GetFileName(filePath);

        string imageType;

        switch (Path.GetExtension(file).ToLower())
        {
            case ".jpg":
            case ".jpeg":
                imageType = "jpg";
                break;
            case ".gif":
                imageType = "gif";
                break;
            case ".png":
                imageType = "png";
                break;
            default:
                throw new ArgumentException(
                    "Can't recognize the extension of the file you're uploading. Please choose either a *.gif, *.jpg, *.jpeg, or *.png file.", filePath);
        }

        string contentBoundaryBase = DateTime.Now.Ticks.ToString("x");
        string beginContentBoundary = string.Format("--{0}\r\n", contentBoundaryBase);
        var contentDisposition = string.Format("Content-Disposition:form-data); name=\"image\"); filename=\"{0}\"\r\nContent-Type: image/{1}\r\n\r\n", file, imageType);
        var endContentBoundary = string.Format("\r\n--{0}--\r\n", contentBoundaryBase);

        var formDataSB = new StringBuilder();

        byte[] fileBytes = null;
        string fileByteString = null;
        Encoding encoding = Encoding.GetEncoding("iso-8859-1");

        using (var fileStream = new FileStream(filePath, FileMode.Open, FileAccess.Read))
        {
            byte[] buffer = new byte[4096];
            var memStr = new MemoryStream();
            memStr.Position = 0;
            int bytesRead = 0;

            while ((bytesRead = fileStream.Read(buffer, 0, buffer.Length)) != 0)
            {
                memStr.Write(buffer, 0, bytesRead);
            }

            memStr.Position = 0;
            fileByteString = encoding.GetString(memStr.GetBuffer());
        }

        fileBytes =
            encoding.GetBytes(
                formDataSB.ToString() +
                beginContentBoundary +
                contentDisposition +
                fileByteString +
                endContentBoundary);

        var req = (HttpWebRequest)WebRequest.Create(AvatarUpdateURL);
        req.ServicePoint.Expect100Continue = false;
        req.ContentType = "multipart/form-data;boundary=" + contentBoundaryBase;
        req.PreAuthenticate = true;
        req.AllowWriteStreamBuffering = true;
        req.Method = "POST";
        req.ContentLength = fileBytes.Length;
        req.Credentials = new NetworkCredential(Username, Password);

        string responseXml = null;

        using (var reqStream = req.GetRequestStream())
        {
            reqStream.Write(fileBytes, 0, fileBytes.Length);
            reqStream.Flush();
        }

        string httpStatus = string.Empty;
        WebResponse resp = null;

        try
        {
            resp = req.GetResponse();

            httpStatus = resp.Headers["Status"];

            using (var respStream = resp.GetResponseStream())
            using (var respRdr = new StreamReader(respStream))
            {
                responseXml = respRdr.ReadToEnd();
            }
        }
        catch (WebException wex)
        {
            //do something
        }
        finally
        {
            if (resp != null)
            {
                resp.Close();
            }
        }
        return responseXml.ToString();

    } 
```

# iphone - 这是 NSTimer 的工作吗？循环界面变化

> ID：1015932
> 
> 赞同：1
> 
> 时间：2009-06-19T00:58:01.590
> 
> 标签：iphone, objective-c, cocoa, nstimer

我的接口上的一个按钮，*当按住 时*，将对我的接口的其他部分执行一系列更改。

例如，一秒钟内一些文本会变成蓝色，然后 UImageView 将改变它的图像两秒钟......等等......

只要按住按钮，这一系列更改将通过相同的步骤循环。

我以前从未使用过 NSTimer，但这是要走的路吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-19T02:36:41.033

为此，您不需要 NSTimer，您可以简单地使用 performSelector:withObject:afterDelay: 从一种方法到另一种方法进行排序，直到您重新开始。按住按钮时启动流程，释放按钮时调用cancelPreviousPerformRequestsWithTarget:selector:object:。就像是：

```
- (void) step1
{
    // turn blue
    [self performSelector:@selector(step2) withObject:nil afterDelay:1.0];
}

- (void) step2
{
    // change image
    [self performSelector:@selector(step3) withObject:nil afterDelay:2.0];
}

- (void) step3
{
    // turn red
    [self performSelector:@selector(step1) withObject:nil afterDelay:3.0];
}

- (void) stopSteps
{
    [NSObject cancelPreviousPerformRequestsWithTarget:self selector:@selector(step1) object:nil];
    [NSObject cancelPreviousPerformRequestsWithTarget:self selector:@selector(step2) object:nil];
    [NSObject cancelPreviousPerformRequestsWithTarget:self selector:@selector(step3) object:nil];
} 
```

你可以记住当前正在执行的“performSelector”选择器并且只取消那个选择器，但它几乎不值得记住它。

或者，您可以使用 NSTimer 和状态机，但对于您所描述的，上述可能更容易 - 这取决于您的序列的一致性以及是否更容易将您的序列指定为如上所述的一组步骤，或一组数据（在这种情况下，使用某种状态机，使用 NSTimer 或 performSelector:withObject:afterDelay:)

# asp.net-mvc - 添加 validateRequest = false 但仍然收到错误

> ID：1015938
> 
> 赞同：2
> 
> 时间：2009-06-19T01:00:49.977
> 
> 标签：asp.net-mvc, web-config

我补充说：

```
<pages validateRequest="false"> 
```

到我的 web.config 但我仍然收到错误：

```
A potentially dangerous Request.Form value was detected from the 
```

我也将它添加到视图页面，但仍然收到错误。

怎么会这样？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-19T01:41:10.363

在 MVC 中，请求验证必须在控制器级别而不是在页面级别完成，因为控制器正在处理输入，而不是页面。如果请求验证是在页面级别完成的，那么控制器会在验证检查发生之前愉快地处理恶意输入（并可能将其提交到数据库！）。

```
[ValidateInput(false)] 
```

# c - 指向指针的指针数组如何工作？

> ID：1015944
> 
> 赞同：6
> 
> 时间：2009-06-19T01:02:59.210
> 
> 标签：c, arrays, pointers

```
char **Data[70]={NULL}; 
```

什么是正确的术语？还能怎么写？它在记忆中是什么样子的？我正在阅读许多关于指针的教程，但我没有在这种语法中看到它。任何帮助表示赞赏。谢谢。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-06-19T01:18:30.910

这种结构

```
char **Data[70]={NULL}; 
```

是 70 个指向 char 指针的数组。编译器为此数组分配`70 * sizeof(char**)`字节，假设 32 位指针为 280 字节。

如果您在内部将“指向 char 的指针”视为一个字符串，这是不正确的，但它足够接近，那么这是一个包含 70 个指向字符串的指针的数组。制作一些 ASCII 艺术并假装你已经分配和填充了一些值....

```
 Array of        One or more
 char **           char *
+---------+     +---------+
|    0    | --> |   ptr   | -->  "Hello, world"
+---------+     +---------+
|    1    |
+---------+       +---------+
|    2    | ----> |  ptr2   | -->  "Goodbye, cruel world"
+---------+       +---------+
|    3    |
+---------+         +---------+
|    4    | ------> | ptr3[0] | -->  "Message 0"
+---------+         +---------+
    ...             | ptr3[1] | -->  "Message 1"
+---------+         +---------+
|   69    |         | ptr3[2] | -->  "Message 2"
+---------+         +---------+ 
```

您可以使用这样的代码执行上述操作（错误检查 malloc 返回值已跳过）：

```
char **Data[70]={NULL};
char **ptr, **ptr2, **ptr3;

ptr = (char **) malloc(sizeof(char *));
*ptr = "Hello, world";
Data[0] = ptr;

ptr2 = (char **) malloc(sizeof(char *));
*ptr2 = "Goodbye, cruel world";
Data[2] = ptr2;

ptr3 = (char **) malloc(10 * sizeof(char *));
Data[4] = ptr3;

ptr3[0] = "Message 0";
ptr3[1] = "Message 1";
 ...
ptr3[9] = "Message 9"; 

printf("%s\n", *Data[0]);
printf("%s\n", Data[2][0]);
printf("%s\n", Data[4][0]);
printf("%s\n", Data[4][1]);
      ...
printf("%s\n", Data[4][9]); 
```

可以这样想：数组中的每个条目都是一个`char **`. 每个条目都可以指向内存中的任意位置，所述位置是`char *`并且因此能够指向以空字符结尾的字符数组，即“字符串”。

请仔细注意这与分配 2D 数组时得到的结果之间的区别：

```
char *Data2[10][70]={NULL}; 
```

上面的分配`Data2`给你一个二维的`char *`指针数组，所说的二维数组被分配在一个内存块中（`10 * 70 * sizeof(char*)`字节，或 2800 字节的 32 位指针）。您无法使用`char **`一维指针数组将`char **`指针分配到内存中的任意位置。

还要注意（给定上述`Data`和`Data2`的声明）编译器将为以下数组引用生成不同的代码：

```
Data[0][0]
Data2[0][0] 
```

**这是另一种思考方式**：假设您有几个指向字符串的指针数组：

```
char *table0[] = { "Tree", "Bench", "Stream" };
char *table1[] = { "Cow", "Dog", "Cat" };
char *table2[] = { "Banana", "Carrot", "Broccoli" };
char **Data[3];

Data[0] = table0;
Data[1] = table1;
Data[2] = table2; 
```

您有一个指向“char 指针数组”的指针数组。如果你现在打印 的值`data[1][1]`，可以这样想： `data[1]`得到一个指向数组的指针`table1`。那么值`table1[1]`等于`"Dog"`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-19T01:25:27.200

考虑一个 char** 数组的实际用途有点棘手。尤其是一个有 70 个元素的。

但是，假设我要运行 70 个程序。您可能知道，程序参数通常作为`char** argv`参数传递给`main()`（或`char*[] argv`，在函数签名中是同一件事）。因此，如果我想为所有这些程序存储 argv 指针，我会使用一个数组，就像`Data`. 显然，我在其他地方还需要更多内存，以占用实际的字符串和 argv 数组，但这是一个开始。

初始化一个数组，`{NULL}`将其所有元素设置为 NULL。这是一个有用的简写：你可以用 初始化一个数组`{firstelement, secondelement, ...}`，但是如果你没有提供足够的项，其余的都被视为 0。

就像任何其他用 {NULL} 初始化的指针数组一样，这在内存中看起来是 70 个 NULL 指针排成一行。`char**`a和任何其他对象指针之间的内存（通常）没有区别。我认为编写一个存在差异的奇怪实现是合法的，但不要屏住呼吸等待遇到一个。

`char**`因此，一行中的 70 个 NULL 和一行中的 70`char*`个*NULL*之间的区别是指针另一端的值，如果它们不是 NULL。a 的另一端`char**`是指向 char 的指针。a 的另一端`char*`是一个字符。指针或字符可能是数组中的第一个，具体取决于它的使用方式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-19T01:21:15.663

这不是很明显：

```
char **Data[70]={NULL}; 
```

但有一个替代声明，如：

```
char* Data[2][3] = {
  {"Nick", "Tom", "Helen"},
  {"one", "two", "three"}
}; 
```

我们可以很容易地看到它是一个二维的字符串数组。

**编辑：** 我使用 Data[2][3] 来表明它是一个二维数组。我对像 2 和 3 这样的尺寸使用了*固定*尺寸，只是为了演示。当然我们可以有：

```
char* Data[][3]={
  {"Nick", "Tom", "Helen"},
  {"one", "two", "three"},
  // ...
}; 
```

或者`char** Data[]`

好的，这就是我所说的二维数组：

```
char** Data[2]={0};

void test()
{
  char* d1[] = {"1", "2"};
  char* d2[] = {"10", "20", "30"};
  Data[0] = d1;
  Data[1] = d2;

  printf("%s\n", Data[0][0]);
  printf("%s\n", Data[0][1]);
  printf("%s\n", Data[1][0]);
  printf("%s\n", Data[1][1]);
  printf("%s\n", Data[1][2]);
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-19T01:28:39.453

你得到的是一个由 70 个指针组成的数组，每个指针指向另一个指针，每个指针都指向一个字符。有趣的是，数组本身就是指针，所以你有三个级别的指针。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-19T01:08:06.423

这实际上是一个指向指针的指针。但是，由于“指针”只不过是内存中的一个位置，因此与仅执行 char* Data[70] 相比，这样做实际上并没有多大用处，除了使每个 char* 是指向另一个 char 的指针很明显*，而不是指向 char 的指针。

# .net - 如何在 .NET 中进行基于时间/预定的事件？

> ID：1015945
> 
> 赞同：8
> 
> 时间：2009-06-19T01:03:08.303
> 
> 标签：.net, scheduling, scheduled-tasks, quartz-scheduler

我需要在我们的网站上提供行动/事件的安排。一个废话类比可能是一个日历系统，其中一个人添加了一个日历项目，并且当日期/时间被“点击”时，就会触发一些逻辑（例如计算报告）。

我可能有数百甚至数千个由我的客户输入的预定事件。当客户输入要安排的内容时，我会将该信息保存到数据库中。然后我猜我会在某处添加一个事件/作业，其中将包含数据库表主键。当要触发事件时，我将从数据库中获取该信息，然后执行逻辑。完毕。

有哪些常见的解决方案来处理这个问题？

我正在使用 .NET 3.5 SP1。DB 是 Sql Server 2008。UI 将是基于网络的。

我不确定人们是否使用 MSMQ？还是 Sql Server 内置的东西？或者一些带有 NT 服务的开源库（例如[Quartz.NET ）。](http://quartznet.sourceforge.net/index.html)服务器将是windows 2008标准版。

另外 - 请不要建议使用等效的 cron 作业或任何命令行脚本等。

最后，这是次要目标..我很想把它扔到天蓝色上，以供嘘声和咯咯笑...那也可能吗？这只是一个愿望清单的想法。如果解决方案比使用 Azure 更容易，我更愿意在专用盒子上进行。

干杯:)

编辑：需要触发事件时处理的逻辑是后台作业。不需要用户界面。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-19T05:08:28.027

[Workflow Foundation](http://msdn.microsoft.com/en-us/library/ms734631.aspx)可以做到这一点。使用[延迟活动](http://msdn.microsoft.com/en-us/library/ms734721.aspx)，将 TimeSpan 设置为 (DesiredTimeOfExecution - Now)。对于更大规模的系统，将 UnloadOnIdle 设置为 true，待处理的工作流将一直持续到需要为止。

这是[延迟活动的一个非常简单的示例](http://msdn.microsoft.com/en-us/library/ms741719.aspx)。

WF 是*免费*的，包含在 .NET Framework 3.0 中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-19T05:28:35.350

您想要的是 SQL Server 服务代理。

您可以进行定时数据库访问以查询日历数据等。它是基于消息的，比 MSMQ 更强大，不需要轮询，如果您需要，可以在分布式环境中使用。对我有用！

您将点击一个存储过程，将您的事件信息放在数据库中的 SSB 队列中。您将在将来给该消息一个时间来唤醒并处理另一个存储过程，该过程获取您的事件数据并放入执行“外部激活”的拾取队列中。EA 向指向控制台应用程序的 Windows 服务发送通知。该控制台应用程序从拾取队列中获取事件信息。现在，您可以在您想要的准确时间获得您的事件数据。在控制台应用程序中随心所欲地处理它。

有一个学习曲线，但如果您需要 SQL Service Broker 提供的可靠性、灵活性和可伸缩性，那么它是非常值得的。以下是一些帮助您入门的链接。

这是一个比较：[SQL Service Broker 与 MSMQ](http://www.devx.com/dbzone/Article/34110)

不幸的是，SO 只允许我发布一个链接。否则，我可以为您指出更多资源，以帮助您开始使用 SSB。

希望这可以帮助！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-30T23:16:50.620

Quartz.NET 可能也可以很好地处理这些要求。我看到的好处是设置调度程序（CronTrigger + 日历）的各种方式以及将您的工作放在可测试代码的小单元（工作）中的能力。

Quartz.NET 还为您提供了所需的分发和故障转移集群功能。一个不错的功能也是每个触发器可配置的失火处理设置，让您有机会对失火和调度程序停机时间做出反应。

SQL Service Broker 似乎有没有轮询的好处，我想知道这是否会成为问题，但代理的缺点是听起来有点复杂（至少从我上面读到的描述来看）。

只是我有偏见的 0.02 美元。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-19T02:04:57.120

一种选择可能是创建一个 SQL 作业，以您拥有的任何最细粒度的时间间隔运行，然后处理所有事件。

如果您想要 .NET 和 SQL Server 世界中最好的，您可以[使用 SQL 作业并调用托管代码](http://channel9.msdn.com/posts/trobbins/Managed-Code-and-SQL-Server-2005/)。我对这个解决方案没有任何经验，所以如果我提供的资源不是很全面，我会提前道歉。

如果任务非常复杂，并且您不想在 SQL Server 上加载程序集，或者您只是不喜欢他们的调度系统，那么我建议使用带有第三方调度程序插件的 .NET Windows 服务。就个人而言，如果所有代码都可以保存在一个存储过程或一系列存储过程中，我会做一份工作，因为我认为它更容易管理并且已经为你完成了很多工作。

**编辑**

我刚刚注意到一个解释粒度的评论。如果您需要每分钟执行一些操作，那么 .NET 服务解决方案可能会更容易，因为您可能必须实现某种多线程解决方案。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-19T02:24:17.250

您将需要一个作业调度程序和一个作业管理器，因为您的粒度很小，并且您必须能够先验地知道在给定分钟内发生的所有作业是否会在下一分钟完成。

这使调度程序的工作变得容易。您应该有一个存储您的作业的数据库表，并且每分钟都有一个作业调度程序服务转到该表并选择需要完成的作业。

它将使用作业经理将这些作业排入队列。您可以使用另一个表或事务队列来排队您的工作。您的作业管理器服务将监视作业队列。您可以自己滚动或使用[BizTalk](http://www.microsoft.com/biztalk/en/us/default.aspx)来监控作业队列并启动编排或[工作流](http://msdn.microsoft.com/en-us/netframework/aa663328.aspx)。它将一个一个地从队列中拉出任务，执行任务并更新数据库中的作业状态。

您的问题将是可伸缩性，具体取决于用户数量、他们排队的任务数量以及每个任务允许的密集程度（时间、内存、cpu 等）。如果我是你，我会推迟 1 分钟的时间粒度并将其推到 5 分钟。你需要在下午 1:38 完成哪些你不能等到下午 1:40 的事情？:)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-19T04:17:04.343

这已经是 StackOverflow 上讨论的问题。请通过[asp.net中的Need job scheduler](https://stackoverflow.com/questions/781300/need-job-scheduler-in-asp-net)

您忘记在问题中添加最重要的信息 - ASP.Net

它描述了一个用于 ASp.Net Web 应用程序的调度程序框架，它可以像服务一样运行，并为您提供一个定期调用的方法，然后您可以触发逻辑来加载事件，使用计时器对有效事件进行排队。

此外，这是所有替代品中最便宜的。希望这是你需要的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-19T01:19:00.863

这在一定程度上取决于系统的性质。假设事件的完整定义存储在数据库中：

*   如果事件需要在 Web UI 中引起某些事情，则在更新时检查表中是否有“发生”的条目，并将适当的视觉指示器/屏幕/弹出窗口添加到下一个 Web 请求输出。
*   如果您的事件与后台处理有关，最简单的解决方案是编写一个单独的独立 .NET 应用程序，该应用程序轮询数据库事件表中的新记录，并按时检查以查看发生了哪些事件。如果某些事件导致长时间运行的进程等，您可以花哨并涉及线程，但这将是基本设计。（只有在必须时才使用线程......轮询表的简单单线程应用程序将是最强大的）

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-19T02:07:50.497

> 然后我猜我会在某处添加一个事件/作业，其中将包含数据库表主键。当要触发事件时，我将从数据库中获取该信息，然后执行逻辑。

我不知道常见的解决方案是什么，但是，重新发明轮子，我想在事件时间创建一个数据库聚集索引，所以我可以每分钟轮询一次数据库，语句如下......

```
SELECT * FROM Events WHERE Events.Time < next_minute 
```

# sql - 以一种相当奇怪的方式计算非空列

> ID：1015953
> 
> 赞同：1
> 
> 时间：2009-06-19T01:05:50.250
> 
> 标签：sql, oracle, count, null

我有一个在 Oracle 表中有 32 列的表。

*   其中两个列是标识列
*   其余的是价值观

我想获得所有值列的平均值，这因空（身份）列而变得复杂。下面是我想要实现的伪代码：

```
 SELECT 
           ((nvl(val0, 0) + nvl(val1, 0) + ... nvl(valn, 0)) 
           / nonZero_Column_Count_In_This_Row) 
```

这样：nonZero_Column_Count_In_This_Row = (ifNullThenZeroElse1(val0) + ifNullThenZeroElse1(val1) ... ifNullThenZeroElse(valn))

这里的困难当然是为任何非空列获取 1。看来我需要一个类似于 NVL 的函数，但有一个 else 子句。如果值为 null，则返回 0，否则返回 1，而不是值本身。

*我应该如何获得分母的价值？*

* * *

PS：我觉得我必须解释一下这个设计背后的一些动机。理想情况下，该表将被组织为标识列和每行一个值，并带有行本身的一些标识符。这会使它更加规范化，并且该问题的解决方案将非常简单。不这样做的原因是吞吐量和节省空间。这是一个巨大的数据库，我们每分钟向其中插入 1000 万个值。将这些值中的每一个设为一行将意味着每分钟 1000 万行，这绝对是无法实现的。将其中的 30 个打包成一行可以减少插入到我们可以使用单个 DB 执行的操作的行数，并且开销数据量（身份数据）要少得多。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-19T01:10:47.353

（情况当 col 为 null 然后 0 else 1 end）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T01:14:50.917

您可以使用`NVL2(val0, 1, 0) + NVL2(val1, 1, 0) + ...`，因为您使用的是 Oracle。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-19T01:27:11.547

另一种选择是使用忽略 NULL 的 AVG 函数：

```
SELECT AVG(v) FROM (
WITH q AS (SELECT val0, val1, val2, val3 FROM mytable)
SELECT val0 AS v FROM q
UNION ALL SELECT val1 FROM q
UNION ALL SELECT val2 FROM q
UNION ALL SELECT val3 FROM q
); 
```

如果您使用的是 Oracle11g，您可以使用 UNPIVOT 语法使其更加简单。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-01-20T15:01:05.163

我看到这是一个很老的问题，但我没有看到足够的答案。我有一个类似的问题，下面是我如何解决它。很明显需要一个案例陈述。此解决方案是一种解决方法，适用于以下情况

```
SELECT COUNT(column) WHERE column {IS | IS NOT} NULL 
```

无论出于何种原因都不起作用，或者，您需要做几个

```
SELECT   COUNT ( * )
  FROM   A_TABLE
 WHERE   COL1 IS NOT NULL;

SELECT   COUNT ( * )
  FROM   A_TABLE
 WHERE   COL2 IS NOT NULL; 
```

查询，但希望在运行脚本时将其作为数据集。见下文; 我用它进行分析，到目前为止它对我来说效果很好。

```
SUM(CASE NVL(valn, 'X')
                WHEN 'X'
                THEN 0 
                ELSE 1 
                END) as COLUMN_NAME
            FROM YOUR_TABLE; 
```

干杯!
道格

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-19T01:21:35.943

通常，您可以执行以下操作：

```
SELECT (
       (COALESCE(val0, 0) + COALESCE(val1, 0) + ...... COALESCE(valn, 0))
       /
       (SIGN(ABS(COALESCE(val0, 0))) + SIGN(ABS(COALESCE(val1, 0))) + .... )
       ) AS MyAverage 
```

顶行将返回值的总和（省略 NULL 值），而底行将返回非 null 值的数量。

仅供参考 - 它是 SQL Server 语法，但 COALESCE 在大多数情况下就像 ISNULL 一样。SIGN 只返回 -1 表示负数，0 表示零，1 表示正数。ABS是“绝对值”。

# php - 如何在 PHP 中实现类似 MySQL 的 latin1_general_ci 排序规则？

> ID：1015963
> 
> 赞同：1
> 
> 时间：2009-06-19T01:12:33.823
> 
> 标签：php, sorting, localization, collation, strcmp

我正在编写一个字符串比较函数来对医学术语进行排序，这些术语通常包含来自许多不同欧洲语言的特殊重音字符，我需要以某种方式实现类似于 MySQL 的排序规则`latin1_general_ci`。

首先，我正在对字符串进行一些基本的修改以删除空格、引号、连字符、括号等。当我将字符串传递给`strcoll()`使用默认语言环境时，问题就出现了，因为它不够聪明，无法考虑，例如, 一个重音的 e 在字典上等同于一个正常的 e。

我对使用德语或法语等语言环境持谨慎态度，因为它可能不会包含我需要考虑的所有特殊字符。是否有一个语言环境可以给我类似于`latin1_general_ci`排序规则的东西？或者是否有其他解决方案？

我天真的解决方案是创建一个大的关联数组来将重音字母映射到它们的常规字母等价物，然后将它与 一起使用`str_replace()`，但这听起来很慢而且很乏味（而且容易出错）。如果可能的话，我宁愿使用语言内置的东西。

同样在这一点上，是否`strcmp()`或`strcasecmp()`尊重当前语言环境的排序规则，或者只是`strcoll()`这样做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T01:30:07.407

也许是这样：

```
setlocale(LC_COLLATE, 'fr_FR.Latin1', 'fr.Latin1', 'fr_FR.Latin-1', 'fr.Latin-1'); 
```

`strcmp()`并且`strcasecmp()`没有本地化。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T02:46:26.490

您还可以尝试使用[iconv](http://us.php.net/manual/en/function.iconv.php)函数来帮助规范化字符串。这将处理带重音的 e 到正常的 e 情况。也请参阅有关[排序 utf8 字符串](https://stackoverflow.com/questions/120334/how-to-sort-an-array-of-utf-8-strings/120361)的相关问题。

# c# - Windows 窗体：多个默认按钮？

> ID：1015972
> 
> 赞同：1
> 
> 时间：2009-06-19T01:19:59.533
> 
> 标签：c#, winforms, button, default

在我制作的一个简单的猜数字游戏中，用户输入几个数字并点击一个按钮。第二个面板被启用，而原来的面板被禁用。用户现在输入一个数字并多次点击另一个按钮。由于这两个面板永远不会同时启用，我希望两个按钮都是“默认”的，即如果按下 Enter，它们将被按下。这可能吗？显然，每个窗口我只能设置其中一个。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T01:22:55.970

不，没有办法实现我所知道的。当一个按钮被按下到下一个按钮时，您必须切换默认按钮。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T01:23:43.910

根据定义，Windows 中的窗口只有一个默认按钮。这是一个用于对话框窗口的功能，您永远不会禁用默认按钮。

您可以做的是在禁用一个面板时切换默认按钮。

另一种选择是完全放弃默认按钮并在表单上使用 KeyPreview 并自己处理 enter 键，将其发送到当前处于活动状态的相应按钮。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-19T01:24:04.363

每个窗口只能有一个默认按钮。但是，这可以在运行时更改，因此当您激活特定面板时，您可以将其按钮设置为此时的默认按钮。

# sql - 如何指定可以从 linq 到 sql 查询返回哪些列

> ID：1015979
> 
> 赞同：2
> 
> 时间：2009-06-19T01:21:38.157
> 
> 标签：sql, linq, explicit, construction

我试图只从 linq 到 sql 查询返回几列，但如果我这样做，它会引发异常：

**不允许在查询中显式构造实体类型“InVision.Data.Employee”**

这是代码：

```
return db.Employees.Select(e => new Employee()
       { EmployeeID = e.EmployeeID, FirstName = e.FirstName,
         LastName = e.LastName }).ToList(); 
```

如果我返回所有内容，那么它将引发有关循环引用的异常，因为它需要被序列化才能在 javascript 中使用，所以我真的需要限制列...感谢您可以给我解决这个问题的任何提示。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-19T01:26:34.637

因为在我推荐使用 View 对象而不是 Linq2Sql 实体来处理这种情况之前，我不得不与 Linq2Sql 和序列化作斗争。它是一个更简单的解决方案：

```
return db.Employees
        .Select( e => new EmployeeView() 
        { 
            EmployeeID = e.EmployeeID, 
            FirstName = e.FirstName, 
            LastName = e.LastName 
         }).ToList(); 
```

另一种选择是将 Employee 表的新副本拖到 DBML 设计器中，将其命名为 SimpleEmployee 之类的不同名称，删除所有关系并删除所有不需要的列。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-19T01:30:33.430

基本上，如果您只想要列，请选择那些。如果您想要员工实体，请选择它。这里没有太多的中间立场。我建议不要为此创建一个新课程。呸！

做这个：

```
return db.Employees
   .Select(e => new { e.EmployeeID, e.FirstName, e.LastName })
   .ToList(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T01:26:14.217

贾斯汀，

此处对该错误的解释：http: [//devlicio.us/blogs/derik_whittaker/archive/2008/04/25/linq2sql-explicit-construction-of-entity-exception.aspx](http://devlicio.us/blogs/derik_whittaker/archive/2008/04/25/linq2sql-explicit-construction-of-entity-exception.aspx)

您可以做的一件事是创建一个派生自 Employee 的类。

```
public class EmployeeProxy : Employee
{
} 
```

然后你可以做你的查询：

```
return db.Employees.Select(e => new EmployeeProxy { EmployeeID=e.EmployeeID, FirstName=e.FirstName, LastName=e.LastName }).ToList(); 
```

另一方面，如果您只需要将结果集序列化为javascript，那么您也可以只使用匿名类。这也有效：

```
return db.Employees.Select(e => new { EmployeeID=e.EmployeeID, FirstName=e.FirstName, LastName=e.LastName }).ToList(); 
```

希望这可以帮助。