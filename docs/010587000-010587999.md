# StackOverflow 问答 10587000-10587999

# excel - 根据变量excel vba选择整行

> ID：10587004
> 
> 赞同：3
> 
> 时间：2012-05-14T16:05:25.490
> 
> 标签：excel, vba

我正在尝试在不同的工作表中选择一整行，然后使用宏将该行复制到我当前所在的工作表中。如果 Rows() 子通过硬编码的整数传递，则代码工作正常，但是当我输入变量时，我得到“范围类的选择方法失败”错误。这是我的代码：

```
Sheets("BOM").Select
Rows(copyFromRow & ":" & copyFromRow).Select
Selection.Copy
Sheets("Proposal").Select
Rows(copyToRow & ":" & copyToRow).Select
ActiveSheet.Paste
copyToRow = copyToRow + 1
Rows(copyToRow & ":" & copyToRow).Select
Application.CutCopyMode = False
Selection.Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove 
```

如果相反我使用：

```
Rows("52:52").Select
Selection.Copy 
```

它工作正常，但是当变量存在时，就会发生错误。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-14T18:02:24.450

我刚刚测试了底部的代码，它打印`16384`了两次（我在 Excel 2010 上），第一行被选中。您的问题似乎在其他地方。

您是否尝试过摆脱选择：

```
Sheets("BOM").Rows(copyFromRow).Copy
With Sheets("Proposal")
    .Paste Destination:=.Rows(copyToRow)
    copyToRow = copyToRow + 1
    Application.CutCopyMode = False
    .Rows(copyToRow).Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove
End With 
```

* * *

测试代码以确信问题似乎不是您认为的那样。

```
Sub test()

  Dim r
  Dim i As Long

  i = 1

  r = Rows(i & ":" & i)
  Debug.Print UBound(r, 2)
  r = Rows(i)
  Debug.Print UBound(r, 2)
  Rows(i).Select

End Sub 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2018-08-24T21:16:14.960

我通过首先解决工作表来为我解决了这个问题：

```
ws.rows(x & ":" & y).Select 
```

没有对工作表（ws）的引用，我得到了一个错误。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-04-08T17:33:35.653

在另一个网站上看到了这个答案，它也适用于我！

> 肖恩于 2001 年 10 月 14 日下午 1:24 发布
> 
> `var1 = 1`
> 
> `var2 = 5`
> 
> `Rows(var1 & ":" & var2).Select`
> 
> 这对我有用，看起来您只需将变量保留在引号之外并添加 and 语句 (&)
> 
> -肖恩

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-11-10T17:58:50.597

关键在冒号和&两边的引号中，即rows(variable & ":" & variable).select

适应这个：

```
Rows(x & ":" & y).select 
```

其中 x 和 y 是您的变量。

其他一些可以帮助你理解的例子

```
Rows(x & ":" & x).select 
```

或者

```
Rows((x+1) & ":" (x*3)).select 
```

或者

```
Rows((x+2) & ":" & (y-3)).select 
```

希望你明白这一点。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-14T16:43:05.330

您需要添加引号。VBA 正在翻译

```
Rows(copyToRow & ":" & copyToRow).Select` 
```

进入

```
 Rows(52:52).Select 
```

尝试改变

```
Rows(""" & copyToRow & ":" & copyToRow & """).Select 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-11-23T16:30:00.660

需要确保变量和“&”符号之间的空间。检查图像。（红色一显示无效命令）

[![错误](../Images/7ab6e4071c89af38a38204621815d8d2.png)](https://i.stack.imgur.com/MBQpq.png)

正确的解决方案是

```
Dim copyToRow: copyToRow = 5      
Rows(copyToRow & ":" & copyToRow).Select 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-12-08T18:00:24.937

```
mycell = ActiveCell
r = mycell.Row
c = mycell.Column
Range(Cells(r, c), Cells(r + 100, c)).Select 
```

# asp.net-mvc-3 - ASP.NET MVC3 如何使用角色隐藏非管理员用户的删除链接？

> ID：10587005
> 
> 赞同：2
> 
> 时间：2012-05-14T16:05:28.670
> 
> 标签：asp.net-mvc-3, entity-framework-4.1, roles

我有一个实体框架 4.1 的 mvc3 Web 应用程序。我创建了两个角色——用户和管理员。当我以管理员身份登录我的应用程序时，我希望看到表中记录旁边的删除链接。但是，如果用户登录，我只希望他们看到编辑和详细信息，而不是删除。最好的方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T16:13:21.457

这是一个有多个答案的混合包。有两种很好的方法可以做到这一点。

一种是根据登录用户在控制器（或 Global Application_Request）中创建所有链接并将其传递给视图。我不喜欢这个，因为控制器创建的链接在我看来是视图的责任。

第二种方法是手动检入视图本身。它很简单很干净，但它是视图中的逻辑。

**部分菜单.cshtml**

```
<a href="/User/Attack">Boot To The Head</a>
@if (User.IsInRole("Administrator"))
{
  <a href="/Admin/BootToTheHead">You Missed</a>
} 
```

# r - 将R中iGraph的所有边输出到XML

> ID：10587007
> 
> 赞同：1
> 
> 时间：2012-05-14T15:43:36.543
> 
> 标签：r, graph-theory, igraph

我想将 iGraph g 中的所有边输出到 XML 文件，它看起来像这样：

```
<edges>
    <edge from="1" to "2" />
    <edge from="1" to "4" />
    ...
</edges> 
```

我知道我可以使用 E(g) 获取边列表，但我不知道如何为每个边抓取每个人来回输出到 XML。

另外，我已经为所有顶点设置了名称属性，并且需要输出它们的名称——而不是它们的 id。

有人可以给我一些建议。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T16:05:02.777

`?write.graph`在 R 中签出。该`igraph`包可以将图形对象导出为多种格式。

# perl - 有没有办法使用 perl 将文本文件转换为 LaTEX？

> ID：10587010
> 
> 赞同：0
> 
> 时间：2012-05-14T16:05:39.293
> 
> 标签：perl

我基本上想将文本文件转换为 pdf 和其他格式。所以我在想，如果我可以先将它转换成 LaTEX，那么我可以继续进行 pdf 转换。这可行吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T00:02:25.653

正如您所说，您熟悉 LaTeX，您知道只有几个[特殊字符](http://www.cespedes.org/blog/85/how-to-escape-latex-special-characters)。除此之外，常规文本和 LaTeX 标记非常相似。直到你接触到格式、数字和数学，它才会更多地参与其中。也就是说，设置一些正则表达式来转义传入的文本并不需要太多。

编辑：

似乎有人已经制作了这样的模块：[TeX::Encode](http://search.cpan.org/perldoc?TeX%3a%3aEncode)。我自己也要去试试。存在依赖问题，必须手动安装`Test::Pod::Coverage`才能安装`TeX::Encode`；是的，这很尴尬。

# apache - 如何将 URL 从“foo.boo.edu/someone/someone.htm”更改为“foo.boo.edu/~someone”？

> ID：10587018
> 
> 赞同：0
> 
> 时间：2012-05-14T16:05:59.153
> 
> 标签：apache, redirect

我正在尝试缩短我们研究实验室的网站。

第一步是更改个人主页：

```
http://xxx-lab.engr.xxx.xxxx.edu/me/index.htm 
```

至

```
http://xxx-lab.engr.xxx.xxxx.edu/~me 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T16:08:26.597

您没有提供有关您正在使用的网络服务器的太多信息......

如果您使用的是 Apache，那么您应该查看 url 重写规则

[https://httpd.apache.org/docs/2.0/misc/rewriteguide.html](https://httpd.apache.org/docs/2.0/misc/rewriteguide.html)

# php - 删除 XML 子节点

> ID：10587021
> 
> 赞同：1
> 
> 时间：2012-05-14T16:06:25.377
> 
> 标签：php, xml, xmldom

我想知道是否有人可以帮助我。

我正在使用[这个](http://www.mapmyfinds.co.uk/development/deletetest.php#/0)页面来允许用户查看他们上传的图片库。

上传后，图像保存在此文件路径`UploadedFiles/userid/locationid/image`中，图像的详细信息（即名称、描述等）保存在一个名为 XML 的文件中，该文件`files.xml`位于与图像相同的目录中。其摘录如下所示：

```
<?xml version="1.0" encoding="utf-8" ?> 
- <files>
  <file name="AC-0003749-Clark_145520.jpg" source="AC-0003749-Clark_145520.jpg" size="3873" originalname="AC-0003749-Clark_145520.jpg" description="No description provided" userid="1" locationid="1" /> 
  </files> 
```

画廊通过每张图片下方的图标为用户提供了额外的功能，可以删除每张图片。这是通过以下代码完成的：

**图标点击事件**

```
<script type="text/javascript"> 
        Galleria.ready(function() {
            this.$('thumblink').click();

        $(".galleria-image").append( 
        "<span class='btn-delete ui-icon ui-icon-trash'></span>"); 
        $(".btn-delete").live("click", function(){
        var img = $(this).closest(".galleria-image").find("img"); 

        // send the AJAX request
        $.ajax({
        url : 'delete.php',
        type : 'post',
        data : { image : img.attr('src') },
        success : function(){
        alert('Deleting image... ');
        img.parent().fadeOut('slow');
        }
        });

        return false;
        });

        });

    </script> 
```

**delete.php - 修改后的代码**

```
<?php 

if (!empty($_POST)) { 
$image = $_POST['image']; 

if (file_exists($image)) { 
unlink($image); 
} 
} 

$doc = new DOMDocument; 
$doc->load('files.xml'); 

$thedocument = $doc->documentElement; 

$list = $thedocument->getElementsByTagName('files'); 

$nodeToRemove = null; 
foreach ($list as $domElement){ 
if ($attrValue == '$image') {     $domElement->parentNode->removeChild($domElement); } 
}

if ($nodeToRemove != null) 
$thedocument->removeChild($nodeToRemove); 

echo $doc->saveXML(); 
?> 
```

物理图像的删除工作正常，但我很难弄清楚如何删除相关的子节点。虽然我没有收到错误消息，但节点没有被删除。我从这个站点收到了一些关于如何去做的指导[，](https://stackoverflow.com/questions/10552309/remove-xml-node-with-jquery)即通过 PHP XML DOM，但老实说，我读的越多，我就越困惑。我似乎无法理解它。

我只是想知道是否有人可以看看这个，让我知道我哪里出错了。

非常感谢和亲切的问候

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T16:17:08.010

要删除与您一起找到的节点，`getElementsByTagName`可以使用以下命令将其删除：

```
if (!empty($_POST)) { 
    $image = $_POST['image']; 

    if (file_exists($image)) { 
        unlink($image); 
    }

    $doc = new DOMDocument; 
    $doc->load('files.xml');

    // iterate over all tags named <file>
    $list = $doc->getElementsByTagName('file');
    foreach ($list as $domElement) {
        // check whether attribute 'source' equals $image
        if ($domElement->getAttribute('source') == $image) {
            // remove the node
            $domElement->parentNode->removeChild($domElement);
        } 
    }

    echo $doc->saveXML();
} 
```

# linux - 等待具有特定扩展名的所有文件停止存在

> ID：10587027
> 
> 赞同：2
> 
> 时间：2012-05-14T16:06:38.047
> 
> 标签：linux, shell, while-loop, file-exists

我有一个 shell 脚本，可以解压缩一堆文件，然后处理这些文件，然后将它们重新压缩。我想等待处理，直到所有文件都完成解压缩。我知道如何为一个文件执行此操作：

```
while [ -s /homes/ndeklein/mzml/JG-C2-1.mzML.gz ]
do
  echo "test"
  sleep 10
done 
```

但是，当我这样做时

```
while [ -s /homes/ndeklein/mzml/*.gz ] 
```

我收到以下错误：

```
./test.sh: line 2: [: too many arguments 
```

我假设是因为有超过 1 个结果。那么如何对多个文件执行此操作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T16:17:26.047

您可以在 shell 中执行子命令并检查是否有输出：

```
while [ -n "$(ls /homes/ndeklein/mzml/*.gz 2> /dev/null)" ]; do
    # your code goes here
    sleep 1; # generally a good idea to sleep at end of while loops in bash
done 
```

如果目录可能有数千个文件，您可能需要考虑使用`find`而不是`ls`使用通配符，即；`find -maxdepth 1 -name "*\.gz"`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T16:16:29.867

`xargs`如果`while`不被胁迫，是你的朋友。

```
ls /homes/ndeklein/mzml/*.gz | xargs -I {} gunzip {} 
```

# vim - 用包装的 vim 附加到可见行的末尾

> ID：10587028
> 
> 赞同：4
> 
> 时间：2012-05-14T16:06:49.437
> 
> 标签：vim

我有一个包含一些相当长的行的文件，这很痛苦。

我正在使用`:set wrap`and `:set linebreak`，这很好，我已经从[这个页面](http://vim.wikia.com/wiki/Move_cursor_by_display_lines_when_wrapping)反弹了几个键，以便我可以上下移动一条可见线（而不是现在已经包裹在 10-12 条可见线上的物理线） .

我使用`A`了很多（附加在行尾），但这附加在物理行的末尾，而不是可见的 - 是否有一个键映射（或替代击键）我可以用来附加到可见的末尾包裹线？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-14T16:45:31.940

您可以尝试使用`g$a`. `g$`将您置于当前“屏幕行”的末尾，并使`a`您处于插入模式。

也许是一个映射：

```
nnoremap <leader>a g$a 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-14T16:44:20.260

`g$a`- 转到屏幕行的最后一个字符，然后追加。

想要映射？

```
:nnoremap gA g$a 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-14T16:43:22.317

键入`g$`以转到可见行的末尾并`a`进入*插入*模式。我想你可以为此创建一个自定义映射。

# mysql - 安排 MySQL 表的快照

> ID：10587029
> 
> 赞同：1
> 
> 时间：2012-05-14T16:06:51.103
> 
> 标签：mysql, snapshot, schedule

可以安排 MySQL 表的快照吗？

情况：

我有一张从网站收集选票（上下）的桌子。它记录投票数（可以是赞成票，“+1”，也可以是反对票，“-1”），并记录得分（例如，如果一个 ID 获得 5 票，则 3 票“赞成” " (+1) 和 2 投票“反对” (-1)，则该表将记录投票数为“5”，投票得分为“2”。记录在具有以下内容的表中列标题/字段：

身份证 | 分数 | 投票

…其中 ID 是被投票项目的参考；'score' 是计算的实际分数（根据“+1”和“-1”票数），“nvotes”是已收到的票数

这对于在任何时间点查看网站并查看得分是多少以及有多少人投票非常有用。

但是，我现在希望能够绘制 ID 的趋势图——回顾过去，看看分数是如何随着时间的推移而上升和下降的。

MySQL 中是否有能够在每天结束时拍摄快照的工具，记录该特定 ID 在当天结束时的得分和收到的票数，并将其存储在另一个表中这样我就可以随着时间的推移创建图表和分析？

或者，如果做不到这一点，谁能想到一种更好、更聪明的方法来尝试实现我的需要？

# java - JPA：“未找到列”尽管 JPA 创建了表

> ID：10587033
> 
> 赞同：0
> 
> 时间：2012-05-14T16:07:07.803
> 
> 标签：java, hibernate, jpa

我正在尝试测试从数据库中批量读取数据。

我有一个实体，例如：

```
@Entity
@Table(name = "CLIENT")
public class ClientEntity {
    @Id
    @Column(name = "ID")
    private Long id;

    @Column(name = "START", nullable = false)
    @Temporal(TemporalType.DATE)
    private Date start;
} 
```

当对我的批次进行单元测试时，我将数据插入到内存数据库中，这要归功于在选项设置为 on`hibernate.hbm2ddl.import_files`时使用该选项读取的 SQL 脚本：`hibernate.hbm2ddl.auto``create`

```
Insert into CLIENT(ID, START) values (1,'2006-02-01')
Insert into CLIENT(ID, START) values (2,'2010-02-01') 
```

我可以在日志中看到该表已正确创建。然而，当`CLIENT`在我的代码中进一步检索 s 时（可能通过一些连接），会引发异常：

```
ERROR - Column "CLIENTENTI0_.START" not found; SQL statement:
    select cliententi0_.ID as ID1_10_, cliententi0_.START 
        as START2_10_ from CLIENT cliententi0_ [42122-165] 
```

我必须补充一点，当插入现有的 Oracle 数据库时，代码运行完美！

我的代码有什么问题？我怎样才能让它工作？

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T16:37:56.047

好吧，我很惭愧。

错误来自这样一个事实，即我的批处理的目标是从数据库中读取数据`A`并将数据写入数据库`B`。

为了测试我的批次，我设置了两个内存实例。但是一个错误的复制和粘贴让我创建了两次相同的实例......并且由于 有一个`CLIENT`表`A`和另一个`CLIENT`表`B`，检索数据时引发错误：其中一个表创建不正确！

希望这可以帮助别人！

# sql - 如何按rails中关联的created_at列排序？

> ID：10587034
> 
> 赞同：11
> 
> 时间：2012-05-14T16:07:08.007
> 
> 标签：sql, ruby-on-rails, activerecord

以下是我的联想：

```
Class Post
belongs_to :user
has_many :favorites, :dependent => :destroy
has_many :favoriters, :through => :favorites, :source => :user
end

Class User
has_many :posts
has_many :favorites,  :dependent => :destroy
has_many :favorited, :through => :favorites, :source => :post
end

Class Favorites
belongs_to :user, :post
end 
```

我想按收藏夹关联的 created_at 列对用户最喜欢的帖子进行排序。但是，这是按 Post created_at 属性排序的，而不是 Favorites created_at 属性。如何按收藏夹 created_at 属性排序？

```
 @posts=@user.favorited.order('created_at DESC') 
```

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-05-14T17:46:35.613

您需要在 order by 子句中指定要使用的表。

```
@posts = @user.favorited.order('posts.created_at DESC') 
```

应该这样做。

一个不错的技巧是在检查关联时使用 rails 控制台。具体来说，它有助于在您正在执行的 Active Record 查询中使用“to_sql”方法。

例如：

```
% bundle exec rails console

> u = User.last
> u.favorited.order('created_at DESC').to_sql 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2015-03-21T06:25:56.940

在您的帖子模型中使用它来设置默认顺序：

```
default_scope { order("created_at DESC") } 
```

# graphics - RenderMan 事件向量不一致

> ID：10587040
> 
> 赞同：1
> 
> 时间：2012-05-14T16:07:14.863
> 
> 标签：graphics, 3d, render, renderman

我正在将一系列光和表面着色器从 3Delight 转换为 PRMan，我发现了两者之间的差异，我无法解决。似乎当由于光照着色器中的跟踪而评估表面着色器的透射不透明度时`I`，PRMan 中的入射矢量被设置为表面的法线。

在我的示例场景中，有一个半球漂浮在圆盘上方。来自上方的远处光线将跟踪的透射值投射到它们后面的表面上（对于光线来说有点向后，但这是一个演示）。当被相机观察时，半球上的表面被渲染为由其法线着色的纯色，但在查询传输时具有入射方向的不透明度。

这是我期望它的样子，也是我从 3Delight 收到的：

![3喜悦渲染](../Images/3d000c72c01e1d61e99323c3c9dea041.png)

请注意，地板是实心的，几乎是纯绿色；如果入射角是垂直的，我们期望的颜色。但是，当我使用 PRMan 渲染完全相同的场景时，我会收到以下信息：

![在此处输入图像描述](../Images/8d5d54dcebd953e1c36d4017aa0c13eb.png)

它似乎在投射法线。

我尝试通过获取值`rayinfo`并计算一个 new `I`，但这些值都与`I`实际设置的值匹配。我也注意到与 的差异`E`，但我无法确定 PRMan 中的设置。

**问：我怎样才能得到我所期待的事件向量“I”？**

内容`scene.rib`：

```
Display "falloff.tiff" "framebuffer" "rgba"
Projection "perspective" "fov" [17]
Format 400 400 1
ShadingRate 0.25
PixelSamples 3 3

# Move the camera
Translate 0 -0.65 10
Rotate 30 -1 0 0

Option "searchpath" "string shader" ".:&"

WorldBegin

    LightSource "projector" "projector_light"
        "point to" [0 -1 0]

    Surface "matte"
    TransformBegin
        Rotate 90 1 0 0
        Disk 0 1.25 360
    TransformEnd

    Surface "inspect_incident"
    Attribute "visibility" "integer transmission" [1]
    Attribute "shade" "string transmissionhitmode" "shader"
    TransformBegin
        Translate 0 1 0
        Rotate -90 1 0 0 
        Sphere 1 0 1 360
    TransformEnd

WorldEnd 
```

内容`projector.sl`：

```
light projector(

    float intensity = 1;
    color lightcolor = 1;

    point from = point "shader" (0,0,0);
    point to = point "shader" (0,0,1);
    float maxdist = 1e12;

) {

    uniform vector dir = normalize(to - from);
    solar(dir, 0.0) {
        Cl = intensity * lightcolor * (1 - transmission(Ps, Ps - dir * maxdist));
    }

} 
```

内容`inspect_incident.sl`：

```
class inspect_incident() {

    public void opacity(output color Oi) {
        vector In = normalize(I);
        Oi = color((In + 1) / 2);
    }

    public void surface(output color Ci, Oi) {
        vector Nn = normalize(N);
        Ci = color((Nn + 1) / 2);
        Oi = 1;
    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T17:43:05.557

引用`__computesOpacity`表面着色器特殊参数的文档：

> 值 0 表示着色器不计算不透明度（即 Oi == Os）。这可用于覆盖着色器的传输命中模式。对于此类着色器，将跳过 opacity() 方法用于传输光线。
> 
> 值 1 表示着色器确实计算了不透明度。将运行此类着色器以评估其对透射光线的不透明度。该结果可能由渲染器缓存，因此必须与视图无关。
> 
> 值 2 表示着色器以与视图相关的方式计算不透明度。因此，渲染器将避免缓存传输光线的不透明度。不透明度仍被缓存以控制漫反射和镜面反射光线的延续，但可以使用 areashadow() 或透射() 生成与视图相关的阴影。对于模式 2，opacity() 方法必须仅依赖于检查 raytype == "transmission"..

并引用皮克斯的布赖恩：

> 将其设置`2`为做你想做的事。您所看到的是渲染运行 `opacity`一次与圆顶' `I`，并缓存它。

# c# - 删除了一些 GAC .dll 文件和 SQL 问题

> ID：10587046
> 
> 赞同：0
> 
> 时间：2012-05-14T16:07:36.150
> 
> 标签：c#, sql, gac

我在使用 SQL Server Express 2008 时遇到了一些问题，因为出于某种原因，我有几个相互冲突的版本。我被告知要通过并卸载它们，但我最终安装了所有与 SQL 相关的程序。现在，VS2010 上以前运行的 Windows 服务不再编译，因为它缺少 SQLCE 引用，并且我无法重新添加它，因为它不在 GAC 中。我该如何解决这个问题？

我认为我对这项任务有点不知所措，因为我并没有真正的数据库经验。我需要获取一个 .sql 文件并将其导入 Microsoft SQL Server Express 2008。是否有非常初级的 SQL 教程可以帮助我完成此操作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T16:48:56.513

如果您最终不得不卸载所有这些并重新安装，则最好按照特定顺序安装 Visual Studio 和 SQL 工具：

1.  视觉工作室 2008
2.  Visual Studio 2008 服务包 1
3.  SQL Server 2008 或 SQL Server 2008 R2
4.  SQL Server 2008 Service Pack 1 或 SQL Server 2008 R2 Service Pack 1
5.  视觉工作室 2010
6.  Visual Studio 2010 服务包 1
7.  SQL Server 2012

请注意，对于 SQL 的 Express 版本，没有单独的 Service Pack。Service Pack 与 Express 版安装程序集成在一起。

我从评论中看到您已经在尝试修复安装。确保在完成修复后重新安装适当的 Service Pack。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T16:13:49.747

确保在发布问题之前进行一些良好的搜索。我搜索了“将 .sql 文件导入 sql server 2008”，并在前十名中找到了一些不错的条目。

[如何将 .sql 文件导入 SQL Server Express](https://stackoverflow.com/questions/6535532/how-to-import-sql-file-into-sql-server-express)

# mysql - MySql 根据计数进行子选择和计数

> ID：10587052
> 
> 赞同：2
> 
> 时间：2012-05-14T16:07:47.817
> 
> 标签：mysql, select, count, temp-tables, subquery

这是我的表结构的模型。三张桌子。

```
----------------     ----------------------------     -------------------------------
|possibilities |     |realities                 |     |measurements                 |
|--------------|     |--------------------------|     |-----------------------------|
|pid| category |     |rid | pid | item | status |     |mid | rid | meas | date      |
|--------------|     |--------------------------|     |-----------------------------|
|1  | animal   |     |1   | 1   | dog  | 1 (yes)|     |1   | 1   | 3    | 2012-01-01|
|2  | vegetable|     |2   | 1   | fox  | 1      |     |2   | 3   | 2    | 2012-01-05|
|3  | mineral  |     |3   | 1   | cat  | 1      |     |3   | 1   | 13   | 2012-02-02|
----------------     |4   | 2   | apple| 2 (no) |     |4   | 3   | 24   | 2012-02-15|
                     |5   | 1   | mouse| 1      |     |5   | 2   | 5    | 2012-02-16|
                     |7   | 1   | bat  | 2      |     |6   | 6   | 4    | 2012-02-17|
                     ----------------------------     ------------------------------- 
```

我所追求的是一个结果，它将根据“可能性”表中特定条目的测量范围向我显示一系列计数，其中相关“现实”的状态为 1（意味着它当前正在被跟踪），但是唯一相关的测量是最近的测量。

这是我正在寻找使用动物作为可能性的示例结果。

```
-----------------------
| 0-9 | 10-19 | 20-29 |
|---------------------|
| 2   | 1     | 1     |
----------------------- 
```

所以，在这个例子中，苹果行没有被用来计数，因为它不是动物，蝙蝠也没有被用来计数，因为它的状态被设置为 no（意思是不测量），并且只使用了最近的测量值来确定计数。

我目前在我的实际使用中有一个解决方法，但它没有遵循良好的数据库规范化。在我的现实表中，我有一个 current_meas 列，当进行新的测量并将其输入测量表时，该列会更新。然后我只需要使用前两个表，我有一个 SELECT 语句，其中包含一堆嵌入的 SUM 语句，例如使用 IF 值在 0-9 之间。它给了我想要的东西，但是我的应用程序已经发展到这种便利在其他领域成为问题的地步。

所以，问题是，有没有一种更优雅的方法可以在一个语句中做到这一点？子选择？临时表？获得计数是该应用程序的核心。

这是一个基于 PHP5、MySQL5、JQuery 1.8 的 web 应用程序，以防给我更多选择。提前致谢。我喜欢堆栈，并希望能提供尽可能多的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T13:50:39.100

这是我根据建议的两个答案最终做的事情。

1.  首先，我创建了一个临时表，该表基于一种可能性（动物）生成现实表，其状态为 1（是）。
2.  其次，我创建了一个临时表，它从第一个临时表中生成一个包含各个现实的表，并为每个临时表找到最新的测量值。
3.  从第二个表中，我做了一个选择，它给了我范围内的计数细目。

当我只用一个临时表尝试它时，每种可能性的查询都需要 5-10 秒。在我的实际使用中，我目前有 30 种可能性（一个脚本循环遍历每个可能性并生成这些临时表和选择），超过 1,000 个现实（在任何一天有 600 个处于活动状态，每月增加 100 个），以及超过 21,000 个测量值（每天添加 20-30 个）。那对我不起作用。因此，将其分解为较小的池，以便在 3-4 秒内将其从减少到运行的整个报告。

这是带有我真实世界表名和列名的 MySQL 资料。

```
//Delete the temporary tables in advance
$delete_np_prod = 'DROP TABLE IF EXISTS np_infreppool';
mysql_query($delete_np_prod) or die ("Drop NP Prod Error " . mysql_error ());
$delete_np_max = 'DROP TABLE IF EXISTS np_maxbrixes';
mysql_query($delete_np_max) or die ("Drop NP Max Error " . mysql_error ());

//Make a temporary table to hold the totes of this product at North Plains that are active
$create_np_prod_pool_statement = 'CREATE TEMPORARY TABLE np_infreppool
SELECT inf_row_id FROM infusion WHERE formid = ' . $active_formids["formid"] . ' AND location = 1 AND status = 1';
mysql_query($create_np_prod_pool_statement) or die ("Prod Error " . mysql_error ());

//Make a temporary table to hold the tote with its most recent brix value attached to it.
$create_np_maxbrix_pool_statement = 'CREATE TEMPORARY TABLE np_maxbrixes
SELECT b.inf_row_id AS inf_row_id, b.brix AS brix from brix b, np_infreppool pool WHERE b.inf_row_id = pool.inf_row_id AND b.capture_date = (SELECT max(capture_date) FROM brix WHERE inf_row_id = pool.inf_row_id )';
mysql_query($create_np_maxbrix_pool_statement) or die ("Brix Error " . mysql_error ());

//Get the counts for slected form from NP
$get_report_np = "SELECT 
        SUM(IF(brix BETWEEN 0 AND 4,1,0)) as '0-4',
        SUM(IF(brix BETWEEN 5 AND 9,1,0)) as '5-9',
        SUM(IF(brix BETWEEN 10 AND 14,1,0)) as '10-14',
        SUM(IF(brix BETWEEN 15 AND 19,1,0)) as '15-19',
        SUM(IF(brix BETWEEN 20 AND 24,1,0)) as '20-24',
        SUM(IF(brix BETWEEN 25 AND 29,1,0)) as '25-29',
        SUM(IF(brix BETWEEN 30 AND 34,1,0)) as '30-34',
        SUM(IF(brix BETWEEN 35 AND 39,1,0)) as '35-39',
        SUM(IF(brix BETWEEN 40 AND 44,1,0)) as '40-44',
        SUM(IF(brix BETWEEN 45 AND 49,1,0)) as '45-49',
        SUM(IF(brix BETWEEN 50 AND 54,1,0)) as '50-54',
        SUM(IF(brix BETWEEN 55 AND 59,1,0)) as '54-49',
        SUM(IF(brix BETWEEN 60 AND 64,1,0)) as '60-64',
        SUM(IF(brix BETWEEN 65 AND 69,1,0)) as '65-69',
        SUM(IF(brix >=70, 1, 0)) as 'Over 70'
    FROM np_maxbrixes";
$do_get_report_np = mysql_query($get_report_np);
$got_report_np = mysql_fetch_array($do_get_report_np); 
```

**更新**

我让它在单个 SELECT 语句中工作，而不使用临时表，它工作得更快。使用我上面的示例模式，这是它的外观。

```
 SELECT 
    SUM(IF(m.meas BETWEEN 0 AND 4,1,0)) as '0-4',
    SUM(IF(m.meas BETWEEN 5 AND 9,1,0)) as '5-9',
    SUM(IF(m.meas BETWEEN 10 AND 14,1,0)) as '10-14',
    SUM(IF(m.meas BETWEEN 15 AND 19,1,0)) as '15-19',
    SUM(IF(m.meas BETWEEN 20 AND 24,1,0)) as '20-24',
    SUM(IF(m.meas BETWEEN 25 AND 29,1,0)) as '25-29',
    SUM(IF(m.meas BETWEEN 30 AND 34,1,0)) as '30-34',
    SUM(IF(m.meas BETWEEN 35 AND 39,1,0)) as '35-39',
    SUM(IF(m.meas BETWEEN 40 AND 44,1,0)) as '40-44',
    SUM(IF(m.meas BETWEEN 45 AND 49,1,0)) as '45-49',
    SUM(IF(m.meas BETWEEN 50 AND 54,1,0)) as '50-54',
    SUM(IF(m.meas BETWEEN 55 AND 59,1,0)) as '54-49',
    SUM(IF(m.meas BETWEEN 60 AND 64,1,0)) as '60-64',
    SUM(IF(m.meas BETWEEN 65 AND 69,1,0)) as '65-69',
    SUM(IF(m.meas >=70, 1, 0)) as 'Over 70'
FROM measurement m, realities r 
WHERE r.status = 1 AND r.pid = " . $_GET['pid'] . " AND r.rid = m.rid AND m.date = (SELECT max(date) FROM measurements WHERE rid = r.rid) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T16:26:44.830

这是一种方法

创建一个临时表以获取最近的测量值

```
CREATE TEMPORARY TABLE RecentMeasurements
SELECT * FROM Measurements m
INNER JOIN (SELECT max(mid) max_id,date FROM Measurements GROUP BY DATE ORDER BY DATE ) x
ON x.max_id=m.mid 
```

那么您是否查询：

```
SELECT *, your counting logic
FROM Realities
WHERE status = 1 AND pid = 1
INNER JOIN RecentMeasurements 
```

# asp.net - VB.NET 复选框检查

> ID：10587053
> 
> 赞同：0
> 
> 时间：2012-05-14T16:07:54.340
> 
> 标签：asp.net, vb.net

我有一个包含复选框字段的表单。在页面加载时，我想为我的数据库中的每个客户创建一个单独的复选框。我必须为每个客户创建复选框的代码工作正常。但是，如果客户设置为未经授权，我也想检查数据库，如果他们是，那么我想检查那里的框。我也有代码用于用户选中一个框的情况。如果选中了一个框，我会更新数据库，将未授权属性设置为 true。我的问题是当我选中一个框时它工作正常并且该框被选中，但是如果我重新加载页面，所有框都未选中。因此，要么我的数据库更新没有更新数据库，要么我检查页面加载复选框的方式不正确。有任何想法吗？

asp复选框字段的代码：

```
<asp:CheckBoxList id="check1" AutoPostBack="True" TextAlign="Right" OnSelectedIndexChanged="Check" runat="server">

</asp:CheckBoxList> 
```

页面加载代码：

```
Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
    Dim sql As String = "SELECT Name, unauthorized, ID FROM Customer ORDER BY Name"
    Dim dt As DataTable = db.execDataTableQuery(sql, "Customer")
            Dim i As Integer
            For i = 0 To dt.Rows.Count - 1
                check1.Items.Add(New ListItem(CStr(dt.Rows(i).Item("Name"))))
                check1.Items(i).Value = CInt(dt.Rows(i).Item("ID"))
                check1.Items(i).Text = CStr(dt.Rows(i).Item("Name"))
                If CInt(dt.Rows(i).Item("unauthorized")) = 1 Then
                    check1.Items(i).Selected = 1
                Else
                    check1.Items(i).Selected = 0
                End If
            Next

        End Sub 
```

更新数据库的代码：

```
 Sub Check(ByVal sender As Object, ByVal e As EventArgs)
        Dim sql As String
        If check1.SelectedItem.Selected = 1 Then
            sql = "UPDATE Customer SET unauthorized = 1 WHERE ID = @ID"
            db.execUpdateQuery(sql, New SqlClient.SqlParameter("@ID", check1.SelectedItem.Value))
        Else
            sql = "UPDATE Customer SET unauthorized = 0 WHERE ID = @ID"
            db.execUpdateQuery(sql, New SqlClient.SqlParameter("@ID", check1.SelectedItem.Value))
        End If
    End Sub

End Class 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T16:14:21.577

您需要将 Page_Load 中的代码包装在 a 中`Not Page.IsPostback`，否则在回发时不会触发任何事件并且选择会丢失，因为您正在从数据库中覆盖它。

```
Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
    If Not IsPostback Then
        ' databind your CheckBoxList '
    End If
End Sub 
```

# android - Android 上的应用程序之间的 SSO

> ID：10587058
> 
> 赞同：2
> 
> 时间：2012-05-14T16:08:18.953
> 
> 标签：android, model, single-sign-on

是否有标准或经过验证的模型可以在同一设备上以 sso 方式对各种应用进行身份验证？
假设我们在设备上有两个应用程序需要相同的登录名/密码凭据才能对同一系统进行身份验证。
我们希望能够：
- 启动 app1
- 登录到 app1
- 启动 app2。在 app2 中，用户已通过身份验证。

我们想到一个“流行”模型，其中第一个登录的应用程序共享身份验证信息（例如令牌）。第二个应用程序获取（弹出）令牌以执行 sso。

这个模型有副作用吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T18:20:53.440

请考虑使用意图，只有一个应用程序负责身份验证。其他人将调用负责身份验证和 sso 的应用程序。

[http://developer.android.com/reference/android/content/Intent.html](http://developer.android.com/reference/android/content/Intent.html)

[http://www.vogella.com/articles/AndroidIntent/article.html#intents_overview](http://www.vogella.com/articles/AndroidIntent/article.html#intents_overview)

您建议的方法类似于 facebook sdk for android for sso 使用的方法，请阅读此处

[https://developers.facebook.com/docs/mobile/android/build/#enablesso](https://developers.facebook.com/docs/mobile/android/build/#enablesso)

如果 facebook 使用它，应该经过现场测试和验证。

# java - 多线程应用程序性能

> ID：10587059
> 
> 赞同：2
> 
> 时间：2012-05-14T16:08:21.723
> 
> 标签：java, multithreading, performance, multicore

我的 Java 应用程序基本上是这样做的：

*   从文件中读取 nThread 缓冲区（1 mb 字节数组）
*   创建处理缓冲区的 nThread 线程
*   等待线程处理数据
*   将处理后的数据写入另一个文件

它是应该为每个内核实现理论上 100% 速度提升的应用程序之一，但相反，处理信息的线程越多，它变得越慢！

例子：

*   1 个线程：4800 毫秒
*   2 个线程：10200 毫秒
*   3 个线程：13400 毫秒
*   4 个线程：18560 毫秒
*   等等

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T16:18:37.757

在添加线程时获得这种性能意味着您做错了什么。通常添加线程不会提供任何速度改进，有时可能会有点惩罚你，但添加另一个线程并使程序运行时间加倍是非常不寻常的。

这里有一些事情需要调查：

*   正如评论中提到的@Tudor，您应该从单个线程读取输入文件，然后将工作分派给工作线程。
*   您应该考虑使用 an`ExecutorService`而不是自己管理自己的线程。这通常会删除很多用户代码和相关的错误。见[`Executors.newFixedThreadPool(numThread)`](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/concurrent/Executors.html#newFixedThreadPool%28int%29)。
*   你确定你开始你的线程正确吗？你应该打电话`new Thread(...).start()`而不是`run()`直接打电话。
*   你在开始下一个线程`join()` *之前打电话吗？*您应该将`start()`所有线程分派给它们，然后`join()`在最后对它们进行调度。
*   您是否有可能意外地将所有输入行发送到所有线程？我不认为这会显示性能数字，除非您也增加输出 IO。

如果您在问题中向我们展示您的一些线程代码，我们可以提供更多帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T19:09:45.070

未经充分优化的代码通常会自行耗尽整个内存带宽。在多核处理器上使用相同的未优化代码添加另一个线程，它们将在它们之间分配带宽，此外，还会经常相互碰撞，进一步减慢速度。

格雷说：“......将程序运行时间加倍是非常不寻常的。” 我不同意。这通常是在您开始优化内存访问之前在 C 代码中发生的情况。我想说从一开始就没有看到放缓是非常不寻常的。

我不知道 Java 是否可以进行采样，但这是一个显而易见的起点。

# java - Java UTF-16LE 奇怪的错误难倒了我的教授

> ID：10587061
> 
> 赞同：0
> 
> 时间：2012-05-14T16:08:36.063
> 
> 标签：java, cryptography, utf-16le

如上所述，我在 Java 中遇到了 UTF-16LE 的问题。当我运行我的代码时，它通常会正确加密、解密和打印消息。有时它会丢失两个加密字符，有时它会打印出一个非英文字符，例如希腊语等。

这是一个班级，它确实难倒了我的教授，任何帮助将不胜感激。

```
/*This program was written by me for my professors class. 
```

该程序的目的是使用 XOR 加密对消息进行加密，并以相同的方式对其进行解密，以便为这些方法生成一个密码本。*/

```
import java.security.*;

public class Crypto 
{
    public static void main(String[] args) throws Exception
    {           
        Crypto c = new Crypto(); 

        byte[]codebook = null;
        String message = "";   

        System.out.println("Generating codebook");
        codebook = c.makeCodebook(14);
        System.out.println();

        System.out.println("Now Encrypting");
        System.out.println("This is the contents of the Encrypted Message: ");
        message = c.crypt("1234567", codebook);
        System.out.println();

        System.out.println("Now Decrypting");
        System.out.println("This is the contents of the Decrypted Message");
        message = c.crypt(message, codebook);

        System.out.println();
        System.out.println("Your message is: ");      
        System.out.println(message);

    }//publis static void main(String [] args)

    //Encrypts or decrypts message against the codebook assuming the appropriate length
    public String crypt (String message, byte [] codebook) throws Exception
    {
        //Take the message and put it into an array of bytes.
        //This array of bytes is what will be XORed against the codebook
        byte[] cryptedMessage = message.getBytes("UTF-16LE");
        byte[] result = new byte[14];
        message = "";
        System.out.println(message.length());
        System.out.println(cryptedMessage.length);
        System.out.println(result.length);
        //Let's see the contents of encryptedMessage
        for(int i = 0; i< cryptedMessage.length; i++)
        {
            System.out.print(cryptedMessage[i]+" ");
        }//for(int i = 0; i< encryptedMessage.length; i++)
        System.out.println();

        //XOR codebook and encryptedMessage
        System.out.println("This is the message using XOR:");
        for(int i = 0; i<result.length; i++)
        {
            //since XOR has return type of an int, we cast it to a byte
            result[i] = (byte)(((byte)(codebook[i])) ^ ((byte)(cryptedMessage[i])));
            System.out.print(result[i]+" ");
        }//while(result[i]!=0)
        //output
        System.out.println();
        //output

        System.out.println(message.length());
        System.out.println(cryptedMessage.length);
        System.out.println(result.length);
        return new String(result, "UTF-16LE");
    }//public String crypt (String message, byte [] codebook) throws Exception

    //Creates truly random numbers and makes a byte array using those truly random numbers
    public byte [] makeCodebook (int length) throws Exception
    {
        SecureRandom SecureRandom = new SecureRandom();//instance of SecureRandom named random
        byte[] codebook = null;

        codebook = new byte[length];
        SecureRandom.nextBytes(codebook);//generate bytes using the byte[]codebook

        //output
        System.out.println("This is the contents of the codebook: ");
        for(int i = 0; i < codebook.length;i++)
        {
            System.out.print(codebook[i]+" ");
        }//for(int i = 0; i < codebook[i];i++)
        //output
        System.out.println();
        return codebook;
    }//public byte [] MakeCodebook (int length) throws Exception

}//Public class Crypto 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T16:16:42.137

问题可能是因为`XOR`当解释为 UTF-16LE 字节序列时，针对随机数据的 ing 偶尔会产生不表达有效字符集的输出。

与其尝试将密文解释为 UTF-16LE 字符串，不如考虑在生成密文字节后仅对它们进行 base64 编码并返回生成的 base64 编码字符串。然后在解密时，对输入字符串进行 base64 解码以取回密文字节，执行 XOR 以获取您的明文字节，然后通过将明文字节解释为 UTF-16LE 序列从明文字节创建明文字符串。

* * *

*更新以回复下面的评论，而不必担心空间不足。*

正如我所说，您可以对密文字节进行 base64 编码。这在 Java 中当然是可行的。commons-codec 库有方法可以做到这一点，搜索会找到其他方法。如果您不允许使用外部库，请使用您自己的方法将任意字节转换为字节，以保证是某种有效的编码。

例如，您可以将密文中的每个字节分成高 4 位和低 4 位。因此，每个字节将产生一对值，每个值的范围为 0-15。`'A'`然后，您可以通过将 ASCII 代码添加到这些数字来从每个字节生成一个 2 字节序列。这不是很有效，但它可以完成工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T16:49:14.517

如果语句在下面添加检查，您应该检查您的代码是否有 ArrayIndexOutOfBoundsException 错误，并且当我尝试像阿拉伯语这样的非英文字符时，它总是抛出 //XOR codebook 和 encryptedMessage System.out.println("This is the message using XOR:"); for(int i = 0; 我

```
 //since XOR has return type of an int, we cast it to a byte
            if(result.length<=cryptedMessage.length){
            result[i] = (byte)(((byte)(codebook[i])) ^ ((byte)(cryptedMessage[i])));
            System.out.print(result[i]+" ");
            }
        } 
```

# function - C++/CLI：成员函数指针队列

> ID：10587066
> 
> 赞同：2
> 
> 时间：2012-05-14T16:08:47.563
> 
> 标签：function, pointers, c++-cli, queue, member

我想使用队列来同步对几个独立代码块之间共享的串行端口的访问。每个块都提供一个回调函数，在需要时，该函数将被排入队列并处理串行端口上的一个原子操作。然后计时器会定期执行所有待处理的操作，希望不会受到干扰。

由于我对 C++/CLI 编程比较陌生，因此我能够创建一个*System::Collections::Queue*并将一些字符串排入队列；但对于我的一生，我无法弄清楚如何使用指向我的回调函数（*void Test()*）的指针来做同样的事情。

我用谷歌搜索了很多，但即使是最简单的例子也不适合我。所有这些代表，Boost，Marshal，gcnew 的东西现在让我有点困惑。

我正在使用 Microsoft Visual C++ 2010 Express。希望你能帮忙！

来自德国的问候，

保罗

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T16:17:13.933

在 .NET/CLR 世界中，System.Delegate 类是函数指针的类似物。

由于您正在做一些低级的事情并且回调是在高级托管环境中编写的，因此需要进行编组。

要将托管函数指针用作本机回调，您需要此 MSDN 文章

[http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.marshal.getdelegateforfunctionpointer(v=vs.80).aspx](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.marshal.getdelegateforfunctionpointer(v=vs.80).aspx)

如果您有一个 System.Delegate 实例队列，那么只需使用适当参数列表进行 D.DynamicInvoke() 调用。

# php - Jquery ajax JSON 在我的网页服务器上不起作用

> ID：10587068
> 
> 赞同：0
> 
> 时间：2012-05-14T16:08:50.493
> 
> 标签：php, jquery, json

如果我使用 Jquery Ajax 函数来解析 last.fm API 一切正常。

jQuery函数：

```
$.ajax({
    url: "http://ws.audioscrobbler.com/2.0/?method=album.search&album=believe&limit=2&api_key=b25b959554ed76058ac220b7b2e0a026&format=json",
    cache: true,
    dataType: "json",
    success: function(data_album) {
        $.each(data_album.results.albummatches.album, function(a_album,res_album){
            $("#search-album").append("Album: "+(a_album+1)+" :"+res_album.name+"<hr />");
        });
    } 
} 
```

但是，如果我将 LAST.FM url 页面的 JSON 结果复制到服务器上的 php 文件中，则不起作用：

PHP 页面

```
<?php header('content-type: application/json; charset=utf-8');
    echo '{"results":{"opensearch:Query":{"#text":"","role":"request","searchTerms":"believe","startPage":"1"},"opensearch:totalResults":"2523","opensearch:startIndex":"0","opensearch:itemsPerPage":"2","albummatches":{"album":[{"name":"Believe","artist":"Disturbed","id":"1418894","url":"http:\/\/www.last.fm\/music\/Disturbed\/Believe","image":[{"#text":"http:\/\/userserve-ak.last.fm\/serve\/34s\/53553281.png","size":"small"},{"#text":"http:\/\/userserve-ak.last.fm\/serve\/64s\/53553281.png","size":"medium"},{"#text":"http:\/\/userserve-ak.last.fm\/serve\/126\/53553281.png","size":"large"},{"#text":"http:\/\/userserve-ak.last.fm\/serve\/300x300\/53553281.png","size":"extralarge"}],"streamable":"1","mbid":"ed32813a-cd20-4bb3-b3fd-bca6161deb17"},{"name":"Make Believe","artist":"Weezer","id":"2025180","url":"http:\/\/www.last.fm\/music\/Weezer\/Make+Believe","image":[{"#text":"http:\/\/userserve-ak.last.fm\/serve\/34s\/53692665.png","size":"small"},{"#text":"http:\/\/userserve-ak.last.fm\/serve\/64s\/53692665.png","size":"medium"},{"#text":"http:\/\/userserve-ak.last.fm\/serve\/126\/53692665.png","size":"large"},{"#text":"http:\/\/userserve-ak.last.fm\/serve\/300x300\/53692665.png","size":"extralarge"}],"streamable":"1","mbid":"f4fe4c6a-d5b8-45a5-b24f-2c3b9dda8811"}]},"@attr":{"for":"believe"}}}';
?> 
```

jQuery函数：

```
$.ajax({
    url: "mypage.php",
    cache: true,
    dataType: "json",
    success: function(data_album) {
        $.each(data_album.results.albummatches.album, function(a_album,res_album){
            $("#search-album").append("Album: "+(a_album+1)+" :"+res_album.name+"<hr />");
        });
    } 
} 
```

为什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T17:20:31.443

您应该构建一个包含所有数据的 PHP 数组。然后使用`json_encode($theArray)`，它应该将数组转换为 JSON 数组

# java - 特定字符的正则表达式

> ID：10587070
> 
> 赞同：1
> 
> 时间：2012-05-14T16:09:03.037
> 
> 标签：java, regex

我已经构建这个正则表达式有一段时间了，到目前为止我运气不佳。无论如何，正则表达式应该捕获以下字符： {}[]+-*/,.();

下面的布尔表达式可以正常工作，除非遇到')'

```
atom.matches("\\[\\+\\-\\*/,.\\(\\)\\}\\{\\};"); 
```

感谢您提前提供任何帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T16:12:07.097

你应该使用一个字符类：

```
[{}[\]+*/,.()-] 
```

更多信息：[http ://www.regular-expressions.info/charclass.html](http://www.regular-expressions.info/charclass.html)

# objective-c - 更改 CGImageDestination dpi

> ID：10587083
> 
> 赞同：1
> 
> 时间：2012-05-14T16:09:50.310
> 
> 标签：objective-c, dpi, cgimage, nsimagerep

我知道如何更改 NSImageRep 的 dpi，但我不知道如何使 CGImage API 反映此更改...有没有办法让 CGImage 写入不是标准 72dpi 的文件？如果我将 NSImageRep 设置为 144dpi，当我使用 CGImage API 将其写入文件时，我总是会获得 72dpi 图像...

非常感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T16:29:53.870

当您使用 将图像添加到目标时`CGImageDestinationAddImage`，您可以将字典作为`properties`参数传递。对于此字典，您可以使用[CGImageProperties Reference](https://developer.apple.com/library/mac/#documentation/graphicsimaging/reference/CGImageProperties_Reference/Reference/reference.html)中指定的所有键，特别是`kCGImagePropertyDPIWidth`和`kCGImagePropertyDPIHeight`。

# c# - EF 5 Beta 2 是否支持表值参数？

> ID：10587084
> 
> 赞同：0
> 
> 时间：2012-05-14T16:09:50.977
> 
> 标签：c#, .net, entity-framework

EntityFramework 5 Beta 2 是否支持表值参数？我还没有看到任何关于这个问题的信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T16:37:11.817

不，它没有，但您可以在[Data UserVoice](http://data.uservoice.com/forums/72025-entity-framework-feature-suggestions/suggestions/1015347-table-valued-parameters)上投票支持此功能。

# .net - 在 Linux/Ubuntu 上大规模部署 .net mono 应用程序

> ID：10587093
> 
> 赞同：3
> 
> 时间：2012-05-14T16:10:43.543
> 
> 标签：.net, linux, deployment, mono, setup-deployment

我们有一个与 Mono 和 Linux 兼容的 .net 应用程序 - 用 Visual Studio 2010 编写。对于 Windows 上的部署，我们使用 Visual Studio 部署项目来构建安装程序并将文件放在正确的位置。

Linux 是否有等价物？对最终用户来说安装起来很容易和简单的东西吗？

谢谢

罗伯托

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-14T18:29:54.073

对于 Ubuntu，你真的想在发行版已​​经提供的基于 .deb/apt 的打包框架中工作（这同样适用于一般的 Debian 衍生产品；其他发行版系列有自己的系统，例如 RPM）。请参阅[Debian 打包基于 CLI 的应用程序/二进制文件的指南](http://pkg-mono.alioth.debian.org/cli-policy/index.html)。看看现有的基于单声道的应用程序是如何打包的（例如 MonoDevelop、F-Stop、Tomboy）可能也很值得一看。

# php - PHP - 如何在我的数据库中的 4 个项目之间放置横幅

> ID：10587099
> 
> 赞同：0
> 
> 时间：2012-05-14T16:11:11.940
> 
> 标签：php, mysql, sql, database

我是 php/msql 的初学者，需要帮助来解决这个问题：

我的表中有 4 个项目，现在我需要按 ID 顺序显示这四个项目。但现在我想在第二项和第三项之间添加一个 Google Adsense 横幅。我应该使用哪个代码？

我的页面必须如下所示：

> [第 1 项] [第 2 项] [横幅] [第 3 项] [第 4 项]

我的代码：

```
function getenqeute(){
    $q = "SELECT * FROM tblenquetes ORDER BY id";
    $r = mysqli_query($dbc,$q);
    $amountenqeutes = mysqli_num_rows($r);
    $enqeutenow = 1;
    while($enquete = mysqli_fetch_array($r)){
        if($enqeutenow==$amountenqeutes){
            echo '';
        }else{
            echo '';
        }
        $desc = htmlentities(htmlspecialchars($enquete['enquetedescription']));
        $hash_tag = md5($enquete['enqueteid'] . date('d-m-Y H:i:s',time()));
        $date = date('Y-m-d', time());
        $q = "INSERT INTO tblcallback VALUES('', '".$_SERVER['REMOTE_ADDR']."', '".$hash_tag."', '".$date."', '".$enquete['enqueteid']."', '0')";
        mysqli_query($dbc, $q);

        $link = 'http://domain.nl/enquete?enq='.$enquete['enquetelink'].'&publ_tag='.$hash_tag;
        echo'
    <div class="enquete-item" onclick="location.href=\''.$link.'\';">
        <a rel="nofollow" href="'.$link.'">
            <img src="'.$enquete['enqueteimagelink'].'" alt="'.$enquete['enquetename'].'"></img>
        </a>
        <p><b><a rel="nofollow" href="'.$link.'">'.$enquete['enquetename'].'</a></b><br/>
        '.$desc.'</p>
        <div class="clear"></div>
    </div>';
        $enqeutenow++;
    }
} 
```

对不起，我的英语不好。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T16:17:40.983

就像是

```
if ($enqeutenow == 3)
    echo GoogleAd 
```

# jquery - 了解，jquery-ui-autocomplete，有人可以尝试向我解释这段代码吗？

> ID：10587103
> 
> 赞同：0
> 
> 时间：2012-05-14T16:11:34.860
> 
> 标签：jquery, jquery-ui-autocomplete

好吧，我只是在服务器端使用 VB.net 实现 jquery-ui-autocomplete，但这是因为我遵循了一个示例，有没有人可以尝试解释（对于傻瓜）它是如何工作的？，我不知道的部分关于它是在返回（成功事件）：

```
$("#kSerial").autocomplete({
           source: function (request, response) {
               dataFromServer = "";
               $.ajax({
                   type: "POST",
                   url: URL + 'regresaSeriales',
                   async: false,
                   contentType: "application/json; charset=utf-8",
                   data: "{" + "'serial':'" + request.term + "'" + "}",
                   dataType: "json",
                   success: function (msg) {

                       /*This is the part I just don't get it*/                        

                       response($.map(msg.d, function (item) {
                           return {
                               value: item.serial
                           };
                       }));

                     /*and ends here*/

                   },
                   error: function () {

                       serial = 0;

                   }

               })

           }, 
```

在我的服务器端，我返回一个“串行”对象列表（List（of T）），它工作正常。

我只是按照一个示例并适应了我的服务器端代码，但我不知道返回部分是如何工作的，我的意思是我理解“源”属性接受回调，但无法实现它是如何工作的ajax请求成功事件中的代码。

事实上，我没有得到回调中 2 个参数的原因，尤其是“请求”，（请求，响应）。

这是我基于我的代码的教程： http: [//www.dotnetcurry.com/ShowArticle.aspx?ID=515](http://www.dotnetcurry.com/ShowArticle.aspx?ID=515)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T16:19:08.473

它获取响应数据，获取`d`对象属性（一个数组），对其进行迭代，并为该数组中的每个项目创建一个具有`value`该项目属性的`serial`属性的对象。

该[`$.map`调用](http://api.jquery.com/jQuery.map/)将所有这些对象放入一个数组中并将其发送到`response`函数（自动完成插件的 IIRC 部分，用于吐出完成）。

该`request`参数只是一个包含搜索词或“文本输入中的内容”的对象。这在[自动完成概述文档](http://jqueryui.com/demos/autocomplete/#overview)中有所描述。

# html - 在 DOM 中，如何使用 lxml 或 xpath 查找给定元素左侧并匹配条件的最右侧元素

> ID：10587104
> 
> 赞同：0
> 
> 时间：2012-05-14T16:11:35.267
> 
> 标签：html, dom, xpath, lxml, tree-search

我正在研究一个函数，该函数确定给定 html 元素的内容 - el - 在 lxml ElementTree 中是否是呈现的 HTML 页面中一行的前导内容。为此，我试图找到el左边的最右边的块级元素，然后确定这两者之间是否有内容。

我认为这可以通过以 DFS 的相反顺序遍历来发生，反向遍历从 el 开始。但我也一直在尝试使用 lxml 或 xpath 来查找是否存在更简单的方法来执行此操作。到目前为止，我已经找到了一些方法来查找具有某些标准的给定元素的祖先或左兄弟元素，但我还没有发现任何适用于特定节点右侧（或左侧）的整个树的东西。

有人知道使用 lxml 或 xpath 进行此搜索的更简单方法吗？

**例子**

```
<html>
<body class="first">
root
<!-- A span that does not have its own content, but does have several levels of children-->
<span>
  <a>
    <b>
      <h1 class="first">
        A block level that is the decendant of several non block levels
      </h1>
    </b>
  </a>
  <span class="first" id="tricky">
    A non-block level that has no block levels among its ancestors, but a block level element among its left cousins
  </span>
  <span>
    A non-block level that has no block levels among its ancestors, and content between itself and its nearest left-cousin block level
  </span>
</span>
<div class="first">
a block level
</div>
<div>
<span class="first">first content in a non block level in a block level</span>
<span>following content in a non block level in a block level</span>
</div>
<div>
  <i>  </i><bclass="first">a non block level that contains the first content within a block level, but follows an empty non-block level</b>
</div>
</body>
</html> 
```

在上面我已经为任何元素添加了一个“第一”类，当渲染时，它看起来会呈现一行的前导内容。特别感兴趣的是 id 为“tricky”的元素，因为该元素将呈现一行的第一个内容，即使它的祖先和兄弟姐妹都不是块级元素。“tricky” 将换行，因为它的兄弟姐妹之一（h1）的后代是块级别，并且在 h1 之后没有其他内容。

**跟进** 在这一点上，我已经用 Python 编写了一个函数，它执行一种向后遍历。它有点复杂，但它似乎工作：

```
block_level = {'blockquote','br','dd','div','dl','dt','h1','h2','h3','h4','h5','h6','hr','li','ol','p','pre','td','ul'}

# Returns true if the content of the provided element is the leading content of a line
# This function runs on HTML elements before any translation occurs
# Here 'content' refers to non-whiespace characters
def is_first_in_line_html(self, el):
    # This element contains no content, so it can't be the leading content of a line.
    if el.text is None or el.text.strip() == '': return False

    # This element has content and is a block level, so its content is the leading content of a line.
    if el.tag in block_level: return True

    # This element has content, is not a block level, and is the body element. Definitely leading content of a line.
    if el.tag == 'body': return True

    # Final case - is there content between the present element and the nearest block level element to the left of the present
    # element.    

    def traverse_children(element, bound_text):
        children = element.iterchildren(reversed=True)
        for child in children:
            if child.tail is not None: bound_text = child.tail + bound_text
            if bound_text.strip() != '': return False
            if child.tag in block_level: return bound_text.strip() == ''
            rst_children = traverse_children(child, bound_text)
            if rst_children is not None: return rst_children
            if child.text is not None: bound_text = child.text + bound_text
            if bound_text.strip() != '': return False
        return None

    def traverse_left_sibs_and_ancestors(element, bound_text):
        left_sibs = element.itersiblings(preceding=True)
        for sib in left_sibs:
            if sib.tail is not None: bound_text = sib.tail + bound_text
            if bound_text.strip() != '': return False
            if sib.tag in block_level: return bound_text.strip() == ''
            rst_children = traverse_children(sib, bound_text)
            if rst_children is not None: return rst_children
            if sib.text is not None: bound_text = sib.text + bound_text
            if bound_text.strip() != '': return False
        parent = element.getparent()
        if parent.tail is not None: bound_text = parent.tail + bound_text
        if parent.tag == 'body': return bound_text.strip() == ''
        if parent.tag in block_level: return bound_text.strip() == ''
        return traverse_left_sibs_and_ancestors(parent)

    return traverse_left_sibs_and_ancestors(el, '') 
```

# parsing - 在 Matlab 中将文件解析为结构数组

> ID：10587110
> 
> 赞同：0
> 
> 时间：2012-05-14T16:11:48.203
> 
> 标签：parsing, matlab, struct

我有一个包含以下信息的文件：

```
id   allele1 allele2
1    A A
2    T A
3    A A
.    ...
.    ...
.    ... 
```

我想将文件解析为一个包含三个字段的结构数组，`(id, allele1, allele2)`其中 id 是从 1 到 n 的所有数字，等位基因 1 是第一列字符，等位基因 2 是第二列。

但是，我很难弄清楚如何去做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T16:40:00.390

将来，最好展示您尝试过的内容。但是，这应该可以帮助您入门。

```
fid = fopen('input.txt','r');

%header line
line = fgetl(fid);
header = regexpi(line,'\W+','split');

ID=1;

%read first line
line = fgetl(fid);

while ischar(line)

   l = regexpi(line,'\W+','split');

   for i=1:numel(l)
       data(ID).(header{i}) = l(i);
   end
    ID = ID+1;
    line = fgetl(fid);
end
fclose(fid); 
```

导致：

```
>> data

data = 

1x4 struct array with fields:
    id
    allele1
    allele2

>> data(1)

ans = 

         id: {'1'}
    allele1: {'A'}
    allele2: {'A'}

>> data(2)

ans = 

         id: {'2'}
    allele1: {'T'}
    allele2: {'A'} 
```

# c++ - 嵌入式项目的小型资源存储数据库

> ID：10587113
> 
> 赞同：2
> 
> 时间：2012-05-14T16:11:57.717
> 
> 标签：c++, database, embedded, storage

我正在一个没有操作系统的非常特定的平台上工作。手头的任务需要将字符串和位图等资源存储在原始二进制数据中，与二进制代码分开，以便在运行时访问它。

我们有直接的存储块读写机制实现，但没有文件系统。该语言主要是 C++，没有模板和异常，这是平台编译器的限制，所以没有 stl 和 boost。

鉴于这些限制，我需要一种简单的数据库存储方法来将上述资源存储在磁盘上并使用某种密钥访问它们。我暂时推出了自己的产品，它使用简单的平面二进制存储，并且可以使用数字 id 进行寻址 - 用于获取资源原始字节偏移量的表索引。然而，这确实不方便使用，因为我必须手动跟踪资源 ID 并确保它们从 0 开始按顺序分配。

我在想也许已经有更好的库解决方案可以相对容易地修改以适应要求，并且可以在我开始推出散列函数之前与代码库集成，以便我可以使用短字符串作为键？存储在生成后是恒定的，并且仅用于读取。

编辑：我想我需要的是一个资源 dll 的替代品，它可以在没有运行时链接器和文件系统的情况下工作（或轻松工作）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T16:15:14.027

你考虑过使用 SQLite 吗？我发现它作为一个小型本地化数据库运行良好，它不需要“实例”或持续运行的进程，只需要一个文件。它很容易集成到 C++ 中。

[http://www.sqlite.org/](http://www.sqlite.org/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-15T12:49:32.160

鉴于您对自定义操作系统、特定数据和受限资源的限制。我认为您唯一的选择是自己滚动。

又快又脏：[http ://elliottback.com/wp/hashmap-implementation-in-c/](http://elliottback.com/wp/hashmap-implementation-in-c/)

后续编辑：在您的工具阶段使用相同的代码将 XML 或其他数据源转换为您的“哈希映射”。使用中发现的差异可以被记录、上传、收集并反馈到构建中。

这可能是一个“通用”问题，但它经常发生在嵌入式开发中。有一点是你想要的与你所拥有的相冲突，需要进行健全性检查。通常一个保守的“简单”解决方案是一个更好的开始，而且您似乎已经有了一个。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-17T13:44:02.067

之前曾多次解决过这个问题，我同意“自己动手”的答案。在不了解更多（您的平台、IDE、应用程序等）的情况下，我只能提供一个参考点。

我们的策略构建了包含屏幕布局、声音、位图和字体表的二进制*包。*每个包都包含一个标头，用于标识存储在包中的资源的数量和类型，以及指向每个资源开头的偏移量。（包元数据的结构受到带有 IFD 块等的 JPEG/TIFF 标头的粗略启发）。在一些实现中，我们从 NAND 闪存加载，因此我将 16 位 CRC 与每个资源相关联。其他实现添加了一个“压缩”标志来标识使用 zlib 压缩的资源。

From a workflow perspective: our IDE provided a python interpreter, which allowed me to implement scripts to automate construction of the resource package. This also allowed me to embed the resulting package directly into the hex file comprising the binary image.

# java - 原始和非原始类型 getter/setter 和初始化

> ID：10587116
> 
> 赞同：4
> 
> 时间：2012-05-14T16:12:10.837
> 
> 标签：java, primitive

Java 非原始（对象）数据类型是否以与原始数据类型相同的方式处理？我的意思是治疗...

1：他们应该在课堂上保持私密吗？

2：是否应该在声明期间将它们初始化为某个值？（例如`String S = ""`，代替`String S`）

3：他们也应该有getter和setter吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-14T16:15:21.243

所有三个问题的简单答案都是“是”。无论所讨论的变量是否属于原始类型，这三种做法都是合理的。

需要注意的一个问题是，如果您有一个对可变对象的引用，并且您的 getter 返回该引用，这可能会允许调用者修改该对象（您认为该对象是您的类私有的！）

这两种情况的另一个区别是对象引用可以设置为`null`. 这可能很有用，但也可能是错误的来源。在这里也许值得指出的是`String s = null`，`String s = ""`它们并不相同。

`obj1 == obj2`最后，对于对象，了解和之间的区别很重要`obj1.equals(obj2)`。原始类型不会出现这种区别，因为只有一种方法可以比较它们是否相等。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-14T16:15:31.910

to 1：当然，这就是信息隐藏的原理

to 2 ：它们中的许多已经在“幕后”初始化，但你最好自己做

to 3：当然，还有信息隐藏

最好的，弗洛

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-14T16:28:48.223

我不知道有任何规则说任何特定属性在类中应该是私有的，Java 提供了其他修饰符，例如 protected 和 public，并且没有暗示包可访问性的修饰符。这些都在那里，以便您可以根据您的设计实施您可能认为合适的不同级别的[封装。](http://en.wikipedia.org/wiki/Encapsulation_%28object-oriented_programming%29)

关于问题的字段初始化部分，我认为当在类中声明字段时，如果该字段是任何引用类型[，则默认初始化为 null](http://docs.oracle.com/javase/specs/jls/se7/html/jls-4.html#jls-4.12.5)，因此除非您认为有必要，否则您不需要初始化它或者除非该字段被声明为 final，这意味着您要将其初始化为默认值。

关于问题的 getter 和 setter 部分，我相信这些只是强制封装的一种方式。Allan Snyder 在他的论文[Encapsulation and Inheritance in Object-Oriented Programming Languages 中](http://dl.acm.org/citation.cfm?id=28702)写道：

> 为了最大限度地发挥封装的优势，应该尽量减少在外部接口中暴露实现细节 [...] 例如，面向对象语言的一个特点是它是否允许设计者定义一个类，以便可以重命名其实例变量在不影响客户的情况下。

此外，Leonid Mikhajlov 和 Emil Sekerinski 的一篇名为[A Study of the Fragile Base Class Problem 的](https://docs.google.com/viewer?a=v&q=cache%3aUWJVnudAmTIJ%3aciteseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.18.8708&rep=rep1&type=pdf%20&hl=en&pid=bl&srcid=ADGEESjCJIrGLIypZ_EHeJWvLC3FH-RJT5eFBAW3knl76aQrxYuluedltRXRtJtjjudtZ50UmOI52ustkw64y3HqBGzod9kEiYahoKryWaM3P8952EIxR67dBxzFXEsRT6YlT8sjxmqc&sig=AHIEtbSw6-UE4AB6VJHl6LrK46QXvD6uaw&pli=1)文章可能会展示一些很好的想法，说明为什么所有这些级别的封装和间接都适合避免与继承相关的一些经典问题。

> “不直接访问基类状态”要求：扩展类不应该直接访问其基类的状态，而只能通过调用基类方法。

他们的论文展示了非常有说服力的理由，说明为什么像 getter 和 setter 方法这样的方法可以成为避免类扩展脆弱性的好主意。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-14T16:15:37.067

所有问题的答案都是“是”。您在这里描述了数据封装的共同原则和与类型无关的 bean 命名约定。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-05-14T16:16:12.727

> 1：他们是否应该在课堂上保持私密。

是的。正是出于您应该将原始类型变量声明为私有的原因。

> 2：是否应该在声明期间初始化一些值（例如：String S = "" 而不是 String S）

那要看。如果未初始化状态 ( `null`) 具有特定于应用程序的含义，则默认情况下不应初始化。否则，如果可能，最好初始化为非空默认值。

> 3：也应该有getter和setter。

是的。正是出于您应该在原始类型案例中声明 getter 的原因。您还应该声明 setter，但前提是您*希望*变量是可设置的。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-05-14T16:16:28.533

明确地，对象类型变量应该是私有的、已初始化的并具有适当的 getter 和 setter。这允许 OOP 保证我们的代码安全但仍然可以访问。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-05-14T16:17:12.190

1：他们是否应该在课堂上保持私密。 **YES** 2：是否应该在声明期间初始化一些值（例如：String S = "" 而不是 String S） **YES** 3：也应该有 getter 和 setter。 **是的**

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-05-14T16:38:08.500

关于1.和3.一般原则是数据封装，它与数据的类型（原始或非原始）没有真正的关系。

Regarding initialisation: class reference variables are by default initialised to `null`. Other than that, they should simply be initialised to whatever value suits the design of you class.

# asp.net-mvc - 如何在 ASP.Net MVC 4 中停止 JSON 结果中的 xss

> ID：10587120
> 
> 赞同：2
> 
> 时间：2012-05-14T16:12:32.680
> 
> 标签：asp.net-mvc, json, xss, asp.net-mvc-4

我们的控制器上有一个动作，它返回一个带有 id 和名称的 json 结果。然后我们拿它做这个..

```
 var markup = '';
    for(var i = 0; i < data.length; i++) {
        markup += '<option value="' + data[i].id + '">' + data[i].agentName + '</option>';
    }

    $("#agentId").html(markup); 
```

这`+ data[i].agentName +`使我们面临 xss 攻击，因此我试图找出处理这种情况的最佳方法。

到目前为止，我的“最佳”选项似乎是看看我是否可以在服务器端使用 AntiXss 库并在返回之前对 agentName 进行编码。我说“最好”是因为（截至 2012 年 5 月 14 日）AntiXss 库受到了很多仇恨，所以我不喜欢使用它的想法。

还有其他选择吗？

## 更新

```
<select id="agentId"></select> 
```

是我如何构建我将要添加到的选择元素..

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T16:14:04.077

您应该使用 jQuery 构建 DOM 元素并调用`text()`：

```
$("#agentId").empty().append($.map(data, function(obj) {
    return $('<option />').val(obj.id).text(obj.agentName)[0];
})); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T16:22:15.060

您是否尝试过敲除.js？

It's got a great built in binder that populates your select elements with json data.

[http://knockoutjs.com/documentation/options-binding.html](http://knockoutjs.com/documentation/options-binding.html)

# jquery - jQuery UI 滑块：不需要预选

> ID：10587122
> 
> 赞同：2
> 
> 时间：2012-05-14T16:12:41.543
> 
> 标签：jquery, jquery-ui, jquery-ui-slider

在实现 jQuery UI Slider (http://jqueryui.com/demos/slider/) 时，总是有一个预选（默认值 0）。

我们如何删除预选？滑块（按钮）仅在用户单击视觉模拟刻度上的某个位置时才会出现。

非常感谢帮助！

最好的，莱昂内尔

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T16:20:08.853

你的意思是像这个**[jsFiddle 例子](http://jsfiddle.net/j08691/Vd5YY/)**？

jQuery：

```
$("#slider").slider({
    change: function(event, ui) {
        $('a.ui-slider-handle').show();
    }
});
$('a.ui-slider-handle').hide();​ 
```

# javascript - 如何将选择下拉选项的值与 div 类进行比较以切换它以提高可见性？

> ID：10587125
> 
> 赞同：0
> 
> 时间：2012-05-14T16:13:05.503
> 
> 标签：javascript, jquery, css, function, toggle

我有一个下拉列表说国家列表，在它下面我有一个 div 类，比如 map-uk、map-fr、map-es。现在在下拉列表的变化上，我想查看选择了哪个国家并基于该显示特定的地图，该地图位于一个 div 中，其类等于下拉列表的值。

我正在尝试以下内容：

```
 $(function() {
    $("select").onchange(function() {
    if($(this).val() == //I need to compare the class of div that has map)
    {
   //show that map
//hide others
    }
    })
    }) 
```

有没有更好的选择来做到这一点。我不想这样做

```
$(function() {
    $("select").onchange(function() {
    if($(this).val() == "uk")
    {
    $(.map_uk).show();
    $(.map_fr,.map_es).hide()
    }

if($(this).val() == "fr")
    {
    $(.map_fr).show();
    $(.map_uk,.map_es).hide()
    }
blah blah blah
    })
    }) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T16:24:54.230

为您的元素创建通用类和特定类，例如`class="map map_uk"`or `class="map map_es"`。所以，你可以这样做

```
$(function() {
    $("select").change(function() {
       $('.map').hide();
       $('.map_'+$(this).val()).show();        
    });
    $("select").change();
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T16:16:17.243

这个怎么样：

```
// #mapsHolder - div that contains all .map_* divs
$("select").onchange(function() {
    // hide all maps
    $('#mapsHolder > div').hide();
    // find a map with class ('.map_' + current value) which will turn into 'map_uk' etc
    $('#mapsHolder .map_' + $(this).val()).show();
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T16:16:59.710

只要值和类匹配，您就可以执行类似的操作

```
$('.map_' + $(this).val()) 
```

选择相应的元素。

# objective-c - 仅设备上的 UINavigationBar 外观错误

> ID：10587136
> 
> 赞同：0
> 
> 时间：2012-05-14T16:14:05.467
> 
> 标签：objective-c, ios, uinavigationbar

我有一个 UINavigationBar 类的子类。在 viewDidLoad 我有：

```
- (void)viewDidLoad
{
    [super viewDidLoad];

    UINavigationBar *bar = [[UINavigationBar alloc] init];

    NSString* path = [[NSBundle mainBundle] pathForResource:@"topbanner" ofType:@"png" inDirectory:@"assets"];

    NSData *data = [NSData dataWithContentsOfFile:path];

    UIImage *image = [UIImage imageWithData:data];

    [[UINavigationBar appearance] setBackgroundImage:image forBarMetrics:UIBarMetricsDefault]; //crash here!

    [self.view addSubview:bar];
} 
```

我从我的 tableView 中调用它。当我在模拟器上运行时一切都很好，当我尝试在设备应用程序崩溃时运行。我有一个错误：

```
+[UINavigationBar appearance]: unrecognized selector sent to class 0x3e3fe490
*** Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: '+[UINavigationBar appearance]: unrecognized selector sent to class 0x3e3fe490' 
```

为什么？

编辑：我在 Xcode 的**蓝色**目录文件夹中有我的 topbanner 文件。在模拟器中一切看起来都很好。

EDIT2：当然，当我在我的设备中删除这行代码时，我的应用看起来不错，但导航栏（oc）上没有图像。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T16:18:38.353

该`appearance`方法是 iOS 5.0 的新方法。您可能正在使用带有 iOS 5.0 的模拟器，但您的设备可能使用较低的 iOS 版本。

最好在调用 respondsToSelector 之前使用此方法修改外观。

从 UINavigationBar 文档：

> 在 iOS v5.0 之前，当与导航控制器一起使用时，您只能对导航栏进行少量直接自定义。具体来说，可以修改 barStyle、tintColor 和 translucent 属性，但绝对不能直接更改 UIView 级别的属性，例如 frame、bounds、alpha 或 hidden 属性。此外，您应该让导航控制器管理导航项的堆栈，而不是尝试自己修改这些项。

[http://developer.apple.com/library/ios/#documentation/uikit/reference/UINavigationBar_Class/Reference/UINavigationBar.html](http://developer.apple.com/library/ios/#documentation/uikit/reference/UINavigationBar_Class/Reference/UINavigationBar.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T16:21:44.847

你有没有尝试过：

```
[self.navigationController.navigationBar setBackgroundImage:YOURIMAGE forBarMetrics:UIBarMetricsDefault]; 
```

# django - 如何让美味派接受 JSONField？

> ID：10587138
> 
> 赞同：1
> 
> 时间：2012-05-14T16:14:07.137
> 
> 标签：django, json, field, tastypie, bad-request

我收到“错误请求：'' 不是有效的 JSON 字符串。” 当我尝试将数据发布到我的美味派 API 时。API 由一个 ModelResource 组成，它基于一个具有[JSONField](http://pypi.python.org/pypi/django-jsonfield)的模型。JSONfield 继承自标准 TextField django 字段。

如果将 JSONField 更改为 TextField，则接收到数据并且一切正常。

我的代码与此类似：

模型.py

```
class MyModel(models.Model):
   data = jsonfield.JSONField() # If i change this to a TextField everything works
   ... 
```

api.py

```
class MyModel(ModelResource):
    #Resource for MyModel()
    ...
    class Meta:
        queryset = MyModel.objects.all()
        authentication = Authentication()
        authorization = Authorization()
        list_allowed_methods = ['get', 'post'] 
```

受此启发[，](https://github.com/newsapps/django-boundaryservice/blob/master/boundaryservice/tastyhacks.py)我尝试覆盖默认的 ModelResource，但我无法让它工作。

总而言之，我如何让tastepie接受JSONField？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-16T20:56:07.700

所以我终于弄清楚了问题所在。

当 django 收到请求时，它会创建一个初始的空 MyModel 对象。由于我的模型 JSONField 没有默认值，它使用超类的默认值，即空字符串“”。当 JSONField 启动空字符串“”时，它会引发一个异常，指出“'' 不是有效的 JSON 字符串。”。这进一步触发了 400 BAD REQUEST 响应。

我认为这是 JSONField 包中的一个错误，它应该有*None*作为默认值。

但是，解决此问题的一个简单方法是像这样更改模型：

```
class MyModel(models.Model):
   data = jsonfield.JSONField(default=None)
   ... 
```

# c# - Gridview 在 asp.net 中不更新

> ID：10587139
> 
> 赞同：-2
> 
> 时间：2012-05-14T16:14:18.977
> 
> 标签：c#, asp.net, gridview

当我从中删除一行时`GridView`，它不会更新。我也看过这里

[删除命令后Gridview不更新](https://stackoverflow.com/questions/6662609/gridview-doesnt-update-after-the-delete-command)

没有任何解决方案。

这是我的一些代码

```
private void SepettenOgeSil(int p)
{
    SqlDataSource4.DeleteCommand = "Delete from ilker_sevim_sepets where seperID="+ p;
    if (SqlDataSource4.Delete() > 0)
    {
        siparisleriGetir();
        SqlDataSource4.DataBind();
        // Button1_Click(null, null);

        urunFiyatHesapla();
    }
    else
    { 
    }
}

private void urunFiyatHesapla()
{
    int tmpToplamUrunFiyati =0, tmpUAdeti;
    int tmpTekUrunFiyati;
    TextBox t;
    int sayici=0;
    foreach ( GridViewRow item in GridView1.Rows)
    {
        t= (TextBox)item.FindControl("TextBox2");
        tmpUAdeti = Convert.ToInt32(t.Text);
        tmpTekUrunFiyati =Convert.ToInt32(item.Cells[3].Text);
        tmpToplamUrunFiyati += tmpTekUrunFiyati * tmpUAdeti;
    }

    Label2.Text = tmpToplamUrunFiyati.ToString();
} 
```

`urunFiyatHesapla();`当我在按钮单击事件中调用方法时，它可以工作。当我将它绑定到 a 时，`GridView`我得到一个错误。

我的错误在哪里？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-17T05:13:49.443

你需要像这样绑定你的gridview GridView1.DataBind();

# facebook - FB评论永远不会停止加载

> ID：10587142
> 
> 赞同：0
> 
> 时间：2012-05-14T16:14:27.593
> 
> 标签：facebook, facebook-comments, xfbml

[这是来自facebook 评论](https://developers.facebook.com/docs/reference/plugins/comments/)的 fb 评论代码片段 问题是它显示了评论，但从未完成加载。

我使用 java/spring/jsp（没有检票口）。

我试过：[http](http://example.com) ://example.com & my_external_website_url & some_internal_url 都有同样的问题。我相信它必须是基本的东西。但是有没有其他人遇到过这个问题？

```
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:og="http://opengraphprotocol.org/schema/" xmlns:fb="http://www.facebook.com/2008/fbml">
<body>
    <div id="fb-root"></div>
    <script>(function(d, s, id) {
    var js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) return;
    js = d.createElement(s); js.id = id;
    js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&appId=<myappid>";
    fjs.parentNode.insertBefore(js, fjs);
    }(document, 'script', 'facebook-jssdk'));</script>

  <div class="fb-comments" data-href="<my_url>" data-num-posts="2" data-width="470"></div>
 </body>
</html> 
```

我还尝试了 XFBML 版本，结果相同。任何指针都会有所帮助。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T18:08:36.047

该问题似乎仅在尝试从 localhost 服务器上运行的 web 应用程序访问评论插件时发生。我的本地 url 有一个端口号 8080。（如 myhostfiledlocalurl:8080/..）。

我将 webapp 移至 QA（仍在 Intranet 环境中）并且“永远加载”问题消失了。QA url 使用默认端口 80。但我收到一条警告消息，说 qa url 无法访问（这是预期的，因为它对公众不可见）。

然后我将 webapp 移到了一个面向公众的网站，一切都开始按预期工作。

**更新：** 我将本地更改为在端口 80 上运行。永远加载问题不再发生。

# asp.net - 将数据发布到 WCF 服务的最佳方式

> ID：10587146
> 
> 赞同：2
> 
> 时间：2012-05-14T16:14:38.370
> 
> 标签：asp.net, winforms, wcf, wcf-security

我有一个需要定期将数据发布到 WCF 服务的 Windows 窗体应用程序（多个安装、各种客户端）。我计划在 GoDaddy 托管网站上托管 WCF 服务。

我的问题是发布这些数据的最安全方式是什么？我主要关心的是确保数据不被篡改。

TIA。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T18:19:16.283

您可以使用 WCF 安全性，主要是传输和消息安全性。如果与旧 ASMX 客户端的互操作性和*极好*的性能不是您的主要优先事项，而是安全性，那么您应该选择消息安全性，因为它在安全性方面是两种方案中更健壮的。传输安全将在 Intranet 上运行良好，但在 Internet 上它不会考虑许多跃点。消息安全将使用用户凭据对每条消息进行加密和签名，而传输安全保护您的端点，但您的消息在通过 Internet 路由*时*仍然可能被篡改。一般来说，消息安全是互联网上的建议方法。说了这么多，您的服务可以同时使用*两者*在一起，我认为这意味着两全其美。

我认为就安全性而言，最好的选择是使用消息安全性和商业 SSL 证书（例如 GoDaddy、Equifax 等出售的证书），使用 SSL 证书保护您的 WCF 企业相对容易，网上有很多东西怎么做。[此外，您可以通过将 MSMQ 加入到组合](http://www.codeproject.com/Articles/326909/Creating-a-WCF-Service-with-MSMQ-Communication-and)中来使您的服务几乎防弹可靠，并确保保证交付。

[这](http://msdn.microsoft.com/en-us/library/ff648863.aspx#TransportSecurity)对你也很有帮助。

# c# - MVC3 - 在同一个视图上多次使用模板

> ID：10587147
> 
> 赞同：2
> 
> 时间：2012-05-14T16:14:40.887
> 
> 标签：c#, jquery, asp.net-mvc

我有模型的显示和编辑器模板。编辑器模板使用 jquery 手风琴，显示模板使用选项卡。问题是必须为 jquery 工作分配的 ID。

```
<%@ Control Language="C#" Inherits="System.Web.Mvc.ViewUserControl<SpletniObrazec.Models.Obrazec>" %>
<div id='Editor'>
  <h3><a href="#"></a>Part 1</h3>
  <div id='Editor-1'></div>
  <h3><a href="#"></a>Part 2</h3>
  <div id='Editor-2'></div>
  <h3><a href="#"></a>Part 3</h3>
  <div id='Editor-3'></div>
</div>

<script type="text/javascript">
$(document).ready(function () {
    $('#Editor').accordion();
});
</script> 
```

这会将手风琴放到`< div> 元素编辑器中。现在，如果我在同一个视图上多次使用此模板，它们都将具有相同的编辑器 ID。

我需要在同一视图上执行此操作：

```
Html.EditorForModel();
Html.EditorForModel(); 
```

但由于模板具有硬编码的 ID“Editor”，因此第二个 EditorForModel 不适用于手风琴。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T19:51:34.860

您不必`<div>`在手风琴内部的每个上都添加 id，因此您可以完全删除它们。对于外部`<div>`，使用一个类代替在选择器中启用手风琴。

```
<div class="accordion">
  <h3><a href="#"></a>Part 1</h3>
  <div></div>
  <h3><a href="#"></a>Part 2</h3>
  <div></div>
  <h3><a href="#"></a>Part 3</h3>
  <div></div>
</div>

<script type="text/javascript">
$(document).ready(function () {
    $('.accordion').accordion();
});
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T17:06:55.513

我不确定，但您可以尝试为您创建的每个对象放置 id。类似下一个`Html.EditorForModel(new{id=SomeId});`。我看到你有答案，但请检查它并让我知道它是否有效。

# eclipse - 用于变量和方法名称的 Eclipse 拼写检查器

> ID：10587149
> 
> 赞同：1
> 
> 时间：2012-05-14T16:14:42.940
> 
> 标签：eclipse

是否有用于变量和方法名称的 Eclipse 拼写检查插件？我知道内置的拼写检查器仅限于文字和注释。

# sencha-touch-2 - 如何在带有详细信息卡的列表中添加搜索？（煎茶触摸 2）

> ID：10587152
> 
> 赞同：1
> 
> 时间：2012-05-14T16:15:04.067
> 
> 标签：sencha-touch-2

我是 Sencha 的新手，我做了我的第一个应用程序。我需要将搜索放在列表中。我浏览了从 Sencha 下载的示例搜索，但不知道如何将其插入搜索列表。很高兴得到任何提示。 [这是我的应用](http://www.senchafiddle.com/#4hKD8#uZlr7)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T22:00:05.523

起初，我很难让搜索字段在 MVC 风格的应用程序中工作。

我能够像这样在您的 sencha fiddle 应用程序中创建搜索字段。

在你的控制器中我做了

```
Ext.define('Sencha.controller.Main', {
    extend: 'Ext.app.Controller',

    config: {
        refs: {
            main: 'mainpanel'
        },
        control: {
            '#list': {
                disclose: 'showDetail'
            },
            '#view':{
                activate:function(){
                    Ext.getCmp('list').add({
                        xtype:'toolbar',
                        docked:'top',
                        items:[{
                            xtype: 'searchfield',
                            itemId:'contact_search',
                            placeHolder: 'Search....',
                            listeners: {
                                scope: this,
                                clearicontap: this.onSearchClearIconTap,
                                keyup: this.onSearchKeyUp}
                        }]
                    })
                        }
            }
        }
    },

    showDetail: function(list, record) {
        this.getMain().push({
            xtype: 'recipedetail',
            title: record.fullName(),
            data: record.data
        })
            },  onSearchKeyUp: function(field) {
                //get the store and the value of the field
                var value = field.getValue(),
                    store = Ext.getCmp('list').getStore();

                //first clear any current filters on thes tore
                store.clearFilter();

                //check if a value is set first, as if it isnt we dont have to do anything
                if (value) {
                    //the user could have entered spaces, so we must split them so we can loop through them all
                    var searches = value.split(' '),
                        regexps = [],
                        i;

                    //loop them all
                    for (i = 0; i < searches.length; i++) {
                        //if it is nothing, continue
                        if (!searches[i]) continue;

                        //if found, create a new regular expression which is case insenstive
                        regexps.push(new RegExp(searches[i], 'i'));
                    }

                    //now filter the store by passing a method
                    //the passed method will be called for each record in the store
                    store.filter(function(record) {
                        var matched = [];

                        //loop through each of the regular expressions
                        for (i = 0; i < regexps.length; i++) {
                            var search = regexps[i],
                                didMatch = record.get('title').match(search);

                            //if it matched the first or last name, push it into the matches array
                            matched.push(didMatch);
                        }

                        //if nothing was found, return false (dont so in the store)
                        if (regexps.length > 1 && matched.indexOf(false) != -1) {
                            return false;
                        } else {
                            //else true true (show in the store)
                            return matched[0];
                        }
                    });
                }
            },

    /**
* Called when the user taps on the clear icon in the search field.
* It simply removes the filter form the store
*/
    onSearchClearIconTap: function() {
        //call the clearFilter method on the store instance
        this.getStore().clearFilter();
    }

}); 
```

然后在 app.js 中，我向视口添加了一个 ID

```
launch: function() {
        Ext.Viewport.add({
            id:'view',
            xtype: 'mainpanel'
        });
    } 
```

我还在 RecieptList.js 中添加了一个 ID

```
 xtype: 'recipelist',
    requires: ['Sencha.store.Recipes'],
    id:'list',
    config: { 
```

可能不是最传统的解决方案，但它确实有效。很容易看出这一切是如何协同工作的，希望对您有所帮助。

# php - 在 PHP 中使用 Dribbble API

> ID：10587154
> 
> 赞同：1
> 
> 时间：2012-05-14T16:15:14.983
> 
> 标签：php, api

我想使用 Dribbble API 将我的 dribbble 镜头介绍给我的投资组合网站。我不是 PHP 人，这就是为什么我不知道如何使用 API (http://dribbble.com/api)。

如何在我的 HTML 或 PHP 页面中获取截图？

问候并请原谅我的无能。

干杯!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T03:03:41.200

您可以考虑使用一些 jquery 插件来帮助您将镜头导入您的网站，这是一个示例（[http://gbin1.com/gb/demoviewer/360/06242ba0-40a1-45fd-946f-cc89e0df64c9/index.html .htm](http://gbin1.com/gb/demoviewer/360/06242ba0-40a1-45fd-946f-cc89e0df64c9/index.html.htm) )，它使用了名为 Jribbble v1.0.0 的 jQUery 插件，希望有所帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-06T22:51:24.047

使用此 JS 并将用户信息更改为您的姓名

```
// variables used

var slgoetzShots;
var slgoetzNum = 1;
var active = "Slgoetz";

// slgoetz shots
function slgoetzGet(pageNum){
var url = "http://api.dribbble.com/slgoetz/shots";
$.get(
    url, {page:pageNum, per_page:"30"},
    function(data){
        slgoetzShots = data;
        slgoetzNum += 1;
        render(slgoetzShots);
    },
    "jsonp"
);
};

// slgoetzGet: render
function getSimon(){
if (active != "slgoetz"){
    slgoetzGet("1");
    $('#'+active).removeClass("active");
    $('#Everyone').addClass("active");
    active = "Simon Goetz";
    slgoetzNum = 1;
};
};

//popular shots is default
getSimon("1")

var inner = ""; 
var innerP1 = '<li><div class="dribbble"><div class="shot"><a href="';
var innerP2 = '"><img src="';
var innerP3 = '"></a></div><div class="likes">'  
var innerP4 = ' Likes</div><div class="comments">'
var innerP5 = ' Comments</div><div class="name">'
var innerp6 = '</div></div></li>'

function render(filter){
for (var i = 0; i<filter.shots.length;i++){
    inner = inner + innerP1 + filter.shots[i].url + innerP2 +         filter.shots[i].image_url + innerP3 + filter.shots[i].likes_count + innerP4 +        filter.shots[i].comments_count + innerP5 + filter.shots[i].title + innerp6;

};

$('.gallery').html(inner);
inner = "";
};

function loadMore(){
switch(active){

    case "Simon Goetz":
        inner = $('.gallery').html();
        slgoetzGet(slgoetzNum.toString());
        break;
};
 }; 
```

HTML 将 .gallery 类添加到 div

# c# - GZip 页脚中的流大小与实际流大小不匹配

> ID：10587156
> 
> 赞同：0
> 
> 时间：2012-05-14T16:15:23.490
> 
> 标签：c#, gzip, gzipstream

从 GzipStream 解压缩时，出现 IO 异常“GZip 页脚中的流大小与实际流大小不匹配”。这个错误在多个文件上 100% 发生，所以我不相信这是一个“真正的”损坏文件问题。

压缩代码如下：

```
 using (var fileStream = fileInfo.OpenRead())
            {
                using (var outFile = File.Create(Path.Combine(backupLocation, backupFileName.ToString())))
                {
                    using (var gzCompressionStream = new GZipStream(outFile, CompressionMode.Compress))
                    {
                        fileStream.CopyTo(gzCompressionStream);
                    }
                }
            } 
```

抛出异常的解压代码如下：

```
using (var fileStream = fileInfo.OpenRead())
            {
                // remove the extension
                var fileName = fileInfo.Name;
                var originalName = fileName.Remove(fileName.Length - fileInfo.Extension.Length);

                using (var outFile = File.Create(Path.Combine(transferLocation, originalName)))
                {
                    using (var gzDecompressionStream = new GZipStream(fileStream,CompressionMode.Decompress))
                    {
                        gzDecompressionStream.CopyTo(outFile);
                    }
                }
            } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T21:39:56.953

所有，感谢您的帮助 - 看起来我已经找到了问题。当压缩文件大小大于 4GB 时，我只会收到一个错误，在此之下一切正常，这应该不是问题，因为[MSDN](http://msdn.microsoft.com/en-us/library/system.io.compression.gzipstream.aspx)指出 GZipStream 适用于 .Net 4 最大 8GB 的​​文件（我'm using) 并且最大文件大小将始终低于 6GB（应用程序限制）。然而，以前版本的[GZipStream](http://msdn.microsoft.com/en-us/library/system.io.compression.gzipstream%28v=vs.90%29.aspx)仅支持高达 4GB - 在这种情况下，看起来 MSDN 文档不正确。

# c# - HTMLBody 拒绝输出我指定的字体大小，总是以不同的大小结束

> ID：10587159
> 
> 赞同：11
> 
> 时间：2012-05-14T16:15:33.597
> 
> 标签：c#, css, outlook, office-interop, font-size

我正在尝试让我的 C# 应用程序生成表单电子邮件。我本应该在周五一个小时内完成这件事……但 Outlook 非常不听话。

似乎无论我在 MailItem 的 HTMLBody 中指定字体大小的方式如何，它的大小都*略有*不同。Font face 总是按指定出现，但大小永远不会正确。

```
email.HTMLBody = "<p style='font-size:11px;font-family:Calibri;'>girl look at that body</p>";
email.HTMLBody = "<style> body { font-family:'Calibri'; font-size:11px; } </style> <body>girl look at that body</body>";
email.HTMLBody = "<html><header><style> body { font-family:'Calibri'; font-size:11px; } </style></header> <body>girl look at that body</body></html>";
email.HTMLBody = "<span style='font-size:11px;font-family:calibri;'>girl look at that body</span>"; 
```

生成大小为 8.5 的字体。

```
email.HTMLBody = "<html><body><font face='Calibri' size='11px'>girl look at that body</font></body></html>";
email.HTMLBody = "<font face='Calibri' size='11px'>girl look at that body</font>"; 
```

生成 12 号字体。

因此，似乎通过 CSS 指定 11px（或 11pt，也尝试过）字体让我得到 8.5px，而通过字体标签让我得到 12px。

我对此做了一些进一步的尝试，基本上，字体标签无论如何都会产生 12pt 字体。所以这是一个死胡同，但我知道字体标签无论如何都被弃用了。CSS 标签会给我不同的尺寸，但很少是我要求的。它总是关闭，而不是一致的数量。

代码中的字体大小 = 电子邮件中的字体大小：

*   12 = 9
*   13 = 10
*   14 = 10.5
*   15 = 11.5
*   16 = 12
*   17 = 13
*   18 = 13.5
*   19 = 14.5
*   20 = 15

在 CSS 中指定 14.5px 给了我我想要的 11px ......但我觉得部署依赖于它的东西感觉不舒服。

这里有什么问题？有什么我忽略在 CSS 中指定的吗？我需要在 MailItem 或 Outlook.Application 的其他地方进行调整？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-22T13:10:03.450

这是因为您使用了 11px 而不是 pt。“px”代表像素，文本的 1 个像素大小并不意味着字体大小为 1 个点。使用 11pt 而不是 11px。

根据此处的讨论：[https ://graphicdesign.stackexchange.com/questions/199/point-vs-pixel-what-is-the-difference](https://graphicdesign.stackexchange.com/questions/199/point-vs-pixel-what-is-the-difference)

> 像素是单个方形“图片元素”（因此是像素），即图像中的单个点。10x10 的图像由 10 宽 x 10 深的网格中的一组像素组成，总共 100 个像素。
> 
> 另一方面，“点”（pt）是长度单位，通常用于测量字体的高度，但在技术上可以测量任何长度。在应用中，1pt 正好等于 1/72 英寸；在传统印刷中，从技术上讲，72pt 是 0.996264 英寸，尽管我认为你会因为四舍五入而被原谅！
> 
> 多少像素 = 1pt 取决于图像的分辨率。如果您的图像是 72ppi（每英寸像素），那么一个点将正好等于一个像素。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2020-05-05T19:37:17.397

这很旧，但我遇到了与 OP 完全相同的问题，并找到了一个对我有用的解决方案。如下所示格式化 HTML：

```
.HTMLBody = "<style> body{font-family:Calibri;font-size:11pt;}" & "<HTML><body>Your text goes here" 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-23T09:01:10.887

在编写使用 Excel 数据制作 Outlook 电子邮件的 VBA 宏时，我遇到了同样的问题。有趣的是，无论我做什么，使用 pt 或 px，都无关紧要：无论我使用哪个值，输出总是跳过字体大小 11。使用 11pt 给了我 8.5 字体大小。使用 12pt 给了我 9。使用 14 给了我 12...

无论如何，当我**添加一个小数**时，它突然起作用了。**所以试试这个： 11.0pt**。希望能帮助到你。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-14T16:45:14.200

在我看来，电子邮件中的某些设置被设置为从您指定的字体缩小。这可能因不同的用户设置而异。你说它“不是一致的数量”，但我不同意。根据您的数字，所有偶数值都以`.75`您声明的数量出现，而所有奇数值约为`.76xxxx`. 因此，就像邮件设置为将您给定的字体大小乘以大致相当于`.75em`.

是的，您可以通过将目标值乘以粗略来补偿`1.33`，但您只是为自己这样做吗？换句话说，正如我最初所说，这可能是用户特定的设置（默认情况下可能`.75`在 Outlook 中，我不知道），在这种情况下，您不能保证所有用户的字体大小。

也许以单位调整字体大小`em`可能在这里起作用。如果您给出一个`1.33em`，这可能会让您与您的目标大小保持最一致，并且还会响应用户设置。

在查看自己的 Outlook 版本时，我无法确定专门用于缩放字体的设置。可以设置默认字体大小，并且可能会根据默认大小到请求大小的某些公式进行缩放。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2016-06-13T08:52:45.797

尝试这个：`<span style="font-size:11pt">`

我希望它有所帮助。

# php - 带有 Smarty 模板和自定义修饰符的 PHP 脚本无声地死掉

> ID：10587161
> 
> 赞同：0
> 
> 时间：2012-05-14T16:15:39.657
> 
> 标签：php, timeout, smarty, modifier

我编写了一个 Smarty 修饰符，它使用 PHP 简单 HTML DOM 解析器类 (http://simplehtmldom.sourceforge.net/) 来清理和转换存储在 Oracle DB 表中的一些 HTML。PHP 脚本查询数据库，获取数组中的结果，将数组分配给 Smarty 变量，然后模板迭代数组中的结果，将修饰符应用于每个结果。

当数组中的元素数量很大（大约 3000 个）时，整个脚本会**在大约 2 分钟后**静默死去，没有任何错误、警告或任何记录（检查 PHP 和 Apache 日志）。事实上，它似乎在处理和输出响应时就死了，而且每次都死在稍微不同的点上。

我已将所有 PHP 和 Apache 配置参数设置为非常高的限制，例如`max_execution_time = 600`,`memory_limit = 512M`等。

我怀疑这可能与浏览器超时有关（使用 Firefox 12 和 IE 8，无法在我们的工作环境中使用其他浏览器进行测试），但我找不到有关如何更改此设置的任何信息。我尝试在 Firefox 中将属性设置`network.http.keep-alive.timeout`为 300（它是 115，可疑地接近 2 分钟），但它没有帮助。

有任何想法吗？

# php - Ajax 报告 IE 为“1”

> ID：10587166
> 
> 赞同：3
> 
> 时间：2012-05-14T16:15:57.937
> 
> 标签：php, javascript, ajax, internet-explorer

我正在尝试为拒绝将 IE 以外的任何内容下载到他们的机器上的父母创建一个功能页面。无论如何，它是一个列表，我只想要一些由数据库备份的 AJAX 可切换按钮。

我不确定发生了什么，但以下内容在 Firefox 和 chrome 中都被调用并接收良好。无论我在 IE（任何版本）中做什么，我都无法让它工作。onreadystatechange 函数总是接收并报告“1”而不是“off”或“on”。这最初让我感到震惊，因为我只是想发送 1 和 0。

无论如何，IE 实际上并没有提交任何值，所以我想尝试访问 PHP 页面并接收响应是有问题的。很抱歉成为 n00b，但这是什么原因造成的？

不幸的是，该网页包含一些我不希望人们看到的敏感信息，因此感应代码如下：

脚本功能：

```
function toggleResponded(i) {
    var respondedHttp;  
    if (window.XMLHttpRequest) {// code for IE7+, Firefox, Chrome, Opera, Safari
        respondedHttp=new XMLHttpRequest();
    }   else    {// code for IE6, IE5
        respondedHttp=new ActiveXObject("Microsoft.XMLHTTP");
    }

    alert("toggling responded for element: " + i);

    respondedHttp.onreadystatechange = function() {         
        if(respondedHttp.readyState==4 && respondedHttp.status==200) {
            var state = respondedHttp.responseText;
            alert("Recieved: " + state);
            if(state == "off") {
                document.getElementById("respond"+i).className = "inLineOff";
                document.getElementById("respond"+i).innerHTML = "No Response Yet";
                document.getElementById("attend"+i).style.display="none";
                document.getElementById("quantityCell"+i).style.display="none";
            } else if(state == "on") {
                document.getElementById("respond"+i).className = "inLineOn";
                document.getElementById("respond"+i).innerHTML = "Responded";
                document.getElementById("attend"+i).style.display="inline";
                if(document.getElementById("attend"+i).innerHTML == "Attending") {
                    document.getElementById("quantityCell"+i).style.display="table-cell";
                }
            } else {
                alert("error: " + state);
            }
        }
    }

    var name = peeps.people[i];

    alert("toggling for: " + name); 
    alert("toggling as: " + encodeURIComponent(name));

    var ops = "./quer.php?";    
    ops += "op=toggleResponded";
    ops += "&name=" + encodeURIComponent(name);

    alert("going to: " + ops);

    respondedHttp.open("GET", ops, true);
    respondedHttp.send();
} 
```

PHP：

```
if(isset($_GET["op"])) {
    switch($_GET["op"]) {
        case "toggleResponded":
            $name = mysql_real_escape_string(rawurldecode($_GET["name"]));
            $database->executeStatement("SELECT * FROM table WHERE nameField='$name'");
            $info = $database->nextResult();
            $nval = 0;
            if($info["Responded"] == 0) {
                $nval = 1;
            }
            $database->executeStatement("UPDATE table SET field='$nval' WHERE nameField='$name'");
            if($nval == 1) {
                echo "on";
            } else {
                echo "off";
            }           
        break; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-14T16:21:15.480

IE 积极缓存 ajax，并且由于您最初返回 1 和 0，它可能只是缓存的数据。将当前日期添加到您请求的 URL。

```
var d = new Date();
ops = ops + '&nocache=' + d.getTime(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T16:23:47.460

使用 POST 而不是 GET，一切都会好起来的。IE 缓存 GET，没有什么神秘的事情发生。

# c# - 用于在 MongoDB 中更新（替换）文档中的内部数组的 C# 官方 MongoDB 驱动程序代码

> ID：10587172
> 
> 赞同：2
> 
> 时间：2012-05-14T16:16:20.313
> 
> 标签：c#, mongodb, mongodb-.net-driver

我有这个[问题中描述的情况](https://stackoverflow.com/questions/7425993/how-to-update-value-of-specific-embedded-document-inside-an-array-of-a-specifi)

我需要一些帮助来使用官方 MongoDb C# 驱动程序编写此代码。

我不仅想从文档数组中更新一项，而且如果没有带有_arrayId 的此类项，我还想创建新的一项。此外，不应该有两个具有相同 _arrayId 的数组项（我曾尝试使用`AddToSet`但没有运气）。

真是头疼；我希望有更简单的方法来实现这一点。

```
var actionUpdate = Update.Set("Votes.$", vote.ToBsonDocument());
var actionPush = Update.Push("Votes", vote.ToBsonDocument());
var actionPull = Update.Pull("UserId", vote.UserId);

var querySpecific = Query.And(
    Query.EQ("_id", new ObjectId(_contentId)), 
    Query.EQ("Votes.UserId", vote.UserId));
var queryPromise = Query.EQ("_id", new ObjectId(_contentId));

MongoCollection collection = null; 

if (_type == ContentType.Promise)
    collection = DataService.PromiseSet.Collection;

var userVotes = collection.Count(querySpecific);
if (userVotes == 1)
{
    collection.Update(querySpecific, actionUpdate);
}
else if (userVotes == 0)
{
    collection.Update(queryPromise, actionPush);
}
else
{
    collection.Update(queryPromise, actionPull);
    collection.Update(queryPromise, actionPush);
} 
```

我感谢任何帮助，谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T17:25:30.100

没有更简单的方法，尽管如果考虑到这种类型的更新在 SQL 中所需的工作量，这并不是那么困难。

至于您的后续操作，C# 驱动程序返回 SafeModeResult（确保已打开安全模式）。此结果将具有 DocumentsAffected 属性，您可以在其中查看更新是否发生。如果没有，那么您需要将该值插入到数组中。

# visual-studio - 带有一长串输入的 VS 单元测试

> ID：10587188
> 
> 赞同：0
> 
> 时间：2012-05-14T16:17:03.140
> 
> 标签：visual-studio, unit-testing, vs-unit-testing-framework

我有一个要进行单元测试的数据转换功能。我已经确定了一个有限但相当长的可能输入列表（大约 1000 个），可以导致大约 50 个输出。VS 单元测试中是否有办法设置输入列表和预期输出列表（如两列 Excel 图表中）并将其输入单元测试？

如果有办法，怎么做？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T17:25:16.497

MSTest 有[`DataSourceAttribute`](http://msdn.microsoft.com/en-us/library/microsoft.visualstudio.testtools.unittesting.datasourceattribute.aspx). 通过用它标记单元测试方法，您可以授予您对数据源的测试访问权限。它支持多种格式，从数据库到 CSV 或 excel 文件。

[此博客文章](http://callumhibbert.blogspot.com/2009/07/data-driven-tests-with-mstest.html)中的示例：

```
[TestMethod]
[DataSource("Microsoft.VisualStudio.TestTools.DataSource.CSV",
    "MyWidgetTests.csv", "MyWidgetTests#csv", DataAccessMethod.Sequential)]
public void TestMyBusinessLogicWithCsv()
{
    int valueA = Convert.ToInt32(TestContext.DataRow["valueA"]);
    int valueB = Convert.ToInt32(TestContext.DataRow["valueB"]);
    int expectedResult = Convert.ToInt32(TestContext.DataRow["expectedResult"]);
    int actualResult = MyWidget.MyBusinessLogic(valueA, valueB);
    Assert.AreEqual(expectedResult, actualResult, 
        "The result returned from the widget was not as expected.");
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T16:21:46.477

如果你有这么多的输入，你可以把它写成一个自动化的集成测试。具体来说，列出某个文件中的所有输入/输出，在测试中读取该文件，然后以这种方式执行测试。

这使您的测试简单易读，并且所有数据都是外部数据，并且仍然可以轻松更改而不会混淆实际测试的逻辑。

# android - 新意图，应用程序重新启动

> ID：10587195
> 
> 赞同：1
> 
> 时间：2012-05-14T16:17:18.727
> 
> 标签：android, android-intent, android-manifest

从我的第一堂课（infoWifiActivity.class）我想打电话给第二堂课（Netdetails.class）。

```
Intent myIntent = new Intent(InfoWifiActivity.this,Netdetails.class);
startActivity(myIntent); 
```

在我的清单中我添加了这个

```
<activity
    android:name=".Netdetails"
    android:label="@string/app_name" >
    <intent-filter>
        <action android:name="my.infoWifi.Netdetails" />
        <category android:name="android.intent.category.DEFAULT" />
    </intent-filter>
</activity> 
```

正好在 . 但是每次应用程序重新启动时。对此有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T16:23:39.550

看起来您正在寻找 ACTION_MAIN：

```
<activity
  android:name=".Netdetails"
  android:label="@string/app_name" >
  <intent-filter>
    <action android:name="android.intent.action.MAIN" />
    <category android:name="android.intent.category.DEFAULT" />
  </intent-filter>
</activity> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T17:45:04.820

删除整个

```
<intent-filter>
    <action android:name="android.intent.action.MAIN" />
    <category android:name="android.intent.category.DEFAULT" />
</intent-filter> 
```

从你的 xml。

# c++ - 休息; C++：它实际上打破了哪个循环

> ID：10587196
> 
> 赞同：13
> 
> 时间：2012-05-14T16:17:19.787
> 
> 标签：c++, c, loops, break

关于 C++ 代码的简单问题：

```
for(int i=0;i<npts;i++)
{
    for(int j=i;j<2*ndim;j++)
    {
        if(funcEvals[i]<bestListEval[j])
        {
            bestListEval[j] = funcEvals[i];
            for(int k=0;k<m_ndim;k++)
                bestList[j][k] = simplex[i][k]; 
            break; 
        }
    }
} 
```

我想确保

*   的每一行`double **simplex`最多插入一次`double **bestList`
*   这里的实例`break`脱离了第二个（内部）`for`循环。

是这样吗？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-05-14T16:19:06.640

C++ 中的 break 语句将脱离直接放置 break 的 for 或 switch 语句。它打破了最里面的结构（循环或开关）。在这种情况下：

```
 for(int i=0;i<npts;i++)
    {
        for(int j=i;j<2*ndim;j++)
        {
            if(funcEvals[i]<bestListEval[j])
            {
                bestListEval[j] = funcEvals[i];
                for(int k=0;k<m_ndim;k++)
                    bestList[j][k] = simplex[i][k]; 
                break; 
            }
        }
        // after the 'break' you will end up here
    } 
```

在 C++ 中没有办法让 break 目标指向任何其他循环。为了打破父循环，您需要使用其他一些独立的机制，例如触发结束条件。

此外，如果您想退出多个内部循环，您可以将该循环提取到一个函数中。在 C++ 11 中，可以使用 lambdas 就地执行此操作 - 因此无需使用*goto*。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-14T16:19:06.343

C++ 中的`break`语句将脱离直接放置的`for`or`switch`语句。`break`在这种情况下，它将跳出`for (int j = ...`循环。

在 C++ 中没有办法以`break`任何其他循环为目标。为了打破父循环，您需要使用其他一些独立的机制，例如触发结束条件。

```
// Causes the next iteration of the 'for (int i ...' loop to end the loop)
i = npts;

// Ends the 'for (int j ...' loop
break; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-14T16:19:51.227

您正在从第二个循环跳到第一个循环。

```
for (int i=0; i<npts; i++) 
```

你可以在顶部设置一个布尔值

```
bool shouldBreak = false; 
```

当你写break时，写

```
shouldBreak = true;
break; 
```

然后在循环结束时，每次检查，

```
if (shouldBreak) break; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-05-25T04:33:01.810

```
for (int i = 0; i < npts; i++) 
```

你可以在顶部设置一个布尔值

```
bool shouldBreak = false; 
```

当你想打破另一个循环时，写

```
shouldBreak = true;
break; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-06-13T04:10:41.957

## 使用`break`

`break`将打破它当前所在的任何重复或迭代循环。这个详细的图像指南旨在突出`break`的行为，而不是说明良好的编码实践。内部 for 循环就足够了，但就像我说的，这是出于视觉目的：

[![双迭代循环](../Images/4b7ed7dc873ba52bd73d8b360cee8d6e.png)](https://i.stack.imgur.com/Xuthp.png)

# 替代建议

使用 Modern C++ 中可用的各种搜索算法`<algorithm>`来搜索容器，并在某种程度上搜索字符串。这样做的原因有两个：

1.  更短更易阅读的代码
2.  通常和你自己写的任何东西一样快

这些代码示例将需要相同的样板，`<algorithm>`但较旧的 for 循环搜索除外：

```
#include <vector>
#include <algorithm>

std::vector<int> int_container = { 10, 23, 10345, 432, 2356, 999, 1234, 0x45f };
bool has1234 = false; 
```

现代方式是这样的，我们快速搜索容器，**如果搜索迭代器不在容器**的最后（*不是*最后一个元素），**我们知道它正在搜索的值是位于**。

对于用户编写的代码，此代码以更少的行数和更少的潜在故障点实现了相同的结果，就像它下面的旧替代方案一样。

### 现代 C++ 风格

```
auto search_position = std::find( int_container.begin(), int_container.end(), 1234 ) ;
if ( search_position != int_container.end() )
    has1234 = true; 
```

### C++11 基于范围的 for 循环

```
for ( auto i : int_container )
{
    if ( i == 1234 )
    {
        has1234 = true;
        break;
    }
} 
```

### 老式 C 风格的 for 循环：

```
for ( int i = 0; i < int_container.size(); i++ )
{
    if ( int_container[i] == 1234 )
    {
        has1234 = true;
        break;
    }
} 
```

# ruby-on-rails - 如何让记录器在 IRB 中工作？

> ID：10587200
> 
> 赞同：1
> 
> 时间：2012-05-14T16:17:49.597
> 
> 标签：ruby-on-rails, ruby, irb

我正在尝试在 IRB 工作以了解我在网上找到的一些代码。

我能够要求最终导入此文件的文件：

```
module LinkedIn
  module Api

    logger.debug "....7"

    module QueryMethods

      logger.debug "....6"

      def profile(options={})
        logger.debug "....1"
        path = person_path(options)
        simple_query(path, options)
      end

      def connections(options={})
        path = "#{person_path(options)}/connections"
        simple_query(path, options)
      end

      def network_updates(options={})
        path = "#{person_path(options)}/network/updates"
        simple_query(path, options)
      end

      def company(options = {})
        path   = company_path(options)
        simple_query(path, options)
      end

      def test(options = {})
         logger.debug "helllllooooo"
      end

      private
      logger.debug "....2"
        def simple_query(path, options={})
          logger.debug "....3"
          fields = options.delete(:fields) || LinkedIn.default_profile_fields

          if options.delete(:public)
            path +=":public"
          elsif fields
            path +=":(#{fields.map{ |f| f.to_s.gsub("_","-") }.join(',')})"
          end

          headers = options.delete(:headers) || {}
          params  = options.map { |k,v| "#{k}=#{v}" }.join("&")
          path   += "?#{params}" if not params.empty?

          Mash.from_json(get(path, headers))
        end

        def person_path(options)
          logger.debug "....4"
          path = "/people/"
          if id = options.delete(:id)
            path += "id=#{id}"
          elsif url = options.delete(:url)
            path += "url=#{CGI.escape(url)}"
          else
            path += "~"
          end
        end

        def company_path(options)
          path = "/companies/"
          if id = options.delete(:id)
            path += "id=#{id}"
          elsif url = options.delete(:url)
            path += "url=#{CGI.escape(url)}"
          elsif name = options.delete(:name)
            path += "universal-name=#{CGI.escape(name)}"
          elsif domain = options.delete(:domain)
            path += "email-domain=#{CGI.escape(domain)}"
          else
            path += "~"
          end
        end

    end

  end
end 
```

这段代码是 LinkedIn 的包装器，我在这里找到了它：[https ://github.com/pengwynn/linkedin/blob/master/lib/linked_in/api/query_methods.rb](https://github.com/pengwynn/linkedin/blob/master/lib/linked_in/api/query_methods.rb)

它大部分是现成的，但这个测试位是我的：

```
 def test(options = {})
     logger.debug "helllllooooo"
  end 
```

我在本地复制了这些文件，在 IRB 中我可以执行一些命令，但由于某种原因我不能做类似的事情，`client.test`而我可以做类似`client.profile`.

也没有任何调试语句出现在 IRB 中。我是否必须使用某种标志启动 IRB 才能看到调试？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T16:25:12.083

记录器是导轨的一部分

irb 只是一个 ruby​​ 命令行解释器

使用“rails 控制台”获取运行 rails 基础设施的命令行界面。

在使用 irb 时使用 puts 作为 logger 的替代品

编辑

您将永远无法在 irb 中运行该代码，而是将您的文件复制到 yourapp/lib，然后执行

导轨控制台

现在 RAILS 已启动，但使用命令行界面，然后尝试

包括 LinkedIn::Api::QueryMethods

测试

现在你也可以使用 logger.debug

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-24T10:47:44.470

寻找同一个问题的答案，我尝试了这个，我在网上的某个地方找到了它，它起作用了：

```
2.0.0-p353 :020 > ActiveRecord::Base.logger.debug "your whatever text" 
```

# c# - WinForm 的宽度可以自动调整为 DataGridView 的总宽度吗？

> ID：10587212
> 
> 赞同：1
> 
> 时间：2012-05-14T16:18:43.903
> 
> 标签：c#, .net, winforms, datagridview

我有一个表格，其中一个 DGV 卡在表格的中心。

是否可以将表单设置为自动调整其宽度（最大限制）以适应 DGV - 取决于 DGV 中字段的总宽度。

我是否需要使用与[这篇文章](https://stackoverflow.com/questions/10574998/multiline-textbox-auto-adjust-its-height-according-to-the-amount-of-text/10575256#10575256)类似的方法，或者这是否可能使用控件属性“开箱即用”？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T16:33:59.993

编辑：

```
public Form1()
{
    InitializeComponent();

    dataGridView1.AutoSize = true;
    dataGridView1.SizeChanged += new EventHandler(dataGridView1_SizeChanged);
    dataGridView1.AutoSizeColumnsMode = DataGridViewAutoSizeColumnsMode.AllCells;
}

void dataGridView1_SizeChanged(object sender, EventArgs e)
{
    Width = dataGridView1.Width + 10;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T16:31:51.727

您可以通过将“AutoSizeColumnsMode”和“AutoSizeRowsMo​​de”属性设置为“AllCells”来将 DataGridView 设置为适合其内容的大小：

```
dataGridView.AutoSizeColumnsMode = DataGridViewAutoSizeColumnsMode.AllCells
dataGridView.AutoSizeRowsMode = DataGridViewAutoSizeRowsMode.AllCells 
```

从这里，您可以通过使用控件的大小设置表单的大小来调整表单的大小以适应 DataGridView：

```
this.Height = dataGridView.Height;
this.Width = dataGridView.Width; 
```

因此，我想您可以通过处理“ColumnWidthChanged”事件（因为您只关心宽度）来检查是否向 DataGridView 添加或删除了内容，并在该处理程序中调整表单大小。

# swing - Java 中的扩展类有多大？

> ID：10587213
> 
> 赞同：0
> 
> 时间：2012-05-14T16:18:45.483
> 
> 标签：swing, class, extend

我有一个名为`MapTile`extends的类`JLabel`。我正在做的是在一个 GridLayout 中加载一个带有很多 MapTile 的 JPanel。我注意到当我加载 100x100 MapTile 时，该过程比加载 100x100 JLabel 所需的时间更长。这是我`MapTile`下面的课。

```
public class MapTile extends JLabel {
private static final long serialVersionUID = 1L;
private boolean selected;
private Point location;

public MapTile(){
    super();
    location = new Point();
}
public void setLocation(int x, int y){
    setLocation(new Point(x,y));
}
public void setLocation(Point p){
    location = p;
}
public Point getLocation(){
    return location;
}
public void setSelected(Boolean b){
    selected = b;
    if (selected){
        ((GridPanel)this.getParent()).addToSelection(this);
        this.setBorder(BorderFactory.createLineBorder(Color.RED));
    } else {
        this.setBorder(BorderFactory.createLineBorder(Color.BLACK));
    }
    this.repaint();
}
public boolean isSelected(){
    return selected;
}
} 
```

没什么特别的，我只是重写了 setLocation 方法并添加了一些其他方法。我还只添加了三个实例变量。

扩展一个类会导致一堆额外的重量需要处理吗？

我不禁认为我的`MapTile`课程非常简单，但加载 100x100 MapTile 与加载 100x100 JLabel 之间的时间差别很大。与 JLabels 相比，大量加载 MapTile 所需的时间大约是 4-5 倍。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T16:23:34.973

您不仅覆盖了，而且每次调用该方法时都会`setLocation`创建一个新实例，这可能会对性能产生影响`Point``setLocation(int,int)`

除此之外：-您是否测试过，当您删除被覆盖的方法时，您不再会遇到减速-您是否对应用程序进行了分析以查看性能损失发生在哪里

哦，是的，我认为您的覆盖版本不`setLocation`正确。`super.setLocation`如果你想`JLabel`表现得正确，我担心你也必须打电话

# eclipse - 安装最新软件 (guava/acceleo)

> ID：10587216
> 
> 赞同：0
> 
> 时间：2012-05-14T16:18:53.597
> 
> 标签：eclipse, guava, acceleo

我开始通过 Eclipse 学习编程，我只是在弄清楚如何添加意图，这需要将 Guava 添加到我的项目中以及安装最新版本的 Acceleo（目前显然是 3.3）。

我很想知道每次我决定开始一个新项目时是否需要这个过程？整个添加/安装 guava 和 Acceleo（可能还有更多其他的，因为我刚刚开始，可能会在以后遇到更多）。

如果是这样，我怎么知道是否有更新的版本或知道如何确定我应该使用哪个版本？我必须手动查找它们吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T17:54:49.420

您应该使用今天发布的[Acceleo 3.2.1](http://marketplace.eclipse.org/content/acceleo)，guava 现在是安装的依赖项之一，无需用户交互。使用 Acceleo 3.2.1 创建的新 Acceleo 项目不需要添加对 Guava 的依赖项（它应该在创建新的 Acceleo 项目时自动生成）。下个月 Acceleo 3.3.0 的最终版本也会如此。由于 Eclipse Marketplace（上面的链接）或 Acceleo 3.2.x 更新站点，您可以安装 Acceleo 3.2.1：http: [//download.eclipse.org/modeling/m2t/acceleo/updates/releases/3.2](http://download.eclipse.org/modeling/m2t/acceleo/updates/releases/3.2)

问候，

Stephane Begaudeau，Acceleo 的领导者。

# autosys - 带盒子的命令作业可以有 start_times 吗？

> ID：10587217
> 
> 赞同：0
> 
> 时间：2012-05-14T16:18:57.403
> 
> 标签：autosys

我想在同一天在 3 个不同时间运行 3 个命令。

我想创建 1 个包含这 3 个命令的顶级框。并为它们中的每一个设置不同的 Start_time 值......而不是在每个中创建 3 个带有命令作业的顶级框并在顶级框上设置 Start_time。

可以这样做吗？

我尝试在每个命令作业中设置 START_TIMES: 11:00 TIME_ZONE: NewYork，但是当我上传 Jil 文件并执行 autorep -j Job_name -q 时，我设置的 start_times 和 time_zone 属性已被删除。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T21:03:23.570

只要顶层框没有日期/时间条件，您就可以这样做。当盒子和盒子中的作业都具有日期/时间条件时，可能会发生不好的事情，例如作业没有按预期运行。如果您在 Autosys R11 中使用回溯条件，这可能不会发生，但我在 R11 中没有使用回溯条件的经验。

为什么要将它们分组在一个框中？请记住，一个盒子适用于具有类似起始条件的工作。如果他们有不同的开始时间，他们就有不同的开始条件。例如，如果他们从 job_a 和 start_times 的成功开始：hh:mm，那么您可以让 box_b 在 s(job_a) 开始，然后框中的作业从 start_times:hh:mm 开始。

不知道为什么你的 start_times: 和 time_zone: 命令没有使用。运行 jil 命令时是否收到任何错误消息？

# opengl - 使用 LWJGL 绘制 3D 文本

> ID：10587225
> 
> 赞同：0
> 
> 时间：2012-05-14T16:19:25.407
> 
> 标签：opengl, 3d, lwjgl

我一直在寻找一种使用 LWJGL 和 Slick 在 openGL 中编写 3d 文本的方法，但我找不到合适的教程。真的可以使用 LWJGL 和 Slick 渲染 3D 文本吗？如果没有，是否有另一个图书馆可以这样做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T17:39:10.743

“可能”是什么意思？3D 文本只是一个恰好是字母形状的网格。LWJGL 只是 OpenGL 的一个 Java 接口，它可以完美地绘制网格。所以理论上它可以绘制 3D 文本，只要您提供网格即可。

*LWJGL 和 Slick 是否提供了从字符串创建*3D 文本网格的内置方法？不，您必须使用其他库来执行此操作，或者自己编写一个。

# json - GPS位置显示使用我自己的地图......不是谷歌地图

> ID：10587226
> 
> 赞同：1
> 
> 时间：2012-05-14T16:19:26.917
> 
> 标签：json, ios5, geolocation, geocoding, windows-mobile-gps

我正在尝试构建一个 iphone 应用程序，当我在大学校园时，它将向我的朋友/家人显示我的实时位置。我不想将谷歌地图或任何其他在线地图提供商用于显示我的位置的基本地图。因此，我创建了一张与现实生活中的大学校园完全成比例的大学校园地图。我什至在谷歌地图上覆盖了它以检查它的准确性。

是否可以对这张地图进行地理参考，然后将这张地图嵌入到我的 iPhone 应用程序中，以便我的位置显示在上面？这样我就不必使用谷歌地图了。我需要用户能够放大地图图像以更近距离地查看我的位置。我的 GPS 位置数据将通过 JSON 数据传送到应用程序。

# solr - 为 Solr 找到用于划分输入字符串的最佳现成 Analyzer/Tokenizer/TokenFilters

> ID：10587227
> 
> 赞同：0
> 
> 时间：2012-05-14T16:19:28.507
> 
> 标签：solr, analyzer

我正在将一些现有的索引从 Lucene 移动到 Solr。我们在 Lucene 的输入文本上应用以下逻辑：

1.  小写
2.  replaceDictionaryWords（用其他词替换一些特定的词，例如用“htz”替换“赫兹”）
3.  仅提取字符和数字
4.  修剪输出字符串
5.  用 \s 替换 \s+
6.  使用 java.lang.String#split(in) 方法拆分
7.  对于每个拆分的文本，将结果词除以以下模式：“ABCDEF”=> ABC BCD CDE DEF（除以 3、2）

我不想编写可能存在的 Tokenizer。

所以，我在这里查看[http://wiki.apache.org/solr/AnalyzersTokenizersTokenFilters](http://wiki.apache.org/solr/AnalyzersTokenizersTokenFilters)但错过了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T19:36:26.690

1.  [小写过滤器](http://wiki.apache.org/solr/AnalyzersTokenizersTokenFilters#solr.LowerCaseFilterFactory)，
2.  [同义词过滤器](http://wiki.apache.org/solr/AnalyzersTokenizersTokenFilters#solr.SynonymFilterFactory)，
3.  [StandardTokenizer](http://wiki.apache.org/solr/AnalyzersTokenizersTokenFilters#solr.StandardTokenizerFactory)或[PatternTokenizer](http://wiki.apache.org/solr/AnalyzersTokenizersTokenFilters#solr.PatternTokenizerFactory)，
4.  [修剪过滤器](http://wiki.apache.org/solr/AnalyzersTokenizersTokenFilters#solr.TrimFilterFactory)，
5.  [模式替换过滤器](http://wiki.apache.org/solr/AnalyzersTokenizersTokenFilters#solr.PatternReplaceFilterFactory)，
6.  [WordDelimiterFilter](http://wiki.apache.org/solr/AnalyzersTokenizersTokenFilters#solr.WordDelimiterFilterFactory) ?
7.  [NGramTokenFilter](http://lucene.apache.org/core/old_versioned_docs/versions/3_5_0/api/all/org/apache/lucene/analysis/ngram/NGramTokenFilter.html)（您可能需要为此编写一个工厂）。

但是如果你已经有一个现有的 Lucene 分析器，你可以[让 Solr 使用它](http://wiki.apache.org/solr/SolrPlugins#Analyzer)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T16:24:06.087

试试[OpenPipeline](http://openpipeline.org)。它专为预处理输入搜索软件的文档而设计。

# mysql - MySql - 什么可能导致 FOUND_ROWS() 返回不正确的值？

> ID：10587232
> 
> 赞同：1
> 
> 时间：2012-05-14T16:19:52.597
> 
> 标签：mysql

我有一个类似于下面示例的查询（此帖子仅更改了列名），它使用 LIMIT 从 MySql 数据库中返回记录的分页选择，加上如果未通过 FOUND_ROWS 应用的限制，将返回的记录数()。

在下面的例子中 SELECT FOUND_ROWS() 只返回 10，尽管我知道如果取消限制，查询会返回更多行。我也有这个工作，正如我对许多其他非常相似的查询所期望的那样。

什么可能导致 MySql 返回一个可以解释我在这里看到的意外值？

```
SELECT 
id, 
firstname, 
surname, 
'' as anothercolumn1, 
date as anothercolumn2, 
'literal' as db 

FROM some_table 

WHERE 
filter_col LIKE @val1 
and surname LIKE @val2 
ORDER BY surname, firstname 
LIMIT 0, 10; 

SELECT FOUND_ROWS(); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-14T16:23:03.610

尝试[`SQL_CALC_FOUND_ROWS`](http://dev.mysql.com/doc/refman/5.0/en/information-functions.html#function_found-rows)在您的查询中使用：

```
SELECT 
SQL_CALC_FOUND_ROWS
id, 
firstname, 
.... 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-14T16:24:09.747

您必须`SQL_CALC_FOUND_ROWS`在第一个`SELECT`关键字之后添加才能在调用时获得准确的结果`FOUNC_ROWS()`：

```
SELECT SQL_CALC_FOUND_ROWS
id,
firstname,
...

SELECT FOUND_ROWS(); 
```

[手动的](http://dev.mysql.com/doc/refman/4.1/en/information-functions.html#function_found-rows)

# java - 重构 XSD 和/或生成 java 代码

> ID：10587238
> 
> 赞同：1
> 
> 时间：2012-05-14T16:20:33.707
> 
> 标签：java, xsd, jaxb, xjc, automated-refactoring

我获得了一组旧版 XSD，用于我的应用程序提供的服务，这些服务急需重构。由于某些消费者应用程序没有开发团队，因此我无法更改结果和架构。但是，我可以对实际文件做任何我想做的事情。

这是我的目录设置：

*   根
    *   子目录1
        *   常见的
        *   发展
    *   子目录2
        *   常见的
        *   发展

为简单起见，假设文件之间版本的增量将元素添加到 complexType，以便可以将以前的版本重新应用为基类/超类。

现在，在 subdir1/common 中，我可以拥有 Include_v01.xsd 和 Include_v02.xsd。在 subdir1/development 中，我可以拥有使用 Include_v01.xsd 的 svc1_v01.xsd 和使用 Include_v02.xsd 的 svc1_v02.xsd

在 Subdir2/common 中，我可以拥有 Include_v02.xsd 和 Include_v03.xsd 在 subdir2/developmen 中，我可以拥有使用 Include_v02.xsd 的 svc2_v01.xsd 和使用 include_v03.xsd 的 svc2_v02.xsd

我有大约 20 个这样的子目录。我在这些目录中有大约 1500 个左右的 XSD 文件。每个 xsd 可以有多个包含，它自己可以有多个包含，它自己可以有多个包含，等等。

最终，我想将它们重构为最简单的形式，例如，我只有一个 Include_v02.xsd 副本，而 Include_v02.xsd 实际上是从 Include_v01.xsd 构建的，而不是完全独立的副本. 是的，有些混蛋只是复制了文件，将其重命名，并添加了一个字段。然后他将它复制到将要使用的每个子目录中。

比这更重要的是能够生成类似结构的 java 类。

现在，我能做的最好的就是在目录上运行 xjc，并将每个服务的模式编译到不同的包中，所以我现在在各种 java 包中拥有大量 Include_v02 对象的副本。我必须这样做，因为架构没有在版本之间进行版本化或重新调整。同一个白痴只是复制文件，重命名它，并添加一个新元素，保持根元素相同，没有其他显着特征。

这是一个艰巨的任务，我会接受某种方式来轻松复制/合并 java 对象，甚至只是简单地在不同包中的相同 java 对象之间进行复制。

剧集文件，就像[这里](https://stackoverflow.com/questions/9683907/compile-several-xsds-containing-duplicate-definitions-of-the-same-element-with)提到的那样，似乎并不比我现在用来生成东西的脚本更好，因为考虑到多层嵌套，我必须非常刻意地找出每个根元素用过的。

编辑============================= 如果我在 Include_v01.xsd 中有以下内容：

```
<complexType name="cmplxtp">
    <complexContent><sequence>
         <element name="st1" type="string"/>
     </complexContent></sequence>
</complexType> 
```

而且，在 Include_v02.xsd 中，我有类似的东西

```
<complexType name="cmplxtp">
    <complexContent><sequence>
         <element name="st1" type="string"/>
         <element name="st2" type="string"/>
     </complexContent></sequence>
</complexType> 
```

我会喜欢一些组合

将 XSD 重构为

Include_v01.xsd 同 Include_v02.xsd

或者

Include_v01.xsd Include_v02 中保留的所有单个元素（复杂或简单）以包含 Include_v01.xsd，仅添加了新元素

或者

两个java类

```
package pack1;
class cmplxtp {
    public String st1;
} 
```

和

```
package pack2;
class cmplxtp extends pack1.cmplxtp  {
    public String st2;
} 
```

java 类对我来说是最重要的，但任何有助于实现目标的东西都会非常出色。

如果这一切都不可能、简单或值得，我也非常感谢一些简单的方法来将相同的对象从一个复制到另一个，如果它们存在于不同的包中。我真的很想简化我的代码库，我有 160 个左右的服务，每个都有很多版本，每个版本都可以包含相同的精确文件。这意味着在我的生成代码中，我可能有 300 个或更多同一个类的定义，但由于复制的包含而在不同的包中。

# python - 具有不同字符串的正则表达式的多个匹配

> ID：10587240
> 
> 赞同：0
> 
> 时间：2012-05-14T16:20:46.853
> 
> 标签：python, regex

这很难描述（尤其是作为非母语人士），但我会尽力而为：

在我的 python 程序中，我有一个数据库，比如说，新闻文章和一个想要了解其中一个子集的用户。每个新闻对象都有多个字符串，例如*Author*、*Title*或*Text*。

我想将用户的兴趣保存为一个表达式，它允许我匹配不同的字符串属性并将这些匹配与这样的逻辑运算符结合起来（语法并不重要）：

```
attribute author matches pattern (\w*\sSmith) and attribute text doesn't
contain pattern (financ(e|ial)) 
```

然后，我必须为每个用户迭代所有文章，如果表达式有效，请通知他/她。

我的问题是我真的不知道该使用什么语言。我想避免创建自己的解析器并编写自己的解析器来解决所有常见的问题（安全性、转义等），因为我确信这是一个相当普遍的问题，并且必须有比我更好的解决方案能够创造。

我已经在网上搜索了一段时间，但没有找到任何东西。非常感谢您的每一次帮助；提前致谢！

**[编辑：]**按照 RabbidRabbit 的建议重新格式化伪代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T16:34:29.427

有几种方法可以解决这个问题。它们的范围从`(attribute, regexp)`您在每个对象基础上应用的元组列表到更复杂的事物。

一种选择是找到某种声明性“语言”，您可以使用它指定简单的查询，例如您提到的查询。这可以存储在 JSON 或 YAML 结构中，这完全取决于您希望它有多复杂/可扩展。

如果你想让它真正可扩展，你可能想要一个 DSL（特定领域的语言）：

[http://www.slideshare.net/Siddhi/creating-domain-specific-languages-in-python](http://www.slideshare.net/Siddhi/creating-domain-specific-languages-in-python)

这是过去的 StackOverflow 帖子，可能会有所帮助。

[编写用于从表中选择行的领域特定语言](https://stackoverflow.com/questions/140026/writing-a-domain-specific-language-for-selecting-rows-from-a-table)

我能看到的最简单的解决方案（解析、生成和存储）是 LISP 样式的元组前缀列表，例如：

```
[('and', ('body', '.*to be or not.*'), ('author', (not, '.*shakespeare.*'))),
 ...] 
```

如果您只需要基本的布尔运算符和正则表达式，那就足够了。

**[编辑]**添加示例

# c# - ListView 中的可编辑子项

> ID：10587241
> 
> 赞同：0
> 
> 时间：2012-05-14T16:20:54.060
> 
> 标签：c#, listview

我有一个`ListView`类似的：

```
Name | Pass | Proxy | Keyword
Usr1 | pass1| 88.x..| stackoverflow
Usr2 | pass2| 78.x..| google 
```

我希望用户能够双击例如 Google，并能够将其更新为其他内容。现在，用户必须删除整行并添加新的更新行才能实现此目的。

我试过搜索我似乎找不到任何简单的解决方案来解决这个问题。非常欢迎任何和所有帮助:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T16:28:42.507

使用 ObjectListView： http: [//objectlistview.sourceforge.net/cs/index.html](http://objectlistview.sourceforge.net/cs/index.html)

它提供了您需要的功能，并且非常易于使用和设置。我建议阅读它的文档，因为它不是 .Net ListView 的即插即用替代品

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T16:49:07.280

您可以使 listviewitems 可编辑。我相信它是列表视图本身的属性。

LabelEdit 是属性。您可以捕捉到相应事件的变化。

# html - 是否有理由在我的样式表中使用 a 而不是 a:link 或 a:visited？

> ID：10587245
> 
> 赞同：15
> 
> 时间：2012-05-14T16:21:23.410
> 
> 标签：html, css, css-selectors

谁能告诉我是否有任何理由在我的样式表中使用`a {}`代替（或相邻） ？`a:link, a:visited {}`我在浏览器、网站等方面对此进行了不一致的测试，所以我从来没有给出令人满意的答案。我也无法在 Google 上找到答案。

这当然是假设**永远不会**有理由使用没有值的`<a>`标签。`href`也许这是一个错误的假设。

****编辑****

我知道这些选择器*的作用*。我正在寻找为什么我会使用`a`而不是`a:link`or的原因`a:visited`，因为`a`它总是有一个`href`属性。但正如 Chris Blake 和 Ryan P 在答案中所说，还有`<a name="top">`javascript 用法，它们都不需要该`href`属性。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-05-14T19:29:38.490

> 这当然是假设**永远不会**有理由使用没有值的`<a>`标签。`href`也许这是一个错误的假设。

这取决于您的项目。严格来说，这*是*一个错误的假设，因为并非每个`<a>`元素都需要有一个`href`属性。事实上，在 HTML5 中仍然**不需要**`href`为每个`<a>`. [Chris Blake](https://stackoverflow.com/questions/10587245/is-there-a-reason-to-use-a-instead-of-alink-or-avisited-in-my-stylesheet/10587315#10587315)和[Ryan P](https://stackoverflow.com/questions/10587245/is-there-a-reason-to-use-a-instead-of-alink-or-avisited-in-my-stylesheet/10587325#10587325)提到了命名锚点，我要补充一点，虽然 for 的`name`属性[在 HTML5](https://html.spec.whatwg.org/multipage/obsolete.html#obsolete-but-conforming-features)`<a>`中已经过时，但命名锚点仍然很普遍，并且将继续存在，仅仅是由于传统和传统。

也就是说，**今后**，建议作者使用`id`属性而不是命名锚来指定文档锚片段。

此外，`<a>`缺少`href`属性但具有`onclick`JavaScript 属性的元素是一团糟。即使您坚持使用`onclick`绑定事件，为了优雅降级，您至少*应该*使用`href`.

但是为了简单起见，让我们假设您不会编写没有属性的`<a>`元素。`href`

考虑到这一点，回到 CSS 选择器，有两点需要考虑：

## 他们是一样的吗？

不，选择器`a`和`a:link, a:visited`不是严格等价的。我将引用我之前关于这个主题的[答案：](https://stackoverflow.com/questions/9367403/link-styling-behaviour-in-ie6/9367665#9367665)

> 选择器`a`应该匹配任何`<a>`元素，而`a:link`只匹配未访问的*超链接*`<a>`的元素（HTML 4 文档类型将超链接定义为具有属性的元素）。它在任何一个规范中都没有说明应该自动转换为，反之亦然。*`<a>``href``a``a:link`*

 *换句话说，在 HTML 中，`a:link, a:visited`（在 CSS1 中）严格等同于`a[href]`（在带有属性选择器的 CSS2 中）或`a:any-link`（在[选择器级别 4](https://www.w3.org/TR/selectors-4/#the-any-link-pseudo)中的新），而不是`a`. 请注意，属性是否具有值并不重要，只要它存在，伪类就会匹配，因此`[href]`. 另请注意，这适用于所有当前的 HTML 标准，我相信这包括 HTML5，因为如上所述`href`不是任何现有规范中的必需属性。

请记住，其他语言可能为`:link`and定义完全不同的语义`:visited`——碰巧它们与 HTML 中同样特定的选择器相吻合，接下来将介绍...

## 特异性

这是一个巨大的陷阱：`a`比`a:link`or更不具体`a:visited`，这是一个非常常见的特异性问题来源，在将样式应用于`a`,`a:link`和`a:visited`单独应用时尤其明显。然后，这会导致各种`!important`黑客攻击来解决对特异性缺乏了解的问题。

例如，考虑这个 CSS：

```
/* All unvisited links should be red */
a:link {
    color: red;
}

/* All visited links should be slightly darker */
a:visited {
    color: maroon;
}

/* But no matter what, header links must be white at all times! */
body > header > a {
    color: white;
} 
```

这不能按预期工作，因为`a:link`and `a:visited`（我称之为通用规则/选择器）比`body > header > a`（我称之为专用规则/选择器）更具体，因此标题链接实际上**永远不会**是白色的：

```
/* 1 pseudo-class, 1 type  -> specificity = (0,1,1) */
a:link, a:visited

/* 3 types                 -> specificity = (0,0,3) */
body > header > a 
```

现在大多数 CSS 编码人员首先想到的就是投入`!important`，完全胜过特异性：

```
body > header > a {
    color: white !important;
} 
```

但这会让你得到各种各样的坏名声，对吧？所以我们不要那样做。

选择器级别 4 为您提供的不是一个，而是*两个*解决此特异性问题的方法。这些解决方案虽然是新的，但在 Internet Explorer 和 Microsoft Edge Legacy（UWP/EdgeHTML/not-Chromium 之一）中不受支持，但值得庆幸的是，在 Internet Explorer 7 及更高版本中还有第三种解决方案，`a[href]`即我上面提到的属性选择器。

### 1.`:any-link`伪类

`:any-link`它背后有一些历史，您可以在我对[这个问题](https://stackoverflow.com/questions/14436526/whats-the-any-link-pseudo-class-for/14437502#14437502)的回答中阅读，但实际上，`:any-link`它可以作为`:link, :visited`. 它的主要目的是消除选择器重复，因此实际上存在`:is(:link, :visited)`.

您可以`a:any-link`在您的专门规则中使用来匹配通用规则`a:link`和`a:visited`规则的特殊性，从而允许它覆盖它们：

```
a:link {
    color: red;
}

a:visited {
    color: maroon;
}

/* 1 pseudo-class, 3 types -> specificity = (0,1,3) */
body > header > a:any-link {
    color: white;
} 
```

### 2.`:where()`伪类

`:where()`它背后也有一些历史，但本质上它是一个类似物，`:is()`除了它将其论点的特殊性归零。有关它如何工作的深入指南，请参阅我对[这个问题的回答。](https://stackoverflow.com/questions/67433247/what-is-the-difference-between-where-and-is/67450559#67450559)

`:link`您可以将 s和`:visited`伪类包装在`:where()`s 中以删除它们的伪类特异性，从而允许它们被专用规则覆盖：

```
/* 1 type                  -> specificity = (0,0,1) */
a:where(:link) {
    color: red;
}

/* 1 type                  -> specificity = (0,0,1) */
a:where(:visited) {
    color: maroon;
}

/* 3 types                 -> specificity = (0,0,3) */
body > header > a {
    color: white;
} 
```

### 3\. `a[href]`（对于旧版浏览器）

幸运的是，如果您需要支持较旧的浏览器，属性选择器与伪类一样具体。这意味着您可以使用`a[href]`来表示 both/either`a:link`和/or `a:visited`，而不会遇到具体问题，因为它们同样具体！

```
/* 1 attribute, 3 types    -> specificity = (0,1,3) */
body > header > a[href] {
    color: white;
} 
```

## 那么使用哪个选择器呢？

这仍然是非常主观的，但我遵循以下个人经验法则：

*   适用于*不依赖于链接状态的*`a`样式（即只要是链接就可以）。

**   应用于`a:link`和是否访问链接*无关紧要*`a:visited`的样式。

    **   考虑到上面提到的特殊性问题，不要在 and / 规则之间*混用* `a`任何`a:link`声明`a:visited`。如果我需要将相同的属性应用于某处的两个州，但我已经在单独`a:link`的`a:visited`规则中拥有它，我将使用上述 3 个选项之一来避免特异性问题。** 

 **例如，以下是我在网站发布前的 Coming Soon 页面中使用的链接样式：

```
a {
    text-decoration: none;
    transition: text-shadow 0.15s linear;
}

a:link {
    color: rgb(119, 255, 221);
}

a:visited {
    color: rgb(68, 204, 170);
}

a:hover, a:active {
    text-shadow: 0 0 0.5em currentColor;
}

a:focus {
    outline: thin dotted;
}

/* ... */

footer a:link, footer a:visited {
    color: rgb(71, 173, 153);
} 
```

`text-shadow`过渡是为所有元素定义的，`a`无论它们是否被访问，因为过渡只有在其中一个被鼠标悬停并单击时才会生效（对应于`a:hover, a:active`规则）。

现在，我希望访问过的链接比未访问过的链接有更深的阴影，所以我将颜色放在单独的`a:link`规则`a:visited`中。但是，出于某种原因，无论是否访问页脚链接，我都希望页脚链接显示相同的颜色。

如果我使用`footer a`，我会遇到上面描述的特异性问题，所以我选择`footer a:link, footer a:visited`了。这是出于遗留原因（如下所示，我最初是在 2012 年发布的！），但当然可以将其缩短为`footer a:any-link`. 然而，特异性匹配原则同样适用。

希望我的建议可以帮助您处理链接样式的混乱。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-14T16:24:46.463

和用于分别为普通链接`a:link`和访问链接`a:visited`指定*自定义*（浏览器默认除外）颜色，而`a {}`用于覆盖所有样式，包括`a:link`, `a:visited`, `a:active`. 例如，无论链接是否处于活动状态、是否访问过或悬停在上面，以下内容都将具有相同的颜色：

```
a { color:red; } 
```

您可以通过使用单独的样式（例如`a:pseudoClass`符号）来避免这种情况。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-14T16:25:12.187

那么你可以有一个*只是*一个锚的锚。例如，

```
<a href="#top">Return to top</a>

<a name="top">Top</a> 
```

这纠正了您的错误假设（尽管“顶部”不需要锚点，但它在哲学上是最正确的）。

此外，正如 Sarfraz 所说，如果样式化（并假设在其他声明之后） ，则会`a {}`覆盖所有出现的其他样式属性。`a:``a {}``a:`

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-05-14T16:25:17.150

`a:link`并且`a:visited`有特定的含义。`a`它本身会影响所有`<a>`元素，而`a:link`只会影响尚未访问的`a:visited`链接，并且只会影响已访问的链接。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-05-14T16:25:45.987

有两种情况，an`a`可能没有`href`属性。第一个是常规锚点（即`<a name="someplace" />`），第二个是纯 Javascript 交互（即`<a onclick="doSomething( );" />`）。这些不是“链接”，不应使用相同的样式。

编辑：澄清一下，`a:link`几乎等同于`a[href]`（我相信前一个符号在属性选择器可用或标准化之前就存在）。因此，如果您希望所有锚标签的样式都相同，则使用`a`not的原因是。`a:link`某些浏览器中的默认样式以不同的方式显示这两种 - 例如下划线仅适用于`a:link`而不适用于`a`.***

# c++ - 快速编译高效排序算法（用于 JIT 编译）

> ID：10587250
> 
> 赞同：1
> 
> 时间：2012-05-14T16:21:40.743
> 
> 标签：c++, algorithm, sorting, llvm, clang

我正在构建一个编译器，它将 c++ 代码生成为一个字符数组，该数组由 JIT 编译器 Clang 转换为 LLVM-IR，然后进一步 JIT 转换为可执行代码（然后执行）。

我正在处理大量数据，有一次，我需要对*自定义*数据类型的数组进行排序。数据类型由我的编译器动态构建，并且对于每个 JIT 编译都不同。通常元素按字典顺序通过其中的一些数字进行比较，但是，在极少数情况下比较可能会更复杂（在一些指针和花哨的字符串比较之后）。

现在我的问题是：什么是一种有效的排序算法，它可以由 llvm*非常快*地编译，同时在执行时*非常快*？是否有可以快速编译并同时快速运行的算法？

我的第一个想法是对比较函数进行 JIT 处理并将其作为指针提供给 qsort()（我可以链接到 LLVM 中的外部编译函数）。然而，qsort 在执行时效率低得惊人。另一种方法是使用 std::sort 在编译时由于其模板和 stl-blubbla-sugar 而效率低得惊人。

我为以下结构的执行做了一些性能测试：

```
struct MyStruct {
int x;
long z;
bool operator<(const struct MyStruct& other) const { return (x < other.x) || (x==other.x&&z<other.z); }
} 
```

1MB 数据运行时间：

*   标准：：排序：5毫秒
*   qsort：14 毫秒
*   自写：6毫秒

1GB 数据运行时间：

*   标准：：排序：8.9 秒
*   qsort：24 秒
*   自写：10.1 s

不幸的是，我现在没有 JIT 编译时间，但将来会发布它们。

目前，我自己编写的排序似乎比 qsort 或 std::sort 更好，但我宁愿使用一些库实现。

您对现有的排序实现有什么建议，既可以快速执行又可以编译？或者在快速排序的同时是否有任何其他可能性来加快编译（仅编译比较功能或类似功能）？

顺便说一句，这是我自己编写的（从[http://alienryderflex.com/quicksort/](http://alienryderflex.com/quicksort/)偷来的）排序例程（对于 JITing，我不会使用模板类型，而是直接用自定义类型替换它，包括“<= "):

```
template< typename Type >
void self_written_sort(Type *arr, int elements) {
    #define  MAX_LEVELS  64
    Type piv;
    int beg[MAX_LEVELS], end[MAX_LEVELS], i=0, L, R, swap ;
  beg[0]=0; end[0]=elements;
  while (i>=0) {
    L=beg[i]; R=end[i]-1;
    if (L<R) {
      piv=arr[L];
      while (L<R) {
        while (arr[R]>=piv && L<R) R--; if (L<R) arr[L++]=arr[R];
        while (piv<=arr[L] && L<R) L++; if (L<R) arr[R--]=arr[L]; }
      arr[L]=piv; beg[i+1]=L+1; end[i+1]=end[i]; end[i++]=L;
      if (end[i]-beg[i]>end[i-1]-beg[i-1]) {
        swap=beg[i]; beg[i]=beg[i-1]; beg[i-1]=swap;
        swap=end[i]; end[i]=end[i-1]; end[i-1]=swap; }}
    else {
      i--;
}}} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T18:46:19.760

我会首先尝试将函数指针传递给`std::sort`，然后以下列`qsort`方式使用它：

*   算法本身是预编译的
*   比较函数是 JITed 并动态传递

我认为它仍然会优于，`qsort`因为该算法会有意义地操纵内存，并且只会调用比较（真的）。

# php - 随机相关产品静态 Magento 页面

> ID：10587252
> 
> 赞同：0
> 
> 时间：2012-05-14T16:21:42.420
> 
> 标签：php, magento, random, content-management-system

我在 Magneto 中有几个“CMS”页面；我需要在每个页面的底部创建一组 3 个链接/图像，这些链接/图像是从特定类别中随机提取的。例如，如果您在“明尼苏达州钓鱼”页面上，您会在页面底部看到来自钓鱼类别的 3 个随机产品。谢谢，-山姆

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T07:26:27.160

看起来用于向 CMS 页面/块添加随机产品的内置功能已经在 Magento 中被破坏了一段时间。既然 CE 1.7 已经发布，您可能想尝试一下 - 它可能会起作用：

```
{{block type="catalog/product_list_random" category_id="3" num_products="5"}} 
```

如果没有，Magento 论坛上的人在此线程的末尾有一个自定义修复：http: [//www.magentocommerce.com/boards/viewthread/3696/P105/#t365674](http://www.magentocommerce.com/boards/viewthread/3696/P105/#t365674)

# html - 嵌套链接覆盖

> ID：10587259
> 
> 赞同：0
> 
> 时间：2012-05-14T16:22:08.623
> 
> 标签：html, css, wordpress

最内层嵌套链接出现在第二个最内层嵌套链接上。在单击其父级之前，它们甚至不应该显示。

**HTML：**

```
<ul>
    <li class="current-menu-ancestor">
        <a href="#">about us</a>
        <ul class="sub-menu">
            <li class="current-menu-ancestor">
                <a href="#">locations</a>
                <ul class="sub-menu">
                    <li class="current-menu-ancestor">
                        <a href="#">georgia</a>
                        <ul class="sub-menu">
                            <li class="current-menu-item">
                                <a href="#">atlanta</a>
                            </li>
                        </ul>
                    </li>
                </ul>
            </li>
        </ul>
    </li>
</ul> 
```

见这里： http: [//guardianwebtest.edulence.com/ashford/locations/main/georgia](http://guardianwebtest.edulence.com/ashford/locations/main/georgia)

3 层工作，但由于某种原因，第四层被覆盖。不知道为什么会这样。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T16:35:51.620

该问题是由以下规则中声明的高度引起的。如果您删除它，所有项目将停止挤压在一起：

```
#content-wrap #sidebar li ul.sub-menu li ul.sub-menu li,
#content-wrap #sidebar ul.sub-menu li:first-child ul.sub-menu li{
    background: url("images/l-nav-subnav.gif") no-repeat scroll 0 0 transparent;
    margin-left: 30px;
    padding-left: 15px;
    height: 20px; /* remove this line */
} 
```

# jdbc - JDBC vs psql 间隔渲染差异

> ID：10587260
> 
> 赞同：3
> 
> 时间：2012-05-14T16:22:12.367
> 
> 标签：jdbc, jasper-reports, ireport, postgresql

使用带有 linux psql 控制台和 windows pgadminIII 的 postgresql 9.1 查询：

```
select '2012-05-05 15:57:31-07'::timestamp with time zone - '2012-05-01 23:13:34-07'::timestamp with time zone; 
```

将返回呈现为：

```
 ?column?     
-----------------
 3 days 16:43:57
(1 row) 
```

但是，windows JDBC 驱动程序（特别是使用 jasperreport 的 ireport）将这个查询呈现为：

```
 ?column?     
-----------------
 0 years 0 mons 3 days 16 hours 43 mins 57.00 secs
(1 row) 
```

我已经探索`to_char`了[postgresql 文档](http://www.postgresql.org/docs/current/static/functions-formatting.html)，但找不到解决方案。两个问题：首先，如何使 JDBC 驱动程序以与 pqsl 相同的格式呈现间隔？

其次，我可以改为让 psql 和 JDBC 都将结果呈现为：

```
88:43:57 
```

随着时间间隔的增加，小时数一直计数到 100 秒（这是一个愚蠢的行业标准......）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T06:29:59.567

“首先，如何让 JDBC 驱动程序以与 pqsl 相同的格式呈现间隔？”
我认为这个问题实际上并没有很好的定义。类型的对象`org.postgresql.util.PGInterval`没有格式。当然，如果你在它上面调用 toString()，那么你会得到一些东西。您将获得 iReport 显示的内容。所以从某种意义上说，这是它的默认格式。但实际上它*只是*一堆用于表示年、月、日、小时、分钟的整数，以及表示秒的双精度数。这不是格式化的东西。

pgAdmin III 做了一些魔术来更好地格式化它。但是这个魔法并没有内置到 JDBC 驱动程序中。Szymon 的回答肯定会奏效。但是... 废话。

“其次，我能否改为让 psql 和 JDBC 都将结果呈现为：`88:43:57`”
您可以将逻辑放入 .jrxml 而不是 Szymon 的过程。这会更好，因为......好吧......它不会真的更好。只是会有所不同。它可以让你通过在报告中计算这个来保持你的 SQL 查询不变：

```
$F{?column?}.getDays() * 24 + $F{?column?}.getHours()
+ ":" + $F{?column?}.getMinutes() + ":" + $F{?column?}.getSeconds() 
```

这不是 100% 正确的。您需要根据您的要求将秒数从 double 截断（舍入？）为 int。并且要完全通用，您需要添加数月和数年，但也许您并不真正关心这些。无论如何，你**可以**这样做。警告间隔器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T21:18:28.990

我不知道你可以使用任何标准函数，但你总是可以像这样格式化它：

```
CREATE OR REPLACE FUNCTION format_time(t INTERVAL) 
RETURNS TEXT
LANGUAGE PLPGSQL
AS $$
DECLARE
    res TEXT;
BEGIN
    res = 24 * EXTRACT(day FROM t ) + EXTRACT(hour FROM t );
    res = res || ':';
    res = res || EXTRACT(minute FROM t);
    res = res || ':';
    res = res || EXTRACT(second FROM t);
    RETURN res;
END;
$$; 
```

你可以像这样使用它：

```
SELECT format_time(
    '2012-05-05 15:57:31-07'::timestamp with time zone 
    - 
    '2012-05-01 23:13:34-07'::timestamp with time zone
); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-16T17:08:51.877

我为自己做了一个功能，可以满足我的需要。我全神贯注于建议、改进和优化。

```
create or replace function format_hours(started timestamp with time zone, stopped timestamp with time zone)
returns text as $$
declare
        epoch_interval integer := extract(epoch from stopped - started);
        hours integer   := floor(epoch_interval/3600);
        minutes integer := floor((epoch_interval-hours*3600)/60);
        seconds integer := floor((epoch_interval-hours*3600-minutes*60));
begin
      return hours::text || ':' ||
             to_char(minutes, 'FM00') || ':' ||
             to_char(seconds, 'FM00');
end;
$$ language plpgsql; 
```

# linux - 在 Windows 操作系统上运行用 linux 编写的 Shell 脚本

> ID：10587261
> 
> 赞同：2
> 
> 时间：2012-05-14T16:22:14.567
> 
> 标签：linux, bash, shell, scripting, cygwin

我有用 RedHat OS 编写的 shell 脚本。我需要在 windows environemtn 中运行这个脚本。

所以我用cygwin在windows上运行脚本。

但是当我使用运行脚本时

```
sh housekeeper.sh 
```

它给了我以下在 RedHat OS 中未返回的错误

```
line 12: $'\r': command not found 
```

但是我脚本的第 12 行是空的

```
 08  #
  09  ######################################################################
  10  #### PARAMETERS TO SET BEGIN
  11  ######################################################################
  12  
  13  # archive setttings
  14  ARCHIVE_USER=abc                      # archive storage user name  (default)
  15  ARCHIVE_GROUP=app                     # archive storage user group (default)
  16  ARCHIVE_PATH=/test/file               # archive storage directory (default)
  17  ARCHIVE_DELAY=+8 
```

谁能告诉我这里的脚本或这里的 cygwin 有什么问题。

提前感谢您的帮助

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-14T16:29:35.810

cygwin 最有可能`sh`期待一个 UNIX 行分隔符（即`\n`），但却找到了一个 Windows 行分隔符 , `\r\n`，因此它试图`\r`像命令一样执行。如果您在基于 Windows 的文本编辑器中编辑此脚本，这很容易发生。

如果你有命令`dos2unix`，你可以使用它，或者`tr`删除`\r`s：

```
tr -d '\r' < old.sh > new.sh 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T16:24:13.063

在 Windows 上对此文件运行`dos2unix`命令，然后尝试运行此文件

# php - 使用php从数据库中的列中删除逗号分隔值的函数

> ID：10587264
> 
> 赞同：0
> 
> 时间：2012-05-14T16:22:21.190
> 
> 标签：php, mysql

我的数据库中有一个表，其中包含两个字段，例如 UserID 和 MovieID。我在 php 中编写了一个用于插入和更新表的函数，其中 MovieIDs 是可能包含许多由逗号分隔的值的字段，同样需要一个从表中删除值的函数，我用于插入和更新的函数表中的值如下所示：

```
<?php

addmovietowatchlist(2,36546436);

function addmovietowatchlist($userid, $movieid)
{
  $con=mysql_connect('localhost','username','password');
if(!$con)
{
    die('could nt connect 2 the server');
}
mysql_select_db("database", $con);

$useriddb = mysql_query("select MovieIDs from tbl_user_watchlist WHERE UserID = ".$userid);
$count = mysql_num_rows($useriddb);
if($count>0)
{
$mids=mysql_fetch_assoc($useriddb);
$listarr=explode(",",$mids['MovieIDs']);

array_push($listarr, $movieid);
$finallist=implode(",",$listarr);

//update
$result = mysql_query("UPDATE tbl_user_watchlist SET MovieIDs = '".$finallist."' WHERE  UserID = ".$userid);
  if($result)
  echo "updated sucessfully";
}
else{
//insert
$result = mysql_query("INSERT INTO tbl_user_watchlist (UserID,MovieIDs) values (".$userid.",'".$movieid."')");
  echo "inserted successfully";
}

}
?> 
```

现在，如果已经在该行中插入了一个值，我需要编写一个函数来从表中删除值以及逗号...任何人都可以帮助我编写代码...我尝试编写以下代码但是它不起作用..请帮助我摆脱这个..

```
function deletemovietowatchlist($userid, $movieid)
{
  $con=mysql_connect('localhost','username','password');
if(!$con)
{
    die('could nt connect 2 the server');
}
mysql_select_db("database", $con);

$useriddb = mysql_query("select MovieIDs from tbl_user_watchlist WHERE UserID = ".$userid);
$count = mysql_num_rows($useriddb);
if($count>0){
$mids=mysql_fetch_assoc($useriddb);
$listarr=implode(",",$mids);
//echo $listarr;
//array_pop($listarr, $movieid);
$finallist=explode(",",$listarr);
echo $finallist;
$result = mysql_query("DELETE MovieIDs FROM tbl_user_watchlist WHERE UserID=".$userid);
  if($result)
  echo "deleted  successfully";
}

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T17:45:25.580

正确的做法是将事物分成两个表。一个人会保存当前表中的所有信息，但它不会保存逗号分隔的列表。相反，另一个表将有两列，一列指定它属于哪个列表（例如，第一个表中行的 ID ......或者如果用户的列表永远不会超过一个，您可以只使用 userid），并且然后是电影的专栏。

也就是说，如果更改当前系统的工作量太大和/或您被束缚并决心坚持使用低效且低效的数据库结构，则可以在当前设置中使用此功能。基本上，您需要找到所有对您关注的 movieid 的引用，然后手动调整与这些匹配项对应的列表，然后使用新列表更新所有这些行。这是很多额外的代码并浪费了大量的处理时间（以至于随着应用程序的增长，它可能成为您的应用程序的主要瓶颈），但这是可能的。

进行调整的最简单方法是对现有列表进行字符串替换。因此，一旦您选择了当前列表，请执行以下操作：

```
$newList = str_replace($movie_id_to_delete.",", "", $oldList);

$result = mysql_query("UPDATE tbl_user_watchlist SET MovieIDs = '".$newList."' WHERE MovieIDs ='".$oldList."' AND UserID = ".$userid); 
```

根据您的实现，检查是否`$newList`为空并删除整行（而不是像我上面那样更新 MovieID）可能是有意义的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-04-15T22:10:08.400

使用 php 或任何其他语言可以通过单个查询来完成，您只需要运行如下所述的单个查询，查询的详细参考在链接 [中从 SET 字段中删除值的最佳方法？](https://stackoverflow.com/questions/14642658/the-best-way-to-remove-value-from-set-field)

查询应该是这样的，它涵盖 ,value 或 value，或仅包含逗号分隔列中的值

```
更新你的表
放
  类别 =
    修剪（两个'，'从
      代替（
        REPLACE(CONCAT(',',REPLACE(col, ',', ',,'), ','),',2,', ''), ',,', ',')
    )
在哪里
  FIND_IN_SET('2', 类别)

```

在这里，您可以在 where 子句中找到您的条件。有关更多详细信息，请参阅上面的链接。

# iphone - double free*** 在 malloc_error_break 中设置断点以在 ARC 中调试

> ID：10587266
> 
> 赞同：4
> 
> 时间：2012-05-14T16:22:32.710
> 
> 标签：iphone, multithreading, automatic-ref-counting, autorelease, double-free

我在我的应用程序中使用 ARC 处理核心数据和线程等，在做了所有努力使核心数据与线程一起工作而没有任何崩溃之后，现在我遇到了一个新的崩溃，原因是 -

```
double free*** set a breakpoint in malloc_error_break to debug 
```

我该怎么处理这个？我无法控制对象的保留计数。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-15T04:47:06.347

1.  启用僵尸
2.  请点击此链接：http: [//iphone2020.wordpress.com/2012/02/23/capturing-exceptions-while-debugging/](http://iphone2020.wordpress.com/2012/02/23/capturing-exceptions-while-debugging/)。这将建议确切的崩溃点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T19:52:41.603

**如果你想知道是谁破坏了分配：**

简单地按照信息提示的方式进行破坏将为您提供线索。

**如果您想知道谁创建了分配：**

虽然您也可以使用 malloc 堆栈日志从命令行执行此操作，但它可能是使用 Instruments 的更温和的介绍。在工具中启用分配记录的情况下运行程序，重现问题，然后在工具中查找双重释放的地址——它将向您显示分配创建的回溯。然后弄清楚为什么该分配被释放了两次。

# android - 在 Android 中设置微调器控件的上下文

> ID：10587272
> 
> 赞同：0
> 
> 时间：2012-05-14T16:22:41.727
> 
> 标签：android, android-intent, android-spinner, android-context

我已经[将此处描述](http://ericharlow.blogspot.com/2010/09/experience-multiple-android-activities.html)`TabActivity`的解决方案组合在一起，但当然，由于它是一种 hacky 方法，因此存在涉及控件上下文的问题。特别是，对话框和微调器在运行时表现不佳并在运行时崩溃，因为上下文是错误的。我希望我的上下文是，但我不知道在它的构造函数之外设置微调器上下文的方法。我此时没有显式调用构造函数，因为我正在使用. 有什么方法可以调整's 的上下文吗？这是我当前的代码：`Spinner``getParent()``findViewById``Spinner`

```
 categorySpinner = (Spinner) findViewById(R.id.spinner_category);
    categoryAdapter = new ArrayAdapter<String>(this, android.R.layout.simple_spinner_item, list3);
    categoryAdapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
    categorySpinner.setAdapter(categoryAdapter);

    categorySpinner.setOnItemSelectedListener(this); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T18:01:21.187

getActivity() 在这些情况下是你的朋友。这将让您将上下文设置为当前活动。

# c# - 以管理员权限执行方法的最简单方法是什么？

> ID：10587275
> 
> 赞同：2
> 
> 时间：2012-05-14T16:23:01.320
> 
> 标签：c#, .net, process, administration

我目前只是在一个新进程中调用我自己的程序：

```
MyProcessStartInfo.Verb = "runas";
MyProcessStartInfo.Arguments = "MyFlag"; 
```

当进程开始时，我检查标志。如果它在那里 - 我只是执行该方法并`Close();`

但如果可以简单地完成，我宁愿做一些更简约的事情。那可能吗？

编辑：使用 Vista 和 Windows7。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T16:34:54.237

您不能提升正在运行的进程。这*根本*不可能。您正在以正确的方式执行此操作，方法是生成另一个具有更高权限的进程。没有其他办法。

> 谢谢。但我在想也许有一种方法可以将一种方法作为一个新过程来启动。

您可以创建一个单独的应用程序可执行文件，其中包含您的方法，然后您无需重新启动应用程序。您只需要启动其他进程。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T16:34:06.833

它不是简约的，但您可以使用我从网络上的来源制作的这个属性。其中一些调用是 pInvoke 的。所以谷歌'pinvoke方法'找到它们。

```
public static bool IsRunAsAdministrator
{
    get
    {
        WindowsIdentity windowsIdentity = WindowsIdentity.GetCurrent();
        if (windowsIdentity.IsSystem) return true;

        WindowsPrincipal windowsPrincipal = new WindowsPrincipal(windowsIdentity);
        if (windowsPrincipal.IsInRole(WindowsBuiltInRole.Administrator))
            return true;

        //Vista or higher check
        if (Environment.OSVersion.Version.Major >= 6)
        {
            IntPtr hToken = IntPtr.Zero;
            try
            {
                if (!OpenProcessToken(GetCurrentProcess(), TOKEN_QUERY, out hToken))
                    Win32.ThrowLastError();

                TOKEN_ELEVATION_TYPE elevationType;
                IntPtr pElevationType = Marshal.AllocHGlobal(sizeof(TOKEN_ELEVATION_TYPE));
                uint dwSize;

                if (!GetTokenInformation(
                    hToken,
                    TOKEN_INFORMATION_CLASS.TokenElevationType,
                    pElevationType,
                    sizeof(TOKEN_ELEVATION_TYPE),
                    out dwSize
                    ))
                    Win32.ThrowLastError();

                elevationType = (TOKEN_ELEVATION_TYPE)Marshal.ReadInt32(pElevationType);
                Marshal.FreeHGlobal(pElevationType);

                return elevationType == TOKEN_ELEVATION_TYPE.TokenElevationTypeFull;
            }
            finally
            {
                CloseHandle(hToken);
            }
        }
        else
            return true;
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T17:34:43.190

您可以使用 Windows API `LogonUser`，然后模拟另一个用户以该用户的身份运行一段代码。不过有一个限制。启用 UAC 后，`LogonUser`您将获得受限用户令牌，这意味着模拟用户（甚至管理员）永远不会获得比您已经拥有的更多权限。此限制不适用于非交互式会话（Windows 服务）。

这是有关如何在代码中模拟的[文档。](http://msdn.microsoft.com/en-us/library/w070t6ka.aspx)此外，您可能会发现[这个 SO 问题/答案](https://stackoverflow.com/questions/5098121/how-can-i-get-elevated-permissions-uac-via-impersonation-under-a-non-interacti)很有趣。

# asp.net - 在 Sql 数据库中导入和存储图像的 URL - 需要建议

> ID：10587281
> 
> 赞同：0
> 
> 时间：2012-05-14T16:23:30.893
> 
> 标签：asp.net, sql-server, image, hierarchical-data, url-scheme

我在一家公司工作，该公司拥有数千份文档，主要是 pdf，存储在其网络服务器上的文件夹中。它们主要是他们所携带的不同品牌的不同产品的用户手册和技术文档。他们有一个网页，通过递归地遍历它们，当前显示文件夹中所有文档的链接，然后根据文件路径为每个图像生成一个 URL。

经理担心任何时候有人更改保存图像的服务器上的顶级文件夹的名称，它基本上会“破坏”代码，因为这些顶级名称在应用程序中是硬编码的。他希望将所有 URL 都存储在数据库中以缓解此问题，并要求我将 Web 服务器上的当前文件夹结构复制到 SQL 数据库中，然后将所有 URL 放入该数据库中。从我所做的研究来看，在关系数据库中实现这样的层次结构并非易事，而且我不是 DBA - 我是 Web 开发人员。

所以我现在的问题实际上是如何将当前在 Web 服务器上的所有数千张图像的 URL 获取到数据库中？我在想也许只创建一个名为“Brands”的简单表，其中包含品牌的根 URL，然后是另一个名为“Image links”或类似的表，然后编写一个小实用程序来简单地遍历所有图像 URL 和将它们插入该表 - 这听起来像是要走的路吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T17:39:41.600

在我看来，您可以使用用 C# 或 PowerShell 编写的简单命令行程序轻松导入所有文件夹和文件名，该程序从根目录开始并迭代所有文件夹和文件。你可以有这样的表：

```
CREATE TABLE dbo.Folders
(
  FolderID   INT IDENTITY(1,1) PRIMARY KEY,
  ParentID   INT NULL FOREIGN KEY REFERENCES dbo.Folders(FolderID),
  FolderName NVARCHAR(255) NOT NULL
  -- , ... other columns ...
);

CREATE TABLE dbo.Documents
(
  DocumentID INT IDENTITY(1,1) PRIMARY KEY,
  FolderID   INT NOT NULL FOREIGN KEY REFERENCES dbo.Folders(FolderID),
  DocName    NVARCHAR(255) NOT NULL
  -- , ... other columns ...
); 
```

[您可以使用Directory.GetFiles()](http://msdn.microsoft.com/en-us/library/07wt70x2.aspx)之类的内容填充表格，这将允许您遍历文件夹和文件。您还可以编写一个函数来展平路径，这样您就不必在构建路径时遍历整个层次结构 - 但基于上述内容，重命名文件夹并且仍然始终生成正确的路径而不进行更新应该是非常简单的*每个*文件（尽管您必须更改文件夹并更新数据库并使它们保持同步）。只是一个带有一些虚构数据的例子：

```
INSERT dbo.Folders(ParentID, FolderName) SELECT NULL, N'root';
INSERT dbo.Folders(ParentID, FolderName) SELECT 1, N'sub1';
INSERT dbo.Folders(ParentID, FolderName) SELECT 1, N'sub2';
INSERT dbo.Folders(ParentID, FolderName) SELECT 2, N'subsub1';
INSERT dbo.Folders(ParentID, FolderName) SELECT 4, N'subsubsub1';

INSERT dbo.Documents(FolderID, DocName) SELECT 5, N'foo.pdf';
INSERT dbo.Documents(FolderID, DocName) SELECT 5, N'bar.pdf'; 
```

在给定 DocumentID 的情况下，这是一个可以展平路径的函数：

```
CREATE FUNCTION dbo.ShowFullPath
(
    @FolderID int,
    @DocName  nvarchar(255)
)
RETURNS nvarchar(max)
AS
BEGIN
    DECLARE @FullPath nvarchar(max);

    ;WITH cte AS 
    (
      SELECT FolderID, FolderName, ParentID, rn = 1
        FROM dbo.Folders
        WHERE FolderID = @FolderID
      UNION ALL
      SELECT parent.FolderID, parent.FolderName, 
          parent.ParentID, child.rn + 1
        FROM dbo.Folders AS parent
        INNER JOIN cte AS child
        ON parent.FolderID = child.ParentID
    )
    SELECT @FullPath = STUFF((SELECT N'/' + FolderName 
       FROM cte ORDER BY rn DESC 
       FOR XML PATH(''),
       TYPE).value(N'./text()[1]', N'nvarchar(max)'), 1, 1, N'')
       + N'/' + @DocName
    FROM cte;

    RETURN(@FullPath);
END
GO 
```

因此，当您需要检索给定文档的路径时，您始终可以在运行时调用它（并且您可以更改一个函数或添加一个采用 DocumentID 的包装器，并提供 FolderID 和 DocName 参数），但它可能会做更多为此只使用计算列是有意义的（不幸的是，您将无法保留该列）。

```
ALTER TABLE dbo.Documents ADD FullPath 
  AS CONVERT(NVARCHAR(MAX), dbo.ShowFullPath(FolderID, DocName));

SELECT DocumentID, FolderID, DocName, FullPath FROM dbo.Documents; 
```

结果：

```
DocumentID FolderID DocName FullPath
1          5        foo.pdf root/sub1/subsub1/subsubsub1/foo.pdf
2          5        bar.pdf root/sub1/subsub1/subsubsub1/bar.pdf 
```

或者您可以创建一个视图：

```
CREATE VIEW dbo.vDocuments
AS
  SELECT DocumentID, FolderID, DocName, dbo.ShowFullPath(FolderID, DocName)
  FROM dbo.Documents; 
```

# jquery - 更改 jquery 中的类

> ID：10587286
> 
> 赞同：0
> 
> 时间：2012-05-14T16:23:49.263
> 
> 标签：jquery

我希望摆脱我们当前根据样式的菜单并在它的位置使用 jquery。问题是我们当前的代码使用我们在查询字符串中传递的值来告诉菜单应该打开哪个部分以及应该突出显示该部分中的哪些项目。我一直在尝试使用 jquery 来完成此任务，但我是 jquery 的新手并且正在跌跌撞撞。我已经看到了很多根据样式菜单的示例，但是没有一个允许我传递部分和行以突出显示。

所以我找到了一个使用 jquery 的简单风格菜单，我想如果我有一个无序列表，像这样

```
<ul id="accordion">
        <li>
            <div>
                Sports</div>
            <ul>
                <li><a href="#">Golf</a></li>
                <li><a href="#">Cricket</a></li>
                <li><a href="#">Football</a></li>
            </ul>
        </li>
        <li>
            <div>
                Technology</div>
            <ul>
                <li><a href="#">iPhone</a></li>
                <li><a href="#" id="c23">Facebook</a></li>
                <li><a href="#">Twitter</a></li>
            </ul>
        </li>
        <li>
            <div>
                Latest</div>
            <ul>
                <li><a href="#">Obama</a></li>
                <li><a href="#">Iran Election</a></li>
                <li><a href="#">Health Care</a></li>
            </ul>
        </li>
    </ul> 
```

我应该，使用 jquery 能够执行 $('accordion').find('c23') 并能够向上滑动本节并高亮 href .. 但我无法弄清楚执行此操作的代码.. .这是我到目前为止获得相应效果的内容

```
 $("#accordion > li > div").click(function () {

            if (false == $(this).next().is(':visible')) {
                $('#accordion ul').slideUp(300);
            }
            $(this).next().slideToggle(300);
        }); 
```

这是我在[http://viralpatel.net/blogs/2009/09/create-accordion-menu-jquery.html](http://viralpatel.net/blogs/2009/09/create-accordion-menu-jquery.html)找到的一些代码...

无论如何..希望jquery的人能够帮助我。

谢谢香农

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T16:34:25.147

我认为您的问题主要在于您在查找代码中缺少“#”，并且您没有访问父元素。这是一个固定的例子：

```
var wanted_id = 'c23'; // This is the bit you'd get off the querystring.

$(document).ready(function ( ) {
    $("#accordion > li > div").click(function () {

            if (false == $(this).next().is(':visible')) {
                $('#accordion ul').slideUp(300);
            }
            $(this).next().slideToggle(300);
    });

    // This is the bit that handles the highlighting and automatic opening
    $('#accordion').find('#'+wanted_id).css('background-color','blue'); 
    $('#accordion').find('#'+wanted_id).parent( ).parent( ).slideToggle(300);

}); 
```

​您可以在 jsfiddle 进行测试：http: [//jsfiddle.net/DkZYb/1/](http://jsfiddle.net/DkZYb/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T16:38:07.123

jquery UI Accordion（可能还有许多其他手风琴插件）提供了一些事件，只要您的手风琴中的当前项目发生更改，就会触发这些事件。您可以处理这些事件并在那里突出显示您的项目。这更容易，更清洁等。

请参阅此事件部分：http: [//jqueryui.com/demos/accordion/](http://jqueryui.com/demos/accordion/)

```
$( ".selector" ).bind( "accordionchange", function(event, ui) {
  $(ui.newContent).find("<item to highlight selector").addClass(".highlighted");
}); 
```

# java - 需要一个用于远程方法调用的 RpcDispatcher 示例

> ID：10587287
> 
> 赞同：0
> 
> 时间：2012-05-14T16:23:49.433
> 
> 标签：java, methods, call, jgroups

我正在编写一个将使用 Jgroups 的 Java 应用程序。我已经下载了 JGroups jar，从基本功能的角度来看，一切看起来都不错。我能够创建一个简单的集群，然后通过 JChannel 调用在连接/加入集群的其他 Java 程序中启动多个 Java JVM/节点。但是，我似乎无法让 callRemoteMethods 工作。这是交易。我有一个主 Java 应用程序，我想在一个由 java 命令启动的 JVM 中启动它。然后我想让那个主 Java 应用程序通过 jgroups 启动另一个 JVM，并在第二个 JVM 中启动一个在我的主 Java 应用程序中编码的方法。Jgroup手册中的例子不是很好，不幸的是网上的例子很少。

任何例子将不胜感激。

谢谢，

——贾斯汀

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T06:20:51.343

JGroups 附带了大量测试来展示如何使用 RpcDispatcher，例如 - [https://github.com/belaban/JGroups/blob/master/tests/junit/org/jgroups/blocks/RpcDispatcherUnitTest.java](https://github.com/belaban/JGroups/blob/master/tests/junit/org/jgroups/blocks/RpcDispatcherUnitTest.java) - [https://github .com/belaban/JGroups/blob/master/tests/junit/org/jgroups/blocks/RpcDispatcherTest.java](https://github.com/belaban/JGroups/blob/master/tests/junit/org/jgroups/blocks/RpcDispatcherTest.java)

该手册还在[http://www.jgroups.org/manual-3.x/html/user-building-blocks.html#RpcDispatcher中显示了一个示例](http://www.jgroups.org/manual-3.x/html/user-building-blocks.html#RpcDispatcher)

# java - 将线程与 Google Places API 一起使用

> ID：10587288
> 
> 赞同：2
> 
> 时间：2012-05-14T16:23:52.023
> 
> 标签：java, multithreading

我正在尝试使用 Google Places API： [https ://developers.google.com/maps/documentation/places/](https://developers.google.com/maps/documentation/places/)

我正在用多个线程在 Java 中实现。这个想法是在给定地址周围获取多个 POI（兴趣点：药房、学校、公园等）。因此，我使用例如 52 个线程同时为给定地址并行获取 52 个 POI。

我的问题是：这是否违反了 Google 的政策，或者是否会被 Google 视为入侵，因为我在文档中找不到任何反对它的内容。??

我正在尝试开发一个长期使用的应用程序，我不想因为使用多线程而被放弃。

谢谢

~ 导航

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T16:43:04.693

我知道的唯一限制是您不能在 24 小时内使用相同的 API 密钥发送超过 1000 个请求（除非您付费），但是使用多线程或不发送请求不会有任何区别。

# c# - LocalStorage 错误 - 值不在预期范围内

> ID：10587292
> 
> 赞同：0
> 
> 时间：2012-05-14T16:23:57.640
> 
> 标签：c#, windows-phone-7, local-storage, appsettings

我正处于完成我的第一个 WP7 应用程序的阵痛中，现在我遇到了一个刚刚弹出的奇怪错误。

当我将数据保存回本地存储（添加模式）时，我收到一条错误消息，提示**“值不在预期范围内”** 这仅适用于新的关键项目，更新工作正常。

有人有任何想法或想法吗？

```
 // -----------------------------------------------------------------------------
    //Setting the fileName
    // IsolatedStorageSettings appSettings = IsolatedStorageSettings.ApplicationSettings;
    // -----------------------------------------------------------------------------

    // -------------------------------Local Storage----------------------------------------------
    public void setLocalStorage(string key, object value) {
        try
        {
            // add new Anchorage/drift values
            appSettings.Add(key, value);
        }
        catch (ArgumentException ex)
        {
            MessageBox.Show("An error occurred during writing the key " + key + ex, "ERROR", MessageBoxButton.OK);
        }
    } 
```

//------------------------------------------------ --------------------------------- 在此先感谢菲尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T18:20:00.303

如果您尝试使用已经存在的密钥添加项目，您会得到这个。

当密钥已经存在时，请确保您没有尝试添加。

使用设置字典的一般模式是创建一个单独的方法来添加或更新，并在内部检查键的存在，然后根据需要添加或更新条目。

# sql-server-2005 - SQL Select：多个客户有多个订单行。列出每个客户和 true false 是否订购了某些行

> ID：10587298
> 
> 赞同：1
> 
> 时间：2012-05-14T16:24:21.580
> 
> 标签：sql-server-2005, select

我有一个 SQL Server 2005 表，其中列出了客户及其订单行，如下所示...

```
Cust  | Code 
Cust1   N001
Cust2   N001
Cust2   N003
Cust2   N004
Cust3   N001
Cust3   N002
Cust3   N003
Cust3   N004 
```

我需要结果来列出每个客户（一次）以及他们是否订购了 N002 和 N004 之间的任何物品。因此，结果看起来像这样......

```
Cust  | Ordered?
Cust1   False
Cust2   True
Cust3   True 
```

我尝试了 All / ANY 等的各种组合。我得到的最接近的是使用两个查询。首先，我将添加以下内容以在每一行的末尾添加一个真/假语句......

```
SELECT 
    Cust, Code, 
    CASE 
        WHEN Code BETWEEN 'N002' AND 'N004' THEN 'True' 
        ELSE 'False' 
    END AS Expr1 
```

这给出了以下...

```
Cust  | Code | EXPR1
Cust1   N001   FALSE
Cust2   N001   FALSE
Cust2   N003   TRUE
Cust2   N004   TRUE
Cust3   N001   FALSE
Cust3   N002   TRUE
Cust3   N003   TRUE
Cust3   N004   TRUE 
```

然后使用第二个查询并对我得到的结果进行分组

```
Cust  | Ordered?
Cust1   False
Cust2   False
Cust2   True
Cust3   False
Cust3   True 
```

那么任何人都可以帮助实现简单...

```
Cust  | Ordered?
Cust1   False
Cust2   True
Cust3   True 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T16:33:52.200

我假设您有某种客户表。如果是这样，这可以通过以下方式轻松实现：

```
SELECT Customer.id, 
CASE WHEN DidOrder.customerId IS NOT NULL THEN true ELSE false END as ordered
FROM Customer
LEFT JOIN (SELECT DISTINCT customerId
           FROM OrderLine
           WHERE code >= 'N002' 
           AND code < 'N005') DidOrder
ON DidOrder.customerId = Customer.id 
```

这将检查所有客户，无论他们是否有订单。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T16:30:00.257

我的解决方案是添加一个变量，指定值是否在范围内，然后在 case 语句中检查：

```
SELECT Cust,
       (case when sum(inrange) > 0 THEN 'True' ELSE 'False' END) AS count
from (select t.*,
             (case when code between 'N002' and 'N004' then 1 else 0 end) as inrange
      from t
     ) t
group by cust 
```

如果您不关心代码的可读性，您实际上可以将两个 case 语句合二为一。

# ruby-on-rails - has_one through 是否不提供`create_child` 方法？

> ID：10587306
> 
> 赞同：2
> 
> 时间：2012-05-14T16:24:51.087
> 
> 标签：ruby-on-rails, activerecord, ruby-on-rails-3.1, associations, polymorphic-associations

我有以下型号：

```
class User < ActiveRecord::Base
  has_one :image_assignment, as: :imageable
  has_one :image, through: :image_assignment
end

class ImageAssignment < ActiveRecord::Base
  belongs_to :image
  belongs_to :imageable, polymorphic: true
end

class Image < ActiveRecord::Base
  mount_uploader :image, ImageUploader
end

u = User.new
u.create_image #=> undefined method `create_image' 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T19:40:12.387

这是正确的。您需要先构建/创建 image_assignment

```
u.create_image_assignment
u.image_assignment.create_image 
```

# numpy - 在具有多个条件的 numpy 数组中查找元素

> ID：10587307
> 
> 赞同：1
> 
> 时间：2012-05-14T16:24:53.453
> 
> 标签：numpy, python-3.x

如何在 Numpy 数组中找到满足多个条件的元素的索引？

示例：该函数`numpy.nonzero`让我根据某些标准找到索引：

```
In [1]: from numpy import *
In [2]: a = array([1,0,1,-1])
In [5]: nonzero(a != 0)
Out[5]: (array([0, 2, 3]),) 
```

但是，像这样给出多个标准是行不通的：

```
In [6]: nonzero((a != 0) and (a < 0))
---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
/Users/cls/<ipython-input-6-85fafffc5d1c> in <module>()
----> 1 nonzero((a != 0) and (a < 0))

ValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all() 
```

在 MATLAB 中，可以这样写：

```
find((d != 0) & (d < 0)) 
```

我怎么能用 Numpy 做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-14T16:28:43.037

IIUC，您可以使用`&`代替`and`：

```
>>> from numpy import *
>>> a = array([1,0,1,-1])
>>> nonzero(a!=0)
(array([0, 2, 3]),)
>>> nonzero((a != 0) and (a < 0))
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
ValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()
>>> nonzero((a != 0) & (a < 0))
(array([3]),)
>>> where((a != 0) & (a < 0))
(array([3]),) 
```

# java - 是否可以在 GEF / GMF 项目中使用 JUNG/Graphviz 布局/排列功能？

> ID：10587310
> 
> 赞同：0
> 
> 时间：2012-05-14T16:24:54.667
> 
> 标签：java, graphviz, jung, eclipse-gef, eclipse-gmf

我想构建一个绘制和修改图形的图形编辑器。GEF 提供的“自动排列”功能有点过于简单且不可定制。是否可以将 JUNG/Graphviz 自动布局和/或排列功能放入我的 GEF 编辑器中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T06:25:43.333

关于 JUNG，没有问题，但您必须实现以下代码：

1.  调用布局算法的 GEF 操作。
2.  将您的模型转换为 JUNG 使用的模型。
3.  从 JUNG 读取布局算法的结果并更改模型（当然是使用命令）。

# jquery - 显示溢出：点击时隐藏的 DIVS

> ID：10587312
> 
> 赞同：0
> 
> 时间：2012-05-14T16:24:59.597
> 
> 标签：jquery

我在这里看到过类似的问题，但我似乎找不到适合我想要的方法的问题。可能是因为我对 jQuery 知之甚少。

基本上是这样的。我有一个包含 10 个 DIVS 的页面，例如 #page1 到 #page10。我将溢出设置为隐藏，因此只有第一个 DIV，#page1 显示在视口上。有没有办法在点击时显示连续的下一个和上一个 DIV .. 说在某处有一个“上一个”和“下一个”链接？

*编辑*

我最初的想法是隐藏 DIV 溢出并滚动到 DIV，但发现@Steve 给出的解决方案正是我所需要的。对于溢出隐藏解决方案，@VisioN 解释了一种方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T16:46:01.143

首先，您说溢出：隐藏.....您实际上是指可见性：隐藏还是显示：无？

我用 display none 做了一个例子。

[http://jsfiddle.net/4HpXz/4/](http://jsfiddle.net/4HpXz/4/)

当您在最后一个 div 上单击“下一步”时当前无法处理，但您可以隐藏下一个链接或使其足够聪明以不隐藏最后一个 div，例如，如果您单击下一个

JS

```
$(function(){

    $('.next').click(function(){
        $('.page.show')
            .removeClass('show')
            .next()
            .addClass('show');   
    });

    $('.prev').click(function(){
        $('.page.show')
            .removeClass('show')
            .prev()
            .addClass('show');   
    });

}); 
```

HTML

```
<div class="page show">Page1</div>
<div class="page">Page2</div>
<div class="page">Page3</div>
<div class="page">Page4</div>
<div class="page">Page5</div>
<div class="page">Page6</div>
<div class="page">Page7</div>
<div class="page">Page8</div>
<div class="page">Page9</div>
<div class="page">Page10</div>​ 
```

CSS

```
.page{
    display: none;
}
.show{
    display: block;
}
​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T16:32:09.487

您可以对这些 div 制作幻灯片效果。

例如：

```
var firstpage = $('#container div#page1'), 
      pgwidth = firstpage.outerWidth();

$('.prevButton').on('click', function() {
  firstpage.animate({
     'margin-left' : '-=' + pgwidth + 'px' // sliding the first div amount of its outerWidth to left
  },300);
});

$('.prevButton').on('click', function() {
  firstpage.animate({
     'margin-left' : '+=' + pgwidth + 'px' // sliding the first div amount of its outerWidth to right
  },300);
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T17:28:36.667

好吧，如果我理解正确，你需要看看[`scrollIntoView()`](https://developer.mozilla.org/en/DOM/element.scrollIntoView)方法。

当您从标题中获取时，它会将元素滚动到视图中。它非常基础，甚至被 IE6 支持。

**演示：http:** [//jsfiddle.net/8D2jB/](http://jsfiddle.net/8D2jB/)

# java - 不能引用非最终变量和定时器

> ID：10587316
> 
> 赞同：0
> 
> 时间：2012-05-14T16:25:12.703
> 
> 标签：java, timer, anonymous-class

我正在尝试编写一个可以更改控件背景的静态类，该控件将传递给参数。所以我做到了：

```
public static void wrong(final Component component) {

        component.setBackground(Color.RED);
        Timer   timer = new Timer(2, wrongAction);

        wrongAction = new ActionListener() {
            @Override
            public void actionPerformed(ActionEvent e) {

                int green = component.getBackground().getGreen();
                int blue = component.getBackground().getBlue();
                component.setBackground(new Color(255, green + 1, blue + 1));
                if (component.getBackground() == Color.WHITE) {
                    timer.stop();
                }
            }
        };

        timer.start();

    } 
```

我有一个错误：

```
Cannot refer to a non-final variable timer inside an inner class defined in a different method 
```

当然，我们可以将 timer 更改为 final，但是在我们这样做之后方法会停止工作。
我试图用谷歌搜索它并在其他 stackoverflow 主题中找到答案，但没有任何帮助。

非常感谢大家提前！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-14T16:43:38.233

问题是您使用了不同的 wrongAction 引用。

```
public static void wrong(final Component component) {

    component.setBackground(Color.RED);
    Timer   timer = new Timer(2, wrongAction);// <-- Here wrongAction is not the one you
                                              // define on the next line

    wrongAction = new ActionListener() { // <-- This is a new ActionListener but Timer
                                         // has no knowledge about it.
        @Override
        public void actionPerformed(ActionEvent e) {

            int green = component.getBackground().getGreen();
            int blue = component.getBackground().getBlue();
            component.setBackground(new Color(255, green + 1, blue + 1));
            if (component.getBackground() == Color.WHITE) {
                timer.stop();
            }
        }
    };

    timer.start();

} 
```

以下代码将立即生效（但我觉得不是很干净，最好将所有这些封装在一个专用对象中，以便 Timer 可以是该类的变量，并且侦听器可以引用它）：

```
public static void wrong(final Component component) {
        class MyActionListener implements ActionListener {
            private Timer timer;

            public void setTimer(Timer timer) {
                this.timer = timer;
            }

            @Override
            public void actionPerformed(ActionEvent e) {

                int green = component.getBackground().getGreen();
                int blue = component.getBackground().getBlue();
                component.setBackground(new Color(255, green + 1, blue + 1));
                if (component.getBackground().equals(Color.WHITE)) {
                    if (timer == null) {
                        System.err.println("This sucks, I got no timer");
                    } else {
                        timer.stop();
                    }
                }

            }
        }
        MyActionListener wrongAction = new MyActionListener();
        component.setBackground(Color.RED);
        Timer timer = new Timer(2, wrongAction);
        wrongAction.setTimer(timer);

        timer.start();

    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T16:34:34.273

wrongAction 是一个内部类，Java 要求外部定义的局部变量必须是 final 才能在内部类中使用：

```
final Timer   timer = new Timer(2, wrongAction);

wrongAction = new ActionListener() {
    //...
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-14T16:40:12.073

您似乎将 wrongAction 传递给计时器构造函数，然后实际初始化它！！！

代码不应该

```
wrongAction = new ActionListener() {...
        }; 
```

高于

```
Timer   timer = new Timer(2, wrongAction); 
```

？？？

当然，你需要 Timer timer =null; 在顶部

已编辑：您如何完全删除 wrongAction 并像这样保持简单-

```
final Timer   timer = new Timer(2, new ActionListener() {
            @Override
            public void actionPerformed(ActionEvent e) {

                int green = component.getBackground().getGreen();
                int blue = component.getBackground().getBlue();
                component.setBackground(new Color(255, green + 1, blue + 1));
                if (component.getBackground() == Color.WHITE) {
                    timer.stop();
                }
            }
        }); 
```

;

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-14T16:49:37.680

您可以在构造函数中传递一个空值，然后添加一个`ActionListener`

```
final Timer timer = new Timer(2,null);

timer.addActionListener(new ActionListener(){
//...
});
timer.start(); 
```

# javascript - Javascript可折叠div不起作用？

> ID：10587317
> 
> 赞同：0
> 
> 时间：2012-05-14T16:25:13.107
> 
> 标签：javascript

我试图切换 div 以使其可见/隐藏。我正在制作一个我想打开但仅在单击时才打开的排行榜。

```
<html>
    <title>test</title>

    <head>
        <script type="text/javascript">
            <!-- the function -->
            function showleaders() {
                if (document.getElementById('leaderboard').style.visibility = "hidden";) {
                    document.getElementById('leaderboard').style.visibility = "visible";
                } else {
                    document.getElementById('leaderboard').style.visibility = "hidden";
                }
            }
        </script>
        <style type="text/css">
            #leaderboard {
                height: 300px;
                width:300px;
                left:0;
                background:red;
                border-radius:20%;
                visibility:hidden;
            }
        </style>
    </head>

    <body>
        <a href="javascript:showleaders();">Leaderboard</a>
        <div id="leaderboard">hello</div>
    </body>

</html> 
```

我究竟做错了什么？我只想让 div 在可见性之间切换

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T16:26:29.183

您需要更改此行中的等号：

```
if(document.getElementById('leaderboard').style.visibility= "hidden";) 
```

为双等号，并去掉分号。尝试这个：

```
if(document.getElementById('leaderboard').style.visibility=="hidden") 
```

单等号*设置*值，双等号*比较*值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T16:28:47.633

尝试这个：

```
function showleaders() {
   if (document.getElementById('leaderboard').style.visibility == "hidden") {
       document.getElementById('leaderboard').style.visibility = "visible";
   } else {
       document.getElementById('leaderboard').style.visibility = "hidden";
   }
} 
```

# jquery - 计算跨度标签的算术平均值

> ID：10587319
> 
> 赞同：0
> 
> 时间：2012-05-14T16:25:16.550
> 
> 标签：jquery, html, average

我正在开发一个图像上传应用程序，用户可以在其中对图像进行评分。

当三个用户给图像打分时，html 看起来像下面的代码，我想做的是从不同的参数（组成、内容、技术）生成算术平均值并将它们展示给用户。

我想我需要执行以下操作（加载页面时）：

1.  从不同的 span 标签中获取值并将它们添加到不同的变量（组成、内容和技术）
2.  将变量中的值除以得分帖子的数量
3.  将值附加到页面

我需要帮助的是找出页面何时加载，以及如何从不同的 span 标签中获取值。

提前致谢！

```
 <div id="scores">
        <strong>User1</strong>
        <span class="composition">1</span>
        <span class="content">2</span>
        <span class="technique">3</span>

        <strong>User2</strong>
        <span class="composition">1</span>
        <span class="content">3</span>
        <span class="technique">4</span>

        <strong>User3</strong>  
        <span class="composition">4</span>
        <span class="content">5</span>
        <span class="technique">4</span>
    </div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T16:32:09.907

尝试这个：

```
function calc(calcValue){
    var result = 0, count = 0;
    var selector = "." + calcValue;
    jQuery(selector).each(function(){ 
         var strValue = jQuery(this).text();
         result += parseInt(strValue);
         count++;
    });
    return result / count;
}

var composition = calc("composition");
var content = calc("content");
var technique = calc("technique");

alert("composition = " + composition);
alert("content = " + content);
alert("technique = " + technique); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T16:30:47.460

当然。

`var somevalue = $('.composition').innerText();`

您可能希望将每个分数包装在具有唯一 ID 的 div 中，以跟踪您的“分数”。

然后像...

```
$('.score').each(function(){
   // Loop through each element with a class of "score".

 var compositionScore = $(this).find('#composition').innerText();
 ........ 
 // do some math or something.
}); 
```

我不会为你写出代码（甚至不确定 100% 你想做什么数学），但有一个很好的起点。

# javascript - 在 Javascript 中转发事件

> ID：10587322
> 
> 赞同：8
> 
> 时间：2012-05-14T16:25:21.103
> 
> 标签：javascript, events

是否有一种简单的方法可以在 Javascript 中“转发”事件？我的最终目标是通过以下方式增强 UI 响应能力：我有一个网站，其中包含向后端数据库提交查询的单个输入文本字段。如果用户在输入字段不在焦点时按下键，我想在文档级别捕获 keypress 事件，并将其转发到输入字段。（这似乎是增强 UI 响应能力的一种相当常见的方法，例如，谷歌在他们的主要搜索网站上就这样做了。）

所以我有一个这样的文本输入字段：

```
<input id="query" onkeydown="f(event)"> 
```

我尝试像这样转发事件：

```
function handler(ev)
{
    var query = document.getElementById("query");
    query.dispatchEvent(ev);
}

document.addEventListener("keydown", handler, false); 
```

现在，忽略 和 的跨浏览器问题`addEventListener`，`dispatchEvent`这甚至在支持这两个功能的 Firefox 上都不起作用。Javascript 解释器抛出异常： `Error: uncaught exception: [Exception... "Component returned failure code: 0x80070057 (NS_ERROR_ILLEGAL_VALUE) [nsIDOMEventTarget.dispatchEvent]"`

那么，甚至可以转发这样的事件吗？还是我需要创建一个新事件`initKeyEvent`，然后将该事件分派给输入元素？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T16:55:09.263

以下是键盘事件的示例：

HTML 文件 ( **index.html** ):

```
<!DOCTYPE html>
<html>
    <head>
        <title>Stackoverflow</title>
        <script type="text/javascript" src="sof.js"> </script>
    </head>
    <body>
        <input id="query" onkeydown="f(event);"/>
    </body>
</html> 
```

Javascript 文件 ( **sof.js** ):

```
function simulateKeyDown () {
    // DOM Level 3 events
    var evt = document.createEvent ("KeyboardEvent");
    // DOM Level 3 events
    evt.initKeyboardEvent ("keydown", false, false, null, false, false, false, false, 0, 0);
    var query = document.getElementById ('query');
    query.dispatchEvent (evt);
}

window.onload = function () {
    document.addEventListener ('keydown', simulateKeyDown, false);
}

function f (ev) {
    console.log ('ciao');
} 
```

如您所见，当窗口被加载时，它会为文档的*keydown*事件附加一个新的处理程序。当一个键被按下时，一个新的*KeyboardEvent*事件被创建，初始化（使用'keydown'），然后被分派到*输入*元素。是的，它有点复杂和复杂，但它很有效；）

欲了解更多信息：

1.  [创建活动](https://developer.mozilla.org/en/DOM/document.createEvent#Notes)
2.  [事件 initKeyEvent](https://developer.mozilla.org/en/DOM/event.initKeyEvent)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T16:37:50.367

我不确定转发，但我认为你不能。然而，我对最初问题的解决方案是

```
document.addEventListener("keydown", function(e) {
    if (e.target.oMatchesSelector("form *, fieldset *, input, textarea"))
        return; // Opera-specific, but I think you get the point of MatchesSelector
    if (e.metaKey || e.ctrlKey)
        return;
    if (e.keyCode < 46 || e.keyCode > 90)
        return;
    document.getElementById("query").focus();
}, false); 
```

keydown 事件不适用于字符输入，因此聚焦输入就足够了 onkeydown - 字符将出现 onkeyup。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-03-03T05:31:43.527

跟进@Bergi的回答，对我有用的解决方案是简单地重定向`focus`- 这样事件就会去你想要的地方！例如：

```
document.addEventListener('keydown', function(evt) {
    document.getElementById('query').focus();
}, false); 
```

这会将所有 keydown 事件重定向到`query`元素。

# php - PHP中的函数超时

> ID：10587323
> 
> 赞同：27
> 
> 时间：2012-05-14T16:25:38.443
> 
> 标签：php, function, foreach, timeout

有没有办法让函数超时？我有 10 分钟的时间来完成一项工作。该作业包括一个 for 循环，这是一个示例：

```
<?php
foreach($arr as $key => $value){
   some_function($key, $value); //This function does SSH and SFTP stuff
}
?> 
```

$arr 有 15 个元素， some_function() 有时可能需要超过 1 分钟。事实上，一旦它被绞死了 5 分钟。

有没有办法让函数调用超时并继续 $arr 中的下一个元素？

谢谢！！

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-05-14T16:27:49.207

这取决于您的实施。PHP 中 99% 的函数都是阻塞的。意思是在当前功能完成之前，处理不会继续。但是，如果函数包含循环，您可以添加自己的代码以在满足特定条件后中断循环。

像这样的东西：

```
foreach ($array as $value) {
  perform_task($value);
}

function perform_task($value) {
  $start_time = time();

  while(true) {
    if ((time() - $start_time) > 300) {
      return false; // timeout, function took longer than 300 seconds
    }
    // Other processing
  }
} 
```

无法中断处理的另一个示例：

```
foreach ($array as $value) {
  perform_task($value);
}

function perform_task($value) {
    // preg_replace is a blocking function
    // There's no way to break out of it after a certain amount of time.
    return preg_replace('/pattern/', 'replace', $value);
} 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2015-05-27T02:46:43.457

您想要的是使用 pcntl_alarm 函数，该函数将在超时时触发 SIGALRM 信号。

例如：

```
// 10 minutes
pcntl_alarm( 600 );
pcntl_signal(SIGALRM, function() { print( "Timed-out!\n" ); exit( 0 ); }); 
```

请参阅此处的 PHP 手册了解更多信息： http: [//php.net/manual/en/function.pcntl-alarm.php](http://php.net/manual/en/function.pcntl-alarm.php)

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-05-14T16:28:16.260

PHP 是单线程的......你必须使用你的操作系统的能力来分叉另一个进程。

我知道如何做到这一点的唯一方法是使用 exec 命令分叉另一个完整进程。把你想要计时的东西放在一个单独的脚本中，在脚本上调用 exec，然后立即休眠 10 分钟。如果在 10 分钟时进程仍在运行，请将其杀死。（您应该通过使命令在后台运行新的 php 代码，通过命令行获取它并从 exec 命令返回它来获得它的 PID）。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-05-14T19:58:33.210

你可以尝试使用'curl'来实现它。Curl——来自 PHP——主要用于做 HTTP/FTP 的东西，但它支持更多的协议，包括 ssh/sftp。我从来没有使用 curl 做过与 ssh/sftp 相关的事情，所以我不能提供任何额外的建议，但你应该能够在 stackoverflow 或其他地方找到更多信息。

您可以使用一个选项“CURLOPT_TIMEOUT”来配置您的请求的超时时间（还有一个选项“CURLOPT_CONNECTTIMEOUT”）。您甚至可以以毫秒为单位指定超时 (CURLOPT_TIMEOUT_MS / CURLOPT_CONNECTTIMEOUT_MS)。

无论如何：对于一个 cronjob，我建议使用一个额外的“锁定文件”你的脚本在它启动时写入并在它完成运行时删除。您可以在脚本中检查此锁定文件，因此如果 cron在上次运行完成*之前*触发您的脚本，您可以直接退出脚本而无需做任何进一步的操作。这确保了您的脚本不会被并行执行多次。

您也可以在 PHP 文档中找到有关 CURL 选项和 CURL 本身的更多信息：

*   [http://www.php.net/manual/en/function.curl-setopt.php](http://www.php.net/manual/en/function.curl-setopt.php)
*   [http://www.php.net/manual/en/book.curl.php](http://www.php.net/manual/en/book.curl.php)

你必须确保你安装的 libcurl 和/或 curl 支持 SSH/SFTP，但是：

*   [来自 PHP 的 SFTP - 未定义的常量 CURLOPT_PROTOCOLS 和 CURLPROTO_SFTP？](https://stackoverflow.com/questions/1766822/sftp-from-php-undefined-constant-curlopt-protocols-and-curlproto-sftp)
*   [来自 PHP 内部的 SFTP](https://stackoverflow.com/questions/717854/sftp-from-within-php)

等等

希望有帮助...

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-05-14T16:29:00.803

在开始进入循环之前，设置一个记住`time()`. 在每次迭代结束时，检查电流`time()`是否大于 60 秒。如果是这样，`break`. 例如：

```
<?php
$startTime=time();
foreach($arr as $key => $value){
    some_function($key, $value); //This function does SSH and SFTP stuff
    if (time()-$startTime>60) break; //change 60 to the max time, in seconds.
}
?> 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-05-14T16:43:42.240

看看[set_time_limit](http://php.net/manual/en/function.set-time-limit.php)。现在函数本身并不是你想要的，因为它只考虑了执行时间，这意味着现实生活中的 5 秒可能仍然只有 0.2 秒的执行时间。但是查看链接的原因是为了评论。用户发布了几个解决方案。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-12-28T23:28:05.813

对于那些在命令行中的人，看看 sleep 是如何被中断的：

```
echo date("H:i:s\n");
pcntl_signal(SIGALRM ,function($signal){
echo "arghhh! i got interrupted \n";
},true);

pcntl_alarm(3);
sleep(20);
pcntl_signal_dispatch();

echo date("H:i:s\n");

pcntl_alarm(3);
sleep(20);

echo date("H:i:s\n");

pcntl_signal_dispatch();
echo "end\n"; 
```

# vba - ByRef 不适用于具有类中值类型的 VBA

> ID：10587324
> 
> 赞同：7
> 
> 时间：2012-05-14T16:25:41.690
> 
> 标签：vba, pass-by-reference

我一直使用`ByRef`成功，直到现在。我需要一个函数来`Double`从类对象修改 a 。为了说明，请考虑以下程序。

```
Class1.cls:
Public d As Double
```

```
Sub Test()
    Dim c As Class1, d As Double
    Set c = New Class1

    c.d = 5
    d = 5

    ChangeVar c.d
    ChangeVar d

    Debug.Print c.d
    Debug.Print d
End Sub

Sub ChangeVar(ByRef d As Double)
    d = 10
End Sub
```

令我惊讶的是，上面的示例将输出

```
5
10 
```

有人吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-14T16:36:31.420

在引擎盖下`aClassInstance.publicVariable`被封装为隐藏属性 get/let 对，因此传递`ByRef`是传递隐藏`get`属性返回值的地址，而不是在类中声明的底层变量。

您可以通过检查`d`类中 2 种形式的地址来测试这一点；他们会有所不同

```
(class_init)
debug.? " d address=" & VarPtr(d)
debug.? ".d address=" & VarPtr(me.d) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-03T22:02:08.760

我自己也遇到了这个问题，它更干净的解决方法是将它变成一个函数

```
Sub Test()     
    Dim c As Class1, d As Double     
    Set c = New Class1      
    c.d = 5     
    d = 5      
    c.d = ChangeVar(c.d)     
    d = ChangeVar(d)     
    Debug.Print c.d     
    Debug.Print d 
End Sub  

Public function ChangeVar(d As Double)     
    ChangeVar = 10 
End Function 
```

# sharepoint - 是否可以在 sharepoint 2010 中获取当前日期？

> ID：10587326
> 
> 赞同：4
> 
> 时间：2012-05-14T16:25:52.540
> 
> 标签：sharepoint, sharepoint-2010

我想将当前日期存储在我拥有的列视图中，然后将其与用户保存的日期进行比较。

是否可以在 sharepoint 2010 中获取当前日期？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-15T03:53:01.100

您可以使用 [今天] 作为视图中的过滤器。例如，对于任务列表，您可以通过设置过滤器“DueDate < [Today]”来过滤过期任务。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-15T16:14:17.617

我在我们公司的博客上写了一篇文章，概述了在这种情况下使用 [Today] 的各种方法，以及为什么 [Today] 在计算列中不可用的一些背景知识：

*警告：这也包含对我们自己的产品的建议*

[如何在共享点列表中使用 [Today]](http://blog.pentalogic.net/2011/05/how-use-today-in-a-sharepoint-list/)

以下是涵盖的主要方法：

*   **JavaScript**：使用内容编辑器 Web 部件
*   **Designer**：在 SharePoint Designer 中创建自定义视图
*   **代码**：从头开始制作您自己的自定义字段类型
*   **SharePoint 荧光笔**：我们自己的问题解决方案

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-21T16:05:36.773

你知道吗：计算字段接受 =Today() 然后选择 datea 类型作为 Date。
经过测试并且可以工作：您可以在 DATEDIF 函数中使用 Today()。然后按预期选择公式输出数据类型，例如，如果预期输出为“D”天，您可以使用数字。 [http://office.microsoft.com/en-us/help/datedif-function-HA001160981.aspx](http://office.microsoft.com/en-us/help/datedif-function-HA001160981.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-15T03:47:51.623

您不能存储当前日期。您可以做的是使用当前日期来过滤查询结果。

# android - 如何在 android 中使 GIF 文件适合屏幕大小

> ID：10587333
> 
> 赞同：3
> 
> 时间：2012-05-14T16:26:31.143
> 
> 标签：android, view, animated-gif

我正在使用电影类播放 gif 动画文件，但无法放入屏幕。

如何将 gif 文件缩放或适合屏幕大小？

我已经使用 Movie 类进行了 GIF 视图自定义视图和播放动画。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-12-28T19:44:54.540

您可以使用以下代码执行此操作：

```
 float scaleWidth = (float) ((screenwidth / (1f*gifwidth)));//add 1f does the trick
    float scaleHeight = (float) ((screenheight / (1f*gifheight)));
    canvas.scale(scaleWidth, scaleHeight);
    mMovie.draw(canvas, 0, 0);//mMovie is my gif picture 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2018-04-13T13:26:04.980

试试这个 GifImageView

# 将电影的高度宽度设置为屏幕高度宽度。

```
 init()
    {
        WindowManager wManager = (WindowManager) getContext().getSystemService(Context.WINDOW_SERVICE);
        Display display = wManager.getDefaultDisplay();
        float screenwidth = display.getWidth();
        float screenheight = display.getHeight();

        mWidth = (int) screenwidth;
        mHeight = (int) screenheight;

        //Then force invalidated the layout of this view.

        requestLayout();
    } 
```

# 当您从 Activity 调用 setGifImageResource() 时，将调用此方法。

活动将如下所示：

```
@Override
    protected void onCreate(Bundle savedInstanceState) 
    {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.myactivity);

        GifImageView gifImageView = (GifImageView) findViewById(R.id.GifImageView);
        gifImageView.setGifImageResource(R.drawable.my_gif);
    } 
```

同样在我们的自定义布局中，我们需要以下内容：

# 确定测量的视图宽度和高度。

```
@Override
protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) {     
        setMeasuredDimension(mWidth, mHeight);
} 
```

# 在画布上绘图时的重要代码。

```
@Override
protected void onDraw(Canvas canvas) {

        //Other general code (included in given link)...

        if (mMovie != null) {

            //Other general code (included in given link)...

            canvas.scale((float) this.getWidth() / (float) mMovie.width(),
                    (float) this.getHeight() / (float) mMovie.height());
            mMovie.draw(canvas, 0, 0);          
            invalidate();
        }
} 
```

我已经根据我们的要求定制了这个视图。

# 检查下面的链接。

[https://github.com/NihalPandya/demoUpload/blob/master/GifImageView.java](https://github.com/NihalPandya/demoUpload/blob/master/GifImageView.java)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-16T07:30:31.307

如果您使用的是画布（@surface 视图），则在游戏循环中获取其高度和宽度，并使用其值绘制背景图像。如果不，

```
WindowManager wm = (WindowManager) context.getSystemService(Context.WINDOW_SERVICE);
Display display = wm.getDefaultDisplay();
float tmp = display.getHeight; 
```

现在 tmp 将包含显示高度的值。宽度的相同猜测。使用这些属性来拉伸 gif。

但是我必须说这个功能已被弃用，必须有更好的方法，但这会很好用:)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-12-28T21:49:18.170

您可以使用逐帧动画而不是动画 gif 来获得类似的最终结果和缩放。您需要从 gif 中提取每个帧，并将单个帧作为 png（或其他支持的格式）文件放在 res/drawable 文件夹中。创建和使用动画drawable：

[http://developer.android.com/reference/android/graphics/drawable/AnimationDrawable.html](http://developer.android.com/reference/android/graphics/drawable/AnimationDrawable.html)

要缩放动画， [请选中此项](https://stackoverflow.com/questions/6020460/android-how-to-maintain-aspect-ratio-in-animation/20765456#20765456 "检查这个")。

您可以使用各种[scaleType](http://developer.android.com/reference/android/widget/ImageView.ScaleType.html "比例尺类型")来使用此方法缩放动画。

我知道这并不能直接回答问题，但它会给出预期的最终结果。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-16T05:06:38.807

我会过去看看[。](http://droid-blog.net/2011/10/14/tutorial-how-to-use-animated-gifs-in-android-part-1/)涵盖 3 种不同方式显示/播放 GIF 的完整教程。显然这不是很容易，谷歌仍然有未解决的问题报告。祝你好运 ：）

# javascript - W3C/PhoneGap FileReader - 如何使用？

> ID：10587338
> 
> 赞同：3
> 
> 时间：2012-05-14T16:26:44.240
> 
> 标签：javascript, cordova, filereader

我正在使用PhoneGap（它实现了一个W3C FileReader 来访问它的文件），并且网上有大量的教程，但它们似乎都导致了死胡同。基本上，他们会向您展示如何设置所有内容，但最终，他们都会到达一个地方，上面写着：

```
myReader.readAsText(file); 
```

我感到困惑的是……那到底是做什么的？它是否返回某种索引数组？我可以使用类似于 while(!feof) 的东西吗？我如何才能真正访问它刚刚读取的内容？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-14T19:01:25.930

这是一个更多的例子：

```
var reader = new FileReader();
reader.onloadend = function(evt) {
    console.log("Read as data URL");
    console.log(evt.target.result);
};
reader.readAsText(file); 
```

因此，如果您在文件完全读取后将 FileEntry 对象传递给 readAsText，您提供的 onloadend 函数将被调用。属性 evt.target.result 将包含您希望阅读的文件的全文。

# iphone - 网站在 Iphone 中未正确放大

> ID：10587344
> 
> 赞同：0
> 
> 时间：2012-05-14T16:27:01.487
> 
> 标签：iphone, css, layout

我在这个问题上摸不着头脑，希望有人能帮助我。该网站是：[http ://highlandsharvest.com](http://highlandsharvest.com)

在 Iphone 上，您会在右侧看到狭窄的黑柱。我想摆脱这个。

我玩弄了“视口”元数据，将宽度更改为网站本身的宽度，但没有好处 - 没有变化。

视口元当前设置为：

```
<meta name = "viewport" content = "width = 960"> 
```

我还应该尝试什么让 Iphone 在网站上正确放大？

提前非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T16:30:43.083

宽度不是 960，高度是。另外，尝试缩放以适应属性

# ruby-on-rails - 我无法生成 rails 项目，Gem::RemoteFetcher::FetchError: Errno::ETIMEDOUT: Operation timed out - connect(2)

> ID：10587348
> 
> 赞同：0
> 
> 时间：2012-05-14T16:27:13.017
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, gem

我正在使用 OS X 10.7、ruby 1.8.7（2010-01-10 补丁级别 249）和 rails 3.2.1、rubygems 1.8.24：

```
➜  code  ruby -v
ruby 1.8.7 (2010-01-10 patchlevel 249) [universal-darwin11.0]
➜  code  gem list | grep rails 
rails (3.2.1, 3.2.0, 3.1.0, 3.0.5)
➜  code  gem list | grep gem   
rubygems-update (1.8.24) 
```

至于 gem 的来源：

```
➜  code  gem sources                                                     
*** CURRENT SOURCES ***
http://gems.rubyforge.org
http://gems.github.com
http://gems.github.com
http://gems.github.com
http://production.s3.rubygems.org
http://production.s3.rubygems.org.s3.amazonaws.com/
http://rubygems.org/ 
```

现在我正在尝试创建一个 rails 项目：

```
➜  code  rails new blogging -d mysql
Using #!/usr/bin/ruby begin require 'hirb' # sudo gem install cldwalker-hirb --source http://gems.github.com Hirb.enable rescue LoadError end def change_log(stream) ActiveRecord::Base.logger = Logger.new(stream) ActiveRecord::Base.clear_active_connections! end def show_log change_log(STDOUT) end def hide_log change_log(nil) end from /Users/Apple/.railsrc
      create  
      create  README.rdoc
      create  Rakefile
      create  config.ru
      create  .gitignore
      create  Gemfile
      create  app
      create  app/assets/images/rails.png
      create  app/assets/javascripts/application.js
      create  app/assets/stylesheets/application.css
      create  app/controllers/application_controller.rb
      create  app/helpers/application_helper.rb
      create  app/mailers
      create  app/models
      create  app/views/layouts/application.html.erb
      create  app/mailers/.gitkeep
      create  app/models/.gitkeep
      create  config
      create  config/routes.rb
      create  config/application.rb
      create  config/environment.rb
      create  config/environments
      create  config/environments/development.rb
      create  config/environments/production.rb
      create  config/environments/test.rb
      create  config/initializers
      create  config/initializers/backtrace_silencers.rb
      create  config/initializers/inflections.rb
      create  config/initializers/mime_types.rb
      create  config/initializers/secret_token.rb
      create  config/initializers/session_store.rb
      create  config/initializers/wrap_parameters.rb
      create  config/locales
      create  config/locales/en.yml
      create  config/boot.rb
      create  config/database.yml
      create  db
      create  db/seeds.rb
      create  doc
      create  doc/README_FOR_APP
      create  lib
      create  lib/tasks
      create  lib/tasks/.gitkeep
      create  lib/assets
      create  lib/assets/.gitkeep
      create  log
      create  log/.gitkeep
      create  public
      create  public/404.html
      create  public/422.html
      create  public/500.html
      create  public/favicon.ico
      create  public/index.html
      create  public/robots.txt
      create  script
      create  script/rails
      create  test/fixtures
      create  test/fixtures/.gitkeep
      create  test/functional
      create  test/functional/.gitkeep
      create  test/integration
      create  test/integration/.gitkeep
      create  test/unit
      create  test/unit/.gitkeep
      create  test/performance/browsing_test.rb
      create  test/test_helper.rb
      create  tmp/cache
      create  tmp/cache/assets
      create  vendor/assets/javascripts
      create  vendor/assets/javascripts/.gitkeep
      create  vendor/assets/stylesheets
      create  vendor/assets/stylesheets/.gitkeep
      create  vendor/plugins
      create  vendor/plugins/.gitkeep
         run  bundle install
Enter your password to install the bundled RubyGems to your system: 
Fetching gem metadata from https://rubygems.org/.........
Using rake (0.9.2.2) 

Gem::RemoteFetcher::FetchError: Errno::ETIMEDOUT: Operation timed out - connect(2) (https://rubygems.org/gems/i18n-0.6.0.gem)
An error occured while installing i18n (0.6.0), and Bundler cannot continue.
Make sure that `gem install i18n -v '0.6.0'` succeeds before bundling. 
```

我手动安装了 i18n，但仍然遇到同样的错误，我向 gem 添加了新资源，但没有运气。

任何帮助将不胜感激。

在此先感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T17:31:17.173

首先，Rails 3.2 是最后一个支持 ruby​​ 1.8 的版本，推荐使用 1.9.2 或 1.9.3。

但是对于您的问题：它看起来像 DNS 问题。`curl`您可以通过/`wget`或您的浏览器（如果是普通计算机）直接访问 ruby​​gems.org吗？

您还可以运行`traceroute rubygems.org`并查看连接失败的位置（我不太确定 OS X 上是 traceroute 还是 tracert）

我的最后一个想法是运行`ping rubygems.org`并尝试运行 traceroute 到返回的 IP

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-02-10T01:05:35.780

如果您的互联网连接有点不可靠，就会发生这种错误。

我发现使用公开可用的 wifi 给了我这个错误，但是当我从智能手机连接时运行 bundle 工作。

# c - 长字符串数据的临时存储

> ID：10587353
> 
> 赞同：1
> 
> 时间：2012-05-14T16:27:23.613
> 
> 标签：c, linux, pipe, std

我正在寻找适当的方法来使用 posix 系统上的标准库使用 C 程序临时存储可能非常大的字符串。该字符串是 C 函数的逐行输出的顶点。在最后一次调用这个函数之后，我想进一步处理（输出）数据。在分配大量内存和创建临时文件之间是否存在简单的折衷？例如，我可以想象在需要数据时写入管道并再次从该管道读取。但我不确定在这种情况下如何在内部处理数据，以及它是否比临时文件更受欢迎。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T16:34:25.210

这主要取决于您需要对数据做什么。如果您需要随机访问它（例如，如果您需要对其进行排序），您可能会发现如果文件都在内存中，这会容易得多，尽管可能会使用大量内存。

特别是如果您能够按顺序访问数据来处理它，如果您希望数据很大，我通常会推荐一个临时文件。

除非您创建另一个线程以在主线程写入数据时从管道中读取数据，否则管道不会帮助您。否则，您将很快填满管道的缓冲区并阻塞（实际上是死锁）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T16:42:47.623

您可以决定（根据您的评论，您应该根据具体情况决定）是将其保存在内存中还是写入磁盘。如果您注意到数据增长超过某个阈值，您将写入磁盘并切换剩余数据的放置方法。

管道不是一个好主意，因为它是一种进程间通信方法，具有非常小的存储大小（自 Linux 2.6 以来约为 64kiB，在 2.4 中，它甚至更少 - 4 kiB 左右）。

# php - 为什么我的脚本没有向我的 ajax 函数返回值？

> ID：10587354
> 
> 赞同：1
> 
> 时间：2012-05-14T16:27:25.050
> 
> 标签：php, ajax

这是我第一次使用ajax。我只是想将变量传递给使用 ajax 发送电子邮件的 php 处理脚本。但是，我没有收到任何从 php 脚本返回到 ajax 的信息来说明它已经成功，即使它成功并且我要求它返回 0 或 1。

我的ajax是：

```
jQuery.ajax({
        //this is the php file that processes the data and send mail
        url: "process.php", 

        //GET method is used
        type: "GET",

        //pass the data         
        data: dataString,     

        //Do not cache the page
        cache: false,

        //success
        success: function (html) {    

        alert(html);

            //if process.php returned 1/true (send mail success)
            if (html==1) {                  
              //hide the form
              jQuery('.form').fadeOut('slow');                 

              //show the success message
              jQuery('.done').fadeIn('slow');

            //if process.php returned 0/false (send mail failed)
            } else alert('Sorry, unexpected error. Please try again later.');               
        }       
      }); 
```

我的PHP是：

```
$username=htmlspecialchars(stripslashes($_GET['username']));
    $telnumber=htmlspecialchars(stripslashes($_GET['telnumber']));
    $email=htmlspecialchars(stripslashes($_GET['email']));
    $numberparty=htmlspecialchars(stripslashes($_GET['numberparty']));
    $message=htmlspecialchars(stripslashes($_GET['message']));
    $to=//myemail address;

    $workshopName=htmlspecialchars(stripslashes($_GET['workshopName']));

    $subject='Booking request for: '.$workshopName;

    $body= "<ul><li>Name:  ".$username."</li>";
    $body.="<li>Email:  ".$email."</li>";
    $body.="<li>Telephone Number:  ".$telnumber."</li>";
    $body.="<li>Number in party:  ".$numberparty."</li>";

    if(!empty($message)){
        $body.="<li>Message:  ".$message."</li>";
    }
    $body.="</ul>";

    function sendmail($to, $subject, $message, $from) {
            $headers = "MIME-Version: 1.0" . "\r\n";
            $headers .= "Content-type:text/html;charset=iso-8859-1" . "\r\n";
            $headers .= 'From: ' . $from . "\r\n";

            $result = mail($to,$subject,$message,$headers);

            if ($result) return 1;
            else return 0;
    }

    $result = sendmail($to, $subject, $body, $email); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-14T16:29:54.933

而不是`return`，用于`echo`将其返回到您的脚本：

```
if ($result) echo 1;
else echo 0; 
```

您也可以缩短它，例如：

```
echo $result ? 1 : 0; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-14T16:30:02.720

`return`使用 AJAX 时，您不需要。你需要`echo`价值观。

```
if ($result) echo 1;
else echo 0; 
```

# android - 列表视图动态按钮

> ID：10587355
> 
> 赞同：0
> 
> 时间：2012-05-14T16:27:25.900
> 
> 标签：android, listview, button, dynamic, broadcastreceiver

我正在使用 java 开发 android 消息传递应用程序，当收到一条消息时我将它的信息插入到数据库中。我想创建一个带有动态按钮的列表视图，每个按钮都包含数据库行中的数据，我需要将按钮的 id 连接到记录的 id，这样我就可以对按钮应用更改，例如使用它的 id 将其删除，并且每次收到消息时我都需要创建一个新按钮。我一直在寻找一些答案，但我没有找到这样的东西..提前谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T16:45:00.463

*   “我想创建一个带有动态按钮的列表视图，每个按钮都包含数据库行中的数据”

您的按钮实际上不需要是动态的，您可以`<Button>`从描述您的`ListView`行的 XML 布局加载。然后，在您的`ListView`适配器`getView() method`中，用于`Button.setTag()`在按钮上放置标签对象，在按钮上设置标题等......这个标签对象可以简单地引用您的数据库`row _ID`。

*   “并且我需要将按钮的 id 连接到记录的 id，以便我可以对按钮应用更改，例如使用它的 id 将其删除”

`Button.getTag()`在按钮处理程序中使用`onClick()`以读取`_ID`并执行您需要的操作。

*   “而且我每次收到消息时都需要创建一个新按钮。”

`DataSetObserver`在适配器上使用 a 。当您收到此消息时调用`notifyDataSetChanged()`您的适配器以强制`ListView`更新自身。

# selenium-webdriver - Selenium - 将 testng 用于 webdriver 测试脚本

> ID：10587360
> 
> 赞同：0
> 
> 时间：2012-05-14T16:27:49.227
> 
> 标签：selenium-webdriver

我正在尝试在我的 selenium webdriver 脚本中使用 testng。

我希望在@BeforeClass 中有页面登录信息并在@AfterClass 中注销信息，以便我登录一次-执行2个测试用例，然后-仅注销一次，而不必在每个@Test期间登录和注销. 但是我不断收到@Test public void test1() 的断言超时错误。

```
@BeforeClass

 driver = new FirefoxDriver();

    driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);

    baseUrl = commInfo.getURL();
    //driver.manage().timeouts().implicitlyWait(30, TimeUnit.SECONDS);

    userID = commInfo.getuiUserID();
    passwd = commInfo.getuiPasswd();

    conn=null;
    stmt=null;
    sql="";
    rs=null;
    segName=null;

    driver.get(baseUrl + "/uiportal/login/Logout.com");
    driver.findElement(By.id("usernameField")).clear();
    driver.findElement(By.id("usernameField")).sendKeys(userID);
    driver.findElement(By.id("textfield2")).clear();
    driver.findElement(By.id("textfield2")).sendKeys(passwd);
    for (int second = 0;; second++) {
        if (second >= 60) fail("timeout");
        try { if (isElementPresent(By.id("submitLink"))) break; } catch (Exception e) {}
        Thread.sleep(1000);
    }

    driver.findElement(By.id("submitLink")).click();

@Test
public void test1() throws Exception {
some test code here
}

@Test
public void test2() throws Exception {
some test code here
}

@AfterClass

public void tearDown() throws Exception {

    for (int second = 0;; second++) {
        if (second >= 60) fail("timeout");
        try { if (isElementPresent(By.partialLinkText("Sign out"))) break; } catch (Exception e) {}
        Thread.sleep(1000);
    }

    driver.findElement(By.partialLinkText("Sign out")).click();

    driver.quit();
    String verificationErrorString = verificationErrors.toString();
    if (!"".equals(verificationErrorString)) {
        fail(verificationErrorString);
    }
} 
```

谢谢

# android - 检测 gps 已禁用

> ID：10587361
> 
> 赞同：0
> 
> 时间：2012-05-14T16:27:50.363
> 
> 标签：android

我有这个代码来获取我的 GPS 位置：

```
 public void run() {

        mLocationManager = (LocationManager)context.getSystemService(Context.LOCATION_SERVICE);

        if (mLocationManager.isProviderEnabled(LocationManager.GPS_PROVIDER)) {

            Looper.prepare();

            mLocationListener = new MyLocationListener();
            mLocationManager.requestLocationUpdates(LocationManager.GPS_PROVIDER, 0, 0, mLocationListener);

            Looper.loop(); 
            Looper.myLooper().quit(); 

        } else {

            //Never be here!!!

        }
}

private Handler handler = new Handler() {
    @Override
    public void handleMessage(Message msg) {
        pd.dismiss();
        mLocationManager.removeUpdates(mLocationListener);

        if (currentLocation!=null) {

                  //found. OK
        }
    }
};

private class MyLocationListener implements LocationListener {
    @Override
    public void onLocationChanged(Location loc) {
        if (loc != null) {
            setCurrentLocation(loc);
            handler.sendEmptyMessage(0);

        }
    }

    @Override
     public void onProviderDisabled(String provider) {
         //If I disable de GPS I have an error
     }

    @Override
    public void onProviderEnabled(String provider) {
        // TODO Auto-generated method stub
    }

    @Override
    public void onStatusChanged(String provider, int status, Bundle extras) {
        // TODO Auto-generated method stub
    }
} 
```

如何检测 GPS 已禁用且查找数据的时间太长？

我认为 onProviderDisabled 检测到该事件，但是，我的代码永远不会去那里。我得到了这个例外：

无法在尚未调用 Looper.prepare 的线程内创建处理程序

先感谢您

# java - 具有 GenericType 的 getEntity

> ID：10587378
> 
> 赞同：0
> 
> 时间：2012-05-14T16:29:15.410
> 
> 标签：java, jersey, generic-list, generic-type-argument

尝试从 REST 服务获取实体。我的代码是这样的：

我想发送这样的对象：`new GenericType<List<MyObject>>() {}`

像这样的方法：

```
public static Object callRestWithUrl(String url, Class<?> responseObject)
            throws MetaServiceException {

        ClientResponse response = RESTConnectionUtils.callMetaService(url);

            result = response.getEntity(responseObject);

        ..... 
```

但它在运行时被评估为 List 而不是 GenericType 并引发异常。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-15T14:54:59.083

你如何调用你的 callRestWithUrl 方法？

如果您的方法具有签名，它可能会更好地工作：

```
public static Object callRestWithUrl(String url, GenericType<List<?>> responseObject) 
```

然后你这样调用它：

```
List<...> list = callRestWithUrl(new GenericType<List<MyObject>>() {}); 
```

也许这个网页可以帮助： http: [//persistentdesigns.com/wp/2009/10/jersey-rest-client/](http://persistentdesigns.com/wp/2009/10/jersey-rest-client/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T19:37:57.083

由于某种原因，它开始按原样工作。不知道为什么。方法的输入需要是通用的。

# box-api - 获取 box api 2.0 中多个文件的元数据

> ID：10587385
> 
> 赞同：1
> 
> 时间：2012-05-14T16:29:50.500
> 
> 标签：box-api

我每晚使用一个使用 box api 版本 1 的 python 应用程序将我的代码目录树备份到我的盒子存储中。为了最大限度地减少网络流量，该应用程序将每个文件的当前本地硬盘元数据与该文件的盒子元数据进行比较对已更改的文件执行网络传输。在请求文件夹信息时，我可以使用递归选项通过一个框 api 1.0 请求获取树中所有文件的元数据。我了解 2.0 文件/文件夹信息请求是针对单个文件/文件夹的，并且 2.0 api 处于测试阶段。您是否期望将来，api 将具有通过一个请求获取多个文件的元数据的能力？就像现在一样，如果我将备份应用程序转换为 2.0 api，它将执行数千个文件元数据请求，而 1.0 api 会执行一个请求。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T16:49:05.813

如果您使用的是 v2，您可能更适合使用[/events 端点](http://developers.box.com/docs/#events)。/event 端点将告诉您自上次检查以来帐户中的所有更改，这对于您的特定用例来说似乎是理想的，因为它可以让您避免检查未更改的文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-19T23:15:34.097

因为旧事件会从事件流中清除（请参阅[Box.com 事件 API - 从流中删除的旧事件？](https://stackoverflow.com/questions/11857883/box-com-events-api-old-events-dropped-from-stream)），获取有关旧文件和文件夹信息的唯一方法是抓取，此时事件端点非常适合捕获三角洲。但是，出于初始爬网的目的，如果有一种方法可以请求其他属性，那就太好了。听起来这可能已经以“过滤器”系统的形式进行：[文件夹对象的文件大小信息](https://stackoverflow.com/questions/11058154/file-size-information-for-folder-object)。

# javascript - 对实例的主干 Mixins 引用

> ID：10587386
> 
> 赞同：0
> 
> 时间：2012-05-14T16:29:51.143
> 
> 标签：javascript, backbone.js

我对如何解决这个问题感到困惑，并希望得到您的意见。我创建了一个模仿 underscore 使用节点和浏览器的方式的库。这是代码的摘要版本：[https ://gist.github.com/76121b90fb1ae392a4de](https://gist.github.com/76121b90fb1ae392a4de)

请注意，我使用 Mixin 来覆盖某些类的同步方法。在这种情况下，会话类。这是因为我们的一些端点不是 restful 而是 JSON RPC，所以我必须以不同的方式处理它们（参见第 51 行）。

配置被传递给 MyLibrary 的实例化（第 86 行）。然后这些配置变量可以作为例如 window.mylibrary.area.jsproxi 访问。很好...问题是我无法找到一种优雅的方式来从 mixin.sync 方法中访问实例的相同属性（第 11 行和第 12 行就是这样的示例）。

有任何想法吗？我不知道如何在实例化后从库中获取 MyLibrary 的实例。而且我不能使用附加到窗口的名称，因为我不知道这个名称是什么。

非常感谢！

路易斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T17:03:49.687

首先就如何在 Backbone 中使用 mixins 而言，看看以下解决方案：[Proper way of doing view mixins in Backbone](https://stackoverflow.com/questions/7853731/proper-way-of-doing-view-mixins-in-backbone/7853854#7853854)。这将确保您在任何给定时间对此的引用都是正确的。

其次，您正在实例化一个新的 MyLibrary，它是一个模型

```
new MyLibrary({
  "area": {
    "ajax_synchronization_token": "sometoken",
    "jsproxy": "proxytoken"
  },
  "user": {
    "key": "somekey",
    "signature": "somesignature"
  }
}); 
```

并期望像这样访问这些值：

```
this.area.ajax_synchronization_token,
this.area.jsproxy 
```

而你应该如何真正尝试访问这些值是

```
var area = this.get('area'); // it's a model after all
area.ajax_synchronization_token
area.jsproxy 
```

# java - JMF 的替代品

> ID：10587394
> 
> 赞同：2
> 
> 时间：2012-05-14T16:30:32.590
> 
> 标签：java, image, webcam, jmf

我正在使用 Java 媒体框架。

这个框架在处理图像方面相当慢。

请您推荐一个免费的框架来处理足够快的图像以支持高分辨率网络摄像头？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T16:46:02.797

你检查[过 Xuggler](http://www.xuggle.com/)吗？它是一个很棒的 Java 替代品，并使用 FFmpeg 作为后端。有良好的支持和文档。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T16:34:05.027

试试[FMJ](http://www.fmj-sf.net/)。它是一个开源项目，旨在提供 Java Media Framework (JMF) 的替代方案，

# javascript - javascript 脚本适用于 Firefox、Chrome、Safari、Internet Explorer < 9，但不适用于 IE 9

> ID：10587397
> 
> 赞同：0
> 
> 时间：2012-05-14T16:30:48.837
> 
> 标签：javascript, internet-explorer-9

我在一个网站上使用这个脚本：[http ://www.dhtmlgoodies.com/index.html?whichScript=quiz-maker](http://www.dhtmlgoodies.com/index.html?whichScript=quiz-maker)

它允许轻松进行测验。问题是它适用于除 IE 9 之外的所有浏览器，我真的需要让它工作（或至少尝试）。

我的问题是我不知道从哪里开始在该脚本的代码中寻找解决方案，我希望有人能给我一个线索或指出我正确的方向。也许有一个我不知道的已知 IE 9 错误或类似的东西。

这是我用它制作的测试页面中相同脚本的示例：http: [//s337174121.onlinehome.us/tests/quiz/](http://s337174121.onlinehome.us/tests/quiz/)

任何帮助将非常感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T16:38:11.603

您的 MooTools 版本已过期。很可能它没有认识到 IE9 不支持`document.createElement('<input type="radio" name="xyz">')`旧版本 IE 的“hack”。

尝试更新您的 MooTools 副本。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-14T18:53:29.917

查看 F12 开发人员工具控制台中报告的错误：

```
SEC7111: HTTPS security is compromised by https://api.twitter.com/xd_receiver.html 
index.html?whichScript=quiz-maker
SCRIPT5022: DOM Exception: INVALID_CHARACTER_ERR (5) 
mootools-1.2.4-core-yc.js, line 122 character 47 
```

我建议在继续之前先尝试解决这些错误。

# cordova - 没有回调的 Cordova 自定义插件结构？

> ID：10587398
> 
> 赞同：2
> 
> 时间：2012-05-14T16:31:08.830
> 
> 标签：cordova, phonegap-plugins

我正在创建我的第一个 Cordova 插件以使用开源 SDK。我在没有回调的情况下运行它时遇到了问题，因为库没有任何东西（想想分析之类的东西）。还有很多不同的格式，wiki 已经有 2 年历史了，所以我不确定做事的正确方法是什么。

我尝试了几种不同的插件设置变体，但没有一个能成功。

我的.js：

```
;(function(){

    if (Cordova.hasResource("myPlugin")) return

    Cordova.addResource("myPlugin")

    function MyPlugin() {
    }

    MyPlugin.prototype.setup = function(types) {
        return Cordova.exec("MyPlugin.setup", types);
    };

    Cordova.addConstructor(function() {
        if(!window.plugins)
        {
            window.plugins = {};
        }

       if (!window.plugins.myPlugin) {
           window.plugins.myPlugin = new MyPlugin()
       }
   })

})(); 
```

setup 函数有 4 个参数，都是字符串。我将 MyPlugin.js 包含在 index.html 文件中，然后在 onDeviceReady() 中调用：

```
window.plugins.myPlugin.setup('xxx-x-xxx','xxxx','xxxx','xxxx'); 
```

每当我尝试运行时，我都会收到错误消息`[INFO] Error in success callback: NetworkStatus0 = TypeError: 'undefined' is not an object`。

我试过谷歌搜索和诸如此类的东西，发现了几种不同的PhoneGap插件格式，我都试过了，都没有。如果有帮助，我正在使用 Cordova 1.6.1。

这是我尝试模仿的不同结构的列表：

*   [https://github.com/chbrody/Cordova-ios-UniqueDeviceId/blob/master/UniqueDeviceId.js](https://github.com/chbrody/Cordova-ios-UniqueDeviceId/blob/master/UniqueDeviceId.js)
*   [https://github.com/purplecabbage/phonegap-plugins/blob/master/iPhone/BarcodeScanner/barcodescanner.js](https://github.com/purplecabbage/phonegap-plugins/blob/master/iPhone/BarcodeScanner/barcodescanner.js)
*   [https://github.com/phonegap/phonegap-plugins/blob/master/iOS/BarcodeScanner/barcodescanner.js](https://github.com/phonegap/phonegap-plugins/blob/master/iOS/BarcodeScanner/barcodescanner.js)
*   [https://github.com/purplecabbage/phonegap-plugins/blob/master/iPhone/ChildBrowser/ChildBrowser.js](https://github.com/purplecabbage/phonegap-plugins/blob/master/iPhone/ChildBrowser/ChildBrowser.js)

它们都产生相同的错误，所以我不确定问题是什么。

**编辑：**我还应该提到，我的 Obj-C 代码没有被调用。JS调用与插件的实际功能无关...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-14T17:17:04.770

好的，对于其他想知道格式化的人来说……这是我得到的解决方案：

这适用于 1.6.1 => 1.9x（但不要使用 1.9，因为它有一个严重的`stack overflow`错误！）

```
var MyPlugin() = function() {};

MyPlugin.prototype.setup = function(types) {
    return Cordova.exec("MyPlugin.setup", types);
};

cordova.addConstructor(function() {
    if (!window.Cordova) {
        window.Cordova = cordova;
    };

    if(!window.plugins) window.plugins = {};

    window.plugins.myPlugin = new MyPlugin();
}); 
```

在 Cordova 2.0 中，`addConstructor`已删除并且不需要检查 Cordova。

```
var MyPlugin() = function() {};

MyPlugin.prototype.setup = function(types) {
   return Cordova.exec("MyPlugin.setup", types);
};

//Keep at bottom but remove the addConstructor for Cordova 2+
if(!window.plugins) window.plugins = {};
window.plugins.myPlugin = new MyPlugin(); 
```

# grails - 在 CRUD grails 脚手架中自动生成 Jquery Autocomplete（一对多关系）

> ID：10587407
> 
> 赞同：0
> 
> 时间：2012-05-14T16:32:17.797
> 
> 标签：grails, jquery-autocomplete, grails-plugin, scaffolding

我已经更改了 grails 项目中的 src/templates/scaffolding/renderEditor.template 文件，以便在所有“多对”关系中插入必要的 html 字段框（和 javascript 代码）来配置和使用 jquery 自动完成一”。（代码如下所示）

自动生成的自动完成（_form.gsp）工作正常......但是当用户使用脚手架编辑记录时，我需要在自动完成文本框中显示正确的值（代码和描述）。

为此，我需要识别域内的两个字段：一个用于代码，另一个用于描述。

面对这个问题，我尝试创建两个虚拟约束，使用插件“约束”，第一个用作代码，第二个用作描述。我不喜欢这个解决方案，因为约束可以在域中多次使用。

更改为 src/templates/scaffolding/renderEditor.template 文件的代码如下：（注意两个输入框和用于自动完成的 Javascript 代码）：

```
private renderManyToOne(domainClass, property) {
    if (property.association) {

        /*  ORIGINAL CODE inside comments
            def sb = new StringBuilder()
        sb << '<g:select'
            // id is "x" and name is "x.id" as the label will have for="x" and "." in an id will confuse CSS
            sb << ' id="' << property.name << '"'
            sb << ' name="' << property.name << '.id"'
            sb << ' from="${' << property.type.name << '.list()}"'
            sb << ' optionKey="id"'
            if (isRequired()) sb << ' required=""'
            sb << ' value="${' << "${domainInstance}?.${property.name}" << '?.id}"'
            sb << ' class="many-to-one"'
            sb << renderNoSelection(property)
            sb << '/>'
            sb as String

            */

        def sb = new StringBuilder()

        // hidden field for domain.id

        sb << '<input type=\"hidden\" '
        sb << ' id="' << property.name << '.id"'
        sb << ' name="' << property.name  << '.id"'
        sb << ' value="${' << "${domainInstance}" << '?.id}" '
        sb << '/>\n'

        // Text field to show the description generated by autocomplete
        sb << '\t<input type=\"text\" '
        sb << ' id="' << property.name << '"'
        sb << ' name="' << property.name  << '"'
        if (isRequired()) sb << ' required="" '
        sb << 'style=\"width: 600px;\" '
        sb << ' value="${' << "${domainInstance}?.${property.name}" << '?.id}"'
        // sb << '${' << "${property.name}" << '"'
        sb << '/>'

        def js = new StringBuilder()
        js << '''
        <script type="text/javascript">

            /*
             * Remember include jquery and jquery-ui libraries into head section of edit.gsp file
             *   < g:javascript library="jquery"/>
             *   < g:javascript library="jquery-ui"/>
             */

            \$(document).ready(function() {
        '''
           js << '\t\$("#' << property.name << '").focus(function(){this.select(); });\n'

           js << '\t\t$("#' << property.name << '").autocomplete({\n'

           js << '''
                      source: function(request, response){
                          \$.ajax({
                              // Define Remote datasource into the controller
           '''
           js << '            \t\t url: "'
           js << '/' << grails.util.Metadata.current.'app.name' << '/' << property.name << '/' << 'autoCompleteList",'

           js << '''
                              data: request,
                              success: function(data){
                                  // Get the response (JSON format)
                                  response(data);
                              },
                              error: function(){
                                  // Handle server errors
                                  response("Error after search records. Try Again.")
                              }
                          });
                      },
                      // General options: Triggered only after minimum 2 characters have been entered and others
                      minLength: 2,
                      delay: 1,
                      autoFocus: true,
                      // Event handler when user selects a Loinc from the list.
                      select: function(event, ui) {
                          // update the hidden field.
           '''
           js <<  '\t\t\t\t  \$("#' << property.name << '\\.id").val(ui.item.id);'
           js << '''
                      }
                });
           });
        </script>
        '''
        sb << js
        sb as String

    } 
```

使用虚拟约束（autoid 和 autodesc）的域：

```
class LOINC {

    static searchable = {
        only = ["code", "shortName", "longName", "property", "system", "scale", "method", "time"]
    }

    String code         // LOINC_NUM         * 0
    String shortName    // SHORTNAME         * 29
    String longName     // LONG_COMMON_NAME  * 35
    String name         // BASE_NAME         * 21
    String component    // COMPONENT         * 1
    String property     // PROPERTY          * 2
    String time         // TIME_ASPCT        * 3
    String system       // SYSTEM            * 4
    String scale        // SCALE_TYP         * 5
    String method       // METHOD_TYP        * 6

    static constraints = {
        code(nullable: false, unique: true, blank: false, maxSize: 100, autoid: true)
        shortName(nullable: false)
        longName(nullable: false, autodesc: true)
        name(nullable: false, maxSize: 100)
        component(nullable: false)
        property(nullable: false)
        time(nullable: false)
        system(nullable: false)
        scale(nullable: false)
        method(nullable: false)
    }

    String toString(){
        "${code} ${longName}"
    }
} 
```

控制器内部的代码：

```
 def autoCompleteList = {
        def loincAutoCompleteService = new LOINCAutoCompleteService()
        render loincAutoCompleteService.loincList(params) as JSON
 } 
```

服务：

```
class LOINCAutoCompleteService {

    def loincList(params) {

        // Creates a new query Object
        def query = {
            or {
                like("code", "${params.term}%") // term is the parameter send by jQuery autocomplete
                like("longName", "${params.term}%")
                like("shortName", "${params.term}%")
            }
            projections { // good to select only the required columns.
                property("id")
                property("code")
                property("longName")
            }
        }

        def loincSelectList = [] // aArray List to add each Loinc details
        def clist = LOINC.createCriteria().list(query)

        clist.each {
            // Add to map. jQuery autocomplete expects the JSON object to be with id/label/value
            def loincMap = [:]

            loincMap.put("id", it[0])

            // Label is text showed int he drop-down list
            loincMap.put("label", it[1] + " : " + it[2])

            // Values is the code to be returned when the user select an item from drop-down list
            loincMap.put("value", it[1] + " : " + it[2])

            // Add the row to the array list
            loincSelectList.add(loincMap)
        }

        return loincSelectList

    }
} 
```

我想要在域类中类似的东西：

```
<code>
static autocompleteAble = {
        fields = ["code", "longName"]
}
</code> 
```

然后从 src/templates/scaffolding/renderEditor.template 访问该数组，以获取字段名称（代码和 longName）并在 _forms.gsp 中生成正确的 html 代码并修复问题。

其他解决方案？有任何想法吗？

提前谢谢了。...原谅我的英语不好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T17:27:09.323

又读又测又测……我找到了答案，按以下步骤操作：

1.  将以下代码添加到 Domain 类：

    类 DomainClass { 字符串代码字段；字符串描述字段；静态 autoCompleteConfig = ["codeField", "descriptionField"] }

2.  更改 src/templates/scaffolding/renderEditor.template（仅 renderManyToOne 方法）：

    私人 renderManyToOne（域类，属性）{

    ```
     def AUTOCOMPLETE_PROPERTY = "autoCompleteConfig"
        def className = property.type.name

        def autoCompleteProperty = org.codehaus.groovy.grails.commons.GrailsClassUtils.getStaticPropertyValue(property.referencedDomainClass.clazz, AUTOCOMPLETE_PROPERTY)
        def sb = new StringBuilder()
        // sb << "\n<!-- getFullName(): " <<   domainClass.getFullName() << " property.type.name: " << property.type.name << " property.referencedDomainClass.propertyName: " << property.referencedDomainClass.propertyName <<  "     property.referencedDomainClass: " << property.referencedDomainClass <<  " -->\n"
        if (autoCompleteProperty != null) {

            if (autoCompleteProperty[0] ) {
                if (property.association) {

                    // hidden field for domain.id

                    sb << '<input type=\"hidden\" '
                    sb << ' id=  "' << property.name << '.id"'
                    sb << ' name="' << property.name << '.id"'
                    sb << ' value="${' << "${domainInstance}" << '?.id}" '
                    sb << '/>\n'

                    // Text field to show the description generated by autocomplete
                    sb << '\t<input type=\"text\" '
                    sb << ' id=  "' << property.name  << '_' << (autoCompleteProperty[1]? autoCompleteProperty[1]:'Description')  << '\" '
                    sb << ' name="' << property.name  << '_' << (autoCompleteProperty[1]? autoCompleteProperty[1]:'Description')  << '\" '
                    if (isRequired()) sb << ' required="" '
                    sb << 'style=\"width: 600px;\" '

                    sb << ' value="${'
                    sb << "${domainInstance}?.${property.name}" << '?.' << autoCompleteProperty[0] << '}' << (autoCompleteProperty[1]? '' : '"' )

                    if (autoCompleteProperty[1]) {
                        sb << ': ${' << "${domainInstance}?.${property.name}" << '?.' << autoCompleteProperty[1] << (autoCompleteProperty[2]? '}' : '}"' )
                    }

                    if (autoCompleteProperty[2]) {
                        sb << ': ${' << "${domainInstance}?.${property.name}" << '?.' << autoCompleteProperty[2] << '}"'
                    }

                    sb << ' />'

                    def js = new StringBuilder()
                    js << '''
                    <script type="text/javascript">

                        /*
                         * Remember include jquery and jquery-ui libraries into head section of edit.gsp file
                         *   < g:javascript library="jquery"/>
                         *   < g:javascript library="jquery-ui"/>
                         *
                         */

                        \$(document).ready(function() {
                    '''
                       js << '\t\$("#' << property.name << '").focus(function(){this.select(); });\n'

                       js << '\t\t\t\t\t\t' // Tabs to sort the output
                       js << '\$("#' << property.name  << '_' << (autoCompleteProperty[1]? autoCompleteProperty[1]:'Description')  << '").autocomplete({\n'

                       js << '''
                                  source: function(request, response){
                                      \$.ajax({
                                          // Define Remote datasource into the controller
                       '''
                       js << '            \t\t url: "'
                       js << '/' << grails.util.Metadata.current.'app.name' << '/' << property.name << '/' << 'autoCompleteList",'

                       js << '''
                                          data: request,
                                          success: function(data){
                                              // Get the response (JSON format)
                                              response(data);
                                          },
                                          error: function(){
                                              // Handle server errors
                                              response("Error after search records. Try Again.")
                                          }
                                      });
                                  },
                                  // General options: Triggered only after minimum 2 characters have been entered and others
                                  minLength: 2,
                                  delay: 1,
                                  autoFocus: true,
                                  // Event handler when user choose un item from the list.
                                  select: function(event, ui) {
                                      // update the hidden field.
                       '''
                       js <<  '\t\t\t\t  '
                       js << '\$("#' << property.name << '\\\\.id").val(ui.item.id);'

                       js << '''

                                  }
                            });
                       });
                    </script>
                    '''
                    sb << js
                    sb as String

                }
            }
        } else {

            sb << '<g:select'
            // id is "x" and name is "x.id" as the label will have for="x" and "." in an id will confuse CSS
            sb << ' id="' << property.name << '"'
            sb << ' name="' << property.name << '.id"'
            sb << ' from="${' << property.type.name << '.list()}"'
            sb << ' optionKey="id"'
            if (isRequired()) sb << ' required=""'
            sb << ' value="${' << "${domainInstance}?.${property.name}" << '?.id}"'
            sb << ' class="many-to-one"'
            sb << renderNoSelection(property)
            sb << '/>'
            sb as String

        }

    } 
    ```

3.  将 jquery 库添加到 src/templates/scaffolding/edit.gsp。记得安装 jquery 插件：

4.  在域控制器中编写您自己的 autoCompleteRoutine，例如：

    def autoCompleteList = { def domainAutoCompleteService = new DomainAutoCompleteService() 将 domainAutoCompleteService.domainList(params) 渲染为 JSON }

5.  编写自己的 domainAutoCompleteService，类似于：

    包包名

    ```
    // Change the words "Domain" and "domain" with your own Domain class name
    class DomainAutoCompleteService {

        def domainList(params) {

            // Creates a new query Object
            def query = {
                or {
                    // term is the parameter send by jQuery autocomplete
                    like("codeField", "${params.term}%") 
                    like("descriptionField", "${params.term}%")
                    like("otherField", "${params.term}%")
                }
                projections { // good to select only the required columns.
                    property("id")
                    property("codeField")
                    property("descriptionField")
                }
            }

            def domainSelectList = [] 
            // Replace the word "Domain" by your own domain Name
            def clist = Domain.createCriteria().list(query)

            clist.each {
                // Add to map. jQuery autocomplete expects the JSON object to be with id/label/value
                def map = [:]

                map.put("id", it[0])

                // Label is text showed int he drop-down list
                map.put("label", it[1] + " : " + it[2])

                // Values is the code to be returned when the user select an item from drop-down list
                map.put("value", it[1] + " : " + it[2])

                // Add the row to the array list
                domainSelectList.add(map)
            }

            return domainSelectList

        }
    } 
    ```

6.  生成视图....瞧！一切正常。

任何意见？我认为可以更优雅但这是第一步......

# php - 修改变量变量

> ID：10587408
> 
> 赞同：1
> 
> 时间：2012-05-14T16:32:19.280
> 
> 标签：php, variables

```
$m = 'this_is_m';
$this_is_m = 'this_is_m_not_full :(';
$this_is_m_full = 'this_is_m_FULL!! :D';

print ${$m}; 
```

（嗨，第一：P）输出：

```
this_is_m_not full :( 
```

知道如何`this_is_m_FULL!! :D` **使用** `$m`输出吗？

我已经尝试过的：

```
print $"{$m}_full";
print $'{$m}_full';
print $'$m_full';
print ${$m}_full'; 
```

没有工作...在此先感谢，，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T16:35:11.293

要获得所需的输出，您需要执行以下操作：

```
print ${$m . "_full"}; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-14T16:35:12.253

解决方案是：

```
print ${$m . '_full'}; 
```

但这感觉非常hackish。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-14T16:48:05.277

以下应该有效：

```
print ${$m.'_full'}; 
```

这是因为大括号内的字符串将首先被评估，成为

```
print ${'this_is_m' . '_full'}  
  ->  print ${'this_is_m_full'}  
  ->  print $this_is_m_full 
```

如果您想了解更多信息，请查看[此手册页。](http://php.net/manual/en/language.variables.variable.php)

# android - 破坏意图？

> ID：10587410
> 
> 赞同：2
> 
> 时间：2012-05-14T16:32:35.413
> 
> 标签：android

当我创建一个意图时：

```
Intent in = new Intent(this, myclass.class);
this.startActivity(in); 
```

我创建了一个新的 Intent，但最后一个 Intent 没有销毁
它仍在内存
中我怎样才能杀死最后一个销毁？

所以我想在两个不同的类中创建两个意图：在第一类中我写了这个：

```
Intent in1 = new Intent(this, myclass2.class);
this.startActivity(in); 
```

在第二堂课我写这个：

```
Intent in2 = new Intent(this, myclass1.class);
this.startActivity(in2); 
```

但是当我单击 in1 将创建并且 in2 将销毁，当我单击 in2 时 in2 将创建并且 in1 将销毁。

一个想清理我的手机内存。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-14T17:56:08.273

`Activity`您可以通过覆盖后退键功能来阻止用户继续上一个，如下所示：

```
public void onBackPressed() {
       //doing nothing on pressing Back key
       return;
    } 
```

虽然不鼓励这种方法。众所周知，`Activity`当某些方面出现如内存要求时，将自动终止。你不能随意摧毁一个`Activity`。

尽管对于像欢迎启动屏幕这样的特定情况，您可以执行以下两件事之一：

1）当你移动到你的新时调用`finish()`你当前的方法（通常在使用时完成）。`Activity``Activity``Thread`

2）在你的使用以下`manifest`：

```
<activity android:name=".WelcomeScreen" android:noHistory="true" ... /> 
```

这将告诉设备不要将其保留`Activity`在`Activity`堆栈中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-14T16:37:09.853

活动会一直保留在内存中，直到 Android 决定应该将其删除。别担心。当需要更多内存时，它将被销毁。在您的主要活动使用它之前，它实际上是“未使用”的内存。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-14T16:35:41.820

我不确定你的问题……你想开始一个新的活动并破坏之前的活动？如果这是您需要的，您可以使用：

```
startActivity(new Intent(this, myActivity.class).setFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP)); 
```

“CLEAR_TOP”标志告诉“嘿！我想开始这个活动并杀死所有其他人！”

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-14T17:10:34.353

由于 Android 运行时环境使用垃圾收集（就像“传统”Java 一样），因此在大多数情况下您无需担心手动销毁对象。`Intent`如果系统需要额外空间来存放新对象，则未使用对象占用的内存将被回收。

# javascript - 无法通过 javascript 表单验证找出错误

> ID：10587412
> 
> 赞同：0
> 
> 时间：2012-05-14T16:32:40.783
> 
> 标签：javascript

我在这里使用 Javascript 表单验证[http://webcheatsheet.com/javascript/form_validation.php](http://webcheatsheet.com/javascript/form_validation.php)

当我提交表单时，尚未完成验证。使用萤火虫，我收到以下错误（但是我必须在显示确认页面之前按转义键）

> fld 未定义 validateEmail(fld=undefined) （第 3178 行） validateFormOnSubmit(theForm=form#form1 /account.php) （第 3137 行） onsubmit(event=submit )
> 
> （3178 超出范围 346）

第 3178 行基本上就是这段代码

```
<option value="Tester, Developer, Fisherman and Hunter" >Tester, Developer, Fisherman and Hunter</option> 
```

3171是这个

```
<option value="Accommodation and Food Services" >Accommodation and Food Services</option> 
```

有人可以帮我解决这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-04T14:11:45.970

```
function validateEmail()
  {
  ...
  var vle = validateEmail;
  return !!vle.fld;
  }

function validateFormOnSubmit()
  {
  if (this.validateEmail && this.validateEmail() )
    {
    document.querySelector("#form1").submit();
    }
  else
    {
    ...
    }
  } 
```

# wcf - wsDualHttpBinding 中的每个轮询多条消息

> ID：10587420
> 
> 赞同：0
> 
> 时间：2012-05-14T16:33:38.717
> 
> 标签：wcf, binding, wsdualhttpbinding

轮询双工绑定支持每次轮询多条消息。

```
<pollingDuplex duplexMode="MultipleMessagesPerPoll" 
```

但是，非silverlight 客户端不支持pollingDuplex。所以我必须`wsDualHttpBinding`与我的 WPF 客户端一起使用。

有没有办法在每个投票中发送多条消息`wsDualHttpBinding`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T03:24:11.947

wsDualHttpBinding 不使用轮询 - 实际上唯一使用的双工绑定是 PollingDuplex。

所有其他双工绑定将消息直接发送到客户端 - 它们的工作方式彼此略有不同（wsDualHttpBinding 从服务器到客户端有第二个连接，而 NetTcpBinding 使用从客户端到服务的单个连接，并且服务沿此发送消息相同的连接）

如果您想在服务器中批处理通知以减少往返次数，那么您必须编写该批处理

# ruby-on-rails - Rails 持久化语言环境

> ID：10587421
> 
> 赞同：7
> 
> 时间：2012-05-14T16:33:50.303
> 
> 标签：ruby-on-rails, ruby-on-rails-3, internationalization

我即将开始为我目前正在开发的 Rails 应用程序添加 I18n 支持。过去，我从 URL 设置了区域设置值。我只是想知道坚持语言环境会有多糟糕的做法？

所以不是这样的：

```
before_filter :set_locale

def set_locale
  I18n.locale = params[:locale] || I18n.default_locale
end 
```

做类似的事情

```
before_filter :set_locale

def set_locale
  I18n.locale = current_user.try(:locale) || I18n.default_locale
end 
```

看起来 FB 保留了语言环境，这个模式的权衡是什么？这会如何影响 SEO 的东西？

谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-14T21:02:12.180

我遇到了这些问题并最终使用了这个策略：

*   URL 中的语言环境（允许页面缓存和特定语言的直接链接）
*   将语言环境存储在用户 cookie 中

如果 URL 中不存在语言环境，请尝试（按顺序）：

*   从 cookie 中检索
*   从地理位置猜测
*   从浏览器标题中猜测接受语言
*   回退到应用默认值

希望有帮助；如果您想详细说明任何要点，请告诉我。

# outlook - Outlook 处理 mailto 链接中引用的 url 参数

> ID：10587424
> 
> 赞同：2
> 
> 时间：2012-05-14T16:33:53.293
> 
> 标签：outlook, url-encoding, mailto

我正在尝试使用 html 链接填充 mailto 链接的正文。目标浏览器为 IE 7+，邮件客户端为 Outlook 2007+。在我问我的问题之前，我承认 body 参数是用于短文本消息的事实，如下所示：

[https://stackoverflow.com/a/4304779/573083](https://stackoverflow.com/a/4304779/573083)

并在此处详细说明：

> 特殊的“body”表示关联的是消息的正文。“body”字段值旨在包含消息的第一个文本/纯正文部分的内容。“body”伪标头字段主要用于生成用于自动处理的短文本消息（例如邮件列表的“订阅”消息），而不是用于一般 MIME 正文。除了基于 UTF-8 和百分比编码的字符编码之外，“body”字段值没有使用其他编码（例如 base64 或quoted-printable；参见 [RFC2045]）。因此，与“mailto”URI 中的消息编码（例如，Content-Transfer-Encoding）相关的标头字段是不相关的，必须被忽略。身体”

话虽如此，在 SO 上有许多线程在正文标签中插入链接取得了不同程度的成功。例如：[https](https://stackoverflow.com/a/1455881/573083) ://stackoverflow.com/a/1455881/573083和[https://stackoverflow.com/a/9138245/573083](https://stackoverflow.com/a/9138245/573083)

我的问题是类似的，但它专门针对嵌入链接的前景渲染引用参数。我目前有以下几乎可以工作的东西：

```
<a href="mailto:someaddress@somedomain.com?subject=This is a subject&body=http://someserver.somedomain/somepage.aspx?id=1234%26somekey=%22somevalue%22">A link</a> 
```

部分链接正确显示在 Outlook 正文中，但 Outlook 未在链接中包含最终引用的 url 参数（“somevalue”）；="somevalue" 只是显示为纯文本。查看电子邮件消息的来源显示 Outlook 正在关闭封闭`<a>`标记，因为它将 %22 解释为链接的结尾。我试图用 %2f, /, ' 来逃避 %22 - 无济于事。我相信我需要正确的 Outlook 顺序才能理解 %22 应该包含在链接中，而不是作为封闭链接的关闭。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-10T13:07:19.473

从 判断`?`，您还没有对 body 组件进行编码。

```
> encodeURIComponent("http://someserver.somedomain/somepage.aspx?id=1234%26somekey=%22somevalue%22") 
"http%3A%2F%2Fsomeserver.somedomain%2Fsomepage.aspx%3Fid%3D1234%2526somekey%3D%2522somevalue%2522" 
```

所以代码应该是：

```
<a href="mailto:someaddress@somedomain.com?subject=This is a subject&body=http%3A%2F%2Fsomeserver.somedomain%2Fsomepage.aspx%3Fid%3D1234%2526somekey%3D%2522somevalue%2522">A link</a> 
```

或者更有可能：

```
<a href="mailto:someaddress@somedomain.com?subject=This is a subject&body=http%3A%2F%2Fsomeserver.somedomain%2Fsomepage.aspx%3Fid%3D1234%26somekey%3D%2522somevalue%2522">A link</a> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-02-03T04:04:50.520

我会将链接放在“<”和“>”中。

```
%20 = space

%0D = new line

%3C = "<"

%3E = ">" 
```

```
<html>
<body>hi
 <a href="mailto:someaddress@somedomain.com?subject=This is a subject&body=Hi,%0DThis%20is%20a%20body%0DAlso%20this%20is%20a%20link%20%3Chttp%3A%2F%2Fsomeserver.somedomain%2Fsomepage.aspx%3Fid%3D1234%26somekey%3D%22somevalue%22%3E%20have%20fun.">A link</a></body>

</html>
```

# cakephp - 为未登录的用户授予“访客”角色

> ID：10587425
> 
> 赞同：1
> 
> 时间：2012-05-14T16:33:53.770
> 
> 标签：cakephp

我是框架 cakephp 的新手，我正在使用身份验证组件以及 ACL。我已经按照本教程：[http](http://book.cakephp.org/2.0/en/tutorials-and-examples/simple-acl-controlled-application/simple-acl-controlled-application.html) ://book.cakephp.org/2.0/en/tutorials-and-examples/simple-acl-controlled-application/simple-acl-controlled-application.html让我开始。

如何为未登录的用户提供角色（组）ACL，例如“访客”？

我是否应该考虑为未登录的用户提供这样的角色（组）ACL？我的意思是它会带来任何缺点吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T20:47:59.253

通常您不会将角色授予未登录的用户，因为该用户在用户表中没有记录，因此用户不能属于角色。如果你想做很多特殊的编程，我想你可以做到，但我看不出有什么意义。

大多数人只允许未经身份验证和经过身份验证的用户使用控制器中的 $this->Auth->allow() 参数访问应用程序的各个部分。然后他们分割应用程序的其他部分，以允许属于某些角色的某些经过身份验证的用户使用 ACL 访问。

[http://book.cakephp.org/2.0/en/core-libraries/components/authentication.html#making-actions-public](http://book.cakephp.org/2.0/en/core-libraries/components/authentication.html#making-actions-public)

# eclipse - HP Fortify UI 自定义

> ID：10587431
> 
> 赞同：2
> 
> 时间：2012-05-14T16:34:17.420
> 
> 标签：eclipse, customization, development-environment, fortify

可以修改 Fortify Eclipse 颜色模式吗？

我在这个路径找到了一些文件

```
C:\Users\<user>\AppData\Local\Fortify\workspace\ 
```

这看起来像 Eclipse 用来定义代码颜色的颜色，但无法找到成功修改它们的方法。

**更新：**强化版本是“Audit Workbench 3.50”。它使用 Eclipse 代码编辑器来显示代码，但它不是 Eclipse 插件。我发现他们使用 Eclipse 自定义外观和感觉的相同文件，但未能成功修改它们。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-16T18:42:08.750

如果您按 Ctrl+Shift+L 两次（其中 Ctrl=Cmd 对于 Mac），将出现一个首选项对话框，允许对 Audit Workbench 透视图中的 Eclipse UI 属性进行一些更改。

*   对于 Java 项目，转到左侧的 Java -> 编辑器 -> 语法着色，然后选择如何突出显示 java 关键字，选择元素：Java -> 关键字不包括 'return'
*   C/C++ -> Editor -> Syntax Coloring 下的 C++ 项目也有类似的偏好。
*   可以在 Java（或 C/C++）-> 编辑器页面本身上设置一些颜色（如匹配括号突出显示颜色）。请注意，它使用简化的 java 编辑器，因此静态字段和其他一些复杂的东西将不起作用。
*   要设置当前行高亮颜色，请转到常规 -> 编辑器 -> 文本编辑器，然后选择“当前行高亮”颜色。
*   转到General -> Appearance -> Colors and Fonts，以使用其他元素的外观和感觉。

并非该对话框中的所有颜色首选项都会起作用，因为某些小部件中有一些硬编码的背景。

与往常一样，您的里程可能会有所不同！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-02T21:23:32.713

它是什么版本的 Eclipse？Fortify 软件是 Eclipse 中某种类型的插件吗？

我以前从未使用过 HP Fortify 软件，但我将从显而易见的 Eclipse 中更改文本外观开始：Preferences -> General -> Editors -> Text Editors -> Wiki Text -> Appearance。

我猜测如果插件被添加到 Eclipse 下可能会有一些类似的选项。

# javascript - 在父 div 上使用 .height() 后，改变高度的子元素不再影响父元素的高度，为什么？

> ID：10587432
> 
> 赞同：0
> 
> 时间：2012-05-14T16:34:17.737
> 
> 标签：javascript, jquery, height

我有一个带有一些子 div 的父 div。如果我对父 div 中的任何子元素调用以下代码，则无需对父 div 执行任何操作：

`$('.child').height(newHeight);`

父 div 将根据其子元素的所有高度符合新高度。

但是，如果我像这样设置父级的高度：

`$("#parent").height(newParentHeight);`

然后以与上述相同的方式更改任何孩子的身高，父母的身高不符合基于其所有孩子身高的新身高。本质上，父母的高度被“锁定”到我通过 .height() 方法发送的高度。

即使我使用上面的代码设置父级的高度，有没有办法确保父级 div 符合其所有子级的高度？

更新 1：根据要求，这是父 div 的 CSS：

```
#workarea
{
    overflow: hidden;
    border-bottom: 1px solid white;
    border-left: 1px solid grey;
    border-right: 1px solid white;
    background: #ccc;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T16:39:08.003

`.height()`通过直接设置 DOM 元素的 CSS 样式，将 div 的高度锁定为您指定的任何高度。如果您希望它恢复正常，您应该明确取消设置 CSS 样式：

`$('#parent').css('height', '')`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-14T16:40:28.220

您可以尝试而不是使用,在元素上`height()`设置 a 。`min-height`使用 jQuery：

```
$("#parent").css("minHeight", "100px"); 
```

较旧的浏览器可能存在一些问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-14T16:41:14.733

`.height()`给元素一个明确的高度。也许在你的情况下`.css('minHeight')`可以提供帮助。（执行此操作时请考虑跨浏览器兼容性）。

```
.css('minHeight', newParentHeight); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-14T16:41:00.200

您不应该使用 CSS 或 jquery 为父 div 设置任何高度。然后设置子高度将改变父高度。

[例如](http://jsfiddle.net/thesystemrestart/qhuMY/1/)

**注意**您可以使用 jQuery CSS 方法将高度设置为子级，即：

```
$('.child').css('height', 'some'); 
```

解决跨浏览器问题

# php - 我的排序方法有什么问题（AJAX、PHP&MySQL）

> ID：10587433
> 
> 赞同：1
> 
> 时间：2012-05-14T16:34:20.843
> 
> 标签：php, javascript, mysql, html, ajax

嗨，我正在构建软件下载站点。并且需要通过下拉菜单对软件进行排序我已经通过 w3Schools 示例[（请参见此处）](http://www.w3schools.com/php/php_ajax_database.asp)通过 AJAX 对数据进行排序并根据我的要求进行了一些更改，当我选择从**选择任何类别**中对数据进行排序时它无法正常工作向我展示了数据库中的整个数据，而不是根据选择要排序的类别对其进行排序。

我做错了什么

请帮忙。

**HTML**

```
 <form>
<select name="users" onchange="showUser(this.value)">
<option value="">Select a person:</option>
<option value="id">id</option>
<option value="title">title</option>
<option value="image">image</option>
<option value="description">description</option>
<option value="description">rating</option>
<option value="download">download</option>
<option value="buy">buy</option>
</select>
</form>
<br />
<div id="txtHint">content</div> 
```

**Javascript(AJAX)**

```
 <script type="text/javascript">
function showUser(str)
{
if (str=="")
  {
  document.getElementById("txtHint").innerHTML="";
  return;
  }
if (window.XMLHttpRequest)
  {// code for IE7+, Firefox, Chrome, Opera, Safari
  xmlhttp=new XMLHttpRequest();
  }
else
  {// code for IE6, IE5
  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
  }
xmlhttp.onreadystatechange=function()
  {
  if (xmlhttp.readyState==4 && xmlhttp.status==200)
    {
    document.getElementById("txtHint").innerHTML=xmlhttp.responseText;
    }
  }
xmlhttp.open("GET","getuser.php?q="+str,true);
xmlhttp.send();
} 
```

**PHP**

```
 <?php
$q=$_GET["q"];

$con = mysql_connect('localhost', 'root', '');
if (!$con)
  {
  die('Could not connect: ' . mysql_error());
  }

mysql_select_db("security_software", $con);

$sql="SELECT * FROM internet_security ORDER by '".$q."' DESC" ;

$result = mysql_query($sql);

echo "<table border='1'>
<tr>
<th>id</th>
<th>title</th>
<th>image</th>
<th>description</th>
<th>rating</th>
<th>download</th>
<th>buy</th>
</tr>";

while($row = mysql_fetch_array($result))
  {
  echo "<tr>";
  echo "<td>" . $row['id'] . "</td>";
  echo "<td>" . $row['title'] . "</td>";
  echo "<td>" . $row['image'] . "</td>";
  echo "<td>" . $row['description'] . "</td>";
  echo "<td>" . $row['rating'] . "</td>";
  echo "<td>" . $row['download'] . "</td>";
  echo "<td>" . $row['buy'] . "</td>";
  echo "</tr>";
  }
echo "</table>";

mysql_close($con);
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T17:01:32.757

PHP 无法工作，因为您在`ORDER BY`子句中使用了单引号。这不会按指定字段对它们进行排序，因为您正在传递一个字符串。

尝试反引号：

```
$sql="SELECT * FROM internet_security ORDER by `".$q."` DESC" ; 
```

我还建议对 order by 子句使用值的白名单，因为它是一个字段名称，您不希望在其中允许任何字符串（即使它已经通过 real_escape）。设置一组可能的值并只允许这些值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T17:00:05.737

尝试使用 mysql_fetch_assoc()，而不是 mysql_fetch_array()。

如果失败，尝试打印 $result （如果它包含任何值），然后尝试使用 mysql_num_rows 来确定您的查询是否正确执行。

正如我所看到的，您的代码中的所有内容都是正确的，尽管我的大脑不是编译器，因此最好正确地捕获错误。:)

# android - 如何让 Android 应用程序在下载和安装后自动运行？

> ID：10587441
> 
> 赞同：5
> 
> 时间：2012-05-14T16:34:48.673
> 
> 标签：android

我在这里查看 Plan B 应用程序的描述：https: [//play.google.com/store/apps/details?id=com.lookout.labs.planb](https://play.google.com/store/apps/details?id=com.lookout.labs.planb)。它说它会在安装后自动启动。您如何配置应用程序来执行此操作？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-14T16:43:04.910

注册以接收共同意图。一种特别适合您的目的是：

```
"android.intent.action.PACKAGE_ADDED" 
```

您还可以侦听其他意图，例如`BOOT_COMPLETED`, 等。

**编辑：**根据[另一个 Stack Overflow 答案](https://stackoverflow.com/questions/2127044/how-to-start-android-service-on-installation)，安装后您不能立即运行*自己的*应用程序。您必须按照我的建议注册其他意图。需要注意的是，您的应用需要用户许可才能接收`BOOT_COMPLETED`意图。

*更新：* 正如 zapl 所指出的，在用户明确启动您的应用程序之前，发布 4.0 后您现在无法执行任何操作。

# image - 使用 Matlab 进行男性/女性分类 - 关于寻找平均图像

> ID：10587443
> 
> 赞同：2
> 
> 时间：2012-05-14T16:35:02.877
> 
> 标签：image, matlab, classification, mean

我正在做一个关于使用 matlab 进行模式（男性/女性）分类的项目。我有一个问题，我需要你的帮助。

我的程序应该找到数据集的平均图像。第一个数据集是女性，第二个数据集是男性。所以第一个平均图像必须看起来像一个女人，第二个是一个男人。我有不同的数据集，它们都具有 jpeg 格式。我正在为我的程序尝试不同的数据集以检查它是否正常工作，但是当我使用不同的数据集时，我始终无法看到真实的平均图像，例如：

它们是来自数据集的平均图像：

![在此处输入图像描述](../Images/b74d353c524422d9a60542483e3c5510.png)

但是当我使用另一个数据集时，我的平均图像是这样的，它们没有任何意义，我的意思是它们看起来不像脸：

![在此处输入图像描述](../Images/24732ec2ffdf842087e41d8bd0037de3.png)

这可能是什么原因？我应该使用不同的数据集。请帮忙。`

```
filenamesA = dir(fullfile(pathfora, '*.jpg'));
Train_NumberA = numel(filenamesA);

%%%%%%%%%%%%%%%%%%%% Finding Image Vectors for A

imagesA= [];
for k = 1 : Train_NumberA

    str = int2str(k);

    str= strcat(str);

    str = strcat('\',str,'b','.jpg');
    str = strcat(pathfora,str);

    imgA = imread(str);
    imgA = rgb2gray(imgA);
    [irowA icolA] = size(imgA);
    tempA = reshape(imgA',irowA*icolA,1);   % Reshaping 2D images into 1D image vectors
    imagesA = [imagesA tempA]; % 'imagesA' grows after each turn 

    imagesA=double(imagesA);
end`

`%%%%%%%%%%%%%%%%%%%%%%%% Calculate the MEAN IMAGE VECTOR for A

mean_vectorA= mean(imagesA,2); % Computing the average vector m = (1/P)*sum(Tj's)    (j = 1 : P)
mean_imageA= reshape(mean_vectorA,irowA,icolA);   % Average matrix of training set A
meanimgA=mat2gray(mean_imageA);
figure(1);
imshow(rot90(meanimgA,3));`

-------------------------------------And same for dataset B (male) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T17:21:16.387

您可以使用 3D 矩阵来存储图像。我还清理了一些代码。未测试。

```
filenamesA = dir(fullfile(pathfora, '*.jpg'));
Train_NumberA = numel(filenamesA);

imagesA = [];

for k = 1:Train_NumberA
    imgA = imread(strcat(pathfora, '\', int2str(k), 'b', '.jpg'));
    imgA = rgb2gray(imgA);

    imagesA = cat(3, imagesA, imgA);
end 
```

`double`命令移出循环。

```
imagesA = double(imagesA); 
```

计算`imagesA`矩阵第 3 维的平均值以获得平均 2D 图像。

```
meanimage_A = mean(imagesA, 3); 
```

转换为灰度图像。

```
meanimgA = mat2gray(meanimage_A); 
```

我认为`rot90`这里不需要...

```
figure(1);
imshow(meanimgA, 3); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T16:51:25.133

使用 3D 数组或图像元胞数组，而不是将 2D 图像重新整形为矩阵的单行。重塑是不必要的，只能添加错误。

如果所有图像的大小相同，则可以使用多维数组：[Matlab documentation on multidimensional arrays](http://www.mathworks.com/help/techdoc/math/f1-86528.html)

否则，使用元胞数组：[Matlab documentation on cell arrays](http://www.mathworks.com/help/techdoc/matlab_prog/br04bw6-98.html)

# nhibernate - FluentNHibernate - 如何在没有任何身份字段的情况下进行映射

> ID：10587444
> 
> 赞同：0
> 
> 时间：2012-05-14T16:35:03.697
> 
> 标签：nhibernate, orm, fluent-nhibernate, fluent-nhibernate-mapping

我正在使用 FluentNHibernate。谁能告诉我如何从没有字段唯一的数据库中检索值。没有要映射的身份列。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T16:37:56.967

```
session.Query<Person>().Where(x => x.Name == "gdoron" &&
                                   x.Age  == "Non of your business").ToList(); 
```

# ruby - apn_on_rails 多个应用程序出错

> ID：10587446
> 
> 赞同：2
> 
> 时间：2012-05-14T16:35:04.400
> 
> 标签：ruby, ruby-on-rails-3, apple-push-notifications

我正在使用支持多应用程序的 apn_on_rails 向我的设备发送推送通知。gem 发送通知但抛出一个错误，说

> apn_on_rails-0.5.1/lib/apn_on_rails/app/models/apn/app.rb:35:in `read': 没有这样的文件或目录 - /config/apple_push_notification_production.pem

证书正在从应用程序的数据库中提取，但由于某种原因仍在尝试使用默认证书？我该如何防止这种情况？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-09T17:47:40.530

你查过他们的网站吗？

> APN on Rails 使用 Configatron gem， [http](http://github.com/markbates/configatron/tree/master) ://github.com/markbates/configatron/tree/master来配置自己。随着对多应用程序支持的更改，认证存储在数据库中而不是配置目录中。
> 
> 但是，仍然可以使用默认的“app”和存储在 config 目录中的证书。对于此设置，适用以下配置。）Rails 上的 APN 具有以下默认配置，您可以根据设置进行更改。

也许您的配置仍然引用它。你运行更新了吗？

> 如果您要升级到新版本的 APN on Rails，您应该始终运行：

```
ruby script/rails generate apn_on_rails:install 
```

# css - 将 col 布局降到 min-width 以下后，将其变为行布局

> ID：10587456
> 
> 赞同：-1
> 
> 时间：2012-05-14T16:35:33.353
> 
> 标签：css

我想实现下一个结果：我有 2 列，右边的列填充了剩余的宽度。一旦右列低于其最小宽度，它就必须低于左列，左列应填满整个宽度。这可能只使用css吗？

这是我能得到的最接近的值，但它在 FF 中不起作用，并且当 rightcol 低于它时，leftcol 显然保持其最小宽度为 100px。

```
#leftcol{
    background-color: blue;
    width: 20%;
    min-width: 100px;
    float: left;
}

#rightcol{
    background-color: yellow;
    min-width: 200px;
    overflow:hidden;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T16:40:51.067

您正在寻找的是类似于 1140 Grid 系统的东西。

看这里; [http://cssgrid.net/](http://cssgrid.net/)

下载并查看演示 - 通过使用媒体查询，您可以根据浏览器的宽度更改行/列的宽度 :-)

# mysql - 如果设置了变量，则添加 where 子句参数

> ID：10587458
> 
> 赞同：0
> 
> 时间：2012-05-14T16:35:44.710
> 
> 标签：mysql

我的 SQL 查询中有一个 WHERE 子句，并且想根据是否设置了 @Fran 变量来添加一个参数。

如果@Fran 为NULL，那么它根本不应该过滤结果。否则，如果设置了@Fran，那么它应该添加一个WHERE 子句“AND franid=@Fran”。我怎么能这样做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T16:37:59.547

```
SELECT ...
FROM ...
WHERE ...
AND ((@Fran IS NULL) OR (@Fran IS NOT NULL AND franid=@Fran)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T16:52:25.790

```
AND IFNULL(@Fran, franid) = franid 
```

`@Fran`如果是 NULL（那么它本质上是`franid = franid`）并且`@Fran = franid`如果它不是 NULL ，则结果为 TRUE 。

# javascript - Symfony2 Ajax 和 Jquery

> ID：10587463
> 
> 赞同：3
> 
> 时间：2012-05-14T16:35:56.987
> 
> 标签：javascript, jquery, ajax, templates, symfony

我正在开发一个使用 Symfony2 和 twig 作为模板的应用程序。我也在使用ajax。这是我的控制器中代码的一部分：

```
 public function testuaanotatuAction(Request $request)
    { 
      if ($request->isXmlHttpRequest())
      {
       return $this->forward('AnotatzaileaAnotatzaileaBundle:Page:Interpretatu');
      }

    // Some code.....
            return $this->render('AnotatzaileaAnotatzaileaBundle:Page:AnotatuInterpretazio.html.twig',
                                   array('Azpimarratu' => $Markagarria->getMarkIdent()));

}

    public function InterpretatuAction()
    {
      return $this->render('AnotatzaileaAnotatzaileaBundle:Page:FAQ.html.twig');
    } 
```

然后这是我在 AnotatuInterpretazio.html.twig 中的代码，如果我使用 JQuery 进行 Ajax 调用：

```
<script type='text/javascript'>
          $("#ButtonId").click(function () 
                             {
                               $.ajax({
                                        url: "{{ path('AnotatzaileaAnotatzaileaBundle_testuaanotatu') }}",
                                        type: "POST"
                                       });      
                         });
    </script> 
```

如您所见，我打算在这里做的是通过模板 AnotatuInterpretazio.html.twig 调用 InterpretatuAction。然后 InterpretatuAction 将调用另一个模板。它不起作用，有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T21:20:14.443

您需要`.success`在代码中使用函数。如果你不这样做，什么都不会发生

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-27T18:51:54.167

我认为问题在于 JavaScript 无法解析该方法`path()`，该方法仅在服务器端对 twig 有用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-08T16:03:41.877

您可以使用该方法`path()`，始终认为您在一个 twig 模板（虽然您是在一个脚本）里面`{{ }}`。它会是这样的：

```
<a href="{{ path('usuario_logout') }}">Cerrar sesión</a> 
```

这段代码是我的一个项目的一部分，它正在工作。

# .net - “无法加载文件或程序集......” DotNetOpenAuth + MVC3

> ID：10587466
> 
> 赞同：4
> 
> 时间：2012-05-14T16:36:17.783
> 
> 标签：.net, asp.net-mvc-3, dotnetopenauth, .net-assembly

我收到以下错误

```
 Could not load file or assembly 'file:///C:\Users\<project path>\bin\DotNetOpenAuth.dll'
    or one of it's dependencies. Operation is not supported. 
    (Exception from HRESULT: 0x80131515) 
```

当我尝试将控制器添加到 MVC3 框架内的 Controllers 文件夹时，我得到了这个。

我最近才开始使用 MVC3 和 DotNetOpenAuth，我一直在使用教程来尝试学习它，我正在复制的部分是：[http ://www.asp.net/mvc/tutorials/getting-started- with-aspnet-mvc3/cs/adding-a-model](http://www.asp.net/mvc/tutorials/getting-started-with-aspnet-mvc3/cs/adding-a-model)

我仍然可以运行该项目并且一切正常，我根本无法添加控制器。

我在 Windows 7 上使用 VS .NET 2010（64 位）。

让我知道是否需要任何其他信息，提前谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-15T12:37:11.693

可能与此有关：http: [//blogs.msdn.com/b/brada/archive/2009/12/11/visual-studio-project-sample-loading-error-assembly-could-not-be-loaded -并且-将-将-被忽略-不能-加载-文件-或-程序集-或-其中一个-依赖项-操作-不支持-异常-来自-hresult-0x80131515.aspx](http://blogs.msdn.com/b/brada/archive/2009/12/11/visual-studio-project-sample-loading-error-assembly-could-not-be-loaded-and-will-be-ignored-could-not-load-file-or-assembly-or-one-of-its-dependencies-operation-is-not-supported-exception-from-hresult-0x80131515.aspx)

这表示您需要在 Windows 资源管理器中取消阻止程序集。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T13:23:06.367

使用[fslogvw.exe](http://msdn.microsoft.com/en-us/library/e74a18c4%28v=vs.110%29.aspx)让 .NET 准确记录无法加载程序集的原因。

# grails - 从 Grails 域类中的映射属性中查询值

> ID：10587467
> 
> 赞同：0
> 
> 时间：2012-05-14T16:36:19.813
> 
> 标签：grails, grails-domain-class

我找到了 Burt Beckwith 在这个问题中提供的解决方案：[将用户定义属性添加到域类中](https://stackoverflow.com/questions/3382494)，并认为在某些情况下这对我们来说可能是一个可行的选择。在对此进行测试时，我有一个具有 Map 属性的域，如引用问题中所述。这是一个简化版本（我有更多非地图属性，但它们与这个问题无关）：

```
class Space {
    String spaceDescription
    String spaceType
    Map dynForm  

     String toString() {
    return (!spaceType)?id:spaceType + " (" + spaceDescription + ")"
 }  
} 
```

我在 dynForm 映射中保存了一些空间实例，其中包含一些任意数据，例如“Test1”：“abc”和“Test2”：“xyz”。

我正在尝试查询此数据并已成功使用 HQL 过滤执行以下操作：

```
String className = "Space"
Class clazz = grailsApplication.domainClasses.find { it.clazz.simpleName == className }.clazz

def res = clazz.executeQuery("select distinct space.id, space.spaceDescription from Space as space  where space.dynForm['Test1'] = 'abc'  " )  
log.debug "" +  res 
```

我想知道是否有办法在 select 语句中从 Map dynForm 中选择单个项目。像这样的东西：

```
def res = clazz.executeQuery("select distinct space.id, elements(space.dynForm['Test1']) from Space as space  where space.dynForm['Test1'] = 'abc'  " ) 
```

我可以像这样选择整个地图：

```
def res = clazz.executeQuery("select distinct elements(space.dynForm) from Space as space  where space.dynForm['Test1'] = 'abc' " ) 
```

但我只想根据字符串 idx 获取一个特定的实例。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T10:06:52.273

如何使用 Criteria，但我没有任何 sql server，所以我还没有测试。

```
def results = Space.createCriteria().list {
    dynForm{
        like('Test1', 'abc')
    }
} 
```

# c++ - 模板类中的静态函数

> ID：10587482
> 
> 赞同：5
> 
> 时间：2012-05-14T16:37:14.463
> 
> 标签：c++, function, templates, static

我正在尝试在模板中创建一种工厂类。我想做一个纯虚函数之类的东西，但它需要是静态的，因为我正在使用该函数来创建类型。

我想要发生的是当我声明一个类时，模板调用静态函数。静态函数实际上是在模板化类中声明的。

我已经做到了：

```
class Base
{

};

template<typename T>
class Type : public Base
{
public:
    static void Create()
    {
        mBase = CreateBase();
    }

private:
    static Base* CreateBase();

    static Base* mBase;
};

class MyType : public Type<MyType>
{
private:        
    static Base* CreateBase()
    {
        return new MyType;
    }
};

template<typename T>
Base* Type<T>::mBase = NULL;

void test()
{
    MyType::Create();
} 
```

我收到链接时间错误：

```
undefined reference to `Type<MyType>::CreateBase() 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T16:41:12.087

该`CreateBase`函数在基本类型中定义，因此只需调用它：

```
template<typename T>
class Type : public Base
{
public:
    static void Create()
    {
        mBase = Base::CreateBase();
    }
//... 
```

无需`CreateBase`在模板中声明另一个。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-15T08:53:52.070

找到了。

问题是我没有调用派生类的函数。

这是修复：

```
static void Create()
{
    mBase = T::CreateBase();
} 
```

# javascript - 如何通过 JS 变量的值增加 CSS 值？

> ID：10587484
> 
> 赞同：1
> 
> 时间：2012-05-14T16:37:35.717
> 
> 标签：javascript, css, arrays, position

我有几个具有相同类的固定位置 div，距离窗口左边缘的距离不同，我想在发生某个动作时在每个 div 上增加/减少该距离等量（在这种情况下，窗口正在调整大小）。我尝试使用 CSS 和百分比而不是像素来定位它们，但它并没有完全完成这项工作。

有没有办法将每个 div 的位置存储在一个数组中，然后添加/减去给定数量的像素？

到目前为止，这是我尝试过的方法-我仍然对 JS 有所了解，所以就我所知，这可能真的很糟糕，但是这里有：

```
roomObjects = $('.object-pos');

var objectCount = 0;

for ( var objectCount = 0; objectCount < 10; objectCount++;) {
          roomObjects = rooomObjects[objectCount];
          console.log(roomObjects.css("background-position").split(" "));
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T16:42:35.410

您可能会面临的一个问题是，在检索当前的 le​​ft 或 top 属性时，它们以字符串形式返回，末尾带有`px`of `%`。尝试`parseInt()`对返回的值运行 a 以获取一个数字，然后您很可能能够添加到这些值中。请确保在重新分配时，您在末尾酌情连接“px”或“%”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T16:51:21.817

你介意分享为什么百分比不起作用吗？如果您希望页面在窗口调整大小时正确缩放，通常这就是我的建议。我想如果你真的想要你可以做这样的事情：

```
$(window).resize(function() { 
    $('#whateverdiv').style.whateverproperty = $('#whateverdiv').style.whateverproperty.toString() + (newPosition - oldPosition);
    oldPosition = newPosition;
} 
```

这显然不是完整的代码，但你应该能够填补空白。您必须在页面加载时使用原始位置设置 oldPosition 变量，以便该函数第一次工作。

编辑：您还必须从 x.style.property 字符串中删除单位，以便您能够将值添加到它

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T17:00:21.170

你可以使用一点 jQuery ：

```
var el = $("#id");
var top = el.css("top");
el.css("top", top * 1.2); // increase top by 20% 
```

节省 DOM 中的乱七八糟

如果您想相对定位事物，这可能很有用：http: [//docs.jquery.com/UI/Position](http://docs.jquery.com/UI/Position)

# c# - 重做撤消绘图画布WP7

> ID：10587492
> 
> 赞同：0
> 
> 时间：2012-05-14T16:38:07.177
> 
> 标签：c#, windows-phone-7

在绘图画布上做一些工作，我想实现一个重做和撤消按钮。我尝试使用堆栈和数组，将最后一个点放入数组中，然后调用它或删除它，但我似乎无法让它工作。有这方面的文件吗？提前致谢。

在下面发表评论就是我在说的

```
this.ContentPanelCanvas.Children.Add(line);
                oldPoint = currentPoint;
                Point[] redoTest = { oldPoint }; 
```

以上是我试图存储的Oldpoint ..

后来为了回忆起这一点并撤消它，我尝试了这个：

```
private void Redo_Click(object sender, EventArgs e)
        {
            ContentPanelCanvas.Children.Remove(redoTest);
        } 
```

这给了我一个错误。它出什么问题了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T17:07:47.083

您可能会发现以下示例满足您的需求，它包括一个名为 undoLast 的方法，它将读取最后绘制的线：-

[http://www.windowsphonegeek.com/tips/WP7-DrawingBoard-sample-Drawing--Ink--made-easy](http://www.windowsphonegeek.com/tips/WP7-DrawingBoard-sample-Drawing--Ink--made-easy)

将以下行添加到新的撤消按钮单击事件处理程序：-

```
myBoard.undoLast(SimzzDev.DrawingBoard.PenMode.pen); 
```

# tridion - 在 SDL Tridion 2011 SP1 发布期间，已部署的二进制文件被锁定

> ID：10587496
> 
> 赞同：4
> 
> 时间：2012-05-14T16:38:15.313
> 
> 标签：tridion, tridion-2011

我有以下情况：

我发布了一个页面，其中包含多个二进制文件，然后由 HTTP 接收器接收并使用进程内部署程序进行部署，所有这些文件都托管在 IIS 中作为本地服务用户运行的专用应用程序池中。

页面存储在代理数据库中，二进制文件使用“D:\Binaries\Preview”之类的路径发布到本地文件系统。

预览文件夹作为只读共享共享给域用户，位于 \machinename\PreviewBinaries 之类的位置，以便可以使用 Web 应用程序显示二进制文件。

十有八九一切正常，但偶尔发布失败，这似乎是因为二进制文件被另一个进程锁定而无法覆盖。我已经使用 ProcessMon 和其他工具来尝试确定可能锁定这些文件的原因（无济于事）。有时我可以手动删除图像，然后再次发布作品。如果我在服务器上重新启动 IIS，我总是可以删除文件并发布。

有没有人对哪些进程可以锁定这些图像有任何建议？有没有人见过这个问题？我要发布到共享中是否有任何问题？或者 SiteEdit 2009 是否可能会锁定这些文件，因为它似乎只发生在我们的预览服务器上并且实时（没有 SiteEdit）似乎很好。

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T16:40:26.813

如果您使用的是 Windows 2008，您可以尝试从磁盘中删除该文件。然后它会告诉你哪个进程锁定了文件。但是鉴于重新启动 IIS 会解锁文件，似乎很可能是 IIS 锁定了它们。

我看不出 SiteEdit 2009 如何导致锁定这些文件。鉴于您可以将预览服务器放在另一个盒子上，SiteEdit 仅通过 HTTP 与该服务器通信。它从不直接访问预览服务器上的文件，甚至不通过 CD API。只是对您的网络服务器的常规请求，就像访问者一样。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-15T02:20:47.477

同样，不是直接的答案，但我还是想分享这个：

我见过类似的情况，我将页面发布到代理数据库并将二进制文件发布到文件系统。当我将应用程序池的标识更改为网络服务时，这个问题就消失了，我没有进一步研究它。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-15T16:35:37.350

好的，看起来有问题的代码在我们正在使用的 Presentation Framework 中。该框架使用[Response.TransmitFile(binaryPath)](http://msdn.microsoft.com/en-us/library/12s31dhy%28v=vs.80%29.aspx)将二进制文件异步传输到客户端。这似乎[在二进制文件上放置了一个临时锁定句柄](http://www.hashemian.com/blog/2008/11/asp-net-response-transmitfile-file-locking.htm)（即使它们位于只读共享上）。

我们删除了这行代码，并以另一种方式将应用程序修改为服务器二进制文件（我们现在重写路径，以便 IIS 可以直接传输文件）。这似乎解决了问题，并提高了网站性能。

感谢您的所有建议，它帮助我排除了所有没有导致问题的事情，因此我能够找到根本原因。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-14T16:52:29.590

是否有任何防病毒或索引服务正在运行。这些往往会在您不希望它们使用的时候使用非常短暂的锁定。特别是对于防病毒软件，这通常只是一个进程放弃它的锁定，并且就在您的另一个进程试图获取它之前。如果这是问题所在，那么设置一些排除目录应该会有所帮助。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-14T16:48:29.387

我看到您使用过 Process Monitor，但您是否尝试过 Sysinternals Process Explorer？“Find->Find Handle or Dll”对于这类事情非常有用。或者，如果您更喜欢命令行工具，Sysinternals 也可以制作 handle.exe，它会为您转储所有内容。

# python - ImportError - 在同一级别使用 Python 包

> ID：10587497
> 
> 赞同：4
> 
> 时间：2012-05-14T16:38:16.950
> 
> 标签：python

我有两个 Python 包，其中一个需要由另一个导入。目录结构如下：

```
workspace/
  management/
    __init__.py
    handle_management.py
    other_management.py
  utils/
    __init__.py
    utils_dict.py 
```

我正在尝试从文件`utils`中的项目导入功能`handle_management.py`：

```
import utils.utils_dict 
```

尝试运行时遇到的错误`handle_management.py`：

```
ImportError: No module named utils.utils_dict 
```

我已经阅读了很多有关如何解决此问题的信息，但似乎找不到有效的解决方案。

我[从从相对路径导入模块](https://stackoverflow.com/questions/279237/python-import-a-module-from-a-folder)开始- 我尝试了适用的解决方案，但没有一个奏效。

是唯一`workspace/`可以通过的解决方案`site_packages`吗？如果是这样，最好的方法是什么？

编辑：

我试图将 - 添加`/home/rico/workspace/`到`PYTHONPATH`- 不走运。

编辑2：

我能够成功使用 klobucar 的解决方案，但我认为它不会作为通用解决方案工作，因为该实用程序将被其他几个开发人员使用。我知道我可以使用一些 Python 概括来确定每个用户的相对路径。我只是觉得有一个更优雅的解决方案。

最终，该脚本将通过 cron 运行，以对多个 Python 项目执行单元测试。这也将可供每个开发人员使用，以确保在他们的开发过程中进行集成测试。

我需要能够使这更普遍。

编辑 3：

很抱歉，但对于我想要完成的事情，我真的不喜欢这些解决方案。我很感激您的意见 - 我将它们用作临时修复。作为一个完整的修复，我将考虑在`site_packages`目录中添加一个可用的脚本，该脚本将添加到`PYTHONPATH`. 这是多台机器和多个开发人员需要的东西。

一旦我构建了完整的解决方案，我将在此处发布我所做的并将其标记为解决方案。

编辑4：

我觉得好像我没有很好地表达我对这个问题的需求。下面的答案很好地解决了这个问题 - 但不是我的实际需求。结果，我在另一篇文章中重组了我的问题。我考虑过编辑这个，但是下面的答案（这对其他人非常有帮助）对更改没有意义，而且看起来不合适且无关紧要。

对于这个问题的修订版本，请参阅[无法普遍导入 Python 包](https://stackoverflow.com/questions/10637458/unable-to-import-python-package-universally#comment13789797_10637458)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T16:59:21.533

您有 2 个解决方案：

将工作区放在您的 PYTHONPATH 中：

```
import sys
sys.path.append('/path/to/workspace')

from utils import utils_dict 
```

（请注意，如果您在工作区中运行脚本，即导入句柄管理，很可能工作区已经在您的 PYTHONPATH 中，您不需要这样做，但这里似乎不是这种情况）。

或者，通过在工作空间目录中添加一个空（或不）`__init__.py`文件来使“工作空间”成为一个包。然后：

```
from ..utils import utils_dict 
```

我更喜欢第二个，因为如果你的 PYTHONPATH 中有另一个名为“utils”的模块，你会遇到问题

除此之外，您在这里导入错误：`import utils.utils_dict.py`. 您不需要包含文件“.py”的扩展名。您不是**在导入文件**，而是在导入**模块**（或包，如果它是一个文件夹），因此您不需要该文件的路径，您需要它的名称。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T16:42:52.720

将“workspace/”放在您的 PYTHONPATH 中，以便在搜索时使您可以使用下面的包。

这可以从你的 shell 配置文件中完成（如果你在 *nix 上，或者在 windows 上的环境变量。

例如，在 OSX 上，您可以添加到 ~/.profile （如果工作区在您的主目录中）：

```
export PYTHONPATH=$HOME/workspace:$PYTHONPATH 
```

另一种选择是使用[virtualenv](http://pypi.python.org/pypi/virtualenv/)使您的项目区域成为自己的包含环境。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T16:46:06.590

您需要做的是将工作区添加到您的导入路径。我会在工作空间中为你做一个包装器，或者只是将工作空间作为环境变量放在你的 PYTHONPATH 中。

```
import sys
# Add the workspace folder path to the sys.path list
sys.path.append('/path/to/workspace/')

from workspace.utils import utils_dict 
```

# kineticjs - 如何让用户在 kineticjs 中删除一组对象？

> ID：10587498
> 
> 赞同：0
> 
> 时间：2012-05-14T16:38:17.370
> 
> 标签：kineticjs

我在动态画布上有各种可拖动组。我需要让用户删除其中一些组。

第一个问题是如何从画布中实际删除组（及其所有部分）。

第二个是使用什么样的 UI 交互来允许用户这样做。我正在考虑绑定dragend，检查一些条件（例如对象的位置，或一些模态变量），如果满足条件则删除组。有更好的建议吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-20T10:49:13.503

嗨，我认为你可以删除一个组的所有元素

***yourGroup.removeChildren();***

之后（或之前）你可以这样做：

***yourGroup.getParent().remove(yourGroup);***

要从中删除组是 parent.strong 文本。

对于交互，它真的取决于你在做什么，有一个垃圾桶图标并拖动元素看起来像android中的界面。你也可以有一个“编辑模式”。当您处于编辑模式时，您选择您继续工作的组，然后在某个按钮中选择一个操作。像删除，复制...这种类型的界面看起来像一个ipad...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-29T11:21:09.230

关于您关于“删除”的问题——是的，节点实际上已被删除。如果你想自己检查一下，console.dir(stage) 在使用 remove() 或 destroy() 之前和之后——任何一个都做同样的事情——然后你会看到节点完全消失了。相反，如果您打算保留它以供以后使用，请改用 hide()。

关于“在垃圾桶上测试拖放的方法”，请查看这篇文章： [拖动碰撞](https://stackoverflow.com/questions/15563481/canvas-kineticjs-dragging-collisions)

# html - 如何仅使用 CSS 鼠标相关事件来交换文本框中的文本？

> ID：10587499
> 
> 赞同：0
> 
> 时间：2012-05-14T16:38:23.443
> 
> 标签：html, css, mouseevent, replace

我现在设置页面的方式非常可靠。我有一个图片库，当您的鼠标悬停在其中一个小图标上时，会弹出一个较大的图标，并且页面上最大的图像会变为该图像。我通过内联 CSS 使用 onMouseOver 和 onMouseOff 事件完成了这一切。

但是，我想对文本框做同样的事情。比如说，当我将鼠标悬停在狗的图片上时，我希望页面底部附近名为“dogdiv”的 div 中的文本出现在 id 为 textarea 的文本框中。我知道如何使用 JavaScript (JS) 来做到这一点，但由于我们使用的服务器受到限制，这不再是一种选择。它必须是直接的 CSS。

我知道这是可能的，但我似乎无法找出方法。你们中的任何人都可以告诉我我需要做什么才能完成这项工作吗？

```
<html> 
<head>
<title>Text/Photo Swap Test</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<style>
body {background: url('gradient.png');}

#gallery {position: relative; }
#gallery ul {list-style-type: none;
    width: 300px; }
#gallery li { display: inline; 
     float: left;
     padding: 5px; }
#gallery img {border-style: solid: 10px; border-color: #333; }
#gallery a { text-decoration: none;
             font-style: none;  
             color: #333; }

#mainPicture {
    float: right;
        }

.popOut
{
    cursor: default;
    list-style: none;
}
.popOut a
{
    cursor: default;
}
.popOut a .preview
{
    display: none;
}
.popOut a:hover .preview
{
    display: block;
    position: absolute;
    top: -33px;
    left: -45px;
    z-index: 1;
}
.popOut img
{
    background: #ebf0f3;
    border-color: #ebf0f3;
    border-style: solid;
    border-width: 1px;
    color: inherit;
    vertical-align: top;
    width: 100px;
    height: 75px;
}
.popOut li
{
    background: #ebf0f3;
    border-color: #CCCCCC;
    border-style: solid;
    border-width: 0px;
    color: inherit;
    display: inline;
    float: left;
    margin: 3px;
    padding: 2px;
    position: relative;
}
.popOut .preview
{
    border-color: #000;
    width: 200px;
    height: 150px;
}
.popOut p
{
    text-align: center;
}

#textarea
{
    background-color: #ebf0f3;
}

div.hideText
{
display:none;
}

</style>
</head>

<body>
<div class="mainPicture"><img id="awesome" src="http://ctd-dev.jdc.ao.dcn/sites/ctd-dev.jdc.ao.dcn/files/pictures/awesome.png" height="300" width="400" alt="" name="Awesome2"><!--style="position:relative; left:600px; top:326px;"--></div>

<td width="1000" rowdiv="3">
<div id="gallery">
    <ul class="popOut">
        <li>
            <a href="" onMouseOver="document.Awesome2.src='http://ctd-dev.jdc.ao.dcn/sites/ctd-dev.jdc.ao.dcn/files/pictures/dog.jpg';" onMouseOut="document.Awesome2.src='http://ctd-dev.jdc.ao.dcn/sites/ctd-dev.jdc.ao.dcn/files/pictures/dog.jpg';">
                <img src="http://ctd-dev.jdc.ao.dcn/sites/ctd-dev.jdc.ao.dcn/files/pictures/dog.jpg" width="100" height="75" alt="dog"><img src="http://ctd-dev.jdc.ao.dcn/sites/ctd-dev.jdc.ao.dcn/files/pictures/dog.jpg" width="100" height="75" alt="dog" class="preview"> 
            </a>
        </li>
        <li>
            <a href="" onMouseOver="document.Awesome2.src='http://ctd-dev.jdc.ao.dcn/sites/ctd-dev.jdc.ao.dcn/files/pictures/cat.jpg';" onMouseOut="document.Awesome2.src='http://ctd-dev.jdc.ao.dcn/sites/ctd-dev.jdc.ao.dcn/files/pictures/cat.jpg';">
                <img src="http://ctd-dev.jdc.ao.dcn/sites/ctd-dev.jdc.ao.dcn/files/pictures/cat.jpg" width="100" height="75" alt="cat"><img src="http://ctd-dev.jdc.ao.dcn/sites/ctd-dev.jdc.ao.dcn/files/pictures/cat.jpg" width="100" height="75" alt="cat" class="preview"> 
            </a>
        </li>
        <li>
            <a href="" onMouseOver="document.Awesome2.src='http://ctd-dev.jdc.ao.dcn/sites/ctd-dev.jdc.ao.dcn/files/pictures/parrot.jpg';" onMouseOut="document.Awesome2.src='http://ctd-dev.jdc.ao.dcn/sites/ctd-dev.jdc.ao.dcn/files/pictures/parrot.jpg';">
                <img src="http://ctd-dev.jdc.ao.dcn/sites/ctd-dev.jdc.ao.dcn/files/pictures/parrot.jpg" width="100" height="75" alt="parrot"><img src="http://ctd-dev.jdc.ao.dcn/sites/ctd-dev.jdc.ao.dcn/files/pictures/parrot.jpg" width="100" height="75" alt="parrot" class="preview"> 
            </a>
        </li>
        <li>
            <a href="" onMouseOver="document.Awesome2.src='http://ctd-dev.jdc.ao.dcn/sites/ctd-dev.jdc.ao.dcn/files/pictures/lizard.jpg';" onMouseOut="document.Awesome2.src='http://ctd-dev.jdc.ao.dcn/sites/ctd-dev.jdc.ao.dcn/files/pictures/lizard.jpg';">
                <img src="http://ctd-dev.jdc.ao.dcn/sites/ctd-dev.jdc.ao.dcn/files/pictures/lizard.jpg" width="100" height="75" alt="lizard"><img src="http://ctd-dev.jdc.ao.dcn/sites/ctd-dev.jdc.ao.dcn/files/pictures/lizard.jpg" width="100" height="75" alt="lizard" class="preview"> 
            </a>
        </li>
        <li>
            <a href="" onMouseOver="document.Awesome2.src='http://ctd-dev.jdc.ao.dcn/sites/ctd-dev.jdc.ao.dcn/files/pictures/horse.jpg';" onMouseOut="document.Awesome2.src='http://ctd-dev.jdc.ao.dcn/sites/ctd-dev.jdc.ao.dcn/files/pictures/horse.jpg';">
                <img src="http://ctd-dev.jdc.ao.dcn/sites/ctd-dev.jdc.ao.dcn/files/pictures/horse.jpg" width="100" height="75" alt="horse"><img src="http://ctd-dev.jdc.ao.dcn/sites/ctd-dev.jdc.ao.dcn/files/pictures/horse.jpg" width="100" height="75" alt="horse" class="preview"> 
            </a>
        </li>
        <li>
            <a href="" onMouseOver="document.Awesome2.src='http://ctd-dev.jdc.ao.dcn/sites/ctd-dev.jdc.ao.dcn/files/pictures/chicken.jpg';" onMouseOut="document.Awesome2.src='http://ctd-dev.jdc.ao.dcn/sites/ctd-dev.jdc.ao.dcn/files/pictures/chicken.jpg';">
                <img src="http://ctd-dev.jdc.ao.dcn/sites/ctd-dev.jdc.ao.dcn/files/pictures/chicken.jpg" width="100" height="75" alt="chicken"><img src="http://ctd-dev.jdc.ao.dcn/sites/ctd-dev.jdc.ao.dcn/files/pictures/chicken.jpg" width="100" height="75" alt="chicken" class="preview"> 
            </a>
        </li>
        <li onMouseOver="textarea.textarea2='chickendiv'">
            <a href="" onMouseOver="document.Awesome2.src='http://ctd-dev.jdc.ao.dcn/sites/ctd-dev.jdc.ao.dcn/files/pictures/awesome.png';" onMouseOut="document.Awesome2.src='http://ctd-dev.jdc.ao.dcn/sites/ctd-dev.jdc.ao.dcn/files/pictures/awesome.png';">
                <p>Default Image</p>
            </a>
        </li>
    </ul>

    <div id="textarea" style="height:600px;width:320px;font:14px;font:14px/26px Arial, Helvetica, sans-serif;overflow:scroll; position:relative;
    top:12px;"><div id="textarea2"><p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Morbi pulvinar lectus non lectus auctor egestas. Donec at nunc neque. Morbi ornare condimentum lobortis. Nam vehicula urna ac mauris pharetra rutrum. Duis et arcu eget sapien interdum porttitor ut et tortor. Maecenas ultricies dignissim pretium. Integer quis enim metus. Sed enim lacus, eleifend eu euismod volutpat, blandit eu sem. Vestibulum varius purus ut est accumsan pellentesque. Donec quis enim id lectus sollicitudin suscipit at volutpat augue. Curabitur et metus purus. Fusce luctus nunc vitae sapien pharetra id accumsan lectus malesuada.</p></div>
    </div>
    </div>
</td>

<div id="dogdiv" class="hideText"><p>The domestic dog (Canis lupus familiaris), is a subspecies of the gray wolf (Canis lupus), a member of the Canidae family of the mammilian order Carnivora. The term domestic dog is generally used for both domesticated and feral varieties. The dog may have been the first animal to be domesticated, and has been the most widely kept working, hunting, and companion animal in human history. The word dog may also mean the male of a canine species, as opposed to the word bitch for the female of the species.</p>
</div>
<div id="catdiv" class="hideText"><p>The domestic cat (Felis catus or Felis silvestris catus) is a small, usually furry, domesticated, carnivorous mammal. It is often called the housecat when kept as an indoor pet, or simply the cat when there is no need to distinguish it from other felids and felines. Cats are valued by humans for companionship and ability to hunt vermin and household pests. They are primarily nocturnal.</p>
</div>
<div id="parrotdiv" class="hideText"><p>Parrots, also known as psittacines are birds of the roughly 372 species in 86 genera that make up the order Psittaciformes, found in most tropical and subtropical regions. The order is subdivided into three superfamilies: the Psittacoidea  parrots), the Cacatuoidea (cockatoos) and the Strigopoidea (New Zealand parrots). Parrots have a generally pantropical distribution with several species inhabiting temperate regions in the Southern Hemisphere as well. The greatest diversity of parrots is found in South America and Australasia.</p>
</div>
<div id="lizarddiv" class="hideText"><p>Lizards are a widespread group of squamate reptiles, with more than 5600 species , ranging across all continents except Antarctica as well as most oceanic island chains. The group, traditionally recognized as the suborder Lacertilia, is defined as all extant members of the Lepidosauria (reptiles with overlapping scales), which are neither sphenodonts (i.e., tuatara) nor snakes ? they form an evolutionary grade. While the snakes are recognized as falling phylogenetically within the Toxicofera clade from which they evolved, the Sphenodonts are the sister group to the Squamates, the larger monophyletic group, which includes both the lizards and the snakes.</p>
</div>
<div id="horsediv" class="hideText"><p>The horse (Equus ferus caballus) is one of two extant subspecies of Equus ferus, or the wild horse. It is an odd-toed ungulate mammal belonging to the taxonomic family Equidae. The horse has evolved over the past 45 to 55 million years from a small multi-toed creature into the large, single-toed animal of today. Humans began to domesticate horses around 4000 BC, and their domestication is believed to have been widespread by 3000 BC. Horses in the subspecies caballus are domesticated, although some domesticated populations live in the wild as feral horses. These feral populations are not true wild horses, as this term is used to describe horses that have never been domesticated, such as the endangered Przewalski Horse, a separate subspecies, and the only remaining true wild horse. There is an extensive, specialized vocabulary used to describe equine-related concepts, covering everything from anatomy to life stages, size, colors, markings, breeds, locomotion, and behavior.</p>
</div>
<div id="chickendiv" class="hideText"><p>The chicken (Gallus gallus domesticus) is a domesticated fowl, a subspecies of the Red Junglefowl. As one of the most common and widespread domestic animals, and with a population of more than 24 billion in 2003, there are more chickens in the world than any other species of bird. Humans keep chickens primarily as a source of food, consuming both their meat and their eggs.</p>
</div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T18:54:25.000

将其粘贴在您的文档准备功能中

```
$("img").bind("mouseover", function(){
   var key = $(this).attr("alt");
   $("#textarea").text($("#" + key + "div").text());
}).bind("mouseout",function(){
   $("#textarea").text("");
}); 
```

这会将事件处理程序附加到页面上的每个图像： $("#popOut>img") 只会标记弹出列表中的图像。

好的，所以要解决必须做得不好的额外限制：

查询：

```
<img … 
    onmouseover='$("#textarea").text($("#" + $(this).attr("alt") + "div").text());'
    onmouseout='$("#textarea").text("");'
> 
```

DOM：

```
<img … 
    onmouseover='document.getElementById("textarea").innerText = document.getElementById( this.alt + "div").innerText;'
    onmouseout='document.getElementById("textarea").innerText = "";'
> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T16:53:05.447

这就是你需要的

```
<ul id="thumbs">

  <li>
    <div class="large-thumb"><img src="large-thumb.jpg" /></div>
    <div class="small-thumb"><img src="small-thumb.jpg /></div>
  </li>

  <li>
    <div class="large-thumb"><img src="large-thumb.jpg" /></div>
    <div class="small-thumb"><img src="small-thumb.jpg /></div>
  </li>

</ul> 
```

使用 CSS 您想应用于`display: none;`该类，`.large-thumb`请参阅下面的 css：

```
#thumbs {
  float: left;
  width: 100%;
  padding: 20px 0;}

#thumbs li {
  float: left;
  display: inline;
  margin-right: 10px;}

#thumbs li .large-thumb { display: none; /*Hide the large thumb*/}

#thumbs li:hover .large-thumb { display: block; /*Show on Hover*/} 
```

我将剩下的 CSS 留给你做，但你需要`li`相对定位，然后绝对定位大拇指以实现你想要做的事情。

希望这可以帮助 ：-）

# java - 通过参数指定泛型类型信息

> ID：10587500
> 
> 赞同：2
> 
> 时间：2012-05-14T16:38:24.393
> 
> 标签：java, generics

我有我正在重构的代码：

```
 if (response != null) {
        Type collectionType = new TypeToken<List<GameInfo>>() {}.getType();
        Gson gson = new Gson();
        return (List<GameInfo>) gson.fromJson(response, collectionType);
    } 
```

我可以创建一个“列表”部分可以是任何集合类型的函数吗？

非法代码示例：

```
private <T> T collectionFromJson(String pResponseJson, Class<T> pCollectionClass) {
    T result = null;
    Type collectionType = new TypeToken<pCollectionClass>() {
    }.getType();
    ...
    return result;
} 
```

非法调用非法代码的示例说明了我的目标：

```
return collectionFromJson(response, List<GameInfo>.class); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T16:52:19.077

使用参数这是不可能的`Class<T>`，因为`Class`仅支持表示原始类型，例如`List`- 类型`List<GameInfo>`不能由`Class`对象表示，这就是`TypeToken`存在的原因。

您的方法需要`TypeToken<T>`取而代之的是一个参数，并将其留给调用者来创建该参数：

```
private <T extends Collection<U>, U> T collectionFromJson(String pResponseJson, TypeToken<T> typeToken) {
    return (T)new Gson().fromJson(pResponseJson, typeToken.getType());
}

...

TypeToken<List<GameInfo>> typeToken = new TypeToken<List<GameInfo>>() { };
List<GameInfo> lst = collectionFromJson(response, typeToken); 
```

（免责声明：我只有 Java/泛型的经验，没有 GSON）

# java - 从多个 Java 字符串对象创建散列

> ID：10587506
> 
> 赞同：12
> 
> 时间：2012-05-14T16:38:51.367
> 
> 标签：java, hash, md5, hashcode, sha

实现类似方法的最快和更健壮（就唯一性而言）的方法是什么

```
public abstract String hash(String[] values); 
```

该`values[]`数组有 100 到 1,000 个成员，每个成员都有几十个字符，并且该方法每次需要在不同的`values[]`数组上运行大约 10,000 次/秒。

应该使用`StringBuilder`缓冲区构建长字符串，然后在缓冲区内容上调用哈希方法，还是继续为每个字符串调用哈希方法更好`values[]`？

显然，需要至少 64 位的散列（例如，MD5）来避免冲突，但是有没有什么更简单、更快的方法可以在相同的质量下完成？

例如，关于

```
public String hash(String[] values)
{
    long result = 0;

    for (String v:values)
    {
        result += v.hashCode();
    }

    return String.valueOf(result);
} 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-14T16:43:30.503

由于其线性特性，绝对不要使用简单的加法，但您可以稍微修改您的代码以实现非常好的分散。

```
public String hash(String[] values) {
  long result = 17;
  for (String v:values) result = 37*result + v.hashCode();
  return String.valueOf(result);
} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2017-03-03T23:14:47.837

它不提供 64 位哈希，但鉴于问题的标题，可能值得一提的是，自 Java 1.7 以来就有[java.util.Objects#hash(Object...)](https://docs.oracle.com/javase/8/docs/api/java/util/Objects.html#hash-java.lang.Object...-)。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2018-12-13T17:37:17.250

这是使用 Java 7 中可用的 Objects 类的简单实现。

```
@Override
public int hashCode()
{
    return Objects.hash(this.variable1, this.variable2);
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-14T16:54:03.457

在组合方法时，您应该注意创建弱点。（java哈希函数和你自己的）。我对级联密码做了一些研究，这就是一个例子。（添加可能会干扰 hashCode() 的内部结构。

hashCode() 的内部结构如下所示：

```
 for (int i = 0; i < len; i++) {
            h = 31*h + val[off++];
        } 
```

所以将数字加在一起会导致数组中所有字符串的最后一个字符被添加，这不会降低随机性（这对于哈希函数来说已经足够糟糕了）。

如果您想要真正的伪随机性，请查看[FNV](http://isthe.com/chongo/tech/comp/fnv/)哈希算法。它是目前最快的哈希算法，专为在 HashMaps 中使用而设计。

它是这样的：

```
 long hash = 0xCBF29CE484222325L;
    for(String s : strings)
    {
        hash ^= s.hashCode();
        hash *= 0x100000001B3L;
    } 
```

^ 这不是 FNV 的实际实现，因为它需要整数而不是字节作为输入，但我认为它也能正常工作。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-14T16:46:26.167

首先，哈希码通常是数字，例如`int`。此外，您的哈希函数版本创建 int ，然后使其字符串表示恕我直言没有任何意义。

我会改进你的哈希方法如下：

```
public int hash(String[] values) {
    long result = 0;
   for (String v:values) {
        result = result * 31 + v.hashCode();
    }
    return result;
} 
```

看看`hashCode()`在课堂上实现`java.lang.String`

# c++ - 为什么堆中调用的这个函数不能调用cout？

> ID：10587507
> 
> 赞同：0
> 
> 时间：2012-05-14T16:38:51.850
> 
> 标签：c++, visual-c++, memory-management, heap-memory

我试图调用在堆中分配的函数。经过一些失败的尝试后，我尝试了此网站中的代码：

[http://social.msdn.microsoft.com/forums/en-US/vcgeneral/thread/85d5da8c-edef-44b0-b42e-deb5f3eb2524](http://social.msdn.microsoft.com/forums/en-US/vcgeneral/thread/85d5da8c-edef-44b0-b42e-deb5f3eb2524)

代码完美无缺。它编译、运行、给出正确/预期的结果并且没有问题地完成。

但是，如果我尝试添加类似 std::cout << "Hello World!" << std::endl 在函数中，将其复制到堆中，然后执行它只是不起作用的堆函数。如果那里有 cout，它就不起作用，没有 cout，它就起作用。

我想知道为什么会这样，我该如何解决这个问题。意识到我这样做的唯一目的是学习，我没有兴趣将其应用于实际用途。

如果我堆函数调用一个使用 std::cout 打印数据的函数，那么该代码也不起作用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T16:42:35.037

在您所指的文章中，它指出：

> 只使用局部变量，不要使用全局变量、静态变量和常量字符串变量。

但是`std::cout`是全球性的。而且我认为字符串文字可能会被归类为“常量字符串变量”，尽管文章术语有些不精确。

正如其他人所说，这段代码的行为是未定义的，所以究竟发生了什么是特定于实现的。不同的编译器可能表现不同。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-14T16:41:49.340

您在这里依赖未定义的行为，并期望它做一些理智的事情。

如果您想知道您的特定平台上发生了什么“错误”，我建议使用调试器来单步执行机器代码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-14T17:11:09.630

您的问题在于，当您将`cout`代码添加到函数时，实际上是添加了一些函数调用。Microsoft C/C++ 编译器使用一些基本的堆栈帧检查来检测运行时的问题。这些检查是通过`__RTC_CheckEsp`在每次函数调用后调用函数来执行的。调用`__RTC_CheckEsp`使用 E8 操作码，这意味着相对寻址。当示例函数移动到堆中时，`__RTC_CheckEsp`由于跳转到了错误的位置，因此调用变得错误。

禁用运行时堆栈帧检查（在 Visual Studio 2010 中）：*项目选项*->*配置属性*-> *C/C++* ->*代码生成*->*基本运行时检查*-> 将其设置为**未初始化变量**

重新编译。跑。享受！

# php - TYPO3 建议向导，在子字符串中搜索

> ID：10587508
> 
> 赞同：0
> 
> 时间：2012-05-14T16:38:51.963
> 
> 标签：php, autocomplete, typo3, autosuggest, typo3-tca

我在 TYPO3 后端使用建议向导。

以下代码在 tca 中：

```
'tx_db_colors' => array (
'exclude' => 0,
'label' => 'Farbe',
    'config' => array (
        "type" => "group",
        "allowed" => "tx_db_colors",
        "foreign_table" => "tx_db_colors",
        "internal_type" => "db",
        "size" => 1,
        "minitems" => 0,
        "maxitems" => 1,
        'items' => array(array('', ''),),
        'wizards' => array(
            'suggest' => array(
                'type' => 'suggest',
            ),
        ),
    )
), 
```

有没有解决方案，在标签的子字符串中获取匹配的记录，而不是从头开始？

**例子：**

> 唱片标签被命名为“**咖啡黑**”
> 
> 当我在搜索字段中输入“co”时，将显示记录。
> 
> 'blac' 不会匹配任何记录。

当我输入子字符串时，是否可以找到该记录？否则我必须扩展自动完成功能。TYPO3 核心，哎呀！:-)

先感谢您！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-15T10:11:15.327

几个小时后，我找到了解决方案。您必须像这样编写 tca：

```
'tx_db_colors' => array (
    'exclude' => 0,
    'label' => 'Farbe',
    'config' => array (
        "type" => "group",
        "allowed" => "tx_db_colors",
        "foreign_table" => "tx_db_colors",
        "internal_type" => "db",
        "size" => 1,
        "minitems" => 0,
        "maxitems" => 1,
        'items' => array(array('', ''),),
        'wizards' => array(
            'suggest' => array(
                'type' => 'suggest',
                'default' => array(
                    'searchWholePhrase' => 1
                ),
            ),
        ),
    )
), 
```

只需添加

```
'default' => array(
    'searchWholePhrase' => 1
), 
```

进入“建议”数组。

# unix - 如何在 unix 中访问和查询数据库？

> ID：10587510
> 
> 赞同：1
> 
> 时间：2012-05-14T16:39:01.950
> 
> 标签：unix, sudo, su

我有一个关于unix的非常普遍的问题。在shell提示符下使用ls命令后，列出如下

```
students 
```

学生是我想访问的数据库。如何访问和查询这个数据库？我应该使用 sudo su 命令吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T16:42:52.647

首先，您确定数据库类型、它所在的位置（主机地址）、用户名和访问它的密码。您确定是否有合适的客户端连接到它。然后你连接并运行你的 sql 查询。

这是 sqllite 还是 berkly db？mysql？

如果 MySql，并且您安装了 mysql 客户端，并且 db 在 localhost... 上，请执行以下操作：

```
mysql -u username -p 
```

其中 username 是要连接的用户名。它会提示输入密码。在 mysql 提示符下查看所有 dbs：

```
show databases; 
```

选择这样的数据库：

```
use somedatase; 
```

然后查询离开。

# javascript - 灯箱外链问题

> ID：10587511
> 
> 赞同：0
> 
> 时间：2012-05-14T16:39:05.800
> 
> 标签：javascript, jquery, jquery-plugins

我的灯箱代码看起来像下面的代码，我试图将 2 个单词的句子“查看网站”链接到外部网站，但它却把整个事情搞砸了。

```
<li><a href="images/huelarge.png" title="XHTML | Javascript | Jquery | Design | Logo | <a href="siterpie.com">See website"</a>/>
   <a href="images/huelarge.png"><img src="images/huethumb.jpg" alt="" width="314" height="157" /></a></a></li>
<li> 
```

正确的网站链接是[这个](http://www.siteripe.com/portfolio.php)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T17:14:34.953

从您的网站引用

```
 <li><a href="images/huelarge.png" title="XHTML | Javascript | Jquery | Design | Logo "/>
      <a href="images/huelarge.png"><img src="images/huethumb.jpg" alt="" width="314" height="157" /></a></a></li>
    <li> 
```

问题是因为您在链接内关闭了两次。

这是更正后的代码：

```
 <li><a href="images/huelarge.png" title="XHTML | Javascript | Jquery | Design | Logo "/><img src="images/huethumb.jpg" alt="" width="314" height="157" /></a></li> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T17:15:52.600

我不是你想要的 100%，但你的 HTML 有点乱，你的第一个标题`<a>`是`<a href="siterpite.com`它的一部分。

也许试试

```
 <li>
       <a href="images/huelarge.png" title="XHTML | Javascript | Jquery | Design | Logo |" /></a>
       <a href="siterpie.com">See website</a>
       <a href="images/huelarge.png"><img src="images/huethumb.jpg" alt="" width="314" height="157" /></a>
   </li> 
```

# asp.net - .Net C# 中参考 Web.Config 的测试方法

> ID：10587516
> 
> 赞同：3
> 
> 时间：2012-05-14T16:39:19.337
> 
> 标签：asp.net, asp.net-mvc-3, web-config

我进行了很多搜索，但仍然找不到可靠的解决方案。假设您的应用程序中有方法。此方法使用“System.Web.Configuration.WebConfigurationManager.OpenWebConfiguration”来访问 web.config 中的某些设置。如果您尝试测试这些方法，您的测试将失败，因为您的测试项目没有 web.config。

解决此问题的最佳方法是什么。对于配置文件简单的项目，我通常使用这样的方法作为外观方法。

```
public class Config
{
    public static String getKeyValue(String keyName)
    {
        if (keyName == String.Empty) return String.Empty;
        String result = "";

        System.Configuration.Configuration rootWebConfig1 =
           System.Web.Configuration.WebConfigurationManager.OpenWebConfiguration(null);
        if (rootWebConfig1.AppSettings.Settings.Count > 0)
        {
            System.Configuration.KeyValueConfigurationElement reportEngineKey =
                rootWebConfig1.AppSettings.Settings[keyName];

            if (reportEngineKey != null)
            {
                result = reportEngineKey.Value;

            }

        }

        return result;
    }
} 
```

每次我尝试为 OpenWebConfiguration() 设置路径时，都会收到错误消息“不允许使用相对虚拟路径”

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T17:15:15.683

为了使该场景更可测试，我通常采用自己制作“设置管理器”并为其提供接口的方法。例如：

```
public interface IConfig
{
    string GetSettingValue(string settingName);
} 
```

然后我可以有我的“真正的”实现：

```
public sealed class Config : IConfig
{
    public string GetSettingValue(string settingName)
    {
        // your code from your getKeyValue() method would go here
    }
} 
```

然后我使用它的代码将采用 this 的一个实例（这是[Dependency Inversion Principal](http://en.wikipedia.org/wiki/Dependency_inversion_principle)的一个示例）：

```
public void DoStuff(IConfig configuration)
{
    string someSetting = configuration.GetSettingValue("ThatThingINeed");
    // use setting...
} 
```

所以现在对于我的生产代码，我可以调用`DoStuff`并传入一个`Config`. 当我需要测试时，我可以使用一个模拟工具（Moq、JustMock、RhinoMocks 等）来创建一个假的`IConfig`，它返回一个已知值而无需访问实际的 .config 文件，或者你可以在没有模拟框架的情况下通过制作你的自己的模拟（并将它们存储在您的测试项目中）。

```
public class ConfigMock : IConfig
{
    private Dictionary<string, string> settings;

    public void SetSettingValue(string settingName, string value)
    {
        settings[settingName] = value;
    }

    public string GetSettingValue(string settingName)
    {
        return settings[settingName];
    }
} 
```

和

```
[Test]
public void SomeExampleTest()
{
    var config = new ConfigMock();
    config.SetSettingValue("MySetting", "SomeValue");

    var underTest = new MyClass();
    underTest.DoStuff(config);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T16:59:34.900

最简单的方法是使用模拟库，例如[moq](http://code.google.com/p/moq/)。弄清楚它需要一些时间，但是一旦你这样做了，你就可以抽象出大部分管道，以返回可重复、一致的测试所需的值。

# android - Android：Facebook 用户撤销权限，不会授权

> ID：10587517
> 
> 赞同：0
> 
> 时间：2012-05-14T16:39:32.820
> 
> 标签：android, facebook

当用户通过 facebook 撤销应用程序权限时，此代码应要求用户重新授权，但事实并非如此。有人能看出什么不对吗？“facebook”是一个 Facebook 对象。

```
public void facebookSetup() {
    mPrefs = getPreferences(MODE_PRIVATE);
    String access_token = mPrefs.getString("access_token", null);   //load an access token from sharedPreferences
    long expires = mPrefs.getLong("access_expires", 0);     //do the same for the token expiration time

    if (access_token != null) { //if the access token exists in sharedPreferences, we'll use it
        facebook.setAccessToken(access_token);
    }
    if (expires != 0) { //if the expiration time exists in shared preferences, use it
        facebook.setAccessExpires(expires);
    }

    if (!facebook.isSessionValid()) {
        facebook.authorize(this, new String[] { "email", "publish_stream", "user_photos", "publish_actions"}, new DialogListener() {
            @Override
            public void onComplete(Bundle values) {
                SharedPreferences.Editor editor = mPrefs.edit();
                editor.putString("access_token", facebook.getAccessToken());
                editor.putLong("access_expires", facebook.getAccessExpires());
                editor.commit();
            }
            @Override
            public void onFacebookError(FacebookError error) {}

            @Override
            public void onError(DialogError e) {}

            @Override
            public void onCancel() {}
        });
    } 
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T15:54:53.113

这就是 Facebook SDK 文档所说的：

> 您可以通过检查 onComplete 方法的响应参数来检测访问令牌错误。在这种情况下，您将再次需要调用 facebook.authorize() 来重新验证用户并生成新的访问令牌。

您需要检查您的 Facebook 呼叫的响应以检测此类情况。例如：

```
JSONObject responseJSON = new JSONObject(response);
JSONObject errorJSON = responseJSON.optJSONObject("error");
if (errorJSON!=null) {
    String error =errorJSON.optString("type");           
    if (error!=null && error.equals("OAuthException")) {    
        facebook.authorize(activity, FACEBOOK_PERMISSIONS, facebookDialogListener); 
        return; 
    }       
} 
```

# asp.net-mvc - 从表单到控制器的用户选择的短期存储

> ID：10587519
> 
> 赞同：1
> 
> 时间：2012-05-14T16:39:40.840
> 
> 标签：asp.net-mvc

我正在尝试设想一种将所选项目列表存储到会话中以供以后使用的方法。我已经用谷歌搜索并阅读了 2 个小时的示例，但没有找到任何有效的示例。

基本思路是这样的。用户会看到要操作的项目列表。用户选择其中的一些。用户选择要执行的操作。控制器获取选定项目的列表，并开始对它们采取行动。

我想错了吗？使用 Ajax 操作在会话对象上存储“选择/取消选择”操作对我来说很有意义。我真的不希望整个数据库对象来处理这个。我只想要一个简单的选定对象列表。在经典的 ASP 中，我只是对表单帖子中的选定项目做出反应，但这在 asp.net mvc中似乎不*正确......*

如何构建这种行为（有或没有 Ajax，但最好没有数据库访问）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T16:43:59.170

我不明白，为什么不直接将`bool`s 数组或其他东西直接绑定到视图的复选框列表？您可以在控制器函数中将它们作为参数获取并直接对它们进行操作，无需中间人，它们只是另一个`POST`值。

或者当您将项目列表作为模型的一部分发送时甚至更好，使它们成为一个结构，该结构具有`bool selected=false`绑定到标签旁边的复选框的字段，您将直接在模型中获得结果。

# c# - Xml Xsd 验证失败 (xs:anyType)

> ID：10587520
> 
> 赞同：2
> 
> 时间：2012-05-14T16:39:46.153
> 
> 标签：c#, .net, xml, xsd, xml-validation

我有这个**XML**文件

```
<bookstore>  
  <test>
    <test2/>
  </test>
</bookstore> 
```

和这个**XSD**架构

```
<xsd:schema xmlns:xsd="http://www.w3.org/2001/XMLSchema">
  <xsd:element name="bookstore" type="bookstoreType"/>     
  <xsd:complexType name="bookstoreType">
    <xsd:sequence maxOccurs="unbounded">  
      <xsd:element name="test" type="xsd:anyType" />
    </xsd:sequence>                                       
  </xsd:complexType>
</xsd:schema> 
```

我打算从 C# 代码验证 xml 文件。有一种验证 XML 文件的方法：

```
 // validate xml
    private void ValidateXml()
    {
        _isValid = true;

        // Get namespace from xml file
        var defaultNamespace = XDocument.Load(XmlFileName).Root.GetDefaultNamespace().NamespaceName;

        // Set the validation settings.
        XmlReaderSettings settings = new XmlReaderSettings();
        settings.ValidationType = ValidationType.Schema;
        settings.ValidationFlags |= XmlSchemaValidationFlags.ReportValidationWarnings;
        settings.Schemas.Add(defaultNamespace, XsdFileName);
        settings.ValidationEventHandler += OnValidationEventHandler;

        // Create the XmlReader object.
        using(XmlReader reader = XmlReader.Create(XmlFileName, settings))
        {
            // Parse the file. 
            while (reader.Read()) ;    
        }
    }

    private void OnValidationEventHandler(object s, ValidationEventArgs e)
    {
        if (_isValid) _isValid = false;

        if (e.Severity == XmlSeverityType.Warning)
            MessageBox.Show("Warning: " + e.Message);
        else
            MessageBox.Show("Validation Error: " + e.Message);
    } 
```

我知道，这个 XML 文件是有效的。但是我的代码重新出现了这个错误：

```
Validation Error: Could not find schema information for the element 'test2' 
```

我的错误在哪里？

谢谢！！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T16:53:11.893

更新：我假设您的代码与您列出的错误相匹配（我已在 .NET 3.5SP1 上尝试过您的代码，但无法重现您的行为）。下面的解决方法应该肯定有效（您得到的错误与 process contents 子句一致，`strict`而不是`lax`）。

替换`<xsd:element name="test" type="xsd:anyType" />`为允许 xsd:any 的复杂内容，如下所示：

```
<xsd:schema xmlns:xsd="http://www.w3.org/2001/XMLSchema"> 
    <xsd:element name="bookstore" type="bookstoreType"/> 
    <xsd:complexType name="bookstoreType"> 
        <xsd:sequence maxOccurs="unbounded"> 
            <xsd:element name="test">
                <xsd:complexType>
                    <xsd:sequence>
                        <xsd:any minOccurs="0" maxOccurs="unbounded" processContents="lax"/>
                    </xsd:sequence>
                </xsd:complexType>
            </xsd:element>
        </xsd:sequence> 
    </xsd:complexType> 
</xsd:schema> 
```

有“松懈”仍然会产生信息；如果您希望该消息消失，您可以使用“跳过”。无论如何，`skip`在`lax`xsd:any 中可以为您提供所需的东西。

# c# - Devexpress GridView 条件单元格格式

> ID：10587522
> 
> 赞同：2
> 
> 时间：2012-05-14T16:39:59.170
> 
> 标签：c#, winforms, gridview, devexpress, appearance

有一个 gridView 和**Items to buy**。

```
Group
 - Checkbox|Item Description 
```

每个组最多可以购买的物品。

当达到最大值时（每组），我想更改所有未选择行的外观。

例子：

> 从每个组中选择 1 个项目

第 1 组

*   [ ] 项目 1
*   [ ] 项目 2

第 2 组

*   [ ] 第 3 项
*   [ ] 第 4 项
*   [ ] 项目 5

* * *

选择后

第 1 组

*   [x] 项目 1
*   [ ] 项目 2

第 2 组

*   [ ] 第 3 项
*   [x] 项目 4
*   [ ] 项目 5

检查每个组的最大项目数量后，我想更改其余项目的外观。

我有第一列的组摘要。我的问题是我不知道如何触发所有单元格的外观变化。在每个单元格离开事件中计算所选项目是否正确，或者是否有更好的方法来完成此操作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T08:10:18.793

我用 GridControl 创建了 Devexpress 模板。Person 类是为我创建的。我为这个例子做了一点改变。

```
public class Person {

    public Person(string firstName, string secondName) {
        this.FirstName = firstName;
        this.SecondName = secondName;
        this.Comments = String.Empty;
    }
    public Person(string firstName, string secondName, string comments)
        : this(firstName, secondName) {
            this.Comments = comments;
    }

    public bool Selected
    {
        get;
        set;
    }

    public bool Blocked
    {
        get;
        set;
    }

    public string FirstName
    {
        get;
        set;
    }
    public string SecondName
    {
        get;
        set;
    }
    public string Comments
    {
        get;
        set;
    }
} 
```

我的网格如下所示：

![我的网格看起来像这样](../Images/582a0ec45056ede38f9f5d70fa0a197a.png)

我用代码实现了你的功能：

```
public partial class Form1 : XtraForm
{
    int max = 2;

    public Form1()
    {
        InitializeComponent();
        InitGrid();

    }
    List<Person> gridDataList = new List<Person>();
    void InitGrid()
    {
        gridDataList.Add(new Person("John", "Smith"));
        gridDataList.Add(new Person("Gabriel", "Smith"));
        gridDataList.Add(new Person("Ashley", "Smith", "some comment"));
        gridDataList.Add(new Person("Adrian", "Smith", "some comment"));
        gridDataList.Add(new Person("Gabriella", "Smith", "some comment"));
        gridDataList.Add(new Person("John", "Forester"));
        gridDataList.Add(new Person("Gabriel", "Forester"));
        gridDataList.Add(new Person("Ashley", "Forester", "some comment"));
        gridDataList.Add(new Person("Adrian", "Forester", "some comment"));
        gridDataList.Add(new Person("Gabriella", "Forester", "some comment"));
        bindingSource1.DataSource = gridDataList;
    }

    private void gridView1_CellValueChanged(object sender, DevExpress.XtraGrid.Views.Base.CellValueChangedEventArgs e)
    {
        int parentHandle = gridView1.GetParentRowHandle(e.RowHandle);
        int count = gridView1.GetChildRowCount(parentHandle);
        int childHandle = -1;
        int nCount = 0;
        for (int i = 0; i < count; i++)
        {
            childHandle = gridView1.GetChildRowHandle(parentHandle, i);
            Person p = gridView1.GetRow(childHandle) as Person;
            if (p != null)
            {
                p.Blocked = false;
                if (p.Selected)
                {
                    nCount++;
                }
            }
        }
        if (nCount == max)
        {
            for (int i = 0; i < count; i++)
            {
                childHandle = gridView1.GetChildRowHandle(parentHandle, i);
                Person p = gridView1.GetRow(childHandle) as Person;
                if (p != null && !p.Selected)
                {
                    p.Blocked = true;
                }
            }
        }
        // to redraw grid
        gridView1.RefreshData();
    }

    private void richedSelected_EditValueChanged(object sender, EventArgs e)
    {
        gridView1.PostEditor();
    }

    private void gridView1_CustomDrawCell(object sender, DevExpress.XtraGrid.Views.Base.RowCellCustomDrawEventArgs e)
    {
        Person p = gridView1.GetRow(e.RowHandle) as Person;
        if (p != null && p.Blocked)
        {
            e.Appearance.ForeColor = Color.White;
        }
    }

    private void richedSelected_EditValueChanging(object sender, DevExpress.XtraEditors.Controls.ChangingEventArgs e)
    {
        Person p = gridView1.GetRow(gridView1.FocusedRowHandle) as Person;
        if (p != null && p.Blocked)
        {
            e.Cancel = true;
        }
    }

} 
```

这当然是简化的实现。只是为了让你走上正轨。

设计师的元素：

```
 private DevExpress.XtraGrid.GridControl gridControl;
    private DevExpress.XtraGrid.Views.Grid.GridView gridView1;
    private System.Windows.Forms.BindingSource bindingSource1;
    private DevExpress.XtraGrid.Columns.GridColumn colFirstName;
    private DevExpress.XtraGrid.Columns.GridColumn colSecondName;
    private DevExpress.XtraGrid.Columns.GridColumn colComments;
    private DevExpress.XtraGrid.Columns.GridColumn colSelected;
    private DevExpress.XtraEditors.Repository.RepositoryItemCheckEdit richedSelected; 
```

如果您找到任何更好的解决方案，请告诉我。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T06:35:42.193

这是我需要[链接的示例](http://community.devexpress.com/forums/p/4110/19622.aspx)

# java - 返回对象的对话框

> ID：10587525
> 
> 赞同：4
> 
> 时间：2012-05-14T16:40:06.547
> 
> 标签：java, swing, jdialog

是否可以在 Swing 中创建一个 JDialog，当单击 OK 按钮时会返回一个对象？

例如，对话框中的文本字段包含构成地址的组件（街道名称、国家/地区等）

单击确定按钮时，将返回一个地址对象。

为什么我认为这可能是因为[这个](http://docs.oracle.com/javase/tutorial/uiswing/components/dialog.html#input)。但我想要的是我上面提到的东西。

关于如何完成这项工作的任何指示都会非常有帮助。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-14T17:04:56.833

就像前面的人建议的那样：JOptionPane 可以帮助你做你想做的事。但是，如果您决定从头开始实现这一点，那么这里有一个 SSCCE，它可以完全满足您的需求（嗯，它返回一个字符串，但可以轻松修改它以满足您的需求）：

```
import java.awt.Font;
import java.awt.Dimension;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import javax.swing.*;

class MyDialog
{
    private JFrame parent;
    private JDialog dialog;
    private String information;

    MyDialog (JFrame parent)
    {
        this.parent = parent;
    }

    private JPanel createEditBox ()
    {
        JPanel panel = new JPanel ();

        JLabel dialogtitlelabel = new JLabel ("Enter Info");
        panel.add (dialogtitlelabel);
        dialogtitlelabel.setFont (new Font ("Arial", Font.BOLD, 20));

        final JTextArea informationtxt = new JTextArea ();
        informationtxt.setEditable (true);
        informationtxt.setLineWrap (true);
        informationtxt.setWrapStyleWord (true);

        JScrollPane jsp = new JScrollPane (informationtxt);
        jsp.setVerticalScrollBarPolicy (ScrollPaneConstants.VERTICAL_SCROLLBAR_AS_NEEDED);
        jsp.setHorizontalScrollBarPolicy (ScrollPaneConstants.HORIZONTAL_SCROLLBAR_NEVER);
        jsp.setPreferredSize (new Dimension (180, 120));
        panel.add (jsp);

        JButton btnok = new JButton ("OK");
        panel.add (btnok);

        JButton btncancel = new JButton ("Cancel");
        panel.add (btncancel);

        btnok.addActionListener (new ActionListener ()
        {
            @Override public void actionPerformed (ActionEvent a)
            {
                if (informationtxt.getText () == null || informationtxt.getText ().isEmpty ())
                {
                    return;
                }

                information = informationtxt.getText ();

                dialog.dispose ();
            }
        });

        btncancel.addActionListener (new ActionListener ()
        {
            @Override public void actionPerformed (ActionEvent a)
            {
                dialog.dispose ();
            }
        });

        return panel;
    }

    void display ()
    {
        final int DWIDTH = 200;
        final int DHEIGHT = 240;

        dialog = new JDialog (parent, "Information", true);
        dialog.setSize (DWIDTH, DHEIGHT);
        dialog.setResizable (false);
        dialog.setDefaultCloseOperation (JDialog.DISPOSE_ON_CLOSE);

        dialog.setContentPane (createEditBox ());

        dialog.setLocationRelativeTo (parent);
        dialog.setVisible (true);
    }

    String getInformation ()
    {
        return information;
    }
}

public class ReturningDialogTest
{
    public static void main (String[] args)
    {
        SwingUtilities.invokeLater (new Runnable ()
        {
            public void run ()
            {   
                final JFrame frame = new JFrame ();
                frame.setDefaultCloseOperation (JFrame.DISPOSE_ON_CLOSE);

                final JPanel panel = new JPanel ();

                JButton btn = new JButton ("show dialog");

                panel.add (btn);

                final JLabel lab = new JLabel ("");

                panel.add (lab);

                frame.add (panel);

                btn.addActionListener (new ActionListener ()
                {
                    public void actionPerformed (ActionEvent e)
                    {
                        MyDialog diag = new MyDialog (frame);
                        diag.display ();

                        String info = diag.getInformation ();

                        lab.setText (info);

                        frame.pack ();
                    }
                });

                frame.setLocationRelativeTo (null);
                frame.pack ();
                frame.setVisible (true);
            }
        });
    }
} 
```

当您按 OK 时，您在该文本区域中输入的内容会显示在主窗口中，只是为了证明它有效:)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-14T16:41:57.463

将保存地址的 GUI 组件放入面板中。将面板提供给对话框。关闭对话框后，从面板上的组件中读取值以构造`Address`对象。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-14T16:43:57.540

> 是否可以在 Swing 中创建一个 JDialog，当单击 OK 按钮时会返回一个对象？

这就是[JOptionPane 存在的原因](http://docs.oracle.com/javase/tutorial/uiswing/components/dialog.html)

> 单击确定按钮时，将返回一个地址对象。

请参阅[JOptionPane 功能](http://docs.oracle.com/javase/tutorial/uiswing/components/dialog.html#features)

# c++ - C++ MFC 从 CLSID (GUID) 创建 IShellItem

> ID：10587526
> 
> 赞同：0
> 
> 时间：2012-05-14T16:40:11.747
> 
> 标签：c++, shell, mfc, guid, clsid

我必须为 Windows 帮助和 Windows 运行创建一个 ShellItem...

我有这个

```
Help and Support    {2559a1f1-21d7-11d4-bdaf-00c04f60b9f0}
Run {2559a1f3-21d7-11d4-bdaf-00c04f60b9f0} 
```

来自[http://www.sevenforums.com/tutorials/110919-clsid-key-list-windows-7-a.html](http://www.sevenforums.com/tutorials/110919-clsid-key-list-windows-7-a.html)

我试过了

```
IShellFolder* desk = NULL;
HRESULT hr =SHGetDesktopFolder(&desk);
LPITEMIDLIST pidl2=NULL;
            ULONG cbEaten;
            DWORD dwAttribs = 0 ;

            hr = desk->ParseDisplayName(NULL,
                                         NULL,
                                         L"::{2559A1F1-21D7-11D4-BDAF-00C04F60B9F0}",
                                     &cbEaten,  // This can be NULL
                                         &pidl2,
                                         &dwAttribs); 
```

它返回 OK 但 Null 作为 pidl2

你们能给我一些帮助吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T21:24:07.027

如果您传递“shell:::{2559a1f3-21d7-11d4-bdaf-00c04f60b9f0}”，ParseDisplayName 应该能够解析它，但我想这并不是您真正想要的。

ParseDisplayName 能够解析一些 ::{clsid} 路径，但我认为它仅限于一组非常有限的 CSIDL_* 特殊文件夹。SHSimpleIDListFromPath 能够解析它。

如果你真的想用 ParseDisplayName 解析它，你可以尝试模拟 SHSimpleIDListFromPath：

```
class EmptyFileSystemBindData : public IFileSystemBindData {
public:
    STDMETHODIMP QueryInterface(REFIID riid, void **ppv)
    {
        if (riid == IID_IUnknown || riid == IID_IFileSystemBindData) {
            *ppv = static_cast<IUnknown*>(this);
            AddRef();
            return S_OK;
        }
        *ppv = NULL; return E_NOINTERFACE;
    }
    STDMETHODIMP_(ULONG) AddRef() { return 2; }
    STDMETHODIMP_(ULONG) Release() { return 1; }
    STDMETHODIMP SetFindData(const WIN32_FIND_DATAW *pfd) 
    {
        return S_OK;
    }
    STDMETHODIMP GetFindData(WIN32_FIND_DATAW *pfd)
    {
        ZeroMemory(pfd,sizeof(WIN32_FIND_DATAW));
        return S_OK;
    }
};

LPITEMIDLIST pidl2=NULL;
HRESULT hr;
IShellFolder*psf;
IBindCtx*pbc;
hr = CreateBindCtx(0,&pbc);
EmptyFileSystemBindData efsbd;
if (SUCCEEDED(hr))
{
    BIND_OPTS bo = {sizeof(bo)};
    bo.grfMode = STGM_CREATE;
    hr = pbc->RegisterObjectParam(STR_FILE_SYS_BIND_DATA,&efsbd);
    if (SUCCEEDED(hr) && 0==pbc->SetBindOptions(&bo))
    {
        hr = SHGetDesktopFolder(&psf);
        if (SUCCEEDED(hr))
        {
            hr = psf->ParseDisplayName(0,pbc,L"::{2559a1f3-21d7-11d4-bdaf-00c04f60b9f0}",0,&pidl2,0);
            if (SUCCEEDED(hr))
            {
                OutputDebugStringA("parsed ok\n");
                ILFree(pidl2);
            }
            psf->Release();
        }
    }
    pbc->Release();
} 
```

# javascript - 下面如何定义这个变量？

> ID：10587530
> 
> 赞同：0
> 
> 时间：2012-05-14T16:40:23.097
> 
> 标签：javascript, jquery

我有一个取消按钮，当用户上传文件时会出现。如果用户希望取消文件上传，那么他们可以通过单击“取消”按钮，它会向用户显示取消消息。

尝试此操作时的唯一问题是，它说明在我要显示消息的 stopImageUpload 函数中未定义 cancel_image_file_name。但我确实在 startImageUpload 函数中定义了这个。所以我的问题是如何从 startImageUpload 函数中获取 cancel_image_file_name 并在 stopImageUpload 函数中定义它？

下面是显示这两个函数的代码：

启动图像上传功能：

```
var cancelimagecounter = 0;

function startImageUpload(imageuploadform, imagefilename){

    cancelimagecounter++;

            var _cancelimagecounter = cancelimagecounter;

    $('.imageCancel').on("click", function(event) {
        var cancel_image_file_name = $(this).attr('cancel_image_file_name');

    return stopImageUpload(2, cancel_image_file_name);

});       
      return true;
} 
```

停止图像上传功能：

```
var imagecounter = 0;

function stopImageUpload(success, imagefilename){

      var result = '';
      imagecounter++;

      if (success == 1){
         result = '<span class="imagemsg'+imagecounter+'">The file was uploaded successfully!</span><br/><br/>';      
         $('.listImage').eq(window.lastUploadImageIndex).append('<div>' + htmlEncode(imagefilename) + '<button type="button" class="deletefileimage" image_file_name="' + imagefilename + '">Remove</button><br/><hr/></div>'); 
      }
      else if (success == 2){
          result = '<span class="imageemsg">' + cancel_image_file_name + ' Upload Was Cancelled!</span><br/><br/>';
      }
      else {
         result = '<span class="imageemsg">There was an error during file upload!</span><br/><br/>';
      }

      return true;   
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-14T16:43:07.750

在 JavaScript 中，变量具有函数级别的作用域，要进入您的其他函数，请***在两个函数之外***`cancel_image_file_name`定义它。

 ** * *

顺便说一句，您可以`imagefilename`从您的`stopImageUpload`函数中使用，因为您已经将它传递给该函数：

```
return stopImageUpload(2, cancel_image_file_name); 
```

因此，在您的`stopImageUpload`函数中，更改行：

```
result = '<span class="imageemsg">' + cancel_image_file_name + ' Upload Was Cancelled!</span><br/><br/>'; 
```

到：

```
result = '<span class="imageemsg">' + imagefilename + ' Upload Was Cancelled!</span><br/><br/>'; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T16:44:02.180

您已经将值作为第二个参数传递给“stopImageUpload”、“imagefilename”。就用那个。

事实上*，在同一个函数*的其他地方，您正在使用该参数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T16:44:25.267

像这样重构你的代码：

```
(function() {
    var cancelimagecounter = 0,
        imagecounter = 0,
        cancel_image_file_name;
    window.startImageUpload = function(imageuploadform,imagefilename) {
        ...
            cancel_image_file_name = ... // (remove the var)
        ...
    };
    window.stopImageUpload = function(success,imagefilename) {
        ...
        // cancel_image_file_name is not undefined now.
    };
})(); 
```*

# svn - 设置匿名用户访问目录 (SVN+SSH)

> ID：10587533
> 
> 赞同：1
> 
> 时间：2012-05-14T16:40:29.963
> 
> 标签：svn, ssh

我目前通过 SSH 设置了一个 SVN 存储库。这对于限制对整个存储库的读/写访问非常有用。但是，我还希望一个目录（即`pub`）仅供匿名用户使用`checkout`。鉴于我目前的设置，有什么简单的方法可以做到这一点吗？

# java - Android EditText setOnClickListener

> ID：10587535
> 
> 赞同：3
> 
> 时间：2012-05-14T16:40:37.797
> 
> 标签：java, android, android-edittext

我有一个 EditText 字段。当我在其上设置 onClickListener 时，它首先需要将焦点放在该字段上，然后单击以调用侦听器。所以实际上是两次点击调用监听器。如何解决此问题以从第一次点击开始工作？我不想将 focusable 设置为 false，因为那样程序将无法运行。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-14T17:33:25.483

正如其他人所说，第一次触摸聚焦视图，第二次触摸“点击”它。与其执行`OnClickListener`，不如执行`OnFocusChangeListener`。例如

```
EditText edittext = (EditText)findViewById(R.id.myedittext);
edittext.setOnFocusChangeListener(new View.OnFocusChangeListener() {
    @Override
    public void onFocusChange(View v, boolean hasFocus) {
        if(hasFocus) {
            //handle your situation here
        }
    }
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-11-17T05:35:53.500

当在 android 中触摸 EditText 时，首先它的焦点会改变。OnFocusChangeListener 第一次工作。

之后，onClickListener 每次都有效。

所以，如果你想在 EditText 监听器上实现一些东西，最好实现**setOnTouchListener**

每次它都会起作用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T16:55:55.270

我不完全理解您所说的两次单击以调用侦听器的意思。但是，如果 OnClick 方法被调用了两次，而您只希望代码运行一次，则可以创建一个标志作为成员变量来跟踪代码是否已经运行。例如，在初始化`firstTime`为之后`true`，在你的`onClick`方法中有这样的东西：

```
if (firstTime) {
  // Put code that you want executed once here
  firstTime = false;
}
else {
  firstTime = true;  // Second time: reset the flag
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-14T17:22:58.707

放

```
<requestFocus /> 
```

在您的 xml 中的编辑文本中。试试看，可能对你有帮助

```
 <EditText
            android:id="@+id/edtTxtEmail1"
            android:layout_width="240dp"
            android:layout_height="wrap_content"
            android:layout_marginTop="10dp"
            android:inputType="textEmailAddress"
            android:hint="Email ID" >
            <requestFocus />
        </EditText> 
```

# iphone - 在不同位置的手机之间直接发送数据

> ID：10587540
> 
> 赞同：5
> 
> 时间：2012-05-14T16:40:55.190
> 
> 标签：iphone, ios

我有一个 iPhone 应用程序的想法，它可以为我赚取数十亿美元，并帮助我接管世界。我目前正在设计应用程序的架构。我最初假设我需要创建和托管一个数据库，该数据库允许用户上传他们的数据并与其他目标用户共享。但我认为如果用户可以直接将他们的数据发送给彼此而不将其存储在数据库中会更好。但是，我无法找到任何表明这是可能的东西。

是否可以在不靠近（蓝牙）且不在 LAN 上的 iPhone 之间发送数据？例如...位于田纳西州的用户#1 创建了一些信息并点击“发送给其他人”，然后它将该信息直接发送给位于亚利桑那州的用户#2 和位于缅因州的用户#3。短信功能会被黑客入侵吗？

（我意识到属于用户 #2 和 #3 的手机必须打开，并运行将接收数据的应用程序）

我是移动开发的新手，我仍然习惯于移动设备的功能，所以我确信这是一个愚蠢的问题。但是，值得一问，因为如果可以做到，这将极大地改变这个应用程序的架构（和维护成本）。

提前感谢您提供的任何建议/指示。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T17:21:30.650

这是通过使用发布 - 订阅模式处理的。您可能想要研究[pubnub](http://www.pubnub.com/)等即插即用服务。这会让你做到这一点。应该接收彼此消息的电话将在同一 pubnub 频道上设置侦听器，并且当任何其他电话发布到该频道时将收到通知。像 pubnub 之类的东西有一个非常简单的 API/SDK，您可以使用它来快速启动和运行原型（并且至少在一开始是免费的）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T18:06:15.747

用户 #1 的应用程序将消息发送到您的服务器。您的服务器将 APNS 推送到用户 #2 和 #3 的电话。他们甚至不需要运行应用程序。

*无需标记正确或投票，但我会在新的世界秩序中从事高薪工作。*

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-14T18:30:24.573

Amazon 有一个名为 Simple Queue Service (Amazon SQS) 的应用程序服务，它允许您创建队列，其中包含应用程序可以订阅的消息。

引用他们的页面：

> Amazon Simple Queue Service (Amazon SQS) 提供了一个可靠、高度可扩展的托管队列，用于存储在计算机之间传输的消息。通过使用 Amazon SQS，开发人员可以简单地在执行不同任务的应用程序的分布式组件之间移动数据，而不会丢失消息或要求每个组件始终可用。Amazon SQS 与 Amazon Elastic Compute Cloud (Amazon EC2) 和其他 AWS 基础设施 Web 服务紧密结合，可以轻松构建自动化工作流程。
> 
> Amazon SQS 通过将 Amazon 的 Web 级消息传递基础设施公开为 Web 服务来工作。Internet 上的任何计算机都可以添加或读取消息，而无需安装任何软件或特殊的防火墙配置。使用 Amazon SQS 的应用程序组件可以独立运行，不需要在同一个网络上、使用相同的技术开发或同时运行。

他们有一个 iOS API 可以将其集成到您的应用程序中，每月最多 100,000 条消息免费，之后每 10,000 条消息 0.01 美元。

更多信息在这里： [http ://aws.amazon.com/sqs/](http://aws.amazon.com/sqs/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-11T20:59:17.870

> 是否可以在不靠近（蓝牙）且不在 LAN 上的 iPhone 之间发送数据？

这两个设备显然需要*某种*连接。

> 例如...位于田纳西州的用户#1 创建了一些信息并点击“发送给其他人”，然后它将该信息直接发送给位于亚利桑那州的用户#2 和位于缅因州的用户#3。短信功能会被黑客入侵吗？

这里的问题是：

*   帮助每个设备为其他设备找到正确的地址，并且...

*   确保设备可以相互访问。

移动设备在网络上不断移动，并随时更改其 IP 地址。当您开车去上班时，您的设备可能会通过其 3G 连接访问互联网，除非您开车穿过隧道并且根本没有任何连接。进入建筑物后，wifi 连接就可用，因此设备会切换到该连接。但是你公司的网络有一个防火墙来阻止传入的连接，而且你不可能事先知道你会在任何给定时间从 DHCP 服务器获得哪个 IP 地址。亚利桑那州和缅因州以及其他任何地方的人们也是如此。

另一方面，服务器通常位于易于发现（多亏了域名系统）、易于访问且几乎始终可用的地址。由于这些原因，移动设备通常通过中间服务器相互通信。

# php - Google API：无人看管的日历阅读。如何登录？

> ID：10587542
> 
> 赞同：3
> 
> 时间：2012-05-14T16:40:58.123
> 
> 标签：php, google-calendar-api, google-api-php-client

我以为这将是一件轻而易举的事。因此我一开始就被困住了:-(

我创建了一个谷歌日历，用户可以使用“共享”专用登录添加事件。然后我需要在我的服务器上编写一个 PHP 脚本来读取给定时间范围内的事件。

我认为这里描述的[API 密钥](https://developers.google.com/google-apps/calendar/firstapp)就足够了。但事实并非如此。

```
 curl https://www.googleapis.com/calendar/v3/users/me/calendarList?key=mykey 
```

说`Login required`。

因此，我阅读了有关[OAuth2.0](https://developers.google.com/accounts/docs/OAuth2)以及如何需要用户进行身份验证的信息。问题是我的脚本不是交互式的（尽管在脚本中硬编码登录对我来说不是问题：信息不是生命关键）。因此，我阅读了有关服务帐户的信息，但看起来它是针对非用户信息的。

问题：我如何编写脚本以强制登录而不涉及人工？

注意：[这个 SO question](https://stackoverflow.com/questions/4167282)看起来很有希望，但答案是针对 API 2.0 版，它似乎已经过时了。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-14T17:32:52.207

您需要做的第一件事是获取访问令牌。这将需要一个人。假设您使用的是[Google APIs PHP Client](http://code.google.com/p/google-api-php-client)，则可以使用此脚本完成（从命令行运行）。

注意：下面的代码片段适用**于已安装应用程序的客户端 ID**。确保在 Google API 访问控制台中创建此类型的客户端 ID。

```
require_once '../../src/apiClient.php';
defined('STDIN') or define('STDIN', fopen('php://stdin', 'r'));

$client = new apiClient();
// Visit https://code.google.com/apis/console to create your client id and cient secret
$client->setClientId('INSERT_CLIENT_ID');
$client->setClientSecret('INSERT_CLIENT_SECRET');
$client->setRedirectUri('urn:ietf:wg:oauth:2.0:oob');
$client->setScopes(array(
    'https://www.googleapis.com/auth/calendar',
    'https://www.googleapis.com/auth/calendar.readonly',
));

$authUrl = $client->createAuthUrl();

print "Please visit:\n$authUrl\n\n";
print "Please enter the auth code:\n";
$authCode = trim(fgets(STDIN));

$_GET['code'] = $authCode;
$token = $client->authenticate();
var_dump($token); 
```

这将为您提供一个包含您的 accessToken 和 refreshToken 的 json 编码字符串。accessToken 会在 1 小时后过期，但不用担心。refreshToken 不会过期（除非您卸载应用程序），并且可以用来获取新的 refreshToken。客户端库负责这部分。

接下来，将完整的 json 字符串令牌（不仅是 access_token 属性保存在安全的地方，并确保其他人无法读取它。然后，您的应用程序可以调用`$client->setAccessToken($token)`从安全位置查找 $token 的位置（同样，`$token`是完整的 json 编码字符串，不限于其`access_token`属性）。

现在，您可以向[日历 API](http://code.google.com/p/google-api-php-client/source/browse/trunk/examples/calendar/simple.php)发出经过身份验证的请求！

```
require_once '../../src/apiClient.php';
require_once '../../src/contrib/apiCalendarService.php';
session_start();

$client = new apiClient();
$client->setApplicationName("Google Calendar PHP Sample Application");
$cal = new apiCalendarService($client);

$client->setAccessToken($tokenFromSafePlace);

$calList = $cal->calendarList->listCalendarList();
print "<h1>Calendar List</h1><pre>" . print_r($calList, true) . "</pre>"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-03-23T16:59:32.510

使用最新版本的客户端库（对于 v3 api？）来获取您需要的令牌：

```
require_once 'Google/Client.php';
defined('STDIN') or define('STDIN', fopen('php://stdin', 'r'));

$client = new Google_Client();
// Visit https://console.developers.google.com/ to create your application and client id for a native app.
$client->setClientId('YOUR_CLIENT_ID');
$client->setClientSecret('YOUR_CLIENT_SECRET');
$client->setRedirectUri('urn:ietf:wg:oauth:2.0:oob');
$client->setScopes(array(
    'https://www.googleapis.com/auth/calendar',
    'https://www.googleapis.com/auth/calendar.readonly',
));

$authUrl = $client->createAuthUrl();

print "Please visit:\n$authUrl\n\n";
print "Please enter the auth code:\n";
$authCode = trim(fgets(STDIN));

$_GET['code'] = $authCode;
$token = $client->authenticate($authCode);
var_dump($token); 
```

要获取日历列表，您需要以下代码：

```
require_once 'Google/Client.php';
require_once 'Google/Service/Calendar.php';

$client = new Google_Client();
$client->setApplicationName("My Calendar example");
// token you got from the previous code
$client->setAccessToken($token);

$calendarService = new Google_Service_Calendar($client);
$calendarList = $calendarService->calendarList;

$calList = $calendarList->listCalendarList();
print "<h1>Calendar List</h1><pre>" . print_r($calList, true) . "</pre>"; 
```

# android - 通过多个活动传递字符串

> ID：10587547
> 
> 赞同：-1
> 
> 时间：2012-05-14T16:41:42.087
> 
> 标签：android, bundle, android-activity, src

我将项目类组织在多个 src 文件夹中，这些文件夹一直运行良好，直到我更改了活动之间的切换，现在将字符串传递合并到以下活动中。我认为问题与类路径有关。

```
 Bundle bundle = new Bundle();
                bundle.putString("email", userEmail);
                Intent intent = new Intent(MainActivity.this,
                        com.fm.mondev.MeanSelection.class);
                intent.putExtras(bundle);
                startActivity(intent); 
```

[编辑] 我意识到问题与类的路径并不完全相关，即使我目前有 MeanSelection.class 而不是 com.fm.mondev.MeanSelection.class。事实上，问题似乎与捆绑有关。当我在登录和主要活动之间使用它时它可以工作，但不适用于主要活动之后的活动。我还尝试了下面显示的替代方法。我对后续活动进行了相应的编辑。

```
 Intent intent = new Intent(MainActivity.this,
                        MeanSelection.class);
                intent.putExtra("email", userEmail);
                startActivity(intent); 
```

我查看了我的 logcat，但我没有发现任何有用的东西。如果我评论 putExtra(s) 行，我知道这有效。

[回答] 在查找了 logcat 的每个错误行并阅读了您的答案后，我意识到通过 Log.d 编写的变量之一存在问题。因此，解决方案是删除这些行，因为它们只是为了验证变量是否是通过捆绑包从先前的活动中正确选择的。我的结论是：从现在开始，我不会记录从一个活动传递到另一个活动的字符串。我不确定这是否真的是 Android 的问题，或者只是其中一个没有可行解释的问题，我们都非常清楚，但是一旦我删除了这些行，我的应用程序就启动并运行了。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-14T17:04:45.623

> 应用程序在应该打开第二个活动时崩溃。以下错误让我相信这与路径有关：“E/AndroidRuntime(7115): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.fm/com.fm.mondev.MeanSelection}: java. lang.NullPointerException: println 需要一条消息"

**println 需要一条**与活动无关的消息。阅读你的日志！

当我尝试`Log`使用空值时出现此错误，即

```
String foo = emptyBundle.getString("barValue");
Log.d(TAG, foo) // error, Log output functions cannot output null values.
Log.d(TAG, "barValue: " + barValue);  // outputs "barValue: null" 
```

确保您正在记录的任何内容或 System.out.printlning 都具有价值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T16:53:53.960

如果您只发送一个字符串，则不必使用 Bundle。

```
Intent intent = new Intent(MainActivity.this, com.fm.mondev.MeanSelection.class);
intent.putExtra("com.fm.MainActivity.userEmail", userEmail);
startActivity(intent); 
```

应该可以正常工作。我真的不知道这是否能解决您的问题，因为您从未说明错误消息是什么。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T17:09:01.480

根据您得到的异常，您在活动`E/AndroidRuntime(7115): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.fm/com.fm.mondev.MeanSelection}: java.lang.NullPointerException: println needs a message`中的某些日志记录代码中获得了 NPE `com.fm.mondev.MeanSelection`。

例如，检查这个：[NullPointerException : println need a message in android](https://stackoverflow.com/questions/6018633/null-pointer-exception-println-needs-a-message-in-android)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-14T17:37:48.123

实际上，您正在犯错误： java.lang.NullPointerException: println 需要一条消息

我认为您正在将一些空值传递给 println 方法

# javascript - HTML5 画布：如何为上下文设置动画？

> ID：10587549
> 
> 赞同：0
> 
> 时间：2012-05-14T16:41:48.843
> 
> 标签：javascript, html, animation, canvas, html5-canvas

有什么方法可以在 HTML5 canvas 2d 中为上下文设置动画？

我想创建巨大的上下文，但只在屏幕上显示其中的一小部分。然后我想应用`translate`动画来滚动上下文以显示上下文的其他部分。

我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T19:14:51.970

创建一个包含您要显示的全部内容的上下文的画布，如果需要，您可以将其显示在屏幕上，这样您就可以看到它的样子。

然后把你所拥有的东西放在一个函数或某种闭包中。然后使用 document.createElement('canvas')，并将它的上下文用于您为显示上下文创建的代码。

然后，您可以在可见画布的主要上下文中使用 .drawImage() 将其他上下文绘制到屏幕上，并在动画循环中向上设置动画。

我希望我能让它更容易理解，通过展示一个例子更容易理解。

离屏渲染本质上是我想要解释的。

# payment-processing - 调用创建Balanced商户账号返回不成功码是什么流程？

> ID：10587551
> 
> 赞同：2
> 
> 时间：2012-05-14T16:41:54.770
> 
> 标签：payment-processing, balanced-payments

重定向代码是否返回客户端需要重定向到的 URI？用户在 Balanced 网站上完成额外验证后，结果如何传回服务器？它是可配置的重定向uri吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T17:05:57.660

Balanced无法识别商家时，会返回**300状态码。**[您可以使用附加信息](https://www.balancedpayments.com/docs/merchant#requests-for-more-information)重新提交请求，也可以将商家重定向到响应中提供的位置，Balanced 将尝试收集更多信息并进行验证。

当您重定向用户时，您必须包含一个`redirect_uri`参数，商家将在识别过程结束时返回该参数。

您还可以传递查询字符串中的信息，以便为用户预先填写表单。这些字段应该与您包含在原始 JSON 有效负载中的字段相同，对于嵌套字典，您将字段括在方括号中。例如

```
{
    "name": "Joel Spolskey",
    "bank_account": {
        "bank_code": 321174851
    }
} 
```

应该成为

```
?name=Joel%20Spolskey&bank_account[bank_code]=321174851 
```

一旦 Balanced 验证了商家，用户就会被重定向回`redirect_uri`，以及商家的电子邮件地址和一个称为`merchant_uri`标识符的新参数。然后，您将`email_address`和`merchant_uri`参数发布到帐户端点，它将为您创建帐户。如果用户取消验证过程，他们将被重定向到，`redirect_uri`但在帐户端点上执行 POST 将返回原始 300 重定向，因为他们在系统中没有任何识别信息。

# virtual-machine - 在 Asterisk 上使用相同的 5060 端口，运行 VM 的 DNS 服务器

> ID：10587555
> 
> 赞同：0
> 
> 时间：2012-05-14T16:42:13.940
> 
> 标签：virtual-machine, sip, asterisk, openser

我家里有运行 OpenSER 1.1.1 和 Asterisk 1.4.01/DNS 服务器（两台计算机）的 SIP 服务器，但我想知道是否可以运行一台运行 2 个 VM（Debian 和 Debian）的计算机来运行 OpenSer 和 Asterisk/DNS服务器，分别。

目前端口 5060 用于在两台计算机之间进行通信（不用说每台计算机都有一个静态 IP 地址），但我想做的是让一台计算机运行两台运行 OpenSer 和 Asterisk/DNS 服务器的 VM。是否可以让他们通过同一个端口 5060 互相交谈？它会产生冲突吗？

请告诉我。感谢您的时间。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T16:56:53.810

如果每个虚拟机都有自己的 IP 地址，它就会工作。

# c# - c# 串口重定向

> ID：10587556
> 
> 赞同：3
> 
> 时间：2012-05-14T16:42:20.240
> 
> 标签：c#, windows-mobile, serial-port

有没有办法在 c# 中编写一个串口重定向器？我有一个编码为使用端口 1 (com1:) 的应用程序，但是，我在手持设备 (Intermec CN50) 上的端口始终为 3。我无权修改移动软件，但是我想重定向任何数据输出到 1 将其复制到 3 并且任何传入的数据将其从 3 复制到 1，因此应用程序不知道其中的区别。

我知道这是一个棘手的问题，但我相信你们中的一个人有一个答案。

我当然不会。

谢谢克里斯

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T16:54:51.503

不，没有。您有几种选择，具体取决于设备和您的确切需求。

第一个也是最简单的，是重定向驱动程序。 *如果*您的设备尚未定义 COM1 设备，您可以修改注册表`HKLM\drivers\builtin`并将特定端口的索引从 更改`3`为`1`。这将导致 device.exe 将端口公开为 COM1 而不是 COM3。但是，根据我的经验，这不太可能起作用，因为大多数串行端口都设置为让操作系统自动分配索引，这意味着 COM1 和 COM2 已经在使用中。但是，您仍然可以解决此问题。您只需为设备的 3 或以下的每个实例显式分配一个索引。将索引 1 移动到 3 并将索引 3 移动到 1，您可以有效地交换端口。

以下是一些示例 - 有一些示例，因为这取决于 OEM 设置驱动程序初始化的方式。这是一个没有明确命名端口的驱动程序示例（在本例中为 I2C，但它的工作方式相同）：

![没有端口的驱动程序](../Images/453036ab3b8b11c29316d066b903a451.png)

注意有一个`Prefix`和一个`Index`。该驱动程序将枚举为“I2C0:”。如果您将`Index`值更改为其他值，例如“2”，那么它将枚举为“I2C2：”。

在某些情况下，驱动程序可以提供特定的端口名称，例如：

![在此处输入图像描述](../Images/54af1c4161ba0ae66411c1e1922e3161.png)

请注意，该`Port`值与`Prefix`plus匹配`Index`。不知道如果您手动将它们设置为不同会发生什么，所以不要这样做。如果您想将此移至 COM3，您需要更改`Index`为 3 和`Port`COM3，但您必须确保注册表中没有任何其他内容已设置为使用这些值。您不希望两个驱动程序实例尝试在同一个索引处进行枚举。如果你这样做，我认为行为是第二​​个只是增加，但最好明确地将值设置为唯一的，这样你就知道发生了什么。

如果这不能满足您的需求，您必须编写一个实际的设备驱动程序来进行端口移动/聚合。它的工作原理很像 Windows Mobile 下现有的 GPS 中间驱动程序 (GPSID)，并允许您将串行数据重定向到您想要的任何端口。但是，这必须用 C 编写，因为托管代码（在 CF 中）无法导出本机符号，因此无法让 device.exe 加载 C# 程序集。

# php - 更新表时出错

> ID：10587558
> 
> 赞同：0
> 
> 时间：2012-05-14T16:42:27.543
> 
> 标签：php, mysql

```
 <?php 
 $id=$_REQUEST['id'];
 $sub=array();
 $sub=$_REQUEST['sub'];
 $total=0;
 for($i=0;$i<count($sub); $i++)
    {
        $total=$total+$sub[$i];
    }
 $link=mysql_connect("localhost","root","") or die("Cannot Connect to the    database!");

 mysql_select_db("nps_exam",$link) or die ("Cannot select the database!");
 $query= "UPDATE four SET 'sub[1]'='".$sub[0]."' , 'sub[2]'='".$sub[1]."' , 'sub[3]'='".$sub[2]."' , 'sub[4]'='".$sub[3]."' , 'sub[5]'='".$sub[4]."' , 'sub[6]'='".$sub[5]."' , 'sub[7]'='".$sub[6]."' , 'sub[8]'='".$sub[7]."' , 'sub[9]'='".$sub[8]."' , 'Music'='".$sub[9]."' , 'Arts'='".$sub[10]."' , 'total'='".$total."' WHERE Registration_no=='".$id."'";

      if(!mysql_query($query,$link))
      {die ("An unexpected error occured while saving the record, Please try again!");}
      else
     {
      echo "Record updated successfully!";}
 ?> 
```

我是 php 的新手。同时从上面的 php 代码更新记录。我总是收到错误消息说保存记录时发生意外错误，我也无法更新我的数据..请任何人帮助..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T16:44:58.950

您需要将 WHERE 子句从：

```
WHERE Registration_no=='".$id."' 
```

到

```
WHERE Registration_no='".$id."' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T16:44:17.743

做这个 ：

```
if(!mysql_query($query,$link)) {
   die (mysql_error());
} else {
  echo "Record updated successfully!";
} 
```

`mysql_error()`会给你确切的错误信息 - 问题可能是任何事情......连接问题/查询语法错误/丢失数据等

# java - java中受密码保护的zip文件

> ID：10587561
> 
> 赞同：35
> 
> 时间：2012-05-14T16:42:37.483
> 
> 标签：java, zip

我已经使用 java 创建了 zip 文件，如下所示

```
import java.io.*;
import java.util.zip.*;

public class ZipCreateExample {
  public static void main(String[] args) throws IOException {
    System.out.print("Please enter file name to zip : ");
    BufferedReader input = new BufferedReader
        (new InputStreamReader(System.in));
    String filesToZip = input.readLine();
    File f = new File(filesToZip);
    if(!f.exists()) {
      System.out.println("File not found.");
      System.exit(0);
    }
    System.out.print("Please enter zip file name : ");
    String zipFileName = input.readLine();
    if (!zipFileName.endsWith(".zip"))
      zipFileName = zipFileName + ".zip";
    byte[] buffer = new byte[18024];
    try {
      ZipOutputStream out = new ZipOutputStream
          (new FileOutputStream(zipFileName));
      out.setLevel(Deflater.DEFAULT_COMPRESSION);
      FileInputStream in = new FileInputStream(filesToZip);
      out.putNextEntry(new ZipEntry(filesToZip));
      int len;
      while ((len = in.read(buffer)) > 0) {
        out.write(buffer, 0, len);
      }
      out.closeEntry();
      in.close();
      out.close();
    } catch (IllegalArgumentException iae) {
      iae.printStackTrace();
      System.exit(0);
    } catch (FileNotFoundException fnfe) {
      fnfe.printStackTrace();
      System.exit(0);
    } catch (IOException ioe) {
      ioe.printStackTrace();
      System.exit(0);
    }
  }
} 
```

现在我想当我点击 zip 文件时，它应该提示我输入密码，然后解压缩 zip 文件。请任何帮助，我应该如何走得更远？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2016-05-04T19:56:30.167

尝试以下基于以下代码[`Zip4j`](http://mvnrepository.com/artifact/net.lingala.zip4j/zip4j)：

```
import net.lingala.zip4j.core.ZipFile;
import net.lingala.zip4j.exception.ZipException;
import net.lingala.zip4j.model.ZipParameters;
import net.lingala.zip4j.util.Zip4jConstants;
import org.apache.commons.io.FilenameUtils;

import java.io.File;

public class Zipper
{
    private String password;
    private static final String EXTENSION = "zip";

    public Zipper(String password)
    {
        this.password = password;
    }

    public void pack(String filePath) throws ZipException
    {
        ZipParameters zipParameters = new ZipParameters();
        zipParameters.setCompressionMethod(Zip4jConstants.COMP_DEFLATE);
        zipParameters.setCompressionLevel(Zip4jConstants.DEFLATE_LEVEL_ULTRA);
        zipParameters.setEncryptFiles(true);
        zipParameters.setEncryptionMethod(Zip4jConstants.ENC_METHOD_AES);
        zipParameters.setAesKeyStrength(Zip4jConstants.AES_STRENGTH_256);
        zipParameters.setPassword(password);
        String baseFileName = FilenameUtils.getBaseName(filePath);
        String destinationZipFilePath = baseFileName + "." + EXTENSION;
        ZipFile zipFile = new ZipFile(destinationZipFilePath);
        zipFile.addFile(new File(filePath), zipParameters);
    }

    public void unpack(String sourceZipFilePath, String extractedZipFilePath) throws ZipException
    {
        ZipFile zipFile = new ZipFile(sourceZipFilePath + "." + EXTENSION);

        if (zipFile.isEncrypted())
        {
            zipFile.setPassword(password);
        }

        zipFile.extractAll(extractedZipFilePath);
    }
} 
```

[`FilenameUtils`](https://commons.apache.org/proper/commons-io/javadocs/api-1.4/org/apache/commons/io/FilenameUtils.html)是从[`Apache Commons IO`](http://mvnrepository.com/artifact/commons-io/commons-io)。

示例用法：

```
public static void main(String[] arguments) throws ZipException
{
    Zipper zipper = new Zipper("password");
    zipper.pack("encrypt-me.txt");
    zipper.unpack("encrypt-me", "D:\\");
} 
```

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2012-05-14T16:52:06.413

标准 Java API 不支持受密码保护的 zip 文件。幸运的是，好人已经为我们实现了这种能力。请查看这篇解释如何创建受密码保护的 zip 的文章。
（链接失效，最新存档版本：[https](https://web.archive.org/web/20161029174700/http://java.sys-con.com/node/1258827) ://web.archive.org/web/20161029174700/http://java.sys-con.com/node/1258827 ）

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2015-08-27T15:04:44.100

下面的示例代码将压缩和密码保护您的文件。此 REST 服务接受原始文件的字节。它压缩字节数组并用密码保护它。然后它发送密码保护的压缩文件字节作为响应。该代码是向 REST 服务发送和接收二进制字节以及使用密码保护压缩文件的示例。字节是从流中压缩的，因此服务器上不会存储任何文件。

*   在 java 中使用 JAX-RS API 使用 Jersey API
*   客户端正在使用 Jersey-client API。
*   使用 zip4j 1.3.2 开源库和 apache commons io。

```
 @PUT
    @Path("/bindata/protect/qparam")
    @Consumes(MediaType.APPLICATION_OCTET_STREAM)
    @Produces(MediaType.APPLICATION_OCTET_STREAM)
    public Response zipFileUsingPassProtect(byte[] fileBytes, @QueryParam(value = "pass") String pass,
            @QueryParam(value = "inputFileName") String inputFileName) {

        System.out.println("====2001==== Entering zipFileUsingPassProtect");
        System.out.println("fileBytes size = " + fileBytes.length);
        System.out.println("password = " + pass);
        System.out.println("inputFileName = " + inputFileName);

        byte b[] = null;
        try {
            b = zipFileProtected(fileBytes, inputFileName, pass);
        } catch (IOException e) {
            e.printStackTrace();
            return Response.status(Status.INTERNAL_SERVER_ERROR).build();
        }
        System.out.println(" ");
        System.out.println("++++++++++++++++++++++++++++++++");
        System.out.println(" ");
        return Response.ok(b, MediaType.APPLICATION_OCTET_STREAM)
                .header("content-disposition", "attachment; filename = " + inputFileName + ".zip").build();

    }

    private byte[] zipFileProtected(byte[] fileBytes, String fileName, String pass) throws IOException {

        ByteArrayInputStream inputByteStream = null;
        ByteArrayOutputStream outputByteStream = null;
        net.lingala.zip4j.io.ZipOutputStream outputZipStream = null;

        try {
            //write the zip bytes to a byte array
            outputByteStream = new ByteArrayOutputStream();
            outputZipStream = new net.lingala.zip4j.io.ZipOutputStream(outputByteStream);

            //input byte stream to read the input bytes
            inputByteStream = new ByteArrayInputStream(fileBytes);

            //init the zip parameters
            ZipParameters zipParams = new ZipParameters();
            zipParams.setCompressionMethod(Zip4jConstants.COMP_DEFLATE);
            zipParams.setCompressionLevel(Zip4jConstants.DEFLATE_LEVEL_NORMAL);
            zipParams.setEncryptFiles(true);
            zipParams.setEncryptionMethod(Zip4jConstants.ENC_METHOD_STANDARD);
            zipParams.setPassword(pass);
            zipParams.setSourceExternalStream(true);
            zipParams.setFileNameInZip(fileName);

            //create zip entry
            outputZipStream.putNextEntry(new File(fileName), zipParams);
            IOUtils.copy(inputByteStream, outputZipStream);
            outputZipStream.closeEntry();

            //finish up
            outputZipStream.finish();

            IOUtils.closeQuietly(inputByteStream);
            IOUtils.closeQuietly(outputByteStream);
            IOUtils.closeQuietly(outputZipStream);

            return outputByteStream.toByteArray();

        } catch (ZipException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        } finally {
            IOUtils.closeQuietly(inputByteStream);
            IOUtils.closeQuietly(outputByteStream);
            IOUtils.closeQuietly(outputZipStream);
        }
        return null;
    } 
```

下面的单元测试：

```
 @Test
    public void testPassProtectZip_with_params() {
        byte[] inputBytes = null;
        try {
            inputBytes = FileUtils.readFileToByteArray(new File(inputFilePath));
        } catch (IOException e) {
            e.printStackTrace();
        }
        System.out.println("bytes read into array. size = " + inputBytes.length);

        Client client = ClientBuilder.newClient();

        WebTarget target = client.target("http://localhost:8080").path("filezip/services/zip/bindata/protect/qparam");
        target = target.queryParam("pass", "mypass123");
        target = target.queryParam("inputFileName", "any_name_here.pdf");

        Invocation.Builder builder = target.request(MediaType.APPLICATION_OCTET_STREAM);

        Response resp = builder.put(Entity.entity(inputBytes, MediaType.APPLICATION_OCTET_STREAM));
        System.out.println("response = " + resp.getStatus());
        Assert.assertEquals(Status.OK.getStatusCode(), resp.getStatus());

        byte[] zipBytes = resp.readEntity(byte[].class);
        try {
            FileUtils.writeByteArrayToFile(new File(responseFilePathPasswordZipParam), zipBytes);
        } catch (IOException e) {
            e.printStackTrace();
        }
    } 
```

随意使用和修改。如果您发现任何错误，请告诉我。希望这可以帮助。

编辑 1 - 使用 QueryParam，但您可以使用 HeaderParam 代替 PUT 以隐藏 passwd 以使视线不可见。相应地修改测试方法。

编辑 2 - REST 路径是 filezip/services/zip/bindata/protect/qparam

filezip 是战争的名称。services 是 web.xml 中的 url 映射。zip 是类级别的路径注释。bindata/protect/qparam 是方法级别的路径注释。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2020-10-23T13:47:48.650

在新版本的**Zip4j**中，类**Zip4jConstants**被删除。请改用**EncryptionMethod**和**AesKeyStrength**类。文档： [https ://github.com/srikanth-lingala/zip4j](https://github.com/srikanth-lingala/zip4j)

```
ZipParameters zipParameters = new ZipParameters();
zipParameters.setEncryptFiles(true);
zipParameters.setEncryptionMethod(EncryptionMethod.AES);
zipParameters.setAesKeyStrength(AesKeyStrength.KEY_STRENGTH_256); 

List<File> filesToAdd = Arrays.asList(
    new File("somefile"), 
    new File("someotherfile")
);

ZipFile zipFile = new ZipFile("filename.zip", "password".toCharArray());
zipFile.addFiles(filesToAdd, zipParameters); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-14T16:54:39.333

没有用于创建密码保护文件的默认 Java API。[这里](http://j2ee.ulitzer.com/node/1258827/mobile)还有另一个关于如何做的例子。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-09-06T09:51:47.347

Library **Zip4J**似乎是首选答案。如果强烈建议密码的隐私，即使在 ZipFile 关闭后，也可以关闭以*纯文本*`class ZipFile`形式携带密码的安全漏洞。以下方法会破坏密码。

 *```
public static void destroyZipPassword(ZipFile zip) throws DestroyFailedException
{
    try
    {
        Field fdPwd = ZipFile.class.getDeclaredField("password");
        fdPwd.setAccessible(true);
        char[] password = (char[]) fdPwd.get(zip);
        Arrays.fill(password, (char) 0);
    }
    catch (Exception e)
    {
        e.printStackTrace();
        throw new DestroyFailedException(e.getMessage());
    }
} 
```*

# javascript - 遇到问题 undefined !== undefined

> ID：10587566
> 
> 赞同：5
> 
> 时间：2012-05-14T16:42:54.550
> 
> 标签：javascript, jquery, ajax, types

我正在尝试在 ajax 调用中处理完整的函数。如果值未定义，我想将 var 转换为空字符串。否则，我想将值捕获到字符串数组中。

问题是我正在输入 if 语句，即使将相关变量的值记录为未定义也是如此。我在这里想念什么？

```
completefunc: function (xData, Status) {
      $(xData.responseXML).SPFilterNode("z:row").each(function() {
        if(typeof $(this).attr("ows_Products") !== undefined) {
          console.log($(this).attr("ows_Products"));
          arr = $(this).attr("ows_Products").split(',');
        }
        else {
          arr = "";
        }
      });
    } 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-05-14T16:44:44.097

`typeof`返回一个字符串值，因此您需要将其`"undefined"`作为字符串进行比较。例如，

```
if(typeof $(this).attr("ows_Products") !== "undefined") { ... } 
```

* * *

编辑 - 更多信息：

如果您查看[MDN 页面的 typeof](https://developer.mozilla.org/en/JavaScript/Reference/Operators/typeof)，您会看到：

> typeof 运算符返回一个字符串，指示未计算的操作数的类型。

这与返回自身非常不同`Type`（在 JavaScript 中可能类似于返回构造函数，如`String`,`Array`等）。因此，在使用 时`typeof`，您将始终与诸如`"object"`、`"string"`、`"undefined"`等字符串进行比较。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T16:59:07.287

```
if($(this).attr("own_Products")){
       arr = $(this).attr("ows_Products").split(',');
}else{
       arr=""
} 
```

# mysql - 小数据库性能难题

> ID：10587571
> 
> 赞同：0
> 
> 时间：2012-05-14T16:43:14.037
> 
> 标签：mysql, performance, database-design

我对数据库不是很熟悉，但我有一个小问题。我正在尝试创建一个数据库来存储学生和讲师所学的课程，所以我创建了三个表。在讲师和学生表中，现场课程代表讲师或学生所学课程的逗号分隔列表。

*像这样的东西：*

> 讲师 - 课程 - “1,2”
> 
> 学生 - 课程 - “1,2,3”
> 
> 课程 - 1 - “生物”

然而问题是，当我想根据他们的课程显示学生列表时，我必须搜索所有学生和课程并再次搜索以检查 csv 列表是否有指定的课程（这似乎有点多余）。有没有另一种方法可以实现这个目标，比如通过关联/引用索引或其他方式？谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-14T16:47:48.030

> 实地课程代表讲师或学生所学课程的逗号分隔列表

包含 a 的字段`csv list`违反了[第一范式 (1NF)](http://en.wikipedia.org/wiki/First_normal_form)，并且存在各种问题，包括性能问题。将此字段分解为单独的连接表`{StudentID, CourseID}`是您应该做的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-14T16:53:32.857

创建两个新表：

```
student_courses(int student_id, int course_id)
lecturer_courses(int lecturer_id, int course_id) 
```

现在，您可以为学生正在学习的每门课程和讲师正在教授的每门课程创建单独的行，假设您希望跟踪课程的交付与学习课程分开。然后，当您想要进行与课程相关的分析时，您可以使用课程 ID 针对这些表编写查询。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-14T16:48:41.503

不要存储像“1,2,3”这样的文本，而是存储几行：

*   在名为“students”的表中，每个学生对应 1 行
*   名为“课程”的表中的每门课程都有 1 行

然后创建另一个名为“student_in_course”的表，每个组合都有 1 行。

然后对“lecturer_in_course”做同样的事情。

# r - 按行平均而不考虑负值

> ID：10587572
> 
> 赞同：2
> 
> 时间：2012-05-14T16:43:14.607
> 
> 标签：r, selection, average

我需要为我的数据集的单个单位计算变量之间的平均值。但是，在这样做的时候，我不需要考虑一些价值观。为了更好地解释，假设有两个单位和三个变量：

```
 V1    V2     V3
[1]   3     -2      4
[2]  -1      4      1 
```

并且您想**按行计算平均值**，**而不考虑那些负值**：

=> 平均值（1 行）= (3+4)/2

=> 平均（2 行）= (4+1)/2

谁能给我命令在R中做到这一点？

太感谢了

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-14T16:47:05.047

使用 apply 函数取每一行的平均值，规定值必须大于 0。

```
df=data.frame(V1=c(3,-1),V2=c(-2,4),V3=c(4,1));df

apply(df,1,function(x) mean(x[x>0])) 
```

# php - Doctrine QueryBuilder 和 concat 问题

> ID：10587578
> 
> 赞同：9
> 
> 时间：2012-05-14T16:43:38.950
> 
> 标签：php, symfony, doctrine-orm

我有以下代码，它依赖于 Doctrine 的 QueryBuilder API 来生成 DQL 语句。

```
class PlayerRepository extends EntityRepository
{
    public function findByPartialNameMatch($trainer, $fullName)
    {
        $qb = $this->createQueryBuilder('tp');

        $qb->innerJoin('tp.player', 'p')
            ->where($qb->expr()->andX(
                    $qb->expr()->orX(
                        $qb->expr()->like(
                            $qb->expr()->concat('p.firstName', $qb->expr()->concat(' ', 'p.lastName')),
                            $qb->expr()->literal($fullName.'%')
                        ),
                        $qb->expr()->like(
                            $qb->expr()->concat('p.lastName', $qb->expr()->concat(' ', 'p.firstName')),
                            $qb->expr()->literal($fullName.'%')
                        )
                    ),
                    $qb->expr()->eq('tp.trainer', '?1')
                 )
             )
        ->groupBy('p.id')
        ->orderBy('p.lastName', 'ASC')
        ->orderBy('p.firstName', 'ASC')
        ->setParameter(1, $trainer);

    return $qb->getQuery()->getResult();
} 
```

}

当我运行它时，Symfony2 会抛出以下错误消息：

```
[Syntax Error] line 0, col 123: Error: Expected StateFieldPathExpression | string |      InputParameter | FunctionsReturningStrings | AggregateExpression, got ',' 
```

查看堆栈跟踪，显示以下内容：

```
at QueryException ::syntaxError ('line 0, col 123: Error: Expected   StateFieldPathExpression | string | InputParameter | FunctionsReturningStrings |  AggregateExpression, got ','')
in D:\Work\vendor\doctrine\lib\Doctrine\ORM\Query\Parser.php at line 396  -+
at Parser ->syntaxError ('StateFieldPathExpression | string | InputParameter |  FunctionsReturningStrings | AggregateExpression')
in D:\Work\vendor\doctrine\lib\Doctrine\ORM\Query\Parser.php at line 2391  -+
at Parser ->StringPrimary ()
in D:\Work\vendor\doctrine\lib\Doctrine\ORM\Query\AST\Functions\ConcatFunction.php at line 60  -+
at ConcatFunction ->parse (object(Parser))
in D:\Work\vendor\doctrine\lib\Doctrine\ORM\Query\Parser.php at line 2852  - 
```

从上面，我了解到该问题与 concat 辅助函数有关，并且该函数需要枚举输入，但不知何故（？）收到逗号（，）。

上面的代码有什么问题？数小时的搜索无法找出问题所在。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-05-14T19:01:21.940

问题在于这部分：

```
$qb->expr()->concat(' ', 'p.lastName') 
```

您不能像学说在这里需​​要一些标识符一样放置空间。试试这个：

```
$qb->expr()->concat($qb->expr()->literal(' '), 'p.lastName') 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-03-04T09:02:55.073

我想分享我的 concat 代码：

```
// It is easy to use array to project concat result. It will look like 'Diego Maradona Maradona Diego'
$concatFields = array(
    'p.firstName',
    'p.lastName',
    'p.lastName',
    'p.firstName',
);

// Routine code. All fields will be separated by ' '.
foreach ($concatFields as $field) {
    if (!isset($searchIn)) {
        $searchIn = $qb->expr()->concat($qb->expr()->literal(''), $field);
        continue;
    }

    $searchIn = $qb->expr()->concat(
        $searchIn,
        $qb->expr()->concat($qb->expr()->literal(' '), $field)
    );
}

// Just use concat result to search in.
$anyKeyword = 'ego';
$qb->add('where', $qb->expr()->like($searchIn, ':keyword'));
$qb->setParameter('keyword', '%'. $anyKeyword .'%'); 
```

# php - 在 PHP 中访问复选框值和使用函数

> ID：10587589
> 
> 赞同：0
> 
> 时间：2012-05-14T16:44:14.720
> 
> 标签：php, function, checkbox

在这种情况下我遇到了问题，我搜索了很多，不知道我该怎么处理它......我有 4 个复选框，每个复选框都在执行某个功能。我有这个用于复选框的 html 代码，

```
 <form action="check.php" method="post">
<table border="1" width="200">
<tr>
<td>
<input type="checkbox" name="first[]" value="option1" />
</td>
<td width="500">
<strong>Option 1</strong>
</td>
</tr>
<tr>
<td>
<input type="checkbox" name="first[]" value="option2" />
</td>
<td width="500">
<strong>Option 2</strong>
</td>
</tr>
<tr>
<td>
<input type="checkbox" name="first[]" value="option3" />
</td>
<td width="500">
<strong>option 3</strong>
</td>
</tr>
</table>
<table border="1" width="200">
<tr>
<td>
<input type="text" name="entered_value"/>
</td>
</tr>
</table>
<table border="1" width="200">
<tr>
<td>
<input type="submit" value="Submit"/>
</td>
</tr>
</table>
</form> 
```

我正在使用此代码访问这些复选框

```
<?php
if (isset($_POST['submit']))
    {
        if(isset($_POST['first']))
            {
                $get_data_checkboxes = $_POST['first'];
            }   
        else
            {
                $get_data_checkboxes = "";
            }
            print_r($get_data_checkboxes);
            exit();
}
?> 
```

我面临的问题就像我需要在每个勾选的复选框上运行一个函数，例如，如果这个人勾选了选项 1，那么我应该能够运行函数 1，依此类推......

任何帮助将不胜感激 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T17:01:54.210

如果要选择多个复选框，可以尝试以下操作：

```
for( $i = 0; $i < count( $_POST['first'] ); $i++ ) {

    if( $_POST['first'][$i] == 'option1' ) {

        echo "function1";

    } else if( $_POST['first'][$i] == 'option2' ) {

        echo "function2";

    } else if( $_POST['first'][$i] == 'option3' ) {

        echo "function3";
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T17:05:22.823

你不需要这条线

```
 if (isset($_POST['submit'])) 
```

没有它，您的代码可以正常工作，您可以使用它来调用您的函数，如下所示：

```
 <?php
    if(isset($_POST['first']))
    {
         $get_data_checkboxes = $_POST['first'];
         foreach($get_data_checkboxes as $value){
             //call functions named option1(), option2(), etc..
             call_user_func($value);
         }
    }   
    else{
        $get_data_checkboxes = "";
    }

?> 
```

# curl - php webpayments pro install.php 不工作

> ID：10587593
> 
> 赞同：0
> 
> 时间：2012-05-14T16:44:23.130
> 
> 标签：curl, paypal, php

我正在尝试为 paypal webpayments pro 运行 php install.php。但是，当我尝试从 Windows Server 2003 上的命令行执行此操作时，通过执行 php -the directory- install.php 它会返回错误：

```
INSTALLATION ERROR: one or more extensions are missing: cURL 
```

我已经三次检查了我的 php.ini 和 phpinfo() 并且都显示 cURL 已启用并安装。我试图安装它的目录在 D 驱动器中，而 php.ini 文件在 C 驱动器中，不确定这是否与它有关，但是 phpinfo 会告诉我是否启用 curl on错误的ini文件，所以我很难过。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T16:54:43.573

通常有两个不同的`php.ini`文件：一个用于 IIS，一个用于 PHP-CLI（命令行）。

在命令行中，尝试`php -i`查看`php.ini`真正使用的文件。

# oop - 实例化集合对象

> ID：10587596
> 
> 赞同：1
> 
> 时间：2012-05-14T16:44:29.387
> 
> 标签：oop, language-agnostic

所以假设我有一个通用对象，Person。一个人有一个名字和一个性别——名字必须是一个字符串，而性别必须是`male`or `female`。我还有一个集合对象，PersonList，它有一个 Person 对象数组并允许对集合进行操作（例如，返回某个性别的人的列表。）

一方面，用构造函数中的数据创建 PersonList 会很好......

```
list = new PersonList([new Person('Alice', 'Female'), ...]); 
```

...但是我们不知道数据是否有效。我们可以允许无效的 Person 对象进入，并在访问它们时检查它们的有效性，或者我们可以给 Person 一个 vaild() 方法并说...

```
list = new PersonList();
alice = new Person('Alice', 'Female');
if (alice->valid()) list->add(alice); 
```

...或者也许我们在 add() 中检查 valid()。但是对我来说，有一个 valid() 方法似乎很奇怪。

一般来说，您将如何实例化这些对象？这是主观的事情，还是有普遍的“正确方式”？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T16:53:42.820

如果您相信自己永远不会创建无效对象，那么您实际上不需要检查有效性的方法。但是，如果您要根据用户数据创建可能无效的对象，那么您应该有一个有效性检查方法，并且调用该方法应该是构造函数所做的最后一件事。如果对该对象的转换可能导致其无效，则还应在所述转换发生后立即调用所述方法。应该立即捕获无效对象，并且类的最终用户不必担心它，除了偶尔会抛出异常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T16:48:43.637

1.  像这样的类`PersonList`不是通用的。它与`Person`.
2.  目前尚不清楚为什么您认为您的硬编码数据可能无效。
3.  如果可以构造一个在某种意义上无效的对象，那么您应该始终有一种方法来测试它在这种意义上的有效性。

# c++ - Intel cpu 上的 SIMD 前缀和

> ID：10587598
> 
> 赞同：21
> 
> 时间：2012-05-14T16:44:36.573
> 
> 标签：c++, sse, simd, prefix-sum

我需要实现一个前缀和算法，并且需要它尽可能快。
前任：

```
[3, 1,  7,  0,  4,  1,  6,  3] 
```

应该给：

```
[3, 4, 11, 11, 15, 16, 22, 25] 
```

有没有办法使用 SSE SIMD CPU 指令来做到这一点？

我的第一个想法是递归地对每一对并行求和，直到所有总和都计算如下！

```
//in parallel do 
for (int i = 0; i < z.length; i++) {
    z[i] = x[i << 1] + x[(i << 1) + 1];
} 
```

为了让算法更清晰一点，`z`不是最终输出，而是用于计算输出。

```
int[] w = computePrefixSum(z);
for (int i = 1; i < ouput.length; i++) {
    ouput[i] = (i % 2 == 0) ? (x[i] + ouput[i - 1]) :  w[(i - 1) >> 1];
} 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-10-21T14:03:57.690

我所知道的最快的并行前缀求和算法是在两遍并行中运行总和，并在第二遍中也使用 SSE。

在第一遍中，您并行计算部分和并存储每个部分和的总和。在第二遍中，您将前一个部分总和的总和添加到下一个部分总和。您可以使用多个线程（例如，使用 OpenMP）并行运行两个通道。第二遍您也可以使用 SIMD，因为每个部分总和都添加了一个常数值。

假设`n`数组元素、`m`核心和 SIMD 宽度`w`的时间成本应该是

```
n/m + n/(m*w) = (n/m)*(1+1/w) 
```

由于第一次通过不使用 SIMD，因此时间成本将始终大于`n/m`

例如，对于 SIMD_width 为 4 的四个内核（带有 SSE 的四个 32 位浮点数），成本将为`5n/16`. 或者比具有时间成本的顺序代码快 3.2 倍`n`。使用超线程，速度会更快。

在特殊情况下，也可以在第一遍使用 SIMD。那么时间成本很简单

```
2*n/(m*w) 
```

我发布了一般情况下的代码，它使用 OpenMP 作为 SSE 代码的线程和内在函数，并在以下链接中讨论了有关特殊情况的详细信息 [parallel-prefix-cumulative-sum-with-sse](https://stackoverflow.com/questions/19494114/parallel-prefix-cumulative-sum-with-sse)

**编辑：我设法为第一遍找到了一个 SIMD 版本，它的速度大约是顺序代码的两倍。现在，我的四核常春藤桥系统总共获得了大约 7 的提升。**

**编辑：** 对于较大的数组，一个问题是在第一次通过后，大多数值已从缓存中清除。我想出了一个解决方案，它在一个块内并行运行，但串行运行每个块。这`chunk_size`是一个应该调整的值。例如，我将其设置为 1MB = 256K 浮点数。现在，当值仍在二级缓存中时，第二遍就完成了。这样做会给大型阵列带来很大的改进。

这是 SSE 的代码。AVX 代码的速度差不多，所以我没有在这里发布。进行前缀求和的函数是`scan_omp_SSEp2_SSEp1_chunk`。将浮点数数组传递给它，并用累积和`a`填充数组。`s`

```
__m128 scan_SSE(__m128 x) {
    x = _mm_add_ps(x, _mm_castsi128_ps(_mm_slli_si128(_mm_castps_si128(x), 4))); 
    x = _mm_add_ps(x, _mm_shuffle_ps(_mm_setzero_ps(), x, 0x40)); 
    return x;
}

float pass1_SSE(float *a, float *s, const int n) {
    __m128 offset = _mm_setzero_ps();
    #pragma omp for schedule(static) nowait
    for (int i = 0; i < n / 4; i++) {
        __m128 x = _mm_load_ps(&a[4 * i]);
        __m128 out = scan_SSE(x);
        out = _mm_add_ps(out, offset);
        _mm_store_ps(&s[4 * i], out);
        offset = _mm_shuffle_ps(out, out, _MM_SHUFFLE(3, 3, 3, 3));
    }
    float tmp[4];
    _mm_store_ps(tmp, offset);
    return tmp[3];
}

void pass2_SSE(float *s, __m128 offset, const int n) {
    #pragma omp for schedule(static)
    for (int i = 0; i<n/4; i++) {
        __m128 tmp1 = _mm_load_ps(&s[4 * i]);
        tmp1 = _mm_add_ps(tmp1, offset);
        _mm_store_ps(&s[4 * i], tmp1);
    }
}

void scan_omp_SSEp2_SSEp1_chunk(float a[], float s[], int n) {
    float *suma;
    const int chunk_size = 1<<18;
    const int nchunks = n%chunk_size == 0 ? n / chunk_size : n / chunk_size + 1;
    //printf("nchunks %d\n", nchunks);
    #pragma omp parallel
    {
        const int ithread = omp_get_thread_num();
        const int nthreads = omp_get_num_threads();

        #pragma omp single
        {
            suma = new float[nthreads + 1];
            suma[0] = 0;
        }

        float offset2 = 0.0f;
        for (int c = 0; c < nchunks; c++) {
            const int start = c*chunk_size;
            const int chunk = (c + 1)*chunk_size < n ? chunk_size : n - c*chunk_size;
            suma[ithread + 1] = pass1_SSE(&a[start], &s[start], chunk);
            #pragma omp barrier
            #pragma omp single
            {
                float tmp = 0;
                for (int i = 0; i < (nthreads + 1); i++) {
                    tmp += suma[i];
                    suma[i] = tmp;
                }
            }
            __m128 offset = _mm_set1_ps(suma[ithread]+offset2);
            pass2_SSE(&s[start], offset, chunk);
            #pragma omp barrier
            offset2 = s[start + chunk-1];
        }
    }
    delete[] suma;
} 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-05-14T18:50:27.017

您可以利用一些较小的并行性来实现较大的寄存器长度和较小的总和。例如，将 16 个 1 字节的值相加（恰好适合一个 sse 寄存器）只需要 log [2] 16 加法和相等数量的移位。
不多，但快于 15 次依赖添加和额外的内存访问。

```
__m128i x = _mm_set_epi8(3,1,7,0,4,1,6,3,3,1,7,0,4,1,6,3);
x = _mm_add_epi8(x, _mm_srli_si128(x, 1));
x = _mm_add_epi8(x, _mm_srli_si128(x, 2));
x = _mm_add_epi8(x, _mm_srli_si128(x, 4));
x = _mm_add_epi8(x, _mm_srli_si128(x, 8));

// x == 3, 4, 11, 11, 15, 16, 22, 25, 28, 29, 36, 36, 40, 41, 47, 50 
```

如果总和更长，则可以通过利用指令级并行性和利用指令重新排序来隐藏依赖关系。

编辑：像

```
__m128i x0 = _mm_set_epi8(3,1,7,0,4,1,6,3,3,1,7,0,4,1,6,3);
__m128i x1 = _mm_set_epi8(3,1,7,0,4,1,6,3,3,1,7,0,4,1,6,3);
__m128i x2 = _mm_set_epi8(3,1,7,0,4,1,6,3,3,1,7,0,4,1,6,3);
__m128i x3 = _mm_set_epi8(3,1,7,0,4,1,6,3,3,1,7,0,4,1,6,3);

__m128i mask = _mm_set_epi8(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);

x0 = _mm_add_epi8(x0, _mm_srli_si128(x0, 1));
x1 = _mm_add_epi8(x1, _mm_srli_si128(x1, 1));
x2 = _mm_add_epi8(x2, _mm_srli_si128(x2, 1));
x3 = _mm_add_epi8(x3, _mm_srli_si128(x3, 1));

x0 = _mm_add_epi8(x0, _mm_srli_si128(x0, 2));
x1 = _mm_add_epi8(x1, _mm_srli_si128(x1, 2));
x2 = _mm_add_epi8(x2, _mm_srli_si128(x2, 2));
x3 = _mm_add_epi8(x3, _mm_srli_si128(x3, 2));

x0 = _mm_add_epi8(x0, _mm_srli_si128(x0, 4));
x1 = _mm_add_epi8(x1, _mm_srli_si128(x1, 4));
x2 = _mm_add_epi8(x2, _mm_srli_si128(x2, 4));
x3 = _mm_add_epi8(x3, _mm_srli_si128(x3, 4));

x0 = _mm_add_epi8(x0, _mm_srli_si128(x0, 8));
x1 = _mm_add_epi8(x1, _mm_srli_si128(x1, 8));
x2 = _mm_add_epi8(x2, _mm_srli_si128(x2, 8));
x3 = _mm_add_epi8(x3, _mm_srli_si128(x3, 8));

x1 = _mm_add_epi8(_mm_shuffle_epi8(x0, mask), x1);
x2 = _mm_add_epi8(_mm_shuffle_epi8(x1, mask), x2);
x3 = _mm_add_epi8(_mm_shuffle_epi8(x2, mask), x3); 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-05-14T17:29:21.333

prefix-sum 可以并行计算，它实际上是 GPU 编程中的基础算法之一。如果您在英特尔处理器上使用 SIMD 扩展，我不确定并行执行是否真的会让您受益匪浅，但请查看 nvidia 关于实现并行前缀和的这篇论文（只需查看算法并忽略CUDA）：[与 CUDA 并行前缀和（扫描）](https://developer.nvidia.com/gpugems/GPUGems3/gpugems3_ch39.html)。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2015-09-10T12:12:34.383

对于 1000 个 32 位整数的数组，我能够在英特尔 Sandybridge 的循环中使用 @hirschhornsalz 的方法获得大约 1.4 倍单线程的小加速。使用 60kiB 的整数缓冲区，加速比约为 1.37。使用 8MiB 的整数，加速比仍然是 1.13。（i5-2500k，3.8GHz 涡轮增压，DDR3-1600。）

对于每个向量的元素数量每翻一番，较小的元素（`int16_t`或，或无符号版本）将需要一个额外的移位/加法阶段。`uint8_t`溢出是不好的，所以不要尝试使用不能保存所有元素总和的数据类型，即使它给 SSE 带来了更大的优势。

```
#include <immintrin.h>

// In-place rewrite an array of values into an array of prefix sums.
// This makes the code simpler, and minimizes cache effects.
int prefix_sum_sse(int data[], int n)
{
//    const int elemsz = sizeof(data[0]);
#define elemsz sizeof(data[0])   // clang-3.5 doesn't allow compile-time-const int as an imm8 arg to intrinsics

    __m128i *datavec = (__m128i*)data;
    const int vec_elems = sizeof(*datavec)/elemsz;
    // to use this for int8/16_t, you still need to change the add_epi32, and the shuffle

    const __m128i *endp = (__m128i*) (data + n - 2*vec_elems);  // don't start an iteration beyond this
    __m128i carry = _mm_setzero_si128();
    for(; datavec <= endp ; datavec += 2) {
        IACA_START
        __m128i x0 = _mm_load_si128(datavec + 0);
        __m128i x1 = _mm_load_si128(datavec + 1); // unroll / pipeline by 1
//      __m128i x2 = _mm_load_si128(datavec + 2);
//      __m128i x3;

        x0 = _mm_add_epi32(x0, _mm_slli_si128(x0, elemsz));  // for floats, use shufps not bytewise-shift
        x1 = _mm_add_epi32(x1, _mm_slli_si128(x1, elemsz));

        x0 = _mm_add_epi32(x0, _mm_slli_si128(x0, 2*elemsz));
        x1 = _mm_add_epi32(x1, _mm_slli_si128(x1, 2*elemsz));

    // more shifting if vec_elems is larger

        x0 = _mm_add_epi32(x0, carry);  // this has to go after the byte-shifts, to avoid double-counting the carry.
        _mm_store_si128(datavec +0, x0); // store first to allow destructive shuffle (non-avx pshufb if needed)

        x1 = _mm_add_epi32(_mm_shuffle_epi32(x0, _MM_SHUFFLE(3,3,3,3)), x1);
        _mm_store_si128(datavec +1, x1);

        carry = _mm_shuffle_epi32(x1, _MM_SHUFFLE(3,3,3,3)); // broadcast the high element for next vector
    }
    // FIXME: scalar loop to handle the last few elements
    IACA_END
    return data[n-1];
    #undef elemsz
}

int prefix_sum_simple(int data[], int n)
{
    int sum=0;
    for (int i=0; i<n ; i++) {
        IACA_START
        sum += data[i];
        data[i] = sum;
    }
    IACA_END
    return sum;
}

// perl -we '$n=1000; sub rnlist($$) { return map { int rand($_[1]) } ( 1..$_[0] );}  @a=rnlist($n,127);   $"=", "; print "$n\n@a\n";'

int data[] = { 51, 83, 126, 11,   20, 63, 113, 102,
       126,67, 83, 113,   86, 123, 30, 109,
       97, 71, 109, 86,   67, 60,  47, 12,
       /* ... */ };

int main(int argc, char**argv)
{
    const int elemsz = sizeof(data[0]);
    const int n = sizeof(data)/elemsz;
    const long reps = 1000000 * 1000 / n;
    if (argc >= 2 && *argv[1] == 'n') {
        for (int i=0; i < reps ; i++)
            prefix_sum_simple(data, n);
    }else {
        for (int i=0; i < reps ; i++)
            prefix_sum_sse(data, n);
    }
    return 0;
} 
```

* * *

使用 n=1000 进行测试，将列表编译成二进制文件。（是的，我检查了它实际上是循环的，没有采用任何使向量或非向量测试毫无意义的编译时快捷方式。）

请注意，使用 AVX 编译以获得 3 操作数无损向量指令可节省大量`movdqa`指令，但仅节省少量周期。这是因为 shuffle 和 vector-int-add 都只能在 SnB/IvB 上的端口 1 和 5 上运行，因此 port0 有足够的空闲周期来运行 mov 指令。uop-cache 吞吐量瓶颈可能是非 AVX 版本稍慢的原因。（所有这些额外的 mov 指令将我们推到 3.35 insn/cycle）。前端只有 4.54% 的周期空闲，所以它几乎没有跟上。

```
gcc -funroll-loops -DIACA_MARKS_OFF -g -std=c11 -Wall -march=native -O3 prefix-sum.c -mno-avx -o prefix-sum-noavx

  # gcc 4.9.2

################# SSE (non-AVX) vector version ############
$ ocperf.py stat -e task-clock,cycles,instructions,uops_issued.any,uops_dispatched.thread,uops_retired.all,uops_retired.retire_slots,stalled-cycles-frontend,stalled-cycles-backend ./prefix-sum-noavx 
perf stat -e task-clock,cycles,instructions,cpu/event=0xe,umask=0x1,name=uops_issued_any/,cpu/event=0xb1,umask=0x1,name=uops_dispatched_thread/,cpu/event=0xc2,umask=0x1,name=uops_retired_all/,cpu/event=0xc2,umask=0x2,name=uops_retired_retire_slots/,stalled-cycles-frontend,stalled-cycles-backend ./prefix-sum-noavx

 Performance counter stats for './prefix-sum-noavx':

        206.986720      task-clock (msec)         #    0.999 CPUs utilized          
       777,473,726      cycles                    #    3.756 GHz                    
     2,604,757,487      instructions              #    3.35  insns per cycle        
                                                  #    0.01  stalled cycles per insn
     2,579,310,493      uops_issued_any           # 12461.237 M/sec
     2,828,479,147      uops_dispatched_thread    # 13665.027 M/sec
     2,829,198,313      uops_retired_all          # 13668.502 M/sec (unfused domain)
     2,579,016,838      uops_retired_retire_slots # 12459.818 M/sec (fused domain)
        35,298,807      stalled-cycles-frontend   #    4.54% frontend cycles idle   
         1,224,399      stalled-cycles-backend    #    0.16% backend  cycles idle   

       0.207234316 seconds time elapsed
------------------------------------------------------------

######### AVX (same source, but built with -mavx).  not AVX2 #########
$ ocperf.py stat -e task-clock,cycles,instructions,uops_issued.any,uops_dispatched.thread,uops_retired.all,uops_retired.retire_slots,stalled-cycles-frontend,stalled-cycles-backend ./prefix-sum-avx

 Performance counter stats for './prefix-sum-avx':

        203.429021      task-clock (msec)         #    0.999 CPUs utilized          
       764,859,441      cycles                    #    3.760 GHz                    
     2,079,716,097      instructions              #    2.72  insns per cycle        
                                                  #    0.12  stalled cycles per insn
     2,054,334,040      uops_issued_any           # 10098.530 M/sec                  
     2,303,378,797      uops_dispatched_thread    # 11322.764 M/sec                  
     2,304,140,578      uops_retired_all          # 11326.509 M/sec                  
     2,053,968,862      uops_retired_retire_slots # 10096.735 M/sec                  
       240,883,566      stalled-cycles-frontend   #   31.49% frontend cycles idle   
         1,224,637      stalled-cycles-backend    #    0.16% backend  cycles idle   

       0.203732797 seconds time elapsed
------------------------------------------------------------

################## scalar version (cmdline arg) #############    
$ ocperf.py stat -e task-clock,cycles,instructions,uops_issued.any,uops_dispatched.thread,uops_retired.all,uops_retired.retire_slots,stalled-cycles-frontend,stalled-cycles-backend ./prefix-sum-avx n

 Performance counter stats for './prefix-sum-avx n':

        287.567070      task-clock (msec)         #    0.999 CPUs utilized          
     1,082,611,453      cycles                    #    3.765 GHz                    
     2,381,840,355      instructions              #    2.20  insns per cycle        
                                                  #    0.20  stalled cycles per insn
     2,272,652,370      uops_issued_any           # 7903.034 M/sec                  
     4,262,838,836      uops_dispatched_thread    # 14823.807 M/sec                  
     4,256,351,856      uops_retired_all          # 14801.249 M/sec                  
     2,256,150,510      uops_retired_retire_slots # 7845.650 M/sec                  
       465,018,146      stalled-cycles-frontend   #   42.95% frontend cycles idle   
         6,321,098      stalled-cycles-backend    #    0.58% backend  cycles idle   

       0.287901811 seconds time elapsed

------------------------------------------------------------ 
```

Haswell 应该差不多，但每个时钟可能会稍微慢一些，因为 shuffle 只能在端口 5 上运行，而不能在端口 1 上运行。（在 Haswell 上，vector-int add 仍然是 p1/5。）

OTOH，IACA 认为 Haswell 在一次迭代中会比 SnB 稍快，如果你不编译的话`-funroll-loops`（这对 SnB 有帮助）。Haswell 可以在端口 6 上进行分支，但在 SnB 上的分支在端口 5 上，我们已经饱和了。

```
 # compile without -DIACA_MARKS_OFF
$ iaca -64 -mark 1 -arch HSW prefix-sum-avx    
Intel(R) Architecture Code Analyzer Version - 2.1
Analyzed File - prefix-sum-avx
Binary Format - 64Bit
Architecture  - HSW
Analysis Type - Throughput

*******************************************************************
Intel(R) Architecture Code Analyzer Mark Number 1
*******************************************************************

Throughput Analysis Report
--------------------------
Block Throughput: 6.20 Cycles       Throughput Bottleneck: Port5

Port Binding In Cycles Per Iteration:
---------------------------------------------------------------------------------------
|  Port  |  0   -  DV  |  1   |  2   -  D   |  3   -  D   |  4   |  5   |  6   |  7   |
---------------------------------------------------------------------------------------
| Cycles | 1.0    0.0  | 5.8  | 1.4    1.0  | 1.4    1.0  | 2.0  | 6.2  | 1.0  | 1.3  |
---------------------------------------------------------------------------------------

N - port number or number of cycles resource conflict caused delay, DV - Divider pipe (on port 0)
D - Data fetch pipe (on ports 2 and 3), CP - on a critical path
F - Macro Fusion with the previous instruction occurred
* - instruction micro-ops not bound to a port
^ - Micro Fusion happened
# - ESP Tracking sync uop was issued
@ - SSE instruction followed an AVX256 instruction, dozens of cycles penalty is expected
! - instruction not supported, was not accounted in Analysis

| Num Of |                    Ports pressure in cycles                     |    |
|  Uops  |  0  - DV  |  1  |  2  -  D  |  3  -  D  |  4  |  5  |  6  |  7  |    |
---------------------------------------------------------------------------------
|   1    |           |     | 1.0   1.0 |           |     |     |     |     |    | vmovdqa xmm2, xmmword ptr [rax]
|   1    | 1.0       |     |           |           |     |     |     |     |    | add rax, 0x20
|   1    |           |     |           | 1.0   1.0 |     |     |     |     |    | vmovdqa xmm3, xmmword ptr [rax-0x10]
|   1    |           |     |           |           |     | 1.0 |     |     | CP | vpslldq xmm1, xmm2, 0x4
|   1    |           | 1.0 |           |           |     |     |     |     |    | vpaddd xmm2, xmm2, xmm1
|   1    |           |     |           |           |     | 1.0 |     |     | CP | vpslldq xmm1, xmm3, 0x4
|   1    |           | 1.0 |           |           |     |     |     |     |    | vpaddd xmm3, xmm3, xmm1
|   1    |           |     |           |           |     | 1.0 |     |     | CP | vpslldq xmm1, xmm2, 0x8
|   1    |           | 1.0 |           |           |     |     |     |     |    | vpaddd xmm2, xmm2, xmm1
|   1    |           |     |           |           |     | 1.0 |     |     | CP | vpslldq xmm1, xmm3, 0x8
|   1    |           | 1.0 |           |           |     |     |     |     |    | vpaddd xmm3, xmm3, xmm1
|   1    |           | 0.9 |           |           |     | 0.2 |     |     | CP | vpaddd xmm1, xmm2, xmm0
|   2^   |           |     |           |           | 1.0 |     |     | 1.0 |    | vmovaps xmmword ptr [rax-0x20], xmm1
|   1    |           |     |           |           |     | 1.0 |     |     | CP | vpshufd xmm1, xmm1, 0xff
|   1    |           | 0.9 |           |           |     | 0.1 |     |     | CP | vpaddd xmm0, xmm1, xmm3
|   2^   |           |     | 0.3       | 0.3       | 1.0 |     |     | 0.3 |    | vmovaps xmmword ptr [rax-0x10], xmm0
|   1    |           |     |           |           |     | 1.0 |     |     | CP | vpshufd xmm0, xmm0, 0xff
|   1    |           |     |           |           |     |     | 1.0 |     |    | cmp rax, 0x602020
|   0F   |           |     |           |           |     |     |     |     |    | jnz 0xffffffffffffffa3
Total Num Of Uops: 20 
```

顺便说一句，gcc 将循环编译为使用单寄存器寻址模式，即使我有一个循环计数器并且正在执行`load(datavec + i + 1)`. 这是最好的代码，尤其是。在 SnB 系列上，2 寄存器寻址模式无法进行微熔断，因此我将源更改为该循环条件以利于铿锵声。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2021-10-05T14:36:53.360

*注意：在 C++ 标准中，“前缀和”被称为“包含扫描”，所以这就是我们所说的。*

[我们已将@Z bozon 的答案](https://stackoverflow.com/a/19496697/5021064)（感谢出色的工作！）的 SIMD 部分移植并推广到eve [library](https://github.com/jfalcou/eve)中的所有 x86（sse-avx512）和 arm（neon/aarch-64）。它是开源的并获得 MIT 许可。

*注意：我们仅支持与 skylake-avx512 匹配的 AVX-512 版本。如果您的机器不支持所有要求，我们将使用 avx2。*

我们还支持在并行数组上执行此操作，例如，您可以对复数进行包容性扫描：[example](https://github.com/jfalcou/eve/blob/0131d12c9932b5740ab05457393cad6053d6d327/examples/algorithms/using_existing/inclusive_scan_zip__using_zip_with_algorithms.cpp#L29)。

在这里你可以看到我们为不同的架构生成的 asm（你可以为不同的类型更改 T 类型）：[godbolt](https://godbolt.org/z/M315McWjE)。如果链接过时，[arm-64](https://github.com/DenisYaroshevskiy/unsq_eve/blob/a27c1d5984706466d10bab01b42d9cdd6f6784e9/disassemble/disassemble_arm.s#L1)，[avx-2](https://github.com/DenisYaroshevskiy/unsq_eve/blob/a27c1d5984706466d10bab01b42d9cdd6f6784e9/disassemble/disassemble.s#L1)。

这里有一些数字`int`，用于不同的 x86 架构，与 10'000 字节数据上的标量代码相比。处理器 intel-9700k。

*注意：不幸的是，目前还没有针对 arm 的基准。*

[![整数结果](../Images/c38222b48b907d836dc38447e432e561.png)](https://i.stack.imgur.com/p3KiF.png)

在 sse2-sse4 上，我们大约快 1.6-1.7 倍，在 avx2 上 - 大约 2 倍。

该算法的限制是`cardinal / log(cardinal)`- 所以`4 / 2`- 在 sse2-sse4.2 上是 2 次，在 avx2`8 / 3`上是 2.7 次 - 我们离我们不远了。

### 线程呢？

在[eve 库](https://github.com/jfalcou/eve)中，我们不直接处理线程，但是我们有`inclusive_scan`并且`transform`哪些是执行并行版本的构建块。

这是[我在 eve 之上的并行/矢量化版本的草图](https://github.com/jfalcou/eve/blob/0131d12c9932b5740ab05457393cad6053d6d327/examples/algorithms/using_existing/inclusive_scan_par_unseq__using_eve_to_build_both_vectorized_and_parallel_algos.cpp#L9)。不过，我`std::async/std::future`在示例中使用了一些不错的线程库，这很糟糕。

### 其他相关能力

如果要保留原始数据，可以使用`inclusive_scan_to`代替，没问题。[inlcusive_scan_to](https://godbolt.org/z/hqj6TnoYq)`inclusive_scan_inplace`

我们还支持不同的类型（与标准包含扫描的方式相同） - 因此您可以将浮点数求和到双精度数等。[浮动到双打](https://godbolt.org/z/nGq8ah5d1)

我们支持自定义`plus`操作，因此您可以根据需要使用 min。我已经提到`zip`了一次扫描多个阵列的能力。 [例子](https://github.com/jfalcou/eve/blob/0131d12c9932b5740ab05457393cad6053d6d327/examples/algorithms/using_existing/inclusive_scan_zip__using_zip_with_algorithms.cpp#L29)

如果您想尝试并需要帮助，请随时在库上创建问题。

# android - 如何防止我的应用程序在使用 JSON 数据时意外崩溃、“强制关闭”，并改为处理异常？

> ID：10587599
> 
> 赞同：1
> 
> 时间：2012-05-14T16:44:36.653
> 
> 标签：android, sql, json, try-catch

在我的应用程序中，我有一个食物活动，用户在其中输入他/她的食物，应用程序以用户输入的名称从 MYSQL 数据库请求食物。在输入的食物不存在的情况下，数据库返回的字符串应该为空。

目前，当发生这种情况时，会发生异常，因为 null 值无法解析为 JSON 数组。我的问题是：“有没有办法阻止我的应用程序强制关闭？我可以处理异常并显示一个 toast 通知用户未找到请求的食物吗？” 我想防止应用程序崩溃，而是优雅地失败。

请帮我。

我已经在我的应用程序中显示了相关代码..

```
private class LoadData extends AsyncTask<Void, Void, String> 
    { 
private  JSONArray jArray;
private  String result = null;
private  InputStream is = null;
private String entered_food_name=choice.getText().toString().trim();
protected void onPreExecute() 
{
}

@Override
protected String doInBackground(Void... params) 
{
   try {
    ArrayList<NameValuePair> nameValuePairs = new            ArrayList<NameValuePair>();
    HttpClient httpclient = new DefaultHttpClient(); 
    HttpPost httppost = new HttpPost("http://10.0.2.2/food.php");
    nameValuePairs.add(new BasicNameValuePair("Name",entered_food_name));
    httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs,"UTF-8"));
    HttpResponse response = httpclient.execute(httppost);

    HttpEntity entity = response.getEntity();
     is = entity.getContent();

        //convert response to string

BufferedReader reader = new BufferedReader(new InputStreamReader(is,"utf-8"),8);
        StringBuilder sb = new StringBuilder();
        String line = null;
        while ((line = reader.readLine()) != null) {
            sb.append(line);
        }

        is.close();

        result =sb.toString();
        result = result.replace('\"', '\'').trim();

    }
    catch(Exception e){
        Log.e("log_tag", " connection" + e.toString());                     
    }

    return result;  

}

@Override
protected void onPostExecute(String result) 
{  
    try{

        String foodName="";
        int Description=0;

        jArray = new JSONArray(result); // here if the result is null an exeption will occur
        JSONObject json_data = null;

        for (int i = 0; i < jArray.length(); i++) {
            json_data = jArray.getJSONObject(i);
            foodName=json_data.getString("Name");
            .
            .
            .
            .
            .
        } 
        catch(JSONException e){ 
            **// what i can do here to prevent my app from crash and 
            //  make toast " the entered food isnot available " ????**
            Log.e("log_tag", "parssing  error " + e.toString()); 
        }   
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T16:49:57.290

这将修复您的代码：

```
jArray = (result == null) ? new JSONArray() : new JSONArray(result); 
```

现在您有一个空的 JSONArray，您可以稍后在程序中测试 null JSONObjects。如果找到一个 JSONObject，则许多 JSON 方法返回一个 JSONObject，如果不存在则返回 null。

您可能还想使用*无参数*JSON 构造函数初始化 JSONObject，而不是简单地将其设置为 null。将它传递给其他 JSON 方法时会避免出现问题（例如在构造函数中使用它到 JSONArray()：

```
JSONObject json_data = new JSONObject(); 
```

* * *

最后，如果您仍然得到`JSONException`s，那是因为您实际上并未将有效的 JSON 字符串传递给构造函数。您可以将 的值打印`result`到日志中：

```
Log.d("JSON Data", result); 
```

您可能会看到一些 SQL 错误文本，或者如果您从 Web 服务器检索，则会看到 HTTP 错误代码（如果您的 url 不正确，404 很常见）。

如果您的结果确实*看起来像 JSON，那么您可以使用*[JSONLint 验证器](http://jsonlint.com/)验证它是否实际上是有效的 JSON 。它将帮助您捕获可能遇到的任何错误，尤其是在您自己格式化 JSON 时。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T16:46:13.750

您是否希望捕获异常并（远程）记录它以帮助进行崩溃报告和调试？我用这个包远程捕获异常，它工作得很好：

[http://code.google.com/p/android-remote-stacktrace/](http://code.google.com/p/android-remote-stacktrace/)

# java - 在 servlet 多部分发布期间无法访问 Spring Security 信息

> ID：10587601
> 
> 赞同：7
> 
> 时间：2012-05-14T16:44:42.843
> 
> 标签：java, spring, servlets, spring-mvc, spring-security

在 servlet 多部分发布期间，我无法访问 Spring Security 信息。Spring 安全信息在常规 get 和 post 方法中可用，但不适用于 multipart post 方法。我尝试通过 SecurityContextHolder.getContext().getAuthentication() 和通过访问 SecurityContextHolder.getContext().getAuthentication() 的注入服务直接访问此安全信息，但未成功。

我还实现了一个 HttpRequestHandler 和一个 ServletWrappingController。再一次，我能够成功地将 spring bean 注入它们并访问 Spring Security 信息以获取常规 get 和 post 方法，但我无法访问 Spring Security 信息以获取多部分帖子。我知道 Spring 3.0 中内置了新的 MultiPart 功能，但是因为我们的网站需要对文件上传流的完全访问权限，所以我将无法使用它们。出于这个原因，我将重点放在 HttpServlet、HttpRequestHandler 和 ServletWrappingController 上。

我在此处发布的代码是为解决我所面临的这个特定问题而编写的所有测试代码，因为在分段上传期间安全信息不可用（不意味着具有生产质量）。它适用于 HttpServlet。

如果我做错了什么，请告诉我。或者，如果没有，是否有解决方法或更好的方法来完成分段上传并访问 Spring Security 信息，同时保持对文件上传流的访问？有人可以为这个问题提供的任何帮助将不胜感激！

下面是测试 servlet 代码。下面的评论是基于使用 Spring Security 3.1 登录网站的用户，哪些有效，哪些无效：

```
//many import statements not displayed 
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.web.context.support.SpringBeanAutowiringSupport;

import org.springframework.security.core.GrantedAuthority;
import org.springframework.security.core.context.SecurityContextHolder;

public class UploadServlet extends HttpServlet {

    public void service(HttpServletRequest req, HttpServletResponse res) throws IOException, ServletException {
        super.service(req, res);
    }

    public void init(ServletConfig config) throws ServletException { 
        super.init(config); 

        SpringBeanAutowiringSupport.processInjectionBasedOnServletContext(this, 
          config.getServletContext()); 
    } 

    //The following is always injected and available
    //however, it only returns valid security information for regular get and post methods,
    //not for multipart post methods
    @Autowired 
    private CustomUserService customUserService; 

    //The following is always injected and available and always returns the expected data
    @Autowired 
    private GuideService guideService; 

    //the following does not work when the client issues a multipart post, it does work for non-multipart
    public boolean getAuthenticated(){
        boolean authorized = false;

        for (GrantedAuthority authority : SecurityContextHolder.getContext().getAuthentication().getAuthorities()) {
            if(authority.getAuthority().equals("ROLE_USER") || authority.getAuthority().equals("ROLE_ADMIN")) {
                authorized = true;
                break;
            }  
        }

        return authorized;
    }

    //The following test get method works fine
    protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {           
        if(getAuthenticated()){
            PrintWriter out = resp.getWriter();
            out.write("<h1>Guide Info</h1><br/>");
            Guide guide = guideService.findById(2l);
            out.write(guide.getName() + "<br/>");
            out.write(guide.getDescription() + "<br/>");
            out.write("UserName: " + customUserService.getCurrentUser().getUsername() + "<br/>");
        }
        else{
            PrintWriter out = resp.getWriter();
            out.write("<h1>You're not authorized</h1><br/>");
        }
    }

    //This post method  
    protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {

        //the following always works, whether the clients posts using multipart or not      
        String guideName = guideService.findById(2l).getName();

        //the following does not work when the client issues a multipart post, it does work for non-multipart
        String userName = customUserService.getCurrentUser().getUsername();

        //the following does not work when the client issues a multipart post, it does work for non-multipart
        if(getAuthenticated()){
            String responseString = RESP_SUCCESS;
            boolean isMultipart = ServletFileUpload.isMultipartContent(req);

            if (isMultipart) {
                ServletFileUpload upload = new ServletFileUpload();

                //commmons fileupload code

            // Not a multi-part MIME request.
            else {
                //...
            }
            //...
        }
        else{
            //...
        }

    }

} 
```

这是 web.xml 的相关部分：

```
<servlet>
    <servlet-name>fgm</servlet-name>
    <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
    <init-param>
        <param-name>contextConfigLocation</param-name>
        <param-value>WEB-INF/spring/webmvc-config.xml</param-value>
    </init-param>
    <load-on-startup>1</load-on-startup> 
</servlet>

<servlet-mapping>
    <servlet-name>fgm</servlet-name>
    <url-pattern>/</url-pattern>
</servlet-mapping>

<servlet>
    <servlet-name>UploadServlet</servlet-name>
    <servlet-class>com.guides.servlet.UploadServlet</servlet-class>
</servlet>
<servlet-mapping>
    <servlet-name>UploadServlet</servlet-name>
    <url-pattern>/upload</url-pattern>
</servlet-mapping> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-04T17:06:34.673

我可以确认 Spring 3.0.x 和 Spring Security 3.0.x 可以与多部分帖子一起使用，也可以与其他类型的请求一起使用。我遇到了类似的行为，在我们的例子中，由于我们在过滤器映射中的错误，安全过滤器没有应用于请求。

您可以发布定义安全过滤器的 web.xml 部分，并将其映射到所需的路径吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T08:26:30.070

如果您使用的是 Spring MVC，这可能会对您有所帮助：

```
{
  @RequestMapping(method = RequestMethod.POST, value = "/some/post/url")
  public void postFile(MultipartHttpServletRequest request) {
    MultipartFile multipartFile = request.getFileMap().get("fileControlName");
    ...
  }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-29T07:08:37.353

SecurityContextHolder 提供的安全详细信息（默认情况下）存储在 ThreadLocal 中。

上传 servlet 是否会创建一个新线程来处理多部分？尝试将 SecurityContextHolderStrategy 更改为 MODE_INHERITABLETHREADLOCAL

类似问题：[如何设置 Spring Security SecurityContextHolder 策略？](https://stackoverflow.com/questions/3467918/how-to-set-up-spring-security-securitycontextholder-strategy)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-29T07:51:19.480

可能值得检查您的客户如何执行多部分帖子，您是否使用与标准帖子不同的机制/库？

如果我不得不猜测，我会说您的客户端代码没有正确验证多部分用例。

例如，将标准 Java 用于普通帖子，将 Apache 库用于多部分帖子，而在使用 Apache 的东西时忘记设置适当的 http 标头。

# javascript - Javascript：动态命名的全局变量

> ID：10587604
> 
> 赞同：5
> 
> 时间：2012-05-14T16:44:44.687
> 
> 标签：javascript, global-variables, dynamic-data

我有一个看起来像这样的全局变量：

```
var socket_x = 'whatever'; 
```

问题是“x”将取决于用户会话。假设用户 ID 为 123，我希望全局变量为：

```
var socket_123 = 'whatever'; 
```

这样，每个浏览的用户都会将自己的套接字设置为全局变量。

我只是不知道该怎么做。

我知道我可以使用：

```
eval('socket_' + userId)   = 'whatever'; //not recommended
window['socket_' + userId] = 'whatever'; //best 
```

但是如果我想像这样声明全局变量，它将不起作用：

```
var eval('socket_' + userId) = 'whatever'; 
```

有人可以帮我解决这个问题吗？

谢谢你。

PS：我知道“eval”不应该用于此，但这只是为了说明。

* * *

**编辑：**

谢谢大家的回答，但它不起作用。

这是我到目前为止的全局变量（它按原样工作，但我不想将 php 与 javascript 混合使用）：

```
var socket_<?php echo $_SESSION['user_id'];?> = io.connect( 'http://pubsub.pubnub.com', pubnub_setup_private ); 
```

如果我这样做，就像你建议的那样：

```
window['socket_'+actual_user_id]= io.connect( 'http://pubsub.pubnub.com', pubnub_setup_private ); 
```

它只是行不通。

如果我将其作为局部变量执行，则可以：

```
eval('socket_'+actual_user_id).emit( 'all', msg_all ); 
```

但如果我这样做，它不会：

```
window['socket_'+actual_user_id].emit( 'all', msg_all ); 
```

所以我在这里遇到了两个问题：

*   window 永远不适合我，eval 可以。
*   eval 用作局部变量，但不是全局变量。似乎需要“var”，但不接受在 eval 之前使用“var”。

我可以避免 eval 但我只是不知道如何。

PS：我在这里是在全球范围内。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-14T16:47:03.490

```
window['socket_'+userId] = "whatever"; 
```

那应该工作得很好。不要`eval`用于像这样微不足道的事情。

虽然，更好的是一个数组：

```
socket[userId] = "whatever"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T16:47:48.740

附加到的变量`window` **是**全局变量。例如：

```
var myVar = 'hello';
alert( window.myVar ); 
```

... 将提醒“你好”（当然，假设此代码在全局上下文中运行）。

编辑：我会尝试通过使用而不是`window`手动指定变量来确保将变量附加到对象。这意味着即使它在函数调用中也将始终有效。尝试玩这个小提琴，看看你是否可以像你的真实代码一样破解它：http: [//jsfiddle.net/2hYfa/](http://jsfiddle.net/2hYfa/)`window[xxx] = yyy``var xxx = yyy`

# ruby-on-rails - Rails 3.2 如何保护跨会话的共享资源访问

> ID：10587605
> 
> 赞同：0
> 
> 时间：2012-05-14T16:44:45.920
> 
> 标签：ruby-on-rails, ruby, semaphore

我有一个一次只能由一个会话使用的共享资源，我如何向其他会话发出该资源当前正在使用的信号？

在 Java 或 CI 中会使用互斥信号量在线程之间进行协调，我如何在 Rails 中实现这一点？我是否定义了一个新的环境变量并使用它在会话之间进行协调？

一个小代码片段以及答案将非常有帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T16:54:50.183

由于您的 Rails 实例可以在使用 Nginx 或 Apache 时在不同的进程中运行（没有像线程中那样的共享内存），我想唯一的解决方案是使用文件锁：

```
lock = File.new("/lock/file")
begin
  lock.flock(File::LOCK_EX)
  # do your logic here, or share information in your lock file
ensure
  lock.flock(File::LOCK_UN)
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-11-06T15:14:18.450

我会考虑使用 Redis 来锁定资源。

*   [https://redis.io/topics/distlock](https://redis.io/topics/distlock)
*   [https://github.com/antirez/redlock-rb](https://github.com/antirez/redlock-rb)

这具有跨多个服务器工作的优点，并且不会将锁定时间限制为当前 HTTP 请求的生命周期。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T17:34:15.883

Ruby 有一个[Mutex 类](http://ruby-doc.org/core-1.9.3/Mutex.html "互斥类")，它可以做你想做的事，尽管它不能跨进程工作。我很抱歉，虽然我知道的不够多，无法给你一个示例代码片段。文档是这样说的：“Mutex 实现了一个简单的信号量，可用于协调对来自多个并发线程的共享数据的访问。”

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-11-06T14:54:53.717

您可以使用[acts_as_lockable_by](https://github.com/tareksamni/acts_as_lockable_by) gem 来做到这一点。

假设共享资源是一个`Patient`ActiveRecord 类，只能由单个用户访问（您可以将其替换为 session_id），如下所示：

```
class Patient < ApplicationRecord
  acts_as_lockable_by :id, ttl: 30.seconds
end 
```

然后您可以在控制器中执行此操作：

```
class PatientsController < ApplicationController
  def edit
    if patient.lock(current_user.id) 
      # It will be locked for 30 seconds for the current user
      # You will need to renew the lock by calling /patients/:id/renew_lock
    else
      # Could not lock the patient record which means it is already locked by another user
    end
  end

  def renew_lock
    if patient.renew_lock(current_user.id)
      # lock renewed return 200
    else
      # could not renew the lock, it might be already released
    end
  end

  private

  def patient
    @patient ||= Patient.find(params[:id])
  end
end 
```

这是一个解决方案，它使用最少的代码并跨 RoR 机器/服务器集群工作，而不仅仅是在一个服务器上本地（如使用文件锁），因为 gem`redis`用作锁/信号量代理。,`lock`和方法都是原子的和线程安全的; `unlock`)`renew_lock`

# objective-c - Core Text 比 NSString drawInRect 小一点：？

> ID：10587606
> 
> 赞同：10
> 
> 时间：2012-05-14T16:44:50.053
> 
> 标签：objective-c, ios, core-graphics, core-text

理论上，这些应该是相同的大小，但它们不是：

![](../Images/b2dc4bea5c30f6f11a1868aee0d5a646.png)

蓝色文本来自 Core Text，黑色来自`-[NSString drawInRect:]`. 这是代码：

```
//Some formatting to get the correct frame
int y = MESSAGE_FRAME.origin.y + 8;

    if (month) y = y + 27;

    int height = [JHomeViewCellContentView heightOfMessage:self.entry.message];

    CGRect rect = CGRectMake(MESSAGE_FRAME.origin.x + 8, y, MESSAGE_FRAME.size.width - 16, height);

    //Draw in rect method
    UIFont *font = [UIFont fontWithName:@"Crimson" size:15.0f];

    [[UIColor colorWithWhite:0.2 alpha:1.0] setFill];

    [self.entry.message drawInRect:rect withFont:font lineBreakMode:UILineBreakModeWordWrap alignment:UITextAlignmentLeft];

    //Frame change to suit CoreText
    CGRect rect2 = CGRectMake(MESSAGE_FRAME.origin.x + 8, self.bounds.size.height - y - height, MESSAGE_FRAME.size.width - 16, height);

    //Core text method
    CTFontRef fontRef = CTFontCreateWithName((CFStringRef)@"Crimson", 15.0f, NULL);

    NSDictionary *attDictionary = [NSDictionary dictionaryWithObjectsAndKeys:
                                   (__bridge_transfer id)fontRef, (NSString *)kCTFontAttributeName,
                                   (id)[[UIColor blueColor] CGColor], (NSString *)kCTForegroundColorAttributeName,
                                   nil];

    NSAttributedString *attString = [[NSAttributedString alloc] initWithString:self.entry.message attributes:attDictionary];

    //Flip the coordinate system
    CGContextSetTextMatrix(context, CGAffineTransformIdentity);
    CGContextTranslateCTM(context, 0, self.bounds.size.height);
    CGContextScaleCTM(context, 1.0, -1.0);

    CGMutablePathRef path = CGPathCreateMutable();
    CGPathAddRect(path, NULL, rect2);

    CTFramesetterRef framesetter = CTFramesetterCreateWithAttributedString((__bridge_retained CFAttributedStringRef)attString);
    CTFrameRef theFrame = CTFramesetterCreateFrame(framesetter, CFRangeMake(0, [attString length]), path, NULL);
    CFRelease(framesetter);
    CFRelease(path);

    CTFrameDraw(theFrame, context);
    CFRelease(theFrame); 
```

字体是一样的。我不明白为什么一个人的渲染方式不同。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-17T13:14:52.477

这是因为`NSLayoutManager`使用一些不寻常的启发式方法来处理某些字体。

请参阅[Core Text 中的行距如何工作？（以及为什么它与 NSLayoutManager 不同？）](https://stackoverflow.com/questions/5511830/how-does-line-spacing-work-in-core-text-and-why-is-it-different-from-nslayoutm/5635981#5635981)了解更多细节。

# javascript - 为什么我的表单验证不起作用？

> ID：10587607
> 
> 赞同：0
> 
> 时间：2012-05-14T16:44:55.183
> 
> 标签：javascript, html, forms, validation

我到处寻找答案，我真的不知道我做错了什么。我意识到这可能是一个愚蠢的错误，但我绝对为此绞尽脑汁。

我有一个提交到 PHP 文件的脚本。发送时的脚本应该验证以确保填写了必填字段，如果没有填写，它应该弹出一个 Javascript 框，基本上告诉他们他们没有填写正确的字段。不幸的是，此刻，它只是发送。

代码如下：

```
 <div id="formcontainer">
<div class="formcontent">
<h3>Fields marked (*) are required</h3>The amount of money that Affecting Real Change is able to raise is dependent on the generosity of donors and our volunteer's fantastic fundraising. All of the money raised goes towards project building materials. Without these funds we really wouldn't be able to do what we do.
</div>
    <form method=post enctype=multipart/form-data action=formurl.php onSubmit="return validatePage1();">

    <h3>Full Name (Insert as it appears on your passport)&nbsp;*</h3><p class="formfield"><input class=mainForm type=text name=field_1 id=field_1 size='40' value=''></p>

<h3>Your gender&nbsp;*</h3><select class=mainForm name=field_7 id=field_7><option value=''></option><option value="Male">Male</option><option value="Female">Female</option></select>   

<h3>Email Address&nbsp;*</h3><p class="formfield"><input class=mainForm type=email name=field_2 id=field_2 size=40 value=""></p>

    <h3>Phone Number&nbsp;*</h3><p class="formfield"><input class=mainForm type=text name=field_11 id=field_11 size='40' value=''></p>

    <h3>Indicate Trip & Date&nbsp;*</h3><p class="formfield"><input class=mainForm type=text name=field_3 id=field_3 size='40' value=''></p>

<h3>Please type any more info here&nbsp;*</h3><textarea class=message  name=field_5 id=field_5 rows=7 cols=40></textarea>

<h3>I have read your <a href="http://www.affectingrealchange.org/terms-and-conditions/" target="_blank">Terms and Conditions</a> and agree&nbsp;*</h3><select class=mainForm name=field_10 id=field_10><option value=''></option><option value="Yes">Yes</option><option value="No">No</option></select>

        <!-- end of this page -->

        <!-- page validation -->
        <SCRIPT type=text/javascript>

            function validatePage1()
            {
                retVal = true;
                if (validateField('field_1','fieldBox_1','text',1) == false)
 retVal=false;
if (validateField('field_2','fieldBox_2','email',1) == false)
 retVal=false;
if (validateField('field_3','fieldBox_3','textarea',1) == false)
 retVal=false;
if (validateField('field_5','fieldBox_5','textarea',1) == false)
 retVal=false;
if (validateField('field_7','fieldBox_7','menu',1) == false)
 retVal=false;
if (validateField('field_10','fieldBox_10','menu',1) == false)
 retVal=false;
if (validateField('field_11','fieldBox_10','menu',1) == false)
 retVal=false;

                if(retVal == false)
                {
                    alert('Please correct the errors.  Fields marked with an asterisk (*) are required');
                    return false;
                }
                return retVal;
            }

        </SCRIPT>

        <!-- end page validaton -->

        <li class="mainForm">
                        <br/><p class="submit"><input id="saveForm" class="submit" type="submit" value="Submit" /></p>
                </li>

            </form> 
```

我意识到这可能是一件非常愚蠢的事情，但我终其一生都无法弄清楚它是什么。

实际上，表单只需要验证一个字段。它正在使用的网站收到大量空白页提交，因此只需验证一个字段就可以了。

任何帮助都会很棒！

谢谢刘易斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T16:49:26.297

在您的输入中，您可以添加所需的内容，即：

`<input type="text" name="Pname" maxlength="50" value="" required aria-required=true />`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T16:50:27.557

您是否在任何地方都引用了“validateField”？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T20:22:42.210

如果`validateField`调用抛出异常，它将绕过`validatePage1`. 尝试将测试包含在 try/catch 块中以查看发生了什么，例如

```
function validatePage1()
{
    retVal = true;
    try {
    if (validateField('field_1','fieldBox_1','text',1) == false)
        retVal=false;
    ...
    if (validateField('field_11','fieldBox_10','menu',1) == false)
    retVal=false;
    } catch (e) { alert(e); }

   if(retVal == false)
   {
        alert('Please correct the errors.  Fields marked with an asterisk (*) are required');
   }
   return retVal;
} 
```

你确定你没有拼写错误——你测试的所有字段都在页面上定义了吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-14T17:07:26.673

你能告诉我们你的 validateField 函数吗？我认为可能是这个功能不起作用。

顺便说一句，我认为像这样将 JS 放入 HTML 不是很好，您应该创建一个包含这样的文件：

```
<script src="js/validation.js"></script> 
```

而且我认为，您可以使用 HTML 中的数据做一些更全球化的事情。通过这样做，您可能只有一个 JS 代码用于所有表单。

# unix - 将文本添加到文件的 Unix 命令

> ID：10587615
> 
> 赞同：167
> 
> 时间：2012-05-14T16:45:52.193
> 
> 标签：unix, command-line, utilities, prepend

是否有 Unix 命令将一些字符串数据添加到文本文件中？

就像是：

```
prepend "to be prepended" text.txt 
```

* * *

## 回答 #1

> 赞同：178
> 
> 时间：2015-01-14T18:52:44.147

```
printf '%s\n%s\n' "to be prepended" "$(cat text.txt)" >text.txt 
```

* * *

## 回答 #2

> 赞同：145
> 
> 时间：2012-05-14T17:01:01.557

```
sed -i.old '1s;^;to be prepended;' inFile 
```

*   `-i`如果给出任何扩展名，则将更改写入到位并进行备份。（在这种情况下，`.old`）
*   `1s;^;to be prepended;`用给定的替换字符串替换第一行的开头，`;`用作命令分隔符。

* * *

## 回答 #3

> 赞同：68
> 
> 时间：2017-03-15T22:55:23.577

# 进程替换

我很惊讶没有人提到这一点。

```
cat <(echo "before") text.txt > newfile.txt 
```

这可以说比公认的答案更自然（打印一些东西并将其传送到替换命令中是字典上的反直觉）。

...并劫持 ryan 上面所说的内容，`sponge`您不需要临时文件：

```
sudo apt-get install moreutils
<<(echo "to be prepended") < text.txt | sponge text.txt 
```

编辑：看起来这在 Bourne Shell 中不起作用`/bin/sh`

* * *

# 这里字符串（仅限 zsh）

使用 here-string - `<<<`，您可以执行以下操作：

```
<<< "to be prepended" < text.txt | sponge text.txt 
```

* * *

## 回答 #4

> 赞同：42
> 
> 时间：2012-05-14T16:50:07.170

这是一种可能性：

```
(echo "to be prepended"; cat text.txt) > newfile.txt 
```

您可能不会轻易绕过中间文件。

替代方案（外壳转义可能很麻烦）：

```
sed -i '0,/^/s//to be prepended/' text.txt 
```

* * *

## 回答 #5

> 赞同：22
> 
> 时间：2012-05-14T16:52:06.423

这将用于形成输出。- 表示标准输入，通过管道从 echo 提供。

```
echo -e "to be prepended \n another line" | cat - text.txt 
```

要重写文件，需要一个临时文件，因为无法通过管道返回输入文件。

```
echo "to be prepended" | cat - text.txt > text.txt.tmp
mv text.txt.tmp text.txt 
```

* * *

## 回答 #6

> 赞同：17
> 
> 时间：2015-05-22T03:00:45.770

#### 如果可以*替换*输入文件：

笔记：

*   这样做可能会产生意想不到的副作用，特别是可能会用常规文件替换符号链接，最终获得文件的不同权限，并更改文件的创建（出生）日期。

*   `sed -i`，正如[约翰卫斯理王子的回答](https://stackoverflow.com/a/10587853/45375)，试图至少恢复原始权限，但其他限制也适用。

这是一个**使用临时文件的简单替代方案（它避免像**[shime 的解决方案](https://stackoverflow.com/a/27950358/45375)那样将整个输入文件读入内存）：

```
{ printf 'to be prepended'; cat text.txt; } > tmp.txt && mv tmp.txt text.txt 
```

^(使用*组*命令 ( ) 比使用*子 shell* ( )`{ ...; ...; }`稍微高效一些，如[0xC0000022L 的解决方案](https://stackoverflow.com/a/10587688/45375)。*`(...; ...)`*)

 *优点是：

*   很容易控制新文本是否应直接添加到第一行，或者是否应作为*新行*插入（只需添加`\n`到`printf`参数中）。

*   与`sed`解决方案不同，如果输入文件为空（`0`字节），它会起作用。

* * *

***如果意图是在现有内容前添加一整行*或多[`sed`](https://stackoverflow.com/a/10587853/45375)***行（假设输入文件非空），**则可以简化****[解决方案：](https://stackoverflow.com/a/10587853/45375)***

 *`sed`的`i`函数插入整行：

使用*GNU* `sed`：

```
# Prepends 'to be prepended' *followed by a newline*, i.e. inserts a new line.
# To prepend multiple lines, use '\n' as part of the text.
# -i.old creates a backup of the input file with extension '.old'
sed -i.old '1 i\to be prepended' inFile 
```

也适用于 macOS / BSD 的便携式变体`sed`：

```
# Prepends 'to be prepended' *followed by a newline*
# To prepend multiple lines, escape the ends of intermediate
# lines with '\'
sed -i.old -e '1 i\
to be prepended' inFile 
```

请注意，后面的文字换行符`\`是必需的。

* * *

#### 如果必须*就地*编辑输入文件（保留其 inode 及其所有属性）：

使用古老的[`ed`POSIX 实用程序](http://pubs.opengroup.org/onlinepubs/9699919799/utilities/ed.html)：

笔记：

*   `ed`总是首先将输入文件*作为一个整体*读入内存。

**直接添加到第一行**（与 一样，如果输入文件完全为空（字节）`sed`，这将不起作用）：`0`

```
ed -s text.txt <<EOF
1 s/^/to be prepended/
w
EOF 
```

*   `-s`抑制`ed`的状态消息。
*   注意命令是如何`ed`作为多行[here-document](http://mywiki.wooledge.org/HereDocument) ( `<<EOF\n...\nEOF`) 提供的，即通过*stdin*；*默认情况下，在此类文档中*执行字符串扩展（插入 shell 变量）；*引用*开始分隔符来抑制它（例如，`<<'EOF'`）。
*   `1`使第一行成为当前行
*   函数`s`对当前行执行基于正则表达式的字符串替换，如`sed`; 您可以在替换文本中包含*文字*换行符，但它们必须是`\`- 转义的。
*   `w`将结果写回输入文件（为了测试，替换`w`为`,p`只*打印*结果，不修改输入文件）。

**前置一个或多个*整***行：

与 一样`sed`，该`i`函数总是在要插入的文本中添加一个尾随换行符。

```
ed -s text.txt <<EOF
0 i
line 1
line 2
.
w
EOF 
```

*   `0 i`使`0`（文件的开头）成为当前行并开始插入模式（`i`）；请注意，行号是`1`基于 - 的。
*   以下行是要在当前行*之前*`.`插入的文本，以单独的行结束。

* * *

## 回答 #7

> 赞同：14
> 
> 时间：2015-12-25T08:32:20.990

更喜欢亚当的[回答](https://stackoverflow.com/a/10587718/3675670)

[我们可以让海绵](http://linux.die.net/man/1/sponge)更容易使用。现在我们不需要创建一个临时文件并将其重命名为

```
echo -e "to be prepended \n another line" | cat - text.txt | sponge text.txt 
```

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2012-05-14T16:49:48.020

可能没有内置的，但你可以很容易地编写自己的，像这样：

```
#!/bin/bash
echo -n "$1" > /tmp/tmpfile.$$
cat "$2" >> /tmp/tmpfile.$$
mv /tmp/tmpfile.$$ "$2" 
```

至少是这样的……

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2014-10-06T12:48:07.710

另一种使用方式`sed`：

```
sed -i.old '1 {i to be prepended
}' inFile 
```

如果要添加的行是多行：

```
sed -i.old '1 {i\ 
to be prepended\
multiline
}' inFile 
```

* * *

## 回答 #10

> 赞同：7
> 
> 时间：2017-11-20T19:36:26.043

解决方案：

```
printf '%s\n%s' 'text to prepend' "$(cat file.txt)" > file.txt 
```

请注意，这对所有类型的输入都是安全的，因为没有扩展。例如，如果你想 prepend `!@#$%^&*()ugly text\n\t\n`，它会起作用：

```
printf '%s\n%s' '!@#$%^&*()ugly text\n\t\n' "$(cat file.txt)" > file.txt 
```

最后要考虑的部分是命令替换期间文件末尾的空格删除`"$(cat file.txt)"`。对此的所有解决方法都相对复杂。如果要在 file.txt 末尾保留换行符，请参见：[https ://stackoverflow.com/a/22607352/1091436](https://stackoverflow.com/a/22607352/1091436)

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2017-08-11T01:29:57.217

编者注：

*   **如果输入文件恰好大于系统的管道缓冲区大小**（现在通常为 64 KB），则此命令将导致数据丢失。有关详细信息，请参阅评论。

* * *

在某些情况下，前置文本可能只能从标准输入获得。然后这个组合应该起作用。

```
echo "to be prepended" | cat - text.txt | tee text.txt 
```

如果要省略`tee`输出，请附加`> /dev/null`.

* * *

## 回答 #12

> 赞同：6
> 
> 时间：2019-02-07T19:15:27.697

正如在 Bash（在 Ubuntu 中）中测试的那样，如果从测试文件开始；

`echo "Original Line" > test_file.txt`

你可以执行；

`echo "$(echo "New Line"; cat test_file.txt)" > test_file.txt`

或者，如果 bash 的版本对于 $() 来说太旧，您可以使用反引号；

`echo "`echo "New Line"; cat test_file.txt`" > test_file.txt`

并接收“test_file.txt”的以下内容；

```
New Line
Original Line 
```

没有中间文件，只有 bash/echo。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2015-07-16T14:21:53.170

Another fairly straight forward solution is:

```
 $ echo -e "string\n" $(cat file) 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2015-01-21T23:09:12.453

如果你喜欢 vi/vim，这可能更符合你的风格。

```
printf '0i\n%s\n.\nwq\n' prepend-text | ed file 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2021-06-17T21:40:50.080

对于希望附加一行或多行文本（带有变量甚至子shell代码）并保持其可读性和格式化的未来读者，您可能会喜欢这个：

```
echo "Lonely string" > my-file.txt 
```

然后运行

```
cat <<EOF > my-file.txt
Hello, there!

$(cat my-file.txt)
EOF 
```

结果`cat my-file.txt`：

```
Hello, there!

Lonely string 
```

这是有效的，因为读取`my-file.txt`首先发生在子shell中。我一直使用这个技巧将重要的规则附加到 Docker 容器中的配置文件中，而不是复制整个配置文件。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2021-11-14T18:57:44.080

```
% echo blaha > blaha
% echo fizz > fizz
% cat blaha fizz > buzz
% cat buzz 
blaha
fizz 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2015-04-16T21:34:02.843

```
# create a file with content..
echo foo > /tmp/foo
# prepend a line containing "jim" to the file
sed -i "1s/^/jim\n/" /tmp/foo
# verify the content of the file has the new line prepened to it
cat /tmp/foo 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2018-06-21T16:43:28.843

我建议定义一个函数，然后在需要的地方导入和使用它。

```
prepend_to_file() { 
    file=$1
    text=$2

    if ! [[ -f $file ]] then
        touch $file
    fi

    echo "$text" | cat - $file > $file.new

    mv -f $file.new $file
} 
```

然后像这样使用它：

```
prepend_to_file test.txt "This is first"
prepend_to_file test.txt "This is second" 
```

您的文件内容将是：

```
This is second
This is first 
```

我将使用这种方法来实现更改日志更新程序。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2021-01-27T18:39:55.840

您可以使用 awk 轻松做到这一点

```
cat text.txt|awk '{print "to be prepended"$0}' 
```**

# javascript - 脚本工作依赖于 IE 文档模式

> ID：10587616
> 
> 赞同：4
> 
> 时间：2012-05-14T16:45:57.810
> 
> 标签：javascript, internet-explorer, cross-browser

我正在尝试用 JavaScript 编写一个小部件（使用 UWA 语法）。它在 FireFox 中运行良好，但 Internet Explorer 正在.. 奇怪。

基本上，当我第一次加载小部件时，它不会显示我的中心列（它应该显示当天的职责列表）。

![默认](../Images/b5dd5b26fc9dfcc57e41ba34a3d92a46.png)

但是，如果我按 F12 并进入开发者控制台，我可以将**文档模式**更改为`IE9 standards`并使其正常工作。

![IE9标准模式](../Images/17c9c3cf1ccf2f1c29ee086e53e55e5c.png)

如果我随后将**Document 模式**设置为`Quirks`，则显示如下：

![怪癖模式](../Images/ba57b3c0c926bba500425b88cfa4be09.png)

定义中心列的代码如下：

```
/* [centre] Duty rota */
AllInOne.centreCol = function() {
    var now = new Date();
    var currentDay = now.getDay();

    var DRWeek1 = {
        Monday : {
            BeforeSchool : "HA, MJO, LS, GB, JSA, HA, TD",
            Breaks : "ABO, LL, RR, DR, PHd, JA, VID, AN, LDE, CN, DW, PG, MD, ND, CK, JP, RH, RJ, CC, GB",
            AfterSchool : "GB, CL, MVW, TD/GDO, HL, LS"
        },
        Tuesday : {
            BeforeSchool : "RJ, AN, AS, GB, JSA, SUW, MJO",
            Breaks : "DW, AB, RR, SDI, PHd, LL, ABO, ND, CG, CC, MD, PD, CT, RY, LDE, SC, RH, JR, RC, GB",
            AfterSchool : "GB, CL, MJO, TD/GDO, SUW, AS"
        },
        Wednesday : {
            BeforeSchool : "JP, JC, SM, GB, HSA, HA, CL",
            Breaks : "BW, JR, TG, SD, PHd, JM, SW, MVW, CG, AMO, MDA, KL, VID, CN, SDI, DST, VY, SLH, JH, GB",
            AfterSchool : "GB, MJO, CL, TD/GDO, HA, SM"
        },
        Thursday : {
            BeforeSchool : "SUW, HL, ST, GB, JSA, HL, CK",
            Breaks : "DR, VY, HL, CK, PHd, JC, DST, HS, SC, MDA, AH, PD, NB, AMO, HSM, DM, JOS, SLH, CK, GB",
            AfterSchool : "GB, JOR, JH, TD/GDO, HL, ST"
        },
        Friday : {
            BeforeSchool : "TG, SUW, JT, GB, JSA, JM, JP",
            Breaks : "SW, AB, HSM, HA, PHd, DM, JOS, CT, KL, BW, RY, PG, JA, NB, RC, HS, JOR, AH, GP, GB",
            AfterSchool : "GB, SWA, JM, TD/GDO, JP, JT"
        }
    }

    var DRHTML = '<h2>Duty Rota</h2>';

    switch ( currentDay ) {
        case 1:
            DRHTML += '<p><strong>Before School:</strong>' + DRWeek1.Monday.BeforeSchool + '</p>';
            DRHTML += '<p><strong>Break / Lunch:</strong>' + DRWeek1.Monday.Breaks + '</p>';
            DRHTML += '<p><strong>After School:</strong>' + DRWeek1.Monday.AfterSchool + '</p>';
            break;
        case 2:
            DRHTML += '<p><strong>Before School:</strong>' + DRWeek1.Tuesday.BeforeSchool + '</p>';
            DRHTML += '<p><strong>Break / Lunch:</strong>' + DRWeek1.Tuesday.Breaks + '</p>';
            DRHTML += '<p><strong>After School:</strong>' + DRWeek1.Tuesday.AfterSchool + '</p>';
            break;
        case 3:
            DRHTML += '<p><strong>Before School:</strong>' + DRWeek1.Wednesday.BeforeSchool + '</p>';
            DRHTML += '<p><strong>Break / Lunch:</strong>' + DRWeek1.Wednesday.Breaks + '</p>';
            DRHTML += '<p><strong>After School:</strong>' + DRWeek1.Wednesday.AfterSchool + '</p>';
            break;
        case 4:
            DRHTML += '<p><strong>Before School:</strong>' + DRWeek1.Thursday.BeforeSchool + '</p>';
            DRHTML += '<p><strong>Break / Lunch:</strong>' + DRWeek1.Thursday.Breaks + '</p>';
            DRHTML += '<p><strong>After School:</strong>' + DRWeek1.Thursday.AfterSchool + '</p>';
            break;
        case 5:
            DRHTML += '<p><strong>Before School:</strong>' + DRWeek1.Friday.BeforeSchool + '</p>';
            DRHTML += '<p><strong>Break / Lunch:</strong>' + DRWeek1.Friday.Breaks + '</p>';
            DRHTML += '<p><strong>After School:</strong>' + DRWeek1.Friday.AfterSchool + '</p>';
            break;
        default:
            DRHTML += '<p>No school. Yay!</p>';
            break;
    }

    var DutyRota = widget.createElement( 'p', 
        { 'id' : 'DR', 'class' : 'DR' } );
    widget.body.getElementsByClassName('centre_col')[0].appendChild(DutyRota);
    widget.body.getElementsByClassName('DR')[0].setHTML(DRHTML);
} 
```

Internet Explorer 不喜欢该功能中的某些内容吗？

我非常困惑，任何帮助将不胜感激。

* * *

**编辑**：完整代码

可以在这里找到：http: [//pastebin.com/n1qFeTnU](http://pastebin.com/n1qFeTnU)

* * *

**附加编辑**：看起来小部件容器正在强制页面进入 IE9 怪癖模式。因此，这意味着我根本无法控制文档模式。

所以，**问题仍然存在**，在我的代码中，IE9（浏览器模式）Quirks（文档模式）中的 Internet Explorer 不喜欢什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-14T16:48:28.387

这里有一个提示，*不要使用 Quirks Mode*。它像 IE5.5 那样渲染，甚至比 IE6 还要糟糕……

尝试将此标签添加到您的文件中：

```
<meta http-equiv="X-UA-Compatible" content="IE=edge" /> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-22T18:52:32.647

首先，尝试删除`<?xml version="1.0" encoding="utf-8"?>`您的 DOCTYPE 之前的 xml 字符串。即使对于 XHTML，它也不应该是必需的。在你的文档类型之前有任何东西可以触发怪癖模式。[W3C 学校](http://www.w3schools.com/html/html_xhtml.asp)说 XHTML doctype 也应该是文档的第一行。

我想运行你的代码，所以我可以自己尝试，但我不能，因为你的 pastebin 示例不包含实际的框架，所以脚本在到达未声明的“widget”变量时会中断。

编辑：*我忘了提，如果上述方法有效，但您仍需要声明 UTF-8 编码，则可以[使用元标记来执行此操作](http://tlt.its.psu.edu/suggestions/international/web/tips/declare.html)*。

最后，如果上述方法不起作用并且您*确定*兼容性视图不是您的问题（检查“工具\兼容性视图设置”），您可以尝试通过删除样式表并确认功能代码正常工作来调试它.

我的猜测是你的小部件在那里，但被渲染不佳的 CSS 隐藏，一些浮动或 z 顺序或者可能显示设置被误解。慢慢添加样式可能会帮助您缩小出错的范围，以便您可以解决它。

我注意到，[在这里](http://dev.netvibes.com/doc/uwa/documentation/javascript_framework)，所有小部件都在 IFRAMES 中运行。在 IE 中，如果框架页面处于 quirks 模式，则 IFRAMES 以 quirks 模式呈现。我不确定这是否相关，因为您说小部件本身是强制怪癖模式的原因，但值得牢记。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-22T05:36:54.303

首先要检查的是兼容性视图设置。例如，可以将其设置为默认为 IE7 模式。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-22T10:38:23.430

如果您想向后*和*跨浏览器兼容，IMO 最简单的修复方法是将 doctype 设置为 HTML5 `<!DOCTYPE html>`。所有主流浏览器都支持这一点，这会强制 IE8 进入标准模式，您可以[在此处验证](http://ejohn.org/blog/html5-doctype/)。[我在 IE8 中扩展 Event 原型时](https://stackoverflow.com/questions/10617014/javascript-event-prototype-in-ie8)遇到了一些困难，切换到 HTML5 文档类型为我解决了问题。虽然通常情况下，IE8 并不热衷于增加 dom 对象，但这确实有效，但没问题。不知道你可以用这个忍者知识强迫 IE8 下一步做什么:)

**更新：**

我看过你的粘贴箱，我只是想知道：你是否都删除了

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"> 
```

和

```
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:frog="http://fdp.frogtrade.com/ns/"> 
```

线？将它们替换为`<!DOCTYPE html>`? 乍一看，这也是[MS 建议](http://msdn.microsoft.com/en-us/library/hh404102.aspx)的。你能告诉我现在的标题是什么样的吗？我会尝试复制这个问题，因为我对此有点感兴趣：D

**更新2：**

正如 jatrim 指出的那样：就 IE 而言，小部件是在 iFrame 中呈现的。在这种情况下，如果父文档以 quirks 模式呈现，则将 doctype 设置为`<!DOCTYPE html>`不会强制执行标准模式。也许您可以检查一下将父文档设置为是否可以解决`<!DOCTYPE html>`问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-23T06:58:17.683

我认为 IE 如何以任何模式显示您的页面并不重要。例如，如果 IE9 在默认情况下不以 Quirks 模式呈现您的页面，那么您为什么必须在那里修复错误？没有人（除了一些疯狂的人）会仅仅因为他们可以强制他们的 IE 进入默认不使用的渲染模式。

我检查浏览器的方法是：

*   为每个 IE 版本下载一个虚拟机[http://www.microsoft.com/en-us/download/details.aspx?id=11575](http://www.microsoft.com/en-us/download/details.aspx?id=11575)或自己创建
*   使用以下代码作为 URL 创建收藏夹：

    ```
    javascript:(function(){var%20vMode=document.documentMode;var%20rMode='IE5%20Quirks%20Mode';if(vMode==9){rMode='IE9%20Standards%20Mode';}else%20if(vMode==8){rMode='IE8%20Strict%20Mode';}else%20if(vMode==7){rMode='IE7%20Strict%20Mode';}alert('Rendering%20in:%20'+rMode+"\nId: "+vMode);})(); 
    ```

*   打开你的页面并通过点击收藏来执行上面的代码
*   您现在将获得一个消息框，您可以在其中查看您的页面呈现的模式

意识到！该脚本仅处理 IE 版本 6-9。在 IE10 中，每当您的页面以 Quirks 模式显示时，它可能会显示给您。因此，我添加了您可以看到真实文档模式的 ID :)

如果您的页面（默认情况下）以 Quirks 模式呈现，我会搜索触发它的原因并在开始修复新浏览器中包含的 CSS 中的 IE5.5 的呈现错误之前摆脱它。

有关 Quirks-Mode 的更多详细信息：[http ://www.quirksmode.org/css/quirksmode.html](http://www.quirksmode.org/css/quirksmode.html)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-26T05:58:32.560

如果是IFRAME，注意如果父页面是IE9标准模式，子页面只能是这种模式或者“quirks mode emulation”模式。要在 IFRAME 中获得真正的 quirks 模式，父页面必须处于 IE8 或更早的模式，在这种情况下，子页面不能处于 IE9 模式，只能在 IE8 或更早的模式下。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-05-24T09:52:14.837

正如`getElementsByClassName`仅在 IE 9 中引入的那样，我猜怪癖模式不会让您使用它。

即在您的代码末尾，您未能附加 DutyRota

# r - 如何打印（到纸上）格式良好的数据框

> ID：10587621
> 
> 赞同：81
> 
> 时间：2012-05-14T16:46:11.070
> 
> 标签：r, dataframe, formatting

我想将格式良好的数据帧打印到纸上，最好是在脚本中。（我正在尝试使用仪器收集数据并使用 R 脚本自动处理和打印）。

现在我可以使用 将数据框写入文本文件`write.table()`，但这有两个问题：

1.  生成的文本文件格式不正确（列不一定与其标题对齐）并且
2.  我不知道如何从 R 中打印文本文件。

我更多的是寻找通用策略而不是特定代码（尽管代码也会很棒！）。Sweave 会是最方便的解决方案吗？原则上我可以`socketConnection()`用来打印到打印机 - 如果可以，我在哪里可以了解如何使用它（我没有发现文档很有帮助）。

* * *

## 回答 #1

> 赞同：108
> 
> 时间：2012-05-14T17:31:50.363

`grid.table`这是使用gridExtra 包的一种快速简便的方法：

```
library(gridExtra)
pdf("data_output.pdf", height=11, width=8.5)
grid.table(mtcars)
dev.off() 
```

![在此处输入图像描述](../Images/de49cf80183c0a1f7ce67796d6064f6b.png)

如果您的数据不适合页面，您可以减小文本大小`grid.table(mtcars, gp=gpar(fontsize=8))`。这可能不是很灵活，也不容易泛化或自动化。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-05-14T16:55:17.067

我建议`xtable`结合 LaTeX 文档。看看这个[pdf中的例子：](http://cran.r-project.org/web/packages/xtable/vignettes/xtableGallery.pdf)

您也可以直接将其与`Sweave`or结合使用[`knitr`](http://yihui.name/knitr/)。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2016-10-24T17:26:36.830

令人惊讶的是，没有人提到`stargazer`可以很好地打印数据的软件包。

你可以输出一个好看的文本文件：

```
stargazer(mtcars, type = 'text', out = 'out.txt')

============================================
Statistic N   Mean   St. Dev.  Min     Max  
--------------------------------------------
mpg       32 20.091   6.027   10.400 33.900 
cyl       32  6.188   1.786     4       8   
disp      32 230.722 123.939  71.100 472.000
hp        32 146.688  68.563    52     335  
drat      32  3.597   0.535   2.760   4.930 
wt        32  3.217   0.978   1.513   5.424 
qsec      32 17.849   1.787   14.500 22.900 
vs        32  0.438   0.504     0       1   
am        32  0.406   0.499     0       1   
gear      32  3.688   0.738     3       5   
carb      32  2.812   1.615     1       8   
-------------------------------------------- 
```

甚至是 HTML：

```
stargazer(mtcars, type = 'html', out = 'out.html') 
```

```
<table style="text-align:center"><tr><td colspan="6" style="border-bottom: 1px solid black"></td></tr><tr><td style="text-align:left">Statistic</td><td>N</td><td>Mean</td><td>St. Dev.</td><td>Min</td><td>Max</td></tr>
<tr><td colspan="6" style="border-bottom: 1px solid black"></td></tr><tr><td style="text-align:left">mpg</td><td>32</td><td>20.091</td><td>6.027</td><td>10.400</td><td>33.900</td></tr>
<tr><td style="text-align:left">cyl</td><td>32</td><td>6.188</td><td>1.786</td><td>4</td><td>8</td></tr>
<tr><td style="text-align:left">disp</td><td>32</td><td>230.722</td><td>123.939</td><td>71.100</td><td>472.000</td></tr>
<tr><td style="text-align:left">hp</td><td>32</td><td>146.688</td><td>68.563</td><td>52</td><td>335</td></tr>
<tr><td style="text-align:left">drat</td><td>32</td><td>3.597</td><td>0.535</td><td>2.760</td><td>4.930</td></tr>
<tr><td style="text-align:left">wt</td><td>32</td><td>3.217</td><td>0.978</td><td>1.513</td><td>5.424</td></tr>
<tr><td style="text-align:left">qsec</td><td>32</td><td>17.849</td><td>1.787</td><td>14.500</td><td>22.900</td></tr>
<tr><td style="text-align:left">vs</td><td>32</td><td>0.438</td><td>0.504</td><td>0</td><td>1</td></tr>
<tr><td style="text-align:left">am</td><td>32</td><td>0.406</td><td>0.499</td><td>0</td><td>1</td></tr>
<tr><td style="text-align:left">gear</td><td>32</td><td>3.688</td><td>0.738</td><td>3</td><td>5</td></tr>
<tr><td style="text-align:left">carb</td><td>32</td><td>2.812</td><td>1.615</td><td>1</td><td>8</td></tr>
<tr><td colspan="6" style="border-bottom: 1px solid black"></td></tr></table>
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2015-07-04T13:45:05.853

该软件包是在[knitr](http://yihui.name/knitr/)文档中打印、帮助页面、小插图列表和数据集列表[`printr`](http://yihui.name/printr/)的不错选择。`data.frames`

从[文档页面](http://yihui.name/printr/)：

```
options(digits = 4)
set.seed(123)
x = matrix(rnorm(40), 5)
dimnames(x) = list(NULL, head(LETTERS, ncol(x)))
knitr::kable(x, digits = 2, caption = "A table produced by printr.") 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2016-01-02T19:47:06.557

grid.table 解决方案确实是创建 PDF 的最快方法，但如果您有一个相当长的表格，这可能不是最佳解决方案。RStudio + knitr + longtable 使创建格式良好的 PDF 变得非常容易。你需要的是这样的：

```
\documentclass{article}
\usepackage{longtable}
\begin{document}

<<results='asis'>>=
library(xtable)

df = data.frame(matrix(rnorm(400), nrow=100))
xt = xtable(df)
print(xt, 
      tabular.environment = "longtable",
      floating = FALSE
      )
@
\end{document} 
```

请参阅[这篇](https://thusithamabotuwana.wordpress.com/2016/01/02/creating-pdf-documents-with-rrstudio/)文章了解更多详情。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2013-09-20T18:09:53.083

不那么花哨，但非常实用：

```
print.data.frame(iris) 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2017-01-03T16:34:12.803

对于**长/宽表**，您可以使用[pander](https://cran.r-project.org/web/packages/pander/index.html)。

它会自动将长表拆分为适合页面的较短部分，例如使用[knitr](https://cran.r-project.org/web/packages/knitr/)将此块插入您的 Rmd 文件：

```
pander::pander(mtcars) 
```

[![在此处输入图像描述](../Images/146b3ca3d68edfa0813ed765645de7ea.png)](https://i.stack.imgur.com/ITnfq.png)

如果您想要看起来更像**Excel 表格**的东西（即使在 html 中有编辑选项），请使用[rhandsontable](https://cran.r-project.org/web/packages/rhandsontable/)。[有关小插图](https://cran.r-project.org/web/packages/rhandsontable/vignettes/intro_rhandsontable.html)中的用法和格式的更多信息。您需要将 Rmd 编​​入一个 html 文件：

```
library(rhandsontable)
rhandsontable(mtcars, rowHeaders = NULL) 
```

[![在此处输入图像描述](../Images/de5989c458d312833363e560383f0efe.png)](https://i.stack.imgur.com/VJct2.png)

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2015-08-12T14:37:56.723

[RStudio IDE](https://www.rstudio.com/)提供了另一个不错的选项来打印 data.table：

1.  在查看器中打开数据，例如`View(data_table)`或通过 GUI
2.  在单独的窗口中打开视图（左上角的图标：“在新窗口中显示”）
3.  单独的窗口现在支持打印对话框（包括预览）

这适用于 RStudio V0.98.1103（可能还有更新的版本）

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2016-02-27T21:50:03.247

当我想做类似的事情时，我遇到了这个问题。[我发现在 stackoverflow 的其他地方](https://stackoverflow.com/questions/10956170/sink-a-data-frame-to-txt-file)提到了 sink 命令，这在这种情况下很有用：

```
sink('myfile.txt')
print(mytable,right=F)
sink() 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2017-07-27T14:04:55.120

如果要导出为 png，可以这样做：

```
library(gridExtra)
png("test.png", height = 50*nrow(df), width = 200*ncol(df))
grid.table(df)
dev.off() 
```

如果你想导出为 pdf，你可以这样做：

```
library(gridExtra)
pdf("test.pdf", height=11, width=10)
grid.table(df)
dev.off() 
```

# c# - 需要客户端 Web 应用程序来访问我编写的本地应用程序

> ID：10587624
> 
> 赞同：0
> 
> 时间：2012-05-14T16:46:17.467
> 
> 标签：c#, javascript, asp.net, vbscript, smartcard

总体目标是我需要一个基于 Web 的时钟系统，该系统可以从 HID 代理卡访问 ID。我在 C# ASPX .net Framework 4 中编写了 Web 应用程序端，在 C# .net Framework 4 中编写了一个本地应用程序来访问 HID Omnikey 5325 USB 读卡器以从代理卡中获取 ID。我现在需要通过客户端将该信息传递给 Web 应用程序。试图弄清楚如何让两人互相交谈。创建共享文件不是一种选择。

Web 客户端和 Prox 卡应用程序在同一台计算机上运行。

最终用户体验：

用户走到触摸屏显示器和读卡器。点卡。选择打卡或打卡。走开。

应用程序需要基于 Web，因为分发的开销对于我正在使用的规模和我拥有的人力来说太大了。

有任何想法吗。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T16:49:32.367

您只需要服务器端的服务，如果您在服务器端有 ASP.net MVC 或 WCF 服务，它可以是 MVC 控制器。并从您的 C# 应用程序调用该服务。

# php - 如何使用 php 在一个文件中写入非 ASCII 数据

> ID：10587625
> 
> 赞同：0
> 
> 时间：2012-05-14T16:46:24.610
> 
> 标签：php, binary-data

我必须用php写一个二进制文件，但我认为我没有使用正确的方法。

我使用这个功能：

```
$ptr = fopen("file.txt", 'wb');
fwrite($ptr, $Str);
fclose($ptr); 
```

我写了这个字符串（0和1的混乱表示）：

```
$Str="00000001001110000000000100000100000000000000001000000010000000010000001100000101000000000000010000000001000000000000010100000"; 
```

我以为用 OpenOffice 打开文件我不会看到零和一的文本，但我确信我看到的是混乱的字符序列。为什么我在开放式办公室看到零和一？如何用 php 编写原始数据？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T16:50:05.620

如果您在文件中写入文本，即使以二进制模式打开，您也会在文件中获得文本。您`0`的存储不是零位，而是字符的 ASCII 表示`0`。

在 PHP 中使用二进制格式的数字，例如：

```
$var = OxFF; // equals to 1111 1111 in binary. 
```

[手册中的更多内容](http://us.php.net/manual/en/function.bindec.php)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T16:50:06.373

[`chr()`](http://php.net/chr)您可以使用该功能编写任何字符。

或者，您可以执行类似`"\x0A"`的操作（即换行符）。

# javascript - changePage 后 jQuery Mobile 刷新页面

> ID：10587634
> 
> 赞同：7
> 
> 时间：2012-05-14T16:46:57.653
> 
> 标签：javascript, jquery, ajax, mobile, jquery-mobile

无论如何，一旦 changePage 完成，是否强制重新加载 jQm 页面？

我有许多页面动态加载到一个数组中。所有正在加载的页面都是列表的一部分，例如“2011 年的 20 个移动应用程序”。用户需要能够左右滑动来导航页面。

我在这里添加了当前代码：http: [//jsfiddle.net/cncpts/qMe6Z/2/](http://jsfiddle.net/cncpts/qMe6Z/2/)

请注意如何从数组中提取 URL。从此我可以提取下一个 URL 和上一个 URL，但我只能向前和向后导航一页。

您可以通过单击然后向左或向右滑动鼠标来测试页面：[http ://www.cncpts.me/complex/swipe/index.php](http://www.cncpts.me/complex/swipe/index.php)

关于如何在保持原生 JQM 转换的同时刷新 URL 的任何想法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T16:51:43.287

为什么不使用[JQM 分页插件](http://filamentgroup.com/lab/jquery_mobile_pagination_plugin/)？应该正是您正在寻找的。

如果要更改 URL，则必须将*changehash*选项设置为 true 才能更改

```
 $.mobile.changePage(next,{
      changeHash:true,
      reloadPage:true,
      dataUrl:next
      }); 
```

这是[演示的链接](http://filamentgroup.com/examples/jqm-pagination/demo/)

# python - Python中的内存映射寄存器

> ID：10587639
> 
> 赞同：6
> 
> 时间：2012-05-14T16:47:07.500
> 
> 标签：python, device-driver

有没有人想出一个很好的解决方案来处理 Python 下的内存映射设备寄存器？理想情况下，可以让我使用命名寄存器，甚至这些寄存器中的命名位域，以一种不完全临时的方式？理想情况下是跨平台的，但我只能使用 Linux。

似乎 mmap 和 ctypes 结构的某种组合可能能够处理它，但是 a）结构似乎不允许您指定位域位置（它们在 C 中也没有，所以......），并且 b）我可以'不知道如何将 Struct 映射放在 mmap 上。

还是我从根本上问我如何使用圆锯作为螺丝刀？（即它不这样做，你到底为什么要这样做？）

C 中的一个示例（未经测试，不用于使用）将类似于：

```
volatile struct {
    uint32_t mfr_id;
    uint32_t prod_id;
    uint32_t ctl;
    uint32_t dummy[5];
    ...
} * pDev;
hFile = open('/dev/bridge', O_RDWR)
pDev = mmap(NULL, 4096, PROT_READ | PROT_WRITE, MAP_SHARED, hFile, 0);
assert(pDev->mfr_id == 0x12345678);
assert(pDev->prod_id == 0xDEADBEEF);

uint32_t temp = pDev->ctl;
temp &= CTL_ACCESS_MASK | CTL_SHIFT_MASK;
temp |= CTL_ACCESS_RO | CTL_SHIFT_5;
pDev->ctl = temp; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T22:17:53.470

我认为最简单的方法是用 C 编写访问器函数并从 Python 调用它们（在 ctypes 和 Cython 之间，从 Python 调用 C 代码并不难）。

# scala - Scala 丢失了参数的通用类型

> ID：10587640
> 
> 赞同：0
> 
> 时间：2012-05-14T16:47:10.337
> 
> 标签：scala, types, covariance

在我处理继承特征的重写函数中使用的棘手协变类型时，我头晕目眩。基本问题是，`[?]`类型是什么？我找不到一个好的定义（它有点难以理解），因此不清楚为什么 a在以下示例中`[T]`被替换为：`[?]`

```
> sealed trait Bar[+T]
> trait FooT { type Other; def foo[T,V](stuff:Bar[T]*) { stuff.headOption.isDefined } }
> trait TooF extends FooT { override def foo[T,V](stuff:Bar[T]*) { super.foo(stuff) } }
<console>:7: error: type mismatch;
found   : Bar[T]*
required: Bar[?]
   trait TooF extends FooT { override def foo[T,V](stuff:Bar[T]*) { super.foo(stuff) } } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T16:51:09.357

我不确定它显示的确切原因，`Bar[?]`但我认为可能还没有解决类型参数之类的问题。真正的问题是您将可变参数传递给 super 方法的语法不正确。它应该是

```
override def foo[T,V](stuff:Bar[T]*) { super.foo(stuff:_*) } 
```

# ios - removeGestureRecognizer 方法

> ID：10587642
> 
> 赞同：7
> 
> 时间：2012-05-14T16:47:27.750
> 
> 标签：ios, uigesturerecognizer

我创建了一个带有多个手势的 UIButton。有没有办法删除所有手势识别器？没有手势识别器对象？我看过这个方法：

```
[myButton removeGestureRecognizer:(GestureRecongizer)]; 
```

但是我不再有手势识别器对象了。有没有办法在没有识别器对象的情况下清除我的手势？类似于：

```
[myButton removeTarget:nil action:NULL forControlEvents:UIControlEventAllEvents]; 
```

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-05-14T16:49:57.307

这应该这样做

```
while (myButton.gestureRecognizers.count) {
    [myButton removeGestureRecognizer:[myButton.gestureRecognizers objectAtIndex:0]];
} 
```

# c# - 如何释放Bitmap，ReDraw Bitmap，并添加到PictureBox。不会泄漏资源或造成太多闪烁

> ID：10587643
> 
> 赞同：0
> 
> 时间：2012-05-14T16:47:28.850
> 
> 标签：c#, winforms, visual-studio-2008

我有一个像这样绘制位图的方法：

```
public void DrawGrid(){
GridBitMap = new Bitmap(x,y);
MyGraphic = Graphics.FromImage(GridBitMap);
MyGraphic.FillRectangle(BackGround, 0, 0, x, y);

//Then using loops I draw various lines like this

MyGraphic.DrawLine(Pen.Black,x,y,xx,yy);

//Then I add the Bitmap to a Picturebox 

PictureBox.Image = GridBitMap;
} 
```

我的问题是，每次调用该方法时。我使用越来越多的资源。如何在不引起太多闪烁的情况下释放位图和图形？并防止代码消耗越来越多的资源？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T16:55:57.133

首先，您可以存储位图，而不是为每个绘制调用构建一个新的。这应该会大大减少资源消耗。你应该只在它的大小改变时生成一个新的（我想就是 x 和 y 改变）。

另外，为什么不使用 ScoreGraphic.Clear 清空它？

而且，最重要的是，您为什么不直接从 ScorePictureBox.Paint 事件中绘制到 PaintEventArgs 给您的 Graphics 中呢？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T16:54:47.953

你应该试试这个

```
using (Bitmap GridBitMap = new Bitmap(x,y))
{
   using (Graphics ScoreGraphic = Graphics.FromImage(GridBitMap)
   {
     ...
   }
} 
```

如果您实际上不需要位图，为什么不直接在图片框中绘制呢？每次创建位图都非常耗费时间和资源。

希望这是你所要求的。using close 确保即使出现异常或过早退出函数，资源也会被释放。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-14T16:57:14.980

我认为这个应该解决它：

```
using(Bitmap bmp as new Bitmap(x,y))
{
  my code...
} //<--important marker.. 
```

当指令指针离开“重要标记”时，将发出对 bmp 的 IDisposable 的调用 - 释放资源。

# share - 《GRIDWALKING》采访街

> ID：10587644
> 
> 赞同：-1
> 
> 时间：2012-05-14T16:47:38.260
> 
> 标签：share

我最近在 interviewstreet 尝试了问题 GRIDWALKING。我尽我所能，但仍然无法做到正确。我的意思是，我得到了正确的逻辑（DP和帕斯卡）并解决了N = 1（他们提供的样本）。但是对于其他测试用例，我的解决方案失败了。我没有发现我的解决方案的输出错误。但我不能确定......所以，如果有人解决了它，您能否将您的输出粘贴到以下输入中。

```
1
4 4
5 5 5 5
9 9 9 9 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-08T18:23:04.427

4096 是我的解决方案在上面的输入中输出的内容

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T12:38:05.953

我的解决方案输出：

4096

提示：使用动态规划来解决这个问题。

# c# - 在cmd中发送多个TELNET命令

> ID：10587649
> 
> 赞同：0
> 
> 时间：2012-05-14T16:48:02.020
> 
> 标签：c#, cmd, telnet

```
class Program
{
    public static void ExecuteCommand(string Command)
    {
        ProcessStartInfo ProcessInfo;
        Process Process;

        ProcessInfo = new ProcessStartInfo("cmd.exe", "/C " + Command);
        ProcessInfo.CreateNoWindow = false;
        ProcessInfo.UseShellExecute = false;
        Process = Process.Start(ProcessInfo);
        Process.WaitForExit();

        Process.Close();

    }

    static void Main()
    {

        ExecuteCommand("telnet 169.254.0.1");

    }
} 
```

它运行 cmd 并通过 telnet 连接到特定设备。接下来，一旦连接，它会提示输入我也想发送的登录名和密码，然后是一些特定的命令。我应该怎么办？

非常感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T16:50:56.647

只需写入 StandardInput 流。

```
Process process = Process.Start("cmd");

if (process != null)
{
   process.StandardInput.WriteLine("dir");
   process.StandardInput.WriteLine("ping");
   process.StandardInput.WriteLine("something");
} 
```

# mongodb - 确保 mongodb 集合中文档中的字段具有相同类型

> ID：10587653
> 
> 赞同：0
> 
> 时间：2012-05-14T16:48:20.837
> 
> 标签：mongodb

我正在将 MySQL 中的数据库迁移到 MongoDB。但是，我遇到了一个问题，即 MongoDB 根据用于初始化它的字符串/整数数据的长度/值来更改文档类型。有没有办法防止这种情况？我希望集合中的类型相同。

我是这项技术的新手，如果我错过了什么，我深表歉意。我环顾四周，找不到解决办法。非常感谢任何指针。

谢谢，

阿莎

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T19:18:21.693

如果您使用 C++ 编写迁移应用程序，请查看“bson/bsonobjbuilder.h”中的 BSONObjBuilder 类。如果您使用 BSONObjBuilder 的“附加”方法创建您的个人 BSON 文档，构建器将使用字段的静态类型在输出对象中设置适当的 BSON 类型。

例如：

```
int count = /*something from a mysql query*/;
std::string name = /*something else from a mysql query*/;
BSONObjBuilder builder;
builder.append("count", count);
builder.append("name", name);
BSONObj result = builder.obj(); 
```

# jetty - jetty 如何处理多个请求

> ID：10587660
> 
> 赞同：34
> 
> 时间：2012-05-14T16:48:35.453
> 
> 标签：jetty

我已经使用 jetty/tomcat 应用服务器处理 Spring Web 应用程序大约两年了，但我仍然无法理解的是这些服务器中如何处理多个请求。我知道 spring 有助于制作单例，但我的理解仅限于此。有人可以指出任何可以帮助我了解如何处理多个请求的好资源。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-05-16T20:40:28.047

这可以在很多层面上回答我已经盯着它看了两天试图弄清楚如何回答它......所以我会采取一个高水平的镜头。

有一个码头监听的服务器端口和一些接受者线程，它们的工作是获取客户端和服务器端之间的连接对象。一旦你有了这个连接，它就会流经码头处理程序架构，可能会做一些事情，比如身份验证，或者提取一个会话 ID 并将一个会话对象附加到请求中。然后它进入 servlet 处理程序并找到适当的 servlet，然后您开始处理 servlet-api。那时，您在 servlet-api 中的所有时间都为您的请求分配了一个线程，至少在 servlet 2.5 下。在 servlet 3.0 中，您可以使用一些异步机制，或者您可以使用 jetty-continuations 作为在 servlet 2.5 api 上获得异步支持的一种方式。

无论如何，服务器使用一个线程池将线程分配给那些连接器，这些连接器最终是将所有时间都花在 servlet-api 中的线程。jetty continuations api 和更新的 servlet 3.0 支持提供了将线程释放回主线程池的机制，以便它们可以花时间接受和处理其他请求。

显然，在涉及 nio api 的使用以及码头如何有效管理所有这些东西的涵盖范围内还有很多事情要做，但这可能足以满足您最初的问题。如果没有，请随意阅读码头文档（[http://www.eclipse.org/jetty/documentation/current](http://www.eclipse.org/jetty/documentation/current)）或查看码头邮件列表。[在 Webtide ( http://webtide.com/blogs](http://webtide.com/blogs) )的博客中，已经有一些关于 jetty-9 优化的讨论，因为它与 http、spdy 和 websocket 连接处理和处理有关。

# google-analytics - 使用 URL 链接跟踪将附加参数传递给 Google Analytics

> ID：10587661
> 
> 赞同：1
> 
> 时间：2012-05-14T16:48:38.880
> 
> 标签：google-analytics

我正在 Google Analytics 中设置电子邮件营销跟踪，并希望传递一个额外的自定义参数来捕获电子邮件的主题。例如：[http ://www.google.com/?utm_source=targeted_email&utm_medium=email&utm_campaign=sale&subject=Sale](http://www.google.com/?utm_source=targeted_email&utm_medium=email&utm_campaign=sale&subject=Sale)

我宁愿不使用任何基本参数，因为它们都在 GA 中用于其他活动，这会严重影响我现有的分析。

这可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T22:10:08.280

GA 具有可用于报告值的自定义变量，是的。但是“基本参数”是什么意思？就“基本参数”而言，这就是您所说的，还是您指的是其他 utm_xxx 变量？如果您不想使用自定义变量，那么不，真的别无选择。

但是[自定义变量](https://developers.google.com/analytics/devguides/collection/gajs/gaTrackingCustomVariables)相当健壮..也许这是对它们进行正确分类的问题？

# php - 带有 javascript 操作的列表框不发布值

> ID：10587664
> 
> 赞同：1
> 
> 时间：2012-05-14T16:48:43.190
> 
> 标签：php, javascript

我有以下表格：

```
<form name='progObj_form' method='POST' enctype='multipart/form-data' action='processpage.php'>
<select name='manageObj[]' id='objectives'  multiple="multiple">
<option value=0>there are no objectives for this program</option>
</select><br />
<a href='#nogo' onclick="delItem(objectives,0,'objEditBtn')" class='shiftOpt'>delete selected</a><br />
<input name='newObjective' type='text' id='newObjective'/>
<input name='addNew' type='button' onclick="AddItem(newObjective.value,6,'objectives','objEditBtn');" value='add objective'/>
<input name="passProgID" type="hidden" value="1" /><br />
<input name="objectiveEdit" id="objEditBtn" type="submit" value="save changes" disabled=disabled/>
</form> 
```

允许从列表框中添加和删除数据（在这种情况下为目标）。这一切都很好，但由于某种原因，更新的列表框值没有被传递到进程页面。

我正在捕获这样的数据（简化）：

```
if (isset($_POST['objectiveEdit'])){
$progID=$_POST['passProgID'];
 for ($v=1;$v<count($_POST['manageObj']);$v++){
   $value=$_POST['manageObj'][$v];
   $sqlObj="INSERT INTO progObjective (progID,objective,objectiveOrder) VALUES ($progID,$value,$v)";
   $result = mssql_query($sqlObj,$linkProbation) or die('Query failed: '.$sqlObj);  
 }//end for ($a=0;$a<count($_POST['manageObj']);$a++)   
$objMsg=print_r($_POST['manageObj']).$sqlObj;       
}//end if (isset($_POST['objectiveEdit']) 
```

对于`$objMsg`，我得到响应`1`并且数组没有打印，因为从表面上看，它是空的，这意味着它也没有进入 for 循环。

我也可以包含 javascript，但为了简单起见就从这个开始，因为我可能只是忽略了一些明显的东西？！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T16:53:51.377

选项元素永远不会发送到服务器。只会`value`发送所选选项的。

在您的情况下，类似的东西`manageObj=x`将被发送到服务器，用户选择`x`的元素`value`在哪里。`option`您可能误解了`[]`它在`name`属性中的使用时间。

如果要将用户创建的目标发送到服务器，则应尝试寻找不同的方法。例如，您可以将数据存储在 hidden`input`中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T14:51:28.317

所以我终于想通了！没有数组，因为没有做出选择！我更新了提交按钮以调用 SELECT ALL 函数，现在一切正常。

```
 <input name="objectiveEdit" id="objEditBtn" type="submit" value="save changes" onclick="selectAll('objectives',true)" /> 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-05-14T16:53:33.577

name=' **manageObj[]** ' - 那不应该是 name=' **manageObj** ' 吗？

# wpf - 带有两个数据网格的 WPF y MVVM，如何根据条件更改其中一个行中某些行的颜色？

> ID：10587667
> 
> 赞同：0
> 
> 时间：2012-05-14T16:48:53.813
> 
> 标签：wpf, mvvm, datagrid

我有两个数据网格的视图。对于这个问题，我使用了两个dataGrid，一个带有作者信息，另一个带有歌曲信息。第一个数据网格绑定实体作者的 observableCollection，第二个数据网格绑定实体歌曲的 observableCollection。

在这两种情况下，我都有文本框，可用于按某些条件搜索作者，而其他文本框可用于搜索歌曲。

我希望如果我在作者数据网格中只选择了一行，当我搜索歌曲时，我希望作者的歌曲有不同的背景，例如绿色。

一个例子。我选择了作者 Elvis Presley 并搜索摇滚歌曲。我得到了很多猫王没有的歌曲。所以在歌曲的数据网格中我有所有的摇滚歌曲，如果歌曲是猫王的，那么行的背景必须有不同的颜色。

其他情况，如果我先搜索歌曲，然后再搜索作者，如果我在dataGrid中只选择一个作者，如果属于这个作者，歌曲的背景就会改变。如果我选择了两个或更多作者，或者我选择了没有人，则清除歌曲数据网格中的背景。

谢谢。戴姆洛克。

# c++ - cstring -> c++ string conversion

> ID：10587669
> 
> 赞同：0
> 
> 时间：2012-05-14T16:49:00.353
> 
> 标签：c++, string, performance

If I have a function

```
void x(std::string const& s)
{
   ...
} 
```

And I am calling it as x("abc"), will string constructor allocate memory and copy data in it?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-14T17:00:01.030

The std::string constructor will be called with a `const char*` argument

There is no telling whether memory would be allocated (dynamically), but the chances are that your standard library implementation has the SSO in place, which means it can store small strings without dynamic allocations.

### SSO: [Meaning of acronym SSO in the context of std::string](https://stackoverflow.com/questions/10315041/meaning-of-acronym-sso-in-the-context-of-stdstring/10319672#10319672)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-14T16:58:15.163

The question is tagged with 'performance', so it's actually a good question IMO.

All compilers I know *will* allocate a copy of the string on the heap. However, some implementation could make the `std::string` type intrinsic into the compiler and optimize the heap allocation when an r-value `std::string` is constructed from a string literal.

E.g., this is not the case here, but MSVC is capable of replacing heap allocations with static objects when they are done as part of dynamic initialization of statics, at least in some circumstances.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-14T16:50:29.457

Yes, the compiler will generate the necessary code to create a `std::string` and pass it as argument to the `x` function.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-14T16:54:21.793

Constructors which take a single argument, unless marked with the `explicit` keyword, are used to implicitly convert from the argument type to an instance of the object.

In this example, `std::string` has a constructor which takes a `const char*` argument, so the compiler uses this to implicitly convert your string literal into a `std::string` object. The const reference of that newly created object is then passed to your function.

Here's more information: [What does the explicit keyword mean in C++?](https://stackoverflow.com/questions/121162/what-does-the-explicit-keyword-in-c-mean)

# eclipse - adding python interpreters programmatically

> ID：10587681
> 
> 赞同：2
> 
> 时间：2012-05-14T16:49:48.153
> 
> 标签：eclipse, pydev

Is there a simple way to add and change interpreters using the Pydev plugin interface? I'm running pydev 1.6.1 and I'd like to be able to add and use a given interpreter based on a list of available interpreters in my environment.

Right now I can see the PythonInterpreterManager has a createInterpreterInfo call, but that doesn't seem to do anything. Looking at the source for pydev, it seems like I have to actually work with the preference pages to keep track of all of them.

Is there a simpler set of functions I can call to add these?

```
PythonInterpreterManager manager = (PythonInterpreterManager)PydevPlugin.getPythonInterpreterManager(true);
IInterpreterInfo info = manager.createInterpreterInfo(execPath, new NullProgressMonitor());
        manager.addInterpreterInfo(info); 
```

I can already do the above, but that only caches it, but doesn't display it as a valid interpreter option in the preferences.

I've even tried doing reflection to add these without much luck. I can call addNewInput on the editor as the Add button does, but then it says it doesn't have any knowledge of that interpreter. I've tried creating a popup preferences page and adding the values to the various members via reflection as getNewInput() would, but still don't see any more options in the preference page. I'm not sure if this is because I'm missing something or the popup preference page I make is totally unrelated to the page that pops up using the Window->"Preferences" pulldown.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-17T22:10:58.850

The API is something as:

```
 IInterpreterManager iMan = PydevPlugin.getPythonInterpreterManager(true);
    IInterpreterInfo interpreterInfo = iMan.createInterpreterInfo("c:/python/python.exe", monitor, false);
    iMan.setInfos(new IInterpreterInfo[]{interpreterInfo}, null, null); 
```

Note that if you have 'manager.addInterpreterInfo' in there, you probably have an old version of PyDev... (and at that call you set all the interpreters available, so, if you want to keep some configuration, you should query it and add them back).

You can use: org.python.pydev.editor.codecompletion.revisited.javaintegration.AbstractWorkbenchTestCase.createPythonInterpreterManager(NullProgressMonitor) as a reference.

# image - Reporting Services 动态图像源 URL 问题

> ID：10587684
> 
> 赞同：1
> 
> 时间：2012-05-14T16:49:59.243
> 
> 标签：image, reporting-services, ssrs-2008

我在 SQL Reporting Services 2008 R2 中有一个报告，其中包含一个图像，其来源由表达式给出。图像不会渲染。这份报告是从一台 2005 年的机器上移过来的，它工作得很好。

图片来源设置为：

="http://example.com/SiteMap/Directory/EmployeePhotos/" + rtrim(Fields!employee_id.Value) + ".jpg"

在实际报告中应该呈现给这个来源：

[http://example.com/SiteMap/Directory/EmployeePhotos/275.jpg](http://example.com/SiteMap/Directory/EmployeePhotos/275.jpg)

相反，我只是得到一个空的图像间隔；当我查看 IE 中的属性时，我得到一堆“不可用”值。

我在报告中使用上面的确切表达式设置了一行，它给出了预期值。

同样，图像在 2005 年的盒子上工作得很好，在 VS 2010 中渲染时看起来也很好。有什么想法吗？一如既往地感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T17:54:48.517

报告服务器抓取图像，而不是浏览器。这意味着服务帐户，而不仅仅是用户，必须有权访问外部资源。

好消息是您无需更改运行 SSRS 的实际帐户。报告服务允许您分配一个执行帐户，SSRS 将使用该帐户获取外部资源。设置一个可以访问资源的帐户，然后将该帐户设置为 SSRS 配置管理器中的执行帐户。简单的。

# policy - PolicyMon - 如何确定我的应用程序使用的策略？

> ID：10587686
> 
> 赞同：1
> 
> 时间：2012-05-14T16:50:05.717
> 
> 标签：policy

我们（公司）在过去几年中编写了一个相当大的软件应用程序，并且我们刚刚开始在非管理员（受限）帐户下运行它 - 当我们这样做时，我们意识到有某些操作系统（Windows XP）我们需要的水平政策。我的任务是预先确定这些政策。

我一直在寻找并且无法找到任何类型的“策略监控”软件（如 regmon 和 filemon），因此我正在寻找自己的软件，我可以在对应用程序执行操作时在后台运行该软件。目标是找出我“击中”了哪些“策略”并将它们识别为我需要设置的那些（这部分很简单 - 以编程方式设置策略）。

有谁知道是否有一些 API 或者我可以用来连接到 WindowsXP 的策略部分来设置某种监视器（或其他建议？

# google-chrome-extension - 打开 Chrome 的特定事件

> ID：10587689
> 
> 赞同：1
> 
> 时间：2012-05-14T16:50:14.830
> 
> 标签：google-chrome-extension

我正在尝试复制 FireFox 延迟选项卡加载“选项>常规>“在选择之前不加载选项卡”的偏好作为 Chrome 中的扩展。

基本上，我试图使用 WebRequest (http://code.google.com/chrome/extensions/webRequest.html) 但我遇到了两个问题：

1）我需要挂钩一个事件来阻止所有打开标签的请求。目前，似乎只有选定的标签被阻止，而其他标签在 Chrome.app 打开时加载。

2) 在初始阻止选项卡后取消注册我的 webRequest onBeforeRequest 事件。这只是在初始应用程序加载发生时我需要的行为。

我已经了解如何重新加载焦点标签。

# mysql - 无论存储的实际年份如何，都将 MySQL 中的日期视为过去 12 个月

> ID：10587690
> 
> 赞同：1
> 
> 时间：2012-05-14T16:50:27.027
> 
> 标签：mysql

我想运行一个`SELECT`查询`table`，获取存储在`year_end`字段中的日期并自动将其视为过去 12 个月中出现的日期。

即：今天是 5 月 14 日，所以：

如果我有`2012-01-01`，那么我希望保持不变

如果我有`2010-05-05`那么我想要`2012-05-05`

如果我有`2012-10-10`那么我想要`2011-10-10`

请对`SELECT`我需要的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T17:46:34.410

这是您需要的：

```
select
concat(yr,'-',if(leapyear=0,if(right(dt,5)='02-29','03-01',
right(@mydate,5)),right(@mydate,5))) dttm
from
(
    select concat(if(my_md > md,yr -1,yr),'-',my_md) dt,yr,my_md,
    IF(MOD(yr,4)>0,0,IF(MOD(yr,100),1,(MOD(yr,400)=0))) leapyear FROM
    (select substr(date(@mydate),6) my_md) AA,
    (select substr(date(now()),6) md,year(now()) yr) BB
) A; 
```

以下是您选择的三个日期作为示例 + 2 个闰年日期

```
set @mydate = '2012-01-01';
set @mydate = '2010-05-05';
set @mydate = '2012-10-10';
set @mydate = '2008-02-29';
set @mydate = '2012-02-29'; 
```

在这里他们被执行

mysql> 设置@mydate = '2012-01-01'; 查询正常，0 行受影响（0.00 秒）

```
mysql> select
    -> concat(yr,'-',if(leapyear=0,if(right(dt,5)='02-29','03-01',right(@mydate,5)),right(@mydate,5))) dttm
    -> from
    -> (
    ->     select concat(if(my_md > md,yr -1,yr),'-',my_md) dt,yr,my_md,
    ->     IF(MOD(yr,4)>0,0,IF(MOD(yr,100),1,(MOD(yr,400)=0))) leapyear FROM
    ->     (select substr(date(@mydate),6) my_md) AA,
    ->     (select substr(date(now()),6) md,year(now()) yr) BB
    -> ) A;
+------------+
| dttm       |
+------------+
| 2012-01-01 |
+------------+
1 row in set (0.00 sec)

mysql> set @mydate = '2010-05-05';
Query OK, 0 rows affected (0.00 sec)

mysql> select
    -> concat(yr,'-',if(leapyear=0,if(right(dt,5)='02-29','03-01',right(@mydate,5)),right(@mydate,5))) dttm
    -> from
    -> (
    ->     select concat(if(my_md > md,yr -1,yr),'-',my_md) dt,yr,my_md,
    ->     IF(MOD(yr,4)>0,0,IF(MOD(yr,100),1,(MOD(yr,400)=0))) leapyear FROM
    ->     (select substr(date(@mydate),6) my_md) AA,
    ->     (select substr(date(now()),6) md,year(now()) yr) BB
    -> ) A;
+------------+
| dttm       |
+------------+
| 2012-05-05 |
+------------+
1 row in set (0.00 sec)

mysql> set @mydate = '2012-10-10';
Query OK, 0 rows affected (0.00 sec)

mysql> select
    -> concat(yr,'-',if(leapyear=0,if(right(dt,5)='02-29','03-01',right(@mydate,5)),right(@mydate,5))) dttm
    -> from
    -> (
    ->     select concat(if(my_md > md,yr -1,yr),'-',my_md) dt,yr,my_md,
    ->     IF(MOD(yr,4)>0,0,IF(MOD(yr,100),1,(MOD(yr,400)=0))) leapyear FROM
    ->     (select substr(date(@mydate),6) my_md) AA,
    ->     (select substr(date(now()),6) md,year(now()) yr) BB
    -> ) A;
+------------+
| dttm       |
+------------+
| 2012-10-10 |
+------------+
1 row in set (0.00 sec)

mysql> set @mydate = '2008-02-29';
Query OK, 0 rows affected (0.00 sec)

mysql> select
    -> concat(yr,'-',if(leapyear=0,if(right(dt,5)='02-29','03-01',right(@mydate,5)),right(@mydate,5))) dttm
    -> from
    -> (
    ->     select concat(if(my_md > md,yr -1,yr),'-',my_md) dt,yr,my_md,
    ->     IF(MOD(yr,4)>0,0,IF(MOD(yr,100),1,(MOD(yr,400)=0))) leapyear FROM
    ->     (select substr(date(@mydate),6) my_md) AA,
    ->     (select substr(date(now()),6) md,year(now()) yr) BB
    -> ) A;
+------------+
| dttm       |
+------------+
| 2012-02-29 |
+------------+
1 row in set (0.00 sec)

mysql> set @mydate = '2012-02-29';
Query OK, 0 rows affected (0.00 sec)

mysql> select
    -> concat(yr,'-',if(leapyear=0,if(right(dt,5)='02-29','03-01',right(@mydate,5)),right(@mydate,5))) dttm
    -> from
    -> (
    ->     select concat(if(my_md > md,yr -1,yr),'-',my_md) dt,yr,my_md,
    ->     IF(MOD(yr,4)>0,0,IF(MOD(yr,100),1,(MOD(yr,400)=0))) leapyear FROM
    ->     (select substr(date(@mydate),6) my_md) AA,
    ->     (select substr(date(now()),6) md,year(now()) yr) BB
    -> ) A;
+------------+
| dttm       |
+------------+
| 2012-02-29 |
+------------+
1 row in set (0.00 sec)

mysql> 
```

试试看 ！！！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T18:20:16.563

关于性能的查询可能效率低下，但它有效：

```
SELECT 
    dateX + INTERVAL ( YEAR(CURDATE())
                     - YEAR(dateX) 
                     - ( ( MONTH(dateX), DAY(dateX) ) 
                       > ( MONTH(CURDATE()), DAY(CURDATE()) )
                       )
                     ) YEAR 
      AS calc_date
FROM 
    tableX ; 
```

你可以测试它[SQL-Fiddle](http://sqlfiddle.com/#!2/92a0b/1)。另一个版本，更具可读性：

```
SELECT 
    d + INTERVAL ( now.yy - t.yy - ((t.mm, t.dd) > (now.mm, now.dd))
                 ) YEAR 
      AS calc_date
FROM
    ( SELECT 
          dateX        AS d 
        , YEAR(dateX)  AS yy
        , MONTH(dateX) AS mm
        , DAY(dateX)   AS dd           
      FROM tableX
    ) AS t
  CROSS JOIN
    ( SELECT 
          YEAR(CURDATE())  AS yy
        , MONTH(CURDATE()) AS mm
        , DAY(CURDATE())   AS dd            
    ) AS now ; 
```

# sql - Oracle - 无法在现有表上创建新的 FK

> ID：10587694
> 
> 赞同：1
> 
> 时间：2012-05-14T16:50:30.207
> 
> 标签：sql, oracle, foreign-keys, oracle11g

我确信我*一定*是在做一些非常愚蠢的事情，因为向现有表添加新的外键并不难。但是，我仍然卡住了。这就是我正在做的事情。

首先，我创建了一个新列`TPM_USER`来存储用户所在的团队：

```
ALTER TABLE TPM_USER ADD (
  "TEAMID" NUMBER NULL
) 
```

这可以正常工作，并且我可以查询`TPM_USER`表以查看已添加的新列。接下来，我希望 TEAMID 引用已经存在的`TPM_DEVELOPMENTTEAMS`表中的一行。所以我这样做：

```
ALTER TABLE TPM_USER
    ADD CONSTRAINT TPM_USER_FK1
    FOREIGN KEY(TEAMID)
    REFERENCES TPM_DEVELOPMENTTEAMS(TEAMID) 
```

这给了我错误：

> ORA-02270: 此列列表没有匹配的唯一键或主键

我检查了两`TEAMID`列的数据类型相同（NUMBER），并且 TEAMID 当然是`DEVELOPMENTTEAMS`表的主键。实际上，这是 的架构`DEVELOPMENTTEAMS`：

```
CREATE TABLE TPMDBO.TPM_DEVELOPMENTTEAMS  ( 
    TEAMID      NUMBER NULL,
    NAME        VARCHAR2(100) NOT NULL,
    ISACTIVE    CHAR(1) NULL,
    SORTORDER   NUMBER NULL,
    SHORTNAME   VARCHAR2(100) NULL,
    GROUPID     NUMBER NOT NULL,
    CONSTRAINT TPM_DEVELOPMENTTEAMS_PK PRIMARY KEY(TEAMID)
    NOT DEFERRABLE
     DISABLE NOVALIDATE
) 
```

我什至尝试了 Aqua Data Studio 中的 GUI 界面来添加新的约束，所以我确信我没有拼错任何东西。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-14T17:12:49.253

您的 PK 已禁用。启用它：

```
ALTER TABLE TPM_DEVELOPMENTTEAMS ENABLE CONSTRAINT TPM_DEVELOPMENTTEAMS_PK; 
```

顺便说一句，通过将其声明为 PK，您还使`TPM_DEVELOPMENTTEAMS.TEAMID`非 NULL （因此在它之后没有 NULL 的目的）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-11-10T09:25:50.210

您只能引用为同一/其他表启用主键或唯一键的列（或列组合）。

如果您在下面的查询中发现您的约束被禁用，那么您无法为该 PK/UK 创建外键。你应该启用它。

```
select constraint_name from dba_constraints
   where constraint_type in ('P','U')
   and status = 'DISABLED'
   and lower(table_name) = lower(:p_table_name); 
```

# c# - 带有句点的 UriTemplate 在 MVC 应用程序中返回 404

> ID：10587698
> 
> 赞同：0
> 
> 时间：2012-05-14T16:50:39.367
> 
> 标签：c#, asp.net, wcf, asp.net-mvc-3

我在 MVC3 Web 应用程序中托管 WCF 服务。我有一个带有 UriTemplate 的 WebGet 属性的方法设置。当 UriTemplate 包含句点时，我从 Web 服务器收到 404 响应。

```
 [OperationContract, WebGet(UriTemplate = "DoSomething")]
    Stream DoWork();

http://localhost/Services/Service1.svc/DoSomething  - Works Correctly

    [OperationContract, WebGet(UriTemplate = "dummyfile.xml")]
    Stream DoWork();

http://localhost/Services/Service1.svc/dummyfile.xml - Returns a 404 error 
```

我猜它与路线有关，但我不确定。我现在设置的路线是：

```
 routes.IgnoreRoute("{resource}.axd/{*pathInfo}");
    routes.IgnoreRoute("{resource}.svc/{*pathInfo}");

    routes.MapRoute( "Default", "{controller}/{action}/{id}",  new { controller = "Home", action = "Index", id = UrlParameter.Optional }); 
```

谁能提供一些关于如何使用带有句点的 URITemplate 在 MVC3 应用程序中托管 WCF 服务的见解？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-17T19:09:58.873

冒着抄袭的风险：）菲尔·哈克（ **Phil Haack** [）有答案](http://haacked.com/archive/2010/04/29/allowing-reserved-filenames-in-URLs.aspx)

# asp.net - 在 ASP.NET 中调用和读取 Session 对象需要多少资源？

> ID：10587703
> 
> 赞同：2
> 
> 时间：2012-05-14T16:51:07.617
> 
> 标签：asp.net, performance, optimization

我想知道像这样调用 Session 对象有多浪费（示例）：

```
string test = string.Empty;
for (int i = 0; i < 1000; i++)
{
   test += Session["test"].ToString() + ",";
} 
```

而不是像这些：

```
string test = string.Empty;
string test_session_value = Session["test"].ToString();
for (int i = 0; i < 1000; i++)
{
   test += test_session_value + ",";
} 
```

（即`HttpSessionState`多次调用对象并从中读取会话，而不是尽可能少的次数）

是否有任何性能损失（明显）？`HttpSessionState`开发人员在使用对象时应该注意多少？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T17:15:02.210

页面加载时会话是完全阅读器，并在页面卸载时保存。所以序列化和反序列化每页只发生一次！

会话保存/保留`Dictionary<string,object>`对象中的数据。

所以当你做了这个

```
string test = string.Empty;
for (int i = 0; i < 1000; i++)
{
   test += Session["test"].ToString() + ",";
} 
```

实际上，当您在他的列表中找到一个项目时，会话调用的字典速度非常快，因为它使用了索引。

现在我必须在这段代码中注意的是，您使用真正昂贵的行的字符串会出错。要真正快速，您必须使用`StringBuilder`，但可以说这不是真正的代码，而只是您展示它的方式。

```
StringBuilder test = new StringBuilder();
for (int i = 0; i < 1000; i++)
{
   test.Append(Session["test"].ToString());
   test.Append(',');
} 
```

> 是否有任何性能损失？

在现实生活中，我认为您不会每页调用 1000 次会话变量，因此 Session 不会有明显的延迟。值得注意的是会话锁定所有用户，直到页面加载和卸载。

相对：[完全替换 ASP.Net 的会话](https://stackoverflow.com/questions/8989648/replacing-asp-nets-session-entirely)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T16:58:05.117

如果会话状态存储在 IIS 中，那么它将创建庞大的 IIS。

如果会话状态存储在 Sql server 中，那么不同应用程序域之间的数据传输将耗费时间。

优点： 1.可以跨机器访问相同的会话状态。
2\. 重新加载app_pool后会话状态相同。

缺点： 1\. 比进程模式慢。
2\. 会话状态中的所有对象都必须是可序列化的。
3\. 由于 Session 变量可以动态创建、随时使用，并且不需要开发人员明确地处理它们，因此过度使用 Session 变量会导致代码非常不可读和不可维护。

# java - Java Sockets：服务器和客户端在同一台机器上的应用程序

> ID：10587705
> 
> 赞同：1
> 
> 时间：2012-05-14T16:51:20.227
> 
> 标签：java, sockets

我正在开发一个应用程序来使用Java 中`Socket`的类发送、接收或更新文件。 有一个应用程序既是服务器又是客户端。我需要获取在同一局域网上运行的所有其他应用程序的 IP 地址。 如何才能做到这一点？`ServerSocket`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T16:54:24.540

您应该为此使用广播。

有关更多详细信息，请查看此处：[http ://docs.oracle.com/javase/tutorial/networking/datagrams/broadcasting.html](http://docs.oracle.com/javase/tutorial/networking/datagrams/broadcasting.html)

# html - 在 HTML 代码中，还有什么可以代替 < 或 >？

> ID：10587708
> 
> 赞同：0
> 
> 时间：2012-05-14T16:51:25.887
> 
> 标签：html

当我们进行任何 HTML 编码时，我们使用`<`并`>`指定一个标签，任何浏览器都不会显示为文本而是显示。可以使用其他任何东西（任何编码，用于 HTML）来代替这些符号吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T17:51:28.373

我想你是在问是否可以使用除`<`和之外的字符`>`作为标签开始和标签结束字符。例如，是否可以以某种方式定义它`[`并`]`使用它来代替，这样我们就可以写`[p]`而不是`<p>`.

答案是不。HTML 正式基于 SGML，其中有此类定义的规定；在 SGML 中，`<`只是`>`抽象“标签开始”和“标签结束”符号的“参考具体语法”字符。但 HTML 从未真正实现为基于 SGML，HTML 规范甚至正式固定了语法以使用`<`和`>`. 并且 XHTML 所基于的 SGML 的简化版本 XML 没有设置此类语法特征的规定。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-14T16:55:56.910

实际上：不。仅在 HTML`<`中`>`标记标签的开始和结束。

仅在理论上（因为**任何主流浏览器都不支持**），在 HTML 4 和更早版本中，您可以使用 SHORT TAGS。其语法是使用`/`而不是`>`结束开始标记，然后`/`代替整个结束标记：

例如：

```
<title/This is the title/ 
```

或者

```
<br/ <!-- note that the end tag for br elements must be omitted in HTML 4 and earlier --> 
```

其他一些 SGML 功能可能允许其他选项，但浏览器也不支持它们。

* * *

**以下是我对有人将其编辑为显示`&lt;`而不是`<`**.

理论上，对于 HTML 4 及更早版本，您可以使用[CDATA 部分](http://www.w3.org/TR/html4/appendix/notes.html#h-B.3.5)……但它们从未在浏览器中得到广泛支持，因此在 HTML 中没有任何实际价值。

还有`<xmp>`元素，它已经过时了。HTML 5 草案将其标记为[不合格](http://www.w3.org/TR/html5/obsolete.html#non-conforming-features)并说：

> 改用 pre 和 code，并将“ `<`”和“ `&`”字符分别转义为“ `&lt;`”和“ `&amp;`”

W3C Wiki[对 xmp 有这样的说法](http://www.w3.org/wiki/HTML/Elements/xmp)：

> 不完全是。不要使用它。

字符引用（`&lt;`和 co）是这项工作的正确工具。学习喜欢编程解决方案或编辑器的查找和替换功能可以更好地取代任何避免它们的愿望。

# asp.net-mvc - 发布到控制器无法正常工作

> ID：10587711
> 
> 赞同：0
> 
> 时间：2012-05-14T16:51:40.363
> 
> 标签：asp.net-mvc, asp.net-mvc-4, model-binding

我有一个带有嵌套类的实体模型。FSRHire 是父级，Employee 是子级：

```
class FSRHire {
    ...
    public virtual Employee Employee
    ...
}
class Employee {
    ...
    public string LastName {get;set;}
    public DateTime DOB {get;set;}
    ...
} 
```

看法：

```
<div class="editor-label">
    @Html.LabelFor(model => model.Employee.LastName)
</div>
<div class="editor-field">
    @Html.EditorFor(model => model.Employee.LastName)
    @Html.ValidationMessageFor(model => model.Employee.LastName)
</div>
<div class="editor-label">
    @Html.LabelFor(model => model.Employee.DOB)
</div>
<div class="editor-field">
    @Html.TextBox(Html.IdFor(model => model.Employee.DOB).ToString(), Model.Employee.DOB.HasValue ? Model.Employee.DOB.Value.ToString("d") : "", new { @class = "date" })
    @Html.ValidationMessageFor(model => model.Employee.DOB)
</div> 
```

进入控制器的帖子不起作用。以下是请求中的数据：

...Employee.LastName=工人&Employee_DOB=01%2F01%2F1970& ...

模型活页夹很好地取了这个名字。Employee.DOB 为空。

这*可能*是由 DOB 字段中的下划线引起的。(Employee_DOB)。我想知道为什么会这样以及如何解决它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T16:53:38.520

它应该是这种格式：

```
...Employee.LastName=Worker&Employee.DOB=01%2F01%2F1970& ... 
```

更改自：

```
Employee_DOB=01%2F01%2F1970&
//      ^ 
```

到

```
Employee.DOB=01%2F01%2F1970&
//      ^ 
```

关于视图：

```
@Html.TextBox(Html.IdFor(model => model.Employee.DOB).ToString(), Model.Employee.DOB.HasValue ? Model.Employee.DOB.Value.ToString("d") : "", new { @class = "date" }) 
```

Web.Mvc dll中没有`IdFor`方法，您可能自己编写或使用了某个库，无论如何它无法正常工作。

将视图中的行更改为如下所示：

```
 @Html.TextBoxFor(model => model.Employee.DOB, Model.Employee.DOB.HasValue ? Model.Employee.DOB.Value.ToString("d") : "", new { @class = "date" }) 
```

# swing - 用于纯 Windows 桌面应用程序的 JavaFX 2 与 Swing

> ID：10587713
> 
> 赞同：27
> 
> 时间：2012-05-14T16:51:49.147
> 
> 标签：swing, javafx, javafx-2

我需要编写一个桌面应用程序，而且自从我开始使用 Swing 以来已经有一段时间了，所以这两种技术都有一个学习曲线。

使用 JavaFX 2 做我的应用程序有什么优势吗？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-05-14T19:32:44.363

4 年前，我有同样的问题，并得出结论认为我最好使用 Swing，因为当时许多第三方库仍然是为 Swing 编写的。此外，来自 Sun 的 1.0 版本通常有点粗糙（我在 JSF 1.0 和 JPA 1.0 上烧毁了自己:-)。

如今，许多库都有 JavaFX 对应物或可用作 JavaFX 库。也就是说，还有很多图书馆仍然是 Swing 独有的。我还用 JavaFX 2.0 做了一些小事情，看起来真的很完整。我还没有碰到任何表演障碍。

您需要检查除了 Swing / JavaFX（以及哪个）之外，您将使用多少个外部 UI 库。如果答案不是很多或很多有 Java FX 替代品（或者自己做起来很简单），我肯定会选择 JavaFX。此外，您仍然可以在 JavaFX 中使用 Swing 组件。

如前所述，JavaFX 将在未来弃用 Swing，而 Oracle 似乎致力于 JavaFX（它也将是开源的）。所以我强烈推荐JavaFX。

**2014 年 4 月 13 日状态更新：**

*   JavaFX 已经开源了一段时间：[https ://wiki.openjdk.java.net/display/OpenJFX/Main](https://wiki.openjdk.java.net/display/OpenJFX/Main)
*   社区致力于 JavaFX；JavaFX 的库开始出现，没有 Swing 对应的库。
*   Oracle 已被证明致力于 JavaFX。

万一您在 2 年前不相信：JavaFX 现在看起来肯定是要走的路。尽管 Swing 可能会存在很长时间，但它目前处于维护模式。将大型应用程序（如 IntellIJ 或 Netbeans）完全移植到 JavaFX 需要付出很多努力。对于那些大型应用程序，目前可能不值得如此大规模的端口。

**2021 年 9 月 15 日状态更新：**

*   JavaFX 社区仍然很强大。[OpenJFX](https://openjfx.io/)仍然存在并且有一个更华丽的家。
*   像[Gluon](https://gluonhq.com/)这样的公司（我不隶属于他们）为 OpenJFX 提供商业支持 LTS 版本。
*   GraalVM 支持 JavaFX，允许您制作 JavaFX 应用程序并将它们作为本机二进制文件分发（即不需要 JVM）。
*   有优秀的开源 JavaFX 组件库可用，例如[TilesFX](https://github.com/HanSolo/tilesfx)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-05T05:20:00.820

两者都是不错的选择：

*   如果您想要一个**丰富的、图形增强的应用程序**，JavaFX 2.0 的特性可能非常吸引人。它旨在为您提供对用户体验和视觉效果的大量创造性控制。只要确保它在您的目标平台上受支持....
*   如果您想要一个在尽可能多的平台上运行的**标准桌面应用程序，那么 Swing 可能是一个更安全的选择（因为 Swing 保证可以作为所有现代 Java 发行版的一部分使用）。**它还具有更成熟的 3rd 方库的优势。

两者都不太可能取代另一个：它们的目标用途略有不同，并且可能会在未来很多年共存。

# c# - 多色文本框 C#

> ID：10587715
> 
> 赞同：19
> 
> 时间：2012-05-14T16:51:59.213
> 
> 标签：c#, winforms, textbox

我想在文本框中以 2 种颜色显示文本，例如 1 行红色 2 蓝色，如果我使用`name.ForeColor = Color.Red;`所有文本更改颜色，但我希望只更改 1 行颜色。

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2012-05-14T16:54:57.347

为此使用 RichTextBox，这是 Nathan Baulch 的扩展方法

```
public static class RichTextBoxExtensions
{
    public static void AppendText(this RichTextBox box, string text, Color color)
    {
        box.SelectionStart = box.TextLength;
        box.SelectionLength = 0;

        box.SelectionColor = color;
        box.AppendText(text);
        box.SelectionColor = box.ForeColor;
    }
} 
```

[在这里](https://stackoverflow.com/questions/1926264/color-different-parts-of-a-richtextbox-string)阅读更多

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2012-05-14T16:54:57.443

您需要使用[RichTextBox](http://msdn.microsoft.com/en-us/library/system.windows.forms.richtextbox.aspx)。

然后，您可以通过选择文本并更改选择颜色或字体来更改文本颜色。

```
richTextBox1.SelectionFont = new Font("Verdana", 12, FontStyle.Bold);
richTextBox1.SelectionColor = Color.Red; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-08-16T14:54:17.120

这是一个带有 Fontdialog 和 Colordialog 的示例。

```
void TextfarbeToolStripMenuItemClick(object sender, EventArgs e)
        {
            colorDialog1.ShowDialog();
            richTextBox1.ForeColor = colorDialog1.Color;
            listBox1.ForeColor = colorDialog1.Color;
        }

        void FontsToolStripMenuItemClick(object sender, EventArgs e)
        {
            fontDialog1.ShowDialog();
            richTextBox1.Font = fontDialog1.Font;
            listBox1.Font = fontDialog1.Font;
        }

        void HintergrundfarbeToolStripMenuItemClick(object sender, EventArgs e)
        {
            colorDialog1.ShowDialog();
            richTextBox1.BackColor = colorDialog1.Color;
            listBox1.BackColor = colorDialog1.Color;
        } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-14T16:55:26.097

首先，您提供的详细信息 + 标签是不够的 - C# 没有一个特定的 UI 框架，它有几个：WPF、Winforms、ASP.NET、Silverlight。

其次，您不能使用上述任何内容中的常规文本框控件来执行此操作。您将需要找到/创建具有不同行为的自定义 UI 控件或使用更高级的控件，例如富文本框。

# ios - mapkit 中 NSMutableArray 的多个注释

> ID：10587724
> 
> 赞同：2
> 
> 时间：2012-05-14T16:52:25.883
> 
> 标签：ios, ipad, mkannotation, cllocation, mapkit

我有一个从 ios 中的 sqlite db 填充的 mutablearray。我已经获得了正确加载和查看的注释。我的问题是如何编写一个循环来添加数组大小的注释。我尝试了以下代码并获取并显示数组中的最后一个条目

```
NSMutableArray *annotations=[[NSMutableArray alloc] init];
CLLocationCoordinate2D theCoordinate5;
MyAnnotation* myAnnotation5=[[MyAnnotation alloc] init];
for (int i = 0; i < _getDBInfo.count; i++) {

    dbInfo *entity = [_getDBInfo objectAtIndex:i];

    NSNumber *numlat=[[NSNumber alloc] initWithDouble:[entity.Latitude doubleValue]];
    NSNumber *numlon=[[NSNumber alloc] initWithDouble:[entity.Longitude doubleValue]];
    NSLog(@"%d",[_getDBInfo count]);
    la=[numlat doubleValue];
    lo=[numlon doubleValue];
    theCoordinate5.latitude=la;
    theCoordinate5.longitude=lo;

    myAnnotation5.coordinate=theCoordinate5;
    myAnnotation5.title=[NSString stringWithFormat:@"%@"entity.EntityNo];
    myAnnotation5.subtitle=[NSString stringWithFormat:@"%@",entity.EntityName]; 
    [mapView addAnnotation:myAnnotation5];
    [annotations addObject:myAnnotation5];
} 
```

我想我的问题是如何根据数组中的计数创建并添加到我的视图注释对象中？

任何帮助深表感谢。

我是 iOS 和编程新手，所以请保持温和。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T17:23:51.517

你只有一个`myAnnotation5`对象。当您设置它的`coordinate`,`title`等时，您正在为该实例设置它，您碰巧已经添加了`annotations`多次。因此，每个条目都`annotations`将具有您设置的最后一组属性 - 因为每个条目`annotations`实际上都是*同一个*对象。

为了解决这个问题，您需要`myAnnotation5`在循环的每次迭代中重新创建对象，即

```
for (int i = 0; i < _getDBInfo.count; i++) {
    MyAnnotation* myAnnotation5=[[MyAnnotation alloc] init];
    ...
    myAnnotation5.coordinate=theCoordinate5;
    myAnnotation5.title=[NSString stringWithFormat:@"%@", entity.EntityNo];
    myAnnotation5.subtitle=[NSString stringWithFormat:@"%@", entity.EntityName];
    ...
    [mapView addAnnotation:myAnnotation5];
} 
```

两个旁白：

1.  我希望您正在使用 ARC 构建，否则您会左右泄漏内存。
2.  由于`MKMapView`有一个`-annotations`属性，您可能没有理由保留自己的`annotations`数组 - 只需保留对`mapView`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T17:22:44.297

移动这一行：

```
MyAnnotation* myAnnotation5=[[MyAnnotation alloc] init]; 
```

在设置属性之前进入 for 循环`myAnnotation5`。

现在的方式是，您只创建一个`MyAnnotation`对象并反复修改其属性。

# mysql - 什么样的数据库设计应该是用户活动模块的好方法

> ID：10587729
> 
> 赞同：1
> 
> 时间：2012-05-14T16:52:53.750
> 
> 标签：mysql

我正在做一个项目，我需要根据用户活动制作一个模块，但由于我的项目假设未来会有大量成员，我对如何为用户活动制作数据库感到困惑。我有 2 个想法，以 facebook 为例。假设我有 5 张桌子

并且它们都有时间戳，随着用户活动的执行而相应更新，那么我应该进行一个简单的查询并根据所有 5 个表中的时间戳安排用户活动，**或者**

我创建了一个名为的新表

活动

并将用户的每个活动分开存储，但我认为当用户随着时间的推移而增加时，它会是一个巨大的用户活动表数据库，我可以在上面的 5 个表中通过时间戳轻松获取该用户执行的活动。我真的很困惑，任何人都可以帮助我做出正确的选择吗？

# maven - 定义 MapReduce 项目和 Oozie 工作流的依赖关系

> ID：10587741
> 
> 赞同：0
> 
> 时间：2012-05-14T16:53:43.893
> 
> 标签：maven, hadoop, cloudera

在我的公司，我们正在 Hadoop 上开发 MapReduce 应用程序。关于这些项目的依赖管理存在争论，我想听听你的意见。

我们正在使用 Cloudera 的 Hadoop 发行版 (CDH)。

我们的开发工作流程：

*   MapReduce 项目托管在 SVN 存储库中
*   他们每个人都有一个定义了依赖项的 POM 文件（以及其他一些东西）
*   我们还创建了 Oozie 工作流项目，这些项目将这些 MapReduce 项目定义为 POM 中的依赖项，并负责定义 MapReduce 项目的执行流程
*   Oozie 项目的构建工件是一个 jar 文件，其中包含它使用的所有 MapReduce jar 及其依赖项（我们使用 Maven 的程序集插件对其进行压缩），这是我们稍后部署到 HDFS 的工件（解压缩后）
*   我们使用 Maven 构建项目，由 Jenkins 管理
*   成功的构建被部署到 Archiva 服务器
*   部署到 HDFS 是 Archiva 按需提供的，获取 Oozie 项目构建的工件，将其提取并放入 HDFS
*   构建项目不需要一些依赖项（即 Oozie 使用的依赖项；Hive、Sqoop、MySQL 连接器、Jline、commons-...等），但它们需要它才能工作

还在我这儿？

现在的争论是关于定义 MapReduce 和 Oozie 项目的这些依赖关系。有两种观点。

有人说不需要在 POM 文件中定义这些依赖项（即构建项目不需要的依赖项），而是将它们放在 HDFS 的共享目录中，并始终假定它们在那里。

优点：

*   开发人员不需要照顾这些（但是，他们会照顾其他一些人）
*   最有可能的是，在更新 CDH 发行版时，在共享目录中更新它们比在每个项目个性中更容易（但不确定这是否有必要）

缺点：

*   为项目定义了一些依赖项，假设有些依赖项感觉不对
*   共享目录可能成为未使用 JAR 的接收器，没有人知道哪些仍在使用，哪些未使用
*   代码变得不那么可移植了，因为它假定这些 JAR 始终存在于 HDFS 中并具有正确的版本

那你们怎么看？

编辑：忘记写了，但很明显，第二个选项是定义所有依赖项——即使它们会在大多数项目中重复并且需要一些维护。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T18:43:27.990

我投票支持第二个，这意味着处理和维护每个项目的依赖关系而不是共享目录。因为问题是共享目录会随着时间的推移而改变，一段时间后其他项目将不再工作，导致有人删除了一些依赖项等。所以最好将依赖项保存到他们打算使用的 pom 中。此外，任何项目都将开箱即用，而不依赖于共享目录的当前状态。

您可能会考虑包含一些应该使用的**默认依赖项的父 pom。**这可以通过dependencyManagement 部分中的定义来处理，并且特定项目定义了没有版本的真正依赖项。另一种解决方案可能是使用[import scope](http://maven.apache.org/guides/introduction/introduction-to-dependency-mechanism.html)。

```
<dependency>
  <groupId>yourGroupIdy</groupId>
  <artifactId>YourArtifactId</artifactId>
  <version>1.0</version>
  <scope>import</scope>
</dependency> 
```

通过这个，可以有一组已定义的依赖项，这些依赖项不需要在每个项目中维护，仅在负责依赖项的单个 pom 项目中。

# c# - xml字符串到网页

> ID：10587744
> 
> 赞同：0
> 
> 时间：2012-05-14T16:53:52.377
> 
> 标签：c#, asp.net, xml, web-services

我是新的 C#，

我想知道在 asp.net 网页上显示 xml 字符串的最佳方法是什么，我尝试将其放入文本框.. 但它没有格式化.. 有什么办法可以让它看起来格式化。我正在获取这个 XML 作为对 Web 服务的响应，所以不知道 xml 的结构会是什么样的，因为我的 xml 有自定义元素。用户在他们的项目中使用此 xml，因此格式化很重要.. 有人可以帮我解决这个问题.. 示例 xml 文件可能是这样的

```
<geonames>
    <totalResultsCount>1</totalResultsCount>
         <code><postalcode>90210</postalcode>
       <name>Beverly Hills</name>
         <countryCode>US</countryCode>
       <lat>34.09011</lat>
         <lng>-118.40648</lng>
         <adminCode1>CA</adminCode1>
          <adminName1>California</adminName1>
         <adminCode2>037</adminCode2>
         <adminName2>Los Angeles</adminName2>
          <adminCode3/>testing123<adminName3/>
           </code>
            </geonames> 
```

在此先感谢， PS：如果我让问题更具体或更清楚，请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T17:04:58.083

您是否尝试过使用 xml 控件：

```
 <asp:xml ID="Xml1" runat="server"></asp:xml> 
```

您可以在此处找到使用[它](http://forums.asp.net/p/1228055/2209343.aspx#2209343)的示例。

IE的[defaultss.xsl](http://www.perfectxml.com/articles/xml/XsltInMsxml.asp)是 XSLT 1.0 之前的版本。[您可以在此处](http://www.biglist.com/lists/xsl-list/archives/200003/msg00769.html)和[此处](http://www.dpawson.co.uk/xsl/sect2/microsoft.html)找到该文件的有效版本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T17:07:32.997

您可以使用带有 XML 编码的简单文字控件来实现此目的。以下关于 stackoverflow 的帖子详细讨论了它。然而，这只是根据换行和缩进格式化数据，它不会为节点着色

[在 ASP.NET 页面上显示 XML](https://stackoverflow.com/questions/914143/display-xml-on-an-asp-net-page)

# wix - WiX 次要升级不会删除旧的快捷方式

> ID：10587750
> 
> 赞同：0
> 
> 时间：2012-05-14T16:54:10.020
> 
> 标签：wix, wix3

已执行以下步骤：

1.  Setup1.msi 已在 VS2005 + WiX 3.0 (.NET Framework 2.0) 中构建。
2.  版本 1.0.0.0 已由 Setup1.msi 安装。
3.  出于小升级的目的，已构建 Setup2.msi（Setup2.msi 与 Setup1.msi 仅在 ProductVersion="1.0.1.0" 中不同）
4.  已准备以下 Patch.wxs：

    ```
    <Patch
        AllowRemoval="no"
        Classification="Update"
        Comments="..."
        Description="..."
        DisplayName="..."
        Manufacturer="..."
        TargetProductName="...">

    <Media Id="1000" Cabinet="MyPatch.cab">
        <PatchBaseline Id="MyPatch" />
    </Media>

    <PatchFamily 
        Id="MyPatchFamily" 
        Version="1.0.1.0" 
        ProductCode="...THE SAME AS IN Setup1.msi..."            
        Supersede="yes">

        <ComponentRef Id="CMP_Program_EXE" />      
        <ComponentRef Id="CMP_Desktop_Shortcut" />      
        <ComponentRef Id="CMP_ProgramMenu_Shortcut" />
    </PatchFamily>
    </Patch> 
    ```

5.  Patch.msp 是在蜡烛、光、火炬和 pyro.exe 的帮助下创建的。

6.  已调用以下命令：

    ```
    msiexec /p Patch.msp REINSTALL=ALL REINSTALLMODE=vomus 
    ```

    因此，Program.exe 得到了更新，并创建了新的快捷方式“v. 1.0.1”。但是，旧快捷方式“v. 1.0.0”仍保留在“DesktopFolder”和“ProgramMenuFolder”上。

    如何使补丁删除旧的快捷方式？
    提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T06:33:07.630

最简单的方法是不在快捷方式名称中添加版本。请参阅[Windows UX 指南](http://msdn.microsoft.com/en-us/library/windows/desktop/aa511447.aspx#names "Windows 用户体验交互指南 » 开始菜单")：

> 避免在程序名称中加入版本号，除非用户通常这样称呼您的程序。

* * *

否则，您的次要升级必须删除旧版本的快捷方式并创建指向新版本的新快捷方式。

在小升级期间，旧版本没有被卸载，这就是快捷方式没有更新的原因。

# php - 使用 PHP 或 JS 访问 Facebook 页面数据的某种方式

> ID：10587752
> 
> 赞同：0
> 
> 时间：2012-05-14T16:54:15.873
> 
> 标签：php, facebook

我有一个想要访问的 Facebook 页面提要：

```
http://facebook.com/feeds/page.php?format=json&id=123456789 (Not a real ID) 
```

当我将 URL 放入浏览器时，它工作得很好，但是当我尝试使用 file_get_contents 访问它时，Facebook 将我发送到一个页面，显示我正在使用不受支持的浏览器。虽然这些数据是公开的，所以我不需要访问令牌来获取它。为了访问这些数据，我需要采取额外的步骤吗？我也尝试使用 cURL 但没有成功。

任何帮助表示赞赏。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T16:57:16.543

您可以使用 curl 并模仿浏览器，[请参阅此线程](http://www.phpfreaks.com/forums/index.php?topic=256757.0)以了解如何操作。

```
$header = array();
$header[] = 'Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5';
$header[] = 'Cache-Control: max-age=0';
$header[] = 'Connection: keep-alive';
$header[] = 'Keep-Alive: 300';
$header[] = 'Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7';
$header[] = 'Accept-Language: en-us,en;q=0.5';
$header[] = 'Pragma: ';
$ch = curl_init(); 
curl_setopt($ch, CURLOPT_URL, 'YOUR URL HERE');
curl_setopt($ch, CURLOPT_USERAGENT, 'Mozilla/5.0 (Windows; U; Windows NT 6.0; en-US; rv:1.9.0.11) Gecko/2009060215 Firefox/3.0.11 (.NET CLR 3.5.30729)');
curl_setopt($ch, CURLOPT_HTTPHEADER, $header);
curl_setopt($ch, CURLOPT_AUTOREFERER, true); 
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
curl_setopt($ch, CURLOPT_FOLLOWLOCATION, 1);
curl_setopt($ch, CURLOPT_ENCODING, '');
curl_setopt($ch, CURLOPT_TIMEOUT, 20);
$result = curl_exec($ch);
curl_close ($ch);
echo $result; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T16:57:12.843

不要使用这个 url，访问它的方法真的很老。使用他们相对较新的[Graph API](https://developers.facebook.com/docs/reference/api/)

# c++ - * 派生* 类中带有函数的虚拟关键字对性能的影响

> ID：10587757
> 
> 赞同：0
> 
> 时间：2012-05-14T16:54:34.197
> 
> 标签：c++, performance, polymorphism, virtual-functions

Derived1 和 Derived2 从 Base 继承，而没有类从 Derived1 和 Derived2 继承。在下面声明的类中，是否可以通过在成员函数 foo() 的声明中不使用关键字“virtual”来减少一级间接性？或者更具体地说，函数 Derived2::foo() 的性能是否优于 Derived1::foo() 的性能？

```
 class Base{
     public: 
     virtual void foo();
    }

    class Derived1: public Base{
      public:
      virtual void foo();
   }   

   class Derived2: public Base{
      public:
      void foo(); 
   } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T16:58:07.470

不，没有区别。

该关键字`virtual`在派生类中是可选的。如果函数在基类中是虚函数，那么它在所有派生类中也是虚函数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T16:57:12.327

不，因为无论您是否在派生类中使用都没有`Base::foo`关系。无论您是否使用关键字，它都将是一个虚函数。`virtual``virtual``virtual`

# ios - 检测CoreData中的多对多关系变化

> ID：10587767
> 
> 赞同：1
> 
> 时间：2012-05-14T16:55:03.703
> 
> 标签：ios, core-data, many-to-many, nsnotifications

我们有一个非常强大和充实的系统，用于检测我们 iOS 应用程序中模型的变化，使用`NSManagedObjectContextObjectsDidChangeNotification`. 这适用于我们的属性更改以及 1:1 和 1:M 关系的更改。

我们现在正试图在我们的模式中建立一些 M:M 关系，我正在努力了解 Coredata 的通知系统将如何让我们观察 M:M 关系中的特定变化。

我猜如果 M:M 关系发生变化，则涉及更改的两个对象都将出现在`NSUpdatedObjectsKey`列表中，但不会有任何特定的注释说明它们之间的 M:M 关系发生了变化，或者是哪个 M:M 关系（假设两个模型之间可能存在多个 M:M 关系）。

有没有人幸运地使用 Coredata 的通知系统来检测 M:M 关系的变化？还是它们基本上难以使用并且人们倾向于将“连接表”明确地创建为真实类型（从而以两个 1:M 关系而不是单个 M:M 关系结束）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T03:21:36.933

你是对的：当 M:M 关系发生变化时，关系两端的对象会出现在`NSManagedObjectContextObjectsDidChangeNotification`.

如果您正在扫描对象以查找已更改的特定属性，则可以使用该方法`changedValues`（或者，更好的是，`changedValuesForCurrentEvent`在 ios5 上）来查找属性名称。你可能已经在这样做了。

然后，您可以检查模型以查看任何给定属性是否为 many:many：

```
-(void)notifyObjectsChanged:(NSNotification *)note
{
  assert([NSManagedObjectContextObjectsDidChangeNotification isEqual:note.name]);
  for (NSManagedObject *mo in [note.userInfo objectForKey:NSUpdatedObjectsKey])
  {
    NSLog(@"for %@ :", mo.objectID);
    NSDictionary *rels = mo.entity.relationshipsByName;
    for (NSString *prop in [mo.changedValuesForCurrentEvent allKeys])
    {
      NSRelationshipDescription *rel = [rels objectForKey:prop];
      if (rel.isToMany && rel.inverseRelationship.isToMany)
        NSLog(@"many-to-many relationship %@ changed", prop);
    }
  }
} 
```

（未经测试，在我的脑海中，注意错别字！）

基本技术是托管对象保留对对象模型描述的引用，您可以在运行时对其进行检查。

# mysql - MySQL UNION - 将返回的值组合成一组行

> ID：10587768
> 
> 赞同：4
> 
> 时间：2012-05-14T16:55:05.780
> 
> 标签：mysql, union

我是 MySQL 新手，需要寻求您的帮助。我正在使用不同的 WHERE 子句值来区分联合的 2 个部分中的同一个表中的 2 组计数值；像这样：

```
SELECT Count(column1) as 'RED', null as 'BLUE'
FROM TableA
Where column1 Like 'RED'
UNION
SELECT NULL, Count(column1)
FROM TableA
Where column1 Like 'BLUE' 
```

我希望得到：

```
RED      BLUE
---      ----
23       55 
```

但我实际得到的是：

```
RED      BLUE
---      ----
23       NULL
NULL     55 
```

谁能告诉我我做错了什么以及如何得到我想要的答案？谢谢你的帮助...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T17:30:36.633

这是您需要的查询

```
select
    A.colorcount RED,
    B.colorcount BLUE
from
    (select count(1) colorcount from tableA where column1='RED') A,
    (select count(1) colorcount from tableA where column1='BLUE') B
; 
```

这是示例数据

```
mysql> drop database if exists encue;
Query OK, 1 row affected (0.05 sec)

mysql> create database encue;
Query OK, 1 row affected (0.01 sec)

mysql> use encue
Database changed
mysql> create table tableA
    -> (
    ->     id int not null auto_increment,
    ->     column1 varchar(20),
    ->     primary key (id),
    ->     key (column1)
    -> );
Query OK, 0 rows affected (0.13 sec)

mysql> insert into tableA (column1) values
    -> ('RED'),('BLUE'),('BLUE'),('BLUE'),('RED'),('BLUE'),
    -> ('RED'),('BLUE'),('BLUE'),('BLUE'),('RED'),('BLUE'),
    -> ('RED'),('BLUE'),('BLUE'),('BLUE'),('RED'),('BLUE'),
    -> ('RED'),('BLUE'),('BLUE'),('BLUE'),('RED'),('BLUE'),
    -> ('RED'),('BLUE'),('BLUE'),('BLUE'),('RED'),('BLUE'),
    -> ('RED'),('BLUE'),('BLUE'),('BLUE'),('RED'),('BLUE'),
    -> ('RED'),('BLUE'),('BLUE'),('BLUE'),('RED'),('BLUE'),
    -> ('RED'),('BLUE'),('BLUE'),('BLUE'),('RED'),('BLUE'),
    -> ('RED'),('BLUE'),('BLUE'),('BLUE'),('RED'),('BLUE'),
    -> ('RED'),('BLUE'),('BLUE'),('BLUE'),('RED'),('BLUE'),
    -> ('RED'),('BLUE'),('BLUE'),('BLUE'),('RED'),('BLUE'),
    -> ('BLUE'),('BLUE'),('BLUE'),('BLUE'),('BLUE'),('BLUE'),
    -> ('BLUE'),('BLUE'),('BLUE'),('BLUE'),('BLUE'),('RED');
select count(1) colorcount,column1 from tableA group by column1;
Query OK, 78 rows affected (0.10 sec)
Records: 78  Duplicates: 0  Warnings: 0

mysql> select count(1) colorcount,column1 from tableA group by column1;
+------------+---------+
| colorcount | column1 |
+------------+---------+
|         55 | BLUE    |
|         23 | RED     |
+------------+---------+
2 rows in set (0.00 sec) 
```

这是您正在寻找的输出：

```
mysql> select A.colorcount RED,B.colorcount BLUE from
    -> (select count(1) colorcount from tableA where column1='RED') A,
    -> (select count(1) colorcount from tableA where column1='BLUE') B
    -> ;
+-----+------+
| RED | BLUE |
+-----+------+
|  23 |   55 |
+-----+------+
1 row in set (0.00 sec)

mysql> 
```

试试看 ！！！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-14T17:09:29.280

这不是一个好的用例`UNION`。`SUM`您可以使用和来完成您想做的事情`CASE`。这是使用您的查询的示例：

```
SELECT SUM(CASE WHEN column1 LIKE 'RED' THEN 1 ELSE 0 END) AS red_count,
SUM(CASE WHEN column1 LIKE 'BLUE' THEN 1 ELSE 0 END) AS blue_count
FROM TableA
WHERE column1 LIKE 'RED'
OR column1 LIKE 'BLUE' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T16:57:34.383

你试过了吗：

```
SELECT Count(column1) as red, null as blue
FROM TableA Where column1 Like 'RED'
UNION
SELECT NULL as red, Count(column1) as blue
FROM TableA Where column1 Like 'BLUE' 
```

?

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-14T17:09:25.930

试试这个 SQL 语句

```
SELECT Count(A.column1) as red, Count(B.column1) as blue FROM TableA as A,  TableA as B Where A.column1 Like 'RED' AND B.column1 Like 'BLUE' 
```

# java - 从 AJAX 调用异步 Servlet

> ID：10587771
> 
> 赞同：3
> 
> 时间：2012-05-14T16:55:11.390
> 
> 标签：java, ajax, jakarta-ee, servlets, servlet-3.0

我想要完成的事情并不太复杂，但是由于我不精通 AJAX，所以我遇到了一些麻烦。

当它被实现时，我将拥有一个 JSP，它有一个调用异步 Servlet 的按钮。servlet 将运行一个长时间运行的任务，并在部分任务完成时通过向表中添加行来向用户提供动态反馈。

在我尝试编写最终版本之前，我正在做一个概念验证，以了解它是如何工作的。但是，我遇到了障碍。当我在单击按钮时使用 AJAX 调用时，该函数在调用常规同步 servlet 时按预期工作。但是，一旦我使 servlet 异步，更新就不会显示。

任何人都可以提供一些关于出了什么问题的见解吗？

我的 JSP 看起来像这样：

```
<html>
    <body>
        <script type="text/javascript" charset="utf-8">
            $(document).ready(function() {
                $('#mybutton').click(function() {
                    $.get('someservlet', function(responseJson) {
                        $.each(responseJson, function(index, item) {
                            $('<ul>').appendTo('#somediv');
                            $('<li>').text(item.row1).appendTo('#somediv');
                            $('<li>').text(item.row2).appendTo('#somediv');
                            $('<li>').text(item.row3).appendTo('#somediv');
                            $('<li>').text(item.row4).appendTo('#somediv');
                        });
                    });
                });
            });
        </script>
        <p><button id="mybutton">Click to add things</button></p>
        <div id="somediv"></div>
    </body>
</html> 
```

我的异步 Servlet`doGet()`方法如下所示：

```
response.setContentType("application/json");
response.setCharacterEncoding("UTF-8");
final AsyncContext asyncContext = request.startAsync();
final PrintWriter writer = response.getWriter();
asyncContext.setTimeout(10000);
asyncContext.start(new Runnable() {

@Override
public void run() {
    for (int i = 0; i < 10; i++) {
        List<Row> rows = new ArrayList<Row>();
        rows.add(new Row(i, i + 1, i + 2, i + 3));
        String json = new Gson().toJson(rows);
        writer.write(json);
        writer.flush();
        log.info("Wrote to JSON: " + i);
        try {
            Thread.sleep(1000);
        } catch (InterruptedException ex) {
        }
    }
    asyncContext.complete();
    }
}); 
```

有什么想法吗？似乎我单击按钮时发生的 AJAX 调用只接受来自主 servlet 线程的响应。也许我需要从异步`write()`调用中调用 JavaScript 函数？我只是不确定如何执行此操作，或者这是否是正确的执行方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-25T23:10:56.253

看一下

[http://www.oracle.com/webfolder/technetwork/tutorials/obe/java/async-servlet/async-servlets.html](http://www.oracle.com/webfolder/technetwork/tutorials/obe/java/async-servlet/async-servlets.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T00:36:47.523

好的！

所以，我想通了。它不像我希望的那样花哨，但它确实有效。而且，这只是实现我正在做的工作的概念证明。如果有人可以提供进一步的见解，我很乐意能够使用服务器推送而不是轮询来实现这一点。

想法？

我的 JSP 看起来像这样：

```
<html>
    <head>
        <script src="jquery-1.7.1.min.js" type="text/javascript" ></script>
        <script>
            $(document).ready(function() {
                var prevDataLength;
                var nextLine = 0;
                var pollTimer;
                $('#abutton').click(function() {
                    $(function(){
                        var x = new $.ajaxSettings.xhr();
                        x.open("POST", "someservlet");
                        handleResponseCallback = function(){
                            handleResponse(x);
                        };
                        x.onreadystatechange = handleResponseCallback;
                        pollTimer = setInterval(handleResponseCallback, 100);
                        x.send(null);
                    });
                });

                function handleResponse(http) {
                    if (http.readyState != 4 && http.readyState != 3)
                        return;
                    if (http.readyState == 3 && http.status != 200)
                        return;
                    if (http.readyState == 4 && http.status != 200) {
                        clearInterval(pollTimer);
                    }

                    while (prevDataLength != http.responseText.length) {
                        if (http.readyState == 4  && prevDataLength == http.responseText.length)
                            break;
                        prevDataLength = http.responseText.length;
                        var response = http.responseText.substring(nextLine);
                        var lines = response.split('\n');
                        nextLine = nextLine + response.lastIndexOf(']') + 1;
                        if (response[response.length-1] != ']')
                            lines.pop();
                        for (var i = 0; i < lines.length; i++) {
                            var line = $.parseJSON(lines[i]);
                            addToTable(line);
                        }
                    }

                    if (http.readyState == 4 && prevDataLength == http.responseText.length)
                        clearInterval(pollTimer);
                }

                function addToTable(JSONitem) {
                    $.each(JSONitem, function(index, item) {
                        $('<tr>').appendTo('#sometablebody')
                        .append($('<td>').text(item.name))
                        .append($('<td>').text(item.message))
                        .append($('<td>').text(item.number))
                        .append($('<td>').append($('<a>').attr('href', item.link).text('link')));
                    });

                }
            });
        </script>
        <title>Async Test</title>
    </head>
    <body>
        <p><button id="abutton">Click to add things</button></p>
        <div id="somediv">
            <table border="1">
                <thead>
                    <tr>
                        <td>Name</td>
                        <td>Message</td>
                        <td>Number</td>
                        <td>Link</td>
                    </tr>
                </thead>
                <tbody id="sometablebody"></tbody>
            </table>
        </div>
    </body>
</html> 
```

我的异步 Servlet`doGet()`方法如下所示：

```
request.setAttribute("org.apache.catalina.ASYNC_SUPPORTED", true);

        final AsyncContext asyncContext = request.startAsync();
        final PrintWriter writer = response.getWriter();
        asyncContext.setTimeout(60000);
        asyncContext.start(new Runnable() {

            @Override
            public void run() {
                for (int i = 0; i < 10; i++) {
                    try {
                        List<Row> list = new ArrayList<Row>();
                        list.add(new Row("First", "This is the first", String.valueOf(i), "link" + i));
                        list.add(new Row("Second", "This is the second", String.valueOf(i), "link" + i));
                        list.add(new Row("Third", "This is the third", String.valueOf(i), "link" + i));
                        String json = new Gson().toJson(list);

                        asyncContext.getResponse().setContentType("application/json");
                        asyncContext.getResponse().setCharacterEncoding("UTF-8");
                        try {
                            asyncContext.getResponse().getWriter().write(json);
                            asyncContext.getResponse().getWriter().flush();
                        } catch (IOException ex) {
                            System.out.println("fail");
                        }

                        Thread.sleep(250);
                    } catch (InterruptedException ex) {
                        break;
                    }
                }
                asyncContext.complete();
            }
        }); 
```

此外，为了让这一切正常工作，我实现了一个简单的`Row`类：

```
public class Row {

    private String name;
    private String message;
    private String number;
    private String link;

    public Row(String name, String message, String number, String link) {
        setName(name);
        setMessage(message);
        setNumber(number);
        setLink(link);
    }

    public String getLink() {
        return link;
    }

    public void setLink(String link) {
        this.link = link;
    }

    public String getMessage() {
        return message;
    }

    public void setMessage(String message) {
        this.message = message;
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    public String getNumber() {
        return number;
    }

    public void setNumber(String number) {
        this.number = number;
    }
} 
```

# c++ - c ++堆或堆栈分配？

> ID：10587778
> 
> 赞同：5
> 
> 时间：2012-05-14T16:55:30.490
> 
> 标签：c++, memory, heap-memory, stack-memory

这是堆栈上的分配：

```
char inStack[10]; 
// and 
MyStruct cl; 
```

这应该在堆中分配：

```
char* inHeap = new char[10];
// and
MyClass cl = new MyClass(); 
```

如果`MyClass`包含`char test[10]`变量怎么办？做这个：

```
MyClass cl = new MyClass() 
```

...意味着 10 字节长的内容`MyClass::test`是在堆而不是堆栈中分配的？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-05-14T16:57:06.840

它将在对象内部分配，因此如果对象在堆上，则数组将在堆上；如果对象在堆栈上，则数组将在堆栈上；如果对象在可执行文件的静态内存中，则数组也将在那里。

在 C++ 中，对象的成员是对象本身的一部分。如果你有对象的地址和它的大小，你就知道类的所有成员都将在 range 内的某个`[address, address + size)`位置，无论该地址实际在内存中的哪个位置（堆、堆栈等）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-14T16:58:03.960

如果`MyClass`有一个`char test[10]`成员，它将以与分配实例**相同的方式**`MyClass`分配。

```
MyClass mc; //mc.test is on the stack
MyClass * mcp = new MyClass; //mcp->test is on the heap 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-14T18:26:02.230

语言中的正确术语是*自动*和*动态*存储，这些比*stack*和*heap*更有意义。特别是*自动*存储通常并不意味着堆栈，仅在函数中的局部变量中，但正如您提到的，如果您定义一个类的成员，自动存储将在封闭对象所在的任何位置，可以是堆栈，堆或静态对象。

# google-chrome-extension - Google Chromium 的白名单扩展程序

> ID：10587781
> 
> 赞同：0
> 
> 时间：2012-05-14T16:55:51.280
> 
> 标签：google-chrome-extension

我正在尝试部署 Chromium 的独立版本，以便在无法安装完整 Chrome 的客户机器上运行 Web 应用程序。在 Chromium 20 的最新版本中，在`--single-process`Chromium 模式下运行时，Skype 扩展程序会崩溃，所以我想禁用该扩展程序。我还捆绑了我自己的预安装扩展，所以我不想完全禁用所有扩展。

理想情况下，我可以将所有扩展名列入黑名单，仅用于安装 Chromium，并将我的扩展名列入白名单。我想以不影响机器上其他 Chrome 安装的方式执行此操作。我正在通过 安装我的扩展程序`master_preferences`，我也可以在那里设置白名单吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T12:29:16.557

在扩展程序的清单中设置一个名称。然后在扩展本身中在一个变量中设置相同的名称（例如：）`window.___NAME`。然后使用此代码：

```
function DisableOtherExtensions(){
    chrome.management.getAll(function(ext){
        if(ext.length===1) return;

        for(var i=0; i<ext.length; i++){
            if(ext[i].name===____NAME) continue;
            chrome.management.setEnabled(ext[i].id,false);
        }
    });
}

chrome.management.onEnabled.addListener(DisableOtherExtensions);
chrome.management.onInstalled.addListener(DisableOtherExtensions); 
```

它不会让 Chrome 启用除您之外的任何其他扩展。部署说明也在这里：[http](http://code.google.com/chrome/extensions/external_extensions.html) ://code.google.com/chrome/extensions/external_extensions.html 。

# jpa - JPA Join Not Cascading for jUnit Test

> ID：10587785
> 
> 赞同：0
> 
> 时间：2012-05-14T16:56:03.650
> 
> 标签：jpa, junit, many-to-many, eclipselink, jointable

我用连接表定义的 2 个表之间存在多对多关系。

```
//MyClassA
@ManyToMany
@JoinTable(name="A_TO_B", 
           joinColumns=@JoinColumn(name="A_UUID"), 
           inverseJoinColumns=@JoinColumn(name="B_UUID")
)
private List<MyClassB> classBs = new ArrayList<MyClassB>();

//MyClassB
@ManyToMany(mappedBy="classBs")
private List<MyClassA> classAs = new ArrayList<MyClassA>(); 
```

由于公司架构限制，连接表必须有一个 UUID 列。

我有一个名为 DAO 的方法`associateItems`，它应该在连接列中插入一行。为了测试所有内容，我在 jUnit 测试中执行以下操作。

```
myDao.associateItems(classAItem, classBItem);

classAItem = myDao.get(classAItem.getUuid());
classBItem = myDao.get(classBItem.getUuid());

assertEquals(1, classAItem.getClassBs().size());
assertEquals(1, classBItem.getClassAs().size()); 
```

此测试在最后 2 行失败。

在我的 DAO 中，我尝试了很多事情。我尝试将`classAItem`and添加`classBItem`到彼此的列表中并合并它们。但这会导致错误，因为连接表对象没有 UUID。我尝试创建连接表对象并将其持久化。但随后测试的最后两行失败，因为它认为列表的大小为 0。

我一直坚持第二种解决方案（失败总比错误好）。

```
public void associateItems(MyClassA classAItem, MyClassB classBItem) {
    //UUID populated in constructor
    AToB association = new AToB(classAItem, classBItem); 
    entityManager.persist(association);
} 
```

我知道连接表项正在插入到数据库中。我还手动输入了一个连接表项，并确保在找到关联时填充列表。所以测试只是在制作连接表项然后关联相关列表方面存在问题。

我尝试过处理级联、获取类型和刷新。但我似乎找不到让测试通过的方法。

有人知道我需要做什么来解决这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T17:32:29.297

这实际上是`get`DAO 中方法的问题。我添加了以下提示并测试运行没有失败。

```
query.setHint(QueryHints.REFRESH, HintValues.TRUE); 
```

# css - ExtJS 4 添加加载图标

> ID：10587786
> 
> 赞同：0
> 
> 时间：2012-05-14T16:56:10.053
> 
> 标签：css, extjs, extjs4.1

我正在使用 ExtJS 4.1，它要快得多，但有时加载视图可能需要一段时间，所以我想显示某种`Loading`图像，告诉用户他应该等待。我怀疑这是非常标准的东西，但是关于如何以及在哪里做的一些建议会非常有帮助。

谢谢

勒龙

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T17:17:08.543

`LoadMask`在他们的文档中搜索。这是很标准的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T21:08:00.510

我确实喜欢这样：

进入 index.html

```
 <div id="page-loader">  
        <img style="display: block;margin-left: auto;margin-right: auto; width=50%; height=100%;" src="data/xxxxx.gif" />
        <br/>
        &nbsp;&nbsp;Initializing...
        <br/>
    </div> 
```

进入 app.js

启动：函数（）{

```
 Ext.create('Pwallet.view.Videata');
    if (Ext.get('page-loader')) {
        Ext.get('page-loader').remove();}

} 
```

# sql - SQL SUM() 函数可以将表达式作为参数吗？

> ID：10587788
> 
> 赞同：2
> 
> 时间：2012-05-14T16:56:14.027
> 
> 标签：sql, sqlite, aggregate-functions

我正在使用 SQLite 数据库，我想知道是否允许我编写如下查询：

```
SELECT SUM(column1 * column2)
FROM my_table; 
```

我用谷歌搜索，但参考资料说 SUM 函数具有以下格式：

```
SUM([DISTINCT|ALL] column) 
```

我的问题是：`column`实际上是指列还是它也允许表达式（如上）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-14T16:58:33.950

您始终可以使用表表达式：

```
SELECT SUM(Calc)
FROM (
SELECT Column1 * Column2 AS 'Calc'
FROM My_Table) t 
```

我没有 SQLite，但检查文档表明这应该可以正常工作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-14T17:01:48.933

是的，如果两列的数据类型都允许，您可以使用您提到的表达式。

# facebook-fql - FQL，搜索非好友并按共同好友排序

> ID：10587789
> 
> 赞同：2
> 
> 时间：2012-05-14T16:56:14.250
> 
> 标签：facebook-fql

我寻找名称中有模式的 facebook 用户（任何用户，不仅仅是我的朋友或特定用户的朋友），如下所示：

```
SELECT first_name,uid FROM user WHERE contains('pete') 
```

这将返回一个名字包含“pete”（即“peter”）的人的数组。这个数字相当高，所以结果当然会被截断。我想在这个集合中（在服务器端截断之前）抓住与​​我有最多共同朋友（或具有任意用户 ID）的人。然而，发出

```
SELECT first_name,uid FROM user WHERE contains('pete') AND mutual_friend_count > 1 
```

给出和空集（并且没有错误）。我认为服务器在应用后一个选择之前会截断，因为在正常 SQL 中会发生，出于性能原因（或我在文档中遗漏的明确限制）。

我通过尝试检索用户 ID 的朋友的所有朋友来进行第二次尝试，然后选择名称。但是，不允许检索朋友的朋友（这在技术上很困难，因为有些朋友隐藏了他们的朋友列表，这会破坏查询）。

我看不出有其他方法可以实现我的目标……有吗？（我的意思是：给定一个用户 ID，搜索拥有最多共同好友的用户）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T17:59:31.430

我刚刚用“order bymutual_friend_count desc”试了一下，它奏效了。所以查询需要是：

> SELECT first_name,uid FROM user WHERE contains('pete') order bymutual_friend_count desc

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T22:45:34.330

由于没有 FQL 解决方案，您最好的选择当然是按照 Facebook 的最佳实践和政策创建自己的数据库。这样你就可以构建你的数据。数据可以通过设置 Facebook 的实时更新 API (https://developers.facebook.com/docs/reference/api/realtime/) 来保持最新状态，以捕捉新朋友的建立。

# asp.net - Asp.net auth cookie 加密问题

> ID：10587792
> 
> 赞同：1
> 
> 时间：2012-05-14T16:56:39.343
> 
> 标签：asp.net, .net, encryption, machinekey

我在网络场中有两台服务器。两者都使用相同的 machineKey。当一台服务器生成身份验证 cookie 时，另一台服务器不理解。还有什么可以检查的？

# c# - 在 C# 中如何调用 SQL Server 存储过程并控制输出日志的位置

> ID：10587795
> 
> 赞同：0
> 
> 时间：2012-05-14T16:56:46.067
> 
> 标签：c#, .net, sql, tsql, sql-server-2005

我有几个存储过程需要指示输出日志的位置。您可以在 SQL 代理中设置它，但是在通过 C# 调用存储过程时如何设置它？C# 是 .NET 3.5，SQL Server 是 2005。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T18:54:08.413

我通常为我的日志结果创建一个新表。您可以直接从存储过程写入日志表，我们会创建一个您调用的单独过程。

我通常使用 log4Net，因为我从可执行程序和存储过程中记录。 [http://logging.apache.org/log4net](http://logging.apache.org/log4net)。谷歌“存储过程中的 log4net 日志记录”示例。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-14T17:21:24.060

我不确定你所说的输出日志位置是什么意思 - SQL 代理有自己的运行作业和捕获输出的机制，所以如果你只是在 C# 中运行松散的存储过程，那么 SQL 代理所做的任何事情都对你没有帮助。

您需要在调用代码中捕获任何输出并自己处理/记录。

[捕获存储过程的输出](https://stackoverflow.com/questions/1880471/capture-stored-procedure-print-output-in-net)听起来像您正在寻找的吗？

# speech-recognition - 使用 OpenEars / PocketSphinx 标记声门闭合

> ID：10587797
> 
> 赞同：1
> 
> 时间：2012-05-14T16:56:55.620
> 
> 标签：speech-recognition, cmusphinx, openears

我刚刚在搜索可以帮助识别声门闭合的库时发现了 CMUSphinx。

在 PocketSphinx 或其相关的 OpenEars 中解决此问题的方法是什么？

在标记该信息时，是否可以轻松获取语音的其他属性？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T05:13:07.917

> 在 PocketSphinx 或其相关的 OpenEars 中解决此问题的方法是什么？

没有这样的方法。Pocketsphinx 是一个语音识别库。它输入音频并返回文本。它对声门停止一无所知。

> 在标记该信息时，是否可以轻松获取语音的其他属性？

不清楚您在说什么信息。如果您对发音评估感兴趣，有一个关于此的常见问题解答条目：

[http://cmusphinx.sourceforge.net/wiki/faq#qhow_to_implement_pronunciation_evaluation](http://cmusphinx.sourceforge.net/wiki/faq#qhow_to_implement_pronunciation_evaluation)

还有一个正在进行的项目来实施发音评估，但它才刚刚开始，预计将在今年夏天完成。

# php - 在服务器上运行恒定数量的 php 脚本

> ID：10587800
> 
> 赞同：1
> 
> 时间：2012-05-14T16:57:09.017
> 
> 标签：php, shell, cron, monitoring, lamp

我在 AWS 灯服务器上并行运行 php 脚本。现在我有一个 cron 作业设置为以 10 分钟的间隔运行每个脚本，然后脚本设置为在运行 20 分钟后退出。我限制每个脚本运行的时间，以免服务器内存不足。我已尽力堵住内存漏洞，但在我处理此问题时，将脚本超时是一个很好的临时解决方案。

问题是我同时运行了太多脚本。因此，与其使用 cron 以设定的时间间隔运行脚本，不如我如何编写服务器脚本以

A）监视在任何给定时刻正在运行的特定 php 脚本实例的数量

B）如果该数字低于 n（比如 4 个实例），服务器会启动另一个 php 脚本实例吗？

感谢您仍在学习我在 Linux 上的方式的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T17:03:54.493

最好的方法可能是编写您自己的守护进程，该守护进程运行、派生子进程、监视它们，并根据需要重新启动它们。

看看[http://php.net/manual/en/book.pcntl.php](http://php.net/manual/en/book.pcntl.php)

但是，在您的情况下，可能有一个更简单的答案......放置一个一分钟的 crontab 来调用您的加载程序脚本，如下所示：

```
* * * * *  /usr/bin/php /path/to/loader.php 
```

加载程序脚本可以是一个简单的 shell 脚本（或 php 脚本）。在 shell 中运行此命令。它将返回您正在运行的脚本的实例数。

```
ps aux | grep "/usr/bin/php /path/to/thing/you/run.php" | grep -v grep | wc -l 
```

如果 # 个实例 > 3，则不要启动一个。否则，开始一个。如果在 PHP 中，您可以简单地包含所需的文件。如果在 bash 中，只需编写`/usr/bin/php /path/to/thing/you/run.php`

希望对一些人有所帮助！

# java - Java：继承并成为单身人士

> ID：10587801
> 
> 赞同：4
> 
> 时间：2012-05-14T16:57:10.597
> 
> 标签：java, inheritance, singleton

首先，我**不想**创建单例类的子类。（至少我确定我没有尝试）。

我有一个`ClassA`抽象的类。

我有两个类`ClassA1`，`ClassA2`扩展`ClassA`.

我想成为单身人士的班级`ClassA1`。`ClassA2`我可以在每个代码中编写代码，但我更愿意编写一次代码`ClassA`并在所有子类中重用它。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-14T16:59:56.440

`ClassA`可能不是——单例模式需要静态方法/字段，如果在一个地方定义，它们将由其所有子类共享。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T17:00:43.323

我建议`ClassA1`A2 使用私有构造函数，并使用静态方法来创建对象。这样您就可以完全控制对象的创建。EffectiveJava 一书详细介绍了这种方法的优点。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-14T17:45:39.210

这样做的唯一地方是在扩展 Enum 的枚举类中。它使用了一种语言扭曲，以及类似`class ClassA<T extends ClassA>`. 要么你这样做：

```
public class ClassA {

    private static final Map<Class<? extends ClassA>, ClassA> singletons = new HashMap<>();

    public static <T extends ClassA> T get(Class<T> klazz) {
        T singleton = klazz.cast(singletons.get(klazz));
        if (singleton == null) {
            try {
                singleton = klazz.getConstructor().newInstance();
            } catch (InstantiationException | IllegalAccessException
                    | IllegalArgumentException | InvocationTargetException
                    | NoSuchMethodException | SecurityException e) {
                throw new IllegalArgumentException(e);
            }
            singletons.put(klazz, singleton);
        }
        return singleton;
    }
    protected ClassA() { }
} 
```

或者你重新考虑你对多个单例的需求，或者做一个通用的容器查找，（可能使用声明性 XML 或注释）或一个 bean 容器。EJB 3.1 非常好和简单。

# ios - MFMailComposeViewController 操作表在 iOS5 上 setStatusBarHidden:YES 时不在屏幕上

> ID：10587807
> 
> 赞同：0
> 
> 时间：2012-05-14T16:57:34.140
> 
> 标签：ios, ipad, ios5

我遇到了 MFMailComposeViewController 的取消按钮的问题。这是我的上下文

```
- (void)viewDidLoad
{
    [super viewDidLoad];
// Do any additional setup after loading the view, typically from a nib.
   [[UIApplication sharedApplication] setStatusBarHidden:YES];
}

- (IBAction)showButtonDidTouch:(id)sender {
    if ([MFMailComposeViewController canSendMail]) {
         MFMailComposeViewController *mailViewController = [[MFMailComposeViewController alloc] init];
         mailViewController.mailComposeDelegate = self;
         mailViewController.modalPresentationStyle = UIModalPresentationFormSheet;
         [self presentModalViewController:mailViewController animated:YES];
         [mailViewController release];
}
} 
```

我在 viewDidLoad 隐藏了状态栏，然后将显示的 mailViewController 称为当前模式视图控制器。但是，问题是当应用程序处于横向模式和 uikeyboard 出现时，当点击取消按钮作为图像时，操作表不会显示：http: [//img651.imageshack.us/img651/5489/screenshot20120514at114.png](http://img651.imageshack.us/img651/5489/screenshot20120514at114.png)

左上角的小红色图像是操作表。如果我设置 statusbarhidden = NO，它就会显示出来。

感谢您的帮助，谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-18T10:13:04.743

通过注册 UIKeyboardWillShowNotification，我能够解决这个问题（我认为这是一个 iOS 错误）。每当显示键盘时，我手动将 MFMailComposeViewController 的超级视图的框架设置为 +/- 20（状态栏高度），具体取决于方向（横向或横向）。这是一个非常丑陋的黑客，但它现在对我有用。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2015-04-08T03:58:19.877

我用了一个计时器，移动

```
[self presentViewController:mc animated:YES completion:^(void) {}]; 
```

到操作表之外，它也可以工作。

# sql-server - 搜索 nvarchar(max) 字段

> ID：10587809
> 
> 赞同：0
> 
> 时间：2012-05-14T16:57:39.617
> 
> 标签：sql-server

我们的应用程序连接到 SQL Server 数据库。有一列`nvarchar(max)`已添加，必须包含在搜索中。该数据库中的记录数只有几十万，并且只有几百人使用该应用程序。我被告知要探索全文搜索，这有必要吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-14T17:05:40.167

这就像问，我在 5 英里外工作，并被告知要考虑购买汽车。这是必要的吗？变量太多，无法为您的问题提供简单而正确的答案。例如，这是一次愉快的散步吗？有公共交通吗？你的日程安排灵活吗？下班后你必须去很远的地方吃午饭或跑腿吗？

如果您的典型搜索将是，全文搜索可以提供帮助`WHERE col LIKE '%foo%'`- 但是否有必要取决于此列将获得多大，您的搜索是否是真正的通配符搜索，您对毫秒与纳秒查询的容忍度，并发量，甚至是看似无关的东西，例如数据是否始终在内存中并且可以更有效地搜索。

更好的答案是您应该尝试一下。使用您的数据副本填充表，添加全文索引，并查看您的典型工作负载是否通过使用全文查询而不是`LIKE`. 可能会，但即使您添加的细节比球场行数更多，我们也无法确定。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T17:13:18.427

在类似的情况下，我最终创建了一个更易于搜索和可索引的表结构，然后设置了一个批处理作业将记录从实时数据库复制到报告数据库。

在我的情况下，原始数据并不接近需要一个 nvarchar(max) 列，所以我可以摆脱它。你的旅费可能会改变。无论如何，答案是“尝试一些事情，看看什么对你有用”。

# html - CSS：为什么背景颜色会破坏/删除盒子阴影？

> ID：10587814
> 
> 赞同：31
> 
> 时间：2012-05-14T16:58:07.097
> 
> 标签：html, css

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-05-14T17:01:31.860

You just need to add z-index and position:relative; see the example. [http://jsfiddle.net/SqvUd/2/](http://jsfiddle.net/SqvUd/2/)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-14T17:03:04.773

It has to do with the z-index of the items. Try adding this to your existing css:

```
.obOffer {
    position: relative;
    z-index: 10;
}

.obHiLight {
    position:relative;
    z-index: 100;
}​ 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2019-08-18T14:17:11.280

adding `.obHiLight{opacity:0.999}` creates a new stacking context for that element, which makes it appear above the others as well. This might work for tables too (didn't test :) . @ItJustWerks @brian-tacker

# performance - Maven 3 是否提供比 Maven 2 更好的性能？

> ID：10587820
> 
> 赞同：2
> 
> 时间：2012-05-14T16:58:29.047
> 
> 标签：performance, maven-2, maven-3

我试过很简单：

```
 mvn clean install -Dmaven.test.skip.exec=true 
```

从 Maven2 (2.2.1) 切换到 Maven3 (3.0.4 - 3.0.3)。但是 Maven2 用于构建的时间更少！对于 Maven2 近 16 分钟构建的项目，在 Maven3 上 - 近 20 分钟。但是，在 stackoverflow 上我也发现比 Maven3 有更好的性能。我应该为 Maven3 创建另一个本地存储库（我使用 Maven2 创建的旧版本）还是使用其他选项？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T07:39:50.137

Maven 3 应该比 Maven 2 更快。当然，对于某些边缘情况，性能回归的可能性总是存在的。我不确定您的问题出在哪里，但我会首先查看哪个阶段需要更长的时间并将其与 Maven 2 构建进行比较，例如：

*   这是多模块还是单模块构建？
*   构建是否包含非标准构建扩展，例如`maven-bundle-plugin`？
*   构建是否使用最新版本的插件？在`maven-compiler-plugin`2.4.0 版本中为多模块项目带来了不错的性能改进
*   构建参考工件是否具有版本范围？我记得早期的 Maven 3.0.x 版本在性能方面存在一些问题
*   您的 POM 中是否已修复所有插件版本？Maven 3 可能会带来性能下降的新插件版本

一旦你缩小了根本原因，你可以自己修复它 - 如果可能的话 - 或者向 maven 插件或 maven 核心提交错误报告。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T18:49:30.620

您可以尝试 Maven 3 的 -T 选项，它提供了并行执行生命周期部分的可能性。

--help 输出的摘录：

```
-T,--threads <arg>                     Thread count, for instance 2.0C
                                        where C is core multiplied 
```

但这取决于您使用的插件版本是否已经更新并正确标记有@threadsafe。但有时值得一试。

# wix - Burn bootstrapper is not detecting Windows installer version correctly

> ID：10587824
> 
> 赞同：6
> 
> 时间：2012-05-14T16:58:34.250
> 
> 标签：wix, wix3.6, burn

Currently, I have the following fragment to check and install Windows Installer 4.5 if the user is on Windows XP.

```
<Fragment>
    <Property Id="WinXPx86HasInstaller">
      <![CDATA[VersionNT = 'v5.1' AND  VersionMsi >= "4.5.6001.22159"]]>
    </Property>

    <PackageGroup Id="Windows.Installer.4.5">
        <ExePackage Id="WinXp_x86"
                    Cache="no"
                    Compressed="no"
                    PerMachine="yes"
                    Permanent="yes"
                    Vital="yes"
                    InstallCommand="/norestart /passive"
                    SourceFile="WindowsXP-KB942288-v3-x86.exe"
                    DownloadUrl="http://download.microsoft.com/download/2/6/1/261fca42-22c0-4f91-9451-0e0f2e08356d/WindowsXP-KB942288-v3-x86.exe"
                    DetectCondition="WinXPx86HasInstaller"
                    InstallCondition="NOT WinXPx86HasInstaller">
            <ExitCode Behavior="forceReboot" />
        </ExePackage>
    </PackageGroup>
</Fragment> 
```

However, this is not working and the property "WinXPx86HasInstaller" always evaluates to false even when it is installed.

What am I doing wrong?

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-05-18T07:24:50.460

It's somewhat annoying that, unlike WiX, there's no way to easily test Burn InstallConditions - only DetectConditions are printed out in the log at runtime. After spending a while to test *inverted* InstallConditions as DetectConditions [*], this fragment appears to work for me:

```
<!-- Windows Installer 4.5 -->
<Fragment>
    <PackageGroup Id="WindowsInstaller45">
        <ExePackage
            Cache="no"
            Compressed="no"
            PerMachine="yes"
            Permanent="yes"
            Vital="yes"
            SourceFile="redist\WindowsXP-KB942288-v3-x86.exe"
            DownloadUrl="http://download.microsoft.com/download/2/6/1/261fca42-22c0-4f91-9451-0e0f2e08356d/WindowsXP-KB942288-v3-x86.exe"
            InstallCondition="VersionNT=v5.1 AND NOT VersionNT64 AND VersionMsi &lt; v4.5"
            InstallCommand="/quiet /norestart">
            <ExitCode Behavior="forceReboot"/>
        </ExePackage>
        <ExePackage
            Cache="no"
            Compressed="no"
            PerMachine="yes"
            Permanent="yes"
            Vital="yes"
            SourceFile="redist\WindowsServer2003-KB942288-v4-x86.exe"
            DownloadUrl="http://download.microsoft.com/download/2/6/1/261fca42-22c0-4f91-9451-0e0f2e08356d/WindowsServer2003-KB942288-v4-x86.exe"
            InstallCondition="VersionNT=v5.2 AND NOT VersionNT64 AND VersionMsi &lt; v4.5"
            InstallCommand="/quiet /norestart">
            <ExitCode Behavior="forceReboot"/>
        </ExePackage>
        <ExePackage
            Cache="no"
            Compressed="no"
            PerMachine="yes"
            Permanent="yes"
            Vital="yes"
            SourceFile="redist\WindowsServer2003-KB942288-v4-x64.exe"
            DownloadUrl="http://download.microsoft.com/download/2/6/1/261fca42-22c0-4f91-9451-0e0f2e08356d/WindowsServer2003-KB942288-v4-x64.exe"
            InstallCondition="VersionNT=v5.2 AND VersionNT64 AND VersionMsi &lt; v4.5"
            InstallCommand="/quiet /norestart">
            <ExitCode Behavior="forceReboot"/>
        </ExePackage>
        <MsuPackage
            Cache="no"
            Compressed="no"
            Permanent="yes"
            Vital="yes"
            KB="KB942288"
            SourceFile="redist\Windows6.0-KB942288-v2-x86.msu"
            DownloadUrl="http://download.microsoft.com/download/2/6/1/261fca42-22c0-4f91-9451-0e0f2e08356d/Windows6.0-KB942288-v2-x86.msu"
            InstallCondition="VersionNT=v6.0 AND NOT VersionNT64 AND VersionMsi &lt; v4.5"/>
        <MsuPackage
            Cache="no"
            Compressed="no"
            Permanent="yes"
            Vital="yes"
            KB="KB942288"
            SourceFile="redist\Windows6.0-KB942288-v2-x64.msu"
            DownloadUrl="http://download.microsoft.com/download/2/6/1/261fca42-22c0-4f91-9451-0e0f2e08356d/Windows6.0-KB942288-v2-x64.msu"
            InstallCondition="VersionNT=v6.0 AND VersionNT64 AND VersionMsi &lt; v4.5"/>
    </PackageGroup>
</Fragment> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-14T17:05:40.880

For what it's worth, I believe the original reason as to why your detection was failing would be because VersionMsi only has two digits of precision:

```
<![CDATA[VersionNT = 'v5.1' AND  VersionMsi >= "4.5.6001.22159"]]> 
```

should have been

```
<![CDATA[VersionNT = 'v5.1' AND  VersionMsi >= v4.5]]> 
```

I had recently struggled with a similar issue and ended up digging into [Burn](http://en.wikipedia.org/wiki/WiX#Burn) to find the answer.

```
static HRESULT InitializeVariableVersionMsi(
__in DWORD_PTR dwpData,
__inout BURN_VARIANT* pValue
)
{
    UNREFERENCED_PARAMETER(dwpData);

    HRESULT hr = S_OK;
    DLLGETVERSIONPROC pfnMsiDllGetVersion = NULL;
    DLLVERSIONINFO msiVersionInfo = { };

    // Get DllGetVersion proc address
    pfnMsiDllGetVersion = (DLLGETVERSIONPROC)::GetProcAddress(::GetModuleHandleW(L"msi"), "DllGetVersion");
    ExitOnNullWithLastError(pfnMsiDllGetVersion, hr, "Failed to find DllGetVersion entry point in msi.dll.");

    // Get msi.dll version information
    msiVersionInfo.cbSize = sizeof(DLLVERSIONINFO);
    hr = pfnMsiDllGetVersion(&msiVersionInfo);
    ExitOnFailure(hr, "Failed to get msi.dll version info.");

    hr = BVariantSetVersion(pValue, MAKEQWORDVERSION(msiVersionInfo.dwMajorVersion, msiVersionInfo.dwMinorVersion, 0, 0));
    ExitOnFailure(hr, "Failed to set variant value.");

    LExit:
    return hr;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-17T09:39:18.770

Try to use

```
DetectCondition="VersionMsi >= v4.5 AND VersionNT = 501 AND NOT VersionNT64" 
```

And I think, `InstallCondition` is not necessary in this case.

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-05-15T13:32:45.400

Version NT has values 501, 502, 600, etc. The value is an integer: MajorVersion * 100 + MinorVersion. Use '501' instead of 'v5.1'.

Source: [http://msdn.microsoft.com/en-us/library/windows/desktop/aa372495%28v=vs.85%29.aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/aa372495%28v=vs.85%29.aspx)

# python - Graphite - 使用 DivideSeries 的多个系列

> ID：10587826
> 
> 赞同：2
> 
> 时间：2012-05-14T16:58:50.473
> 
> 标签：python, graphite, click-through

我正在尝试使用 Graphite 来计算我所有资源的点击率，所以我尝试像这样记录我的数据：

*   ctr.resource_id.clicks
*   ctr.resource_id.reach

所以首先，我提出了我的查询：

```
&target= averageSeries(divideSeries(ctr.176983011340976128.clicks,ctr.176983011340976128.reach),divideSeries(ctr.190348137012011008.clicks,ctr.190348137012011008.reach)) 
```

我的问题是我不想将所有资源 ID 发送到石墨，所以我尝试了：

```
&target= averageSeries(divideSeries(ctr.*.clicks,ctr.*.reach)) 
```

但是，是的，正如[文档](http://graphite.readthedocs.org/en/1.0/functions.html#graphite.render.functions.divideSeries)所说“ *ValueError: divideSeries 第二个参数必须准确引用 1 系列*”。

我尝试了另一种架构：

*   ctr.clicks.resource_id
*   ctr.reach.resource_id

但是同样的问题……</p>

我是 Graphite 的新手，所以如果有人有解决方案，那就太棒了！

编辑：

刚看到函数[groupByNode](http://graphite.readthedocs.org/en/1.0/functions.html#graphite.render.functions.groupByNode)，正在尝试使用它……</p>

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T12:57:00.517

听起来您需要事先将数据聚合成一个系列，以便您可以将其传递给 divideSeries。

配置 Carbon 文档中的 Aggregator-rules.conf 参考：http: [//graphite.readthedocs.org/en/latest/config-carbon.html](http://graphite.readthedocs.org/en/latest/config-carbon.html)

因此，您需要 2 个这样的规则来总结每分钟的点击数据： ctr.resource_all.clicks (60) = sum ctr.*.clicks ctr.resource_all.reach (60) = sum ctr.*.reach

您还必须运行 carbon-aggregator.py 守护进程 `/opt/graphite/bin/carbon-aggregator.py start`

聚合器守护程序的默认端口是 2023，因此您应该在此处发送流量，而不是您一直使用的 2003 端口。

# javascript - IE 7，JS 滑块上的 CSS 悬停项

> ID：10587829
> 
> 赞同：0
> 
> 时间：2012-05-14T16:59:15.957
> 
> 标签：javascript, css, internet-explorer, hover

我遇到的问题是我在中心区域有一个 JS 滑块。但是它上面还有一个 CSS 下拉菜单。除了可怕的 IE 7 和 6 [不担心 6] 之外，每个浏览器都可以使用悬停效果。我不确定如何在 JS 滑块上显示 UL 菜单，因为 Z-Index 函数并没有真正做任何事情，因为我将悬停在容器上设置为 999，滑块中的实际图像只有 5 个。任何想法。

发生问题的站点：[http ://www.metroclick.com/](http://www.metroclick.com/)

绝对感谢所有答案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T17:02:08.610

将整个滑块 fiv z-index 设置为 1，将 ul 设置为 z-index 999，这应该可以完成工作......

# java - Java RegEx 全部替换以格式化来自 XML 的数据

> ID：10587831
> 
> 赞同：0
> 
> 时间：2012-05-14T16:59:17.057
> 
> 标签：java, xml, regex, string, replaceall

大家下午好

我注意到他们在这里已经有一些类似的问题，但到目前为止对我没有太大帮助。我正在尝试操作由现有方法返回的字符串以将其格式化为可读形式。因此，例如，我正在尝试创建一个 String replaceAll() 正则表达式，它将采用字符串

```
"<ds:AddressLine1>Birkmire Farm</ds:AddressLine1><ds:AddressLine2>Some Village</ds:AddressLine2><ds:AddressLine3>Wigfield</ds:AddressLine3><ds:AddressLine4>Cumbria</ds:AddressLine4><ds:UKpostcode>CA9 1EJ</ds:UKpostcode>" 
```

并将其转换为...

```
Birkmire Farm, Some Village, Wigfield, Cumbria, CA9 1EJ 
```

我设想这样做的方式是分三个步骤，首先用“”替换所有结束标记，然后用“，”替换所有开始标记，最后使用 String replaceFirst 删除第一个逗号和放在前面的空格的字符串。

我遇到的问题是正则表达式，我需要制定一个模式来识别任何开始标签 ie 和一个模式来识别任何结束标签 ie 。对此的任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T17:02:44.380

RE 用于打开标签：`<[^/][^>]*>`. RE 结束标签：`</[^>]*>`.

# c# - 如何使基于 REST 的 WCF 服务服务文件成为索引？

> ID：10587837
> 
> 赞同：0
> 
> 时间：2012-05-14T16:59:57.843
> 
> 标签：c#, .net, wcf, rest

我有一个提供 Web 服务的服务文件 Service.svc。我希望帮助页面成为主 url（例如 / 而不是 /Service.svc/help）。这可能吗，有人可以告诉我怎么做吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T18:09:47.570

只需重定向到帮助页面。例如：

```
[WebInvoke(UriTemplate = "", Method = "GET")]
public void RedirectToHelp()
{          
  WebOperationContext.Current.OutgoingResponse.StatusCode = HttpStatusCode.Redirect;
  WebOperationContext.Current.OutgoingResponse.Location = "help";

} 
```

# javascript - CSS3 过渡 - 如何延迟 z-index 属性的重置？

> ID：10587842
> 
> 赞同：22
> 
> 时间：2012-05-14T17:00:19.770
> 
> 标签：javascript, css, z-index, css-transitions

基本上，通过 mouseenter 上的 javascript 动态地将“highlight”类添加到具有“edge”类的元素中。高亮类在鼠标离开时被删除。我想转换这些元素的边框颜色。然而，这个“highlight”类也修改了堆栈顺序。我希望在过渡开始之前（在 mouseenter 上）在所有突出显示的边缘上设置 z-index 1，并且我希望在过渡完成后（在 mouseleave 上）删除 z-index 1。目前 z-index 属性在“highlight”类被删除后立即重置。

基本设置：

```
.edge {

    border-color: hsl(0, 0%, 40%);
    border-style: solid;
    border-width: (set appropriately in another selector);

    transition-duration: 1s;
    -moz-transition-duration: 1s;
    -o-transition-duration: 1s;
    -webkit-transition-duration: 1s;

    transition-property: border-color;
    -moz-transition-property: border-color;
    -o-transition-property: border-color;
    -webkit-transition-property: border-color;
}

.edge.highlight {
    border-color: hsl(0, 0%, 85%);
    z-index: 1;
} 
```

第一次尝试（显然延迟在一端固定了时间，而在另一端搞砸了）：

```
.edge {
    border-color: hsl(0, 0%, 40%);
    border-style: solid;
    border-width: (set appropriately in another selector);

    transition-duration: 1s, 0;
    -moz-transition-duration: 1s, 0;
    -o-transition-duration: 1s, 0;
    -webkit-transition-duration: 1s, 0;

    transition-delay: 0, 1s;
    -moz-transition-delay: 0, 1s;
    -o-transition-delay: 0, 1s;
    -webkit-transition-delay: 0, 1s;

    transition-property: border-color, z-index;
    -moz-transition-property: border-color, z-index;
    -o-transition-property: border-color, z-index;
    -webkit-transition-property: border-color, z-index;
} 
```

非常感谢任何和所有帮助。提前致谢。

**编辑：**请记住，在过渡有机会完成之前，用户可以在几个不同的边缘上鼠标进入/鼠标离开。谢谢。

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2013-10-11T06:00:06.203

您可以使用延迟，如 Jcubed 建议的那样，或计时功能`step-end`和`step-start`. 诀窍是使用两种不同的[计时函数](https://developer.mozilla.org/en-US/docs/Web/CSS/transition-timing-function)：stepped for`z-index`和 linear for`opacity`以及其他连续属性。

```
edge {
    z-index: -1;
    opacity: 0;
    transition: z-index 0.5s step-end, opacity 0.5s linear;
}

edge.highlight {
    z-index: 1;
    opacity: 1;
    transition: z-index 0.5s step-start, opacity 0.5s linear;
} 
```

示例：http: [//jsfiddle.net/cehHh/8/](http://jsfiddle.net/cehHh/8/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-14T20:19:57.797

使用`transition-delay`. 您可以使它在悬停时上升，但在悬停时等待一段时间，然后在悬停状态下为元素分配不同的延迟时间。

示例：http: [//jsfiddle.net/vQqzK/1/](http://jsfiddle.net/vQqzK/1/)

这适用于chrome，不确定它是否适用于其他浏览器。

[https://developer.mozilla.org/en/CSS/transition-delay](https://developer.mozilla.org/en/CSS/transition-delay)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-14T22:34:44.430

您可以使用两个类，一个用于每个转换（第一个用于颜色，然后用于 z-index）。请注意，为方便起见，以下是使用 jQuery 制作的，并且仅针对一个边缘。要为多个边缘执行此操作，您需要为每个边缘存储一个计时器。

给定以下标记：

```
​&lt;div class="edge"></div>​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​ 
```

CSS：

```
.edge {
    width:40px;
    height:40px;
    border-color: hsl(0, 0%, 40%);
    border-style: solid;
    border-width: (set appropriately in another selector);

    transition-duration: 1s;
    -moz-transition-duration: 1s;
    -o-transition-duration: 1s;
    -webkit-transition-duration: 1s;

    transition-property: border-color;
    -moz-transition-property: border-color;
    -o-transition-property: border-color;
    -webkit-transition-property: border-color;
}

.edge.highlight {
    border-color: hsl(0, 0%, 85%);
    z-index: 1;
}
.edge.endHl{
    border-color: hsl(0, 0%, 65%);
    z-index: 1;
} 
```

（我在第二个过渡中添加了一点颜色变化只是为了显示它）。

以及以下JS：

```
var myTime = null;
function resetTime() {
    if (myTime !== null) {
        clearTimeout(myTime);
        myTime = null;
    }
}
$(".edge").mouseenter(function() {
    resetTime();
    $(this).addClass("highlight");
    $(this).removeClass("endHl");
});
$(".edge").mouseleave(function() {
    resetTime();
    myTime = setTimeout(function() {
        $(".edge").removeClass("endHl");
    },1000);
    $(this).removeClass("highlight");
    $(this).addClass("endHl");
}); 
```

它将仅在 1 秒后删除 z-index，并且仅适用于出口。

你可以在这里看到它的实际效果：http: [//jsfiddle.net/TptP8/](http://jsfiddle.net/TptP8/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-05-18T13:00:00.593

如果您在使用来自 @z0r 的 z-index 过渡解决方案时遇到问题 - 您可以通过动画推迟 z-index 更改作为替代方案，但在 Safari 中过渡对我来说效果更好

```
.hasDelayedZIndex {
  animation: setZIndexWithDelay 0.01s 1s forwards;      
}

@keyframes setZIndexWithDelay {
  to {
    z-index: 1;
  }
} 
```

# c# - 使用锁语句

> ID：10587844
> 
> 赞同：2
> 
> 时间：2012-05-14T17:00:27.750
> 
> 标签：c#, multithreading, bitmap, locking, save

我有一个要保存的位图，并且不断收到“对象当前在其他地方使用”错误。现在我知道 GDI+ 使用线程很糟糕，我应该使用该`lock{}`语句，但它不起作用。我的代码在下面，我做错了什么？

```
Bitmap bitmap = new Bitmap();

lock (bitmap)
{
    bitmap.Save([filepath], ImageFormat.Png);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T17:02:04.980

您不应该锁定您要锁定的对象。您应该创建一个新的引用并锁定它。

```
object bitmapLock = new object();
Bitmap bitmap = new Bitmap();

lock (bitmapLock)
{
    bitmap.Save([filepath], ImageFormat.Png);
} 
```

位图可能会锁定在您无法控制的不同位置。

阅读`lock`此处的声明。

**编辑**您可能必须修改它创建的线程上的位图。

[http://msdn.microsoft.com/en-us/library/c5kehkcz(v=vs.80).aspx](http://msdn.microsoft.com/en-us/library/c5kehkcz(v=vs.80).aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-14T17:03:08.623

您应该锁定其他虚拟对象：

```
var objectForLock = new object()

lock (objectForLock)
{
    Bitmap bitmap = new Bitmap();
    bitmap.Save([filepath], ImageFormat.Png);
} 
```

不确定这是否是您的问题，但这就是`lock`.Net 中的工作方式。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-14T17:01:12.540

您应该在初始化位图之前锁定同步。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-14T17:06:09.543

您需要锁定所有操作，而不仅仅是保存。锁定只是保存不会阻止其他线程操作位图。

请注意，最好按照每个人的建议锁定单独的对象。

```
// class member (or even static) 
private object bitmapLock = new object();

// function 1
lock (bitmapLock)
{
    bitmap.Save([filepath], ImageFormat.Png);
}

// function 2
lock (bitmapLock)
{
   // Draw bitmap
} 
```

# database - 无法手动保存对 RavenDB 文档的更改

> ID：10587845
> 
> 赞同：0
> 
> 时间：2012-05-14T17:00:33.960
> 
> 标签：database, nosql, ravendb

我有一个托管在 IIS 上的 RavenDB。我无法在 ravendb 工作室中手动/直接修改/更改 RavenDB 文档？例如，如果我想将字段值从 1 更改为 2，并尝试保存文档，它不会关闭文档弹出屏幕，也不会保存文档更改。

我检查了 RavenDB 文件夹、web/data 文件夹 - 并取消了只读复选框，但这并没有解决问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T18:58:01.533

必须更改 RavenDB 中的 web.config 文件以允许匿名写访问。变化来自

```
<add key="Raven/AnonymousAccess" value="Get"/> 
```

到

```
<add key="Raven/AnonymousAccess" value="All"/> 
```

# batch-file - 用于删除特定子文件夹的批处理文件

> ID：10587846
> 
> 赞同：0
> 
> 时间：2012-05-14T17:00:35.877
> 
> 标签：batch-file, cmd

我有三个目录，每个目录都包含 8 个子目录，每个子目录都包含 2 个我要删除的文件夹。

结构：

[编辑路径名]

```
C:/Process/CIM
             /AB_CIM
                    /LOG
                    /DATA
             /CC_CIM
                    /LOG
                    /DATA
             /CIM_RD
                    ...
           ...

C:/Process/DIM
             /AB_DIM
                    /LOG
                    /DATA
             /CC_DIM
                    /LOG
                    /DATA
             /DIM_RD
                    ...
             ...

C:/Process/RRS
             ... 
```

`LOG`所以基本上我想删除`DATA`所有这些子目录。我想过使用两个单独的批处理文件来做到这一点***：

第一个批处理文件将包含：

```
call secondBatchFile.cmd CIM
call secondBatchFile.cmd DIM
call secondBatchFile.cmd RRS 
```

现在，我不确定如何编写第二个批处理文件，因为这些子目录有不同的名称（但有一个共同的部分：AB_*、CC_*、*_RD 等）。我想知道是否有人可以帮助我。

提前感谢您的帮助。

*** 使用两个单独的批处理文件执行此操作的原因是，有时我可能需要为其中一个父目录（例如 CIM）保留`LOG`和`DATA`，所以这样我可以只注释掉第一个批处理文件的一行，然后然后运行它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T17:30:37.177

如果您确信其他目录中的 LOG 和 DATA 文件夹不会被拾取，您可以这样做。注释掉下面代码中的实际删除，并`.dat`在执行前查看文件输出。

```
REM Output all LOG and DATA sub-directories into corresponding DAT files
dir /ad/s/b log* > log_directories.dat
dir /ad/s/b data* > data_directories.dat

REM remove every entry listed in log_directories.dat
for /f %%i in (log_directories.dat) do rd/s %%i

REM remove every entry listed in data_directories.dat
for /f %%i in (data_directories.dat) do rd/s %%i 
```

如果你从 运行它`C:`，你可能会得到你不想要的目录。但是假设您的所有目标都分组在一个专用的子目录下（并假设您`.bat`从该专用目录运行），这不会成为问题。

默认情况下，此解决方案会为您提供将要删除的目录的所需日志（尽管每次运行都会覆盖日志）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T17:34:32.043

如果 8 个子文件夹总是相同的模式，即`AB_*, CC_*, *_RD,`等，第二个批处理文件可能是这样的：

```
cd C:\%1%

rmdir AB_%1%\LOG
rmdir AB_%1%\DATA

rmdir CC_%1%\LOG
rmdir CC_%1%\DATA

rmdir %1%_RD\LOG
rmdir %1%_RD\DATA
...

cd c:\ 
```

# objective-c - Core Data Objective C更新Entity的内容

> ID：10587849
> 
> 赞同：0
> 
> 时间：2012-05-14T17:00:47.643
> 
> 标签：objective-c, ios, core-data

我是第一次在这里提问，对不起，我找不到类似的。所以，我需要更新实体“城市”属性中的数据 - @“名称”。例如，在我的核心数据中，我已经有 @"New York"、@"Boston"。通过解析 XML 我有 NSMutableArray *Cities = (@"New York", @"Boston", @"Los Angeles", @"Washington");

```
- (void)configureCell:(UITableViewCell *)cell atIndexPath:(NSIndexPath *)indexPath
{
    NSString *attributeString = @"name";
    NSManagedObject *object = [self.fetchedResultsController objectAtIndexPath:indexPath];
//save to the TableView
cell.textLabel.text = [[object valueForKey:attributeString] description];
if ((indexPath.row + 1) == numberOfSectionsInTableView && (self.isParsingDone))
        [self.insertNewObjectToCities:nil];
//When coredata updating - tableView is also updating automatically

//Here is just adding new data, but I do not know how to update
- (void)insertNewObjectToCities_translation:(id)sender
{
     NSManagedObjectContext *context = [self.fetchedResultsController managedObjectContext];
NSEntityDescription *entity = [[self.fetchedResultsController fetchRequest] entity];
NSManagedObject *newManagedObject = [NSEntityDescription insertNewObjectForEntityForName:[entity name] inManagedObjectContext:context];
NSString *attributeString = @"name";

if (![[self.parseCities.Cities objectAtIndex:i] isEqualToString:[newManagedObject valueForKey:attributeString]])
{
    [newManagedObject setValue:[self.parseCities.Cities objectAtIndex:i] forKey:attributeString];
    NSLog(@"OBBB %@", [self.parseCities.Cities objectAtIndex:i]);
    NSLog(@"dessss %@", [[newManagedObject valueForKey:attributeString] description]);

    i++;

    if (i==[self.parseCities.Cities count]) 
    {
        i = 0;
        return;
    }
    else 
    {
        NSLog(@"valueForKey %@", [newManagedObject valueForKey:attributeString]);
        [self insertNewObjectToCities_translation:nil];
    }
}
else 
{
    NSLog(@"else");
    return;
}

// Save the context.
NSError *error = nil;
if (![context save:&error]) {
    // Replace this implementation with code to handle the error appropriately.
    // abort() causes the application to generate a crash log and terminate. You should not use this function in a shipping application, although it may be useful during development. 
    NSLog(@"Unresolved error %@, %@", error, [error userInfo]);
    abort();
}

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T17:17:04.193

要更新托管对象，首先需要获取它，对 fetched 中的字段进行任何更改`NSManagedObject`，然后保存用于获取对象的上下文。如果`insertNewObjectForEntityForName`再次调用，它每次都会插入一个新的托管对象，即使它已经存在于 Core Data 中。

It's quite slow to fetch a single object every time you need to check and see if a new one needs to be added. You might want to cache the objects you currently have loaded (or their unique identifying field) into an `NSArray` or `NSSet` so you can check that for membership, instead.

# c - C sscanf 读取 32 位整数时出错

> ID：10587850
> 
> 赞同：0
> 
> 时间：2012-05-14T17:00:48.123
> 
> 标签：c, string, scanf

```
 char *pStrBuffer;

   unsigned char data;
   unsigned int Address;

   /* pStrBuffer reading from a file data in file of the form 
     WriteByte(0xDE04,0x20)
     WriteByte(0xFE08,0x50) ....

    */
   /* in a loop */
   sscanf(pStrBuffer,"%x%x",&Address,&data); 
```

编译器是 Windows XP 中的 gnu gcc 4.5 但是为地址读取的值是 0xDE00 而不是 0xDE04 ？为什么会这样，尽管数据的值被正确读取。我也尝试分别使用 %lx 和 %hx 但没用

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T17:20:01.703

要读取单个无符号字节，请使用`%hhx`修饰符。 `%hx`是一个`unsigned short`,`%x`是一个`unsigned int`,`%lx`是一个`unsigned long`,`%llx`是一个 `unsigned long long.

# ios - 为 iOS 创建 OpenFeint 静态库

> ID：10587851
> 
> 赞同：4
> 
> 时间：2012-05-14T17:00:57.173
> 
> 标签：ios, openfeint, cocos2d-x

我正在尝试为 iOS 创建一个 Openfeint 的静态库，以便在只有 C++ 调用的应用程序中使用它。当我尝试运行链接该库的 cocos2d-x 测试项目时，应用程序会因任何 OpenFeint 调用而冻结。但是，如果我不创建库并将源代码直接添加到测试项目中，它就可以完美运行。我正在使用 SDK 5.0、Xcode 4.2 并部署目标 4.2（我认为它并不介意，因为我可以在不创建库的情况下运行它）谢谢，问候！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-05T11:15:09.483

替代方案：使用官方网站上提供的包装器来使用 ScoreLoop，例如 OpenFeint: [HERE](http://www.cocos2d-x.org/projects/cocos2d-x/assets/9)。它是跨平台的，适用于 Android、Blackberry 和 iOS。

# eclipse-rcp - Eclipse RCP 插件视图

> ID：10587852
> 
> 赞同：0
> 
> 时间：2012-05-14T17:00:59.270
> 
> 标签：eclipse-rcp

我有一个具有固定大小的图像（gif）的视图，但是当我重新调整窗口大小或查看它时，它不会根据相应的窗口或视图进行调整。有人可以提出一些解决方案吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T04:49:02.377

这听起来像是一个布局问题 - 您的标签/图像没有被告知“填充”可用空间，而是以自然大小呈现。有关布局的更多信息，请参阅[本文](http://www.eclipse.org/articles/article.php?file=Article-Understanding-Layouts/index.html)，特别是显示此代码示例的区域：

```
gridData.horizontalAlignment = GridData.FILL;
gridData.grabExcessHorizontalSpace = true; 
```

# bash - 在 bash 中，如何打开可外部重定向的可写文件描述符？

> ID：10587857
> 
> 赞同：11
> 
> 时间：2012-05-14T17:01:20.423
> 
> 标签：bash, file-descriptor, io-redirection

我正在尝试使用 bash 打开一个新的描述符来编写额外的诊断消息。我不想使用 stderr，因为 stderr 应该只包含 bash 调用的程序的输出。我还希望我的自定义描述符可以被用户重定向。

我试过这个：

```
exec 3>/dev/tty
echo foo1
echo foo2 >&2
echo foo3 >&3 
```

但是当我尝试重定向 fd 3 时，输出仍会写入终端。

```
$ ./test.sh >/dev/null 2>/dev/null 3>/dev/null
foo3 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-14T18:52:37.067

首先父 shell 将文件描述符 3 设置为 /dev/null
然后你的程序将文件描述符 3 设置为 /dev/tty
所以你的症状并不令人惊讶。

编辑：您可以检查是否已设置 fd 3：

```
if [[ ! -e /proc/$$/fd/3 ]]
then
    exec 3>/dev/tty
fi 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-18T16:42:19.640

很简单：如果父 shell**没有**重定向 fd 3，那么`test.sh`会将 fd 3 重定向到`/dev/tty`.

```
if ! { exec 0>&3; } 1>/dev/null 2>&1; then
   exec 3>/dev/tty
fi
echo foo1
echo foo2 >&2
echo foo3 >&3 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-23T12:30:32.027

这是一种检查文件描述符是否已仅使用 (Bash) shell 设置的方法。

```
(
# cf. "How to check if file descriptor exists?", 
# http://www.linuxmisc.com/12-unix-shell/b451b17da3906edb.htm

exec 3<<<hello

# open file descriptors get inherited by child processes, 
# so we can use a subshell to test for existence of fd 3
(exec 0>&3) 1>/dev/null 2>&1 && 
    { echo bash: fd exists; fdexists=true; } || 
    { echo bash: fd does NOT exists; fdexists=false; }

perl -e 'open(TMPOUT, ">&3") or die' 1>/dev/null 2>&1 && 
    echo perl: fd exists || echo perl: fd does NOT exist

${fdexists} && cat <&3
) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-14T18:45:24.180

**更新**

这是可以做到的。有关最简单的方法，请参见 kaluy 的答案。

**原始答案**

答案似乎是“你不能”。在脚本中创建的任何描述符都不适用于调用该脚本的 shell。

不过，如果有人感兴趣，我想出了如何使用 ruby​​ 来做到这一点。另请参阅使用 perl 的更新。

```
begin
  out = IO.new(3, 'w')
rescue Errno::EBADF, ArgumentError
  out = File.open('/dev/tty', 'w')
end
p out.fileno
out.puts "hello world" 
```

请注意，这显然不适用于守护进程——它没有连接到终端。

更新

如果你不喜欢 ruby​​，你可以简单地从 ruby​​ 脚本中调用一个 bash 脚本。您需要 open4 gem/library 来实现可靠的输出管道：

```
require 'open4'

# ... insert begin/rescue/end block from above

Open4.spawn('./out.sh', :out => out) 
```

更新 2

这是一种使用一点 perl 和主要是 bash 的方法。您必须确保 perl 在您的系统上正常工作，因为缺少 perl 可执行文件也会返回非零退出代码。

```
perl -e 'open(TMPOUT, ">&3") or die' 2>/dev/null
if [[ $? != 0 ]]; then
  echo "fd 3 wasn't open"
  exec 3>/dev/tty
else
  echo "fd 3 was open"
fi
echo foo1
echo foo2 >&2
echo foo3 >&3 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-03-13T16:41:04.607

@Kelvin：这是您要求的修改后的脚本（加上一些测试）。

```
echo '
#!/bin/bash

# If test.sh is redirecting fd 3 to somewhere, fd 3 gets redirected to /dev/null;
# otherwise fd 3 gets redirected to /dev/tty.
#{ exec 0>&3; } 1>/dev/null 2>&1 && exec 3>&- || exec 3>/dev/tty
{ exec 0>&3; } 1>/dev/null 2>&1 && exec 3>/dev/null || exec 3>/dev/tty

echo foo1
echo foo2 >&2
echo foo3 >&3

' > test.sh

chmod +x test.sh

./test.sh
./test.sh 1>/dev/null
./test.sh 2>/dev/null
./test.sh 3>/dev/null
./test.sh 1>/dev/null 2>/dev/null
./test.sh 1>/dev/null 2>/dev/null 3>&-
./test.sh 1>/dev/null 2>/dev/null 3>/dev/null
./test.sh 1>/dev/null 2>/dev/null 3>/dev/tty

# fd 3 is opened for reading the Here String 'hello'
# test.sh should see that fd 3 has already been set by the environment
# man bash | less -Ip 'here string'
exec 3<<<hello
cat <&3
# If fd 3 is not explicitly closed, test.sh will determine fd 3 to be set.
#exec 3>&- 
./test.sh

exec 3<<<hello
./test.sh 3>&- 
```

# java - 升级到 Hibernate 4.1.3 Final 后刷新时抛出 NullPointerException

> ID：10587864
> 
> 赞同：3
> 
> 时间：2012-05-14T17:01:49.153
> 
> 标签：java, hibernate

我刚刚完成了从 Hibernate 3.6 到 4.1.3 Final 的升级，起初一切似乎都很好。但是，我的一位同事最近对此进行了测试，在一个场景中，他从 Hibernate 中抛出了一个 NullPointer（并且在我们为完全相同的数据库升级之前没有抛出这个异常）。这是一个非常奇怪的场景。我们有一个名为 BlogPost 的实体，如下所示，它扩展了一些映射的超类（我也包括在内）：

```
@Entity
@Table(name = "blog_post")
public class BlogPost extends CommunityModelObject implements HasFeedPost {

    @Lob
    private String title;
    @Lob
    private String content;
    @Enumerated
    @Column(nullable = false)
    private CBlogPost.Status status = CBlogPost.Status.UNPUBLISHED;
    // Reference to the feed post that indicates that this blog post has been published
    @OneToOne
    @JoinColumn(name = "feed_post_id")
    private FeedPost feedPost;
    @ManyToOne
    @JoinColumn(name = "posted_by_employee_id")
    private Employee postedBy;

    public String getTitle() {
        return title;
    }

    public void setTitle(String title) {
        this.title = title;
    }

    public String getContent() {
        return content;
    }

    public void setContent(String content) {
        this.content = content;
    }

    public CBlogPost.Status getStatus() {
        return status;
    }

    public void setStatus(CBlogPost.Status status) {
        this.status = status;
    }

    @Override
    public FeedPost getFeedPost() {
        return feedPost;
    }

    @Override
    public void setFeedPost(FeedPost feedPost) {
        this.feedPost = feedPost;
    }

    public Employee getPostedBy() {
        return postedBy;
    }

    public void setPostedBy(Employee postedBy) {
        this.postedBy = postedBy;
    }
}

@Filter(name = "tenantFilter", condition = "(tenant_id = :tenantId or tenant_id is null)")
@MappedSuperclass
public abstract class CommunityModelObject extends ModelObject {

    @IndexedEmbedded(prefix = "tenant", indexNullAs = IndexedEmbedded.DEFAULT_NULL_TOKEN)
    @ManyToOne
    @JoinColumn(name = "tenant_id")
    protected Tenant tenant;

    public Tenant getTenant() {
        return tenant;
    }

    public void setTenant(Tenant tenant) {
        this.tenant = tenant;
    }

    /**
     * If the Tenant is null then it can be accessed / viewed by the entire "community" / user base
     */
    public boolean isCommunityObject() {
        return tenant == null;
    }
}

@MappedSuperclass
public abstract class ModelObject extends BaseModelObject {

    @Id
    @GeneratedValue
    private Long id;

    @Override
    public long getId() {
        return (id == null ? 0 : id);
    }

    public void setId(long id) {
        this.id = (id == 0 ? null : id);
    }
}

@MappedSuperclass
public abstract class BaseModelObject implements java.io.Serializable {

    // This annotation ensures that a column is not associated with this member (simply omitting the @Column annotation is not enough since
    // that annotation is completely optional)
    @Transient
    private boolean doNotAutoUpdateDateUpdated = false;

    @Version
    protected int version;
    @Column(name = "date_created")
    protected Date dateCreated;
    @Column(name = "date_updated")
    protected Date dateUpdated;

    public abstract long getId();

    public int getVersion() {
        return version;
    }

    public void setVersion(int version) {
        this.version = version;
    }

    public Date getDateCreated() {
        return dateCreated;
    }

    public Date getDateUpdated() {
        return dateUpdated;
    }

    /**
     * This will set the dateUpdated to whatever is passed through and it will cause the auto update (pre-update) to NOT occur
     *
     * @param dateUpdated
     */
    public void setDateUpdated(Date dateUpdated) {
        doNotAutoUpdateDateUpdated = true;
        this.dateUpdated = dateUpdated;
    }

    public void touch() {
        // By setting date updated to null this triggers an update which results in onUpdate being called and the nett
        // result is dateUpdated = new Date()
        dateUpdated = null;
    }

    @PrePersist
    protected void onCreate() {
        dateCreated = new Date();
    }

    @PreUpdate
    protected void onUpdate() {
        if (!doNotAutoUpdateDateUpdated) {
            dateUpdated = new Date();
        }
    }

    @Override
    public boolean equals(Object obj) {
        long id = getId();

        if (id == 0) {
            return this == obj;
        }
        //Use Hibernate.getClass() because objects might be proxies
        return obj != null &&
                obj instanceof BaseModelObject &&
                Hibernate.getClass(this) == Hibernate.getClass(obj) &&
                getId() == ((BaseModelObject)obj).getId();
    }

    @Override
    public int hashCode() {
        Long id = getId();
        return id == 0 ? super.hashCode() : id.intValue();
    }

    @Override
    public String toString() {
        return getClass().getSimpleName() + "-" + getId();
    }
} 
```

当我在某些情况下查询 BlogPost 时，会发生最奇怪的事情。例如，如果我单独运行下面的查询，那么它可以正常工作，但是如果我在一堆其他查询中运行它，那么我会得到以下异常：

```
select b from BlogPost b

java.lang.NullPointerException
   at org.hibernate.event.internal.DefaultFlushEntityEventListener.isUpdateNecessary(DefaultFlushEntityEventListener.java:240)
   at org.hibernate.event.internal.DefaultFlushEntityEventListener.onFlushEntity(DefaultFlushEntityEventListener.java:163)
   at org.hibernate.event.internal.AbstractFlushingEventListener.flushEntities(AbstractFlushingEventListener.java:225)
   at org.hibernate.event.internal.AbstractFlushingEventListener.flushEverythingToExecutions(AbstractFlushingEventListener.java:99)
   at org.hibernate.event.internal.DefaultAutoFlushEventListener.onAutoFlush(DefaultAutoFlushEventListener.java:55)
   at org.hibernate.internal.SessionImpl.autoFlushIfRequired(SessionImpl.java:1153)
   at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1208)
   at org.hibernate.internal.QueryImpl.list(QueryImpl.java:101)
   at org.hibernate.ejb.QueryImpl.getResultList(QueryImpl.java:256) 
```

现在更重要的是，如果我从上面列出的所有映射超类中获取所有字段并将它们直接放入 BlogPost 并使 BlogPost 不扩展任何内容并实现 java.io.Serializable ，那么一切都会完美运行。这使我相信该错误与映射的超类或我应用于 CommunityModelObject 的 Hibernate 过滤器有关。

关于如何解决这个问题的任何想法？我假设这是 Hibernate 中新引入的错误，但我可能错了。这给我们带来了重大问题，因为我们需要尽快升级以升级 Hibernate Search，我们需要这样做来修复关键错误。

另请注意，我们使用的数据库是 MySQL，具有以下自定义方言，这是我在进行此升级以处理我们的 BIT 列时编写的：

```
public class MySQL5InnoDBDialectExt extends MySQL5InnoDBDialect {

    private static final String BIT_STRING = "bit";

    public MySQL5InnoDBDialectExt() {
        super();
        registerColumnType(Types.BOOLEAN, BIT_STRING);
    }
} 
```

谢谢，布伦特

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-15T16:30:58.057

我整理了这个问题，侥幸找到了问题。这是我在 Hibernate 论坛上发布的解决方案：

> 我发现了这个问题。它似乎与拦截器无关，而与缓存或检测无关。基本上，我们的应用程序会自动将所有实体包含在我们的缓存方案中一个非常特定的包中，并在我们的检测中包含相同的类。我们通常将所有实体都包含在此包中，但是导致问题的实体是唯一未包含在此包中的实体。我们使用的以前版本的 EhCache / Hibernate 似乎还可以，但升级后它会导致问题。
> 
> 无论如何，实体位于不正确的包中，当我对其进行重构并将其移动到正确的包中时，一切正常！所以这不是 Hibernate 中的错误，只是一个信息异常，使得很难追踪这个问题（我基本上通过完全侥幸解决了它）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-08T07:53:27.703

希望这对某人有所帮助，但就我而言，这是错误仪器的问题。

我有“A”类和两个子类“B”和“C”。“A”类有一个惰性属性，它被用来使惰性访问工作。

但错误是我没有对子类“B”和“C”进行检测，因此从“B”和“C”对检测属性的任何访问都会导致异常。

当我检测“B”和“C”时，问题就消失了。

# java - java - 垃圾收集器如何快速知道哪些对象不再引用它们？

> ID：10587868
> 
> 赞同：24
> 
> 时间：2012-05-14T17:02:06.477
> 
> 标签：java, memory, garbage-collection

我知道在 Java 中，如果一个对象不再有任何对它的引用，垃圾收集器会在一段时间后回收它。

但是垃圾收集器如何知道一个对象有没有关联的引用呢？

垃圾收集器是否使用某种哈希图或表？

* * *

**编辑：**

请注意，我不是在问 gc 通常是如何工作的。真的，我不是在问这个。

我**特别**问gc 如何高效地知道哪些对象是活的，哪些是死的。

这就是为什么我在我的问题中说 gc 维护某种哈希图或集合，并不断更新对象的引用数？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-14T17:06:03.963

典型的现代 JVM 使用几种不同类型的垃圾收集器。

一种经常用于已存在一段时间的对象的类型称为[Mark-and-Sweep](http://www.brpreiss.com/books/opus5/html/page424.html)。它基本上涉及从已知的“活动”对象（所谓的*垃圾收集根*）开始，跟踪所有对象引用链，并将每个可访问对象标记为“活动”。

完成此操作后，*扫描*阶段可以回收那些尚未标记为“活动”的对象。

为了使这个过程正常工作，JVM 必须知道每个对象引用在内存中的位置。这是垃圾收集器[*准确*](http://en.wikipedia.org/wiki/Garbage_collection_%28computer_science%29#Precise_vs._conservative_and_internal_pointers)的必要条件（Java 就是这样）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-14T17:17:52.417

Java 有多种不同的垃圾收集策略，但它们基本上都是通过跟踪哪些对象可以从已知的活动对象中*到达来工作的。*

可以在文章[How Garbage Collection works in Java](http://javarevisited.blogspot.co.uk/2011/04/garbage-collection-in-java.html)中找到一个很好的总结，但对于真正的底层，你应该看看[Tuning Garbage Collection with the 5.0 Java[tm] Virtual Machine](http://www.oracle.com/technetwork/java/gc-tuning-5-138395.html)

> 当一个对象不能再从正在运行的程序中的任何指针访问时，它就被认为是垃圾。最直接的垃圾收集算法只是迭代每个可到达的对象。剩下的任何对象都被视为垃圾。这种方法所花费的时间与活动对象的数量成正比，这对于维护大量活动数据的大型应用程序来说是令人望而却步的。
> 
> 从 J2SE 平台 1.2 版开始，虚拟机结合了许多不同的垃圾收集算法，这些算法使用分代收集进行组合。虽然幼稚的垃圾收集检查堆中的每个活动对象，但分代收集利用大多数应用程序的几个经验观察属性来避免额外的工作。
> 
> 这些观察到的特性中最重要的是婴儿死亡率。...

即，像迭代器这样的许多对象只存在很短的时间，因此*较年轻的*对象比更老的对象更有可能有资格进行垃圾收集。

有关更多最新的调整指南，请查看：

*   [Java SE 6 HotSpot[tm] 虚拟机垃圾收集调优](http://www.oracle.com/technetwork/java/javase/gc-tuning-6-140523.html)
*   [Java 平台标准版 HotSpot 虚拟机垃圾收集调优指南](http://docs.oracle.com/javase/8/docs/technotes/guides/vm/gctuning/index.html)(Java SE 8)

顺便说一句，小心尝试猜测您的垃圾收集策略，我知道许多程序的性能因过度使用`System.gc()`或不适当的`-XX`选项而被破坏。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-14T17:07:40.227

GC 将知道可以尽快删除对象。您不需要管理此过程。

但是你可以非常礼貌地要求 GC 运行 using `System.gc()`。这只是系统的提示。GC 不需要在那个时候运行，它不需要删除你的特定对象等。因为 GC 是大老板，我们（Java 程序员）只是它的奴隶...... :(

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-11-30T20:41:05.180

没有*有效*的方法 - 它仍然需要遍历堆，*但是*有一种 hacky 方法：将堆分成更小的部分（因此不需要扫描整个堆）。这就是我们有分代垃圾收集器的原因，以便扫描花费更少的时间。

当您的整个应用程序停止并且您可以分析对象图时，这相对“容易”回答。这一切都从`GC roots`（我会让你找到这些是什么的文档）开始，但基本上这些都是“根”，不被`GC`.

从这里开始进行某种扫描，分析“活动”对象：与这些根有直接（或传递）连接的对象，因此不可回收。在图论中，这可以通过使用 3 种颜色来“着色/遍历”您的图形：黑色、灰色和白色。`White`表示它*未*连接到根，`grey`表示它的子图尚未遍历，`black`表示已遍历并连接到根。所以基本上要知道现在到底什么是死/活 - 你只需要把你所有最初是白色的堆都涂成黑色。一切都是`white`垃圾。有趣的是，“垃圾”实际上是`GC`通过知道什么是*活着*的来识别的。例如。

但这是一个简单的场景：当您的应用程序完全停止（有时几秒钟）并且您可以扫描堆时。这被称为`STW`停止世界事件，人们通常讨厌这些。这就是并行收集器所做的：停止一切，做任何 GC 必须做的事情（包括寻找垃圾），然后让应用程序线程启动。

当您的应用程序正在运行并且您正在扫描堆时会发生什么？`Concurrently`? `G1/CMS`做这个。想一想：当您的应用程序可以通过不同的线程更改该叶子时，您如何推断图表中的叶子是否存在。

`Shenandoah`例如，通过“拦截”图形上的变化来解决这个问题。在与您的应用程序同时运行时，它将捕获所有更改并将这些更改插入一些线程本地特殊队列，称为`SATB Queues`（请求队列的快照）；而不是直接改变堆。完成后，`STW`将发生一个非常短的事件，并且这些队列将被排空。*仍然*在`STW`计算排水“引起”的情况下，即：图形的额外着色。 *这很简单*，仅供参考。`G1`并`CMS`以不同的方式进行AFAIK。

* * *

所以理论上，这个过程并没有那么复杂，但同时实现它是最具挑战性的部分。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-04-29T12:32:40.117

事实是，垃圾收集器通常*不会*快速知道哪些对象不再有任何传入引用。而且，事实上，即使有传入的引用，一个对象也可能是垃圾。

垃圾收集器使用对象图的遍历来查找可到达的对象。在此遍历中未到达的对象被视为垃圾，即使它们是引用循环的一部分。一个对象不可达与垃圾收集器实际收集该对象之间的延迟可能是任意长的。

# php - Payex 与 PHP 的集成

> ID：10587873
> 
> 赞同：-1
> 
> 时间：2012-05-14T17:02:19.157
> 
> 标签：php, payment-gateway, payment

我必须在我的应用程序中集成 payex 账户 e 支付网关，我已经搜索了一个多星期，但我找不到解释流程的好例子。请建议我一些好的教程来理解 Payex

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T17:04:52.687

他们在[这里](http://pim.payex.com/)有文档和帮助，但您需要登录名和密码才能访问它。您的客户应该能够将其提供给您。

# c# - 将“构建操作”更改为“c# 中的嵌入式资源”

> ID：10587875
> 
> 赞同：4
> 
> 时间：2012-05-14T17:02:56.267
> 
> 标签：c#

如何将更改 .dll 文件构建操作添加到“c# 中的嵌入式资源”。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-14T17:05:02.503

1.  在 Visual Studio 的解决方案资源管理器窗口中，单击要修改的文件。
2.  在 Properties 窗口中，将 Build Action 更改为 Embedded Resource。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-08-22T13:22:25.020

选择资源，然后右键单击它并打开“属性”窗口。在“属性”窗口中，将 BuildAction 设置为“嵌入式资源”

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T17:07:24.870

**使用视觉工作室：**

在“属性”对话框中，找到“生成操作”属性。默认情况下，此属性设置为内容。单击该属性并将 Build Action 属性更改为 Embedded Resource。

**使用命令提示符**

例如：

编译 in.cs 并附加资源文件 rf.resource：

```
csc /resource:rf.resource in.cs 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-05-14T17:06:55.197

在解决方案资源管理器中单击要修改的文件。然后按 F4 或在文件中单击右键，然后选择“属性”选项。在“属性”窗口中，将“构建操作”更改为“嵌入式资源”。

# c++ - new char 实际上是否保证了类类型的对齐内存？

> ID：10587879
> 
> 赞同：60
> 
> 时间：2012-05-14T17:03:15.517
> 
> 标签：c++, c++11, language-lawyer

分配缓冲区，`new char[sizeof(T)]`保证分配与 type 正确对齐的内存`T`，其中所有成员`T`都有其自然的、实现定义的对齐方式（也就是说，您没有使用`alignas`关键字来修改它们的对齐方式）。

我在这里的一些答案中看到了这个保证，但我并不完全清楚标准是如何达到这个保证的。标准的5.3.4-10给出了基本要求：本质上`new char[]`必须对齐`max_align_t`。

我缺少的是那个说`alignof(T)`总是与最大值的有效对齐的位`max_align_t`。我的意思是，这似乎很明显，但是结构的最终对齐方式是否最多`max_align_t`？甚至第 3.11-3 点说可能支持扩展对齐，所以编译器可以自己决定一个类是过度对齐的类型吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-05-14T18:31:10.590

表达式`new char[N]`和`new unsigned char[N]`保证返回与任何对象充分对齐的内存。参见 §5.3.4/10 “[...] 对于 char 和 unsigned char 数组，new-expression 的结果与分配函数返回的地址之间的差异应是最严格的基本对齐要求的整数倍(3.11) 的任何对象类型，其大小不大于正在创建的数组的大小。[注意：因为分配函数被假定返回指向存储的指针，该指针对于具有基本对齐的任何类型的对象进行了适当对齐，这个约束在数组分配开销允许分配字符数组的常见习惯用法，稍后将在其中放置其他类型的对象。-尾注]"。

当然，从风格的角度来看：如果您想要分配原始内存，那么这样说会更清楚：`operator new(N)`. 从概念上讲， `new char[N]`创造`N` `char`；`operator new(N)`分配`N`字节。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-14T17:28:37.020

> 我缺少的是那个说`alignof(T)`总是与最大值的有效对齐的位`max_align_t`。我的意思是，这似乎很明显，但是结构的最终对齐方式是否最多`max_align_t`？甚至第 3.11-3 点说可能支持扩展对齐，所以编译器可以自己决定一个类是过度对齐的类型吗？

正如 Mankarse 所说，我能得到的最好的报价来自**[basic.align]/3**：

> 具有扩展对齐要求的类型是过度对齐类型。[注意：每个过度对齐的类型都是或包含一个应用扩展对齐的类类型（可能通过非静态数据成员）。——尾注]

这似乎意味着必须明确要求扩展对齐（然后传播），但不能

我希望更清楚地提及；对于编译器编写者来说，意图是显而易见的，任何其他行为都是疯狂的，仍然......

# spring-security - 具有 PersistentTokenBasedRememberMeServices 的 Spring Security SessionRegistry

> ID：10587881
> 
> 赞同：2
> 
> 时间：2012-05-14T17:03:20.000
> 
> 标签：spring-security

我的应用程序的 sequrity 系统基于 Spring Sequrity 3.1。我正在使用 PersistentTokenBasedRememberMeServices。

我需要使用 Sessionregistrympl 显示所有登录用户的列表。问题是当站点进入“rememberme-user”时，它的会话在 SessionRegistry 中不存在。

我的配置文件：web.xml

```
<listener>
    <listener-class>
        org.springframework.web.context.ContextLoaderListener
    </listener-class>
</listener>

<listener>
    <listener-class>
        org.springframework.security.web.session.HttpSessionEventPublisher
</listener-class> 
```

和 spring-sequrity.xml：

```
<s:http auto-config="false" entry-point-ref="authenticationEntryPoint" > 

    <s:custom-filter position="FORM_LOGIN_FILTER" ref="authenticationFilter"/>
    <s:custom-filter position="REMEMBER_ME_FILTER" ref="rememberMeFilter" />
    <s:custom-filter position="CONCURRENT_SESSION_FILTER" ref= "concurrencyFilter" />           
    <s:custom-filter position="LOGOUT_FILTER" ref="logoutFilter" />

    <s:intercept-url pattern="/admin/**/" access="ROLE_ADMIN"/>     
    <s:intercept-url pattern="/**/" access="ROLE_USER, ROLE_GUEST"/>        
    <s:anonymous username="guest" granted-authority="ROLE_GUEST" />

</s:http>

<bean 
  id="logoutFilter"
  class="org.springframework.security.web.authentication.logout.LogoutFilter"
  p:filterProcessesUrl="/logout/">
  <constructor-arg value="/login/" />
    <constructor-arg>
    <list>
      <ref bean="rememberMeServices" />
      <bean class="org.springframework.security.web.authentication.logout.SecurityContextLogoutHandler" p:invalidateHttpSession="true"/>
    </list>
    </constructor-arg>
</bean>

<bean id="authenticationEntryPoint"  
    class="org.springframework.security.web.authentication.LoginUrlAuthenticationEntryPoint"
    p:loginFormUrl="/login/"/>

<bean id="customAuthenticationSuccessHandler" 
    class="org.springframework.security.web.authentication.SimpleUrlAuthenticationSuccessHandler"
    p:defaultTargetUrl="/index/" />

<bean id="customAuthenticationFailureHandler" 
    class="org.springframework.security.web.authentication.SimpleUrlAuthenticationFailureHandler"
    p:defaultFailureUrl="/login/error/" />

<bean id="rememberMeServices" 
    class="org.springframework.security.web.authentication.rememberme.PersistentTokenBasedRememberMeServices"
    p:tokenRepository-ref="jdbcTokenRepository"
    p:userDetailsService-ref="hibernateUserService"
    p:key="pokeristStore"
    p:tokenValiditySeconds="1209600" />

<bean id="jdbcTokenRepository" 
    class="org.springframework.security.web.authentication.rememberme.JdbcTokenRepositoryImpl"
    p:dataSource-ref="dataSource"/>

<bean id="rememberMeAuthenticationProvider" class="org.springframework.security.authentication.RememberMeAuthenticationProvider"
    p:key="pokeristStore" />

<bean id="rememberMeFilter" 
    class="org.springframework.security.web.authentication.rememberme.RememberMeAuthenticationFilter"
    p:rememberMeServices-ref="rememberMeServices"
    p:authenticationManager-ref="authenticationManager" />

<bean id="authenticationFilter" class="org.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter"
    p:sessionAuthenticationStrategy-ref="sas"
    p:authenticationManager-ref="authenticationManager"
    p:authenticationFailureHandler-ref="customAuthenticationFailureHandler"
    p:rememberMeServices-ref="rememberMeServices"
    p:authenticationSuccessHandler-ref="customAuthenticationSuccessHandler"/>

<bean id="sas"      class="org.springframework.security.web.authentication.session.ConcurrentSessionControlStrategy"
    p:maximumSessions="1">
    <constructor-arg name="sessionRegistry" ref="sessionRegistry" />
</bean>

<bean id="concurrencyFilter" 
    class="org.springframework.security.web.session.ConcurrentSessionFilter"
    p:sessionRegistry-ref="sessionRegistry" />

<bean id="sessionRegistry" 
    class="org.springframework.security.core.session.SessionRegistryImpl" />

<bean id="passwordEncoder"
    class="org.springframework.security.authentication.encoding.ShaPasswordEncoder">
    <constructor-arg value="256"/>
</bean>

<bean id="saltSource"  
    class="org.springframework.security.authentication.dao.ReflectionSaltSource">  
    <property name="userPropertyToUse" value="username"/>
</bean>

<bean id="hibernateUserService"
    class="com.mysite.service.simple.SecurityUserDetailsService"/>

<s:authentication-manager alias="authenticationManager">    
     <s:authentication-provider user-service-ref="hibernateUserService">            
        <s:password-encoder ref="passwordEncoder">
            <s:salt-source ref="saltSource"/>
        </s:password-encoder>   
    </s:authentication-provider>
    <s:authentication-provider ref="rememberMeAuthenticationProvider" /> 
```

我怎么解决这个问题？

我找到的解决方案之一是在 FilterSecurityInterceptor bean 中将 alwaysReauthenticate 属性设置为“true”，但这会影响网站的性能。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T16:57:40.303

您需要一个`ConcurrentSessionControlStrategy`, 来填充会话注册表。这在手册的[会话管理](http://static.springsource.org/spring-security/site/docs/3.1.x/reference/springsecurity-single.html#concurrent-sessions)部分中进行了描述。如果您想使用普通的 Spring bean，请查看其中的配置示例。请注意，您需要将它注入到两者中，以提供对 the`UsernamePasswordAuthenticationFilter`和`session-management`namespace 元素的相同引用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T11:45:10.423

如果要`SessionRegistry`填充 Spring Security 必须创建会话，请尝试在 Spring Security 配置文件中添加`create-session="always"`标签`<http>`。

# c# - 确切的隐式转换方法放在哪里

> ID：10587882
> 
> 赞同：0
> 
> 时间：2012-05-14T17:03:42.193
> 
> 标签：c#, type-conversion, implicit-conversion, user-defined-types

```
public class Faranheit 
{
    public float Digree { get; set; }

    public Faranheit(float f) 
    {
        Digree = f;
    }

    public static implicit operator Celcius(Faranheit f)
    {
        return new Celcius((5.0f / 9.0f) * (f.Digree - 32));
    }

    public static implicit operator Faranheit(Celcius c)
    {
        return new Faranheit((9.0f / 5.0f) * c.Digree + 32);
    }
} 
```

* * *

```
public class Celcius
{
    public float Digree{get;set;}

    public Celcius(float c)
    {
        Digree = c;
    }

} 
```

我只是很困惑，将转换方法准确地放在哪里..

即使我将一种方法放在一个类中而将另一种方法放在另一个类中，或者我交换它们，或者即使我将它们都放在两个类中的任何一个中，它也能正常工作。

但是如果我把它放在这两个类之外它就不起作用（编译错误）..

可以请有人对此有所了解..

**编辑：**

如果它允许转换方法在任何一个类中，为什么不允许转换方法在单独的类中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T17:14:34.427

重要的是隐式转换存在于两个类之一中。我倾向于将两种转换都放在不太常用的类中。

在这种情况下，类看起来是相等的，所以我将转换*到*每个类中的类，即从 F 到 C 的转换将在摄氏度类中进行，反之亦然。

真的，这主要是关于个人喜好。

在这种特定情况下，我会编写一个温度类，让您获得 C、F、K、R 等的温度。但这与实际问题并不完全相关。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-14T17:08:24.493

我会把它们放在每个班级里。因此，您可以执行以下操作：

```
Celsius c = new Celsius(Value);
Fahrenheit f = c.toFahrenheit();
Celsius newC = f.toCelsius(); 
```

编辑：或者如果你想去 Helper 类路线，你可以这样做：

```
public static class ConvertTemps
{
    public static Celsius toCelsius(Fahrenheit F)
    {
        return new Celsius(5/8* F - 32);
    }
    public static Fahrenheit toFahrenheit(Celsius C)
    {
        return new Fahrenheit(8/5*C + 32);
    }
} 
```

然后您可以执行以下操作：

```
Celsius c = new Celsius(value);
Fahrenheit f = ConvertTemps.toFahrenheit(c); 
```

但我会走第一条路线。

# iphone - 在 iPhone 的钥匙串中存储和访问 x509 证书

> ID：10587883
> 
> 赞同：6
> 
> 时间：2012-05-14T17:03:42.263
> 
> 标签：iphone, ssl, https

第三方应用程序可以访问 iPhone 的钥匙串以添加 X509 证书吗？如果是，怎么做？
如果没有，它可以访问钥匙串只是为了从中读取证书吗？

基本上，我需要的是：
1）我的应用程序需要访问 https 站点，该站点使用的证书未由任何受信任的 CA 签名。尝试通过 https 连接时，出现异常。
2）如果我能以编程方式将根证书添加到钥匙串中，那就太好了；如果用户可以通过 Safari 访问该站点，接受其证书，然后使用我的应用程序访问该站点就足够了。

到目前为止，我一直在使用以下接口来超越 https：

```
@interface NSURLRequest (DummyInterface)
+ (BOOL)allowsAnyHTTPSCertificateForHost:(NSString*)host;
+ (void)setAllowsAnyHTTPSCertificate:(BOOL)allow forHost:(NSString*)host;
@end 
```

但这并不是我想要的。

有什么建议么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-15T10:28:06.110

[此 Apple 文档](http://developer.apple.com/library/ios/#DOCUMENTATION/Security/Conceptual/CertKeyTrustProgGuide/iPhone_Tasks/iPhone_Tasks.html#//apple_ref/doc/uid/TP40001358-CH208-SW13)应记录足够的内容以允许将自签名证书（或自签名证书颁发机构）添加到钥匙串中，并使其受信任。不过我没有测试它。[来源](https://stackoverflow.com/a/5983188/39974)

另请参阅[此问题的最佳答案](https://stackoverflow.com/questions/933331/how-to-use-nsurlconnection-to-connect-with-ssl-for-an-untrusted-cert)。但是，它似乎并没有真正验证证书的有效性。Cocoanetics 还记录[了如何将 NSURLConnection 与自签名证书一起使用](http://www.cocoanetics.com/2010/12/nsurlconnection-with-self-signed-certificates/)，同样似乎也没有验证有效性。

因此，您几乎可以肯定要遵循 Apple 的指示。“从 *.P12 文件中提取和评估身份”部分似乎包含有关如何导入证书的完整示例，即使是受密码保护的证书也是如此。

将它与[“AdvancedURLConnections”示例代码](https://developer.apple.com/library/ios/#samplecode/AdvancedURLConnections/Introduction/Intro.html)和`ServerTrustChallengeHandler`类结合起来，你应该很高兴。

* * *

这也是[Vanja Komadinović 的一个更完整的例子](http://vanjakom.wordpress.com/2011/10/23/https-client-for-ios/)。

# events - 更改元素脚本内的文本

> ID：10587884
> 
> 赞同：0
> 
> 时间：2012-05-14T17:03:48.113
> 
> 标签：events, function, global-variables

我有一个包含 2 个函数的脚本。

第一个函数负责在现有 div 中创建一个段落元素。脚本的第二部分是一个函数，它改变由 onclick 事件触发的预定义文本（文本在第一个函数中预定义）。

HTML：

```
<a href="" onclick="changeText();return false;">Change Text</a>
<div id='box'></div> 
```

Javascript：

```
var x, el;

    window.onload = function createEl() {

       x = document.getElementById('box');
       el = document.createElement('p');
       el.appendChild(document.createTextNode("Hello"));
       x.appendChild(el); 
```

}

```
 function changeText() {
              el.innerHTML = 'other text';
        } 
```

我的问题是：有没有办法达到相同的结果，但不使用全局变量？我知道应该有一个选项只是将变量从一个函数传递到另一个函数然后在那里更新它，但我不知道如何做到这一点

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T17:07:50.573

只需给`p`标签一个 id 并使用`document.getElementById`它来获取它。

# php - 在 PHP 中访问父变量内容

> ID：10587886
> 
> 赞同：0
> 
> 时间：2012-05-14T17:03:52.410
> 
> 标签：php, oop

我正在尝试访问 PHP 中父类的内容，但由于某种原因，它似乎不想通过。我对 OOP 很陌生，所以如果有任何建议，请告诉我。下面是我的代码：

```
class baseQuery {
    public static $numbers = "(1, 2, 3, 4, 5, 6, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 32, 39, 50, 52, 72, 109, 110, 850, 1839, 1968, 1969, 1970, 1972, 1973, 2364, 2365, 3009)";
}

class specificQuery extends baseQuery {
    public function __construct() {
        $numbers = $this->numbers;
    }
    public function test() {
        echo $numbers; //fails
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T17:14:39.820

如果要访问静态成员，则需要使用以下语法：

```
self::$varname 
```

您可以通过使用实际的类名而不是`self`. 就 php 而言，您的`test()`方法正在尝试访问一个名为`$numbers`您尚未声明的变量。如果您不使用`$this->`or`self::`语法，PHP 会假定它是一个本地（或者，如果您真的很危险，则是一个全局）变量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T17:14:02.437

您应该阅读[“后期静态绑定”](http://php.net/manual/en/language.oop5.late-static-bindings.php)。基本上，您将使用 static 关键字访问 numbers 属性。

```
class specificQuery extends baseQuery {
    public function test() {
        echo static::$numbers;
    }
} 
```

我喜欢在 self 上使用 static 因为如果你在扩展原始类的类中设置 $numbers ，它将被访问而不是基类。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T17:10:06.663

在扩展原始类的第二个类中，您正在设置一个常规变量，您需要将其存储在某个地方。

尝试在第二个类中分配一个新的公共变量，将数字存储给他，然后在函数中显示他。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-14T17:13:46.333

```
class baseQuery {
    public static $numbers = "(1, 2, 3, 4, 5, 6, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 32, 39, 50, 52, 72, 109, 110, 850, 1839, 1968, 1969, 1970, 1972, 1973, 2364, 2365, 3009)";
}
class specificQuery extends baseQuery {
    public function __construct() {}

    public function test() {
        echo self::$numbers; // works :)
    }
} 
```

# php - 需要帮助创建带有用于更新 sqlite 表的按钮的 html 表列的 PHP 函数

> ID：10587889
> 
> 赞同：0
> 
> 时间：2012-05-14T17:03:57.707
> 
> 标签：php, sqlite, function, pdo

这就是我用来打印“用户名”表内容的函数：

```
function showtable()
{
  ob_start();  

  $db = new PDO("sqlite:test.db");

  $query = "SELECT * FROM " . $_SESSION['username'] . " ORDER BY `a` DESC;";
  $result = $db->prepare($query);
  $result = $db->query($query);

  print "<table>";
  print "<tr><td>First Column</td><td>Second Column</td><td>Third column</td></tr>";
  foreach ($result as $row)
  {
    print "<tr><td>" . $row['a'] . "</td><td>" . $row['b'] . "</td><td>Here stays the button</td></tr>";
  }  
  print "</table>";

  unset($db);

  ob_end_flush();
} 
```

那么，应该如何看待一个函数，以便在创建 html 表的每一行时，在第三个单元格中插入一个用于更新相应 sqlite 表行的按钮（命名为“此处保留按钮”以便于阅读）？在主浏览器窗口中打开 test.php（添加了 required_once('functions.php')）文件时，我正在调用我的函数，这没什么特别的。

那是 UPDATE 查询：

```
$query = "UPDATE " . $_SESSION['username'] . " SET `c` = '1'" . " WHERE `a` = " . $row['a'] . ";"; 
```

`a`列是整数主键

`b`列是文本

`c`列是整数，所有字段都保存 0 值

PS 不要说 AJAX，我还没准备好（也不喜欢，很多使用 AJAX 的页面滞后于浏览器）。只是询问有关简单 php 函数的想法，该函数通过每行的按钮添加 UPDATE TABLE 功能。

提前致谢 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T17:21:55.923

更新是为了什么？如果 C = 1 会发生什么？

无论如何，对于您的问题，我的建议是使用锚标记。IE

在“按钮在这里”将是`<a href="test.php?a_new='".$row['a']."'">Update</a>`

在你的 test.php

```
if($_GET['a_new'] != '')
{
$query = "UPDATE " . $_SESSION['username'] . " SET `c` = '1'" . " WHERE `a` = ".$_GET['a_new']."";
} 
```

ps你有多余的“;” 在您的查询中。您只在查询语句的末尾添加查询，而不是在其中，即`$sql = "select * from"; not $sql = "select * from;";`

# php - PHP登录安全理念

> ID：10587890
> 
> 赞同：0
> 
> 时间：2012-05-14T17:04:09.323
> 
> 标签：php, security, login

我有一个想法让系统登录用户并验证他们在页面上的登录。
我意识到那里有很多系统，但我主要是好奇我的想法是否有用。我已经进行了一些挖掘，但大多数结果似乎都遗漏了我一直认为重要的做法（如密码加密等）。我可能会更加努力地寻找预制解决方案，因为它可能更安全，但我还没有真正研究过应用程序安全性，并希望得到一些反馈。

当用户登录时，他们的姓名和密码将根据数据库进行验证，密码使用 SHA256 和随机生成的 salt 进行加密，即整个字符串（salt 和加密密码均为 128 个字符。长）。这是密码验证代码：

```
 function ValidatePassword($password, $correctHash)
 {
    $salt = substr($correctHash, 0, 64); //get the salt from the front of the hash
    $validHash = substr($correctHash, 64, 64); //the SHA256

    $testHash = hash("sha256", $salt . $password); //hash the password being tested
    //if the hashes are exactly the same, the password is valid
    return $testHash === $validHash;
} 
```

如果登录有效，则为他们分配一个令牌。该令牌类似于密码加密，但存储了加密的纪元以及另一个随机盐。令牌、登录时间、过期时间和用户名存储在数据库中，用户名和令牌作为会话信息传输。

这是创建令牌的代码：

```
function loginUser($email)
{
  $thetime = time();
  $ip = $_SERVER['REMOTE_ADDR'];

  $dbuser="///";
  $dbpass="///";
  $dbtable="tokens";
  mysql_connect(localhost,$dbuser,$dbpass);
  mysql_select_db("///") or die( "Unable to select database");

  //Generate a salt
  $salt = bin2hex(mcrypt_create_iv(32, MCRYPT_DEV_URANDOM));
  //Hash the salt and the current time to get a random token
  $hash = hash("sha256", $salt . $password);
  //Prepend the salt to the hash
  $final = $salt . $hash;

  $exptime = $thetime + 3600;

  //Store this value into the db
  $query = "INSERT INTO `spanel`.`tokens` VALUES ('$final', $thetime, $exptime,    $thetime, '$ip', MD5('$email') )";
  mysql_query($query) or die ("Could not create token.");

  //Store the data into session vars
  $_SESSION['spanel_email'] = $email;
  $_SESSION['spanel_token'] = $final;

  return true;

} 
```

当他们到达一个页面时，他们拥有的令牌和用户名将根据数据库进行检查。如果检查良好，则更新过期时间并加载页面。这是代码：

```
function validateUser($page)
{
  //Grab some vars
  $thetime = time();
  $ip = $_SERVER['REMOTE_ADDR'];
  $token = $_SESSION['spanel_token'];
  $email = $_SESSION['spanel_email'];

  $dbuser="///";
  $dbpass="///";
  $dbtable="tokens";
  mysql_connect(localhost,$dbuser,$dbpass);
  mysql_select_db("///") or die( "Unable to select database");

  //Global var
  //Get the var for token expire
  $token_expire = 3600;
  //Validate the token
  $query = "SELECT * FROM `tokens` WHERE `token` LIKE '$token' AND `user_id` LIKE   MD5('$email') AND `exp` > $thetime";
  $result = mysql_query($query) or die(mysql_error());
  //Check if we have a valid result
  if ( mysql_num_rows($result) != 1 ) {
    //Logout the user
    //Destroy the session
    session_destroy();
    //Redirect
    header("location: /spanel/login.php?denied=1");
    exit();
    //(Since the token is already invalid, there's no reason to reset it as invalid)
  }
  $row = mysql_fetch_assoc($result);

  //Update the token with our lastseen
  $newexp = $thetime + $token_expire;
  $query = "UPDATE `spanel`.`tokens` SET `exp` = $newexp, `lastseen_ip` = $thetime,    `lastseen_ip` = '$ip' WHERE `token` LIKE '$token'";
  mysql_query($query);

} 
```

感谢反馈（好的和坏的）。就像我说的，我没有做太多的安全工作，希望得到指点。

编辑：我担心我高估了我有效创建登录系统的能力。这么说，我理解你是否决定停止试图找出这个可能是有缺陷的想法的混乱局面。

不过，这里是登录页面的 php 代码。（在这里所说的之后，我意识到只是发布密码是一个很大的禁忌）。

```
 $email = $_POST['email'];
    $password = $_POST['password'];
    $dbuser="///";
    $dbpass="///";
    $dbtable="///";
    mysql_connect(localhost,$dbuser,$dbpass);
    mysql_select_db("spanel") or die( "Unable to select database");
    $query = "SELECT * FROM users WHERE `email` LIKE '$email'";
    $result=mysql_query($query) or die(mysql_error());
    $num=mysql_num_rows($result);
    $row = mysql_fetch_array($result);
    if ( ValidatePassword($password, $row['hash']) == true ) {
      loginUser($email);
      header("location: /spanel/index.php");
    } else {
      echo "<p>Login Failed.</p>";
    } 
```

这是创建帐户时生成密码盐和哈希的位。

```
 function HashPassword($password)
 {
    $salt = bin2hex(mcrypt_create_iv(32, MCRYPT_DEV_URANDOM)); //get 256 random bits in hex
    $hash = hash("sha256", $salt . $password); //prepend the salt, then hash
    //store the salt and hash in the same string, so only 1 DB column is needed
    $final = $salt . $hash; 
    return $final;
} 
```

感谢您的反馈，我很高兴在这里发现了我缺乏知识的问题，而不是在攻击之后。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T18:53:56.963

与[sivann类似，我也看不到额外](https://stackoverflow.com/a/10587959/53114)*spanel_token*的原因。它似乎有效地做的只是确保会话在令牌到期后不再有效。由于条件的*token*和*user_id*的值`WHERE`都存储在会话中，并且仅在登录期间设置，因此它们不会更改。[但是会话过期可以更容易地实现。](https://stackoverflow.com/a/1270960/53114)

* * *

但除此之外，更重要的是：您的代码容易受到 SQL 注入的攻击。有了您在此处发布的知识，这将很容易。您只需执行以下步骤：

*   找出*电子邮件* 中注入的*用户*列数：`UNION SELECT`

     *```
    ' UNION SELECT null, …, null WHERE ''=' 
    ```

    如果输入了错误的列数，您的脚本将引发 MySQL 错误，否则会出现“登录失败”。会出现。感谢那。* 
**   通过使用以下查询：

    ```
    SELECT t1.* FROM users t1 RIGHT JOIN (SELECT email, '000000000000000000000000000000000000000000000000000000000000000060e05bd1b195af2f94112fa7197a5c88289058840ce7c6df9693756bc6250f55' hash FROM users LIMIT 1) t2 USING (email); 
    ```

    该值`000000000000000000000000000000000000000000000000000000000000000060e05bd1b195af2f94112fa7197a5c88289058840ce7c6df9693756bc6250f55`被注入到每条记录中，而不是原始的*哈希*列值。前导`0`s 是盐，其余字符串是空密码字符串的加盐 SHA-256 哈希值，这将产生有效密码。

    因此，我们最终为*密码字段输入了一个空字符串，在**电子邮件*字段中输入以下内容：

    ```
    ' UNION SELECT t2.* FROM users t1 RIGHT JOIN (SELECT email, '000000000000000000000000000000000000000000000000000000000000000060e05bd1b195af2f94112fa7197a5c88289058840ce7c6df9693756bc6250f55' hash FROM users LIMIT 1) t2 USING (email) WHERE ''=' 
    ```* 

 *这应该足以像任何用户一样获得“身份验证”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T17:08:25.893

一方面，这样的散列是不安全的。sha256 很容易被破解，至少对于短密码来说是这样。您必须使用一些[散列拉伸](http://en.wikipedia.org/wiki/Key_stretching)。看看您是否可以找到一些[PBKDF2](http://en.wikipedia.org/wiki/PBKDF2)实现或使用 wikipedia 对 sha256 的“for 循环”的建议。此外，我无法通过拥有更多会话变量来实现您的目标。我不明白 validateuser() 做了什么，它仍然依赖于会话 ID，或者我错过了什么。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-05-14T17:15:11.633

只是评论盐/哈希系统：将盐与密码一起存储在数据库中有点违背了盐渍的目的——如果你的数据库被泄露，从安全的角度来看，盐就变得无用了，因为它可以帮助猜测/打破安全。盐的目的是通过将适当长度的秘密字符串添加到您正在散列的值来增加猜测散列词所需的时间。*

# ruby-on-rails - Rails Routes - 产品和类别的 SEO

> ID：10587891
> 
> 赞同：0
> 
> 时间：2012-05-14T17:04:14.207
> 
> 标签：ruby-on-rails, seo, routes

今天我有像 /products/:permalink 这样的 URI 来展示产品。每个产品都有一个类别，我想为 SEO 获得更好的东西，因为“产品”一词对我不利。

我的愿望是得到“/:category/:permalink”=>“/sports/permalink-of-my-product”。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T18:30:30.380

我怀疑有人比谷歌知道的更多。这是他们[的 SEO 指南](http://www.google.com/webmasters/docs/search-engine-optimization-starter-guide.pdf)。它说：

> 为您网站上的文档创建描述性类别和文件名不仅可以帮助您更好地组织您的网站，**还可以让搜索引擎更好地*抓取*您的文档**。

顺便看看SEO指南的路径：

> [http://www.google.com/webmasters/docs/search-engine-optimization-starter-guide.pdf](http://www.google.com/webmasters/docs/search-engine-optimization-starter-guide.pdf)

完全遵循这个建议！

# java - 在应用程序运行时在 java SWT 应用程序中添加/删除按钮。

> ID：10587892
> 
> 赞同：0
> 
> 时间：2012-05-14T17:04:15.800
> 
> 标签：java, swt

我正在编写一个用于操作自定义 sqlite 数据库的应用程序。DB相当复杂，它具有树状结构。

```
main
--->operator1
------>name
------>address
--->operator2
------>name
------>address
------>tariffs
---------->name
---------->price 
```

我需要有类似“路径”的东西，以便轻松浏览表格并编辑内容......我的数据被组织为 SWT 表。我附加了 SWT.MouseDoubleClick 侦听器。我打算通过双击特定的表格行来“进入”我的操作员数据。问题是，如何回到“主视图”，为此我需要某种导航。我目前的想法是创建一个容器并在其中添加必要的按钮。如同

[鹦鹉螺](http://i.imgur.com/Mqswb.png)

注意，路径被创建为连续的按钮，水平对齐：

```
mentis -> Dropbox -> Photos 
```

最大的问题是如何做到这一点；）

我可以创建一个按钮并将其添加到可能的容器中，但这仅在应用程序启动时才有效。我不知道如何在应用程序运行时向我的容器添加按钮。

在我的主要课程中，我有这样的东西：

```
 Composite pathBarContainer = new Composite(shell, SWT.BORDER);
    pathBarContainer.setSize(shell.getBounds().width, 20);
    pathBarContainer.setLayout(new FillLayout(SWT.HORIZONTAL));
    GridData gridData = new GridData(GridData.HORIZONTAL_ALIGN_FILL);
    gridData.horizontalSpan = 3;
    pathBarContainer.setLayoutData(gridData);

    pathBar = new PathBar(pathBarContainer, shell, contentProvider);
    pathBar.getPathBar(); 
```

这是我的 PathBar 类：

```
import org.eclipse.swt.SWT;
import org.eclipse.swt.layout.GridLayout;
import org.eclipse.swt.widgets.Button;
import org.eclipse.swt.widgets.Composite;
import org.eclipse.swt.widgets.Shell;

public class PathBar {

Composite parent;
Composite pathBar;
Shell mainShell;
ContentProvider contentProvider;
Button mainButton;
Button nextButton;

public PathBar(Composite parent_in, Shell mainShell_in, ContentProvider cp) {

    parent = parent_in;
    mainShell = mainShell_in;
    contentProvider = cp;

    pathBar = new Composite(parent, SWT.BORDER_DOT);
    //pathBar.setSize(100, 300);
    pathBar.setLayout(new GridLayout(10, true));

    mainButton = new Button(pathBar, SWT.PUSH);
    mainButton.setText("main");

}

public Composite getPathBar() {

    return pathBar;
}

public void addMainButton() {
    mainButton = new Button(pathBar, SWT.PUSH);
    mainButton.setText("main");
    pathBar.redraw();
    //parent.redraw();
    //mainShell.redraw();
}

public void addButton() {
    nextButton = new Button(pathBar, SWT.PUSH);
    nextButton.setText("sth");
    pathBar.redraw();
    parent.redraw();
    System.out.println("addButton");
}
} 
```

方法 addMainButton() 和 addButton() 应该从 eventHandler 运行...附加到我的 SWT 表...

如何解决这个问题？请帮助:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T17:44:13.960

添加按钮后，您需要告诉它重做布局。

```
pathBar.layout(true); 
```

# excel - 在标题和数据之间添加空白行

> ID：10587895
> 
> 赞同：1
> 
> 时间：2012-05-14T17:04:19.783
> 
> 标签：excel, vba

我失去了理智，但我看不出我在这里做错了什么，但是每次运行这个宏时，我都会在列标题和实际数据之间不断得到一个空白行。返回的数据是正确的，但我不明白为什么我会在顶部多出一行！

请给我一双新鲜的眼睛好吗！

谢谢

```
Dim LSearchRow As Long
Dim LCopyToRow As Long
Dim wks As Worksheet
On Error GoTo Err_Execute

For Each wks In Worksheets

LSearchRow = 4
LCopyToRow = 4

ThisWorkbook.Worksheets.Add After:=Worksheets(Worksheets.Count)
Set wksCopyTo = ActiveSheet
wks.Rows(3).EntireRow.Copy wksCopyTo.Rows(3)

While Len(wks.Range("A" & CStr(LSearchRow)).Value) > 0

    If wks.Range("AB" & CStr(LSearchRow)).Value = "Yes" And wks.Range("AK" & CStr(LSearchRow)).Value = "Yes" And wks.Range("BB" & CStr(LSearchRow)).Value = "Y" Then

        Rows(CStr(LSearchRow) & ":" & CStr(LSearchRow)).Select
        Selection.Copy

        wksCopyTo.Select
        wksCopyTo.Rows(CStr(LCopyToRow) & ":" & CStr(LCopyToRow)).Select
        wksCopyTo.Paste

        'Move counter to next row
        LCopyToRow = LCopyToRow + 1
        'Go back to Sheet1 to continue searching
        wks.Select
    End If
    LSearchRow = LSearchRow + 1
Wend

Application.CutCopyMode = False
Range("A3").Select
MsgBox "All matching data has been copied."
Next wks
    Exit Sub
Err_Execute:
    MsgBox "An error occurred." 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T18:00:43.190

> > > 请给我一双新鲜的眼睛好吗！

也许是因为您之前缺少工作表名称`Rows(CStr(LSearchRow) & ":" & CStr(LSearchRow)).Select`？

代码执行此行后

`ThisWorkbook.Worksheets.Add After:=Worksheets(Worksheets.Count)`

当前工作表是新工作表，因此它将引用新创建的工作表。稍后`wks.Select`将控件返回到您的主工作表。

所以把它改成

```
wks.Rows(CStr(LSearchRow) & ":" & CStr(LSearchRow)).Select 
```

您的整个子也可以重写为（**UNTESTED**）

```
Option Explicit

Sub Sample()
    Dim LSearchRow As Long, LCopyToRow As Long
    Dim wks As Worksheet, wksCopyTo As Worksheet

    On Error GoTo Err_Execute

    For Each wks In Worksheets
        LSearchRow = 4: LCopyToRow = 4

        With wks
            ThisWorkbook.Worksheets.Add After:=Worksheets(Worksheets.Count)
            Set wksCopyTo = ActiveSheet
            .Rows(3).EntireRow.Copy wksCopyTo.Rows(3)

            While Len(Trim(.Range("A" & LSearchRow).Value)) > 0
                If .Range("AB" & LSearchRow).Value = "Yes" And _
                   .Range("AK" & LSearchRow).Value = "Yes" And _
                   .Range("BB" & LSearchRow).Value = "Y" Then

                    .Rows(LSearchRow).Copy wksCopyTo.Rows(LCopyToRow)

                    LCopyToRow = LCopyToRow + 1
                End If
                LSearchRow = LSearchRow + 1
            Wend
        End With

        MsgBox "All matching data has been copied."
    Next wks

    Exit Sub

Err_Execute:
    MsgBox "An error occurred."
End Sub 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T19:48:48.953

Siddharth 说*可能是正确的，因为您之前缺少工作表名称...*

您的代码设置`wksCopyTo`为`ActiveSheet`，测试数据`wks`然后选择并从中复制`ActiveSheet`。后来在它选择的while循环中`wks`- 这就是为什么只有第一行是空白的

将这五行更改为

```
wks.Rows(CStr(LSearchRow) & ":" & CStr(LSearchRow)).copy wksCopyTo.Rows(CStr(LCopyToRow) & ":" & Str(LCopyToRow)) 
```

# php - Backbone.js model.destroy() 不发送删除请求

> ID：10587897
> 
> 赞同：15
> 
> 时间：2012-05-14T17:04:35.817
> 
> 标签：php, javascript, ajax, model, backbone.js

几天来我一直在尝试让这个工作，我只是不明白为什么当我有我的视图来销毁属于集合的模型（它正确地具有用于开始获取模型数据的 url 属性）时，只有触发销毁“事件”，该事件会冒泡到集合中，以便通过我的列表视图进行绑定。但它根本不会向服务器发送实际的 DELETE 请求或任何请求。在我所见的任何地方，我看到每个人都使用集合的 url attr，或者如果模型未连接到集合，则使用 urlRoot。我什至在实际 this.model.destroy() 之前进行了测试，以检查模型 < console.log(this.model.url());

我没有覆盖主干的破坏或同步方法。此外，每个模型都有一个 id 属性，该属性通过集合的 fetch （来自数据库记录）填充。

销毁发生在列表项视图中，并且集合的“销毁”事件绑定在列表视图中。所有这些都运行良好（事件处理），但问题再次是没有对服务器的请求。

我希望backbone.js 会自动完成。这就是文档所暗示的内容，以及无处不在的众多示例。

非常感谢任何可以提供一些有用意见的人。

仅供参考：我正在 wampserver PHP 5.3.4 上开发。

```
ListItemView = BaseView.extend({

    tagName: "li",

    className: "shipment",

    initialize: function (options) {
        _.bindAll(this);
        this.template = listItemTemplate;   
        this.templateEmpty = listItemTemplateEmpty;
    },  

    events: {
        'click .itemTag' : 'toggleData',
        'click select option' : 'chkShipper',
        'click .update' : 'update',
        'click button.delete' : 'removeItem'
    },  

    // ....

    removeItem: function() {
        debug.log('remove model');

        var id = this.model.id;

        debug.log(this.model.url());

        var options = {
            success: function(model, response) {
                debug.log('remove success');
                //debug.log(model);
                debug.log(response);
                // this.unbind();
                // this.remove();
            },
            error: function(model, response) {
                debug.log('remove error');
                debug.log(response);
            }
        };

        this.model.destroy(options);

        //model.trigger('destroy', this.model, this.model.collection, options);

    }

});

Collection = Backbone.Collection.extend({

    model: Model,

    url: '?dispatch=get&src=shipments',
    url_put : '?dispatch=set&src=shipments',

    name: 'Shipments',  

    initialize: function () {
        _.bindAll(this);
        this.deferred = new $.Deferred();
        /*
        this.fetch({
            success: this.fetchSuccess,
            error: this.fetchError
        });
        */
    },

    fetchSuccess: function (collection, response) {
        collection.deferred.resolve();
        debug.log(response);
    },

    fetchError: function (collection, response) {
        collection.deferred.reject();
        debug.log(response);
        throw new Error(this.name + " fetch failed");
    },

    save: function() {
        var that = this;
        var proxy = _.extend( new Backbone.Model(),
        {
            url: this.url_put,
            toJSON: function() {
                return that.toJSON();
            }
        });
        var newJSON = proxy.toJSON()
        proxy.save(
            newJSON,
            {
                success: that.saveSuccess,
                error: that.saveError
            }
        );
    },

    saveSuccess: function(model, response) {
        debug.log('Save successful');
    },

    saveError: function(model, response) {
        var responseText = response.responseText;
        throw new Error(this.name + " save failed");
    },

    updateModels: function(newData) {
        //this.reset(newData);
    }

});

ListView = BaseView.extend({

    tagName: "ul",

    className: "shipments adminList",

    _viewPointers: {},

    initialize: function() {
        _.bindAll(this);
        var that = this;
        this.collection;
        this.collection = new collections.ShipmentModel();
        this.collection.bind("add", this.addOne);

        this.collection.fetch({
            success: this.collection.fetchSuccess,
            error: this.collection.fetchError
        });

        this.collection.bind("change", this.save);
        this.collection.bind("add", this.addOne);
        //this.collection.bind("remove", this.removeModel);
        this.collection.bind("destroy", this.removeModel);
        this.collection.bind("reset", this.render);
        this.collection.deferred.done(function() {
            //that.render();
            that.options.container.removeClass('hide');
        });             

        debug.log('view pointers');

        // debug.log(this._viewPointers['c31']);
        // debug.log(this._viewPointers[0]);

    },

    events: {

    },

    save: function() {
        debug.log('shipments changed');
        //this.collection.save();
        var that = this;
        var proxy = _.extend( new Backbone.Model(),
        {
            url: that.collection.url_put,
            toJSON: function() {
                return that.collection.toJSON();
            }
        });
        var newJSON = proxy.toJSON()
        proxy.save(
            newJSON,
            {
                success: that.saveSuccess,
                error: that.saveError
            }
        );
    },

    saveSuccess: function(model, response) {
        debug.log('Save successful');
    },

    saveError: function(model, response) {
        var responseText = response.responseText;
        throw new Error(this.name + " save failed");
    },

    addOne: function(model) {
        debug.log('added one');
        this.renderItem(model);
        /*
        var view = new SB.Views.TicketSummary({
            model: model
        });
        this._viewPointers[model.cid] = view;
        */
    },

    removeModel: function(model, response) {
        // debug.log(model);
        // debug.log('shipment removed from collection');

        // remove from server
        debug.info('Removing view for ' + model.cid);
        debug.info(this._viewPointers[model.cid]);
        // this._viewPointers[model.cid].unbind();
        // this._viewPointers[model.cid].remove();
        debug.info('item removed');
        //this.render();
    },

    add: function() {
        var nullModel = new this.collection.model({
            "poNum" : null,
            "shipper" : null,
            "proNum" : null,
            "link" : null
        });
        // var tmpl = emptyItemTmpl;
        // debug.log(tmpl);
        // this.$el.prepend(tmpl);
        this.collection.unshift(nullModel);
        this.renderInputItem(nullModel);                
    },

    render: function () {
        this.$el.html('');
        debug.log('list view render');
        var i, len = this.collection.length;
        for (i=0; i < len; i++) {
            this.renderItem(this.collection.models[i]);
        };
        $(this.container).find(this.className).remove();

        this.$el.prependTo(this.options.container);

        return this;
    },          

    renderItem: function (model) {
        var item = new listItemView({
            "model": model
        });

        // item.bind('removeItem', this.removeModel);

        // this._viewPointers[model.cid] = item;
        this._viewPointers[model.cid] = item;
        debug.log(this._viewPointers[model.cid]);
        item.render().$el.appendTo(this.$el);
    },

    renderInputItem: function(model) {
        var item = new listItemView({
            "model": model
        });
        item.renderEmpty().$el.prependTo(this.$el);
    }

}); 
```

PS .. 同样，有从其他地方引用的代码。但请注意：该集合确实有一个 url 属性集。它确实适用于初始获取以及当触发更改事件以保存对模型所做的更改时。但是列表项视图中的destroy事件，虽然它确实成功触发了“destroy”事件，但它并没有发送“DELETE”HTTP请求。

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2012-12-22T22:30:51.253

> 你的模特有身份证吗？如果没有，则不会发送 HTTP 请求。– nikoshr 5 月 14 日 18:03

非常感谢！Nikoshr 的小评论正是我所需要的。我花了最后 5 个小时来解决这个问题。我只需要在模型中的默认值中添加一个 id。

# c# - 在 Unity 中，是否可以从类型别名解析类型？

> ID：10587900
> 
> 赞同：5
> 
> 时间：2012-05-14T17:04:42.863
> 
> 标签：c#, .net, unity-container

我在 Unity 中注册了几种类型，并为它们提供了类型别名，如下所示：

```
<typeAliases>
   <typeAlias alias="MyType" type="foo.bar.MyType, foo.bar" />
</typeAliases> 
```

是否可以通过使用别名（而不是按类型）从容器中解析这些类型，如下所示：

```
var myType = container.ResolveByTypeAlias("MyType") 
```

我看不到任何方法可以做到这一点，但想知道我是否错过了什么。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-14T17:17:47.617

不，别名仅存在于 XML 配置中。即它们只存在于配置类型中。

[http://msdn.microsoft.com/en-us/library/ff660933(v=pandp.20).aspx](http://bit.ly/JAm6jH)详细说明了这一点

> 别名仅在配置时存在。它们在运行时不可用。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-29T19:49:50.117

供我日后参考——

如果您尝试使用命名参数解析类型，则可以使用 Resolve(string name) *返回为泛型类型 T 注册并具有指定名称的类型的具体实例。*

# r - 更改一个节点的属性

> ID：10587903
> 
> 赞同：2
> 
> 时间：2012-05-14T17:04:50.837
> 
> 标签：r, igraph

如何从其 id 或名称更改颜色标签节点？

例如：我想更改标签颜色节点 name="4" 或 id=3

```
g9<- graph(c(0,1,0,2,0,3,1,4,1,2,3,4,3,5,4,5,5,2),n=6,dir=FALSE)
V(g9)$name<-c(1:6)
V(g9)$label<-V(g9)$name 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T17:44:07.177

`V(g9)$color`是一组颜色。

要更改特定节点的颜色，请说 2： `V(g9)$color[2] ="#343434FF"`

如果您想为每个节点使用不同的颜色，您可以指定`rainbow(n)`其中 n 是节点数，此函数生成一个颜色数组，然后您可以指定：`V(g9)$color=rainbow(9)`

另请注意：要获取顶点或节点的列表，您可以获取它们：`V(g9)` 然后如果您决定更改顶点 5 的颜色，则可以使用`V(g9)$color[which(V(g9)==5)]="#434344"` where，`which(V(g9)==5)`matches 到顶点或节点 5。

# c# - Lambda 范围说明

> ID：10587909
> 
> 赞同：24
> 
> 时间：2012-05-14T17:05:04.227
> 
> 标签：c#, .net, c#-4.0, lambda, scope

为什么我的参数`x`表现如此不稳定？

1.  示例 1 - 当前上下文中不存在。
2.  示例 2 - 无法重用`x`，因为它是在“子”范围内定义的。
3.  示例 3 - 很好。这是我感到困惑的部分。也许是一个不同的“孩子”范围？

**示例 1**：

```
List<int> list = new List<int> { 1, 2, 3, 4, 5 };
var result = list.Where(x => x < 3);
Console.Write(result.ElementAt(x)); 
```

创建此编译时错误：

> 当前上下文中不存在名称“x”

我期望的。

**示例 2**：

```
List<int> list = new List<int> { 1, 2, 3, 4, 5 };
var result = list.Where(x => x < 3);
int x = 1;
Console.Write(result.ElementAt(x)); 
```

产生这个编译时错误：

> 不能在此范围内声明名为“x”的局部变量，因为它会给“x”赋予不同的含义，后者已在“子”范围中用于表示其他内容

我理解这个问题中回答的范围界定，[C# 在 foreach 中重用变量是否有原因？](https://stackoverflow.com/questions/8898925/is-there-a-reason-for-cs-reuse-of-the-variable-in-a-foreach). 然而，这是我以前从未见过的。此外，它还回答了这个问题，[C# 中 lambda 变量的作用域是什么？](https://stackoverflow.com/questions/10494074/what-is-the-scope-of-a-lambda-variable-in-c)，不完整或错误。

**示例 3**：

```
List<int> list = new List<int> { 1, 2, 3, 4, 5 };
List<string> stringList = new List<string> { "A", "B" };
var result = list.Where(x => x < 3);
var result2 = stringList.Where(x => x != "A");

Console.Write(result2); 
```

没有产生错误。

* * *

有了公认的答案，Eric Lippert 的这些博客文章帮助我了解正在发生的事情。如果有人仍然感到困惑：

[**申报空间**](http://blogs.msdn.com/b/ericlippert/archive/2009/08/03/what-s-the-difference-part-two-scope-vs-declaration-space-vs-lifetime.aspx)

[**简单的名字**](http://blogs.msdn.com/b/ericlippert/archive/2009/11/02/simple-names-are-not-so-simple.aspx)

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-05-14T17:10:47.450

其中`Example 1`，x 定义在 lamdba 表达式的局部范围内，对第三行不可见

在`Example 2`中，现在您已经在同一个声明范围内声明了两个名为“x”的变量（可见性不同）

使用 lambda 或匿名方法，它“捕获”它正在运行的范围。如果您在与 lambda 定义相同的范围内有一个本地 x，那么它会“捕获”该 x 以将其拉入 lambda 可以访问的内容中——从而导致“x”的两个定义。您在 lambda 中声明的内容不会在另一个方向上被捕获，因此它在 lambda 之外不可见。

在`Example 3`中，现在您没有使用仅在 lambda 之外的 lambda 本地变量，并且没有在同一声明范围内命名相同的东西。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-14T17:16:56.307

子范围（示例 3）可以使用相同的变量，但父和子不能重新声明变量。

您可以通过以下方式获得相同的结果：

```
// Child scopes
for (int i = 1; i < 10; i++){ /* do something */ }
for (int i = 1; i < 10; i++){ /* do something else */ } 
```

这将失败：

```
// Child and parent
for (int i = 1; i < 10; i++){ /* do something */ }
int i = 33; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-14T17:17:57.280

它并不像看起来那么复杂。

如果为 lamda 表达式定义参数，则该参数仅在 lamda 表达式范围内有效

```
(int x) =>
{
   //x is only valid inside this scope
} 
```

如果第二个变量的定义与 lamda 表达式在同一范围内，则会出现错误，因为第二个变量在 lamda 表达式的范围内也是有效的。

```
void Foo()
{

 int y;

 //y is valid in the scope of foo

 (int x) =>
 {
    //x is only valid inside this scope
    //y is valid in the scope of foo and the lamda expression
 }
} 
```

在第三个示例中，您有 2 个不同的 lamda 表达式，因此有两个不同的范围

# c++ - 我的 SetupDiEnumDeviceInterfaces 不工作

> ID：10587914
> 
> 赞同：6
> 
> 时间：2012-05-14T17:05:27.967
> 
> 标签：c++, device, hid, wdk

我很想知道我这样做是否正确：

```
//DeviceManager.h
#include <windows.h>
//#include <hidsdi.h>
#include <setupapi.h>
#include <iostream>
#include <cfgmgr32.h>
#include <tchar.h>
#include <devpkey.h>

extern "C"{
    #include <hidsdi.h>
}

//#pragma comment (lib, "setupapi.lib")

class DeviceManager
{
public:
    DeviceManager();
    ~DeviceManager();

    void ListAllDevices();
    void GetDevice(std::string vid, std::string pid);

    HANDLE PSMove;
    byte reportBuffer;
private:
    HDEVINFO deviceInfoSet;             //A list of all the devices
    SP_DEVINFO_DATA deviceInfoData;     //A device from deviceInfoSet

    SP_DEVICE_INTERFACE_DATA deviceInterfaceData;
    SP_DEVICE_INTERFACE_DETAIL_DATA deviceInterfaceDetailedData;

};

//DeviceManager.cpp
#include"DeviceManager.h"

DeviceManager::DeviceManager()
{
    deviceInfoSet = SetupDiGetClassDevs(NULL, TEXT("USB"), NULL, DIGCF_PRESENT|DIGCF_ALLCLASSES); //Gets all Devices
}

DeviceManager::~DeviceManager()
{
}

void DeviceManager::ListAllDevices()
{
    DWORD deviceIndex = 0;

    deviceInfoData.cbSize = sizeof(deviceInfoData);

    while(SetupDiEnumDeviceInfo(deviceInfoSet, deviceIndex, &deviceInfoData))
    {
        deviceInfoData.cbSize = sizeof(deviceInfoData);

        ULONG tcharSize;
        CM_Get_Device_ID_Size(&tcharSize, deviceInfoData.DevInst, 0);
        TCHAR* deviceIDBuffer = new TCHAR[tcharSize];   //the device ID will be stored in this array, so the tcharSize needs to be big enough to hold all the info.
                                                        //Or we can use MAX_DEVICE_ID_LEN, which is 200

        CM_Get_Device_ID(deviceInfoData.DevInst, deviceIDBuffer, MAX_PATH, 0); //gets the devices ID - a long string that looks like a file path.

        /*
        //SetupDiGetDevicePropertyKeys(deviceInfoSet, &deviceInfoData, &devicePropertyKey, NULL, 0, 0);
        if( deviceIDBuffer[8]=='8' && deviceIDBuffer[9]=='8' && deviceIDBuffer[10]=='8' && deviceIDBuffer[11]=='8' && //VID
            deviceIDBuffer[17]=='0' && deviceIDBuffer[18]=='3' && deviceIDBuffer[19]=='0' && deviceIDBuffer[20]=='8') //PID
        {
            std::cout << deviceIDBuffer << "\t<-- Playstation Move" << std::endl;
        }
        else
        {
            std::cout << deviceIDBuffer << std::endl;
        }*/

        std::cout << deviceIDBuffer << std::endl;

        deviceIndex++;
    }
}

void DeviceManager::GetDevice(std::string vid, std::string pid)
{

    DWORD deviceIndex = 0;
    deviceInfoData.cbSize = sizeof(deviceInfoData);

    while(SetupDiEnumDeviceInfo(deviceInfoSet, deviceIndex, &deviceInfoData))
    {
        deviceInfoData.cbSize = sizeof(deviceInfoData);

        ULONG IDSize;
        CM_Get_Device_ID_Size(&IDSize, deviceInfoData.DevInst, 0);

        TCHAR* deviceID = new TCHAR[IDSize];

        CM_Get_Device_ID(deviceInfoData.DevInst, deviceID, MAX_PATH, 0);

        if( deviceID[8]==vid.at(0) && deviceID[9]==vid.at(1) && deviceID[10]==vid.at(2) && deviceID[11]==vid.at(3) && //VID
            deviceID[17]==pid.at(0) && deviceID[18]==pid.at(1) && deviceID[19]==pid.at(2) && deviceID[20]==pid.at(3)) //PID
        {
            //DWORD requiredBufferSize;
            //SetupDiGetDeviceInterfaceDetail(deviceInfoSet, &deviceInterfaceData, NULL, 0, &requiredBufferSize, 

            HDEVINFO deviceInterfaceSet = SetupDiGetClassDevs(&deviceInfoData.ClassGuid, NULL, NULL, DIGCF_ALLCLASSES);

            DWORD deviceInterfaceIndex = 0;
            deviceInterfaceData.cbSize = sizeof(deviceInterfaceData);
            while(SetupDiEnumDeviceInterfaces(deviceInterfaceSet, NULL, &deviceInterfaceData.InterfaceClassGuid, deviceInterfaceIndex, &deviceInterfaceData))
            {
                deviceInterfaceData.cbSize = sizeof(deviceInterfaceData);
                std::cout << deviceInterfaceIndex << std::endl;

                deviceInterfaceIndex++;
            }

            //std::cout << deviceInterfaceData.cbSize << std::endl;

            break;
        }

        deviceIndex++;
    }
} 
```

我的 SetupDiEnumDeviceInterfaces（在 GetDevice() 函数中）没有做任何事情。它甚至没有进入while循环。我做错了什么？

## 编辑

我刚刚调用了 GetLastError() 函数，它返回了 259 - ERROR_NO_MORE_ITEMS。设备甚至可能不包含接口吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-15T00:31:16.763

试试这个。

我试图尽可能少地破解你的原始代码；以下代码（至少对我而言）进入内部`while(SetupDiEnumDeviceInterfaces..)`：

```
void DeviceManager::GetDeviceUSB(std::string vid, std::string pid)
{
    DWORD deviceIndex = 0;
    deviceInfoData.cbSize = sizeof(deviceInfoData);

    //buried somewhere deep in the ddk
    static GUID GUID_DEVINTERFACE_USB_HUB={ 0xf18a0e88, 0xc30c, 0x11d0, {0x88, 0x15, 0x00, 0xa0, 0xc9, 0x06, 0xbe, 0xd8} };
    static GUID GUID_DEVINTERFACE_USB_DEVICE ={ 0xA5DCBF10L, 0x6530, 0x11D2, { 0x90, 0x1F, 0x00, 0xC0, 0x4F, 0xB9, 0x51, 0xED } };
    static GUID GUID_DEVINTERFACE_USB_HOST_CONTROLLER={ 0x3abf6f2d, 0x71c4, 0x462a, {0x8a, 0x92, 0x1e, 0x68, 0x61, 0xe6, 0xaf, 0x27}};

    //get usb device interfaces
    HDEVINFO deviceInterfaceSet=SetupDiGetClassDevs(&GUID_DEVINTERFACE_USB_DEVICE, NULL, NULL, DIGCF_DEVICEINTERFACE);

    while(SetupDiEnumDeviceInfo(deviceInterfaceSet, deviceIndex, &deviceInfoData))
    {
        deviceInfoData.cbSize = sizeof(deviceInfoData);

        ULONG IDSize;
        CM_Get_Device_ID_Size(&IDSize, deviceInfoData.DevInst, 0);

        TCHAR* deviceID = new TCHAR[IDSize];

        CM_Get_Device_ID(deviceInfoData.DevInst, deviceID, MAX_PATH, 0);

        if( deviceID[8]==vid.at(0) && deviceID[9]==vid.at(1) && deviceID[10]==vid.at(2) && deviceID[11]==vid.at(3) && //VID
            deviceID[17]==pid.at(0) && deviceID[18]==pid.at(1) && deviceID[19]==pid.at(2) && deviceID[20]==pid.at(3)) //PID
        {
            DWORD deviceInterfaceIndex = 0;
            deviceInterfaceData.cbSize = sizeof(deviceInterfaceData);

            while(SetupDiEnumDeviceInterfaces(deviceInterfaceSet, &deviceInfoData, &GUID_DEVINTERFACE_USB_DEVICE, deviceInterfaceIndex, &deviceInterfaceData))
            {
                deviceInterfaceData.cbSize = sizeof(deviceInterfaceData);
                std::cout << deviceInterfaceIndex << std::endl;

                //get some more details etc
                //DWORD requiredBufferSize;
                //SetupDiGetDeviceInterfaceDetail(deviceInterfaceSet, &deviceInterfaceData, NULL, 0, &requiredBufferSize, 

                deviceInterfaceIndex++;
            }
        }

        deviceIndex++;
    }
} 
```

据我所知，此方法使用与您的 OP 构造函数调用相同的设备*（注意：我包括了一些其他有用的接口 guid）*：

```
deviceInfoSet = SetupDiGetClassDevs(NULL, TEXT("USB"), NULL, DIGCF_PRESENT|DIGCF_ALLCLASSES); //Gets all Devices 
```

但我这样做是为了获取设备*接口*：

```
// /coughs/ you might want to put back the DIGCF_PRESENT flag I removed for testing
HDEVINFO deviceInterfaceSet=SetupDiGetClassDevs(&GUID_DEVINTERFACE_USB_DEVICE, NULL, NULL, DIGCF_DEVICEINTERFACE); 
```

根据文档， 我还通过了`deviceInfoData`to since：`SetupDiEnumDeviceInterfaces`

 *> *指向 SP_DEVINFO_DATA 结构的指针，该结构指定 DeviceInfoSet 中的设备信息元素。此参数是可选的，可以为 NULL。如果指定了此参数，SetupDiEnumDeviceInterfaces 会将枚举限制为指定设备支持的接口。如果此参数为 NULL，则对 SetupDiEnumDeviceInterfaces 的重复调用将返回有关与 DeviceInfoSet 中的所有设备信息元素关联的接口的信息。此指针通常由 SetupDiEnumDeviceInfo 返回。*

## 编辑

根据要求附加说明。您的 USB 设备具有关联的*设置*类**和** *接口*类：

从[设备设置类文档](http://msdn.microsoft.com/en-us/library/windows/hardware/ff549491%28v=vs.85%29.aspx)中：

> *设备安装程序类定义了安装设备所涉及的类安装程序和类共同安装程序*

从[设备接口类文档](http://msdn.microsoft.com/en-us/library/windows/hardware/ff549460%28v=vs.85%29.aspx)：

> *设备接口类是将设备和驱动程序功能导出到其他系统组件（包括其他驱动程序以及用户模式应用程序）的一种方式*

*   [另外，请参阅这个方便的比较](http://msdn.microsoft.com/en-us/library/windows/hardware/ff552240%28v=vs.85%29.aspx)
*   [此外，此相关文档很有用](http://msdn.microsoft.com/en-us/library/windows/hardware/ff541247%28v=vs.85%29.aspx)

所以：

```
deviceInfoSet = SetupDiGetClassDevs(NULL, TEXT("USB"), NULL,DIGCF_PRESENT|DIGCF_ALLCLASSES); 
```

这是检索所有*设置*类信息集并在“USB”上进行过滤

你*可以*这样做：

```
deviceInfoSet = SetupDiGetClassDevs(NULL, NULL, NULL, DIGCF_PRESENT|DIGCF_ALLCLASSES|DIGCF_DEVICEINTERFACE);` 
```

这会检索支持*任何类的**设备接口*的设备的类信息集。（应用emumerator ID s/a“USB”似乎没有影响）。

 *然而，至关重要的是：*`The function adds to the device information set a device information element that represents such a device and then adds to the device information element a device interface list that contains all the device interfaces that the device supports.`*

（***注意：*** `SP_DEVINFO_DATA.ClassGuid`始终*是设备**设置*类的 GUID ）

据我所知，您仍然需要提供*`InterfaceClassGuid`*when invoking `SetupDiEnumDeviceInterfaces()`。老实说，我真的不明白如果调用者提供可选的为什么这是必要的，*`DeviceInfoData`*但由于它都是封闭源代码，我怎么知道？:)

这里是[关于 GUID_DEVINTERFACE_USB_DEVICE的信息](http://msdn.microsoft.com/en-us/library/windows/hardware/ff545972%28v=vs.85%29.aspx)

[免责声明：我不为 M$ 工作；请对以上信息持怀疑态度，当然也要做自己的研究。]

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-30T13:56:39.860

问题从如何调用 SetupDiGetClassDevs 开始。

如果您正在寻找设备路径，请使用 SetupDiGetClassDevs(&GUID_DEVINTERFACE_USB_DEVICE ,,,)

如果在 ClassGuid 中为 SetupDiGetClassDevs 提供了错误的 GUID，则 SetupDiEnumDeviceInterfaces 将失败并显示错误 259，MS 帮助说这是 *指向设备安装程序类或设备接口类的 GUID 的指针。*

包含文件 devguid.h 包含一组 GUID_DEVCLASS 值。这些与您需要的 GUID_DEVINTERFACE_* 值不同**。**

使用包含 ksuuids.h 的 #include <uuids.h>，您可以在其中找到 GUID_DEVINTERFACE_* 值。

我的网站上有更详细的解释，其中包含一些有助于正确枚举 USB 设备的源代码。

请参阅[http://pixcl.com/SetupDiEnumInterfaces_Fail.htm](http://pixcl.com/SetupDiEnumInterfaces_Fail.htm)**

# html - 黑色输入背景 - Cocoa WebView

> ID：10587916
> 
> 赞同：2
> 
> 时间：2012-05-14T17:05:29.417
> 
> 标签：html, css, macos, cocoa

大家早上好，

我一直在开发和维护一个包含 WebView 部分的 Cocoa 应用程序。它是针对 10.5 SDK 构建的，以保持 PPC 兼容性。随着最新的 Safari 更新（随 10.7.4 更新而来），所有 HTML 输入字段现在都有黑色背景。例如，此 HTML 显示如下...

```
Username: <input type="text" name="username" id="something" placeholder="something"/></br> 
Password: <input type="password" name="password" id="somethingelse" placeholder="somethingelse"/> 
```

![在此处输入图像描述](../Images/4879c8f1f0884e95d76409c13ec53ec0.png)

我玩过“背景颜色”风格，也玩过我在[这里](http://css-infos.net/properties/webkit)找到的几个 webkit 风格，但运气不佳。奇怪的是，这个页面通过 Safari 正常显示，而不是通过 Cocoa WebView。有人对尝试的事情有任何建议吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-15T12:56:49.363

我们的应用程序遇到了同样的事情，所以我做了一些挖掘。看起来 WebKit 已更新为使用 NSTextFieldCell 来绘制字段背景，而不是旧的私有 API：

*   [WebKit r104240](http://trac.webkit.org/changeset/104240/trunk/Source/WebCore/rendering/RenderThemeMac.mm)
*   [WebKit r110480](http://trac.webkit.org/changeset/110480/trunk/Source/WebCore/rendering/RenderThemeMac.mm)
*   [WebKit r116697](http://trac.webkit.org/changeset/116697/trunk/Source/WebCore/rendering/RenderThemeMac.mm)

最新版本看起来最接近发布的版本，但并非完全如此（WebCore 二进制文件中缺少 WebCoreTextFieldCell）。由于 10.7.4 源尚未启动，我们假设这已经足够接近了。

重要的一点是 NSTextFieldCell 被设置为使用 [NSColor clearColor] 绘制其背景。当然，想要的效果是让它呈现透明而不掩盖它下面的内容。这假设合成模式设置为 NSCompositeSourceOver。

不幸的是，在 10.6 之前，NSTextFieldCell 使用 NSCompositeCopy [ [4](https://developer.apple.com/library/mac/#releasenotes/Cocoa/AppKitOlderNotes.html) ]。通过检查 SDK 版本来实现与早期应用程序的向后兼容性，这意味着链接到早期 SDK 的应用程序实际上最终会复制清晰的颜色而不是合成它。这最终造成了可怕的黑色混乱。

既然理解了这个问题，我们就可以进入“尝试的事情的建议”部分。这里有一些想法：

*   等待 Apple 意识到他们的错误并发布更新。
*   Swizzle -[NSTextFieldCell drawInteriorWithFrame:inView:] 如果控件视图是 WebHTMLView，则不绘制背景。这听起来很脆弱，可能会对 Mac App Store 产生影响。
*   针对 10.6 SDK 重新编译。

我肯定会选择最后一个选项。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-04T04:29:21.613

也许更安全一些，我发现添加`-webkit-appearance: none;`到输入元素样式也可以。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-18T22:05:50.610

全部。作为临时解决方法，请为您的文本框设置边框样式。这对我有用：border: 1px solid #000000;

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-30T18:35:15.977

另一种解决方法。向输入元素添加一个 css 样式属性：不透明度：0.99；

# windows - 应用程序监听端口

> ID：10587928
> 
> 赞同：0
> 
> 时间：2012-05-14T17:06:16.070
> 
> 标签：windows, networking, network-programming

我有一个我目前正在测试的应用程序，它在端口 1025 上侦听网络上的请求。我任意选择了这个端口并且很容易更改，我担心我的应用程序会与侦听该端口的其他系统进程发生冲突。我的两个主要问题如下：

1.  是否有使用端口 1025 的常见系统进程可能与我的应用程序冲突？
2.  假设 1) 的答案是肯定的，我的应用程序可以安全使用的另一个不太常用的端口或端口范围是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T17:10:21.887

该`49152 – 65535`范围内的任何端口都不能被任何公司注册，因此您更有可能不会遇到任何端口冲突问题。

可以在[此处](http://en.wikipedia.org/wiki/List_of_TCP_and_UDP_port_numbers)的此维基百科链接中找到已注册端口等的列表。

如果您不喜欢 Wikipedia，请查看来自 Internet Assigned Numbers Authority (IANA) 的[此链接。](http://www.iana.org/assignments/service-names-port-numbers/service-names-port-numbers.xml)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-17T06:39:30.013

在大多数情况下都会这样做。例如，如果您需要在同一 IP 地址上运行应用程序的多个实例（侦听器），仍然会发生端口冲突。为了克服这种情况，您可以选择将您的套接字绑定到端口 0（= 任何端口），让系统为您分配端口号。然后，您可以使用 getsockname()（BSD 套接字 API）或等效项来获取系统为套接字分配的实际端口号。它的缺点显然是端口号每次都会改变。需要有一种方法来告诉（手动、编程或系统地）它的监听端口到连接器。事实上，许多 VoIP/点对点应用程序在“集合”服务器的帮助下以这种方式工作。

# ruby-on-rails - 在 ERB 之外使用资产管道

> ID：10587930
> 
> 赞同：0
> 
> 时间：2012-05-14T17:06:38.400
> 
> 标签：ruby-on-rails, asset-pipeline, mustache

有没有办法在 erg 之外使用 rails 资产管道？当我打电话时`stylesheet_link_tag()`，我得到一个正常的`/stylesheets/`链接，而不是`/assets/`我期望的。我怀疑 stache gem 只需要在资产管道中注册一些东西，但我不确定是什么。

我正在使用这个宝石：[https ://github.com/agoragames/stache](https://github.com/agoragames/stache)

我正在使用的代码：

```
module Layouts                                              
  class Application < ::Stache::View                        

  include ActionView::Helpers::AssetTagHelper::StylesheetTagHelpers                                                   

    def title                                               
      'foobar'                                              
    end                                                     

    def stylesheets                                         
      [                                                     
        [stylesheet_link_tag('reset', :media => 'all')]     
      ]                                                     
    end                                                     

    def javascripts                                         
    end                                                     
  end                                                       
end 
```

它正在生成：

```
<link href="/stylesheets/reset.css" media="all" rel="stylesheet" type="text/css" /> 
```

它应该正在生成（它在 erb 模板中执行此操作）：

```
<link href="/assets/reset.css?body=1" media="all" rel="stylesheet" type="text/css" /> 
```

使用导轨 3.2.3。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T20:08:17.553

尝试

```
def stylesheets                                         
   [                                                     
     [stylesheet_link_tag("#{ActionController::Base.helpers.asset_path('reset.css')}", :media => 'all')] 
   ]                                                     
end 
```

另请阅读[https://stackoverflow.com/a/9341764/643500](https://stackoverflow.com/a/9341764/643500)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T18:42:15.730

正确的解决方案是删除：

`include ActionView::Helpers::AssetTagHelper::StylesheetTagHelpers`

线在顶部。

# java - 更新jProgressBar的方法是什么？

> ID：10587931
> 
> 赞同：1
> 
> 时间：2012-05-14T17:06:40.873
> 
> 标签：java, swing, jprogressbar, event-dispatch-thread

我需要在从文件读取并执行一些操作的方法中更新 jProgressBar。我尝试通过这种方法更新进度条：

```
 public void progressUpdate(int percent) {
     System.out.println("Update = "+percent);
     synchronized (jMainProgressBar) {
         jMainProgressBar.setValue(percent);
     }
     SwingUtilities.invokeLater(
         new Runnable() {

             public void run() {
             jMainProgressBar.updateUI();
             jMainProgressBar.repaint();
             }
         });
 } 
```

这只有在方法完成时才有效。但是，如果我通过这种方法不断更新，那么什么也不会发生。

也许有人知道如何改进这种方法？

提供更多建议的 Worker 线程和其他内容也会很好。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T17:08:06.737

你可能想做

```
public void progressUpdate(final int percent) {
     SwingUtilities.invokeLater(new Runnable() {
         public void run() {
             jMainProgressBar.setValue(percent);
         }
     });
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-14T17:18:47.907

不要使用线程。使用定时器。请参考以下内容：

*   [餐巾外观和感觉中的 JProgressBar 不起作用](http://www.coderanch.com/t/566728/GUI/java/JProgressBar-Napkin-look-feel-not)
*   [如何使用进度条](http://docs.oracle.com/javase/tutorial/uiswing/components/progress.html)
*   [http://www.roseindia.net/java/example/java/swing/SwingProgressBar.shtml](http://www.roseindia.net/java/example/java/swing/SwingProgressBar.shtml)
*   **阅读[Swing 中的并发以](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/)获取更多信息**

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-14T18:18:19.460

根据您提供的评论（但不是来自问题！），您正在对事件调度线程 (EDT) 执行繁重的工作。这会阻止该线程并避免执行任何计划的重绘。这就是为什么您只`JProgressBar`在工作完成后才能看到更新的原因，因为那是 EDT 可用于执行重绘的那一刻。

该解决方案已在其他人发布的链接中提供，但基本上归结为：

*   在工作线程上执行工作
*   `JProgressBar`在 EDT上更新进度

实现此目的的两种最常见方法是使用工作线程`SwingWorker`或使用`SwingUtilities.invokeLater`工作线程。

所有相关链接都可以在 Yohan Weerasinghe 的回答中找到

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-10-30T19:36:12.253

**看一下这个**

```
 Timer barTimer;
 barTimer=new Timer(100,new ActionListener()
    {
     public void actionPerformed(ActionEvent e)
       {
        barvalue++;
        if(barvalue>jProgressBar1.getMaximum())
            {
                /* 
                 * To stop progress bar when it reaches 100 just write barTime.stop() 
                 */
               barTimer.stop();
               barvalue=0;

     }
    else
    {
        int a=(int)jProgressBar1.getPercentComplete();
        jProgressBar1.setStringPainted(true);
        jProgressBar1.setValue(barvalue);

      }
   }
    });
    barTimer.start(); 
```

**检查此链接中的代码** [http://java23s.blogspot.in/2015/10/how-to-implement-progress-bar-in-java.html](http://java23s.blogspot.in/2015/10/how-to-implement-progress-bar-in-java.html)

# apache-flex - 使用 flex 在白板应用程序上共享文档

> ID：10587932
> 
> 赞同：0
> 
> 时间：2012-05-14T17:06:44.570
> 
> 标签：apache-flex, document, sharing, whiteboard

我正在使用 flex 创建一个白板应用程序。我想为应用程序添加文档共享功能，即用户可以上传将加载到白板中的文档，并且用户可以对文档进行注释。

我用谷歌搜索了很多，但仍然不知道从哪里开始如何开始。我只知道文档可以在服务器端转换为一系列图像，并且可以加载到 flex 应用程序中。

专家可以帮助我开始这个。我打算在服务器端使用java。

谢谢大家。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T19:29:06.347

我不确定将文件上传到白板本身。我认为最好使用加载器并将白板放在上面。

转换文档的软件怎么样。我不是服务器端程序员，但我可以分享我们用来转换文档的程序：

现在我们对几乎所有文档都使用[Print2Flash](http://print2flash.com/)，但计划让[iSpring](http://www.ispringsolutions.com/)有机会转换 Powerpoint 演示文稿。

两者都是实时项目，经常得到改进，并且可以将文档转换为 swf 文件。就我个人而言，我喜欢**Print2Flash**提供了使用您自己的模式自定义生成的 swf 的能力，并提供了与它交互的极大灵活性。据我所知，现在**iSpring**为转换的文件添加了 AS3 API，这是一个巨大的改进，但它有点贵。

不要忘记[OpenOffice](http://www.openoffice.org/)。它没有那么好的转换器，但至少它是免费的。我们以前使用过它，但更喜欢 Print2Flash。

希望我的回答能给你一个开始的地方。

干杯。

# doctrine - 用 Doctrine 模拟 GC

> ID：10587936
> 
> 赞同：3
> 
> 时间：2012-05-14T17:07:10.950
> 
> 标签：doctrine, doctrine-orm

我的想法是像在 GC 环境中处理简单对象一样无忧无虑地使用数据库（通过 ORM）。

基本思想是`cascade-remove`在表之间的大多数连接上使用，而只是跳过失败的步骤。举个简单的例子：

```
Country (id, name)
1, UK
2, Germany

City (id, name, country)
1, London, 1
2, Brighton, 1
3, Schweinfurt, 2 
```

这样，当您删除 City(3) 时，删除将级联到 Country(2) 并且它也会被删除（因为它不再被引用）。

另一方面，如果您想删除 City(2)，那么 Country(1) 的删除将失败 - 因为 City(1) 仍然引用它 - 并且只会删除 City 实体本身。

问题是 Doctrine 将回滚整个事务，因此 Country 和 City 都不会被删除。有没有办法改变这种行为？

# scala - Akka 上下文监视/取消监视发生前的关系

> ID：10587937
> 
> 赞同：6
> 
> 时间：2012-05-14T17:07:16.163
> 
> 标签：scala, concurrency, actor, akka, happens-before

*我对两个演员（父母* **P**和*孩子* **C**）有以下顺序操作：

1.  **P**看**C** ( `context watch c`)
2.  **P**不看**C** ( `context unwatch c`)
3.  **P**优雅地停止**C** ( `c ! PoisonPill`)

我想知道的是；我能保证**P** *不会收到***C**的`Terminated`事件吗？

 **这是一段示例代码

```
class HappensBefore extends App {
  class C extends Actor { def receive = {} } 
  class P extends Actor {
    val c = context actorOf Props[C]
    context watch c
    context unwatch c
    c ! PoisonPill
    def receive = { case Terminated(child) => println("Oh Noes!") }
  }
  ActorSystem("test") actorOf Props[P]
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-14T17:56:01.427

不，没有这样的保证。**

# java - 春季 3 HelloWorld 程序

> ID：10587939
> 
> 赞同：0
> 
> 时间：2012-05-14T17:07:17.323
> 
> 标签：java, spring

我目前正在尝试启动并运行一个弹簧程序。我正在使用[这个](http://www.roseindia.net/spring/spring3/spring-3-hello-world.shtml)例子来教我如何去做。我已经完成了示例中所说的所有操作，但当我尝试在第 12 步中运行它时，我得到了一个错误。

```
Exception in thread "main" org.springframework.beans.factory.BeanDefinitionStoreException: IOException parsing XML document from class path resource [SpringHelloWorld.xml]; nested exception is java.io.FileNotFoundException: class path resource [SpringHelloWorld.xml] cannot be opened because it does not exist
at org.springframework.beans.factory.xml.XmlBeanDefinitionReader.loadBeanDefinitions(XmlBeanDefinitionReader.java:341)
at org.springframework.beans.factory.xml.XmlBeanDefinitionReader.loadBeanDefinitions(XmlBeanDefinitionReader.java:302)
at org.springframework.beans.factory.xml.XmlBeanFactory.<init>(XmlBeanFactory.java:78)
at org.springframework.beans.factory.xml.XmlBeanFactory.<init>(XmlBeanFactory.java:66)
at net.roseindia.Spring3HelloWorldTest.main(Spring3HelloWorldTest.java:12) 
```

原因：java.io.FileNotFoundException：类路径资源 [SpringHelloWorld.xml] 无法打开，因为它在 org.springframework.beans 的 org.springframework.core.io.ClassPathResource.getInputStream(ClassPathResource.java:158) 中不存在.factory.xml.XmlBeanDefinitionReader.loadBeanDefinitions(XmlBeanDefinitionReader.java:328) ... 4 更多

我对春天真的很陌生，所以我真的不知道发生了什么。我知道在我的课堂上我尝试导入 org.springframework.beans.factory.xml.XmlBeanFactory;，但我认为这是引发错误或导致它不起作用的原因。

如果有人知道出了什么问题，或者一个易于遵循的更好的 Spring 示例，将不胜感激。

摩根

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T17:09:39.623

将该 XML 文件放入您的 CLASSPATH 中。Bean Factory 找不到您的配置文件。

您可以使用 java.exe 的 -cp 选项来执行此操作：

```
java -cp .;<individual-jars>;<directory-where-xml-config-lives> Spring3HelloWorldTest 
```

# python - Python代码监禁

> ID：10587941
> 
> 赞同：8
> 
> 时间：2012-05-14T17:07:25.710
> 
> 标签：python, virtualization, pysandbox

我有一堆 python 项目，其中包含不受信任的 WSGI 应用程序。我需要模拟和安全地运行它们。所以我需要限制目录访问、python 模块的使用以及 CPU 和内存的限制。

我考虑两种方法：

1.  通过 imp-module WSGI-object 从定义的文件中导入，并使用 pysandbox 运行它。现在我`SandboxError: Read only object`在做的时候有：

    ```
    self.config  = SandboxConfig('stdout')
    self.sandbox = Sandbox(self.config)
    self.s = imp.get_suffixes()
    wsgi_obj = imp.load_module("run", open(path+"/run.py", "r"), path, self.s[2]).app
    …
    return self.sandbox.call(wsgi_obj, environ, start_response) 
    ```

2.  修改 Python 解释器，排除潜在风险模块，在并行进程中运行，通过 ZMQ/Unix 套接字进行通信。我什至不知道从哪里开始。

你能推荐什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T17:25:43.300

我将使用 gunicorn 运行您的应用程序，为每个应用程序使用单独的进程和配置，并使用用户级权限（每个不受信任的应用程序在不同的用户上）。每个 gunicorn 实例都将在 localhost 上的用户范围端口上提供服务，而 nginx 或其他网络服务器可以连接到它们以将它们路由并提供给网络。

Heroku 更进一步，在虚拟机中将每个 gunicorn 实例（或 unicorn 或 apache 或任意其他服务器）沙箱化。这可能是最安全的做事方式，并且绝对是可靠地限制 CPU 和内存使用的最佳选择，但根据您的要求，您可能不需要走那么远。

这种方法的一个优点是每个应用程序可以在适当的情况下在不同版本的 Python 上运行；借助虚拟机沙箱，它们甚至可以完全在不同的操作系统上运行。

编辑：要在不使用 VM 沙盒方法的情况下限制内存使用，请参阅[此问题](https://stackoverflow.com/questions/4983120/limit-memory-usage-for-a-single-linux-process)。要限制 CPU 使用率，请调整 gunicorn 设置——允许应用程序使用的每个内核启动一个 gevent 样式的工作程序。

再次编辑：一种完全不同的方法是使用[PyPy 的沙盒机制](http://doc.pypy.org/en/latest/sandbox.html)，它应该比 CPython 加沙盒模块更安全。但是，我更喜欢 guincorn 或 gunicorn + 虚拟机方法。

# ruby-on-rails - 如何使用 rvm 设置默认 ruby

> ID：10587950
> 
> 赞同：8
> 
> 时间：2012-05-14T17:07:55.397
> 
> 标签：ruby-on-rails

它默认为 Mac OS x 附带的 1.8.7。我正在尝试使用 RVM 并使用 1.9.3 我尝试了 rvm use default 并说 -bash: rvm: command not found

我的 bashrc 文件有

```
PATH=$PATH:$HOME/.rvm/bin 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-05-14T17:14:50.573

键入`rvm list`将为您提供您拥有的已安装红宝石的列表，如下所示：

```
 ree-1.8.7-2010.02 [ i686 ]
    ruby-1.8.7-p249 [ i686 ]
    ruby-1.9.2-p180 [ x86_64 ]
    ruby-1.9.2-p180-patched [ x86_64 ]
    ruby-1.9.2-p290 [ x86_64 ]
    ruby-1.9.2-p290-webkit [ x86_64 ]
=*  ruby-1.9.3-p194 [ x86_64 ] 
```

如果您想要的是`ruby-1.9.3-p194`，请输入：

```
rvm --default use  ruby-1.9.3-p194 
```

首先，请注意严格遵循安装说明并确保其正常工作。

您还应该在 bashrc 中看到这一行：

```
[[ -s "$HOME/.rvm/scripts/rvm" ]] && source "$HOME/.rvm/scripts/rvm" 
```

然后尝试打开一个新的 shell 或尝试输入：

```
source ~/.rvm/scripts/rvm 
```

但一般来说，如果您遇到问题，我建议您重新安装 rvm - 它不需要很长时间并且很容易：

```
curl -L get.rvm.io | bash -s stable 
```

# javascript - 按投资组合项目类型过滤

> ID：10587953
> 
> 赞同：2
> 
> 时间：2012-05-14T17:08:02.923
> 
> 标签：javascript, extjs4, rally

看起来投资组合项目上名为“投资组合项目类型”的属性具有对象值，就像“状态”属性一样。但是，我不确定如何将该属性用作过滤器，就像投资组合项目页面上可用的下拉菜单一样。*

我尝试使用单选按钮绑定到值，但这不起作用。那么，我需要使用属性/对象下拉列表吗？

*我还注意到，在初始页面加载后，从“Initiative”或“MRU”切换到另一个时，该下拉列表左侧的“Type”标签消失了。

编辑：看起来我可以为“状态”属性使用属性下拉列表，但不能使用“组合项目类型”。我也尝试将其更改为对象下拉列表，但无济于事。

这是我尝试使用的 javascript 示例：

```
var typeDropdown = new rally.sdk.ui.AttributeDropdown({
    defaultValue : "Initiative",
    label:"Type",
    showLabel:true,
    type : "PortfolioItem",
    attribute : "PortfolioItemType"
}, rallyDataSource);

typeDropdown.display("typeDropdown", dropdownSelectionChanged); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-15T23:07:51.203

如果您使用的是 Rally SDK 1.x，您可以使用以下内容显示投资组合项目类型的下拉列表...

```
var type_config = { label : "Select type: " , type : "Type", attribute : "Name",fetch : "Name,ObjectID"  } ;

var objectDropdown = new rally.sdk.ui.ObjectDropdown(type_config, rallyDataSource);
objectDropdown.display("pi-type", typeChanged); 
```

投资组合项目类型是不同的对象（“类型”的实例），因为它们包含附加信息（序号、看板状态等）。

# xml - 如何将文本读取为 xpath 表达式

> ID：10587955
> 
> 赞同：1
> 
> 时间：2012-05-14T17:08:06.193
> 
> 标签：xml, xslt, xpath, xslt-1.0, xpath-2.0

如果有人可以帮助我找到一种将文本读取为 xpath 表达式的方法，我将不胜感激

例如，这是我的 xml 文档

```
<abc>
    <XYZ>
        <include>/citizen[./marital_status[text() ='married']]</include>
    </XYZ>
</abc> 
```

我正在写一个样式表

```
 <xsl:template match="abc">
        <xsl:call-template name="evaluate">
            <xsl:with-param name="include">
                <xsl:apply-templates select="$include"/>
            </xsl:with-param>
        </xsl:call-template>
    </xsl:template> 
```

这里的问题是，这里的元素文本`<include>`是我想在`<xsl:apply-templates select="$include"/>`. 这会给我已婚的公民，但在这里我只是得到字符串`"/citizen[./marital_status[text() ='married']]"`本身。有没有办法做到这一点？

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T19:59:22.063

检查您选择的 XSLT 处理器中可用的内容：查看它是否具有某种 xx:evaluate() 扩展函数。如果不是，或者如果您想要一个可移植的解决方案，另一种方法是生成一个包含相关表达式的样式表（或样式表模块），然后编译并执行该样式表。

# perl - 如果仍在使用中，如何清理 HTTP::Async

> ID：10587962
> 
> 赞同：2
> 
> 时间：2012-05-14T17:08:34.680
> 
> 标签：perl, http, asynchronous, timeout

我正在使用 Perl 库[HTTP::Async](http://search.cpan.org/~evdb/HTTP-Async-0.10/lib/HTTP/Async.pm)如下：

```
use strict;
use warnings;
use HTTP::Async;
use Time::HiRes;
...
my $async = HTTP::Async->new( ... );
my $request = HTTP::Request->new( GET => $url );
my $start = [Time::HiRes::gettimeofday()];
my $id = $async->add($request);
my $response = undef;
while (!$response) {
  $response = $async->wait_for_next_response(1);
  last if Time::HiRes::tv_interval($start) > TIME_OUT; 
}
... 
```

当`while`循环超时和脚本结束时，我遇到以下错误消息：

```
HTTP::Async object destroyed but still in use at script.pl line 0
HTTP::Async INTERNAL ERROR: 'id_opts' not empty at script.pl line 0 
```

我有哪些选择？如果仍在使用但不再需要，我如何“清理” HTTP::Async 对象？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T17:30:32.247

我建议您`remove`完成请求，但该模块不提供任何接口来执行此操作。

* * *

**选项 1**：添加删除功能。

将以下内容添加到您的脚本中：

```
BEGIN {
    require HTTP::Async;
    package HTTP::Async;

    if (!defined(&remove)) {
        *remove = sub {
            my ($self, $id) = @_;

            my $hashref = $self->{in_progress}{$id}
                or return undef;

            my $s = $hashref->{handle};
            $self->_io_select->remove($s);
            delete $self->{fileno_to_id}{ $s->fileno };
            delete $self->{in_progress}{$id};
            delete $self->{id_opts}{$id};

            return $hashref->{request};
        };
    }

    if (!defined(&remove_all)) {
        *remove_all = sub {
            my ($self) = @_;
            return map $self->remove($_), keys %{ $self->{in_progress} };
        };
    }
} 
```

您应该联系作者，看看他是否可以添加此功能。`$id`是返回的值`add`。

* * *

**选项 2**：使析构函数的所有警告静音。

如果您可以不为所有请求提供服务，那么使警告静音也没有什么坏处。你可以这样做：

```
use Sub::ScopeFinalizer qw( scope_finalizer );

my $async = ...;
my $anchor = scope_finalizer {
    local $SIG{__WARN__} = sub { };
    $async = undef;
};
... 
```

请注意，这将使对象销毁期间发生的所有警告静音，所以我不太喜欢这样。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T12:22:10.600

将 HTTP::Async 子类化以获得更通用的解决方案并不难。我使用它来中止所有待处理的请求：

```
package HTTP::Async::WithFlush;
use strict;
use warnings;    
use base 'HTTP::Async';
use Time::HiRes qw(time);

sub _flush_to_send {
  my $self = shift;
  for my $request (@{ $self->{to_send} }) {
    delete $self->{id_opts}->{$request->[1]};
  }
  $self->{to_send} = [];
}

sub _flush_in_progress {
  my $self = shift;
  # cause all transfers to time out
  for my $id (keys %{ $self->{in_progress} }) {
    $self->{in_progress}->{$id}->{finish_by} = time - 1;
  }
  $self->_process_in_progress;
}

sub _flush_to_return {
  my $self = shift;                                                                 
  while($self->_next_response(-1)) { }
}

sub flush_pending_requests {
  my $self = shift;
  $self->_flush_to_send;
  $self->_flush_in_progress;
  $self->_flush_to_return;
  return;
}

1; 
```

这（也许）比@ikegami 的代码更容易使用模块内部。

# javascript - 在 Meteor 项目中，我们将通过 npm 安装的节点模块放在哪里？

> ID：10587964
> 
> 赞同：10
> 
> 时间：2012-05-14T17:08:41.360
> 
> 标签：javascript, meteor

我跟随 github meteorirc 项目的领导并将它们放在 /public/

我通过 npm 从 /public/ 内部安装了我的节点模块，因此我有一个 /public/node_modules/ 目录。

我不认为这对他们来说是“适当”或“标准”的地方，因为根据 Meteor 文档...

> Meteor 收集所有 JavaScript 文件，不包括客户端和公共子目录下的任何内容，并将它们加载到 Fiber 内的 Node.js 服务器实例中

要加载的代码位于服务器目录和服务器 js 文件中，如下所示。

```
var require = __meteor_bootstrap__.require;

var path = require("path");
var fs = require('fs');
var base = path.resolve('.');
if (base == '/'){
  base = path.dirname(global.require.main.filename);   
}

var Twit;
var twitPath = 'node_modules/twit';
var publicTwitPath = path.resolve(base+'/public/'+twitPath);
var staticTwitPath = path.resolve(base+'/static/'+twitPath);
if (path.existsSync(publicTwitPath)){
  Twit = require(publicTwitPath);
}
else if (path.existsSync(staticTwitPath)){
  Twit = require(staticTwitPath);
}
else{
  console.log('WARNING Twit not loaded. Node_modules not found');
} 
```

根据文档，这不是标准的，我不相信我应该这样做。然而，它既适用于我的开发平台，也适用于 deploymeteor.com 的生产环境。

节点模块应该安装在项目目录结构的哪个位置，以便它们在本地工作以及在meteor.com 或其他地方部署时工作？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-21T09:53:41.610

```
cd /usr/local/meteor/lib/ && npm install <module> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-02-09T13:22:41.427

要在 Meteor 中使用 Npm 模块，请在其中添加 npm 模块。

首先，您需要添加一个 npm 包适配器，例如`meteorhacks:npm`

```
meteor add meteorhacks:npm 
```

然后通过运行启动你的流星应用程序`meteor`，你会注意到`packages.json`你的项目中有一个新文件

添加这样的模块（您需要明确定义一个版本）

```
{
    "request" : "2.53.0"
} 
```

然后你可以在你的流星应用程序中使用 npm 模块，使用`Meteor.npmRequire`而不是`require`

```
var request = Meteor.npmRequire("request") 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-15T16:28:01.820

Meteor`lib/node_modules`从开发包中获取符号链接或将其复制到项目下`server/node_modules`的隐藏`.meteor`子文件夹中。

所以，如果你 cd 进入`lib`开发包的目录或`server`文件夹的`.meteor`目录（我相信它在`build`）；您将能够使用节点模块。如果您在加载它们时遇到问题，您可能需要查看[这个问题](https://stackoverflow.com/questions/10476170/how-can-i-deploy-node-modules-in-a-meteor-app-on-meteor-com)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-28T11:47:54.323

您必须将**捆绑**文件夹添加到路径：

```
var staticTwitPath = path.resolve(base+'/bundle/static/'+twitPath); 
```

这是我在 coffeescript 中的工作示例**， node_modules**在**公共**文件**夹**中：

 ****```
# loading node_modules from public folder
require = __meteor_bootstrap__.require
path    = require("path")
fs      = require('fs')

cheerioPath = 'node_modules/cheerio'

base = path.resolve('.')
if base == '/'
  base = path.dirname(global.require.main.filename)

publicPath = path.resolve(base+'/public/'+cheerioPath)
staticPath = path.resolve(base+'/bundle/static/'+cheerioPath)

if path.existsSync(publicPath)
  cheerio = require(publicPath)
else if path.existsSync(staticPath)
  cheerio = require(staticPath)
else
  console.log('node_modules not found') 
```

祝你好运！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-31T11:38:35.327

这对我有很大帮助，包括语法高亮包！谢谢！

不过我使用了一个小助手，因为我认为这不会是我将使用的最后一个 npm 包；）

```
meteorNpm = do() ->
  require = __meteor_bootstrap__.require

  path    = require 'path'
  fs      = require 'fs'

  base = path.resolve '.'
  if base is '/'
    base = path.dirname global.require.main.filename

  meteorNpm =
    # requires npm modules placed in `public/node_modules`
    require: (moduleName) ->
      modulePath = 'node_modules/' + moduleName

      publicPath = path.resolve(base + '/public/' + modulePath)
      staticPath = path.resolve(base + '/bundle/static/' + modulePath)

      if path.existsSync(publicPath)
        module = require publicPath
      else if path.existsSync(staticPath)
        module = require staticPath
      else
        module = null

      return module 
```

像这样使用它：

```
highlight = meteorNpm.require "highlight.js" 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-19T00:53:13.347

我正在使用[这样的脚本](https://github.com/peerlibrary/meteor-pdf.js/blob/dd85c069e5d94a12f0a2e55ffa29e8b566e62d0b/bootstrap.coffee)，它可以很好地安装所有 node.js 依赖项。它的行为类似于 Meteor 引擎分支中的官方支持（它在运行时安装依赖项），但它也支持从 git 存储库和类似的好东西安装。****

# android - Android 未发现 Bluez 服务

> ID：10587967
> 
> 赞同：2
> 
> 时间：2012-05-14T17:08:48.247
> 
> 标签：android, bluetooth, bluez

我不知道会发生什么。我有一个使用 BlueZ 在我的笔记本电脑上开发的蓝牙应用程序。我已经设法创建了一个使用 Bluez 连接到该服务器的客户端，但我无法使用 Android 这样做。

手机似乎找不到设备/端口/服务：

```
05-14 18:54:40.395: D/BluetoothService(134): Cleaning up failed UUID channel lookup:   00:02:72:00:D4:29 00000000-0000-0000-0000-000033320000  
05-14 18:54:40.395: W/System.err(4895): java.io.IOException: Service discovery failed 
```

找到以下部分 Bluez 服务器和 Android 的代码：

**蓝兹**

```
sdp_session_t *register_service() {
     uint32_t service_uuid_int[] = { 0, 0, 0, 0x3233 };
     .... code taken from http://people.csail.mit.edu/albert/bluez-intro/x604.html
}

int main() 
{
    sdp_session_t *session = register_service();

    struct sockaddr_rc loc_addr = { 0 }, rem_addr = { 0 };
    char buf[1024] = { 0 };
    int s, client, bytes_read;
    socklen_t opt = sizeof(rem_addr);

    char src[18] = "XX:XX:XX:XX:XX:XX";

    // allocate socket
    s = socket(AF_BLUETOOTH, SOCK_STREAM, BTPROTO_RFCOMM);

    // bind socket to port 1 of the first available 
    // local bluetooth adapter
    loc_addr.rc_family = AF_BLUETOOTH;
    str2ba(src, &loc_addr.rc_bdaddr);
    //loc_addr.rc_bdaddr = *BDADDR_ANY;
    loc_addr.rc_channel = (uint8_t) 11;
    bind(s, (struct sockaddr *)&loc_addr, sizeof(loc_addr));

    // put socket into listening mode
    listen(s, 1);

    // accept one connection
    client = accept(s, (struct sockaddr *)&rem_addr, &opt);
    ba2str( &rem_addr.rc_bdaddr, buf );
    fprintf(stderr, "accepted connection from %s\n", buf);
    memset(buf, 0, sizeof(buf));

    // read data from the client
    bytes_read = read(client, buf, sizeof(buf));
    if( bytes_read > 0 ) {
        printf("received [%s]\n", buf);
    }

    // close connection
    close(client);
    close(s);
    return 0;
} 
```

运行`sdptool`以检查服务是否已正确注册，我发现 UUID 与预期的不同。我在我的 android 应用程序上尝试了几个。

### 的输出`sdptool browse --tree local`

```
UUID128 : 0x00000000-0000-0000-0000-00003332-0000 
```

### 安卓

```
/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    BluetoothAdapter mBluetoothAdapter =
            BluetoothAdapter.getDefaultAdapter();
    if (mBluetoothAdapter == null) {
        // Device does not support Bluetooth
        Log.d(TAG, "No bluetooth");
    }

    Log.d(TAG, "Generated bluetooth adapter");

    MY_UUID = UUID.fromString("00000000-0000-0000-0000-000033320000");

    // Get a BluetoothSocket to connect with the given BluetoothDevice
    try {
            device = mBluetoothAdapter.getRemoteDevice(remote_addr);
        socket =
                device.createInsecureRfcommSocketToServiceRecord(MY_UUID);
        mBluetoothAdapter.cancelDiscovery();            
        socket.connect();

                OutputStream tmpOut = null;
                    tmpOut = socket.getOutputStream();

                    String str = "Helloo";
                tmpOut.write(str.getBytes());

                    socket.close();
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } 
```

结果是我在调用时遇到异常`connect()`：

```
05-14 18:54:40.395: D/BluetoothService(134): Cleaning up failed UUID channel lookup: XX:XX:XX:XX:XX:XX 00000000-0000-0000-0000-000033320000
05-14 18:54:40.395: W/System.err(4895): java.io.IOException: Service discovery failed 
```

任何帮助都非常受欢迎。我认为问题在于未正确定义但不知道的 UUID。

助教。

# ios - 反向地理编码功能未执行？

> ID：10587968
> 
> 赞同：2
> 
> 时间：2012-05-14T17:08:50.057
> 
> 标签：ios, ios5, geocoding, reverse-geocoding

我正在尝试使用反向地理编码，但该功能没有执行，也不确定为什么..

在这里，我附上了我的代码。感谢您的帮助

```
//-- reverse geocode, converting from point to address 
- (BNRMapPoint *)geocodeLocation:(CLLocation *)location title:(NSString *)title

{
    if(!geocoder)
    {
        geocoder = [[CLGeocoder alloc] init];
    }

    __block BNRMapPoint * annotation;

    [self.geocoder reverseGeocodeLocation:location completionHandler: 
     ^(NSArray * placeMarks, NSError * errors)
     {
         NSLog(@"in block code");
         if([placeMarks count] > 0)
         {
             NSLog(@"%@", [placeMarks objectAtIndex:0]);
             annotation = [[BNRMapPoint alloc] initWithCoordinate:location.coordinate title:title
                                                    placeMark:[placeMarks objectAtIndex:0]];
             NSLog(@"%@", annotation.placeMark.name);
         }
         else
         {
             NSLog(@"failed!!");
         }

     }];

    return annotation;
} 
```

它没有在控制台打印任何东西..所以我认为它没有输入块代码。但我真的很困惑为什么它没有进入。再次感谢你的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T17:52:26.207

我似乎记得`NSLog`在传递给`reverseGeocodeLocation`. 地理编码器在一个单独的线程上执行，正如我期望的块一样。（如果我错了，我相信有人会纠正我）。就我而言，我*认为*`UIAlertView 即使在块代码中也能正常工作，所以你可以试试......

我根据正在使用的应用程序查看了您的代码，但`reverseGeocodeLocation`我没有发现您的代码有问题。唯一的区别是我`if (![geocoder isGeocoding])...`在执行 reverseGeocode 之前进行了检查。这只是为了防止 geoCoder 调用堆积，这在您的应用程序中可能无法实现，具体取决于您的代码被调用的方式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T17:47:44.490

可能 self.geocoder = nil？

代替

```
if(!geocoder)
{
    geocoder = [[CLGeocoder alloc] init];
} 
```

和

```
if(!self.geocoder)
{
    self.geocoder = [[CLGeocoder alloc] init];
} 
```

# python - PyQt4 中的进度条问题

> ID：10587971
> 
> 赞同：2
> 
> 时间：2012-05-14T17:09:02.817
> 
> 标签：python, pyqt4

我开发了一个 GUI，用于从文件中提取一些数据。这个过程需要很长时间。在程序处理外部文件期间（使用 subprocess.Popen），主 GUI 将不会响应（如预期的那样）。我想向用户添加一条带有摆动进度条的消息，让他知道程序正在运行，并且只是挂在那里。我将进度条实现为 QDialog，然后在调用长进程之前调用它。如果我使用 [dialog.exec_()] 方法调用进度条，那么程序会等待我的响应，这是对话的结果。如果我关闭对话框，程序将继续运行，而不会显示我想要显示的进度消息。如果我使用 [dialog.show()] 方法，那么我看到的只是一个空白的白色窗口，进度条应该在哪里。
我对此尝试了多种变体，但没有成功。

我在用：

```
Python 2.7.2
PyQt4: 4.9.1
Windows 7 
```

这是显示问题的示例代码。在 dialog.exec() 和 dialog.show() 之间切换以演示问题。

* * *

```
import sys
import time
from PyQt4 import QtCore, QtGui
from PyQt4.QtCore import pyqtSignature

try:
    _fromUtf8 = QtCore.QString.fromUtf8
except AttributeError:
    _fromUtf8 = lambda s: s

class LongProcess(QtGui.QMainWindow):
    def __init__(self, parent=None):
        super(LongProcess, self).__init__(parent)
        self.setup(self)

    def setup(self, MainWindow):
        MainWindow.setObjectName(_fromUtf8("MainWindow"))
        MainWindow.resize(255, 208)
        MainWindow.setMinimumSize(QtCore.QSize(300, 208))
        MainWindow.setMaximumSize(QtCore.QSize(300, 208))
        self.centralwidget = QtGui.QWidget(MainWindow)
        self.centralwidget.setObjectName(_fromUtf8("centralwidget"))
        self.verticalLayout = QtGui.QVBoxLayout(self.centralwidget)
        self.verticalLayout.setObjectName(_fromUtf8("verticalLayout"))
        self.textEdit = QtGui.QTextEdit(self.centralwidget)
        self.textEdit.setObjectName(_fromUtf8("textEdit"))
        self.verticalLayout.addWidget(self.textEdit)
        self.pushButton = QtGui.QPushButton(self.centralwidget)
        self.pushButton.setObjectName(_fromUtf8("pushButton"))
        self.verticalLayout.addWidget(self.pushButton)
        MainWindow.setCentralWidget(self.centralwidget)

        MainWindow.setWindowTitle(QtGui.QApplication.translate("MainWindow", "MainWindow", None, QtGui.QApplication.UnicodeUTF8))
        self.textEdit.setHtml(QtGui.QApplication.translate("MainWindow", "<!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 4.0//EN\" \"http://www.w3.org/TR/REC-html40/strict.dtd\">\n"
                                                           "<html><head><meta name=\"qrichtext\" content=\"1\" /><style type=\"text/css\">\n"
                                                           "p, li { white-space: pre-wrap; }\n"
                                                           "</style></head><body style=\" font-family:\'MS Shell Dlg 2\'; font-size:8.25pt; font-weight:400; font-style:normal;\">\n"
                                                           "<p style=\" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\"><span style=\" font-size:8pt;\">We want to run a long process in the background (calling a subprocess) and use an oscillating progress bar to show that the process is running. </span></p>\n"
                                                           "<p style=\"-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:8pt;\"><br /></p>\n"
                                                           "<p style=\" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\"><span style=\" font-size:8pt;\">When long process ends, we will close the oscillating progress bar. </span></p></body></html>", None, QtGui.QApplication.UnicodeUTF8))
        self.pushButton.setText(QtGui.QApplication.translate("MainWindow", "Run Long Process", None, QtGui.QApplication.UnicodeUTF8))
        QtCore.QMetaObject.connectSlotsByName(MainWindow)

    @pyqtSignature("")
    def on_pushButton_clicked(self):
        '''
            Simulate some long process to be performed.
            Before Long Process starts, show an oscillating progress bar to
            indiate process is running in background. 
        '''
        dialog = QtGui.QDialog()    
        progressBar = Ui_porcessProgress()
        progressBar.setupUi(dialog)
        dialog.show()
#        dialog.exec_()

        start = time.time()
        diff = 0
        while diff < 10:
            end = time.time()
            diff = end - start
            print (diff)

class Ui_porcessProgress(object):
    def setupUi(self, porcessProgress):
        porcessProgress.setObjectName(_fromUtf8("porcessProgress"))
        porcessProgress.setWindowModality(QtCore.Qt.ApplicationModal)
        porcessProgress.resize(329, 81)
        porcessProgress.setMinimumSize(QtCore.QSize(329, 81))
        porcessProgress.setMaximumSize(QtCore.QSize(329, 81))
        icon = QtGui.QIcon()
        icon.addPixmap(QtGui.QPixmap(_fromUtf8(":/WFT/wftlogo2.png")), QtGui.QIcon.Normal, QtGui.QIcon.Off)
        porcessProgress.setWindowIcon(icon)
        porcessProgress.setModal(True)
        self.verticalLayout = QtGui.QVBoxLayout(porcessProgress)
        self.verticalLayout.setObjectName(_fromUtf8("verticalLayout"))
        self.label = QtGui.QLabel(porcessProgress)
        self.label.setObjectName(_fromUtf8("label"))
        self.verticalLayout.addWidget(self.label)
        self.porcessProgressBar = QtGui.QProgressBar(porcessProgress)
        self.porcessProgressBar.setMaximum(0)
        self.porcessProgressBar.setProperty("value", 10)
        self.porcessProgressBar.setTextVisible(False)
        self.porcessProgressBar.setObjectName(_fromUtf8("porcessProgressBar"))
        self.verticalLayout.addWidget(self.porcessProgressBar)
        porcessProgress.setWindowTitle(QtGui.QApplication.translate("porcessProgress", "Please wait...", None, QtGui.QApplication.UnicodeUTF8))
        self.label.setText(QtGui.QApplication.translate("porcessProgress", "Time History data extraction from ODB file in progress...", None, QtGui.QApplication.UnicodeUTF8))
        QtCore.QMetaObject.connectSlotsByName(porcessProgress)
#
#------------------------------------------------------------------------------ 
#
def main():
    app = QtGui.QApplication(sys.argv)
    mainWindow = LongProcess()
    mainWindow.show()
    sys.exit(app.exec_())
#
#------------------------------------------------------------------------------ 
#
if __name__ == "__main__":
    main() 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T17:39:53.943

这是解决此问题的一种古怪方法。

如果你想以正确的方式做到这一点，你应该把 while 循环放在 QThread 内，并使用 Signal 和 slot 来更新 QProgressbar。

但这暂时可以解决您的问题。

缺少的部分是，

1.  设置progressBar的最大值**setMaximum(value)**
2.  添加代码更新progressBar **setValue(value)**
3.  **使用QApplication.processEvents()**强制事件处理

 **快速解决 ：

```
#Add QApplication on top #################
from PyQt4.QtGui import QApplication
##########################################
def on_pushButton_clicked(self):
        '''
            Simulate some long process to be performed.
            Before Long Process starts, show an oscillating progress bar to
            indiate process is running in background. 
        '''
        dialog = QtGui.QDialog()    
        progressBar = Ui_porcessProgress()
        progressBar.setupUi(dialog)
        dialog.show()
        #dialog.exec_()

        start = time.time()
        diff = 0
        while diff < 10:
            end = time.time()
            diff = end - start

            ################################################### 
            #add routine to update progressBar value
            progressBar.porcessProgressBar.setValue(diff)
            QApplication.processEvents()
            #add routine to update progressBar value 
            ###################################################

            print (diff)

class Ui_porcessProgress(object):
    def setupUi(self, porcessProgress):
        porcessProgress.setObjectName(_fromUtf8("porcessProgress"))
        porcessProgress.setWindowModality(QtCore.Qt.ApplicationModal)
        porcessProgress.resize(329, 81)
        porcessProgress.setMinimumSize(QtCore.QSize(329, 81))
        porcessProgress.setMaximumSize(QtCore.QSize(329, 81))
        icon = QtGui.QIcon()
        icon.addPixmap(QtGui.QPixmap(_fromUtf8(":/WFT/wftlogo2.png")), QtGui.QIcon.Normal, QtGui.QIcon.Off)
        porcessProgress.setWindowIcon(icon)
        porcessProgress.setModal(True)
        self.verticalLayout = QtGui.QVBoxLayout(porcessProgress)
        self.verticalLayout.setObjectName(_fromUtf8("verticalLayout"))
        self.label = QtGui.QLabel(porcessProgress)
        self.label.setObjectName(_fromUtf8("label"))
        self.verticalLayout.addWidget(self.label)
        self.porcessProgressBar = QtGui.QProgressBar(porcessProgress)

        ###########################################
        ####Set max value of progress bar
        self.porcessProgressBar.setMaximum(10)
        ############################################

        self.porcessProgressBar.setProperty("value", 10)
        self.porcessProgressBar.setTextVisible(False)
        self.porcessProgressBar.setObjectName(_fromUtf8("porcessProgressBar"))
        self.verticalLayout.addWidget(self.porcessProgressBar)
        porcessProgress.setWindowTitle(QtGui.QApplication.translate("porcessProgress", "Please wait...", None, QtGui.QApplication.UnicodeUTF8))
        self.label.setText(QtGui.QApplication.translate("porcessProgress", "Time History data extraction from ODB file in progress...", None, QtGui.QApplication.UnicodeUTF8))
        QtCore.QMetaObject.connectSlotsByName(porcessProgress)
#
#------------------------------------------------------------------------------ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T17:17:09.410

通过主线程循环的 ProgressBar 将锁定运行 GUI 的同一线程，因此在 LongProcess 完成之前您不会看到任何更新。您需要对执行长过程的部分进行线程化并报告回主线程。[看看这个 SO question](https://stackoverflow.com/questions/5466103/pyqt-file-copy-progress-bar)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T17:17:28.803

您需要从按钮槽返回以进行 GUI 更新。如果您坐在那个插槽中，您将阻塞 UI 线程，因此不会显示实际（可见）小部件设置。

我不熟悉 Python，但 Qt 在后台运行进程的方式（不会阻塞你的 UI）是使用[`QProcess`](http://qt-project.org/doc/qt-4.8/QProcess.html). QProcess 实例具有通知子进程状态更改的信号，以及处理输入和输出流的方法。您可能想研究一下，它将提供更大的灵活性。
（特别是，您根本不需要处理线程，这在 IMO 中是一件好事。）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-14T17:17:43.677

您在`on_pushButton_clicked`方法中所做的一切都将在 gui 线程中执行，因此冻结 gui。只需将其移至`QThread`. 并[阅读此内容](http://qt-project.org/doc/qt-4.8/thread-basics.html)。**

# ios - SQLcipher如何创建密码数据库？

> ID：10587978
> 
> 赞同：0
> 
> 时间：2012-05-14T17:09:42.963
> 
> 标签：ios, ios5, sqlcipher

我正在尝试遵循本教程：[http ://sqlcipher.net/ios-tutorial/](http://sqlcipher.net/ios-tutorial/)

我创建了一个名为“sqlcipher.db”的数据库，然后我重新创建了这个

当我执行此代码时：

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view, typically from a nib.

    NSString *databasePath = [[NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES) objectAtIndex:0] 
                              stringByAppendingPathComponent: @"encrypted.db"];
    sqlite3 *db;
    if (sqlite3_open([databasePath UTF8String], &db) == SQLITE_OK) {
        const char* key = [@"secret" UTF8String];
        int sqlite3_key(sqlite3 *db, const void *pKey, int nKey);
        sqlite3_key(db, key, strlen(key));
        if (sqlite3_exec(db, (const char*) "SELECT count(*) FROM t1;", NULL, NULL, NULL) == SQLITE_OK) {
            // password is correct, or, database has been initialized
            NSLog(@"Hello 1");
        } else {
            // incorrect password!
            NSLog(@"Hello 2");
        }

        sqlite3_close(db);
    } else {
        NSLog(@"Hello 3");
    }
} 
```

它总是发出“Hello 2”。

当我尝试重现此处描述的创建加密数据库的步骤时[http://zetetic.net/blog/2009/12/29/how-to-encrypt-a-plaintext-sqlite-database-to-use-sqlcipher。 html#disqus_thread](http://zetetic.net/blog/2009/12/29/how-to-encrypt-a-plaintext-sqlite-database-to-use-sqlcipher.html#disqus_thread)我无法对其进行加密，我相信这是因为我使用的是 sqlite3 mac 命令。

所以我在评论中看到 S Lombardo 说我必须编译一个命令行 sqlcipher 可执行文件，但链接不起作用。

我应该如何加密我的数据库以将其与 SQLcipher 一起使用？

有没有人在 iOS 中使用 sqlicipher 成功？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T18:03:28.303

谷歌搜索一小时后，我发现了如何为 OSX 编译 sqlcipher 命令行：

我希望这可以帮助某人。

[https://groups.google.com/forum/#!msg/sqlcipher/bd1R13RpZHQ/SEPK8YrRt1gJ](https://groups.google.com/forum/#!msg/sqlcipher/bd1R13RpZHQ/SEPK8YrRt1gJ)

# c# - LogParser 在 C# 中崩溃而没有错误

> ID：10587984
> 
> 赞同：0
> 
> 时间：2012-05-14T17:10:47.377
> 
> 标签：c#, .net, crash, logparser

我正在尝试在 C# 应用程序中实现 MS LogParser。这编译得很好，但在 logQuery.ExecuteBatch() 方法上莫名其妙地崩溃。try/catch 块不会捕获它，除非我专门对 szQuery 进行了错误处理，这表明一切正常，我只是没有得到任何输出。

关于为什么它可能会崩溃或我可能会在哪里找到一些日志记录的任何想法？

```
使用系统；
使用 System.Collections.Generic；
使用 System.Linq；
使用 System.Text；
使用文件夹记录库；
使用 MSUtil；

命名空间 ConsoleApplication20
{
    课堂节目
    {
        静态无效主要（字符串 [] 参数）
        {
            //refLog = new BinaryInputFormat();
            LogQueryClass logQuery = new LogQueryClass();
            ICOMCSVOutputContext 输出 = 新 COMCSVOutputContextClass();
            ILogParserInputContext parse = new BinaryInputFormat();

 string szFileName = @"E:\Programming\FolderLogging\2012-05-13.fbl";
        string szQuery = "SELECT Folder, User, Record, DB, TO_LOCALTIME(Timestamp) AS DateTime, Operation, Checked FROM " + szFileName + " ORDER BY DateTime DESC";
        try
        {
            logQuery.ExecuteBatch(szQuery, parse, output);
        }
        catch
        {
        };           
    }
} 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-09-05T07:29:33.427

Use Execute instead of ExecuteBatch:

```
MSUtil.ILogRecordset RecordSet = logQuery.Execute(query, oInputFormat) 
```

If you want to export to CSV in your sample code you need to change the query by adding INTO output_file_name and run ExecuteBatch:

```
string szQuery = "SELECT Folder, User, Record, DB, TO_LOCALTIME(Timestamp) AS DateTime, Operation,  Checked **INTO c:\out\out.csv** FROM " + szFileName + " ORDER BY DateTime DESC"; 
```

# ssis - Excel 查询中的 CAST 或 CONVERT

> ID：10587993
> 
> 赞同：0
> 
> 时间：2012-05-14T17:11:52.670
> 
> 标签：ssis

如何在 Excel 查询（即 Excel 源任务）中使用 CAST 或 CONVERT。我想使用 SQL 命令选项在 Excel 源任务本身中将一个数字转换为文本。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T06:03:53.000

最好的选择是在源和目标之间使用数据转换。在 Excel 源或目标连接管理器中，我们可以像在 SQL 中一样 CAST 或 CONVERT。

请添加如下数据转换任务：

![Excel 到 Excel 与数据转换](../Images/35d031b63afed7901dd08f63db52773c.png)

与 Excel 目标一样，它可以是转换后的任何目标

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T09:08:33.247

excel文件和数据类型有很多问题。有时它非常痛苦。

看一下这个：

[http://social.msdn.microsoft.com/forums/en-US/adodotnetdataproviders/thread/355afd19-8128-4673-a9d1-9a5658b72e84](http://social.msdn.microsoft.com/forums/en-US/adodotnetdataproviders/thread/355afd19-8128-4673-a9d1-9a5658b72e84)

或这个：

[http://www.connectionstrings.com/excel](http://www.connectionstrings.com/excel)

当我使用 xls 文件时，我经常将所有内容都转换为文本：IMEX=1，然后我使用数据转换任务。

所以我建议将您的连接字符串更改为：

```
Provider=Microsoft.Jet.OLEDB.4.0;Data Source=C:\MyExcel.xls;Extended Properties="Excel 8.0;HDR=Yes;IMEX=1"; 
```

然后你可以对 SSIS 中的数据做任何你想做的事情。

# android - C2DM 自动注销

> ID：10587997
> 
> 赞同：0
> 
> 时间：2012-05-14T17:12:07.270
> 
> 标签：android, broadcastreceiver, android-c2dm

我有一个使用 C2DM 的 Android 应用程序。我在主要活动中定义了接收者（不在清单中）。我有这样的事情：

```
 c2dmReceiver = new BroadcastReceiver() {
 @Override
 public void onReceive(Context context, Intent intent) {
String action = intent.getAction();

if (action.equals("com.google.android.c2dm.intent.REGISTRATION")) {
  String registrationId = intent.getStringExtra("registration_id");
  String error = intent.getStringExtra("error");
  String unregistered = intent.getStringExtra("unregistered");
  System.out.println("receiver registration: " + registrationId);
  System.out.println("unregister aplicacion: " + unregistered);

  if (registrationId != null){
        saveConfig("key", registrationId);
    postC2dm(registrationId);
      }
}
else 
   if (action.equals("com.google.android.c2dm.intent.RECEIVE")){
       final String payload = intent.getStringExtra("payload");
       System.out.println("Package : " + intent.getPackage());
       }
   }
 };
IntentFilter filtroReceiver = new     IntentFilter("com.google.android.c2dm.intent.REGISTRATION");
filtroReceiver.addAction("com.google.android.c2dm.intent.RECEIVE");
filtroReceiver.addCategory("es.unizar.c2dm");
registerReceiver(c2dmReceiver,filtroReceiver,"com.google.android.c2dm.permission.SEND",null); 
```

在清单文件中：

```
 <uses-permission android:name="mypackage.permission.C2D_MESSAGE" /> 
<uses-permission android:name="com.google.android.c2dm.permission.RECEIVE" />
    <uses-permission android:name="android.permission.INTERNET" />
    <uses-permission android:name="android.permission.VIBRATE"/>
    <uses-permission android:name="android.permission.WAKE_LOCK"/>
    <uses-permission android:name="android.permission.GET_ACCOUNTS" />
<uses-permission android:name="android.permission.USE_CREDENTIALS" />
<uses-permission android:name="com.google.android.c2dm.permission.SEND" /> 
```

我的问题是：当我通过意图“com.google.c2dm.intent.RECEIVE”收到“有效负载”时，我正确收到了数据“有效负载”，但我收到了一个 registrationId=null 并且我的类别未注册（在操作中“ com.google.c2dm.intent.registration”）。

出现的警告是：

未授予 com.google.android.c2dm.permission.SEND 对包 es.mypackage.es 的权限（protectionLevel=3 flags=0xbe46）

[DataMsgMdr] 广播意图回调：结果 = CANCELED for Intent {act=com.google.c2dm.intent.RECEIVE cat= es.mypackage.es（有附加功能）

找不到接收方包，取消注册应用程序 es.mypackage.es 发送方 sender@gm...

谢谢你。此致。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T04:00:09.823

这是因为您的帐户没有注册。您确定吗，您`C2DM` 在发件人地址中输入了正确的注册帐户。使用您`Package Name`在注册时输入的相同`C2DM`...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T10:07:04.207

我不明白的是为什么您不在清单中定义广播接收器。在 Activity 中定义它意味着 C2DM 仅在您的应用程序（特定）加载您的 Activity 时才有效（我假设您的代码类似于[Where to register a BroadcastReceiver (Activity lifecycle fun)](https://stackoverflow.com/questions/4980398/where-to-register-a-broadcastreceiver-activity-lifecycle-fun)）。

但在这种情况下，您不需要 C2DM，您可以打开与服务器的活动连接。C2DM 的整体理念是即使在未加载的情况下也能够触发您的应用程序。有关指南，请参阅[https://stackoverflow.com/a/8943715/734687](https://stackoverflow.com/a/8943715/734687)。

# iframe - 如何让无限滚动系统在 iframe 中工作

> ID：10587998
> 
> 赞同：3
> 
> 时间：2012-05-14T17:12:10.683
> 
> 标签：iframe, scroll, embed, tumblr, infinite-scroll

我正在尝试在我网站的 iframe 中嵌入一个 tumblr 博客：

**Tumblr：** [http ://architectural-review.tumblr.com](http://architectural-review.tumblr.com)

**网站：** [http ://www.architectural-review.com/story.aspx?storyCode=8630232&preview=1&hash=AA251CC88264E33B8E824AEE418F1168](http://www.architectural-review.com/story.aspx?storyCode=8630232&preview=1&hash=AA251CC88264E33B8E824AEE418F1168)

我遇到的问题是 tumblr 在用户向下滚动时使用无限滚动来加载更多帖子。但是，当嵌入 iframe 时，tumblr 不会识别出用户已到达页面底部，因此会停止加载更多帖子。

有没有办法强制 tubmlr 立即加载所有帖子或让 iframe 告诉 tumblr 加载更多帖子？

谢谢

芬

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T14:12:34.430

你试过设置`scrollTop`属性吗？这可能会触发滚动事件。

另一种可能是[jQuery](http://api.jquery.com/scroll/) `$('iframeId').scroll()`。