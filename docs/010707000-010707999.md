# StackOverflow 问答 10707000-10707999

# c# - 委托方法与一般方法

> ID：10707000
> 
> 赞同：14
> 
> 时间：2012-05-22T17:26:46.937
> 
> 标签：c#, methods, delegates

我想知道使用委托方法和使用一般方法[没有委托]之间的区别。

## 例如 ：

* * *

**与代表：**

```
delegate void DelMethod(string str);

static void Method(string str)
{
    Debug.WriteLine(str);
} 
```

*用法 ：*

```
DelMethod dm = new DelMethod(Method);
dm(string); 
```

* * *

**并且没有代表：**

```
static void Method(string str)
{
    Debug.WriteLine(str);
} 
```

*用法 ：*

```
Method(string) 
```

* * *

这两个有什么区别？？

没有委托的方法更小更容易。但我发现编码人员经常使用委托方法。

这背后的原因是什么？？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-05-22T17:54:07.853

想象一个场景，您有一个搜索客户的函数。最初您只想按名称搜索，因此您可以编写如下内容：

```
public Customer Find(string name)
{
    foreach (var customer in database.Customers)
       if (customer.Name == name)
          return customer;
} 
```

然后你的规范改变了，你必须实现新的搜索方式（比如说“按地址搜索”）。没问题，我们将旧代码重构为：

```
public Customer FindByName(string name)
{
    foreach (var customer in database.Customers)
       if (customer.Name == name)
          return customer;
}

public Customer FindByAddress(string address)
{
    foreach (var customer in database.Customers)
       if (customer.Address == address)
          return customer;
} 
```

它们看起来非常相似，不是吗？

现在您的老板再次告诉您添加另一个搜索功能，用户可能希望通过电话号码查找客户。越来越无聊了，不是吗？

幸运的是，开发人员已经找到了一种让其他开发人员的生活更轻松的方法来发明委托。使用它们，您可以创建一个更大的通用函数，帮助您避免一次又一次地重写相同的代码。

```
public Customer Find(Predicate<Customer> p)
{
    foreach (var customer in database.Customers)
       if (p(customer))
          return customer;
} 
```

现在，您不必在每次需要一种新的搜索客户方式时都创建一个专门的函数，因此您可以编写：

```
var byName = Find(a => a.Name == "lorem");
var byAddress = Find(a => a.Address == "ipsum");
var byTelephone = Find(a => a.Telephone == "dolor"); 
```

委托对于管理事件也很有用，并且在 LINQ 中也被大量使用。只需谷歌“delegates c#”，您就会发现一个巨大的新世界！:)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-22T17:34:10.473

代表们是另一种情况。想象一下，你有一个班级应该回答另一个班级的问题，但你对第二个班级一无所知。在这种情况下，您可以先做一个委托。

```
// class where you know something
class A
{
   //delegate for answer
   public Func<bool> AskForSomething { get; set; }

   public void DoSomething()
   {
      //some code
      if(AskForSomething())
      {
          //do something
      }
      else
      {
          //do something else
      }
   }
}

class B
{
   public void Test()
   {
      A a = new A();
      a.AskForSomething = new Func<bool>(Answer);
      a.DoSomething();
   }

   private bool Answer()
   {
       return true;
   } 
} 
```

`Class A`什么都不知道`class B`，但它可以调用 B 的方法并得到它的结果。里面的`Answer`方法`class B`是**私有**的，`class A`不能直接调用。

[在MSDN](http://msdn.microsoft.com/en-us/library/ms173171.aspx)中阅读更多内容

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-12-22T03:56:39.063

在一种特殊情况下，两个调用会有所不同，即当涉及到可选参数时。考虑这些

```
delegate void DelMethod(string str = "hai");  
static void Method(string str = "bye")
{
    Debug.WriteLine(str);
}

DelMethod dm = Method;
dm();

//prints "hai" 
```

但

```
Method();

//prints "bye" 
```

在第一种情况下，它是在调用站点插入的委托的可选参数。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-05-22T17:57:35.017

代表的另一种用法：

如果没有委托，只有定义*私有*方法的类才能调用这些方法。通过在委托中包装方法，您可以将委托实例传递给其他类，并让它们使用适当的参数调用委托（作为回调），最终将在定义类中调用您的实际私有方法。

* * *

**例如 ：**

```
namespace DelegatesSample
{
    public delegate void privateCallbackDelegate(string param1, int param2);
    public class A
    {
        private void DelegatedMehod(string param1, int param2)
        {
            //Code for some action
        }

        private void CallBusinessClass()
        {
            privateCallBackDelegate del = new privateCallBackDelegate(DelegateMethod);

            B b = new B();
            b.InvokeBusinessMethod(del);
        }
    }

    public class B
    {        
        public void InvokeBusinessMethod(privateCallbackDelegate d)
        {
            //Do Some calculations and when finished, call the callback delegate
            d("Done", result); //or d.Invoke or d.BeginInvoke
        }

    }
} 
```

* * *

一般来说，MSDN 在[这篇文章](http://msdn.microsoft.com/en-us/library/aa288459%28v=vs.71%29.aspx)中有以下说法：

**代表在以下情况下很有用：**

*   正在调用一个方法。
*   一个类可能需要方法规范的多个实现。
*   希望允许使用静态方法来实现规范。
*   需要类似事件的设计模式（有关更多信息，请参阅事件教程）。
*   调用者无需知道或获取定义该方法的对象。
*   实现的提供者希望仅将规范的实现“分发”给少数选定的组件。
*   需要简单的组合。

# java - 为什么在这个简单的 WebSphere 示例 web.xml 中出现“错误 403：AuthorizationFailed”？

> ID：10707001
> 
> 赞同：0
> 
> 时间：2012-05-22T17:26:48.653
> 
> 标签：java, authentication, websphere, web.xml

我正在使用 WebSphere 7。我有一个使用 web.xml 设置的简单示例，如下所示。

这就是我测试它的方式：

1.  我从 WebSphere 中没有用户和组开始

2.  我尝试访问页面 (/restricted/topsecret.html) 我被提示登录。我不能。

3.  我使用 WebSphere 管理控制台添加了一个用户/密码“rob/password”。我现在可以登录，但看不到页面。我收到“403：授权失败”错误。

4.  我添加了一个名为“ROLE1”的组，并使用 WebSphere 管理控制台将该组分配给用户“rob”。我重新启动 Firefox，我仍然可以登录，但我仍然收到“403”错误。

5.  我写了一个小 JSP（如下）来输出登录的用户名，但即使在登录后用户名仍然为空。

知道我做错了什么吗？谢谢！

抢

```
<security-constraint>
  <web-resource-collection>
    <web-resource-name>page test 1</web-resource-name>
    <url-pattern>/restricted/topsecret.html</url-pattern>
    <http-method>GET</http-method>
    <http-method>POST</http-method>
  </web-resource-collection>
  <auth-constraint>
    <role-name>ROLE1</role-name>
  </auth-constraint>
  <user-data-constraint>
    <transport-guarantee>NONE</transport-guarantee>
  </user-data-constraint>
</security-constraint> 
```

用户测试.jsp

```
<%@ page session="true" %>
Logged in username = '<%= request.getRemoteUser() %>' // is always null
<p/>
Logged in username = '<%= request.getUserPrincipal() %>' // is always null 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T02:54:00.493

共有三个安全级别

1.  行政级别
2.  应用层
3.  Java 2 级

我假设您已打开应用程序级别（听起来您已打开但我想检查一下）

usertest.jsp 是否安全？

将角色映射到用户后是否重新启动了应用程序？

JSP 中的代码（第一行在语法上看起来不太好。我假设一个错字）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-05-06T11:24:59.140

这是针对 WAS 7 的。我最近遇到了这个问题，我们的应用程序抛出 403 错误。

```
 ibm-application-bnd.xml
<security-role name="DefaultRole">
        <special-subject type="ALL_AUTHENTICATED_USERS" /></security-role>
    <security-role name="NoSecurity">
        <special-subject type="EVERYONE" /></security-role></application-bnd> 
```

应用程序.xml

```
<security-role>
    <role-name>DefaultRole</role-name>
  </security-role>
  <security-role>
    <role-name>NoSecurity</role-name>
  </security-role> 
```

检查两个xml文件

# c# - 我需要一种从另一个线程访问媒体元素属性的方法

> ID：10707006
> 
> 赞同：1
> 
> 时间：2012-05-22T17:27:04.020
> 
> 标签：c#, position, mediaelement

我使用 Visual Studio 在 GUI 中内置了一个 MediaElement，但在后端代码中，我需要访问它加载的视频中的 Position 属性，以便在某些计算中使用时间。我收到一条错误消息，说我无法访问它，因为另一个线程拥有它。

我尝试过使用 GetProperty() GetValue() 方法，并且我也使用调用程序来处理它，但在 MediaElement 中找不到获取位置的方法。

有没有一种简单的方法可以访问另一个线程中对象的属性？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T17:44:09.937

您没有发布错误，但我猜它告诉您不能只从其他/非 UI 线程访问 UI 线程上的对象，在 WPF 中，您通常需要[Dispatcher](http://msdn.microsoft.com/en-us/library/system.windows.threading.dispatcher.aspx)调用[另一个](http://msdn.microsoft.com/en-us/library/ms591206.aspx)线程。更多信息和样品[在这里](http://www.switchonthecode.com/tutorials/working-with-the-wpf-dispatcher)。

# ios - 在 iOS 5.1.1+ 中点击播放音频

> ID：10707007
> 
> 赞同：1
> 
> 时间：2012-05-22T17:27:04.950
> 
> 标签：ios, html, mobile, mobile-safari, html5-audio

我一直在寻找一个如何在 iOS 中实现 onclick 音频播放的简单示例，但我似乎找不到。我知道由于数据使用方面的考虑，Apple 已禁用自动播放 - 但我想做的是在用户单击图像时播放音频 - 我绝不是 javascript 的大师，我找不到应用于我的代码的简单示例，因此我希望有人可以演示您如何做到这一点。

我在下面输入了我的代码的简化版本。我已经在使用 javascript 函数来确定单击图像时是否需要提供 ogg 文件或 mp3 文件。我还使用了一个 JQuery 插件，它可以在单击时放大图像，另一个控制页面上几个标题的一些字体大小，另一个控制 chromeframe。我的头部有两个单独的脚本标签，因为我不知道如何让它们全部在一个标签中工作。我知道这很草率，我打算清理它，但在我这样做之前，我想弄清楚音频问题。

无论如何，我认为因为我已经设置了音频以在单击图像时播放它可以在 iOS 中工作，但它不是，我不确定我应该如何调整代码。如果有人有时间提供一个简单的例子作为如何做到这一点的起点，我会非常感激。

```
<!DOCTYPE html>
<head>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script src="jquery/jquery.zoomooz.min.js"></script>
<script src="jquery/jquery.fittext.js.js"></script>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/chrome-frame/1/CFInstall.min.js"></script>
<script>

// Mouseover/ Click sound effect- by JavaScript Kit (www.javascriptkit.com)
// Visit JavaScript Kit at http://www.javascriptkit.com/ for full source code

//** Usage: Instantiate script by calling: var uniquevar=createsoundbite("soundfile1",       "fallbackfile2", "fallebacksound3", etc)
//** Call: uniquevar.playclip() to play sound

var html5_audiotypes={ //define list of audio file extensions and their associated audio    types. Add to it if your specified audio file isn't on this list:
"mp3": "audio/mpeg",
"mp4": "audio/mp4",
"ogg": "audio/ogg",
"wav": "audio/wav"
 }

 function createsoundbite(sound){
var html5audio=document.createElement('audio')
if (html5audio.canPlayType){ //check support for HTML5 audio
    for (var i=0; i<arguments.length; i++){
        var sourceel=document.createElement('source')
        sourceel.setAttribute('src', arguments[i])
        if (arguments[i].match(/\.(\w+)$/i))
            sourceel.setAttribute('type', html5_audiotypes[RegExp.$1])
        html5audio.appendChild(sourceel)
    }
    html5audio.load()
    html5audio.playclip=function(){
        html5audio.pause()
        html5audio.currentTime=0
        html5audio.play()
    }
    return html5audio
}
else{
    return {playclip:function(){throw new Error("Unfortunately your browser doesn't support HTML5 audio")}}
}
 }

 //Initialize two sound clips with 1 fallback file each:

 var mouseoversound=createsoundbite("example1.ogg", "example1.mp3")
 var clicksound=createsoundbite("example2.ogg", "example2.mp3") 
```

```
<script type="text/javascript">

$(document).ready(function(){
            if($(window).width()>0){
                $("li.fittext").fitText(1.68);
                $("#footerwrap p").fitText(5);
            };
        });
        $(".zoomTarget").click(function(evt) {
                evt.stopPropagation();
                evt.preventDefault();
                $(this).zoomTo({debug:true});
                $(this).zoomTo({easing:'ease-in'});
            });

            $(window).click(function(evt) {
                evt.stopPropagation();
                $("body").zoomTo({targetsize:1.0});
            });

            // for iPhone
            $("#container").click(function(evt) {
                evt.stopPropagation();
                $("body").zoomTo({targetsize:1.0});
            });

            $("body").zoomTo({targetsize:1.0});

        $(window).load(function() {
            CFInstall.check({
             mode: "overlay",
             destination: "http://www.waikiki.com"
           });
           });

</script>
</head>

<body>

<div id="wrapper">

<img onclick="clicksound.playclip()" class="zoomTarget" data-targetsize="1.0" data-duration="10000" easing="linear" src="images/image.jpg"/>
</div><!--wrapper--> 

</body> 
```

# java - 使用 Java 时在 HTTP 中隐藏发件人信息

> ID：10707010
> 
> 赞同：0
> 
> 时间：2012-05-22T17:27:19.153
> 
> 标签：java, http, wireshark

我在玩 Java 中的 HTTP POST 和 GET 请求。我只是想模仿我的浏览器使用 Java 发送的请求（我正在使用 URLConnection 类）。但是，当我使用 Wireshark 分析浏览器发送的数据包和通过 Java 发送的数据包时，我发现了一个很大的不同：

[http://i.stack.imgur.com/n8OvR.png](http://i.stack.imgur.com/n8OvR.png)

[http://i.stack.imgur.com/zPBPR.png](http://i.stack.imgur.com/zPBPR.png)

（打开链接查看图片）

当我发送 HTTP POST/GET 时，我使用的工具（浏览器或 Java）会发送有关自身的信息。但是，我想通过 Java 发送与通过浏览器完全相同的数据包。有没有办法做到这一点？如何隐藏发件人（在本例中为 Java）信息？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T17:36:47.320

抱歉，另一页上唯一好的答案在底部。

`setRequestProperty("User-Agent", "");`请参阅[URLConnection的 JDocs](http://docs.oracle.com/javase/6/docs/api/java/net/URLConnection.html#setRequestProperty%28java.lang.String,%20java.lang.String%29)

您也可以将其用于任何其他标题，例如`Accept-Language`. 如果您设置为可能会导致服务器对 Java 无法正确处理的内容进行 gzip 压缩，请小心`Accept-Encoding`，您将需要执行类似的[操作](https://stackoverflow.com/questions/4818468/how-to-check-if-inputstream-is-gzipped)。

我不确定为什么建议设置系统属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T17:47:30.313

如果您想使用纯 Java 发送*完全相同*的数据包，那么您不能。

但是这个库可能会有所帮助： http: [//www.savarese.com/software/rocksaw/](http://www.savarese.com/software/rocksaw/)

# asp.net-mvc - MVC4 路由怪异

> ID：10707014
> 
> 赞同：1
> 
> 时间：2012-05-22T17:27:27.743
> 
> 标签：asp.net-mvc, asp.net-mvc-4

我的一个观点中有这个 ActionLink

```
Html.ActionLink(pop.PopName, "ShowAllEncounters", "Encounter", new {popId = pop.populationID }) 
```

我在想这会带我去正确的路线......
但我却去了这条路线......

```
http://localhost:19283/Population/ShowAllEncounters?Length=9 
```

路线应该是

```
http://localhost:19283/Encounter/ShowAllEncounters?Length=9 
```

我查看了我的 global.asax 文件，一切似乎都很正常...除了设置默认打开页面之外，我没有以任何方式更改默认路由...

```
routes.MapRoute(
            "Default", // Route name
            "{controller}/{action}/{id}", // URL with parameters
            new { controller = "Population", action = "PopulationInfo", id = UrlParameter.Optional } // Parameter defaults
        ); 
```

这是我所期望的......这类似于我拥有的 MVC3 路线。我在用我的路线做一些时髦的事情吗？我在这里想念什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T17:32:14.303

看起来你调用了错误的方法重载：

```
public static MvcHtmlString ActionLink(
    this HtmlHelper htmlHelper,
    string linkText,
    string actionName,
    Object routeValues,
    Object htmlAttributes
) 
```

[http://msdn.microsoft.com/en-us/library/dd492124.aspx](http://msdn.microsoft.com/en-us/library/dd492124.aspx)

**相反**，请尝试调用此重载：

```
public static MvcHtmlString ActionLink(
    this HtmlHelper htmlHelper,
    string linkText,
    string actionName,
    string controllerName,
    Object routeValues,
    Object htmlAttributes
) 
```

[http://msdn.microsoft.com/en-us/library/dd504972.aspx](http://msdn.microsoft.com/en-us/library/dd504972.aspx)

* * *

要调用正确的重载，请使用类似于以下内容的内容：

```
Html.ActionLink(pop.PopName,
                "ShowAllEncounters",
                "Encounter",
                null,
                new {popId = pop.populationID }) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T17:45:37.823

你的代码

```
Html.ActionLink(pop.PopName, "ShowAllEncounters", "Encounter", new {popId = pop.populationID }) 
```

应该

```
Html.ActionLink(pop.PopName, "ShowAllEncounters", new {controller="Encounter"}, new {popId = pop.populationID }) 
```

# paypal - Paypal 可以用于销售实体商品和数字商品吗？

> ID：10707022
> 
> 赞同：0
> 
> 时间：2012-05-22T17:27:45.517
> 
> 标签：paypal

问题在标题中。花了几个小时在谷歌上搜索这个问题后，我仍然不清楚这一点。

我的客户有一家商店，她销售实体商品和数字商品。我可以使用 Paypal 购物车同时出售两者吗（一次结账）；付款和实物发货后，将在哪里为客户提供下载？客户只需支付一次。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T21:25:56.420

是的，你需要一些东西来触发数字商品，比如 IPN api 应该可以工作：[https ://www.paypal.com/ipn](https://www.paypal.com/ipn)

基本上，您将需要一个文件来读取来自 Paypal 的响应，确定是否/什么数字商品已售出并生成响应。

# mongodb - 是否有类似 sql profiler for mongodb 的等效工具？

> ID：10707025
> 
> 赞同：2
> 
> 时间：2012-05-22T17:28:04.760
> 
> 标签：mongodb, profiler

我想知道是否有类似 sql profiler for mongodb 的等效工具。具体来说，我想看看正在生成哪些 monogdb 查询并从我的代码中运行。

所以，当我有如下代码时：

```
 var Logs = MvcApplication.MongoLoggingDatabase.GetCollection<Log>("Log")
                .Find(queryDocument)
                .Select(x => new LogDto { ModelNumber = x.Request.ModelNumber, Make = x.Request.Make, TimeStamp = x.TimeStamp, UserId = x.UserId })
                .OrderByDescending(x => x.TimeStamp)
                .Skip(pageSize * (page - 1))
                .Take(pageSize); 
```

我想知道正在生成和运行什么实际的 mongodb 查询，以便在查询数据库时帮助优化我的代码。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T18:10:59.410

MongoDB 包含一个简单的分析器。见这里： [http ://www.mongodb.org/display/DOCS/Database+Profiler](http://www.mongodb.org/display/DOCS/Database+Profiler)

如果您将分析级别设置为 2，则所有查询都将写入“system.profiler”集合，以便您查看。如果将分析级别设置为 1，则只会写入慢速查询（默认情况下，这些查询被定义为慢于 100 毫秒的查询，但这是一个可配置的参数）。

对于诊断慢查询，“解释”功能也很有帮助。见这里 [http://www.mongodb.org/display/DOCS/Explain](http://www.mongodb.org/display/DOCS/Explain)

如果您知道哪些查询很慢，您可以使用 explain 来确定数据库正在使用（或不使用）哪个索引。

# c# - 确定数据表中的重复项

> ID：10707031
> 
> 赞同：1
> 
> 时间：2012-05-22T17:28:45.530
> 
> 标签：c#, datatable, duplicates

我有一个从 CSV 文件加载的数据表。我需要根据数据表中的两列（`product_id`和`owner_org_id`）确定哪些行是重复的。一旦我确定了这一点，我就可以使用该信息来构建我的结果，这是一个仅包含非唯一行的数据表，以及一个仅包含唯一行的数据表。

我在这里查看了其他示例，到目前为止我提出的代码确实可以编译和执行，但似乎认为数据中的每一行都是唯一的。实际上，在测试数据中有 13 行，只有 6 行是唯一的。很明显我做错了什么。

**编辑**：我想我应该注意，应该**全部**删除具有重复项的行，而不仅仅是该行的重复项。例如，如果有 4 个重复项，则应删除所有 4 个而不是 3 个，从 4 个中保留一个唯一行。

**EDIT2**：或者，如果我可以选择所有重复的行（而不是尝试选择唯一的行），那对我来说很好。无论哪种方式都可以让我得到最终结果。

处理方法中的代码：

```
MyRowComparer myrc = new MyRowComparer();
var uniquerows = dtCSV.AsEnumerable().Distinct(myrc); 
```

以及以下内容：

```
public class MyRowComparer : IEqualityComparer<DataRow>
{
    public bool Equals(DataRow x, DataRow y)
    {
        //return ((string.Compare(x.Field<string>("PRODUCT_ID"),   y.Field<string>("PRODUCT_ID"),   true)) ==
        //        (string.Compare(x.Field<string>("OWNER_ORG_ID"), y.Field<string>("OWNER_ORG_ID"), true)));
        return
            x.ItemArray.Except(new object[] { x[x.Table.Columns["PRODUCT_ID"].ColumnName] }) ==
            y.ItemArray.Except(new object[] { y[y.Table.Columns["PRODUCT_ID"].ColumnName] }) &&
            x.ItemArray.Except(new object[] { x[x.Table.Columns["OWNER_ORG_ID"].ColumnName] }) ==
            y.ItemArray.Except(new object[] { y[y.Table.Columns["OWNER_ORG_ID"].ColumnName] });
    }

    public int GetHashCode(DataRow obj)
    {
        int y = int.Parse(obj.Field<string>("PRODUCT_ID"));
        int z = int.Parse(obj.Field<string>("OWNER_ORG_ID"));
        int c = y ^ z;
        return c;
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T17:46:55.807

您可以使用 LINQ-To-DataSet 和`Enumerable.Except`/ `Intersect`：

```
var tbl1ID = tbl1.AsEnumerable()
        .Select(r => new
        {
            product_id = r.Field<String>("product_id"),
            owner_org_id = r.Field<String>("owner_org_id"),
        });
var tbl2ID = tbl2.AsEnumerable()
        .Select(r => new
        {
            product_id = r.Field<String>("product_id"),
            owner_org_id = r.Field<String>("owner_org_id"),
        });

var unique = tbl1ID.Except(tbl2ID);
var both = tbl1ID.Intersect(tbl2ID);

var tblUnique = (from uniqueRow in unique
                join row in tbl1.AsEnumerable()
                on uniqueRow equals new
                {
                    product_id = row.Field<String>("product_id"),
                    owner_org_id = row.Field<String>("owner_org_id")
                }
                select row).CopyToDataTable();
var tblBoth = (from bothRow in both
              join row in tbl1.AsEnumerable()
              on bothRow equals new
              {
                  product_id = row.Field<String>("product_id"),
                  owner_org_id = row.Field<String>("owner_org_id")
              }
              select row).CopyToDataTable(); 
```

* * *

**编辑**：显然我误解了你的要求。因此，您只有一个`DataTable`并且想要获得所有唯一且所有重复的行，这更加直接。您可以使用[**`Enumerable.GroupBy`**](http://msdn.microsoft.com/en-us/library/bb341740)包含两个字段的匿名类型：

```
var groups = tbl1.AsEnumerable()
    .GroupBy(r => new
    {
        product_id = r.Field<String>("product_id"),
        owner_org_id = r.Field<String>("owner_org_id")
    });
var tblUniques = groups
    .Where(grp => grp.Count() == 1)
    .Select(grp => grp.Single())
    .CopyToDataTable();
var tblDuplicates = groups
    .Where(grp => grp.Count() > 1)
    .SelectMany(grp => grp)
    .CopyToDataTable(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T17:36:49.230

您的标准已关闭。您正在比较您不感兴趣（`Except`排除）的对象集。

相反，尽可能清晰（数据类型）并保持简单：

```
public bool Equals(DataRow x, DataRow y)
{   
    // Usually you are dealing with INT keys
    return (x["PRODUCT_ID"] as int?) == (y["PRODUCT_ID"] as int?)
      && (x["OWNER_ORG_ID"] as int?) == (y["OWNER_ORG_ID"] as int?);

    // If you really are dealing with strings, this is the equivalent:
    // return (x["PRODUCT_ID"] as string) == (y["PRODUCT_ID"] as string)
    //  && (x["OWNER_ORG_ID"] as string) == (y["OWNER_ORG_ID"] as string)
} 
```

检查`null`是否有可能。也许您想排除相等的行，因为它们的 ID 为空。

观察`int?`. 这不是一个错字。如果您要处理来自列的数据库值，则问号是必需的`NULL`。原因是`NULL`值将由`DBNull`C# 中的类型表示。在这种情况下，使用`as`运算符只会为您提供`null`（而不是`InvalidCastException`. 如果您确定，您正在处理`INT NOT NULL`，请使用`(int)`.

字符串也是如此。`(string)`断言您期望非空 DB 值。

编辑1：

类型错了。ItemArray 不是哈希表。直接使用该行。

编辑2：

添加`string`示例，一些注释

有关更直接的方法，请检查[如何在数据表中选择不同的行并存储到数组中](https://stackoverflow.com/questions/1199176/how-to-select-distinct-values-from-datatable)

编辑3：

关于演员阵容的一些解释。

我建议的另一个链接与您的代码相同。我忘记了您的初衷；-) 我刚刚看到您的代码并响应了最明显的错误，我看到了-抱歉

这是我解决问题的方法

```
using System.Linq;
using System.Data.Linq;

var q = dtCSV
    .AsEnumerable()
    .GroupBy(r => new { ProductId = (int)r["PRODUCT_ID"], OwnerOrgId = (int)r["OWNER_ORG_ID"] })
    .Where(g => g.Count() > 1).SelectMany(g => g);

var duplicateRows = q.ToList(); 
```

我不知道这是否 100% 正确，我手头没有 IDE。而且您需要将演员表调整为适当的类型。见我上面的补充。

# android - 如何在android中停止计时器

> ID：10707036
> 
> 赞同：3
> 
> 时间：2012-05-22T17:29:08.833
> 
> 标签：android

如何停止定时器当前正在执行的任务。？如果我使用 timer.cancel() 它将取消计时器但执行当前正在执行的任务..那么有没有办法让我可以取消当前正在执行的任务？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-22T17:34:20.620

在取消呼叫之后使用

```
timer.purge(); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-22T17:48:07.983

利用：

```
 timer.cancel();
   timer.purge() 
```

**purge()** [从任务队列中删除所有取消的任务](http://developer.android.com/reference/java/util/Timer.html#purge%28%29)， timer.cancel() 取消定时器和所有计划任务。

* * *

也看看[这篇文章](https://stackoverflow.com/questions/4050442/how-to-stop-immediately-the-task-scheduled-in-java-util-timer-class)

# php - PHP - 搜索数组

> ID：10707037
> 
> 赞同：-2
> 
> 时间：2012-05-22T17:29:25.760
> 
> 标签：php, arrays, search, array-key-exists

我有一个如下所示的数组：

```
Array ( 
[0] => Array ( 
[slideID] => 3 
[parentSlideID] => 1 
[subSlideOrder] => 1 
[headline] => 
[copy] => 
[colourID] => 0 
[URL] => 2.jpg 
[category] => 1 
[visible] => 1 
[slideOrder] => 2 
[type] => 0 ) 

[1] => Array ( 
[slideID] => 3 
[parentSlideID] => 1 
[subSlideOrder] => 1 
[headline] => 
[copy] => 
[colourID] => 0 
[URL] => 2.jpg 
[category] => 1 
[visible] => 1 
[slideOrder] => 2 
[type] => 0 ) 

[2] => Array ( 
[slideID] => 3 
[parentSlideID] => 0 
[subSlideOrder] => 1 
[headline] => 
[copy] => 
[colourID] => 0 
[URL] => 2.jpg 
[category] => 1 
[visible] => 1 
[slideOrder] => 2 
[type] => 0 ) 
) 
```

如何搜索数组，以便检查`parentSlideID`每个子数组中的值，然后返回找到匹配项的键。

例如，在数组中搜索“1”将返回`0,1`. 搜索“0”将返回`2`。搜索“3”不会返回任何内容。这可能吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-22T17:32:41.650

这应该有助于：

```
foreach($array as $key=>$value)
{
    if($value['parentSlideID'] == $searchvalue)
        $results[]=$key;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-22T17:33:01.887

这是你要找的吗？

```
<?php
$needle = "1";
foreach($array as $key=>$value)
{
    if($value['parentSlideID']==$needle)
    {
       echo "$array[".$key."] is equal to: ".$needle;
       break;
    }
}
?> 
```

# iphone - 位置管理器是在调度队列上创建的

> ID：10707038
> 
> 赞同：11
> 
> 时间：2012-05-22T17:29:26.087
> 
> 标签：iphone, objective-c, ios, ios5

这个消息是什么意思？

注意，位置管理器 (0xe86bdf0) 是在主线程以外的线程上执行的调度队列上创建的。开发人员有责任确保在分配位置管理器对象的线程上运行运行循环。特别是，不支持在任意调度队列（未附加到主队列）中创建位置管理器，这将导致无法接收回调。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-05-22T17:41:04.480

您必须在具有活动运行循环的线程（例如主线程）上创建 CLLocationManager。您不应该在后台线程上创建它。有关详细信息，请参阅[CLLocationManager 类参考](https://developer.apple.com/library/mac/#documentation/CoreLocation/Reference/CLLocationManager_Class/CLLocationManager/CLLocationManager.html)：

> （位置管理器对象的配置必须始终发生在具有活动运行循环的线程上，例如应用程序的主线程。）

如果您对运行循环的确切含义感兴趣，请参阅[运行循环](http://developer.apple.com/library/ios/#documentation/Cocoa/Conceptual/Multithreading/RunLoopManagement/RunLoopManagement.html)了解更多信息。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2016-10-19T15:52:35.897

使用 Swift 3，以下将确保您的函数在主线程上运行：

```
OperationQueue.main.addOperation{"your location manager init code"} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-22T17:49:32.353

这意味着如果您在“主”线程（即应用​​程序的所有 UI 代码执行的线程）之外的另一个线程中创建了位置管理器，则需要确保始终调用它（即位置管理器）从创建它的线程。

要调试代码中的问题，您可能希望将位置管理器的创建（以及对位置管理器的调用）包装在主线程的调度队列中：

```
dispatch_sync(dispatch_get_main_queue(),^ {
    self.locationManager = [[CLLocationManager alloc] init];
    self.locationManager.delegate = self;
}); 
```

和：

```
dispatch_sync(dispatch_get_main_queue(),^ {
  [self.locationManager startUpdatingLocation];
}); 
```

或类似的东西，看看错误信息是否消失。

# iphone - 从 NSUserDefaults 设置/访问多维数组

> ID：10707039
> 
> 赞同：1
> 
> 时间：2012-05-22T17:29:27.750
> 
> 标签：iphone, objective-c, ipad, multidimensional-array, nsuserdefaults

我在存储和访问 NSUserDefault 中的多维数组时遇到了一些麻烦。任何帮助，将不胜感激。运行此代码时出现的错误是“ ***由于未捕获的异常 'NSInternalInconsistencyException' 而终止应用程序，原因：'-[__NSCFArray insertObject:atIndex:]: mutating method sent to immutable object'”

```
//To create, add values to and store arrays
multiArray = [[NSArray alloc] init];
multiArray = [NSArray arrayWithObjects:[NSMutableArray array], [NSMutableArray array], [NSMutableArray array], nil];

[[multiArray objectAtIndex:0] addObject:[NSNumber numberWithDouble:number1]];
[[multiArray objectAtIndex:1] addObject:[NSNumber numberWithDouble:number2]];
[[multiArray objectAtIndex:2] addObject:[NSNumber numberWithDouble:number3]];
NSUserDefaults * standardUserDefaults = [NSUserDefaults standardUserDefaults]
[standardUserDefaults setObject:multiArray forKey:@"multiArray"];
[standardUserDefaults synchronize];

//To access the array
NSArray *multiArrayCopy = [[NSArray alloc] init];
multiArrayCopy = [[standardUserDefaults objectForKey:@"multiArray"] mutableCopy];
NSLog(@"array count is %i", [[multiArrayCopy objectAtIndex:2] count]);
Label1.text = [NSString stringWithFormat:@"%@", [[multiArrayCopy objectAtIndex:0] objectAtIndex:0]];
Label2.text = [NSString stringWithFormat:@"%@", [[multiArrayCopy objectAtIndex:1] objectAtIndex:0]];
Label3.text = [NSString stringWithFormat:@"%@", [[multiArrayCopy objectAtIndex:2] objectAtIndex:0]]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T19:36:46.447

您收到错误是因为 [NSMutableArray array] 是 NSArray 的一个类方法，它返回一个空（非可变）数组。请记住，NSMutableArray 是 NSArray 的子类。尝试创建 NSMutableArray 列表，因此：

```
NSMutableArray *mutableArray0 = [[NSMutableArray alloc] init];
NSMutableArray *mutableArray1 = [[NSMutableArray alloc] init];
NSMutableArray *mutableArray2 = [[NSMutableArray alloc] init];

multiArray = [[NSMutableArray alloc] init];
multiArray = [NSMutableArray arrayWithObjects:mutableArray0, mutableArray1, mutableArray2, nil]; 
```

另外，我认为 multiArray 也应该是 NSMutableArray 。试试这个，看看错误是否消失。

如果它不起作用，请尝试将逻辑分解为最简单的元素。你能用你的对象保存并取回一维数组吗？也就是说，如果您执行以下操作会发生什么？

```
NSMutableArray *mutableArray0 = [[NSMutableArray alloc] init];
[mutableArray0 addObject:[NSNumber numberWithInt:myNumber]];
NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];
[defaults setObject:mutableArray0 forKey:@"myMutableArray"];
[[NSUserDefaults standardUserDefaults] synchronize]; 
```

当您开始工作时，请尝试将其嵌套到另一个可变数组中，因此：

```
NSMutableArray *mutableArray0 = [[NSMutableArray alloc] init];
[mutableArray0 addObject:[NSNumber numberWithInt:myNumber]];

NSMutableArray *multiArray = [[NSMutableArray alloc] init];
[multiArray addObject:mutableArray0]; 
NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];
[defaults setObject:multiArray forKey:@"myMutableArray"];
[[NSUserDefaults standardUserDefaults] synchronize]; 
```

这应该有效。

# php - PHP 如何使用 PHP 读取字符串中的 XML 子节点值？

> ID：10707040
> 
> 赞同：4
> 
> 时间：2012-05-22T17:29:37.710
> 
> 标签：php, xml

我有一个从其他服务器动态获取其值的字符串。字符串的值为

```
$string1 = '<?xml version="1.0" encoding="utf-8"?>
<soap:Envelope xmlns:soap="http://schemas.microsoft.com/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
  <soap:Body>
    <AuthenticateUserResponse xmlns="http://microsoft.com/xml/namespace/2012/04">
      <Authenticator>AE1001</Authenticator>
    </AuthenticateUserResponse>
  </soap:Body>
</soap:Envelope>'; 
```

我的问题是，通常我们使用 *$xml = simplexml_load_file("test1.xml");* 来加载 XML 文件，但在我的要求中它是一个**String**，我如何读取这个 String 值并提取子节点及其价值？例子：

`<Authenticator> and its value "AE1001" ?`

有没有办法把它放到数组中？这样我就可以轻松打印出它的节点值？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-22T17:43:09.160

还要学习[DOMDocument](http://php.net/manual/en/class.domdocument.php)和[XPath](http://php.net/manual/en/class.domxpath.php)。真的值得花时间。

```
$doc = new DOMDocument;
$doc->loadXML($string1);

echo $doc->getElementsByTagName('Authenticator')->item(0)->nodeValue; // AE1001 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T17:34:32.673

[http://www.php.net/manual/de/function.simplexml-load-string.php](http://www.php.net/manual/de/function.simplexml-load-string.php)

[http://php.net/manual/de/book.simplexml.php](http://php.net/manual/de/book.simplexml.php)

这将帮助您找到问题的解决方案并解析您的 xml。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-22T17:39:24.867

[simplexml_load_string](http://php.net/manual/en/function.simplexml-load-string.php)

[DomDocument::loadXML](http://www.php.net/manual/en/domdocument.loadxml.php)

两者都可以帮助您完成任务

# android - TableLayout中的Android ImageButton

> ID：10707041
> 
> 赞同：0
> 
> 时间：2012-05-22T17:29:46.293
> 
> 标签：android, tablelayout, imagebutton

我需要 Java 代码中的 TableLayout 和 ImageButton 但有一个问题，所以我试图在 xml 中这样做，但我不明白为什么第一个按钮会这样。

```
<TableLayout 
android:layout_width="fill_parent" 
android:layout_height="fill_parent" 
xmlns:android="http://schemas.android.com/apk/res/android">
<TableRow>
    <ImageButton 
        android:src="@drawable/blankc4"
        />
    <ImageButton 
        android:background="@android:color/white"
        android:src="@drawable/blankc4"
        />
</TableRow>
<TableRow>
    <ImageButton 
        android:background="@android:color/white"
        android:src="@drawable/blankc4"
        />
    <ImageButton 
        android:background="@android:color/white"
        android:src="@drawable/blankc4"
        android:layout_column="2"
        />
</TableRow>
</TableLayout> 
```

**输出**

![在此处输入图像描述](../Images/48b5b7f6016f3bfeaa135e62a9df0ed5.png)

有什么我想念的吗。如果不是这个输出的解释是什么。

我只想要有和没有背景颜色的相同按钮。如何制作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T17:32:59.287

除了第一个之外，您为每个人设置了一个背景...

如果您只是在寻找图像作为按钮，请不要使用源标签，而是将背景设置为您想要的图像。

# android - 将 GridLayout 与 android 支持包 r8 一起使用

> ID：10707050
> 
> 赞同：2
> 
> 时间：2012-05-22T17:30:17.883
> 
> 标签：android, layout

我安装了 android 支持包 r8，我想在`GridLayout`这里使用我到目前为止在我的 xml 文件中尝试过的内容

```
<android.support.v4.widget.GridLayout> 
```

但是当我运行代码时，它告诉我找不到类，`android.support.v4.widget.GridLayout` 我打开了 jar 文件并查看包中没有`GridLayout.class`文件。任何人都知道如何使用`GridLayout`使用 android 支持包

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-28T14:11:56.990

GridLayout 的支持实现实际上是一个库项目，你需要将它包含在你自己的项目中。它可以在 extras/android/support/v7/gridlayout 下的 Android sdk 目录中找到。

此外，您需要`<android.support.v7.widget.GridLayout>`在布局中使用。

# batch-file - 尝试在批处理文件中多次使用变量

> ID：10707052
> 
> 赞同：0
> 
> 时间：2012-05-22T17:31:00.477
> 
> 标签：batch-file

我正在尝试编写一个使用起始变量运行多个操作的脚本，但它不起作用：该变量仅在第一次解析时才正确。你知道我做错了什么吗？这是批处理文件的限制还是我做错了什么？启用的扩展技术也不起作用。

```
SET FILE1=zr1
SET FILE2=za1
SET FILE3=za2

FOR /L %%I IN (1,1,3) DO ( 
-o "%%FILE%%I%%.out" 
ECHO %%FILE%%I%% 
CD p:\compress\compare 
XCOPY "p:\compress\compare\%%FILE%%I%%.out"   
RENAME "%%FILE%%I%%.out" "TEST" 
XCOPY "p:\compress\compare\%%FILE%%I%%.out" /e 
RENAME "%%FILE%%I%%.out" "GOOD" 
COMPARE 
RENAME "OUTPUT" "%%FILE%%I%%.out" 
CD p:\compress\outputFILEs 
XCOPY "p:\compress\compare\%%FILE%%I%%.out" /e 
) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T18:02:23.700

您需要正确使用延迟扩展。请记住，变量扩展分两个阶段实现：%percents% 首先*按从左到右的顺序*，然后是 !exclamations!：

```
ECHO !FILE%%I! 
```

有关更详细的说明，请参阅[此答案](https://stackoverflow.com/questions/10166386/arrays-linked-lists-and-other-data-structures-in-cmd-exe-batch-script/10167990#10167990)。

另外，我建议您以这种方式使用*数组表示法*进行此类管理：

```
SET FILE[1]=zr1
SET FILE[2]=za1
SET FILE[3]=za2
. . .
ECHO !FILE[%%I]! 
```

[这里](https://stackoverflow.com/questions/10544646/dir-output-into-bat-array/10569981#10569981)解释了这样做的原因

# python - 如何在 GTK3 和 python 中将 SVG src 绘制为图像？

> ID：10707056
> 
> 赞同：3
> 
> 时间：2012-05-22T17:31:18.910
> 
> 标签：python, svg, gtk3

我的代码如下所示：

```
img = '''<?xml version="1.0" encoding="UTF-8"?>
<svg width="50" height="50" xmlns="http://www.w3.org/2000/svg">
 <!-- Created with SVG-edit - http://svg-edit.googlecode.com/ -->
 <g>
  <title>Layer 1</title>
  <circle stroke-width="3" stroke="#1a1a1a" fill="#dfdbd2" r="16" cy="25" cx="25"/>
  <path stroke-width="0" fill="#1a1a1a" d="m25,9a16,16 0 0 0 0,32l0,-1.5a18,18 0 0 0 0,-29l0,-1.5z"/>
 </g>
</svg>''' 
```

如何在 gtk3 窗口中将其显示为图像以便我可以使用它？

```
 Image=Gtk.Image()
    Image.set_from_pixbuf(img) 
```

请原谅我的英语不好:)

# prototypejs - 原型：简单的点击功能

> ID：10707060
> 
> 赞同：1
> 
> 时间：2012-05-22T17:31:39.440
> 
> 标签：prototypejs

我不知道 Prototype 框架，我需要将一个简单的 jQuery 脚本转换为原型。

这是 jQuery：

```
$(document).ready(function(){

  $(".menu_button").toggle(
      function() { $("#nav_bg").css('display','block');},
      function() { $("#nav_bg").css('display','none');}
  );
}); 
```

谁能帮我把它翻译成原型？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T18:12:03.413

```
document.observe('dom:loaded' , function(){
    $$('.menu_button').each(function(s) { 
        s.observe('click', function(){
            $('nav_bg').toggle();
        });
    });
 }); 
```

我认为这会奏效。我认为您不必明确说明显示：块，我不确定原型如何决定它决定在切换时提供对象的显示，但通常选择正确的显示非常好。

如果你确实需要明确

```
document.observe('dom:loaded' , function(){
    $$('.menu_button').each(function(s) { 
        s.observe('click', function(){
            if ( $('nav_bg').getStyle('display') === 'block')
                $('nav_bg').setStyle({'display' : 'none'});
            else
                $('nav_bg').setStyle({'display' : 'block'});
        });
    });
}); 
```

不是很优雅，我相信原型有更好的方法。但我不是大师，这将完成它。

# mysql - 加入后找不到字段

> ID：10707066
> 
> 赞同：0
> 
> 时间：2012-05-22T17:32:37.683
> 
> 标签：mysql, sql

我正在使用 MySQL*世界*数据库的 InnoDB 版本（可[在此处](http://downloads.mysql.com/docs/world_innodb.sql.gz)获得），并试图获取南美洲国家及其首都的列表。在我看来，查询应该是这样的：

```
 SELECT `Country.Name` as `CountryName`, `City.Name` as `CityName`
    FROM `Country`, `City` 
    WHERE `Continent` = 'South America' AND `ID` = `Capital`; 
```

但是那个给出错误`#1054 - Unknown column 'Country.Name' in 'field list'`，即使表`Country`确实有该字段`Name`。

为什么 MySQL 找不到我想要的字段？如何更改查询以使其找到它们？

如果我需要提供更多信息以便您能够帮助我，请告诉我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T17:38:02.997

Try modifying your back ticks.

```
SELECT 
    `Country`.`Name` as `CountryName`,
    `City`.`Name` as `CityName` 
FROM `Country`, `City`
WHERE `Continent` = 'South America' AND `ID` = 'Capital'; 
```

Do not put them around the entire table.column, but around them individually with the period between them.

Also capitol should be single quotes and not back ticks.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-22T17:35:37.253

如果你引用标识符，不要用反引号包围内点。

```
SELECT
  `Country`.`Name` AS CountryName,
  `City`.`Name` AS CityName 
```

如果你在内部点周围引用，它将被假定在列名内，而不是表名和列名之间的分隔符——你有一个名为 的列`Name`，但没有一个名为的*列*`Country.Name`。然而，在这种情况下，没有必要引用任何标识符，因为它们都不是[MySQL 保留关键字](http://dev.mysql.com/doc/refman/5.5/en/reserved-words.html)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-22T17:34:17.820

这似乎是一个语法问题：

尝试改用这个：

```
`Country`.`Name` 
```

country.name （以刻度为单位）将是您所追求的字段的名称

```
`country`.`name` 
```

# mysql - mysql中autoincrement能产生的最大ID号是多少

> ID：10707072
> 
> 赞同：67
> 
> 时间：2012-05-22T17:33:11.823
> 
> 标签：mysql, database, integer, auto-increment

我有一个数据库，它快速填充了我们每天谈论 10-20k 行的数据。

带有自动增量选项的 ID 的限制是什么？如果 ID 被创建为 INTEGER 那么我可以为无符号值做 2,147,483,647 的最大值吗？

但是当自动增量超过这个值时怎么办？一切都崩溃了吗？那会有什么解决办法呢？

我相信很多人都有大数据库，我想听听他们的意见。

谢谢你。

* * *

## 回答 #1

> 赞同：73
> 
> 时间：2012-05-22T17:37:31.043

如果您担心它增长过快，我会将 PK 设置为 UNSIGNED BIGINT。这给你一个最大值 18446744073709551615，这应该足够了。

* * *

## 回答 #2

> 赞同：43
> 
> 时间：2013-12-22T12:37:17.660

```
 | Min. (inclusive)           | Max. (inclusive)
-----------------------------------------------------------------------------
INT Signed (+|-)    |             -2,147,483,648 |              2,147,483,647
-----------------------------------------------------------------------------
INT Unsigned (+)    |                          0 |              4,294,967,295
-----------------------------------------------------------------------------
BIGINT Signed (+|-) | -9,223,372,036,854,775,807 |  9,223,372,036,854,775,806
-----------------------------------------------------------------------------
BIGINT Unsigned (+) |                          0 | 18,446,744,073,709,551,615 
```

[MySQL 参考资料](https://dev.mysql.com/doc/refman/8.0/en/integer-types.html)。

如果您的 MySQL 表的列 ID (INT unsigned) 具有 auto_increment，并且该表有 4,294,967,295 条记录，那么您尝试再插入 1 条记录，新记录的 ID 将自动更改并设置为最大值“4,294,967,295 "，因此您会收到一条 MySQL 错误消息`Duplicate entry '4294967295' for key 'PRIMARY'`，如果该列设置为主键，您将有重复的 ID。

**2个可能的解决方案：**

1.  **简单的方法：通过将 ID 设置为****BIGINT unsigned**来扩展限制，就像**Dan Armstrong**所说的那样。虽然这并不意味着它是牢不可破的！当表变得非常大时，性能可能会受到影响。
2.  **更难的方法**：[使用分区，](https://stackoverflow.com/questions/2496127/when-to-use-which-mysql-partitioning-model)这是一种更复杂的方法，但性能更好，并且真正没有数据库限制（您唯一的限制是物理硬盘的大小。）。Twitter（和类似的大型网站）每天使用这种方法处理数百万条推文（记录）！

# node.js - 在 Node.js 中，计时器事件是否优先于 I/O 事件？

> ID：10707076
> 
> 赞同：0
> 
> 时间：2012-05-22T17:33:24.417
> 
> 标签：node.js

如果有一些数据要在套接字上读取，并且如果有一个计时器已经过去，那么首先会触发哪个回调？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T18:21:00.653

据我所知，回调函数运行如下：

1.  process.nextTick() 回调
2.  计时器
3.  输入输出

但我找不到证明链接。

# php - 将重命名的文件名从上传到数据库

> ID：10707078
> 
> 赞同：0
> 
> 时间：2012-05-22T17:33:25.687
> 
> 标签：php, mysql, database, file-upload, rename

我真的需要一些帮助。我需要将文件的新名称发布到数据库中。目前此代码正在将原始名称发布到数据库？如何将新名称发布到数据库？请看下面的代码。

```
<form action="" method="post" enctype="multipart/form-data">
<p>
    <label for="file">Name:</label>
    <input type="text" name="user_name" id="name" size="24"/> 
</p>
<p>
    <label for="file">Email Address:</label>
    <input type="text" name="email" id="email" size="24"/> 
</p>
<p>
    <label for="file">Phone Number:</label>
    <input type="text" name="phone" id="phoneNumber" size="24"/> 
</p>
<p>
    <label for="file">Comments:</label>
    <textarea cols="80" rows="6" name="comments"></textarea> 
</p>
<p>
    <label for="file">Filename:</label>
    <input type="file" name="fupload" id="fupload" size="24"/>
</p>
<br />
<input type="submit" name="submit" value="Submit" />
</form>
<br>
<br>
<?php
    require 'config.php';
    require 'functions.php';

    if(isset($_FILES['fupload'])) {
        if(preg_match('/[.](jpg)|(gif)|(png)$/',       $_FILES['fupload']['name'])) {
            $old_filename = $_FILES['fupload']['name'];
            $random_digit=rand(0000,9999);
            $filename=$random_digit . $old_filename;
            $source = $_FILES['fupload']['tmp_name'];
            $target = $path_to_image_directory . $filename;

            move_uploaded_file($source, $target);

            createThumbnail($filename);
        }
    }

    include "connect.php";
    $db_database = new mysqli($db_host, $db_user, $db_pass, $db_database);

    $user_name = stripslashes($_POST['user_name']);
    $email = stripslashes($_POST['email']);
    $phone = stripslashes($_POST['phone']);
    $comments = stripslashes($_POST['comments']);
    $filename = basename( $_FILES['fupload']['name']);

    $query = "INSERT into upload
          (user_name, email, phone, comments, fupload, date_added)
          values ('$user_name', '$email', '$phone', '$comments', '$filename', NOW())";
    $db_database->query($query);
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T17:54:47.617

你需要调整这条线：

```
$filename = basename( $_FILES['fupload']['name']); 
```

就在您创建 SQL 语句之前；您应该将`$filename`那里的值设置为文件的新名称。

哦，我相信很快就会有人指出您的脚本对 SQL 注入开放。

# c++ - 大文本显得模糊

> ID：10707083
> 
> 赞同：3
> 
> 时间：2012-05-22T17:33:54.007
> 
> 标签：c++, text, sfml, blurry

我正在使用SFML 1.6 制作一个小游戏，并且需要显示一些文字，所以我使用了`sf::String`该类。问题是，当我将尺寸增加到 96pt 时，边缘看起来有点模糊。但是，当我在 Microsoft Word 中增加文本的大小时，它看起来非常干净并且边缘清晰。有没有办法用 SFML 做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T17:57:31.393

查看 SFML 源，它似乎正在使用嵌入的 Arial 字体。是的，它也可以加载 .ttf 字体文件，但我猜你还没有加载它。

所以问题是 SFML 在渲染文本时会尝试缩放固定大小的位图。

要摆脱别名，请尝试遵循此示例 [http://www.sfml-dev.org/tutorials/1.4/graphics-fonts.php](http://www.sfml-dev.org/tutorials/1.4/graphics-fonts.php) 并手动加载 .ttf。

# ruby-on-rails - 获取在线用户 XMPP4r + Rails

> ID：10707084
> 
> 赞同：2
> 
> 时间：2012-05-22T17:33:54.713
> 
> 标签：ruby-on-rails, xmpp, ejabberd, xmpp4r

我正在尝试通过 XMPP 服务器（Ejabberd）中的用户获取在线朋友。我正在使用 Ruby on Rails 3.2。这个想法是在数组中添加所有在线用户以在视图页面上使用它。

我找到了异步代码（如下），但它使用 Thread 并且很难使用控制器方法。

```
jid = Jabber::JID.new('user@localhost')

cl = Jabber::Client.new(jid)
cl.connect
cl.auth('123456')
@online_users = [] #online users queue
roster = Jabber::Roster::Helper.new(cl)

mainthread = Thread.current

roster.add_presence_callback { |item,oldpres,pres|
  if item.online?
    @online_users.push item
  else
    @online_users.delete_if {|x| x.jid == item.jid }
  end  
  puts @online_users.inspect
  puts "#{item.jid} - online: #{item.online?}" 
}

cl.send(Jabber::Presence.new.set_show(:dnd))

t = Thread.new { sleep XMPP_REQUEST_TIMEOUT;   mainthread.wakeup;}
Thread.stop

cl.close 
```

所以我需要一些同步代码，或者在控制器方法中执行这种代码的某种方式。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-05T14:07:27.653

为此找到了另一个帮助我的解决方案：

我在 ejabberd 服务器中安装了[mod_rest 。](http://svn.process-one.net/ejabberd-modules/mod_rest/)该模块允许您对**ejabberdctl**的终端命令进行 HTTP 请求。

所以它有“ejabberdctl connected_users”，可以在线返回用户。

**因此，在您使用gem rest-client**的模型应用程序中，您可以执行以下操作：

```
def online_users
    response = RestClient.post('http://localhost:5280/rest', "connected_users")
    response
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T15:45:04.567

[如果您使用像Strophe.js](http://strophe.im/strophejs/)这样的库在浏览器中执行此操作，与启用了[BOSH](http://xmpp.org/extensions/xep-0206.html)的 XMPP 服务器通信，从长远来看，您会更快乐。存在快照永远不会像您期望的那样有趣，并且您将在前进的道路上遇到非常糟糕的身份验证/授权问题。

# ruby-on-rails - Rails 3.2.2 资产不在生产模式下工作

> ID：10707094
> 
> 赞同：0
> 
> 时间：2012-05-22T17:34:39.670
> 
> 标签：ruby-on-rails, asset-pipeline

免责声明：我已经看过了，但是有太多的解决方案对我不起作用，因此这篇文章。

在开发模式下使用 Rails 3.2.2 开发了一个简单的网站，所有资产都可以正常工作。当我切换到使用生产（即：rails server -e production）时，资产中断并且我得到 ActionController::RoutingError (No route matches [GET] "/stylesheets/application.css") 错误。

我没有更改 production.rb 文件。

感谢您帮助这个沮丧的人... :)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-22T17:38:23.383

You should [precompile the assets](http://guides.rubyonrails.org/asset_pipeline.html#precompiling-assets) before deploying the project.

```
bundle exec rake assets:precompile 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-23T12:05:04.053

我只是有同样的问题。我忘记将我的文件添加到 config.assets.precompile...

[Rails 资产用于开发而非生产](https://stackoverflow.com/questions/23230799/rails-assets-working-in-development-and-not-production/23231022)

在我的 config/environments/production.rb 我必须添加一个非默认资产列表（如插件）......

```
config.assets.precompile += w%( jquery.plugin.js awesome.css etc ) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-14T06:25:10.777

在 production.rb 中尝试`config.serve_static_assets = true`

# core-data - iOS核心数据持久化后重启应用

> ID：10707095
> 
> 赞同：0
> 
> 时间：2012-05-22T17:34:49.040
> 
> 标签：core-data, ios5, persistence

使用 Core Data，我可以在内存中保存和获取对象；但是，当我重新启动我的应用程序（在模拟器中）并获取结果时，会获取对象但所有属性都为零。我已经在我的 appdelegate 中包含了所有协议方法，并且已经初始化了我的 managedObjectContext：

managedObjectContext = [self managedObjectContext];

在 - (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions

这是我在日志中得到的...

正确：获取结果日志（应用未重新启动）--> 名称：新条目！！！！

不正确：获取结果日志（应用程序重新启动）-> 名称：（null）-但是，对象仍然存在于persistantStore

--

```
//Save entry
Entry *entry = (Entry *)[NSEntityDescription insertNewObjectForEntityForName:@"Entries" inManagedObjectContext:managedObjectContext];
[entry setTitle:@"new entry!!!!"];
NSError *error;
if(![managedObjectContext save:&error]){
    NSLog(@"SAVE ERROR!!!");
}

//Fetch entry
NSError *error;
NSFetchRequest *fetchRequest = [[NSFetchRequest alloc] init];
NSEntityDescription *entity = [NSEntityDescription entityForName:@"Entries"  inManagedObjectContext:managedObjectContext];
[fetchRequest setEntity:entity];
NSArray *fetchedObjects = [managedObjectContext executeFetchRequest:fetchRequest     error:&error];
for (NSManagedObject *info in fetchedObjects) {
    NSLog(@"Name: %@", [info valueForKey:@"title"]);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T18:41:00.473

您确定您的 Entry 类使用 @dynamic 而不是 @synthetize 实现 title 属性吗？

# deployment - 如何在 JBoss AS 7 中指定外部配置？

> ID：10707101
> 
> 赞同：1
> 
> 时间：2012-05-22T17:34:57.487
> 
> 标签：deployment, configuration, jboss7.x

我们正在从 JBoss Application Server 5.1 升级到 AS 7。在 AS 5.1 中，我们在“-service.xml”文件中定义了一个 Properties 对象，以便我们可以外部化所有配置。然后我们通过 JNDI 读取这个属性对象。

例子：

```
<?xml version="1.0" encoding="UTF-8"?>
<mbean code="org.jboss.naming.JNDIBindingServiceMgr" name="jboss.apps:name=myProperties">
        <attribute name="BindingsConfig" serialDataType="jbxb">
            <jndi:bindings xmlns:xs="http://www.w3.org/2001/XMLSchema-instance"
                    xmlns:jndi="urn:jboss:jndi-binding-service:1.0"
                    xs:schemaLocation="urn:jboss:jndi-binding-service resource:jndi-binding-service_1_0.xsd">
                    <jndi:binding name="myConfig">
                            <java:properties xmlns:java="urn:jboss:java-properties"
                                    xmlns:xs="http://www.w3.org/2001/XMLSchema-instance"
                                    xs:schemaLocation="urn:jboss:java-properties resource:java-properties_1_0.xsd">
                                    <java:property>
                                     ... 
```

在 AS 7 中执行此操作的适当方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T14:20:34.063

这里解释：[https ://community.jboss.org/message/641742#641742](https://community.jboss.org/message/641742#641742)

似乎可以从 AS 7.1 开始，而不是在 7.0 中。不过还没试过。

# sql - DB2 - 如果第一个游标不返回任何内容，则打开下一个游标

> ID：10707102
> 
> 赞同：2
> 
> 时间：2012-05-22T17:34:57.830
> 
> 标签：sql, stored-procedures, db2

我正在尝试做的事情：

我在 DB2 存储过程中有两个游标。我想运行第一个，如果它返回一个空的结果集，那么我想运行下一个游标。实现这一点的语法是什么？我可以在打开游标之前评估结果吗？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T20:09:50.707

[DB2 SQL Cookbook](http://mysite.verizon.net/Graeme_Birchall/id1.html)有很多有用的示例，包括游标的使用和错误处理。就输出测试而言，您可以更轻松地使用与游标`IF EXISTS()`运行相同查询的测试来围绕游标。

# android - Tools seems to lag behind Android emulator

> ID：10707108
> 
> 赞同：1
> 
> 时间：2012-05-22T17:35:23.303
> 
> 标签：android, eclipse, debugging, adb

Ever since updating to the latest ADT (version 18), I've noticed that there seems to be some sort of odd lag between what's happening on device emulators and what various tools are seeing. For instance, if I set a breakpoint in Eclipse and then attach the debugger to a running app, the debugger will miss the first time that the breakpoint is reached, breaking only on subsequent executions. Similarly, if I try to take a screen snapshot with the Devices view, the image is always from one or two screen changes back. Similar behavior happens if I run `hierarchyviewer` outside of Eclipse, so I don't think it's an Eclipse problem specifically.

I should mention that the part of the app that I've tested this with has static screens that change only on user input (that is, no animations or background threads); so it's not just a communication lag. I can change screens, wait five minutes, take a screen snapshot, and still get an image of what had previously been on the screen. Screen snapshots in perticular never seem to catch up. (Repeating the snapshot still generates the previous screen, not the one on display.)

Has anyone else seen this behavior? Does anyone know how to fix it?

UPDATE: This is on a Windows 7 machine running Java 1.6.0_26 and Eclipse 3.7 (Indigo).

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T14:29:09.007

The Google/Android team have been enhancing the emulator images with the ADT updates like GPU support and sensor injection. If you are using old emulator builds (AVDs) from when you first created your work environment (say months ago) you will want to recreate them fresh from the new tools and see if the problem resolves.

# php - strstr 的相反 PHP 函数返回字符串的第一部分，而不是最后一部分

> ID：10707113
> 
> 赞同：5
> 
> 时间：2012-05-22T17:35:41.497
> 
> 标签：php, string, strstr

我有一个字符串，是这样的：

```
$abcdef(+$1.00) 
```

我试图在第一个括号之前获取字符串的第一部分：

```
$abcdef 
```

目前，如果我使用`strstr()`它将返回指定字符之后的字符串部分：

```
$newstr = strstr($var, '('); 
```

我想要发生之前的部分。[strstr()](http://www.php.net/manual/en/function.strstr.php)的反向或相反功能是什么？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-22T17:37:20.387

将 true 作为第三个参数传递。

从[您链接的手册页](http://www.php.net/manual/en/function.strstr.php)：

```
string strstr (string $haystack , mixed $needle [, bool $before_needle = false ]) 
```

> **before_needle**：如果为 TRUE，strstr() 返回第一次出现针之前的大海捞针部分（不包括针）。

**注意：**此参数仅在 PHP 5.3 中添加。如果由于某种原因您留下了旧版本，那么`substr()`和的组合`strpos()`应该会有所帮助：

```
$newstr = substr( $var, 0, strpos( $var, '(' ) ); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-22T17:38:50.003

将 strstr 的第三个参数设置为 true 它将在针之前返回出现

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-10-20T17:04:41.803

以简单的方式执行此操作的更好方法是：

$newstr = explode('(',$var)[0];

解释： $result = explode('search_for_this' , $search_in_this)[0];

# php - 如何正确保存此字符串？

> ID：10707128
> 
> 赞同：-1
> 
> 时间：2012-05-22T17:37:21.720
> 
> 标签：php

这是我的代码：

网址：

```
http://www.mysite.com/t.php?title=The%20Police%20-%20Don't%20Stand%20So%20Close%20to%20Me%20'86%20- 
```

PHP：

```
<?php if(!empty($_GET['title'])){ >
<form method="post" action="t.php?done=yes" enctype="multipart/form-data">
<input type="text" name="title" 
<?php echo "value=\"".htmlspecialchars($_GET['title'])."\""; ?> 
> 
<input name="submit" value="Submit" type="submit" />
</form>
<?php } >

<?php if(!empty($_POST['title'])){ 
echo mysql_real_escape_string($_POST['title']);
// I have to put the string in a database ( I haven't added that part )
 } > 
```

如果我按照第一个 URL 然后提交表单，我会得到这个字符串：

```
The Police - Don\\\'t Stand So Close to Me \\\'86 - 
```

代替：

```
The Police - Don't Stand So Close to Me '86 - 
```

为什么 ？我怎样才能得到最后一个字符串？

谢谢

.

**编辑：**

我刚刚发现 magic_quotes_gpc 为 ON，因为 get_magic_quotes_gpc() 返回 TRUE。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T17:47:13.213

可能是因为这个字符串

```
The Police - Don't Stand So Close to Me '86 - 
```

通过`magic_quotes_gpc on`在你的 php.ini 上给你 qoute 转义

```
The Police - Don\'t Stand So Close to Me \'86 - 
```

进而

```
echo mysql_real_escape_string($_POST['title']); 
```

逃避`'`并`\`成为

```
The Police - Don\\\'t Stand So Close to Me \\\'86 - 
```

尝试使用您的代码进行设置

```
ini_set ( 'magic_quotes_gpc', '0' ); 
```

如果没有，您可以通过编码并删除斜杠来检查它

```
if (get_magic_quotes_gpc()) {
    $title = stripslashes($_POST['title']);
}
else {
    $title = $_POST['title'];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T17:41:48.267

您能否提供有关此区块的更多信息？

```
<?php if(!empty($_POST['title'])){ 
echo mysql_real_escape_string($_POST['title']);
 } > 
```

这仅用于调试目的吗？如果是这样，用 mysql_escape_string 回显是没有用的，这显然会“破坏”变量的可见值。请发布没有此功能的回声。

rgds

# python - 如何让 Python 2.7 和 Python 3.1 在 windows 7 上共存？

> ID：10707130
> 
> 赞同：4
> 
> 时间：2012-05-22T17:37:31.577
> 
> 标签：python

我的桌面上安装了 Python 3.1，但现在我需要 Python 2.7 才能运行 CQL。我在我的盒子上安装了两个版本的 Python，输入“Python”，调用了 3.1 版本。但是当我尝试通过指定2.7的可执行文件的路径来使用2.7版本时，再次调用了3.1，出现了一些错误，如下所示：

```
C:\Python27>.\python.exe
Traceback (most recent call last):
  File "C:\Python31\lib\site.py", line 56, in <module>
    import os
  File "C:\Python31\lib\os.py", line 380, in <module>
    from _abcoll import MutableMapping  # Can't use collections (bootstrap)
  File "C:\Python31\lib\_abcoll.py", line 54
    class Hashable(metaclass=ABCMeta):
                        ^
SyntaxError: invalid syntax 
```

我应该/可以做些什么来让这两个 Python 版本都为我工作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T18:01:58.213

要么使用[cygwin](http://www.cygwin.com/)来拥有一个不错的 bash 环境，从而可以轻松地使用特定的解释器启动 python 脚本，或者使用[virtualenv](http://pypi.python.org/pypi/virtualenv)来创建基于特定解释器的环境：

```
> mkdir project
> cd project
> C:\Python27\Scripts\virtualenv.exe -p C:\Python32\python.exe .
> Scripts\activate 
```

至此，你的 env 已经设置为这个项目，输入`python`会启动 python3.2
你会输入`deactivate`恢复到正常的 env。使用这种方法，您可以在每个项目的基础上进行设置，以管理 python 项目之间的版本依赖关系，或者您可以为每个 python 版本使其更具全局性。由你决定。

在基于 *nix 的系统中，我们可以在脚本顶部使用“shebang”行来告诉它使用哪个解释器。Windows 仅通过 GUI 具有文件扩展名关联，并且您必须在命令行中以以下形式明确`python <script.py>`

# java - Java Servlet 中的 SendRedirect 与 Forward 用例

> ID：10707136
> 
> 赞同：1
> 
> 时间：2012-05-22T17:38:38.090
> 
> 标签：java, html, servlets

我有一个简单的 html 页面，目的是对写入数据库的实体进行更改。页面有两种形式：

*   GET：选择要更改的实体
*   POST：处理对实体的更改并将其写入数据库

执行 POST 操作时，我想再次显示同一页面，此外，我想保持 GET 操作设置的实体参数。目前，我在**doPost**方法的末尾执行以下操作：

```
response.sendRedirect(path + "?entity=" + entityValue); 
```

效果很好，但是在阅读了[forward 和 sendRedirect](https://stackoverflow.com/questions/2047122/requestdispatcher-interface-vs-sendredirect)之间的区别之后，我认为我必须使用 forward，但这不起作用，因为 doGet 方法不会像 sendRedirect 那样执行。那么我的方法是正确的还是应该以另一种方式解决？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-22T18:40:48.770

你的方法很棒。它使用[post-redirect-get](http://en.wikipedia.org/wiki/Post/Redirect/Get)模式，它有几个优点：

*   干净的 URL，可添加书签，例如可以通过电子邮件发送
*   没有通过点击刷新按钮重新提交修改的风险
*   浏览器历史记录的干净导航
*   获取和发布 URL 之间的职责分离

所以保持一切原样。在这种情况下，转发是比重定向更不理想的解决方案。

# iphone - 使用 __weak 属性将参数传递给块会导致内存泄漏吗？

> ID：10707143
> 
> 赞同：4
> 
> 时间：2012-05-22T17:39:05.770
> 
> 标签：iphone, ios, ios5, objective-c-blocks

在我的支持 ARC 的 iOS 代码中，我需要将“self”和其他对象传递给一个块。更具体地说，我需要与 self 和's中的`ASIHTTPRequest`对象进行交互。`ASIHTTPRequest``completionBlock`

```
_operation = [[NSInvocationOperation alloc] initWithTarget:self selector:@selector(parseServerReply) object:nil];
_request = [ASIHTTPRequest requestWithURL:@"server.address"];

// ...

[_request setCompletionBlock:^{
    [self setResponseString:_request.responseString];
    [[MyAppDelegate getQueue] addOperation:_operation];
}]; 
```

为了避免以下警告：`Capturing "self" strongly in this block will likely lead to a retain cycle`. 我已经修改了我的代码，以添加`__weak`在这篇文章之后的块中使用的对象的属性：[在启用 ARC 的代码中修复警告“在此块中强烈捕获 [一个对象] 可能导致保留周期”](https://stackoverflow.com/questions/7205128/fix-warning-capturing-an-object-strongly-in-this-block-is-likely-to-lead-to-a)

结果代码是：

```
_operation = [[NSInvocationOperation alloc] initWithTarget:self selector:@selector(parseServerReply) object:nil];
_request = [ASIHTTPRequest requestWithURL:@"server.address"];

// ...
__weak NSOperation * operation = _operation;
__weak ASIHTTPRequest * request = _request;
__weak typeof(self) * self_ = self;

[request setCompletionBlock:^{
    [self_ setResponseString:request.responseString];
    [[MyAppDelegate getQueue] addOperation:operation];
}]; 
```

我想知道这是否仍会导致保留周期和内存泄漏。如果是这样，有没有办法避免泄漏？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-05-22T20:23:14.470

您不需要使所有内容变弱，也不需要继续引用块中的弱对象（特别是如果块可以在不同的线程中执行）。

这样想吧。使用 ARC 时，对象被引用计数。在引用计数变为零之前，不会对对象调用 dealloc。因此，只要周围有一个引用，对象就会保持活动状态。

但是，请考虑两个相互具有强引用的对象。在另一个释放其引用之前，两者都不会释放。

创建块时，它会捕获其环境，这意味着它将创建对块范围内使用的任何对象的强引用。

考虑到这一点...

```
id object = getMeSomeObject();
// <object> is implicitly __strong, and now has a reference. 
```

在释放所有强引用之前，该对象不会被释放。如果在块中使用它，块会自动创建自己的强引用，以确保对象与块一样长。

__weak 引用是一种间接级别，它使您可以在对象存在时访问对象。基本上，如果您将一个对象分配给一个 __weak 指针，只要该对象是活动的，该指针就可以保证为您提供相同的对象。一旦对象启动它自己的 dealloc()，它就会找到所有的 __weak 指针并将它们设置为 nil。

因此，您的 _weak 指针将始终处于两种状态之一。只要对象存在，它就指向一个有效的对象，或者当对象具有 dealloc 时它是 nil。你**永远不**应该通过弱指针访问一个对象，因为这个对象可能会在你背后释放，给你留下一个坏指针。

所以，你想要做的是在堆栈上创建一个 __strong 引用，以便对象只要你想要它就保持活动状态。

在你的情况...

```
[_request setCompletionBlock:^{
    [self setResponseString:_request.responseString];
    [[MyAppDelegate getQueue] addOperation:_operation];
}]; 
```

这个块显然对`self`. 你可能不希望那样。让我们尝试修复它...

```
// weakSelf will be "magically" set to nil if <self> deallocs
__weak SelfType *weakSelf = self;
[_request setCompletionBlock:^{
    // If <self> is alive right now, I want to keep it alive while I use it
    // so I need to create a strong reference
    SelfType *strongSelf = weakSelf;
    if (strongSelf) {
        // Ah... <self> is still alive...
        [strongSelf setResponseString:_request.responseString];
        [[MyAppDelegate getQueue] addOperation:_operation];
    } else {
        // Bummer.  <self> dealloc before we could run this code.
    }
}]; 
```

嘿，我们现在有一个 weak `self`，但是......你仍然会遇到同样的问题。为什么？因为 _request 和 _operation 是实例变量。如果您访问块内的实例变量，它会隐式创建对`self`.

再给它一次...

```
// weakSelf will be "magically" set to nil if <self> deallocs
__weak SelfType *weakSelf = self;
[_request setCompletionBlock:^{
    // If <self> is alive right now, I want to keep it alive while I use it
    // so I need to create a strong reference
    SelfType *strongSelf = weakSelf;
    if (strongSelf) {
        // Ah... <self> is still alive...
        [strongSelf setResponseString:strongSelf->_request.responseString];
        [[MyAppDelegate getQueue] addOperation:strongSelf->_operation];
    } else {
        // Bummer.  <self> dealloc before we could run this code.
    }
}]; 
```

现在，您可能不应该在“原始”中使用实例变量，但这是一个不同的主题。

通过这些更改，您将拥有一个不再对 self 有强引用的块，如果`self`确实进行了释放，它会优雅地处理它。

最后，我要重申，给 strongSelf 赋值是必要的，以防止在检查 weakSelf 后对象消失的潜在问题。具体来说...

```
if (weakSelf) {
    // Hey, the object exists at the time of the check, but between that check
    // and the very next line, its possible that the object went away.
    // So, to prevent that, you should ALWAYS assign to a temporary strong reference.
    [weakSelf doSomething];
}

strongSelf = weakSelf;
// OK, now IF this object is not nil, it is guaranteed to stay around as long as
// strongSelf lives. 
```

现在，在这种情况下，块是请求的一部分，这是deallocs`self`的可能性`self`很小的一部分，但我这里的主要观点是使用self来防止保留循环，但仍然始终通过强引用访问对象——弱强舞。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T18:00:30.193

您生成的代码是安全的。[在此处](https://stackoverflow.com/questions/8592289/arc-the-meaning-of-unsafe-unretained)阅读 Brad Larson 的回答了解详情。

# java - 如何将“this”传递给动作监听器

> ID：10707144
> 
> 赞同：0
> 
> 时间：2012-05-22T17:39:06.917
> 
> 标签：java, swing, actionlistener

我有一个扩展 JFrame 的 MainWindow 类，它是我的应用程序中唯一的框架。不过，我有几个 JPanel 可以更改其内容。我想传递 MainWindow，这样我就不必制作它的全局副本。

这是问题所在。我在 MainWindow 中有一个假的 JMenuBar，我用来四处寻找屏幕。在他们的 JMenuItem 侦听器中，我无法将 MainWindow 作为 this 传递给 JPanel。

有没有办法可以做到这一点，比如可能将课程标记为最终课程，或者每次我必须通过一个时我必须创建一个新的 MainWindow。它不携带任何数据，因此它并不重要，性能也不是像这样的小型最终项目的主要关注点，但我想知道是否有更好的方法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-22T17:43:53.617

您是否无法通过`this`，因为它会引用侦听器？如果是这样，您应该可以使用`MainWindow.this`.

或者创建`this`对侦听器外部的引用并将其作为参数传递。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T17:48:04.697

创建 MainWindow 类作为 Outer 类，并将其扩展到您已经做过的 JFrame，。现在在 MainWindow 类中，根据需要创建尽可能多的内部类，并让 ActionListener 方法以不同的方式处理..

例如：

```
 MainWindow extends JFrame {

    MainWindow(){

    }

    class panel1 extends JPanel implements ActionListener{

    }

    class panel2 extends JPanel implements ActionListener{

    }

} 
```

您还可以实现单例模式，以确保只有一个 MainWidow 实例。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-22T17:55:31.570

尝试以下任何一种方法：

*   做`MainWindow`单例。
*   创建侦听器时在方法中标记为`final`变量。
*   采用`MainWindow.this`

对于您的情况，请使用单例方法，您可以从项目的任何位置自由访问。

# macos - 在有空格的目录中查找最后修改的文件

> ID：10707145
> 
> 赞同：4
> 
> 时间：2012-05-22T17:39:11.433
> 
> 标签：macos, perl, bash, find

我找到并调整了这个脚本，以递归方式在目录中找到最近修改的文件。仅当目录名称中有空格时才会中断。任何人都可以帮我调整脚本，以便它也可以读取带有空格的目录吗？

```
for i in *; do

find $i -type f | perl -ne 'chomp(@files = <>); my $p = 9; foreach my $f (sort { (stat($a))[$p] <=> (stat($b))[$p] } @files) { print scalar localtime((stat($f))[$p]), "\t", $f, "\n" }' | tail -1

done 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-19T08:53:36.563

珀尔？您没有 bash 并且喜欢编写长行代码？;-)

```
find . -type f -printf '%T+ %p\n' | sort -r | head -n1 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-22T17:41:06.123

报价可以解决一切。

```
find "$i" -type f 
```

此外，您不需要`tail`. 打印后只需交换`$a`并`$b`退出。

```
find $i -type f | perl -lne 'chomp(@files = <>); my $p = 9; foreach my $f (sort { (stat($b))[$p] <=> (stat($a))[$p] } @files) { print scalar localtime((stat($f))[$p]), "\t", $f; exit }' 
```

并且`-l`（字母“ell”）在打印时为您附加换行符。

**编辑：**

实际上根本不需要循环：

```
find  -type f | perl -lne 'chomp(@files = <>); my $p = 9; @files = sort { (stat($b))[$p] <=> (stat($a))[$p] } @files; print scalar localtime((stat($files[0]))[$p]), "\t", $files[0]' 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-22T18:18:06.473

全部用 Perl 编写似乎不那么混乱

```
perl -MFile::Find -e 'find(sub{@f=((stat)[9],$File::Find::name) if -f && $f[0]<(stat)[9]},".");print "@f")' 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-22T17:42:04.800

由于您只处理当前目录，因此您只需使用一个命令即可：

```
find . -type f | perl -ne 'chomp(@files = <>); my $p = 9; foreach my $f (sort { (stat($a))[$p] <=> (stat($b))[$p] } @files) { print scalar localtime((stat($f))[$p]), "\t", $f, "\n" }' | tail -1 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-22T19:22:00.107

默认情况下，下面的代码搜索当前工作目录下的子树。您还可以在命令行上再命名一个要搜索的子树。

```
#! /usr/bin/env perl

use strict;
use warnings;

use File::Find;

my($newest_mtime,$path);
sub remember_newest {
  return if -l || !-f _;
  my $mtime = (stat _)[9];
  ($newest_mtime,$path) = ($mtime,$File::Find::name)
    if !defined $newest_mtime || $mtime > $newest_mtime;
}

@ARGV = (".") unless @ARGV;
for (@ARGV) {
  if (-d) {
    find \&remember_newest, @ARGV;
  }
  else {
    warn "$0: $_ is not a directory.\n";
  }
}

if (defined $path) {
  print scalar(localtime $newest_mtime), "\t", $path, "\n";
}
else {
  warn "$0: no files processed.\n";
  exit 1;
} 
```

如所写，代码不遵循符号链接。如果您在命令行上命名符号链接，您将看到以下输出

```
$ ./find-newest ~/link-to-directory
./find-newest：未处理任何文件。
```

使用*bash*，您必须添加一个斜杠来强制取消引用。

```
$ ./find-newest ~/link-to-directory/
1970 年 1 月 1 日星期四 00:00:00
```

# python - 带有 xerr 的散点图和带有 matplotlib 的 yerr

> ID：10707147
> 
> 赞同：9
> 
> 时间：2012-05-22T17:39:44.693
> 
> 标签：python, plot, matplotlib

我希望将两个数组的位置相互可视化。我的表看起来像这样

```
 Number          Description      value_1  value_2  err_1 err_2
         1          descript_1       124.46   124.46   22.55  54.2
         2          Descript_2       8.20     50.2     0.37   0.1 
         3          Descript_2       52.55    78.3     3.77   2.41
         4          Descript_2       4.33     778.8    0.14   1.78 
```

我基本上想要的是这样的： ![带有两个误差线的散点图](../Images/e2cd82fb741a3be7c5ed45296c2e44a2.png)

所以在这个图中，每个点基本上都有三个属性：1\. xerror bar 2\. yerror bar 3\. 描述这个点代表什么。

我有一种感觉，这可以用 matplotlib 优雅地完成，虽然我尝试了一些带有错误栏的东西，但这些东西并没有给我我所期望的。而且我还没有找到如何将字幕放在情节中。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-22T18:34:09.873

听起来你想要这样的东西？

```
import matplotlib.pyplot as plt

x = [124.46, 8.20, 52.55, 4.33]
y = [124.46, 50.2, 78.3, 778.8]
xerr = [54.2, 0.1, 2.41, 1.78]
yerr = [22.55, 0.37, 3.77, 0.14]

descrip = ['Atom 1', 'Atom 2', 'Atom 3', 'Atom 4']

plt.errorbar(x, y, xerr, yerr, capsize=0, ls='none', color='black', 
            elinewidth=2)

for xpos, ypos, name in zip(x, y, descrip):
    plt.annotate(name, (xpos, ypos), xytext=(8, 8), va='bottom',
                textcoords='offset points')

plt.show() 
```

![在此处输入图像描述](../Images/ce7cf27158d425c96fd1545eec0d9dc4.png)

`errorbar`就像`plot`. 如果你想要一个“散点图”，那么你需要指定`linestyle='none'`（或等效地，`ls='none'`）。根据您的绘图，您不希望错误栏上设置上限，因此我指定了`capsize=0`. 同样，您似乎希望误差线的线条相当粗，因此`elinewidth=2`.

如果您想要除错误栏之外的标记，只需指定`marker='o'`（或您想要的任何标记样式）到`errorbar`.

`annotate`是在绘图上注释点的最简单方法。在这里，我已指定注释应放置在每个测量值的上方和右侧8*点处。*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-09-14T23:24:24.223

惯于

```
import matplotlib.pyplot as plt

x = [100, 200, 300, 400]
y = [100, 200, 300, 400]
xerr = [100, 100, 100, 100]
yerr = [20, 20, 20, 20]

plt.errorbar(x, y, xerr, yerr, ls='none')
plt.show() 
```

意味着误差线在错误的轴上？

[pyplot.errorbar](http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.errorbar)：

```
matplotlib.pyplot.errorbar(x, y, yerr=None, xerr=None, fmt=u'', ecolor=None, elinewidth=None, capsize=3, barsabove=False, lolims=False, uplims=False, xlolims=False, xuplims=False, errorevery=1, capthick=None, hold=None, **kwargs) 
```

注意 yerr 在 xerr 之前，所以

```
plt.errorbar(x, y, xerr, yerr, ls='none') 
```

使您的误差线向后 - yerr=xerr，xerr=yerr。使用命名参数的好时机：

```
plt.errorbar(x, y, xerr=xerr, yerr=yerr, ls='none') 
```

# makefile - Why does Make ignore my wildcard rule?

> ID：10707149
> 
> 赞同：0
> 
> 时间：2012-05-22T17:39:49.613
> 
> 标签：makefile

Why doesn't Make link to `foo.o`?

```
$ ls
foo.c  foo_test.c  Makefile

$ cat Makefile 
.PHONY: test
test: foo_test
%_test: %_test.o foo.o

$ make
cc     foo_test.c   -o foo_test 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T19:54:57.537

模式规则必须有一个与之关联的配方。任何没有配方的模式规则都会告诉 GNU make 删除该模式规则。所以，你的行：

```
%_test: %_test.o foo.o 
```

`%_test`除了删除要构建的不存在的模式规则之外，什么都不做`%_test.o`。如果您希望它生效，您需要创建一个配方：

```
%_test: %_test.o foo.o
        $(CC) -o $@ $(LIBS) $^ 
```

管他呢。但是，这对于您的示例完全没有必要。您根本不需要任何规则，只需编写：

```
foo_test: foo_test.o foo.o 
```

让 make 的内置规则来处理它。

# windows-7 - the action can't be completed because the folder or a file in it is open in another program

> ID：10707151
> 
> 赞同：7
> 
> 时间：2012-05-22T17:40:06.927
> 
> 标签：windows-7

When deleting a folder that contains a file that is in use, it is common to see the following Windows 7 message,

> "The action can't be completed because the folder or a file in it is open in another program."

I commonly have 10-20 programs open, 30-40 folders open, etc. In short, I have many executables running and many windows explorers open.

Does anyone know a simple trick to determine *which* program is using the file? Does anyone know a simple trick to determine *which* file is blocking the delete operation?

This information would be highly useful to display in the Windows 7 'folder in use' dialog, but it is missing.

Consequently I have to close many of my open applications and folders to complete the delete operation. This is annoying because I have to re-open them after deleting them.

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-14T07:48:09.003

你见过这个[其他问题](https://stackoverflow.com/questions/229851/overcoming-it-is-being-used-by-another-person-or-program)或[这个](https://superuser.com/questions/117902/easy-way-to-find-out-which-process-is-locking-a-file-or-folder-in-windows)问题吗？

我用来为被阻止的文件夹运行 ProccessExplorer 和 Find。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-06-15T18:17:40.077

关闭应用程序 Malwarebytes 允许我通过 Windows 资源管理器删除我需要的内容。

# android - 单个 TextView 中的多行

> ID：10707155
> 
> 赞同：0
> 
> 时间：2012-05-22T17:40:15.837
> 
> 标签：android, simplecursoradapter

我有一个应用程序，它有一个包含多个字段的车辆数据库。然后我有一个 ListView，我想在其中显示一些字段。目前我有这个：

```
SimpleCursorAdapter vehicleAdapter = new SimpleCursorAdapter(this, R.layout.vehiclerow, vehicleCursor, new String[] {"registration"}, new int[] { R.id.vehicleRow}); 
```

我想在 vehicleRow TextView 上放置多个值，例如：

```
Toyota - Corolla 
```

其中丰田和卡罗拉来自数据库的不同字段。

我试过这个：

```
SimpleCursorAdapter vehicleAdapter = new SimpleCursorAdapter(this, R.layout.vehiclerow, vehicleCursor, new String[] {"make", "model"}, new int[] { R.id.vehicleRow}); 
```

但它不起作用。

可能是什么问题呢？

问候

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T17:58:01.430

创建另一个 TextView 并在 cursorAdapter 中输入其 Id。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T17:59:20.383

您只能使用标准适配器将一个数据字段映射到一个视图。

您要么需要创建一个自定义适配器，让您将两个数据字段放入一个小部件中（并不总是微不足道的），要么创建一个带有必要文本视图的新行布局，并将其与标准适配器一起使用。

我会选择第二个选项。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-22T18:00:07.383

以这种方式尝试：

```
String[] from = new String[]{DbManager.Title, DbManager.Date}; 
        int[] to = new int[] { R.id.list_name_main,R.id.list_date_main};{                   
        Adapter = new SimpleCursorAdapter(this, R.layout.row_item_by_list, c1, from, to);       
        //Adapter.setViewBinder(new ScoreHistoryBinder());
        list_item.setAdapter(Adapter);
        list_item.setOnItemClickListener(listOnItemClickListener);} 
```

# deployment - SSH Error: "Not a RSA1 key file ~/.ssh/id_rsa.", "key_type_from_name: unknown key type '-----BEGIN'"

> ID：10707156
> 
> 赞同：10
> 
> 时间：2012-05-22T17:40:25.730
> 
> 标签：deployment, heroku, ssh, ssh-keys, openssh

```
git push heroku master 
```

returns:

```
ssh_exchange_identification: read: Connection reset by peer      
fatal: The remote end hung up unexpectedly. 
```

This is the first time I've tried to push to heroku.

*   `heroku login` returns "Authentication successful"
*   ~/.ssh/id_rsa was originally created by the heroku command line client - I ran `heroku login` for the first time and it asked if I wanted to generate a key.
*   I recreated keys using `ssh-keygen -t rsa` (as specified [here](https://devcenter.heroku.com/articles/keys)) and then tried again but in vain.
*   Created "authorized_keys" at "~/.ssh" and with my public key in it, no luck.
*   Created /etc/hosts.allow with contents "sshd all", still no luck.

Permissions on the keys are : "-rw-------" Heroku status is O.K. I'm using Mac OS X 10.7.

```
ssh -vvv myloginname@heroku.com 
```

returns:

```
OpenSSH_5.6p1, OpenSSL 0.9.8r 8 Feb 2011   
debug1: Reading configuration data /etc/ssh_config  
debug1: Applying options for *  
debug2: ssh_connect: needpriv 0   
debug1: Connecting to heroku.com [50.19.85.132] port 22\.   
debug1: Connection established.   
debug3: Not a RSA1 key file ~/.ssh/id_rsa.   
debug2: key_type_from_name: unknown key type '-----BEGIN'   
debug3: key_read: missing keytype    
debug3: key_read: missing whitespace   
debug3: key_read: missing whitespace   
debug3: key_read: missing whitespace    
debug3: key_read: missing whitespace   
debug3: key_read: missing whitespace   
debug3: key_read: missing whitespace  
debug3: key_read: missing whitespace   
debug3: key_read: missing whitespace   
debug3: key_read: missing whitespace   
debug3: key_read: missing whitespace     
debug3: key_read: missing whitespace    
debug3: key_read: missing whitespace     
debug3: key_read: missing whitespace     
debug3: key_read: missing whitespace      
debug3: key_read: missing whitespace       
debug3: key_read: missing whitespace       
debug3: key_read: missing whitespace        
debug3: key_read: missing whitespace           
debug3: key_read: missing whitespace            
debug3: key_read: missing whitespace              
debug3: key_read: missing whitespace               
debug3: key_read: missing whitespace               
debug3: key_read: missing whitespace             
debug3: key_read: missing whitespace           
debug3: key_read: missing whitespace             
debug2: key_type_from_name: unknown key type '-----END'             
debug3: key_read: missing keytype               
debug1: identity file ~/.ssh/id_rsa type 1             
debug1: identity file ~/.ssh/id_rsa-cert type -1            
debug1: identity file ~/.ssh/id_dsa type -1            
debug1: identity file ~/.ssh/id_dsa-cert type -1               
ssh_exchange_identification: read: Connection reset by peer 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-11-23T02:02:32.230

我有同样的问题（不是在heroku上），而是在我自己的服务器上。

尝试查看**/var/log/auth.log** 我的**~/.ssh/authorized_keys**文件由错误的用户拥有

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-31T10:59:40.227

如果我尝试

> ssh -vvv myloginname@heroku.com

我明白了：

```
debug2: key_type_from_name: unknown key type '-----END'
...
debug3: check_host_in_hostfile: filename ~/.ssh/known_hosts
debug3: check_host_in_hostfile: match line 1
debug3: check_host_in_hostfile: filename ~/.ssh/known_hosts
debug3: check_host_in_hostfile: match line 2
debug1: Host 'heroku.com' is known and matches the RSA host key.
debug1: Found key in ~/.ssh/known_hosts:1
debug2: bits set: 500/1024
debug1: ssh_rsa_verify: signature correct 
```

你有一个 known_hosts 文件`~/.ssh/`吗？我的包含`heroku.com,50.19.85.154 ssh-rsa`和的条目`50.19.85.132 ssh-rsa`。你有那些吗？

如果你这样做`which ssh-keygen`了，正在运行什么版本的 ssh-keygen？Heroku Toolbelt 是否应该使用/安装正确的副本？如果不是，也许[Heroku 管理密钥文章](https://devcenter.heroku.com/articles/keys)中的步骤没有创建有效密钥？

# objective-c - 将新视图添加到另一个子视图中

> ID：10707158
> 
> 赞同：0
> 
> 时间：2012-05-22T17:40:33.107
> 
> 标签：objective-c, ios4

我正在学习iOS。我正在使用 Xcode 4.3.2 ，并且我创建了一个按钮，并且在回调中，我使用了以下代码。

1) 创建单视图应用程序 2) 创建新视图 -> newV 3) 创建按钮但是；4）添加但作为newV的子视图。5）添加newV作为主视图的子视图。

```
-(IBAction) submitButtonPressed:(id)sender
{
    NSLog (@" Submit Button is pressed ");
    UIView *newV = [[UIView alloc] initWithFrame:[UIScreen mainScreen].bounds];
    newV.backgroundColor = [UIColor colorWithRed:0 green:0 blue:0 alpha:0.5];

    UIButton *but = [[UIButton alloc] init];
    [but setTitle:@"SubView" forState:UIControlStateNormal];
    [newV addSubview:but];
    [self.view addSubview:newV];

} 
```

但我得到的问题是，只显示视图 viewV，但未显示按钮。如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T17:44:34.260

在视图 newV 中添加后尝试添加按钮。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T18:11:49.970

创建按钮时，您没有提供框架。尝试使用：

```
UIButton* but = [[UIButton alloc] initWithFrame:CGRectMake(0, 0, buttonWidth, buttonHeight)]; 
```

创建按钮时，它的大小为零，因此您看不到它。

# ruby-on-rails-3 - Rails session variables aren't getting set/passed as expected

> ID：10707159
> 
> 赞同：0
> 
> 时间：2012-05-22T17:40:37.977
> 
> 标签：ruby-on-rails-3, session-variables

Thanks for taking a look at this relatively nu-b question.

I have a web app built on Rails 3 that allows users to view multiple stories at a time, with each story having multiple posts. I use JS to poll the server at regular intervals so to search for new posts on all of the open stories. I use session variables so to keep track of where I ended my last search for each of those open stories so that I don't have to search the entire table of posts from scratch each time I poll the server.

Here is the action for when a user first opens a story:

```
def open_story
    story = Story.find(params[:story_id])
    #keep track of the last post searched for each open story so to assist when we poll for new posts to that story
    last_post_searched = Post.last.id
    session["last_post_searched_for_story_#{story.id}"] = last_post_searched 
    @posts = story.posts.where("posts.id <= ?", last_post_searched)
    respond_with @posts
end 
```

Here is the action for when the client polls the server for new post updates on an array of open stories:

```
 def update_stories
    open_stories_id_array = params[:open_stories]
    open_stories_id_array.each { |open_story_id|
debugger
      start_search_at_post_id = session["last_post_searched_for_story_#{open_story_id}"] + 1
      session["last_post_searched_for_story_#{open_story_id}"] = Post.last.id
      story = Story.find(open_story_id)
      updates = story.posts.where("posts.id between ? AND ?", 
          start_search_at_post_id, session["last_post_searched_for_story_#{open_story_id}"])
      results[open_story_id] = updates
    }
    respond_with(results)
  end 
```

For reasons that I can't figure out, my session variables don't increment to the new Post.last.id in my update_stories action in a timely fashion. Here is how I can recreate the problem:

1.  Say I have 30 posts in my db to various different stories.
2.  I call open_story on story 1\. This sets session["last_post_searched_for_story_1"] to 30.
3.  I then make a new post to story 1 (post 31).
4.  My client polls the update_stories action to get new posts for story 1.
5.  update_stories searches for posts with ids between 31 and 31 for story with id of 1, and returns the post that I just made.
6.  Then, a little while later my client automatically polls update_stories again to check for any new posts on story 1\. This is where the problem occurs.

Instead of session["last_post_searched_for_story_1"] containing the value, 31, it retains its previous value of 30 so that my db search returns my original new post for a second time. Often, my client will call update_stories several times before session["last_post_searched_for_story_1"] increments to 31\. It's almost as if the session variable is very slow to save its new value, or I'm experiencing some sort of lazy loading problem.

Any help figuring this problem out would be greatly appreciated and eagerly accepted.

Thanks

BTW, as I still have a lot to learn, feel free to give feedback on better ways to handle this issue or if I am violating any rails best practices.

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-05-23T23:38:53.493

我发现您的代码存在 2 个问题：

您可能希望在应用最后一种方法之前先对结果进行排序。数据库返回的最后一条记录不一定是要创建的最后一条。
其次，要选择最后一个帖子，您应该仅将最后一个标准应用于该故事的帖子，然后选择该故事的最后一个帖子。
所以，而不是这个：

```
story = Story.find(params[:story_id])
#keep track of the last post searched for each open story so to assist when we poll for new posts to that story
last_post_searched = Post.last.id 
```

你可以这样：

```
story = Story.find(params[:story_id])
last_post_searched = Post.joins(:stories).where("stories.id = ?", story.id).order("posts.created_on DESC").first 
```

# objective-c - iOS Text Wrapping

> ID：10707160
> 
> 赞同：2
> 
> 时间：2012-05-22T17:40:45.553
> 
> 标签：objective-c, ios, uiimageview, uitextview

In the app I am currently developing, I have to implement a screen which allows the user to ask a question. This screen contains a UIImageView next to the UITextView, taking up a portion of the space. It looks like the below image.

![Problem](../Images/659a90ebcfd42d59a4ea76156918d95e.png)

My question is, how can I wrap the UITextView text around the UIImageView, so that the text won't be in a block, but flowing around the UIImageView?

Thanks in advanced.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T17:46:44.117

我不认为你可以做到这一点，除非你的 UITextView 是富文本或 HTML 编辑器，其中嵌入了图像。基本上你要的是一个非矩形的 UITextView。据我所知，这在 iOS 中是不可能的，除非你要从头开始创建全新的东西，这将非常复杂。我见过很多 UILabel 样式的控件，它们可以**显示**类似 HTML 的文本，但不能**编辑**它。

编辑：这可能会有所帮助： http: [//www.cocoanetics.com/2011/01/rich-text-editing-on-ios/](http://www.cocoanetics.com/2011/01/rich-text-editing-on-ios/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T17:53:40.513

不幸的是，这不是一个小问题，因为 UITextField 没有提供任何在这里有用的功能。

但是，您可以做的是使用 UITextInput（用于文本输入）和 Core Text（用于文本显示）实现自己的文本视图，然后从自定义 CGPath 定义Core Text 的绘图矩形（您可以在[此处](https://developer.apple.com/library/ios/#documentation/StringsTextFonts/Conceptual/CoreText_Programming/Overview/Overview.html#//apple_ref/doc/uid/TP40005533-CH3-SW1)阅读有关 Core Text 的更多信息）这将排除图像框架。

听起来确实有点复杂（也许很疯狂），但是（几乎总是）有开源解决方案已经找到了解决方案。[OmniGroup 框架](https://github.com/omnigroup/OmniGroup)包含基于 Core Text 和 UITextInput 的自定义文本输入控件。他们是根据 MIT 许可证获得许可的（嗯，更多），所以你应该没问题。

# java - ConcurrentModificationException exception with iterator in multithread chat server

> ID：10707161
> 
> 赞同：0
> 
> 时间：2012-05-22T17:41:02.703
> 
> 标签：java

I'm creating a multithread chat server in java. When user u1 logs in and sends a message to user u2, if user u2 is not connected the message is sent to the server and put in an ArrayList of pending messages. When user u2 connects, he receive the message from the server and send a message to user u1 as a receipt.

This is my code:

```
if (pendingmsgs.size()>0) {
    for(Iterator<String> itpendingmsgs = pendingmsgs.iterator(); itpendingmsgs.hasNext();) {
        //....parsing of the message to get the recipient, sender and text
        String pendingmsg = itpendingmsgs.next();

        if (protocol.author != null && protocol.author.equals(recipient)) {
            response+=msg;

            protocol.sendMsg(sender, "Msg "+text+" sent to "+recipient);

            itpendingmsgs.remove();
        }
    }   
}
out.write(response.getBytes(), 0, response.length()); 
```

This is the ServerProtocol sendMsg() method:

```
private boolean sendMsg(String recip, String msg) throws IOException {
    if (nicks.containsKey(recip)) { //if the recipient is logged in
        ClientConnection c = nick.get(recipient); //get the client connection 
        c.sendMsg(msg); //sends the message
        return true;
    } else {
        /* if the recipient is not logged in I save the message in the pending messages list */
        pendingmsgs.add("From: "+nick+" to: "+recip+" text: "+msg);
        return false;
    }
} 
```

and this is the ClientConnection sendMsg() method:

```
public void sendMsg(String msg) throws IOException {
        out.write(msg.getBytes(), 0, msg.length());
    } 
```

where out is an OutputStream.

When user u1 logs in, sends a message to user u2 who is not logged in and then user u1 leaves, when user u2 logs in he doesn't receive the message and I get this exception:

```
Exception in thread "Thread-2" java.util.ConcurrentModificationException
at java.util.AbstractList$Itr.checkForComodification(Unknown Source)
at java.util.AbstractList$Itr.remove(Unknown Source)
at ChatServer$ClientConnection.run(ChatServer.java:400)
at java.lang.Thread.run(Unknown Source) 
```

Line 400 is

```
itpendingmsgs.remove(); 
```

I've tried using a CopyOnWriteArrayList but it still doesn't work.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T17:45:30.463

很可能在查看您的代码之后，问题似乎是当您循环遍历迭代器时，您在 sendMsg 方法中将新内容添加到 ArrayList

```
protocol.sendMsg(sender, "Msg "+text+" sent to "+recipient); // this line invokes the code which adds

pendingmsgs.add("From: "+nick+" to: "+recip+" text: "+msg); // this line adds a new item 
```

有关上次发生这种情况的原因，请参阅[此讨论。](https://stackoverflow.com/questions/10690903/arraylist-concurrent-modification/10690927#10690927)

编辑：根据评论

> 第 400 行是 itpendingmsgs.remove();

这绝对是因为列表中的添加，当您到达时`itpendingmsgs.remove();`，您已经在列表中添加了一个新条目，这使您的迭代器抱怨。

更新：

解决此问题的方法：

1.  而不是`Iterator`使用`ListIterator`and `add`，从 ListIterator 中删除对象，而不是从底层 List 中删除对象。

更新示例代码：

```
package com.mumz.test.listiterator;

import java.util.ArrayList;
import java.util.List;
import java.util.ListIterator;
import java.util.Random;

/**
 * Test Class to show case List Iterator.
 */
public class TestListIterator {

    /** The pendingmsgs. */
    List<String>    pendingmsgs = new ArrayList<String>();

    /**
     * Add some content to the list and then start processing the same list.
     */
    private void init() {
        addContentToList();
        doProcessing();
    }

    /**
     * Add test content to list.
     */
    private void addContentToList() {
        for (int iDx = 0; iDx < 10; iDx++) {
            pendingmsgs.add("Message " + iDx);
        }
    }

    /**
     * Randomly decide if message should be added or removed, showcase iteration using list iterator.
     */
    private void doProcessing() {
        if (pendingmsgs.size() > 0) {
            for(ListIterator<String> listIterator = pendingmsgs.listIterator(); listIterator.hasNext();){
                String currentMessage = listIterator.next();
                Random random = new Random();
                int nextInt = random.nextInt(100);
                if((nextInt % 2) == 0){
                    sendMsg(currentMessage, listIterator);
                } else {
                    listIterator.remove();
                }
            }
        }
    }

    /**
     * Add new content to the list using listIterator of the underlying list.
     * 
     * @param msg
     *            the msg
     * @param listIterator
     *            the list iterator
     * @return true, if successful
     */
    private boolean sendMsg(String msg, ListIterator<String> listIterator) {
        Random random = new Random();
        int nextInt = random.nextInt(10);
        // Randomly add new message to list
        if ((nextInt % 2) == 0) {
            listIterator.add("New Messsage : " + msg);
            return false;
        }
        return true;
    }

    /**
     * The main method.
     * 
     * @param args
     *            the arguments
     */
    public static void main(String[] args) {
        try {
            TestListIterator testListIterator = new TestListIterator();
            testListIterator.init();
            System.out.println(testListIterator);
        } catch (Exception e) {
            e.printStackTrace();
        }
    }

    /* (non-Javadoc)
     * @see java.lang.Object#toString()
     */
    @Override
    public String toString() {
        return String.format("TestListIterator [pendingmsgs=%s]", pendingmsgs);
    }
} 
```

2.  在这种情况下，您可以直接修改您的集合（在这种情况下为列表），而不是使用`Iterator`或仅使用普通的 for 或 while 循环，而不会出现此异常。`ListIterator`

3.  使用`Iterator`它自己，但不要在循环时将新元素添加到列表中。

    将您的消息添加到另一个列表说`tempMessageHolder`这样`sendMsg`会将消息添加到此列表。

    循环完成后，将所有消息添加`tempMessageHolder`到主列表`pendingmsgs`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T17:45:31.280

`CopyOnWriteArrayList.iterator()` [不支持`remove()`](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/CopyOnWriteArrayList.html#iterator%28%29)。您可能应该使用 a [`Collections.synchronizedList(ArrayList)`](http://docs.oracle.com/javase/6/docs/api/java/util/Collections.html#synchronizedList%28java.util.List%29)（在迭代期间正确锁定，如 Javadoc 中所指定）。

这确实是允许一个线程添加到列表而另一个线程迭代删除元素的最简单方法。

# javascript - Node.js on a remote server: io is not defined

> ID：10707163
> 
> 赞同：0
> 
> 时间：2012-05-22T17:41:05.047
> 
> 标签：javascript, node.js, socket.io

I'm building an application that links to a node.js hosted on my home computer (78.233.79.103:8000)

The server is properly istalled (if you go to the addres I gave you'll se the socket.io works) If I run the server in localhost with

```
node server.js 
```

all is good, the application works

Then when I run the application on my other pc or on my iPad (I wrapped it with phoneGap so it's just a web app included in a native iOS app), trying to connect the io on 78.233.79.103:8000 i got the console log:

```
io is not defined 
```

here is my sourcecode: [https://github.com/synbioz/puissance4](https://github.com/synbioz/puissance4)

look for the server.js

I know I only call io = require('socket.io').listen(PORT); but kwnow also I should create something like:

```
var http = require('http');
http.createServer(function (req, res) {
  res.writeHead(200, {'Content-Type': 'text/plain'});
  res.end('Hello World\n');
}).listen(8000, '78.233.79.103'); 
```

that actually doesn't works

Any idea?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T17:46:21.077

可能是因为 .listen() 不返回`this`。

尝试将它们写在单独的行中。

```
var io = require('socket.io');
io.listen(PORT); 
```

# javascript - Same syntax as : if, for, while

> ID：10707166
> 
> 赞同：-1
> 
> 时间：2012-05-22T17:41:10.450
> 
> 标签：javascript

I thought of a syntax that could be very helpful :

```
function myFunction(){}
myFunction(){anotherFunction();}; 
```

I want to have the same result as : [http://jsfiddle.net/tMawX/](http://jsfiddle.net/tMawX/) but a syntax like : [http://jsfiddle.net/J9hQp/](http://jsfiddle.net/J9hQp/)

Is there a way to do it?

My final goal is to re-write the `for` function so it is wrote like that : `for(0,100){func};` instead of `for(0,100,func);`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T17:49:49.807

CoffeeScript 具有简短的函数语法：

```
eatMe = (x)-> x(); alert(3);

eatMe -> alert(2) 
```

翻译为：

```
var eatMe;

eatMe = function(x) {
  x();
  return alert(3);
};

eatMe(function() {
   return alert(2);
}); 
```

你的`for`函数看起来像：

```
myfor = (from, to) ->
    (callback) ->
        [callback(i) for i in [from..to]]

myfor(1, 3) -> alert('Hooray!') 
```

# javascript - function in ajax loaded content run after removal also

> ID：10707170
> 
> 赞同：0
> 
> 时间：2012-05-22T17:41:38.353
> 
> 标签：javascript, jquery, function

My html page

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head><script src="js/jquery.js"></script>
<script>$(function(){
$("button:first").click(function(){
$("#aja").load("ajax.html");});
$("button:last").click(function(){
$("#aja").remove();});
});
</script>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<title>Untitled Document</title>
</head>

<body>
<button>Load page</button><button id="rem">Remove ajax content</button>
<div id="aja"></div>
</body>
</html> 
```

and ajax.html code

```
<body>
<script>$(function(){
cool();});
function cool(){
$("button:last").after("Hello");
setTimeout("cool()",10000);}
</script>
</body> 
```

Now when i load ajax.html it cool() function runs and keeps on adding hello to last button .The problem is when i remove the ajax loaded content with second button,cool() function which is removed keeps on running .But i want the cool function to stop after removal of ajax content

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T17:44:33.833

检查`#aja`块的存在可能会有所帮助：

```
function cool() {
    if ($("#aja").length == 0) return;

    $("button:last").after("Hello");
    setTimeout("cool()", 10000);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T17:45:38.550

您想使用清除超时

[http://www.w3schools.com/jsref/met_win_cleartimeout.asp](http://www.w3schools.com/jsref/met_win_cleartimeout.asp)

# .net - 我能否创建一个与标准 .NET Framework 和 .NET Compact Framework 兼容的 DLL？

> ID：10707171
> 
> 赞同：5
> 
> 时间：2012-05-22T17:41:40.020
> 
> 标签：.net, dll, compact-framework

我希望在我的 .NET 桌面应用程序和 .NET CF 应用程序之间共享某些数据功能。

是否可以创建一个可供两个版本的应用程序访问的通用库，或者我需要创建两个单独的 DLL？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-22T17:45:11.647

是的——桌面 .NET 运行时知道如何加载和运行 .NET CF DLL，所以第一步是为 Compact Framework 构建库。

您会发现有时您会想要使用 Desktop 框架的功能，并且可以使用反射来引入这些功能。

这是MSDN Magazine[中对该过程的一个非常完整的介绍。](http://msdn.microsoft.com/en-us/magazine/cc163387.aspx)

**注意：**如果您的移动版和桌面版可以共享代码，而不是专门共享 .dll，那么如果您改用条件编译，您将可以更轻松地构建它并保持快乐。

# bash - Bash 参数引号和评估

> ID：10707173
> 
> 赞同：8
> 
> 时间：2012-05-22T17:41:47.800
> 
> 标签：bash, shell, variables, eval

我编写了一个 bash 日志库，用我公司目前正在使用的一些复杂脚本来实现。在进行日志调用时，我一直在提供脚本文件名 (${BASH_SOURCE}) 和调用脚本的行号 (${LINENO})。但是，我不想依赖用户或实现脚本来将这两个变量作为参数传递。如果这是 C/C++，我只需创建一个宏，将“__FILE__”和“__LINE__”添加到参数列表中。

我终于能够让这部分工作。以下是一些非常简化的摘要作为概念证明：

这是日志库：

```
# log.sh

LOG="eval _log \${BASH_SOURCE} \${LINENO}"

_log () {
    _BASH_SOURCE=`basename "${1}"` && shift
    _LINENO=${1} && shift

    echo "(${_BASH_SOURCE}:${_LINENO}) $@"
} 
```

和一个实施测试脚本：

```
# MyTest.sh

. ./log.sh

${LOG} "This is a log message"
# (test.sh:5) This is a log message 
```

这工作得很好（而且，一开始我很高兴能让它工作）。然而，这有一个明显的问题：quotes 和 eval 之间的交互。如果我打电话：

```
${LOG} "I'm thrilled that I got this working"
# ./test.sh: eval: line 5: unexected EOF while looking for matching `''
# ./test.sh: eval: line 6: syntax error: unexpected end of file 
```

现在，我相信我明白为什么会这样了。引用的参数在传递给 eval 时保持不变，但此时，内容按原样放置到生成的命令字符串中。我知道我可以通过转义来解决这个问题；但是，我***真的***不想强制实现脚本必须这样做。在我实现这个“eval 宏”功能之前，我让用户直接调用“_log”并允许他们有选择地传入“${LINENO}”。有了这个实现，上面的失败调用（只有一个引用的句子）工作得很好。

在最基本的层面上，我真正想要的只是让脚本能够调用*[log function/macro] "String to log with special characers"*并让生成的日志消息包含调用脚本的文件名和行号，随后是日志消息。如果可能的话，我会假设我非常接近，但如果我忽略了某些需要不同方法的东西，我也对此持开放态度。我不能强迫用户转义他们的所有消息，因为这可能会导致他们不使用这个库。这是一个如此大的问题，如果我找不到解决方案，我可能会恢复到旧功能（这需要将 ${LINENO} 作为函数参数传递——这样的侵入性要小得多）。

**TLDR**：有没有办法让 eval 尊重引用参数中的特殊字符，而不必转义它们？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-05-22T18:01:25.220

`eval`我建议尽可能避免。对于您的日志记录用例，您可以查看 shell builtin `caller`。如果您需要更多信息，可以使用变量`BASH_SOURCE`和。请注意，所有这些变量都是数组并包含完整的调用堆栈。请参见以下示例：`BASH_LINENO``FUNCNAME`

```
#! /bin/bash       

function log() {
    echo "[$( caller )] $*" >&2
    echo "BASH_SOURCE: ${BASH_SOURCE[*]}"
    echo "BASH_LINENO: ${BASH_LINENO[*]}"
    echo "FUNCNAME: ${FUNCNAME[*]}"
}

function foobar() {
    log "failed:" "$@"
}

foobar "$@" 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-22T18:32:54.357

（注意：这解决了引用的直接问题，但@nosid 关于访问调用堆栈的答案要好得多）

稍微改变你的定义，`_log`从标准输入中读取，而不是从位置参数中获取日志消息：

```
_log () {
    # Set up _BASH_SOURCE and _LINENO the same way

    cat <(echo -n "$(_BASH_SOURCE:$_LINENO) ") -
} 
```

然后使用 here doc 或 here 字符串通过标准输入传递您的日志消息：

```
${LOG} <<<"This is a log message"
${LOG} <<<"I'm thrilled this works, too!"
${LOG} <<HERE
Even this long
message works as
intended!
HERE 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-09-29T05:42:32.263

对于您的特定日志记录情况，您可能需要查看[此函数](https://stackoverflow.com/a/51148723/5353461)，该函数打印调用者的上下文的文件函数和行号。

## 可重复使用的报价功能

此功能将为您做正确的报价：

```
function token_quote {
  local quoted=()
  for token; do
    quoted+=( "$(printf '%q' "$token")" )
  done
  printf '%s\n' "${quoted[*]}"
} 
```

**示例用法：**

**示例用法：**

```
$ token_quote token 'single token' token
token single\ token token 
```

上面，请注意`single token`' 的空间被引用为`\`。

```
$ set $(token_quote token 'single token' token)
$ eval printf '%s\\n' "$@"
token
single token
token
$ 
```

这表明令牌中的空格被保留了。

# android - Android应用程序的最佳数据库方法？

> ID：10707175
> 
> 赞同：1
> 
> 时间：2012-05-22T17:41:54.720
> 
> 标签：android, database, web-services

我正在寻找构建一个简单的应用程序，将 MIDI 文件流式传输给用户。我想使用的数据库必须是远程的，因为我计划有很多文件，并且为了避免拥有一个 100mb+ 的大型应用程序，我更喜欢在用户请求它们时只流式传输小的 midi 文件。

我不确定要使用哪种数据库方法，或者哪种方法最容易和最好用。我知道 SQLite 可以与 android 一起使用，但正如我所说，我计划将数据库设置为远程的。数据库和 Web 服务的最佳方法是什么？

# java - 正则表达式删除引用文本中的空格

> ID：10707177
> 
> 赞同：2
> 
> 时间：2012-05-22T17:42:01.673
> 
> 标签：java, regex

我只需要在字符串的引用部分中删除所有空格。

给这个： `10 00,400,"a1 b2 c3 ",zz xx,100`

我需要这个： `10 00,400,"a1b2c3",zz xx,100`

显然，仅将其限制在引用区域是我遇到麻烦的原因。

字符串的长度会有所不同，并且可以有多个引用部分。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T18:02:20.593

不使用正则表达式 - 但有效

```
public String replaceWithinQuotes(String input) {
    String[] output = input.split("\"");
    StringBuilder builder = new StringBuilder();
    for ( int i =0; i < output.length-1; i++ ) {
        if ( i %2 == 0 ) {
            builder.append(output[i]);
        } else {
            builder.append(output[i].replaceAll("[ ]+", ""));
        }
        builder.append("\"");
    }
    builder.append(output[output.length-1]);
    return builder.toString();
} 
```

注意 - 如果你使用这个 - 确保数组的长度是**奇数**。如果不是，那么您的引号不平衡，您必须以适合您的应用程序的任何方式处理它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T18:03:23.310

假设引号是平衡的，那么您可以实现这样的方法：

```
public static void main(String[] args) {

    String str = "10 00,400,\"a1 b2 c3 \",zz xx,100, \"a b\"";
    StringBuffer sb = new StringBuffer();

    Matcher matcher = Pattern.compile("\"([^\"]+)\"").matcher(str);
    while (matcher.find()) {
        matcher.appendReplacement(sb, matcher.group().replaceAll("\\s+", ""));
    }

    System.out.println(sb.toString());
} 
```

这打印：

```
10 00,400,"a1b2c3",zz xx,100, "ab" 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-22T18:00:18.963

这是一个小例程，当文本中有一组引号时，它似乎工作得很好：

```
public static String cropSpacesWithinQuotes(String expression) {
    Pattern pattern = Pattern.compile("\"[\\S*\\s\\S*]*\"");
    StringBuilder noSpaces=new StringBuilder();
    int initialPosition=0;
    Matcher matcher = pattern.matcher(expression);
    while (matcher.find(initialPosition)) {
            int pos=matcher.start();
            noSpaces.append(expression.substring(initialPosition, pos-initialPosition));
            initialPosition=matcher.end();
            noSpaces.append(matcher.group().replaceAll(" ", ""));
    }
    noSpaces.append(expression.substring(initialPosition));
    return(noSpaces.toString());
} 
```

执行一些单元测试时，我意识到当有更多的一对引号时，两组中的文本也会被裁剪。对变量 initialPosition 的一些操作应该可以解决您的问题。

我希望这有帮助。

# java - 向/data/local 写入和读取文件？

> ID：10707178
> 
> 赞同：0
> 
> 时间：2012-05-22T17:42:02.637
> 
> 标签：java, android, permissions, root

我正在创建一个小应用程序，它可以让用户读取 /data/local 中某个文本文件中的内容，对其进行编辑，然后保存。通过在这里和那里使用一些教程，我已经让一切正常工作，但仍然有一些东西不起作用。

已经实现了 Root 访问权限，并且写入/读取文件也完成了，但是当按下“写入”按钮时，我得到一个祝酒词“打开失败：EACCES（权限被拒绝）”。不幸的是，谷歌在这方面对我帮助不大。另外，我正在使用 WRITE_TO_EXTERNAL_STORAGE 权限。

代码：

```
package bas.sie.datadatafix;

import java.io.BufferedReader;
import java.io.DataOutputStream;
import java.io.File;
import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.IOException;
import java.io.InputStreamReader;
import java.io.OutputStreamWriter;

import android.os.Bundle;
import android.os.Environment;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.EditText;
import android.widget.Toast;

import com.actionbarsherlock.app.SherlockActivity;

public class DataFixActivity extends SherlockActivity {

    EditText txtData;
    Button btnReadSDFile;
    Button btnWriteSDFile;
    Button btnReadSkipFile;
    Button btnWriteSkipFile;
    Button btnClearScreen;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        Process p;  
        try {  
           // Preform su to get root privledges  
           p = Runtime.getRuntime().exec("su");   

           // Attempt to write a file to a root-only  
           DataOutputStream os = new DataOutputStream(p.getOutputStream());  
           os.writeBytes("echo \"Do I have root?\" >/system/sd/temporary.txt\n");  

           // Close the terminal  
           os.writeBytes("exit\n");  
           os.flush();  
           try {  
              p.waitFor();  
                   if (p.exitValue() != 255) {  
                      // TODO Code to run on success  
                      Toast.makeText(this, "root", Toast.LENGTH_LONG);  
                   }  
                   else {  
                       // TODO Code to run on unsuccessful  
                       Toast.makeText(this, "No root", Toast.LENGTH_LONG);
                   }  
           } catch (InterruptedException e) {  
              // TODO Code to run in interrupted exception  
               Toast.makeText(this, "No root", Toast.LENGTH_LONG);  
           }  
        } catch (IOException e) {  
           // TODO Code to run in input/output exception  
            Toast.makeText(this, "NO root", Toast.LENGTH_LONG);  
        }  

        if(!Environment.MEDIA_MOUNTED.equals(Environment.getExternalStorageState())){
            Toast.makeText(this, "External SD card not mounted", Toast.LENGTH_LONG).show();
        }

        txtData = (EditText) findViewById(R.id.txtData);

        btnReadSDFile = (Button) findViewById(R.id.btnReadSDFile);
        btnReadSDFile.setOnClickListener(new OnClickListener() {

            public void onClick(View v) {
                // write on SD card file data in the text box
                try {
                    File myFile = new File("/data/local/move_cache.txt");
                    FileInputStream fIn = new FileInputStream(myFile);
                    BufferedReader myReader = new BufferedReader(
                            new InputStreamReader(fIn));
                    String aDataRow = "";
                    String aBuffer = "";
                    while ((aDataRow = myReader.readLine()) != null) {
                        aBuffer += aDataRow + "\n";
                    }
                    txtData.setText(aBuffer);
                    myReader.close();
                    Toast.makeText(getBaseContext(),
                            "Done reading from SD: 'move_cache.txt'",
                            Toast.LENGTH_SHORT).show();
                } catch (Exception e) {
                    Toast.makeText(getBaseContext(), e.getMessage(),
                            Toast.LENGTH_SHORT).show();
                }
            }
        }); 

        btnWriteSDFile = (Button) findViewById(R.id.btnWriteSDFile);
        btnWriteSDFile.setOnClickListener(new OnClickListener() {

            public void onClick(View v) {
                // write on SD card file data in the text box
                try {
                    File myFile = new File("/data/local/move_cache.txt");
                    myFile.createNewFile();
                    FileOutputStream fOut = new FileOutputStream(myFile);
                    OutputStreamWriter myOutWriter = new OutputStreamWriter(
                            fOut);
                    myOutWriter.append(txtData.getText());
                    myOutWriter.close();
                    fOut.close();
                    Toast.makeText(getBaseContext(),
                            "Done writing to SD: 'move_cache.txt'",
                            Toast.LENGTH_SHORT).show();
                } catch (Exception e) {
                    Toast.makeText(getBaseContext(), e.getMessage(),
                            Toast.LENGTH_SHORT).show();
                }
            }
        }); 

        btnReadSkipFile = (Button) findViewById(R.id.btnReadSkipFile);
        btnReadSkipFile.setOnClickListener(new OnClickListener() {

            public void onClick(View v) {
                // write on SD card file data in the text box
                try {
                    File myFile = new File("/data/local/skip_apps.txt");
                    FileInputStream fIn = new FileInputStream(myFile);
                    BufferedReader myReader = new BufferedReader(
                            new InputStreamReader(fIn));
                    String aDataRow = "";
                    String aBuffer = "";
                    while ((aDataRow = myReader.readLine()) != null) {
                        aBuffer += aDataRow + "\n";
                    }
                    txtData.setText(aBuffer);
                    myReader.close();
                    Toast.makeText(getBaseContext(),
                            "Done reading from SD: 'skip_apps.txt'",
                            Toast.LENGTH_SHORT).show();
                } catch (Exception e) {
                    Toast.makeText(getBaseContext(), e.getMessage(),
                            Toast.LENGTH_SHORT).show();
                }
            }
        }); 

        btnWriteSkipFile = (Button) findViewById(R.id.btnWriteSkipFile);
        btnWriteSkipFile.setOnClickListener(new OnClickListener() {

            public void onClick(View v) {
                // write on SD card file data in the text box
                try {
                    File myFile = new File("/data/local/skip_apps.txt");
                    myFile.createNewFile();
                    FileOutputStream fOut = new FileOutputStream(myFile);
                    OutputStreamWriter myOutWriter = new OutputStreamWriter(
                            fOut);
                    myOutWriter.append(txtData.getText());
                    myOutWriter.close();
                    fOut.close();
                    Toast.makeText(getBaseContext(),
                            "Done writing to SD: 'skip_apps.txt'",
                            Toast.LENGTH_SHORT).show();
                } catch (Exception e) {
                    Toast.makeText(getBaseContext(), e.getMessage(),
                            Toast.LENGTH_SHORT).show();
                }
            }
        }); 

        btnClearScreen = (Button) findViewById(R.id.btnClearScreen);
        btnClearScreen.setOnClickListener(new OnClickListener() {

            public void onClick(View v) {
                // clear text box
                txtData.setText("");
            }
        }); 

    }// onCreate

} 
```

提前致谢，

巴斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T18:01:21.707

尝试使用此逻辑在本地存储上写入和读取文件，并仅保留其余部分，尽管我知道您做到了，但仍然..使用 WRITE_TO_EXTERNAL_STORAGE 权限。

从文件中读取

```
File f = new File("my.txt");
FileReader fr = new FileReader(f);
BufferedReader br  = new BufferedReader(fr);

String s = null;

while ((br=readLine())!=null) {

// Do whatever u want to do with the content of the file,eg print it on console using SysOut...etc

}

br.close(); 
```

对于写入文件：

```
Boolean isDone = true;
Scanner scan = new Scanner(System.in);
File f = new File("my.txt");
FileWriter fr = new FileWriter(f);
BufferedWriter br  = new BufferedWriter(fr);

while (b) {

   if (!b) {

 br.write(new Scanner(System.in).nextLine());

 }

} 
```

# node.js - node.js 中的 MongoDB 组性能

> ID：10707180
> 
> 赞同：0
> 
> 时间：2012-05-22T17:42:13.180
> 
> 标签：node.js, mongodb, database

作为前言，我将 Node.js 与 Mongo-db-native 一起使用。

我还使用 GridFS 来存储图像，每个图像都有元数据，其中一个是产品 ID。

我想查询`fs.files`与特定产品关联的所有图像并返回图像。

这是我目前这样做的方式：

```
this.collection.ensureIndex({
    product_id: 1,
}, function (err, edIndex) {
    self.collection.group(   ['group'] , {
        "product_id": ObjectID(product_id)
    } , {
        docs: []
    } , function (doc, prev) {
        prev.docs.push({
            width: doc.width,
            height: doc.height,
            _id: doc._id
        });
    } , true , function (err, results) { 
        if (err) {
            callback(err)
        } else {
            callback(null, results)
        } 
    });
}); 
```

我发现这非常慢。有没有人有任何建议作为替代方案或如何提高性能？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T21:30:10.383

这是一个使用 Mongo shell 语法的简单查询，它将在其元数据中找到 ProductId = 42 的所有 GridFS 文件。

```
db.fs.files.find({"metadata.ProductId": 42}); 
```

返回的文档将包含一个文件名，该文件名可以与 mongo-native 的 GridStore 一起使用。

# php - DOMDocument 包装器？

> ID：10707181
> 
> 赞同：1
> 
> 时间：2012-05-22T17:42:25.520
> 
> 标签：php, domdocument

是否有任何用 PHP 编写的使用 DOMDocument 进行解析的 HTML 解析器？

我基本上是在寻找一个提供比 DOMDocument 更好、更自然的 API 的包装类，这在使用上是有问题的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T17:46:32.577

有[SmartDOMDocument](http://beerpla.net/projects/smartdomdocument-a-smarter-php-domdocument-class/)，它修复了一些问题，例如编码和输出为字符串。

我不知道任何其他包装器，但您可以使用 DOMDocument 的替代方法：

*   [PHP查询](http://code.google.com/p/phpquery/)
*   [PHP 简单的 HTML DOM 解析器](http://simplehtmldom.sourceforge.net/)
*   [加农](http://code.google.com/p/ganon/)

另外，你知道[DOMXPath](http://php.net/manual/en/class.domxpath.php)存在吗？它使检索值变得更加容易。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T17:47:19.887

[http://www.phpbuilder.com/columns/PHP_HTML_DOM_parser/PHPHTMLDOMParser.cc_09-07-2011.php3](http://www.phpbuilder.com/columns/PHP_HTML_DOM_parser/PHPHTMLDOMParser.cc_09-07-2011.php3)是另一种可能性。

# python - python，重复random.randint？

> ID：10707182
> 
> 赞同：1
> 
> 时间：2012-05-22T17:42:27.850
> 
> 标签：python

我是 python 新手，我想知道如何使代码重复该`random.randint`部分 100 次。

```
#head's or tail's

print("you filp a coin it lands on...")

import random

heads = 0
tails = 0

head_tail =random.randint(1, 2,)

if head_tail == 1:
    print("\nThe coin landed on heads")
else:
    print("\nThe coin landed on tails")

if head_tail == 1:
    heads += 1
else:
   tails += 1

flip = 0
while True :
    flip +=1
    if flip > 100:
        break

print("""\nThe coin has been fliped 100 times
it landed on heads""", heads, """times and tails""", tails,
"""times""")

input("Press the enter key to exit") 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-22T17:49:37.267

您可以通过列表理解在一行中完成所有操作：

```
flips = [random.randint(1, 2) for i in range(100)] 
```

并像这样计算正面/反面的数量：

```
heads = flips.count(1)
tails = flips.count(2) 
```

或者更好：

```
num_flips = 100
flips = [random.randint(0, 1) for _ in xrange(num_flips)]
heads = sum(flips)
tails = num_flips - heads 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-22T17:44:46.703

首先，我将该`while`循环替换为：

```
for flip in xrange(100):
  ... 
```

其次，要进行 100 次随机试验，请将`randint()`调用以及您想要执行 100 次的所有其他内容移动到循环体内：

```
for flip in xrange(100):
  head_tail = random.randint(1, 2)
  ... 
```

最后，这是*我*将如何做整个事情：

```
heads = sum(random.randint(0, 1) for flip in xrange(100))
tails = 100 - heads 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-22T17:50:38.890

您将使用`range(100)`, 因为您在 Python3.x 上，它创建了一个从 0 到 99（100 个项目）的列表。它看起来像这样：

```
print("you flip a coin it lands on...")

import random

heads = 0
tails = 0

for i in xrange(100):
    head_tail = random.randint((1, 2))

    if head_tail == 1:
        print("\nThe coin landed on heads")
    else:
        print("\nThe coin landed on tails")

    if head_tail == 1:
        heads += 1
    else:
        tails += 1    

print("""\nThe coin has been fliped 100 times
it landed on heads""", heads, """times and tails""", tails,
"""times""")

input("Press the enter key to exit") 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-22T17:47:57.530

```
for flip in range(100):
    head_tail = random.randint(1, 2)

    if head_tail == 1:
        print("\nThe coin landed on heads")
    else:
        print("\nThe coin landed on tails")

    if head_tail == 1:
        heads += 1
    else:
        tails += 1 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-04-12T12:32:30.607

我是 Python 新手，通常是编程新手，但我基于 1 天的编程实践创建了自己的代码。硬币翻转编码练习是我现在学习的书中的第一个练习。我试图在互联网上找到解决方案，我找到了这个主题。

我知道要使用本主题中的任何代码，因为我不熟悉以前答案中使用的一些函数。

对于处于类似情况的任何人：请随时使用我的代码。

```
import random

attempts_no = 0
heads = 0
tails = 0

input("Tap any key to flip the coin 100 times")

while attempts_no != 100:
 number = random.randint(1, 2)
 attempts_no +=1
 print(number)
 if number == 1:
    heads +=1
 elif number ==2:
    tails +=1

print("The coin landed on heads", heads, "times")
print("The coin landed on heads", tails, "times") 
```

# java - Mahout：一种格式如何加载和使用数据进行分类？

> ID：10707185
> 
> 赞同：2
> 
> 时间：2012-05-22T17:42:42.470
> 
> 标签：java, mahout

JavaDocs 和 mahout 快速入门页面很糟糕。我得到了一本 Mahout in action book。我已经阅读了大量的 Mahout in Action 这本书，它只专注于为 Reccomender 系统格式化数据。

如何格式化保存分类数据的文件？

它是如何加载到 mahout 的 DataModel 中的，还是有不同的数据模型用于分类？（我看到了一些关于向量的东西）

您如何采用该数据模型并将其与您的分类系统相结合？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T22:18:05.750

（刚才看到你的另一个问题。）

我不认为文档一般都很好。只有像您这样的人添加文档时，它才会变得更好。但是，Mahout 不是一个产品，甚至也不是一个真正的库。它是开发人员的代码，几乎必须用作代码。

大多数分类（我对此知之甚少）使用`Vector`并因此`VectorWritable`用作输入的 Hadoop 线格式。

`DataModel`与分类器无关，也没有对应物。这是推荐位的一部分。

# apache - 在 apache 配置中检测 Apache 版本？

> ID：10707186
> 
> 赞同：23
> 
> 时间：2012-05-22T17:42:51.497
> 
> 标签：apache, .htaccess

**tl;dr：**如何在 .conf 或 .htaccess 文件中执行以下操作：

```
<IfApache22>
  # Do A
</IfApache22>
<IfApache24>
  # Do B
</IfApache24> 
```

**更长的问题：**

在 Apache 2.4 中，旧的[Order](http://httpd.apache.org/docs/2.2/mod/mod_authz_host.html#order) get 被弃用，取而代之的是[Require](http://httpd.apache.org/docs/2.4/mod/mod_authz_core.html#require)。

在我的 .htaccess 文件中

```
<FilesMatch "\.(long|list|file|types)$">
  Order allow,deny
</FilesMatch> 
```

这意味着 Apache 无法启动，除非我启用[access_compat](http://httpd.apache.org/docs/2.4/mod/mod_access_compat.html)。虽然这样做提供了一个有用的解决方法，但我想要一个适用于这两种语法的解决方案，因为配置将分发到许多服务器。问题是我如何检测当前版本的 Apache 并应用正确的指令。

我打算将该文件用于分发给很多人并被很多人使用的框架，并且我无法控制/保证他们拥有或缺少任何特定的服务器设置，这就是我希望该文件的原因2.2/2.4“不可知论”。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2013-02-26T05:09:57.983

A hack that I have used.

```
# Apache 2.2
<IfModule !mod_authz_core.c>
    Satisfy Any
</IfModule>

# Apache 2.4
<IfModule mod_authz_core.c>
    Require all granted
</IfModule> 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2013-11-22T01:14:59.307

假设您安装了[mod_version](http://httpd.apache.org/docs/2.2/mod/mod_version.html)（许多发行版默认提供），您可以执行以下操作：

```
<IfVersion >= 2.4>
    # Require ...
</IfVersion>
<IfVersion < 2.4>
    # Order ...
    # Deny ...
    # Allow ...
</IfVersion> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-22T17:47:27.910

您可以在同一主机上运行不同版本的 Apache。问：单独目录中的单独配置文件有什么问题？老实说，我相信这可能是最干净的方法......

不过，Apache .conf 文件允许使用 .conf 文件`<IfDefine>`，您可以在运行时使用“-D”指定它：

[http://httpd.apache.org/docs/2.0/mod/core.html#ifdefine](http://httpd.apache.org/docs/2.0/mod/core.html#ifdefine)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-11-22T01:00:45.577

您可以通过使用 mod_rewrite 进行访问控制来绕过需要知道：

```
RewriteEngine On
RewriteCond %{REQUEST_URI} !\.(long|list|file|types)$
RewriteRule .* - [F,L] 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-08-27T13:45:45.867

我遇到了这个问题，因为 FallbackResource 不在 Apache 的早期版本中，而且聪明的托管公司通常会在他们拥有带有 FallbackResource 的 Apache 版本后删除 mod_rewrite。当我想放置适应其环境的库代码时，我使用以下 .htaccess：

```
<IfModule mod_rewrite.c>
    RewriteEngine on
    RewriteRule ^ - [E=protossl]
    RewriteCond %{HTTPS} on
    RewriteRule ^ - [E=protossl:s]
    RewriteRule "(^|/)\." - [F]
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteCond %{REQUEST_URI} !=/favicon.ico
    RewriteRule ^ index.php [L]
</IfModule>

<IfModule !mod_rewrite.c>
    FallbackResource index.php
</IfModule> 
```

现在当然有一些 Apache 版本/设置会失败 - 但如果 mod_rewrite 存在，请使用它，如果没有，希望 FallbackResource 存在。

# c# - .Net Speech.Synthesizer 中的内存泄漏？

> ID：10707187
> 
> 赞同：8
> 
> 时间：2012-05-22T17:42:57.500
> 
> 标签：c#, .net, memory-leaks, sapi, speech-synthesis

我在我的应用程序中发现了一个持续的泄漏。在使用内存分析器检查后，我发现课程是来自 Microsoft Speech.Synthesizer 的一些对象

所以我建立了一个玩具项目来验证假设：

//显示 Speech.Synthesizer 对象中的内存泄漏的玩具示例

```
static void Main(string[] args)
{
    string text = "hello world. This is a long sentence";
    PromptBuilder pb = new PromptBuilder();
    pb.StartStyle(new PromptStyle(PromptRate.ExtraFast));
    pb.AppendText(text);
    pb.EndStyle();
    SpeechSynthesizer tts = new SpeechSynthesizer();

while (true)
{
    //SpeechSynthesizer tts = new SpeechSynthesizer();
    Console.WriteLine("Speaking..."); 
    tts.Speak(pb);

    //Print private working set sieze
    Console.WriteLine("Memory: {0} KB\n", (Process.GetCurrentProcess().PrivateMemorySize64 / 1024).ToString("0"));

    //tts.Dispose();    //also this doesn't work as well
    //tts = null;

    GC.Collect();   //a little help, but still leaks
}
} 
```

结果实际上证实了内存泄漏来自 Speech.Synthesizer

```
Speaking... 
```

内存：42184 KB

说... 内存：42312 KB

说... 内存：42440 KB

说... 内存：42568 KB

说... 内存：42696 KB

说... 内存：42824 KB

说... 内存：43016 KB

说... 内存：43372 KB

我用谷歌搜索了它，发现许多其他人也遇到了同样的问题：1： [SpeechSynthesizer](https://stackoverflow.com/questions/2204012/constant-memory-leak-in-speechsynthesizer) 2 中的持续内存泄漏： [http ://connect.microsoft.com/VisualStudio/feedback/details/664196/system-speech-has-a-memory -泄漏](http://connect.microsoft.com/VisualStudio/feedback/details/664196/system-speech-has-a-memory-leak)

但遗憾的是我没有找到任何解决方案。既然这个问题早就问过了，所以我想问一下它是否解决了？

非常感谢。

**更新：**

似乎当我切换到使用 SAPI COM dll 而不是 .Net Speech.Synthesizer 包时（尽管它们本质上是相同的），内存停止泄漏。

***为什么两个调用行为（SAPI dll vs .net Speech 包）有不同的内存行为？后者似乎只是前一个 SAPI dll 的包装器。***

```
 static void Test2()
{
    //SAPI COM component this time
    SpeechLib.SpVoiceClass tts = new SpeechLib.SpVoiceClass();
    tts.SetRate(5);
    string text = "hello world. This is a long sentence";
    //tts.Speak("helloWorld", SpeechLib.SpeechVoiceSpeakFlags.SVSFDefault);
while (true)
{

    Console.WriteLine("Speaking...");
    tts.Speak(text, SpeechLib.SpeechVoiceSpeakFlags.SVSFDefault);

    //Print private working set sieze
    Console.WriteLine("Memory: {0} KB\n", (Process.GetCurrentProcess().PrivateMemorySize64 / 1024).ToString("0"));

    GC.Collect();
} 
```

}

内存：32044 KB

说... 内存：32044 KB

说... 内存：32044 KB

说... 内存：32044 KB

说... 内存：32044 KB

说... 内存：32044 KB

说... 内存：32044 KB

说... 内存：32044 KB

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-26T21:01:12.800

最终解决方案：

谷歌相关的关键字告诉我这实际上是微软的一个错误。

似乎当我切换到使用 SAPI COM dll 而不是 .Net Speech.Synthesizer 包时（尽管它们本质上是相同的），内存停止泄漏。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-22T18:15:23.440

我不确定 SpeechSynthesizer 的所有细节，但您可以尝试在此处使用一次性模式。由于 SpeechSynthesizer 实现了[IDisposable](http://msdn.microsoft.com/en-us/library/system.idisposable.dispose.aspx)

您的代码如下所示：

```
while (true)
{
   using (SpeechSynthesizer tts = new SpeechSynthesizer())
   {
      Console.WriteLine("Speaking..."); 
      tts.Speak(pb);

      //Print private working set sieze
      Console.WriteLine("Memory: {0} KB\n",(Process.GetCurrentProcess().PrivateMemorySize64 / 1024).ToString("0"));
   }
} 
```

如果您注意到这与 Microsoft 的示例非常相似[Here](http://msdn.microsoft.com/en-us/library/system.speech.synthesis.speechsynthesizer.aspx)

这看起来实际上是内存泄漏，您是否尝试过使用[Microsoft.Speech 运行时](http://www.microsoft.com/en-us/download/details.aspx?id=14373)？语法看起来非常相似，他们已经提到它*不应该*有同样的问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-05-08T08:51:42.480

我知道这是一个旧线程，但该问题还有另一种解决方案。使用**Microsoft.Speech.Synthesis.SpeechSynthesizer**而不是**System.Speech.Synthesis.SpeechSynthesizer**。

Microsoft.Speech.Synthesis.SpeechSynthesizer 包含在*Microsoft 语音平台 - 软件开发工具包 (SDK)（版本 11）*中- [https://www.microsoft.com/en-us/download/details.aspx?id=27226](https://www.microsoft.com/en-us/download/details.aspx?id=27226)

此版本的合成器没有内存泄漏。

# android - 推特喜欢 UI

> ID：10707188
> 
> 赞同：1
> 
> 时间：2012-05-22T17:42:57.953
> 
> 标签：android, user-interface

我正在尝试开发一个类似于 Twitter 的界面，但请检查图像如何以及应该如何。我不知道该怎么办了。检查在我的应用程序上，滚动出现在白框内和外面的 Twitter 中。

图片：http: [//img845.imageshack.us/img845/2962/stackoverfloww.png](http://img845.imageshack.us/img845/2962/stackoverfloww.png)

我所有的 xml 和样式：

布局/dashboard.xml（主要）

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    style="@style/dashboard" >

    <include
        layout="@layout/action_bar"/>

    <include
        layout="@layout/events"/>

</RelativeLayout> 
```

布局/action_bar.xml

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    style="@style/actionBar" >

<ImageView style="@style/actionBarLogo"/>

</LinearLayout> 
```

布局/事件.xml

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content">

<ListView
    android:id="@+id/events"
    style="@style/listView"/>

</LinearLayout> 
```

布局/events_item

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:orientation="horizontal"
    android:padding="8dip">

    <LinearLayout 
        android:id="@+id/thumbnail"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_marginRight="6dip"
        android:background="#FFFFFF">

        <ImageView 
            android:id="@+id/thumbnail_image"
            android:layout_width="50dip"
            android:layout_height="50dip"
            android:src="@drawable/uerj"/>

    </LinearLayout>

    <TextView
        android:id="@+id/title"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignTop="@+id/thumbnail"
        android:layout_toRightOf="@+id/thumbnail"
        android:layout_marginTop="1dip"
        android:text="Event"
        android:textColor="#000000"
        android:textSize="13dip"
        android:textStyle="bold"
        android:typeface="monospace" />

    <TextView
        android:id="@+id/locale"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_alignLeft="@+id/title"
        android:layout_marginLeft="1dip"
        android:layout_centerVertical="true"
        android:text="Locale"
        android:textColor="#000000"
        android:textSize="10dip" />

    <TextView 
        android:id="@+id/date"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentRight="true"
        android:layout_alignTop="@id/title"
        android:gravity="right"
        android:layout_marginRight="6dip"
        android:textSize="8dip"
        android:text="Date"
        android:textColor="#000000"/>

</RelativeLayout> 
```

值/样式.xml

```
<?xml version="1.0" encoding="utf-8"?>
<resources>

    <style name="dashboard">
        <item name="android:layout_width">fill_parent</item>
        <item name="android:layout_height">fill_parent</item>
        <item name="android:orientation">vertical</item>
        <item name="android:background">#E4E4E4</item>
    </style>

<style name="actionBar">
    <item name="android:layout_width">fill_parent</item>
    <item name="android:layout_height">45dp</item>
    <item name="android:orientation">horizontal</item>
    <item name="android:background">@drawable/action_bar_background</item>
    <item name="android:layout_alignParentTop">true</item>
</style>

<style name="actionBarLogo">
    <item name="android:layout_width">wrap_content</item>
    <item name="android:layout_height">fill_parent</item>
    <item name="android:paddingTop">1dip</item>
    <item name="android:paddingLeft">8dip</item>
    <item name="android:scaleType">center</item>
    <item name="android:clickable">false</item>
    <item name="android:contentDescription">Action Bar Logo</item>
    <item name="android:src">@drawable/action_bar_logo</item>
</style>

<style name="content">
    <item name="android:layout_marginTop">8dp</item>
    <item name="android:layout_marginLeft">8dp</item>
    <item name="android:layout_marginRight">8dp</item>
        <item name="android:layout_width">fill_parent</item>
        <item name="android:layout_height">wrap_content</item>
        <item name="android:background">#FFFFFF</item>
</style>

<style name="listView">
    <item name="android:layout_marginTop">8dp</item>
    <item name="android:layout_marginLeft">8dp</item>
    <item name="android:layout_marginRight">8dp</item>
    <item name="android:layout_width">fill_parent</item>
    <item name="android:layout_height">wrap_content</item>
        <item name="android:divider">#ECECEC</item>
        <item name="android:dividerHeight">1dp</item>
        <item name="android:cacheColorHint">#00000000</item>
        <item name="android:background">@drawable/content</item>
    </style>

</resources> 
```

可绘制/action_bar_background.xml

```
<?xml version="1.0" encoding="utf-8"?>
<selector xmlns:android="http://schemas.android.com/apk/res/android">
    <item>
        <shape>
            <gradient
                android:angle="90"
                android:startColor="#1E69A0"
                android:endColor="#5FAFE6"
                android:type="linear" />
        </shape>
    </item>
</selector> 
```

可绘制/内容.xml

```
<?xml version="1.0" encoding="utf-8"?>
<shape
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:shape="rectangle"> 

    <solid
        android:color="#FFFFFF"/>

    <stroke
        android:width="1px"
        android:color="#C6C6C6"/>

    <padding
        android:left="1dp"
        android:top="1dp"
        android:right="1dp"
        android:bottom="1dp"/> 

    <corners
        android:radius="4dp"/> 

</shape> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T17:50:54.750

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    style="@style/dashboard" >

    <include
        android:id="@+id/actionBar"
        layout="@layout/action_bar"/>

    <include
        android:layout_below="@id/actionBar"
        layout="@layout/events"/>

</RelativeLayout> 
```

或者

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    style="@style/dashboard" 
    android:orientation="portrait">

    <include
        layout="@layout/action_bar"/>

    <include
        layout="@layout/events"/>

</LinearLayout> 
```

# c# - TPL BackgroundThread UIThread 图形更新

> ID：10707191
> 
> 赞同：1
> 
> 时间：2012-05-22T17:43:14.790
> 
> 标签：c#, winforms, user-interface, task-parallel-library

所有，我有一个`Task`在后台线程上运行并做一些繁重的工作。我设置它的方式是，在完成此操作的同时，UI 线程使用进度信息更新 GUI，其中一些使用动画 .gif 文件。看下面的示例代码来说明问题

```
TaskScheduler uiScheduler = TaskScheduler.FromCurrentSynchronizationContext();
Task<bool> task = Task.Factory.StartNew(() => 
{
    // Heavy work.
    if (heavyWorkCompleted)
        MethodToUpdateGui(uiScheduler); // Update DataGridView ImageCell on UI thread
    // More work.
} 
```

在执行“繁重工作”期间，我有一个“进行中”图像显示在相应的 DGV 图像单元格中，如果“繁重工作”成功，则此图像更改为勾号（在 DGV1 中），然后`MethodToUpdateGui(uiScheduler)`使用此图像（刚刚更改） DGV1 中的图像以更新 DGV2。但是，`MethodToUpdateGui(uiScheduler)`运行时它有时会太快地更新 DataGridView (DGV2)。我的意思是，图像不是我想要的刻度（应该是由于成功完成）它是“进行中”图像。对于我正在做的事情，似乎 DGV 的更新速度不够快。

有一个更好的方法吗？我敢在 GUI 更新后旋转后台线程以让 DGV1 “赶上”[这很讨厌！]？

谢谢你的时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T17:50:43.667

> 有一个更好的方法吗？我敢在 GUI 更新后旋转后台线程以让 DGV1 “赶上”[这很讨厌！]？

这里的问题是 TPL 使用[SynchronizationContext.Post](http://msdn.microsoft.com/en-us/library/system.threading.synchronizationcontext.post.aspx)将消息发送到 UI 线程。当方法运行时，任务将异步运行，这反过来不会立即更新 GUI。

如果您想确保 GUI 已更新，最简单的选择是`MethodToUpdateGui`通过等待通过`uiScheduler`.

这看起来像：

```
void MethodToUpdateGui(TaskScheduler uiScheduler)
{
    var updateTask = Task.Factory.StartNew( () =>
    {
        // update gui
    }, CancellationToken.None, TaskCreationOptions.None, uiScheduler);

    // Block until Task completes...
    updateTask.Wait();
} 
```

这比尝试旋转要好，因为它会自动阻止并得到 TPL 的通知。

在 Windows 窗体术语中，这实际上是在做`Control.Invoke`而不是,。`Control.BeginInvoke`

# php - mysql_connect ..没有连接也没有错误

> ID：10707193
> 
> 赞同：1
> 
> 时间：2012-05-22T17:43:24.680
> 
> 标签：php, mysql

这似乎应该很容易，但我没有收到错误或任何结果：

```
$connection = mysql_connect("phpexamplesite.db.4211592.hostedresource.com", "username", "password");
if(!$connection) {

    die("Database connection failed: " . mysql_error());
}

//2\. Select a database to use

$db_select = mysql_select_db("username", $connection);
if(!$db_select){
die("Database selection failed: " . mysql_error()); 
```

有任何想法吗？

谢谢：）

对此感到抱歉...我确实将查询放入：

```
// 3\. Perform database query
            $result = mysql_query("SELECT * FROM subjects", $connection);
            if(!$result){
                die("Database query failed: " . mysql_error());
            }

            //4\. Use returned data

            while($row = mysql_fetch_array($result)) {
                echo $row["menu_name"]. " ".$row["position"]. "<br />";
            }

            ?>

 <?php
        //5\. Close connection

        mysql_close($connection);

?> 
```

我在页面上没有收到任何错误或结果...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T17:52:01.943

您可能只是没有从 select 语句中得到任何结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T17:54:04.817

它*可能*来自语法错误。您在第一个代码片段中缺少右括号

```
if(!$db_select)
{
  die("Database selection failed: " . mysql_error()); `
**}** 
```

尝试从命令行运行您的文件`php test.php`

如果出现语法错误，某些服务器 (Apache) 被配置为不输出任何内容。

# css - CSS，分组元素

> ID：10707194
> 
> 赞同：0
> 
> 时间：2012-05-22T17:43:28.467
> 
> 标签：css, css-selectors

我想按 对元素进行分组`( )`，但我几乎相信这是不可能的。是吗？我真的必须这样做吗：

```
#column-group-beta div.moduletable.title4 li a,
#column-group-beta div.moduletable.title4 li a:link, 
#column-group-beta div.moduletable.title4 li a:visited, 
#column-group-beta div.moduletable.title4 li a:focus, 
#column-group-beta div.moduletable.title4 li a:active, 
div.title4 li a,
div.title4 li a:link, 
div.title4 li a:visited, 
div.title4 li a:focus, 
div.title4 li a:active {

} 
```

代替

```
#column-group-beta div.moduletable.title4 li (a,a:link,a:visited, a:focus,a:active) 
div.title4 li (a,a:link,a:visited, a:focus,a:active) {

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T17:45:41.243

是的，您确实必须按照 CSS 格式要求的正确方式进行操作。

也就是说，当你的 CSS 得到这个特定的时候：

```
#column-group-beta div.moduletable.title4 li a:link 
```

很可能已经是一团糟了。有时候是这样的。很多。有时是必要的，但如果你有足够的能力，也许可以重新考虑 CSS。

# google-maps - 我想使用谷歌地图等地图软件提供划船者在河上行驶的距离

> ID：10707195
> 
> 赞同：1
> 
> 时间：2012-05-22T17:43:29.700
> 
> 标签：google-maps, maps

显然，谷歌地图没有办法识别河流，除非通过获取像素的颜色。每当有一座桥时，它就会中断。是否有一个可以测量沿河距离的方法，而无需为我想使用的每个河段构建自己的 gis 多边形？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T19:52:58.370

你试过[NASA Worldwind](http://worldwind.arc.nasa.gov/java/)吗？虽然谷歌地图很流行且易于使用，但它对路线图数据更有用。NASA Worldwind SDK 相当容易理解，并提供了一系列与地球相关的数据，包括高程数据。

# mysql - column1='value1' and column1='value2' 按 column2 分组的行数

> ID：10707199
> 
> 赞同：0
> 
> 时间：2012-05-22T17:43:43.797
> 
> 标签：mysql, postgresql, count, group-by

我有一张这样的桌子：

```
date         day     weather
2000-01-01   Monday  Sunny
2000-01-02   Tuesday Rainy 
```

. . .

我想在一个查询中获得下雨的星期一和晴天的星期一的数量，例如

```
day     rainy_d  sunny_d
Monday  2        5 
```

如何在 Mysql 和 PostgreSQL 中实现这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T17:47:37.893

标准 SQL，适用于以下两种情况：

```
SELECT
    day,
    SUM(CASE WHEN weather = 'Rainy' THEN 1 ELSE 0 END) AS rainy_d,
    SUM(CASE WHEN weather = 'Sunny' THEN 1 ELSE 0 END) AS sunny_d
FROM yourtable
GROUP BY day 
```

更简洁的版本 - 仅限 MySQL：

```
SELECT
    day,
    SUM(weather = 'Rainy') AS rainy_d,
    SUM(weather = 'Sunny') AS sunny_d
FROM yourtable
GROUP BY day 
```

更简洁的版本 - 仅限 PostgreSQL：

```
SELECT
    day,
    SUM((weather = 'Rainy')::int) AS rainy_d,
    SUM((weather = 'Sunny')::int) AS sunny_d
FROM yourtable
GROUP BY day 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T17:46:46.473

```
select `Day`, 
SUM(case when weather = 'Sunny' THEN 1 ELSE 0 end) as Sunny_D,
SUM(case when weather = 'Rainy' THEN 1 ELSE 0 end) as Rainy_D
FROM YOURTABLENAME
Where day = 'Monday'
Group by `Day` 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-22T23:58:53.753

该列`day`可能是多余的。我会删除它而不替换。该列`date`包含所有信息。那么您的查询可能看起来像这样..

在 PostgreSQL 中：

```
SELECT to_char(date, 'Day') AS day
      ,COUNT(NULLIF(weather,'Sunny')) AS rainy_d
      ,COUNT(NULLIF(weather,'Rainy')) AS sunny_d
FROM   tbl
GROUP  BY 1; 
```

在 MySQL 中：

```
SELECT DAYNAME(date) AS day
... rest identical 
```

该`NULLIF()`构造仅适用于列中的两个不同（非空）值，`weather`并且是标准 SQL。如需更多值，请使用@Mark 和@xQbert 提供的替代方法。

# http - 将文件上传到 Google Docs Api 出现错误 504

> ID：10707202
> 
> 赞同：0
> 
> 时间：2012-05-22T17:43:50.080
> 
> 标签：http, google-docs, google-docs-api

我正在为 Google 文档开发一个 delphi api，并且很难让上传工作。我在[这里](https://developers.google.com/google-apps/documents-list/#uploading_a_new_document_or_file_with_content_only)遵循谷歌的开发指南，据我了解，这个过程看起来应该是这样的：

1.  对此 url: 发出 POST 请求，`https://docs.google.com/feeds/upload/create-session/default/private/full/?access_token=my_access_token&v=3&convert=false`带有这些标头：`X-Upload-Content-Type`和`X-Upload-Content-Length`
2.  `200 OK`使用存储在`Location`标头中的下一个上传位置获取响应
3.  向标头发出 PUT 请求，`Location`标头`Content-Type`设置为我`X-Upload-Content-Type`在步骤 1 中设置的任何内容，标头`Content-Range`设置为以下内容：`bytes 0-524287/2097152`以及正文中的前 512kb 数据
4.  获取标头`308 Resume Incomplete`中包含下一个上传位置的响应`Location`
5.  返回 3 直到所有字节都上传完毕，此时我将收到一个`201 Created`响应，其中包含描述我上传的文件的 xml 数据

包括第 3 步在内的一切工作正常。在第 4 步，事情开始出错。

最让我困惑的一件事是第 4 步的响应不包含`Location`标题。我认为这意味着我应该将下一个请求发送到相同的 url，但这会导致我收到 504 错误。我用 fiddler 尝试了整个过程，只是想看看是不是 delphi 代码，是我缺乏理解，还是谷歌正在做的事情。

这是我使用 fiddler 发送和接收的请求和响应：

```
POST https://docs.google.com/feeds/upload/create-session/default/private/full/?access_token=my_access_token&v=3&convert=false HTTP/1.1
Content-Type: application/x-www-form-urlencoded
X-Upload-Content-Type: application/octet-stream
X-Upload-Content-Length: 2097152
Content-Length: 0
Host: docs.google.com

HTTP/1.1 200 OK
Server: HTTP Upload Server Built on May 16 2012 12:03:24 (1337195004)
Location: https://docs.google.com/feeds/upload/create-session/default/private/full/?access_token=my_access_token&v=3&convert=false&upload_id=AEnB2Ur9-9VxMSI6kaFzbybY2qiyzK6kVoKzcZ6Yo02H8Ni4FlQFl_N06DdjZXzp3vSjOPH3CEb_4vDlKZp7VlC0hxpkypzlKg
Date: Tue, 22 May 2012 16:53:27 GMT
Pragma: no-cache
Expires: Fri, 01 Jan 1990 00:00:00 GMT
Cache-Control: no-cache, no-store, must-revalidate
Content-Length: 0
Content-Type: text/html

PUT https://docs.google.com/feeds/upload/create-session/default/private/full/?access_token=my_access_token&v=3&convert=false&upload_id=AEnB2Ur9-9VxMSI6kaFzbybY2qiyzK6kVoKzcZ6Yo02H8Ni4FlQFl_N06DdjZXzp3vSjOPH3CEb_4vDlKZp7VlC0hxpkypzlKg HTTP/1.1
Content-Type: application/octet-stream
Content-Length: 524288
Content-Range: bytes 0-524287/2097152
Host: docs.google.com
[first 512kb of data here]

HTTP/1.1 308 Resume Incomplete
Server: HTTP Upload Server Built on May 16 2012 12:03:24 (1337195004)
Range: bytes=0-524287
X-Range-MD5: bd9d4ee7afa24b7da0e685f05b5f1f44
Date: Tue, 22 May 2012 16:54:29 GMT
Pragma: no-cache
Expires: Fri, 01 Jan 1990 00:00:00 GMT
Cache-Control: no-cache, no-store, must-revalidate
Content-Length: 0
Content-Type: text/html

PUT https://docs.google.com/feeds/upload/create-session/default/private/full/?access_token=my_access_token&v=3&convert=false&upload_id=AEnB2Ur9-9VxMSI6kaFzbybY2qiyzK6kVoKzcZ6Yo02H8Ni4FlQFl_N06DdjZXzp3vSjOPH3CEb_4vDlKZp7VlC0hxpkypzlKg HTTP/1.1
Content-Type: application/octet-stream
Content-Length: 524288
Content-Range: bytes 524288-1048575/2097152
Host: docs.google.com
[next 512kb of data]

HTTP/1.1 504 Fiddler - Send Failure
Content-Type: text/html; charset=UTF-8
Connection: close
Timestamp: 10:54:14.056 
```

我唯一能做的就是能够说一个事实，*不仅仅是*德尔福代码是错误的，而且因为我不认为它是谷歌，我将不得不和我一起去'不明白应该发生的事情。我错过了什么？

**编辑**

我能够让上传工作，我不完全确定我做了什么不同，但文档有点误导。至少对我来说是这样。当你发送一个 PUT 请求时，你不会得到一个新的位置，你只是继续上传到同一个位置。此外，当您完成上传时，201 响应不包含实际的 XML 数据，而是有一个`Location`标头，指向您可以从中获取 XML 数据的位置。没什么大不了的，但有点令人困惑。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T18:17:48.887

Fiddler 似乎返回了 504 错误，这两个链接应该会有所帮助：

[http://urda.cc/blog/2010/09/28/iis-services-504s-and-fiddler/](http://urda.cc/blog/2010/09/28/iis-services-504s-and-fiddler/)

[http://urda.cc/blog/2010/09/30/follow-up-iis-services-504s-and-fiddler/](http://urda.cc/blog/2010/09/30/follow-up-iis-services-504s-and-fiddler/)

# python - Python 中的 __set__ 和 __setattr__ 有什么区别，什么时候应该使用？

> ID：10707206
> 
> 赞同：14
> 
> 时间：2012-05-22T17:44:19.403
> 
> 标签：python, attributes, getter-setter

正如标题所说。

来自 Java 我曾经：

```
private int A;

public void setA(int A) {
    this.A = A;
}

public int getA() {
    return this.A
} 
```

我如何在 Python 中做到这一点（如果需要）。如果其中一个`__setattr__`or`__set__`用于此目的，那么另一个用于什么？

编辑：我觉得我需要澄清一下。我知道在 Python 中不会在需要之前创建 setter 和 getter。

可以说我想做这样的事情：

```
public void setA(int A) {
    update_stuff(A);
    and_calculate_some_thing(A);
    this.A = A;
} 
```

实现这个的“pythonic”方式是什么？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-05-22T17:49:35.427

在 python 中，*应该*使用 a 来实现这样的`property`事情（然后只有当他们做一些有用的事情时）。

```
class Foo(object):
    def __init__(self):
        self._x = None

    @property
    def x(self):
        return self._x

    @x.setter
    def x(self,y):
        self._x = y 
```

在这个例子中，最好这样做（正如爱德华所指出的）：

```
class Foo(object):
     def __init__(self):
         self.x = None 
```

因为我们的 getter/setter 方法实际上并没有做任何事情......但是，当 setter/getter 实际上做的不仅仅是分配/返回属性的值时，属性变得非常有用。

它也可以使用`__setattr__`/来实现`__getattr__`（但不应该以这种方式实现，因为如果你的类有超过 1 个属性，它很快就会变得很麻烦。我也猜想这样做会比使用属性慢）：

```
class Foo(object):
    def __init__(self):
        self._x = None
    def __setattr__(self,attr,obj):
        if(attr == 'x'):
            object.__setattr__(self,'_x',obj)
        else:
            object.__setattr__(self,attr,obj)

    def __getattr__(self,attr):
        if(attr == 'x'):
            return object.__getattr__(self,'_x')
        else:
            return object.__getattr__(self,attr) 
```

就做什么`__setattr__`和`__getattr__`实际做什么而言... `__setattr__`/`__getattr__`是当您执行以下操作时所调用的内容：

```
myclassinstance = MyClass()
myclassinstance.x = 'foo'  #translates to MyClass.__setattr__(myclassinstance,'x','foo')
bar = myclassinstance.x    #translates to bar=MyClass.__getattr__(myclassinstance,'x') 
```

至于`__get__`和`__set__`： [以前的帖子](https://stackoverflow.com/questions/3798835/understanding-get-and-set-and-python-descriptors)已经很好地讨论了这一点。

请注意，在 python*中没有私有变量之类的东西*。一般来说，在一个类成员的前缀下划线，你不应该弄乱它（除非你当然知道你在做什么）。如果它带有 2 个下划线前缀，它将调用名称修改，这使得在类外部访问变得更加困难。这用于防止继承中的命名空间冲突（并且这些变量通常也不会被弄乱）。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-05-22T17:50:08.253

`__set__()`当描述符被分配给时在描述符中使用。`__setattr__()`在绑定到对象的属性时使用。除非您正在创建描述符，否则您不会使用`__set__()`.

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-05-22T17:52:06.003

如果 getter/setter 真的像那样微不足道，那么您甚至不应该打扰它们：只需使用实例变量即可。如果您确实需要做一些有趣的事情的 getter/setter，那么您应该切换到一个属性，如 mgilson 所述。请注意，您可以从实例变量更改为属性，而无需任何使用您的代码注意到差异的东西。即，开始：

```
class Foo(object):
    def __init__(self):
        self.x = None 
```

如果/当事实证明您在获取/设置属性时需要发生一些有趣的事情时，只更改 mgilson 描述的基于属性的访问器。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-05-22T18:16:42.197

假设您有`class Master`一个属性`x`，`class Slave`并且您希望在将某些内容分配给`x`as时执行一些代码`some_master.x = foo`。此代码将位于何处？它可以在类`Master`中，在这种情况下您使用`__setattr__`. 它也可以在 class`Slave`中，以便它可以控制分配的内容。在这种情况下，您创建`Slave`一个[描述符](http://docs.python.org/howto/descriptor.html)并使用`__set__`.

例子：

```
>>> class Master(object):
...     def __setattr__(self, name, val):
...         print "run code in Master: %s" % val
... 
>>> a = Master()
>>> a.x = 123
run code in Master: 123 
```

与此相比：

```
>>> class Slave(object):
...     def __set__(self, obj, val):
...         print "run code in Slave: %s" % val
... 
>>> class Master2(object):
...     x = Slave()
... 
>>> b = Master2()
>>> b.x = 345
run code in Slave: 345 
```

要回答哪个更pythonic的问题，我不会说。如果您需要实际**做某事**，请将其设为函数。显式 > 隐式。

```
 def update_param(a):
     update_stuff(a)
     and_calculate_some_thing(a)
     self.a = a 
```

# mysql - mysql触发器：如果重复则插入另一个表

> ID：10707207
> 
> 赞同：0
> 
> 时间：2012-05-22T17:44:22.990
> 
> 标签：mysql

这是我第一次使用 mysql，我正在学习如何使用触发器。

我有两个表：lpr_upload 和 lpr_traveltime。我的 lpr_upload 表看起来像这样

```
+----------+---------+--------+-----------+
| date_time | site_id | lane_id| lpr_text  |                  
+----------+---------+--------+-----------+ 
```

每当我在 lpr_upload 中添加新行时，我想检查新行的 lpr_tex 是否已经存在于表中。如果它已经存在，我想用 lpr_text 和新的日期时间 - 旧的日期时间在 lpr_traveltime 中添加一个新行。这是我到目前为止所拥有的：

在重复键更新时插入 lpr_opt_travel_times(travel_time, lpr_text) 值（选择 TIMEDIFF (new.date_time, ...) , lpr_text) ...

我不知道如何完成这个。另外，我如何从表中已经存在的行中获取 date_time ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T18:14:01.290

尝试这个：

```
declare ldt_date_time datetime;
select date_time into ldt_date_time from tbl where tbl.lpr_text = NEW.lpr_text and date_time <> NEW.date_time;
if ldt_date_time is not null then
    insert into lpr_opt_travel_times(travel_time, lpr_text) values (ldt_date_time, NEW.lpr_text);
end if; 
```

声明一个日期时间数据类型的 var，因为我假设 date_time 列是日期时间类型。

从 NEW 魔术表中选择插入的 lpr_text 的 date_time 值，但其 date_time 与插入的不同。

如果 var 为 null 表示未发生分配，并且 var 保留初始默认值 NULL，则使用 var 和插入的 lpr_text 在其他表中插入行

# asp.net-mvc-3 - SocialAuth.net VS DotNetOpenAuth

> ID：10707210
> 
> 赞同：1
> 
> 时间：2012-05-22T17:44:38.187
> 
> 标签：asp.net-mvc-3, forms-authentication, dotnetopenauth, socialauth

浏览这个网站，我发现了一些有趣的建议。SocialAuth.net 和 DotNetOpenAuth。

我开始使用 SocialAuth。它使用起来非常简单并且有效（到目前为止，我只用谷歌尝试过）。我对这个库的唯一问题是，它没有提供一种方法来从它提供的提供商中检索联系人，而无需使用您请求联系人列表的新（或最新）提供商登录。

换句话说，出于安全原因，我必须使用本地用户名和密码在我的人中唱歌。但是我想从这个库的从不同提供商那里获取联系人的功能中受益。事情是它覆盖了我当前登录的用户（使用 FormsAuthentication）来获取 google 发送的身份验证令牌。

有人遇到过这个问题吗？

DotNetOpenAuth 没有这个缺陷吗？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T12:16:16.073

你确定你了解 OAuth 吗？

可能是我误读了您的问题，老实说，我对 socialAuth.net 没有任何经验（会调查它）。在我看来，您似乎认为 socialAuth.net 需要您登录，我知道这不是 DotNetOpenAuth 中的事实。只有您需要登录的地方（如果您尚未登录）是您正在连接的服务（Twitter、Facebook 等）

当然也可能是我刚刚回答了你的问题：D

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T08:43:01.620

也许您应该检查源的最后更改： [http ://code.google.com/p/socialauth-net/source/list](http://code.google.com/p/socialauth-net/source/list)

如您所见，在 r320 中，他们似乎已经解决了这个问题

# php - SocialEngine4：通知错误：带有消息未知项目类型的 Zend Engine_Api_Exception

> ID：10707211
> 
> 赞同：0
> 
> 时间：2012-05-22T17:44:44.597
> 
> 标签：php, zend-framework

我正在使用 socialengine4，我的通知不断给我这个错误。我认为这是某种类型的配置，并查看数据库或通知设置，但我无法修复此错误。谁能指出我正确的方向？

```
2012-05-22T17:40:21+00:00 CRIT (2): 
Error Code: dc0cf5
exception 'Engine_Api_Exception' with message 'Unknown item type: news_content' in /var/www/html/application/libraries/Engine/Api.php:417
Stack trace:
#0 /var/www/html/application/libraries/Engine/Api.php(522): Engine_Api->getItemInfo('news_content', 'moduleInflected')
#1 /var/www/html/application/libraries/Engine/Api.php(330): Engine_Api->getItemApi('news_content')
#2 /var/www/html/application/modules/Activity/Model/Notification.php(80): Engine_Api->getItem('news_content', 2622)
#3 /var/www/html/application/modules/Activity/Model/Notification.php(49): Activity_Model_Notification->getObject()
#4 /var/www/html/application/modules/Activity/Model/Notification.php(98): Activity_Model_Notification->getContent()
#5 /var/www/html/application/modules/Activity/views/scripts/notifications/pulldown.tpl(17): Activity_Model_Notification->__toString()
#6 /var/www/html/application/libraries/Zend/View.php(108): include('/var/www/html/a...')
#7 /var/www/html/application/libraries/Zend/View/Abstract.php(835): Zend_View->_run('/var/www/html/a...')
#8 /var/www/html/application/libraries/Zend/Controller/Action/Helper/ViewRenderer.php(903): Zend_View_Abstract->render('notifications/p...')
#9 /var/www/html/application/libraries/Zend/Controller/Action/Helper/ViewRenderer.php(924): Zend_Controller_Action_Helper_ViewRenderer->renderScript('notifications/p...', NULL)
#10 /var/www/html/application/libraries/Zend/Controller/Action/Helper/ViewRenderer.php(964): Zend_Controller_Action_Helper_ViewRenderer->render()
#11 /var/www/html/application/modules/Activity/controllers/NotificationsController.php(109): Zend_Controller_Action_Helper_ViewRenderer->postDispatch()
#12 /var/www/html/application/libraries/Zend/Controller/Action.php(512): Activity_NotificationsController->pulldownAction()
#13 /var/www/html/application/libraries/Zend/Controller/Dispatcher/Standard.php(289): Zend_Controller_Action->dispatch('pulldownAction')
#14 /var/www/html/application/libraries/Zend/Controller/Front.php(946): Zend_Controller_Dispatcher_Standard->dispatch(Object(Zend_Controller_Request_Http), Object(Zend_Controller_Response_Http))
#15 /var/www/html/application/modules/Core/Bootstrap.php(75): Zend_Controller_Front->dispatch()
#16 /var/www/html/application/libraries/Engine/Application.php(160): Core_Bootstrap->run()
#17 /var/www/html/application/index.php(194): Engine_Application->run()
#18 /var/www/html/index.php(24): include('/var/www/html/a...')
#19 {main} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T13:42:01.507

项目的设置在 Application->modules->'modulename'->settings>manifest.php

有一个名为 items 的数组，我在其中添加了“news_content”并且它起作用了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-09-02T10:49:47.370

我设法修复它。

问题是不知何故（尽管模块列表中的模块框上缺少启用/禁用链接）它被禁用了。

为了启用它，我访问了“engine4_core_modules”表，搜索“存储”名称并将“启用”单元格内容从 0 更改为 1。

# php - 使用 CURL PHP 获取文件内容？

> ID：10707216
> 
> 赞同：1
> 
> 时间：2012-05-22T17:44:55.200
> 
> 标签：php, file, curl

内容不会从文件中加载，这是我的 curl 代码，

```
curl_setopt($curl, CURLOPT_RETURNTRANSFER, 1);
// GET CONTENTS OF HASHES.TXT
curl_setopt($curl, CURLOPT_URL, 'http://xxx.com/api/x.txt');
// SUCCESSFULY OPENED HASHES.TXT
$file = curl_exec($curl);
echo $file; // RETURNS NOTHING
echo curl_error($curl); // COULDN'T CONNECT TO HOST
echo curl_getinfo($curl, CURLINFO_HTTP_CODE); // 0 
```

curl 正在工作，因为我之前在脚本的上方打开了其他网页，

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T17:48:02.620

为了获取对变量的响应，您应该使用：

```
curl_setopt($curl, CURLOPT_RETURNTRANSFER, 1); 
```

在执行之前。

# css - 覆盖和框不透明度冲突

> ID：10707217
> 
> 赞同：0
> 
> 时间：2012-05-22T17:45:07.310
> 
> 标签：css

使用此代码块创建覆盖和框。

问题：盒子继承了父母的不透明度，我希望它没有透明度。

```
#overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: #000;
      filter:alpha(opacity=50);
      -moz-opacity:0.5;
      -khtml-opacity: 0.5;
      opacity: 0.5;
      z-index: 10000;
      text-align: center;        
    }

    #formed{
      background-color: white;      
      width:300px;
      height:200px;
      position:relative;
      left:50%;
      top:50%;
      margin:-100px 0 0 -150px;
    }

<div id="overlay"><div id="formed">Enter Here</div></div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T18:04:57.257

不幸的是，这就是它的工作方式。对于父 div，您可以尝试使用 RGBA 作为背景颜色 - `background: rgba(0, 0, 0, 0.5);` [http://css-tricks.com/rgba-browser-support/](http://css-tricks.com/rgba-browser-support/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T19:14:30.113

对于这样的事情（假设您不需要支持 IE7 或更早版本），请像[this fiddle 一样](http://jsfiddle.net/SRqF8/3/)将不透明度应用于伪元素。代码：

**CSS**

```
#overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: 10000;
      text-align: center;        
    }

#overlay:after {
    content: '';
    position: absolute;
    top: 0;
    right: 0;
    bottom: 0;
    left: 0;
    background-color: #000;
    filter:alpha(opacity=50);
    -moz-opacity:0.5;
    -khtml-opacity: 0.5;
    opacity: 0.5;
    z-index: 0;
}

#formed{
    background-color: white;      
    width:300px;
    height:200px;
    position:relative;
    left:50%;
    top:50%;
    margin:-100px 0 0 -150px;
    z-index: 1;
 } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-22T21:51:34.820

多谢你们。我能够通过做两件事来解决这个问题：

*   将孩子 div 带到它的父母之外。 `<div id="overlay"></div><div id="formed">Here</div>`

*   改变两个 div 的位置

    ```
    #overlay{
          position: fixed;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          background-color: #000;
          filter:alpha(opacity=50);
          -moz-opacity:0.5;
          -khtml-opacity: 0.5;
          opacity: 0.5;
          z-index: 10000;
          text-align: center;
          display: none;
        }

        #formed{
          /* for IE */
          filter:alpha(opacity=100);
          /* CSS3 standard */
          opacity:1;
          -webkit-border-radius: 10px;
          -moz-border-radius: 10px;
          border-radius: 10px;
          background-color: white;
          width:300px;
          height:200px;
          position: absolute;
          left:50%;
          top:50%;
          margin:-100px 0 0 -150px;
          z-index: 12000;
          border: 2px solid #eee;
          display: none;
        } 
    ```

# windows - 将参数传递给 psql.exe

> ID：10707218
> 
> 赞同：9
> 
> 时间：2012-05-22T17:45:07.483
> 
> 标签：windows, postgresql

我想从应用程序启动 psql.exe。用户找到脚本，所以它可以在他的磁盘上的任何地方，应用程序只是将该脚本提供给 psql。就是这样。

什么是正确的命令行？

我试过这个没有成功

```
"C:\Program Files\PostgreSQL\9.1\bin\psql.exe" TEST SYSADM -f "C:\Documents and Settings\Administrateur\Mes documents\TD6.0\FETCHING\install.sql" 
```

我尝试使用引号，没有引号，没有任何工作，它只是忽略了参数（在 cmd.exe 上试过）

```
C:\Documents and Settings\Administrateur>"C:\Program Files\PostgreSQL\9.1\bin\psql.exe" TEST SYSADM -f "C:\Documents and Settings\Administrateur\Mes documents\TD6.0\FETCHING\install.
sql"
psql: warning: extra command-line argument "-f" ignored
psql: warning: extra command-line argument "C:\Documents and Settings\Administrateur\Mes documents\TD6.0\FETCHING\install.sql" ignored
Password for user SYSADM: 
```

是的，如果脚本与 psql.exe 位于同一目录中，并且如果我首先 CD 到安装 psql.exe 的位置，这意味着没有引号，没有绝对路径并且它工作正常。但是，就我而言，我希望应用程序可以在任何 Windows 安装上运行，这意味着 psql.exe 可以在任何地方，而 sql 脚本也可以在任何地方。我仍然希望将脚本提供给 psql.exe。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-22T18:01:39.783

试试这个：

```
"C:\Program Files\PostgreSQL\9.1\bin\psql.exe" -f "C:\Documents and Settings\Administrateur\Mes documents\TD6.0\FETCHING\install.sql" TEST SYSADM 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T21:58:15.003

将以下命令另存为 BATch 文件（install.bat 等）。

请注意“defaultValueHere”。您可以设置默认值以防您的用户跳过该条目。

```
SET installScript=defaultValueHere
SET /P server="Enter the install script location [%installScript%]: "
ECHO you typed %installScript%
PAUSE 
"C:\Program Files\PostgreSQL\9.1\bin\psql.exe" TEST SYSADM -f %installScript% 
```

指示用户从 install.bat 文件启动安装。另请参阅我关于将参数传递给 SQL 脚本的[答案。](https://stackoverflow.com/a/10337507/212950)

# jquery - 为什么 ('#formId').trigger('submit') 会导致我的表单多次发布，而 ('formId').trigger('submit') 却没有？

> ID：10707221
> 
> 赞同：1
> 
> 时间：2012-05-22T17:45:18.467
> 
> 标签：jquery, ajax, asp.net-mvc-3, forms, submit

我有一个分成标签的 MVC3 页面。每个选项卡都有一个带有不同 id 的 AJAX 表单的部分视图。

```
@using (Ajax.BeginForm("Create1", "ControllerName", ajaxOptions, new { id = "frmCreate1" }))
...
@using (Ajax.BeginForm("Create2", "ControllerName", ajaxOptions, new { id = "frmCreate2" }))
...
@using (Ajax.BeginForm("Create3", "ControllerName", ajaxOptions, new { id = "frmCreate3" })) 
```

每个选项卡上都有一个具有不同 ID 的保存按钮。

```
<input type="submit" id="btnSave1" />
...
<input type="submit" id="btnSave2" />
...
<input type="submit" id="btnSave3" />
... 
```

每个选项卡都包含一个包含按钮处理程序的 javascript 文件：

```
// Submit Button
    $('#btnSave1').button({ label: "Save" });
    $('#btnSave1').click(function () {
        $.blockUI({ message: 'We are constructing your new Type 1, please wait just a moment...', theme: true, title: 'Saving' });
        $('frmCreate1').trigger('submit');
    });

...
// Submit Button
    $('#btnSave2').button({ label: "Save" });
    $('#btnSave2').click(function () {
        $.blockUI({ message: 'We are constructing your new Type 2, please wait just a moment...', theme: true, title: 'Saving' });
        $('frmCreate2').trigger('submit');
    });
...

// Submit Button
    $('#btnSave3').button({ label: "Save" });
    $('#btnSave3').click(function () {
        $.blockUI({ message: 'We are constructing your new Type 3, please wait just a moment...', theme: true, title: 'Saving' });
        $('frmCreate3').trigger('submit');
    }); 
```

一切都正确提交到后端，它从表单中获取所需的数据。但是我将方法中的选择器更改为

```
$('#frmCreate1).trigger('submit'); 
```

现在，当运行它时，表单被多次提交，导致我跳入调试器并随后两次发布相同的数据。

我猜它是通过 Ajax 使用正确的选择器提交表单，然后再次触发表单的实际提交，但我不确定发生了什么。

我想确保代码就我真正想做的事情而言是正确的。这些应该是 3 个单独的单独提交。我是否将“提交”按钮更改为仅按钮类型而不是提交，还是应该在 javascript 中有更多内容以防止发生第二次提交？preventDefaults 什么的？

谢谢！

编辑：还应该包括 Ajax 选项，它们出现在每个选项卡上并对应于选项卡，它们的名称都不同，但以防万一“发布”方法与此有关。

```
@{
    AjaxOptions ajaxOptions = new AjaxOptions
    {
        HttpMethod = "Post",
        UpdateTargetId = "tabs-1",
    };
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T18:33:32.707

从评论中重新发布我的答案：

问题是提交按钮实际上是在提交表单，而选择器`$('frmCreate1').trigger('submit');`什么也没做，因为它没有返回任何元素。When the selector was made valid by adding the '#' so that it looked for an id rather than a tag name, then that triggered the submit as well. 因此双重提交。如果您选择应该停止双重提交的一个或另一个。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T18:27:56.853

好像表单没有提交`ajaxily`确保您已包含

```
<script src="@Url.Content("~/Scripts/jquery.unobtrusive-ajax.min.js")" type="text/javascript"></script> 
```

在您的布局中，还使`unobtrusiveJavascript`您必须在配置文件中的`appSetting`部分下将相关标志设置为 true

```
 <appSettings>
    <add key="ClientValidationEnabled" value="true" />
    <add key="UnobtrusiveJavaScriptEnabled" value="true" />
  </appSettings> 
```

# php - 如何以三种方式编码 php 代码 Like -> base64 & str_rot13 & gzinflate

> ID：10707225
> 
> 赞同：0
> 
> 时间：2012-05-22T17:45:31.670
> 
> 标签：php, encoding, base64

`base64 & str_rot13 & gzinflate!`我对php代码的三种编码方式（特别是方式）有点困惑`str_rot13 and gzinflate`。
编码后的最新php文件应该是这样的：

```
<?php
eval(gzinflate(str_rot13(base64_decode('Your Encoded string'))));
?> 
```

例如这是我的 php 代码：

```
<?php
echo('This Is A PHP Code');
?> 
```

一步一步教我如何编码这些 php 代码？
我找不到任何关于此的在线编码器，只有很多解码器！
我正在寻找最快的方法，因为我想始终使用这些编码方法。
我认为第 1 步和第 2 步如下所示：
1- 将 php 代码转换为：

```
?><?php
echo('This Is A PHP Code');
?><?php 
```

步骤 1 中的 2 编码代码：
[base_64 编码器](http://www.webutils.pl/Base64)
3-?????? 帮我

非常感谢关注

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-12-05T11:21:08.693

这是一个使用 eval() 的示例 PHP 代码。

```
<?php // sample answer by chathurya
/*
$string  = '<?php echo \'<p>Hello World</p>\'; ?> ';
*/

$string  = ' echo \'<p>Hello World</p>\'; ?> ';
$encoded = base64_encode(str_rot13(gzdeflate($string)));
$uncompressed = gzinflate(str_rot13(base64_decode($encoded)));

eval($uncompressed);
?> 
```

注意：您需要编码的字符串不能包含

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-12-11T11:04:55.817

```
<?php
$code='<?php echo "hallo world";';
$encode=rawurlencode(gzdeflate($code));

echo gzinflate(rawurldecode($encode));

eval('?>'.gzinflate(rawurldecode($encode))); 
```

另一个例子[https://github.com/Cvar1984/ecode](https://github.com/Cvar1984/ecode)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-06-30T20:43:09.950

```
#Something like this 
<?php
$a='<?php echo "hallo";'; // php script
$a=urlencode(gzdeflate($a)); // encode 
$b=gzinflate(urldecode($a)); // decode
eval('?>'.$b); // exec encoded php script 
```

# javascript - jquery：重置后禁用/启用按钮不起作用

> ID：10707229
> 
> 赞同：1
> 
> 时间：2012-05-22T17:45:46.537
> 
> 标签：javascript, jquery, forms, jquery-ui

我有一个表单，其中包含 n 个多项选择问题，实现为单选按钮（使用`jquery-ui`）。在允许用户提交表单之前，我想确保所有问题都已得到解答。我在执行此验证时遇到了两个问题：

*   在初始加载时，提交按钮不会响应单击或鼠标悬停，直到所有问题都根据需要选择了响应。但是，它似乎仍然是可点击的（我希望它淡出）

![在此处输入图像描述](../Images/ce172d0f9e7711dee82f804251c2d1b9.png)

*   如果按下重置按钮，提交按钮会淡出（根据需要），但是一旦表单完成，我就无法重新启用提交按钮。

![在此处输入图像描述](../Images/a180670011503f850a245c46e38b4017.png)

这是我第一次使用 javascipt/jquery。出了什么问题？如何在这两种情况下实现所需的功能？

* * *

这是相关的javascript部分：

```
$(document).ready(function(){
    $( '.button' ).button ();
    $( '.radio-set' ).buttonset ();
    $( 'input[type="submit"]' ).attr( 'disabled', true );

    var progress = 0;
    var total_fields = $('.response').length

    /* Track Progress function*/
    $('input[type="radio"]').click( function(){        
      progress = $('input[type="radio"]:checked').length
      $(".progressbar").progressbar( {value: ( progress / total_fields ) * 100} )
      console.log(progress, total_fields)
      if( progress == total_fields ){
        console.log( "Hello from inside the conditional" )
        $( 'input[type="submit"]' ).removeAttr( 'disabled' );
      } 
    });

    $( 'input[type="reset"]' ).click( function(){
      progress = 0
      $( ".progressbar" ).progressbar( {value: 0} )
      $( 'input[type="submit"]' ).attr( 'disabled', true );
    });
}); 
```

表格中的一个问题示例（带有培根填充文本）：

```
 <div class="model_feature">
          <span class="feature_name" title="M1">M1</span>
          <span class="response radio-set">
            <label for="M1-1">1</label>
            <input type="radio" name="M1" id="M1-1" value="1"  class="feature-input" autocomplete="off" />
            <label for="M1-0">0</label>
            <input type="radio" name="M1" id="M1-0" value="0"  class="feature-input" autocomplete="off" />
            <label for="M1-Unk">Unknown</label>
            <input type="radio" name="M1" id="M1-Unk" value="Unknown"  class="feature-input" autocomplete="off" />
          </span <!-- close response -->
          <span class="feature_description">Chicken spare ribs capicola beef brisket hamburger. Kielbasa filet mignon tail ribeye ball tip ground round.</span>
        </div> <!-- close model_feature --> 
```

输入和重置按钮的完整性：

```
 <input type="reset" class="button" id="reset-button" />
        <input type="submit" class="button" id="submit-button" disabled="disabled" /> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T05:47:36.077

当您将按钮转换为 jQuery UI 按钮时，您最好使用 Button 插件的 jQuery UI 方法来启用/禁用您的按钮，而不是直接更改 DOMElement 属性`disabled`。

1.  对于初始状态，您初始化 Button，然后仅更改`disabled`属性，因此 Button 插件会考虑更改。

    ```
    // either disable first the button then initialize
    $( 'input[type="submit"]' ).attr( 'disabled', true );
    $( '.button' ).button (); 
    ```

    或者

    ```
    // set the Button's option
    $( '.button' ).button ();
    $( 'input[type="submit"]' ).button('option', 'disabled', true); 
    ```

2.  对于第二个问题，使用 Button 的选项设置器重新启用您的按钮：

    ```
    $( 'input[type="submit"]' ).button('option', 'disabled', false); 
    ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-05-25T19:53:58.897

`disabled`我通过在添加属性之前等待一段时间解决了这个问题。例子，

```
var btn = $("button").first();
$(btn).button("loading");
$(btn).button("reset");
setTimeout(function () {
    $(btn).prop("disabled", true);
}, 0); 
```

这里有一个同样的问题[，这里](https://stackoverflow.com/questions/17968611/jquery-attr-not-working-on-bootstrap-button-after-reset)有一个 gihub[问题](https://github.com/twbs/bootstrap/issues/6242)。

# c++ - 使用 DevIL 在 C++ OpenGL 中加载纹理

> ID：10707230
> 
> 赞同：1
> 
> 时间：2012-05-22T17:45:50.650
> 
> 标签：c++, opengl, devil

使用 C++，我正在尝试使用 DevIL 将纹理加载到 OpenGL 中。在四处寻找不同的代码段之后，我完成了一些代码（如下所示），但它似乎并不完全有效。

加载纹理（Texture2D 类的一部分）：

```
void Texture2D::LoadTexture(const char *file_name) 
{   
    unsigned int image_ID;

    ilInit();
    iluInit();
    ilutInit();

    ilutRenderer(ILUT_OPENGL);

    image_ID = ilutGLLoadImage((char*)file_name);

    sheet.texture_ID = image_ID;
    sheet.width = ilGetInteger(IL_IMAGE_WIDTH);
    sheet.height = ilGetInteger(IL_IMAGE_HEIGHT);
} 
```

这可以编译并正常工作。我确实意识到我应该只执行一次 ilInit()、iluInit() 和 ilutInit()，但如果我删除这些行，程序会在加载任何图像时立即中断（编译正常，但运行时出错）。

在 OpenGL 中显示纹理（同一类的一部分）：

```
void Texture2D::Draw() 
{

    glEnable(GL_BLEND);
    glBlendFunc(GL_SRC_ALPHA,GL_ONE_MINUS_SRC_ALPHA);
    glPushMatrix();

    u = v = 0;

    // this is the origin point (the position of the button)
    VectorXYZ point_TL; // Top Left 

    VectorXYZ point_BL; // Bottom Left
    VectorXYZ point_BR; // Bottom Right
    VectorXYZ point_TR; // Top Right

    /* For the sake of simplicity, I've removed the code calculating the 4 points of the Quad. Assume that they are found correctly. */

    glColor3f(1,1,1);
    // bind the appropriate texture frame
    glBindTexture(GL_TEXTURE_2D, sheet.texture_ID);

    // draw the image as a quad the size of the first loaded image
        glEnable(GL_TEXTURE_2D);
        glBegin(GL_QUADS);
            glTexCoord2f (0, 0);
            glVertex3f  (point_TL.x, point_TL.y, point_TL.z); // Top Left

            glTexCoord2f (0, 1);
            glVertex3f  (point_BL.x, point_BL.y, point_BL.z); // Bottom Left

            glTexCoord2f (1, 1); 
            glVertex3f  (point_BR.x, point_BR.y, point_BR.z); // Bottom Right

            glTexCoord2f (1, 0);
            glVertex3f  (point_TR.x, point_TR.y, point_TR.z); // Top Right
        glEnd();
        glPopMatrix();
    glDisable(GL_BLEND);
    glDisable(GL_TEXTURE_2D);
} 
```

目前，四边形出现了，但它完全是白色的（它给出的背景颜色）。我正在加载的图像存在并且加载良好（使用加载的大小值验证）。

我应该注意的另外几件事：1）我正在使用深度缓冲区。我听说这不适合 GL_BLEND？2) 我真的很想使用 ilutGLLoadImage 函数。3) 我很欣赏示例代码，因为我是 openGL 和 DevIL 整体的新手。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T17:52:55.213

是的，你有问题。ilutGLLoadImage() 可能存在问题。

尝试手动操作：

1.  使用 ilLoadImage 加载图像
2.  使用 glGenTextures 生成 OpenGL 纹理句柄
3.  将图像上传到 OpenGL glTextImage2D 和 ilGetData()

请参阅此链接以获取有效的解决方案

[http://r3dux.org/tag/ilutglloadimage/](http://r3dux.org/tag/ilutglloadimage/)

我知道，这个解决方案似乎“有点”复杂，但是没有人知道你会花多少时间来解决这个隐藏在 DevIL 深处的错误。

解决问题的另一种方法：检查 GL 纹理设置代码。过滤中的任何内容都可能是 GL_INVALID_OPERATION 的原因。

在对旧 ATI 卡进行编程时，我们经常遇到“白色纹理”问题。

哦！最大的猜测：非二次幂纹理。你的纹理文件是 2^N x 2^N 还是其他的？

要使用非矩形纹理，您只需使用 GL 扩展。

另一个：你是在同一个线程还是在另一个线程中使用纹理？请记住，您应该在同一个线程中使用 glGenTextures() 和 glBindTexture()/glBegin/glEnd。

# php - 删除但保留数组 php/mysql 中带有 id 的行

> ID：10707232
> 
> 赞同：2
> 
> 时间：2012-05-22T17:46:00.780
> 
> 标签：php, mysql

所以我有一个`$items= array(13, 19, 22, 3129);`

如何在我的 DELETE 查询 sql 中不包含具有这些 id 的行？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-22T17:47:48.467

```
DELETE FROM table1
WHERE id NOT IN (13, 19, 22, 3129) 
```

在 PHP 中，您可以使用[implode()](http://www.php.net/manual/en/function.implode.php)函数来构建 IN 子句。

```
$items = implode(",", $items);    
$sql = "DELETE FROM table1 WHERE id NOT IN ({$items})"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T18:01:23.873

使用 implode 但不要设置相同的数组变量，因为您稍后可能会在程序中使用它，因为也不建议或将其作为良好的编程习惯来更改变量的数据类型。

```
$items= array(13, 19, 22, 3129);
$sql = sprintf("delete from tbl where id_col not in (%s)",implode(",", $items)); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-22T18:21:51.833

如果`mytable`很大但要保留的条目数量很小，这是一种更快的方法

```
$items= array(13, 19, 22, 3129); 
$sql = "CREATE TABLE mynewtable LIKE mytable";
mysql_query($sql);
$id_list = sprintf("(%s)",implode(",", $items)); 
$sql = "INSERT INTO mynewtable SELECT * FROM mytable WHERE id_col IN " . $id_list; 
mysql_query($sql);
$sql = "DROP TABLE mytable";
mysql_query($sql);
$sql = "ALTER TABLE mynewtable RENAME mytable";
mysql_query($sql); 
```

# html - 定位跨浏览器

> ID：10707233
> 
> 赞同：0
> 
> 时间：2012-05-22T17:46:06.100
> 
> 标签：html, css

这是我所拥有的：

```
#nameDiv
{
    height: 0px;
    width: 20px;
    position: relative;
    top: -22px;
    left: 134px;
}

#nameDivDuplicate
{
    height: 0px;
    position: relative;
    top: -22px;
    left: 134px;
    width: 20px;
} 
```

在我看来，我有：

```
<tr>
    <td><b>Name:</b> </td><td><input type="text" id="txtName" maxlength="100"/>
    <div id="nameDiv"  title="The Name is required.">
        <img title="The Name is required." src="error.jpg" id="txtNameRequired"/>
    </div>
    <div id="nameDivDuplicate"  title="The address already exists.">
        <img title="The address already exists." src="error.jpg" id="txtNameDuplicate"/>
    </div>
    </td>
    <td>Address: </td><td><input type="text" id="txtAddress"  maxlength="100"/> </td>
</tr> 
```

nameDiv 和 nameDivDuplicate div 一开始有 sidplay:none。然后，我用 jquery 向他们展示。我需要将它们显示在与 txtName 相同的位置（在其右侧）。

上面的代码适用于 Google Chrome，但不适用于其他浏览器。这是如何处理的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T17:59:02.893

`position:relative`应该与 结合使用`position:absolute`，其中`position:relative`在父元素中设置绝对定位的子元素的原点。

您没有以这种方式使用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T18:22:05.063

你必须非常小心位置：相对。它真的会让你有些头疼。position:relative 存在很多问题（尤其是在 IE 中）。

我建议不要在这种情况下使用它。相反，我会在您的两个错误图像周围放置额外的 td 标签，让它们创建自己的列。这会将它们放在 txtName 输入框的右侧。

```
<tr>
<td><b>Name:</b> </td>
<td><input type="text" id="txtName" maxlength="100"/></td>
<td>
    <div id="nameDiv"  title="The Name is required.">
       <img title="The Name is required." src="error.jpg" id="txtNameRequired"/>
    </div>
    <div id="nameDivDuplicate"  title="The address already exists.">
       <img title="The address already exists." src="error.jpg" id="txtNameDuplicate"/>
    </div>
</td>
<td>Address: </td><td><input type="text" id="txtAddress"  maxlength="100"/> </td>
</tr> 
```

编辑：既然您说您不想要一个新列，您可以在该 td 标记内的所有内容周围添加一个 div 标记，并使用 float:left 将它们全部对齐，或者您可以设置宽度。

```
#nameDiv { width: 20px; float:left; }
#nameDivDuplicate { float:left; }
#txtName { float:left; } 
```

我将添加的新 DIV 加粗。

```
<td><b>Name:</b> </td>
<td>
  **<div>**<input type="text" id="txtName" maxlength="100"/>
    <div id="nameDiv"  title="The Name is required.">
        <img title="The Name is required." src="error.jpg" id="txtNameRequired"/>
    </div>
    <div id="nameDivDuplicate"  title="The address already exists.">
        <img title="The address already exists." src="error.jpg" 
             id="txtNameDuplicate"/>
    </div>
  **</div>**
</td>
<td>Address: </td>
<td><input type="text" id="txtAddress"  maxlength="100"/> </td> 
```

# java - Locale.getDefault() 总是返回 en

> ID：10707238
> 
> 赞同：12
> 
> 时间：2012-05-22T17:46:24.663
> 
> 标签：java, linux, unix, locale

unix 机器上的服务器始终使用 en 作为默认语言环境。以下是语言环境输出

```
 LANG=en_US
 LC_CTYPE="C"
 LC_NUMERIC="C"
 LC_TIME="C"
 LC_COLLATE="C"
 LC_MONETARY="C"
 LC_MESSAGES="C"
 LC_ALL=C 
```

我只是不明白 LANG 是否设置正确，那么为什么服务器以 en locale 开头。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-05-22T18:22:33.940

在 Linux/Unix/Mac 中，设置`LC_ALL`并`LANG`可以控制 Java 程序的默认语言环境。在 Windows 中，区域设置是从控制面板的区域和语言选项下设置的。

当 JVM 在 *nix 环境中启动时，它将执行以下操作：

*   扫描环境`LC_ALL`
*   如果`LC_ALL`不存在，请扫描环境以查找`LANG`
*   如果设置了 JVM 设置`user.language`，请使用它代替环境变量。
*   如果没有设置，默认为`en_US`（我相信这是最后的失败案例）

在您的环境中，您已`LC_ALL`设置为`C`，这只是 C 语言环境。这基本上是对不使用语言环境的传统回退。

你可以改变`LC_ALL`你的情况，重新启动你的JVM，你应该得到一个新的值`java.util.Locale.getDefault()`。

例子：

```
import java.util.Locale;

public class LocaleTest {
   public static void main(String[] args) {
      System.out.println(Locale.getDefault());
   }
} 
```

这里正在运行：

```
> LC_ALL=en_UK java LocaleTest
en_UK

> LC_ALL=ja_JP java LocaleTest
ja_JP 
```

另请注意，如果您运行的是 Java 1.7.0-b147，则 JRE 存在一个错误，无法识别区域设置的环境设置，并且将始终使用默认系统区域设置。

错误报告在这里：[http ://bugs.sun.com/bugdatabase/view_bug.do?bug_id=7073906](http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=7073906)

# php - PHP 类 - 状态消息应该在类内还是类外？

> ID：10707243
> 
> 赞同：0
> 
> 时间：2012-05-22T17:46:58.817
> 
> 标签：php, oop, class

我有一个做某事的类，当它完成后它会返回`true`，但如果各种事情中的任何一个出错，它就会返回`false`。现在我的问题是，此类事件的状态消息应该保存在类（Example1）内还是类外（Example2），其中类可能只提供错误代码来帮助区分发生了什么。

```
 class Example1 {

       private $var;
       private $status;

       public function doSomething($var) {
         $this->var = $var;

         if (!is_numeric($this->var)) { 
            $this->status = 'Please provide a number'; 
            return false; 
         }

         if (empty($this->var)) {
            $this->status = 'Please fill the field';
            return false;
         }

         $this->status = 'Ok, you submitted a number, cool.';
         return true;
    } 

         function getStatus() {
            return $this->status;
         }
} 
```

示例 2：

```
 class Example2 {

       private $var;

       public function doSomething($var) {
         $this->var = $var;

         if (!is_numeric($this->var)) {  
            return false; 
         }

         if (empty($this->var)) {
                return false;
         }

             return true;
    } 

} 
```

示例 1 在我看来使用起来更方便，代码读起来像一首诗，但同时似乎不太可重用，根据您使用类的目的，您可能希望成功/错误消息具有不同的语法。

所以基本上我的问题是通常的做法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T18:11:21.103

这不是您要问的，但通常认为在一个函数中有多个 return 语句是不好的做法。问题是它使您更难知道您退出函数的位置，这使得不清楚执行了什么。在您的示例中，如果第一个测试成功，则不会执行其余代码。如果你之后设置一些属性会发生什么？有时它们会被设置，有时它们不会。要摆脱这个问题，最好只有一个 return 语句。将执行更多代码，您必须稍微改变编码方式才能习惯它。

这是我的意思的一个例子，你提供的代码：

```
public function doSomething($var) {
     $this->var = $var;
    $result = false;
     if (!is_numeric($this->var)) { 
        $this->status = 'Please provide a number';  
     }
     else if (empty($this->var)) {
        $this->status = 'Please fill the field';
     }
     else{
        $this->status = 'Ok, you submitted a number, cool.';
        $result = true;
    }
     return $result;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T17:49:36.577

第一个示例：您对错误消息进行硬编码，这是......不好的。如果您稍后不检查，您将看不到错误消息`$object->status`。
第二个例子：如果出了问题，你知道但你不知道为什么。

我建议避免这两种方式并为更面向对象的方法抛出异常（我想这就是你想要的，因为你正在使用类:)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-22T17:50:36.643

这完全取决于你。如果错误消息更容易让您理解并帮助您调试代码，那么请务必使用它。为不同的错误提供错误代码可能只会减慢开发过程，除非您想对用户隐藏真正的错误（但在这种情况下，您有多种选择，其中之一是根本不将错误打印到屏幕上，如果用户可能会看到它们）。

# php - 错误处理和图像类型 cat 让它工作

> ID：10707244
> 
> 赞同：0
> 
> 时间：2012-05-22T17:47:08.153
> 
> 标签：php

我已经在这个图像脚本上工作了太长时间，但我似乎仍然无法让两件事起作用 - 图像类型和错误处理（如果字段为空）。我有这个的代码，但是我尝试添加它的每个地方，它都不起作用。

我的代码：

```
$error_message="";
$MaxSize = "600000";
if (isset($_POST['btn_update'])){
function createRandomPassword() {
$chars = "abcde!@#%^fghijkmnoABCDEFGHIJKpqrstuvwxyz023456789ABCDEFGHIJKLMNOPQRSTUVWZ!@#%^&";
srand((double)microtime()*10000000);
$i = 0;
$pass = '' ;
while ($i <= 19) {
$num = rand() % 60;
$tmp = substr($chars, $num, 1);
$pass = $pass . $tmp;
$i++;
}
return $pass;
}
if ($_FILES['aMyUploads0']['size'] > $MaxSize || $_FILES['aMyUploads1']['size'] > $MaxSize || $_FILES['aMyUploads2']['size'] > $MaxSize)
{
$error_message = "ERROR: File too big!";

}
$aMyUploads = array();
$password = createRandomPassword();
foreach($_FILES as $aFile)
{
$newLocation = 'uploads/'.$password .$aFile["name"];
if(0 === $aFile['error'] && (false !== move_uploaded_file($aFile['tmp_name'], $newLocation)))
{
$aMyUploads[] = $newLocation;
}
else
{
$aMyUploads[] = '';
}
}
$error_message="Journal successfully saved.";
$connection = mysql_connect("localhost", "????", "???");
mysql_select_db("????", $connection);
$insert = "INSERT INTO photos (image1, image2, image3) VALUES
(
' ".$aMyUploads[0]." ',
' ".$aMyUploads[1]." ',
' ".$aMyUploads[2]." '
)";
$add_member = mysql_query($insert) or die(mysql_error());
}

code im trying to add with no luck:

 //ERROR HANDLING CODE:

    if(empty($aMyUploads[0]) || empty($aMyUploads[1]) || empty($aMyUploads[2]))
    {
    $error_message="Please fill in all fields.";
    }
    else
    {
    $error_message="Journal successfully saved.";

//IMAGE TYPE CODE:

$allowed_filetypes = array(".jpg", ".gif", ".jpeg", ".png");

$ext = substr($newLocation, strpos($newLocation,'.'), strlen($newLocation)-1);
if(!in_array($ext,$allowed_filetypes))
{
die('The file you attempted to upload is not allowed.');
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T20:12:48.703

试试这个检查必填字段，插入在检查文件大小的代码之前。

```
// ERROR HANDLING CODE:
if (empty($_FILES) || empty($_FILES['aMyUploads0']) || empty($_FILES['aMyUploads1']) || empty($_FILES['aMyUploads2']))
{
    // Handle error
} 
```

这用于验证文件类型，插入到您的`foreach`.

```
// IMAGE TYPE CODE:

$allowed_filetypes = array("jpg", "gif", "jpeg", "png");

$ext = pathinfo($aFile['name'], PATHINFO_EXTENSION);
if (!in_array($ext, $allowed_filetypes))
{
    // Handle error
} 
```

# javascript - 我想使用 JQUERY 或 JAVASCRIPT 从文件菜单禁用网页的打印和保存

> ID：10707245
> 
> 赞同：1
> 
> 时间：2012-05-22T17:47:11.797
> 
> 标签：javascript, printing, save

请帮助我想要一个代码，用于使用 JQUERY 或 JAVASCRIPT 从文件菜单中禁用网页的打印和保存

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-22T18:04:01.690

您可以拥有仅在打印时可见的 CSS 样式：

```
<link rel="stylesheet" href="print.css" type="text/css" media="print" /> 
```

然后我想你可以做类似的事情：

```
*{
    color:#fff !important;
    background:#fff !important;
    line-height:0 !important;
    font-size:0 !important;
    height:0 !important;
    width:0 !important;
    /*...*/
} 
```

这里也是一个[教程](http://www.webcredible.co.uk/user-friendly-resources/css/print-stylesheet.shtml)。

这不会阻止打印，但应该可以满足您的需求。

关于防止页面被保存，这是不可能的，如果他们正在查看页面，他们实际上已经下载了它。您能做的最好的事情就是混淆您的代码以使其不可读。

混淆/压缩工具：

*   [HTML](http://vzone.virgin.net/phil.ronan/obfuscate.html)
*   [CSS](http://www.csscompressor.com/)
*   [JavaScript](http://marijnhaverbeke.nl/uglifyjs)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T17:49:49.357

您可以使用一些巧妙的 CSS 禁用打印，但我不相信您将能够阻止用户保存页面。网页不能真正修改浏览器的行为到那种程度。

澄清一下，当我说禁用打印时，您可能会导致它只打印空白页，而不是真正禁用它。

# html - CSS全屏div，中间有文字

> ID：10707253
> 
> 赞同：42
> 
> 时间：2012-05-22T17:47:36.600
> 
> 标签：html, css, webkit

我定义了一个 css 类，所以我可以制作一个 div 来使用所有浏览器的视口，规则如下：

```
.fullscreenDiv {
    background-color: #e8e8e8;
    width: 100%;
    height: auto;
    bottom: 0px;
    top: 0px;
    left: 0;
    position: absolute;
} 
```

现在我希望 div 内的文本位于屏幕的确切中心，因此垂直对齐中心和水平对齐中间，但我似乎找不到正确的方法。

它只需要在基于 webkit 的浏览器上工作。

我已经尝试在其中添加一个 P 元素并`display`设置为`table-cell`（一种使文本居中的常用方法），但没有运气。

有什么建议么？

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2014-12-23T04:41:03.480

接受的答案有效，但如果：

*   你不知道内容的尺寸
*   内容是动态的
*   你想成为未来的证明

用这个：

```
.centered {
  position: fixed; /* or absolute */
  top: 50%;
  left: 50%;
  /* bring your own prefixes */
  transform: translate(-50%, -50%);
} 
```

[这篇出色的 CSS-Tricks 文章](http://css-tricks.com/quick-css-trick-how-to-center-an-object-exactly-in-the-center/)中有关居中内容的更多信息。

* * *

此外，如果您不需要支持旧浏览器：一个 flex-box 让这变得轻而易举：

```
.center{
    height: 100vh;
    display: flex;
    justify-content: center;
    align-items: center;
} 
```

Another great guide about flexboxs from CSS Tricks; [http://css-tricks.com/snippets/css/a-guide-to-flexbox/](http://css-tricks.com/snippets/css/a-guide-to-flexbox/)

* * *

## 回答 #2

> 赞同：55
> 
> 时间：2012-05-22T17:53:11.677

标准方法是给居中元素固定尺寸，并将其绝对放置：

```
<div class='fullscreenDiv'>
    <div class="center">Hello World</div>
</div>​

.center {
    position: absolute;
    width: 100px;
    height: 50px;
    top: 50%;
    left: 50%;
    margin-left: -50px; /* margin is -0.5 * dimension */
    margin-top: -25px; 
}​ 
```

*   [**演示**](http://jsfiddle.net/paislee/wzSmc/)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-22T17:54:16.460

这个经典问题没有纯 CSS 解决方案。

如果你想实现这一点，你有两个解决方案：

*   使用表格（丑陋，非语义，但垂直对齐非单行文本的唯一方法）
*   监听 window.resize 和绝对定位

***编辑***：当我说没有解决方案时，我假设您事先不知道要居中的块的大小。如果你知道的话，佩斯利的解决方案非常好

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-22T17:51:53.710

`text-align: center`将它水平居中，因为垂直将它放在一个跨度中并给它一个css `margin:auto 0;`（你可能还必须给跨度一个`display: block`属性）

# regex - 使用正则表达式筛选源代码树以查找函数调用的出现

> ID：10707257
> 
> 赞同：0
> 
> 时间：2012-05-22T17:47:57.600
> 
> 标签：regex, negative-lookbehind

与其在VS2010中打开一堆解决方案文件然后搜索函数调用的出现/引用，我宁愿只用正则表达式grep。我可以分两遍执行此操作-首先对所有出现的 进行 grep `MyFunction()`，然后删除它在被注释掉的行上的所有出现（注意：我意识到这不处理块注释，现在还可以） .

我想看看是否有更好的方法来做到这一点，[regular-expressions.info](http://www.regular-expressions.info/lookaround.html)有一个有趣的教程，关于正面和负面的前瞻和后瞻。

使用我最喜欢的在线[正则表达式评估器](http://regexr.com)，我处理了以下示例：

```
 // foo.MyFunction()
foo.MyFunction();
    foo.MyFunction()
//foo.MyFunction()
// { foo.MyFunction(); } 
```

但惨败。我什至不确定我正在尝试做的事情是否可以通过负面的后视来实现。这是我认为可能有效的方法：

```
(?<!//.*)MyFunction\(\) 
```

但它不匹配......有人可以在这里启发我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T17:51:46.817

做了几次同样的事情

```
MyFunction\(\)(?<!.*//.*) 
```

[在线正则表达式测试器](http://regexstorm.net/tester?p=MyFunction%5C%28%5C%29%28?%3C!.%2a//.%2a%29&i=%20%20//%20foo.MyFunction%28%29%0D%0Afoo.MyFunction%28%29;%0D%0A%20%20%20%20foo.MyFunction%28%29%0D%0A//foo.MyFunction%28%29%0D%0A//%20%7B%20foo.MyFunction%28%29;%20%7D)

# python - IPython 魔术命令和破折号

> ID：10707259
> 
> 赞同：1
> 
> 时间：2012-05-22T17:47:58.327
> 
> 标签：python, bash, shell, ipython

我最近将我的默认 shell 切换到 IPython，而不是 bash，方法是创建一个 IPython 配置文件，并打开自动魔术、自动调用和其他此类功能。为了使可执行文件对 IPython 环境可见，我`%rehashx`在我的配置文件中包含了自动运行。这样做的问题是名称中带有破折号的命令，例如`xdg-open`，没有正确地翻译成魔术命令，因此需要使用 shell-escape 语法才能运行。有没有办法用破折号自动执行命令，以便我可以更接近地模拟此类命令的类似 bash 的调用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T12:27:13.900

你将不得不忍受这个。

如果标识符是跨语言处理的（在这种情况下是 bash/Python），如果语言的标识符规则允许不同的东西（在这种情况下，`-`在 bash 中允许但在 Python 中不允许），您将遇到问题。解决此问题的一种方法是名称修改。有时会这样做，例如用允许的字符（例如`xdg-open`用`xdg_open`）替换有问题的字符；为了避免名称冲突（例如，如果`xdg_open`除了 之外已经有一个`xdg-open`），替换通常以某种方式进行转义，例如通过字符的十六进制值（例如`-`by `_2d`，`_`by`_5f`等）。您可能会从包含以下内容的 URL 行中知道这一点`%20`之类的。这一切要么很快变得不可读，要么名称修改的规则非常复杂（有一个权衡）。

# r - 如何创建包含每行之间的平均绝对分数的距离矩阵？

> ID：10707260
> 
> 赞同：7
> 
> 时间：2012-05-22T17:47:58.813
> 
> 标签：r, matrix, distance, vegan, distance-matrix

给定矩阵，

```
df <- read.table(text="
 X1 X2 X3 X4 X5
  1  2  3  2  1
  2  3  4  4  3
  3  4  4  6  2
  4  5  5  5  4
  2  3  3  3  6
  5  6  2  8  4", header=T) 
```

我想创建一个距离矩阵，其中包含每列每行之间的绝对平均差。例如，和之间的距离`X1`应该`X3`是= 1.67，因为：

abs(1 - 3) + abs(2-4) + abs(3-4) + abs(4-5) + abs(2-3) + abs(5-2) = 10 / 6 = 1.67

**我尝试过**以这种方式使用`designdist()`vegan 包中的函数：

```
designdist(t(df), method = "abs(A-B)/6", terms = "minimum") 
```

第 1 列和第 3 列的结果距离为 0.666。这个函数的问题是它把每一列中的所有值相加，然后减去它们。但是我需要将每行之间的绝对差异（单独，绝对）相加，然后将其除以 N。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-22T17:52:42.983

这是一个单行解决方案。它利用`dist()`'s`method`参数来计算data.frame 中每对列之间的[L1 范数，也就是城市街区距离，也就是曼哈顿距离。](http://en.wikipedia.org/wiki/Taxicab_geometry)

```
as.matrix(dist(df, "manhattan", diag=TRUE, upper=TRUE)/nrow(df)) 
```

为了使其可重现：

```
df <- read.table(text="
 X1 X2 X3 X4 X5
  1  2  3  2  1
  2  3  4  4  3
  3  4  4  6  2
  4  5  5  5  4
  2  3  3  3  6
  5  6  2  8  4", header=T)

dmat <- as.matrix(dist(df, "manhattan", diag=TRUE, upper=TRUE)/nrow(df))
print(dmat, digits=3)
#      1     2     3    4     5    6
# 1 0.00 1.167 1.667 2.33 1.333 3.00
# 2 1.17 0.000 0.833 1.17 0.833 2.17
# 3 1.67 0.833 0.000 1.00 1.667 1.67
# 4 2.33 1.167 1.000 0.00 1.667 1.33
# 5 1.33 0.833 1.667 1.67 0.000 2.33
# 6 3.00 2.167 1.667 1.33 2.333 0.00 
```

# sencha-touch - 用于 Haxe FDT5 的 Sencha Touch？

> ID：10707266
> 
> 赞同：2
> 
> 时间：2012-05-22T17:48:10.593
> 
> 标签：sencha-touch, sencha-touch-2, haxe, fdt

我正在尝试从 FDT Haxe 项目链接到 sencha touch 库。根据：

[http://www.haxejs.org/externs/sencha-touch/](http://www.haxejs.org/externs/sencha-touch/)

您所要做的就是从命令行运行：

haxelib 安装 senchatouch

它在这里安装 sencha touch：/usr/lib/haxe/lib/senchatouch/1,10

但我的项目不知道在哪里可以找到它。如何将我的项目链接到它？我还尝试简单地将整个 senchatouch 安装复制到我的项目中，但它当然非常麻烦并且我得到多个编译错误。这样做的正确方法是什么？提前非常感谢......

这是编译器错误的屏幕截图：

![在此处输入图像描述](../Images/ead9e032abf2efd00bfc4e716ff0dd36.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T18:26:46.810

您需要：

1.  将 Haxe SDK 的 $PATH 变量重新映射到 FDT 保存 Haxe SDK 的位置。
2.  将 FDT 指向已安装 Haxelib 的 Haxe SDK。

您还必须将 -lib 参数添加到 compile.hxml

## 重新映射 $PATH

重映射超出了这个问题的范围，但你明白了。

# 使用 FDT 的 GUI

如果使用 FDT 的 GUI，则转到 Preferences>Haxe>Haxe SDK 并将 FDT 指向已安装 Haxelib 的 Haxe SDK。

![在此处输入图像描述](../Images/c9500a7b9ebdfbbe3d177629b82e9d35.png) ![在此处输入图像描述](../Images/b32e04e7e23c2a3ffcdf735df2b63e79.png) ![在此处输入图像描述](../Images/043ed11e854aa4163868ac4c099b7249.png) ![在此处输入图像描述](../Images/9f2f69fc2a8bf174dd240fa39fe778fc.png)

# html - 表情符号 - CSS 背景或内联图像？

> ID：10707267
> 
> 赞同：0
> 
> 时间：2012-05-22T16:18:21.530
> 
> 标签：html, regex

我正在考虑用表情符号（表情符号）替换评论中的用户文本`:)`，例如。`:P`使用正则表达式。您认为替换为带有类的 span 元素是个好主意吗？然后我将笑脸图像应用到那个班级？

或者我应该用`<img>`标签替换那个文本？

CSS 通常不被视为内容的一部分，但这些图像笑脸是……（如果禁用 CSS，文本可能会因为缺少表情符号而改变其含义）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T16:44:41.677

表情符号是使用字符呈现的视觉信息，因此如果您将“:-)”替换为某些内容，则自然候选者是特殊字符，例如“☺”（U+263A WHITE SMILING FACE）和`img`类似的标签`<img alt=":-)" src="smiley.png">`。

使用带有背景图像的元素有几个缺点，包括缺少`alt`属性的任何对应物以及在打印时抑制背景图像的常见浏览器行为。

以编程方式将任何表情符号更改为例如图像有点冒险。您不能确定每个“:-)”都是一个表情符号。特殊领域可能会出现各种奇怪的字符组合。此外，如果用户正在撰写例如*关于*表情符号的内容，则部分内容可能会在替换时丢失或失真。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-10T18:45:34.263

使用 CSS 显示图片。最佳做法是从用户输入中去除不需要的字符、不可见字符和 HTML 标记，以避免 HTML 代码注入和跨站点脚本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-22T16:26:51.490

如果你有很多笑脸，你最好使用 css sprite 技巧，因为这意味着浏览器只需要下载一个图像文件而不是下载十几个较小的文件

这将导致更少的开销和更好的缓存

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-22T16:26:59.107

以纯文本形式显示笑脸，并使用 CSS 显示图片。

您可以通过使用一个`<span>`或另一个元素来实现这一点。

例如，`:)`应该`<span class="normalsmiley">:)</span>`在代码中。

然后文本对于看不到图像或禁用 CSS 的人来说是有意义的（他们会看到一个文本笑脸）。

# clojure - 在 Clojure 中建模/编程欧洲轮盘赌

> ID：10707271
> 
> 赞同：5
> 
> 时间：2012-05-22T17:48:14.380
> 
> 标签：clojure, noir

对于学校，我们正在使用 webnoir 框架在 Clojure 中创建一个轮盘网络应用程序。在 Clojure 中似乎一切都可以实现，但问题是：我们如何在 Clojure 中定义我们域中的板？必须可以下角注等。

如果我们在我们的域中对此进行建模，我们如何将视图信息发送到我们的域/板？

有没有人有想法或建议？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T21:29:40.293

由于定义板的方法有无数种，其中很多都很好，我将避免这个问题并主要解决第二个问题：在板视图和模型之间进行通信。

使用 webnoir 的一种解决方案是让您的看板视图包含执行操作的表单。提交该表单会更新您的电路板模型并重定向到相同的路线，从而产生更新的视图。我相信您一直在浏览 Chris Granger 的出色[文档](http://webnoir.org/tutorials/forms)。

另一种方法，尽管可能超出您的项目范围，是让客户端代码与模型动态通信并更新您的视图，最终结果是单页 web 应用程序。这可以通过[ClojureScript](https://github.com/clojure/clojurescript)完成。如果您正在考虑这一点，请查看 Chris Granger 的库（以前称为[Pinot](https://groups.google.com/forum/#!topic/clj-noir/wsCVajG0-YE/discussion)）。它们为 webnoir 提供了极好的补充。

# php - PHP 多维数组访问

> ID：10707272
> 
> 赞同：-6
> 
> 时间：2012-05-22T17:48:17.687
> 
> 标签：php, arrays, multidimensional-array, key-value

假设我在 PHP 中有一个多维数组，例如：

```
this_array= array(
    string_name=>'string', 
    string_array=>array(
        'string_key'=>'string_val'
    )
) 
```

我如何访问 string_array 的 key-val 对？仅仅是：

```
this_array['string_array']['string_key'] 
```

还是有什么不同？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T18:06:17.197

如果您打算使用字符串作为键，代码应该看起来像这样。

```
$this_array= array(
     'string_name' => 'string', 
    'string_array' => array(
        'string_key' => 'string_val'
    )
); 
```

是的，您将通过以下方式访问它：

```
$this_array['string_array']['string_key']; 
```

# iphone - SQLITE 表不能同时运行

> ID：10707274
> 
> 赞同：1
> 
> 时间：2012-05-22T17:48:34.223
> 
> 标签：iphone, sqlite

我正在修复..请帮帮我..我是IOS开发新手，正在IOS开发购物车应用程序..我的应用程序包含一些功能，例如-显示产品列表，用户可以添加一些，编辑他们的数量在 detailViewController 中，它将在数据库中更新，甚至可以删除它们，最后它给出了购买的产品、成本等的总体摘要。

每个用户都有一个登录名，它将验证用户名、密码并允许用户等。

到目前为止一切都很好。数据库事务是使用 SQLITE 完成的。但是当我试图同时操作用户和产品模块时，只有一个模块的数据库操作有效。即，用户登录或产品操作都可以工作..但不是两者都可以..单独他们工作正常......

但是，如果我尝试通过操作数据库条目登录，添加产品并尝试编辑它们，要么数据库中的用户登录操作将起作用，要么产品操作..我正在修复..

请告诉我为什么我会遇到这个问题，我该如何调试它？预先感谢一百万..请帮助我...谢谢

# php - 是否有基于 API 的方法从 Clickbank 网络获取产品数据？

> ID：10707275
> 
> 赞同：1
> 
> 时间：2012-05-22T17:48:39.773
> 
> 标签：php, api, clickbank

是否有基于 API 的方法从 Clickbank 网络获取产品数据？
我需要通过关键字搜索产品。

从[Clickbank 网站](http://www.clickbank.com/help/account-help/account-tools/clickbank-api/)：

> 支持的 API
> 
> 对于 1.2 版，将支持以下 API：
> 
> 订单 API：[https](https://api.clickbank.com/rest/1.2/orders) : //api.clickbank.com/rest/1.2/orders 订单 API 允许您通过收据或日期/时间参数获取订单信息。
> 
> 运输 API：[https](https://api.clickbank.com/rest/1.2/shipping) ://api.clickbank.com/rest/1.2/shipping运输 API 允许您通过收据或日期/时间参数获取一份或多份实物订单的运输信息。
> 
> 票证 API：[https](https://api.clickbank.com/rest/1.2/tickets) ://api.clickbank.com/rest/1.2/tickets票证 API 允许您通过创建交易票证将订单状态更新为退回或取消。此外，您可以按用户搜索现有票证。
> 
> 沙盒 API：[https](https://sandbox.clickbank.com/rest/1.2/sandbox) ://sandbox.clickbank.com/rest/1.2/sandbox 沙盒 API 提供了创建测试账户、开发者密钥和订单的环境。一旦建立，它就可以用来测试票和订单 API。
> 
> 追加销售 API：[https](https://api.clickbank.com/rest/1.2/upsells) ://api.clickbank.com/rest/1.2/upsells 追加销售 API 允许合格用户通过 API 创建追加销售。
> 
> 发货通知 API： [https](https://api.clickbank.com/rest/1.2/shipping/shipnotice) ://api.clickbank.com/rest/1.2/shipping/shipnotice发货通知 API 是发货 API 的子接口，允许生成发货通知。
> 
> 沙盒产品创建 API： [https](https://sandbox.clickbank.com/rest/1.2/sandbox/product) ://sandbox.clickbank.com/rest/1.2/sandbox/product 沙盒产品创建 API 是沙盒 API 的子类，允许用户在沙盒环境中创建产品。
> 
> Quickstats API：[https](https://api.clickbank.com/rest/1.2/quickstats) ://api.clickbank.com/rest/1.2/quickstats Quickstats API 提供有关用户帐户的统计信息。

这些 API 似乎都不适用于一般市场。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T04:00:11.667

Clickbank Marketplace 以 XML Feed 的形式提供给您：http: [//www.clickbank.com/help/account-help/account-tools/marketplace-feed/](http://www.clickbank.com/help/account-help/account-tools/marketplace-feed/)

# joomla - joomla 2.5 本机模式框下一个和上一个按钮

> ID：10707277
> 
> 赞同：0
> 
> 时间：2012-05-22T17:48:47.513
> 
> 标签：joomla, mootools, modal-dialog

我正在使用 joomla 2.5，并且需要将下一个和上一个按钮添加到 joomla 原生模式行为（media/system/js/modal.js）。

我有多个缩略图，每个都打开一个带有 youtube 播放器的模式框。我喜欢使用模式框内的箭头按钮移动到下一个电影/上一个视频的能力。

有没有人做过这个，或者我应该放手使用插件吗？谢谢...亚尼潘

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T05:10:19.183

好的，所以我只是使用了 JCEMediaBox，它保持相同的语法，您需要将 .modal 类更改为另一个（如定义的那样）并且应该可以正常工作......

# mysql - 地理搜索mysql

> ID：10707278
> 
> 赞同：0
> 
> 时间：2012-05-22T17:48:48.370
> 
> 标签：mysql, search, geo

我一直在关注这个在 MySQL 中进行地理搜索的[示例](http://www.scribd.com/doc/2569355/Geo-Distance-Search-with-MySQL)（非常棒的教程！）。

这就是我想出的：

```
CREATE DEFINER=`root`@`localhost` PROCEDURE `geo_distance`(in _location_id bigint(20), in dist int)
BEGIN
declare mylon double; 
declare mylat double;
declare lon1 float; 
declare lon2 float;
declare lat1 float; 
declare lat2 float;

-- get the original lon and lat for the userid 
select longitude, latitude into mylon, mylat from locations where locations.location_id = _location_id;
-- calculate lon and lat for the rectangle:
set lon1 = mylon - dist / abs(cos(radians(mylat)) * 69);
set lon2 = mylon + dist / abs(cos(radians(mylat)) * 69);
set lat1 = mylat - (dist / 69);
set lat2 = mylat + (dist / 69);

-- run the query:
SELECT destination.*,
3956 * 2 * ASIN(SQRT(POWER(SIN((orig.lat - dest.lat) * pi()/180 / 2), 2) +
COS(orig.lat * pi()/180) * COS(dest.lat * pi()/180) * POWER(SIN((orig.lon -dest.lon) * pi()/180 / 2), 2) )) as distance FROM locations destination, locations origin WHERE origin.location_id=_location_id
and destination.longitude between lon1 and lon2 and destination.latitude between lat1 and lat2 
having distance < dist ORDER BY Distance limit 10;
END 
```

问题是我不知道它是什么`orig.lat`以及他把它带到了哪里，也许我错过了一些东西。你能指出我的错误或建议我在 MySql 中进行地理搜索的好来源吗

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T05:22:37.020

此处正在构建的 SELECT 查询是查找距离某个点很近（在 10 个单位内）的位置 - 我们称之为 x

`orig`是点 x，然后对于数据库中的每条记录，您将与`orig`和`lat`值进行比较，`lon`以查看它是否足够接近以进行加载。

在实践中，假设您正在为用户加载附近的夜总会列表，`orig`很可能由用户输入他们的邮政编码或类似的东西来确定......

如果您仍然感到困惑，请告诉我，我可以尝试提供更多帮助。

# opencl - OpenCL 简单的“Hello World！” 程序编译正确，但执行时吐出垃圾

> ID：10707284
> 
> 赞同：1
> 
> 时间：2012-05-22T17:49:13.787
> 
> 标签：opencl, archlinux

正如标题所示，我已经逐字复制了Fixstar 的在线 OpenCL 书中的`hello.cl`和文件，网址为[http://www.fixstars.com/en/opencl/book/OpenCLProgrammingBook/first-opencl-program.html](http://www.fixstars.com/en/opencl/book/OpenCLProgrammingBook/first-opencl-program.html)，并且无法获得正确的输出.`hello.c`

我使用 `gcc -lOpenCL hello.c -o hello`.

我正常执行 `./hello`.

但我的输出内容类似于����。

我运行 Arch Linux 并安装了 OpenCL、头文件和 NVIDIA 实现。我想继续学习 OpenCL，但如果我的程序无法运行，我就无法继续。有人对正在发生的事情有任何想法吗？此外，如果有人对如何调试有任何建议，我将非常高兴。

编辑：我使用的是 Nouveau 驱动程序而不是 Nvidia 驱动程序。Nouveau 不支持 OpenCL。这就是问题所在。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T14:22:48.143

Nouveau 还不支持 OpenCL。将 nouveau 替换为 nvidia 并检查以确保`libcl`、`libcl-headers`和`opencl-nvidia`都正确安装。

# javascript - 在发生多个过渡时，如何检测“特定”元素上的 CSS 过渡结束？

> ID：10707285
> 
> 赞同：8
> 
> 时间：2012-05-22T17:49:22.790
> 
> 标签：javascript, jquery, jquery-animate, css-transitions

我一直在使用以下方法来检测 CSS3 过渡的结束，如下所示：-

```
 CACHE.previewControlWrap.css({
                'bottom':'-217px'
            }).one('webkitTransitionEnd transitionend msTransitionEnd oTransitionEnd', function () {
                CACHE.songWrap.css({
                    'bottom': '0'
                });
     }); 
```

这完美地工作，发生 CSS 转换，然后当它完成时，另一个发生。

但是，当我将此匿名函数嵌套到第三层时，它不起作用。第三个过渡“结束”事件与第二个同时触发，而不是一个接一个地链接它们（就像 jQuery .animate() 会发生的那样）

我想做的是将“transitionend”事件与**“特定”**元素联系起来。目前它似乎在任何元素上寻找一个 transitionend 事件并相应地触发。如果没有，是否有另一种解决方法，以便我可以在前一个完成后将三个连续的 css 转换事件排队等待所有触发。

提前致谢。

以下是导致问题的代码：-

```
if(Modernizr.csstransitions){

        CACHE.leftcolbottom.css({
            'left':'-230px'
        });
        CACHE.songwrap.css({
            'left':'100%',
            'right': '-100%'
        });
        CACHE.previewControlWrap.css({
            'bottom':'-217px'
        }).one('webkitTransitionEnd transitionend msTransitionEnd oTransitionEnd', function () {
            CACHE.songWrap.css({
                'bottom': '0'
            });
            CACHE.middle.css({
                'bottom': '350px'
            }).one('webkitTransitionEnd transitionend msTransitionEnd oTransitionEnd', function () {
                CACHE.slidewrap.css({
                    'left': '50%',
                    'right': '0%'
                });
                CACHE.leftcoltop.css({
                    'left': '0%'
                });     
            });         
        });

    } 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-22T18:16:12.433

好的，我实际上自己找到了答案，希望这能帮助其他有同样问题的人。

解决方案是使用标准的 jQuery .on() 方法而不是“fire once” .one() 方法。然后检查目标以查看它是否是您将事件绑定到的元素，最后，在同一个匿名函数中删除事件处理程序。

在我的情况下，使“第三个”嵌套转换代码看起来像这样：-

```
}).on('webkitTransitionEnd transitionend msTransitionEnd oTransitionEnd', function (e) {
                if($(e.target).is(this)){
                    CACHE.slidewrap.css({
                        'left': '50%',
                        'right': '0%'
                    });
                    CACHE.leftcoltop.css({
                        'left': '0%'
                    });
                    $(this).off('webkitTransitionEnd transitionend msTransitionEnd oTransitionEnd');
                }
            }); 
```

如果其他人有更优雅的解决方案，请告诉我，我会酌情将答案奖励给您。

# c++ - 如何解决“调用纯虚方法”

> ID：10707286
> 
> 赞同：27
> 
> 时间：2012-05-22T17:49:25.147
> 
> 标签：c++, polymorphism, derived-class, base-class, pure-virtual

我理解为什么会发生这种情况，但我一直试图解决它......这是我的代码在我的程序退出时生成错误（因此导致崩溃）时所做的事情......

`pure virtual method called`

```
SomeClass::~SomeClass()
{
   BaseClassObject->SomePureVirtualMethod(this);
} 
```

* * *

```
void DerivedClass::SomePureVirtualMethod(SomeClass* obj)
{
    //Do stuff to remove obj from a collection
} 
```

我从来没有打电话，`new SomeClass`但我有一个`QList<SomeClass*>`我附加`SomeClass*`对象的电话。这个析构函数的目的`SomeClass`是告诉从它的集合中`DerivedClass`删除一个特定的实例。`SomeClass``QList<SomeClass*>`

所以，在一个具体的例子中......

`BaseClass`=`Shape`

`DerivedClass`=`Triangle`

`SomeClass`=`ShapeProperties`拥有对`Shape`

所以，我从来没有打电话给，`new ShapeProperties`但我有`QList<ShapeProperties*>`一个`Triangle`. 中的析构函数`ShapeProperties`是告诉从它的集合中`Triangle`删除一个特定的属性。`ShapeProperties``QList<ShapeProperties*>`

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2012-05-22T17:51:31.180

当你的析构函数被调用时，继承类的析构函数已经被调用了。在构造函数和析构函数中，可以有效地将对象的动态类型视为与静态类型相同。也就是说，当您从构造函数/析构函数中调用虚拟方法时，调用的不是它们的覆盖版本。

如果`SomePureVirtualMethod`需要在析构函数中调用，那么你必须在你想要的方法的实际定义所在的类的析构函数中调用它。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-05-22T17:54:09.420

当你`virtual`在基类的析构函数中调用方法时，`SomeClass`它会调用基类的method( `SomePureVirtualMethod()`)，`SomeClass`这是一个没有定义的纯虚方法。因此错误。

**为什么会这样？**
in 构造函数或析构函数的类型`this`是其构造函数或析构函数被调用的类型，因此动态调度在构造函数和析构函数中不起作用，因为您期望它在所有其他函数中起作用。

**为什么会崩溃？**
因为从构造函数或析构函数调用纯虚函数是**未定义的行为**。

**C++03 10.4/6 状态**

> “可以从抽象类的构造函数（或析构函数）调用成员函数；直接或间接对从此类构造函数创建（或销毁）的对象进行虚拟调用（10.3）的效​​果（或析构函数）未定义。”

**如何避免？**
只要确保您不从构造函数或析构函数调用纯虚函数即可。
除非您了解所涉及的动态，否则不要`virtual`在构造函数或析构函数中调用方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-07-31T23:04:57.370

发生这种情况的另一个原因取决于您的编译器和系统，那就是来自悬空引用。[Paul SR Chisholm 解释](https://www.artima.com/cppsource/pure_virtual.html)了释放内存的可能状态：

> *   内存可能被标记为已释放。
> *   内存可能被故意打乱。
> *   内存可能会被重用。
> *   记忆可能一直保持原样。
> 
> 最后一个是一个有趣的案例。什么是“原样”的对象？在这种情况下，它是抽象基类的一个实例；当然，这就是 vtbl 留下的方式。如果我们尝试为这样的对象调用纯虚成员函数会发生什么？
> 
> “称为纯虚函数”。

# django - Django & Celery——路由问题

> ID：10707287
> 
> 赞同：8
> 
> 时间：2012-05-22T17:49:25.720
> 
> 标签：django, celery, django-celery, kombu

我正在使用 Django 和 Celery，并且正在尝试设置路由到多个队列。当我指定任务的`routing_key`and `exchange`（在任务装饰器中或使用`apply_async()`）时，该任务不会添加到代理（即 Kombu 连接到我的 MySQL 数据库）。

如果我在任务装饰器中指定队列名称（这意味着路由键被忽略），任务工作正常。这似乎是路由/交换设置的问题。

知道问题可能是什么吗？

这是设置：

**设置.py**

```
INSTALLED_APPS = (
    ...
    'kombu.transport.django',
    'djcelery',
)
BROKER_BACKEND = 'django'
CELERY_DEFAULT_QUEUE = 'default'
CELERY_DEFAULT_EXCHANGE = "tasks"
CELERY_DEFAULT_EXCHANGE_TYPE = "topic"
CELERY_DEFAULT_ROUTING_KEY = "task.default"
CELERY_QUEUES = {
    'default': {
        'binding_key':'task.#',
    },
    'i_tasks': {
        'binding_key':'important_task.#',
    },
} 
```

**任务.py**

```
from celery.task import task

@task(routing_key='important_task.update')
def my_important_task():
    try:
        ...
    except Exception as exc:
        my_important_task.retry(exc=exc) 
```

**启动任务：**

```
from tasks import my_important_task
my_important_task.delay() 
```

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2012-05-25T14:17:11.837

您正在使用 Django ORM 作为代理，这意味着声明仅存储在内存中（请参阅[http://readthedocs.org/docs/kombu/en/latest/introduction.html上的传输比较表，无疑是很难找到的#运输比较](http://readthedocs.org/docs/kombu/en/latest/introduction.html#transport-comparison)）

因此，当您使用 routing_key 应用此任务时`important_task.update`，它将无法路由它，因为它尚未声明队列。

如果您这样做，它将起作用：

```
@task(queue="i_tasks", routing_key="important_tasks.update")
def important_task():
    print("IMPORTANT") 
```

* * *

但是使用自动路由功能会更简单，因为这里没有任何内容表明您需要使用“主题”交换，使用自动路由只需**删除设置**：

*   `CELERY_DEFAULT_QUEUE`,
*   `CELERY_DEFAULT_EXCHANGE`,
*   `CELERY_DEFAULT_EXCHANGE_TYPE`
*   `CELERY_DEFAULT_ROUTING_KEY`
*   `CELERY_QUEUES`

并像这样声明您的任务：

```
@task(queue="important")
def important_task():
    return "IMPORTANT" 
```

然后启动一个从该队列消费的工作人员：

```
$ python manage.py celeryd -l info -Q important 
```

或者从默认 ( `celery`) 队列和`important`队列中消费：

```
$ python manage.py celeryd -l info -Q celery,important 
```

* * *

另一个好的做法是不要将队列名称硬编码到任务中，`CELERY_ROUTES`而是使用：

```
@task
def important_task():
    return "DEFAULT" 
```

然后在您的设置中：

```
CELERY_ROUTES = {"myapp.tasks.important_task": {"queue": "important"}} 
```

* * *

如果您仍然坚持使用主题交换，那么您可以添加此路由器以在第一次发送任务时自动声明所有队列：

```
class PredeclareRouter(object):
    setup = False

    def route_for_task(self, *args, **kwargs):
        if self.setup:
            return
        self.setup = True
        from celery import current_app, VERSION as celery_version
        # will not connect anywhere when using the Django transport
        # because declarations happen in memory.
        with current_app.broker_connection() as conn:
            queues = current_app.amqp.queues
            channel = conn.default_channel
            if celery_version >= (2, 6):
                for queue in queues.itervalues():
                    queue(channel).declare()
            else:
                from kombu.common import entry_to_queue
                for name, opts in queues.iteritems():
                    entry_to_queue(name, **opts)(channel).declare()
CELERY_ROUTES = (PredeclareRouter(), ) 
```

# sql - 从表中选择数据并比较同一表中的列

> ID：10707291
> 
> 赞同：0
> 
> 时间：2012-05-22T17:49:34.587
> 
> 标签：sql, sql-server-2008

我在 SQL Server 2008 中有这个表“保险”

```
insuranceId    StartDate         EndDate         CarID
   1           1-jan-2010        1-Jan-2011       1
   2           2-Jan-2011        2-Jan-2012       1
   3           1-Jan-2012        1-Jan-2012       2 
```

我需要编写查询返回：

汽车连续两次被保险

这个数据库对于保险公司我需要得到有两个连续保险的汽车

换句话说，获取记录中的 Enddate = (startdate + 1) 的汽车的另一条记录中的汽车

对于这张桌子，我需要得到 carId = 1 因为

`EndDate in Firstrecord = 1-Jan-2011 and the StartDate in second record = 2-Jan-2011`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T05:24:05.560

据我了解，这可以满足您的需求：

```
SELECT io.CarID
FROM insurance AS io
WHERE DATEADD(DAY, 1, io.EndDate) IN
    (SELECT ii.StartDate
     FROM insurance AS ii
     WHERE ii.CarID = io.CarID); 
```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-05-22T17:54:27.180

```
SELECT TOP 2 * FROM insurance WHERE insuranceId > 1 ORDER BY insuranceId 
```

其中 1 是您需要的第一辆汽车的 ID。

# sql - 基于 Sysdate 的条件 Where 子句？

> ID：10707296
> 
> 赞同：0
> 
> 时间：2012-05-22T17:49:42.853
> 
> 标签：sql, sql-server, tsql, where-clause

我正在创建一个每月运行两次的查询：

1.  每月 5 日查看账单日 16 日 - 上个月的最后一天。

    ```
    datepart(dd,h.BILLED_DATE) > 15    
    DATEPART(mm, h.billed_date) = DATEPART(mm,dateadd(m,-1,getdate()))
    and DATEPART(yyyy, h.billed_date) = DATEPART(yyyy,dateadd(m,-1,getdate())) 
    ```

2.  每月 20 日查看同月 1-15 日的计费日。

    ```
    datepart(dd,h.BILLED_DATE) >= 1
    and datepart(dd,h.BILLED_DATE) < 16
    and DATEPART(mm, h.BILLED_DATE) = DATEPART(mm,GETDATE())
    and DATEPART(yyyy, h.BILLED_DATE) = DATEPART(yyyy,GETDATE())) 
    ```

这些在 where 子句中独立工作。但是，当我尝试在 where 子句中的 case 语句中组合它们时，我会遇到大量错误，从“then”之后的第一个不等式开始。

```
Where
  Case 
    when datepart(dd,getdate()) > 15 
      then [2 above]
      else [1 above]
  End 
```

治愈我的无知。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T17:52:42.530

CASE 是一个返回单个值的表达式。您不能像在其他一些语言中那样使用它来控制流量。

您的查询也不会在您的 billed_date 列上使用任何索引，您应该考虑添加它以支持此查询。

这个重写怎么样，它使用纯日期时间操作来构建一个开放式范围，而不是执行所有那些昂贵的 datepart 函数：

```
DECLARE @today SMALLDATETIME, @start SMALLDATETIME, @end SMALLDATETIME;
SET @today = DATEADD(DAY, 0, DATEDIFF(DAY, 0, CURRENT_TIMESTAMP));

SET @start = DATEADD(DAY, 1-DAY(@today), @today);
SET @end = DATEADD(DAY, 15, @start);

IF DATEPART(DAY, @today) <= 15
BEGIN
    SET @start = DATEADD(MONTH, -1, @end);
    SET @end = DATEADD(DAY, 1-DAY(@today), @today);
END 

SELECT ... WHERE h.billed_date >= @start AND h.billed_date < @end; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T17:54:22.657

这应该这样做

```
WHERE (
    datepart(dd,getdate()) > 15 
    AND DATEPART(mm, enc.hosp_admsn_time) = DATEPART(mm,dateadd(m,-1,getdate()))
    AND DATEPART(yyyy, enc.hosp_admsn_time) = DATEPART(yyyy,dateadd(m,-1,getdate()))
) OR (
  datepart(dd,h.BILLED_DATE) >= 1
  and datepart(dd,h.BILLED_DATE) < 16
  and DATEPART(mm, h.BILLED_DATE) = DATEPART(mm,GETDATE())
  and DATEPART(yyyy, h.BILLED_DATE) = DATEPART(yyyy,GETDATE()))
) 
```

# jquery - Jquery csspie pie.js 在 IE8 中不起作用？

> ID：10707301
> 
> 赞同：0
> 
> 时间：2012-05-22T17:49:54.190
> 
> 标签：jquery

试图让 IE8 与 csspie 及其 pie.js 文件一起工作。似乎效果不佳。

```
if (window.PIE) {
    $('.jspDrag').each(function() { PIE.attach(this); });
} 
```

它甚至没有开始循环。让我发疯。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-21T16:49:12.017

关于 pie.js 的一切都在这里：http: [//css3pie.com/documentation/pie-js/](http://css3pie.com/documentation/pie-js/)

我只是将它测试到一个项目中，并且效果很好。

一个例子：

```
<!--[if lt IE 9]>
<script type="text/JavaScript" src="/pathToPie/PIE.js"></script>
<script>
  $(document).ready( function() {
    if (window.PIE) {
      $('.myClassToAttach').each(function() {
       PIE.attach(this);
      });
    }
  });
</script>
<![endif]--> 
```

# java - 以 512 个增量从文件中获取字节并通过网络发送这些字节？

> ID：10707302
> 
> 赞同：0
> 
> 时间：2012-05-22T17:50:02.827
> 
> 标签：java, inputstream, datagram

我有以下代码。它在发送第一个数据包的范围内起作用，但是一旦它进入while循环，值就会更改为-1，因此一旦循环完成一次，就不会循环该段代码。我试图一次将 512 字节的数据放入一个数据包中，然后通过网络发送，但由于上述原因，这不起作用。如果有人能指出我做错了什么并可能提出修复建议，我将不胜感激。

```
 InetAddress address = packet.getAddress();
            int port = packet.getPort();
            RRQ RRQ = new RRQ();
            int offset = 0;
            int length = 512;
            int block = 0;
            byte[] readBytes = new byte[512];
            File file = new File(filename);
            FileInputStream is = new FileInputStream(file);
            int fileBytes = is.read(readBytes, offset, length);
            DatagramPacket outPacket = RRQ.doRRQ(readBytes, block, address, port);
            socket.send(outPacket);
            System.out.println("Packet sent");
            System.out.println(fileBytes);

            byte[] outputop = new byte[2];
            outputop = outPacket.getData();
            System.out.println(outputop[0]);
            System.out.println(outputop[1]);
            System.out.println("fileBytes = " + fileBytes);

            block++;
            while (fileBytes != -1){

                socket.receive(packet);
                fileBytes = is.read(readBytes, offset, length);
                System.out.println("fileBytes = " + fileBytes);
                outPacket = RRQ.doRRQ(readBytes, block, address, port);
                outputop = outPacket.getData();
                System.out.println(outputop[0]);
                System.out.println(outputop[1]);
                socket.send(outPacket);
                System.out.println("Packet sent");
                block++;
                System.out.println(fileBytes);

            } 
```

RRQ 类

```
public DatagramPacket doRRQ(byte[] data, int block, InetAddress address, int port){

int bufferOffset = 4;
int dataOffset = 0;
byte byteBlock = (byte)block++;
byte[] buffer = new byte[516];
DatagramPacket packet = new DatagramPacket(buffer, buffer.length, address, port);
buffer[0] = 0;
buffer[1] = 3;
buffer[2] = 0;
buffer[3] = byteBlock;
for(byte item:data){

    buffer[bufferOffset] = data[dataOffset];
    bufferOffset++;
    dataOffset++;

}

return packet; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T18:55:32.260

Well, it looks like your file has only 512 bytes of data, because -1 is returned when end of file is reached, as stated here: http://docs.oracle.com/javase/6/docs/api/java/io/FileInputStream.html#read(byte[], int, int)

# macos - Netbeans 7.1.2 Mac 0S X 下载

> ID：10707306
> 
> 赞同：0
> 
> 时间：2012-05-22T17:50:18.090
> 
> 标签：macos, netbeans, operating-system, java

我正在运行 Mac OS X 10.5.8 并尝试运行 Netbeans 7.1.2。当我运行 Netbeans 时，我收到以下消息：

```
Cannot run on older versions of Java than Java 6 Standard Edition. Please install JAva 6 
Standard Edition or newer or use --jdkhome switch to point to its installation director. 
```

无论如何，我很确定我有 JDK 1.6，因为我已经导航到 /Libary/Java 并找到了一个说 JDK 1.6 的文件。

我尝试从 Oracle (JDK 1.7) 下载最新的 JDK，当我尝试打开安装程序时，我的 mac 说：

```
This Installer is supported only on OS X Lion (10.7.0) 
```

我能做些什么？我的想法不多了？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T18:08:46.340

`netbeans.conf`在文件中设置 JDK 主路径，更多详细信息请参见[此处](http://wiki.netbeans.org/FaqNetbeansConf)。

请参阅部分中的选项*`netbeans_jdkhome`*选项`Editing the Configuration File`

希望能帮助到你

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T18:36:59.587

导航到 /Applications/Utilities/JavaPreferences （或类似的东西），可以在那里设置当前的 jdk。

# ruby-on-rails - Ruby On Rails Active Admin has_many 更改文本以使用不同的列

> ID：10707308
> 
> 赞同：0
> 
> 时间：2012-05-22T17:50:33.680
> 
> 标签：ruby-on-rails, ruby, activeadmin

这类似于我之前的问题[Ruby On Rails Active Admin has_many 更改下拉列表以使用不同的列](https://stackoverflow.com/questions/10705372/ruby-on-rails-active-admin-has-many-changing-dropdown-to-use-a-different-column/10705422#10705422)

我想出了如何重新分配 a`f.inputs`但是在查看项目时我将如何重新分配数据的显示...

例如：

![在此处输入图像描述](../Images/8527af7e0cb52e76942b88025f338bc0.png)

公共 Git 仓库：[https ://github.com/gorelative/TestApp](https://github.com/gorelative/TestApp)

我的代码片段`fillups.rb`

```
ActiveAdmin.register Fillup do
    form do |f|
        f.inputs do
            f.input :car, :collection => Car.all.map{ |car| [car.description, car.id] }
            f.input :comment
            f.input :cost
            f.input :mileage
            f.input :gallons
            f.buttons
        end
    end
end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T18:03:27.370

修改`show`动作

```
ActiveAdmin.register Fillup do
  # ... other stuff

  show do
    attributes_table do
      # add your other rows
      row :id
      row :car do |fillup|
        link_to fillup.car.description, admin_car_path(fillup.car)
      end
    end
  end
end 
```

# php - 验证 URL 的长度、大写字母和某些完整的单词？

> ID：10707313
> 
> 赞同：1
> 
> 时间：2012-05-22T17:50:44.880
> 
> 标签：php, javascript, regex

我有一些代码可以获取某人在注册我的应用程序时选择的 URL 并对其进行检查。但我想添加以下限制。

*   必须至少为 3 个字母
*   没有大写字母
*   没有某些词“管理员、支持等……”

这是我到目前为止所拥有的 - 但它现在只寻找特殊字母：

```
elseif($action == "validate"){

    $option = $_GET["option"];

    $value = $_GET["value"];

    switch($option){

    case "URL":             

$sql = mysql_select_db($value,$connect);
if(preg_match ( "@[^A-Za-z0-9]+@i", $value ) > 0) { $valid = "FALSE";   continue; }

$sql == 1 ?  $valid = "FALSE" : $valid = "TRUE";

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T17:55:16.337

```
if(preg_match("@^[a-z0-9]{3,25}$@", $value ) && (!preg_match("@admin|support|anything else@",$value))) { 
    //Restrict the word length to 25 characters at max, 3 at least.
    //Do some stuff. The $value meets the requirements as set forth
 ...
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T17:55:25.933

```
elseif($action == "validate"){

    $option = $_GET["option"];

    $value = $_GET["value"];

    switch($option){

    case "URL":             

    $sql = mysql_select_db($value,$connect);
    if(preg_match ( "@[^A-Za-z0-9]+@i", $value ) > 0) { $valid = "FALSE";   continue; }
    if(strlen($value) <= 3) { $valid = "FALSE";   continue; } //less than 3 char
    if(strstr($value, 'admin')) { $valid = "FALSE";   continue; }
      //.. the same for your other words

    $sql == 1 ?  $valid = "FALSE" : $valid = "TRUE";

} 
```

# php - 谷歌地图显示问题

> ID：10707315
> 
> 赞同：0
> 
> 时间：2012-05-22T17:51:05.420
> 
> 标签：php, javascript, google-maps

我正在尝试从下面的代码中做两件事：

1.  如果地理编码不成功，请不要显示地图（到目前为止，我只隐藏了错误消息。）
2.  如果成功，则在重新加载地址之前仅加载地址而不是原始 latlng。

您将不得不原谅所有单引号，javascript 在 php echo 下加载。

欢迎任何想法，理想情况下我想在 javascript 中处理它，但如果需要，我不介意一点 php，我希望在网站的几个区域使用它。

```
echo '
<script type="text/javascript">
var geocoder;
var map;
function initialize() {
    geocoder = new google.maps.Geocoder();
    var latlng = new google.maps.LatLng(51.500141,-0.125195);           
    var address = \''.$company.', '.$address_l1.', '.$address_l2.', '.$address_l3.', '.$town.', '.$county.', '.$post_code.', '.$country.'\';                            
    var myOptions = {
        zoom: 16,
        scrollwheel: false,
        navigationControl: false,
        mapTypeControl: false,
        scaleControl: false,
        streetViewControl: false,
        center: latlng,
        mapTypeId: google.maps.MapTypeId.ROADMAP
    }
    map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);
    geocoder.geocode( { \'address\': address}, function(results, status) {
        if (status == google.maps.GeocoderStatus.OK) {
            map.setCenter(results[0].geometry.location);
            var marker = new google.maps.Marker({
                map: map, 
                position: results[0].geometry.location
            });
        } else {
            //alert("Geocode was not successful for the following reason: " + status);
        }
    });
}
</script>           
<div id="map_canvas"></div>
'; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T22:26:37.227

将地图创建移动到地理编码的成功函数中，并使用 document.getElementById('map_canvas').style.display='block' 或 none 在失败时显示/隐藏地图。

# c# - 如何在 ASP.NET、C# 的一个 Gridview 中显示来自一个数据集的两个相关数据表？

> ID：10707316
> 
> 赞同：0
> 
> 时间：2012-05-22T17:51:07.227
> 
> 标签：c#, gridview, datatable, dataset

我有一个包含两个 DataTables 和 Pk_FK 之间关系的数据集。类似于 sql 中的连接：

C#代码如下：

```
ds.Tables.Add(tabelaViagens);
ds.Tables.Add(tabelaViagens_Data);
ds.Relations.Add("Id_viagens", ds.Tables[0].Columns["ID_VIAGEM"], ds.Tables[1].Columns["ID_VIAGEM"]);
gvViagens.DataSource = ds;
gvViagens.DataBind(); 
```

然而，这样 Gridview 只显示 tabelaViagens 的内容。

知道如何让它显示两个表（像连接一样相关）吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T17:55:45.643

检查这一点 [在多个数据表中的 GridView 中显示数据集数据](http://social.msdn.microsoft.com/Forums/en-US/adodotnetdataset/thread/f63f612f-20be-4bad-a91c-474396941800)

# javascript - 如何从外部 XML 文件中检索数据并将其放入 HTML 文件中？

> ID：10707317
> 
> 赞同：0
> 
> 时间：2012-05-22T17:51:08.747
> 
> 标签：javascript, xml, external

我正在尝试从不在我网站服务器上的 XML 文件中检索数据，然后将这些数据用于各种事物，例如图表。这是一个例子： http://forecast.weather.gov/MapClick.php?lat=40.78158&lon=-73.96648& [FcstType=dwml](http://forecast.weather.gov/MapClick.php?lat=40.78158&lon=-73.96648&FcstType=dwml)。这是一个包含中央公园天气数据的 XML 文件。我想检索标签中的数据，`<value>`标签中的数据`<pressure>`，所以我可以创建一个带有气压的图表。我更喜欢用 JavaScript 来做这件事，但是当文件不在我的服务器上时，我认为不可能这样做。

注意：我*不想*要从其他地方检索压力数据的不同解决方案，因为我也想从其他 XML 文件中检索其他数据。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T18:30:47.683

如果您的 javascript 代码位于服务器（而不是移动设备）上，请让 PHP 代码加载 xml，对其进行转义并将其插入 HTML 页面。然后你只需要在你的代码中获取它并使用 DOMParser 处理它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T23:07:18.560

有一篇关于使用 Yahoo!的[有趣文章。](http://www.ibm.com/developerworks/xml/library/x-xmlajaxpt3/index.html)将 Xml 天气数据转换为 JSON 并在网页中使用结果的管道，无需任何服务器端的东西（PHP、curl 等）。

*编辑*

作为 jQuery 的新手，我不得不进一步挖掘以发现（几乎）第一篇文章中描述的所有内容都可以浓缩为

```
$.getJSON("<your Yahoo pipes url here>&_callback=?", function (data) {
    alert(data.value.items[0].data[0].parameters.wordedForecast.text[0]);
}); 
```

使用 jQuerys 内置**JSONP**。

**陷阱！**

请注意，Yahoo 希望将`callback`url 参数命名为**_callback**

[关于使用 JSONP 进行跨域通信的](http://www.ibm.com/developerworks/library/wa-aj-jsonp1/)很好的总结，这对提出这个答案很有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-22T18:37:29.990

您可以使用 curl 将数据拉到您的服务器并从那里对其进行操作。

```
curl -o data.txt "http://forecast.weather.gov/MapClick.php?lat=40.78158&lon=-73.96648&FcstType=dwml" 
```

这将为您提供名为 data.txt 的文件中的信息。然后，您可以在服务器端解析它，然后只提供所需的数据位，或者将整个文件提供给您的客户端，因为它们现在都在同一个域中。

# python - 如何在 igraph 中提取某些路径类型？

> ID：10707318
> 
> 赞同：4
> 
> 时间：2012-05-22T17:51:10.117
> 
> 标签：python, r, graph, igraph, sna

**TLDR：我想提取 igraph 中两个顶点之间的每条路径的边缘类型。有没有相对健全的方法来做到这一点？**

* * *

我工作的诊所最近在一所高中进行了一项相当大的（1400 人）肺结核接触者调查。我有所有学生和老师的课程表（！）并将它们放入一个网络（使用 R 中的 igraph），每个学生和每个房间周期组合作为一个顶点（例如，123 房间的班级在周期1 是一个顶点，其边指向第 2 期房间 123 中的类）。我也知道哪些房间共用通风系统——这是一种看似合理但不太可能的感染机制。该图是从唯一的源案例中导出的，因此网络上的每条路径中只有两个人——源和联系人，由可变数量的房间周期顶点分隔。从概念上讲，有四种路径：

*   个人接触曝光（来源 -> 仅限联系人）
*   共享类暴露（来源 -> 房间期间 -> 联系人）
*   下一期风险敞口（来源-> Room 123 Period 1 -> Room 123 Period 2 -> 联系方式）
*   通风暴露（来源 -> Room 123 Period 1 -> Room 125 Period 1 -> 接触）

每个边缘都有一个属性，指示它是人与人之间的暴露、同室不同时期还是通风边缘。

作为在该网络上对感染进行建模的中间步骤，我想简单地计算一下学生每种类型的暴露次数。例如，一个学生可能与源共享一个班级，然后在一段时间后进入了源曾所在的房间，并且可能在第二天进入了通风相邻的房间。该学生的指标将是：

```
personal.contact: 0
shared.class:     1
next.period:      1
vent:             1 
```

不过，我不确定如何最好地获取此类信息 - 我看到了获取*最短*路径的功能，这使得识别个人联系链接变得容易，但我认为我需要评估*所有路径*（这似乎是一个疯狂的问题在一个典型的社交网络上，但当只有源和房间周期有外缘时并不那么疯狂）。如果我能达到每个源到接触路径都由边缘类型的有序向量表示的地步，我想我可以轻松地将它们子集到我的标准中。我只是不知道怎么去那里。如果 igraph 不适合这个框架，我只需要在学生的日程安排上写一些可怕的大循环，就这样吧！但在我深入那个洞之前，我会很感激一些指导。

* * *

这是与三个间接路径中的每一个的接触的示例图：

```
# Strings ain't factors
options(stringsAsFactors = FALSE)  
library(igraph)

# Create a sample case
edgelist <- data.frame(out.id = c("source", "source", 
                                  "source", "Rm 123 Period 1", 
                                  "Rm 125 Period 2", "Rm 125 Period 3", 
                                  "Rm 127 Period 4", "Rm 129 Period 4"),
                       in.id = c("Rm 123 Period 1", "Rm 125 Period 2", 
                                 "Rm 127 Period 4", "contact", 
                                 "Rm 125 Period 3", "contact", 
                                 "Rm 129 Period 4", "contact"),
                       edge.type = c("Source in class", "Source in class",
                                     "Source in class", "Student in class",
                                     "Class-to-class", 
                                     "Student in class", "Vent link",
                                     "Student in class"
                                     )
)

samp.graph <- graph.data.frame(edgelist, directed = TRUE)

# Label the vertices with meaningful names
V(samp.graph)$label <- V(samp.graph)$name

plot(samp.graph, layout = layout.fruchterman.reingold) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T07:18:19.733

我不完全确定我了解您的图形模型，但如果问题是：

```
I have two vertices and I wish to extract every path between them,
then extract the edge attributes of those edges. 
```

那么也许这可能会奏效。

进行广度优先搜索。Igraph 包含一个，但它很容易推出您自己的，这将使您更灵活地了解您想要获取的信息。我假设您的图表中没有循环 - 否则您将获得无限数量的路径。我不太了解 Python（尽管我确实在 R 中使用了 igraph），所以这里有一些伪代码。

```
list <- empty

allSimplePaths(u, v, thisPath)
  if (u == v) return
  for (n in neighborhood(u))
    if (n in thisPath)
      next
    if (u == v)
      list <- list + (thisPath + v)
  for (n in neighborhood(u))
    thisPath <- thisPath + n
    allSimplePaths(n, v, thisPath)
    thisPath <- thisPath - thisPath.end 
```

基本上它说“从每个顶点，尝试所有可能的扩展路径以到达终点。” 添加另一个 thisPathEdges 并插入边，将其传递给函数以及顶点是一件简单的事情。当然，如果它不是递归的，它会运行得更好。小心，因为这个算法可能会用足够多的节点来破坏你的堆栈。

您可能仍然想使用@PaulG 的模型，并且在学生节点之间只有多个边。您可以做一些很酷的事情，例如运行广度优先搜索以查看疾病如何传播或找到最小生成树以获得时间估计，或找到最小切割来隔离正在进行的感染或其他东西。

# regex - sed 删除行尾的数字

> ID：10707320
> 
> 赞同：2
> 
> 时间：2012-05-22T17:51:11.723
> 
> 标签：regex, linux, sed

我需要了解如何使用 sed 删除文本文件中行尾*最多10 位数字。*

例如，如果我有这个：

```
ajsdlfkjasldf1234567890
asdlkjfalskdjf123456
adsf;lkjasldfkjas123 
```

它应该变成：

```
ajsdlfkjasldf
asdlkjfalskdjf
adsf;lkjasldfkjas 
```

谁能帮忙？

我有这个，但它不起作用：

```
sed 's/[0-9]{10}$//g' 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-22T17:55:12.507

你有没有试过这个：

```
 sed 's/[0-9]+$//' 
```

您的命令只会匹配并删除行尾的 10 位数字，并且仅在启用扩展正则表达式（-E 或 -r，取决于您的 sed 版本）的情况下。

你应该试试

```
 sed -r 's/[0-9]{1,10}$//' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T17:58:00.567

以下应该有效：

```
sed 's/[0-9]\{1,10\}$//' file 
```

中的正则表达式语法`sed`要求括号前的反斜杠用于重复，除非您使用扩展的正则表达式选项。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-22T17:54:30.013

[在这里](http://www.regular-expressions.info/reference.html)快速浏览一下建议你应该试试这个：

```
$ sed 's/[0-9]\{0,10\}$//g' 
```

{ } 应该被转义，除非你切换到扩展的正则表达式语法：

```
$ sed -r 's/[0-9]{0,10}$//g' 
```

# .net - 并行运行私有强命名程序集

> ID：10707321
> 
> 赞同：2
> 
> 时间：2012-05-22T17:51:15.910
> 
> 标签：.net, reflection, assemblies, .net-assembly, side-by-side

我有一个取决于版本的应用程序`1.0`（`Assembly A`它在文件夹中被强烈命名和私有部署`bin`）。`Assembly B`该应用程序还通过反射加载。复杂之处在于`Assembly B`取决于 的版本`2.0`，`Assembly A`它也是强命名的并且可以私有部署。

`2.0`现在我可以将 CLR 配置为在请求时加载`1.0`，因此只需部署 version `2.0`。但是，这意味着稍后当`Assembly B`更新依赖于另一个版本时`Assembly A`，我必须重新配置重定向。因此，我希望`Assembly A`在我的应用程序中同时运行这两个版本。

有没有办法做到这一点？

# git - 在网络上设置 Git 并复制到网站

> ID：10707323
> 
> 赞同：3
> 
> 时间：2012-05-22T17:51:30.173
> 
> 标签：git

我是一个 Git 新手，并且有一个关于我应该如何在我们的环境限制内设置它的问题，希望有人能帮助我，让我知道我的想法是否正确。

我们的 IT 部门不希望在我们的 Staging Server 上安装 Git，因此我们认为我们必须使用网络驱动器。计划是这样的：

*   网络上的 Git 存储库
*   本地主机开发机器从网络存储库中拉取，进行更改，推回存储库
*   手动从存储库复制到登台 Web 服务器（您是导出版本还是直接复制内容？）
*   IT 进行安全测试并将更改复制到生产 Web 服务器（我们无权访问生产服务器）

这看起来是个好计划吗？这是使用 Git 的好方法吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T03:52:31.280

这绝对是使用 git**的好方法。**我会非常推荐它。完全使用修订控制是在开发好的代码时保持理智的一个非常关键的关键，这就是它进入[Joel Test](http://www.joelonsoftware.com/articles/fog0000000043.html)的方式。如果开发人员可以控制他们开发周期的一切，那也是有利的，因为这样就没有开发瓶颈。此外，IT 能够在自己的系统上保持自主权听起来也是一个好主意。所以这可能是一个双赢的局面。

我会标记（使用一些任意修订号系统）您复制到暂存环境的每个修订版 - 或者可能不是字面上您复制的每个修订版，但是过度标记没有害处，而且会非常不幸的是，如果您标记不足并且之后无法恢复到其他版本。

为了将文件复制到登台服务器，我会研究像[rsync](http://en.wikipedia.org/wiki/Rsync)这样的工具。这将使复制更改比重新启动整个副本更直接。在网络驱动器上，`git checkout`您将要复制到暂存的确切版本，然后执行您所做的任何测试，然后告诉 rsync 同步两台计算机（如果使用它，您将必须弄清楚 rsync）。所以，是的，您将直接从网络服务器复制文件。

此外，考虑让一些文件本身标记修订号（包括 git SHA-1 哈希）的想法，以便当文件被复制到登台服务器时，您将确切知道那里的版本。

最后，这里是关于 git 分支的更多信息的另一个链接，它可能会或可能不会帮助您：[一个成功的 git 分支模型](http://nvie.com/posts/a-successful-git-branching-model/)

--

如果您有任何意见/问题，请在下面发表任何意见。

# c++ - WinInet - 如何在 301 重定向后获取服务器 URL？

> ID：10707325
> 
> 赞同：2
> 
> 时间：2012-05-22T17:51:37.517
> 
> 标签：c++, url, redirect, wininet

我正在使用 C++ 中的 WinInet 函数进行编程，但遇到了一个问题。

`HttpOpenRequest()`我的程序使用, `HttpSendRequest()`, `InternetReadFile()`... 函数打开一个 URL并保存输出数据。我需要将 URL 与输出数据一起保存，但在某些情况下，服务器会给我`301 Moved`并`InternetReadFile()`从新地址读取文件。

没关系，但我需要找出它是什么地址。我尝试使用`HttpQueryInfo`with`HTTP_QUERY_RAW_HEADERS_CRLF`但我没有获得此信息，只有`Content-Type`, `Cache-Control`,`Cookies`等。当我使用`HTTP_QUERY_CONTENT_LOCATION`或类似的东西时，我得到`ERROR_HTTP_HEADER_NOT_FOUND`.

你能帮助我吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-22T19:21:25.860

WinInet 收到重定向响应后，默认情况下会自动向新 URL 发送新的 HTTP 请求。当 WinInet 准备好让您开始读取文件数据时`InternetReadFile()`，此时可用的标头属于最后请求的 URL，这可能与您最初请求的 URL 不同。这就是为什么您看不到`Location`标题的原因。要处理重定向响应的标头，您必须`INTERNET_FLAG_NO_AUTO_REDIRECT`在调用时指定标志`HttpOpenRequest()`，然后您可以使用`HttpQueryInfo()`检测重定向状态代码并读取其`Location`标头，然后再调用`HttpSendRequest()`以请求重定向到的新 URL。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-08-25T21:14:36.037

当在 wininet 中自动发生重定向时，您可以使用`InternetStatusCallback`函数获取重定向 url。代码`INTERNET_STATUS_REDIRECT (110)`将为回调函数提供一个带有新 URL 的缓冲区。您可以`InternetSetStatusCallback()`在`HINTERNET`句柄上使用来为请求设置回调函数。

# android - 应用程序不兼容 - 但仅适用于 Android < 4.x 的三星 Galaxy S2

> ID：10707326
> 
> 赞同：1
> 
> 时间：2012-05-22T17:51:39.820
> 
> 标签：android, compatibility

自 Google Play 以来，我在应用兼容性方面遇到了一个非常奇怪的问题。

有几个用户拥有 Android 版本 < 4.x 的三星 Galaxy S2，他们再也无法在 Google Play 中看到我的应用程序。

在 Google 市场上，它与 Android 4.x 和 Google Play 一样运行良好。

即使在谷歌发布的应用程序的兼容性列表中，它也表示这些三星 Galaxy i9100 是兼容的。但仍有部分用户无法在其 Galaxy I9100 手机上找到该应用程序。

在 PC 上搜索该应用程序出现，但据说它与三星 Galaxy S2 手机不兼容。

在我的清单中，我有：

```
 <uses-sdk
    android:minSdkVersion="7"
    android:targetSdkVersion="7" />

<supports-screens
    android:anyDensity="true"
    android:largeScreens="true"
    android:normalScreens="true"
    android:smallScreens="true" />

<uses-permission android:name="android.permission.CALL_PHONE" />
<uses-permission android:name="android.permission.SEND_SMS" />
<uses-permission android:name="android.permission.READ_PHONE_STATE" />
<uses-permission android:name="com.android.vending.CHECK_LICENSE" /> 
```

该应用程序还使用标准许可方法。

似乎有更多 - 一些非常流行的应用程序 - 有同样的问题。

**任何人都为开发人员找到了解决方案，即我必须如何处理我的应用程序才能使其变得可见和兼容？**

我也尝试过 SDK 9 及更高版本，但没有帮助。

（与需要对手机进行任何操作的解决方案相反）

# gsm - 从调制解调器清除 PDP 上下文 (Ericsson F3307)

> ID：10707332
> 
> 赞同：2
> 
> 时间：2012-05-22T17:51:55.833
> 
> 标签：gsm, modem, 3g, at-command, gprs

我有一台内置 Ericsson F3307 调制解调器的 Acer 平板电脑。

我编写了一些需要调制解调器拨号连接的软件。此连接中包括设置 PDP 上下文。

我通过发出命令来做到这一点

```
AT+CGDCONT=1,"IP","apnname" 
```

在玩这个命令时，我还设置了上下文“2”，这让我定义了两个 PDP 上下文，所以当我输入

```
AT+CGDCONT? 
```

它返回

```
AT+CGDCONT?
+CGDCONT: 1,"IP","apnname","0.0.0.0",0,0
+CGDCONT: 2,"IP","mytest","0.0.0.0",0,0 
```

我试过发出命令

```
AT+CGDCONT=2 
```

要删除条目 2，但它只是将其空白.. 它不会从该列表中删除它。

```
+CGDCONT: 1,"IP","apnname","0.0.0.0",0,0
+CGDCONT: 2,"IP","","0.0.0.0",0,0 
```

有谁知道是否有办法删除这些条目，或者在调制解调器上进行硬重置以使其忘记这些设置？

谢谢，

富有的

# iphone - 保持客户端和服务器上的数据模型同步？

> ID：10707337
> 
> 赞同：0
> 
> 时间：2012-05-22T17:52:16.497
> 
> 标签：iphone, ruby-on-rails, database-design

这是一个关于应用程序架构的问题。我正在开发 iOS 客户端应用程序和（RoR）服务器后端。似乎我花费了不必要的精力在 RoR 服务器上创建数据模型，将该模型作为 JSON 服务（这部分在 Ruby 中很容易），创建 Objective-C 数据对象，并为所述编写 JSON/NSDictionary 序列化器/反序列化器班级。

似乎我应该能够编写一个数据模式（在 ruby​​、yaml、json 等中），并免费获得 ruby​​ 对象、obj-c 对象和 json 序列化/反序列化。有人对这个问题有任何想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T02:47:55.710

查看可用的不同库。最有效的是 RestKit。[http://restkit.org/](http://restkit.org/)

RestKit 允许您轻松地将 JSON API 转换为在客户端上同步的 coredata 对象。您可以告诉它要更新哪些对象以及如何更新。

# javascript - jQuery 选择器，用于查找与选择器匹配的给定元素之后的第一个元素

> ID：10707340
> 
> 赞同：12
> 
> 时间：2012-05-22T17:52:39.317
> 
> 标签：javascript, jquery, html

假设我有这个 HTML：

```
 <textarea>blah</textarea>
 <br>
 <div class="select_this">hello!</div> 
```

当我已经识别了 textarea 时，如何选择具有“select_this”类的 DIV？我不想在整个文档上使用类选择器，因为我正在处理大型文档，并且在旧浏览器中类查找速度很慢。

jQuery .next() 似乎没有解决问题，closest() 只查找 DOM 树，而 .nextUntil() 符合我需要的所有内容，除了“select_this”div。还有其他选择吗？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-05-22T17:57:31.943

有两种方法可以做到这一点。

如果您只有几个兄弟姐妹，请使用此选项：

```
$('textarea').nextAll('div.select_this').first(); 
```

这样做的缺点是它会测试每个后续元素以查看它是否与选择器匹配，即使在找到第一个元素之后也是如此。如果您有*很多*兄弟姐妹，请使用它以节省评估：

```
$('textarea').nextUntil('div.select_this').andSelf().last().next(); 
```

另请注意，最好使用[`first`](http://api.jquery.org/first)and[`last`](http://api.jquery.com/last)方法，而不是它们对应的选择器 ( [`:first`](http://api.jquery.com/first-selector), [`:last`](http://api.jquery.com/last-selector))，因为浏览器本身并不理解选择器，这会大大降低表达式的速度。

*编辑以合并`andSelf`下面的每条评论。*

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-22T17:54:23.157

你想要[`nextAll`](http://api.jquery.com/nextAll/)：

```
jQuery(yourTextarea).nextAll('.select_this:first'); 
```

# entity-framework - 如何阻止重复插入

> ID：10707341
> 
> 赞同：1
> 
> 时间：2012-05-22T17:52:41.090
> 
> 标签：entity-framework

我有这个代码：

```
var newProduct = new Product(); 
newProduct.Name = "product name";
newProduct.Description = "product descvription";

ProductImpl.Insert(newProduct);

var ingredient1 = new Ingredient { Description = "ingredient 1" };
var ingredient2 = new Ingredient { Description = "ingredient 2" };
var ingredient3 = new Ingredient { Description = "ingredient 3" };

IngredientImpl.Insert(ingredient1);
IngredientImpl.Insert(ingredient2);
IngredientImpl.Insert(ingredient3);

newProduct.Ingredients.Add(ingredient1);
newProduct.Ingredients.Add(ingredient2);
newProduct.Ingredients.Add(ingredient3);

ProductImpl.Update(newProduct); 
```

当我写 newProduct.Ingredient.Add 它不会向成分表中添加新成分时，我该怎么办？因为当我这样做时，我的配料表将有六个。

* * *

成分Impl.Insert：

```
public void Insert(Ingredient ingredient)
{
    Validate(ingredient);

    _repository.Insert(ingredient);
} 
```

存储库：

```
public void Insert(Ingredient ingredient)
{
    db.Ingredient.Add(ingredient);

    db.SaveChanges();
} 
```

产品说明：

```
public void Update(Product produto)
{
    Validate(produto);

    _repository.Update(produto);
} 
```

存储库：

```
public void Update(Product product)
{
    db.Entry(product).State = EntityState.Modified;

    SaveChanges();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T20:42:22.530

看到您以前的一些问题，您似乎正在为如何构建数据访问逻辑而苦苦挣扎。`Ingredient`显然，您已经为和选择了单独的存储库`Product`。我假设两者都有自己的背景。

如果您想坚持这种严格的分离（这可能是完全理智的），您必须首先使用成分存储库插入成分。之后，您可以将它们附加到产品存储库中的上下文，将它们添加到`newProduct.Ingredients`并保存。

Note that you'll have two transactions. That may be OK if you decide that ingredients can have a life of their own and, thus, new ingredients can be inserted, irrespective of a subsequent failure of the product insertion.

# facelets - 为什么我的 Facelets 复合组件中 commandButton 的操作中的“cc”为空？

> ID：10707345
> 
> 赞同：1
> 
> 时间：2012-05-22T17:52:52.040
> 
> 标签：facelets, composite-component

我有一个 Facelets Composite 组件，其中包括一个命令按钮：

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html>
<ui:component xmlns="http://www.w3.org/1999/xhtml" 
          xmlns:h="http://java.sun.com/jsf/html"
          xmlns:ui="http://java.sun.com/jsf/facelets"
          xmlns:cc="http://java.sun.com/jsf/composite" 
          xmlns:ice="http://www.icesoft.com/icefaces/component"
          xmlns:nc="http://compositecomps.sss.evla.nrao.edu/jsf"
          xmlns:opt="http://java.sun.com/jsf/composite/components/opt"
          xmlns:undo="http://undo.sss.evla.nrao.edu/jsf"
          xmlns:n="http://sss.evla.nrao.edu/jsf"
          xmlns:f="http://java.sun.com/jsf/core">
<cc:interface>
  <cc:attribute name="value" type="edu.nrao.sss.tools.obsprep.bulkedit.BulkEditor"                      required="true"/>
  <cc:attribute name="loop"  type="edu.nrao.sss.tools.obsprep.uiactions.project.scan.ScanLoopUIActions" required="true"/>
</cc:interface>

<cc:implementation>
  <ui:param name="loop" value="#{cc.attrs.loop}"/>
  <ui:param name="val"  value="#{cc.attrs.value}"/>

  <ice:panelGroup id="wizStep1"
                  rendered="#{val.readyToSelect}">
    <nc:header value="select fields to filter on"/>
    <ice:commandButton value="#{val.nameField.value}" action="#{val.select}"/>
    <table cellpadding="5">
      <thead>
        <tr>
          <th></th><th>Field</th><th>Search For</th><th></th>
        </tr>
      </thead>
      <tbody>
        <opt:bulkEditField value="#{val.nameField}">
          <f:facet name="summary">
            <ice:inputText value="#{val.nameField.value}"/>
          </f:facet>
        </opt:bulkEditField>
      </tbody>
    </table>
    <ice:commandButton value="Select" action="#{val.select}"/>
  </ice:panelGroup>
</cc:implementation>
</ui:component> 
```

我已更改代码以`val.nameField.value`用作第一个命令按钮的标签来演示问题。

当我在页面中使用此组件时，它会呈现按钮及其下方的可搜索字段列表。如果我更改名称字段的值，按钮标签会更改。

但是，如果单击该按钮，则会出现目标无法访问的异​​常：

```
Caused by: javax.el.PropertyNotFoundException: /resources/components /opt/bulkEdit.xhtml @25,79 action="#{val.select}": Target Unreachable, identifier 'val' resolved to null 
```

我觉得我一定错过了这些复合组件如何工作的基础知识。这在 facelets/JSF 1.2 下作为标记文件工作得很好。在升级到 JSF 2.0 的过程中，我想继续使用复合组件，这样我就可以有一个定义好的接口。

如果我停止使用`<ui:param/>`并`cc.attrs.value`直接放入，它告诉我它`cc`是空的。

我认为这可能是 icefaces 中的一个错误，但切换到 plain`<h:commandButton/>`会做同样的事情。

感谢您提供的任何建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T17:13:31.940

这是 ICEfaces 2.0 中的一个错误。您有一个包含复合组件的 UISeries（panelTabSet 或 dataTable）。请参阅[http://jira.icesoft.org/browse/ICE-7142](http://jira.icesoft.org/browse/ICE-7142)。它已在 3.0 中修复。

# ruby-on-rails-3 - 部署 Ruby on Rails 网站

> ID：10707347
> 
> 赞同：0
> 
> 时间：2012-05-22T17:52:55.123
> 
> 标签：ruby-on-rails-3, deployment

我想在 Rails 网站上部署我的 ruby​​。我使用的是 rails 3.2 和 ruby​​ 1.9.3，所以有资产管道功能。我想知道谁提供最完整的托管包（或者最简单，因为我是 Rails 新手）。我不介意支付包裹或尝试免费包裹，只要它的白痴证明:)。

任何有用的建议，因为我想为客户上传这个

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T17:57:17.137

[Heroku](http://www.heroku.com/)几乎是当今部署 Rails 应用程序的标准，如果您愿意付费的话。

如果可能，我个人建议部署在您自己的服务器中。它更加通用，而且一点也不难。您还可以使用我强烈推荐的 capistrano 之类的工具来提高该过程的效率。

# ruby - 找不到关联时，Rails（ruby）创建空数组

> ID：10707349
> 
> 赞同：0
> 
> 时间：2012-05-22T17:53:01.340
> 
> 标签：ruby, arrays, activerecord, ruby-on-rails-3.1, simple-form

所以我有这段代码：

```
= f.input :aspectRatioId, :label => 'Aspect Ratio', 
:input_html => { :id => 'dvd_aspectRatio_tokens', :data => { :load => [@dvd.aspectRatio] } } 
```

当在关联中找不到任何内容时，我想创建一个空数组。现在，当没有找到任何东西时，它会返回`[null]`它会导致预期的 tokeninoput javascript`[]`

我可以通过创建另一个这样的方法来做到这一点：

```
def self.series_without_empty_values(dvd)
  series = [dvd.dvd_series]
  if series[0].nil?
    series = []
  end
  return series
end 
```

但我宁愿在`:load =>`表格上的电话中这样做。这甚至可能吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-22T18:15:59.737

用于`Array.compact`删除`nil`数组中的值：

```
[ "a", nil, "b", nil, "c", nil ].compact
=> [ "a", "b", "c" ]

[nil].compact
=> [] 
```

# algorithm - 面试题：合并两个已排序的单链表而不创建新节点

> ID：10707352
> 
> 赞同：85
> 
> 时间：2012-05-22T17:53:16.000
> 
> 标签：algorithm, singly-linked-list

这是在面试笔试期间提出的编程问题。“你有两个已经排序的单链表，你必须合并它们并返回新列表的头部而不创建任何新的额外节点。返回的列表也应该排序”

方法签名为：Node MergeLists(Node list1, Node list2);

节点类如下：

```
class Node{
    int data;
    Node next;
} 
```

我尝试了许多解决方案，但没有创建额外的节点螺丝钉。请帮忙。

这是随附的博客条目[http://techieme.in/merging-two-sorted-singly-linked-list/](http://techieme.in/merging-two-sorted-singly-linked-list/)

* * *

## 回答 #1

> 赞同：191
> 
> 时间：2012-05-22T18:03:20.643

```
Node MergeLists(Node list1, Node list2) {
  if (list1 == null) return list2;
  if (list2 == null) return list1;

  if (list1.data < list2.data) {
    list1.next = MergeLists(list1.next, list2);
    return list1;
  } else {
    list2.next = MergeLists(list2.next, list1);
    return list2;
  }
} 
```

* * *

## 回答 #2

> 赞同：115
> 
> 时间：2012-05-22T18:35:15.137

不需要递归来避免分配新节点：

```
Node MergeLists(Node list1, Node list2) {
  if (list1 == null) return list2;
  if (list2 == null) return list1;

  Node head;
  if (list1.data < list2.data) {
    head = list1;
  } else {
    head = list2;
    list2 = list1;
    list1 = head;
  }
  while(list1.next != null) {
    if (list1.next.data > list2.data) {
      Node tmp = list1.next;
      list1.next = list2;
      list2 = tmp;
    }
    list1 = list1.next;
  } 
  list1.next = list2;
  return head;
} 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2012-12-14T21:07:41.007

```
Node MergeLists(Node node1, Node node2)
{
   if(node1 == null)
      return node2;
   else (node2 == null)
      return node1;

   Node head;
   if(node1.data < node2.data)
   {
      head = node1;
      node1 = node1.next;
   else
   {
      head = node2;
      node2 = node2.next;
   }

   Node current = head;
   while((node1 != null) ||( node2 != null))
   {
      if (node1 == null) {
         current.next = node2;
         return head;
      }
      else if (node2 == null) {
         current.next = node1;
         return head;
      }

      if (node1.data < node2.data)
      {
          current.next = node1;
          current = current.next;

          node1 = node1.next;
      }
      else
      {
          current.next = node2;
          current = current.next;

          node2 = node2.next;
      }
   }
   current.next = NULL // needed to complete the tail of the merged list
   return head;

} 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-05-23T21:54:11.823

看，没有递归！

```
struct llist * llist_merge(struct llist *one, struct llist *two, int (*cmp)(struct llist *l, struct llist *r) )
{
struct llist *result, **tail;

for (result=NULL, tail = &result; one && two; tail = &(*tail)->next ) {
        if (cmp(one,two) <=0) { *tail = one; one=one->next; }
        else { *tail = two; two=two->next; }
        }
*tail = one ? one: two;
return result;
} 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-05-23T05:09:27.117

这是关于如何合并两个排序链表 A 和 B 的算法：

```
while A not empty or B not empty:
   if first element of A < first element of B:
      remove first element from A
      insert element into C
   end if
   else:
      remove first element from B
      insert element into C
end while 
```

这里 C 将是输出列表。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-07-24T18:33:26.820

迭代可以如下进行。复杂度 = O(n)

```
public static LLNode mergeSortedListIteration(LLNode nodeA, LLNode nodeB) {
    LLNode mergedNode ;
    LLNode tempNode ;      

    if (nodeA == null) {
        return nodeB;
      } 
      if (nodeB == null) {
        return nodeA;
      }     

    if ( nodeA.getData() < nodeB.getData())
    {
        mergedNode = nodeA;
        nodeA = nodeA.getNext();
    }
    else
    {
        mergedNode = nodeB;
        nodeB = nodeB.getNext();
    }

    tempNode = mergedNode; 

    while (nodeA != null && nodeB != null)
    {           

        if ( nodeA.getData() < nodeB.getData())
        {               
            mergedNode.setNext(nodeA);
            nodeA = nodeA.getNext();
        }
        else
        {
            mergedNode.setNext(nodeB);
            nodeB = nodeB.getNext();                
        }       
        mergedNode = mergedNode.getNext();
    }

    if (nodeA != null)
    {
        mergedNode.setNext(nodeA);
    }

    if (nodeB != null)
    {
        mergedNode.setNext(nodeB);
    }       
    return tempNode;
} 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-10-29T03:06:34.473

```
Node mergeList(Node h1, Node h2) {
    if (h1 == null) return h2;
    if (h2 == null) return h1;
    Node head;
    if (h1.data < h2.data) {
        head = h1;
    } else {
        head = h2;
        h2 = h1;
        h1 = head;
    }

    while (h1.next != null && h2 != null) {
        if (h1.next.data < h2.data) {
            h1 = h1.next;
        } else {
            Node afterh2 = h2.next;
            Node afterh1 = h1.next;
            h1.next = h2;
            h2.next = afterh1;

            if (h2.next != null) {
                h2 = afterh2;
            }
        }
    }
    return head;
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-03-19T15:20:36.140

一个简单的迭代解决方案。

```
Node* MergeLists(Node* A, Node* B)
{
    //handling the corner cases

    //if both lists are empty
    if(!A && !B)
    {
        cout << "List is empty" << endl;
        return 0;
    }
    //either of list is empty
    else if(!A) return B;
    else if(!B) return A;
    else
    {
        Node* head = NULL;//this will be the head of the newList
        Node* previous = NULL;//this will act as the

        /* In this algorithm we will keep the
         previous pointer that will point to the last node of the output list.
         And, as given we have A & B as pointer to the given lists.

         The algorithm will keep on going untill either one of the list become empty.
         Inside of the while loop, it will divide the algorithm in two parts:
            - First, if the head of the output list is not obtained yet
            - Second, if head is already there then we will just compare the values and keep appending to the 'previous' pointer.
         When one of the list become empty we will append the other 'left over' list to the output list.
         */
         while(A && B)
         {
             if(!head)
             {
                 if(A->data <= B->data)
                 {
                     head = A;//setting head of the output list to A
                     previous = A; //initializing previous
                     A = A->next;
                 }
                 else
                 {
                     head = B;//setting head of the output list to B
                     previous = B;//initializing previous
                     B = B->next;
                 }
             }
             else//when head is already set
             {
                 if(A->data <= B->data)
                 {
                     if(previous->next != A)
                         previous->next = A;
                     A = A->next;//Moved A forward but keeping B at the same position
                 }
                 else
                 {
                     if(previous->next != B)
                         previous->next = B;
                     B = B->next; //Moved B forward but keeping A at the same position
                 }
                 previous = previous->next;//Moving the Output list pointer forward
             }
         }
        //at the end either one of the list would finish
        //and we have to append the other list to the output list
        if(!A)
            previous->next = B;

        if(!B)
            previous->next = A;

        return head; //returning the head of the output list
    }
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2015-04-01T19:26:24.730

这可以在不创建额外节点的情况下完成，只需将另一个节点引用传递给参数（节点临时）。

```
private static Node mergeTwoLists(Node nodeList1, Node nodeList2, Node temp) {
    if(nodeList1 == null) return nodeList2;
    if(nodeList2 == null) return nodeList1;

    if(nodeList1.data <= nodeList2.data){
        temp = nodeList1;
        temp.next = mergeTwoLists(nodeList1.next, nodeList2, temp);
    }
    else{
        temp = nodeList2;
        temp.next = mergeTwoLists(nodeList1, nodeList2.next, temp);
    }
    return temp;
} 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2015-08-29T17:57:49.207

我想分享一下我对解决方案的看法……我看到了涉及递归的解决方案，它们非常棒，是功能良好和模块化思维的结果。我真的很感谢分享。

我想补充一点，递归不适用于大灯，堆栈调用会溢出；所以我决定尝试迭代方法......这就是我得到的。

代码很容易解释，我添加了一些内联注释来确保这一点。

如果您不明白，请通知我，我会提高可读性（也许我对自己的代码有误导性的解释）。

```
import java.util.Random;

public class Solution {

    public static class Node<T extends Comparable<? super T>> implements Comparable<Node<T>> {

        T data;
        Node next;

        @Override
        public int compareTo(Node<T> otherNode) {
            return data.compareTo(otherNode.data);
        }

        @Override
        public String toString() {
            return ((data != null) ? data.toString() + ((next != null) ? "," + next.toString() : "") : "null");
        }
    }

    public static Node merge(Node firstLeft, Node firstRight) {
        combine(firstLeft, firstRight);
        return Comparision.perform(firstLeft, firstRight).min;

    }

    private static void combine(Node leftNode, Node rightNode) {
        while (leftNode != null && rightNode != null) {
            // get comparision data about "current pair of nodes being analized".
            Comparision comparision = Comparision.perform(leftNode, rightNode);
            // stores references to the next nodes
            Node nextLeft = leftNode.next; 
            Node nextRight = rightNode.next;
            // set the "next node" of the "minor node" between the "current pair of nodes being analized"...
            // ...to be equals the minor node between the "major node" and "the next one of the minor node" of the former comparision.
            comparision.min.next = Comparision.perform(comparision.max, comparision.min.next).min;
            if (comparision.min == leftNode) {
                leftNode = nextLeft;
            } else {
                rightNode = nextRight;
            }
        }
    }

/** Stores references to two nodes viewed as one minimum and one maximum. The static factory method populates properly the instance being build */
    private static class Comparision {

        private final Node min;
        private final Node max;

        private Comparision(Node min, Node max) {
            this.min = min;
            this.max = max;
        }

        private static Comparision perform(Node a, Node b) {
            Node min, max;
            if (a != null && b != null) {
                int comparision = a.compareTo(b);
                if (comparision <= 0) {
                    min = a;
                    max = b;
                } else {
                    min = b;
                    max = a;
                }
            } else {
                max = null;
                min = (a != null) ? a : b;
            }
            return new Comparision(min, max);
        }
    }

// Test example....
    public static void main(String args[]) {
        Node firstLeft = buildList(20);
        Node firstRight = buildList(40);
        Node firstBoth = merge(firstLeft, firstRight);
        System.out.println(firstBoth);
    }

// someone need to write something like this i guess...
    public static Node buildList(int size) {
        Random r = new Random();
        Node<Integer> first = new Node<>();
        first.data = 0;
        first.next = null;
        Node<Integer> current = first;
        Integer last = first.data;
        for (int i = 1; i < size; i++) {
            Node<Integer> node = new Node<>();
            node.data = last + r.nextInt(5);
            last = node.data;
            node.next = null;
            current.next = node;
            current = node;
        }
        return first;
    } 
```

}

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2019-04-26T06:55:59.297

我在下面展示了一个迭代解决方案。递归解决方案会更紧凑，但由于我们不知道列表的长度，因此递归存在堆栈溢出的风险。

基本思想类似于归并排序中的归并步骤；我们保留一个与每个输入列表对应的指针；在每次迭代中，我们推进与较小元素对应的指针。然而，大多数人被绊倒的地方有一个关键的区别。在归并排序中，由于我们使用结果数组，所以下一个要插入的位置始终是结果数组的索引。对于链表，我们需要保留一个指向排序列表最后一个元素的指针。指针可能会从一个输入列表跳到另一个输入列表，具体取决于哪个输入列表具有当前迭代的较小元素。

有了这个，下面的代码应该是不言自明的。

```
public ListNode mergeTwoLists(ListNode l1, ListNode l2) {
    if (l1 == null) {
        return l2;
    }
    if (l2 == null) {
        return l1;
    }
    ListNode first = l1;
    ListNode second = l2;
    ListNode head = null;
    ListNode last = null;

    while (first != null && second != null) {
        if (first.val < second.val) {
            if (last != null) {
                last.next = first;
            }
            last = first;
            first = first.next;
        } else {
            if (last != null) {
                last.next = second;
            }
            last = second;
            second = second.next;
        }
        if (head == null) {
            head = last;
        }
    }

    if (first == null) {
        last.next = second;
    }
    if (second == null) {
        last.next = first;
    }

    return head;
} 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2020-08-01T15:10:07.720

javascript中的简单代码用于合并两个链表。

```
function mergeLists(l1, l2) {
    let head = new ListNode(0); //dummy
    let curr = head;
    while(l1 && l2) {
        if(l2.val >= l1.val) {
            curr.next = l1;
            l1 = l1.next;
        } else {
            curr.next = l2;
            l2=l2.next
        }
        curr = curr.next;
    }
    if(!l1){
        curr.next=l2;
    }
    if(!l2){
        curr.next=l1;
    } 
    return head.next;
} 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2012-10-20T03:33:02.830

首先了解**“不创建任何新的额外节点”**的意思，据我了解，这并不意味着我不能拥有指向现有节点的指针。

如果不谈论指向现有节点的指针，您将无法实现它，即使您使用递归来实现相同的目标，系统也会为您创建指针作为调用堆栈。这就像告诉系统添加您在代码中避免使用的指针。

**使用额外指针**实现相同功能的简单功能：

```
typedef struct _LLNode{
    int             value;
    struct _LLNode* next;
}LLNode;

LLNode* CombineSortedLists(LLNode* a,LLNode* b){
    if(NULL == a){
        return b;
    }
    if(NULL == b){
        return a;
    }
    LLNode* root  = NULL;
    if(a->value < b->value){
        root = a;
        a = a->next;
    }
    else{
        root = b;
        b    = b->next;
    }
    LLNode* curr  = root;
    while(1){
        if(a->value < b->value){
            curr->next = a;
            curr = a;
            a=a->next;
            if(NULL == a){
                curr->next = b;
                break;
            }
        }
        else{
            curr->next = b;
            curr = b;
            b=b->next;
            if(NULL == b){
                curr->next = a;
                break;
            }
        }
    }
    return root;
} 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2012-10-28T04:04:12.237

```
public static Node merge(Node h1, Node h2) {

    Node h3 = new Node(0);
    Node current = h3;

    boolean isH1Left = false;
    boolean isH2Left = false;

    while (h1 != null || h2 != null) {
        if (h1.data <= h2.data) {
            current.next = h1;
            h1 = h1.next;
        } else {
            current.next = h2;
            h2 = h2.next;
        }
        current = current.next;

        if (h2 == null && h1 != null) {
            isH1Left = true;
            break;
        }

        if (h1 == null && h2 != null) {
            isH2Left = true;
            break;
        }
    }

    if (isH1Left) {
        while (h1 != null) {
            current.next = h1;
            current = current.next;
            h1 = h1.next;
        }
    } 

    if (isH2Left) {
        while (h2 != null) {
            current.next = h2;
            current = current.next;
            h2 = h2.next;
        }
    }

    h3 = h3.next;

    return h3;
} 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2015-03-18T06:06:33.313

```
Node * merge_sort(Node *a, Node *b){
   Node *result = NULL;
   if(a ==  NULL)
      return b;
   else if(b == NULL)
      return a;

  /* For the first node, we would set the result to either a or b */
    if(a->data <= b->data){
       result = a;
    /* Result's next will point to smaller one in lists 
       starting at a->next  and b */
      result->next = merge_sort(a->next,b);
    }
    else {
      result = b;
     /*Result's next will point to smaller one in lists 
       starting at a and b->next */
       result->next = merge_sort(a,b->next);
    }
    return result;
 } 
```

请参阅我的博客文章[http://www.algorithmsandme.com/2013/10/linked-list-merge-two-sorted-linked.html](http://www.algorithmsandme.com/2013/10/linked-list-merge-two-sorted-linked.html)

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2015-06-09T21:13:23.200

```
Node MergeLists(Node list1, Node list2) {
    //if list is null return other list 
   if(list1 == null)
   {
      return list2;
   }
   else if(list2 == null)
   {
      return list1;
   }
   else
   {
        Node head;
        //Take head pointer to the node which has smaller first data node
        if(list1.data < list2.data)
        {
            head = list1;
            list1 = list1.next;
        }
        else
        {
           head = list2;
           list2 = list2.next;
        }
        Node current = head;
        //loop till both list are not pointing to null
        while(list1 != null || list2 != null)
        {
            //if list1 is null, point rest of list2 by current pointer 
            if(list1 == null){
               current.next = list2;
               return head;
            }
            //if list2 is null, point rest of list1 by current pointer 
            else if(list2 == null){
               current.next = list1;
               return head;
            }
            //compare if list1 node data is smaller than list2 node data, list1 node will be
            //pointed by current pointer
            else if(list1.data < list2.data)
            {
                current.next = list1;
                current = current.next;
                list1 = list1.next;
            }
            else
            {
                current.next = list2;
                current = current.next;
                list2 = list2.next;
            }
        }      
    return head;
    }      
} 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2016-03-06T17:49:56.963

这是一个使用链表实现的 java.util 的完整工作示例。您可以将下面的代码复制粘贴到 main() 方法中。

```
 LinkedList<Integer> dList1 = new LinkedList<Integer>();
        LinkedList<Integer> dList2 = new LinkedList<Integer>();
        LinkedList<Integer> dListMerged = new LinkedList<Integer>();

        dList1.addLast(1);
        dList1.addLast(8);
        dList1.addLast(12);
        dList1.addLast(15);
        dList1.addLast(85);

        dList2.addLast(2);
        dList2.addLast(3);
        dList2.addLast(12);
        dList2.addLast(24);
        dList2.addLast(85);
        dList2.addLast(185);

        int i = 0;
        int y = 0;
        int dList1Size = dList1.size();
        int dList2Size = dList2.size();
        int list1Item = dList1.get(i);
        int list2Item = dList2.get(y);
        while (i < dList1Size || y < dList2Size) {

            if (i < dList1Size) {

                if (list1Item <= list2Item || y >= dList2Size) {
                    dListMerged.addLast(list1Item);
                    i++;
                    if (i < dList1Size) {
                        list1Item = dList1.get(i);
                    }
                }
            }

            if (y < dList2Size) {

                if (list2Item <= list1Item || i >= dList1Size) {
                    dListMerged.addLast(list2Item);
                    y++;
                    if (y < dList2Size) {
                        list2Item = dList2.get(y);
                    }
                }
            }

        }

        for(int x:dListMerged)
        {
            System.out.println(x);
        } 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2016-07-10T05:49:46.307

**递归方式（Stefan 答案的变体）**

```
 MergeList(Node nodeA, Node nodeB ){
        if(nodeA==null){return nodeB};
        if(nodeB==null){return nodeA};

    if(nodeB.data<nodeA.data){
        Node returnNode = MergeNode(nodeA,nodeB.next);
        nodeB.next = returnNode;
        retturn nodeB;
    }else{
        Node returnNode = MergeNode(nodeA.next,nodeB);
        nodeA.next=returnNode;
        return nodeA;
    } 
```

考虑下面的链接列表来可视化这个

`2>4`清单 A `1>3` 清单 B

**与 Stefan 几乎相同的答案（非递归），但没有更多的评论/有意义的变量名。如果有人感兴趣，还包括评论中的双链表**

考虑这个例子

`5->10->15>21 // List1`

`2->3->6->20 //List2`

```
Node MergeLists(List list1, List list2) {
  if (list1 == null) return list2;
  if (list2 == null) return list1;

if(list1.head.data>list2.head.data){
  listB =list2; // loop over this list as its head is smaller
  listA =list1;
} else {
  listA =list2; // loop over this list
  listB =list1;
}

listB.currentNode=listB.head;
listA.currentNode=listA.head;

while(listB.currentNode!=null){

  if(listB.currentNode.data<listA.currentNode.data){
    Node insertFromNode = listB.currentNode.prev; 
    Node startingNode = listA.currentNode;
    Node temp = inserFromNode.next;
    inserFromNode.next = startingNode;
    startingNode.next=temp;

    startingNode.next.prev= startingNode; // for doubly linked list
    startingNode.prev=inserFromNode;  // for doubly linked list

    listB.currentNode= listB.currentNode.next;
    listA.currentNode= listA.currentNode.next;

  } 
  else
  {
    listB.currentNode= listB.currentNode.next;

  }

} 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2017-05-25T21:44:20.263

我对这个问题的看法如下：

伪代码：

```
Compare the two heads A and B. 
If A <= B, then add A and move the head of A to the next node. 
Similarly, if B < A, then add B and move the head of B to the next node B.
If both A and B are NULL then stop and return.
If either of them is NULL, then traverse the non null head till it becomes NULL. 
```

代码：

```
public Node mergeLists(Node headA, Node headB) {
    Node merge = null;
    // If we have reached the end, then stop.
    while (headA != null || headB != null) {
        // if B is null then keep appending A, else check if value of A is lesser or equal than B
        if (headB == null || (headA != null && headA.data <= headB.data)) {
            // Add the new node, handle addition separately in a new method.
            merge = add(merge, headA.data);
            // Since A is <= B, Move head of A to next node
            headA = headA.next;
        // if A is null then keep appending B, else check if value of B is lesser than A
        } else if (headA == null || (headB != null && headB.data < headA.data)) {
            // Add the new node, handle addition separately in a new method.
            merge = add(merge, headB.data);
            // Since B is < A, Move head of B to next node
            headB = headB.next;
        }
    }
    return merge;
}

public Node add(Node head, int data) {
    Node end = new Node(data);
    if (head == null) {
        return end;
    }

    Node curr = head;
    while (curr.next != null) {
        curr = curr.next;
    }

    curr.next = end;
    return head;
} 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2017-10-23T19:32:28.543

```
 /* Simple/Elegant Iterative approach in Java*/    
        private static LinkedList mergeLists(LinkedList list1, LinkedList list2) {
                    Node head1 = list1.start;
                    Node head2 = list2.start;
                    if (list1.size == 0)
                    return list2;
                    if (list2.size == 0)
                    return list1;               
                    LinkedList mergeList = new LinkedList();
                    while (head1 != null && head2 != null) {
                        if (head1.getData() < head2.getData()) {
                            int data = head1.getData();
                            mergeList.insert(data);
                            head1 = head1.getNext();
                        } else {
                            int data = head2.getData();
                            mergeList.insert(data);
                            head2 = head2.getNext();
                        }
                    }
                    while (head1 != null) {
                        int data = head1.getData();
                        mergeList.insert(data);
                        head1 = head1.getNext();
                    }
                    while (head2 != null) {
                        int data = head2.getData();
                        mergeList.insert(data);
                        head2 = head2.getNext();
                    }
                    return mergeList;
                }

/* Build-In singly LinkedList class in Java*/
class LinkedList {
    Node start;
    int size = 0;

    void insert(int data) {
        if (start == null)
            start = new Node(data);
        else {
            Node temp = start;
            while (temp.getNext() != null) {
                temp = temp.getNext();
            }
            temp.setNext(new Node(data));
        }
        size++;
    }

    @Override
    public String toString() {

        String str = "";
        Node temp=start;
        while (temp != null) {
            str += temp.getData() + "-->";
            temp = temp.getNext();
        }
        return str;
    }

} 
```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2018-06-09T05:59:16.100

```
LLNode *mergeSorted(LLNode *h1, LLNode *h2) 
{ 
  LLNode *h3=NULL;
  LLNode *h3l;
  if(h1==NULL && h2==NULL)
    return NULL; 
  if(h1==NULL) 
    return h2; 
  if(h2==NULL) 
    return h1; 
  if(h1->data<h2->data) 
  {
    h3=h1;
    h1=h1->next; 
  }
  else 
  { 
    h3=h2; 
    h2=h2->next; 
  }
  LLNode *oh=h3;
  while(h1!=NULL && h2!=NULL) 
  {
    if(h1->data<h2->data) 
    {
      h3->next=h1;
      h3=h3->next;
      h1=h1->next; 
    } 
    else 
    {
      h3->next=h2; 
      h3=h3->next; 
      h2=h2->next; 
    } 
  } 
  if(h1==NULL)
    h3->next=h2;
  if(h2==NULL)
    h3->next=h1;
  return oh;
} 
```

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2018-09-29T19:23:41.373

```
// Common code for insert at the end
        private void insertEnd(int data) {
                Node newNode = new Node(data);
                if (head == null) {
                    newNode.next = head;
                    head = tail = newNode;
                    return;
                }
                Node tempNode = tail;
                tempNode.next = newNode;
                tail = newNode;
            }

    private void mergerTwoSortedListInAscOrder(Node tempNode1, Node tempNode2) {

            if (tempNode1 == null && tempNode2 == null)
                return;
            if (tempNode1 == null) {
                head3 = tempNode2;
                return;
            }
            if (tempNode2 == null) {
                head3 = tempNode1;
                return;
            }

            while (tempNode1 != null && tempNode2 != null) {

                if (tempNode1.mData < tempNode2.mData) {
                    insertEndForHead3(tempNode1.mData);
                    tempNode1 = tempNode1.next;
                } else if (tempNode1.mData > tempNode2.mData) {
                    insertEndForHead3(tempNode2.mData);
                    tempNode2 = tempNode2.next;
                } else {
                    insertEndForHead3(tempNode1.mData);
                    insertEndForHead3(tempNode2.mData);
                    tempNode1 = tempNode1.next;
                    tempNode2 = tempNode2.next;
                }

            }
            if (tempNode1 != null) {
                while (tempNode1 != null) {
                    insertEndForHead3(tempNode1.mData);
                    tempNode1 = tempNode1.next;
                }
            }
            if (tempNode2 != null) {
                while (tempNode2 != null) {
                    insertEndForHead3(tempNode2.mData);
                    tempNode2 = tempNode2.next;
                }
            }
        } 
```

:)GlbMP

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2019-08-17T13:35:05.103

一开始我只创建了一个虚拟节点来为自己节省许多“如果”条件。

```
 public ListNode mergeTwoLists(ListNode l1, ListNode l2) {

        ListNode list1Cursor = l1;
        ListNode list2Cursor = l2;

        ListNode currentNode = new ListNode(-1); // Dummy node
        ListNode head = currentNode;

        while (list1Cursor != null && list2Cursor != null)
        {
            if (list1Cursor.val < list2Cursor.val) {
                currentNode.next = list1Cursor;
                list1Cursor = list1Cursor.next;
                currentNode = currentNode.next;
            } else {
                currentNode.next = list2Cursor;
                list2Cursor = list2Cursor.next;
                currentNode = currentNode.next;
            }
        }

        // Complete the rest
        while (list1Cursor != null) {
            currentNode.next = list1Cursor;
            currentNode = currentNode.next;
            list1Cursor = list1Cursor.next;
        }
        while (list2Cursor != null) {
            currentNode.next = list2Cursor;
            currentNode = currentNode.next;
            list2Cursor = list2Cursor.next;
        }

        return head.next;
    } 
```

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2021-11-22T17:38:12.580

```
public ListNode MergeTwoLists(ListNode l1, ListNode l2) {//c#
ListNode _destNode=null;//Merged List
ListNode _srcNode=null;
ListNode _resHead=null;
if(l1==null || l2==null){//for scenario l1 null or l2 null or both null
    return l1??l2??null;
}
if(l1.val<=l2.val){    
    _destNode=l1;//finding the dest list
   _srcNode=l2;
    _resHead=l1;
}
else{
    _destNode=l2;
     _srcNode=l1;
     _resHead=l2;
}

while(_destNode!=null && _srcNode!=null){
    if(_destNode.val<=_srcNode.val && (_destNode.next==null ||_destNode.next.val>=_srcNode.val)) {
        //appending the values to dest list , if the element from dest list  is less than  element from _srcNode 
            var _temp_l2_currentnode=_srcNode;
            _srcNode=_srcNode.next;
            var _temp_l1_nextnode=_destNode.next;
            _destNode.next=_temp_l2_currentnode;
            _temp_l2_currentnode.next=_temp_l1_nextnode;
            _destNode=_destNode.next;
    }
    else{
          _destNode=_destNode.next;

    }
}
return _resHead; 
```

}

* * *

## 回答 #25

> 赞同：-1
> 
> 时间：2014-10-24T02:18:12.607

```
private static Node mergeLists(Node L1, Node L2) {

    Node P1 = L1.val < L2.val ? L1 : L2;
    Node P2 = L1.val < L2.val ? L2 : L1;
    Node BigListHead = P1;
    Node tempNode = null;

    while (P1 != null && P2 != null) {
        if (P1.next != null && P1.next.val >P2.val) {
        tempNode = P1.next;
        P1.next = P2;
        P1 = P2;
        P2 = tempNode;
        } else if(P1.next != null) 
        P1 = P1.next;
        else {
        P1.next = P2;
        break;
        }
    }

    return BigListHead;
} 
```

* * *

## 回答 #26

> 赞同：-1
> 
> 时间：2016-03-21T18:47:05.080

```
void printLL(){
    NodeLL cur = head;
    if(cur.getNext() == null){
        System.out.println("LL is emplty");
    }else{
        //System.out.println("printing Node");
        while(cur.getNext() != null){
            cur = cur.getNext();
            System.out.print(cur.getData()+ " ");

        }
    }
    System.out.println();
}

void mergeSortedList(NodeLL node1, NodeLL node2){
    NodeLL cur1 = node1.getNext();
    NodeLL cur2 = node2.getNext();

    NodeLL cur = head;
    if(cur1 == null){
        cur = node2;
    }

    if(cur2 == null){
        cur = node1;
    }       
    while(cur1 != null && cur2 != null){

        if(cur1.getData() <= cur2.getData()){
            cur.setNext(cur1);
            cur1 = cur1.getNext();
        }
        else{
            cur.setNext(cur2);
            cur2 = cur2.getNext();
        }
        cur = cur.getNext();
    }       
    while(cur1 != null){
        cur.setNext(cur1);
        cur1 = cur1.getNext();
        cur = cur.getNext();
    }       
    while(cur2 != null){
        cur.setNext(cur2);
        cur2 = cur2.getNext();
        cur = cur.getNext();
    }       
    printLL();      
} 
```

* * *

## 回答 #27

> 赞同：-2
> 
> 时间：2015-02-22T05:50:09.960

下面是如何合并两个排序链表 headA 和 headB 的代码：

```
Node* MergeLists1(Node *headA, Node* headB)
{
    Node *p = headA;
    Node *q = headB;
    Node *result = NULL; 
    Node *pp = NULL;
    Node *qq = NULL;
    Node *head = NULL;
    int value1 = 0;
    int value2 = 0;
    if((headA == NULL) && (headB == NULL))
    {
        return NULL;
    }
    if(headA==NULL)
    {
        return headB;
    }
    else if(headB==NULL)
    {
        return headA;
    }
    else
    {
        while((p != NULL) || (q != NULL))
        {
            if((p != NULL) && (q != NULL))
            {
                int value1 = p->data;
                int value2 = q->data;
                if(value1 <= value2)
                {
                    pp = p->next;
                    p->next = NULL;
                    if(result == NULL)
                    {
                        head = result = p;
                    }
                    else
                    {
                        result->next = p;
                        result = p;
                    }
                    p = pp;
                }
                else
                {
                    qq = q->next;
                    q->next = NULL;
                    if(result == NULL)
                    {
                        head = result = q;
                    }
                    else
                    {
                        result->next = q;
                        result = q;
                    }
                    q = qq;
                }
            }
            else
            {
                if(p != NULL)
                {
                    pp = p->next;
                    p->next = NULL;
                    result->next = p;
                    result = p;
                    p = pp;
                }
                if(q != NULL)
                {
                    qq = q->next;
                    q->next = NULL;
                    result->next = q;
                    result = q;
                    q = qq;
                }
            }
        }
    }
    return head;
} 
```

# facebook - Facebook Page Tab App - 更新下拉图标

> ID：10707353
> 
> 赞同：0
> 
> 时间：2012-05-22T17:53:25.077
> 
> 标签：facebook, api, facebook-graph-api

我正在尝试更新您在标签页和应用程序下拉菜单中看到的 Facebook 页面标签应用程序图标。我知道可以使用此处的 API 调用更新主缩略图 [http://developers.facebook.com/docs/reference/api/page/#tabs](http://developers.facebook.com/docs/reference/api/page/#tabs)，但更新**custom_image_url**不会更新他的下拉图标。这是屏幕截图：![在此处输入图像描述](../Images/73e9a8bfcb7cf7e00f2c8fc4116f0f2a.png)

我在这里发现了一个类似的问题——Changing [facebook tab icon](https://stackoverflow.com/questions/7318817/changing-facebook-tab-icon)，但我正在寻找一个 API 解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T17:59:28.387

目前无法通过 API 更新页面选项卡图标（应用程序图标也是如此）。

实际上，用于此的图标是应用程序图标，并且对于安装到的所有页面应用程序都是相同的，因此您不能为特定页面更改它，而是整个应用程序。

# android - 应用程序未运行时的广播接收器

> ID：10707354
> 
> 赞同：5
> 
> 时间：2012-05-22T17:53:26.517
> 
> 标签：android, broadcastreceiver, alarmmanager

我`BroadcastReceiver`在清单中注册了一个，它接收来自`AlarmManager`. 当应用程序运行时，这一切都很好，即`onReceive()`正在调用该方法。

但是，如果我强制停止应用程序以便测试它是否`BroadcastReceiver`仍会`AlarmManager`在未运行时收到通知，`onReceive()`则永远不会调用该方法。

这种方式可以不用force-stop来测试`AlarmManager`&接收器吗？似乎有一些回应说它不起作用，而一些回应说它应该起作用。

如果没有，有没有办法测试这个？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T17:56:06.263

如果您的接收器已在您的清单中注册，它应该始终有效。即使您的应用程序被强制关闭。

问题可能是警报。一旦您的应用程序强制关闭，警报可能会被删除。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-25T12:18:33.920

根据[对此答案](https://stackoverflow.com/a/3712736/383414)的评论，您不能通过自己杀死应用程序来测试这种类型的东西。您必须抛出异常，以便应用程序“自然”死亡。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-11-22T04:07:44.880

可能这可能是您的设备问题。在小米、OPPO、vivo、honor 和乐视手机中，用户必须授予应用程序自动启动权限，为此，您应该要求用户手动启用此功能，您无法以编程方式完成

# performance - 如何使用 Dojo 提高 IE8 的性能

> ID：10707358
> 
> 赞同：1
> 
> 时间：2012-05-22T17:53:44.360
> 
> 标签：performance, parsing, internet-explorer-8, dojo

我在单个页面上构建了 RIA。我正在使用 Dojo 1.7.2。该页面包含大约 200 个 dijit/NumberSpinner 和一些 TabContainers 和 TitlePanes。当然，这在所有浏览器中都能完美运行，客户公司使用的 Internet Explorer 8 除外。

在所有浏览器中，整个页面的解析需要几秒钟，在 IE8 中是 2 分钟，我通过使用以下提示将其缩短到 40 秒：

*   使用自定义构建
*   以编程方式而不是声明方式创建小部件
*   仅在显示小部件时对其进行解析。（这不会加快解析速度，只会让用户在使用应用程序时等待更多*时间*，而不是*之前*。）
*   用 NumberSpinners 代替 NumberTextBox（这将解析时间减少了一半！）

还有其他提示吗？我可以尝试重用 NumberSpinner 并在 div 可见时将它们扔掉，但这需要我的应用程序进行相当大的重写。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-04T11:48:06.457

您面临的情况是，在 DOM 中以编程方式创建了非常多的节点。IE 在这方面表现不佳，受到 javascript 引擎的阻碍。咳咳？！

您的目标是尽可能多地预先定义，而不是在运行时覆盖它。我的意思是在 data-dojo-props / 构造参数中设置参数。这尤其适用于 onClick 处理程序等。你可以通过这样做来实现这一点：

```
var MyConstruct = dojo.define("foo.MyConstruct", [ /* inheritance */ dijit.form.ValidationTextBox ], function() {
      // instead of setting properties during construct, preset those which are possible
      constraints: { min: 0, max: 100 },
      postMixInArguments: function() {
          this.inherited(arguments);    // call widget first
          if(this.constructParameter) ; // act on it
      },
      // implement any overrides you otherwise would need
      // and for minimal runtime overhead, redefine the private version, like _onBlur
      // copy the source and change what you need
      onBlur: function () {
          // an event override example
      }
}); 
```

但; 为什么 NumberSpinners > NumberTextBoxes 减少了 50%？这就是为什么：

### 模板文本框

```
<div class="dijit dijitReset dijitInline dijitLeft" id="widget_${id}" role="presentation"
    ><div class="dijitReset dijitInputField dijitInputContainer"
        ><input class="dijitReset dijitInputInner" data-dojo-attach-point='textbox,focusNode' autocomplete="off"
            ${!nameAttrSetting} type='${type}'
    /></div
></div> 
```

### 模板微调器

```
<div class="dijit dijitReset dijitInline dijitLeft"
    id="widget_${id}" role="presentation"
    ><div class="dijitReset dijitButtonNode dijitSpinnerButtonContainer"
        ><input class="dijitReset dijitInputField dijitSpinnerButtonInner" type="text" tabIndex="-1" readonly="readonly" role="presentation"
        /><div class="dijitReset dijitLeft dijitButtonNode dijitArrowButton dijitUpArrowButton"
            data-dojo-attach-point="upArrowNode"
            ><div class="dijitArrowButtonInner"
                ><input class="dijitReset dijitInputField" value="&#9650;" type="text" tabIndex="-1" readonly="readonly" role="presentation"
                    ${_buttonInputDisabled}
            /></div
        ></div
        ><div class="dijitReset dijitLeft dijitButtonNode dijitArrowButton dijitDownArrowButton"
            data-dojo-attach-point="downArrowNode"
            ><div class="dijitArrowButtonInner"
                ><input class="dijitReset dijitInputField" value="&#9660;" type="text" tabIndex="-1" readonly="readonly" role="presentation"
                    ${_buttonInputDisabled}
            /></div
        ></div
    ></div
    ><div class='dijitReset dijitValidationContainer'
        ><input class="dijitReset dijitInputField dijitValidationIcon dijitValidationInner" value="&#935;" type="text" tabIndex="-1" readonly="readonly" role="presentation"
    /></div
    ><div class="dijitReset dijitInputField dijitInputContainer"
        ><input class='dijitReset dijitInputInner' data-dojo-attach-point="textbox,focusNode" type="${type}" data-dojo-attach-event="onkeypress:_onKeyPress"
            role="spinbutton" autocomplete="off" ${!nameAttrSetting}
    /></div
></div> 
```

TextBox 模板没有太多可以优化它的地方，只有入口点是 ${type} 参数，该参数是通过 _getTypeAttr 使用常规 exp 替换设置的。在 postMixInProps 中（在 _TemplatedMixin 运行并生成 DOM 之前），即使指定了其他任何内容，该值也会被覆盖为“文本”。尽管——不知道这会如何暗示——人们可能想要拿走focusNode + FocusMixin，但我不会去讨论这个。

在 dijit/form/MappedTextBox 中有一些奇怪的处理（它创建了一个隐藏的`<input>`，包含 'true' 值，请参阅[http://bugs.dojotoolkit.org/ticket/8660](http://bugs.dojotoolkit.org/ticket/8660)。这已经在 'this.name 上放置了一个正则表达式替换' 来解决问题 - 在您的输入字段中省略 name 属性会解决这个问题（如果可能，请使用 Id 代替）。

### 模板验证文本框

使用 NumberTextBox 的主要原因是范围限制，对吧？为了加载该特定模块，完成了许多混合 - 但基本上它们基于 ValidationTextBox。这提供了一种`.validate`功能并在需要时显示消息。上面关于删除 focusmixin 的注释将使消息传递停止工作，因为它们作用于 onBlur 事件。

如果您要使用 ValidationTextBox 而不是 NumberTextBox 并通过自定义功能实现范围检查，我相信它会产生奇迹。大量的 eval 代码在验证文本框之上运行以使其成为数字文本框 - 其中一些可能在您的情况下是开销。

```
<div class="dijit dijitReset dijitInline dijitLeft"
    id="widget_${id}" role="presentation"
    ><div class='dijitReset dijitValidationContainer'
        ><input class="dijitReset dijitInputField dijitValidationIcon dijitValidationInner" value="&#935; " type="text" tabIndex="-1" readonly="readonly" role="presentation"
    /></div
    ><div class="dijitReset dijitInputField dijitInputContainer"
        ><input class="dijitReset dijitInputInner" data-dojo-attach-point='textbox,focusNode' autocomplete="off"
            ${!nameAttrSetting} type='${type}'
    /></div
></div> 
```

验证的示例覆盖：

```
dijit.byId("validationTextBoxNodeId").validator = function(value, constraints){

    // Check that email has not been used yet.
    if(some-checks){
        return true;
    }else{
        return false;
    }
} 
```

# c# - 在 VB.NET 中检查使用 process.start() 启动的文件中的更改

> ID：10707360
> 
> 赞同：0
> 
> 时间：2012-05-22T17:53:47.043
> 
> 标签：c#, vb.net, process, kill-process

我正在开发一个基于 vbnet/c#.NET 的应用程序，它可以使用不同的应用程序（excel、word 等）打开文件。

该应用程序使用启动`Dim app As Process = Process.Start(ProcessProperties)`

现在，当我必须终止我使用的进程`app.Kill()`但我需要在杀死它之前检查文档是否已被修改。

我该如何处理？如果可能的话，如何启动应用程序本机提示以进行保存？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-22T18:05:24.733

对于办公应用程序，请使用[Office 互操作程序集](http://msdn.microsoft.com/en-us/library/15s06t57%28v=vs.80%29.aspx)，而不是`Process.Start`启动和控制它们。这是 Excel 的示例代码（在 VB.NET 中）。您应该添加`Microsoft.Office.Interop.Excel.dll`到项目引用中才能使其正常工作。

```
 oExcel = New Microsof.Office.Interop.Excel.Application
   oBook = oExcel.Workbooks.Open(filepath)
   'Do your stuff
   oBook.Close 'This will trigger the application native prompt if the document was modified
   oExcel.Quit() 
```

对于其他程序，它很大程度上取决于一个程序

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-22T18:09:29.640

您可以通过调用[`Process.CloseMainWindow`](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.closemainwindow)而不是`Process.Kill`.

> 的行为`CloseMainWindow`与用户使用系统菜单关闭应用程序主窗口的行为相同。因此，通过关闭主窗口来退出进程的请求不会强制应用程序立即退出。
> 
> 如果您调用`Kill`. `Kill`导致进程异常终止，仅在必要时使用。`CloseMainWindow`可以有序地终止进程并关闭所有窗口，因此它更适合具有接口的应用程序。

对于具有未保存更改的 Office 应用程序，`CloseMainWindow`将启动“保存”对话框。您需要处理用户按下“取消”的情况，因为这可能会导致`WaitForExit`呼叫无限期阻塞。

例如：

```
// Launch Word application.
Process wordProcess = 
    Process.Start(@"C:\Program Files (x86)\Microsoft Office\Office12\winword.exe");

// Give user some time to type in text.
Thread.Sleep(TimeSpan.FromSeconds(20));

// Request Word to close.
wordProcess.CloseMainWindow();

// Wait until user saves or discards changes.
// May block indefinitely if user cancels.
wordProcess.WaitForExit(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-22T18:09:11.130

这个问题有不同的方法。您可以计算某种初始校验和，并通过重做校验和并与原始校验和进行比较来查看您的文档是否有任何更改。

这部分从您的问题中不是很清楚，如果文档被保存，您可能可以查看文件的 date_modified 值以查看是否有任何修改。

# java - Java 时间延迟

> ID：10707361
> 
> 赞同：0
> 
> 时间：2012-05-22T17:54:01.260
> 
> 标签：java, timer

我在使用以下代码时遇到问题。

```
//Send Creation email
ListServDAO.sendCreateEmail(orgId, full, request.getSession().getServletContext());
//Force a 1 minute pause
       Timer timer = new Timer();
       timer.schedule(new TimerTask() {
            public void run() {
                //Send add members email
                ListServDAO.sendAddMembersEmail(orgId, request.getSession().getServletContext());
                }
            }, 0, 60 * 1000); 
```

sendAddMembersEmail 函数在调用 sendCreateEmail 函数后不会等待 1 分钟发送。我不确定为什么即使在阅读了 java API 之后它也没有等待。我不希望使用 Thread.sleep 方法，因为我希望用户能够在等待电子邮件发送时使用该应用程序。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T17:58:08.973

您是否打算重复发送电子邮件？如果不是，您为什么要使用需要 2 长时间的方法（即“每`<period>`毫秒重复运行此任务”）？使用该`schedule(task, delay)`方法（并使用非零延迟）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-22T17:59:28.057

第二个参数是您作为 0 传递的初始延迟，因此它会立即执行它，传递 60000 秒让它等待一分钟然后发送。

由于您只希望它只发送一次使用，请致电[`Timer.schedule(TimerTask task, long delay)`](https://docs.oracle.com/javase/8/docs/api/java/util/Timer.html#schedule-java.util.TimerTask-long-)

无关：

您应该考虑使用[ScheduledExecutorService](https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/ScheduledExecutorService.html)而不是`Timer`. 请参阅[Oracle 教程](http://docs.oracle.com/javase/tutorial/essential/concurrency/exinter.html)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-22T18:00:36.340

您的参数顺序错误：

```
 schedule(TimerTask task, long delay, long period) 
      Schedules the specified task for repeated fixed-delay execution, beginning after the specified delay. 
```

交换 0 和 60*1000。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-22T17:58:54.737

你有一个额外的零。

您所调用的是[Delayed with a Fixed-Delay Repeat Execution](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/Timer.html#schedule%28java.util.TimerTask,%20long,%20long%29)，而您想要的是[Single Delay Non Repeat execution](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/Timer.html#schedule%28java.util.TimerTask,%20long%29)。

# android - android - 我如何使用“android:layoutDirection”？- 再次

> ID：10707370
> 
> 赞同：-1
> 
> 时间：2012-05-22T17:54:15.400
> 
> 标签：android, android-layout, android-linearlayout

有人可以帮我如何使用这个属性`android:layoutDirection`，

请不要让我参考这个问题[Android 上从右到左语言的状态是什么？](https://stackoverflow.com/q/9262667/1321873)因为它没有回答我的问题！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-12T10:36:19.083

layoutDirection 在 4.0 中没有发布，所以你不能使用 attr，但是如果你不使用 sdk，而是使用 android 的所有代码构建。首先在创建时在代码中获取Linearlayout，通常在setContent之后，并使用在View.java中定义的@hide api setLayoutDiredtion（View.LAYOUT_DIRECTION_LOCALE），当然，在4.2之后你可以直接在xml中使用layoutDirection

# sqlite - 如何检查索引列的排序？

> ID：10707374
> 
> 赞同：1
> 
> 时间：2012-05-22T17:54:24.520
> 
> 标签：sqlite, indexing

我可以使用以下命令找到表的索引列表：

```
PRAGMA index_list(myTable); 
```

从这个结果中，我可以使用以下内容获取有关索引中列的详细信息：

```
PRAGMA index_info(myIndex); 
```

但我似乎找不到一种方法来告诉列排序顺序。是否有另一个我忽略的编译指示可以让我这样做？

注意：我知道我可以从`SQLITE_MASTER`create 语句中选择并解析排序顺序，但如果可能的话，我宁愿不进行解析。但是，如果这是唯一的解决方案，那么它必须起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T19:44:10.883

在通过 3.7.13 源代码快速 grep 之后，我不相信任何 pragma 都会暴露排序顺序。我能找到的对 KeyInfo::aSortOrder 的唯一引用要么在 CREATE INDEX 代码中，要么在实际的数据库操作中，例如查询或相互比较索引。

如果您可以选择自定义构建 SQLite，将其添加到 index_info pragma 中似乎不需要做很多工作。

# jquery - 空时忽略空的xml节点/ jquery

> ID：10707380
> 
> 赞同：0
> 
> 时间：2012-05-22T17:54:42.467
> 
> 标签：jquery, xml, ajax

我找到并编辑了这段代码，以使用 jquery 在网页上显示来自在线日历的 xml 提要的元素。有没有办法让我包含条件，以便我可以在填充节点时显示来自节点的信息，并在节点为空时忽略它？例如，要包含 imagepath、imagetext 和必要的 html 来格式化它，但在没有 imagepath 和 imagetext 信息时忽略所有这些？

```
<script>
$(document).ready(function () {
    $.ajax({
        type: "GET",
        url: "http://orion.lib.mi.us/evanced/lib/eventsxml.asp?dm=exml&lib=0&nd=90",
        dataType: "xml",
        success: xmlParser,
        error: function(){alert("We're sorry. Something didn't load correctly.");}
    });
});

function xmlParser(xml) {
    $(xml).find("item").each(function () {
        var xml_image       = $(this).find('imagepath').text();
        var xml_imagetext   = $(this).find('imagetext').text();
        var xml_title       = $(this).find('title').text();
        var xml_date        = $(this).find('date').text();
        var xml_time        = $(this).find('time').text();
        var xml_location    = $(this).find('location').text();
        var xml_link        = $(this).find('link').text();
        var xml_description = $(this).find('description').text();
        $(".main").append('<div class="event"><div class="logo"><img alt="' + xml_imagetext + '" src="' + xml_image + '" /></div><p class="title"><a href="' + xml_link + '">' + xml_title + '</a></p><p class="when">' + xml_date + ' at ' + xml_time + '</p><p class="location">Location: ' + xml_location + '</p><p class="description">' + xml_description + '</p><p class="link"><a href="' + xml_link + '">More Information</a></p></div>');
    });}
</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T18:02:49.867

您可能希望在将内容附加到*main*之前简单地添加一个条件。

```
if (xml_image != "" && xml_imagetext != "") {
    $(".main").append...
} 
```

或者，如果您想显示不同的内容，请执行以下操作：

```
var hasImage = xml_image != "" && xml_imagetext != "";
var html = "<div class='event'>" +
    ((hasImage) ? "<img src='" + xml_image + "' alt='" + xml_imagetext + "' />" : "")
    + "</div>"; 
```

# iphone - 更改 UITableViewCell 中的图像而不重新加载单元格

> ID：10707385
> 
> 赞同：0
> 
> 时间：2012-05-22T17:55:02.593
> 
> 标签：iphone, image, uitableview

我正在编写一个以 UITableView 作为主要用户界面的 iPhone 应用程序。每个部分由两行组成，标题和正文。当用户单击标题时，我通过更改 numberOfRowsInSection 值来删除第二行：

```
- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section {
    cbwComponent *comp = [_componentController objectInListAtIndex:section];
    if([comp hasContentsView] && !comp.contentsHidden){
        return 2;
    }else
        return 1;
} 
```

当用户选择标题时，我使用以下代码：

```
comp.contentsHidden = YES;
[self.tableView beginUpdates];
NSArray *deleteIndexPaths = [[NSArray alloc] initWithObjects:[NSIndexPath indexPathForRow:1 inSection:indexPath.section], nil];
[self.tableView deleteRowsAtIndexPaths:deleteIndexPaths withRowAnimation:UITableViewRowAnimationFade];
[self.tableView endUpdates]; 
```

它工作得很好，具有很好的平滑淡入淡出效果。问题是，我正在尝试在标题单元格（第 0 行）中添加一个指示器，该指示器在单击时会发生变化。要更改该图像，我必须刷新第一行和第二行，这使得过渡看起来很糟糕（嗯，几乎没有那么平滑）。有没有办法在不刷新单元格的情况下更改 UITableViewCell 中的图像？

谢谢

编辑：我想通了！只要在对第二行进行更改之前重新加载第一行，就可以保持平滑过渡。它必须在 [tableView beginUpdates] 内部调用；

```
[self.tableView beginUpdates]; 
[self.tableView reloadRowsAtIndexPaths:[[NSArray alloc] initWithObjects:[NSIndexPath indexPathForRow:0 inSection:indexPath.section], nil] withRowAnimation:UITableViewRowAnimationNone]; 
... 
[self.tableView endUpdates]; 
```

成功了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T18:30:50.747

您还可以子类化一个 tableview 单元格并在其中实现可以从您的视图控制器调用的视图转换。然后您可以调用它而无需重新加载单元格。

```
[(YourCustomCell*)[tableView  cellForRowAtIndexPath:indexPathOfYourCell] fadeInIndicator]; 
```

# hbase - HBase：自定义扫描器仅按前缀检索列

> ID：10707396
> 
> 赞同：3
> 
> 时间：2012-05-22T17:55:40.383
> 
> 标签：hbase

我正在使用扫描仪从 HBase 检索行。我可以通过 addColumn() 方法设置我想要返回的列。但是，我确实需要能够检索以相同前缀开头的可变数量的列。

因此，例如，我想要的所有列都以“USA”开头。我需要检索以它开头的所有列，例如“USA-Virginia”、“USA-Hawaii”等。我不想要“Canada-Quebec”等值。任何地方都没有完整列名的预定义值。我只需要所有以“美国”开头的。有没有办法让 HBase 扫描仪做到这一点？我没有看到太多编写自定义扫描仪的方式。

我正在查看自定义过滤器，但这似乎只是限制了我得到的行，而不是指定我想要返回的列。想法？

我无法更改数据的结构，并且我的所有数据都在一个列族下。

感谢您的任何想法。我正在运行 CDH3u4。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-22T22:35:50.460

您需要的是 ColumnPrefixFilter 通过列前缀过滤键
[http://archive.cloudera.com/cdh/3/hbase/apidocs/org/apache/hadoop/hbase/filter/ColumnPrefixFilter.html](http://archive.cloudera.com/cdh/3/hbase/apidocs/org/apache/hadoop/hbase/filter/ColumnPrefixFilter.html)

像这样的东西应该可以解决问题：-

```
filter = new ColumnPrefixFilter(Bytes.toBytes("USA")) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T07:27:32.457

尝试使用`org.apache.hadoop.hbase.filter.SubstringComparator`，这可能会解决您的问题。

# javascript - 无需下载即可在网页上查看 PDF 文件？

> ID：10707397
> 
> 赞同：1
> 
> 时间：2012-05-22T17:55:45.050
> 
> 标签：javascript, html, pdf, open-source

有一堆我想在网页上显示的 pdf 文件（如谷歌图书）。我不希望他们可以下载，或者至少阻止它。

有没有开源解决方案？HTML5，Javascript？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T17:59:29.807

尝试：

[https://github.com/mozilla/pdf.js](https://github.com/mozilla/pdf.js)

或者：

[http://trapeze.xyrka.com/](http://trapeze.xyrka.com/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T18:41:47.553

这是一个[名为 pdf.js 的 javascript 和 html 格式的 pdf 查看器](https://github.com/mozilla/pdf.js)。但是，为了使 pdf 能够访问浏览器，仍然需要下载它。

如果不下载，就无法在浏览器中显示某些内容。找到原始资产可能需要一些工作（通过 chrome 开发工具中的网络选项卡查看），但仍会下载原始 pdf。

# javascript - 如何将注释文本添加到 Highcharts 图表？

> ID：10707399
> 
> 赞同：5
> 
> 时间：2012-05-22T17:55:46.700
> 
> 标签：javascript, html, css, highcharts

我们想为使用 Highcharts.js 创建的图表添加一些文本注释。

理想情况下，当您将鼠标悬停在图表标题或图表标题旁边的问号上时，我们希望在弹出窗口中显示注释。

例如：

```
<b>Chart Title</b>
<sup>
<a href="#" class="chart-tooltip" title="New Members" data-content="annotation text goes here" data-placement="bottom">?</a></sup> 
```

但是，当我将上面的 html 作为 Highcharts 图表标题文本属性传递时，Highcharts 无法正常显示，它实际上显示的是 html 文本。

是否可以使用 Highcharts 界面完成这项工作？如果是这样，怎么做？

任何其他建议将不胜感激。

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-23T15:31:11.973

以下作品：

```
title: {
    useHTML: true,
    text: 'This is <b>bold</b>'
} 
```

该`useHtml`属性似乎不在我可以看到的文档中，但它似乎对我有用，它也适用于`labels`

# java - 我的 java 小程序被拒绝访问它嵌入的图像

> ID：10707401
> 
> 赞同：0
> 
> 时间：2012-05-22T17:55:53.843
> 
> 标签：java, applet

我正在编写一个 Java 国际象棋 gui。它作为 Eclipse 的小程序运行良好，但我正在努力让它从 HTML 页面在我的本地机器上工作。我正在使用包含在 JAR 中的图像。使用 Eclipse 调试可以正确访问图像。我错过了什么:(？

**HTML 看起来像：**

```
<html>
<applet code="Ginsie" 
        height="300px" width="300px" archive="chess.jar">
</applet>
</html> 
```

**Java 控制台的输出（从浏览器打开）：**

```
java.lang.RuntimeException: java.lang.ExceptionInInitializerError
    at sun.plugin2.applet.Plugin2Manager.createApplet(Unknown Source)
    at sun.plugin2.applet.Plugin2Manager$AppletExecutionRunnable.run(Unknown Source)
    at java.lang.Thread.run(Unknown Source)
Caused by: java.lang.ExceptionInInitializerError
    at BoardPanel.loadSquares(BoardPanel.java:105)
    at BoardPanel.<init>(BoardPanel.java:34)
    at Ginsie.<init>(Ginsie.java:60)
    at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
    at sun.reflect.NativeConstructorAccessorImpl.newInstance(Unknown Source)
    at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(Unknown Source)
    at java.lang.reflect.Constructor.newInstance(Unknown Source)
    at java.lang.Class.newInstance0(Unknown Source)
    at java.lang.Class.newInstance(Unknown Source)
    at sun.plugin2.applet.Plugin2Manager$12.run(Unknown Source)
    at java.awt.event.InvocationEvent.dispatch(Unknown Source)
    at java.awt.EventQueue.dispatchEventImpl(Unknown Source)
    at java.awt.EventQueue.access$000(Unknown Source)
    at java.awt.EventQueue$1.run(Unknown Source)
    at java.awt.EventQueue$1.run(Unknown Source)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.security.AccessControlContext$1.doIntersectionPrivilege(Unknown Source)
    at java.awt.EventQueue.dispatchEvent(Unknown Source)
    at java.awt.EventDispatchThread.pumpOneEventForFilters(Unknown Source)
    at java.awt.EventDispatchThread.pumpEventsForFilter(Unknown Source)
    at java.awt.EventDispatchThread.pumpEventsForHierarchy(Unknown Source)
    at java.awt.EventDispatchThread.pumpEvents(Unknown Source)
    at java.awt.EventDispatchThread.pumpEvents(Unknown Source)
    at java.awt.EventDispatchThread.run(Unknown Source)
Caused by: java.security.AccessControlException: access denied (java.io.FilePermission ..\img\squares\Wood\BSQUARE.jpg read)
    at java.security.AccessControlContext.checkPermission(Unknown Source)
    at java.security.AccessController.checkPermission(Unknown Source)
    at java.lang.SecurityManager.checkPermission(Unknown Source)
    at java.lang.SecurityManager.checkRead(Unknown Source)
    at java.io.File.canRead(Unknown Source)
    at javax.imageio.ImageIO.read(Unknown Source)
    at Square.<clinit>(Square.java:47)
    ... 24 more
Exception : java.lang.RuntimeException: java.lang.ExceptionInInitializerError 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-22T18:03:11.223

从堆栈跟踪来看，您似乎正在调用 javax.imageio.ImageIO.read(File)。在 Eclipse 中，它可能会起作用，因为它正在访问本地文件系统来读取图像。尝试使用 Class.getResourceAsStream() 从类路径中读取文件（即从 jar 中），然后将 InputStream 传递给 javax.imageio.ImageIO.read(InputStream)。

# git - 显示不包含提交的分支

> ID：10707404
> 
> 赞同：9
> 
> 时间：2012-05-22T17:55:57.953
> 
> 标签：git, branch, dvcs

`git branch -a --contains <hash>`给了我所有那些包含`hash`. 我想要的是`git branch -a --no-contains <hash>`。不幸的是，似乎没有命令可以完成此操作，所以我认为解决方案类似于：

`git branch -a | grep -v output of(git branch -a --contains)`但我的 bash 不能胜任这项任务。

[显示提交 A 已打开且未提交 B 的所有分支？](https://stackoverflow.com/questions/10187302/show-all-branches-that-commit-a-is-on-and-commit-b-is-not-on)似乎适用，但该方法似乎比必要的复杂。

完成上述任务的最佳/最简单方法是什么？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-22T19:17:56.413

`grep`有一个`-F`匹配固定字符串的选项。对你正在做的事情很有用。

```
git branch -a | grep -vF "$(git branch -a --contains <hash>)" 
```

不幸的是，`-F`将过滤掉具有部分匹配的分支名称。正如 antak 所建议的，我们可以使用`comm`更可靠的差异来代替。

```
git branch -a | sort | comm -3 - <(git branch -a --contains <hash> | sort) 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2017-06-21T23:39:44.163

该`--no-contains`标志是在[Git 2.13](https://github.com/git/git/blob/v2.13.0/Documentation/RelNotes/2.13.0.txt)中添加的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-11-27T02:50:43.547

由于如果分支名称部分匹配，则接受的答案将发生冲突，这是处理这种情况的答案。

```
git branch -a | comm -3 - <(git branch -a --contains <hash>) 
```

`| sort``comm: file 1 is not in sorted order`如果警告打扰您，可以将其添加到两个命令的末尾。但是，这不是获得正确结果所必需的，因为两个输入的顺序是等价的。

# wordpress-theming - 添加子菜单时拒绝 Wordpress 权限

> ID：10707405
> 
> 赞同：0
> 
> 时间：2012-05-22T17:56:02.030
> 
> 标签：wordpress-theming, wordpress

在我的设置菜单 n wordpress 管理面板下创建子菜单时遇到问题。我已经正确地完成了所有事情，而且我也有办法解决这个问题。但我真正想知道为什么会出现问题。

```
add_action('admin_menu', 'options_page');
function options_page() {

add_submenu_page(
        'options-general.php',
        'Options page',
        'Options page',
        'manage_options',
        'my-option-page',
        'option_config');   
    } 
```

这很好用，没有问题。但是，当我尝试将“我的选项页面”更改为“ `__FILE__`”时，它停止工作，说我没有足够的权限。我在[http://www.sitepoint.com/wordpress-options-panel/](http://www.sitepoint.com/wordpress-options-panel/)有本教程， 但它不起作用。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-14T03:13:31.283

WordPress 首席开发人员 Mark Jaquith 在 2009 年发推文说：“如果您在 WordPress 插件中的 add_submenu_page() 或 add_*_page() 函数调用中使用**FILE**，那么您做错了。使用唯一的字符串。”

**FILE**是否已用于菜单或子菜单？这可能是一个原因；虽然我当然会删除**FILE**的使用。

另一个原因可能是第一个参数“parent slug”不作为菜单页面存在。或者如果是，它以不同的名称存在。

# video - 嵌入式 YouTube 播放器视频质量参数

> ID：10707411
> 
> 赞同：3
> 
> 时间：2012-05-22T17:56:15.950
> 
> 标签：video, youtube, youtube-api

请帮我弄清楚我必须使用哪个参数及其值来设置 YouTube 视频的高清质量（或我需要的任何质量）。

在[https://developers.google.com/youtube/player_parameters](https://developers.google.com/youtube/player_parameters)我看不到任何有用的...

我基本上使用这段代码

```
http://www.youtube.com/embed/r5nnlG3hEfU?autoplay=1&amp;controls=0 
```

比如我需要240，或者720这个参数怎么传？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T08:52:10.847

添加参数`vq=hd720`将实现这一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T12:26:02.890

它曾经是 &hd=1 但自上周 ~10/5/12 Google 似乎已阻止使用 HD 参数，现在只有用户可以从播放器控件手动设置 HD。

很糟糕，我的网站[http://goproheroes.com](http://goproheroes.com)依赖于是否设置了这个 HD 参数。我找不到有关更改的任何官方消息，我猜这是为了节省带宽成本，但我希望看到有关它的官方声明。

编辑：

好的，我有 720p 可以通过使用嵌入代码中的 &version=2 一直回到他们最旧的旧版播放器 (AS2) 再次工作

# google-app-engine - GAE 上的 webapp2、self.request.path 更改问题

> ID：10707412
> 
> 赞同：0
> 
> 时间：2012-05-22T17:56:21.180
> 
> 标签：google-app-engine, python-2.7, webapp2

在我的 GAE 应用程序中，我`webapp2.RequestHandler.initialize`用来对请求执行自定义操作。
直到几天前，更改`os.environ['PATH_INFO']`确实影响了在 RequestHandler 上调用 self.request.path 并且它反映了更改的请求路径。（这在 SDK 上仍然可以正常工作）

现在它不再起作用了。当然，我因此遇到了很大的问题。我知道这可能是一个极端情况，但这种变化的原因是什么？

受影响的代码：

```
class BaseHandler(webapp2.RequestHandler):

    def initialize(self, request, response):    
        ns, path = get_namespace(os.environ)
        namespace_manager.set_namespace(ns)
        os.environ['namespace'] = ns

        # request.path reflects the incoming path

        path = os.environ.get('PATH_INFO')
        prefix = '/%s'%ns

        if ns and path.startswith(prefix):
            # the request.path has to be changed here...

            newpath = path[len(prefix):]
            # here i change the path_info in os.environ to the new 
            # path
            os.environ['PATH_INFO'] = newpath or '/'

        super(BaseHandler, self).initialize(request, response)

        # request.path and self.request.path here are still unchanged.
        # up to a few days ago here the path was reflecting the changes 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T01:42:33.727

`os.environ`包含 CGI 风格的环境变量。诸如 webapp(2) 之类的 WSGI 应用程序可能会从那里获取它们的信息（或不从那里获取信息，具体取决于容器），但欢迎它们——甚至可能——复制而不是引用原始数据。没有理由假设操作`os.environ`会影响您的 WSGI 应用程序，这样做是一个坏主意，原因如下：

1.  它打破了抽象
2.  它可能不是线程安全的
3.  *真恶心*_

 *相反，直接修改请求对象（例如，通过分配给`request.path`），如果您必须 - 或者更好，将相关信息存储在您的子处理程序可以访问的请求处理程序的属性中。*

# java - 确定有多少对象符合 GC 条件

> ID：10707414
> 
> 赞同：0
> 
> 时间：2012-05-22T17:56:22.627
> 
> 标签：java, garbage-collection

SCJP第三章有一个问题。
请参阅以下代码：

```
public class Sample_1 {

    Short story = 200;

    Sample_1 go(Sample_1 sample){
        sample = null;
        return sample;
    }

    public static void main(String a[]){
        Sample_1 sample1 =new  Sample_1();
        Sample_1 sample2 =new  Sample_1();
        Sample_1 sample3 = sample1.go(sample2);

        sample1 = null;

        //DO STUFF

    }

} 
```

问题：有多少对象符合 GC@line 条件`//DO STUFF`？

options:
0
1
2
Compilation Fails
Its not possible to know
运行时抛出异常

书上说：正确的断言是 2。它说“只有一个 Sample_1 对象（sample1）有资格进行 GC，但它有与之关联的 Short 值。所以有两个对象符合 GC”

仍然无法理解这个答案。我们已经在清空 sample1 对象。在我看来，GC 没有对象。

任何的想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T17:59:27.013

由于 sample1 为空，分配给 sample1 的内存和它包含的 Short 变量符合垃圾回收的条件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T19:07:04.230

> 仍然无法理解这个答案。我们已经在清空 sample1 对象。在我看来，GC 没有对象。

将变量设置为 null 并不意味着它被 GC'ed，这意味着它有资格被 GC'ed。您无法以编程方式控制 GC 何时运行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-23T09:13:51.163

得到了解决方案......这里......有三个对象sample1，sample2，sample3。

sample3 为空，所以不需要 GV。我的意思是它没有在整个程序中初始化。sample2 一直在使用直到最后一条语句。所以 JVM 不能 GV 它。

我们正在使 sample1 归零。所以它被添加到 GV 队列中。并且 sample1 本身有 Short 对象。所以有两个对象准备好 GV。

谢谢，甘扬。

# java - 使用 Generic Motion 侦听器时未找到类定义

> ID：10707421
> 
> 赞同：0
> 
> 时间：2012-05-22T17:56:56.167
> 
> 标签：java, android

我的代码已设置，`API 7`然后我将其更改为，`API 15`以便我可以得到`onGenericMotionListener`

现在我将我的活动定义如下：

```
 newGame.setOnClickListener(new View.OnClickListener() {

            public void onClick(View v) {
                vibe.vibrate(vibValue);

                   if (levelStage == 1 && levelId == 1)
                   {       
                       Intent myIntent = new Intent(v.getContext(), Level.class);
                       startActivity(myIntent);
                   }
                   else
                       displayAlertForNewGame(v.getContext());
            }
        }); 
```

每当我尝试启动此活动时，我都会收到错误`java.lang.NoClassDefFoundError`

使用此代码开始活动

```
Intent myIntent = new Intent(v.getContext(),myActivity.class);
                        startActivity(myIntent);

05-22 22:49:20.416: E/AndroidRuntime(6327): FATAL EXCEPTION: main
05-22 22:49:20.416: E/AndroidRuntime(6327): java.lang.NoClassDefFoundError: com.code.global.Level
05-22 22:49:20.416: E/AndroidRuntime(6327):     at com.umar.regGame.MainMenu$1.onClick(MainMenu.java:67)
05-22 22:49:20.416: E/AndroidRuntime(6327):     at android.view.View.performClick(View.java:2449)
05-22 22:49:20.416: E/AndroidRuntime(6327):     at android.view.View$PerformClick.run(View.java:9027)
05-22 22:49:20.416: E/AndroidRuntime(6327):     at android.os.Handler.handleCallback(Handler.java:587)
05-22 22:49:20.416: E/AndroidRuntime(6327):     at android.os.Handler.dispatchMessage(Handler.java:92)
05-22 22:49:20.416: E/AndroidRuntime(6327):     at android.os.Looper.loop(Looper.java:123)
05-22 22:49:20.416: E/AndroidRuntime(6327):     at android.app.ActivityThread.main(ActivityThread.java:4627)
05-22 22:49:20.416: E/AndroidRuntime(6327):     at java.lang.reflect.Method.invokeNative(Native Method)
05-22 22:49:20.416: E/AndroidRuntime(6327):     at java.lang.reflect.Method.invoke(Method.java:521)
05-22 22:49:20.416: E/AndroidRuntime(6327):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
05-22 22:49:20.416: E/AndroidRuntime(6327):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
05-22 22:49:20.416: E/AndroidRuntime(6327):     at dalvik.system.NativeStart.main(Native Method) 
```

最好的祝福

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T05:17:24.387

问题来自于课堂`com.code.global.Level`。这个类是从哪里来的？它在一个罐子里，你是否以正确的方式将它包含在你的构建路径中？

# php - PHP/MySql 到 javascript 不工作

> ID：10707423
> 
> 赞同：3
> 
> 时间：2012-05-22T17:56:59.543
> 
> 标签：php, javascript, mysql

我打印 MySQL 的方式有问题，而 javascript 没有执行它。这是一个例子。

```
square[1] = "asdfasdfadsf"; 
```

当我从我的 MySQL 数据库打印“ `asdfasdfadsf`”时，javascript 不起作用。但是，如果我只是在静态 HTML 中键入“asdfasdfadsf”，它就可以正常执行。我已经尝试了尽可能多的 PHP 函数和字符集转换。请帮忙！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-22T18:01:17.463

我建议使用[`json_encode`](http://php.net/manual/en/function.json-encode.php)PHP 函数。除了正确打印字符串外，它还转义了所有危险字符。

```
square[1] = <?php echo json_encode($my_string); ?>; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-22T17:58:31.953

您需要在数据库中的字符串周围添加引号。

```
// Add quotes around the call which prints the vale from PHP.
// this turns it into a JavaScript string.
square[1] = '<?php echo "asdfasdfadsf"; ?>';
//----------^^----------------------------^^

// Or...
square[1] = '<?php echo $row["value_from_your_db"]; ?>'; 
```

注意：`json_encode()`如果这不仅仅是一个可能有自己的内部引号需要额外转义的简单字符串，则建议使用。

# java - 多线程 Java 应用程序中的 SQLite

> ID：10707434
> 
> 赞同：23
> 
> 时间：2012-05-22T17:57:34.733
> 
> 标签：java, jdbc, sqlite, locked

我编写了一个 java 应用程序，它偶尔将事件从多个线程记录到 SQLite 数据库。我注意到我可以通过同时产生少量事件相对容易地触发 SQLite 的“数据库锁定”错误。这促使我编写了一个模拟最坏情况行为的测试程序，我对 SQLite 在这个用例中的表现如此糟糕感到惊讶。下面发布的代码只是将五条记录添加到数据库中，首先顺序获取“控制”值。然后同时添加相同的五个记录。

```
import java.sql.*;

public class Main {
   public static void main(String[] args) throws Exception {
      Class.forName("org.sqlite.JDBC");
      Connection conn = DriverManager.getConnection("jdbc:sqlite:test.db");

      Statement stat = conn.createStatement();
      stat.executeUpdate("drop table if exists people");
      stat.executeUpdate("create table people (name, occupation)");
      conn.close();

      SqlTask tasks[] = {
         new SqlTask("Gandhi", "politics"),
         new SqlTask("Turing", "computers"),
         new SqlTask("Picaso", "artist"),
         new SqlTask("shakespeare", "writer"),
         new SqlTask("tesla", "inventor"),
      };

      System.out.println("Sequential DB access:");

      Thread threads[] = new Thread[tasks.length];
      for(int i = 0; i < tasks.length; i++)
         threads[i] = new Thread(tasks[i]);

      for(int i = 0; i < tasks.length; i++) {
         threads[i].start();
         threads[i].join();
      }

      System.out.println("Concurrent DB access:");

      for(int i = 0; i < tasks.length; i++)
         threads[i] = new Thread(tasks[i]);

      for(int i = 0; i < tasks.length; i++)
         threads[i].start();

      for(int i = 0; i < tasks.length; i++)
         threads[i].join();
   }

   private static class SqlTask implements Runnable {
      String name, occupation;

      public SqlTask(String name, String occupation) {
         this.name = name;
         this.occupation = occupation;
      }

      public void run() {
         Connection conn = null;
         PreparedStatement prep = null;
         long startTime = System.currentTimeMillis();

         try {
            try {
               conn = DriverManager.getConnection("jdbc:sqlite:test.db");
               prep = conn.prepareStatement("insert into people values (?, ?)");

               prep.setString(1, name);
               prep.setString(2, occupation);
               prep.executeUpdate();

               long duration = System.currentTimeMillis() - startTime;
               System.out.println("   SQL Insert completed: " + duration);
            }
            finally {
               if (prep != null) prep.close();
               if (conn != null) conn.close();
            }
         }
         catch(SQLException e) {
            long duration = System.currentTimeMillis() - startTime;
            System.out.print("   SQL Insert failed: " + duration);
            System.out.println(" SQLException: " + e);
         }
      }
   }
} 
```

这是我运行此 java 代码时的输出：

```
 [java] Sequential DB access:
 [java]    SQL Insert completed: 132
 [java]    SQL Insert completed: 133
 [java]    SQL Insert completed: 151
 [java]    SQL Insert completed: 134
 [java]    SQL Insert completed: 125
 [java] Concurrent DB access:
 [java]    SQL Insert completed: 116
 [java]    SQL Insert completed: 1117
 [java]    SQL Insert completed: 2119
 [java]    SQL Insert failed: 3001 SQLException: java.sql.SQLException: database locked
 [java]    SQL Insert completed: 3136 
```

顺序插入 5 条记录大约需要 750 毫秒，我预计并发插入需要大致相同的时间。但是您可以看到，给定 3 秒的超时，他们甚至都没有完成。我还用 C 语言编写了一个类似的测试程序，使用 SQLite 的本机库调用，同时插入完成的时间与并发插入大致相同。所以问题出在我的java库上。

这是我运行 C 版本时的输出：

```
Sequential DB access:
  SQL Insert completed: 126 milliseconds
  SQL Insert completed: 126 milliseconds
  SQL Insert completed: 126 milliseconds
  SQL Insert completed: 125 milliseconds
  SQL Insert completed: 126 milliseconds
Concurrent DB access:
  SQL Insert completed: 117 milliseconds
  SQL Insert completed: 294 milliseconds
  SQL Insert completed: 461 milliseconds
  SQL Insert completed: 662 milliseconds
  SQL Insert completed: 862 milliseconds 
```

我用两个不同的 JDBC 驱动程序（[http://www.zentus.com/sqlitejdbc](http://www.zentus.com/sqlitejdbc)和[http://www.xerial.org/trac/Xerial/wiki/SQLiteJDBC](http://www.xerial.org/trac/Xerial/wiki/SQLiteJDBC)）和 sqlite4java 包装器尝试了这段代码。每次结果都差不多。有没有人知道没有这种行为的java SQLite 库？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-05-22T18:21:34.810

这是[核心 SQLite 库](http://www.sqlite.org/)的问题- 不是任何 Java 包装器。SQLite 使用基于文件系统的锁来实现进程之间的并发访问同步，因为作为嵌入式数据库，它没有专门的进程（服务器）来调度操作。由于代码中的每个线程都创建自己的数据库连接，因此它被视为一个单独的进程，同步通过基于文件的锁进行，这比任何其他同步方法都慢得多。

此外，SQLite 不支持每行锁定（还没有？）。本质上，整个数据库文件对于每个操作都会被[锁定](http://www.sqlite.org/lockingv3.html)。如果你很幸运并且你的文件系统支持字节范围锁，那么多个读者可能同时访问你的数据库，但你不应该假设这种行为。

默认情况下，核心 SQLite 库[允许多个线程同时使用同一个连接](http://www.sqlite.org/threadsafe.html)而没有问题。我认为任何理智的 JDBC 包装器都将允许 Java 程序中的这种行为，尽管我还没有真正尝试过。

因此，您有两种解决方案：

*   在所有线程之间共享相同的 JDBC 连接。

*   由于 SQLite 开发人员似乎认为[线程是邪恶](http://www.sqlite.org/faq.html#q6)的，因此最好让*一个*线程处理所有数据库操作并使用 Java 代码自行序列化 DB 任务......

你可能想看看[我的这个老问题](https://stackoverflow.com/questions/5181927/efficient-way-to-ensure-unique-rows-in-sqlite3)——随着时间的推移，它似乎已经积累了一些关于提高 SQLite 更新性能的技巧。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-11-24T10:20:18.593

我对多个线程使用相同的连接。另外我必须使 db-write 方法同步，否则我仍然会得到 bussy 错误

# ruby-on-rails-3 - 如何根据条件在 Rails 视图中为链接添加前缀？

> ID：10707436
> 
> 赞同：0
> 
> 时间：2012-05-22T17:57:36.860
> 
> 标签：ruby-on-rails-3

我有一些现有的路线，例如：

```
/people/:id
/events/:id 
```

等等，在我的`routes.rb`.

现在我想为我的附属客户提供自定义样式。我目前的想法是我的路线将如下所示：

```
/people/:id
/events/:id
...

/affiliates/:id/people/:id
/affiliates/:id/events/:id
... 
```

等等。

但是，我想确保**如果我在附属页面上，我****在视图中生成的链接总是带有前缀`/affiliates/:id`**。（我不想每次使用`url_for`或`path_for`助手时都要写一个“这是一个附属机构吗？”条件。）

最好的方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T23:58:44.587

在我的选择中，最好在控制器内部而不是在视图中处理该逻辑。

你可以有如下的东西：

```
class EventController < ApplicationController
  .
  .
  def show
    @event = Event.find(params[:id])
    if(current_user.is_affiliate?)
      #render the affiliate view
    else
      #renders regular view
    end
  end 
```

在您看来，您可以简单地拥有

```
<%= link_to "Event", @event %> 
```

这样视图就不需要管理该逻辑，您可以将其保留在控制器上。

# java - 获取所有分享在 youtube 上上传的特定视频的人的 facebook id

> ID：10707438
> 
> 赞同：0
> 
> 时间：2012-05-22T17:57:47.247
> 
> 标签：java, facebook-graph-api, youtube-api

假设我在 youtube 上上传了一个视频，有人通过单击 youtube 上的“分享”按钮在 facebook 上分享了该视频。我怎么能得到那个人的 facebook id 或用户名。我尝试使用 youtube gdata api，也尝试了 facebook graph api，但未能成功。我很确定这是可能的，因为我已经在网站上看到了此功能。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T19:14:34.747

这只有 YouTube Facebook 应用程序的开发人员才能知道。您*可以获得*共享特定视频*的当前用户的*所有朋友。

例如，

`SELECT link_id, owner, owner_comment, created_time, title, summary, url, picture, image_urls FROM link WHERE owner in (select uid2 from friend where uid1 = me() limit 5) and strpos(url, 'lmDTSQtK20c') >= 0`

不是很有效，但它确实有效。

第二种方法是使用 /search

`/search?q=http://www.youtube.com/watch?v=YOUTUBEID&type=post`

那应该搜索公共帖子

# android - 应用程序再次启动，而不是运行当前活动

> ID：10707442
> 
> 赞同：0
> 
> 时间：2012-05-22T17:57:57.507
> 
> 标签：android

我有一个问题，在我的移动设备上测试我的版本时，我注意到了这个[链接](https://stackoverflow.com/questions/3042420/home-key-press-behaviour/10706598#10706598)中描述的效果。总而言之，安装我的应用程序后，当我立即启动它时，它是从不同的“根”启动的，而不是从主屏幕启动它时。效果是，当我在启动它后按下主页按钮然后想要返回到正在运行的活动时，应用程序会再次启动（因为它是从不同的上下文启动的）。在此链接上也提出了一个解决方案，但我不太喜欢它。所以我最后想问的是，这种效果是否也会出现在从市场上下载我的应用程序的用户身上？因为如果，那我真的会很惊讶，因为直到它发生在我身上，我根本没有读过它，我也没有听说有人遇到过这个问题。

提前非常感谢，最好的问候 eMu

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T04:14:02.623

以下是我正在使用的代码：

```
@Override
protected void onCreate(Bundle intr)
{
    super.onCreate(intr);
    setContentView(R.layout.intro);

  new Handler().postDelayed(new Runnable()
      {
        @Override
        public void run() {
            finish();

        Intent i = new Intent(this, MyActivity.class);
        startActivity(i);                       

    } 
  }, _splashTime);
} 
```

启动我的 Activity 时我可以设置任何标志，这样它就不会被再次调用或被新的标志替换（如 singleTop 启动模式）？

# javascript - 使用d3 js库的数据方法将事件绑定到动态生成的内容

> ID：10707452
> 
> 赞同：0
> 
> 时间：2012-05-22T17:58:36.853
> 
> 标签：javascript, d3.js

我正在尝试将单击事件绑定到使用 d3.js 的数据动态生成的元素。

```
d3.select("#mylist").selectAll('li').data(data_arr).enter().append("li").html(
        function(d)
        {
            var element = document.createElement('div');
            element.innerHTML = '<div id="innerDiv"></div>';

            var divToClick = element.querySelector('#innerDiv');
            //Using jquery to get cross browser event binding
            $(divToClick).click(function(){
                alert('hello!');
            });

            return element.innerHTML;
       }); 
```

我知道问题是我正在返回一个字符串（innerHTML），但是如果我返回它不起作用的元素。有什么帮助吗？

（真正的代码要复杂得多，我只是在这里复制了重要的部分）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-22T19:05:17.357

一种更 d3 的方法是

```
d3.select("#mylist").selectAll('li').data(data_arr).enter()
  .append("li")
  .append("div")
  .on("click", function() { alert("hello!"); }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T21:01:06.903

这是答案。

```
 var li_arr = d3.select("#mylist").selectAll('li').data(data_arr).enter().append("li").html(
    function(d)
    {
        var element = document.createElement('div');
        element.innerHTML = '<div id="innerDiv"></div>';
        return element.innerHTML;
   });

 li_arr.select('#innerDiv').each(function(d,i)
       {
            var mydiv = d3.select(this);
            mydiv.on('click',function(){
                alert('hello');
            });
       }); 
```

# iphone - 为什么我的崩溃报告没有符号化？

> ID：10707453
> 
> 赞同：13
> 
> 时间：2012-05-22T17:58:38.213
> 
> 标签：iphone, objective-c, ios, xcode

我正在使用 Xcode 4.3.1。崩溃发生在我的设备上，所以我连接它并打开 Organizer，转到我的设备日志，找到崩溃报告，它的内容如下：

```
Exception Type:  EXC_CRASH (SIGABRT)
Exception Codes: 0x00000000, 0x00000000
Crashed Thread:  0

Last Exception Backtrace:
0   CoreFoundation                  0x3514488f __exceptionPreprocess + 163
1   libobjc.A.dylib                 0x3656b259 objc_exception_throw + 33
2   CoreFoundation                  0x35144789 +[NSException raise:format:] + 1
3   CoreFoundation                  0x351447ab +[NSException raise:format:] + 35
4   CoreFoundation                  0x350b168b -[__NSCFDictionary setObject:forKey:] + 235
5   myapp                           0x0015b4a7 0xe8000 + 472231
6   myapp                           0x0018add1 0xe8000 + 667089
7   myapp                           0x0013cd5b 0xe8000 + 347483
8   Foundation                      0x30ffb60d __NSFireTimer + 145
9   CoreFoundation                  0x35118a33 __CFRUNLOOP_IS_CALLING_OUT_TO_A_TIMER_CALLBACK_FUNCTION__ + 15
10  CoreFoundation                  0x35118699 __CFRunLoopDoTimer + 365
11  CoreFoundation                  0x3511726f __CFRunLoopRun + 1207
12  CoreFoundation                  0x3509a4a5 CFRunLoopRunSpecific + 301
13  CoreFoundation                  0x3509a36d CFRunLoopRunInMode + 105
14  GraphicsServices                0x36396439 GSEventRunModal + 137
15  UIKit                           0x32190e7d UIApplicationMain + 1081
16  myapp                           0x000f6aff 0xe8000 + 60159
17  myapp                           0x000e9370 0xe8000 + 4976

Thread 0 name:  Dispatch queue: com.apple.main-thread
Thread 0 Crashed:
0   libsystem_kernel.dylib          0x34f3832c __pthread_kill + 8
1   libsystem_c.dylib               0x36e34208 pthread_kill + 48
2   libsystem_c.dylib               0x36e2d298 abort + 88
3   libc++abi.dylib                 0x30af9f64 abort_message + 40
4   libc++abi.dylib                 0x30af7346 _ZL17default_terminatev + 18
5   libobjc.A.dylib                 0x3656b350 _objc_terminate + 140
6   libc++abi.dylib                 0x30af73be _ZL19safe_handler_callerPFvvE + 70
7   libc++abi.dylib                 0x30af744a std::terminate() + 14
8   libc++abi.dylib                 0x30af881e __cxa_rethrow + 82
9   libobjc.A.dylib                 0x3656b2a2 objc_exception_rethrow + 6
10  CoreFoundation                  0x3509a506 CFRunLoopRunSpecific + 398
11  CoreFoundation                  0x3509a366 CFRunLoopRunInMode + 98
12  GraphicsServices                0x36396432 GSEventRunModal + 130
13  UIKit                           0x32190e76 UIApplicationMain + 1074
14  myapp                           0x000f6af8 0xe8000 + 60152
15  myapp                           0x000e9368 0xe8000 + 4968 
```

我认为 Xcode 会自动为我处理象征性的崩溃报告？为什么我没有得到任何行号或方法？为什么我的异常代码是 0x00000000？

我尝试[了这里找到的方法](https://stackoverflow.com/a/4954949/458960)，但是当我输入任何内存地址时，输出就是相同的内存地址。这是我可以从崩溃日志中获得的最多信息，还是这里有问题？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-22T18:43:03.623

要表示崩溃报告，您需要该确切构建的 dSYM 包。我猜这是一个未存档的调试版本，因此下次构建应用程序时 dSYM 也会被覆盖。这就是组织者无法完全象征崩溃报告的原因。

您提到的方法仅在二进制文件没有剥离符号时才有效，即使那样它也不会报告行号！因此，与其对应用程序二进制文件使用它，不如将它与 dSYM 一起使用。也许你很幸运，新的 dSYM 仍然有一些有用的信息。

`atos -arch armv7 -o 'appname.app.dSYM' 0x0015b4a7`

崩溃本身可能会将 NSDictionary 值设置为例如 nil 键。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-09-24T22:46:27.143

希望这可以帮助其他人解决同样的问题，对我有用的是在存档目录中运行以下命令（看起来像 /Users/my_user/Library/Developer/Xcode/Archives/2012-09-24，所以先cd进去）

```
mdimport . 
```

之后尝试运行 symbolicatecrash 脚本。在 XCode 中，转到您的 Organizer、Device Logs，然后通过右键单击崩溃日志选择“Re-Symbolicate Log”。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-10-22T21:37:02.137

通过将崩溃报告拖到 Organizer->Devices->Library->Device Logs 中，我无法让 XCode 4.5.1 进行符号化。

我也无法通过指定`dSYM`@Kerni 上面的帖子来获得崩溃的符号地址。

我用过`atos`，但我只能通过在文件中指定符号文件的完整路径`xcarchive`（实际上是一个目录）来让它工作。例子：

```
cd dir_where_the_xcarchive_is
atos -arch armv7 -o myApp\ 9-18-12\ 5.28\ PM.xcarchive/dSYMs/myApp.app.dSYM/Contents/Resources/DWARF/myApp   0x0001943a 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-19T05:21:33.970

关于您关于异常代码的问题...

```
Exception Codes: 0x00000000, 0x00000000 
```

...[这个 Apple Technical Note](http://developer.apple.com/library/ios/#technotes/tn2151/_index.html)可能会回答您的问题。简而言之，此崩溃报告不是由标准记录的崩溃类型生成的。

> 在崩溃日志的大约 16 行中，您将看到一行以文本开头，后跟一个或多个十六进制值，这些是特定于处理器的代码，可以为您提供有关崩溃性质的更多信息。您可以从这些代码中看出应用程序是否由于编程错误（例如，错误的内存访问、异常等）而崩溃，或者应用程序是否由于其他原因而终止，例如：
> 
> 异常代码**0x8badf00d**表示应用程序已被 iOS 终止，因为发生了看门狗超时。应用程序启动、终止或响应系统事件的时间过长。造成这种情况的一个常见原因是在主线程上进行同步网络。异常代码**0xbad22222**表示 VoIP 应用程序已被 iOS 终止，因为它恢复得太频繁了。异常代码**0xdead10cc**表示应用程序已被 iOS 终止，因为它在后台运行时占用了系统资源（如地址簿数据库）。异常代码**0xdeadfa11**表示应用程序已被用户强制退出。当用户首先按住开/关按钮直到出现“滑动关机”，然后按住主页按钮时，会发生强制退出。可以合理地假设用户已经这样做是因为应用程序没有响应，但不能保证 - 强制退出将适用于任何应用程序。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-19T05:26:09.017

请改用[Crashlytics](http://try.crashlytics.com/)。

它提供有关实时崩溃报告的即时（通过电子邮件通知）以及发生崩溃的确切行号。

# air - 如何在 FDT 5.5 中为一个 AIR 目标设置多个描述符文件？

> ID：10707457
> 
> 赞同：3
> 
> 时间：2012-05-22T17:58:52.157
> 
> 标签：air, fdt

在 FDT 5.5 中，桌面 AIR 应用程序的启动配置被删除，并且可以选择同时使用各种 description.xmls 部署和测试一个目标（例如桌面）。

现在，每次我想为一个目标使用不同的 description.xml 时，我都必须在项目属性中的“构建”选项卡中手动更改它。

我也想使用 FDT 的 GUI 而不是 ANT。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T17:58:52.750

使用 FDT 的 GUI，每个 AIR 目标（iOS、Android、桌面、黑莓）只能链接到每个项目自己的 description.xml。因此，可以想象，一个项目一次只能有 4 个唯一的描述符文件处于活动状态。

如果您希望每个目标有多个 description.xml 文件（例如 4 个仅适用于 Android 的唯一 description.xml 文件），并且根本不使用 ANT，那么最好的做法是为每个目标“风味”创建单独的项目并拥有每个项目都继承自一个基础项目。然后使用启动器链立即启动所有配置（如果使用 ADL）。

对于部署，由于无论如何您都必须通过项目属性来重新部署应用程序（用于发布），所以您最好在导出应用程序的过程中更改 description.xml。

![使用项目引用](../Images/6969a13260d15129d83dc3a06ec0634f.png) ![使用启动器链](../Images/e103622a42271193e0b5fdadc8079914.png)

# ruby-on-rails - 通过 ssh 访问网站

> ID：10707460
> 
> 赞同：0
> 
> 时间：2012-05-22T17:58:53.717
> 
> 标签：ruby-on-rails, ssh

我是一个糟糕的网络开发初学者，对各种网络概念感到困惑：] 我想在服务器上设置一个网站，使用 Rails 或其他框架。但我没有完全访问服务器的权限。我想知道这是否可能？

**我可以做什么**

我可以通过 SSH 连接到服务器，这意味着 22 端口已打开。我可以使用 sudo 权限安装软件包。

**我想要的是**

例如，我有一个由 rails 构建的网站，我想让它在服务器上运行。

**编辑1**

感谢您的回答，但我想在服务器上运行一个网站，我可以从其他地方访问它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T18:02:31.007

我们需要知道更多。该服务器托管在哪里，谁使用什么包以及在什么包上？

服务器运行的是什么操作系统 - 安装 Rails 可能非常容易 - 也可能很困难，具体取决于您已经拥有的。例如

```
"sudo apt-get install rails" 
```

将安装rails，但不会安装您可以运行的实时服务器，例如Passenger或Ngix。

使用像Engineyard这样可以免费试用的人可能会容易得多。他们会为您处理这一切！

# ruby - 如何从字符串中删除第二个字符？

> ID：10707464
> 
> 赞同：-1
> 
> 时间：2012-05-22T17:59:05.173
> 
> 标签：ruby, string

如果我想从字符串中删除最后一个字符，那么我只需使用

```
'string'[0..-1] 
```

但是如何从字符串中删除第二个字符？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-22T18:24:37.777

最简单的方法是

```
str[1] = ''   #1.9.3 
```

或者

```
str[1,1] = '' #1.8.7 
```

我不确定它是否可以在 Jruby 中工作，因为它有不同的处理字符串的方式。如果它不起作用，请使用 @Finbarr 的方法，它应该可以工作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-22T19:43:15.390

除了这个问题，对于现在来说，哪种方法最快可能**很****重要**。

我用其他答案和切片解决方案做了一个基准测试！和`sub!`。

```
require 'benchmark'
N = 100_000 #Number of Test loop

STR = '0123456789'

REGEXP = /\A(.)./
Benchmark.bmbm(10) {|b|

  b.report('str[0].chr+str[2..-1]') { N.times { 
        str = STR.dup
        str = str[0].chr+str[2..-1]
      }}
  b.report('str[1]') { N.times { 
        str = STR.dup
        str[1] = ''
      }}
  b.report('slice!') { N.times { 
        str = STR.dup
        str.slice!(1)
      }}          
  b.report('sub!') { N.times { 
        str = STR.dup
        str.sub!(/\A(.)./, '\1')
      }}          
  b.report('sub!/REGEXP') { N.times { 
        str = STR.dup
        str.sub!(REGEXP, '\1')  #Avoid reinitialization of regex for each loop
      }}
} #Benchmark 
```

我的结果（Windows，Ruby 1.9.3）

```
Rehearsal ---------------------------------------------------------
str[0].chr+str[2..-1]   0.203000   0.000000   0.203000 (  0.171875)
str[1]                  0.094000   0.000000   0.094000 (  0.109375)
slice!                  0.094000   0.000000   0.094000 (  0.125000)
sub!                    0.250000   0.016000   0.266000 (  0.265625)
sub!/REGEXP             0.265000   0.016000   0.281000 (  0.234375)
------------------------------------------------ total: 0.938000sec

                            user     system      total        real
str[0].chr+str[2..-1]   0.188000   0.000000   0.188000 (  0.171875)
str[1]                  0.125000   0.000000   0.125000 (  0.109375)
slice!                  0.172000   0.000000   0.172000 (  0.125000)
sub!                    0.218000   0.015000   0.233000 (  0.265625)
sub!/REGEXP             0.282000   0.000000   0.282000 (  0.250000) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-22T18:05:37.760

我假设您的意思是删除第二个字符并保留字符串的其余部分。

你好 => 你好

`s[0].chr+s[2..-1]`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-22T18:06:36.443

```
sin = 'string'
sout = sin[0] + sin[2..-1] 
```

# c++ - Visual Studio 怪异：VS 2010 中的 C++ 程序比 2008 慢得多

> ID：10707472
> 
> 赞同：0
> 
> 时间：2012-05-22T17:59:39.830
> 
> 标签：c++, visual-studio-2010, visual-studio-2008, visual-c++

我有以下程序（此代码是我正在练习的 google code jam 问题的缩小版本）。

在 VS 2008 上运行此程序时，它运行时间为**10.459**秒。在 VS 2010 上，它的运行时间为**47.073**秒。我尝试在有和没有调试的情况下运行它，时间相似。

为什么差距这么大？

这是**编译器**命令行（我只是使用在 Visual Studio 中创建新的 C++ 控制台应用程序时使用的默认值，但无论如何我都将它们放在这里以防有人需要查看它们）。

对比 2008

```
/Od /D "WIN32" /D "_DEBUG" /D "_CONSOLE" /D "_UNICODE" /D "UNICODE" /Gm /EHsc /RTC1 /MDd /Fo"Debug\\" /Fd"Debug\vc90.pdb" /W3 /nologo /c /ZI /TP /errorReport:prompt 
```

对比 2010

```
/ZI /nologo /W3 /WX- /Od /Oy- /D "WIN32" /D "_DEBUG" /D "_CONSOLE" /D "_UNICODE" /D "UNICODE" /Gm /EHsc /RTC1 /GS /fp:precise /Zc:wchar_t /Zc:forScope /Fp"Debug\myproj2.pch" /Fa"Debug\" /Fo"Debug\" /Fd"Debug\vc100.pdb" /Gd /analyze- /errorReport:queue 
```

以下是**链接器**命令行：

对比 2008

```
/OUT:"c:\temp\myproj\myproj\Debug\myproj.exe" /INCREMENTAL /NOLOGO /MANIFEST /MANIFESTFILE:"Debug\myproj.exe.intermediate.manifest" /MANIFESTUAC:"level='asInvoker' uiAccess='false'" /DEBUG /PDB:"c:\temp\myproj\myproj\Debug\myproj.pdb" /SUBSYSTEM:CONSOLE /DYNAMICBASE /NXCOMPAT /MACHINE:X86 /ERRORREPORT:PROMPT kernel32.lib user32.lib gdi32.lib winspool.lib comdlg32.lib advapi32.lib shell32.lib ole32.lib oleaut32.lib uuid.lib odbc32.lib odbccp32.lib 
```

对比 2010

```
/OUT:"c:\temp\myproj2\Debug\myproj2.exe" /INCREMENTAL /NOLOGO "kernel32.lib" "user32.lib" "gdi32.lib" "winspool.lib" "comdlg32.lib" "advapi32.lib" "shell32.lib" "ole32.lib" "oleaut32.lib" "uuid.lib" "odbc32.lib" "odbccp32.lib" /MANIFEST /ManifestFile:"Debug\myproj2.exe.intermediate.manifest" /ALLOWISOLATION /MANIFESTUAC:"level='asInvoker' uiAccess='false'" /DEBUG /PDB:"c:\temp\myproj2\Debug\myproj2.pdb" /SUBSYSTEM:CONSOLE /PGD:"c:\temp\myproj2\Debug\myproj2.pgd" /TLBID:1 /DYNAMICBASE /NXCOMPAT /MACHINE:X86 /ERRORREPORT:QUEUE 
```

**编辑** 对评论问题的回答：
从命令行运行 VS 2008 版本（发布版本）：~3 秒
从命令行运行 VS 2010 版本（发布版本）：~1.5 秒

（这些时间似乎与直接从 VS IDE 运行的时间相似）
从命令行运行 VS 2008 版本（调试构建）：~10.5 秒
从命令行运行 VS 2010 版本（调试构建）：~49 秒

代码：

```
#include <algorithm>
#include <numeric>
#include <iostream>
#include <sstream>
#include <string>
#include <vector>
#include <set>
#include <map>
#include <cstdio>
#include <cstdlib>
#include <cctype>
#include <cmath>
#include <complex>
#include <string>
#include <cstring>
#include "time.h"
using namespace std;

int main() {

  clock_t t1,t2;
  t1=clock();

  int A=1069514;
  int B=1946556;

  set< pair< int, int > > vals;
  char buff[1000];
  for(int i = A; i <= B; ++i) {
    sprintf(buff,"%d",i);
    string cur = buff;
    for (int j = 1; j <= (int)cur.size() - 1; ++j) {
      string y=cur.substr(j) + cur.substr(0,j);
      if (y[0]=='0')
        continue;
      int k = atoi(y.c_str());
      if (k > i && k <= B) {
        vals.insert(make_pair(i,k));
      }
    }  
  }

  t2 = clock();
  float secs = ((float)t2 - (float)t1) / CLOCKS_PER_SEC;
  cout<<"took "<<secs<<endl;

  return 0;
} 
```

# winforms - 如何在 .Net 中抑制 UnhandledException

> ID：10707475
> 
> 赞同：1
> 
> 时间：2012-05-22T17:59:56.930
> 
> 标签：winforms, exception-handling, vb.net-2010

我有一个 VB.Net WinForms 应用程序，当应用程序退出时会引发异常。该异常*仅*在关闭应用程序时发生，绝不会影响应用程序的功能。抛出的异常是*InvalidOperationException*并且调试器无法识别异常发生的位置，而在 Visual Studio 2008 中，异常显示在弹出窗口中而不引用行号。

这是其他人也有完全相同的问题： [http ://bytes.com/topic/c-sharp/answers/659366-invalidoperationexception-appeared-after-introduction-webbrowser-control](http://bytes.com/topic/c-sharp/answers/659366-invalidoperationexception-appeared-after-introduction-webbrowser-control)

如该链接中所述，该异常是间歇性的，但在某种程度上与 WebBrowser 控件有关，因为退出应用程序时的异常仅在显示至少 2 个带有 WebBrowser 控件的表单时才会发生。（或者一个带有 WebBrowser 控件的表单打开和关闭了两次。）

现在在 VB.Net 中，我能够在*AppDomain.CurrentDomain.UnhandledException*处理程序中捕获异常，但我设法阻止 Windows 报告异常的唯一方法是使用*MessageBox*在处理程序中显示消息。如果我在处理程序中停止*MessageBox.Show*调用，则在应用程序关闭时会报告异常。

有谁知道我可以在*UnhandledException*处理程序中抑制此异常以便应用程序*始终*干净退出的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T19:24:01.383

我找到了我的问题的答案，这是对这个问题的回答之一：

[如何使用线程异常？](https://stackoverflow.com/questions/4864835/how-to-use-threadexception)

将此添加到 UnhandledException 方法以防止出现 Windows 崩溃通知：

Environment.Exit(1)

感谢[Hans Passant](https://stackoverflow.com/users/17034/hans-passant)提供这些有用的信息。

# mongodb - 在 Mongo DB 中，如何在 C# 中执行以下语句？

> ID：10707482
> 
> 赞同：1
> 
> 时间：2012-05-22T18:00:36.043
> 
> 标签：mongodb, mongodb-.net-driver

在 Mongo DB 中，如何在 C# 中执行以下语句？C# 驱动程序没有将 Linq 转换为聚合框架，所以我不能使用 linq。如果我使用 linq，它会从应用程序级别的数据库和组中读取所有数据，并且不使用新的 MongoDB 聚合框架。看起来可以使用 CommandDocument，但我没有找到任何文档，也不知道如何使用它。

```
db.orders.aggregate([ 
 { $group: {_id:"$cust_id",total:{$sum:"$price"}} } 
]) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T18:54:51.897

请参阅此处发布的同一问题的答案：

[https://groups.google.com/forum/?fromgroups#!topic/mongodb-user/8dM1LnHh9-Q](https://groups.google.com/forum/?fromgroups#!topic/mongodb-user/8dM1LnHh9-Q)

# variables - .bat 文件 - 输出名称存储为变量的变量的值

> ID：10707485
> 
> 赞同：0
> 
> 时间：2012-05-22T18:00:51.970
> 
> 标签：variables, loops, batch-file, echo

好的，作为循环的一部分，我正在读取未知数量的文件名，并将它们保存到名称取决于文件夹中文件数量的变量中。像这样：

```
SET /a count=1

DIR %rootFolder%> "fileList.txt" /b

FOR /f "tokens=* delims= usebackq" %%a IN ("fileList.txt") DO CALL :LOOP %%a
goto :LOOP2
:Loop
SET var=%1
SET File%count%=%var%
SET /a count=%count%+1
GOTO:EOF 
```

这很好用

```
ECHO File1
ECHO File2 
```

输出

```
firstfile.txt
secondfile.txt 
```

我遇到的问题是在稍后的循环中读出变量的内容，因为这段代码：

```
SET fileName=File%count%
ECHO %fileName%> temp.txt 
```

输出

```
File1 
```

当我希望它输出按该名称存储在变量中的值时。期望的输出：

```
firstfile.txt 
```

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T18:20:19.667

我相信这段代码可以帮助你：

```
setlocal enabledelayedexpansion
set /a count=0
for /f "delims=" %%a in ('dir /b %rootFolder%') do (
    set /a count+=1
    set File!count!=%%a
)

for /l %%a in (1,1,%count%) do (
    echo !File%%a!
) 
```

如果你不喜欢使用 !'s 的快捷方式，你可以只用 %'s 来实现你所要求的：

```
set /a count=0
for /f "delims=" %%a in ('dir /b %rootFolder%') do call :loop %%a
call set var=%%File%count%%%
echo %var%

goto :eof

:loop
set /a count+=1
set File%count%=%1
goto :eof 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T18:50:24.837

如果文件名包含，panda-34 解决方案将失败，`!`因为延迟扩展会破坏 %%a 的扩展。`!`通过在循环中打开和关闭延迟扩展，可以改进该解决方案以支持文件名。

```
setlocal disableDelayedExpansion
set /a count=0
for /f "delims=" %%a in ('dir /a-d /b %rootFolder%') do (
  set /a count+=1
  setlocal enableDelayedExpansion
  for /f %%b in ("!count!") do (
    endlocal
    set "file%%b=%%a"
  )
)

setlocal enableDelayedExpansion
for /l %%a in (1,1,%count%) do (
  echo !File%%a!
) 
```

在我看来，延迟扩展解决方案是迄今为止最好的方法。但还有另一种选择。

```
setlocal disableDelayedExpansion
set /a count=0
for /f "delims=" %%a in ('dir /a-d /b %rootFolder%') do (
  set /a count+=1
  call set "file%%count%%=%%a"
)

for /l %%a in (1,1,%count%) do (
  call echo %%File%%a%%
) 
```

调用解决方案看起来更简单，但速度要慢得多，如果扩展变量包含特殊字符（如`&`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-22T18:31:38.757

尝试这个：

```
call echo %%fileName%% > temp.txt 
```

# vb.net - 将值从 excel 复制到 Outlook 电子邮件 vb.net 的正文

> ID：10707491
> 
> 赞同：2
> 
> 时间：2012-05-22T18:01:10.150
> 
> 标签：vb.net, excel, com, outlook

所以这是我之前提出的问题的一个更精致的版本。很长一段时间以来，我一直试图解决这个问题。我找到了一个有意义的网站，但由于某种原因我无法实现它。我只想能够将 excel 中的信息（表格、图表、范围等）复制到 Outlook 电子邮件的正文中。

从这里： http: [//pastebin.com/4VWmcrx6](http://pastebin.com/4VWmcrx6)

它建议：

```
Using VB.NET to copy Excel Range (a table) to body of Outlook email
Sub CopyFromExcelIntoEMail()
Dim Doc As Word.Document
Dim wdRn As Word.Range
Dim Xl As Excel.Application
Dim Ws As Excel.Worksheet
Dim xlRn As Excel.Range

Set Doc = Application.ActiveInspector.WordEditor
Set wdRn = Doc.Range

Set Xl = GetObject(, "Excel.Application")
Set Ws = Xl.Workbooks("Mappe1.xls").Worksheets(1)

Set xlRn = Ws.Range("b2", "c6")
xlRn.Copy

wdRn.Paste
End Sub 
```

我已经尝试了它的几种变体，但没有运气。

```
Imports System.Data
Imports System.IO
Imports Microsoft.Office.Interop
Imports Office = Microsoft.Office.Core
Imports xlNS = Microsoft.Office.Interop.Excel
Imports System.Runtime.InteropServices
Imports System.Net.Mail
Imports excel1 = Microsoft.Office.Interop.Excel
Imports word1 = Microsoft.Office.Interop.Word
Imports outlook1 = Microsoft.Office.Interop.Outlook

Module Module1

    Sub Main()
        Dim Doc As Word.Document
        Dim wdRn As Word.Range
        Dim Xl As Excel.Application
        Dim Ws As Excel.Worksheet
        Dim xlRn As Excel.Range

        Dim application As New Outlook.Application
        Dim mail As Outlook.MailItem = CType(application.CreateItem(Outlook.OlItemType.olMailItem), Outlook.MailItem)

        Doc = Application.ActiveInspector.WordEditor
        wdRn = Doc.Range

        Xl = GetObject("C:\Users\ajohnson\Desktop\Book1.xlsx", "Excel.Application")
        Ws = Xl.Workbooks("Book1").Worksheets(1)

        xlRn = Ws.Range("a1", "d2")
        xlRn.Copy()

        With mail
            .Body = wdRn.Paste() & vbCr & wdRn.Paste()

        End With

    End Sub

End Module 
```

似乎它不应该那么困难，而且我对正在发生的事情有一个合理的想法，但无论我尝试什么，它都不起作用。该代码在

```
Doc = Application.ActiveInspector.WordEditor 
```

我也尝试使用给出的代码，但它说应用程序未定义。

任何帮助将不胜感激，一如既往地感谢您。

对于后代（我到处都看到这个问题）：@Siddharth Rout 的解决方案肯定会奏效，但如果你想让它不会在黑莓上被截断（它实际上出现了，我发誓）一个更好的方法可以是在评论中找到。

```
Sub Export_Range_Images()

' =========================================
' Code to save selected Excel Range as Image
' =========================================

Dim oRange As Range
Dim oCht As Chart
Dim oImg As Picture
Set oRange = Range("A1:B2")
Set oCht = Charts.Add
oRange.CopyPicture xlScreen, xlPicture
oCht.Paste

oCht.Export FileName:="C:\temp\SavedRange.jpg", Filtername:="JPG"

End Sub 
```

这来自[这里](http://vbadud.blogspot.com/2010/06/how-to-save-excel-range-as-image-using.html)，以及：

```
.HTMLBody="< img src='C:\Temp\logo.jpg'>" & vbCr & "< img src='C:\Temp\logo.jpg'>" 
```

从[这里开始。](http://www.mrexcel.com/forum/showthread.php?t=529993)

这个想法是您创建您感兴趣的范围/表格的 .jpg 文件，然后使用 html 将它们放入电子邮件的正文中。在这两种方法之间，您应该能够使其正常工作。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-22T19:01:56.770

我在`RangetoHTML`这里使用了 Ron 的功能。

```
Imports Excel = Microsoft.Office.Interop.Excel
Imports Olook = Microsoft.Office.Interop.Outlook

Public Class Form1
    '~~> Define your Excel Objects
    Dim xlApp As New Excel.Application
    Dim xlWorkBook As Excel.Workbook
    Dim xlWorkSheet As Excel.Worksheet
    Dim xlRange As Excel.Range

    '~~> Define Outlook Objects
    Dim olApp As New Olook.Application
    Dim olMail As Olook.MailItem

    Private Sub Button1_Click(sender As System.Object, e As System.EventArgs) Handles Button1.Click
        '~~> Opens an exisiting Workbook. Change path and filename as applicable
        xlWorkBook = xlApp.Workbooks.Open("C:\Sample.xlsx")
        '~~> Set the relevant sheet that we want to work with
        xlWorkSheet = xlWorkBook.Sheets("Sheet1")

        xlRange = xlWorkSheet.Range("A1:F20")

        olMail = olApp.CreateItem(0)

        On Error Resume Next
        With olMail
            .To = "INSERT TO EMAIL HERE"
            .CC = ""
            .BCC = ""
            .Subject = "This is the Subject line"
            .HTMLBody = RangetoHTML(xlRange)
            .Display()   'or use .Send to send it
        End With
        On Error GoTo 0

        '~~> Close the File
        xlWorkBook.Close (False)

        '~~> Quit the Excel Application
        xlApp.Quit()

        '~~> Clean Up
        releaseObject (xlApp)
        releaseObject (xlWorkBook)

        '~~> Similarly cleanup for outlook. not including as I am using .Display()

    End Sub

    Function RangetoHTML(rng As Excel.Range)
        ' Changed by Ron de Bruin 28-Oct-2006
        ' Working in Office 2000-2010
        Dim fso As Object
        Dim ts As Object
        Dim TempFile As String
        Dim TempWB As Excel.Workbook

        TempFile = Environ$("temp") & "/" & Format(Now, "dd-mm-yy h-mm-ss") & ".htm"

        'Copy the range and create a new workbook to past the data in
        rng.Copy()

        TempWB = xlApp.Workbooks.Add(1)

        With TempWB.Sheets(1)
            .Cells(1).PasteSpecial(Paste:=8)
            .Cells(1).PasteSpecial(-4163, , False, False)
            .Cells(1).PasteSpecial(-4122, , False, False)
            .Cells(1).Select()
            xlApp.CutCopyMode = False
            On Error Resume Next
            .DrawingObjects.Visible = True
            .DrawingObjects.Delete()
            On Error GoTo 0
        End With

        'Publish the sheet to a htm file
        With TempWB.PublishObjects.Add( _
             SourceType:=4, _
             Filename:=TempFile, _
             Sheet:=TempWB.Sheets(1).Name, _
             Source:=TempWB.Sheets(1).UsedRange.Address, _
             HtmlType:=0)
            .Publish (True)
        End With

        'Read all data from the htm file into RangetoHTML
        fso = CreateObject("Scripting.FileSystemObject")
        ts = fso.GetFile(TempFile).OpenAsTextStream(1, -2)
        RangetoHTML = ts.ReadAll
        ts.Close()
        RangetoHTML = Replace(RangetoHTML, "align=center x:publishsource=", _
                              "align=left x:publishsource=")

        'Close TempWB
        TempWB.Close(savechanges:=False)

        'Delete the htm file we used in this function
        Kill (TempFile)

        ts = Nothing
        fso = Nothing
        TempWB = Nothing
    End Function

    '~~> Release the objects
    Private Sub releaseObject(ByVal obj As Object)
        Try
            System.Runtime.InteropServices.Marshal.ReleaseComObject (obj)
            obj = Nothing
        Catch ex As Exception
            obj = Nothing
        Finally
            GC.Collect()
        End Try
    End Sub
End Class 
```

# spring - 具有 Spring 安全性的自定义登录页面

> ID：10707493
> 
> 赞同：1
> 
> 时间：2012-05-22T18:01:11.847
> 
> 标签：spring, spring-security

我正在使用 Spring 3.1.0.RELEASE、JSF 2.x、JPA 2 和 Hibernate Provider 做一个 Web 应用程序。我使用 PrettyFaces 3.3.2 作为友好的 URL。该应用程序在 Tomcat 6.35 上运行。

我的 webapp 上的页面受到 Spring security 3.1.0.RELEASE 的限制。

*安全应用上下文.xml：*

```
<intercept-url pattern="/home/**" access="hasRole('ROLE_USER')" />

<!-- login -->
<form-login login-processing-url="/login_check" login-page="/login"
    default-target-url="/home" authentication-failure-url="/login?login_error=1"
    authentication-success-handler-ref="frontConnectionHistoryHandler"  />

<access-denied-handler error-page="/accessdenied" />

<!-- logout -->
<logout invalidate-session="true" logout-success-url="/logout_success"
    logout-url="/logout" delete-cookies="JSESSIONID" />

<session-management>
    <concurrency-control max-sessions="1" />
</session-management> 
```

*漂亮的config.xml：*

```
<!-- Login -->
<url-mapping id="login">
    <pattern value="/login" />
    <view-id value="/login.jsf" />
</url-mapping>

<!-- Access denied -->
<url-mapping id="accessdenied">
    <pattern value="/accessdenied" />
    <view-id value="/accessdenied.jsf" />
</url-mapping>

<!-- Logout -->
<url-mapping id="logout">
    <pattern value="/logout" />
    <view-id value="/j_spring_security_logout" />
</url-mapping>

<!-- Logout successed -->
<url-mapping id="logout_success">
    <pattern value="/logout_success" />
    <view-id value="/logout_success.jsf" />
</url-mapping> 
```

大多数情况下，用户访问 webapp 是这样的： `http://mysite/home/en/siteId`. URL 的最后部分是 lang / 站点 ID。

但是如果它们没有连接，spring security 会将它们重定向到登录页面。

我想根据询问的 url 在登录页面上显示特殊元素：最后一个参数`en/siteId`（语言和站点 ID）

例如，我想根据站点 ID 在登录页面中显示徽标。

我怎么能这样做？

# iphone - iOS remoteControlReceivedWithEvent 未调用

> ID：10707499
> 
> 赞同：3
> 
> 时间：2012-05-22T18:01:25.547
> 
> 标签：iphone, ios

在 .plist 中，我添加了正常的：[http](http://tinyurl.com/c7e9joy) ://tinyurl.com/c7e9joy 当 iPhone 被锁定或我在应用程序之外并打开远程按钮时，我可以在那里看到应用程序徽标和标题，但它们不要反应。（我正在我自己的 iPhone 上进行测试。）

```
// Makes sure we are able to connect to the media buttons on the lock screen.
- (BOOL) canBecomeFirstResponder
{
return YES;
}

- (void)viewDidLoad
{
[super viewDidLoad];
// Do any additional setup after loading the view, typically from a nib.

[[UIApplication sharedApplication] beginReceivingRemoteControlEvents];
[self becomeFirstResponder];
}

- (void) remoteControlReceivedWithEvent: (UIEvent *) receivedEvent {
NSLog(@"REMOTE");
if (receivedEvent.type == UIEventTypeRemoteControl) {

    switch (receivedEvent.subtype) {

        case UIEventSubtypeRemoteControlTogglePlayPause:
            [self playBtnPressed:nil];

            break;

        case UIEventSubtypeRemoteControlPreviousTrack:
            [self skipTrack:nil];
            break;

        case UIEventSubtypeRemoteControlNextTrack:
            [self skipTrack:nil];
            break;

        default:
            break;
    }
}
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-10T15:57:04.240

您可能还需要添加：

```
- (BOOL)canBecomeFirstResponder {
    return YES;
} 
```

任何子类都`UIResponder`需要实现这一点，否则它不会接受第一响应者状态。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-22T18:18:35.467

您正在取消注册 viewWillDisapear 中的事件，这意味着只要该视图在手机上不可见，您就不会注册该事件。我会更改您注册和取消注册到 viewDidLoad 和 viewDidUnload 挂钩的位置。

# apache - 如何在我的 htaccess 中满足 www 条件

> ID：10707500
> 
> 赞同：0
> 
> 时间：2012-05-22T18:01:37.650
> 
> 标签：apache, .htaccess, mod-rewrite, url-rewriting

我有当前的重写规则。

```
RewriteCond %{HTTP_HOST} ^([^\.]+)\.domain\.com$ [NC]
RewriteCond %{HTTP_HOST} !^www\. [NC]
RewriteRule ^$ /s/index.php?s=%1 [L] 
```

基本上，它的作用是将 test.domain.com 指向 www.domain.com/s/index.php?s=test 。

第二行代码是为了防止 www.domain.com 指向 /s/index.php ...（这是我的主站点）

但是，上述规则和代码不适用于 www.test.domain.com 。

我希望 test.domain.com 和 www.test.domain.com 都指向 www.domain.com/s/index.php?s=test。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T18:10:54.630

试试这个：

```
RewriteCond %{HTTP_HOST} ^(www.)?([^\.]+)\.domain\.com$ [NC]
RewriteCond %{HTTP_HOST} !^www\.domain.com [NC]
RewriteRule ^$ http://www.domain.com/s/index.php?s=%2 [L,QSA] 
```

# vb.net - 部署和/或注册失败并出现错误：0x80070020

> ID：10707503
> 
> 赞同：0
> 
> 时间：2012-05-22T18:01:43.643
> 
> 标签：vb.net, deployment, windows-phone

尝试部署到触摸屏手机时，出现错误：

> 部署和/或注册失败并出现错误：0x80070020。

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T19:17:28.397

您的智能手机上仍有一个进程正在运行。

在您的手机上：

1.  点击开始键。
2.  点击设置。
3.  选择底部的系统选项卡。
4.  选择内存图标。
5.  选择屏幕底部的运行程序选项卡。
6.  选择一个任务并单击停止或单击全部停止以停止所有进程。

# ruby - 这是将通知推送到另一个网络服务器的正确方法

> ID：10707504
> 
> 赞同：3
> 
> 时间：2012-05-22T18:01:44.230
> 
> 标签：ruby, ruby-on-rails-3, playframework, push-notification

我们有一个基于 Rails 的 API，并使用 resque 处理一些东西。现在处理完之后，我需要向客户端发送一个通知（这是一个使用 Play Framework 构建的应用程序，它将一个 json 文件发送到 API，其中包含要使用 resque 处理的数据）。
我找到了[Faye](http://railscasts.com/episodes/260-messaging-with-faye)、[Private Pub](http://railscasts.com/episodes/316-private-pub)和[许多其他人](https://www.google.com.br/search?q=rails%20%2b%20push%20notificationj&ie=utf-8&oe=utf-8&aq=t&rls=org.mozilla%3aen-US%3aofficial&client=firefox-a#q=rails%20%2b%20send%20push%20notification&hl=pt-BR&safe=off&client=firefox-a&rls=org.mozilla%3aen-US%3aofficial&prmd=imvns&ei=ldG7T_vrMZCk8AT6-NHDCg&start=0&sa=N&bav=on.2,or.r_gc.r_pw.r_cp.r_qf.,cf.osb&fp=d27cccdf103b0c9c&biw=1368&bih=600)，但他们只有通知页面（如聊天窗口等）的示例，而不是网络服务器。
有任何想法吗？多谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T18:09:16.223

我们已经用[faye](http://faye.jcoglan.com/)做到了。效果很好

# asp.net-mvc - 如何制作带有附加列的 Code-First Entity Framework 4.3 多对多表？

> ID：10707505
> 
> 赞同：0
> 
> 时间：2012-05-22T18:01:49.803
> 
> 标签：asp.net-mvc, asp.net-mvc-3, entity-framework, entity-framework-4, many-to-many

我在 MVC3 的实体框架 4.3 代码优先模型中有以下类：

```
public class Film
{
    public Int32 ID { get; set; }

    [Column("FilmName"), MinLength(2), MaxLength(100)]
    [Required(ErrorMessage = "Please enter a name")]
    public String Name { get; set; }

    public Model.Cast Cast { get; set; }
}

public class Actor
{
    public Int32 ID { get; set; }

    [MaxLength(75)]
    public String Name { get; set; }
}

[Table("Cast")]
public class Cast
{
    public Actor Actor { get; set; }

    [MaxLength(500)]
    public String Role { get; set; }

    public virtual Film Film { get; set; }
} 
```

我想要一个如下的表格布局：

```
Films:
ID PK
Name

Cast:
FilmID PK FK
ActorID PK FK
Role

Actors:
ID PK
Name 
```

如何创建 Cast 表？我目前收到以下错误：

##System.Data.Entity.Edm.EdmEntityType: : EntityType 'Cast' 没有定义键。定义此 EntityType 的键。\tSystem.Data.Entity.Edm.EdmEntitySet: EntityType: EntitySet 'Casts' 基于没有定义键的类型'Cast'。##

但是我不想创建 ID 键，我想使用 Film 和 Actor 的 ID 字段来制作复合主键，它们都是其他表的外键。

我应该怎么办？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T08:19:10.617

您必须以这种方式重新定义您的模型：

```
public class Film
{
    public Int32 ID { get; set; }

    [Column("FilmName"), MinLength(2), MaxLength(100)]
    [Required(ErrorMessage = "Please enter a name")]
    public String Name { get; set; }

    public ICollection<Model.Cast> Cast { get; set; }
}

public class Actor
{
    public Int32 ID { get; set; }

    [MaxLength(75)]
    public String Name { get; set; }

    public ICollection<Model.Cast> Cast { get; set; }
}

[Table("Cast")]
public class Cast
{
    [Key, Column(Order = 0)]
    public int ActorId { get; set; }
    [Key, Column(Order = 1)]
    public int FilmId { get; set; }

    [MaxLength(500)]
    public String Role { get; set; }

    [ForeignKey("ActorId")]
    public Actor Actor { get; set; }
    [ForeignKey("FilmId")]
    public virtual Film Film { get; set; }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T18:41:01.280

我以前尝试过这样做，但没有成功。我的解决方案是像普通实体一样使用自己的身份 PK 映射链接表，并自定义 DatabaseInitializer 以运行 DDL 脚本来为 FK 创建唯一索引。我猜 EF 的设计不是为了支持这种遗留映射。

# sql - scope_identity 由于而不是触发器而返回 dbnull

> ID：10707509
> 
> 赞同：0
> 
> 时间：2012-05-22T18:02:11.897
> 
> 标签：sql

我在桌子上有一个而不是触发器。触发器工作正常，但我们有一个应用程序，用户可以在其中通过 UI 对表执行批量更新。在这种情况下，select scope_identity 返回 null。当用户通过 UI 执行更新时，我运行 sql profiler 来查看后台发生了什么，我得到了这个：

```
insert into Table(column1, column2,....)
values (value1, value2,.....)
go
select scope_identity()
go 
```

在这种情况下，内部定义的 scope_identity() 而不是 trigger 返回正确的值，但上述语句中的 scope_identity() 返回 null 并且应用程序此时会抛出错误。我想这是因为插入发生在触发器内部，它不属于上述 scope_identity 的范围。我知道可以通过使用 after trigger 代替 trigger 来解决此问题，但是该表包含 ntext 列，这将阻止我使用 after trigger。将 ntext 列转换为 nvarchar(max) 也不是我的选择。关于如何使 select scope_identity() 返回正确值的任何想法？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T09:37:05.170

好的，我可以重现您的问题并给出解释和解决方案。

```
use tempdb
go
set ansi_nulls on 
set quoted_identifier on 
go 
create table sampletable (
ix int identity primary key,
column1 nvarchar(50),
column2 nvarchar(50)
)
go
go
      /* First with no trigger - works fine */
insert sampletable(column1, column2)
select 'a', 'b'
select @@identity, scope_identity(), ident_current('sampletable')
select * from sampletable

go
      /* create instead trigger */
create trigger dbo.sampletrigger on sampletable 
instead of insert 
as 
begin 
insert into sampletable(column1, column2) select column1, column2 from inserted 
end
go

      /* Now scope_identity() is null */
insert sampletable(column1, column2)
select 'a', 'b'
select @@identity, scope_identity(), ident_current('sampletable')
select * from sampletable
go
go
go
drop table sampletable 
```

`Scope_identity()`为空，因为您没有在当前范围内插入具有标识的行。

`Scope_identity()`是当前批次中插入当前范围的最后一个标识。触发器是一个单独的范围，所以在触发器之外它是空的。无论范围如何，您都需要使用`@@identity`哪个是批次中插入的最后一个身份。

您**不能**使用`ident_current('sampletable')`在该特定表上的任何批次和任何会话中插入的最后一个身份，因为这可能会因其他并发用户而导致更改。

# php - 在 PHP 中将十六进制颜色代码转换为真实的十六进制值

> ID：10707511
> 
> 赞同：1
> 
> 时间：2012-05-22T18:02:13.247
> 
> 标签：php, colors, hex

假设我在字符串中有一个十六进制颜色代码，例如：

```
$color = '#fda80d'; 
```

我如何将其转换为实际的十六进制值，例如：

```
$color = 0xfda80d; 
```

所以它不是一个字符串而是一个实际的十六进制值？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T18:08:37.477

```
$color = '#fda80d';
$color = hexdec(substr($color, 1));

// Prove it
echo $color == 0xfda80d ? "yes" : "failed"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T18:13:55.667

下面的代码显示 PHP 以 10 为基数存储数字，但您可以对任何基数的数字进行数学运算。我在下面创建了一个演示，它可以让您更好地了解如何使用它来比较不同基数的数字。您还可以对不同基数的数字进行数学运算：

```
<?php
$color = '#fda80d'; //String color
$color = substr($color,1,6); //String color without the #

$color = '0x'.$color; //Prepend the 0x
$color += 0x00; //Force it to be a number

if($color === 0xfda80d) //Check the number is EXACTLY what we are expecting
    echo 'Is hex<br />'; //This code is run, proving it is a hex ***number***

echo $color; //Outputs 16623629 (base 10)

#================================#

echo '<br /><br />';

$octal = 011; //Define an octal number
$octal += 01; //Add 1

if($octal === 012)
    echo 'Is octal<br />';

echo $octal; //Outputs 10 (base 10)

#================================#

echo '<br /><br />';

$number = 12345; //Define a standard base 10 int
$number += 1; //Add 1 to the int

if($number === 12346)
    echo 'Is base 10<br />';

echo $number; //Outputs 12346 (base 10)

#================================#

echo '<br /><br />';

if($color === 16623629 && $color === 077324015 && $color === 0xFDA80D)
    echo '$color is base 10, octal and hex all at the same time<br />';

if($octal === 10 && $octal === 012 && $octal === 0xA)
    echo '$octal is base 10, octal and hex all at the same time<br />';

if($number === 12346 && $number === 030072 && $number === 0x303A)
    echo '$number is base 10, octal and hex all at the same time';
?> 
```

输出：

> 是十六进制
> 
> 16623629
> 
> 是八进制
> 
> 10
> 
> 是基数 10
> 
> 12346
> 
> $color 同时以 10 为底，八进制和十六进制
> 
> $octal 以 10 为底，同时是八进制和十六进制
> 
> $number 以 10 为底，同时是八进制和十六进制

您可以检查一个基数为 10 的数字（或十六进制/八进制），例如`10`，是否等于运行中的十六进制数字`0xA`，无需任何转换：

```
<?php
if(10 === 0xA)
    echo 'Success'; //This code is run
?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-22T18:07:55.787

您可以查看 PHP 的 bin2hex()。[http://php.net/manual/en/function.bin2hex.php](http://php.net/manual/en/function.bin2hex.php)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-22T19:35:26.350

另一种选择是使用方便的[**`sscanf()`**](http://php.net/sscanf)功能。

```
sscanf($color, '#%06x', $color); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-22T18:20:35.937

`var_dump(dechex(hexdec(str_replace('#', '', '#fda80d'))))`是一个字符串，所以你可能无法`0xfda80d`像你写的那样得到它。

# jpa - Querydsl Many2many join

> ID：10707513
> 
> 赞同：4
> 
> 时间：2012-05-22T18:02:20.710
> 
> 标签：jpa, many-to-many, subquery, querydsl

我对 QueryDSL 比较陌生，所以这可能很容易。我的数据库中有以下结构：

```
 ______      ___________      _______
| user |    | user2item |    | item  |
|------|    |-----------|    |-------|
| id   |    | user_id   |    | id    |
| name |    | item_id   |    | name  |
 ------      -----------      ------- 
```

现在我想获得与给定用户至少有一个共同项目的所有用户。所以我尝试了：

```
JPASubQuery subQuery = new JPASubQuery().from(user, item).join(user.items, item).where(user.id.eq(myUserId));
return new JPAQuery(entityManager).from(user).where(user.items.in(subQuery.list(item))).list(user); 
```

但这给了我在“in”子句中的一个问题，因为 subquery.list() 不返回 List<Item> 而是 ListSubQuery<Item>。任何帮助将非常感激。

**编辑**

感谢 Timo，您的建议有效 - 但不幸的是，如果您有多个此类子查询，则生成的语句比：

```
User myUser = repository.findOne(myUserId);

return new JPAQuery(entityManager)
           .from(user)
           .join(user.items, item)
           .where(item.in(myUser.getItems()))
           .list(user); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-23T18:06:51.013

试试这个

```
JPASubQuery subQuery = new JPASubQuery()
  .from(user, item).join(user.items, item)
  .where(user.id.eq(myUserId));
return new JPAQuery(entityManager).from(user)
  .where(user.items.any().in(subQuery.list(item))).list(user); 
```

# android - 缩放固定的 SurfaceView 以垂直填充并保持纵横比

> ID：10707519
> 
> 赞同：6
> 
> 时间：2012-05-22T18:02:41.703
> 
> 标签：android, surfaceview

我一直在寻找答案，但似乎找不到答案（这是一种非常规的 android 游戏编程方法，所以至少我认为这是可以预料的）。

我正在尝试在 Android 中创建 GBA 风格的 RPG 游戏（用于怀旧）。OpenGL 对我来说不够好，因为它在游戏循环中的可定制性不够（我只想在需要绘制某些东西时调用 draw，因为我希望这个游戏在使用方式上非常高效电池，这意味着让它更像一个投票应用程序而不是游戏）。我创建了一个自定义表面视图，它有自己的线程，每当需要完成绘图时就会调用它（我在 SDK 中的示例 LunarLander android 游戏之后对其进行建模）。

问题是，我希望游戏本身是固定大小（208x160），然后放大到屏幕大小。我遇到的问题是，在 XML 中扩展 SurfaceView 的正常参数中似乎没有这样做。当前状态下的游戏如下图所示。我试图让它伸展到屏幕的高度并保持宽度的比例，同时也不添加到可视游戏中（保持它固定，不管屏幕大小）。

[https://i.stack.imgur.com/EWIdE.png](https://i.stack.imgur.com/EWIdE.png)（我打算在线发布实际图像。垃圾邮件预防会咬我>.<）

目前，我正在获取 SurfaceView 的画布并直接对其进行绘图，并将我的尺寸作为硬编码的像素尺寸（208 像素、160 像素）提供。

这就是线程当前在获取画布和绘制它时的样子。在不改变我希望游戏虚拟占用的大小的情况下绘制画布的更好方法是什么？

```
@Override
    public void run()
    {
        Canvas c = null;
        try
        {
            c = surfaceHolder.lockCanvas(null);
            synchronized (surfaceHolder)
            {
                draw(c);
            }
        }
        catch (Exception e)
        {
            e.printStackTrace();
        }
        finally
        {
            if (c != null)
                surfaceHolder.unlockCanvasAndPost(c);
        }
    } 
```

绘制方法是这样的（StringBuilder是我自己在引擎中编码的Object）：

```
public void draw(Canvas canvas)
{       
    canvas.drawColor(Color.GRAY);
    StringBuilder stringBuilder = new StringBuilder(canvas, Color.BLACK, letters);
    stringBuilder.drawString("Oh, hello there!");
    stringBuilder.setLocation(10, 20);
    stringBuilder.drawString("Why am I so small?");
} 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-22T18:45:50.903

假设您的`draw`函数被重命名为`drawBase`。这是您的操作方法：

```
public void draw(Canvas canvas)
{
    final float scaleFactor = Math.min( getWidth() / 208.f, getHeight() / 160.f );
    final float finalWidth = 208.f * scaleFactor;
    final float finalHeight = 160.f * scaleFactor;
    final float leftPadding = ( getWidth() - finalWidth ) / 2;
    final float topPadding =  ( getHeight() - finalHeight ) / 2;

    final int savedState = canvas.save();
    try {
        canvas.clipRect(leftPadding, topPadding, leftPadding + finalWidth, topPadding + finalHeight);

        canvas.translate(leftPadding, topPadding);
        canvas.scale(scaleFactor, scaleFactor);

        drawBase(canvas);
    } finally {
        canvas.restoreToCount(savedState);
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-01-05T17:21:01.073

（K-ballo 接受的答案很好，但在它编写后的 2.5 年里，显示器变得更加密集，这意味着软件渲染越来越昂贵。让硬件来帮助完成这项工作很重要。）

要以特定分辨率渲染，您可以使用[SurfaceHolder#setFixedSize()](http://developer.android.com/reference/android/view/SurfaceHolder.html#setFixedSize(int,%20int))。这会将 Surface 的大小设置为您指定的确切尺寸。硬件缩放器将缩放表面以匹配视图的大小，这将比软件缩放更有效。[此博客文章](http://android-developers.blogspot.com/2013/09/using-hardware-scaler-for-performance.html)中描述了该功能，您可以在[Grafika 的](https://github.com/google/grafika)“硬件缩放器练习器”活动（[演示视频](https://www.youtube.com/watch?v=qpRaD-ij2xc)）中看到它的实际效果。

您可以通过调整 Surface 的大小（这是 Grafika 为该演示所做的）或通过将 View 调整为信箱或邮筒布局来为不同大小的显示器保持适当的纵横比。您可以在 Grafika 的 AspectFrameLayout 类中找到后者的示例，该类用于各种相机和视频演示。

关于这一点：

> OpenGL 对我来说不够好，因为它在游戏循环中不够可定制（我只想在需要绘制某些东西时调用 draw ...

你有两个选择。首先，您可以使用[GLSurfaceView#setRenderMode()](http://developer.android.com/reference/android/opengl/GLSurfaceView.html#setRenderMode(int))禁用连续渲染。其次，你不需要使用 GLSurfaceView 来使用 OpenGL。Grafika 中的大部分 GLES 代码都在 SurfaceView 或 TextureView 上运行。

# php - 我可以使用@depends 来依赖使用@dataProvider 的测试吗？

> ID：10707526
> 
> 赞同：20
> 
> 时间：2012-05-22T18:03:18.447
> 
> 标签：php, unit-testing, phpunit

我有一个测试类，其中一个测试通过 a 运行多次`@dataProvider`，另一个测试`@depends`在第一种方法上运行。但是，当我要求`var_dump`第二次测试应该通过什么时，它给了我一个坚实的`NULL`，这是我没想到的。

换句话说：这应该怎么做：

```
<?php 
class DevicesTest extends PHPUnit_Framework_TestCase
{
    /**
     * @dataProvider registerDataProvider
     */
    public function testRegister($device, $supposedResult)
    {
        //do a bunch of tests
        return array($device, $supposedResult);
    }

    public function registerDataProvider()
    {
        return array(array("foo", "foo"));
    }

    /**
     * @depends testRegister
     */
    public function testSaveDevicePreferences($deviceArr)
    {
        $this->assertNotEmpty($deviceArr);
    }
}
?> 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2016-06-28T13:01:09.527

在 PHPUnit 的当前版本（截至今天为 5.4）中，这是可能的。

根据[文档](https://phpunit.de/manual/current/en/writing-tests-for-phpunit.html#writing-tests-for-phpunit.data-providers.examples.DependencyAndDataProviderCombo.php)：

> 当一个测试从@dataProvider 方法和它@depends 的一个或多个测试接收输入时，来自数据提供者的参数将在来自依赖测试的参数之前。依赖测试的参数对于每个数据集都是相同的。

这就是它实际上的样子：

```
<?php

class DataProviderAndDependsCombinationTest extends AbstractUnittest{

    public function dataProviderForSomething()
    {
        return array(
            array(
                'someProvidedValue',
                'someOtherProvidedValue'
            )
        );
    }

    public function testToDependOn()
    {
        $this->assertTrue(true);
        return 'someDependedValue';
    }

     /**
     * @dataProvider dataProviderForSomething
     * @depends testToDependOn
     */
    public function testSomething($someProvidedValue, $someOtherProvidedValue, $someDependedValue)
    {
        $this->assertSame('someProvidedValue', $someProvidedValue);
        $this->assertSame('someOtherProvidedValue', $someOtherProvidedValue);
        $this->assertSame('someDependedValue', $someDependedValue);
    }
} 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-05-23T15:51:22.977

通常`@dataProvider`在您希望使用不同的数据集多次运行测试时使用。它的存在是为了避免您在测试中编写循环代码，并允许不同的数据集分别通过或失败。

正如我在评论中所说，我相信 PHPUnit 将使用`@depends` *or* `@dataProvider`，从你的例子中我猜第二个胜出。另一种可能性是数据提供者的测试不能用作依赖项，因为 PHPUnit 不知道要选择哪个测试加数据集。

由于`registerDataProvider`返回单个数据集，您可以轻松地从测试本身调用它。这将允许`@depends`在没有`@dataProvider`. 假设`testRegister`需要修改`$device`和/或`$supposedResult`，这应该工作：

```
class DevicesTest extends PHPUnit_Framework_TestCase {
    public function testRegister() {
        list($device, $supposedResult) = $this->registerDataProvider();
        //do a bunch of tests
        //register a device in the DB
        return array($device, $supposedResult);
    }

    public function registerDataProvider() {
        return array("foo", "foo");
    }

    /**
     * @depends testRegister
     */
    public function testSaveDevicePreferences($data) {
        list($device, $supposedResult) = $data;
        // do stuff dependent on testRegister()
        $this->assertEquals($device, $supposedResult);
    }
} 
```

如果第一次测试不需要修改这些变量，您可以简单地`registerDataProvider`从两个测试中调用。请注意，PHPUnit 不会像数据提供者机制那样将返回的数组与依赖测试分离为依赖测试的参数。这是因为它不知道返回的数组是多个参数而不是单个参数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-22T19:15:55.747

我发现不，这是不可能的。但是，通过稍微调整测试类，我已经获得了基本相同的结果，但是，如果第一个测试失败，第二个测试会愉快地运行，依赖关系似乎丢失了：

```
<?php 
class DevicesTest extends PHPUnit_Framework_TestCase
{
    /**
     * @dataProvider registerDataProvider
     */
    public function testRegister($device, $supposedResult)
    {
        //do a bunch of tests
        //register a device in the DB
        return array($device, $supposedResult);
    }

    public function registerDataProvider()
    {
        return array(array("foo", "foo"));
    }

    /**
     * @depends testRegister
     * @dataProvider registerDataProvider
     */
    public function testSaveDevicePreferences($device, $supposedResult)
    {
        // do stuff dependent on testRegister()
        $this->assertEquals($device, $supposedResult);
    }
}
?> 
```

# ios - 播放声音时应用程序崩溃

> ID：10707527
> 
> 赞同：-1
> 
> 时间：2012-05-22T18:03:19.260
> 
> 标签：ios, avfoundation, avaudioplayer

我正在使用`AVFoundation framework`播放声音。在文件的开头，我有：

```
#import <AVFoundation/AVAudioPlayer.h> 
```

并且`AVFoundation framework`已正确添加到我的项目中。但是，当我使用此代码播放声音时，应用程序崩溃：

```
NSString *pathForBgMusicFile = [[NSBundle mainBundle] pathForResource:@"ClenchedTeeth" ofType:@"mp3"];
NSURL *bgMusicFile = [[NSURL alloc] initFileURLWithPath:pathForBgMusicFile];
AVAudioPlayer *bgMusic = [[AVAudioPlayer alloc] initWithContentsOfURL:bgMusicFile error:NULL];
[bgMusic play]; 
```

有谁知道如何解决这一问题？提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T19:20:36.223

```
#import <AudioToolbox/AudioToolbox.h> 
```

并在 your.m 文件中

```
FBundleRef mainBundle = CFBundleGetMainBundle();
        CFURLRef soundFileURLref;
        soundFileURLref = CFBundleCopyResourceURL(mainBundle ,(CFStringRef)@"yourSoundFile",CFSTR ("wav"),NULL);
        UInt32 soundID;
        AudioServicesCreateSystemSoundID(soundFileURLref, &soundID);
        AudioServicesPlaySystemSound(soundID);} 
```

如果是您的情况，您可以在按钮内使用此代码。不要忘记添加音频工具框架​​。祝你好运

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T18:08:37.520

我不在我的mac前，试试这个（我只改变了第二行）：

```
NSString *pathForBgMusicFile = [[NSBundle mainBundle] pathForResource:@"ClenchedTeeth" ofType:@"mp3"];
NSURL *bgMusicFile = [NSURL fileURLWithPath:pathForBgMusicFile];
AVAudioPlayer *bgMusic = [[AVAudioPlayer alloc] initWithContentsOfURL:bgMusicFile error:NULL];
[bgMusic play]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-22T19:23:13.603

`AVAudioSession`在尝试播放之前尝试设置。像这样：

```
 AVAudioSession *audioSession = [AVAudioSession sharedInstance];
  audioSession.delegate = self;
  [audioSession setActive:YES error:nil];
  [audioSession setCategory:AVAudioSessionCategoryPlayback error:nil]; 
```

请记住导入它，并确保您的类同时实现`AVAudioPlayerDelegate`和`AVAudioSessionDelegate`。

# interface - clojure中接口的不完整实现

> ID：10707534
> 
> 赞同：2
> 
> 时间：2012-05-22T18:03:52.403
> 
> 标签：interface, clojure, deftype

Clojure 允许`deftype`不完全实现接口的 s，例如

```
(deftype Foo [x] clojure.lang.ISeq (next [this] x)) 
```

（`Foo`不实施`seq`）。来自 Pythonic 的鸭子类型，或者充其量（或最坏的情况，取决于你的 POV），ABC，我很难理解为什么允许这种不完整的实现，因为我认为接口的目的是保证存在一组方法（现在看来，为了`deftype`安全地使用其他人的 s，我必须将每个“方法”调用包装在 a 中`try...catch`）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T21:34:02.187

要求完整的实现会破坏交互式编程。如果有人为您提供了一个没有完全实现 ISeq 的类型，那么他们给了您一个损坏的类型。也就是说，一个 Clojure linter / 分析器检查你的实现疏忽的来源听起来非常有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T18:21:44.593

这是 Clojure 动态语言哲学和 Java 静态语言哲学之间的交集之一。我同意，这确实表明两者之间存在混淆。基本原理是**允许 clojure 程序使用 Java 库**而没有任何不必要的痛苦，并且许多库要求您**传递某个实现方法**的类的实例，以解决 Java 缺乏第一类函数的问题。从这个角度来看，这种权衡是有道理的，尽管从其他角度来看，它并不完全符合 Java 哲学。

# php - 如何在 Phalcon 中配置自定义路由？

> ID：10707535
> 
> 赞同：7
> 
> 时间：2012-05-22T18:03:56.417
> 
> 标签：php, phalcon

我刚刚偶然发现了 Phalcon（PHP 框架），它看起来很有前途，我决定尝试一下。

我在文档中进行了搜索，但没有找到与 Phalcon 中的路线相关的任何内容。有人知道如何在这个框架中创建自定义路由，还是我应该始终遵循约定？

如果您还不了解 Phalcon，您可能想[查看这些幻灯片](https://speakerdeck.com/embed/4edf11f72a2b980050009919)以了解它的内容。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-05T13:48:39.093

他们回复了请求并刚刚实现了自定义路由，现在看起来不太好，但这里是参考：

```
$router->add("/admin/:controller/a/:action/:params", array(
    "controller" => 1,
    "action" => 2,
    "params" => 3,
)); 
```

链接：

*   [Phalcon 自定义路由文档](http://phalcon.uservoice.com/forums/154026-general/suggestions/2884092-custom-routing)
*   [自定义路由功能的请求](http://phalconphp.com/documentation/routing)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-29T01:06:19.300

我很确定你必须遵守`baseDir/class/method/argument/...`约定。

我阅读了文档和源代码，但没有看到任何提示可以让您处理仅依赖于 C 扩展的自定义路由。一种可能的解决方案是将它们映射到 .htaccess 中。

# html - 使用 knockout.js 级联下拉菜单

> ID：10707538
> 
> 赞同：7
> 
> 时间：2012-05-22T18:04:07.073
> 
> 标签：html, data-binding, knockout.js

我正在尝试构建一个三步下拉系列。我能想到的最简单的例子是建立一个年份/品牌/型号下拉集。

我尝试按照示例并使用另一个小提琴（另一个小提琴 url 以 jsfiddle.net/rniemeyer/V2gvT/ 结尾），但是数据绑定有问题。

我的小提琴有一个要使用的年份/品牌/模型对象的静态列表，并且年份列表可以正确绑定，但永远不会让品牌/模型列表进行数据绑定。

[我的小提琴](http://jsfiddle.net/giltnerj0/Yrkbd/7/)

简单标记

```
<label for="ddlYear">Year</label>
<select id="ddlYear" data-bind="options: years, value: selectedYear"></select>

<label for="ddlMake">Make</label>
<select id="ddlMake" data-bind="options: makes, value: selectedMake'"></select>

<label for="ddlModel">Model</label>
<select id="ddlModel" data-bind="options: models"></select> 
```

脚本

```
var viewModel = {
    selectedYear: ko.observable(""),
    selectedMake: ko.observable(""),
    selectedModel: ko.observable("")    
};

viewModel.years = ko.dependentObservable(function() {
    return Enumerable.From(makeModelList).Select(function(it) {
      return it.year;
    }).OrderBy(function(it) {
      return it.year;  
    }).Distinct().ToArray();
}, viewModel);

viewModel.makes = ko.dependentObservable(function() {
    var selectedYear = this.selectedYear();
    return Enumerable.From(makeModelList).Where(function(it) {
        return it.year == selectedYear;
    }).Select(function(it) {
      return it.make;  
    }).ToArray();
}, viewModel);

viewModel.models = ko.dependentObservable(function() {
    var selectedYear = this.selectedYear();
    var selectedMake = this.selectedMake();
    return Enumerable.From(makeModelList).Where(function(it) {
        return it.year == selectedYear;
    }).Where(function(it) {
      return it.make == selectedMake;  
    }).Select(function(it) {
      return it.model;  
    }).ToArray();
}, viewModel);

ko.applyBindings(viewModel); 
```

数据在脚本块窗口中定义

```
var makeModelList = [
{
    year: 1984,
    make: 'Chevrolet',
    model: 'Camaro'}, 
```

等等

试图让它尽可能简单，但不能完全弄清楚为什么选择是数据绑定，就像我试图模仿的例子一样。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-22T18:16:45.177

您在这一行中有不必要的 ' （在单词 selectedMake 之后）：

```
<select id="ddlMake" data-bind="options: makes, value: selectedMake'"></select> 
```

只需将其删除。

固定小提琴 - [http://jsfiddle.net/Yrkbd/8/](http://jsfiddle.net/Yrkbd/8/)

# c++ - 外部关键字的使用

> ID：10707540
> 
> 赞同：2
> 
> 时间：2012-05-22T18:04:17.150
> 
> 标签：c++, extern

我熟悉 extern 关键字，它用于声明其他文件中存在的变量，但是以下语句是什么意思？

```
extern "C" const IMAGE_DOS_HEADER __ImageBase; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-22T18:05:51.677

这意味着`__ImageBase`全局变量使用[C 链接](http://msdn.microsoft.com/en-us/library/0603949d.aspx)，并且应该使用 C 而不是 C++ 的规则来[修改其名称。](http://en.wikipedia.org/wiki/Name_mangling)

**编辑：**恰好[Raymond Chen](https://stackoverflow.com/users/902497/raymond-chen)最近发表[了一篇文章](http://blogs.msdn.com/b/oldnewthing/archive/2012/05/25/10310148.aspx)，证明我的原始答案是完全错误的：`extern "C"`不禁*用*名称修改，它只会*更改*用于执行它的规则。C 名称也可以被破坏。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T18:05:44.480

`__ImageBase`这意味着不要破坏`extern "C"`. 简而言之，它确保您可以在 C++ 代码中使用该变量。

`extern "C"`指定要应用的链接。简而言之，一个链接规范。
它告诉 C++ 编译器将 C 类型的链接应用到后面的符号。

好读物：
**[使用 extern 指定链接](http://msdn.microsoft.com/en-us/library/0603949d%28v=vs.80%29.aspx)**
**[如何混合 C 和 C++](http://www.parashift.com/c++-faq-lite/mixing-c-and-cpp.html)**

# sql - 在函数中使用一个查询来填充另一个查询的变量

> ID：10707541
> 
> 赞同：0
> 
> 时间：2012-05-22T18:04:17.210
> 
> 标签：sql, function, postgresql, variables

我正在尝试从表 dwh.sgmt_clients 中提取 #(partner_id) 列表，然后将这些数字一一插入到我的函数中变量 $1 所在的大型查询中。然后我希望它们显示为查询。我一辈子都想不通

```
CREATE OR REPLACE FUNCTION dwh.cu_summary_function()
 RETURNS setof record AS
$$
declare partner_id ALIAS FOR $1
BEGIN
RETURN
select a.partner_id from dwh.sgmt_clients a 
loop
RETURN query
  select
avg(klicount)::int as average_kli, min(klicount) as min_kli, max(klicount) as max_kli,
(select count(kli) from ad_delivery.sgmt_kli_adic a where a.partner_id = $1) as total_kli, 
(select count(distinct(kli))from ad_delivery.sgmt_kli_adic a where a.partner_id = $1) as total_distinct_kli, a.partner_id
from (
select adic, count(kli) as klicount, x.partner_id
from ad_delivery.sgmt_kli_adic x
where x.partner_id = $1
group by adic, x.partner_id
) as a
group by a.partner_id;
end loop
END
$$
 LANGUAGE plpgsql VOLATILE
 COST 100; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T19:37:43.510

```
CREATE OR REPLACE FUNCTION dwh.cu_summary_function(int) --<<<<<<<<<
RETURNS setof record AS 
```

这个参数定义有点过时了，使用：

```
CREATE OR REPLACE FUNCTION dwh.cu_summary_function(partner_id int)
RETURNS setof record AS 
```

# php - 当我尝试访问我的 CodeIgniter 应用程序时，为什么会收到 404 错误？

> ID：10707543
> 
> 赞同：0
> 
> 时间：2012-05-22T18:04:39.393
> 
> 标签：php, codeigniter

在[CodeIgniter 手册](http://codeigniter.com/user_guide/general/controllers.html)中，它演示了如何为 blog.php 制作控制器。它说您可以将浏览器指向[http://example.com/blog](http://example.com/blog)，它会显示回显“hello world”；控制器文件夹中 blog.php 文件中的代码：

当我访问 example.com/blog 时，我收到 404 错误。我删除了 url 中的 index.php，但我认为这个问题之前存在。

任何帮助都会很棒。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-05-22T18:19:58.970

您是否已将博客路由添加到 routes.php 文件？

[http://codeigniter.com/user_guide/general/routing.html](http://codeigniter.com/user_guide/general/routing.html)

每个 URL 都需要映射到一个路由，以便框架知道要运行哪个控制器。做起来很简单，但不幸的是我已经有一段时间没有使用 CI 了，而且我这里没有任何 CI 项目来仔细检查将它粘贴在哪里。

但是，这两个视频教程非常好，它们会让您继续前进。

[http://codeigniter.com/tutorials/](http://codeigniter.com/tutorials/)

到目前为止，你有任何与 CI 合作的事情吗？

# java - 在android中使用套接字时出现异常错误

> ID：10707545
> 
> 赞同：1
> 
> 时间：2012-05-22T18:04:41.327
> 
> 标签：java, android, sockets

我想使用套接字通信 TCP 服务器和客户端。我有一个服务器，它已经过测试并且运行正常，但是当我尝试用 Java 实现客户端时，它在创建套接字时崩溃，我不知道为什么。拜托，如果有人能帮助我，我将不胜感激。谢谢。我把我制作的简单应用程序的代码放在这里：

```
 package udp.udp;
    import java.io.IOException;
    import java.net.Socket;
    import java.net.UnknownHostException;
    import android.app.Activity;
    import android.os.Bundle;
    import android.view.View;
    import android.widget.Button;

    public class UdpActivity extends Activity {

    @Override
    public void onCreate(Bundle savedInstanceState) {
      super.onCreate(savedInstanceState);
      setContentView(R.layout.main);
      Button buttonSend = (Button)findViewById(R.id.send);
    }

    Button.OnClickListener buttonSendOnClickListener
    = new Button.OnClickListener(){

    @Override
    public void onClick(View arg0) {
            try{

                Socket s = new Socket("192.168.1.13", 5003);

            } 
            catch (UnknownHostException e) {
                e.printStackTrace();
            } 
            catch (IOException e) {
                e.printStackTrace();
            }

    }};
     } 
```

以及我得到的失败日志：

```
 05-22 19:37:47.035: D/AndroidRuntime(997): Shutting down VM
    05-22 19:37:47.045: W/dalvikvm(997): threadid=1: thread exiting with uncaught exception              
    (group=0x409c01f8)
    05-22 19:37:47.065: E/AndroidRuntime(997): FATAL EXCEPTION: main
    05-22 19:37:47.065: E/AndroidRuntime(997): android.os.NetworkOnMainThreadException
    05-22 19:37:47.065: E/AndroidRuntime(997): at 
    android.os.StrictMode$AndroidBlockGuardPolicy.onNetwork(StrictMode.java:1099)
    05-22 19:37:47.065: E/AndroidRuntime(997):  at     
    java.net.InetAddress.lookupHostByName(InetAddress.java:391)
    05-22 19:37:47.065: E/AndroidRuntime(997):  at 
    java.net.InetAddress.getAllByNameImpl(InetAddress.java:242)
    05-22 19:37:47.065: E/AndroidRuntime(997):  at    
    java.net.InetAddress.getByName(InetAddress.java:295)
    05-22 19:37:47.065: E/AndroidRuntime(997):  at   
    udp.udp.UdpActivity$1.onClick(UdpActivity.java:55)
    05-22 19:37:47.065: E/AndroidRuntime(997):  at 
    android.view.View.performClick(View.java:3511)
    05-22 19:37:47.065: E/AndroidRuntime(997):  at   
    android.view.View$PerformClick.run(View.java:14105)
    05-22 19:37:47.065: E/AndroidRuntime(997):  at 
    android.os.Handler.handleCallback(Handler.java:605)
    05-22 19:37:47.065: E/AndroidRuntime(997):  at 
    android.os.Handler.dispatchMessage(Handler.java:92)
    05-22 19:37:47.065: E/AndroidRuntime(997):  at android.os.Looper.loop(Looper.java:137)
    05-22 19:37:47.065: E/AndroidRuntime(997):  at   
    android.app.ActivityThread.main(ActivityThread.java:4424)
    05-22 19:37:47.065: E/AndroidRuntime(997):  at 
    java.lang.reflect.Method.invokeNative(Native Method)
    05-22 19:37:47.065: E/AndroidRuntime(997):  at 
    java.lang.reflect.Method.invoke(Method.java:511)
    05-22 19:37:47.065: E/AndroidRuntime(997):  at  
    com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
    05-22 19:37:47.065: E/AndroidRuntime(997):  at 
    com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
    05-22 19:37:47.065: E/AndroidRuntime(997):  at dalvik.system.NativeStart.main(Native    
    Method)
    05-22 19:37:47.635: I/dalvikvm(997): threadid=3: reacting to signal 3
    05-22 19:37:47.655: I/dalvikvm(997): Wrote stack traces to '/data/anr/traces.txt'
    05-22 19:42:47.176: I/Process(997): Sending signal. PID: 997 SIG: 9 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T18:09:25.007

从 API-10 开始默认强制执行 StrictMode。查看此参考：http: [//developer.android.com/reference/android/os/StrictMode.html](http://developer.android.com/reference/android/os/StrictMode.html)。StrictMode 是一个有用的工具，开发人员可以使用它来识别主线程上的阻塞代码（主线程上的阻塞代码会导致 ANR，并且在您不知道它会阻塞多长时间的情况下（例如网络通信）很糟糕）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T18:09:07.650

看起来 Android SDK 坚持**不在**主线程上做网络，见[这里](http://developer.android.com/reference/android/os/NetworkOnMainThreadException.html)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-19T20:23:29.903

您正在尝试在 UI 线程上执行网络访问。不要那样做……不好。

## [为什么冰淇淋三明治会使您的应用程序崩溃](http://www.androiddesignpatterns.com/2012/06/app-force-close-honeycomb-ics.html)

# ruby-on-rails - 如何在所有测试中禁用 after_validation 方法

> ID：10707546
> 
> 赞同：1
> 
> 时间：2012-05-22T18:04:42.703
> 
> 标签：ruby-on-rails, rspec

我正在尝试在 Rails 中进行测试。

在我的一个模型中，我有`after_validation :grab_external_stuff`. `grab_external_stuff`是一种调用外部 API 的方法。我不想在我的测试中运行它。

`after_validation`在我的测试中禁用此方法的正确方法是什么？我该怎么做（使用 rspec）？我在哪里做呢？

我知道存根可用于停止调用方法。但我正在努力了解如何将其应用于 after_validation 或类似的钩子。

例如，假设我有一个任务，属于一个项目，属于一个用户。我运行一个工厂（：任务），它也在创建关联的项目和用户。但是当用户被验证时，grab_external_stuff 被调用。

那么在我的测试中应该在哪里指定我不想运行这个方法呢？在测试中，在工厂中，还是在其他地方？

感谢您的任何建议。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T18:09:23.077

`grab_external_stuff`实际上是一种方法吗？也许在模块中定义或作为您的模型之一中的类方法定义？如果是这种情况，并且您确定永远不希望它运行，则可以像您说的那样将其存根：

```
before(:suite) do
    Model.any_instance.stub(:grab_external_stuff) { nil } # if it's an instance method
    # or:
    # Model.stub(:grab_external_stuff) { nil } if it's a class method, etc
end 
```

您可以在您的 spec_helper 或每个测试等中进行设置。

这个方法被 after_validation 块调用的事实是无关紧要的，因为它只是一个方法，可以像任何其他方法一样被存根。

**编辑**即使由于您在工厂中制造某些东西而进行了此验证，它仍然会被剔除。您将在测试中从 Factory 创建，但`before`将是`before(:suite)`,`:all`或`:each`，但无论如何，它将在`it {}`遇到之前运行并调用存根，因此在您的 Factory 被调用之前，这意味着它将*始终*被存根.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T20:49:21.813

[您可以按照此处](https://stackoverflow.com/a/10707614/17410)`:grab_external_stuff`的建议对方法进行存根。另一种方法是使用[FakeWeb](https://rubygems.org/gems/fakeweb)对 API 请求进行存根。这对于集成测试可能更好——存根更适合单元测试 IMO。`:grab_external_stuff`

# asp.net - 使用 ASP.net 处理程序从数据库中显示 .swf 图像文件

> ID：10707548
> 
> 赞同：1
> 
> 时间：2012-05-22T18:04:52.123
> 
> 标签：asp.net, flash, handler

我在这里尝试使用 ASP.net 处理程序或其他显示二进制 .swf 文件的方法（即来自数据库）在 IE7 中显示基于 .swf 图像的文件时遇到了很大的困难。利用 HTTP 处理程序（Handler.ashx），我希望导航到该 url 并显示 .swf 图像，类似于使用浏览器打开 .swf 文件。我根本无法让它工作......

为了显示这些值，我尝试了许多不同的方法，它们在下面列出，然后是类似于我在应用程序中使用的代码片段。

> 1) 将 header 中的 content-disposition 值更改为使用附件时，.swf 文件将被保存，并且可以使用浏览器打开。
> 
> 2) 当使用内容类型为“image/png”的 .png 文件时，这非常有效。

```
public void ProcessRequest (HttpContext context) {

    Byte[] swfFile = File.ReadAllBytes("file.swf");

    context.Response.Buffer = true;
    context.Response.Clear();
    context.Response.ContentType = "application/x-shockwave-flash";
    context.Response.AddHeader("Content-Disposition", "filename=file.swf");
    context.Response.BinaryWrite(swfFile);
    context.Response.Flush();
    context.Response.End();
} 
```

任何帮助将不胜感激，在此先感谢您！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-19T05:32:51.387

您的代码将在 Chorme 浏览器中完美运行。但不是在 IE8 或 Firefox 27 中。不是将对象直接刷新到页面，而是有一个带有`OBJECT`标签的页面并调用另一个网页来获取 SWF 流。

1.  带有`OBJECT`元素的页面

`<object classid=clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="http://fpdownload.adobe.com/pub/" width="100%" height="100%" id="myMovieName" > <param name="movie" value="http://PageWhichGivesObjectStream.aspx?id=1"/> <param name="quality" value="high"/> <param name="bgcolor" value="#FFFFFF"/> <param name="play" value="true"/> <param name="loop" value="true"/> <param name="bgcolor" value="#FFFFFF"/> <param name="allowFullScreen" value="true"/> <param name="salign" value="l"/> </object>`

1.  提供对象流的页面

    `Response.ContentType = "application/x-shockwave-flash" Response.BinaryWrite(FlashObjectBinary) Response.End()`

这适用于 IE8

# c# - 拆分剪贴板内容时数组中的隐藏项是什么

> ID：10707549
> 
> 赞同：-2
> 
> 时间：2012-05-22T18:04:55.197
> 
> 标签：c#, arrays

我在 Excel 中有以下三个单元格：

```
a
b
c 
```

然后我将它们复制到剪贴板并在 C# 中执行以下脚本。结果数组有 4 个成员。为什么？

```
string s = Clipboard.GetText();
string[] lines = s.Split('\n'); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T07:39:04.597

[拆分](http://msdn.microsoft.com/en-us/library/tabh47cf.aspx)，`\r\n`您还可以使用[`Environment.NewLine`](http://msdn.microsoft.com/en-us/library/system.environment.newline.aspx)：

```
s.Split(new string[] { Environment.NewLine }, StringSplitOptions.RemoveEmptyEntries); 
```

# c# - WebSocket 后备服务器端

> ID：10707551
> 
> 赞同：0
> 
> 时间：2012-05-22T18:04:56.880
> 
> 标签：c#, .net, html, websocket, fallback

我在服务器端使用 feck (https://github.com/statianzo/Fleck) 来支持网页上的 WebSockets。这工作得很好，我真的很喜欢 feck 中的简约方法，没有广泛的配置要求，而且它是用 .NET 编写的。但是，不利的一面是，它没有任何后备实现。我一直在搜索很多，但我似乎找不到类似的 ajax long-pollong 或 flash 解决方案来与 feck 结合使用。我相信 node.js 和 socket.io 内置了这个，但似乎没有一种简单的方法可以将它们与 .NET 集成。我也发现了一些其他的 .net 实现，但不是像 feck 那样紧凑。

非常感谢任何建议或指示。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T20:11:14.197

您不需要后备实现。要么使用 websocket，让调用者使用它们，要么不使用。

*   如果您使用的是 websocket，请确保您的用户可以接受。

*   如果您的所有用户都不能接受它，请不要使用 websockets。让他们根据需要经常投票。

维持两个是没有意义的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-04T17:49:31.480

我发现使用 MVC3 添加 ajax 回退非常简单；[http://www.cleancode.co.nz/blog/739/ajax-aspnet-mvc-3](http://www.cleancode.co.nz/blog/739/ajax-aspnet-mvc-3)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-07T16:57:17.440

由于 IE9 不支持网络套接字，但当前支持 Safari/Firefox/Chrome/IE10/等。然后支持长轮询作为后备确实很有意义 IMNSHO。

“简单”的解决方案是 SignalR（http://signalr.net）——不幸的是，要让 websocket 部分亮起来，你需要在 Windows 8 上运行——除了你可以专注于你的应用程序，使用 SignalR 抽象掉运输细节为您服务。

# c++ - c++派生类的类型列表

> ID：10707552
> 
> 赞同：2
> 
> 时间：2012-05-22T18:05:11.687
> 
> 标签：c++, template-meta-programming, crtp, loki, typelist

使用 CRTP（奇怪的重复模板模式），您可以为基类提供派生类的知识。创建一个数组来存储从基类派生的每个类的实例并不难（参见示例）

```
class Base{
    public:
        static std::vector<Base *> m_derivedInstances;
};

template <class Derived>
class CRTPBase : public Base {
    public:
        static bool m_temp;
        static bool addInstance()
        {
            m_derivedInstances.push_back(new Derived);
            return true;
        }
};
template <class Derived>
CRTPBase<Derived>::m_temp = CRTPBase<Derived>::addInstance(); 
```

我想知道是否可以创建所有派生类类型的 Typelist（请参阅[http://www.research.ibm.com/designpatterns/pubs/ph-jun00.pdf](http://www.research.ibm.com/designpatterns/pubs/ph-jun00.pdf)）。问题是，每次编译器看到一个派生自`Base`它的新类时，都需要将新类型附加到列表中，但类型列表是不可变的（可以创建一个附加新类型的新列表，但添加据我所知，列表中的元素是不可能的。最后我想要这样的东西：

```
struct DerivedClassHolder {
    typedef Loki::TL::MakeTypeList</*list all derived classes here*/>::Result DerivedTypes;
}; 
```

最终目标是能够遍历所有派生自`Base`.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-05-21T21:13:37.980

可以使用伪类型映射来完成。下面是一些使用 boost::mpl 的示例代码。“Implem”的显式定义可以通过每个对应的implem头文件中的宏来完成。

```
#include <iostream>
#include <boost/mpl/vector.hpp>
#include <boost/mpl/eval_if.hpp>
#include <boost/mpl/identity.hpp>
#include <boost/mpl/for_each.hpp>
#include <boost/mpl/push_front.hpp>
#include <boost/mpl/empty_sequence.hpp>
#include <boost/type_traits/is_same.hpp>

using namespace boost::mpl;
using namespace boost;

// A type map. Implem #N of type Key is type (default: void)

template <typename Key, int N>
struct Implem
{
  public:
    typedef void type;
};

// Type vector building functions
// void, the default type, is used to stop the recursion

template <typename Key, int N = 1>
struct ImplemToList;

template <typename Key, typename Item, int N>
struct ImplemListItem
{
  public:
    typedef typename push_front<typename ImplemToList<Key, N + 1>::type, Item>::type type;
};

template <typename Key, int N>
struct ImplemToList
{
  public:
    typedef typename Implem<Key, N>::type item;
    typedef typename eval_if<is_same<item, void>,
                             identity<vector<> >,
                             ImplemListItem<Key, item, N> >::type type;
};

// Example code: an interface with two implems

class Interface
{
  public:
    virtual const char* name() const = 0;
};

class Implem1 : public Interface
{
  public:
    virtual const char* name() const { return "implem_1"; }
};

class Implem2 : public Interface
{
  public:
    virtual const char* name() const { return "implem_2"; }
};

template <>
struct Implem<Interface, 1>
{
  public:
    typedef Implem1 type;
};

template <>
struct Implem<Interface, 2>
{
  public:
    typedef Implem2 type;
};

void print(Interface const& i)
{
  std::cout << i.name() << std::endl;
}

int main()
{
  typedef ImplemToList<Interface>::type IList;
  for_each<IList>(&print);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-22T18:08:27.223

您的类型列表只能手动创建。你提到的问题，不变性，是无法克服的。

# javascript - 使用 A* 标记单元可能去的字段

> ID：10707553
> 
> 赞同：0
> 
> 时间：2012-05-22T18:05:12.860
> 
> 标签：javascript, a-star

我正在使用 A* 算法在六边形地图上找到最短路径。但在我实现 A* 算法之前，我使用[了这个版本](http://dark-project.cz/wesnoth/map-view/1)。（点击单位）

为了找到最短的地方，我已经在使用 A*，现在我想使用 A* 来标记单元可能去的字段。现在我使用这个函数：[Here (line 58)](http://dark-project.cz/wesnoth/js/map/base.js#54)。

我的问题是如何使用 A* 解决这个问题的最佳方法是什么？我必须找到到达每个字段的最短路径并获得路径长度，然后将长度与单元的运动进行比较吗？这个解决方案不好，而且速度很慢......

您对更好的解决方案有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T10:31:27.297

对于类似战斗技术的游戏，我也有类似的问题。

我所做的是执行 A*，但仅当“打开”列表为空（已达到所有十六进制）或此列表中的最小值为无穷大（即十六进制无法访问）时，我才停止。这就像没有“目的地”十六进制。使用此解决方案，您只需传递每个十六进制一次（当它在打开的地图中的最小值时）。

然后你可以用计算的十六进制（封闭列表）做两件事

*   删除所有值（在您的情况下为长度）大于移动的十六进制。这只留下你的单位可以去的十六进制

*   保留这些十六进制，但根据长度显示不同颜色的十六进制。例如颜色取决于到达那里的圈数（这个圈数beeing（长度-1）％运动）。这对玩家很有用，因为他现在可以在地图上看到当前单位的任何（可到达）十六进制的最快路径

另一种可能是当最小值大于移动时停止搜索打开的列表（即你不能一回合去那里）。这将限制您在搜索中使用的十六进制数。

问候

# vector - 使一个点跟随另一个点

> ID：10707565
> 
> 赞同：2
> 
> 时间：2012-05-22T18:05:57.927
> 
> 标签：vector, lua, love2d

我正在编写一个**非常快速**的迷你游戏，但我没有任何矢量实现。这就是我所拥有的：

```
local qx = manx
        local qy = many
        local px = bigenemyx
        local py = bigenemyy
        local vx = qx - px
        local vy = qy - py
        local mag = math.sqrt(vx^2 + vy^2)
        bigenemyx = bigenemyx + mag * speed * dt
        bigenemyy = bigenemyy + mag * speed * dt 
```

`bigenemy`需要遵循`man`。`bigenemy`只是从屏幕上消失。我已经为此编写了代码，并且（显然）在这方面的数学方面没有经验，感谢您的帮助-如果我没有想清楚，我深表歉意，我并没有真正坚持“速度更快，速度更快”！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T18:11:55.030

好吧，您在各个方向都使用“mag”值-这不好。尝试

```
 if(mag < 0.0001): mag = 1
    bigenemyx = bigenemyx + (vx/mag) * speed * dt
    bigenemyy = bigenemyy + (vy/mag) * speed * dt 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T18:11:01.970

你的问题在最后两行。无论如何，您都在将敌人朝 <1,1> 的方向移动。尝试：

```
bigenemyx = bigenemyx + vx/mag*speed*dt
bigenemyy = bigenemyy + vy/mag*speed*dt 
```

所以你从 v 得到方向。

# repeat - 是否可以在因子代码中创建重复功能？

> ID：10707566
> 
> 赞同：2
> 
> 时间：2012-05-22T18:06:09.850
> 
> 标签：repeat, factor-lang

我正在尝试在因子代码中创建一个名为 repeat 的函数，该函数需要一个非负整数 n 并在其后加上引号 q。它导致 q 和 n 从堆栈中弹出，然后 q 的内容执行 n 次。

所以如果代码

```
[drop] 5 repeat 
```

被执行它会应用 drop 到栈顶 5 次。

我想知道是否可以在因子代码中编写它，或者我是否必须编辑解释器并以这种方式添加重复作为新函数？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-19T11:51:08.757

使用递归：

```
: repeat ( quot n -- ) dup 0 > [ over 2dip 1 - repeat ] [ 2drop ] if ; inline 
```

使用循环：

```
: repeat ( quot n -- ) [ dup 0 > ] [ over 2dip 1 - ] while 2drop ; inline 
```

最后，使用预定义的词汇单词`times`：

```
: repeat ( quot n -- ) swap times ; inline 
```

# process - Autohotkey 杀死挂起的进程

> ID：10707567
> 
> 赞同：1
> 
> 时间：2012-05-22T18:06:10.003
> 
> 标签：process, kill, autohotkey, hung

我发现了一种查找挂起进程的方法，但无论我使用什么方法，我似乎都无法杀死它：

```
 #Persistent
    Menu, Tray, Icon, User32.dll, 2
    SMTO_NOTIMEOUTIFNOTHUNG := 8      
    Delay = 200                    
    SetTimer, CheckAllWindows, 10
    Return

    CheckAllWindows:
      SetTimer, CheckAllWindows, Off
      WinGet, hWnd, List

      Loop, %hWnd%           {

            ID := hwnd%A_Index%

            DllCall("SendMessageTimeout", UInt,ID, UInt, 0, Int,0, Int,0
                    , UInt, SMTO_NOTIMEOUTIFNOTHUNG, Int,3, "UInt *", Result )

            WinGetTitle, Title, ahk_id %ID%
        PID := DllCall("GetCurrentProcessId")
            IfNotEqual,Result,0,GoSub,Alert

            Sleep %Delay%
                             }
      SetTimer, CheckAllWindows, %Delay%
    Return

Alert: ; This routine can be used to repeat testing & offer a WinKill.
Process, Close, PID
Sleep 50000
Run, "C:\Program Files\sample_file.exe"
Return 
```

现在，程序发现进程挂起并运行文件，但不会关闭。我也尝试过 WinClose - 没有运气。想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T12:48:43.353

Feren6，我希望我没有压倒你，但是我曾经剪辑过这段文字，我还没有使用它，希望它可以帮助你，特别是HSHELL_ENDTASK。

wParam 的记录值为：

```
1\. HSHELL_WINDOWCREATED
2\. HSHELL_WINDOWDESTROYED
3\. HSHELL_ACTIVATESHELLWINDOW
4\. HSHELL_WINDOWACTIVATED
5\. HSHELL_GETMINRECT
6\. HSHELL_REDRAW
7\. HSHELL_TASKMAN
8\. HSHELL_LANGUAGE
9\. HSHELL_SYSMENU
10\. HSHELL_ENDTASK
11\. HSHELL_ACCESSIBILITYSTATE
12\. HSHELL_APPCOMMAND
13\. HSHELL_WINDOWREPLACED
14\. HSHELL_WINDOWREPLACING
15\. HSHELL_HIGHBIT
16\. HSHELL_FLASH
17\. HSHELL_RUDEAPPACTIVATED 
```

lParam 的类型根据接收到的 wParam 的值而有所不同。对于大多数 wParam 值，lParam 是一个窗口句柄，可以在 AHK 的 Window 命令中用作 ahk_id %lParam%。

一些想法：每当窗口被最小化/最大化时，shell 都会接收 HSHELL_GETMINRECT（带有 shellhook 结构）。脚本可能会监视它以将窗口最小化到托盘。当窗口被重绘时，shell 接收 HSHELL_REDRAW。脚本可以监视它以在其内容更改时激活窗口。

我试过试验，这里有一些例子：

实验一：

在 Windows XP 中，CTRL+ALT+DEL 会带来任务管理器。论坛已经看到一些帖子请求拒绝访问任务管理器的方法。以下脚本在创建时几乎立即检测并关闭 Windows 任务管理器。

代码：

# 执着的

SetBatchLines，-1 进程，优先级，，高

Gui +LastFound hWnd := WinExist()

DllCall("RegisterShellHookWindow", UInt,hWnd) MsgNum := DllCall("RegisterWindowMessage", Str,"SHELLHOOK") OnMessage(MsgNum, "ShellMessage") 返回

ShellMessage（wParam，lParam）{如果（wParam = 1）；HSHELL_WINDOWCREATED := 1 { WinGetTitle, Title, ahk_id %lParam% If ( Title = "Windows Task Manager" ) { WinClose, ahk_id %lParam% ; 运行，Calc.exe；反而 } } }

实验二：

Hooking Shell 消息提供了一种可靠的方法来跟踪上一个活动窗口。请参阅：如何检索最后一个活动窗口？by r0lZ 以下脚本切换活动窗口的 TopMost/TopLevel 样式（始终在顶部开/关）。

代码：

# 执着的

菜单，托盘，NoStandard Menu，托盘，添加，切换 AOT，切换 AOT 菜单，托盘，添加，菜单，托盘，添加，重新加载，ExitScript 菜单，托盘，添加，退出，ExitScript 菜单，托盘，提示，切换 AOT 菜单，托盘, 默认, 切换 AOT

Gui +LastFound DllCall( "RegisterShellHookWindow", UInt,WinExist() ) MsgNum := DllCall( "RegisterWindowMessage", Str,"SHELLHOOK" ) OnMessage( MsgNum, "ShellMessage" ) LastActiveWindowID := WinActive("A")

返回 ; // 自动执行部分结束 //

ShellMessage( wParam, lParam ) { Global LastActiveWindowID If ( wParam = 4 And WinExist( "ahk_id " lParam ) ) { ; HSHELL_WINDOWACTIVATED = 4 LastActiveWindowID := lParam } }

ToggleAOT：WinSet、AlwaysOnTop、Toggle、ahk_id %LastActiveWindowID% 返回

ExitScript: DllCall("DeregisterShellHookWindow", UInt,hWnd) ; 冗余，我猜！IfEqual, A_ThisMenuItem, Reload, Reload ExitApp 返回

运行脚本。单击目标窗口以将其聚焦。双击脚本托盘图标。目标窗口将在 TopMost 和 TopLevel 样式之间切换。

实验三：

我有一个罗技多媒体键盘，但没有安装它附带的软件。我正在使用我自己的 OSD 脚本，它使用 VOLUME_UP /DN/MUTE 键作为热键来触发使用 SoundGet / SoundSet 命令进行调整。

现在我发现，每当我按下多媒体键时，Shell 都会收到通知（ HSHELL_APPCOMMAND ）。lParam 的 HiWord 包含按下的 MM 键的值。所以我改变了我的音量更改 OSD 脚本，使其在没有 HotKeys 或 SoundSet 命令的情况下工作。

代码: Gui, Color, FFFFFF Gui, -Caption +Border +AlwaysOnTop +ToolWindow +LastFound

hWnd := WinExist() , DllCall( "RegisterShellHookWindow", UInt,hWnd ) MsgNum := DllCall( "RegisterWindowMessage", Str,"SHELLHOOK" ) OnMessage( MsgNum, "ShellMessage" )

Gui, Add, Picture, x5 y5 w32 h32 Icon4 vIcon1, SndVol32.exe Gui, Add, Picture, x5 y5 w32 h32 Icon5 vIcon2, SndVol32.exe Loop,25 Gui, Add, Text, x+3 w5 h32 隐藏边框 vText% A_Index% 0x4 ;

返回 ; // 自动执行部分结束 //

ShellMessage( wParam,lParam ) { If ( wParam = 12 AND ( (lParam>>16) >= 8 OR (lParam>>16) <= 10) ) { Gui, Show SoundGet, Volume, MASTER, VOLUME SoundGet, Mute , ， 沉默的

```
 Loop, 25 
   IfLessOrEqual, A_Index, % Round(Volume/4), GuiControl, Show, Text%A_Index%
   Else                                       GuiControl, Hide, Text%A_Index%

 IfEqual, Mute, On, GuiControl, Hide, Icon2
 Else               GuiControl, Show, Icon2

 SetTimer, GuiEscape, 1234
                            }                                      } 
```

GuiEscape: SetTimer, GuiEscape, OFF Gui, Hide

简单地说，当 wParam 为 12 ( HSHELL_APPCOMMAND ) 时， lParam 的 HiWord 包含以下常量之一：

```
* APPCOMMAND_BROWSER_BACKWARD = 1 
```

APPCOMMAND_BROWSER_FORWARD = 2 APPCOMMAND_BROWSER_REFRESH = 3 APPCOMMAND_BROWSER_STOP = 4 APPCOMMAND_BROWSER_SEARCH = 5 APPCOMMAND_BROWSER_FAVORITES = 6 APPCOMMAND_BROWSER_HOME = 7 APPCOMMAND_VOLUME_MUTE = 8 APPCOMMAND_VOLUME_DOWN = 9 APPCOMMAND_VOLUME_UP = 10 APPCOMMAND_MEDIA_NEXTTRACK = 11 APPCOMMAND_MEDIA_PREVIOUSTRACK = 12 APPCOMMAND_MEDIA_STOP = 13 APPCOMMAND_MEDIA_PLAY_PAUSE = 14 APPCOMMAND_LAUNCH_MAIL = 15 APPCOMMAND_LAUNCH_MEDIA_SELECT = 16 APPCOMMAND_LAUNCH_APP1 = 17 APPCOMMAND_LAUNCH_APP2 = 18 APPCOMMAND_BASS_DOWN = 19 APPCOMMAND_BASS_BOOST = 20 APPCOMMAND_BASS_UP = 21 APPCOMMAND_TREBLE_DOWN = 22 APPCOMMAND_TREBLE_UP = 23 APPCOMMAND_MICROPHONE_VOLUME_MUTE = 24 APPCOMMAND_MICROPHONE_VOLUME_DOWN = 25 APPCOMMAND_MICROPHONE_VOLUME_UP = 26 APPCOMMAND_HELP = 27 APPCOMMAND_FIND = 28 APPCOMMAND_NEW = 29 APPCOMMAND_OPEN = 30 APPCOMMAND_CLOSE =31 APPCOMMAND_SAVE = 32 APPCOMMAND_PRINT = 33 APPCOMMAND_UNDO = 34 APPCOMMAND_REDO = 35 APPCOMMAND_COPY = 36 APPCOMMAND_CUT = 37 APPCOMMAND_PASTE = 38 APPCOMMAND_REPLY_TO_MAIL = 39 APPCOMMAND_FORWARD_MAIL = 40 APPCOMMAND_SEND_MAIL = 41 APPCOMMAND_SPELL_CHECK = 42 APPCOMMAND_DICTATE_OR_COMMAND_CONTROL_TOGGLE = 43 APPCOMMAND_MIC_ON_OFF_TOGGLE = 44 APPCOMMAND_CORRECTION_LIST = 45

实验四：

在尝试研究和理解消息时，我编写了这个粗略的 Shell spy 来监视 Shell 接收到的消息：

代码：

# 执着的

Menu,Tray,Add Menu,Tray,Add,&Show, GuiShow Menu,Tray,Default,&Show Gui, Font, s9, Courier New

Gui +ToolWindow +AlwaysOnTop +Resize +LastFound hWnd := WinExist() DllCall( "RegisterShellHookWindow", UInt,hWnd ) MsgNum := DllCall( "RegisterWindowMessage", Str,"SHELLHOOK" ) OnMessage( MsgNum, "ShellMessages" )

Gui, Add, Edit, w512 h512 vMsgs hwndEditC +ReadOnly Gui, Show, x10 y10, Shell Spy

MsgNames = ( HSHELL_WINDOWCREATED HSHELL_WINDOWDESTROYED HSHELL_ACTIVATESHELLWINDOW HSHELL_WINDOWACTIVATED HSHELL_GETMINRECT HSHELL_REDRAW HSHELL_TASKMAN HSHELL_LANGUAGE HSHELL_SYSMENU HSHELL_ENDTASK HSHELL_ACCESSIBILITYSTATE HSHELL_APPCOMMAND HSHELL_WINDOWREPLACED HSHELL_WINDOWREPLACING HSHELL_HIGHBIT HSHELL_FLASH HSHELL_RUDEAPPACTIVATED )

AppCommands = ( APPCOMMAND_BROWSER_BACKWARD = 1 APPCOMMAND_BROWSER_FORWARD = 2 APPCOMMAND_BROWSER_REFRESH = 3 APPCOMMAND_BROWSER_STOP = 4 APPCOMMAND_BROWSER_SEARCH = 5 APPCOMMAND_BROWSER_FAVORITES = 6 APPCOMMAND_BROWSER_HOME = 7 APPCOMMAND_VOLUME_MUTE = 8 APPCOMMAND_VOLUME_DOWN = 9 APPCOMMAND_VOLUME_UP = 10 APPCOMMAND_MEDIA_NEXTTRACK = 11 APPCOMMAND_MEDIA_PREVIOUSTRACK = 12 APPCOMMAND_MEDIA_STOP = 13 APPCOMMAND_MEDIA_PLAY_PAUSE = 14 APPCOMMAND_LAUNCH_MAIL = 15 APPCOMMAND_LAUNCH_MEDIA_SELECT = 16 APPCOMMAND_LAUNCH_APP1 = 17 APPCOMMAND_LAUNCH_APP2 = 18 APPCOMMAND_BASS_DOWN = 19 APPCOMMAND_BASS_BOOST = 20 APPCOMMAND_BASS_UP = 21 APPCOMMAND_TREBLE_DOWN = 22 APPCOMMAND_TREBLE_UP = 23 APPCOMMAND_MICROPHONE_VOLUME_MUTE = 24 APPCOMMAND_MICROPHONE_VOLUME_DOWN = 25 APPCOMMAND_MICROPHONE_VOLUME_UP = 26 APPCOMMAND_HELP = 27 APPCOMMAND_FIND = 28 APPCOMMAND_NEW= 29 APPCOMMAND_OPEN = 30 APPCOMMAND_CLOSE = 31 APPCOMMAND_SAVE = 32 APPCOMMAND_PRINT = 33 APPCOMMAND_UNDO = 34 APPCOMMAND_REDO = 35 APPCOMMAND_COPY = 36 APPCOMMAND_CUT = 37 APPCOMMAND_PASTE = 38 APPCOMMAND_REPLY_TO_MAIL = 39 APPCOMMAND_FORWARD_MAIL = 40 APPCOMMAND_SEND_MAIL = 41 APPCOMMAND_SPELL_CHECK = 42 APPCOMMAND_DICTATE_OR_COMMAND_CONTROL_TOGGLE = 43 APPCOMMAND_MIC_ON_OFF_TOGGLE = 44 APPCOMMAND_CORRECTION_LIST = 45 ） 返回45) 返回45) 返回

ShellMessages(wP,lP) { Global EditC Global mVal := lP GuiControlGet, Msgs Routine := GetMessageName( wP ) IfEqual,Routine,, SetEnv, Routine, UNKNOWN GuiControl,, Msgs, % Msgs " `n`n" Routine " [" wP " ]" If IsLabel(Routine) GoSub, %Routine% ControlSend,, ^{End}, ahk_id %EditC% }

GetMessageName(FieldN=0) { Global MsgNames Loop, Parse, MsgNames, `n IfEqual, A_Index, %FieldN%, Return, A_LoopF​​ield }

GetAppCommand(FieldN=0) { Global AppCommands Loop, Parse, AppCommands, `n IfEqual, A_Index, %FieldN%, Return, A_LoopF​​ield }

未知：HSHELL_WINDOWCREATED：HSHELL_WINDOWACTIVATED：HSHELL_WINDOWDESTROYED：HSHELL_REDRAW：HSHELL_FLASH：HSHELL_ENDTASK：HSHELL_WINDOWREPLACING：HSHELL_WINDOWREPLACED：
HSHELL_RUDEAPPACTIVATED：

WinGetTitle, Title, ahk_id %mVal% WinGetClass, Class, ahk_id %mVal% GuiControlGet, Msgs GuiControl,, Msgs , % Msgs " `n`nhWnd `t: " WinExist("ahk_id" mVal) "`nTitle `t: " Title "`nClass`t:" 类

返回

HSHELL_GETMINRECT：返回

HSHELL_APPCOMMAND: GuiControlGet, Msgs GuiControl,, Msgs, % Msgs " // " GetAppCommand( mVal >> 16 ) 返回

GuiClose: Gui, Show, Hide Return

GuiShow: Gui, Show, Return

它并不详尽，但有助于理解这些东西是如何工作的。

运行上述代码后，运行计算器并将其从标准模式更改为科学模式。会发现计算器窗口被破坏并重新创建导致句柄发生变化。（ 我不知道 ）

有趣的是，我发现每当窗口闪烁其标题栏/任务栏按钮时，Shell 都会收到一个未记录的 (AFAIK) 值 0x8006 ( 32774 )。以下代码激活了一个正在闪烁的窗口：（不确定它是否适用于所有人）：

代码： Gui +LastFound

hWnd := WinExist() , DllCall( "RegisterShellHookWindow", UInt,hWnd ) MsgNum := DllCall( "RegisterWindowMessage", Str,"SHELLHOOK" ) OnMessage( MsgNum, "ShellMessage" )

返回 ; // 自动执行部分结束 //

ShellMessage（wParam，lParam）{如果（wParam=0x8006）；0x8006 是 32774，如 Spy! { WinActivate, ahk_id %lParam% } }

# android - ListView 滚动 - 一个一个

> ID：10707568
> 
> 赞同：3
> 
> 时间：2012-05-22T18:06:11.437
> 
> 标签：android, android-widget, android-listview

我有一个必须一次显示 4 个项目的 ListView。我必须逐项滚动。

用户滚动 ListView 后，我必须重新调整滚动以适应 4 个项目。我的意思是，我不能将一个项目显示一半。

另一个问题，有什么方法可以获取当前的 ListView scrollY 偏移量？因为listView.getScrollY()方法来自View，而不是ListView里面的Scroller对象。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-07-13T11:53:00.230

我找到了一个很好的解决方案。它对我来说很完美。可能是我的回答会帮助某人。

```
class ScrollListener implements AbsListView.OnScrollListener{
        boolean aligned;

        @Override
        public void onScrollStateChanged(AbsListView absListView, int state) {
            if (state == AbsListView.OnScrollListener.SCROLL_STATE_TOUCH_SCROLL) {
                aligned = false;
            }
            if (state == AbsListView.OnScrollListener.SCROLL_STATE_IDLE) {
                if (!aligned) {
                    if (Math.abs(absListView.getChildAt(0).getY()) < Math.abs(absListView.getChildAt(1).getY())) {
                        listView.smoothScrollToPosition(absListView.getFirstVisiblePosition());
                    } else {
                        listView.smoothScrollToPosition(absListView.getLastVisiblePosition());
                    }
                }
                aligned = true;
            }
        }

        @Override
        public void onScroll(AbsListView absListView, int firstVisibleItem, int visibleItemCount, int totalItemCount) {
        }
    } 
```

我必须说，在我的情况下，我有两个可见的项目，所以如果你有 4 个，你应该使用索引`("getChildAt(0)" and "getChildAt(1)")`。祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T20:55:55.937

您可以在 ScrollView 上实现传感器“OnTouchListener”。然后该技术是在该人没有至少滚动到项目的高度之前不要滚动。代码示例：

```
scroll.setOnTouchListener(new OnTouchListener()
{
     private int mLastY;
     public boolean onTouch(View v, MotionEvent event) 
     {          
        switch (event.getAction()) 
        {
            case MotionEvent.ACTION_DOWN:   //the user places his finger on the screen
                mLastY=(int)event.getY();   //to get the "y" position starting
                break;
            case MotionEvent.ACTION_MOVE:
                if(mLastY-event.getY() >= theSizeOfItem) //if a movement of the size of an item occurs
                {   
                    scroll.scrollTo(0, scroll.getScrollY()+ theSizeOfItem));
                    scroll.invalidate();
                    mLastY=(int)event.getY();   //reset the starting position to the current position                       

                }
                if(event.getY()-mLastY >= theSizeOfItem) //if a movement of the size of an item occurs
                {   
                    scroll.scrollTo(0, scroll.getScrollY() - theSizeOfItem));
                    scroll.invalidate();
                    mLastY=(int)event.getY();   //reset the starting position to the current position                       

                }
                break;
            default:
                break;
        }
        return v.onTouchEvent (event); //to use other sensors (OnClick, OnLongClick, ...)
    }}); 
```

然后必须执行滚动到达末尾的情况！对不起我的英语，我希望它会帮助你

# vba - vbScript 打开 excel 但不加载宏/模块？

> ID：10707574
> 
> 赞同：1
> 
> 时间：2012-05-22T18:07:03.900
> 
> 标签：vba, vbscript, excel, excel-2010

我处于一个非常奇怪的情况。我创建了一个可以打开我的 excel 文件的 vbs 脚本。我在 WorkBook_open 方法中定义了 vba 代码。我认为创建一个 vbs 脚本来打开我的 excel 会调用我的 workBook_open 方法并执行其中的 vba 代码。但是我错了。下面是我的vbs代码。

```
filePath = "E:\data_extracts\mydata.xlsm"
Set oExcel = CreateObject("Excel.Application")
oExcel.Workbooks.Open(filepath)
oExcel.Visible = True
oExcel.Run "RefreshDataFromIQY"
oExcel.ActiveWorkbook.Save
oExcel.ActiveWorkbook.Close
oExcel.Quit
Set oExcel = Nothing 
```

在调试时，它在 oExcel.Run "RefreshDataFromIQY" 处失败，说明宏不可用或已禁用。因此，代码只是成功打开了 excel 应用程序，仅此而已。我在模块 1、模块 2 中有宏代码。我如何/在哪里编写以在下面的 vbs 脚本中执行我的宏。我的宏/模块必须按顺序执行，我的一些宏是录制的宏。任何帮助深表感谢。谢谢。

感谢您的意见斯科特。这是我对代码所做的更改

```
Dim oExcelApp
Dim oExcelWkb

set oExcelApp = createobject("Excel.Application")
set oExcelWkb = oExcelApp.Workbooks.Open("\\myserver\data_extracts\TestTOPTMay307.xlsm")
oExcelWkb.Close True
oExcelApp.Quit 
```

但是，在从命令行运行它时，它给了我运行时错误 Object required: 'Close'。知道为什么吗？为什么无法关闭？我究竟做错了什么？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T18:46:35.393

我刚刚针对我制作的虚拟文件测试了您的代码。当我将代码放在模块中并将其保留为公开时，它就起作用了。但是，当我放入一个私有模块 - > 像工作表级别模块时，我得到了你得到的错误。

但是，当我引用私有对象时，代码运行通过。所以我对你的回答是替换

```
oExcel.Run "RefreshDataFromIQY" 
```

和

```
oExcel.Run "[yourClassName].RefreshDataFromIQY" 
```

此外，我还在我的文件中放置了一个 workbook_event。该事件在打开时成功触发，所以如果你的有问题，它很可能在事件内部的代码中。

# timer - Yii 有定时器吗？

> ID：10707575
> 
> 赞同：0
> 
> 时间：2012-05-22T18:07:06.997
> 
> 标签：timer, yii

我现在正在使用框架 Yii 开发一个网站，我需要使用计时器来限制某个页面的访问时间，但我不知道如何处理它。即，用户在填写表格时，必须在有限的时间内完成填写，否则不允许填写剩余的表格。我想知道我应该怎么做以及在哪里可以找到满足我需要的计时器？非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T09:35:57.113

不，Yii 中没有可用的计时器。正如@Imre L 建议的那样，在服务器端使用会话。

# java - java中的正则表达式替换多行中的模式

> ID：10707578
> 
> 赞同：-2
> 
> 时间：2012-05-22T18:07:13.267
> 
> 标签：java, regex, pattern-matching

我想将此文件输入替换为 html 表：

```
 ip add                  St Stat  Type Mode   ip only       class  numbers   
 ------------------------------ -- ----- ---- ---- --------------- ------ -----  
 ABC_127.562.200.5/32           -    up  ABC  -    127.562.200.5          5      
 ABC_127.292.200.3/32           -    up  ABC  -    127.562.200.5          4      
 ABC_127.262.200.13/32          -    up  ABC  -    127.562.200.5          3  
 ABC:jdnsajkds 
```

我知道这将以“ABC”结尾，但我无法弄清楚为什么“/”也会出现在输入中

```
import java.util.regex.*;

interface LogExample {

    public static final int NUM_FIELDS = 7;

    public static final String logEntryLine = "ABC_127.562.200.5/32 **space**        -- **space**    up **space**  ABC **space** -- **space**    127.562.200.5 **space**         5 **space** ";

}

public class LogRegExp implements LogExample {

    public static void main(String argv[]) {

        String logEntryPattern = "";//thats i am not getting

        System.out.println("Using RE Pattern:");
        System.out.println(logEntryPattern);

        System.out.println("Input line is:");
        System.out.println(logEntryLine);

        Pattern p = Pattern.compile(logEntryPattern);
        Matcher matcher = p.matcher(logEntryLine);
        if (!matcher.matches() || 
                NUM_FIELDS != matcher.groupCount()) {
            System.err.println("Bad log entry (or problem with RE?):");
            System.err.println(logEntryLine);
            return;
        }
        System.out.println("name + IP Address: " + matcher.group(1));
        System.out.println("status1: " + matcher.group(2));
        System.out.println("status2: " + matcher.group(3));
        System.out.println("type: " + matcher.group(4));
        System.out.println("mode: " + matcher.group(5));
        System.out.println("IP Address: " + matcher.group(6));
        System.out.println("class: " + matcher.group(7));
        System.out.println("numbers: " + matcher.group(8));

    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T22:08:17.187

由于您的课程列是空白的，我们无法做太多事情来提取该信息。但是这个正则表达式将匹配您拥有的 7 列数据：

```
 String logEntryPattern = "(\\S+)\\s+(\\S+)\\s+(\\S+)\\s+(\\S+)\\s+(\\S+)\\s+(\\S+)\\s+(\\S+)"; 
```

我们需要转义 Java 字符串文字中的反斜杠。

```
 System.out.println("name + IP Address: " + matcher.group(1));
    System.out.println("status1: " + matcher.group(2));
    System.out.println("status2: " + matcher.group(3));
    System.out.println("type: " + matcher.group(4));
    System.out.println("mode: " + matcher.group(5));
    System.out.println("IP Address: " + matcher.group(6));
    System.out.println("numbers: " + matcher.group(7)); 
```

坦率地说，正则表达式对于您想要做的事情有点多 - 只是对空格进行标记也可以 - 但它可以完成工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-27T10:52:12.123

我得到了解决方案：

```
import java.util.regex.Matcher;
import java.util.regex.Pattern;

public class RegexMatches
{
    public static void main( String args[] )
    {
        // String to be scanned to find the pattern.
        // String line = "MSEM-E-031_TO_RVBC-R-001_T1    en   up  TE   ingr 124.252.200.2   ELSP   0";
        // String pattern = "((\\-{8})+.*?)";
        String line = "ADR-SSF-1008-M008              vlan  en dn 10081008";
        String pattern = "((\\-{6})+.*?)";

        // Create a Pattern object
        Pattern r = Pattern.compile(pattern);

        // Now create matcher object.
        Matcher m = r.matcher(line);
        if (m.find( ))
        {
            System.out.println("Found value: " + m.group(0) );
            System.out.println("Found value: " + m.group(1) );
            System.out.println("Found value: " + m.group(2) );
        }
        else
        {
            System.out.println("NO MATCH");
        }
    }
} 
```

# java - 如果用户没有价值，则在 JSP 中显示代码 - 不工作

> ID：10707580
> 
> 赞同：0
> 
> 时间：2012-05-22T18:07:24.907
> 
> 标签：java, spring, jsp, jstl

如果用户在系统中没有设置，我正在尝试向我的 Spring JSP 添加一些代码以显示自治市镇列表。

这是我的 JSP 代码：

```
<form:hidden path="borough" />
            <c:choose>
                <c:when test="${empty borough}">
                            <tr>
                            <td width="129"><span class="ast">*</span>Borough: </td>
                            <td width="361">
                                    <form:select path="borough">
                                          <form:option value="Staten Island">Staten Island</form:option>
                                          <form:option value="Queens">Queens</form:option>
                                          <form:option value="Brooklyn">Brooklyn</form:option>
                                          <form:option value="Bronx">Bronx</form:option>
                                          <form:option value="Manhattan">Manhattan</form:option>
                                    </form:select>              
                            </td>
                        </tr>
                </c:when>
                <c:otherwise>
                        <form:hidden path="borough" />
                </c:otherwise>
            </c:choose> 
```

c:choose 之前的隐藏字段仅用于调试。这是我的输出：

```
<input id="borough" name="borough" type="hidden" value="Queens"/>

                            <tr>
                            <td width="129"><span class="ast">*</span>Borough: </td>
                            <td width="361">
                                    <select id="borough" name="borough">
                                          <option value="Staten Island">Staten Island</option>
                                          <option value="Queens" selected="selected">Queens</option>
                                          <option value="Brooklyn">Brooklyn</option>

                                          <option value="Bronx">Bronx</option>
                                          <option value="Manhattan">Manhattan</option>
                                    </select>               
                            </td>
                        </tr> 
```

所以看起来它认为自治市镇总是空的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T18:42:16.213

你的“commandName”属性是`<form:form>`什么？您需要将 borough 作为命令对象的属性。例如：

```
<c:when test="${empty command.borough}"> 
```

# java - 只用几行 Java 就可以解析 XML？

> ID：10707585
> 
> 赞同：2
> 
> 时间：2012-05-22T18:07:49.580
> 
> 标签：java, xml-parsing

考虑以下 XML：

```
<?xml version="1.0" encoding="ISO-8859-1"?>
<CATALOG>
    <CD>
        <TITLE>Empire Burlesque</TITLE>
        <ARTIST>Bob Dylan</ARTIST>
        <COUNTRY>USA</COUNTRY>
        <COMPANY>Columbia</COMPANY>
        <PRICE>10.90</PRICE>
        <YEAR>1985</YEAR>
    </CD>
    <CD>
        <TITLE>Hide your heart</TITLE>
        <ARTIST>Bonnie Tyler</ARTIST>
        <COUNTRY>UK</COUNTRY>
        <COMPANY>CBS Records</COMPANY>
        <PRICE>9.90</PRICE>
        <YEAR>1988</YEAR>
    </CD>
</CATALOG> 
```

我想解析这个 XML 并将以下内容打印到标准输出：

```
Bob Dylan recorded Empire Burlesque in 1985.
Bonnie Tyler recorded Hide your heart in 1988. 
```

在 Java 中执行此操作的最简单方法是什么？

我很沮丧，因为我可以在某些语言中用 5 或 6 行来解析这个 XML，但在 Java 中，我知道的唯一方法是编写自己的 SAX 解析器，这意味着我需要大约 50 行代码；我可能在其他地方使用的 10 倍！Java 是否有适合此类简单任务的超级简单的 XML 解析器？

（我知道有类似的问题，但它们要么不包含示例，要么示例涉及长的、部分的和/或深度嵌套的 XML。这个问题有一个简单的示例，希望能通过工作代码得到一些好的答案来区分它。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T18:17:36.070

试试[XOM](http://www.xom.nu/)。

```
 import nu.xom.*;

    List<Element> cds = new Builder().build(inputFile).getRootElement().query("CD");
    for (Element e : cds) {
        System.out.println(e.getFirstChildElement("ARTIST").getValue() 
            + " recorded " 
            + e.getFirstChildElement("TITLE").getValue() 
            + " in " 
            + e.getFirstChildElement("YEAR").getValue());
    } 
```

# android - OnSharedPreferenceChangeListener 是否会随着它注册的 SharedPreference 实例而死？

> ID：10707586
> 
> 赞同：0
> 
> 时间：2012-05-22T18:07:50.177
> 
> 标签：android, listener, sharedpreferences, onchange, android-preferences

假设在*Activity A*中，我获得了一个名为*sharedPrefs的**SharedPreferences*实例，然后我在其上调用*registerOnSharedPreferenceChangeListener(myListener)*方法，传递一个名为*myListener的**OnSharedPreferenceChangeListener*对象，以对*sharedPrefs*链接到的首选项的更改做出反应。

 ***我的问题如下：即使*sharedPrefs*超出范围，即被销毁/垃圾收集，*myListener的**onSharedPreferenceChanged*方法是否也会被调用，或者我是否需要在*Activity A*实例变量中保存对*sharedPrefs*指向的对象的引用确定我会在整个*Activity A生命周期中收到**更改的首选项*事件吗？

 **** * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T18:48:53.477

由于实例有一个注册的监听器，这两个对象不会被垃圾回收，监听器会被调用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T06:15:48.707

我认为我的问题的答案可能是：是的，当它连接到的*SharedPreferences实例被**垃圾收集时，* *OnSharedPreferenceChangeListener*死亡（即不再被调用），但是一旦使用*getSharedPreferences获得引用，**它就不会发生*（或类似方法）超出范围，因为该方法返回一个*单例*，即对返回的对象有一个静态引用，存储在某处，这将使对象保持活动状态。因此您不必担心存储*getSharedPreferences*返回的对象（尽管您可以避免再次调用*getSharedPreferences********)，因为这些方法总是返回对同一个对象的引用。您唯一需要担心的是存储对您传递给*registerOnSharedPreferenceChangeListener的**OnSharedPreferenceChangeListener*对象的引用，以便在您需要在 unregisterOnSharedPreferenceChangeListener 中取消注册它们时*（*这里您需要传递您传递给*register方法的**相同实例*，否则它们是不是*未注册*的）。感谢 ChristopheCVB 为我指明了正确的方向。*************

# database - 空字符串数据库和空字符串数据库的存储要求的区别

> ID：10707589
> 
> 赞同：-1
> 
> 时间：2012-05-22T18:07:57.073
> 
> 标签：database

让我们从概念上抛开null和空字符串的含义，我想知道哪个对存储有利。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T18:10:54.977

可以包含 NULL 值的列通常每行额外使用一位来标记它是否为 NULL。这可能取决于数据库系统；例如，SQLite 对每个值都有数据类型，因此 null 值在更基本的层面上与字符串值不同。

对于 MySQL，请在手册中考虑[这一点：](https://dev.mysql.com/doc/refman/5.5/en/dynamic-format.html)

> 使用以下表达式计算动态大小行的预期行长度：
> 
> ```
> 3
> + (number of columns + 7) / 8
> + (number of char columns)
> + (packed size of numeric columns)
> + (length of strings)
> + (number of NULL columns + 7) / 8 
> ```

# objective-c - NSControl 子类不应该改变 firstResponder

> ID：10707590
> 
> 赞同：0
> 
> 时间：2012-05-22T18:07:57.177
> 
> 标签：objective-c, cocoa, nswindow, appkit, nsresponder

我将标签栏视图实现为 NSControl 子类。

![在此处输入图像描述](../Images/40ee8ba80607bcf1d631feefa2e38053.png)

当我单击它时，AppKit 将尝试更新`firstResponder`我的 NSWindow。因为我不希望 tabbar 成为`firstResponder`（`acceptsFirstResponder`返回`NO`） NSWindow 本身将成为`firstResponder`. 我的响应者链将由窗口及其控制器组成，并且不会将任何操作消息传递到选项卡栏下方的子视图（NSOutlineView）。当我单击标签栏时，我希望 NSOutlineView 继续接收操作消息和事件。

这样做的适当方法是什么？有没有办法阻止 NSView 尝试更改`firstResponder`被点击的时间？

我考虑过将工具栏设置为 NSOutlineView，但Apple 不建议`nextResponder`手动更改NSView。`nextResponder`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T19:00:49.970

我最终`firstResponder`在标签栏的委托方法实现中手动将其重置为大纲视图。

我想出的另一个解决方案是在 tabbar 中实现它以重置`firstResponder`为原始对象，如果 tabbar 变为`firstResponder`.

```
- (void)awakeFromNib {
    [self.window addObserver:self
                  forKeyPath:@"firstResponder"
                     options:NSKeyValueObservingOptionOld
                     context:nil];
}

- (void)observeValueForKeyPath:(NSString *)keyPath ofObject:(id)object 
                        change:(NSDictionary *)change context:(void *)context {
    NSResponder *oldResponder = [change objectForKey:NSKeyValueChangeOldKey];
    if (self.window.firstResponder == self) {
        [self.window makeFirstResponder:oldResponder];
    }
} 
```

# android - 从一个活动导航到另一个活动时删除黑屏

> ID：10707597
> 
> 赞同：1
> 
> 时间：2012-05-22T18:08:30.937
> 
> 标签：android, android-activity

我的应用程序面临问题。我的应用程序中有一个按钮`activity`，它将在另一个应用程序中显示 Wi-fi 打印机列表`activity`。

但是当从一个移动`activity`到另一个时，会出现一个黑屏，然后我会得到打印机列表。

需要注意的一点：我有一个`LIST`不是`array of list`。如何解决这个问题呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T18:21:53.133

用于`AsyncTask`搜索打印机。执行`OnCreate()`列表活动中的异步任务，并显示一个进度对话框，直到搜索完成。用例子检查[文档here](http://developer.android.com/reference/android/os/AsyncTask.html)

# jquery - jquery .html 挂起

> ID：10707598
> 
> 赞同：0
> 
> 时间：2012-05-22T18:08:31.813
> 
> 标签：jquery, html, freeze

我有一个带有链接按钮的 asp.net 网站。在链接按钮中有：

```
OnClientClick="checkDisableButton(this.id, 'PROCESSING', 'V');" 
```

在函数中有这个代码......

```
$('#' + btn).addClass("buttonPad");
$('#' + btn).html(parmText + "|"); 
```

我在上面的第一行设置了一个断点。事情是..有时代码运行良好..有时它只是挂在第二行。我正在使用 IE 9 进行测试。我做错了什么，它会挂起。
谢谢香农这是整个事情

```
function checkDisableButton(btn, parmText, icon) {
$('#' + btn).addClass("buttonPad");
$('#' + btn).html(parmText + "|");
    $('#' + btn).click(function (e) {
        e.preventDefault();
    }
);
document.getElementById(btn).className  = 'buttonProcessing button '; 
```

}

出色地。我更改了代码.. 我开始使用 asp:button 并使用 css 让它看起来与我在 asp:linkbutton 上所做的一样。到目前为止.. 测试表明 asp:button 正在工作.. 我将不得不做更多测试.. 但到目前为止一切都很好

~~~~~~~~ 我再次更改了代码...回到我原来的状态.. 使用 asp:linkbutton.. 但这里是新的 javascript 代码，似乎可以正常工作。

```
function checkDisableButton(btn, parmText, icon) {
$('#' + btn).addClass("buttonPad buttonProcessing button");
$('#' + btn).text(parmText + "   |   ")
$('<span></span>', {
    text: icon,
    class: 'WebFonts'
}).appendTo('#' + btn);
$('#' + btn).attr('disabled', ''); 
```

}

我知道我应该为 $('#' + btn) 使用 var .. 但我还没有走得那么远.. 我不太擅长这个，这可能需要我一点点。无论如何..这就是它的价值

# javascript - 打开对话框时如何禁用页面滚动？

> ID：10707608
> 
> 赞同：2
> 
> 时间：2012-05-22T18:09:03.110
> 
> 标签：javascript, jquery, css, dialog

我在响应命令时打开并在离开悬停时关闭的 jquery 对话框遇到了很大的麻烦`.hover()`（这当然需要两个功能）。

当对话框打开一点点离开页面时，整个页面向上滚动；我想禁用它，但我不知道如何。

我努力了：

1.  使用`event.preventDefault()`
2.  把`ui-dialog`css作为`'position: relative'`
3.  将滚动条设置回原来的位置（但这看起来很糟糕）

还有其他想法吗？

编辑：这是 jsfiddle 中的代码：http: [//jsfiddle.net/TzUf3/1](http://jsfiddle.net/TzUf3/1)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T15:35:33.030

确保弹出窗口的位置固定，然后将主体设置为溢出：隐藏；

当对话关闭时，移除溢出属性。

# html - .swf 电影如何使用 HTML 根据不同的分辨率调整大小？

> ID：10707612
> 
> 赞同：0
> 
> 时间：2012-05-22T18:09:18.443
> 
> 标签：html

我使用 HTML 制作了一个表格，并在一个 TD 中连续插入了 6 部 .swf 电影，我希望它们根据屏幕分辨率调整自己的大小，就好像所有 .swf 电影的宽度都是 150 像素一样，它需要 900 像素才能被显示，但如果显示在宽度为 800px 或更小的屏幕上，滚动条会出现在我不想要的下方，我希望它们调整大小以便没有滚动条，所以我该怎么做。请帮我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T18:48:40.980

例如，尝试将每个 swf 的宽度设置为相对宽度

```
width="15%" 
```

相对于：

```
width="150px" 
```

有可能看到你的 HTML 吗？

# jquery - jquery fancybox 无法从 Google 高性能图像服务加载图像

> ID：10707613
> 
> 赞同：0
> 
> 时间：2012-05-22T18:09:18.540
> 
> 标签：jquery, python, google-app-engine, fancybox

Jquery fancybox 2：无法加载请求的内容。请稍后再试当我尝试加载时：

```
<div>
    <div>
        <a id="gae2" class="fancybox" href="https://lh3.ggpht.com/v22LQz8PX33f0Te34XmfyzOwgYHj_JDqVeD2nGzgvbzokD9MQ4qiUqT736a8xnErq6F6BHH8pEIM3VXW0zkUF-0GVp6l=s0">
            <img alt="gae1" src="https://lh4.ggpht.com/-KEglAPDnG3_y3hyFQCINGNg5ZxsRw5GRylPRrYFPTLmnNk0yQO4FGu1z1E92WljXhxH3SP3h8MBHkdbMvEenJ6RfcCwNw=s0">
        </a>
        <p><em>(Click to enlarge)</em></p>
    </div>
</div> 
```

上面的链接是使用images.get_serving_url（Python GAE）生成的并且工作正常，但fancybox无法处理它们。

和我的 javascript：

```
 $(".fancybox").fancybox({
        openEffect  : 'none',
        closeEffect : 'none'
    }); 
```

有任何想法吗？当我尝试加载 /images/test.jpg 之类的内容时，Fancybox 工作正常。

# python - 无法更改 PySide.QtGui 对象的 __class__

> ID：10707618
> 
> 赞同：3
> 
> 时间：2012-05-22T18:09:47.213
> 
> 标签：python, pyqt4, pyside

我经常使用 PyQt4 - 有时我喜欢重载一些对象以允许我添加一些功能。这在 PyQt4 中运行良好，例如：

```
from PyQt4 import QtGui
button = QtGui.QPushButton()
class MyPushButton(QtGui.QPushButton): pass
button.__class__ = MyPushButton 
```

但是，我正在尝试调整我的一些代码，以便它使用 PySide 而不是 PyQt4。我的理解是它们应该具有相同的功能。PySide 不允许我做同样的事情。

```
from PySide import QtGui
button = QtGui.QPushButton()
class MyPushButton(QtGui.QPushButton): pass
button.__class__ = MyPushButton 
```

这与以下错误有关：

```
TypeError: __class__ assignment: only for heap types 
```

还有另一种方法可以更改对象的类以避免此错误吗？我不确定是什么原因造成的。

*注意：我需要在创建对象后更改对象的类，因为对象是在 pyuic 编译的库中创建的。我的 PySide 安装也没有 uic 模块。*

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-02-20T18:15:43.127

PySide 使用[Shiboken](http://shiboken.readthedocs.org/en/latest/)从其 C++ 类生成 Qt 的 CPython 绑定。所有的 Qt python 类，例如`QPushButton`都是用 C++ 实现的，这就是为什么你不能覆盖`__class__`.

```
>>> button = QPushButton()
>>> button.__class__ = MyButton
TypeError: __class__ assignment: only for heap types 
```

根据 Shiboken 的文档， 只要方法是虚拟的（可覆盖），您就可以对已实例化的对象上的方法进行[修补（或打孔）：](http://shiboken.readthedocs.org/en/latest/wordsofadvice.html#duck-punching-and-virtual-methods)

```
import types

def override_text(self):
    return 'overridden'

# Bind override_text() to button.
button.text = types.MethodType(override_text, button, QPushButton) 
```

更进一步，您可以将其子类`QPushButton`化为`MyButton`，并将方法从动态注入`MyButton`到`QPushButton` 实例中。创建`MyButton`一个子类纯粹是可选的，但是 除了修改的实例之外，`QPushButton`您还可以创建自己的实例。`MyButton``QPushButton`

让我们定义`MyButton`为 的子类`QPushButton`。

```
class MyButton(QPushButton):

    def text(self):
        # This will override QPushButton's text() method.
        print("inside MyButton.text()")
        return QPushButton.text(self) 
```

*   注意：您必须使用旧式调用父类方法。 `super()`以 a 失败，因为注入方法时`TypeError`self 实际上是 a`QPushButton` 而不是 a 。`MyButton`

或者，如果您想采用更多的 mixin 方法，让我们定义`MyButtonOverrides`：

```
class MyButtonOverrides(object):

    def text(self):
        # This will override QPushButton's text() method.
        print("inside MyButtonOverrides.text()")
        return self.__class__.text(self) 
```

*   注意：您可以直接调用，`QPushButton.text()`因为`self.__class__` 您不会`MyButtonOverrides`直接使用。

现在让我们定义`extend_instance()`哪个会将您的覆盖方法从`MyButton`（或`MyButtonOverrides`）注入到`QPushButton` 实例中：

```
import inspect

def extend_instance(obj, cls):
    for name, attr in vars(cls).items():
        if inspect.isroutine(attr):
            # Bind instance, class and static methods to *obj*.
            setattr(obj, name, attr.__get__(obj, obj.__class__)) 
```

如果您希望您的类方法保持绑定到它们的原始类（例如，`MyButton`），请使用以下内容：

```
def extend_instance(obj, cls):
    for name, attr in vars(cls).items():
        if inspect.isroutine(attr):
            if isinstance(attr, classmethod):
                # Bind class methods to *cls*.
                setattr(obj, name, attr.__get__(cls, cls))
            else:
                # Bind instance and static methods to *obj*.
                setattr(obj, name, attr.__get__(obj, obj.__class__)) 
```

通过我的测试，这适用于 Python 2.7 和 3.3，但应该适用于 2.6+ 和 3+。

最后要修改按钮，使用`extend_instance()`.

```
>>> button = QPushButton()
>>> extend_instance(button, MyButton)
>>> button.text()
inside MyButton.text()
u'' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-02-20T21:27:47.060

猴子补丁`__class__`是完全没有必要的。相反，您应该在 Qt Designer 中[提升](http://qt-project.org/doc/qt-4.8/designer-using-custom-widgets.html#promoting-widgets)相关的小部件，以便它们自动使用您的子类。

为此，在 Qt Designer 中，右键单击小部件并选择“Promote to...”。在对话框中，将“Promoted class name”设置为您的子类（例如“MyPushButton”），并将“Header file”设置为包含子类的模块的python导入路径（例如“myapp”或“myapp.gui”，管他呢）。

现在单击“Add”，然后单击“Promote”，您将在 Object Inspector 窗格中看到类从“QPushButton”更改为“MyPushButton”。

`pyuic`当您使用or重新生成 ui 模块时`pyside-uic`，它将包含如下代码：

```
class Ui_Window(object):
    def setupUi(self, Window):
        ...
        self.button = MyPushButton(Window)
        self.button.setObjectName("button")
        ...

from myapp import MyPushButton 
```

因此，提升按钮将被创建为 的实例`MyPushButton`，并且不再需要破解`__class__`。

这种提升小部件的技术适用于 PyQt 和 PySide。

# jasper-reports - iReport 查询结果按周或天细分

> ID：10707620
> 
> 赞同：0
> 
> 时间：2012-05-22T18:09:53.423
> 
> 标签：jasper-reports, ireport, jasperserver

我使用 iReport 创建了一个在 JasperServer 上运行的简单 JasperReport。它根据创建时间戳从多个 MySQL 表中查询一些字段。我提供了报告中涵盖的时间段的开始和结束时间戳作为 java.sql.Timestamp 类型的参数。这工作正常。

我被要求介绍在报告数据的几周或几天内显示细分的能力。我想从哪里开始获得一些想法。在这一点上，我认为我不能在报告查询中容纳这种“细分”，因为这个功能似乎超出了 SQL 的设计目标。我知道这听起来像是 OLAP 钻取，但我想尽可能避免 OLAP（陡峭的学习曲线，紧迫的期限）。

我的第一个想法是为每周或每天创建一个子报表。但这会给我留下任意数量的子报告（取决于报告所涵盖的总时间段，每次执行都会有所不同），据我所知，iReport 不支持这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T08:30:34.160

这是分解报告的一种方法。

1.  创建另一个参数 groupby，其中包含指定分组要求的值。值可以是数字、字符串或任何其他值，只要它对应于日、周、月等。分组可用。
2.  创建一个报告组，细分，它将提供细分。组表达式将取决于 groupby 参数。表达式是记录上的日期，除了任何比 groupby 值更精细的细节都将被修剪。
3.  创建一个变量total，它将汇总记录中的数据。该变量应在故障组上重置，并且可以打印在故障拖车带中。
4.  确保 sql 查询按日期排序，以便 groupby 表达式有效。

如果您有任何问题，请告诉我。

# arrays - AS3 平台游戏生成

> ID：10707623
> 
> 赞同：0
> 
> 时间：2012-05-22T18:10:18.583
> 
> 标签：arrays, actionscript-3

我试图在玩家面前无限生成 x 距离的平台，但我几乎不知道从哪里开始。他们也不能“堆叠”在彼此之上。目前，我所拥有的如下，没有错误，虽然它占用了相当多的内存，而且我的游戏滞后到了 flash cs3 崩溃的地步

```
function enterFrameHandler(e:Event):void{
    //gravitate the player
    _vy += 1.5;
    //move the player
    Player.x += _vx;
    Player.y += _vy;

    //process collisions
    processCollisions();
    //Process other collisions
    processOtherCollisions();
    //scroll the stage
    scrollStage();
    //Process Key Presses
    KeyHandler();
    //Process Lives once
    LifeHandler();
    //Generate Objects
    generateObjects();
}
//Function for generating objects
var ObjectArray:Array = [];
var ChildrenColliding:Boolean = false;
function generateObjects():void{
    if(_vx > 0){
        var Square:MovieClip;
        Square = new mcSquare();
        Square.x = Math.random() * 500 + Math.abs(_boundaries.x);
        Square.y = Math.random() * stage.stageHeight/2.5 + (stage.stageHeight/2.5);
        ObjectArray.push(Square);
        _boundaries.addChild(Square);
    }
    for(var i in ObjectArray){
        for(var a in ObjectArray){
            if(ObjectArray[a].hitTestObject(ObjectArray[i]) && a != i){
                ChildrenColliding = true;
            }
        }
        while(ChildrenColliding){
        ObjectArray[i].x = Math.random() * 500 + Math.abs(_boundaries.x);
        ObjectArray[i].y = Math.random() * stage.stageHeight/2.5 + (stage.stageHeight/2.5);
        }
    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T20:21:37.233

为什么不只是：

```
ObjectArray.push(Square); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T18:27:50.493

您在此处显示的代码很好。设置`ObjectArray`as`[]`是完全安全的，不应为空。这个故事一定还有更多。

您可以为该课程发布其余代码吗？你还有其他设置的代码`ObjectArray`吗？必须有一行代码在其他地方`ObjectArray`设置为空。

# ruby-on-rails - 使用 Rspec 和 Capybara 测试登录重定向

> ID：10707624
> 
> 赞同：4
> 
> 时间：2012-05-22T18:10:27.273
> 
> 标签：ruby-on-rails, rspec, capybara

这是我正在处理的一个测试用例：

```
 it "should allow you to login" do
    visit "/"
    fill_in 'Email', :with => 'user@example.org'
    fill_in 'Pass', :with => 'password'
    click_button 'Login'
    current_url.should =~ /dashboard/
end 
```

这个特定的测试失败了。我想知道它是否因为无法登录而失败，但因为我检查 current_url 太快而失败。在 click_button 任务执行并且 rails 重定向用户之前“等待”的正确方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T18:16:54.213

您是否尝试过手动访问您的主页，使用这些凭据登录，然后查看会发生什么？如果你能做到，那么你就可以排除它不起作用的想法。

我建议使用内置断言而不是匹配 URL 的名称。像这样：

```
assert_response(:redirect)
assert_redirected_to(dashboard_path) 
```

无论哪种情况，您都不必等待按钮单击。

# vim - Vim/Vi 中是否有命令将光标移动到搜索突出显示的末尾？

> ID：10707626
> 
> 赞同：92
> 
> 时间：2012-05-22T18:10:31.840
> 
> 标签：vim, vi

Vim/Vi 中是否有任何命令可以在选定的搜索段内移动？

例如，如果我搜索一个单词，是否有任何命令可以将光标移动到突出显示的段的末尾？假设我有一个单词“FishTaco”，我想搜索“Fish”的所有实例并在其后插入一些内容。我知道我可以进行全局替换，但是如果我只想在几个非顺序实例中进行更改怎么办？

我可以看到将光标移动到当前突出显示的段的末尾以执行操作会很方便。

* * *

## 回答 #1

> 赞同：148
> 
> 时间：2012-05-22T18:22:13.810

你可以这样做：

`/Fish/e`

`/e`at the end 将光标放在搜索区域的末尾（而不是默认情况下的第一个字符。

* * *

## 回答 #2

> 赞同：85
> 
> 时间：2012-05-22T18:25:44.410

如果您只想将光标放在 Fish 的最后一个字符之后，那么您可以使用

```
/Fish/e+1 
```

这会将光标放在 h 之后。（如果没有`+1`光标，光标将在最后一个字符的左侧结束。）

如果您对将光标放在 Fish 之后特别感兴趣，但仅当它出现在“FishTaco”中时，您可以尝试以下选项之一：

您可以使用

```
/FishTaco/s+4 
```

你的光标最终会在 Fish 和 Taco 之间。`/s+4`光标在搜索词开始后 4 处的位置。

你也可以使用

```
/FishTaco/e-3 
```

这会将光标放置在最后一个（结束）字符左侧的 3 个位置。

你也可以使用

```
/FishTaco/b+4 
```

因为`/b+4`将被视为`/s+4`.

* * *

## 回答 #3

> 赞同：29
> 
> 时间：2012-05-23T05:54:38.263

如果您已经搜索过`/Fish`，您可以通过 快速更改搜索以转到匹配的末尾`//e`，这会重复上次搜索，但会附加`e`已经解释过的修饰符。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2015-06-27T14:21:56.810

`/ long-regexp1 \zs long-regexp2 /` *.. 光标将停在 \zs*，请参阅 :help \zs

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2012-05-22T18:33:42.140

一旦有了视觉选择，您就可以使用`o`在所选块的开始和结束之间切换光标位置。When the selection is line-wise this toggles the *line* position, meaning the cursor moves to the starting and ending line of the selection but not to the starting or ending character. When the selection is character-wise then the movement is also character-wise.

您还可以使用``<`和``>`在可视块的开始和结束之间切换光标，但这会影响选择本身，因此它用于重置或调整选择范围。

编辑：啊，但是对于搜索突出显示，这将不起作用，因为`o`会启动行插入。我猜搜索突出显示与视觉选择不同，抱歉:)

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2012-05-22T22:01:37.123

您问题的“比赛结束时的光标”部分已经得到解答。

你可以做到`:%s/Fish/FishTaco/c`。这使您有机会确认或拒绝每个替换并跳过整个“比赛结束时的光标”业务。

# java - 如何使用花括号在 Java 中定义多维数组？

> ID：10707627
> 
> 赞同：6
> 
> 时间：2012-05-22T18:10:32.510
> 
> 标签：java, arrays, multidimensional-array

我不了解 Java 关于数组的行为。它禁止在一种情况下定义数组，但在另一种情况下允许相同的定义。

教程中的示例：

```
String[][] names = {
        {"Mr. ", "Mrs. ", "Ms. "},
        {"Smith", "Jones"}
    };
System.out.println(names[0][0] + names[1][0]);    // the output is "Mr. Smith"; 
```

我的例子：

```
public class User {
   private static String[][] users;
   private static int UC = 0;

   public void addUser (String email, String name, String pass) {
      int i = 0;

      // Here, when I define an array this way, it has no errors in NetBeans
      String[][] u = { {email, name, pass}, {"one@one.com", "jack sparrow", "12345"} };

      // But when I try to define like this, using static variable users declared above, NetBeans throws errors
      if (users == null) {
         users = { { email, name, pass }, {"one", "two", "three"} };    // NetBeans even doesn't recognize arguments 'email', 'name', 'pass' here. Why?

         // only this way works
         users = new String[3][3];
         users[i][i] = email;
         users[i][i+1] = name;
         users[i][i+2] = pass;
         UC = UC + 1;
      }
    } 
```

NetBeans 抛出的错误是：

*非法的表达开始，*

*“;” 预计*，

*不是声明*。

而且它也不识别数组定义中的参数`email`, 。但是当我定义数组时识别它们。`name``pass``users``u`

这两个定义有什么区别？为什么一个有效，而另一个以相同方式定义的无效？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-22T18:13:00.017

您需要`new String[][]`在数组聚合之前添加：

```
users = new String[][] { { email, name, pass }, {"one", "two", "three"} }; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-22T18:14:29.433

您可以使用以下语法：

```
String[][] u = {{email, name, pass}, {"one@one.com", "jack sparrow", "12345"}}; 
```

*仅*当您第一次声明矩阵时。在您在别处声明`String[][]`变量*后*，它无法为变量赋值，这就是`users = ...`失败的原因。要将值分配给已声明的`String[][]`（或任何其他类型的矩阵），请使用

```
users = new String[][] { { email, name, pass }, {"one", "two", "three"} }; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-22T18:14:03.970

第一种情况是初始化语句，而第二种情况只是赋值。只有在定义新数组时才支持这种填充数组。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-22T18:16:55.640

要重新分配矩阵，您必须使用`new`：

```
users = new String[][] {{email, name, pass }, {"one", "two", "three"}}; 
```

# java - 如何在数据库上处理与日期相关的状态激活？

> ID：10707638
> 
> 赞同：0
> 
> 时间：2012-05-22T18:11:37.013
> 
> 标签：java, mysql, datetime, talend

我的问题有两个。我试图尽可能优雅地处理它。

给出以下格式的日期，

```
 YYYYMMDD hh:mm:ss 
```

如何在不同天数后找到相应的日期？例如，如果给定一个日期，我需要能够找到该格式“x”天之后的相应日期。

这个生成的日期是我将存储在数据库的activation_date 列中的日期。然后我想每晚查询数据库，看看是否是那个日期。如果是这样，我会将不同列中项目的状态从挂起更改为活动。

这似乎是处理我的问题的最佳方法，但它似乎不是很容易解决。

另一种方法是我在数据库中创建一个 days_till_activation 列，并有一个脚本每晚减少该列中每个条目的值，直到达到零。一旦达到零，脚本将更改状态。问题在于这似乎是处理数据库的一种非常糟糕的方式。它涉及到对数据库的大量写入，而不是仅在需要时才这样做。

无论如何，任何想法将不胜感激。我需要在 java 中处理解决方案，但伪代码会很好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T18:18:26.273

> 给出以下格式的日期，
> 
> ```
> YYYYMMDD hh:mm:ss 
> ```

这是你的第一个问题。**不要考虑特定格式的日期。**确保您的数据库模式使用适当的日期/时间字段类型，并在您的 Java 代码中使用适当的类型。除非您将其展示给用户，否则您永远不需要查看字符串表示形式。

幸运的是，这部分很简单：

> 如何在不同天数后找到相应的日期？

我建议尽可能使用[Joda Time来表示您的日期和时间值。](http://joda-time.sf.net)这很容易：

```
LocalDate date = ...;
LocalDate activation = date.plusDays(activationDays); 
```

您*可以*只使用`java.util.Date`/ `Calendar`，但我建议您在从数据库中提取数据时尽快转换为 Joda Time 类型，并在最后一刻转换回本机 Java 类型。这样，您就可以尽可能多地避免 Java 类型的丑陋。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T18:23:17.137

在这种情况下，我会选择一个包含过期时间戳 ( `currentTimeMilis() + x * MILLIES_PER_DAY`) 的整数类型列，使您的查询非常容易（`where expiration < ?`将参数绑定到`currentTimeMilis()`。）

选择日期/时间类型列会增加解决方案的复杂性，使行为依赖于数据库安装（操作系统语言更改可能会产生影响。）

# c++ - 检查线是否穿过 2D 地图上的墙壁

> ID：10707643
> 
> 赞同：1
> 
> 时间：2012-05-22T18:12:03.080
> 
> 标签：c++, map, line, collision, intersect

我有 2d 地图，我想检查线条是否与任何元素发生碰撞。我需要一个函数来告诉我这条线是否在途中与任何对象相交。

看一看：

![在此处输入图像描述](../Images/11e198d6e90a178fc4cbe43486b92080.png)

红线不正确（函数应该返回假），绿线是（返回真）。我的碰撞图是布尔图，1 表示墙壁，0 表示空白空间。

这个怎么办？我读过我需要检查线是否与任何墙壁相交，但我完全不知道如何在 2d 地图上执行此操作。

感谢任何回复。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T18:20:25.747

这取决于你的墙是如何表示的。

如果它们是矩形，则在您的线和代表矩形的 4 个线段之间寻找[线/线段交叉点。](http://en.wikipedia.org/wiki/Line_segment_intersection)

如果是像素点，可以使用[bresenham线](http://en.wikipedia.org/wiki/Bresenham%27s_line_algorithm)算法来查看线上的像素点是否在这些块上。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T18:38:32.123

如果您的墙壁表示为线段，您可以测试线段的交叉点，如 Paul Bourke 所述：[http ://local.wasp.uwa.edu.au/~pbourke/geometry/lineline2d/](http://local.wasp.uwa.edu.au/~pbourke/geometry/lineline2d/)

如果您的墙壁表示为多边形，您可以将测试线剪裁到墙壁多边形上，并查看剪裁结果是否如 Paul Bourke 所描述的那样非空：[http ://local.wasp.uwa.edu.au/~pbourke/geometry /cliplinetopoly/](http://local.wasp.uwa.edu.au/~pbourke/geometry/cliplinetopoly/)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-05-22T18:26:52.867

所以，我想象你的单元格是正方形......假设它们是单位正方形。所以，如果我有任何坐标，对于像浮点数或双精度这样的点，它们在 cell 中。

1.  您需要知道哪些单元格是线的端点
2.  从一个端点直接走到另一个端点，对于每个单元格，测试它是否是一堵墙
3.  找到墙时返回 false，否则返回 true。

要从一个端点走到另一个端点，您需要计算每个轴的增量（调用 delta_x 和 delta_y，这些值是“int”，因为我们在这里讨论的是单元格），即它在垂直方向上的单元格数量和在水平面上。你取两者中最大的一个。您将为循环使用该最大值。假设这个值是 D = max(delta_x, delta_y) 并且 XX 和 YY 是一个端点的单元格的坐标。

```
float step = 1.0f / D;
float current_location = 0.0;
for (int i = 0; i <= D; ++i, current_location += step)
{
  int cur_x = XX + current_location * delta_x;
  int cur_y = YY + current_location * delta_y;
  if (intersect_wall(cur_x, cur_y))
    return false;
}
return true; 
```

就是这样......根据您的功能调整它。

# jquery - Jquery Ajax 调用路径

> ID：10707645
> 
> 赞同：0
> 
> 时间：2012-05-22T18:12:11.277
> 
> 标签：jquery, ajax, path, call

我需要一些解决方案来在我的 jquery ajax 调用中提供相对路径，因为现在我正在使用诸如 ../ 之类的 soem 东西。任何建议都会被高度赞赏。

代码

```
$.ajax({
        type: 'get',
        url: '../../MyPage/getDetails',
        success: function (data) {
            if (data > 0) { 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T18:24:21.197

只要您网站的层次结构保持不变，您给出的路径绝对是相对路径。

您在 ajax 调用中提供的 URL 将始终向上移动两个文件夹并调用在 MyPage 中定义的 getDetails 方法

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T19:10:42.780

这有点骇人听闻，但是您是客户端，所以:)

这段代码做了一些假设——比如`myscript.js`存在的脚本标签

假设您的页面上有一些标记，如下所示：\

```
<script src='../js/myscript.js' type="text/javascript"></script>
<div>hiya</div> 
```

好的，现在我们将使用脚本标签并从中获取基本 url :)

让我们创建一个我们可以使用的 Util 类，添加一个 get base url 方法并警告该值：

此处的工作副本：http: [//jsfiddle.net/SmCLy/](http://jsfiddle.net/SmCLy/)

```
function Util() { /*...Nothing...*/
}

Util.getBaseURL = function() {
    //<summary>
    //    Returns the application base URL (well, a URL that is
    //    equivalent to such - it may have some "backtracking", 
    //    i.e. "../" at
    //    the end of the URL to simulate the root...)
    //</summary>    
    // 1) Find the script include for this JavaScript file:
    var scriptElements = document.getElementsByTagName("script"),
        getScriptPathFragmentPosition = Util.getBaseURL._getScriptPathFragmentPosition,
        getScriptPathFragmentPositionResult = getScriptPathFragmentPosition(scriptElements, "js/myscript.js"),
        posScriptPathFragment = getScriptPathFragmentPositionResult.posScriptPathFragment;

    // 2) Create the "base" URL by taking the current URL,
    // stripping the page from the end, and appending
    // sufficient "../" sequences to
    // construct the equivalent of the application's root URL:
    var scriptElementSrcLower = getScriptPathFragmentPositionResult.scriptElementSrcLower;
    var backPathToRoot = ((scriptElementSrcLower !== "") ? scriptElementSrcLower.substring(0, posScriptPathFragment) : "");
    var currentPath = location.href;
    var currentPathWithoutPage;
    var PAGE_TOKEN = ".aspx";
    var posPageToken = currentPath.toLowerCase().indexOf(PAGE_TOKEN);
    if (posPageToken > -1) {
        var trimmedPath = currentPath.substring(0, posPageToken + PAGE_TOKEN.length);
        currentPathWithoutPage = trimmedPath.substring(0, trimmedPath.lastIndexOf("/") + 1);
    } else {
        currentPathWithoutPage = currentPath.substring(0, currentPath.lastIndexOf("/") + 1);
    }
    return (currentPathWithoutPage + backPathToRoot);
};

Util.getBaseURL._getScriptPathFragmentPosition = function(scriptElements, scriptPathFragment) {
    var scriptElementsIndex = (scriptElements.length - 1),
        scriptElementSrc = "",
        scriptElementSrcLower = "",
        posScriptPathFragment = -1;

    while (scriptElementsIndex >= 0) {
        scriptElementSrc = scriptElements[scriptElementsIndex].getAttribute("src");
        if (typeof(scriptElementSrc) != "undefined" && scriptElementSrc !== null && scriptElementSrc !== "") {
            scriptElementSrcLower = scriptElementSrc.toLowerCase();
            posScriptPathFragment = scriptElementSrcLower.indexOf(scriptPathFragment);

            if (posScriptPathFragment >= 0) {
                break;
            }
        }

        scriptElementsIndex--;
    }

    var result = {
        posScriptPathFragment: posScriptPathFragment,
        scriptElementSrcLower: scriptElementSrcLower
    };

    return result;
};

alert(Util.getBaseURL()); 
```

所以，在您的页面上，您可以执行以下操作：

```
var myajaxUrl = getBaseURL()+"MyPage/GetDetails"; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-01-28T12:03:13.107

试试这个定义`<?php $site_root="WWW.example.com/" ?>`

```
var URL="<?php echo $site_root;?>folder/your_action.php"; 
```

并触发 Ajax 调用

# sql - SQL 实数与浮点数

> ID：10707646
> 
> 赞同：8
> 
> 时间：2012-05-22T18:12:15.277
> 
> 标签：sql, sql-server

假设我有以下两个查询：

```
select sum(cast(2666 as float)) * cast(.3 as float)
select sum(cast(2666 as real)) * cast(.3 as real) 
```

第一次查询返回：`799.8`
第二次查询返回：`799.800031781197`

为什么第二个查询不返回与第一个相同的东西？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-05-22T18:14:03.700

二进制浮点类型（如实数和浮点数）不能准确表示十进制数。特别是不可能将 0.3 精确地存储为二进制浮点数。而是存储了一个非常接近 0.3 的数字。这称为表示错误。

real 和 float 的误差大小不同，因为它们具有不同的精度。

如果您想更准确地存储十进制数字，请考虑使用[decimal 或 numeric](http://msdn.microsoft.com/en-us/library/ms187746)。但请注意，即使这些类型可以准确地存储一定位数的十进制值，计算仍然会产生无法精确表示的数字。例如，即使两者和可以，`0.1 / 0.3`也不能将结果精确存储在 a中。在这种情况下，结果将四舍五入到可以存储在类型中的最接近的值（例如，取决于精度）。`decimal``0.1``0.3``0.333333333`

# jquery - 不能在 jQuery 中使用淡入淡出和循环

> ID：10707648
> 
> 赞同：0
> 
> 时间：2012-05-22T18:12:27.453
> 
> 标签：jquery, facebook

我正在尝试使用 jQuery 一个接一个地加载图像并淡入淡出。问题是它只加载一张图片。我该如何解决这个问题？

```
$('input[id*="friend_bar"]').click(function () {
    FB.ui({
        method: 'apprequests',
        message: 'Try this awesome application?',
        exclude_ids: '<?php echo $exclude_ids ?>'
    }, function (response) {
        if (response) {
            $.post('invite_suck.php', {
                'response': response.to
            }, function (data) {
                for (var index in response.to) {
                    var ID = response.to[index];
                    $("#friend_bar").first().fadeOut(function () {
                        $(this).load(function () {
                            $(this).fadeIn();
                        });
                        $(this).replaceWith('<div align=\"center\"> <input type=\"image\" src=\"https://graph.facebook.com/' + ID + '/picture/?type=square\" height=\"50\" width=\"50\" align=\"center\">').attr("id", "friend");
                    });
                }
            });
        } 
        else {
            alert('Request was not sent');
        }
    }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T18:56:19.397

This is a similar question with regards to fading in some input elements. [jQuery fadein in a particular order](https://stackoverflow.com/questions/5599739/jquery-fadein-particular-order)

[http://jsfiddle.net/lucuma/CVMSx/1/](http://jsfiddle.net/lucuma/CVMSx/1/)

```
function fadeChain(elem) {
    if(elem) {
        $(elem).fadeIn('slow', function() {
            fadeChain($(this).next());
        });
    }
}

fadeChain($('#slideshow img').first());​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T18:24:30.143

我不确定我是否完全理解你的问题，但如果你试图淡入包含在 id 为“friend_bar”的 div 中的一堆图像，你可能会做这样的事情：

```
//set images opacity at 0
 $('#friend_bar > img').css('opacity', '0');
    //self-invoking function to fade in each image in succession 
 $(function fader() {
     var $image = $('#friend_bar > img');

    $image.each(function(index, item) {
         setTimeout(function() {
             $(item).animate({opacity:1}, 500);
         }, index*500);
     });

 }); 
```

# gwt - GWT 日历或日期选择器显示一年中的季节

> ID：10707650
> 
> 赞同：2
> 
> 时间：2012-05-22T18:12:43.600
> 
> 标签：gwt, extjs, calendar, datepicker, gxt

我正在尝试找到显示一年中日期范围的最佳组件。一个想法是将月份显示为盒子（12 个盒子），并用不同的颜色绘制季节。

GWT Datepicker 并不能真正满足我的需求，因为它的可扩展性不够（[http://code.google.com/p/google-web-toolkit/issues/detail?id=3848](http://code.google.com/p/google-web-toolkit/issues/detail?id=3848)）。日历组件太复杂了。GXT 日期选择器也缺乏可扩展性。

这是我想要实现的示例：

![这是我想做的一个简单示例](../Images/5d69257274a9998a46cb186d78b2338d.png)

任何的想法？我使用 GXT 作为库。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T19:04:21.153

在我看来，使用 DatePicker 并不是一个坏主意。这是一个涵盖一个月的小示例。我认为通过将其中的 12 个放在一个网格中，将其延长到一整年并不难：

### 爪哇

```
final DateTimeFormat format = DateTimeFormat.getFormat("yyyy-MM-dd");

final DatePicker datePicker = new DatePicker();
datePicker.setCurrentMonth(format.parse("2012-01-01"));
datePicker.addStyleName("my-cal");

final Date start = format.parse("2012-01-17");
final Date end = format.parse("2012-01-28");

for (final Date date = start; date.compareTo(end) <= 0; CalendarUtil
    .addDaysToDate(date, 1)) {

  datePicker.addStyleToDates("my-green", date);
} 
```

### CSS

```
.my-green { background-color: green !important; }
.my-cal .datePickerPreviousButton { visibility: hidden; }
.my-cal .datePickerNextButton { visibility: hidden; } 
```

使用“干净”主题，它看起来像这样：

![在此处输入图像描述](../Images/8b7f88b0cbb149fcc16759cf080833b5.png)

* * *

PS 以下是完整日历的样子：

![在此处输入图像描述](../Images/d83f0446a1e6a69d48da94c4b476bc25.png)

完整代码：

[http://pastebin.com/xkrRQQht](http://pastebin.com/xkrRQQht)

# android - 如何从数据库中获取随机字符串？

> ID：10707653
> 
> 赞同：3
> 
> 时间：2012-05-22T18:12:51.750
> 
> 标签：android, sql

我正在开发应用程序，其中第一个活动从数据库中获取随机值并将其作为字符串发送到下一个活动。

我确切地知道如何在 sql 中做到这一点：

```
SELECT column FROM table
ORDER BY RANDOM()
LIMIT 1 
```

经过一些尝试在应用程序中使用它后，我得出了这个结论：

```
Cursor send = database.query(TABLE_NAME, new String[] { COLUMN_NAME }, null, null, null, null, "RANDOM() LIMIT 1");

Bundle b = new Bundle();
b.putString("description", send.getString(send.getColumnIndex(COLUMN_NAME))); 
```

但是在按下按钮打开第二个活动后，我在最后一行出现错误。

* * *

**添加日志：**

```
05-22 22:14:24.202: E/AndroidRuntime(14259): FATAL EXCEPTION: main
05-22 22:14:24.202: E/AndroidRuntime(14259): android.database.CursorIndexOutOfBoundsException: Index 1 requested, with a size of 1
05-22 22:14:24.202: E/AndroidRuntime(14259):    at android.database.AbstractCursor.checkPosition(AbstractCursor.java:400)
05-22 22:14:24.202: E/AndroidRuntime(14259):    at android.database.AbstractWindowedCursor.checkPosition(AbstractWindowedCursor.java:136)
05-22 22:14:24.202: E/AndroidRuntime(14259):    at android.database.AbstractWindowedCursor.getString(AbstractWindowedCursor.java:50)
05-22 22:14:24.202: E/AndroidRuntime(14259): at com.example.ListAction$1.onItemClick(ListAction.java:90)
05-22 22:14:24.202: E/AndroidRuntime(14259):    at android.widget.AdapterView.performItemClick(AdapterView.java:292)
05-22 22:14:24.202: E/AndroidRuntime(14259):    at android.widget.AbsListView.performItemClick(AbsListView.java:1177)
05-22 22:14:24.202: E/AndroidRuntime(14259):    at android.widget.AbsListView$PerformClick.run(AbsListView.java:2705)
05-22 22:14:24.202: E/AndroidRuntime(14259):    at android.widget.AbsListView$1.run(AbsListView.java:3458)
05-22 22:14:24.202: E/AndroidRuntime(14259):    at android.os.Handler.handleCallback(Handler.java:605)
05-22 22:14:24.202: E/AndroidRuntime(14259):    at android.os.Handler.dispatchMessage(Handler.java:92)
05-22 22:14:24.202: E/AndroidRuntime(14259):    at android.os.Looper.loop(Looper.java:137)
05-22 22:14:24.202: E/AndroidRuntime(14259):    at android.app.ActivityThread.main(ActivityThread.java:4507)
05-22 22:14:24.202: E/AndroidRuntime(14259):    at java.lang.reflect.Method.invokeNative(Native Method)
05-22 22:14:24.202: E/AndroidRuntime(14259):    at java.lang.reflect.Method.invoke(Method.java:511)
05-22 22:14:24.202: E/AndroidRuntime(14259):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:790)
05-22 22:14:24.202: E/AndroidRuntime(14259):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:557)
05-22 22:14:24.202: E/AndroidRuntime(14259):    at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T20:57:28.823

我认为问题在于您应该将光标指向第一行。我没有在你的代码中找到这个：

```
if (!send.moveToFirst()) {
    Log.d(TAG, "Cannot move to first row of the Cursor!");
    return;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T18:16:31.483

改用`rawQuery`：

```
database.rawQuery("SELECT column 
                   FROM table 
                   ORDER BY RANDOM() LIMIT 1",null); 
```

您将获得与`cursor`通常在 sql 中执行的相同类型但执行查询的查询。

因此，**假设**您的代码的第二部分是正确的：

```
Cursor send =database.rawQuery("SELECT column 
                   FROM table 
                   ORDER BY RANDOM() LIMIT 1",null);
Bundle b = new Bundle();
b.putString("description", send.getString(send.getColumnIndex(COLUMN_NAME))); 
```

# jsf-2 - 单击命令按钮操作后，PanelGroup 未呈现

> ID：10707655
> 
> 赞同：1
> 
> 时间：2012-05-22T18:12:59.343
> 
> 标签：jsf-2

我有 2 组面板组。一个面板组包含一个字段集，里面有两个单选按钮和一个命令按钮。基于单选按钮的选择，尊重的值将通过ajax调用显示在另一个面板组中。但问题是在单击命令按钮时选择单选按钮后，第一次加载页面时，其他面板组根本不呈现。当我刷新一切正常。即使在命令操作中设置了该值，我也无法弄清楚为什么 renderPanelGroup 值未设置为 true。这是我的代码。

## 测试.xhtml

```
 <h:form id="parentformid">
 <h:panelGroup id="demandDashBoardPanelGroupID">
    <fieldset> 
    <legend>Demand Dashboard</legend>

     <table>
        <tr>
        <td> 
            <h:selectOneRadio id="groupbyid" value="#{demandManagedBean.selectedRadioButton}" >  
                    <f:selectItem itemLabel="Group By Creation Date Time" itemValue="1" />  
                    <f:selectItem itemLabel="Group By Location" itemValue="2" />
            </h:selectOneRadio>
        </td>
        <td>
            <h:commandButton id="fetchbuttonID" value="Fetch" 
                     action="#{demandManagedBean.displayDemandRequestsTable}">
                          <f:ajax render=":parentformid:demandrequestpanelgrpid"execute="@form" /> 
            </h:commandButton>
        </td>
        </tr>
        </table>

     </fieldset>

     </h:panelGroup>
   //For checking demandManagedBean.renderedPanelGroup value. it is giving always false.Thats why panel group is not getting rendered.
   <h:outputText value="#{demandManagedBean.renderedPanelGroup}" />

    <h:panelGroup id="demandrequestpanelgrpid" rendered="#{demandManagedBean.renderedPanelGroup}"> 

     <fieldset id="demandrequestfieldsetid"> 

     <legend >Demand Requests</legend>

            <h:outputText rendered="#{demandManagedBean.renderFirstTable}" value="first table"/>

            <h:outputText rendered="#{demandManagedBean.renderSecondTable}" value="second table"/>

     </fieldset> 

   </h:panelGroup> 
```

//支持bean cmd动作

```
private String selectedRadioButton ="1";
private boolean renderFirstTable ;
private boolean renderSecondTable;
private boolean renderedPanelGroup ;

//getter and setter methods

public void displayDemandRequestsTable(){

        if(selectedRadioButton!= null && selectedRadioButton.endsWith("1")){

            renderFirstTable = true;
            renderSecondTable= false;

        }else if(selectedRadioButton!= null && selectedRadioButton.endsWith("2")){

            renderFirstTable = false;
            renderSecondTable= true;

        }
        renderedPanelGroup = true;
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-22T18:21:30.883

您无法更新未渲染的元素，rendered=false“是一种 JSF 方式”以从 DOM 树中删除元素，

它不像 css display:none 或 visibility:hidden <- 这两个将保留 DOM 树中的元素但隐藏，而 JSF render=false 甚至不会渲染（保留）DOM 树中的元素（你甚至不会看到它在页面的“查看源代码”中）

因此，在您的情况下，您需要用另一个“panelGroup”包装 panelGroup 并更新包装器的 id

```
<h:panelGroup id="demandrequestpanelgrpid">
    <h:panelGroup rendered="#{demandManagedBean.renderedPanelGroup}"> 
```

. . .

也看看类似的问题

[你能从 ap:ajax 监听器更新一个 h:outputLabel 吗？](https://stackoverflow.com/a/10370268/617373)

# javascript - Shadowbox（图片库插件）仅显示黑色窗口

> ID：10707657
> 
> 赞同：1
> 
> 时间：2012-05-22T18:13:00.660
> 
> 标签：javascript, jquery, image, jquery-plugins, shadowbox

我正在尝试使用 Shadowbox 插件 (http://www.shadowbox-js.com) 创建一个图片库。
所以我在创建画廊时遇到了问题，这个问题是：每当我点击显示它开始加载的图像的链接（实际上是缩略图）时，没有图像只显示一个黑色窗口。
我使用的链接：

```
<a href="http://localhost/myProject/images/10.jpg" rel="shadowbox"><img src="http://localhost/myProject/thumbnails/10.jpg" class="thumbnails"/></a> 
```

脚本/链接/初始化：
这些导入正在工作，我通过使用（在 Chrome 中）检查元素-> 网络来验证它。

```
<link rel="stylesheet" type="text/css" href="shadowbox/shadowbox.css">
<script type="text/javascript" src="shadowbox/shadowbox.js"></script> 
<script type="text/javascript">
        Shadowbox.init();
</script> 
```

**注释：**
1-我使用 Shadowbox 作为 jQuery 插件（不是独立的）。
2-jQuery 使用 Google（不是本地）导入我的网站。
3-真实图像尺寸为3000x2400。
编辑：
4-我意识到当右键单击->检查元素（在chrome中）时，会显示图像（但不是以正确的方式，只显示了一半）。
5-显示图像设置时`handleOversize`（`drag`必须单击）。
6-它在 IE 9 中运行！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T19:59:24.567

您是说图像在浏览器中显示不正确？

这可能意味着文件已损坏。尝试重新保存它。

我已经使用 Shadowbox 很长时间了，类似的问题总是由坏文件或文件权限设置不正确引起的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T20:25:51.893

由于您提供的示例是*local host*，因此我只能提供一般指导，而不能确切地告诉您问题所在。一个链接肯定会受到欢迎。

首先，确保您对**jQuery**`shadowbox.js`的调用在对文件的调用之前。

除此之外，我确信您已经为网页提供了有效的`!DOCTYPE`信息，这使您的 Shadowbox 标记在我目前所见的情况下是正确的。

问题可能出在使用**jQuery**和您的`thumbnails`.

如果**jQuery**修改了具有特定样式的链接，Shadowbox 可能会受到其锚标记的任何更改。

然后这些更改将导致 Shadowbox 每个链接元素看不到原始链接，因为它现在是一个 jQuery 链接。它需要被 Shadowbox 重新缓存。

解决方案：尝试在对 的`Shadowbox.init`任何修改`thumbnail`完成后调用 ，以便 Shadowbox 缓存一次链接，或者如果需要，使用 Shadowbox API`.clearCache();`并`.setup();`重新缓存这些`rel`锚点。

我还应该提到，您应该确保 Shadowbox 具有 jQuery 适配器接口，这是一个下载选项或 WordPress 插件选项。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-23T11:31:01.677

我找到了解决方案，它不在 DOCTYPE 或浏览器甚至我的 JS 代码中！
问题出在`CSS`.
设置`direction`为`right to left(rtl)`（是的，网站是阿拉伯语）。
导致图像被隐藏，也许是因为图像正确而我看不到它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-04-23T08:55:36.683

这是一个古老的问题，但没有人正确回答这个问题。解决方案在这里：只需在 shadowbox.css 中用“right”替换“left”值，用“left”替换“right”值

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2015-02-04T11:58:56.773

打开 shadowbox.css 并设置`direction:ltr`为`#sb-containe`r

# jquery - 删除特定的调整大小处理程序 jQuery

> ID：10707661
> 
> 赞同：3
> 
> 时间：2012-05-22T18:13:26.143
> 
> 标签：jquery, resize

我有一个可调整大小的容器 div。在那个 div 里面还有另一个可调整大小的 div。如果我销毁容器 div 的调整大小处理程序，则内部 div 的调整大小处理程序也会被破坏。像这样：

`$(".container").resizable("destroy");`

有没有办法销毁容器的调整大小处理程序但将调整大小处理程序保留在容器内的 div 上？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T18:44:25.213

这似乎是 jQuery UI 源代码中的一个错误。父容器上的“销毁”调用正在从目标容器对象和所有包含的元素中删除 ui-resizable-handle。

问题的根源在于第 198 行的 jquery.ui.resizable.js 中的 destroy 函数（截至 JQuery UI v1.8.20）。

请注意，它正在调用：

```
.find('.ui-resizable-handle').remove(); 
```

这应该改为：

```
.children('.ui-resizable-handle').remove(); 
```

更改此调用将防止 ui-resizable-handle 从您的内部 div 中删除。

希望有帮助！

# statistics - 用于分析项目中使用的编程语言的工具

> ID：10707662
> 
> 赞同：1
> 
> 时间：2012-05-22T18:13:30.447
> 
> 标签：statistics, programming-languages

到目前为止我能找到的唯一工具是[https://github.com/github/linguist](https://github.com/github/linguist)

我确信这个工具在某些情况下可以正常工作。我得到了很多误报，它错过了一些语言。一个由一些 C、C++、ObjC 组成的项目，它声称可以看到 C、C++、D、Fortran、Shell、Python。如果我自己分析 ObjC 目录，那么它可以正常工作，但会错过所有其他语言。非常古怪。

那么有没有人有一个好的工具来生成一些关于在一个非常大的项目中使用哪些语言的基本统计数据？

更新：

试过[https://github.com/blackducksw/ohcount/](https://github.com/blackducksw/ohcount/)

与语言学家类似的故事，但提供了更多细节。虽然有时有点碰碰运气。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T18:15:37.937

[试试](http://www.dwheeler.com/sloccount/)SLOCCount 。它可以识别多种编程语言并进行一些有趣的统计（例如估计的开发成本）。

# java - 如何从 python/numpy 调用 java 函数？

> ID：10707671
> 
> 赞同：8
> 
> 时间：2012-05-22T18:14:08.980
> 
> 标签：java, numpy

我很清楚如何用 C++ 扩展 Python，但是如果我想用 Java 编写一个函数来与 numpy 一起使用呢？

这是一个简单的场景：我想使用 Java 类计算 numpy 数组的平均值。如何将 numpy 向量传递给 Java 类并收集结果？

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-03T18:27:45.090

我花了一些时间在我自己的问题上，并想分享我的答案，因为我觉得在*stackoverflow*上没有太多关于这个主题的信息。我还认为，由于 Java 的性能和其他良好的软件开发特性的提高，Java 将在科学计算中变得更加相关（例如，参见 WEKA 数据挖掘包）。

* * *

*总的来说，事实证明，使用正确的工具使用 Java 扩展 Python 比使用 C/C++ 更容易！*

* * *

# 从 Python 调用 Java 的工具概述和评估

*   [http://pypi.python.org/pypi/JCC](http://pypi.python.org/pypi/JCC)：由于没有适当的文档，这个工具是无用的。

*   Py4J：需要在使用 python 之前启动 Java 进程。正如其他人所说，这是一个可能的故障点。此外，没有多少使用示例被记录在案。

*   [JPype](http://jpype.sourceforge.net/)：虽然开发似乎是死亡，但它运作良好，并且网上有很多例子（例如参见[http://kogs-www.informatik.uni-hamburg.de/~meine/weka-python/](http://kogs-www.informatik.uni-hamburg.de/~meine/weka-python/)使用用 Java 编写的数据挖掘库）。因此*我决定专注于这个工具*。

# 在 Fedora 16 上安装 JPype

我正在使用 Fedora 16，因为在 Linux 上安装 JPype 时存在一些问题，所以我描述了我的方法。下载[JPype](http://jpype.sourceforge.net/) ，然后在第 48 行通过提供 JDK 路径来修改*setup.py脚本：*

```
self.javaHome = '/usr/java/default' 
```

然后运行：

```
sudo python setup.py install 
```

安装成功后，检查这个文件：

*/usr/lib64/python2.7/site-packages/jpype/_linux.py*

并将方法*getDefaultJVMPath()*删除或重命名为*getDefaultJVMPath_old()*，然后添加以下方法：

```
def getDefaultJVMPath():
    return "/usr/java/default/jre/lib/amd64/server/libjvm.so" 
```

**替代方法**：不要对上述文件*_linux.py*进行任何更改，但不要使用方法 getDefaultJVMPath() （或调用此方法的方法）。在使用*getDefaultJVMPath()*的地方直接提供 JVM 的路径。请注意，有几个路径，例如在我的系统中，我也有以下路径，指的是不同版本的 JVM（我不清楚客户端 JVM 还是服务器 JVM 更适合）：

*   /usr/lib/jvm/java-1.5.0-gcj-1.5.0.0/jre/lib/x86_64/client/libjvm.so
*   /usr/lib/jvm/java-1.5.0-gcj-1.5.0.0/jre/lib/x86_64/server/libjvm.so
*   /usr/lib/jvm/java-1.6.0-openjdk-1.6.0.0.x86_64/jre/lib/amd64/server/libjvm.so

最后，将以下行添加到*~/.bashrc*（或每次打开 python 解释器之前运行它）：

```
export JAVA_HOME='/usr/java/default' 
```

（上面的目录实际上只是我上一个版本的 JDK 的符号链接，它位于*/usr/java/jdk1.7.0_04*）。

请注意，JPype 已下载的目录中的所有测试，即*JPype-0.5.4.2/test/testsuite.py*都会失败（所以不要关心它们）。

要查看它是否有效，请在 python 中测试此脚本：

```
import jpype 
jvmPath = jpype.getDefaultJVMPath() 
jpype.startJVM(jvmPath)
# print a random text using a Java class
jpype.java.lang.System.out.println ('Berlusconi likes women') 
jpype.shutdownJVM() 
```

# 从 Java 调用 Java 类也使用 Numpy

让我们开始实现一个 Java 类，其中包含一些我想应用于*numpy arrays*的函数。由于没有状态的概念，我使用静态函数，这样我就不需要创建任何 Java 对象（创建 Java 对象不会改变任何东西）。

```
/**
 * Cookbook to pass numpy arrays to Java via Jpype
 * @author Mannaggia
 */

package test.java;

public class Average2 {

public static double compute_average(double[] the_array){
    // compute the average
    double result=0;
    int i;
    for (i=0;i<the_array.length;i++){
        result=result+the_array[i];
    }
    return result/the_array.length;
}
// multiplies array by a scalar
public static double[] multiply(double[] the_array, double factor) {

    int i;
    double[] the_result= new double[the_array.length];
    for (i=0;i<the_array.length;i++) {
        the_result[i]=the_array[i]*factor;
    }
    return the_result;
}

/**
 * Matrix multiplication. 
 */
public static double[][] mult_mat(double[][] mat1, double[][] mat2){
    // find sizes
    int n1=mat1.length;
    int n2=mat2.length;
    int m1=mat1[0].length;
    int m2=mat2[0].length;
    // check that we can multiply
    if (n2 !=m1) {
        //System.err.println("Error: The number of columns of the first argument must equal the number of rows of the second");
        //return null;
        throw new IllegalArgumentException("Error: The number of columns of the first argument must equal the number of rows of the second");
    }
    // if we can, then multiply
    double[][] the_results=new double[n1][m2];
    int i,j,k;
    for (i=0;i<n1;i++){
        for (j=0;j<m2;j++){
            // initialize
            the_results[i][j]=0;
            for (k=0;k<m1;k++) {
                the_results[i][j]=the_results[i][j]+mat1[i][k]*mat2[k][j];
            }
        }
    }
    return the_results;
}

/**
 * @param args
 */
public static void main(String[] args) {
    // test case
    double an_array[]={1.0, 2.0,3.0,4.0};
    double res=Average2.compute_average(an_array);
    System.out.println("Average is =" + res);
}
} 
```

类的名称有点误导，因为我们不仅旨在计算 numpy 向量的平均值（使用方法*compute_average*），而且还将 numpy 向量乘以标量（方法*multiply*），最后是矩阵乘法（方法*mult_mat*）。

编译上述 Java 类后，我们现在可以运行以下 Python 脚本：

```
import numpy as np
import jpype

jvmPath = jpype.getDefaultJVMPath() 
# we to specify the classpath used by the JVM
classpath='/home/mannaggia/workspace/TestJava/bin'
jpype.startJVM(jvmPath,'-Djava.class.path=%s' % classpath)

# numpy array
the_array=np.array([1.1, 2.3, 4, 6,7])
# build a JArray, not that we need to specify the Java double type using the jpype.JDouble wrapper
the_jarray2=jpype.JArray(jpype.JDouble, the_array.ndim)(the_array.tolist())
Class_average2=testPkg.Average2 
res2=Class_average2.compute_average(the_jarray2)
np.abs(np.average(the_array)-res2) # ok perfect match! 

# now try to multiply an array
res3=Class_average2.multiply(the_jarray2,jpype.JDouble(3))
# convert to numpy array
res4=np.array(res3) #ok

# matrix multiplication
the_mat1=np.array([[1,2,3], [4,5,6], [7,8,9]],dtype=float)
#the_mat2=np.array([[1,0,0], [0,1,0], [0,0,1]],dtype=float)
the_mat2=np.array([[1], [1], [1]],dtype=float)
the_mat3=np.array([[1, 2, 3]],dtype=float)

the_jmat1=jpype.JArray(jpype.JDouble, the_mat1.ndim)(the_mat1.tolist())
the_jmat2=jpype.JArray(jpype.JDouble, the_mat2.ndim)(the_mat2.tolist())
res5=Class_average2.mult_mat(the_jmat1,the_jmat2)
res6=np.array(res5) #ok

# other test
the_jmat3=jpype.JArray(jpype.JDouble, the_mat3.ndim)(the_mat3.tolist())
res7=Class_average2.mult_mat(the_jmat3,the_jmat2)
res8=np.array(res7)
res9=Class_average2.mult_mat(the_jmat2,the_jmat3)
res10=np.array(res9)

# test error due to invalid matrix multiplication
the_mat4=np.array([[1], [2]],dtype=float)
the_jmat4=jpype.JArray(jpype.JDouble, the_mat4.ndim)(the_mat4.tolist())
res11=Class_average2.mult_mat(the_jmat1,the_jmat4)

jpype.java.lang.System.out.println ('Goodbye!') 
jpype.shutdownJVM() 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-13T20:01:59.703

我认为 Jython 是最好的选择之一——这使得在 python 中使用 java 对象变得无缝。我实际上将 weka 与我的 python 程序集成在一起，而且非常简单。只需导入 weka 类并像在 python 代码中的 java 中那样调用它们。

[http://www.jython.org/](http://www.jython.org/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-22T18:24:44.910

我不确定 numpy 支持，但以下可能会有所帮助：

[http://pypi.python.org/pypi/JCC/](http://pypi.python.org/pypi/JCC/)

# php - Wordpress 网站等待 7 秒发送更多 HTTP 请求

> ID：10707672
> 
> 赞同：0
> 
> 时间：2012-05-22T18:14:14.100
> 
> 标签：php, html, wordpress, http, themes

我正在使用 Wordpress 主题 The Travel Theme ( [http://thetraveltheme.com/](http://thetraveltheme.com/) ) 构建一个网站。问题是网站加载速度非常慢。让我解释一下 - 在初始 HTTP 请求之后，发送其他请求需要 7 秒。看图片。 ![网络活动](../Images/ce850af5f3d9eb5335794c4d33f83253.png)

由于它发生在我的网站以及使用此主题的官方主题网站上，因此很可能是与主题相关的问题。它不应该是由插件引起的。我在想也许它会尝试连接某个地方并且连接在七秒后超时，但我无法弄清楚更多。

我[联系](http://thetraveltheme.proboards.com/index.cgi?board=general&action=display&thread=166#1337407774)了主题开发人员，但到目前为止没有回复。

您是否知道可能导致它的原因以及在哪里寻找问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T19:52:30.737

[西蒙在这里](http://thetraveltheme.proboards.com/index.cgi?action=display&board=general&thread=166&page=1#592)解决了这个问题。

„有外部调用澳大利亚的网络服务器来获取这些广告 url，这些调用阻止了整个主题。`footer.php`因此，如果您想要一个快速而肮脏的解决方案来避免这些延迟，只需在主题根目录中的文件中注释代码块即可。`div`元素中的所有内容，`footer_bottom`但不是开头的这一部分：

```
<div id="copyright"><?php echo wpml_t(THEME_NAME, 'Copyright Footer Text',stripslashes(theme_get_option('footer','copyright')));            
wp_reset_query(); 
```

这应该会为初始连接提供 +90% 的性能提升，为整个站点提供 +60% 的性能提升（取决于不同的因素）。当然还有很多其他的方法可以提高性能，但是这个应该让目前的情况可以接受。”（西蒙）

我希望这可以帮助其他使用旅行主题的人。

# android - 是否可以将服务放在子包中？

> ID：10707674
> 
> 赞同：3
> 
> 时间：2012-05-22T18:14:28.903
> 
> 标签：android, android-manifest

我的[服务](http://developer.android.com/reference/android/app/Service.html)只有在我的包中有 MyService.java 时才有效

```
com.test.app 
```

，但不在像这样的子包中

```
com.test.app.services.MyService 
```

在清单中，我尝试使用

```
<service android:name=".services.MyService" /> 
```

或完全合格

```
<service android:name="com.test.app.services.MyService" /> 
```

但两种方法都没有奏效。我正在使用子包来获得更好的文件结构。那么我真的可以不将我的服务文件放在子包中还是我在这里遗漏了什么？

（我正在使用 Android 团队提供的扩展下载器库。这涉及实现一个简单的服务。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T18:34:43.010

是的，您可以将它放在您想要的任何名称空间中。

除了子类化之外`DownloaderService`，您还需要阅读文档的其余部分，包括[开始下载](http://developer.android.com/guide/market/expansion-files.html#Download)。特别感兴趣的是这一行：

```
// Start the download service (if required)
int startResult = DownloaderClientMarshaller.startDownloadServiceIfRequired(this,
                pendingIntent, SampleDownloaderService.class); 
```

请注意，您需要在`Service`此处提供自定义类。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T18:16:08.503

**是的。**

我已经做过很多次了。很有可能还有其他事情发生。我要检查的第一件事是确保您`Intent`的结构正确。

# xcode - 仅在全屏模式下具有最大宽度的 Mac OSX Lion 应用程序

> ID：10707678
> 
> 赞同：0
> 
> 时间：2012-05-22T18:14:36.750
> 
> 标签：xcode, interface-builder, osx-lion, fullscreen

我正在寻找一种方法让 Lion 中的应用程序在全屏模式下扩展到最大宽度和 100% 高度（如 Messages beta 应用程序），但允许用户在不处于全屏模式时将其缩放到所有大小。

这是否可能仅使用 Interface Builder，或者我应该对其进行编码？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T18:33:39.690

您必须对此进行编码，因为 Interface Builder 没有为您提供应用程序在全屏时的行为方式的任何大小细节。

通过使用[NSWindowDelegate](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/NSWindowDelegate_Protocol/Reference/Reference.html)方法，您应该能够告诉窗口在进入和退出全屏时的行为

进入或退出全屏模式后，您可以在窗口插座上使用 setMaxSize: 设置窗口的最大尺寸。委托方法 – windowWillEnterFullScreen: 和 – windowWillExitFullScreen: 应该是最有用的

# java - 执行速度很慢

> ID：10707683
> 
> 赞同：1
> 
> 时间：2012-05-22T18:14:45.330
> 
> 标签：java, string, file, hashmap

我有一个基本方法，它从硬盘驱动器读取 ~1000 个文件，每个文件有 ~10,000 行。另外，我有一个`String`调用数组，`userDescription`其中包含用户的所有“描述词”。我创建了一个 HashMap，其数据结构`HashMap<String, HashMap<String, Integer>>`对应于`HashMap<eachUserDescriptionWords, HashMap<TweetWord, Tweet_Word_Frequency>>`.

该文件组织为： `<User=A>\t<Tweet="tweet...">\n <User=A>\t<Tweet="tweet2...">\n <User=B>\t<Tweet="tweet3...">\n ....`

我的方法是：

```
for (File file : tweetList) {
        if (file.getName().endsWith(".txt")) {
            System.out.println(file.getName());
            BufferedReader in;
            try {
                in = new BufferedReader(new FileReader(file));
                String str;
                while ((str = in.readLine()) != null) {
                    // String split[] = str.split("\t");
                    String split[] = ptnTab.split(str);
                    String user = ptnEquals.split(split[1])[1];
                    String tweet = ptnEquals.split(split[2])[1];
                    // String user = split[1].split("=")[1];
                    // String tweet = split[2].split("=")[1];

                    if (tweet.length() == 0)
                        continue;

                    if (!prevUser.equals(user)) {
                        description = userDescription.get(user);
                        if (description == null)
                            continue;
                        if (prevUser.length() > 0 && wordsCount.size() > 0) {
                            for (String profileWord : description) {
                                if (wordsCorr.containsKey(profileWord)) {
                                    HashMap<String, Integer> temp = wordsCorr
                                            .get(profileWord);
                                    wordsCorr.put(profileWord,
                                            addValues(wordsCount, temp));
                                } else {
                                    wordsCorr.put(profileWord, wordsCount);
                                }
                            }
                        }
                        // wordsCount = new HashMap<String, Integer>();
                        wordsCount.clear();
                    }
                    setTweetWordCount(wordsCount, tweet);
                    prevUser = user;
                }
            } catch (IOException e) {
                System.err.println("Something went wrong: "
                        + e.getMessage());
            }
        }
    } 
```

在这里，该方法`setTweetWord`计算单个用户的所有推文的词频。方法是：

```
private void setTweetWordCount(HashMap<String, Integer> wordsCount,
            String tweet) {

        ArrayList<String> currTweet = new ArrayList<String>(
                Arrays.asList(removeUnwantedStrings(tweet)));

        if (currTweet.size() == 0)
            return;

        for (String word : currTweet) {
            try {
                if (word.equals("") || word.equals(null))
                    continue;
            } catch (NullPointerException e) {
                continue;
            }

            Integer countWord = wordsCount.get(word);
            wordsCount.put(word, (countWord == null) ? 1 : countWord + 1);
        }
    } 
```

addValues 方法检查是否`wordCount`有已经在巨型 HashMap wordsCorr 中的单词。如果是这样，它会增加原始 HashMap 中单词的计数`wordsCorr`。

现在，我的问题是无论我做什么程序都很慢。我在我的服务器上运行了这个版本，它有相当好的硬件，但它已经 28 小时了，扫描的文件数量只有 450 左右。我试着看看我是否在重复做任何可能不必要的事情，我纠正了一些。但是程序仍然很慢。

此外，我已将堆大小增加到 1500m，这是我可以达到的最大值。

有什么我可能做错了吗？

谢谢您的帮助！

**编辑：**分析结果首先我真的要感谢你们的评论。我已经更改了程序中的一些内容。我现在已经预编译了正则表达式，而不是直接`String.split()`和其他优化。但是，在分析之后，我的`addValues`方法花费的时间最长。所以，这是我的代码`addValues`。有什么我应该在这里优化的吗？哦，我也`startProcess`稍微改变了我的方法。

```
 private HashMap<String, Integer> addValues(
            HashMap<String, Integer> wordsCount, HashMap<String, Integer> temp) {

        HashMap<String, Integer> merged = new HashMap<String, Integer>();

        for (String x : wordsCount.keySet()) {
            Integer y = temp.get(x);
            if (y == null) {
                merged.put(x, wordsCount.get(x));
            } else {
                merged.put(x, wordsCount.get(x) + y);
            }
        }

        for (String x : temp.keySet()) {
            if (merged.get(x) == null) {
                merged.put(x, temp.get(x));
            }
        }
        return merged;
    } 
```

**EDIT2：**即使经过如此努力，程序也没有按预期运行。我做了所有“慢方法”的优化，`addValues`但没有奏效。所以我去了不同的路径，首先创建字典并为每个单词分配索引，然后再进行处理。让我们看看它的去向。谢谢您的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T18:33:46.053

想到两件事：

*   您正在使用 String.split()，它使用*正则表达式*进行拆分。这完全是超大的。请改用 Apache StringUtils 中的许多 splitXYZ() 方法之一。
*   您可能正在创建非常巨大的哈希映射。当散列图非常大时，散列冲突会使散列图函数变得更慢。这可以通过使用更广泛传播的哈希值来改善。在此处查看示例：[Java HashMap 性能优化/替代](https://stackoverflow.com/questions/1757363/java-hashmap-performance-optimization-alternative)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T21:19:15.613

您将从更多优化中受益：

*   String.split 每次都将输入正则表达式（以字符串形式）重新编译为模式。你应该有一个`static final Pattern ptnTab = Pattern.compile( "\\t" ), ptnEquals = Pattern.compile( "=" );`和调用，例如，`ptnTab.split( str )`。产生的性能应该接近 StringTokenizer。
*   `word.equals( "" ) || word.equals( null )`. 这里有很多浪费的周期。如果您实际上看到的是空词，那么您正在捕获 NPE，这是非常昂贵的。请参阅上面@trutheality 的回复。
*   您应该为 HashMap 分配一个非常大的初始容量，以避免所有必然发生的调整大小。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-22T18:24:45.673

一个建议（我不知道你会从中得到多少改进）是基于`curTweet`从未修改过的观察结果。无需创建副本。IE

```
ArrayList<String> currTweet = new ArrayList<String>(
            Arrays.asList(removeUnwantedStrings(tweet))); 
```

可以替换为

```
List<String> currTweet = Arrays.asList(removeUnwantedStrings(tweet)); 
```

或者您可以直接使用数组（这会稍微快一些）。IE

```
String[] currTweet = removeUnwantedStrings(tweet); 
```

还，

```
word.equals(null) 
```

总是`false`按照合同的定义`equals`。空检查的正确方法是：

```
if (null == word || word.equals("")) 
```

此外，如果您这样做，您将不需要空指针异常 try-catch。异常处理在发生时代价高昂，因此如果您的单词数组倾向于返回大量空值，这可能会减慢您的代码速度。

**不过，更一般地说，**这是您应该分析代码并找出实际瓶颈所在（如果存在瓶颈）而不是寻找优化ad-hoc的东西的情况之一。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-22T18:36:36.570

您是否考虑过使用 db 而不是 Java。使用 db 工具，您可以使用表中 DB 附带的数据加载工具加载数据，然后您可以从那里进行集合处理。我看到的一个挑战是在表中加载数据，因为字段没有用“'”或“：”等常用分隔符分隔

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-22T18:26:40.123

split() 使用不“快速”的正则表达式。尝试使用 StringTokenizer 或其他东西。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-24T17:52:26.200

您可以像这样重写`addValues`以使其更快 - 一些注意事项：

*   我没有测试过代码，但我认为它与您的代码相同。
*   我没有测试过它是否更快（但如果不是，我会感到惊讶）
*   我假设 wordsCount 大于 temp，如果不在代码中交换它们
*   我还用 s 替换了所有的`HashMap`s，`Map`这对您没有任何影响，但使代码以后更容易更改

* * *

```
private Map<String, Integer> addValues(Map<String, Integer> wordsCount, Map<String, Integer> temp) {

    Map<String, Integer> merged = new HashMap<String, Integer>(wordsCount); //puts everyting in wordCounts

    for (Map.Entry<String, Integer> e : temp.entrySet()) {
        Integer countInWords = merged.get(e.getKey()); //the number in wordsCount
        Integer countInTemp = e.getValue();
        int newCount = countInTemp + (countInWords == null ? 0 : countInWords); //the sum
        merged.put(e.getKey(), newCount);
    }
    return merged;
} 
```

# extjs - 是否可以将 ExtJs 与 WF 一起使用？

> ID：10707684
> 
> 赞同：0
> 
> 时间：2012-05-22T18:14:47.107
> 
> 标签：extjs, workflow-foundation

我们有一个要求，我们必须在我们的项目中使用 ExtJs。我们还想使用 Windows Workflow Foundation。这可能吗？两者一起使用有什么问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T06:45:58.873

是的，这应该是可能的。虽然我没有尝试过使用 WF，只有 WCF，但它有效。不过在WF中应该没有太大的不同。本质上，它只是创建代理、发布您的请求（json 或 xml）并解析响应的问题。

这个 WCF 教程应该是一个很好的起点：[http](http://www.cleancode.co.nz/blog/114/extjs-aspnet-part-2-wcf-communication) ://www.cleancode.co.nz/blog/114/extjs-aspnet-part-2-wcf-communication 。

# vba - 从 Office 2010 中的另一个模块运行子程序？

> ID：10707686
> 
> 赞同：0
> 
> 时间：2012-05-22T18:14:50.197
> 
> 标签：vba, module, ms-word

在 Word 2003 中，我使用：

```
 Call modulename.subname(passvar) 
```

在 Word 2010 中，它给了我一个运行时错误 13 错误类型不匹配？有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T18:19:22.850

很可能在您的 Sub 中`subname`您指定了一个参数的类型以使其期望，并且您`passvar`与该类型不匹配（可能是因为您尚未声明它并且它作为 传递`Object`）

# firefox - 火狐浏览器禁用安全模式

> ID：10707687
> 
> 赞同：4
> 
> 时间：2012-05-22T18:14:52.273
> 
> 标签：firefox, browser, kiosk-mode

我使用的是 Windows 7，并且一直在使用 Firefox 浏览器。我想使用它创建一个信息亭应用程序，为此我安装了一个插件，但问题是当我启动 Firefox 应用程序时，如果我按 Shift 键，它会进入安全模式。

我在 Google 上阅读了一些指南，告诉我进行编辑`chrome/browser.jar`，但我的 Firefox 文件夹中没有这样的文件。

我需要一些帮助来禁用让我通过按 Shift 进入安全模式的功能。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-22T18:43:00.110

您不能通过编辑文本文件来真正禁用安全模式，Shift 键的处理在[编译后的代码](http://hg.mozilla.org/mozilla-central/file/c20d415ef1b5/toolkit/xre/nsAppRunner.cpp#l3068)中。但是，您可以通过从以下代码中删除此代码来禁用弹出的对话框[`components/nsBrowserGlue.js`](http://hg.mozilla.org/mozilla-central/file/c20d415ef1b5/browser/components/nsBrowserGlue.js#l309)：

```
// check if we're in safe mode
if (Services.appinfo.inSafeMode) {
  Services.ww.openWindow(null, "chrome://browser/content/safeMode.xul", 
                         "_blank", "chrome,centerscreen,modal,resizable=no", null);
} 
```

您还可以在安全模式下启用扩展。为此，您还必须编辑[`modules/XPIProvider.jsm`](http://hg.mozilla.org/mozilla-central/file/c20d415ef1b5/toolkit/mozapps/extensions/XPIProvider.jsm#l7768)和删除所有出现的代码，例如：

```
if (Services.appinfo.inSafeMode)
  return false; 
```

这两个文件都可以`onmi.ja`在 Firefox 目录的存档中找到。

[也就是说，该问题的正确解决方案是在XULRunner](https://developer.mozilla.org/en/XULRunner)之上运行您自己的应用程序，这将允许您为信息亭模式设计自己的用户界面。可悲的是，Open Kiosk（可能是您正在使用的）是古老的并且早于 XULRunner。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-09-16T14:42:41.910

我设法禁用了 Firefox 会话恢复和安全模式，调整了这两个首选项：

```
browser.sessionstore.resume_from_crash  => false
toolkit.startup.max_resumed_crashes     => -1 
```

# html - 处理xsl中的html表格

> ID：10707689
> 
> 赞同：0
> 
> 时间：2012-05-22T18:15:03.577
> 
> 标签：html, xml, xslt, html-table

我正在尝试通过 xsl 创建一个 html 表。我似乎无法为我的[table](http://jsfiddle.net/JTpme/)的以下结构找到更好的方法。问题是带有字幕的“2ColumnHeader”。我需要如何设置我的表结构以及

```
<xsl:for-each> 
```

环形？

现在只是：

```
<tr> <td> <xsl:value-of select="@xyz" /> </td> .......</tr> 
```

我希望这是对我的问题的清晰描述。

更新：

所以这是我清理过的带有随机数据的 xsl 表：

```
<table>
<thead>
    <tr>
        <th>No.:</th>
        <th>Heading1</th>
        <th>Heading2</th>
        <th>Heading3</th>
        <th>Heading4</th>
        <th>I need two subheadings for this Heading</th> 
    </tr>
</thead>
<tbody>       

<xsl:for-each select="tabledata">
   <tr>
        <td><xsl:number/></td>
        <td> <xsl:value-of select="@name" /> </td>
        <td> <xsl:value-of select="description" /> </td>
        <td> <xsl:value-of select="text1" /> </td>
        <td> <xsl:value-of select="text2" /> </td>
        <td> <xsl:value-of select="text3" /> </td> 
```

```
</tr>
</xsl:for-each>
 </tbody>       
</table> 
```

# git - Git - “非单调索引”

> ID：10707690
> 
> 赞同：3
> 
> 时间：2012-05-22T18:15:09.400
> 
> 标签：git

我正在我的本地电脑上克隆一个 git 存储库。在此过程中，该命令会输出大量以下错误消息：

```
error: non-monotonic index .git/objects/pack/._pack-*.idx 
```

例如，此消息保持在拉动或分支开关上，但一切似乎都有效。本地存储库似乎没有损坏或类似的东西。

关于错误消息的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T10:26:49.703

在我看来，这些只是 OSX 创建的一堆 ._ 文件，而 git 不明白它需要忽略它们。我对大量这样的文件也有同样的问题。只是删除 ._* 似乎已经解决了它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-06-08T10:17:37.420

我在这种非单一错误中搜索信息并找到了这个链接： http: [//git.661346.n2.nabble.com/Error-non-monotonic-index-after-failed-recursive-quot-sed- quot-command-td7575014.html](http://git.661346.n2.nabble.com/Error-non-monotonic-index-after-failed-recursive-quot-sed-quot-command-td7575014.html)

TL；DR：您删除非单音索引，然后重新索引它。在linux中它将是：

```
> rm .git/objects/pack/pack-*.idx
> git index-pack .git/objects/pack/pack-*.pack 
```

在这之后我不得不运行一些`git gc --prune=now`and `git remote prune origin`，但我之前做过一些其他的操作，所以我可能已经破坏了我的 repo。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-08-12T21:39:38.880

当您移动存储库时，会在 MacOS 系统上生成名称如“._pack-*.idx”的文件。

查看您拥有远程存储库的位置：my-repo.git/object/pack。在这里，您将拥有普通的 pack*idx 文件和由 MacOS 生成的具有相同名称但前缀为 ._ 的文件

删除它们，您的回购就可以了。

# android - Android 权限，required="false"，失败

> ID：10707693
> 
> 赞同：10
> 
> 时间：2012-05-22T18:15:14.807
> 
> 标签：android, permissions

我的应用程序为用户提供了对 SMS 和电话呼叫的*可选*访问权限。我用过：

```
 <uses-permission android:name="android.permission.READ_PHONE_STATE" android:required="false"></uses-permission>
 <uses-permission android:name="android.permission.SEND_SMS" android:required="false"></uses-permission>
 <uses-permission android:name="android.permission.CALL_PHONE" android:required="false"></uses-permission> 
```

Google Play 不会将此应用程序公开给没有蜂窝网络访问权限的设备。似乎 required = false 参数无法完成其工作。

这是一个错误吗？还有什么我可以做的吗？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-05-22T18:19:10.467

为什么要将所需的参数放入权限中？当你声明一个特性时使用 android:required 参数，afaik... 例如：

```
<uses-feature android:name="android.hardware.sensor.accelerometer" android:required="true" /> 
```

我认为您想要做的是添加`uses-feature`声明`android:required="false"`.

使用此表更新您的清单：http: [//developer.android.com/guide/topics/manifest/uses-feature-element.html#permissions-features](http://developer.android.com/guide/topics/manifest/uses-feature-element.html#permissions-features)

```
<uses-feature android:name="android.hardware.telephony" android:required="false" /> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-22T19:09:20.453

您可以在`AndroidManifest.xml`文件的权限选项卡中看到所有权限。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-05-17T14:30:19.750

您不需要使用其中的属性仅适用于 `android:required`，请参阅定义`<uses-permission``<uses-feature`

> **uses-feature**：为了控制过滤，总是在元素中显式声明硬件特性，而不是依靠 Google Play 来“发现”`<uses-permission>`元素中的需求。然后，如果您想禁用对特定功能的过滤，您可以 `android:required="false"`在声明中添加一个属性。

这是暗示硬件功能的权限列表：

[https://developer.android.com/guide/topics/manifest/uses-feature-element.html#permissions-features](https://developer.android.com/guide/topics/manifest/uses-feature-element.html#permissions-features)

根据您的元素：

您可能只需要添加：

```
<uses-feature android:name="android.hardware.telephony" android:required="false" /> 
```

# rtc - RTC：解决流间隙？

> ID：10707694
> 
> 赞同：4
> 
> 时间：2012-05-22T18:15:21.967
> 
> 标签：rtc, ibm-rational

我在 RTC 中有一个文件（调用它`foo.c`），我对其进行了修改并签入了变更集（`CS1`）以及其他一些更改。然后我再次修改了该文件并将其`CS2`与其他更改一起检查到不同的变更集（）中。

我现在遇到了一个我想传递`CS2`到流的情况，但是 RTC 给了我一个错误，即传递会在流中创建一个间隙（因为 中的更改`CS1`）。我还不想交付所有内容`CS1`，因为它包含一些不应该在构建中的更改。`foo.c`对in的原始更改`CS1`是对 a 的轻微删除`#include`，并且不会影响其他任何内容。

有没有办法解决这个差距？

我在 RTC 文档中看到了一些关于应用补丁的内容，但我不明白它在哪里。
有没有办法将变更集拆分为多个变更集，这样我就可以只交付一个文件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T17:44:01.310

问题：CS1 更改 foo.c，CS2 进一步更改 foo.c。您只想交付 CS2，但 RTC 告诉您这会引入差距。

解决方案：从 CS2 创建补丁并暂停 CS1 和 CS2。然后应用补丁，将其合并到您的工作区并签入更改，这将创建另一个更改集 CS3，与 CS2 相同，但不依赖于 CS1。您现在可以交付 CS3。

交付 CS3 后，您可以丢弃 CS2 并恢复 CS1，这需要您与 CS3 合并。

那么您应该处于 CS1 建立在 CS3 之上的状态，您可以选择将来是否交付 CS1。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-22T19:27:38.643

自 2012 年以来的更新（以及交付所有内容并恢复您不想要的内容的原始“解决方法”）：

看到[这个线程](https://jazz.net/forum/questions/129692/delivering-these-changes-would-introduce-gaps)：

> 在 RTC 4.0.5 中，我们在尝试接受有差距的变更集时提供了额外的支持（在尝试向后移植修复时经常遇到）。
> 
> 在对该功能的一个非常简短的总结中，当您接受具有间隙的更改集时，您现在可以遵循一次接受一个更改集的间隙工作流，并且对于包含间隙的更改集，创建一个新的更改集（带有辅助可追溯性），其中包含等效更改。
> 这意味着用户不必接受“作为补丁”的更改集。
> 
> 与新的工作流程相比，将更改集作为补丁应用具有局限性。
> 此功能在[RTC 4.0.5 'New & Noteworthy' 页面](https://jazz.net/downloads/rational-team-concert/releases/4.0.5?p=news#scm-improve-usability-405-m1)中进行了总结。
> 
> 以下是一些展示此功能的视频：
> 
> *   [在 Eclipse IDE 的 RTC 4.0.5 客户端中接受多个有间隙的更改集](https://www.youtube.com/watch?v=28raag5RdzU)
> *   [接受 Eclipse IDE 的 RTC 4.0.5 客户端中存在间隙的更改集](https://www.youtube.com/watch?v=TucVu_BgB7E)

这就是[定位更改集](http://www.youtube.com/watch?v=iyX32R7da2c)功能：

[![https://jazz.net/downloads/pages/rational-team-concert/4.0.5/4.0.5/images/gapeditor.png](../Images/bd60c5302b67c94cfe07b0220383506c.png)](https://i.stack.imgur.com/PhKCR.png)

* * *

> 在 RTC 5.0 中，我们添加了“填补空白”功能，其中向用户显示了填补空白的变更集，允许他们接受所有变更集或继续 RTC 4.0.5 中可用的空白工作流.
> 
> 此功能在[RTC 5.0 'New & Noteworthy' 页面](https://jazz.net/downloads/rational-team-concert/releases/5.0?p=news#eclipse-fill-gaps)中进行了总结：
> 
> 填补空白所涉及的类包括（在 RTC 5.0 中可用）：
> 
> ```
> client side: IWorkspaceConnection.findChangeSetsToAcceptToFillGap(...) 
> server side: IScmQueryService.findChangeSetsToAcceptToFillGap(...) 
> ```
> 
> [“改进的 SCM 间隙处理](https://jazz.net/library/article/1372)”一文中详细解释了这两个特性。

[![https://jazz.net/downloads/pages/rational-team-concert/5.0/5.0/images/missing-change-sets-dialog.png](../Images/4c79009e72c9ba56557debbbd07fe284.png)](https://i.stack.imgur.com/NostH.png)

* * *

原始答案（2012）

> 有没有办法拆分变更集？

我不这么认为，阅读[变更集手册页](https://jazz.net/help-dev/clm/index.jsp?topic=/com.ibm.team.scm.doc/topics/c_csets.html&re=1&scope=null)：

> 组件中的文件或文件夹不能属于多个活动更改集。
> 当文件或文件夹包含在活动更改集中时，对其的所有更改都将成为该更改集的一部分，无论该更改集是否是当前的，并且**对该文件或文件夹的更改不能显式签入到新的更改集中，直到包含它的活动更改集已完成**。

在 CS1*和*CS2 中有 foo.c 意味着 CS1 已经“完成”（本质上是冻结的），尝试拆分它会很糟糕。

补丁解决方案意味着：

*   取消 CS1
*   将 foo.c 的附加更改添加到 CS2
*   重做 CS1 更改

请参阅“[如何从流中删除更改集？](https://jazz.net/library/article/126#How_do_I_remove_a_change_set_fro) ”

[故事 149483](https://jazz.net/jazz/web/projects/Rational%20Team%20Concert#action=com.ibm.team.workitem.viewWorkItem&id=149483)是关于增强繁琐的工作流程，并且正在增强间隙检测（[增强 24822](https://jazz.net/jazz/web/projects/Rational%20Team%20Concert#action=com.ibm.team.workitem.viewWorkItem&id=24822)）

* * *

[OP timwoj](https://stackoverflow.com/users/402834/timwoj)总结道：

> **我最终只是交付了所有东西，然后将我不想要的东西倒过来**。

# windows - 仅使用句柄删除文件

> ID：10707697
> 
> 赞同：0
> 
> 时间：2012-05-22T18:15:30.110
> 
> 标签：windows, winapi, createfile

假设由于 WinAPI CreateFile，我有一个文件句柄。它不是用 FILE_FLAG_DELETE_ON_CLOSE 打开的。

有没有办法在没有文件名的情况下删除只有句柄的文件？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-22T18:49:11.640

如果您在 Windows Vista 或更高版本上运行，[则 SetFileInformationByHandle()](http://msdn.microsoft.com/en-us/library/windows/desktop/aa365539%28v=vs.85%29.aspx)将允许您通过设置 information class 来执行此操作`FileDispositionInfo`。

此操作的最终结果将是句柄现在将被标记为在关闭时删除 - 当文件的最后一个句柄关闭时，文件将被删除。

对于旧版本的 Windows，NTDLL 导出 NtSetInformationFile() 可以让你做同样的事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T18:29:37.843

我不知道您是否可以仅根据句柄专门删除文件，但您始终可以使用句柄来检索文件名，如[本 MSDN 文章](http://msdn.microsoft.com/en-us/library/aa366789.aspx)中所述，然后调用 DeleteFile()。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-23T02:52:22.070

Vista+ 提供[GetFinalPathNameByHandle()](http://msdn.microsoft.com/en-us/library/windows/desktop/aa364962%28v=vs.85%29.aspx)可与 VOLUME_NAME_DOS 一起使用以查询“DOS”路径，然后您可以将其传递给[DeleteFile()](http://msdn.microsoft.com/en-us/library/windows/desktop/aa363915%28v=vs.85%29.aspx)。

# c# - XML 命名空间中不存在标记“功能区”

> ID：10707704
> 
> 赞同：3
> 
> 时间：2012-05-22T18:15:59.263
> 
> 标签：c#, wpf, ribbon

我正在尝试在 .Net 4.5 框架上使用功能区控件开发 WPF 应用程序。据我所知，[MSDN Ribbon Class](http://msdn.microsoft.com/en-us/library/system.windows.controls.ribbon.ribbon%28v=vs.110%29.aspx)现在已包含在 Net 4.5 框架中，因此，我不需要再添加[它](http://www.microsoft.com/en-us/download/details.aspx?id=11877)了。

但是当我尝试添加此代码时：

```
<Window x:Class="WpfApplication2.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="MainWindow" Height="350" Width="525">
    <StackPanel>
        <Ribbon>
        </Ribbon>
    </StackPanel>
</Window> 
```

我收到以下错误。我错过了什么吗？

```
The tag 'Ribbon' does not exist in XML namespace 'http://schemas.microsoft.com/winfx/2006/xaml/presentation'. 
```

编辑 ：

```
using System.Windows.Controls.Ribbon; 
```

也不起作用。

```
The type or namespace name 'Ribbon' does not exist in the namespace 'System.Windows.Controls' (are you missing an assembly reference?)  c:\tmp\tst2\tst2\MainWindow.xaml.cs 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-22T18:44:57.690

您需要添加对 System.Windows.Controls.Ribbon.dll 的引用（它是 .NET 4.5 框架的一部分。然后您需要将命名空间添加到 XAML，例如：

```
xmlns:ribbon="clr-namespace:System.Windows.Controls.Ribbon;assembly=System.Windows.Controls.Ribbon" 
```

到您的窗口以获取名称空间，然后您可以像使用它一样

```
<ribbon:Ribbon ... /> 
```

就像科尔约翰逊说的。

这是[有关 Ribbon 类的 MSDN 参考](http://msdn.microsoft.com/en-us/library/system.windows.controls.ribbon.ribbon%28v=vs.110%29)，其中显示了所有这些信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T18:31:19.880

是<ribbon:Ribbon />

您还需要参考功能区的方案

# oracle10g - Oracle中使用NVL时查询运行缓慢

> ID：10707706
> 
> 赞同：3
> 
> 时间：2012-05-22T18:16:03.183
> 
> 标签：oracle10g

当我查询此视图时，我有一个视图，它运行缓慢。但是，如果我删除 NVL 功能，它会运行得很快。

我检查了执行计划，当使用 NVL 函数时，它没有使用任何索引。如果未使用 NVL 功能，则为索引。我试图将索引指定为提示，但没有帮助。不确定执行时是否考虑提示。

下面是视图和用于创建视图的查询。

```
CREATE OR REPLACE FORCE VIEW  "test"(a,b)
select NVL(table1.a,table2.a) a,table2.b from table1 join table2 on table1.id=table2.id 
```

我正在查看的查询是

```
select * from test where a='XYZ' 
```

有什么想法我应该怎么做才能使上述查询快速运行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T12:12:17.930

不确定您是否已经得到答案 - 您需要使用 NVL(a) 使用基于功能的索引。默认情况下，Oracle 不会索引空列，因此当您使用 NVL 查询时，它将执行全表扫描。

# iphone - 在 iPad 上未调用 viewDidAppear 和 viewWillAppear

> ID：10707710
> 
> 赞同：3
> 
> 时间：2012-05-22T18:16:12.757
> 
> 标签：iphone, modalviewcontroller, viewwillappear, viewdidappear, uimodalpresentationstyle

我使用以下代码将设置页面称为 viewController 上的表单：

```
NSUserDefaults *standardUserDefaults = [NSUserDefaults standardUserDefaults];
NSString *device = [standardUserDefaults objectForKey:@"Device"];
if ([device isEqualToString:@"iPhone"]) {
    Settings_iPhone *screen = [[Settings_iPhone alloc] initWithNibName:nil bundle:nil];
    screen.modalTransitionStyle = UIModalTransitionStyleFlipHorizontal;
    [self presentModalViewController:screen animated:YES];
    [screen release];
}
if ([device isEqualToString:@"iPad"]) {    
    Settings_iPhone *screen = [[Settings_iPhone alloc] initWithNibName:@"Settings_iPad" bundle:nil];
    screen.modalPresentationStyle = UIModalPresentationFormSheet;
    screen.modalTransitionStyle = UIModalTransitionStyleFlipHorizontal;
    [self presentModalViewController:screen animated:YES];
    [screen release];
} 
```

当设置页面被调用和关闭时，viewDidAppear 和 viewWillAppear 仅在 iPad 上不会在原始页面上调用。在 iPhone 上，由于它不是表单，它可以完美运行，此外，当我将 iPad 上的设置页面作为常规模式视图而不是表单调用时，它们都会被调用。请帮忙。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-20T19:23:55.210

您可以在呈现之前将父视图控制器的值传递给模态视图（只需添加一个属性并保留引用）。当您在模态视图中完成后，调用父级上的方法（在这个方法中，您可以传递需要传递给父级视图的任何内容，并在**父级**（）`-(void)imDone:(NSObject yourValue)`上调用关闭。**`dismissViewController:Animated:`**

 **您可以在 iPhone 和 iPad 上使用这种方法。

我希望它有所帮助。**

# c# - System.dll 中出现“System.Net.WebException”类型的第一次机会异常

> ID：10707712
> 
> 赞同：3
> 
> 时间：2012-05-22T18:16:19.157
> 
> 标签：c#, visual-studio-2010, debugging

我正在使用 TweetSharp 查找用户的关注者。

这是代码：

```
public static void FindFollowersForUser(TwitterUserModel twitterUser)
{
    try
    {
        var followers = service.ListFollowersOf(twitterUser.TwitterName, -1);
        if (followers == null) return;
        while (followers.NextCursor != null)
        {
            var foundFollowers = service.ListFollowersOf(twitterUser.TwitterName, (long)followers.NextCursor);
            if (foundFollowers == null) continue;

            Debug.WriteLine("Followers found for: " + twitterUser.TwitterName);
            foreach (var follower in foundFollowers)
            {
                twitterUser.Followers.Add(follower.ScreenName);
            }
        }
    }
    catch (WebException e)
    {
        throw e;
    }
} 
```

我尝试将代码包装在 try/catch 中，以捕获被触发的 WebException 错误并查看它的 InnerException，但尽管错误消息显示`View -> Output`在 Visual Studio 的输出窗口 ( ) 中，但从未输入 catch。

我怎样才能看到这个破坏性错误的内部异常？这是我第一次看到调试器在触发异常时不触发 catch。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-22T21:02:08.540

我假设当您说“第一次机会异常”时，您的意思是输出到调试控制台的消息？每当抛出异常时，都会输出该消息。异常可能会被代码捕获并处理，并且不允许向上传播。TweetSharp 可能会在其代码中捕获此异常并以某种方式进行处理，因此它永远不会到达您的`catch`块

这是正常的，只有调试器会显示此消息。如果这在某种程度上对您来说是个问题（输出窗口中显示的消息除外），请提供更多详细信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-02-24T16:54:46.840

真的，我在寻找别的东西，但这让我眼花缭乱。如果您打算重新抛出异常，那么您想替换它

```
catch (WebException e) { throw e; } 
```

这样你就不会弄乱堆栈跟踪。

```
catch (WebException e) { throw; } 
```

# c# - Mongodb c#在结果中包含子属性以便映射到结果类

> ID：10707713
> 
> 赞同：0
> 
> 时间：2012-05-22T18:16:21.037
> 
> 标签：c#, mongodb

我有以下代码工作：

```
var Logs = MvcApplication.MongoLoggingDatabase.GetCollection<Log>("Log")
            .Find(queryDocument)
            .Select(x => new LogDto { ModelNumber = x.Request.ModelNumber, Make = x.Request.Make, TimeStamp = x.TimeStamp, UserId = x.UserId })
            .OrderByDescending(x => x.TimeStamp)
            .Skip(pageSize * (page - 1))
            .Take(pageSize); 
```

我可以将结果映射到 LogDto。但我想知道是否可以改用 FindAs，这样我就可以查询我想要的字段并按预期映射对应的子属性。

我尝试了类似以下的方法：

```
var Logs = MvcApplication.MongoLoggingDatabase.GetCollection<Log>("Log")
                .FindAs<LogDto>(queryDocument)
                .SetFields(Fields.Exclude("_id").Include("TimeStamp", "UserId", "Request_ModelNumber", "Request_Make"))
                 .OrderByDescending(x => x.TimeStamp)
                .Skip(pageSize * (page - 1))
                .Take(pageSize); 
```

TimeStamp 和 UserId 映射正确，但 Make 和 ModelNumber 仅显示 null。我想知道如何使用 SetFields 将 Request.ModelNumber 和 Request.Make 映射到 LogDto 上的相应字段（Make 和 Model）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T19:04:49.863

你可能做不到。SetFields 可用于选择返回哪些字段，但不能用于重塑返回的文档。反序列化 LogD 所需的所有值都必须来自 BSON 文档的同一级别（而不是其中一些嵌套在像 ModelNumber 和 Make 这样的请求中）。

您要么必须使您的班级与文档格式匹配，要么更改您的文档格式以匹配您的班级。

# asp.net-mvc-3 - MVC 中的共享视图：View(string, object) 给出视图未找到错误

> ID：10707722
> 
> 赞同：0
> 
> 时间：2012-05-22T18:16:42.540
> 
> 标签：asp.net-mvc-3

我有几种可以使用相同视图的操作方法。我试过用例如调用 View

return View("~/views/contact/Emails", model);

视图“电子邮件”存在于指定目录中（Resharper 在 URL 下划线），但是当我运行应用程序时，我收到错误消息“视图 '~/views/contact/Emails' 或其主文件未找到或没有视图引擎支持搜索的位置。搜索了以下位置：~/views/contact/Emails"

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T18:23:20.430

假设你在里面`ContactController`，你可以简单地传入视图的名称。

```
return View("Emails", model); 
```

MVC 使用路由来查找 View，因此它不关心文件路径，只关心名称（至少在请求管道中的这一点上）。

# sql - 删除interbase中单词 之间的空格

> ID：10707727
> 
> 赞同：0
> 
> 时间：2012-05-22T18:16:56.657
> 
> 标签：sql, interbase

我需要删除 interbase 中“单词”之间的所有空格。来自 SQL 服务器背景，我假设（错误地）interbase 将支持替换功能，但显然不支持。因此，给定一个可能包含或不包含空格的电话号码，例如 0117 565 464，我如何将其与没有空格的输入字符串匹配？

编辑以下评论，它是 Interbase XE，当我尝试使用替换时出现“未知功能替换”错误

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T13:03:23.713

Interbase 支持用户定义函数 (UDF)，它是包含在 DLL 中的外部编程函数。Interbase 产品中包含许多 UDF，但没有一个可以删除空白（或短划线）。但是，您可以自己编写并添加它。然后你可以像使用Interbase 中的SQL 语句一样使用它。

# .net - 使用 Powershell 2.0 远程连接到 Hyper-V VM 永远无法找到 VM

> ID：10707728
> 
> 赞同：1
> 
> 时间：2012-05-22T18:16:57.753
> 
> 标签：.net, powershell, windows-server-2008, remoting, powershell-remoting

我目前正在使用 Powershell 2.0 并遇到以下问题。我已经设置了一个 Hyper-V VM，我正在尝试从我的本机/主机操作系统远程访问它。

我一直在关注本远程处理教程：http: [//www.computerperformance.co.uk/powershell/powershell_remote.htm#Create_a_PowerShell_Remote_Session](http://www.computerperformance.co.uk/powershell/powershell_remote.htm#Create_a_PowerShell_Remote_Session)

当我使用以下 PS 命令远程访问作为完全限定域 foo 的 VM 时： Enter-PSSession foo

我收到一个错误，类似于 PS 无法找到计算机。我已确保在 VM 上启用了网络发现并启用了远程访问，但仍然遇到同样的问题。

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T06:54:15.007

首先，检查您的 RM 在哪个端口上运行（从目标系统上的命令行）：

```
winrm e winrm/config/listener 
```

如果这不在端口上运行，`5985`则连接时必须指定端口

通过从客户端运行“ping”命令检查连接是否正常：

```
Test-WSMan -ComputerName "full machine name" 
```

如果它没有帮助 - 发布两个命令的输出。顺便说一句，我希望你的虚拟机中有正确的网络配置，我的意思是它有自己的名称和 IP？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T20:23:48.143

首先请尝试使用 IP 地址，如果使用不正确的 FQDN，它应该可以工作。

一旦你的 IP 地址工作意味着你的目标 VM 不需要网络设置等，你只需要获得正确的 FQDN，这是你可以尝试的。

例如，当我 ping 到机器名称 XYZ 时，如下所示：

```
ping xyz 
```

它将返回如下机器 FQDN 或类似内容：

```
Pinging xyz.abc.corp.com 
```

在上述情况下，“xyz.abc.corp.com”是正确的 FQDN，如果您只收到“Pinging xyz”，那么“xyz”就是您的 FQDN。

# sql - 执行触发器；更新另一个字段

> ID：10707730
> 
> 赞同：0
> 
> 时间：2012-05-22T18:17:06.537
> 
> 标签：sql, sql-server, tsql, sql-server-2005

我一直在阅读触发器，但我似乎没有找到一个可以处理我的情况的例子。我的情况很不幸。以前的 DBA 将冗余数据分散在我们的数据库中。

一旦公司名称在我的表中更改，我想在多个其他表中更新公司名称`organiz`。我有这个，但它似乎不起作用：

```
CREATE TRIGGER updOrgNameTrigger
ON organiz
AFTER UPDATE
AS

IF UPDATE(Org_Name_1)
BEGIN
    DECLARE @org_name varchar(256)
    SET @org_name = (select Org_Name_1 from organiz)
    UPDATE other_table set Org_Name_1 = @org_name
    UPDATE the_other_table set Org_name_1 = @org_name
END 
```

我正在尝试做的事情可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T18:19:55.440

您当前的触发器假定更新只能影响单行；它还打算用源表中的任意值更新其他两个表中的每一行（不一定是更新的行！）。您需要使用`inserted`伪表来识别触发触发器的行并为`Org_Name_1`列提取新值。这个版本怎么样：

```
CREATE TRIGGER dbo.updOrgNameTrigger
ON dbo.organiz
AFTER UPDATE
AS
BEGIN
    SET NOCOUNT ON;

    UPDATE o SET Org_Name_1 = i.Org_Name_1
      FROM dbo.other_table AS o
      INNER JOIN inserted AS i
      ON o.org_id = i.org_id;

    UPDATE o2 SET Org_Name_1 = i.Org_Name_1
      FROM dbo.the_other_table AS o2
      INNER JOIN inserted AS i
      ON o2.org_id = i.org_id;
END
GO 
```

# java - 变量声明后的这个静态块是什么？

> ID：10707734
> 
> 赞同：3
> 
> 时间：2012-05-22T18:17:39.643
> 
> 标签：java, static

我以前从未见过这个 - 它叫什么？这是一个类级别的变量，位于文件的开头。

为了清楚起见，我指的`static {}`是变量之后。

```
private static final UriMatcher URI_MATCHER;
    static {
        URI_MATCHER = new UriMatcher(UriMatcher.NO_MATCH);
        URI_MATCHER.addURI(AUTHORITY, SearchManager.SUGGEST_URI_PATH_QUERY, SEARCH);
        URI_MATCHER.addURI(AUTHORITY, SearchManager.SUGGEST_URI_PATH_QUERY + "/*", SEARCH);
        URI_MATCHER.addURI(AUTHORITY, "books", BOOKS);
        URI_MATCHER.addURI(AUTHORITY, "books/#", BOOK_ID);
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-22T18:20:24.127

这是一个静态*初始化*块。它可以在类内部的任何位置（但在方法外部）声明，但按照惯例，它通常写在正在初始化的静态变量之后。它在 Java 语言规范[第 8.7 节中指定](http://docs.oracle.com/javase/specs/jls/se7/html/jls-8.html#jls-8.7)。

顾名思义，它通常用于在类加载时初始化类中静态属性的状态。来自[Java 教程](http://docs.oracle.com/javase/tutorial/java/javaOO/initial.html)：

> 静态初始化块是用大括号 { } 括起来并以 static 关键字 (...) 开头的普通代码块。一个类可以有任意数量的静态初始化块，它们可以出现在类主体的任何位置。运行时系统保证静态初始化块按照它们在源代码中出现的顺序被调用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-22T18:24:54.053

用于初始化静态变量。如你所知，你不能在你的类的构造函数中初始化它们，所以你可以使用`static`block 作为一个例子：你想用值 1、2、3 等填充静态数组。有两种方法：

```
public class Main {
    static int[] array1 = {1, 2, 3, 4 ...};

    static int[] array2;
    static {
        array2 = new int[N];
        for (int i = 0; i < N; i++) {
            array2[i] = i;
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-22T18:20:25.360

这是代码的静态部分，它在声明静态变量 URI_MATCHER 后对其进行初始化

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-22T18:22:19.827

它只是一个静态初始化块。查看：[http ://docs.oracle.com/javase/tutorial/java/javaOO/initial.html](http://docs.oracle.com/javase/tutorial/java/javaOO/initial.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-22T18:21:14.567

这是一个[静态初始化块](http://docs.oracle.com/javase/tutorial/java/javaOO/initial.html)。*它允许您“设置”静态字段，这在类实例*的方法中无法正确完成。

# recursion - 使用追加在序言中递归

> ID：10707737
> 
> 赞同：2
> 
> 时间：2012-05-22T18:17:49.260
> 
> 标签：recursion, prolog

我是 Prolog 的新手，在理解递归的工作原理时遇到了一些问题。

我想做的是创建一个数字列表（稍后绘制图形）。

所以我有这个代码：

```
nbClassTest(0, _). 

nbClassTest(X, L) :- 
    numberTestClass(A,X),
    append([A], L, L),
    X is X - 1,
    nbClassTest(X, L). 
```

但它一直给我“假”作为答案，我不明白为什么它没有填满列表。如果 X 达到 0，它应该结束吗？

numberTestClass(A,X) 给了我一个数字（在变量 A 中）一些 X，就好像它是一个函数一样。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T18:55:03.937

You should build the list without appending, because it's rather inefficient. This code could do:

```
nbClassTest(0, []). 
nbClassTest(X, [A|R]) :- 
    numberTestClass(A, X),
    X is X - 1,
    nbClassTest(X, R). 
```

or, if your system has between/3, you can use an 'all solutions' idiom:

```
nbClassTest(X, L) :-
    findall(A, (between(1, X, N), numberTestClass(A, X)), R),
    reverse(R, L). 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-22T18:42:54.600

问题是您对旧列表和新列表使用相同的变量。现在你第一个 append/3 创建一个无限长的列表，由等于 A 的值的元素组成。

```
?-append([42],L,L).
L = [42|L].

?- append([42],L,L), [A,B,C,D|E]=L.
L = [42|L],
A = B, B = C, C = D, D = 42,
E = [42|L]. 
```

那么，如果下一个 A 与前一个 A 不同，它将失败。

```
?- append([42],L,L), append([41],L,L).
false. 
```

代码还有更多问题；您的基本情况有一个未实例化的变量。您可能想要，但我相信您实际上想要一个空列表：

```
nbClassTest(0, []). 

nbClassTest(X, L) :- 
    numberTestClass(A,X),
    append([A], L, NL),
    X is X - 1,
    nbClassTest(X, NL). 
```

最后， append/3 有点低效，所以你可能想避免它并以另一种方式构建列表（或使用差异列表）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-22T18:36:25.790

它失败了，因为您以错误的方式使用附加尝试

```
nbClassTest(0, _). 

nbClassTest(X, L) :- 
    numberTestClass(A,X),
    append([A], L, Nl),
    X is X - 1,
    nbClassTest(X, Nl). 
```

追加连接 2 个列表，因此没有这样的列表在添加到它之后仍然是相同的列表。

# image-processing - Photoshop 的 RGB 级别与 ImageMagick

> ID：10707738
> 
> 赞同：3
> 
> 时间：2012-05-22T18:17:52.057
> 
> 标签：image-processing, imagemagick, photoshop

我正在尝试将在 Photoshop 中创建的一些效果转换为用于 php/imagemagick 的代码。现在我对如何重新创建 Photoshop 的 RGB 级别功能特别感兴趣。我对 Photoshop 界面不是很熟悉，但这是给我的信息：

```
RGB Level Adjust
  Input levels: Shadow 0, Midtone 0.92, Highlight 255
  Output levels: Shadow 0, Highlight 255 
```

输入电平与输出电平的精确度是多少？我如何将其翻译成 ImageMagick？您可以在下面看到我尝试过的内容，但它没有正确呈现所需的效果（将 Photoshop 的 0-255 比例转换为 0-65535）：

```
$im->levelImage(0, 0.92, 65535);
$im->levelImage(0, 1, 65535); 
```

这主要是在黑暗中刺伤，因为参数名称不对齐，并且对于输出级别，参数的数量甚至不匹配。基本上我不明白当 Photoshop 应用调整时到底发生了什么。我认为这是我现在最大的障碍。一旦我明白了，我需要在 ImageMagick 中找到相应的效果。

任何人都可以阐明 Photoshop 中发生了什么以及如何使用 ImageMagick 复制它吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T20:37:57.427

阴影、中间调和高光是属于一定亮度范围内的颜色。例如，阴影是亮度直方图的较低范围，中间色调是中间的颜色，高光是较高的颜色。但是 - 您不能对这些值使用硬限制，这就是为什么您必须使用这样的曲线来加权直方图（一个像素可能同时位于多个范围内）。

![阴影、中间调和高光](../Images/bca650235b955393647f007025d0310f.png)

要分别调整阴影、中间调和高光，您需要创建每个像素的加权和，它使用当前的阴影、中间调和高光值来创建结果值。

我不认为你可以直接使用 ImageMagick API 来做到这一点——也许你可以简单地把它写成一个过滤器。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-23T20:41:12.450

所以我偶然发现了这个网站：[http ://www.fmwconcepts.com/imagemagick/levels/index.php](http://www.fmwconcepts.com/imagemagick/levels/index.php)

根据那里的信息，我能够提出以下 php，它在模拟 Photoshop 对输入和输出所做的一切方面似乎非常有效。

```
function levels($im, $inshadow, $midtone, $inhighlight, $outshadow, $outhighlight, $channel = self::CHANNEL_ALL) {
    $im->levelImage($inshadow, $midtone, $inhighlight, $channel);
    $im->levelImage(-$outshadow, 1.0, 255 + (255 - $outhighlight), $channel);
} 
```

这假设黑点和白点的 levelImage 参数在 0-255 的范围内。在您的系统上，它们实际上可能是 0-65535。如果那是他们可以的，那么调整它就很容易了。您还可以使用 $im->getQuantumRange() 检查您的设置使用的值。它将返回一个带有字符串版本和长版本量子的数组。从那里应该很容易标准化值或只使用新范围。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-22T18:31:33.010

查看[文档](http://php.net/manual/en/imagick.levelimage.php)：第一个值是黑点（阴影）输入值，中间是一个伽玛（我猜这与 Photoshop 的中点相同），最后一个是白点（高光）输入值。

输出值固定为图像类型的量子值，无需指定。

# xml - 如何在 Delphi 2009 中解析这个 XML 字符串？

> ID：10707740
> 
> 赞同：1
> 
> 时间：2012-05-22T18:17:53.350
> 
> 标签：xml, delphi, delphi-2009, xmldocument

这是 XML 字符串所具有的信息。

```
<?xml version="1.0" encoding="UTF-8"?>
<string xmlns="http://tempuri.org/">
<statusInfo><vendorClaimID>BRADY12478018AETNA</vendorClaimID>
<statusID>0</statusID><statusDescription>Unvalidated</statusDescription>
</statusInfo></string> 
```

**但这就是它的来源。您必须向右滚动才能看到所有内容。**

```
'<?xml version="1.0" encoding="utf-8"?>'#$D#$A'<string xmlns="http://tempuri.org/">&lt;statusInfo&gt;&lt;vendorClaimID&gt;BRADY12478018AETNA&lt;/vendorClaimID&gt;&lt;statusID&gt;0&lt;/statusID&gt;&lt;statusDescription&gt;Unvalidated&lt;/statusDescription&gt;&lt;/statusInfo&gt;</string>' 
```

我已将字符串加载到 XMLDoc 中，但不知道如何从这里轻松访问这些值。

```
var
doc: IXMLDocument;

doc := LoadXMLData(xmlString); 
```

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-22T23:10:59.010

您可以使用 XPath 提取节点的值

检查这个样本

```
{$APPTYPE CONSOLE}

{$R *.res}

uses
  MSXML,
  SysUtils,
  ActiveX,
  ComObj;

Const

XMLStr=
'<?xml version="1.0" encoding="UTF-8"?> '+
'<string xmlns="http://tempuri.org/">'+
' <statusInfo>'+
'  <vendorClaimID>BRADY12478018AETNA</vendorClaimID> '+
'  <statusID>0</statusID><statusDescription>Unvalidated</statusDescription> '+
' </statusInfo>'+
'</string> ';

procedure Test;
Var
  XMLDOMDocument  : IXMLDOMDocument;
  XMLDOMNode      : IXMLDOMNode;
begin
  XMLDOMDocument:=CoDOMDocument.Create;
  XMLDOMDocument.loadXML(XmlStr);
  XMLDOMNode := XMLDOMDocument.selectSingleNode('//string/statusInfo/vendorClaimID');
  if XMLDOMNode<>nil then
    Writeln(Format('vendorClaimID %s',[String(XMLDOMNode.Text)]));

  XMLDOMNode := XMLDOMDocument.selectSingleNode('//string/statusInfo/statusID');
  if XMLDOMNode<>nil then
    Writeln(Format('statusID %s',[String(XMLDOMNode.Text)]));

  XMLDOMNode := XMLDOMDocument.selectSingleNode('//string/statusInfo/statusDescription');
  if XMLDOMNode<>nil then
    Writeln(Format('statusDescription %s',[String(XMLDOMNode.Text)]));
end;

begin
 try
    CoInitialize(nil);
    try
      Test;
    finally
      CoUninitialize;
    end;
 except
    on E:EOleException do
        Writeln(Format('EOleException %s %x', [E.Message,E.ErrorCode]));
    on E:Exception do
        Writeln(E.Classname, ':', E.Message);
 end;
 Writeln('Press Enter to exit');
 Readln;
end. 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-22T23:38:48.590

XML 中的每个节点都将表示为`IXMLNode`中的`IXMLDocument`，与它们在 XML 中出现的层次结构相同。如果您首先查看带有缩进节点的 XML 会有所帮助，这样您就可以更清楚地看到层次结构：

```
<?xml version="1.0" encoding="UTF-8"?> 
<string xmlns="http://tempuri.org/"> 
  <statusInfo>
    <vendorClaimID>BRADY12478018AETNA</vendorClaimID> 
    <statusID>0</statusID>
    <statusDescription>Unvalidated</statusDescription> 
  </statusInfo>
</string> 
```

如果您了解层次结构，则可以为其编写代码：

```
var 
  doc: IXMLDocument;
  statusInfo: IXMLNode;
  vendorClaimID: String;
  statusID: Integer;
  statusDescription: String;
begin 
  doc := LoadXMLData(xmlString);
  statusInfo := doc.DocumentElement.ChildNodes['statusInfo'];
  vendorClaimID := statusInfo.ChildNodes['vendorClaimID'].Text;
  statusID := StrToInt(statusInfo.ChildNodes['statusID'].Text);
  statusDescription := statusInfo.ChildNodes['statusDescription'].Text; 
end; 
```

或者：

```
var 
  doc: IXMLDocument;
  statusInfo: IXMLNode;
  vendorClaimID: String;
  statusID: Integer;
  statusDescription: String;
begin 
  doc := LoadXMLData(xmlString);
  statusInfo := doc.DocumentElement.ChildNodes['statusInfo'];
  vendorClaimID := VarToStr(statusInfo.ChildValues['vendorClaimID']);
  statusID := StrToInt(VarToStr(statusInfo.ChildValues['statusID']));
  statusDescription := VarToStr(statusInfo.ChildValues['statusDescription']); 
end; 
```

如果您使用 Delphi 的 XML Data Binding 向导，它将生成将为您解析 XML 的接口：

```
var 
  doc: IXMLDocument;
  statusInfo: IXMLstatusInfoType;
  vendorClaimID: String;
  statusID: Integer;
  statusDescription: String;
begin 
  doc := LoadXMLData(xmlString);
  statusInfo := Getstring(doc).statusInfo;
  vendorClaimID := statusInfo.vendorClaimID;
  statusID := statusInfo.statusID;
  statusDescription := statusInfo.statusDescription; 
end; 
```

# c# - MassTransit中如何保证消息接收顺序

> ID：10707743
> 
> 赞同：2
> 
> 时间：2012-05-22T18:18:09.300
> 
> 标签：c#, rabbitmq, masstransit

我有一个有 3 个状态的传奇；初始、接收行、已完成 -

```
 public static State Initial { get; set; }
    public static State ReceivingRows { get; set; }
    public static State Completed { get; set; } 
```

当它收到 BofMessage（其中 Bof = 文件开头）时，它从 Initial 转换为 ReceivingRows。在 BofMessage 之后，它会接收大量 RowMessage，其中每个都描述平面文件中的一行。发送完所有 RowMessage 后，将发送 EofMessage 并且状态更改为 Completed。观察 -

```
 static void DefineSagaBehavior()
    {
        Initially(When(ReceivedBof)
            .Then((saga, message) => saga.BeginFile(message))
            .TransitionTo(ReceivingRows));

        During(ReceivingRows, When(ReceivedRow)
            .Then((saga, message) => saga.AddRow(message)));

        During(ReceivingRows, When(ReceivedRowError)
            .Then((saga, message) => saga.RowError(message)));

        During(ReceivingRows, When(ReceivedEof)
            .Then((saga, message) => saga.EndFile(message))
            .TransitionTo(Completed));
    } 
```

这可行，除了有时在 BofMessage*之前*收到几个RowMessage！这与我发送给他们的顺序无关。这意味着消息将被接收并最终计为错误，导致它们从我最终将它们写入的数据库或文件中丢失。

作为一个临时修复，我在这个方法中添加了一个小睡眠定时器技巧来完成所有的发布——</p>

```
 public static void Publish(
        [NotNull] IServiceBus serviceBus,
        [NotNull] string publisherName,
        Guid correlationId,
        [NotNull] Tuple<string, string> inputFileDescriptor,
        [NotNull] string outputFileName)
    {
        // attempt to load offsets
        var offsetsResult = OffsetParser.Parse(inputFileDescriptor.Item1);
        if (offsetsResult.Result != ParseOffsetsResult.Success)
        {
            // publish an offsets invalid message
            serviceBus.Publish<TErrorMessage>(CombGuid.Generate(), publisherName, inputFileDescriptor.Item2);
            return;
        }

        // publish beginning of file
        var fullInputFilePath = Path.GetFullPath(inputFileDescriptor.Item2);
        serviceBus.Publish<TBofMessage>(correlationId, publisherName, fullInputFilePath);

        // HACK: make sure bof message happens before row messages, or else some row messages won't be received
        Thread.Sleep(5000);

        // publish rows from feed
        var feedResult = FeedParser.Parse(inputFileDescriptor.Item2, offsetsResult.Offsets);
        foreach (var row in feedResult)
        {
            // publish row message, unaligned if applicable
            if (row.Result != ParseRowResult.Success)
                serviceBus.Publish<TRowErrorMessage>(correlationId, publisherName, row.Fields);
            else
                serviceBus.Publish<TRowMessage>(correlationId, publisherName, row.Fields);
        }

        // publish end of file
        serviceBus.Publish<TEofMessage>(correlationId, publisherName, outputFileName);
    } 
```

这是一个 5 秒的睡眠定时器，而且是一个非常丑陋的 hack。谁能告诉我为什么我没有按照发送顺序收到消息？如果默认情况下这些消息是无序的，我能否确保这些消息以正确的顺序发送？

谢谢！

**请注意，为了方便起见，这是从[http://groups.google.com/group/masstransit-discuss/browse_thread/thread/7bd9518a690db4bb](http://groups.google.com/group/masstransit-discuss/browse_thread/thread/7bd9518a690db4bb)交叉发布的。**

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-23T11:26:36.107

You cannot ensure messages get delivered in any order. You can get close in MT by ensuring there's only one concurrent consumer on the consumer side, I still wouldn't depend on this behaviour ([http://docs.masstransit-project.com/en/latest/overview/keyideas.html#handlers](http://docs.masstransit-project.com/en/latest/overview/keyideas.html#handlers)). This would effectively make your consumer single threaded.

# java - Web 服务实现 - 从客户端接收文件

> ID：10707745
> 
> 赞同：0
> 
> 时间：2012-05-22T18:18:16.470
> 
> 标签：java, web-services

我正在尝试用 Java 实现 Web 服务，以从我的客户端应用程序接收文件，该应用程序在 .Net 中实现。但是，我无法实现 Java Web 服务。我尝试了很多来获得任何示例程序。但是，我没有得到它。

我的主要目标是：

1.  我将使用我的 .Net 客户端软件浏览和发送文件
2.  我的 Java Web 服务将能够接收该文件
3.  收到该文件后，我将使用该文件进行一些处理并生成一个新文件。
4.  现在，我将不得不再次将该新文件返回给我的 .Net 客户端

简单地，

输入：我的 Web 方法必须接收一个文件 输出：我的 Web 方法应该返回一个文件

以下是我的本地环境详细信息：

Apache Tomcat 7、Axis 2、Eclipse、JRE 6

任何人都可以帮助我如何在我的 Java Web 服务中编写该 Web 方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T19:28:55.687

您可以尝试使用 JAX-WS 的 MTOM 来接受网络服务中的文件附件，使用这些关键字在 google 中搜索，您应该会获得很多关于如何使用 MTOM 和 JAX-WS 实现 WS 的信息 - 这里有一些： [http：/ /isurues.wordpress.com/2010/01/19/how-to-use-mtom-with-axis2-jax-ws-services/](http://isurues.wordpress.com/2010/01/19/how-to-use-mtom-with-axis2-jax-ws-services/) [http://cxf.apache.org/docs/mtom-attachments-with-jaxb .html](http://cxf.apache.org/docs/mtom-attachments-with-jaxb.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T19:44:19.227

您可以将文件作为包含在 XML 文档中的 base64 编码数据或作为包含在 XML 文档 (MTOM) 之外的附件发送/接收。

在 wsdl 第一种方法中，您需要使用模式类型“base64Binary”。

在代码优先方法中，您可以编写：

```
public DataHandler yourMethod(DataHandler input)
or
public byte[] yourMethod(byte[] input) 
```

链接：

*   [http://axis.apache.org/axis2/java/core/docs/mtom-guide.html](http://axis.apache.org/axis2/java/core/docs/mtom-guide.html)
*   [http://wso2.org/library/3860](http://wso2.org/library/3860)
*   [http://wso2.org/library/1675](http://wso2.org/library/1675)

# android - Jquery Mobile Lock Android 缩放

> ID：10707755
> 
> 赞同：0
> 
> 时间：2012-05-22T18:18:50.120
> 
> 标签：android, mobile, jquery-mobile, scaling

我正在为使用 Jquery Mobile 的移动网站开发一个框架。有没有人成功锁定了安卓手机的扩展能力？现在我正在使用`<meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=0" />`. 这适用于所有手机，但对于 Android，我可以扩展。我可以在 Javascript 中做些什么或更改视口设置吗？任何指导、演示或链接都会非常有帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T18:27:38.697

您可以使用 html 元标记来实现这一点

```
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"> 
```

[请参阅http://tab.pagesjaunes.fr](http://tab.pagesjaunes.fr)上的示例

# c# - 正则表达式 + 将由空格分隔的数字行转换为数组

> ID：10707764
> 
> 赞同：0
> 
> 时间：2012-05-22T18:19:44.947
> 
> 标签：c#, regex

我正在尝试将包含多个数字的字符串（每个数字用空格分隔）转换为双精度数组。

例如，原始字符串如下所示：

```
originalString = "50 12.2 30 48.1" 
```

我一直在使用 Regex.Split(originalString, @"\s*")，但它返回的数组看起来像：

```
[50
“”
12
“。”
2
“”
...]
```

任何帮助深表感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T18:29:50.083

改用这个

```
originalString.Split(new char[]{'\t', '\n', ' ', '\r'}, StringSplitOptions.RemoveEmptyEntries); 
```

无需每次都急于 RegEx :)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-22T18:22:18.887

怎么样，`string[] myArray = originalString.Split(' ');` 我认为这里不需要 RegEx..

如果您真的想使用 RegEx，请使用模式`\s+`而不是`\s*`. 表示零个`*`或多个，但您想拆分一个或多个空格字符。

使用正则表达式的工作示例：

```
 string originalString = "50   12.2   30 48.1";
        string[] arr = Regex.Split(originalString, @"\s+");

        foreach (string s in arr)
            Console.WriteLine(s); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-22T18:23:07.907

```
Regex.Split(originalString, @"\s+").Where(s => !string.IsNullOrWhiteSpace(s)) 
```

`Where`返回一个`IEnumerable`过滤掉空值/空格的值。如果您仍然希望它作为一个数组，那么只需添加`.ToArray()`到该调用链中。

该`+`字符是必需的，因为您需要一个*MINIMUM*才能使其正确匹配。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-22T18:34:25.423

我会坚持`String.Split`，提供您期望的所有空白字符。

在正则表达式中，`\s`等价于`[ \t\r\n]`（加上一些其他特定于使用风格的字符）；我们可以通过 a 来表示这些`char[]`：

```
string[] nums = originalString.Split(
    new char[] { ' ', '\t', '\r', '\n' }, 
    StringSplitOptions.RemoveEmptyEntries); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-22T18:43:17.023

如果您`null`作为分隔符传递给，则默认行为`String.Split`是在空格上拆分。`IsWhiteSpace`这包括与 Unicode测试匹配的任何内容。在表示制表符、换行符、垂直制表符、换页符、回车符和空格的 ASCII 范围内。

`RemoveEmptyEntries`您也可以通过传递选项来避免空字段。

```
originalString = "50 12.2 30 48.1";
string[] fields = originalString.Split(null as char[], StringSplitOptions.RemoveEmptyEntries); 
```

# java - JDialog 模式的问题（主窗口的鼠标事件被触发和缓冲）

> ID：10707765
> 
> 赞同：1
> 
> 时间：2012-05-22T18:19:46.360
> 
> 标签：java, swing, events, modal-dialog, jcombobox

我制作了一个 JDialog 并且该模态大概可以正常工作

```
dialog.setModalityType(JDialog.ModalityType.APPLICATION_MODAL);
dialog.setVisible(true); 
```

但后来我的问题是：

*   我在 jcombobox.setSelection() 之后抛出 Jdialog，我需要在接受按钮中单击两次才能隐藏对话框，因为下拉弹出窗口正在消耗第一次单击以关闭自己。我通过在调用对话框之前手动调用 jcombobox.hidePopup() 来修复它，但我不明白后者是否是模态的，为什么鼠标事件会触发窗口外的东西​​？`

*   我的主窗口以某种方式缓冲鼠标事件，因此对于那些在绘制模式对话框时未激活的鼠标事件（如前一点所发生的那样），它们似乎被缓冲并在对话框关闭后应用。这是预期的行为吗？

感谢你！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T18:34:04.597

*   替换`jcombobox.hidePopup("doesn't make me sence")`为`ActionListener`或`ItemListener`添加到`JComboBox`

*   通过@camickr添加[RequestFocusListener](http://tips4java.wordpress.com/2010/03/14/dialog-focus/)`FocusOwner`以正确设置

*   为什么还有其他原因`MouseListeners`，也许是在将任何事件触发到`JComponents`您无法`Focus`正确设置的情况下

# php - 游戏资源存储

> ID：10707766
> 
> 赞同：1
> 
> 时间：2012-05-22T18:19:46.693
> 
> 标签：php, mysql, database

我有下表 townResources，其中存储了每个城镇 ID 的每个资源值。对于大量用户的性能影响，我有点保留。我正在考虑将资源余额移动到城镇表，并将资源的一般价值存储在 .php 文件中。

这里有 townresources 表：

```
CREATE TABLE IF NOT EXISTS `townresources` (
  `townResourcesId` int(10) NOT NULL AUTO_INCREMENT,
  `userId` int(10) NOT NULL,
  `resourceId` int(10) NOT NULL,
  `townId` int(10) NOT NULL,
  `balance` decimal(8,2) NOT NULL,
  `resourceRate` decimal(6,2) NOT NULL,
  `lastUpdate` datetime NOT NULL,
  PRIMARY KEY (`resourceId`,`townId`,`townResourcesId`,`userId`),
  KEY `townResources_userId_users_userId` (`userId`),
  KEY `townResources_townId_towns_townId` (`townId`),
  KEY `townResourcesId` (`townResourcesId`)
) ENGINE=InnoDB  DEFAULT CHARSET=latin1 COMMENT='Stores Town Resources' AUTO_INCREMENT=9 ; 
```

就我而言，最好的选择是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T18:35:39.240

您最好的选择是先进行测试。您想支持多少用户和城镇？三倍……创建测试数据并查看性能是否在界限内。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T18:38:26.977

如果您遇到性能问题，您应该考虑使用 redis 或 memcache 缓存数据。

# django - 在 Django-Nonrel 中正确访问 OneToOneField 关系中的派生类

> ID：10707770
> 
> 赞同：1
> 
> 时间：2012-05-22T18:19:54.533
> 
> 标签：django, django-models, django-nonrel

我正在努力解决这个（希望如此）简单的问题。

我正在使用 Django-nonrel，并且正在尝试设置一些模型。我简化了下面的代码：

```
class Application(models.Model)
    name = "Application"

    def get_name(self):
        print(self.name)

class ExampleApp(Application)
    name = "Example Application"

class Site(models.Model)
    app = models.OneToOneField(Application, null=True)
    id  = models.CharField(max_length=1)
    # other details not important 
```

当我获得 的实例时`Site`，我想获得派生类的实例（例如`ExampleApp`）

```
class MyView(View):
    def get(self, request, *args, **kwargs):
        # Presuppose that I have an object with id="a"
        site = Site.objects.filter(id="a")

        #<Application: Application>
        app = site.app

        #returns "Application", not "Example Application"
        app.get_name() 
```

**如何访问派生类？**

*（理想情况下，我想做`Application`一个抽象基类，但是 django 不允许与抽象基类建立关系。我会在里面定义字段`Application`，但是 django-nonrel 不支持多表继承。）*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T18:37:57.183

如果没有额外的 Django 插件，这是不可能的。请参阅[在 django 中从父类中的对象中查找子类中的对象](https://stackoverflow.com/questions/5348157/find-object-in-child-class-from-object-in-parent-class-in-django)，其中 lazerscience 的答案建议使用[https://code.google.com/p/django-polymorphic-models/](https://code.google.com/p/django-polymorphic-models/)来访问此功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T17:43:35.857

Furbeenator 的回答是正确的，但我觉得我的（自我）回答可能对我这种情况的任何人都更有价值。

`Django-nonrel`包括一些不错的应用程序，值得注意的是`djangotoolbox`. 包含在`djangotoolbox`一个特定的字段中，`EmbeddedModelField`. 它似乎将模型的副本存储为“容器”模型中的 blob。

在我的例子中：

```
from djangotoolbox.fields import EmbeddedModelField

class Site(models.Model)
    app = EmbeddedModelField(null=True)
    id  = models.CharField(max_length=1)
    # other details not important 
```

这样做的好处是，在我的情况下，这也意味着我可以让我的`Application`类抽象。缺点是数据现在被复制了，我仍然无法`Site`从实例访问`Application`实例（但在我的情况下，这是一个可以接受的权衡）。

# sql-server - 使用 varchar(max) 进行慢速“选择”查询

> ID：10707773
> 
> 赞同：9
> 
> 时间：2012-05-22T18:20:08.447
> 
> 标签：sql-server, sql-server-2008-r2

我有一张 500 行的小桌子。该表有 10 列，包括 1 个 varchar(max) 列。

当我执行此查询时：

```
SELECT TOP 36 *
FROM MyTable
WHERE (Column1 = Value1) 
```

它在 3 分钟内检索了大约 36 行。varchar(max) 列每行包含 3000 个字符。

如果我尝试只检索少一行：

```
SELECT TOP 35 *
FROM MyTable
WHERE (Column1 = Value1) 
```

然后查询在 0 秒内检索 35 行。

在我的客户统计数据中，从服务器收到的字节数，我有：

95 292 查询在 0 秒内检索数据

在 3 分钟内检索数据的查询超过 200 000 000

你知道它是从哪里来的吗？

编辑---这是我的真实代码：

```
select top 36 *
from Snapshots
where ExamId = 212

select top 35 *
from Snapshots
where ExamId = 212 
```

编辑---关于客户统计的更多信息

具有巨大差异的两个统计数据是：

从服务器收到的字节数：66 038 Vs 超过 2 000 000

从服务器接收的 TDS 数据包 30 Vs 11000

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T19:09:26.490

我不确定，但试试这个：

> select * from Snapshots where ExamId = (select top 36 ExamId from Snapshots where ExamId = 212)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T18:42:56.693

使用`Index`for`ExamId`也使用`select field1,field2,etc`而不是 `select * ...`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-02-19T19:58:46.590

您的执行时间应该非常短，而 fetch 则要长得多。从 SELECT TOP 语句中删除 varchar(max) 并仅在您特别需要时检索这些值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-02-09T12:59:37.077

`SET STATISTICS IO ON`在运行查询之前包含`SELECT`并提供输出。此外，您能否发布来自 2 个不同查询的查询计划，因为这将大大有助于解释差异是什么。您可以使用[https://www.brentozar.com/pastetheplan/](https://www.brentozar.com/pastetheplan/)上传并提供链接。

您`TOP`也没有匹配`ORDER BY`项，因此您不能保证返回的前 35 或 36 行的顺序。这意味着 35 行可能不会全部包含在 36 行中，并且您返回的数据量*可能*大不相同。

最后，还尝试在 SSMS 中启用带有查询的**客户端统计**信息- 这将显示延迟是在服务器端还是在向您返回结果集时全部延迟。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-06-17T13:34:25.757

如果没有完整的表描述作为 DDL 语句 (CREATE TABLE...) 和索引，则很难回答。

一个重要的问题是：您在创建表时是否使用“指令” TEXTIMAGE_ON ？这会将 LOB 存储与关系数据分开，以避免行溢出存储......

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-11-17T11:25:31.713

正如其他人所说，你应该扔`schema (datatype+existing index)`桌子`Snapshot`。

在`snapshot`表中我相信`examid`是非聚集索引，它不是唯一的。一个`examid`有很多记录。快照表必须有任何 PK 列。

`Top`子句应始终与`Order b`y 子句一起使用。`Top`没有`Order by`子句的子句是`Non Determinstic`。它会根据什么来选择`Top N`。所以知道快照的模式然后决定正确的索引。

使用`Order by`子句也可以`Non Determinstic`，但这是另一个讨论。

你可以试试这个

```
create  table #temp(PKID int)

insert into #temp(pkid)
select top 36 pkid
from dbo.Snapshots
where ExamId = 212 
```

然后你可以这样做，

```
select col1,col2,col3,col4
from dbo.Snapshots S
where exists(select 1 from #temp t where t.pkid=s.pkid) 
```

现在你的主要问题和问题，

> 为什么 0 秒检索 35 行，3 分钟检索 36 行。

我很快就会写到这里。同时我正在等待快照表的完整结构。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-09-04T15:15:37.840

Varchar(max) 不能成为索引键的一部分，除了这个其他主要缺点之外，它不能作为连续的内存区域在内部存储，因为它们可能会增长到 2Gb。因此，为了提高性能，您需要避免它。

# javascript - 如何在 Javascript 中解析 JSON 字符串？

> ID：10707774
> 
> 赞同：2
> 
> 时间：2012-05-22T18:20:19.167
> 
> 标签：javascript, json

我想这真的很基本，我错过了一些明显的东西。

我想访问一个名为 graph_data 的变量中的值，该变量包含以下 JSON 对象：

```
graph_data= {"data":[0,0,0,0,0,0,0.1,0.4,0,0,8.2,7,5.1,0,0,0,0,0,0,0,0,0,0,0,0]} 
```

当我尝试获取 graph_data.data.length 时，我收到一个错误，即 graph_data.data 是“未定义”。

我似乎也无法让 graph_data.data[0] 返回任何东西。

我在这里想念什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-22T18:23:05.457

您的代码工作正常：

```
graph_data = {"data":[0,0,0,0,0,0,0.1,0.4,0,0,8.2,7,5.1,0,0,0,0,0,0,0,0,0,0,0,0]};
console.log(graph_data.data.length); // Outputs 25 
```

你确定你有一个对象文字而不是一个字符串吗？

如果你有后者，你需要用[JSON.parse](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/JSON/parse)解析它：

```
graph_data = JSON.parse('{"data":[0,0,0,0,0,0,0.1,0.4,0,0,8.2,7,5.1,0,0,0,0,0,0,0,0,0,0,0,0]}'); 
```

[对于没有原生 JSON 支持（如json2.js](https://github.com/douglascrockford/JSON-js)）的旧版浏览器，您需要一个解析器

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T18:25:49.897

为我工作...

```
graph_data= {"data":[0,0,0,0,0,0,0.1,0.4,0,0,8.2,7,5.1,0,0,0,0,0,0,0,0,0,0,0,0]};

for (var i = 0; i < graph_data.data.length; i++){
    $("body").append(graph_data.data[i]+"<br/>");
} 
```

[http://jsfiddle.net/mtDaH/](http://jsfiddle.net/mtDaH/)

# java - Play Framework 2.0 单元测试

> ID：10707777
> 
> 赞同：1
> 
> 时间：2012-05-22T18:20:24.430
> 
> 标签：java, unit-testing, playframework

在 Java Play 2.0 应用程序中运行测试有一个非常基本的问题。它不会接受我的测试。

我试图`test`在项目的根目录中放置一个文件夹，并按照文档的建议使用 Junit。这导致：

```
$ play test
[info] Loading project definition from /Users/.../play20TestTest/project
[info] Set current project to play20TestTest (in build     file:/Users/.../testapps/play20TestTest/)
[info] No tests to run for test:test
[success] Total time: 1 s, completed May 22, 2012 11:16:52 AM 
```

我也试过把`test`app放在下面。这至少拿起了我的代码，但测试包在我的类路径上不可用，所以我认为它不正确。

我做了一个简单的例子，并从文档中完全复制了 SimpleTest：[https ://github.com/jsimone/Play2UnitTest](https://github.com/jsimone/Play2UnitTest)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T18:41:51.377

您将测试放在 中`test/test/SimpleTest.java`，将其移至`test/SimpleTest.java`，它将与`play test`命令一起使用。

# facebook - 按 id 显示 Facebook 图片来源

> ID：10707781
> 
> 赞同：6
> 
> 时间：2012-05-22T18:20:49.167
> 
> 标签：facebook, facebook-graph-api, facebook-php-sdk, photos

我正在开发一个 Facebook 应用程序，它将照片 [id] 存储到 MySQL 中。我正在使用 Facebook 的 Graph API 来检索所有用户的照片，并通过单选按钮将所选照片 [id] 存储到 mysql 中。

*问题是，我应该如何通过存储的 id 显示图像的来源？*

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T18:37:57.293

您检查该 id 的图形对象，

```
graph.facebook.com/photoID 
```

例如来自 facebook.com/facebook 的照片

```
http://graph.facebook.com/427100966728 
```

这将返回一个 JSON 响应，您可以为其选择所需的源大小。

有关更多信息，请参阅[http://developers.facebook.com/docs/reference/api/photo/](http://developers.facebook.com/docs/reference/api/photo/)

例如在 PHP SDK

```
$a_photo = $facebook->api('/427100966728');

<img src=<?php echo $a_photo['picture'] ?> /> 
```

# ruby-on-rails-3 - Heroku 应用程序错误

> ID：10707782
> 
> 赞同：0
> 
> 时间：2012-05-22T18:20:55.583
> 
> 标签：ruby-on-rails-3, postgresql, heroku, sqlite, pg

应用程序错误 应用程序发生错误，无法提供您的页面。请稍后重试。

如果您是应用程序所有者，请查看您的日志以获取详细信息。

```
$ heroku logs

2012-05-22T17:59:46+00:00 app[web.1]: => Call with -d to detach
2012-05-22T17:59:46+00:00 app[web.1]: Exiting
2012-05-22T17:59:46+00:00 app[web.1]: /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.1/lib/active_support/dependencies.rb:251:in `require': /app/app/controllers/comments_controller.rb:15: syntax error, unexpected $end, expecting keyword_end (SyntaxError)
2012-05-22T17:59:46+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.1/lib/active_support/dependencies.rb:251:in `block in require'
2012-05-22T17:59:46+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.1/lib/active_support/dependencies.rb:236:in `load_dependency'
2012-05-22T17:59:46+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.1/lib/active_support/dependencies.rb:251:in `require'
2012-05-22T17:59:46+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.1/lib/active_support/dependencies.rb:359:in `require_or_load'
2012-05-22T17:59:46+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.1/lib/active_support/dependencies.rb:313:in `depend_on'
2012-05-22T17:59:46+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.1/lib/active_support/dependencies.rb:225:in `require_dependency'
2012-05-22T17:59:46+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.1/lib/rails/engine.rb:439:in `block (2 levels) in eager_load!'
2012-05-22T17:59:46+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.1/lib/rails/engine.rb:438:in `each'
2012-05-22T17:59:46+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.1/lib/rails/engine.rb:438:in `block in eager_load!'
2012-05-22T17:59:46+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.1/lib/rails/engine.rb:436:in `each'
2012-05-22T17:59:46+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.1/lib/rails/engine.rb:436:in `eager_load!'
2012-05-22T17:59:46+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.1/lib/rails/application/finisher.rb:53:in `block in <module:Finisher>'
2012-05-22T17:59:46+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.1/lib/rails/initializable.rb:30:in `instance_exec'
2012-05-22T17:59:46+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.1/lib/rails/initializable.rb:30:in `run'
2012-05-22T17:59:46+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.1/lib/rails/initializable.rb:55:in `block in run_initializers'
2012-05-22T17:59:46+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.1/lib/rails/initializable.rb:54:in `each'
2012-05-22T17:59:46+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.1/lib/rails/initializable.rb:54:in `run_initializers'
2012-05-22T17:59:46+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.1/lib/rails/application.rb:136:in `initialize!'
2012-05-22T17:59:46+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.1/lib/rails/railtie/configurable.rb:30:in `method_missing'
2012-05-22T17:59:46+00:00 app[web.1]:   from /app/config/environment.rb:5:in `<top (required)>'
2012-05-22T17:59:46+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.1/lib/active_support/dependencies.rb:251:in `require'
2012-05-22T17:59:46+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.1/lib/active_support/dependencies.rb:251:in `block in require'
2012-05-22T17:59:46+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.1/lib/active_support/dependencies.rb:236:in `load_dependency'
2012-05-22T17:59:46+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/builder.rb:51:in `initialize'
2012-05-22T17:59:46+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.1/lib/active_support/dependencies.rb:251:in `require'
2012-05-22T17:59:46+00:00 app[web.1]:   from /app/config.ru:4:in `block in <main>'
2012-05-22T17:59:46+00:00 app[web.1]:   from /app/config.ru:1:in `<main>'
2012-05-22T17:59:46+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/builder.rb:51:in `instance_eval'
2012-05-22T17:59:46+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.1/lib/rails/commands/server.rb:46:in `app'
2012-05-22T17:59:46+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/server.rb:200:in `app'
2012-05-22T17:59:46+00:00 app[web.1]:   from /app/config.ru:1:in `new'
2012-05-22T17:59:46+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/server.rb:252:in `start'
2012-05-22T17:59:46+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/builder.rb:40:in `eval'
2012-05-22T17:59:46+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/builder.rb:40:in `parse_file'
2012-05-22T17:59:46+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/server.rb:301:in `wrapped_app'
2012-05-22T17:59:46+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.1/lib/rails/commands.rb:55:in `block in <top (required)>'
2012-05-22T17:59:46+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.1/lib/rails/commands/server.rb:70:in `start'
2012-05-22T17:59:46+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.1/lib/rails/commands.rb:50:in `tap'
2012-05-22T17:59:46+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.1/lib/rails/commands.rb:50:in `<top (required)>'
2012-05-22T17:59:46+00:00 app[web.1]:   from script/rails:6:in `require'
2012-05-22T17:59:46+00:00 app[web.1]:   from script/rails:6:in `<main>'
2012-05-22T17:59:47+00:00 heroku[web.1]: Process exited with status 

2012-05-22T17:59:47+00:00 heroku[web.1]: State changed from starting to crashed
2012-05-22T18:11:00+00:00 heroku[web.1]: State changed from crashed to created
2012-05-22T18:11:00+00:00 heroku[web.1]: State changed from created to starting
2012-05-22T18:11:03+00:00 heroku[web.1]: Starting process with command `bundle exec rails server -p 47802`
2012-05-22T18:11:07+00:00 app[web.1]: DEPRECATION WARNING: You have Rails 2.3-style plugins in vendor/plugins! Support for these plugins will be removed in Rails 4.0\. Move them out and bundle them in your Gemfile, or fold them in to your app as lib/myplugin/* and config/initializers/myplugin.rb. See the release notes for more on this: http://weblog.rubyonrails.org/2012/01/04/rails-3-2-0-rc2-has-been-released. (called from <top (required)> at /app/config/environment.rb:5)
2012-05-22T18:11:07+00:00 app[web.1]: DEPRECATION WARNING: You have Rails 2.3-style plugins in vendor/plugins! Support for these plugins will be removed in Rails 4.0\. Move them out and bundle them in your Gemfile, or fold them in to your app as lib/myplugin/* and config/initializers/myplugin.rb. See the release notes for more on this: http://weblog.rubyonrails.org/2012/01/04/rails-3-2-0-rc2-has-been-released. (called from <top (required)> at /app/config/environment.rb:5)
2012-05-22T18:11:11+00:00 app[web.1]: => Booting WEBrick
2012-05-22T18:11:11+00:00 app[web.1]: => Rails 3.2.1 application starting in production on http://0.0.0.0:47802
2012-05-22T18:11:11+00:00 app[web.1]: => Call with -d to detach
2012-05-22T18:11:11+00:00 app[web.1]: => Ctrl-C to shutdown server
2012-05-22T18:11:11+00:00 app[web.1]: Exiting
2012-05-22T18:11:11+00:00 app[web.1]: /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.1/lib/active_support/dependencies.rb:251:in `require': /app/app/controllers/comments_controller.rb:15: syntax error, unexpected $end, expecting keyword_end (SyntaxError)
2012-05-22T18:11:11+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.1/lib/active_support/dependencies.rb:251:in `block in require'
2012-05-22T18:11:11+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.1/lib/active_support/dependencies.rb:236:in `load_dependency'
2012-05-22T18:11:11+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.1/lib/active_support/dependencies.rb:251:in `require'
2012-05-22T18:11:11+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.1/lib/active_support/dependencies.rb:359:in `require_or_load'
2012-05-22T18:11:11+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.1/lib/active_support/dependencies.rb:313:in `depend_on'
2012-05-22T18:11:11+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.1/lib/active_support/dependencies.rb:225:in `require_dependency'
2012-05-22T18:11:11+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.1/lib/rails/engine.rb:439:in `block (2 levels) in eager_load!'
2012-05-22T18:11:11+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.1/lib/rails/engine.rb:438:in `each'
2012-05-22T18:11:11+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.1/lib/rails/engine.rb:438:in `block in eager_load!'
2012-05-22T18:11:11+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.1/lib/rails/engine.rb:436:in `each'
2012-05-22T18:11:11+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.1/lib/rails/engine.rb:436:in `eager_load!'
2012-05-22T18:11:11+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.1/lib/rails/application/finisher.rb:53:in `block in <module:Finisher>'
2012-05-22T18:11:11+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.1/lib/rails/initializable.rb:30:in `instance_exec'
2012-05-22T18:11:11+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.1/lib/rails/initializable.rb:30:in `run'
2012-05-22T18:11:11+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.1/lib/rails/initializable.rb:55:in `block in run_initializers'
2012-05-22T18:11:11+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.1/lib/rails/initializable.rb:54:in `each'
2012-05-22T18:11:11+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.1/lib/rails/initializable.rb:54:in `run_initializers'
2012-05-22T18:11:11+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.1/lib/rails/application.rb:136:in `initialize!'
2012-05-22T18:11:11+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.1/lib/rails/railtie/configurable.rb:30:in `method_missing'
2012-05-22T18:11:11+00:00 app[web.1]:   from /app/config/environment.rb:5:in `<top (required)>'
2012-05-22T18:11:11+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.1/lib/active_support/dependencies.rb:251:in `require'
2012-05-22T18:11:11+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.1/lib/active_support/dependencies.rb:251:in `block in require'
2012-05-22T18:11:11+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.1/lib/active_support/dependencies.rb:236:in `load_dependency'
2012-05-22T18:11:11+00:00 app[web.1]:   from /app/config.ru:4:in `block in <main>'
2012-05-22T18:11:11+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.1/lib/active_support/dependencies.rb:251:in `require'
2012-05-22T18:11:11+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/builder.rb:51:in `instance_eval'
2012-05-22T18:11:11+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/builder.rb:51:in `initialize'
2012-05-22T18:11:11+00:00 app[web.1]:   from /app/config.ru:1:in `new'
2012-05-22T18:11:11+00:00 app[web.1]:   from /app/config.ru:1:in `<main>'
2012-05-22T18:11:11+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/builder.rb:40:in `eval'
2012-05-22T18:11:11+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/builder.rb:40:in `parse_file'
2012-05-22T18:11:11+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/server.rb:200:in `app'
2012-05-22T18:11:11+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.1/lib/rails/commands/server.rb:46:in `app'
2012-05-22T18:11:11+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/server.rb:301:in `wrapped_app'
2012-05-22T18:11:11+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/server.rb:252:in `start'
2012-05-22T18:11:11+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.1/lib/rails/commands/server.rb:70:in `start'
2012-05-22T18:11:11+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.1/lib/rails/commands.rb:55:in `block in <top (required)>'
2012-05-22T18:11:11+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.1/lib/rails/commands.rb:50:in `tap'
2012-05-22T18:11:11+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.1/lib/rails/commands.rb:50:in `<top (required)>'
2012-05-22T18:11:11+00:00 app[web.1]:   from script/rails:6:in `require'
2012-05-22T18:11:11+00:00 app[web.1]:   from script/rails:6:in `<main>'
2012-05-22T18:11:13+00:00 heroku[web.1]: Process exited with status 1
2012-05-22T18:11:13+00:00 heroku[web.1]: State changed from starting to crashed 
```

根据我所阅读的内容： Heroku[中的应用程序错误](https://stackoverflow.com/questions/10023132/application-error-in-heroku) [Heroku Rails](https://stackoverflow.com/questions/8883956/rails-heroku-application-error)[上的应用程序错误 Heroku 应用程序错误](https://stackoverflow.com/questions/10329426/application-error-on-heroku)

除了一些关于 pg gem 和 postgres 的模糊建议外，这个问题没有解决方案。

我的 gemfile 和 sqlite3 中只有 pg 用于开发：

```
source 'https://rubygems.org'

gem 'rails', '3.2.1'
gem 'bootstrap-sass', '2.0.0'
gem 'bcrypt-ruby', '3.0.1'
gem 'faker', '1.0.1'
gem 'will_paginate', '3.0.3'
gem 'bootstrap-will_paginate', '0.0.5'

group :production do
gem 'pg', '0.12.2'
end

group :development, :test do
  gem 'sqlite3', '1.3.5'
gem 'taps'
  gem 'annotate', '~> 2.4.1.beta'
end

# Gems used only for assets and not required
# in production environments by default.
group :assets do
  gem 'sass-rails',   '3.2.4'
  gem 'coffee-rails', '3.2.2'
  gem 'uglifier', '1.2.3'
end

gem 'jquery-rails', '2.0.0'

group :test, :development do
  gem 'rspec-rails', '~> 2.8.rc'
  gem 'guard-rspec', '0.5.5'
  gem 'guard-spork', '0.3.2'
  gem 'spork', '0.9.0'
end

group :test do
  gem 'capybara', '1.1.2'
  gem 'factory_girl_rails', '1.4.0'
  gem 'cucumber-rails', '1.2.1'
  gem 'database_cleaner', '0.7.0'
end

#Nifty Scaffold

gem 'nifty-generators', :group => :development

# Location - Geocoder

gem 'geocoder'

gem "mocha", :group => :test 
```

尽管如此，应用程序仍然崩溃（根据日志）并在呈现站点时给出应用程序错误。在本地服务器上一切正常，所以这绝对是一个部署问题。有谁知道出了什么问题？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T18:22:19.450

```
/app/app/controllers/comments_controller.rb:15: syntax error, unexpected $end, expecting keyword_end (SyntaxError) 
```

有你的错误。重新阅读您的评论控制器，文件中有明显的语法错误。

# html - HTML 5 和 GPGPU

> ID：10707783
> 
> 赞同：3
> 
> 时间：2012-05-22T18:20:57.077
> 
> 标签：html, canvas, html5-canvas, gpu, gpgpu

正如我们所知，许多 HTML 5 渲染器使用 GPU 来绘制画布元素。我想知道使用此功能触发 GPU 将其用于 GPGPU。canvas API 或 HTML 5 中可能没有原生的 GPGPU 函数，但是如何破解呢？

我正在考虑使用纹理（2D 或 3D 数组）之类的东西来处理要处理的值，然后让画布元素对这个矩阵执行一些操作。这个操作必须是一个我可以以某种方式发送到画布元素的函数。然后我们有基于浏览器的 GPGPU。

这样的事情可能吗？你怎么看？您对如何实现这一点还有其他想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T06:14:58.903

[WebCL](http://www.khronos.org/webcl/)标准的创建正是为了让在浏览器中运行的 Javascripts 能够访问 GPGPU 的计算能力（前提是客户端有）。但是[，现有实现的列表](https://www.khronos.org/webcl/wiki/Main_Page)非常短。

[早在 CUDA、OpenCL 和类似的 GPGPU 框架出现之前](http://igoro.com/archive/how-gpu-came-to-be-used-for-general-computation/)（并导致）成功尝试利用 GPU 能力进行通用计算。[这](http://www.mathematik.uni-dortmund.de/~goeddeke/gpgpu/tutorial.html)是一个看起来不错的教程，我猜它可以移植到 WebGL（它比 WebCL 有更广泛的支持）。有关 WebGL 本身的优秀介绍性文章，请参阅[@MikkoOhtamaa 的回答](https://stackoverflow.com/a/10711412/929437)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T23:14:23.703

您可能希望将 webGL 着色器用于您的邪恶目的。

[http://www.html5rocks.com/en/tutorials/webgl/shaders/](http://www.html5rocks.com/en/tutorials/webgl/shaders/)

着色器为并行计算提供了有限的机会。

# css - 想要导航菜单在初始页面上的背景图像上，但它在各种显示器上移动

> ID：10707787
> 
> 赞同：0
> 
> 时间：2012-05-22T18:21:22.210
> 
> 标签：css, image, background, position, nav

我很确定这是一个简单的解决方法，而且我经验丰富，无法弄清楚。我正在使用 WP 构建一个站点，但主页只是一个带有垂直导航菜单的背景图像。我现在不知道如何让所有浏览器和窗口的菜单保持在同一个位置。它在我的屏幕上看起来不错，然后我发现导航窗格在我丈夫的显示器上完全不同的位置。我相信这与位置、显示和边距有关，但是当我阅读这些内容时，我越来越迷茫，我只想有人告诉我代码。

该页面位于[www.sydneyjanebaily.com](http://www.sydneyjanebaily.com)

至此整个页面的代码如下：

> 身体{背景图片：网址（http://www.sydneyjanebaily.com/wp-content/themes/twentyeleven/images/open-book.png）；背景重复：不重复；背景附件：固定；背景位置：中心；
> 
> } 菜单 { 显示：块；}
> 
> # 访问 div { 显示：块；左边距：890px；边距右：自动；边距顶部：200px；宽度：235px；}
> 
> / ***** ** *** ** *** ** *** ** *****导航***** ** *** ** *** ** ***** / nav#access ul, nav#access li.pagenav { display: block; 列表样式：无；}
> 
> nav#access ul li a span, nav#access ul li.page_item a span { position: absolute; 正确：100%；顶部：2px；宽度：15px；高度：100%；背景图像：url（../images/nav-shadow.png）；背景位置：右上；背景重复：重复-y；}
> 
> nav#access ul li a, nav#access ul li a:visited, nav#access ul li.page_item a, nav#access ul li.page_item a:visited { display: block; 填充：8px 10px 8px 30px；白颜色; 字体：150% “EBGaramondSC”、“Palatino”、“Palatino Linotype”、“Book Antiqua”、Georgia、serif；文字装饰：无；/*背景颜色：
> 
> # aba000; */ 边距：5px 0 7px 0; 位置：相对；宽度：235px；/ *font-variant：小型大写字母；*/ }
> 
> nav#access ul li a:hover, nav#access ul li a:focus, nav#access ul li.page_item a:hover, nav#access ul li.page_item a:focus{ 颜色：
> 
> # FF0000; }
> 
> nav#access li a:hover span { background-color: #666; } nav#access ul li a em { font-size: 87.50%; } nav#access ul li:nth-child(5n-4) a, nav#access ul li:nth-child(5n-4) a span { ; } nav#access ul li:nth-child(5n-3) a, nav#access ul li:nth-child(5n-3) a span { ; } nav#access ul li:nth-child(5n-2) a, nav#access ul li:nth-child(5n-2) a span { ; } nav#access ul li:nth-child(5n-1) a, nav#access ul li:nth-child(5n-1) a span { ; } nav#access ul li:nth-child(5n-5) a, nav#access ul li:nth-child(5n-5) 跨度 {; } -->
> 
> nav#access ul li ul li span { 位置：绝对；正确：100%；顶部：0；宽度：20px；高度：100%；左：2px；右边距：15px；溢出：可见；} nav#access ul li ul li:nth-child(odd) a { 背景：无；颜色：#EEE8AA；字体大小：较小；边距：3px 20px 5px 20px；最小高度：20px；宽度：210px；填充：2px 0 2px 20px；} nav#access ul li ul li:nth-child(odd) a:hover, nav#access ul li ul li:nth-child(odd) a:focus { 背景: none; 颜色：#ADFF2F；字体大小：较小；左：15px；填充：2px 30px 2px 25px；} nav#access ul li ul li:nth-child(odd) a span { background: url(../images/sub-menu2.png) -5px 0px no-repeat; 宽度：30px；}
> 
> nav#access ul li ul li:nth-child(even) a { 背景：无；颜色：
> 
> # 3B3C1D; 字体大小：较小；边距：3px 20px 5px 20px；最小高度：20px；宽度：210px；填充：2px 0 2px 20px；} nav#access ul li ul
> 
> li:nth-child(even) a:hover, nav#access ul li ul li:nth-child(even) a:focus { 背景: none; 颜色：#FF4500；字体大小：较小；左：15px；填充：2px 30px 2px 25px；} nav#access ul li ul li:nth-child(even) a span { background: url(../images/sub-menu2.png) -5px 0px no-repeat; 宽度：30px；}
> 
> nav#access ul li ul li ul li:nth-child(odd) a { 背景：无；颜色：#FFD700；字体大小：较小；边距：3px 20px 5px 30px；最小高度：20px；宽度：200px；填充：2px 0 2px 20px；} nav#access ul li ul li ul li:nth-child(odd) a:hover, nav#access ul li ul li ul li:nth-child(odd) a:focus { background: none; 颜色：#EEE8AA；字体大小：较小；左：25px；填充：2px 30px 2px 25px；} nav#access ul li ul li ul li:nth-child(odd) a span { background: url(../images/sub-menu.png) -10px 0px no-repeat; 宽度：30px；}
> 
> nav#access ul li ul li ul li:nth-child(even) a { 背景：无；颜色：#3B3C1D；字体大小：较小；边距：3px 20px 5px 30px；最小高度：20px；宽度：200px；填充：2px 0 2px 20px；} nav#access ul li ul li ul li:nth-child(even) a:hover, nav#access ul li ul li ul li:nth-child(even) a:focus { 背景：无；颜色：#7FFFD4；字体大小：较小；左：25px；填充：2px 30px 2px 25px；} nav#access ul li ul li ul li:nth-child(even) a span { background: url(../images/sub-menu.png) -10px 0px no-repeat; 宽度：30px；}
> 
> nav#access ul li a:hover:active, nav#access ul li ul li a:hover:active, nav#access ul li ul li ul li a:hover:active, nav#access ul li a:focus:active, nav#access ul li ul li a:focus:active, nav#access ul li ul li ul li a:focus:active { 颜色：
> 
> # 00CCFF; 左：1px；顶部：1px;}
> 
> /* 单一导航 */
> 
> # 导航单{浮动：对；位置：相对；顶部：-0.3em；文本对齐：右；z-index：1；}
> 
> # nav-single .nav-previous,
> 
> # 导航单 .nav-next { 浮动：无；宽度：自动；}
> 
> # nav-single .nav-next { padding-left: .5em; }
> 
> ```
>  img.book {  
>         /* Set rules to fill background */  
>         min-height: 100%;  
>         min-width: 1000px;  
> 
>         /* Set up proportionate scaling */  
> 
>         height: auto;  
> 
>         /* Set up positioning */  
> 
>         top: 0;  
>         left: 0;  
> 
>       display: block;   
>       margin-left: auto;  
>       margin-right: auto; 
>       text-align: center;
>     } 
> 
>     </style>  
> 
>   <!-- <img class="book"src="<?php bloginfo('template_directory');?>/images/open-book.png" alt="xxx" 
> ```
> 
> width="880" height="xxx" /> -->
> 
> ```
>  <?php /*  Allow screen readers / text browsers to skip the navigation menu and get right to the good stuff. */ ?>
>           <!-- <div class="skip-link"><a class="assistive-text" href="#content" title="<?php esc_attr_e( 'Skip to primary content', 
> ```
> 
> '二十一'）；?>"> "> --> '主要' ) ); ?>

我很困惑，当我使用 Firefox 开发人员工具检查一个元素时，它仍然会为我标记为块的内容显示内联元素。

基本上，我可以使用 px 将导航窗格放在我想要的位置，但它只在我的屏幕上看起来正确。我想我需要百分比，但这超出了我的范围。请帮忙。

谢谢，悉尼

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T18:38:05.340

尝试替换这个：

```
#access div {
    display: block;
    margin-left:890px;
    margin-right:auto;
    margin-top:200px;
    width: 235px;  
    } 
```

有了这个：

```
#access div {
   position: absolute;
   top: 20%;
   left: 50%;
} 
```

无论我如何挤压或拉伸屏幕，它在我的显示器上都能正常工作，它也应该对你有用。祝你好运！

# cuda - 什么会导致这个 cuda 堆栈跟踪以及这个对 cudaMemcpy 的调用有什么问题？

> ID：10707788
> 
> 赞同：0
> 
> 时间：2012-05-22T18:21:24.237
> 
> 标签：cuda

我的程序绘制了一个小动画，使用了 glut 和 cuda，并且是用 C++ 编写的，它在一段时间后挂起，当我在它挂起几秒钟后中断它时，我在调试器中看到以下跟踪：

```
Program received signal SIGINT, Interrupt.
0x000000011302a84c in cuGraphicsGLRegisterBuffer ()
(gdb) bt
#0  0x000000011302a84c in cuGraphicsGLRegisterBuffer ()
#1  0x000000011306bc36 in cuGraphicsGLRegisterBuffer ()
#2  0x0000000113039455 in cuGraphicsGLRegisterBuffer ()
#3  0x0000000113006864 in cuGraphicsGLRegisterBuffer ()
#4  0x000000011303cbe6 in cuGraphicsGLRegisterBuffer ()
#5  0x000000011303d972 in cuGraphicsGLRegisterBuffer ()
#6  0x0000000113028bc6 in cuGraphicsGLRegisterBuffer ()
#7  0x000000011302a090 in cuGraphicsGLRegisterBuffer ()
#8  0x000000011301fcb2 in cuGraphicsGLRegisterBuffer ()
#9  0x0000000112ffcead in cuGraphicsGLRegisterBuffer ()
#10 0x0000000113001718 in cuGraphicsGLRegisterBuffer ()
#11 0x0000000112ff27cf in cuMemcpyDtoH_v2 ()
#12 0x00000001001d70c4 in cudaGetExportTable ()
#13 0x00000001002098a5 in cudaMemcpy () 
```

（这是堆栈跟踪的顶部；其余的是我自己的函数，其中一个调用 cudaMemcpy。）

如果我在挂起后立即尝试中断，则跟踪如下所示：

```
#0  0x00007fffffe0026d in __spin_lock ()
#1  0x00007fff880f855b in pthread_mutex_unlock ()
#2  0x000000011303ad89 in cuGraphicsGLRegisterBuffer ()
#3  0x000000011303b972 in cuGraphicsGLRegisterBuffer ()
#4  0x0000000113026bc6 in cuGraphicsGLRegisterBuffer ()
#5  0x0000000113028090 in cuGraphicsGLRegisterBuffer ()
#6  0x000000011301dcb2 in cuGraphicsGLRegisterBuffer ()
#7  0x0000000112ffaead in cuGraphicsGLRegisterBuffer ()
#8  0x0000000112fff718 in cuGraphicsGLRegisterBuffer ()
#9  0x0000000112ff07cf in cuMemcpyDtoH_v2 ()
#10 0x00000001001d70c4 in cudaGetExportTable ()
#11 0x00000001002098a5 in cudaMemcpy () 
```

我不知道如何处理这个问题。`cudaPeekAtLastError`在调用`cudaMemcpy`. 我也知道我可以运行包含在 nvidia 的 SDK 中的程序。此外，程序在挂起之前运行了几秒钟，这意味着挂起之前的所有调用都会执行而不会产生错误，因此我的调用方式或指针分配不正确`cudaMemcpy`似乎没有任何问题（如果它们`cudaMemcpy`是，我希望 cuda 只会产生错误，而不是挂起）。

该卡是 GeForce 9400M，Cuda 驱动程序/运行时 4.2，Cuda 功能 1.1。

有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T19:41:16.653

我猜您遇到了指针问题，例如尝试复制超出缓冲区的末尾（源或目标），或者完全引用了错误的指针。一旦你开始踩到无效内存，不要指望任何理智的错误报告或有用的回溯。

查看您的回溯，可能会调用 GLRegister 调用，因为您无意中尝试从映射到 OpenGL 的设备内存空间进行复制。

尝试 cuda-memcheck 和/或 valgrind。或者，因为很容易重现，所以首先验证（通过调试器或通过 printf）您传递给 memcpy 的值。或者，通过禁用部分代码来手动开始二进制搜索，直到一切恢复正常。

# wcf - 无法使用 https url 匿名访问 wcf wsdl

> ID：10707790
> 
> 赞同：0
> 
> 时间：2012-05-22T18:21:33.780
> 
> 标签：wcf, https, wsdl, anonymous

我想做的是使用 https url 匿名访问 wcf 服务。

我在 .net 4.0 中创建了一个 WCF。在设置为使用 HTTPS 的服务器上部署 wcf。服务器的 IIS 设置为允许匿名调用。我可以访问 WCF 的 Service.svc 的网站 url，Service.svc 页面没有出现任何问题。当我单击 Service.svc 上的 wsdl url 链接时，我返回 HTTP 404 错误或 HTTP 401 错误。wcf 的 wsdl 虚拟目录（我猜）不允许我访问 wsdl 文件。

我已将 serviceMetadata 的属性 httpsGetEnabled 设置为 true。wsHttpBinding 的传输安全性和 clientCredentialType 设置为 none。basicHttpBinding 的传输安全性和 clientCredentialType 设置为 none。

绝对确定，我需要创建证书吗？因为当我在另一个项目中使用 VS2010 并将 WCF 作为服务引用添加时，会出现一个弹出的证书对话框，我单击“确定”并继续前进。但是当项目无法抓住 wsdl 苍蝇时，它就会停止。

如何访问 service.svc 的 wsdl？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T21:21:19.957

如果您浏览到已部署的服务端点，您将看到一个屏幕，其中包含生成 WSDL 的链接。您确实需要 SSL 证书——只需创建一个自签名证书（这很容易）。不要忘记在 IIS 中为您的站点设置 https 绑定。

# mysql - Sql 查询在 Mysql 5.5.16 版本中不起作用

> ID：10707792
> 
> 赞同：2
> 
> 时间：2012-05-22T18:21:41.807
> 
> 标签：mysql

我正在尝试执行以下查询：

```
$query = "SELECT O. * AS NUM FROM (ab_order O)
    LEFT JOIN ab_user U ON (O.id_user=U.id)
    WHERE O.id IN ( SELECT OT.id_ab_order FROM ab_order_transaction OT
        LEFT JOIN ab_transaction T ON (OT.id_ab_transaction = T.id)
    LEFT JOIN ab_user U ON (T.id_user = U.id) 
    WHERE T.validated = 1 {$condTrans} ) {$condOrder}
    ORDER BY {$orderCol} LIMIT $from, $numRecords ";
$queryDB = $DB->queryExec($query); 
```

在实时服务器上：

*   它适用于 MySql 版本 3.3.10。
*   PHP 版本 5.2.17。

但我需要使用本地主机：

*   XAMPP for linux, v. 1.7.7
*   PHP 5.3.8
*   MySql 版本 5.5.16。

在本地主机上它说：

```
MySQL error: 1064 : You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'AS NUM
FROM (ab_order O)
LEFT JOIN ab_u' at line 1. 
```

有没有更简单的方法然后升级实时服务器 Mysql 数据库？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T18:27:18.907

所有列的别名似乎不正确： `SELECT O. * AS NUM`. 我不确定为什么它会在以前的版本上工作，但是`as num`应该删除，或者每列都应该显式别名。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T18:33:57.857

您可以在 SELECT 中为单个列定义别名。这是问题

```
SELECT O. * AS NUM 
```

而不是这种用途

```
SELECT O. * 
```

这是有用的文章[在 SELECT 语句中使用列别名](http://www.geeksengine.com/database/basic-select/column-alias.php)

# xpath - Groovy GPath 编译器中是否有 XPath？

> ID：10707793
> 
> 赞同：2
> 
> 时间：2012-05-22T18:21:43.460
> 
> 标签：xpath, groovy, gpath

我们有很多遗留的 XPath 表达式，并且正在考虑将代码迁移到 Groovy + XmlSlurper + GPath。

我认为如果有一个工具（或 API）采用现有的 XPath 并生成/执行相应的 GPath，任务会更顺利。即类似的东西：

```
def resp = new XmlSlurper().parseText(responseAsXml)
def gpath = GPathSomething.compile("//foo/bar[id='123']")
def result = gpath.execute(resp)
def result2 = gpath.'**'.grep( it.@bar = 'baz' ) 
```

PS 当然，同样可以通过直接应用 XPath API 来实现，但感觉还是坚持原生方式（GPath）更合适。

PPS 另一方面，GPath 可能不是一个好的选择？任何意见将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-17T18:12:26.233

未找到即用型产品。决定使用 XPath，并从 Groovy 调用 Java XPath API (Saxon)。效果很好。

# c++ - ttl::variant，放置新

> ID：10707801
> 
> 赞同：0
> 
> 时间：2012-05-22T18:22:03.100
> 
> 标签：c++

我正在使用["Tiny Template Library"](http://tinytl.sourceforge.net/)中的变体类型。变体定义为：

```
template< TTL_TPARAMS_DEF(TTL_MAX_TYPELIST_PARAMS, empty_type) >
struct variant
{
    typedef variant this_t;
    typedef meta::typelist< TTL_ARGS(TTL_MAX_TYPELIST_PARAMS) > list;
    ...

    template< typename T >
    variant( const T& r ) : which_(0), pnt_(0)
    {
        typedef meta::find_equivalent_type<const T&, list> found;
        pnt_ = new(stor_.buf_) ttl::data_holder<typename found::type>(r);
        which_ = found::index;
    }
    ...
private:
    template<int N> 
    struct storage
    {
        union
        {
            ttl::data_holder_base dummy;  //hope to satisfy alignment settings
            char buf_[N];
        };
    };

    int which_;
    ttl::data_holder_base* pnt_;
    storage< sizeof(ttl::data_holder<typename list::largest_type>) > stor_;
    ....
};

struct data_holder_base {};

template< typename T >
struct data_holder : data_holder_base
{
    ...
    typedef const T& param_type;

    T d;
    ...
    data_holder( param_type d_ ) : d(d_) {}
    ...
}; 
```

当我通过网络发送这种类型的对象并使用“memcpy”“重建”它时，很明显指针“pnt_”将指向 Nirvana。由于我知道存储的类型，我尝试使用强制转换重建指针“pnt_”：

```
template<typename T>
inline void rebuild()
{
    pnt_ = reinterpret_cast<ttl::data_holder<T>*>(stor_.buf_); 
} 
```

对于我检查了这个例子的情况，它可以工作。但我不知道放置 new( `pnt_ = new(stor_.buf_) ...`) 是如何将对象放入`stor_.buf_`. 是否需要存储诸如`std::distance(&stor_.buf_[0], pnt_)`查找对象之类的内容？

或者有什么不同的方法可以`pnt_`返回？

谢谢马里奥

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T18:54:12.617

Placement `new` puts the new object in `stor_.buf_` because that's how placement `new` is defined to work. You give `new` the address of the memory you want it to use, and it constructs the object in that location. It returns the very same address, so the address stored in `pnt_` is that of `stor_.buf_`, but with the type of the constructed object, `ttl::data_holder<found::type>`, instead of `char*`. Since the addresses are the same, the `std::distance` value you mention would always be zero (assuming the call would even compile, which it won't because the argument types are different).

The address of `stor_.buf_` will also always be equal to that of `stor_.dummy`. You could make your added code simpler by assigning `pnt_` like this:

```
pnt_ = &stor_.dummy; 
```

However, since you've apparently just copied raw memory over the socket, fixing up the internals of this `variant` object is only the tip of the iceberg. The value that your variant holds might *also* contain addresses, and you have no way of reaching inside that. Even if you do, the address you need might not be available. You were lucky with `variant` that the address you're fixing happens to be an address within the same object, so it's easy to compute. But consider `std::string`, which allocates memory from the free store; sending one over a socket won't give you anything usable on the other end — it might not even give you the character data at all. You should instead pursue some other technique for serializing and deserializing `ttl::variant` objects. You could post a question on Stack Overflow asking how to do it.

# html - 网页上的 Facebook 评论插件不起作用

> ID：10707808
> 
> 赞同：0
> 
> 时间：2012-05-22T18:22:15.703
> 
> 标签：html, facebook

使用 Facebook 评论插件的网页上有评论，但我看不到它们。但是，我可以在 Facebook 登录后发表自己的评论。

该页面有某种关于启用`href`?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T18:30:35.737

`href`是指向您的评论所在的 URL 链接以及您的用户评论的内容。您需要这个插件才能为其他用户工作。

如[文档](http://developers.facebook.com/docs/reference/plugins/comments/)中所述，

> Facebook 上的新闻提要故事将链接到此 URL。

替换`YOURURLHERE`为您拥有评论插件的 URL。

`<div class="fb-comments" data-href="YOURURLHERE" data-num-posts="2" data-width="470"></div>`

# python - 在 Python 中加载 CouchDB 设计文档的推荐方法？

> ID：10707814
> 
> 赞同：6
> 
> 时间：2012-05-22T18:22:24.930
> 
> 标签：python, couchdb

我对沙发很陌生，但我正在尝试在一个新的 Python 项目中使用它，我也想使用 python 来编写设计文档（视图）。我已经将 Couch 配置为使用 couchpy 视图服务器，我可以通过在 Futon 中输入一些简单的 map/reduce 函数来确认它是否有效。

*在使用 Python 的 couchdb 模块时，是否有关于如何加载/同步设计文档的官方建议？*

我知道我可以发布设计文档以将它们“安装”到 Couch 中，但我的问题实际上是关于最佳实践。我需要某种部署策略，无论是在开发环境中还是在生产环境中。我的直觉是创建一个目录并将我所有的设计文档存储在那里，然后编写某种同步脚本，将每个脚本上传到沙发上（可能只是盲目地覆盖已经存在的内容）。*这是一个好主意吗？*

[“用 Python 编写视图](http://packages.python.org/CouchDB/views.html)”的文档是 5 句话，实际上只是解释了如何安装 couchpy。在该[项目的谷歌代码站点上](http://code.google.com/p/couchdb-python/)，提到了一个 couchdb.design 模块，听起来可能会有所帮助，但没有文档（我可以找到）。该模块的源代码表明它完成了我感兴趣的大部分工作，但实际上没有加载文件。我想我应该做某种模块发现，但我听说那是非 Pythonic。建议？

编辑：

特别是，将我的 map/reduce 函数存储在字符串文字中的想法似乎*完全是 hacky*。我想用真正的单元测试编写真正的python代码，在一个真正的模块中，在一个真正的包中。定期，我想将我的“沙发视图”包与 couchdb 实例同步。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T15:53:15.310

这是一种似乎合理的方法。首先，我继承了 couchdb.design.ViewDefinition。（为简洁起见，删除了评论和 pydocs。）

```
import couchdb.design
import inflection

DESIGN_NAME="version"

class CurrentVersion(couchdb.design.ViewDefinition):
    def __init__(self):

        map_fun = self.__class__.map

        if hasattr(self.__class__, "reduce"):
            reduce_fun = self.__class__.reduce
        else:
            reduce_fun = None

        super_args = (DESIGN_NAME,
                      inflection.underscore(self.__class__.__name__),
                      map_fun,
                      reduce_fun,
                      'python')

        super(CurrentVersion, self).__init__(*super_args)

    @staticmethod
    def map(doc):
        if 'version_key' in doc and 'created_ts' in doc:
            yield (doc['version_key'], [doc['_id'], doc['created_ts']])

    @staticmethod
    def reduce(keys, values, rereduce):
        max_index = 0

        for index, value in enumerate(values):
            if value[1] > values[max_index][1]:
                max_index = index

        return values[max_index] 
```

现在，如果我想同步：

```
import couchdb.design
from couchview.version import CurrentVersion

db = get_couch_db() # omitted for brevity
couchdb.design.ViewDefinition.sync_many(db, [CurrentVersion()], remove_missing=True) 
```

这种方法的好处是：

1.  组织。所有设计/视图都作为位于单个包中的模块/类（分别）存在。
2.  真实代码。我的文本编辑器将突出显示语法。我可以针对我的 map/reduce 函数编写单元测试。

ViewDefinition 子类也可用于查询。

```
current_version_view = couchview.version.CurrentVersion()
result = current_version_view(self.db, key=version_key) 
```

它还没有准备好投入生产，但我认为这与将 map/reduce 函数存储在字符串文字中相比更近了一步。

编辑：我最终写了几篇关于这个主题的博客文章，因为我找不到任何其他的建议来源：

*   [http://markhaase.com/2012/06/23/couchdb-views-in-python/](http://markhaase.com/2012/06/23/couchdb-views-in-python/)
*   [http://markhaase.com/2012/07/01/unit-tests-for-python-couchdb-views/](http://markhaase.com/2012/07/01/unit-tests-for-python-couchdb-views/)

# python - 突出显示 PyGTK TextView 中的某些文本

> ID：10707815
> 
> 赞同：1
> 
> 时间：2012-05-22T18:22:29.963
> 
> 标签：python, pygtk

我有带有文本页面的 TextView，但我希望能够突出显示（更改背景颜色）不同颜色的特定字符串。这可能吗？如果是这样，有人可以指出我正确的方向吗？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T18:40:41.783

我自己还没有尝试过，但是具有正确配置的[TextTag的](http://www.pygtk.org/docs/pygtk/class-gtktextbuffer.html#method-gtktextbuffer--insert-with-tags)[TextBuffer.insert_with_tags](http://www.pygtk.org/docs/pygtk/class-gtktexttag.html)看起来很有希望。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T08:07:26.713

如果特定的字符串总是相同的，就像在编程语言中一样，那么使用`GtkSourceView`。

# security - 在 symfony2 中，当我实际登录时，登录操作显示我已注销

> ID：10707828
> 
> 赞同：1
> 
> 时间：2012-05-22T18:23:39.140
> 
> 标签：security, symfony, login

如果登录用户进入登录操作，我想将他们重定向到另一个页面。但我不知道如何在方法内部检测用户是否登录`loginAction`。登录操作中的安全上下文使我在没有登录时似乎已注销。

作为测试，我在登录网站时请求以下两个页面。为什么我无法在登录操作中访问用户？

这是我的登录操作：

```
public function loginAction()
{
    $token = $this->get('security.context')->getToken();
    print_r(get_class($token));
        // Outputs "Symfony\Component\Security\Core\Authentication\Token\AnonymousToken"
    print_r($token->getUser());
        // Outputs "anon."
} 
```

这是应用程序中的一个通用操作，受登录名保护：

```
public function regularAction()
{
    $token = $this->get('security.context')->getToken();
    print_r(get_class($token));
        // Outputs "Symfony\Component\Security\Core\Authentication\Token\UsernamePasswordToken"
    print_r(get_class($token->getUser()));
        // Outputs "Company\BaseBundle\Entity\User"
} 
```

这是我的`security.yml`：

```
security:
    encoders:
        Company\BaseBundle\Entity\User:
            algorithm:   sha1
            iterations: 1
            encode_as_base64: false
    providers:
        main:
            entity: { class: Company\BaseBundle\Entity\User, property: user_name }
    firewalls:
        login_firewall:
            pattern:    ^/login$
            anonymous:  ~
        main:
            pattern: ^/
            form_login:
                login_path: /login
                check_path: /login_check
                post_only: true
                always_use_default_target_path: false
                default_target_path: /
                use_referer: true
                failure_path: null
                failure_forward: false
                username_parameter: user_name
                password_parameter: password_hash
                csrf_parameter: _csrf_token
                intention: authenticate
            logout:
                path: /logout
                target: /
    acl:
        connection: default 
```

**编辑：我不认为我的其余防火墙是相关的，但在阅读了 ilanco 的回答后，我认为它们可能是**

```
security:
    encoders:
        Company\BaseBundle\Entity\User:
            algorithm:   sha1
            iterations: 1
            encode_as_base64: false

    providers:
        main:
            entity: { class: Company\BaseBundle\Entity\User, property: user_name }

    firewalls:
        dev:
            pattern:  ^/(_(profiler|wdt)|css|images|js)/
            security: false

        login_firewall:
            pattern:    ^/login$
            anonymous:  ~
        password_reset:
            pattern:    ^/passwordreset/*$
            anonymous:  ~
        error_firewall:
            pattern:    ^/error/.*$
            anonymous:  ~
        unsupported_broswers:
            pattern:    ^/unsupported$
            anonymous:  ~
        security_question_firewall:
            pattern:  ^/user/(locked|security_question)/(new)*$
            anonymous:  ~
        api_firewall:
            pattern:  ^/api/.*$
            provider: main
            http_basic:
                realm: "Secured API Area. Login with your regular credentials"
                provider: main
        main:
            pattern: ^/
            form_login:
                login_path: /login
                check_path: /login_check
                post_only: true
                always_use_default_target_path: false
                default_target_path: /
                use_referer: true
                failure_path: null
                failure_forward: false
                username_parameter: user_name
                password_parameter: password_hash
                csrf_parameter: _csrf_token
                intention: authenticate
            logout:
                path: /logout
                target: /
    acl:
        connection: default 
```

按照 ilanco 的建议，我删除了这个：

```
 login_firewall:
        pattern:    ^/login$
        anonymous:  ~ 
```

并将其直接添加到该`providers`部分下：

```
access_control:
    - { path: ^/login$, role: IS_AUTHENTICATED_ANONYMOUSLY } 
```

但是当我访问 /login 时出现重定向循环错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T18:26:21.677

我也一直在努力解决这个问题。

`/login`不是主防火墙的一部分，因此用户无法访问那里。

解决此问题的方法是删除您调用的自定义防火墙`login_firewall`并允许`/login`通过 ACL 访问。

将以下代码添加到您的`security.yml`

```
access_control:
    - { path: ^/login$, role: IS_AUTHENTICATED_ANONYMOUSLY } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T07:47:13.687

设法解决了这个问题 - 重定向循环的问题是由于无法访问 /login 页面引起的。我只做了一个防火墙，设置匿名访问：〜，为非用户定义了access_control，瞧！

```
security:
    firewalls:
        dev:
            pattern:  ^/(_(profiler|wdt)|css|images|js)/
            security: true
            anonymous: ~ 
        secured_area:
            pattern:    ^/
            anonymous:  ~
            form_login:
                login_path:  /login
                check_path:  /login_check
                always_use_default_target_path: true
                default_target_path: /
            logout:
                path:   /logout
                target: /
    providers:
        main:
            entity: { class: Core\UserBundle\Entity\User, property: username }
    encoders:
        Core\UserBundle\Entity\User: 
            algorithm:   sha256
            iterations: 10
            encode_as_base64: true
    access_control:
        - { path: ^/login, roles: IS_AUTHENTICATED_ANONYMOUSLY }
        - { path: ^/admin, roles: ROLE_SUPERADMIN }
        - { path: ^/user, roles: ROLE_USER }
        - { path: ^/, roles: IS_AUTHENTICATED_FULLY } 
```

# c++ - ostringstream 运算符 [] 在尝试读取缓冲区时给出编译错误

> ID：10707833
> 
> 赞同：1
> 
> 时间：2012-05-22T18:24:13.477
> 
> 标签：c++, compilation, buffer, ostringstream

我有一个扩展 ostringstream 类的类。

```
Class A: public ostringstream
{

} 
```

我想从该对象读取指定大小和特定偏移量的数据。所以尝试：

```
A a_;
a_ << data1 << data2;
string datax(a_[offset], size); 
```

但是在字符串 datax 语句中出现编译错误。

```
error: no match for operator[] in ... 
```

如何从对象 a_ 复制指定偏移量和大小的数据？我不想从对象 a_ 中删除数据。

**注意**：该类是由其他人设计的，不能修改。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T18:26:58.837

首先，标准中的任何内容都不能保证派生自`std::ostringstream`会起作用。你最好不要这样做。

其次，没有`operator []`for`std::ostringstream`那么为什么要有一个 for`A`呢？

最后，您可以调用`str()`并`a_`获取`std::string`缓冲区的内容。我不确定这是否会对您有所帮助，您想要做什么并不完全清楚。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T18:27:52.100

我相信使用您拥有的代码可以做到：

```
a_ << data1 << data2;
string datax(&a_.str()[offset], size); 
```

这对我来说有点难看。为什么不直接使用plain`std::stringstream`呢？（除非你有充分的理由继承自`std::ostringstream`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-22T18:31:25.163

您需要调用 str() 方法：

```
ostringstream oss (ostringstream::out);
oss << "abcdef";
string s = oss.str();
cout << s.substr(1, 3) << endl; 
```

此示例将输出“bcd”。

# javascript - Javascript/JQuery 执行顺序

> ID：10707836
> 
> 赞同：0
> 
> 时间：2012-05-22T18:24:21.360
> 
> 标签：javascript, jquery, variables, html

我有一个 div“.gallery”的多个实例，我想在点击时获取 .gallery 的特定实例所在的 div 的 id。然后，这将填充一个变量，我可以使用该变量使图像仅在该 div 的图库中更改。问题是页面似乎尝试进行图像交换，然后更改变量，因此第一次单击时图像不会更改，更糟糕的是，第一次单击不同的图库时它会更改图像您与之互动的最后一个画廊。目前，每次您单击报告您单击的 div 的 div 时，我都会弹出一个 javascript 警报。如果您想使用它，我将页面处于当前状态。[www.ryanscasey.com/redesign](http://www.ryanscasey.com/redesign)

直接的javascript如下：

```
$(document).ready(function() {

    var clickedDiv;

    $('.gallery').click(function() {
        clickedDiv = $(this).parent().parent().attr("id");
        $('#' + clickedDiv + ' .thumbs img').click(function() {
            $('#' + clickedDiv + ' .largeImage').html($(this).attr('alt'));
        });
        alert(clickedDiv);
    });
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T18:29:31.383

我想这就是你想要的。听起来您不需要绑定多个单击事件。按照您的方式，它会在任何时候单击`.gallery`项目时绑定单击事件。如果这不起作用，请告诉我，我们将尝试从那里开始工作。

```
$(document).ready(function() {
    $('.gallery .thumbs img').click(function() {
        var $this = $(this),
            $gallery = $this.closest('.gallery'),
            $large = $gallery.find('.largeImage');

        $large.html($this.attr('alt'));
    });
}); 
```

**编辑：**我查看了您的网站，并调整了我的代码。您想将点击事件绑定到缩略图而不是整个画廊。

# android - Android 应用程序向 Arduino 板发送一个字节

> ID：10707840
> 
> 赞同：2
> 
> 时间：2012-05-22T18:24:41.730
> 
> 标签：android, arduino

我有一个示例 Android 应用程序，我在 Eclipse 中编译并安装在我的 Android 平板电脑上。它在我的平板电脑和我的 Arduino 板之间建立了通信。

这是来自此链接的示例程序：“Seeeduino Demo - Android App”在此 URL 上： [http ://www.seeedstudio.com/wiki/index.php?title=Seeeduino_ADK_Main_Board](http://www.seeedstudio.com/wiki/index.php?title=Seeeduino_ADK_Main_Board)

有一个部分只是将一个字节从我的平板电脑发送到 Arduino 板。

```
byte data;
data=1;
server.send(new byte[] {(byte) data}); 
```

它可以工作，但它会发送除一个字节之外的其他字节。我需要了解这个 server.send() 函数是如何工作的，但我在 Android 参考资料中找不到任何关于它的信息。

谁能给我指出一个涵盖 server.send() 函数的参考资料？我想一次只发送一个字节，而不是别的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T06:23:35.347

我快速浏览了 MicroBridge 的源代码。以下是该`send`方法的工作部分：

```
 public void send(byte[] data) throws IOException
      {
              try {
                      output.write(data);
                      output.flush();
              } catch (SocketException ex)
              {
                      // Broken socket, disconnect
                      close();
                      server.disconnectClient(this);
              }
      } 
```

我会说管道中有数据，并且正在通过调用`output.flush()`.

MicroBridge 的源代码可以在这里找到： [MicroBridge](http://code.google.com/p/microbridge/source/browse/trunk/src/android/ServoControl/src/org/microbridge/#microbridge/server)

希望这能让你开始。

# r - 将当前 cex.lab 值传递给另一个函数；指定文本行之间的距离

> ID：10707844
> 
> 赞同：1
> 
> 时间：2012-05-22T18:24:57.830
> 
> 标签：r, axis-labels

问题 1：假设我有一个类似下面的函数，它允许我绘制线条并在 x 轴下方打印多行文本（抱歉，这是我能想到的最简单的代码。我愿意关于如何使它更整洁的任何建议！）。当 x 轴下方有多于一行文本时，它可能会与 x 轴标签重叠。所以我决定使用 mtext() 来绘制 x 轴标签。

```
Sampleplot = function(x, text, xlab = NULL,...){
    if(!is.null(text)){
        text.n=length(text)       #Number of lines of text
        text.n2=length(text[[1]]) #Number of words. Here I am assuming equal number in 
                                  #each list item
        text.n=rep(1:text.n, each=text.n2)
        matplot(x, axes = FALSE,...)
        axis(2)
        axis(1, labels = FALSE,at = 1:text.n2)
        args.mtext=c(mtext, list(text=unlist(text), 
                     line=text.n, at=1:text.n2, side=1))
        mtext(xlab, line=max(text.n+1.5), side=1)
        invisible(do.call(mapply, args.mtext))
    }else matplot(x,...)
 }

 #Dataset and texts
 dataset = cbind(sort(rlnorm(4)),sort(rlnorm(4)),sort(rlnorm(4)))
 texts = list(letters[1:4], 1:4, letters[11:14])

 #Sample plot:
 par(mar=c(10,6,4,2))
 Sampleplot(dataset, texts, xlab = "This is the label for x-axis", 
            type="b", pch=1) 
```

![在此处输入图像描述](../Images/f709179fed279fa2d9c08a4e406a9502.png)

* * *

现在，假设我想增加标签大小：

```
 Sampleplot(dataset, texts, xlab = "This is the label for x-axis", 
            type="b", pch=1, cex.lab=3) 
```

当然，这不会对 x 轴标签做任何事情，因为它不是使用 matplot() 而是使用 mtext() 创建的。

一种可能的解决方案是使 cex.lab 成为函数中的显式参数，并将其添加到 matplot

```
Sampleplot2 = function(x, text, xlab = NULL, cex.lab = NULL, ...){      #<- HERE!!
    if(is.null(cex.lab)) cex.lab = 1
    if(!is.null(text)){
        text.n=length(text)       #Number of lines of text
        text.n2=length(text[[1]]) #Number of words. Here I am assuming equal number in 
                                  #each list item
        text.n=rep(1:text.n, each=text.n2)
        matplot(x, axes = FALSE, cex.lab=cex.lab,...)                #<- HERE!
        axis(2)
        axis(1, labels = FALSE,at = 1:text.n2)
        args.mtext=c(mtext, list(text=unlist(text), 
                     line=text.n, at=1:text.n2, side=1))
        mtext(xlab, line=max(text.n+1.5), side=1, cex=cex.lab)   #<- HERE!
        invisible(do.call(mapply, args.mtext))
    }else matplot(x,...)
 }

 par(mar=c(10,6,4,2))
 Sampleplot2(dataset, texts, xlab = "This is the label for x-axis", 
            type="b", pch=1, cex.lab=2) 
```

![我不小心重新创建了数据集，所以这个图看起来不像上一个](../Images/7f4ccb194ec87f3d31a64ceeeac0b031.png)

然而，这个解决方案似乎远非优雅。所以我想知道是否有任何方法可以传递 cex.lab 值而不必明确地将其放入函数定义中。我尝试使用 par()$cex.lab，但与 par()$mar 不同，par()$mar 提供当前保证金状态，par()$cex.lab 似乎只给你默认标签大小，即 1。

问题 2：正如你在我的情节中看到的那样，不同行文本之间的间距有点宽。我想知道是否有任何方法可以测量文本的高度，并且我可以使用高度来决定不同文本行之间的空间应该有多宽。

提前谢谢你们！

# asp.net-mvc-3 - 与 Teleriks Grid 的自定义数据绑定

> ID：10707845
> 
> 赞同：0
> 
> 时间：2012-05-22T18:25:02.193
> 
> 标签：asp.net-mvc-3, .net-4.0

我有一个 MVC3 Telerik 应用程序。这是我的控制器：

```
 [GridAction]
    public ActionResult Index(GridCommand command)
    {
        IEnumerable<Order> data = GetData(command);
        var dataContext = new NorthwindDataContext();

        //Required for pager configuration
        ViewData["total"] = dataContext.Orders.Count();

        return View(data);
    }

    [GridAction(EnableCustomBinding = true)]
    public ActionResult _CustomBinding(GridCommand command)
  {
IEnumerable<Order> data = GetData(command);

var dataContext = new NorthwindDataContext();
return View(new GridModel 
{ 
    Data = data, 
    Total = dataContext.Orders.Count() 
});
}

    //Utility method which does custom paging and sorting using Linq
    private static IEnumerable<Order> GetData(GridCommand command)
    {
        var dataContext = new NorthwindDataContext();
        IQueryable<Order> data = dataContext.Orders;

        if (command.PageSize > 0)
        {
            data = data.Skip((command.Page - 1) * command.PageSize);
        }

        data = data.Take(5);
        return data;
    } 
```

这是我的剃刀视图：

```
 @model IEnumerable<Telerik.Order>

     @(Html.Telerik().Grid(Model)
    .Name("Grid")
    .Columns(columns =>
    {
        columns.Bound(o => o.OrderID).Width(100);
        columns.Bound(o => o.Customer.ContactName).Width(200);
        columns.Bound(o => o.ShipAddress);
        columns.Bound(o => o.OrderDate).Format("{0:MM/dd/yyyy}").Width(100);
    })
                .DataBinding(dataBinding =>
                {
                    dataBinding.Ajax().Select("_CustomBinding", "Home").Enabled(true);
            })
        .Pageable(pager => pager.Total((int)ViewData["total"]))
        .EnableCustomBinding(true)
        .Sortable() 
```

)

当我运行该应用程序时，它可以正常加载，但是当我单击底部分页行中的一个数字时，我得到：

```
 Error! The requested URL returned 500- Internal server error 
```

它调用我的函数 _CustomBinding 并且当我单步执行它时不会抛出错误。是什么导致了这个错误？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T12:26:11.177

这意味着在 _CustomBinding 方法中发生了服务器端异常。您可以检查实际的服务器响应是什么——它将包含堆栈跟踪。使用 Fiddler 或浏览器的开发人员工具检查服务器响应是什么。

# iphone - 从 iPhone 中的 Oracle DB 读取数据

> ID：10707846
> 
> 赞同：0
> 
> 时间：2012-05-22T18:25:06.487
> 
> 标签：iphone

我想将 Oracle DB 中的数据读/写到我的 iPhone 代码中。你能建议一些相同的方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T18:34:24.260

一种可能的解决方案是为您的 iOS 应用程序提供一个[REST Api](http://es.wikipedia.org/wiki/Representational_State_Transfer)并实现读取/更新/删除模型实体的方法。

如果您可以直接从您的 iOS 应用程序访问数据库，那么对于模型的每次更改，您都必须在您的 iOS 应用程序上部署一个新版本。提供 REST Api，您可以在模型中进行更改，而无需更改服务的参数或响应。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T18:35:12.490

不。

数据库连接通常期望是可靠的。来自 iPhone 的连接不是。

此外，任何数据库管理员都会告诉您，确保数据库安全的第一步是锁定可以直接访问数据库的位置数量。这就是为什么您永远不会（或*永远*不会）看到客户端设备直接与数据库通信的原因。

相反，实现一个中介（如网络服务），以通常的方式（`NSURLConnection`等）接受来自 iPhone 的 HTTPS 连接，并自行完成实际的数据库繁重工作。我不是甲骨文专家，但我会假设他们有一些产品可以帮助您以相对较少的精力来完成这项任务，因为它是一项常见的任务。如果没有，您应该很容易用 Java、Python 或您选择的语言实现自己的。

# php - 漂亮的 URL 仅部分正常工作

> ID：10707847
> 
> 赞同：1
> 
> 时间：2012-05-22T18:25:14.160
> 
> 标签：php, .htaccess, hyperlink, friendly-url

在 Stackoverflow 的一些人的帮助下，我设法整理了一个允许“漂亮 URL”的 .htaccess 文件。如果用户直接在地址栏中键入“漂亮的 URL”，这很好，因为转换完全按照我的意愿进行，但是如果用户单击我的站点中生成动态链接的链接，则“丑陋的 URL” ' 仍然存在，并且不会发生转换。是否需要在 .htaccess 文件中添加一些内容才能使其正常工作，或者我是否需要编写一些 PHP 代码来强制转换链接？

我的 .htaccess 文件设置如下：

```
Options -Multiviews

RewriteEngine On
RewriteBase /

RewriteCond %{HTTP_HOST} !^mysite\.com$
RewriteRule ^(.*) http://mysite.com/$1 [R=301,L]

RewriteRule ^episode/(0|[1-9]\d{0,2})$ /episode.php?episode=$1 [L,QSA] 
```

（转换`http://mysite.com/episode.php?episode=31`为`http://mysite.com/episode/31`。）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T21:16:44.303

只需在最后附加此规则即可在浏览器中强制使用漂亮的 URL：

```
RewriteCond %{THE_REQUEST} ^[A-Z]{3,}\s/+episode\.php\?episode=(\d+) [NC]
RewriteRule ^ episode/%1? [R=302,L] 
```

一旦工作更改`R=302`为`R=301`.

# xslt - XSLT 不是重复标签或选择第一个标签

> ID：10707849
> 
> 赞同：0
> 
> 时间：2012-05-22T18:25:32.290
> 
> 标签：xslt, cognos

我在尝试处理具有递归标签的 XML 时遇到了两个问题（相同的标签在标签内重复）。

问题 #1 “标题：”部分输出所有标题标签的文本连接，就好像它是从 / 而不是调用它的路径搜索。

问题 #2 @id 测试什么也没找到，这可能是同一问题的症状。

这是 XSL：

```
<?xml version="1.0"?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:cog="http://developer.cognos.com/schemas/xmldata/1/" xmlns:xs="http://www.w3.org/2001/XMLSchema-instance"> 
<xsl:template match="/">
<xsl:template match="cog:rows">
    <xsl:apply-templates select="cog:rowEdge"/>
</xsl:template>
<xsl:template match="cog:rowEdge">
    <p><b>Caption:</b> <xsl:value-of select="cog:caption"/></p>
    <xsl:if test="@id">
        <b>id:</b> <xsl:value-of select="@id"/><br/>
    </xsl:if>
    <xsl:if test="cog:rowEdge">
        <p>Looking at next rowEdge</p>
        <xsl:apply-templates select="cog:rowEdge"/>
    </xsl:if>
</xsl:template>
<html>
<head><title>%s</title></head>
<body>
    <xsl:apply-templates select="cog:dataset/cog:crosstab/cog:rows"/>
</body>
</html>
</xsl:template>
</xsl:stylesheet> 
```

这是 XML：

```
<?xml version="1.0" encoding="utf-8" ?>  
 <dataset xmlns="http://developer.cognos.com/schemas/xmldata/1/" xmlns:xs="http://www.w3.org/2001/XMLSchema-instance"> 
 <crosstab> 
 <values> 
  <value row="R1" col="C1" xs:nil="true" />  
  <value row="R1" col="C2" xs:nil="true" />  
  <value row="R1" col="C3" xs:nil="true" />  
  <value row="R1" col="C4" xs:nil="true" />  
  <value row="R1" col="C5" xs:nil="true" />  
  <value row="R1" col="C6" xs:nil="true" />  
  <value row="R1" col="C7" xs:nil="true" />  
  <value row="R1" col="C8" xs:nil="true" />  
  <value row="R1" col="C9" xs:nil="true" />  
  <value row="R2" col="C1">0</value>  
  <value row="R2" col="C2">12.61728395</value>  
  <value row="R2" col="C3">1320.40677966</value>  
  <value row="R2" col="C4">7</value>  
  <value row="R2" col="C5">1.90318499</value>  
  <value row="R2" col="C6">108.66456135</value>  
  <value row="R2" col="C7">776.61407946</value>  
  <value row="R2" col="C8">-0.86007907</value>  
  <value row="R2" col="C9">46.53571429</value>  
</values> 
 <corner> 
  <caption>Time Period: DCG Incurred Paid Year</caption>  
  </corner> 
 <columns> 
 <colEdge> 
  <caption>Jan 02 to Dec 02 {All Data} CRxIp</caption>  
 <colEdge> 
  <caption>2002</caption>  
 <colEdge id="C1"> 
  <caption>Member Age Avg</caption>  
  </colEdge> 
 <colEdge id="C2"> 
  <caption>Days Supply Per Script Rx</caption>  
  </colEdge> 
 <colEdge id="C3"> 
  <caption>Net Pay Per Pat Med</caption>  
  </colEdge> 
 <colEdge id="C4"> 
  <caption>Days LOS Admit Acute</caption>  
  </colEdge> 
 <colEdge id="C5"> 
  <caption>Days LOS Admit Acute</caption>  
  </colEdge> 
 <colEdge id="C6"> 
  <caption>Allow Amt PMPM Med and Rx {Cmpl}</caption>  
  </colEdge> 
 <colEdge id="C7"> 
  <caption>Allow Amt PMPM Med and Rx {Cmpl}</caption>  
  </colEdge> 
 <colEdge id="C8"> 
  <caption>% Diff Allow Amt PMPM Med and Rx {Cmpl}</caption>  
  </colEdge> 
 <colEdge id="C9"> 
  <caption>Relative Risk Score Prosp Explan NonRescaled</caption>  
  </colEdge> 
  </colEdge> 
  </colEdge> 
  </columns> 
 <rows> 
 <rowEdge> 
  <caption>Subsets</caption>  
 <rowEdge> 
  <caption>Plan Type Medstat</caption>  
 <rowEdge id="R1"> 
  <caption>Cohort Medstat</caption>  
  </rowEdge> 
  </rowEdge> 
  </rowEdge> 
 <rowEdge> 
  <caption>Chronic Episodes</caption>  
 <rowEdge> 
  <caption>HMO (Managed Care)</caption>  
 <rowEdge id="R2"> 
  <caption>Females, Ages &lt; 1</caption>  
  </rowEdge> 
</rowEdge> 
 </rowEdge> 
 </rows> 
  </crosstab> 
  </dataset> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T18:57:59.053

您的样式表无效，因为文档节点的模板包含所有其他模板。模板是 XSLT 中的顶级元素，不能嵌套。如果将它们分开，样式表应该按预期工作：

```
<xsl:stylesheet version="1.0" 
   xmlns:xsl="http://www.w3.org/1999/XSL/Transform" 
   xmlns:cog="http://developer.cognos.com/schemas/xmldata/1/" 
   xmlns:xs="http://www.w3.org/2001/XMLSchema-instance"> 

   <xsl:template match="/">
      <html>
         <head><title>%s</title></head>
         <body>
            <xsl:apply-templates select="cog:dataset/cog:crosstab/cog:rows"/>
         </body>
      </html>
   </xsl:template>

   <xsl:template match="cog:rows">
      <xsl:apply-templates/>
   </xsl:template>

   <xsl:template match="cog:rowEdge">
      <p><b>Caption:</b> <xsl:value-of select="cog:caption"/></p>
      <xsl:if test="@id">
         <b>id:</b> <xsl:value-of select="@id"/><br/>
      </xsl:if>
      <xsl:if test="cog:rowEdge">
         <p>Looking at next rowEdge</p>
         <xsl:apply-templates select="cog:rowEdge"/>
      </xsl:if>
   </xsl:template>
</xsl:stylesheet> 
```

# java - JList：显示存储以外的其他内容

> ID：10707851
> 
> 赞同：0
> 
> 时间：2012-05-22T18:25:46.760
> 
> 标签：java, linked-list, jlist

我有一个 JList 组件，我想存储图像的路径，但要显示图像的名称，而不是路径。我有一个像这样按下打开文件按钮的代码：

```
 public void openButtonActionPerformed() {       

    int returnVal = fc.showDialog(null, "Open");

     if (returnVal == JFileChooser.APPROVE_OPTION) { 
           file = fc.getSelectedFile();
     }
    jList1.setCellRenderer(new JavaRenderer());
} 
```

和：

```
class JavaRenderer extends DefaultListCellRenderer {

public JavaRenderer(){
    //setOpaque(true);
}
 public File file;  

 public Component getListCellRendererComponent(JList list,
                                            Object value,
                                            int index,
                                            boolean isSelected,
                                            boolean hasFocus) {

if (value instanceof File) {
  File file = (file) value;

     return super.getListCellRendererComponent(list, file.getName(), index, isSelected, hasFocus);
}else {
     return super.getListCellRendererComponent(list, value, index, isSelected, hasFocus);
}
}
} 
```

但它仍然不起作用。你能帮我解决这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T18:48:58.723

除了这里提供的答案之外，还有另一种方式。您可以将 File 对象包装在您自己的 File 类中。然后重载 toString() 方法以返回文件名。

```
class CustomFile extends File{
    public CustomFile(File f){super(f.getAbsolutePath());}
    public String toString(){return getName();}
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T18:30:59.340

您需要编写自己的[ListModel](http://docs.oracle.com/javase/1.4.2/docs/api/javax/swing/ListModel.html)，在其中存储`List<File>`内部并从`getElementAt(int index)`方法返回 fileName。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-22T18:31:00.760

您可以通过创建自己的 ListCellRenderer 来更改内容在 JList 中的呈现方式。（看看这个：[http](http://docs.oracle.com/javase/1.4.2/docs/api/javax/swing/ListCellRenderer.html) ://docs.oracle.com/javase/1.4.2/docs/api/javax/swing/ListCellRenderer.html ）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-22T18:34:08.173

您可以使用覆盖方法`jList.setCellRenderer()`传递的位置`new DefaultListCellRenderer()`

`getListCellRendererComponent(JList list, Object value, int index, boolean isSelected, boolean cellHasFocus)`

`value`- 是您插入到 JList 的对象，因此您可以存储它但显示另一个标签：

```
if (value instanceof File) {
   File file = (File) value;
   return super.getListCellRendererComponent(list, file.getName(), index, isSelected, cellHasFocus);
} else {
   return super.getListCellRendererComponent(list, value, index, isSelected, cellHasFocus);
} 
```

# c# - 高级分组

> ID：10707852
> 
> 赞同：0
> 
> 时间：2012-05-22T18:25:48.200
> 
> 标签：c#, linq, group-by, linq-to-objects

我有一个具有以下结构的项目列表：

1.  ID
2.  约会时间
3.  重量

如何按字段日期（即 DateTime ）对它们进行分组**并**获得**该**`Id`组的总权重？我想要这样的东西：**`Date`**

 ****1.  ID
2.  日期
3.  总重量

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T18:30:22.727

如果你想用 ID 和 Date 对它们进行分组，你可以这样做：

```
var grp = from x in items
          group by new {x.Id, x.DateTime.Date};

var result = grp.Select(x=>new {item = x.Key, TotalWeight = x.Sum(y=>y.Weight)}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T19:11:54.427

```
var result = from x in items
             group x by new { x.Id, x.DateTime.Date } into grouping
             select new 
             { 
                 id = grouping.Key.Id, 
                 Date = grouping.Key.Date, 
                 TotalWeight = grouping.Sum(y=>y.Weight)
             }; 
```****

# java - 创建新的maven项目时eclipse不显示工件

> ID：10707857
> 
> 赞同：1
> 
> 时间：2012-05-22T18:26:15.240
> 
> 标签：java, eclipse, spring, maven

![在此处输入图像描述](../Images/359272672eba0b5584933853cf633854.png) 大家好，

我对 Maven 和 Spring 都是新手。我想创建一个基于 Maven 的 spring 项目，这就是我正在做的事情。

新建->其他-> maven项目->下一个->下一个->？

在这里，我想选择一种设置了所需文件夹的项目。例如，要建立一个简单的基于 maven 的 java 项目，我选择 maven-archetype-quickstart 。但是到了春天我不知道该选择哪个神器，我感觉它没有显示所有的神器。我附上了我感到困惑的那一步的一些截图。

简而言之：1）如果我想获得一个 spring 项目，我应该选择哪个工件 2）看起来我无法在这里看到所有工件。例如，当我寻找 spring 时，我只看到两个工件。当我搜索 webapp 时，我只看到两个工件。我应该做任何配置吗？3）如何知道哪些工件套件，例如基本的 spring 项目我应该选择哪个工件？

我的问题可能非常基本。请帮我

谢谢

![我能看到的所有文物](../Images/7a28e52fa3cb09489c7f776de7f022b3.png)![与spring相关的神器！[][2]](../Images/816f96e8db6297d3ac1d01632075597a.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T18:40:29.767

`appfuse-basic-spring`原型应该创建一个单一目录的 spring 项目。对于一个简单的项目，这可能是您想要的。

应该创建一个多模块（阅读：具有多个子模块的`appfuse-modular-spring`父模块）项目。有关多模块 maven 项目的更多信息，我建议您查看[Maven by Example](http://www.sonatype.com/books/mvnex-book/reference/public-book.html)的第 6 章和第 7 章。

# blackberry - 哪里可以得到用于 PhoneGap 的 BlackBerry CSK File？

> ID：10707859
> 
> 赞同：3
> 
> 时间：2012-05-22T18:26:22.863
> 
> 标签：blackberry, cordova, blackberry-webworks

我想使用 PhoneGap 为我的 BlackBerry 应用程序签名。当我去添加密钥文件时，它会要求一个 CSK 文件。

![在此处输入图像描述](../Images/fdeae0cb349dc409a4035577dda976b3.png)

我去了[https://www.blackberry.com/SignedKeys/](https://www.blackberry.com/SignedKeys/)并请求了密钥。

然而，发送给我的文件是 3 个不同的 CSI 文件（RBB、RCR、RRT）。

如何以及在哪里可以获得在 PhoneGap 上签署应用程序所需的 CSK 和 DB 文件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T21:16:30.850

首先，您需要安装[黑莓 SDK](https://bdsc.webapps.blackberry.com/java/download)（如果您使用此 IDE，则作为 Eclipse 的一部分，否则获取独立的 java 版本）。

然后按照这些[步骤](https://bdsc.webapps.blackberry.com/html5/documentation/ww_publishing/Signing_setup_smartphone_apps_1920010_11.html)。

基本上这将在本地存储您的密钥，然后您以 .csk+.db 文件的形式创建它的备份。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-24T11:04:06.063

Adobe® PhoneGap™ Build 当前为所有用户提供默认的 BlackBerry 开发版本，它为您的 PhoneGap 应用程序提供无线安装。但是，要分发您自己的 BlackBerry 应用程序，您需要向 RIM 注册您自己的密钥，然后将这些密钥导入 PhoneGap Build。

[要注册，请在RIM 网站](https://www.blackberry.com/SignedKeys/)上填写表格 ，并在收到密钥后，在本地按照安装过程进行操作。使用[此处提到的步骤](https://build.phonegap.com/docs/blackberry-keys)

# php - 获取当前用户的所有收藏夹

> ID：10707863
> 
> 赞同：0
> 
> 时间：2012-05-22T18:26:51.070
> 
> 标签：php, mysql, html, codeigniter, favorites

我在数据库中有一个名为“收藏夹”的表，其中包含 3 列（user_id、bookmarked_song_id、bookmark_tag），我想获取当前用户的所有 Bookmarked_song_id。

```
 $username = $this->session->userdata('username');
 $uidq = mysql_query('SELECT user_id FROM users WHERE username="' . $username . '"');
 $rq = mysql_fetch_assoc($uidq);
 $user_id = $rq['user_id'];
 $getfavq = mysql_query("SELECT * FROM favorites WHERE user_id=$user_id");
 $favsr = mysql_fetch_array($getfavq); //contains all the information from the favorites database where user_id is the user_of the currently logged-in user 
```

而且我不知道接下来要使用什么...我想要类似的东西：

```
foreach($favsr['bookmarked_song_id'] as $song_id) {
$getsongq = mysql_query("SELECT * FROM songs WHERE song_id=$song_id");
$getsongr = mysql_fetch_assoc($getsongq);
$singer = $getsongr['singer'];
$song_name = $getsongr['song_name'];} 
```

显然该方法是错误的，因为我得到：“为 foreach() 提供的参数无效”。谁能帮我找歌？提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T18:29:27.860

应该是这样的：

```
$favsr = mysql_fetch_array($getfavq, MYSQL_ASSOC);
foreach($favsr as $row) {
    $songid = $row['bookmarked_song_id'];
     ...
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T18:33:18.720

mysql_fetch_array 只加载一行，应该是这样的

```
$getfavq = mysql_query("SELECT * FROM favorites WHERE user_id=$user_id");
while $favsr = mysql_fetch_array($getfavq); 
    {$songid=$favsr['bookmarked_song_id'];
    $getsongq = mysql_query("SELECT * FROM songs WHERE song_id=$song_id");
    $getsongr = mysql_fetch_array($getsongq);
    $singer = $getsongr['singer'];
    $song_name = $getsongr['song_name'];} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-22T20:21:48.370

您已将此标记为`codeigniter`。如果您正在构建 CodeIgniter 应用程序，您可能应该使用 CI 的数据库库：

```
$username = $this->session->userdata('username');

//Select your user
$this->db->select('user_id');
$this->db->where('username', $username);
$this->db->limit(1);
$user_query = $this->db->get('users');

if($user_query->num_rows() > 0)
{
    // We found a user
    $user = $user_query->row(); // select a single row

    // Grab this user's favorites
    $this->db->where('user_id', $user->id);
    $favorites_query = $this->db->get('favorites');

    $songs = $favorites_query->result();

    if($songs)
    {
        foreach($songs as $song)
        {
            $song_id = $song->bookmarked_song_id;
            $tag = $song->bookmark_tag;

            // Do stuff with data.
        }
    }
    else
    {
        // No songs/favorites found, catch error
    }

}
else
{
    // No such user found, catch error
} 
```

当然，最好的做法是将您的用户数据和收藏夹数据放在不同的模型中，但这目前应该可行。

# file - 如何在Lua中从文件末尾查找单词

> ID：10707868
> 
> 赞同：0
> 
> 时间：2012-05-22T18:27:22.487
> 
> 标签：file, lua

好的，我使用这里的方法：[如何在 Lua 中仅读取文本文件的最后一行？](https://stackoverflow.com/questions/497311/how-to-read-only-the-last-line-of-a-text-file-in-lua)

问题是有时线可能更大。

问题是我如何从文件末尾找到第一个单词“foo”，然后使用它之后的所有内容？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T19:58:40.053

> 问题是有时线可能更大。

然后，您只需要从末端进一步寻找。

> 问题是我如何从文件末尾找到第一个单词“foo”，然后使用它之后的所有内容？

抓取足够大的文件块，以确保您有最后一个 foo，`.*foo`用于跳过所有内容，包括最后一个“foo”（.* 是贪婪的）。

```
local f = io.open('filename', 'r')
f:seek('end', -1024)
local text = f:read('*a')
local after = string.match(text, ".*foo(.*)")
f:close() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T19:54:53.030

如果文件不是太大并且您准备好采取简单的方法，这可能会有所帮助：

```
fh=io.open('myfile.txt','rb')
str=fh:read'*a'
pat='foo'
afterFoo=str:match('.*'..pat..'(.*)$')
fh:close() 
```

如果您需要更复杂但更快（在大文件上运行时）的解决方案，我的猜测是您以块的形式读取文件，反转它们中的每一个，然后反向查找您的模式。不要忘记在边界上寻找你的模式（在一般情况下，块必须至少与你正在寻找的模式的长度重叠）。

有关块读取的更多说明，请参阅我的[帖子](https://stackoverflow.com/questions/8907949/return-offset-of-a-string-with-lua/8908677#8908677)。

# javascript - 最有效的 JavaScript 语法检查解决方案是什么？

> ID：10707869
> 
> 赞同：4
> 
> 时间：2012-05-22T18:27:37.733
> 
> 标签：javascript, ajax, syntax

我正在开发一个 AJAX 应用程序，在此过程中，我创建了许多小型 JS 文件，这些文件最终将在生产版本中连接和缩小。但是在开发中，我将使用单个未缩小的文件。

我遇到的问题是我在 Ubuntu 中使用 Kate 作为我的编辑器，当我犯一些小错误时，比如 JSON 结构中的额外逗号、额外的括号、冒号、分号或其他简单的语法错误，我没有办法直到我在 Firebug 或 IE Developer Toolbar（在 VM 中运行）中看到它才知道。不幸的是，Firebug 不能很好地识别哪一行有语法错误，只有 IE 会抱怨多余的逗号。如果我能像一个优秀的现代 IDE 一样实时看到这些错误，那就太棒了。但是，我将满足于任何不需要我将每个文件从本地计算机复制并粘贴到文本区域的语法检查解决方案。

此外，JSLint 的检查有点过火。它抱怨的事情有一半是我故意做的。

我有哪些选择？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T18:37:14.807

jshint ( [http://www.jshint.com/](http://www.jshint.com/) ) 是 jslint 的后代之一，因为有几个人对 jslint 也有这样的问题（太固执己见）。

我猜你可以用 jshint 做类似的事情，就像 jslint 在这里做的一样：http: [//sergioserra.posterous.com/using-jslint-with-kate](http://sergioserra.posterous.com/using-jslint-with-kate)

就我个人而言，我将 vim 与 jslint 一起使用（配置比默认配置更允许），它正在实时检查语法。

另一种选择是来自 Google 的 Closure Linter：[https ://developers.google.com/closure/utilities/](https://developers.google.com/closure/utilities/)

# sql - SQL 案例切换默认为在 Null 上显示占位符图像

> ID：10707876
> 
> 赞同：0
> 
> 时间：2012-05-22T18:27:57.353
> 
> 标签：sql, null, switch-statement, case

我正在尝试从两个表中获取产品和图像列表。当我加入他们并在产品表中的 HasImage 列上使用大小写开关时，我收到此错误：

错误：

```
Subquery returned more than 1 value. 
This is not permitted when the subquery follows =, !=, <, <= , >, >= 
or when the subquery is used as an expression. 
```

当产品没有图像时，我想将其替换为默认图像。

这是选择语句：

```
SELECT 

P.[ProductId]
,P.[ProductName]

--If HasImage is false show the default.jpg
,Case P.[HasImage]
WHEN 'True' THEN (Select I.[FileName] as ProductImage FROM [ProductImages] I
INNER JOIN [Product] P on P.ProductId = I.ProductId
  WHERE I.Sequence=0)
WHEN 'False' THEN 'default.jpg'
END

FROM [Product] P
LEFT JOIN [ProductImages] I
on P.ProductId = I.ProductId 
```

问题出在“真”的情况下。这就是引发错误的原因。

产品表

```
ProductId         ProductName       HasImage
1                 Coffee Mug        True
2                 Pen               False
3                 Pencil            False 
```

产品图片表

```
ProductId         Sequence          FileName
1                 0                 Mug_Image1.jpg
1                 1                 Mug_2.jpg
1                 2                 Mug_Img3.jpg 
```

ProductId=1 有多个图像，但我使用 Sequence = 0 只返回一个。

我想要的返回数据应该是这样的：

```
ProductId         ProductName       ProductImage
1                 Coffee Mug        Mug_Image1.jpg
2                 Pen               default.jpg
3                 Pencil            default.jpg 
```

我尝试了各种合并（NULLIF、左连接和不同的语句）的组合，但我还没有让所有三种产品都按需要显示。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T21:59:46.563

除了我在 OP 下方的评论之外，这是一个我认为应该首先编写的查询。

```
SELECT 
    P.[ProductId]
   ,P.[ProductName]
   --If HasImage is false show the default.jpg
   ,Case P.[HasImage]
         WHEN 'True' 
         THEN I.[FileName]
         WHEN 'False' 
         THEN 'default.jpg'
   END
  FROM [Product] P
  LEFT JOIN [ProductImages] I
    ON P.ProductId = I.ProductId
   -- Filter Sequence 0 only
   -- All products will be retrieved
   -- whether they have associated Image with Sequence = 0
   AND I.Sequence = 0 
```

过滤左连接的右侧允许您保留左连接的属性并仅连接感兴趣的行。如果 HasImage 仅用于标记图像的存在而不是作为业务规则（显示/不显示此特定产品的图像），您可以删除 case 以支持 simple `isnull(I.FileName, 'default.jpg')`。

或者（Sql Server 2005 和更新版本）您可以使用[CROSS APPLY](http://weblogs.sqlteam.com/jeffs/archive/2007/10/18/sql-server-cross-apply.aspx)来检索图像：

```
SELECT 
    P.[ProductId]
   ,P.[ProductName]
   ,I.[FileName]
  FROM [Product] P
 OUTER APPLY
 (
    SELECT CASE P.[HasImage]
           WHEN 'True' 
           THEN ProductImages.[FileName]
           WHEN 'False' 
           THEN 'default.jpg'
       END FileName
      FROM [ProductImages]
     WHERE P.ProductId = ProductImages.ProductId
       AND I.Sequence = 0
 ) I 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T19:01:08.353

你为什么要参加`INNER JOIN`？

如果您确定何时`HasImage`为 TRUE，您的表将有图像，那么最好直接连接。

试试这个查询 -

```
SELECT P.[ProductId], 
       P.[ProductName],
       Case P.[HasImage] 
            WHEN 'True' THEN 
            (Select 
                   TOP 1 -- For Oracle 
                   I.[FileName] as ProductImage FROM [ProductImages] I
             WHERE P.ProductId = I.ProductId
             ORDER BY I.Sequence 
             LIMIT 1 -- For MySQL
             )
            WHEN 'False' THEN 'default.jpg'
         END
FROM [Product] P 
```

# jquery - Fancybox2 修改加载的内容

> ID：10707878
> 
> 赞同：0
> 
> 时间：2012-05-22T18:28:12.050
> 
> 标签：jquery, fancybox

我想在使用 FancyBox 2 的 AJAX 调用加载页面后更改 css 值。我的目标是在加载的页面中隐藏一个块（仅当由 FancyBox 的 AJAX 调用加载时）。我想以某种方式可以使用 Afterload 方法。

有人有线索吗？？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T18:58:49.317

您可以使用该`$.fancybox.update();`方法（在`afterLoad`回调内部）重新调整 fancybox 的大小以匹配其中内容的大小（`width`和`height`）。

# javafx-2 - JavaFX 缩放和翻译操作导致异常

> ID：10707880
> 
> 赞同：1
> 
> 时间：2012-05-22T18:28:22.713
> 
> 标签：javafx-2

我有一个窗格（test_）作为边框窗格的中心子项。当窗口按预期拉伸时，孩子会填充其区域并成长。

现在我缩放 test_。通常它会在其区域中居中，但我不希望这样，所以我将它翻译回其区域的左上角。

但是现在当我拉伸寡妇时，它会将 test_ 从其区域的左上角拉开。谁能解释为什么会这样？下面的示例包含一个缩放 test_ 的滑块。

谢谢你。

```
package fxuicontrols;

import javafx.application.Application;
import javafx.beans.value.ChangeListener;
import javafx.beans.value.ObservableValue;
import javafx.geometry.Bounds;
import javafx.scene.Scene;
import javafx.scene.control.Slider;
import javafx.scene.layout.BorderPane;
import javafx.scene.layout.Pane;
import javafx.scene.paint.Color;
import javafx.scene.text.Text;
import javafx.stage.Stage;

public class ScaleTest
    extends Application
    implements ChangeListener<Number>
{
    private final Pane  test_    = new Pane();

    public static void main(String[] args)
    {
        launch();
    }

    @Override
    public void start(Stage stage) throws Exception
    {
        test_.setStyle( "-fx-background-color: blue;" );

        Text    text    = new Text( "Upper left corner" );
        text.setFill( Color.WHITE );
        text.relocate( 0, 0 );
        test_.getChildren().add( text  );

        final Slider    scaler  = new Slider( .25, 1, 1 );
        scaler.valueProperty().addListener( this );
        test_.scaleXProperty().bind( scaler.valueProperty() );
        test_.scaleYProperty().bind( scaler.valueProperty() );

        BorderPane  root    = new BorderPane();
        root.setPrefSize( 250, 250 );
        root.setCenter( test_ );
        root.setBottom( scaler );

        stage.setScene( new Scene( root ) );
        stage.show();
    }

    @Override
    public void
    changed( ObservableValue<? extends Number> oVal,
                Number oldNm,
                Number newNum
    )
    {
        double  scale   = newNum.doubleValue();
        Bounds  bounds  = test_.getLayoutBounds();
        double  width   = bounds.getWidth();
        double  height  = bounds.getHeight();
        test_.setTranslateX( (scale * width - width) / 2 );
        test_.setTranslateY( (scale * height - height) / 2 );
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T19:48:48.513

当调整场景大小时，您的解决方案出错的原因是因为窗格是可调整大小的节点，因此窗格的布局边界会随着窗格的调整大小而变化，但您在翻译计算中没有考虑到这一点。

以下直接使用 Scale 和 Translate 转换来避免任何与调整大小相关的问题。此示例代码是否符合您的要求？

```
import javafx.application.Application;
import javafx.beans.value.*;
import javafx.geometry.*;
import javafx.scene.Scene;
import javafx.scene.control.Slider;
import javafx.scene.layout.*;
import javafx.scene.paint.Color;
import javafx.scene.shape.Rectangle;
import javafx.scene.text.Text;
import javafx.scene.transform.*;
import javafx.stage.Stage;

// demonstrates scaling a test pane with content in it.
// slide the slider at the bottom of the scene around to shrink and grow the content.
public class ScaleTest extends Application {
  public static void main(String[] args) { launch(); }
  @Override public void start(Stage stage) throws Exception {
    // create a test pane for scaling.
    Pane testPane = new Pane();
    // make the test pane background a different color if you want to see the extent of the pane.
    testPane.setStyle("-fx-background-color: blue;");

    // create some text content to place in the test pane.
    Text text = new Text("Upper left corner");
    text.setStyle("-fx-font-size: 30px;");
    text.setFill(Color.WHITE);
    text.setTextOrigin(VPos.TOP);
    testPane.getChildren().add(text);
    Scale scaleTransform = new Scale();
    testPane.getTransforms().addAll(scaleTransform, new Translate(0, 0));

    // slider to scale the test pane.
    final Slider scaler = new Slider(.25, 3, 1);
    scaleTransform.xProperty().bind(scaler.valueProperty());
    scaleTransform.yProperty().bind(scaler.valueProperty());

    // stackpane added to pad out empty space when testPane is scaled small.
    // stackpane also clips the zoomed content when it gets larger than it's standard layout.
    final StackPane stack = new StackPane();
    stack.getChildren().addAll(testPane);
    StackPane.setAlignment(testPane, Pos.TOP_LEFT);
    stack.setStyle("-fx-background-color: blue;");

    final Rectangle clip = new Rectangle();
    testPane.layoutBoundsProperty().addListener(new ChangeListener<Bounds>() {
      @Override public void changed(ObservableValue<? extends Bounds> observable, Bounds oldBounds, Bounds bounds) {
        clip.setWidth(bounds.getWidth());
        clip.setHeight(bounds.getHeight());
      }
    });
    stack.setClip(clip);

    // layout everything.
    VBox layout = new VBox();
    layout.setPrefSize(250, 250);
    layout.getChildren().setAll(stack, scaler);
    VBox.setVgrow(stack, Priority.ALWAYS);

    // show the stage.
    stage.setScene(new Scene(layout));
    stage.show();
  }
} 
```

# c# - 如何获取加载到主程序集中的类的反射信息

> ID：10707881
> 
> 赞同：0
> 
> 时间：2012-05-22T18:28:25.263
> 
> 标签：c#, .net, reflection

我正在使用[Type.GetType](http://msdn.microsoft.com/en-us/library/w3f99sx1.aspx)函数来获取有关类的反射信息。如果我从我的应用程序中使用该函数一切正常，但现在我需要从以前从我的应用程序加载的外部 dll 调用该函数。

如果从主应用程序调用此代码可以正常工作

```
Type myType1 = Type.GetType("MyNameSpace.MyType"); 
```

但如果将该代码放在 dll 中（该 dll 是从我的应用程序加载的），则会失败（*myType1什么也不返回）*

问题是我如何使用`Type.GetType`加载 dll 的 Exe 中存在的类型？

**编辑 ：**

我认为可以重新制定哪个问题，例如如何从加载我的 dll 的程序集中加载类型？

```
MyEXE
  Myclass   
  MyDll (loaded by MyExe)
    Type.GetType //only get types of the MyDll assembly, how i can access the Myclass type which is defined on MyExe? 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T18:46:57.257

在项目范围之外使用 DLL 时需要使用完全限定名称

```
Type myType1 = Type.GetType("MyType, MyNameSpace", true, true); 
```

试试看

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T19:00:26.747

您还可以通过 Assembly.Load 方法加载程序集，然后枚举所有 (GetTypes()) 或从程序集中获取特定类型。看看组装类

# java - 使用 gradle tomcat 插件

> ID：10707884
> 
> 赞同：12
> 
> 时间：2012-05-22T18:28:41.867
> 
> 标签：java, tomcat, gradle

我正在尝试摆弄[gradle-tomcat-plugin](https://github.com/bmuschko/gradle-tomcat-plugin)并且我在一些预备阶段遇到了一些问题。假设我的 WAR 存在于我的一个文件夹中，我需要做什么才能使用 gradles tomcat 插件在嵌入式 tomcat 中运行战争？自述文件提到了`tomcatRunWar`但我对如何在我的 gradle 文件中使用它有点迷茫

任何帮助，将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-05T20:12:26.113

如果您已正确设置一切

转到你的根目录（你的 build.gradle 文件应该在那里），然后执行

```
gradle tasks 
```

你应该看到tomcats不同的任务

*   tomcatRun：启动一个 Tomcat 实例并将展开的 Web 应用程序部署到它。
*   tomcatRunWar：启动一个 Tomcat 实例并将 WAR 部署到它。
*   tomcatStop：停止 Tomcat 实例。
*   tomcatJasper：运行 JSP 编译器 (Jasper) 并将 JSP 页面转换为 Java 源使用。

然后你就运行它

```
gradle tomcatRunWar 
```

我自己更喜欢码头插件

# entity-framework - 实体框架根据部署环境设置数据库架构

> ID：10707885
> 
> 赞同：0
> 
> 时间：2012-05-22T18:28:47.400
> 
> 标签：entity-framework, entity-framework-4, schema, database-schema

我开发的应用程序部署到严苛的环境（开发、测试、登台、生产）。

在开发过程中，我从现有的开发数据库创建了实体模型。一切正常，但是当我想将应用程序放到测试环境中时，我意识到以下问题：

数据库的结构在所有环境中都是相同的，但数据库架构会因环境而异。例如`Customers`，每个数据库中都有一个表。在我的本地开发机器上，它具有架构 dbo ( `[dbo].[Customers]`)，但在测试环境中，架构是 test ( `[test].[Customers]`)，而架构在登台环境 ( `[stag].[Customers]`) 中是 stag，依此类推。

因此，当我在测试环境中部署应用程序时，它没有从数据库中获取数据，因为实体框架希望在其中找到数据`[dbo].[Customers]`但没有这样的表，只有一个`[test].[Customers]`.

我知道，我可以定义[dbo 以外的模式](https://stackoverflow.com/questions/9341922/change-entity-framework-database-schema-map-after-using-code-first)，但这对我没有帮助，因为我需要一个不同的模式，具体取决于部署环境。

有什么建议么？不知何故，我想我会结束，要求我的数据库管理员在每个环境中的每个数据库中将架构更改为 dbo ......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T08:01:49.330

如果您首先使用代码，则必须使用链接问题中的流利 API 方法并从配置文件中加载当前架构（您必须在每次部署时修改配置）。

如果您将 ObjectContext 与 EDMX 一起使用，则可以使用[Model adapter](http://efmodeladapter.codeplex.com/)。与 DbContext 一起使用的其他方法是将 EF 元数据存储在文件中并执行一些代码，这些代码将在应用程序启动时更改 ssdl 文件中的模式。

# php - 激活路由和控制器

> ID：10707886
> 
> 赞同：1
> 
> 时间：2012-05-22T18:29:04.237
> 
> 标签：php, codeigniter

我想做的是弄清楚我是否需​​要一条路线来应对这种情况。在用户注册我的网站后，他们会收到一封验证电子邮件，他们在其中单击链接并发送到激活控制器，在那里它验证第一个参数是数字，第二个是字符串，然后它们是否与记录匹配db 然后用户被成功激活。

这是我的控制器所拥有的：

```
<?php if ( ! defined('BASEPATH')) exit('No direct script access allowed'); 

class Activate extends CI_Controller { 

public function __construct()
{
    parent::__construct();
    $this->load->library('auth');
}

public function index()
{
    //Config Defaults Start
    $msgBoxMsgs = array();//msgType = dl, info, warn, note, msg
    $cssPageAddons = '';//If you have extra CSS for this view append it here
    $jsPageAddons =  '';//If you have extra JS for this view append it here
    $metaAddons = '';//Sometimes there is a need for additional Meta Data such in the case of Facebook addon's
    $siteTitle = '';//alter only if you need something other than the default for this view.
    //Config Defaults Start

    //examples of how to use the message box system (css not included).
    //$msgBoxMsgs[] = array('msgType' => 'dl', 'theMsg' => 'This is a Blank Message Box...');

    /**********************************************************Your Coding Logic Here, Start*/

    $x = 0;
    if(($param1 !== NULL)&&($param2 !== NULL))
    {

        //params not null yay..
        if((isset($param1))&&((trim($param1) !== '')||(!empty($param1))))
        {
            if(!is_numeric($param1))
            {
              $x++;
            }
        }
        if((isset($param2))&&((trim($param2) !== '')||(!empty($param2))))
        {
            if(!preg_match('/^[A-Za-z0-9]+$/', $param2))
            {
              $x++;
            }
        }

        if($x !== 0)
        {
           $bodyContent = $this->config->item('defaultTemplate') ."error_page";
        }
        else
        {
           $bodyContent = $this->config->item('defaultTemplate') ."/usermanagement/forms/activate";//which view file
        }

    }
    else
    {
        $bodyContent = "error_page";
    }

    /***********************************************************Your Coding Logic Here, End*/

    //Double checks if any default variables have been changed, Start.
    //If msgBoxMsgs array has anything in it, if so displays it in view, else does nothing.      
    if(count($msgBoxMsgs) !== 0)
    {
        $msgBoxes = $this->msgboxes->buildMsgBoxesOutput(array('display' => 'show', 'msgs' =>$msgBoxMsgs));
    }
    else
    {
        $msgBoxes = array('display' => 'none');
    }

    if($siteTitle == '')
    {
        $siteTitle = $this->metatags->SiteTitle(); //reads 
    }

    //Double checks if any default variables have been changed, End.

    $this->data['msgBoxes'] = $msgBoxes;
    $this->data['cssPageAddons'] = $cssPageAddons;//if there is any additional CSS to add from above Variable this will send it to the view.
    $this->data['jsPageAddons'] = $jsPageAddons;//if there is any addictional JS to add from the above variable this will send it to the view.
    $this->data['siteTitle'] = $siteTitle;//defaults can be changed via models/metatags.php
    $this->data['bodyType'] = $bodyType;
    $this->data['bodyContent'] = $bodyContent;
    $this->load->view($this->config->item('defaultTemplate') .'/usermanagement/index', $this->data);
}

}

/* End of file register.php */ 
/* Location: ./application/controllers/register.php */ 
```

我的网址看起来像 siteurl.com/activate/10000/7dfdao87fda8f7

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T18:48:47.660

如果您的 URL 将是`http://example.com/activate/account/12345/abcde`，那么您将不需要路由。

如果是这样，`http://example.com/activate/12345/abcde`那么您将需要这样的路线：

```
$route["activate/(:num)/(:any)"] = "activate/account/$1/$2"; 
```

理所当然地认为`activate`控制器有一个调用方法`account`，您可以使用它来激活帐户。

它的作用是获取第一个括号内的值（它是一个数字）并将其插入到 的位置`$1`，然后获取第二个括号内的值（它是任何字符）并将其插入到`$2`

然后您需要使用以下控制器/方法：

```
class Activate extends CI_Controller {
    public function account ($var1, $var2) {
        // ...process vars etc
    }
} 
```

如果使用 index 方法，则需要将变量传递给它，然后在路由中调用它：

```
class Activate extends CI_Controller {
    public function index ($var1, $var2) {
        // ...process vars etc
    }
}

$route["activate/(:num)/(:any)"] = "activate/index/$1/$2"; 
```

这是因为通过将其更改为`activate/$1/$2`您告诉它在 中查找方法`$1`，而不是索引方法。

# c# - 调试 C# 错误。访问对象内的元素

> ID：10707887
> 
> 赞同：0
> 
> 时间：2012-05-22T18:29:06.410
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-3, object

继上一个问题之后，我有以下代码：

```
 var results =
            from result in xml.Descendants(ns + "GetMetalQuoteResult")
            select new
            {
                Type = result.Element(ns + "Type").Value,
                Currency = result.Element(ns + "Currency").Value,
                Date = result.Element(ns + "Date").Value,
                Time = result.Element(ns + "Time").Value,
                Rate = (decimal)result.Element(ns + "Rate"),
                Bid = (decimal)result.Element(ns + "Bid"),
                BidTime = result.Element(ns + "BidTime").Value,
                ExpTime = result.Element(ns + "ExpTime").Value,
                DisplayTime = result.Element(ns + "DisplayTime").Value,
                DisplayDate = result.Element(ns + "DisplayDate").Value,
                Ask = (decimal)result.Element(ns + "Ask"),
                AskTime = result.Element(ns + "AskTime").Value,
            }; 
```

如何访问这些元素？

例如，如果我想访问元素“Ask”的值，为什么我不能只使用下面的代码。

```
System.Diagnostics.WriteLine(results.Ask); 
```

我是否在做一些愚蠢的错误，因为我收到以下错误

```
Error   2   'System.Collections.Generic.IEnumerable<AnonymousType#1>' does not contain a definition for 'Ask' and no extension method 'Ask' accepting a first argument of type 'System.Collections.Generic.IEnumerable<AnonymousType#1>' could be found (are you missing a using directive or an assembly reference?) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-22T18:32:26.223

我在上下文中被包裹了一会儿，但你的问题在于这`results`是一个集合，所以你不能这样做 - 你需要在集合的*一个项目*上这样做：

```
System.Diagnostics.WriteLine(results.First().Ask); 
```

我本可以选择许多其他扩展方法来执行此`First`操作，但无论如何我都会以不同的方式执行此操作，这就是一个示例。您应该首先检查您的收藏是否包含任何项目并相应地检索。

或者，为了演示，您可以循环遍历结果：

```
foreach (var result in results) {
  System.Diagnostics.WriteLine(result.Ask);
} 
```

# c# - 委托是指向函数的指针？并且还保存变量？

> ID：10707889
> 
> 赞同：1
> 
> 时间：2012-05-22T18:29:16.230
> 
> 标签：c#, delegates, parameter-passing

据我了解委托的概念，它们只是指向一个方法。然后当我感到幸运时，我可以出去调用我的代表指向的方法，对吗？

给出以下代码：

```
class Program
{
    static void Main(string[] args)
    {
        Func<MyClass> myAct = GetAct();

        Method(myAct);
    }

    private static Func<MyClass> GetAct()
    {
        MyClass obj = new MyClass()
        {
            Prop1 = 5
        };

        Func<MyClass> myAct = new Func<MyClass>(
            () =>
            {
                MyClass obj2 = new MyClass();
                MyClass2 obj3 = new MyClass2()
                {
                    Prop3 = 25,
                    Prop4 = "test"
                };

                obj2.Prop2 = ((obj.Prop1 + 5) * obj3.Prop3)
                    .ToString() + obj3.Prop4;

                return obj2;
            });
        return myAct;
    }

    static void Method(Delegate func)
    {
        GC.Collect();
        GC.WaitForPendingFinalizers();

        var result = func.DynamicInvoke();
    }
}

class MyClass
{
    public int Prop1 { get; set; }
    public string Prop2 { get; set; }
}

class MyClass2
{
    public int Prop3 { get; set; }
    public string Prop4 { get; set; }
} 
```

现在我的委托`myAct`（在本例中为 a `Func<MyClass>`）指向一个匿名函数，该函数执行一些简单的变量分配。到目前为止没有什么特别的。

我们调用委托。

一切都很顺利，正如我们预期的那样。但问题是为什么？如果委托只是简单地指向匿名方法并且垃圾收集已经完成，那么 CLR 怎么知道`obj`它的值是什么？`obj`调用函数时对存储的引用在哪里？在代表里面？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-22T18:35:54.010

您的匿名方法是在*范围内*定义的，`GetAct()`因此 CLR 使*范围*变量可用于匿名方法。

它类似于成员方法如何使用实例变量。

另外，查看使用闭包的陷阱：http: [//msmvps.com/blogs/peterritchie/archive/2010/11/03/deep-dive-on-closure-pitfals.aspx](http://msmvps.com/blogs/peterritchie/archive/2010/11/03/deep-dive-on-closure-pitfals.aspx)

# web-services - Web 应用程序中的非无状态模型？

> ID：10707890
> 
> 赞同：0
> 
> 时间：2012-05-22T18:29:19.653
> 
> 标签：web-services, machine-learning

想象一个小型机器学习 Web 应用程序：

```
users submit the subject of a news atrticle
server would tell what category(e.g. sport or politics) it belongs to
if the server answered wrongly, user can submit a correct category 
```

大多数机器学习算法必须记住它们的状态，以便它们可以逐步改进模型。每次服务器收到请求重新计算模型的效率非常低。

但是 Web 应用程序是基于无状态模型的。唯一的持久层是数据库。那么如何在 Web 应用程序中实现那些非无状态模型呢？序列化其内部状态并将其存储在数据库中的最佳实践是什么？

顺便说一句，我正在使用`Rails`，但我猜大多数 Web 框架都是无状态的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T18:33:23.003

Web 是无状态的，因此 Web 框架也是无状态的。所以你必须将状态存储在服务器的某个地方；一个好的候选者是数据库。许多网站都有大型数据库，因此将机器学习算法的许多状态也存储在数据库中应该不是问题。

# sql - 噩梦案件陈述协助pl

> ID：10707893
> 
> 赞同：0
> 
> 时间：2012-05-22T18:29:37.360
> 
> 标签：sql

```
Table 1 - Deal ID, REF NOS, Type, Papa ID

Table 2 - Deal ID, Type 
```

在一个名为 Method used 的新视图中创建一个列。设置字段的方式如下（4个条件）；

```
If Deal ID from table 1 Exists in Table 2 and Type is not Null from Table 2\. 
Set Method used to be Y

If Deal ID does not exist in Table 1 and Type does not contain 27,42 or 55 in Table 1.
Set Method used to be Y

If Papa ID is null from Table 1, and Type does not contain 27,42 or 55 in Table 1.
Set Method used to be Y

Else 

Set to N 
```

开始它并想哇！

```
create view Master as ( 

select Deal ID, REF NOS, Type, Papa ID

[Method used]=
        Case
            When

from Table 1 A 
) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T19:03:43.083

这样的事情可能会起作用（假设这些表加入 DealId）。请注意，我已从您在问题中显示的某些列名中删除了空格。

鉴于这些表：

```
CREATE TABLE #Table1 (DealId INT, RefNos VARCHAR(100), [Type] VARCHAR(100), PapaId INT);
CREATE TABLE #Table2 (DealId INT, [Type] VARCHAR(100)); 
```

查看示例：

```
WITH DealIds AS (
    SELECT DealId FROM #Table1
    UNION 
    SELECT DealId FROM #Table2
)
SELECT 
CASE 
    -- If Deal ID from table 1 Exists in Table 2 and Type is not Null from Table 2\. 
    -- Set Method used to be Y
    WHEN t1.DealId IS NOT NULL AND t2.DealId IS NOT NULL AND t2.[Type] IS NOT NULL THEN 'Y'

    -- If Deal ID does not exist in Table 1 and Type does not contain 27,42 or 55 in Table 1.
    -- Set Method used to be Y
    -- Note: it is is redundant to have the type condition if DealId is the PK.
    WHEN t1.DealId IS NULL AND t1.[Type] NOT IN (27, 42, 55) THEN 'Y'

    -- If Papa ID is null from Table 1, and Type does not contain 27,42 or 55 in Table 1.
    -- Set Method used to be Y
    WHEN t1.PapaId IS NULL AND t1.[Type] NOT IN (27,42, 55) THEN 'Y'

    -- Else 
    -- Set to N
    ELSE 'N' 
END AS MethodUsed 
FROM DealIds d
LEFT JOIN #Table1 t1 ON d.DealId = t1.DealId
LEFT JOIN #Table2 t2 ON d.DealId = t2.DealId 
```

# sublimetext2 - 无法运行包设置：

> ID：10707896
> 
> 赞同：19
> 
> 时间：2012-05-22T18:29:46.750
> 
> 标签：sublimetext2

在文本中收到此错误`sublime`，想知道该怎么做。有没有办法将任何相关文件完全卸载到 ST2？我尝试卸载它并重新安装它，但这个错误仍然存​​在。我想我需要删除一些临时文件或缓存文件，有没有办法清除它们？

```
Unable to run package setup:

Traceback (most recent call last):
  File "/usr/lib/sublime-text-2/PackageSetup.py", line 165, in upgrade
    upgradePackage(pkg, pristinedir, datadir, backupdir)
  File "/usr/lib/sublime-text-2/PackageSetup.py", line 158, in upgradePackage
    os.path.join(backupdir, base), inhibitOverwrite)
  File "/usr/lib/sublime-text-2/PackageSetup.py", line 90, in upgradeArchive
    writeFile(fname, newar.read(f))
  File ".\zipfile.py", line 834, in read
  File ".\zipfile.py", line 857, in open
  File ".\zipfile.py", line 824, in getinfo
KeyError: "There is no item named u'nathos-sass-textmate-bundle-0e46064/Snippets/expression(\\u2026).tmSnippet' in the archive" 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-09-02T21:38:00.140

执行

```
sudo sublime 
```

首次

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2013-04-08T00:46:50.577

**在 Ubuntu 上：**

我尝试了 Achu 解决方案，但没有奏效。在我将文件所有者更改为我的用户后，我的 Sublime Text 2 开始工作。您必须打开终端 (ctrl+alt+t) 并输入：

```
sudo chown -R [your user name here] /home/[your user name here]/.config/sublime-text-2/ 
```

因此，例如，如果您的用户是“john”，您必须输入：

```
sudo chown -R john /home/john/.config/sublime-text-2/ 
```

希望这可以帮助。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-10-25T17:27:48.837

类似于 Victor 的回答，但更具体地说，我删除了单个文件`C:\Users\(Username)\AppData\Roaming\Sublime Text 2\ Installed Packages\Sass.sublime-package`，然后 Sublime Text 2 启动正常。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-12-20T15:16:37.997

**在 Ubuntu 上：-**

我发现这是一个权限问题。只需将权限更改为`777`

`sudo chmod 777 -R /home/user/.config/sublime-text-2/Packages/[package name]`

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-11-02T15:31:07.693

最后一行说：

```
KeyError: "There is no item named u'nathos-sass-textmate-bundle-0e46064/Snippets/expression(\\u2026).tmSnippet' in the archive" 
```

因此，在 sublime text 用户数据目录中的文件中递归搜索该对象：

```
cd ~/Library/Application\ Support/Sublime\ Text\ 2/
grep -r  nathos-sass-textmate-bundle-d6d079e *
#Result# Binary file Installed Packages/Sass.sublime-package matches 
```

然后删除有问题的文件：

```
rm -rf Installed\ Packages/Sass.sublime-package 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-11-07T16:23:39.767

我删除了一些错误的软件包，解决了我的问题。在这里执行的步骤：http: [//untroubler.com/questions/8-sublime-text-2-and-unable-to-run-package-setup](http://untroubler.com/questions/8-sublime-text-2-and-unable-to-run-package-setup)

在下面的评论后更新：

这是由于软件包安装损坏所致。在 OSX 上，转到：/Users/YOU_USER_NAME/Library/Application Support/Sublime Text 2/Installed Packages/。删除您尝试安装的软件包，它应该可以再次工作。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-05-23T20:42:41.207

我设法找到了这个包的所有相关文件并手动删除了它们。我注意到，如果我错过了某个地方的包，ST2 会根据与其相关的包重新创建一些文件夹，因此删除一些文件夹是不够的，你必须真正找到所有相关数据并将其删除。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-07-16T06:48:54.267

`sudo sublime-text`

这对我有用。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-05-18T16:21:05.103

只需将 Sublime Text 恢复为[新安装的状态即可](http://www.sublimetext.com/docs/2/revert.html)解决此问题。

Sublime Text 2 可以通过删除数据文件夹恢复到新安装的状态。根据您的操作系统，此文件夹位于：

*   OS X：~/Library/Application Support/Sublime Text 2
*   Windows：%APPDATA%\Sublime Text 2
*   Linux：~/.config/sublime-text-2

要在 Ubuntu 13.10 上恢复到新安装状态，您可以：

1.  退出崇高文本 2
2.  删除（或移动）数据文件夹，所以运行`sudo rm -rf ~/.config/sublime-text-2`
3.  启动崇高文本 2

希望这可以帮助。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2017-01-02T23:43:35.003

已经有一个与 Linux 权限相关的答案，但我发现这个问题与 Windows 安装的权限有关。我将可移植文件的安装放入“Program Files/SublimeText2”——显然，当我运行 ST2 时，它需要它没有获得的额外权限。

因此，我将 ST2 便携式安装到用户目录中的文件夹（例如，我的用户创建并维护的文件夹 - C:\dev\SublimeText2），现在一切正常。

# c# - 以编程方式更改 Windows 中的打印机首选项

> ID：10707900
> 
> 赞同：2
> 
> 时间：2012-05-22T18:29:58.850
> 
> 标签：c#, python, vb.net, command-line, printing

我编写了一个脚本，为新用户安装多台打印机。

我想更改其中一些的设置，以便它们可以在页面的两面打印。

我相信这涉及使用 printui 修改属性，但是它可能需要 VB 脚本或其他 .NET 语言（我会使用 VB、C# 或 IronPython）。

我可以向给定的打印机添加评论，但是如何选择首选项并修改它们？

伪代码如下所示：

printui.exe /n 打印机名 /??? [如何更改所需的质量]

或调用相关的 Windows API。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T23:02:09.400

您可以使用 printui 执行此操作，将打印机设置为双面打印，然后使用 printui /Ss 将设置放入文件中。浏览各种选项，即 2、7、d... 并查看哪个文件包含双工设置。

另一种方法是使用打印机 api，并使用 PRINTER_INFO_8（全局）或 PRINTER_INFO_9（用户）结构 - [MSDN 链接](http://msdn.microsoft.com/en-us/library/windows/desktop/dd162851%28v=vs.85%29.aspx)。然后使用 DEVMODE 结构将 dmDuplex 设置为双面。

首先打开打印机，完成后将其关闭：

```
[DllImport("winspool.drv", EntryPoint = "OpenPrinter", SetLastError = true)]
    internal static extern bool OpenPrinter(string pPrinterName, ref IntPtr phPrinter, PRINTER_DEFAULTS pDefault);
[DllImport("winspool.drv", EntryPoint = "ClosePrinter", SetLastError = true)]
    internal static extern int ClosePrinter(IntPtr hPrinter); 
```

使用 GetPrinter 检索当前打印机设置，并使用 SetPrinter 放回修改后的设置：

```
[DllImport("winspool.drv", CharSet = CharSet.Auto, EntryPoint = "GetPrinter", SetLastError = true)]
        internal static extern bool GetPrinter(IntPtr hPrinter, uint Level, IntPtr pPrinter, uint cbBuf, out uint pcbNeeded);
[DllImport("winspool.drv", CharSet = CharSet.Auto, EntryPoint = "SetPrinter", SetLastError = true)]
    internal static extern bool SetPrinter(IntPtr hPrinter, uint Level, IntPtr pPrinter, uint Command); 
```

实际执行此操作的代码应类似于：

```
var oldPrinter = printerFunctions.OpenPrinterHandle(String.Format(@"{0}\{1}", oldServerName, oldPrinterName));
var printerInfo8 = printerFunctions.GetPrinterInfo<PRINTER_INFO_8>(oldPrinter, 8);

// Change the dmDuplex value here.

printerFunctions.SetPrinter(oldPrinter, printerInfo8, 8);
printerFunctions.ClosePrinterHandle(oldPrinter);

public IntPtr OpenPrinterHandle(string printerName)
{
    var def = new PRINTER_DEFAULTS { pDatatype = null, pDevMode = IntPtr.Zero, DesiredAccess = OpenPrinterAccessCodes.PRINTER_ALL_ACCESS };
    var hPrinter = IntPtr.Zero;
    if (!PrinterNativeMethods.OpenPrinter(printerName, ref hPrinter, def))
    {
        var lastWin32Error = new Win32Exception(Marshal.GetLastWin32Error());
        Logger.Log("Failed open Printer: " + lastWin32Error.Message);
        throw lastWin32Error;
    }
    return hPrinter;
}

public void ClosePrinterHandle(IntPtr hPrinter)
{
    PrinterNativeMethods.ClosePrinter(hPrinter);
}

public void SetPrinter<T>(IntPtr hPrinter, T printerInfo, uint level)
{
    var size = (uint)Marshal.SizeOf(printerInfo);
    var printerInfoPtr = Marshal.AllocHGlobal((int)size);
    Marshal.StructureToPtr(printerInfo, printerInfoPtr, true);
    var result = PrinterNativeMethods.SetPrinter(hPrinter, level, printerInfoPtr, 0);
    if (!result)
    {
        var win32Error = Marshal.GetLastWin32Error();
        var lastWin32Error = new Win32Exception(win32Error);
        Logger.Log("Failed set printer: " + lastWin32Error.Message);
        throw lastWin32Error;
    }
    Marshal.FreeHGlobal(printerInfoPtr);
}

public T GetPrinterInfo<T>(IntPtr hPrinter, uint level)
{
    uint pcbNeeded;
    var bFlag = PrinterNativeMethods.GetPrinter(hPrinter, level, IntPtr.Zero, 0, out pcbNeeded);
    var win32Error = Marshal.GetLastWin32Error();
    if ((!bFlag) && (win32Error != PrinterNativeMethods.ERROR_INSUFFICIENT_BUFFER) || (pcbNeeded == 0))
    {
        var lastWin32Error = new Win32Exception(win32Error);
        Logger.Log("Failed get printer: " + lastWin32Error.Message);
        throw lastWin32Error;
    }

    var currentPrinterInfoPtr = Marshal.AllocHGlobal((int)pcbNeeded);
    bFlag = PrinterNativeMethods.GetPrinter(hPrinter, level, currentPrinterInfoPtr, pcbNeeded, out pcbNeeded);
    if (!bFlag)
    {
        var lastWin32Error = new Win32Exception();
        Logger.Log("Failed get printer: " + lastWin32Error.Message);
        throw lastWin32Error;
    }
    return (T)Marshal.PtrToStructure(currentPrinterInfoPtr, typeof(T));
} 
```

# c# - 使用 LINQ 2 SQL 选择随机行

> ID：10707902
> 
> 赞同：0
> 
> 时间：2012-05-22T18:30:01.133
> 
> 标签：c#, entity-framework, linq-to-sql, .net-4.0

我想知道使用 LINQ 2 SQL 从表中选择随机行的最佳方法，而我在搜索时发现了这两个问题：

[从 Linq 到 Sql 的随机行](https://stackoverflow.com/questions/648196/random-row-from-linq-to-sql)

[使用 LINQtoSQL 获取随机行](https://stackoverflow.com/questions/827199/get-a-random-row-with-linqtosql)

但我认为这不是最好和最快的方法，根据 msdn 的说法，使用 NewID() 是随机选择行的坏方法，并且在这篇文章中：

[http://msdn.microsoft.com/en-us/library/cc441928.aspx](http://msdn.microsoft.com/en-us/library/cc441928.aspx)

他们提出了另一个比 NewID 方法更快的查询：

```
 SELECT * FROM Table1
  WHERE (ABS(CAST(
  (BINARY_CHECKSUM(*) *
  RAND()) as int)) % 100) < 10 
```

这个查询背后的基本思想是，他们想为表中的每一行生成一个 0 到 99 之间的随机数，然后选择所有那些随机数小于指定百分比值的行

但是当我尝试使用 LINQ 执行此操作时，我找不到与 BINARY_CHECKSUM 等效的

那么它们是 LINQ 中 BINARY_CHECKSUM 的等价物吗？

它真的是随机选择行的最快方法吗？（如果你能帮我把它转换成 LINQ 代码，对我来说会容易得多）

感谢您的帮助

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-05-24T08:06:11.080

那样的东西会起作用吗？

```
private static readonly Random _randomInstance = new Random();
private readonly Func<int, bool> ChanceSuccess = new Func<float, bool>(f =>
    _randomInstance.Next(0, 101) <= f);

var result = from row in Table1
             where ChanceSuccess(10)
             select row; 
```

# c# - JQuery DropDown间距问题

> ID：10707910
> 
> 赞同：0
> 
> 时间：2012-05-22T18:30:36.907
> 
> 标签：c#, jquery, html, css

我在彼此下方的下拉菜单中获取一些文本时遇到问题。知道如何解决吗？

这是 HTML 和 C#

```
<ul class="dropdown">
  <li>
     <p class="MenuOverskrift">
        <a href="#">Produkter</a>
     </p>

     <ul>
        <asp:Label ID="lbl_Standard_Panel" runat="server" Text="" />
     </ul>
   </li>
</ul>

string standard_Menu = "";

        foreach (Products group in Products.GetEvereGroup(connection))
        {
            standard_Menu += "<li>" +
                "<p>" +
                group.GroupName +
                "</p>" +
                "<ul>";

            foreach (Products product in Products.GetProductsByGroup(group.GroupID, connection))
            {
                standard_Menu += "<li>" +
                    "<p>" +
                    "<a href=\"_" + product.Link + "\">" + product.ProductName + "</a>" +
                    "</p>" +
                    "</li>";
            }

            standard_Menu += "</ul>" +
                "</li>";

            lbl_Standard_Panel.Text = standard_Menu;
        } 
```

这是CSS

```
#Menu_Standard
{
position: relative;
left: 550px;
width: 100px;
}
#Menu_Standard ul li ul li p
{
    color: #9c8b5c;
}
    #Menu_Standard ul ul ul
    {
        right: 100px;
    }
        #Menu_Standard ul li ul li a
        {
            color: #9c8b5c;
            text-decoration: none;
            font-size: medium;
        }
            #Menu_Standard a
            {
                color: #9c8b5c;
                text-decoration: none;
                font-size: x-large;
            }

ul.dropdown ul
{ 
visibility: hidden;
position:relative; 
z-index:1;
width: auto;
}

ul.dropdown li:hover > ul
{ 
visibility: visible;
background-color: #373741;
filter:alpha(opacity=60);
border-radius: 15px;
padding: 5px;
} 
```

这是问题的图片 ![在此处输入图像描述](../Images/8b3ffee6f7dd1e8168a040e9ec5fae3c.png)

任何帮助，将不胜感激

通过改变可见性修复了一些问题：隐藏；显示：无；

但是悬停时问题仍然存在 ![在此处输入图像描述](../Images/5b953a7d76579e25f9257c33f514a44f.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T18:37:33.670

当`visibility: hidden`为一个元素设置属性时，该元素的不透明度为 0，请`display: none`改用。

# jquery - 使用单个 div 作为多个主干视图的容器丢失事件绑定

> ID：10707911
> 
> 赞同：5
> 
> 时间：2012-05-22T18:30:43.493
> 
> 标签：jquery, backbone.js, backbone-events

好的，所以我有一个导航和仪表板的概念。在我的路由器中，当我单击导航链接时，我正在调用我的仪表板视图来设置活动选项卡。

例如：

# 资产净值

```
<a href="#" class="dashabord_tab" id="widgets">Widgets</a>
<a href="#" class="dashabord_tab" id="Foobars">Foobars</a> 
```

# dashboard_container.jst.tpl

```
<div id="nav"></div>
<div id="current_tab"></div> 
```

# 仪表板视图

```
DashboardView = Backbone.View.extend({
  template:JST.dashboard_container,
  render: function(){
    $(this.el).html(this.template());
  },
  activateWidgets: function(){ 
    if(!(this.widgets_view)){
      this.widgets_view = new WidgetsView();
      this.widgets_view.render();
    }
    $(this.el).find("#current_tab").html(this.widgets_view.el);
  }, 
  activateFoobars: function(){ 
    if(!(this.foobars_view)){
      this.foobars_view = new FooBarsView();
      this.foobars_view.render();
    }
    $(this.el).find("#current_tab").html(this.foobars_view.el);
  }
}); 
```

# 问题：

因此，当我第一次切换到 widgets_tab 或 foobar_tab 时，选项卡会按预期加载。但是，如果我切换到一个选项卡，退出它，然后切换回它，我视图中的所有事件都不再绑定。单击，悬停，例如 foobars_view 内的所有视图都不是可单击、可悬停等。

过去，我一直在为每个子视图制作一个包装器，如下所示：

# 过去的解决方案，皮塔：

```
activateFoobars: function(){ 
    $('.tab_wrapper').hide();
    if($(this.el).find("#foobars_wrapper").length < 1){
      $(this.el).append("<div class='tab_wrapper' id='foobars_wrapper'></div>");
      this.foobars_view = new FooBarsView();
      $(this.el).find("#foobars_wrapper").html(this.foobars_view.render().el);
    }
  $('#foobars_wrapper').show();
  } 
```

我宁愿不按照上面显示的方式进行操作，而且我真的很喜欢将视图的 el 放在始终保持打开状态的 active_tab div 中的想法……如果我不能按照我想要的方式进行操作to，有没有替代我刚才展示的方式？谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-22T19:28:34.487

当你使用[`.html(dom_object)`](http://api.jquery.com/html/#html2)：

```
$(this.el).find("#current_tab").html(this.widgets_view.el); 
```

你实际上是这样做的：

```
$(this.el).find('#current_tab').empty().append(this.widgets_view.el); 
```

和[`empty`](http://api.jquery.com/empty/)：

> 在删除元素本身之前从子元素中删除其他构造，例如数据和事件处理程序 [避免内存泄漏]

因此，一旦您添加了`widgets_view`to`#current_tab`和 then `.html(this.foobars_view.el)`，on 上的事件就`widgets_view.el`消失了。您的`.html`通话第一次运行良好，因为没有任何内容，`#current_tab`因此没有任何事件可以解除绑定。

[`delegateEvents`](http://backbonejs.org/#View-delegateEvents)您可以通过在混合中添加简单的调用来重新绑定事件，从而使用您的“重用视图”方法：

```
activateWidgets: function(){ 
  if(!(this.widgets_view)){
    this.widgets_view = new WidgetsView();
    this.widgets_view.render();
  }
  $(this.el).find("#current_tab").html(this.widgets_view.el);
  this.widgets_view.delegateEvents(); // <--------------- you need this
} 
```

当我在这里时，您可以使用[`this.$('#current_tab')`](http://backbonejs.org/#View-dollar)代替`$(this.el).find('#current_tab')`和[`this.$el`](http://backbonejs.org/#View-%24el)代替`$(this.el)`.

演示：http: [//jsfiddle.net/ambiguous/75KuW/1/](http://jsfiddle.net/ambiguous/75KuW/1/)

请注意，上面的切换选项卡会保留元素的`<input type="text">`内容。如果您不需要这种行为，那么您最好根据需要删除和实例化视图，而不是保留所有视图并将它们换入和换出。

此外，如果您`WidgetsView`（和朋友）在其中有其他 Backbone 视图，则您必须一直调用`delegateEvents`包含的视图。在这种情况下，视图上的某种`bind_events`方法是有意义的：

```
this.widgets_view.rebind_events(); // delegateEvents() all the way down this view subtree 
```

# javascript - 每次要捕捉什么事件选择的选项可能重复：在 chrome 中选择选项元素上的 jquery 单击事件我正在使用选择标签对表格进行排序。但是，我希望每次选择选项时都会进行排序，而不仅仅是在更改选项时进行。（我正在使用 jquery）这就是为什么我认为 .change() 事件不适合这种情况。我尝试在 <option>上绑定 .click() 事件，但 chrome 不会触发这些事件。有任何想法吗？谢谢编辑：我的解决方案谢谢大家的回复。我最终使用不同的方法解决了这个问题。我添加了一</option>

> ID：10707913
> 
> 赞同：0
> 
> 时间：2012-05-22T18:30:43.757
> 
> 标签：javascript, jquery, html, select, option

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T18:44:36.877

尝试这个：

```
$('#select_box').change(function(){
   sort_using = $(this).attr('value'); // current value
   // call your sort function with this `sort_using`
   sortTable(sort_using);
});

function sortTable(foo) {
 //your code
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T19:19:33.337

每当您离开选择元素时都会触发 onblur 事件，因此如果您选择了相同的选项，它将触发它。

# php - 将垃圾邮件机器人发送到黑洞

> ID：10707924
> 
> 赞同：7
> 
> 时间：2012-05-22T18:31:24.247
> 
> 标签：php, forms, spam, spam-prevention

我的网站上有一些表格最近受到垃圾邮件机器人的攻击。我终于控制住了（不使用验证码）。

基本上，我正在检查各种标志的表格。如果检测到，我只是将他们的请求重定向到谷歌。

有没有办法将机器人重定向回它的 IP 地址，或者某种可能减慢它的无限循环，或者至少给它背后的人造成轻微的头痛？

澄清：

我已经阻止了垃圾邮件，我正在寻找一种聪明的方法来在我重定向垃圾邮件发送者后激怒他们。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T18:41:08.727

有一次我的一位老师告诉我们他们开发了一种反垃圾邮件蜜罐。这很简单，它将机器人重定向到一个动态生成的页面，其中包含一个无限循环的虚假地址。目标有两个：让他们忙碌并用不可用的电子邮件地址填满他们的数据库，从而损害垃圾邮件发送者。这只是一个想法，我不知道它是否符合您的需求，但是..值得一试^^当然，如果您能够识别它们，那么简单地删除与垃圾邮件相关的请求会更容易..

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-22T18:36:45.730

如果您可以识别这些请求，您应该阻止它们。在服务器端阻止他们的 IP 地址。

此外，此线程与 DOS 攻击有关，但可能对您有用。

[BOT/蜘蛛陷阱的想法](https://stackoverflow.com/questions/3825646/bot-spider-trap-ideas)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-22T18:38:09.813

从技术上讲，它仍然是一个验证码，但是如何在您的表单中使用静态的“一般”问题呢？

`What is the value of two plus two?`

检查您的 PHP 脚本中的该字段，以确保答案实际上是正确的。如果不是，请停止处理！

如果做不到这一点，并且如果您可以控制防火墙（和正确的日志记录），则开始丢弃来自最滥用 IP 地址的请求。但请注意，这种方法*可能*会使合法用户无法访问您的网站！

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-05-21T16:43:45.280

这是从一天到另一天为我工作的：

我设置了这个不可见的表单域，机器人用乱码填写，如果它被填写，我没有处理表单，只是返回一个成功页面。

但是这种特殊形式的帖子每天都在增长。它开始时每天有 2 个 POST 请求，最后有 20 多个请求。

所以 TL;DR 我现在在这个特定页面上发送一个**404 Not Found http 标头。**人类和浏览器没有看到不同，但据我观察，机器人首先检查了页面的可用性（HEAD 请求） - 所以表单仍然存在，但机器人如何知道他什么时候得到 404 回复？

到目前为止，这完全降低了机器人的 POST 操作。我知道此解决方案不适用于必须对好的机器人（谷歌等）可见的页面 - 但对于联系表单或登录表单，它可以正常工作。

也许可以将“好”机器人列入白名单并为每个人发送 404？

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2012-05-24T03:57:28.000

**不。**

垃圾邮件机器人会寻找明显的电子邮件和评论表单。他们不会对重定向做任何事情。您可以设置一些服务器，它是一个充满无法工作的电子邮件表单的蜘蛛陷阱。

因此，您需要自动 URL 生成机制来定义站点树，每个新 URL 都有另一个电子邮件表单。您可能希望在专用服务器上执行此操作。

但最终没有。想一想：您的小型 PHP 服务器将如何磨损僵尸或俄罗斯的 64 核垃圾邮件服务器？

我认为您甚至不了解重定向的作用。它设置了一个响应代码并说内容移到了“这里”。如果那里没有电子邮件表单，垃圾邮件机器人不会关心并且可能不会做任何事情。

如果您真的想避免垃圾邮件，请阅读此内容。你可以困住它们，但如果你要对付的是僵尸，那最终就无关紧要了。 [http://www.neilgunton.com/doc/?doc_id=8580](http://www.neilgunton.com/doc/?doc_id=8580)

# licensing - 如何将我的 FDT 5.5 许可证迁移到另一台机器/我已用完激活？

> ID：10707930
> 
> 赞同：0
> 
> 时间：2012-05-22T18:31:57.710
> 
> 标签：licensing, fdt

我有 FDT Max，我刚刚升级了我的机器。我想从一台计算机上卸载 FDT 并安装到另一台计算机上。当我在新计算机上安装 FDT 时，我被告知我的许可证已过期。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T18:31:57.837

有两种查看许可证的方式：

1.  您作为订阅的许可证。在这种情况下，您有一个重复使用的 FDT 许可证（订阅），它授予您在两台机器上授权的能力。

2.  您的许可证作为两次激活。购买独立设备时通常会出现这种情况。您可以在两台机器上激活它。

如果您有订阅许可证并且希望终止它，[请转到此处](http://fdt.powerflasher.com/subscription-interface)停止它。

如果您有订阅或一次性购买许可证并且已用完激活（例如，已经激活了 2 台机器），您需要通过 FDT 本身将其停用（参见下面的屏幕截图）。

如果这对您不起作用，例如您已经扔掉了旧计算机，请[联系销售人员](http://fdt.powerflasher.com/contact/)，他们将与您一起重置您的激活。

![在此处输入图像描述](../Images/ef3ba41bfc1d2e6af687ef80a17f6da3.png) ![在此处输入图像描述](../Images/2d9941f70060038840d5e6093f9143d0.png)

# soap - 通过 SOAP 添加多个电子邮件地址以联系 - Sugar CRM

> ID：10707932
> 
> 赞同：1
> 
> 时间：2012-05-22T18:32:00.727
> 
> 标签：soap, sugarcrm

我想通过 SOAP api 向联系人添加多个电子邮件地址，假设我从我的 php 应用程序注册了一个用户。例如，通过带有 testemail1@test.com 的注册页面，因此这将通过 set entry 和 soap set_entry 调用中的“email1”参数在 name_to_value_list 数组中创建一个新的联系人。

现在假设我更新了我的 php web 应用程序中的帐户信息。并将电子邮件地址更新为 testemail2@test.com ，所以现在，这应该将此新电子邮件地址添加到当前联系人作为主要电子邮件地址并选择退出旧电子邮件地址（因为我们可以添加多个电子邮件地址来唱联系人记录）。

在此处查看示例代码：

```
 $result = $mySoap->call('set_entry', array($session_id, 'module_name'=>'Contacts',     array(
    array("name" => 'first_name',"value" => $_POST['first_name']),
    array("name" => 'last_name',"value" => $_POST['last_name']),
    array("name" => 'email1',"value" => $_POST['email_address']),   //Emails is suppose     testemail1@test.com for first time
    array("name" => 'primary_phone_c',"value" => $primary_phone),
    array("name" => 'prefered_contact_c',"value" => $_POST['prefered_contact']),
    array("name" => 'primary_address_street',"value" => $_POST['address']),
    array("name" => 'primary_address_street_2_c',"value" => $_POST['address_2']),
    array("name" => 'primary_address_city',"value" => $_POST['address_city']),
    array("name" => 'primary_address_state',"value" => $_POST['address_state']),
    array("name" => 'primary_address_postalcode',"value" =>     $_POST['address_postalcode']),
    array("name" => 'address_country_c',"value" => $_POST['address_country']),
     ))); 
```

所以任何示例肥皂电话或任何想法，如我在 set_entry 中使用 email2 字段而不是 email1 或其他？

谢谢，达瓦尔达尔吉

# sql - SQL Server 中基于集合的循环替代方案

> ID：10707933
> 
> 赞同：1
> 
> 时间：2012-05-22T18:32:01.597
> 
> 标签：sql, sql-server, sql-server-2005, loops

我知道有几篇关于尝试在存储过程中循环 SQL Server 是多么糟糕的帖子。但我还没有完全找到我想要做的事情。我们正在使用可以在内部直接链接到 Excel 的数据连接。

我看过一些帖子，有些人说他们可以将大多数循环转换为标准查询。但是对于我的生活，我遇到了这个问题。

我需要`custID`在 38,40 类型的事件之前有订单的所有 s。但只有在事件和第一个查询中的顺序之间没有其他顺序时才获取它们。

所以有3个部分。我首先根据时间范围将所有订单（订单表）查询到临时表中。

```
Select into temp1 odate, custId from orders where odate>'5/1/12' 
```

然后我可以使用临时表在辅助表上进行内部连接，以获取可能在当前订单之前的某个时间发生的客户事件（LogEvent 表）。

```
Select into temp2 eventdate, temp1.custID from LogEvent inner join temp1 on 
temp1.custID=LogEvent.custID where EventType in (38,40) and temp1.odate>eventdate
order by eventdate desc 
```

这里的问题是，我尝试运行的查询将从第一个查询中返回每个客户的所有行，我只希望每个客户的最新数据。所以这是在客户端我会循环只得到一个事件而不是所有旧事件的地方。但由于所有查询都必须在 Excel 中运行，我无法真正循环客户端。

然后，第三步可以使用第二个查询的结果来检查事件是否发生在最新订单和任何先前订单之间。我只想要事件在订单之前的数据，并且中间没有其他订单。

```
Select ordernum, shopcart.custID from shopcart right outer join temp2 on 
shopcart.custID=temp2.custID where shopcart.odate >= temp2.eventdate and
ordernum is null 
```

有没有办法简化这一点并使其基于集合在 SQL Server 中运行，而不是我在客户端执行的某种循环？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T18:46:30.747

这是切换到基于集合的表示法的一个很好的例子。

首先，我将您的所有三个查询组合成一个查询。一般来说，只有一个查询让查询优化器做它最擅长的事情——确定执行路径。它还可以防止在多线程/多处理器机器上意外序列化查询。

关键是 row_number() 用于对事件进行排序，因此最近的事件值为 1。您将在最后的 WHERE 子句中看到这一点。

```
select ordernum, shopcart.custID
from (Select eventdate, temp1.custID,
             row_number() over (partition by temp1.CustID order by EventDate desc) as seqnum
      from LogEvent inner join
           (Select odate, custId
            from order
            where odate>'5/1/12'
           ) temp1 
           on temp1.custID=LogEvent.custID
      where EventType in (38,40) and temp1.odate>eventdate order by eventdate desc 
     ) temp2 left outer join
     ShopCart
     on shopcart.custID=temp2.custID
 where seqnum = 1 and shopcart.odate >= temp2.eventdate and ordernum is null 
```

我保留了您的命名约定，即使我认为“从顺序”应该会产生语法错误。即使不是这样，用保留的 SQL 字命名表和列也是不好的做法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T18:35:22.233

如果您使用的是较新版本的 sql server，则可以使用[ROW_NUMBER](http://msdn.microsoft.com/en-us/library/ms186734)函数。我很快就会写一个例子。

```
;WITH myCTE AS
( 
SELECT
    eventdate, temp1.custID, 
    ROW_NUMBER() OVER (PARTITION BY temp1.custID ORDER BY eventdate desc) AS CustomerRanking 
FROM LogEvent 
JOIN temp1 
    ON temp1.custID=LogEvent.custID 
WHERE EventType IN (38,40) AND temp1.odate>eventdate
)
SELECT * into temp2 from myCTE WHERE CustomerRanking = 1; 
```

这可以让您获得每个客户的最新事件，而无需循环。

此外，您可以使用[RANK](http://msdn.microsoft.com/en-us/library/ms176102)，但这会为平局创建重复，而 ROW_NUMBER 将保证您的分区没有重复的数字。

# windows - 使用 Subversion 作为我的版本控制系统时，如何执行跨浏览器测试？

> ID：10707938
> 
> 赞同：0
> 
> 时间：2012-05-22T18:32:37.590
> 
> 标签：windows, macos, svn, cross-browser, cornerstone

我最近在我的机器（macbook pro）上安装了 subversion 和 nginx 服务器。作为一个整体，我对 subversion 还很陌生，并且刚刚通过这个版本控制系统构建了一个网页，现在我面临着在所有相对现代的网络浏览器中测试它的任务。就浏览器兼容性而言，我最担心的是 Internet Explorer，为了进行测试，我需要 Windows。我通过 Virtual Box 在我的 Mac 上安装了 Windows 7，这*就是我的问题*。

根据客户的要求，我没有将刚刚创建的新页面提交到存储库。因此，据我所知，我没有用于在 IE Tester、Firefox for Windows 等中进行测试的 URL。**如何在不对存储库进行任何更改的情况下测试这个 1 页站点的浏览器兼容性？**

我可以使用 MacOS 在我的机器上轻松测试它，只需在本地输入。***** .org 并显示出来。同样，Windows 是我的问题。该项目将于本周四（2012 年 5 月 24 日）到期，非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T18:43:43.607

1) 开发和测试您的网页不同于管理您的网页源。换句话说，测试网页！= 使用 SVN。

2) 如果您实际上还不能使用 SVN - 如果您的客户没有偏好 - 那么请尝试 TortoiseSVN：

[http://scplugin.tigris.org](http://scplugin.tigris.org)

3) 请回复您对安装/使用 SVN 的任何具体问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T20:10:50.297

如果站点使用任何脚本语言，如 PHP 和/或数据库，您需要首先正确设置这些设置。如果您的网站仅包含 HTML/CSS/JS... 那么您可以通过以下任一方法访问该网站：

*   启用 Web 共享（系统偏好设置 > 共享 > Web 共享）。然后在VirtualBox的浏览器中输入显示的IP，它应该会加载。（这可能比尝试配置 nginx 更容易，尽管如果您只需输入机器的 IP，它可能会很好地加载。）

*   在 VirtualBox 中，选择您的 VM（关闭电源），设置 > 共享文件夹。添加您网站的根目录。启动 VM，然后在 VM 中浏览到它并在其中打开文件进行测试。

我当前的环境设置如下： - 带有 git 和 SVN 的本地开发机器 - 远程数据库服务器 - 远程 Web 服务器 - Web 服务器将本地开发机器的 www 文件夹安装为卷并从那里提供 PHP 页面 - 在 VM 中加载 Web 浏览器或任何其他机器。如果需要本地路由，请编辑 hosts 文件。

# radiant - 无法在生产模式下创建子页面（辐射 0.9.1）

> ID：10707942
> 
> 赞同：1
> 
> 时间：2012-05-22T18:32:55.243
> 
> 标签：radiant

我将一个辐射 cms 应用程序部署到服务器。在生产模式下创建子页面时，我收到“处理此表单时发生验证错误。请花点时间查看表单并更正任何输入错误，然后再继续”错误，即使我给出了瓷砖，slug，它在开发中工作正常模式。请帮忙。

谢谢

# iphone - 将文本绘制到 UIScrollView 中的自定义 UIView

> ID：10707947
> 
> 赞同：0
> 
> 时间：2012-05-22T18:33:20.320
> 
> 标签：iphone, objective-c, ios, uiscrollview

我有一个`UITableView`和一个`UITableCell`子类。我希望每个表格单元格都有`UIScrollView`一个自定义的`UIView`. 自定义`UIView`将包括`NSStrings`来自数组的一系列。我`UIScrollView`希望`NSStrings`在`UIView`.

我不知道如何实现自定义`UIView`并将文本绘制到视图中。

这是我之前帖子中某人的建议，我应该将字符串绘制到 custom 上`UIView`，而不是使用`UILabels`. [UITableView 滚动慢，内存泄漏问题](https://stackoverflow.com/questions/10669139/uitableview-scrolling-slow-memory-leak-issue/10669234#10669234)

我参考了 Apple 的 TableViewSuite 和 AdvancedTableCell 项目，但我无法掌握如何为我的案例实施。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T18:38:30.847

如果您不需要编辑，只需使用 UITextView 而不是 UIView 和 UILabel，您可以使用 .editing 属性将其关闭。

# postgresql - postgres 触发器检查数据

> ID：10707954
> 
> 赞同：1
> 
> 时间：2012-05-22T18:33:43.753
> 
> 标签：postgresql

我需要编写一个触发器来检查表列以查看数据是否存在。触发器需要一直运行并每小时记录一次消息。

基本上，如果找到结果，它将运行一个选择语句，然后休眠一个小时，否则记录并休眠一个小时

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T18:59:16.807

你想要的是一个预定的工作。pgAgent ：[http](http://www.pgadmin.org/docs/1.4/pgagent.html) ://www.pgadmin.org/docs/1.4/pgagent.html 创建一个每小时检查该行的作业，然后根据需要记录。

编辑添加：好奇您是否考虑编写一个 SQL 脚本，通过读取表而不是作业来动态生成日志。如果您有时间戳字段，则很有可能有一个脚本返回在该时间范围内没有相应条目的所有小时时段（假设时间戳未更新）。当您可以直接针对数据生成第二个日志时，为什么还要存储它呢？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T19:03:43.410

触发器（在 pg 和我知道的每个 dbms 中）可以在插入、更新或删除等事件之前或之后执行。您可能想要的是每小时通过[cron （如果您使用的是 unix 系统）之类的东西启动一个脚本，将您的输出重定向到日志文件。](http://en.wikipedia.org/wiki/Crontab)我多次使用这样的东西，听起来像这样（用python编写）：

```
#!/usr/bin/python

import psycopg2
try:
    conn = psycopg2.connect("dbname='"+dbmane+"' user='"+user+"' host='"+hostname+"' password='"+passwd+"'")
except:
    # Get the most recent exception
    exceptionType, exceptionValue, exceptionTraceback = sys.exc_info()
    # Exit the script and print an error telling what happened.
    logging.debug("I am unable to connect to the database!\n ->%s" % (exceptionValue))
    exit(2)

cur = conn.cursor()

query = "SELECT whatever FROM wherever WHERE yourconditions"
try:
    cur.execute(query)
except ProgrammingError:
    print "Programming error, no result produced"
result = cur.fetchone()

if(result == None):
    #do whatever you need, if result == None the data is not in your table column 
```

我过去每 10 分钟通过 cron 启动我的脚本，您可以轻松地将其配置为每小时启动一次脚本，将其输出重定向到您选择的日志文件。

如果您在 Windows 环境中工作，那么您将寻找类似 cron 的东西。我不认为触发器可以帮助您，它们仅在某些事件后触发（您可以使用触发器在每次插入后检查插入的数据是否是您想要每小时检查的数据，但它不一样，根据我的经验，通过脚本来做是最好的解决方案）

# javascript - onKeyPress 和 onKeyUp 的区别

> ID：10707955
> 
> 赞同：1
> 
> 时间：2012-05-22T18:33:45.463
> 
> 标签：javascript, web

我试图弄清楚 onKeyPress 和 onKeyUp 之间的区别。我知道 onKeyPress 发生在提交操作之前，而 onKeyUp 发生在之后。

我的问题是按下回车按钮时会发生什么？

如果我使用 onKeyPress 我的代码工作正常并且提交按钮被禁用。如果我使用 onKeyUp 它将提交它，但由于某种原因，提交按钮仍将处于活动状态。

这是代码：

```
<script type="text/javascript">
function InformUser()
{
    window.document.getElementById("loadingMessageDIV").style.display = "block";
   <%=Page.GetPostBackEventReference(btnSubmit as Control)%>
    document.getElementById("btnSubmit").disabled = true;
}

function validateTxt() {
    var input = document.getElementById("<%=txtUserName.ClientID %>").value;
    if(input.length > 0)
    {
        document.getElementById("btnSubmit").disabled = false;
    }
    else
    {
        document.getElementById("btnSubmit").disabled = true;
    }
}

</script> 
```

这是调用 validateTxt() 的文本框

```
<asp:TextBox ID="txtUserName" runat="server" Font-Size="11pt" 
                onkeyup="validateTxt()"></asp:TextBox> 
```

这是提交按钮

```
<asp:Button ID="btnSubmit" runat="server" OnClientClick="InformUser();" OnClick="btnSubmit_Click"
                            Text="Login" Font-Bold="True"/>
  <script type="text/javascript">
 document.getElementById("btnSubmit").disabled = true;
 </script> 
```

回顾一下：如果我将 onkeypress 更改为 onkeyup，我将获得捕获退格键的能力，但是当我按下 enter 时，提交按钮仍然处于活动状态。

如果我将 onkeyup 更改为 onkeypress，那么我可以按 Enter 并停用提交按钮。缺点是我无法捕捉退格键。

谢谢！

## 解决方案：

多亏了apsillers才弄清楚。

我不得不使用 onkeyup 来检查回车键

```
function validateTxt(event) {
    var input = document.getElementById("<%=txtUserName.ClientID %>").value;
    var key = event.keyCode || event.which;  
    if(input.length > 0 && key != 13)
    {
        document.getElementById("btnSubmit").disabled = false;
    }
    else
    {
        document.getElementById("btnSubmit").disabled = true;
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T18:44:56.050

*   按下键盘上的任意键时会触发 onKeyPress
*   当您释放键盘上的键时会触发 onKeyUp。如果您按下任何键并且不释放它，onKeyPress 将被触发，但不会触发 onKeyUp

可能您更愿意在表单中执行[onSubmit](http://www.w3schools.com/jsref/event_form_onsubmit.asp)验证。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-22T18:47:40.650

有趣的事实：该[`keypress`](https://developer.mozilla.org/en/DOM/window.onkeypress)事件不是任何标准的一部分，因此浏览器供应商可以自由地使其行为随心所欲。但是，按照惯例，`keypress`只会触发具有可打印表示的键。如果要捕获不可打印的按键（箭头键、控制键、退格键等），则需要`keyup`（或`keydown`）。

你不能用`onkeydown`吗？或者使用`onkeyup`并检查 Enter 键（`e.keyCode`13）？

其他注意事项：

`keypress`并且`keydown`会在按住键时重复触发，而`keyup`只会触发一次。

MDN 有一个方便的综合[键盘事件指南](https://developer.mozilla.org/en/DOM/KeyboardEvent#Processing_of_key_events)，其中包含更多信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-22T18:58:08.917

`keypress`仅适用于没有元键的字母、数字和符号
`keyup`适用于键盘上的所有键​​​​​​</p>

[在这个小提琴](http://jsfiddle.net/ranganadh/jCHf6/)中使用了 jQuery

# python - 在 Python 中通过 HTTP 请求发送 XML 的最简单方法是什么？

> ID：10707959
> 
> 赞同：2
> 
> 时间：2012-05-22T18:33:50.393
> 
> 标签：python, xml, httprequest

是否有一个首选的 python 模块可以帮助我通过 HTTP 请求发送 XML 并能够解析返回的 XML？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-22T19:44:12.250

一种方法是使用[`urllib2`](http://docs.python.org/library/urllib2.html)：

```
r = urllib2.Request("http://example.com", data="<xml>spam</xml>",
                     headers={'Content-Type': 'application/xml'})
u = urllib2.urlopen(r)
response = u.read() 
```

请注意，您必须设置 content-type 标头，否则将发送请求`application/x-www-form-urlencoded`。

如果这对您来说太复杂了，那么您也可以使用该[`requests`](http://docs.python-requests.org/en/latest/index.html)库。

对于解析响应[`lxml`](http://pypi.python.org/pypi/lxml/2.3.4)是一个很棒的库，但[`elementtree`](http://docs.python.org/library/xml.etree.elementtree.html)也可以。

# c# - WPF 应用程序在 XP 和 Win7 上以 96 DPI 的缩放比例不同

> ID：10707960
> 
> 赞同：1
> 
> 时间：2012-05-22T18:33:50.697
> 
> 标签：c#, wpf, layout, scaling

我有一个我在 Windows 7 下设计的应用程序。屏幕设置为 96 DPI。当部署到同样设置为 96 dpi 的 WinXp 计算机时，屏幕看起来会有所不同。左侧和底部还有额外的空间。下面是两个屏幕截图。我想知道是否需要将显示包装在一些 UI 工具中并更改一些属性以使其看起来一致。我尝试添加 UseLayoutRounding="true" 但它似乎没有做太多。

# 它应该是什么样子（Win7）

![在此处输入图像描述](../Images/e0befcc9a2c22c525b68806135db6531.png)

# XP下的样子

![在此处输入图像描述](../Images/5385c098145191d5d2a7eb4d736833b3.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T21:55:50.263

看起来您在对话框中使用了固定大小，而不是让 WPF 布局引擎使用网格等处理它。例如，查看延迟标签，我猜它们是固定大小的，当在 XP 上使用不同的字体时，标签不会像在普通 WPF 应用程序中那样增长。

# matlab - 读取文本文件并以 3D 形式绘制

> ID：10707962
> 
> 赞同：0
> 
> 时间：2012-05-22T18:33:58.570
> 
> 标签：matlab, 3d

我想读入一个包含一些字符串但主要是数字的文本文件。我希望能够忽略字符串，只看数字。我想在 3D 平面上绘制这些值。数据如下所示：

```
Tech4:<152.266724,173.189377,27.995975> 
<117.880638,156.116531,27.999983> 
<129.849899,59.195660,27.999983> 
<249.321121,60.605404,27.999983>  
<224.120361,139.072739,28.000668> 
<171.188950,143.490921,56.933430> 
<171.188950,143.490921,83.548088>
<171.188950,143.490921,27.999985> 
```

我相信读取文件只是：

```
File = textread('testFile.txt'); 
```

我怎样才能只查看这些值然后绘制它。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T18:46:31.267

```
fid = fopen([pathname,filename]);

tline = fgetl(fid);

CX = [];
CY = [];
CZ = [];

while ischar(tline)
    % skip < and >
    tline = substr(tline, 1, length(tline)-2)

    % extract numbers
    temp = textscan(tline,'%n%n%n', 'delimiter',',');

    CX(end+1,:) = [temp(1)];
    CY(end+1,:) = [temp(2)];
    CZ(end+1,:) = [temp(3)];

    tline = fgetl(fid);
end

fclose(fid); 
```

然后使用 plot3(CX, CY, CZ) 绘制它

函数调用。

在开头添加对“Tech4：”的检查......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T19:36:15.563

我认为您也可以直接在单行中使用[textscan](http://www.mathworks.nl/help/techdoc/ref/textscan.html)：

~~fid = fopen('testFile.txt');
data = textscan(fid,'%*s%f,%f,%f');
fclose(fid);~~

这会将具有指定格式的所有行中的值加载到变量`data`中。虽然没有matlab来测试它。

[fscanf](http://www.mathworks.nl/help/techdoc/ref/fscanf.html)是一个选项，与 textscan 相同类型的参数。

**编辑**：错字，您当然要检测浮点数（％f），而不是整数（％d）

**EDIT2**：得到matlab并对其进行测试，这适用于您的示例输入^^

```
fid = fopen('testFile.txt');
data = textscan(fid,'%*s%f%f%f','Delimiter',',<>')
fclose(fid); 
```

# asp.net-mvc-3 - Firefox 在 location.reload 后一直要求 NT 登录

> ID：10707969
> 
> 赞同：1
> 
> 时间：2012-05-22T18:34:22.940
> 
> 标签：asp.net-mvc-3, model-view-controller

我有一个使用 MVC-3 的 Web 应用程序，它使用用户的 NT 登录来验证应用程序的用户。对于 IE 的用户，NT 登录是自动检测的，我不需要做任何事情。如果我使用 Firefox，当我第一次访问应用程序的 URL 时，它会询问我的登录凭据。每当我单击页面上的按钮（通过 Javascript 的 location.reload(true) 函数强制页面重新加载）时，它也会强制我再次登录。为什么要这样做，我该如何阻止它？

# javascript - 检测字符是否为字母

> ID：10707972
> 
> 赞同：3
> 
> 时间：2012-05-22T18:34:26.123
> 
> 标签：javascript, utf-8, character-encoding

给定一组单词，我需要将它们放在以单词的第一个字母为键的散列中。我有单词 = {}，键 A..Z 和 0 表示数字和符号。我正在做类似的事情

```
var firstLetter = name.charAt(0);
    firstLetter = firstLetter.toUpperCase();

if (firstLetter < "A" || firstLetter > "Z") {
    firstLetter = "0";
}
if (words[firstLetter] === undefined) {
    words[firstLetter] = [];
} 
words[firstLetter].push(name); 
```

但这会因分词和其他字符而失败，例如**Ärzteversorgung**一词。那个词放在“0”数组中，我怎么能把它放在“A”数组中？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-05-22T18:42:42.230

您可以使用它来测试一个字符是否*可能是*一个字母：

```
var firstLetter = name.charAt(0).toUpperCase();
if( firstLetter.toLowerCase() != firstLetter) {
    // it's a letter
}
else {
    // it's a symbol
} 
```

这是有效的，因为 JavaScript 已经有一个小写到大写字母的映射（反之亦然），所以如果一个字符没有改变，`toLowerCase()`那么它就不在字母表中。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-08-19T11:22:41.847

尝试将字符转换为大写和小写，并检查是否有区别。只有字母字符在转换为各自的大小写时会发生变化（数字、标点符号等不会）。下面是一个使用这个概念的示例函数：

```
function isALetter(charVal)
{
    if( charVal.toUpperCase() != charVal.toLowerCase() )
       return true;
    else
       return false;
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-22T18:45:54.553

您可以使用正则表达式。不幸的是，JavaScript 不认为国际字符是“单词字符”。但是你可以使用下面的正则表达式来做到这一点：

```
var firstLetter = name.charAt(0);
firstLetter = firstLetter.toUpperCase();
if (!firstLetter.match(/^\wÀÈÌÒÙàèìòùÁÉÍÓÚÝáéíóúýÂÊÎÔÛâêîôûÃÑÕãñõÄËÏÖÜäëïöüçÇßØøÅåÆæÞþÐð$/)) {
    firstLetter = "0";
}
if (words[firstLetter] === undefined) {
    words[firstLetter] = [];
} 
words[firstLetter].push(name); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-22T18:44:29.550

您可以使用`.charCodeAt(0);`获取 ASCII 图表中的位置，然后进行一些检查。

您要查找的范围可能是 65-90、97-122、128-154、160-165（含），但请通过查看[ASCII 图表仔细检查](http://www.cdrummond.qc.ca/cegep/informat/Professeurs/Alain/files/ascii.htm)

像这样的东西

```
if((x>64&&x<91)||(x>96&&x<123)||(x>127&&x<155)||(x>159&&x<166)) 
```

`x`字符代码在哪里

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-03-24T08:17:53.750

幸运的是，这在没有外部库的情况下现在是可能的。直接来自[文档](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions/Unicode_Property_Escapes)：

```
let story = "It’s the Cheshire Cat: now I shall have somebody to talk to.";

// Most explicit form
story.match(/\p{General_Category=Letter}/gu);

// It is not mandatory to use the property name for General categories
story.match(/\p{Letter}/gu); 
```

# android - Android中webviews的页面卷曲效果

> ID：10707973
> 
> 赞同：5
> 
> 时间：2012-05-22T18:34:28.850
> 
> 标签：android, webview, page-curl

我正在开发一个项目，我需要在滑动时在不同的 Webview 之间进行更改。我想在每次滑动时对 webview 应用页面卷曲动画，即，当我们在 webview 上滑动时，它应该卷曲并且应该显示下一个 webview。谁能帮我解决这个问题。

非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-29T15:34:36.880

这是不可能的（asfaik）。[这里](https://stackoverflow.com/questions/12051744/how-to-do-curl-effect-on-html-pages-instead-of-image-in-android)有一个类似的帖子，他们建议使用 javascript，但它似乎只适用于 iOS。也就是说，您可以尝试拍摄屏幕图像并将其作为 webview 的叠加层，然后在图像上使用 page curl。

# android - 在android中的鼠标触摸

> ID：10707975
> 
> 赞同：-1
> 
> 时间：2012-05-22T18:34:34.937
> 
> 标签：android

哪个函数用于跟踪 Android 中的所有用户交互？

我已经使用了该`onuserinteraction()`功能，但这不包括触摸鼠标。它包括单击鼠标或任何键事件。

那么是否有任何功能也可以跟踪触摸鼠标？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T18:56:51.350

看看这些链接：

[View.OnTouchListener](http://developer.android.com/reference/android/view/View.OnTouchListener.html)

[学习Android教程1.32——Android的OnTouchListener和MotionEvent](http://www.mybringback.com/tutorial-series/3279/android-the-basics-32-androids-ontouchlistener-and-motionevent/)

我希望这可以帮助你...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T19:02:54.513

我不认为android有“鼠标”。你只能使用 onClick 监听器。

# java - 了解 for 循环和 if 条件

> ID：10707976
> 
> 赞同：0
> 
> 时间：2012-05-22T18:34:41.403
> 
> 标签：java, for-loop

下面是我无法理解的代码。输出为 13 15 x=6。我理解我们如何获得数字 13，因为当我们通过循环时，x 的值为 5，其对应的 y 值为 12。因此，如果 x > 4，我们将增加 y，从而为 u 提供 13 的值。打印下一个数字out 那么应该是 14，因为 x 的下一个值是 6，其对应的 y 值是 13，所以当你增加它时，它将是 14。但是当我运行代码时，它给出了不同的答案。有人可以帮忙吗？谢谢

```
public class Output {
  public static void main(String[] args) {
    Output o = new Output();
    o.go();
  }

  void go() {
    int y = 7;
    for (int x = 1; x < 8; x++) {
        y++;
        if (x > 4) {
            System.out.print(++y + " ");
        }
        if (y > 14) {
            System.out.println(" x = " + x);
            break;
        }
    }
  }
}  ​ 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-22T18:40:11.457

原因是 ++y 在打印之前增加了 y。

y++ 会做你所期望的

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T18:46:19.503

正如你所说，当进入循环迭代 where `x`is `6`，`y`is时。`13`然后`y`立即递增到`14`。 `x`大于`4`，所以`System.out.print(++y + " ");`被执行。 在打印之前`++y`递增。`y``15`

# c# - 地质定位及应用类型建议

> ID：10707978
> 
> 赞同：0
> 
> 时间：2012-05-22T18:34:54.673
> 
> 标签：c#, service, geolocation, ip-geolocation, w3c-geolocation

我正在尝试使用 c# 制作一个程序，该程序将允许我使用地理定位服务确定我的计算机所在的位置。我想知道您对 geolocatio API 的建议是什么，以及您是否认为我应该只创建一个后台进程或 Windows 服务，或者是否有可能将其作为服务。我听说过 w3c、google、windows 和 skyhook 的一个。我希望能够从中确定一个地址，我也希望该服务是免费的（即使它每天只进行几次查找。

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T19:03:26.703

我不太清楚您为什么要询问后台进程或 Windows 服务。您的应用程序将无法从 google 等服务获取计算机的位置。

我建议您安装适用于 Windows 7 的 Geosense 驱动程序以添加位置驱动程序（请参阅[http://geosenseforwindows.com/](http://geosenseforwindows.com/)）然后我会使用诸如位置和传感器互操作库之类的东西来查询该传感器以找到计算机的粗略位置. （参见[http://archive.msdn.microsoft.com/SensorsAndLocation/Release/ProjectReleases.aspx?ReleaseId=2359](http://archive.msdn.microsoft.com/SensorsAndLocation/Release/ProjectReleases.aspx?ReleaseId=2359)）

如果那不是您我们想要做的；请提供更多信息。

# jquery - jquery 验证 - addMethod/remote - json 响应中的错误消息

> ID：10707981
> 
> 赞同：3
> 
> 时间：2012-05-22T18:35:05.420
> 
> 标签：jquery, json, jquery-validate

我正在尝试使用远程方法，或者添加一个模仿远程方法的方法，以便能够将输入的数据发送到 Web 服务并返回带有错误状态和错误消息的 json 响应。

所以我有这个json响应：

```
{
    "isError": "true",
    "errorMessage": "The User Name you chose is already in use. Please enter another name."
} 
```

我已经使用远程方法来获得真/假响应，但没有额外的数据。

任何帮助，将不胜感激。

**编辑**

试过这个，但当然它没有工作，因为变量不是全局变量......

```
$.validator.addMethod("uniqueUserName", function(value, element) {

      $.ajax({
        type: "POST",
         url: "js/username.json",
         contentType: "application/json; charset=utf-8",  
        dataType:"json",
        data: "{'" + $('#enterEmail').attr('id') + "': '" + $('#enterEmail').val() + "'}", 
        dataFilter: function(data) {
            var isError = data.isError;
            var uniqueError = data.errorMessage;
            if(isError == "true"){
                return false;
            }
        }

     })

}, uniqueError); //this last line would typically be: }, "my error message"); 
```

见小提琴：http: [//jsfiddle.net/jasonday/fWk5u/](http://jsfiddle.net/jasonday/fWk5u/)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-25T13:09:58.203

我最终弄清楚了。返回成功是我失败的原因——我一直在返回、返回 true 或返回 false——它们中的每一个都会“失败”验证。

```
remote: {
    type: "POST",
    url: "js/username.json",
    contentType: "application/json; charset=utf-8",  
    dataType:"json",
    data: "{'" + $('#enterEmail').attr('id') + "': '" + $('#enterEmail').val() + "'}",
    dataFilter: function(data) {
        var json = JSON.parse(data);
        if(json.isError == "true") {
            return "\"" + json.errorMessage + "\"";
        } else {
            return success;
        }

    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T21:13:31.040

看看[有效值](http://validval.frebsite.nl/usage.php)。

[我发现它很容易集成、调整（自定义验证、自定义警报），并且像这里](http://validval.frebsite.nl/examples.php)一样将它放入 AJAX

**编辑**
那么您将数据对象发布到哪里？**js/username.json**是做什么的？如果你在那里发帖，你必须在那里做一些事情才能以你想要的格式返回对象。

因此，如果您想检查唯一的电子邮件，我将发布到服务器，在那里进行检查，构造一个对象

```
 object.response.success = true/false
 object.response.data = "some text to display" 
```

然后通过 AJAX 返回 object.response。

像这样：

```
 $.ajax({
      async: false,
      type: "post",
      url: "somewhere_to_handle_username_check",    
      data: data: "{'" + $('#enterEmail').attr('id') + "': '" + $('#enterEmail').val() + "'}",
      contentType: "application/json; charset=utf-8",
      dataType: "json",
      // AJAX OK, return true/false
      success: function(objResponse){
           if (objResponse = "true"){
                alert("success");
            } else {
                alert("failed, username already taken");
            }
      // AJAX Failed
      error: function () { 
        alert("failed - AJAX failed");
        }
    }); 
```

我通常验证客户端，输入电子邮件地址（使用上面的验证），然后将电子邮件地址发送到服务器以检查值并构造响应对象。

希望这可以帮助。如果没有，请告诉我您的 AJAX 请求应该做什么以及 js/username.json 做什么。

# ruby-on-rails - Rspec 1.3.4 中的响应对象与 Capybara

> ID：10707984
> 
> 赞同：1
> 
> 时间：2012-05-22T18:35:11.583
> 
> 标签：ruby-on-rails, rspec, capybara

我正在尝试使用以下测试来查看登录表单是否正确重定向：

```
 it "should allow you to login" do
    visit "/"
    fill_in 'Email', :with => 'admin@example.com'
    fill_in 'Pass', :with => 'password'
    click_button 'Login'
    response.should be_redirect
end 
```

但是，rspec 失败并显示响应不存在的消息。我正在运行一个 rails 2.3.4 应用程序，所以我安装了 rspec 1.3.4。如何测试响应？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T20:26:48.780

我认为您需要询问 Capybara 而不是 rails 测试助手。

```
session.status_code.should == "301"  # or 302 
```

应该这样做。

看看这里的例子：

[http://rubydoc.info/github/jnicklas/capybara/master/Capybara/Session#status_code-instance_method](http://rubydoc.info/github/jnicklas/capybara/master/Capybara/Session#status_code-instance_method)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T20:21:26.720

我假设这是一个集成规范（RSpec 在版本 2 中称之为“请求规范”）？如果是这样，则响应对象不可用。为此，您需要一个控制器规范，例如：

```
describe MyController do
  it "should redirect" do
    post :some_path, {:email => 'admin@example.com', :pass => 'password'}
    response.should be_redirect
  end
end 
```

或者在您的集成规范中，在成功重定向后测试预期路径。这适用于 RSpec 2，不确定 RSpec 1：

```
current_path.should == "/some_path" 
```

# java - 无法将 Java Web 服务部署到 Glassfish

> ID：10707990
> 
> 赞同：0
> 
> 时间：2012-05-22T18:35:49.383
> 
> 标签：java, web-services, netbeans, glassfish, jax-ws

我正在尝试向 Glassfish 部署一个简单的 Web 服务。这是网络服务类：

```
import com.dv.testrunner.extended.Task;
import com.medallion.etl.exception.StepExecutionException;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.jws.WebMethod;
import javax.jws.WebParam;
import javax.jws.WebService;

/**
 *
 * @author dvargo
 */
@WebService(serviceName = "Execute")
public class Execute
{
    /**
     * Web service operation
     */
    @WebMethod(operationName = "executeTask")
    public boolean executeTask(@WebParam(name = "task") Task task)
    {
        boolean setUp = task.setUp();
        boolean execute;
        try
        {
            execute = task.execute();
        }
        catch (StepExecutionException ex)
        {
            Logger.getLogger(Execute.class.getName()).log(Level.SEVERE, null, ex);
            return false;
        }
        return setUp && execute;
    }
} 
```

任务是一个简单的界面。这是界面：

```
package com.dv.testrunner.extended;

import com.medallion.etl.exception.StepExecutionException;

/**
 *
 * @author dvargo
 */
public interface Task
{

    public boolean execute() throws StepExecutionException;

    public boolean setUp();

} 
```

当我尝试通过 Netbeans 部署我的 Web 服务时，我收到以下错误：

```
java.lang.Exception: java.lang.IllegalStateException: ContainerBase.addChild: start: org.apache.catalina.LifecycleException: java.lang.RuntimeException: Servlet web 服务端点''失败
    在 com.sun.enterprise.web.WebApplication.start(WebApplication.java:138)
    在 org.glassfish.internal.data.EngineRef.start(EngineRef.java:130)
    在 org.glassfish.internal.data.ModuleInfo.start(ModuleInfo.java:269)
    在 org.glassfish.internal.data.ApplicationInfo.start(ApplicationInfo.java:294)
    在 com.sun.enterprise.v3.server.ApplicationLifecycle.deploy(ApplicationLifecycle.java:462)
    在 com.sun.enterprise.v3.server.ApplicationLifecycle.deploy(ApplicationLifecycle.java:240)
    在 org.glassfish.deployment.admin.DeployCommand.execute(DeployCommand.java:382)
    在 com.sun.enterprise.v3.admin.CommandRunnerImpl$1.execute(CommandRunnerImpl.java:355)
    在 com.sun.enterprise.v3.admin.CommandRunnerImpl.doCommand(CommandRunnerImpl.java:370)
    在 com.sun.enterprise.v3.admin.CommandRunnerImpl.doCommand(CommandRunnerImpl.java:1064)
    在 com.sun.enterprise.v3.admin.CommandRunnerImpl.access $1200(CommandRunnerImpl.java:96)
    在 com.sun.enterprise.v3.admin.CommandRunnerImpl$ExecutionContext.execute(CommandRunnerImpl.java:1244)
    在 com.sun.enterprise.v3.admin.CommandRunnerImpl$ExecutionContext.execute(CommandRunnerImpl.java:1232)
    在 com.sun.enterprise.v3.admin.AdminAdapter.doCommand(AdminAdapter.java:459)
    在 com.sun.enterprise.v3.admin.AdminAdapter.service(AdminAdapter.java:209)
    在 com.sun.grizzly.tcp.http11.GrizzlyAdapter.service(GrizzlyAdapter.java:168)
    在 com.sun.enterprise.v3.server.HK2Dispatcher.dispath(HK2Dispatcher.java:117)
    在 com.sun.enterprise.v3.services.impl.ContainerMapper.service(ContainerMapper.java:238)
    在 com.sun.grizzly.http.ProcessorTask.invokeAdapter(ProcessorTask.java:828)
    在 com.sun.grizzly.http.ProcessorTask.doProcess(ProcessorTask.java:725)
    在 com.sun.grizzly.http.ProcessorTask.process(ProcessorTask.java:1019)
    在 com.sun.grizzly.http.DefaultProtocolFilter.execute（DefaultProtocolFilter.java:225）
    在 com.sun.grizzly.DefaultProtocolChain.executeProtocolFilter(DefaultProtocolChain.java:137)
    在 com.sun.grizzly.DefaultProtocolChain.execute（DefaultProtocolChain.java:104）
    在 com.sun.grizzly.DefaultProtocolChain.execute（DefaultProtocolChain.java:90）
    在 com.sun.grizzly.http.HttpProtocolChain.execute(HttpProtocolChain.java:79)
    在 com.sun.grizzly.ProtocolChainContextTask.doCall(ProtocolChainContextTask.java:54)
    在 com.sun.grizzly.SelectionKeyContextTask.call(SelectionKeyContextTask.java:59)
    在 com.sun.grizzly.ContextTask.run(ContextTask.java:71)
    在 com.sun.grizzly.util.AbstractThreadPool$Worker.doWork(AbstractThreadPool.java:532)
    在 com.sun.grizzly.util.AbstractThreadPool$Worker.run(AbstractThreadPool.java:513)
    在 java.lang.Thread.run(Thread.java:680)

```

有没有人对正在发生的事情以及我如何解决它有任何想法？是不是我不能使用 Task 作为参数？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T18:58:28.257

JAX-WS 不允许接口作为方法参数。尝试用类替换任务。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T18:45:12.553

不仅 JAX-WS 不允许接口，甚至在您的情况下也没有任何意义。你将如何指定任务应该做什么？您需要一个具体的类作为参数，并且该类需要用`@XmlRootElement`. 如果您希望您的端点支持不同的任务，您将需要更多具有不同名称的操作来实现这一点。

# c# - 使用数据绑定控件获取当前页面的 HTML 内容

> ID：10707993
> 
> 赞同：1
> 
> 时间：2012-05-22T18:35:54.960
> 
> 标签：c#, asp.net, repeater

我正在尝试创建一个将其所在页面转换为 PDF 的控件。

```
protected void ConvertPageToPDF_click(object sender, EventArgs e)
{
    string pageHtml;
    byte[] pdfBytes;

    string url = HttpContext.Current.Request.Url.AbsoluteUri;

    // get the HTML for the entire page into pageHtml
    HtmlTextWriter hw = new HtmlTextWriter(new StringWriter());
    this.Page.RenderControl(hw);
    pageHtml = hw.InnerWriter.ToString();

    // send pageHtml to a library for conversion
    // send the PDF to the user
} 
```

这部分有效。在我的页面上，我有几个转发器；他们的内容没有出现在`pageHtml`. 关于为什么会这样的任何想法？我应该如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-14T13:50:33.147

事实证明，我必须在数据绑定到控件后渲染控件。我的 click 方法只是添加了一个事件处理程序：

```
protected void ConvertRepeaterToPDF_click(object sender, EventArgs e)
{
    // handle the PreRender complete method
    Page.PreRenderComplete += new EventHandler(Page_OnPreRenderComplete);
} 
```

然后在 Page_OnPreRenderComplete 中我可以像上面一样使用 RenderControl。

# hyperlink - 获取维基百科的原始链接？

> ID：10707997
> 
> 赞同：1
> 
> 时间：2012-05-22T18:36:33.137
> 
> 标签：hyperlink, wikipedia, wikipedia-api

我有一些维基百科文章的链接，例如：[https](https://en.wikipedia.org/wiki/Steve_jobs) ://en.wikipedia.org/wiki/Steve_jobs当您访问该链接时，您会在文章标题下方看到：`(Redirected from Steve jobs)`如果您点击该链接，您最终会到达一个页面具有相同的 URL，除了 Steve_jobs 有一个大写的 J 来表示工作。所以它看起来像这样：[https ://en.wikipedia.org/wiki/Steve_Jobs](https://en.wikipedia.org/wiki/Steve_Jobs)

有没有办法可以使用第一个链接检索后一个链接？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T19:28:00.260

您可以通过 API 查询找出某个标题重定向到的位置，例如：

[http://en.wikipedia.org/w/api.php?action=query&titles=Steve%20jobs&redirects](http://en.wikipedia.org/w/api.php?action=query&titles=Steve%20jobs&redirects)

如果您想要 XML 格式的结果，请添加`&format=xml`到 URL 或`&format=json`JSON。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T20:23:09.917

只需使用[查询 api](http://www.mediawiki.org/wiki/API%3aQuery)。通过[http://en.wikipedia.org/w/api.php?action=query&titles=Steve+jobs|steve+jobs|steve+Jobs|Steve+Jobs&redirects](http://en.wikipedia.org/w/api.php?action=query&titles=Steve+jobs|steve+jobs|steve+Jobs|Steve+Jobs&redirects)，您将获得标准化和重定向的标题。有关更多选项，尤其是[格式](http://www.mediawiki.org/wiki/API%3aData_formats)，请参阅[api 文档](http://www.mediawiki.org/wiki/API%3aMain_page)。