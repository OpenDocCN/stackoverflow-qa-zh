# StackOverflow 问答 000175000-000175999

# css - 如何自定义 SharePoint 列表项的打印布局？

> ID：175036
> 
> 赞同：4
> 
> 时间：2008-10-06T16:26:00.113
> 
> 标签：css, sharepoint, printing, moss, sharepoint-designer

我需要能够生成单个列表项值的“漂亮”打印输出，目标是：

*   摆脱所有导航
*   组织数据，就像它出现在典型的纸质表格上一样（客户要求）

由于其他问题，我目前避免使用 InfoPath（我将针对这些问题发布单独的问题......）

**例如**，我有一个单独的列表项，通常显示类似于以下`DispForm.aspx` *示例*：

![SharePoint - DispForm.aspx](https://farm4.static.flickr.com/3025/2919055776_bec7d520c9_o_d.png "SharePoint - DispForm.aspx")

我需要一个打印版本 ( *`PrintForm.aspx`*??)，其显示类似于以下*示例*：

![SharePoint - PrintForm.aspx](https://farm4.static.flickr.com/3101/2918303785_ddfb28d32e_o_d.png "SharePoint - PrintForm.aspx")

据我所知，我不能仅仅通过修改/创建自定义 CSS 来做到这一点。

似乎我不能仅仅通过创建自己的“打印”版本来做到这一点`DispForm.aspx`。

任何建议、想法、链接都会非常有帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-07T12:24:09.540

创建自定义列表表单可能是您想要的。没有附加到它的母版页或任何东西。

您可以在此处找到可以帮助您入门的演练：

[http://office.microsoft.com/en-us/sharepointdesigner/HA101191111033.aspx](http://office.microsoft.com/en-us/sharepointdesigner/HA101191111033.aspx)

享受。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-06T16:46:36.907

您可以使用 CSS 来隐藏您不需要使用`media="print"`样式表的所有导航等，但您将无法对您所说明的布局进行确切的更改。

如果它不必与示例完全相同，那么隐藏除 name->value 表之外的所有表并打印它是相当简单的。如果您确实需要合并字段并重新布局表格，那么您可能不得不破坏服务器端。

为什么不能创建自己的页面版本？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-06T17:30:04.680

使用 Sharepoint Designer，您可以创建一个自定义 aspx 页面，该页面使用 dataview webpart 来执行此操作...

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-08T19:38:27.527

@mortenbpost 的链接正是我所需要的： [创建一个包含自定义列表表单的新页面](http://office.microsoft.com/en-us/sharepointdesigner/HA101191111033.aspx#2 "创建一个包含自定义列表表单的新页面")

具体来说，您需要执行以下操作才能获得列表项的“基本”自定义页面——从中您可以使用 XHTML/CSS 完全自定义它：

## 第一的

确保您的列表包含您需要的所有列

## 第二

以下是创建自定义“查看”页面的方法（对于自定义“新建”或自定义“编辑”页面，几乎可以遵循相同的步骤）：

1.  打开 MS Office SharePoint 设计器
2.  文件 -> 打开站点...
3.  *输入您的网站 URL*
4.  确保“文件夹列表”任务窗格可见（任务窗格 -> 文件夹列表）
5.  **展开“列表”文件夹**
6.  您应该看到如下条目：`Announcements`
    `Calendar`
    ……
    `*YOUR LIST NAME*`
    _

7.  *使用您的列表名称*展开条目
8.  *您应该会看到类似以下的条目`Attachments`
    `Items`
    `AllItems.aspx`
    `DispForm.aspx`
    `EditForm.aspx`
    `NewForm.aspx`* 
9.  ***右键单击*您的列表名称****
10.  ***选择新建**-> **ASPX***
11.  *将文件重命名为有意义的名称，例如：*PrintForm.aspx**
12.  *打开*PrintForm.aspx**
13.  *以“拆分”模式查看*
14.  *在“代码”窗格中，您应该会在空白 html 表单中看到插入点*
15.  ***插入 -> SharePoint 控件 -> 自定义列表表单...***
16.  *从第一个下拉列表中选择*您的列表名称*（用于表单的列表或文档库）*
17.  *从第二个下拉列表中选择“项目”（用于表单的内容类型）*
18.  *选择“显示项目表单（用于查看列表项）”（*这是您在**查看**、**新建**、**编辑***之间进行选择的地方）*
19.  *创建可打印表单时取消选中“显示标准工具栏”*
20.  *点击确定*
21.  *在“设计”窗格中，您应该会看到一个基本的表格布局，左侧是标签，右侧是值*
22.  *在“代码”窗格中，您应该为列表中的每一列看到如下代码（这是“单行文本”列类型）：

    ```
    <tr>
        <td width="190px" valign="top" class="ms-formlabel">
            <H3 class="ms-standardheader">
                <nobr>***Column name***</nobr>
            </H3>
        </td>
        <td width="400px" valign="top" class="ms-formbody">
            <xsl:value-of select="@***Column_x0020_name***"/>
        </td>
    </tr>
    ```* 
23.  *您现在可以获取所有这些条目并进行标准 XHTML/CSS 布局 `<xsl:value-of select="@***Column_x0020_name***"/>`*
24.  *要测试，请保存您的工作*
25.  *然后，在 Web 浏览器中，导航到您的 SharePoint 网站*
26.  *选择您已为其输入数据的项目*
27.  *选择“查看项目”*
28.  *在地址栏中，将*DispForm.aspx*替换为*PrintForm.aspx**

 *一些事情要记住：

*   空格和标点符号使*列名的命名很烦人*
*   *代码中的列名*的最大长度为 32 - 任何更长的名称都将被截断，例如：SharePoint 列名称：*这是代码中的长名称*
    ：`this_x0020_is_x0020_a_x0020_long`

*   代码中任何重复的*列名的长度都是 32**加上*一个数字后缀。因此，鉴于上述列也存在，我们将拥有例如：SharePoint 列名：*这是一个长名称*
    ，在代码中也变为：`this_x0020_is_x0020_a_x0020_long0`

*   如果添加列或修改列，则必须手动将它们添加到此页面（在另一个“虚拟”页面上执行*插入 -> SharePoint 控件 -> 自定义列表表单...*以获得正确的命名）

再一次，如果没有@mortenbpost 的回答，我就无法做到这一点！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-14T21:13:48.613

*****You can now just take all those entries and do standard XHTML/CSS layout *****

can you expand this with an example on how to do it?

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-06T22:13:38.163

这与其说是对上述内容的注释，不如说是一个答案。

使用自定义列表表单，但请记住，如果任何列启用了版本控制，您将无法轻松获取“数据”。例如，如果您的一个列是 Notes 列，并且每次有人编辑 notes 字段时都会附加一个新版本，那么这些都无法访问，因为它本质上是一个单独的“列表”。我被困在这个问题上，因为我还有一个客户要求打印“看起来不像来自 SharePoint”。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2008-10-07T16:33:06.293

或者，您可以导出到电子表格并从那里打印。

# asp.net - 在提交表单时禁用 2 个按钮 (ASP.NET)

> ID：175042
> 
> 赞同：2
> 
> 时间：2008-10-06T16:27:56.133
> 
> 标签：asp.net

我有一个按钮的解决方案：

```
myButton.Attributes.Add("onclick", "this.disabled=true;" + GetPostBackEventReference(myButton).ToString()); 
```

对于一个按钮来说效果很好，关于如何将其扩展到 2 个按钮的任何想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-06T16:31:51.570

您可以添加客户端 onSubmit 处理程序，或者您可以这样做：

```
myButton.Attributes.Add("onclick", "this.disabled=true; document.getElementById('" 
+ button2.ClientID + "').disabled = true;" 
+ GetPostBackEventReference(myButton).ToString()); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-06T16:35:21.810

更改 javascript 以引用另一个按钮。

```
var btn1 = document.GetElementById('btn1ID');
var btn2 = this;

btn1.disabled = true;
btn2.disabled = true; 
```

如果按钮位于命名容器中，则需要使用 .NET 对象的 ClientID 属性来获取元素的 html ID。

```
var btn1 = document.GetElementById('<%= btn1.ClientID %>'); 
```

我建议将它们包装在一个脚本标记和一个函数中，然后只需从您的 .NET 属性添加中调用该函数。

**代码隐藏**

```
btn2.Attributes.Add("onclick", "handleClick();") 
```

**ASPX**

```
<script type="text/javascript">
    function handleClick() {
        var btn1 = document.GetElementById('<%= btn1.ClientID %>');
        var btn2 = this;

        btn1.disabled = true;
        btn2.disabled = true;

    }
</script>

<asp:Button id="btn1" runat="server" text="Button 1" />
<asp:Button id="btn2" runat="server" text="Button 2" /> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-06T16:32:32.783

将命令更改为：

```
myButton.Attributes.Add("onclick", "this.disabled=true;document.getElementbyID("Button2").disabled=true;" + GetPostBackEventReference(myButton).ToString()); 
```

# python - Django开发IDE

> ID：175044
> 
> 赞同：282
> 
> 时间：2008-10-06T16:28:18.830
> 
> 标签：python, django, ide

我做了一点 Django 开发，但都在文本编辑器中。我很好奇其他人在他们的 Django 开发中使用了哪些更高级的开发工具。

我习惯于使用 Visual Studio 进行开发，并且非常喜欢它提供的[IntelliSense](https://en.wikipedia.org/wiki/Intelligent_code_completion#IntelliSense)、代码完成和文件组织，并希望找到可以在 Django/Python 环境中提供其中一些功能的东西（或工具组合）。

* * *

## 回答 #1

> 赞同：197
> 
> 时间：2010-04-15T05:34:46.383

JetBrains的[PyCharm](http://www.jetbrains.com/pycharm/index.html)支持 Django 和[Google Apps](http://en.wikipedia.org/wiki/Google_Apps)。看起来很有希望。

注意：如果您需要 Django 支持，您需要购买专业版的许可证。社区版不支持 Django。

* * *

## 回答 #2

> 赞同：111
> 
> 时间：2008-10-06T16:48:05.827

我使用 Eclipse 和普通的[PyDev](https://en.wikipedia.org/wiki/PyDev)。没有任何特定的 Django 功能。我想出的最好的方法是设置一个运行配置文件来运行开发 Web 服务器。

如果您添加 Web 工具项目 (WTP)，您将在模板中获得语法高亮显示，但没有与特定模板语言相关的任何内容。PyDev 是一个不错的插件，如果您已经熟悉 Eclipse 并将其用于其他项目，这是一个不错的选择。

我记得 NetBeans 开始获得 Python 支持，但我不知道现在在哪里。许多人对 NetBeans 6 赞不绝口，但在 Java 世界中，Eclipse 仍然是 OSS IDE 之王。

更新：LiClipse 对 Django 来说也很棒。 安装它，使用[此方法](https://nrecursions.blogspot.com/2019/03/which-ide-to-choose-for-python.html)将图标放入 Ubuntu 的菜单中。启动 LiClipse 并在 File > New > Project ... 中，选择 PyDev 和 PyDev Django 项目。您可能需要设置 Python 解释器等，但您可以自己解决。创建 Django 项目后，您可以右键单击该项目，菜单将有一个“Django”选项，它允许执行各种操作，例如创建 Django 应用程序或运行迁移等。LiClipse 很好，因为它消耗的内存比 PyCharm 少得多并且相当好地支持重构和自动完成。
[![在此处输入图像描述](https://i.stack.imgur.com/lBgOz.png)](https://i.stack.imgur.com/lBgOz.png)

* * *

## 回答 #3

> 赞同：48
> 
> 时间：2009-12-08T18:45:37.570

我使用 Vim：

[http://github.com/skyl/vim-config-python-ide](http://github.com/skyl/vim-config-python-ide)

[更新]

[Sublime Text 2](https://en.wikipedia.org/wiki/Sublime_Text#Version_2)非常棒。如果需要，它支持很多 Vim 命令：*[Vintage Mode](http://www.sublimetext.com/docs/2/vintage.html)*

它有一个不错的包管理器：[http ://wbond.net/sublime_packages/package_control](http://wbond.net/sublime_packages/package_control)

到目前为止，我使用这些软件包：

贾内罗

设置Django语法

咖啡脚本

SublimeLinter

主题 - 苏打水

侧边栏增强功能

我仍然喜欢 Vim，但是……我有没有提到 Sublime Text 插件是用 Python 编写的？

* * *

## 回答 #4

> 赞同：43
> 
> 时间：2008-10-06T16:33:52.687

我使用科莫多编辑。查看[打开 Komodo](http://www.openkomodo.com/)编辑。

* * *

## 回答 #5

> 赞同：32
> 
> 时间：2011-10-13T12:33:36.487

[升华](http://www.sublimetext.com/2)

![子](https://i.stack.imgur.com/Ke8dn.png)

* * *

## 回答 #6

> 赞同：22
> 
> 时间：2009-03-16T04:50:56.927

我开始喜欢使用[Aptana Studios](http://aptana.com/) + PyDev（和其他）插件进行各种 Web 应用程序开发。如您所知，它构建在强大的 Eclipse 之上，但专为专注于 Web 应用程序开发而设计。

* * *

## 回答 #7

> 赞同：17
> 
> 时间：2008-10-06T17:44:31.047

我的大部分开发都使用 Kate（KDE 高级文本编辑器），包括 Django。它同时具有 Python 和 Django 模板语法高亮显示。当项目的重要部分涉及 HTML 时，我切换到 Quanta+。

由于它使用了 Kate 的 KPart，它同样适用于编辑 Python 部分，对于 HTML 模板，我拥有完整的 Quanta+ 工具，同时仍然突出显示 Django 特定的标签。

2013 年更新：不幸的是，Quanta+ 已经死了好几年了，而且它再也没有复活的希望了。此外，没有其他可用的 HTML 编辑器，所以现在一直是 Kate。

* * *

## 回答 #8

> 赞同：16
> 
> 时间：2009-12-17T10:20:43.903

**[NetBeans for Python](http://wiki.netbeans.org/Python70Roadmap)**是我目前最喜欢的（比我发现的 Eclipse 更轻且更容易安装）。支持简单的重构、自动完成、错误/警告...

**[Eclipse](http://www.eclipse.org/) [Aptana](http://www.aptana.com/) [PyDev](http://pydev.org/index.html)**可能是当今最完整的免费 IDE 之一（尚未进行大量测试）

**[Wingware Python IDE](http://www.wingware.com/python)**一个商业 IDE，它具有一些 Django 特定的项目设置功能，能够调试 Django 模板文件。

**[IntelliJ IDEA](http://www.jetbrains.com/idea/)** *Ultimate Edition*另一个商业 IDE，它也有一个正在大量开发的 Python 插件。我看到了一些在自动完成（模板和 Python）上看起来很有希望的演示。

**[Vim](http://www.vim.org/)**里面我仍然使用一个小的 touch-fix 应用程序。另请参阅： [Django 的额外调整](http://code.djangoproject.com/wiki/UsingVimWithDjango)。

* * *

## 回答 #9

> 赞同：16
> 
> 时间：2011-01-27T16:13:21.627

[皮查姆](https://en.wikipedia.org/wiki/PyCharm)。它是迄今为止我尝试过的用于 Python、Django 和 Web 开发的最佳 IDE。这完全物有所值。

* * *

## 回答 #10

> 赞同：15
> 
> 时间：2010-11-10T12:41:56.393

你们应该检查[PyCharm](http://www.jetbrains.com/pycharm/index.html)！它是第一个体面的 Django IDE。

* * *

## 回答 #11

> 赞同：9
> 
> 时间：2008-10-06T16:30:16.673

Eclipse 有用于 python 开发的[PyDev](http://pydev.org/)插件。不幸的是，我不确定它与 Django 的集成程度如何。

* * *

## 回答 #12

> 赞同：7
> 
> 时间：2008-10-06T16:35:40.157

据我所知，Django 没有“IDE”，但有一些 IDE 开箱即用地支持 Django，特别是模板的 Django 语法。

名字叫[Komodo](http://www.activestate.com/Products/komodo_ide/index.mhtml)，它有很多功能，但并不便宜。如果您不担心源代码控制或调试，那么有一个名为[Komodo Edit](https://en.wikipedia.org/wiki/Komodo_Edit)的免费版本。

* * *

## 回答 #13

> 赞同：6
> 
> 时间：2011-09-09T02:16:33.013

Visual Studio 有一个实际的 Python 扩展：http: [//pytools.codeplex.com/](http://pytools.codeplex.com/)。这真是太棒了。感觉就像我在使用任何原生 Visual Studio 语言进行编码一样。该扩展甚至与 Django 兼容。最重要的是：它完全免费。即使对于 Visual Studio，它也只需要[Visual Studio Shell](http://www.microsoft.com/download/en/details.aspx?id=115)即可工作，这是完全免费的。

* * *

## 回答 #14

> 赞同：6
> 
> 时间：2012-03-21T13:26:26.257

现在您还可以使用 Visual Studio 2010。方法如下：

*   下载并安装[适用于 Visual Studio 的 Python 工具](http://pytools.codeplex.com/ "适用于 Visual Studio 的 Python 工具")。
*   从现有代码创建一个新项目（菜单*File* → *New* → *Project From Existing Code...*）
*   指定您的 Django 项目文件夹并使用默认值。
*   右键单击 manage.py 并选择*Set as Startup File*。
*   在您的项目属性*Debug选项卡中，在**Script Arguments*中添加“runserver” 。
*   您可以设置断点，并附加到 Python 进程进行调试。如果您想在不必“附加到进程”的情况下进行调试，请在脚本参数中使用“runserver --noreload”。但是，“--noreload”意味着您必须手动停止并重新启动 Django 开发 Web 服务器（以识别您的代码更改）。

如果您已经使用 Visual Studio，这是一个很好的设置。

Python 工具已更新。它现在已经内置了对 Django 的支持。

* * *

## 回答 #15

> 赞同：6
> 
> 时间：2012-12-30T03:27:22.143

[PyCharm](https://en.wikipedia.org/wiki/PyCharm)，当然。我尝试了所有（几乎），但 PyCharm 是我发现对任何重度开发最有用的一个。

对于简单的，有一次，我使用任何想到的脚本（TextMate、Vim、Emacs、TextWrangler 等，你可以说它）。

* * *

## 回答 #16

> 赞同：5
> 
> 时间：2010-11-26T23:50:22.057

我已经将 Eclipse 与 PyDev 和 PyCharm 一起使用。PyCharm 绝对是我尝试过的最好的 Django/Python IDE。它对所有对象进行正确的模板突出显示和自动完成。它还进行跨文件引用。

它相当昂贵，但绝对是我尝试过的最好的 Django IDE。[您可以在http://www.jetbrains.com/pycharm/download/](http://www.jetbrains.com/pycharm/download/)尝试 30 天评估。

* * *

## 回答 #17

> 赞同：3
> 
> 时间：2008-10-06T16:56:22.767

我真的很喜欢[E 文本编辑器](https://en.wikipedia.org/wiki/E_Text_Editor)，因为它几乎是[TextMate](http://en.wikipedia.org/wiki/TextMate)到 Windows 的“端口”。显然 Django 是基于 Python 的，对自动完成的支持是有限的（没有什么像智能感知那样需要一个了解每个库的复杂性的专用 IDE），但是使用片段和“单词完成”有很大帮助. 此外，它还支持 Django Python 文件和模板文件，以及 CSS、HTML 等。

我已经使用 E 文本编辑器很长时间了，我可以告诉你，在使用 Django 时，它击败了 PyDev 和 Komodo Edit。对于其他类型的项目，PyDev 和 Komodo 可能更合适。

* * *

## 回答 #18

> 赞同：3
> 
> 时间：2008-10-06T17:20:00.397

我在 Eclipse 和 Pydev 上也取得了不错的成绩。虽然我仍然需要一个打开到项目目录的 shell 来运行`manage.py`命令。我也一直将它与 Bazaar 插件一起用于版本控制和与服务器同步代码。

* * *

## 回答 #19

> 赞同：3
> 
> 时间：2008-12-06T12:27:50.447

[我也用凯特](https://stackoverflow.com/questions/175044/django-development-ide#175372)。凯特的简约是它最大的特点。它不会妨碍你。（这当然是高度主观的意见。）

Kate 包含一个 Python 代码浏览器插件。但这对IMO没有用。更改代码/视图时不会自动更新。同样，当您更新时，整个树都被折叠起来，您必须自己再次展开它。点击次数过多。

相反，我使用[Pâté](http://paul.giannaros.org/pate/)附带的 Source Browser 插件。它确实会导致凯特有时会暂时冻结，但到目前为止还没有崩溃或类似的事情。

无耻的博客插件：[更多关于使用 Django 和 Kate (Pâté)](http://www.muhuk.com/2008/11/extending-kate-with-pate/)

* * *

## 回答 #20

> 赞同：3
> 
> 时间：2009-12-02T08:43:51.600

嗯，我一直在用我自己的。最近他们发布了一个 alpha 版本。[它位于 pfaide.com/ 上](http://pfaide.com)。

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2011-02-02T13:05:32.697

*如果*你喜欢 Vim 作为编辑器，这里有一些关于如何为 Django 开发调整它（直到一个完整的 IDE）的建议：http: [//code.djangoproject.com/wiki/UsingVimWithDjango](http://code.djangoproject.com/wiki/UsingVimWithDjango)。

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2009-02-25T12:16:06.003

[Editra](http://editra.org/)支持 Django 模板语言语法高亮。您可以将其配置为更好的记事本或基本 IDE。

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2009-03-26T02:35:12.677

我发表了一篇关于[NetBeans 对 Django 的新的和即将推出的支持](http://kubasik.net/blog/2009/03/12/finally-a-django-ide-with-real-code-completion-and-template-support/)的博文。当与它已经很棒的 Python、JavaScript、HTML 和 CSS 支持配合使用时，它在我看来是一个强有力的候选者！

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2010-03-15T19:21:48.350

**安装了 Django 和 django-html 包的**TextMate为您提供语法高亮和出色的可扩展性。**它重量轻，使用起来很有趣。**

 **[这](http://github.com/orestis/pysmell)是一个使用 Python 的 TextMate 代码完成项目的链接（我自己没有使用过）。至于“intellisense”（我理解为内联文档参考），TextMate 也有。

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2010-03-17T20:45:01.180

[来自http://www.wingware.com](http://www.wingware.com)的 Wingware 编辑器是 Python 特定的，对 Python/Django/Zope 等具有非常好的自动完成功能。

它有一个内置的 Python shell 来运行代码片段（或选择并运行）并支持 Mercurial/Git 等，以及一个内置的 unittest/nose/doctest 测试运行器。虽然它是商业的，但是因为它是用 Python 编写的，所以它是跨平台的。

我不久前买了它，觉得它看起来很傻，但我都试过了，而且一直回来。需要注意的是，我是一个没有 Emacs 或 Vim 技能的 Windows 人，所以利用它不是一个选择。而且 Mac 版本需要 X Window 并且似乎更容易出错。

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2011-08-08T06:26:00.200

[吉尼](https://en.wikipedia.org/wiki/Geany)

它基于 GTK2、快速、轻量级，可用于 Linux 和 Windows。

* * *

## 回答 #27

> 赞同：1
> 
> 时间：2013-11-11T14:47:53.513

[忍者IDE](https://en.wikipedia.org/wiki/Ninja-IDE)。

检查这个：[Ninja-IDE Django 插件](http://ninja-ide.org/plugins/12/)

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2009-03-16T04:44:58.953

我一直使用 Vim 或 Kate，但我更喜欢成熟的 IDE。鉴于它不如 Visual Studio 重。

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2009-12-30T09:17:00.517

我自己喜欢 Eclipse + [PyDev](https://en.wikipedia.org/wiki/PyDev)和/或[eric](https://en.wikipedia.org/wiki/Eric_(software))。PyDev 的新版本有一些非常棒的代码完成支持。

由于我*只*将 Eclipse 用于 PyDev，因此我只使用了 Platform Runtime Binary + PyDev + Subclipse 的精简安装。

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2010-03-17T21:13:06.290

TextMate、Firebug 和[pdb](https://docs.python.org/3/library/pdb.html)。后者为我节省了无数次:)

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2010-08-14T04:40:58.793

Ulipad是一个很好的。 [http://code.google.com/p/ulipad/](http://code.google.com/p/ulipad/)

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2013-05-16T09:37:06.127

[Wing IDE](https://en.wikipedia.org/wiki/Wing_IDE)是一个很好用的 IDE ！

# javascript - 哪些 JavaScript 库将处理弹出窗口（例如 Meebo 或 Gmail 聊天窗口）？

> ID：175049
> 
> 赞同：0
> 
> 时间：2008-10-06T16:29:06.927
> 
> 标签：javascript

我可以写这个，但在我写之前，我想看看是否有现有的解决方案，因为似乎很多网站已经这样做了，所以我想知道是否有一种快速的方法来做到这一点。

另外，我说的是“弹出”窗口，而不是“弹出”窗口。所有 JavaScript 库都支持“弹出”窗口，但我想要它们最初在同一浏览器窗口中作为“弹出”窗口打开的那些，但也有一个链接可以在全新的浏览器窗口中打开它们。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-06T16:49:46.010

看看 Cappuccino，它更像是一个窗口框架而不是 web 2.0 框架。它基于 Apples Cocoa，并使用称为 Objective-J 的 Javascript 超集。超集意味着任何 JS 都是有效的，但它在语言上扩展了类似于 Cocoa 和 Objetive-C 的附加语法。

[http://cappuccino.org](http://cappuccino.org)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-06T17:48:03.910

```
var oDiv = document.getElementById('mydiv');
var oWindow = window.open("about:blank");

oWindow.document.body.appendChild(oDiv.cloneNode(true)) 
```

您可能还需要将样式表移到那里。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-06T16:53:41.447

我不知道有什么框架可以为你做到这一点。但是做到这一点的 JS 代码可能很简单。

对于页面内弹出部分，只需打开一个绝对 div。如果您希望 div 成为真正的弹出窗口，请打开一个弹出窗口，然后从主文档中删除您的 div 内容并将其附加到弹出窗口文档中（您必须克隆它，因为 JS 可能不喜欢在不同的 DOM 节点之间传递文件）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-06T18:30:37.103

JQuery - 寻找对话框。

[http://docs.jquery.com/UI/Dialog](http://docs.jquery.com/UI/Dialog)

您可以使用 CSS 自定义来控制标题栏，是否可以移动或调整大小等。

PS：以链接为例。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-06T18:43:19.290

你可以试试[http://mochaui.com/demo/](http://mochaui.com/demo/)，它是用 mootools 写的

# java - 连接到 oracle 时出错。获取方法 t2cGetCharSet 的 UnsatisfiedLinkError

> ID：175055
> 
> 赞同：2
> 
> 时间：2008-10-06T16:30:43.850
> 
> 标签：java, oracle, jdbc, drivers

我正在使用 JDK 1.5 使用 Apache ANT 运行一系列 JUnit。

所有使用 Oracle JDBC 驱动程序的 JUnit 都会给出如下所示的 UnsatisfiedLinkError。

它在寻找什么本机库，我该如何解决？PATH 变量应该包含什么？

```
java.lang.UnsatisfiedLinkError: oracle/jdbc/driver/T2CConnection.t2cGetCharSet([CI[CI[CI[CII[SLoracle/jdbc/driver/GetCharSetError;)S
        at oracle.jdbc.driver.T2CConnection.getCharSetIds(T2CConnection.java:2957)
        at oracle.jdbc.driver.T2CConnection.logon(T2CConnection.java:320)
        at oracle.jdbc.driver.PhysicalConnection.<init>(PhysicalConnection.java:361)
        at oracle.jdbc.driver.T2CConnection.<init>(T2CConnection.java:142)
        at oracle.jdbc.driver.T2CDriverExtension.getConnection(T2CDriverExtension.java:79)
        at oracle.jdbc.driver.OracleDriver.connect(OracleDriver.java:595)
        at oracle.jdbc.pool.OracleDataSource.getConnection(OracleDataSource.java:196)
        at oracle.jdbc.pool.OracleConnectionPoolDataSource.getPhysicalConnection(OracleConnectionPoolDataSource.java:114)
        at oracle.jdbc.pool.OracleConnectionPoolDataSource.getPooledConnection(OracleConnectionPoolDataSource.java:77)
        at oracle.jdbc.pool.OracleConnectionPoolDataSource.getPooledConnection(OracleConnectionPoolDataSource.java:59)
        at oracle.jdbc.pool.OracleConnectionCacheImpl.getNewPoolOrXAConnection(OracleConnectionCacheImpl.java:401)
        at oracle.jdbc.pool.OracleConnectionCacheImpl.setMinLimit(OracleConnectionCacheImpl.java:752) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-07T09:04:55.120

解决！

它实际上是一个过期的 ojdbc14.jar 文件导致了这个问题。我所做的只是更新它，现在问题已解决。类文件

谢谢

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-06T21:54:00.687

“如果 Java 虚拟机找不到声明为本地的方法的适当本地语言定义，则抛出此错误。”

意味着它正在寻找一个 DLL/so - 您可能正在使用 THICK 驱动程序？JDBC 2 驱动程序？

如果是，那么您可能需要添加 OCI.DLL 等。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-06T19:50:25.693

您需要将 -Djava.library.path=YOUR_ORACLE_HOME\bin 作为运行时参数传递给 JRE

所以....

```
java [other java switches + runtime parameters] -Djava.library.path=YOUR_ORACLE_HOME\bin run-classname 
```

此外，确保类路径中的 jar 与 $ORACLE_HOME/jdbc/lib 中的 jar 相同...如有必要，用 Oracle 覆盖 Eclipse 之一。

如果这不起作用，则有助于了解您正在运行哪个版本的 Oracle，因为这将影响您是否应该使用 classes12.jar 或 ojdbc14.jar

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-06T16:40:01.473

有了这个，您应该将 classes12.jar 或 classes13.jar 添加到您的类路径中（不确定名称，已经一年多了，谷歌这些......）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-06-01T14:21:48.997

有同样的问题；通过将连接 url 从 jdbc:oracle:oci:@//localhost:1521/service_name 更改为 jdbc:oracle:thin:@//localhost:1521/service_name 来解决

# svn - 用于生产环境的 SVN 结帐或导出？

> ID：175056
> 
> 赞同：27
> 
> 时间：2008-10-06T16:31:09.840
> 
> 标签：svn, deployment

在我正在进行的一个项目中，我们在开发团队之间进行了持续的讨论 - 生产环境应该部署为 SVN 存储库的签出还是导出？

开发环境显然是一个结帐，因为它不断更新。对于生产，我个人是检查主干，因为它使将来的更新更容易（只需运行 svn update）。然而，一些开发人员反对它，因为 svn 使用 svn 进程的组/所有者和权限创建文件（这是在 linux 操作系统上，所以这些事情很重要），并且在生产中也有 .svn 目录似乎他们有点脏。

此外，如果是结帐——如何在不包括开发代码的情况下将单个功能推送到生产环境？您是否为每个功能使用标签或分支？有什么选择吗？

**编辑：**我可能不清楚 - 要求之一是能够不断地将修复推送到生产环境。我们希望避免仅仅为了推送关键修复而进行完整构建（这比简单更新需要更长的时间）。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-08-04T15:51:34.890

[Subversion 常见问题解答](http://subversion.tigris.org/faq.html#website-auto-update)似乎提倡将部署作为结帐，使用提交后挂钩脚本自动更新。它们通过在 httpd.conf 中添加以下内容来阻止 Apache 导出 .svn 文件夹（可能是个好主意）：

```
# Disallow browsing of Subversion working copy administrative dirs.
<DirectoryMatch "^/.*/\.svn/">
    Order deny,allow
    Deny from all
</DirectoryMatch> 
```

我自己对 svn 非常陌生，但也许你可以在创建新标签时触发钩子脚本。这样，当您准备好更新实时站点时，您只需将最后一次更改提交到主干，创建新标签，脚本就会使用 svn update 更新您的实时站点。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-04-12T08:42:35.133

我一直在为此苦苦挣扎，我想我终于决定结帐了。是的，那里有多余的垃圾，但是...

*   导出不考虑已删除的文件（除非您的解决方案是删除目录中的所有内容然后导出，我认为这更糟）。Checkout 将删除已删除的文件。
*   结帐速度更快。时期。更少的文件被更新意味着更少的停机/转换时间，并且导出会下拉并覆盖所有内容，而不仅仅是需要更新的文件。

并不是说它对每个人都有效，但是这两件事影响了我的决定。祝你的决定好运。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-10-06T16:35:24.650

恕我直言，您应该创建一个分支/标签，其中您拥有用于生产的开发环境的（所需）子集。有人应该手动或使用脚本自动维护它。然后，您应该导出（而不是结帐）。增量更新不是问题，除非您在生产环境中更改文件并且您不希望这些文件被覆盖。

只是我的 0.02 美元

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2008-10-06T16:36:20.343

毫无疑问 - 出口。

您不会进行更新，因此没有理由结帐。你只会部署垃圾。

我想说任何环境都应该只是一个出口；您仅在开发时在本地使用结帐。当然我们也在使用构建脚本，所以更新部署就像运行脚本一样简单。

就开发中的代码而言，为正在完成的任何工作创建分支。只有在准备好部署到开发环境时才提交到主干。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-06T16:35:45.133

我会研究一些像 Capistrano 这样的部署软件（这是一个 ruby​​ 程序）

如果您要使用自己的解决方案或手动操作，我个人会使用导出主干的标记副本而不是仅导出主干。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-06T20:26:41.393

我将其部署为副本。当然不是手动的。

我使用“make”和“checkinstall”。我创建了一个小的 Makefile，它使用系统命令“安装”将所有需要的文件复制到 Web 服务器上的相应目录，并且我有将在服务器上运行的预安装和安装后 shell 脚本。

当部署时间到来时，我只运行“checkinstall”，它会创建一个包（RPM、DEB 或 TGZ，具体取决于我所针对的 Linux 发行版）。我使用 Linux 分发包管理器（rpm、dpkg、pkgtool）提供的常规工具安装它。当然，如果你也想跟踪依赖关系，你可以使用 yum、apt-get 等。

如果您想分发 Web 应用程序的新版本，这将变得非常容易。到多个目标服务器。卸载、恢复到旧版本等操作非常简单，因为您为部署的每个版本都有一个现成的包。

如果您使用一些需要编译的东西，这可能不适合您的“经常推送”策略。然而，对于编写脚本的东西（比如我做的 PHP），在我的机器上创建一个包（大约 300 多个 PHP 文件）大约需要 20 秒。并且几乎可以在任何目标系统上安装它。

为了将“用于发布”的代码与“开发中”的代码分开，我使用了分支。使用 Git，这真的很容易，因为分支既便宜又快速。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-04-13T13:41:02.047

就我个人而言，我总是对这个问题的解决方案持怀疑态度，我更喜欢在我的生产环境周围没有“.svn”目录，它很脏，但同时，对于大型 Web 应用程序，导出非常乏味（特别是如果使用一些第三方“组件”，如 Extjs、FCKeditor 等）。

我认为目前没有“杀手级解决方案”。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-06-30T10:58:24.123

让我看看..... ln -s ? 那可以用来做什么？

```
/var/www/www.my-prod-site.com/public/
/var/www/www.my-prod-site.com/builds/Rev 1/
/var/www/www.my-prod-site.com/builds/Rev 2/
/var/www/www.my-prod-site.com/builds/Rev 3/
/var/www/www.my-prod-site.com/builds/Rev 99/ 
```

svn 导出到您的构建目录......从 /public 复制任何配置文件，这是您到以前版本构建的符号链接，然后将符号链接从公共转移到指向您的新构建目录。与我在此处发布的任何内容相比，它所花费的离线时间都更少，而且它还可以更快地返回，除非您*每次*都通过更改表来检查您的数据库。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-12-05T17:31:30.380

这里有一些意见——

生产中的 .svn 文件脏了？如果 .svn 目录完好无损并且没有损坏，那么它们远非肮脏，它们实​​际上是救命稻草。为了安全起见，您可以告诉 apache 阻止浏览它们。

结帐还是导出？我的方法...我绝对使用标签和分支 - 将生产服务器附加到主干并祈祷没有人在有人将错误代码提交到主干以查看它在 DEV 上的作用之后运行 svn 是很危险的。我有一个可重复使用的标签（比如 _production 和 _staging），在我的设置开始时，我将每个标签签到匹配的服务器。然后我锁定所有访问以修改实时和登台服务器的内容。此后，DEV 服务器被绑定到主干头。当代码对于 QA/staging 足够稳定时，我们创建一个标签并将其重命名为 _staging 以允许 staging 服务器在看到该标签发生更改时与其同步（脚本运行 'svn up'）。一旦我们对 _staging 感到满意，我们将其重命名为 _production，这使得代码部署到实时服务器。或者，您可以创建具有不同名称的标签/分支，并使用“svn switch URL”将服务器指向一个新的标签/分支（固定点）。以上所有使部署变得非常容易而无需停机，如果需要回滚，您可以快速重命名存档的以前的标签或使用 'svn switch OLD_URL' 立即撤消新更改，而无需担心每个小文件和行更改。

权限和所有权 如果您了解并知道文件的权限应该是什么，您可以在每次部署后运行您的脚本，以将 CHOWN 和 CHMOD 设置为您想要的。

恐惧与知识 我听说很多害怕的人排除了生产服务器上存在 SVN。反面其实很可怕。您如何向您的产品团队和客户保证，如果无法进行试运行或“svn status -u”，应用程序不会崩溃成一大堆错误消息或“svn status -u”以确保部署将只修改那些需要修改的文件改变？检查状态甚至可以让我知道是否有人强迫他们这样做并直接在服务器上进行“快速更改” - 你知道人们倾向于绕过对他们来说很快的事情的规则。

镜像直播服务器有错误？使用 .svn，您可以识别它同步到的确切版本（svn 信息），然后检查该 url 是否为真（sv status -u）。然后，您可以通过将相同的标记/版本签出到可以安全地排除故障的沙盒服务器来构建该设置的真实副本。

* * *

## 回答 #10

> 赞同：-3
> 
> 时间：2009-04-12T08:59:21.690

## 出口

就是这样。您没有任何充分的理由将额外的垃圾放入生产系统。

*   您将公开您的源代码
*   如果这是 Web 应用程序，那就更糟糕了，您的访问者可以下载您的源代码，这太酷了！非常开放:)

# sql - SQL Server：是否可以同时插入两个表？

> ID：175066
> 
> 赞同：170
> 
> 时间：2008-10-06T16:33:58.570
> 
> 标签：sql, sql-server, insert, temp-tables

我的数据库包含三个名为`Object_Table`和`Data_Table`的表`Link_Table`。链接表只包含两列，一个对象记录的标识和一个数据记录的标识。

我想从`DATA_TABLE`链接到一个给定对象标识的位置复制数据，并将相应的记录插入到`Data_Table`不同`Link_Table`的给定对象标识中。

我**可以**通过选择一个表变量并通过为每次迭代执行两次插入循环来做到这一点。

这是最好的方法吗？

**编辑**：我想避免循环有两个原因，第一个是我很懒，循环/临时表需要更多的代码，更多的代码意味着更多的地方出错，第二个原因是对性能的关注。

我可以在一次插入中复制所有数据，但是如何让链接表链接到每条记录都有一个新 ID 的新数据记录？

* * *

## 回答 #1

> 赞同：258
> 
> 时间：2008-10-06T16:49:35.730

在一个*声明中*：没有。

在一笔*交易*中：是

```
BEGIN TRANSACTION
   DECLARE @DataID int;
   INSERT INTO DataTable (Column1 ...) VALUES (....);
   SELECT @DataID = scope_identity();
   INSERT INTO LinkTable VALUES (@ObjectID, @DataID);
COMMIT 
```

好消息是，上面的代码也保证是*原子*的，并且可以在单个函数调用中使用一个 sql 字符串从客户端应用程序发送到服务器，就好像它是一个语句一样。您还可以将触发器应用于一个表以获得单个插入的效果。但是，它最终仍然是两个语句，您可能不想为*每个*插入运行触发器。

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2008-10-06T16:49:21.860

您仍然需要两个`INSERT`语句，但听起来您想`IDENTITY`从第一个插入中获取并在第二个中使用它，在这种情况下，您可能需要查看`OUTPUT`或：http `OUTPUT INTO`: [//msdn.microsoft.com/en-我们/图书馆/ms177564.aspx](http://msdn.microsoft.com/en-us/library/ms177564.aspx)

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2008-10-06T19:16:38.383

以下设置了我的情况，使用表变量。

```
DECLARE @Object_Table TABLE
(
    Id INT NOT NULL PRIMARY KEY
)

DECLARE @Link_Table TABLE
(
    ObjectId INT NOT NULL,
    DataId INT NOT NULL
)

DECLARE @Data_Table TABLE
(
    Id INT NOT NULL Identity(1,1),
    Data VARCHAR(50) NOT NULL
)

-- create two objects '1' and '2'
INSERT INTO @Object_Table (Id) VALUES (1)
INSERT INTO @Object_Table (Id) VALUES (2)

-- create some data
INSERT INTO @Data_Table (Data) VALUES ('Data One')
INSERT INTO @Data_Table (Data) VALUES ('Data Two')

-- link all data to first object
INSERT INTO @Link_Table (ObjectId, DataId)
SELECT Objects.Id, Data.Id
FROM @Object_Table AS Objects, @Data_Table AS Data
WHERE Objects.Id = 1 
```

感谢另一个将我指向 OUTPUT 子句的[答案，我可以展示一个解决方案：](https://stackoverflow.com/questions/175066/in-sql-server-is-it-possible-to-insert-into-two-tables-at-the-same-time#175136)

```
-- now I want to copy the data from from object 1 to object 2 without looping
INSERT INTO @Data_Table (Data)
OUTPUT 2, INSERTED.Id INTO @Link_Table (ObjectId, DataId)
SELECT Data.Data
FROM @Data_Table AS Data INNER JOIN @Link_Table AS Link ON Data.Id = Link.DataId
                INNER JOIN @Object_Table AS Objects ON Link.ObjectId = Objects.Id 
WHERE Objects.Id = 1 
```

然而事实证明，由于以下错误，在现实生活中并不是那么简单

> OUTPUT INTO 子句不能位于（主键、外键）关系的任一侧

我仍然可以`OUTPUT INTO`使用临时表，然后以正常插入完成。所以我可以避免我的循环，但我不能避免临时表。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2016-11-01T01:43:16.920

我想强调使用

```
SET XACT_ABORT ON; 
```

用于具有多个 sql 语句的 MSSQL 事务。

请参阅：[https](https://msdn.microsoft.com/en-us/library/ms188792.aspx) ://msdn.microsoft.com/en-us/library/ms188792.aspx 他们提供了一个很好的例子。

因此，最终代码应如下所示：

```
SET XACT_ABORT ON;

BEGIN TRANSACTION
   DECLARE @DataID int;
   INSERT INTO DataTable (Column1 ...) VALUES (....);
   SELECT @DataID = scope_identity();
   INSERT INTO LinkTable VALUES (@ObjectID, @DataID);
COMMIT 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-10-06T16:50:33.013

听起来 Link 表捕获了 Object 表和 Data 表之间的多对多关系。

我的建议是使用存储过程来管理事务。当您要插入到 Object 或 Data 表时，请执行插入，获取新 ID 并将它们插入到 Link 表中。

这允许您的所有逻辑保持封装在一个易于调用的 sproc 中。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-10-06T16:42:25.137

如果您希望操作或多或少是原子的，我会确保将它们包装在事务中。这样你就可以确定两者都发生了，或者两者都没有按照需要发生。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-10-06T16:53:26.237

您可以创建一个视图，选择插入语句所需的列名，添加一个 INSTEAD OF INSERT 触发器，然后插入到该视图中。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-10-06T17:25:59.493

在能够在 Oracle 中执行多表插入之前，您可以使用一种技巧，该技巧涉及将插入到视图中，该视图上定义了 INSTEAD OF 触发器来执行插入。这可以在 SQL Server 中完成吗？

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-10-06T16:42:51.813

Insert 一次只能对一张表进行操作。多个插入必须有多个语句。

我不知道你需要通过一个表变量进行循环 - 你不能只在一个表中使用批量插入，然后在另一个表中使用批量插入吗？

顺便说一句 - 我猜你的意思是从 Object_Table 复制数据；否则这个问题没有意义。

* * *

## 回答 #10

> 赞同：-3
> 
> 时间：2011-03-31T23:10:30.923

//如果要插入与第一个表相同的内容

```
$qry = "INSERT INTO table (one, two, three) VALUES('$one','$two','$three')";

$result = @mysql_query($qry);

$qry2 = "INSERT INTO table2 (one,two, three) VVALUES('$one','$two','$three')";

$result = @mysql_query($qry2); 
```

* * *

//或者如果你想插入表一的某些部分

```
 $qry = "INSERT INTO table (one, two, three) VALUES('$one','$two','$three')";

  $result = @mysql_query($qry);

 $qry2 = "INSERT INTO table2 (two) VALUES('$two')";

 $result = @mysql_query($qry2); 
```

//我知道它看起来太好了，但它确实有效，您可以继续添加查询，只需更改

```
 "$qry"-number and number in @mysql_query($qry"") 
```

* * *

我有 17 张桌子。

* * *

## 回答 #11

> 赞同：-3
> 
> 时间：2015-05-07T13:30:06.240

```
-- ================================================
-- Template generated from Template Explorer using:
-- Create Procedure (New Menu).SQL
--
-- Use the Specify Values for Template Parameters 
-- command (Ctrl-Shift-M) to fill in the parameter 
-- values below.
--
-- This block of comments will not be included in
-- the definition of the procedure.
-- ================================================
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

ALTER PROCEDURE InsetIntoTwoTable

(
@name nvarchar(50),
@Email nvarchar(50)
)

AS
BEGIN

    SET NOCOUNT ON;

    insert into dbo.info(name) values (@name)
    insert into dbo.login(Email) values (@Email)
END
GO 
```

# asp.net - Subtext 安装在中等信任级别给出错误

> ID：175075
> 
> 赞同：0
> 
> 时间：2008-10-06T16:35:39.360
> 
> 标签：asp.net, installation, medium-trust, full-trust, subtext

我正在尝试在中等信任级别的环境（主机：[Crystaltech ）中安装](http://www.crystaltech.com/)[Subtext](http://subtextproject.com/) ，并收到以下错误（见下文）。我能够进行管理设置，但是当它试图去博客进行实际使用时，繁荣。

我知道我可以将环境“升级”到完全信任级别，但我想了解为什么会发生错误以及在我这样做之前转向完全信任的后果。

扩展这个问题；什么是“信任级别”？

> 安全异常
> 
> 说明：应用程序试图执行安全策略不允许的操作。要授予此应用程序所需的权限，请联系您的系统管理员或在配置文件中更改应用程序的信任级别。
> 
> 异常详细信息：System.Security.SecurityException：请求“System.Security.Permissions.SecurityPermission，mscorlib，Version=2.0.0.0，Culture=neutral，PublicKeyToken=b77a5c561934e089”类型的权限失败。
> 
> 源错误：
> 
> 在执行当前 Web 请求期间生成了未处理的异常。可以使用下面的异常堆栈跟踪来识别有关异常起源和位置的信息。
> 
> 堆栈跟踪：
> 
> [SecurityException：请求“System.Security.Permissions.SecurityPermission，mscorlib，版本=2.0.0.0，Culture=neutral，PublicKeyToken=b77a5c561934e089”类型的权限失败。]
> System.Web.Security.UrlAuthorizationModule.CheckUrlAccessForPrincipal(String virtualPath, IPrincipal 用户，字符串动词）+47
> Subtext.Framework.UrlManager.UrlReWriteHandlerFactory.GetHandlerForUrl（字符串 url）+66
> Subtext.Framework.UrlManager.UrlReWriteHandlerFactory.ProcessHandlerTypePage（HttpHandler 项，HttpContext 上下文）+143
> Subtext.Framework.UrlManager.UrlReWriteHandlerFactory.GetHandler （HttpContext 上下文、字符串 requestType、字符串 url、字符串路径）+340
> System.Web.HttpApplication.MapHttpHandler(HttpContext context, String requestType, VirtualPath path, String pathTranslated, Boolean useAppConfig) +175 System.Web.MapHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute() +128 System.Web.HttpApplication. ExecuteStep(IExecutionStep step, Boolean& completedSynchronously) +161

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-06T16:48:43.190

信任级别实际上只是指向某些 security.config 文件的指针。默认信任级别在 C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\CONFIG\web.config 中定义，“中”信任指向 web_mediumtrust.config。

至于异常，用反射器查看 System.Web.Security.UrlAuthorizationModule.CheckUrlAccessForPrincipal() 会发现该方法归因于 [SecurityPermission(SecurityAction.Demand, Unrestricted=true)]，这意味着它需要不受限制的安全权限，它没有在中等信任下运行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-07T11:54:55.417

除了完全信任或删除对 CheckUrlAccessForPrincipal() 的调用并重新编译之外，我认为没有其他方法可以解决该错误。

但从表面上看，这个特殊问题已经在潜台词 SVN（修订版 3290）中得到纠正。他们还为 subtext 2.0.1 添加了一个新的构建任务，其中应该包含修复。我想这将在它准备好时发布。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-06T17:08:43.833

更多来自 csgero的谷物[添加到工厂：](https://stackoverflow.com/questions/175075/subtext-install-gives-error-in-medium-trust-level#175132)

[http://www.kowitz.net/archive/2008/08/15/upgrading-to-subtext-2.0-fail.aspx](http://www.kowitz.net/archive/2008/08/15/upgrading-to-subtext-2.0-fail.aspx)

菲尔·哈克（Phil Haack）有一个小评论，我猜他现在正忙于其他事情：）

# php - PHP session side-effect warning with global variables as a source of data

> ID：175091
> 
> 赞同：43
> 
> 时间：2008-10-06T16:39:46.170
> 
> 标签：php, session, global-variables, session-variables

I'm trying to host a PHP web site that was given to me. I see this warning:

> **Warning:** Unknown: Your script possibly relies on a session side-effect which existed until PHP 4.2.3\. Please be advised that the session extension does not consider global variables as a source of data, unless register_globals is enabled. You can disable this functionality and this warning by setting session.bug_compat_42 or session.bug_compat_warn to off, respectively. in **Unknown** on line **0**

What does this mean? How might I track down the source of this problem within the code?

* * *

## 回答 #1

> 赞同：99
> 
> 时间：2008-10-06T16:51:01.937

basically you have a variable with the same name as your session. ex:

```
$_SESSION['var1'] = null;
$var1 = 'something'; 
```

which will reproduce this error. you can stop PHP from trying to find existing variables and warning you about them by adding these lines to your script:

```
ini_set('session.bug_compat_warn', 0);
ini_set('session.bug_compat_42', 0); 
```

these values can be set in php.ini or .htaccess as well

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2010-02-14T21:25:42.417

There seem to be a few problematic possibilities here:

[http://www.spiration.co.uk/post/1231/Your-script-possibly-relies-on-a-session-side-effect](http://www.spiration.co.uk/post/1231/Your-script-possibly-relies-on-a-session-side-effect "spiration.co.uk")

says that cases like this:

```
$_SESSION['firstname']=$_REQUEST['firstname']; 
```

will trigger the warning.

Additionally, I interpret this php bug content: [http://bugs.php.net/bug.php?id=41540](http://bugs.php.net/bug.php?id=41540) to mean that this error may also occur when you assign a variable to the session superglobal that is not yet initialized, e.g.

```
//Start of script
$_SESSION['bob'] = $bob; 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-05-18T00:01:53.920

This is good information on finding out what's causing the warning, but I would recommend NOT shutting off the warnings Owen mentions. These runtime functions are [removed in PHP 5.4.0](http://php.net/manual/en/session.configuration.php) and the developer should get into the practice of avoiding such usage of variables.

To fix this, it may be a pain on the developers end, but if you have

```
$_SESSION["user"]
$user; 
```

rename the session to

```
$_SESSION["sessuser"]; 
```

Or vise-versa just as long as the session name and the variable name are different. Think of it this way: when you upgrade to the latest build, you'll have to debug your code anyhow.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-27T13:18:24.940

When you are making changes to the .htaccess ini_set does not work. You will need to do it as:

```
php_flag session.bug_compat_42 0
php_flag session.bug_compat_warn 0 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-03-13T15:47:30.003

in my case, php.ini change from on to off

like this :

```
session.bug_compat_42 = off
session.bug_compat_warn = off 
```

if not working, restart apache

# .net - 将列表排序为多个垂直列

> ID：175099
> 
> 赞同：6
> 
> 时间：2008-10-06T16:41:39.443
> 
> 标签：.net, list, checkbox, sorting

有没有人有一个很好的算法来重新排序一个值数组（已经预先排序），以便它们可以显示在多个（N）列中并垂直读取？这将在 .Net 中实现，但我更喜欢便携的东西，而不是一些神奇的功能。

它工作的一个很好的例子是 ASP.Net CheckBoxList 控件呈现为一个方向设置为垂直的表格。

这是输入和输出的示例：

输入：

列 = 4
数组 = {“A”、“B”、“C”、“D”、“E”、“F”、“G”}

输出：

ACEG
BDF

谢谢！

**更新（更多信息）：**

我想我可能需要提供更多关于我正在尝试做的事情的信息......大多数情况下，这个问题来自使用 CheckBoxList 的自动绑定（您可以在其中指定输出的列和方向，它会输出以正确顺序的项目表）使用 jQuery/AJAX 创建复选框网格。因此，我尝试使用带有指定宽度的 div 块（在已知宽度的容器 div 内）的 css 复制该布局，以便它们在 N 个项目（或列）之后包装。这也可以在表格中呈现（就像 ASP .Net 做到了。）

一切都很好，除了顺序是水平的，当您在列表中获得大量项目时，更容易阅读垂直列。

如果数组中没有足够的项目来制作一个均匀的网格，那么它应该在网格的正确行/列中输出一个空点。

如果一个数组没有足够的项目来组成一行，那么只需在一行中按原始顺序输出项目。

其他一些输入/输出可能是：

列 = 3
数组 = {“A”、“B”、“C”、“D”}

ACD
乙

列 = 5
数组 = {“A”、“B”、“C”、“D”、“E”、“F”、“G”、“H”}

ACEGH
BDF

列 = 5
数组 = {“A”、“B”、“C”、“D”}

A B C D

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-07T10:45:19.023

好的，我很抱歉我最初的声明，但是当您希望它按照您在我的第一个答案的评论中描述的那样工作时，您实际上需要重新排序数据......好吧。它可以在没有辅助矩阵的情况下完成，但是生成的代码可能非常复杂，只要矩阵只使用几个字节的内存，为什么不使用这个小辅助构造呢？

我的代码在下面做的是创建一个矩阵。我们从上到下然后从左到右编写矩阵（当我们用完元素来填充第一行的所有列时，停止填充除第一行以外的任何内容）。然后我们以不同的顺序阅读它，从左到右，从上到下。基本上我们在这里做的是[转置一个矩阵](http://en.wikipedia.org/wiki/Transposed_matrix), 以一种顺序写入，但以另一种顺序读取。转置矩阵是一个非常基本的数学运算（许多 3D 编程通过使用矩阵计算来工作，转置实际上是一个简单的运算）。诀窍是我们最初如何填充矩阵。为了确保我们在任何情况下都可以填充第一列，与所需的列数和数组的大小无关，如果我们用完元素，我们必须停止按正常顺序填充矩阵并保留所有剩余的元素第一排。这将产生您在评论中建议的输出。

老实说，整个事情有点复杂，但它背后的理论应该是理智的，而且效果很好:-D

```
int Columns;
char * Array[] = {"A", "B", "C", "D", "E", "F", "G"};

int main (
    int argc,
    char ** argv
) {
    // Lets thest this with all Column sizes from 1 to 7
    for (Columns = 1; Columns <= 7; Columns++) {

        printf("Output when Columns is set to %d\n", Columns);

        // This is hacky C for quickly get the number of entries
        // in a static array, where size is known at compile time
        int arraySize = sizeof(Array) / sizeof(Array[0]);

        // How many rows we will have
        int rows = arraySize / Columns;

        // Below code is the same as (arraySize % Columns != 0), but
        // it's almost always faster
        if (Columns * rows != arraySize) {
            // We might have lost one row by implicit rounding
            // performed for integer division
            rows++;
        }

        // Now we create a matrix large enough for rows * Columns
        // references. Note that this array could be larger than arraySize!
        char ** matrix = malloc(sizeof(char *) * rows * Columns);

        // Something you only need in C, C# and Java do this automatically:
        // Set all elements in the matrix to NULL(null) references
        memset(matrix, 0, sizeof(char *) * rows * Columns );

        // We fill up the matrix from top to bottom and then from
        // left to right; the order how we fill it up is very important
        int matrixX;
        int matrixY;
        int index = 0;
        for (matrixX = 0; matrixX < Columns; matrixX++) {
            for (matrixY = 0; matrixY < rows; matrixY++) {
                // In case we just have enough elements left to only
                // fill up the first row of the matrix and we are not
                // in this first row, do nothing.
                if (arraySize + matrixX + 1 - (index + Columns) == 0 &&
                        matrixY != 0) {
                    continue;
                }

                // We just copy the next element normally
                matrix[matrixY + matrixX * rows] = Array[index];
                index++;
                //arraySize--;
            }
        }

        // Print the matrix exactly like you'd expect a matrix to be
        // printed to screen, that is from left to right and top to bottom;
        // Note: That is not the order how we have written it,
        // watch the order of the for-loops!
        for (matrixY = 0; matrixY < rows; matrixY++) {
            for (matrixX = 0; matrixX < Columns; matrixX++) {
                // Skip over unset references
                if (matrix[matrixY + matrixX * rows] == NULL)
                    continue;

                printf("%s", matrix[matrixY + matrixX * rows]);
            }
            // Next row in output
            printf("\n");
        }
        printf("\n");

        // Free up unused memory
        free(matrix);
    }   
    return 0;
} 
```

输出是

```
Output when Columns is set to 1
A
B
C
D
E
F
G

Output when Columns is set to 2
AE
BF
CG
D

Output when Columns is set to 3
ADG
BE
CF

Output when Columns is set to 4
ACEG
BDF

Output when Columns is set to 5
ACEFG
BD

Output when Columns is set to 6
ACDEFG
B

Output when Columns is set to 7
ABCDEFG 
```

这段 C 代码应该很容易移植到 PHP、C#、Java 等，没有什么大魔法，所以它几乎是通用的、可移植的和跨平台的。

* * *

我应该补充一件重要的事情：

如果将 Columns 设置为零（除以零，我不检查），此代码将崩溃，但是 0 Columns 有什么意义呢？如果您的列数多于数组中的元素，它也会崩溃，我也不检查这一点。获得 arraySize 后，您可以轻松地检查其中任何一个：

```
if (Columns <= 0) {
   // Having no column make no sense, we need at least one!
   Columns = 1;
} else if (Columns > arraySize) {
   // We can't have more columns than elements in the array!
   Columns = arraySize;
} 
```

此外，您还应该检查 arraySize 是否为 0，在这种情况下，您可以直接跳出该函数，因为在这种情况下，该函数绝对无事可做 :) 添加这些检查应该使代码坚如磐石。

顺便说一句，在数组中有 NULL 元素将起作用，在这种情况下，结果输出中没有漏洞。NULL 元素就像不存在一样被跳过。例如让我们使用

```
char * Array[] = {"A", "B", "C", "D", "E", NULL, "F", "G", "H", "I"}; 
```

输出将是

```
ADFI
BEG
CH 
```

对于 Columns == 4。如果你*想要孔*，你需要创建一个孔元素。

```
char hole = 0;
char * Array[] = {"A", "B", &hole, "C", "D", "E", &hole, "F", "G", "H", "I"}; 
```

并稍微修改绘画代码

```
 for (matrixY = 0; matrixY < rows; matrixY++) {
        for (matrixX = 0; matrixX < Columns; matrixX++) {
            // Skip over unset references
            if (matrix[matrixY + matrixX * rows] == NULL)
                continue;

            if (matrix[matrixY + matrixX * rows] == &hole) {
                printf(" ");
            } else {
                printf("%s", matrix[matrixY + matrixX * rows]);
            }
        }
        // Next row in output
        printf("\n");
    }
    printf("\n"); 
```

输出样本：

```
Output when Columns is set to 2
A 
BF
 G
CH
DI
E

Output when Columns is set to 3
ADG
BEH
  I
CF

Output when Columns is set to 4
AC H
BDFI
 EG 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-06T18:29:32.347

### 一个小更新：

我在这里使用的算法是一种修改后的算法，您将使用它来绘制图像。我假装数组条目是图像的像素数据，然后我从左到右（1.LtoR）和从上到下（2.TtoB）绘制图像，但是，图像数据存储自从上到下（1\. TtoB）然后从左到右（2\. LtoR）；IOW 以不同的顺序。由于图像不能有*孔*，这就是它不适用于 5 或​​ 6 列的原因。有4列的输出是

```
ACEG
BDF 
```

作为图像，它看起来像这样

```
OOOO
OOO. 
```

O 是图像的一个像素，而 . 是一个未定义的像素（缺少一个）。丢失的可能只在图像的末尾，而不是在图像的中间。这意味着它也可能看起来像这样

```
OOO
OO.
OO.
OO. 
```

**如果您首先**从上到下**然后**从左到右读取，则所有丢失的像素始终位于末尾，因为在这种情况下，所有丢失的像素在末尾直接相互跟随。如果我阅读图表 TtoB 和 LtoR，它必须是这样的“像素，像素，像素，像素，...，像素，缺失，缺失，缺失，...，缺失”，它可能永远不会读取“像素，缺失，像素”或“缺失，像素，缺失”。所有像素都在一起，所有缺失也都在一起。

正如评论所暗示的，有 5 列，它应该看起来像这样

```
ACEFG
BD 
```

但是，作为图像，它看起来像这样

```
OOOOO
OO... 
```

这是算法不允许的。如果我先读 TtoB 再读 LtoR，它将显示：“像素，像素，像素，像素，像素，缺失，像素，缺失，像素，缺失”。如上所述，算法不允许这样做。因此，如果绘制那么多列会导致图像中出现空洞，那么这种简单的像素绘制方法将不会绘制所要求的那么多列。在这种情况下，它只会填充孔，但是，这将导致绘制的列更少。

让我想一个总是绘制请求的像素数的解决方案（在单独的回复中）。

* * *

您根本不必为此重新排列内存中的数据。只需按所需顺序打印即可。

一些 C 代码（我做的非常冗长，所以每个人都明白我在做什么。当然这可以更紧凑）：

```
int Columns = 4;
char * Array[] = {"A", "B", "C", "D", "E", "F", "G"};

int main (
    int argc,
    char ** argv
) {
    // This is hacky C for quickly get the number of entries
    // in a static array, where size is known at compile time
    int arraySize = sizeof(Array) / sizeof(Array[0]);

    // How many rows are we going to paint?
    int rowsToPaint = (arraySize / Columns) + 1;

    int col;
    int row;

    for (row = 0; row < rowsToPaint; row++) {
        for (col = 0; col < Columns; col++) {
            int index = col * rowsToPaint + row;

            if (index >= arraySize) {
                // Out of bounds
                continue;
            }

            printf("%s", Array[index]);
        }
        printf("\n"); // next row
    }
    printf("\n");
    return 0;
} 
```

注意：这适用于值为 8（因此所有内容都绘制在一行内）和 4 及以下的值（适用于 3、2 和 1），但它不能适用于 5。这不是错算法的问题，是约束的错误。

```
ACEFG
BD 
```

约束表示从上到下读取列以获取更正的排序数据。但是上面的“ *EFG* ”是排序的，不是从上到下，而是从左到右。所以这个算法有问题。使用 Columns = 3 将起作用

```
ADG
BE
CF 
```

使用两个也可以

```
AE
BF
CG
D 
```

并且会将所有内容放在一列中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-06T18:15:37.350

无论如何，这看起来像是家庭作业

```
array<String^>^  sArray = {"A", "B", "C", "D", "E", "F", "G"};
double Columns = 4;
double dRowCount = Convert::ToDouble(sArray->Length) / Columns;
int rowCount = (int) Math::Ceiling(dRowCount);
int i = 0;
int shift = 0;
int printed = 0;
while (printed < sArray->Length){
    while (i < sArray->Length){
        if (i % rowCount == shift){
            Console::Write(sArray[i]);
            printed++;
        }
        i++;
    }
    Console::Write("\n");
    i = 0;
    shift++;
} 
```

# c++ - C++ 线程/进程标识符

> ID：175100
> 
> 赞同：5
> 
> 时间：2008-10-06T16:41:39.647
> 
> 标签：c++, multithreading, process

是否有使用 C++ 获取线程和/或进程标识符（字符串、int、...）的*可移植方式？*

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-06T16:46:42.350

您有几种方法，但都意味着使用为您抽象线程的外部库。

在流行的选择中，有两个是：

1.  [Boost.Thread](http://www.boost.org/doc/libs/1_36_0/doc/html/thread.html)库。这是最便携但暗示使用 Boost，这是一个巨大的库
2.  [Qt](http://www.trolltech.com)库。这不太可移植，并且意味着可以与大型库 Qt 一起使用。

如果您已经在这两个库上使用过任何一个，我建议您坚持使用它。否则，请查看他们提供的其他工具并做出选择。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-06T17:36:06.323

当可移植意味着一种适用于存在 C++ 编译器的**每个平台的方法时，没有可移植的方法。**这种方式必须是 C++ 标准的一部分，在这种情况下，它确实可以在任何地方工作（就像 C++ 标准的其他部分在任何地方都可以工作）。不保证标准中没有的所有内容都可以在任何平台上运行，除非平台声明支持该标准。

人们在这里建议的每个解决方案都是使用外部库的解决方案，因此只能在该库支持的平台上运行；并且没有可用于每个现有平台的库。

可能会让你走得最远的是 POSIX，毕竟每个类 UNIX 系统都试图支持至少一些 POSIX（越多越好），很少有人能称自己是真正 100% 兼容 POSIX 的平台（例如 A/UX， AIX、HP-UX、IRIX、Mac OS X 10.5、MINIX、QNX、Solaris、UnixWare、VxWorks……等等，当然还有更多）。然而，有相当多的平台至少提供一些 POSIX 支持，一些更多，一些更少，一些几乎是 POSIX 兼容的（例如 FreeBSD、Linux、NetBSD、BeOS、OpenBSD 等）。

不幸的是，Windows 还远未成为一体。NT 曾经部分符合 POSIX，但现在它或多或少地消失了（Win2000/20003、WinXP 和 Vista 仍然可以设置为 POSIX 模拟模式，通过安装 Microsoft Windows Services for UNIX 将一些 POSIX 调用转换为内部 API 调用- SFU 3.5 或更高版本），但是也可以通过外部库在 Windows 上获得一些 POSIX 功能（Cygwin 提供 LGPL 库，您可以将其与您的应用程序链接以在 Windows 上启用相当数量的 POSIX 功能）。

POSIX的优点不仅在于它比较普及，而且它是标准化的，你可以在网上很容易地查到这个标准。使用 POSIX 调用，您可以获得线程 ID 和进程 ID。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-06T16:47:16.140

我一直认为线程是 C++ 的外部线程。在 Java 中，该语言内置了一个本地线程。

您必须找到一个可移植的线程库。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-06T17:04:24.577

唯一的方法是使用可移植库。我推荐[Qt](http://trolltech.com/products)（它不必是 GUI 应用程序）或者[wxWidgets](http://www.wxwidgets.org/)。如果您正在开发游戏，请查看[SDL](http://www.libsdl.org/)

还可以查看 boost libs，他们可能有一些东西。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-08T11:16:03.657

您还可以使用[ACE 库](http://www.cs.wustl.edu/~schmidt/ACE.html)的一部分，它实现了一个独立于平台的包装器。查找 PID 将是库中的文件之一（可能是 ACE_Process/ACE_Thread）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-06T16:56:01.537

我不确定它们的便携性，但[Posix 线程](https://computing.llnl.gov/tutorials/pthreads/)可能是您要考虑的另一种选择。另请参见[此处](http://www.humanfactor.com/pthreads/)。我同意史蒂夫的评论——可移植到哪些平台？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-06T19:18:52.263

getpid() 是一种获取进程 ID 的可移植方式。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-01-13T14:23:43.683

我认为除非通过包装库，否则您不会找到可移植的方法。每个线程系统（例如 Windows 或 POSIX）都有自己的机制。

# regex - 正则表达式匹配 URL 行尾或“/”字符

> ID：175103
> 
> 赞同：90
> 
> 时间：2008-10-06T16:42:16.650
> 
> 标签：regex

我有一个[URL](http://en.wikipedia.org/wiki/Uniform_resource_locator)，我正在尝试将它与正则表达式匹配以提取一些组。我遇到的问题是 URL 可以以“/”和更多 URL 文本结束*或继续。*我想匹配这样的网址：

*   [http://server/xyz/2008-10-08-4](http://server/xyz/2008-10-08-4)
*   [http://server/xyz/2008-10-08-4/](http://server/xyz/2008-10-08-4/)
*   [http://server/xyz/2008-10-08-4/123/more](http://server/xyz/2008-10-08-4/123/more)

但不匹配这样的东西：

*   [http://server/xyz/2008-10-08-4-1](http://server/xyz/2008-10-08-4-1)

所以，我认为我最好的选择是这样的：

```
/(.+)/(\d{4}-\d{2}-\d{2})-(\d+)[/$] 
```

其中末尾的字符类包含“/”或行尾。不过，角色类似乎对其中的“$”不满意。我怎样才能最好地区分这些 URL，同时仍然拉回正确的组？

* * *

## 回答 #1

> 赞同：133
> 
> 时间：2008-10-06T17:05:11.423

要匹配内容的任何一个/或结尾，请使用`(/|\z)`

这仅适用于您不使用多行匹配（即您匹配的是单个 URL，而不是换行符分隔的 URL 列表）。

用你所拥有的更新版本来说明：

```
/(\S+?)/(\d{4}-\d{2}-\d{2})-(\d+)(/|\z) 
```

请注意，我已将 start 更改为对非空格 ( `\S+?`) 的非贪婪匹配，而不是匹配任何东西 ( `.*`)

* * *

## 回答 #2

> 赞同：66
> 
> 时间：2008-10-06T20:31:30.133

你现在有几个正则表达式可以做你想做的事，所以这已经被充分覆盖了。

没有提到的是为什么您的尝试不起作用：在字符类中，`$`（以及`^`,`.`和`/`）没有特殊含义，因此`[/$]`匹配文字`/`或文字`$`而不是终止正则表达式 ( `/`) 或匹配行尾 ( `$`)。

* * *

## 回答 #3

> 赞同：47
> 
> 时间：2008-10-06T16:49:57.290

```
/(.+)/(\d{4}-\d{2}-\d{2})-(\d+)(/.*)?$ 
```

**第一捕获组`(.+)`**

`.+`匹配任何字符（行终止符除外）

*   `+` **量词**——匹配**一次**到**无限**次，尽可能多次，根据需要回馈*（贪婪）*

**第二捕获组`(\d{4}-\d{2}-\d{2})`**

`\d{4}`匹配一个数字（等于`[0-9]`）

*   `{4}` **量词**——精确匹配**4**次

`-``-`从字面上匹配字符*（区分大小写）*

`\d{2}`匹配一个数字（等于`[0-9]`）

*   `{2}` **量词**——精确匹配**2**次

`-``-`从字面上匹配字符*（区分大小写）*

`\d{2}`匹配一个数字（等于`[0-9]`）

*   `{2}` **量词**——精确匹配**2**次

**`-``-`从字面上匹配字符*（区分大小写）***

**第三捕获组`(\d+)`**

`\d+`匹配一个数字（等于`[0-9]`）

*   `+` **量词**——匹配**一次**到**无限**次，尽可能多次，根据需要回馈*（贪婪）*

**第四捕获组`(.*)?`**

`?` **量词**- 匹配**0**到**1**次，尽可能多次，根据需要回馈*（贪婪）*

`.*`匹配任何字符*（行终止符除外）*

*   `*` **量词- 在****零**次和**无限**次之间匹配，尽可能多次，根据需要回馈*（贪婪）*

**`$`断言字符串末尾的位置**

* * *

## 回答 #4

> 赞同：21
> 
> 时间：2013-09-25T02:46:36.860

在 Ruby 和 Bash 中，您可以使用`$`内括号。

```
/(\S+?)/(\d{4}-\d{2}-\d{2})-(\d+)(/|$) 
```

（此解决方案类似于 Pete Boughton 的解决方案，但保留了使用 of `$`，表示行尾，而不是 using `\z`，表示字符串结束。）

# c# - 如何在 log4net 中注册自定义 IObjectRenderer？

> ID：175109
> 
> 赞同：9
> 
> 时间：2008-10-06T16:43:19.190
> 
> 标签：c#, log4net

我正在对使用 log4net 进行一些研究，发现*IObjectRenderer*接口很有趣。它将允许我们控制类型的记录方式，并提供一种不同的、可能对用户更友好的`ToString()`实现。不过，我刚开始研究 log4net，似乎找不到一种合乎逻辑的方法来以编程方式设置类型和渲染器之间的关联。

我发现这可以通过阅读[手册](http://logging.apache.org/log4net/release/manual/configuration.html#HC-13011608)在 XML 配置文件中设置，但它没有给我任何关于以编程方式添加这些的提示。在我看来，在某些情况下您宁愿使用程序化对象渲染器，所以我很好奇如何做到这一点。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-06T16:45:18.127

我在写这个问题的时候摸索了一下，想出了这个：

```
using System.IO;
using log4net;
using log4net.Config;
using log4net.ObjectRenderer;
using log4net.Util;

namespace ConsoleApplication1
{
    class Program
    {
        static void Main(string[] args)
        {
            BasicConfigurator.Configure();

            ILog log = LogManager.GetLogger(typeof(Program));
            var repo = LogManager.GetRepository();
            repo.RendererMap.Put(typeof(Foo), new FooRenderer());

            var fooInstance = new Foo() { Name = "Test Foo" };
            log.Info(fooInstance);
        }
    }

    internal class Foo
    {
        public string Name { get; set; }
    }

    internal class FooRenderer : log4net.ObjectRenderer.IObjectRenderer
    {
        public void RenderObject(RendererMap rendererMap, object obj, TextWriter writer)
        {
            if (obj == null)
            {
                writer.Write(SystemInfo.NullText);
            }

            var fooInstance = obj as Foo;
            if (fooInstance != null)
            {
                writer.Write("", fooInstance.Name);
            }
            else
            {
                writer.Write(SystemInfo.NullText);
            }
        }
    }
}
```

我不确定这是否是正确的方法，但我知道它确实有效。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-26T19:01:33.620

如果您不想以编程方式注册渲染器，也可以将此行添加到 log4net 的根目录

```
<renderer renderingClass="ConsoleApplication1.FooRenderer" renderedClass="ConsoleApplication1.Foo" /> 
```

# javascript - 鼠标停止时如何显示气球工具提示

> ID：175115
> 
> 赞同：1
> 
> 时间：2008-10-06T16:46:02.633
> 
> 标签：javascript, onmousemove, balloon

[编辑] 所以我使用了下面建议的 JavaScript 工具提示之一。我得到了提示，可以在您停下来时显示，如果您移动则隐藏。唯一的问题是当我这样做时它有效：

```
document.onmousemove = (function() {
    var onmousestop = function() {
        Tip('Click to search here');
        document.getElementById('MyDiv').onmousemove = function() {
        UnTip();
    };
    }, thread;

    return function() {
        clearTimeout(thread);
        thread = setTimeout(onmousestop, 1500);
    };
})(); 
```

但我希望该函数仅适用于特定的 div，如果我将第一行更改为 "document.getElementById('MyDiv').onmousemove = (function() {" 我得到一个 javascript 错误 document.getElementById('MyDiv' ) 为空 我错过了什么......？？

[/编辑]

当用户鼠标在元素上停止超过 1.5 秒时，我想显示气球样式消息。然后，如果他们移动鼠标，我想隐藏气球。我正在尝试使用一些在野外发布的 JavaScript 代码。这是我用来检测鼠标何时停止的代码：

```
document.onmousemove = (function() {
    var onmousestop = function() {
        //code to show the ballon
        };
    }, thread;

    return function() {
        clearTimeout(thread);
        thread = setTimeout(onmousestop, 1500);
    };
})(); 
```

所以我有两个问题。一，有没有人推荐的轻量级 javascript 气球将显示在光标位置。第二，检测鼠标停止的代码工作正常，但我对如何检测鼠标再次开始移动并隐藏气球感到困惑。谢谢...

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2010-03-04T18:04:54.593

回答这个问题有点晚了，但这将对有需要的人有所帮助。

我需要这个函数能够检测鼠标何时停止移动一段时间以在悬停在视频上时隐藏 HTML/JS 播放器控制器。这是工具提示的修改后的代码：

```
document.getElementById('MyDiv').onmousemove = (function() {
    var onmousestop = function() {
        Tip('Click to search here');
    }, thread;

    return function() {
        UnTip();
        clearTimeout(thread);
        thread = setTimeout(onmousestop, 1500);
    };
})(); 
```

在我的例子中，我使用了一些 jQuery 来为我的播放器控制器选择元素：

```
$('div.video')[0].onmousemove = (function() {
    var onmousestop = function() {
        $('div.controls').fadeOut('fast');
    }, thread;

    return function() {
        $('div.controls').fadeIn('fast');
        clearTimeout(thread);
        thread = setTimeout(onmousestop, 1500);
    };
})(); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-07T07:58:27.737

jQuery 插件[hoverIntent](http://cherne.net/brian/resources/jquery.hoverIntent.html)提供了类似的行为。它通过检查用户是否减慢鼠标移入元素并花费一定时间悬停在元素上来确定用户是否“打算”将鼠标悬停在特定元素上。

它只在用户离开元素时触发“out”事件，这听起来不像您正在寻找的东西，但代码非常简单。

当您不需要收集事件时，还要注意将事物绑定到 mousemove，mousemove 会快速触发大量事件，并且可能会对您的站点性能产生严重影响。hoverIntent 仅在光标进入活动元素时绑定 mousemove，然后取消绑定。

如果您尝试 hoverIntent 我在缩小版本没有触发“out”事件时遇到了一些问题，所以我建议使用完整的、未缩小的源。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-06T16:49:41.550

这是一个漂亮的 jQuery 插件，用于提供一个不错的浮动工具提示。

[http://jqueryfordesigners.com/demo/coda-bubble.html](http://jqueryfordesigners.com/demo/coda-bubble.html)

[编辑] 我想如果没有看到伴随的 HTML，就很难说出了什么问题。我会仔细检查该元素是否具有标签中指定的适当 ID。除此之外，除非这是一个学术练习，否则我建议使用我上面提到的 jQuery 插件之类的东西。当然，还有许多其他预先构建的工具，它们已经处理了您当前正在处理的所有细节。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-06T16:58:43.700

```
document.onmousemove = (function() {
  if($('balloon').visible) {
  //mouse is moving again
}....//your code follows 
```

使用 Prototype.js 语法，您可以在气球可见时确定鼠标已移动。

# unit-testing - ReSharper 的单元测试运行器有快捷键吗？

> ID：175116
> 
> 赞同：71
> 
> 时间：2008-10-06T16:46:07.110
> 
> 标签：unit-testing, keyboard-shortcuts, resharper, command

出于明显的生产力原因，我努力学习和使用尽可能多的各种 Re# 命令的键盘快捷键。

但是，单元测试运行器似乎没有任何关联的快捷键。我希望能够选择某些测试并能够运行或调试它们，而无需每次都使用鼠标。使用鼠标是我唯一的选择吗？

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2008-10-06T16:58:45.557

ReSharper 将项目添加到 Visual Studio 的键盘设置对话框。

去：

> 工具 -> 选项，环境 -> 键盘

在搜索栏中，键入“resharper”并查看您可以使用键盘控制的大量选项。

具体来说，有一个启动单元测试资源管理器窗口，还有一对叫做

*   ReSharper.ReSharper_UnitTest_RunSolution
*   ReSharper.ReSharper_UnitTest_RunContext

这可能是你需要的。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2009-05-12T09:38:16.263

您可以尝试... `ALT` `R` `U` `R`
- 如果您的光标在 Test 方法中，则 R# 只运行该测试
- 如果它在测试类中，但不是方法，则 R# 运行类中的所有测试

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2009-02-25T20:47:47.177

至于在解决方案中运行所有测试，命令是 Alt-RUN，即`ALT`+`R`用于 ReSharper 菜单、`U`单元测试以及`N`解决方案中的所有测试。

如果您使用 R# 快捷键，和弦 Ctrl-U, L 将始终完成这项工作。

注意：我从 stackoverflow 用户[ilya-ryzhenkov 那里找到](https://stackoverflow.com/users/18575/ilya-ryzhenkov)了一个[相关问题的答案](https://stackoverflow.com/questions/334933/resharper-run-all-unit-tests-in-a-project-or-solution-at-once)

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2013-01-04T13:20:20.910

## Resharper > 7 / Visual Studio 2012

您可以在 Visual Studio 2012 的
[Tools] > [Options] > [Environment] > [Keyboard]下定义的快捷方式中找到它们

我通常使用这些：

```
+---------------------------------+---------------- -+
| 说明 | 快捷方式 |
+---------------------------------+---------------- -+
| 在调试模式下运行测试（编辑器）| Ctrl+U、Ctrl+D |
| 运行测试（编辑器）| Ctrl+U、Ctrl+R |
| 从当前会话运行测试 | Ctrl+U, Ctrl+Y |
| 从解决方案运行测试 | Ctrl+U、Ctrl+L |
+---------------------------------+---------------- -+

```

*   Resharper.Resharper_Resharper_UnitTest_DebugContext
*   Resharper.Resharper_Resharper_UnitTest_RunContext
*   Resharper.Resharper_UnitTest_RunCurrentSession
*   Resharper.Resharper_UnitTest_RunSolution

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-05-15T21:32:45.117

对于 Resharper 4.5 OOTB：

单元测试资源管理器：`Ctrl`+ `Alt`+`U`
单元测试会话：`Ctrl`+ `Alt`+`T`
关闭活动窗口：`Shift`+`Esc`

上周我刚刚注意到我的键盘在右侧之间`Alt`和右侧有一个右键单击按钮`Ctrl`，因此不需要鼠标来鼠标进行特定测试。是的！

[通过Ben Scheirman 的](https://stackoverflow.com/users/3381/ben-scheirman)方法自定义键映射：
`ReSharper.ReSharper_UnitTest_ContextDebug`: `Alt`+ `T`, `Alt`+ `D`
`ReSharper.ReSharper_UnitTest_ContextProfile`: `Alt`+ `T`, `Alt`+ `P`
`ReSharper.ReSharper_UnitTest_ContextRun`: `Alt`+ `T`, `Alt`+`T`和 `Alt`+ `T`, `Alt`+ `R`
`ReSharper.ReSharper_UnitTest_RunSolution`: `Alt`+ `T`, `Alt`+ `S`
`ReSharper.ReSharper_UnitTest_RunSolution`: `Alt`+ `T`, `Alt`+`A`

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2013-11-05T01:10:00.050

我发现调用这些快捷方式的最简单方法是从菜单中：

```
Resharper > Unit Tests 
```

所有快捷键都显示在每个菜单项旁边。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-06T16:59:29.673

您可能想查看[此](http://www.jetbrains.com/resharper/documentation/ReSharper30DefaultKeymap.pdf)快捷备忘单。

顺便说一句，即使没有默认键，您也可以通过转到菜单工具->选项，然后到子类别 General->Keyboard 并在搜索行中键入 ReSharper 来绑定一个。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2010-03-11T07:58:37.537

自从我最初提出这个问题以来，这就是我一直在使用的：

**打开“单元测试资源管理器”和“单元测试会话”窗口**

*   [使用 ReSharper 4.5+ 中可用的键绑定](https://stackoverflow.com/questions/175116/are-there-shortcut-keys-for-resharpers-unit-test-runner/870955#870955)

**在“单元测试会话”中选择单个测试**

*   要选择测试，请使用箭头键导航

**在“单元测试会话”中选择多个测试**

*   要选择多个***连续***测试，请在`Shift`使用箭头键导航时按住该键
*   要选择多个***非连续***测试，请`Ctrl`在使用箭头键时按住键并切换`Spacebar`以选择/取消选择测试

**在“单元测试会话”中运行和执行测试**

*   按上下文菜单按钮（在大多数以 Windows 为中心的键盘上的`Alt`和按钮之间）`Ctrl`

或者

*   或者，按`Shift`+`F10`

*   在上下文窗口中使用箭头键导航并点击`Enter`任何选择

或者

*   对于`Run Selected Tests`, 按`R`+`Enter`

*   ,`Debug Selected Tests`按`D`

**选择调用堆栈错误行超链接**

*   如果测试失败并且调用堆栈显示为拆分“会话”窗口，请按`Tab`以从测试部分导航到下部的错误链接

*   跳转到特定错误行后，点击 `Enter`以转到出现运行时错误的代码行

*   根据需要按`Shift`+`Tab`多次从调用堆栈（下部）部分返回到单元测试（上部）部分

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-06-25T20:05:26.243

我知道这是一个老问题，但它是该主题的 Google 结果中最重要的 SO 问题，所以添加，以防万一。

使用 Resharper V6，它从一些开箱即用的键盘映射设置开始：

[http://blogs.jetbrains.com/dotnet/2011/08/new-features-in-resharper-6-unit-test-runner/](http://blogs.jetbrains.com/dotnet/2011/08/new-features-in-resharper-6-unit-test-runner/)

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2012-06-26T14:24:00.787

## 运行当前会话命令

*您可以在单元测试会话*窗口的测试会话选项卡中收集您的测试。然后，您可以通过运行命令***ReSharper.ReSharper_UnitTest_RunCurrentSession***来运行所有这些测试。 *ReSharper.ReSharper_UnitTest_RunCurrentSession*命令在我的*Visual Studio*中分配给`Ctrl`+ `R`, `Ctrl`+ 。`U`

 ** * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-06T17:00:06.347

可悲的是，没有，但我发现[了这个](http://intellij.net/forums/thread.jspa?threadID=277312)论坛帖子

> VS2008 的 Tools - Options - Keybaord 对话框中列出了用于 resharper 单元测试运行器的命令
> 
> Resharper.Resharper_UnitTest_ContextRun Resharper.Resharper_UnitTest_RunCurrentSession Resharper.Resharper_UnitTest_RunSolution
> 
> 您是否尝试过为这些分配键盘快捷键，因为我使用 MSTF 和它自己的测试运行器，我使用它的快捷键 ctrl r + a 运行我的所有测试，并运行单个测试我要么点击 resharper 图标（我有Gallio 已安装）或使用 testdriven.net 上下文菜单运行测试。

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2018-05-29T08:08:08.153

它在自己或网站上编写快捷方式。运行单元测试：`Ctrl`+ `T`，`R`
调试单元测试：`Ctrl`+ `T`，`D`
从解决方案运行所有测试：`Ctrl`+ `T`，`Ctrl`+`L`
运行当前会话：`Ctrl`+ `T`，`Y`
重复上一次运行：`Ctrl`+ `T`，`T`
将测试附加到会话：`Ctrl`+ `T`，`Ctrl`+`A`
创建新会话：`Ctrl`+ `T`，`N`
单元测试：`Ctrl`+ `Alt`+`T`
单元测试会议：`Ctrl`+ `Alt`+ `R`
[https://www.jetbrains.com/help/resharper/Reference__Keyboard_Shortcuts.html#unit_testing](https://www.jetbrains.com/help/resharper/Reference__Keyboard_Shortcuts.html#unit_testing)

[![在此处输入图像描述](https://i.stack.imgur.com/kT8e4.png)](https://i.stack.imgur.com/kT8e4.png)

# .net - 在 .NET 中使用线程本地存储的最佳实践是什么？

> ID：175129
> 
> 赞同：7
> 
> 时间：2008-10-06T16:47:54.440
> 
> 标签：.net, multithreading, thread-local

我的应用程序中有一个要求，我认为可以通过使用线程本地存储来满足，但我想知道这是否是最好避免的事情之一。

我已经阅读了一些关于这个主题的文章：

[http://www.dotnetcoders.com/web/Articles/ShowArticle.aspx?article=58](http://www.dotnetcoders.com/web/Articles/ShowArticle.aspx?article=58)

[http://msdn.microsoft.com/en-us/library/system.threadstaticattribute(vs.80).aspx](http://msdn.microsoft.com/en-us/library/system.threadstaticattribute(vs.80).aspx)

我知道*如何*使用它，我只是想知道我*是否应该*使用它。

有什么建议，需要注意的地方吗？

**[编辑]**

这是用例：

我通过一些方法汇集所有数据访问，这些方法对每个查询进行大量记录。我记录的一件事是命令文本的完整转储，其中填充了命令，以便我可以简单地从跟踪日志中直接复制粘贴到 Sql Management Studio 中。

在我的网络应用程序的 global.asax 中，当我遇到未处理的异常时，我会向管理员发送尽可能多的信息的电子邮件。当我收到 SqlException 时，我想将该 sql 命令转储文本放入这封电子邮件中，这将节省我在页面因查询而崩溃时挖掘跟踪日志的时间。

我不想更改我的数据访问类的方法签名，这样我就可以一直向下传递一些引用，只是为了在遇到异常时将其取出。我在想也许 TLS 是放置“lastsqlcommand”之类的好地方，但这看起来不是一个可行的解决方案。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-06T16:53:41.417

asp.net 应用程序的一个陷阱：单个请求的处理可能会切换线程，即如果同一会话中有并行请求。因此，您在 HttpApplication.PostRequireRequestState 事件之前放入 TLS 的任何内容都可能稍后不会出现，因为您在不同的线程上。

**[提问者编辑]**

对于我的特定用例，我最终将键值对添加到 SqlException.Data 字典中，然后在记录异常详细信息时检索它。这给了我希望使用线程本地存储的功能。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-06T17:26:28.010

线程本地存储是修复在线程之前设计并使用大量全局变量和静态的库的一种快速方法。这是 C 标准库在不更改其接口的同时保持线程安全的方式（在内部，许多函数使用静态缓冲区）。

一般来说，这对这个目的是有好处的。如果您必须在多线程环境中拥有全局数据，那么线程本地存储是一个不错的选择。一个常见的原因是您正在调用一个第三方函数，该函数在同一个堆栈帧中回调您，但没有为您提供传递额外信息的钩子——当您尝试将较旧的 C 库包装在。网。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-02-29T10:32:41.933

通过示例查看新的 .net 4 [ThreadLocal<T>](http://msdn.microsoft.com/en-us/library/dd642243.aspx)类，[这里](http://reedcopsey.com/2009/11/12/thread-specific-data-becomes-easier-in-net-4-0-via-threadlocalt/)有更多信息。

# sql-server - 使用存储过程进行计算

> ID：175131
> 
> 赞同：1
> 
> 时间：2008-10-06T16:48:18.867
> 
> 标签：sql-server, database, stored-procedures

我目前正在开展一个项目，该项目将在 MS SQL 数据库中存储有关我们客户的特定财务信息。之后，我们的用户需要能够查询数据库，以根据特定条件（例如，大于特定规模的客户端、特定地理位置的客户端）从客户端返回数据，并将其汇总以用作基准。我们的财务软件将使用脚本访问该数据库。

我目前正在为数据库编写存储过程。我打算做的是根据可以使用的不同类型的标准编写几个不同的存储过程。他们将返回客户编号。

我的实际问题是检索数据的方法。我需要对客户数据进行几种不同的计算。让不同的存储过程根据客户端编号进行计算并返回结果是更好的做法，还是让存储过程返回有关客户端的所有信息并在脚本中执行计算更好？

性能可能是一个问题，因为数据库中会有很多客户端，所以我希望该方法相当有效。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-06T16:52:31.013

有趣的是，数据仓库人员一直都在这样做。他们经常使用最简单的 SQL（SELECT SUM/COUNT...GROUP BY...），并在报告编写工具中完成数据库*之外的工作。*

我认为您应该获得一份 The Data Warehouse Toolkit 的副本，并看看如何以一种相当简单的方式完成这项工作。更灵活，可能更具可扩展性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-06T16:51:09.657

我认为这在很大程度上与所涉及的数据和您正在执行的操作有关。我通常发现，在进行减少从数据库（分组和聚合）返回的大小的计算时，在数据库中执行它会更有效。当您开始进行其他计算时，它并不那么明确。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-06T16:52:24.740

在大多数情况下，就像我认为您所描述的那样，使用存储过程更有效，但是在某些极端情况下并非如此。最好的答案是尝试两种方法并进行一些负载测试以确定哪种方法最有效。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-06T16:56:17.010

这真的取决于操作。很有可能将这些东西作为数据库中的计算列，在视图或 SP（或使用 UDF）中预先计算它们，在 ETL 或汇总阶段单独计算并存储它们，或者让客户来做。

我会避免让客户做任何事情，除非你知道你可以始终如一地控制计算，这样他们就不会犯错误（所有独立完成工作的报告作者都是灾难的根源），特别是如果计算规则可能改变。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-06T16:53:33.630

SQL Server 是一个关系数据存储。我建议每次计算一个存储过程，它为客户端执行相同的计算。只需将ID作为参数传入即可获取客户端的具体结果。

“性能可能是一个问题，因为会有很多客户”......这取决于表的规范化和索引方式。除非您完全了解索引的真正含义，否则不要对每一列进行索引。

编辑〜查看您的计算。有些可以卸载到前端客户端。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-06T16:53:55.907

从您的问题看来，最有效的方法是在 SP 中进行所有计算并将单个（？）结果返回到您的脚本。

如果您决定在脚本中进行处理，则应确保将检索到的数据限制在必要的范围内，并确保尽可能少地往返数据库。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-06T17:11:20.820

如果确定计算结果的业务规则容易更改，请不要在存储过程中编写此类代码。更好的地方是控制器（MVC 中的 C）。这些规则将是可插入的并且易于更改。

同样从可扩展性的角度来看，复制应用服务器并不像复制数据库服务器那样昂贵。

这并不意味着不能使用存储过程。报告生成将是使用存储过程完成计算的理想候选者之一。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-06T19:17:11.733

考虑是否需要数据仓库。为报告而优化的数据库与为数据输入而优化的数据库非常不同。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-07T14:11:41.617

你所说的一切让我认为你应该考虑存储你的数据。如果您发现自己针对 OLTP 系统编写复杂的连接并需要额外的计算（听起来确实如此），那么对数据进行非规范化并将预先计算的聚合存储在仓库中将使您的生活变得更加简单。

尽管每个人似乎都想向您扔大量书籍和产品，但如果您的问题空间是离散的并且您的源数据管理良好，那么任务通常是微不足道的。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2012-10-16T12:35:50.180

您可以在存储过程中进行任何计算并返回数据。像存储过程这样的利息计算需要大量的计算。

您必须以任何方式使用其他表数据计算数据。

SUM我们可以在SP中做，

```
Declare @SUMAmount decimal(12,3) 
```

-- 还声明@A、@B 等

```
Select @SUMAmount= SUM(ISNULL(@A,0)+ISNULL(@B,0)+ISNULL(@C,0)+ISNULL(@D,0))

Select @SUMAmount= SUM((ISNULL(@A,0)+ISNULL(@B,0))*(ISNULL(@C,0)-ISNULL(@D,0))) 
```

根据您的要求，您可以提供条件。

ISNULL 用于检查数据是否为 ​​NULL，然后返回 0。无法使用 Null 值进行计算，因此最好给出 ISNULL 条件。

```
Select A,B,SUM(C),D From TableName
Where SUM(C)>0
Group By A,B,D 
```

这里有聚合函数和非聚合函数，所以你必须使用 Group By。您可以根据您的条件获取值，例如：“SUM(C)>0”。Group By 之后也可以在这里使用。

```
 Declare @TotalNoofDays  int
 @TotalNoofDays = DATEDIFF(d, fromdate, todate) 
```

用于查找使用此功能的天数。

您可以使用类似的条件，

```
if @DueAmount >=0
BEGIN
IF @DiscountFlag = 1
BEGIN
SET @DueIntAmount   = 0
END
ELSE
   BEGIN
     SET @DueIntAmount  = ((@DueAmount*(@IntRateOnDue/100))/365)*@NoofDays
   END
  SET @ExcessInterestAmount = 0
END
ELSE
BEGIN
SET @DueIntAmount   = 0
SET @ExcessInterestAmount = ((@DueAmount*(@IntRateOnDeposit/100))/365)*@NoofDays
 END 
```

就像您可以在存储过程中进行的计算一样。

如果要对记录数一一进行计算，则可以使用临时表while循环..

```
 Create Proc NewLearningProcedure
 (
   @Name Varchar(50),
   @Date DateTime
 )
 AS
 Begin

Declare @Temp Table
(
   ID int Identity(1,1),
   Name Varchar(50),
   Date DateTime
)

Insert Into @Temp
Select @Name,@Date

Declare @i int
set @i=10

While @i>0
Begin
  Insert Into @Temp
  Select @Name+CAST(@i as varchar(50)),@Date

  Set @i=@i-1
 End

 Select * from @Temp

 End 
```

就像您可以使用存储过程做任何事情一样。

# php - 如何使用 PHP SimpleTest 框架设置数据库测试

> ID：175153
> 
> 赞同：6
> 
> 时间：2008-10-06T16:52:44.193
> 
> 标签：php, database, unit-testing, tdd, simpletest

我正在使用 SimpleTest，一个基于 PHP 的单元测试框架。我正在测试将处理从数据库存储和检索网站评论的新代码。我不知道如何构建项目来测试数据库访问代码。

我正在寻找有关在 PHP 应用程序中测试数据库代码的最佳实践的任何建议。例子真的很棒。进一步阅读的网站很棒。

非常感谢你。:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-03-03T20:28:33.747

这是一个老问题，但我想我会添加一些我们在这方面的具体经验。

其他海报在技术上是正确的，这是一种集成测试形式，但从我所在的位置来看，MySQL 中的逻辑通常太多，无法在单元测试中剔除。如果您像我们一样拥有严重依赖 MySQL 的大型复杂服务（通常每个服务有多个表），那么拥有一个包含测试查询逻辑的强大测试框架非常方便。我们在单元测试中模拟了很多依赖项，但没有模拟 MySQL。

我们有一组包装 simpletest 的类来提供这个功能。它的工作原理是这样的：

*   创建每个数据库表的指令存储在一个文件中`tests/etc/schemas/table.sql`。它包含模式数据以及测试期望找到的所有预设数据的插入。
*   每个需要数据库的测试都扩展了一个`Test_DbCase`类，该类提供构建表的功能。
*   引导类负责在构造和销毁时创建和删除数据库。
*   在运行时，测试调用`loadTables('foo', 'bar')`setUp 方法执行 和 中的 sql`foo.sql`命令`bar.sql`。
*   测试是针对预设数据运行的。其余的很明显。

我们拥有的另一个工具是 bash 脚本，它可以更轻松地创建`table.sql`文件。这真的很方便，因为否则我们将手动编写 SQL - 您可以获取一组现有的表，在 MySQL 中设置所有数据，然后将其导出以创建测试文件。

这对我们来说非常有效，尽管我们最终不得不自己推出很多。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-06T16:56:50.007

我有一个本地数据库，专门用于使用已知名称和数据库用户名/密码进行单元测试。单元测试被硬编码到该位置，但不同的开发人员可以根据需要覆盖这些变量。

然后在每次测试你`TRUNCATE`每张桌子之前。这比删除/创建表或数据库本身要快得多*。*

注意：不要*在*测试后截断！这样，如果测试失败，您将获得数据库的当前状态，这通常有助于诊断问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-08T06:19:48.543

您可能希望允许 PHP 创建并向临时表/数据库提供数据并在该表/数据库上进行测试。然后您不必手动重置数据库。大多数框架都有数据库操作库以使其更容易。前端可能需要一些时间，但稍后进行更改时可以让您更快地进行测试。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-06T20:16:56.093

When testing database code, it's good to always have the same database as the starting point. Especially if you do unit-testing (which I assume is the case here). One of the ways is to truncate all tables as Jason suggested, but I prefer to have some starting data in it. You know, you always need to have some 'default' data that is present in each database.

Also, some tests only make sense with full database. So, create a special instance of database for those tests. I have about 3 or 4 different databases that I plug-in (just copy the files in) before running some tests. Having the same starting point each time ensures repeatability.

So, just prepare a few database states that are good 'starting points' and back them up. Before running each set of tests, restore appropriate database, and then run it.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-09T20:38:02.630

如果您真的想针对数据库进行测试，我建议您在每次测试之前导入数据/创建表。这样，您的数据库就从每次测试的已知状态开始。由于这相当耗费性能，因此您可以`setUp`在`tearDown`. MySql（可能是您正在使用的 RDBMS）不支持嵌套事务，因此如果被测代码使用事务，您可能会遇到麻烦。您可以使用[savepoints](http://dev.mysql.com/doc/refman/5.0/en/savepoints.html)解决此问题。测试前设置保存点，测试后回滚到保存点。

我仍然坚持认为，如果你需要很多，你应该考虑你的测试试图告诉你一些事情的可能性..

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-09T00:40:19.727

我鼓励您*不要*尝试使用 SimpleTest 测试数据库访问代码。

相反，使用例如 Selenium 为您的应用程序创建一个功能测试：当您从数据库的已知状态开始时记录一个测试用例；然后添加评论并检查（使用 Selenium 的断言）内容确实存在。

这样： - 更易于设置和维护 - 您不仅可以验证 DB 层，还可以验证表示层

也就是说，如果您的数据库中有存储过程，*请*使用 SimpleTest - 我自己已经成功完成了。基本上，创建从已知 DB 状态开始的 SimpleTest，然后执行一些 INSERTS/UPDATES，然后运行存储的 proc 并确保 DB 的状态是您所期望的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-03-01T15:24:16.543

我认为您应该使用 ORM，并为此编写一些集成测试。如果集成测试显示它在实际环境下可以完美运行，那么只有在更改环境（数据库、php 版本、平台等）时才需要再次测试它。之后，您可以模拟 ORM 对象，而无需连接到数据库。

所以我认为这是最好的方法，但是如果您不想使用 ORM，那么您可以创建一个测试数据库并模拟数据库连接（PDO）对象。在这种情况下，您可以在 testCases 的 setUp 和 tearDown 部分创建和删除测试表。重要的是这些是集成测试，而不是单元测试，所以你不需要总是运行它们，只有在 PHP 和 SQL 服务器之间发生变化时才需要运行它们。在使用集成测试测试数据访问对象后，您必须在单元测试中模拟它们。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-06T18:10:57.720

对数据库进行测试通常表明测试不好，这可能是由于被测代码中缺乏封装。您应该尽量将与数据库交互的代码与其余代码隔离开来，让交互层保持简单，以便您可以通过一些非常基本的测试来摆脱困境。

换句话说; 处理注释的代码不应与处理数据库交互的代码相同。例如，您可以编写一个通用表模块，您的评论模型使用它来访问数据库。您仍然需要测试 table 模块，但这应该与注释代码隔离开来。

# msdn - MSDN 许可证的便宜地方

> ID：175156
> 
> 赞同：7
> 
> 时间：2008-10-06T16:53:15.147
> 
> 标签：msdn

有人问了一个类似的问题：[MSDN 订阅便宜吗？](https://stackoverflow.com/questions/42466/msdn-subscriptions-on-the-cheap)，但我对提供的解决方案不感兴趣：

*   我不是在开发销售产品，而是在创办一家咨询公司，所以 Empower 不是一个选择。
*   我已经访问了有关 MSDN 订阅的 MS 链接，但它们*并没有*指出获得廉价副本的方法。
*   我对我成为 MVP 的建议不感兴趣。坦率地说，我希望专注于发展我的公司，而不是跳过 MS 的圈套。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-06T16:57:53.560

真的只有几个选项可用

1.  以标准价格购买
2.  成为 Microsoft 认证合作伙伴，享受优惠折扣（实际上比您想象的要简单得多，我在不到 2 周的时间内就为我的企业做到了）
3.  寻找愿意分享免费赠品的 MVP 好友

但实际上，这些是唯一的合法选择。你也可以试着打电话给微软，你永远不知道会发生什么，他们有许多不一定公开宣传的特殊程序。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-08T22:24:45.217

您想要的是 Action Pack：[https](https://partner.microsoft.com/US/40016455) ://partner.microsoft.com/US/40016455 。

（请注意，作为 Microsoft 的员工，如果 LiveID 尚未附加到注册合作伙伴，您必须注销您的 LiveID 才能看到此页面，对此我深表歉意。）

您无需获得认证即可访问此功能，只需注册即可（合作伙伴关系分为三个级别：1\. 注册、2\. 认证、3\. 金牌认证）。不过，您确实必须通过一个相当简单的评估测试。

有关该过程的概述，请参阅[https://partner.microsoft.com/US/40082823](https://partner.microsoft.com/US/40082823)中引用的 pdf 。

最后一件事 - 如果您是学生（我怀疑 OP 不是），您可以从[http://www.dreamspark.com](http://www.dreamspark.com)免费获得许多 Microsoft 工具。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-22T04:07:16.123

您的咨询公司肯定需要一个 ASP.NET 网站，也许您的客户想要一个可以直接与您网站上的 Web 服务对话的小部件？有你的产品。

此外，请查看 Empower 文档中的“增值服务”。

我参加了 Empower 计划——因此，确实没有任何进入障碍。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-06T17:00:43.290

我以前直接通过 MS，但现在，我总是通过[Xtras.net](http://www.xtras.net/)订购我的- 他们有很好的多年折扣，你可以通过 Microsoft 的网站正常管理订阅。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-06T17:05:02.627

Empower 是否要求“主要”用途是开发产品？您也可以随时开发产品 - 不必非常成功，也许可以在窗口中显示时间？

# arrays - 如何在 Excel VBA 中对数组进行切片？

> ID：175170
> 
> 赞同：35
> 
> 时间：2008-10-06T16:54:46.750
> 
> 标签：arrays, excel, vba, worksheet-function

我可以在 Excel VBA 中使用什么函数对数组进行切片？

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2008-10-06T16:57:07.977

> **Application.WorksheetFunction.Index（数组，行，列）**

如果您为行或列指定零值，那么您将获得指定的整个列或行。

例子：

> Application.WorksheetFunction.Index(array, 0, 3)

这将为您提供整个第 3 列。

如果您将行和列都指定为非零，那么您将仅获得特定元素。没有简单的方法来获得比完整的行或列更小的切片。

**限制**`WorksheetFunction.Index`：如果您使用的是较新版本的 Excel，则可以处理的数组大小存在限制。如果`array`超过 65,536 行或 65,536 列，则会引发“类型不匹配”错误。如果这对您来说是个问题，那么请参阅不受相同限制的[更复杂的答案。](https://stackoverflow.com/a/24843721/119775)

这是我编写的用于执行所有 1D 和 2D 切片的函数：

```
Public Function GetArraySlice2D(Sarray As Variant, Stype As String, Sindex As Integer, Sstart As Integer, Sfinish As Integer) As Variant

' this function returns a slice of an array, Stype is either row or column
' Sstart is beginning of slice, Sfinish is end of slice (Sfinish = 0 means entire
' row or column is taken), Sindex is the row or column to be sliced
' (NOTE: 1 is always the first row or first column)
' an Sindex value of 0 means that the array is one dimensional 3/20/09 ljr

Dim vtemp() As Variant
Dim i As Integer

On Err GoTo ErrHandler

Select Case Sindex
    Case 0
        If Sfinish - Sstart = UBound(Sarray) - LBound(Sarray) Then
            vtemp = Sarray
        Else
            ReDim vtemp(1 To Sfinish - Sstart + 1)
            For i = 1 To Sfinish - Sstart + 1
                vtemp(i) = Sarray(i + Sstart - 1)
            Next i
        End If
    Case Else
        Select Case Stype
            Case "row"
                If Sfinish = 0 Or (Sstart = LBound(Sarray, 2) And Sfinish = UBound(Sarray, 2)) Then
                    vtemp = Application.WorksheetFunction.Index(Sarray, Sindex, 0)
                Else
                    ReDim vtemp(1 To Sfinish - Sstart + 1)
                    For i = 1 To Sfinish - Sstart + 1
                        vtemp(i) = Sarray(Sindex, i + Sstart - 1)
                    Next i
                End If
            Case "column"
                If Sfinish = 0 Or (Sstart = LBound(Sarray, 1) And Sfinish = UBound(Sarray, 1)) Then
                    vtemp = Application.WorksheetFunction.Index(Sarray, 0, Sindex)
                Else
                    ReDim vtemp(1 To Sfinish - Sstart + 1)
                    For i = 1 To Sfinish - Sstart + 1
                        vtemp(i) = Sarray(i + Sstart - 1, Sindex)
                    Next i
                End If
        End Select
End Select
GetArraySlice2D = vtemp
Exit Function

ErrHandler:
    Dim M As Integer
    M = MsgBox("Bad Array Input", vbOKOnly, "GetArraySlice2D")

End Function 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2014-07-19T18:40:37.137

下面是一种对 Excel 变体数组进行切片的快速方法。其中大部分是使用来自这个优秀网站[http://bytecomb.com/vba-reference/的信息放在一起的](http://bytecomb.com/vba-reference/)

本质上，目标数组被预先构建为一个空的 1d 或 2d 变体，并与源数组和要切片的元素索引一起传递给子。由于数组存储在内存中的方式，对列进行切片比对行进行切片要快得多，因为内存布局允许复制单个块。

这样做的好处是它的扩展性远远超出了 Excel 行数限制。

![在此处输入图像描述](https://i.stack.imgur.com/S4EnX.png)

```
Option Explicit

#If Win64 Then
    Public Const PTR_LENGTH As Long = 8
    Public Declare PtrSafe Function GetTickCount Lib "kernel32" () As Long
    Public Declare PtrSafe Sub Mem_Copy Lib "kernel32" Alias "RtlMoveMemory" (ByRef Destination As Any, ByRef Source As Any, ByVal Length As Long)
    Private Declare PtrSafe Function VarPtrArray Lib "VBE7" Alias "VarPtr" (ByRef Var() As Any) As LongPtr
    Private Declare PtrSafe Sub CopyMemory Lib "kernel32" Alias "RtlMoveMemory" (Destination As Any, Source As Any, ByVal Length As Long)
    Private Declare PtrSafe Sub FillMemory Lib "kernel32" Alias "RtlFillMemory" (Destination As Any, ByVal Length As Long, ByVal Fill As Byte)
#Else
    Public Const PTR_LENGTH As Long = 4
    Public Declare Function GetTickCount Lib "kernel32" () As Long
    Public Declare Sub Mem_Copy Lib "kernel32" Alias "RtlMoveMemory" (ByRef Destination As Any, ByRef Source As Any, ByVal Length As Long)
    Private Declare Function VarPtrArray Lib "VBE7" Alias "VarPtr" (ByRef Var() As Any) As LongPtr
    Private Declare Sub CopyMemory Lib "kernel32" Alias "RtlMoveMemory" (Destination As Any, Source As Any, ByVal Length As Long)
    Private Declare Sub FillMemory Lib "kernel32" Alias "RtlFillMemory" (Destination As Any, ByVal Length As Long, ByVal Fill As Byte)
#End If

Private Type SAFEARRAYBOUND
    cElements    As Long
    lLbound      As Long
End Type

Private Type SAFEARRAY_VECTOR
    cDims        As Integer
    fFeatures    As Integer
    cbElements   As Long
    cLocks       As Long
    pvData       As LongPtr
    rgsabound(0) As SAFEARRAYBOUND
End Type

Sub SliceColumn(ByVal idx As Long, ByRef arrayToSlice() As Variant, ByRef slicedArray As Variant)
'slicedArray can be passed as a 1d or 2d array
'sliceArray can also be part bound, eg  slicedArray(1 to 100) or slicedArray(10 to 100)
Dim ptrToArrayVar As LongPtr
Dim ptrToSafeArray As LongPtr
Dim ptrToArrayData As LongPtr
Dim ptrToArrayData2 As LongPtr
Dim uSAFEARRAY As SAFEARRAY_VECTOR
Dim ptrCursor As LongPtr
Dim cbElements As Long
Dim atsBound1 As Long
Dim elSize As Long

    'determine bound1 of source array (ie row Count)
    atsBound1 = UBound(arrayToSlice, 1)
    'get pointer to source array Safearray
    ptrToArrayVar = VarPtrArray(arrayToSlice)
    CopyMemory ptrToSafeArray, ByVal ptrToArrayVar, PTR_LENGTH
    CopyMemory uSAFEARRAY, ByVal ptrToSafeArray, LenB(uSAFEARRAY)
    ptrToArrayData = uSAFEARRAY.pvData
    'determine byte size of source elements
    cbElements = uSAFEARRAY.cbElements

    'get pointer to destination array Safearray
    ptrToArrayVar = VarPtr(slicedArray) + 8 'Variant reserves first 8bytes
    CopyMemory ptrToSafeArray, ByVal ptrToArrayVar, PTR_LENGTH
    CopyMemory uSAFEARRAY, ByVal ptrToSafeArray, LenB(uSAFEARRAY)
    ptrToArrayData2 = uSAFEARRAY.pvData

    'determine elements size
    elSize = UBound(slicedArray, 1) - LBound(slicedArray, 1) + 1
    'determine start position of data in source array
    ptrCursor = ptrToArrayData + (((idx - 1) * atsBound1 + LBound(slicedArray, 1) - 1) * cbElements)
    'Copy source array to destination array
    CopyMemory ByVal ptrToArrayData2, ByVal ptrCursor, cbElements * elSize

End Sub

Sub SliceRow(ByVal idx As Long, ByRef arrayToSlice() As Variant, ByRef slicedArray As Variant)
'slicedArray can be passed as a 1d or 2d array
'sliceArray can also be part bound, eg  slicedArray(1 to 100) or slicedArray(10 to 100)
Dim ptrToArrayVar As LongPtr
Dim ptrToSafeArray As LongPtr
Dim ptrToArrayData As LongPtr
Dim ptrToArrayData2 As LongPtr
Dim uSAFEARRAY As SAFEARRAY_VECTOR
Dim ptrCursor As LongPtr
Dim cbElements As Long
Dim atsBound1 As Long
Dim i As Long

    'determine bound1 of source array (ie row Count)
    atsBound1 = UBound(arrayToSlice, 1)
    'get pointer to source array Safearray
    ptrToArrayVar = VarPtrArray(arrayToSlice)
    CopyMemory ptrToSafeArray, ByVal ptrToArrayVar, PTR_LENGTH
    CopyMemory uSAFEARRAY, ByVal ptrToSafeArray, LenB(uSAFEARRAY)
    ptrToArrayData = uSAFEARRAY.pvData
    'determine byte size of source elements
    cbElements = uSAFEARRAY.cbElements

    'get pointer to destination array Safearray
    ptrToArrayVar = VarPtr(slicedArray) + 8 'Variant reserves first 8bytes
    CopyMemory ptrToSafeArray, ByVal ptrToArrayVar, PTR_LENGTH
    CopyMemory uSAFEARRAY, ByVal ptrToSafeArray, LenB(uSAFEARRAY)
    ptrToArrayData2 = uSAFEARRAY.pvData

    ptrCursor = ptrToArrayData + ((idx - 1) * cbElements)
    For i = LBound(slicedArray, 1) To UBound(slicedArray, 1)

        CopyMemory ByVal ptrToArrayData2, ByVal ptrCursor, cbElements
        ptrCursor = ptrCursor + (cbElements * atsBound1)
        ptrToArrayData2 = ptrToArrayData2 + cbElements
    Next i

End Sub 
```

示例用法：

```
Sub exampleUsage()
Dim sourceArr() As Variant
Dim destArr As Variant
Dim sliceIndex As Long

    On Error GoTo Err:

    sourceArr = Sheet1.Range("A1:D10000").Value2
    sliceIndex = 2 'Slice column 2 / slice row 2

    'Build target array
    ReDim destArr(20 To 10000) '1D array from row 20 to 10000
'    ReDim destArr(1 To 10000) '1D array from row 1 to 10000
'    ReDim destArr(20 To 10000, 1 To 1) '2D array from row 20 to 10000
'    ReDim destArr(1 To 10000, 1 To 1) '2D array from row 1 to 10000

    'Slice Column
    SliceColumn sliceIndex, sourceArr, destArr

    'Slice Row
    ReDim destArr(1 To 4)
    SliceRow sliceIndex, sourceArr, destArr

Err:
    'Tidy Up See ' http://stackoverflow.com/questions/16323776/copy-an-array-reference-in-vba/16343887#16343887
    FillMemory destArr, 16, 0

End Sub 
```

使用以下测试在旧的双核 CPU 上计时

```
Sub timeMethods()
Const trials As Long = 10
Const rowsToCopy As Long = 1048576
Dim rng As Range
Dim Arr() As Variant
Dim newArr As Variant
Dim newArr2 As Variant
Dim t As Long, t1 As Long, t2 As Long, t3 As Long
Dim i As Long

    On Error GoTo Err

    'Setup Conditions 1time only
    Sheet1.Cells.Clear
    Sheet1.Range("A1:D1").Value = Split("A1,B1,C1,D1", ",") 'Strings
'    Sheet1.Range("A1:D1").Value = Split("1,1,1,1", ",") 'Longs
    Sheet1.Range("A1:D1").AutoFill Destination:=Sheet1.Range("A1:D" & rowsToCopy), Type:=xlFillDefault

    'Build source data
    Arr = Sheet1.Range("A1:D" & rowsToCopy).Value
    Set rng = Sheet1.Range("A1:D" & rowsToCopy)

    'Build target container
    ReDim newArr(1 To rowsToCopy)
    Debug.Print "Trials=" & trials & " Rows=" & rowsToCopy
    'Range
    t3 = 0
    For t = 1 To trials
        t1 = GetTickCount

            For i = LBound(newArr, 1) To UBound(newArr, 1)
                newArr(i) = rng(i, 2).Value2
            Next i

        t2 = GetTickCount
        t3 = t3 + (t2 - t1)
        Debug.Print "Range: " & t2 - t1
    Next t
    Debug.Print "Range Avg ms: " & t3 / trials

    'Array
    t3 = 0
    For t = 1 To trials
        t1 = GetTickCount

            For i = LBound(newArr, 1) To UBound(newArr, 1)
                newArr(i) = Arr(i, 2)
            Next i

        t2 = GetTickCount
        t3 = t3 + (t2 - t1)
        Debug.Print "Array: " & t2 - t1
    Next t
    Debug.Print "Array Avg ms: " & t3 / trials

    'Index
    t3 = 0
    For t = 1 To trials
        t1 = GetTickCount

            newArr2 = WorksheetFunction.Index(rng, 0, 2) 'newArr2 2d

        t2 = GetTickCount
        t3 = t3 + (t2 - t1)
        Debug.Print "Index: " & t2 - t1
    Next t
    Debug.Print "Index Avg ms: " & t3 / trials

    'CopyMemBlock
    t3 = 0
    For t = 1 To trials
        t1 = GetTickCount

            SliceColumn 2, Arr, newArr

        t2 = GetTickCount
        t3 = t3 + (t2 - t1)
        Debug.Print "CopyMem: " & t2 - t1
    Next t
    Debug.Print "CopyMem Avg ms: " & t3 / trials

Err:
    'Tidy Up
    FillMemory newArr, 16, 0

End Sub 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-06-02T04:51:39.007

两件事，VBA 不支持数组切片，所以无论你使用什么，你都必须自己动手。但由于这仅适用于 Excel，因此您可以使用内置工作表函数索引进行数组切片。

```
Sub Test()
    'All example return a 1 based 2D array.
    Dim myArr As Variant 'This var must be generic to work.
    'Get whole range:
    myArr = ActiveSheet.UsedRange
    'Get just column 1:
    myArr = WorksheetFunction.Index(ActiveSheet.UsedRange, 0, 1)
    'Get just row 5
    myArr = WorksheetFunction.Index(ActiveSheet.UsedRange, 5, 0)
End Sub 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2011-09-21T18:39:45.010

Lance 的解决方案有一个错误，即它不尊重具有未指定长度的子数组的偏移起始值，我还发现它的工作原理相当混乱。我在下面提供了一个（希望）更透明的解决方案。

```
Public Function GetSubTable(vIn As Variant, Optional ByVal iStartRow As Integer, Optional ByVal iStartCol As Integer, Optional ByVal iHeight As Integer, Optional ByVal iWidth As Integer) As Variant
    Dim vReturn As Variant
    Dim iInRowLower As Integer
    Dim iInRowUpper As Integer
    Dim iInColLower As Integer
    Dim iInColUpper As Integer
    Dim iEndRow As Integer
    Dim iEndCol As Integer
    Dim iRow As Integer
    Dim iCol As Integer

    iInRowLower = LBound(vIn, 1)
    iInRowUpper = UBound(vIn, 1)
    iInColLower = LBound(vIn, 2)
    iInColUpper = UBound(vIn, 2)

    If iStartRow = 0 Then
        iStartRow = iInRowLower
    End If
    If iStartCol = 0 Then
        iStartCol = iInColLower
    End If

    If iHeight = 0 Then
        iHeight = iInRowUpper - iStartRow + 1
    End If
    If iWidth = 0 Then
        iWidth = iInColUpper - iStartCol + 1
    End If

    iEndRow = iStartRow + iHeight - 1
    iEndCol = iStartCol + iWidth - 1

    ReDim vReturn(1 To iEndRow - iStartRow + 1, 1 To iEndCol - iStartCol + 1)

    For iRow = iStartRow To iEndRow
        For iCol = iStartCol To iEndCol
            vReturn(iRow - iStartRow + 1, iCol - iStartCol + 1) = vIn(iRow, iCol)
        Next
    Next

    GetSubTable = vReturn
End Function 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2015-11-26T19:56:23.847

这是另一种方式。

这不是多维的，但可以单行单列工作。

f 和 t 参数是基于零的。

```
Function slice(ByVal arr, ByVal f, ByVal t)
    slice = Application.Index(arr, Evaluate("Transpose(Row(" & f + 1 & ":" & t + 1 & "))"))
End Function 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2015-12-31T17:52:55.170

这是我编写的一个漂亮的函数，用于子集二维数组

```
Function Subset2D(arr As Variant, Optional rowStart As Long = 1, Optional rowStop As Long = -1, Optional colIndices As Variant) As Variant
    'Subset a 2d array (arr)
    'If rowStop = -1, all rows are returned
    'colIndices can be provided as a variant array like Array(1,3)
    'if colIndices is not provided, all columns are returned

    Dim newarr() As Variant, newRows As Long, newCols As Long, i As Long, k As Long, refCol As Long

    'Set the correct rowStop
    If rowStop = -1 Then rowStop = UBound(arr, 1)

    'Set the colIndices if they were not provided
    If IsMissing(colIndices) Then
        ReDim colIndices(1 To UBound(arr, 2))
        For k = 1 To UBound(arr, 2)
            colIndices(k) = k
        Next k
    End If

    'Get the dimensions of newarr
    newRows = rowStop - rowStart + 1
    newCols = UBound(colIndices) + 1
    ReDim newarr(1 To newRows, 1 To newCols)

    'Loop through each empty element of newarr and set its value
    For k = 1 To UBound(newarr, 2) 'Loop through each column
        refCol = colIndices(k - 1) 'Get the corresponding reference column
        For i = 1 To UBound(newarr, 1) 'Loop through each row
            newarr(i, k) = arr(i + rowStart - 1, refCol) 'Set the value
        Next i
    Next k

    Subset2D = newarr
End Function 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2021-03-17T11:23:57.980

这是一个老问题，但是如果您想将范围的 1 行检索到一维数组中，您可以使用 Index 和 Transpose 来实现。

```
Sub test()
    Dim ar1
    Dim a As Object: Set a = Application

    ar1 = a.Transpose(a.Transpose(a.Index(Range("A1:C3"), 2, 0)))  'get 2d row
    Debug.Print Join(ar1, "|")
End Sub 
```

将其与 OFFSET 结合使用，您可以逐行快速读取整个范围。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-06T17:26:00.227

您可以使用 Rows、Columns、Offset 和 Resize 属性的组合来获取范围的子集。

例如，如果您的范围是 5 列乘 3 行：

```
Set rng = Range("A1:E3") 
```

您可以通过适当组合上述属性来获得任何子集。例如，如果您想获取第二行最右边的 3 个单元格（即上例中的“C2:E2”），您可以执行以下操作：

```
 Set rngSubset = rng.Rows(2).Offset(0, rng.Columns.Count - 3).Resize(1, 3) 
```

然后，您可以将其包装在 VBA 函数中。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2018-04-27T20:07:25.530

`slice`与许多其他最近的语言不同，数组没有直接功能。

但是，有一个简短的代码片段非常方便。下面是一维数组的完整解决方案：

```
'*************************************************************
'*                      Fill(N1,N2)
'* Create 1 dimension array with values from N1 to N2 step 1
'*************************************************************
Function Fill(N1 As Long, N2 As Long) As Variant
 Dim Arr As Variant
 If N2 < N1 Then
   Fill = False
   Exit Function
 End If
 Fill = WorksheetFunction.Transpose(Evaluate("Row(" & N1 & ":" & N2 & ")"))
End Function

'**********************************************************************
'*                        Slice(AArray, [N1,N2])
'* Slice an array between indices N1 to N2
'***********************************************************************
Function Slice(VArray As Variant, Optional N1 As Long = 1, Optional N2 As Long = 0) As Variant
 Dim Indices As Variant
 If N2 = 0 Then N2 = UBound(VArray)
 If N1 = LBound(VArray) And N2 = UBound(VArray) Then
   Slice = VArray
 Else
   Indices = Fill(N1, N2)
   Slice = WorksheetFunction.Index(VArray, 1, Indices)
 End If
End Function 
```

供测试用

```
Var V As Variant
V = Fill(100,109)
PrintArr(Slice(V,3,5))

'************************************************
'*                 PrintArr(VArr)
'* Print the array VARR
'**************************************************
Function PrintArr(VArray As Variant)
 Dim S As String
 S = Join(VArray, ", ")
 MsgBox (S)
End Function 
```

结果

```
102, 103, 104 
```

# hardware - 广告磁盘空间与实际磁盘空间

> ID：175176
> 
> 赞同：8
> 
> 时间：2008-10-06T16:56:25.717
> 
> 标签：hardware, drives

为什么广告的磁盘空间几乎总是高于 UI 报告的磁盘空间？例如，我有一个“80 gb”硬盘，但 iTunes UI 显示只有 74。我通常会在硬盘和驱动器盘符上报告的数量上看到这一点。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2008-10-06T17:04:37.057

您实际可以使用的空间量与为驱动器列出的空间量不同的原因有 3 个，*所有*这些都对您不利：

1.  硬盘制造商将 1GB 视为 10 亿字节，而操作系统将其称为 1,073,741,824 字节（1000 * 1000 * 1000 vs 1024 * 1024 * 1024）。
2.  格式化时会丢失一些文件表空间。
3.  磁盘空间被分成大于 1 字节（通常为 4K）的块。使用典型的 Windows 默认设置，一个 1 字节的文件会占用 4K 的磁盘空间。

其中，前两个会影响驱动器报告的空间量（尽管 IIRC 的第二个是 FAT32 的问题，而不是 NTFS 的问题）。最后一个仅影响剩余的*可用空间*量，但仍会阻止您使用驱动器的全部容量。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-10-06T17:00:16.270

这是操作系统与硬盘制造商计算可用空间的方式。

操作系统：1mb = 1024 kb

供应商：1mb = 1000 kb

供应商将始终使用 *1000 来增加他们的数量。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-06T17:06:24.713

罪魁祸首是使用基数 10 与基数 2 来列出存储大小。它实际上变成了舍入误差。

有一个尝试使用以 2 为底的值而不是以 10 为底的存储大小来反映真实大小的[运动。](http://en.wikipedia.org/wiki/Mebibyte)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-06T17:09:15.520

这是 1000 的倍数的[标准 (SI) 前缀（giga、mega、kilo 等）](http://en.wikipedia.org/wiki/Si_prefixes)与 1024 的倍数的[二进制前缀](http://en.wikipedia.org/wiki/Binary_prefix)之间的差异。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-06T17:00:40.777

市场营销认为 80 GB 为 80,000,000,000 字节。操作系统将 80 GB 视为 85,899,345,920 字节。

[http://www.google.com/search?q=80000000000+bytes+in+GB](http://www.google.com/search?q=80000000000+bytes+in+GB)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-06T16:58:07.570

通常是由于操作系统或某些软件出于备份或系统目的而占用并隐藏了一些分区空间。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-06T16:59:04.137

假设制造商认为MB为1024KB；其他 1000KB。对于 GB 也是如此。有人说1024MB；其他 1000MB。

然后，这是指未格式化的大小。格式化会占用一些空间。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-06T16:59:21.200

此外，很多时候，他们将千兆字节宣传为稍微不准确的数字，从而导致差异。您可以在大多数硬盘盒外部的免责声明文本中看到这一点！

# java - 更新 Set 中的对象

> ID：175186
> 
> 赞同：22
> 
> 时间：2008-10-06T16:58:30.190
> 
> 标签：java, data-structures, set

假设我的应用程序中有这种类型：

```
public class A {
  public int id;
  public B b;

  public boolean equals(Object another) { return this.id == ((A)another).id; }
  public int hashCode() { return 31 * id; //nice prime number }
} 
```

和一个结构。现在，我有一个类型的对象并想要执行以下操作：`Set`<A`>``A`

*   如果 my`A`在集合内，请更新其字段`b`以匹配我的对象。
*   否则，将其添加到集合中。

所以检查它是否在那里很容易（`contains`），添加到集合中也很容易。我的问题是：如何获得更新对象的句柄？接口`Set`没有`get`方法，我能想到的最好的方法是删除集合中的对象并添加我的。另一种更糟糕的替代方法是使用迭代器遍历集合以尝试定位对象。

我很乐意接受更好的建议……这包括有效使用其他数据结构。

尤瓦尔=8-)

**编辑**：谢谢大家的回答......不幸的是，我不能在这里“接受”最好的答案，那些建议使用 a 的人`Map`，因为仅仅为了这个目的而彻底改变集合的类型会有点极端（这个集合是已经通过 Hibernate 映射...）

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2008-10-06T17:03:25.920

由于 Set 只能包含对象的一个​​实例（由其`equals`和`hashCode`方法定义），因此只需将其删除然后添加即可。如果已经有一个，那么另一个将从 Set 中删除并替换为您想要的那个。

我有做类似事情的代码 - 我正在缓存对象，以便特定对象出现在 GUI 上的一堆不同位置的任何地方，它总是同一个。在这种情况下，我使用 Map 而不是使用 Set，然后我得到一个更新，我从 Map 中检索它并就地更新它，而不是创建一个新实例。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-10-06T17:03:42.673

你真的想使用 a `Map<Integer,A>`，而不是 a `Set<A>`。

然后将 ID（即使它也存储在`A`！）映射到对象。所以存储新的是这样的：

```
A a = ...;
Map<Integer,A> map = new HashMap<Integer,A>();
map.put( a.id, a ); 
```

您的完整更新算法是：

```
public static void update( Map<Integer,A> map, A obj ) {
  A existing = map.get( obj.id );
  if ( existing == null )
     map.put( obj.id, obj );
  else
     existing.b = obj.b;
} 
```

**然而，它可能更简单。** 我假设你有比你提供的更多的领域`A`。 *如果不是这种情况*，实际上只使用 a`Map<Integer,B>`就是您想要的，那么它就会崩溃：

```
Map<Integer,B> map = new HashMap<Integer,B>();
// The insert-or-update is just this:
map.put( id, b ); 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-10-06T18:54:37.380

如果您使用的是 Set，我认为您不会比使用 remove/add 更容易。

```
set.remove(a);
set.add(a); 
```

如果找到匹配的 A ，它将被删除，然后您添加新的，您甚至不需要`if (set.contains(A))`条件。

如果您有一个带有 ID 和更新字段的对象，**并且**您并不真正关心该对象的任何其他方面，只需将其丢弃并替换它。

如果您需要对与该 ID 匹配的 A 执行任何其他操作，则必须遍历 Set 以找到它或使用不同的 Container（如 Jason 建议的 Map）。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-10-07T03:33:59.750

还没有人提到这一点，但基于`hashCode`或`equals`基于可变属性是您不应该做的那些非常非常大的事情之一。离开构造函数后，不要乱搞对象标识——这样做会大大增加你在路上遇到真正难以解决的错误的机会。即使您没有遇到错误，会计工作以确保您*始终*正确更新任何和所有依赖`equals`并`hashCode`保持一致的数据结构将远远超过能够仅更改对象 id 的任何感知好处当你跑步时。

相反，我强烈建议您通过构造函数传入 id，如果需要更改它，请创建 A 的新实例。这将强制您的对象的用户（包括您自己）正确地与集合类（以及许多其他）依赖于`equals`和中的不可变行为`hashCode`。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-06T18:19:46.733

Map `<A,A`> 我知道它是多余的，但我相信它会让你得到你想要的行为。真的，我很想看到 Set 上有一个 get(Object o) 方法。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-06T17:33:21.040

这有点超出范围，但您忘记重新实现 hashCode()。当您覆盖 equals 时，请覆盖 hashCode()，即使在示例中也是如此。

例如; 当您有 Set 的 HashSet 实现时， contains() 很可能会出错，因为 HashSet 使用 Object 的 hashCode 来定位存储桶（与业务逻辑无关的数字），并且仅等于（）其中的元素桶。

```
public class A {
  public int id;
  public B b;
  public int hashCode() {return id;} // simple and efficient enough for small Sets 
  public boolean equals(Object another) { 
    if (object == null || ! (object instanceOf A) ) {
      return false;
    }
    return this.id == ((A)another).id; 
   }
}
public class Logic {
  /**
   * Replace the element in data with the same id as element, or add element
   * to data when the id of element is not yet used by any A in data. 
   */
  public void update(Set<A> data, A element) {
    data.remove(element); // Safe even if the element is not in the Set
    data.add(element); 
  }
} 
```

**编辑**Yuval 正确表明 Set.add 不会覆盖现有元素，但仅在该元素尚未在集合中时才添加（“is”由 equals 实现）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-06T18:42:29.480

您可能希望生成一个名为 ASet 的装饰器并使用内部 Map 作为支持数据结构

```
class ASet {
 private Map<Integer, A> map;
 public ASet() {
  map = new HashMap<Integer, A>();
 }

 public A updateOrAdd(Integer id, int delta) {
   A a = map.get(a);
   if(a == null) {
    a = new A(id);
    map.put(id,a);
   }
   a.setX(a.getX() + delta);
 }
} 
```

您还可以查看 Trove API。虽然这对于性能和说明您正在使用原始变量更好，但它很好地公开了此功能（例如 map.adjustOrPutValue(key, initialValue, deltaValue)。

# jquery - 在 Chrome/WebKit/Safari 中禁用锚点

> ID：175205
> 
> 赞同：7
> 
> 时间：2008-10-06T17:01:47.047
> 
> 标签：jquery, html, safari, google-chrome, webkit

考虑以下代码：

```
$("a").attr("disabled", "disabled"); 
```

在 IE 和 FF 中，这将使锚点无法点击，但在基于 WebKit 的浏览器（Google Chrome 和 Safari）中，这无济于事。disabled 属性的好处是它很容易被删除并且不会影响 href 和 onclick 属性。

您对如何获得所需结果有任何建议。答案必须是：

*   很容易恢复，因为我想在运行 AJAX 调用时禁用表单输入控件。
*   必须在 IE、FF 和 WebKit 中工作

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-06T17:05:29.583

我假设您有一个绑定到这些锚元素的 onclick 事件处理程序。只需让您的事件处理程序检查“已禁用”属性并在已设置的情况下取消该事件。您的事件处理程序看起来像这样：

```
$("a").click(function(event){
  if (this.disabled) {
    event.preventDefault();
  } else {
    // make your AJAX call or whatever else you want
  }
}); 
```

您还可以设置样式表规则来更改光标。

```
a[disabled=disabled] { cursor: wait; } 
```

编辑 - 按照评论中的建议简化了“禁用”检查。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-28T06:11:41.603

我必须在一个站点中修复此行为，该站点有很多锚点，这些锚点根据其他条件等使用此属性启用/禁用。也许不理想，但在这种情况下，如果您不想修复每个锚点的代码单独来说，这将对所有锚点起作用：

```
$('a').each(function () {
    $(this).click(function (e) {
        if ($(this).attr('disabled')) {
            e.preventDefault();
            e.stopImmediatePropagation();
        }
    });
    var events = $._data ? $._data(this, 'events') : $(this).data('events');
    events.click.splice(0, 0, events.click.pop());
}); 
```

和：

```
a[disabled] {
    color: gray;
    text-decoration: none;
} 
```

# iis - 针对实时生产 IIS 日志运行 LogParser 是否安全？

> ID：175210
> 
> 赞同：1
> 
> 时间：2008-10-06T17:03:21.850
> 
> 标签：iis, production, logparser, iis-logs

针对我们的实时生产 IIS 日志文件运行 LogParser 是否安全？

目前，我一直将它复制到另一个位置，然后针对日志文件运行 LogParser 2.2。

相反，我真的很想针对实时数据运行它，以便我可以立即看到它的更改，但是，我有点担心它可能会导致问题。

有谁知道查询实时 IIS 日志是否会导致问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-06T17:39:17.470

它不应该引起任何问题，因为我不相信它会锁定文件。为什么复制文件只是为了确保会是一个问题？即使您只是将其复制到本地文件夹，批处理文件也可以轻松复制文件并通过 logparser 运行它。

但是对于实时文件应该没问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-10T09:37:12.270

这绝对是安全的，因为正如 Tom 所说，Log Parser 不会锁定输入文件。在实时日志文件上运行是一个关键的目标场景。

# asp.net - ASP.Net 编译

> ID：175217
> 
> 赞同：2
> 
> 时间：2008-10-06T17:04:33.687
> 
> 标签：asp.net, .net, caching, compiler-construction

我有一个关于 asp.net 编译的问题。我知道您可以编译的不同方式，但我的问题是使用默认方法。

微软表示，页面和代码在首次使用时被编译，然后被缓存。我的问题是，该缓存何时清除...

应用程序池何时回收？或者，它是否会缓存它，直到它被更改，即使服务器重新启动也是如此。基本上，如果它编译一次然后缓存它直到它被改变，我可以接受它......如果它在每次重新启动或应用程序池回收时重新编译，我将走预编译的路线。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-06T17:07:06.770

缓存在应用程序池关闭时被清除，在每次应用程序池启动时都会重新编译和缓存。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-06T17:12:22.767

每当您对源文件进行更改时，它都会重新编译。

启动时（关机后）它也会重新编译。

将某些内容更改为 web.config 会重新启动您的网络

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-06T17:30:46.240

所以文件是在临时文件夹中创建的，但不会在关机时被清除。只有在发生变化时才会重新编译它们。因此，如果您重新启动 IIS 或重新启动机器，它们将不会重新编译。只需从临时文件夹重新加载它们。

对项目的任何文件或项目所依赖的任何文件的更改都将导致重新编译。

# c++ - 哪个更合适：getter 和 setter 还是函数？

> ID：175228
> 
> 赞同：7
> 
> 时间：2008-10-06T17:06:44.573
> 
> 标签：c++, coding-style, setter, getter

如果替代函数名称使 API 更明显，那么放弃 getter 和 setter 的“getMyValue()”和“setMyValue()”模式是否合适？

例如，假设我在 C++ 中有这个类：

```
 public class SomeClass {
private:
    bool mIsVisible;

public:
    void draw();
    void erase();
} 
```

我可以像这样添加函数来获取/设置“mIsVisible”：

```
 bool getVisible() { return mIsVisible; };

void setVisible(bool visible) { 
    if (!mIsVisible && visible) {
        draw();
    } else if (mIsVisible && !visible) {
        erase();
    }

```
mIsVisible = visible; 
```

} 
```

但是，同样可以使用以下方法：

```
 bool isVisible() { return mIsVisible; };

void show() { 
    if (!mIsVisible) {
        mIsVisible = true;
        draw();
    }
}

void hide() {
    if (mIsVisible) {
        mIsVisible = false;
        erase();
    }
} 
```

简而言之，最好有一个“setVisible(bool)”方法还是一对“show()”和“hide()”方法？有没有约定，还是纯粹是主观的东西？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-10-06T17:12:45.247

阅读Pragmatic Programmers 网站上的文章“ [Tell, Don't Ask ”，我想您会看到第二个示例是可行的方法。](http://www.pragprog.com/articles/tell-dont-ask)

基本上，您不应该通过您的第一个示例所暗示的代码将逻辑传播出去，即：

1.  获取当前可见性值，
2.  根据价值做出决定，
3.  更新对象。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-06T17:08:54.193

在你给出的例子中`show()`，`hide()`至少对我来说很有意义。

另一方面，如果你有一个属性`skinPigment`并且你决定调用函数`tanMe()`，`makeAlbino()`那将是一个非常糟糕、不明显的选择。

这是主观的，您必须尝试以您的用户（使用此类的人）的方式思考。无论您决定采用哪种方式，对他们来说都应该是显而易见的，并且**有据可查。**

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-06T17:39:25.817

我会选择 isVisible()/show()/hide() 集。

setVisible() 意味着它所做的一切都会改变内部变量。show() 和 hide() 使副作用变得清晰。

另一方面，如果 getVisible()/setVisible() 所做的*只是*更改内部变量，那么将它们作为公共字段所做的改变非常小。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-06T17:48:55.843

setter 实际上与面向对象关系不大，这是示例中应用的编程习惯。吸气剂稍微好一点，但在很多情况下可以不用吸气剂。如果一切都可以得到和设置，那么拥有一个对象有什么意义呢？应该在对象上调用操作来完成事情，改变内部状态只是这样做的副作用。在存在多态性（OO 的基石之一）的情况下，setter 的坏处是您强制每个派生类都有一个 setter。如果所讨论的对象不需要名为 mIsVisible 的内部状态怎么办？当然，他可以忽略该调用并将其实现为空，但随后您将进行无意义的操作。OTOH，显示和隐藏等操作可以很容易地被不同的实现覆盖，

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-06T17:20:13.827

一般来说，我认为 setter/getter 应该只设置属性的值。在您的示例中，您还根据 isVisible 属性的值执行操作。在这种情况下，我认为使用函数来执行操作和更新状态比使用 setter/getter 作为更新属性的副作用来执行操作要好。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-06T17:23:24.100

如果切换 mIsVisible 确实会立即打开和关闭对象的可见性，则使用显示/隐藏场景。如果它将在旧状态中停留更长时间（例如，直到其他事情触发重绘），那么设置/获取场景将是可行的方法。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-06T17:20:51.110

我更喜欢 show() 和 hide() 方法，因为它们明确地告诉你要做什么。setVisible(boolean) 不会告诉您该方法是否会立即显示/绘制。加上 show() 和 hide() 是更好命名的接口方法（恕我直言）。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-06T17:11:27.823

隐含地，您列出的“显示”和“隐藏”功能都是二传手

对于布尔值，我认为像您展示的单个工具会很好。但是，.show 和 .hide 函数也看起来像命令，而不是改变对象状态的函数。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-06T18:05:34.330

在这种情况下，您实际上必须编写类似的代码

```
if (shouldBeShowingAccordingToBusinessLogic()) w.show();
else w.hide(); 
```

到处都是，你可能会更好

```
w.showIfAndOnlyIf(shouldBeShowingAccordingToBusinessLogic()) 
```

或者，对于真正奇怪的情况，当您的逻辑无法决定是否要使用单桅帆船直到某些代码延伸结束时，您可以尝试

```
w.setPostponedVisibility(shouldBeShowingAccordingToBusinessLogic());
...
w.realizeVisibility(); 
```

（我不是说很奇怪吗？）

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-06T18:06:31.910

选择显示/隐藏解决方案的另一个动机是，作为二传手，

该`setVisible`方法有一个“副作用”，因为它还显示或隐藏`SomeClass`. 显示/隐藏方法更好地传达了所发生事情的意图。

# c# - 有没有更好的方法来验证请求是否接受 JSON？

> ID：175236
> 
> 赞同：4
> 
> 时间：2008-10-06T17:10:11.210
> 
> 标签：c#, asp.net, json, request, content-type

实际上，我正在使用这种方式。你有更好的方法吗？

```
private bool AcceptJson(HttpRequest request)
{
    const string JsonType = "application/json";

    if (request.ContentType.ToLower(CultureInfo.InvariantCulture).StartsWith(JsonType))
    {
        return true;
    }

    if (request.AcceptTypes.Select(t => t.ToLower(CultureInfo.InvariantCulture) == JsonType).Count() > 0)
    {
        return true;
    }

    return false;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-06T17:34:05.703

这种方法可能会导致误报（它不考虑 q 值或 application/json 是子字符串的内容类型）。

[您可以在这篇关于 XHTML](http://www.dev-archive.net/articles/xhtml.html#content-negotiation)的文章中找到一个不错的 Accept 标头解析器。您必须将算法移植到您选择的语言并使其适应您正在使用的内容类型。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-07T13:43:41.377

很难知道你所说的“更好”是什么意思。严格来说，您不需要担心内容类型，因此可以将其删除。我想技术上更好的方法是删除 Select 调用并将条件放入 Count 方法中。

# version-control - 您对 Clearcase Multiserver 的体验如何？

> ID：175237
> 
> 赞同：4
> 
> 时间：2008-10-06T17:10:56.233
> 
> 标签：version-control, clearcase

我们正在考虑使用 ClearCase Multisite 来支持离岸开发团队。另一个选项是使用本地（陆上）ClearCase 安装的 ClearCase Remote Client。有没有人有使用 Multisite 的经验？是否值得在海外使用胖客户端进行同步和管理麻烦？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-06T20:17:16.543

I agree with stimms. Actually, unless you have a massive **concurrent** development on the *same* set of files, multisite is quite heavy to setup and maintain...

And if the coverage is disjoint, ... actually we have switched to CRC (but we are with CC7.0.1 here, CRC in 6.0 was not advanced enough). That means you have a good connection to allow your user to connect to the web server that represents CRC and that will access your vobs for them.
Your remote clients will either use a "semi-fat" client (the eclipse RCP ClearCase client talking to your CRC) or a web interface, for setting up their snapshot views.

The other point that drove us away from Multisite is the licensing system: you can not convert a vob into a 'multisite-compliant' one without using (more expensive) multisite licenses, even for your *local* users...
So if you want to use only multi-site licenses for your remote users, you have to isolate your data into a multi-site vob, and then replicate those data into a normal vob!

All in all, I believe Multisite is not the only answer to offshore development team.
BUT, that being said, one strong force of the Multisite mechanism is its ability to synchronize itself from delta coming from various sources:

*   regular reception of packages
*   files
*   even a CD burned with the latest delta can do it!

That means, if your connexion is not always up with the remote site, Multisite can be a valid option.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-24T13:06:03.383

Multisite 和 CCRC 之间真正重要的区别之一是，您只能将快照视图（但实际上称为 Web 视图）与 CCRC 一起使用，而 Multisite 可以同时使用快照和动态视图。

正如之前的海报所述，还需要考虑货币和管理成本。

如果没有关于离岸团队规模、他们可能发展的内容、您将使用该解决方案的时间、业务规模、管理经验和 ClearCase 员工的时间的更多信息……嗯，准确地回答这个问题会很棘手。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-06T17:42:24.047

这是个好问题。我相信只要您能弄清楚元素的掌握程度，就值得使用多站点。如果一个元素在站点 A 上被掌握，您不能在站点 B 上编辑它，直到您转移了掌握权。因此，如果每个站点都在处理相同的代码段，那么多站点将比它的价值更麻烦，如果覆盖范围不相交，那么多站点是一个很好的选择。Clearcase 在网络上非常健谈，尽可能保持本地化是个好主意。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-06T19:37:09.867

MultiSite 是一款出色的产品，它真正以 CCRC 无法实现的方式启用远程站点。它还用作 VOB 的备份*副本*。有很多事情需要考虑，但不要让 MultiSite 的复杂性让您望而却步……我建议您研究 CM/InSync 以将 MultiSite 自动化为免提设置。

CCRC 客户端还可以，与原生动态视图相比仍然乏善可陈。这在很大程度上取决于您的要求和需要。

d。

# python - 如何使用 Python 将文件格式从 Unicode 转换为 ASCII？

> ID：175240
> 
> 赞同：24
> 
> 时间：2008-10-06T17:11:30.427
> 
> 标签：python, unicode, encoding, file, ascii

我使用 3rd 方工具以 Unicode 格式输出文件。但是，我更喜欢它是 ASCII。该工具没有更改文件格式的设置。

使用 Python 转换整个文件格式的最佳方法是什么？

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2008-10-06T17:21:15.790

只需使用该函数，您就可以轻松地转换文件`unicode`，但是如果没有直接的 ASCII 等效字符，您会遇到 Unicode 字符的问题。

[这个博客](http://www.peterbe.com/plog/unicode-to-ascii)推荐了这个`[unicodedata](http://www.python.org/doc/2.5.2/lib/module-unicodedata.html)` 模块，它似乎可以在没有直接对应的 ASCII 值的情况下粗略地转换字符，例如

```
>>> title = u"Klüft skräms inför på fédéral électoral große" 
```

通常转换为

```
Klft skrms infr p fdral lectoral groe 
```

这是非常错误的。但是，使用该`unicodedata`模块，结果可以更接近原始文本：

```
>>> import unicodedata
>>> unicodedata.normalize('NFKD', title).encode('ascii','ignore')
'Kluft skrams infor pa federal electoral groe' 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-10-06T17:17:01.010

*我认为这是一个比你意识到的更深层次的问题*。简单地将文件从 Unicode 更改为 ASCII 很容易，但是，将所有 Unicode 字符转换为合理的 ASCII 对应物（许多字母在两种编码中都不可用）是另一回事。

这个 Python Unicode 教程可以让您更好地了解转换为 ASCII 的 Unicode 字符串会发生什么：[http ://www.reportlab.com/i18n/python_unicode_tutorial.html](http://www.reportlab.com/i18n/python_unicode_tutorial.html)

**这是该网站的有用报价：**

> Python 1.6 还获得了一个“unicode”内置函数，您可以对其指定编码：

```
> >>> unicode('hello') u'hello'
> >>> unicode('hello', 'ascii') u'hello'
> >>> unicode('hello', 'iso-8859-1') u'hello'
> >>> 
```

> 所有这三个都返回相同的东西，因为 'Hello' 中的字符对于所有三种编码都是通用的。
> 
> 现在让我们用 ASCII 之外的欧洲口音编码一些东西。您在控制台上看到的内容可能取决于您的操作系统区域设置；Windows 让我输入 ISO-Latin-1。

```
> >>> a = unicode('André','latin-1')
> >>> a u'Andr\202' 
```

> 如果不能输入锐角字母 e，可以输入字符串 'Andr\202'，这是明确的。
> 
> Unicode 支持所有常见的操作，例如迭代和拆分。我们不会在这里碾压他们。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2011-12-17T09:29:58.033

顺便说一句，这些是`iconv`执行此类工作的 linux 命令。

```
iconv -f utf8 -t ascii <input.txt >output.txt 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-06T17:18:04.627

像这样：

```
uc = open(filename).read().decode('utf8')
ascii = uc.decode('ascii') 
```

但是请注意，如果有任何字符无法转换为 ASCII ，这将**失败**并出现异常。`UnicodeDecodeError`

编辑：正如皮特卡尔刚刚指出的那样，从 Unicode 到 ASCII 没有一对一的映射。因此，某些字符根本无法以保留信息的方式进行转换。此外，标准 ASCII 或多或少是 UTF-8 的子集，因此您甚至不需要进行任何解码。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-06T17:24:48.933

这是一些简单（愚蠢）的代码来进行编码转换。我假设（但您不应该）输入文件采用 UTF-16 格式（Windows 将其简称为“Unicode”）。

```
input_codec = 'UTF-16'
output_codec = 'ASCII'

unicode_file = open('filename')
unicode_data = unicode_file.read().decode(input_codec)
ascii_file = open('new filename', 'w')
ascii_file.write(unicode_data.write(unicode_data.encode(output_codec))) 
```

请注意，如果 Unicode 文件中有任何不是 ASCII 字符的字符，这将不起作用。您可以执行以下操作将无法识别的字符转换为“？”：

```
ascii_file.write(unicode_data.write(unicode_data.encode(output_codec, 'replace'))) 
```

查看[文档](http://docs.python.org/library/stdtypes.html#str.encode)以获得更简单的选择。如果您需要做任何更复杂的事情，您可能希望查看Python Cookbook 中的[The UNICODE Hammer](http://code.activestate.com/recipes/251871/)。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2011-06-10T21:08:02.803

对于我只想跳过非 ascii 字符而只输出 ascii 输出的问题，以下解决方案非常有效：

```
 import unicodedata
    input = open(filename).read().decode('UTF-16')
    output = unicodedata.normalize('NFKD', input).encode('ASCII', 'ignore') 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-06T20:24:46.233

请务必注意，没有“Unicode”文件格式。Unicode 可以通过几种不同的方式编码为字节。最常见的是 UTF-8 或 UTF-16。您需要知道您的第 3 方工具输出的是哪一个。一旦你知道了，不同编码之间的转换就很容易了：

```
in_file = open("myfile.txt", "rb")
out_file = open("mynewfile.txt", "wb")

in_byte_string = in_file.read()
unicode_string = bytestring.decode('UTF-16')
out_byte_string = unicode_string.encode('ASCII')

out_file.write(out_byte_string)
out_file.close() 
```

如其他回复中所述，您可能希望为 encode 方法提供一个错误处理程序。使用 'replace' 作为错误处理程序很简单，但如果它包含无法用 ASCII 表示的字符，则会破坏您的文本。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-12-15T09:12:38.657

正如其他海报所指出的，ASCII 是 unicode 的子集。

但是，如果您：

*   有一个旧版应用程序
*   您无法控制该应用程序的代码
*   您确定您的输入属于 ASCII 子集

然后下面的例子展示了如何做到这一点：

```
mystring = u'bar'
type(mystring)
    <type 'unicode'>

myasciistring = (mystring.encode('ASCII'))
type(myasciistring)
    <type 'str'> 
```

# c++ - 你的 C++ 备忘单上有什么？

> ID：175244
> 
> 赞同：36
> 
> 时间：2008-10-06T17:12:50.347
> 
> 标签：c++

每隔一段时间，我就不得不在我编写的大部分代码之间切换语言（无论是工作还是娱乐）。我发现 C++ 是需要大量心理缓存空间的语言之一，所以如果我从它那里休息很长时间，那么我会忘记很多细节。甚至像将项目添加到 STL 容器或`static`在各种上下文中使用 storage 关键字之类的事情都会变得混乱（“是它`add`， ... `append`，`push`哦，它是`push_back`”）。

那么，当您编写 C++ 时，您喜欢将哪些重要的花絮加载到您的大脑中呢？

编辑：我应该说，我希望能够将此页面添加为书签并将其用作我的备忘单:)

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-10-06T18:25:35.897

当我从 Java 切换回 C++ 时，我喜欢回顾Herb Sutter 和 Andrei Alexandrescu的[C++ Coding Standards中的项目。](http://www.gotw.ca/publications/c++cs.htm)

Scott Meyers 的[Effective C++](http://www.aristeia.com/books.html)系列也非常适合这一点。

以下是对我有用的快速基本内容：

*   利用[`std::swap()`](http://en.cppreference.com/w/cpp/algorithm/swap)
*   “当有疑问时，按照整数做的。” （斯科特迈耶斯）
*   `const *`表示常量数据，`* const`表示常量指针（向后读取声明！）。
*   在具有动态分配数据的类中声明赋值运算符和复制构造函数。
*   如果您自己不声明，C++ 将为您编写一个赋值运算符和复制构造函数。除非您声明它们（最有可能是私有的）并省略定义它们。
*   让 operator=() 返回对`*this`
*   在 Derived 的复制构造函数的 init 列表中调用 Base(rhs)。
*   调用`Base::operator=(rhs);`派生的`operator=()`
*   检查分配给自己`operator=()`
*   不要`operator=()`通过调用复制构造函数来实现（Herb Sutter、[Write what you Know 和 Know what you Write](http://www.gotw.ca/publications/advice97.htm)）
*   记住[RAII](http://en.wikipedia.org/wiki/Resource_acquisition_is_initialization)
*   通过引用捕获异常

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-10-07T03:12:47.423

在我的备忘单上： const 和指针之间的交互：

```
int       *       p;  // pointer
int const *       p;  // pointer to const value
int       * const p;  // const pointer
int const * const p;  // const pointer to const value 
```

本质上，拆分`*`符号上的声明，如果 const 落在左边，则指向的值是 const，如果它落在右边，指针本身就是 const。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-10-06T17:14:17.740

我保持打开 C++ 标准的 PDF。它有利于快速查找所有库接口（尤其是容器接口和 iostream 的东西）。它对于快速解决同事关于 C++ 语法和语义的争论也很有用。

我还没有弄清楚如何将 PDF 加载到我的大脑中。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-10-06T17:23:19.127

由于我一直在使用 C++ 工作，因此我将大部分语法都记在脑海中。对于图书馆参考，我使用[sgi](http://www.sgi.com/tech/stl)和[Josuttis 的](https://rads.stackoverflow.com/amzn/click/com/0201379260)书。当我有一段时间没有使用 C++ 并且真的想要复习一下时，我会回到[Effective C++](https://rads.stackoverflow.com/amzn/click/com/0321334876)。

当我需要回答更深层次的问题时，我会参考标准或[Stroustrup 的](https://rads.stackoverflow.com/amzn/click/com/0201700735)书。

当一切都失败时，google 和 stackoverflow 是很棒的工具。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-10-06T17:25:17.700

## 实现对非静态 C++ 成员函数的回调

每次我必须这样做时，我都需要查看这个。实际上，任何处理函数指针细节的事情总是倾向于调整我的大脑。我发现[函数指针教程](http://www.newty.de/fpt/index.html)是一个很好的参考。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2008-10-06T17:33:04.957

在我的 C 备忘单（以及 C++ 备忘单）上，指向函数语法的指针。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-10-07T03:28:41.027

一般来说，我将整个网站放在方便的备忘单上：

[http://www.cheat-sheets.org/#CPP](http://www.cheat-sheets.org/#CPP)

cpp 备忘单有点基础，但 STL 很有用。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2008-10-06T17:41:59.773

不是真的在备忘单上，也不是真正特定于 C++，但我有“刷新缓冲区！” 在便签上提醒我当我没有收到数据时可能出了什么问题。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-10-06T17:26:33.470

我使用网站[cplusplus.com](http://www.cplusplus.com/)。它是 C 和 C++ 编程的一个很好的参考。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-10-06T17:16:22.447

模板专业化。我总是需要查一下。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-10-06T17:45:34.573

我的立方体墙上贴了一份操作员优先级图表的小副本。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-10-07T10:20:00.307

Scott Meyer 的 TR1 摘要页面，[http://www.aristeia.com/EC3E/TR1_info.html](http://www.aristeia.com/EC3E/TR1_info.html)

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2012-11-03T01:52:29.193

就运营商而言，[cpp.operator-precedence.com](http://cpp.operator-precedence.com)

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-10-06T17:15:52.823

实际上，让我在 C# 和 C++ 之间切换最多的是构造函数语法。（我一直想对所有事情都使用“新”）。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-10-06T18:39:40.313

[STL 和其他标准 <include> 的Dinkumware Compleat 参考](http://www.dinkumware.com/manuals/)。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-12-10T16:50:37.647

对于那些想要快速参考和回顾的人，这里是 C++ 备忘单

[C++ 备忘单 - 第 1 部分](http://www.skill-guru.com/blog/2009/11/22/c-cheat-sheet-1/)
[C++ 备忘单 - 第 2 部分](http://www.skill-guru.com/blog/2009/11/22/c-cheat-sheet-part-2/)

* * *

## 回答 #17

> 赞同：-1
> 
> 时间：2012-10-20T20:51:12.520

访问谷歌和打字的能力对我来说已经足够了。

诚然，我被我的工作环境中几乎保证的网络访问所宠坏了。无论出于何种原因未能做到这一点，我也拥有所有三个标准 PDF。

这样做的缺点是在 C++ 面试中的事实问答部分中猜测/知识的比率很高。好处是我非常擅长我的工作。:P

# developer-tools - 微软认证合作伙伴？对开发人员重要吗？

> ID：175247
> 
> 赞同：8
> 
> 时间：2008-10-06T17:14:33.043
> 
> 标签：developer-tools

我的公司最近成为了 Microsoft 认证合作伙伴，从业务角度来看，它为我们提供了极大的帮助，因为它提供了以更具成本效益的方式继续开发所需的软件许可证，以及营销能力的额外好处。

现在，我知道 Microsoft 认证合作伙伴身份对许多客户来说都很重要，但从开发人员的角度来看，作为 .NET 开发人员，您在选择可能工作的组织时是否会寻找它？如果您至少知道组织可以使用工作所需的工具，这是否被视为一种好处？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-06T17:23:01.373

是的。作为合作伙伴，您不仅可以访问该软件，而且公司还可以获得认证测试凭证，这使得您的雇主更有可能不仅支持，而且鼓励您获得认证。我为 MS 金牌合作伙伴工作，这里的每个开发人员都通过了 MCPD 认证。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-06T17:16:55.660

如果您进入 Empower for ISV 计划，软件工具包就是天赐之物。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-06T17:21:06.960

接受工作时，这对我来说并不是一个交易破坏者，但福利肯定很好，如果我在一家使用 Microsoft 堆栈的公司工作，我会尝试将他们推向 MCP。

我当前的 MSDN 订阅大大提高了我的工作效率。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-06T17:25:05.860

我通常不太关心合作伙伴的状态，只要他们有高级 MSDN 订阅。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-06T18:54:07.163

我很快就开始在一家软件公司工作，该公司是微软认证的金牌合作伙伴，就你的简历上的表现而言，你曾在一家获得认证的公司工作对你有帮助吗？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-06T19:12:15.130

如果您正在为 Microsoft 平台进行开发，这将**非常有用。**但是，**我不认为这是我**从事工作所需要的。

如果我从事的工作不是合伙人，如果我觉得这对公司/团队来说足够重要，我可能会考虑带头努力。只要您为他们的平台提供真正的产品，就可以获得合作伙伴关系真的不需要太多努力。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-06-29T11:26:58.743

成为 Microsoft 认证合作伙伴对公司有很大好处。一家公司成为微软认证合作伙伴并不难，只要整个公司都愿意为之努力，而不是总是在追逐下一个截止日期。

所以如果一家公司不是微软认证合作伙伴，我可能会问为什么？

However so far it has never been a factor in deciding on taking a job, as other factor (like location) are more important to me.

# asp.net - 在父级中禁用时，如何为子级自定义控件启用 ViewState？

> ID：175252
> 
> 赞同：6
> 
> 时间：2008-10-06T17:15:51.573
> 
> 标签：asp.net, viewstate, custom-server-controls

我正在尝试创建一个自定义控件，它类似于“gridview”控件，但专门用于实现某些自定义接口的业务对象。

在这样做时，我遇到了以下问题。

我有一个控件，我禁用了视图状态（并且我不想重新启用它），它有一个我希望启用视图状态的子控件。我似乎无法让子控件上的视图状态工作，因为它的父母被禁用。有没有人知道如何让它发挥作用？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-06T17:28:03.203

您不能在另一个控件中禁用视图状态的控件上启用视图状态。

您唯一的选择是为外部控件启用它，然后为其中的所有控件关闭它，除了您需要视图状态的控件。

任何容器上的 EnableViewState 属性都将覆盖该容器内所有控件的行为。

祝你好运！

**编辑：** 您可能希望查看您的**CreateChildContols()方法并使用****EnableViewState**属性从那里为自定义控件中的每个控件枚举禁用视图状态的控件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-10T17:20:35.673

如果您愿意手动将数据放入 ViewState（而不是让 ASP.NET 为您保留控件的状态），您可以将项目直接放入页面的 ViewState，而不是控件的 ViewState。

即而不是说：

```
this.ViewState["someKey"] = someValue; 
```

说：

```
this.Page.ViewState["someKey"] = someValue; 
```

不过要小心——如果页面上有多个控件实例，则必须确保它们使用不同的键！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-02-11T19:10:55.193

显然这对于[​​ Asp.Net 4.0是可能的](http://weblogs.asp.net/despos/archive/2009/06/13/asp-net-4-0-more-control-on-viewstate-management.aspx)

# .net - 使用程序集版本控制属性的最佳方法是什么？

> ID：175256
> 
> 赞同：13
> 
> 时间：2008-10-06T17:16:35.143
> 
> 标签：.net, assemblies, versioning

[AssemblyVersion](http://msdn.microsoft.com/en-us/library/system.reflection.assemblyversionattribute.aspx)和[AssemblyFileVersion](http://msdn.microsoft.com/en-us/library/system.reflection.assemblyfileversionattribute.aspx)属性是处理 .NET 程序集版本号的内置方法。虽然该框架提供了自动确定版本号（构建和修订，用 Microsoft 术语）的最不重要部分的能力，但我发现这种方法非常薄弱，毫无疑问还有很多其他方法。

所以我想问一下，为了更好地反映项目的实际版本，确定了哪些方法可以最好地完成版本号？您是否有预构建脚本将部分版本设置为日期和时间，或项目工作副本的存储库版本？你只是使用框架提供的自动生成吗？或者是其他东西？管理程序集/文件版本控制的最佳方法是什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-15T23:49:58.700

I see many posts here about using the subversion revision number as a component of the assembly version. **Beware: the 4 version numbers available in windows (a.b.c.d) are each limited to 16 bit (max = 65535).** The subversion revision number can easily exceed this limit, especially if you host multiple projects in the same repository.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-06T17:43:07.743

在我当前的项目中，我们使用 Subversion 修订号作为版本号的最不重要（构建）部分，并且我们使用 Nant 脚本来创建项目 AssemblyInfo 文件。我们对 AssemblyVersion 和 AssemblyFileVersion 属性使用相同的版本号。（其他三个部分是major.minor.point，其中major.minor 将在每次数据库架构更改时递增，并且point 在每次发布时递增。）

我们一开始只是简单地增加内部版本号，但这需要为每个版本签入版本文件，并在合并时引起冲突。当这被证明不可行时，我们开始使用 CruiseControl.NET 来生成内部版本号，但这使得手动重现特定版本变得困难。最终我们采用了当前的（Subversion-revision）方案。

注意：不幸的是，对于 .NET，不可能完美地从过去的版本重新创建构建，因为 .NET 编译器在编译时会将当前时间戳编码到目标文件中。每次编译相同的代码时，都会得到不同的目标文件。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-06T17:23:17.317

在之前的工作中，我们使用了 Subversion，我运行了一个关于 ccnet 的 nant 脚本来提取存储库版本并将其用作最终编号。

在这项工作中，我们使用 VSS（快门），所以这不是一个真正的选择，所以我们制定了手动更新它的策略，并遵循以下准则：

*   主要：功能或界面的重大（> 25％）更改或添加。
*   次要：功能或界面上的小改动或添加。
*   构建：破坏界面的小改动。
*   修订：对不更改界面的构建进行了修复。

我们还保持程序集和文件版本同步。程序集版本可以通过编程轻松读取，而文件版本可以在 Windows 资源管理器的详细信息模式中显示为一列。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-06T17:17:52.303

我们的构建脚本将 TFS 中的变更集编号注入到版本中。这样我们就可以确切地知道构建中的签入。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-15T23:02:45.707

我们有我们的 CruiseControl.NET 构建服务器将 perforce 更改列表编号嵌入到其中`AssemblyFileVersion`- 这让我们可以追溯构建服务器构建的任何程序集的源代码。（我们总是从主分支构建。）

对于客户将要引用的程序集，`AssemblyVersion`除非有重大更改，否则我们会保留常量，在这种情况下，我们会增加版本以确保针对新版本重新构建客户代码。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-06T17:20:10.613

我们使用来自 subversion 的版本控制并让 buildscripts 更新程序集版本信息，因此源代码签入控制版本控制。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-06T17:41:52.927

我们倾向于将发布（或构建）日期嵌入到程序集中。例如，如果今天构建，版本将是“2008.10.06”（构建脚本会更新它）。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-06T17:22:41.093

AssemblyVersionAttribute 是程序集标识的一部分。改变这意味着它是一个不同的程序集，链接到该程序集的程序需要重新编译/链接，或者需要应用版本策略。我们没有发现这种吸引力，所以我们选择只为每个修补程序增加 AssemblyFileVersion，并且只为每个主要版本更改 AssemblyVersion。我们知道这个决定带回了一些 win32 dll 地狱。我们为每个构建增加 AssemblyFileVersion 并使用该版本标记/标记版本控制系统，以便我们知道二进制文件的来源。

# svn - 将 SVN 存储库从本地同步到服务器？

> ID：175264
> 
> 赞同：4
> 
> 时间：2008-10-06T17:20:01.767
> 
> 标签：svn

因此，我有这个本地 SVN 存储库，用于我在特定项目上的开发工作，并且我还在客户媒体寺庙帐户上设置了 SVN 存储库，以便进行更安全的备份。

我在笔记本电脑上进行所有开发，所以我并不总是有互联网连接（因此是本地 SVN），所以我想知道是否有一种简单的方法可以将我提交到本地 repo 的更改推送到服务器 repo ?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-06T17:24:11.807

您可能想要`svn merge`在存储库之间进行版本。

关于如何做到这一点，有一些很好的教程。查看[http://blog.red-bean.com/sussman/?p=92](http://blog.red-bean.com/sussman/?p=92)或[http://subversion.tigris.org/faq.html#multi-merge](http://subversion.tigris.org/faq.html#multi-merge)以获得关于该主题的良好介绍

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-06T17:24:32.727

我知道这是一个延伸，但您尝试做的不一定适合 Subversion，因为它是一个集中的修订控制系统（只有一个存储库的主副本）。

[Git](http://git.or.cz/)是一个分布式版本控制系统，允许您进行离线提交、差异和合并。你应该检查一下。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-06T17:22:03.730

你应该只做一个 SVN 合并。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-06T17:29:17.350

您可以考虑使用[Bazaar](http://en.wikipedia.org/wiki/Bazaar_software)作为本地存储库，然后提交回中央 SVN 服务器。Bazaar 有一些不错的插件可以将分布式源代码控制集成到现有的客户端-服务器源代码控制系统中。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-06T17:59:17.163

如果您使用 SVN 服务器，但想要一个本地存储库并在两者之间轻松同步，您应该使用[SVK](http://svk.bestpractical.com/view/HomePage)。它创建一个可以分支的本地镜像；对镜像的提交被合并回主干。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-06T18:52:01.270

所以我想出的解决方案是使用 svnadmin 转储/加载功能。我主要将它与我正在部署到媒体寺庙帐户的 Ruby on Rails 项目一起使用。这个想法是，当准备好部署站点的新版本时，检入本地存储库的代码将转储到一个文件中，然后该文件将通过 ssh 复制到服务器。一旦在服务器上，我将使用 ssh 执行一个将加载到服务器 SVN 的 shell 脚本。然后，我将检查该服务器代码，将其复制到 rails app 目录，运行迁移，然后重新启动服务器。

想法是，通过使用这种方法，我可以确保当前生产的代码反映服务器 SVN 存储库中的最新版本。

感谢 Fernando 提供转储/加载功能的链接。

For the record i did evaluate the Git solution before i posted this question, and due to the fact that i am using NetBeans as my IDE for this project (NetBeans has a really great Ruby/RoR plugin) the Git plugin for NB appears to be kinda buggy and didn't work quite right, whereas the SVN plugin is rock solid.

# jsf - JSF 统一导航系统（菜单、面包屑、站点地图）

> ID：175293
> 
> 赞同：1
> 
> 时间：2008-10-06T17:26:32.427
> 
> 标签：jsf, richfaces, myfaces

我们正在使用 MyFaces、Richfaces 和 Restfaces 在 Oracle Stellant CMS 之上构建网站。我们没有使用 Site Studio。是否有任何小部件/小部件组合可以提供统一的导航系统？站点结构需要从 DB 表和 CMS 元数据字段中读取，我们需要顶部选项卡菜单、可展开的侧边栏菜单、面包屑和站点地图（如果它使用 sitemaps.org 标准，则可以加分）。我们目前正在使用不能很好地互操作的自主手动和现成小部件的组合——不同的导航功能在导航网站时不会保持同步。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2011-02-25T09:59:23.917

去年我们遇到了一个非常相似的问题，但没有找到任何可以提供集成解决方案的小部件集（我们使用的是 JSF、Facelets、RichFaces 和 Spring）。

我们最终开发了我们自己的带有菜单状态持有者的导航系统（每个会话存储），并且面包屑只会从当前选择进入菜单树以构建自己。

菜单模型本身是在应用程序启动时（从 xml 文件中读取）使用 Spring 构建的，并使用 facelets (

`<rich:tabPanel id="topMenu" binding="#{menuBean.menu}" />`

保持组件同步主要由 Spring WebFlow FlowExecutionListener 管理

希望这可以帮助..

# svn - 为什么 TortoiseSVN (1.5.3) 从树干拉出时会尝试合并 1-Head？

> ID：175296
> 
> 赞同：0
> 
> 时间：2008-10-06T17:27:02.223
> 
> 标签：svn, tortoisesvn, merge-tracking

我使用 TortoiseSVN 1.5.3 和 VisualSVN 1.5.3 (Subversion 1.5.2)

假设我创建了主干（/trunk）的一个新分支（/branches/branch1），然后有人（也使用 TortoiseSVN 1.5.3）将他们的分支合并回主干。

我尝试从主干合并到分支（以获取可能已被其他人合并到主干的所有更改）

我没有指定任何特定的修订，因为我希望合并跟踪来确定我需要合并哪些修订。我希望这些是在我创建分支之后的修订。

当我开始合并时，输出对话框似乎将每个修订版合并回修订版 1。这会导致存储库中的所有内容都被“添加”。

我做错了什么？....

我试过了...

```
SVNAdmin Upgrade <MyRepoPath> 
```

这导致了一条即时成功消息，之后我重复了我的实验，结果没有变化

更新：我注意到 TortoiseSVN 对话框显示“要合并所有修订，请将框留空。”...这是否意味着 TortoiseSVN 正在显式添加 1-Head 并且无法使用合并跟踪？这似乎有点奇怪。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-07T11:19:19.843

已解决：答案似乎归结为我们在此处针对 Subversion 中的一些先前错误实施的解决方法。

解决方法涉及使用 SomeUserName@ 放置在 url 中。因此

```
http://SomeUsername@Myserver:8080/myrepo/trunk 
```

...被用来代替...

```
http://Myserver:8080/myrepo/trunk 
```

似乎在没有此添加的情况下检索了分支的工作副本，并且正在使用此添加对 url 进行合并。这导致 Subversion 推断它们是 2 个不同的 url，并且自然地（ish）推断它们没有共同的历史来定位要合并的起点。

**因此，解决方案是确保用于合并的“来自”url 的格式与工作副本使用的 url 的格式相匹配。**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-06T18:17:50.840

我认为您需要使用 Branch 作为您的来自 URL。原因是您的 Trunk 版本现在高于您的 Branch，因此您需要从最低版本开始。

# database - 有没有存储过程的替代品？

> ID：175298
> 
> 赞同：10
> 
> 时间：2008-10-06T17:27:50.490
> 
> 标签：database, stored-procedures

是否有任何替代存储过程，安全和快速以及存储过程。我只知道休眠。有没有其他类似的技术？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-10-07T09:50:41.487

存储过程是放置在数据库上执行的代码（SQL）的地方，所以我理解这个问题的意思

**“还有其他方法可以打包在数据库上运行的代码吗？”**

有几个答案：

*   没有其他东西与存储过程*完全相同*，但您可能会考虑其他替代方案。
*   您可以在客户端代码（java 或其他）中将所有 SQL 编写为字符串
    *   然而，这有各种问题（封装丢失、紧密耦合 -> 更难维护），这不是一个好主意。
*   您可以使用诸如 NHibernate 之类的 ORM，它在您的客户端逻辑和数据库之间插入一个层。ORM 生成 SQL 以在数据库上执行。使用 ORM，表达复杂的业务逻辑比在存储过程中更难（全面概括！）。
*   一种折衷方案是在 Java（或您正在使用的任何软件）中定义您自己的数据访问层（DAL），并将其与客户端代码的主体（单独的类/命名空间/等）分开，以便您的客户端调用 DAL，DAL 解释这些并将 SQL 发送到数据库，将数据库中的结果返回给客户端。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-06T17:36:35.883

是的。你可以使用动态sql，但我个人更喜欢存储过程。

1）如果您使用的是 MS SQL Server，它将生成一个查询计划，该计划应该使存储过程比简单的动态 sql 执行得更快。

2）修复存储过程中的错误可能更容易更有效，特别是如果您的应用程序在多个位置调用该过程。

3) 我发现将数据库逻辑封装在数据库中而不是嵌入 sql 或应用程序配置文件中是很好的。

4) 在数据库中创建存储过程将允许 sql server 在设计时执行一些语法和验证检查。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-06T17:33:35.063

Hibernate 是一个对象/关系持久化服务。

存储过程是关系数据库系统中的子程序。

不是一回事。

如果你想替代 Hibernate，你可以检查[iBatis for Spring](http://www.devx.com/Java/Article/31481)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-06T17:32:19.467

您可以像存储过程一样安全和快速地执行动态 SQL，它只需要一些工作。当然，使存储过程安全和快速也需要一些工作。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-09-18T15:36:46.973

> **存储过程**是访问关系数据库系统的应用程序可用的子例程。存储过程（有时称为 proc、sproc、StoPro 或 SP）实际上存储在数据库数据字典中。
> 
> 存储过程的典型用途包括数据验证（集成到数据库中）或访问控制机制。此外，存储过程用于整合和集中最初在应用程序中实现的逻辑。可能需要执行多个 SQL 语句的大型或复杂处理被移动到存储过程中，并且所有应用程序只调用这些过程。
> 
> 存储过程类似于用户定义的函数 (UDF)。主要区别在于 UDF 可以像 SQL 语句中的任何其他表达式一样使用，而存储过程必须使用 CALL 语句调用

..来自[维基百科](http://en.wikipedia.org/wiki/Stored_procedure)

我认为您需要阅读这篇文章并重新提出您的问题。Hibernate 与存储过程无关。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-09-21T00:29:57.503

如果您说为什么要寻找替代品，那会有所帮助，您不喜欢存储过程呢？

一些数据库（例如 PostgreSQL）还允许您用不同的语言编写存储过程。因此，如果您真的想要，您可以用 Python 或 Java 等来编写它们，而不是 SQL。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-07-05T10:25:08.540

我认为 OP 意味着直接在他的应用程序代码中编写所有数据库代码的替代方法是调用存储过程或使用诸如 Hibernate 之类的 ORM 在他的应用程序代码和数据库之间引入一层分离，但是是的，它们非常不同的东西。

使用存储过程可以让您将 SQL 与应用程序代码分开存放在一个地方。使用 Hibernate 可以让您完全避免编写 SQL 并提供关系数据库的对象表示。

你走哪条路很大程度上取决于应用程序和你自己的偏好。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-08-14T17:01:46.500

嗯，在我看来，存储过程的明显替代方案是编写应用程序代码。例如，不必编写存储过程来在每次过帐贷方时过帐借方，您可以编写同时写入两者的应用程序代码。

也许我在这里过于简单化或错过了问题的重点。

# asp.net - 如何加强混合 ASP.NET 1.1 / Ajax 解决方案的安全性？

> ID：175309
> 
> 赞同：0
> 
> 时间：2008-10-06T17:31:14.880
> 
> 标签：asp.net, web-services, security, soap

**设想**

我有一个 HTML/javascript 网站，它使用 javascriptSOAPClient 与 ASP.NET 1.1 Web 服务进行通信，以便读取/写入 SQL 数据库。（[http://www.codeproject.com/KB/ajax/JavaScriptSOAPClient.aspx](http://www.codeproject.com/KB/ajax/JavaScriptSOAPClient.aspx)）。该数据库包含匿名的人口统计信息——没有姓名、没有信用卡、没有地址。本质上，收集的数据是用于数据挖掘目的。

该站点是实时的，但我们希望在 javascript/ajax 客户端和 wbe 服务之间为这个和未来的项目引入更安全的通信。作为金融行业的承包商，在某些时候我们会遇到一个问题：这个网站可以被黑客入侵吗？如果我们没有解决方案，我们可能会出声。

我已经在遵循最佳实践，例如通过命令参数和存储过程与数据库进行通信）。然而，目前任何人都可以浏览我们的 Web 服务描述并弄清楚如何使用我们公开的服务。

**问题**

1.  使用我的混合解决方案（即不是端到端 Microsoft），我应该如何验证 Web 服务上的客户端请求？
2.  如果我开始将用户名/密码或其他一些可识别的元素作为身份验证传递给 Web 服务，我是否应该关心该密钥是如何在客户端生成/存储的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-07T11:18:42.997

需要考虑的一些建议：

*   **列出威胁**，并将每个威胁与您当前的设置进行比较。
*   使用**SSL/HTTPS**。这减轻了整个类别的漏洞。
*   使用**用户名/密码**，在服务器端生成并带外（通过邮件或电话）发送给用户。（希望这能回答问题 2）。
*   使用**两因素身份验证**。为此，您可以查看**安全令牌**，例如[RSA 的密钥卡类型小玩意儿](http://www.rsa.com/)或查看 Steve Gibson 的**[Perfect Paper Passwords](https://www.grc.com/ppp.htm)**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-25T03:19:10.650

有几个简单的选项：

1.  SSL + Cookie
2.  如果 Web 应用程序也是 ASP.NET 并与您的 Web 服务一起托管，那么您应该可以访问您的 Web 服务内的 Web 应用程序的用户/成员/会话（基本上是#1，但您无需做任何工作即可获得它）。
3.  如果 Web 应用程序和 Web 服务不在同一个域中，那么由于跨域问题，cookies 不可用 - 因此您可以让 Web 应用程序将 GUID 嵌入到隐藏的表单字段中，并将该 GUID 用作一种 cookie （并且它需要作为所有 Web 服务请求的参数传递）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-19T22:51:59.550

从编程的角度来看，最简单的解决方案是使用双向 HTTPS。即服务器向客户端出示证书，客户端向服务器出示证书。然后只有具有适当证书（由您颁发）的客户端才能连接。

这有助于让客户放心，您的网站通常无法访问，但安全性对应用程序是透明的，一旦他们注册并收到证书，对他们来说也是如此。缺点是您在发布和跟踪用户证书时有管理开销——但这可能比您处理用户名/密码组合时要少。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-06T17:33:15.080

您可以合并证书身份验证机制吗？这样只有拥有您可以验证的密钥的客户端才能进行通信？这就是我使用的产品如何让其托管设备与核心进行通信。

# audio - 带限波形生成

> ID：175312
> 
> 赞同：11
> 
> 时间：2008-10-06T17:31:43.163
> 
> 标签：audio, signal-processing, synthesizer

我正在编写一个软件合成器，需要以 44.1 kHz 采样率实时生成带限、无混叠波形。锯齿波形现在就可以了，因为我可以通过将两个锯齿混合在一起来产生脉冲波，一个倒相和相移。

到目前为止，我已经尝试了以下方法：

1.  在启动时以不同的带限频率预计算一个周期的完美带限波形样本，然后播放混合在一起的两个最接近的波形样本。我猜工作正常，但感觉不是很优雅。需要大量样本，否则会听到它们之间的“间隙”。插值和混合也是相当 CPU 密集型的。

2.  整合一系列直流补偿正弦脉冲以获得锯齿波。听起来不错，除了如果您没有完全正确地获得直流补偿（我发现这真的很棘手），波会从零漂移。可以通过向积分器添加一点泄漏来减少 DC 问题，但随后会丢失低频。

所以，我的问题是：通常的做法是什么？任何建议的解决方案在 CPU 方面都必须是高效的，因为它必须实时完成，同时针对许多声音。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2010-04-28T19:10:14.233

生成带限波形的一种快速方法是使用带限步长 (BLEP)。您自己生成带限步骤：

![在此处输入图像描述](https://i.stack.imgur.com/bmh3z.gif)

并将其存储在波表中，然后用带限步骤替换每个转换，以创建如下所示的波形：

![在此处输入图像描述](https://i.stack.imgur.com/2XW3u.gif)

请参阅[Band-Limited Sound Synthesis 的演练](http://blargg.8bitalley.com/bl-synth/)。

由于这个 BLEP 是非因果的（意味着它延伸到未来），为了生成实时波形，最好使用最小相位带限制步骤，称为[MinBLEP](http://www.experimentalscene.com/articles/minbleps.php)，它具有相同的频谱，但仅扩展过去：

> MinBLEP 更进一步，采用加窗 sinc，执行最小相位重建，然后整合结果并将其存储在表中。现在要制作一个振荡器，您只需在波形的每个不连续处插入一个 MinBLEP。因此，对于方波，您在波形反转的地方插入一个 MinBLEP，对于锯齿波，您在值反转的地方插入一个 MinBLEP，但您正常生成斜坡。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-06T17:49:42.677

有很多方法可以处理带限波形生成。您最终将像往常一样以计算成本与质量进行交易。

我建议你在这里看看这个网站：

[http://www.musicdsp.org/](http://www.musicdsp.org/)

查看存档！它充满了好材料。我刚刚搜索了关键字“bandlimited”。如果您至少忙碌一周，弹出的材料。

顺便说一句 - 不知道这是否是你要找的，但几年前我确实减少了别名（例如不是真正的频带限制）波形生成。我刚刚计算了最后一个和当前采样位置之间的积分。对于传统的合成波形，如果您在奇点处拆分积分间隔（例如，当锯齿复位时），您可以很容易地做到这一点。CPU 负载很低，质量可以满足我的需要。

我有同样的漂移问题，但是在积分上应用一个截止频率非常低的高通可以消除这种影响。真正的模拟合成器无论如何都不会进入亚赫兹区域，因此您不会错过太多。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-06T19:29:26.360

这就是我在 Nils 想法的启发下想到的。将其粘贴在这里以防对其他人有用。我只是使用最后一个样本的相位变化作为内核大小（或截止值）对锯齿波进行分析框过滤。它工作得相当好，在最高音符处有一些听得见的混叠，但对于正常使用来说，它听起来很棒。

为了进一步减少混叠，可以稍微增加内核大小，例如使其 2*phaseChange 听起来也不错，尽管您会丢失一些最高频率。

此外，这是我在浏览 SP 以查找类似主题时发现的另一个很好的 DSP 资源：[The Synthesis ToolKit in C++ (STK)](http://ccrma.stanford.edu/software/stk/ "C++ 中的综合工具包 (STK)")。它是一个类库，有很多有用的 DSP 工具。它甚至可以使用带限波形发生器。他们使用的方法是像我在第一篇文章中描述的那样集成 sinc（尽管我猜他们做得比我好......）。

```
float getSaw(float phaseChange)
{
    static float phase = 0.0f;
    phase = fmod(phase + phaseChange, 1.0f);
    return getBoxFilteredSaw(phase, phaseChange);
}

float getPulse(float phaseChange, float pulseWidth)
{
    static float phase = 0.0f;
    phase = fmod(phase + phaseChange, 1.0f);
    return getBoxFilteredSaw(phase, phaseChange) - getBoxFilteredSaw(fmod(phase + pulseWidth, 1.0f), phaseChange);
}

float getBoxFilteredSaw(float phase, float kernelSize)
{
    float a, b;

    // Check if kernel is longer that one cycle
    if (kernelSize >= 1.0f) {
        return 0.0f;
    }

    // Remap phase and kernelSize from [0.0, 1.0] to [-1.0, 1.0]
    kernelSize *= 2.0f;
    phase = phase * 2.0f - 1.0f;

    if (phase + kernelSize > 1.0f)
    {
        // Kernel wraps around edge of [-1.0, 1.0]
        a = phase;
        b = phase + kernelSize - 2.0f;
    }
    else
    {
        // Kernel fits nicely in [-1.0, 1.0]
        a = phase;
        b = phase + kernelSize;
    }

    // Integrate and divide with kernelSize
    return (b * b - a * a) / (2.0f * kernelSize);
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-10-08T22:22:00.263

来自 blit 的 DC 偏移 - 可以通过简单的高通滤波器来减少！- 很像一个真正的模拟电路，他们使用直流阻断帽！

# reporting-services - 报告服务国际化

> ID：175322
> 
> 赞同：6
> 
> 时间：2008-10-06T17:34:22.583
> 
> 标签：reporting-services, internationalization

> **可能重复：**
> [SSRS 中的国际化](https://stackoverflow.com/questions/16660/internationalization-in-ssrs)

我们将 SQL Server Reporting Services 用于我们的 Web 报告。目前，我们的客户都在英国，因此对于每个报告，我们将报告的 Language 属性设置为“English (United Kingdom)”。

但现在我们有美国和法国的客户。因此，我们需要更改法语的语言和货币，以及美国人的日期格式和货币。我们希望为所有客户保留一组报告。

做这个的最好方式是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-06T17:57:41.927

请查看此线程。在这里可能会对你有所帮助。

[**SSRS 的国际化**](https://stackoverflow.com/questions/16660/internationalization-in-ssrs)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-06T17:54:49.653

如果尚未设置报告的语言，则报告将使用有关日期、货币等格式的 Web 浏览器语言呈现。请参阅[MSDN 文档](http://msdn.microsoft.com/en-us/library/aa178910(SQL.80).aspx)：

> 如果未设置报表的语言，则使用 Web 浏览器的语言。如果未设置 Web 浏览器的语言，则使用报表服务器操作系统的语言。例如，如果您在显示日期信息的文本框上设置特定语言，则该文本框始终以该语言的日期格式显示，即使报表、Web 浏览器或服务器设置为不同的语言。

# unit-testing - 您是否应该在运行时显示单元测试中发生的情况？

> ID：175323
> 
> 赞同：4
> 
> 时间：2008-10-06T17:34:47.433
> 
> 标签：unit-testing

在编写单元测试代码时，我倾向于发现我插入了以下几行：

```
Console.WriteLine("Starting InteropApplication, with runInBackground set to true...");
try
{
    InteropApplication application = new InteropApplication(true);
    application.Start();
    Console.WriteLine("Application started correctly");
}
catch(Exception e)
{
    Assert.Fail(string.Format("InteropApplication failed to start: {0}", e.ToString()));
}

//test code continues ... 
```

我所有的测试几乎都是一样的。他们正在显示有关失败原因的信息，或者正在显示有关他们正在做什么的信息。我没有任何关于单元测试应该如何编码的*正式方法。*他们是否应该展示他们正在做什么的信息？或者测试应该是静默的，根本不显示任何关于它们正在做什么的信息，而只显示失败消息？

注意：语言是 C#，但我不关心语言特定的答案。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-06T17:41:30.710

我不确定你为什么要这样做——如果你的单元测试命名得当，你就已经知道它在做什么了。如果它失败了，你就知道什么测试失败了（以及什么断言失败了）。如果它没有失败，你就知道它成功了。

这似乎完全是主观的，但对我来说，这似乎是完全多余的信息，只会增加噪音。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-06T17:37:18.393

我个人建议您只输出错误以及运行的测试数量和通过的数量的摘要。这是一个完全主观的观点。显示适合您需求的内容。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-06T17:40:51.960

我建议不要这样做——我认为单元测试应该遵循 Unix 工具的理念——当事情进展顺利时不要说什么。我发现构建测试以在失败时提供有意义的信息是最好的——这样当事情正常时你会得到很好的简短输出，并且在出现问题时很容易看出哪里出了问题——错误不会因为滚动失明而丢失。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-06T17:42:55.357

我实际上会建议反对它（尽管不是好战的）。它将测试的用户界面与测试实现结合起来（如果测试是通过 GUI 查看器运行的呢？）。作为替代方案，我建议以下其中一项：

1.  我不熟悉 NUnit，但是 PyUnit 允许您添加测试描述，并且当使用详细选项运行测试时，会打印描述。我会查看 NUnit 文档，看看您是否可以这样做。

2.  扩展您从中继承的 TestCase 类，以添加一个您调用的函数，该函数记录测试尝试执行的操作。这样，不同的实现可以以不同的方式处理消息。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-06T17:47:57.280

我会说你应该输出任何适合你需要的东西，但是显示太多会稀释测试运​​行器的输出。
顺便说一句，您的示例代码几乎不像一个[单元测试](http://en.wikipedia.org/wiki/Unit_test)，更像是一个集成/系统测试。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-06T21:14:43.353

Have you looked at the xUnit style of unit test frameworks?
See [Ron Jeffries](http://www.xprogramming.com/software.htm) site for a rather large list.

One of the principles of these frameworks is that they produce little or no output during the test run and only really an indicator of success at the end. In the case of failures its possible to get a more descriptive output of the reason for failure.
The reason for this mode is that while everything is OK you don't want to be bothered by extra output, and certainly if there is a failure you don't want to miss it because of the noise of other output.

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-06T17:58:52.237

您不需要这样做，如果测试以静默方式运行，则意味着没有错误。除了测试失败之外，测试通常没有理由给出任何输出。如果它正在运行，那么它正在运行，由测试运行器指示测试已通过，即它是“绿色”。通过 IDE 中的测试运行程序运行测试（以及许多带有控制台输出的测试），您将向控制台日志发送垃圾邮件，其中包含没人会关心的消息。

您编写的测试不是单元测试，但看起来更像是集成/系统测试，因为您似乎在运行整个应用程序。单元测试将测试类中的公共方法，最好使类尽可能隔离。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-06T18:14:35.323

使用控制台 i/o 有点违背单元测试框架的全部目的。您不妨手动编写整个测试。如果您使用的是单元测试框架，那么您的测试应该具有很强的延展性，并且与尽可能少的事物相关联

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-06T18:19:24.597

显示信息可能很有用；如果您试图找出测试失败的原因，那么能够看到的不仅仅是堆栈跟踪以及程序到达失败点之前发生的事情会很有用。

然而，在一切都成功的“正常”情况下，这些消息是不必要的混乱，会分散你真正想要做的事情 - 即。查看哪些测试成功和失败的概述。

我建议将您的调试消息重定向到日志文件。您可以通过编写所有日志消息代码来调用特殊的“日志打印”函数来执行此操作，或者如果您正在编写控制台程序，您应该能够将标准输出重定向到不同的文件（我知道一个事实是您可以在 Unix 和 Windows 中执行此操作）。通过这种方式，您可以获得高级别的概述，但如果您需要详细信息，它们就会在那里。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-10-06T18:25:28.000

我会避免在单元测试中添加额外的 Try/Catch 语句。首先，单元测试中的预期异常已经导致测试失败。这是 NUnit 的默认行为。本质上，测试工具已经用该代码包装了对测试函数的每个调用。此外，仅使用 e.ToString() 来显示发生了什么，我相信您会丢失很多信息。默认情况下，我相信 NUnit 不仅会显示 Exception 类型，还会显示调用堆栈，我不相信您会在您的方法中看到这些。

其次，有必要的时候。例如，您可以使用 [ExpectedException] 属性来实际说明它何时发生。只需确保在测试与非异常相关的断言（例如断言列表计数 > 0 等）时，您将良好的描述作为断言的参数。这很有用。

通常不需要其他所有内容。如果您的单元测试如此之大，以至于您开始在 WriteLines 中添加您正在进行的测试的“步骤”，这通常表明您的测试应该真正分解为多个较小的测试。换句话说，您不是在进行单元测试，而是在进行集成测试。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-10-06T17:41:38.200

我喜欢缓冲详细日志（大约最后 20 行左右），但在出现错误之前我不会显示它。当错误发生时，最好有一些上下文。

OTOH，单元测试应该是具有特定输入和输出要求的小段无关代码。在大多数情况下，显示导致错误的输入（即错误输出）就足以追踪问题的根源。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-10-06T17:43:39.583

这可能有点过于特定于语言，但是当我编写 NUnit 测试时，我倾向于这样做，只有我使用 System.Diagnostics.Trace 库而不是控制台，这样只有在我决定观看时才会显示信息追踪。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-10-06T18:03:22.523

你可以这样写测试方法。这取决于您喜欢哪种测试风格的代码。我不喜欢编写额外的 try-catch 和 Console.WriteLines。

```
public void TestApplicationStart()
{
  InteropApplication application = new InteropApplication(true);
  application.Start();
} 
```

我使用过的测试框架会将任何未处理的（和意外的）异常解释为失败的测试。

想想你为这个测试镀金所花费的时间，以及你可以用这段时间编写多少有意义的测试。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-10-06T17:39:43.867

好吧，您应该只知道测试何时失败以及失败的原因。知道发生了什么是没有用的，除非，例如，你有一个循环，并且你想知道测试在循环中的确切位置死亡。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-10-06T17:44:19.830

我认为你为自己做的工作要多得多。测试要么通过，要么失败，失败应该是规则的异常，你应该让单元测试运行器处理并抛出异常。你正在做的是添加 cruft，测试运行器记录的异常会告诉你同样的事情。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-10-06T17:48:32.787

我唯一一次展示正在发生的事情是它的某些方面是否更容易非自动测试。例如，如果您的代码需要一些时间才能运行，并且可能会陷入无限循环，您可能希望每隔一段时间打印一条消息以表明它仍在进行中。

但是，请始终确保失败消息从其他输出中清楚地显示出来。

# agile - 您是否将花费在错误修复上的时间计入 Scrum 中？

> ID：175344
> 
> 赞同：19
> 
> 时间：2008-10-06T17:40:47.733
> 
> 标签：agile, scrum

嗨，我是 Scrum 方法的新手，正在寻找一些帮助以适应环境，并想知道是否需要一个存储桶来跟踪开发人员和 QA 花费在部署、错误修复和重新测试上的时间。似乎它可能对图表产生重大影响。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2008-10-06T20:48:10.180

我的团队正在支持许多遗留应用程序，因此在每个 sprint 期间都会发生相当多的计划外错误修复。我们采用了以下做法：

*   如果错误很容易/快速修复（一个班轮等），那么只需修复它。
*   如果错误不是微不足道的，也不是阻碍，则将其添加到积压工作中。
*   如果 bug 是一个阻碍，那么添加一个任务（到当前的 sprint）来捕获修复它所需的工作，并开始处理它。这需要将其他内容（从当前的 sprint）移到积压工作以考虑新的小时数，因为您的可用总小时数没有改变。

当我们添加新的错误任务时，我们会将它们标记为与计划任务不同的标记，以便在 sprint 审查期间轻松查看它们。有时计划外的工作最终占我们 sprint 的 50% 以上，但是因为我们将计划中的项目推到 backlog 中，所以我们很早就知道我们没有交付我们计划的这个 sprint 什么。

事实证明，这对于我们的团队在处理遗留应用程序时非常有用，因为我们没有人像我们希望的那样熟悉或对系统充满信心。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-10-06T18:00:18.397

在冲刺期间发现的属于该冲刺的错误应该自动修复，就好像任务/故事一开始就没有完成一样。从之前的 sprint 中出现的 bug 可以像正常的 backlog 一样进入 bug-backlog 并确定优先级。

编辑：刚刚意识到通过提及“错误积压”，我打开了“多个积压”，这是一个坏主意。更好的方法可能是用错误标志标记积压中的条目，或者只是接受它作为积压中的任何其他故事。

sprint 中出现的严重错误的数量应该最少，因为在 sprint 结束时所有内容都已经过测试，然后才被接受并交付给项目所有者。

实际上它不应该影响图表，因为您将承诺修复一定数量的错误（通过 PO 的选择 - 一些错误的优先级低于新功能）并且当错误从 sprint 本身出现时，任务真的没有完成，所以可以意识到这一点并花时间修复它。

编辑：意识到其他事情 - 有时在 Scrum 团队中工作并不总能保护您免受必须维护其他应用程序、支持等的现实。虽然这真的很糟糕，并且使整个想法成为一个只有一个积压的团队并且专注并没有真正起作用，现实情况通常是您需要每周保留固定的小时数来支持/维护。不要鼓励这样做，但如果这是现实，请尝试每周分配一个人（轮换，这样他就不会变得悲伤）固定的小时数专门用于所述支持角色。这样，您就知道会发生什么，因为速度是相对的——它似乎对冲刺的影响较小。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-06T17:45:08.490

我倾向于处理这个问题的方法是将错误修复移到 sprint 之外。因此，在演示/发布之前，可能会在三周的冲刺之后进行一周的错误修复。

这不是一个理想的解决方案，因为没有尝试估计将在错误修复阶段修复的错误数量。所以我期待其他人提供比我更好的解决方案。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-07T15:31:55.760

我认为在诊断问题之前很难估计修复错误的工作量，而诊断通常是花费时间的最大部分。

如果您的错误数量相当一致，我只会让它“洗掉”以对抗速度。对于影响团队迭代目标的生产缺陷，我通常会这样做。

如果您意识到由于错误问题导致您在迭代中落后（例如，您看到一个燃尽图看起来不会在迭代结束时与您的范围线相交），那么您可以调整范围（放弃最低优先级的故事）以适应额外的工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-06T18:52:14.093

在每个 sprint 中，我有两个“任务”——一个用于在当前 sprint 中发现的错误（即在未发布的代码上），另一个用于在其他任何东西中发现的问题（任何已发布的版本）。这有助于我跟踪修复错误的时间（每个开发人员）。

后一类记录的任何时间都被视为浪费，是减少的关键目标。审查前者记录的时间，以了解它如何与导致它的功能和更改更紧密地联系起来。

不要针对错误进行估算，而是尝试将时间添加到针对您正在处理的功能进行单元/功能测试的估算中。

随意调整任何模型以适应您的团队的工作方式 - 在任何 Scrum 团队中都应该有一种持续改进的文化，并且开发人员应该能够在学习 Scrum 时提出建议并尝试改进。

# sql - 用于组合 XML 文件的 Web 服务器？

> ID：175346
> 
> 赞同：1
> 
> 时间：2008-10-06T17:40:52.617
> 
> 标签：sql, xml, vb.net, webserver

我有一个用 VB.NET 2005 编写的程序，它将统计信息保存在 XML 文件中。

我在多台计算机上使用这个程序。我想建立一个网络服务器，我可以在其中上传我的 XML 文件，或者只是数据，并将其添加到服务器，而忽略服务器上已有的重复条目。

我需要为此学习什么？SQL？

任何想法都会被应用！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-06T17:51:15.607

很久以前我做过类似的事情，将来自世界各地的 HFNetChk XML 报告发送回中央服务器。

我在服务器上设置了一个服务端点（webservice、TCP，任何适合您的请求），并让客户端应用程序在完成处理后将完成的 XML 发送回中央服务器。网络服务器会发回“数据接收正常”消息，让客户端知道它可以继续前进，然后服务器将继续处理数据，并将其从 XML 输入到 SQL 数据库中。

**因此，要回答您的问题，请**学习如何创建 WCF 服务（目前针对 Web 服务 - 如果 WCF 现在看起来太多，ASMX 还可以），并学习如何解析传入的 XML 并将其插入到有意义的 SQL 表中.

/fark 很有用

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-06T17:55:22.180

我将支持 WCF/asmx 服务的建议。至于如何存储数据，这实际上取决于您想用它做什么，您可以将它们保留为 XML，或者如果您想要报告它们，只需将它们加载到 SQL Server。

# c# - 如何在 .NET 中使用 C# 编辑 div 的 CSS 样式

> ID：175381
> 
> 赞同：46
> 
> 时间：2008-10-06T17:46:41.903
> 
> 标签：c#, .net, css

我正在尝试在 (C#) 后面的代码中获取 div 的 ID 并在其上设置一些 css。我可以从 DOM 中获取它还是必须使用某种控件？

```
<div id="formSpinner">
    <img src="images/spinner.gif" />
    <p>Saving...</p>
</div> 
```

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2008-10-06T18:07:23.700

将`runat="server"`属性添加到它，以便您拥有：

```
<div id="formSpinner" runat="server">
    <img src="images/spinner.gif">
    <p>Saving...</p>
</div> 
```

这样，您可以使用以下方法访问类属性：

```
formSpinner.Attributes["class"] = "classOfYourChoice"; 
```

还值得一提的是，该`asp:Panel`控件实际上是同义词（至少就渲染标记而言）`div`，因此您也可以这样做：

```
<asp:Panel id="formSpinner" runat="server">
    <img src="images/spinner.gif">
    <p>Saving...</p>
</asp:Panel> 
```

然后，您可以编写：

```
formSpinner.CssClass = "classOfYourChoice"; 
```

这使您可以更明确地访问该财产，并且还有其他可能对您有用或可能不有用的东西。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-10-06T17:51:28.990

确保您的 div 设置为 runat="server"，然后只需在代码隐藏中引用它并设置“class”属性。

```
<div runat="server" id="formSpinner">
   ...content...
</div> 
```

代码隐藏

```
formSpinner.Attributes["class"] = "class-name"; 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-10-06T18:29:14.123

这个问题让我很紧张。这表明您可能不了解使用服务器端代码将如何影响您页面的 DOM 状态。

每当您运行服务器端代码时，整个页面都会从头开始重建。这有几个含义：

*   表单从客户端提交到 Web 服务器。这是 Web 浏览器可以采取的最慢的操作，尤其是在 ASP.Net 中，表单可能会填充额外的字段（即：ViewState）。过于频繁地为琐碎的活动执行此操作会使您的应用程序显得迟钝，即使其他一切都很好且活泼。
*   就带宽（上行和下行）和 CPU/内存而言，它会增加服务器的负载。重建页面所涉及的一切都必须再次发生。如果页面上有动态控件，不要忘记创建它们。
*   **自上次请求以来您对 DOM 所做的任何事情都将丢失，除非您记得为此请求再次执行此操作。** 您页面的 DOM 已*重置*。

如果您能侥幸成功，您可能希望将其推送到 javascript 并避免回发。也许使用 XmlHttpRequest() 调用来触发您需要的任何服务器端操作。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-06T17:50:34.983

将 runat="server" 属性添加到标签，然后您可以从代码隐藏中引用它。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-06T17:51:32.407

将 runat 添加到标记中的元素

```
<div id="formSpinner" runat="server">
    <img src="images/spinner.gif">
    <p>Saving...</p>
</div 
```

然后您可以使用 formSpinner.Attributes("class") 获取控件的类属性。它只是一个字符串，但您应该能够对其进行编辑。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2011-02-14T22:54:15.210

如果没有 runat="server"，你如何做到这一点？例如，如果您有一个

```
<body runat="server" id="body1"> 
```

...并尝试从更新面板中更新它，**它**永远不会更新。

但是，如果您将其保留为普通的非服务器 HTML 控件，则可以。这是更新它的Jquery：

```
$("#body1").addClass('modalBackground'); 
```

你如何在代码隐藏中做到这一点？

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2011-02-27T03:24:21.317

如果您不想让您的控件在服务器上运行，以防您需要 ID 或者只是不想将其添加到视图状态，

```
<div id="formSpinner" class="<%= _css %>">
</div> 
```

在后端：

```
protected string _css = "modalBackground"; 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-06T21:26:00.320

如果您只想有条件地显示或隐藏 <div>，则可以将其声明为 <asp:panel>（呈现为 html 作为 div 标签）并将其设置为 .Visible 属性。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2013-01-15T20:08:09.797

要扩展 Peri 的帖子以及为什么我们可能不想使用视图状态，请使用以下代码：

`style="<%= _myCSS %>"`

`Protected _myCSS As String = "display: none"`
如果您使用的是 AJAX，它是一种查看方法，它允许通过 asp.net 后端代码而不是 jquery/jscript 操作显示。

# c# - AppDomain.CurrentDomain.BaseDirectory 和 Application.ExecutablePath 在实践中有什么区别？

> ID：175384
> 
> 赞同：7
> 
> 时间：2008-10-06T17:46:50.373
> 
> 标签：c#, .net, appdomain

根据 MSDN，BaseDirectory 是 AppDomain 查找要加载的 DLL 的地方，而 ExecutablePath 将提供原始可执行文件的路径（包括文件名）。我知道一个有文件名，另一个没有。我知道如果我创建一个新的 AppDomain，我可以给它一条不同的路径。但是从 ExecutablePath 中删除文件名并假设我只使用一个 AppDomain，实际上，这两个路径之间有什么区别？它们是否总是相同的（再次假设只有一个 AppDomain）？有没有一个例子它们会有所不同？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-06T19:47:15.777

想想像 ASP.NET 这样的东西，您的代码托管在另一个进程中。BaseDirectory 将是您的代码所在的位置，但 ExecutablePath 可能是 system32 中的一些 dll。

# javascript - 进行 CSS 翻转的首选方法是什么？

> ID：175385
> 
> 赞同：10
> 
> 时间：2008-10-06T17:47:08.390
> 
> 标签：javascript, html, css

在 HTML 中设置翻转效果时，在 CSS 与 JavaScript 中进行设置是否有任何好处（或缺陷）？对于这两种方法，我是否应该注意任何性能或代码可维护性问题？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2008-10-06T17:55:14.567

CSS 非常适合翻转。它们基本上是使用`:hover`伪选择器实现的。这是一个非常简单的实现：

```
a{
    background-image: url(non-hovered-state.png);
}
a:hover{
    background-image: url(hovered-state.png);
} 
```

不过，您需要注意以下几点：

*   IE6 只`:hover`支持`<a>`标签
*   在 CSS 中指定但未在页面上使用的图像不会立即加载（意味着翻转状态可能需要一秒钟才能第一次出现）

-tags `<a>`-only 限制通常没有问题，因为您往往希望翻转可点击。然而，后者是一个更多的问题。有一种称为[CSS Sprites](http://alistapart.com/articles/sprites/)的技术可以防止此问题，您可以找到一个用于进行[无预加载翻转](http://www.wellstyled.com/css-nopreload-rollovers.html)的技术示例。

这很简单，核心原则是创建一个大于元素的图像，将图像设置为背景图像，并使用它定位它，`background-position`以便只有你想要的位可见。这意味着要显示悬停状态，您只需要重新定位背景 - 根本不需要加载额外的文件。这是一个简单粗暴的例子（这个例子假设你有一个 20px 高的元素，以及一个包含悬停和非悬停状态的背景图像——一个在另一个之上（所以图像是 40px 高））：

```
a{
    background-image: url(rollover-sprites.png);
    background-position: 0 0; /* Added for clarity */
    height: 20px;
}
a:hover{
    background-position: 0 -20px; /* move the image up 20px to show the hovered state below */
} 
```

请注意，使用这种“精灵”技术意味着您将无法在 IE6 中使用 alpha 透明 PNG（因为 IE6 必须正确渲染 alpha 透明 PNG 的唯一方法是使用不支持的特殊图像过滤器`background-position`）

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-06T17:54:06.503

如果浏览器碰巧禁用了 Javascript，它仍然可以在 CSS 中工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-06T17:52:06.710

因为它是表示的一个方面，我会说它是基于更多标准的 CSS 来实现的。它过去是用 Javascript 完成的，仅仅是因为我们不能用 CSS 来完成（旧的浏览器很烂，我认为 :hover 直到 CSS 2 才被添加）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-06T17:55:14.350

使用 CSS 实现翻转使用 :hover 伪类来定义目标元素悬停时的样式。这在许多浏览器中都很好用，但在 IE6 中却不行，它只适用于锚标记（即 a:hover）。我使用 CSS hover 来实现选项卡式导航栏，但必须使用 IE 行为才能使其在 IE6 中工作。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-06T20:07:52.630

是的，最好的方法是[css](http://alistapart.com/articles/sprites/) [sprites](http://css-tricks.com/css-sprites-what-they-are-why-theyre-cool-and-how-to-use-them/)。IE6 中出现了一个恼人的问题，即每次悬停元素时浏览器都会发出请求。要解决此问题，[请查看此处](http://www.mister-pixel.com/index.php?Content__state=is_that_simple)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-06T17:49:04.033

我会留在房子的 CSS 方面，但我只做了很少的 Javascript。

CSS 似乎比 Javascript 更容易跨浏览器标准化，尽管随着 Chrome 的 V8 和 Firefox 即将推出的新渲染工具的出现，这种情况可能会发生变化。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-06T18:14:31.953

不是有一个记忆CSS中声明顺序的助记符吗？

# ruby-on-rails - 使用 Ruby on Rails 设计网站

> ID：175413
> 
> 赞同：8
> 
> 时间：2008-10-06T17:53:07.847
> 
> 标签：ruby-on-rails

我只是在学习 Ruby on Rails。我读过几本书，看过很多 Railscast，看过一些例子。

然而，当我使用 Rails 处理我的第一个严肃项目时，我对如何正确实现一些我见过的大多数教程所缺乏的非常基本的网站功能感到困惑。

例如：导航菜单。有很多关于如何制作静态的教程，但是动态的呢？如果我想制作一个跨页面的导航栏，我该怎么做？

我认为学习此类内容的最佳方法是查看示例代码。RoR 中有没有好的开源网站？我可以查看任何示例代码吗？

我想我的问题确实是使用 MVC 的结果。基本的想法是非常基本的，我理解这一点。但似乎大多数应用程序的每个部分都彼此完全分开......如果我想将来自两个模型的数据组合起来显示在同一页面上怎么办？以我提出的示例为例，如果我有一个 NavModel 和一个 PageModel，我的 PageController 可以访问这两个模型吗？我想我假设一个 PageController 只能访问一个 PageModel，而不能访问其他。我见过的所有例子似乎都是这样运作的……这是一个错误的假设吗？

或者我完全没有抓住重点，那是“做错了吗？”

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-06T18:02:31.260

[开源 Rails](http://www.opensourcerails.com/)是在 Rails 中实现的站点存储库。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-06T18:04:57.840

你读过哪些书？我认为，从长远来看，更好地理解 MVC 和 Rails 比示例代码对您的帮助更大，您可能会想在不理解的情况下复制这些示例代码。

您所描述的问题与查找和显示任何类型的数据并没有什么不同，我相信您已经在博客等的片段中看到过这些数据（使用部分和/或布局可能是唯一的区别） .

如果您还没有阅读它们，您应该尝试使用 Rails和[Rails Way](https://rads.stackoverflow.com/amzn/click/com/0321445619)[进行敏捷 Web 开发](https://rads.stackoverflow.com/amzn/click/com/0977616630)。

还有[几](https://rads.stackoverflow.com/amzn/click/com/0321480791) [本书](https://rads.stackoverflow.com/amzn/click/com/1590599942)可以指导您构建示例应用程序，其中包含注释，以确保您了解自己在做什么。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-06T18:35:47.090

这可能会有所帮助： [使用 Menuitem 模型的动态导航菜单](http://railsforum.com/viewtopic.php?pid=37210)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-06T18:27:20.633

您的控制器可以访问您的任何模型，因此如果 PageController 需要访问您的 NavModel 也没关系。我认为通常 Nav 控制器或助手将包含准备导航视图所需的方法，但在不知道您的项目细节的情况下我不能肯定地说 - 如果您认为它是 Page 逻辑的一部分，那么把它放在那里。

您可能还对这个“[什么去哪里](https://stackoverflow.com/questions/60658/rails-model-view-controller-and-helpler-what-goes-where)”问题感兴趣。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-28T07:29:01.463

下面是如何在您所在的页面中突出显示当前菜单项

[http://snippets.dzone.com/posts/show/2016](http://snippets.dzone.com/posts/show/2016)

# sql-server - 如何使用 TSQL 获取数据库中所有表的列表？

> ID：175415
> 
> 赞同：997
> 
> 时间：2008-10-06T17:53:21.950
> 
> 标签：sql-server, tsql, database-table

在 SQL Server 上获取特定数据库中所有表的名称的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1573
> 
> 时间：2008-10-06T18:00:56.227

SQL Server 2000、2005、2008、2012、2014、2016、2017 或 2019：

```
SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE='BASE TABLE' 
```

仅显示特定数据库中的表

```
SELECT TABLE_NAME 
FROM [<DATABASE_NAME>].INFORMATION_SCHEMA.TABLES 
WHERE TABLE_TYPE = 'BASE TABLE' 
```

或者，

```
SELECT TABLE_NAME 
FROM INFORMATION_SCHEMA.TABLES 
WHERE TABLE_TYPE = 'BASE TABLE' 
    AND TABLE_CATALOG='dbName' --(for MySql, use: TABLE_SCHEMA='dbName' ) 
```

PS：对于 SQL Server 2000：

```
SELECT * FROM sysobjects WHERE xtype='U' 
```

* * *

## 回答 #2

> 赞同：204
> 
> 时间：2008-10-06T18:02:10.140

```
SELECT sobjects.name
FROM sysobjects sobjects
WHERE sobjects.xtype = 'U' 
```

以下是您也可以搜索的其他对象类型的列表：

*   AF：聚合函数 (CLR)
*   C：检查约束
*   D：默认或 DEFAULT 约束
*   F：外键约束
*   L：日志
*   FN：标量函数
*   FS：汇编（CLR）标量函数
*   FT：汇编 (CLR) 表值函数
*   IF：内联表函数
*   IT：内部表
*   P：存储过程
*   PC：装配 (CLR) 存储过程
*   PK：PRIMARY KEY 约束（类型为 K）
*   RF：复制过滤器存储过程
*   S：系统表
*   SN：同义词
*   SQ：服务队列
*   TA：装配 (CLR) DML 触发器
*   TF：表函数
*   TR：SQL DML 触发器
*   TT：表类型
*   U：用户表
*   UQ：UNIQUE 约束（类型为 K）
*   五：查看
*   X：扩展存储过程

* * *

## 回答 #3

> 赞同：101
> 
> 时间：2008-10-06T17:58:19.180

```
SELECT * FROM INFORMATION_SCHEMA.TABLES 
```

或者

```
SELECT * FROM Sys.Tables 
```

* * *

## 回答 #4

> 赞同：31
> 
> 时间：2013-10-03T11:23:34.820

```
USE YourDBName
GO 
SELECT *
FROM sys.Tables
GO 
```

或者

```
USE YourDBName
GO
SELECT * FROM INFORMATION_SCHEMA.TABLES 
GO 
```

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2013-08-13T07:45:56.253

```
SELECT * FROM information_schema.tables
where TABLE_TYPE = 'BASE TABLE' 
```

SQL Server 2012

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2008-10-06T17:53:54.727

```
exec sp_msforeachtable 'print ''?''' 
```

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2008-10-06T17:55:21.900

`select * from sysobjects where xtype='U'`

* * *

## 回答 #8

> 赞同：9
> 
> 时间：2008-10-06T17:55:40.870

```
SELECT name 
FROM sysobjects 
WHERE xtype='U' 
ORDER BY name; 
```

（SQL Server 2000 标准；在 SQL Server 2005 中仍受支持。）

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2008-10-06T17:56:33.067

```
SELECT sobjects.name
FROM sysobjects sobjects
WHERE sobjects.xtype = 'U' 
```

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2017-09-27T12:20:24.070

缺点`INFORMATION_SCHEMA.TABLES`是它还包括系统表，例如`dtproperties`和`MSpeer_...`表，无法将它们与您自己的表区分开来。

我建议使用（已弃用的[sysobjects](https://docs.microsoft.com/en-us/sql/relational-databases/system-compatibility-views/sys-sysobjects-transact-sql)[`sys.objects`](https://docs.microsoft.com/en-us/sql/relational-databases/system-catalog-views/sys-objects-transact-sql)视图的新版本 ），它确实支持排除系统表：

```
select *
from sys.objects
where type = 'U'      -- User tables
and is_ms_shipped = 0 -- Exclude system tables 
```

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2019-02-16T09:00:55.813

那么您可以使用*sys.objects*来获取所有数据库对象。

```
 GO
 select * from sys.objects where type_desc='USER_TABLE' order by name
 GO 
```

或者

```
--  For all tables
select * from INFORMATION_SCHEMA.TABLES 
GO 

  --- For user defined tables
select * from INFORMATION_SCHEMA.TABLES where TABLE_TYPE='BASE TABLE'
GO

  --- For Views
select * from INFORMATION_SCHEMA.TABLES where TABLE_TYPE='VIEW'
GO 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2015-11-13T12:34:51.257

```
--for oracle
select tablespace_name, table_name from all_tables; 
```

* * *

[此链接可以提供有关此主题](http://onewebsql.com/blog/list-all-tables)的更多信息

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2017-10-13T03:10:09.693

在 SSMS 中，要获取特定数据库中的所有完全限定表名（例如，“MyDatabase”）：

```
SELECT [TABLE_CATALOG] + '.' + [TABLE_SCHEMA] + '.' + [TABLE_NAME]
FROM   MyDatabase.INFORMATION_SCHEMA.Tables
WHERE  [TABLE_TYPE] = 'BASE TABLE' and [TABLE_NAME] <> 'sysdiagrams'
ORDER BY [TABLE_SCHEMA], [TABLE_NAME] 
```

结果：

*   MyDatabase.dbo.MyTable1
*   MyDatabase.dbo.MyTable2
*   MyDatabase.MySchema.MyTable3
*   MyDatabase.MySchema.MyTable4
*   等等

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2017-11-23T17:28:56.803

请使用这个。您将获得表名和模式名：

```
SELECT SYSSCHEMA.NAME, SYSTABLE.NAME
FROM SYS.tables SYSTABLE
INNER JOIN SYS.SCHEMAS SYSSCHEMA
ON SYSTABLE.SCHEMA_ID = SYSSCHEMA.SCHEMA_ID 
```

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2022-01-19T19:29:52.713

```
Any of the T-SQL code below will work in SQL Server 2019:

-- here, you need to prefix the database name in INFORMATION_SCHEMA.TABLES
SELECT TABLE_NAME FROM [MSSQL-TEST].INFORMATION_SCHEMA.TABLES;

-- The next 2 ways will require you to point
-- to the specific database you want to list the tables

USE [MSSQL-TEST];
-- (1) Using sys.tables
SELECT * FROM sys.tables;

-- (2) Using sysobjects
SELECT * FROM sysobjects
WHERE type='U';

Here’s a working example using [Skyvia] using sys.tables.

[Skyvia] should be the link to https://skyvia.com/connectors/sql-server

  [1]: https://i.stack.imgur.com/o3qo9.png 
```

[![在此处输入图像描述](https://i.stack.imgur.com/OghPy.png)](https://i.stack.imgur.com/OghPy.png)

```
Your SQL GUI tool should also have a way to list down all the tables in a database like the one above.

So, whatever suits your need and taste, there’s a code or GUI tool for that. 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2017-07-07T04:35:54.347

```
SELECT TABLE_NAME 
FROM INFORMATION_SCHEMA.TABLES 
WHERE TABLE_TYPE='BASE TABLE' 
ORDER BY TABLE_NAME 
```

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2017-08-17T22:19:04.003

感谢 Ray Vega，他的回复提供了数据库中的所有用户表......

> exec sp_msforeachtable '打印''？'''

sp_helptext 显示基础查询，它总结为...

```
select * from dbo.sysobjects o 
join sys.all_objects syso on o.id =  syso.object_id  
where OBJECTPROPERTY(o.id, 'IsUserTable') = 1 
and o.category & 2 = 0 
```

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2019-01-07T07:43:50.470

使用`SELECT * FROM INFORMATION_SCHEMA.COLUMNS`还会向您显示所有表和相关列。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2021-08-18T19:57:41.383

要删除复制添加的表和 Microsoft 添加的任何其他表，请运行以下命令：

```
SELECT s.NAME SchemaName, t.NAME TableName
FROM [dbname].SYS.tables t
INNER JOIN [dbname].SYS.SCHEMAS s
ON t.SCHEMA_ID = s.SCHEMA_ID
WHERE t.is_ms_shipped=0 and type_desc = 'USER_TABLE'
ORDER BY s.NAME, t.NAME 
```

# php - PHP网站，我应该开发成Linux发行版而不是Windows吗？

> ID：175425
> 
> 赞同：5
> 
> 时间：2008-10-06T17:55:25.143
> 
> 标签：php, linux, xampp, virtualbox

几个月后，我开始了一个 PHP 项目，但我犹豫是否像往常一样：在我的 Windows Vista 64 位机器上开发。由于我对 Linux 知之甚少，我认为通过在 Linux 发行版上工作可能是一种学习的好方法。

**你认为这是个好主意吗？**我会在 Ubuntu 上运行[VirtualBox](http://www.virtualbox.org/)（在我的 Vista64 位上）。我正在考虑安装[XAMPP](http://www.apachefriends.org/en/xampp-linux.html)以便能够在 PHP 中进行开发。

如果您认为这是一个好主意，请随时向我推荐一些关于虚拟化操作系统或 Linux/dev 应该知道的教程。

**更新** 我已经在 Windows 中用 PHP 构建了许多网站，问题更多是关于通过虚拟机在其上进行开发来开始学习 Linux 是否是一种好方法？我有 4 个 gigs ram，如果我在虚拟机中安装 Eclipse 会顺利吗？等等

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-06T17:58:39.770

PHP在任何平台上都**应该是相同的——所以你***在哪里*开发并不重要。

但是，根据我的经验和观察，在 Linux 上运行 PHP 的站点比在 Windows 上运行的站点多。

在 Ubuntu 或 Fedora 上安装 Apache 和 PHP 很简单，测试一切也很简单。

此外，当您的网站上线时，它将在什么平台上运行？我更喜欢尽可能在它将运行的平台上进行开发。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-06T19:59:53.600

您应该真正在要部署的同一平台上进行开发。我并不是说采取不同的做法是不好的，但从长远来看，它可以为您节省一些痛苦。OTOH，您可以通过这种方式更快地了解平台差异。所以，主要问题是：您是否希望生产系统尽快运行而不会让人头疼？或者，您想花一些时间和精力来学习如何开发跨平台的东西？

是的，存在差异。例如，区分大小写和不区分大小写的文件名。然后，一些 PHP 函数使用具有不同实现的本机 C 函数。例如， printf() 不会为某些类型产生相同数量的空白。时间测量的分辨率（毫秒与微秒）可能不同，等等。然后，您有不同的文件系统权限处理方式。这些只是我最近发现的一些问题，我可以记住。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-06T17:58:41.940

就个人而言，我认为对于本地生产，您不应该使用 VM。你也会在 VM 中运行你的 IDE 吗？

如果您足够了解在 Windows 和 Linux 环境之间移动的陷阱（例如区分大小写和权限），那么在 Windows 上开发和在 Linux 上部署应该没有问题。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-06T18:00:44.493

在 Linux 发行版上工作无疑是学习它的最简单方法。设置一些服务器并进行一些开发工作是一个很好的开始。

虚拟化 Linux 也很容易。我已经做了很多次了，这真的很糟糕。此外，这样做会让您更轻松地使用 Linux，这比像我一样跳进去发现您的无线网卡不受支持要好得多 :)

至于 Linux 上的 PHP 开发……我已经在 Windows 和 Linux 上进行了一些 PHP 编码，我可以告诉你两者之间几乎没有区别。我在两个平台和 Apache &MySQL / XAMPP 上都使用 Eclipse。我看到的唯一主要区别是 Linux 对权限和大小写更加挑剔。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-06T21:10:23.723

PHP在所有平台上*都不*相同，直到最近 Windows 版本还存在 Linux 版本中没有的问题。许多有用的特性是 *nix 特有的。

我会回应@Milan 关于在部署环境中进行开发的观点。通过这样做，您也可以了解更多关于部署环境的信息。

在虚拟机问题上，如果您想要所有的 Windows 工具和 Windows 机器，请在您的虚拟机中设置一个 linux*服务器*（如果需要，可以有一个 GUI，但您主要将其用作服务器）。设置它，以便 windows 可以查看在您的 VM 中运行的 apache 安装，并且您使用 samba 共享访问 vm 的文件，就像 windows 中的驱动器一样。这样，您在 Windows 中开发，但正在运行的 linux 服务器上测试部署/设置。虽然我店里的两个开发人员运行 Ubuntu，但第三个需要一直使用 Photoshop 和其他各种 Windows 软件，所以她使用这种在 VM 中运行服务器但从 Windows 开发的方法。

哦，如果您在 Linux 上运行，请不要使用 XAMPP！一些简单的命令将使您启动并运行，您将更好地了解您的部署。XAMPP 很好，但它适用于没有 Linux 包管理的操作系统。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-06T18:03:53.770

虽然[XAMPP](http://www.apachefriends.org/en/xampp.html)工作得很好，但在 Linux 上运行 Apache 和 PHP 是给定的；而在 Windows 上，这是你必须做的额外的事情......和支持。此外，堆栈的大部分部分都针对 POSIX 环境进行了优化和成熟。数据库引擎的性能对可用的原语特别敏感。

大多数 OSS 都在 windows 上运行，但它是一个在方孔上敲击的圆钉。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-06T18:15:28.100

原则上，我建议不要在实际项目中“边做边学”——除非它真的很小，或者你以前做过非常相似的项目，这样项目相关问题的学习曲线就不会很陡峭。在这种情况下，您可能有免费的资源来了解开发环境。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-06T19:20:40.247

一般来说，我比 Windows 更喜欢 Linux 环境。主要是因为提供了您需要的所有 CLI 工具，并且 Bash 可以随时击败 cmd.ext。但是对于 Cygwin，我甚至发现 Windows 也是一个舒适的开发环境。

关于 PHP 开发，我真的看不出它会有什么不同。如果您使用展位系统，那么被迫使代码更具可移植性（例如行尾、文件名中的正斜杠等）可能会有一些好处。

作为台式机或工作站，两者之间没有太大区别。我发现最大的不同在于你如何管理它们，但希望你有其他人为你做这件事。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-06T18:03:24.520

在我看来，您不需要在 linux 发行版中进行开发。可以从任何操作系统完成 Web 开发。我不知道，你为什么要为网络编程……作为专业人士？为您的个人主页？我认为，获得一些运行 PHP 服务器的免费网络空间并在那里上传您的文件就足够了……这不会花费您太多时间，而且需要管理的事情也更少。

一个德国学生；）

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-06T18:11:11.057

使用您的部署服务器将运行的操作系统，它很可能是 linux。我最近看到一个部署非常糟糕，因为它是使用 wampserver 开发并部署在 CentOS 上的。Apache 和 PHP 配置的主要区别。因此，了解您的部署服务器并尽可能匹配它。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-08T06:07:08.757

尝试使用 VmWare Player 创建开发环境。我有几个在我的 Vista 笔记本电脑上运行的 Linux 环境。你也可以只是双启动。我用的是 Ubuntu，很简单。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-03-02T16:04:02.107

在虚拟机内部开发的副作用：更多的开销，最终需要额外的工具来使开发更舒适。人们通常需要特殊的工具来进行开发，例如 Photoshop 或一些 Linux 上不可用的矢量设计工具。如果项目的工作副本位于 VM 内部，那么可以轻松访问它是有意义的。因此，您将设置 SAMBA（这通常会导致从 XP 登录时出现问题）或设置 SSL(SFTP)/FTP。此外，您还必须学习如何将网络与 VM 一起使用（NAT、桥接、端口转发）。

另一方面，在另一个平台上开发作为目标可能会让人有些头疼。我发现自己经常与用于密码保护的 .htaccess 文件混淆，因为 Windows/Linux 上的路径不同。如果您稍后忘记在生产服务器上更改此条目，那么您有问题...

更好的解决方案：使用两全其美。一个最终在 Ubuntu/Debian/FreeBSD 上无头运行的虚拟机（没有 gui，更像是一个“远程服务器”），并且只运行所需的服务器（Apache、MySQL、FTP、SSH ......）。

Eclipse 或 Windows/Mac 上的其他开发工具。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2013-04-22T04:38:59.673

5年后：我的意见是使用Linux解决方案。在 Linux 中使用 PHP 有很多优点。主要原因是社区提供的帮助水平。PHP 似乎也针对 Linux 环境进行了优化。

由于绝大多数站点都使用 LAMP 解决方案托管和运行，因此数量上也很安全。有很多框架和 CMS 可以在带有 Apache2 的 Linux 上运行得最好。

让您的生活更轻松，立即开始学习 PHP。

# java - 在 java 代码中查找包命名空间冲突的工具

> ID：175437
> 
> 赞同：2
> 
> 时间：2008-10-06T17:58:46.697
> 
> 标签：java, refactoring

我们有许多项目使用相同和/或相似的包名称。许多或这些项目将构建其他项目使用的 jar 文件。我们发现许多 foo.util foo.db 和 foo.exceptions 使用相同的类名导致命名空间冲突。

有谁知道一个工具可以搜索一组 java 代码库并自动查找名称空间冲突和模棱两可的导入？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-06T18:23:19.987

在每个单独的项目中修复您的名字更简单。

真的。

你不需要**知道**所有的冲突。你的包名首先应该是唯一的。如果它们不是唯一的，您需要重新考虑如何分配包名称。如果它们是“扁平的”（`foo.this`和`foo.that`），则需要使它们更高且更具体。

这就是为什么这些例子总是`org.apache.project.component.lower.level.names`.

你应该有`com.projectX.foo.this`并且`com.projectZ.foo.that`防止**重复**的可能性。

“但是所有的重新编译，”你说。无论如何，你必须这样做。不要浪费大量时间试图发现准确、完整的范围。使用你所知道的，现在就开始修复事情，并通过你的代码库一次修复一件事。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-06T18:00:30.393

如果您可以将项目加载到 Eclipse 中，Problems 视图将为您提供冲突和不明确的导入。还有一个组织导入向导，可以帮助处理任何不必要的导入。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-07T03:28:35.207

我同意 S.Lott 的观点——你首先需要弄清楚这件事是如何发生的，并让做错事的人感到非常痛苦（即让他们回去修复问题）。现代 IDE（Eclipse 就是其中之一）使这种重构变得相当容易。

我唯一不同意的是在你去的时候修理东西。相反，我强烈建议您*现在*通过可靠的包名称审查来偿还您的技术债务。几个小时（这实际上就是它应该花费的全部时间）将让您免去调试的噩梦。

仅供参考 - 在不同源文件夹中的同一个包中拥有类是完全合法的（例如）：

src/com/my/project 测试/com/my/project

试图区分上述有效的文件夹结构，以及您即将遇到的情况，以任何自动化方式都将非常困难。

# sql - 您如何对数据库架构进行版本控制？

> ID：175451
> 
> 赞同：132
> 
> 时间：2008-10-06T18:02:29.093
> 
> 标签：sql, mysql, schema, versioning

您如何准备 SQL 增量？您是手动将每个模式更改 SQL 保存到 delta 文件夹，还是有某种自动差异过程？

我对版本控制数据库模式的约定以及源代码感兴趣。也许是一个区分模式的预提交钩子？

此外，除了[DbDeploy](http://dbdeploy.com/)之外，还有哪些用于区分增量的选项？

**编辑：**看到答案我想澄清一下，我熟悉使用增量运行数据库迁移的标准方案。我的问题是关于自己创建增量，最好是自动创建。

此外，如果有区别，版本控制适用于 PHP 和 MySQL。（请不要使用 Ruby 解决方案）。

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2008-10-06T18:07:00.660

看

[是否有用于数据库结构更改的版本控制系统？](https://stackoverflow.com/questions/308/is-there-a-version-control-system-for-database-structure-changes)

[如何在 SVN 中对我的 MS SQL 数据库进行版本控制？](https://stackoverflow.com/questions/173/how-do-i-version-my-ms-sql-database-in-svn)

和杰夫的文章

[让您的数据库处于版本控制之下](http://blog.codinghorror.com/get-your-database-under-version-control/)

我感受到你的痛苦，我希望有一个更好的答案。这可能更接近您正在寻找的内容。

[跟踪数据库架构更改的机制](https://stackoverflow.com/questions/1607/mechanisms-for-tracking-db-schema-changes#22535)

一般来说，我觉得对此没有适当的、可接受的解决方案，我在这方面推出了自己的解决方案。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-06T18:08:07.193

您可能会看一下另一个类似的线程：[如何在 SVN 中对我的 MS SQL 数据库进行版本控制？](https://stackoverflow.com/questions/173/how-do-i-version-my-ms-sql-database-in-svn).

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2010-10-25T05:06:03.640

如果您仍在寻找选择：看看 neXtep 设计师。它是一个基于版本控制概念的免费 G​​PL 数据库开发环境。在环境中，您始终使用版本化实体，并且可以专注于数据模型开发。发布完成后，插入版本控制系统的 SQL 生成引擎可以在 2 个版本之间生成您需要的任何 delta，并在您需要时为您提供一些交付机制。

除此之外，您可以在开发过程中同步和反向同步您的数据库、创建数据模型图、使用集成的 SQL 客户端查询您的数据库等。

查看 wiki 了解更多信息： http: [//www.nextep-softwares.com/wiki](http://www.nextep-softwares.com/wiki)

它目前支持 Oracle、MySql 和 PostgreSql，并且是在 java 中，因此该产品可以在 windows、linux 和 mac 上运行。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-06T18:15:44.230

我不管理增量。我对主数据库进行了更改，并拥有一个基于主数据库创建基于 XML 的构建脚本的工具。

在升级现有数据库时，我有一个程序，它使用基于 XML 的构建脚本来创建新数据库和裸表。然后我使用 INSERT INTO x SELECT FROM y 从旧数据库复制数据，然后应用所有索引、约束和触发器。

新表、新列、已删除列都会自动处理，并通过一些小技巧来调整复制例程，我可以处理列重命名、列类型更改和其他基本重构。

我不会在具有大量数据的数据库上推荐此解决方案，但我会定期更新超过 1GB 且包含 400 个表的数据库。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2015-07-16T10:51:26.430

我确保架构更改始终是附加的。所以我不会删除列和表，因为这会破坏数据并且以后无法回滚。这样，可以回滚使用数据库的代码而不会丢失数据或功能。

我有一个迁移脚本，其中包含创建表和列（如果它们尚不存在）并用数据填充它们的语句。

每当更新生产代码和新安装后，迁移脚本就会运行。

当我想删除某些东西时，我会从数据库安装脚本和迁移脚本中删除它们，这样这些过时的架构元素将在新安装中逐渐淘汰。缺点是新安装无法在安装之前降级到旧版本。

当然，我通过这些脚本执行 DDL，而不是直接在数据库上以保持同步。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-06T18:20:06.110

您没有提到您使用的是哪个 RDBMS，但如果它是 MS SQL Server，Red-Gate 的[SQL 比较](http://www.red-gate.com/products/SQL_Compare/index.htm)对于我们在创建对象创建脚本之间创建增量是必不可少的。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-01T19:58:17.850

我不是一个自吹自擂的人，但我开发了一个内部 Web 应用程序来跟踪对数据库模式的更改并创建版本化更新脚本。

这个工具被称为[巴西](http://github.com/jbripley/brazil/tree/master)，现在在 MIT 许可下开源。Brazil 是基于 ruby​​ / ruby​​ on rails 的，支持更改部署到[Ruby DBI](http://ruby-dbi.rubyforge.org/)支持的任何数据库（MySQL、ODBC、Oracle、Postgres、SQLite）。

计划支持将更新脚本置于版本控制中。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2010-07-02T05:49:47.467

[http://bitbucket.org/idler/mmp](http://bitbucket.org/idler/mmp) - mysql 的模式版本控制工具，用 PHP 编写

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-06T18:07:56.757

我们将数据导出为可移植格式（使用我们的工具链），然后将其导入新模式。不需要增量 SQL。强烈推荐。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-10-06T18:51:55.123

我也对这个话题很感兴趣。

在 Django wiki 中有[一些关于这个主题的讨论](http://code.djangoproject.com/wiki/SchemaEvolution)。

有趣的是，看起来CakePHP仅使用命令就[内置了模式版本控制](http://book.cakephp.org/view/735/Generating-and-using-Schema-files)`cake schema generate`。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-10-06T19:48:01.517

我使用[Firebird](http://www.firebirdsql.org)数据库进行大多数开发，并使用[FlameRobin](http://www.flamerobin.org)管理工具。它有一个不错的选项来记录所有更改。它可以将所有内容记录到一个大文件中，或者每个数据库更改一个文件。我使用第二个选项，然后将每个脚本存储在版本控制软件中——之前我使用 Subversion，现在我使用 Git。

我假设您可以找到一些 MySQL 工具，它具有与 FlameRobin 为 Firebird 所做的相同的日志记录功能。

在其中一个数据库表中，我存储了数据库结构的*版本号*，因此我可以轻松升级任何数据库。我还编写了一个简单的 PHP 脚本，它在任何目标数据库上一个接一个地执行这些 SQL 脚本（数据库路径和用户名/密码在命令行中提供）。

还有一个选项来记录所有 DML（插入、更新删除）语句，我在修改每个数据库包含的一些“默认”数据时激活了它。

我写了一篇很好的白皮书，详细介绍了我是如何做到这一切的。[您可以从此处](http://sourceforge.net/project/showfiles.php?group_id=58913&package_id=212064)下载 .pdf 格式的论文以及演示 PHP 脚本。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-01-29T13:26:54.480

我还开发了一组 PHP 脚本，开发人员可以将他们的 deltasql 脚本提交到中央存储库。

在其中一个数据库表（称为 TBSYNCHRONIZE）中，我存储了最新执行的脚本的版本号，因此我可以使用 Web 界面或专门为 Eclipse 开发的客户端轻松升级任何数据库。

Web 界面允许管理多个项目。它还支持数据库“分支”。

您可以在[http://www.gpu-grid.net/deltasql](http://www.gpu-grid.net/deltasql)上测试应用程序（如果您使用密码 testdbsync 以管理员身份登录）。该应用程序是开源的，可以在这里下载：http: [//sourceforge.net/projects/deltasql](http://sourceforge.net/projects/deltasql)

deltasql 在瑞士和印度得到了有效的使用，在日本也很流行。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2010-07-07T21:31:42.570

几个月前，我搜索了 MySQL 模式版本控制工具。我发现了很多有用的工具，比如 Doctrine 迁移、RoR 迁移、一些用 Java 和 Python 编写的工具。

但是没有一个能满足我的要求。

我的要求：

1.  无要求，不包括 PHP 和 MySQL
2.  没有模式配置文件，如 Doctrine 中的 schema.yml
3.  能够从连接中读取当前模式并创建新的迁移脚本，而不是在其他应用程序安装中表示相同的模式。

我开始写我的迁移工具，今天我有测试版。

如果您对此主题感兴趣，请尝试一下。请向我发送未来的请求和错误报告。

源代码：bitbucket.org/idler/mmp/src 英文概述：bitbucket.org/idler/mmp/wiki/Home 俄文概述：antonoff.info/development/mysql-migration-with-php-project

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2011-11-18T16:18:39.133

我使用[http://code.google.com/p/oracle-ddl2svn/](http://code.google.com/p/oracle-ddl2svn/)

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2013-07-17T21:55:33.123

我正在使用数据库模式的严格版本控制（在单独的表中跟踪）。脚本存储在版本控制中，但它们都在进行任何更改之前验证当前架构版本。

这是 SQL Server 的完整实现（如果需要，可以为 MySQL 开发相同的解决方案）：[如何维护 SQL Server 数据库架构版本](http://www.codinghelmet.com/?path=howto/sql-schema-versioning)

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2016-09-06T07:54:29.413

## 对于 MySQL

当我登陆新数据库时：

首先，我检查结构：

> ```
> mysqldump --no-data --skip-comments --skip-extended-insert -h __DB_HOSTNAME__ -u __DB_USERNAME__ -p __DB1_NAME__ | sed 's/ AUTO_INCREMENT=[0-9]*//g' > FILENAME_1.sql
> mysqldump --no-data --skip-comments --skip-extended-insert -h __DB_HOSTNAME__ -u __DB_USERNAME__ -p __DB2_NAME__ | sed 's/ AUTO_INCREMENT=[0-9]*//g' > FILENAME_2.sql
> diff FILENAME_1.sql FILENAME_2.sql > DIFF_FILENAME.txt
> cat DIFF_FILENAME.txt | less 
> ```
> 
> 感谢 stackoverflow 用户，我可以编写这个快速脚本来查找结构差异。
> 
> *源代码：[https](https://stackoverflow.com/a/8718572/4457531) ://stackoverflow.com/a/8718572/4457531 & [https://stackoverflow.com/a/26328331/4457531](https://stackoverflow.com/a/26328331/4457531)*

在第二步中，我逐表检查数据`mysqldiff`。这有点过时，但基于`information_schema`数据的 php 循环确实可以完成工作

对于版本控制，我使用相同的方式，但我使用差异结果格式化 SQL 更新脚本（升级或回滚），并使用版本号约定*（经过多次修改，版本号看起来像一个 IP 地址）*。

```
initial version : 1.0.0
                  ^ ^ ^
                  | | |
structure change: - | |
datas added: -------- |
datas updated: -------- 
```

# .net - 循环和垃圾收集

> ID：175454
> 
> 赞同：4
> 
> 时间：2008-10-06T18:02:49.297
> 
> 标签：.net, vb.net, garbage-collection, loops

我正在开发一个 Web 应用程序，我遇到了以下情况。

```
Dim a as Object
Dim i as Integer = 0

Try

    For i=1 to 5

        a = new Object()

        'Do stuff '

        a = Nothing

    Next

Catch

Finally

   a = Nothing

End Try 
```

我需要在循环中执行 a=Nothing 还是垃圾收集器会清理干净？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-06T18:08:21.623

在 .NET 中，通常**不需要**设置变量引用 = `Nothing`（`null`在 C# 中）。垃圾收集器最终会清理干净。当超出范围时引用本身将被销毁（当您的方法退出时或当此类的对象最终确定时）。请注意，这并不意味着**对象**被销毁，只是对它的引用。该对象仍将被收集器不确定地销毁。

但是，设置您的引用 =`Nothing`将为 .NET 提供一个提示，即该对象可能是垃圾，并且不一定会伤害任何东西——除了代码混乱之外。如果您要将它保留在那里，我建议您将其从`Try`块中移除；它已经在`Finally`块中，因此将始终被调用。（除了某些灾难性的例外；但在那些情况下，它也不会在`Try`块中被调用！）

最后，我不得不承认我同意 Greg 的观点：没有这个，你的代码会更干净。提示您已完成引用的运行时很好，但肯定不是关键。老实说，如果我在代码审查中看到这一点，我可能会让开发人员重写它：

```
Dim a as Object
Dim i as Integer = 0

For i=1 to 5
    a = new Object()
    'Do stuff
Next 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-06T18:05:21.053

几乎从不需要显式地将 Nothing 分配给变量。垃圾收集器的工作是为你处理内存分配，专门为你解除这个责任。所以不，你不需要`a = Nothing`在循环内分配。

您也不需要`try/finally`在整个事物周围分配 Nothing 的块。这实际上只是运行时系统无论如何都会处理的额外混乱。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-06T18:04:18.950

不，你不需要它。.NET 具有垃圾收集功能。由于看起来这段代码在方法范围内，垃圾收集将清理所有局部变量。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-06T18:07:41.890

GC 会清理它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-06T18:40:13.213

像上面提到的每个人一样，您不需要将变量显式设置为空，因为它是自动处理的。但是，如果出于某种原因你想强制 GC 收集，你可以运行这个：

```
System.GC.Collect() 
```

# flash - Flash 导出/发布时间

> ID：175464
> 
> 赞同：4
> 
> 时间：2008-10-06T18:05:17.917
> 
> 标签：flash, time, export, publish, cs3

将简单的 Flash 电影导出到 swf 的时间长得离谱的主要原因是什么？我没有不必要的图像或符号，所有可能的设置都设置为低于低，并且仍然需要 10 分钟及以上才能以 24 fps 导出 30 秒动画。我什至创建了一个新的 fla 并将所有内容都粘贴在那里，以确定它是否可能只是 flash 中的错误。我导出的所有其他动画都需要正常的时间。

系统规格：1GB DDR2 RAM Intel Pentium D 3.4GHz

我应该升级我的系统吗？

这可能与符号中有许多符号有关吗？

编辑：fla 的文件大小为 1.3 MB，swf 为 500 KB。所以不会太大。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-07T03:24:22.780

这不是 Flash 的平均值。通常，导出时间长的唯一原因是您要导出很多东西，其中一些您可能并不打算导出。

你的动画有音频吗？如果您将音频导入 FLA，则每次导出时都必须对声音进行编码，这需要一段时间。解决此问题的最佳方法是，在发布设置中，将音频压缩设置为“原始”。这将发布未压缩的音频，因此会增加文件大小但会立即发布。（当然，当您准备好导出成品时，您需要将设置恢复为压缩格式以进行最终导出。）或者，您可以将音频放在单独的文件中（SWF、MP3 等）并在运行时加载它。

另一个常见的错误是不小心嵌入了大字体。如果您有使用嵌入字体的动态文本字段，则可以嵌入整个字体，这对于 unicode 字体可能需要几分钟时间。很容易检查你是否正在做这样的事情 - 在发布设置中，打开“生成大小报告”。然后导出，并检查大小报告中是否有您不想导出的任何大块内容。

在不知道您要导出的内容类型的情况下很难说更多，但如果您有一段内容的导出时间比类似的内容要长得多，那么原因可能就是这些问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-12-10T04:16:16.170

您应该始终尝试解决此问题的第一件事是一个非常简单的问题，尽管它没有真正记录任何人。

文件 -> 保存并压缩

您的电影可能会因不再需要但仍保留在 .FLA 文件中的各种杂乱和剩余的库元素而变得越来越大，这可能会减慢您的导出速度。这个命令强制 Flash 从本质上重建你的 FLA 并摆脱所有这些“脂肪”。

当然，这不是万能的，即使运行了它，您可能仍然会遇到其他问题。但是，如果您想减少 SWF 文件大小或导出时间，这是第一步，也是人们应该注意的一步。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2008-10-06T22:40:29.890

不幸的是，这对于闪光灯来说是相当平均的。

您可以查看[actionscript.org](http://www.actionscript.org/forums/showthread.php3?t=50801)上的这篇文章，其中讨论了拆分项目以节省编译时间。

[早在 AS2 时代，一种名为MTASC](http://www.mtasc.org/#comparison)的开源编译器 大大减少了[编译时间](http://www.mtasc.org/#comparison)。此后，它变成了带有 AS2、AS3、Javascript、PHP 和 Neko 虚拟机的[Haxe ，它们都使用相同的语法。](http://haxe.org/)使用的语法类似于 C++。

** 编辑 ** 抱歉，我将以上内容视为 10 秒，而不是 10 分钟……抱歉。^_^

# regex - 美国电话号码验证

> ID：175488
> 
> 赞同：7
> 
> 时间：2008-10-06T18:10:08.627
> 
> 标签：regex, algorithm, validation, phone-number

我有一个网站表单，需要输入美国电话号码以进行跟进，在这种情况下这是非常必要的。我想尝试消除输入垃圾数据*330-000-0000*的用户。我已经看到了一些第三方为您验证电话号码的选项，但是如果这是这种情况下的最佳选择，请不要犹豫。但是，如果您已经使用过这些第三方中的任何一个，并且可以提出建议，在这里也将不胜感激。

但是，我正在考虑根据一组规则检查该号码，以尝试缩小收到的垃圾电话号码的范围。

*   不是 555 号码
*   不包含 7 个相同的数字
*   有效的区号（这很容易获得）
*   不是 123-1234 或 123-4567
*   我想我也可以数出 867-5309 (heh [*](http://en.wikipedia.org/wiki/8675309) )

这是否会导致您认为不允许用户输入电话号码的任何情况？你能想到电话号码不应该包含的任何其他规则吗？还有其他想法吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-06T20:50:19.160

在我看来，你在这方面付出的努力超出了它的保证。考虑：

如果您的目的是防止错误输入的电话号码，那么您可能只需进行一次非常简单的检查就可以捕获超过 90% 的电话号码。

如果你的目的是试图强迫用户提供一个有效的号码，无论他们是否愿意提供该信息，那么你就承担了一项无望的任务——即使你能够访问 100% 准确的、最多-第二个电信公司数据库验证输入的确切号码当前是实时的，您仍然无法保证他们给您的号码是他们自己的号码。再一次，一个简单的检查将阻止大多数人输入虚假数字，但那些愿意尝试超过两三次的*人会*找到一种方法来挫败你获取他们数字的尝试。

无论哪种方式，一个简单的测试都会给你带来好的结果，而进入更复杂的规则集将占用越来越多的时间，而给你带来的好处却越来越少（同时也可能增加误报，如“七个相同的数字”和 867-5309 例）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-06T18:16:08.300

您可以使用正则表达式在应用程序内部进行电话号码验证。根据您的语言，您可以调用一个函数，如果提供的电话号码与表达式匹配，该函数将返回 true。

在 PHP 中：

```
function phone_number_is_valid($phone) {
    return (eregi('^(?:\([2-9]\d{2}\)\ ?|[2-9]\d{2}(?:\-?|\ ?))[2-9]\d{2}[- ]?\d{4}$', $phone));
} 
```

您可以在线查找不同的正则表达式。[我在http://regexlib.com/DisplayPatterns.aspx?categoryId=7&cattabindex=2](http://regexlib.com/DisplayPatterns.aspx?categoryId=7&cattabindex=2)找到了上面那个

编辑：一些特定语言的正则表达式站点：

*   php.net 上的 PHP：http: [//php.net/regex](http://php.net/regex)
*   [MSDN 上的 C#](http://msdn.microsoft.com/en-us/library/ms228595%28VS.80,loband%29.aspx)
*   Java：http: [//java.sun.com/developer/technicalArticles/releases/1.4regex/](http://java.sun.com/developer/technicalArticles/releases/1.4regex/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-06T18:11:58.607

867-5309 是分配给不同区号的人的有效电话号码。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-06T18:15:17.507

如果您可以验证区号*，那么除非您真的非常*需要知道他们的电话号码，否则您可能会尽其所能。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-06T18:18:06.957

也许看看[这个问题](https://stackoverflow.com/questions/123559/a-comprehensive-regex-for-phone-number-validation)的答案。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-06T18:18:39.607

您的客户仍然可以做我所做的事情，即提供当地的 moviefone 号码。

此外，123-1234 或 123-4567 只是无效数字，因为前缀以 1 开头，但 234-5678 或 234-1234 实际上是有效的（尽管看起来很假）。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-06T18:22:58.413

在 Django 中有一个名为 localflavor 的不错的小贡献包，它有很多特定于国家/地区的验证码，例如邮政编码或电话号码。您也可以查看源代码，了解 django 如何为您想使用的国家/地区处理这些；例如：[美国表格验证](http://code.djangoproject.com/browser/django/tags/releases/1.0/django/contrib/localflavor/us/forms.py)。这对于您也知之甚少的国家/地区的信息来说是一个很好的资源。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-06T18:13:33.173

如果您只使用美国和加拿大格式的数字，我认为以下正则表达式可能有效：[2-9][0-9][0-9]-[2-9][0-9][ 0-9]-[0-9][0-9][0-9][0-9] & ![2-9][0-9][0-9]-555-[0-9] [0-9][0-9][0-9]

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-06T18:14:35.480

您还需要考虑十位拨号，现在在某些地区使用：这与长途拨号不同（即 303-555-1234，与 1-303-555-1234 相对）。在某些地方，有效的电话号码是十位数；在其他情况下，它是七。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-10-04T18:00:13.783

这是我使用的一个快速功能（如下）。我确实可以访问包含每月更新的区号和前缀数据的邮政编码数据库。我经常考虑进行数据查询以确认区号的前缀是否存在。

```
 public static bool isPhone(string phoneNum)
    {
        Regex rxPhone1, rxPhone2;

        rxPhone1 = new Regex(@"^\d{10,}$");
        rxPhone2 = new Regex(@"(\d)\1\1\1\1\1\1\1\1\1");

        if(phoneNum.Trim() == string.Empty)
            return false;

        if(phoneNum.Length != 10)
            return false;

        //Check to make sure the phone number has at least 10 digits
        if (!rxPhone1.IsMatch(phoneNum))
            return false;

        //Check for repeating characters (ex. 9999999999)
        if (rxPhone2.IsMatch(phoneNum))
            return false;

        //Make sure first digit is not 1 or zero
        if(phoneNum.Substring(0,1) == "1" || phoneNum.Substring(0,1) == "0")
            return false;

        return true;

    } 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-10-29T06:03:18.513

我不知道这是否是正确的地方，它是一个格式化功能而不是一个验证功能，我想让我们与社区分享它，也许有一天它会有所帮助..

```
Private Sub OnNumberChanged()
    Dim sep = "-"
    Dim num As String = Number.ToCharArray.Where(Function(c) Char.IsDigit(c)) _
                                                 .ToArray
    Dim ext As String = Nothing
    If num.Length > 10 Then ext = num.Substring(10)
    ext = If(IsNullOrEmpty(ext), "", " x" & ext)
    _Number = Left(num, 3) & sep & Mid(num, 4, 3) & sep & Mid(num, 7, 4) & ext
End Sub 
```

我的验证功能是这样的：

```
Public Shared Function ValidatePhoneNumber(ByVal number As String)
    Return number IsNot Nothing AndAlso number.ToCharArray. _
                                  Where(Function(c) Char.IsNumber(c)).Count >= 10
End Function 
```

我将这最后一个函数称为实体的 OnNumberChanging(number As String) 方法。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2010-11-12T20:36:27.803

对于美国和国际电话验证，我发现此代码最合适：

```
((\+[1-9]{1,4}[ \-]*)|(\([0-9]{2,3}\)[ \-]*)|([0-9]{2,4})[ \-]*)*?[0-9]{3,4}?[ \-]*[0-9]{3,4}?$ 
```

[你可以在这里](http://www.sitepoint.com/forums/showthread.php?t=304186)找到一个（尽管有些过时的）讨论。

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2008-10-06T18:17:36.113

这些参数对我来说看起来不错，为了安全起见，我也可能会避免以 911 开头的数字。

# c# - 如何从 .NET 以编程方式调用 SSIS？

> ID：175505
> 
> 赞同：4
> 
> 时间：2008-10-06T18:13:52.830
> 
> 标签：c#, .net, sql-server, ssis

我有一个应用程序，每当文件上传到目录时，我都必须调用 SSIS 来解析 XML 文件。

我可以直接从 .NET Windows 服务调用 SSIS 吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-06T18:16:27.677

[以编程方式运行 SSIS 包](http://blogs.msdn.com/michen/archive/2007/03/22/running-ssis-package-programmatically.aspx)。

我更喜欢第二种方法：

启动 DTEXEC.EXE 进程。DTEXEC 是用于执行 SSIS 包的命令行实用程序。在此处查看其命令行选项：http: [//msdn2.microsoft.com/en-us/library/ms162810.aspx](http://msdn2.microsoft.com/en-us/library/ms162810.aspx)

好处：在流程外运行包获得可靠性。可用于任何编程语言（包括 .NET 1.1 :)）。通过设置变量值轻松传递参数。

缺点：也仅限本地。更难获得有关包进度的信息（但 SSIS 日志记录可以为您提供大部分功能）。启动新进程的一些开销（与大包的执行时间相比可能最小）。

ASP.NET 特定：Win32 CreateProcess 函数忽略线程模拟。因此，如果您希望 DTEXEC 在不同于 ASP.NET 进程帐户的帐户下运行，您应该让用户输入名称/密码并将其传递给 Process.Start，或者使用以下 KB 中描述的方法在模拟帐户[http下运行子进程://support.microsoft.com/kb/889251](http://support.microsoft.com/kb/889251)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-14T09:56:45.920

您可以以编程方式运行您的 SSIS 包，如下所示：

```
using System;
using Microsoft.SqlServer.Dts.Runtime.Wrapper;

namespace ConsoleApplicationSSIS
{
    class Program
    {
        static void Main(string[] args)
        {
            Console.WriteLine("Loading SSIS Service...");
            //Application object allows load your SSIS package
            Application app = new Application();
            //In order to retrieve the status (success or failure) after running SSIS Package
            DTSExecResult result ;
            //Specify the location of SSIS package - dtsx file
            string SSISPackagePath = @"C:\Microsofts\BI\SSIS\ConsoleApplicationSSIS\IntegrationServiceScriptTask\Package.dtsx";
            //Load your package
            Package pckg = (Package)app.LoadPackage(SSISPackagePath,true,null);
            //Execute the package and retrieve result
            result  = pckg.Execute();
            //Print the status success or failure of your package
            Console.WriteLine("{0}", result.ToString());
            Console.ReadLine();
        }
    }
} 
```

如果您想要完整的示例，请访问：http://hassanboutougha.wordpress.com/2012/10/13/run-your-ssis-package-progammatically/

我解释了如何创建一个简单的 SSIS 包，以及如何从控制台应用程序以编程方式调用它。不要忘记让这个程序集 :C:\Program Files (x86)\Microsoft SQL Server\100\SDK\Assemblies\Microsoft.SQLServer.DTSRuntimeWrap.dll 引用运行时 ssis 命名空间

您还可以以编程方式传递变量并更改 ssis 包的源和目标连接

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-23T06:37:24.297

您可以从 Windows 服务调用 SSIS 包。但是 Microsoft.SqlServer.Dts 应该安装到要运行 windows 服务的系统中。如果您在该机器上安装了 DTS，则直接调用 SSIS 包。如果未安装，则应执行以下操作。

1.  创建 SSIS 包
2.  创建运行 SSIS 包的作业
3.  在您的 ADO.NET [驻留在 Windows 服务代码中]，调用运行作业的存储过程 [配置为运行 SSIS 包]。以下是应从您的 .NET 代码调用的示例。

> EXEC msdb.dbo.sp_start_job N'YourJobName'

希望这可以帮助！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-05-06T16:49:23.293

您可以使用 DTS 运行时以编程方式调用 SSIS、执行包并从 .NET 代码更改配置。[这是您如何做到这一点的完整代码](http://blogs.msdn.com/b/olivier_pieri/archive/2007/05/10/run-ssis-package-programatically.aspx)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-04-18T05:03:49.903

更新这个很老的问题：

在 SQL Server 2012 上，您只需创建将调用`create_execution`和`set_execution_parameter`

可在此处找到分步指南：[https ://blogs.msdn.microsoft.com/biblog/2013/05/07/step-by-step-of-executing-ssis-2012-package-through-stored -程序/](https://blogs.msdn.microsoft.com/biblog/2013/05/07/step-by-step-of-executing-ssis-2012-package-through-stored-procedure/)

[![在此处输入图像描述](https://i.stack.imgur.com/Gzuc9.png)](https://i.stack.imgur.com/Gzuc9.png)

# document-conversion - 如何预览文件？

> ID：175528
> 
> 赞同：6
> 
> 时间：2008-10-06T18:18:42.163
> 
> 标签：document-conversion

我在一个文件共享网站上工作，我需要一种方法来截取上传的文件。

该站点将支持多种文件格式，从纯文本到办公文档（doc、xls、ppt、...）、视频（mpeg、avi、...）、图像（jpg、gif、png...）PDF , 开放式办公室等

每个文档都需要对其进行“预览”，好处是客户希望以下格式具有预览：doc、xls、ppt 和 pdf。其他文件格式是可选的，如果我能找到获取它们的方法，它们将有预览。

此外，图像不是问题，因为我只需要在预览中包含一个缩略图。此外，我将使用 FFMPEG 将视频转换为 FLV，以便我也可以使用它来截取视频。

我正在考虑使用支持 Office 和 Open Office 格式的[JODconverter](http://www.artofsolving.com/opensource/jodconverter)，我不知道它是否可以转换为 JPG，但至少它可以转换为 PDF 格式。该站点是在一个专用 Debian 服务器上运行的 Drupal 5 下用 PHP 构建的，所以如果我选择 JOD，我会将它用作在同一台机器上的虚拟服务器中运行的 web 服务。

有人知道将文件转换为图像的更好的应用程序或方法吗？

任何帮助将不胜感激，在此先感谢！

哈维尔

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-10T13:42:25.530

Windows 缩略图查看器是一个实现[IExtractImage](http://msdn.microsoft.com/en-us/library/bb761848%28VS.85%29.aspx)的 COM 对象。开箱即用，它支持多种文件类型，应用程序可以添加自己的文件类型。通过依赖该界面，您更有可能获得对您今天甚至可能没有考虑过的其他文档类型的免费支持。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-07T21:47:49.583

我最终使用 JODConverter 将所有内容转换为 PDF，然后使用 SWFTools 从 PDF 转换为 SWF。我使用 Flash 创建了自己的文档查看器。

到目前为止，它运行得非常好。

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2008-10-06T18:35:31.087

要查看 PDF 文档，您可以使用 ITextSharp 库。链接在这里：

[http://itextsharp.sourceforge.net/](http://itextsharp.sourceforge.net/)

# java - 检索方法是否应该在无法产生返回值时返回“null”或抛出异常？

> ID：175532
> 
> 赞同：531
> 
> 时间：2008-10-06T18:19:27.547
> 
> 标签：java, exception, error-handling, null

我正在使用 java 语言，我有一个方法，如果找到它应该返回一个对象。

如果没有找到，我应该：

1.  返回空
2.  抛出异常
3.  其他

哪个是最佳实践或成语？

* * *

## 回答 #1

> 赞同：509
> 
> 时间：2008-10-06T18:21:50.410

如果您总是期望找到一个值，那么如果它丢失则抛出异常。异常意味着存在问题。

如果该值可能丢失或存在，并且两者都对应用程序逻辑有效，则返回 null。

更重要的是：你在代码的其他地方做了什么？一致性很重要。

* * *

## 回答 #2

> 赞同：104
> 
> 时间：2008-10-06T18:21:36.277

只有当它确实是错误时才抛出异常。如果对象的预期行为不存在，则返回 null。

否则，这是一个偏好问题。

* * *

## 回答 #3

> 赞同：77
> 
> 时间：2008-10-06T18:22:30.300

作为一般规则，如果该方法应该始终返回一个对象，那么就使用例外。如果您预计偶尔会出现 null 并希望以某种方式处理它，请使用 null。

无论你做什么，我强烈建议不要使用第三种选择：返回一个显示“WTF”的字符串。

* * *

## 回答 #4

> 赞同：52
> 
> 时间：2008-10-06T18:52:05.967

如果 null 从不表示错误，则只返回 null。

如果 null 始终是错误，则抛出异常。

如果 null 有时是异常，则编写两个例程。一个例程抛出异常，另一个是布尔测试例程，它在输出参数中返回对象，如果找不到对象，则例程返回 false。

很难滥用 Try 例程。很容易忘记检查空值。

因此，当 null 是错误时，您只需编写

```
object o = FindObject(); 
```

当 null 不是错误时，您可以编写类似的代码

```
if (TryFindObject(out object o)
  // Do something with o
else
  // o was not found 
```

* * *

## 回答 #5

> 赞同：27
> 
> 时间：2009-01-04T18:00:52.787

我只是想概括一下前面提到的选项，并添加一些新选项：

1.  返回空
2.  抛出异常
3.  使用空对象模式
4.  为您的方法提供一个布尔参数，因此调用者可以选择是否希望您抛出异常
5.  提供一个额外的参数，所以调用者可以设置一个值，如果没有找到值，他会返回

或者您可以结合这些选项：

提供几个重载版本的 getter，以便调用者可以决定走哪条路。在大多数情况下，只有第一个实现了搜索算法，其他的只是围绕第一个：

```
Object findObjectOrNull(String key);
Object findObjectOrThrow(String key) throws SomeException;
Object findObjectOrCreate(String key, SomeClass dataNeededToCreateNewObject);
Object findObjectOrDefault(String key, Object defaultReturnValue); 
```

即使您选择只提供一个实现，您也可能希望使用这样的命名约定来阐明您的合同，如果您决定添加其他实现，它也会对您有所帮助。

你不应该过度使用它，但它可能会有所帮助，尤其是在编写一个帮助类时，你将在数百个具有许多不同错误处理约定的不同应用程序中使用它。

* * *

## 回答 #6

> 赞同：19
> 
> 时间：2008-10-06T18:21:04.687

使用空对象模式或抛出异常。

* * *

## 回答 #7

> 赞同：15
> 
> 时间：2011-11-17T05:35:54.863

抛出异常的优点：

1.  **调用代码中的更清晰的控制流。** 检查 null 会注入一个由 try/catch 本地处理的条件分支。检查 null 并不表示您正在检查什么 - 您检查 null 是因为您正在寻找您期望的错误，还是检查 null 以便您不会在下行链上进一步传递?
2.  **消除“null”含义的歧义。** null 是代表错误还是 null 是实际存储在值中的内容？很难说当你只有一件事可以做出这种决定时。
3.  **改进了应用程序中方法行为之间的一致性。** 异常通常暴露在方法签名中，因此您更能够了解应用程序中的方法处理哪些边缘情况，以及您的应用程序可以以可预测的方式对哪些信息做出反应。

有关示例的更多解释，请参阅： http: [//metatations.com/2011/11/17/returning-null-vs-throwing-an-exception/](http://metatations.com/2011/11/17/returning-null-vs-throwing-an-exception/)

* * *

## 回答 #8

> 赞同：13
> 
> 时间：2008-10-06T18:20:53.503

与您使用的 API 保持一致。

* * *

## 回答 #9

> 赞同：13
> 
> 时间：2008-10-06T19:22:00.070

这取决于您的语言和代码是否提倡：LBYL（在您跳跃之前查看）或 EAFP（更容易请求宽恕而不是许可）

LBYL 说你应该检查值（所以返回 null）
EAFP 说只是尝试操作，看看它是否失败（抛出异常）

尽管我同意上述观点。异常应该用于异常/错误条件，并且在使用检查时最好返回 null。

* * *

EAFP 与 Python 中的 LBYL：http://mail.python.org/pipermail/python-list/2003-May/205182.html
[（](http://mail.python.org/pipermail/python-list/2003-May/205182.html) 网络[存档](https://web.archive.org/web/20090112210106/http://mail.python.org/pipermail/python-list/2003-May/205182.html)）

* * *

## 回答 #10

> 赞同：13
> 
> 时间：2008-10-06T22:16:57.550

问问自己：“找不到对象是例外情况吗”？如果预计它会在您的程序的正常过程中发生，您可能不应该引发异常（因为它不是异常行为）。

简短版本：使用异常来处理异常行为，而不是处理程序中的正常控制流。

-艾伦。

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2008-10-06T23:37:56.747

例外情况与按合同设计有关。

对象的接口实际上是两个对象之间的契约，调用者必须满足契约，否则接收者可能会因异常而失败。有两种可能的合同

1）所有输入的方法都是有效的，这种情况下找不到对象时必须返回null。

2) 只有一些输入是有效的，即导致找到对象的输入。在这种情况下，您必须提供第二种方法，允许调用者确定其输入是否正确。例如

```
is_present(key)
find(key) throws Exception 
```

IF且仅当您提供第二份合同的两种方法时，您才可以抛出异常，即什么都没有！

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2008-10-06T18:22:42.657

取决于找不到对象的含义。

如果是正常状态，则返回 null。这只是偶尔会发生的事情，调用者应该检查它。

如果是错误，则抛出异常，调用者应决定如何处理丢失对象的错误情况。

最终，两者都行得通，尽管大多数人通常认为仅在发生某些事情时才使用异常是一种好习惯，嗯，异常发生了。

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2008-10-07T00:07:22.977

这里还有一些建议。

如果返回一个集合，避免返回 null，返回一个空集合，这使得枚举更容易处理，而无需先进行 null 检查。

一些 .NET API 使用 throwedOnError 参数的模式，如果找不到对象，调用者可以选择是否真的是异常情况。Type.GetType 就是一个例子。BCL 的另一个常见模式是 TryGet 模式，其中返回一个布尔值并通过输出参数传递值。

在某些情况下，您还可以考虑 Null Object 模式，它可以是默认值，也可以是没有行为的版本。关键是避免在整个代码库中进行空检查。有关更多信息，请参见此处[http://geekswithblogs.net/dsellers/archive/2006/09/08/90656.aspx](http://geekswithblogs.net/dsellers/archive/2006/09/08/90656.aspx)

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2008-10-06T18:20:32.160

我更喜欢只返回一个空值，并依靠调用者来适当地处理它。（因为没有更好的词）例外是如果我绝对“确定”这个方法将返回一个对象。在这种情况下，失败是一个异常应该并且应该抛出的异常。

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2008-10-06T18:28:38.680

返回 null 而不是抛出异常，并在 API 文档中清楚地记录 null 返回值的可能性。如果调用代码不遵守 API 并检查 null 情况，它很可能会导致某种“空指针异常”：）

在 C++ 中，我可以想到 3 种不同风格的设置查找对象的方法。

**选项 A**

```
Object *findObject(Key &key); 
```

找不到对象时返回 null。很好很简单。我会和这个一起去。下面的替代方法适用于不讨厌超出参数的人。

**选项 B**

```
void findObject(Key &key, Object &found); 
```

传入对将接收对象的变量的引用。当找不到对象时，该方法引发异常。如果不是真的期望找不到对象，则此约定可能更合适-因此您抛出异常以表示这是意外情况。

**选项 C**

```
bool findObject(Key &key, Object &found); 
```

当找不到对象时，该方法返回 false。与选项 A 相比，此选项的优点是您可以通过一个清晰的步骤检查错误情况：

```
if (!findObject(myKey, myObj)) { ... 
```

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2008-10-06T20:00:19.730

在某些函数中，我添加了一个参数：

```
..., bool verify = true) 
```

true 表示抛出，false 表示返回一些错误返回值。这样，无论谁使用此功能，都有两种选择。默认值应该是 true，以便那些忘记错误处理的人受益。

* * *

## 回答 #17

> 赞同：3
> 
> 时间：2010-12-22T16:25:45.543

仅指 null 不被视为异常行为的情况，我绝对是 try 方法，很明显，不需要像这里所说的“阅读本书”或“在你跳跃之前看看”

所以基本上：

```
bool TryFindObject(RequestParam request, out ResponseParam response) 
```

这意味着用户的代码也将是清晰的

```
...
if(TryFindObject(request, out response)
{
  handleSuccess(response)
}
else
{
  handleFailure()
}
... 
```

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2008-10-06T18:21:21.347

如果客户端代码知道找到和未找到之间的区别很重要，并且这应该是一种常规行为，那么最好返回 null。然后客户端代码可以决定要做什么。

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2008-10-06T18:21:25.060

通常它应该返回null。调用该方法的代码应该决定是抛出异常还是尝试其他方法。

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2008-10-06T19:04:45.147

或返回一个选项

一个选项基本上是一个容器类，它强制客户处理展位案例。Scala有这个概念，查看它的API。

然后，您在此对象上有 T getOrElse(T valueIfNull) 之类的方法，它们要么返回找到的对象，要么返回客户端指定的替代方案。

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2011-02-23T06:02:23.633

更喜欢返回 null --

如果调用者在没有检查的情况下使用它，那么无论如何都会发生异常。

如果调用者并没有真正使用它，请不要向他征税`try`/`catch`块

* * *

## 回答 #22

> 赞同：2
> 
> 时间：2011-08-03T00:32:52.190

不幸的是，JDK 不一致，如果您尝试访问资源包中不存在的键，则会找不到异常，并且当您从 map 请求值时，如果它不存在，则会得到 null。因此，我会将获胜者的答案更改为以下内容，如果找到的值可以为 null，则在未找到时引发异常，否则返回 null。因此，除了一个例外，请遵循规则，如果您需要知道为什么找不到值，那么总是引发异常，或者..

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2008-10-06T18:23:26.227

只要它应该返回对对象的*引用*，返回 NULL 应该是好的。

但是，如果它返回整个该死的东西（就像在 C++ 中，如果你这样做：'return blah;' 而不是 'return &blah;' （或 'blah' 是一个指针），那么你不能返回一个 NULL，因为它是不是“对象”类型。在这种情况下，抛出异常或返回没有设置成功标志的空白对象是我解决问题的方法。

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2008-10-06T18:29:42.407

不要认为有人提到异常处理中的开销 - 需要额外的资源来加载和处理异常，所以除非它是一个真正的应用程序终止或进程停止事件（前进会弊大于利）我会选择传回value 调用环境可以按照它认为合适的方式解释。

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2008-10-06T18:36:04.890

我同意这里似乎达成的共识（如果“未找到”是正常的可能结果，则返回 null，或者如果情况的语义要求始终找到对象，则抛出异常）。

但是，根据您的具体情况，第三种可能性可能是有意义的。您的方法可以在“未找到”条件下返回某种默认对象，从而确保调用代码始终接收有效对象，而无需进行空值检查或异常捕获。

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2008-10-06T19:09:04.933

返回一个空值，异常就是这样：你的代码做的事情不是预期的。

* * *

## 回答 #27

> 赞同：1
> 
> 时间：2008-10-06T22:26:07.250

例外应该是**例外**。如果返回 null**有效，则返回 null**。

* * *

## 回答 #28

> 赞同：1
> 
> 时间：2012-08-21T13:13:22.377

如果该方法返回一个集合，则返回一个空集合（如上所述）。但请不要 Collections.EMPTY_LIST 之类的！（在 Java 的情况下）

如果该方法检索单个对象，那么您有一些选择。

1.  如果方法应该总是找到结果并且找不到对象是一个真正的异常情况，那么你应该抛出一个异常（在Java中：请一个未经检查的异常）
2.  （仅限 Java）如果您可以容忍该方法抛出已检查异常，则抛出项目特定的 ObjectNotFoundException 等。在这种情况下，如果您忘记处理异常，编译器会告诉您。（这是我对 Java 中未找到的东西的首选处理方式。）
3.  如果你说真的没问题，如果没有找到对象，并且你的方法名称类似于 findBookForAuthorOrReturnNull(..)，那么你可以返回 null。在这种情况下，*强烈*建议使用某种静态检查或编译器检查，以防止在没有空检查的情况下取消引用结果。在Java的情况下，它可以是例如。FindBugs（参见[http://findbugs.sourceforge.net/manual/annotations.html](http://findbugs.sourceforge.net/manual/annotations.html)上的 DefaultAnnotation ）或 IntelliJ-Checking。

如果您决定返回空值，请小心。如果您不是项目中唯一的程序员，您将在运行时获得 NullPointerExceptions（在 Java 或其他语言中）！所以不要返回在编译时未检查的空值。

* * *

## 回答 #29

> 赞同：1
> 
> 时间：2014-10-22T12:27:19.677

如果您正在使用引发异常的库或其他类，则应重新引发**异常**。这是一个例子。Example2.java 就像库，而 Example.java 使用它的对象。Main.java 是处理此异常的示例。您应该向调用方的用户显示有意义的消息和（如果需要）堆栈跟踪。

**主.java**

```
public class Main {
public static void main(String[] args) {
    Example example = new Example();

    try {
        Example2 obj = example.doExample();

        if(obj == null){
            System.out.println("Hey object is null!");
        }
    } catch (Exception e) {
        System.out.println("Congratulations, you caught the exception!");
        System.out.println("Here is stack trace:");
        e.printStackTrace();
    }
}
} 
```

**Example.java**

```
/**
 * Example.java
 * @author Seval
 * @date 10/22/2014
 */
public class Example {
    /**
     * Returns Example2 object
     * If there is no Example2 object, throws exception
     * 
     * @return obj Example2
     * @throws Exception
     */
    public Example2 doExample() throws Exception {
        try {
            // Get the object
            Example2 obj = new Example2();

            return obj;

        } catch (Exception e) {
            // Log the exception and rethrow
            // Log.logException(e);
            throw e;
        }

    }
} 
```

**Example2.java**

```
 /**
 * Example2.java
 * @author Seval
 *
 */
public class Example2 {
    /**
     * Constructor of Example2
     * @throws Exception
     */
    public Example2() throws Exception{
        throw new Exception("Please set the \"obj\"");
    }

} 
```

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2008-10-06T18:21:33.657

这实际上取决于您是否希望找到该对象。如果您遵循应该使用异常来指示某事的思想流派，那么，错误，异常已经发生：

*   找到对象；返回对象
*   未找到对象；抛出异常

否则，返回空值。

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2008-10-06T18:22:48.803

这取决于方法的性质以及如何使用它。如果可能找不到对象是正常行为，则返回 null。如果总是找到对象是正常行为，则抛出异常。

根据经验，仅在发生异常时才使用*异常*。不要以这样一种方式编写代码，即异常抛出和捕获是其正常操作的一部分。

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2008-10-06T18:23:31.250

如果没有发现是异常事件（即正常情况下应该存在），则抛出。否则，返回一个“未找到”值（可以为 null，但不是必须），或者甚至让该方法返回一个布尔值表示 found/notfound 和一个实际对象的 out 参数。

* * *

## 回答 #33

> 赞同：0
> 
> 时间：2008-10-06T18:23:31.483

这取决于你的方法。如果你的方法应该总是返回一个有效的对象并且没有找到，那么抛出异常是要走的路。如果该方法只是为了返回一个可能存在或不存在的对象（例如联系人上的图像），则不应引发错误。

如果此方法实际上将返回一个对象，您可能还希望公开一个返回布尔值 true/false 的方法，因此您不必 a) 检查 null 或 b) 捕获异常

* * *

## 回答 #34

> 赞同：0
> 
> 时间：2008-10-06T18:25:20.170

“其他”选项可以是让 find 方法采用一个带有默认对象的附加参数，如果找不到所寻找的对象，该参数将被返回。

否则，我只会返回 null ，除非在找不到对象时确实是例外情况。

* * *

## 回答 #35

> 赞同：0
> 
> 时间：2008-10-06T18:42:29.293

在数据层代码中，我有时会使用以下代码，让调用者决定“找不到对象”是否意味着发生了错误。

```
 DataType GetObject(DBConnection conn, string id, bool throwOnNotFound) {
    DataType retval = ... // find object in database
    if (retval != null || ! throwOnNotFound) {
        return retval;
    } else {
        throw new NoRowsFoundException("DataType object with id {id} not found in database");
    }
}

DataType GetObject(DBConnection conn, string id) {
    return GetObject(conn, id, true);
} 
```

* * *

## 回答 #36

> 赞同：0
> 
> 时间：2008-10-06T20:07:38.217

它不包含对象可能发生在正常操作期间，应由调用者处理返回NULL。

如果不包含该对象表明调用代码或内部状态存在错误，则执行断言。

如果不包含该对象，则表示偶发事件。（就像有人在您同时签出商品时从商店中删除了商品一样。）然后抛出异常。

# python - 编写优化函数

> ID：175544
> 
> 赞同：3
> 
> 时间：2008-10-06T18:21:53.983
> 
> 标签：python, algorithm

我正在尝试编写一个网球预订系统，但我遇到了这个问题。假设您有球员偏好球场编号、日期和时间。此外，每个玩家都有排名，因此如果有日/小时时段并且有几个玩家对此时段有偏好，则应选择具有最高优先级的玩家。我正在考虑使用一些优化算法来解决这个问题，但我不确定什么是最好的成本函数和/或算法。有什么建议吗？我更喜欢使用 Python 的另一件事，但也欢迎一些与语言无关的建议。谢谢！

编辑：

一些澄清-

优先级更高的获胜者和失败者被移动到最近的时间段，相当灵活的时间段问题是，最大限度地增加人数获得他们最喜欢的时间

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-07T12:17:48.867

## 基本算法

我会按排名对玩家进行排序，因为排名高的总是会推开排名低的。然后你从排名最高的玩家开始，给他他要求的东西（如果他真的是最高的，他总是会赢，所以你也可以给他任何他要求的东西）。然后我会从第二高的开始。如果他要求的东西已经被最高者占用，请尝试在附近找到一个插槽并将这个插槽分配给他。现在是第三高的。如果他要求的东西已经被最高的人拿走了，把他移到附近的一个位置。如果这个位置已经被第二高的人占据了，把他移到更远的位置。继续与所有其他玩家。

### 需要考虑的一些调整：

如果多个玩家可以拥有相同的排名，您可能需要实施一些“公平”。如果您对他们进行排序，例如使用 QuickSort，所有具有相同等级的玩家将有一个随机顺序。如果您不是针对玩家进行，而是针对等级进行排名，您可以获得一些公平性。您从最高级别和该级别的第一个玩家开始。处理他的第一个请求。但是，在处理他的第二个请求之前，先处理下一个排名最高的玩家的第一个请求，然后处理第三个排名最高的玩家的第一个请求。算法同上，但是假设你有 10 个玩家，玩家 1-4 排名最高，玩家 5-7 排名低，玩家 8-10 非常低，每个玩家发出 3 个请求，你将它们处理为

```
Player 1 - Request 1
Player 2 - Request 1
Player 3 - Request 1
Player 4 - Request 1
Player 1 - Request 2
Player 2 - Request 2
: 
```

这样你就有了一些公平性。您也可以每次在一个排名类别中随机选择，这也可以提供一些公平性。

您甚至可以跨等级实现公平。例如，如果你有 4 个等级，你可以说

```
Rank 1 - 50%
Rank 2 - 25%
Rank 3 - 12,5%
Rank 4 - 6,25% 
```

（只是示例值，您可以使用与始终乘以 0.5 不同的键，例如乘以 0.8，导致数字减少得更慢）

现在您可以说，您从 Rank 1 开始处理，但是一旦所有 Rank 1 请求的 50% 得到满足，您就进入 Rank 2 并确保 25% 的请求得到满足，依此类推。这样，即使是 Rank 4 用户也可以赢得 Rank 1 用户，这在某种程度上击败了初始算法，但是您提供了一些公平性。即使是四阶玩家有时也能得到他的要求，他不会“干涸”。否则 Rank 1 玩家与 Rank 4 玩家同时安排每个请求将确保 Rank 4 玩家没有机会获得单个请求。这样他至少有很小的机会得到一个。

在确保每个人都处理了他们的最低百分比之后（等级越高，这个越多），您回到顶部，再次从 Rank 1 开始并处理他们的其余请求，然后是 Rank 2 的其余请求等等。

**最后但并非最不重要的一点：**您可能想要定义最大槽偏移量。如果一个插槽被占用，应用程序应该搜索最近的仍然空闲的插槽。但是，如果这个最近的插槽很远怎么办？如果我在星期一下午 4 点申请一个时段，而应用程序发现下一个空闲时段是星期三上午 9 点，那对我来说并没有什么帮助，是吗？星期三我可能根本没有时间。因此，您可以将插槽搜索限制在同一天，并说该插槽最多可以休息 3 小时。如果在该范围内没有找到槽，则取消请求。在这种情况下，您需要通知玩家“很抱歉，我们无法为您找到附近的老虎机；请在其他日期/时间申请一个老虎机，我们会看看是否能找到适合您的老虎机”。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-06T18:29:26.213

我认为这是一个 NP 完全问题，因此对于任何大型数据集都不可能有一个非常快速的算法。

还有一个问题是你可能有一个不可能制定的时间表。鉴于情况并非如此，这样的伪代码可能是您最好的选择：

```
sort players by priority, highest to lowest
start with empty schedule
for player in players:
    for timeslot in player.preferences():
        if timeslot is free:
            schedule.fillslot(timeslot, player)
            break
    else:
        #if we get here, it means this player couldn't be accomodated at all.
        #you'll have to go through the slots that were filled and move another (higher-priority) player's time slot 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-06T19:00:09.880

您正在描述一个匹配问题。可能的参考资料是[Kleinberg 和 Tardos](https://rads.stackoverflow.com/amzn/click/com/0321295358)[的 Stony Brook 算法库](http://www.cs.sunysb.edu/~algorith/files/matching.shtml)和算法设计。如果玩家的数量等于球场的数量，你可以达到一个稳定的匹配——[稳定的婚姻问题](http://en.wikipedia.org/wiki/Stable_marriage_problem)。其他配方变得更难。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-06T19:34:44.617

I would advise using a scoring algorithm. Basically construct a formula that pulls all the values you described into a single number. Who ever has the highest final score wins that slot. For example a simple formula might be:

```
FinalScore = ( PlayerRanking * N1 ) + ( PlayerPreference * N2 ) 
```

Where N1, N2 are weights to control the formula.

This will allow you to get good (not perfect) results very quickly. We use this approach on a much more complex system with very good results.

You can add more variety to this by adding in factors for how many times the player has won or lost slots, or (as someone suggested) how much the player paid.

Also, you can use multiple passes to assign slots in the day. Use one strategy where it goes chronologically, one reverse chronologically, one that does the morning first, one that does the afternoon first, etc. Then sum the scores of the players that got the spots, and then you can decide strategy provided the best results.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-06T18:35:00.573

在回答这个问题之前，我会问几个问题：

*   如果发生冲突会发生什么，即先让一个更差的球员预定，然后一个更好的球员预定同一个球场？谁赢？失败者会发生什么？
*   只要比赛进行，你是让最好的球员上场，还是有固定的时间段？
*   调度运行的频率 - 它是否以交互方式运行 - 所以可能有人会被告知他们可以玩，只是被告知他们不能；还是以更批量的方式运行-您提出请求，然后稍后告知您是否可以拥有自己的位置。或者用户是否*设置了多个首选时间，然后系统必须最大化获得他们最喜欢的时间的人数？*

顺便说一句，您可以通过将时间重写为整数索引来稍微简化它（因此您处理的是整数而不是时间）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-06T20:00:10.027

基本上，你的优势是玩家有优先权；因此，您按优先级降序对玩家进行排序，然后开始为他们分配插槽。第一个获得他们喜欢的位置，然后下一个在免费的位置中获得他的首选，依此类推。这是一个 O(N) 算法。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-01-04T14:52:36.070

我认为你应该使用遗传算法，因为：

*   它最适合大型问题实例。
*   它以不准确的答案为代价降低了时间复杂度（不是最终最好的）
*   您可以通过调整未满足的健身惩罚来轻松指定约束和偏好。
*   您可以指定程序执行的时间限制。
*   解决方案的质量取决于您打算花多少时间解决程序。

    [遗传算法定义](http://en.wikipedia.org/wiki/Genetic_algorithm)

    [遗传算法教程](http://www.ai-junkie.com/ga/intro/gat1.html)

    [带有 GA 的课程安排项目](http://www.codeproject.com/KB/recipes/GaClassSchedule.aspx)

也看看：[一个类似的问题](https://stackoverflow.com/questions/2746309/best-fit-scheduling-algorithm/2749869#2749869)和[另一个](https://stackoverflow.com/questions/573670/which-algorithm-for-assigning-shifts-discrete-optimization-problem/4594818#4594818)

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2008-10-06T18:53:38.817

钱。根据谁支付最多来分配时间段。在平局的情况下，不要让他们中的任何一个拥有插槽。

# hibernate - 修复 Hibernate 错误“两次使用相同的实体名称”

> ID：175547
> 
> 赞同：14
> 
> 时间：2008-10-06T18:22:17.417
> 
> 标签：hibernate, jpa

如何修复以下 Hibernate 错误：

“两次使用相同的实体名称”是什么意思。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2014-04-28T08:57:06.407

当您有多个具有相同类名称或显式名称的 @Entity 时，会发生此异常。要解决此问题，您必须为每个实体设置不同的显式名称。

错误案例示例：

```
package A;

@Entity
class Cell{
 ...   
}

package B;

@Entity
class Cell{
 ...   
} 
```

解决方案示例：包A；

```
@Entity(name="a.Cell")
class Cell{
 ...   
}

package B;

@Entity(name="b.Cell")
class Cell{
 ...   
} 
```

因此，要在 HQL 中使用它们，您必须编写

```
...createQuery("from a.Cell")... 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-23T13:47:20.063

我遇到过这个错误几次。原因如下：

1.  我的休眠配置中有重复的映射（检查配置文件/代码）
2.  两个线程同时尝试构建 HibernateSessionFactory 对象。初始化代码上的同步锁定解决了这个问题。
3.  构建 HibernateSessionFactory 的尝试失败，但正在再次调用。Hibernate Configuration 对象没有被清除，因此正在再次处理实体。
4.  您有两个实体类被映射到同一个文件。Hibernate 也会对此感到窒息。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-01-13T10:17:16.747

另一个常见错误是您最近移动了一个持久性类（从一个包到另一个包），但您的 IDE 未能正确清理您的 .class 文件。

或者一些 .class 文件仍在您的应用程序服务器中。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-07-28T06:11:30.250

我最近有这个错误（重复导入）：两个具有相同名称“MyEntity”但来自不同包/模块的实体：com.test1.MyEntity com.test2.MyEntity

我没有使用它们，但它们是由休眠加载到 jboss 的。我不允许更改实体，所以我不得不做一些解决方法。

1.  添加`<property name="hibernate.auto-import" value="false"/>`到persistance.xml。它防止在部署到 jboss 时抛出重复的异常。但是当我的查询被调用时抛出了异常。
2.  使用 JPQL 查询。就我而言，它看起来像： `entityManager.createQuery("Select a.Name, b.name from AEntity a, BEntity b where a.ID = b.parentID")`

这很丑陋，但它是一种解决方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-06T18:31:46.523

我认为这意味着您在多个配置文件中声明了相同的实体。

如果没有更多信息，我会尝试注释掉您的配置文件的块，这样您就不会看到错误，然后慢慢添加部分，直到遇到错误？

如果它只有几个配置文件，那为什么不在这里发布呢？发布时，如果您在 XML 的前面添加 4 个空格，那么它将是：

```
<xml>nicely formatted</xml> 
```

希望这可以帮助。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-21T01:40:37.923

产生此错误的最常见错误之一是尝试在同名表中保留两个不同的 Java 类。Hibernate 喜欢在每个表中恰好存在一种东西（子类等有一些例外），所以如果你要创建一个名为 StudentRecord 的类和一个名为 MusicRecords 的类，然后你告诉 Hibernate 将两者都持久化将这些类放入一个名为“记录”的表中，您可能会产生这种异常。使用这种特定的措辞，我怀疑您正在使用注释（在这种情况下，更容易意外地命名两个表，在两个不同的 Java 类中描述，相同的东西）。

希望这可以帮助！（虽然也许不是，因为我刚才注意到您在 7 个月前问过这个问题。我希望您还没有被困住，先生！）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-10-21T09:11:10.603

I had this issue because stuff that I had stashed was still being referenced, somehow (moved my entity from one package to another and both were being referenced). Re tarting my IDE, changing branches (which did not have these changes), etc, didn't work for me. I just ended up re-cloning the repo and the error went away.

# date - 如何将毫秒转换为人类可读的形式？

> ID：175554
> 
> 赞同：122
> 
> 时间：2008-10-06T18:23:25.463
> 
> 标签：date, time, string-formatting, datetime-format

我需要将任意数量的毫秒转换为天、小时、分秒。

例如：10 天、5 小时、13 分钟、1 秒。

* * *

## 回答 #1

> 赞同：230
> 
> 时间：2008-10-06T18:28:43.877

好吧，既然没有其他人加紧，我将编写简单的代码来做到这一点：

```
x = ms / 1000
seconds = x % 60
x /= 60
minutes = x % 60
x /= 60
hours = x % 24
x /= 24
days = x 
```

我很高兴你几天都停下来，几个月都没有问。:)

注意，在上面，假设`/`表示截断整数除法。`/`如果您在表示浮点除法的语言中使用此代码，则需要根据需要手动截断除法的结果。

* * *

## 回答 #2

> 赞同：60
> 
> 时间：2008-10-06T18:28:42.877

令 A 为毫秒数。然后你有：

```
seconds=(A/1000)%60
minutes=(A/(1000*60))%60
hours=(A/(1000*60*60))%24 
```

依此类推（`%`是模运算符）。

希望这可以帮助。

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2012-09-14T08:29:25.300

以下两种解决方案都使用**javascript**（我不知道该解决方案与语言无关！）。如果捕获持续时间，这两种解决方案都需要扩展`> 1 month`。

### 解决方案 1：使用 Date 对象

```
var date = new Date(536643021);
var str = '';
str += date.getUTCDate()-1 + " days, ";
str += date.getUTCHours() + " hours, ";
str += date.getUTCMinutes() + " minutes, ";
str += date.getUTCSeconds() + " seconds, ";
str += date.getUTCMilliseconds() + " millis";
console.log(str); 
```

给出：

```
"6 days, 5 hours, 4 minutes, 3 seconds, 21 millis" 
```

库是有帮助的，但是当您可以重新发明轮子时，为什么还要使用库！:)

### 解决方案 2：编写自己的解析器

```
var getDuration = function(millis){
    var dur = {};
    var units = [
        {label:"millis",    mod:1000},
        {label:"seconds",   mod:60},
        {label:"minutes",   mod:60},
        {label:"hours",     mod:24},
        {label:"days",      mod:31}
    ];
    // calculate the individual unit values...
    units.forEach(function(u){
        millis = (millis - (dur[u.label] = (millis % u.mod))) / u.mod;
    });
    // convert object to a string representation...
    var nonZero = function(u){ return dur[u.label]; };
    dur.toString = function(){
        return units
            .reverse()
            .filter(nonZero)
            .map(function(u){
                return dur[u.label] + " " + (dur[u.label]==1?u.label.slice(0,-1):u.label);
            })
            .join(', ');
    };
    return dur;
}; 
```

使用您需要的任何字段创建一个“持续时间”对象。格式化时间戳然后变得简单......

```
console.log(getDuration(536643021).toString()); 
```

给出：

```
"6 days, 5 hours, 4 minutes, 3 seconds, 21 millis" 
```

* * *

## 回答 #4

> 赞同：23
> 
> 时间：2011-11-09T18:08:44.310

[Apache Commons Lang](http://commons.apache.org/lang)有一个[DurationFormatUtils](http://commons.apache.org/proper/commons-lang/javadocs/api-3.1/index.html?org/apache/commons/lang3/time/DurationFormatUtils.html)，它具有非常有用的方法，例如[formatDurationWords](http://commons.apache.org/proper/commons-lang/javadocs/api-3.1/org/apache/commons/lang3/time/DurationFormatUtils.html#formatDurationWords%28long,%20boolean,%20boolean%29)。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2008-10-06T18:29:35.310

您应该使用您正在使用的任何语言的日期时间函数，但是，只是为了好玩，这里是代码：

```
int milliseconds = someNumber;

int seconds = milliseconds / 1000;

int minutes = seconds / 60;

seconds %= 60;

int hours = minutes / 60;

minutes %= 60;

int days = hours / 24;

hours %= 24; 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2012-01-09T21:33:09.927

这是我写的一个方法。它需要一个`integer milliseconds value`并返回一个`human-readable String`：

```
public String convertMS(int ms) {
    int seconds = (int) ((ms / 1000) % 60);
    int minutes = (int) (((ms / 1000) / 60) % 60);
    int hours = (int) ((((ms / 1000) / 60) / 60) % 24);

    String sec, min, hrs;
    if(seconds<10)  sec="0"+seconds;
    else            sec= ""+seconds;
    if(minutes<10)  min="0"+minutes;
    else            min= ""+minutes;
    if(hours<10)    hrs="0"+hours;
    else            hrs= ""+hours;

    if(hours == 0)  return min+":"+sec;
    else    return hrs+":"+min+":"+sec;

} 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2012-10-31T05:39:41.647

```
function convertTime(time) {        
    var millis= time % 1000;
    time = parseInt(time/1000);
    var seconds = time % 60;
    time = parseInt(time/60);
    var minutes = time % 60;
    time = parseInt(time/60);
    var hours = time % 24;
    var out = "";
    if(hours && hours > 0) out += hours + " " + ((hours == 1)?"hr":"hrs") + " ";
    if(minutes && minutes > 0) out += minutes + " " + ((minutes == 1)?"min":"mins") + " ";
    if(seconds && seconds > 0) out += seconds + " " + ((seconds == 1)?"sec":"secs") + " ";
    if(millis&& millis> 0) out += millis+ " " + ((millis== 1)?"msec":"msecs") + " ";
    return out.trim();
} 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2016-08-13T16:52:08.553

在java中

```
public static String formatMs(long millis) {
    long hours = TimeUnit.MILLISECONDS.toHours(millis);
    long mins = TimeUnit.MILLISECONDS.toMinutes(millis);
    long secs = TimeUnit.MILLISECONDS.toSeconds(millis);
    return String.format("%dh %d min, %d sec",
            hours,
            mins - TimeUnit.HOURS.toMinutes(hours),
            secs - TimeUnit.MINUTES.toSeconds(mins)
    );
} 
```

给出这样的东西：

```
12h 1 min, 34 sec 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-10-06T18:25:37.503

我建议使用您选择的语言/框架提供的任何日期/时间函数/库。还要查看字符串格式化函数，因为它们通常提供简单的方法来传递日期/时间戳并输出人类可读的字符串格式。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-10-06T18:29:13.627

您的选择很简单：

1.  编写代码进行转换（即，除以milliSecondsPerDay 得到天数，使用模数除以milliSecondsPerHour 得到小时数，使用模数除以milliSecondsPerMinute 并除以1000 得到秒数。milliSecondsPerMinute = 60000, milliSecondsPerHour = 60 * milliSecondsPerMinute，milliSecondsPerDay = 24 * milliSecondsPerHour。
2.  使用某种操作程序。UNIX 和 Windows 都具有可以从 Ticks 或 seconds 类型值中获取的结构。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2010-10-15T15:23:51.043

```
Long serverUptimeSeconds = 
    (System.currentTimeMillis() - SINCE_TIME_IN_MILLISECONDS) / 1000;

String serverUptimeText = 
String.format("%d days %d hours %d minutes %d seconds",
serverUptimeSeconds / 86400,
( serverUptimeSeconds % 86400) / 3600 ,
((serverUptimeSeconds % 86400) % 3600 ) / 60,
((serverUptimeSeconds % 86400) % 3600 ) % 60
); 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2013-06-27T20:35:00.027

```
Long expireTime = 69l;
Long tempParam = 0l;

Long seconds = math.mod(expireTime, 60);
tempParam = expireTime - seconds;
expireTime = tempParam/60;
Long minutes = math.mod(expireTime, 60);
tempParam = expireTime - minutes;
expireTime = expireTime/60;
Long hours = math.mod(expireTime, 24);
tempParam = expireTime - hours;
expireTime = expireTime/24;
Long days = math.mod(expireTime, 30);

system.debug(days + '.' + hours + ':' + minutes + ':' + seconds); 
```

这应该打印：0.0:1:9

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2015-01-21T10:47:50.097

为什么不做这样的事情：

无功毫秒 = 86400;

var 秒 = 毫秒 / 1000；//86.4

var 分钟 = 秒 / 60；//1.4400000000000002

var 小时 = 分钟 / 60；//0.024000000000000004

var 天 = 小时 / 24；//0.0010000000000000002

并处理浮点精度，例如 Number(minutes.toFixed(5)) //1.44

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2012-11-14T10:24:43.350

我无法评论您的问题的第一个答案，但有一个小错误。您应该使用 parseInt 或 Math.floor 将浮点数转换为整数，我

```
var days, hours, minutes, seconds, x;
x = ms / 1000;
seconds = Math.floor(x % 60);
x /= 60;
minutes = Math.floor(x % 60);
x /= 60;
hours = Math.floor(x % 24);
x /= 24;
days = Math.floor(x); 
```

就个人而言，我在我的项目中使用 CoffeeScript，我的代码如下所示：

```
getFormattedTime : (ms)->
        x = ms / 1000
        seconds = Math.floor x % 60
        x /= 60
        minutes = Math.floor x % 60
        x /= 60
        hours = Math.floor x % 24
        x /= 24
        days = Math.floor x
        formattedTime = "#{seconds}s"
        if minutes then formattedTime = "#{minutes}m " + formattedTime
        if hours then formattedTime = "#{hours}h " + formattedTime
        formattedTime 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2013-05-23T13:43:31.323

这是一个解决方案。稍后您可以按“：”拆分并获取数组的值

```
/**
 * Converts milliseconds to human readeable language separated by ":"
 * Example: 190980000 --> 2:05:3 --> 2days 5hours 3min
 */
function dhm(t){
    var cd = 24 * 60 * 60 * 1000,
        ch = 60 * 60 * 1000,
        d = Math.floor(t / cd),
        h = '0' + Math.floor( (t - d * cd) / ch),
        m = '0' + Math.round( (t - d * cd - h * ch) / 60000);
    return [d, h.substr(-2), m.substr(-2)].join(':');
}

var delay = 190980000;                   
var fullTime = dhm(delay);
console.log(fullTime); 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2014-07-04T14:20:29.950

这是我使用 TimeUnit 的解决方案。

更新：我应该指出这是用 groovy 编写的，但 Java 几乎是相同的。

```
def remainingStr = ""

/* Days */
int days = MILLISECONDS.toDays(remainingTime) as int
remainingStr += (days == 1) ? '1 Day : ' : "${days} Days : "
remainingTime -= DAYS.toMillis(days)

/* Hours */
int hours = MILLISECONDS.toHours(remainingTime) as int
remainingStr += (hours == 1) ? '1 Hour : ' : "${hours} Hours : "
remainingTime -= HOURS.toMillis(hours)

/* Minutes */
int minutes = MILLISECONDS.toMinutes(remainingTime) as int
remainingStr += (minutes == 1) ? '1 Minute : ' : "${minutes} Minutes : "
remainingTime -= MINUTES.toMillis(minutes)

/* Seconds */
int seconds = MILLISECONDS.toSeconds(remainingTime) as int
remainingStr += (seconds == 1) ? '1 Second' : "${seconds} Seconds" 
```

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2015-01-17T20:43:33.143

一种灵活的方法：（
不适用于当前日期，但对于持续时间足够好）

```
/**
convert duration to a ms/sec/min/hour/day/week array
@param {int}        msTime              : time in milliseconds 
@param {bool}       fillEmpty(optional) : fill array values even when they are 0.
@param {string[]}   suffixes(optional)  : add suffixes to returned values.
                                        values are filled with missings '0'
@return {int[]/string[]} : time values from higher to lower(ms) range.
*/
var msToTimeList=function(msTime,fillEmpty,suffixes){
    suffixes=(suffixes instanceof Array)?suffixes:[];   //suffixes is optional
    var timeSteps=[1000,60,60,24,7];    // time ranges : ms/sec/min/hour/day/week
    timeSteps.push(1000000);    //add very big time at the end to stop cutting
    var result=[];
    for(var i=0;(msTime>0||i<1||fillEmpty)&&i<timeSteps.length;i++){
        var timerange = msTime%timeSteps[i];
        if(typeof(suffixes[i])=="string"){
            timerange+=suffixes[i]; // add suffix (converting )
            // and fill zeros :
            while(  i<timeSteps.length-1 &&
                    timerange.length<((timeSteps[i]-1)+suffixes[i]).length  )
                timerange="0"+timerange;
        }
        result.unshift(timerange);  // stack time range from higher to lower
        msTime = Math.floor(msTime/timeSteps[i]);
    }
    return result;
}; 
```

注意：如果你想控制时间范围， 你也可以将**timeSteps设置为参数。**

如何使用（复制一个测试）：

```
var elsapsed = Math.floor(Math.random()*3000000000);

console.log(    "elsapsed (labels) = "+
        msToTimeList(elsapsed,false,["ms","sec","min","h","days","weeks"]).join("/")    );

console.log(    "half hour : "+msToTimeList(elsapsed,true)[3]<30?"first":"second"   );

console.log(    "elsapsed (classic) = "+
        msToTimeList(elsapsed,false,["","","","","",""]).join(" : ")    ); 
```

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2015-03-21T10:35:46.407

我建议使用[http://www.ocpsoft.org/prettytime/](http://www.ocpsoft.org/prettytime/) library..

以人类可读的形式获取时间间隔非常简单，例如

`PrettyTime p = new PrettyTime(); System.out.println(p.format(new Date()));`

它会像“从现在开始”一样打印

另一个例子

`PrettyTime p = new PrettyTime()); Date d = new Date(System.currentTimeMillis()); d.setHours(d.getHours() - 1); String ago = p.format(d);`

然后字符串 ago = "1 小时前"

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2020-11-12T08:08:57.183

在 python 3 中，您可以使用以下代码段来实现您的目标：

```
from datetime import timedelta

ms = 536643021
td = timedelta(milliseconds=ms)

print(str(td))
# --> 6 days, 5:04:03.021000 
```

时间增量文档：[https ://docs.python.org/3/library/datetime.html#datetime.timedelta](https://docs.python.org/3/library/datetime.html#datetime.timedelta)

timedelta str的__str__方法来源：[https ://github.com/python/cpython/blob/33922cb0aa0c81ebff91ab4e938a58dfec2acf19/Lib/datetime.py#L607](https://github.com/python/cpython/blob/33922cb0aa0c81ebff91ab4e938a58dfec2acf19/Lib/datetime.py#L607)

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2012-10-01T07:04:26.863

这是JAVA中更精确的方法，我已经实现了这个简单的逻辑，希望对您有所帮助：

```
 public String getDuration(String _currentTimemilliSecond)
    {
        long _currentTimeMiles = 1;         
        int x = 0;
        int seconds = 0;
        int minutes = 0;
        int hours = 0;
        int days = 0;
        int month = 0;
        int year = 0;

        try 
        {
            _currentTimeMiles = Long.parseLong(_currentTimemilliSecond);
            /**  x in seconds **/   
            x = (int) (_currentTimeMiles / 1000) ; 
            seconds = x ;

            if(seconds >59)
            {
                minutes = seconds/60 ;

                if(minutes > 59)
                {
                    hours = minutes/60;

                    if(hours > 23)
                    {
                        days = hours/24 ;

                        if(days > 30)
                        {
                            month = days/30;

                            if(month > 11)
                            {
                                year = month/12;

                                Log.d("Year", year);
                                Log.d("Month", month%12);
                                Log.d("Days", days % 30);
                                Log.d("hours ", hours % 24);
                                Log.d("Minutes ", minutes % 60);
                                Log.d("Seconds  ", seconds % 60);   

                                return "Year "+year + " Month "+month%12 +" Days " +days%30 +" hours "+hours%24 +" Minutes "+minutes %60+" Seconds "+seconds%60;
                            }
                            else
                            {
                                Log.d("Month", month);
                                Log.d("Days", days % 30);
                                Log.d("hours ", hours % 24);
                                Log.d("Minutes ", minutes % 60);
                                Log.d("Seconds  ", seconds % 60);   

                                return "Month "+month +" Days " +days%30 +" hours "+hours%24 +" Minutes "+minutes %60+" Seconds "+seconds%60;
                            }

                        }
                        else
                        {
                            Log.d("Days", days );
                            Log.d("hours ", hours % 24);
                            Log.d("Minutes ", minutes % 60);
                            Log.d("Seconds  ", seconds % 60);   

                            return "Days " +days +" hours "+hours%24 +" Minutes "+minutes %60+" Seconds "+seconds%60;
                        }

                    }
                    else
                    {
                        Log.d("hours ", hours);
                        Log.d("Minutes ", minutes % 60);
                        Log.d("Seconds  ", seconds % 60);

                        return "hours "+hours+" Minutes "+minutes %60+" Seconds "+seconds%60;
                    }
                }
                else
                {
                    Log.d("Minutes ", minutes);
                    Log.d("Seconds  ", seconds % 60);

                    return "Minutes "+minutes +" Seconds "+seconds%60;
                }
            }
            else
            {
                Log.d("Seconds ", x);
                return " Seconds "+seconds;
            }
        }
        catch (Exception e) 
        {
            Log.e(getClass().getName().toString(), e.toString());
        }
        return "";
    }

    private Class Log
    {
        public static void d(String tag , int value)
        {
            System.out.println("##### [ Debug ]  ## "+tag +" :: "+value);
        }
    } 
```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2020-11-06T20:37:36.673

使用的解决方案`awk`：

```
$ ms=10000001; awk -v ms=$ms 'BEGIN {x=ms/1000; 
                                     s=x%60; x/=60;
                                     m=x%60; x/=60;
                                     h=x%60;
                              printf("%02d:%02d:%02d.%03d\n", h, m, s, ms%1000)}'
02:46:40.001 
```

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2021-08-30T17:17:37.713

这个遗漏了 0 个值。带测试。

```
const toTimeString = (value, singularName) =>
  `${value} ${singularName}${value !== 1 ? 's' : ''}`;

const readableTime = (ms) => {
  const days = Math.floor(ms / (24 * 60 * 60 * 1000));
  const daysMs = ms % (24 * 60 * 60 * 1000);
  const hours = Math.floor(daysMs / (60 * 60 * 1000));
  const hoursMs = ms % (60 * 60 * 1000);
  const minutes = Math.floor(hoursMs / (60 * 1000));
  const minutesMs = ms % (60 * 1000);
  const seconds = Math.round(minutesMs / 1000);

  const data = [
    [days, 'day'],
    [hours, 'hour'],
    [minutes, 'minute'],
    [seconds, 'second'],
  ];

  return data
    .filter(([value]) => value > 0)
    .map(([value, name]) => toTimeString(value, name))
    .join(', ');
};

// Tests
const hundredDaysTwentyHoursFiftyMinutesThirtySeconds = 8715030000;
const oneDayTwoHoursEightMinutesTwelveSeconds = 94092000;
const twoHoursFiftyMinutes = 10200000;
const oneMinute = 60000;
const fortySeconds = 40000;
const oneSecond = 1000;
const oneDayTwelveSeconds = 86412000;

const test = (result, expected) => {
  console.log(expected, '- ' + (result === expected));
};

test(readableTime(
  hundredDaysTwentyHoursFiftyMinutesThirtySeconds
), '100 days, 20 hours, 50 minutes, 30 seconds');

test(readableTime(
  oneDayTwoHoursEightMinutesTwelveSeconds
), '1 day, 2 hours, 8 minutes, 12 seconds');

test(readableTime(
  twoHoursFiftyMinutes
), '2 hours, 50 minutes');

test(readableTime(
  oneMinute
), '1 minute');

test(readableTime(
  fortySeconds
), '40 seconds');

test(readableTime(
  oneSecond
), '1 second');

test(readableTime(
  oneDayTwelveSeconds
), '1 day, 12 seconds');
```

# sql-server - 如何让我的轮询服务按顺序调用 SSIS？

> ID：175572
> 
> 赞同：0
> 
> 时间：2008-10-06T18:28:16.857
> 
> 标签：sql-server, ssis

我有一个轮询服务，可以检查目录中的新文件，如果有一个新文件，我会调用 SSIS。

如果另一个 SSIS 实例已经在处理另一个文件，则在某些情况下我无法运行 SSIS。
在这些情况下，如何使 SSIS 按顺序运行？

注意：并行 SSIS 的运行在某些情况下很好，而在其他情况下则不行，我怎样才能同时实现？

注意：我不想进入 WHEN/WHY 它有时不能并行运行，但只是假设有时它可以，有时它不能，主要思想是如何防止 SSIS 调用如果它有依次运行？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-06T18:35:43.520

如果您想按顺序控制流程，请考虑一种设计，例如您可以将请求（用于调用 SSIS）排入[队列数据结构](http://en.csharp-online.net/Queue_class)。一次，只会处理来自队列的顶部请求。一旦该请求完成，下一个请求就可以出列。

# sql-server - 什么是命名管道？

> ID：175579
> 
> 赞同：151
> 
> 时间：2008-10-06T18:28:58.930
> 
> 标签：sql-server, pipe, named-pipes

它们是什么以及它们是如何工作的？

上下文恰好是 SQL Server

* * *

## 回答 #1

> 赞同：166
> 
> 时间：2008-10-06T18:50:14.473

在 Windows 和 POSIX 系统上，命名管道都提供了一种在同一台机器上运行的进程之间进行进程间通信的方式。命名管道为您提供的是一种发送数据的方法，而不会因涉及网络堆栈而降低性能。

就像您有一个服务器监听传入请求的 IP 地址/端口一样，服务器也可以设置一个可以监听请求的命名管道。在任何一种情况下，客户端进程（或 DB 访问库）都必须知道发送请求的具体地址（或管道名称）。通常，存在一个常用的标准默认值（很像 HTTP 的端口 80，SQL 服务器在 TCP/IP 中使用端口 1433；\\.\pipe\sql\query 用于命名管道）。

通过设置额外的命名管道，您可以运行多个 DB 服务器，每个服务器都有自己的请求侦听器。

命名管道的优点是它通常更快，并且可以释放网络堆栈资源。

-- 顺便说一句，在 Windows 世界中，您也可以将命名管道连接到远程机器 -- 但在这种情况下，命名管道是通过 TCP/IP 传输的，因此您将失去性能。使用命名管道进行本地机器通信。

* * *

## 回答 #2

> 赞同：46
> 
> 时间：2008-10-06T20:51:08.923

Unix 和 Windows 都有称为“命名管道”的东西，但它们的行为不同。在 Unix 上，命名管道是一条单向街道，通常只有一个读取器和一个写入器 - 写入器写入，读取器读取，你明白吗？

在 Windows 上，称为“命名管道”的东西是一个 IPC 对象，更像是一个 TCP 套接字 - 东西可以双向流动，并且有一些元数据（您可以在另一端获取该东西的凭据等）。

Unix 命名管道作为文件系统中的一个特殊文件出现，可以通过包括 shell 在内的普通文件 IO 命令访问。Windows 没有，需要用一个特殊的系统调用打开（之后它们的行为就像一个普通的 win32 句柄）。

更令人困惑的是，Unix 有一个叫做“Unix 套接字”或 AF_UNIX 套接字的东西，它更像（但不完全像）win32“命名管道”，是双向的。

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2008-10-06T18:44:04.127

**Linux Pipes**
First In First Out (FIFO) 进程间通信机制。

**未命名管道**
在命令行上，用“|”表示 两个命令之间。

**命名管道**
FIFO 特殊文件。创建后，您可以像使用普通文件一样使用管道（打开、关闭、写入、读取等）。

要从命令行（[手册页](http://linux.die.net/man/1/mkfifo)）创建名为“myPipe”的命名管道：

```
mkfifo myPipe 
```

要从 c 创建命名管道，其中“路径名”是您希望管道拥有的名称，“模式”包含您希望管道拥有的权限（[手册页](http://linux.die.net/man/3/mkfifo)）：

```
#include <sys/types.h>
#include <sys/stat.h>
int mkfifo(const char *pathname, mode_t mode); 
```

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2008-10-06T18:33:08.173

根据[维基百科](http://en.wikipedia.org/wiki/Named_pipe)：

> [...] 传统管道是“未命名的”，因为它是匿名存在的，并且仅在进程运行期间持续存在。命名管道是系统持久的，存在于进程生命周期之外，一旦不再使用就必须“取消链接”或删除。进程通常附加到命名管道（通常显示为文件）以执行 IPC（进程间通信）。

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2008-10-06T18:38:24.323

比较

```
echo "test" | wc 
```

到

```
mkdnod apipe p
wc apipe 
```

wc 将阻塞直到

```
echo "test" > apipe 
```

执行

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2008-10-06T18:33:47.347

管道是一种在应用程序之间传输数据的方式。在 Linux 下，我一直使用它来将一个进程的输出流式传输到另一个进程。这是匿名的，因为目标应用程序不知道输入流来自哪里。它不需要。

*命名*管道只是一种主动连接到现有管道并收集其数据的方法。它适用于提供者不知道哪些客户将使用数据的情况。

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2014-06-03T09:28:41.223

这是来自 Technet 的一个示例（所以不确定为什么标记的答案说命名管道更快？？）：

**命名管道与 TCP/IP 套接字**

在快速局域网 (LAN) 环境中，传输控制协议/Internet 协议 (TCP/IP) 套接字和命名管道客户端在性能方面具有可比性。但是，TCP/IP 套接字和命名管道客户端之间的性能差异在较慢的网络中变得明显，例如跨广域网 (WAN) 或拨号网络。这是因为进程间通信 (IPC) 机制在对等点之间进行通信的方式不同。

对于命名管道，网络通信通常更具交互性。一个对等点不会发送数据，直到另一个对等点使用读取命令请求它。网络读取通常涉及一系列 peek 命名管道消息，然后才开始读取数据。这些**在缓慢的网络中可能会非常昂贵，并导致过多的网络流量**，进而影响其他网络客户端。

澄清您是在谈论本地管道还是网络管道也很重要。如果服务器应用程序在运行 SQL Server 实例的计算机上本地运行，则可以选择本地命名管道协议。本地命名管道在内核模式下运行，速度非常快。

对于 TCP/IP 套接字，数据传输更加流畅，开销也更少。数据传输还可以利用 TCP/IP 套接字性能增强机制，例如窗口化、延迟确认等。这在慢速网络中非常有用。根据应用程序的类型，这种性能差异可能很大。

TCP/IP 套接字还支持积压队列。与在您尝试连接到 SQL Server 时可能导致管道繁忙错误的命名管道相比，这可以提供有限的平滑效果。

通常，TCP/IP 在慢速 LAN、WAN 或拨号网络中是首选，而当网络速度不是问题时，命名管道可能是更好的选择，因为它提供更多功能、易用性和配置选项。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2008-10-06T18:33:43.633

Windows 应用程序的进程间通信（主要是）。类似于在 Unix 中使用套接字在应用程序之间进行通信。

[MSDN](http://msdn.microsoft.com/en-us/library/aa365590.aspx)

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2011-07-14T04:25:26.530

unix/linux 上下文中的命名管道可用于使两个不同的 shell 进行通信，因为 shell 不能与另一个 shell 共享任何内容。

此外，在同一个 shell 中实例化两次的脚本不能通过这两个实例共享任何内容。在编写包含 start() 和 stop() 函数的守护程序时，我发现了命名管道的用途，并且我想使用相同的脚本来执行这两个操作。

没有命名管道（或任何类型的信号量）在后台启动脚本不是问题。问题是当它完成时，您将无法在后台访问该实例。

因此，当您想向他发送停止命令时，您不能：在没有命名管道的情况下运行相同的脚本并调用 stop() 函数不会做任何事情，因为您实际上正在运行另一个实例。

解决方案是在启动守护程序时实现两个管道，一个 READ 和另一个 WRITE。然后让他在其他任务中收听 READ 管道。然后 Stop() 函数包含一个命令，该命令将在管道中写入一条消息，该消息将由执行退出 0 的后台运行脚本处理。这样，同一脚本的第二个实例只需要执行任务：告诉第一个实例停止。

这样，只有一个脚本可以自行启动和停止。

当然，您有不同的方法来做到这一点，例如通过触摸触发停止。但是这个代码很好，也很有趣。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-10-06T18:34:13.460

命名管道是用于进程间通信的 Windows 系统。对于 SQL Server，如果服务器与客户端在同一台机器上，则可以使用命名管道来传输数据，而不是使用 TCP/IP。

# javascript - jQuery UI droppables - 改变被丢弃的图像

> ID：175609
> 
> 赞同：3
> 
> 时间：2008-10-06T18:34:15.783
> 
> 标签：javascript, jquery, jquery-ui, drag-and-drop

我正在使用[jQuery UI 的 droppables](http://dev.jquery.com/view/tags/ui/latest/demos/functional/#ui.droppable)并且想知道使丢弃的克隆使用与`IMG SRC`被丢弃的项目不同的最佳方法是什么。

在那里的照片管理器演示中，缩略图被放入相同大小的插槽中。我想将一个大图像放到一个小插槽中，因此我需要它的克隆来使用我的缩略图而不是完整图像。

有关处理此问题的最佳方法的任何建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-06T18:40:48.440

droppable API 在其选项中接受“drop”回调。使用它来更改图像的 src，例如：

```
 $('#dropContainer').droppable({
       drop: function(e,ui) {
            $(ui.draggable).attr('src','/path/to/different/image');
       }
  }); 
```

# java - 在 Maven 集成测试期间启动外部进程

> ID：175621
> 
> 赞同：4
> 
> 时间：2008-10-06T18:35:50.307
> 
> 标签：java, maven-2, build-process, automated-tests, integration-testing

我想要一个 Maven 项目的完全自动化的集成测试。集成测试要求在运行之前启动一个外部（平台相关）程序。理想情况下，外部程序会在单元测试完成后被终止，但这不是必需的。

有没有一个 Maven 插件来完成这个？其他想法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-06T18:48:44.927

您可以使用[antrun](http://maven.apache.org/plugins/maven-antrun-plugin/)插件。在里面你会使用 ant 的~~[exec](http://ant.apache.org/manual/Tasks/exec.html)~~ [apply](http://ant.apache.org/manual/Tasks/apply.html)任务。

像这样的东西。

```
<plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-antrun-plugin</artifactId>
    <version>1.2</version>
    <executions>
      <execution>
        <phase> <!-- a lifecycle phase --> </phase>
        <configuration>

          <tasks>
            <apply os="unix" executable="cmd">
              <arg value="/c"/>
              <arg value="ant.bat"/>
              <arg value="-p"/>
            </apply>
            <apply os="windows" executable="cmd.exe">
              <arg value="/c"/>
              <arg value="ant.bat"/>
              <arg value="-p"/>
            </apply>
          </tasks>

        </configuration>
        <goals>
          <goal>run</goal>
        </goals>
      </execution>
    </executions>
  </plugin> 
```

~~Ant 通过[条件任务](http://ant.apache.org/manual/Tasks/condition.html)当然支持 os 特定的命令。~~

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-06T19:24:48.427

我目前正在开发一个更具体的插件，它可以很容易地“降级”为一个简单的外部任务执行器，但是......还有很多其他的事情需要考虑。

1.  你怎么知道这个过程实际上已经开始了？
2.  你如何处理返回码？
3.  你如何确保执行器插件首先运行（将其绑定到测试编译阶段）？

如果我真的开始开发插件，我敢肯定会有更多，但真的需要通用执行器吗？

更新：

我想有……在 CodeHaus 有一组优秀的 Maven 插件。这是您想要的：http: [//mojohaus.org/exec-maven-plugin/](http://mojohaus.org/exec-maven-plugin/)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-06T21:48:39.947

如果您正在进行 servlet 开发并希望部署生成的 WAR 以进行集成测试，那么 cargo maven 插件是一个不错的选择。

当我自己这样做时，我经常建立一个多模块项目（尽管这不是严格必要的）并将所有集成测试封装到一个模块中。然后我启用带有配置文件（或不启用）的模块，这样它就不会立即阻止“是的，我知道我破坏了它”构建。

这是来自该功能测试模块的 pom - 随心所欲地制作它：

```
<?xml version="1.0"?><project>
  <parent>
    <artifactId>maven-example</artifactId>
    <groupId>com.jheck</groupId>
    <version>1.5.0.4-SNAPSHOT</version>
  </parent>
  <modelVersion>4.0.0</modelVersion>
  <groupId>com.jheck.example</groupId>
  <artifactId>functional-test</artifactId>
  <name>Example Functional Test</name>
  <packaging>pom</packaging>

  <dependencies>
    <dependency>
      <groupId>com.jheck.example</groupId>
      <artifactId>example-war</artifactId>
      <type>war</type>
      <scope>provided</scope>
      <version>LATEST</version>
    </dependency>
    <dependency>
      <groupId>httpunit</groupId>
      <artifactId>httpunit</artifactId>
      <version>1.6.1</version>
      <scope>test</scope>
    </dependency>
  </dependencies>

  <build>
    <plugins>

      <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-compiler-plugin</artifactId>
        <executions>
          <execution>
            <goals>
              <goal>testCompile</goal>
            </goals>
          </execution>
        </executions>
      </plugin>

      <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-surefire-plugin</artifactId>
        <executions>
          <execution>
            <phase>integration-test</phase>
            <goals>
              <goal>test</goal>
            </goals>
          </execution>
        </executions>
      </plugin>

      <plugin>
        <groupId>org.codehaus.cargo</groupId>
        <artifactId>cargo-maven2-plugin</artifactId>
        <version>0.3</version>
        <configuration>
          <wait>false</wait> <!-- don't pause on launching tomcat... -->
          <container>
            <containerId>tomcat5x</containerId>
            <log>${project.build.directory}/cargo.log</log>
            <zipUrlInstaller>
              <!--
              <url>http://www.apache.org/dist/tomcat/tomcat-5/v5.0.30/bin/jakarta-tomcat-5.0.30.zip</url>
               -->
               <!-- better be using Java 1.5... -->
              <url>http://www.apache.org/dist/tomcat/tomcat-5/v5.5.26/bin/apache-tomcat-5.5.26.zip</url>

              <installDir>${installDir}</installDir>
            </zipUrlInstaller>
          </container>
          <configuration>
            <!-- where the running instance will be deployed for testing -->
            <home>${project.build.directory}/tomcat5x/container</home>
          </configuration>
        </configuration>

        <executions>
          <execution>
            <id>start-container</id>
            <phase>pre-integration-test</phase>
            <goals>
              <goal>start</goal>
              <goal>deploy</goal>
            </goals>
            <configuration>
              <deployer>
                <deployables>
                  <deployable>
                    <groupId>com.jheck.example</groupId>
                    <artifactId>example-war</artifactId>
                    <type>war</type>
                    <!-- <properties>
                      <plan>${basedir}/src/deployment/geronima.plan.xml</plan>
                    </properties> -->
                    <pingURL>http://localhost:8080/example-war</pingURL>
                  </deployable>
                </deployables>
              </deployer>
            </configuration>
          </execution>
          <execution>
            <id>stop-container</id>
            <phase>post-integration-test</phase>
            <goals>
              <goal>stop</goal>
            </goals>
          </execution>
        </executions>
      </plugin>
    </plugins>
  </build>

</project> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-08-23T17:10:19.703

您可能希望将您的实际集成测试绑定到 Maven 生命周期的集成测试阶段。如果您使用故障安全插件（如恰当命名的故障安全插件）来进行实际测试，您可以像这样运行您的阶段：

**pre-integration-test**：启动外部应用程序（使用 exec 插件或此处的其他建议之一）

**integration-test**：使用故障安全插件运行实际的集成测试

**post-integration-test**：关闭外部应用程序并进行任何其他必要的清理

**verify**：让故障安全插件验证测试结果并在此时使构建失败

使用 exec 插件相当简单，诀窍是让您的应用程序**在后台**启动。在开始下一阶段的测试之前，您应该小心确保应用程序已完全启动。不幸的是，让您的应用程序启动并确保它在后台运行时足够启动并不总是一项微不足道的任务，具体如何做到这一点取决于您的应用程序。它通常涉及应用程序中的自定义代码。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-06T21:40:00.840

是否要启动应用程序服务器？看看[Cargo](http://cargo.codehaus.org/)和它的[Maven 插件](http://cargo.codehaus.org/Maven2+plugin)。

# c# - 一个实体在两个 Web 服务之间共享？

> ID：175649
> 
> 赞同：3
> 
> 时间：2008-10-06T18:42:59.870
> 
> 标签：c#, .net, web-services, wsdl

我正在做一个项目，我有 2 个需要相同实体的 Web 服务。这两个 Web 服务位于同一台服务器上，因此在后端，它们共享相同的类。

在前端，我的代码*同时使用这两个*Web 服务，并将来自这两个服务的实体视为独立的（在不同的命名空间中），因此我不能在这两个服务中使用该实体。

有谁知道允许它在 .NET 2.0 中工作的方法？

我已经用我的实体做到了这一点：

```
[XmlType(TypeName = "Class1", Namespace = "myNamespace")]
public class Class1
{
    public int field;
} 
```

希望我的 IDE 能以某种方式“知道”两个 Web 服务上的类是相同的，这样它就不会为两个类创建单独的实体，但没有运气。

这可能与 .NET 2.0 Web 服务有关吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-06T19:40:39.613

我认为您不能从 VS 内部执行此操作，但您可以`wsdl.exe`像这样手动使用该实用程序：

```
wsdl.exe /sharetypes http://localhost/MyService1.asmx?wsdl http://localhost/MyService2.asmx?wsdl 
```

请注意`/sharetypes`打开类型共享功能的选项。此功能为不同服务之间共享的相同类型创建一个具有单一类型定义的代码文件（命名空间、名称和线路签名必须相同）。

更多信息：

*   [Web 服务描述语言工具](http://msdn.microsoft.com/en-us/library/7h3ystb6(VS.80).aspx)
*   [Framework 2.0 - WebServices 共享类型](http://weblogs.asp.net/israelio/archive/2005/01/04/346337.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-06T19:14:14.097

我不确定 .NET 2.0 的实现细节，但我相信你想要做的是将公共类放在一个单独的 XSD 文件中，并从你的两个 WSDL 中引用它。这样，公共类型在两个服务之间具有相同的命名空间。

现在，您如何在 .NET 2.0 中执行此操作，我无法为您提供关于...的详细信息

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-06T19:19:59.030

你能检查实体的命名空间吗？确保它在两个 Web 服务中是相同的。

# ruby-on-rails - 如何找到在运行时定义方法的位置？

> ID：175655
> 
> 赞同：345
> 
> 时间：2008-10-06T18:44:24.610
> 
> 标签：ruby-on-rails, ruby, runtime, methods, definition

我们最近遇到了一个问题，在发生一系列提交后，后端进程无法运行。现在，我们都是好孩子，`rake test`每次签到后都会跑，但是由于 Rails 库加载的一些奇怪之处，只有当我们在生产模式下直接从 Mongrel 运行它时才会发生这种情况。

我跟踪了这​​个错误，这是由于一个新的 Rails gem 覆盖了 String 类中的一个方法，这种方式打破了运行时 Rails 代码中的一个狭窄用途。

无论如何，长话短说，有没有办法在运行时询问 Ruby 在哪里定义了一个方法？类似的东西`whereami( :foo )`回来了`/path/to/some/file.rb line #45`？在这种情况下，告诉我它是在 String 类中定义的将是没有帮助的，因为它被某个库重载了。

我不能保证源代码存在于我的项目中，因此 grepping for`'def foo'`不一定能给我我需要的东西，更不用说我是否有*很多* `def foo`'s，有时我直到运行时才知道我可能正在使用哪一个。

* * *

## 回答 #1

> 赞同：441
> 
> 时间：2009-03-18T21:12:44.903

这真的很晚了，但是您可以通过以下方式找到定义方法的位置：

[http://gist.github.com/76951](http://gist.github.com/76951)

```
# How to find out where a method comes from.
# Learned this from Dave Thomas while teaching Advanced Ruby Studio
# Makes the case for separating method definitions into
# modules, especially when enhancing built-in classes.
module Perpetrator
  def crime
  end
end

class Fixnum
  include Perpetrator
end

p 2.method(:crime) # The "2" here is an instance of Fixnum.
#<Method: Fixnum(Perpetrator)#crime> 
```

如果您使用的是 Ruby 1.9+，则可以使用[`source_location`](http://www.ruby-doc.org/core-1.9.3/Method.html#method-i-source_location)

```
require 'csv'

p CSV.new('string').method(:flock)
# => #<Method: CSV#flock>

CSV.new('string').method(:flock).source_location
# => ["/path/to/ruby/1.9.2-p290/lib/ruby/1.9.1/forwardable.rb", 180] 
```

请注意，这不适用于所有内容，例如本机编译代码。[Method 类](http://www.ruby-doc.org/core-1.9.3/Method.html)也有一些简洁的函数，例如[Method#owner](http://www.ruby-doc.org/core-1.9.3/Method.html#method-i-owner)，它返回定义方法的文件。

编辑：另请参阅其他答案中 REE 的`__file__`和`__line__`和注释，它们也很方便。-- wg

* * *

## 回答 #2

> 赞同：85
> 
> 时间：2010-08-25T09:52:04.090

您实际上可以比上面的解决方案走得更远。对于 Ruby 1.8 企业版，实例上有`__file__`和`__line__`方法：`Method`

```
require 'rubygems'
require 'activesupport'

m = 2.days.method(:ago)
# => #<Method: Fixnum(ActiveSupport::CoreExtensions::Numeric::Time)#ago>

m.__file__
# => "/Users/james/.rvm/gems/ree-1.8.7-2010.01/gems/activesupport-2.3.8/lib/active_support/core_ext/numeric/time.rb"
m.__line__
# => 64 
```

对于 Ruby 1.9 及更高版本，有`source_location`（感谢 Jonathan！）：

```
require 'active_support/all'
m = 2.days.method(:ago)
# => #<Method: Fixnum(Numeric)#ago>    # comes from the Numeric module

m.source_location   # show file and line
# => ["/var/lib/gems/1.9.1/gems/activesupport-3.0.6/.../numeric/time.rb", 63] 
```

* * *

## 回答 #3

> 赞同：39
> 
> 时间：2012-02-20T04:07:21.567

我来晚了这个帖子，很惊讶没有人提到`Method#owner`。

```
class A; def hello; puts "hello"; end end
class B < A; end
b = B.new
b.method(:hello).owner
=> A 
```

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2012-10-22T16:29:23.560

[从一个更新的类似问题](https://stackoverflow.com/questions/13012109/get-class-location-from-class-object)中复制我的答案，为这个问题添加了新信息。

Ruby **1.9**有一个名为[source_location](http://www.ruby-doc.org/core-1.9.3/Method.html#method-i-source_location)的方法：

> 返回包含此方法的 Ruby 源文件名和行号，如果此方法未在 Ruby（即本机）中定义，则返回 nil

此 gem 已将其向后移植到**1.8.7**：

*   [ruby18_source_location](https://github.com/ConradIrwin/ruby18_source_location)

因此，您可以请求该方法：

```
m = Foo::Bar.method(:create) 
```

然后询问`source_location`该方法的：

```
m.source_location 
```

这将返回一个包含文件名和行号的数组。例如对于`ActiveRecord::Base#validates`这个返回：

```
ActiveRecord::Base.method(:validates).source_location
# => ["/Users/laas/.rvm/gems/ruby-1.9.2-p0@arveaurik/gems/activemodel-3.2.2/lib/active_model/validations/validates.rb", 81] 
```

对于类和模块，Ruby 不提供内置支持，但是有一个优秀的 Gist 可以在`source_location`没有指定方法的情况下返回给定方法的文件或类的第一个文件：

*   [红宝石 where_is 模块](https://gist.github.com/1236979)

在行动：

```
where_is(ActiveRecord::Base, :validates)

# => ["/Users/laas/.rvm/gems/ruby-1.9.2-p0@arveaurik/gems/activemodel-3.2.2/lib/active_model/validations/validates.rb", 81] 
```

在安装了 TextMate 的 Mac 上，这也会在指定位置弹出编辑器。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2008-10-06T20:01:29.790

这可能会有所帮助，但您必须自己编写代码。从博客粘贴：

> Ruby 提供了一个 method_added() 回调，每次在类中添加或重新定义方法时都会调用该回调。它是模块类的一部分，每个类都是一个模块。还有两个相关的回调，称为 method_removed() 和 method_undefined()。

[http://scie.nti.st/2008/9/17/making-methods-immutable-in-ruby](http://scie.nti.st/2008/9/17/making-methods-immutable-in-ruby)

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2008-10-06T20:01:50.630

如果你可以让这个方法崩溃，你会得到一个回溯，它会告诉你它在哪里。

不幸的是，如果你不能让它崩溃，那么你就无法找出它是在哪里定义的。如果您试图通过覆盖或覆盖它来使用该方法，那么任何崩溃都将来自您覆盖或覆盖的方法，并且它没有任何用处。

崩溃方法的有用方法：

1.  通过`nil`它禁止它的地方 - 很多时候该方法会在 nil 类上引发一个`ArgumentError`或永远存在的。`NoMethodError`
2.  如果您对该方法有内部了解，并且知道该方法又会调用其他方法，那么您可以覆盖其他方法，并在其中引发。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2016-07-14T07:51:48.673

也许`#source_location`可以帮助找到方法来自哪里。

前任：

```
ModelName.method(:has_one).source_location 
```

返回

```
[project_path/vendor/ruby/version_number/gems/activerecord-number/lib/active_record/associations.rb", line_number_of_where_method_is] 
```

或者

```
ModelName.new.method(:valid?).source_location 
```

返回

```
[project_path/vendor/ruby/version_number/gems/activerecord-number/lib/active_record/validations.rb", line_number_of_where_method_is] 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2010-05-14T18:36:18.477

很晚的答案:)但早期的答案对我没有帮助

```
set_trace_func proc{ |event, file, line, id, binding, classname|
  printf "%8s %s:%-2d %10s %8s\n", event, file, line, id, classname
}
# call your method
set_trace_func nil 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-10-06T20:16:47.620

您可能可以执行以下操作：

foo_finder.rb：

```
 class String
   def String.method_added(name)
     if (name==:foo)
        puts "defining #{name} in:\n\t"
        puts caller.join("\n\t")
     end
   end
 end 
```

然后确保 foo_finder 首先加载类似

```
ruby -r foo_finder.rb railsapp 
```

（我只是弄乱了轨道，所以我不知道确切，但我想有一种方法可以像这样开始它。）

这将向您展示 String#foo 的所有重新定义。通过一点元编程，您可以将其概括为您想要的任何功能。但它确实需要在实际执行重新定义的文件之前加载。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2008-10-07T05:07:14.150

您始终可以使用`caller()`.

# database - DB2 在线数据库备份

> ID：175684
> 
> 赞同：3
> 
> 时间：2008-10-06T18:53:41.207
> 
> 标签：database, backup, db2

我目前有 200+ GB 的数据库正在使用 DB2 内置备份进行每日备份（希望不会恢复 - 哈哈）但是由于该备份现在需要超过 2.5 小时才能完成，所以我正在研究第三方备份和恢复效用。版本是 8.2 FP 14 但我很快就会升级到 9.1，而且我还有一些 9.5 数据库要备份和恢复。您为此目的使用的最佳工具是什么？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-14T19:11:46.237

实际上只有两种方法可以进行备份，更重要的是恢复运行速度更快：1\. 备份更少的数据和/或 2\. 拥有更大的备份媒体管道

我认为您对如何减少备份的数据量有很多建议。基本上，您应该创建一个备份策略，该策略依赖于相对不频繁的完整备份和更频繁的更改（自上次完整备份以来）数据的备份。我鼓励您查看 DB2 Control Center 中的“配置自动维护”向导。它将帮助您创建自动备份以及[Antonio](http://antoniocangiano.com/)建议的 REORG 等其他实用程序。由于数据量要低得多，因此压缩之类的东西显然会有所帮助。但是，并非所有 DB2 版本都提供压缩。例如，[DB2 Express-C](http://www.ibm.com/db2/express/?S_TACT=LKFREE002&S_CMP=ECDDWW01)没有。坦率地说，对 200GB 的数据库进行压缩可能并不值得，这正是为什么像[DB2 Express-C这样的免费 DBMS](http://FreeDB2.com/)不提供压缩。

至于为您的备份打开一个更大的管道，您首先必须决定是备份到磁盘还是磁带。速度有很大差异（显然磁盘要快得多）。其次，DB2 可以并行化备份。因此，如果您有多个设备要备份，它会同时备份到所有设备，即您经过的时间会少很多，具体取决于您要解决问题的设备数量。同样，DB2 Control Center 可以帮助您进行设置。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-13T21:44:06.900

在查看第三方工具之前，我怀疑它会帮助太多，我会考虑一些优化。

1) 你在你的表和索引上使用过 REORG 吗？这将压缩信息并最大限度地减少使用的页面数量；

2）如果可以，请同时在多个磁盘上备份。这可以通过运行轻松实现`db2 backup db mydb /mnt/disk1 /mnt/disk2 /mnt/disk3 ...`

3) DB2 应该在微调本身方面做得很好，但是您总是可以尝试使用`WITH num_buffers BUFFERS`,`BUFFER buffer-size`和`PARALLELISM n`选项。但同样，通常 DB2 自己会做得更好。

4）考虑进行每日增量备份，周六或周日进行一次全量备份；

5）`UTIL_IMPACT_PRIORITY`并`UTIL_IMPACT_LIM`让您限制备份过程，使其不会过多影响您的常规工作量。如果您主要关心的不是时间本身，而是备份时数据服务器的性能，这很有用；

6) DB2 9 的数据压缩在减少需要备份的数据维度方面确实可以创造奇迹。我已经看到了非常令人印象深刻的结果，如果您可以迁移到 9.1 版或者更好的 9.5 版，我强烈推荐它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-11T22:33:41.497

有帮助的一件事是转到 DB2 版本 9 并打开压缩。然后备份的大小将减少（表级别最多减少 70-80%），这应该会缩短备份时间。当然，如果您的数据库持续增长，您很快就会再次遇到问题，但是数据归档可能适合您。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-06-02T12:42:37.533

尝试高性能卸载 (HPU) - 这是 Infotel 的独立产品，现在作为 Optim 数据工作室的一部分提供 - 在此处发布[https://www.ibm.com/developerworks/mydeveloperworks/blogs/idm/date/200910？ lang=en](https://www.ibm.com/developerworks/mydeveloperworks/blogs/idm/date/200910?lang=en)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-06T20:15:07.953

It's not a "third-party" product but anyone that I have ever seen using DB2 is using [Tivoli Storage Manager](http://www-01.ibm.com/software/tivoli/products/storage-mgr/) to store their database backups.

Most shops will set up archive logging to TSM so you only have to take the "big" backup every week or so.

Since it's also an IBM product you won't have to worry about it working with all the different flavors of DB2 that you have.

The downside is it's an IBM product. :) Not sure if that ($) makes a difference to you.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-06T20:28:47.050

I doubt that you can speed things up using another backup tool. As Mike mentions, you can add TSM to the stack, but that will hardly make the backup run any faster.

If I were you, I'd look into where backup files are stored: Are they using the same disk spindles as the database itself? If so: See if you can store the backup files on a storage area which isn't contented for access during your backup window.

And consider using incremental backups for daily backups, and then a long full backup on Saturdays.

(I assume that you are already running online backups, so that your data aren't unavailable during backup.)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-13T20:34:49.050

第三方备份包可能对您的速度没有太大帮助。确保您不是每 2 小时进行一次完整备份可能是第一步。

之后，查看您将备份写入的位置。它是本地驱动器，而不是网络驱动器吗？主轴是否用于其他用途？备份不涉及大量查找活动，但确实涉及大量写入，因此您可能希望避免使用 RAID 5 并使用大条带大小以帮助最大化吞吐量。

自然，您迟早必须进行完整备份，但希望您可以在负载较轻的时候找到一个窗口，并且您可以忍受更长的备份间隔时间。在正常增量关闭的 4-6 小时内进行完整备份，然后在其余时间基于此进行增量备份。

此外，在您将备份复制到一个完全独立的系统之前，您实际上并没有得到备份。您必须尝试确定在发送之前、期间或之后压缩它是否更好。

# c++ - 你可以使用关键字显式来防止方法参数的自动转换吗？

> ID：175689
> 
> 赞同：55
> 
> 时间：2008-10-06T18:58:03.223
> 
> 标签：c++, implicit-conversion, explicit

我知道您可以对类的构造函数使用 C++ 关键字“显式”来防止类型的自动转换。您可以使用相同的命令来防止类方法的参数转换吗？

我有两个班级成员，一个将 bool 作为参数，另一个是 unsigned int。当我用 int 调用函数时，编译器将 param 转换为 bool 并调用了错误的方法。我知道最终我会替换 bool，但现在不想在开发这个新例程时破坏其他例程。

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2008-10-06T19:56:15.400

不，您不能使用显式，但您可以使用模板函数来捕获不正确的参数类型。

使用**C++11**，您可以将模板化函数声明为`delete`d。这是一个简单的例子：

```
#include <iostream>

struct Thing {
    void Foo(int value) {
        std::cout << "Foo: value" << std::endl;
    }

    template <typename T>
    void Foo(T value) = delete;
}; 
```

如果您尝试`Thing::Foo`使用`size_t`参数调用，则会出现以下错误消息：

```
error: use of deleted function
    ‘void Thing::Foo(T) [with T = long unsigned int]’ 
```

* * *

在**C++11 之前的**代码中，它可以使用未定义的私有函数来完成。

```
class ClassThatOnlyTakesBoolsAndUIntsAsArguments
{
public:
  // Assume definitions for these exist elsewhere
  void Method(bool arg1);
  void Method(unsigned int arg1);

  // Below just an example showing how to do the same thing with more arguments
  void MethodWithMoreParms(bool arg1, SomeType& arg2);
  void MethodWithMoreParms(unsigned int arg1, SomeType& arg2);

private:
  // You can leave these undefined
  template<typename T>
  void Method(T arg1);

  // Below just an example showing how to do the same thing with more arguments
  template<typename T>
  void MethodWithMoreParms(T arg1, SomeType& arg2);
}; 
```

缺点是在这种情况下代码和错误消息不太清楚，因此应尽可能选择 C++11 选项。

对每个采用`bool`or的方法重复此模式`unsigned int`。不要为该方法的模板化版本提供实现。

这将强制用户始终显式调用 bool 或 unsigned int 版本。

`Method`由于成员是私有的，因此任何使用除`bool`或之外的类型调用的尝试`unsigned int`都将无法编译，当然，受可见性规则的标准例外（朋友、内部调用等）的约束。如果有访问权限的东西调用了私有方法，你会得到一个链接器错误。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-10-06T19:17:14.403

不可以`explicit`防止特定类之间的自动转换，而与上下文无关。当然，你不能为内置类做到这一点。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-10-06T21:22:12.357

以下是一个非常基本的包装器，可用于创建强 typedef：

```
template <typename V, class D> 
class StrongType
{
public:
  inline explicit StrongType(V const &v)
  : m_v(v)
  {}

  inline operator V () const
  {
    return m_v;
  }

private:
  V m_v; // use V as "inner" type
};

class Tag1;
typedef StrongType<int, Tag1> Tag1Type;

void b1 (Tag1Type);

void b2 (int i)
{
  b1 (Tag1Type (i));
  b1 (i);                // Error
} 
```

这种方法的一个很好的特点是，您还可以区分具有相同类型的不同参数。例如，您可能有以下内容：

```
class WidthTag;
typedef StrongType<int, WidthTag> Width;  
class HeightTag;
typedef StrongType<int, HeightTag> Height;  

void foo (Width width, Height height); 
```

'foo' 的客户会清楚哪个参数是哪个。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-06T21:04:59.223

可能对您有用的是使用模板。下面显示了`foo<>()`专门用于`bool`、`unsigned int`和的模板函数`int`。该`main()`函数显示调用如何得到解决。请注意，使用`int`未指定类型后缀的常量的调用将解析为，因此如果您不专注于`foo<int>()`，则会收到错误调用。如果是这种情况，使用文字整数常量的调用者将不得不使用后缀来获取调用来解析（这可能是您想要的行为）。`foo( 1)``int``"U"`

否则，您必须专门研究`int`并使用`"U"`后缀或将其转换为 an `unsigned int`，然后再将其传递给`unsigned int`版本（或者，如果您想要的话，可能会断言该值不是负数）。

```
#include <stdio.h>

template <typename T>
void foo( T);

template <>
void foo<bool>( bool x)
{
    printf( "foo( bool)\n");
}

template <>
void foo<unsigned int>( unsigned int x)
{
    printf( "foo( unsigned int)\n");
}

template <>
void foo<int>( int x)
{
    printf( "foo( int)\n");
}

int main () 
{
    foo( true);
    foo( false);
    foo( static_cast<unsigned int>( 0));
    foo( 0U);
    foo( 1U);
    foo( 2U);
    foo( 0);
    foo( 1);
    foo( 2);
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-09-20T01:53:18.560

当前接受的[答案](https://stackoverflow.com/a/175926/7022459)（使用私有模板函数）很好，但已过时。在 C++11 中，我们可以使用`delete`d 函数来代替：

```
#include <iostream>

struct Thing {
    void Foo(int value) {
        std::cout << "Foo: value" << std::endl;
    }

    template <typename T>
    void Foo(T value) = delete;
};

int main() {
    Thing t;
    int int_value = 1;
    size_t size_t_value = 2;

    t.Foo(int_value);

    // t.Foo(size_t_value);  // fails with below error
    // error: use of deleted function
    //   ‘void Thing::Foo(T) [with T = long unsigned int]’

    return 0;
} 
```

这更直接地传达了源代码的意图，并在尝试使用具有不允许的参数类型的函数时为用户提供更清晰的错误消息。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-06T19:05:38.577

编译器给出了“模棱两可的调用”警告，这就足够了。

我正在做 TDD 开发，并没有意识到我忘记在模拟对象中实现相应的调用。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-06T19:51:54.567

bool 是一个限制为 0 或 1 的 int。这就是 return 0; 的整个概念，它在逻辑上与 return false; 相同；（尽管不要在代码中使用它）。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2008-10-06T19:14:30.897

您还可以编写一个调用 bool 的 int 版本。

# active-directory - 我想在工作中使用 LDAP 客户端与 Active Directory 对话。我怎样才能自己发现我应该瞄准的IP？

> ID：175690
> 
> 赞同：0
> 
> 时间：2008-10-06T18:59:08.963
> 
> 标签：active-directory, ldap

我知道我可以问，但这会涉及官僚纠葛。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-06T19:04:09.640

尝试 ping 或 nslookup _ldap._tcp。在控制台 (cmd.exe) 中使用您的 AD 域（例如 _ldap._tcp.test.com） - 这应该为您提供 AD 服务器 IP。

```
_ldap._tcp.* 
```

是您的 Active Directory 服务器创建的一般 SRV 条目，用于在您的域中定位 LDAP (AD) 服务器。您的域本身应该与您的 Windows 登录域匹配。如果不是这种情况，请右键单击桌面或资源管理器中的“我的电脑”图标，然后单击属性。在系统属性中有一个选项卡显示您的计算机名称及其网络 ID，其中还包含其 DOMAIN/WORKGROUP 名称。这是您应该附加到上面的资源定位器的内容。

顺便提一句。你是如何在没有域登录的情况下访问那台机器的？:)

编辑： FOOAD 名称将是“旧”域名，而 foo.something.something 是新的基于 DNS 的名称 - 这应该为您提供服务器地址。还可以尝试 Almond 的建议，该建议更具体地说明了所请求的服务。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-06T20:49:21.610

Open command prompt if you can, type ipconfig /all look at the entry for primary dns suffix. This mostly likely the domain that your workstation is on. Another potenial way is to log out and look at the domain listed below username/password in the login window.

Once you have your domain name open command prompt again and type the following:

nslookup _LDAP._TCP.dc._msdcs.**mydomain**

this will give you a ip address for the domain controller.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-06T19:01:22.267

我相信在启用了 DNS 的 AD 网络上，所有 AD 服务器上的根区域点。因此，例如，如果您的官方 AD 用户名是 joebloe@company.ad，则从 cmd.exe 对 company.ad 进行 nslookup 将告诉您控制器的所有 IP（以及您可以用于 LDAP 的所有 IP）。

这是编辑以更改区域名称，但我的工作系统之一：

```
C:\Documents and Settings\jj33>nslookup companyname.ad
Server:  palpatine.companyname.ad
Address:  172.19.1.3

Name:  companyname.ad
Addresses:  172.16.3.2, 172.16.6.2, 172.19.1.3, 172.16.7.9
          172.19.1.14, 172.19.1.11
C:\Documents and Settings\jj33> 
```

在我的 (XP) 机器上，这显示了我的 AD 域：

*   右键单击“我的电脑”
*   选择“计算机名称”选项卡
*   请参阅“域：”字段

# xml - 我如何在 XSD 中指定一个元素只包含 CDATA？

> ID：175695
> 
> 赞同：29
> 
> 时间：2008-10-06T18:59:46.123
> 
> 标签：xml, xsd

我如何在 XSD 中表示以下内容。

```
<price-update>
    <![CDATA[
      arbitrary data goes here
    ]]>
</price-update> 
```

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2008-10-06T19:43:05.020

```
<element name="price-update" type="string"></element> 
```

几乎是你能得到的。

（我认为最好将答案从评论中移到实际答案中）。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2008-10-06T19:03:38.470

CDATA 标记只是将数据转义为文本节点的一种方式。因此，您不能规定您需要一个 CDATA 节点。

从 DOM 的角度来看，以下文档是相同的：

```
<doc>value</doc> 
```

和

```
<doc><![CDATA[value]]></doc> 
```

# iphone - 什么类处理 iphone 上的弹出/通知窗口？

> ID：175696
> 
> 赞同：3
> 
> 时间：2008-10-06T18:59:52.457
> 
> 标签：iphone, cocoa-touch

我正在寻找 iPhone 上弹出/消息窗口的类名（例如，当您有未接来电或有消息进来时，它会出现一个蓝色窗口。）

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-06T19:01:03.843

该类称为`UIAlertView`. 从文档中：

> 使用 UIAlertView 类向用户显示警报消息。警报视图的功能类似于操作表（UIActionSheet 的一个实例），但在外观上有所不同。
> 
> 使用该类中定义的属性和方法来设置警报视图的标题、消息和委托并配置按钮。如果添加自定义按钮，则必须设置委托。委托应符合 UIAlertViewDelegate 协议。配置后使用 show 方法显示警报视图。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-06T21:05:44.183

您提供的示例（未接电话或传入短信）是在任何应用程序上弹出的系统级警报。该功能无法通过 SDK 获得。lajos 的回答确实提供了显示警报的正确方法，但值得记住的是，您只能在应用程序中执行此操作。您无法在另一个应用程序上弹出警报，因为 SDK 当前禁止应用程序在后台运行。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-07T15:05:32.710

除了[这个](https://stackoverflow.com/questions/175696/what-class-handles-the-popupnotification-windows-on-iphone#175700)响应，[UIAlertView](http://developer.apple.com/iphone/library/documentation/UIKit/Reference/UIAlertView_Class/UIAlertView/UIAlertView.html)确实是这样做的方法，你想要的代码是：

```
UIAlertView *alert = [[[UIAlertView alloc] initWithTitle:@"Message" message:nil delegate:self cancelButtonTitle:@"OK" otherButtonTitles: nil] autorelease];

[alert show]; 
```

在这里，警报框将弹出消息“消息”，并有一个标题为“确定”的按钮，单击该按钮将关闭弹出窗口。检查[文档](http://developer.apple.com/iphone/library/documentation/UIKit/Reference/UIAlertView_Class/UIAlertView/UIAlertView.html)以了解您可以做的其他事情（更多按钮等）。

# sql-server - 在 Management Studio 2005 中编写所有存储过程的脚本

> ID：175703
> 
> 赞同：48
> 
> 时间：2008-10-06T19:02:16.820
> 
> 标签：sql-server, ssms

在 Enterprise Manager 中，您可以通过右键菜单对数据库中的所有 SP 编写脚本，有没有办法在 Management Studio 中执行此操作？

* * *

## 回答 #1

> 赞同：87
> 
> 时间：2008-10-06T19:04:36.673

您可以右键单击数据库并转到 Tasks -> Generate Scripts...

这将允许您使用特定选项编写所有或选定对象（模式、存储过程、表、用户和视图）的脚本。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-11-26T14:09:56.647

1.  转到 Microsoft SQL Server 管理工作室
2.  选择数据库
3.  右键单击选定的数据库
4.  选择“任务”
5.  选择“生成脚本”
6.  选择“下一步”
7.  选择/勾选“选择特定数据库对象”
8.  勾选“存储过程”
9.  选择“下一步”
10.  选择要保存文件的选项

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-10-06T19:04:47.407

当然。您需要做的就是单击对象资源管理器中的存储过程，然后在摘要窗格中突出显示所有存储过程。然后只需右键单击并选择您喜欢的脚本选项。

祝你好运

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-10-06T19:04:43.350

右键单击数据库，选择任务，选择生成脚本..，单击下一步，再次下一步，选择存储过程，下一步，全选，完成。

快！

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-10-06T19:04:47.110

如果您右键单击数据库名称，底部的选项是“生成脚本”，然后它将启动一个向导来为整个数据库或其中的特定对象生成脚本。

# sharepoint - SourceSafe（版本控制）和 SharePoint（协作）之间是否存在联系？

> ID：175705
> 
> 赞同：-2
> 
> 时间：2008-10-06T19:03:23.137
> 
> 标签：sharepoint, visual-sourcesafe

还是它们是两个不相关的不同应用程序？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-06T19:07:12.973

它们非常不同，尽管有些人将源代码管理提交列表或最新文件（head）推送到他们的团队 wiki（可能是 SharePoint）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-07T02:11:49.137

SourceSafe 和 SharePoint 没有连接，但 Team Foundation Server 和 SharePoint 有连接。对于您创建的每个新团队项目，Team Foundation Server 将创建一个作为 SharePoint (WSS) 站点的项目站点。您可以在此处存储您想要的任何项目信息，以及从该站点查看与您的项目相关的各种统计数据和报告。该站点对于非开发人员（没有 Visual Studio 和 Team Explorer 的任何人）能够查看有关项目的信息（例如工作项、报告、构建统计信息等）很有用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-06T19:18:27.927

它们不相关，因为 Source Safe 是由 MS 收购的另一家公司创建的。Team Foundation Server 和 SharePoint 是另一回事。我相信 Team Foundation Server 是一个扩展 WSS。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-10-06T19:05:32.053

我相信它们是不相关的，但都使用 SQL Server 作为后端。

# .net - 为什么 .NET 应用程序的内存使用量在最小化时似乎下降了？

> ID：175707
> 
> 赞同：11
> 
> 时间：2008-10-06T19:03:39.780
> 
> 标签：.net, memory, garbage-collection

例如，启动 Paint.NET。然后用任务管理器查看它的内存使用情况：在我的电脑上，它使用 36Mb。

然后最小化 Paint.NET：现在它只需要 1Mb 多一点。

每个 .NET 应用程序都会发生这种情况。最小化 .NET 应用程序时会发生什么？GC 发生了吗？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2008-10-06T19:06:32.927

任务管理器向您显示属于应用程序的内存量，当时恰好被分页到实际内存中。当您在 Windows 中最小化应用程序时，内核会自动修剪进程工作集以减少内存占用。此行为并非特定于 .NET 应用程序。

如果您查看进程“Private Bytes”值，这将更好地指示进程使用的内存量。修剪流程工作集时，此值不会更改。

Microsoft 在此知识库文章中提供了更多信息：http: [//support.microsoft.com/kb/293215](http://support.microsoft.com/kb/293215)

# vb.net - .dispose() 的最佳应用是什么

> ID：175717
> 
> 赞同：5
> 
> 时间：2008-10-06T19:05:51.087
> 
> 标签：vb.net

关于 .dispose() 方法的正确应用，这是我在 .NET 中从未完全掌握的内容。

说我有类似的东西

```
Public Class someClass()
  sub someMethod
    ' do some stuff tying up resources
  end sub
End Class

public class mainApp 
  dim _class as new SomeClass
  _class.someMethod()
End Class 
```

在所有情况下，实施 dispose 方法都是一种好习惯，如果是这样，应该在那里做什么？

如果不是每个类都应该有 dispose 方法（我的直觉说不应该），那么哪些类应该？我一直认为任何可能占用资源（即连接、数据读取器等）的东西都应该有一个 .dispose() 来取消分配这些资源。

另外，您将如何强制调用 .dispose() 方法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-06T19:15:49.600

这是一个相当长的答案，可以完全涵盖所有内容，所以希望没有人会介意我链接到[一篇希望能回答所有问题的博客文章](http://gregbeech.com/blogs/tech/archive/2007/03/07/implementing-and-using-the-idisposable-interface.aspx)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-06T19:10:56.460

我强烈推荐阅读MSDN 上的[清理非托管资源](http://msdn.microsoft.com/en-us/library/498928w2(VS.80).aspx)，它有文章涉及何时使用 Dispose 以及如何正确实现 IDisposable。您的直觉大部分是正确的，因为您很少需要实现 IDisposable，除非您的类使用非托管资源或者是实现 IDisposable 的对象的容器。

至于强制调用 Dispose，当您正确实现 IDisposable 接口时，您附加了一个终结器，该终结器调用 Dispose 以捕获那些忘记的落后者和异常类。

相关文章：

> **[实现 Dispose 方法](http://msdn.microsoft.com/en-us/library/fs2xkftw(VS.80).aspx)**
> 
> 描述用于释放非托管资源的 Dispose 方法的实现。
> 
> **[使用封装资源的对象](http://msdn.microsoft.com/en-us/library/3bwa4xa9(VS.80).aspx)**
> 
> 描述确保调用 Dispose 方法的方法，例如 C# using 语句（在 Visual Basic 中使用）。

*（编辑：添加了附加信息）*

在您的示例中，您有**SomeClass.SomeMethod**可以做一些工作，大概是使用资源。如果此资源不是类成员，最好将其包装在[using-statement 中](http://msdn.microsoft.com/en-us/library/yh598w02(VS.80).aspx)，并忘记 IDisposable 的可怕细节。

```
Public Class someClass()
  sub someMethod
    Using someResource As New ResourceType( arguments )
       ' no worries about IDisposable for someResource, as it is automatic
    End Using
  end sub
End Class 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-06T19:28:03.337

有很多关于 IDisposable 的错误信息。它是一种模式，有助于完成过去通过 C++ 中的析构函数完成的传统任务。问题在于，在 .NET 中，对象的销毁不是确定性的（当对象超出范围时它不会自动发生，而是在单独的低优先级线程上的垃圾收集时发生）。

除非您有需要以某种方式释放的资源，否则您不需要实现 Dispose。例如，如果您的任何私有数据成员实现了 Dispose，您可能也应该实现 Dispose 并在 Dispose 中对这些私有成员调用 Dispose。同样，您应该在 Dispose 中释放所有 PInvoke 句柄。

此外，垃圾收集时不会自动为您调用 Dispose 方法。这是最大的错误信息。您必须从 Destructor (C#) 或 Finalize (VB.NET) 调用 Dispose。这是实现 Dispose 的一个很好的模式：

```
public class Foo : IDisposable
{
   public Foo()
   {
      // Allocate some resource here
   }

   ~Foo()
   {
      Dispose( false );
   }

   public void Dispose()
   {
      Dispose( true );
   }

   private void Dispose( bool disposing )
   {
      // De-allocate resource here
      if ( disposing )
         GC.SuppressFinalize( this );
   }
} 
```

你调用 GC.SupressFinalize 的原因是，如果你的对象有一个终结器，你的对象实际上会被提升到下一代 GC，因为它必须在 GC 第一次运行时调用 Finalize，并且无法释放你的对象直到完成完成，因此实际上直到 GC 的第二次运行才释放内存。如果您手动调用 Dispose，那么您可以跳过终结器，从而允许您的对象在 GC 的第一次传递期间被释放。

要充分利用 Dispose，请使用 using 关键字：

```
using ( Foo f = new Foo() )
{
   // Do something with Foo
} 
```

这和你写这个完全一样：

```
Foo f;
try
{
   f = new Foo();
   // Do something with Foo
}
finally
{
   f.Dispose();
} 
```

有些人喜欢在他们的类中设置一个名为 _disposed 的布尔值，然后在每次方法调用期间检查该布尔值，如果在调用 Dispose 后尝试调用对象上的方法，则抛出异常。对于内部项目类，我通常认为这有点矫枉过正，但如果您正在创建一个供第 3 方使用的库，这可能是一件好事。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-06T19:08:10.257

该`Dispose()`方法用于及早清理任何资源。尽管垃圾收集器会为您回收任何未使用的内存，但您可以自行处理网络/数据库连接和文件句柄之类的事情。通常，您希望这些东西在不再需要时立即释放，因此您实现了一次性模式并利用`Using`语句在幕后的 try/finally 块中调用它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-06T19:11:28.127

一般来说，只要你的类打算打开某些东西，你就应该实现 IDisposable。无论是文件句柄、数据库连接还是占用大量内存或使应用程序处于不稳定状态的资源，实现 IDisposable 以指定将关闭这些资源。

您确实不能强制其他开发人员调用您的 dispose 方法，但是自动实现 IDisposable 意味着我们可以使用[Using](http://msdn.microsoft.com/en-us/library/yh598w02(VS.80).aspx)语句；一旦你养成了这种习惯，就很难改掉:)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-06T19:38:18.120

你应该在一个类中实现 IDisposable 如果类：

*   拥有一些其他实现 IDisposable 的对象
*   通过 P/Invoke 等非托管接口分配一些资源。

# c# - 有没有一种简单的方法来为 ScrollableControl.ScrollControlIntoView 方法设置动画？

> ID：175723
> 
> 赞同：2
> 
> 时间：2008-10-06T19:08:47.820
> 
> 标签：c#, .net, vb.net, winforms

我有一个表单，其中控件被动态添加到面板中。但是，当它们这样做时，它们会多次添加到折叠下方（容器底部）。.NET Framework 提供了这个 ScrollControlIntoView 方法很好，但是，为了增加可用性，如果有一种简单的动画方法也很好，这样用户就可以很容易地理解 Panel 是自动滚动的。

有没有人遇到过这种情况或对如何解决它有任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-06T19:44:03.553

您可以继承`Panel`、添加`Timer`和覆盖`ScrollIntoView()`，以便在新的`AnimatedScrollPanel`. 我很确定您必须这样做才能使用某些`protected`方法，例如`ScrollToControl()`which 返回 a `Point`(used by `ScrollIntoView`)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-07T14:14:59.987

@乔尔

谢谢！我明白了，在反射器的帮助下，做起来并不难。可能有优化它的方法，但这是我必须开始的。碰巧我需要在 FlowLayoutPanel 中使用此功能，但它适用于从 ScrollableControl 继承的任何内容。

**编辑：**由于@Joel B Fant 指出我没有删除委托，我更改了一些内容，而是无限期地保留计时器对象。我相信我已经通过将委托分配给 EventHandler 对象来减轻这种担忧，以便可以在其内部将其删除。

```
using System;
using System.Drawing;
using System.Reflection;
using System.Windows.Forms;

public class AnimatedScrollFlowLayoutPanel : FlowLayoutPanel
{
    public new void ScrollControlIntoView(Control activeControl)
    {
        if (((this.IsDescendant(activeControl) && this.AutoScroll) &&
            (this.HScroll || this.VScroll)) && (((activeControl != null) &&
            (ClientRectangle.Width > 0)) && (ClientRectangle.Height > 0)))
        {
            Point point = this.ScrollToControl(activeControl);
            int x = DisplayRectangle.X, y = DisplayRectangle.Y;
            bool scrollUp = x < point.Y;
            bool scrollLeft = y < point.X;

            Timer timer = new Timer();
            EventHandler tickHandler = null;
            tickHandler = delegate {
                int jumpInterval = ClientRectangle.Height / 10;

                if (x != point.X || y != point.Y)
                {
                    y = scrollUp ?
                        Math.Min(point.Y, y + jumpInterval) :
                        Math.Max(point.Y, y - jumpInterval);
                    x = scrollLeft ?
                        Math.Min(point.X, x + jumpInterval) :
                        Math.Max(point.X, x - jumpInterval);

                    this.SetScrollState(8, false);
                    this.SetDisplayRectLocation(x, y);
                    this.SyncScrollbars(true);
                }
                else
                {
                    timer.Stop();
                    timer.Tick -= tickHandler;
                }
            };

            timer.Tick += tickHandler;
            timer.Interval = 5;
            timer.Start();
        }
    }

    internal bool IsDescendant(Control descendant)
    {
        MethodInfo isDescendantMethod = typeof(Control).GetMethod(
            "IsDescendant", BindingFlags.NonPublic | BindingFlags.Instance);
        return (bool)isDescendantMethod.Invoke(this, new object[] { descendant });
    }

    private void SyncScrollbars(bool autoScroll)
    {
        MethodInfo syncScrollbarsMethod = typeof(ScrollableControl).GetMethod(
            "SyncScrollbars", BindingFlags.NonPublic | BindingFlags.Instance);
        syncScrollbarsMethod.Invoke(this, new object[] { autoScroll });
    }
} 
```

# c# - c#：在运行时创建新设置

> ID：175726
> 
> 赞同：23
> 
> 时间：2008-10-06T19:09:28.693
> 
> 标签：c#, winforms

c# windows 窗体：如何在运行时创建新设置，以便将它们永久保存为 Settings.Default.-- 值？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2011-09-30T10:19:40.570

Just in case that still matters to anyone:

You can dynamically add settings through `Settings.Default.Properties.Add(...)` and have these also persisted in the local storage after saving (I had those entries reflected in the roaming file).

Nevertheless it seems that the dynamically added settings keep missing in the `Settings.Default.Properties` collecion after loading again.

I could work around this problem by adding the dynamic property before first accessing it. Example (notice that I "create" my dynamic setting from a base setting):

```
// create new setting from a base setting:
var property = new SettingsProperty(Settings.Default.Properties["<baseSetting>"]);
property.Name = "<dynamicSettingName>";
Settings.Default.Properties.Add(property);
// will have the stored value:
var dynamicSetting = Settings.Default["<dynamicSettingName>"]; 
```

I don't know if this is supported by Microsoft as the documentation is very rare on this topic.

Problem is also described here [http://www.vbdotnetforums.com/vb-net-general-discussion/29805-my-settings-run-time-added-properties-dont-save.html#post88152](http://www.vbdotnetforums.com/vb-net-general-discussion/29805-my-settings-run-time-added-properties-dont-save.html#post88152) with some solution offered here [http://msdn.microsoft.com/en-us/library/saa62613(v=VS.100).aspx](http://msdn.microsoft.com/en-us/library/saa62613(v=VS.100).aspx) (see Community Content - headline "How to Create / Save / Load Dynamic (at Runtime) Settings"). But this is VB.NET.

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-05-14T13:29:08.697

除了 John 的保存解决方案之外，加载的正确方法是添加属性，然后对您的设置执行 Reload()。

您的动态设置将在那里！

对于一个完整的例子，在库代码中使用是有效的，因为你可以在 .. 中传递设置。

```
ApplicationSettingsBase settings = passed_in;
SettingsProvider sp = settings.Providers["LocalFileSettingsProvider"];
SettingsProperty p = new SettingsProperty("your_prop_name");
your_class conf = null;
p.PropertyType = typeof( your_class );
p.Attributes.Add(typeof(UserScopedSettingAttribute),new UserScopedSettingAttribute());
p.Provider = sp;
p.SerializeAs = SettingsSerializeAs.Xml;
SettingsPropertyValue v = new SettingsPropertyValue( p );
settings.Properties.Add( p );

settings.Reload();
conf = (your_class)settings["your_prop_name"];
if( conf == null )
{
   settings["your_prop_name"] = conf = new your_class();
   settings.Save();
} 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-10-06T19:11:19.797

由于设置类是在构建时生成的（或者实际上，每当您从设计器中更新设置文件时），您不能将此机制用于动态场景。但是，您可以将一些集合或字典添加到应用程序设置并动态修改。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-01-27T01:18:15.613

您不能直接添加设置（至少在运行时不编辑配置 XML 的情况下不能），但您可以伪造它。

在我的例子中，我在表单上有一组相同的自定义控件，我想存储每个控件的运行时状态。我需要存储每个控件的状态，因为每个控件都有不同的数据。

我创建了一个名为**ControlData**的新 StringCollection 设置，并将我自己的数据放在那里。然后我从该列表中加载数据并使用它来初始化我的控件。

该列表如下所示：

```
Box1Text=A
Box1List=abc;def;foo;bar;
Box2Text=hello
Box2List=server1;server2; 
```

在我的启动代码中，我通读了这样的键/值对：

```
foreach (string item in Properties.Settings.Default.ControlData) {
  string[] parts=item.split('='); 
```

零件[0] 将具有键，零件[1] 将具有值。您现在可以根据这些数据进行操作。

在关机阶段，我做相反的事情将数据写回列表。（遍历表单中的所有控件并将它们的设置添加到 ControlData.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-06T19:29:55.390

How would you access the new settings that you have created? The point of the Visual Studio settings designer is that you can write code that uses these settings with compile-time checking of your code. If you want to dynamically create new settings for your app to use, you will also need to dynamically load them. For dynamic settings, you may want to look at the System.Configuration assembly, notably [ConfigurationSection](http://msdn.microsoft.com/en-us/library/system.configuration.configurationsection.aspx). You can create a custom configuration section with that, which you could use for dynamic setting addition/removal. You might use a [ConfigurationCollection](http://msdn.microsoft.com/en-us/library/system.configuration.configurationcollectionattribute.aspx) for that dynamic addition/removal.

INI files eh? Google turned up [this INI library](http://www.mentalis.org/soft/class.qpx?id=6) for .NET.

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-08-05T22:55:14.063

您可以做的是创建一个新的注册表项。将新键命名为“您的程序设置”。

```
RegistryKey ProgSettings = Registry.CurrentUser.OpenSubKey("Software", true);
ProgSettings.CreateSubKey("Your Program settings");    
ProgSettings.Close(); 
```

现在您可以添加字符串标识符和值。

```
RegistryKey ProgSettings = Registry.CurrentUser.OpenSubKey("Software\\Your Program settings", true);
ProgSettings.SetValue("Setting Name", value); // store settings    
string settings = ProgSettings.GetValue("Setting Name", false); // retreave settings    
ProgSettings.DeleteValue("Setting Name", false); 
```

完成后请务必关闭注册表项，以避免与可能写入注册表的程序的其他部分发生冲突。

许多商业软件应用程序使用这些方法。stackoverflow 有许多关于写入和读取注册表的示例。这比修改创建设置时使用的 appconfig.xml 文件要容易得多。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2020-06-02T15:01:23.700

我花了很长时间使用这里的前两个答案加上这个链接（[在运行时创建新设置并在重新启动后阅读](https://stackoverflow.com/questions/26018606/create-new-settings-on-runtime-and-read-after-restart/42052862#42052862)）让它最终工作。

首先，设定你的期望。这里的答案将创建一个新的用户设置，您可以在下次启动应用程序时获得它的值。但是，您以这种方式创建的设置不会出现在设置设计器中。事实上，当您重新启动应用程序并尝试访问代码中的设置时，它不会找到它。但是，您通过代码创建的设置保存在文件系统某处的 user.config 文件（例如 jDoe.config）中。要访问此值，您必须再次添加设置。

这是我的一个工作示例：

```
 private void FormPersistence_Load(object sender, EventArgs e)
        {
            StartPosition = FormStartPosition.Manual;
            // Set window location
            var exists = Settings.Default.Properties.OfType<SettingsProperty>().Any(p => p.Name == Name + "Location");
            if (exists)
            {
                this.Location = (Point)Settings.Default[Name + "Location"];
            }
            else
            {
                var property = new SettingsProperty(Settings.Default.Properties["baseLocation"]);
                property.Name = Name + "Location";
                Settings.Default.Properties.Add(property);
                Settings.Default.Reload();
                this.Location = (Point)Settings.Default[Name + "Location"];
            }
        } 
```

注意：我的新设置名称将在运行时解析。Name 就是 this.Name，它是表单的名称。这是其他表单可以继承的基本表单，因此所有子表单都将能够记住它们的位置。
baseLocation 是我在设置设计器中手动创建的设置。我的新设置是同一类型。这样我就不必担心代码中的提供者、类型等。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-06T19:34:14.680

I see how what I wanted was the wrong idea. I'm porting a c++ app over to c# and it has a lot of ini file settings and I was looking for a shortcut to add them in. I'm lazy.

# asp.net - 用于构建调查应用程序的工具/组件

> ID：175732
> 
> 赞同：3
> 
> 时间：2008-10-06T19:11:08.800
> 
> 标签：asp.net, survey, dynamic-pages

我们正在设计一个具有以下功能的调查应用程序

1.  用户将能够从一组预定义的问题中选择问题。
2.  每个问题都定义了一个问题类型，该类型决定了答案的类型（多项选择、数据库查找、自由文本等）
3.  用户可以在每个部分中创建具有多个问题的部分层次结构。
4.  调查的答复将存储到 SQL 服务器数据库中。

还需要从每个调查响应中生成输出文档。

我们计划使用 ASP.net 来实现这个应用程序。

我正在寻找可以帮助我们减少开发工作的建议。是否有任何我们可以根据需要定制的商业/开源应用程序？是否有任何现成的组件可以帮助创建动态 ASP.net 页面？我只对可以在本地托管的应用程序感兴趣，因为它必须集成到现有的应用程序中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-06T19:15:30.617

这可能不完全适合，但值得一看：[Surveymonkey](http://www.surveymonkey.com/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-09T22:21:35.557

除非反馈系统是您企业的核心竞争力，否则您最好使用第三方系统。建立一个调查系统并不像看起来那么容易，尤其是在报告方面。当然，您可以轻松制作一些简单的报告，但是客户（或您的老板）想要的每一次更改都是您将其投入调查和报告引擎的时候了实际业务。帮自己一个忙，把这个头疼的事情外包给第三方。

如果您的需求很简单，那么像 SurveyMonkey 这样的免费赠品网站就可以了。如果您正在寻找更复杂的东西，例如支持电话调查、更高级的报告等，您需要支付更高级的服务，例如*（咳嗽）* [我工作的那个](http://www.mshare.net)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-20T01:38:02.800

[http://www.codeplex.com/WebSurvey](http://www.codeplex.com/WebSurvey) looks like a good place to start

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-06-13T19:13:40.613

Try [Zodiac.NET Survey Engine](http://mentor-logic.com/products/zodiacnet/profile.aspx). It can be integrated direct in your ASP.NET website. No much work needed.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-06T19:19:41.357

[NSurvey](http://www.nsurvey.org/)曾经为此而存在，但我认为他们已经完全商业化了。如果您可以挖掘最后一个开源版本，这可能是一个很好的起点。

否则，不要构建它。订阅[五福](http://wufoo.com)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-08T05:00:45.160

另一种选择是让用户使用[InfoPath](http://en.wikipedia.org/wiki/InfoPath)或[Adob​​e Designer](http://en.wikipedia.org/wiki/Adobe_Designer)创建分发给调查参与者（通过电子邮件或网站）的调查表格。

使用 InfoPath，您可以将响应回调到您编写的 Web 服务。或者，使用这两个包，您可以将响应通过电子邮件发送回特定地址，并且可以解析和处理发送的 XML。

# sql - 如何创建一个 MySQL JOIN 查询以仅选择一个表中的行，而另一个表中存在对该行的一定数量的引用？

> ID：175733
> 
> 赞同：4
> 
> 时间：2008-10-06T19:11:15.383
> 
> 标签：sql, mysql

我的数据库中有两个表，称为*rating*和*movies*。

**评分：**

> `| id | movie_id | rating |`

**电影：**

> `| id | title |`

典型的电影记录可能是这样的：

> `| 4 | Cloverfield (2008) |`

而且Cloverfield可能有好几条评分记录，像这样：

> `| 21 | 4 | 3 |`（评分 21，电影编号 4，评分为 3）
> 
> `| 22 | 4 | 2 |`（评分 22，电影编号 4，评分为 2）
> 
> `| 23 | 4 | 5 |`（第 4 部电影的评分为 23k，评分为 5）

**问题：**

如何创建一个 JOIN 查询以仅选择电影表中`x`评级表中评级数超过评级数的行？例如，在上面的示例中，如果 Cloverfield 在评级表中只有一个评级并且`x`为 2，则不会被选中。

感谢您的任何帮助或建议！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-06T19:13:58.700

使用 HAVING 子句。沿着这些思路：

```
SELECT movies.id, movies.title, COUNT(ratings.id) AS num_ratings 
  FROM movies 
  LEFT JOIN ratings ON ratings.movie_id=movies.id 
  GROUP BY movies.id 
  HAVING num_ratings > 5; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-06T19:13:00.637

你可能想要使用 MySQL 的 HAVING 子句

[http://www.severnsolutions.co.uk/twblog/archive/2004/10/03/havingmysql](http://www.severnsolutions.co.uk/twblog/archive/2004/10/03/havingmysql)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-06T19:33:22.577

JOIN 方法有些生硬和混乱，因为这并不是它的本意。最直接（在我看来，易于人类解析）的方法使用 EXISTS：

```
SELECT whatever
  FROM movies m
 WHERE EXISTS( SELECT COUNT(*) 
                 FROM reviews
                WHERE movie_id  = m.id
               HAVING COUNT(*)  > xxxxxxxx ) 
```

Read it out loud -- SELECT something FROM movies WHERE there EXIST rows in Reviews where the movie_id matches and there are > xxxxxx rows

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-06T19:27:40.480

```
SELECT * FROM movies 
INNER JOIN
(SELECT movie_id, COUNT(*) as num_ratings from ratings GROUP BY movie_id) as movie_counts
ON movies.id = movie_counts.movie_id
WHERE num_ratings > 3; 
```

这只会让你获得超过 3 个评级的电影，要真正获得评级需要另一个加入。子查询优于 HAVING 的优点是您可以同时聚合评分。如 (SELECT movie_id, COUNT(*), AVG(rating) as average_move_rating ...)

编辑：哎呀，您可以使用 have 方法进行聚合。:)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-06T19:27:01.670

上述解决方案适用于您提到的场景。我的建议可能对您的想法有些过分，但对于其他情况可能会很方便：

1.  仅对评级表中的子查询数量超过您需要的数量（再次使用 tha group by having 子句）：

    通过具有计数 (*) > x 的电影 ID 从评级组中选择电影 ID

2.  将该子查询与电影表连接起来

    从电影中选择 movies.id 作为 MoviesWRatings 加入 movies.id = MoviesWRatings.movi​​e_id

当您对子查询执行更多操作时，这可能会有所帮助。（不确定语法是否适用于 MySQL，如有必要，请修复。）

# c++ - WS_EX_TOOLWINDOW 在窗口销毁时跳转到背景

> ID：175738
> 
> 赞同：0
> 
> 时间：2008-10-06T19:12:32.103
> 
> 标签：c++, winapi, sdk

奇怪的问题：

1.  打开一个大记事本窗口
2.  创建一个工具窗口（样式 WS_EX_TOOLWINDOW）
3.  再创建 2 个窗口（正常重叠）（WS_OVERLAPPED）
4.  关闭这两个重叠的窗口（桌面或工具窗口的子窗口）
5.  工具窗口跳到记事本窗口后面

有谁知道为什么会这样？或者我可能做错了什么？我会说“Windows 中的错误”，但这种情况很少见。

回答问题：

它不是一个对话窗口，而是一个完整的窗口。如果我让它有正确的孩子（即：不是桌面的孩子），孩子的任务栏条目不会出现（可能很容易修复），但无论哪种方式，错误仍然会发生。

我已经包含了显示问题的示例代码。我希望我只是创建错误的窗口或需要回复我没有回复的消息。

在此示例中，将打开一个工具窗口（没有任务栏条目，这是想要的）。然后单击该窗口，将打开一个子窗口。您单击子窗口，将打开另一个窗口。然后关闭新的子窗口和原始窗口，而不是获得焦点，而是立即跳到其他窗口（记事本等）的后面。

谢谢你的帮助！

用于澄清的示例代码：

```
// WindowToback.cpp : Defines the entry point for the application.
//

#include "stdafx.h"
#include "WindowToback.h"

// Global Variables:
HINSTANCE g_instance;
HWND g_mainWnd = NULL;

wchar_t *szWindowClass = L"WindowToBackSub";
wchar_t *szWindowClass2 = L"WindowToBackSub2";

ATOM                MyRegisterClass(HINSTANCE hInstance);
BOOL                InitInstance(HINSTANCE, int);
LRESULT CALLBACK    WndProc(HWND, UINT, WPARAM, LPARAM);
LRESULT CALLBACK    WndProc2(HWND, UINT, WPARAM, LPARAM);
INT_PTR CALLBACK    About(HWND, UINT, WPARAM, LPARAM);

int APIENTRY _tWinMain(HINSTANCE hInstance,HINSTANCE hPrevInstance,LPTSTR lpCmdLine,int nCmdShow)
{
    UNREFERENCED_PARAMETER(hPrevInstance);
    UNREFERENCED_PARAMETER(lpCmdLine);

    MSG msg;

    MyRegisterClass(hInstance);

// Perform application initialization:
if (!InitInstance (hInstance, nCmdShow))
{
    return FALSE;
}

// Main message loop:
while (GetMessage(&msg, NULL, 0, 0))
{
    TranslateMessage(&msg);
    DispatchMessage(&msg);
}

return (int) msg.wParam;
}

ATOM MyRegisterClass(HINSTANCE hInstance)
{
WNDCLASSEX wcex;

wcex.cbSize = sizeof(WNDCLASSEX);

wcex.style          = CS_HREDRAW | CS_VREDRAW;
wcex.lpfnWndProc    = WndProc;
wcex.cbClsExtra     = 0;
wcex.cbWndExtra     = 0;
wcex.hInstance      = hInstance;
wcex.hIcon          = LoadIcon(hInstance, MAKEINTRESOURCE(IDI_WINDOWTOBACK));
wcex.hCursor        = LoadCursor(NULL, IDC_ARROW);
wcex.hbrBackground  = (HBRUSH)(COLOR_WINDOW+1);
wcex.lpszMenuName   = MAKEINTRESOURCE(IDC_WINDOWTOBACK);
wcex.lpszClassName  = szWindowClass;
wcex.hIconSm        = LoadIcon(wcex.hInstance, MAKEINTRESOURCE(IDI_SMALL));

RegisterClassEx(&wcex);

wcex.lpfnWndProc    = WndProc2;
wcex.lpszClassName  = szWindowClass2;

return RegisterClassEx(&wcex);
}

BOOL InitInstance(HINSTANCE hInstance, int nCmdShow)
{
   g_instance = hInstance; 
   g_mainWnd = CreateWindowEx(WS_EX_TOOLWINDOW,szWindowClass, szWindowClass,WS_OVERLAPPED,
      CW_USEDEFAULT, 0, CW_USEDEFAULT, 0, NULL, NULL, hInstance, NULL);

   if (!g_mainWnd) return FALSE;

   ShowWindow(g_mainWnd, nCmdShow);
   UpdateWindow(g_mainWnd);

   return TRUE;
}

LRESULT CALLBACK WndProc(HWND hWnd, UINT message, WPARAM wParam, LPARAM lParam)
{
switch (message)
{
    case WM_LBUTTONDOWN:
    {
        HWND l_hwnd = CreateWindow(szWindowClass2, szWindowClass2, WS_VISIBLE | WS_OVERLAPPEDWINDOW,
            CW_USEDEFAULT, 0, CW_USEDEFAULT, 0, NULL, NULL, g_instance, NULL);
        ShowWindow(l_hwnd,SW_SHOW);
        break;
    }

    case WM_DESTROY:
    {
        PostQuitMessage(0);
        return 0;
    }
}

return DefWindowProc(hWnd, message, wParam, lParam);
}

LRESULT CALLBACK WndProc2(HWND hWnd, UINT message, WPARAM wParam, LPARAM lParam)
{
switch (message)
{
    case WM_LBUTTONDOWN:
    {
        HWND l_hwnd = CreateWindow(szWindowClass2, szWindowClass2, WS_VISIBLE | WS_OVERLAPPEDWINDOW,
            CW_USEDEFAULT, 0, CW_USEDEFAULT, 0, NULL, NULL, g_instance, NULL);
        ShowWindow(l_hwnd,SW_SHOW);
    }
    break;
}

return DefWindowProc(hWnd, message, wParam, lParam); 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-09-29T15:46:20.013

这并不奇怪。事实上，这正是我所期望的行为。

你的工具窗口没有跳下来；而是记事本跳起来了。

您关闭了已激活的窗口。系统将激活 z 顺序中的下一个最高顶级窗口。在这方面，您的工具窗口不算作顶级窗口（这是工具窗口的一部分）。所以记事本被激活，它来到了顶部。

如果您希望激活您的工具窗口，那么您可能并不真正需要工具窗口。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-07T22:23:26.647

这三个窗口是另一个主窗口的对话框，还是它们本身的应用程序？

如果它们是对话框窗口，那么我会检查它们的父窗口是否正确分配。

如果它们是应用程序窗口，那么我会检查它们是否出现在任务栏中。

如果没有关于问题的更多信息，很难给出更有意义的答案。

# javascript - 如何检查字符串是否为有效数字？

> ID：175739
> 
> 赞同：1602
> 
> 时间：2008-10-06T19:12:52.413
> 
> 标签：javascript, validation, numeric

我希望在与旧的 VB6`IsNumeric()`函数相同的概念空间中有一些东西？

* * *

## 回答 #1

> 赞同：2846
> 
> 时间：2008-10-06T19:24:20.287

**2020 年 10 月 2 日：**请注意，许多基本方法都充满了细微的错误（例如空格、隐式部分解析、基数、数组强制等），这里的许多答案都没有考虑到这些错误。以下实现可能对您有用，但请注意，它不支持除小数点“ `.`”以外的数字分隔符：

```
function isNumeric(str) {
  if (typeof str != "string") return false // we only process strings!  
  return !isNaN(str) && // use type coercion to parse the _entirety_ of the string (`parseFloat` alone does not do this)...
         !isNaN(parseFloat(str)) // ...and ensure strings of whitespace fail
} 
```

* * *

## 要检查变量（包括字符串）是否为数字，请检查它是否不是数字：

无论变量内容是字符串还是数字，这都有效。

```
isNaN(num)         // returns true if the variable does NOT contain a valid number 
```

### 例子

```
isNaN(123)         // false
isNaN('123')       // false
isNaN('1e10000')   // false (This translates to Infinity, which is a number)
isNaN('foo')       // true
isNaN('10px')      // true
isNaN('')          // false
isNaN(' ')         // false
isNaN(false)       // false 
```

当然，如果需要，您可以否定这一点。例如，要实现`IsNumeric`您给出的示例：

```
function isNumeric(num){
  return !isNaN(num)
} 
```

## 要将包含数字的字符串转换为数字：

仅当字符串*仅*包含数字字符时才有效，否则返回`NaN`.

```
+num               // returns the numeric value of the string, or NaN 
                   // if the string isn't purely numeric characters 
```

### 例子

```
+'12'              // 12
+'12.'             // 12
+'12..'            // NaN
+'.12'             // 0.12
+'..12'            // NaN
+'foo'             // NaN
+'12px'            // NaN 
```

## 将字符串松散地转换为数字

用于将 '12px' 转换为 12，例如：

```
parseInt(num)      // extracts a numeric value from the 
                   // start of the string, or NaN. 
```

### 例子

```
parseInt('12')     // 12
parseInt('aaa')    // NaN
parseInt('12px')   // 12
parseInt('foo2')   // NaN      These last three may
parseInt('12a5')   // 12       be different from what
parseInt('0x10')   // 16       you expected to see. 
```

## 花车

请记住，与 , 不同`+num`（`parseInt`顾名思义）将通过切除小数点后的所有内容将浮点数转换为整数（如果`parseInt()` *由于*这种行为而要使用，则[最好使用另一种方法](https://parsebox.io/dthree/gyeveeygrngl)） ：

```
+'12.345'          // 12.345
parseInt(12.345)   // 12
parseInt('12.345') // 12 
```

## 空字符串

空字符串可能有点违反直觉。`+num`将空字符串或带空格的字符串转换为零，并`isNaN()`假设相同：

```
+''                // 0
+'   '             // 0
isNaN('')          // false
isNaN('   ')       // false 
```

但`parseInt()`不同意：

```
parseInt('')       // NaN
parseInt('   ')    // NaN 
```

* * *

## 回答 #2

> 赞同：131
> 
> 时间：2014-06-27T17:13:53.087

如果您只是想检查一个字符串是否是一个整数（没有小数位），那么正则表达式是一个不错的方法。其他方法，例如`isNaN`对于如此简单的事情来说太复杂了。

```
function isNumeric(value) {
    return /^-?\d+$/.test(value);
}

console.log(isNumeric('abcd'));         // false
console.log(isNumeric('123a'));         // false
console.log(isNumeric('1'));            // true
console.log(isNumeric('1234567890'));   // true
console.log(isNumeric('-23'));          // true
console.log(isNumeric(1234));           // true
console.log(isNumeric(1234n));          // true
console.log(isNumeric('123.4'));        // false
console.log(isNumeric(''));             // false
console.log(isNumeric(undefined));      // false
console.log(isNumeric(null));           // false 
```

只允许*正*整数使用这个：

```
function isNumeric(value) {
    return /^\d+$/.test(value);
}

console.log(isNumeric('123'));          // true
console.log(isNumeric('-23'));          // false 
```

* * *

## 回答 #3

> 赞同：67
> 
> 时间：2008-10-06T19:20:25.083

你可以走正则表达式的方式：

```
var num = "987238";

if(num.match(/^-?\d+$/)){
  //valid integer (positive or negative)
}else if(num.match(/^\d+\.\d+$/)){
  //valid float
}else{
  //not valid number
} 
```

* * *

## 回答 #4

> 赞同：61
> 
> 时间：2018-10-25T09:52:31.120

这个问题的公认答案有很多缺陷（正如其他几个用户所强调的那样）。这是在 javascript 中处理它的最简单且经过验证的方法之一：

```
function isNumeric(n) {
  return !isNaN(parseFloat(n)) && isFinite(n);
} 
```

下面是一些很好的测试用例：

```
console.log(isNumeric(12345678912345678912)); // true
console.log(isNumeric('2 '));                 // true
console.log(isNumeric('-32.2 '));             // true
console.log(isNumeric(-32.2));                // true
console.log(isNumeric(undefined));            // false

// the accepted answer fails at these tests:
console.log(isNumeric(''));                   // false
console.log(isNumeric(null));                 // false
console.log(isNumeric([]));                   // false 
```

* * *

## 回答 #5

> 赞同：49
> 
> 时间：2016-03-02T22:56:18.057

如果你真的想确保一个字符串只包含一个数字、任何数字（整数或浮点数）以及完全是一个数字，你*不能*使用`parseInt()`/ `parseFloat()`、`Number()`或单独使用`!isNaN()`。请注意，这`!isNaN()`实际上是在返回`true`时`Number()`返回一个数字，以及`false`何时返回`NaN`，所以我将把它排除在讨论的其余部分之外。

问题在于，如果字符串包含任何数字，它将返回一个数字，`parseFloat()`即使该字符串不只包含*一个**数字*：

```
parseFloat("2016-12-31")  // returns 2016
parseFloat("1-1") // return 1
parseFloat("1.2.3") // returns 1.2 
```

问题`Number()`在于，如果传递的值根本不是数字，它将返回一个数字！

```
Number("") // returns 0
Number(" ") // returns 0
Number(" \u00A0   \t\n\r") // returns 0 
```

滚动自己的正则表达式的问题在于，除非您创建精确的正则表达式来匹配 Javascript 识别的浮点数，否则您将错过案例或识别不应该的案例。即使你可以推出自己的正则表达式，为什么？有更简单的内置方法可以做到这一点。

然而，事实证明`Number()`(and `isNaN()`) 对于每`parseFloat()`一种不应该返回数字的情况都是正确的，反之亦然。因此，要确定一个字符串是否真的完全是一个数字，请调用这两个函数并查看它们是否*都*返回 true：

```
function isNumber(str) {
  if (typeof str != "string") return false // we only process strings!
  // could also coerce to string: str = ""+str
  return !isNaN(str) && !isNaN(parseFloat(str))
} 
```

* * *

## 回答 #6

> 赞同：26
> 
> 时间：2008-10-06T19:14:51.130

试试[isNan 函数](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/isNaN)：

> isNaN() 函数判断一个值是否为非法数字（Not-a-Number）。
> 
> 如果值等于 NaN，则此函数返回 true。否则返回false。
> 
> 此函数不同于数字特定的[Number.isNaN()](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number/isNaN)方法。
> 
>   全局 isNaN() 函数，将测试值转换为数字，然后对其进行测试。
> 
> Number.isNan() 不会将值转换为数字，并且不会为任何非数字类型的值返回 true...

* * *

## 回答 #7

> 赞同：17
> 
> 时间：2013-10-02T11:28:33.260

老问题，但在给定的答案中缺少几点。

**科学计数法。**

`!isNaN('1e+30')`是`true`，但是在大多数情况下，当人们询问数字时，他们不想匹配`1e+30`.

**大的浮点数可能表现得很奇怪**

观察（使用 Node.js）：

```
> var s = Array(16 + 1).join('9')
undefined
> s.length
16
> s
'9999999999999999'
> !isNaN(s)
true
> Number(s)
10000000000000000
> String(Number(s)) === s
false
> 
```

另一方面：

```
> var s = Array(16 + 1).join('1')
undefined
> String(Number(s)) === s
true
> var s = Array(15 + 1).join('9')
undefined
> String(Number(s)) === s
true
> 
```

因此，如果您期望`String(Number(s)) === s`，那么最好将您的字符串限制为最多 15 位（在省略前导零之后）。

**无穷**

```
> typeof Infinity
'number'
> !isNaN('Infinity')
true
> isFinite('Infinity')
false
> 
```

鉴于这一切，检查给定的字符串是一个满足以下所有条件的数字：

*   非科学记数法
*   可预测的转换`Number`和返回`String`
*   有限

不是一件容易的事。这是一个简单的版本：

```
 function isNonScientificNumberString(o) {
    if (!o || typeof o !== 'string') {
      // Should not be given anything but strings.
      return false;
    }
    return o.length <= 15 && o.indexOf('e+') < 0 && o.indexOf('E+') < 0 && !isNaN(o) && isFinite(o);
  } 
```

然而，即使是这一点也远未完成。此处不处理前导零，但它们确实会影响长度测试。

* * *

## 回答 #8

> 赞同：16
> 
> 时间：2017-02-21T00:00:54.117

我已经测试过，迈克尔的解决方案是最好的。投票给他上面的答案（在此页面中搜索“如果您真的想确保一个字符串”以找到它）。本质上，他的回答是这样的：

```
function isNumeric(num){
  num = "" + num; //coerce num to be a string
  return !isNaN(num) && !isNaN(parseFloat(num));
} 
```

它适用于我在此处记录的每个测试用例： [https ://jsfiddle.net/wggehvp9/5/](https://jsfiddle.net/wggehvp9/5/)

对于这些边缘情况，许多其他解决方案都失败了：''、null、""、true 和 []。理论上，您可以使用它们，并进行适当的错误处理，例如：

```
return !isNaN(num); 
```

或者

```
return (+num === +num); 
```

对 /\s/、null、""、true、false、[]（和其他？）进行特殊处理

* * *

## 回答 #9

> 赞同：14
> 
> 时间：2019-10-24T22:50:42.313

# 2019：包括 ES3、ES6 和 TypeScript 示例

也许这已经被重新讨论了太多次，但是我今天也和这个打了一架，想发布我的答案，因为我没有看到任何其他简单或彻底的答案：

## ES3

```
var isNumeric = function(num){
    return (typeof(num) === 'number' || typeof(num) === "string" && num.trim() !== '') && !isNaN(num);  
} 
```

## ES6

```
const isNumeric = (num) => (typeof(num) === 'number' || typeof(num) === "string" && num.trim() !== '') && !isNaN(num); 
```

## 打字稿

```
const isNumeric = (num: any) => (typeof(num) === 'number' || typeof(num) === "string" && num.trim() !== '') && !isNaN(num as number); 
```

这看起来很简单，涵盖了我在许多其他帖子中看到的所有基础并自己想出了：

```
// Positive Cases
console.log(0, isNumeric(0) === true);
console.log(1, isNumeric(1) === true);
console.log(1234567890, isNumeric(1234567890) === true);
console.log('1234567890', isNumeric('1234567890') === true);
console.log('0', isNumeric('0') === true);
console.log('1', isNumeric('1') === true);
console.log('1.1', isNumeric('1.1') === true);
console.log('-1', isNumeric('-1') === true);
console.log('-1.2354', isNumeric('-1.2354') === true);
console.log('-1234567890', isNumeric('-1234567890') === true);
console.log(-1, isNumeric(-1) === true);
console.log(-32.1, isNumeric(-32.1) === true);
console.log('0x1', isNumeric('0x1') === true);  // Valid number in hex
// Negative Cases
console.log(true, isNumeric(true) === false);
console.log(false, isNumeric(false) === false);
console.log('1..1', isNumeric('1..1') === false);
console.log('1,1', isNumeric('1,1') === false);
console.log('-32.1.12', isNumeric('-32.1.12') === false);
console.log('[blank]', isNumeric('') === false);
console.log('[spaces]', isNumeric('   ') === false);
console.log('null', isNumeric(null) === false);
console.log('undefined', isNumeric(undefined) === false);
console.log([], isNumeric([]) === false);
console.log('NaN', isNumeric(NaN) === false); 
```

您还可以尝试自己的`isNumeric`功能，然后在这些用例中过去并扫描所有这些用例的“真”。

或者，查看每个返回的值：

[![针对 <code>isNumeric()</code> 的每个测试的结果](https://i.stack.imgur.com/4MTpf.png)](https://i.stack.imgur.com/4MTpf.png)

* * *

## 回答 #10

> 赞同：11
> 
> 时间：2015-03-13T09:31:30.107

将参数传递给其构造函数时，可以使用[Number的结果。](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)

如果参数（字符串）无法转换为数字，则返回 NaN，因此您可以确定提供的字符串是否为有效数字。

注意事项：注意当传递空字符串或 `'\t\t'`and `'\n\t'`as Number时会返回0；传递 true 将返回 1，而 false 返回 0。

```
 Number('34.00') // 34
    Number('-34') // -34
    Number('123e5') // 12300000
    Number('123e-5') // 0.00123
    Number('999999999999') // 999999999999
    Number('9999999999999999') // 10000000000000000 (integer accuracy up to 15 digit)
    Number('0xFF') // 255
    Number('Infinity') // Infinity  

    Number('34px') // NaN
    Number('xyz') // NaN
    Number('true') // NaN
    Number('false') // NaN

    // cavets
    Number('    ') // 0
    Number('\t\t') // 0
    Number('\n\t') // 0 
```

* * *

## 回答 #11

> 赞同：10
> 
> 时间：2017-01-09T10:57:15.880

也许有一两个遇到这个问题的人需要比平时**更严格的检查（就像我一样）。**在这种情况下，这可能很有用：

```
if(str === String(Number(str))) {
  // it's a "perfectly formatted" number
} 
```

谨防！这将拒绝像`.1`, `40.000`, `080`,之类的字符串`00.1`。它非常挑剔 - 字符串必须与该测试通过的数字的“**最小完美形式”匹配。**

它使用`String`and`Number`构造函数将字符串转换为数字并再次返回，从而检查 JavaScript 引擎的“完美最小形式”（使用初始`Number`构造函数转换为的形式）是否与原始字符串匹配。

* * *

## 回答 #12

> 赞同：7
> 
> 时间：2017-05-15T12:39:23.797

为什么jQuery的实现不够好？

```
function isNumeric(a) {
    var b = a && a.toString();
    return !$.isArray(a) && b - parseFloat(b) + 1 >= 0;
}; 
```

Michael 提出了这样的建议（尽管我在这里偷了“user1691651 - John”的修改版本）：

```
function isNumeric(num){
    num = "" + num; //coerce num to be a string
    return !isNaN(num) && !isNaN(parseFloat(num));
} 
```

以下是最有可能性能不佳但结果可靠的解决方案。它是由 jQuery 1.12.4 实现和 Michael 的答案制成的装置，对前导/尾随空格进行了额外检查（因为 Michael 的版本对带有前导/尾随空格的数字返回 true）：

```
function isNumeric(a) {
    var str = a + "";
    var b = a && a.toString();
    return !$.isArray(a) && b - parseFloat(b) + 1 >= 0 &&
           !/^\s+|\s+$/g.test(str) &&
           !isNaN(str) && !isNaN(parseFloat(str));
}; 
```

不过，后一个版本有两个新变量。可以通过以下方式绕过其中之一：

```
function isNumeric(a) {
    if ($.isArray(a)) return false;
    var b = a && a.toString();
    a = a + "";
    return b - parseFloat(b) + 1 >= 0 &&
            !/^\s+|\s+$/g.test(a) &&
            !isNaN(a) && !isNaN(parseFloat(a));
}; 
```

除了手动测试我将在当前困境中遇到的少数用例之外，我还没有通过其他方式对这些中的任何一个进行过很多测试，这些都是非常标准的东西。这是一种“站在巨人的肩膀上”的局面。

* * *

## 回答 #13

> 赞同：6
> 
> 时间：2019-05-23T13:55:43.207

它对 TypeScript 无效，因为：

`declare function isNaN(number: number): boolean;`

对于 TypeScript，您可以使用：

`/^\d+$/.test(key)`

* * *

## 回答 #14

> 赞同：6
> 
> 时间：2019-11-14T05:05:03.637

## 2019：实用且严格的数值有效性检查

通常，“有效数”是指不包括 NaN 和 Infinity 的 Javascript 数，即“有限数”。

要检查值的数值有效性（例如来自外部源），您可以在 ESlint Airbnb 样式中定义：

```
/**
 * Returns true if 'candidate' is a finite number or a string referring (not just 'including') a finite number
 * To keep in mind:
 *   Number(true) = 1
 *   Number('') = 0
 *   Number("   10  ") = 10
 *   !isNaN(true) = true
 *   parseFloat('10 a') = 10
 *
 * @param {?} candidate
 * @return {boolean}
 */
function isReferringFiniteNumber(candidate) {
  if (typeof (candidate) === 'number') return Number.isFinite(candidate);
  if (typeof (candidate) === 'string') {
    return (candidate.trim() !== '') && Number.isFinite(Number(candidate));
  }
  return false;
} 
```

并以这种方式使用它：

```
if (isReferringFiniteNumber(theirValue)) {
  myCheckedValue = Number(theirValue);
} else {
  console.warn('The provided value doesn\'t refer to a finite number');
} 
```

* * *

## 回答 #15

> 赞同：6
> 
> 时间：2021-08-17T17:02:41.753

## TL;博士

这在很大程度上取决于*您*要解析为数字的内容。

## 内置函数比较

由于没有一个现有的资源能满足我的灵魂，我试图弄清楚这些函数到底发生了什么。

这个问题的三个直接答案感觉就像：

1.  `!isNaN(input)`（给出与 相同的输出`+input === +input`）
2.  `!isNaN(parseFloat(input))`
3.  `isFinite(input)`

但是它们中的任何一个在*每种*情况下都是正确的吗？

我在几个案例中测试了这些函数，并生成了降价输出。这是它的样子：

| `input` | `!isNaN(input)`或者 `+input===+input` | `!isNaN(` `parseFloat(`
`input))` | `isFinite(` `input)` | 评论 |
| --- | --- | --- | --- | --- |
| 123 | ✔️ | ✔️ | ✔️ | - |
| '123' | ✔️ | ✔️ | ✔️ | - |
| 12.3 | ✔️ | ✔️ | ✔️ | - |
| '12.3' | ✔️ | ✔️ | ✔️ | - |
| '12.3' | ✔️ | ✔️ | ✔️ | 正如预期的那样，修剪了空白。 |
| 1_000_000 | ✔️ | ✔️ | ✔️ | 数字分隔符可以理解，也可以预期。 |
| '1_000_000' | ❌</td> | ✔️ | ❌</td> | 惊喜！JS 只是不会解析字符串中的数字分隔符。有关详细信息，请检查[此](https://github.com/tc39/proposal-numeric-separator/issues/32)问题。（为什么然后解析为浮点数？好吧，它没有。） |
| '0b11111111' | ✔️ | ✔️ | ✔️ | 二进制形式理解，因为它应该。 |
| '0o377' | ✔️ | ✔️ | ✔️ | 八进制形式也可以理解。 |
| '0xFF' | ✔️ | ✔️ | ✔️ | 当然可以理解十六进制。有人有其他想法吗？ |
| '' | ✔️ | ❌</td> | ✔️ | 空字符串应该是数字吗？ |
| '' | ✔️ | ❌</td> | ✔️ | 只有空格的字符串应该是数字吗？ |
| 'ABC' | ❌</td> | ❌</td> | ❌</td> | 每个人都同意，而不是一个数字。 |
| '12.34Ab!@#$' | ❌</td> | ✔️ | ❌</td> | 啊! 现在很容易理解是做什么的`parseFloat()`。对我来说并不令人印象深刻，但在某些情况下可能会派上用场。 |
| '10e100' | ✔️ | ✔️ | ✔️ | 10 ^(100)确实是一个数字。 **但是要小心！**它比最大安全整数值 2 ^(53)（大约 9×10 ^(15)）大得多。阅读[本文](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number/MAX_SAFE_INTEGER)了解详情。 |
| '10e1000' | ✔️ | ✔️ | ❌</td> | 跟我说，[救命！](https://www.youtube.com/watch?v=2Q_ZzBGPdqE) 虽然不像看起来那么疯狂。在 JavaScript 中，大于 ~10 ^(308)的值会四舍五入为无穷大，这就是原因。[在这里](https://stackoverflow.com/a/10838069)查看详细信息。
是的，`isNaN()`将无穷大视为一个数字，并将`parseFloat()`无穷大解析为无穷大。 |
| 空值 | ✔️ | ❌</td> | ✔️ | 现在这很尴尬。在 JS 中，当需要转换时，null 变为零，我们得到一个有限数。 那么这里为什么`parseFloat(null)`要返回一个`NaN`呢？有人请给我解释一下这个设计概念。 |
| 不明确的 | ❌</td> | ❌</td> | ❌</td> | 正如预期的那样。 |
| 无穷 | ✔️ | ✔️ | ❌</td> | 如前所述，`isNaN()`将无穷大视为一个数字，并将`parseFloat()`无穷大解析为无穷大。 |

那么......他们中的哪一个是“正确的”？

现在应该清楚了，**这在很大程度上取决于我们需要什么**。例如，我们可能希望将 null 输入视为 0。在这种情况下`isFinite()`可以正常工作。

`isNaN()`同样，当需要将10 ^(10000000000)视为有效数字时，也许我们会得到一点帮助（尽管问题仍然存在——为什么会这样，以及我们将如何处理）！

当然，我们可以手动排除任何场景。

就像在我的情况下一样，我需要 的输出`isFinite()`，除了 null 情况、空字符串情况和只有空格的字符串情况。此外，我对*非常庞大的*数字也不感到头疼。所以我的代码看起来像这样：

```
/**
 * My necessity was met by the following code.
 */

if (input === null) {
    // Null input
} else if (input.trim() === '') {
    // Empty or whitespace-only string
} else if (isFinite(input)) {
    // Input is a number
} else {
    // Not a number
} 
```

而且，这是我生成表格的 JavaScript：

```
/**
 * Note: JavaScript does not print numeric separator inside a number.
 * In that single case, the markdown output was manually corrected.
 * Also, the comments were manually added later, of course.
 */

let inputs = [
    123, '123', 12.3, '12.3', '   12.3   ',
    1_000_000, '1_000_000',
    '0b11111111', '0o377', '0xFF',
    '', '    ',
    'abc', '12.34Ab!@#$',
    '10e100', '10e1000',
    null, undefined, Infinity];

let markdownOutput = `| \`input\` | \`!isNaN(input)\` or <br>\`+input === +input\` | \`!isNaN(parseFloat(input))\` | \`isFinite(input)\` | Comment |
| :---: | :---: | :---: | :---: | :--- |\n`;

for (let input of inputs) {
    let outputs = [];
    outputs.push(!isNaN(input));
    outputs.push(!isNaN(parseFloat(input)));
    outputs.push(isFinite(input));

    if (typeof input === 'string') {
        // Output with quotations
        console.log(`'${input}'`);
        markdownOutput += `| '${input}'`;
    } else {
        // Output without quotes
        console.log(input);
        markdownOutput += `| ${input}`;
    }

    for (let output of outputs) {
        console.log('\t' + output);
        if (output === true) {
            markdownOutput += ` | <div style="color:limegreen">true</div>`;
            // markdownOutput += ` | ✔️`; // for stackoverflow
        } else {
            markdownOutput += ` | <div style="color:orangered">false</div>`;
            // markdownOutput += ` | ❌`; // for stackoverflow
        }
    }

    markdownOutput += ` ||\n`;
}

// Replace two or more whitespaces with $nbsp;
markdownOutput = markdownOutput.replaceAll(`  `, `&nbsp;&nbsp;`);

// Print markdown to console
console.log(markdownOutput); 
```

* * *

## 回答 #16

> 赞同：5
> 
> 时间：2021-12-19T03:33:38.637

有人也可能从基于正则表达式的答案中受益。这里是：

**一个衬垫是整数：**

```
const isInteger = num => /^-?[0-9]+$/.test(num+''); 
```

**一班是数字：**接受整数和小数

```
const isNumeric = num => /^-?[0-9]+(?:\.[0-9]+)?$/.test(num+''); 
```

* * *

## 回答 #17

> 赞同：4
> 
> 时间：2008-10-06T19:16:22.737

parseInt()，但请注意，这个函数有点不同，例如它为 parseInt("100px") 返回 100。

* * *

## 回答 #18

> 赞同：4
> 
> 时间：2012-06-01T05:31:14.100

引用：

> isNaN(num) // 如果变量不包含有效数字，则返回 true

如果您需要检查前导/尾随空格，则不完全正确 - 例如，当需要一定数量的数字时，您可能需要获取 '1111' 而不是 '111' 或 '111' 作为 PIN输入。

更好地使用：

```
var num = /^\d+$/.test(num) 
```

* * *

## 回答 #19

> 赞同：4
> 
> 时间：2019-03-17T07:24:09.800

**当防止空字符串和`null`**

```
// Base cases that are handled properly
Number.isNaN(Number('1')); // => false
Number.isNaN(Number('-1')); // => false
Number.isNaN(Number('1.1')); // => false
Number.isNaN(Number('-1.1')); // => false
Number.isNaN(Number('asdf')); // => true
Number.isNaN(Number(undefined)); // => true

// Special notation cases that are handled properly
Number.isNaN(Number('1e1')); // => false
Number.isNaN(Number('1e-1')); // => false
Number.isNaN(Number('-1e1')); // => false
Number.isNaN(Number('-1e-1')); // => false
Number.isNaN(Number('0b1')); // => false
Number.isNaN(Number('0o1')); // => false
Number.isNaN(Number('0xa')); // => false

// Edge cases that will FAIL if not guarded against
Number.isNaN(Number('')); // => false
Number.isNaN(Number(' ')); // => false
Number.isNaN(Number(null)); // => false

// Edge cases that are debatable
Number.isNaN(Number('-0b1')); // => true
Number.isNaN(Number('-0o1')); // => true
Number.isNaN(Number('-0xa')); // => true
Number.isNaN(Number('Infinity')); // => false 
Number.isNaN(Number('INFINITY')); // => true  
Number.isNaN(Number('-Infinity')); // => false 
Number.isNaN(Number('-INFINITY')); // => true 
```

**当不防范空字符串和`null`**

使用`parseInt`：

```
// Base cases that are handled properly
Number.isNaN(parseInt('1')); // => false
Number.isNaN(parseInt('-1')); // => false
Number.isNaN(parseInt('1.1')); // => false
Number.isNaN(parseInt('-1.1')); // => false
Number.isNaN(parseInt('asdf')); // => true
Number.isNaN(parseInt(undefined)); // => true
Number.isNaN(parseInt('')); // => true
Number.isNaN(parseInt(' ')); // => true
Number.isNaN(parseInt(null)); // => true

// Special notation cases that are handled properly
Number.isNaN(parseInt('1e1')); // => false
Number.isNaN(parseInt('1e-1')); // => false
Number.isNaN(parseInt('-1e1')); // => false
Number.isNaN(parseInt('-1e-1')); // => false
Number.isNaN(parseInt('0b1')); // => false
Number.isNaN(parseInt('0o1')); // => false
Number.isNaN(parseInt('0xa')); // => false

// Edge cases that are debatable
Number.isNaN(parseInt('-0b1')); // => false
Number.isNaN(parseInt('-0o1')); // => false
Number.isNaN(parseInt('-0xa')); // => false
Number.isNaN(parseInt('Infinity')); // => true 
Number.isNaN(parseInt('INFINITY')); // => true  
Number.isNaN(parseInt('-Infinity')); // => true 
Number.isNaN(parseInt('-INFINITY')); // => true 
```

使用`parseFloat`：

```
// Base cases that are handled properly
Number.isNaN(parseFloat('1')); // => false
Number.isNaN(parseFloat('-1')); // => false
Number.isNaN(parseFloat('1.1')); // => false
Number.isNaN(parseFloat('-1.1')); // => false
Number.isNaN(parseFloat('asdf')); // => true
Number.isNaN(parseFloat(undefined)); // => true
Number.isNaN(parseFloat('')); // => true
Number.isNaN(parseFloat(' ')); // => true
Number.isNaN(parseFloat(null)); // => true

// Special notation cases that are handled properly
Number.isNaN(parseFloat('1e1')); // => false
Number.isNaN(parseFloat('1e-1')); // => false
Number.isNaN(parseFloat('-1e1')); // => false
Number.isNaN(parseFloat('-1e-1')); // => false
Number.isNaN(parseFloat('0b1')); // => false
Number.isNaN(parseFloat('0o1')); // => false
Number.isNaN(parseFloat('0xa')); // => false

// Edge cases that are debatable
Number.isNaN(parseFloat('-0b1')); // => false
Number.isNaN(parseFloat('-0o1')); // => false
Number.isNaN(parseFloat('-0xa')); // => false
Number.isNaN(parseFloat('Infinity')); // => false 
Number.isNaN(parseFloat('INFINITY')); // => true  
Number.isNaN(parseFloat('-Infinity')); // => false 
Number.isNaN(parseFloat('-INFINITY')); // => true 
```

*笔记：*

*   *仅考虑字符串、空值和未初始化的值以解决原始问题。如果数组和对象是正在考虑的值，则存在其他边缘情况。*
*   *二进制、八进制、十六进制和指数表示法的字符不区分大小写（即：'0xFF'、'0XFF'、'0xfF' 等在上面显示的测试用例中都会产生相同的结果）。*
*   *与`Infinity`在某些情况下（区分大小写）不同，作为测试用例以字符串格式传递给上述任何方法的对象中的常量将被确定为不是数字`Number`。`Math`*
*   *有关如何将参数转换为 a以及为什么存在空字符串和空字符串的边缘情况的说明，请参见[此处。](http://www.ecma-international.org/ecma-262/7.0/#sec-tonumber)`Number``null`*

* * *

## 回答 #20

> 赞同：3
> 
> 时间：2012-03-19T18:56:54.223

好吧，我正在使用我制作的这个......

到目前为止它一直在工作：

```
function checkNumber(value) {
    return value % 1 == 0;
} 
```

如果您发现它有任何问题，请告诉我。

* * *

## 回答 #21

> 赞同：3
> 
> 时间：2017-01-04T07:37:09.103

如果有人能做到这一点，我会花一些时间来尝试修补 moment.js ( [https://github.com/moment/moment](https://github.com/moment/moment) )。这是我从中拿走的东西：

```
function isNumeric(val) {
    var _val = +val;
    return (val !== val + 1) //infinity check
        && (_val === +val) //Cute coercion check
        && (typeof val !== 'object') //Array/object check
} 
```

处理以下情况：

真的！：

```
isNumeric("1"))
isNumeric(1e10))
isNumeric(1E10))
isNumeric(+"6e4"))
isNumeric("1.2222"))
isNumeric("-1.2222"))
isNumeric("-1.222200000000000000"))
isNumeric("1.222200000000000000"))
isNumeric(1))
isNumeric(0))
isNumeric(-0))
isNumeric(1010010293029))
isNumeric(1.100393830000))
isNumeric(Math.LN2))
isNumeric(Math.PI))
isNumeric(5e10)) 
```

错误的！：

```
isNumeric(NaN))
isNumeric(Infinity))
isNumeric(-Infinity))
isNumeric())
isNumeric(undefined))
isNumeric('[1,2,3]'))
isNumeric({a:1,b:2}))
isNumeric(null))
isNumeric([1]))
isNumeric(new Date())) 
```

具有讽刺意味的是，我最挣扎的是：

```
isNumeric(new Number(1)) => false 
```

欢迎任何建议。:]

* * *

## 回答 #22

> 赞同：3
> 
> 时间：2018-10-08T21:38:23.893

我最近写了一篇关于如何确保变量是有效数字的文章：[https](https://github.com/jehugaleahsa/artifacts/blob/master/2018/typescript_num_hack.md) ://github.com/jehugaleahsa/artifacts/blob/master/2018/typescript_num_hack.md文章解释了如何确保浮点或整数，如果是的话重要（`+x`vs `~~x`）。

本文假设变量是 a`string`或 a`number`开头并且`trim`可用/填充。扩展它以处理其他类型也不难。这是它的肉：

```
// Check for a valid float
if (x == null
    || ("" + x).trim() === ""
    || isNaN(+x)) {
    return false;  // not a float
}

// Check for a valid integer
if (x == null
    || ("" + x).trim() === ""
    || ~~x !== +x) {
    return false;  // not an integer
} 
```

* * *

## 回答 #23

> 赞同：3
> 
> 时间：2019-01-30T13:52:26.947

```
function isNumberCandidate(s) {
  const str = (''+ s).trim();
  if (str.length === 0) return false;
  return !isNaN(+str);
}

console.log(isNumberCandidate('1'));       // true
console.log(isNumberCandidate('a'));       // false
console.log(isNumberCandidate('000'));     // true
console.log(isNumberCandidate('1a'));      // false 
console.log(isNumberCandidate('1e'));      // false
console.log(isNumberCandidate('1e-1'));    // true
console.log(isNumberCandidate('123.3'));   // true
console.log(isNumberCandidate(''));        // false
console.log(isNumberCandidate(' '));       // false
console.log(isNumberCandidate(1));         // true
console.log(isNumberCandidate(0));         // true
console.log(isNumberCandidate(NaN));       // false
console.log(isNumberCandidate(undefined)); // false
console.log(isNumberCandidate(null));      // false
console.log(isNumberCandidate(-1));        // true
console.log(isNumberCandidate('-1'));      // true
console.log(isNumberCandidate('-1.2'));    // true
console.log(isNumberCandidate(0.0000001)); // true
console.log(isNumberCandidate('0.0000001')); // true
console.log(isNumberCandidate(Infinity));    // true
console.log(isNumberCandidate(-Infinity));    // true

console.log(isNumberCandidate('Infinity'));  // true

if (isNumberCandidate(s)) {
  // use +s as a number
  +s ...
} 
```

* * *

## 回答 #24

> 赞同：3
> 
> 时间：2020-04-02T11:21:43.207

这是建立在以前的一些答案和评论的基础上的。以下内容涵盖了所有边缘情况，也相当简洁：

```
const isNumRegEx = /^-?(\d*\.)?\d+$/;

function isNumeric(n, allowScientificNotation = false) {
    return allowScientificNotation ? 
                !Number.isNaN(parseFloat(n)) && Number.isFinite(n) :
                isNumRegEx.test(n);
} 
```

* * *

## 回答 #25

> 赞同：3
> 
> 时间：2021-04-26T12:31:03.643

检查JS中的数字：

1.  检查它是否是数字的最佳方法：

    ```
    isFinite(20)
    //True 
    ```

2.  从字符串中读取一个值。CSS *：

    ```
    parseInt('2.5rem')
    //2
    parseFloat('2.5rem')
    //2.5 
    ```

3.  对于整数：

    ```
    isInteger(23 / 0)
    //False 
    ```

4.  如果值为 NaN：

    ```
    isNaN(20)
    //False 
    ```

* * *

## 回答 #26

> 赞同：2
> 
> 时间：2014-04-30T13:32:00.520

PFB 工作解决方案：

```
 function(check){ 
    check = check + "";
    var isNumber =   check.trim().length>0? !isNaN(check):false;
    return isNumber;
    } 
```

* * *

## 回答 #27

> 赞同：2
> 
> 时间：2018-12-20T20:25:59.560

免去寻找“内置”解决方案的麻烦。

没有一个好的答案，而且这个帖子中被高度评价的答案是错误的。

`npm install is-number`

> 在 JavaScript 中，可靠地检查一个值是否为数字并不总是那么简单。开发人员通常使用 +、- 或 Number() 将字符串值转换为数字（例如，当从用户输入、正则表达式匹配、解析器等返回值时）。但是有许多非直观的边缘情况会产生意想不到的结果：

```
console.log(+[]); //=> 0
console.log(+''); //=> 0
console.log(+'   '); //=> 0
console.log(typeof NaN); //=> 'number' 
```

* * *

## 回答 #28

> 赞同：2
> 
> 时间：2020-04-08T18:57:02.123

这似乎抓住了看似无限数量的边缘情况：

```
function isNumber(x, noStr) {
    /*

        - Returns true if x is either a finite number type or a string containing only a number
        - If empty string supplied, fall back to explicit false
        - Pass true for noStr to return false when typeof x is "string", off by default

        isNumber(); // false
        isNumber([]); // false
        isNumber([1]); // false
        isNumber([1,2]); // false
        isNumber(''); // false
        isNumber(null); // false
        isNumber({}); // false
        isNumber(true); // false
        isNumber('true'); // false
        isNumber('false'); // false
        isNumber('123asdf'); // false
        isNumber('123.asdf'); // false
        isNumber(undefined); // false
        isNumber(Number.POSITIVE_INFINITY); // false
        isNumber(Number.NEGATIVE_INFINITY); // false
        isNumber('Infinity'); // false
        isNumber('-Infinity'); // false
        isNumber(Number.NaN); // false
        isNumber(new Date('December 17, 1995 03:24:00')); // false
        isNumber(0); // true
        isNumber('0'); // true
        isNumber(123); // true
        isNumber(123.456); // true
        isNumber(-123.456); // true
        isNumber(-.123456); // true
        isNumber('123'); // true
        isNumber('123.456'); // true
        isNumber('.123'); // true
        isNumber(.123); // true
        isNumber(Number.MAX_SAFE_INTEGER); // true
        isNumber(Number.MAX_VALUE); // true
        isNumber(Number.MIN_VALUE); // true
        isNumber(new Number(123)); // true
    */

    return (
        (typeof x === 'number' || x instanceof Number || (!noStr && x && typeof x === 'string' && !isNaN(x))) &&
        isFinite(x)
    ) || false;
}; 
```

* * *

## 回答 #29

> 赞同：2
> 
> 时间：2020-10-20T01:07:26.450

因此，这将取决于您希望它处理的测试用例。

```
function isNumeric(number) {
  return !isNaN(parseFloat(number)) && !isNaN(+number);
} 
```

我正在寻找的是 javascript 中的常规数字类型。 `0, 1 , -1, 1.1 , -1.1 , 1E1 , -1E1 , 1e1 , -1e1, 0.1e10, -0.1.e10 , 0xAF1 , 0o172, Math.PI, Number.NEGATIVE_INFINITY, Number.POSITIVE_INFINITY`

它们也是字符串的表示形式：
`'0', '1', '-1', '1.1', '-1.1', '1E1', '-1E1', '1e1', '-1e1', '0.1e10', '-0.1.e10', '0xAF1', '0o172'`

我确实想省略而不是将它们标记为数字 `'', ' ', [], {}, null, undefined, NaN`

截至今天，所有其他答案似乎都未能通过其中一个测试用例。

* * *

## 回答 #30

> 赞同：1
> 
> 时间：2020-08-11T09:33:19.750

我用这个函数作为表单验证工具，不想让用户写指数函数，所以想出了这个函数：

```
<script>

    function isNumber(value, acceptScientificNotation) {

        if(true !== acceptScientificNotation){
            return /^-{0,1}\d+(\.\d+)?$/.test(value);
        }

        if (true === Array.isArray(value)) {
            return false;
        }
        return !isNaN(parseInt(value, 10));
    }

    console.log(isNumber(""));              // false
    console.log(isNumber(false));           // false
    console.log(isNumber(true));            // false
    console.log(isNumber("0"));             // true
    console.log(isNumber("0.1"));           // true
    console.log(isNumber("12"));            // true
    console.log(isNumber("-12"));           // true
    console.log(isNumber(-45));             // true
    console.log(isNumber({jo: "pi"}));      // false
    console.log(isNumber([]));              // false
    console.log(isNumber([78, 79]));        // false
    console.log(isNumber(NaN));             // false
    console.log(isNumber(Infinity));        // false
    console.log(isNumber(undefined));       // false
    console.log(isNumber("0,1"));           // false

    console.log(isNumber("1e-1"));          // false
    console.log(isNumber("1e-1", true));    // true
</script> 
```

* * *

## 回答 #31

> 赞同：1
> 
> 时间：2021-11-21T06:48:57.610

这种方式对我有用。

```
function isNumeric(num){
    let value1 = num.toString();
    let value2 = parseFloat(num).toString();
    return (value1 === value2);
} 
```

* * *

```
console.log(
    isNumeric(123),     //true
    isNumeric(-123),    //true
    isNumeric('123'),   //true
    isNumeric('-123'),  //true
    isNumeric(12.2),    //true
    isNumeric(-12.2),   //true
    isNumeric('12.2'),  //true
    isNumeric('-12.2'), //true
    isNumeric('a123'),  //false
    isNumeric('123a'),  //false
    isNumeric(' 123'),  //false
    isNumeric('123 '),  //false
    isNumeric('a12.2'), //false
    isNumeric('12.2a'), //false
    isNumeric(' 12.2'), //false
    isNumeric('12.2 '), //false
) 
```

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2014-07-08T15:22:23.233

在我的应用程序中，我们只允许 az AZ 和 0-9 个字符。*我发现上面使用“ string* % 1 === 0”的答案有效，除非字符串以 0xnn（如 0x10）开头，然后当我们不希望它以数字形式返回时。我的数字检查中的以下简单陷阱似乎在我们的特定情况下可以解决问题。

```
function isStringNumeric(str_input){   
    //concat a temporary 1 during the modulus to keep a beginning hex switch combination from messing us up   
    //very simple and as long as special characters (non a-z A-Z 0-9) are trapped it is fine   
    return '1'.concat(str_input) % 1 === 0;} 
```

**警告**：这可能是在利用 Javascript 和 Actionscript [Number("1" + the_string) % 1 === 0)] 中的一个长期存在的错误，我不能这么说，但这正是我们所需要的。

* * *

## 回答 #33

> 赞同：0
> 
> 时间：2014-08-07T22:42:46.550

我的解决方案：

```
// returns true for positive ints; 
// no scientific notation, hexadecimals or floating point dots

var isPositiveInt = function(str) { 
   var result = true, chr;
   for (var i = 0, n = str.length; i < n; i++) {
       chr = str.charAt(i);
       if ((chr < "0" || chr > "9") && chr != ",") { //not digit or thousands separator
         result = false;
         break;
       };
       if (i == 0 && (chr == "0" || chr == ",")) {  //should not start with 0 or ,
         result = false;
         break;
       };
   };
   return result;
 }; 
```

您可以在循环内添加其他条件，以满足您的特定需求。

* * *

## 回答 #34

> 赞同：0
> 
> 时间：2015-09-12T14:03:35.280

我的尝试有点令人困惑，也许不是最好的解决方案

```
function isInt(a){
    return a === ""+~~a
}

console.log(isInt('abcd'));         // false
console.log(isInt('123a'));         // false
console.log(isInt('1'));            // true
console.log(isInt('0'));            // true
console.log(isInt('-0'));           // false
console.log(isInt('01'));           // false
console.log(isInt('10'));           // true
console.log(isInt('-1234567890'));  // true
console.log(isInt(1234));           // false
console.log(isInt('123.4'));        // false
console.log(isInt(''));             // false

// other types then string returns false
console.log(isInt(5));              // false
console.log(isInt(undefined));      // false
console.log(isInt(null));           // false
console.log(isInt('0x1'));          // false
console.log(isInt(Infinity));       // false 
```

* * *

## 回答 #35

> 赞同：0
> 
> 时间：2017-11-16T15:13:41.813

您可以使用类型（例如[流库](https://flow.org/en/docs/types/primitives/)）来获得静态的编译时检查。当然对于用户输入不是非常有用。

```
// @flow

function acceptsNumber(value: number) {
  // ...
}

acceptsNumber(42);       // Works!
acceptsNumber(3.14);     // Works!
acceptsNumber(NaN);      // Works!
acceptsNumber(Infinity); // Works!
acceptsNumber("foo");    // Error! 
```

* * *

## 回答 #36

> 赞同：0
> 
> 时间：2019-08-13T12:53:48.523

这是 isNumber 实现的高性能（2.5*10^7 迭代/s @3.8GHz Haswell）版本。它适用于我能找到的每个测试用例（包括符号）：

```
var isNumber = (function () {
  var isIntegerTest = /^\d+$/;
  var isDigitArray = [!0, !0, !0, !0, !0, !0, !0, !0, !0, !0];
  function hasLeading0s (s) {
    return !(typeof s !== 'string' ||
    s.length < 2 ||
    s[0] !== '0' ||
    !isDigitArray[s[1]] ||
    isIntegerTest.test(s));
  }
  var isWhiteSpaceTest = /\s/;
  return function isNumber (s) {
    var t = typeof s;
    var n;
    if (t === 'number') {
      return (s <= 0) || (s > 0);
    } else if (t === 'string') {
      n = +s;
      return !((!(n <= 0) && !(n > 0)) || n === '0' || hasLeading0s(s) || !(n !== 0 || !(s === '' || isWhiteSpaceTest.test(s))));
    } else if (t === 'object') {
      return !(!(s instanceof Number) || ((n = +s), !(n <= 0) && !(n > 0)));
    }
    return false;
  };
})(); 
```

* * *

## 回答 #37

> 赞同：0
> 
> 时间：2021-07-17T04:39:02.177

测试字符串或数字是否为数字

```
const isNumeric = stringOrNumber =>
  stringOrNumber == 0 || !!+stringOrNumber; 
```

或者，如果您想将字符串或数字转换为数字

```
const toNumber = stringOrNumber =>
  stringOrNumber == 0 || +stringOrNumber ? +stringOrNumber : NaN; 
```

* * *

## 回答 #38

> 赞同：0
> 
> 时间：2021-10-01T08:33:12.817

如果您正在寻找一个正数（例如门牌号），只需使用：

```
if (mystring > 0) ... 
```

* * *

## 回答 #39

> 赞同：0
> 
> 时间：2022-01-07T23:22:09.407

我在 Angular 中使用了这个功能

```
 isNumeric(value: string): boolean {
             let valueToNumber = Number(value);
             var result = typeof valueToNumber == 'number' ;
             if(valueToNumber.toString() == 'NaN')
             {
                result = false;
             }
             return result;
          } 
```

* * *

## 回答 #40

> 赞同：-1
> 
> 时间：2017-11-27T16:25:50.533

`sNum`这是一个检查是否是有效数值的单行代码；它已经针对各种输入进行了测试：

```
!!s && !isNaN(+s.replace(/\s|\$/g, ''));  // returns True if numeric value 
```

向@gman 致敬以发现错误。

* * *

## 回答 #41

> 赞同：-1
> 
> 时间：2018-06-27T07:30:39.293

我喜欢这种简单。

```
Number.isNaN(Number(value)) 
```

以上是常规的 Javascript，但我将它与[typescript typeguard](http://www.typescriptlang.org/docs/handbook/advanced-types.html)结合使用以进行智能类型检查。这对于打字稿编译器为您提供正确的智能感知非常有用，并且没有类型错误。

### 打字稿类型保护

```
isNotNumber(value: string | number): value is string {
    return Number.isNaN(Number(this.smartImageWidth));
}
isNumber(value: string | number): value is number {
    return Number.isNaN(Number(this.smartImageWidth)) === false;
} 
```

假设您有一个属性`width`是`number | string`. 您可能希望根据它是否为字符串来执行逻辑。

```
var width: number|string;
width = "100vw";

if (isNotNumber(width)) 
{
    // the compiler knows that width here must be a string
    if (width.endsWith('vw')) 
    {
        // we have a 'width' such as 100vw
    } 
}
else 
{
    // the compiler is smart and knows width here must be number
    var doubleWidth = width * 2;    
} 
```

typeguard 足够聪明，可以`width`将`if`语句中的类型限制为 ONLY `string`。这允许编译器`width.endsWith(...)`允许如果类型是`string | number`.

您可以随意调用 typeguard `isNotNumber`, `isNumber`, `isString`，`isNotString`但我认为`isString`这有点模棱两可且难以阅读。

* * *

## 回答 #42

> 赞同：-1
> 
> 时间：2019-01-31T11:52:57.137

只需使用`isNaN()`，这会将字符串转换为**数字**，如果得到有效**数字**，将返回`false`...

```
isNaN("Alireza"); //return true
isNaN("123"); //return false 
```

* * *

## 回答 #43

> 赞同：-1
> 
> 时间：2019-03-05T07:54:47.003

我正在使用以下内容：

```
const isNumber = s => !isNaN(+s) 
```

* * *

## 回答 #44

> 赞同：-6
> 
> 时间：2014-10-13T15:01:53.807

我这样做：

```
function isString(value)
{
    return value.length !== undefined;
}
function isNumber(value)
{
    return value.NaN !== undefined;
} 
```

当然，如果您传递一些其他定义了“长度”的对象，isString() 将在这里被绊倒。

# javascript - Java Script 2 D 数组分配

> ID：175742
> 
> 赞同：4
> 
> 时间：2008-10-06T19:13:36.983
> 
> 标签：javascript

我想在 Java Script 中分配一个二维数组。

我想在 JavaScript 中做一些类似的事情

```
typedef struct
{
   int  itemA,
   int  itemB,
   string testC
} myStruc;

myStruct MyArray [100]; 
```

这个怎么做 ？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-06T19:24:57.227

```
var arr = []
arr[0] = { "itemA": "A", "itemB": "B", "itemC": "C" }
arr[1] = { "itemA": "A", "itemB": "B", "itemC": "C" } 
```

I think you are trying to apply static language constructs to the dynamic and different world of Javascript. Javascript doesn't really have the notion of arrays in the sense that many languages do.

In Javascript, an array is simpl a special kind of object (itself just a hash) which has a special length property. The integer "indexes" that you see above (ie, the 0 in arr[0]) are just has lookups. The special length property is defined to be one greater than the greatest integer key. In my example above, arr.length is 2\. But if I were to assign:

```
arr[100] = { "itemA": "A", "itemB": "B", "itemC": "C" } 
```

Then arr.length would be 101, even though I've done nothing to assign any of the elements from 2 to 99.

Similarly, we generally don't predefine objects like structs in Javascript, and thus anonymous objects will largely accomplish what you want (or use a documented factory function such as in the example from Ken).

"new Array()" isn't necessary as the concise "var a = [];" syntax is quicker. :)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-06-26T16:52:07.883

如果我了解您需要动态创建一个指定长度的数组，并填充您自己的结构。

在 js 中，结构是一个 [object Object]

```
    // typedef struct { type prop1 , ... , type propN } myStructName;
    函数 myStructName(){}

    myStructName.prototype = {
        “构造函数”：myStructname，
        'prop1' : defaultVal1,
        // ...
        'propN' : 默认值
    };

```

我们可以创建一个动态创建结构类型的函数，但不是这种情况。现在我们只需要创建一个函数来创建一个特定长度的数组，其中填充了所有 myStruct 对象实例。这是我的方式

```
/*
    版权所有 (c) 2011 - Matteo Giordani < matteo.giordani90@gmail.com >
    麻省理工学院式许可证
    typedef struct{ int itemA , int itemB , string testC } myStruct
    我的结构 arr[10];

```
 JS way

    function myStruct( a , b , c )
        @param  {int}       a
        @param  {int}       b
        @param  {string}    c
        @return {object} 
```

*/
    函数我的结构（）{

 // arguments
    var a = arguments[0] , b = arguments[1] , c = arguments[2];

    // check INT type for argument a
    if( typeof a == "number" && (a + "").indexOf('.') == -1 ){ this['itemA'] = a; }
    // check INT type for argument b
    if( typeof b == "number" && (b + "").indexOf('.') == -1 ){ this['itemB'] = b; }
    // check INT type for argument b
    if( typeof c == "string" /*check for string length?!*/){ this['testC'] = c; }
}

// myStruct prototype
myStruct.prototype = {
    // constructor
    'constructor' : myStruct,
    // default value for itemA
    'itemA' : 0,
    // default value for itemB
    'itemB' : 0,
    // default value for testC
    'testC' : ''
};

/*
    static function defaultLength([, length])
    Set/Get the defaultLength value.
        @param  {unsigned int|void} length
        @return {void|unsigned int}
*/

myStruct.defaultLength = function(){
    // return the default value
    if( arguments.length == 0 ){
        return myStruct._default;
    }else{
    // set the default value
        var l = arguments[0];
        myStruct._default = ( typeof l == "number" && (l + "").indexOf('.') == -1 ) ? Math.abs( l ) : 0;
    }
};

// @var {unsigned int}  myStruct._default = 0
myStruct._default = 0;

/*
    static function makeArray( length )
    @param  {unsigned int}  length  the length of the array
    @return {array}
*/
myStruct.makeArray = function( length ){
    // Check if length is unsigned int
    length = ( typeof length == "number" && (length + "").indexOf('.') == -1 ) ? Math.abs( length ) : myStruct.defaultLength();

    // local array
    var array = [] , i = 0;

    // populate the array
    for( ; i < length; i++){
        array[ i ] = new myStruct();
    }

    // return
    return array;
};

// MAKE IT!
myStruct.defaultLength(10);             // set the default length == 10
var arr = myStruct.makeArray();         // [myStruct, myStruct, myStruct, myStruct, myStruct, myStruct, myStruct, myStruct, myStruct, myStruct]
arr.length;                             // 10
Object.prototype.toString.call( arr );  // [object Array]

/* ANOTHER EXAMPLE */
var arr2 = [];                          // make an empty array
arr2[0] = new myStruct(1,1,'test1');    // make a first myStruct object
arr2[1] = new myStruct(2,2,'test2');    // make a second myStruct object 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-06T19:19:11.810

It sounds like you want properties for an array of objects, but I may be misinterpreting.

You may just need something like...

```
function Person(first, last) {
    this.first = first;
    this.last = last;
}

var person = new Person("John", "Dough"); 
```

[http://www.kevlindev.com/tutorials/javascript/inheritance/index.htm](http://www.kevlindev.com/tutorials/javascript/inheritance/index.htm)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-06T19:21:21.663

```
function Sample(value1, value2) {
    this.value1 = value1;
    this.value2 = value2;
}

var test = new Array();

test[0] = new Sample("a","aa");
test[1] = new Sample("b","bb"); 
```

PS: There are several ways to accomplish this in Java Script.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-06T20:10:31.753

如果您真的想*分配*特定结构的 100 个元素数组，您可以执行以下操作：

```
arr = [];

for (i=0; i<100; i++) {
   arr[i] = {itemA: <value>, itemB: <value>, textC: <string>, ... };
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-06T19:18:25.977

There are a few ways of creating arrays in Javascript, the method closest to what you want to do should be:

```
var myArray = new Array("someString1", "someString2", "someString3", ...); 
```

You can replace `"someString1"` with actual objects.

You can also use the Array constructor to set up the initial length:

```
var myArray = new Array(5);
myArray[0] = ...;
myArray[1] = ...; 
```

Arrays in Javascript are pretty loose actually - you don't even need to define the length before you access an element that would normally be outside the bounds of the array.

Take a look at [the Mozilla documentation on Arrays](http://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Global_Objects/Array).

# c# - Resources for learning c# Excel interop

> ID：175763
> 
> 赞同：24
> 
> 时间：2008-10-06T19:18:20.423
> 
> 标签：c#, excel, resources, interop

What are some resources that will help get me up and running quickly with the Excel interop in C#?

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-07T19:11:19.563

Ken Getz的文章[从 Visual Studio 2005 开发人员的角度理解 Excel](http://msdn.microsoft.com/en-us/library/aa537184(office.11).aspx)对象模型详细介绍了 Excel 对象模型。代码示例在 VB.NET 和 C# 中都有。

C# 和 VBA中涵盖了一些重要的警告[： Like Oil and Water](http://msdn.microsoft.com/en-us/magazine/cc163853.aspx)，也由 Ken Getz 编写。

我还会看到文章：[如何使用 Visual C# .NET 构建 Office COM 加载项](http://support.microsoft.com/kb/302901)。

HTH...

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-06T20:47:41.273

1) First thing first; Download the [Office Interop Assemblies](http://msdn.microsoft.com/en-us/library/kh3965hw(VS.80).aspx) from which you will access all of the objects, properties and methods in Excel interop and the appropriate references to your project. **BE AWARE:** Any machine that you intend to run your code on will need these assemblies installed also. You can either include them in your install package, or they come with .NET framework 1.1, so if your clients have that installed, they will probably have the interop assemblies.

2) There is a wealth of knowledge on MSDN...pretty much all of the objects and methods you will be using will be well-documented there.

3) **NOTE:** One weird little thing about using Interop with C# is that you have to supply "missing" references for interop calls manually...i.e. When using the functions in VBA (if you are used to doing that) if the method calls for 3 arguments and the last two are optional, you can "leave them out" in VBA (i.e. MyMethod argumentOne) ... **this does not work from .NET** it is the one thing that confused me for a while when I started using the Interop assemblies; You have to manually create a missing object like this (example is from Word Interop, but same principals apply to Excel or any other office Interop package (and you also have to box some arguments and pass them by ref as below):

```
object missing = System.Reflection.Missing.Value;
string somestring = "string";
object refstring = (object)s;
wrd.Selection.Hyperlinks.Add(wrd.Selection.Range, **ref refstring, ref missing, ref missing, ref missing, ref missing**); 
```

I hope that helps.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-06T19:39:57.320

If you are looking to learn Excel Object Model, the VBA help is pretty good.

You might use "Primary Interop Assemblies" to work with Excel

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-06T19:20:36.220

Here's a [decent article](http://www.dotnetperls.com/excel) with some useful examples.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-06T19:21:16.093

[MSDN](http://msdn.microsoft.com/en-us/library/ms173186(VS.80).aspx) is always worth a read.

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-07T19:51:16.673

通过录制宏（在 Excel 中）并分析所发生的事情，您可以学到很多东西。

我的主要编程语言是 C#，但为了与 Excel（或其他 Office/COM 对象）通信，我总是使用 VB.Net。这使得从 VBA（记录）传输到 .Net 变得更加容易。

VB.Net 使后期绑定更容易使用。首先我使用早期绑定（让我获得 Intellisense），然后我将类型更改为 Object，因此我不再依赖特定版本的 Office。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-06T19:20:46.703

MSDN has a wealth of information...

[http://msdn.microsoft.com/en-us/library/ms173186(VS.80).aspx](http://msdn.microsoft.com/en-us/library/ms173186(VS.80).aspx)

# php - 如何在字符串中转换 Word 智能引号和破折号？

> ID：175785
> 
> 赞同：25
> 
> 时间：2008-10-06T19:22:33.957
> 
> 标签：php, unicode, smart-quotes

我有一个带有文本区域的表格。用户输入存储在数据库中的文本块。

有时，用户会从 Word 中粘贴包含智能引号或短划线的文本。这些字符在数据库中显示为： â€“, â€™, â€œ ,â€</p>

我应该在输入字符串上调用什么函数来*将智能引号转换为常规引号并将 emdashes 转换为常规破折号*？

我在 PHP 中工作。

更新：感谢迄今为止所有出色的回应。Joel 网站上关于编码的页面信息量很大： http: [//www.joelonsoftware.com/articles/Unicode.html](http://www.joelonsoftware.com/articles/Unicode.html)

关于我的环境的一些注意事项：

MySQL 数据库使用 UTF-8 编码。同样，显示内容的 HTML 页面通过显式设置元内容类型使用 UTF-8（更新：）。

在这些页面上，智能引号和破折号显示为带有问号的菱形。

解决方案：

再次感谢您的回复。解决方案是双重的：

1.  确保数据库和 HTML 文件已明确设置为使用 UTF-8 编码。
2.  使用`htmlspecialchars()`而不是 `htmlentities()`.

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-10-06T19:24:28.100

这听起来像是一个 Unicode 问题。Joel Spolsky 在这个话题上有一个很好的起点：http: [//www.joelonsoftware.com/articles/Unicode.html](http://www.joelonsoftware.com/articles/Unicode.html)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-10-07T16:02:19.397

> mysql 数据库使用 UTF-8 编码。同样，显示内容的 html 页面使用 UTF-8。

HTML 的内容可以是 UTF-8，是的，但是您是否也将 HTML 页面（通过 PHP 生成？）的内容类型（编码）也显式设置为 UTF-8？尝试返回 HTML 的`Content-Type`标题`"text/html;charset=utf-8"`或添加`<meta>`标签：

```
<meta http-equiv="Content-Type" content="text/html;charset=utf-8"/> 
```

这样，提交给 PHP 的数据的内容类型也将是相同的。

我有一个类似的问题，添加`<meta>`标签对我有用。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-06T19:30:16.810

听起来真正的问题是您的数据库没有使用与您的页面相同的字符编码（可能应该是 UTF-8）。在这种情况下，如果任何用户提交非 ASCII 字符，您可能会在数据库中看到奇怪的字符。只查找和修复其中的几个（弯引号和短划线）并不能解决真正的问题。

以下是有关[将数据库迁移到另一种字符编码](http://codex.wordpress.org/Converting_Database_Character_Sets)的一些信息，至少对于 MySQL 数据库而言。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-06T19:39:49.957

不幸的是，这是一个非常普遍的问题，PHP 对字符集的处理很差，这无济于事。

我们所做的是强制文本通过[`iconv`](http://ie2.php.net/manual/en/function.iconv.php)

```
// Convert input data to UTF8, ignore any odd (MS Word..) chars
// that don't translate
$input = iconv("ISO-8859-1","UTF-8//IGNORE",$input); 
```

该`//IGNORE`标志意味着任何无法翻译的东西都将被丢弃。

> 如果附加字符串 //IGNORE，则无法在目标字符集中表示的字符将被静默丢弃。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-06T19:28:59.027

我们经常会为此使用标准的字符串替换函数。尽管在这种情况下 ASCII/Unicode 的性质非常模糊，但它确实有效。只需确保您的 php 文件以正确的编码格式保存，等等。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-06T19:31:55.980

根据我的经验，只接受智能引号并确保您在任何地方都使用相同的编码会更容易。首先，将其添加到您的表单标签中：`accept-charset="utf-8"`

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-06T19:32:21.110

您可以尝试[将 mb_ convert_encoding](http://www.php.net/mb_convert_encoding)从 ISO-8859-1 转换为 UTF-8。

```
$str = mb_convert_encoding($str, 'UTF-8', 'ISO-8859-1'); 
```

这假设您需要 UTF-8，并且 convert 可以找到合理的替换...如果没有，请自行使用 mb_str_replace 或 preg_replace。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-07T16:18:54.730

这可能不是*最好*的解决方案，但我会尝试测试以找出 PHP 看到的内容。假设它看到“-”（还有一些其他的可能性，比如简单的““”或者可能是““”）。然后执行 str_replace 以摆脱所有这些并用普通引号替换它们，然后将答案填充到数据库中。

更好的解决方案可能涉及使端到端数据通过所有 UTF-8，因为人们正试图在其他答案中提供帮助。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-07T17:18:05.483

您必须确保您的数据库连接配置为从客户端接受和提供 UTF-8（否则它将转换为“默认”，通常是 latin1）。

实际上，这意味着运行查询 SET NAMES 'utf8';

[http://www.phpwact.org/php/i18n/utf-8/mysql](http://www.phpwact.org/php/i18n/utf-8/mysql)

此外，智能引号是 windows-1252 字符集的一部分，而不是 iso-8859-1 (latin-1)。与您的问题不太相关，但仅供参考。欧元符号也在那里。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2010-10-24T17:20:19.867

问题出在 mysql 字符集上，我用这行代码解决了我的问题。

```
mysql_set_charset('utf8',$link); 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2011-10-10T15:24:52.167

您必须手动将各个列的排序规则更改为 UTF8；整体更改数据库不会改变这些。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2014-10-16T04:48:58.230

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2016-02-11T08:47:26.180

实际上问题不是在 PHP 中发生，而是在 JavaScript 中发生，这是由于从 Word 复制/粘贴所致，因此在将文本传递给 PHP 之前，您需要在 JavaScript 中解决问题，请参阅此答案[https:// stackoverflow.com/a/6219023/1857295](https://stackoverflow.com/a/6219023/1857295)。

# mission-critical - 您编写的最关键的代码是什么？您是如何处理它的？

> ID：175806
> 
> 赞同：7
> 
> 时间：2008-10-06T19:28:50.527
> 
> 标签：mission-critical

换一种说法：你写了哪些**不会**失败的代码。我很想听听那些从事心脏监测、水测试、经济基本面、导弹轨迹或航天飞机上氧气浓度等项目的人的来信。

你是如何准备编写这种代码的：方法上、智力上和情感上？

**编辑**

我已经标记了这个 wiki，以防代表问题阻止人们回复。我认为在这个问题上会有比以往更多的观点。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-06T19:31:50.177

虽然我个人并未参与其中所描述的内容，但这篇文章有望有助于您提出问题的精神： [他们写的是正确的东西](http://www.fastcompany.com/magazine/06/writestuff.html)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-06T19:57:42.807

我为医院使用的血压测量设备编写了一个驱动程序。如果“失败”，患者将不会在预定的时间检查他的血压；如果他的血压异常，则不会触发警报（在更大的系统中）。这样的事件*可能*具有临床意义。

我的方法是在非工作环境中彻底阅读规范/文档（以避免立即开始编码的诱惑），然后在工作中再次阅读。之后，我在纸上总结了可能的状态和动作，并“流程图”了一个算法，并注释了所有潜在的现实世界“坏事件”（电缆被拔掉、电池没电等）。最后，我将驱动程序编写和重写了 3 次，每次都使用不同的机制（例如 FSM），并比较了它们的结果。每次迭代都帮助我发现了我尚未发现的弱点。第三次改写是“官方”结果。我和我的同事一起回顾了每一次迭代。

情绪准备包括说服自己，如果发生不可想象的事情，至少我不是故意疏忽——只是无能（古老的“我只是人类”的借口）。;-)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-06T19:40:04.717

我已经为 MRI 机器编写了计算机界面。它没有机会伤害最终用户，因为它只是记录管理，但它可能会给出错误的诊断或遗漏重要信息。

测试，很多很多的测试。

单元测试，中级和高级测试。模拟所有可能的输入组合。还对硬件本身进行了大量测试。测试必须以完整和有条理的方式进行。测试应该比写作花费更多的时间。

错误报告

所有错误都必须报告并且显而易见。如果这样做不会损害专利，那就快失败吧。

对于积极维持一个人活着的东西来说，情况甚至更糟。它绝不能停止工作。如果失败，则需要重新启动并继续尝试。如果硬件发生故障，冗余内部也是必须的。

在错误的公司工作真的会很困难。但是，如果事情进展顺利，你有充足的资金并且释放压力不高，这可能是一个非常有回报的工作空间。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-06T20:03:15.137

不是真正的答案，但是：

我有一个朋友为激光眼科手术机编写嵌入式控制软件。当他自己进行激光眼科手术时，他一定会去看使用他公司系统的眼科医生。我非常钦佩这个人。我想不出我写过的软件质量水平高到我相信自己的视力。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-06T19:35:18.250

现在，我正在为一个系统开发一些基本代码，该系统从诊所和医院为医疗计费办公室检索医疗患者信息。我们从一个较小的客户端开始，并使用较长的磨合期来确保质量，但最终此代码需要*安全地*处理来自不同设施的多个客户端的各种报告格式。

它与您的示例的规模不完全相同，但是一个严重的错误可能会导致向错误的人收费或向正确的人收费到一个已失效的地址（搞砸信用报告）或使人们容易被盗，所以它仍然很漂亮危急。哦，是的，这可能意味着医生不会很快得到报酬。这也很重要，尤其是从业务角度来看，但与数据保护和完整性不同。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-06T23:45:21.553

我听说过关于在 NASA 为航天飞机编写代码的过程的疯狂故事。每行代码大约有 10-20 行文档，还有测试、完整的修订历史等。每次发现 bug 时，不仅是评估和修复代码，而是编写代码的整个过程，整个命令审查链等以回答以下问题：“我们的过程中发生了什么错误，导致该错误首先被包含在内？”

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-06T20:08:46.903

虽然没有什么比 MRI 机器或血压监测仪更重要的了，但当我为一家在线赌博提供商工作时，我确实得到了重写 Blackjack 的机会。二十一点是迄今为止最受欢迎的在线游戏，数百万美元将通过这个软件（并且确实如此）。

我将游戏引擎与服务器和客户端分开编写，并使用测试驱动开发来确保我的假设在结果中得到体现。我还有一个包装“服务器”，它有控制台输出，可以让我玩。这实际上只是因为它模仿了真实的服务器界面而有用，因为玩文本版本的二十一点不是很有趣也不是很容易（“你画了一个 10。你现在有一个 10 和一个 6，而庄家有一个 6显示。[bsd] >")

该游戏仍在一些网站上运行，据我所知，经过多年的游戏，从未出现过任何财务问题。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-07T01:54:22.573

我的第一个“真正的”软件工作是编写一个用于计划立体定向脑部手术的 GUI 应用程序。测试，测试，测试……绝对没有正式的方法，工程风格的思想，只有年轻的程序员在努力。当他们开始谈论使用软件来控制带有激光的机械臂时，没有任何严肃的工程方法，我有点担心，离开了更多的办公室。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-07T02:02:19.140

我为巴厘岛当地政府文化和旅游部门创建了信息系统应用程序，安装在多个旅游目的地，提供有关文化、地图、住宿等的广泛信息。

如果它失败了，那么游客可能无法获得他们最需要的正确信息，被经纪人欺骗，或者在某个地方迷路了 :)

# css - 由图像组成的动态调整大小选项卡

> ID：175835
> 
> 赞同：0
> 
> 时间：2008-10-06T19:35:58.483
> 
> 标签：css, firefox, internet-explorer-6, css-sprites

我正在尝试向我的网页添加一个选项卡，如下所示：![替代文字](https://i.stack.imgur.com/DT3e7.png)

以[这个例子](http://mattberseth.com/blog/2007/09/using_css_image_sprites_with_t.html)为基础，我已经让它部分工作了。我的情况不同，因为我希望文本部分是固定的，但尾部部分可以动态调整大小以占用选项卡容器的其余部分。

它在 IE 6 中看起来不错，但并没有真正占据容器的整个宽度。在 Firefox 3 中，它根本不能很好地呈现：（![替代文字](https://i.stack.imgur.com/Zeypv.png)红色是跨度之间的空白区域）。

如何让它在 IE6 和 Firefox 中正确呈现以占用为#Tab 指定的整个宽度？#Tab4 是我想调整大小以尽可能多地占用空间的区域。

```
 <style type="text/css">
    #Tab
    {
        width: 300px;
    }

    #Tab1
    {
        background: #000 url(BlueTabSprite.png) no-repeat 0 -136px;
        display: inline-block;
        height: 23px;
        padding-left: 4px;
    }

    #Tab2
    {
        background: #000 url(BlueTabSprite.png) repeat-x 0 -242px;
        display: inline-block;
        overflow: hidden;
        padding-top: 4px;
        height: 19px;
        width: 100px;
    }

    #Tab3
    {
        background: #000 url(BlueTabSprite.png) no-repeat right -30px;
        display: inline-block;
        height: 23px;
        padding-right: 6px;
    }

    #Tab4
    {
        background: #000 url(BlueTabSprite.png) repeat-x 0 -83px;
        display: inline-block;
        height: 23px;
        width:60%
    }

    #Tab5
    {
        background: #000 url(BlueTabSprite.png) no-repeat right -189px;
        display: inline-block;
        height: 23px;
        padding-right:6px;
    }
</style>
<div id="Tab">
    <span id="Tab1">
        <span id="Tab3">
            <span id="Tab2">Test Tab</span>
        </span>
    </span>
    <span id="Tab5">
        <span id="Tab4"></span>
    </span>
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-06T19:38:38.650

我认为[滑动门技术](http://alistapart.com/articles/slidingdoors/)可能是您正在寻找的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-06T19:50:13.057

这是一个有效的简化版本：

```
<div style="background: url('BlueTabSprite.png') no-repeat; width: 290px; min-width: 120px; max-width: 290px; height: 23px;">
<div style="float: right; background: url('BlueTabSprite.png') top right no-repeat; width: 10px; height: 23px;"></div>
Test
</div> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-02T01:41:09.033

这个[工具](http://www.pagecolumn.com/tool/top_tabs_generator.htm)可能会有所帮助。

# .net - System.Windows.Forms.WebBrowser 在同一窗口或具有同一会话的新窗口中打开链接

> ID：175836
> 
> 赞同：12
> 
> 时间：2008-10-06T19:37:05.610
> 
> 标签：.net, session, popup, browser, new-window

使用 .NET WebBrowser 控件时，如何使用相同的会话在新窗口中打开链接（即..不要在服务器上启动新的 ASP.NET 会话），或者如何捕获新窗口事件以在同一个 WebBrowser 控件中打开 URL？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-10-06T19:40:05.637

我只花了一个小时寻找答案，所以我想在这里发布结果。您可以使用 SHDocVwCtl.WebBrowser_V1 对象来捕获 NewWindow 事件。

注意：来自[http://www.experts-exchange.com/Programming/Languages/Visual_Basic/Q_21484555.html#discussion的代码](http://www.experts-exchange.com/Programming/Languages/Visual_Basic/Q_21484555.html#discussion)

```
//-------------------------------VB.NET Version:-------------------------------

Dim WithEvents Web_V1 As SHDocVwCtl.WebBrowser_V1

Private Sub Form_Load()
    Set Web_V1 = WebBrowser1.Object
End Sub

Private Sub Web_V1_NewWindow(ByVal URL As String, ByVal Flags As Long, ByVal TargetFrameName As String, PostData As Variant, ByVal Headers As String, Processed As Boolean)
    Processed = True
    WebBrowser1.Navigate URL
End Sub

//-------------------------------C# Version-------------------------------

private SHDocVw.WebBrowser_V1 Web_V1; //Interface to expose ActiveX methods

private void Form1_Load(object sender, EventArgs e)
{
    //Setup Web_V1 interface and register event handler
    Web_V1 = (SHDocVw.WebBrowser_V1)this.webBrowser1.ActiveXInstance;
    Web_V1.NewWindow += new SHDocVw.DWebBrowserEvents_NewWindowEventHandler(Web_V1_NewWindow);
}

private void Web_V1_NewWindow(string URL, int Flags, string TargetFrameName, ref object PostData,string Headers, ref bool Processed)
{
    Processed = true; //Stop event from being processed

    //Code to open in same window
    this.webBrowser1.Navigate(URL);

    //Code to open in new window instead of same window
    //Form1 Popup = new Form1();
    //Popup.webBrowser1.Navigate(URL);
    //Popup.Show();
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-05-06T15:02:20.037

稍微清理了格雷格答案的版本。它修改传入控件的行为，而不是依赖于全局变量。用法：

```
InlinePopups(webBrowser1); 
```

代码：

```
// interface to expose ActiveX methods
private SHDocVw.WebBrowser_V1 Web_V1;
private void InlinePopups(WebBrowser browser)
{
    // hooks to force new windows to open in the current instance
    Web_V1 = (SHDocVw.WebBrowser_V1)browser.ActiveXInstance;
    Web_V1.NewWindow += new SHDocVw.DWebBrowserEvents_NewWindowEventHandler((string URL, int Flags, string TargetFrameName, ref object PostData, string Headers, ref bool Processed) =>
    {
        Processed = true; // stop event from being processed

        // open in the existing window
        browser.Navigate(URL);
    });
} 
```

当然，仍然需要对 %WINDIR%\system32\shdocvw.dll 的引用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-07-22T16:42:39.123

如果您没有将actuasl 对象添加到您的工具箱（shwos 为“Microsoft 浏览器”），则将对 shdocvw.dll 的引用添加到您的项目后，然后在代码顶部定义该对象：

将事件 Web_V1 调暗为 SHDocVw.WebBrowser_V1

# c# - Repeater 控件中的 DropDownList，无法触发 SelectedIndexChanged

> ID：175845
> 
> 赞同：4
> 
> 时间：2008-10-06T19:38:45.717
> 
> 标签：c#, asp.net

我有一个转发器控件，在页脚中有一个 DropDownList。在我的代码隐藏中，我有：

```
protected void ddMyRepeater_ItemDataBound(object sender, RepeaterItemEventArgs e)
{
    if (e.Item.ItemType == ListItemType.Item
            || e.Item.ItemType == ListItemType.AlternatingItem)
    {
       // Item binding code
    }

    else if (e.Item.ItemType == ListItemType.Footer)
    {
        DropDownList ddl = e.Item.FindDropDownList("ddMyDropDownList");
        // Fill the list control
        ddl.SelectedIndexChanged += new  
           EventHandler(ddMyDropDownList_SelectedIndexChanged);
        ddl.AutoPostBack = true;
    }
 } 
```

该页面出现在 PostBack 但是我的 EventHandler 没有被调用。有任何想法吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-06T20:15:54.080

如果您只想触发 OnSelectedIndexChanged，它应该是这样的：

**Page.aspx - 源代码**

```
<FooterTemplate>
    <asp:DropDownList ID="ddlOptions"
             runat="server" 
             AutoPostBack="true" 
             onselectedindexchanged="ddlOptions_SelectedIndexChanged">
        <asp:ListItem>Option1</asp:ListItem>
        <asp:ListItem>Option2</asp:ListItem>
    </asp:DropDownList>
</FooterTemplate> 
```

**Page.aspx.cs - 代码隐藏**

```
protected void ddlOptions_SelectedIndexChanged(object sender, EventArgs e)
    {
        //Event Code here.
    } 
```

就是这样。不需要更多了。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2010-02-23T10:28:50.097

如果 DropDownList 在 Repeater 内，那么要触发 SelectIndexChanged 事件，您需要禁用 GridView / Repeater 上的 EnableViewState。

例如

```
EnableViewState="false" 
```

您还需要在每次回发时对 GridView / Repeater 进行数据绑定，以便在 Page Load 方法中对其进行数据绑定。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-06T19:48:10.767

我认为这是因为您可能没有对回发进行数据绑定。我尚未对此进行测试，但请尝试将该代码连接到您的中继器的 ItemCreated 事件。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-23T14:59:50.777

我认为问题在于下拉列表控件不在重复器内部，而是在页脚上。我不认为 reperter 的事件会触发页脚上的控件。您应该尝试将下拉控件置于中继器控件之外。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-06T20:00:54.097

ASPX 端的 DropDownLists 上的 AutoPostBack 属性是否设置为 True？我知道有时这个属性最初没有设置，它会阻止 SelectedIndexChanged 事件触发。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-06T20:41:52.827

在这种情况下，您的父转发器 (ddMyRepeater) 必须在每次回发时将自身数据绑定到 page_load 中。这是我发现让嵌套控件触发其事件的唯一方法。

不过，这可能不是您的理想方案。根据您的页面正在执行的操作，您可能必须将此控件数据绑定两次。一次是让事件触发，第二次是如果触发的事件导致转发器的数据以任何方式发生变化。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-06-24T19:06:48.330

确保为下拉列表启用 ViewState

# jquery - Valid jQuery on Development fails on Production

> ID：175847
> 
> 赞同：2
> 
> 时间：2008-10-06T19:39:47.587
> 
> 标签：jquery

I am writing a fairly basic script using jQuery. However, the script behaves differently depending on whether I am running it on my local Web server (localhost) or on a production server.

On development, the following code returns the HTML I'm expecting:

```
$('#objID').siblings('.mAddress').html(); 
```

On production, the same statement returns `undefined`.

The document structures are the same on both machines. The only difference I can find is when I use Firebug to step through the script. On the development machine, putting a watch on $('#objID').siblings('.mAddress') results in `[ span#object ]` while on production the same watch results in `[ [ span#object ] ]`
(Notice the double sets of square brackets).

Any ideas?

Added:

I've verified that the two libraries are identical.

I've done some more experimenting using Firebug. Another part of the script grabs a set of elements using the statement:

```
$('.ParentColumn2').each(function(i) { ... }) 
```

Within the body of that function, if I set a watch on `this`, on development the value of `this` is what I expect: `div.ParentColumn2` , but on production the value of `this` returns what looks like an array: `[ div.ParentColumn2, div.ParentColumn2, div.ParentColumn2, .....]`

The HTML is basically a table (I've stripped out irrelevant HTML, and the rows repeat):

```
<table>  
 <tr>  
  <td>  
    <div class="ItemTemplate">  
      <div class="ParentColumn2">  
        <div><span id="dnn_ctr45874_ViewProjectGrid_GridView1_ctl02_lbl_Address" class="lbl_Address mAddress">111 W Wacker Dr, </span><span id="dnn_ctr45874_ViewProjectGrid_GridView1_ctl02_lbl_City" class="lbl_Address mCity">Chicago</span>&nbsp;<span id="dnn_ctr45874_ViewProjectGrid_GridView1_ctl02_lbl_PostalCode" class="lbl_Address mPostalCode">60601</span>&nbsp;<a href="javascript:MapMe(this);" id="dnn_ctr45874_ViewProjectGrid_GridView1_ctl02_hypMap" class="hypMap">Map</a>&nbsp;&nbsp;<span id="dnn_ctr45874_ViewProjectGrid_GridView1_ctl02_lbl_Area" class="mArea">Loop</span><span id="dnn_ctr45874_ViewProjectGrid_GridView1_ctl02_lt" class="mLt">41.8868010285473</span><span id="dnn_ctr45874_ViewProjectGrid_GridView1_ctl02_lg" class="mLg">-87.6312860701286</span>  
        </div>  
      </div>  
    </div>  
  </td>  
 </tr>  
 <tr>  
  <td>  
    <div class="ItemTemplate">  
      <div class="ParentColumn2">  
        <div><span id="dnn_ctr45874_ViewProjectGrid_GridView1_ctl03_lbl_Address" class="lbl_Address mAddress">...</span> ...  
        </div>  
      </div>  
    </div>  
  </td>  
 </tr>  
</table> 
```

The HTML is as identical between the two machines as can be possible given that it's all generated by .Net (don't get me started).

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-06T22:21:05.123

鉴于您有不同的行为，可以合理地假设两个页面之间*有所*不同，因此我的建议是将两个页面减少到保持当前行为的最低限度，然后看看有什么不同。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-07T00:11:05.527

我不使用 .siblings() ...（或不需要）...

根据 jquery docs .... 在 div （如下）上运行 .siblings() 不会返回任何内容，但在其中一个 p 上 $('p:first') 会返回另一个

```
<div><p></p><p></p></div> 
```

尝试使用

```
$('#objID').find('.mAddress').html(); 
```

或者

```
$('#objID').children('.mAddress').html(); 
```

或者

```
$('#objID .mAddress').html(); 
```

似乎很奇怪，它可以在 dev 上工作，但不能在生产上工作……但试试看。

-布鲁斯

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-09T18:51:48.603

您的代码是否在 $(document).ready(function() { ... }); ?

如果不是，这可能会导致不同的行为。在您的本地开发机器上，可能所有内容都加载得如此之快，以至于 DOM 树按您的 Javascript 调用的类型完成，但在生产服务器上，事情可能还没有完成。

但并未解释 FireBug 中出现的额外嵌套括号。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-08T21:47:23.473

我想说几个需要关注的领域是缓存，在您的开发环境中，每个请求都可能重新加载所有内容，请尝试在您的 javascript 包含标记的末尾放置一个“？asdfasfrandom”，以确保所有内容都得到更新。

如果不是这样，您的 javascript 文件在您提供服务时是否会合并？例如，在 Rails 中，默认行为是将它们全部放入一个文件中，这可能会造成混乱。

如果不是这样，那么可能是服务器上的 javascript 文件以不同的顺序加载，或者由于下载时间而以与本地不同的顺序执行。尝试在执行代码之前确保 dom 已准备就绪。

基本上，您的代码似乎可能不是问题（假设您使用相同的浏览器并具有相同的 HTML），但是事情发生的顺序有问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-09T00:31:37.357

在 dev 中放入与 prod 中相同的数据，然后为两者转储视图源并进行差异。

为什么要使用兄弟姐妹属性而不仅仅是：

```
$('#objID .mAddress').html(); 
```

另外我认为兄弟姐妹和上面的都返回一个项目数组，而不仅仅是一个项目，所以我可能会选择这样的东西：

```
$($('#objID .mAddress').get(0)).html(); 
```

仅返回第一项的 html。

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2008-10-06T19:43:04.803

~~I don't regularly use jQuery but my first suspicion is that your libraries are out of sync.~~

# commercial-application - 您如何保护您的商业应用程序不使用一个许可证安装在多台计算机上？

> ID：175857
> 
> 赞同：15
> 
> 时间：2008-10-06T19:41:02.950
> 
> 标签：commercial-application

您如何保护您的商业应用程序不被仅拥有一个许可证的人安装在多台计算机上？

你认为不仅仅是基于串行的方案是个好主意吗？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-10-06T19:50:24.290

我的一般规则是

*   商业环境中的大规模部署 -**审计**
*   低价值软件的中等部署 < 1000 美元/席 -**许可证密钥激活**
*   高价值软件的小型部署 > 10,000 美元/座 -**加密狗**

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-10-06T20:27:07.757

> 你认为不仅仅是基于串行的方案是个好主意吗？

作为一个必须在各种机器上安装各种软件的人，在考虑您的复制保护方案时，请为可怜的网络管理员考虑一下。请，请，在编写您的安装程序时考虑网络范围的安装 - 一定要包括某种序列号保护，甚至让我打电话或联系您的网站并获取授权代码以获取站点范围的安装程序代码或其他，但请确保您的许可代码*有效*。确保您的技术优于市场上任何其他软件的一个好方法不会被安装和使用是弄乱安装程序或拥有一个太麻烦的安装系统。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2008-10-06T19:58:28.470

只要您有一个公共服务器可供您使用，以下方法就可以很好地工作：

*   基于串口的保护，用户在使用程序前必须输入一个串口
*   在第一个串行条目上，将串行绑定到 MAC 地址并创建一个从这两个值生成的身份验证代码。
*   检查您的服务器以确保串行和 MAC 可以相互绑定。在服务器上注册 MAC。
*   在随后的每次运行中，永远不要再次联系服务器，但每次都要确保序列号 + MAC 地址与他们的身份验证码匹配。
*   如果用户没有 MAC 地址，只要他们有串口，就允许他们运行程序。

这使您可以防止有人简单地将注册表从一台计算机复制到另一台计算机。

如果用户尝试在另一台计算机上安装相同的序列号，服务器将不允许您将序列号绑定到 MAC 地址，因为它已经绑定。

这不是一个完美的解决方案，但它可以在 99% 的时间内保护您。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-04-25T10:55:38.537

使用机器锁定许可证或需要激活的许可证将许可证锁定到特定机器。与其自己开发这样的方案，不如考虑使用支持这些功能的即用型方案，例如[CryptoLicensing 。](http://www.ssware.com/cryptolicensing/cryptolicensing_net.htm)

免责声明：我为 CryptoLicensing 的开发商 LogicNP Software 工作。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-06T20:20:19.347

我们使用 MAC 地址加许可证文件的方法。我们让客户将其 PC 的 MAC 地址发送给我们，然后根据该 MAC 地址生成许可证文件。然后我们通过电子邮件将文件发送给他们，然后他们将许可证文件加载到程序中。不利的一面是，如果人们换掉网卡，您将不得不向他们颁发新的许可证。需要更多的簿记以确保人们并不总是要求新的许可证，并且对您的客户群有一点信任，他们不会试图过多地玩弄系统。根据该信任级别，您可以在文件中添加编码或加密层，这样他们就不能轻易复制文件。从好的方面来说，您不必实现或维护任何类型的身份验证服务器。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-06T19:46:11.770

如果软件值得，您可以随时使用 USB 加密狗。当然，所有加密狗制造商都声称他们的复制保护不能被破坏。

这种方法的优点是它允许用户在多台计算机上使用该软件，但一次只能在一台计算机上运行，​​实际上并不像某种产品激活那样麻烦。当然，缺点是您不能完全以电子方式部署应用程序。尽管您可能会认为相反，但实际上许多客户似乎接受使用加密狗，至少在我工作的领域中。如果您希望您的客户在某个地方使用（并安装！）该软件，它会特别有用没有互联网连接的地方。

编辑：我在原始问题中过度阅读了基于序列的内容。请注意，即使这样也可能比安装加密狗更让用户烦恼，而且对您来说也更容易，因为客户和您都不必处理这些数字。插入加密狗，应用程序即可运行。但是，仅串行方法是迄今为止最便宜的。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-10-16T21:30:56.080

我们使用 Agilis 的 Orion。对于我们的一些用户，我们会激活节点锁定许可证，对于其他用户，他们通过网页或电子邮件获得激活，对于其他用户，我们在他们的场所放置许可证服务器。Orion 涵盖了我们需要的所有基础。

# wpf - 我可以以编程方式将 FlowDocument 保存到 BAML 吗？

> ID：175858
> 
> 赞同：2
> 
> 时间：2008-10-06T19:41:10.640
> 
> 标签：wpf, visual-studio-2008, flowdocument

有没有人找到将 FlowDocument 保存为 BAML 或其他压缩格式的方法？我可以导入带有图像的 XML 来创建新的 FlowDocument：

```
<TextRange class instance>.Load(fs, DataFormats.Rtf) 
```

但是，我还没有找到一种以“本机”压缩格式保存它的好方法。使用以下方法很容易生成未压缩的 XAML：

```
<TextRange class instance>.Save(fs, DataFormats.Xaml); 
```

但是有没有任何编程方法可以将其保存为压缩格式？

如果没有现有方法，有谁知道在哪里可以找到编程 XAML 编译器？或者甚至只是 BAML 规范？我可以以编程方式生成一个嵌入 FlowDocument 的整个 XAML 窗口，但我仍然希望将 XAML 转换为 BAML 以加快加载时间。我正在使用相对较大的 rtf 文档，并且使用 DataFormats.Rtf 的转换时间很重要。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-07T06:12:29.713

我不认为这是可能的...... BamlWriter 被标记为内部，这有望很快开放！

不幸的是，我不知道任何 XAML 编译器

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-08T18:25:45.050

好吧，事实证明您可以在没有 GUI 的情况下运行 Visual C# 2008 Express。您也可以在编译之前通过代码修改最终程序名称。我相信你可以通过 API 来做到这一点，但这是我发现的 hack：

1.  该程序的名称在 .csproj 中的 xml 标记中确定。
2.  通过代码或批处理文件运行： "\Common7\IDE\vcsexpress" ".sln" /rebuild Release /projectconfig Release /out errors.txt

我喜欢在每次运行后检查并删除 errors.txt，以便更容易查看我是否获得了干净的构建。这并不理想，因为您必须在以这种方式使用的每台机器上安装完整的 Visual C# 2008 版本，但这是一种创建新可执行文件以以编程方式显示每个流文档的方法。此外，如果您的 XAML 中有错误，您可能会生成一个无法运行的程序。

请注意，BAML 格式不压缩文本，只压缩标签和其他“管道”。甚至 Margin 和 Padding 信息也以清晰的 ASCII 格式保存。这是由 end .exe 继承的，使文本在记事本或类似的部分中清晰可见。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-26T13:45:33.053

XamlPackage 格式被压缩：

```
<TextRange class instance>.Save(fs, DataFormats.Xaml); 
```

# vba - 通过右键单击将发件人电子邮件动态添加到 Outlook 2007 中的邮件标题规则

> ID：175859
> 
> 赞同：1
> 
> 时间：2008-10-06T19:41:29.440
> 
> 标签：vba, outlook, rules, outlook-2007

我希望 Outlook 2007 的 VBA 代码在任何邮件视图中右键单击邮件，选择将其添加到的规则，并将发件人电子邮件添加到邮件标题包含该规则的值。

只有特定的规则使用消息标题作为标准，所以当我右键单击消息时，只有那些适用的规则应该显示。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-07T17:27:57.180

稍加努力，您就可以[使用 VBA 操作上下文菜单](http://www.outlookcode.com/codedetail.aspx?id=314)。

2007 年之前的任何 Outlook 版本都没有规则的对象模型。

但是从 OL2007 开始，每个 Store 对象都公开了 GetRules() 方法，该方法返回一个 Rules 集合。尝试迭代该集合并使用您想要的所有规则填充 CommandBarPopup 对象。Rule 对象可以被操纵，所以理论上你应该能够完成这项工作。

# visual-studio - 注意将引用库添加到项目（Visual Studio 2008 插件）

> ID：175860
> 
> 赞同：2
> 
> 时间：2008-10-06T19:41:48.970
> 
> 标签：visual-studio, visual-studio-2008, plugins, reference

我希望有人可以帮助我解决这个问题。我一直在寻找但似乎找不到的是是否有某种方式可以添加一个事件，或者任何其他可以允许视觉工作室插件监视外部引用被添加到当前打开的解决方案的东西/ 项目？

或者更好的是，有人会碰巧知道一个插件，它会自动将引用的 dll 中的所有控件添加到 Visual Studio 工具箱中吗？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-01-03T18:34:52.123

不完全是你问的，但我写了一个 Visual Studio 2008 集成包，如果我没记错的话，我可以覆盖“添加引用”方法，以及继承“引用节点”，从而改变它的行为，例如它的构造函数。

加载项可能缺少此功能（它比集成包更受限制），因此您可以考虑编写一个包。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-24T08:16:47.460

如果您将项目添加到解决方案（反之亦然），我编写了一个宏，它将更改文件引用到项目引用，但我认为这不是您想要的？

# iphone - 如何在 Interface Builder 中为 UIImage 连接引用插座？

> ID：175869
> 
> 赞同：1
> 
> 时间：2008-10-06T19:43:57.687
> 
> 标签：iphone, objective-c, cocoa-touch, interface-builder

我想以编程方式访问 UIImage ......即 myImage.hidden = TRUE; 等等。我可以为 UILabel 做到这一点，但是当我为 UIImage 重复该过程时，它不起作用。特别是当我将 Interface Builder 中的蓝线拖到图标上时，我没有像使用 UILabel 时那样获得弹出菜单。

也许使用 UIImageView 而不是 UIImage？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-06T20:37:48.513

UIImage 不是可以通过 Interface Builder 添加的视图。为了显示 UIImage，您要么需要覆盖要在其中显示它的任何视图的 drawRect 方法，要么使用 UIImageView。

使用 UIImageView 将允许您将其设置为 IBOutlet 并在控制器中引用它。

# browser - 浏览器需要多少百分比的市场份额来获得您的支持？

> ID：175878
> 
> 赞同：8
> 
> 时间：2008-10-06T19:46:28.010
> 
> 标签：browser

我正在为一个小型非营利组织建立一个网站。我想知道在我支持浏览器之前应该拥有什么样的浏览器市场份额。Chrome 看起来像是一个主要的竞争者，但它仍然不到 5%，Opera 也是如此。

你认为我应该完全支持什么样的浏览器来支持这种项目？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-10-06T19:55:12.330

我将支持 Robert S 的回答，并扩大一点。

如果您从最初的概念开始就花时间去符合标准并使用 CSS 生成干净的 XHTML，那么您将为自己省去大部分的痛苦。您可能会非常接近所有浏览器的预期输出。当然，由于盒子模型的实现方式，会有一些像素级的不稳定，但你可能会“足够接近”，不需要额外的费用。

我不会故意“调整”我的网站以确保它适用于所有浏览器——不仅昂贵（在时间方面），而且随着浏览器越来越接近它也注定要失败对标准的干净支持。

FWIW，Chrome 是您绝对应该使用的浏览器。正如其他人所提到的，它基于 Apple 的 WebKit。测试 Chrome 和 Windows 版本的 Safari 将使您能够很好地处理您的站点在 Mac 平台上的用户体验，至少在您没有可用于测试的 Mac 的情况下是这样。:)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-06T19:50:50.747

1.  Firefox、IE7和IE6足以覆盖90%以上的浏览器市场份额。
2.  阅读新的 Web 标准并考虑 Microsoft 为 IE8 做的准备是一个好主意。
3.  然后你可以尝试兼容谷歌浏览器。
4.  最后，应该有一个非常具体的客户要求来投入时间和金钱来支持其他浏览器，如 Opera、Safari 等

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-10-06T20:30:51.057

这是我的测试/错误修复优先级列表：

*   完全支持**Firefox 3**和**IE7**绝对**必要**
*****   强烈**建议**完全支持**Opera**和**Safari**（不缺少功能，界面略有下降是可以接受的，但仅在绝对必要的情况下）*   **IE6**和**Firefox 2**的界面**退化**是可以接受的，只要它仍然可用（我认为这些是“生命终结”的浏览器，坦率地说，很少值得付出努力），这里还有旧版本的 Opera 和 Safari，但我很少看到这些的重大问题。*****   如果界面不严重依赖 Javascript，那么它必须足够优雅地降级以在基于文本和移动浏览器（例如 Opera Mobile、Links/Lynx、iPhone 等）中使用（这包括对屏幕尺寸进行任何必要的优化**）***   信息（即非应用程序）网站必须至少使用屏幕阅读器进行测试*   **我不会在支持Firefox 1**和**IE5.5**或更低版本上投入大量精力。

    *   必须对新功能进行**测试，并且至少**可以与即将推出的浏览器（例如**IE8**和**Chrome** ）一起使用。忽略这些毫无意义，因为它们都可能在未来几个月和几年内变得非常流行。******** 

 ****当然，确定什么对您有用的唯一方法是查看您自己的使用统计信息。您可能会发现很大一部分用户仍在使用 IE6（许多企业尚未升级），或者移动设备使用率特别高等。**请查看您自己的统计数据！**

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-10-06T19:52:27.640

这不是市场份额的问题。这是我们的客户使用什么的问题。

当您的客户是经常资金不足的公立学校时，您会避开很多 Flash 和 Flash。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-06T19:48:11.610

显而易见的答案是 Firefox 和 IE。我建议从符合标准的 XHTML 开始，然后从那里开始。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-10-06T20:52:53.010

我不会仅仅基于市场份额做出这个决定，甚至主要是基于市场份额。我的支持列表（按优先级排序）目前看起来像这样，除非客户表示需要扩展它：

*   野生动物园 3
*   火狐 2
*   火狐 3
*   即 7
*   IE 8 测试版
*   面向公众的功能在 IE 6 中有效，看起来正确
*   铬合金

我采用这种方法的原因是，首先，最好在调整到损坏的引擎之前在符合标准的浏览器中工作。其次，Safari 拥有最大的标准支持以及不可忽视的市场份额（Opera 很难证明成本的合理性：利益原因）。第三，根据我的经验，从 Safari 到 Firefox 的问题通常比其他方式少。这是主观的，但这是我的经验。

同样首先针对 Safari 的副作用是，IE 可能不会那么痛苦，因为 Webkit 团队已经竭尽全力尽可能地遵守现有的做法。

Chrome 排在最后，因为如果 Safari 很好用，它很可能“正常工作”。

编辑：Firefox 2 出现在 Firefox 3 之前，因为它的支持集受到更多限制。IE 8b 之前的 IE 7 也是如此。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-06T19:48:36.553

好吧，由于 Chrome 是基于 WebKit 的，如果你测试 Safari，Chrome 很可能也能正常工作。

我倾向于完全忽略 Opera。这可能使我成为一个坏人，但我可以接受。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-10-06T19:48:51.453

这取决于应用程序的重要性。

对于一家小型非营利组织，我 [个人] 不会费心用 < 4-5% 份额的浏览器进行测试。但是，您仍然应该尽可能将您的代码开发为与浏览器无关

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-10-06T20:29:36.097

我个人同意安迪·莱斯特的观点，真正的关键是了解目标受众的平台。是的，在全球范围内，Chrome 可能拥有 3-5% 的市场份额，或类似的份额，但如果您的非营利组织以开发人员为目标，您的采用率可能会高得多。因此，除了大家在这里所说的之外，还要了解你的听众。

我知道我的网站针对技术人员，我看到大约 30% 的 FireFox、55% 的 IE、12% 的 Chrome，其余的是我的访问者。由于我的观众，与规范有很大不同。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-01-22T09:36:18.300

我喜欢密切关注雅虎的分级浏览器支持页面。我通常只花时间担心在他们认为是“A 级”的浏览器上让一切变得完美。我通常会尝试逐步增强，而不是优雅地降级，这意味着在大多数情况下，我可以在“C 级”浏览器上获得基本功能。

[http://developer.yahoo.com/yui/articles/gbs/index.html](http://developer.yahoo.com/yui/articles/gbs/index.html)

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-10-06T20:43:03.450

我个人喜欢将浏览器分为两大类：

1.  IE：考虑到它的市场份额，你应该始终致力于支持 IE。
2.  其他（Firefox、Opera、Safari、Chrome）：如果您努力编写符合标准的 HTML、CSS 和 JavaScript，那么在这些浏览器中的任何一个中都可以使用的内容**很可能**与其他浏览器一起使用。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-10-06T22:42:18.887

从 Firefox 和 IE 开始。如果你还有时间，你可能不会，你可以看看其他的:)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-10-06T19:53:45.797

恕我直言，更重要的是做好将表示层与业务逻辑分开的工作。尽量灵活，让用户决定方向。您现在可能会说，Webkit 没有足够的用户，但一个月后您的客户决定为所有员工购买 iPhone。（我知道你说的是非营利，但我认为例子仍然成立）试着让自己处于一个灵活的位置。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-10-06T20:59:38.033

我建议您尽量遵守 w3 发布的标准。如果您的应用程序符合要求，您对未来版本的浏览器也将是安全的。

使用 FF 进行设计并最终修复 IE，这样您就可以节省工作量。

关于 JavaScript，请使用 JQuery 或 DomAssistant 等框架来编写适用于所有浏览器的代码。但请注意不要让导航或内容依赖于客户端脚本，提供一个替代方案来支持几乎 7% 的不启用 java 的功能。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-10-06T22:47:58.597

先做符合标准的引擎：WebKit (Safari/Chrome) 和 Gecko (Firefox)。Opera 通常也可以正常工作。然后去添加IE支持。IMO，任何预览版不支持完整 CSS2 规范的浏览器都不值得 A 级支持。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-01-22T08:49:57.223

**火狐 3、IE 7、IE 6**

Firefox 是最重要的，主要是因为它可以在 OSX 和 Windows 上运行，并且具有很高的市场份额，这意味着如果您的网站在 Firefox 上运行，它也可以供 mac 查看器使用。密切关注 IE 7，这很重要，因为它的浏览器共享和被 Windows 打包意味着任何拥有新 Windows 框的人都将拥有它。

不幸的是，有些人运行旧版本的 Windows（2000 年之前的任何版本）无法从 IE 6 更新到更现代的浏览器。这确保了接下来应该有 10% 的人使用 IE 6。实际上大约有 20% 的人仍在使用 IE 6，因此这表明即使是一些使用现代操作系统的人也没有升级。

**Safari 和 Chrome**齐头并进，因为它们都使用类似的引擎，这使它们成为兼容性测试的下一个合乎逻辑的步骤。因为它们都使用 webkit，并且 safari 在 windows 和 mac（作为默认浏览器）上都运行，所以 Safari 更重要的是要小幅测试。Chrome 是一个合乎逻辑的选择，因为如果你在 Safari 上使用它，它就可以在 Chrome 上运行，而且它在浏览器统计数据方面有一个非常强劲的开端，因为它是如此的新。

**Opera**是完全可选的，除非您决定要开发一个必须在 Nintendo Wii 上查看的网站。计算机上可以使用 Opera 的任何人很可能都足够精明，还安装了另一个浏览器，他们可以使用该浏览器查看您的网站。Opera 使用自己的自定义解析器，并且它的浏览器份额很低，因此如果您的网站在除 Opera 之外的所有内容上都显示良好，那么没有令人信服的理由去竭尽全力。考虑到低数字和其他更强大的浏览器，他们确实有责任让他们的浏览器诚实地在您的网站上运行。

* * *

不幸的是，IE 6 和 IE 7 都需要过滤器破解才能使不透明度工作，并且 IE 6 有许多不兼容之处，并且在不处于严格模式时仍然需要盒子模型破解，并且无论如何都有浮动错误，因此严格遵守网络标准不是一个选项，但如果您确实遵循 Web 标准并使用有条件的 IE 评论，那么您很可能会拥有一个跨浏览器运行的网站，而且头痛最小。

# java - 非托管线程 Spring Quartz Websphere Hibernate

> ID：175880
> 
> 赞同：9
> 
> 时间：2008-10-06T19:46:37.150
> 
> 标签：java, hibernate, spring, websphere, quartz-scheduler

看来我们使用 Quartz - JDBCJobStore 以及 Spring、Hibernate 和 Websphere 的实现正在抛出非托管线程。

我做了一些阅读，发现 IBM 的一篇技术文章指出使用 Quartz 和 Spring 会导致这种情况。他们建议使用 CommnonJ 来解决这个问题。

我做了一些进一步的研究，到目前为止我看到的唯一例子都是处理不在数据库中的旧 JobStore 计划。

所以，我想知道是否有人有这个问题的解决方案的例子。

谢谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-07T14:06:00.130

我们有一个可行的解决方案（实际上是两个）。

1) 更改石英源代码以将 WorkManager 守护线程用于主调度程序线程。它有效，但需要更换夸脱。不过我们没有使用这个，因为我们不想维护一个被破解的石英版本。（这提醒了我，我打算将这个提交给项目但完全忘记了）

2) 创建一个 WorkManagerThreadPool 用作石英线程池。实现quartz ThreadPool 的接口，以便在quartz 中触发的每个任务都包装在一个commonj Work 对象中，然后该对象将在WorkManager 中调度。关键是 WorkManagerThreadPool 中的 WorkManager 必须在调度程序启动之前从 Java EE 线程（例如 servlet 初始化）初始化。然后 WorkManagerThreadPool 必须创建一个守护线程，该线程将通过创建和调度新的 Work 对象来处理所有已调度的任务。这样，调度程序（在它自己的线程上）将任务传递给托管线程（工作守护进程）。

不简单，不幸的是我没有现成的可包含的代码。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-07-19T09:16:21.983

为线程添加另一个答案，因为我终于找到了解决方案。

**我的环境**：WAS 8.5.5，Quartz 1.8.5，没有 Spring。

**我遇到的问题**是（上述）非托管线程导致 NamingException `ctx.lookup(myJndiUrl)`，而是在其他应用程序服务器（JBoss，Weblogic）中正确工作；实际上，Webpshere 正在触发一个带有以下消息的“事件”：

> *javax.naming.ConfigurationException：无法完成对“java:”名称的 JNDI 操作，因为服务器运行时无法将该操作的线程与任何 J2EE 应用程序组件相关联。当使用“java:”名称的 JNDI 客户端未在服务器应用程序请求的线程上执行时，可能会发生这种情况。确保 J2EE 应用程序不会在静态代码块或由该 J2EE 应用程序创建的线程中对“java:”名称执行 JNDI 操作。此类代码不一定在服务器应用程序请求的线程上运行，因此不受“java:”名称上的 JNDI 操作的支持。*

以下步骤解决了该问题：

**1）** 升级到quartz 1.8.6（没有代码更改），只是maven pom

**2)** 将以下 dep 添加到类路径（在我的例子中，EAR 的 /lib 文件夹），以使新的 WorkManagerThreadExecutor 可用

```
<dependency>
  <groupId>org.quartz-scheduler</groupId>
  <artifactId>quartz-commonj</artifactId>
  <version>1.8.6</version>
</dependency> 
```

注意：在[QTZ-113](http://jira.terracotta.org/jira/browse/QTZ-113)或官方 Quartz 文档[1.x](http://quartz-scheduler.org/documentation/quartz-1.x/configuration/) [2.x](http://quartz-scheduler.org/documentation/quartz-2.2.x/configuration/)中没有提及如何激活此修复程序。

**3)** 将以下内容添加到 quartz.properties（“wm/default”是我的 WAS 8.5.5 中已配置的 DefaultWorkManager 的 JNDI，请参阅WAS 控制台中的*Resources -> AsynchronousBeans -> WorkManagers ）：*

```
org.quartz.threadExecutor.class=org.quartz.custom.WorkManagerThreadExecutor
org.quartz.threadExecutor.workManagerName=wm/default 
```

注意：正确的类是*org.quartz。***用于quartz-scheduler-1.8.6（已测试）或*org.quartz的******自定义****.WorkManagerThreadExecutor 。****commonj*** *.WorkManagerThreadExecutor*从**2.1.1**开始（未经测试，但在 maven 的 repos 上的实际[quartz-commonj 的 jar中验证）](http://mvnrepository.com/artifact/org.quartz-scheduler/quartz-commonj)****

 ******4)****在石英作业的空构造函数中** 移动了JNDI 查找（感谢[m_klovre 的“J2EE 容器外的线程”](http://forum.springsource.org/showthread.php?61458-Spring-Quartz-JNDI-in-WebSphere-problem&p=233179#post233179)）；也就是说，构造函数是`newInstance()`从我的应用程序的同一个 J2EE 上下文中通过反射（方法）调用的，并且可以访问`java:global`命名空间，而该`execute(JobExecutionContext)`方法仍在较差的上下文中运行，它缺少我的应用程序的所有 EJB

希望这可以帮助。

附言。作为参考，您可以在[此处](https://gist.github.com/pcompieta/783eeea8341e532ba9f7)找到我在上面使用的 quartz.properties 文件的示例

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-08T15:23:40.433

检查这篇文章： [http ://www.ibm.com/developerworks/websphere/techjournal/0609_alcott/0609_alcott.html](http://www.ibm.com/developerworks/websphere/techjournal/0609_alcott/0609_alcott.html)

基本上，将 SchedulerFactoryBean 上的 taskExecutor 属性设置为使用 org.springframework.scheduling.commonj.WorkManager TaskExecutor ，它将使用容器管理的线程。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-07-18T08:45:06.490

请注意：上述 QUARTZ-708 的链接不再有效。这个新问题（在新的 Jira 中）*似乎*正在解决这个问题：[http](http://jira.terracotta.org/jira/browse/QTZ-113) ://jira.terracotta.org/jira/browse/QTZ-113 (fixVersion = 1.8.6, 2.0.2)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-05-04T21:30:52.637

我最近遇到了这个问题。实际上你需要：

1.  通过将工作委派给 Websphere Work Manager 来实现线程池。（Quartz 仅提供在非托管线程上运行作业的 SimpleThreadPool）。`org.quartz.threadPool.class`通过属性告诉quartz使用这个线程池
2.  通过属性告诉石英使用`WorkManagerThreadExecutor`（或实现自定义）`org.quartz.threadExecutor.class`
3.  对繁琐的遗留 Web 容器有点耐心 :)

这是使用 Quartz 和 Websphere（以及 Tomcat）的[**g​​ithub 演示。**](https://github.com/pufface/quartz-minimal "石英最小演示")

希望它可以帮助某人..

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-09-22T13:10:10.097

您可以查看以下关于石英的 JIRA 链接。

[http://jira.opensymphony.com/browse/QUARTZ-708](http://jira.opensymphony.com/browse/QUARTZ-708)

这具有所需的 WebSphereThreadPool 实现，可以与上述的quartz.properties 中的更改一起使用以满足您的要求。希望这可以帮助。

问候，湿婆

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-10-15T21:12:09.470

您将不得不使用 websphere 的托管线程池。你可以通过 spring 和 commonj 做到这一点。CommonJ 可以有一个任务执行器来创建托管线程。您甚至可以使用对 jndi 托管线程资源的引用。然后，您可以将 commonj 任务执行器注入基于 Spring 的 Quartz SchedulerFactoryBean。

请参阅[http://open.bekk.no/boss/spring-scheduling-in-websphere/](http://open.bekk.no/boss/spring-scheduling-in-websphere/)并滚动到“Quartz with CommonJ”部分了解更多详细信息。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-07-22T15:10:48.197

PaoloC 针对 WAS85 和 Quartz 1.8.6 的提议也适用于 WAS80（和 Quartz 1.8.6），并且不需要 Spring。（在我的设置中存在 Spring 2.5.5，但在该上下文中未使用。）

这样我就可以通过我自己的变体覆盖 SimpleJobFactory，使用 InjectionHelper 将 CDI 应用于每个新创建的作业。注入适用于@EJB（使用带注释的EJB 远程业务接口的JNDI 查找）和@Inject（使用新的InitialContext 的CDI BeanManager 的JNDI 查找，然后使用这个新获取的BM 来查找CDI bean 本身）。

感谢 PaoloC 的回答！（我希望这篇文章将作为“PaoloC 的答案”出现，而不是作为主题的答案。找不到区分这些的方法。）

# sql-server - SQL Server Express 2008 与 SQL 2005 Express 并排安装失败

> ID：175881
> 
> 赞同：41
> 
> 时间：2008-10-06T19:46:38.027
> 
> 标签：sql-server

当我尝试在已经启动并运行 SQL 2005 Express 的开发计算机上安装新的 SQL Server 2008 Express 实例时，安装验证失败，因为安装了“SQL 2005 Express 工具”并且我被告知要删除它们。

**这到底是什么意思呢？**

看完这篇文章后：

[http://www.asql.biz/Articoli/SQLX08/Art1_5.aspx](http://www.asql.biz/Articoli/SQLX08/Art1_5.aspx)

我卸载了 2005 版本的 SQL Management Studio，但在我的后续尝试中从 2008 安装程序收到了相同的错误。

**更新**

1) 仅卸载 SQL 2005 Management Studio。从 2008 安装中收到相同的错误。

2) 删除了所有 SQL 2005 通用组件。从 2008 安装中收到相同的错误。

3) 从 SQL 2008 安装程序安装共享组件。尝试安装新的 SQL 2008 实例时，从 2008 安装中收到相同的错误。

4) 卸载 SQL 2008 组件，重新启动，从安装媒体重新安装 SQL 2005 Management Studio，重新启动，从控制面板卸载 SQL 2005 工作站组件，重新启动。

SQL 2008 的安装现在正在正常进行。

似乎如果我在上述更新 2 之后重新启动，事情会变得更顺利。:-(

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2008-10-06T19:48:48.957

尽管在 2008 实例旁边运行数据库引擎的 2005 实例应该没有问题，但这些工具安装在共享目录中，因此您不能安装两个版本的工具。幸运的是，2008 工具是向后兼容的。正如我们所说，我正在使用 SSMS 2008 和 Profiler 2008 来管理我的 2005 Express 实例。效果很好。

在安装 2008 工具之前，您需要从 2005 中删除所有“共享”组件。尝试转到“添加/删除程序”控制面板，找到 Microsoft SQL Server 2005，然后单击“更改”。然后选择“工作站组件”并删除那里的所有内容（这不会删除您的数据库引擎）。

我相信 2008 安装程序还可以选择仅升级共享组件。你可以试试。祝你好运！

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2011-12-22T22:02:29.907

在我的情况下，即使在卸载所有 2005 相关组件后它也没有工作。我不得不求助于蛮力方法并[删除以下注册表项](http://social.msdn.microsoft.com/Forums/en-US/sqlsetupandupgrade/thread/5fc58507-9f40-4213-acbd-32a57c8822d7)

**32 位操作系统**：HKLM\SOFTWARE\Microsoft\Microsoft SQL Server\90

**64 位操作系统**：HKLM\Software\Wow6432Node\Microsoft\Microsoft SQL Server\90

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-08-16T19:20:53.180

我必须卸载工作站组件和 SSMS 工具包（SSMS 工具包是 Microsoft SQL Server Management Studio (SSMS) 的插件，包括 SSMS Express。）SQL 2008 的安装现在正在正常进行。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-12T04:10:51.800

问题是 SQL 2008 MS 有一个错误，即连接到远程服务器（比如服务提供商搭配）它总是会尝试打开列表中的第一个 db，并且由于您的 db 可能是列表中的第一个真的很低，它会抛出错误并且无法显示dbs列表......使用sql 2005 management studio它可以正常工作。

希望我可以使用 SQL 2008 MS，但看起来我连接到远程 SQL 2005，SQL 2008 在我的开发机器上是不可能的:(

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-30T07:18:40.527

只需从添加/删除程序中删除工作站组件 - SQL Server 2005。删除工作站组件，SQL Server 2008 安装顺利。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-10-19T18:46:15.430

只需从控制面板中删除 Microsoft SQL Server Management Studio Express 2005

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-02-23T16:41:27.543

注意这些注释是针对 SQL Server Express 2008 R2 的（所以微软仍然没有让这变得更容易）。我还意识到我通过安装 32 位 SQL Server Express 2005 和 64 位 SQL Server Express 2008 使事情变得复杂。

[我按照上面 Josh Hinman](https://stackoverflow.com/questions/175881/sql-server-express-2008-install-side-by-side-w-sql-2005-express-fails/175894#175894)的步骤进行操作。卸载 SQL Server Express 2005“工作站组件”是不够的。我还需要卸载 2005 Management Studio。

我还尝试了 Josh Hinman 通过单击“从 SQL Server 2000、SQL Server 2005 或 SQL Server 2008 升级”建议的升级路线。这条路线从来没有让我选择并排安装组件，它只是直接经历了从 2005 年到 2008 年的升级过程。它成功完成了 - 但实际上没有做任何事情。值得庆幸的是，尽管它没有损害任何现有的数据库实例。因此，请注意尝试该路线。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-05-20T17:46:13.863

如果您当前有 Red Gate SQL Toolbelt，则在继续之前您也需要卸载它。不知何故，它添加了对 2005 版 SQL Management Studio 的引用。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-06-07T08:03:29.870

我正在尝试将 SQL SERVER developer 2008 R2 与 SQL SERVER 2005 EXPRESS 一起安装，

我去了程序功能，单击 unistall SQL SERVER 2005 EXPRESS，只检查了，WORKSTATION COMPONENTS，它未安装：支持文件，sql mngmt studio

在安装 sql 2008 r2 developer 之后就正常了....

希望这可以帮助某人

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2014-12-14T23:35:23.087

我还必须在 SMSS 通过该步骤之前删除它。

# c - sleep() 背后的算法是什么？

> ID：175882
> 
> 赞同：46
> 
> 时间：2008-10-06T19:47:02.987
> 
> 标签：c, algorithm, sleep

现在有一件我一直想知道的事情：sleep() 是如何实现的？

如果都是关于使用操作系统中的 API，那么 API 是如何制作的？

这一切都归结为在 CPU 上使用特殊的机器代码吗？该 CPU 是否需要一个特殊的协处理器或其他小玩意儿，没有它们你就不能拥有 sleep() 吗？

sleep() 最著名的化身是在 C 中（更准确地说，在 C 编译器附带的库中，例如 GNU 的 libc），尽管今天几乎每种语言都有其等价物，但在某些语言中 sleep 的实现（想想 Bash) 不是我们在这个问题中看到的......

编辑：在阅读了一些答案后，我看到该进程被放置在等待队列中。从那里，我可以猜到两种选择，要么

1.  设置了一个计时器，以便内核在适当的时间唤醒进程，或者
2.  每当内核被允许一个时间片时，它都会轮询时钟以检查是否该唤醒进程。

答案只提到备选方案 1。因此，我问：这个计时器的行为如何？如果只是一个简单的中断让内核唤醒进程，那么内核如何要求计时器“在 140 毫秒内唤醒我，以便我可以将进程置于运行状态”？

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2008-10-07T15:22:14.877

问题的“更新”显示了对现代操作系统如何工作的一些误解。

内核不是“允许的”时间片。内核是给用户进程分配时间片的东西。“计时器”未设置为唤醒睡眠进程 - 它设置为停止当前正在运行的进程。

本质上，内核试图通过停止在 CPU 上运行时间过长的进程来公平分配 CPU 时间。为简化图，假设任何进程使用 CPU 的时间不得超过 2 毫秒。因此，内核会将计时器设置为 2 毫秒，然后让进程运行。当定时器触发中断时，内核获得控制权。它保存正在运行的进程的当前状态（寄存器、指令指针等），并且控制权不返回给它。取而代之的是，从等待分配 CPU 的进程列表中选择另一个进程，而被中断的进程将排到队列的后面。

睡眠进程根本*不在*等待 CPU 的队列中。相反，它存储在睡眠队列中。每当内核收到定时器中断时，就会检查睡眠队列，并将时间到的进程转移到“等待CPU”队列中。

当然，这是一个粗略的简化。它需要非常复杂的算法来确保安全性、公平性、平衡、优先级、防止饥饿，并以最少的内存用于内核数据来快速完成所有操作。

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2008-10-06T19:51:49.917

有一个称为睡眠队列的内核数据结构。这是一个优先队列。每当一个进程加入到睡眠队列中时，都会计算最快被唤醒的进程的过期时间，并设置一个定时器。此时，过期的作业从队列中取出，进程恢复执行。

（有趣的琐事：在较旧的 unix 实现中，有一个进程队列，其中 fork() 已被调用，但尚未为其创建子进程。它当然被称为***fork queue***。）

！

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2008-10-07T01:34:44.733

也许操作系统的主要工作是向应用程序编写者隐藏真实硬件的复杂性。因此，任何关于操作系统如何工作的描述都有变得非常复杂、非常快的风险。因此，我不会处理真正的操作系统需要处理的所有“假设”和“但是”。我只是要在较高的概念级别上描述一个过程是什么，什么是调度器，定时器队列是如何工作的。希望这会有所帮助。

**什么是流程：**

将一个进程——让我们只讨论进程，稍后再讨论线程——想象为“操作系统调度的东西”。一个进程有一个 ID——想想一个整数——你可以把这个整数看作是一个包含该进程所有上下文的表的索引。

*上下文*是硬件信息——寄存器、内存管理单元内容、其他硬件状态——当加载到机器中时，将允许进程“运行”。上下文还有其他组件——打开文件的列表、信号处理程序的状态，以及最重要*的是进程正在等待的东西*。

**进程花费大量时间休眠（又名等待）**

进程花费大量时间等待。例如，读取或写入磁盘的进程将花费大量时间等待数据到达或确认已在磁盘上输出。操作系统人员使用术语“等待”和“睡眠”（和“阻塞”）在某种程度上可以互换 - 所有这一切都意味着该进程正在等待某些事情发生，然后才能继续以愉快的方式继续。令人困惑的是，操作系统 API sleep() 恰好使用底层操作系统机制来休眠进程。

进程可能正在等待其他事情：例如，网络数据包到达、窗口选择事件或计时器到期。

**流程和调度**

正在等待的进程被称为*non-runnable*。它们不会进入操作系统的运行队列。但是当进程正在等待的事件发生时，它会导致操作系统将进程从不可运行状态移动到可运行状态。同时，操作系统将进程放在运行队列上，这实际上不是一个队列——它更像是所有进程的一堆，如果操作系统决定这样做，*它们可以*运行。

**调度：**

操作系统定期决定应该运行哪些进程。操作系统决定这样做的算法被称为调度算法，有点不足为奇。调度算法的范围从非常简单（“每个人运行 10 毫秒，然后队列中的下一个人开始运行”）到更复杂的（考虑到进程优先级、执行频率、运行时截止日期、进程间依赖、链锁和各种其他复杂的主题）。

**定时器队列** 一台计算机内部有一个定时器。有很多方法可以实现，但经典的方法称为*周期性计时器*。定期计时器以固定的时间间隔滴答作响——在今天的大多数操作系统中，我相信这个速率是每秒 100 次——100 Hz——每 10 毫秒。我将在后面使用该值作为具体速率，但要知道大多数值得一提的操作系统都可以配置不同的滴答声——而且许多操作系统不使用这种机制，并且可以提供更好的计时器精度。但我离题了。

每个滴答都会导致操作系统中断。

当操作系统处理这个定时器中断时，它会将其系统时间的概念再增加 10 毫秒。然后，它查看计时器队列并决定需要处理该队列上的哪些事件。

定时器队列实际上*是*一个“需要处理的事情”的队列，我们​​称之为事件。此队列按到期时间排序，最早的事件在前。

“事件”可以是“唤醒进程 X”，或者“去那里踢磁盘 I/O，因为它可能已经卡住了”，或者“在那边的光纤通道链路上发送一个 keepalive 数据包”。无论操作系统需要做什么。

当你有一个以这种方式排序的队列时，很容易管理出队。操作系统只是查看队列的头部，并在每个滴答声中将事件的“到期时间”递减 10 毫秒。当到期时间变为零时，操作系统会将该事件出列，并执行任何需要的操作。

在休眠进程的情况下，它只是使进程再次可运行。

很简单吧？

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2008-10-06T20:05:35.180

至少有两个不同的层次来回答这个问题。（还有很多其他会混淆的东西，我不会碰它们）

1.  应用程序级别，这就是 C 库所做的。这是一个简单的操作系统调用，它只是告诉操作系统在时间过去之前不要给这个进程提供 CPU 时间。操作系统有一个挂起的应用程序队列，以及一些关于它们在等待什么的信息（通常是时间，或者某些数据出现在某处）。

2.  内核级别。当操作系统现在无事可做时，它会执行“hlt”指令。该指令不执行任何操作，但它永远不会自行完成。当然，硬件中断是正常服务的。简而言之，操作系统的主循环看起来像这样（从非常非常远的地方）：

    ```
    允许中断（）；
    而（真）{
      hlt;
      check_todo_queues ();
    }

    ```

    中断处理程序简单地将东西添加到待办事项队列中。实时时钟被编程为周期性地（以固定的速率）产生中断，或者在下一个进程想要被唤醒时在未来的某个固定时间产生中断。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2008-10-06T19:53:57.417

多任务操作系统有一个称为调度程序的组件，该组件负责将 CPU 时间分配给线程，调用 sleep 告诉操作系统在一段时间内不要将 CPU 时间分配给该线程。

有关完整的详细信息，请参阅[http://en.wikipedia.org/wiki/Process_states](http://en.wikipedia.org/wiki/Process_states)。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2008-10-06T19:56:22.187

我对 Linux 一无所知，但我可以告诉你在 Windows 上会发生什么。

Sleep() 导致进程的时间片立即结束以将控制权返回给操作系统。操作系统然后设置一个计时器内核对象，该对象在时间过去后收到信号。在内核对象收到信号之前，操作系统将不再给该进程时间。即使这样，如果其他进程具有更高或相同的优先级，它可能仍会等待一段时间才能让进程继续。

操作系统使用特殊的 CPU 机器代码来进行进程切换。这些函数不能被用户模式代码访问，因此它们只能通过对操作系统的 API 调用来访问。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2009-07-21T04:05:50.767

本质上，是的，有一个“特殊的小玩意儿”——它的重要性远不止 sleep()。

传统上，在 x86 上，这是一个 Intel 8253 或 8254“可编程间隔定时器”。在早期的 PC 中，这是主板上的一个独立芯片，可由 CPU 编程以在预设时间间隔后断言中断（通过“可编程中断控制器”，另一个独立芯片）。该功能仍然存在，尽管它现在只是更大的主板电路的一小部分。

今天的操作系统仍然对 PIT 进行编程以定期唤醒它（在最新版本的 Linux 中，默认为每毫秒一次），这就是内核能够实现抢先式多任务处理的方式。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2015-11-10T20:39:20.403

**glibc 2.21 Linux**

转发到`nanosleep`系统调用。

glibc 是大多数 Linux 桌面发行版上 C 标准库的默认实现。

如何找到它：第一反应是：

```
git ls-files | grep sleep 
```

这包含：

```
sysdeps/unix/sysv/linux/sleep.c 
```

我们知道：

```
sysdeps/unix/sysv/linux/ 
```

包含 Linux 细节。

在该文件的顶部，我们看到：

```
/* We are going to use the `nanosleep' syscall of the kernel.  But the
   kernel does not implement the stupid SysV SIGCHLD vs. SIG_IGN
   behaviour for this syscall.  Therefore we have to emulate it here.  */
unsigned int
__sleep (unsigned int seconds) 
```

因此，如果您相信评论，我们基本上就完成了。

在底部：

```
 weak_alias (__sleep, sleep) 
```

这基本上说`__sleep`== `sleep`。该函数`nanosleep`通过：

```
result = __nanosleep (&ts, &ts); 
```

greppingg之后：

```
git grep nanosleep | grep -v abilist 
```

我们得到了一小部分有趣的事件，我认为`__nanosleep`定义在：

```
sysdeps/unix/sysv/linux/syscalls.list 
```

在线上：

```
nanosleep   -   nanosleep   Ci:pp   __nanosleep nanosleep 
```

这是一些由以下内容解析的超级 DRY 魔术格式：

```
sysdeps/unix/make-syscalls.sh 
```

然后从构建目录：

```
grep -r __nanosleep 
```

引导我们：`/sysd-syscalls`这是`make-syscalls.sh`生成和包含的内容：

```
#### CALL=nanosleep NUMBER=35 ARGS=i:pp SOURCE=-
ifeq (,$(filter nanosleep,$(unix-syscalls)))
unix-syscalls += nanosleep
$(foreach p,$(sysd-rules-targets),$(foreach o,$(object-suffixes),$(objpfx)$(patsubst %,$p,nanosleep)$o)): \
        $(..)sysdeps/unix/make-syscalls.sh
    $(make-target-directory)
    (echo '#define SYSCALL_NAME nanosleep'; \
     echo '#define SYSCALL_NARGS 2'; \
     echo '#define SYSCALL_SYMBOL __nanosleep'; \
     echo '#define SYSCALL_CANCELLABLE 1'; \
     echo '#include <syscall-template.S>'; \
     echo 'weak_alias (__nanosleep, nanosleep)'; \
     echo 'libc_hidden_weak (nanosleep)'; \
    ) | $(compile-syscall) $(foreach p,$(patsubst %nanosleep,%,$(basename $(@F))),$($(p)CPPFLAGS))
endif 
```

它看起来像是 Makefile 的一部分。`git grep sysd-syscalls`表明它包含在：

```
sysdeps/unix/Makefile:23:-include $(common-objpfx)sysd-syscalls 
```

`compile-syscall`看起来像关键部分，所以我们发现：

```
# This is the end of the pipeline for compiling the syscall stubs.
# The stdin is assembler with cpp using sysdep.h macros.
compile-syscall = $(COMPILE.S) -o $@ -x assembler-with-cpp - \
                   $(compile-mkdep-flags) 
```

请注意，这`-x assembler-with-cpp`是一个`gcc`选项。

这`#define`s 参数如：

```
#define SYSCALL_NAME nanosleep 
```

然后在以下位置使用它们：

```
#include <syscall-template.S> 
```

好的，这就是我现在要进行的宏扩展游戏。

我认为这会生成`posix/nanosleep.o`必须与所有内容链接在一起的文件。

**Linux 4.2 x86_64 nanosleep 系统调用**

使用调度程序：这不是一个忙碌的睡眠。

搜索标签：

```
sys_nanosleep 
```

引导我们`kernel/time/hrtimer.c`：

```
SYSCALL_DEFINE2(nanosleep, struct timespec __user *, rqtp, 
```

`hrtimer`代表高分辨率计时器。从那里主线看起来像：

*   `hrtimer_nanosleep`
*   `do_nanosleep`
    *   `set_current_state(TASK_INTERRUPTIBLE);`这是可中断的睡眠
    *   `freezable_schedule();`它调用`schedule()`并允许其他进程运行
*   `hrtimer_start_expires`
*   `hrtimer_start_range_ns`
*   TODO：达到`arch/x86`时序级别
*   TODO：上述步骤是直接在系统调用中断处理程序中完成的，还是在常规内核线程中完成的？

关于它的几篇文章：

*   [https://geeki.wordpress.com/2010/10/30/ways-of-sleeping-in-linux-kernel/](https://geeki.wordpress.com/2010/10/30/ways-of-sleeping-in-linux-kernel/)
*   [http://www.linuxjournal.com/article/8144](http://www.linuxjournal.com/article/8144)

# linq-to-xml - 有没有办法在 Linq-to-XML 查询中仅使用本地名称来检索元素？

> ID：175891
> 
> 赞同：9
> 
> 时间：2008-10-06T19:48:17.210
> 
> 标签：linq-to-xml

假设我们有这个 xml：

```
<?xml version="1.0" encoding="UTF-8"?>
<tns:RegistryResponse status="urn:oasis:names:tc:ebxml-regrep:ResponseStatusType:Failure"
    xmlns:tns="urn:oasis:names:tc:ebxml-regrep:xsd:rs:3.0"
    xmlns:rim="urn:oasis:names:tc:ebxml-regrep:xsd:rim:3.0">
    <tns:RegistryErrorList highestSeverity="">
        <tns:RegistryError codeContext="XDSInvalidRequest - DcoumentId is not unique."
            errorCode="XDSInvalidRequest"
            severity="urn:oasis:names:tc:ebxml-regrep:ErrorSeverityType:Error"/>
    </tns:RegistryErrorList>
 </tns:RegistryResponse> 
```

要检索 RegistryErrorList 元素，我们可以这样做

```
XDocument doc = XDocument.Load(<path to xml file>);
XNamespace ns = "urn:oasis:names:tc:ebxml-regrep:xsd:rs:3.0";
XElement errorList = doc.Root.Elements( ns + "RegistryErrorList").SingleOrDefault(); 
```

但不是这样

```
XElement errorList = doc.Root.Elements("RegistryErrorList").SingleOrDefault(); 
```

有没有办法在没有元素名称空间的情况下进行查询。基本上在概念上与在 XPath 中使用 local-name() 类似（即 //*[local-name()='RegistryErrorList']）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-06T19:54:27.837

```
var q = from x in doc.Root.Elements()
        where x.Name.LocalName=="RegistryErrorList"
        select x;

var errorList = q.SingleOrDefault(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-07T13:14:10.390

在“方法”语法中，查询看起来像：

```
XElement errorList = doc.Root.Elements().Where(o => o.Name.LocalName == "RegistryErrorList").SingleOrDefault(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-11-20T15:57:12.953

以下扩展将从 XDocument（或任何 XContainer）的任何级别返回匹配元素的集合。

```
 public static IEnumerable<XElement> GetElements(this XContainer doc, string elementName)
    {
        return doc.Descendants().Where(p => p.Name.LocalName == elementName);
    } 
```

您的代码现在看起来像这样：

```
var errorList = doc.GetElements("RegistryErrorList").SingleOrDefault(); 
```

# jquery - 使用jQuery防止元素“捕获”鼠标？

> ID：175892
> 
> 赞同：2
> 
> 时间：2008-10-06T19:48:33.717
> 
> 标签：jquery, mouseevent, mouse, embedded-object

我正在尝试调整嵌入对象的大小。问题在于，当鼠标悬停在对象上时，它会“控制”鼠标，吞噬移动事件。结果是您可以扩展包含对象的 div，但是当您尝试缩小它时，如果鼠标进入对象的区域，则调整大小会停止。

目前，我在移动时隐藏对象。我想知道是否有办法阻止对象捕获鼠标。也许在其上覆盖另一个元素以防止鼠标事件到达嵌入对象？

* * *

顺便说一句，在调整大小时使用重影不适用于嵌入式对象。

* * *

添加赏金，因为我似乎永远无法让它发挥作用。要收集，只需执行以下操作：

提供一个嵌入了 PDF 的网页，以页面为中心。pdf不能占满整个页面；使其宽度/高度为浏览器窗口宽度的 50% 之类的。

使用 jQuery 1.2.6 为 pdf 的每一边和角落添加调整大小。

缩小 PDF 时，PDF 不得捕捉鼠标并停止拖动。这意味着当我点击pdf的边缘并拖动时，当鼠标进入pdf的显示框时，resize操作继续进行。

这必须在 IE 7 中工作。条件 CSS（如果 gte ie7 或其他）hack 很好。

* * *

嗯...我认为这可能是 iframe 的问题...

```
 <div style="text-align:center; padding-top:50px;">
    <div id="doc" style="width:384px;height:512px;">
    <iframe id="docFrame" style="width: 100%; height: 100%;"
 src='http://www.ready.gov/america/_downloads/sampleplan.pdf'>
    </iframe></div></div>
    <div id="data"></div>
    <script type="text/javascript">
        $(document).ready(function() {
        var obj = $('#docFrame');
            $('#doc').resizable({handles:'all', resize: function(e, ui) {
                $('#data').html(ui.size.width + 'x' + ui.size.height);
                obj.attr({width: ui.size.width, height: ui.size.height});
            }});
        });
    </script> 
```

这行不通。当您的鼠标误入 iframe 时，调整大小操作将停止。

* * *

有一些很好的答案；如果赏金在我能够审查所有这些之前用完，我将恢复赏金（相同的 150 分）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-28T02:24:42.340

好吧，我完全找不到 XPS 文档查看器示例或诸如此类的东西，但我能够想出[`this working sample`](http://www.rootspot.com/stackoverflow/box.php). 它不使用覆盖的想法，但它是一个可以调整大小的 pdf...

**编辑**使这项工作没有覆盖的东西是`wmode`参数设置为`transparent`. 我对细节不是很熟悉，但它使它在 IE7 上运行良好。也适用于 Firefox、Chrome、Safari 和 Opera。

**新的编辑**很难让它与框架一起工作。我发现的一些信息不是很令人鼓舞。不可能有它`<object>`吗？还是`<object>`iframe 内部？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-07T04:00:28.950

我会回答覆盖，但会提供实际代码：P

我将其称为“跟随者”而不是覆盖，并在我的 ThreeSixty jQuery 插件中使用（提供了一些简单的源代码，您将了解阅读“跟随者”div 发生了什么。

[http://www.mathieusavard.info/threesixty](http://www.mathieusavard.info/threesixty)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-06T19:50:46.970

覆盖。

一字答禁，此句无动词。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-29T15:11:17.920

也许[SmartLook](http://issuu.com/smartlook)是另一种选择。它就像那些灯箱脚本，但用于 pdf 等嵌入式内容。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-30T20:10:09.827

这对我有用，但在调整大小时确实隐藏了 iframe。这对你来说是个问题吗？

```
$(document).ready(function() {
    var obj = $('#docFrame');
    $('#doc').resizable(
    { 
        handles: 'all', 
        resize: function(e, ui) {
            $('#data').html(ui.size.width + 'x' + ui.size.height);
            obj.attr({ width: ui.size.width, height: ui.size.height });
        },
        start: function(e, ui) { $('#docFrame').hide(); },
        stop: function(e, ui) { $('#docFrame').show(); }
    });
}); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-30T20:26:18.093

使用 IE，您可以调用 setCapture()/releaseCapture()，它对我来说非常适合 iframe。

使用 Firefox - 透明覆盖，如前所述。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-31T01:30:17.903

感谢 StackOverflow 的新“最近活动”功能，我看到您要求我提供代码示例。我只做了一些小测试（似乎无法让你的代码在 IE 中内联 PDF，大概它需要一个我没有安装的 PDF 插件），所以这可能行不通。但这是一个开始。

```
<div style="text-align: center; padding-top: 50px;">
    <div id="doc" style="width: 384px; height: 512px; position: relative;">
        <div id="overlay" style="position: absolute; top: -5px; left: -5px;
            padding: 5px; width: 100%; height: 100%; background: red;
            opacity: 0.5; z-index: 1; display: none;"></div>
        <iframe id="docFrame" style="width: 100%; height: 100%; position: relative; z-index: 0;"
            src='http://www.ready.gov/america/_downloads/sampleplan.pdf'></iframe>
    </div>
</div>
<div id="data"></div>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.2.6/jquery.js" type="text/javascript" charset="utf-8"></script>
<script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.5.3/jquery-ui.js" type="text/javascript" charset="utf-8"></script>
<script type="text/javascript">
    $(document).ready(function() {
        var obj = $('#docFrame'), overlay = $('#overlay');
        $('#doc').resizable({
            handles: 'all',
            start: function() {
                overlay.show();
            },
            resize: function(e, ui) {
                $('#data').html(ui.size.width + 'x' + ui.size.height);
                obj.attr({
                    width: ui.size.width,
                    height: ui.size.height
                });
            },
            stop: function(e, ui) {
                overlay.hide();
            }
        });
    });
</script> 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-05-29T09:15:39.690

```
var dframe = $("#docFrame");

$(document).ready(function () {
    var b = dframe;
    $("#doc").e({
        b: "all",
        resize: function (c, a) {
            $("#data").html(a.size.width + "x" + a.size.height);
            object.attr({
                width: a.size.width,
                height: a.size.height
            });
        },
        start: function () {
            dframe.hide();
        },
        stop: function () {
            dframe.show();
        }
    });
}); 
```

# c# - 如何在 FitNesse 中使用 ArrayFixture？

> ID：175906
> 
> 赞同：3
> 
> 时间：2008-10-06T19:51:18.670
> 
> 标签：c#, testing, fitnesse

我很难让阵列夹具工作。

最初，测试被编写为一个行固定装置，后来需求发生了变化，现在结果的顺序很重要。

似乎您必须将数据传递到基本的arrayfixture 构造函数中，但我不知道这是怎么可能的，或者您如何将参数传递到arrayfixture 中。

如果有人有健身和夹具代码的工作示例，我将非常感谢您发布它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-03-10T15:27:13.790

ArrayFixture 最常与 DoFixture 的自动换行功能一起使用。如果 DoFixture 表中的方法返回一个列表，则使用该列表创建一个 ArrayFixture，并将该列表与 DoFixture 表中的其余行进行比较。

例如

```
|mydofixture|
|mylistmethod|something|
|name1|name2|name3|
|value11|value12|value13|
|value21|value22|value23| 
```

请参阅[http://fitsharp.github.io/Fit/FixtureWrapper.html](http://fitsharp.github.io/Fit/FixtureWrapper.html)和[https://github.com/jediwhale/fitsharp/blob/master/source/fitTest/Double/SampleDomain.cs](https://github.com/jediwhale/fitsharp/blob/master/source/fitTest/Double/SampleDomain.cs)

# sql-server - SQL Server Management Studio 中的“收藏夹”或“宏”？

> ID：175944
> 
> 赞同：8
> 
> 时间：2008-10-06T20:00:45.720
> 
> 标签：sql-server, sql-server-2005, ssms

我有一些数据库，我总是使用 SQL Server Management Studio。我希望能够创建一个工具栏按钮或键盘快捷键，以自动打开一个新的查询窗口（在当前的 SSMS 实例中）并连接到给定的（可能是注册的）数据库。就是这样。这就是我所需要的。还有这个烟灰缸、划桨游戏和遥控器。这就是我所需要的。

就像现在一样，我必须展开对象资源管理器，折叠/展开两到八棵树，右键单击我的数据库，然后选择“新建查询”。我看不出有什么办法，这可能会每天为我节省 30-60 秒。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-03-10T22:01:31.650

我是**[SSMSBoost](http://www.ssmsboost.com)**插件的开发人员，它正是您所需要的：允许管理**首选服务器/数据库列表**并通过工具栏上的自定义组合框在它们之间快速切换，您也可以说，如果您希望所有服务器在**启动**时在 ObjectExplorer 中打开，并且是否应该为它们打开一个新的查询窗口（每个服务器设置）。

**SSMSBoost**还允许您定义别名（而不是 server8273128 > MainServer、server231232> BackupServer 等。）它具有更多功能 - 但它们超出了本主题的范围。

看图片 - 你可以看到快速连接开关组合框，其中包含来自首选连接的一些服务器，“SSMSBoostDemoServer” - 是服务器的别名，下一个名称 - 是原始的。

还有一件事 -**免费**版提供加载项。

![SSMSBoost 工具栏](https://www.ssmsboost.com/Content/images/Feature/SSMS-Add-in-Features.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-06T20:19:53.417

您是否尝试过创建注册服务器？

查看“注册服务器”视图 (Ctrl-Alt-G)。定义服务器连接。设置密码，如果您不使用 Windows 身份验证，请单击“记住密码”复选框。在“连接属性”选项卡上，设置您的首选数据库。保存服务器注册。

现在，要连接到该服务器上的该数据库（假设您已注册的服务器窗格始终可见，就像我一样），您只需要选择该注册节点并按 Ctrl-N。

这应该每天至少为您节省 43 秒。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-06T06:26:35.673

我还没有通读整篇文章，但是[这篇文章](http://aspalliance.com/1374_Extend_Functionality_in_SQL_Server_2005_Management_Studio_with_Addins.all)是关于为 SSMS 创建一个加载项的，您可以这样做以自动化您想要的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-06T20:15:34.503

您可以使用命令行参数创建启动 SQL Server Management Studio 的快捷方式，如下所示：

> **SQLWB.EXE** - 从命令提示符或开始 -> 运行文本框中启动 SQL Server Management Studio。通过其开关，您可以指定服务器的类型（-t S、-t A 或 -t C 分别用于 SQL Server、Analysis Server 或 SQL Server Mobile Edition）、服务器名称 (-S) 和数据库 ( -d) 您要连接、提供身份验证信息或指定要打开的查询、项目或解决方案（-i 文件名）。默认值（在没有开关的情况下）在 SQL Server Management Studio 的工具 -> 选项菜单中定义。

[[来源]](http://www.databasejournal.com/features/mssql/article.php/3491006)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-06T20:27:51.203

这个解决方案无疑是一种 hack，但如果你能找出完成每个“宏”所需的确切击键，你可以使用像[AutoHotKey](http://www.autohotkey.com/)这样的免费工具，使用你想要的任何快捷键来自动化击键。

# wpf - 您可以将路由事件与 MultiTrigger 一起使用吗？

> ID：175949
> 
> 赞同：2
> 
> 时间：2008-10-06T20:02:04.687
> 
> 标签：wpf, triggers, eventtrigger, routedevent, multidatatrigger

WPF 是否支持使用响应路由事件但仅满足条件的触发器？

例如，WPF 支持通过事件触发器触发路由事件。IE：

```
<Button>
  <Button.Triggers>
    <EventTrigger RoutedEvent="Click">
      ...
    </..
  </..
</.. 
```

但是，我正在寻找仅在满足特定条件时才触发的触发器。通常，您使用 MultiTriggers 来满足多个条件。IE：

```
<Button>
  <Button.Triggers>
    <MultiDataTrigger>
      <MultiDataTrigger.Conditions>
         <Condition Binding="..." Value="..."/>
         <Condition Binding="..." Value="..."/>
      </..
    </..
  </..
</.. 
```

但是，MultiTrigger 或 MultiDataTrigger 似乎都不支持触发路由事件。甚至可以在 XAML 中混合这两个路由事件和条件的概念吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-06T20:46:40.167

我不认为它是。反正不是你想的那样。

和多个属性同时具有匹配值`MultiTrigger`时*触发*。这是很容易发生的事情，因为它是基于状态的。它基于至少在一段时间内保持不变的价值观。`MultiDataTrigger`

 *另一方面，事件发生然后消失。当两个多重事件不同时发生时，你怎么能做出反应呢？

您将不得不使用您`EventTrigger`的 s - 也许在 set-enter/set-leave 对中 - 设置某些属性的状态（附加属性在这里听起来不错），然后创建一个`MultiTrigger`查看这些属性的。

# css - 如何阻止 Chrome 使我网站的输入框变黄？

> ID：175951
> 
> 赞同：151
> 
> 时间：2008-10-06T20:02:55.183
> 
> 标签：css, validation, google-chrome, html-input

在表单提交和验证后的其他文本和视觉辅助工具中，我将输入框涂成红色以表示需要注意的交互区域。

在 Chrome（以及 Google 工具栏用户）上，自动填充功能将我的输入表单重新着色为黄色。这是一个复杂的问题：我希望在我的表单上允许自动完成，因为它可以加速用户登录。我将检查如果/当触发错误时将自动完成属性关闭的能力，但它是一个复杂的一些编码以编程方式关闭页面上单个受影响输入的自动完成。简而言之，这将是一个令人头疼的问题。

因此，为了避免这个问题，有没有更简单的方法可以阻止 Chrome 重新着色输入框？

[编辑] 我尝试了下面的 !important 建议，但没有效果。我还没有检查 Google 工具栏以查看 !important 属性是否适用。

据我所知，除了使用 autocomplete 属性（这似乎确实有效）之外，别无他法。

* * *

## 回答 #1

> 赞同：136
> 
> 时间：2009-02-24T17:40:30.287

将 CSS 大纲属性设置为无。

```
input[type="text"], input[type="password"], textarea, select { 
    outline: none;
} 
```

在浏览器也可以添加背景颜色的情况下，这可以通过类似的东西来修复

```
:focus { background-color: #fff; } 
```

* * *

## 回答 #2

> 赞同：75
> 
> 时间：2008-10-06T20:09:39.930

我知道在 Firefox 中，您可以使用属性 autocomplete="off" 来禁用自动完成功能。如果这在 Chrome 中有效（尚未测试），您可以在遇到错误时设置此属性。

这可以用于单个元素

```
<input type="text" name="name" autocomplete="off"> 
```

...以及整个表格

```
<form autocomplete="off" ...> 
```

* * *

## 回答 #3

> 赞同：56
> 
> 时间：2014-09-17T02:14:06.387

这正是您要找的！

```
// Just change "red" to any color
input:-webkit-autofill {
    -webkit-box-shadow: 0 0 0px 1000px red inset;
} 
```

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2010-11-23T21:40:24.323

通过使用一点 jQuery，您可以删除 Chrome 的样式，同时保持自动完成功能不变。我在这里写了一篇简短的文章： [http ://www.benjaminmiles.com/2010/11/22/fixing-google-chromes-yellow-autocomplete-styles-with-jquery/](http://www.benjaminmiles.com/2010/11/22/fixing-google-chromes-yellow-autocomplete-styles-with-jquery/)

```
if (navigator.userAgent.toLowerCase().indexOf("chrome") >= 0) {
$(window).load(function(){
    $('input:-webkit-autofill').each(function(){
        var text = $(this).val();
        var name = $(this).attr('name');
        $(this).after(this.outerHTML).remove();
        $('input[name=' + name + ']').val(text);
    });
});} 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2011-01-10T11:42:05.433

要删除所有字段的边框，您可以使用以下命令：

`*:focus { outline:none; }`

要删除选择字段的边框，只需将此类应用于您想要的输入字段：

`.nohighlight:focus { outline:none; }`

当然，您也可以根据需要更改边框：

`.changeborder:focus { outline:Blue Solid 4px; }`

（来自 Bill Beckelman：[Override Chrome's Automatic Border around Active Fields Using CSS](http://beckelman.net/post/2008/09/15/Override-Chromes-Automatic-Border-Around-Active-Fields-Using-CSS.aspx)）

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-06T20:07:32.443

是的，这将是一个令人头疼的问题，在我看来不值得回报。也许你可以稍微调整一下你的 UI 策略，而不是把盒子涂成红色，你可以把边框涂成红色，或者在它旁边放一个小的繁文缛节（比如 gmails“加载”磁带），当盒子在里面时它会消失重点。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-02-05T19:07:14.777

使用 jQuery 简直是小菜一碟：

```
if ($.browser.webkit) {
    $("input").attr('autocomplete','off');
} 
```

或者，如果您想更有选择性，请为选择器添加类名。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-06-05T15:38:01.143

我认为更简单的方法是：

1.  获取[http://www.quirksmode.org/js/detect.html](http://www.quirksmode.org/js/detect.html)
2.  使用此代码：

    ```
    if (BrowserDetect.browser == "Chrome") {
      jQuery('form').attr('autocomplete','off');
    }; 
    ```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2013-04-11T19:36:52.610

应用@Benjamin 他的解决方案后，我发现按下后退按钮仍然会给我黄色突出显示。

我的解决方案是通过应用以下 jQuery *javascript*来防止这个黄色高亮再次出现：

```
<script type="text/javascript">
    $(function() {
        if (navigator.userAgent.toLowerCase().indexOf("chrome") >= 0) {
        var intervalId = 0;
            $(window).load(function() {
                intervalId = setInterval(function () { // << somehow  this does the trick!
                    if ($('input:-webkit-autofill').length > 0) {
                        clearInterval(intervalId);
                        $('input:-webkit-autofill').each(function () {
                            var text = $(this).val();
                            var name = $(this).attr('name');
                            $(this).after(this.outerHTML).remove();
                            $('input[name=' + name + ']').val(text);
                        });
                    }
                }, 1);
            });
        }
    });
</script> 
```

希望它可以帮助任何人！

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2013-12-19T01:30:15.087

这行得通。最重要的是，您可以使用 rgba 值（box-shadow inset hack 不适用于 rgba）。这是对@Benjamin 答案的细微调整。我正在使用 $(document).ready() 而不是 $(window).load()。它似乎对我来说效果更好——现在 FOUC 少了很多。我不相信使用 $(document).ready() 有任何缺点。

```
if (navigator.userAgent.toLowerCase().indexOf("chrome") >= 0) {
    $(document).ready(function() {
        $('input:-webkit-autofill').each(function(){
            var text = $(this).val();
            var name = $(this).attr('name');
            $(this).after(this.outerHTML).remove();
            $('input[name=' + name + ']').val(text);
        });
    });
}; 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2016-04-06T01:47:04.573

对于今天的版本，如果放置在两个登录输入之一中，这也可以工作。还修复了版本 40+ 和后期 Firefox 问题。

```
<input readonly="readonly" onfocus="this.removeAttribute('readonly');" /> 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2011-06-13T10:18:40.447

```
input:focus { outline:none; } 
```

这对我来说非常有用，但很可能会在您的网站上保持统一，您还希望将其包含在 textareas 的 CSS 中：

```
textarea:focus { outline:none; } 
```

对于大多数人来说，这似乎很明显，但对于初学者来说，您也可以将其设置为这样的颜色：

```
input:focus { outline:#HEXCOD SOLID 2px ; } 
```

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2008-10-06T20:06:03.023

如果我没记错的话，样式表中输入背景颜色的 !important 规则将覆盖 Google 工具栏自动完成功能——Chrome 大概也是如此。

# sql - 使用 SQL 将文本文件导入通用数据库

> ID：175955
> 
> 赞同：1
> 
> 时间：2008-10-06T20:03:15.557
> 
> 标签：sql, database, csv, import, oledb

我目前正在尝试使用 OleDb 将分号分隔的文本文件导入 C# 中的数据库，其中我不知道类型（SQL Server、Access、Oracle、MySQL、postgreSQL 等）目前我正在阅读使用 Jet 文本阅读器将文件作为数据库，然后创建准备好的插入语句，填充字段，然后在最后提交。虽然这行得通，但它很慢，而且对于数百万行来说，它需要的时间太长了。

所以我的问题是：是否有人对如何最好地将文本文件导入通用数据库有任何其他想法，或者对我的方法进行评论以加快导入速度？

我不能使用 3rd 方库或软件来执行此操作，因为它是更大项目的一部分

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-06T20:12:06.820

Try this

[http://filehelpers.sourceforge.net](http://filehelpers.sourceforge.net)

....why would you want to load the db into the dataset? Have another database keep track of the uniqueness (if there is such a word). While importing, check if exists in the logging database, if no, then load to Generic Database.

Wait for some other responses to this thread, we may get a better idea.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-06T21:07:38.970

Not exactly elegant, but performance may be better:

*   load the whole file into a table with just one column "Line" as long text (similar to what you do now locally
*   use stored procedures to split the fields apart and create the inserts
*   execute the inserts on the server

While you are still inserting each line seperately, you wouldn't create quite as much network traffic.

To elaborate, the original method generates the statements on the client and then executes them on the client, resulting in network traffic for each line. My suggestion would be to generate the statements on the server (in a stored procedure) and have them execute on the server, resulting in no new network traffic.

The "correct" solution would be to use a database specific import tool (like SQL Loader for Oracle). The performance gains are enormous. (We are loading huge tables with 20 million lines in about 5 minutes). But of course, that is not very generic.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-08T18:44:21.083

好吧，我设法将文本文件的行放入数据库数据集中，到目前为止，这种方法似乎更快。我用了

```
Dataset.Tables[x].ImportRow(DataRow) 
```

当然，现在它只是让 DataAdapter.Update(Dataset) 工作。上网看看会很有趣...

*更新*

此方法不会产生更快的结果，因为 DataAdapter.Update 命令会逐行插入。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-29T12:23:43.830

批量插入 dbo.ImportTest 从 'C:\ImportData.txt' WITH (FIELTERMINATOR =',', FIRSTROW = 2)

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-10-06T20:04:58.393

您最好的选择是为此购买现成的应用程序。

专业的现成应用程序使用本机驱动程序并针对它们将遇到的每种类型的数据源进行微调。这总是在幕后，所以你看不到他们是怎么做的。例如，bulkcopy 用于 SQL Server；Oracle 有一个数据泵。

自己滚动的问题是，您可以花钱微调您的应用程序以使用您可能遇到的每种源类型，或者通过使用通用 ODBC/ADO/任何驱动程序对性能造成巨大影响.

归根结底，你最好要么把它从你的产品中去掉，要么只处理你不得不采取的不可避免的缓慢方法。在这种情况下，这意味着对所有内容都使用单个插入语句。

那么，你有多少资金用于开发资源？

# asp.net - 如何正确处理复合控件中子控件的视图状态？

> ID：175958
> 
> 赞同：3
> 
> 时间：2008-10-06T20:04:47.537
> 
> 标签：asp.net, viewstate, composite-controls

我有一个包含 ListBox 子控件的复合控件。在回发时，ListBox 的项目消失。我有一个用于初始化它的 ListBox 的属性，并将它添加到 CreateChildControls 中的控件集合中。难道我做错了什么？我是否需要做其他事情才能正确处理此 ListBox 的视图状态？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-06T20:21:28.733

在添加列表项或数据绑定**之前**，请务必将控件添加到父级。否则，您的复合控件将不会跟踪 ListBox 列表项的视图状态。

这是一个更彻底的解释：[http](http://scottonwriting.net/sowblog/posts/2129.aspx) ://scottonwriting.net/sowblog/posts/2129.aspx 。

# c# - List<>.IndexOf 是按引用还是按值进行比较？

> ID：175961
> 
> 赞同：7
> 
> 时间：2008-10-06T20:05:36.067
> 
> 标签：c#, .net

> ```
> List<tinyClass> ids = new List<tinyClass();
> ids.Add(new tinyClass(1, 2));
> 
> bool b = ids.IndexOf(new tinyClass(1, 2)) >= 0; //true or false? 
> ```

如果按值比较，则应返回 true；如果通过引用，它将返回 false。
如果它通过引用进行比较，并且我将 tinyClass 设为结构 - 这会有所不同吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-10-06T20:11:41.640

来自 MSDN：

> 此方法使用默认相等比较器 EqualityComparer<T>.Default 确定相等，T 是列表中值的类型。
> 
> Default 属性检查类型 T 是否实现了 System.IEquatable<T> 泛型接口，如果是，则返回使用该实现的 EqualityComparer<T>。否则，它返回一个使用 T 提供的 Object.Equals 和 Object.GetHashCode 覆盖的 EqualityComparer<T>。

它似乎使用 Equals 方法，除非存储的类实现了 IEquatable<T> 接口。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-06T20:15:51.977

这取决于对象对.Equals(..) 的实现。对于一个对象，默认情况下会比较引用。如果您确实将其更改为结构，那么我相信它会根据私有成员的平等性评估为 true，但实现 IEquatable 在编程上仍然会更加合理。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-06T20:22:27.827

对于具有 Equals 的默认实现的类 - 它将通过引用进行比较。

如果将其更改为 tinyStruct，它将按值进行比较。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-20T14:16:00.270

请务必为您的结构实现 .Equals(..)，因为默认实现可能使用反射来比较每个字段，这非常昂贵。

阅读更多：http: [//blogs.microsoft.co.il/blogs/sasha/archive/2007/08.aspx](http://blogs.microsoft.co.il/blogs/sasha/archive/2007/08.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-20T07:17:38.293

它也可能与列表中保留哪个类或结构实例有关，因为结构的*相等*实现基于值的相等。

# sql - SQL Server 中的动态 SELECT TOP @var

> ID：175962
> 
> 赞同：349
> 
> 时间：2008-10-06T20:05:42.557
> 
> 标签：sql, sql-server-2005

如何让动态变量设置 SQL Server 中返回的行数？以下不是 SQL Server 2005+ 中的有效语法：

```
DECLARE @count int
SET @count = 20

SELECT TOP @count * FROM SomeTable 
```

* * *

## 回答 #1

> 赞同：633
> 
> 时间：2008-10-06T20:06:25.863

```
SELECT TOP (@count) * FROM SomeTable 
```

这仅适用于 SQL 2005+

* * *

## 回答 #2

> 赞同：43
> 
> 时间：2008-10-06T20:08:47.247

语法“select top (@var) ...”仅适用于 SQL SERVER 2005+。对于 SQL 2000，您可以执行以下操作：

```
set rowcount @top

select * from sometable

set rowcount 0 
```

希望这可以帮助

奥辛。

（编辑以将 @@rowcount 替换为 rowcount - 感谢 augustlights）

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2008-10-06T21:26:55.857

在 x0n 的示例中，它应该是：

```
SET ROWCOUNT @top

SELECT * from sometable

SET ROWCOUNT 0 
```

[http://msdn.microsoft.com/en-us/library/ms188774.aspx](http://msdn.microsoft.com/en-us/library/ms188774.aspx)

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2016-01-07T19:34:46.047

或者你只是把变量放在括号中

```
DECLARE @top INT = 10;

SELECT TOP (@Top) *
FROM <table_name>; 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2017-03-14T00:03:48.400

```
declare @rows int = 10

select top (@rows) *
from Employees
order by 1 desc -- optional to get the last records using the first column of the table 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-10-07T08:37:22.227

也可以使用动态 SQL 并使用 exec 命令执行它：

```
declare @sql  nvarchar(200), @count int
set @count = 10
set @sql = N'select top ' + cast(@count as nvarchar(4)) + ' * from table'
exec (@sql) 
```

# windows - 在 emacs 中创建别名？

> ID：175982
> 
> 赞同：8
> 
> 时间：2008-10-06T20:10:17.837
> 
> 标签：windows, emacs, elisp

我有一份 emacs 副本，我在拇指驱动器上的几台不同（Windows）计算机上使用它，我想知道是否有可能在 emacs 中创建类似于 bash 别名或符号链接的东西？我可以在 find-file 中使用的东西是我正在寻找的主要内容，例如：`C-f <some link>`将带我去某个地方。目前，我每次使用新计算机时都必须添加一个新的 defun，这有点痛苦，我*发誓*我在某个地方见过这个，但是几个月的谷歌搜索却一无所获。

我现在得到的是这样的：

```
(defun go-awesome ()
   "Find my way to my work home"
   (interactive)
   (find-file "c:/cygwin/home/awesome")) 
```

但是，对于仅仅访问一个相当 hacky 的访问我半定期访问的文件来说，这感觉非常过头和 hacky。而且建立一个新文件需要付出很多努力。

但在我看来，它最大的问题是它不适合我的工作流程。当我想访问一个文件时，我总是这样做`C-x C-f`，如果我意识到“嘿，我在工作”，我就必须这样做`C-g M-x go-awesome`。如果我说我希望能够做一些相当于`ln -s /some/awesome/dir`emacs 内部的事情，而不是内置在操作系统中，那么这`C-x C-f ~/awesome/some/sub/dir`将在 Windows 或其他任何地方工作，也许会更清楚。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-06T21:05:56.260

我不是很清楚你在问什么。我将常用文件存储在 .emacs 中的寄存器中：

```
(set-register ?c '(file . "c:/data/common.txt"))
(set-register ?f '(file . "c:/data/frequent.txt")) 
```

`jump-to-register`然后我可以用( )跳转到一个文件`C-x r j`：

例如，“ `C-x r j c`”带我去`c:/data/common.txt`（必要时加载它）。

那是你要找的吗？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-07T05:59:31.203

如果你想要一个函数的别名，你可以使用`defalias`：

```
(defalias 'nuke 'delete-trailing-whitespace) 
```

但是如果你抱怨 Emacs 的函数名太长，你应该查看`partial-completion-mode`. 开启后，

```
M-x d-t-w [RET] 
```

将运行`delete-trailing-whitespace`。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-11-02T16:54:03.380

这就是你需要的——

*   定义与您要重新访问的上下文相对应的书签。使用[***Bookmark+***](http://www.emacswiki.org/emacs/BookmarkPlus)，这不仅是一个文件。它也可以是整个 Emacs 桌面或带有标记（已保存）的 Dired 缓冲区、一组其他书签、...

*   将[***冰柱***](http://www.emacswiki.org/cgi-bin/wiki/Icicles)与**Bookmark+**一起使用。每当您使用`C-x C-f`etc. 访问文件时，您还可以[访问文件或目录书签](http://www.emacswiki.org/emacs/Icicles_-_File-Name_Input#icicle-bookmark-file-other-window)（完整的书签名称）。`C-x m`当您在文件名完成的迷你缓冲区中时， 只需点击即可。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-14T09:22:52.183

我你想要的是只用一个命令打开一个给定的文件，你可以定义一个键盘宏。这个宏打开文件 ~/.bashrc

```
 C-x( # start defining the macro
 C-x C-f ~/.bashrc   
 C-x )  # end definition 
```

然后你可以命名这个宏

```
M-x name-last-kbd-macro
visitbashrc   #give it a name 
```

然后你可以通过名字 Mx visitbashrc 来调用它

您可以将定义保存到文件中，例如 .emacs 通过访问此文件并将定义插入其中，使用

```
M-x insert-kbd-macro 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-13T18:26:29.673

我在下面有这个设置。例如，如果我想在我的桌面 (D:/Desktop) 上查找一个文件，我键入 F3 j F3，无论我从哪个路径开始，minibuffer 现在都会显示“D:\Desktop\”并且我m 准备好在桌面上键入任何文件名。我将我的快捷方式设置为 j、k、l、ib/c，它们靠近我左手的位置，但是通过这种设置，任何最多 4 个字母的快捷方式都可以使用。所以你可以为你的“awsome”文件添加一个条目，比如“awe”，然后你可以输入 F3 awe F3 enter 来访问你的文件。不知道这是否是你要找的；但这为我节省了很多打字时间；）

```
(global-set-key [f3] 'ffap)

;comcplete shortcut in minibuffer
(define-key minibuffer-local-completion-map (kbd "<f3>")
                      'complete-minibuffer-path) 

(defun complete-minibuffer-path ()
  "Extension to the complete word facility of the minibuffer by
replacing matching strings to a specific path"
  (interactive)
  (setq found t)
  (cond
     ; just add new entries if needed; shortcut up to 4 letters will work
     ((looking-back "j" 5 nil) (setq directory "D:/Desktop/"))
     ((looking-back "k" 5 nil) (setq directory "D:/Documents/"))
     ((looking-back "l" 5 nil) (setq directory home-dir))
     ((looking-back "i" 5 nil) (setq directory "D:/Programs/"))
     (t (setq found nil)))
  (cond (found (beginning-of-line)
                (kill-line)
                (insert directory))
         (t (minibuffer-complete)))) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-12-19T22:13:09.580

这个[博客条目](http://scottfrazersblog.blogspot.com/2009/12/emacs-using-bookmarked-directories.html "嘿，斯科特弗雷泽，你一直在哪里？")几乎*准确地*定义了我想要的，基本上让我`$`在 minibuffer 中点击，然后向我展示我可以跳转到的书签列表。我可能会对其进行调整，以便如果我指定一个文件书签，它会将我带到文件而不是目录，但这是一个小问题，特别是考虑到书签所在的文件无论如何都倾向于位于列表的顶部。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2008-10-07T05:29:41.873

***我将其移至原始问题中，但我将其留在这里，因为人们已经对此做出了回应***

这比我所拥有的要好得多，但我觉得可能存在的是可以替代的东西，例如：

```
(defun nuke ()
   "alias delete-trailing-whitespace"
   (interactive)
   (delete-trailing-whitespace)) 
```

并且感觉不那么老套了，就像它实际上在做它应该做的事情，而不是为了感觉应该很轻的事情而做一些真正沉重的事情。

那有意义吗？

不过，您对寄存器的分配实际上可能比我正在寻找的要好。

# .net - 将 app.config 与互操作控件一起使用

> ID：175983
> 
> 赞同：5
> 
> 时间：2008-10-06T20:10:21.550
> 
> 标签：.net, vb6, interop

我有一个使用 app.config 的 .net 项目 (MySolution.Common)。我在名为 MySolution.InteropCtrl 的 InteropUserControl 项目中使用项目 MySolution.Common。MySolution.InteropCtrl 嵌入到 VB6 项目中。当 MySolution.InteropCtrl 在 VB6 项目中时，它找不到 app.config 文件。InteropControl 中的所有内容都可以在 VB6 中使用，除了依赖于 app.config 文件中的信息的内容。我需要更改什么以便 MySolution.InteropCtrl 在 VB6 中可以看到 app.config 文件？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-06T20:19:56.553

我对此不是 100% 确定的。但我会排除一些可能性。首先，app.config 不是文件的正确名称。虽然它是您项目中的 app.config，但它会自动重命名为*二进制*.exe.config 或*二进制*.dll.config（取决于项目类型），其中*二进制*是项目的名称。

其次，我不能 100% 确定 dll.config 文件是否总是在应用程序加载时被 .NET 正确加载和读取。我不相信它会自动发生，并且如果它用于 dll，则必须进行额外的调用才能读取配置文件。如果您重命名配置文件以匹配您的 exe，那么它肯定会加载并可供您使用。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-22T23:23:17.163

Beth Massi 有一篇博文，描述了如何使用配置文件进行 VB 6.0 的互操作控制。

[http://blogs.msdn.com/bethmassi/archive/2007/10/24/using-my-settings-and-wcf-configuration-with-the-interop-forms-toolkit.aspx](http://blogs.msdn.com/bethmassi/archive/2007/10/24/using-my-settings-and-wcf-configuration-with-the-interop-forms-toolkit.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-09-19T01:52:50.157

两种选择：

1）找到你的vb.exe路径并将你的配置放在那里，如VB6.exe.config。

2) 如果您不需要使用 IDE，只需将您的 MyApp.exe 作为 MyApp.exe.config 放入项目文件夹中，然后运行该 exe，它就会找到它。

# django - 在 django 中迁移数据的最佳方法是什么

> ID：175993
> 
> 赞同：29
> 
> 时间：2008-10-06T20:14:09.810
> 
> 标签：django, data-migration

在我的模型中进行了一些更改（例如，模型中的新字段和新模型）后，将这些更改反映到我的填充数据库的最佳方式是什么？

* * *

PS：我想在一个地方看到许多解决方案的评级。[显然这里](https://stackoverflow.com/questions/35991/altering-database-tables-in-django)已经列出了更多的解决方案。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2008-10-16T18:31:29.047

另一种技术是在 manage.py 中使用 dumpdata 和 loaddata 参数，在中间杀死你的数据库：

1.  `python manage.py dumpdata > dump.json`
2.  使用外部工具，删除任何受影响的表，或杀死整个数据库
3.  `python manage.py loaddata dump.json`

有关更多信息，请参阅[manage.py 文档](http://docs.djangoproject.com/en/dev/ref/django-admin/)。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2008-10-06T21:23:41.807

我在[这里](https://stackoverflow.com/questions/35991/altering-database-tables-in-django)问了一个类似的问题并得到了很多答案。

有很多方法可以做到这一点，例如使用 SQL 手动执行转储和重新加载，使用固定装置或使用 Django 的“新兴”模式演变包之一：

*   [Django 进化](http://code.google.com/p/django-evolution/)
*   [南](http://south.aeracode.org/)
*   [dmigrations](http://code.google.com/p/dmigrations/) （有一个[DjangoCon 视频](http://au.youtube.com/watch?v=VSq8m00p1FM)，其中讨论了 Django 中模式演化的面板，其中讨论了这 3 个解决方案）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-06T20:23:35.237

取决于更改的范围。如果它超出了 ALTER，那么您正在做大手术。备份模型和数据库，以便您可以返回。

我的偏好是将您的新（修订、更正、扩展）模型作为新应用程序放入。它没有 URL 或任何东西，只是一个模型。

1.  将新模型创建为新应用程序。创建测试，只是为了确保它有效。
2.  syncdb 来构建这个新模型的临时实现。
3.  编写一个小的一次性实用程序来查询您的旧模型，并加载您的新模型。您可能想在纯 SQL 中尝试此操作。我更喜欢编写一个简单的查询、构建和保存循环。
4.  加载新模型后，您可以将其转储到 JSON 文件。

从旧模型中提取数据后，您可以以首选的新格式重建数据库。

1.  将新模型移动到现有应用程序中。
2.  删除应用程序表的旧版本。
3.  syncdb 来构建新表。
4.  使用数据加载 JSON 文件。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-09-11T22:07:18.277

Django 现在有自己的内置迁移，记录在：

[https://docs.djangoproject.com/en/dev/topics/migrations/](https://docs.djangoproject.com/en/dev/topics/migrations/)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-06T20:28:28.363

使用 manage.py sqlall 查看新列的参数是什么，并使用 Alter table 语句将它们手动添加到数据库中。这样您就不必重做数据库；虽然它需要一些 SQL 知识...

看看[这里](http://www.djangobook.com/en/1.0/chapter05/)（向下滚动到“对数据库模式进行更改”）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-10-25T10:06:21.687

`Perform these steps in order may help you`：

`For more details,`

点击这里：http : [//south.readthedocs.org/en/latest/](http://south.readthedocs.org/en/latest/)

1)`python manage.py schemamigration apps.appname --initial`

上述步骤默认创建迁移文件夹。

2)`python manage.py migrate apps.appname --fake`

生成虚假迁移。

3)`python manage.py schemamigration apps.appname --auto`

然后您可以根据需要添加字段并执行上述命令。

4)`python manage.py migrate apps.appname`

然后将文件迁移到数据库。

# hta - 我可以在 .hta 文件中嵌入图标吗？

> ID：175994
> 
> 赞同：15
> 
> 时间：2008-10-06T20:14:32.383
> 
> 标签：hta

我已经编写了一个 HTML 应用程序（hta 文件），并且想知道是否有办法将图标文件嵌入到 hta 文件本身中。

我见过包含嵌入式图形文件的 html 电子邮件，有没有办法使用 html 应用程序和图标来做到这一点？

HTA 文件有一个 HTA:APPLICATION 标记，允许您指定一个图标，但我只想下载一个文件。我不想有一个外部图标文件。这可能吗？

此处有关 hta 文件的更多信息：[HTA 文件](http://msdn.microsoft.com/en-us/library/ms536496(VS.85).aspx)。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-12-09T03:26:11.640

我发现了一个设置图标的技巧。

准备一个图标文件*icon.ico*和一个hta文件*source.hta*，内容如下：

```
<HTML>
<HEAD>
   <SCRIPT>
      path = document.URL;
      document.write(
       '<HTA:APPLICATION ID="oHTA" APPLICATIONNAME="myApp" ICON="'+path+'">');
   </SCRIPT>
</HEAD>
<BODY SCROLL="no">
  Hello, World!
</BODY>
</HTML> 
```

打开命令提示符并键入：

```
copy /b icon.ico+source.hta iconapp.hta 
```

这会将图标和 hta 连接到一个文件中。

在我的测试用例中，Internet Explorer 跳过了图标数据并正确显示了 HTML。

然后使用 javascript 将图标的路径设置为 .hta 文件本身的路径并加载图标。

我已经在 Windows XP SP3、Internet Explorer 8 上对此进行了测试。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-07-16T16:59:55.923

考虑为您的图标使用 System32 中的应用程序之一。

这不会更改桌面上 HTA 文件的图标，但一旦运行，它将为任务栏等添加一些个性。

我经常使用以下内容为我的 HTA 添加一些魅力。

```
<hta:application icon="magnify.exe" /> 
```

我不相信可以使用库中的图标，但只需在资源管理器中打开 System32 并将其更改为图标视图，看看是否有任何图标完全符合您的喜好。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-10-06T20:29:47.643

我记得很久以前看过[这个：](http://www.websiteoptimization.com/speed/tweak/inline-images/)

```
<img src="data:image/gif;base64,R0lGODlhEAAOALMAAOazToeHh0tLS/7LZv/0jvb29t/f3//Ub//ge8WSLf/rhf/3kdbW1mxsbP//mf///yH5BAAAAAAALAAAAAAQAA4AAARe8L1Ekyky67QZ1hLnjM5UUde0ECwLJoExKcppV0aCcGCmTIHEIUEqjgaORCMxIC6e0CcguWw6aFjsVMkkIr7g77ZKPJjPZqIyd7sJAgVGoEGv2xsBxqNgYPj/gAwXEQA7"width="16" height="14" alt="embedded folder icon"> 
```

不过我自己从来没有试过。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2014-02-21T03:41:01.980

我知道这不完全是 OP 所要求的，但是，不是在 中嵌入图标`.hta`，您是否考虑过图标文件的 URL？许多网站都有一个`favicon.ico`在 HTA 应用程序中工作的网站图标：

```
<HTML>
<HEAD>
   <HTA:APPLICATION
       ID="oHTA"
       APPLICATIONNAME="myApp"
       ICON="http://stackoverflow.com/favicon.ico">
</HEAD>
<BODY SCROLL="no">
  Hello, World!
</BODY>
</HTML> 
```

这为您提供了无限的图标选择，而无需使用您的 HTA 应用程序进行部署。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-06T20:25:16.667

很可能......有一种方法可以将图像直接嵌入到可能适用于此[http://www.sveinbjorn.org/news/2005-11-28-02-39-23的 html 文件中](http://www.sveinbjorn.org/news/2005-11-28-02-39-23)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-05-01T19:45:12.027

另一种可能的解决方案，但不完全符合问题的确切措辞，是使用“HTAedit”应用程序 (http://www.htaedit.com/) 将 HTA 转换为 .EXE 文件。

他们提供了一个功能齐全的试用版（只是一些启动 nag 屏幕，没有历史/最近的文件），不会阻止从 HTA 源创建 .EXE，没有时间限制。

然后，您可以在 HTA 标头块中使用 ICON="myicon.ico" 语句声明您的图标，然后当它“编译”时（根据我的观点，它更可能是一个打包程序而不是真正的编译器，但这不是重点）它要求您提供其他资源文件。如果您的图标文件尚未在此处列出，则只需将其添加到列表中，“et voilà！”。你会得到一个很好的可执行文件，它的版本号和嵌入的图标。

实际上，这就是我使用 Microsoft Scripting Guys 工具（HTA_HELPOMATIC.HTA 和 SCRIPTOMATIC.HTA）所做的：我只是在 EXE 中更改了它们，添加了一些 %windir%\system32 exe/dll 中的图标，我发现或多或少与工具，而且效果很好。

在运行时，它可能比仅仅将图标嵌入 HTA 更便携（HTAedit 工具似乎能够生成 W7/64 可执行文件，但我没有那样测试它，我还在 XP32-SP2 下......）它使您的源 hta 文件可以被文本编辑器读取和编辑。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-08T18:08:55.227

**IE 不支持数据 URI，因此如果您使用img**标签，您将不得不使用外部文件。

我唯一能想到的就是使用自 IE5 以来一直存在的 VML。它是一种类似 SVG 的矢量图像格式，可以内联使用。例如，使用[此 VML 编辑器](http://www.dynamicdrive.com/dynamicindex11/editor.htm)绘制一些东西，然后单击“获取代码”。你可以把它放在你的 HTA 中。我不知道有什么可以将您的图像直接转换为 VML，但我相信有一种方法可以从某些 Office 产品导出到 VML。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-09T00:22:31.337

这是一个相当牵强的答案，但您可以将图标作为 base64 编码的 XML 嵌入 HTA 中，然后使用 JavaScript onload 并将图标文件保存到临时位置。ActiveX 对象`MSXML.DomDocument`可以对 base64 节点进行编码和解码。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-06-27T04:25:16.380

只要您需要一个 < `iframe`> 或其他 HTML 对话框，无论如何您都将需要其他文件。您通常会发现 .CSS 和 .VBS 文件与 .HTA 分开，这也使任何非平凡的 HTA 的编程和支持变得更加容易。

作为“单个 EXE”执行此操作的另一种方法是将所有内容打包为自解压存档或通过 IExpress。当用户“运行您的程序”时，它会将您存档中的所有内容提取到临时目录中并运行您选择的项目。

也有像[HTMLApp](http://www.htmlapp.com/)这样的第 3 方替代品。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-01-30T23:48:06.757

另一种解决方案，但不完全符合问题的确切措辞，是创建一个简单的快捷方式。对于 64 位系统，您应该输入：

目标：C:\Windows\SysWOW64\mshta.exe C:\path+filename.hta

开始于：C:\Windows\SysWOW64

您可以手动更改快捷方式的图标。用户可以将快捷方式拖动到任务栏。

hta 文件的扩展名对 mshta.exe 无关紧要。因此，如果您给它一个自定义扩展名，那么 hta 文件将显示相应的自定义图标。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2017-01-11T02:40:12.790

您可以将 base64 编码图像嵌入 HTA 并在第一次执行时在本地创建文件。

下面是一个从 base64 字符串创建“favicon.ico”( [https://stackoverflow.com/favicon.ico ) 文件的 HTA。](https://stackoverflow.com/favicon.ico)它还可以对图像文件进行编码（代码改编自VBScript和VBScript 中的[Base64 Encode String](https://stackoverflow.com/questions/496751/base64-encode-string-in-vbscript)[以打开对话框以选择文件路径](https://stackoverflow.com/questions/21559775/vbscript-to-open-a-dialog-to-select-a-filepath)）。

```
<!DOCTYPE html>
<html>
<head>
 <HTA:APPLICATION
    ID="oHta"
    APPLICATIONNAME="Icon test..."
    ICON="favicon.ico"
 />
<LINK id=shortcutlink REL="SHORTCUT ICON" HREF="favicon.ico">
<META http-equiv="x-ua-compatible" content="text/html; charset=utf-8">
<TITLE>Icon test</TITLE>
</head>

<script language=vbscript>

Function fBase64Encode(sourceStr)

    Dim rarr()

    carr = Array(   "A", "B", "C", "D", "E", "F", "G", "H", _
                    "I", "J", "K", "L", "M", "N", "O" ,"P", _
                    "Q", "R", "S", "T", "U", "V", "W", "X", _
                    "Y", "Z", "a", "b", "c", "d", "e", "f", _
                    "g", "h", "i", "j", "k", "l", "m", "n", _
                    "o", "p", "q", "r", "s", "t", "u", "v", _
                    "w", "x", "y", "z", "0", "1", "2", "3", _
                    "4", "5", "6", "7", "8", "9", "+", "/")     

    n = Len(sourceStr)-1

    ReDim rarr(n\3)

    For i=0 To n Step 3
        a = Asc(Mid(sourceStr,i+1,1))
        If i < n Then
            b = Asc(Mid(sourceStr,i+2,1))
        Else
            b = 0
        End If
        If i < n-1 Then
            c = Asc(Mid(sourceStr,i+3,1))
        Else
            c = 0
        End If
        rarr(i\3) = carr(a\4) & carr((a And 3) * 16 + b\16) & carr((b And 15) * 4 + c\64) & carr(c And 63)
    Next

    i = UBound(rarr)
    If n Mod 3 = 0 Then
        rarr(i) = Left(rarr(i),2) & "=="
    ElseIf n Mod 3 = 1 Then
        rarr(i) = Left(rarr(i),3) & "="
    End If

    fBase64Encode = Join(rarr,"")

End Function
'-------------------------------------------------------------------------------

function fBase64Decode(str)

    fBase64Decode = ""

    table = fGenerateBase64Table

    bits = 0

    for x = 1 to len(str) step 1
        c = table(1+asc(mid(str,x,1)))
        if (c <> -1) then
            if (bits = 0) then
                outword = c*4
                bits = 6
            elseif (bits = 2) then
                outword = c+outword
                strBase64 = strBase64 & chr(clng("&H" & hex(outword mod 256)))
                bits = 0
            elseif (bits = 4) then
                outword = outword + int(c/4)
                strBase64 = strBase64 & chr(clng("&H" & hex(outword mod 256)))
                outword = c*64
                bits = 2
            else
                outword = outword + int(c/16)
                strBase64 = strBase64 & chr(clng("&H" & hex(outword mod 256)))
                outword = c*16
                bits = 4
            end if
        end if
    next

    fBase64Decode = strBase64

end function
'---------------------------------------------------

function fGenerateBase64Table()

    r64 = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"

    'set up decode table
    dim table(256)
    for x = 1 to 256 step 1
        table(x) = -1
    next
    for x = 1 to 64 step 1
        table(1+asc(mid(r64,x,1))) = x - 1
    next

    fGenerateBase64Table = table

end function
'---------------------------------------------------

function fSelectFile()

    fSelectFile = ""
    strMSHTA = "mshta.exe ""about:<input type=file id=FILE>" & _
               "<"&"script>FILE.click();new ActiveXObject('Scripting.FileSystemObject')" & _
               ".GetStandardStream(1).WriteLine(FILE.value);close();resizeTo(0,0);<"&"/script>"""

    Set wshShell = CreateObject( "WScript.Shell" )
    Set objExec = wshShell.Exec( strMSHTA )
    fSelectFile = objExec.StdOut.ReadLine( )
    Set objExec = Nothing
    Set wshShell = Nothing

end function

'-------------------------------------------------------------------------

sub getBase64()

    'this can be BMP, PNG, ICO
    REM sImgFile = "favicon.ico"
    sImgFile = fSelectFile()

    if sImgFile = "" then exit sub

    Set fso = CreateObject("Scripting.FileSystemObject")
    Set f = fso.GetFile(sImgFile)
    filesize = f.size
    set f = fso.opentextfile(sImgFile,1,0) 'open as ascii
    strBinFile = f.read(filesize)
    f.close
    set fso = nothing

    strPNGFile = fBase64Encode(strBinFile)
    s = s & "Base64 encoding of "&sImgFile&"<br><br>" & strPNGFile & "<br><br>"
    s = s & "<img src=""data:image/bmp;base64," & strPNGFile & """><br><br>" & vbcrlf

    imgbase64.innerhtml = s

end sub
'-------------------------------------------------------------------------

sub setup()

    'https://stackoverflow.com/favicon.ico in base64 
    base64Icon="AAABAAIAEBAAAAEAIABoBAAAJgAAACAgAAABACAAqBAAAI4EAAAoAAAAEAAAACAAAAABACAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAqaOe/6mjnv+po57/qaOe/6mjnv+po57/qaOe/6mjnv+po57/qaOe/6mjnv8AAAAAAAAAAAAAAAAAAAAAAAAAAKmjnv8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACpo57/AAAAAAAAAAAAAAAAAAAAAAAAAACpo57/AAAAAAlw8v8JcPL/CXDy/wlw8v8JcPL/CXDy/wlw8v8AAAAAqaOe/wAAAAAAAAAAAAAAAAAAAAAAAAAAqaOe/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAlw8hMJcPI2AAAAAKmjnv8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACXDyLwlw8l0JcPKJCXDytglw8uIJcPLvCXDyvQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAlw8sIJcPKlCXDydwlw8kkJcPIdCXDyEwlw8nEJcPIvAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJcPI9CXDypQlw8u8JcPKgCXDyLwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACXDyDwlw8nEJcPLWCXDy0wlw8msJcPIPCXDyPQlw8uIJcPInAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAlw8iMJcPKgCXDyOgAAAAAAAAAACXDydwlw8ugJcPJGCXDyUQlw8oIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJcPITCXDytglw8sIJcPIdCXDyGAlw8ugJcPI2AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJcPI6CXDy4glw8okJcPIDAAAAAAlw8rYJcPJ+AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACXDyZAlw8kkAAAAAAAAAAAlw8msJcPLICXDyAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAlw8icJcPLoCXDyIwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJcPLCCXDyZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACXDyHQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP//AADABwAA3/cAANAXAADflwAA8B8AAPAPAAD+DwAA8AcAAPGDAAD+AwAA/CcAAPzHAAD/jwAA/58AAP+/AAAoAAAAIAAAAEAAAAABACAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAA////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AKmjngCpo54AqaOeAKmjngCpo54AqaOeAKmjngCpo54AqaOeAKmjngCpo54AqaOeAKmjngCpo54AqaOeAKmjngCpo54AqaOeAKmjngCpo54AqaOeAKmjngD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8AqaOeAKmjngCpo54AqaOeAKmjngCpo54AqaOeAKmjngCpo54AqaOeAKmjngCpo54AqaOeAKmjngCpo54AqaOeAKmjngCpo54AqaOeAKmjngCpo54AqaOeAP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wCpo54AqaOe/6mjnv+po57/qaOe/6mjnv+po57/qaOe/6mjnv+po57/qaOe/6mjnv+po57/qaOe/6mjnv+po57/qaOe/6mjnv+po57/qaOe/6mjnv+po54A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AKmjngCpo57/qaOe/6mjnv+po57/qaOe/6mjnv+po57/qaOe/6mjnv+po57/qaOe/6mjnv+po57/qaOe/6mjnv+po57/qaOe/6mjnv+po57/qaOe/6mjngD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8AqaOeAKmjnv+po57/JID0ACSA9AAkgPQAJID0ACSA9AAkgPQAJID0ACSA9AAkgPQAJID0ACSA9AAkgPQAJID0ACSA9AAkgPQAJID0AKmjnv+po57/JID0ACSA9AAkgPQAJID0AP///wD///8A////AP///wD///8A////AP///wCpo54AqaOe/6mjnv8kgPQAJID0ACSA9AAkgPQAJID0ACSA9AAkgPQAJID0ACSA9AAkgPQAJID0ACSA9AAkgPQAJID0ACSA9AAkgPQAqaOe/6mjnv8kgPQAJID0ACSA9AAkgPQA////AP///wD///8A////AP///wD///8A////AKmjngCpo57/qaOe/ySA9AAkgPQAJID0/ySA9P8kgPT/JID0/ySA9P8kgPT/JID0/ySA9P8kgPT/JID0/ySA9P8kgPT/JID0ACSA9ACpo57/qaOe/ySA9AAkgPQAJID0ACSA9AD///8A////AP///wD///8A////AP///wD///8AqaOeAKmjnv+po57/JID0ACSA9AAkgPT/JID0/ySA9P8kgPT/JID0/ySA9P8kgPT/JID0/ySA9P8kgPT/JID0/ySA9P8kgPQAJID0AKmjnv+po57/JID0ACSA9AAkgPQAJID0AP///wD///8A////AP///wD///8A////AP///wCpo54AqaOe/6mjnv8kgPQAJID0ACSA9AAkgPQAJID0ACSA9AAkgPQAJID0ACSA9AAkgPQAJID0ACSA9AAkgPQAJID0ACSA9AAkgPQAqaOe/6mjnv8kgPQAJID0ACSA9AAkgPQA////AP///wD///8A////AP///wD///8A////AKmjngCpo57/qaOe/ySA9AAkgPQAJID0ACSA9AAkgPQAJID0ACSA9AAkgPQAJID0ACSA9B4kgPRRJID0gSSA9LQkgPTjJID0EiSA9ACpo57/qaOe/ySA9AAkgPQAJID0ACSA9AD///8A////AP///wD///8A////AP///wD///8AqaOeAKmjngCpo54AJID0ACSA9AAkgPQAJID0AiSA9CYkgPRXJID0iSSA9LokgPTtJID0/ySA9P8kgPT/JID0/ySA9P8kgPRKJID0ACSA9AAkgPQAJID0ACSA9AAkgPQAJID0AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wAkgPQAJID0ACSA9LgkgPTxJID0/ySA9P8kgPT/JID0/ySA9P8kgPT/JID0+SSA9M0kgPSaJID0aiSA9CQkgPQAJID0ACSA9AAkgPQAJID0ACSA9AAkgPQA////AP///wD///8A////AP///wD///8A////AP///wD///8A////ACSA9AAkgPQAJID0vSSA9P8kgPT/JID09CSA9MUkgPSUJID0YiSA9DEkgPQFJID0ACSA9DQkgPSjJID05iSA9A0kgPQAJID0ACSA9AAkgPQAJID0ACSA9AD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8AJID0ACSA9AAkgPRKJID0WySA9CkkgPQDJID0ACSA9AAkgPQAJID0BSSA9FgkgPTHJID0/ySA9P8kgPT/JID0eCSA9AAkgPQAJID0ACSA9AAkgPQAJID0AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wAkgPQAJID0ACSA9AAkgPQAJID0ACSA9AAkgPQAJID0FSSA9HwkgPTkJID0/ySA9P8kgPT/JID02SSA9GwkgPQ9JID0LCSA9AAkgPQAJID0ACSA9AAkgPQA////AP///wD///8A////AP///wD///8A////AP///wD///8A////ACSA9AAkgPQAJID0ACSA9AAkgPQAJID0MiSA9J8kgPT4JID0/ySA9P8kgPT+JID0tySA9EkkgPQCJID0YiSA9PckgPTjJID0HCSA9AAkgPQAJID0ACSA9AD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8AJID0ACSA9AAkgPQAJID0KiSA9MIkgPT/JID0/ySA9P8kgPTyJID0lCSA9CYkgPQAJID0CCSA9J8kgPT/JID0/ySA9OkkgPRGJID0IySA9AAkgPQAJID0AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wAkgPQAJID0ACSA9AAkgPQPJID07iSA9P8kgPTcJID0cCSA9A8kgPQAJID0ACSA9CQkgPTPJID0/ySA9P8kgPTDJID0HCSA9K4kgPTzJID0ZiSA9AAkgPQA////AP///wD///8A////AP///wD///8A////AP///wD///8A////ACSA9AAkgPQAJID0ACSA9AAkgPRaJID0TCSA9AIkgPQAJID0ACSA9AAkgPRQJID07ySA9P8kgPT+JID0jiSA9AUkgPR+JID0/ySA9P8kgPSOJID0ACSA9AD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8AJID0ACSA9AAkgPQAJID0ACSA9AAkgPQAJID0ACSA9AAkgPQEJID0iCSA9P4kgPT/JID08SSA9FQkgPQAJID0TSSA9P4kgPT/JID0uySA9AMkgPQAJID0AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wAkgPQAJID0ACSA9AAkgPQAJID0ACSA9AAkgPQAJID0GCSA9MAkgPT/JID0/ySA9NMkgPQmJID0ACSA9CgkgPTwJID0/ySA9N4kgPQUJID0ACSA9AAkgPQA////AP///wD///8A////AP///wD///8A////AP///wD///8A////ACSA9AAkgPQAJID0ACSA9AAkgPQAJID0ACSA9B8kgPTnJID0/ySA9P8kgPSiJID0CiSA9AAkgPQPJID02CSA9P8kgPT1JID0LiSA9AAkgPQAJID0ACSA9AD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8AJID0ACSA9AAkgPQAJID0ACSA9AAkgPQAJID0ACSA9JYkgPT4JID0ZySA9AAkgPQAJID0AiSA9LQkgPT/JID0/iSA9FYkgPQAJID0ACSA9AAkgPQAJID0AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wAkgPQAJID0ACSA9AAkgPQAJID0ACSA9AAkgPQAJID0AySA9CokgPQAJID0ACSA9AAkgPSCJID0/ySA9P8kgPSIJID0ACSA9AAkgPQAJID0ACSA9AAkgPQA////AP///wD///8A////AP///wD///8A////AP///wD///8A////ACSA9AAkgPQAJID0ACSA9AAkgPQAJID0ACSA9AAkgPQAJID0ACSA9AAkgPQAJID0UySA9P4kgPT/JID0tySA9AMkgPQAJID0ACSA9AAkgPQAJID0ACSA9AD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8AJID0ACSA9AAkgPQAJID0ACSA9AAkgPQAJID0ACSA9AAkgPQAJID0ACSA9A8kgPTvJID0/ySA9NskgPQQJID0ACSA9AAkgPQAJID0ACSA9AAkgPQAJID0AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wAkgPQAJID0ACSA9AAkgPQAJID0ACSA9AAkgPQAJID0ACSA9AAkgPQAJID0ACSA9DQkgPTIJID0LCSA9AAkgPQAJID0ACSA9AAkgPQAJID0ACSA9AAkgPQA////AP///wD///8A////AP///wD///8A////AP///wD///8A////ACSA9AAkgPQAJID0ACSA9AAkgPQAJID0ACSA9AAkgPQAJID0ACSA9AAkgPQAJID0ACSA9AAkgPQAJID0ACSA9AAkgPQAJID0ACSA9AAkgPQAJID0ACSA9AD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8AJID0ACSA9AAkgPQAJID0ACSA9AAkgPQAJID0ACSA9AAkgPQAJID0ACSA9AAkgPQAJID0ACSA9AAkgPQAJID0ACSA9AAkgPQAJID0ACSA9AAkgPQAJID0AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP////////////////wAAD/8AAA//P//P/z//z/8wAM//MADP/z//z/8/4E//+AB///AAf//wBD//8OA///+AH//+AA//+AQH//gYA//8cAP//8CD//+BB///Ag///4wf//+cP///+D////B////4///////////////////////"    

    Set fso = CreateObject("Scripting.FileSystemObject")
    if not fso.fileexists("favicon.ico") then
        strBin = fBase64Decode(base64Icon)
        set outfile = fso.createtextfile("favicon.ico")
        outfile.write strBin
        outfile.close

        document.title = "Need to refresh to see the new icon"

    end if    
    set fso = nothing

end sub  

</script>

<style type="text/css">

    body  {font-family:"CONSOLAS";font-size:"10pt";}
    input  {font-family:"CONSOLAS";font-size:"8pt";}

</style>

<body onLoad=setup()>

<input type=button value="Encode an image file..." 
data-tooltip title="Choose a PNG, BMP, ICO file to encode in base64" 
onclick=getBase64>

<br><br>

<div id=imgbase64 style="word-wrap: break-word;"></div>

</body>
</html> 
```*************