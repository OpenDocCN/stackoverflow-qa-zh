# StackOverflow 问答 10800000-10800999

# delphi - 使用 Outlook ActiveX 的最安全方法

> ID：10800003
> 
> 赞同：1
> 
> 时间：2012-05-29T13:18:16.753
> 
> 标签：delphi, activex, delphi-xe2

运行我的 Delphi 应用程序后，我检查已安装的 MS Outlook 版本，因为如果机器中的 Outlook 版本高于 2007，我的应用程序的工作方式会有所不同。

我还写了一个有时会崩溃的 Outlook 插件。我怀疑这些崩溃与我在启动时创建的 Outlook 实例有关。

有没有办法以“更柔和的方式”创建这些 ActiveX 实例。当我现在创建 OLE 对象时，我在托盘栏中看到一个图标，其提示显示“Outlook 正在被另一个应用程序使用”，如果可以删除它，我也会看到我的问题消失了。

不知何故，我想实现的与[此处](https://stackoverflow.com/questions/10733158/how-to-pass-a-parameter-to-a-ole-automation-object-such-as-ms-word)相同，其中`wdDoNotSaveChanges`参数允许“更顺畅”地使用 OLE 对象。

这是我用来检查 Outlook 版本的代码：

```
var
  OutlookApp: OLEVariant;
  Version : String;
begin
  { Create the OLE Object }
  Try
    OutlookApp := CreateOLEObject('Outlook.Application');
    Version := OutlookApp.version;
    OutlookVersion := StrToint(SubstrEx(1,Version,'.'));
    OutlookApp := VarNull;
  except
    on E: Exception do
    begin
      OutlookVersion := -1;
    end;
  End; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T15:34:01.460

您的方法与 Microsoft 在此处建议的方法不同：

[如何：检查 Outlook 的版本](http://msdn.microsoft.com/en-us/library/dd941331.aspx)。

他们的版本使用 Microsoft 安装程序功能来检测 Outlook 可执行文件的位置，然后直接从那里提取文件版本。这种方法不会遇到您在像您一样实例化 Outlook 时可能遇到的任何问题。它也快了*很多。*

然而，它*确实*存在一个主要缺点：只有在 Outlook 以 Microsoft 方式正确部署的情况下才能正常工作。在消费者机器上，这不是什么大问题，但在企业环境中，您可能（/将）偶尔会遇到不包括必要 MSI 足迹的过度热心的 IT 部门的精简自定义安装。

根据您的目标受众，这可能根本不是真正的问题。

# tsql - TSQL - CONCAT_NULL_YIELDS_NULL ON 不返回空值？

> ID：10800004
> 
> 赞同：0
> 
> 时间：2012-05-29T13:18:19.380
> 
> 标签：tsql, sql-server-2008-r2, string-concatenation

我环顾四周，似乎遇到了 SQL Server 2008 R2 的一个奇怪问题。

我知道使用 CONCAT_NULL_YIELDS_NULL = ON 意味着以下内容将始终解析为 NULL

```
SELECT NULL + 'My String' 
```

我对此很满意，但是当将它与 COALESCE() 结合使用时，它似乎不适用于我的数据库。

考虑以下查询，其中 MyString 是 VARCHAR(2000)

```
SELECT COALESCE(MyString + ', ', '') FROM MyTableOfValues 
```

现在在我的查询中，当 MyString IS NULL 时，它返回一个空（NOT NULL）字符串。我可以在查询结果窗口中看到这一点。

然而非常不寻常的是，当它与 INSERT 一起运行时，它无法识别 CONCAT_NULL_YIELDS_NULL 而是插入一个空白 ', '。

查询如下插入。

```
CONCAT_NULL_YIELDS_NULL ON
INSERT INTO Mytable(StringValue)
SELECT COALESCE(MyString + ', ', '')
FROM MyTableOfValues 
```

除此之外，我还检查了数据库和 CONCAT_NULL_YIELDS_NULL = TRUE...</p>

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T13:47:25.367

使用`NULLIF(MyString, '')`而不是仅仅`MyString`：

```
SELECT COALESCE(**NULLIF(MyString, '')** + ', ', '') FROM MyTableOfValues 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T13:27:29.573

Coalesce 返回其参数中的第一个非空表达式。

你得到一个 ', ' 因为它是你的 coalesce 调用中的第一个非空表达式。

[http://msdn.microsoft.com/en-us/library/ms190349.aspx](http://msdn.microsoft.com/en-us/library/ms190349.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-31T10:03:48.420

从提供的一些答案中，我能够断言对 COALESCE() 有更深入的理解。

上述查询没有完全起作用的原因是，虽然我正在检查空值，但空字符串 ('') 不被视为空值。因此，尽管上述查询有效，但我应该首先检查表中的空字符串。

例如

```
SELECT COALESCE(FirstName + ', ', '') + Surname
FROM 
(
    SELECT 'Joe' AS Firstname, 'Bloggs' AS Surname UNION ALL
    SELECT NULL, 'Jones'  UNION ALL
    SELECT '', 'Jones'  UNION ALL
    SELECT 'Bob', 'Tielly'
) AS [MyTable] 
```

将返回

```
FullName
-----------
Joe, Bloggs
Jones
, Jones
Bob, Tielly 
```

现在第 3 行返回了一个“，”字符，这是我最初没想到的，因为它是一个空白但不是 NULL 值。

下面的代码现在可以按预期工作，因为它会检查空白值。它有效，但看起来我走了很长的路。可能有更好的方法。

```
-- Ammended Query
SELECT COALESCE(REPLACE(FirstName, Firstname , Firstname + ', '), '') + Surname AS FullName0
FROM 
(
    SELECT 'Joe' AS Firstname, 'Bloggs' AS Surname UNION ALL
    SELECT NULL, 'Jones'  UNION ALL
    SELECT '', 'Jones'  UNION ALL
    SELECT 'Bob', 'Tielly'
) AS [MyTable] 
```

# scala - 检查actor系统是否完成了它的工作

> ID：10800011
> 
> 赞同：2
> 
> 时间：2012-05-29T13:18:40.330
> 
> 标签：scala, akka

我编写了一个基于 Akka 的自动机，它可以接受从 1 到 20 的罗马数字。自动机工作正常，但在处理完完整的输入后，我想关闭系统。

因为我不知道自动机什么时候结束我不知道什么时候发送停止信号。这会导致问题，即系统过早停止并且自动机无法完成其任务。检查演员系统中是否有尚未完成的任务的最佳方法是什么？

自动机：

```
import akka.actor.{Props, ActorSystem, ActorRef, Actor}

object RomanNumberAcceptor extends App {

  val allLegalNumbers = List("I", "II", "III", "IV", "V", "VI", "VII", "VIII", "IX", "X",
    "XI", "XII", "XIII", "XIV", "XV", "XVI", "XVII", "XVIII", "XIX", "XX"
  )

  val someWrongNumbers = List("IXX", "VV", "VX", "IIII", "IVV", "XXX", "XXI", "XXV", "IIX", "IIIV")

  for (number <- allLegalNumbers)
    State testNumber number

  for (number <- someWrongNumbers)
    State testNumber number

  // this stop signal is too early
  State.stop()
}

case class WordData(fullWord: String, remainder: String)

object State {
  val ErrorStateId: Int = -1

  private val data = Map(
    0 -> (Map('I' -> 1, 'V' -> 5, 'X' -> 10), false),
    1 -> (Map('I' -> 2, 'V' -> 4, 'X' -> 9), true),
    2 -> (Map('I' -> 3, 'V' -> ErrorStateId, 'X' -> ErrorStateId), true),
    3 -> (Map('I' -> ErrorStateId, 'V' -> ErrorStateId, 'X' -> ErrorStateId), true),
    4 -> (Map('I' -> ErrorStateId, 'V' -> ErrorStateId, 'X' -> ErrorStateId), true),
    5 -> (Map('I' -> 6, 'V' -> ErrorStateId, 'X' -> ErrorStateId), true),
    6 -> (Map('I' -> 2, 'V' -> ErrorStateId, 'X' -> ErrorStateId), true),
    9 -> (Map('I' -> ErrorStateId, 'V' -> ErrorStateId, 'X' -> ErrorStateId), true),
    10 -> (Map('I' -> 1, 'V' -> 5, 'X' -> 20), true),
    20 -> (Map('I' -> ErrorStateId, 'V' -> ErrorStateId, 'X' -> ErrorStateId), true),
    ErrorStateId -> (Map.empty[Char, Int], false)
  )

  val system = ActorSystem("RomanNumberAcceptor")

  val states: Map[Int, ActorRef] =
    for ((id, (map, accepted)) <- State.data)
      yield id -> system.actorOf(Props(State(id, map, accepted)), name = "s"+id)

  def testNumber(s: String) {
    states(0) ! WordData(s, s)
  }

  def stop() {
    for (a <- states.values)
      system stop a
    system.shutdown()
  }
}

case class State(id: Int, transMap: Map[Char, Int], accepted: Boolean) extends Actor {
  def receive = {
    case WordData(fullWord, _) if `id` == State.ErrorStateId =>
      println("Error: "+fullWord)
    case WordData(fullWord, remainder) if remainder.isEmpty =>
      println((if (accepted) "Success: " else "Error: ") + fullWord)
    case WordData(fullword, remainder) =>
      // maybe some heavy operation here
      (0 to 1e4.toInt).sum

      val nextAktor = transMap(remainder.head)
      State.states(nextAktor) ! WordData(fullword, remainder.tail)
  }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T13:49:55.300

（以下假设是 Scala 的非 Akka 演员。请参阅下面的编辑以了解如何调整它以与 Akka 一起使用）

在我看来，有两种可能的答案：

1.  这没有意义。按照设计，您的每个状态参与者都没有这样*完成*，因为它仍然可能随时需要更多输入词并且只是在等待它们。完成的是发送要检查的单词的代码。

2.  尽管您似乎没有为`WordData`消息返回任何有用的值，但您仍然可以等待返回值。您应该特别注意`!!`and`!?`运算符的用法。通过将它们链接到不同的演员，您可以等待他们处理完这个词。不过要小心`!?`，因为可重入状态可能会导致死锁。

相反，我建议您`Boolean`为消息定义一个答案`WordData`，告诉您该词是否被接受。然后，您可以使用`!!`来检索未来（取决于另一个未来，这取决于另一个未来，等等单词的长度），然后该`testNumber`方法可以阻止检索接受值。如果您想并行测试多个单词，您还可以`testNumber`返回本身，并在调用之前`Future`阻止对象中的所有这些未来。`App``stop`

简而言之：您应该在类型中查找`!!`演员的运算符`Future`。

**编辑：**很抱歉造成混乱。正如 drexin 在评论中指出的那样，Akka 2 确实改变了这种情况。请参阅[Futures 的 Akka 文档，](http://doc.akka.io/docs/akka/2.0.1/scala/futures.html)了解如何发送消息以检索未来。

至于仅检索`None`：当然，演员必须返回某种有意义的值（如`Boolean`上面提出的）。再次查看[文档](http://doc.akka.io/docs/akka/2.0.1/scala/actors.html#Reply_to_messages)以了解如何从参与者发送回复（基本上，`sender ! true`）。请注意，当然，只有基本情况可以返回`true`or `false`。当你调用另一个演员时，你将再次获得一个未来，为了避免死锁，你必须直接返回它。

因此，在调用方您将不得不连续等待这些期货，即等待最外层的未来评估另一个未来。然后等待这个未来，依此类推，直到您检索到一个非未来的布尔结果值。

从你的actor内部调用下一个actor并返回相应未来的评估（而不是未来本身）的问题意味着调用actor将被阻止。`!?`因此，这将导致与传统 Scala 角色在使用阻塞调用时相同的死锁行为。

# javascript - 删除 ID 高于点击的按钮

> ID：10800025
> 
> 赞同：0
> 
> 时间：2012-05-29T13:19:45.410
> 
> 标签：javascript

我不明白为什么我的代码不起作用。

我动态创建了三个按钮的组：组的第一个按钮的 id 为 1，第二个为 101，第三个为 201；第二组按钮将分别命名为 2、102 和 202，以此类推。

如果我想通过单击最后一个按钮来删除所有三个按钮，它可以工作。这是我在 onclick 事件中设置的：

```
butt.onclick = function() {
    removeElement(this.id);
    removeElement(this.id-100);
    removeElement(this.id-200);
} 
```

但是，如果我想通过单击带有此 onclick 事件的中间一个按钮来删除所有三个按钮：

```
butt.onclick = function() {
    removeElement(this.id+100);
    removeElement(this.id);
    removeElement(this.id-100);
} 
```

它只消除了按钮 1 和 101，但没有消除 201。

似乎它不喜欢“this.id+100”值。什么原因？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T13:23:06.883

尝试 `removeElement(parseInt(this.id)+100);`

'+' 运算符用于连接，因此需要在加法前进行数字。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T13:23:11.113

在您的第二个片段中，更改

```
removeElement(this.id+100); 
```

到

```
removeElement(parseInt(this.id)+100); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-29T13:25:15.223

您将字符串与数字混合......并使用`+`字符串连接尝试

```
butt.onclick = function() {
    removeElement(parseInt(this.id,10)+100);
    removeElement(this.id);
    removeElement(parseInt(this.id,10)-100);
} 
```

您用于[`parseInt()`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/parseInt)在 JavaScript 中将字符串转换为数字

# java - Google+Java API 获取 Access Token

> ID：10800028
> 
> 赞同：2
> 
> 时间：2012-05-29T13:20:11.253
> 
> 标签：java, eclipse, jboss

谁能告诉我如何使用 OAuth 2.0 从 googleplus 获取访问令牌用于 Web 服务器应用程序。如果您有任何代码，请在此处粘贴，将不胜感激

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-11T18:53:28.910

以下是获取访问令牌的方法，但在此之前您需要获取授权码

//获取授权码的代码

```
GoogleAuthorizationCodeRequestUrl authUrl = new GoogleAuthorizationCodeRequestUrl(
        CLIENT_ID, REDIRECT_URI,scopes);
         authUrl.setAccessType("offline");
    authUrl.setApprovalPrompt("force"); 
```

//获取访问令牌的代码

```
 HttpTransport netTransport = new NetHttpTransport();
      JsonFactory jsonFactory = new JacksonFactory();
      token = new GoogleAuthorizationCodeTokenRequest(netTransport, 
        jsonFactory, CLIENT_ID, CLIENT_SECRET, authorizationCode, 
        REDIRECT_URI).execute();
      System.out.println("Valid access token " + token.getAccessToken());
       GoogleCredential cd = new GoogleCredential().setAccessToken(token
        .getAccessToken()); 
```

此代码使用

google-api-client 1.9.0-beta google-api-services-plus v1-rev11-1.6.0-beta

# php - 如何将 GET 表单提交到基于参数的页面？

> ID：10800030
> 
> 赞同：1
> 
> 时间：2012-05-29T13:20:12.423
> 
> 标签：php, forms, parameters, get, submit

我有一个站点，其中每个页面实际上都是 index.php 页面的参数。

所以`search`页面很简单： `www.mysite.com/?p=search`

我创建了一个 GET 表单，其操作是上面的页面 ( `http://www.mysite.com/?p=search`)。但是，当我提交表单时，它实际上是将 GET 参数提交到`www.mysite.com/index.php`而不是`www.mysite.com/?p=search`.

我如何让表单实际提交，`www.mysite.com/?p=search`以便我最终得到类似的东西：

```
www.mysite.com/?p=search&param1=blah1&param2=blah2@&param3=blah3 
```

代替：

```
www.mysite.com/index.php?param1=blah1&param2=blah2@&param3=blah3 
```

?

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-29T13:23:17.470

在不破坏现有查询字符串的情况下，您不能使用表单向操作中带有查询字符串的 URI 发出 GET 请求。请改用隐藏输入。

添加`<input type="hidden" name="p" value="search">`到您的表单并设置`action="/"`

# java - 将 Java 正则表达式转换为 Javascript 正则表达式

> ID：10800032
> 
> 赞同：2
> 
> 时间：2012-05-29T13:20:15.367
> 
> 标签：java, javascript, regex

我在java中有一个正则表达式

```
^.*(?=.{8,})(?=.*\d)(?=.*[a-z])(?=.*[A-Z])(?=.*[!()*,/:;<>?\\\]\[\-_`{}~@#$%^&+=]).*$ 
```

它匹配具有以下条件的字符串：

*   至少 8 个字符
*   至少一位数
*   至少一个小写字母
*   至少一个大写字母
*   至少一个特殊字符

    ```
    [!()*,/:;<>?\\\]\[\-_`{}~@#$%^&+=] 
    ```

如何将其转换为 JavaScript 正则表达式？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T16:20:10.237

使用简单正则表达式的简单解决方案。

```
var re = /^(.{0,7}|\D+|[^a-z]+|[^A-Z]+|[^\^!@#$%&\*])$/;
if (!re.test(str)) {
    alert('Matched');
} 
```

请注意，我的正则表达式中缺少一些特殊字符。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-29T13:23:22.970

在它周围放两个斜杠：

```
var re = /<your_regex_here>/; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-29T13:23:04.303

它已经在 J​​avaScript 中工作了：

```
var re = /^.*(?=.{8,})(?=.*\d)(?=.*[a-z])(?=.*[A-Z])(?=.*[!()*,/:;<>?\\\]\[\-_`{}~@#$%^&+=]).*$/;
re.test('abcdefgh0A$') // true 
```

# python - 将大型 Python 数组保存到磁盘以供以后重复使用 --- hdf5？还有什么方法？

> ID：10800039
> 
> 赞同：3
> 
> 时间：2012-05-29T13:20:47.253
> 
> 标签：python, database, arrays, save, hdf5

我目前正在重写一些 python 代码以使其更高效，并且我有一个关于保存 python 数组以便以后可以重用/操作的问题。

我有大量数据，保存在 CSV 文件中。每个文件都包含我感兴趣的数据的时间戳值，并且我已经达到了必须处理数千万个数据点的地步。现在数据变得如此之大，以至于处理时间过多且效率低下——当前代码的编写方式每次添加一些新数据时都必须重新处理整个数据集。

我想做的是：

1.  将所有现有数据读入 python 数组
2.  将变量数组保存到某种数据库/文件
3.  然后，下次添加更多数据时，我会加载我的数据库，附加新数据并重新保存它。这样，任何时候只需要处理少量数据。
4.  我希望保存的数据可以被进一步的 python 脚本访问，但也可以相当“人类可读”，以便可以在 OriginPro 甚至 Excel 等程序中处理它。

我的问题是：保存数据的最佳格式是什么？HDF5 似乎具有我需要的所有功能——但是像 SQLite 这样的东西会更有意义吗？

编辑：我的数据是一维的。我基本上有 30 个大小为（百万，1）的数组。如果不是因为有这么多点，那么 CSV 将是一种理想的格式！我不太可能想要查找单个条目——更有可能是我可能想要绘制数据的小子集（例如，过去 100 小时或过去 1000 小时等）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T13:12:42.590

HDF5是一个绝佳的选择！它有一个漂亮的界面，被广泛使用（至少在科学界），许多程序都支持它（例如 matlab），有 C、C++、fortran、python 的库......它有一个完整的工具集显示 HDF5 文件的内容。如果您以后想对数据进行复杂的 MPI 计算，HDF5 支持并发读/写。它非常适合处理非常大的数据集。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-29T13:38:36.767

也许您可以使用某种键值数据库，例如 Redis、Berkeley DB、MongoDB ......但如果您能提供更多关于您将使用的模式的信息，那就更好了。

**已编辑**

例如，如果您选择[Redis ，您可以索引很长的列表：](http://redis.io/topics/data-types)

> 列表的最大长度为 232 - 1 个元素（4294967295，每个列表超过 40 亿个元素）。从时间复杂度的角度来看，Redis Lists 的主要特点是支持恒定时间插入和删除靠近头部和尾部的元素，即使插入了数百万个元素。访问列表的极端附近的元素非常快，但如果您尝试访问一个非常大的列表的中间，则速度很慢，因为这是一个 O(N) 操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-29T15:27:44.617

对于这个用例，我会使用一个具有固定记录长度的文件。没有专门的数据库解决方案（在这种情况下对我来说似乎有点过分），只是简单的旧`struct`（参见 struct.py 的文档）和文件上的 read()/write()。如果您只有数百万个条目，那么在几十或几百 MB 大小的单个文件中，一切都应该运行良好（这对于任何文件系统来说都不算太大）。您还可以随机访问子集，以防以后需要。

# java - 无法将文件从 Android 上传到 PHP 服务器

> ID：10800042
> 
> 赞同：1
> 
> 时间：2012-05-29T13:20:52.070
> 
> 标签：java, php, android

我正在制作一个将文件从卡**上传**到服务器的应用程序。但是，当我尝试执行此操作时，出现错误。`SD``PHP`

我的安卓代码如下：

```
package de.fileupload;

import android.app.Activity;
import android.os.Bundle;
import android.util.Log;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.TextView;
import org.apache.http.client.ClientProtocolException;
import org.apache.http.client.HttpClient;
import org.apache.http.client.methods.HttpEntityEnclosingRequestBase;
import org.apache.http.client.methods.HttpPost;
import org.apache.http.client.methods.HttpUriRequest;
import org.apache.http.entity.mime.MultipartEntity;
import org.apache.http.entity.mime.content.FileBody;
import org.apache.http.entity.mime.content.StringBody;
import org.apache.http.impl.client.DefaultHttpClient;
import java.io.BufferedReader;
import java.io.File;
import java.io.FileReader;
import java.io.IOException;
import java.io.PrintWriter;
import java.util.Date;
import android.os.Bundle;

@SuppressWarnings("unused")
public class FileUpload extends Activity {
/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    final TextView tmp = (TextView) findViewById(R.id.textView1);
    tmp.setText("Hi! Click the button!");

    Button b = (Button) findViewById(R.id.button1);
    b.setOnClickListener(new OnClickListener() {
    public void onClick(View v) {
    File f = new File("mnt/sdcard/SMSBackup.txt");
    try {
    f.createNewFile();
    Date d = new Date();
    PrintWriter writer = new PrintWriter(f);
    writer.println(d.toString());
    writer.close();
    HttpClient client = new DefaultHttpClient();
    httpPostFileUpload(client, "mnt/sdcard/SMSBackup.txt", "http://10.0.2.2:8080/admin/admin/upload1.php", "uploadedfile");
    } catch (Exception e) {
    // TODO Auto-generated catch block
    e.printStackTrace();
    }
    }
    });
    }
    public void httpPostFileUpload(
    HttpClient client,
    String filePath,
    String uploadUri,
    String inputNameAttr) throws ClientProtocolException,
    IOException {
    HttpUriRequest request = new HttpPost(uploadUri);
    MultipartEntity form = new MultipartEntity();

    client.getParams().setBooleanParameter("http.protocol.expect-continue", false);
    form.addPart(inputNameAttr, new FileBody(new File(filePath)));
    ((HttpEntityEnclosingRequestBase) request).setEntity(form);
    try {
    client.execute(request);
    } catch (ClientProtocolException e) {
    throw e;
    } catch (IOException ee) {
    throw ee;
    }
    }
    } 
```

我的PHP文件如下：

上传1.php

```
<meta name="generator" content="Namo WebEditor(Trial)">
<form enctype="multipart/form-data" action="upload.php" method="POST"> 
<input type="hidden" name="MAX_FILE_SIZE" value="100000" /> 
 Choose a file to upload: <input name="uploadedfile" type="file" /><br /><input 
 type="submit" value="Upload File" /> 
 </form> 
 <?php 
 $to_file = "tmp/" . basename($_FILES['uploadedfile']['name']); 
 $from_file = $_FILES['uploadedfile']['tmp_name']; 
 if (move_uploaded_file($from_file, $to_file)) { 
  echo "Successful upload"; 
 ?> 
 <a href="<?php echo $to_file;?>"><?php echo $to_file;?></a> 
 <?php 
 } else { 
 echo "Unsuccessful upload"; 
 } 
 ?> 
```

和 upload.php 是：

```
<?php
// Where the file is going to be placed 
$target_path = "localhost/admin/admin/uploads/";

/* Add the original filename to our target path.  
 Result is "uploads/filename.extension" */
 $target_path = $target_path . basename( $_FILES['uploadedfile']['name']); 

 if(move_uploaded_file($_FILES['uploadedfile']['tmp_name'], $target_path)) {
 echo "The file ".  basename( $_FILES['uploadedfile']['name']). 
 " has been uploaded";
 chmod ("uploads/".basename( $_FILES['uploadedfile']['name']), 0644);
 } else{
 echo "There was an error uploading the file, please try again!";
 echo "filename: " .  basename( $_FILES['uploadedfile']['name']);
 echo "target_path: " .$target_path;
 }
 ?> 
```

谁能告诉我哪里错了？它总是显示文件上传不成功。当我的服务器正在运行时。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T13:26:47.417

Try to use instead `move_uploaded_file()`, function `copy()`. They use the same input parameters, like this:

```
if(copy($_FILES['uploadedfile']['tmp_name'], $target_path)) { ... 
```

Most likely the PHP process has no permissions to move the uploaded file to different folder after successful upload, because the moving contains in essence copy and delete operation.

One more thing - try not to change the permission of the uploaded file to 0644, because this also can be restricted to the PHP process, i.e. when you deal with file system operations on Linux (I assume you use Linux machine for your server) the working process (in your case PHP and apache) has particular permissions set and maybe they do not have ability to delete/move files outside their working folder. You should also change the uploading folder permission to 755 or 777.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-09-08T01:17:32.383

此类允许您直接上传文件。无需解码您的文件。

```
public class Helpher extends AsyncTask<String, Void, String> {
    Context context;
    JSONObject json;
    ProgressDialog dialog;
    int serverResponseCode = 0;
    DataOutputStream dos = null;
    FileInputStream fis = null;
    BufferedReader br = null;

    public Helpher(Context context) {
        this.context = context;
    }

    protected void onPreExecute() {

        dialog = ProgressDialog.show(Main2Activity.this, "ProgressDialog", "Wait!");
    }

    @Override
    protected String doInBackground(String... arg0) {

        try {
            File f = new File(arg0[0]);
            URL url = new URL("http://localhost:8888/imageupload.php");
            int bytesRead;
            HttpURLConnection conn = (HttpURLConnection) url.openConnection();
            conn.setDoOutput(true);
            conn.setDoInput(true);
            conn.setUseCaches(false);
            conn.setRequestProperty("Content-Type", "multipart/form-data; boundary=" + BOUNDARY);

            String contentDisposition = "Content-Disposition: form-data; name=\"keyValueForFile\"; filename=\""
                    + f.getName() + "\"";
            String contentType = "Content-Type: application/octet-stream";

            dos = new DataOutputStream(conn.getOutputStream());
            fis = new FileInputStream(f);

            dos.writeBytes(SPACER + BOUNDARY + NEW_LINE);
            dos.writeBytes(contentDisposition + NEW_LINE);
            dos.writeBytes(contentType + NEW_LINE);
            dos.writeBytes(NEW_LINE);
            byte[] buffer = new byte[MAX_BUFFER_SIZE];
            while ((bytesRead = fis.read(buffer)) != -1) {
                dos.write(buffer, 0, bytesRead);
            }
            dos.writeBytes(NEW_LINE);
            dos.writeBytes(SPACER + BOUNDARY + SPACER);
            dos.flush();

            int responseCode = conn.getResponseCode();
            if (responseCode != 200) {
                Log.w(TAG,
                        responseCode + " Error: " + conn.getResponseMessage());
                return null;
            }

            br = new BufferedReader(
                    new InputStreamReader(conn.getInputStream()));
            StringBuilder sb = new StringBuilder();
            String line = null;
            while ((line = br.readLine()) != null) {
                sb.append(line + "\n");
            }
            Log.d(TAG, "Sucessfully uploaded " + f.getName());

        } catch (MalformedURLException e) {
        } catch (IOException e) {
        } finally {
            try {
                dos.close();
                if (fis != null)
                    fis.close();
                if (br != null)
                    br.close();
            } catch (IOException e) {
                e.printStackTrace();
            }
        }
        return String.valueOf(serverResponseCode);
    }

    @Override
    protected void onPostExecute(String result) {
        dialog.dismiss();

    }

} 
```

这是用于从 Android 上传图像的 AsyncTask “Helpher”类。要调用此类，请使用以下语法。

```
new Main2Activity.Helpher(this).execute(fileUri.getPath()); 
```

这里 fileUri.getPath() 本地图像位置。**如果您想在“StringBuilder sb”中查看服务器响应值，您可以打印 sb 值**

# sencha-touch - Sencha Touch IDE 或编辑器

> ID：10800044
> 
> 赞同：8
> 
> 时间：2012-05-29T13:20:55.303
> 
> 标签：sencha-touch, sencha-touch-2, sencha-architect

有 Sencha Touch 2 IDE 或编辑器吗？我知道 Sencha Architect 2。但它太昂贵了。如果有人使用 Sencha Touch IDE，那么我们只能给 CTRL+SPACE，它会给我所有的方法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-30T10:01:17.877

您可以使用 Aptana（免费）为 Ext.js / Sencha 添加自定义自动完成库。与 Sencha Touch 1 配合得很好（我还没有为 ST2 找到它）。

1.  进入 Aptana Studio 去帮助 -> 安装新软件
2.  单击“添加”以添加存储库
    *   名称：Spket IDE
    *   地点：[http ://www.spket.com/update/](http://www.spket.com/update/)
3.  在“使用：”列表中选择您刚刚添加的项目一个列表将出现与 Spket IDE 的 3 个存储库。（Spket IDE、Spket 文本编辑器和 Spket IDE 的 Xerces）全部安装

4.  下载[http://www.agpad.com/downloads/com.spket.js_1.6.18.jar](http://www.agpad.com/downloads/com.spket.js_1.6.18.jar)

5.  替换位于“C:\Program Files\Appcelerator\Aptana Studio 3\plugins”中的现有文件或您安装 Aptana 的位置（在“plugins”文件夹中）您必须安装此文件，因为 Spket 仅支持格式“jsb1”和“jsb2” . 通过此修复，它将支持“jsb3”（Sencha Touch 使用它）。
6.  在 Aptana Studio 中，转到 Windows -> 首选项 -> Spket -> Javascript 配置文件
    *   单击“新建”并写入“SenchaTouch”
    *   选择“SenchaTouch”并单击“添加库”并从显示的列表中选择“ExtJs”
    *   选择“ExtJs”并单击“添加文件”找到包含在从 sencha.com 下载的 zip 文件中的“sencha-touch.jsb3”。（确保该存档中的所有文件都位于同一文件夹中）......然后单击“打开”
    *   再次选择“SenchaTouch”并单击“默认”按钮
    *   点击“确定”

现在打开一个 sencha touch 项目的“.js”脚本并检查一下。

希望它会有所帮助

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T13:44:02.100

您没有这样的 Sencha Touch IDE。没有 IDE 可以为您提供 CTRL+Space 功能。

改用[senchafiddle.com](http://www.senchafiddle.com/) ...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-29T18:57:22.583

在 IntelliJ 中，您可以添加 Sencha Touch 库，您将获得一些完成。它并不完美，但绝对有帮助。您可以免费试用 30 天。

[http://blogs.jetbrains.com/idea/2012/04/smarter-javascript-completion-in-intellij-idea-111/](http://blogs.jetbrains.com/idea/2012/04/smarter-javascript-completion-in-intellij-idea-111/)

这个相关的问题有额外的信息：

[将 JavaScript 库包含到 IntelliJ IDEA 的自动完成功能中](https://stackoverflow.com/questions/8576588/including-javascript-libraries-to-intellij-ideas-autocomplete)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-05-24T06:34:01.757

我刚刚为 intelliJ 创建了一个 Sencha Touch 插件，它为选项卡着色、添加图标以帮助区分 MVC 文件并将代码模板添加到空 MVC 文件。[（我在这里](http://www.m-gd.com/sencha-workflow-intellij-plugin-senchatouchmvcolors/)上传了图片）

此外，由于即使不添加 ST 库，intellij 12 代码完成也非常棒。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-07-10T08:50:25.977

我将 Eclipse 与 aptana 3 和 spket 插件一起使用。您可以将 spket 配置为使用自动完成功能来使用 sencha touch 2.3.1。看我的[回答](https://stackoverflow.com/a/24672108/3824335)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-08-05T01:35:34.483

Sencha 最近推出的 JetBrains 插件是一个集成开发环境工具，可在 Sencha Frameworks 和 JetBrains 软件之间创建融合。这种集成以代码完成、检查和建议的形式出现，同时与原生 JetBrains 行为无缝协作。

最便宜的许可证适用于学生和其他特殊类别的 WebStorm 实际上免费。

Sencha 专家会喜欢重构更改的便捷性以及跟踪代码到源代码的简单性。

Sencha 初学者将受益，因为 JetBrains 插件提供完成建议，同时鼓励最佳实践代码结构和语法。

它还能用于 Touch 和 ExtJS 的开发。更多详情请点击[Sencha 链接](http://docs.sencha.com/tools/ide_plugins/jetbrains_ide_plugin.html)

# android - Android - 具有多个表的关系数据库 SQLite

> ID：10800047
> 
> 赞同：0
> 
> 时间：2012-05-29T13:21:01.257
> 
> 标签：android, database, sqlite, relational-database

我正在尝试使用 21 个表构建一个数据库，每个表都绑定了约束。我已经在 PHPmyAdmin 中实现了数据库，然后下载了结构脚本以导入我的 Android SQLite 数据库。

但是我想知道在Android中构建具有许多表的关系数据库的良好做法是什么，以及如何创建它们。

目前我有一个实现 SQLiteOpenHelper 的类：

```
public class SqlSig extends SQLiteOpenHelper {

@Override
public void onCreate(SQLiteDatabase db) {
    for(int i = 0; i != ConfigBDD.requetes.length; i++){
        db.execSQL(ConfigBDD.requetes[i]);
    }
}
} 
```

ConfigBDD.requetes[i] 获取包含表创建请求和约束请求的字符串数组。此代码根本不起作用，并且 logCat 使用 PRIMARY KEY 指令显示错误：

```
 05-29 15:13:51.992: E/Database(8187): Failure 1 (near "KEY": syntax error) on 0x15c4b8
 when preparing 'CREATE TABLE IF NOT EXISTS `arret` ( `id` int(11) NOT NULL , `id_externe`
 varchar(10) DEFAULT NULL, `id_pid` int(11) NOT NULL, `nom` varchar(50) NOT NULL,
 `description` varchar(255) DEFAULT NULL, PRIMARY KEY (`id`), KEY `id_pid` (`id_pid`) )
 DEFAULT CHARSET=utf8 =1 ;'. 
```

我很确定还有其他方法可以创建这个数据库，但没有找到关于多表 Android SQLite 数据库创建的任何解释......

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-29T13:32:24.657

您的：

```
CREATE TABLE IF NOT EXISTS `arret` ( 
  `id` int(11) NOT NULL , 
  `id_externe` varchar(10) DEFAULT NULL, 
  `id_pid` int(11) NOT NULL, 
  `nom` varchar(50) NOT NULL,
  `description` varchar(255) DEFAULT NULL, 
   PRIMARY KEY (`id`), 
   KEY `id_pid` (`id_pid`))
DEFAULT CHARSET=utf8 =1 ; 
```

如果您希望它在 SQLite 中工作，它可能看起来像这样。

```
CREATE TABLE IF NOT EXISTS arret ( 
  id INTEGER PRIMARY KEY NOT NULL , 
  id_externe TEXT DEFAULT NULL,
  id_pid INTEGER NOT NULL,
  nom TEXT NOT NULL,
  description TEXT
); 
```

后跟一个`CREATE INDEX`for your `id_pid`，这就是`KEY`MySQL 中的含义。

# android - (Android) 为什么不浮动 alpha 工作

> ID：10800056
> 
> 赞同：0
> 
> 时间：2012-05-29T13:21:17.737
> 
> 标签：android, transparency, alpha

我正在尝试设置动画师并显示一个从透明到不透明百分比的按钮。（如 70% 不透明）。问题是由于某种原因，当我在 nexus 上测试它时，它没有按预期显示。我什至尝试通过 xml 设置 alpha 以查看它是否可能是不起作用的浮点数。我需要在xml中使用某种修饰符吗

```
android:alpha=".7f" 
```

或类似的东西，因为我对它不能正常工作感到非常沮丧。

使用整数设置 alpha 也可以，但并非所有视图都可用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-25T11:41:02.440

我曾经遇到过同样的问题。

我在父布局中使用了这个属性：

```
animateLayoutChanges="true" 
```

在我删除这一行之后，alpha 再次起作用。

我希望这可能会对某人有所帮助。

# ruby-on-rails - 如何在 rails 中访问原始请求并稍后在 rails 中重新实例化请求？

> ID：10800060
> 
> 赞同：2
> 
> 时间：2012-05-29T13:21:29.583
> 
> 标签：ruby-on-rails, http

我想在文件上传转换为临时文件之前访问请求对象并将其添加到稍后处理的队列中，主要是因为 IO 对象无法编组或序列化。我怎样才能做到这一点？

我还需要稍后“重做”请求。我会在 Rails 请求生命周期的哪个时间点执行此操作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T17:34:35.163

代码示例，在 routes.rb 中：

```
post 'incoming_email' => Proc.new { |env|
  RequestCache.create!(
    data: env['rack.input'].read,
    content_type: env['CONTENT_TYPE'],
    content_length: env['CONTENT_LENGTH']
  )

  [200, {'Content-Type' => 'text/plain'}, ['OK']]
} 
```

在模型中：

```
class RequestCache < ActiveRecord::Base
  attr_accessible :data, :content_length, :content_type

  def params
    Rack::Request.new({
      'rack.input' => StringIO.new(data),
      'CONTENT_LENGTH' => content_length,
      'CONTENT_TYPE' => content_type
    }).POST
  end
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T14:35:17.767

我不知道这有多可行，但我会使用机架中间件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-29T15:09:33.017

好吧，只是为了做到这一点，你不要做那样复杂的事情。

如果您想在后台进程中进行上传，您可以简单地使用[delay_paperclip](https://github.com/jstorimer/delayed_paperclip)。这个gem使用[delayed_job](https://github.com/collectiveidea/delayed_job)并在后台进程中处理上传、调整大小、发送到s3（如果需要）。

# c# - 如何在非托管内存中实例化 C# 类？（可能的？）

> ID：10800063
> 
> 赞同：13
> 
> 时间：2012-05-29T13:21:39.770
> 
> 标签：c#, .net, garbage-collection, clr, unmanaged-memory

**更新：现在有一个“有效”的公认答案。你不应该，永远，永远，*永远*使用它。*曾经*。**

* * *

首先让我先声明我是一名游戏开发者，以此作为我的问题的序言。想要这样做有一个合法的 - 如果非常不寻常 - 与性能相关的原因。

* * *

假设我有一个这样的 C# 类：

```
class Foo
{
    public int a, b, c;
    public void MyMethod(int d) { a = d; b = d; c = a + b; }
} 
```

没有什么花哨。请注意，它是一个仅包含值类型的引用类型。

在托管代码中，我想要这样的东西：

```
Foo foo;
foo = Voodoo.NewInUnmanagedMemory<Foo>(); // <- ???
foo.MyMethod(1); 
```

该功能`NewInUnmanagedMemory`会是什么样子？如果不能在 C# 中完成，是否可以在 IL 中完成？（或者也许是 C++/CLI？）

基本上：有没有办法 - 无论多么hacky - 将一些完全任意的指针转换为对象引用。而且 - 没有让 CLR 爆炸 - 该死的后果。

（提出我的问题的另一种方式是：“我想为 C# 实现一个自定义分配器”）

这导致了后续问题：当面对指向托管内存之外的引用时，垃圾收集器会做什么（特定于实现，如果需要）？

并且，与此相关的是，如果`Foo`将引用作为成员字段会发生什么？如果它指向托管内存怎么办？如果它只指向分配在非托管内存中的其他对象怎么办？

最后，如果这是不可能的：为什么？

* * *

**更新：**到目前为止，这是“缺失的部分”：

**#1：**如何将 an 转换`IntPtr`为对象引用？尽管 IL 无法验证（见评论），但它可能是可能的。到目前为止，我没有运气。该框架似乎非常小心地防止这种情况发生。

（如果能够在运行时获取非 blittable 托管类型的大小和布局信息，那也很好。同样，框架试图让这成为不可能。）

**#2：**假设问题一可以解决——当 GC 遇到指向 GC 堆外的对象引用时会做什么？它会崩溃吗？Anton Tykhyy[在他的回答](https://stackoverflow.com/a/10800698/165500)中猜测它会的。考虑到该框架对防止#1 的谨慎程度，它似乎确实很有可能。能证实这一点的东西会很好。

（或者，对象引用可以指向 GC 堆内的固定内存。这会有所不同吗？）

基于此，我倾向于认为这种 hack 的想法是不可能的——或者至少不值得付出努力。但我很想得到一个涉及#1 或#2 或两者的技术细节的答案。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-29T13:59:05.983

> “我想为 C# 实现一个自定义分配器”

GC 是 CLR 的核心。只有 Microsoft（或 Mono 团队中的 Mono）才能取代它，而开发工作的成本很高。GC 是 CLR 的核心，搞乱 GC 或托管堆会使 CLR 崩溃——如果你非常非常幸运的话，很快就会崩溃。

> 当面对指向托管内存之外的引用时，垃圾收集器会做什么（特定于实现，如果需要）？

它以特定于实现的方式崩溃；）

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-12-11T19:08:33.913

我一直在尝试在非托管内存中创建类。这是可能的，但有一个我目前无法解决的问题 -~~您不能将对象分配给引用类型字段~~ *- 请参阅底部的编辑 -*，因此您的自定义类中只能有结构字段。 *这是邪恶的：*

```
using System;
using System.Reflection.Emit;
using System.Runtime.InteropServices;

public class Voodoo<T> where T : class
{
    static readonly IntPtr tptr;
    static readonly int tsize;
    static readonly byte[] zero;

    public static T NewInUnmanagedMemory()
    {
        IntPtr handle = Marshal.AllocHGlobal(tsize);
        Marshal.Copy(zero, 0, handle, tsize);
        IntPtr ptr = handle+4;
        Marshal.WriteIntPtr(ptr, tptr);
        return GetO(ptr);
    }

    public static void FreeUnmanagedInstance(T obj)
    {
        IntPtr ptr = GetPtr(obj);
        IntPtr handle = ptr-4;
        Marshal.FreeHGlobal(handle);
    }

    delegate T GetO_d(IntPtr ptr);
    static readonly GetO_d GetO;
    delegate IntPtr GetPtr_d(T obj);
    static readonly GetPtr_d GetPtr;
    static Voodoo()
    {
        Type t = typeof(T);
        tptr = t.TypeHandle.Value;
        tsize = Marshal.ReadInt32(tptr, 4);
        zero = new byte[tsize];

        DynamicMethod m = new DynamicMethod("GetO", typeof(T), new[]{typeof(IntPtr)}, typeof(Voodoo<T>), true);
        var il = m.GetILGenerator();
        il.Emit(OpCodes.Ldarg_0);
        il.Emit(OpCodes.Ret);
        GetO = m.CreateDelegate(typeof(GetO_d)) as GetO_d;

        m = new DynamicMethod("GetPtr", typeof(IntPtr), new[]{typeof(T)}, typeof(Voodoo<T>), true);
        il = m.GetILGenerator();
        il.Emit(OpCodes.Ldarg_0);
        il.Emit(OpCodes.Ret);
        GetPtr = m.CreateDelegate(typeof(GetPtr_d)) as GetPtr_d;
    }
} 
```

如果您关心内存泄漏，则应始终在完成课程后调用 FreeUnmanagedInstance。如果你想要更复杂的解决方案，你可以试试这个：

```
using System;
using System.Reflection.Emit;
using System.Runtime.InteropServices;

public class ObjectHandle<T> : IDisposable where T : class
{
    bool freed;
    readonly IntPtr handle;
    readonly T value;
    readonly IntPtr tptr;

    public ObjectHandle() : this(typeof(T))
    {

    }

    public ObjectHandle(Type t)
    {
        tptr = t.TypeHandle.Value;
        int size = Marshal.ReadInt32(tptr, 4);//base instance size
        handle = Marshal.AllocHGlobal(size);
        byte[] zero = new byte[size];
        Marshal.Copy(zero, 0, handle, size);//zero memory
        IntPtr ptr = handle+4;
        Marshal.WriteIntPtr(ptr, tptr);//write type ptr
        value = GetO(ptr);//convert to reference
    }

    public T Value{
        get{
            return value;
        }
    }

    public bool Valid{
        get{
            return Marshal.ReadIntPtr(handle, 4) == tptr;
        }
    }

    public void Dispose()
    {
        if(!freed)
        {
            Marshal.FreeHGlobal(handle);
            freed = true;
            GC.SuppressFinalize(this);
        }
    }

    ~ObjectHandle()
    {
        Dispose();
    }

    delegate T GetO_d(IntPtr ptr);
    static readonly GetO_d GetO;
    static ObjectHandle()
    {
        DynamicMethod m = new DynamicMethod("GetO", typeof(T), new[]{typeof(IntPtr)}, typeof(ObjectHandle<T>), true);
        var il = m.GetILGenerator();
        il.Emit(OpCodes.Ldarg_0);
        il.Emit(OpCodes.Ret);
        GetO = m.CreateDelegate(typeof(GetO_d)) as GetO_d;
    }
}

/*Usage*/
using(var handle = new ObjectHandle<MyClass>())
{
    //do some work
} 
```

我希望它能在你的道路上帮助你。

~~编辑：找到引用类型字段的解决方案：~~

```
class MyClass
{
    private IntPtr a_ptr;
    public object a{
        get{
            return Voodoo<object>.GetO(a_ptr);
        }
        set{
            a_ptr = Voodoo<object>.GetPtr(value);
        }
    }
    public int b;
    public int c;
} 
```

编辑：更好的解决方案。只需使用`ObjectContainer<object>`代替`object`等。

```
public struct ObjectContainer<T> where T : class
{
    private readonly T val;

    public ObjectContainer(T obj)
    {
        val = obj;
    }

    public T Value{
        get{
            return val;
        }
    }

    public static implicit operator T(ObjectContainer<T> @ref)
    {
        return @ref.val;
    }

    public static implicit operator ObjectContainer<T>(T obj)
    {
        return new ObjectContainer<T>(obj);
    }

    public override string ToString()
    {
        return val.ToString();
    }

    public override int GetHashCode()
    {
        return val.GetHashCode();
    }

    public override bool Equals(object obj)
    {
        return val.Equals(obj);
    }
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-05-30T02:26:31.647

# 纯 C# 方法

所以，有几个选择。最简单的方法是在结构的不安全上下文中使用 new/delete。第二种是使用内置的编组服务来处理非托管内存（代码如下）。但是，这两种方法都处理结构（尽管我认为后一种方法非常接近您想要的）。我的代码有一个限制，您必须始终坚持结构并使用 IntPtrs 进行引用（使用 ChunkAllocator.ConvertPointerToStructure 获取数据并使用 ChunkAllocator.StoreStructure 存储更改的数据）。这显然很麻烦，所以如果你使用我的方法，你最好*真的想要性能。**但是，如果您只*处理值类型，则这种方法就足够了。

# 绕道：CLR 中的类

类在其分配的内存中有一个 8 字节的“前缀”。四个字节用于多线程的同步索引，四个字节用于标识它们的类型（基本上，虚拟方法表和运行时反射）。这使得处理非托管内存变得困难，因为它们是特定于 CLR 的，并且同步索引可以在运行时更改。有关运行时对象创建的详细信息，请参见[此处](http://msdn.microsoft.com/en-us/magazine/cc163791.aspx)，有关引用类型的内存布局概述，请参见[此处。](http://www.codeproject.com/Articles/20481/NET-Type-Internals-From-a-Microsoft-CLR-Perspecti#4)还可以[通过 C# 查看 CLR](https://rads.stackoverflow.com/amzn/click/com/0735627045)以获得更深入的解释。

### 警告

像往常一样，事情很少像是/否这样简单。引用类型的真正复杂性与垃圾收集器在垃圾收集期间如何压缩分配的内存有关。如果您能以某种方式确保不会发生垃圾回收或不会影响相关数据（请参阅[fixed 关键字](http://msdn.microsoft.com/en-US/library/f58wzh21(v=VS.80).aspx)），那么您可以将任意指针转换为对象引用（只需将指针偏移 8 个字节，然后将该数据解释为具有相同字段和内存布局的结构；也许可以使用[StructLayoutAttribute](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.structlayoutattribute.aspx)来确定）。我会尝试使用非虚拟方法，看看它们是否有效；他们应该（特别是如果你把它们放在结构上）但是由于你必须丢弃的虚拟方法表，虚拟方法是不行的。

# 一个人不会简单地走进魔多

简单地说，这意味着托管引用类型（类）不能分配在非托管内存中。您可以在 C++ 中使用托管引用类型，但它们会受到垃圾收集的影响……而且过程和代码比`struct`基于 - 的方法更痛苦。这让我们何去何从？回到我们开始的地方，当然。

# 有一个秘密的方式

我们可以自己勇敢地进行~~Shelob 的 Lair~~内存分配。不幸的是，这是我们的道路必须分开的地方，因为我对此并不了解。我将为您提供一个或[两个](http://flylib.com/books/en/4.331.1.20/1/)[链接](http://flylib.com/books/en/4.331.1.19/1/)——实际上可能是[三个](http://msdn.microsoft.com/en-us/library/ms164513%28v=vs.85%29)或[四个。](http://community.bartdesmet.net/blogs/bart/archive/2005/07/24/2984.aspx)这相当复杂并引出了一个问题：您可以尝试其他优化吗？缓存一致性和高级算法是一种方法，对于性能关键的代码明智地应用 P/Invoke 也是一种方法。您还可以为关键方法/类应用上述仅结构的内存分配。

祝你好运，如果你找到更好的选择，请告诉我们。

# 附录：源代码

## 块分配器.cs

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Runtime.InteropServices;

namespace MemAllocLib
{
    public sealed class ChunkAllocator : IDisposable
    {
        IntPtr m_chunkStart;
        int m_offset;//offset from already allocated memory
        readonly int m_size;

        public ChunkAllocator(int memorySize = 1024)
        {
            if (memorySize < 1)
                throw new ArgumentOutOfRangeException("memorySize must be positive");

            m_size = memorySize;
            m_chunkStart = Marshal.AllocHGlobal(memorySize);
        }
        ~ChunkAllocator()
        {
            Dispose();
        }

        public IntPtr Allocate<T>() where T : struct
        {
            int reqBytes = Marshal.SizeOf(typeof(T));//not highly performant
            return Allocate<T>(reqBytes);
        }

        public IntPtr Allocate<T>(int reqBytes) where T : struct
        {
            if (m_chunkStart == IntPtr.Zero)
                throw new ObjectDisposedException("ChunkAllocator");
            if (m_offset + reqBytes > m_size)
                throw new OutOfMemoryException("Too many bytes allocated: " + reqBytes + " needed, but only " + (m_size - m_offset) + " bytes available");

            T created = default(T);
            Marshal.StructureToPtr(created, m_chunkStart + m_offset, false);
            m_offset += reqBytes;

            return m_chunkStart + (m_offset - reqBytes);
        }

        public void Dispose()
        {
            if (m_chunkStart != IntPtr.Zero)
            {
                Marshal.FreeHGlobal(m_chunkStart);
                m_offset = 0;
                m_chunkStart = IntPtr.Zero;
            }
        }

        public void ReleaseAllMemory()
        {
            m_offset = 0;
        }

        public int AllocatedMemory
        {
            get { return m_offset; }
        }

        public int AvailableMemory
        {
            get { return m_size - m_offset; }
        }

        public int TotalMemory
        {
            get { return m_size; }
        }

        public static T ConvertPointerToStruct<T>(IntPtr ptr) where T : struct
        {
            return (T)Marshal.PtrToStructure(ptr, typeof(T));
        }

        public static void StoreStructure<T>(IntPtr ptr, T data) where T : struct
        {
            Marshal.StructureToPtr(data, ptr, false);
        }
    }
} 
```

## 程序.cs

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace MemoryAllocation
{
    class Program
    {
        static void Main(string[] args)
        {
            using (MemAllocLib.ChunkAllocator chunk = new MemAllocLib.ChunkAllocator())
            {
                Console.WriteLine(">> Simple data test");
                SimpleDataTest(chunk);

                Console.WriteLine();

                Console.WriteLine(">> Complex data test");
                ComplexDataTest(chunk);
            }

            Console.ReadLine();
        }

        private static void SimpleDataTest(MemAllocLib.ChunkAllocator chunk)
        {
            IntPtr ptr = chunk.Allocate<System.Int32>();

            Console.WriteLine(MemAllocLib.ChunkAllocator.ConvertPointerToStruct<Int32>(ptr));
            System.Diagnostics.Debug.Assert(MemAllocLib.ChunkAllocator.ConvertPointerToStruct<Int32>(ptr) == 0, "Data not initialized properly");
            System.Diagnostics.Debug.Assert(chunk.AllocatedMemory == sizeof(Int32), "Data not allocated properly");

            int data = MemAllocLib.ChunkAllocator.ConvertPointerToStruct<Int32>(ptr);
            data = 10;
            MemAllocLib.ChunkAllocator.StoreStructure(ptr, data);

            Console.WriteLine(MemAllocLib.ChunkAllocator.ConvertPointerToStruct<Int32>(ptr));
            System.Diagnostics.Debug.Assert(MemAllocLib.ChunkAllocator.ConvertPointerToStruct<Int32>(ptr) == 10, "Data not set properly");

            Console.WriteLine("All tests passed");
        }

        private static void ComplexDataTest(MemAllocLib.ChunkAllocator chunk)
        {
            IntPtr ptr = chunk.Allocate<Person>();

            Console.WriteLine(MemAllocLib.ChunkAllocator.ConvertPointerToStruct<Person>(ptr));
            System.Diagnostics.Debug.Assert(MemAllocLib.ChunkAllocator.ConvertPointerToStruct<Person>(ptr).Age == 0, "Data age not initialized properly");
            System.Diagnostics.Debug.Assert(MemAllocLib.ChunkAllocator.ConvertPointerToStruct<Person>(ptr).Name == null, "Data name not initialized properly");
            System.Diagnostics.Debug.Assert(chunk.AllocatedMemory == System.Runtime.InteropServices.Marshal.SizeOf(typeof(Person)) + sizeof(Int32), "Data not allocated properly");

            Person data = MemAllocLib.ChunkAllocator.ConvertPointerToStruct<Person>(ptr);
            data.Name = "Bob";
            data.Age = 20;
            MemAllocLib.ChunkAllocator.StoreStructure(ptr, data);

            Console.WriteLine(MemAllocLib.ChunkAllocator.ConvertPointerToStruct<Person>(ptr));
            System.Diagnostics.Debug.Assert(MemAllocLib.ChunkAllocator.ConvertPointerToStruct<Person>(ptr).Age == 20, "Data age not set properly");
            System.Diagnostics.Debug.Assert(MemAllocLib.ChunkAllocator.ConvertPointerToStruct<Person>(ptr).Name == "Bob", "Data name not set properly");

            Console.WriteLine("All tests passed");
        }

        struct Person
        {
            public string Name;
            public int Age;

            public Person(string name, int age)
            {
                Name = name;
                Age = age;
            }

            public override string ToString()
            {
                if (string.IsNullOrWhiteSpace(Name))
                    return "Age is " + Age;
                return Name + " is " + Age + " years old";
            }
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-29T13:27:37.980

您可以使用 C++ 编写代码并使用 P/Invoke 从 .NET 调用它，也可以使用托管 C++ 编写代码，让您可以从 .NET 语言内部完全访问本机 API。但是，在托管方面，您只能使用托管类型，因此您必须封装非托管对象。

举个简单的例子：[Marshal.AllocHGlobal](http://msdn.microsoft.com/en-us/library/s69bkh17.aspx)允许你在 Windows 堆上分配内存。返回的句柄在 .NET 中没有多大用处，但在调用需要缓冲区的本机 Windows API 时可能需要。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-05-29T13:29:13.827

这是不可能的。

但是，您可以使用**托管结构并创建此结构类型的指针**。这个指针可以指向任何地方（包括非托管内存）。

问题是，为什么要在非托管内存中有一个类？无论如何，您都不会获得 GC 功能。您可以只使用指向结构的指针。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-29T13:24:17.983

这样的事情是不可能的。您可以在不安全的上下文中访问托管内存，但所述内存仍然是托管的并受制于 GC。

> 为什么？

简单和安全。

但是现在我想起来了，我认为您可以将托管和非托管与 C++/CLI 混合使用。但我不确定，因为我从未使用过 C++/CLI。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-05-29T13:49:30.350

我不知道如何在非托管堆中保存 C# 类实例，甚至在 C++/CLI 中也不知道。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-06-01T03:01:15.423

可以完全在 .net 中设计一个值类型分配器，而无需使用任何非托管代码，它可以分配和释放任意数量的值类型实例，而没有任何显着的 GC 压力。诀窍是创建相对少量的数组（可能每种类型一个）来保存实例，然后传递保存相关索引的数组索引的“实例引用”结构。

例如，假设我想要一个“生物”类，它包含 XYZ 位置（`float`）、XYZ 速度（也`float`）、滚动/俯仰/偏航（同上）、伤害（浮动）和种类（枚举）。接口“ICreatureReference”将为所有这些属性定义 getter 和 setter。一个典型的实现将是一个`CreatureReference`具有单个私有字段的结构`int _index`，以及像这样的属性访问器：

```
  浮动位置{
    得到 {return Creatures[_index].Position;}
    设置 {Creatures[_index].Position = value;}
  };

```

系统将保留一个列表，其中列出了哪些阵列插槽已使用和空置（如果需要，它可以使用其中的一个字段`Creatures`来形成空置插槽的链接列表）。该`CreatureReference.Create`方法将从 vacant-items 列表中分配一个项目；实例的`Dispose`方法`CreatureReference`会将其数组槽添加到 vacant-items 列表中。

这种方法最终需要大量的样板代码，但它可以相当有效并避免 GC 压力。最大的问题可能是（1）它的`structs`行为更像引用类型而不是`structs`，以及（2）它需要调用的绝对纪律`IDispose`，因为未处置的数组槽永远不会被回收。另一个令人讨厌的怪癖是，将无法将属性设置器用于 type 的只读值`CreatureReference`，即使属性设置器不会尝试改变`CreatureReference`应用它们的实例的任何字段。使用接口`ICreatureReference`可以避免这种困难，但必须小心只声明限制为 的泛型类型的存储位置`ICreatureReference`，而不是声明 的存储位置`ICreatureReference`。

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2021-12-20T17:44:48.347

我在不依赖 Emit 的情况下编写了类似的实现，需要 .NET6(System.Runtime.InteropServices.NativeMemory)

## 用法：

```
using Native;
using System;

unsafe class Program
{
    class TestA : NativeClass
    {
        public int x;

        public virtual int GetX()
        {
            return x;
        }
    }

    class TestB : TestA
    {
        public int y;

        public override int GetX()
        {
            return base.GetX() * 3;
        }
    }

    public static unsafe void Main(string[] args)
    {
        TestA a = Factory<TestB>.Create();
        a.x = 10;

        int val = a.GetX();
        Console.WriteLine($"val is {val}");
        a.Free();
    }

} 
```

// - - 输出 - -

`val is 30`

## 暗示：

```
using System;
using System.Runtime.CompilerServices;
using System.Runtime.InteropServices;

namespace Native
{
    unsafe abstract class NativeClass
    {
        private void* _ptr;
        public void SetPtr(void* ptr)
        {
            if (_ptr != null) throw new Exception("ptr can only be assigned once");
            _ptr = ptr;
        }
        public void Free() { if (_ptr != null) NativeMemory.Free(_ptr); }
    }

    unsafe struct Factory<T> where T : NativeClass, new()
    {
        public static uint size { get; private set; }
        static byte[] header; // vtable *, monitor * and so on

        static readonly Func<IntPtr, T> cast2T;

        /// <summary>
        /// Create object at addr given
        /// </summary>
        /// <param name="ptr"></param>
        /// <returns></returns>
        public static T Create(void * ptr = null)
        {
            if (ptr == null) ptr = NativeMemory.Alloc(size);

            fixed (void* headerPtr = header) Buffer.MemoryCopy(headerPtr, ptr, header.Length, header.Length);

            T ret = cast2T(new IntPtr(ptr));
            ret.SetPtr(ptr);
            return ret;
        }

        public static object GetO_Dummy(object obj)
        {
            return obj;
        }

        static Factory()
        {
            IntPtr tptr = typeof(T).TypeHandle.Value;
            size = (uint)Marshal.ReadInt32(tptr, 4);

            T obj = new T();
            void* pObj = Unsafe.AsPointer(ref obj);

            header = new byte[MinClass.size];
            fixed (void* headerPtr = header)
                Buffer.MemoryCopy((void*)*(long*)pObj, headerPtr, header.Length, header.Length);

            var dummyFunc = GetO_Dummy;
            cast2T = Unsafe.Read<Func<IntPtr, T>>(Unsafe.AsPointer(ref dummyFunc));
        }
    }

    class MinClass
    {
        public static uint size { get; private set; }
        static MinClass()
        {
            IntPtr tptr = typeof(MinClass).TypeHandle.Value;
            size = (uint)Marshal.ReadInt32(tptr, 4);
        }
    }
} 
```

[https://github.com/Misaka-Mikoto-Tech/MonoHook/blob/master/Assets/Scripts/Others/NativeClass.cs](https://github.com/Misaka-Mikoto-Tech/MonoHook/blob/master/Assets/Scripts/Others/NativeClass.cs)

# iphone - 带有设备 UDID 的 Iphone 应用程序

> ID：10800064
> 
> 赞同：2
> 
> 时间：2012-05-29T13:21:41.130
> 
> 标签：iphone, ios, udid

我想将我的 Iphone 应用程序安装到不同的 iphone 上进行测试。但是每次我都做了配置文件的事情。如何在编译时在我的应用程序中使用设备 UDID，以便它们（应用程序）可以安装在这些 Iphone 上.....知道吗？

问候

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-29T15:18:50.287

步骤：1 打开你的[https://developer.apple.com/](https://developer.apple.com/)

步骤：2 打开 IOS 开发中心

步骤：3 在最少的菜单栏中单击“设备”。

步骤：4 然后单击“添加新设备”填写您的设备 UDID 和名称。然后提交。

步骤：5 现在点击左侧菜单栏中的“App Id”。创建您的应用程序 ID。

步骤：6 现在点击左侧菜单中的“证书”，选择开发领域。现在您应该有一个具有有效权限的证书来上传它。要获取证书，请打开“钥匙串访问”，然后在桌面的左上角（靠近苹果图标）单击“钥匙串访问”，现在选择 ...certificate Assistant > 从证书颁发机构请求证书。然后在第一行输入您的邮件，选择保存到磁盘，然后继续。现在开始将此证书上传到苹果帐户。

步骤： 7 现在点击苹果网站左侧菜单栏中的“Provisioning”。选择“开发”字段，然后单击右侧的“新配置文件”。制作您的应用配置文件，检查证书，选择您的应用 ID，检查设备。然后提交。

步骤：8 现在下载您的开发证书，确保状态应为“已发布”，并且您的配置文件名称应写在“配置文件”字段中。还下载您的配置文件并确保状态为“活动”。

步骤：9 双击您已下载的开发证书，然后双击您已下载的配置文件。

步骤 :10 现在打开您的项目并按照此操作.. Target > Info > Bundle Identifier。然后将您的捆绑标识符重命名为您的“应用程序 ID”。

步骤：11 转到您的目标 > 构建设置 > 代码签名 > 选择您的签名身份。在您的项目 > 构建设置 > 代码签名中选择相同的代码签名。

步骤：12 现在在左上角（靠近运行按钮）将方案设置为“IOS 设备”。按 window + B 然后右键单击 finder 中显示的“yourapp.app”，然后使用其配置文件将其压缩，并将此 zip 文件发送给您的客户端进行测试。

有关更多详细信息，请参阅[https://developer.apple.com/ios/manage/overview/index.action](https://developer.apple.com/ios/manage/overview/index.action) .....

谢谢你 ！！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T13:23:51.347

Apple 不允许这样做，仅当且仅当配置文件中有 UDID 时，作为 Ad-Hoc 构建的应用程序才会运行。

您需要通过配置门户为您想要测试您的应用程序的每个 iOS 设备添加 UDID。

有一种解决方案可以为您的大多数应用程序使用单个 Ad-Hoc 配置文件：使用通配符捆绑 ID (*) 使一个配置文件词与多个应用程序一起使用。但是对于具有 APNS 或 iAP 的应用程序，您不能这样做。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-29T13:52:59.013

以下是用于分发您的应用程序进行测试的 Apple 指南：

[http://developer.apple.com/library/ios/#DOCUMENTATION/Xcode/Conceptual/ios_development_workflow/35-Distributing_Applications/distributing_applications.html](http://developer.apple.com/library/ios/#DOCUMENTATION/Xcode/Conceptual/ios_development_workflow/35-Distributing_Applications/distributing_applications.html)

希望能帮助到你！

注意：您应该有权访问 iOS Provisioning Portal 以添加测试人员的设备 UDID。

# java - 在java中显示图像

> ID：10800065
> 
> 赞同：2
> 
> 时间：2012-05-29T13:21:41.947
> 
> 标签：java, swing, background, window

我在框架上显示图像时遇到问题。当图片显示时，左上角没有到达指定的 (0,0)，当我第一次运行它时，窗口的背景也会呈现窗口后面的任何视觉组件。有人知道出了什么问题吗？提前致谢-

```
import java.awt.image.ImageObserver;
import java.io.File;
import javax.imageio.*;
import javax.swing.*;

public class Window extends JFrame{
//the pictures
Image testImage = null;
Image backPic  = null;

//constructor
Window(){
    super("window");
    this.startWindow();
}

public void startWindow(){
    Image customIcon = Toolkit.getDefaultToolkit().getImage("iconImage.gif");
    testImage = Toolkit.getDefaultToolkit().getImage("tester.gif");
    backPic = Toolkit.getDefaultToolkit().getImage("black.png");
    setSize(700,600);
    setIconImage(customIcon);
    setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    setVisible(true);
    setResizable(false);
    setLocationRelativeTo(null);
}

public void paint(Graphics g){
    g.drawImage(testImage,0,0,null);
}
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T13:52:05.870

`paint()`问题是您的 testImage 在被调用时尚未完全加载。要解决此问题，您可以改为调用它：

```
g.drawImage(testImage,0,0,this); 
```

但我首选的方法是使用 JLabel 并让它处理图像绘制。我也强烈建议不要覆盖`JFrame.paint()`（如果你这样做，至少调用`super.paint(g)`）。如果您真的想自己绘制图像，请扩展`JComponent`并覆盖`paintComponent()`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-29T13:50:37.253

所以我给你的建议是使用`JLabels`例如 show `Images`，这是你可以肯定使用的最简单的方法。我创建了类似的基本项目来演示这种方式。

```
/**
 * @author Sajmon
 */

package com.sajmon.window;

import java.awt.Container;
import java.awt.FlowLayout;
import javax.swing.ImageIcon;
import javax.swing.JFrame;
import javax.swing.JLabel;

public class Window extends JFrame {

    private JLabel pictureLabel;
    private Container controls;

    public Window() {
        super("window");
        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        setResizable(false);
        setLocationRelativeTo(null);
        this.setSize(300, 300);
        this.startWindow();
    }

    private void startWindow() {
        controls = new Container();
        controls = getContentPane();
        controls.setLayout(new FlowLayout());
        pictureLabel = new JLabel(new ImageIcon("picture.png"));
        controls.add(pictureLabel);
    }
} 
```

和运行应用程序的主要方法。

```
/**
 *
 * @author Sajmon
 */
public class Main {

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {
            @Override
            public void run() {
                Window w = new Window();
                w.setVisible(true);
            }
        });
    }    
} 
```

**注意：**如果您使用 Swing，您应该使用 Runnable 接口启动您的应用程序。一般推荐这种方式。

希望能帮助到你。

# jquery - 如何获取 jquery 响应是否为文件？

> ID：10800072
> 
> 赞同：0
> 
> 时间：2012-05-29T13:22:07.540
> 
> 标签：jquery

```
$(document).ajaxComplete(function(event, request, settings) {
        alert(request.responseText);
}); 
```

在这段代码中，它同时提醒 js、css 文件和普通响应。无论如何只能得到简单的回应。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T13:27:02.783

听起来好像您正在获取 HTML 页面的全部内容（如果不是，那么这个答案没有意义）。

响应是一个文本块。你需要这样处理它。您可以在页面或变量中将其插入 DOM，然后从那里解析它以提取您想要的部分。

您在请求中只收到一个文件，而不是单独的 CSS/JS/HTML。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T13:28:53.473

从您的问题来看，您似乎正在通过 ajax 加载多个资源，因此您可以`content-type`在回调中获取响应标头，如果是`text/html`，您会提醒`responseText`

```
$(document).ajaxComplete(function(event, request, settings) {
     var ct = request.getResponseHeader('content-type');
     if (ct === "text/html") {
         alert(request.responseText);
     }
}); 
```

# sql-server - 在 SSRS 中有没有办法在单元格之间复制格式？

> ID：10800074
> 
> 赞同：12
> 
> 时间：2012-05-29T13:22:12.830
> 
> 标签：sql-server, sql-server-2008, reporting-services, ssrs-2008, ssas

我正在 SSRS 2008 R2 中开发几十个报告。我发现单元格的格式是任务中最乏味和最容易出错的部分。我知道如何单独格式化每个单元格。

有没有办法将一个单元格的格式复制到许多其他单元格？

我想避免在 XML 中进行搜索和替换，但我对此持开放态度。我的数据集查询是参数化的 MDX。

是否可以一次格式化整列？还是您总是必须格式化列中的每个单独的文本框？有没有办法为每个文本框指定默认格式？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-05-29T15:47:49.317

假设您正在右键单击每个文本框并使用**TextBox 属性**来编辑格式选项：

如果您转到 BIDS 中的**View**菜单并选择**Properties Window**，您将立即访问每个对象的所有属性（在我的 BIDS 中，它显示在右侧的解决方案资源管理器下方）。

![投标 SSRS 属性窗口](../Images/16b0496d604d35eebd51fe9c8c614f8b.png)

假设您在此处讨论的是报表中的 Tablix 控件，您只需单击列标题并在“属性”窗口中编辑格式选项即可设置整个列的格式。

当涉及到 4 或 5 个单元格但不是整个列/行时，您可以按住 shift 单击以允许您一次格式化多个单元格。

即单击单元格 1，按住 shift 然后单击单元格 4。然后，属性窗口将允许您编辑所选范围内的所有单元格。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-29T19:17:16.190

摆脱 GShenanigan 的回答，这取决于你所说的格式化是什么意思。如果是颜色、字体等，那么您可以定义一个变量，将其设置为您想要的值，然后将单元格的属性值设置为该变量的值。例如，假设您要将所有单元格的字体设置为 Courier New。您将定义一个名为“Font”的变量，将其设置为“Courier New”，然后对于您想要使用此字体的每个单元格，您将使用计算该变量值的表达式来设置它的值。然后，当需求发生变化并且所有这些单元格现在都需要是 Arial 时，您在一个地方（变量）更改它并且所有格式都会更改。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-11-12T06:28:36.380

步骤： 1\. 使用您想要的格式设置一个文本框的格式 2\. 选择该单元格并检查其属性窗口，在“格式”区域中，您将看到一些代码 3\. 复制该代码并选择您想要使用相同格式格式化的其他文本框。4\. 将复制的值粘贴到这些新选择的文本框的格式区域。5\. 完成。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-01-27T21:13:10.920

使用报告格式工具栏突出显示要更改的单元格并设置字体。在不允许在“属性”侧窗格中键入并在上下文菜单上禁用“属性”选项后，这对我有用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-12-19T01:11:45.940

我的解决方案是突出显示表格中我想要更改的所有单元格。然后单击**查看**以显示**属性**框。转到“**属性**”框下的“**数字**”部分并更改“**格式**” 。这可以按我的意愿工作并重新格式化所有单元格。

作为说明，我必须从我已经更改的单元格中粘贴我想要的格式。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-01-15T23:17:49.453

您可以根据格式化所需的条件来格式化列或行。

让我们看看不同的场景（假设您使用的是 Visual Studio /BIDS：

*   如果您的所有列或行都使用类似的格式化条件，您可以选择整行或整列 => 转到属性窗口 => 为格式化编写表达式
*   如果您的部分列需要使用类似的格式条件，您可以通过使用控制键并单击这些列来选择这些列并应用上述格式
*   如果每个单元格的格式都基于单独的条件（例如，您评估该单元格中的数据以格式化该单元格），您可以格式化特定的单元格或编写外部脚本代码

# xamarin.ios - 在 MonoDevelop / MonoTouch 中哪里指定 NSShowNonLocalizedStrings？

> ID：10800077
> 
> 赞同：2
> 
> 时间：2012-05-29T13:22:16.557
> 
> 标签：xamarin.ios, monodevelop, locale

我找到了这篇文章：http: [//jomnius.blogspot.de/2011/06/how-to-find-unlocalized-strings.html](http://jomnius.blogspot.de/2011/06/how-to-find-unlocalized-strings.html)

它描述了如何`NSShowNonLocalizedStrings`在您的应用程序中指定使控制台打印出未翻译的语言环境。我必须在哪里以及如何在 MonoDevelop 中指定此选项？

# python - 繁重的 I/O 和 python 多处理/多线程

> ID：10800078
> 
> 赞同：3
> 
> 时间：2012-05-29T13:22:16.667
> 
> 标签：python, multithreading, queue, multiprocessing

我正在设计一个有点软的东西，其中包括：

1.  在互联网上获取资源，

2.  一些用户交互（资源的快速编辑），

3.  一些处理。

我想用很多资源来做到这一点（它们都列在一个列表中）。每个都独立于其他。由于编辑部分很累，我想让用户（可能是我）的生活更轻松，这样他就不必等待每个资源的下载。为简单起见，我们在这里忘记了第三个任务。

我的想法是使用线程或多处理模块。一些线程（比如线程 1）会提前进行“下载”，而另一个（比如线程 2）会在已经下载的资源上与用户交互。

问题：如何确保线程 1 始终至少领先于 ahead_min 资源并且最多领先于 ahead_max (ahead_max>ahead_min)？

我通常需要类似于 Queue.Queue(ahead_max) （或 multiprocessing.Queue(ahead_max)) 的东西，除了当达到 ahead_max 时，插入被阻塞，直到队列中最多有 ahead_min 元素（实际上它阻塞直到队列为空，请参阅[http://docs.python.org/library/queue.html#module-Queue](http://docs.python.org/library/queue.html#module-Queue)）。弹出也应该被阻止，直到队列中至少有 ahead_min+1 个元素（在资源序列的末尾，我可以插入一些虚拟对象以确保处理最后一个资源）。

任何的想法？如果您想到任何更简单的替代方案，请分享！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T13:39:56.673

在这种情况下，我建议子类化`Queue`并实现您自己的逻辑。这应该是一件容易的事，因为该类的实现[已经](http://hg.python.org/cpython/file/v3.2.3/Lib/queue.py)`Queue`在 Python 中了。

您可以将其用作模板

```
from queue import Queue

class MyQueue(Queue):

    def put(self, item, block=True, timeout=None):
        ...

    def get(self, block=True, timeout=None):
        ... 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-29T13:42:53.833

首先，在这种情况下似乎`threading`更可取`multiprocessing`，因为您的任务似乎比 CPU 更受 IO 限制。然后，是的，利用队列来建立不同“模块”之间的通信。如果默认`pop`行为对您来说还不够，您可以使用`Queue.qsize()`并实现自己的逻辑。

# eclipse - 对面的 Ecore 遏制

> ID：10800083
> 
> 赞同：1
> 
> 时间：2012-05-29T13:22:39.743
> 
> 标签：eclipse, eclipse-emf

如下图：（<> 表示黑色菱形，表示 UML 中的组合）

```
+---+ 0..1   * +---+
| A |<>--------| B |
+---+          +---+ 
```

我有 A 类和 B 类。从 A 到 B 存在一个包含引用，且多重性未绑定。相反的参考具有多重性 0..1。

我的问题是：这不是相反的多重性错误/不可能吗？！因为在 Ecore 中，包含引用指定 B 只有作为 A 才能存在。因此从 B 到 A 的多重性始终为 1，不是吗？！

0..1 意味着 B 的实例可以有 A 或没有。

更新：我的任务是将以下 UML 图转换为 Ecore

```
+---+ 0..1   * +---+ *     1  +---+
| A |<>--------| B |--------<>| C |
+---+          +---+          +---+ 
```

我不确定如何将 UML 组合映射到 Ecore

*   从 A 到 B 的遏制参考，上限：-1
*   B 对 A 的反向引用，下限 0，上限 1
*   从 C 到 B 的遏制参考，上限：-1
*   对面引用 B 到 C，下界 = 上界 = 1

我对吗 ？！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T20:29:56.400

你的 UML 的意思是 A 可以包含很多 B，C 包含很多 B，B 可以引用 0..1 As 和恰好一个 B。

这个 UML 图是不正确的，因为 B 的一个实例不能被共享（这就是组合的意思）。所以链接 BC 也应该是 0..1，在这种情况下，您可以使用来自 A 和 C 的遏制。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T14:37:08.653

如果 B 是 EMF 资源的根，则它可以为零。EMF 资源根永远不会有任何容器。并且任何 EMF 模型都可以充当资源根。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-29T14:43:54.257

B 的实例可以存在而不包含在 A 中，但我很确定它不能在该状态下*持久化*（使用默认的 XML/XMI 持久性）。事实上，你可以让一个有效的模型进入这个状态：

*   如果您有其他对象 C，并具有对 B 的外部引用
*   A（并且根据其包含的性质，B）和C被加载到内存中并且所有引用都被解析
*   A被编辑删除B
*   C 现在将引用 B 的实例，但该实例将没有容器，并且 C 无法持久化（您将收到有关“B 不存在于资源中”的异常）。

# cjk - 五笔画 / 繁体中文 / 开源索引

> ID：10800087
> 
> 赞同：0
> 
> 时间：2012-05-29T13:22:55.437
> 
> 标签：cjk

我一直在寻找为五笔画（五笔划）输入法编制索引的汉字（繁体）开源索引。我只找到了部分列表（最多四位数），并且仅适用于 Simplified。我知道那里有清单，因为香港的所有手机都安装了繁体版的五笔画……有什么指示吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T03:41:02.817

谷歌（在这种情况下是谷歌 T-9）在救援：

```
https://code.google.com/p/ibus-t9/issues/detail?id=3 
```

[此页面有`table.txt`文件的链接]。

不完美，因为它同时列出了繁体和简体字符，但非常完整。

# windows-xp - 将exe的注册表设置更改为始终显示在辅助监视器上？

> ID：10800093
> 
> 赞同：0
> 
> 时间：2012-05-29T13:23:21.277
> 
> 标签：windows-xp, registry

Windows XP 操作系统中是否有注册表设置，我可以在其中更改设置，以便每当我启动我的应用程序时，它总是位于辅助监视器上？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T13:31:16.593

[Ultramon](http://www.realtimesoft.com/ultramon/)具有告诉某些应用程序在所需的监视器/位置上打开的功能。 ![在此处输入图像描述](../Images/52090eefe6a13a7325d8d01bc63f8b66.png)

# ebay-api - eBay API GetOrders 调用未按要求返回所有订单

> ID：10800096
> 
> 赞同：0
> 
> 时间：2012-05-29T13:23:26.753
> 
> 标签：ebay-api

我正在尝试使用 php 脚本获取在特定日期期间创建的订单。这是我向 ebay 提出的最基本要求：

```
<?xml version="1.0" encoding="utf-8"?>
<GetOrdersRequest xmlns="urn:ebay:apis:eBLBaseComponents">
<RequesterCredentials>
<eBayAuthToken>[my authentication token]</eBayAuthToken>
</RequesterCredentials>
<CreateTimeFrom>2012-05-10T00:00:00.000Z</CreateTimeFrom>
<CreateTimeTo>2012-05-15T00:00:00.000Z</CreateTimeTo>
</GetOrdersRequest> 
```

调用兼容性级别为 773。同样的请求在 ebay 的 API 测试工具上运行良好，但是当我在脚本中使用它时，它返回不正确的结果。
返回的条目总数为 2648，但订单数组仅包含 100 个订单。那 100 个订单也没有插入到我的数据库中。插入查询返回 false。谁能告诉我 Entries 和 ebay 返回的实际订单有什么区别？如何成功获取我所有的 2648 订单？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T13:00:52.093

您需要设置分页属性。eBay 每个响应/页面只能返回 100 个订单。对于 2648 个订单，您需要拨打 27 次电话。

有关正确语法，请参阅 eBay 文档：

[http://developer.ebay.com/devzone/xml/docs/reference/ebay/GetOrders.html#Request.Pagination](http://developer.ebay.com/devzone/xml/docs/reference/ebay/GetOrders.html#Request.Pagination)

# c# - 在不同的上下文中引发事件

> ID：10800098
> 
> 赞同：1
> 
> 时间：2012-05-29T13:23:43.817
> 
> 标签：c#, events, web, windows-services

我有一个 Web 应用程序和一个 Windows 服务。我在网站上试图发送需要在 Windows 服务中引发事件的消息。

我像这样启动 Windows 服务：

```
 _services.OnNewMessageArrivedAtEngine += new IntermediateServices.Services.OnNewMessageArrivedHandler(PutMessageInQueue); 
```

我尝试在 Web 应用程序的不同上下文中引发事件......

```
 if (OnNewMessageArrivedAtEngine != null)
   {
     OnNewMessageArrivedAtEngine(outgoingMessage);
   } 
```

OnNewMessageArrivedAtEngine 总是为空，因为不同的上下文......

我不想使用 Windows 队列。

谁能帮我？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T13:30:19.650

您的 Web 应用程序可以公开一个服务，并且您的 Windows 服务可以在需要时调用它

你需要“一些东西”（Remoting/WCF/etc）来使通信进程运行到两个不同的 AppDomain 中（就像你的情况一样）

# nhibernate - Nhibernate 无效转换

> ID：10800099
> 
> 赞同：-1
> 
> 时间：2012-05-29T13:23:48.947
> 
> 标签：nhibernate, casting, fluent-nhibernate

我正在尝试为我正在运行的 HQL 查询创建一个 DTO 对象，但是，当从我的存储库执行我的 HQL 查询时，它会产生一个 NH 转换错误：

```
System.InvalidCastException: Unable to cast object of type 'NHibernate.Hql.Ast.ANTLR.Tree.SqlNode' to type 'NHibernate.Hql.Ast.ANTLR.Tree.FromReferenceNode'. 
```

有没有人遇到过这个？

我的 DTO 映射和类如下：

```
 /// <summary>
    /// TODO: Update summary.
    /// </summary>
    public class TaskListItemMapping : ClassMap<TaskListItem>
    {
        public TaskListItemMapping()
        {
            ImportType<TaskListItem>();
            Id(x => x.TaskCode).GeneratedBy.Assigned();
        }
    }

 /// <summary>
    /// A class representing a task list data query result
    /// </summary>
    public class TaskListItem
    {
        public virtual int Code { get; set; }

        public virtual String Client { get; set; }

        public virtual string Matter { get; set; }

        public virtual DateTime DueDate { get; set; }

        public virtual bool Notepad { get; set; }

        public virtual bool Flag { get; set; }

        public virtual string Client { get; set; }

        public virtual string Issue { get; set; }

        public virtual string Grade { get; set; }

        public virtual String TaskInitials { get; set; }

        public virtual string Description { get; set; }

        public TaskListItem()
        {

        }
    } 
```

任何想法表示赞赏！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T13:28:48.103

我发现了导致这种情况的原因 - 这是构造函数中的数据不匹配

# java - 使用 Spring 集成从 spymemcached 获取超时

> ID：10800101
> 
> 赞同：1
> 
> 时间：2012-05-29T13:23:53.797
> 
> 标签：java, spring, memcached, spymemcached

我正在尝试配置为使用 spymemcached 从 memcached 服务器检索数据（尝试了 1.2 和 1.4）。我在这里（http://code.google.com/p/spymemcached/wiki/SpringIntegration）使用他们的 wiki 中提供的值对其进行了配置。但是，如果我将该 bean 作为 a`MemcachedClient`注入到我的类中，则每次尝试访问缓存时都会超时。我的代码行就这么简单：

```
 MyClass object = (MyClass) memcachedClient.get(cacheKey); 
```

目前该值不在缓存中，但我希望它返回 null。相反，我得到的只是一个 CXF 异常（这是一个网络服务），其中的原因是：

```
Caused by: net.spy.memcached.OperationTimeoutException: Timeout waiting for value
  at net.spy.memcached.MemcachedClient.get(MemcachedClient.java:1003)
  at net.spy.memcached.MemcachedClient.get(MemcachedClient.java:1018) 
```

日志中没有信息（尽管我仍在尝试将它们放入调试中，因为现在我只看到信息的 spymemcached 日志）。有人有类似的问题吗？我可以通过 telnet 访问 memcached 服务器，并且 get 正确返回`END`。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T12:23:18.803

问题在于使用`BINARY`协议。切换到`TEXT`工作正常。我猜 memcached 的安装版本不支持这个协议 - 但是这不是一个容易的捕获！

# jquery - 使用 jquery 移动弹出窗口

> ID：10800102
> 
> 赞同：2
> 
> 时间：2012-05-29T13:24:12.853
> 
> 标签：jquery, html, jquery-mobile, popup

我正在用 jquery mobile 构建一个 webapp。我想做一个基本的弹出窗口，就像[这里](http://jquerymobile.com/branches/popup-widget/docs/pages/popup/index.html)显示的那样。

但它不起作用，它还在屏幕上显示文本。
这是我的 HTML：

```
<div data-role="popup" id="basic" data-transition="pop">
    <p>I am a default popup</p>
</div> 
```

我这样称呼它。

```
if (zalen.length > 0) {   
    $('#basic').popup();     
} else {
    $('#basic').popup();    
} 
```

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-29T13:34:14.127

您没有正确遵循文档：

1)打开弹出窗口**的链接**应具有属性`data-rel="popup"`, 和`href="#somePopup"`。

2)**弹出内容**应具有属性`data-role="popup"`以及您在`href`属性中为链接指定的 ID。（`id="somePopup"`对于包含弹出内容的元素）

3）然后你可以像你建议的那样以编程方式调用它，`$("#somePopup").popup();`

**编辑：**除了已修复的这个问题之外，@SySammy 似乎是正确的；弹出窗口小部件仍在开发中，不在当前发布版本中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-19T13:04:50.117

如果你有这样的事情：

```
<div data-role='page' id='page0'>

</div>
<div data-role='page' id='pag1'>

</div>
 <div data-role='popup' id='pop1'>

</div> 
```

它不起作用，弹出窗口必须在调用它的页面内。

```
<div data-role='page' id='page0'>

   <div data-role='footer'></div>

   <div data-role='popup' id='pop1'>
   </div>
</div>
<div data-role='page' id='pag1'>

</div> 
```

我不知道为什么会这样，但我遇到了这种问题，这就是问题所在。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-29T13:55:58.113

弹窗仍在开发中，您需要等到下一个版本或使用[此插件](http://dev.jtsage.com/jQM-SimpleDialog/demos2/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-14T12:07:13.427

您是否确保按顺序包含 jquery 和 jquery-mobile 的 javascript。

```
<head>
  <script src="js/jquery-1.9.0.min.js"></script>
  <script src="jquery.mobile/jquery.mobile-1.3.0-beta.1.min.js"></script>
</head>

<body>

    <div  data-role="popup" id="basic" data-transition="pop">
                  <p>I am a default popup</p>
      </div>
     <div onclick="javascript:onSuccess();" >Open Popup</div>

<script type="text/javascript">
 function onSuccess(){
      $('#basic').popup('open'); 
 }    
</script>

</body> 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-05-29T14:03:32.257

试试这个

```
<div  data-rel="popup" id="basic" data-transition="pop">
          <p>I am a default popup</p>
</div> 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-08-23T19:51:51.620

在提出这个问题时，文档中没有说明弹出窗口的 HTML 代码必须在`<div data-role="page"> ... </div>`. 见：[https ://github.com/jquery/jquery-mobile/issues/4891](https://github.com/jquery/jquery-mobile/issues/4891)

现在，如果您不想打扰这些概念并专注于您的弹出内容，请使用我的插件[https://stackoverflow.com/a/12092465/976827](https://stackoverflow.com/a/12092465/976827) - 我在另一个 jQuery mobile popup() 相关问题。检查演示和代码，它很容易使用。

**演示和代码** [https://github.com/serbanghita/jQM-dynamic-popup](https://github.com/serbanghita/jQM-dynamic-popup)

# c++ - 连接字符串时出错 (C++)

> ID：10800104
> 
> 赞同：3
> 
> 时间：2012-05-29T13:24:17.343
> 
> 标签：c++, string

我正在尝试创建一个指向文件的字符串并收到此错误：

> .../testApp.cpp:75: 错误：'const char*' 和'const char [5]' 类型的无效操作数到二进制'operator+'

这是有问题的行：

```
 string path = "images/" + i + ".png"; 
```

这似乎是一个相当简单的问题，但它让我感到困惑。我还包括了字符串标题：

```
#include <string>
using namespace std 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-29T13:31:20.147

或`boost::format`：

```
std::string str = (boost::format("images/%d.png") % i).str(); 
```

`boost::format(FORMATTED_STIRNG) % .. %.. %..`用于格式化字符串处理，请参阅[wiki](http://en.wikipedia.org/wiki/Printf_format_string)。这个函数给你一个特殊的 boost 格式，你需要使用它的`.str()`成员函数将其转换为 std::string。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-29T13:29:30.353

您需要转换`i`为`std::string`：

```
string path = "images/" + boost::lexical_cast<string>(i) + ".png"; 
```

有关将 an 转换`int`为 a 的其他方法，`std::string`请参阅[将 int 附加到 std::string](https://stackoverflow.com/questions/10516196/append-an-int-to-a-stdstring/10516313#10516313)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-29T13:29:27.833

使用 a`stringstream`代替，`std::string`不支持整数的现成格式。

```
std::stringstream ss;
ss << "images/" << i << ".png";
std::string path = ss.str(); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-29T13:25:48.513

You are trying to concatenate string literals as if they are `std::string` objects. They are not. In C++ string literals are of type `const char[]`, not `std::string`.

To join two string literals, place them next to each other with no operator:

```
const char* cat = "Hello " "world"; 
```

To join two `std::string` objects, use `operator+(std::string, std::string)`:

```
std::string hello("hello ");
std::string world("world\n");
std::sting cat = hello + world; 
```

There is also an `operator+` to join a string literal and a `std::string`:

```
std::string hello("hello ");
std::string cat = hello + "world\n"; 
```

There is no `operator+` that takes `std::string` and `int`.

A solution to your problem is to use `std::stringstream`, which takes any `operator<<` that `std::cout` can take:

```
std::stringstream spath;
spath << "images/" << i << ".png";
std::string path = spath.str(); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-29T13:58:17.317

使用 C++11，我们得到了一组[`to_string`](http://en.cppreference.com/w/cpp/string/basic_string/to_string)函数，可以帮助将内置数字类型转换为 std::string。您可以在转换中使用它：

```
string path = "images/" + to_string(i) + ".png"; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-29T13:38:13.490

引用所有其他答案，是的，`std::string`没有内置对附加整数的支持。但是，您可以添加一个运算符来做到这一点：

```
template<typename T>
std::string operator +(const std::string &param1, const T& param2)
{
    std::stringstream ss;
    ss << param1 << param2;

    return ss.str();
}

template <typename T>
std::string operator +(const T& param1, const std::string& param2) {
    std::stringstream ss;
    ss << param1 << param2;

    return ss.str();
}

template <typename T>
std::string& operator +=(std::string& param1, const T& param2) 
{
    std::stringstream ss;
    ss << param1 << param2;

    param1 = ss.str();
    return param1;
} 
```

唯一真正的缺点是您必须首先将其中一个文字转换为字符串，如下所示：

```
string s = string("Hello ") + 10 + "World!"; 
```

# tsql - 带参数的动态 SQL，当参数值内部有预定义的运算符时

> ID：10800106
> 
> 赞同：0
> 
> 时间：2012-05-29T13:24:18.073
> 
> 标签：tsql, sql-server-2005, stored-procedures, xquery, dynamic-sql

我在 T-SQL 存储过程中有一种情况，在动态 SQL 中，参数/s 引用其他变量，其值具有单引号和其他预定义的运算符。当这种情况存在时，问题是 T-SQL 脚本失败。

附件是一个示例代码，演示了这种情况。任何想法如何解决这种情况？

```
 DECLARE @TransVocObj  XML,@xmlfragment XML,@SQL NVARCHAR(MAX)
SELECT @TransVocObj  =  '<TransactionVoucherViewModel><TransactionRows></TransactionRows></TransactionVoucherViewModel>'
                DECLARE @Narration varchar(100)
                SET @Narration ='AABBCC''DD''EEFF'-- @Narration ='AABBCCDDEEFF'
                Select @xmlfragment=
                '<TransactionRow>'+'<Description>'+@Narration +'</Description>'+'<DebitAmount>'+CONVERT(VARCHAR(30),500.00)+'</DebitAmount>'+'</TransactionRow>'
                SET @SQL=N' SET @TransVocObj.modify(''insert '+ CONVERT(NVARCHAR(MAX),@xmlfragment)+'   into (/TransactionVoucherViewModel/TransactionRows)[1] '') '
                EXECUTE sp_executesql @SQL,N'@TransVocObj XML Output,@xmlfragment XML',@TransVocObj OUTPUT,@xmlfragment
SELECT T.Item.query('.//Description').value('.','VARCHAR(60)') FROM  @TransVocObj.nodes('//TransactionRows/TransactionRow') AS T(Item) 
```

数据库服务器是 MS SQL SERVER 2005

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T21:18:34.260

您可以使用 REPLACE 函数将 @Narration 中的单引号字符加倍。因此，当您构建 @xmlfragment 时，它可能如下所示：

```
Select @xmlfragment= 
                '<TransactionRow>'+'<Description>'+REPLACE(@Narration,'''','''''')+'</Description>'+'<DebitAmount>'+CONVERT(VARCHAR(30),500.00)+'</DebitAmount>'+'</TransactionRow>' 
```

# ruby-on-rails - rails selectbox_tag onchange()

> ID：10800111
> 
> 赞同：0
> 
> 时间：2012-05-29T13:24:42.050
> 
> 标签：ruby-on-rails, ruby-on-rails-3

假设我们有一个选择框：
/app/views/tape/_form.html.erb
`<%= f.select :tape, Tape::LIST_TAPES %>`

和一个*.js.coffee*文件，我想在选择框中选择某个值时触发：
/app/assets/javascripts/tapes.js.coffee

```
function selectBoxValue(value){
  # value -- selected in selectbox;
  console.log("box_value = ", value);
} 
```

如何在 RoR 3.2 中完成？
[这](http://jsfiddle.net/7q2s9/7/)就是我在 html+js 中的意思。

**PS**
我是Rails的新手。对不起我的英语，谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T13:31:04.597

像这样的东西：

```
<%= f.select :tape, Tape::LIST_TAPES, :id => 'some_id' %> 
```

.js 文件：

```
$(function(){
    $('#some_id').change(function(){ 
        selectBoxValue(this.value); 
    });
}); 
```

请注意您的选择标签已经有`id`，以便您可以使用它并删除`:id => 'some_id'`

# java - Apple 的 JAVA：JMenu 的子菜单未更新

> ID：10800113
> 
> 赞同：3
> 
> 时间：2012-05-29T13:24:44.890
> 
> 标签：java, macos, jmenu

正如我在上一个问题中提到的那样，我在 Apple 的 JVM 中遇到了一些错误。我可以忍受第一个错误。但是第二个真的很烦人。如果我创建一个带有子菜单的 JMenu 并且我必须在运行时修改子菜单内容，我就是做不到。调试显示项目已添加到 Jmenu（子菜单）中。但是屏幕菜单栏中什么也没发生。这看起来像是真实 JMenu 对象的同步问题，它在 Mac OS X 菜单栏中的表示。

这是示例代码：

```
import javax.swing.JFrame;
import javax.swing.JMenu;
import javax.swing.JMenuBar;
import javax.swing.JMenuItem;
import javax.swing.SwingUtilities;

public class TestMenu extends JFrame{

    public TestMenu() {
        System.setProperty("apple.laf.useScreenMenuBar", "true");
        setDefaultCloseOperation(DISPOSE_ON_CLOSE);
        JMenuBar mb = new JMenuBar();
        mb.setName("menubar");
        JMenu menu = new JMenu("menu"); 
        JMenu submenu = new JMenu("submenu");
        JMenuItem item = new JMenuItem("test item");
        JMenuItem item2 = new JMenuItem("test item2");
        JMenuItem subitem1 = new JMenuItem("sub item1");
        JMenuItem subitem2 = new JMenuItem("sub item2");
        menu.add(item);
        mb.add(menu);
        menu.add(submenu);
        setJMenuBar(mb);
        menu.add(item2);
        setBounds(100, 100, 100, 100);
        setVisible(true);
        submenu.add(subitem1);
        submenu.add(subitem2);
    }

    public static void main(String[] args) {

        new TestMenu();

    }

} 
```

注意：我说的是 Apple JVM 的 1.6.0_15 版本。我必须牢记过时的版本，以确保我的软件不会因为用户计算机上的某些 JVM 中的错误而暴露任何数据，这些错误自从他或她购买了那个 MAC 后就没有更新。适用于 Windows 和 Mac OS X 的当前 Java 版本运行良好。问题本身：也许有人知道手动同步 JMenu 及其表示的方法？或者，也许您可​​以提出另一种解决方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T12:12:28.587

我找到了解决方案，而且并不难......

```
.................................
        menu.add(item2);
        setBounds(100, 100, 100, 100);
        setVisible(true);
        submenu.add(subitem1);
        submenu.add(subitem2);
        SwingUtilities.updateComponentTreeUI(mb); //This line updates menu representation
    }
................................ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T13:53:40.313

也许我理解错了，但**显示**更改只是一个问题？如果是这样，请在and`repaint()`之后尝试。`submenu.add(subitem1)``submenu.add(subitem2)`

# ruby-on-rails-3 - Annotating Rails models that have Globalize3 translation tables

> ID：10800114
> 
> 赞同：0
> 
> 时间：2012-05-29T13:24:58.650
> 
> 标签：ruby-on-rails-3, model, internationalization, annotate, globalize3

Is it possible to use the `annotate (2.4.1.beta)` gem to output `globalize3 (0.2.0)` translated properties in the models that they translate?

If I have a `Post` creation migration generated [like so](https://github.com/svenfuchs/globalize3#rails--310rc)

```
class CreatePosts < ActiveRecord::Migration
  def up
    create_table :posts do |t|
      t.timestamps
    end
    Post.create_translation_table! title: :string, text: :text
  end
  def down
    drop_table :posts
    Post.drop_translation_table!
  end
end 
```

and its corresponding class looking like

```
class Post < ActiveRecord::Base
  attr_accessible :title, :text
  translates :title, :text
end 
```

since the `:title` and `:text` attributes are not in the `posts` table but in the `post_translations` table, when I run

```
$ annotate --position before 
```

they are not included in the output for the `Post` model:

```
# == Schema Information
#
# Table name: posts
#    
#  id         :integer         not null, primary key
#  created_at :datetime        not null
#  updated_at :datetime        not null
#
class Post < ActiveRecord::Base
... 
```

Is there any way to include these attributes without manually typing them in after every annotation generation?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-24T06:54:50.727

目前，不幸的是，这个问题的答案是否定的，没有办法在注释生成中包含 Globalize 翻译属性。只需要继续监控[annotate 的 Github repo](https://github.com/ctran/annotate_models)上的开发。

# php - Use front side model function from admin side

> ID：10800115
> 
> 赞同：0
> 
> 时间：2012-05-29T13:24:58.577
> 
> 标签：php, opencart

I'm working on opencart **Version 1.5.1.3**. At one stage i want to use front side model function in the admin side controller file.

Can anyone please help me.? It would be appreciated.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2015-07-05T08:45:21.670

我知道它已经晚了，但可能对未来的工作有用。
只需将功能添加到您的`/system/engine/loader.php`. 但是您可能知道直接这样做可能会在将来伤害您。所以通过`vqmod`. 我会告诉你怎么做：

```
<?xml version="1.0" encoding="UTF-8"?>
<modification>
    <id>Loadin Catalog Models</id>
    <version>1.0</version>
    <vqmver>2.X</vqmver>
    <author>Hossein Shahsahebi</author>  
    <file name="system/engine/loader.php">
        <operation info="Add function which I could access catalog models from admin">
            <search position="after"><![CDATA[
                 protected $registry;
            ]]></search>
            <add><![CDATA[
                public function catalogModel($model) {
                    $file = DIR_CATALOG . 'model/' . $model . '.php';
                    $class = 'Model' . preg_replace('/[^a-zA-Z0-9]/', '', $model);

                    if (file_exists($file)) {
                       include_once($file);

                       $this->registry->set('model_' . str_replace('/', '_', $model), new $class($this->registry));
                    } else {
                       trigger_error('Error: Could not load model ' . $model . '!');
                       exit();               
                    }
                }
            ]]></add>
        </operation>
    </file>
</modification> 
```

您可以将此代码放在文件名中`your_own_chosen_name.xml`并将其放在`/vqmod/xml`.
现在要在管理员中使用例如`shipping/flat`目录目录模型，请使用：

```
$this->load->catalogModel('shipping/flat'); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-29T13:49:53.010

简单地说，你不能。如果管理员端不存在同名的模型文件，您需要做的是复制模型文件，或者将您需要的方法添加到管理员端模型文件

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-04-11T18:34:10.473

这就是我所做的：你有一个模型 catalog/model/foo/frontbar.php 和另一个模型 admin/model/foo/adminbar.php

您想在 adminbar.php 中包含 frontbar.php，然后访问 frontbar 的方法。

在 adminbar.php 中执行以下操作：

```
<?php
include_once __DIR__.'/../../../catalog/model/foo/frontbar.php';

class ModelFooAdminbar extends Model {

  private $frontInstance;
  public function fromFront()
  {
    if(!$this->frontInstance){
        $this->frontInstance = new ModelFooFrontbar($this->registry);
    }

     return $this->frontInstance;
  }
}
?> 
```

然后在您的管理控制器中执行以下操作：

```
$this->load->model('foo/adminbar');
$this->data['someFrontData'] = $this->model_foo_adminbar->fromFront()->getSomeMethodInFrontbar(); 
```

# excel - Pasting the result from an SQL statement into range of multiple cells?

> ID：10800118
> 
> 赞同：0
> 
> 时间：2012-05-29T13:25:14.880
> 
> 标签：excel, vba

I have an array of SQL statements which i loop through, execute, obtain the results and paste.

Most of the statements return just the one value but one of the SQL functions returns four values. I would like to hold an array of ranges which I can just paste the results of each SQL function into.

What would be the correct code from the point I return the recordset, to the point which I paste the recordset data, which would work for 1 value results and 4 value results? Should I be using `Something = rs.getrows`?? and what paste statement should I use?

The four value-result will be pasted into a vertical range of four cells, named X.

EDIT, got this so far:

```
For i = LBound(SQLFunctionArray, 1) To UBound(SQLFunctionArray, 1)

    If UseCurrencyAsArg(i) = True Then
        SecondArg = Ccy
    Else
        SecondArg = FileName
    End If

    SQLFunctionToCall = SQLFunctionArray(i)
    Range(RangeForPasting(i)) = WorksheetFunction.Transpose(GetSQLData(COB, SecondArg, SQLFunctionToCall))

Next 
```

but it doesnt work for the four-value SQL result. GetSQLData returns the `rs.getrows` array

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T16:54:04.500

您可以使用此函数翻转 GetRows 数组：

```
Function TransposeGetRows(arr)
    Dim nr As Long, nc As Long
    Dim r As Long, c As Long
    Dim arrOut()
    nr = UBound(arr, 2)
    nc = UBound(arr, 1)
    ReDim arrOut(0 To nr, 0 To nc)
    For r = 0 To nr
        For c = 0 To nc
            arrOut(r, c) = arr(c, r)
        Next c
    Next r
    TransposeGetRows = arrOut
End Function 
```

然后像这样将数组放在工作表上：

```
Range(RangeForPasting(i)).Resize(UBound(arr, 1) + 1, _
                                 UBound(arr, 2) + 1).Value = arr 
```

# javascript - Navigation through Remote in Samsung Smart Tv application

> ID：10800122
> 
> 赞同：3
> 
> 时间：2012-05-29T13:25:27.913
> 
> 标签：javascript, jquery, html, samsung-smart-tv

I am creating a samsung smart Tv javascript application, the HTML page is finished and now its time to integrate remote control options in it.

My application contains tabs/images for different chanells etc which when the user selects through remote, he will be redirected to. Now the the problem is that how this navigation will work?? how the user can go left right or up and down on these channel tabs using the remote control?

In the samsung smart tv documentation they have given info about their keys library but how can i use it in my application to move to different elements?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-01T11:14:00.157

不能给你一个完全有效的解决方案，但至少有一些我们如何做到这一点的做法。

您可以将 HTML 组织成不同的导航区域和类型。导航区域具有导航类型，通常是*list*或*grid*。

JavaScript 导航控制器跟踪您所在的区域。它还处理按键（上/下/左/右/回车），并根据导航类型确定下一个要突出显示的项目。

假设您有一个选项卡列表：

```
<div id="maintabs" class="tabs nav-current-zone" data-nav-type="list">
    <span class="tab nav-current-item">Tab 1</span>
    <span class="tab">Tab 2</span>
    <span class="tab">Tab 3</span>
</div> 
```

JavaScript 通常看起来像这样：

```
if($(".nav-current-zone").data("nav-type") === "list"){
    if(key === "down"){
       var currentItem = $(currentZone).find("nav-current-item");
       var nextItem =  $(currentItem).next();
       $(currentItem).removeClass("nav-current-item");
       $(nextItem).addClass("nav-current-item");
    } else if(key === "up"){
    ...
} 
```

如果您位于列表的顶部/底部并导航出列表怎么办？在这种情况下，您可以什么都不做，也可以定义另一个区域进入。

```
<div id="maintabs" data-nav-type="list" data-nav-leave-down="anotherZone">
    ...
</div>

<div id="anotherZone" data-nav-type="list" data-nav-leave-up="maintabs">
    ...
</div> 
```

所以让我们处理这个：

```
if(key === "down"){
   var nextItem =  $(currentZone).find("nav-current").next();
   if($(next).size() === 0){
        var nextZone = $(currentZone).data("nav-leave-down");
        //navigate to the other zone
   }
} 
```

# prototypejs - 原型中的淡出 div

> ID：10800123
> 
> 赞同：3
> 
> 时间：2012-05-29T13:25:37.873
> 
> 标签：prototypejs

我需要使用原型在我的页面中淡出一个 div。如何在原型中淡出 jquery 代码？

```
$('.exercise-main .content .loading-failure').fadeOut(function(){

    //my code

} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-29T13:38:17.100

我认为您将需要使用[script.aculo.us](http://script.aculo.us/)（它是出色的prototype.js 的一个很好的附加组件）以实现淡入淡出效果。

基本语法

```
new Effect.Fade('id_of_element', [options]);

 或者

new Effect.Fade(element, [options]);
```

完整的代码。

```
<html>
<头部>
<title>script.aculo.us 例子</title>

   <script type="文本/javascript"
   src="/javascript/prototype.js"></script>
   <script type="文本/javascript"
   src="/javascript/scriptaculous.js?load=effects"></script>
   <script type="text/javascript">

   功能淡化效果（元素）{
       新效果。淡入淡出（元素，
       {持续时间：1}）；
   }
   功能显示效果（元素）{
       新效果。出现（元素，
       {持续时间：1，从：1.0，到：1.0}）；
   }

   </脚本>
</head>
<正文>
<div onclick="FadeEffect('hideshow')">
    点击我淡出图像
</div>
<br />
<div onclick="ShowEffect('hideshow')">
    点击我再次显示图像
</div>
<br />
<div id="hideshow">
    <img src="/images/scriptaculous.gif" alt="script.aculo.us" />
</div>

</正文>
</html>

```

教程链接 - [http://www.tutorialspoint.com/script.aculo.us/scriptaculous_fade_effect.htm](http://www.tutorialspoint.com/script.aculo.us/scriptaculous_fade_effect.htm)

我自己使用过prototype.js和这个插件，所以如果你遇到任何问题，请随时发表评论.. :-)

# c++ - 如何在 C(++) 中定义自定义错误代码

> ID：10800126
> 
> 赞同：1
> 
> 时间：2012-05-29T13:25:50.497
> 
> 标签：c++, c, error-code

我正在拼命尝试在 C(++) 中定义自定义错误代码。

至于我正在从事的项目，禁止使用异常和信号以及任何其他可以分配动态内存的方法。

我对一些产生类似错误的方法使用了标准错误代码，但对于某些方法，错误是特定于操作系统提供的标准错误代码所涵盖的。

我还在我的系统中搜索了错误字符串，但无法找到错误消息 O_O 那些定义在哪里？

因此，我正在寻找任何允许我定义自定义错误代码（例如 666）和相应错误消息（“Satan 声明错误！”）的方法，这些错误消息将使用 strerror 输出。这是可能的还是我必须干预一些与系统相关的文件？

最好的问候， ahnimuhs

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T13:34:54.807

如果将枚举声明为类型，则可以满足类型安全传播的域。

然后您可以提供一个函数来访问作为字符缓冲区的描述（给定语言环境？，当前语言环境？）。

```
class t_mon_io_error {
public:
enum t_type {
...
  SatanDeclaredAnError = 666
...
};

static const char* Description(const t_type& pError) {
  switch(pError) {
...
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T13:42:23.647

[`strerror(3)`](http://ieee.uwaterloo.ca/coldfire/gcc-doc/docs/libc_99.html)允许用户定义的错误代码和标签的一些实现。

您必须提供一个`_user_strerror()`函数并在`__ELASTERROR`.

# javascript - Javascript and Performance

> ID：10800127
> 
> 赞同：0
> 
> 时间：2012-05-29T13:25:52.423
> 
> 标签：javascript, jquery, scroll

I'm experiencing a weird issue here. I have a Javascript code which scrolls my page diagonally. It takes the scrollTop() value and divides it to scroll diagonally. But when i try to scroll it with two "layers", the foreground scrolling more than the background layer, i experience a sluggish animation when i finish scrolling to bottom and try to scroll to top again.

I have tried somethings as i saw here, like caching vars, declaring in e.g. $(window) as $window with no luck. I dont know if this issue its happening by the Math or Animate.

Here's my jsfiddle: [http://jsfiddle.net/sPB3a/](http://jsfiddle.net/sPB3a/)

You can experience it in fullscreen here: [http://jsfiddle.net/sPB3a/show/](http://jsfiddle.net/sPB3a/show/)

Thanks for any tip!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T13:59:49.907

我认为问题的根本原因是背景图像的大小。我从您的页面中删除了所有背景图像，并且滚动非常流畅。

它们真的很重。您应该尝试使用质量非常低的 jpg 图像（小于 20k）。如果这可行，那么您必须处理图像以找到良好的折衷方案。

注意：png 格式是一种松散的图像格式。它适用于小图像和屏幕截图（大区域具有完全相同的颜色）。当有很多非常相似的颜色、模糊和渐变时，这并不好。例如照片。在您的情况下，您应该使用 jpg 格式并调整质量级别。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T14:01:18.120

您正在`$(window).scroll`函数中查询 dom。我不认为这是一个好习惯。

缓存你的变量，通过 javascript 访问 dom 非常慢。

我在您的代码中有很多东西，请检查它是否对您有帮助。

[小提琴](http://jsfiddle.net/DTHfP/2/)

```
$(function(){

    var $window = $(window);
    var windowHeight = $window.height();
    var windowWidth = $window.width();
    var content = $("#content");
    var section = content.children("section");
    var sectionsNumbers = section.length-1;
    var illusion =  $(".illusion1");
    var mask = $('#mask');
    // Scroll sets

    var windowScrollX = ((sectionsNumbers+1)*windowWidth)-windowWidth;
    var windowScrollY = ((sectionsNumbers+1)*windowHeight)-windowHeight;

    content.css({"width":windowScrollX+windowWidth,"height":windowScrollY+windowHeight});

    illusion .css({"width":windowScrollX+windowWidth,"height":windowScrollY+windowHeight});

    // Set mask w and h

    mask.css({"width":windowWidth,"height":windowHeight});
    $(".scrollRule").css("height", (sectionsNumbers+1)*windowHeight);

    section.each(function(sectionCount,val) {

        // Defines its width and height
        var $this = $(this);
        $this.css({"width":windowWidth,"height":windowHeight,"left":sectionCount*windowWidth,"top":sectionCount*windowHeight});

    });

    // When window scrolls

    var angleVar = windowScrollX/windowScrollY;
    var curScrollTop;
    $(window).scroll(function(){
        var $this = $(this);
        curScrollTop = $this.scrollTop();
        content.stop().animate({left: "-"+curScrollTop*angleVar, top: "-"+curScrollTop}, {duration: 1250, easing: 'easeOutQuart'});
       illusion.stop().animate({left: "-"+curScrollTop*angleVar*0.5, top: "-"+curScrollTop*0.5}, {duration: 1250, easing: 'easeOutQuart'});        
    }); 

}); 
```

# asp.net-mvc-3 - DotNetOpenAuth redirect to Homepage

> ID：10800128
> 
> 赞同：1
> 
> 时间：2012-05-29T13:26:02.570
> 
> 标签：asp.net-mvc-3, openid, dotnetopenauth

After a user logs in with their Google profile I am trying to redirect them back to the home page, however it keeps redirecting to default.aspx.

The line above the return in the code below is what I am using to try to redirect.

```
[System.Web.Mvc.AcceptVerbs(HttpVerbs.Post)]
public ActionResult Logon(string loginIdentifier)
{
    if (!Identifier.IsValid(loginIdentifier))
    {
        ModelState.AddModelError("loginIdentifier", "The specified login identifier is invalid");
        return View();
    }
    else
    {
        var openId = new OpenIdRelyingParty();
        IAuthenticationRequest request = openId.CreateRequest(Identifier.Parse(loginIdentifier));

        // Require some additional data
        request.AddExtension(new ClaimsRequest
        {
            BirthDate = DemandLevel.NoRequest,
            Email = DemandLevel.Require,
            FullName = DemandLevel.Require
        });

        request.AddCallbackArguments("http://localhost:5977/Home/About", "http://localhost:5977/Home/About");
        return request.RedirectingResponse.AsActionResult();
    }
} 
```

Any help would be appreciated, thanks!

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-30T02:45:39.707

添加回调参数不会控制用户在登录完成后去哪里。相反，web.config 设置了默认的重定向行为：

```
 <authentication mode="Forms">
        <forms defaultUrl="/myhomepage"/>
    </authentication> 
```

最终，这可以在您调用的控制器中被覆盖，`RedirectFromLoginPage`而不是使用`SetAuthCookie`然后手动重定向。但是无论如何，您通常应该在 web.config 文件中列出正确的主页 URL，在这种情况下，事情就会发生。

# active-directory - Read all active directory users for a particular CN and OU

> ID：10800129
> 
> 赞同：0
> 
> 时间：2012-05-29T13:26:05.683
> 
> 标签：active-directory, directory, ldap

I have a requirment to read all active directory users for a specified OU and CN, can you please provide the exact syntax for LDAP PATH: QUERY: Properties:

Please find details below for my AD:

```
LDAP PATH: LDAP://SERVER1.AI.US.AII.LOCAL:389/DC=AI,DC=us,DC=AII,DC=local 
```

Other values `OU=Security Groups` `CN=AB_E-P`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T15:27:45.430

搜索请求必须至少包含以下参数：

*   搜索开始的基础对象（不返回基础对象之上的对象）
*   搜索范围：`base`是基础对象本身，`one`是基础对象和基础对象下一级，`sub`是基础对象和基础对象下面的所有条目。
*   一个过滤器，它将返回的条目限制为与过滤器中的断言匹配的条目

也可以提供属性列表，但如果在搜索请求中没有提供任何用户属性，LDAP API 将请求所有用户属性，但不是全部。

用作基础对象，以及将`DC=AI,DC=us,DC=AII,DC=local`导致服务器在搜索响应中返回匹配条目的适当过滤器，一种可能的过滤器是`(cn=ab_e-p)`.

### 也可以看看

*   [LDAP：掌握搜索过滤器](http://ff1959.wordpress.com/2011/09/21/mastering-ldap-search-filters/)
*   [LDAP：搜索最佳实践](http://www.ldapguru.info/ldap/ldap-search-best-practices.html)
*   [LDAP：编程实践](http://ff1959.wordpress.com/2011/10/27/ldap-programming-best-practices/)

# java - RedBlackTrees Structure?

> ID：10800131
> 
> 赞同：2
> 
> 时间：2012-05-29T13:26:32.473
> 
> 标签：java, red-black-tree

I cannot manage to get my head around redbacktrees, based on this implementation [http://pastebin.com/Gg3YbPUg](http://pastebin.com/Gg3YbPUg).

```
/**
 * Insert into the tree.
 * @param item the item to insert.
 * @throws DuplicateItemException if item is already present.
 */
public void insert( AnyType item )
{
    current = parent = grand = header;
    nullNode.element = item;

    while( compare( item, current ) != 0 )
    {
        great = grand; grand = parent; parent = current;
        current = compare( item, current ) < 0 ?
                     current.left : current.right;

            // Check if two red children; fix if so
        if( current.left.color == RED && current.right.color == RED )
             handleReorient( item );
    }

        // Insertion fails if already present
    if( current != nullNode )
        throw new DuplicateItemException( item.toString( ) );
    current = new RedBlackNode<AnyType>( item, nullNode, nullNode );

        // Attach to parent
    if( compare( item, parent ) < 0 )
        parent.left = current;
    else
        parent.right = current;
    handleReorient( item );
} 
```

I've just made a simple tree using the numbers 1,14,15,2,11,7,5,8

```
// Test program
public static void main( String [ ] args )
{
    RedBlackTree<Integer> t = new RedBlackTree<Integer>( );

    t.insert(1);
    t.insert(14);
    t.insert(15);
    t.insert(2);
    t.insert(11);
    t.insert(7);
    t.insert(5);
    t.insert(8);

    t.printTree();
} 
```

And based off the example from [http://www.cs.auckland.ac.nz/software/AlgAnim/red_black.html](http://www.cs.auckland.ac.nz/software/AlgAnim/red_black.html), My Tree should look something like...

![RBT](../Images/e9c77d0db34ac35afbb6e026abbeaca6.png)

And my console output from the printTree function

```
/**
 * Print all items.
 */
public void printTree( )
{
    printTree( header.right );
}

/**
 * Internal method to print a subtree in sorted order.
 * @param t the node that roots the tree.
 */
private void printTree( RedBlackNode<AnyType> t )
{
    if( t != nullNode )
    {
        printTree( t.left );
        System.out.println("main element is <" + t.element + "("+t.color+")> left <" + t.left.element +"> right <" + t.right.element + ">" );
        printTree( t.right );
    }
} 
```

Is...

```
main element is <1(COLOR:RED)> left <8> right <8>
main element is <2(COLOR:BLACK)> left <1> right <5>
main element is <5(COLOR:RED)> left <8> right <8>
main element is <7(COLOR:RED)> left <2> right <14>
main element is <8(COLOR:BLACK)> left <8> right <8>
main element is <11(COLOR:RED)> left <8> right <8>
main element is <14(COLOR:BLACK)> left <11> right <15>
main element is <15(COLOR:RED)> left <8> right <8> 
```

(for reading purposes I have renamed 0 and 1 as COLOR RED AND BLACK) From what I understand the "header" variable is the root of the tree.

If I was to do something like

```
 public void function(AnyType x)
 {
    RedBlackNode<AnyType> n = find(x);
    //what is the parent of n?
 }

/**
 * Find an item in the tree.
 * @param x the item to search for.
 * @return the matching item or null if not found.
 */
public RedBlackNode<AnyType> find( AnyType x )
{
    nullNode.element = x;
    current = header.right;

    for( ; ; )
    {
        if( x.compareTo( current.element ) < 0 )
            current = current.left;
        else if( x.compareTo( current.element ) > 0 ) 
            current = current.right;
        else if( current != nullNode )
            return current;
        else
            return null;
    }
} 
```

From the above pastebin implementation of RedBlackTree how do I know what my current parent element is for n?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T13:30:17.400

如果它是一个适当的红黑树，遵守规则，那么根*必须*是黑色的，所以 1 不能是根。

我已经用 Java 构建了一个红黑树，如果您有兴趣，它的打印效果会更好：

```
└── (Black) 8
    ├── (Black) 2
    │   ├── (Red) 1
    │   │   ├── (Black) null
    │   │   └── (Black) null
    │   └── (Red) 5
    │       ├── (Black) null
    │       └── (Black) null
    └── (Red) 15
        ├── (Black) 11
        │   ├── (Black) null
        │   └── (Red) 14
        │       ├── (Black) null
        │       └── (Black) null
        └── (Black) 17
            ├── (Black) null
            └── (Black) null 
```

[这](http://code.google.com/p/java-algorithms-implementation/source/browse/src/com/jwetherell/algorithms/data_structures/RedBlackTree.java)是红黑树的代码，查看 RedBlackTreePrinter 类以了解我是如何构建控制台输出的。

# excel - How to run a macro automatically when the selections of pivot tables are changed

> ID：10800134
> 
> 赞同：3
> 
> 时间：2012-05-29T13:26:39.540
> 
> 标签：excel, pivot-table, vba

I got a pivot table with shows the data for Quarters in it, and a macro that performs some calculations based on the data in pivot table. So now I want to run the Macro automatically when I changed the selection of pivot items, like if select Quarter1 , it shows the values for Q1 and run the macro automatically so that it calculate the values for Q1, and same for all selections including the multiple selections..

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-29T13:37:55.483

在带有数据透视表的工作表的代码模块中放入类似这样的内容：

```
Private Sub Worksheet_PivotTableUpdate(ByVal Target As PivotTable)

' Call your macro here

End Sub 
```

# android - How can I know if I lost my GPS fix?

> ID：10800145
> 
> 赞同：1
> 
> 时间：2012-05-29T13:27:16.703
> 
> 标签：android, gps

I know that I received a GPS fix if onLocationChanged() is called .. But how can I know if I lost the GPS fix ?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T13:32:20.150

您停止接收对 onLocationChanged() 的调用。

# cvs - In cvs,how do i search for the comments that are present inside a particular ,v file

> ID：10800147
> 
> 赞同：0
> 
> 时间：2012-05-29T13:27:21.740
> 
> 标签：cvs

I need to grep for specific comments from a cvs file and give an output based on that in a python file.

For example, if there is a comment saying "deleted" then i need a command which outputs the comment so that I can assign that output to a variable and do an re.search on the contents of that variable in my python file.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T22:21:29.967

我假设“评论”是指随`cvs commit`.

仅给定一个`*,v`文件，您可以使用`rlog`命令（rcs 的一部分，而不是 cvs 的一部分）来获取将显示所有提交消息的日志。

但通常它应该是 CVS 存储库的一部分；在那种情况下，`cvs log`会做同样的事情。

两者都`rlog`产生`cvs log`非常相似的纯文本输出，应该相当容易解析。

根据您提供给我们的信息，我能想到的就这些了。提供更详细的问题，我们或许可以给您更详细的答案。

**更新 ：**

如果“注释”是指文件本身中的文本而不是提交消息，则可以使用如下命令提取文件的各个版本：

```
cvs update -p -r1.23 filename 
```

该`-p`选项告诉`cvs update`将文件的内容打印到标准输出。

无耻的自我推销：我自己的[get-versions](https://github.com/Keith-S-Thompson/get-versions)工具可让您在单个命令中获取文件的多个版本（它目前适用于 RCS、CVS 和 Git）。

提取特定评论并将其存储在变量中将需要更多的工作，正如我所说，这是一个更详细的问题。

# .net - 想要跨多个区域维护单个 SQL Azure DB

> ID：10800150
> 
> 赞同：3
> 
> 时间：2012-05-29T13:27:52.067
> 
> 标签：.net, azure, azure-sql-database, azure-data-sync

在我的应用程序中，我有如下场景。

*   用户下载我们的应用程序 exe 并包含在他们托管在 azure 中的应用程序中
*   我们在每个区域都有一个 REST API 用于从应用程序接收数据，因此数据传输不会给用户带来成本
*   exe 将数据发送到应用程序区域中的 REST API
*   REST API 将该数据存储在 SQL Azure DB 中，该数据库托管在一个区域中

这样，数据传输的费用由我们支付。现在，为了降低成本，我们希望删除其余 api 并将数据存储在跨所有区域托管的数据库中。这样用户使用的exe将直接将数据存储在与用户应用程序相同区域的数据库中。我们在 Web 应用程序中使用这些数据进行监控。我已经确定了三个暂时可能的解决方案：

1.  是否可以跨多个区域进行 SQL Azure DB 联合？
2.  我可以在多个区域中将 DataSync 与多个数据库一起使用。
3.  或者在蛮力方法中，我可以在所有地区托管独立的数据库，并在 Web 应用程序中使用时合并数据

我知道最后一种方法会起作用，但我想在最后一个地方使用它。
任何人都可以建议跨多个地区的联邦吗？
DataSync 的成本是多少？
有没有更好的解决方案？
谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T15:46:40.193

关于 SQL Azure 联合：所有联合必须在同一个 SQL Azure 服务器中，这也意味着同一个数据中心。关于多台服务器，我不确定未来对联邦的更新有什么可用的。

关于数据成本：Ingress 是免费的，因此无论哪个数据中心托管 REST 接口，都不会对来自客户端应用程序的传入数据产生带宽费用。

我知道您不是在寻求有关 REST 与直接数据库访问的架构建议，但是......我会更多地考虑保持 REST API 与直接数据库访问。通过使用 REST API，您将拥有一种很好的扩展方式以及监控用户活动。此外，您只需修改您的 REST 实现即可透明地更改您的架构（或迁移到联合），而不是将这些知识推送到您的客户端应用程序。

# postgresql - PostgreSql。连接的奇怪行为

> ID：10800162
> 
> 赞同：1
> 
> 时间：2012-05-29T13:28:55.657
> 
> 标签：postgresql, char, concatenation

很短的问题。谁能说出为什么这个查询

```
select LENGTH(' '::char || ' '::char), LENGTH(' '::text || ' '::char), LENGTH(' ' || ' '), LENGTH('a'::char || 'b'::char); 
```

返回

```
0    1    2    2 
```

空格是不与其他字符串连接的*特殊字符吗？*

文档只说：

```
Unless otherwise noted, all of the functions listed below work
on all of these types, but be wary of potential effects of
automatic space-padding when using the character type. 
```

为什么我这样做？因为我在存储过程中逐个字符地构建字符串，当我尝试将 varchar 与 char 连接时，什么也没有发生。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T13:32:02.793

[CHAR 类型](http://www.postgresql.org/docs/7.4/static/datatype-character.html)是“固定长度，空白填充”。这意味着如果您存储`"foobar"`到一个`char(10)`字段中，Postgres 实际存储`"foobar "`（即四个尾随空格，因此不会保留相邻的空格）。当您取回您的值时，任何尾随空格都会被删除。同样的情况也发生了`' '::char`——它的尾随空格被剥离，只留下一个零长度的字符串。

# javascript - jqwicket+单独的javascript

> ID：10800163
> 
> 赞同：1
> 
> 时间：2012-05-29T13:28:58.213
> 
> 标签：javascript, jquery, wicket

我无法将自己的 Javascript 放在单独的文件中并从 JQWicket（测试拖放插件）中使用它。这是 myscript.js：

```
com.mycompany.Test = function() {
return {
    test_func: function() {
        $('#msg').text('X position = ' + ui.position.left + ', Y position = ' + ui.position.top);
    }
}
} 
```

在java中我想调用test_func：

```
DraggableOptions drop = new DraggableOptions().dragEvent(
            "com.mycompany.Test.test_func()"); 
```

但它不起作用！我认为问题在于 myscript.js 包含在 jquery.js 之前，我不知道如何重新排序包含语句。

如果有人有一个带有从 jqwicket 调用的单独 javascript 文件的工作示例，我将非常感激！

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T19:22:27.017

将引用“myscript.js”的 JQBehavior 实例添加到您的组件/页面，如下所示：

```
JQBehavior behavior = new JQBehavior();
behavior.addJsResourceUrls("myscript.js");

Component comp = .... ;
comp.add(behavior); 
```

# wcf - WCF Net.Tcp 绑定和 customUserNamePasswordValidatorType

> ID：10800166
> 
> 赞同：1
> 
> 时间：2012-05-29T13:29:09.320
> 
> 标签：wcf, nettcpbinding

我有一个带有 Net.Tcp 绑定的 WCF 服务，我的服务器配置是

```
<?xml version="1.0" encoding="utf-8" ?>
<configuration>
  <system.serviceModel>
    <behaviors>
      <serviceBehaviors>
        <behavior name="">
          <serviceMetadata httpGetEnabled="true" />
          <serviceDebug httpHelpPageEnabled="true" includeExceptionDetailInFaults="true"/>
          <serviceCredentials>
            <userNameAuthentication userNamePasswordValidationMode="Custom"
                customUserNamePasswordValidatorType="Service.PlainUserNameValidator, Service" />
          </serviceCredentials>
        </behavior>
      </serviceBehaviors>
    </behaviors>
    <services>
      <service name="Service.TestService">
        <endpoint address="" binding="netTcpBinding" contract="Service.ITestService">
          <identity>
            <dns value="localhost" />
          </identity>
        </endpoint>
        <endpoint address="mex" binding="mexHttpBinding" contract="IMetadataExchange" />
        <host>
          <baseAddresses>
            <add baseAddress="net.tcp://localhost:8732/Service/TestService/" />
            <add baseAddress="http://localhost:8001/service/TestServiceMex/" />
          </baseAddresses>
        </host>
      </service>
    </services>
  </system.serviceModel>
</configuration> 
```

在我打开的配置中`customUserNamePasswordValidatorType`。启动主机的代码是

```
class Program
{
    static void Main(string[] args)
    {
        using (ServiceHost host = new ServiceHost(typeof(TestService)))
        {
            host.Open();
            Console.WriteLine("The service is ready.");
            Console.WriteLine(String.Format("Metadata is at {0}?WSDL", host.Description.Endpoints[0].Address));
            Console.WriteLine();
            Console.WriteLine("Press <ENTER> to terminate service.");
            Console.WriteLine();
            Console.ReadLine();
        }
    }
} 
```

我在配置文件中注册的自定义用户名验证器类是

```
namespace Service
{
    using System;
    using System.IdentityModel.Selectors;

    public class PlainUserNameValidator : UserNamePasswordValidator
    {
        public override void Validate(string userName, string password)
        {
            Console.WriteLine("Requesting username {0} and password {1}.", userName, password);
        }
    }
} 
```

然而，当客户端调用时，验证器似乎永远不会触发。

我需要注意什么特殊技巧才能启用`customUserNamePasswordValidatorType`绑定`Net.Tcp`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T08:32:02.277

两点：

您还没有包含证书，您应该这样做以确保客户端凭据的完整性，如果需要，请设置一个临时证书并将其添加到您的服务凭据中。

```
<serviceCertificate 
          findValue="localhost" 
            x509FindType="FindBySubjectName" 
            storeLocation="CurrentUser" 
            storeName="My" /> 
```

您还没有指定任何安全性 - 为此，客户端和服务端点都需要在其绑定上启用用户名和密码身份验证模式

```
<netTcpBinding>
  <binding name="tcpWithMessageSecurity">
    <security mode="Message" >
      <message clientCredentialType="UserName"/>
    </security>
  </binding> 
</netTcpBinding> 
```

然后

```
<endpoint address="" binding="tcpWithMessageSecurity" contract="Service.ITestService"> 
```

然后，命名您的行为并将其添加到上面的行中。

# css - 960 Grid：制作网格列表的正确方法

> ID：10800176
> 
> 赞同：0
> 
> 时间：2012-05-29T13:29:41.130
> 
> 标签：css, 960.gs

使用 960 网格时，制作信息列表的正确方法是什么？通过信息列表，我特别指的是您将在页面上向用户显示的数据列表，而不是列表框或 html 控件。

例如，转到主页 (http://stackoverflow.com/) 并查看“热门问题”列表。我想实现相同类型的列表，但使用 960gs。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T13:33:11.990

960gs 只是一种将页面划分为网格的方式，但内容的不同部分。一旦你开始将内容放入这些部分，它或多或少变得无关紧要。

如果您有数据列表，请使用标准列表标记 - 一个`<ul>`或`<ol>`包含一个或多个`<li>`元素。

如果您有表格数据（根据您的示例），则使用表格标记 -`<table>`带有适当的`<caption>`、`<thead>`、`<tfoot>`、`<tbody>`、`<tr>`和元素。`<th>``<td>`

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-29T13:43:47.017

您可以将列表包装起来，然后对列表中的每个项目`<div class="container_12">`进行迭代`<div class="grid_12 row">`

[http://jsfiddle.net/Zm627/1/](http://jsfiddle.net/Zm627/1/)

```
<div class="container_12">
  <div class="grid_12 row">
      <div class="grid_1 alpha">
            1 Vote          
      </div>
      <div class="grid_1">
            1 Answer
      </div>
      <div class="grid_1">
            17 Views
      </div>
      <div class="grid_9 omega">
          <div class="grid_12">
              <div class="grid_6">
                    Find variations between two database tables effciently
              </div>    
          </div>

          <div class="grid_12">
              <div class="grid_6">
                  <button>sql-server</button>                                                      
                  <button>database</button>
                  <button>tsql</button>
                  <button>replication</button>
              </div>    
          </div>
      </div>
  </div>
</div>​ 
```

# php - 如何检查 Doctrine 2 中的实体是否更改？

> ID：10800178
> 
> 赞同：34
> 
> 时间：2012-05-29T13:29:55.557
> 
> 标签：php, doctrine, doctrine-orm

我需要检查持久实体是否已更改并需要在数据库上更新。我所做的（但没有工作）如下：

```
$product = $entityManager->getRepository('Product')->find(3);
$product->setName('A different name');

var_export($entityManager->getUnitOfWork()->isScheduledForUpdate($product)); 
```

该代码总是打印`false`，我也尝试在检查工作单元之前刷新，但没有工作。

有人有建议吗？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-05-29T13:48:13.277

首先我会检查你的*setName*函数实际上正在做某事（$this-> name = $name...）如果它已经在工作，那么你可以在你的 services.yml 上定义一个事件监听器，当你叫同花顺。

```
entity.listener:
  class: YourName\YourBundle\EventListener\EntityListener
  calls:
    - [setContainer,  ["@service_container"]]
  tags:
    - { name: doctrine.event_listener, event: onFlush } 
```

然后定义 EntityListener

```
namespace YourName\YourBundle\EventListener;

use Doctrine\ORM\Event;
use Symfony\Component\DependencyInjection\ContainerAware;

class EntityListener extends ContainerAware
{   

    /**
     * Gets all the entities to flush
     *
     * @param Event\OnFlushEventArgs $eventArgs Event args
     */
    public function onFlush(Event\OnFlushEventArgs $eventArgs)
    {   
        $em = $eventArgs->getEntityManager();
        $uow = $em->getUnitOfWork();

        //Insertions
        foreach ($uow->getScheduledEntityInsertions() as $entity) {
            # your code here for the inserted entities
        }

        //Updates
        foreach ($uow->getScheduledEntityUpdates() as $entity) {
            # your code here for the updated entities
        }

        //Deletions
        foreach ($uow->getScheduledEntityDeletions() as $entity) {
            # your code here for the deleted entities
        }
    }
} 
```

如果您需要知道哪些实体正在被更改，但在将它们保存到数据库*后*对其进行处理，只需将更改的实体存储在私有数组中，然后定义一个从数组中获取实体的 onFlush 事件。

顺便说一句，要触发此类事件，您需要在实体上添加 @ORM\HasLifecycleCallbacks。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2015-03-06T15:55:21.393

我不需要/不想为我的案例创建监听器，所以我最终得到了

```
$product->setName('A different name');
$uow = $entityManager->getUnitOfWork();
$uow->computeChangeSets();
if ($uow->isEntityScheduled($product)) {
    // My entity has changed
} 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2015-11-25T18:11:34.010

[Doctrine2 文档。17\. 变更跟踪政策](https://www.doctrine-project.org/projects/doctrine-orm/en/latest/reference/change-tracking-policies.html)

如果您像我一样使用第三种形式（17.3\. Notify），您可以测试您的实体是否发生更改：

```
$uow = $entityManager->getUnitOfWork();
$uow->computeChangeSets();
$aChangeSet = $uow->getEntityChangeSet($oEntity); 
```

如果没有任何改变，它将返回空白数组。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2013-04-17T13:44:30.573

如果您需要访问具有旧值和新值的实体字段，您可能还想查看[PreUpdate事件。](http://docs.doctrine-project.org/projects/doctrine-orm/en/latest/reference/events.html#preupdate)

一个例子主要来自提供的链接：

```
<?php
class NeverAliceOnlyBobListener
{
    public function preUpdate(PreUpdateEventArgs $eventArgs)
    {
        if ($eventArgs->getEntity() instanceof User) {
            if ($eventArgs->hasChangedField('name') && $eventArgs->getNewValue('name') == 'Alice') {
                $oldValue = $eventArgs->getOldValue('name');
                $eventArgs->setNewValue('name', 'Bob');
            }
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2020-03-07T11:33:13.933

如果您只需要比较对象的新旧状态，那么这可能会更简单：

```
$originalEntityData = $entityManager->getUnitOfWork()->getOriginalEntityData($entityObject); 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2017-01-10T10:09:45.397

这个问题已经很老了，但可能仍然有一些人可能会从不同的角度面对这个问题。效果很好，`UnitOfWork`但它只返回更改数组。当某人实际上并不知道哪些字段可能已更改并且只想将整个实体作为对象进行比较时，这可能会很`$oldEntity`痛苦`$newEntity`。即使事件的名称是 preUpdate 如果有人会尝试从数据库中获取数据，如下所示：

```
$er->find($id); 
```

返回的实体将包含所有更改。解决方法很简单，但它有一些钩子：

```
public function preUpdate(Entity $entity, PreUpdateEventArgs $args)
{
    $entity = clone $entity; //as Doctrine under the hood 
                             //uses reference to manage entities you might want 
                             //to work on the entity copy. Otherwise,        
                             //the below refresh($entity) will affect both 
                             //old and new entity.
    $em = $args->getEntityManager();
    $currentEntity = $em->getRepository('AppBundle:Entity')->find($entity->getId());
    $em->refresh($currentEntity);

} 
```

对于那些正在使用另一个事件（例如 preFlush）的人，我已经快速检查了它并且解决方法效果不佳，因为该`refresh()`方法可能会丢弃任何刷新更改，因此需要做的是在侦听器中再次调用刷新并创建一些静态`$alreadyFlushed`切换以避免循环引用。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-11-14T12:55:03.250

根据我的需求、此处[的答案和文档](http://docs.doctrine-project.org/projects/doctrine-orm/en/latest/reference/events.html)`modifiedAt`，我为实体中的时间戳提出了以下解决方案。

```
/**
 * @Doctrine\ORM\Mapping\PreUpdate()
 *
 * @param \Doctrine\ORM\Event\PreUpdateEventArgs $args
 * @return $this
 */
public function preUpdateModifiedAt(\Doctrine\ORM\Event\PreUpdateEventArgs $args)
{
    $this->setModifiedAt(new \DateTime('now'));

    return $this;
} 
```

这是基于[文档所说](http://docs.doctrine-project.org/projects/doctrine-orm/en/latest/reference/events.html#preupdate)的`Event`，而不是其他可用的，例如`PostPersist`and `PreFlush`：

> PreUpdate 是使用最严格的事件，因为它是在 EntityManager#flush() 方法中的实体调用更新语句之前调用的。**请注意，当计算的变更集为空时，不会触发此事件。**

使用`PreUpdate`与其他方法相反，您可以将所有计算和计算密集型功能留给 Doctrine 已经定义的过程。手动触发变更集的计算，例如上面的[这些](https://stackoverflow.com/a/28902531/1155833) [答案](https://stackoverflow.com/a/33923626/1155833)是服务器 CPU 密集型的。onFlush 事件，例如在[接受的答案](https://stackoverflow.com/a/10800481/1155833)中使用的是一个选项（以演示的方式），但如果您依赖于检测实体的更改，则不是，就像您可以使用上面的函数（`preUpdateModifiedAt(PreUpdateEventArgs $args)`）一样。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-08-06T07:01:56.427

我同意@Andrew Atkinson 的说法：

> 如果您需要访问具有旧值和新值的实体字段，您可能还想查看[PreUpdate事件。](http://docs.doctrine-project.org/projects/doctrine-orm/en/latest/reference/events.html#preupdate)

但我不同意他提出的例子，根据我的经验，有一种更好的方法来检查是否发生了变化。

```
<?php
class Spock
{
    public function preUpdate(PreUpdateEventArgs $eventArgs)
    {
        if (!empty($eventArgs->getEntityChangeSet())) {
            // fill this how you see fit
        }
    }
} 
```

这样 if 只会在确实有某些字段发生更改或没有更改的情况下才会被触发。

至于如果这个或那个字段被改变了怎么办，那么是的，我推荐他的解决方案。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2017-07-04T07:22:32.570

我对 Doctrine 和每个记录 postFlush 的人感到好奇，因为在某些情况下，你有一个正在进行的事务。我想指出还有 postTransactionCommit，这可能更安全，具体取决于您在 postFlush 事件中尝试实现的目标。

# sql - 在 SQL 中以 Days:Hours:Mins:Seconds 格式计算 DateDiff

> ID：10800185
> 
> 赞同：5
> 
> 时间：2012-05-29T13:30:31.890
> 
> 标签：sql, datediff

我目前正在使用一个 SQL 脚本来计算两个日期之间的差异，这将为我提供 DD:HH:MI:SEC 格式的结果。示例：日期 1：2012 年 7 月 30 日下午 4:00 日期 2：2012 年 5 月 4 日上午 10:31

结果应该是 87:05:29:00

你能帮忙写这个脚本吗？问候， 阿琼

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-29T13:37:08.143

如果您使用的是 sql-server，那么您可以这样做：

```
declare @x int, 
        @dt1 smalldatetime = '1996-03-25 03:24:16', 
        @dt2 smalldatetime = getdate()

set @x = datediff (s, @dt1, @dt2)

SELECT convert(varchar, @x / (60 * 60 * 24)) + ':'
+ convert(varchar, dateadd(s, @x, convert(datetime2, '0001-01-01')), 108) 
```

参考[这里](http://social.msdn.microsoft.com/Forums/en-US/sqltools/thread/8de45c44-4521-40f6-a03b-4ba3e5214124)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-13T15:36:30.213

Well, you if want to perform some calculation, you could do this as well:

```
DECLARE @SecsInADay INT = 60 * 60 * 24
DECLARE @DATE1 DATETIME = CONVERT(DATETIME,'30/07/2012 16:00:00')
DECLARE @DATE2 DATETIME = CONVERT(DATETIME,'04/05/2012 10:31:00')
DECLARE @Days INT = DATEDIFF(DAY, @DATE2, @DATE1)
DECLARE @DiffInSeconds INT = DATEDIFF(SECOND, @DATE2, @DATE1)
DECLARE @TotalDaysInSeconds INT = @Days * @SecsInADay
DECLARE @RemainingHours INT = @DiffInSeconds - @TotalDaysInSeconds
DECLARE @Hours INT = @RemainingHours / 3600
DECLARE @Seconds INT = @RemainingHours % 3600
DECLARE @Minutes INT = @Seconds / 60
DECLARE @RemainingSeconds INT = @Seconds % 60

SELECT
CASE WHEN @Days < 10 THEN '0' + CAST(@Days AS VARCHAR) ELSE CAST(@Days AS VARCHAR) END + ':' +
CASE WHEN @Hours < 10 THEN '0' + CAST(@Hours AS VARCHAR) ELSE CAST(@Hours AS VARCHAR) END + ':' +
CASE WHEN @Minutes < 10 THEN '0' + CAST(@Minutes AS VARCHAR) ELSE CAST(@Minutes AS VARCHAR) END + ':' +
CASE WHEN @RemainingSeconds < 10 THEN '0' + CAST(@RemainingSeconds AS VARCHAR) ELSE CAST(@RemainingSeconds AS VARCHAR) END 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-22T14:51:16.247

嗨，我有一个类似的问题，花了一些时间思考，这是我的解决方案，我有用户订阅的表格，开始时间和结束时间很糟糕，我的问题有点复杂，基本上归结为：

```
SELECT subscription_id, time_open, time_closed, TIMESTAMPDIFF(DAY,time_open,time_closed) AS Day,

HOUR(sec_to_time(TIMESTAMPDIFF(SECOND,ADDDATE(`time_open`, INTERVAL TIMESTAMPDIFF(DAY,time_open,time_closed) DAY),`time_closed`))) AS Hour,

MINUTE(sec_to_time(TIMESTAMPDIFF(SECOND,ADDDATE(`time_open`, INTERVAL TIMESTAMPDIFF(DAY,time_open,time_closed) DAY),`time_closed`))) AS Minute,

SECOND(sec_to_time(TIMESTAMPDIFF(SECOND,ADDDATE(`time_open`, INTERVAL TIMESTAMPDIFF(DAY,time_open,time_closed) DAY),`time_closed`))) AS Second

FROM `user_subscription` 
```

所以基本上这个查询所做的是它通过在第一行中推断日期来计算天数。然后它将全天数添加到开始时间并减少关闭时间我的总和，所以剩下的是当天的时间。之后，您只需从中选择小时、分钟和秒。如果您想将它们全部连接在一起，则可以将字符串连接起来，但与字符串不同，这样您可以进一步使用它。

# c++ - 无法在 C++ 中使用 sprintf 打印字符串值

> ID：10800190
> 
> 赞同：1
> 
> 时间：2012-05-29T13:31:04.370
> 
> 标签：c++, visual-c++

我有一个接受两个 LPTSTR 类型参数的函数，我正在尝试使用 sprintf 打印这两个值，如下所示，我无法打印确切的值。

```
int __stdcall Logon(LPTSTR UserName, LPTSTR Password)
{
  char Buffer[2048];
  sprintf(Buffer,"UserName: %s\n m_Password: %s\n",UserName,Password);
  FILE *Ls=fopen("lo.log",a);
  fprintf(Ls,Buffer);
  fclose(Ls);
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-29T13:40:10.493

在项目设置中修复“使用 Unicode 字符串”或使用

```
_stprintf(Buffer, _T("UserName: %S\n m_Password: %S\n"), UserName, Password); 
```

和

```
#include <tchar.h> 
```

如果您使用 Unicode（并且确实如此），请使用 '%S' 格式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-29T14:15:09.597

假设`UserName`和`Password`被存储为宽字符串 ( `wchar_t`) 并且您正试图将它们放入`char[]`缓冲区中，然后使用 Visual c++`%S`来完成此操作。

```
sprintf(Buffer,"UserName: %S\n m_Password: %S\n",UserName,Password); 
```

# javascript - clearInterval 无法正常工作

> ID：10800192
> 
> 赞同：0
> 
> 时间：2012-05-29T13:31:05.107
> 
> 标签：javascript, jquery, setinterval, clearinterval

我正在使用 javascript **setInterval**函数对服务器进行一些查询，但是当触发 unload 方法时，GET 不会停止。

```
$(document).ready(function(){
    example.init();
});

$(window).unload(function(){
    clearInterval(example.INTERVAL_ID_1);
    alert(example.INTERVAL_ID_1+" killed!");
});

var example= {

    init: function(){
               this.INTERVAL_ID_1;

               ...
               this.INTERVAL_ID_1 = setInterval(function(){     
                ...
            }, 9000);

        },
        ...
} 
```

调用了卸载方法，警报给出了正确的 INTERVAL_ID 但它仍然存在，我可以看到在服务器控制台中进行的查询。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T13:19:02.037

不知何故，它正在工作……很奇怪，有时服务器控制台充斥着 GET 和 POST，但现在它正在工作……奇怪。

不过谢谢；）

# java - 在 for 循环或外循环中返回

> ID：10800195
> 
> 赞同：40
> 
> 时间：2012-05-29T13:31:14.727
> 
> 标签：java, for-loop, while-loop

今天，有人问我`return`在 Java 中对关键字的不当使用。我编写了一个简单的`for`循环来验证数组中是否存在某些内容。假设`array`是一个长度数组`n`，这是我的代码：

```
for (int i = 0; i < array.length; ++i) {
    if (array[i] == valueToFind) {
        return true;
    }
}
return false; 
```

现在有人告诉我，这不是很好的编程，因为我`return`在循环中使用该语句，这会导致垃圾收集出现故障。因此，更好的代码是：

```
int i = 0;
while (i < array.length && array[i] != valueToFind) {
    ++i;
}
return i != array.length; 
```

问题是我无法正确解释为什么第一个 for 循环不是一个好习惯。有人可以给我一个解释吗？

* * *

## 回答 #1

> 赞同：80
> 
> 时间：2012-05-29T13:37:42.623

> 现在有人告诉我，这不是很好的编程，因为我在循环中使用 return 语句，这会导致垃圾收集出现故障。

这是不正确的，并且建议您应该以一定程度的怀疑态度对待该人的其他建议。

“只有一个返回语句”（或更一般地说，只有一个退出点）的口头禅在您必须自己管理所有资源的语言中*很*重要 - 这样您就可以确保将所有清理代码放在一个地方。

它在 Java 中的用处要小得多：一旦您知道应该返回（以及返回值应该是什么），就返回。这样一来，阅读起来就更简单了——您不必考虑该方法的任何其余部分来计算还会发生什么（除了`finally`块）。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-05-29T13:35:48.290

> 现在有人告诉我，这不是很好的编程，因为我在循环中使用 return 语句，这会导致垃圾收集出现故障。

那是一堆垃圾。除非在类或其他地方有其他对方法的引用（封装很重要的原因），否则方法内的所有内容都将被清除。根据经验，通常最好使用一个 return 语句，因为它更容易确定方法将退出的位置。

就个人而言，我会写：

```
Boolean retVal = false;
for(int i=0; i<array.length; ++i){
    if(array[i]==valueToFind) {
        retVal = true;
        break; //Break immediately helps if you are looking through a big array
    }
}
return retVal; 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-29T13:36:19.707

所有语言中都有一些方法论提倡在任何函数中使用单个 return 语句。然而，在某些代码中它可能是不可能的，有些人确实为此而努力，然而，它最终可能会使您的代码更复杂（如在更多代码行中），但另一方面，更容易遵循（如在逻辑中）流动）。

这不会以任何方式弄乱垃圾收集！

如果你想听他的话，更好的方法是设置一个布尔值。

```
boolean flag = false;
for(int i=0; i<array.length; ++i){
    if(array[i] == valueToFind) {
        flag = true;
        break;
    }
}
return flag; 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-05-29T13:38:18.503

有些人认为一个方法应该有一个单一的出口点（例如，只有一个`return`）。就个人而言，我认为试图遵守该规则会产生更难阅读的代码。在你的例子中，一旦你找到你要找的东西，立即返回，它很清楚而且很有效。

[引用 C2 维基：](http://c2.com/cgi/wiki?SingleFunctionExitPoint)

> 对函数具有单一入口和单一出口的最初意义在于，它是结构化编程的原始定义的一部分，而不是无纪律的 goto SpaghettiCode，并允许在此基础上进行清晰的数学分析。
> 
> 现在结构化编程早已赢得了胜利，没有人特别关心这一点，页面的其余部分主要是关于最佳实践和美学等，而不是结构化编程结构的数学分析。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-05-29T13:40:33.697

代码在这两种情况下都是有效的（即，将编译和执行）。

`continue`我在 Uni 的一位讲师告诉我们，`return`在任何循环中包含语句是不可取的-`for`或`while`。这样做的原因是，在检查代码时，并不能立即清楚循环的全长是执行还是`return`or`continue`生效。

请参阅[为什么在循环内继续是一个坏主意？](https://stackoverflow.com/questions/4913981/why-is-continue-inside-a-loop-a-bad-idea)例如。

要记住的关键点是，对于像这样的简单场景（IMO）并不重要，但是当您有复杂的逻辑确定返回值时，如果您有一个单独的 return 语句而不是一些。

关于垃圾收集 - 我不知道为什么这会是一个问题。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2020-10-16T05:44:57.167

因为GC没有问题。我更喜欢这个。

```
for(int i=0; i<array.length; ++i){
    if(array[i] == valueToFind)
        return true;
} 
```

# configuration - 如何使用 Puppet 在 php.ini 中设置 config=value？

> ID：10800199
> 
> 赞同：12
> 
> 时间：2012-05-29T13:31:21.643
> 
> 标签：configuration, puppet, ini, augeas

我正在 Puppet 中迈出第一步，但遇到了问题。我已经在 Linux 服务器上安装了 PHP，我想对`php.ini`文件进行一些细微的更改。我不想`ini`用存储库中的一个文件覆盖整个文件，只需更改/创建一个简单的配置值。

我想确保`upload_max_filesize`in的属性`php.ini`具有`10M`.

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-08-24T21:03:39.823

我的首选选项是单独保留 php.ini，并让 puppet 在 php 的 conf.d 目录中创建一个文件以覆盖您要更改的值。

您对 php.ini 所做的更改越少，当您需要在将来升级 php.ini 时将更改与包提供程序更改合并时，就越容易看到发生了什么。

```
file {'/etc/php5/conf.d/upload_limits.conf':
  ensure => present,
  owner => root, group => root, mode => 444,
  content => "post_max_size = 10M \nupload_max_filesize = 10M \n",
} 
```

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2012-05-31T20:43:51.203

基本上有3个选项：

1.  在 puppet 中使用 augeas 支持（您需要安装 ruby​​ augeas 库），例如：

    ```
    augeas { "php.ini":
      notify  => Service[httpd],
      require => Package[php],
      context => "/files/etc/php.ini/PHP",
      changes => [
        "set post_max_size 10M",
        "set upload_max_filesize 10M",
      ];
    } 
    ```

    您可以使用“augtool ls /files/etc/php.ini”查看这些部分以了解 augeas 如何解析文件并使用它来计算出您需要的路径。

2.  您可以使用执行程序。就像是：

    ```
    define set_php_var($value) {
      exec { "sed -i 's/^;*[[:space:]]*$name[[:space:]]*=.*$/$name = $value/g' /etc/php.ini":
        unless  => "grep -xqe '$name[[:space:]]*=[[:space:]]*$value' -- /etc/php.ini",
        path    => "/bin:/usr/bin",
        require => Package[php],
        notify  => Service[httpd];
      }
    }
    set_php_var {
      "post_max_size":       value => '10M';
      "upload_max_filesize": value => '10M';
    } 
    ```

    不幸的是，这个解决方案不理解 php.ini 中的部分，因此添加一个尚不存在的变量将需要额外的努力。如果变量出现在多个部分中，这将做错事（但我正在查看的示例似乎具有所有唯一的变量名称）。这应该适用于存在但用分号注释掉的变量。

3.  将原始 php.ini 文件复制到您的 puppet 存储库中，并使用 file with`source => 'puppet:///...'`或`content => template(...)`完全替换该文件，正如您所指示的那样，您不希望这样做。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-02-06T19:42:28.507

您还可以使用 stdlib 模块中的 file_line 资源。

```
file_line{ 'php_upload_max_filesize':
  path => '/path/to/php.ini',
  line => "upload_max_filesize = 10M",
} 
```

因为如果不存在完全匹配的行，这会将行附加到文件中，并且由于配置值的最后一个实例优先于文件中较早的那些实例，因此它将起作用。当我只有几件事要改变时，我就是这样做的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-04-01T14:30:28.837

如果您使用 Apache 作为您的 Web 服务器，另一种方法是在您的 Apache 虚拟主机文件中设置 php 变量（可能在您的 Puppet 清单目录中的某个位置）。

例如：

```
<VirtualHost *:80>
  ServerName app.dev
  DocumentRoot /srv/app/public
  ## etc...

  php_value upload_max_filesize 10M

</VirtualHost> 
```

这实际上并没有改变 php.ini，但是 - 根据您的设置 - 可能是实现相同效果的简单方法。

# c# - 参数化查询被截断，参数丢失

> ID：10800200
> 
> 赞同：3
> 
> 时间：2012-05-29T13:31:28.027
> 
> 标签：c#, sql-server, ado.net, sqlparameter, executescalar

我有一段代码：

```
command.Parameters.Clear();
command.Parameters.Add(ownerUserIDParam);
command.Parameters.Add(buddyUserIDParam);
command.Parameters.Add(timestampParam);
command.Parameters.Add(new SqlParameter("@GiftID", giftID));
command.Parameters.Add(new SqlParameter("@GiftStatus", (byte)GiftStatusEnum.wait));
command.CommandText = "INSERT INTO SentGefts (OwnerUserID, BuddyUserID, CreateTS, GiftID, Status, AcceptRejectTS, ParentEntityType, ParentEntityID) VALUES (@OwnerUserID, @BuddyUserID, @TS, @GiftID, @GiftStatus, @TS, 0 ,0);";
command.CommandText += "SELECT @@IDENTITY;";
result.GiftInstanceID = long.Parse(command.ExecuteScalar().ToString()); 
```

我收到：参数化查询 '(@OwnerUserID int,@BuddyUserID int,@TS datetime,@GiftID int,@Gif' 需要参数 '@GiftStatus'，但未提供该参数。

注意： '(@OwnerUserID int,@BuddyUserID int,@TS datetime,@GiftID int,@Gif' 被截断，正好是 64 个符号......它只是以未完成的参数名称 'Gif' 结尾（例外是也关于这个参数）。

为什么它看不到我的参数？

UPD：如果我以这种方式重新添加最后一个参数（@GiftStatus）： command.Parameters.AddWithValue("@GiftStatus", (byte)GiftStatusEnum.wait);

这样事情就开始起作用了。但我就是不知道 .Add(new SqlParamter()); 有什么问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T13:34:08.537

您需要提供所有参数及其名称。
你最好用`Paramteres.AddWithValue(...)`. 所以：

```
Parameters.AddWithValue("@OwnerUserID", ...);
Parameters.AddWithValue("@BuddyUserID", ...);
Parameters.AddWithValue("@TS", ...);
Parameters.AddWithValue("@GiftID", ...);
Parameters.AddWithValue("@GiftStatus", ...); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T13:37:10.293

我认为您在 ExecuteScalar() 之前缺少以下命令

```
command.CommandText += "SELECT @@IDENTITY;";
command.CommandType = CommandType.Text;
result.GiftInstanceID = long.Parse(command.ExecuteScalar().ToString()); 
```

# sqlite - 它是什么时间戳？

> ID：10800201
> 
> 赞同：1
> 
> 时间：2012-05-29T13:31:39.253
> 
> 标签：sqlite, timestamp

它是什么时间戳？
41056.2752083333 是 2012 年 5 月 27 日 14:36 GMT+7
41056.2967361111 是 2012 年 5 月 27 日 15:07 GMT+7
它来自 sqlite3 数据库，取自 icq v.7

* * *

编辑

* * *

所以，谢谢你的回答。
这是将 icqv7 格式的时间戳转换为 Python 的 struct_time 的函数：

```
f = lambda x: time.localtime(x*86400-2208988800-172800+3600) 
```

其中 2208988800 是 1900 年 1 月 1 日到 1970 年 1 月 1 日之间的秒数，
172800 是两天内的秒数，
3600 是一小时。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T13:34:21.610

看起来这是自 1900 年 1 月 1 日午夜 UTC 以来的天数。

编辑：哎呀-看起来实际上已经两天了，这很奇怪。显然*是*天数，因为 41056.2752083333 和 41056.2967361111 之间的差异是 0.0215277778，当作为“天数”时是 31 分钟。

所以看起来你只需要稍微调整纪元 - 在 1899 年 12 月 30 日的纪元中，我得到了第一个值 2012-05-27T06:36:00Z 的日期/时间 - 那里还有一个小时的差异，但是我*怀疑*这可能是由于您诊断日期/时间的方式而不是其他任何原因。例如，您在 12 月有任何值吗？

# java - java.lang.ClassNotFoundException：org.netezza.Driver

> ID：10800202
> 
> 赞同：2
> 
> 时间：2012-05-29T13:31:40.163
> 
> 标签：java, netezza

我正在尝试使用 JDBC 驱动程序连接到 Netezza 数据库并执行简单的 SELECT 查询。我的项目（使用 Eclipse）的 lib 文件夹中有 nzjdbc.jar 文件，但出现以下错误。

```
 java.lang.ClassNotFoundException: org.netezza.Driver
 at java.net.URLClassLoader$1.run(Unknown Source)
 at java.net.URLClassLoader$1.run(Unknown Source)
 at java.security.AccessController.doPrivileged(Native Method)
 at java.net.URLClassLoader.findClass(Unknown Source)
 at java.lang.ClassLoader.loadClass(Unknown Source)
 at sun.misc.Launcher$AppClassLoader.loadClass(Unknown Source)
 at java.lang.ClassLoader.loadClass(Unknown Source)
 at java.lang.Class.forName0(Native Method)
 at java.lang.Class.forName(Unknown Source) 
```

这是我的代码：

```
 import java.sql.Connection;
 import java.sql.DriverManager;
 import java.sql.ResultSet;
 import java.sql.SQLException;
 import java.sql.Statement;
 public class Tests {

public static void main(String[] args) 
{
    String server = "myhost.com";
    String port = "5480";
    String dbName = "dbname";
    String url = "jdbc:netezza://" + server + "/" + dbName ;
    String user = "user";
    String pwd = "pwd";
    Connection conn = null;
    Statement st = null;
    ResultSet rs = null;
    try {
        Class.forName("org.netezza.Driver");
        System.out.println(" Connecting ... ");
        conn = DriverManager.getConnection(url, user, pwd);
        System.out.println(" Connected "+conn);

        String sql = "SELECT COUNT(*) FROM TABLE";
        st = conn.createStatement();
        rs = st.executeQuery(sql);
        if(rs.next()) {
            System.out.println(rs.getString(1));
        } else {
            System.out.println(" No data found");
        }
    } catch (Exception e) {
        e.printStackTrace();
    } finally {
        try {
            if( rs != null)
                rs.close();
            if( st!= null)
                st.close();
            if( conn != null)
                conn.close();
        } catch (SQLException e1) {
                e1.printStackTrace();
            }
    }

}

 } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T14:50:08.450

在 Eclipse 中，您需要将 jar 添加到“构建路径”中的库中

[Eclipse 文档](http://help.eclipse.org/galileo/index.jsp?topic=/org.eclipse.jdt.doc.user/reference/ref-properties-build-path.htm)

[教程](http://www.wikihow.com/Add-JARs-to-Project-Build-Paths-in-Eclipse-%28Java%29)

# excel - 更改日期 Excel 单元格

> ID：10800208
> 
> 赞同：0
> 
> 时间：2012-05-29T13:31:59.630
> 
> 标签：excel, excel-formula

我有一个日期单元格，其中包含一般的日期格式。我想用与其他单元格相同的格式更改其单元格，但问题是如果我更改它，那么它将改变其单元格的整个格式。

到目前为止，我尝试的是在其格式化单元格内的这个公式中

```
(mm/dd/yy hh:mm:ss) 
```

但我只想使用与其他格式相同的格式。谢谢

检查文件，请尝试更改值，任何帮助都会非常有帮助

[https://hotfile.com/dl/157148115/5ee7808/datesample.xlsx.html](https://hotfile.com/dl/157148115/5ee7808/datesample.xlsx.html)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T15:13:34.083

日期存储为文本
您可以使用`datevalue`并将`timevalue`数据转换为
A2 中的实际日期格式，输入`=DATEVALUE(A1)+TIMEVALUE(A1)`以获取您可以根据需要格式化的值

```
"05/02/2012 16:23:53"   41031.68325
"05/02/2012 16:23:53"   41031.68325
"05/04/2012 08:17:52"   41033.34574 
```

第 2 列中显示的值是日期/时间的 excel 表示形式 - 然后您可以根据需要设置这些格式，或进行计算以获取持续时间。

# android - 无法理解在设备之间传输数据，使用 cocos2d 游戏

> ID：10800211
> 
> 赞同：2
> 
> 时间：2012-05-29T13:32:05.433
> 
> 标签：android, bluetooth, cocos2d-android, game-development

我已经完成了安卓开发者的蓝牙聊天示例，现在我正在设计一个游戏，需要在设备之间传输坐标。我正在使用 cocos2d，现在如何通过蓝牙在其他设备上发送数据。我需要在这个游戏中应用蓝牙聊天应用程序，但是如何？我无法理解如何实现它。任何建议都非常感谢......如果你不明白我想问什么，请提出任何问题......

```
 public boolean ccTouchesEnded(MotionEvent event)
   {
    boolean get=false;
    //int y=0;
    // Choose one of the touches to work with
  CGPointlocation=CCDirector.sharedDirector().convertToGL(CGPoint.ccp(event.getX(),event.get;
    if(y==0)    
    {get=shootarrow(location);
    y=1;
    return get;}
    else if(y==1)
        {get=shootme(location);
        y=0;
        return get;
        }
    return get;
}

public boolean shootme(CGPoint loc){

    // Set up initial location of projectile
    CGSize winSize = CCDirector.sharedDirector().displaySize();
    CCSprite projectile = CCSprite.sprite("ah2.png");
    projectile.setPosition(CGPoint.ccp(650,180));

    CCSprite player2 = CCSprite.sprite("Ply2.png");
    player2.setPosition(CGPoint.ccp(winSize.width / 2.0f,320));

 // Determine offset of location to projectile
    int offX = (int)(loc.x - projectile.getPosition().x);
    int offY = (int)(loc.y - projectile.getPosition().y);
    if (offX >= 0)
        return true;
    if (offY <= -7)
        return true;
    addChild(projectile);
    addChild(player2);
    projectile.setTag(2);
    _projectiles.add(projectile);

    // Determine where we wish to shoot the projectile to
    int realX = (int)(-(winSize.width + (projectile.getContentSize().width / 2.0f)));
    float ratio = (float)offY / (float)offX;
    int realY = (int)((realX * ratio) + projectile.getPosition().y);
    CGPoint realDest = CGPoint.ccp(realX, realY);

 // Determine the length of how far we're shooting
    int offRealX = (int)(realX - projectile.getPosition().x);
    int offRealY = (int)(realY - projectile.getPosition().y);
    float length = (float)Math.sqrt((offRealX * offRealX) + (offRealY * offRealY));
    float velocity = 680.0f / 1.0f; // 480 pixels / 1 sec
    float realMoveDuration = length / velocity;

 // Move projectile to actual endpoint
    projectile.runAction(CCSequence.actions(
            CCMoveTo.action(realMoveDuration, realDest),
            CCCallFuncN.action(this, "spriteMoveFinished")));
    Context context = CCDirector.sharedDirector().getActivity();
    return true; 
```

}

# php - 如何使表单提交按钮也重定向到页面中的特定 div？

> ID：10800212
> 
> 赞同：0
> 
> 时间：2012-05-29T13:32:14.773
> 
> 标签：php, javascript, slider, anchor, contact-form

我正在做的网站由一个全屏滑块组成，有 4 个不同的面板。

第四个面板包含一个 php 联系表单。当我提交表单时，它会从第一个滑块重新加载页面，因此用户无法看到第四个面板中的结果（发送的消息或任何错误）以及表单。

有什么办法可以让提交按钮也重定向到包含表单的 div 吗？

这是基本标记，使用了 php 脚本：

```
<div id="container">

<div id="div1">
<div class="content">...</div>
</div>

<div id="div2">
<div class="content">...</div>
</div>

<div id="div3">
<div class="content">...</div>
</div>

<div id="div4">
<div class="content">
                <form method="post" action="index.php">

                    <label>Nom</label>
                    <input class="small" name="name" placeholder="Name">

                    <label>Email</label>
                    <input class="small" name="email" type="email" placeholder="Email">

                    <label>Message</label>
                    <textarea class="small" name="message" placeholder="Message"></textarea>

                    <label>What's the best burger ever (antispam)</label>
                    <input class="small" name="human" placeholder="type the right answer">

                    <input id="submit" name="submit" type="submit" value="send">

                </form>

<?php
    $name = $_POST['name'];
    $email = $_POST['email'];
    $message = $_POST['message'];
    $from = 'From: ...'; 
    $to = 'johndoe@gmail.com'; 
    $subject = 'New message';
    $human = $_POST['human'];

    $body = "From: $name\n E-Mail: $email\n Message:\n $message";

if ($_POST['submit']) {
    if ($name != '' && $email != '') {
        if ($human == 'bacon burger') {              
            if (mail ($to, $subject, $body, $from)) { 
            echo '<div class="alert green"><p>Message sent!</p></div>';
        } else { 
            echo '<div class="alert red"><p>An error occured. Go back and try again.</p></div>'; 
        } 
    } else if ($_POST['submit'] && $human != 'bacon burger') {
        echo '<div class="alert red"><p>You answered wrong to the antispam question.</p></div>';
    }
    } else {
        echo '<div class="alert red"><p>You have to fill in all fields !</p></div>';
    }
}
?>

</div>
</div>

</div> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-29T13:35:29.953

尝试将锚 id 添加到`action`url：

```
<form method="post" action="index.php#div4"> 
```

# asp.net-mvc-4 - 除了影响 global.asax 中的捆绑之外，还有什么方法可以在 razor 页面上手动添加脚本和 css？

> ID：10800213
> 
> 赞同：0
> 
> 时间：2012-05-29T13:32:15.833
> 
> 标签：asp.net-mvc-4

创建 mvc3 时，我将其中之一放在我的 _layout.cshtml 页面上......

```
@Html.RenderCss()
@Html.RenderScript() 
```

然后在我继承的剃须刀页面中，我这样做了......

```
@Html.RegisterScript("~/Content/scripts/myscript.js") 
```

现在有没有一种自动的方法来使用优化 dll 来做到这一点。我真的不想一直捆绑文件夹中的所有内容。我也喜欢它自动缩小文件。不确定我是否错过了这个捆绑功能的要点，但我只想动态添加文件，然后让它们在页面上的同一个位置呈现出来......

谢谢...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T13:43:35.660

我对捆绑功能的理解是，它仍然是预发布的并且有些错误，它旨在组合并缩小项目中可能需要的所有 CSS 或 JS 文件。然后它使用版本控制机制，以便客户端获得完整的浏览器缓存体验。

例如，如果我有 3 个 CSS 文件（Reset.css、Global.css 和 Site.css），这些文件都是在第一次访问我的网站时下载的，它们会被合并并缩小，因此文件大小非常小。url 包含一个特殊的哈希数/查询字符串。只要我不更改缓存副本的内容，缓存副本就会保留在客户端上，直到它过期或他们清除临时文件。当我进行更改时，旧版本将被丢弃并创建新哈希。当客户端再次访问时，他们的文件现在无效，它会重新下载新文件。

我个人没有尝试创建特定的捆绑包，但通过搜索我发现有人创建了自定义捆绑包，我认为这可能与您想要完成的目标一致：http: [//www.codeproject.com/Tips /389545/ASP-NET-MVC4-捆绑和缩小](http://www.codeproject.com/Tips/389545/ASP-NET-MVC4-Bundling-and-Minification)

# css - CSS 相对定位和填充

> ID：10800220
> 
> 赞同：0
> 
> 时间：2012-05-29T13:32:33.140
> 
> 标签：css

几个小时后，我设法找到了解决问题的方法，所以问题不是“如何”，而是“为什么会这样”。这是我的精简示例：

```
<div id="header">
    <div id="header-element">header</div>
</div>
<div id="footer">footer</div>​ 
```

CSS：

```
#header {
    width: 100%;
    position: relative;
    padding-bottom: 5%;
}
#header-element {
    position:absolute;
    bottom: 0;
}
#footer {
    position: relative;
    margin-top: 5%;
}​ 
```

和 jsFiddle - [http://jsfiddle.net/H7jwm/3/](http://jsfiddle.net/H7jwm/3/)。

我的问题是如何使用百分比来定位那些相对定位的元素，第一个元素位于文档顶部的某个位置，第二个元素位于第一个元素的位置。我已经通过给予`padding-bottom`第一个和`margin-top`第二个来实现这一点，但我必须用蛮力解决 - 尝试每一个远程逻辑解决方案。现在，如果您删除填充，`margin-top`则第二个元素的边距成为该元素与文档顶部之间的边距，而不是第一个元素，并且该第一个元素将剩余空间“占用”到顶部。

问题是为什么填充会这样工作？或者，换个说法，填充如何与相对定位一起工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T13:42:44.457

实际上，您正在混合职位。你`#header`的高度为零。没错，零就像什么都没有，因为它没有相对的内容。`#header-element`是绝对定位`#header`的，因为高度为 0，它恰好位于 padding-bottom 空间中。

因此，如果您从 中删除 padding-bottom，则从`#header`文档`#footer`顶部开始向上移动。由于margin-top，文档顶部边框和单词“footer”之间有一些空间。

但是您仍然拥有绝对定位`#header-element`的 ，它现在就在那个边缘顶部空间中。

# git - 使用 npm 和 git 的最佳方式？

> ID：10800223
> 
> 赞同：1
> 
> 时间：2012-05-29T13:32:53.373
> 
> 标签：git, version-control, npm

我对 git 和 npm 都很陌生，但我了解基础知识，至少我认为我了解。
无论如何，我将描述我正在考虑的工作方式，但我认为还有更好的方法可以做。

*   我用我的 node.js 模块创建了根文件夹。
*   我添加 package.json 文件并配置名称和版本。
*   `git init`在这个根文件夹中。
*   然后`git add .`将所有文件添加到源代码管理中。
*   提交它。这将是我的 0.0.1 版本。我不知道如何在 git 中设置它。
*   `npm publish`
*   这就是第一个周期的全部内容。

现在进行下一个小改动，而不是版本：

*   我换一个文件。
*   我将 package.json 中的版本更改为 0.0.2。
*   我`git commit`。
*   完毕。
*   其他小改动也一样，但不要更改版本。

现在进行下一个版本更改：

*   我更改文件
*   我将版本更改为下一个。
*   我 git 提交。

我需要 npm 版本和 git 版本之间的一些参考。怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T14:51:35.970

最佳做法是添加

```
node_modules/* 
```

到`.gitignore`:)

git 是源代码控制系统，npm 是包管理，忽略您使用的本机包之类的东西，这就是所有所有恢复或“真实”代码都必须转到模块。另外，如果您有任何配置文件，例如`database.json`将 thme 放入忽略并放入 repo 示例中，例如`database.json.sample`

就是这样！:>

只有在提交和功能更改很少时才更改 npm 包版本 :) 所以它是排他的。

# html - android webview的Html5缓存问题

> ID：10800224
> 
> 赞同：0
> 
> 时间：2012-05-29T13:32:56.747
> 
> 标签：html, webview, android-webview, html5-appcache, android-websettings

您好，我试图用我的 android 设备缓存我的 web 应用程序。我尝试了一切，但没有任何效果。缓存不会只在安卓设备上刷新，在其他设备上不会刷新！您可以在下面看到我为缓存 Web 应用程序所做的所有设置。

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    web = (WebView) findViewById(R.id.webview);
    web.setWebViewClient(new myWebClient());
    web.getSettings().setJavaScriptEnabled(true);

    web.getSettings().setCacheMode(web.getSettings().LOAD_NORMAL);
    web.setScrollBarStyle(WebView.SCROLLBARS_OUTSIDE_OVERLAY);
    web.getSettings().setUserAgentString(getString(R.string.user_agent_suffix));   

    web.getSettings().setAppCachePath("http://192.168.0.62/lastversion/cache.manifest");
    web.getSettings().setAllowFileAccess(true);
    web.getSettings().setAppCacheEnabled(true);
    web.getSettings().setDomStorageEnabled(true);
    web.loadUrl("http://192.168.0.62/lastversion/");

} 
```

在这里我设置了我的缓存：

```
<html manifest="cache.manifest"> 
```

我希望有一个人可以帮助我。谢谢

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-07-27T08:19:12.250

web.getSettings().setAppCachePath() 设置存储缓存文件的本地目录，而不是加载清单的位置。

清单必须在您要缓存的 HTML 文件中引用：

```
 <html manifest="cache.manifest"> 
```

* * *

你是什​​么意思：“缓存不会只在android设备上刷新，在其他设备上不会刷新！” 仅当清单的内容发生更改时，才会更新缓存的文件。
[http://appcachefacts.info/](http://appcachefacts.info/)
[http://jonathanstark.com/blog/2009/09/27/debugging-html-5-offline-application-cache/](http://jonathanstark.com/blog/2009/09/27/debugging-html-5-offline-application-cache/)
[http://dev.opera.com/articles/view/离线应用程序-html5-appcache/](http://dev.opera.com/articles/view/offline-applications-html5-appcache/)

# java - 在 Windows 机器上使用 java 运行时类触发命令

> ID：10800226
> 
> 赞同：1
> 
> 时间：2012-05-29T13:32:58.527
> 
> 标签：java, windows, runtime.exec

我正在尝试在 Windows 上触发以下命令（这是我们购买的产品的一部分）：

`start /wait setup /z"/sfC:\temp\input_file.txt" /s /f2"C:\temp\newlogfile.log"`

现在可悲的是，我无法使用我编写的 java 程序运行命令。（我必须将它作为其他东西的一部分运行，因此需要通过 java 运行它）

这是我的代码：

```
String[] cmd = new String [6];

cmd[0] = "start";
cmd[1] = "/wait";
cmd[2] = "setup";
cmd[3] = "/z\"/sfC:\\temp\\input_file.txt\"";
cmd[4] = "/s";
cmd[5] = "/f2\"C:\\temp\\newlogfile.log\"";

try
{
    Runtime.getRuntime().exec(cmd);
}                               
catch(IOException e)    
{   
    e.printStackTrace();
} 
```

请告诉我我在这里做错了什么。这是我得到的输出：

`java.io.IOException: CreateProcess: start /wait setup /z"/sfC:\temp\input_file.txt" /s /f2"C:\temp\newlogfile.log" error=2 at java.lang.ProcessImpl.create(Native Method) at java.lang.ProcessImpl.<init>(ProcessImpl.java:108) at java.lang.ProcessImpl.start(ProcessImpl.java:56) at java.lang.ProcessBuilder.start(ProcessBuilder.java:466) at java.lang.Runtime.exec(Runtime.java:607) at java.lang.Runtime.exec(Runtime.java:480) at SilentAgent.fireCommand(SilentAgent.java:316) at mainClass.main(mainClass.java:15)`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T14:04:07.073

试试这个：

```
String[] cmd = { 
    "cmd.exe", 
    "/c", 
    "start", 
    "/wait", 
    "setup",
    "/z\"/sfC:\\temp\\input_file.txt\"", 
    "/s",
    "/f2\"C:\\temp\\newlogfile.log\"" 
};

Runtime.getRuntime().exec(cmd); 
```

原因：`start`是一个只能从`cmd`shell 内部获得的内部命令。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T13:46:33.507

这样做： -

```
Runtime.getRuntime().exec(new String[] {
    "start ",
    "/wait ",
    "setup ",
    "/z\"/sfC:/temp/input_file.txt\" ",
    "/s ",
    "/f2\"C:/temp/newlogfile.log\""}); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-05-29T13:49:02.497

您确定您的 java 程序位于“启动”程序的同一目录中吗？

如果不是，则将命令字符串作为整个字符串传递

```
try { 
    String command = "start /wait setup /z\"/sfC:\\temp\\input_file.txt\" /s /f2\"C:\\temp\\newlogfile.log\"";
    // The third parameter is the current working directory 
    Process p = runtime.exec(c, null, new File());
} catch (Exception e) { 
        e.printStackTrace();
} 
```

# actionscript-3 - 使用未知处理程序删除或覆盖 eventListener

> ID：10800235
> 
> 赞同：0
> 
> 时间：2012-05-29T13:33:41.133
> 
> 标签：actionscript-3, flash

有没有办法用未知的处理程序删除或覆盖 eventListener？我只是通过设置一个新的 addEventListener 来做到这一点。这个原始处理程序打开一个 url。但我想用一个打开另一个 url 的新处理程序来覆盖它。这在 Chrome 和 Safari 中运行良好。但在 IE 中，这会导致多个新窗口。

# android - 如何根据名称获取int值

> ID：10800236
> 
> 赞同：0
> 
> 时间：2012-05-29T13:33:54.810
> 
> 标签：android, string, int

我想问我怎样才能得到预定义值的值到它的名字

以下是我的代码

```
public class Calculation_Activity extends Activity{

int a=1;
int b=2;
int c=50;
int result;
String array1[]=new String[]{"a","b","c"};

} 
```

请问如何使用array1[i]获取字符串的值？

例如，我想使用 array1[3] 来调用 c[ie.50] 的值

你能就这件事给我一些建议吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-29T13:38:05.540

您可以通过使用 a[`Map`](http://docs.oracle.com/javase/7/docs/api/java/util/Map.html)及其标准实现来解决您的问题[`HashMap`](http://docs.oracle.com/javase/7/docs/api/java/util/HashMap.html)：

```
Map<String, Integer> values = new HashMap<String, Integer>();
values.put("a",1);
values.put("b",2);
values.put("c",50);

String array1[] = new String[] {"a","b","c"};

int result = values.get(array1[2]); //result = 50
// or
int result = values.get("c"); //result = 50 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T13:39:11.330

您可以使用 HashMap (http://docs.oracle.com/javase/6/docs/api/java/util/HashMap.html)，它是一个类似字典的数据结构，您可以在其中存储密钥对值

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-29T13:37:28.690

您要实现的目标将更适合动态/脚本语言。您是否考虑过使用 Map 而不是多个变量？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-29T13:37:53.137

在 Java 中，这不是一种常见的方法，例如在脚本语言中。您可以尝试使用 Map （即[HashMap](http://developer.android.com/reference/java/util/HashMap.html)），这将使您能够实现您想要的东西。

事实上，我认为在 Java 中使用反射完全可以做你想做的事，但我不会去那里！

# redis - 如何使用redis计算uniq用户？

> ID：10800238
> 
> 赞同：1
> 
> 时间：2012-05-29T13:33:58.163
> 
> 标签：redis

我在日志文件中有 2 个参数：

```
timestamp, ip. 
```

例如，计算每分钟 uniq ip 数量的最佳方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T13:37:54.490

看看这篇优秀的博客文章，它为您的问题提出了解决方案：

[http://chris6f.com/rate-limiting-with-redis](http://chris6f.com/rate-limiting-with-redis)

# extjs4 - 面板中的 ExtJS 切换按钮折叠后消失，无法展开回来

> ID：10800239
> 
> 赞同：2
> 
> 时间：2012-05-29T13:33:59.660
> 
> 标签：extjs4

我在选项卡面板中有一个 Ext.panel.Panel。选项卡面板再次位于窗口内。我为 Ext.panel.Panel 设置了以下配置

```
border : false,
collapsible : true,
collapseDirection : 'left',
width : 300,

layout : {
 type : 'vbox',
 align : 'stretch'
}, 
```

单击 Ext.panel.Panel 中的切换按钮时，它会折叠，但切换按钮会消失，这不允许我再次展开折叠的面板。在调整窗口大小时，切换按钮会重新出现。

非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T17:42:52.397

试试这个线程中给出的解决方案，[http://www.sencha.com/forum/showthread.php](http://www.sencha.com/forum/showthread.php?175371-Panel-Disappears-When-Collapsed) ?175371-Panel-Disappears-When-Collapsed 。

> 主要问题是您没有为充当中心区域的面板声明布局。

这个线程似乎也建议了这一点[http://www.sencha.com/forum/showthread.php?149446-Rendering-panel-collapsed-makes-it-disappear](http://www.sencha.com/forum/showthread.php?149446-Rendering-panel-collapsed-makes-it-disappear)。

# .net - .NET 错误：实例化泛型方法的 ldtoken

> ID：10800240
> 
> 赞同：3
> 
> 时间：2012-05-29T13:34:02.147
> 
> 标签：.net, generics, cil

我试图让`ldtoken`IL 方法在泛型类中加载泛型方法的泛型实例化（例如，`List.ConvertAll<TOutput>`）：

```
ldtoken method instance
    class [mscorlib]System.Collections.Generic.List`1<!!0> 
    [mscorlib]System.Collections.Generic.List`1::ConvertAll<string>(
        class [mscorlib]System.Converter`2<!0,!!0>) 
```

这会导致异常：

> 未处理的异常：System.TypeLoadException：无法从程序集“TestAssembly，Version=0.0.0.0，Culture=neutral，PublicKeyToken=null”加载类型“System.Collections.Generic.List`1”。

它正在我的测试程序集中寻找`System.Collections.Generic.List`，即使它已在`mscorlib`!中明确声明。

但是，加载未实例化的方法令牌有效：

```
ldtoken method instance
    class [mscorlib]System.Collections.Generic.List`1<!!0> 
    [mscorlib]System.Collections.Generic.List`1::ConvertAll<[1]>(
        class [mscorlib]System.Converter`2<!0,!!0>) 
```

非泛型类中的泛型方法有效：

```
ldtoken method void [mscorlib]System.Array::Sort<object>(!!0[])
ldtoken method void [mscorlib]System.Array::Sort<[1]>(!!0[]) 
```

这是怎么回事？这是 .NET 中的错误吗？（我已经在 v2 和 v4 CLR 上复制了它）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T21:27:20.540

正如我在评论中提到的，我认为您需要实例化泛型类型（即没有诸如`System.Collections.Generic.List`1`- just`System.Collections.Generic.List`1<object>`等这样的类型）。

通过使用 System.Reflection.Emit，看起来可以在实例化的泛型类型上使用带有实例化或未实例化方法的 ldtoken：

```
ldtoken 方法实例
    类 [mscorlib]System.Collections.Generic.List`1<!!0>
    类 [mscorlib]System.Collections.Generic.List`1<object>::ConvertAll<[1]>(
        类 [mscorlib]System.Converter`2<!0,!!0>)
ldtoken 方法实例
    类 [mscorlib]System.Collections.Generic.List`1<!!0>
    类 [mscorlib]System.Collections.Generic.List`1<object>::ConvertAll<string>(
        类 [mscorlib]System.Converter`2<!0,!!0>)

```

但不适用于未实例化的泛型类型。ECMA CLI 规范的第 II 部分第 9.4 节指出

> CLI 不支持泛型类型的部分实例化。并且泛型类型不应在元数据签名 blob 中的任何位置出现未经实例化。

所以也许这并不奇怪——似乎没有任何方法可以将 ldtoken 与`typeof(List<>).GetMethod("ConvertAll")`.

# google-app-engine - 部署到 appengine 时出现 freebase api 错误：DownloadError: ApplicationError: 2

> ID：10800245
> 
> 赞同：0
> 
> 时间：2012-05-29T13:34:15.297
> 
> 标签：google-app-engine, gwt, freebase, api-key

我正在使用 google.appengine.api urlfetch 来执行以下 freebase MQL 查询：

```
https://api.freebase.com/api/service/mqlread?queries={"q1": {"query": [{"subjects": [{"name|=": ["doubt","trust"]}], "type": "/media_common/quotation", "name": null, "author": []}]}} 
```

这在我的本地设置上按预期工作。部署到 Google AppEngine 后，我收到以下错误：

```
File "/base/python_runtime/python_lib/versions/1/google/appengine/api/urlfetch.py", line 263, in fetch
return rpc.get_result()
File "/base/python_runtime/python_lib/versions/1/google/appengine/api/apiproxy_stub_map.py", line 604, in get_result
return self.__get_result_hook(self)
File "/base/python_runtime/python_lib/versions/1/google/appengine/api/urlfetch.py", line 365, in _get_fetch_result
raise DownloadError(str(err))
DownloadError: ApplicationError: 2 
```

从我的谷歌搜索看来，freebase 可能会阻止来自 appengine 的请求。我曾尝试使用[http://wiki.freebase.com/wiki/Google_API_Client_Libraries#Python](http://wiki.freebase.com/wiki/Google_API_Client_Libraries#Python)并获得相同的结果。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T13:41:05.493

尝试使用 Freebase API 密钥。这可能会有所帮助。

# c# - 在 Viewmodel 中接收 RaisePropertyChanged (MVVM Light)

> ID：10800247
> 
> 赞同：3
> 
> 时间：2012-05-29T13:34:20.960
> 
> 标签：c#, wpf, mvvm, mvvm-light

我得到了这个数据结构：

12 个测量，每个测量包含 1-x 个单元，每个单元包含 1-x 个站。每次测量的细胞/站数量相同。

因此我有一个测量、一个单元和一个站类。这三个中的每一个都实现了`ObservableObject`该类。

在我的视图中，我为每个测量创建一个 Itemscontrol 以显示测量的所有单元格。每个项目都包含一个项目控件，用于在文本框中显示所有站。

现在我需要第 13 次测量，在其中计算所有测量中每个站的总和。（*来自所有 12 次测量的单元 1 中的站 1*）。

目前我的 Viewmodel 只包含一个带有 12 个基本测量的 Observable 集合。

如何检测 Station-Textbox 的值是否已更改以及已更改的 Station？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T13:42:39.403

如果您希望 UI 不仅在从集合中添加/删除项目时刷新，而且在项目引发[PropertyChanged](http://msdn.microsoft.com/en-us/library/system.componentmodel.inotifypropertychanged.propertychanged.aspx)时刷新，请使用[BindingList](http://msdn.microsoft.com/en-us/library/ms132679.aspx)而不是[ObservableCollection](http://msdn.microsoft.com/en-us/library/ms668604.aspx)。
它将引发[ListChanged](http://msdn.microsoft.com/en-us/library/ms132742.aspx)事件，您可以收听该事件以获取更多信息。

除非您想要一些 .Net 事件地狱，否则不要直接收听 PropertyChanged。

高温下，

呸。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T13:39:28.110

您可以锁定[`PropertyChanged`](http://msdn.microsoft.com/en-us/magazine/dd419663.aspx#id0090051)ViewModel 中每个 Station 的事件。这是一个事件处理程序，`ObservableObject`只要修改属性（*接口**的一部分[`INotifyPropertyChanged`](http://msdn.microsoft.com/en-us/library/system.componentmodel.inotifypropertychanged.aspx)*）就会触发。

# c# - WebClient 异常，不支持并发 I/O 操作

> ID：10800253
> 
> 赞同：2
> 
> 时间：2012-05-29T13:34:51.560
> 
> 标签：c#, .net, file-io, webclient, stack-trace

我有一个静态类，它返回 webclient 的新实例

```
public static class WebAccess
{
    public static WebClient GetWebClient()
    {
        return new WebClient();
    }
} 
```

然后我用这个类来点击这样的页面

```
WebAccess.GetWebClient().DownloadString(new Uri("http://" + WLCDomainUrl + ConfigurationManager.AppSettings["urlClearCache"].ToString() + "/?id=" + Request.QueryString["id"] + "&Type=RC")); 
```

我不想赶上回应

但它大部分时间都在抛出异常

```
WebClient does not support concurrent I/O operations.

Stack Trace:

   at System.Net.WebClient.ClearWebClientState()
   at System.Net.WebClient.DownloadString(Uri address)
   at UpdateCache.ProcessLocationCacheRequest(String locId, Boolean isChain) in 

WebClient does not support concurrent I/O operations.

Stack Trace:

   at System.Net.WebClient.ClearWebClientState()
   at System.Net.WebClient.UploadString(Uri address, String method, String data)
   at System.Net.WebClient.UploadString(String address, String data)
   at CacheClassLibrary.ServerClass.APIServer.Create(String Id, String MobileWLCUrl) in 
```

有什么帮助吗？？我无法理解它，因为我正在使用新的 Web 客户端实例为每个请求提供服务：/

应用程序同时收到多个请求。

* * *

## 回答 #1

> 赞同：-5
> 
> 时间：2012-05-29T13:57:25.650

尝试这个

```
public static class WebAccess
{
    WebClient instance;
    public static WebClient GetWebClient()
    {
        if (instance == null)
           instance = new WebClient();

        return instance;
    }
} 
```

那么你只有一个 WebClient 类的实例

# c# - 如何使用任何程序集版本

> ID：10800255
> 
> 赞同：0
> 
> 时间：2012-05-29T13:34:57.350
> 
> 标签：c#, assemblies

我的应用程序引用了一个版本增加很多的程序集。

我可以在我的 Visual Studio 引用中设置“特定版本”，`false`这样我就不会遇到任何构建问题，但我需要能够在运行时使用任何版本。

据我所知，我有两个选择：

1.  要求 dll 的发布者使用 Publisher Policy File 并采用[Assembly Binding Redirection](http://msdn.microsoft.com/en-us/library/2fc472t2%28v=vs.90%29.aspx)。

2.  使用动态加载程序集`Reflection`。

现在，使用选项 1，组装供应商有可能无法被说服使用这种技术。由于此程序集的发布数量，供应商将在其配置中进行大量重定向，因此我会先发制人。

使用选项 2，我不想在这种情况下使用反射，因为我想保持 VS Intellisense 带来的灵活性和易用性。

所以，我的问题是：是否有第三种选择，或者我对前两种选择的担忧没有实际意义？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T14:14:41.420

选项 2a：仅在发布版本中使用反射加载它。如果由于版本控制冲突而失败，则覆盖 AssemblyResolve 事件并手动加载程序集。

选项 3：不要更改版本号。（如果你想要一个内部版本号，把它放在程序集信息的不同字段中，这样你就可以区分不同的版本，但如果公开的 API 没有改变，不要认为它是一个新版本）

# yii - 如何删除 Yii 中的行？

> ID：10800256
> 
> 赞同：11
> 
> 时间：2012-05-29T13:35:01.767
> 
> 标签：yii, delete-row

使用 Yii，我想删除所有不是从今天开始的行。

我的解决方案好吗？

```
$query = "delete from `user_login_hash` where `day`!='".(date('Y-m-d',time()))."'";

Yii::app()->db->createCommand($query); 
```

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2012-05-29T13:38:23.527

一个更漂亮的解决方案是

```
YourUserModel::model()->deleteAll("day !='" . date('Y-m-d') . "'"); 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-05-29T18:30:28.867

更好的用户 PDO 参数和命令，您还必须调用`execute`

```
$query = "delete from `user_login_hash` where `day`<> :date";
$command = Yii::app()->db->createCommand($query);
$command->execute(array('date' => date('Y-m-d'))); 
```

或者

```
UserLoginHash::model()->deleteAll(
    'day <> :date',
    array('date' => date('Y-m-d'))
); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-29T13:43:03.177

尝试这个...

```
 $query = "delete from `user_login_hash` where `day`!='".(date('Y-m-d',time()))."'";
                        $query->queryAll($query); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-05-20T12:08:00.727

您可以使用查询生成器

```
$command = Yii::app()->db->createCommand()
    ->delete('user_login_hash', 'day !=' . date('Y-m-d')); 
```

[http://www.yiiframework.com/doc/guide/1.1/en/database.query-builder#sec-15](http://www.yiiframework.com/doc/guide/1.1/en/database.query-builder#sec-15)

# delegates - 如何在不旋转设备的情况下从拆分视 图控制器获取条形按钮项？

> ID：10800262
> 
> 赞同：0
> 
> 时间：2012-05-29T13:35:14.047
> 
> 标签：delegates, uisplitviewcontroller, uibarbuttonitem

我正在使用 iOS 5.1 进行开发，并且对 UISplitViewControllerDelegate 中的这些方法非常满意

```
splitViewController:willHideViewController:withBarButtonItem:forPopoverController
splitViewController:willShowViewController:invalidatingBarButtonItem: 
```

但是，现在我注意到这两种方法只会在设备旋转时才会调用，因此方向会发生变化。我想要做的是将我的详细视图控制器转移（替换转移）到另一个。在新的详细视图控制器中，即使在横向中，我也会始终隐藏主视图控制器，因此我需要按钮。

如果没有调用这两种方法的委托，我怎样才能获得按钮？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T18:29:06.967

如果您即使在横向中也隐藏了主视图控制器（通过拆分视图控制器委托），`splitViewController:willHideViewController:withBarButtonItem:forPopoverController:`则会调用 ，因此您可以安全地将代码放在那里。

# c# - Windows DPI 设置影响 Graphics.DrawString

> ID：10800264
> 
> 赞同：5
> 
> 时间：2012-05-29T13:35:18.953
> 
> 标签：c#, gdi+, dpi, drawstring

我创建了一个新的位图对象，现在想使用 GDI+ 向它绘制一些文本。所以我调用 Graphics.DrawString(...)。

问题是字符串的大小取决于 Windows 7 的 DPI 设置。有什么方法可以让我的文本绘图独立于 Windows 设置？

PS：DPI 设置似乎只影响文本。例如，在更改 DPI 时，矩形的大小相同......

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-29T13:41:20.963

自己刚找到解决办法：关键是用参数GraphicsUnit.Pixel创建字体。这样，绘制字符串就可以独立于系统的 DPI 设置。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-29T13:48:33.630

您是正确的，因为 DPI 仅影响以与设备无关的单位测量的可绘制项目。字体通常以磅为单位，其中 1 磅 = 1/72 英寸。因此，10pt 字体在每个屏幕分辨率上的英寸大小都是相同的，并且会根据屏幕分辨率和像素密度占用或多或少的像素。

以像素为单位测量的所有内容（例如线条、形状等）都不会受到 DPI 的影响，但实际物理尺寸会因屏幕分辨率和像素密度而异。更改以像素为单位测量字体的代码确实可以确保文本在所有屏幕 DPI 设置上的像素大小相同，但如果您要打印到打印机，您会发现文本大小会因打印机分辨率而异。

# linq-to-xml - 使用 linq 更新 XML 节点属性

> ID：10800266
> 
> 赞同：1
> 
> 时间：2012-05-29T13:35:19.630
> 
> 标签：linq-to-xml

我有一个 xml 模板，用于将值存储到数据库中（通过 Web 服务）。我已经看到了如何使用 linq 更新 xml 字符串的示例。例如...

```
<Contacts>
    <Contact>
        <FirstName>Petar</FirstName>
        <LastName>Petrovic</LastName>
        <Email>p.petar@someemail.com</Email>
        <Address>Pere Perica 10</Address>
        <ZipCode>1000</ZipCode>
        <City>Belgrade</City>
        <State>Serbia</State>
    </Contact>
</Contacts> 
```

如果这是您想要更新的 xml 文档，您只需做一些事情

```
XElement xmlDoc = new XElement("Contacts", 
                  from c in db.Contacts
                  orderby c.ContactID
                  select new XElement("Contact",
                         new XElement("ContactID", c.ContactID),
                         new XElement("FirstName", c.FirstName),
                         new XElement("LastName", c.LastName)));
xmlDoc.Save(Server.MapPath(@"~/export.xml")); 
```

这很酷。但我需要更新除属性外基本相同的节点。例如...

```
<?xml version="1.0" encoding="utf-8"?>
<dataTemplateSpecification id="id1" name="name1">
  <description>
    <html>text</html>
  </description>
  <templates>
    <template>
      <elements>
        <element id="element0" name="PatientId" display="Patient ID" dataType="String"  visable="true" readOnly="false">
        </element>
        <element id="element1" name="EMPIID" display="EMPI ID" dataType="String" visable="true" readOnly="true">
        </element>
      </elements>
      <dataTypeSpecifications>
        <dataTypeSpecification id="" baseType="KeyValuePair">
          <dictionaryDefinition>
            <item key="-1" value="-SELECT-" />
            <item key="1" value="YES" />
            <item key="0" value="NO" />
          </dictionaryDefinition>
        </dataTypeSpecification>
      </dataTypeSpecifications> 
```

你看，我有类似的节点，它们的属性不同，即名称属性......以及值属性......我将如何使用 linq 来更新它？我在想我会使用一种 xPath 类型的东西选择一个新的 Xelement，我会按名称选择元素，然后设置该值？但我对如何做到这一点有点困惑。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T18:15:34.547

正如您所建议的，您可以按名称选择一个元素（属性），并分配一个新值。我用这个改变了你的第一个元素。

```
 var xml = XElement.Load("XMLFile1.xml");

        var node = xml.Descendants("element").Where(e => e.Attribute("id").Value == "element0").FirstOrDefault();
        if (node != null)
        {
            node.Attribute("name").Value = "something else";
        } 
```

# javascript - facebook评论-不让我缓和

> ID：10800267
> 
> 赞同：0
> 
> 时间：2012-05-29T13:35:19.333
> 
> 标签：javascript, facebook, drupal, facebook-comments

我正在尝试在我的页面上安装 facebook 评论，但它不允许我调节。在只有评论插件的测试页面上 - 没问题。完全相同的代码在实时页面上 - 不让我调节。

测试页面： [http ://www.radicalislam.org/test3.html](http://www.radicalislam.org/test3.html)

实时页面： [http ://www.radicalislam.org/news/pakistan-hands-huge-prison-sentence-bin-laden-informant](http://www.radicalislam.org/news/pakistan-hands-huge-prison-sentence-bin-laden-informant)

尝试调试，它显示了正确的管理员和应用程序 ID。

这是一个drupal站点，如果它很重要的话

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T16:00:56.983

看起来您正在为 href 使用部分 URL。使用完整的。

请改用以下内容。

`<div class="fb-comments" href="http://www.radicalislam.org/news/pakistan-hands-huge-prison-sentence-bin-laden-informant" data-num-posts="5" data-width="580"></div>`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T15:52:51.500

您是否尝试过使用调试工具（作为管理员）抓取页面？ [http://developers.facebook.com/tools/debug/og/object?q=http%3A%2F%2Fwww.radicalislam.org%2Ftest3.html](http://developers.facebook.com/tools/debug/og/object?q=http%3A%2F%2Fwww.radicalislam.org%2Ftest3.html)

这将读取更新的管理员 ID，并让管理员通过[https://developers.facebook.com/tools/comments在插件中查看审核面板](https://developers.facebook.com/tools/comments)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-29T14:54:42.320

不幸的是，我的工作防火墙不允许我点击链接。

当您将 Facebook 评论添加到页面时，您是否使用了正确的 URL？如果不是，您将无法进行审核，您可能需要将 URL 动态添加到生成的代码中。

# android - Android使用FileEntity而不使用MultipartEntity将文件上传到服务器

> ID：10800277
> 
> 赞同：0
> 
> 时间：2012-05-29T13:35:51.687
> 
> 标签：android, file-upload

嗨，我需要将文件发送到服务器我使用此代码

```
public void PostFile() {

        HttpClient httpclient = new DefaultHttpClient();
        httpclient.getParams().setBooleanParameter(CoreProtocolPNames.USE_EXPECT_CONTINUE, false);
        // httpclient.
        HttpPost httppost = new HttpPost("http://fastcalc.orionsource.ru/test.php");

        File file = cache.getFileFromCache("citys.json");

        FileEntity reqEntity = new FileEntity(file,"text/plain");
        reqEntity.setContentType("text/plain");
        httppost.setEntity(reqEntity);

        System.out.println("executing request " + httppost.getRequestLine());

        HttpResponse response;
        try {
            response = httpclient.execute(httppost);
            HttpEntity resEntity = response.getEntity();

            System.out.println(response.getStatusLine());
            if (resEntity != null) {
                System.out.println(EntityUtils.toString(resEntity));
            }
            if (resEntity != null) {
                resEntity.consumeContent();
            }

        } catch (ClientProtocolException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }

        httpclient.getConnectionManager().shutdown();
    } 
```

在下面的服务器端代码

```
<?php
print 'Files:';
print_r($_FILES);
print '<br><br>';
print "Response:\n";
print_r($_REQUEST);
print '<br><br>';

?> 
```

在Android上我得到回应

```
05-29 17:26:29.232: I/System.out(26823): executing request POST http://fastcalc.orionsource.ru/test.php HTTP/1.1
05-29 17:26:29.732: I/System.out(26823): HTTP/1.1 200 OK
05-29 17:26:29.732: I/System.out(26823): Files:Array
05-29 17:26:29.732: I/System.out(26823): (
05-29 17:26:29.732: I/System.out(26823): )
05-29 17:26:29.732: I/System.out(26823): <br><br>Response:
05-29 17:26:29.732: I/System.out(26823): Array
05-29 17:26:29.732: I/System.out(26823): (
05-29 17:26:29.732: I/System.out(26823): )
05-29 17:26:29.732: I/System.out(26823): <br><br> 
```

我不能使用 MultipartEntity，因为它不包含在任何 Android 版本中。它的第三方库。

有人给请链接到仅使用 FileEntity 的教程。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T13:41:31.533

嗨，我尝试使用图像文件在服务器上发送。您可以做一件事将文件转换为 base64 字符串并将其发送到服务器，然后从服务器端尝试将 base64 转换为文件

作为参考如何转换为 base64 我的答案：[如何将 ImageView 中的图像发送到 php 服务器？](https://stackoverflow.com/questions/10681901/how-to-send-the-image-in-an-imageview-to-a-php-server/10682148#10682148)

# c# - 在域驱动的应用程序中，集合过滤逻辑应该放在哪里？

> ID：10800279
> 
> 赞同：4
> 
> 时间：2012-05-29T13:36:04.913
> 
> 标签：c#, domain-driven-design

我有以下基本实体：

```
public class Basket
{
    public List<Product> Products {get;set;}
}

public class Product
{
    public string Name {get;set;}
    public decimal Price {get;set;}
} 
```

我想得到一个篮子里所有低于固定价格的产品的清单。如果这个逻辑进入`Basket`，像这样：

```
public class Basket
{
    public List<Product> Products {get;set;}
    public List<Product> CheapProducts
    {
        get { return Products.Where(p => p.Price < 5).ToList(); }
    }
} 
```

或者它应该进入一个服务类，`ProductFilterer`它将整个产品列表作为参数，并返回一个过滤的产品列表。或者也许它应该直接进入调用类的方法？

或者是其他东西？对此的最佳做法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T14:09:59.507

您可以考虑查看[Specification Pattern](http://en.wikipedia.org/wiki/Specification_pattern)。该链接有一个很好的示例实现，但简而言之，该模式允许您基于简单的谓词（或规范）创建复杂的选择标准。

使用委托的这种模式的快速（和不完整）实现可以这样完成：

```
public class Specification<T>
{
    Func<T, bool> _spec;
    public Specification(Func<T, bool> spec)
    {
        _spec = spec;
    }

    public bool IsSatisifedBy(T item)
    {
        return _spec(T);
    }
}

// ...

_cheapProductsSpecification = new Specification<Product>(p => p.Price < 5);
var cheapProducts = Basket.Products.Where(p => _cheapProductsSpecification.IsSatifisifedBy(p)); 
```

当然，这是一个简单且可能多余的示例，但如果您添加 And、Or 和 Not（请参阅链接），您可以将复杂的业务逻辑构建到规范变量中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-29T15:41:12.827

如果“廉价产品”的概念是一流的领域概念并且必须以普遍存在的语言引入，我会做的是与领域专家一起看看。

如果是这种情况，Steve 的规范解决方案会以一种优雅的方式解决您的问题。

如果廉价不重要或定义不明确（例如，如果廉价阈值在整个应用程序中有所不同），我不会费心为其创建特定实体，只需在调用代码时使用相关标准过滤 Basket.Products .

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-29T13:44:15.290

您的 Basket 类不应该知道如何直接过滤，它具有一个公开的函数，允许它按照您的建议从 ProductFilter 返回结果是正确的。代码看起来应该是这样的：

```
class ProductFilter  
{  
    filterCheapProducts(Collection<Product> productsToFilter)  
    {  
       return Products.Where(p => p.Price < 5).ToList(); //I assume your code is correct  
    }    
}  

class Basket  
{  
    Collection<Product>  getCheapProducts()  
    {  
            return filter.filterCheapProducts(this.products);  
    }  
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-29T13:41:05.907

是的，我建议将您的 DTO 与业务逻辑分开。我喜欢将数据对象视为与数据访问、业务和 UI 层完全分离的层。如果你有一个更通用的 ProductBusiness 类，我建议你把它放在那里，除非有一个单独的过滤器类真的很有用。

# html - 服务器客户端通信：长轮询、彗星和服务器发送事件 (SSE)

> ID：10800282
> 
> 赞同：5
> 
> 时间：2012-05-29T13:36:20.860
> 
> 标签：html, comet, server-side, long-polling

我正在开发一个连接到服务器的 Web 应用程序，我需要服务器在给定时间向客户端推送一些信息。

因此，我开始阅读有关服务器发送事件 (SSE) 的内容，因为该网站是基于 HTML5 开发的，而 SSE 似乎符合我的要求。但是当我读到 SSE 真正做的是从客户端发送请求而不是相反的方式时，我感到很惊讶（昨天我想我明白长轮询是一种推送仿真）。因此，我开始阅读有关 web 套接字的信息（但它表明该标准仍是草案）并且还查看了 Comet。但我想我不能把所有的碎片都放在我的脑海里。

有人会强调这些技术（也许还有其他一些推动技术）适合我的问题，哪种情况更适合每种技术？

非常感谢，我想我完全迷失在这个领域。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-30T22:21:29.843

这篇[文章](http://nadirmuzaffar.blogspot.com/2013/03/polling-long-polling-comet-server-side.html "邮政")是一个更好的解释，讨论了关于 Long Polling、Comet、SSE 和 WebSockets 的区别/优势/等。

在大多数情况下，客户端通常必须向服务器发出第一个请求以建立连接。一旦建立连接，服务器就可以将数据推送到客户端。因此，即使使用[WebSockets](http://en.wikipedia.org/wiki/WebSocket)，客户端也会向服务器发出初始请求，以在两者之间建立可靠的连接。

服务器发送事件使用普通的 HTTP GET 请求来建立与服务器的连接。它也是客户端的只读连接。它的好处是易于实现，因为我们不必定义新协议。问题是 HTTP 连接，即使是持久连接，也会在大约 15 秒后被大多数 Web 服务器关闭。即使对于长期存在的请求，Web 服务器通常也会在超时之后关闭连接。这就是长轮询的想法出现的地方。这是一个简单的想法，我们向服务器发出正常的 ajax 请求，服务器尽可能长时间地保持打开状态。如果请求因某种原因被服务器关闭，您会立即再次发出相同的请求。您可以使用 Node 等服务器轻松实现长轮询机制（即 Comet）。js 和来自浏览器的正常 Ajax 请求。服务器发送事件尝试抽象出浏览器端的实现[事件源](https://developer.mozilla.org/en/Server-sent_events/EventSource)。因此，您不必为长轮询/彗星实现浏览器/客户端代码，浏览器会为您处理这个。它提供了一个看起来像持久连接的很好的抽象。您的 Web 服务器只需要查找在标头中将 Content-Type 指定为“text/event-stream”的 GET 请求，并尽可能长时间地保持 HTTP 连接打开。

我建议您不要过度复杂化服务器发送事件是什么。如果你理解一个普通的 HTTP GET 请求，那么你可能已经对它背后的想法有 90% 的理解。

SSE/Comet 和传统的长轮询之间有一个可能值得强调的区别。根据我的经验，长轮询背后的想法是，在您获得更新之前，您的请求不会返回。此时 HTTP 连接关闭，随后立即发出另一个请求。使用 SSE，虽然您可以在发送更新的消息后立即关闭 HTTP 连接，但您的目标是将数据从服务器刷新到客户端，而无需实际关闭/结束 HTTP 请求。这避免了实际发出 GET 请求的开销。这可以通过常规的 ajax 请求来实现，但是 SSE 再次通过 EventSource 提供了一个很好/高效的实现。

编辑：澄清 SSE 和长轮询之间的区别。

# php - PHP中有没有办法访问压缩的RTF并输出RTF代码

> ID：10800284
> 
> 赞同：10
> 
> 时间：2012-05-29T13:36:27.320
> 
> 标签：php, rtf

PHP中有没有办法访问压缩的RTF并将RTF代码输出到浏览器？

我在 SQL 中有一个文本列，我想从中提取 RTF - 我已设法将数据输出为 0x1F8B

我相信这些数据是压缩的 RTF - [http://www.freeutils.net/source/jtnef/rtfcompressed.jsp](http://www.freeutils.net/source/jtnef/rtfcompressed.jsp)

使用 [MS-OXRTFCP]：富文本格式 (RTF) 压缩算法[http://msdn.microsoft.com/en-us/library/cc463890%28v=exchg.80%29](http://msdn.microsoft.com/en-us/library/cc463890%28v=exchg.80%29)

**样本数据 ：**

```
0x1F8B0800000000000000654E316EC3300CEC5CA07FE0D6AD909D1628E0A1C8D01F74E422CB94CD46A11C4A6E5018F97B6967EC72381EC9BB5B516B6CD04BE11DC23C36ED5B8B03C5E8364C5EC6C61D0E2BC62CB5F6C988C358AE5C0AC6592F2DC630792D541D1C957DEA6E76D260144EFF57B7A7C715434E59CD0A3A541A1C8E4A240EFBB490EBEC027F98AE2796E11597D0E0EC75C013D1BC8360F1EF0EC316B115695BF89A08CE390B70816ABC571EA74AA542EEBF295460D975642B069F5EEBF45C6CB27707E5F4FBB14558EC1D83D9EEEC28D9BE142E8B59719697BB6C051FFE00D09796A337010000 
```

这看起来像我想要的，但它在 VB [http://www.vbforums.com/attachment.php?attachmentid=87371&d=1326754610](http://www.vbforums.com/attachment.php?attachmentid=87371&d=1326754610)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-14T03:33:16.300

您的数据样本是压缩数据，用于[`gzdecode`](http://www.php.net/manual/en/function.gzdecode.php)解码。您需要传递二进制字符串而不是提供的十六进制字符串（使用[`hex2bin`](http://www.php.net/manual/en/function.hex2bin.php)或[`pack`](http://www.php.net/manual/en/function.pack.php)转换）

```
if (!function_exists(hex2bin)){
    function hex2bin($hexStr){
        return pack('H*', $hexStr);
    }
}
$rtf = gzdecode(hex2bin('1F8B0800000000000000654E316EC3300CEC5CA07FE0D6AD909D1628E0A1C8D01F74E422CB94CD46A11C4A6E5018F97B6967EC72381EC9BB5B516B6CD04BE11DC23C36ED5B8B03C5E8364C5EC6C61D0E2BC62CB5F6C988C358AE5C0AC6592F2DC630792D541D1C957DEA6E76D260144EFF57B7A7C715434E59CD0A3A541A1C8E4A240EFBB490EBEC027F98AE2796E11597D0E0EC75C013D1BC8360F1EF0EC316B115695BF89A08CE390B70816ABC571EA74AA542EEBF295460D975642B069F5EEBF45C6CB27707E5F4FBB14558EC1D83D9EEEC28D9BE142E8B59719697BB6C051FFE00D09796A337010000')); 
```

这是原始数据。

```
{\rtf1\ansi\ansicpg1252\deff0\deflang1033{\fonttbl{\f0\fswiss\fprq2\fcharset0 Arial;}{\f1\fnil\fcharset0 Arial;}}
{\colortbl ;\red0\green0\blue0;}
\viewkind4\uc1\pard\keep\keepn\sa80\cf1\f0\fs22 The moon is the brightest object in the \i\f1 Earth's \i0\f0 sky?\par
\par
\cf0\par
Another question.\par
} 
```

这是渲染的文本。

> 月球是*地球*天空中最亮的物体？
> 
> 另一个问题。

我不确定您是否只想要原始 rtf 或渲染，看看[Free (preferably) PHP RTF to HTML converter？](https://stackoverflow.com/questions/4047411/free-preferably-php-rtf-to-html-converter)如果你想要 html 中的 rtf。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-29T13:52:44.830

我不能告诉你是否

```
0x1F8B0800000000000000654E316EC3300CEC5CA07FE0D6AD909D1628E0A1C8D01F74E422CB94CD46A11C4A6E5018F97B6967EC72381EC9BB5B516B6CD04BE11DC23C36ED5B8B03C5E8364C5EC6C61D0E2BC62CB5F6C988C358AE5C0AC6592F2DC630792D541D1C957DEA6E76D260144EFF57B7A7C715434E59CD0A3A541A1C8E4A240EFBB490EBEC027F98AE2796E11597D0E0EC75C013D1BC8360F1EF0EC316B115695BF89A08CE390B70816ABC571EA74AA542EEBF295460D975642B069F5EEBF45C6CB27707E5F4FBB14558EC1D83D9EEEC28D9BE142E8B59719697BB6C051FFE00D09796A337010000 
```

实际上是压缩的RTF数据。但如果是这样，[Zarafa 的 PHP MAPI 扩展](http://developer.zarafa.com/php-ext/)提供了一个解压函数：[`mapi_decompressrtf()`](http://developer.zarafa.com/php-ext/ref-Zarafa-Text-Functions.html#mapi_decompressrtf).

# ios - 为什么 json 值按字母顺序排序 iOS？

> ID：10800285
> 
> 赞同：1
> 
> 时间：2012-05-29T13:36:27.813
> 
> 标签：ios, json, nsarray, nsdictionary

> **可能重复：**
> [JSONkit 排序问题](https://stackoverflow.com/questions/7947234/jsonkit-sorting-issues)

我有以下json

```
[
  {
    "Pending": 67,
    "Past Due": 63,
    "Invites": 0
  },
  {
    "Reading Approval": 4,
    "Schedule Approval": 16,
    "Session Assignment": 1
  },
  {
    "Reading Approval": 3,
    "Schedule Approval": 20,
    "Class Approval": 20,
    "Module Approval": 2,
    "Training Plan Review": 2,
    "Job Confirmation": 1
  } 
```

]

当我将 json 字符串分配给 nsarray 时，字典中的值会按字母顺序排序。

```
NSArray *arr = [strResult JSONValue]; 
```

如何保持与 json 字符串相同的顺序？

```
arr = 
{
  Invites = 0;
  "Past Due" = 63;
  Pending = 67;
},
{
  "Reading Approval" = 4;
  "Schedule Approval" = 16;
  "Session Assignment" = 1;
},
{
  "Class Approval" = 20;
  "Job Confirmation" = 1;
  "Module Approval" = 2;
  "Reading Approval" = 3;
  "Schedule Approval" = 20;
  "Training Plan Review" = 2;
}
) 
```

* * *

这是我要显示的表格：

```
Group 1
  Pending    67
  Past Due   63
  Invites    0

Group 2
  Reading Approval    4
  Schedule Approval   16
  Session Assignment  1

Group 3
  Reading Approval      3
  Schedule Approval     20
  Class Approval        20
  Module Approval       2
  Training Plan Review  2
  Job Confirmation      1 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T14:33:07.380

使用标准 JSON 解析器，您将需要更改数据。

```
[
  [
    { "Pending": 67 },
    { "Past Due": 63 },
    { "Invites": 0 }
  ],
  [
    { "Reading Approval": 4 },
    { "Schedule Approval": 16 },
    { "Session Assignment": 1 }
  ],
  [
    { "Reading Approval": 3 },
    { "Schedule Approval": 20 },
    { "Class Approval": 20 },
    { "Module Approval": 2 },
    { "Training Plan Review": 2 },
    { "Job Confirmation": 1 }
  ]
] 
```

假设您可以更改 JSON 格式。

* * *

如何访问数据。假设您有节数组并且知道节和行索引。

```
NSArray *sections = ...
NSUInteger sectionIndex = ...
NSUInteger rowIndex = ...

NSArray *rows = [sections objectAtIndex:sectionIndex];
NSDictionary *cell = [rows objectAtIndex:rowIndex];

NSString *name = [[cell allKeys] objectAtIndex:0];
NSNumber *value = [cell objectForKey:name];

// What ever you need to do 
```

如果要遍历所有数据

```
NSArray *sections = ...

for (NSArray *rows in sections) {
    for (NSDictionary *cell in rows) {
        NSString *name = [[cell allKeys] objectAtIndex:0];
        NSNumber *value = [cell objectForKey:name];

        // What ever you need to do
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T15:21:43.427

**NSDictionary**是一个无序**的**容器对象。如果它被打印出来，它会按字母顺序排序。但是没有保证的顺序。

文档`description:`说：

```
If each key in the dictionary is an NSString object, the entries are listed in ascending order by key, otherwise the order in which the entries are listed is undefined. [...] 
```

`allKeys:`说：

```
The order of the elements in the array is not defined. 
```

并且`allValues`还说：

```
The order of the elements in the array is not defined. 
```

但是**NSArray**是一个**有序**的容器。这就是 Jeffery Thomas 声明您应该为每个 JSON 条目使用数组的原因。

但是您也可以尝试使用 smth ，例如：

```
[
  [
    "keys": {"Pending","Past Due","Invites"},
    "values": {67,63,0}
  ],
  [
    "keys": {"Reading Approval","Schedule Approval","Session Assignment"},
    "values": {4,16,1},
  ],
  [
    "keys": {"Reading Approval","Schedule Approval","Class Approval",...},
    "values": {3,20,20,...},
  ]
] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-29T15:14:09.430

字典没有订购它的项目。排序由 iOS 完成，只是为了很好地显示它。但是，您永远不应该假设字典中的项目有任何顺序。

# xml - 动态 E4X 表达式

> ID：10800286
> 
> 赞同：0
> 
> 时间：2012-05-29T13:36:29.473
> 
> 标签：xml, actionscript-3, dynamic, e4x

我的最后一个问题： [E4X 选择后代可以是 A OR B 或 A && B 的节点](https://stackoverflow.com/questions/10787607/e4x-select-nodes-where-descendants-can-be-either-a-or-b-or-a-b) 是关于如何在 E4X 表达式中查询多个属性值，@Patrick 对此进行了回答：

```
xml.Item.(descendants('ProductRange').(@id=="1" || @id=="2").length()>0); 
```

现在的问题是，我们如何使用数组或字符串使值动态化？

有点像这样，但这不起作用：

```
var attributeValues:String = "@id==\"1\" || @id==\"2\" || @id==\"3\" || @id==\"4\"";
xml.Item.(descendants('ProductRange').(attributeValues).length()>0); 
```

非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T13:37:11.657

例如，可以制作一个包含您的值的数组，然后使用[indexOf](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/Array.html#indexOf%28%29)搜索在其中查找 id：

```
var xml:XML=<Items>
<Item name="aaa">
    <ProductRanges>
        <ProductRange id="1" />
    </ProductRanges>
</Item>
<Item name="bbb">
    <ProductRanges>
        <ProductRange id="2" />
    </ProductRanges>
</Item>
<Item name="ccc">
    <ProductRanges>
        <ProductRange id="1" />
        <ProductRange id="3" />
        <ProductRange id="2" />
    </ProductRanges>
</Item>
</Items>;

// you values filled from whatever source
var valuesToFind:Array=["1","2", "3"]; 

// search if @id exist into your values
// and unsure that there is any node returned
var res:XMLList=xml.Item.(descendants('ProductRange').(valuesToFind.indexOf(@id.toString())>=0).length()>0);
trace(res); 
```

# sql-server - SQL 插入 - 从不同的服务器和凭据

> ID：10800288
> 
> 赞同：0
> 
> 时间：2012-05-29T13:36:30.397
> 
> 标签：sql-server, select, insert, credentials

我们在服务器 A 上存在一个数据库。服务器 A 还托管我们将调用 SQL 语句的程序代码。

我们`VMIntranetTest`在服务器 B 上有另一个数据库`VMC-MMS`

服务器 A 和服务器 B 具有不同的登录用户凭据。服务器 A 和服务器 B 都存在于我们的内部网络上。

使用 PHP，我定义了以下 SQL 语句。

```
$strSql = 'INSERT INTO VMC-MMS.VMIntranetTest.dbo.TestTable (FirstName, LastName, Age) ' .
                    'SELECT FNAME, LNAME, AGE ' .
                    'FROM BSLIB.SQLTSTF '; 
```

`FROM -> BSLIB.SQLTSTF <-`位于我们的本地服务器 (A) 上，因此用于执行语句的连接字符串将具有连接到服务器 A 的用户凭据。

`INSERT INTO -> VMC-MMS.VMIntranetTest.dbo.TestTable <-`是不同的 server.database.dbo.table（服务器 B）。

如何指定要用于语句的 INSERT INTO 部分的用户凭据？包含 SELECT FROM 语句的次要部分应该已经包含在我的初始连接字符串中。

谢谢，

**编辑 1**关于保罗的回答。

我尝试使用`OPENROWSET`上述方法，并使用以下 SQL 语句。

```
INSERT INTO VMIntranetTest.TestTable (FirstName, LastName, Age)
OPENROWSET('vmas400',
           'Server=192.168.1.2;Trusted_Connection=yes;user_id=INTRAIS;password=****',
           'SELECT FNAME, LNAME, AGE FROM BSLIB.SQLTSTF' ) as a 
```

正如你所看到的，我改变了一些事情。我通过代码的连接字符串打开了与服务器 B“VMC-MMS”的连接。我的 SQL 语句“选择”部分，使用 OPENROWSET 打开到服务器 A“192.168.1.2”的连接。

但是，我收到此错误消息：

> SQLSTATE [HY000]：一般错误：“OPENROWSET”附近的 1：语法错误

**编辑 2** 我需要将整个 OPENROWSET 部分放在 VALUES ( ) 子句中。现在我收到一条消息：

> SQLSTATE[HY000]: 一般错误: 1 no such table: VMIntranetTest.TestTable

**编辑 3**

我现在有以下 SQL

```
 INSERT INTO VMIntranetTest.TestTable (FirstName, LastName, Age)
 select a.FNAME, a.LNAME, a.AGE FROM 
 OPENROWSET('vmas400',
            'Server=192.168.1.2;Trusted_Connection=yes;user_id=INTRAIS;password=****',
            'SELECT FNAME, LNAME, AGE FROM BSLIB.SQLTSTF' ) as a 
```

我收到了这个错误：

> SQLSTATE[HY000]：一般错误：“（”附近的 1：语法错误

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-29T15:15:47.910

你只需要`SELECT`那里的声明。尝试这个：

```
INSERT INTO VMIntranetTest.dbo.TestTable (a.FirstName, a.LastName, a.Age)
SELECT a.FirstName, a.LastName, a.Age FROM
OPENROWSET('vmas400',
           'Server=192.168.1.2;Trusted_Connection=yes;user_id=INTRAIS;password=****',
           'SELECT FNAME, LNAME, AGE FROM BSLIB.dbo.SQLTSTF' ) as a 
```

编辑：现在尝试查询。您从数据库中指定了表，但没有指定架构。如果您具有适当的权限，则上述查询现在将起作用。否则，您将需要指定架构。很抱歉没有抓住那个！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T13:43:42.163

您可以使用`OPENROWSET`从不同的数据库中选择数据

[http://msdn.microsoft.com/en-us/library/ms190312.aspx](http://msdn.microsoft.com/en-us/library/ms190312.aspx)

# java - Java，如何使它成为一个泛型方法？

> ID：10800289
> 
> 赞同：0
> 
> 时间：2012-05-29T13:36:39.713
> 
> 标签：java, generics, methods

我将如何将下面的代码重构为 1 个通用方法？
（背景信息，用于从与 GSON 库一起使用的 Json 字符串中获取值）

```
ArrayList<Map<Object, Object>> theme = new ArrayList<Map<Object, Object>>();
for (int i = 0; i < obj.getThemeList().size(); i = i + 1) {
    if(Boolean.parseBoolean(obj.getThemeList().get(i).getChecked())){
        Map<Object,Object> map = new HashMap<Object,Object>();
        map.put("id", obj.getThemeList().get(i).getId());
        map.put("name", obj.getThemeList().get(i).getName());
        theme.add(map);
    }
} 
```

* * *

```
ArrayList<Map<Object, Object>> tag = new ArrayList<Map<Object, Object>>();
for (int i = 0; i < obj.getTagList().size(); i = i + 1) {
    if(Boolean.parseBoolean(obj.getTagList().get(i).getChecked())){
        Map<Object,Object> map = new HashMap<Object,Object>();
        map.put("id", obj.getTagList().get(i).getId());
        map.put("name", obj.getTagList().get(i).getName());
        tag.add(map);
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-29T13:45:25.383

基本上，只需使其成为接受`getThemeList()`or的单一方法`getTagList()`，不是吗？看来这就是他们之间的唯一区别了……

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-29T13:48:26.783

我认为您的意思是“我如何重构它以重用代码”，因为泛型在这里的应用不像重构那样多。

首先，阅读[foreach 语法](http://docs.oracle.com/javase/1.5.0/docs/guide/language/foreach.html)——你的 for 循环真的很难看。

你没有付出太多，但试试这个：

```
public interface HasIdNameAndChecked {
    String getChecked();
    String getId();
    String getName();
}

public static List<Map<String, String>> extractList(List<? extends HasIdNameAndChecked> items) {
    List<Map<String, String>> list = new ArrayList<Map<String, String>>();
    for (HasIdNameAndChecked item : items) {
        if (Boolean.parseBoolean(item.getChecked())){
            Map<String, String> map = new HashMap<String, String>();
            map.put("id", item.getId());
            map.put("name", item.getName());
            list.add(map);
        }
    }
    return list;
} 
```

然后让你的`Theme`和`Tag`类实现`HasIdNameAndChecked`，并像这样调用它：

```
List<Map<String, String>> list1 = extractThemeList(obj.getThemeList());
List<Map<String, String>> list2 = extractThemeList(obj.getTagList()); 
```

免责声明：我在没有 IDE 的情况下输入了这个，所以可能有几个错别字。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-29T13:55:17.577

好吧，让我们按照以下顺序进行：

1.  **确定什么变化。**主题列表和标签列表。

2.  **识别共同的属性和行为。**getChecked()、getId()、getName()。

3.  **对变化进行概括。**为不同的事物定义一个通用接口：抽象类、接口、行为等。

4.  **将您的解决方案更新为通用解决方案。**

# html - IE9：强制 IE9 浏览器模式和文档模式

> ID：10800290
> 
> 赞同：3
> 
> 时间：2012-05-29T13:37:00.157
> 
> 标签：html, internet-explorer-9

在 IE9 中，我的网页显示为`Browser Mode: IE9 Compat View`and `Document Mode: IE standards`，这打破了我所有的`canvas`es。

我确保将其`<!DOCTYPE html>`作为第一行。

如何在 IE9 上强制“正常”IE9 模式？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-29T14:14:58.987

有“边缘”模式。

```
<html>
   <head>
      <title>My Web Page</title>
      <meta http-equiv="X-UA-Compatible" content="IE=edge" />
   </head>
   <body>
      <p>Content goes here.</p>
   </body>
</html> 
```

从链接的 MSDN 页面：

> 边缘模式告诉 Windows Internet Explorer 以可用的最高模式显示内容，这实际上打破了“锁定”范式。对于 Internet Explorer 8，这相当于 IE8 模式。如果 Internet Explorer 的（假设的）未来版本支持更高的兼容模式，则设置为 Edge 模式的页面将以该版本支持的最高模式出现；但是，当使用 Internet Explorer 8 查看时，这些相同的页面仍会以 IE8 模式显示。

但是，在生产使用中不鼓励“边缘”模式：

建议 Web 开发人员将 Edge 模式的使用限制为测试页面和其他非生产用途，因为在未来版本的 Windows Internet Explorer 中呈现页面内容可能会导致意外结果。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-29T13:59:28.057

以下行，取自 HTML5 样板，完成了这项工作：

```
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"> 
```

# asp.net - GridView DataFormatString 并不总是有效

> ID：10800294
> 
> 赞同：1
> 
> 时间：2012-05-29T13:37:12.147
> 
> 标签：asp.net, gridview, dataformat

我有一个显示简单数据表结果的 ASP.NET 2.0 网格视图。Gridview 的列显式定义为显示十进制字段的值。该列使用 {0:C} 的 DataFormatString 设置。当我在本地开发机器上查看它时，它会正确输出值（按预期应用货币格式）。一旦我将它部署到我的集成服务器，格式就不适用。我已经验证了代码是一样的，我已经验证了数据库是一样的。唯一的区别是 Web 服务器。我正在通过 vs 2005 中的内置 Web 服务器运行我的本地副本，并且集成服务器正在运行 IIS 6.0。我在同一集成服务器上有其他应用程序，它们有一个应用格式字符串的网格视图，没有问题。

```
<asp:BoundField DataField="BEGIN_BALANCE" HeaderText="Beginning Balance" DataFormatString="{0:C}">
<ItemStyle Wrap="False" HorizontalAlign="Right" />
</asp:BoundField> 
```

在我的本地机器上，值 52393.59 显示为 $52,393.59，而在集成服务器上显示为 52393.5900。

有谁知道我可能会错过什么？

谢谢！

# ruby-on-rails - ERB 模板无法从控制器操作中获取实例变量：

> ID：10800295
> 
> 赞同：0
> 
> 时间：2012-05-29T13:37:12.107
> 
> 标签：ruby-on-rails, erb

在过去的两周里，我遇到了以下问题：

我想用预渲染的 html-body 创建报告：

```
def new
  @content_for_prerendering= Report.get_content
  @report = Report.new
  template = ERB.new(File.read("#{Rails.root}/app/views/report_template/default.html.erb"))
  @report.body = template.result(binding)
end 
```

遵循 ERB 文件。但是在模板文件 DEFAULT.HTML.ERB 中，我似乎只能看到局部变量，例如

```
 content_for_prerendering = Report.get_content 
```

不是实例变量。将每个实例变量绑定到本地只是为了呈现一些 html 是非常不寻常的。我错过了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T15:26:54.633

试试这个以获得视图上下文绑定以正确委托实例变量

```
@report.body = render_to_string :file => "#{Rails.root}/app/views/report_template/default.html.erb" 
```

# user-interface - GUI Overlay over Powershell Script

> ID：10800299
> 
> 赞同：2
> 
> 时间：2012-05-29T13:37:25.673
> 
> 标签：user-interface, powershell, installation

I need to create a GUI overlay that will provide status information to users while an install is taking place. The install happens through Powershell scripts. I would rather not rewrite the functionality that is already taking place in the scripts.

Are there any practical methods I can use to overlay a GUI over the scripts? I am thinking of something along the lines of an application installer that just calls the scripts and displays information about the status.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T13:42:53.573

You can run [PowerShell scripts from CSharp](http://www.codeproject.com/Articles/18229/How-to-run-PowerShell-scripts-from-C) and interact with the PS runspace.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-29T14:09:30.630

You can always wrap up these scripts in WinForms (PrimalForms Community Edition to design the UI) within PowerShell or use something like ShowUI (showui.codeplex.com).

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-29T15:43:25.820

Anything particularly wrong with using Write-Progress calls in your scripts?

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-29T15:50:30.343

I recently wrote an install cum config tool and this is what I did to run the PS scripts asynchronously from C#/Winforms - [https://stackoverflow.com/a/10741061/763026](https://stackoverflow.com/a/10741061/763026) [Full code is there]

# jquery - jquery添加类如果空白属性

> ID：10800301
> 
> 赞同：0
> 
> 时间：2012-05-29T13:37:31.247
> 
> 标签：jquery, addclass

我有一个带有标题属性的 div：

```
<div id="video" title="<?php echo $row_rs_dealItem['video']; ?>"> 
```

基本上，如果 mysql 的返回值为空白，那么我想添加一个类。我有以下脚本：

```
$(document).ready(function(e) {
    $('#video[title*=""]').addClass('invisible');
}); 
```

这似乎很容易，所以不知道我做错了什么。多谢你们

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-29T13:39:05.450

`*=`意思是“包含”。您的所有`title`属性都将包含空字符串。只需将其更改为`=`：

```
$('#video[title=""]').addClass('invisible'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T13:39:20.247

为什么在javascript中这样做？

我假设没有标题=不想显示视频？

```
if( !empty($row_rs_dealItem['video']) ) {
    echo '<div id="video" title="'. $row_rs_dealItem['video'] .'">';
} 
```

正如所指出的，如果您仍然希望用户加载未使用的标记，您可以使用它来添加类......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-29T13:46:26.270

你为什么不这样做而不是从 php

```
echo '<div id="video" title="'. $row_rs_dealItem['video'] .'" class ="'. ((!$row_rs_dealItem['video'])?"invisible":"").'">'; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-29T13:40:57.960

我自己没有这样做，但建议尝试

```
if($("#video").attr("title") == "") {
 $("#video").addClass("invisible");
} 
```

# java - 请求的资源不可用 Spring 3 MVC

> ID：10800302
> 
> 赞同：1
> 
> 时间：2012-05-29T13:37:35.260
> 
> 标签：java, spring, spring-mvc

我正在浏览器中显示请求的资源（）不可用，我无法理解我做错了什么。

这是我的 applicationContext-dispatcher.xml：

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:p="http://www.springframework.org/schema/p"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd">

    <bean id="viewResolver"
          class="org.springframework.web.servlet.view.InternalResourceViewResolver"
          p:prefix="/WEB-INF/jsp/"
          p:suffix=".jsp"/>

</beans> 
```

这是我的 web.xml：

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app version="3.0"
         xmlns="http://java.sun.com/xml/ns/javaee"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd">

    <context-param>
        <param-name>contextConfigLocation</param-name>
        <param-value>
            /WEB-INF/applicationContext-main.xml
            /WEB-INF/applicationContext-hibernate.xml
            /WEB-INF/applicationContext-jms.xml
            /WEB-INF/applicationContext-i18n.xml
        </param-value>
    </context-param>

    <listener>
        <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
    </listener>

    <servlet>
        <servlet-name>dispatcher</servlet-name>
        <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
        <init-param>
            <param-name>contextConfigLocation</param-name>
            <param-value>/WEB-INF/applicationContext-dispatcher.xml</param-value>
        </init-param>
        <load-on-startup>1</load-on-startup>
    </servlet>
    <servlet-mapping>
        <servlet-name>dispatcher</servlet-name>
        <url-pattern>*.htm</url-pattern>
    </servlet-mapping>

    <session-config>
        <session-timeout>
            30
        </session-timeout>
    </session-config>

    <welcome-file-list>
        <welcome-file>redirect.jsp</welcome-file>
    </welcome-file-list>

</web-app> 
```

这是redirect.jsp：

```
<%@page contentType="text/html" pageEncoding="UTF-8"%>
<% response.sendRedirect("index.htm"); %> 
```

index.jsp 页面位于 WEB-INF/jsp 下。

打开浏览器时，我看到从 tomcat ant 生成的 404 错误代码，即资源不可用的消息。我不明白出了什么问题。有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-29T13:58:27.887

Resources which are inside the **WEB-INF** folder aren't accessible to the outside world (JSP file in your case). Means that you can not simply hit the URL and see the JSP file.

For example, you have the following JSP,

```
<%@ page language="java" contentType="text/html; charset=ISO-8859-1"
pageEncoding="ISO-8859-1"%>
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
</head>
<body>
<h1>Hello World</h1>
</body>
</html> 
```

then you can not simply hit the browser using:

```
http://localhost:8080/project-name/WEb-INF/nameofpage.jsp 
```

It will throw the same error. Though you can programmatically access those resources inside WEB-INF folder.

Write the following controller:

```
package your.apckage.name;

import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestMethod;

@Controller
public class SampleController {

    @RequestMapping(value = "/index", method = RequestMethod.GET)
    public String sample() {
        return "index";
    }
} 
```

And add the following line in spring -config file:

```
<context:component-scan
    base-package="package name of the controller" /> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-29T14:08:47.080

So, have you defined any controller mapping for index.htm? Spring won't "automatically" forward the request to your index.jsp view, you need to define a controller to handle the index.htm url.

```
@Controller
public class IndexController {

    @RequestMapping("/index.htm")
    public String handleIndexGet() {
        return "index"; // forward to view index.jsp
    }

} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-29T13:41:50.420

难道不应该

```
<% response.sendRedirect("index.jsp"); %> 
```

Also, since you're doing a redirect, the `index.jsp` has to be present outside WEB-INF to be accessible to your browser.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-29T13:40:21.640

当 URL 映射出现问题时，通常会出现**请求的资源未找到错误。**当请求的 URL 不匹配任何 URL 模式时，它会抛出此异常。

# c - 比较 C 中的浮点数以进行单元测试

> ID：10800304
> 
> 赞同：4
> 
> 时间：2012-05-29T13:37:48.833
> 
> 标签：c, floating-point, arithmetic-expressions

所以我使用 CUnit 进行单元测试。我期待类似的东西

```
float x;
x = atof("17.99"); 
```

我想用一个断言来测试它；显然，我可以用一些小ε

```
CU_ASSERT(abs(x - atof("17.99")) < epsilon); 
```

不过我正在考虑

```
r = atof("17.99");
CU_ASSERT(0 == memcmp(&x, &r, sizeof(float)); 
```

这似乎确实有效。我希望使用它来避免必须根据值在每个测试上手动设置 epsilon。在上述情况下 1e-6 应该足够了；但是，如果值为 1e-10，使用 1e-6 的 epsilon 可能不会出现问题。开发人员必须做出的选择越多，出错的空间就越大。

我的问题是：这种技术在 posix 系统上应该稳定吗？也就是说，如果被比较的两个浮点数是由完全相同的步骤生成的，那么它们的内部表示应该完全相同。

编辑：更重要的是，我最终想要一个 CU_ASSERT_FLOAT_EQUAL 宏。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-30T16:08:21.767

比较浮点值很难。混入字符串不会让事情变得更好，当然也不会像 epsilon 那样引入少量的回旋余地。

看看这篇文章：[比较浮点数，2012 版](http://randomascii.wordpress.com/2012/02/25/comparing-floating-point-numbers-2012-edition/)。对于我的钱，ULP 是要走的路。有一些令人讨厌的边缘情况，但您可能可以忽略其中的大部分。

**编辑：5 月 31 日** 对此进行了更多考虑，我认为您要问的是“如果在测试函数和被测函数中使用完全相同的步骤来计算浮点数，那么答案是否完全相同 -这样我就不用担心 +/- 一些小错误了？”

答案是肯定的，它们将是相同的。但是在这种情况下，您使单元测试变得毫无意义，因为如果被测代码中存在错误，那么测试函数中必然会出现相同的错误。

顺便说一句，不要因为 memcmp(&x, &y, sizeof(x)) 的使用而分心。这只是测试在两个值中设置了完全相同的位。如果这是真的，那么 x == y 必然是真的。坚持 x == y。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-01T17:20:48.460

请注意将浮点数与双精度数进行比较，就像在最初的问题中所做的那样。浮点数必然会丢失精度，因此当与全精度双精度数进行比较时，您可能会发现数字不相等，即使计算很完美。

有关详细信息，请参阅[http://randomascii.wordpress.com/2012/06/26/doubles-are-not-floats-so-dont-compare-them/](http://randomascii.wordpress.com/2012/06/26/doubles-are-not-floats-so-dont-compare-them/)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-29T14:09:56.300

```
float r, x;

r = atof("17.99");
CU_ASSERT(0 == memcmp(&x, &r, sizeof(float)); 
```

应该具有相同的效果

```
r = atof("17.99");
CU_ASSERT(x == r); 
```

注意 atof 返回一个双精度，所以

```
CU_ASSERT(x == atof("17.99")); 
```

不同，但是

```
CU_ASSERT(x == (float)atof("17.99")); 
```

也应该是一样的。

另请注意，[当使用从 x87 继承的指令时，gcc 优化器在 x86 上存在一个长期存在的错误](http://gcc.gnu.org/bugzilla/show_bug.cgi?id=323)（如果我没记错的话，x86_64 上不会发生这种情况）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-06T15:27:23.057

所以答案似乎是否定的。

原因是即使您在计算每个变量时使用相同的一系列计算，如果在计算值的步骤之间有任何代码，您可能会导致不同的舍入错误，正如[@AProgrammer 的响应](https://stackoverflow.com/a/10800881)中的注释所指出的那样。

问题是，虽然您可以声明一个 n 位浮点，但它可能存储在一个更大的寄存器中（x87 使用 80 位寄存器）。如果将该值从寄存器推入内存以释放寄存器以进行其他操作，则该值将被截断（四舍五入？我的笔记去哪儿了......）。当值被带回寄存器时，丢失的精度会进行其余的计算。

另一方面，另一段代码在计算值时可能会经历完全相同的步骤。但是，如果该值没有从寄存器中推出（或在不同的地方推出......），那么当它再次存储在内存中时，您会得到不同的截断。

所有这些都是 IEEE 根据 gcc 邮件列表/错误报告中的注释批准的。

由于自 80386 以来我没有接触过寄存器，我只能猜测现代 x86 和 amd_64 处理器有什么；但我猜测没有提示 gcc 对于 x86 它使用基本的 x87 寄存器集或基本的 SSE 寄存器集。

所以使用 fabs(xy) < epsilon; 的经验法则 持有，对于 CUnit，它以双重格式提供（如果一个人想像我习惯的那样对事物保持警惕，可以轻松编写宏的浮点版本），正如@Martin Beckett 评论的帖子所指出的那样在。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-01-22T10:20:07.017

我认为有一种不同的方式来处理这个问题。问题是关于单元测试。单元测试应该测试和记录被测单元（uut）。

为此，在编写测试时应该询问 uut 可接受的容差是多少。（这可能需要为每个 uut 而不是整个测试项目考虑）。

通过这种方式，测试可以避免测试相等性，测试值是否在可接受的范围内，并记录单元测试结果的可接受容差。

# java - 对于特定方法，如何使用反射查看 java 中的已检查异常？

> ID：10800305
> 
> 赞同：3
> 
> 时间：2012-05-29T13:37:49.390
> 
> 标签：java, reflection, methods, exception-handling, jvm

对于特定方法，如何使用反射查看 java 中的已检查异常？JDK 中似乎不支持此功能。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-29T13:39:49.130

使用此方法`Method`：

`public Type[] getGenericExceptionTypes()`

然后，如果要分隔已检查和未检查的异常，则必须遍历类型。

# android - 线性布局中的线性布局+按钮工作正常，但按钮+线性布局不行

> ID：10800307
> 
> 赞同：0
> 
> 时间：2012-05-29T13:37:50.813
> 
> 标签：android, android-layout, android-linearlayout

我想更改列表项按钮的位置，在我将按钮移动到我想要的位置后，模拟器会给我一个错误。所以任何人都可以告诉我为什么这段代码可以正常工作：

list_item.xml

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:id="@+id/messages_list_item"
android:layout_height="wrap_content" 
android:gravity="left|center"
android:layout_width="fill_parent" >

<Button
android:id="@+id/send_message_button"
android:layout_width="wrap_content"
android:layout_height="wrap_content"
android:text="@string/send" />

<LinearLayout
    android:orientation="vertical"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content">
    <TextView android:id="@+id/destination"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:gravity="center"/>
    <TextView android:id="@+id/message_text" 
        android:layout_width="wrap_content" 
        android:layout_height="wrap_content"/>
</LinearLayout>
</LinearLayout> 
```

如果我像这样将 Button 元素移动到底部：

list_item.xml

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:id="@+id/messages_list_item"
android:layout_height="wrap_content" 
android:gravity="left|center"
android:layout_width="fill_parent" >

<LinearLayout
    android:orientation="vertical"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content">
    <TextView android:id="@+id/destination"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:gravity="center"/>
    <TextView android:id="@+id/message_text" 
        android:layout_width="wrap_content" 
        android:layout_height="wrap_content"/>
</LinearLayout>

<Button
android:id="@+id/send_message_button"
android:layout_width="wrap_content"
android:layout_height="fill_parent"
android:text="@string/send" />
</LinearLayout> 
```

它不在模拟器上启动？

这是我的活动视图：

布局.xml

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:id="@+id/base_layout"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:orientation="vertical" >

<ListView
    android:id="@+id/messages_list"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent" />

</LinearLayout> 
```

我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T13:42:30.457

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:id="@+id/messages_list_item"
android:layout_height="wrap_content" 
android:gravity="left|center"
android:layout_width="fill_parent" >

<LinearLayout
    android:orientation="vertical"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content">
    <TextView android:id="@+id/destination"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:gravity="center"/>
    <TextView android:id="@+id/message_text" 
        android:layout_width="wrap_content" 
        android:layout_height="wrap_content"/>
</LinearLayout>

<Button
android:id="@+id/send_message_button"
android:layout_width="wrap_content"
android:layout_height="wrap_content"
android:text="@string/send" />

</LinearLayout>

<Button
android:id="@+id/send_message_button"
android:layout_width="wrap_content"
android:layout_height="fill_parent"
android:text="@string/send" />
</LinearLayout> 
```

在第二个 xml 中，我认为你将最后 6 行加倍了......所以你关闭了太多 LinearLayout。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T13:52:43.167

你应该看到`list_item.xml`文件。您将 Button 的代码编写为 times 并再次关闭`</LinearLayout>`一次。我认为它会出错`list_item.xml`

.

# quartz.net - 虚拟主机后的 Quartz.NET

> ID：10800312
> 
> 赞同：0
> 
> 时间：2012-05-29T13:38:03.193
> 
> 标签：quartz.net

我有一个 ASP.NET 应用程序和一个使用 Quartz.NET 安排的作业，每天运行一次。作业执行只不过是实现 IJob 接口的类之一中的方法调用（具体为执行方法）。如果我在 GoDaddy 的网格托管（他们称之为云）上托管这个 Web 应用程序，而我们无法访问物理服务器，那么这项工作还会运行吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-02T17:11:42.473

Quart.Net 对 3rd 方库（通用日志记录）有一些依赖关系，这些依赖关系不允许它在中等信任下运行。因此，如果您可以将 Quartz.Net 托管在可以在完全信任的情况下运行的地方，那么您应该没问题，否则，您需要重新编译 Quartz.Net，而不依赖于公共日志记录。

# c# - Monotouch中UIPanGestureRecognizer的速度如何减慢

> ID：10800315
> 
> 赞同：0
> 
> 时间：2012-05-29T13:38:16.737
> 
> 标签：c#, xamarin.ios

当我在手势识别器的单次触摸上平移图像时，它移动图像非常快我如何减慢 UIPanGestureRecognizer 的速度我的代码是

```
void PanImage (UIPanGestureRecognizer gestureRecognizer)
{
var image = gestureRecognizer.View;
if (gestureRecognizer.State == UIGestureRecognizerState.Began || gestureRecognizer.State == UIGestureRecognizerState.Changed)
{
var translation = gestureRecognizer.TranslationInView (window);
gestureRecognizer.View.Center = new PointF (gestureRecognizer.View.Center.X + translation.X, gestureRecognizer.View.Center.Y + translation.Y);
gestureRecognizer.SetTranslation (PointF.Empty, image);
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-25T13:53:41.450

您从识别器计算的平移可以除以一个因子以减慢平移效果。

它可以像这样很容易地完成：

```
var factor =2;

gestureRecognizer.View.Center = new PointF (gestureRecognizer.View.Center.X + (translation.X/factor), gestureRecognizer.View.Center.Y + (translation.Y/factor)); 
```

# c++ - C++：模式：哪种模式适合特定的代码执行，具体取决于命令行参数

> ID：10800319
> 
> 赞同：0
> 
> 时间：2012-05-29T13:38:36.480
> 
> 标签：c++, oop, design-patterns, command-line-arguments

具有 C++ 控制台实用程序。里面的代码解析命令行输入，并根据输入调用特定的函数。

我有一个丑陋的解析例程，它调用全局函数。

我不喜欢这段代码，想通过设计模式应用程序组织这段代码。

流程如下：

*   处理命令行参数；
*   如果发生错误，则报告它并退出，否则继续；
*   根据指定的参数调用特定的例程；

对于这种情况，你会建议什么模式？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T13:39:35.973

用于此类事情的常见设计模式是[命令模式](http://en.wikipedia.org/wiki/Command_pattern)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T13:58:42.130

不是模式，但我建议看看 Boost.Program_options：

[http://www.boost.org/doc/libs/1_49_0/doc/html/program_options.html](http://www.boost.org/doc/libs/1_49_0/doc/html/program_options.html)

它可以轻松地为您的应用程序添加对命令行参数的支持，因为它完成了所有繁琐的解析。要实际执行特定功能，您仍然可以查看诸如命令模式之类的模式（如@Brady 所建议的那样）。

但是，请注意 program_options 是 Boost 库之一，它不仅是头文件，而且需要编译。

# c++ - C++ 模板的问题（大惊喜！）。为什么这行不通？

> ID：10800333
> 
> 赞同：0
> 
> 时间：2012-05-29T13:39:26.647
> 
> 标签：c++, templates, g++, operator-overloading, overload-resolution

我正在测试一种模仿 C# 属性的方法并创建了以下`property`类：

```
struct BY_REF
{
    template <class T>
    struct TT_s
    {
        typedef T &TT_t;
    };
};
struct BY_VAL
{
    template <class T>
    struct TT_s
    {
        typedef T TT_t;
    };
};

template <class T, class P=BY_REF>
class property
{
private:
    typedef typename P::template TT_s<T>::TT_t TT;
    T &value;
    property();
    property(const property &);
    property &operator=(const property &);
public:
    explicit property(T &v) : value(v) {}
    operator const TT() const
    {
        return value;
    }
    TT operator=(const TT i)
    {
        return value = i;
    }
}; 
```

我用以下代码测试了这个类：

```
int main()
{
    int i;
    std::string s;
    property<int, BY_VAL> I(i);
    property<std::string> S(s);
    //stringproperty S(s);
    I = 1337;
    char c[] = "I am ";
    S = std::string(c);
    cout << /*S <<*/ I << endl;
    return 0;
} 
```

这给了我一个意外的编译器错误，“ `no match for 'operator='`...”，对于 line `S = std::string(c);`。我注释掉了打印，`S`因为我的`operator=`问题似乎更简单，我希望它的解决方案也能解决`operator<<`问题。为了弄清楚发生了什么，我手动实例化了模板，如下所示：

```
class stringproperty
{
private:
    std::string &value;
    stringproperty();
    stringproperty(const stringproperty &);
    stringproperty &operator=(const stringproperty &);
public:
    explicit stringproperty(std::string &v) : value(v) {}
    operator const std::string &() const
    {
        return value;
    }
    std::string &operator=(const std::string &i)
    {
        return value = i;
    }
}; 
```

我的手动版本有效。谁能解释为什么模板版本没有？（我怀疑它与`BY_REF`and`BY_VAL`类有关，但我不知道为什么它适用于整数。）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-29T13:51:21.893

Your manual version is erroneous, and the issue has nothing to do with templates.

```
typedef int& IntRef;

const int& == int const&

const IntRef == IntRef const == int& const 
```

Notice the difference ? The issue is thus there: `TT operator=(const TT i)`.

The general guideline is that if you want to treat a `typedef` as a simple text replacement, then you need to start *right now*: **Put the `const` after the type it qualifies**.

# delphi - Delphi XE 源代码编辑器过程/函数序列

> ID：10800337
> 
> 赞同：0
> 
> 时间：2012-05-29T13:39:32.443
> 
> 标签：delphi, editor, delphi-xe

我已经从 Delphi 7 切换到 Delphi XE。

当我在一个单元中创建一个新过程或函数时，Delphi 会自动将该函数/过程按字母顺序放置在单元中。例如

frm.Form关闭；然后frm.FormKeyPress；然后是frm.FormShow；

反正有禁用这个吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T15:03:26.407

AFAIK，没有办法禁用它。

# internet-explorer - IE8 ExtJs4 问题

> ID：10800338
> 
> 赞同：0
> 
> 时间：2012-05-29T13:39:34.180
> 
> 标签：internet-explorer, extjs, extjs4

我已经使用 ExtJs4.0.7 开发了一个 Web 应用程序。该应用程序在 Windows Xp、7 上的 firefox、chrome、IE 8,9 中运行良好。但它不适用于 IE8 Windows xp sp3。同样在 IE8 开发者工具控制台中也没有错误。

有没有人遇到过Window xp sp3的这些问题并有相同的解决方案。以下是我在 Windows xp sp3 机器上使用的 IE 版本 -

即 8.0.6001.18702

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T13:42:07.250

尝试仔细检查您的 JS 代码中是否存在不必要的逗号，类似这样的东西（参见 value2 之后的一个）：

```
object: {
   prop1: value,
   prop2: value2,
} 
```

Chrome、FF 和 Safari 不在乎，但 IE 通常会停止工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T13:49:23.107

尝试使用`ext-dev.js`file 而不是`ext.js`or `ext-all.js`，如果 extjs 框架中有任何错误，您可能会在控制台中看到错误。

# javascript - 如何使用 java 脚本创建扩展列表视图？

> ID：10800340
> 
> 赞同：0
> 
> 时间：2012-05-29T13:39:40.670
> 
> 标签：javascript, expandablelistview

我想使用 java 脚本创建垂直可扩展列表视图。喜欢[这里点击](http://www.udm4.com/demos/expanding-single.php)。如果有人知道指导我。在此先感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T13:49:11.117

这是我不久前构建的一个非常简单的（需要 jQuery）。

[http://www.fluidbyte.net/simple-jquery-expandcollapse-unordered-lists](http://www.fluidbyte.net/simple-jquery-expandcollapse-unordered-lists)

定制和实现相当简单。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T13:56:36.553

使用 jQuery 很简单，看看这里：http: [//jsfiddle.net/shershen08/RGc36/5/](http://jsfiddle.net/shershen08/RGc36/5/)

# winapi - 在 Haskell 中创建窗口的方法有哪些？零级

> ID：10800341
> 
> 赞同：-3
> 
> 时间：2012-05-29T13:39:42.747
> 
> 标签：winapi, user-interface, haskell, event-handling, window

```
 {- 2012-05-16

    ghc --make -optl-mwindows fileName.hs

option -mwindows is passed to the linker!
attempting to read from stdin with -mwindows may cause a runtime error
any output on stdout/stderr will be lost.
ghc links console app with stdout/stderr as default
-}

--import Graphics.Win32
import Graphics.Win32 hiding (messageBox, c_MessageBox) -- bugfix
import System.Win32.DLL
import Control.Exception (bracket)
import Foreign
import System.Exit

-- bugfix whole msg box
messageBox :: HWND -> String -> String -> MBStyle -> IO MBStatus
messageBox wnd text caption style =
  withTString text $ \ c_text ->
  withTString caption $ \ c_caption ->
  failIfZero "MessageBox" $ c_MessageBox wnd c_text c_caption style
foreign import stdcall safe "windows.h MessageBoxW"
  c_MessageBox :: HWND -> LPCTSTR -> LPCTSTR -> MBStyle -> IO MBStatus

main :: IO ()
main = do
    mainInstance <- getModuleHandle Nothing
    hwnd <- createWindow_ 200 200 wndProc mainInstance
    createButton_ hwnd mainInstance
    messagePump hwnd

wndProc :: HWND -> WindowMessage -> WPARAM -> LPARAM -> IO LRESULT
wndProc hwnd wmsg wParam lParam
    | wmsg == wM_DESTROY = do
        sendMessage hwnd wM_QUIT 1 0
        return 0
    | wmsg == wM_COMMAND && wParam == 3 = do
        messageBox nullPtr "You pressed me." "Haskell msg" 0
        return 0
    | otherwise = defWindowProc (Just hwnd) wmsg wParam lParam

createWindow_ :: Int -> Int -> WindowClosure -> HINSTANCE -> IO HWND
createWindow_ width height wndProc mainInstance = do
    let winClass = mkClassName "Window Empty"
    icon <- loadIcon Nothing iDI_APPLICATION
    cursor <- loadCursor Nothing iDC_ARROW
    bgBrush <- createSolidBrush (rgb 255 0 0)
    registerClass (cS_VREDRAW + cS_HREDRAW, mainInstance, Just icon, Just cursor, Just bgBrush, Nothing, winClass)
    w <- createWindow winClass "Window Empty" wS_OVERLAPPEDWINDOW Nothing Nothing (Just width) (Just height) Nothing Nothing mainInstance wndProc
    showWindow w sW_SHOWNORMAL
    updateWindow w
    return w

createButton_ :: HWND -> HINSTANCE -> IO ()
createButton_ hwnd mainInstance = do
    hBtn <- createButton "Button test" wS_EX_CLIENTEDGE (bS_PUSHBUTTON + wS_VISIBLE + wS_CHILD) (Just 50) (Just 80) (Just 80) (Just 20) (Just hwnd) (Just (castUINTToPtr 3)) mainInstance
    return ()

messagePump :: HWND -> IO ()
messagePump hwnd = allocaMessage $ \ msg ->
    let pump = do
        getMessage msg (Just hwnd) `catch` \ _ -> exitWith ExitSuccess
        translateMessage msg
        dispatchMessage msg
        pump
    in pump 
```

原始链接在[这里](https://stackoverflow.com/questions/7304317/message-box-error-foreign-import-unsafe)

用法：复制/粘贴代码，将其保存在一个文件中，使用它进行编译，`ghc --make -optl-mwindows fileName.hs`它将创建一个漂亮的小窗口。这是基本的 C/C++ 像[这里](http://msdn.microsoft.com/en-us/library/bb384843.aspx)。

这个和下面的另外两个示例只是我可以找到用 Haskell 编写的**原始createWindow 代码:(**

我的反问：

*   我非常了解 C++ 过程。您创建来函数，如果某些 win_msg 为真，winProc 将调用它......
    但是，这不是唯一的方法。很快，MS 就把它放在了 mfc 类中。我们有 EventListeners，它们基本上做同样的事情。而不是直接测试您创建/添加事件监听器的 win_msg，传递所需的函数并且它可以工作。
    但是代码分组更好，更易于维护，并且更像 OO。

*   Haskell 用于 Haskellising winProc 的方法是什么？可能有一些方法可以模仿 addEventListener(evt, my_func)。
    那个代码会是什么样子？有多少种不同的解决方案？它可以使用吗？

*   更重要的是，是否有一些我不知道的类似 Haskell 的（更好的）方式？

*   您可以通过哪些方式使用该代码，对其进行一些改进并创建类似 wxWidgets 或 gtk 的东西，但极其简化、易于理解等。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T21:02:43.920

这是 createWindow 的第二个版本。[关联](http://darcs.brianweb.net/packages/Win32/examples/hello.lhs)

略有不同，但不幸的是没有任何评论，或解释为什么有些事情会这样。更不用说它已经13岁了！

[这](http://d.hatena.ne.jp/Otter_O/20090217/1234861028)是第三个。注意是日文，需要翻译。这三个只是我可以在网上找到的 Haskell win32 createWindow 文件！

没有评论，没有解释，什么都没有:(

```
%
% (c) sof, 1999
%

Haskell version of "Hello, World" using the Win32 library.
Demonstrates how the Win32 library can be put to use.

Works with Hugs and GHC. To compile it up using the latter,
do: "ghc -o main hello.lhs -syslib win32 -fglasgow-exts"

For GHC 5.03:

  ghc -package win32 hello.lhs -o hello.exe -optl "-Wl,--subsystem,windows"

\begin{code}
module Main(main) where

import qualified Graphics.Win32
import qualified System.Win32.DLL
import qualified System.Win32.Types
import Control.Exception (bracket)
import Foreign
import System.Exit
{-import Addr-}
\end{code}

Toplevel main just creates a window and pumps messages.
The window procedure (wndProc) we pass in is partially
applied with the user action that takes care of responding
to repaint messages (WM_PAINT).

\begin{code}
main :: IO ()
main =
  Graphics.Win32.allocaPAINTSTRUCT $ \ lpps -> do
  hwnd <- createWindow 200 200 (wndProc lpps onPaint)
  messagePump hwnd

{-
 OnPaint handler for a window - draw a string centred
 inside it.
-}
onPaint :: Graphics.Win32.RECT -> Graphics.Win32.HDC -> IO ()
onPaint (_,_,w,h) hdc = do
   Graphics.Win32.setBkMode hdc Graphics.Win32.tRANSPARENT
   Graphics.Win32.setTextColor hdc (Graphics.Win32.rgb 255 255 0)
   let y | h==10     = 0
         | otherwise = ((h-10) `div` 2)
       x | w==50     = 0
         | otherwise = (w-50) `div` 2
   Graphics.Win32.textOut hdc x y "Hello, world"
   return ()
\end{code}

Simple window procedure - one way to improve and generalise
it would be to pass it a message map (represented as a
finite map from WindowMessages to actions, perhaps).

\begin{code}

wndProc :: Graphics.Win32.LPPAINTSTRUCT
    -> (Graphics.Win32.RECT -> Graphics.Win32.HDC -> IO ()) -- on paint action
        -> Graphics.Win32.HWND
        -> Graphics.Win32.WindowMessage
    -> Graphics.Win32.WPARAM
    -> Graphics.Win32.LPARAM
    -> IO Graphics.Win32.LRESULT
wndProc lpps onPaint hwnd wmsg wParam lParam
 | wmsg == Graphics.Win32.wM_DESTROY = do
     Graphics.Win32.sendMessage hwnd Graphics.Win32.wM_QUIT 1 0
     return 0
 | wmsg == Graphics.Win32.wM_PAINT && hwnd /= nullPtr = do
     r <- Graphics.Win32.getClientRect hwnd
     paintWith lpps hwnd (onPaint r)
     return 0
 | otherwise =
     Graphics.Win32.defWindowProc (Just hwnd) wmsg wParam lParam

createWindow :: Int -> Int -> Graphics.Win32.WindowClosure -> IO Graphics.Win32.HWND
createWindow width height wndProc = do
  let winClass = Graphics.Win32.mkClassName "Hello"
  icon         <- Graphics.Win32.loadIcon   Nothing Graphics.Win32.iDI_APPLICATION
  cursor       <- Graphics.Win32.loadCursor Nothing Graphics.Win32.iDC_ARROW
  bgBrush      <- Graphics.Win32.createSolidBrush (Graphics.Win32.rgb 0 0 255)
  mainInstance <- System.Win32.DLL.getModuleHandle Nothing
  Graphics.Win32.registerClass
      ( Graphics.Win32.cS_VREDRAW + Graphics.Win32.cS_HREDRAW
      , mainInstance
      , Just icon
      , Just cursor
      , Just bgBrush
      , Nothing
      , winClass
      )
  w <- Graphics.Win32.createWindow
         winClass
         "Hello, World example"
         Graphics.Win32.wS_OVERLAPPEDWINDOW
         Nothing Nothing -- leave it to the shell to decide the position
                 -- at where to put the window initially
                 (Just width)
         (Just height)
         Nothing      -- no parent, i.e, root window is the parent.
         Nothing      -- no menu handle
         mainInstance
         wndProc
  Graphics.Win32.showWindow w Graphics.Win32.sW_SHOWNORMAL
  Graphics.Win32.updateWindow w
  return w

messagePump :: Graphics.Win32.HWND -> IO ()
messagePump hwnd = Graphics.Win32.allocaMessage $ \ msg ->
  let pump = do
        Graphics.Win32.getMessage msg (Just hwnd)
        `catch` \ _ -> exitWith ExitSuccess
    Graphics.Win32.translateMessage msg
    Graphics.Win32.dispatchMessage msg
    pump
  in pump

paintWith :: Graphics.Win32.LPPAINTSTRUCT -> Graphics.Win32.HWND -> (Graphics.Win32.HDC -> IO a) -> IO a
paintWith lpps hwnd p =
  bracket
    (Graphics.Win32.beginPaint hwnd lpps)
    (const $ Graphics.Win32.endPaint hwnd lpps)
    p

\end{code} 
```

# sql - 创建表时出现 SQL 错误

> ID：10800342
> 
> 赞同：0
> 
> 时间：2012-05-29T13:39:47.407
> 
> 标签：sql, phpmyadmin, create-table

我正在通过 phpMyAdmin 运行以下查询：

```
**CREATE TABLE folders (
  folder_id SERIAL NOT NULL,
  parent_id BIGINT,
  folder_name TEXT NOT NULL,
  PRIMARY KEY (folder_id),
FOREIGN KEY (parent_id) REFERENCES folders(folder_id) ON DELETE CASCADE
)ENGINE=InnoDB;** 
```

但它给出了以下错误：
**#1005 - Can't create table 'filesharingnew.folders' (errno: 150)** 知道我哪里错了吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T13:48:31.247

来自 MySQL 文档，[数字类型概述](http://dev.mysql.com/doc/refman/5.5/en/numeric-type-overview.html)：

> `SERIAL`是 的别名`BIGINT UNSIGNED NOT NULL AUTO_INCREMENT UNIQUE`。

您应该更改`parent_id`为`BIGINT UNSIGNED`使其与引用的列匹配。

# phppgadmin - 使用 phppgadmin 时的问题

> ID：10800345
> 
> 赞同：0
> 
> 时间：2012-05-29T13:39:50.173
> 
> 标签：phppgadmin

我正在尝试使用 phppgadmin 登录到 postgresql。但是，我每次都收到登录失败错误。可能是什么问题？我可以轻松地从控制台登录

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-30T01:29:50.263

检查 config.inc.php 文件中的行：

```
$conf['extra_login_security'] = false; 
```

如果真变假。

# git - 您如何删除 git 标签并通过 git pull 将所述删除传播给其他人？

> ID：10800348
> 
> 赞同：12
> 
> 时间：2012-05-29T13:40:06.250
> 
> 标签：git

由于大量不需要的分支和标签，我们目前正在清理我们的 git 存储库。

我们已经完成了分支部分，但标签部分证明很麻烦。

我们删除了远程分支，并要求我们的团队`git pull --prune`在他们的本地仓库中删除上述分支。

问题是，似乎没有办法用标签做到这一点。`git pull`我们可以很容易地远程删除标签，但是当我们执行 a ， or `gc`， or时，我们无法将该更改传播到其他本地存储库`remote prune`。

**关于如何做到这一点的任何想法？**

还是我们只需要阻止人们使用`git push --tags`，直到他们重新克隆回购？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-29T13:54:13.933

[你不能](http://schacon.github.com/git/git-tag#_on_re_tagging)。在远程删除的标签不会在本地删除`pull`/ `fetch`/etc。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-08-19T09:05:44.443

在旧版本的 Git 中，这似乎工作正常：

```
git fetch --tags --prune 
```

（但这不再适用于 Git 版本 1.9.0 或更高版本。）

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-29T13:57:11.587

我不认为有一种简单的方法可以通过推送删除标签，但是您可以指示您的人员删除他们所有的本地标签

```
for tag in $(git tag); do git tag -d ${tag}; done 
```

然后从主仓库中获取以同步那些应该保持活跃的。

我认为默认情况下没有任何理由推送标签，因为 git 中的标签非常坚不可摧，并且通常只针对类似重要里程碑的发布。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-10-02T06:12:20.340

因为“git fetch --tags --prune”对我不起作用，所以我将 che 的解决方案放入了一个对我来说很好的别名：

```
# update tags
ut = "!sh -c 'for tag in $(git tag); do git tag -d ${tag}; done; git fetch --tags'" 
```

# browser - favicon - 所有新浏览器在加载页面时都请求 favicon？

> ID：10800350
> 
> 赞同：1
> 
> 时间：2012-05-29T13:40:08.130
> 
> 标签：browser, favicon

`favicon.ico`所有新的浏览器和移动浏览器在加载页面时都会发出额外的请求？

并且从哪个版本的 Internet Explorer/Firefox，这个浏览器开始请求`favicon.ico`？

他们只在第一页加载或每个页面加载时这样做？

何时`favicon.ico`发生请求：a）页面加载时 b）页面加载后 c）加载页面之前？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T14:09:56.040

1.  所有主流浏览器都支持 favicon.ico。您可以使用链接标签以获得最佳效果：

    `<link rel="shortcut icon" href="http://example.com/myicon.ico" />`

2.  它从 IE5 开始。Firefox 大约 5 年后才发布，但 1.0 版也支持 favicon.ico。

3.  `favicon.ico`可以使用`<link>`标签指定请求顺序。您可以使用 Firefox 中的 Firebug 或 Safari 或 Chrome 中的 Web Inspector 来验证请求的顺序。

有关 Wikipedia 的更多信息：[Favicon](http://en.wikipedia.org/wiki/Bookmark_icon)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-06-23T21:56:54.073

woz的上述回答是正确的。但是，现在`"shortcut icon"`已被弃用，可以简单地使用`"icon"`如下：

```
<link rel="icon" href="favicon.ico" /> 
```

也不是必须使用`.ico`图像。所有最新的浏览器都支持 PNG 图标。您可以使用以下方法渲染它们：

```
<link href="favicon.ico" rel="icon" type="image/png" /> 
```

有时，浏览器的行为方式很奇怪。如果您只是交换标签中的`rel`和`href`属性的顺序`link`，浏览器会呈现网站图标。这发生在我的一个实时托管项目中。

# javascript - 在javascript中删除字符串中的空格

> ID：10800355
> 
> 赞同：145
> 
> 时间：2012-05-29T13:40:23.430
> 
> 标签：javascript, html, trim

我已经阅读[了这个](https://stackoverflow.com/questions/498970/how-do-i-trim-a-string-in-javascript)关于 javascript trim 的问题，带有正则表达式的答案。

然后我希望 trim 删除Hello 和 World 之间 的*内部空间。*

```
function myFunction() {
    alert("Hello World ".trim());
} 
```

**已编辑**

**为什么我会这么期待！？**

废话！显然修剪不会删除内部空间！，只有前导和尾随的，这就是修剪的工作原理，那么这是一个非常错误的问题，我很抱歉。

* * *

## 回答 #1

> 赞同：310
> 
> 时间：2012-05-29T13:43:23.280

对于空格字符删除使用

```
"hello world".replace(/\s/g, ""); 
```

对于所有空白，请在下面的评论中使用 Rocket 的建议！

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2020-04-10T12:25:33.977

您可以使用

```
"Hello World ".replace(/\s+/g, ''); 
```

`trim()`仅删除字符串上的尾随空格（链上的第一个和最后一个）。在这种情况下，此正则表达式更快，因为您可以同时删除一个或多个空格。

如果将替换空字符串更改为 '$'，区别会变得更加清晰：

```
var string= '  Q  W E   R TY ';
console.log(string.replace(/\s/g, '$'));  // $$Q$$W$E$$$R$TY$
console.log(string.replace(/\s+/g, '#')); // #Q#W#E#R#TY# 
```

性能比较 -`/\s+/g`更快。见这里：http: [//jsperf.com/s-vs-s](http://jsperf.com/s-vs-s)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-05-29T13:42:09.593

可能是因为您忘记[在接受的答案中实施解决方案](https://stackoverflow.com/a/498995/250259)。这就是使`trim()`工作正常的代码。

**更新**

此答案仅适用于较旧的浏览器。较新的浏览器显然原生支持`trim()`。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2019-08-19T21:41:00.010

您可以将字符串[替换](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/replace)方法与正则表达式一起使用。

`"Hello World ".replace(/ /g, "");`

> replace() 方法返回一个新字符串，其中模式的部分或全部匹配被替换替换。模式可以是字符串或正则表达式

[正则表达式](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/RegExp)

*   **//** - 正则表达式匹配空格

*   **g** - 全局标志；查找所有匹配项，而不是在第一个匹配项后停止

```
const str = "H    e            l l       o  World! ".replace(/ /g, "");
document.getElementById("greeting").innerText = str;
```

```
<p id="greeting"><p>
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2021-10-29T07:11:02.450

如果您只想替换空格，最好的方法是这样做：

```
let str = " H e l l o 1  5 9   ";
let onlyCharacters = str.replaceAll(" ", "");

// onlyCharacters = Hello159
```

我用`str.replace(/\s/g, "");`了很多，但它不适用于所有浏览器，例如它在 android 的 dadduckgo 中不起作用，在 android webview 中也不起作用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-07-21T11:21:27.577

您可以使用递归解决方案：

```
function removeWhitespaces(string, i = 0, res = "") {
  if (i >= string.length)
    return res
  else
  if (string[i] == " ")
    return removeWhitespaces(string, i + 1, res)
  else
    return removeWhitespaces(string, i + 1, res += string[i])
}

console.log(removeWhitespaces(" Hello World,   how is it going ? "))
```

# lucene - Lucene 中的 ""black lab*" "pet shop""~5 （多词短语的邻近搜索）

> ID：10800357
> 
> 赞同：1
> 
> 时间：2012-05-29T13:40:34.893
> 
> 标签：lucene, lucene.net

如何在 Lucene 中对两个多词短语进行邻近搜索。例如，我想查找所有包含“宠物店”一词的 5 个单词的所有黑色实验室*（黑色拉布拉多犬、黑色拉布拉多犬等）。我应该使用哪种分析仪？推荐使用哪种查询解析器？我正在使用 Lucene.NET。我已将 ComplexPhraseQueryParser 从 Java 移植到 C#，但该解析器似乎并没有起到作用（或者也许我只是用错了）。我刚刚开始使用 Lucene，非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-11T16:13:28.913

您可以为此使用[SpanQuery ：](http://www.lucidimagination.com/blog/2009/07/18/the-spanquery/)

```
new SpanNearQuery(
    new SpanQuery[] {
        new SpanNearQuery(
            new SpanQuery[] {
                new SpanTermQuery(new Term(FIELD, "black")),
                new SpanMultiTermQueryWrapper<WildcardQuery>(new WildcardQuery(new Term(FIELD, "lab*"))),
            },
            0,
            true),
        new SpanNearQuery(
            new SpanQuery[] {
                new SpanTermQuery(new Term(FIELD, "pet")),
                new SpanTermQuery(new Term(FIELD, "shop")),
            },
            0,
            true),
    },
    5,
    true); 
```

默认的 Lucene`QueryParser`不支持跨度查询，但您可以尝试使用[Surround 查询解析器](http://www.lucidimagination.com/blog/2009/02/22/exploring-query-parsers/)。我在文档中找不到太多其他内容。

您可能还会发现[此答案](https://stackoverflow.com/a/10412076/26003)和[此博客文章](http://www.lucidimagination.com/blog/2009/07/18/the-spanquery/)很有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T15:50:08.547

你只需要[设置 slop](http://lucene.apache.org/core/old_versioned_docs/versions/3_0_3/api/all/org/apache/lucene/search/PhraseQuery.html#setSlop%28int%29)。

# python - 无法在 Python 中加载程序集“Microsoft .VisualStu dio.TestTo ols.UITest ing”

> ID：10800359
> 
> 赞同：1
> 
> 时间：2012-05-29T13:41:02.560
> 
> 标签：python, .net, load, assemblies, python.net

我已经在 Ironpython 中自动化了我的整个框架，它工作得很好而且很稳定。

最近，我的公司实现了拖放功能以实现自动化。

我找到了一个 Dll('Microsoft.VisualStudio.TestTools.UITesting.dll')，它具有类 mouse，并且该类具有称为 mouse.startdragging() 和 mouse.stopdragging() 的方法。

但不幸的是，我无法添加此 Dll 的引用。我收到以下错误

" clr.AddReference("Microsoft.VisualStudio.TestTools.UITesting") System.IO.FileNotFoundException: 无法在 C 中的 Python.Runtime.CLRModule.AddReference(String name) 中找到程序集 'Microsoft.VisualStudio.TestTools.UITesting'。 \Users\Barton\Documents\Visual Studio 2008\Projects\PySharp\trunk\pythonnet\src\runtime\moduleobject.cs:line 375 "

如果有人可以帮助我，我将不胜感激，我正在我的项目中

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T07:59:34.920

编码的 UI 库不随 .NET 一起分发。它们随 Visual Studio Premium 及更高版本提供，并且许可证不允许您分发它们。

[如何在没有 Visual Studio 2010 Premium 的情况下运行编码的 UI 测试](https://stackoverflow.com/questions/3778871/how-to-run-coded-ui-tests-without-visual-studio-2010-premium)

您可以许可这些库，但这对于大多数部署方案而言在经济上是不切实际的。您应该使用不同的方法来实现拖放。

# sql-server - 翻译 SQL 语句时遇到问题

> ID：10800364
> 
> 赞同：1
> 
> 时间：2012-05-29T13:41:21.680
> 
> 标签：sql-server, linq-to-sql

我正在尝试翻译 SQL CASE 语句，但遇到了一些问题，希望能帮上忙。这是声明：

```
,SUM(CASE WHEN [Gads].[GadsEventTypeCode] IN ('D1', 'D2', 'D3', 'DP', 'PD', 'DM', 'D4')
    THEN [Allocation].[AllocatedEnergyMwh] ELSE 0 END / 
    CAST([Unit].[NetDependableCapacity] AS FLOAT)) AS Hrs_Derate 
```

这是我想出的，但“迷失在翻译中”：

如果`[Gads].[GadsEventTypeCode]`等于`'D1', 'D2', 'D3', 'DP', 'PD', 'DM', 'D4'`
，则`Hrs_Derate`等于以下各项之和：
`[Allocation].[AllocatedEnergyMwh] / [Unit].[NetDependableCapacity]`
否则`Hrs_Derate`等于零。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T13:52:41.533

您需要翻译三个元素：

1.  CASE 语句 - 这可以[用三元表达式来处理](http://www.codeproject.com/Articles/38264/How-to-Create-T-SQL-CASE-Statements-With-LINQ-To-S)，例如， `(cond) ? trueval : falseval`
2.  IN 子句 - 有一个 LINQ`.Contains`运算符可以检查一个元素是否包含在数组中。
3.  铸造 - 我相信铸造运算符是通过`System.Convert`.

有了这三个翻译规则，您将需要这样的东西（未经测试）：

```
var types = new [] { "D1", "D2", "D3", "DP", "PD", "DM", "D4" };

Hrs_Derate =
    ((types.Contains(gads.GadsEventTypeCode) ? allocation.AllocatedEnergyMwh : 0)
    / (Convert.ToFloat(unit.NetDependableCapacity))).Sum() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T14:20:54.880

你不完全在那里。

“如果 [Gads].[GadsEventTypeCode]**等于**'D1'、'D2'、'D3'、'DP'、'PD'、'DM'、'D4'”

这将检查是否`GadsEventTypeCode`是*任何*列出的值。

“那么 Hrs_Derate 等于：[Allocation].[AllocatedEnergyMwh] / [Unit].[NetDependableCapacity] 之和”

这涵盖了其余部分。about 位`ELSE 0`会导致它忽略不满足`GadsEventTypeCode`条件的行，即添加零不会影响`SUM`. A`NULL`也可以。

# mysql - 如何将 MySQL 日期格式更改为字符串日期

> ID：10800369
> 
> 赞同：1
> 
> 时间：2012-05-29T13:41:54.477
> 
> 标签：mysql

> 2012-02-14?

如何修改上述 MYSQL 语句以将日期格式化为字符串日期格式，即

> 2012 年 2 月 2 日？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-29T13:44:38.377

使用 MySQL 的[`DATE_FORMAT()`](http://dev.mysql.com/doc/en/date-and-time-functions.html#function_date-format)功能：

```
SELECT DATE_FORMAT('2012-02-14', '%Y-%b-%d'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T13:45:16.483

MYSQL[日期格式](http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_date-format)函数。

DATE_FORMAT(<your_date_field>, '%Y-%b-%d')

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-29T13:45:33.207

看看 MySQLs [`DATE_FORMAT`](http://dev.mysql.com/doc/refman/5.1/en/date-and-time-functions.html#function_date-format)，它为您提供了很多可能性来根据您的需要格式化给定的日期。

例子：

```
SELECT DATE_FORMAT('2012-02-14', "%Y-%b-%m"); 
```

结果：

```
2012-Feb-02 
```

...如果您真的想要大写字母的月份缩写（又名`FEB`而不是`Feb`，就像您的示例结果一样），只需将其包裹[`UPPER`](http://dev.mysql.com/doc/refman/5.1/en/string-functions.html#function_upper)起来：

```
SELECT UPPER(DATE_FORMAT('2012-02-14', "%Y-%b-%m")); 
```

结果：

```
2012-FEB-02 
```

# c++ - ARM 设备上代码优化的 C++ 技巧

> ID：10800372
> 
> 赞同：18
> 
> 时间：2012-05-29T13:42:01.653
> 
> 标签：c++, optimization, arm

我一直在为 ARM 设备上的增强现实开发 C++ 代码，代码的优化对于保持良好的帧速率非常重要。为了将效率提高到最高水平，我认为收集使编译器的生活更轻松并减少程序循环次数的一般技巧很重要。欢迎任何建议。

1-**避免高成本指令**：除法、平方根、sin、cos

*   使用逻辑移位除以或乘以 2。
*   尽可能乘以倒数。

2-优化**内部“for”循环**：它们是一个瓶颈，所以我们应该避免在内部进行很多计算，尤其是除法、平方根。

3-对一些数学函数（sin、cos、...）使用**查找表**

**有用的工具**

*   objdump：获取已编译程序的汇编代码。这允许比较两个函数并检查它是否真的被优化。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-05-29T16:27:18.810

为了回答您在为 ARM 优化 C++ 代码时有关一般规则的问题，这里有一些建议：

1）正如你所提到的，没有除法指令。尽可能使用逻辑移位或乘以倒数。
2）内存比CPU执行慢很多；使用逻辑操作来避免小型查找表。
3) 尝试一次写入 32 位，以充分利用写入缓冲区。写短裤或字符会大大减慢代码速度。换句话说，将较小的位进行逻辑或并将它们写为 DWORDS 会更快。
4) 注意你的 L1/L2 缓存大小。一般来说，ARM 芯片的缓存比英特尔小得多。
5) 尽可能使用 SIMD (NEON)。NEON 指令非常强大，对于“矢量化”代码，可以非常快。NEON 内在函数在大多数 C++ 环境中都可用，其速度几乎与编写手动调整的 ASM 代码一样快。
6）使用缓存预取提示（PLD）来加速循环读取。ARM 没有现代英特尔芯片那样的智能预缓存逻辑。
7) 不要相信编译器会生成好的代码。查看 ASM 输出并重写 ASM 中的热点。对于位/字节操作，C 语言不能像在 ASM 中那样有效地指定事物。ARM 具有强大的 3 操作数指令、多重加载/存储和“自由”移位，其性能优于编译器能够生成的内容。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-05-29T13:44:03.397

优化应用程序的最佳方法是使用好的分析器。编写考虑效率的代码总是一个好主意，但您也希望避免在您“认为”代码可能很慢的地方进行更改，如果您不是 100% 确定，这可能会使事情变得更糟。

找出瓶颈在哪里并专注于这些。

对我来说，分析是一个迭代过程，因为通常当你修复一个瓶颈时，其他不太重要的瓶颈就会显现出来。

除了对 SW 进行分析之外，还要检查可用的硬件分析类型。检查您是否可以获得不同的硬件指标，例如缓存未命中、内存总线访问等。这对于了解您的内存总线或缓存是否是瓶颈也非常有帮助。

我最近问了这个类似的问题并得到了一些很好的答案：[寻找低影响的 c++ 分析器](https://stackoverflow.com/q/10433971/1158895)

# ruby-on-rails - 测试失败，即使它正在测试的东西正在通过

> ID：10800378
> 
> 赞同：0
> 
> 时间：2012-05-29T13:42:16.380
> 
> 标签：ruby-on-rails, testing, rspec, integration-testing, factory-bot

我的讨论在多态上属于项目、任务和子任务。当用户点击链接“完成讨论”时，讨论模型的布尔属性从假变为真。

我用下面的规范对此进行了 TDD 编辑，尽管布尔值确实发生了变化，但规范没有说，期望 false 为真。

这是下面的规格。它在第 73 行失败，说预期的错误为真。所以我的想法是我写错了规范。

```
 5   let!(:user) { FactoryGirl.create(:confirmed_user) }
  6   let!(:project) { FactoryGirl.create(:project) }
  7   let!(:task) { FactoryGirl.create(:task, :project => project) }
  8   let!(:subtask) { FactoryGirl.create(:subtask, :task => task) }
  9   let!(:discussion_for_subtask) { FactoryGirl.create(:discussion,
 10                                                      :user => user,
 11                                                      :discussionable => subtask) }
 15 
 16   before do
 17     sign_in_as!(user)
 18     user.projects << project
 19   end

 68     it 'should be able to finish the discussion if they started it/are admin' do
 69       visit subtask_discussions_path(subtask)
 70       click_link "#{discussion_for_subtask.name}"
 71       current_path.should == subtask_discussion_path(subtask, discussion_for_subtask)
 72       click_link 'Finish discussion'  
 73       discussion_for_subtask.finished.should == true
 74       current_path.should == subtask_discussions_path(subtask)
 75     end 
```

这是我的工厂（使用 FactoryGirl ）：

```
 1 FactoryGirl.define do      
 16 
 17   # USER                   
 18   factory :user do         
 19 
 20     sequence(:name) do |n|
 21       "Name#{n}"           
 22     end  
 23     sequence(:email) do |n|
 24       "FactoryEmailNumber#{n}@example.com"
 25     end                    
 26     password 'secret'      
 27     password_confirmation 'secret'  
 28 
 29     factory :confirmed_user do
 30       after_create do |user|
 31         user.confirm!
 32       end
 33     end
 34 
 35   end
105   # SUBTASK
106   factory :subtask do
107     sequence(:name) do |n|
108       "Subtask - #{n}"
109     end
110     task
111   end
112 
113   # DISCUSSION
114   factory :discussion do
115     sequence(:name) do |n|
116       "Discussion No#{n}"
117     end
118     description "Description for the discussion"
119   end 
```

请注意，我没有在工厂中添加“完成”属性，因为我在迁移中选择了默认值为 false。

编辑：这是当用户单击链接时将属性从 false 更改为 true 的操作（来自讨论控制器）：

```
 33   def finish
 34     if current_user.discussions.include?(@discussion)
 35       @discussion.update_attribute(:finished, true)
 36       redirect_to polymorphic_path([@parent, Discussion])
 37       flash[:notice] = "it worked #{@discussion.finished}"
 38     else
 39       flash[:alert] = 'You must be an admin to do that'
 40     end
 41   end 
```

你在第 37 行看到这个@discussion.finished 了吗？返回 true，当我使用 save_and_open_page 手动查看它时...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T15:25:49.857

好的，我从 IRC 的一个人那里得到了答案（名字很匆忙）。**无论如何，规范没有通过的全部原因是因为我没有重新加载 discussion_for_subtask 实例**。下面是有效的代码......干杯！

```
 68     it 'should be able to finish the discussion if they started it/are admin' do
 69       visit subtask_discussions_path(subtask)
 70       click_link "#{discussion_for_subtask.name}"
 71       current_path.should == subtask_discussion_path(subtask, discussion_for_subtask)
 72       click_link 'Finish discussion'  
 73       # the following reload is needed so the instance knows about the change you put it through
 74       discussion_for_subtask.reload   
 75       discussion_for_subtask.finished.should == true
 76       current_path.should == subtask_discussions_path(subtask)
 77     end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T13:47:37.490

您说“注意，我没有在工厂中添加 'finished' 属性，因为我在迁移中选择了默认值为 false。”

因此，在您的规范中，discussion_for_subtask.finished 是错误的。

该行`discussion_for_subtask.finished.should == true`失败

# javascript - 在 JavaScript 中获取随机数的最佳方法是什么

> ID：10800379
> 
> 赞同：1
> 
> 时间：2012-05-29T13:42:20.317
> 
> 标签：javascript, math, random

我需要在我正在开发的游戏中获得一个非常随机的数字。问题是 Math.random() 得到完全相同的结果，因为它基于时间戳，我使用它来随机定位游戏对象，我需要立即获得随机位置。有比 Math.random() 更好的方法吗？

[https://github.com/suprMax/monkyTime/blob/master/static/monkytime.js#L201](https://github.com/suprMax/monkyTime/blob/master/static/monkytime.js#L201)

对象的位置非常接近。我试图让它更随机地从请求动画帧中窃取高精度时间，但无济于事。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T13:49:06.327

随机生成器从当前时间播种并不会使其返回相同结果的事实是后续调用。每次调用它时，它都会为自己播种新值，它只是受时钟影响的初始值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T13:45:45.230

如果`Math.random()`不够随机（它是伪随机数生成器），则使用真正的随机生成器。

它需要使用一些远程数据来获得足够的熵（例如鼓风机中的球、白噪声等）。您可能需要为此创建或使用现有服务。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-29T13:52:09.713

大多数浏览器中的伪随机数生成器应该足以在游戏中定位对象。当然，如果您正确实施它，您不应该一遍又一遍地得到相同的结果。

如果您绝对需要结果不可预测（例如密码学），您需要研究[密码安全的 PRNGs](http://en.wikipedia.org/wiki/Cryptographically_secure_pseudorandom_number_generator)。

# python - Scapy 和 rdpcap 函数

> ID：10800380
> 
> 赞同：8
> 
> 时间：2012-05-29T13:42:20.967
> 
> 标签：python, networking, pcap, packet-capture, scapy

我正在使用`rdpcap`Scapy 的功能来读取 PCAP 文件。我还使用了[Scapy 中的 HTTP 支持链接中](http://blog.sbarbeau.fr/2011/06/http-support-in-scapy.html)描述的模块，这在我的情况下是必需的，因为我必须检索所有 HTTP 请求和响应以及它们的相关数据包。

我注意到解析大型 PCAP 文件时，该`rdpcap`函数需要花费太多时间来读取它。

有没有`pcap`更快读取文件的解决方案？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2016-06-22T09:41:11.283

Scapy 还有另一种方法`sniff`，您也可以使用它来读取 pcap 文件：

```
def method_filter_HTTP(pkt):
    #Your processing

sniff(offline="your_file.pcap",prn=method_filter_HTTP,store=0) 
```

`rdpcap`将整个 pcap 文件加载到内存中。因此它使用了大量的内存，正如你所说的它很慢。While`sniff`一次读取一个数据包并将其传递给提供的`prn`函数。该`store=0`参数确保数据包在处理后立即从内存中删除。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-05-30T14:04:16.847

虽然我同意加载时间比预期的要长，但这可能是因为正在解析文件以生成一组高度组合的对象。我必须做的是`editcap`用来切碎数据包捕获，以使阅读它们更容易一些。例如：

```
$ editcap -B 2013-05-2810:05:55 -i 5 -F libpcap inputcapture.pcap outputcapture.pcap 
```

[请注意：此处](http://www.wireshark.org/docs/wsug_html_chunked/AppToolseditcap.html)提供了此命令开关的完整说明。

此外，这`-F libpcap`部分似乎是必要的（至少对我而言）以获得`pcap`能够解析文件的 scapy 函数。（这应该是默认的 pcap 文件输出格式，但无论出于何种原因，这对我来说不是这种情况。您可以使用`capinfos`（例如，只需 enter `capinfos your_capture.pcap`）验证输入和输出文件的文件类型。

两者`capinfos`都`editcap`可以在 WireShark 发行版中使用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-12-17T12:41:47.200

从 Scapy 2.4.3 开始，它内置了[解析 HTTP](https://scapy.readthedocs.io/en/latest/layers/http.html)会话的支持。它可以与`sniff()` [会话](https://scapy.readthedocs.io/en/latest/usage.html#advanced-sniffing-sniffing-sessions)功能一起使用。例如

```
pkts = sniff(offline="http_chunk.pcap.gz", session=TCPSession, store=0) 
```

当使用`TCPsession`HTTP/1 捕获的功能时，它会返回一个“数据包”列表，其中包含来自构成每个 HTTPRequest、HTTPResponse 的所有底层数据包的组装数据。它还将返回单个数据包，例如 Ack 数据包。因此，例如，检查“数据`haslayer(HTTPResponse)`包”是否包含整个响应有效负载。也可以使用该[`answers()`](https://scapy.readthedocs.io/en/latest/api/scapy.layers.http.html?highlight=answers#scapy.layers.http.HTTPResponse.answers)功能来匹配请求和响应。请注意，您可以使用`sniff()`实时捕获、`offline`数据包捕获或数据包列表。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-05-16T05:09:07.813

如果您正在寻找响应更快的代码，请考虑使用`PcapReader()`而不是`rdpcap()`.

`PcapReader()`创建一个生成器并仅在需要时加载数据包，而不是`rdpcap()`将整个跟踪加载到内存中。`PcapReader()`因此，非常适合需要永远加载的大型跟踪`rdpcap()`，或者抛出 a`MemoryError`因为它对您的系统来说太大了。

示例代码：

```
packets = PcapReader('filename.pcap')
for packet in packets:
    mac_src = packet[Ether].src
    mac_dst = packet[Ether].dst
    ... 
```

请参阅`PcapReader()` [文档](https://scapy.readthedocs.io/en/latest/api/scapy.utils.html#scapy.utils.PcapReader)以获取更多信息。

如果您只关心获得最终输出需要多长时间，那么`rdpcap()`可能比 具有优势`PcapReader()`，尽管我不确定差异的大小。

# asp.net - ASP.Net 参考访问数据库

> ID：10800383
> 
> 赞同：1
> 
> 时间：2012-05-29T13:42:27.843
> 
> 标签：asp.net, visual-studio, visual-studio-2008

在 ASP.Net 中，从我的电脑中引用我的 Access 数据库可以如下完成：

```
Dim cn As New OleDbConnection("Provider = Microsoft.JET.OLEDB.4.0;" & "Data Source = C:/Class.mdb") 
```

如果我要将它放入我的项目 App_data 文件夹中，我该如何引用它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T13:49:24.570

我相信你想要的是 DataDirectory。你的字符串看起来像这样：

```
"Provider=Microsoft.JET.OLEDB.4.0;Data Source=|DataDirectory|\Class.mdb" 
```

更多连接字符串[在这里](http://www.connectionstrings.com/access)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T13:47:50.750

当然，您可以使用以下格式：Data Source=|DataDirectory|Foobar.sdf。有关详细信息，请参阅此问题 - [SQL Server Compact 文件在哪里？](https://stackoverflow.com/questions/7343113/where-is-the-sql-server-compact-file)

# javascript - 是否可以创建 html 文本作为文本到语音文本字段的字符串输入？

> ID：10800386
> 
> 赞同：0
> 
> 时间：2012-05-29T13:42:31.087
> 
> 标签：javascript, ios5, xcode4

我在[http://zaldzbugz.posterous.com/how-to-search-a-string-inside-uiwebview](http://zaldzbugz.posterous.com/how-to-search-a-string-inside-uiwebview)使用 javascript 程序来解析 html 页面和以下方法

```
-(void)speakText:(NSString *)text
{

    NSString *filePath  = [[NSBundle mainBundle] pathForResource:@"UIWebViewSearch" ofType:@"js" inDirectory:@""];
    NSData *fileData    = [NSData dataWithContentsOfFile:filePath];
    NSString *jsString  = [[NSMutableString alloc] initWithData:fileData encoding:NSUTF8StringEncoding];
    text =jsString;
    NSMutableString *cleanString;
    cleanString = [NSMutableString stringWithString:@""];
    if([text length] > 1)
    {
        int x = 0;
        while (x < [text length])
        {
            unichar ch = [text characterAtIndex:x];
            [cleanString appendFormat:@"%c", ch];
            x++;
        }
    }
    if(cleanString == nil)
    {   // string is empty
        cleanString = [NSMutableString stringWithString:@""];
    }
    sound = flite_text_to_wave([cleanString UTF8String], voice);
    NSArray *filePaths = NSSearchPathForDirectoriesInDomains (NSDocumentDirectory, NSUserDomainMask, YES);
    NSString *recordingDirectory = [filePaths objectAtIndex: 0];
    // Pick a file name
    NSString *tempFilePath = [NSString stringWithFormat: @"%@/%s", recordingDirectory, "temp.wav"];
    // save wave to disk
    char *path; 
    path = (char*)[tempFilePath UTF8String];
    cst_wave_save_riff(sound, path);
    // Play the sound back.
    NSError *err;
    [audioPlayer stop];
    audioPlayer =  [[AVAudioPlayer alloc] initWithContentsOfURL:[NSURL fileURLWithPath:tempFilePath] error:&err];
    [audioPlayer setDelegate:self];
    //[audioPlayer prepareToPlay];
    [audioPlayer play];
    // Remove file
    [[NSFileManager defaultManager] removeItemAtPath:tempFilePath error:nil];
    delete_wave(sound);

} 
```

将文本转换为语音字符串输入。，我在文本字段中听到一些编码格式而不是 html 文本（当我执行 NSLog(jsstring) 时，我得到了整个 javascript 代码，我猜它在语音输出中是一样的）。因为我有很短的时间来解决，请帮帮我...提前谢谢..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T14:40:23.930

您的代码将 JavaScript 文件转换为语音，在您的代码中您不会加载 HTML 文件，更不用说从中过滤文本了。我也怀疑您提到的 JavaScript 程序是否真的可以帮助您实现这一点，对我来说，它看起来只适合在您已经知道的页面上查找和突出显示部分文本。

我建议您查看`NSScanner`（[Apple 文档](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/Strings/Articles/Scanners.html)），您可以使用它来过滤 HTML 文件中的相关位，而无需使用外部 JavaScript 程序。不过，这需要一些摆弄。如果你有完美的 HTML，`NSXMLParser`那将是一个更简单的解决方案，但我不确定你是否可以依赖它。第三方框架可能有现成的解决方案，但不幸的是，我无法就此提供建议。Stack Exchange 上的这个问题也可能有帮助：[extract the text only from html content in objective C](https://stackoverflow.com/q/9659868/1369617)

不管 HTML 解析如何，无论如何，您的代码中都会发生一些奇怪的事情。例如，当您稍后覆盖四行而不触及它时，为什么要将`(NSString *) text`其作为方法的参数？以及为什么麻烦的逐个字符复制into ？`speakText:``text``text``cleanString`

# sql-server - SQL Server 并行性和 OLTP 系统？

> ID：10800388
> 
> 赞同：0
> 
> 时间：2012-05-29T13:42:39.247
> 
> 标签：sql-server, sql-server-2008

许多在线博客我看到一个建议，说并行性适用于数据仓库系统，而不适用于 OLTP 系统。许多专家甚至建议通过在 OLTP 环境中将最大并行度设置为 1 来关闭并行度。我正在尝试为此类建议寻找依据，我的猜测是因为 OLTP 系统会受到许多并发请求的影响，从而使 CPU 处于忙碌状态；查询优化器使用的并行性可能是一种开销。

然而，并行不是一个福音。通过允许多个线程处理请求，我们可以减少查询处理时间。

试图更深入地研究并行性。关于 OLTP 系统中的并行性的任何建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T13:53:26.203

SQL Server 只会为昂贵的查询引入并行性。典型的 OLTP 查询根本不受影响。

小心使用全局 MaxDOP 设置，而不要确切了解正在运行的工作负载以及该设置对它的作用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T13:53:47.643

在 OLTP 中，您的插入通常是小型、快速的事务，在某些情况下甚至可能是非日志操作。

同样在 OLTP 中，查询是典型的点查询，这意味着查询将返回单行或非常小的行集。OLTP 数据库通常可以包含在内存中（表和索引），因为旧数据不是 OLTP 系统感兴趣的东西。

大多数人不在 OLTP 数据库中执行任何 DSS 类型查询。额外的索引、磁盘 I/O 等会干扰缓存/任务切换，并且会损害 OLTP 性能，这更多地基于延迟。

当您进行数据仓库类型处理时，您会查看数据范围、一天的过程、一周/月/年/等的平均值。这就是并行查询有意义的地方。分解问题，将它们交给工作线程并合并结果。

需要进行一些设置才能从中获得任何真正的好处，分区、多核/多处理器 CPU、适当的磁盘控制器/路径、raid 阵列或缓存前端磁盘存储（如 EMC）。它们是为两个完全问题集而设计的。

# java - 在 Jetty 服务器上运行时区转换不起作用

> ID：10800391
> 
> 赞同：0
> 
> 时间：2012-05-29T13:42:50.593
> 
> 标签：java, timezone, jetty

我用Java制作了一个时区转换脚本。当我运行它时，它完成并且我得到了输出。当我在**Jetty 服务器**上运行相同的代码时，我遇到了一些问题。

例如系统时间 2012/05/29 18:36:41

转换为“Pacific/Apia(-11)”给出输出：Wed May 30 02:06:41 IST 2012

“Pacific/Honolulu(-10)”给出了输出：Tue May 29 03:07:04 IST 2012

“Etc/GMT+12(-12)”给出了输出：Tue May 29 01:07:37 IST 2012

是什么导致“Pacific/Apia(-11)”的输出？这是不正确的。

# css - 元素的CSS位置不移动

> ID：10800396
> 
> 赞同：0
> 
> 时间：2012-05-29T13:43:18.107
> 
> 标签：css

我们的 Flash 游戏开发组合可以在这里看到：http: [//www.letsdesign.co.uk/index.html](http://www.letsdesign.co.uk/index.html)

这是设计的 CSS 样式表：http: [//www.letsdesign.co.uk/rw_common/themes/a_viator/styles.css](http://www.letsdesign.co.uk/rw_common/themes/a_viator/styles.css)

请查看新闻代码，它有点太低了，需要向上移动 5 个像素。我无法找到更改此元素（也称为 extraContainer2）位置的位置。

有谁知道是什么让它看起来像这样，以及如何将新闻代码文本向上移动一点？

提前感谢您的所有帮助，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T13:46:19.310

尝试改变这部分：

```
.alignNav {
  text-align: right;
  position: relative;
  padding-top: 6px;
  height: 105px;
} 
```

高度之前一直是110px。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T13:49:21.497

那是因为`.alignNav`太高了

```
.alignNav {
     text-align: right;
    position: relative;
    padding-top: 6px;
    height: 110px;
} 
```

将它的高度设置为 100px，或者给 extraContainer2 相对定位与负顶部将解决问题

```
#extraContainer2
{
    position: relative;
    top: -5px;
} 
```

# database - 为什么 cakephp 抛出数据库错误？

> ID：10800401
> 
> 赞同：0
> 
> 时间：2012-05-29T13:43:23.117
> 
> 标签：database, cakephp, model

当我尝试将新发票插入数据库时​​，cakephp 抛出错误，指出在 where 子句中找不到列 relationship.partytwo。我想要实现的是确保发送发票的用户与在发送发票之前接收发票的人在关系用户数据库中具有活动关系，遗憾的是我得到的只是数据库错误。

这是我的表格的结构

```
invoices - id, to, biller, subject, description, datecreated, duedate
relationships_users - id, partyone, partytwo, expirydate,active 
```

这是关系模型

```
 <?php

class Relationship extends AppModel
{

    var $name = 'Relationship';
    public $useTable = 'relationships_users';
    public $primaryKey = 'id';
    public $belongsTo = array(
        'Invoice' =>
            array(
                'className'              => 'Invoice',
                'joinTable'              => 'invoice',
                'foreignKey'             => 'invoice_id'));
    public $belongsTo = array(
        'User' =>array(
            'className' => 'User',
            'foreignKey' =>'partyone','partytwo',
            'associationForeignKey'  => 'username',
            )); 

    var $validate = array(
        'date' => array(
            'rule' => array(
                'datevalidation',
                'systemDate'
            ),
            'message' => 'Current Date and System Date is mismatched'
        ),
        'partytwo' => array(
            'userExists' => array(
                'rule' => array(
                    'userExists',
                ),
                'message' => 'That username doesnt exist.'
            ),
        ),
    );

    function datevalidation($field = array(), $compare_field = null)
    {
        if ($field['date'] > $compare_field)
            return TRUE;
        else
            return FALSE;
    }

    function userExists($check)
    {   
        $userExists = $this->User->find('count', array('conditions' => array('User.username'=>$check)));
        if ($userExists == 1) {
           return TRUE;
        }
        else
            return FALSE;
    }

} 
```

这是我的发票模型

```
 <?php
App::uses('AuthComponent', 'Controller/Component');

class Invoice extends AppModel{ 
        var $name='Invoice'; 
        public $useTable = 'invoices';
        public $primaryKey = 'id';
        public $hasMany = array(
        'Relationship' =>array(
            'className' => 'Relationship',
            'foreignKey' =>'relationship_id',
        )); 
        var $validate = array(
            'to' => array(
                'relationshipExists' => array(
                    'rule' => array(
                        'relationshipExists',
                        ),
                    'message' => 'sorry you dont have a relationship with that user.'
                    ),
                ),
            );

        public function relationshipExists($check){ 
            if($this->hasAny(array('Relationship.partytwo'=>current($check))))
            {
                return TRUE;
            }
            else
            {
                return FALSE;
            }
        }

    } 
```

这是我的附加发票功能

```
public function addinvoice(){
    $this->set('title_for_layout', 'Create Invoice');
    $this->set('stylesheet_used', 'homestyle');
    $this->set('image_used', 'eBOXLogoHome.jpg');   
    $this->layout='home_layout';

    if($this->request->is('post')){
        pr($this->Invoice->set($this->request->data));
        if($this->Invoice->validates(array('fieldList'=>array('to','Invoice.relationshipExists')))){
        //  $this->Relationship->create();
            $this->Invoice->save($this->request->data); 
            $this->Session->setFlash('The invoice has been saved');  
      }}else { 
                $this->Session->setFlash('The invoice could not be saved. Please, try again.');
             }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T13:51:16.870

`hasMany`外键应该在另一个*表*中。如果`Relationship` *hasMany* `Invoices`，则`Invoices`必须有外键`relationship_id`。

似乎您要建模的是 a `belongsTo`，其中 a `Relationship` *belongsTo* an `Invoice`，这意味着外键在`Relationship`模型/表中。

# wpf - WPF 无法使用 MVVM 从主窗口刷新用户控件

> ID：10800404
> 
> 赞同：0
> 
> 时间：2012-05-29T13:43:32.507
> 
> 标签：wpf, wpf-controls

> 这是我的模型

```
public class PersonModel : INotifyPropertyChanged
{ 
    private string _firstname;
    public string FirstName 
    { 
        get {return _firstname; }
        set { _firstname = value; RaisePropertyChanged("FirstName"); } 
    }

    private string _lastname;
    public string LastName
    {
        get { return _lastname; }
        set { _lastname = value; RaisePropertyChanged("LastName"); }
    } 

    public string FullName 
    {
        get { return string.Format("{0} {1}", FirstName, LastName); } 
    }

    protected void RaisePropertyChanged(string propertyName)
    {
        var handler = PropertyChanged;
        if (handler != null)
        {
            handler(this, new PropertyChangedEventArgs(propertyName));
        }
    }

    public event PropertyChangedEventHandler PropertyChanged;
} 
```

> 我有一个基本上是用户控件的视图

```
<UserControl x:Class="WpfApplication1.UserControl1"
         xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
         xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
         xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
         xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
         xmlns:local="clr-namespace:WpfApplication1"             
         mc:Ignorable="d"            
         d:DesignHeight="300" d:DesignWidth="300"                
         Visibility="{Binding HideStatus, Mode=TwoWay}">
<UserControl.DataContext>
    <local:PersonViewModel></local:PersonViewModel>
</UserControl.DataContext>  
     <Grid>      
    <Grid.RowDefinitions>
        <RowDefinition Height="117*"></RowDefinition>
        <RowDefinition Height="33*"></RowDefinition>
        <RowDefinition Height="75*"></RowDefinition>
        <RowDefinition Height="75*"></RowDefinition>
    </Grid.RowDefinitions>
    <TextBlock Grid.Row="0" Text="FirstName"></TextBlock>
    <TextBox Text="{Binding FirstName,Mode=TwoWay}" Name="txtFirstName" Margin="115,0,0,67" DataContext="{Binding Path=Person}" Background="#FFF0F0F0" />
    <TextBlock Text="FirstName" Margin="0,71,0,0" Grid.RowSpan="2"></TextBlock>
    <TextBox Text="{Binding LastName,Mode=TwoWay}" Name="txtLastName" Margin="115,90,0,12" Background="#FFF0F0F0" DataContext="{Binding Path=Person}" Grid.RowSpan="2" />
    <Button Grid.Row="3" Content="Button" Height="29" HorizontalAlignment="Left" Margin="12,23,0,0" Name="button1" VerticalAlignment="Top" Width="75" Command="{Binding UpdateView}" />
</Grid> 
```

> 在有一个按钮“从主 UI 更新”和我们已经创建的用户控件的主窗口中

```
<Window x:Class="WpfApplication1.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="clr-namespace:WpfApplication1"
    Title="MainWindow" Height="350" Width="525"

    xmlns:model="clr-namespace:WpfApplication1"
    >
<Grid>
    <Grid.DataContext>
        <local:PersonViewModel/>
    </Grid.DataContext>
    <local:UserControl1 x:Name="control1" />
    <Button Content="Update From Main UI" Height="23" Command="{Binding UpdateView}" HorizontalAlignment="Left" Margin="358,276,0,0" Name="button1" VerticalAlignment="Top" Width="145" />
</Grid> 
```

> 问题是，如果我单击用户控件内的按钮，它会刷新更改，但是当我尝试从主窗口单击按钮时，没有发生同样的事情。问题是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T17:37:47.910

您的`DataContext`主窗口是另一个类实例，而`PersonViewModel`不是`DataContext`您的 UserControl。因此，`UpdateView`从主窗口执行不会更新您的 UserControl。

你应该在你的主窗口中写下这个：

```
<Button Command="{Binding Path=DataContext.UpdateView, ElementName=control1}" ... /> 
```

通过`ElementName`，您告诉 Binding 引用用户控件。通过`DataContext.UpdateView`，您指的是用户控件的`UpdateView`命令。

# r - 从复杂网络/SNA 开始。将数据集转换为预期格式

> ID：10800408
> 
> 赞同：0
> 
> 时间：2012-05-29T13:43:43.583
> 
> 标签：r, data-mining, complex-networks, sna

我刚刚开始掌握复杂网络和社交网络分析背后的想法和技术。我似乎总是在数据准备阶段绊倒并陷入困境。我经常在 Google Refine 中有一个数据集，它基本上是一堆以某种方式相关的行。例如，目前我有一份他们参加过的组织和活动的列表（有些重复，因为一个组织可能派了多个代表参加活动）

![我的 Google 优化数据](../Images/621aa2c1d4040fc707aa70c5258e3a5f.png)

所以我可以看到组织将是我图表上的节点，并且如果他们都参加了同一个活动，它们之间的关系就存在，但是我不知道我如何将这个数据集转换为 NWB、Gephi 等工具的格式， R 或 Tulip 会理解。

我经常发现自己有一个数据集，我可以看到列之间的关系，但我不知道下一步应该采取哪些步骤来准备我的数据，以便通过此类工具导入以探索关系。我浏览了支持文件类型的文档，我的猜测是在 Refine 中使用 RDF 骨架工具做一些事情并采用链接数据样式方法可能是一个可能的解决方案，但我没有运气。

任何有关数据准备的提示将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T21:16:26.533

以防万一有人在未来偶然发现这一点。我通过在 R 中导入我的 CSV 并创建一个模式矩阵来创建这个，然后创建一个基于此的图表。

```
organisations_events<-read.csv("/Users/David/Desktop/PhD/R_github/ROI/data/Ins_Event.csv" , header=T, sep=",")

df<-read.csv("/Users/David/Desktop/PhD/R_github/ROI/data/Ins_Event.csv" , header=T,     sep=",")

M = as.matrix( table(df) )

Mrow = M %*% t(M)

#Mcol = t(M) %*% M

write.csv(Mrow, "test.csv") 
```

如果有帮助，请在此处记录答案.. [http://www.davidsherlock.info/network-analysis](http://www.davidsherlock.info/network-analysis)

# sql - SQL Server 中的 Isnull 和数据类型

> ID：10800409
> 
> 赞同：1
> 
> 时间：2012-05-29T13:43:45.080
> 
> 标签：sql, sql-server-2008, tsql

假设我有一个像这样的表：

```
Tab(MyDate datetime null, MyIs bit null, ...) 
```

然后我有 SQL Like

```
 select Isnull(MyDate, 1), IsNull(MyIs, 999) from Tab; 
```

如果`MyDate`,`MyIs`值`null`在 DB 中，则结果为：

```
 MyDate                   MyIs  
    1900-01-02 00:00:00.000  1 
```

不是期望值

```
MyDate        MyIs  
1             999 
```

所以看起来返回值是基于列的数据类型。如何解决这个问题？

对于我上面的测试用例，我只从表中得到了一行。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T13:47:12.300

你正在寻找的方式，你没有。

同一列中的所有值*必须*是相同的数据类型。如果您的数据在某些行中具有 NOT NULL 值*（返回列的数据类型）*而在其他行中具有 NULL 值*（根据您的`CASE`语句返回不同的数据类型）*，您将违反此要求。

你可以有两个额外的字段......

```
select
  MyDate,
  CASE WHEN MyDate IS NULL THEN 1   ELSE 0 END As MyDateWibble,
  MyIs,
  CASE WHEN MyIs   IS NULL THEN 999 ELSE 0 END AS MyIsWibble
FROM
  Tab; 
```

您可以将`CAST()`所有内容都`VARCHAR()`返回并返回字符串，而不是`DATETIME`,`BIT`或`INT`.

但是，更有可能的是，我首先会回顾您想要这样做的原因并制定替代设计。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T13:45:50.837

您正在混淆数据类型。

例如，当您测试数据时，您返回*整数*1。这将被转换为 sql server 从 + 1（天）开始计数的数据

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-29T13:59:43.810

你可以做

```
select 
    case when mydate is null
    then '1' else cast(mydate as varchar(40))
    end,
    case when MyIs is null
    then 999 else MyIs
    end
from tab 
```

![在此处输入图像描述](../Images/74b2d5d5a1bd3b30fecf04ad4695c40d.png)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-29T14:01:06.440

SQL 服务器“零”日期或基准日期为 1900-01-01，因此您只需将`MYDate`null 转换为 1，因此它在基准日期中添加 1 天为

```
declare @d datetime = 1
select @d

1900-01-02 00:00:00.000

set @d = 0
select @d

1900-01-01 00:00:00.000 
```

`MyIs`是位类型，所以除了 0 之外的任何东西都是 '1' 之类的

```
declare @b bit = 0
select @b

set @b = 1
select @b

set @b = -1
select @b 
```

由于不同的列的上述行为`data types`

# eclipse - EntityManager 为空。使用 Seam 和 JBOSS

> ID：10800413
> 
> 赞同：0
> 
> 时间：2012-05-29T13:44:04.567
> 
> 标签：eclipse, jboss, nullpointerexception, seam, entitymanager

我正在使用 JBOSS 和 Seam 制作一个 Web 应用程序，但我试图在我的一个类中使用 entityManager 但它为空。我将它连接到外部数据库并在类中打印出 entityManager，它只是说空。当我尝试打开使用该类的网页时，我得到一个空指针异常并且网页说无法实例化 Seam 组件。我在互联网上花了几个小时试图找出问题所在，但我没有成功。任何帮助，将不胜感激。这是该类的代码：

```
package edu.uwrf.iss.flowershop.session;

import java.util.ArrayList;
import java.util.List;

import javax.ejb.Remove;
import javax.ejb.Stateful;
import javax.persistence.EntityManager;
import javax.persistence.Query;

import org.jboss.aop.util.logging.SystemOutLoggerPlugin;
import org.jboss.seam.ScopeType;
import org.jboss.seam.annotations.Destroy;
import org.jboss.seam.annotations.In;
import org.jboss.seam.annotations.Name;
import org.jboss.seam.annotations.Scope;

import edu.uwrf.iss.flowershop.entity.FlowerStoreEmployee;

@Stateful  
@Scope(ScopeType.SESSION)
@Name("employeePort")
public class EmployeeBean implements EmployeePortal {

//These are the variables to store the employee information
String empID;
String first;
String last;
String ssn;
String phone;
String pay;
String vehicle;
String house;
String street;
String city;
String state;
String zip;

@In (create=true)
private EntityManager entityManager;
//this is the employee list
List<FlowerStoreEmployee> employeeList;

//Constructor
public EmployeeBean(){
    employeeList = new ArrayList<FlowerStoreEmployee>();
    loadEmployeeList();
}

@SuppressWarnings("unchecked")
public void loadEmployeeList(){
    employeeList = new ArrayList<FlowerStoreEmployee>();
    entityManager.isOpen();
    Query query = entityManager.createQuery("SELECT e FROM FlowerStoreVehicle e");

    employeeList.addAll((List<FlowerStoreEmployee>)query.getResultList());
}

//Getters and Setters

public List<FlowerStoreEmployee> getEmployeeList() {
    return employeeList;
}

public void setEmployeeList(List<FlowerStoreEmployee> employeeList) {
    this.employeeList = employeeList;
}

//used by the add button on the addEmp.xhtml page
public String addEmployee(){
    int id = Integer.parseInt(empID);
    int soc = Integer.parseInt(ssn);
    int paid =Integer.parseInt(pay);
    int vehID = Integer.parseInt(vehicle);
    int houseID = Integer.parseInt(house);
    Integer zCode = Integer.parseInt(zip);
    FlowerStoreEmployee n = new FlowerStoreEmployee();
    n.setNameFirst(first);
    n.setNameLast(last);
    n.setPay(pay);
    n.setPhone(phone);
    n.setSsn(ssn);
    employeeList.add(n);
    entityManager.persist(n);
    return "/employee.xhtml";
}

//used by the remove button on the remEmp.xhtml page
public String remEmployee(){
        int searchID = Integer.parseInt(empID);
        int emp = 0;
        int i = 0;
        FlowerStoreEmployee e;
        while (emp!= searchID && i<employeeList.size()){
            e = employeeList.get(i);
            emp = e.getEmployeeId();
        }
        employeeList.remove(i);
        return "/employee.xhtml";
}

//clears the variables used to temporarily store the information entered on the forms
public void clearTemps(){
    this.empID = null;
    this.first = null;
    this.last = null;
    this.ssn = null;
    this.phone=null;
    this.pay = null;
    this.vehicle = null;
    this.house = null;
    this.street=null;
    this.city=null;
    this.state=null;
    this.zip=null;
}

public String createEmp() {
    clearTemps();
    System.out.println("words");
    return "FlowerStore/addEmp.xhtml";
}

//Setters and getters

public String getEmpID() {
    return empID;
}

public void setEmpID(String empID) {
    this.empID = empID;
}

public String getFirst() {
    return first;
}

public void setFirst(String first) {
    this.first = first;
}

public String getLast() {
    return last;
}

public void setLast(String last) {
    this.last = last;
}

public String getSsn() {
    return ssn;
}

public void setSsn(String ssn) {
    this.ssn = ssn;
}

public String getPhone() {
    return phone;
}

public void setPhone(String phone) {
    this.phone = phone;
}

public String getPay() {
    return pay;
}

public void setPay(String pay) {
    this.pay = pay;
}

public String getVehicle() {
    return vehicle;
}

public void setVehicle(String vehicle) {
    this.vehicle = vehicle;
}

public String getHouse() {
    return house;
}

public void setHouse(String house) {
    this.house = house;
}

public String getStreet() {
    return street;
}

public void setStreet(String street) {
    this.street = street;
}

public String getCity() {
    return city;
}

public void setCity(String city) {
    this.city = city;
}

public String getState() {
    return state;
}

public void setState(String state) {
    this.state = state;
}

public String getZip() {
    return zip;
}

public void setZip(String zip) {
    this.zip = zip;
}

/* Seam/Hibernate methods */
  @Remove
  public void remove() {
  }

  @Destroy
  public void destroy() {
  }

} 
```

如果需要任何其他信息，请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T03:45:30.567

注入不能在构造之前发生，您正在尝试将组件注入到尚未创建的东西中。

尝试将 loadEmployeeList 设置为 init 方法并使用 @PostConstruct 对其进行注释。 [https://community.jboss.org/thread/141133](https://community.jboss.org/thread/141133)

# javascript - javascript中的if和or子句

> ID：10800414
> 
> 赞同：0
> 
> 时间：2012-05-29T13:44:08.283
> 
> 标签：javascript, if-statement

我不明白为什么这个简单的功能不能按我想要的方式工作:)

```
c = document.form.product_catid.selectedIndex;
if (document.form.product_name.value == "" && document.form.product_catid[c].value == "")
{
    alert ("Please, define at least product name or product category !");
    return false;
}
else if (!(document.form.product_name.value == "")) 
{
    return true;
}
else if (!(document.form.product_catid[c].value == "")) 
{
    return true;
}
else
{ 
    alert ("Please, dont define two of them at the same time!");
    return false; 
}
return true; 
```

我想要的只是当输入名称为product_name 或选择名称为product_catid 时，该函数返回true，但如果没有定义它们或两者都定义，我希望它发出两个不同的警报）谢谢大家的帮助， 对此，我真的非常感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T13:59:11.043

尝试使用 Chrome 开发者工具、Firebug 或类似工具来调试您的案例。我的怀疑是你试图在子句中比较`""`and （当is 时就是这种情况）。试试吧。`undefined``document.form.product_catid[c].value == ""``selectedIndex``-1``!document.form.product_catid[c].value`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T13:46:28.547

使用`return`语句后，函数“结束”：

```
alert ("Please, define at least product name or product category !");
return false; // Exit point
...
...
// this will not be executed.
alert ("Please, dont define two of them at the same time!"); 
return false; 
```

* * *

```
var returnValue = true;

if (document.form.product_name.value == "" && document.form.product_catid[c].value == "")
{
    alert ("Please, define at least product name or product category !");
    returnValue = false;
}
else if (document.form.product_name.value == "") 
{
    return true;
}
else if (document.form.product_catid[c].value == "") 
{
    return true;
}
else
{ 
    alert ("Please, dont define two of them at the same time!");
    returnValue = false; 
}
return returnValue;​ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-29T14:02:08.067

试试这个：

```
var product = document.form.product_name.value;
var category = document.form.product_catid[document.form.product_catid.selectedIndex].value
if (product || category) {
    if (product && category) {
        alert ("Please, dont define two of them at the same time!");
        return false;
    }
    else return true;
}
else {
    alert ("Please, define at least product name or product category !");
    return false;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-29T14:19:43.757

您的条件排序不正确。

就目前而言：

1.  您的第一个检查是两者都处理两个输入均为空的情况，这按预期工作。
2.  您的下一个检查是其中一个值不为空
3.  下一个检查是另一个值不为空
4.  那么您假设此时两个输入都不为空（您的`else`条件）

考虑一下：条件 1 确保两个输入都不为空 - 这意味着，从逻辑上讲，**其中至少一个是 non-empty**。在此之后，鉴于我们现在知道其中至少有一个是非空的，条件 2 或条件 3**将始终计算为`true`**。这样做的结果是第四条代码路径永远不会执行。

要解决此问题，请检查两个输入是否未填充为显式条件。：

```
function validateInput() {

    //replace values here to test function
    var productCatId = "",
        productName = "gjghj";

    //uncomment when using real values
    //var productCatId = document.form.product_catid[document.form.product_catid.selectedIndex].value,
    //    productName = document.form.product_name.value;

    //check both aren't empty
    if (productName == "" && productCatId == "")
    {
        alert ("Please, define at least product name or product category !");
        return false;
    }
    //check both aren't populated
    else if (productName != "" && productCatId != "")
    { 
        alert ("Please, dont define two of them at the same time!");
        return false; 
    }
    //by now we know that both aren't empty, and both aren't populated, therefore only one is populated, so return true;
    return true;

} 
```

# javascript - 在 JQuery 中索引 $ 返回的数组

> ID：10800415
> 
> 赞同：2
> 
> 时间：2012-05-29T13:44:11.303
> 
> 标签：javascript, jquery, arrays

```
$('.aClass')[index].addClass('newClass'); 
```

这就是我想要做的，但它不起作用，而且它破坏了它之后的代码。我究竟做错了什么 ？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-29T13:45:55.120

当使用这样的索引时，它返回 DOM 元素，因此没有 jQuery 方法。

改用[`.eq()`](http://api.jquery.com/eq/)返回该索引处的 DOM 元素，同时*仍由 jQuery 包装*：

```
//as a function call
$('.aClass').eq(index).addClass('newClass'); 
```

还有[一个选择器`:eq`](http://api.jquery.com/eq-selector/)，在形式和用法上与方法版本略有不同。索引是选择器字符串的一部分，因此如果使用动态值，则必须剪切字符串：

```
//the selector version:
$('.aClass:eq('+index+')').addClass('newClass'); 
```

* * *

另外信息：您所做的类似于 a在该索引处[`.get()`](http://api.jquery.com/get/)返回 DOM 元素，*而不是包装在 jQuery中：*

```
//the same thing
$('.aClass').get(index)
$('.aClass')[index] 
```

# asp.net - asp.net mvc 更新多条记录

> ID：10800418
> 
> 赞同：4
> 
> 时间：2012-05-29T13:44:19.907
> 
> 标签：asp.net, asp.net-mvc

是否可以有一个用于编辑多个记录的视图，就像 index.cshtml 视图循环遍历记录以显示它们一样（如下所示）？

```
@foreach (var item in Model) {
<tr>
    <td>
        @Html.DisplayFor(modelItem => item.tvid)
    </td> 
```

因此，对于上面的每一行，它将与数据库中的不同行相关。

有谁知道任何例子表明如何实现这一目标？

感谢您的任何指点，

标记

**更新**

模型：

```
 using System;
 using System.Collections.Generic;
 using System.Linq;
 using System.Web;

namespace MvcObjectives.Models
{
public class objectives
{
    public int ID { get; set; }
    public int tvid { get; set; }
    public string tlnt { get; set; }
    public DateTime month { get; set; }

    public string objective  { get; set; }
    public int score { get; set; }
    public int possscore { get; set; }
    public string comments { get; set; }
 } 
```

}

控制器：

```
 [HttpPost]
    public ActionResult Edit(objectives objectives)
    {
        if (ModelState.IsValid)
        {
            db.Entry(objectives).State = EntityState.Modified;
            foreach (objective Objective in objectives.objective)

            { }

            db.SaveChanges();
            return RedirectToAction("Index");
        }
        return View(objectives);
    } 
```

我坚持使用控制器，如果有人可以提供任何帮助吗？

再次感谢，

标记

**第二次更新**

将记录发送到视图的 GET 控制器是：

```
 // GET: /Objective/Edit/
        public ActionResult Edit()
        {
            return View(db.objectives.ToList());
        } 
```

POST 控制器（值从视图回传的位置）是：

```
 // POST: /Objective/Edit/
        [HttpPost]
        public ActionResult Edit(List<objectives> objectives)
        {
            if (ModelState.IsValid)
            {
         // the next part is where I am stuck - how to loop through the returned objectives, and update the records in the database
                db.Entry(objectives).State = EntityState.Modified;
                foreach (objectives obj in objectives)
                {
                    var tempObj = (from objv in db.objectives
                                   where objv.ID==obj.ID
                                   select objv).First();
              }

              //  to do - how to save the updates sent back????

                return RedirectToAction("Index");
            }
            return View(objectives);
        } 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-29T13:53:36.403

使用**编辑器模板**

假设您的 ViewModel/Model 看起来像这样

```
public class UserViewModel 
{
  public int UserId { set;get;}
  public string Name { set;get;}   
  public IEnumerable<Address> Addresses { set;get;}

  public UserViewModel()
  {
     if(this.Addresses==null)
         this.Addresses=new List<Address>();
  }
}
public class Address
{
  public int AddressID { set;get;}
  public string AddressLine1 { set;get;}
} 
```

现在创建一个名为`addresses.cshtml`以下内​​容的编辑器模板。

```
@model YourNameSpace.Address
@Html.TextBoxFor(x => x.AddressLine1) 
```

在您的主视图中，您可以这样称呼

```
@model UserViewModel 
@using (Html.BeginForm())
{
  //other elements
 @Html.EditorFor(m=>m.Addresses)
 <input type="submit" value="Save" />
} 
```

现在您将在 HttpPost Ation 方法中获取数据

```
[HttpPost]
public ActionResult Save(UserViewModel model)
{  
   foreach (Address address in model.Addresses)
   {
      //now check for address.AddressLine here
   } 
} 
```

**编辑** ：基于用户对问题的评论和更新。

（***对 OP 的请求***：*下次您发布问题时，请在第一次时将问题的所有相关详细信息包括在内*。）

创建一个 ViewModel 来包装您的目标类列表。

```
public class ObjectivesEdit
{
    public IEnumerable<Objective> Objectives { set; get; }
    public ObjectivesEdit()
    {
        if (Objectives == null)
            Objectives = new List<Objective>();
    }
} 
```

并在您的 GET Action 方法中将此 Wrapper View 模型发送到 View 并填充值

```
 public ActionResult Edit()
  {
     ObjectivesEdit objEdit = new ObjectivesEdit();
     List<Objective> objList = new List<Objective>();
       // you can replace this manual filling with data from database
     objList.Add(new Objective { ID = 1, score = 65 });
     objList.Add(new Objective { ID = 2, score = 43 });
     objList.Add(new Objective { ID = 3, score = 78 });
     objEdit.Objectives = objList;
     return View(objEdit);
  } 
```

您的编辑器模板应如下所示。它应该被命名`objective.cshtml`

```
@model EditorTemplateDemo.Models.Objective           
<p>
Score for @Model.ID is  @Html.TextBoxFor(x => x.score)
@Html.HiddenFor(x => x.ID)
</p> 
```

和你的主视图

```
@model EditorTemplateDemo.Models.ObjectivesEdit
@using (Html.BeginForm())
{
  @Html.EditorFor(x=>x.Objectives)
  <input type="submit" value="Save" />    
} 
```

最后，您的 HTTPPOST 操作方法将如下所示

```
 [HttpPost]
    public ActionResult Edit(ObjectivesEdit model)
    {
        if (model.Objectives != null)
        {
            // Put a break point here and you will see the posted data
            foreach (var item in model.Objectives)
            {
                 context.Entry(item).State = EntityState.Modified;
            }
            //Save and redirect  
            context.SaveChanges();
            return RedirectToAction("Index");     
        }
        return View(model);
    } 
```

这应该有效。经测试。

为了避免进一步的问题，我在[这里](http://sdrv.ms/K9NKs0)分享上述代码的工作示例。请在代码中使用 Visual Studio 断点来查看发布的值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T13:57:11.007

假设您有一个名为 Person.. 的模型，并且您想在一个视图中编辑一堆人并将它们发布到一个动作中。

```
public ViewResult Edit()
{
    return View(list of persons to edit);
}

public ViewResult Edit(List<Person> persons)
{
    // save to db?
} 
```

现在创建一个视图，显示多个要编辑的人。

编辑.cshtml

```
@model List<Person>

@for (int i = 0; i < Model.Count; i++) {
   <h4>Person Number: @i</h4>
   @:First Name: @Html.EditorFor(m => m[i].FirstName)
   @:Last Name: @Html.EditorFor(m => m[i].LastName)
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-29T13:52:28.327

看看 [EditorTemplates](http://dineshkumara.blogspot.com/2011/06/mvc-3-razor-editor-template.html)

# mysql - 如何合并两列然后进行准全文搜索？

> ID：10800420
> 
> 赞同：0
> 
> 时间：2012-05-29T13:44:24.680
> 
> 标签：mysql, full-text-search, concat-ws

## MySQL

**表：城市**

```
+----+----------+
| id |   city   |
+----+----------+
| 1  | New York |
+----+----------+ 
```

**表：车站**

```
+----+--------------+---------+
| id |     name     | city_id |
+----+--------------+---------+
| 1  |   Woodlawn   |    1    |
+----+--------------+---------+
| 2  | Mosholu Pkwy |    1    |
+----+--------------+---------+ 
```

## PHP

```
$string = mysql_real_escape_string('woodlawn new york');

$a = mysql_query("

    SELECT s.id FROM cities AS c, stations AS s 

    WHERE CONCAT_WS(' ', s.name, c.city) LIKE '%$string%' AND c.id = s.city_id

");

while($b = mysql_fetch_assoc($a))
{
   echo $b['id'];
} 
```

## 问题

但是，当我尝试搜索时，上面的示例工作正常：

```
 $string = mysql_real_escape_string('mosholu new york'); 
```

我得到 0 个结果，除非我明确搜索**mosholu pkwy new york**。

## 可能的选择？

显然我不能将`FULLTEXT`搜索与`CONCAT_WS`. 而且我真的很想保持表格的结构不变，一张桌子`cities`用于`stations`.

那么，唯一的选择是将第四列添加到`stations`包含**车站名称和城市名称**的表中，然后对其进行`FULLTEXT`搜索吗？

但这只会让人头疼，例如，如果我必须更新城市名称，然后还要为`stations`表中的所有行更改它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T13:54:39.197

`$string`只需用通配符替换空格`%`即可——您可以根据自己的喜好在 PHP 或 MySQL 中执行此操作；例如，在 MySQL 中：

```
SELECT s.id
FROM   cities AS c JOIN stations AS s ON c.id = s.city_id
WHERE  CONCAT_WS(' ', s.name, c.city) LIKE REPLACE('%$string%', ' ', '%') 
```

# actionscript-3 - 在 Flex AS 函数中从 Javascript 中读取 ByteArray

> ID：10800421
> 
> 赞同：1
> 
> 时间：2012-05-29T13:44:26.837
> 
> 标签：actionscript-3, apache-flex, flex3, externalinterface

我需要将 ByteArray 从 Javascript 函数传递给 Flex Actionscript 函数。已尝试使用以下 JS：

```
function deviceResp(s){ 
    var obj = document.getElementById('smera');
    obj.deviceRespFx(s);    
} 
```

我的 AS 功能：

```
public function imageRespFxs(value:String):void{
    Alert.show(value.length);
} 
```

编辑：回调函数加载到“ **creationComplete** ”

```
 public function initDevice():void{                  
                               ExternalInterface.addCallback("deviceRespFx",imageRespFxs);

        } 
```

由于上述方法又将字节数组转换为字符串，因此会丢失数据，请任何人帮忙解决如何将字节数组从 JS 传递给 AS 函数。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T09:21:36.663

多亏了 Sam DeHaan，

正如 Sam 评论所暗示的那样，终于设法让它与 Base64 一起工作。

这里的代码可能对其他人有帮助：

首先在我的 Java 代码中，我将图像转换为 Base64 字符串，如下所示：

```
 private String convertBase64String(BufferedImage image){

    ByteArrayOutputStream baos = new ByteArrayOutputStream();
    Base64OutputStream bi64 = new Base64OutputStream(baos);
    try{
    ImageIO.write(imgRegistration1, "png",bi64);
    baos.flush();               
    String data = baos.toString("UTF-8");
    return data;
    }catch(Exception e)
    {
        e.printStackTrace();
    }
    return null;

} 
```

我将它发送到 Flex AS 方法并像这样解码相同：

```
 import mx.utils.Base64Decoder;
  private var base64Dec:Base64Decoder;
  public function imageRespFxs(value:String):void{                
    var byteArr:ByteArray;
            base64Dec = new Base64Decoder();
            base64Dec.decode(value);
            byteArr = base64Dec.toByteArray();
            imgId.load(byteArr);

        } 
```

谢谢

# android - 警报弹出消息无法正常工作？

> ID：10800427
> 
> 赞同：0
> 
> 时间：2012-05-29T13:44:46.877
> 
> 标签：android, android-activity, android-alertdialog, android-alarms

我在我的应用程序中使用了 alaram。Alarm 工作正常，没有任何问题，但是当警报消息被填充时，我看到它后面有最后使用的活动。我只希望弹出消息没有任何最后使用的活动或后面的任何活动。

谢谢你们的帮助，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T10:29:38.057

我已经解决了这个问题。[你可以在这里](https://stackoverflow.com/questions/10720181/how-to-popup-alarm-message-without-any-activity-in-background/10720517#comment14072752_10720517)看到我的另一篇文章。它可能对像我这样的人有所帮助。

# android - 通过启动器和意图过滤器启动 Android 应用程序

> ID：10800429
> 
> 赞同：0
> 
> 时间：2012-05-29T13:44:50.470
> 
> 标签：android, android-intent, launcher

我有欢迎活动和主要活动的应用程序。可能有： 1\. 欢迎活动作为 MAIN 和 LAUNCHER 2\. 使用意图过滤器拦截 url 的主要活动？

在这种情况下，单击 url 时应用程序会从主要活动开始吗？还是会开始欢迎？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T13:55:15.177

对的，这是可能的。

关于启动哪个活动：这取决于您在哪个活动上注册了意图过滤器。

当您注册一个意图过滤器时，您会将其与一个活动相关联，这基本上是通知 Android 操作系统指定的活动可以处理该意图。您可以选择在欢迎活动或主要活动（或任何其他活动）中注册它。

当用户从意图选择器中选择您的应用程序时，它将启动您在过滤器中注册的活动。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T14:12:14.837

是的，您可以在点击 URL 时启动 Activity，为此您需要为您的 Activity 指定一些额外的过滤器，例如**数据、架构**

检查此[示例以从 URI Intent 启动应用程序](https://github.com/commonsguy/cw-advandroid/tree/master/Introspection/URLHandler/)

# php - php预定义计划任务cron？

> ID：10800430
> 
> 赞同：0
> 
> 时间：2012-05-29T13:44:51.920
> 
> 标签：php, cron

我想创建一个在预定时间运行并将新内容发布到我的网站的脚本。但它应该运行的时间并不一致。我可能想在周一上午 9 点发布数据，然后在周二中午发布数据，依此类推。

我正在考虑创建一个数据库，并且可以将每条内容保存到其中并带有显示时间。然后创建一个每小时运行一次的 cron 并检查是否应该添加任何新内容可以确定输出什么。

尽管这似乎是一种密集的过于复杂的方法。

有什么方法可以在特定数据和时间上运行一次 cron 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T13:52:13.040

您可以添加一个`publishedAt`-column 并扩展您的查询，以便它只返回结果，其中`NOW() >= publishedAt`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T13:46:34.683

您可以使用“at”工具。

[http://www.ibm.com/developerworks/linux/library/l-job-scheduling/index.html#N10181](http://www.ibm.com/developerworks/linux/library/l-job-scheduling/index.html#N10181)

# mysql - MySQL“SELECT DISTINCT”对于非常大的表的效率

> ID：10800432
> 
> 赞同：11
> 
> 时间：2012-05-29T13:44:53.257
> 
> 标签：mysql, performance

我有一个非常大的表（数百万条记录），其中包含大约 8 个字段作为主键。为简单起见，可以说该表如下所示：

```
 key_1 | key_2 | key_3 | ... | key_8 | value 
```

给定 key_1 的值，我需要获取 key_2、key_3、...、key_8 的所有可能值，如下所示：

```
 SELECT DISTINCT key_2 FROM table1 WHERE key_1 = 123;
    SELECT DISTINCT key_3 FROM table1 WHERE key_1 = 123;
    ...
    SELECT DISTINCT key_8 FROM table1 WHERE key_1 = 123; 
```

我的问题是这个查询比我的性能需要慢得多，而且这个表中的数据相当稳定，很少更新（每隔几天一次）。table_1 也可能是一个缓慢的子查询。除了在数据库中创建一个额外的表并在每次更新数据库时手动更新它，还有另一种解决方案可以给我快速的结果。我需要它跨多个 MySQL 会话工作。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-05-29T13:52:52.787

无法用我们掌握的信息给出明确的答案，但让我们从这些开始：

### 您在 key_1 上有索引吗？

没有它，每个查询本身就已经很慢，只需要查找 123。

### 您在 (key_1, key_2) 上有索引吗？

因为`select distinct key_2 where key_1 = 123`如果它可以单独从索引中获取所有必要的数据，那真的很快。无需访问表。

### 行/索引是固定大小的吗？

遍历固定大小的表/行会更快，因为只需计算偏移量就可以知道第 x 条记录在哪里。可变行大小的表速度较慢。

### 您是否尝试过添加自动增量代理主键？

当索引只需要存储列和一个小的主键时，索引会更好地工作。复合主键速度较慢。

### 您是否考虑过只读表？

您可以打包 myisam 表以进行快速访问，但它们变为只读的。这是一个有其用途的黑客。

### 更进一步，您是否考虑过数据仓库？

如果表格不经常更改，最好复制信息以便快速访问。

可以发表`show create table`声明吗？查看列和索引会有所帮助。可以发表`explain select`声明吗？查看使用了哪些索引会有所帮助。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-29T14:21:44.923

```
SELECT DISTINCT key_2 FROM table1 WHERE key_1 = 123; 
```

这可以使用您的主键索引（key_1、key_2 等）。它将执行索引扫描，这比表扫描或临时表要快。

```
SELECT DISTINCT key_3 FROM table1 WHERE key_1 = 123; 
```

无法使用主键，因为 key_1 和 key_3 的组合不构成主键的前缀。您需要按顺序在 key_1 和 key_3 上创建复合索引。然后，它也可以使用该索引来执行索引扫描。

```
SELECT DISTINCT key_8 FROM table1 WHERE key_1 = 123; 
```

需要 key_1 和 key_8 上的索引，按此顺序。和上面一样。

# wordpress - htaccess 导致谷歌问题

> ID：10800435
> 
> 赞同：0
> 
> 时间：2012-05-29T13:45:21.667
> 
> 标签：wordpress, .htaccess, redirect

我不是程序员，我正在努力找出我们的 .htaccess 文件有什么问题。

Google 正在索引 www.domain.co.uk 和 domain.co.uk 上的页面我认为 .htaccess 的编写方式可以解决这个问题，但事实并非如此。（网站管理员工具设置为 www。每个页面上的首选和规范链接）。

其次，我对 Zoompf 进行了性能检查，它给出了很多发现，其中许多是基于 htaccess 的。

如果有人可以看一下下面的文件（添加注释），请给我一些指示，我真的很感激？

非常感谢

戴夫

### 添加了第一行以阻止 Google 列出文件夹索引

```
options -Indexes 
```

### 添加此内容以尝试阻止来自缓存页面的订单

```
<FilesMatch ".(html|htm|php)$">
Header set Cache-Control "max-age=3600"
</FilesMatch> 
```

### /sexy 和 /pages 是由 /underwear 取代的旧目录

```
Redirect /sexy http://www.blushlingerie.co.uk/underwear
Redirect /pages http://www.blushlingerie.co.uk/underwear 
```

### 不知道这是从哪里来的，但我认为它来自我们的 Wordpress 博客

```
AddType text/html .shtml
AddHandler server-parsed .html
AddHandler server-parsed .shtml
options Indexes FollowSymLinks Includes
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /blog/
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /blog/index.php [L]
</IfModule>
options +FollowSymlinks
RewriteEngine on 
```

### 我认为问题出在这里。这应该解决圆锥问题

```
rewritecond %{http_host} ^blushlingerie.co.uk [nc]
rewriterule ^(.*)$ http://www.blushlingerie.co.uk/$1 [r=301,nc] 
options +FollowSymLinks
RewriteEngine on
RewriteCond %{THE_REQUEST} ^.*/index.html
RewriteRule ^(.*)index.html$ http://www.blushlingerie.co.uk [R=301,L] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T13:59:09.950

对于您的索引问题

```
options -Indexes 
```

应该

```
Options -Indexes 
```

Wordpress 的 .htaccess[应该只是](http://codex.wordpress.org/Using_Permalinks)：

```
# BEGIN WordPress
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /
RewriteRule ^index\.php$ - [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.php [L]
</IfModule>
# END WordPress 
```

删除 www[可以这样完成](http://txt.binnyva.com/2008/09/remove-www-from-url-using-htaccess-in-apache/)：

```
RewriteEngine On
RewriteCond %{HTTP_HOST} ^www.domain.com$ [NC]
RewriteRule ^(.*)$ http://domain.com/$1 [R=301,L] 
```

# javascript - 在 android phonegap 上获取 SharedPreference 值

> ID：10800440
> 
> 赞同：3
> 
> 时间：2012-05-29T13:45:32.763
> 
> 标签：javascript, android, cordova

在我的应用程序中，我将数据保存在 SharedPreferences 上。

这是我的代码

```
public void initUserData(Context context, String pKey1, String pKey2, long id) {
        SharedPreferences prefs = PreferenceManager.getDefaultSharedPreferences(context.getApplicationContext());

         prefs.edit().putString("key1", pKey1).commit();
         prefs.edit().putString("key2", pKey2).commit();
        prefs.edit().putLong("user.id", id).commit();
    } 
```

如何使用 phonegap 获取 SharedPreferences 值？我的意思是使用 JavaScript 获取数据

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-08-16T08:48:02.123

有一个phonegap 插件可以让你使用android 的sharedpreferences。看看这个：[https ://github.com/macdonst/AppPreferences](https://github.com/macdonst/AppPreferences)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-31T07:23:22.813

phone gap 本身支持共享偏好，无需为此使用 android 编码。请参阅 docs.phonegap.com

# oauth-2.0 - 用于移动访问和 SSO 的 OAUTH2 流

> ID：10800441
> 
> 赞同：1
> 
> 时间：2012-05-29T13:45:32.620
> 
> 标签：oauth-2.0

我一直在研究 OAuth2 规范和大量支持材料，但无法确定用于我的用例的最佳方法/流程。

我有一个 wep 应用程序，我的用户可以通过 SSO 机制访问它。这是一个足够基本的机制，但它涉及用户在自己的网络上授权自己，并向我发送一个包含用户信息的加密令牌。我处理这个并在我的网络应用程序上设置一个会话。

我现在有一组rest api，可以让移动网络客户端（目前是android）从我的网络应用程序中提取数据。我想重新使用此 SSO 机制来生成一个 OAuth 令牌，移动客户端使用该令牌在每个休息请求中标识自己。理想情况下，流程应该是无缝的，即用户在他们的手机上打开浏览器，在他们自己的系统上进行身份验证，然后使用 OAuth 令牌定向到移动 Web 客户端的主 URL。

从我读到的所有 OAuth2 流程似乎都以另一种方式工作，即用户首先与我的授权服务器交谈，然后将被重定向到他们自己的身份验证系统，然后将被重定向回我的授权服务器并获得令牌. 我担心这种方式可能需要更改我的用户在本地授权的方式。

我在这里错过了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T11:35:58.437

如果我正确理解了您的问题，那就没那么复杂了。您的方案应使用为移动应用程序设计的隐式授权消息流 ( [https://datatracker.ietf.org/doc/html/draft-ietf-oauth-v2-26#section-4.2 )。](https://datatracker.ietf.org/doc/html/draft-ietf-oauth-v2-26#section-4.2)所以你的消息流将是：

1.  当移动应用程序启动时，它会向 OAuth 服务器发送一个令牌请求。服务器响应重定向到您的 Web 应用程序。结果页面显示给用户。
2.  用户登录（手动或使用 SSO），阅读授权请求的详细信息并希望批准它。批准被发送到 OAuth 服务器。
3.  OAuth 服务器生成一个令牌并返回一个重定向，其中包含 URL 片段中的令牌信息。
4.  您的移动应用程序从片段中提取令牌并使用它来访问受保护的资源。

要实现这一点，您的移动设备需要一个 OAuth 客户端、一个 OAuth 服务器 Web 应用程序和 Web 应用程序中的批准页面来支持该场景。如果 OAuth 服务器紧密集成到您的 Web 应用程序中，您可能不需要服务器和应用程序之间的重定向。

# mysql - 使用 jdbc url 的 MySQL 主/从复制

> ID：10800443
> 
> 赞同：2
> 
> 时间：2012-05-29T13:45:41.590
> 
> 标签：mysql, tomcat, jdbc, replication, mysql-connector

我们已经创建了 MySQL 复制。我们有一个主人和两个奴隶。在 mysql shell 上一切正常。当我们在主服务器中插入新数据时，数据会复制到所有从服务器。

但是，当我们使用 jdbc url 从 tomcat 发出请求时，所有请求都来自主服务器。没有查询来自从服务器。

我们使用 spring 3.0、hibernate、mysql 5.0.95 和 mysql-connector-java-5.1.12.jar

```
Driver : com.mysql.jdbc.ReplicationDriver
jdbcUrl : jdbc:mysql:replication//master_ip:3306,slave_1_ip:3306,slave_2_ip:3306/database_name?useUnicode=true&characterEncoding=UTF-8&autoReconnect=true&roundRobinLoadBalance=true 
```

这里有什么问题？我们错过了网址上的某些内容吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T13:53:21.333

也许是个愚蠢的问题，但是当您只需要读取数据时，您是否设置了 Connection.setReadOnly(true) ？

[https://dev.mysql.com/doc/connector-j/5.1/en/connector-j-master-slave-replication-connection.html](https://dev.mysql.com/doc/connector-j/5.1/en/connector-j-master-slave-replication-connection.html)

# css - 小屏幕上的页面布局

> ID：10800447
> 
> 赞同：0
> 
> 时间：2012-05-29T13:45:51.290
> 
> 标签：css, mobile

您可以看到下面的示例图像，我的布局......该网站运行良好。但我在左侧使用了图像，超出了内容部分。

因此，如果通过笔记本或手机等小屏幕访问，则内容部分不适合屏幕。它从图像的左侧开始显示。因此，内容部分在右侧流出了一点，与任何其他 960 px 网站不同，内容不适合屏幕。它在右侧流出了一点，因为有 150 像素宽的图像。

![布局](../Images/1a9fca39d9f5ec39209f08033b605f31.png)

我该如何解决这个问题？

如果通过小屏幕访问，则无需显示图像。或者..还有其他解决方案吗？

编辑：JsFiddle

[JSFiddle](http://jsfiddle.net/yHC4w/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T13:50:09.280

只需允许以较小的宽度显示您的内容。

对于移动优化，您还应该添加一些元标记来控制缩放系数。

像这里这样：

```
<meta name="HandheldFriendly" content="true" />
<meta name="viewport" content="user-scalable=no, width=device-width, maximum-scale=1.0" />
<meta name="apple-mobile-web-app-capable" content="yes" /> 
```

要添加特殊的 css 规则，请在此处尝试：

```
<style type="text/css" media="screen">
/* Mobile Landscape Size to Tablet Portrait (devices and browsers) */
@media only screen and (min-width: 480px) and (max-width: 630px) {
    ...
}

/* Mobile Portrait Size to Mobile Landscape Size (devices and browsers) */
@media only screen and (max-width: 479px) {
    ...
}
</style> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-29T13:52:17.557

您可以使用[CSS 媒体查询](http://mobile.smashingmagazine.com/2010/07/19/how-to-use-css3-media-queries-to-create-a-mobile-version-of-your-website/)来定位较小的屏幕尺寸，然后将图像移动到内容下方，或完全隐藏图像。现在，请记住，如果您使用 display:none 隐藏图像；它仍然会下载，但根本不显示。

# c# - WCF/SQL Server 的集成测试太慢？

> ID：10800450
> 
> 赞同：2
> 
> 时间：2012-05-29T13:46:04.853
> 
> 标签：c#, .net, sql-server, wcf, integration-testing

我有一个持续失败的集成测试（在 Visual Studio 中），但是，通过查看数据库来验证结果表明这里测试的系统实际上是成功的。

这是测试的基本思想：

```
private static readonly EfContext db = new EfContext();

[TestMethod]
void Complete_System_Run_Through_Is_Successful()
{
    // Create a new unique message and request...
    var message = Guid.NewGuid().ToString();
    var request = new FooRequest { Message = message };

    var fooClient = null; /* WCF proxy */
    try
    {
        // Call the service...
        fooClient = new FooClient();
        fooClient.CallService(fooRequest);
    }
    finally
    {
        // Close client or Abort faulted client...
        var channel = fooClient as ICommunicationObject;
        try
        {
            if (channel.State != CommunicationState.Faulted)
                channel.Close();
        }
        catch { channel.Abort(); }
    }

    // Verify there are 15 instances (traces) present in the database...
    var actualNumberOfTraces = db.Traces.Count(x => x.Message == message);
    Assert.AreEqual(15, actualNumberOfTraces);
} 
```

正在测试的 WCF 服务会触发许多其他下游服务（想想“服务总线”），其中每个侦听服务都会向数据库添加一个条目（跟踪）。从头到尾，此过程记录每个完整系统运行的 15 条此类跟踪。

验证数据库中的结果表明测试运行成功（数据库中存在所有 15 个跟踪）。但是，测试运行失败（在 Visual Studio 中），发现的实际跟踪数在 3-6 之间。我唯一能想到的`Assert`是，调用得太早了（即数据库还没有完成更新）。

无论如何，一切正常，所有痕迹确实存在于数据库中，我只是在这个测试中遇到了麻烦。有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T19:30:41.147

好吧，目前丑陋的解决方案是添加一个`Thread.Sleep(250)`让数据库有时间赶上。如果你能想出一个更优雅的解决方案，我绝对有兴趣听到它！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T15:44:06.563

看起来你有一个异步方法调用。本文介绍 WCF 同步和异步行为。

[如何同步和异步调用 WCF 服务](http://www.codeproject.com/Articles/91528/How-to-Call-WCF-Services-Synchronously-and-Asynchr)

# php - 在php中解码json并获取每个数组值

> ID：10800451
> 
> 赞同：2
> 
> 时间：2012-05-29T13:46:07.200
> 
> 标签：php, json

我是 php 新手 我有一个 json 我解码它并写了以下内容

```
$jsonInput = '[{"b_pag_bo_id":"31","b_pag_user_id":"1","b_pag_id":"1","b_page_mark":"1","b_pag_num":"3","b_pag_note":"","b_page_stop":"1"},{"b_pag_bo_id":"31","b_pag_user_id":"1","b_pag_id":"2","b_page_mark":"1","b_pag_num":"57","b_pag_note":"","b_page_stop":"1"},{"b_pag_bo_id":"31","b_pag_user_id":"1","b_pag_id":"3","b_page_mark":"1","b_pag_num":"60","b_pag_note":"","b_page_stop":"1"},{"b_pag_bo_id":"32","b_pag_user_id":"1","b_pag_id":"4","b_page_mark":"1","b_pag_num":"4","b_pag_note":"","b_page_stop":"1"},{"b_pag_bo_id":"32","b_pag_user_id":"1","b_pag_id":"5","b_page_mark":"1","b_pag_num":"6","b_pag_note":"","b_page_stop":"1"},{"b_pag_bo_id":"32","b_pag_user_id":"1","b_pag_id":"6","b_page_mark":"1","b_pag_num":"9","b_pag_note":"","b_page_stop":"1"},{"b_pag_bo_id":"32","b_pag_user_id":"1","b_pag_id":"7","b_page_mark":"1","b_pag_num":"183","b_pag_note":"","b_page_stop":"1"},{"b_pag_bo_id":"32","b_pag_user_id":"1","b_pag_id":"8","b_page_mark":"1","b_pag_num":"324","b_pag_note":"","b_page_stop":"1"},{"b_pag_bo_id":"32","b_pag_user_id":"1","b_pag_id":"9","b_page_mark":"1","b_pag_num":"331","b_pag_note":"","b_page_stop":"1"},{"b_pag_bo_id":"32","b_pag_user_id":"1","b_pag_id":"10","b_page_mark":"1","b_pag_num":"710","b_pag_note":"","b_page_stop":"1"},{"b_pag_bo_id":"34","b_pag_user_id":"0","b_pag_id":"11","b_page_mark":"1","b_pag_num":"50","b_pag_note":"","b_page_stop":"1"},{"b_pag_bo_id":"34","b_pag_user_id":"0","b_pag_id":"12","b_page_mark":"1","b_pag_num":"99","b_pag_note":"","b_page_stop":"1"},{"b_pag_bo_id":"26","b_pag_user_id":"0","b_pag_id":"13","b_page_mark":"1","b_pag_num":"5","b_pag_note":"","b_page_stop":"1"},{"b_pag_bo_id":"26","b_pag_user_id":"0","b_pag_id":"14","b_page_mark":"1","b_pag_num":"7","b_pag_note":"","b_page_stop":"1"}]';

$decoded = json_decode($jsonInput, true);

print_r($decoded); 
```

结果在[此处的链接中](http://dt-works.com/eman/bookMarks2.php)

我想获取每个键的每个值，这意味着我希望所有`b_pag_bo_id`和其他的都在一个单独的变量中。我怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T13:48:52.277

对结果使用`foreach`循环并将数据存储在单个变量中。

```
foreach ( $decoded AS $key => $val ) {
  ${'var'.$key} = $val;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T13:49:47.917

您可以打印与此类似的值：

```
foreach ($decoded as $key => $value) {
    echo $value['b_pag_bo_id'];
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-29T13:52:21.933

你需要循环数组：

```
$b_pag_bo_id = array();
$b_pag_user_id = array();
foreach ($decoded as $item) {
   $b_pag_bo_id[] = $item['b_pag_bo_id'];
   $b_pag_user_id[] = $item['b_pag_user_id'];
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-03-16T13:05:41.397

```
foreach ($array['playerCredentials'] as $key => $value) 
{
   printf('%s => %s<br />', $key, $value);
} 
```

# c# - 使用 COM 与 VBScript 一起工作，但在 c#.net 上失败

> ID：10800461
> 
> 赞同：1
> 
> 时间：2012-05-29T13:46:50.607
> 
> 标签：c#, .net, vbscript, com-interop, notimplementedexception

我在本地系统上注册了一个 DLL。（我不拥有）

当我使用 VBScript 创建 COM 对象并调用该函数时，一切正常：

```
set Elo = CreateObject("jniwrapper.elocomserver")
Elo.refreshIntray() 
```

但是当使用 C#.net 我得到一个`NotImplementedException`：

![抛出了 NotImplementedException！](../Images/25cfdbfac943f7e8f1734aec650a450f.png)

```
Type javaClientComServerType = Type.GetTypeFromProgID("jniwrapper.elocomserver");
dynamic eloJavaClient = Activator.CreateInstance(javaClientComServerType);

eloJavaClient.refreshIntray(); 
```

知道这里发生了什么以及如何解决它吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T17:24:40.333

这似乎是与通过 DLR（动态语言运行时）与 COM-Server（通过 JNI 包装的 Java 程序使用）的 COM 桥相关联的 .NET COM 互操作相关的问题。我怀疑后者是来自 Teamdev 的 ComfyJ。您可以通过提供 IDynamicMetaObjectProvider 和 DynamicMetaObject 的实现来解决此问题。首先看下面的代码：

```
using System;
using System.Collections.Generic;
using System.Text;
using System.Dynamic;
using System.IO;
using System.Linq.Expressions;
using System.Reflection;
using System.Runtime.InteropServices;
using Microsoft.Win32;
using System.Diagnostics;

class DynamicCOMObject : IDynamicMetaObjectProvider, IDisposable 
{
    private Type m_comType = null;
    private object m_comHolder = null;

    public DynamicCOMObject(string progId)
    {        
        m_comType = Type.GetTypeFromProgID(progId);
        m_comHolder = Activator.CreateInstance(m_comType);
    }

    public void Dispose()
    {
        if (m_comHolder != null)
        {
            Marshal.ReleaseComObject(m_comHolder);
            m_comHolder = null;
        }
    }

    #region IDynamicMetaObjectProvider Members
    DynamicMetaObject IDynamicMetaObjectProvider.GetMetaObject(
        System.Linq.Expressions.Expression parameter)
    {
        return new DynamicCOMObjectMetaObject(parameter, this);
    }
    #endregion

    private class DynamicCOMObjectMetaObject : DynamicMetaObject
    {
        internal DynamicCOMObjectMetaObject(
            System.Linq.Expressions.Expression parameter,
            DynamicCOMObject value)
            : base(parameter, BindingRestrictions.Empty, value)
        {
        }

        public override DynamicMetaObject BindSetMember(SetMemberBinder binder,
            DynamicMetaObject value)
        {
            // Method to call in the containing class:
            string methodName = "SetValue";

            // setup the binding restrictions.
            BindingRestrictions restrictions =
                BindingRestrictions.GetTypeRestriction(Expression, LimitType);

            // setup the parameters:
            Expression[] args = new Expression[2];
            // First parameter is the name of the property to Set
            args[0] = Expression.Constant(binder.Name);
            // Second parameter is the value
            args[1] = Expression.Convert(value.Expression, typeof(object));

            // Setup the 'this' reference
            Expression self = Expression.Convert(Expression, LimitType);

            // Setup the method call expression
            Expression methodCall = Expression.Call(self,
                    typeof(DynamicCOMObject).GetMethod(methodName),
                    args);

            // Create a meta object to invoke Set later:
            DynamicMetaObject setDictionaryEntry = new DynamicMetaObject(
                methodCall,
                restrictions);
            // return that dynamic object
            return setDictionaryEntry;
        }

        public override DynamicMetaObject BindGetMember(GetMemberBinder binder)
        {
            // Method call in the containing class:
            string methodName = "GetValue";

            // One parameter
            Expression[] parameters = new Expression[]
            {                
                Expression.Constant(binder.Name)
            };

            DynamicMetaObject getDictionaryEntry = new DynamicMetaObject(
                Expression.Call(
                    Expression.Convert(Expression, LimitType),
                    typeof(DynamicCOMObject).GetMethod(methodName),
                    parameters),
                BindingRestrictions.GetTypeRestriction(Expression, LimitType));
            return getDictionaryEntry;
        }

        public override DynamicMetaObject BindInvokeMember(
            InvokeMemberBinder binder, DynamicMetaObject[] args)
        {
            Expression[] parameters = new Expression[2];
            Expression[] subs = new Expression[args.Length];

            parameters[0] = Expression.Constant(binder.Name);

            for (int i = 0; i < args.Length; i++)
                subs[i] = args[i].Expression;

            parameters[1] = Expression.NewArrayInit(typeof(object), subs);

            DynamicMetaObject methodInfo = new DynamicMetaObject(
                Expression.Call(
                Expression.Convert(Expression, LimitType),
                typeof(DynamicCOMObject).GetMethod("CallMethod"),
                parameters),
                BindingRestrictions.GetTypeRestriction(Expression, LimitType));
            return methodInfo;
        }
    }

    public object SetValue(string key, object value)
    {
        return m_comType.InvokeMember(key,
            BindingFlags.Instance | BindingFlags.SetProperty | BindingFlags.Public,
            null,
            m_comHolder,
            new object[] { value });   
    }

    public object GetValue(string key)
    {
        return m_comType.InvokeMember(key,
            BindingFlags.Instance | BindingFlags.GetProperty | BindingFlags.Public,
            null,
            m_comHolder,
            null);          
    }

    public object CallMethod(string methodName, params object[] parameters)
    {
        return m_comType.InvokeMember(methodName,
            BindingFlags.Instance | BindingFlags.InvokeMethod | BindingFlags.Public,
            null,
            m_comHolder,
            parameters);        
    }
} 
```

用法：

```
 using (dynamic client = new DynamicCOMObject("jniwrapper.elocomserver"))
        {                
            client.refreshIntray();
        } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T07:04:12.810

仅用于文档；有一个简短的方法：

```
class EloComServer : DynamicObject, IDisposable
{
    private Type javaClientType;
    private object elo;

    public EloComServer()
    {
        javaClientType = Type.GetTypeFromProgID("jniwrapper.elocomserver");
        elo = Activator.CreateInstance(javaClientType);
    }

    ~EloComServer()
    {
        this.Dispose();
    }

    public override bool TryInvokeMember(InvokeMemberBinder binder, object[] args, out object result)
    {
        try
        {
            result = javaClientType.InvokeMember(binder.Name,
                    BindingFlags.InvokeMethod | BindingFlags.Public | BindingFlags.Instance,
                    null, elo, args);

            return true;
        }
        catch
        {
            result = null;
            return false;
        }
    }

    public override bool TrySetMember(SetMemberBinder binder, object value)
    {
        try
        {
            javaClientType.InvokeMember(binder.Name,
                    BindingFlags.SetProperty | BindingFlags.Public | BindingFlags.Instance,
                    null, elo, new object[] { value });

            return true;
        }
        catch
        {
            return false;
        }
    }

    public override bool TryGetMember(GetMemberBinder binder, out object result)
    {
        try
        {
            result = javaClientType.InvokeMember(binder.Name,
                    BindingFlags.GetProperty | BindingFlags.Public | BindingFlags.Instance,
                    null, elo, new object[0]);

            return true;
        }
        catch
        {
            result = null;
            return false;
        }
    }

    #region IDisposable Members

    public void Dispose()
    {
        if (this.elo != null)
        {
            Marshal.ReleaseComObject(elo); 
        }
    }

    #endregion
} 
```

# facebook - Facebook - 您无权访问“http://www.yourapp/？” 在这台服务器上

> ID：10800462
> 
> 赞同：0
> 
> 时间：2012-05-29T13:46:52.707
> 
> 标签：facebook, permissions, access-denied, permission-denied

用户在尝试使用我的 Facebook 应用程序时收到以下消息：

> 拒绝访问 您无权访问“http://www.myapp/?” 在这台服务器上。
> 
> 参考#18.8f265dcc.1338297690.20407019

它在直接访问应用程序 (http://www.myapp/) 时有效，但不能通过 Facebook。

我有一个安全版本 (https)，​​它既可以直接使用也可以通过 Facebook 使用。

这在上周工作得很好。自 5/10 以来我没有进行过更新，现在它只是坏了。Facebook改变了什么？？？

帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T13:51:06.980

“http://www.myapp/？” si 不是安全连接。检查您的 Facebook 应用程序中的设置。如果您不在开发人员模式下，则必须使用安全连接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T15:38:13.500

我无法解决问题，但我确实找到了解决方法。我正在分享它，以防其他人有同样的问题。

基本上，我完全摆脱了不安全的版本。我进入我的开发者面板并更改了我的“Canvas URL”中的链接以指向我的安全版本，而不是不安全的版本。作为奖励，我现在只需要维护一组生产代码。

# java - 从泛型类型 T 中获取“类”对象

> ID：10800463
> 
> 赞同：14
> 
> 时间：2012-05-29T13:46:56.453
> 
> 标签：java, generics

我想制作返回 XML 文档的对象表示的通用函数（使用 JAXB）。我需要将“类”对象传递给 JAXBContext 构造函数，但是如何从 T 中获取它？

```
public <T> readXmlToObject(String xmlFileName, T  jaxbClass) {
   JAXBContext context = JAXBContext.newInstance(T.class); // T.class - here error, how to get it?
   .......
} 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-05-29T13:52:18.283

而是传递类对象，这很容易。

```
public <T> T readXmlToObject(String xmlFileName, Class<T>  jaxbClass) {
       JAXBContext context = JAXBContext.newInstance( jaxbClass ); // T.class - here error, how to get it?
       Object o = context.createUnmarshaller().unmarshal( new File( xmlFileName ) );
       return jaxbClass.cast( o );
} 
```

这里的想法是，由于您无法从对象中提取类型参数，因此您必须反过来：从类开始，然后操作对象以匹配类型参数。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-29T13:53:42.117

不要听别人的……你能明白的。

只需将`jaxbClass`参数的类型更改为`Class<T>`：

```
public <T> T readXmlToObject(String xmlFileName, Class<T> jaxbClass) {
   JAXBContext context = JAXBContext.newInstance(jaxbClass);
   .......
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-29T13:51:28.303

您无法在运行时获得类。Java 使用类型安全擦除来实现泛型，这意味着对泛型类型的理解仅适用于编译。如果要获取其类，则必须在运行时询问实际对象。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-29T13:52:42.773

看看[这个 SO 答案](https://stackoverflow.com/questions/3437897/how-to-get-class-instance-of-generics-type-t)。

基本上，类型 T 在运行时不可用 - Java 泛型会被[编译器擦除](http://docs.oracle.com/javase/tutorial/java/generics/erasure.html)。

幸运的是，您已经有了类的实例，因此您可以从那里获取类型信息：

```
public <T> readXmlToObject(String xmlFileName, T jaxbClass) {

   // if jaxbClass is an instance of the data object, you can do this: 
   JAXBContext context = JAXBContext.newInstance(jaxbClass.getClass());

   // alternatively if jaxbClass is an instance of the Class object: 
   JAXBContext context = JAXBContext.newInstance(jaxbClass);
   // ......
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-29T13:52:44.773

尝试通过类本身，像这样

```
public <T> readXmlToObject(String xmlFileName, Class<T> class) { 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-07-25T17:03:04.140

```
public class XYZ<T> {
    ...
    private Class<T> tClass;    
    ...
    public <T> readXmlToObject(String xmlFileName) {
       JAXBContext context = JAXBContext.newInstance(tClass);
       ...
    }
    ...
} 
```

# android - Android如何在位图xml中设置不透明度

> ID：10800473
> 
> 赞同：5
> 
> 时间：2012-05-29T13:47:45.363
> 
> 标签：android, xml, bitmap, drawable, alpha-transparency

我需要通过 xml 创建位图资源，例如：

```
<?xml version="1.0" encoding="utf-8"?>
<bitmap xmlns:android="http://schemas.android.com/apk/res/android"
    android:src="@drawable/btn_home"
    >
</bitmap> 
```

但我需要为此位图设置不透明度。有没有办法使用这个xml来做到这一点？我知道如果在位图标签中允许使用 Shape 标签，它会起作用，但我尝试了但没有成功。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T14:02:12.990

如果您在 ImageView 中显示位图，您可能可以使用该`ImageView.setAlpha(int)`方法。但是，如果 ImageView 是通过 RemoteViews 访问的，就像更新小部件时的情况一样，您将无法调用此方法（如果您尝试通过 RemoteViews 调用它，`RemoteViews.setInt(int, String, int)`则会收到一个异常告诉您）。

```
 private Bitmap adjustOpacity(Bitmap bitmap, int opacity)
    {
        Bitmap mutableBitmap = bitmap.isMutable()
                               ? bitmap
                               : bitmap.copy(Bitmap.Config.ARGB_8888, true);
        Canvas canvas = new Canvas(mutableBitmap);
        int colour = (opacity & 0xFF) << 24;
        canvas.drawColor(colour, PorterDuff.Mode.DST_IN);
        return mutableBitmap;
    } 
```

更多[信息](http://blog.uncommons.org/2011/01/12/adjusting-the-opacity-of-an-android-bitmap/)。最常见的就像你的问题。[如何在 Android 中为视图设置不透明度（Alpha）](https://stackoverflow.com/questions/2838757/how-to-set-opacity-alpha-for-view-in-android)

[来自 developer.android.com 的 Bitmap文档](http://developer.android.com/reference/android/graphics/drawable/BitmapDrawable.html)。

# html - 使用存储在数据库中的值的图像超链接

> ID：10800475
> 
> 赞同：1
> 
> 时间：2012-05-29T13:47:51.090
> 
> 标签：html, asp.net-mvc-3, sql-server-2008-r2

我试图让用户链接他们的 facebook、twitter 等，并显示相应链接的图像，这将把他们带到存储在数据库中的链接。

问题是，不是给我“www.facebook.com”之类的东西，而是给我“http://localhost:60619/User/www.facebook.com”

现在我用来得到这个。

```
<a href="@Url.Action(@Model.Facebook)">
<img src="@Url.Content("~/Content/images/Facebook.gif")" alt="Facebook" /></a> 
```

Url.Action 已设法删除 /User/Profile/www.facebook.com 并替换为 /user/www.facebook.com 但我不能让它只是“www.facebook.com”。

编辑：我已经弄清楚了，但感谢您的帮助！我只需要添加验证，以便用户在开始时输入 http://，或者在存储之前手动添加它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T13:57:09.283

```
@{
    var url = @Model.Facebook.Split('/');
    <a href="@url[url.Length]">...</a>

} 
```

# php - 选择早于的时间戳

> ID：10800477
> 
> 赞同：6
> 
> 时间：2012-05-29T13:48:03.413
> 
> 标签：php, mysql, timestamp

我如何从数据库中选择超过 12 小时的项目？！我使用时间戳列来存储时间，但我认为我不需要年、月、日只有几个小时我有这样的东西但它不起作用（没有错误只是从表中返回所有数据）

```
$sql = "SELECT *FROM Y WHERE X and time > now() - INTERVAL 12 HOUR"; 
```

* * *

类型：时间戳

你是对的萨尔曼A。谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-29T13:53:57.927

尝试这个 ：

```
SELECT * FROM Y WHERE X and time < (NOW() - INTERVAL 12 HOUR) 
```

你需要`<`而不是`>`你想选择超过 12 小时的记录

# c++ - 使用 eng.notation 在 C++ Builder 中显示浮点数

> ID：10800479
> 
> 赞同：-1
> 
> 时间：2012-05-29T13:48:04.603
> 
> 标签：c++, string, floating-point, c++builder

如何使用 C++ Builder String 类以[工程符号](http://en.wikipedia.org/wiki/Engineering_notation)显示浮点数？（Unicode 字符串）

当然必须存在为此的预制功能吗？我找不到一个。我唯一遇到的是 String::FloatToStrF()，但它似乎不支持工程符号。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T02:38:45.627

[这是以工程符号打印的代码，从该站点](http://www.cs.tut.fi/~jkorpela/c/eng.html)按原样提取。我不认为这有任何功劳。

```
#define MICRO "µ"

#define PREFIX_START (-24)
/* Smallest power of then for which there is a prefix defined.
   If the set of prefixes will be extended, change this constant
   and update the table "prefix". */

#include <stdio.h>
#include <math.h>

char *eng(double value, int digits, int numeric)
{
  static char *prefix[] = {
  "y", "z", "a", "f", "p", "n", MICRO, "m", "",
  "k", "M", "G", "T", "P", "E", "Z", "Y"
  }; 
#define PREFIX_END (PREFIX_START+\
(int)((sizeof(prefix)/sizeof(char *)-1)*3))

      int expof10;
      static unsigned char result[100];
      unsigned char *res = result;

      if (value < 0.)
        {
            *res++ = '-';
            value = -value;
        }
      if (value == 0.)
        {
        return "0.0";
        }

      expof10 = (int) log10(value);
      if(expof10 > 0)
        expof10 = (expof10/3)*3;
      else
        expof10 = (-expof10+3)/3*(-3); 

      value *= pow(10,-expof10);

      if (value >= 1000.)
         { value /= 1000.0; expof10 += 3; }
      else if(value >= 100.0)
         digits -= 2;
      else if(value >= 10.0)
         digits -= 1;

      if(numeric || (expof10 < PREFIX_START) ||    
                    (expof10 > PREFIX_END))
        sprintf(res, "%.*fe%d", digits-1, value, expof10); 
      else
        sprintf(res, "%.*f %s", digits-1, value, 
          prefix[(expof10-PREFIX_START)/3]);
      return result;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T14:39:38.520

如果科学记数法适合您，您可以使用`stringstream`：

```
std::stringstream s;
double x = 0.0005;
s << std::scientific << x; 
```

这应该会给你类似“5.000000e-04”的东西。

如果你真的需要工程符号，你可以自己写一个像这样的转换（我知道这绝不是为速度优化的）：

```
#include <math.h>

SomeSortOfString floatToEngineering(double x)
{
    int exp = 0, sign = 1;
    if (x < 0.0) {
        x = -x;
        sign = -sign;
    }
    while (x >= 1000.0) {
        x /= 1000.0;
        exp += 3;
    }
    while (x < 1.0) {
        x *= 1000.0;
        exp -= 3;
    }
    if (sign < 0)
        x = -x;
    return floatToSomeSortOfString(x) + "e" + intToSomeSortOfString(exp);
} 
```

如果您使用对数，您可以简化它以摆脱循环除法/乘法。

# asp.net-mvc - jasig asp.net mvc cas 客户端页面未正确重定向

> ID：10800483
> 
> 赞同：1
> 
> 时间：2012-05-29T13:48:19.337
> 
> 标签：asp.net-mvc, client, cas, jasig

我一直在使用 jasig .net cas 客户端。我在本地计算机上设置了 cas 服务器，可以使用`https://localhost:8443/cas-server-webapp-3.4.12/login`

我在帐户控制器登录操作上设置了授权属性。

我正在关注此网址[https://wiki.jasig.org/pages/viewpage.action?pageId=32210981中给出的所有内容](https://wiki.jasig.org/pages/viewpage.action?pageId=32210981)

当我运行该应用程序时，它确实进入了 cas 登录页面，但在身份验证后它返回，`http://localhost:1672/`然后在浏览器中它给出错误，因为“页面没有正确重定向”。

我不知道我是怎么得到这个错误的，一切都在 web.config 中正确设置。

请帮忙

当我使用`http://localhost:8080/cas-server-webapp-3.4.12/login`（非安全网址）而不是`https://localhost:8443/cas-server-webapp-3.4.12/login`（安全网址）时，它可以工作。

我认为我的自签名证书有问题。是否可以创建有效的证书并使用它。至少我应该尝试创建一个有效的证书并尝试。但我不知道如何创建有效的证书。还请告诉我如何创建有效的证书。我尝试了谷歌但没有成功找到如何创建有效证书，以便浏览器不显示“自签名证书错误”。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-15T07:06:58.460

根据我自己的经验，除了让自签名证书正常工作：

我必须将自签名证书从`SSO`服务器安装到托管 webapp 的 Windows 2008 Server）。

`Trusted Root Cert Authorities`在用户帐户和机器帐户下安装证书。

您可以在`MMC`添加证书管理单元下执行此操作。

使用 IE 测试您的设置以浏览到有问题的 sso 服务器。您应该不会再看到有关证书的警告。记得用 IE 来检查，其他浏览器似乎并不关心 Trusted Root Cert 的设置。

接下来，当部署 ASP MVC 时，我必须使用经典的应用程序池，并且对于我的 cas 配置设置，`web.config`将 the`proxyTicketManager`和 the都保留`gatewayStatusCookieName`为空字符串。

我直接连接到 sso 服务器，所以这两个被取出，否则协议错误和无限循环。

然后不再抱怨无限重定向循环。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-02T17:37:55.757

我发现了问题所在。当我们使用安全连接时，我们需要在双方、CAS 服务器端和我们的 web 应用程序端都有 SSL 证书。

所以在CAS服务器端它必须是

`https://localhost:8443/cas-server-webapp-3.4.12/login`

在我们的网络应用程序端，它必须是

```
https://servername/mywebapp 
```

如果您使用的是自签名证书，请确保运行 CAS 的服务器信任 Web 应用程序的证书。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-29T14:36:09.657

您应该在 web.config 中指定成功登录后的返回 url（只是服务器而不是整个 url）示例：您的应用程序已开启`http://localhost:8080/someWebApp/`

当您进入登录页面时，您可以在查询字符串参数上看到已编码的返回 url

```
<casClientConfig casServerLoginUrl="https://localhost:8443/cas-server-webapp-3.4.12/login" 
                   casServerUrlPrefix="https://localhost:8443/cas-server-webapp-3.4.12/" 
                   serverName="http://localhost:8080" 
                   notAuthorizedUrl="~/notAuthorized.html" 
                   cookiesRequiredUrl="~/CookiesRequired.html" 
                   redirectAfterValidation="true" 
                   renew="false" 
                   singleSignOut="true" 
                   ticketValidatorName="Cas20" 
                   serviceTicketManager="CacheServiceTicketManager"/> 
```

# c# - C# webclient 对象中标头的用途是什么

> ID：10800484
> 
> 赞同：-1
> 
> 时间：2012-05-29T13:48:20.140
> 
> 标签：c#, web

C# webclient 对象中标头的用途是什么？为什么我们使用这个属性？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T13:52:02.143

它允许您设置将随请求发送的 HTTP 请求标头。例如，如果服务器端脚本需要`User-Agent`标头，您可以像这样设置它：

```
using (var client = new WebClient())
{
    client.Headers[HttpRequestHeader.UserAgent] = "Mozilla/5.0 (Windows NT 6.1) AppleWebKit/536.5 (KHTML, like Gecko) Chrome/19.0.1084.52 Safari/536.5";
    string result = client.DownloadString("http://www.google.com");
} 
```

[您可以在HTTP 协议](http://www.w3.org/Protocols/rfc2616/rfc2616.html)规范中阅读到许多 HTTP 标头。

# visual-studio-2010 - 在 Visual Studio 2010 中，有没有一种方法可以快速切换选项卡和缩进大小，而无需每次都导航选项？

> ID：10800485
> 
> 赞同：2
> 
> 时间：2012-05-29T13:48:22.400
> 
> 标签：visual-studio-2010

我在 Visual Studio 2010 中进行 WinForms 和 Web 开发。Web 开发人员使用四个空格的选项卡大小，而 WinForms 开发人员使用两个空格大小的选项卡。

由于我在两者之间来回切换，我想知道是否有一种快速的方法可以做到这一点，而不必每次都导航选项？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T14:09:52.393

没有专门的快捷方式，但让我们做一个吧！

只需点击`Alt+F11`以调出宏编辑器并将以下代码添加到新模块：

```
Imports System
Imports EnvDTE
Imports EnvDTE80
Imports EnvDTE90
Imports EnvDTE90a
Imports EnvDTE100
Imports System.Diagnostics

Public Module Tabspaces
    Sub TwoTabSpaces()
        Dim tabs As Properties

        tabs = DTE.Properties("TextEditor", "AllLanguages")
        tabs.Item("TabSize").Value = 2
        tabs.Item("IndentSize").Value = 2

    End Sub

    Sub FourTabSpaces()
        Dim tabs As Properties

        tabs = DTE.Properties("TextEditor", "AllLanguages")
        tabs.Item("TabSize").Value = 4
        tabs.Item("IndentSize").Value = 4

    End Sub

End Module 
```

然后保存您的宏并从*工具菜单中调出**选项*窗口并选择*环境->键盘*：

 **![分配宏](../Images/4e2de9f3267a16692a1e09ea3ba0d572.png)

在这里，您可以搜索包含“*宏*”的命令，您应该会看到您的`TwoTabSpaces()`和`FourTabSpaces()`列出的。
您现在可以为这些宏分配键盘快捷键。在上图中，我分别选择了`Alt+T, Alt+2`和`Alt+T, Alt+4`（t=Tabs，2=两个空格等）

当然，您可以根据需要自定义它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-18T14:36:59.983

我想我会分享我的个人宏，它会根据语言进行切换。您可以设置键盘快捷键，如 Widor's [answer](https://stackoverflow.com/a/10800879/945456)中建议的那样。

```
Public Sub ToggleSpaces()
  If DTE.ActiveDocument.Language = "Basic" Then
    Dim textEditorSettings = DTE.Properties("TextEditor", "Basic")

    Dim currentSize = CShort(textEditorSettings.Item("TabSize").Value)

    'If at 2, use 4... else switch to 2
    Dim newSpaces As Short = If(currentSize = 2, 4, 2)    

    textEditorSettings.Item("TabSize").Value = newSpaces
    textEditorSettings.Item("IndentSize").Value = newSpaces
  End If
End Sub 
```

我的宏改编自 James Alexander 的宏，用于在以下 StackOverflow[问题中找到“在](https://stackoverflow.com/questions/4298909/visual-studio-any-one-click-switch-between-tabs-and-spaces-indentation)[每个项目的前导选项卡或空格之间切换](http://www.jamesralexander.com/blog/content/visual-studio-toggle-between-leading-tabs-or-spaces-project)” 。**

# php - 使用 php 从远程、动态创建的文本文件中获取数据

> ID：10800496
> 
> 赞同：0
> 
> 时间：2012-05-29T13:48:38.737
> 
> 标签：php, fopen, file-get-contents, fread

我正在尝试从远程文本文件中获取（使用 PHP）数据。该文件的 URL 是 website.com/page.php?info=someinfo。所以它不是一个 .txt 文件，我不知道这是否重要。然而，页面的全部内容都是文本。查看源代码时，没有 HTML，只有纯文本。

我一直在尝试使用 fopen() 和 fread() 以及 file_get_contents 来获取数据。但是，这两种方法都会给我一个充满“404，找不到对象”错误的屏幕，到处都是。有谁知道如何解决这个问题？

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T14:10:33.913

"website.com/page.php?info=someinfo" 不是文本文件，这是一个 HTML 流。

如果您想嗅探从“website.com/page.php?info=someinfo”查询产生的 html 内容，那么您必须仅使用 file_get_contents，而不是 fread 或 fopen。

# javascript - 如何使用 Require.js 和 Backbone 动态加载 javascript 文件？

> ID：10800497
> 
> 赞同：0
> 
> 时间：2012-05-29T13:48:44.367
> 
> 标签：javascript, backbone.js, requirejs

在我的应用程序中，并非所有用户都可以使用相同的模块。所以，我想根据我加载的 json 加载路线。这可行，但我无法在 Backbone 中初始化路由。要加载文件，我使用 Require.js。

为了让一切正常，我使用以下代码：

```
 var initialize = function () {

    //TODO Authentication check
    $.ajax({
        url: '/auth/test@test.com/test'
    });

    moduleNames = new Array();
    appNames = new Array();
    menu = new menuCollection;
    menu.fetch( {
        success: function(collection) {
            collection.each(function(menuitem) {
                moduleNames.push('apps/' + menuitem.attributes.href + '/router');
                appNames.push(menuitem.attributes.href);
            });

//Here something goes wrong
            require(moduleNames, function(appNames) { 
//////////////////
                $.each(appNames, function(i, routerName) {
                    console.log(routerName);
                    objectName = 'router' + routerName.capitalize();
                    console.log(objectName);
                    varname = routerName + '_router';
                    console.log(varname);
                    var varname = this[objectName];
                    console.log(varname);
                });
                var home_router = new routerHome;
                Backbone.history.start();
            });
        }
    });
}; 
```

典型的路由器文件如下所示：

```
// Filename: router.js
define([
'jquery',
'underscore',
'backbone',
'apps/profile/views/info',
'apps/profile/views/contact',
], function ($, _, Backbone, viewInfo, viewContact) {
var routerSilentbob = Backbone.Router.extend({
    routes:{
        // Define some URL routes
        'silentbob':            'showInfo',
        'silentbob/info':       'showInfo',
        'silentbob/contact':    'showContact'
    },
    showInfo:function () {
        alert('testt');
    },
    showContact:function () {
        viewContact.render();
    }
});

return routerSilentbob;
}); 
```

这是菜单对象：

```
[{"uuid":"041e42ee-9649-44d9-8282-5113e64798cf","href":"silentbob","title":"Silent Bob"},{"uuid":"111127aa-fdfc-45e5-978f-46f1d0ea0d89","href":"menu","title":"Menu"},{"uuid":"985574e5-f7ae-4c3f-a304-414b2dc769bb","href":"youtubeengine","title":"Youtube Engine"},{"uuid":"cc84424d-9888-44ef-9895-9c5cce5a999b","href":"cardgamesdk","title":"Cardgame SDK"},{"uuid":"73f4d188-4ec5-4866-84ec-ea0fa5901786","href":"flash2flashvideo","title":"Flash2Flash videotelefonie"},{"uuid":"0702f268-116d-4d62-98e2-8ca74d7ce5f3","href":"appstore","title":"Menu"},{"uuid":"2f8606e3-b81d-43bc-a764-a0811e402c6d","href":"me","title":"Mijn profiel"},{"uuid":"bb1acae2-a6c7-404c-861c-b8a838a19614","href":"contacts","title":"Contacten"},{"uuid":"9b6e6022-fe01-40ab-b8fb-df70d31c3b28","href":"messaging","title":"Berichten"},{"uuid":"29489359-3685-4b77-9faa-6c9f63e5fe09","href":"calendar","title":"Kalender"},{"uuid":"1c9541ff-2a25-40ca-b382-3c953d440f35","href":"cubigotv","title":"Cubigo TV"},{"uuid":"5b7af683-941b-45d7-bfae-9a9e12bb09c0","href":"links","title":"Websites"},{"uuid":"27efca4c-2b64-455d-8622-367f0f13d516","href":"ideabox","title":"Idee\u00ebn"},{"uuid":"84d2c2ea-7ce7-413e-963f-7b729590b5d9","href":"companyguide","title":"Bedrijven"},{"uuid":"2a61899f-d9de-478e-a03c-64a5fd6214d7","href":"associations","title":"Verenigingen"},{"uuid":"0cf05900-cee7-4f2e-87ae-7967315c2b93","href":"myneighbourhood","title":"Mijn buurt"},{"uuid":"01ae757b-d6a3-4ab0-98cb-a741572122bf","href":"htmlwebsite","title":"HtmlWebsite"}] 
```

所以，我找不到正确的方法来获取路由器的对象并将它们加载到 Backbone。有没有一种方法不需要变量作为函数的参数？或者我可以加载不同的内容吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T14:21:06.220

让“路由器”模块返回传递给的对象文字`Backbone.Router.Extend()`

```
define([], function () {
    return {
        // Router Definition here
    }
}) 
```

然后像这样创建一个路由器模块：

```
define(arrayOfModulePaths, function () { 

    return {
        listen: function(module) {
            var Router = Backbone.Router.Extend(arguments[module]);
            var router = new Router();
            Backbone.history.start();
        }
    }
}) 
```

然后你可以简单地要求路由器模块并将模块索引传递给`router.listen()`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T09:40:48.237

```
 require(moduleNames, function() { 
    var routerObjs = {};

                    $.each(arguments, function(i, CustomRoute) {
                        var routerName = appNames[i];
                        routerObjs['router' + routerName.capitalize()] = CustomRoute;
                    });
                    var home_router = new routerObjs.routerHome;
                    Backbone.history.start();
                }); 
```

# html - li:last-child 似乎在 IE8 中不起作用

> ID：10800498
> 
> 赞同：3
> 
> 时间：2012-05-29T13:48:48.780
> 
> 标签：html, css, internet-explorer-8, css-selectors

下面是我的html结构

```
<div class="footerMenu">
   <ul>
     <li>Home</li>
     <li>About</li>
     <li>Feedback</li>
     <li>Contact us</li>        
   </ul>            
</div> 
```

但

```
.footerMenu li:last-child { } 
```

选择器似乎在 IE8 中不起作用。但是[http://msdn.microsoft.com/en-us/library/cc351024%28VS.85%29.aspx](http://msdn.microsoft.com/en-us/library/cc351024%28VS.85%29.aspx)告诉我们支持伪选择器。对此有任何帮助！

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-05-29T13:53:34.587

你读错了。它说它在 IE8 中不受支持**：**

![](../Images/d061c943cb331b1a4e28c17e779d94ee.png)

如果您正在查看`:first-child`IE7 和 IE8 支持，并认为这同样适用于`:last-child`......惊喜！它没有。

`:first-child`是一个 CSS2 选择器，但`:last-child`仅在 CSS3 中引入，因此由于 Microsoft 的目标只是 CSS2.1 与 IE8 的兼容性，因此他们可能`:last-child`直到 IE8 之后才关心。

如果你知道你只有四个`li`元素，那么你应该能够使用相邻的兄弟选择器来达到第四个`li`：

```
.footerMenu li:first-child + li + li + li 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-29T13:56:02.693

为了建立其他人的答案，另一种选择是使用 javascript 来填补空白，selectivizr 是添加最后一个孩子支持的一个很好的例子。

[http://selectivizr.com/](http://selectivizr.com/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-29T13:53:36.717

您提供的链接显示它不支持 IE8... 仅 IE9+。谷歌搜索 last-child IE8 带来了一大堆类似的查询。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-29T13:54:10.450

你在哪里读到的？`:first-child`支持回 IE7，但`:last-child`IE9 及更高版本。

![不，它没有。](../Images/257d7a4c398ba3f1c44c39d915d75c80.png)

（为方便起见，标题向下移动）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-29T14:00:47.213

尝试使用类似的东西：

```
.footerMenu li {background-color: expression(this.previousSibling==null?'red':'green');} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-29T13:55:41.503

其他答案是正确的，IE8 不支持最后一个孩子。但是，为了解决您的特定问题，您可以a）手动将一个类添加到最后一个`<li>`或b）因为这是一个菜单，并且这些可能在其中有链接，使用属性选择器定位最后一个链接，这确实有效在 IE8 中。就像是

```
.footermenu a[href="contact.html"] { ... } 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-06-18T23:28:41.153

我知道它很旧，但是......有一种简单的方法可以做到：

只是在你想要改变的 li 中这样做：

`<li style="yourstyle;">`...`</li>`

# java - gson json解析器：没有键的值

> ID：10800508
> 
> 赞同：6
> 
> 时间：2012-05-29T13:49:11.760
> 
> 标签：java, json, gson

我想解析这样的json结构：

```
{"response":
    {
    "arr1":[count,{...}],
    "arr2":[count,{...}]
    }
} 
```

如果 count 有键“count”（例如），一切都很好。但是钥匙是空白的。有没有办法映射这个结构并手动检索这个值，或者我需要自己解析所有这些 json 而没有 gson ？

**更新**

这是一个有效的 json（通过[http://jsonlint.com/](http://jsonlint.com/)检查）

```
{
    "response": {
        "arr1": [
            615,
            {
                "body": "hi",
                "title": "Re(2):  ..."
            },
            {
                "body": "hello",
                "title": "Re(23):  ..."
            }
        ],
        "arr2": [
            132,
            {
                "body": "hi",
                "title": "Re(2):  ..."
            },
            {
                "body": "hello",
                "title": "Re(23):  ..."
            }
        ]
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-30T09:30:45.990

如果你想解析任意集合，你应该阅读[Serializing and Deserializing Collection with Objects of Arbitrary Types](http://sites.google.com/site/gson/gson-user-guide#TOC-Serializing-and-Deserializing-Collection-with-Objects-of-Arbitrary-Types)并查看示例代码[示例代码](http://code.google.com/p/google-gson/source/browse/trunk/extras/src/main/java/com/google/gson/extras/examples/rawcollections/RawCollectionsExample.java)。

# pax - Pax Web Whiteboard ResourceMapping 的路径可以指向捆绑包之外吗？

> ID：10800518
> 
> 赞同：1
> 
> 时间：2012-05-29T13:49:42.710
> 
> 标签：pax, pax-web

我尝试将以下内容注册`ResourceMapping`为 OSGi 服务：

```
package ru.focusmedia.odp.server.poim.http;

import org.ops4j.pax.web.extender.whiteboard.ResourceMapping;

import ru.focusmedia.odp.server.poim.api.PoimConfig;

import aQute.bnd.annotation.component.Component;

@Component(immediate = true)
public class PoimResourceMapping implements ResourceMapping {
    private String httpContextId;
    private String alias = "...";
    private String someAbsolutePath = "...";

    @Override
    public String getHttpContextId() {
        return httpContextId;
    }

    @Override
    public String getAlias() {
        return "/resources";
    }

    @Override
    public String getPath() {
        return someAbsolutePath;
    }

} 
```

但在浏览器下看不到结果`http://127.0.0.1:8282/resources/aFileUnderMyPath`。我可以看到 Pax Web 正在日志中访问我的映射。这是可能的还是我需要编写一个servlet？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T16:59:36.297

最简洁的答案是不。

是相对于捆绑包解析的`path`，因此您的绝对路径将出现一些 url 语法错误。

为什么不将您的文件打包加载并从那里提供呢？我们动态加载包含我们需要遵循一些版本控制约定的资源的包。

# jsf-2 - 单击命令按钮时未触发 OnBlur 事件？

> ID：10800525
> 
> 赞同：0
> 
> 时间：2012-05-29T13:49:56.947
> 
> 标签：jsf-2

我开发了一个复合组件如下...

```
<composite:implementation>   
        <div class="numericBox">
            <h:inputText id="txtInput"
                         size="#{cc.attrs.maxLength}"
                         converterMessage="#{cc.attrs.converterMessage}"
                         validatorMessage="#{cc.attrs.validatorMessage}"
                         required="#{cc.attrs.required}"
                         requiredMessage="#{cc.attrs.requiredMessage}"
                         minlength="#{cc.attrs.minLength}"
                         maxlength="#{cc.attrs.maxLength}"
                         value="#{cc.attrs.value}">
                <f:ajax event="blur" render="@this err"/>
                <f:ajax event="blur" render="#{cc.attrs.renderParent}" disabled="#{empty cc.attrs.renderParent}"/>
            </h:inputText>
        </div>
        <h:panelGroup id="err">
            <utils:fieldError_right id="errText" group="#{cc.clientId}-txtInput"/>
        </h:panelGroup>
    </div>
</composite:implementation> 
```

我有一个如下所示的命令按钮..

```
<h:commandButton id="btnNext" styleClass="btnNext" action="#{someBean.next}"/> 
```

现在我以以下方式使用组件...（仅显示裸骨表示）

```
 <util:numericInput label="Label" value="#{somebean.number}"
                           maxLength="2" optional="true" renderParent="-vehVal"

/>

    <h:panelGroup id="vehVal">
    <util:amountInput label="label2" value="#{someBean.nubmer2}"                    
                     rendered="#{someBean.number > 0}"
                     required="#{someBean.number > 0}" />
    </h:panelGroup> 
```

所以基本上我想在用户在“numericInput”组件中输入某个值 > 0 时呈现“amountInput”组件。当我在第一个字段中输入一些值并单击浏览器中的某个位置时，它工作正常。但是，如果我在字段中输入一些值并直接单击下一步按钮，它会将我带到下一页，而无需验证（呈现）下一个字段。我所能理解的是，当我单击下一个按钮时，不会触发 onBlur 事件。为什么 ？？有什么解决办法吗？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T17:08:59.373

可能是事件被触发了，但是表单也被提交了，所以下一个视图会被渲染，你会错过 ajax 事件的结果。

您可能必须使用比 更直接的事件`blur`，例如`keyup`。此外，如果`someBean.number`大于 0 并且`someBean.number2`为空，您可以有条件地禁用该按钮。

# android - 为什么这个 onTouchListener 会抛出 NullPointerException？

> ID：10800529
> 
> 赞同：0
> 
> 时间：2012-05-29T13:50:20.750
> 
> 标签：android, nullpointerexception, touch-event, ontouchlistener

我不明白，我在同一个应用程序的主要活动中使用了相同的代码，并且运行良好。但是当我在其他活动中使用它时，它会抛出 NullPointer .... 这是为什么？

```
 private TextView drag_txtSeconds; 

     @Override
 public void onCreate(Bundle savedInstanceState) {  
    super.onCreate(savedInstanceState);
    setContentView(R.layout.drag_layout); 

       drag_txtSeconds = (TextView)findViewById(R.id.TxtSeconds); 

       drag_txtSeconds.setOnTouchListener(new OnTouchListener() {
            public boolean onTouch(View v,MotionEvent event) {
                return true; 
            }});
         } 
```

希望你能帮我 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T14:46:54.103

确保您的文件`drag_layout`具有`TextView`以下属性：

```
android:id="@+id/TxtSeconds" 
```

这是区分大小写的，可能是由于大写字母，请尝试在布局和代码中使用全部小写。

# php - 我怎样才能逐渐使数组更稀疏？

> ID：10800530
> 
> 赞同：3
> 
> 时间：2012-05-29T13:50:24.723
> 
> 标签：php, language-agnostic

我有一个完全填充的值数组，我想从这个数组中任意删除元素，并在远端删除更多元素。

例如，给定输入（其中 . 表示填充索引）

```
............................................ 
```

我想要类似的东西

```
....... . ...  .. .  .  ..    .          . 
```

我的第一个想法是计算元素，然后遍历数组，在当前索引和数组总大小之间生成一个随机数，例如：

```
if ( mt_rand( 0, $total ) > $total - $current_index ) 
    //remove this element 
```

但是，由于这需要在每次循环循环时生成一个随机数，因此变得非常困难。

有没有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T14:48:36.037

这很可能不是最好/最有效的方法，但这是我能想到的最好的方法，[它确实有效](http://codepad.org/jg1fg9Sb)。

*注意键盘示例需要很长时间才能执行，但这是因为我在末尾添加了漂亮的打印循环，因此您可以看到它明显有效。如果删除内部循环，执行时间会下降到可接受的水平。*

```
<?php

  $array = range(0, 99);

  for ($i = 0, $count = count($array); $i < $count; $i++) {

    // Get array keys
    $keys = array_keys($array);

    // Get a random number between 0 and count($keys) - 1
    $rand = mt_rand(0, count($keys) - 1);

    // Cut $rand elements off the beginning of the keys
    $keys = array_slice($keys, $rand);

    // Unset a random key from the remaining keys
    unset($array[$keys[array_rand($keys)]]);

  } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-29T14:05:34.640

一种简单的方法是为每个条目翻转一个加权硬币，硬币翻转在最后的权重更大。例如，如果数组大小为 n，则对于每个条目，您可以从`0`to 中选择一个随机数，`n-1`并且仅当索引小于或等于随机数时才保留该值。（也就是说，保留每个条目的概率`1 - index/total`。）这有一个很好的优势，如果你无论如何都要压缩你的数组，并且你正在使用一个足够好但有效的随机数生成器（可能是一个简单的整数散列一个随机数），内存访问会相当快。

另一方面，如果您只是删除了一些项目并且没有重新排列数组，您可以使用某种加权随机数生成器，它更经常选择接近索引末尾的数字。例如，如果您有一个随机数生成器生成 [0,1] 值的浮点数（封闭或开放边界不太可能），请考虑获取这样的随机浮点数`r`并将其平方。这将倾向于使用较低的值。您可以通过翻转它来解决此问题：`1-r^2`. 当然，您需要它在 to 的索引范围内`0`，`n - 1`所以取`floor(n * (1 - r^2))`并向下舍`n`入 to `n-1`。

这两种技术实际上有无数种变化。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-29T15:22:55.870

这个方法不是随机的——它通过你定义一个函数和它的逆来工作。不同的函数，具有不同的常数系数，会有不同的分布特征。

结果非常类似于模式，正如将连续函数映射到数组等离散结构时所预期的那样。

这是使用二次函数的示例。你可以尝试改变常数。

演示：[http ://codepad.org/ojU3s9xM](http://codepad.org/ojU3s9xM)

```
#as in y = x^2 / 7;
function y($x) {
    return $x * $x / 7;
}
function x($y) {
    return 7 * sqrt($y);
}

$theArray = range(0,100);
$size = count($theArray);

//use func inverse to find the max value we can input to $y() without going out of array bounds
$maximumX = x($size);
for ($i=0; $i<$maximumX; $i++) {
    $index = (int) y($i);

    //unset the index if it still exists, else, the next greatest index
    while (!isset($theArray[$index]) && $index < $size) {
        $index++;
    }

    unset($theArray[$index]);
}

for ($i=0; $i<$size; $i++) {
    printf("[%-3s]", isset($theArray[$i]) ? $theArray[$i] : '');
} 
```

# java - Android API 15，无法创建新的 AVD

> ID：10800535
> 
> 赞同：0
> 
> 时间：2012-05-29T13:50:37.080
> 
> 标签：java, android, sdk, avd

我今天开始使用 Android SDK。我已经为 4.0.3 (API15) 安装了带有他所有软件包的 Android SDK。是的，我已经安装了 ARM EBAI v7a 系统映像！

我还为我的 Eclipse (Indigo) 安装了 ADT，并检查了所有内容是否已更新。但是当我尝试创建一个新的 AVD 时，我收到了这个错误：“无法找到 ABI armeabi 的 'userdata.img' 文件以复制到 AVD 文件夹中。”

我只是不知道问题是什么我已经尝试了我在这里和网上找到的所有修复程序，但我无法让它工作......

我的细节：

操作系统：WinXP SP3

JDK：1.7.0_03（Orcal 的）

SDK：Android 4.0.3 API 15

顺便说一句，对不起我的英语不好。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T14:20:38.730

> JDK：1.7.0_03（Orcal 的）

android 工具[不支持](http://developer.android.com/sdk/requirements.html)JDK 7 。
尝试使用 JDK 6 安装，看看它是否能解决问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T15:39:15.193

最近有这个问题，可能不适合你，但我遇到的问题是在“创建新的 AVD”页面上。在“CPU/ABI”下确保有一个选择——通常是 ARM (armeabi-v7a)。

我的是空白的，所以我必须自己设置它，然后错误就消失了。

# javascript - html 动态地图/区域标签

> ID：10800537
> 
> 赞同：2
> 
> 时间：2012-05-29T13:50:38.933
> 
> 标签：javascript, jquery, html

我想在宽度和高度设置为填充窗口的图像上使用地图标签。如果用户调整窗口大小，我怎样才能确保坐标映射出他们应该的样子？我将使用 jQuery 1.7，如果这很重要，我想支持所有主要的浏览器，从 7+ 开始支持 IE。

# entity-framework - 在实体框架中映射表时的多重性问题

> ID：10800540
> 
> 赞同：0
> 
> 时间：2012-05-29T13:50:46.907
> 
> 标签：entity-framework

我目前有一堂课：

```
[Table("TitleCategoryMovie", Schema = "dbo")]
public class TitleCategoryMovie
{
    [Key]
    public int Id { get; set; }

    public string CreatedBy { get; set; }
    public DateTime CreateDatetime { get; set; }
    public string UpdatedBy { get; set; }
    public DateTime UpdateDatetime { get; set; }

    [ForeignKey("Id")]
    public virtual Title Title { get; set; }
} 
```

有一个表叫`Title`. 并且每个`TitleCategoryMovie`都有一个对应的`Title`，虽然不是每个`Title`都有一个`TitleCategoryMovie`。Title列`Id`与 TitleCategoryMovie 相同。但是当我将两个实体类添加到我的 DbContext 时，它给了我一个错误：

`Multiplicity is not valid in Role 'TitleCategoryMovieStandalone_Title_Source' in relationship 'TitleCategoryMovieStandalone_Title'. Because the Dependent Role refers to the key properties, the upper bound of the multiplicity of the Dependent Role must be �1�.`

我已经将我的列定义`Id`为主`TitleCategoryMovie`键和外键`Title`，所以我不知道为什么它会给我这个错误。怎么了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T13:55:54.953

您还应该添加一个`TitleId`字段并将该字段用作`[ForeignKey]`属性中的参数：

```
[Table("TitleCategoryMovie", Schema = "dbo")]
public class TitleCategoryMovie
{
    [Key]
    public int Id { get; set; }

    public string CreatedBy { get; set; }
    public DateTime CreateDatetime { get; set; }
    public string UpdatedBy { get; set; }
    public DateTime UpdateDatetime { get; set; }
    public int TitleId { get; set; }

    [ForeignKey("TitleId")]
    public virtual Title Title { get; set; }
} 
```

### 评论后更新

我相信这样的事情应该有效：

```
[Table("TitleCategoryMovie", Schema = "dbo")]
public class TitleCategoryMovie
{
    [Key]
    public int Id { get; set; }

    public string CreatedBy { get; set; }
    public DateTime CreateDatetime { get; set; }
    public string UpdatedBy { get; set; }
    public DateTime UpdateDatetime { get; set; }

    public virtual Title Title { get; set; }
}

[Table("Title", Schema = "dbo")]
public class Title
{
    [Key]
    [ForeignKey("TitleCategoryMovie")]
    public int Id { get; set; }
    public string Something { get; set; }

    public virtual TitleCategoryMovie TitleCategoryMovie { get; set; }
} 
```

您应该将该`[ForeignKey]`属性放在您认为是关系子级的类中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T16:55:07.347

我将两个实体映射到一个表。显然这在实体框架中是不允许的，所以这就是我收到该错误的原因。

# html - IE9 错误中的 Z 索引

> ID：10800550
> 
> 赞同：1
> 
> 时间：2012-05-29T13:51:40.223
> 
> 标签：html, css, internet-explorer, z-index

我目前正在一个网站上工作，我遇到了两个图像无法正确显示的问题。IE 9 是我唯一遇到问题的浏览器，所以我只需要一些帮助。我正在制作一个带有阴影背景的幻灯片。在幻灯片结束时，我试图创建两个透明的可点击 div，这样我就可以来回移动幻灯片。但是阴影背景图像被叠加在透明 div 的顶部，并覆盖除 div 的极端边缘之外的所有内容，只要光标变为指针就是当您在 div 上方时。

```
<div id="HomeCarousel">
        <div id="slideshow">
            <div id="slideshow-area">
                <div id="slideshow-shadow"><img src="@ACCOUNTRESOURCES/BannerOverlay.png" /></div>
                <div id="slideshow-container">
                    <div id="slideshow-scroller">
                        <div id="slideshow-holder">
                            <div class="slideshow-content" id="slide0">
                                <img name="image0" src="@ACCOUNTRESOURCES/Orange.png"/>
                            </div>
                            <div class="slideshow-content" id="slide1">
                                <img name="image1" src="@ACCOUNTRESOURCES/Green.png"/>
                            </div>
                            <div class="slideshow-content" id="slide2">
                                <img name="image2" src="@ACCOUNTRESOURCES/Blue.png"/>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="click">
                <div id="left-arrow"></div>
                <div id="right-arrow" ></div>
            </div>
        </div>
    </div> 
```

这是我的 html 布局，#slideshow-area 和 #left-arrow,#right-arrow 是我遇到问题的元素。

```
 #slideshow {
     position:relative;
   }
   #slideshow-area {
     position:absolute;
     left:35px;
         width:910px;
     height:279px;
   }
   #slideshow-shadow {
     position:absolute;
     width:966px;
     top:-22px;
     left:-28px;
     z-index:2;
   }
    #slideshow-container {
     position:absolute;
     overflow:hidden;
     width:910px;
     height:279px;
    }
    .slideshow-content {
     width:910px;
     height:279px;
    }
    #click {
     position:relative;
     position:absolute;
     z-index:4;
    }
    #left-arrow, #right-arrow {
     height:279px;
     width:35px;
     position:absolute;
     top:22px;
     z-index:3;
    }
    #left-arrow {
     left:0px;
     cursor:pointer;
    }
    #right-arrow {
     left:945px;
     cursor:pointer;
    } 
```

那是我的 CSS，据我所知，我做的事情是正确的，只是 IE 9 没有显示它。有人知道我能做些什么来解决这个问题吗？如果你需要，这里是[网站。](http://sites.deyone.com/northeastchurch12)

谢谢，

摩根

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T14:11:49.513

`div#click`没有高度；它是一个 980x0px 元素，因为它不包含非浮动、非定位元素。在此元素上定义高度，其中包含的箭头将按预期工作。

# android - 我应该如何实现滚动？

> ID：10800555
> 
> 赞同：0
> 
> 时间：2012-05-29T13:52:00.597
> 
> 标签：android, android-layout

我已经实现了自定义相对布局，其中使用 ScaleGestureListener 进行缩放，它还缩小了双击侦听器。现在我想在缩放后在我的自定义相对布局中实现平移，用户可以在缩放后平移吗？这是我的自定义相对布局..`

这是我的代码

```
public class ZoomLayout extends RelativeLayout implements OnDoubleTapListener, OnGestureListener{

//ScalingFactor i.e. Amount of Zoom
static float mScaleFactor = 1.0f;

// Maximum and Minimum Zoom
private static float MIN_ZOOM = 1.0f;
private static float MAX_ZOOM = 2.0f;

//Different Operation to be used 
    private final int NONE_OPERATION=0;
    private final int DRAG_OPERATION=1;
    private final int ZOOM_OPERATION=2;
    private float mWidth= 1280;
    private float mHeight=800; 

// Mode to select the operation
    private int mode;

//Track X and Y coordinate of the finger when it first touches the screen
    private float mInitialX = 0f;
    private float mInitialY = 0f;

// Track the Bound of the Image after zoom to calculate the offset  
static Rect mClipBound;

// mDetector to detect the scaleGesture for the pinch Zoom  
private ScaleGestureDetector mDetector;

// mDoubleTapDetector to detect the double tap 
private GestureDetector mDoubleTapDetector;

//Pivot point for Scaling
static float gx=0,gy=0;

boolean mdrag=false,mZoom=false;

public ZoomLayout(Context context, AttributeSet attrs) {
        super(context, attrs);
        setWillNotDraw(false);
        mClipBound = new Rect();
        // Intialize ScaleGestureDetector
        mDetector = new ScaleGestureDetector(getContext(), new ZoomListener());
        mDoubleTapDetector = new GestureDetector(context,this);
        mDoubleTapDetector.setOnDoubleTapListener(this);
    }

    public ZoomLayout(Context context) {
        super(context);
        setWillNotDraw(false);
        mClipBound = new Rect();
        // Intialize ScaleGestureDetector
        mDetector = new ScaleGestureDetector(getContext(), new ZoomListener());
        mDoubleTapDetector = new GestureDetector(context,this);
        mDoubleTapDetector.setOnDoubleTapListener(this);
    }

    @Override
    public boolean onTouchEvent(MotionEvent event) {

        // Handles all type of motion-events possible
        switch(event.getAction() ) {

        case MotionEvent.ACTION_DOWN:
            // Event occurs when the first finger is pressed on the Screen

            Log.d("ZoomPrint", "Event: Action_Down " );
            mInitialX = event.getX();
            mInitialY = event.getY();

        break;
        case MotionEvent.ACTION_POINTER_DOWN:
            //Event occurs when the second finger is pressed down

            Log.d("ZoomPrint", "Event: Action_Pointer_Down " );
            // If second finger is pressed on the screen with the first set the Mode to Zoom operation
            mode=ZOOM_OPERATION;

            break;  
        case MotionEvent.ACTION_POINTER_UP:
            Log.d("ZoomPrint", "Event: Action_Pointer_UP " );
            mdrag=true;

        case MotionEvent.ACTION_UP: 
            //Event occurs when all the finger are taken of the screen
            Log.d("ZoomPrint", "Event: Action_UP " );
            //If all the fingers are taken up there will be no operation 
            mode = NONE_OPERATION;
            mdrag=false;

            break;  

        }
        // give the event to the mDetector to get the scaling Factor
            mDetector.onTouchEvent(event);

        // give the event to the mDoubleTapDetector for the doubleTap 
            mDoubleTapDetector.onTouchEvent(event);

        if(!mdrag)
            invalidate();

    return true;
    }

    @Override
    public boolean onInterceptTouchEvent(MotionEvent ev) {
        onTouchEvent(ev);
        return super.onInterceptTouchEvent(ev);
    //  return true;
    }

    @Override
    public ViewParent invalidateChildInParent(int[] location, Rect dirty) {
        return super.invalidateChildInParent(location, dirty);
    }

    @Override
    protected void onLayout(boolean changed, int l, int t, int r, int b)
    {
        int count = getChildCount();
        for(int i=0;i<count;i++){
            View child = getChildAt(i); 
            if(child.getVisibility()!=GONE){
                RelativeLayout.LayoutParams params = (RelativeLayout.LayoutParams)child.getLayoutParams();
                child.layout(
                    (int)(params.leftMargin ), 
                    (int)(params.topMargin ), 
                    (int)((params.leftMargin + child.getMeasuredWidth()) ), 
                    (int)((params.topMargin + child.getMeasuredHeight())) 
                    );
            }
        }
    }

    @Override
    protected void dispatchDraw(Canvas canvas) {

        //Save the canvas to set the scaling factor returned from detector
        canvas.save(Canvas.MATRIX_SAVE_FLAG);

        canvas.scale(mScaleFactor, mScaleFactor,gx,gy);     

        super.dispatchDraw(canvas);

        mClipBound = canvas.getClipBounds();

          canvas.restore();
    }

    private class ZoomListener extends ScaleGestureDetector.SimpleOnScaleGestureListener {

            @Override
            public boolean onScale(ScaleGestureDetector detector) {
                // getting the scaleFactor from the detector
                mScaleFactor *= detector.getScaleFactor();              // gives the scaling factor from the previous scaling to the current
            //  Log.d("ZoomPrint", "detector scaling Factor" + mScaleFactor);

                gx = detector.getFocusX();
                gy = detector.getFocusY();
                // Limit the scale factor in the MIN and MAX bound
                mScaleFactor= Math.max(Math.min(mScaleFactor, MAX_ZOOM),MIN_ZOOM);
            //  Log.d("ZoomPrint", "Bounded scaling Factor" + mScaleFactor);

                /*//Force canvas to redraw itself only if the one event is to happen (say Zooming only ) else do not invalidate here for multi operations
                   As what we de for scrolling or panning will not reflect here. So we will add this in onDraw method 
                invalidate();*/
                 // Here we are only zooming so invalidate has to be done
            //  invalidate();
             //  requestLayout();

                // we have handle the onScale 
                return true;
            }

        }

        @Override
        public boolean onDoubleTap(MotionEvent e) {

        // Make the mScaleFactor to its normal value
            if(mScaleFactor>1.0f)
            {
                    mScaleFactor=1.0f;
            }
        /*  else{
                mScaleFactor = 2.0f;
                gx=mInitialX;
                gy=mInitialY;

            }*/

        // Force the canvas to redraw itself again as the changes has been occured.
        invalidate();
        requestLayout();
            return false;
        }

        @Override
        public boolean onDoubleTapEvent(MotionEvent e) {
        //  Log.d("ZoomPrint", "OnDoubleTapEvent");
            return false;
        }

        @Override
        public boolean onSingleTapConfirmed(MotionEvent e) {
        //  Log.d("ZoomPrint", "OnSingleTap");
            return false;
        }

        @Override
        public boolean onDown(MotionEvent e) {
            // TODO Auto-generated method stub
            return false;
        }

        @Override
        public boolean onFling(MotionEvent e1, MotionEvent e2,
                float velocityX, float velocityY) {
            return false;
        }

        @Override
        public void onLongPress(MotionEvent e) {

        }

        @Override
        public boolean onScroll(MotionEvent e1, MotionEvent e2,
                float distanceX, float distanceY) {
                return false;
        }

        @Override
        public void onShowPress(MotionEvent e) {

        }

        @Override
        public boolean onSingleTapUp(MotionEvent e) {
            return false;
        } 
```

}

缩放后如何在屏幕范围内实现平移？谢谢 ，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T08:01:17.183

我只使用 onScroll 方法自己实现了它，这也将图像保持在绑定区域.. 这是代码

```
 @Override
            public boolean onScroll(MotionEvent e1, MotionEvent e2,
                    float distanceX, float distanceY) {

                    int distX= (int) distanceX, distY =(int) distanceY;

        //Log.d("Print"," X " + this.mClipBound.left +" Y " + this.mClipBound.right + " b "+ this.mClipBound.bottom + " g" + this.mClipBound.top) ;

        Log.d("Print", "Scroll X " + distanceX + " Y " + distanceY);    

                if(this.mClipBound.left<=0)
                    this.scrollTo(-280, 0);
                else if(this.mClipBound.top<=0)
                    this.scrollTo(0, -250);
                    else if (this.mClipBound.right>=1047)
                        this.scrollTo(280, 0);
                    else if (this.mClipBound.bottom>=800)
                        this.scrollTo(0, 250);
                    else
                    this.scrollBy((int)distanceX,(int)distanceY);

                    return true;

            } 
```

可以计算缩放后点击区域的偏移量 - (event.getX() / ZoomLayout.mScaleFactor + ZoomLayout.mClipBound.left) 但是我还没有计算出缩放和滚动后点击区域的偏移量。

# c# - .where(...).Any() 与 ..Any(...) 之间的性能差异

> ID：10800560
> 
> 赞同：5
> 
> 时间：2012-05-29T13:52:15.163
> 
> 标签：c#, linq-to-objects

> **可能重复：**
> [LINQ 扩展方法 - Any() vs. Where() vs. Exists()](https://stackoverflow.com/questions/3703256/linq-extension-methods-any-vs-where-vs-exists)

给定内存中的对象列表，我运行以下两个表达式：

```
myList.where(x => x.Name == "bla").Any() 
```

对比

```
myList.Any(x => x.Name == "bla") 
```

后者总是最快的，我相信这是由于 Where 枚举了所有项目。但是，当没有匹配项时也会发生这种情况。

我不确定确切的原因。在任何情况下，这种观察到的性能差异不会出现，例如查询 Nhib？

干杯。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-29T13:54:19.440

`Any()`with 谓词可以在没有迭代器 ( `yield return`)的情况下执行其任务。使用 a`Where()`创建一个迭代器，它增加了对性能的影响（尽管非常小）。

因此，在性能方面（稍微），您最好使用带有`Any()`谓词 ( `x => x.Name == "bla"`) 的形式。就个人而言，我发现它更具可读性......

附带说明，`Where()`不一定枚举所有元素，它只是创建一个迭代器，该迭代器将在请求元素时遍历元素，因此在`Any()`之后的调用`Where()`将驱动迭代，它将在它发现的第一个项目处停止符合条件。

因此，性能差异**不是**`Where()`迭代**所有**项目（在 linq-to-objects 中），因为它确实不需要（当然，除非它没有找到满足它的项目），而是该`Where()`子句具有设置一个迭代器来遍历元素，而`Any()`使用谓词则不会。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-29T13:57:11.630

假设您正确`where`to`Where`和`=`to `==`，我希望“`Any`带谓词”版本的执行*速度会稍微快一些*。但是，我希望差异显着的情况很少而且相差甚远，因此您应该首先以可读性为目标。

碰巧的是，就可读性而言，我通常也更喜欢“`Any`带有谓词”的版本，因此您在两个方面都取得了胜利-但您确实应该首先使用您发现更具可读性的内容。在你真正关心的场景中*测量性能，如果一段代码没有按照你的需要执行，**那么*考虑对其进行微优化——当然是在每一步进行测量。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-29T13:59:58.317

> 我相信这是由于 Where 枚举了所有项目。

如果`myList`是内存中的集合，则不是。该`Where`方法使用延迟执行，因此它只会枚举所需数量的项目以确定结果。在这种情况下，您不会看到`.Any(...)`和之间有任何显着差异`.Where(...).Any()`。

> 在任何情况下，这种观察到的性能差异不会出现，例如查询 Nhib？

是的，如果`myList`是一个数据源，它将采用方法生成的表达式并转换为查询以在其他地方运行（例如 LINQ To SQL），您可能会看到差异。翻译表达式的代码在翻译其中一个表达式时做得更好。

# ms-access - 什么是未提交读取的 MS Access 等效项（使用 UR - DB2 或 NOLOCK - MS SQL）

> ID：10800568
> 
> 赞同：1
> 
> 时间：2012-05-29T13:52:39.357
> 
> 标签：ms-access, db2

我的 access 数据库中有一堆 DB2 链接表。这些来自生产环境，而我正在运行的读取查询（选择）显然会干扰生产作业。

是否有未提交的读取等效项可用于访问以运行查询？我知道我可以使用 Toad，它允许我在 SQL 查询中使用 WITH UR，但我无法在飞行途中将整个项目导入 Toad，因此在 Access 中完成它会很好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T15:25:10.213

由于 Access 使用 ODBC 连接到 DB2（或者至少我们在我的商店中是这样做的），您可以更改[ODBC 设置以使用正确的事务级别](http://publib.boulder.ibm.com/infocenter/db2luw/v9r5/topic/com.ibm.db2.luw.apdv.cli.doc/doc/r0008832.html)。

您应该能够进入 ODBC 设置面板（控制面板 -> 管理工具 -> 数据源 (ODBC)），并在其中配置源。（转到您的 DSN -> 配置 -> 高级设置）

然后，如上面文章中所述，对于`UR`（未提交的读取），您将设置`TxnIsolation`= 1

# popup - 如何使用 Popup 修改字段的文本

> ID：10800576
> 
> 赞同：0
> 
> 时间：2012-05-29T13:52:56.863
> 
> 标签：popup, field, playn

再次在这里提出新问题。我正在使用这样的字段：

```
 Field field = new Field(" Enter Your Text ");
    field.setEnabled(true);
    field.layer.setInteractive(true);
    field.setTextType(Keyboard.TextType.DEFAULT); 
```

当我单击它时，将弹出一个输入其文本的弹出窗口。在 Api doc 中写入它已写入我们可以使用以下方法修改其值：

```
Keyboard.getText(playn.core.Keyboard.TextType, java.lang.String, java.lang.String, playn.core.util.Callback) 
```

那么我如何使用它，因为它键盘是一个界面，getText（...）不是静态的。我希望这个弹出窗口出现在按钮点击事件上。任何帮助将不胜感激。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T07:18:33.833

抱歉这个愚蠢的问题。我得到了答案。你可以这样弹出：

```
PlayN.keyboard().getText(textType, label, initialValue, callback); 
```

希望它会帮助某人。:)

# forms - Mootools 停止表单提交方法

> ID：10800578
> 
> 赞同：2
> 
> 时间：2012-05-29T13:53:03.723
> 
> 标签：forms, mootools

我不想使用`<input type=submit />`按钮提交表单，而是使用`<a>`元素。这是由于样式要求。所以我有这个代码：

```
myButton.addEvent('click', function() {
    document.id('myForm').submit();
}); 
```

但是，我还编写了一个类来改进和实现 和上的`placeholder`属性：`inputs``textareas`

```
var FDPlaceholderText = new Class({
    Implements: Events,
    initialize: function() {

        var _self = this;
        var forms = document.getElements('form');        

        forms.each(function(form) { // All forms
            var performInit = false;
            var i = 0;
            var ph = [];
            form.getElements('input, textarea').each(function(el) { // Get form inputs and textareas
                if (el.getProperty('placeholder') != null) { // Check for placeholder attribute
                    performInit = true;
                    ph[i] = _self.initPlaceholder(el); // Assign the placeholder replacement to the elements
                } 
                i ++;
            });

            if (performInit) {
                _self.clearOnSubmit(form, ph);
            } 
        });

    },
    clearOnSubmit: function(form, ph) {
        form.addEvent('submit', function(e) {
            ph.each(function(el) {
                if (el.value == el.defaultValue) {
                    el.value = '';
                }
            });
        });
    },
    initPlaceholder: function(el) {

        el.defaultValue = el.getProperty('placeholder');
        el.value = el.getProperty('placeholder');

        el.addEvents({
            'focus': function() {
                if (el.value == el.defaultValue) el.value = '';          
            },
            'blur': function() {
                if(el.value.clean() == ''){ 
                    el.value = el.defaultValue;
                }
            }
        });

        return el;
    }
});

window.addEvent('domready', function() {
    new FDPlaceholderText();
}); 
```

如果使用实际`<input type=submit />`按钮提交表单，则上述类工作得很好：它侦听提交并清除输入值，如果它们仍然是默认值，因此验证它们基本上是空的。

但是，似乎因为我通过收听`<a>`标签上的点击事件来提交我的表单之一，`form.addEvent('submit', function(e) {`所以没有被触发。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T14:03:46.313

好吧，您可以将点击处理程序更改为 fireEvent() 而不是直接调用 .submit() ：

```
myButton.addEvent('click', function() {
    document.id('myForm').fireEvent('submit');
}); 
```

记住几件事（或更多）。

1.  缺少 placeholder= 属性的元素的占位符值是没有意义的
2.  如果您检测到占位符支持，请执行一次而不是在每个元素上执行一次，它不会在循环中途突然改变。你可以这样做`var supportsPlaceholder = !!('placeholder' in document.createElement('input'));`——记住，如果浏览器支持它，就不需要做任何事情，目前，[接近 60%](http://caniuse.com/#search=placeholder)做。
3.  你可以这样做`!supportsPlaceholder && el.get('placeholder') && self.initPlaceholder(el);`- 这样可以避免在不需要时检查属性
4.  提交表单时，您确实需要清除旧浏览器中的占位符 = 值，否则对“必需”等的验证将失败。如果验证仍然失败，则必须恢复占位符，因此需要更灵活的事件模式
5.  避免使用像 el.value 这样的对象属性的直接引用 - 使用像这样的访问器`el.get('value')`（对于 1.12，它是 getProperty）

有关如何在 mootools 中处理此问题的更复杂示例，请在此处查看我的仓库：[https ://github.com/DimitarChristoff/mooPlaceholder](https://github.com/DimitarChristoff/mooPlaceholder)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T14:03:31.437

这是因为该`submit()`方法不是来自 MooTools 而是原生的。

也许您可以使用 a`<button type="submit">`来满足您的样式要求。

# qt - Qt 使用图像作为按钮

> ID：10800581
> 
> 赞同：0
> 
> 时间：2012-05-29T13:53:15.797
> 
> 标签：qt, user-interface

我已经在 Qt 中进行了半年多一点的开发，并且我主要使用样式表来为我的 GUI 提供更好的外观和感觉。我已经达到了它看起来不错但不是非常专业的地步。即我的GUI 看起来有点业余。我想知道的是，我应该为按钮和其他小部件使用图像以使它们看起来更专业吗？或者我应该专注于学习如何使用样式表做所有事情。例如..我知道一些 Photoshop 设计师可以为我制作一些很棒的图像，这是 Qt 中 GUI 开发的有效实践吗？

谢谢。

# jquery - 使用 JQuery 的 RoR PUT

> ID：10800582
> 
> 赞同：2
> 
> 时间：2012-05-29T13:53:16.743
> 
> 标签：jquery, ruby-on-rails, ajax, post, put

我有一个 Rails 服务器，我正在尝试使用 $.ajax 函数进行 PUT。服务器给出一个 POST 200 OK 但它没有被更新的数据库数据。

```
$.ajax({type: 'POST',
        url: this.SERVER_IP+ "/user_coordinates/" + this.FRIEND_ID,
        dataType: 'json',
        async: false,
        data: {_method:'PUT',
               page: {"user_coordinate":
                        {"meetinglat":this.meetingPoint.getPosition().lat(),
                         "meetinglong":this.meetingPoint.getPosition().lng()}
                     }
              },
        success: function(msg){
                   console.log("Sucess! Object: ");
                   console.log(msg);
                 },
        error: function(msg){
                 console.log("Error! Object: ");
                 console.log(msg);
               }
        }); 
```

正在调用错误函数。这里可能是什么问题？

谢谢你的时间 ;）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T12:52:09.923

我已经发现问题了。在我的控制器中使用 logger.debug 我注意到它期待 params[:user_coordinate] 并且在我的 ajax 调用中我传递了类似的东西：

```
data: {_method:'PUT',
               page: {"user_coordinate":
                        {"meetinglat":this.meetingPoint.getPosition().lat(),
                         "meetinglong":this.meetingPoint.getPosition().lng()}
                     }
              } 
```

代替：

```
data: {_method:'PUT',
               user_coordinate: {"meetinglat":this.meetingPoint.getPosition().lat(),
                         "meetinglong":this.meetingPoint.getPosition().lng()}
      }, 
```

现在它正在工作！;)

logger.debug "参数 #{params[:user_coordinate]}"

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T16:24:05.120

在作为接收端的 Rails 控制器内部，在您的情况下为 user_coordinates_controller，尝试打印出参数是什么，--> puts params.inspect

另一个注意事项，看起来您在 AJAX 调用中输入了 POST

# oracle - 从 Pentaho 报表设计器查询远程 Oracle 数据库时出错

> ID：10800589
> 
> 赞同：1
> 
> 时间：2012-05-29T13:53:36.440
> 
> 标签：oracle, pentaho, report-designer

我正在尝试从远程 Oracle 数据库获取一些数据，因此我配置了与数据库的新连接，当我按下测试时，它表示连接已成功建立，但是当我尝试简单的选择查询时，报表设计器给出我一个错误：

```
org.pentaho.reporting.engine.classic.core.ReportDataFactoryException: Failed at query: select * from fact_table;
at org.pentaho.reporting.engine.classic.core.modules.misc.datafactory.sql.SimpleSQLReportDataFactory.queryData(SimpleSQLReportDataFactory.java:258)
at org.pentaho.reporting.engine.classic.core.modules.misc.datafactory.sql.SQLReportDataFactory.queryData(SQLReportDataFactory.java:171)
at org.pentaho.reporting.ui.datasources.jdbc.ui.JdbcPreviewWorker.run(JdbcPreviewWorker.java:103)
at java.lang.Thread.run(Unknown Source) 
```

父异常：

```
 java.sql.SQLException: ORA-00911: invalid character

at oracle.jdbc.driver.DatabaseError.throwSqlException(DatabaseError.java:125)
at oracle.jdbc.driver.T4CTTIoer.processError(T4CTTIoer.java:305)
at oracle.jdbc.driver.T4CTTIoer.processError(T4CTTIoer.java:272)
at oracle.jdbc.driver.T4C8Oall.receive(T4C8Oall.java:623)
at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:112)
at oracle.jdbc.driver.T4CStatement.execute_for_describe(T4CStatement.java:351)
at oracle.jdbc.driver.OracleStatement.execute_maybe_describe(OracleStatement.java:896)
at oracle.jdbc.driver.T4CStatement.execute_maybe_describe(T4CStatement.java:383)
at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:986)
at oracle.jdbc.driver.OracleStatement.doScrollExecuteCommon(OracleStatement.java:3763)
at oracle.jdbc.driver.OracleStatement.doScrollStmtExecuteQuery(OracleStatement.java:3887)
at oracle.jdbc.driver.OracleStatement.executeQuery(OracleStatement.java:1131)
at org.pentaho.reporting.engine.classic.core.modules.misc.datafactory.sql.SimpleSQLReportDataFactory.parametrizeAndQuery(SimpleSQLReportDataFactory.java:422)
at org.pentaho.reporting.engine.classic.core.modules.misc.datafactory.sql.SimpleSQLReportDataFactory.queryData(SimpleSQLReportDataFactory.java:254)
at org.pentaho.reporting.engine.classic.core.modules.misc.datafactory.sql.SQLReportDataFactory.queryData(SQLReportDataFactory.java:171)
at org.pentaho.reporting.ui.datasources.jdbc.ui.JdbcPreviewWorker.run(JdbcPreviewWorker.java:103)
at java.lang.Thread.run(Unknown Source) 
```

那么我该如何完成呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T14:01:45.213

`select * from fact_table;`似乎是一个有效的查询。尝试删除末尾的分号。

# python - Python多线程爬虫

> ID：10800593
> 
> 赞同：5
> 
> 时间：2012-05-29T13:53:40.713
> 
> 标签：python, multithreading, thread-safety, web-crawler

你好！我正在尝试用 python 编写网络爬虫。我想使用python多线程。即使在阅读了早期建议的论文和教程之后，我仍然有问题。我的代码在这里（整个源代码在[这里](http://snipt.org/ujhW9)）：

```
class Crawler(threading.Thread):

    global g_URLsDict 
    varLock = threading.Lock()
    count = 0

    def __init__(self, queue):
        threading.Thread.__init__(self)
        self.queue = queue
        self.url = self.queue.get()

    def run(self):
        while 1:
            print self.getName()+" started" 
            self.page = getPage(self.url)
            self.parsedPage = getParsedPage(self.page, fix=True)
            self.urls = getLinksFromParsedPage(self.parsedPage)

            for url in self.urls:

                self.fp = hashlib.sha1(url).hexdigest()

                #url-seen check
                Crawler.varLock.acquire() #lock for global variable g_URLs
                if self.fp in g_URLsDict:
                    Crawler.varLock.release() #releasing lock
                else:
                    #print url+" does not exist"
                    Crawler.count +=1
                    print "total links: %d"%len(g_URLsDict)
                    print self.fp
                    g_URLsDict[self.fp] = url
                    Crawler.varLock.release() #releasing lock
                    self.queue.put(url)

                    print self.getName()+ " %d"%self.queue.qsize()
                    self.queue.task_done()
            #self.queue.task_done()
        #self.queue.task_done()

print g_URLsDict
queue = Queue.Queue()
queue.put("http://www.ertir.com")

for i in range(5):
    t = Crawler(queue)
    t.setDaemon(True)
    t.start()

queue.join() 
```

它不能按需要工作，在线程 1 之后它没有给出任何结果，并且它在某些时候以不同的方式执行会给出此错误：

```
Exception in thread Thread-2 (most likely raised during interpreter shutdown): 
```

我该如何解决？而且我不认为这比 for 循环更有效。

我试图修复运行（）：

```
def run(self):
    while 1:
        print self.getName()+" started" 
        self.page = getPage(self.url)
        self.parsedPage = getParsedPage(self.page, fix=True)
        self.urls = getLinksFromParsedPage(self.parsedPage)

        for url in self.urls:

            self.fp = hashlib.sha1(url).hexdigest()

            #url-seen check
            Crawler.varLock.acquire() #lock for global variable g_URLs
            if self.fp in g_URLsDict:
                Crawler.varLock.release() #releasing lock
            else:
                #print url+" does not exist"
                print self.fp
                g_URLsDict[self.fp] = url
                Crawler.varLock.release() #releasing lock
                self.queue.put(url)

                print self.getName()+ " %d"%self.queue.qsize()
                #self.queue.task_done()
        #self.queue.task_done()
    self.queue.task_done() 
```

我在不同的地方尝试了 task_done() 命令，谁能解释一下区别？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-29T14:55:39.050

您仅`self.url = self.queue.get()`在线程初始化时调用。如果您想获取新的 url 以便进一步处理，则需要尝试从 while 循环内的队列中重新获取 url。

尝试替换`self.page = getPage(self.url)`为`self.page = getPage(self.queue.get())`. 请注意，get 函数将无限期阻塞。您可能希望在一段时间后超时并添加一些方式让您的后台线程通过请求优雅地退出（这将消除您看到的异常）。

[effbot.org 上](http://effbot.org/librarybook/queue.htm)有一些很好的例子，它们以我上面描述的方式使用 get()。

**编辑**- 对您最初评论的回答：

查看[文档`task_done()`](http://docs.python.org/library/queue.html#Queue.Queue.task_done)；对于每次调用`get()`（不会超时），您应该调用`task_done()`which 告诉任何阻塞调用`join()`该队列上的所有内容现在都已处理。每次调用`get()`都会阻塞（睡眠），同时等待新的 url 发布到队列中。

**Edit2** - 试试这个替代运行功能：

```
def run(self):
    while 1:
        print self.getName()+" started"
        url = self.queue.get() # <-- note that we're blocking here to wait for a url from the queue
        self.page = getPage(url)
        self.parsedPage = getParsedPage(self.page, fix=True)
        self.urls = getLinksFromParsedPage(self.parsedPage)

        for url in self.urls:

            self.fp = hashlib.sha1(url).hexdigest()

            #url-seen check
            Crawler.varLock.acquire() #lock for global variable g_URLs
            if self.fp in g_URLsDict:
                Crawler.varLock.release() #releasing lock
            else:
                #print url+" does not exist"
                Crawler.count +=1
                print "total links: %d"%len(g_URLsDict)
                print self.fp
                g_URLsDict[self.fp] = url
                Crawler.varLock.release() #releasing lock
                self.queue.put(url)

                print self.getName()+ " %d"%self.queue.qsize()

        self.queue.task_done() # <-- We've processed the url this thread pulled off the queue so indicate we're done with it. 
```

# c++ - COM：使用指向它实现的接口的指针获取 coclass 对象的 GUID

> ID：10800595
> 
> 赞同：2
> 
> 时间：2012-05-29T13:53:44.577
> 
> 标签：c++, com

拥有指向由某些具体组件类对象实现的 COM 接口的指针，是否可以获得实现该接口 (CLSID) 的底层对象的 GUID？

### 更新 1

更一般地说，我有一个类似的函数`SetFont(ICanvasFont* font)`，我需要一种方法来确定实现`ICanvasFont`接口的底层对象是否属于某个类（例如`MCanvasFont`）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-29T13:58:04.600

`IUnknown::QueryInterface`在此接口指针上获取以下之一：`IPersist`、`IPersistStream`或`IPersistStreamInit`其他`IPersist*`接口。如果您幸运地得到一个，那么`GetClassID`方法将为您提供`CLSID`类标识符（替代选项是`IProvideClassInfo`and `IProvideClassInfo::GetClassInfo`）。

请注意，此类信息不必存在。接口指针可以在没有`CLSID`实现它的类上有效。

UPD。如果主要目标是在提供的接口上识别您自己的实现（“提供`ICanvasFont`的是我自己的`MCanvasFont`类的实例，还是不同的东西？”），那么最简单但有效的方法是在提供的接口上实现一些额外的私有接口班级。如果您的查询成功，那么您可以识别该实例。如果不进行封送处理，您甚至可以`static_cast`返回到原始 C++ 指针。

# sql - a 和 b 之间的数字 - a 不包括在内，b 包括在内

> ID：10800597
> 
> 赞同：2
> 
> 时间：2012-05-29T13:53:47.867
> 
> 标签：sql, oracle, where-clause

（我对 SQL 有点陌生）我有很多要重写的查询，其中有一个`where`像这样的子句：

```
where some_number > A
and some_number <= B 
```

我想使用单个`where`子句（行数更少，不是更快/更慢吗？），如下所示：

```
where some_number between A and B 
```

问题是第一个子句在 A 上是排他的，在 B 上是包含的。有什么方法可以像第二个查询一样在单行上指定“包容性”？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T14:01:21.240

几点...

首先，如果你使用更少的行，它只是“更少的行”。我会这样格式化它：

```
where some_number > A and some_number <= B 
```

因为它实际上是一个*范围*条件，范围的每一端都是单独编码的。

其次，它实际上并不比 between 版本快或慢，因为在`between A and B`幕后转换为：

```
where (some_number >= A) and (some_number <= B) 
```

所以性能是相同的。

基本上，不用担心。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T13:57:48.537

你可以用“+1”来抵消你的 a

或者只是使用你的第一个语法，它更容易阅读。

# c# - 在编译期间监视文件复制

> ID：10800601
> 
> 赞同：0
> 
> 时间：2012-05-29T13:54:09.407
> 
> 标签：c#, visual-studio-2010, visual-studio, msbuild

我曾经在我的项目中有一些构建后事件和构建后事件，我用它们来复制文件。我也有 CopyLocal = true。

我正在删除所有后期构建和构建事件之后，copylocal 现在等于 false。有一些 dll 文件仍然可以进入 bin 文件夹....

如何检测谁复制了这些文件？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-29T14:22:51.780

尝试从 Visual Studio 命令提示符构建并[保存详细日志](http://msdn.microsoft.com/en-us/library/ms171470)，以便您可以搜索复制文件的名称并找出正在复制它们的项目：

```
msbuild <solution name> /l:FileLogger,Microsoft.Build.Engine;logfile=MyLog.log;verbosity=diagnostic 
```

即使 .csproj 文件中没有按名称提及文件，这也应该会为您带来一些结果。

# git - 如何从 git 获取特定内核版本到外向位

> ID：10800607
> 
> 赞同：4
> 
> 时间：2012-05-29T13:54:20.337
> 
> 标签：git, linux-kernel

**我有一些适用于内核版本2.6.32.3**的特定平台的补丁。现在我正在使用 git，我已经有一个官方内核树的克隆，我希望有一个私有分支来维护这个补丁。当我询问标签列表时，`git tag -l`我得到了**2.6.32**系列的标签：

```
v2.6.32
v2.6.32-rc1
v2.6.32-rc2
v2.6.32-rc3
v2.6.32-rc4
v2.6.32-rc5
v2.6.32-rc6
v2.6.32-rc7
v2.6.32-rc8 
```

在[kernel.org 的 HTTP 存储库](http://www.kernel.org/pub/linux/kernel/v2.6/)中，可以将所有特定的完整源代码和补丁 tarball 获取到外向数字（在我的例子中，最后是**.3**），那么我们应该如何直接通过 git 获得相同的内容呢？为什么列出的标签只显示“-rcX”表示外向性？

我在网上搜索过，发现有[同样问题](http://www.linuxquestions.org/questions/linux-kernel-70/how-to-use-git-to-get-kernel-2-6-38-8-a-943765)的人，但他们也没有得到答复。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-29T14:12:20.530

你可能有一个 Linus 的 repo 的克隆。

尝试 linux-stable 存储库：http: //git.kernel.org/?p=linux/kernel/git/stable/linux-stable.git;a=shortlog;h=refs/tags/ [v2.6.32.3](http://git.kernel.org/?p=linux/kernel/git/stable/linux-stable.git;a=shortlog;h=refs/tags/v2.6.32.3)

http-git-urls 不起作用，但 git-url 应该：

`git clone git://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git`

# javascript - ASP.NET -> 有没有人处理过超过 2500 个字符的图像 URL？

> ID：10800610
> 
> 赞同：0
> 
> 时间：2012-05-29T13:54:29.083
> 
> 标签：javascript, asp.net, image, http-post, imageurl

我有存储图像的 ASPX 页面。这些图像的 URL 大约有 2000 个字符。

此 URL 的值是从某处读取的，我无法控制。

我想知道是否有人处理过这种情况。

我有一个重建这个 URL 的 javascript 程序。

所以我想知道，

a) 如何处理长度较长的 URL。（我在 OnInit 中获得了 URL）。由于它们更长，我想使用 javascript 函数来修剪 URL 长度。

b) 一旦我得到重建的 URL（大约 500 个字符），我想将它分配回图像并允许页面加载完成。实现

提前致谢，

**更新 0：**我想知道如何使用 httpwebrequest 在同一个帖子中发布图片？

**更新1：**我已经更新了我原来的帖子。

**更新 2** Javascript 代码。该代码重构并提交文件。我可以按原样使用这个 javascript，或者我可以只修改 URL，然后将其分配给我的代码隐藏 (OnInit) 中的图像。

```
<script type="text/javascript">
function posturl(url) {
    var qsBegin = url.indexOf("?");
    var qsPattern = new RegExp("[?&]([^=]*)=([^&]*)", "ig");
    var match = qsPattern.exec(url);
    var params = new Array();

    while (match != null) {
        var matchID = match[1];
        if ( matchID.charAt(0) == "&" ) {
            matchID = matchID.substr(1);
        }

        if ( params[match[1]] != null && !(params[match[1]] instanceof Array) ) {
            var subArray = new Array();
            subArray.push(params[match[1]]);
            subArray.push(unescape(match[2]));
            params[match[1]] = subArray;
        } else if ( params[match[1]] != null && params[match[1]] instanceof Array ) {
            params[match[1]].push(unescape(match[2]));
        } else {
            params[match[1]]=unescape(match[2]);
        }   
        match = qsPattern.exec(url);
    }

    var myForm = document.createElement("form");
    myForm.setAttribute("target", "_blank");
    myForm.method="post" ;
    myForm.action = url.substring(0,qsBegin) ;
    for (var k in params) {
        var myInput;
        // Check for params with the same name.
        if ( params[k] instanceof Array ) {
            for ( var i=0; i<params[k].length; i++ ) {
                myInput = createFormInput(k, params[k][i]);
                myForm.appendChild(myInput) ;
            }
        } else {
            myInput = createFormInput(k, params[k]);
            myForm.appendChild(myInput);
        }
    }

    document.body.appendChild(myForm) ;
    myForm.submit() ;
    document.body.removeChild(myForm) ;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T14:07:09.817

问题不在于协议可以处理的长度，而在于您的客户可以处理的长度。大多数浏览器的最大获取大小约为 2000 个字符。如果您想要更多，则需要其他浏览器。但是，这通常不受您的控制。

> HTTP 协议对 URI 的长度没有任何先验限制。服务器必须能够处理它们所服务的任何资源的 URI，并且如果它们提供可以生成此类 URI 的基于 GET 的表单，则应该能够处理无限长度的 URI。如果 URI 比服务器可以处理的长（参见第 10.4.15 节），服务器应该返回 414（Request-URI Too Long）状态。
> 
> 注意：服务器应该谨慎对待超过 255 字节的 URI 长度，因为一些较旧的客户端或代理实现可能无法正确支持这些长度。

您可以尝试使用帖子将信息发送到服务器并将图像返回给您的客户端。

# hibernate - Hibernate 教程 DocumentException

> ID：10800613
> 
> 赞同：0
> 
> 时间：2012-05-29T13:54:34.347
> 
> 标签：hibernate

我正在尝试使用 maven 从[http://docs.jboss.org/hibernate/orm/3.3/reference/en/html/tutorial.html](http://docs.jboss.org/hibernate/orm/3.3/reference/en/html/tutorial.html)的休眠教程构建一个示例，但出现以下错误：

```
java.lang.reflect.InvocationTargetException
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
at java.lang.reflect.Method.invoke(Method.java:601)
at org.codehaus.mojo.exec.ExecJavaMojo$1.run(ExecJavaMojo.java:297)
at java.lang.Thread.run(Thread.java:722)
 Caused by: java.lang.ExceptionInInitializerError
at org.hibernate.tutorial.util.HibernateUtil.buildSessionFactory(HibernateUtil.java:18)
at org.hibernate.tutorial.util.HibernateUtil.<clinit>(HibernateUtil.java:8)
at org.hibernate.tutorial.EventManager.createAndStoreEvent(EventManager.java:23)
at org.hibernate.tutorial.EventManager.main(EventManager.java:16)
... 6 more
 Caused by: org.hibernate.HibernateException: Could not parse configuration: /hibernate.cfg.xml
at org.hibernate.cfg.Configuration.doConfigure(Configuration.java:2014)
at org.hibernate.cfg.Configuration.configure(Configuration.java:1926)
at org.hibernate.cfg.Configuration.configure(Configuration.java:1905)
at org.hibernate.tutorial.util.HibernateUtil.buildSessionFactory(HibernateUtil.java:13)
... 9 more
  Caused by: org.dom4j.DocumentException: http://hibernate.sourceforge.net/hibernate-configuration-%0A3.0.dtd Nested exception: http://hibernate.sourceforge.net/hibernate-configuration-%0A3.0.dtd
at org.dom4j.io.SAXReader.read(SAXReader.java:484)
at org.hibernate.cfg.Configuration.doConfigure(Configuration.java:2006)
... 12 more 
```

我在 hibernate.cfg.xml 中将“http://hibernate.sourceforge.net/hibernate-configuration-3.0.dtd”替换为“http://www.hibernate.org/dtd/hibernate-configuration-3.0.dtd”但它仍然不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T14:21:59.930

我认为您在 URL 中有一个换行符（在行尾返回）。您是否在 String 中注释了`%0A`（即换行的 acsii 代码）`.../hibernate-configuration-%0A3.0.dtd`？

# c# - 确定网络驱动器的协议

> ID：10800616
> 
> 赞同：2
> 
> 时间：2012-05-29T13:54:56.233
> 
> 标签：c#, windows, network-protocols

有没有办法确定用于 Windows 上已安装网络驱动器的协议名称（SMB/CIFS、NFS）和版本？（在 C# 中）

**编辑**

使用 Rusted 的答案中的信息，我从网络上的 Windows 7 计算机获得了以下信息。

```
NETRESOURCE res = WinApiWNETwrapper.GetResourceInfo("\\Test-PC");

res.dwDisplayType = SERVER
res.dwScope       = 0
res.dwType        = ANY
res.dwUsage       = CONTAINER
res.lpComment     = ""
res.lpLocalName   = null
res.lpProvider    = "Microsoft Windows Network"
res.lpLocalName   = "\\Test-PC"

NETINFOSTRUCT netinfo = WinApiWNETwrapper.GetNetworkInfo("\\Test-PC");

netinfo.cbStructureSize   = 32
netinfo.dwCharacteristics = 0
netinfo.dwDrives          = -1
netinfo.dwHandle          = 1880621056
netinfo.dwPrinters        = -1
netinfo.dwProviderVersion = 1024
netinfo.dwStatus          = Running
netinfo.wNetType          = LANMAN

SERVER_TRANSPORT_INFO_1[] transports = WinApiNETwrapper.ServerTransportEnum_1("\\Test-PC");

transports[0].svti1_domain                 = "WORKGROUP"
transports[0].svti1_networkaddress         = "TEST-PC"
transports[0].svti1_numberofvcs            = 0
transports[0].svti1_transportaddress       = 73107336
transports[0].svti1_transportaddresslength = ...
transports[0].TransportAddress             = "TEST-PC"

transports[0].svti1_transportname          = "\\Device\\NetbiosSmb"
transports[1].svti1_transportname          = "\\Device\\NetBT_Tcpip_{F4C75115-...}"
transports[2].svti1_transportname          = "\\Device\\NetBT_Tcpip_{70BD9048-...}" 
```

重要的部分似乎是：

```
transports[0].svti1_transportname          = "\\Device\\NetbiosSmb" 
```

但是我在任何地方都找不到 SMB 协议的版本号。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T15:06:44.403

我想您需要[Windows Networking (WNet) API ，这是](http://msdn.microsoft.com/en-us/library/windows/desktop/aa385406%28v=vs.85%29.aspx)[WNetGetNetworkInformation](http://msdn.microsoft.com/en-us/library/windows/desktop/aa385461%28v=vs.85%29.aspx)函数返回的NETINFOSTRUCT 中[NetType](http://msdn.microsoft.com/en-us/library/windows/desktop/aa385349%28v=vs.85%29.aspx)字段的值。

[这](http://code.google.com/p/netcommander/)是 C# 中的开源项目，检查[WnetApi](http://code.google.com/p/netcommander/source/browse/#svn/trunk/WnetApi)文件夹中的文件以获取 Wnet API 的 .NET 包装器。

要获取映射驱动器的 UNC 路径，请使用[此](http://www.codeproject.com/script/Articles/ViewDownloads.aspx?aid=2939)项目中的 PathToUNC 方法。

# javascript - 构建一个 Javascript 小部件：我可以调用一个 aspx 吗？

> ID：10800619
> 
> 赞同：0
> 
> 时间：2012-05-29T13:55:03.230
> 
> 标签：javascript, widget

我想创建自己的 JS 小部件，它必须是动态的。我的意思是，例如，从下载的脚本生成的 html ：

```
<script src="www.mywebsite.it/widget/?ID=2&Category=4" type="text/javascript"></script> 
```

必须不同于：

```
<script src="www.mywebsite.it/widget/?ID=1&Category=5" type="text/javascript"></script> 
```

并且应该从我的服务器上的数据库中获取 HTML 中的数据。那么，我需要调用一个创建 javascript 的 aspx 页面来创建 html 吗？或者哪个可能是解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T14:31:27.960

如果您想从服务器检索数据并以 JSON 或 XML 格式发送数据，更好的方法是使用带有 .ashx 的通用处理程序。接下来，数据将用javascript插入页面。

因此，如果我理解得很好，您确实会生成一个 .aspx，其中包含您的模板和一个 javascript，如果您使用 JQuery，则该 javascript 包含要在 Category 中导航的代码：

```
$.ajax({
  url: 'data.ashx?ID=2&Category=5',
  success: function(data) {
    $('.result').html(data);
    alert('Load was performed.');
  }
}); 
```

后面的服务器（ashx）：

```
 private readonly JavaScriptSerializer _js = new JavaScriptSerializer();        
    public void ProcessRequest(HttpContext context)
    {         
      //Do logic and retrieve data here
      Categorys c = GetFooById(context.Request["id"]);

      context.Response.Write(_js.Serialize(c));
      context.Response.ContentType = "application/json";
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T14:01:19.220

看来您想使用 AJAX。

脚本源不应该是动态的（如果是，则不能被缓存），但脚本本身可以调用您喜欢的任何页面来拉回数据（例如 JSON 格式）或原始标记以放置在预定义的元素。

如果您能提供帮助，请不要使用 ASPX 页面来创建 javascript。

考虑使用 jQuery 等 JavaScript 库来帮助您。

# xml - 使用 xslt 合并和重新排列 xml

> ID：10800627
> 
> 赞同：1
> 
> 时间：2012-05-29T13:55:26.903
> 
> 标签：xml, xslt, xslt-grouping

我正在使用 XSLT 转换从 web 派生的 XML，并将其即时转换为表示为 output 的目标 xml 文件。即使尝试了很多，我仍然无法这样做，任何人都可以帮助我进行这种转换。

**源 XML**

```
<allocelement>
    <hd1>12</hd1>
    <hd2>14</hd2>
    <hd3>87</hd3>
        <alc>1</alc>
    <amount>4587</amount>
    <code>1111</code>
</allocelement>
<alloclement>
        <hd1>12</hd1>
    <hd2>14</hd2>
    <hd3>87</hd3>
    <alc>2</alc>
    <amount>80000</amount>
    <code>1111</code>
</alloclement>
<alloclement>
    <hd1>875</hd1>
    <hd2>455</hd2>
    <hd3>455</hd3>
    <alc>2</alc>
    <amount>80000</amount>
    <code>1112</code>
 </alloclement> 
```

***所需输出***

```
<allocelement>
    <Codeheader>
    <code>1111</code>
        <hd1>12</hd1>
        <hd2>14</hd2>
        <hd3>87</hd3>
                <alc>1</alc>
                    <amount>4587</amount>
                <alc>2</alc>
                    <amount>80000</amount>
    </codeHeader>
        <CodeHeader>
    <code>1112</code>
        <hd1>875</hd1>
        <hd2>455</hd2>
        <hd3>455</hd3>
            <alc>2</alc>
              <amount>80000</amount>
    </CodeHeader>
</allocelement> 
```

分组是基于 Code,[hd1,hd2,hd3] 这样具有相同 Code 和 [hd1,hd2,hd3] 的不同元素将被合并，并且只显示不同的字段，即。和。我也在使用 xslt 1.0 。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T14:14:07.867

我假设您的输入 XML 有一个`root`节点，该节点将所有内容包装起来以制作格式良好的文档。我还假设所有`allocelement`的拼写都是正确的（你有一些拼写为 as `alloclement`）。我还假设您要删除由标签名称及其文本值标识的重复项。

使用**XSLT 1.0**：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:output omit-xml-declaration="yes" indent="yes"/>
    <xsl:strip-space elements="*"/>

    <xsl:key name="code" match="allocelement/code" use="."/>

    <xsl:key name="code-sibling" 
             match="allocelement/*[name() != 'code']" 
             use="concat(parent::*/code, '|', name(), '|', .)"/>

    <xsl:template match="@* | node()" name="copy">
        <xsl:copy>
            <xsl:apply-templates select="@* | node()"/>
        </xsl:copy>
    </xsl:template>

    <xsl:template match="/">
        <xsl:apply-templates select="root/allocelement[1]"/>
    </xsl:template>

    <xsl:template match="allocelement">
        <xsl:copy>
            <xsl:apply-templates select="@*"/>
            <xsl:apply-templates 
                    select="(. | following-sibling::allocelement)/code
                                [generate-id() = generate-id(key('code', .)[1])]"/>
        </xsl:copy>
    </xsl:template>

    <xsl:template match="code">
        <xsl:copy>
            <xsl:apply-templates select="@*"/>
            <xsl:value-of select="."/>

            <xsl:apply-templates 
                    select="key('code', .)/(preceding-sibling::* | following-sibling::*)
                                [generate-id() = 
                                 generate-id(key('code-sibling', concat(parent::*/code, '|', name(), '|', .))[1])]"/>
        </xsl:copy>
    </xsl:template>

</xsl:stylesheet> 
```

当应用于：

```
<root>
    <allocelement>
        <hd1>12</hd1>
        <hd2>14</hd2>
        <hd3>87</hd3>
        <alc>1</alc>
        <amount>4587</amount>
        <code>1111</code>
    </allocelement>
    <allocelement>
        <hd1>12</hd1>
        <hd2>14</hd2>
        <hd3>87</hd3>
        <alc>2</alc>
        <amount>80000</amount>
        <code>1111</code>
    </allocelement>
    <allocelement>
        <hd1>875</hd1>
        <hd2>455</hd2>
        <hd3>455</hd3>
        <alc>2</alc>
        <amount>80000</amount>
        <code>1112</code>
     </allocelement>
</root> 
```

产生：

```
<root>
   <allocelement>
      <code>1111<hd1>12</hd1>
         <hd2>14</hd2>
         <hd3>87</hd3>
         <alc>1</alc>
         <amount>4587</amount>
         <alc>2</alc>
         <amount>80000</amount>
      </code>
      <code>1112<hd1>875</hd1>
         <hd2>455</hd2>
         <hd3>455</hd3>
         <alc>2</alc>
         <amount>80000</amount>
      </code>
   </allocelement>
</root> 
```

这是它的工作原理。默认路由是[身份转换](http://en.wikipedia.org/wiki/Identity_transform)。我们首先中断`allocelement`并将转换发送到不同的路线。我们让它复制唯一`code`元素（由元素的文本值标识的唯一性）及其值，然后在`code`共享相同值的所有节点的所有前/后兄弟姐妹上应用模板。这些现在将是节点的子节点`code`。然后我们为那些唯一的兄弟姐妹（属于`code`相同的值，具有相同的名称和相同的文本值）调用身份转换。

一注。[混合内容](http://www.w3.org/TR/REC-xml/#sec-mixed-content)从来都不是一个好主意。看看你是否真的需要在`code`.

使用**XSLT 2.0**，您可以远离`generate-id()`s：

```
<xsl:template match="allocelement">
    <xsl:copy>
        <xsl:apply-templates select="@*"/>
        <xsl:for-each-group select="(. | following-sibling::allocelement)/code" group-by=".">
            <xsl:apply-templates select="."/>
        </xsl:for-each-group>
    </xsl:copy>
</xsl:template>

<xsl:template match="code">
    <xsl:copy>
        <xsl:apply-templates select="@*"/>
        <xsl:value-of select="."/>

        <xsl:for-each-group select="key('code', .)/(preceding-sibling::* | following-sibling::*)"
                            group-by="concat(parent::*/code, '|', name(), '|', .)">
            <xsl:apply-templates select="."/>
        </xsl:for-each-group> 
    </xsl:copy>
</xsl:template> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T04:05:54.573

**一个更短更简单的 XSLT 1.0 解决方案**：

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <xsl:key name="kCodeByVal" match="code" use="."/>

 <xsl:template match="/*">
  <allocelement>
   <xsl:apply-templates/>
  </allocelement>
 </xsl:template>

<xsl:template match="allocelement"/>

 <xsl:template match=
  "allocelement
    [generate-id(code) = generate-id(key('kCodeByVal', code)[1])]">
  <code><xsl:value-of select="code"/>
    <xsl:copy-of select=
    "node()[not(self::code)]
    | key('kCodeByVal', code)/../*[self::alc or self::amount]"/>
  </code>
 </xsl:template>
</xsl:stylesheet> 
```

**当此转换应用于以下 XML 文档**（包装提供的 XML 片段的单个顶部元素）时：

```
<t>
    <allocelement>
        <hd1>12</hd1>
        <hd2>14</hd2>
        <hd3>87</hd3>
        <alc>1</alc>
        <amount>4587</amount>
        <code>1111</code>
    </allocelement>
    <allocelement>
        <hd1>12</hd1>
        <hd2>14</hd2>
        <hd3>87</hd3>
        <alc>2</alc>
        <amount>80000</amount>
        <code>1111</code>
    </allocelement>
    <allocelement>
        <hd1>875</hd1>
        <hd2>455</hd2>
        <hd3>455</hd3>
        <alc>2</alc>
        <amount>80000</amount>
        <code>1112</code>
    </allocelement>
</t> 
```

**产生了想要的正确结果**：

```
<allocelement>
   <code>1111<hd1>12</hd1>
      <hd2>14</hd2>
      <hd3>87</hd3>
      <alc>1</alc>
      <amount>4587</amount>
      <alc>2</alc>
      <amount>80000</amount>
   </code>
   <code>1112<hd1>875</hd1>
      <hd2>455</hd2>
      <hd3>455</hd3>
      <alc>2</alc>
      <amount>80000</amount>
   </code>
</allocelement> 
```

**解释**：正确使用**[孟池分组法](http://www.jenitennison.com/xslt/grouping/muenchian.html)**。

* * *

**二、XSLT 2.0 解决方案——同样更短，更重要的是——在语法和语义上正确**：

```
<xsl:stylesheet version="2.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

  <xsl:template match="/*">
  <allocelement>
   <xsl:for-each-group select="*" group-by="code">
     <code><xsl:value-of select="code"/>
        <xsl:sequence select=
        "node()[not(self::code)]
        | current-group()/*[self::alc or self::amount]"/>
  </code>
   </xsl:for-each-group>
  </allocelement>
 </xsl:template>
</xsl:stylesheet> 
```

**更新**：OP 改变了对输出的要求。

**这是相应的修改后的 XSLT 1.0 解决方案**：

```
<xsl:stylesheet version="1.0"
     xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
     <xsl:output omit-xml-declaration="yes" indent="yes"/>
     <xsl:strip-space elements="*"/>

     <xsl:key name="kCodeByVal" match="code" use="."/>

     <xsl:template match="/*">
      <allocelement>
       <xsl:apply-templates/>
      </allocelement>
     </xsl:template>

    <xsl:template match="allocelement"/>

     <xsl:template match=
      "allocelement
        [generate-id(code) = generate-id(key('kCodeByVal', code)[1])]">
      <codeHeader>
       <code><xsl:value-of select="code"/></code>
         <xsl:copy-of select=
         "node()[not(self::code)]
         | key('kCodeByVal', code)/../*[self::alc or self::amount]"/>
      </codeHeader>
     </xsl:template>
</xsl:stylesheet> 
```

# android - Android - 在屏幕底部排列按钮

> ID：10800628
> 
> 赞同：0
> 
> 时间：2012-05-29T13:55:29.813
> 
> 标签：android, android-layout

我正在开发的应用程序需要将两个按钮固定在屏幕底部。我过去使用的技术是为父 RelativeLayout (height = fill_parent) 中的按钮声明一个 RelativeLayout，并将 align_parent_bottom 设置为 true。这是首先声明的，并且有一个 id，因此下一个子布局可以声明自己位于按钮的 RelativeLayout 之上。

但是，我目前正在处理的屏幕有一个奇怪的问题——在第一个 View 对象出现之前有一个很大的空白： ![在此处输入图像描述](../Images/88cebc1440e1f0aac8f88307969cb5b2.png)

[这是我的布局 XML](http://www.pastie.org/3988929)

谁能发现我的问题在哪里？有没有更好的方法来安排我的按钮？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T14:19:04.100

试试这个代码，它会工作。

问题`android:layout_above="@id/alarm_details_buttons_layout"` 出在滚动视图中

[编辑代码](http://www.pastie.org/private/faukcdwleux5jib1u4pa)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T14:08:49.050

I checked your code and here is the `modification in your buttons layout`:

```
<RelativeLayout
        android:id="@+id/alarm_details_buttons_layout"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentBottom="true"
        android:layout_centerHorizontal="true" >

        <Button
            android:id="@+id/alarm_details_return_to_list_button"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="your text here"
            android:textSize="15sp" />

        <Button
            android:id="@+id/alarm_details_update_button"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_toRightOf="@id/alarm_details_return_to_list_button"
            android:state_enabled="false"
            android:text="your text here"
            android:textSize="15sp" />
    </RelativeLayout> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-29T14:09:11.203

fixed. [http://pastebin.com/ucHwzJQP](http://pastebin.com/ucHwzJQP)

Note i removed all "@string/", will need to be added back.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-29T14:43:15.550

我解决了“差距”问题。由于我已将滚动视图设置为位于按钮 RelativeLayout 上方，因此我还必须强制它与父级顶部对齐：

```
 <ScrollView
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:layout_alignParentTop="true"
    android:layout_above="@id/alarm_details_buttons_layout"
    android:orientation="vertical" > 
```

# sql-server - SQL Server 2008R2 事务复制 - 移动订阅者数据库 - 推送订阅

> ID：10800632
> 
> 赞同：1
> 
> 时间：2012-05-29T13:55:45.380
> 
> 标签：sql-server, sql-server-2008-r2, replication, transactional-replication, subscriber

SQL Server 2008R2 事务复制 - 移动订阅者数据库 - 推送订阅

我需要在系统中断之外将订阅者数据库移动到新服务器，即我无法阻止新事务加载到发布者数据库中。

到目前为止，我已经尝试停止分发代理并让所有未复制的命令复制到 Server1 上的订阅者数据库。然后将订阅者数据库备份并恢复到 Server2。然后，我创建了一个从 Server2 到现有出版物的新订阅。

这可行，但只有从该点开始创建的事务才会复制到 Server2 订阅者数据库。我还需要在分销商数据库中建立的所有旧交易，这些交易注定只能转到 Server1。

是否有复制命令可用于将分发器中现有事务的目标更新为新的subscriber.subscriber_DB？

有 1 个包含多篇文章的出版物。该发布目前仅由 Server1 上的一个数据库订阅。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T19:22:41.193

你工作太辛苦了。在新服务器上创建订阅，就像您根本没有现有订阅一样。有很多方法可以做到这一点；选择你最喜欢的。我在您对另一个答案的回复中看到快照是不可行的。我使用“从备份初始化”选项取得了很大的成功（这里，“备份”是指发布者的备份）。一旦订阅者在初始化后同步，您就完成了。您现在可以清楚地“迁移”到新服务器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T17:33:45.320

由于分发代理特定于每个订阅服务器，因此您实际上无法让新订阅者接管现有订阅者停止的位置。唯一可行的方法是备份/恢复到 Server2，暂时停止发布者上的事务，将日志备份/恢复到 Server2，创建“仅支持复制”的订阅，然后重新启用事务。

你不能只为新订阅者添加对同一发布的订阅并启动快照代理吗？这将独立同步 Server2 而 Server1 继续保持同步。然后，您应该能够无缝切换到 Server2 并删除对 Server1 的订阅。

不过有一点警告。我会检查发布数据库的 syspublications 表（或运行 sp_helppublications）中的 sync_method，以确保快照不会锁定发布者中的表（默认情况下，对于 SQL Server 2005+，这应该不是问题）。否则，我刚才的建议将导致发布者阻塞，直到快照完成。

此外，如果您使用默认设置通过 GUI 设置复制，这是了解如何一次创建一个快照的一个很好的参考。如果您有大量数据要复制（千兆字节而不是兆字节），这对于在较长时间内分发快照以减少发布服务器负载很有用。 [http://www.replicationanswers.com/TransactionalOptimisation.asp](http://www.replicationanswers.com/TransactionalOptimisation.asp)

# ios - 检测相机的主动使用

> ID：10800640
> 
> 赞同：5
> 
> 时间：2012-05-29T13:56:08.177
> 
> 标签：ios, camera

当我的应用程序运行时，我需要检测另一个应用程序是否正在使用 iPhone/iPad 的相机。我的应用程序继续在后台运行（音频），但它不使用相机本身。我只需要找出另一个应用程序是否正在使用任何相机。

此外，我想使用尽可能少的 CPU 资源来最大限度地减少电池使用量。

我试过没有成功：

*   运行一个简单`AVCaptureSession`的捕获中断通知（它从不通知）
*   呼吁`lockForConfiguration`所有`AVCaptureDevice`_
*   定期监控的`enabled`属性`AVCaptureInputPort`（它总是是）
*   定期监控的`connected`属性`AVCaptureDevice`（它总是是）

为了澄清：

*   我不需要一种方法来检测相机的存在
*   我不需要一种方法来确定相机是否在我的应用程序中处于活动状态

感谢您的任何指示。

编辑：这是一项安全功能：如果在我的应用程序处于活动（后台）使用状态时，恶意（前台）应用程序正在拍摄用户或周围环境的照片或视频的可能性很小，我想警告用户。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T14:36:23.017

iOS 文档没有说明当另一个应用程序运行相机时可以通知您的应用程序的方式。这听起来也不像是苹果公司会允许的。此外，知道另一个应用程序是否正在运行相机也没有任何好处，因为：a）如果相机不活动，您的应用程序将无法使用相机，并且 b）您的应用程序不能以任何方式影响另一个应用程序的操作。试着想一个替代你想要达到的目标，因为不幸的是，这种方式是不可能的。

# php - 带有php和mysql的jquery自动完成在codeigniter中不起作用

> ID：10800642
> 
> 赞同：0
> 
> 时间：2012-05-29T13:56:10.077
> 
> 标签：php, javascript, jquery, mysql, codeigniter

Jquery 的自动完成文档似乎有点缺乏，至少对于初学者来说是这样。我已经在网上搜索了很好的教程，但没有找到。

继承人我到目前为止：

HTML：

```
<div id="addfilter">
    <div id="textwrap">
    <form method="POST" class="homeForm" id="homeForm" action="<?php echo base_url() ?>main/add_filter">
        <input type="text" class="text" id="homeText" name="homeText" placeholder="Add Category"></input>
        <input type="image" class="imginput" src="<?php echo base_url() ?>img/board/icons/add.jpg"id="homeSubmit" value="X"></input>
    </form>
    </div>
</div> 
```

JS：

```
$().ready(function() {
    $("text").autocomplete("search.php", {
        width: 260,
        matchContains: true,
        selectFirst: false
    });
}); 
```

搜索控制器

```
 public function search()
    {
        $this->thread_model->autocomplete();
    } 
```

自动完成模型

```
 public function autocomplete()
    {
        $query = $this->db->query('SELECT tag
            , COUNT(*) as num_items
            FROM filter_thread ft
            INNER JOIN filter f
            ON ft.filter_id = f.filter_id
            GROUP BY tag');
        $tagcloud = $query->result_array();
        foreach ($tagcloud as $tags)
        {
            echo $tags;
        }
    } 
```

当我在“formText”中输入文本时，Firebug 没有显示任何发生的事情。我什至不确定模型的输出格式是否正确。任何帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T14:04:26.433

你测试过你的控制器和模型吗？

首先，我会更正您的 jquery：

```
$(document).ready(function() {
        var url = $("#homeForm").attr("url");
        $("#homeText").autocomplete({
            source: url,
            width: 260,
            matchContains: true,
            selectFirst: false
        });
    }); 
```

我建议以其他方式提供 URL，例如表单标签中的属性：

```
<form url="<?php echo base_url() ?>main/search" .... > 
```

在 jQuery 中的自动完成之前获取该 URL：

```
var url = $("#homeForm").attr("url") 
```

然后自动完成通过 in`term`参数发送约束。您应该将查询调整为：

```
'SELECT tag, COUNT(*) as num_items
            FROM filter_thread ft
            INNER JOIN filter f
            ON ft.filter_id = f.filter_id
            WHERE <YOUR_FIELD_HERE> LIKE("%'.$this->db->escape($_POST['term']).'%")
            GROUP BY tag' 
```

我对 CodeIgniter 不是很熟悉，所以您可能需要纠正一些问题。

最后（也许）一件事是看看自动完成将如何对返回做出反应。

# asp.net-mvc - 将 Ninject.MVC3 添加到现有的 MVC(4) 项目中

> ID：10800643
> 
> 赞同：9
> 
> 时间：2012-05-29T13:56:13.963
> 
> 标签：asp.net-mvc, ninject

我正在使用 MVC4 开发一个项目，并决定我希望通过 Ninject 添加一些依赖注入。通过 NuGet 下载/安装后，我在`NinjectWebCommon.cs`（第 23 行）中发现此错误：

```
The type 'System.Web.IHttpModule' is defined in an assembly 
that is not referenced. You must add a reference to assembly 
'System.Web, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a'. 
```

然后稍后（第 44 行）：

```
The type or namespace name 'IHttpModule' could not be found 
(are you missing a using directive or an assembly reference?) 
```

我希望这通常可以工作，但是在事后将 Ninject 添加到项目中时，我做了一些不起作用的事情。

编辑：上述错误仅由测试项目引发....

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-05-29T16:37:05.060

确保在主项目和测试项目中都指定了 System.Web 引用。测试项目有自己的引用列表来维护。我希望您在测试项目中没有 System.Web。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-09T13:29:02.207

确保 Ninject 没有向您的模型项目添加 Web 引用。

# c# - 无法弄清楚如何返回多个计算值（3 个值，2 个取决于第一个）C#/MVC

> ID：10800644
> 
> 赞同：-1
> 
> 时间：2012-05-29T13:56:14.813
> 
> 标签：c#

一直在阅读`out`/`ref`和`tuple`，但对于我的生活，我无法弄清楚如何实现一种返回三 (3) 个值的方法（无论是在计算我的主要值的同一方法中，还是使用单独的方法）。我能够使用一个处理服务定价的值（主要值）执行计算。

这是我为计算该主要值所做的一个片段：

```
public class Calculations
{
    public decimal decFinancialAccount(QuoteData quoteData)
    {
        if (quoteData.StepAssetInformation.FinancialAccountDropDown
            == StepAssetInformation.FinancialAccount.None)
            return 0;
        else if (quoteData.StepAssetInformation.FinancialAccountDropDown
            == StepAssetInformation.FinancialAccount.One)
            return PriceQuote.priceFinancialAccount;
        else if (quoteData.StepAssetInformation.FinancialAccountDropDown
            == StepAssetInformation.FinancialAccount.Two)
            return (PriceQuote.priceFinancialAccount * 2);
        ...
        else
            return 0;
    }
    public decimal CalculateChapter7(QuoteData quoteData)
    {
        decimal total = PriceQuote.priceChapter7;

        ...
        total += this.decFinancialAccount(quoteData);

        return total;
    }
} 
```

以上效果很好。它显然`decimal`添加了其他的，但你明白了。

现在，我想对`CalculateChapter7`返回的值执行额外的计算。

第一个值是`DiscountChapter7`/ `discount`（方法中的变量？）价格：超过一定数量，每增加 50 就会应用折扣。如果必须，我可以将它们全部列出（而不是让自己复杂化）。折扣没有固定的公式，我只是创建了一个 Excel 表格来可视化我的折扣（见下文）。

第二个值是`CompareChapter7`/ `compare`（方法变量？）价格：对于我提供的每个折扣价，都会与其他人对相同服务的收费进行比较。同样，本身没有公式，我只是使用 Excel 表格任意计算出来。

另外，我想（在“折扣”和“比较”中）做一个简单的减法来显示“节省”（计算价格 - 折扣价格 = 节省）和“差异”（其他律师收费 - 折扣价格 = 差异）。我想当我得到上面的两个值时，这两个额外的值会很简单。

这是我的 Excel 表（只是一小段）：

![带有我想要的价格的 Excel 表](../Images/2c5e5fae28169e005ceeacdc973115c8.png)

关于这一点的几点说明：

1.  在 799 和 999 之间没有折扣（“四舍五入”列只是为了方便我将这些数字增加 50 并且不相关）。
2.  Excel 公式非常简单（费用 - 折扣价 = 节省；其他律师收费 - 折扣价 = 差价） - 这是我试图在我的代码中实现的。

谁能提供一个可靠的例子来说明如何将“折扣”和“比较”与我的计算价格结合起来？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T14:02:28.087

我并没有真正遵循你的具体情况，但是......如果你试图从一个函数中返回 3 个东西，那么你做错了，你的代码将很难维护。只需定义一个具有 3 个属性的新类并返回该类的一个实例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T14:05:29.037

您需要创建一个包含所有返回值的新类。如果它不打算在其他任何地方使用，您可以将类嵌套在 Calculations 类中，如下所示，但这取决于您：

```
public class Calculations
{
    public class Result
    {
        public decimal Total { get; set; }
        public decimal Discount { get; set; }
        public decimal Comparison {get; set; }
    }

    public Result CalculateChapter7(QuoteData quoteData)
    {
        Result result = new Result();
        result.Total = ...;
        result.Discount = ...;
        result.Comparison = ...;
        return result;
    }
} 
```

当你这样做时，所有三个返回值都被打包成一个对象，然后返回。每次调用该方法时，它都会创建一个新的 Result 对象并使用该方法调用的所有值填充它。因此，要在调用方法后读取返回值，您需要从返回的对象中读取每个属性。例如，您可以执行以下操作：

```
Calculations calc = new Calculations();
Calculations.Result result = calc.CalculateChapter7(...);
string output = string.Format("Total = {0}, Discount = {1}, Comparison = {2}", result.Total.ToString(), result.Discount.ToString(), result.Comparison.ToString()); 
```

# css - 是否可以完全禁止 CSS 规则？

> ID：10800650
> 
> 赞同：1
> 
> 时间：2012-05-29T13:56:35.453
> 
> 标签：css, twitter-bootstrap

在自定义第三方库时，我尽量不通过直接编辑源文件来阻止我的升级选项。

因此，在使用 Twitter 的 Bootstrap Web 框架时，我想“抑制” [bootstrap-responsive.css](https://github.com/twitter/bootstrap/blob/master/docs/assets/css/bootstrap-responsive.css)文件中的一个 CSS 规则。

> @media（最小宽度：1200px）{...}

我有一个覆盖文件，但似乎无法通过声明一个空规则来“抑制”该规则？

```
<link href="css/bootstrap-responsive.css" rel="stylesheet">
<link href="css/site.css" rel="stylesheet"> 
```

> @media（最小宽度：1200px）{}

但它不起作用。任何人都知道如何做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T14:00:42.747

如果您想“抑制”这些样式，则必须将 Twitter Bootstrap 定义的样式设置为其他值。

```
@media (min-width: 1200px) 
{
    ... reset each value to some default
} 
```

# java - 如何在android中获取Linkedin个人资料的连接

> ID：10800651
> 
> 赞同：2
> 
> 时间：2012-05-29T13:56:35.670
> 
> 标签：java, android, linkedin, linkedin-j

我正在尝试使用适用于 android 的 LinkedIn jar 和[google 代码中给出的示例从](http://code.google.com/p/linkedin-j/wiki/AndroidConfiguration)**LinkedIn获取****Connections**或用户的朋友信息，但我不会使用此方法获取 Connections 调用它返回 null，但我可以使用访问用户当前个人资料信息**`linkedInApiClient.getConnectionsForCurrentUser()``linkedInApiClient.getProfileForCurrentUser()`**

 **任何人都可以建议我如何在 android的**linkedIn中获取用户连接信息。**或以正确的方式引导我。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-30T07:34:12.970

我得到了上述问题的解决方案，我做错了什么，是我们必须传递我们想要的**ProfileField**信息的参数，如下所示：

```
final Set<ProfileField> connectionFields = EnumSet.of(ProfileField.ID, ProfileField.MAIN_ADDRESS,
                ProfileField.PHONE_NUMBERS, ProfileField.LOCATION,
                ProfileField.LOCATION_COUNTRY, ProfileField.LOCATION_NAME,
                ProfileField.FIRST_NAME, ProfileField.LAST_NAME, ProfileField.HEADLINE,
                ProfileField.INDUSTRY, ProfileField.CURRENT_STATUS,
                ProfileField.CURRENT_STATUS_TIMESTAMP, ProfileField.API_STANDARD_PROFILE_REQUEST,
                ProfileField.EDUCATIONS, ProfileField.PUBLIC_PROFILE_URL, ProfileField.POSITIONS,
                ProfileField.LOCATION, ProfileField.PICTURE_URL);
        Connections connections = client.getConnectionsForCurrentUser(connectionFields); 
```**

# java - JSP 中的复制和过去 URL 给出白页

> ID：10800652
> 
> 赞同：0
> 
> 时间：2012-05-29T13:56:36.410
> 
> 标签：java, jakarta-ee

我是这个论坛的新手。我对我的应用程序中的 JSP/servlet 有疑问我开发了一个应用程序，用户可以在其中根据某些条件搜索一些数据，他将从数据库中获取数据（通过 Hibernate 到 servlet 和 JSP）。当某些数据基于搜索显示在屏幕上时，他/她可能会尝试复制 URL 并转发给任何人，或者如果他尝试在不同的浏览器中打开它会显示一个空白页面。例如：如果我尝试粘贴下面给出的链接，它会显示空白页面 [示例链接](http://egarnet.com/JP/jobsearchresult.jsp) ，但我需要显示如何实现这一点的数据。

已编辑：单击菜单栏中的职位搜索后，如评论中所述，页面将重定向到 servlet

```
 if(action.equals("searchjob")){
            String requireskills=request.getParameter("txt_requireSkills");
             String location=request.getParameter("txt_locationName");
             session.setAttribute("location",location);
             String minexp1=request.getParameter("dd_minimum");
             String maxexp1=request.getParameter("dd_maximum");
             jobsearchDAO = new JobSearchDAOImpl(); 

            List<JobPostInfo> data=jobsearchDAO.jobsearchlist(requireskills,location,minexp1,maxexp1);

            if(data!=null && data.size()!=0){
                //save data

              if(!(session.getAttribute("LoginObject")==null)){
                JobSeeker jobSeeker=(JobSeeker)session.getAttribute("LoginObject");

                JobSearchCriteria jobsearchcriteria= new JobSearchCriteria();
                jobsearchDAO=new JobSearchDAOImpl();

                 jobsearchcriteria.setKeyWords(requireskills);
                 jobsearchcriteria.setLocation(location);

                JobSeeker jobseeker=(JobSeeker)session.getAttribute("jobseeker");
               // 
               // jobsearchcriteria.setJobSeeker(jobseeker.getJobSeekerSn()); 

               jobsearchcriteria.setJscTs(new Date());
                int value=jobsearchDAO.savesearch(jobsearchcriteria);
                 System.out.println("savesearch value------>"+value);

                }

                    session.setAttribute("jobsearchlist", data);

                  //  session.setAttribute("success","Search Criteria is saved to database."); 

                response.sendRedirect("jobsearchresult.jsp");
                }else 
                {

                  session.setAttribute("error","No Records found");

                   response.sendRedirect("jobsearch.jsp");
                }

        } 
```

这是 DAOIMPL 中的代码

```
 public List<JobPostInfo> jobsearchlist(String requireskills,String location,String minexp1,String maxexp1) throws Exception{
     long minexp;
     long maxexp;

       try{
             session =getSession();
            //Criteria Query
            Criteria query=session.createCriteria(JobPostInfo.class,"jpost");

          // if(minexp1.equals("0") && (maxexp1.equals("") || maxexp1==null)){
          if((minexp1.equals("-1")  || minexp1=="-1") && maxexp1==null){

           }
          else if(minexp1.equals("0")){

                minexp=Long.parseLong(minexp1);
                long min=1;
                query.add(Restrictions.lt("jpost.experienceMin",min)); 
           }else if(!(minexp1.equals("") || minexp1==null) && maxexp1.equals("-1")) {

                    minexp=Long.parseLong(minexp1);
                    query.add(Restrictions.ge("jpost.experienceMin",minexp));  
           }else if(!(minexp1==null && maxexp1==null)){

                   minexp=Long.parseLong(minexp1);
                   maxexp=Long.parseLong(maxexp1);
                   query.add(Restrictions.and(Restrictions.ge("jpost.experienceMin",minexp),Restrictions.le("jpost.experienceMax",maxexp)));
               }   

             //For Location 

                 if(!(location==null|| location.equals(""))){
                                    query.createAlias("jpost.location","location");
                                    query.add(Restrictions.like("location.locationName",location).ignoreCase());

                 }
            //For Keyword
             if(!(requireskills==null || requireskills.equals(""))){

                     query.add(Restrictions.like("jpost.requiredSkills","%"+requireskills+"%").ignoreCase());
                 }//requireskills

             List<JobPostInfo> list = query.setResultTransformer(Criteria.DISTINCT_ROOT_ENTITY).list();

             if(list.size()==0){
             return null;
             }else{
                 return list;
                 }

             }catch(HibernateException e){
              e.printStackTrace();
             }finally {
             close(session);
             }
             return null;

 } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T07:40:22.820

我解决了我的问题。这是一个非常基本的错误，我希望这对其他人有帮助：

`response.sendRedirect("jobsearchresult.jsp")`被替换为`request.getRequestDispatcher("studentinformation.jsp").forward(request, response)`

或`include`- 方法。第二件事是，会话是使用 servlet 创建和初始化的。当我在不同的浏览器中复制链接时，将执行 servlet 的某个块。*示例*：

> action.equals("searchjob")

因此，当会话尚不可用时，我在每个块中对其进行初始化，例如分离声明和初始化。

# actionscript-3 - AS3 - 通过指南移动一条线

> ID：10800655
> 
> 赞同：0
> 
> 时间：2012-05-29T13:56:47.520
> 
> 标签：actionscript-3

为了教学目的，我正在尝试用闪光灯制作节点动画。这就是我想要制作动画的内容：

![节点](../Images/b08c593e827c6b30e582527a118ed973.png)

我的问题：

1.  如何通过指南移动线路？
2.  指南可以保持z位置，所以我可以使绳索的顶部和底部更真实吗？
3.  矢量图像（绳索）可以通过引导路径移动吗？
4.  这可能是哪种方式，笔触或画笔？
5.  as3 脚本是否支持“装饰画笔”效果？
6.  有没有更简单的方法来做到这一点，例如桑迪或 awake3d 或贝塞尔曲线？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T19:30:28.937

1.  如果您使用的是 CS4 或 CS5 等 IDE，则有一些菜单选项可以执行此操作。我只使用文本编辑器和 Flex SDK 进行编译。虽然我知道你在说什么，但我无法真正回答这个问题，因为我没有这个程序。然而，有很多关于这个主题的教程。
2.  我相信 CS* 中的路径跟踪工具仅遵循 (x,y) 坐标。菜单中没有 Z 值，但您可以自己编写代码。同样，我没有该程序，但是从我阅读的教程来看，它看起来没有。
3.  我想它可以。您可以简单地使用一段绳索的图像（如长度等于绳索一圈的绳索图片），而不是像这里那样绘制线条图，然后应用变换来获得正确的 3D 透视图。
4.  基本的 Flash 程序仅绘制填充。但是，您可以在 Flash 中运行着色器程序（称为像素弯曲器），它会为您绘制笔触。
5.  不是靠它自己，不。但是没有什么能阻止你编写自己的装饰画笔类。
6.  贝塞尔曲线可能是要走的路。

# ruby-on-rails - 如何将模态放入部分中？

> ID：10800658
> 
> 赞同：0
> 
> 时间：2012-05-29T13:56:55.187
> 
> 标签：ruby-on-rails, twitter-bootstrap, modal-dialog, partial-views, partial

我不知道如何将模态放入部分中。请帮帮我 ！

我有按钮：

```
 <a class="btn btn-large" data-toggle="modal" href="#show_me_modal"
 onclick="printpage()">Name of button<sup>TM</sup> message in action</a> 
```

和 div 模态：

```
 <div class="modal hide fade" id="show_me_modal">
     <div class="modal-header">
      <a class="close" data-dismiss="modal">×</a>
         </div>
      <div class="modal-body">
      <p>some text</p>

      <ul class="media-grid">
        <%= image_tag("/images/pic02.png") %>
      </ul>

    </div>

    <div class="modal-footer">
      <b><%= link_to "#", '#' %></b>          
    </div>
  </div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T14:15:33.667

我`ModalHelper`为一个项目创建了。它有助于动态创建模态和指向它们的链接。希望对您有所帮助：

**帮助代码：**

创建文件 app/helpers/modal_helper.rb

```
module ModalHelper
    def modal(css_id, header_text, hidden = true, &block)
        content_tag(:div, :class => 'modal', :id => css_id, :style => ("display:none;" if hidden) ) do
            concat modal_header(header_text)
            concat modal_body(&block)
        end
    end

    def modal_button(link_text, href)
        modal_caller link_text, href, :button
    end

    def modal_link(link_text, href)
        modal_caller link_text, href
    end

    private

    def modal_caller(link_text, href, type = nil)
        options = { :"data-toggle" => "modal" }
        options.merge!({ :class => "btn" }) if type == :button
        link_to link_text, "#" + href, options
    end

    def modal_header(header_text)
        content_tag(:div, :class => 'modal-header') do
            concat content_tag(:button, 'x', :class => 'close', :"data-dismiss" => 'modal')
            concat content_tag(:h3, header_text)
        end
    end

    def modal_body
        content_tag(:div, :class => 'modal-body') do
            yield
        end     
    end 
end 
```

**模态链接：**

生成指向您的模态的链接。

```
<%= modal_link('Sign up', "myModal") %> 
```

**渲染到模态：**

包含您要呈现的代码。

```
<%= modal('myModal', 'Registration') do %>
    <% render 'devise/registrations/register' %>
<% end %> 
```

# html - 可选的空格字符限制

> ID：10800662
> 
> 赞同：5
> 
> 时间：2012-05-29T13:57:03.210
> 
> 标签：html

HTML5 参考[说明](http://www.whatwg.org/specs/web-apps/current-work/multipage/syntax.html#optional-tags)：

> 如果 head 元素后面没有紧跟空格字符或注释，则可以省略 head 元素的结束标记。

这个“空格字符”限制是什么意思？我只能认为像

```
<title>My Page</title><p>Some stuff.</p> 
```

是有效的，而

```
<title>My Page</title>
<p>Some stuff.</p> 
```

不是，因为隐式`</head><body>`标签不会围绕换行符。但我觉得我跑题了。一个澄清的例子将不胜感激。

谢谢大家！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-29T14:18:04.480

这只是意味着由于注释和空格字符可能出现在 head 元素内，它们不会隐式结束 head 元素。

*因此，如果您想在 head 元素关闭之后而不是在*它关闭之前想要评论（例如） ，那么您必须使用显式`</head>`

IE

```
</title> <!-- foo --> <body> 
```

意思是一样的

```
</title> <!-- foo --> </head><body> 
```

而且没有办法代表

```
</title></head> <!-- foo --> <body> 
```

不使用显式`</head>`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T14:07:05.733

该文档指的是元素的另一端（`</head>`通常会去哪里）。

例如：

```
<head>
    <title>Hello World</title>
<body>
... 
```

没关系，但这显然不是：

```
<head>
    <title>Hello World</title>
  <body> 
```

这也不是：

```
<head>
    <title>Hello World</title>
<!-- This is a comment --> 
```

但是（这是一个很大的问题），你永远不应该这样做。它会导致代码混乱，某些浏览器可能支持不佳，并且可能在未来的 HTML 版本中无效。通过使用良好、可读的标记来保持它的干净和稳定。

# jquery - chrome 应用程序-内容安全策略-jquery datepicker() 不起作用

> ID：10800674
> 
> 赞同：1
> 
> 时间：2012-05-29T13:57:36.100
> 
> 标签：jquery, jquery-ui, google-chrome-extension

我试过这个：

```
 <div id="d1"> sampletext </div>
    $("#d1").datepicker(); 
```

当我运行上面的代码时，它显示 datepicker ，但没有像好的背景和其他任何格式，为什么？另外，在我单击日期选择器中的任何日期后，出现错误

```
Refused to execute inline event handler because of Content-Security-Policy. 
```

我应该怎么做才能完成这项工作？或者，如果有任何我可以在不使用此日期选择器的情况下使用的解决方案，请告诉我，以便我使用它，谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-03T08:40:46.187

There is a simple solution: use jQuery UI **1.8.22 or newer**.

They finally fixed datepicker to not use inline javascript any more (a 4 year old bug ticket - [http://bugs.jqueryui.com/ticket/3945](http://bugs.jqueryui.com/ticket/3945)), solving problems with Adobe AIR, MSIE in intranet, and, yes - Chrome extensions with v2 manifest.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-06-13T12:49:42.900

如上所述，您可以升级到 1.8.22 或更高版本或解决此问题，或者您可以从以下位置直接使用所需的 JS 之一，这也适用于您。

假设您已经在使用最新版本的 JQuery Else Upgrade to Newer Version 那么您可以选择以下任何一种或使用最新的 UI 版本

[https://github.com/jquery/jquery-ui/tree/main/ui/widgets](https://github.com/jquery/jquery-ui/tree/main/ui/widgets)

# java - 我可以使用某些语法访问匿名内部类中的新方法吗？

> ID：10800678
> 
> 赞同：18
> 
> 时间：2012-05-29T13:58:04.267
> 
> 标签：java, syntax, inner-classes, member

是否有任何 Java 语法可以从外部类访问匿名内部类中定义的新方法？我知道可以有各种解决方法，但我想知道是否存在特殊语法？

例如

```
class Outer {

    ActionListener listener = new ActionListener() {

        @Override
        void actionPerformed(ActionEvent e) { 
             // do something
        }

        // method is public so can be accessible
        public void MyGloriousMethod() {
             // viva!
        }

    };

    public void Caller() {
         listener.MyGloriousMethod(); // does not work!
    }

} 
```

**我自己的解决方案**

我只是将所有方法和成员移到了外部类。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-05-29T14:07:52.687

一旦匿名类实例被隐式转换为命名类型，它就不能被转换回来，因为没有匿名类型的名称。您可以通过类内部访问匿名内部类的其他成员`this`，在表达式之后的表达式中，可以通过方法调用推断和返回类型。

```
Object obj = new Object() {
    void fn() {
        System.err.println("fn");
    }
    @Override public String toString() {
        fn();
        return "";
    } 
};
obj.toString();

new Object() {
    void fn() {
        System.err.println("fn");
    }
}.fn();

identity(new Object() {
    void fn() {
        System.err.println("fn");
    }
}).fn();
...
private static <T> T identity(T value) {
    return value;
} 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2014-10-10T21:33:46.577

我班上的一个学生问我们的教授这是否可以在前几天完成。这是我写的一个很酷的概念证明，它可以完成，虽然不值得，但实际上是可能的，方法如下：

```
public static void main(String[] args){

    //anonymous inner class with method defined inside which
    //does not override anything
    Object o = new Object()
    {
        public int test = 5;
        public void sayHello()
        {
            System.out.println("Hello World");
        }
    };

    //o.sayHello();//Does not work

    try 
    {
        Method m = o.getClass().getMethod("sayHello");
        Field f = o.getClass().getField("test");
        System.out.println(f.getInt(o));
        m.invoke(o);
    } catch (Exception e)
    {
        e.printStackTrace();
    }
} 
```

通过使用 Java 的 Method 类，我们可以通过传入方法的字符串值和参数来调用方法。字段也可以做同样的事情。

只是觉得分享这个会很酷！

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-29T14:04:07.560

你的调用者知道`listener`，`ActionListener`因此它对那个新方法一无所知。我认为做到这一点的唯一方法（除了做反射体操，这真的会破坏使用匿名类的目的，即快捷/简单）是简单地继承`ActionListener`而不使用匿名类。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-29T14:05:18.973

不，这是不可能的。您需要将 ActionListener 转换为其真实的子类名称，但由于它是匿名的，因此它没有名称。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-07-24T22:49:24.793

正确的方法是使用反射：

```
import java.lang.reflect.InvocationTargetException;

public class MethodByReflectionTest {

    public static void main(String[] args) throws IllegalAccessException, IllegalArgumentException, InvocationTargetException, NoSuchMethodException, SecurityException {

        Object obj = new Object(){
            public void print(){
                System.out.println("Print executed.");
            }
        };

        obj.getClass().getMethod("print", null).invoke(obj, null);
    }  
} 
```

你可以在这里查看：[How do I invoke an Java method when given the method name as a string?](https://stackoverflow.com/questions/160970/how-do-i-invoke-a-java-method-when-given-the-method-name-as-a-string)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-10-09T15:21:35.093

有趣的是，现在`var`构造（Java 10 或更高版本）允许这样做。例子：

```
var calculator = new Object() {
  BigDecimal intermediateSum = BigDecimal.ZERO;
  void calculate(Item item) {
    intermediateSum = Numbers.add(intermediateSum, item.value);
    item.sum= intermediateSum;
  }
};
items.forEach(calculator::calculate); 
```

这里有方法参考，但当然也适用于点方法调用。它也适用于字段。享受新的 Java。:-)

`var`我在这里找到了更多关于匿名类的技巧： [https ://blog.codefx.org/java/tricks-var-anonymous-classes/](https://blog.codefx.org/java/tricks-var-anonymous-classes/)

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2015-09-07T06:01:05.643

是的，您可以访问该方法，如果有任何疑问，请参见下面的示例，请发表评论

```
package com;
interface A
{
   public void display();
}
public class Outer {
    public static void main(String []args)
    {
        A a=new A() {
        @Override
        public void display() {
            System.out.println("Hello");
        }
     };
        a.display();
    }
  } 
```

# sql - Django ORM - 喜欢的百分号

> ID：10800680
> 
> 赞同：5
> 
> 时间：2012-05-29T13:58:15.123
> 
> 标签：sql, django, orm, django-queryset

在我的网站上，用户应该能够过滤数字，例如`*123*321*`匹配“666 *123* 555 *321* 111”或`LIKE '%123%321%'`.

默认情况下，django 的 orm 会转义[%-sign](https://docs.djangoproject.com/en/dev/topics/db/queries/#escaping-percent-signs-and-underscores-in-like-statements)。我可以使用正则表达式或原始查询，但有一些解决方法吗？

UPD：我会把它放在这里以显示另一种方式。

```
integer_search = [] # for colorizing found substrings
if actual['integer']:
    integer_match = filter(None, actual['international'].split('*'))
    integer_search = integer_match
    integer_match = ''.join('%s[[:digit:]]*' % i for i in integer_match)
    integers = integers.filter(international__regex=integer_match) 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-30T06:14:35.540

是的，Django 替换了所有的`%`and `_`。来自[文档](https://docs.djangoproject.com/en/dev/topics/db/queries/#escaping-percent-signs-and-underscores-in-like-statements)：

> 这意味着事情应该直观地工作，因此抽象不会泄漏。例如，要检索包含百分号的所有条目，只需将百分号用作任何其他字符

我建议您使用[额外的](https://docs.djangoproject.com/en/dev/ref/models/querysets/#extra)方法。它不是真正的原始 sql，虽然看起来很老套：

```
YourModel.objects.extra(where=['title LIKE %s'], params=['%123%321%']) 
```

# android - Android ICS 原生锁屏

> ID：10800683
> 
> 赞同：6
> 
> 时间：2012-05-29T13:58:26.607
> 
> 标签：android, lockscreen

过去 2 天我一直在 SW、google 等网站上寻找。我正在寻找一种方法来实现原生 Android ICS 锁屏附带的活动，如下面的屏幕所示。这些屏幕来自[Player Pro](https://play.google.com/store/apps/details?id=com.tbig.playerpro&hl=it)，但我注意到其他播放器（例如[PlayerPro](https://play.google.com/store/apps/details?id=com.tbig.playerpro&hl=it)）也具有相同的功能，看起来完全相同，这就是为什么我认为它是原生的，或者至少有一种通用的实现方式。

到目前为止，我只设法使用这些标志来获取替换锁屏的 Activity：

*   `WindowManager.LayoutParams.FLAG_SHOW_WHEN_LOCKED`
*   `WindowManager.LayoutParams.FLAG_DISMISS_KEYGUARD`

在这些事件上使用 BroadCaseReciever：

*   `Intent.ACTION_SCREEN_ON`
*   `Intent.ACTION_SCREEN_OFF`
*   `Intent.ACTION_USER_PRESENT`

我的问题是我希望我的活动显示为锁屏而不是替换它。你们知道如何实现这一目标吗？

是否有本机隐藏的 API 来执行此操作？

你们可以链接我一些实现此特定功能的示例吗？

提前致谢 ;）

![在此处输入图像描述](../Images/c8d2819a382723c85bc1bbaaf57d2107.png) ![在此处输入图像描述](../Images/3053c71f217d10dd31cda9a82316e9d0.png) ![在此处输入图像描述](../Images/c90012ea2422dae2f86f32b4a252c884.png)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-08T18:03:28.803

我想您可能正在寻找 Android 4.0（API 级别 14）中添加的音频控制“远程视图”（RemoteControlClient）API。我在 Android 开发者文档中找到[了以下`RemoteControlClient`API ：](http://developer.android.com/reference/android/media/RemoteControlClient.html)

> 使能够显示元数据、艺术作品和媒体传输控制按钮的遥控器能够公开信息。

（它是从[这个页面](http://developer.android.com/resources/samples/RandomMusicPlayer/index.html)链接的。）

注意：我自己从未使用过这个 API，所以如果这对你不起作用，我深表歉意。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T09:26:30.900

你几乎做对了。继续做你对广播接收器所做的事情。这就是要走的路。对于 Window，这些是您需要使用的标志：

*   WindowManager.LayoutParams.FLAG_SHOW_WHEN_LOCKED
*   WindowManager.LayoutParams.FLAG_NOT_TOUCH_MODAL

不要***使用***FLAG_DISMISS_KEYGAURD

这些标志的作用： SHOW_WHEN_LOCKED 允许您的活动显示在锁定屏幕的顶部。FLAG_NOT_TOUCH_MODAL 允许不在您的活动上的触摸事件转到其他活动，即允许用户解锁屏幕。FLAG_DISMISS_KEYGUARD 摆脱了锁屏，所以我们不使用它。

在 res/values/styles.xml 文件中定义此样式

```
<?xml version="1.0" encoding="utf-8"?>
<resources>
  <style name="Theme.FloatingTranslucent" parent="android:Theme.Translucent.NoTitleBar">
    <item name="android:windowIsFloating">true</item>
  </style>
</resources> 
```

在您的清单中，定义您的活动的样式

```
<activity android:name=".SampleActivity" android:theme="@style/Theme.FloatingTranslucent">
...
</activity> 
```

这样做的目的是让您的活动完全看穿和*包装内容*。

现在，您的 Activity 应该位于锁定屏幕的顶部，允许对锁定屏幕和您的应用进行触摸输入，而您的 Activity 不是全尺寸。

干杯。

# python - python mock 获取调用对象

> ID：10800685
> 
> 赞同：0
> 
> 时间：2012-05-29T13:58:29.710
> 
> 标签：python, mocking, patch

我有一个`UUT`实例化`Worker`对象并调用它们的`do_stuff()`方法的类。对象将
对象用于两件事： `Worker``Provider`

1.  调用提供者对象上的方法来做一些事情
2.  通过订阅提供程序事件的方法从提供程序获取通知

当工作人员收到通知时，它会处理它，并通知`UUT`对象，作为响应，它可以创建更多`Worker`对象。

我已经单独测试了每个类，我想一起测试`UUT`+ `Worker`。为此，我打算模拟`Provider`.

```
import mock
import unittest
import provider

class Worker():
    def __init__(self, *args):
        resource.default_resource.subscribe('on_spam', self._on_spam) # I'm going to patch 'resource.default_resource'

    def do_stuff(self):
        self.resource.do_stuff()

    def _on_spam(self, message):
        self._tell_uut_to_create_more_workers(message['num_of_new_workers_to_create'])

class UUT():
    def __init__(self, *args):
        self._workers = []

    def gen_worker_and_do_stuff(self, *args)
       worker = Worker(*args)
       self._workers.append(resource)
       worker.do_stuff()

class TestCase1(unittest.TestCase):

    @mock.patch('resource.default_resource', spec_set=resource.Resource)
    def test_1(self, mock_resource):
        uut = UUT()
        uut.gen_worker_and_do_stuff('Egg')   # <-- say I automagically grabbed the resulting Worker into self.workers
        self.workers[0]._on_spam({'num_of_new_workers_to_create':5}) # <-- I also want to get hold of the newly-created workers 
```

有没有办法获取由 生成的工作对象`uut`，而不直接访问其中的`_workers`列表`uut`（这是一个实现细节）？

我想我可以在`Worker.__init__`工作人员订阅提供程序事件的地方做到这一点，所以我想问题可以简化为：
如何`self`在调用时提取被调用方中的`resource.default_resource.subscribe('on_spam', self._on_spam)`？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-05-29T14:07:43.133

As an application of the Dependency Inversion principle, I'd pass the `Worker` class as a dependency to `UUT`:

```
class UUT():
    def __init__(self, make_worker=Worker):
        self._workers = []
        self._make_worker = make_worker

    def gen_worker_and_connect(self, *args)
       worker = self._make_worker(*args)
       self._workers.append(resource)
       worker.connect() 
```

Then provide anything you want from the test instead of `Worker`. This own function could share the created object with the test scope. Besides solving this particular problem, that would also make the dependency explicit and independent of the `UUT` implementation. And you would not need to mock the resource thing as well, which makes the test dependent on things unrelated to the class under test.

# ios - 从 xcode 4 修改配置文件

> ID：10800687
> 
> 赞同：0
> 
> 时间：2012-05-29T13:58:33.867
> 
> 标签：ios, xcode, provisioning, organizer

我有多个配置文件，在这个时候我必须添加（和删除）设备，这让我抓狂，事实上我去 developer.apple.com 并为这些配置文件删除或添加设备，我必须下载它，将其添加到组织者并删除旧的，否则我无法管理所有主题。

我查看 xcode(4.3.2)，我看到我可以添加配置文件。

有没有办法修改现有的？

或者你能告诉我你在这种情况下是怎么做的吗？

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T15:43:04.903

不，标准的 developer.apple.com 是唯一的方法。Apple 将数字签名添加到配置文件中，因此任何其他人所做的任何修改都会使其无效。

# c - 如何运行 2 对 1 元素

> ID：10800689
> 
> 赞同：0
> 
> 时间：2012-05-29T13:58:40.373
> 
> 标签：c, linux, gstreamer, gst-launch

我创建了一个名为 ntoone 的 2 对 1 简单元素。我现在的问题是如何运行它（使用 2 个 videotestsrc 和 1 个 autosink 的示例 gst-launch）。它有两个名为 video_sink 和 klv_sink 的静态“任何”接收器垫，并被添加到一个集合中。这是代码：

```
#ifdef HAVE_CONFIG_H 
#include <config.h>
#endif 

#include <gst/gst.h>
#include "gstntoone.h" 
#include <opencv/cv.h>
#include <opencv/highgui.h>

GST_DEBUG_CATEGORY_STATIC (gst_ntoone_debug); 
#define GST_CAT_DEFAULT gst_ntoone_debug 

enum 
{ 
  PROP_0, 
  PROP_SILENT, 
  LINE_COLOR 
}; 

/* the capabilities of the inputs and outputs. 
 * 
 * describe the real formats here. 
 */ 

//Creates a template for the pads. In the _init() function, you can create 
//as many pads you want from these templates. 
static GstStaticPadTemplate video_sink_factory = GST_STATIC_PAD_TEMPLATE ("video_sink", 
    GST_PAD_SINK, 
    GST_PAD_ALWAYS, 
    GST_STATIC_CAPS ("ANY") 
    ); 

static GstStaticPadTemplate klv_sink_factory = GST_STATIC_PAD_TEMPLATE ("klv_sink", 
    GST_PAD_SINK, 
    GST_PAD_ALWAYS, 
    GST_STATIC_CAPS ("ANY") 
    ); 

static GstStaticPadTemplate src_factory = GST_STATIC_PAD_TEMPLATE ("src", 
    GST_PAD_SRC, 
    GST_PAD_ALWAYS, 
    GST_STATIC_CAPS ("ANY") 
        ); 

GST_BOILERPLATE (GstNtoone, gst_ntoone, GstElement, 
    GST_TYPE_ELEMENT); 

//function prototypes 
static void gst_ntoone_set_property (GObject * object, guint prop_id, 
    const GValue * value, GParamSpec * pspec); 
static void gst_ntoone_get_property (GObject * object, guint prop_id, 
    GValue * value, GParamSpec * pspec); 
static gboolean gst_ntoone_set_caps (GstPad * pad, GstCaps * caps); 
static GstFlowReturn gst_ntoone_collected (GstCollectPads * pads, GstNtoone * filter); 

/* GObject vmethod implementations */ 
static void 
gst_ntoone_base_init (gpointer gclass) 
{ 
  GstElementClass *element_class = GST_ELEMENT_CLASS (gclass); 

  //Describe the element's details 
  //    Plugin name 
  //    Plugin type 
  //    A brief description 
  //    Author and email (email is optional) 
  gst_element_class_set_details_simple(element_class, 
    "Plugin Template", 
    "Ntoone", 
    "Generic Chain Element", 
    "Jason Trinidad jtrinidad@eoir.com"); 

  //Register the tamplates. They can be used 
  //in the init() function to create pads 
  gst_element_class_add_pad_template (element_class, 
      gst_static_pad_template_get (&src_factory)); 
  gst_element_class_add_pad_template (element_class, 
      gst_static_pad_template_get (&video_sink_factory)); 
  gst_element_class_add_pad_template (element_class, 
      gst_static_pad_template_get (&klv_sink_factory)); 
} 

/* initialize the plugin's class */ 
static void 
gst_ntoone_class_init (GstNtooneClass * klass) 
{ 
  GObjectClass *gobject_class; 
  GstElementClass *gstelement_class; 

  gobject_class = (GObjectClass *) klass; 
  gstelement_class = (GstElementClass *) klass; 

  gobject_class->set_property = gst_ntoone_set_property; 
  gobject_class->get_property = gst_ntoone_get_property; 

  g_object_class_install_property (gobject_class, PROP_SILENT, 
          g_param_spec_boolean ("silent", "Silent", "Produce verbose output ?",FALSE,     G_PARAM_READWRITE)); 

  g_object_class_install_property (gobject_class, LINE_COLOR, 
          g_param_spec_string ("line_color", "Line_color", "Chenge the color of the     line", "red", G_PARAM_READWRITE)); 

} 

/* initialize the new element 
 * instantiate pads and add them to element 
 */ 
static void 
gst_ntoone_init (GstNtoone * filter, 
    GstNtooneClass * gclass) 
{ 
  filter->srcpad = gst_pad_new_from_static_template (&src_factory, "src"); 
  gst_pad_set_getcaps_function (filter->srcpad, 
                                GST_DEBUG_FUNCPTR(gst_pad_proxy_getcaps)); 

  filter->sinkpad1 = gst_pad_new_from_static_template (&video_sink_factory,     "video_sink"); 
  gst_pad_set_setcaps_function (filter->sinkpad1, 
                                GST_DEBUG_FUNCPTR(gst_ntoone_set_caps)); 
  gst_pad_set_getcaps_function (filter->sinkpad1, 
                                GST_DEBUG_FUNCPTR(gst_pad_proxy_getcaps)); 

  filter->sinkpad2 = gst_pad_new_from_static_template (&klv_sink_factory, "klv_sink"); 
  gst_pad_set_setcaps_function (filter->sinkpad2, 
                                GST_DEBUG_FUNCPTR(gst_ntoone_set_caps)); 
  gst_pad_set_getcaps_function (filter->sinkpad2, 
                                GST_DEBUG_FUNCPTR(gst_pad_proxy_getcaps)); 

  filter->collect = gst_collect_pads_new (); 
  gst_collect_pads_set_function (filter->collect, 
      (GstCollectPadsFunction) gst_ntoone_collected, filter); 

  gst_collect_pads_add_pad (filter->collect, filter->sinkpad1, sizeof                                (GstCollectData)); 
  gst_collect_pads_add_pad (filter->collect, filter->sinkpad2, sizeof     (GstCollectData)); 

  gst_element_add_pad (GST_ELEMENT (filter), filter->sinkpad1); 
  gst_element_add_pad (GST_ELEMENT (filter), filter->sinkpad2); 
  gst_element_add_pad (GST_ELEMENT (filter), filter->srcpad); 
  filter->silent = FALSE; 

} 

    /*------------------------------------------------------------------- 
 * _set_property() is used to set arguments in the element. 
 * they can be used when running a pipelin by just typing the 
 * property name and the value right next to the plugin 
 * e.g. gst-launch -v -m videontoonesrc pattern=snow ! ntoone line_color=green !     autovideosink 
 * where pattern and line_color are properties 
 -------------------------------------------------------------------*/ 
static void 
gst_ntoone_set_property (GObject * object, guint prop_id, 
    const GValue * value, GParamSpec * pspec) 
{ 
  GstNtoone *filter = GST_NTOONE (object); 

  switch (prop_id) { 
    case PROP_SILENT: 
      filter->silent = g_value_get_boolean (value); 
      break; 
    case LINE_COLOR: 
      g_free (filter->line_color); 
      filter->line_color = g_value_dup_string (value); 
      break; 
    default: 
      G_OBJECT_WARN_INVALID_PROPERTY_ID (object, prop_id, pspec); 
      break; 
  } 
} 

static void 
gst_ntoone_get_property (GObject * object, guint prop_id, 
    GValue * value, GParamSpec * pspec) 
{ 
  GstNtoone *filter = GST_NTOONE (object); 

  switch (prop_id) { 
    case PROP_SILENT: 
      g_value_set_boolean (value, filter->silent); 
      break; 
    case LINE_COLOR: 
      g_value_set_string (value, filter->line_color); 
      break; 
    default: 
      G_OBJECT_WARN_INVALID_PROPERTY_ID (object, prop_id, pspec); 
      break; 
  } 

} 

/* GstElement vmethod implementations */ 

/* this function handles the link with other elements */ 
static gboolean 
gst_ntoone_set_caps (GstPad * pad, GstCaps * caps) 
{ 
  GstStructure *structure = gst_caps_get_structure(caps,0); 
  GstNtoone *filter; 
  GstPad *otherpad; 

  filter = GST_NTOONE (gst_pad_get_parent (pad)); 

  gst_structure_get_int (structure, "rate", &filter->srcpad); 
  otherpad = (pad == filter->srcpad) ? filter->sinkpad1 : filter->srcpad; 
  gst_object_unref (filter); 

  return gst_pad_set_caps (otherpad, caps); 
} 

static GstFlowReturn 
gst_ntoone_collected (GstCollectPads * pads, GstNtoone * filter) 
{ 
  guint size; 
  GstCollectData *cdata; 
  GstBuffer *outbuf, *sink1buf, *sink2buf; 
  GstFlowReturn ret = GST_FLOW_OK; 
  GSList *collected; 
  guint nsamples; 
  guint ncollected = 0; 
  gboolean empty = TRUE; 

  size = gst_collect_pads_available (pads); //Query how much bytes can be read from     each queued buffer. 
                                          //This means that the result of this call is     the maximum 
                                         //number of bytes that can be read from each of the pads. 

  GST_DEBUG_OBJECT (filter, "Starting to collect %u bytes", size); 

  collected = pads->data; 
  cdata = (GstCollectData *) collected->data; 
  sink1buf = gst_collect_pads_take_buffer (pads, cdata, size); 

  collected = collected->next; 
  cdata = (GstCollectData *) collected->data; 
  sink2buf = gst_collect_pads_take_buffer (pads, cdata, size); 

  gst_pad_push(filter->srcpad,sink1buf); 

  return ret; 

  goto eos; 

eos: 
  { 
    GST_DEBUG_OBJECT (filter, "no data available, must be EOS"); 
    gst_buffer_unref (outbuf); 
    gst_pad_push_event (filter->srcpad, gst_event_new_eos ()); 
    return -3; 
  } 

} 

/* entry point to initialize the plug-in 
 * initialize the plug-in itself 
 * register the element factories and other features 
 */ 
static gboolean 
plugin_init (GstPlugin * plugin) 
{ 
  /* debug category for filtering log messages 
   * 
   * exchange the string 'Ntoone plugin' with your description 
   */ 
  GST_DEBUG_CATEGORY_INIT (gst_ntoone_debug, "ntoone", 
      0, "Template plugin"); 

  return gst_element_register (plugin, "ntoone", GST_RANK_NONE, 
      GST_TYPE_NTOONE); 
} 

#ifndef PACKAGE 
#define PACKAGE "pluginntoone" 
#endif 

GST_PLUGIN_DEFINE ( 
    GST_VERSION_MAJOR, 
    GST_VERSION_MINOR, 
    "ntoone", 
    "Template Example", 
    plugin_init, 
    "0.10.28", 
    "GPL", 
    "GStreamer", 
    "http://gstreamer.net/" 
) 
```

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-03T17:22:28.367

首先检查您的元素是否显示在 gst-inspect 中。

然后您可以使用 gst-launch 使用它，如下所示：

```
gst-launch videotestsrc ! ntoone name=mix ! autovideosink videotestsrc ! ntoone. 
```

您也可以直接指定焊盘

```
gst-launch ntoone name=mix ! autovideosink videotestsrc ! ntoone.video_sink videotestsrc ! ntoone.klv_sink 
```

当没有'！' 媒体图的新分支启动。

# android - 带有两个手柄的 Android 滑动抽屉（从右到左）

> ID：10800692
> 
> 赞同：0
> 
> 时间：2012-05-29T13:58:45.733
> 
> 标签：android, slidingdrawer

我可以用一个把手从右到左实现滑动抽屉。我想要两个句柄（一个在另一个下面）并加载不同的内容。

我面临的问题是两个手柄都显示在同一位置，因此我只能看到一个手柄。

我该如何安排这两个把手？我很欣赏早先的回应。

谢谢，VK

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-30T04:48:45.693

尝试下一个小部件 [https://github.com/xPutnikx/SlidingDrawerWithButtons](https://github.com/xPutnikx/SlidingDrawerWithButtons)

让它从左到右，或其他方向。也可以在处理程序中添加一些按钮

# java - Java ip2long 等价物

> ID：10800693
> 
> 赞同：2
> 
> 时间：2012-05-29T13:58:50.393
> 
> 标签：java, php

您好，我有一个数据库可以从中选择 IP 位置>

该脚本在 php 中，我正在将其转换为 java，但我不知道`ip2long('127.0.0.1' ));`java中的等价物

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T14:06:48.273

基本上，这会将您的点 IP 地址字符串转换为长字符串。

```
public static Long Dot2LongIP(String dottedIP) {
    String[] addrArray = dottedIP.split("\\.");        
    long num = 0;        
    for (int i=0;i<addrArray.length;i++) {            
        int power = 3-i;            
        num += ((Integer.parseInt(addrArray[i]) % 256) * Math.pow(256,power));        
    }        
    return num;    
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2020-04-08T14:12:09.860

```
public static Long ipToLong(String stringIp) {
        return Arrays.stream(stringIp.split("\\."))
                .mapToLong(Long::parseLong)
                .reduce(0,
                        (a, b) -> (a << 8) + b);
}

public static String ipToString(Long longIp){
        return ((longIp >> 24) & 0xFF) + "." +
                ((longIp >> 16) & 0xFF) + "." +
                ((longIp >> 8) & 0xFF) + "." +
                (longIp & 0xFF);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-29T14:10:04.030

我认为在 Java 中没有标准的 API 可以做到这一点，但是

1/ InetAddress 类为您提供了一种获取字节数组的方法。

2/如果你真的需要一个整数，你可以使用这个片段，在[http://www.myteneo.net/blog/-/blogs/java-ip-address-to-integer-and-back/](http://www.myteneo.net/blog/-/blogs/java-ip-address-to-integer-and-back/)

```
public static String intToIp(int i) {
    return ((i >> 24 ) & 0xFF) + "." +

           ((i >> 16 ) & 0xFF) + "." +

           ((i >>  8 ) & 0xFF) + "." +

           ( i        & 0xFF);

}

public static Long ipToInt(String addr) {
    String[] addrArray = addr.split("\\.");

    long num = 0;

    for (int i=0;i<addrArray.length;i++) {

        int power = 3-i;

        num += ((Integer.parseInt(addrArray[i])%256 * Math.pow(256,power)));

    }

    return num;

} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-29T14:20:51.287

我将从将字符串转换为八位字节开始：

```
static final String DEC_IPV4_PATTERN = "^(([0-1]?\\d{1,2}\\.)|(2[0-4]\\d\\.)|(25[0-5]\\.)){3}(([0-1]?\\d{1,2})|(2[0-4]\\d)|(25[0-5]))$";

static byte[] toOctets(String address){

    if(address==null){
        throw new NullPointerException("The IPv4 address cannot be null.");
    }

    if(!address.matches(DEC_IPV4_PATTERN)){
        throw new IllegalArgumentException(String.format("The IPv4 address is invalid:%s ",address));
    }

    //separate octets into individual strings
    String[] numbers = address.split("\\.");

    //convert octets to bytes.
    byte[] octets = new byte[4];
    for(int i = 0; i < octets.length; i++){
        octets[i] = Integer.valueOf(numbers[i]).byteValue();
    }
    return octets;
} 
```

然后将八位组转换为 BigInteger，因为它接受一个字节数组，然后从它转换为一个整数：

```
static int toInteger(byte[] octets){
    if(octets==null){
        throw new NullPointerException("The array of octets cannot be null");
    }

    if(octets.length != 4){
        throw new IllegalArgumentException(String.format("The byte array must contain 4 octets: %d",octets.length));
    }

    return new BigInteger(octets).intValue();
} 
```

从这里，您可以简单地执行以下操作：

```
String address = "127.0.0.1";
System.out.println(toInteger(toOctets(address))); 
```

或者创建一个名为`ip2long(String address )`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-11-03T15:57:07.293

这适用于 IPv4 和 IPv6：

```
public static String toLongString(final String ip) {
    try {
        final InetAddress address = InetAddress.getByName(ip);
        final byte[] bytes = address.getAddress();
        final byte[] uBytes = new byte[bytes.length + 1]; // add one byte at the top to make it unsigned
        System.arraycopy(bytes, 0, uBytes, 1, bytes.length);
        return new BigInteger(uBytes).toString();
    } catch (final UnknownHostException e) {
        throw new IllegalArgumentException(e);
    }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-11-01T16:13:14.097

我希望下面的链接对您有所帮助，反之亦然

[https://www.mkyong.com/java/java-convert-ip-address-to-decimal-number](https://www.mkyong.com/java/java-convert-ip-address-to-decimal-number)。

> 以上链接提供的方法：

```
public static long ipToLong(String ipAddress) {
    String[] ipAddressInArray = ipAddress.split("\\.");

    long result = 0;
    for (int i = 0; i < ipAddressInArray.length; i++) {     
        int power = 3 - i;
        int ip = Integer.parseInt(ipAddressInArray[i]);
        result += ip * Math.pow(256, power);
    }

    return result;
}

public static String longToIp(long ip) {
    StringBuilder result = new StringBuilder(15);

    for (int i = 0; i < 4; i++) {
        result.insert(0,Long.toString(ip & 0xff));
        if (i < 3) {
            result.insert(0,'.');
        }
        ip = ip >> 8;
    }

    return result.toString();
} 
```

# extjs - 使用 Ext.loader 和 Ext.application

> ID：10800696
> 
> 赞同：2
> 
> 时间：2012-05-29T13:59:03.263
> 
> 标签：extjs, sencha-touch-2

使用 ext.application 时如何启用加载程序？

```
Ext.application({
    name: 'App',
    launch: function () {
        Ext.Loader.setConfig({enabled:true});
        Ext.Loader.setPath('App','js/App');
        Ext.create('App.view.SomeView');//this blows up in my face
    }
}); 
```

这就是我目前正在做的，它试图打开：

```
./App/view/SomeView 
```

代替

```
./js/App/view/SomeView 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T14:02:21.400

你可以像这样添加*appFolder*：

```
Ext.Loader.setConfig({enabled:true});
Ext.application({
    name: 'App',
    appFolder: 'js/App', // maybe '/js/App'

    launch: function () {
        Ext.create('App.view.SomeView');
    }
}); 
```

也许您的代码也可以工作，但是您必须将加载程序配置移出 launch() 方法，因为它会在创建应用程序后触发，我猜这会导致您的问题。

# flash - HTTPS 提供的 SWF 文件能否请求不安全的 HTTP 内容？

> ID：10800706
> 
> 赞同：5
> 
> 时间：2012-05-29T13:59:44.353
> 
> 标签：flash, http, ssl, https, network-protocols

当 SWF 托管在 HTTPS 环境中（通过 SSL）时，有没有办法让 SWF 执行跨协议（这是正确的术语吗？）HTTP 请求？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T19:05:09.927

您必须在您的 crossdomain.xml 中指定交叉 https/http 通信 - 参见例如：[http ://www.senocular.com/pub/adobe/crossdomain/policyfiles.html#allow-access-from-secure](http://www.senocular.com/pub/adobe/crossdomain/policyfiles.html#allow-access-from-secure)

# c# - FileStream 读取过早结束

> ID：10800707
> 
> 赞同：1
> 
> 时间：2012-05-29T13:59:45.557
> 
> 标签：c#, return, filestream

我有一个从视频中剥离 wav 文件的函数，然后使用从波形文件中读取的 FileStream。问题是，read 函数过早地返回 -1（没有更多字节要读取）。它是一个 20 分钟的 wav 文件，但只写了大约 17.5 分钟。

在这个功能中，我将几个波形文件混合成一个大文件。问题是大波形文件的文件流阅读器结束得太早了。我不知道为什么。

这是我的代码：

```
public void combineWaveFileData(object status)
        {

        //ProgressWindow progressWindow = status as ProgressWindow;
        ExportProgressWindow exportProgressWindow = status as ExportProgressWindow;            
        string videoAudioFile = outfileName + ".temp";                       
        int descriptionStartSample = 0;
        int highestNumber = 0;
        int extraSamplesFromExtendedDescription = 0;
        const double VOLUME_VIDEO_FACTOR = 0.8;           //controls video volume levels; won't be const as volume control will be added later
        const double VOLUME_DESCRIPTION_FACTOR = 1.5;     //controls description volume levels
        double currentSample = 0;          //keeps track of the current sample in the video audio track

        byte[] videoAudioBuffer = new byte[4];//new byte[bitsPerSample / 8];
        int sample = 0;                  //holds raw audio data sample
        int videoReadStatus = 1;
        int descriptionEndSample = 0;
        byte[] buffer = new byte[4];
        FileStream tempStream;

        videoAudioStream = new FileStream(videoAudioFile, FileMode.Open, FileAccess.ReadWrite);
        videoAudioStream.Seek(DATA_START_POS - 4, 0);
        videoAudioStream.Read(buffer, 0, buffer.Length);
        totalRawSoundDataBits = BitConverter.ToInt32(buffer, 0);
        //totalRawSoundDataBits = videoAudioStream.Length;

        videoAudioStream.Seek(24, 0);
        videoAudioStream.Read(buffer, 0, 4);
        int videoSampleRate = BitConverter.ToInt32(buffer, 0);
        sampleRateHz = videoSampleRate;

        outFileStream = new FileStream(outfileName, FileMode.Create, FileAccess.ReadWrite);
        videoAudioStream.Seek(0, 0);
        writeAudioFileHeader(outFileStream, videoAudioStream);

       // videoAudioStream.Seek(0, 0); //reset video audio position to 0 (beginning)
        convertStatus = false;

        if (compatibilityIssue)
        {
            exportProgressWindow.Close();
            return;
        }

        //calculate total length of extended description files 
        foreach (Description description in descriptionList)
        {
            if (description.IsExtendedDescription)
            {
                tempStream = new FileStream(description.getFilename(), FileMode.Open);
                totalRawSoundDataBits += tempStream.Length - DATA_START_POS;

                try
                {
                    tempStream.Close();
                    tempStream.Dispose();
                    tempStream = null;
                }
                catch { }
            }

            WaveReader read = new WaveReader(File.OpenRead(description.getFilename()));
            IntPtr oldFormat = read.ReadFormat();
            WaveFormat waveformat = AudioCompressionManager.GetWaveFormat(oldFormat);
            int descriptionSampleRateHz = waveformat.nSamplesPerSec;
            read.Close();
            string resampledFilename = description.getFilename();

            if (descriptionSampleRateHz != sampleRateHz)
            {

                exportProgressWindow.SetText(".");
                resampledFilename = convertSampleRate(description.getFilename(), sampleRateHz);
                description.setFilename(resampledFilename);

            }

        }

        for (int i = 0; i < descriptionList.Count; i++)
        {
            for (int j = 0; j < descriptionList.Count; j++)
            {
                Description tempDescription;

                if (((Description)descriptionList[i]).getStart() < ((Description)descriptionList[j]).getStart())
                {
                    tempDescription = (Description)descriptionList[j];
                    descriptionList[j] = descriptionList[i];
                    descriptionList[i] = tempDescription;
                }
            }
        }

        int k = 0;

        while (videoReadStatus > 0)
        {
            try
            {

                    Description description;
                    description = (Description)descriptionList[k];

                    descriptionStartSample = (int)Math.Truncate(sampleRateHz * description.getStart());
                    descriptionEndSample = (int)Math.Truncate(sampleRateHz * description.getEnd());

                    if (videoAudioStream.Position / 4 > descriptionStartSample )
                    {
                        double currentTime = videoAudioStream.Position / 4 / sampleRateHz;

                        Console.WriteLine(currentTime+ " " + description.getStart() + " " + description.getEnd());
                        if (k < descriptionList.Count - 1)
                        {
                            k++;
                        }
                        double percentage = Convert.ToDouble(k) / Convert.ToDouble(descriptionList.Count) * 100.0;
                        try
                        {
                            exportProgressWindow.Increment(percentage);
                        }
                        catch (Exception ex)
                        {
                            return;
                        }
                        buffer = new byte[4];
                        tempStream = new FileStream(description.getFilename(), FileMode.Open);
                        try
                        {
                            tempStream.Seek(44, 0);  //to search for position 34; write: use writeSample() 
                            int tempReadStatus = 1;
                            while (tempReadStatus > 0 && videoReadStatus > 0)//(currentSample < descriptionEndSample)
                            {
                                //If description isn't an extended description then mix the description with the video audio
                                if (!description.IsExtendedDescription)
                                {
                                    videoReadStatus = videoAudioStream.Read(videoAudioBuffer, 0, 2);                                          
                                    tempReadStatus = tempStream.Read(buffer, 0, 2);
                                    if (videoReadStatus == 0)
                                    {
                                        Console.WriteLine(currentTime);
                                        int debug = 0;
                                    }
                                    if (tempReadStatus <= 0 || videoReadStatus <=0)
                                    {
                                        int deleteme = 0;
                                    }
                                    sample += (int)(((BitConverter.ToInt16(buffer, 0))* VOLUME_DESCRIPTION_FACTOR + (BitConverter.ToInt16(videoAudioBuffer, 0) * VOLUME_VIDEO_FACTOR)) / 2);
                                    writeSample(sample);                                        

                                    sample = 0;                                      
                                }
                                else
                                // If description is extended then only write the description samples     
                                {
                                    int tempStatus = 1;
                                    while (tempReadStatus > 0)
                                    {
                                        tempReadStatus = tempStream.Read(buffer, 0, 2);
                                        sample = (int)((BitConverter.ToInt16(buffer, 0)));// -((sample * (int)(BitConverter.ToInt16(buffer, 0))) / 65535); //Z = A+B-AB/65535 http://www.vttoth.com/CMS/index.php/technical-notes/68  //* VOLUME_DESCRIPTION_FACTOR);                                                                                                            
                                        writeSample(sample);
                                        sample = 0;
                                    }
                                    break;
                                }
                            }
                        }
                        catch (Exception ex)
                        {
                            Console.WriteLine("Debug 1: " + ex.Message);//MessageBox.Show(ex.Message);
                        }
                        finally
                        {
                            tempStream.Close();
                            tempStream.Dispose();
                            tempStream = null;
                        }
                    }
                    else
                    {
                        try
                        {
                            videoReadStatus = videoAudioStream.Read(videoAudioBuffer, 0, 2);
                            sample += (int)((BitConverter.ToInt16(videoAudioBuffer, 0)) * VOLUME_VIDEO_FACTOR) ;

                            if (videoReadStatus == 0)
                            {
                                int debug = 0;
                            }

                            writeSample(sample);
                            sample = 0;

                            convertStatus = true;

                        }
                        catch (Exception ex)
                        {
                            int test = 0;
                        }
                    }

            }
            catch (Exception ex)
            {
                MessageBox.Show(ex.GetBaseException().ToString());
            }

        }

            exportProgressWindow.SetText("\n\nLiveDescribe has successfully exported the file."); 

        try
        {
            closeStreams();
            Control.CheckForIllegalCrossThreadCalls = false;

        }
        catch (Exception ex)
        {

        }

    } 
```

# ruby-on-rails - 在 RSpec 中看不到 ControllerMacros

> ID：10800710
> 
> 赞同：10
> 
> 时间：2012-05-29T14:00:00.150
> 
> 标签：ruby-on-rails, ruby-on-rails-3, rspec2

我有一个 Rails 应用程序，我正在尝试对其进行测试。我使用 devise 登录。但是，当我想测试时，我遇到了一个问题：

```
Users/ender/Projects/ratingw/spec/controllers/widgets_controller_spec.rb:4:in `block in <top (required)>': undefined local variable or method `login_user' for #<Class:0x007fe909bd5070> (NameError) 
```

首先，我想说我阅读[了这个设计正式教程](https://github.com/plataformatec/devise/wiki/How-To%3a-Controllers-and-Views-tests-with-Rails-3-%28and-rspec%29)。

我的 spec_helper.rb 是：

```
 # This file is copied to spec/ when you run 'rails generate rspec:install'
    ENV["RAILS_ENV"] ||= 'test'
    require File.expand_path("../../config/environment", __FILE__)
    require 'rspec/rails'
    require 'rspec/autorun'
    require 'capybara/rspec'

# Requires supporting ruby files with custom matchers and macros, etc,
# in spec/support/ and its subdirectories.
Dir[Rails.root.join("spec/support/**/*.rb")].each {|f| require f}

RSpec.configure do |config|
  # ## Mock Framework
  #
  # If you prefer to use mocha, flexmock or RR, uncomment the appropriate line:
  #
  # config.mock_with :mocha
  # config.mock_with :flexmock
  # config.mock_with :rr

  OmniAuth.config.test_mode = true

  OmniAuth.config.mock_auth[:twitter] = {
      :provider => 'twitter',
      :uid => '123545'
      # etc.
  }

  OmniAuth.config.mock_auth[:twitter] = :invalid_credentials

  config.include Devise::TestHelpers, :type => :controller

  config.extend ControllerMacros, :type => :controller

  config.include RequestMacros, :type => :request

  # Remove this line if you're not using ActiveRecord or ActiveRecord fixtures
  config.fixture_path = "#{::Rails.root}/spec/fixtures"

  # If you're not using ActiveRecord, or you'd prefer not to run each of your
  # examples within a transaction, remove the following line or assign false
  # instead of true.
  config.use_transactional_fixtures = true

  # If true, the base class of anonymous controllers will be inferred
  # automatically. This will be the default behavior in future versions of
  # rspec-rails.
  config.infer_base_class_for_anonymous_controllers = false

end

module ::RSpec::Core
  class ExampleGroup
    include Capybara::DSL
    include Capybara::RSpecMatchers
  end
end 
```

而且我还有一个controller_macros.rb，它位于支持文件中：

```
module ControllerMacros
  def login_user
    before(:each) do
      @request.env["devise.mapping"] = Devise.mappings[:user]
      user = Factory(:user)
      #user.confirm! # or set a confirmed_at inside the factory. Only necessary if you are using the confirmable module
      sign_in user
    end
  end
end 
```

最后，我的 controller_spec 文件是：

```
require 'spec_helper'

describe WidgetsController do
  login_user

  describe "User" do
    before(:each) do
      @current_user = mock_model(User, :id => 1)
      @widget = mock_model(Widget, :user_id => 1)
      Widget.stub!(:current_user).and_return(@current_user)
      Widget.stub!(:widgets).and_return(@widget)
    end

    it "should have a current_user" do
      subject.current_user.should_not be_nil
      redirect_to widgets_path
    end

    it "should not have a current_user" do
      redirect_to widgets_path new_user_session_path
    end
  end

  def mock_widget(stubs={})
    @mock_widget ||= mock_model(Widget, stubs).as_null_object
  end

  describe "Get index" do
    it "should get all widgets " do
      Widget.stub(:all) { [mock_widget] }
      get :index
      assigns(:widgets) == @widgets
    end
  end

  describe "Post widget" do
    it "creates a new widget" do
      Widget.stub(:new).with({'these' => 'params'}) { mock_widget(:save => true) }
      post :create, :widget => {'these' => 'params'}
      assigns(:widget) == @widgets
      response.should redirect_to (edit_widget_path(@mock_widget))
    end

    it "can not create a new widget" do
      Widget.stub(:new).with({'these' => 'params'}) { mock_widget(:save => false) }
      post :create, :widget => {'these' => 'params'}
      assigns(:widget) == @widgets
      redirect_to new_widget_path
    end
  end

  describe "Get widget" do
    it "shows exact widget via its uuid" do
      Widget.stub(:find).with("10") { mock_widget(:save => true) }
      get :show
      assigns(:widget) == @widget
    end
  end

  describe "Put widget" do
    it "updates the widget attributes" do
      Widget.stub(:find_by_uuid).with("6").and_return(mock_widget(:update_attributes => true))
      mock_widget.should_receive(:update_attributes).with({'these' => 'params'})
      put :update, :uuid => "6", :widget => {'these' => 'params'}
      response.should redirect_to (edit_widget_path(@mock_widget))
    end

    it "can not update the widget attributes" do
      Widget.stub(:find_by_uuid).with("6").and_return(mock_widget(:update_attributes => false))
      mock_widget.should_receive(:update_attributes).with({'these' => 'params'})
      put :update, :uuid => "6", :widget => {'these' => 'params'}
    end
  end

  describe "delete destroy" do
    it "destroys the requested widget" do
      Widget.stub(:find_by_uuid).with("10").and_return(mock_widget)
      mock_widget.should_receive(:destroy)
      get :destroy, :uuid => "10"
    end
  end
end 
```

我怎样才能解决这个问题？问题是什么？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-08T20:50:28.273

我猜错误源于：

```
config.extend ControllerMacros, :type => :controller 
```

你应该有：

```
config.include ControllerMacros, :type => :controller 
```

# javascript - 如何使用不同名称的 jquery 克隆生成 HTML？

> ID：10800713
> 
> 赞同：1
> 
> 时间：2012-05-29T14:00:28.257
> 
> 标签：javascript, jquery, html, clone

我有这样的 HTML：

```
<div id='main'>

   <div id='child-0'>
     <input type='text' name='data[0][name]'>
     <input type='text' name='data[0][dob]'>
     <input type='text' name='data[0][location]'>
   </div>

</div>

<input type='button' id='add' value='Add'> 
```

**jQuery：**

```
$("input#add").live( 'click', function(){
   $("#main").append("<br />");
   $("#child-0").clone(false).appendTo( $("#main") );
}); 
```

[上面的代码正在工作，但它正在创建具有相同名称的元素](http://jsfiddle.net/4u6qD/)。我想生成它是这样的：

```
<div id='main'>

   <div id='child-0'>
     <input type='text' name='data[0][name]'>
     <input type='text' name='data[0][dob]'>
     <input type='text' name='data[0][location]'>
   </div>

   <div id='child-1'>
     <input type='text' name='data[1][name]'>
     <input type='text' name='data[1][dob]'>
     <input type='text' name='data[1][location]'>
   </div>

</div> 
```

什么是简单的解决方案。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T14:08:35.770

```
$("input#add").live( 'click', function(){
    $("#main").append("<br />");
    var cloned = $("#main div:last").clone(false).appendTo( $("#main") );
    cloned.find('[name^=data]').attr('name', function() {
        var index = this.name.match(/\[(\d)\]/);
        if (index != null && index.length > 1) {
            var newIndex = parseInt(index[1], 10) + 1; 
            return this.name.replace(/\[(\d)\]/, '[' + newIndex + ']');
        }
        return this.name;    
    });
});​ 
```

# iphone - NSCoding ccColor3B 字段

> ID：10800714
> 
> 赞同：0
> 
> 时间：2012-05-29T14:00:31.323
> 
> 标签：iphone, objective-c, nscoding

我的班级中有一个 ccColor3B 属性，我想使用 NSCoding 来坚持。我怎样才能做到这一点？NSCoder 似乎没有允许它的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T14:17:32.830

@Justin 是正确的，您必须通过字节进行编码，但我认为他想多了：

```
// encode
ccColor3B input;
[coder encodeBytes:&input length:sizeof(input) forKey:@"color"];

// decode
ccColor3B output;
const uint8_t *bytes = [coder decodeBytesForKey:@"color" returnedLength:NULL];
memcpy(&output, bytes, sizeof(output)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T14:05:45.013

按字节编码，如下所示：

```
const NSUInteger BytesInCCColor = 3U;
const uint8_t bytes[BytesInCCColor] = { color.r, color.g, color.b };
[coder encodeBytes:bytes length:BytesInCCColor forKey:@"color"]; 
```

解码：

```
NSUInteger outLength = 0;
const uint8_t* const bytes =
    [coder decodeBytesForKey:@"color" returnedLength:&outLength];

if (NULL == bytes || BytesInCCColor != outLength) {
  …uh-oh…
}
else {
  color.r = bytes[0];
  color.g = bytes[1];
  color.b = bytes[2];
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-04T13:03:20.070

比使用临时类型不安全转换更好的是在 NSCoder 上实现一个类别，该类别了解如何处理它：

```
@implementation NSCoder (cocos2d)

- (void)encodeUInt32:(uint32_t)i forKey:(NSString *)key {
    union { int32_t s; uint32_t u; } v;
    v.u = i;
    [self encodeInt32:v.s forKey:key];
}

- (uint32_t)decodeUInt32ForKey:(NSString *)key {
    union { int32_t s; uint32_t u; } v;
    v.s = [self decodeInt32ForKey:key];
    return v.u;
}

- (void)encodeColor3B:(ccColor3B)color forKey:(NSString *)key {
    /* Storing 0xFF as the low 8 bits allows us to read/write ccColor3B
       and ccColor4B interchangeably. */
    uint32_t rgba = (color.r << 24) | (color.g << 16) | (color.b << 8) | 0xFF;
    [self encodeUInt32:rgba forKey:key];
}

- (ccColor3B)decodeColor3BForKey:(NSString *)key {
    ccColor3B c;
    uint32_t rgba = [self decodeUInt32ForKey:key];
    c.r = rgba >> 24;
    c.g = rgba >> 16;
    c.b = rgba >> 8;
    return c;
}

@end 
```

然后你可以这样做：

```
self.color = [decoder decodeColor3BForKey:@"color"]; 
```

和

```
[encoder encodeColor3B:self.color forKey:@"color"]; 
```

# google-visualization - 谷歌图表——不同的x轴标签和数据标签

> ID：10800715
> 
> 赞同：1
> 
> 时间：2012-05-29T14:00:34.257
> 
> 标签：google-visualization

我正在使用谷歌图表来显示一些统计数据。我正在使用柱形图。每列都有一个标签，这是一个很长的字符串。此标签显示为 x 轴标签，当我将鼠标悬停在数据列上时也是如此。我想做的是在将鼠标悬停在列上时保持这个长标签显示，但在 x 轴上只显示 ID。例如：

```
ID | Name            | Value
1  | Some long label | 3.0 
```

我希望将鼠标悬停在数据列上时显示“ID”作为 x 轴标签和“名称”。“值”是实际数据。是否有可能做到这一点？我无法在 Charts 文档中找到它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-03T01:14:08.137

我认为您可以使用 DataTable 角色，在您的情况下，可以使用支持的[工具提示](https://google-developers.appspot.com/chart/interactive/docs/roles#tooltiprole)角色，但[柱形图](https://google-developers.appspot.com/chart/interactive/docs/gallery/columnchart)。

# java - 在哪里将 jar 文件放在 ruby on rails 项目中？

> ID：10800721
> 
> 赞同：1
> 
> 时间：2012-05-29T14:01:07.203
> 
> 标签：java, ruby-on-rails, ruby, applet

我创建了一个从串行连接设备读取数据的 Java Applet。现在我需要将 Java Applet（.jar 库）添加到我的 Ruby on Rails 应用程序中，但是我应该将使用过的库放在哪个目录中，以便我可以从 applet 标记访问它们？我已经尝试将 jar 档案放入视图的同一目录中，但这似乎并没有真正起作用。

我的小程序标签在我的 ruby​​ 视图 (HAML) 中看起来像这样：

```
%applet{:'id' => "equinelife_applet", :name => "equinelife_applet", :archive => "datareader.jar", :code => "com.reader", :width => "0", :height => "0", :mayscript => "true"}
 %param{:name => "separate_jvm", :value => "true"} 
```

所以在我看来，唯一需要改变的是 datareader.jar 文件的存档路径？但是我在哪里放我的 jar 文件...

亲切的问候

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T14:03:36.867

在`public`文件夹中，可直接访问的文件（如`index.html`）所在的位置。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-29T14:05:03.363

您可以在 /public 中的任何位置放置，例如

```
public/java/file.jar 
```

所以你可以通过链接访问它

```
http://domain.com/java/file.jar 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-29T14:05:19.457

我认为正确的方法是将此类文件放入`vendor/assets`（仅适用于带有asset_pipeline的Rails）

# html - 如何在网页中显示带有缩进的源代码？HTML？CSS？

> ID：10800723
> 
> 赞同：14
> 
> 时间：2012-05-29T14:01:16.290
> 
> 标签：html, css, winforms, browser

我想在 winform 上显示一些带有 WebBrowser 控件的源代码。我想用 HTML 标签来装饰源代码，例如颜色、字体和大小。但我发现很难正确显示**缩进**。

准确地说，我的源代码保存在 String[] 中，并且每个 String 都已经保存了正确的缩进（空格或制表符）。但似乎这些缩进只是被WebBrowser 控件**忽略了。**

有人可以告诉我怎么做吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-29T14:08:54.717

我喜欢将我的代码粘贴到[Gist](https://gist.github.com/)中，然后以这种方式显示。Github 将识别代码并相应地对其进行格式化。

如果你要经常这样做，你可以试试[markdown](http://daringfireball.net/projects/markdown/)。

[或者使用像Syntax Highlighter](http://alexgorbatchev.com/SyntaxHighlighter/)这样的一次性格式化程序。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-05-29T14:02:14.957

[`<pre>`元素](http://www.w3.org/TR/html4/struct/text.html#h-9.3.4)（使用具有适当类名的[`<code>`元素](http://www.w3.org/TR/html4/struct/text.html#h-9.2.1)来标记要语法突出显示的部分）

```
<pre><code class="javascript"><code class="keyword">function</code> <code class="name">foo</code>()… 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-29T14:11:10.160

您可能希望查看此 JavaScript 库以突出显示和格式化您的代码。[http://code.google.com/p/syntaxhighlighter/](http://code.google.com/p/syntaxhighlighter/)

或者您可以查看这样的服务 - [http://pygments.appspot.com/](http://pygments.appspot.com/)或这个 - [http://hilite.me/](http://hilite.me/)

# java - 上传文件时出现 java.lang.NoSuchMethodError

> ID：10800728
> 
> 赞同：4
> 
> 时间：2012-05-29T14:01:26.430
> 
> 标签：java, jakarta-ee, file-upload

我正在开发一个具有图像上传模块的应用程序。我编写了以下代码来获取多部分表单数据。

> 列表项 = servletFileUpload.parseRequest(request);

我正在`commons-fileupload-1.2.1.jar`为此目的使用。当我在`jboss-5.1.0.GA`服务器上部署我的构建时，它在上传任何文件时都会出错。错误如下：

> java.lang.NoSuchMethodError: org.apache.commons.fileupload.servlet.ServletFileUpload.parseRequest(Lorg/apache/commons/fileupload/RequestContext;)Ljava/util/List; 在 org.apache.commons.fileupload.servlet.ServletFileUpload.parseRequest(ServletFileUpload.java:126) 在 com.bworld.action.UploadSubscriptionImage.processRequest(UploadSubscriptionImage.java:46) 在 com.bworld.action.UploadSubscriptionImage.doPost(UploadSubscriptionImage .java:145) 在 javax.servlet.http.HttpServlet.service(HttpServlet.java:637) 在 javax.servlet.http.HttpServlet.service(HttpServlet.java:717) 在 org.apache.catalina.core.ApplicationFilterChain。 internalDoFilter(ApplicationFilterChain.java:290) at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206) at org.jboss。

谁能告诉我如何从这个问题中恢复？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T14:04:08.637

您使用了错误的罐子。您的类路径引用的内容与您认为的不同。检查您的 Jboss 库和类路径中是否有名称相似但版本不同的 jar。然后做一个完整的 clean + build 循环，删除 jboss tmp 目录，然后在服务器上做一个 clean + publish。这是另一个[答案](https://stackoverflow.com/questions/425039/no-such-method-error-when-creating-junit-test)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T14:04:12.457

您的 WEB-INF/lib 文件夹中缺少您的公共文件上传 jar，或者它已经由 JBoss 提供，您不应该在 WEB-INF/lib 中复制它

相关：[http ://techblog.bozho.net/?p=866](http://techblog.bozho.net/?p=866)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-07-18T12:08:09.483

使用 commons-fileupload 1.3.3 版本。我使用并解决了这个

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-06-07T04:54:14.110

我知道这是一个老问题，但我的回答可能会对某人有所帮助，这可能是由于几个原因

1.  正如 Bonzho 提到的，您的 WEB-INF/lib 文件夹中可能缺少公共文件上传 jar
2.  commons file-upload 随最新的 tomcat 和 jboss 服务器一起提供，因此您无需在项目外部使用该 jar。但是假设您已经使用过它，那么您可以尝试将其从类路径中删除并进行干净的构建，这很可能会起作用
3.  但有时您可能仍然会收到错误提示 java.lang.NoSuchMethodError: 这可能是因为 eclipse 没有显示来自您使用的 commons-fileupload jar 的旧导入错误，因此请浏览项目的类并制作确保 import 语句是 `import org.apache.tomcat.util.http.fileupload.*`或者`import org.apache.commons.fileupload*`不是两者

使用 pom 始终是一个好习惯。

# html - 使用在 cnvas 上绘制的形状调整 html5 画布的大小

> ID：10800729
> 
> 赞同：2
> 
> 时间：2012-05-29T14:01:26.713
> 
> 标签：html, html5-canvas

我用一些硬编码的像素在 html5 画布上绘制了形状。现在我想在调整画布宽度和高度时调整drwan形状的大小。这是我的代码：

```
 var canvas  = document.getElementById("myCanvas");
          var context = canvas.getContext("2d");

                        context.moveTo(232, 158);
                        context.lineTo(314, 145);
                        context.lineTo(382, 134);
                        context.lineTo(491, 144);
                        context.lineTo(576, 154);
                        context.lineTo(512,170);
                        context.quadraticCurveTo(404, 152, 352, 160);
                        context.lineTo(304,168);
                        //context.stroke();
                        context.closePath();
                        context.fillStyle = xx_Lpattern;
                        context.fill();

                        context.beginPath();

                        context.moveTo(576, 154);
                        context.lineTo(670, 163);
                        context.lineTo(751, 174);
                        context.lineTo(748,236);
                        context.lineTo(606, 216);
                        context.quadraticCurveTo(705, 188, 576, 179);
                        context.lineTo(512,170)
                        //context.stroke();
                        context.closePath();
                        context.fillStyle = xx_Lpattern;
                        context.fill(); 
```

调整画布大小后，形状大小也应该改变（这里我想将画布大小最小化为 500x300）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-30T11:42:14.500

您应该使用转换矩阵。这是一个教程[https://developer.mozilla.org/en/Canvas_tutorial/Transformations](https://developer.mozilla.org/en/Canvas_tutorial/Transformations)

```
scale(x, y) 
```

这是您需要的功能。这是带有您的代码示例的 JSFiddle

[http://jsfiddle.net/peRxy/1/](http://jsfiddle.net/peRxy/1/)

代码 ：

```
var canvas = document.getElementById("myCanvas");
var context = canvas.getContext("2d");
var resizeFactor = 2;

drawMyWeirdShape();
canvas.width *= resizeFactor;
canvas.height *= resizeFactor;
context.scale(resizeFactor ,resizeFactor );
drawMyWeirdShape();

function drawMyWeirdShape() {
    // this is your code for drawing your weird shape
    context.moveTo(232, 158);
    context.lineTo(314, 145);
    context.lineTo(382, 134);
    context.lineTo(491, 144);
    context.lineTo(576, 154);
    context.lineTo(512, 170);
    context.quadraticCurveTo(404, 152, 352, 160);
    context.lineTo(304, 168);
    context.stroke();
    context.closePath();
    context.fill();

    context.beginPath();

    context.moveTo(576, 154);
    context.lineTo(670, 163);
    context.lineTo(751, 174);
    context.lineTo(748, 236);
    context.lineTo(606, 216);
    context.quadraticCurveTo(705, 188, 576, 179);
    context.lineTo(512, 170)
    context.stroke();
    context.closePath();
    context.fill();
}​ 
```

# c# - 引用可移植类库中的资源文件时找不到 ResourceMap 错误

> ID：10800730
> 
> 赞同：12
> 
> 时间：2012-05-29T14:01:29.877
> 
> 标签：c#, resources, portability, windows-runtime, microsoft-metro

我面临的问题如下：

我开发了一个可移植的类库来封装服务连接。在这个类库中有一个包含字符串的 Resources.resw 文件。这些字符串仅由类库的方法调用（例如覆盖 ToString() 方法）。

正如我所说，这是一个可移植的类库。如果我将它作为 dll 引用，或者甚至作为另一个解决方案中的项目引用，它就会被构建并正确编译。然后我在我的应用程序中使用这个库的方法进行调用，比如说

```
 ClientFacadeConnector connector = new ClientFacadeConnector();
        ICollection<SearchResult> results = null;
        string message = string.Empty;

        if (maxResults != -1) //Search with max Results
        {
            try
            {
                if (!contextQuery.Trim().Equals(string.Empty))
                {

                    results = await connector.GetConnected().SearchAsync(contextQuery, query, maxResults);
                    message = "Search with ContextQuery " + contextQuery + ", Query " + query + ", max results " + maxResults.ToString();
                }
                else
                {

                    results = await connector.GetConnected().SearchAsync(query, maxResults, true);
                    message = "...using normal Query search, Query " + query + ", max results " + maxResults.ToString();
                }
            }
            catch (IQserException ex)
            {
                message = ex.Message;
            }
        }

        if (results != null)
        {
            ICollection<LocalSearchResult> contentResults = new List<LocalSearchResult>();
            foreach (SearchResult s in results)
            {
                var q = s.ToString();
                var contentItem = await connector.GetConnected().GetContentAsync(s.ContentId);
                LocalSearchResult lContent = new LocalSearchResult(contentItem);
                lContent.Score = s.Score;
                lContent.Relevance = s.Relevance;
                lContent.MarkFullText(query);
                contentResults.Add(lContent);
            } 
```

在调用 s.ToString() 方法时，出现错误“找不到资源映射”。

解释这是从哪里来的：

```
public static class AppResources
{
    private static ResourceLoader resourceLoader;

    static AppResources()
    {
        // Load local file Resources.resw by default
        resourceLoader = new ResourceLoader();            
    }

    public static string GetResources(string key)
    {
        if (string.IsNullOrEmpty(key))
            throw new ArgumentNullException("key");

        return resourceLoader.GetString(key);
    }

} 
```

在被覆盖的 ToString() 方法中，有如下代码：

```
 public override string ToString()
    {
        StringBuilder buf = new StringBuilder(AppResources.GetResources("InstrSearchResultContent"));

        if (ContentId != -1)
        {
            buf.Append(AppResources.GetResources("StringContent") + " ID:" + ContentId.ToString() + " | ");
        }
        else
        {
            buf.Append(AppResources.GetResources("StringNo") + AppResources.GetResources("StringContent") + "ID" + " | ");
        }
        ... 
```

资源文件称为resources.resw，是ResourceLoader 在没有调用其他文件时调用的默认resw 文件。

奇怪的是，如果我在本地复制客户端应用程序中的资源文件，所有对类库资源文件的调用都会正确引用它，并且一切正常。

这个类库在完成后应该是一个 SDK。我需要单独分发资源文件吗？

这样的问题我从来没有遇到过普通的类库和 resx 文件。Resw让我毛骨悚然..

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-04-04T14:53:44.240

看起来您必须在创建时指定资源映射的名称`ResourceLoader`，如下所示：

```
resourceLoader = new ResourceLoader("Assembly/ResourceFile"); 
```

例如，如果您的类库名为“Company.Lib.dll”，而您的资源文件是“Resources.resw”，您将使用：

```
resourceLoader = new ResourceLoader("Company.Lib/Resources"); 
```

这似乎没有在 MSDN 上完整记录 - 它建议您只需指定资源文件的名称，但它可能仅适用于 Windows Store 应用程序项目中的资源文件。[正是这个页面](http://lehmamic.wordpress.com/2012/03/05/use-the-resourceloader-to-localize-metro-style-apps/)告诉我，对于库，您还需要指定程序集名称。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-07-18T11:33:22.200

[即使重复如何加载字符串资源](http://msdn.microsoft.com/en-US/library/windows/apps/hh965323.aspx)中的所有步骤，我也遇到了类似的问题。问题是我的 Resources.resw 文件是空的。当我添加一些假字符串时，一切都开始按预期工作。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-12-05T16:05:52.360

我有一个类似的问题，我通过在属性中将 resw 文件的 Build Action 更改为 PRIResource 解决了这个问题。我已将现有的 resx 重命名为 resw，但文档没有提到您还必须更改构建操作。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-09-12T20:51:34.830

@Rory MacLeod 发布的已接受答案可能不再正确。我试过了，VS 警告说它已`ResourceLoader(String)`被弃用。以下在我的情况下有效：

```
var loader = ResourceLoader.GetForCurrentView();
string localName = loader.GetString("someKey"); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-09-11T21:05:21.620

在开发带有类库的 UWP 应用程序时，我遇到了类似的问题。所以我的库中有一个 /Strings/en-Us/Resource.resw 文件。

```
ResourceLoader.GetForCurrentView().GetString("someKey"); 
```

给出一个例外

```
 new ResourceLoader("Company.Lib/Resources").GetString("someKey"); 
```

给我一个弃用警告但有效。

我没有发出警告的解决方案是：

```
ResourceLoader.GetForViewIndependentUse("AssemblyNamespace/Resources").GetString("someKey"); 
```

# c# - 使用调用另一个静态类方法的构造函数动态创建类

> ID：10800742
> 
> 赞同：1
> 
> 时间：2012-05-29T14:02:15.243
> 
> 标签：c#, static

我正在尝试动态创建`CommandDrawing`另一个程序集中的类实例。`CommandDrawing`类默认构造函数包含对同一汇编中另一个类中的静态方法的调用。创建了动态类，但是当它尝试在构造函数中运行静态方法调用时，它会抛出异常：

> 调用的目标已引发异常。TypeInitializeException`引发异常的类型初始化程序。

我是否必须在两个类中加载，如果是这样，如何加载？

我使用下面的代码来创建我之前成功使用过的类，并且在静态方法调用不存在时工作：

```
Assembly assemblyCommandDrawing = System.Reflection.Assembly.LoadFile(@"D:\ManifoldInspections.dll");
Type typeCommandDrawing = assemblyCommandDrawing.GetType("InspectionDetails.CommandDrawing");
object cmd = System.Activator.CreateInstance (typeCommandDrawing, new object[] { drawing, DrawingBaseDetail }); 
```

`CommandDrawing`默认构造函数如下所示 - 注意`UtilityMapControl.SetupDrawingTableTemplate`是我正在调用的静态方法，它落在了这里：

```
public CommandDrawing(Manifold.Interop.Drawing p_Drawing, InspectionDetails.DrawingBaseDetail p_ClassDetailTemplate)
{
  this.Drawing = p_Drawing;
  //this.ClassDetailTemplate = p_ClassDetailTemplate.GetType();
  this.ClassDetailTemplate = p_ClassDetailTemplate;
  ManifoldInspections.Utility.UtilityMapControl.SetupDrawingTableTemplate(this.Drawing, p_ClassDetailTemplate);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T14:32:14.270

可能无法加载依赖项。如果类型初始值设定项使用来自另一个程序集的类型，可能会发生这种情况，因为`LoadFile`它不会像您预期的那样解决依赖关系。[MSDN 说](http://msdn.microsoft.com/en-us/library/b61s44e8.aspx)：

> `LoadFile`不会将文件加载到`LoadFrom`上下文中，并且不会像该`LoadFrom`方法那样使用加载路径解析依赖关系。

所以我建议使用[`LoadFrom`](http://msdn.microsoft.com/en-us/library/1009fa28.aspx)而不是`LoadFile`.

# iphone - 可可触摸静态库项目“构建成功”后没有产品

> ID：10800743
> 
> 赞同：5
> 
> 时间：2012-05-29T14:02:16.190
> 
> 标签：iphone, arm, i386

我已经搜索了很多问题，但没有与我相同的问题。Xcode 4.3.2（4.3.1）</p>

我在一个新的 cocoa touch 静态库项目中添加了几个文件并使用**iPhone Simulator**构建它，然后收到**build success**，但产品组中没有 .a 文件（文件列表中的 .a 文件为红色，Xcode 左侧）

当我将“iPhone Simulator”更改为**IOS 设备**时，也收到**构建成功**，但现在我可以看到 .a 文件不是红色的，我可以在产品文件夹中找到^

在我使用**lipo -info**检查 .a 文件后，它显示它仅支持 arm7 架构，从而确认我的第一个操作（**模拟器**中没有内置产品）^ 所以 .a 文件不能在我的另一个项目中使用（我知道它只能通过支持 i386 架构在模拟器中使用）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T14:06:49.237

使用命令行。这是我不久前构建的一个简单脚本，它甚至会为你将你的二进制文件一起打包！

```
#!/bin/bash
#build the device
echo building for ARM architecture
xcodebuild -sdk iphoneos4.3 "ARCHS=armv6 armv7" build > /dev/null
#build the simulator
echo building for the i386 architecture
xcodebuild -sdk iphonesimulator4.3 "ARCHS=i386 x86_64" "VALID_ARCHS=i386 x86_64" build > /dev/null
#make the folder
mkdir "Fat Binary"
#lipo suck it together
echo lipo binaries together
lipo -output Fat\ Binary/libMyLib.a  -create build/Release-iphoneos/liblibMyLib.a build/Release-iphonesimulator/libMyLib.a
echo lipo binary saved at $./Fat Binary/libMyLib.a
echo coping headers
cp -R build/Release-iphoneos/usr "Fat Binary"
echo [COMPLETE] 
```

只需将出现的 替换`libMyLib.a`为您的库名称即可。

# c# - C# 控制台应用程序计时器问题

> ID：10800750
> 
> 赞同：0
> 
> 时间：2012-05-29T14:02:41.890
> 
> 标签：c#, .net, timer

我有一个由 Windows 服务调用的控制台应用程序。此控制台应用程序根据某些 App.config 文件条目创建 System.Timers.Timer 实例（我创建了一个自定义 App.config 部分，计时器实例的数量将与本部分中的元素相同）。控制台应用程序预计不会关闭 - 如果它因某种原因关闭，Windows 服务将再次调用它。

为了使控制台应用程序永远存在，我编写了一个无限循环作为控制台应用程序的最后一条语句。而（1 == 1）{}。

问题是，我看到控制台应用程序每 5 分钟终止一次。我不明白为什么会这样。

如果有更好的方法，请提出建议。

## 代码

静态无效主要（字符串[] args）{

```
 Boolean _isNotRunning;
        using (Mutex _mutex = new Mutex(true, _mutexID, out _isNotRunning))
        {
            if (_isNotRunning)
            {
                new ProcessScheduler().InitializeTimers();                             
                while (1 == 1) { }                                                         
            }
            else
            {  
                return;
            }
        } 
```

公共类 ProcessScheduler {

```
public void InitializeTimers()
    {
        XYZConfigSection.XYZAppSection section =  (XYZConfigSection.XYZAppSection)ConfigurationManager.GetSection("XYZApp");        
        if (section != null)
        {
            XYZComponentTimer XYZComponentTimer = null;
            for (int intCount = 0; intCount < section.XYZComponents.Count; intCount++)
            {
                XYZComponentTimer = new XYZComponentTimer();
                XYZComponentTimer.ComponentId = section.XYZComponents[intCount].ComponentId;
                XYZComponentTimer.Interval = int.Parse(section.XYZComponents[intCount].Interval);
                XYZComponentTimer.Elapsed += new ElapsedEventHandler(XYZComponentTimer_Elapsed);
                XYZComponentTimer.Enabled = true;                    
            }
        }
    } 
```

}

```
public class XYZComponentTimer:Timer
{        
    public string ComponentId { get; set; }
} 
```

**更新：**

如代码中所述，每个实例的计时器间隔是根据相应元素的配置文件值设置的。现在，配置文件中有两个部分：一个有 15 秒的间隔，另一个是 10 秒。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T14:09:27.663

Let me guess: The timer interval is 5min and the timer crashes causing the process to exit.

Why don't you log any crashes or attach a debugger?

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T14:20:28.533

处理[AppDomain.UnhandledException 事件](http://msdn.microsoft.com/en-us/library/system.appdomain.unhandledexception.aspx)并记录异常。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-03T04:54:53.423

出于某种奇怪的原因，Mutex 每 5 分钟被实例化一次，并将 _isNotRunning 设置为 true。这就是问题所在。

# c++ - 方法的琐碎专业化不起作用（c ++）

> ID：10800751
> 
> 赞同：3
> 
> 时间：2012-05-29T14:02:43.017
> 
> 标签：c++, methods, hyperlink, specialization

以下代码（这是我需要的简化版本）没有链接

在 *.h 文件中：

```
class InterfaceFunctionField2 {
public:
    template<class outputType> outputType to() { return outputType(); }
}; 
```

在 *.cpp 文件中

```
template<> double InterfaceFunctionField2::to<double>()
{    return 3.;  } 
```

此类位于静态库中。

我收到“错误 LNK2005：”public：double __thiscall InterfaceFunctionField2::to(void)const“(??$to@N@InterfaceFunctionField2@@QBENXZ) 已经在...中定义”和“第二个定义被忽略”警告 LNK4006

我只定义了一次 InterfaceFunctionField2::to() 专业化，并且我没有 #include *.cpp 文件....

我在互联网上查找过（[例如这里](http://www.velocityreviews.com/forums/t291707-full-specialization-of-template-member-function.html)），这种类型的代码似乎没问题，但链接器不同意。你能帮忙吗？谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-29T14:03:10.033

您还需要在标头中声明专业化。

```
//header.h
class InterfaceFunctionField2 {
public:
    template<class outputType> outputType to() { return outputType(); }
};

template<> double InterfaceFunctionField2::to<double>();

//implementation.cc
template<> double InterfaceFunctionField2::to<double>()
{    return 3.;  } 
```

您链接中的代码有效，因为该翻译单元可以看到专业化。

# jquery - jquery - 选择具有相同类的多个元素，然后按 id 过滤

> ID：10800755
> 
> 赞同：1
> 
> 时间：2012-05-29T14:02:56.433
> 
> 标签：jquery

.post 是一类元素，它们也具有唯一的 id，例如“c1”、“c14”等（表示页面上的帖子数）。

下面的代码将成为 ajax 调用的一部分，该调用会定期拉取新帖子，同时还会检查页面上当前的帖子数量。如果数量超过 5，则删除较旧的帖子。

要删除的帖子将具有最小的 ID。我怎么能选择它们？或者是否有更好的方法来选择较旧的消息（位于底部，类似于 youtube）。

```
var postcount = $(".post").length;

while(postcount > 5){
$("#c" + divtoremove).fadeOut(1000);
}

<div class="post" id="c6">Post 6</div>
<div class="post" id="c5">Post 5</div>
<div class="post" id="c4">Post 4</div>
<div class="post" id="c3">Post 3</div>
<div class="post" id="c2">Post 2</div>
<div class="post" id="c1">Post 1</div> 
```

在此示例中，应删除“c1”。我无法计算元素，我需要在每次调用时重新计算它，因为当我试图保持计数时它搞砸了。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-29T14:07:22.650

使用索引选择器过滤器非常简单：

```
$(".post:gt(4)").remove(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-29T14:05:56.413

```
var $elements = $('.post').filter(function(){
    return parseInt(this.id.substring(1)) <= 1;
});

$elements.fadeOut(1000); 
```

[**现场演示**](http://jsfiddle.net/TDzp5/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-29T14:07:27.400

你可以使用[`.filter()`](http://api.jquery.com/filter/)：

```
$('.post').filter(function(){
    return parseInt(this.id.substring(1),10) < 5;
}).fadeOut(1000); 
```

# .net - 编译失败。无法加载一种或多种请求的类型。检索 LoaderExceptions 属性以获取更多信息

> ID：10800756
> 
> 赞同：1
> 
> 时间：2012-05-29T14:03:04.667
> 
> 标签：.net, visual-studio-2010, sharepoint-2010

我正在尝试在 VS 2010、SharePoint 2010、Windows Server 2008 R2 环境中创建工作流。我向应用程序添加了一个顺序工作流。当我尝试构建应用程序时，由于工作流程，它抛出了以下错误。

> 编译失败。无法加载一种或多种请求的类型。检索 LoaderExceptions 属性以获取更多信息。

我尝试了该站点中提供的所有解决方案，但没有用。

请帮忙。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T09:23:03.790

您可以尝试一些方法来帮助诊断。

首先检查您的项目是否设置为针对正确版本的 .NET 框架进行编译。如果您的项目 dll 引用使用的是较旧版本的 .NET，但您正在针对可能导致问题的较新版本进行编译。

接下来，您应该使用[Assembly Binding 日志查看器](http://msdn.microsoft.com/en-us/library/e74a18c4(v=vs.90).aspx)（也称为 Fuslogvw）准确记录哪些 dll 无法加载以及正在寻找它们的位置，因为可能只是其中一个不在正确的位置，但它应该为您提供有关为什么无法加载的更多信息。

此外，如果您在 x86 系统上引用 x64 dll，反之亦然，这也会导致类似的错误，但程序集绑定日志查看器应该突出显示这些问题。

# regex - 如何有条件地从文本文件中删除 CRLF，最好在记事本 ++ 中

> ID：10800757
> 
> 赞同：0
> 
> 时间：2012-05-29T14:03:06.507
> 
> 标签：regex, text, import, notepad++, regex-negation

我整天都在寻找这个，这是我找到的最接近的[有用参考。](https://stackoverflow.com/questions/133965/find-crlf-in-notepad?answertab=active#tab-top)

我的问题：巨大的文件是从一个封闭的系统中导入的（不能从源头更改）并且需要导入。这些文件是 | 分隔并在每行末尾有一个 CRLF（直到最后一行）。现在他们发现包含一个新类型很有趣，该类型可以在文本中包含带有 CR 和 CRLF 的文本（instedd of `<br>`）。

所以在我可以在我们的系统中处理这个文件之前，我需要做的是替换所有没有以 | 开头的 CRLF 和 CR 事件。to `<br>`，这样每一行都以 000| 之类的代码开头 ... 600|

我在记事本++中最近的：查找：`(?<![\|])[\r\n]+$`

代替：`<br>`

问题是它不会`<br>`为每个 crlf 提供一个，在 cr 之后错过 crlf ...其他选择 |crlf 的尝试也完全忘记了 CR。

任何想法都非常感谢。请记住，文件可能超过 500MB（有点复杂）

文件摘录：

```
000|709076|153943|11||1|CRLF 
300|709076|153943|11|4|20000729||Majo509|CRLF 
500|709076|153943|11|6|3-3BNME|20000729|||21.13|4||20120509|CRLF 
600|709076|153943|11||SBV|7103||||20120509|CRLF 
600|709076|153943|11||SBV|7105||||20120509|CRLF 
600|709076|153943|11||SBV|7607||||20120509|CRLF 
600|709076|153943|11||MC||EVALUATIEROOSTER NIET INGEVULD :CR
CRLF 
------------------------------CR
CRLF 
CRLF 
Gezien U het evaluatierooster niet heeft ingevuld, blijft CR
CRLF 
CRLF 
|||20120509|CRLF 
600|709076|153943|11||SBV|7517||||20120509|CRLF 
000|709209|154072|9||1|Dne|LA1349|3100||L|20120509|CRLF 
300|709209|154072|9|3|20HEM-AT20120509|CRLF 
500|709209|154072|9|6|3-3BNME|20000908|||15.4|3||20120509|CRLF 
600|709209|154072|9||SBV|7103||||20120509|CRLF 
600|709209|154072|9||MC||AFSCHAFFING VAN DE EVOOR HET CR
CRLF 
(DE) GEBOUW(EN) CR
CRLF 
CR
CRLF 
indien U huurder of gebruiker bent.|||20120509|CRLF 
600|709209|154072|9||MC||DIEFSTAL  CRLF 
```

...

要求的结果：（粗略的复制粘贴工作；））

```
000|709076|153943|11||1|CRLF 
300|709076|153943|11|4|20000729||Majo509|CRLF 
500|709076|153943|11|6|3-3BNME|20000729|||21.13|4||20120509|CRLF 
600|709076|153943|11||SBV|7103||||20120509|CRLF 
600|709076|153943|11||SBV|7105||||20120509|CRLF 
600|709076|153943|11||SBV|7607||||20120509|CRLF 
600|709076|153943|11||MC||EVALUATIEROOSTER NIET INGEVULD :<BR><BR>---------------------<BR><BR><BR>Gezien U het evaluatierooster niet heeft ingevuld, blijft <BR><BR>||20120509|CRLF 
600|709076|153943|11||SBV|7517||||20120509|CRLF 
000|709209|154072|9||1|Dne|LA1349|3100||L|20120509|CRLF 
300|709209|154072|9|3|20HEM-AT20120509|CRLF 
500|709209|154072|9|6|3-3BNME|20000908|||15.4|3||20120509|CRLF 
600|709209|154072|9||SBV|7103||||20120509|CRLF 
600|709209|154072|9||MC||AFSCHAFFING VAN DE EVOOR HET <BR><BR>(DE) GEBOUW(EN) <BR><BR><BR><BR>indien U huurder of gebruiker bent.|||20120509|CRLF 
600|709209|154072|9||MC||DIEFSTAL  CRLF 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T15:42:48.960

哇，这个让我分阶段了一段时间......
一次完成它很棘手。

N++ 约束可能使它变得比它需要的更难，但是我想没有编写一些代码来做你想做的事，这是一个很好的方法。

虽然我不确定它是否是最佳的，但我在这个组合上取得了成功。
寻找：

> **([^|])\r([\r\n])***

代替：

> **$1<br>**

您需要替换中的 $1 ，否则您会从替换的行中丢失一个字符 - 可能不是您想要的！

理想情况下，您应该研究一些 Perl（我不是 perl 的拥护者，可以使用其他处理正则表达式的脚本语言......）或这样做的东西。

编辑：只是一个想法。这假设您的文件中不会有包含 |CRLF 或 |CR 或 |CRCR 的部分不是“真正的”行尾。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T15:50:58.787

编辑：废弃了我最后的建议 - 没有用

正如 BunjiquoBianco 所建议的那样，我认为这是不可能一次性完成的。

如果你可以使用 awk 会更好。如果您使用的是 Windows，请尝试[http://gnuwin32.sourceforge.net/packages/gawk.htm](http://gnuwin32.sourceforge.net/packages/gawk.htm)

如果 awk 是一个可行的选项，请重新提出问题，并且 awk 坚果可能会建议从命令提示符使用单线来解析整个文件。

awk is fast too - would give you a much faster transformation and can be included in other scripts more easily thereby cutting out any manual N++ process.

# jquery-ui - JQuery 自动完成 ui.item.value 只返回一个单词 - MVC3

> ID：10800758
> 
> 赞同：0
> 
> 时间：2012-05-29T14:03:08.913
> 
> 标签：jquery-ui, autocomplete

：我的部分观点之一如下：

```
<script type="text/javascript" language="javascript">
    $(document).ready(function () {
        $("#ProductName").autocomplete({
            source: "Products",
            minLength: 2,
            select: function (event, ui) {
                $("#newInvoiceLineForm").load("/Invoices/Product?name=" + ui.item.value);
            }
        });
    }); 
</script> 
```

并且自动完成工作正常并显示返回的所有项目，但在选择事件中，我得到一个 ui.item.value，其中只有两个单词项目的第一个单词。例如，我从自动完成中选择了“新产品”，它会导致：

`/Invoices/Product?name=New`称呼。

以前有人遇到过这种情况吗？

谢谢

* * *

这是与 encodeURI 一起使用的代码：

```
<script type="text/javascript" language="javascript">
    $(document).ready(function () {
        $("#ProductName").autocomplete({
            source: "Products",
            minLength: 2,
            select: function (event, ui) {
              $("#newInvoiceLineForm").load(encodeURI("/Invoices/Product?name=" + ui.item.value));
            }
        });
    }); 
</script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T14:06:25.277

您需要对字符串进行 URL 编码。查询字符串不接受原始形式的空格。

# linux - Linux Shell - 用文件中的其他字符串替换字符串

> ID：10800764
> 
> 赞同：0
> 
> 时间：2012-05-29T14:03:38.803
> 
> 标签：linux, shell

我对这个 linux shell 脚本有疑问。

```
#! /bin/bash
find /sdcard/ -type f -iname "*.srt" -print >> /sdcard/files 
count=`wc -l /sdcard/files |cut -d'/' -f1` 
for (( c=1; c<=$count; c++ ))
do
line=`sed -n ''$c'p' /sdcard/files`
cat "$line" | sed -e 's/č/c/g' > "$line".srt""
rm "$line"
done
rm /sdcard/files 
```

我知道这不是最好的方法，但这就是我所能做的一切

如您所见，它会找到所有 srt 文件，然后将所有“č”字符替换为“c”。但它不适用于我下载的文件

但是，当我创建一个新文件并在里面（用我的键盘）写“č”时，它会替换它。我不明白为什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T14:38:23.477

我想我们找到了原因，现在解决了：

```
vim somefile.srt -c ":set bomb" -c ":set fileencoding=utf-8" -c ":wq" 
```

还有一种肮脏的方式

```
echo -e "\xC2\xA0" >> somefile.srt 
```

我尝试`iconv`了应该进行转换的工具，但没有帮助。

# c# - 如何在 C# 中引用不同程序集的内部委托

> ID：10800778
> 
> 赞同：0
> 
> 时间：2012-05-29T14:04:28.963
> 
> 标签：c#, reflection, delegates

我有以下代码

```
public class MyClass{
     internal static Dictionary<string, ActivityManager.TagSerializer> TagHandlers = new Dictionary<string, ActivityManager.TagSerializer>(StringComparer.OrdinalIgnoreCase);
} 
```

其中 TagSerializer 是 ActivityManager 中的委托，如下所示

```
public class ActivityManager
{ internal delegate string TagSerializer(string tag, ActivityTemplateVariable atv, ContentType ct, CultureInfo ci);} 
```

因为 myclass 和 ActivityManager 在不同的程序集中，我的代码会返回错误

> 可访问性不一致：字段类型“System.Collections.Generic.Dictionary <string,Microsoft.Office.Server.ActivityFeed.ActivityManager.TagSerializer>”比字段“MyClass.TagHandlers”更难访问

ActivityManager 类在第三方程序集中，我无法更改。

如何使用反射来解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T14:06:59.927

您需要使用[InternalsVisibleToAttribute](http://msdn.microsoft.com/en-us/library/system.runtime.compilerservices.internalsvisibletoattribute.aspx)。

# java - 如何从其静态嵌套类修改外部类字段？

> ID：10800779
> 
> 赞同：0
> 
> 时间：2012-05-29T14:04:30.717
> 
> 标签：java, oop

修改外部类字段的正确方法是什么？当尝试从内部静态类更改时`value`，`Artifact`它会出错。需要遍历包含类型对象的数组列表`Artifact`；并且能够为每个`Artifact`（无论是硬币还是高脚杯）显示价值。

```
 public class Artifact {
        public int value = 0;

        public static class  Goblet extends Artifact{
            value = 5; // Syntax error on token "value", VariableDeclaratorId expected after this token
        }
        public static class Coin extends Artifact{
            value = 10;
        }

    } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-29T14:06:36.713

您不能`value = xxx;`在方法或块之外有语句。

这会起作用：

```
public class Artifact {

    public static void main(String[] args) {
        Artifact goblet = new Goblet();
        Artifact coin = new Coin();

        System.out.println(goblet.value); //prints 5
        System.out.println(coin.value); //prints 10
    }

    public int value = 0;

    public static class Goblet extends Artifact {

        {value  = 5;}
    }

    public static class Coin extends Artifact {

        {value  = 10;}
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T14:16:44.553

首先，这些静态类不是封闭的——它们是静态的。

其次，您不需要封闭的课程，您需要普通的顶级课程。

第三，您需要一个构造函数，`Artifact`其中传递要使用的值。

试试这个 - 三个单独的类：

```
public abstract class Artifact {
    public final int value;

    protected Artifact(int value) {
        this.value = value;
    }
}

public class Goblet extends Artifact {
    public Goblet() {
        super(5);
    }
}

public class Coin extends Artifact {
    public Coin() {
        super(10);
    }
} 
```

我选择 make`Artifact` `abstract`所以你不能直接创建一个并且必须创建一个传递值的子类，而构造函数`protected`只是为了加强这一点（只有子类可以看到它）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-29T14:15:21.393

```
public class Artifact {
public int value = 0;

public static class Goblet extends Artifact {

    public Goblet() {
        super();
        value = 5;
    }

    public void modifyOuterClassfield(int someValue) {
        value = 100 + someValue;
    }
}

public static class Coin extends Artifact {

    public Coin() {
        super();
        value = 10;

    }   

    public void modifyOuterClassfield(int someValue) {
        value = 100 + someValue;
    }

}

public int getValue() {
    return value;
}

public void setValue(int value) {
    this.value = value;
}

    public static void main(String[] args) {
    Artifact a = new Coin();
    Artifact b = new Goblet();
    Coin c = new Coin();
    Artifact d = new Artifact();

    System.out.println(a.getValue());
    System.out.println(b.value);
    System.out.println(c.getValue());
    System.out.println(d.getValue());

    a.value = 101;
    b.value = 202;
    c.setValue(303);
    d.setValue(404);

    System.out.println(a.getValue());
    System.out.println(b.value);
    System.out.println(c.value);
    System.out.println(d.getValue());
} 
```

}

输出：

10

5

10

0

101

202

303

404

静态类与静态变量不同。因此，实例初始化会起作用，因为编译器不会抱怨，但这不是完整的画面，因为您可以以其他方式初始化变量，除非您的内部类是匿名内部类，因为匿名内部类不能有构造函数。

只要字段未声明为私有，外部类的字段在内部类中始终可见！

* * *

[http://www.javaworld.com/javaqa/1999-08/01-qa-static2.html](http://www.javaworld.com/javaqa/1999-08/01-qa-static2.html)

[http://www.artima.com/designtechniques/initializationP.html](http://www.artima.com/designtechniques/initializationP.html)

# python - python中的随机语法错误？

> ID：10800780
> 
> 赞同：1
> 
> 时间：2012-05-29T14:04:37.153
> 
> 标签：python, syntax

据我所知，这似乎是完全随机的。我不知道这是怎么回事。我在 Windows 上。

```
>>> python ex.py
  File "<stdin>", line 1
    python ex.py
            ^
SyntaxError: invalid syntax 
```

谁能告诉我是什么原因造成的？这很奇怪......顺便说一句，python 2.7。无论我通过 Powershell 还是 CMD，都会出现相同的结果。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-29T14:06:21.017

您处于 python 解释器本身的交互式会话中，您不能以这种方式调用 python。

而是直接从命令行运行命令。

如果要以这种方式从 python 中执行文件，则必须使用：

```
>>> execfile("ex.py") 
```

顺便说一句，不要养成使用的习惯`execfile`——虽然很方便，除非你真的知道你在做什么以及为什么，否则它不是最好的主意。

为了详细说明这一点，根据@Levon 的请求，`execfile`以及`exec`and`eval`会导致您的脚本运行绝对任意的代码。如果您控制所有代码并且是唯一用户，那么这不是问题。不过，因为这股力量太大了，很容易被别人滥用。因此，如果您分发您的代码，并且除了使用之外绝对有任何其他方式来设计它`execfile`，请这样做。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-29T14:06:33.337

您正在尝试从 python 中调用 python.... >>>" 是 Python 解释器提示符，而不是 shell 提示符。

# android - 奇怪的Android程序错误

> ID：10800796
> 
> 赞同：0
> 
> 时间：2012-05-29T14:05:50.550
> 
> 标签：android, android-intent, broadcast

这段代码给出了一个错误，说“在活动中接收广播意图时出错”我找不到任何错误…………有什么想法吗？我已将循环条件添加为七个，因为我只想要前七个扫描结果

```
class WifiReceiver extends BroadcastReceiver {
    public void onReceive(Context con, Intent intent) {
        sb = new StringBuilder();
        wifiList = mainWifi.getScanResults();

        for(int i = 0; i < wifiList.size(); i++)
        {
            sb.append((wifiList.get(i)).SSID.toString());
            sb.append(' ');
            sb.append('!');
            sb.append("\n\n");
        }

        String net = sb.toString();

        if(wifiList.size() > 0)
        {

        char excl = '!';
        int excl1 = excl;
        String[] aray = null;
        for(int j = 0; j<7; j++)
        {
            int index = net.indexOf(excl1);
            String a = net.substring(0, index);
            aray[j] = a;
            String temp = net.substring(index+1);
            net = temp;

        }

        String one = aray[0];
        String two = aray[1];
        String three = aray[2];
        String four = aray[3];
        String five = aray[4];
        String six = aray[5];
        String seven = aray[7];
        tv1.setText(one);

    }
        else
        {
            tv1.setText("No Networks Detected");
        }
}
} 
```

PS：我只添加到一个 TextView 因为这是一个测试模块

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T15:40:34.923

“aray”数组未正确初始化。您需要在访问它之前初始化“aray”：

```
String[] aray = new String[7]; 
```

您还将超出数组的维度。这：

```
String seven = aray[7]; 
```

应该：

```
String seven = aray[6]; 
```

更好的解决方案是使用 ArrayList。

```
ArrayList al = new ArrayList();
al.add(yourString); 
```

# objective-c - 目标 C：消息传递 / 属性声明 / ARC 麻烦

> ID：10800797
> 
> 赞同：0
> 
> 时间：2012-05-29T14:05:52.677
> 
> 标签：objective-c, automatic-ref-counting

我得到了 XCode 标签`ARC Issue`，我很难解析。我有这堂课：

```
typedef void (^sig_cb_t)(NSString *parm);

@protocol Signaleer
// <snip>
-(void) connect:(NSString *) verb
          parm:(NSString*) param
      callback:(sig_cb_t)callback;
@end

// In another header:
@interface Switchboard : NSObject <Signaleer> {
   @private
   NSMutableDictionary *bus;
}

// In init: method:
bus = [[NSMutableDictionary alloc] init];

// actual implementation:
-(void) connect: (NSString *)verb
           parm:(NSString*)parm
       callback:(sig_cb_t)callback {
  NSMutableArray *callbacks = [self.bus objectForKey:verb];
  NSArray *signal = [NSArray arrayWithObjects:callback, parm, nil];
  if (callbacks == nil) {
    NSArray *initial = [NSArray arrayWithObjects:signal, verb, nil];
    [bus setObject: initial, forKey:verb];
  } else {
    [callbacks addObject:signal];
  }
} 
```

该行`[bus setObject: initial, verb]`导致错误`No visible @interface for 'NSMutableDictionary' declares the selector 'setObject:'`。谁能解释一下？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T14:09:39.303

I assume you are referring here to the line:

```
[bus setObject: initial, forKey:verb]; 
```

(you write `[bus setObject: initial, verb]` in the last line of your question which I assume is a mistake)

Both lines have a comma in there, which shouldn't be there.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T14:09:40.200

You have a comma after `initial`. It should be:

```
 [bus setObject:initial forKey:verb]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-29T14:09:49.833

从该方法调用中删除逗号，您将不再有错误。不需要逗号来分隔 Objective-C 中的普通参数列表

```
[bus setObject:initial forKey:verb]; 
```

# google-maps - 即使没有互联网连接，基于网络的应用程序中的谷歌地图也能工作？

> ID：10800799
> 
> 赞同：0
> 
> 时间：2012-05-29T14:06:06.073
> 
> 标签：google-maps

即使没有互联网连接，是否有可能使用谷歌地图 api 的应用程序（基于网络）？

假设必须在某处缓存或存储地图，以便在没有互联网连接时应用程序仍然可以工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T14:10:58.913

我对此表示怀疑。Google Maps 是一项网络服务，您可以通过 API 密钥将其放入您的应用程序中。

因此，您需要有 Internet 连接才能真正调用 Google 地图网络服务来验证您的 API 密钥并加载它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T14:11:16.433

我假设您的意思是在 Intranet 内部运行以访问 Google 地图的 Web 应用程序。尽管似乎有此功能的 Android 版本，但此[链接可能会为您提供一些线索。](http://groups.google.com/group/google-maps-js-api-v3/browse_thread/thread/b002e926ad761e34)在“离线谷歌地图”上的谷歌搜索返回了相当多的 Android 链接

# java - java和c++中的动态方法调度

> ID：10800802
> 
> 赞同：1
> 
> 时间：2012-05-29T14:06:19.067
> 
> 标签：java, c++, dynamic

在这个 C++ 程序中，

```
#include<iostream>
using namespace std;

class Base
{

    public:

    Base()
    {
        cout<<"\n\nBase ctr";
        fun();
    }  

    virtual void fun()
    {
        cout<<"\n\nBase's fun()";
    }
};

class Derived : public Base
{
    public:

    Derived()
    {
        cout<<"\n\nDerived ctr";
        fun();
    }

    virtual void fun()
    {
        cout<<"\n\nDerived's fun()";
    }
};
    int main()
    {
        Derived obj;
        return 0;
    } 
```

当使用 Derived 类对象从 Base 类的构造函数调用虚函数时，会调用 Base 的类 fun()，

输出::
基础 ctr

基地的乐趣（）

派生的 ctr

派生的乐趣（）

原因在[这里](http://www.parashift.com/c++-faq/strange-inheritance.html#faq-23.5)解释 但是

在这个java程序中，

```
class Base
{
    Base()
    {
        System.out.println( "\n\nBase ctr" );
        fun();
    }
    void fun()
    {
        System.out.println( "\n\nBase's fun()" );
    }
}

class Derived extends Base
{
    int a=1;

    Derived()
    {
        System.out.println( "\n\nDerived ctr a = "+a );

        a=8;
        fun();
    }

    void fun()
    {
       System.out.println( "\n\nDerived's fun() a = "+a );
    }

    public static void main(String args[])
    {
       Derived obj = new Derived();
    }
} 
```

输出是 ::
Base ctr

派生的 fun() a = 0

导出 ctr a = 1

派生的 fun() a = 8

这里调用了派生类fun()，所以应用于c++程序的[约束](http://www.parashift.com/c++-faq/strange-inheritance.html#faq-23.5)，不适用于JAVA程序。为什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T14:25:24.660

这两种语言采用不同的方法进行动态调度。在 C++ 中，它只会分派给完全构造的对象。这是通过在构造过程中随着层次构造函数的不同级别*开始*执行而*更改对象的类型来处理的。*另一方面，Java 甚至在启动最基础的构造函数之前就认为对象是最派生的类型。

 *Java 方法的问题在于它实际上可能在尚未构造的对象上执行代码。考虑派生类型有一个初始化为 X 的字段，并且它在方法中被访问/更新。在基础对象上调用该方法将在构造函数初始化之前访问该成员。

无论如何，您应该避免在任何一种语言的对象的构造函数或析构函数中调用虚函数。

* * *

说明性示例：

```
public class Base {
   public final int x;
   public Base() { 
      x = foo();
   }
   int foo() { return 1; }
}
public class Derived extends Base {
   public final int y;
   public Derived() {
      y = 2;
   }
   int foo() { return y; }
}
Derived d = new Derived();
assert( d.x == d.y );                      // Can this ever fail? 
```

在这段代码中，我们有 2 个 final `int`，代码看起来很简单，可以推理。`assert`会失败吗？*

# php - 尝试将使用 SQL 语句从 PHP 脚本生成的 JSON 数据返回到 JS 网页，但取而代之的是 null

> ID：10800811
> 
> 赞同：1
> 
> 时间：2012-05-29T14:06:33.170
> 
> 标签：php, javascript, jquery, sql, ajax

我想在按下**提交按钮时从 PHP 脚本中的结果 SQL 语句返回****JSON**数据，但我收到了。**`null`**

 ***我将使用返回的 JSON 在我的 Google 地图上过滤显示标记，但现在我只想从 PHP 脚本将数据返回到我的 jQuery 页面，以便我可以操作/使用它。*

**提交按钮**：

*HTML*

```
<input type="submit" id="filter" value="Filter" /> 
```

*JS*

```
$('#myform').on('submit', function(e) {
  e.preventDefault();
  var myData = $('#myform').serializeArray();
  $.getJSON('myscript.php', myData, function(json){
    alert(json);// actually filter for later                    
  });   
}); 
```

**PHP 脚本**：

```
// action is a hidden form control I use to check if form was submitted
    if(isset($_POST["action"])){

        if(isset($_POST["color"]) && isset($_POST["zipcode"])){
            // try to open a connection to a MySQL server
            $connection = mysql_connect($host, $username, $password) or die("Could not connect" . mysql_error());
            // select the active MySQL database to work with
            $db_selected = mysql_select_db($database, $connection) or die("Can\'t use db:" . mysql_error());

            $query = 'sql statement to return resutls based on what color and zipcode was provided';
            $result = mysql_query($query) or die("Can\'t do that: " . mysql_error());
        }

        //  close connection to the database

    echo json_encode($result);
    mysql_close($connection);
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T14:10:31.857

您不能直接返回`mysql_query`调用的结果对象。您首先必须使用类似`mysql_fetch_array`或类似的函数（[PHP 文档](http://php.net/manual/en/function.mysql-fetch-array.php)）对其进行解析。

```
...
$result = mysql_query($query);
if ( $result === false ) {
  die("Can\'t do that: " . mysql_error());
}

$retVal = array();
while( $row = mysql_fetch_array( $result ) ) {
  $retVal[] = $row;
}

...
echo json_encode( $retVal ); 
```

**编辑**

根据`getJSON`( [link](http://api.jquery.com/jQuery.getJSON/) ) 的 jQuery 规范，数据是使用 GET 参数发送的，而不是使用 POST。因此，您必须将`$_POST`PHP 代码中的所有外观更改为`$_GET`或`$_REQUEST`.

除此之外，如果您的变量未设置，您应该返回一些错误消息。现在（根据您的代码）只返回一个空文档。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T14:11:22.733

在 echo 之前，您应该声明返回的内容类型：

```
header('Content-Type: application/json'); 
```

如果要检查数据的接收，可以使用：

```
$.ajax({
    url: url,
   data: myData,
   success: function(json) {},
   error: function(json) {} // this should allow you to check if data is received (but since the content type is set to text/html and $.getJSON expectr application/json it won't be a success)
}); 
```**

# class - 静态成员上的 Groovy getProperty()

> ID：10800815
> 
> 赞同：4
> 
> 时间：2012-05-29T14:06:40.223
> 
> 标签：class, groovy, static, jvm, static-members

这个问题可能会说明我对 Groovy 类的工作方式缺乏了解，但我试图自己解决这个问题，但没有运气。我想在一个类上创建一个 getProperty() 方法，这样我就可以以 Groovyish 的方式引用成员变量。这与将它们公开不同，因为我确实希望在引用它们时完成一些逻辑。基本上，我正在尝试创建一个使用 ConfigSlurper 的配置 Groovy 类：

```
class Configuration implements GroovyObject {
  private static ConfigObject config  = new ConfigSlurper().parse(new File("testing.conf").toURI().toURL())

  //This method is illegal, but it illustrates what I want to do
  public static String getProperty(String prop){
    config.getProperty(prop)
  }
} 
```

如果上面的类是合法的，那么我可以像这样引用配置项：

```
Configuration.dbUser 
```

而不是这个，这需要使 ConfigObject 可用：

```
Configuration.config.dbUser 
```

我知道，将配置对象公开会更容易，但知道如何做到这一点（或知道为什么不可能）将帮助我更好地理解 Groovy。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T14:26:28.730

我可以让它工作的唯一方法是通过元类：

```
class Configuration {
  private static ConfigObject config  = new ConfigSlurper().parse( "foo = 'bar'" )
}

Configuration.metaClass.static.propertyMissing = { name ->
  delegate.config[ name ]
}

println Configuration.foo 
```

但是可能有更好的方法...

# javascript - onPageLoad 在 Firefox 扩展开发中无法正常工作

> ID：10800818
> 
> 赞同：0
> 
> 时间：2012-05-29T14:06:53.540
> 
> 标签：javascript, firefox-addon, xul

我是 Firefox 扩展开发的新手，正在做我的第一个程序。只是我需要在加载页面后弹出一个警报。我的代码是这样的：

```
var myExtension = {  
init: function() {    
    if(gBrowser) gBrowser.addEventListener("DOMContentLoaded", this.onPageLoad, false);  
},  
onPageLoad: function(aEvent) { 
alert("Loaded");  
}
}  
window.addEventListener("load", function load(event){  
window.removeEventListener("load", load, false);
myExtension.init();    
},false); 
```

但是我收到了几次警报框。然后我发现了“#document”，然后我添加了一个 IF 条件：

```
onPageLoad: function(aEvent) { 
    if (aEvent.originalTarget.nodeName == '#document')  {
    alert("Loaded");  
    }
} 
```

不幸的是，我还是一样。请就此给我建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T11:13:28.820

可能是 iframe 问题。要过滤掉 iframe：

```
onPageLoad: function(aEvent) { 
    let ot=aEvent.originalTarget;
    if (ot.nodeName == '#document' && !ot.defaultView.frameElement)  {
    alert("Loaded");  
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T11:14:12.143

您可以在 MDN 找到从 Firefox 插件拦截页面加载的几种方法的描述： [https ://developer.mozilla.org/en/XUL_School/Intercepting_Page_Loads](https://developer.mozilla.org/en/XUL_School/Intercepting_Page_Loads)

选择正确的解决方案取决于您想要实现的目标。

*   您想在某些特定页面加载时做些什么吗？
*   你想在任何页面加载时做些什么吗？
*   当整个页面加载（onload），文档准备好（ondomready）或Firefox中显示的页面发生变化时，例如切换或打开标签时（这需要完全不同的方法），您是否需要这样做？

# php - 将今天的日期与数据库中列出的日期进行比较

> ID：10800819
> 
> 赞同：0
> 
> 时间：2012-05-29T14:06:54.720
> 
> 标签：php, mysql, date

我正在使用 mysql 和 php 将所有与今天日期相同的用户从 mysql 数据库中提取出来。我遇到的问题是每当我运行以下代码时都会出错。看起来错误似乎与年份有关，或者它不喜欢其中的点，但我不确定？

```
<?php
$today = date("d.m.y");
$result = mysql_query("SELECT * FROM ymeg_chronoforms_data_NewsletterSubscribe
 WHERE date=$today")or die(mysql_error());

while($row = mysql_fetch_array($result))
  {
  echo $row['name'] . " " . $row['email']. " " . $row['date'];
 echo "<br />";
  }

  ?> 
```

这是它抛出的错误：

```
You have an error in your SQL syntax; check the manual that corresponds to your 
MySQL server version for the right syntax to use near '.12' at line 2 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T14:11:15.587

首先，应该将 $today 作为字符串添加到 SQL 查询中：

```
mysql_query("SELECT * FROM ymeg_chronoforms_data_NewsletterSubscribe WHERE `date` = '$today'"); 
```

`date`是一个 SQL 保留字，所以它必须用反引号转义...

但我建议使用 MySQL 原生函数和常量，如,`NOW()`等...`CURRENT_TIMESTAMP``SYSDATE`

```
SELECT * FROM ymeg_chronoforms_data_NewsletterSubscribe WHERE `date` = NOW()
SELECT * FROM ymeg_chronoforms_data_NewsletterSubscribe WHERE `date` < NOW() - INTERVAL '2' DAYS
SELECT * FROM ymeg_chronoforms_data_NewsletterSubscribe WHERE `date` > NOW() + INTERVAL '5' HOURS 
```

ETC...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T14:09:26.430

You have to add quotes around your date string:

```
$result = mysql_query("SELECT * FROM ymeg_chronoforms_data_NewsletterSubscribe
WHERE date='$today'")or die(mysql_error()); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-29T14:10:10.830

`$today`需要在变量周围加上引号。还需要反引号`date`列名，因为它是保留的。

```
$result = mysql_query("SELECT * FROM ymeg_chronoforms_data_NewsletterSubscribe
      WHERE `date`='$today'")or die(mysql_error()); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-29T14:11:26.803

如果您在 mysql 中使用时间戳作为数据类型，那么您需要先将日期转换为 unix 时间戳。

```
$today = strtotime("now"); 
```

或者如果您使用的是日期时间或日期数据类型，那么正确的格式是

```
YY-MM-DD, so you need to create the date accordingly. 

$today = ('Y-m-d'); 
```

而且在您的查询中，您缺少单引号。

```
"SELECT * FROM ymeg_chronoforms_data_NewsletterSubscribe WHERE date = '$today'" 
```

但是您可以不使用 PHP 的日期函数直接使用 MYSQL NOW() 来比较日期。

```
SELECT * FROM ymeg_chronoforms_data_NewsletterSubscribe WHERE date = NOW() 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-29T14:15:48.987

尝试

```
$today = date("d-m-Y"); 
```

或者

```
$today = date("Y-m-d"); 
```

另外，检查日期列的格式是否等于返回值的格式`date()`。

如果您使用过`DATETIME`数据类型，您可能需要使用匹配格式。

此外，用单引号包裹日期值......

```
$result = mysql_query("SELECT * FROM ymeg_chronoforms_data_NewsletterSubscribe
WHERE date = '" . $today . "'") 
```

# eclipse-plugin - egit 合并工具已禁用

> ID：10800823
> 
> 赞同：7
> 
> 时间：2012-05-29T14:07:02.407
> 
> 标签：eclipse-plugin, github, egit

我最近安装了 eclipse indigo 和 egit V1.3 并在其中配置了我的项目。如果发生冲突，我无法按照[http://wiki.eclipse.org/EGit/User_Guide#Using_Merge_Tool中的文档使用 Team->Merge Tool。](http://wiki.eclipse.org/EGit/User_Guide#Using_Merge_Tool)合并工具选项被禁用。在谷歌搜索指向我[https://bugs.eclipse.org/bugs/show_bug.cgi?id=339092](https://bugs.eclipse.org/bugs/show_bug.cgi?id=339092)，但看起来这个错误已经在新版本中得到解决。还有什么我需要配置的吗？

我直接在主分支上工作。我错过了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T20:09:10.880

[同步视图](http://wiki.eclipse.org/EGit/User_Guide#Comparing_with_Branches_.28Synchronize.29)也称为“与分支比较”。
它*进行比较*（本身不合并）。它允许您查看差异（并检测潜在的冲突，如果您合并它们），它不会启动合并。

如果您将远程分支拉/合并/樱桃选择到本地分支，则合并工具应该处于活动状态。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-06-09T06:16:58.563

在没有很好的合并尝试后，我遇到了类似的问题。该选项被禁用，并且在 repo 的视图中它丢失了。

重置解决了这个问题。见图片。

[![Egit上的休息选项](../Images/1ae9ea4a828df20b9b6b1c7ca871a6e7.png)](https://i.stack.imgur.com/G1PhV.jpg)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-10-11T07:38:24.410

从 Eclipse 获得丑陋的 CheckoutConflictException 后，Eclipse-Merge Tool 按钮被禁用。

Git 需要将所有文件添加到索引中才能启用合并。

因此，要合并您的更改并提交它们，您需要先将文件添加到索引“添加到索引”中，然后“提交”它们而不使用“推送”。然后您应该在 Eclipse 中看到一个待处理的拉取和一个待处理的推送请求。您可以在一个向上箭头和一个向下箭头中看到这一点。

如果所有冲突文件都在提交中，您可以再次“拉”。然后你会看到类似的东西：

\< < < < < < < HEAD 服务器版本 \======= 本地版本 > > > > > > > ....git 的分支'master'

然后，您可以通过合并工具更改它，该工具现在已启用，或者直接在文件中手动进行合并。在最后一步中，您必须将修改后的文件再次添加到索引中并“提交并推送”它们。

检查完毕！

# javascript - Chrome 网上应用店页面是如何工作的？

> ID：10800826
> 
> 赞同：1
> 
> 时间：2012-05-29T14:07:18.677
> 
> 标签：javascript, html, google-chrome, dialog, chrome-web-store

Chrome 网上应用店有一些奇怪的地方：

1.  它会打开导航到新 URL 的对话框
2.  发生这种情况时屏幕不闪烁
3.  并且原始页面仍然显示在对话框后面，具有相同的项目和滚动位置

我有 HTML4 的背景，我不能这样做，我不知道是否可以在 HTML5 中做同样的事情。我的猜测是，这种行为是因为 Chrome 浏览器在处理其商店时具有特殊行为。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T14:14:06.870

它使用新的 HTML5方法，如[这里](http://html5demos.com/history)`history.pushState();`演示和解释[这里](http://diveintohtml5.info/history.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T14:17:42.923

阅读有关[jQuery](http://jquery.com/)、[Dojo](http://dojotoolkit.org/)、[MooTools](http://mootools.net/)、[YUI](http://yuilibrary.com/)、[script.aculo.us](http://script.aculo.us/)等的信息。

如今，Javascript 非常强大，可用于在浏览器中执行一些高级操作。对于 diaglogs，您可以查看[DOMWindow](http://swip.codylindley.com/DOMWindowDemo.html)、[FancyBox](http://fancybox.net/)等内容。您可以将一个完全独立的网页放入弹出对话框中。

[这个 StackOverflow 问题](https://stackoverflow.com/questions/2050174/what-is-the-best-alternative-for-jquery-thickbox)也收集了一些其他建议。有[很多选择](http://planetozh.com/projects/lightbox-clones/)。

# c# - 根据使用样式的控件中的属性修改 WPF 样式中的参数

> ID：10800832
> 
> 赞同：2
> 
> 时间：2012-05-29T14:07:35.717
> 
> 标签：c#, wpf, styles, dependency-properties

我创建了一种样式，它定义了控件的通用外观。这包括一个`RadialGradientBrush`, 和一个带有圆角半径的边框。

我将此样式应用于我想要看起来像这样的相关**边框控件。**

在样式中，我为 指定了 3 种颜色`RadialGradientBrush`，但是，我希望能够使指定的颜色中的一种从实际的**边框**控件中拾取颜色。

```
<Style x:Key='ButtonStyle' TargetType='Border'>
    <Setter Property='CornerRadius' Value='10' />
    <Setter Property='Margin' Value='2' />
    <Setter Property='BorderThickness' Value='1'/>
    <Setter Property='BorderBrush' Value='White'/>
    <Setter Property='Background'>
        <Setter.Value>
            <RadialGradientBrush >
                <GradientStop Color='DarkBlue' Offset='0.9'/>
                <GradientStop Color='White' Offset='0.7'/>
                <GradientStop Color='Black' Offset='0.3' />
            </RadialGradientBrush>
        </Setter.Value>
    </Setter>
</Style> 
```

因此，在 <Style> 中显示 DarkBlue 的地方，我**希望****它**说类似. 然后它将使用实际控件中定义的背景颜色来替换该值。**`Control.Backcolor`**

 **希望这是有道理的。谢谢里奇。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T15:42:36.210

你可以这样解决它：

```
 <Grid>
    <Grid.Resources>
      <local:ColorConverter x:Key="myColorConverter"/>
      <Style x:Key="ButtonStyle" TargetType="{x:Type Border}">
        <Setter Property="CornerRadius" Value="10" />
        <Setter Property="Margin" Value="2" />
        <Setter Property="BorderThickness" Value="1"/>
        <Setter Property="Background">
          <Setter.Value>
            <RadialGradientBrush >
              <GradientStop Color="{Binding Path=BorderBrush,Converter={StaticResource myColorConverter}, RelativeSource={RelativeSource AncestorType={x:Type Border}}}" Offset="0.9" />
              <GradientStop Color='White' Offset='0.7'/>
              <GradientStop Color='Black' Offset='0.3' />
                     </RadialGradientBrush>
          </Setter.Value>
        </Setter>
      </Style>

    </Grid.Resources>
      <StackPanel x:Name="myStackPanel">
        <Border x:Name="myBorder1" Style="{StaticResource ButtonStyle}" BorderBrush="Yellow" Height="25"></Border>
        <Border x:Name="myBorder2" Style="{StaticResource ButtonStyle}" BorderBrush="Green" Height="25"></Border>
      </StackPanel>
  </Grid> 
```

你需要一个转换器来访问画笔的颜色。

```
 public class ColorConverter : IValueConverter
  {
    public object Convert(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
    {
      if (value is SolidColorBrush)
      {
        var brush = value as SolidColorBrush;
        return brush.Color;
      }
      return null;
    }

    public object ConvertBack(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
    {
      throw new NotImplementedException();
    }
  } 
```

在此示例中，我使用边框的 BorderBrush 作为 RadialGradientBrush 的最外层颜色。您不能在此处使用 Background 属性，因为它会覆盖样式设置的值。更清洁的解决方案是派生您自己的 Border 并为您不同的颜色值创建 DependencyProperties ...**

# javascript - Umbraco-图像未从现有 HTML 标记中显示

> ID：10800837
> 
> 赞同：0
> 
> 时间：2012-05-29T14:07:53.250
> 
> 标签：javascript, jquery, html, css, umbraco

不确定你们中是否有很多人以前使用过基于 .net 的 CMS 的 Umbraco。无论如何，我试图将我在 Dreamweaver 中制作的 HTML/CSS 网站移到 Umbraco。可以在[http://www.innexdesign.co.uk找到实时站点](http://www.innexdesign.co.uk)

无论如何，我已经相当轻松地将这个网站转换为 Umbraco。唯一的问题是主页。如果您查看现有主页[http://www.innexdesign.co.uk/index.html](http://www.innexdesign.co.uk/index.html)，那么您会注意到悬停在它们上方时会变为黑色的翻转文字/图像。当您单击其中任何一个时，会出现一个带有一些信息的灯箱。

在我的 Umbraco 版本中，当我单击任何这些翻转图像时，什么都没有发生。此外，由于某种原因，包含指向外部网站的超链接的翻转图像“设计和构建”不会在 Umbraco 中显示。

我在其他页面中很好地使用了 ligthboxes。例如，进入设计菜单并单击任何酒吧或餐厅，就会出现一个带有信息的灯箱。

这是似乎在 Umbraco 中不起作用的代码：

```
<%@ Master Language="C#" MasterPageFile="~/umbraco/masterpages/default.master" AutoEventWireup="true" %>

<asp:Content ContentPlaceHolderId="ContentPlaceHolderDefault" runat="server">      
<asp:ContentPlaceHolder Id="MasterContentPlaceHolder" runat="server">
</asp:ContentPlaceHolder>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html  lang="en">
<head>

<!--META DATA -->
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta http-equiv="imagetoolbar" content="no" />
<meta name="keywords" content=" Innex Design, design, designers warrington, interior design warrington, cheshire, northwest, manchester, liverpool, pub designers,bar designers, architect, architects, carbon neutral, design manchester, designer in warrington, architect warrington" />
<meta name="description" content=" From a house extension or housing estate, to commercial warehouses’, leisure centres and bars, Innex Design can help develop any idea into a practical, ethical, sustainable reality." />
<meta name="robots" content="index,follow" />

<!-- #BeginEditable "doctitle" -->
<title>Innex Design</title><!--Umbraco Page Field will get inserted here to dynamically change title of page-->

  <!--SCRIPTS AND STYLESHEETS -->
  <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4/jquery.min.js"></script>
  <script type="text/javascript" src="/Scripts/script.js"></script>
  <link rel="stylesheet" type="text/css" href="/Scripts/jquery.fancybox-1.3.4.css" media="screen" />    
 <link rel= "stylesheet" href="/css/style.css" />

  <!--JAVASCRIPT -->
  <script type="text/javascript" src="/Scripts/jquery.mousewheel-3.0.4.pack.js"></script>
  <script type="text/javascript" src="/Scripts/jquery.fancybox-1.3.4.pack.js"></script>
  <script type="text/javascript">
$(document).ready(function() {

      $(".various1").fancybox({
        'titlePosition'    : 'inside',
        'transitionIn'    : 'none',
        'transitionOut'    : 'none'
      });
    });
function MM_swapImgRestore() { //v3.0
  var i,x,a=document.MM_sr; for(i=0;a&&i<a.length&&(x=a[i])&&x.oSrc;i++) x.src=x.oSrc;
}
function MM_preloadImages() { //v3.0
  var d=document; if(d.images){ if(!d.MM_p) d.MM_p=new Array();
    var i,j=d.MM_p.length,a=MM_preloadImages.arguments; for(i=0; i<a.length; i++)
    if (a[i].indexOf("#")!=0){ d.MM_p[j]=new Image; d.MM_p[j++].src=a[i];}}
}

function MM_findObj(n, d) { //v4.01
  var p,i,x;  if(!d) d=document; if((p=n.indexOf("?"))>0&&parent.frames.length) {
    d=parent.frames[n.substring(p+1)].document; n=n.substring(0,p);}
  if(!(x=d[n])&&d.all) x=d.all[n]; for (i=0;!x&&i<d.forms.length;i++) x=d.forms[i][n];
  for(i=0;!x&&d.layers&&i<d.layers.length;i++) x=MM_findObj(n,d.layers[i].document);
  if(!x && d.getElementById) x=d.getElementById(n); return x;
}

function MM_swapImage() { //v3.0
  var i,j=0,x,a=MM_swapImage.arguments; document.MM_sr=new Array; for(i=0;i<(a.length-2);i+=3)
   if ((x=MM_findObj(a[i]))!=null){document.MM_sr[j++]=x; if(!x.oSrc) x.oSrc=x.src; x.src=a[i+2];}
}
    </script>  

  <!--CSS SCRIPT-->
<style type="text/css">
body {
  background-repeat: repeat-x;
}
</style>
</head>

  **<body onload="MM_preloadImages('/media/57/architectureBLACK.png','/media/446/interior-designBLACK.png','/media/732/project-managementBLACK.png','/media/253/cost-managementBLACK.png','/media/714/PlanningBLACK.png','/media/922/SurveyingBLACK.png','/media/333/energy-assessmentsBLACK.png','/media/506/landscape-architectureBLACK.png','/media/288/Design-&amp;-BuildBLACK.png')">**

  <!--DIV HEADER USED IN HOME, PROUILE AND CALLBACK PAGES ONLY-->
<div id="header">
      <div id="headerimgs">
        <div id="headerimg1" class="headerimg"></div>
        <div id="headerimg2" class="headerimg"></div>     
  </div>

<div id="logo">
    <a href="home.aspx" target="_self"><img src="/media/436/innexdesign_logo.jpg" width="143" height="206" alt="Innex Design Logo" /></a>
    </div>

  <div id="social">
    <a href="http://twitter.com/#!/InnexDesign" target="_new"><img src="/media/980/twitter.png" width="41" height="40" alt="Innex Design on Twitter" /></a>
    <a href="http://www.facebook.com/innexdesignltd" target="_new"><img src="/media/351/facebook.png" width="41" height="40" alt="Innex Design on Facebook" /></a>
         <a href="request-a-callback.aspx" title="Request a Callback" target="_new"><img src="/media/192/callback.png" alt="" width="77" height="40" /></a>
    <a href="request-a-callback.aspx" title="Leave Your Details and Sign up to our News Letter" target="_new"><img src="/media/641/Newsletter Image.png" alt="" width="77" height="40" /></a></div>
  </div>

  <!--DIV CONTENT,HOMEMENU ETC ELEMENTS ONLY USED IN HOME,PROFILE AND CALLBACK PAGES-->
<div id="content">
<div id="homeleft">
    <ul class="menu">
    <li class="first"><a href="home.aspx">HOME</a></li>
    <li><a href="profile.aspx">PROFILE</a></li>
    <li><a href="designs.aspx">DESIGNS</a></li>
    <li><a href="testimonials.aspx">TESTIMONIALS</a></li>    
    <li class="last"><a href="contact.aspx">CONTACT</a></li>
    </ul>
    <p style="text-align:center; font-weight:bold;">CELEBRATING<br /><span style="font-size:22px">21</span><br />YEARS<br />1991-2012</p>
    </div>

  <div id="homeright">

<a class="various1" href="#architecture" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Architecture','','images/architectureBLACK.png',1)"><img src="images/architecture.png" alt="Architecture" width="195" height="31" id="Architecture" style="padding:0px 20px;float:left;"/></a>
 <a class="various1" href="#idesign" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('interiordesign','','images/interior-designBLACK.png',1)"><img src="images/interior-design.png" alt="Interior Design" width="195" height="31" id="interiordesign" style="padding:0px 0px 5px 20px; float:right;"/></a>
   <a class="various1" href="#pmanage" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Projman','','images/project-managementBLACK.png',1)"><img src="images/project-management.png" alt="Project Managment" width="195" height="31" id="Projman" style="padding:20px 42px 5px 20px;float:left;"/></a>
<a class="various1" href="#planning" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Planning','','images/PlanningBLACK.png',1)"><img src="images/Planning.png" alt="Planning" width="195" height="31" id="Planning" style="padding:10px 12px 5px 0px;float:right;"/></a>

  <a class="various1" href="#energy" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Energy Assessment','','images/energy-assessmentsBLACK.png',1)"><img src="images/energy-assessments.png" alt="Energy Assessments" width="195" height="31" id="EnergyAssessment" style="padding:0px 42px 0px 20px;float:right;"/></a>
  <a class="various1" href="#surveying" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Surveying','','images/SurveyingBLACK.png',1)"><img src="images/Surveying.png" alt="Surveying" width="195" height="31" id="Surveying" style="padding:10px;float:left;" /></a>
  <a class="various1" href="#cost" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('CostManagement','','images/cost-managementBLACK.png',1)"><img src="images/cost-management.png" alt="Cost Management" width="195" height="31" id="CostManagement" style="padding:0px 12px 0px 20px; float:left;"/></a>
  <a class="various1" href="#land" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('landscape','','images/landscape-architectureBLACK.png',1)"><img src="images/Landscape-Architecture.png" alt="Landscape Architecture" width="195" height="31" id="landscape" style="padding:20px 0px 0px 20px; float:right;" /></a>
      **<div id="various1"> <a href="http://www.innexdevelopments.co.uk" target="_blank"  onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('DesignBuild','','images/Design-&amp;-BuildBLACK.png',1)"><img src="images/Design-&amp;-Build.png" alt="Design &amp; Build" width="195" height="31" id="DesignBuild" style="padding:10px 0 0 0px;float:left;"/></a>
    </div>**

**<div style="display:none"><div id="architecture">
        <img src="/media/52/architecture.png" width="195" height="31" alt="Architecture" />
        <p style="padding:0px 0px 5px 0px; width:500px;">From a house extension or housing estate, to commercial warehouses’, leisure centres and bars, Innex Design can help develop any idea into a practical, ethical, sustainable reality.</p>    
    </div></div>

        <div style="display:none"><div id="idesign">
        <img src="/media/441/interior-design.png" width="195" height="31" alt="Interior Design" />
        <p style="padding:0px 0px 5px 0px; width:500px;">Innex Design’s Interior and brand development designers are experts in spatial design, brand development and awareness, signage and menu design all of which is complimented with the interior design package delivered.</p>    
        </div></div>

        <div style="display:none"><div id="pmanage">
        <img src="/media/727/project-management.png" width="195" height="31" alt="Project Management" />
        <p style="padding:0px 0px 5px 0px; width:500px;">Many of our architectural and interior design developments are project managed ensuring the brief and end aim is delivered on time and on budget. Only with project management can we ensure our clients that the specification and quality is to the highest standard.</p>
        </div></div>

        <div style="display:none"><div id="planning">
          <img src="/media/709/Planning.png" width="195" height="31" alt="Planning" />
        <p style="padding:0px 0px 5px 0px; width:500px;">Innex Design undertake all planning application submissions from residential, commercial, listed and conservation area consents, national park along with Display of Advertisement applications. We also work with planning consultants to add value for developers and lenders by assessing land and building use potential.</p>
        </div></div>

         <div style="display:none"><div id="surveying">
           <img src="/media/917/Surveying.png" width="195" height="31" alt="Surveying" />
        <p style="padding:0px 0px 5px 0px; width:500px;">Innex Design can provide a wide variety of surveys from measured and condition surveys of buildings, Topographical surveys, Structural surveys, Party Wall surveys, and provide assistance with Asbestos surveys, Land/Probate surveys, certification and many more.</p>
        </div></div>

        <div style="display:none"><div id="energy">
        <img src="/media/328/energy-assessments.png" width="195" height="31" alt="Energy Assessments" />
        <p style="padding:0px 0px 5px 0px; width:500px;">Innex Design can assist with providing full building services design and energy consultancy, and through one of our partners BREEAM assessment, Commercial EPC, Domestic EPC, Display energy certificates, New Build SAP or SBEM reports and Sustainability statements.</p>
        </div></div>

         <div style="display:none"><div id="cost">
           <img src="/media/248/cost-management.png" width="195" height="31" alt="Cost Management" />
        <p style="padding:0px 0px 5px 0px; width:500px;">Innex Design offer all clients a comprehensive service that removes the burden of day to day costs-related issues.</p>
        </div></div>

        <div style="display:none"><div id="land">
          <img src="/media/501/Landscape-Architecture.png" width="195" height="31" alt="Landscape Architecture" />
        <p style="padding:0px 0px 5px 0px; width:500px;">We undertake all aspects of landscape architecture, from landscape master planning, conceptual design through to detailed planting schemes. We adopt a fresh approach to the design of each project where a high degree of design flair and innovation comes as standard. </p>
        </div></div>

         <div style="display:none"><div id="build">
           <img src="/media/283/Design-&amp;-Build.png" width="195" height="31" alt="Design &amp; Build" />
        <p style="padding:0px 0px 5px 0px; width:500px;">In today’s industry and marketplace some clients prefer a one point of contact approach to projects, with this in mind we have developed a nationwide network of partnering contractors to enable clients to have the one point contact, whilst ensuring delivery of excellent quality and standards of workmanship.</p>
        </div></div>**
  </div>
</div><!-- end content -->
</div><!-- end wrapper -->

        <div id="logosother">
          <div class="logos"><a href="http://www.altiusva.com/ " target="_blank"><img src="/media/47/altius-logo.jpg" width="132" height="52" alt="Altius Logo" /></a> <a href="http://www.chas.gov.uk " target="_blank"><img src="/media/208/chas-logo.jpg" width="48" height="52" alt="Chas Logo" /></a> <a href="http://www.constructionline.co.uk/static/" target="_blank"><img src="/media/238/Construction line.jpg" width="48" height="52" alt="Construction Line" longdesc="http://www.constructionline.co.uk/static/" /></a> <a href="http://www.eurosafeuk.co.uk/ " target="_blank"><img src="/media/341/Eurosafe.jpg" width="48" height="52" alt="Eurosafe" longdesc="http://www.eurosafeuk.co.uk/ " /></a> <a href="http://bii.bii.org/home" target="_blank"><img src="/media/112/BII.jpg" alt="BII" width="48" height="52" longdesc="http://bii.bii.org/home" /></a> <a href="http://committedtoequality.co.uk" target="_blank"><img src="/media/233/commitedtoequality.jpg" width="43" height="50" alt="Commited To Equality" longdesc="http://committedtoequality.co.uk" /></a></div>
          <div class="carbon"><a href="/media/200/Carbon Managment Plan.pdf" target="_new"><img src="/media/203/carbon-logo.jpg" width="149" height="85" alt="Carbon Neutral Logo" /></a></div>
</div>
<div id="footer">
  <p style="float:left">Copyright &copy; 2012 - Innex Design       </p>
    <p style="float: left"><a href="/media/724/privacy policy.pdf" target="_new">Privacy Policy</a></p>
    <p style="float: left"><a href="/media/927/Sustainability Policy.pdf" target="_new">Sustainability Policy</a></p>
    <p style="float: left"><a href="/media/338/Equal Ops Policy.pdf" target="_new">Equal Opportunities Policy</a></p>
<p style="float:right">Designed by <a href="http://www.swan-solutions.com" target="_blank" title="Swan Solutions"><img src="/media/950/swan-solutions.jpg" alt="Swan Solutions" width="100" height="20" align="middle" /></a></p>
</div>
<script type="text/javascript">

  var _gaq = _gaq || [];

  _gaq.push(['_setAccount', 'UA-25186334-1']);

  _gaq.push(['_trackPageview']);

  (function() {

    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;

    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';

    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);

  })();

</script>
</body>
</html>

</asp:Content 
```

>

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T14:37:01.677

要检查的一件事是确保所有图像的相对 URL 在开头都有一个正斜杠，例如 /images/architecture.png - 这将确保它从根图像文件夹中获取图像，而不是试图找到它相对于这页纸。

此外，检查您的 CSS 和/或 javascript 是否有任何对图像的引用，并确保它们在开头也有一个正斜杠。

# mysql - SQL insert only table, how to select only newest entries

> ID：10800838
> 
> 赞同：1
> 
> 时间：2012-05-29T14:07:53.737
> 
> 标签：mysql, sql

I've created an insert only table for the purpose of speed and maintaining a history. It's structure is very generic, and is as follows:

```
 `id` bigint(20) unsigned NOT NULL auto_increment,
  `user_id` bigint(20) unsigned NOT NULL,
  `property` varchar(32) NOT NULL,
  `value` longblob NOT NULL,
  PRIMARY KEY  (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=latin1; 
```

It's simply a key/value table with a user_id assigned to it. This approach has its advantages as not all users have the same properties, so fields aren't wasted in a table. Also, it allows for a rolling log of changes, since I can see every change to a particular property ever made by a user.

Now, since no deletes or updates ever occur in this table, I can assume that the greatest id will always be the newest entry.

However, I want to select multiple properties at once, for example 'address1', 'address2', 'city', 'state', and I want each to be the entry of it's type with the highest id.

So, if they have changed their 'state' property 8 times, and 'city' property 4 times, then I'd only want a SELECT to return the latest of each (1 state and 1 city).

I'm not sure this can even be done efficiently with this type of a table, so I'm open to different table approaches.

Please, let me know if I need to produce anymore information or clarify my question better.

=== I tried the following, but, there could be 3 rows of 'address1' changes after the last 'address2' change. Perhaps using a GROUP BY will work?

`SELECT property, value FROM kvtable WHERE user_id = 1 AND (property = 'address1' OR property = 'address2') ORDER BY id`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-29T14:11:05.770

假设您的 id 是增量整数*并且您没有手动指定它们乱序*，您可以在子查询中使用一些`MAX()`聚合来执行此操作。子查询的重点是为每个用户返回每个属性名称的最新条目。这与整个表相结合，以提取相关的属性值。本质上，子查询丢弃每组没有 max(id) 的所有行。

```
SELECT kvtable.* 
FROM
  kvtable
  JOIN (
    SELECT
      MAX(id) AS id,
      user_id,
      property
    FROM kvtable
    /* optionally limit by user_id */
    WHERE user_id = <someuser>
    GROUP BY user_id, property
  ) maxids ON kvtable.id = maxids.id 
```

# sql - 如何在此示例中使用相交（可能还有减号）

> ID：10800842
> 
> 赞同：0
> 
> 时间：2012-05-29T14:08:04.937
> 
> 标签：sql, oracle, intersect

假设我有两张桌子：

```
TableA
ID,    Time,   Size

0      5:00    600
1      8:00    800
2      7:00    100
3      1:50    140
4      2:40    300 
12     3:40    300

TableB
ID,    Time,   Size

8      5:00    600
1      8:00    800
2      8:00    900
3      1:50    140
5      2:40    300 
12     3:40    300 
```

现在我想比较这两个表：给出表 A 和 B 中 ID 相同的所有行（或者让我们说两个表中存在 ID 的位置）但低于 12 - 这样就会踢出表 A`ID 0, 4, 12`并从表 B`ID 8, 5, 12`

之后，我将只剩下 3 行。现在我想踢出整个 TableA 行 ID == TableB 行 ID 之间存在一个或多个差异的所有行

最后会有（如果我认为正确的话）作为输出：

```
ID,    Time,   Size
1      8:00    800
3      1:50    140 
```

对于这个解决方案，我需要确定相交并且可能是负数。起初我认为这个 SQL 语句会做我想做的事：

```
select * from TableA where ID < 12 intersect select * from TableB where ID < 12 
minus 
select * from TableB where ID < 12; 
```

But this is not working that well. Ist because of the intersect, Im using intersect for the whole row, I should use intersect for only the IDs and IF I have the intersect of the IDs (that would be 1,2,3) then I have to use ID `TableA with ID 1,2,3` **minus** `TableB with ID 1,2,3`. But how? Or do I miss something? Any ideas? Thank you

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T14:15:09.880

From your requirements and the testdata you've provided, you don't need intersect at all. A mere `INNER JOIN` would suffice.

```
SELECT a.* 
FROM   TableA a 
       INNER JOIN TableB b ON b.ID = a.ID AND b.Time = a.Time AND b.Size = a.Size 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T14:14:21.980

```
select id from TableA where ID < 12 and id in (Select id from TableB)
union 
select id from TableB where ID < 12   and id in (Select id from TableA) 
```

or

```
SELECT id, 
       time, 
       size 
FROM   (SELECT * 
        FROM   tablea 
        WHERE  id < 12 
        UNION ALL
        SELECT * 
        FROM   tableb 
        WHERE  id < 12) a 
GROUP  BY id, 
          time, 
          size 
HAVING Count(*) = 2 
```

or

```
SELECT * 
FROM   tablea A 
WHERE  EXISTS (SELECT 1 
               FROM   tableb b 
               WHERE  b.id = a.id 
                      AND b.time = a.time 
                      AND b.size = a.size) 
```

# c# - How do I remove a GUI object(s) in unity C#?

> ID：10800843
> 
> 赞同：1
> 
> 时间：2012-05-29T14:08:16.870
> 
> 标签：c#, user-interface, unity3d

I have a controllable character that when you fall off map, a GUI will be created with a respawn button

```
 void OnGUI() {
        if(died==true){
        GUI.Label(new Rect(daX, daY, 200, 40), "You died!!");
        GUI.Label(new Rect(daX, daY-40, 200, 40), whyDie);
        if (GUI.Button(new Rect(daX-75, daY+50, 150, 30), "Respawn!!!")){
            transform.position = new Vector3(-5,20,5);
        }
        if (GUI.Button(new Rect(daX-75, daY+100, 150, 30), "Screw This!!!")){
            Debug.Log("Back to menu");
        }
    }
 } 
```

The respawn and stuff works, is just that I don't know how to get rid of the GUI, so the respawn button stays there after you respawned. Does anyone know how to remove GUI objects? Thanks in advance

*EDIT: died, daX, daY, whyDie are variables I created and are valid

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T14:28:44.420

Just set your died variable back to false, and the GUI calls wont be made.

```
void OnGUI()
{
   if(died)
   {
        GUI.Label(new Rect(daX, daY, 200, 40), "You died!!");
        GUI.Label(new Rect(daX, daY-40, 200, 40), whyDie);

        if (GUI.Button(new Rect(daX-75, daY+50, 150, 30), "Respawn!!!"))
        {
            transform.position = new Vector3(-5,20,5);
            died = false; //Stop drawing died interface
        }

        if (GUI.Button(new Rect(daX-75, daY+100, 150, 30), "Screw This!!!"))
        {
            Debug.Log("Back to menu");
            Application.LoadLevel(0); //Load your first scene, where the menu is.
        }
    }
 } 
```

Alternatively, you could disable the component/gameobject. That way your whole OnGUI method wont be called anymore.

# extjs4 - Extjs 4 portlet on load collapsed not working properly

> ID：10800845
> 
> 赞同：0
> 
> 时间：2012-05-29T14:08:33.187
> 
> 标签：extjs4

I am using ExtJS portal code in my application

I want to make portlet in collapsed state at the time of loading the page. So I have done something like

```
items: [{
                            id: 'portlet-1',
                            title: 'Grid Portlet Texsds',
                            tools: this.getTools(),
                            height:200,
                            **collapsed:true,**
                            autoScroll :true,
                            items: Ext.create('Ext.app.GridPortlet'),
                            listeners: {
                                'close': Ext.bind(this.onPortletClose, this),
                                'endDrag': Ext.bind(this.onPortletDrag, this),
                                'resize' :Ext.bind(this.onPortletResize, this)
                            }
                        } 
```

I have made collapsed property to true. But because of this when I am trying to expand the portlet [after page load] I can see blank Grid.Plz. refer the attached image.

What is the problem ? do I need to do refresh or something ? because when I set collapsed to false I can see the grid.

Please suggest what is missing here.![enter image description here](../Images/81e62d96643146c2a5e7f4d14f1775a6.png)

This is a code for the getTools: function(){

```
{
            type: 'Minimize',
            handler: function(e,target,panelHeader,tool){
                //panelHeader.ownerCt.toggleCollapse();
                if (panelHeader.ownerCt.collapsed)
                {
                    panelHeader.ownerCt.expand();

                }
                else {
                    panelHeader.ownerCt.collapse();
                }
            }
        } 
```

for the first time when the portlet get load it is in collapsed state, Now when I click on cross icon not [the "^" for expand icons ] I can see the Blank grid.

Hope this time I am able to explain well.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T14:22:35.173

我采用 Ext JS 4 示例门户应用程序并将您的代码（不带星号）添加到 portlet-1。它在加载时正确折叠并展开以显示网格。

我认为您发布的代码没有任何问题。也许您更改了周围容器的布局或布局属性，这会影响您的 portlet。

这是我完整的portal.js：

```
Ext.define('Ext.app.Portal', {

    extend: 'Ext.container.Viewport',
    //requires: [ 'Ext.diag.layout.ContextItem', 'Ext.diag.layout.Context' ],
    uses: ['Ext.app.PortalPanel', 'Ext.app.PortalColumn', 'Ext.app.GridPortlet', 'Ext.app.ChartPortlet'],

    getTools: function(){
        return [{
            xtype: 'tool',
            type: 'gear',
            handler: function(e, target, panelHeader, tool){
                var portlet = panelHeader.ownerCt;
                portlet.setLoading('Loading...');
                Ext.defer(function() {
                    portlet.setLoading(false);
                }, 2000);
            }
        }];
    },

    initComponent: function(){
        var content = '<div class="portlet-content">'+Ext.example.shortBogusMarkup+'</div>';

        Ext.apply(this, {
            id: 'app-viewport',
            layout: {
                type: 'border',
                padding: '0 5 5 5' // pad the layout from the window edges
            },
            items: [{
                id: 'app-header',
                xtype: 'box',
                region: 'north',
                height: 40,
                html: 'Ext Portal'
            },{
                xtype: 'container',
                region: 'center',
                layout: 'border',
                items: [{
                    id: 'app-options',
                    title: 'Options',
                    region: 'west',
                    animCollapse: true,
                    width: 200,
                    minWidth: 150,
                    maxWidth: 400,
                    split: true,
                    collapsible: true,
                    layout:{
                        type: 'accordion',
                        animate: true
                    },
                    items: [{
                        html: content,
                        title:'Navigation',
                        autoScroll: true,
                        border: false,
                        iconCls: 'nav'
                    },{
                        title:'Settings',
                        html: content,
                        border: false,
                        autoScroll: true,
                        iconCls: 'settings'
                    }]
                },{
                    id: 'app-portal',
                    xtype: 'portalpanel',
                    region: 'center',
                    items: [{
                        id: 'col-1',
                        items: [{
                            id: 'portlet-1',
                            title: 'Grid Portlet',
                            tools: this.getTools(),
                            collapsed: true,
                            height: 200,
                            autoscroll: true,
                            items: Ext.create('Ext.app.GridPortlet'),
                            listeners: {
                                'close': Ext.bind(this.onPortletClose, this)
                            }
                        },{
                            id: 'portlet-2',
                            title: 'Portlet 2',
                            tools: this.getTools(),
                            html: content,
                            listeners: {
                                'close': Ext.bind(this.onPortletClose, this)
                            }
                        }]
                    },{
                        id: 'col-2',
                        items: [{
                            id: 'portlet-3',
                            title: 'Portlet 3',
                            tools: this.getTools(),
                            html: '<div class="portlet-content">'+Ext.example.bogusMarkup+'</div>',
                            listeners: {
                                'close': Ext.bind(this.onPortletClose, this)
                            }
                        }]
                    },{
                        id: 'col-3',
                        items: [{
                            id: 'portlet-4',
                            title: 'Stock Portlet',
                            tools: this.getTools(),
                            items: Ext.create('Ext.app.ChartPortlet'),
                            listeners: {
                                'close': Ext.bind(this.onPortletClose, this)
                            }
                        }]
                    }]
                }]
            }]
        });
        this.callParent(arguments);
    },

    onPortletClose: function(portlet) {
        this.showMsg('"' + portlet.title + '" was removed');
    },

    showMsg: function(msg) {
        var el = Ext.get('app-msg'),
            msgId = Ext.id();

        this.msgId = msgId;
        el.update(msg).show();

        Ext.defer(this.clearMsg, 3000, this, [msgId]);
    },

    clearMsg: function(msgId) {
        if (msgId === this.msgId) {
            Ext.get('app-msg').hide();
        }
    }
}); 
```

# jquery - Create url on the fly

> ID：10800847
> 
> 赞同：0
> 
> 时间：2012-05-29T14:08:44.417
> 
> 标签：jquery

I have some pages with a p tag

```
Page 1:     <p id="cat-one"></p>

Page 2:    <p id="cat-two"></p>

Page 3:   <p id="cat-one"></p> 
```

and so on.

I have to first examine the para in the page and create a url dynamically and insert it into the para, depending on which category it belongs to.

```
Eg: cat-one
url  <a href="http://sdsdsad.com" target="_blank" />

cat-two
url  <a href="http://vbccvbcv.com" target="_blank" />

cat-three
url  <a href="http://ohgdssas.com" target="_blank" /> 
```

and so on.

This is what I have done

```
 var newLink = $('<a href="sdfdsfsdf.html" target="_blank"'>SomeText</a>');
    $("#cat-one").append(newLink); 
```

however no idea who to check each para in an article and dynamically generate url;s

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T14:21:08.213

您的意思是一个 html 文档中有 600 个 html 页面或 600 个页面元素？如果是第二个 - 那么你可以这样做 - [http://jsfiddle.net/shershen08/MeF4t/8/](http://jsfiddle.net/shershen08/MeF4t/8/)

# java - 如何使用java创建每30秒运行一次的线程？

> ID：10800848
> 
> 赞同：-3
> 
> 时间：2012-05-29T14:08:45.340
> 
> 标签：java, mysql, multithreading

我想在java中创建一个应该每30秒运行一次的线程，并且应该在mySQL中删除数据库中的特定记录。提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T14:14:57.913

出于同样的原因，我只是做了类似的事情，这是我的代码：

```
package com.xxx.thread;

public class Updater implements Runnable{

    @Override
    public void run() {

        while(true) {
            try {
                //do work here
                Thread.sleep(1000*60*60); //sleep time in ms
            } catch (InterruptedException ex) {
            }
        }
    }

} 
```

要启动线程：

```
 Thread myThread = new Thread(new Updater());
 myThread.start(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-29T14:17:28.453

需要一些代码示例？

```
public void schedule(){
    Timer timer = new Timer();
    timer.schedule(new TimerTask() {
        @Override
        public void run() {
            //TODO write your code
        }
    }, 1000,1000*30);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-29T15:17:55.897

我不同意接受的答案。`Thread.sleep`可能是解决问题的最糟糕方法，因为它不准确且混乱（需要循环 + 调用`sleep`+ 取消机制）。最可接受的方法是使用[ScheduledThreadPoolExecutor](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/concurrent/ScheduledThreadPoolExecutor.html)：

```
ScheduledThreadPoolExecutor exec = new ScheduledThreadPoolExecutor(1);
exec.submit(new Runnable() {
      public void run() {
          // update db here
      }
   }, 0, 30, TimeUnit.SECONDS); 
```

# android - start android app with valgrind

> ID：10800856
> 
> 赞同：3
> 
> 时间：2012-05-29T14:09:04.417
> 
> 标签：android, valgrind

I am trying to start an android app from valgrind on Android Phone from adb. I have already installed valgrind on android phone.

What are the steps that i need to follow to start an android app from valgrind on Android Phone from adb.

Thanks in advance!

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2013-04-10T09:17:30.987

检查这个：[如何使用 valgrind 启动一个 android 应用程序](https://stackoverflow.com/questions/9123124/how-to-start-an-android-app-with-valgrind)

它适用于我的 Android 4.0 设备。这需要您使用 adb shell 输入一些命令。

# c# - AES decryption, IV length

> ID：10800857
> 
> 赞同：2
> 
> 时间：2012-05-29T14:09:06.150
> 
> 标签：c#, encryption, aes

I'm trying to decrypt a string, but I'm getting the

*Specified initialization vector (IV) does not match the block size for this algorithm.*

I've been searching SO and the web for a while and I understand my IV is 32 bytes and should be 16 bytes, but I can't figure out how to achieve it. The string to get has been encrypted using AES/CBC/PKCS5Padding and my code (well, actually I've found it somewhere in the web) is

```
var btKey = Encoding.ASCII.GetBytes("7c6e1257d0e81ff55bda80cc904365ae");
var btIV = Encoding.ASCII.GetBytes("cf5e4620455cd7190fcb53ede874f1a8");

aesAlg.Key = btKey;
aesAlg.IV = btIV;

aesAlg.Padding = PaddingMode.PKCS7;

// Create a decrytor to perform the stream transform.
var decryptor = aesAlg.CreateDecryptor(aesAlg.Key, aesAlg.IV);

// Create the streams used for decryption.
using (MemoryStream msDecrypt = new MemoryStream(encodedTicketAsBytes))
  {
    using (CryptoStream csDecrypt = new CryptoStream(msDecrypt, decryptor, CryptoStreamMode.Read)){
      using (StreamReader srDecrypt = new StreamReader(csDecrypt))
      {
        // Read the decrypted bytes from the decrypting stream
        // and place them in a string.
        plainText = srDecrypt.ReadToEnd();
      }
    }
  } 
```

What I don't understand is the use of the aesAlg.Padding, to be honest I couldn't find yet an easy, to my understanding, example of this in C#.

Any help?,

Thanks!!

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-29T14:13:15.137

您拥有的密钥几乎可以肯定是一堆十六进制值，而不是 ascii 字符。你正在做：

```
var btIV = Encoding.ASCII.GetBytes("cf5e4620455cd7190fcb53ede874f1a8"); 
```

它将它视为任何其他字符串并将其转换为其二进制 ascii 字节。对我来说，这些看起来像十六进制数字。每 2 个字符是一个单字节值。你可能想要类似的东西

```
var btIV = new byte[] {0xcf,0x5e,0x46,0x20,0x45,0x5c,0xd7,0x19,0x0f,0xcb,0x53,0xed,0xe8,0x74,0xf1,0xa8}; 
```

# android - android 使用 facebook 授权

> ID：10800859
> 
> 赞同：0
> 
> 时间：2012-05-29T14:09:05.963
> 
> 标签：android, facebook

我正在尝试使用 facebook 授权我的移动应用程序，但是当 facebook 授权窗口关闭时，它不会返回到我的应用程序的 continueLoading(1) 方法.. 不明白为什么：

```
private void authorizeFacebook(final Loader loader) {       
    String[] permissions = new String[] {"friends_status", "user_status"};
    facebook.authorize(this, permissions , new DialogListener() {
        @Override
        public void onComplete(Bundle values) {
            Log.e("finish", "oncomplete");
            //SharedPreferences.Editor editor = mPrefs.edit();
            //editor.putString("access_token", facebook.getAccessToken());
            //editor.putLong("access_expires", facebook.getAccessExpires());
            //editor.commit();                
            loader.continueLoading(1);
        }

        @Override
        public void onFacebookError(FacebookError error) { 
            Log.i("FacebookAuthorize", error.toString());               
            app.alert("Facebook Connection Error", "Please try to re-open the application", "Ok", loader);      
        }

        @Override
        public void onError(DialogError e) { 
            Log.i("FacebookAuthorize", e.toString());               
            app.alert("Facebook Connection Error", "Please try to re-open the application", "Ok", loader);
        }

        @Override
        public void onCancel() {
            Log.i("FacebookAuthorize", "onCancel");
            app.alert("Facebook Connection Error", "Please try to re-open the application", "Ok", loader);
        }
    });

}

    @Override
public void onActivityResult(int requestCode, int resultCode, Intent data) {
    super.onActivityResult(requestCode, resultCode, data);
    facebook.authorizeCallback(requestCode, resultCode, data);
} 
```

loader的第一步：

```
 private void continueLoading(int step) {     
    switch(step)
    {
            //loading current user facebook profile
    case 1: progressBar.incrementProgressBy(750);               
            loadingStatus.setText("Getting user's facebook details");                               
            facebookRunner = new AsyncFacebookRunner(facebook);         
            facebookConnection = new FacebookConnection(this, 1);
            facebookRunner.request("me",facebookConnection);   
            app.setFacebook(facebook);
            app.setFacebookRunner(facebookRunner);
            break; 
```

而不是回到我的应用程序，它只是关闭了所有东西..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T14:40:05.417

facebook android sdk 有两种不同的身份验证流程：

1) SSO - 如果用户在同一设备上安装了 facebook 应用程序，将使用 SSO。如果是这种情况，那么您正在使用的 facebook sdk 将对 facebook 应用程序启动一个新意图，以针对您的应用程序对用户进行身份验证。为了能够知道何时完成，您需要添加以下内容：

```
@Override
public void onActivityResult(int requestCode, int resultCode, Intent data) {
    super.onActivityResult(requestCode, resultCode, data);
    facebook.authorizeCallback(requestCode, resultCode, data);
} 
```

2) 如果设备没有安装 facebook 应用程序，那么 SDK 将打开它自己的用户身份验证对话框，在这种情况下，将使用`DialogListener`您传递给该`authorize`方法的实现。

您需要同时拥有 (`DialogListener`和`onActivityResult`) 来处理这两种情况。

# mysql - mysql: Using sort_union(sourceClass,destinationClass); in the EXPLAIN plan

> ID：10800862
> 
> 赞同：0
> 
> 时间：2012-05-29T14:09:19.123
> 
> 标签：mysql, performance

Recently when I come across some slow queries, I have seen this "Using sort_union(sourceClass,destinationClass)" phrase in the EXPLAIN plan.

When I run the EXPLAIN with the same query with FORCE INDEX of each index separately, I saw it is doing almost the full table scan due to data distribution.

I understood that this is to improve the performance and this decision is taken by the query optimizer only.

In my query the keys and query are like this

```
sourceClass:      KEY (`sourceClass`,`sourceId`,`kind`)
destinationClass: KEY (`destinationClass`,`destinationId`,`kind`),

query: 
WHERE (sourceClass='channel' && sourceId=1016) ||  (destinationClass='channel' 
&& destinationId=1016) 
```

I would like to know at what when the optimizer comes to choose this and are there any disadvantages due to this kind of finding results ?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T14:16:10.660

您可以从查询优化器中得到所有期望，它是一种尽力而为的方法，因此它不一定会找到最佳解决方案，而是它可以在特定时间段内找到的最佳解决方案。如果你想改进这一点，你需要创建一个索引来改进你的查询或改变你的数据库的设计，查询优化器会看到它，它会选择它作为一个更好的查询计划。

# windows-phone-7 - Simulate Hardware button click

> ID：10800864
> 
> 赞同：0
> 
> 时间：2012-05-29T14:09:26.040
> 
> 标签：windows-phone-7, button, hardware, device

How can I simulate Hardware button (Back, Home, Search) click using Expensify test framework, on Real device connected to USB port on my system. Can you please guide changes required (if any) to acheive this..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T14:27:58.820

如果不使用机器人技术，我不相信这可以在今天的真实硬件上完成。

我已经与美国 Microsoft DPE 团队的一些人讨论了未来的支持，但在这方面没有任何进展。

但是，这可以通过以下步骤在模拟器上轻松完成：

```
 Then I press a hardware button "PhoneHardwareButton" 
```

其中 PhoneHardwareButton 枚举是值之一：

```
 Back,
    Home,
    Search,
    Camera,
    VolumeUp,
    VolumeDown,
    Power,
    Menu 
```

来自[https://github.com/Expensify/WindowsPhoneTestFramework/blob/master/Server/Core/Tangibles/PhoneHardwareButton.cs](https://github.com/Expensify/WindowsPhoneTestFramework/blob/master/Server/Core/Tangibles/PhoneHardwareButton.cs)

# jquery - Kendo Grid JSON Not Consistant

> ID：10800869
> 
> 赞同：0
> 
> 时间：2012-05-29T14:09:35.620
> 
> 标签：jquery, json, kendo-ui

I have json returning from an API that is not consistant, meaning some records have "age" associated with them while others do not.

I am trying to populate a Kendo UI Grid in order to display/manipulate the data. Unfortunately, when the records that do not have "Age" associated with them return with records that do, kendo breaks down with an error: **Uncaught ReferenceError: Age is not defined**

Here is the example of the working grid: [http://jsfiddle.net/tmort/CVkpF/](http://jsfiddle.net/tmort/CVkpF/)

And here is the grid with one record returning without "Age": [http://jsfiddle.net/tmort/CVkpF/1/](http://jsfiddle.net/tmort/CVkpF/1/) - You can see the error appear in the Console, not on the page itself.

Is there any way I can make the grid dynamic enough to understand that age hasn't returned, set it to null, and then continue on?

Code I'm using:

```
 var data = [
    {
    FirstName: 'John',
    LastName: 'Doe',
    City: 'New York City',
    Title: 'Supervisor',
    BirthDate: '1/1/1975',
    Age: '37',
    },
    {
    FirstName: 'Jane',
    LastName: 'Doe',
    City: 'Buffalo',
    Title: 'Sales Associate',
    BirthDate: '1/1/1980',

    }
    ]
$(document).ready(function() {
        var grid = $("#grid").kendoGrid({
            dataSource: {
                data: data,
                schema: {
                    model: {
                        fields: {
                            FirstName: { type: "string" },
                            LastName: { type: "string" },
                            City: { type: "string" },
                            Title: { type: "string" },
                            BirthDate: { type: "date" },
                            Age: { type: "number" }
                        }
                    }
                },
                pageSize: 10
            },
            height: 500,
            scrollable: true,
            sortable: true,
            selectable: true,
            filterable: true,
            pageable: true,
            columns: [
                {
                    field: "FirstName",
                    title: "First Name"
                },
                {
                    field: "LastName",
                    title: "Last Name"
                },
                {
                    field: "City"
                },
                {
                    field: "Title"
                },
                {
                    field: "BirthDate",
                    title: "Birth Date",
                    template: '#= kendo.toString(BirthDate,"MM/dd/yyyy") #'
                },
                {
                    field: "Age"
                }
            ]
        }).data("kendoGrid");

    }); 
```

​Any help greatly appreciated. Thanks!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T18:34:55.660

剑道网格不支持缺失值。您的对象必须包含每行的每个成员才能将其绑定到网格。空白/空值应该就是这样 - 空字符串或空值，但它们必须存在于您的 JSON 结果中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T14:22:31.427

我不确定剑道网格是否那么灵活，但是您可以做的是在将数据源放入网格之前对其进行处理。您可以将年龄添加为数据源中的字段或根据存在的 hte 字段设置网格。如果您在源上执行 CRUD 操作，这可能效果不佳，但如果它只是显示数据，这可能对您很有效。

其他人可能对剑道框架有更好的了解，这只是一个快速解决方法的建议！

希望能帮助到你！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-14T00:00:48.353

为什么不尝试将缺少的字段（年龄）发送为空。如果您从控制器获取数据，您可以添加一个额外的字段并将其发送到 UI。这将使事情以适当的方式工作。只是我的观点...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-12-08T16:04:32.807

为您的列添加带有 data.field 的模板将起作用，即。

```
 ...
       columns: [
            {
                field: "FirstName",
                title: "First Name",
                template: "#= data.FirstName != null ? FirstName : '' #"
            },
            {
                field: "LastName",
                title: "Last Name",
                template: "#= data.LastName != null ? LastName : '' #"
            },
            {
                field: "City",
                template: "#= data.City != null ? City : '' #"
            },
            {
                field: "Title",
                template: "#= data.Title != null ? Title : '' #"
            },
            {
                field: "BirthDate",
                title: "Birth Date",
                template: '#= data.BirthDate != null ? kendo.toString(BirthDate,"MM/dd/yyyy") : "" #'
            },
            {
                field: "Age",
                template: "#= data.Age != null ? Age : '' #"
            }
        ]
        ... 
```

# mongodb - mongodb index query

> ID：10800870
> 
> 赞同：0
> 
> 时间：2012-05-29T14:09:35.650
> 
> 标签：mongodb

If I have a collection which I query based on fields _id and CreationTimestamp.O as below:

```
var _query = Query.And(
 Query.EQ("_id", "TheId"),
    Query.GT("CreationTimestamp.0", DateTimeOffset.UtcNow.AddMinutes(-15).UtcTicks)); 
```

Should I create a compound index on both these fields? I know _id by default has an index.

I am looking for guidance on best practice i.e. Create a compound index for both fields or just create an index for CreationTimestamp.O as their is already an index on _id

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T14:23:15.337

在这里创建复合索引没有太多好处。由于字段上自动创建的索引的选择性`_id`是 1（它是唯一索引），因此没有理由将任何复合索引作为前缀。唯一可能的好处可能是 MongoDB 可以为此查询使用[覆盖索引并可能加快处理速度（您需要对数据进行基准测试以证明这一点）。](http://www.mongodb.org/display/DOCS/Retrieving+a+Subset+of+Fields#RetrievingaSubsetofFields-CoveredIndexes)

# php - How do I reverse escapeshellarg?

> ID：10800874
> 
> 赞同：3
> 
> 时间：2012-05-29T14:09:49.203
> 
> 标签：php, escaping

Well, header says it all.
in php, how do I reverse [escapeshellarg](http://php.net/escapeshellarg)()? To be more precise, what is the built-in function (if there is one) that will reverse it.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-29T14:15:21.033

最彻底的路线是找出[escapeshellarg() 的确切作用](http://lxr.php.net/opengrok/xref/PHP_5_3/ext/standard/exec.c#php_escape_shell_arg)并做相反的事情。在 linux 环境中，看起来它只是在处理单引号。在 Windows 环境中，它做得更多。您的反向功能也应该考虑到这一点。

关于内置函数：简短的回答是“没有”。长答案是：没有一个，因为转义的 shell 参数从来没有打算被 PHP 解析（为什么首先要转义它们？）所以没有人写过一个并将它作为一个补丁提交给 PHP。如果您将参数传递给 CLI PHP 应用程序，则不需要取消转义，因为解释器已经完成了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-29T15:27:47.950

用例：
创建命令时，所有参数都必须正确转义。但是当`PS`用于查找该命令是否正在执行时，引号将被删除。所以比较难。如果唯一要检查的程序是由php启动的程序，保存`PID`是可以的，但是如果我们必须考虑从其他方式启动的进程，那就更难了

# asp.net - 是否可以基于主题加载 JavaScript？

> ID：10800878
> 
> 赞同：1
> 
> 时间：2012-05-29T14:09:51.130
> 
> 标签：asp.net, kentico, app-themes

我正在为有 3 个可用主题的客户开发一个网站。我正在使用 app_themes 系统使用户能够更改样式。每个主题使用几个不同的 JavaScript 文件来加载自定义字体。根据所选主题加载这些 JavaScript 文件的最佳方法是什么？

据我所知，Kentico 使用与默认 ASP.net 网络表单相同的应用程序主题系统。

理想情况下，我希望能够将适当的 JavaScript 文件添加到相应的 App_Theme 文件夹，并让 ASP 将标签添加到文档头。如果这不是一个选项，我考虑编写一个 ScriptLoader JavaScript，它将检查样式表标签以确定正在使用的主题。如果我可以将主题名称作为类属性添加到 body 元素上，然后查看并引入适当的脚本，那就更好了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T18:31:37.117

如果您不使用 Kentico，我想我找到了一个涉及制作 webPart 或控件的解决方案。

```
 public static void AddScriptToHead(HtmlHead h, string script, bool AddScriptTags)
{
    Literal l = new Literal();

    if (AddScriptTags)
        l.Text = "<script type=\"text/javascript\" src=\""
                + script +
                "\"></script>";
    else
        l.Text = script;
    h.Controls.Add(l);
}

protected void SetupControl()
{
    if (this.StopProcessing)
    {
        // Do nothing
    }
    else
    {
        string theme = Page.Theme;

        if (theme != null)
        {

            if (theme.Equals("Card"))
            {
                AddScriptToHead(Page.Header, "~/App_Themes/Cardamon/js/cufon-colors-classic.js", true);
                AddScriptToHead(Page.Header, "~/App_Themes/Cardamon/js/Charis_SIL_700.font.js", true);
            }
            else if (theme.Equals("CardamonWave"))
            {
                AddScriptToHead(Page.Header, "~/App_Themes/Cardamon/js/cufon-colors-wave.js" ,true);
                AddScriptToHead(Page.Header,  "~/App_Themes/Cardamon/js/Lobster_14_400.font.js",true);
            }
            else if (theme.Equals("CardamonAncient"))
            {
                AddScriptToHead(Page.Header, "~/App_Themes/Cardamon/js/cufon-colors-ancient.js", true);
                AddScriptToHead(Page.Header, "~/App_Themes/Cardamon/js/Charis_SIL_700.font.js", true);
            }
            else
            {
                //Y U no theme?
            }
        }

    }
} 
```

我想扩展它以在将来接受脚本和主题作为属性，但这现在可以工作。

# c - 如何使用 /dev/kmem？

> ID：10800884
> 
> 赞同：11
> 
> 时间：2012-05-29T14:10:02.847
> 
> 标签：c, linux, mmap

更新了我的帖子...

我得到了下面的程序。它在`/dev/kmem`和上运行`/dev/mem`。

我想我可以从代码中学到一些东西。但是当我在我的 Beagle Board 上运行它时，会给出以下结果：

```
case 1: ( if(1) )
    root@omap:/home/ubuntu/tom# ./kmem_mem /boot/System.map-3.0.4-x3
    found jiffies at (0xc0870080) c0870080
    /dev/kmem read buf = 319317
    jiffies=319317 (read from virtual memory)

    /dev/mem: the offset is 870080
    the page size = 4096
    mmap: Invalid argument

case 2: ( if(0) )
    root@omap:/home/ubuntu/tom# ./kmem_mem /boot/System.map-3.0.4-x3 
    found jiffies at (0xc0870080) c0870080
    /dev/kmem read buf = 333631
    jiffies=333631 (read from virtual memory)

    /dev/mem: the offset is 870080
    /dev/mem read failed: Bad address
    jiffies=0 (read from physical memory) 
```

我使用了下面的命令，以便 mmap 可以使用 NULL 作为它的第一个参数。

```
root@omap:/home/ubuntu/tom# echo 0 > /proc/sys/vm/mmap_min_addr
root@omap:/home/ubuntu/tom# cat /proc/sys/vm/mmap_min_addr
0 
```

如您所见，`read_kmem()`工作正常但`read_mem()`不起作用，似乎转移到它的“偏移量”是错误的。但是内核地址 - `PAGE_OFFSET(0xC0000000) = physical address`，是不是错了？

我的问题是：（1）为什么在案例 1 中出现“mmap：无效参数”？(2) 为什么 mmap 只映射`PAGE_SIZE`长度空间？(3) 有什么问题`read_mem`？

任何人都可以帮忙吗？谢谢！

```
/*
* getjiff.c
*
* this toolkit shows how to get jiffies value from user space:
* 1\. find jiffies's address from kernel image.
* 2\. access virtual address space to get jiffies value.
* 3\. access physical address sapce to get jiffies value.
*
* demostrate following techniques:
* o get ELF object symbol address by calling nlist()
* o access virtual memory space from /dev/kmem
* o access virtual memory space from /dev/mem
*/

#include <stdio.h>
#include <stdlib.h>         //exit
#include <linux/a.out.h>    //nlist
#include <sys/types.h>
#include <sys/stat.h>
#include <fcntl.h>
#include <unistd.h>
#include <sys/types.h>
#include <sys/ioctl.h>
#include <sys/mman.h>
#include <memory.h>

#define LONG *(volatile unsigned long*)

/* read from virtual memory */
int read_kmem(off_t offset, void* buf, size_t count)
{
    int fd;
    int n;

    fd = open("/dev/kmem", O_RDONLY);
    if (fd < 0)
    {
        perror("open /dev/kmem failed");
        return -1;
    }

    lseek(fd, offset, SEEK_SET);
    n = read(fd, buf, count);
    if (n != count)
        perror("/dev/kmem read failed");
    else
        printf("/dev/kmem read buf = %ld\n", *(unsigned long *)buf);

    close(fd);
    return n;
}

/* read from physical memory */
int read_mem(off_t offset, void* buf, size_t count)
{
    int fd;
    int n;
    int page_size;
    void *map_base; 
    unsigned long value;

    printf("/dev/mem: the offset is %lx\n", offset);

    fd = open("/dev/mem", O_RDONLY);
    if (fd < 0)
    {
        perror("open /dev/mem failed");
        return -1;
    }

    if(1){
        page_size = getpagesize();
        printf("the page size = %d\n", page_size);
        map_base = mmap(0,page_size,PROT_READ,MAP_SHARED,fd,offset);
        if (map_base == MAP_FAILED){
            perror("mmap");
            exit(1);
        }
        value = LONG(map_base);
        printf("/dev/mem: the value is %ld\n", value);
        buf = (unsigned long *)map_base;
    }

    if(0){
        lseek(fd, offset, SEEK_SET);
        n = read(fd, buf, count);
        if (n != count)
            perror("/dev/mem read failed");
        else
            printf("/dev/mem read buf = %ld\n", *(unsigned long *)buf);
    }

    close(fd);
    return n;
}

int main(int argc, char **argv)
{
    FILE *fp;
    char addr_str[11]="0x";
    char var[51];
    unsigned long addr;
    unsigned long jiffies;
    char ch;
    int r;

    if (argc != 2) {
            fprintf(stderr,"usage: %s System.map\n",argv[0]);
            exit(-1);
    }

    if ((fp = fopen(argv[1],"r")) == NULL) {
            perror("fopen");
            exit(-1);
    }

    do {
            r = fscanf(fp,"%8s %c %50s\n",&addr_str[2],&ch,var);    // format of System.map
            if (strcmp(var,"jiffies")==0)
                    break;
    } while(r > 0);
    if (r < 0) {
            printf("could not find jiffies\n");
            exit(-1);
    }

    addr = strtoul(addr_str,NULL,16);                               //Convert string to unsigned long integer
    printf("found jiffies at (%s) %08lx\n",addr_str,addr);

    read_kmem(addr, &jiffies, sizeof(jiffies));
    printf("jiffies=%ld (read from virtual memory)\n\n", jiffies);

    jiffies = 0;                                                    //reinit for checking read_mem() below

    read_mem(addr-0xC0000000, &jiffies, sizeof(jiffies));
    printf("jiffies=%ld (read from physical memory)\n", jiffies);

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-10T18:11:33.617

我尝试了 dd 的组合或 offset 和 bs 并找到了这个解决方案：

在 PC 上，在构建目录中，我找到了 jiffies 的位置。

grep -w jiffies System.map
**c04660c0** D jiffies

在熊猫板上：

在 /proc/iomem 你可以看到：

80000000-9c7fffff：系统 RAM
80008000-80435263：内核代码
80464000-804d0d97：内核数据
a0000000-bfefffff：系统 RAM

RAM从物理80000000开始，内核数据从80464000开始。看起来类似于jiffies的地址。

然后从虚拟地址转换为物理地址：virt - 0xC000000 + 0x8000000。

**dd if=/dev/mem skip=$((0x804660c)) bs=$((0x10)) count=1 2> /dev/null |**
十六进制转储0000000 **02b9** **0002** 0001 0000 0000 0000 0000 0000
0000010

尝试几次，看看值是如何增加的。

*总结：/dev/mem使用phys地址，RAM从phys地址0x8000000开始*

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-13T01:28:49.643

对于情况 1 中的无效参数，问题是偏移量是非页面对齐的。**mmap(2)**通过操作页表来工作，并且这样的工作仅适用于**大小和偏移量的页面大小的倍数**

至于第二种情况，我不确定您是否保证内核空间从 3G 边界开始。另外，我很确定这是内核**虚拟空间**的边界，而不是物理内存中的位置 - 所以在小猎犬板上，很可能你最终得到了一个指向谁知道哪里的环绕偏移。

我认为您可能需要的是[**PHYS_OFFSET**](http://www.kneuro.net/cgi-bin/lxr/http/ident?i=PHYS_OFFSET)，*而不是* **PAGE_OFFSET**。

# .net - SSRS 报告图表不显示 0 的值

> ID：10800886
> 
> 赞同：2
> 
> 时间：2012-05-29T14:10:06.120
> 
> 标签：.net, sql-server, ssrs-2008

当 SSRS 2008 中的图表时，如果没有数据，是否可以不显示任何值？如果用户愿意，我仍然想显示 0

![在此处输入图像描述](../Images/020ca0fd4e1d4b41f3d7f80d56e461d4.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T12:11:55.277

右键单击报告编辑器上的标签顶部，然后选择“系列标签属性”。

在常规选项卡上，在标签数据上，将表达式编辑为：

```
=IIF(#VALY=0,"",#VALY) 
```

# git - 将分支变基到主恢复

> ID：10800891
> 
> 赞同：2
> 
> 时间：2012-05-29T14:10:22.097
> 
> 标签：git, rebase, git-rebase

我犯了一个很大的错误，就是将分支重新设置为 master 而不是将 master 重新设置为分支。因此，现在我没有在分支中更改 master，而是让 master 与远程仓库不同步。

如何收回更改？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T14:12:24.140

如果您的远程仓库仍然可以，只需

```
git checkout anybranch
git branch -D master
git fetch --all
git checkout master 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-29T17:27:17.837

当你在树枝和它们指向的地方出错时，你可以被`git reflog`.

```
git reflog 
```

将向您显示分支之前指向的位置。因此，如果您的 rebase 错误，您可以通过将分支指向它曾经所在的位置来“撤消”它：

```
git reset --hard HEAD@{1} 
```

将 1 更改为另一个数字，具体取决于您想要的提交在 reflog 提供的列表中的位置。

reflog 对于人们可能犯的许多其他错误也很有用。

# java - 按下按钮时 JTextField 自动更改值

> ID：10800893
> 
> 赞同：1
> 
> 时间：2012-05-29T14:10:31.400
> 
> 标签：java, swing, scroll, jbutton, jtextfield

我有一个带有两个 JButton（向上箭头和向下箭头按钮）的 jTextField。单击向上箭头按钮，文本字段中的数值增加 1 (++)，单击向下箭头按钮，文本字段中的数值减少 1 (--)。

我想知道的是如何在按下按钮时自动“滚动/更改”值？

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-29T14:23:46.077

你可能想要的是一个 JSpinner。更具体地说是 SpinnerNumberModel。

这是一个演示链接 [http://docs.oracle.com/javase/tutorial/uiswing/components/spinner.html](http://docs.oracle.com/javase/tutorial/uiswing/components/spinner.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-29T14:58:35.293

这`JSpinner`是最好的方法。

但是如果你想要一个不同的实现，我建议使用`MouseListener`附加到`JButton`s. 当按下其中一个按钮（`mousePressed`事件）时，将`javax.swing.Timer`启动 a。每 x 毫秒（取决于您希望增加/减少数字的速度）检查是否`JButton`仍被按下以及鼠标是否仍在`JButton`. 如果是，则增加/减少数量。当用户释放鼠标（`mouseReleased`事件）时，将`Timer`停止/取消。

我从来没有这样做过，所以我不确定它是否有效。但这是我会尝试的方式。

# servicestack - 在发布模式下找不到 ServiceStack dll

> ID：10800895
> 
> 赞同：1
> 
> 时间：2012-05-29T14:10:33.633
> 
> 标签：servicestack

在发布模式下编译我的应用程序时遇到问题。我收到以下错误：

*找不到类型或命名空间名称“ServiceStack”（您是否缺少 using 指令或程序集引用？）*

我的项目正在使用完整的 .NET 4.0（无客户端配置文件）。

当我切换回调试模式时，一切正常。

有人可以帮我吗？

![在此处输入图像描述](../Images/cb8c906e542de18516921611ecbbf4b5.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-09-04T17:17:15.840

好的，修好了。问题是在发布模式下缺少引用

# jquery - 如何在 3 个元素上循环上课

> ID：10800897
> 
> 赞同：1
> 
> 时间：2012-05-29T14:10:40.340
> 
> 标签：jquery, html, css, jcarousellite

我正在使用[jCarouselLite](http://www.gmarwaha.com/jquery/jcarousellite/)在 3 个元素之间循环。我已经设置了插件来做到这一点，包括滑动到每个元素的 3x `.bulletX`，即项目符号 1 滑动到元素 1，等等。

但是我想要的是循环类`.active`以`.bulletX`指定正在显示的元素，类似于 nivoslider。

```
<div class="bullet1">If this is clicked, is leads to element1</div>
<div class="bullet2">If this is clicked, is leads to element2</div>
<div class="bullet3">If this is clicked, is leads to element3</div> 
```

我觉得我可以用`.addClass`and做一些事情`.removeClass`，但我无法完全理解循环的语义。

`.active``.bullet2`手动应用

![在此处输入图像描述](../Images/9fdc22f80a1e7083c0153d6dcf890e06.png)

编辑完整的 HTML

```
<div class="twwetHolder">
    <div class="tweet">
     <ul>
        <li>
            <div>element 1</div>
        </li>
        <li>
            <div>element 2</div>
        </li>
        <li>
            <div>element 3</div>
        </li>
     </ul>

    </div>  
<div class="bullet1"></div>
<div class="bullet2"></div>
<div class="bullet3"></div>
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T14:23:05.310

更新：

我建议您为每个项目符号（另一个）添加一个类，然后使用 btnGo 事件和单击事件来添加该类。

[http://jsfiddle.net/lucuma/fg6d4/1/](http://jsfiddle.net/lucuma/fg6d4/1/)

```
<div class="bullet1 btngo">a</div>
<div class="bullet2 btngo">b</div>
<div class="bullet3 btngo">c</div>

$('.tweet').jCarouselLite({btnGo:$('.btngo')});

    $('.btngo').click(function() {
       $('.btngo').removeClass('active'); 
       $(this).addClass('active');

    });
​ 
```

原来的：

您可以尝试以下选项：

```
 beforeStart: function(a) {
      $(a).removeClass('active');
    },
   afterEnd: function(a) {
        $(a).addClass('active');
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T14:53:09.040

`.toggleClass()`可能会帮助你 - [http://api.jquery.com/toggleClass/](http://api.jquery.com/toggleClass/)

# android - Android：底部布局未显示在图库中

> ID：10800899
> 
> 赞同：0
> 
> 时间：2012-05-29T14:10:47.570
> 
> 标签：android, layout, gallery

我试图用包含平铺背景的布局将我的 ImageView 的顶部和底部包围在画廊中。顶部似乎正在工作，但底部布局没有显示。任何想法为什么？这是我的getView()：

```
public View getView(int position, View convertView, ViewGroup parent) {
            RelativeLayout container = new RelativeLayout(galleryContext);

            RelativeLayout topReel = new RelativeLayout(galleryContext);
            RelativeLayout bottomReel = new RelativeLayout(galleryContext);

            topReel.setBackgroundResource(R.drawable.film_top);
            bottomReel.setBackgroundResource(R.drawable.film_bottom);

            ImageView imageView = null;
            if (convertView != null) {  //we can reuse the view!
                imageView = (ImageView) convertView;
            } else {
                imageView = new ImageView(galleryContext);   //boo we have to make a new view
            }

            //Get a scaled Bitmap so that it doesn't use up all our memory

            Bitmap setBitmap = loadScaledBitmap(imageList[position].getAbsolutePath(), imageSizeInPixels);

            //set up our ImageView inside the gallery to display our Bitmap...

            imageView.setImageBitmap(setBitmap);
            imageView.setLayoutParams(new Gallery.LayoutParams(imageSizeInPixels, imageSizeInPixels));
            imageView.setScaleType(ImageView.ScaleType.FIT_XY);
            imageView.setBackgroundResource(galleryBackground);

            RelativeLayout.LayoutParams topParams = new RelativeLayout.LayoutParams(imageSizeInPixels, 20);
            topParams.addRule(RelativeLayout.ABOVE, imageView.getId());
            topParams.addRule(RelativeLayout.CENTER_HORIZONTAL);

            RelativeLayout.LayoutParams bottomParams = new RelativeLayout.LayoutParams(imageSizeInPixels, 20);
            bottomParams.addRule(RelativeLayout.BELOW, imageView.getId());
            bottomParams.addRule(RelativeLayout.CENTER_HORIZONTAL);

            RelativeLayout.LayoutParams imageParams = new RelativeLayout.LayoutParams(imageSizeInPixels, imageSizeInPixels);
            imageParams.addRule(RelativeLayout.BELOW, topReel.getId());
            imageParams.addRule(RelativeLayout.ABOVE, bottomReel.getId());
            imageParams.addRule(RelativeLayout.CENTER_VERTICAL);
            imageParams.addRule(RelativeLayout.CENTER_HORIZONTAL);

            container.addView(topReel, topParams);
            container.addView(bottomReel, bottomParams);
            container.addView(imageView, imageParams);

            return container;
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T14:44:33.477

这解决了问题，希望有人可以使用它：

```
public View getView(int position, View convertView, ViewGroup parent) {
            RelativeLayout container = new RelativeLayout(galleryContext);

            ImageView imageView = null;
            if (convertView != null) {  //we can reuse the view!
                imageView = (ImageView) convertView;
            } else {
                imageView = new ImageView(galleryContext);   //boo we have to make a new view
            }

            //Get a scaled Bitmap so that it doesn't use up all our memory

            Bitmap setBitmap = loadScaledBitmap(imageList[position].getAbsolutePath(), ((int)(imageSizeInPixels * .75)));

            //set up our ImageView inside the gallery to display our Bitmap...

            imageView.setImageBitmap(setBitmap);
            imageView.setLayoutParams(new Gallery.LayoutParams(imageSizeInPixels, imageSizeInPixels));
            imageView.setScaleType(ImageView.ScaleType.FIT_XY);
            imageView.setBackgroundColor(Color.BLACK);

            RelativeLayout borderImg = new RelativeLayout(galleryContext);
            borderImg.setPadding(10, 5,10, 5);
            borderImg.setBackgroundColor(0xff000000);
            borderImg.addView(imageView);

            RelativeLayout.LayoutParams imageParams = new RelativeLayout.LayoutParams(imageSizeInPixels, imageSizeInPixels);
            imageParams.addRule(RelativeLayout.CENTER_VERTICAL);
            imageParams.addRule(RelativeLayout.CENTER_HORIZONTAL);

            container.setBackgroundResource(R.drawable.repeat_reel);
            container.setLayoutParams(new Gallery.LayoutParams(imageSizeInPixels, imageSizeInPixels+40));

            container.addView(borderImg, imageParams);

            return container;
        } 
```

# google-maps - 在 Google 地图上显示消息

> ID：10800900
> 
> 赞同：2
> 
> 时间：2012-05-29T14:10:48.163
> 
> 标签：google-maps, openlayers

我在我的学术项目中使用谷歌地图，从几周后，每当我在地图上进行某些操作（如放大、缩小）时，都会在地图上显示一条消息。可能是什么原因？我需要在其中配置任何东西吗？我的代码。![在此处输入图像描述](../Images/3dcd47f3cc0eb5dfbbe32815e8959862.png)

您可以在上图中看到该消息，消息标题为“地图数据”。我们在项目中使用开放图层地图，编码语言是 PHP。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T14:41:15.863

我在这里读到，一个原因可能是某些元素掩盖了地图数据的版权，但我发现一些对同一通知的投诉没有提及这一点就弹出了。

我找到的最有希望的选项是[一个页面，上面写着解决方案是升级到 2.12](http://trac.osgeo.org/openlayers/wiki/Release/2.11/GoogleMaps37)，或者如果你不能，则在包含 OpenLayers.js 后应用补丁

```
<script src="http://maps.google.com/maps/api/js?v=3.5&amp;sensor=false"></script>
    <script src="../lib/OpenLayers.js"></script>
    <script>
    OpenLayers.Layer.Google.v3.repositionMapElements = function() {
        // This is the first time any Google layer in this mapObject has been
        // made visible.  The mapObject needs to know the container size.
        google.maps.event.trigger(this.mapObject, "resize");

        var div = this.mapObject.getDiv().firstChild;
        if (!div || div.childNodes.length < 3) {
            this.repositionTimer = window.setTimeout(
                OpenLayers.Function.bind(this.repositionMapElements, this),
                250
            );
            return false;
        }

        var cache = OpenLayers.Layer.Google.cache[this.map.id];
        var container = this.map.viewPortDiv;

        // move the ToS and branding stuff up to the container div
        // depends on value of zIndex, which is not robust
        for (var i=div.children.length-1; i>=0; --i) {
            if (div.children[i].style.zIndex == 1000001) {
                var termsOfUse = div.children[i];
                container.appendChild(termsOfUse);
                termsOfUse.style.zIndex = "1100";
                termsOfUse.style.bottom = "";
                termsOfUse.className = "olLayerGoogleCopyright olLayerGoogleV3";
                termsOfUse.style.display = "";
                cache.termsOfUse = termsOfUse;
            }
            if (div.children[i].style.zIndex == 1000000) {
                var poweredBy = div.children[i];
                container.appendChild(poweredBy);
                poweredBy.style.zIndex = "1100";
                poweredBy.style.bottom = "";
                poweredBy.className = "olLayerGooglePoweredBy olLayerGoogleV3 gmnoprint";
                poweredBy.style.display = "";
                cache.poweredBy = poweredBy;
            }
            if (div.children[i].style.zIndex == 10000002) {
                container.appendChild(div.children[i]);
            }
        }

        this.setGMapVisibility(this.visibility);
    };
    </script>
    <script src="google-v3.js"></script> 
```

# java - 提取实体保存类

> ID：10800916
> 
> 赞同：0
> 
> 时间：2012-05-29T14:11:30.177
> 
> 标签：java, jpa, entity, entitymanager, netbeans-platform

我的情况是，我有 100 个表（实体类）和 100 个屏幕（每个屏幕 1 个）。让我们看一下 2 个屏幕：ShipviaTopComponent 和 RouteTopComponent。RouteTopComponent 有以下方法：

```
public static void saveRecord() {
    Route r = resultList.get(currentPos);
    EntityManager entityManager = Persistence.createEntityManagerFactory("EntityLibraryPU").createEntityManager();
    entityManager.getTransaction().begin();
    r = entityManager.find(Route.class, r.getRouteKey());
    r.setRoute(txtRoute.getText());;
    entityManager.persist(r);
    entityManager.getTransaction().commit();
} 
```

现在，如果我在 100 个屏幕中的每一个中都使用该方法，那么一切都会奏效；但是我正在考虑将其提取到自己的类中。这意味着它不会总是 Route，但可以是 Shipvia 或任何其他实体类。

我期待我的 RouteTopComponent 用类似以下的方式调用它；

```
com.demo.viewer.SaveRecord.SaveRecord(r); 
```

r 包含了我需要的几乎所有东西。这是 SaveRecord 类。

```
public class SaveRecord {

public static void saveRecord(entity.Route r) {

    EntityManager entityManager = Persistence.createEntityManagerFactory("EntityLibraryPU").createEntityManager();
    entityManager.getTransaction().begin();
    r = entityManager.find(Route.class, r.getRouteKey());
    r.setRoute("01-banana"); //Hardcode this for now
    entityManager.persist(r);
    entityManager.getTransaction().commit();
} 
```

我遇到的问题之一 - 如果我将 'r' 传递给它，它期待 entity.Route。但如果我通过希普维亚，它就会坏掉。有什么方法可以让它期待像 entity.Anything 这样的东西

**编辑：**根据建议，我正在尝试创建一个超类实体。

超类 AddChg 实体 - [http://pastebin.com/1iW67NVn](http://pastebin.com/1iW67NVn)

Shipvia 实体 - [http://pastebin.com/R53tNHyp](http://pastebin.com/R53tNHyp)（只是原始的，普通实体）

路由实体 - [http://pastebin.com/5DCvj340](http://pastebin.com/5DCvj340)（扩展 AddChg）

SaveRecord 的一段代码（我将其命名为 SaveResult）如下所示：

```
 public static <T extends AddChg> void SaveResult(T r) {
    EntityManager entityManager = Persistence.createEntityManagerFactory(
         "EntityLibraryPU").createEntityManager();
      entityManager.getTransaction().begin();
      r = entityManager.find(Route.class, r.getId());
      r.setSomething("01-banana");
      entityManager.persist(r);
      entityManager.getTransaction().commit();
 } 
```

现在，它似乎起作用了，从某种意义上说，当 r. 从超类中提取所有内容。只有一行似乎给我带来了麻烦：

```
 r = entityManager.find(Route.class, r.getId()); 
```

Route.class 还必须根据其尝试访问的实体而有所不同。并且`r.getId()`必须是被保存实体的PK。

因此，例如，如果用户想要编辑 RouteTop Screen，则该行应为；

```
r = entityManager.find(Route.class, r.getRouteKey()); 
```

但是对于 ShipviaTopScreen 它将是；

```
r = entityManager.find(Shipvia.class, r.getShipvViaCd()); 
```

我是否能够将这些作为参数传递，例如：

```
 public static <T extends AddChg> void SaveResult(T r, Class c, String PK) 
```

**Edit3：**上面的解决方案有效，最后我有最后一个问题/问题。

保存结果：

```
public static <T extends AddChg> void SaveResult(T r, Class c, String pk) {
        EntityManager entityManager = Persistence.createEntityManagerFactory(
             "EntityLibraryPU").createEntityManager();
          entityManager.getTransaction().begin();
          r = entityManager.find(c, pk);
          r.setSomething("01-banana");
          entityManager.persist(r);
          entityManager.getTransaction().commit();
 } 
```

路由顶部组件：

```
public static void saveRecord() {
    if (r.getRouteKey() != null) {
        r.setRoute(txtRoute.getText());
    }
    SaveResult.SaveResult(r, Route.class, r.getRouteKey());
} 
```

问题出在`r.setSomething("");` 当我输入 r 时。我唯一的建议是超类中的那些（您必须参考这个问题的 pastebin 链接）。

在 RouteTopComponent 我可以做到`r.setRoute`，但在 SaveResult =(

**Edit4：**我采用了将实体特定数据保存在 TopComponent 中的方法，同时将通用（公共）字段留给超类。这是我的代码现在的样子：

路由顶部组件：

```
public static void saveRecord() {
        WWEntityManager.entityManager.getTransaction().begin();
        r = WWEntityManager.entityManager.find(Route.class, r.getRouteKey());
        r.setRoute(txtRoute.getText());
        WWEntityManager.entityManager.persist(r);
        WWEntityManager.entityManager.getTransaction().commit();
        SaveResult.SaveResult(r, Route.class, r.getRouteKey());
    } 
```

如您所见，我现在首先提交 Route.class 特定字段。然后我调用 SaveResult 方法，然后保存通用的东西；

保存结果

```
public class SaveResult {

    public static <T extends AddChg> void SaveResult(T r, Class c, String pk) {
        WWEntityManager.entityManager.getTransaction().begin();
        r = (T) WWEntityManager.entityManager.find(c, pk);
        r.setChgDate("2012-05-31");
        WWEntityManager.entityManager.persist(r);
        WWEntityManager.entityManager.getTransaction().commit();
    }
} 
```

我想知道这是否确实是我应该处理保存一条记录（有 2 次提交）的方式？它有效，但如果有更好的做法来处理它，那将是非常棒的！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T14:16:22.797

我会选择一个超类（我们称之为 PersistentObject），所有实体都从中继承基本字段，例如 Id。

然后，您的方法的参数将是 PersistentObject 而不是特定实体 Route。如果您愿意，您还可以将参数定义为任何扩展 PersistentObject 的类：

```
public <T extends PersistentObject> static void saveRecord(T newRecord) {
    //your persistence logic here
} 
```

[这个网站](http://www.objectdb.com/api/java/jpa/MappedSuperclass)以一种很好的方式解释了基础知识。

**编辑：**关于您的“EntityManager.find()”问题：

您的选择对我来说似乎没问题，因为 EntityManager.find() 方法通过主键返回一个实体，检查第一个参数是否确实是一个类，并检查第二个参数是否与实体的主键类型匹配. 我认为您可以通过直接执行 r.getClass() 而不是使用 Class c 参数来省去一些麻烦。尽管如此，在 SaveResult 方法中执行所有操作都需要您提供 PK。

作为建议（如果它乏味或根本不可能，则丢弃它），您可以将该 find() 逻辑提取到另一个方法，并将您获得的实体作为参数传递给 save 方法，使其独立于特定于对象的属性。

还有另一种选择：NamedQueries。您可以在每个实体上定义一个“findById”查询，然后调用 entity.createQuery 方法，该方法返回您正在搜索的对象。这可以是“不！” 在您的特殊情况下，因为您有 100 个实体，因此您必须执行 100 个特定查询（在这里，复制粘贴是一个警报器，会召唤您造成灾难......）。

我自己从未这样做过，但也许您可以在映射的超类中创建一个唯一的“findById”NamedQuery 并传递相应的 Id，但您需要进行一些特定的演员表处理。

**编辑 2：**确实，由于 T 类型扩展了 AddChg，因此您知道您可以访问的唯一方法是超类中的方法。考虑到这一点（并避免过度杀伤），您可以在超类中定义一个“setRoute()”并在您的特定类中覆盖它，为其提供您想要的特定行为。

如果您需要一种涉及许多特定于实例的属性的更复杂的方法，则需要在保存对象之前对其进行准备。您的保存方法应该只具有存储对象所需的与持久性相关的操作。“setSomething()”似乎与对象数据本身有关，因此在 RouteTopComponent 中执行此操作更合适。

**编辑3：**只需使用最后一个坚持。第一个保留一半信息，最后一个保留所有信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T14:37:44.410

使用泛型

制作超类

```
interface IParent  
{  
   long getId();

   void setSomething(String smth);   
} 
```

每个实体`implements IParent`

```
public class SaveRecord
{
   public static <T extends IParent> void saveRecord(T r)
   {
      EntityManager entityManager = Persistence.createEntityManagerFactory(
         "EntityLibraryPU").createEntityManager();
      entityManager.getTransaction().begin();
      r = entityManager.find(Route.class, r.getId());
      r.setSomething("01-banana");
      entityManager.persist(r);
      entityManager.getTransaction().commit();
   } 
```

# objective-c - 目标 C - 创建模态 Segue

> ID：10800917
> 
> 赞同：2
> 
> 时间：2012-05-29T14:11:33.323
> 
> 标签：objective-c, uiviewcontroller, storyboard, modal-dialog

我在弄清楚如何正确使用故事板时遇到了一些麻烦。我的主要问题是模态序列。我有一个视图控制器，我试图以模态方式显示（下图中最右边）。但它只是没有显示。prepareForSegue 正确触发。

不过，当我将 segue 从 Modal 更改为 Push 时，它确实有效。

我正在使用

```
performSegueWithIdentifier:@"FirstRunSegue" sender:self 
```

这是我目前拥有的视觉转场设置

![在此处输入图像描述](../Images/30f50407cb99d6f8e4e2ab5d426c6f4b.png)

当我将鼠标悬停在 Excaimation 标记上时，会显示以下错误：

![在此处输入图像描述](../Images/88ddbffc125d9479ea5443ecf65144c3.png)

我是 Storyboard 的新手，所以我希望有人能解释为什么模态 segue 不起作用以及如何让它起作用。令人讨厌的是，视图控制器必须在情节提要中，否则我只需初始化控制器并手动显示它。

问候， EZfrag

编辑1：

好的，我设法弄清楚为什么没有显示segue。这有点愚蠢，因为它适用于推动。看来我无法从 appdeletegate 的启动功能中调用模态序列。推送工作正常，但不是模态的。用一个新项目确认它。

有没有人可以解释为什么会这样？

问候， EZFrag

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T14:15:17.550

您只能将 push segue 与 a 一起使用`UINavigationController`，但看起来您正试图在两个常规 之间使用它`UIViewContoller`。如果您想更改动画的外观，请使用自定义转场并编写自己的过渡。

# asp.net-mvc-3 - 使用 .net Web 应用程序实现 Solr

> ID：10800919
> 
> 赞同：3
> 
> 时间：2012-05-29T14:11:45.770
> 
> 标签：asp.net-mvc-3, solr, lucene, lucene.net, solrnet

我即将在基于 NopCommerce 的购物车应用程序上实现 Solr 搜索。我想对步骤有一个想法，我应该如何进行。我已经在谷歌上寻求一些帮助，但它并没有真正帮助。我发现 .net 有一个接口用于将其与 .net 应用程序集成，但在 solr 网站上没有找到任何文档或教程。

我需要你的帮助来决定解决这个问题的最佳方法。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-29T15:53:49.270

Solr 站点上有一个[Solr 教程](http://lucene.apache.org/solr/4_5_0/tutorial.html)。至于设置可从 ASP.NET MVC 网站访问的站点，我建议实现[SolrNet](https://github.com/mausch/SolrNet)客户端并使用[SolrSampleApp](https://github.com/mausch/SolrNet/tree/master/SampleSolrApp)作为起点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-08T14:42:44.157

你不需要这样做..已经有一个将 solr 与 nopCommerce 集成的插件。也许你想看那个。我已经进行了一次试验，它真正的梦想成真了。我最终在大约半小时内使用它。它提高了我网站的速度和搜索结果。你可以在这里找到更多信息：[http ://www.nopaccelerate.com/](http://www.nopaccelerate.com/)

# mysql - 带有 DataSource 的 jetty-env.xml 导致 mvn jetty:run 上的 WebAppContext 失败

> ID：10800922
> 
> 赞同：7
> 
> 时间：2012-05-29T14:11:55.820
> 
> 标签：mysql, jetty, jndi, maven-jetty-plugin

我有一个非常简单的带有 maven 和 jetty 的 webapp 项目，到目前为止一直运行良好。但是现在我需要使用 JNDI 设置 MySQL 连接池，因为数据库连接总是超时。

首先这里是我的pom.xml的相关内容：

```
<modelVersion>4.0.0</modelVersion>
...
<packaging>war</packaging>
...
<properties> 
    <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
    <jetty-version>8.1.0.v20120127</jetty-version>
</properties> 
<dependencies>
    ...
    <dependency>
        <groupId>mysql</groupId>
        <artifactId>mysql-connector-java</artifactId>
        <version>5.1.20</version>
    </dependency>
    <dependency>
        <groupId>org.mortbay.jetty</groupId>
        <artifactId>jetty-maven-plugin</artifactId>
        <version>${jetty-version}</version>
        <type>maven-plugin</type>
    </dependency>
</dependencies>
...
<build>
    <plugins>
    <plugin>
        <groupId>org.mortbay.jetty</groupId>
        <artifactId>jetty-maven-plugin</artifactId>
        <version>${jetty-version}</version>
        <configuration>
                <scanIntervalSeconds>10</scanIntervalSeconds>
            </configuration>
        </plugin>
    </plugins>
    ...
</build> 
```

现在我在文件夹 /src/main/webapp/WEB-INF 中创建了一个 jetty-env.xml，内容如下：

```
<Configure class="org.eclipse.jetty.webapp.WebAppContext">  
    <New id="project-db" class="org.eclipse.jetty.plus.jndi.Resource">
        <Arg>jdbc/db</Arg>
        <Arg>
            <New class="com.mysql.jdbc.jdbc2.optional.MysqlConnectionPoolDataSource">
                <Set name="url">jdbc:mysql://www.example.com:3306/mydb</Set>
                <Set name="username">dbuser</Set>
                <Set name="password">dbpass</Set>
            </New>
        </Arg>
    </New>
</Configure> 
```

但问题是我什至无法测试此连接是否有效，因为 jetty-maven-plugin 无法在目标上启动

```
mvn jetty:run 
```

出现以下错误：

```
WARN:oejw.WebAppContext:Failed startup of context o.m.j.p.JettyWebAppContext
{/,file:/D:/documents/programmierung/workspace/battleships-trunk/src/main/webapp/}
,file:/D:/documents/programmierung/workspace/battleships-trunk/src/main/webapp/

java.lang.IllegalArgumentException: Object of class 
'org.mortbay.jetty.plugin.JettyWebAppContext' is not of type 
'org.eclipse.jetty.webapp.WebAppContext'. 
Object Class and type Class are from different loaders. 
```

那么我怎样才能让它工作呢？我被迫使用 Jetty 版本 8.x，因为我需要 WebSocket 支持，并且远程生产服务器将运行 Jetty 8。

**编辑** 在 Pavel Veller 的回答之前，我尝试了以下操作：将组装好的战争部署到远程 jetty8 服务器并得到相同的错误，只是之前的错误现在如下所示：

```
java.lang.IllegalArgumentException: Object of class 
'org.eclipse.jetty.webapp.WebAppContext' is not of type 
'org.eclipse.jetty.webapp.WebAppContext'. 
Object Class and type Class are from different loaders. 
```

所以看起来好像有多个类加载器发生冲突。

**EDIT2** 根据 Pavel 的要求，我使用简化的 web 应用程序重新创建了错误，您可以[在 Dropbox 上](https://dl.dropbox.com/u/48605986/jetty-maven-jndi-test.zip)找到。这是一个压缩的 Eclipse Maven 项目。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-30T07:57:40.820

尝试删除依赖项`jetty-maven-plugin`- 此依赖项会将插件添加到您不想要的 WAR 中。

如果您需要使用 Jetty 本身的任何类，请为特定版本的 Jetty（而不是插件）添加一个依赖项，其范围为`provided`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T19:06:44.653

看起来它正在从某个地方拉动 6 号码头。您看到的异常似乎来自解析`jetty-env.xml`( `org.mortbay.jetty.plus.webapp.EnvConfiguration`) 的代码。该类`XMLConfiguration`将您在`Configure`元素上声明的类与它从中获得的实际类进行比较`getWebAappContext()`。后者是`instance of org.mortbay.jetty.plugin.JettyWebAppContext` 你的情况，你期望它是（如果它们都来自同一个“命名空间” `org.eclipse.jetty.webapp.WebAppContext`，这将是父类）。`JettyWebAppContext`

很难说这会发生在哪里，但也许检查你`.m2`并确认你有适合你的码头依赖的二进制文件？它必须运行而不是您期望它运行的版本。

**更新**。Jetty 在加载配置中定义的类时会执行以下操作：

1.  首先加载`Thread.currentThread().getContextClassLoader()`并循环遍历`getParent()`所有选项，直到用尽所有选项。
2.  如果不成功，请尝试使用加载码头核心类 ( `XmlConfiguration.class.getClassLoader()`) 的类加载器进行加载，该类加载器也循环遍历所有父级。
3.  如果仍然不成功，请执行`Class.forName()`
4.  `ClassNotFoundException`不成功就 报告。

你可以在代码中看到它`org.mortbay.util.Loader`（[http://grepcode.com](http://grepcode.com)是一个很好的资源，可以快速查看引擎盖）

它确实会在您的情况下加载类，但显然不是使用*正确*的类加载器。

我现在假设您**的类路径中某处有一个额外的码头 JAR**，它会干扰事物的顺序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-30T10:08:11.477

有同样的问题引起：

```
<useTestClasspath>true</useTestClasspath> (true instead of false) 
```

这在类路径中放置了一个额外的码头罐子......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-06-29T11:05:20.030

包括依赖范围为我解决了错误。

```
<scope>provided</scope> 
```

在`pom.xml`它看起来像这样，

```
<!-- JETTY DEPENDENCIES -->
<dependency>
  <groupId>org.eclipse.jetty</groupId>
  <artifactId>jetty-server</artifactId>
  <version>${jetty.version}</version>
  <scope>provided</scope>
</dependency>
<dependency>
  <groupId>org.eclipse.jetty</groupId>
  <artifactId>jetty-servlet</artifactId>
  <version>${jetty.version}</version>
  <scope>provided</scope>
</dependency>
<dependency>
  <groupId>org.eclipse.jetty</groupId>
  <artifactId>jetty-webapp</artifactId>
  <version>${jetty.version}</version>
  <scope>provided</scope>
</dependency>
<dependency>
    <groupId>org.eclipse.jetty</groupId>
    <artifactId>jetty-servlets</artifactId>
    <version>${jetty.version}</version>
    <scope>provided</scope>
</dependency> 
```

在码头依赖项中，错误消失了。顺便说一句，我使用的码头版本是`9.3.7.v20160115`.

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2014-08-03T16:58:17.373

我遇到了同样的问题并修复了它，但不知道为什么。

通过改变

```
org.eclipse.jetty.webapp.WebAppContext 
```

到

```
org.eclipse.jetty.maven.plugin.JettyWebAppContext 
```

它出于某种原因开始工作，无法弄清楚究竟是为什么。显然maven插件与它有关？

# php - 如何在没有 $this 的情况下调用类内的函数？

> ID：10800924
> 
> 赞同：2
> 
> 时间：2012-05-29T14:12:01.873
> 
> 标签：php, wordpress, class

我想将表单挂接到外部函数上。钩子按名称加载我的表单：

```
add_action(media_uploader, 'the_hook');
function the hook(){
//.....
return wp_iframe( 'media_upload_potato_form', $errors );
}
function media_upload_potato_form(){ }// my form 
```

如果我在如下所示的类中使用上述函数，则会出现错误：

```
return wp_iframe($this->media_upload_potato_form, $errors); 
```

我怎样才能正确连接？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T14:15:16.067

采用

```
return wp_iframe(array('YourClassName', 'media_upload_potato_form'), $errors); 
```

# javascript - 使用 jQuery 过滤 html 字段

> ID：10800928
> 
> 赞同：1
> 
> 时间：2012-05-29T14:12:17.790
> 
> 标签：javascript, jquery, html, css, jquery-plugins

我已阅读有关过滤表插件的信息。我正在寻找的就像这个弹出窗口。

[![弹出](../Images/84aea85f8119e6182cb28d3a890f7aee.png)](https://i.stack.imgur.com/IVqaA.jpg)
[（来源：[staticflickr.com](https://farm8.staticflickr.com/7227/7294670838_a2244899bf.jpg)）]

当用户开始在搜索框中输入内容时，相关的频道/类别（在上一个下拉框中选择）应该被过滤掉。在过滤过程进行时，还应该发生一些动画加载动作。

我正在寻找 jQuery 插件，这将使我的过滤器工作更容易实现。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T14:20:21.090

我认为有一个插件是模棱两可的。只需执行以下操作：

```
function filter($rows, category, search) {
     $rows.each(function() {
          if (category == ($("td:eq(2)", this).text() || category == "all") &&  (search. === "" || $("td:eq(1)", this).text().indexOf(search) !== -1) {
               $(":checkbox", this).removeAttr("disabled");
               $(this).show();
          }
          else
               $(this).hide(function(){
                   $(":checkbox", this).attr("disabled", "disabled");
               });
     });
}

$("select.category").change(function() {
     filter ($(this).closest("form").find("tr"), $(this).val(), $(this).closest("form").find("input.search").val());
});

$("input.search").keyUp(function() {
     filter ($(this).closest("form").find("tr"), $(this).closest("form").find("select.catagory").val(), $(this).val()); 
}); 
```

您可能需要进行一些调整才能使其与 html 的确切格式一起使用。

## 更新使其成为*插件*

```
$.fn.filter_table = function(options) {
    options = $.extend(options, {
         show: $.noop(), //Callback when a row get shown
         hide: $.noop(), // Callback when a row gets hidden
         entries: "table tr", // Selector of items to filter.
         map: {} //Required parameter
        //TODO Add default ajustment parameters here to remove ambiguity and assumptions.      
    });

    return this.each(function() {
        var form = this;

        function each(callback) {
            for (var selector in options.map) {
                 var check = options.map[selector];
                 $(selector, form).each(function(){
                     callback.call(this, check);
                 });  
            }
        }

        function show(row) {
            if (!$(row).is(":visible")) {
               options.show.apply(row);
               $(row).show();
            }
        }

        function hide(row) {
            if ($(row).is(":visible"))
               $(row).hide(options.hide);
        }

        function run_filter() {
            $(options.entries, form).each(function() {
               var row = this, matched = true;

               each(function(check) {
                   matched &= check.call(this, row);
               });

               matched ? show(this) : hide(this);
            })
        }

        //Bind event handlers:

        each(function() {
           $(this).bind($(this).is(":text") ? "keyup" : "change", run_filter);
        });

    });
}; 
```

您可以按如下方式使用此插件：

```
$("form").filter_table({
    map: {
       //These callback define if a row was matched:
       "select.category": function(row) {
            //this refers to the field, row refers to the row being checked.
            return $(this).val() == "all" || $(this).val() == $("td:eq(2)", row).text();
        },
        "input.search": function(row) {
            return $(this).val() == "" || $(this).val() == $("td:eq(1)", row).text();
        }
    },

    entries: "tr:has(:checkbox)", //Filter all rows that contain a checkbox.

    show: function() {
        $(":checkbox", this).removeAttr("disabled");
    },

    hide: function() {
        $(":checkbox", this).attr("disabled", "disabled");
    }
}); 
```

好的，一旦调试完毕，它应该可以工作。我没有测试过。我认为这部分取决于你。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-29T14:50:54.273

你可以使用这个[tablesorterfilter](https://github.com/jbritten/jquery-tablesorter-filter)插件来实现你所需要的

[工作小提琴](http://jsfiddle.net/joycse06/xm3My/1/)

也请看看[http://datatables.net/](http://datatables.net/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-29T14:31:04.103

如果您的 HTML 如下所示：

```
<form id="filterForm">
    <input type="text" id="filterBox">
    <input type="submit" value="Filter">
</form>

<div id="checkboxContainer">
    <label><input type="checkbox" id="checkbox123"> Checkbox 123</label>
</div> 
```

你可以做类似...

```
//Set variables so we only have to find each element once
var filterForm = $('#filterForm');
var filterBox = $('#filterBox');
var checkboxContainer = $('#checkboxContainer');

//Override the form submission
filterForm.submit(function() {

    //Filter by what the label contains
    checkboxContainer.find('label').each(function() {

        //If the value of filterBox is NOT in the label
        if ($(this).indexOf(filterBox.val()) == -1) {

            //Hide the label (and the checkbox since it's inside the label)
            $(this).hide();

        } else {

            //Show it in case it was hidden before
            $(this).show();

        }
    });

    //Prevent the form from submitting
    return false;
}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-29T14:17:42.387

那里有很多选择。这是一个很好的起点：[http ://www.wokay.com/technology/32-useful-jquery-filter-and-sort-data-plugins-62033.html](http://www.wokay.com/technology/32-useful-jquery-filter-and-sort-data-plugins-62033.html)

像这样的过滤并不复杂。可能值得查看一些接近您想要的插件的来源，然后尝试编写自己的插件。如果你自己做，你会学到更多！

# facebook-sharer - facebook分享页面不能显示&(&)标记？

> ID：10800935
> 
> 赞同：3
> 
> 时间：2012-05-29T14:12:50.343
> 
> 标签：facebook-sharer, ampersand, rich-snippets

在 facebook 共享页面中，它可以显示标题，包括 & 标记 ex：

```
url to share: http://myhome.com?q=hi&there 
```

此页面的标题标签是

```
<title>hi&amp;there</title> 
```

但是，实际上，facebook 共享页面显示标题：hi 链接：[http ://myhome.com?q=hi](http://myhome.com?q=hi)

我像下面这样调用 API。"http://www.facebook.com/sharer.php?u=" + encodeURIComponent(location.href) + "&t=" + encodeURIComponent(document.title) 我尝试使用 Open graph meta tag(og:title , og:url)，但它没有帮助。

我在 facebook 开发人员的调试站点 (https://developers.facebook.com/tools/debug) 中检查了我的网址。但在调试站点中，它打印了正确的标题和链接（包括＆符号）

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T16:11:16.913

您需要确保您的 & 符号在您的原始 url 中编码，否则它充当变量之间的分隔符。

假设您的应用程序将`q`查询字符串中的值作为其标题回显，则显示的 URL：`http://myhome.com?q=hi&there`返回两个变量：'q' = 'hi' 和 'there' = 1。

你的 URL 应该有文字`&`编码：`http://myhome.com?q=hi%26there`返回 'q' = 'hi&there'。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-10T06:37:03.530

您可以使用 php 编码任何 url 字符串，例如

```
<? echo urlencode("http://myhome.com?q=hi"); ?> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-03-16T00:08:56.023

通过上面的问题，我猜想完全按照它应该的方式对 url 进行硬编码并将其传递给共享者 api 不是一种选择。

**问题：**

您可能已经注意到，facebook（以及 g+）不会接受 '&' 字符以及后面的任何字符。

所以我们应该找到一种方法来只解码这个'&'。

如果你使用 encodeURIComponent 那么你**所有**的 url 的特殊字符都将被转换为 '%xx' 样式。

IE

```
var url_enc = encodeURIComponent('http://myhome.com?q=hi&there');
alert(url_enc); 
```

将输出：`http%3A%2F%2Fmyhome.com%3Fq%3Dhi%26there`

共享者也不接受！

正如我之前所写，这里真正需要的是发送这样的 url：

```
http://myhome.com?q=hi%26there 
```

这被 facebook api 接受。

**解决方案：**

如果您不能按原样发送 url，并且它可能需要通过创建共享器并为您完成工作的库传递，您需要准确地传递 url，然后将 encodeURI 和 decodeURIComponent 结合起来以下。（就个人而言，我必须进行此更正才能正常工作，所以这是一个严重的错误）

在下面的示例中，我假设使用了一个 javascript 库。

```
var url = 'http://myhome.com?q=hi%26there';
library_function_that_creates_sharer(some_variable, url); 
```

然后，在该函数内部，编码和解码以保持 url 完全相同。

```
decodeURIComponent(encodeURI(url)); 
```

换句话说：

```
var url_new = decodeURIComponent(encodeURI(url)); 
```

最终成为`url_new = url`.

# multithreading - 进程中线程之间的上下文切换

> ID：10800940
> 
> 赞同：2
> 
> 时间：2012-05-29T14:13:19.127
> 
> 标签：multithreading, kernel, scheduling

> 对于内核级线程，当一个线程阻塞某些 I/O 时，另一个线程可以自由运行，但在用户级线程中，如果一个线程被阻塞会发生什么？

该进程是否会保持阻塞，即没有其他线程将执行或将安排另一个线程运行。究竟会发生什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T14:21:12.473

用户级线程是按顺序执行的用户代码片段——一个线程运行一段时间，然后将控制权转移到另一个线程，依此类推。如果其中一个线程进行了阻塞的系统调用，那么整个进程都会阻塞。用户级线程在内核看来就像一个单线程进程。不可能在多个 CPU 上进行并发调度。

内核级线程的主要优点是它们彼此独立运行，并且可以在不同的 CPU 上调度。如果一个阻塞，其他的继续执行。

# c# - SQL 执行时间变慢，代码优先

> ID：10800941
> 
> 赞同：1
> 
> 时间：2012-05-29T14:13:21.373
> 
> 标签：c#, code-first, dbcontext

我这里有点奇怪。我在运行批处理的控制台应用程序中使用 Entity Framework Code First。代码每次循环执行存储过程的一系列日期。

目前它循环了大约 300 次，随着时间的推移，每次执行都会变得越来越慢，直到它爬行时接近尾声。

我试过内存分析，但不是这样。这是示例代码。

```
 _dbContext = new FooContext();
 _barService = new BarService(new GenericRepository<Bar>(), _dbContext);

 for (var date = lastCalculatedDate.AddDays(1); date <= yesterday; date = date.AddDays(1))
 {
     _barService.CalculateWeightings(date);
 } 
```

所有 CalculateWeightings 所做的是（我也在使用 nlog）

```
public void CalculateWeightings(DateTime dateTime)
{
    _logger.Info("Calculating weightings for {1}", dateTime);
    Context.Database.ExecuteSqlCommand("EXEC CalculateWeightings @dateTime", new SqlParameter("@dateTime", dateTime);
} 
```

存储过程只是用一些记录填充一个表。没什么复杂的，表格最终有几行 1000 行，所以问题不存在

有什么想法吗？

对于那些想要查看 sql 的人。它有点庞然大物，但我看不出有任何原因会随着时间的推移而减慢。处理的行数非常少。

```
CREATE PROCEDURE [dbo].[CalculateWeightings]
    @StartDate DateTime,
    @EndDate DateTime,
    @TradedMonthStart DateTime,
    @InstrumentGroupId int
AS
BEGIN
    ---- GET ALL THE END OF DAY PRICINGS FOR MONTHLYS ----
    SELECT 
    ROW_NUMBER() OVER 
                    (
                        PARTITION BY RawTrades.FirstSequenceItemName, 
                        CONVERT(VARCHAR, RawTrades.LastUpdate, 103) 
                        ORDER BY RawTrades.FirstSequenceItemName, RawTrades.LastUpdate DESC
                    ) AS [Row], 
    RawTrades.FirstSequenceItemID AS MonthId, 
    Sequences.ActualStartMonth,
    Sequences.ActualEndMonth,
    RawTrades.FirstSequenceItemName AS [MonthName], 
    CONVERT(VARCHAR, RawTrades.LastUpdate, 103) AS LastUpdate,
    RawTrades.Price
    INTO #monthly
    FROM RawTrades
    INNER JOIN Sequences ON RawTrades.FirstSequenceItemId = Sequences.SequenceItemId AND RawTrades.FirstSequenceId = Sequences.SequenceId
    WHERE RawTrades.FirstSequenceID IN (SELECT MonthlySequenceId FROM Instruments WHERE InstrumentGroupId = @InstrumentGroupId) 
    AND [Action] <> 'Remove'
    AND LastUpdate >= @StartDate
    AND LastUpdate < @EndDate
    AND ActualStartMonth >= @TradedMonthStart
    ORDER BY RawTrades.FirstSequenceItemID, RawTrades.LastUpdate DESC

    ---- GET ALL THE END OF DAY PRICINGS FOR QUARTERLYS ----
    SELECT 
    ROW_NUMBER() OVER 
                    (
                        PARTITION BY RawTrades.FirstSequenceItemName,  
                        CONVERT(VARCHAR, RawTrades.LastUpdate, 103) 
                        ORDER BY RawTrades.FirstSequenceItemName, RawTrades.LastUpdate DESC
                    ) AS [Row], 
    CONVERT(VARCHAR, RawTrades.LastUpdate, 103) AS LastUpdate, 
    Sequences.ActualStartMonth,
    Sequences.ActualEndMonth,
    RawTrades.Price
    INTO #quarterly
    FROM RawTrades
    INNER JOIN Sequences ON RawTrades.FirstSequenceItemId = Sequences.SequenceItemId AND RawTrades.FirstSequenceId = Sequences.SequenceId
    WHERE RawTrades.FirstSequenceID IN (SELECT QuarterlySequenceId FROM Instruments WHERE InstrumentGroupId = @InstrumentGroupId)  
    AND Action <> 'Remove' 
    AND LastUpdate >= @StartDate
    AND LastUpdate < @EndDate
    AND RawTrades.Price > 20
    ORDER BY RawTrades.FirstSequenceItemID, RawTrades.LastUpdate DESC

    ---- GET ALL THE END OF DAY PRICINGS FOR QUARTERLYS ----
    SELECT 
    ROW_NUMBER() OVER 
                    (
                        PARTITION BY RawTrades.FirstSequenceItemName,  
                        CONVERT(VARCHAR, RawTrades.LastUpdate, 103) 
                        ORDER BY RawTrades.FirstSequenceItemName, RawTrades.LastUpdate DESC
                    ) AS [Row], 
    CONVERT(VARCHAR, RawTrades.LastUpdate, 103) AS LastUpdate, 
    Sequences.ActualStartMonth,
    Sequences.ActualEndMonth,
    RawTrades.Price
    INTO #seasonal
    FROM RawTrades
    INNER JOIN Sequences ON RawTrades.FirstSequenceItemId = Sequences.SequenceItemId AND RawTrades.FirstSequenceId = Sequences.SequenceId
    WHERE RawTrades.FirstSequenceID IN (SELECT SeasonalSequenceId FROM Instruments WHERE InstrumentGroupId = @InstrumentGroupId) 
    AND Action <> 'Remove' 
    AND LastUpdate >= @StartDate
    AND LastUpdate < @EndDate
    AND RawTrades.Price > 20
    ORDER BY RawTrades.FirstSequenceItemID, RawTrades.LastUpdate DESC

    ---- BEFORE WE INSERT RECORDS MAKE SURE WE DON'T ADD DUPLICATES ----
    DELETE FROM LiveCurveWeightings
    WHERE InstrumentGroupId = @InstrumentGroupId
    AND CalculationDate = @EndDate

    ---- CALCULATE AND INSERT THE WEIGHTINGS ----
    INSERT INTO LiveCurveWeightings (InstrumentGroupId, CalculationDate, TradedMonth, QuarterlyWeighting, SeasonalWeighting)
    SELECT
    @InstrumentGroupId,
    @EndDate,
    #monthly.ActualStartMonth,
    AVG(COALESCE(#monthly.Price / #quarterly.Price,1)) AS QuarterlyWeighting,
    AVG(COALESCE(#monthly.Price / #seasonal.Price,1)) AS SeasonalWeighting
    FROM #monthly
    LEFT JOIN #quarterly 
        ON #monthly.ActualStartMonth >= #quarterly.ActualStartMonth 
        AND #monthly.ActualEndMonth <= #quarterly.ActualEndMonth 
        AND #quarterly.[Row] = 1
        AND #monthly.LastUpdate = #quarterly.LastUpdate
    LEFT JOIN #seasonal 
        ON #monthly.ActualStartMonth >= #seasonal.ActualStartMonth
        AND #monthly.ActualEndMonth <= #seasonal.ActualEndMonth 
        AND #seasonal.[Row] = 1
        AND #monthly.LastUpdate = #seasonal.LastUpdate
    WHERE #monthly.[Row] = 1
    GROUP BY #monthly.ActualStartMonth

    DROP TABLE #monthly
    DROP TABLE #quarterly
    DROP TABLE #seasonal

END 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-20T23:13:46.237

我认为这个问题可能是由于您的 EF 跟踪图变得太大。如果您在每次执行操作时都在带有跟踪图的批处理操作中重新使用上下文，则它需要枚举该图。有了几百个项目，这不是问题，但是当您进入 000 年代时，它可能会成为一个大问题。[在这里](http://blog.staticvoid.co.nz/2012/05/entityframework-performance-and.html)查看我关于此的文章，看看您是否认为它与问题相符。

如果您查看下面的插入操作图表，您可以看到大约 1000 个插入（当跟踪打开时）开始在执行时间中急剧上升。（还要注意轴上的对数刻度）

![在此处输入图像描述](../Images/01cdcf2911ce0b9890623155db6ea4d8.png)

# python - 为什么这些字符串不相等？（Python）

> ID：10800942
> 
> 赞同：1
> 
> 时间：2012-05-29T14:13:21.857
> 
> 标签：python

```
def getValue(d, key):
    for k, v in d.iteritems():
        print "{0} == {1}".format(k, key)
        if k == key:
            return v
        elif isinstance(v, dict):
            getValue(v, key)
    logging.error("Cannot find key in dictionary")
    return ""

#d = getting the dictionary

getValue(d, "error_frames") 
```

从我在函数中插入的打印语句中，我清楚地看到控制台中出现“error_frames == error_frames”，但 if 语句没有被执行。为什么？字典是通过使用模块 xmltodict 解析 xml 来构造的。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-29T14:14:48.227

`.format`调用`__str__`对象的方法，其输出对于不同的对象可以是相同的。

```
In [1]: a = 1

In [2]: b = '1'

In [3]: print '{0} == {1}'.format(a, b)
1 == 1

In [4]: a == b
Out[4]: False 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-29T14:17:38.470

也许 print 语句是从嵌套的递归调用中执行的。

```
 elif isinstance(v, dict):
        getValue(v, key) 
```

应该是这样`return getValue(key)`吗？

# c# - 如何使用 Rhino Mocks 捕获 Stream 属性的值？

> ID：10800949
> 
> 赞同：0
> 
> 时间：2012-05-29T14:13:51.847
> 
> 标签：c#, unit-testing, properties, rhino-mocks

```
[TestClass]
public class FooTests {
        [TestMethod]
        public void TestFoo() {
            var fooMock = MockRepository.GenerateMock<IFoo>();
            // MUT
            FooUser.Run(fooMock);

            var stream = fooMock.Content;
            stream.Position = 0;

            var first = stream.ReadByte();
            Assert.AreEqual(0x77, (byte) first);
            var second = stream.ReadByte();
            Assert.AreEqual(0x78, (byte) second);
        }
    }

    public class Foo :IFoo {
        public Stream Content { get; set; }
    }

    public class FooUser {
        public static void Run(IFoo foo) {
            foo.Content = new MemoryStream(new byte[] {0x77, 0x78});
        }
    }

    public interface IFoo {
        Stream Content { get; set; }
    } 
```

`AssertWasCalled`似乎不太适合验证流。

```
fooMock.Content.Stub(aStream => stream = aStream); 
```

抛出异常：

```
System.ArgumentNullException: You cannot mock a null instance
Parameter name: mock 
```

> 注意：似乎 Moles 会更好地解决这个问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T14:18:40.120

代替：

```
var fooMock = MockRepository.GenerateMock<IFoo>(); 
```

和：

```
var fooMock = MockRepository.GenerateStub<IFoo>(); 
```

# menu - Symfony 2 - 从可用的包中生成菜单条目

> ID：10800954
> 
> 赞同：5
> 
> 时间：2012-05-29T14:14:24.420
> 
> 标签：menu, symfony, navigation

我是使用 Symphony2 进行 Web 开发的新手（虽然绝对不是 Web 开发的新手），而且我即将开始一个中型项目，该项目将被拆分成捆绑包，因为应用程序的每次安装可能有不同的设置的可用功能。

我想从可用的捆绑包中动态生成我的导航，例如，如果捆绑包“foo”处于活动状态，则应该出现一个菜单条目，其中包含到 foo 主控制器操作的路由。

通常，我对此的看法是在某处创建一个单例，然后我将在包的 load() 函数期间填充它，在渲染期间，我将输出单例。

但是 symfony2 在这部分提供了很大的灵活性，所以我目前正在评估是否有更好的方法。

服务可以成为一种方式吗？还是事件？或者具有依赖注入的东西，所以捆绑包在构造时获得了 NavigationConfigurationElement 的实例？

对此的任何输入或想法，或者可能是如何执行此操作的示例链接，将不胜感激。

最好的问候，延斯

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-29T17:26:46.357

我认为最好的方法是使用依赖注入标签。您将必须创建一个依赖注入扩展并提供一个“标签”，各种捆绑软件可以使用它来注册它们的菜单条目。

我不会在这里向您描述整个过程，因为互联网上有很多关于此的资源。

但是为了给你一个快速的大纲

1.  实现一个保存菜单条目的服务（你在谈论的单身人士）
2.  通过实现编译器传递来处理标记，此编译器传递将查找所有使用导航类标记的服务并将它们注册到菜单服务
3.  创建一个 twig 函数，该函数将使用该服务来检索菜单并呈现它
4.  编写使用标签并提供菜单项的包

以下是一些可能对您有所帮助的资源：

[http://symfony.com/doc/current/components/dependency_injection/tags.html](http://symfony.com/doc/current/components/dependency_injection/tags.html) [http://miguel.ibero.me/es/post/2012-04-28/adding-tags-to-symfony.html](http://miguel.ibero.me/es/post/2012-04-28/adding-tags-to-symfony.html)

我目前正在为使用 DI 标签的 symfony 实现一个 solr 包。我有一个名为 IndexManager 的类，它管理来自不同捆绑包的各种 solr 索引。我使用 DI 标签，以便其他捆绑软件可以注册他们想要在 solr 中索引的内容/实体。原理与菜单项相同。

见这里：[https ://github.com/roomthirteen/Room13SolrBundle](https://github.com/roomthirteen/Room13SolrBundle)

重要的文件是：

添加编译器传递：[https](https://github.com/roomthirteen/Room13SolrBundle/blob/master/Room13SolrBundle.php) ://github.com/roomthirteen/Room13SolrBundle/blob/master/Room13SolrBundle.php 编译器传递本身：[https ://github.com/roomthirteen/Room13SolrBundle/blob/master/DependencyInjection/Compiler/SolrCompilerPass .php](https://github.com/roomthirteen/Room13SolrBundle/blob/master/DependencyInjection/Compiler/SolrCompilerPass.php)

希望有帮助。还有更多的问题吗？不要犹豫，问。

# wordpress - WordPress，将变量从 page.php 传递到 header.php

> ID：10800960
> 
> 赞同：0
> 
> 时间：2012-05-29T14:15:04.420
> 
> 标签：wordpress, wordpress-theming

我尝试在 WordPress 中创建一个主题，并允许用户使用一些页面模板，在标题中加载幻灯片或显示标题。

可以说，我有一个名为 Portfolio 的模板名称和另一个名为 Portfolio 的页面模板，其中包含幻灯片放映。

我可以从`portfolio.php`and`portfolio-with-slide.php`中发送变量`header.php`以确定要显示的内容，还是让我为第二个选项创建第二个标头并将需要的标头加载到模板文件`get_header('title')`中`get_header('slide')`

最好的方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T14:18:55.847

我个人使用第二个选项 - 为第二个选项创建第二个标头，然后使用 和 将需要的标头加载到模板文件`get_header('title')`中`get_header('slide')`。这是代码可维护性方面的最佳方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-29T14:23:30.483

一个合适的解决方案是编写一个过滤器来替换标题：

```
function this_is_the_title_now( $title ) {
    // can return un-altered $title or can use fancy logic here
    return( "This is the new title." );
}

add_filter( 'the_title', 'this_is_the_title_now', 10, 2 ); 
```

这可以放在主题的functions.php 中，或者放在page-whatever.php 中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-04-03T21:29:20.120

You can use `set_query_var` to send variables to your header.php file, or any template part file.

For example, in your Portfolio Slideshow template (`portfolio-with-slide.php`) file:

```
//portfolio-with-slide.php 
set_query_var('includeSlideshow', true); 
```

Then in your `header.php` file (or a template part file):

```
//Header.php
$slideshowHeader = get_query_var('includeSlideShow');
//If variable exists and is boolean true
if($slideshowHeader !== null && $slideshowHeader === true) {
  //code to include slideshow in header
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-01-18T11:33:31.000

由于 wordpress 5.5`get_header`已`$args`准备好使用参数：

[https://developer.wordpress.org/reference/functions/get_header/](https://developer.wordpress.org/reference/functions/get_header/)

你可以把你的论点变成`get_header`这样：

`get_header( 'yourheadername', [ 'header_arg' => 'XYZ' ] );`（如果您使用自定义的 header.php 文件，在这种情况下会是`header-yourheadername.php`：）

或默认 header.php 文件：

`get_header( null, [ 'header_arg' => 'XYZ' ] );`

然后在你的头文件中你可以使用：

`<?php echo $args['header_arg']; ?>` 在里面`if`或任何你想要的:-)

# ios - cocoaAsync:udp sendto 成功但 Wireshark 无法捕获数据

> ID：10800967
> 
> 赞同：0
> 
> 时间：2012-05-29T14:15:20.093
> 
> 标签：ios, udp, sendto

我正在使用 cocoaAsync 来处理 udp 通信。当我使用 cocoaAsync 的 sendData API 时，我确信 sendto 是成功的，来自日志。但我看不到 Wireshark 的任何输出数据。

这不是 100% 可重现的，但很有可能。我无法弄清楚可能是什么问题。

非常感谢任何提示。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T18:44:37.537

如果您确定您正在正确发送数据包，那么以下可能是可能的，

如果您在同一台机器上发送和接收，那么您的 Wireshark 可能无法捕获。尝试发送到与您的机器不同的目的地。

您的机器上也可以有多个网络接口（例如：eth0、eth1 等）用于 Wifi 和网卡。请确保您在正确的接口上捕获数据包。当您按下 Wireshark 上的 Capture 按钮时，您可以选择界面。

我希望这有帮助。

# java - 使用 persistence.xml 时将 Hibernate 4.0 与 Tomcat 7 一起使用时出现 JndiException

> ID：10800971
> 
> 赞同：5
> 
> 时间：2012-05-29T14:15:24.013
> 
> 标签：java, hibernate, tomcat, jpa, jndi

我在 Tomcat 7 上使用带有 JPA persistence.xml 文件的 Hibernate 4.0。没有 Struts，只是直接带有一些 Jersey 服务的 Hibernate。这是我遇到的异常：

```
Caused by: org.hibernate.service.jndi.JndiException: Unable to lookup JNDI name [jdbc/MyDB]
    at org.hibernate.service.jndi.internal.JndiServiceImpl.locate(JndiServiceImpl.java:68)
    at org.hibernate.service.jdbc.connections.internal.DatasourceConnectionProviderImpl.configure(DatasourceConnectionProviderImpl.java:116)
    at org.hibernate.service.internal.StandardServiceRegistryImpl.configureService(StandardServiceRegistryImpl.java:75)
    at org.hibernate.service.internal.AbstractServiceRegistryImpl.initializeService(AbstractServiceRegistryImpl.java:159)
    at org.hibernate.service.internal.AbstractServiceRegistryImpl.getService(AbstractServiceRegistryImpl.java:131)
    at org.hibernate.engine.jdbc.internal.JdbcServicesImpl.buildJdbcConnectionAccess(JdbcServicesImpl.java:223)
    at org.hibernate.engine.jdbc.internal.JdbcServicesImpl.configure(JdbcServicesImpl.java:89)
    at org.hibernate.service.internal.StandardServiceRegistryImpl.configureService(StandardServiceRegistryImpl.java:75)
    at org.hibernate.service.internal.AbstractServiceRegistryImpl.initializeService(AbstractServiceRegistryImpl.java:159)
    at org.hibernate.service.internal.AbstractServiceRegistryImpl.getService(AbstractServiceRegistryImpl.java:131)
    at org.hibernate.cfg.SettingsFactory.buildSettings(SettingsFactory.java:71)
    at org.hibernate.cfg.Configuration.buildSettingsInternal(Configuration.java:2273)
    at org.hibernate.cfg.Configuration.buildSettings(Configuration.java:2269)
    at org.hibernate.cfg.Configuration.buildSessionFactory(Configuration.java:1738)
    at org.hibernate.ejb.EntityManagerFactoryImpl.<init>(EntityManagerFactoryImpl.java:94)
    at org.hibernate.ejb.Ejb3Configuration.buildEntityManagerFactory(Ejb3Configuration.java:904)
    ... 8 more
Caused by: javax.naming.NameNotFoundException: Name jdbc is not bound in this Context
    at org.apache.naming.NamingContext.lookup(NamingContext.java:820)
    at org.apache.naming.NamingContext.lookup(NamingContext.java:154)
    at org.apache.naming.SelectorContext.lookup(SelectorContext.java:135)
    at javax.naming.InitialContext.lookup(InitialContext.java:396)
    at org.hibernate.service.jndi.internal.JndiServiceImpl.locate(JndiServiceImpl.java:65)
    ... 23 more 
```

我看到关于 jbc 的注释在这种情况下不受约束，但我对这是如何发生的感到困惑。我将我的上下文部署在特定于应用程序的 context.xml 中，如下所示：

```
<?xml version='1.0' encoding='utf-8'?>
<Context>
    <Resource name="jdbc/MyDB" auth="Container" type="javax.sql.DataSource"
              maxActive="100" maxIdle="30" maxWait="10000"
              username="..." password="..." driverClassName="com.mysql.jdbc.Driver"
              url="jdbc:mysql://localhost:3306/mydb"/>
</Context> 
```

我的 persistence.xml 文件看起来像：

```
<persistence xmlns="http://java.sun.com/xml/ns/persistence"
             xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
             xsi:schemaLocation="http://java.sun.com/xml/ns/persistence http://java.sun.com/xml/ns/persistence/persistence_2_0.xsd"
             version="2.0">

    <persistence-unit name="com.example.mysql" transaction-type="RESOURCE_LOCAL">
        <provider>org.hibernate.ejb.HibernatePersistence</provider>
        <non-jta-data-source>jdbc/MyDB</non-jta-data-source>
        <class>...</class>
        <properties>
            <property name="hibernate.connection.datasource" value="jdbc/MyDB"/>
            <property name="hibernate.dialect" value="org.hibernate.dialect.MySQLDialect"/>
            <property name="hibernate.id.new_generator_mappings" value ="true"/>
        </properties>
    </persistence-unit>
</persistence> 
```

最后，我的 web.xml 文件的资源定义如下：

```
<!DOCTYPE web-app PUBLIC
 "-//Sun Microsystems, Inc.//DTD Web Application 2.3//EN"
 "http://java.sun.com/dtd/web-app_2_3.dtd" >

<web-app>
    <display-name>My Web Application</display-name>
    <resource-ref>
        <description>DB Connection</description>
        <res-ref-name>jdbc/MyDB</res-ref-name>
        <res-type>javax.sql.DataSource</res-type>
        <res-auth>Container</res-auth>
    </resource-ref>
...
</web-app> 
```

至于我的布局，这是我的战争文件的结构：

```
app.war
    + META-INF
        - context.xml
    + WEB-INF
        + classes
            + META-INF
                - persistence.xml
        + lib
        - web.xml 
```

一些小注意事项：

*   使用全局上下文与特定于应用程序的上下文没有区别。
*   尝试实例化 EntityManager 实例的代码位于 lib 目录中的 JAR 文件中（多项目 Maven 构建的一部分），但持久性 XML 位于上述主 Web 应用程序中。
*   我可以在 Tomcat 中看到 JNDI 数据源，并且可以使用[psi-probe](http://code.google.com/p/psi-probe/)对其进行查询，即我可以访问连接信息并成功地对数据源执行 SQL 查询。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-29T18:24:50.643

由于您使用可移植资源，因此您应该使用“java:comp/env/your_resource”调用您的 JNDI，例如 java:comp/env/jdbc/MyDB

# android - android.graphics.Path 的替代方案

> ID：10800972
> 
> 赞同：0
> 
> 时间：2012-05-29T14:15:23.823
> 
> 标签：android, android-canvas

我对路径类的问题感到震惊，该路径类用于使用`canvas.drawPath(path,paint)`函数在画布上绘制平滑线。`path.quadTo()`Path 类对于使用and`cubeTo()`函数平滑线条很有用。但它们不会让你画一条粗细不一的平滑线。我想在画布上绘制一条路径，厚度增加到一定的阈值宽度，然后在最后变薄。我也尝试在用户的每个触摸点使用多个路径，但是当用户快速移动手指时会失败，因为那时获得了一条很长的路径。请帮帮我，我在这方面遇到了大麻烦。有没有其他平滑线条的方法。

谢谢你

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T14:39:56.597

我想你是在问如何改变`Path`使用该`canvas.drawPath()`方法绘制的宽度。以下代码片段应该可以帮助您：

```
private Paint myPaint;
myPaint.setStyle(Paint.Style.STROKE);
myPaint.setStrokeJoin(Paint.Join.ROUND);
myPaint.setStrokeCap(Paint.Cap.ROUND);
if(someFlag != thresholdValue)
   myPaint.setStrokeWidth(20);
else
   {
        myPaint.setStrokeWidth(someReducedValue); // or have a counter updated in your thread to regularly decrement the value
   }

//..

..//

canvas.drawPath(path, myPaint); // inside onDraw() where path corresponds to your Path variable 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-02T05:53:18.990

正确的方法是使用 PathMeausre 类，我们可以轻松地从当前路径获取子路径并相应地对其进行操作。当我完成代码时，我会尽快发布代码片段。

# maven - 配置 Flash 播放器以与在 Maven 发布期间执行的 Flexmojos 一起使用：执行

> ID：10800974
> 
> 赞同：0
> 
> 时间：2012-05-29T14:15:39.547
> 
> 标签：maven, maven-release-plugin, flexunit, flexmojos

我有一个使用 Flexmojos 执行单元测试和构建 SWC 的 Maven 项目。当它执行单元测试时，我需要告诉 Flexmojos 我的 Flash 播放器在哪里，我通过以下方式进行`settings.xml`：

```
<profiles>
    <profile>
        <id>dev</id>
        <properties>
            <flex.flashPlayer.command>/Applications/Flash Player Debugger.app/Contents/MacOS/Flash Player Debugger</flex.flashPlayer.command>
        </properties>
    </profile>
</profiles>

<activeProfiles>
    <activeProfile>dev</activeProfile>
</activeProfiles> 
```

这在开发中效果很好，但是当我执行 Maven 时`release:perform`，它失败了：

```
[INFO] [WARNING] The requested profile "release" could not be activated because it does not exist.
[INFO] [ERROR] Failed to execute goal org.sonatype.flexmojos:flexmojos-maven-plugin:4.1-beta:test-run (default-test-run) on project swf-module: Failed to launch Flash Player.  Probably java was not able to find flashplayer.
[INFO] [ERROR] Make sure flashplayer is available on PATH
[INFO] [ERROR] or use -DflashPlayer.command=${flashplayer executable}
[INFO] [ERROR] Read more at: https://docs.sonatype.org/display/FLEXMOJOS/Running+unit+tests: Cannot run program "flashplayer": error=2, No such file or directory 
```

为什么`release:perform`找不到指定的 Flash 播放器`settings.xml`？我怎样才能解决这个问题？

更新：

我还尝试了以下方法：

*   将 Flash 播放器设置为`.swf`文件的默认程序（注意这是在 Mac 上）
*   添加`flashplayer`到路径

……一切都无济于事。

更新 2：

如果我将 Flash Player 调试器放在名称为 的路径上`flashplayer`，则错误变为：

```
[INFO] [WARNING] The requested profile "release" could not be activated because it does not exist.
[INFO] [ERROR] Failed to execute goal org.sonatype.flexmojos:flexmojos-maven-plugin:4.1-beta:test-run (default-test-run) on project swf-module: Unexpected return code 1 - /Users/blah/blah/swf-module/target/test-classes/TestRunner.swf -> [Help 1] 
```

......没有进一步的线索，什么失败了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-30T10:09:19.913

我认为原因是您明确尝试激活未在任何地方定义的配置文件“发布”。由于 Flash Player 属性的定义是在配置文件“dev”中定义的，因此必须激活它才能提供该属性。在 flexmojos 中，您还可以通过将播放器命名为“flashplayer”并将包含它的目录放在系统路径中来让 flexmojos 找到播放器。另一种解决方案是在您的 settings.xml 中创建一个名为“release”的重复配置文件，然后 protery 将可用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T20:15:22.770

也许您以错误的方式调用 maven，我认为问题不在于 Flash 播放器的位置。该错误清楚地表明“release”字符串被读取为配置文件，而它不应该被读取。你能提供你的Maven命令行吗？

# cocoa - 在 Cocoa 中使用 [NSScanner: scanInteger] 进行正确验证

> ID：10800975
> 
> 赞同：0
> 
> 时间：2012-05-29T14:15:39.847
> 
> 标签：cocoa, validation, integer, nsscanner

我正在通过 NSScanner:scanInteger 将字符串转换为有符号整数，但它似乎接受了诸如“123abc”之类的值作为“123”，而不是在无效输入上引发错误。

我可以进行自己的自定义验证，但更愿意找到一个 API 来进行转换并在“123abc”上失败。

顺便说一句，'abc123' 确实会因 scanInteger 而失败，这很好。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T15:16:57.173

我不认为使用扫描仪可以做到这一点——你可以，但有更简单的方法。我会使用 NSString 方法 rangeOfCharactersFromSet: 来检查非数字字符。

```
NSCharacterSet *notDigits = [[NSCharacterSet decimalDigitCharacterSet] invertedSet];
NSUInteger nonDigits = [enteredString rangeOfCharacterFromSet:notDigits].length; 
```

如果 nonDigits 不为零，则用户输入的不是数字。如果您想允许小数点，那么您必须创建自己的集合，其中包含除数字和小数点以外的所有内容。

# c# - 如果是，如何处理许多“是/否” "在表格上

> ID：10800976
> 
> 赞同：0
> 
> 时间：2012-05-29T14:15:45.560
> 
> 标签：c#, asp.net, vb.net

我正在 ASP.Net 中创建一个表单来复制纸质表单（我在设计中没有发言权，我的任务只是以数字方式重新创建它）。该表格有许多问题，例如“回答是或否。如果是，请指定多少”。我目前正在通过列出问题来处理它，然后在一个组中设置两个单选按钮，一个说“是”，一个说“否”。为了让它更漂亮一点，我一直在使用 Ajax 更新面板，如果用户选择 Yes，它只会显示一个文本框来保存这个 yes 值。

现在我已经能够成功地做到这一点，但是每个问题都是它自己的单选按钮组，并且有自己的面板来更新可见性，这意味着我目前这样做的方式有很多冗余代码，比如

```
Protected Sub rdoShowOriginalEquipment(ByVal sender As Object, ByVal e As System.EventArgs)
    If rdoOEYes.Checked = True Then
        pnlOriginalEquipment.Visible = True
    ElseIf rdoOENo.Checked = True Then
        pnlOriginalEquipment.Visible = False
    End If
End Sub 
```

对于每个有类似是/否选项的问题，依此类推。我毫不怀疑有更好的方法来做到这一点。我想知道是否有一种方法可以传递与单选按钮组关联的面板，这样我就可以在代码中使用一个方法来触发所有单选按钮回发，例如（不是真正的代码）

```
Protected Sub showPanel(RadioButtonGroup, panel)
    If rdoYes.Checked = True Then
        panel.Visible = True
    ElseIf rdoNo.Checked = True Then
        panel.Visible = False
    End If
End Sub 
```

或者有没有更好的方法来处理这样的问题？如果它可以减少我现在输入的冗余代码的数量，我愿意采用不同的方法。我正在使用 VB，但我知道 C#，所以如果有人能流利地回答这个问题，我就可以毫无问题地解释它。

任何帮助深表感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T15:08:22.737

这是一个工作代码：

```
<asp:Panel ID="Question1" runat="server">
    <asp:RadioButton GroupName="Q1" runat="server" ID="Q1Yes" Text="Yes" OnCheckedChanged="AnswerChanged" AutoPostBack="true" />
    <asp:RadioButton GroupName="Q1" runat="server" ID="Q1No" Text="No" OnCheckedChanged="AnswerChanged" AutoPostBack="true" />
    <asp:Panel runat="server" ID="Q1Panel">Some text here</asp:Panel>
</asp:Panel>

<asp:Panel ID="Question2" runat="server">
    <asp:RadioButton GroupName="Q2" runat="server" ID="Q2Yes" Text="Yes" OnCheckedChanged="AnswerChanged" AutoPostBack="true" />
    <asp:RadioButton GroupName="Q2" runat="server" ID="Q2No" Text="No" OnCheckedChanged="AnswerChanged" AutoPostBack="true" />
    <asp:Panel runat="server" ID="Q2Panel">Some text here</asp:Panel>
</asp:Panel> 
```

请注意，所有单选按钮都具有相同的 OnCheckedChanged 处理程序，并且它们的 AutoPostBack=True

您可以将 UpdatePanel 放在必要的地方

//后面的代码：

```
protected void AnswerChanged(object sender, EventArgs e)
{
    RadioButton rbAnswer = (RadioButton)sender;
    if (rbAnswer.Checked)
    { 
        string panelID = rbAnswer.GroupName + "Panel";
        if (rbAnswer.Text == "Yes")
                rbAnswer.Parent.FindControl(panelID).Visible = true;
         else
                rbAnswer.Parent.FindControl(panelID).Visible = false;
    }
} 
```

您也可以使用 DataBound 控件（例如 GridView），但您的问题会有一个列表。

快乐编码

# theory - 有向加权图游走

> ID：10800979
> 
> 赞同：4
> 
> 时间：2012-05-29T14:16:00.143
> 
> 标签：theory, graph-theory, random-walk

我有一个连接的有向加权图。边权重表示顶点之间移动的概率；从一个顶点发出的所有边的权重总和为 1。该图包含两个汇：A 和 B。对于图中的每个顶点，我想知道从那里出发的步行到达 A 的概率，对于 B 也是如此。这是什么问题？我该如何解决？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-29T21:19:52.687

这个问题属于代数问题。对于从顶点开始的路径，到达 A 的概率是从其每个相邻顶点到达 A 的概率的平均值，由边权重加权。让我们用更具体的术语来表达。

令*P*为图的邻接矩阵。也就是说，*P [i,j]*是从顶点*i*移动到顶点*j*的概率。设置*P [A,A]* = 1。如果我们采用分配给每个顶点的概率向量并将其乘以*P*，则结果向量包含每个顶点的邻居的加权平均值。我们正在寻找的是一个向量*v*，使得*P v = v*和*v [A] = 1*。

这个向量*v*是*P*的特征向量对应1的特征值*。P*是否总是有这样的特征值？幸运的是，[Perron-Frobenius 定理](http://en.wikipedia.org/wiki/Perron-Frobenius_theorem)告诉我们确实如此，并且这是*P*的最大特征值。解决方法是形成邻接矩阵*P*并找到其最大特征值对应的特征向量。

还有一个近似解。如果我们取一个顶点概率向量*x*，其中*x [A]* = 1，并且其他元素设置为 0，那么当*k*趋于无穷大时， *P ^k x*将收敛到*v 。**对于较小的k值，* *P* *^k*可能比特征向量更容易计算。

 *** * *

## 例子

让我们看一下下面的简单图表：

![图表](../Images/59f31535e60e06f14ee5d7d011f562b8.png)

如果我们按字母顺序对顶点进行排序，那么图对应的矩阵*P为：*

![在此处输入图像描述](../Images/0a016f1900369cbf4d5f685f46365a6a.png)

该矩阵的特征值等于1，对应的特征向量为：[1 0 70/79 49/79]。也就是说，从*C到达**A*的确切概率是 70/79，而从*D*到达 A 的确切概率是 49/79。如果你计算出*B*的答案，结果是 9/79 和 30/79，这正是我们所期望的。

 ****P ^(16)* [1 0 0 0] 的值大约为 [1 0 0.886 0.62] 并且精确到小数点后 6 位。*****

# vba - 使用 Visual Basic 一次输入一个字母

> ID：10800981
> 
> 赞同：0
> 
> 时间：2012-05-29T14:16:04.077
> 
> 标签：vba, internet-explorer-9

我想使用 VBA 来运行 Google 搜索。能够一次将一个字母输入到 Google 搜索栏中对我来说很重要。这是我当前的代码：

`myie.document.all("q").Value = "cheese"`

这将在一个完整的时间间隔内将搜索词“奶酪”加载到搜索栏中。我希望以更自然的人性化方式进行搜索；在搜索栏中输入“c”，然后输入“h”，然后输入“e”等...

任何帮助表示赞赏

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T14:43:03.580

这是你正在尝试的吗？

```
Option Explicit

Private Sub CommandButton1_Click()
    WebBrowser1.Navigate "Google.com"
End Sub

Private Sub CommandButton2_Click()
    Dim strtext As String
    Dim i As Long

    strtext = "cheese"

    For i = 1 To Len(strtext)
        WebBrowser1.Document.all("q").Value = WebBrowser1.Document.all("q").Value & Mid(strtext, i, 1)
        Wait 1
    Next i
End Sub

Private Sub Wait(ByVal nSec As Long)
    nSec = nSec + Timer
    While nSec > Timer
        DoEvents
    Wend
End Sub 
```

如果您对键入时显示的所有结果感到困扰，那么您也可以使用它

```
Sub Sample()
    Dim IE As Object

    Set IE = CreateObject("InternetExplorer.Application")

    IE.Visible = True

    '~~> Choose one of the below
    IE.Navigate ("http://www.google.com/#hl=en&q=" & "Cheese") '<~~ US
    IE.Navigate ("http://www.google.co.uk/#hl=en&q=" & "Cheese") '<~~ UK
    IE.Navigate ("http://www.google.co.in/#hl=en&q=" & "Cheese") '<~~ INDIA
End Sub 
```

# java - Java 中的二进制电子邮件附件中缺少 CR 字符

> ID：10800983
> 
> 赞同：1
> 
> 时间：2012-05-29T14:16:10.667
> 
> 标签：java, jakarta-mail

我正在使用以下代码在 Java 中将二进制文件作为电子邮件附件发送。代码的工作原理是发送文件。但是，在收到的文件中，$0d 的任何十六进制值要么被删除，要么被转换为 $0a。由于该文件是二进制文件而不是文本文件，因此接收到的文件不正确。请问有什么建议吗？

Rgds，海伦

```
String fileAttachment = "command.cmd";
Session session = 
  Session.getInstance(props, null);
// Define message
MimeMessage message = 
  new MimeMessage(session);
message.setFrom(
  new InternetAddress(from));
message.addRecipient(
  Message.RecipientType.TO, 
  new InternetAddress(to));

 message.setSubject(emailSubject);

// create the message part 
MimeBodyPart messageBodyPart = 
  new MimeBodyPart();

//fill message
messageBodyPart.setText("Hi");
Multipart multipart = new MimeMultipart();
multipart.addBodyPart(messageBodyPart);

// Part two is attachment
messageBodyPart = new MimeBodyPart();
FileDataSource source = 
  new FileDataSource(fileAttachment);
   System.out.println("Sending");

messageBodyPart.setDataHandler(
  new DataHandler(source));
messageBodyPart.setFileName(fileAttachment);
messageBodyPart.setDisposition(Part.ATTACHMENT);
multipart.addBodyPart(messageBodyPart);

// Put parts in message
message.setContent(multipart);

// Send the message
Transport.send( message ); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T14:21:03.783

二进制附件真的应该以它们的不可打印字符消失的方式进行编码。想到的最明显的方法是 BASE64 编码。

# asp.net - 从 ASP.Net 中的缓存刷新页面时图表消失

> ID：10800988
> 
> 赞同：0
> 
> 时间：2012-05-29T14:16:52.287
> 
> 标签：asp.net, caching, charts

我正在使用 ASP.Net（框架 4）和 Microsoft Charts 构建页面。

这些图表需要对数据库进行大量查询，我想缓存它们以防止我的用户用无用的查询溢出我的数据库。

我成功地缓存了我的页面**，但是当页面从缓存中刷新时我的图表消失了**。我读过这是因为我的图表的图像没有存储在缓存中。

当页面从缓存中重新加载时，如何避免我的图表消失，以便它们生成尽可能少的查询？

**更多信息：**

*   我有一个包含 ASCX 控件的 ASPX 页面。
*   在这个控件中，我有一个***System.Web.UI.DataVisualization.Charting.Chart***组件，它填充在 OnLoad 方法中，具有大量的数据库访问权限。
*   我想缓存我的 ASPX 页面和我的 ASCX 控件，以避免经常查询数据库。
*   使用此标记***<%@OutputCache Duration="15" ... %>***时，按 F5 时，我的页面会从缓存中自行刷新，但我的图表不会丢失。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T14:26:34.113

您可以缓存数据库中的数据（用于绘制图表）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T09:03:31.150

看起来这是 Web.config 文件中的一些配置问题：

我将这一行编辑如下：

```
<add key="ChartImageHandler" 
value="storage=file;timeout=360;
dir=c:\TempImageFiles\;
webDevServerUseConfigSettings=true;
deleteAfterServicing=false;"/> 
```

然后我只是在我的 ASPX 文件中输入了以下命令（在顶部，***<%@ Page .../>***标记的正下方）：

```
<%@ OutputCache Duration="10" Location="Server" VaryByParam="none" %> 
```

现在我的页面会从缓存中正确刷新，包括我的图表。

# solr - Solr 搜索在网络农场上部署的网站？

> ID：10800998
> 
> 赞同：0
> 
> 时间：2012-05-29T14:17:42.723
> 
> 标签：solr, solrnet

Lucene Solr 是否与带有负载平衡服务器的网络农场一起使用。我正在寻找使用 asp.net mvc3 Web 应用程序来实现，并且使用负载平衡服务器迁移到 Web 场是路线图中的下一个，所以想了解如何使用 solr 来实现？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T18:31:32.490

前端向 Solr 发出 HTTP 请求以获取搜索结果。任何 HTTP 负载平衡器都可以工作。

大多数系统使用单个主 Solr 服务器和多个从属服务器。文档被提交给主服务器，在那里进行分析并创建搜索索引。从站轮询主站并复制新的搜索索引。

Solr 网站有很多信息： http: [//lucene.apache.org/solr/](http://lucene.apache.org/solr/)