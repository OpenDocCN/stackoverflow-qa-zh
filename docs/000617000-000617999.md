# StackOverflow 问答 000617000-000617999

# javascript - VS2008 正在将我的 javascript 自动格式化为 .js 文件，我希望它停止

> ID：617002
> 
> 赞同：4
> 
> 时间：2009-03-05T22:41:29.037
> 
> 标签：javascript, visual-studio-2008, resharper

重复：[VS2008 删除我在 .js 文件中的缩进](https://stackoverflow.com/questions/605461/vs2008-removes-my-indentation-in-js-file)（在格式选项卡中关闭自动格式）

嗨，我有 VS2008 和 ReSharper 4.0，但我遇到了问题。当我在任何 .js 文件中输入新代码行时，它会通过并重新格式化所有 JavaScript 大括号。我在 ReSharper 中找到了可以为 C# (.cs) 文件设置大括号行为的位置。我在 VS2008 中搜索过，找不到 JavaScript 代码的任何设置。

```
 function doSomething(withMe) 
    {
        for (idx in myArray) 
        {
            if (myArray[idx] != -1) 
            {
                return "yep";
            }
        }
        return "nope";
    } 
```

变成这个（我更喜欢，但我的团队更喜欢上面的）

```
 function doSomething(withMe) {
        for (idx in myArray) {
            if (myArray[idx] != -1) {
                return "yep";
            }
        }
        return "nope";      
    } 
```

返回并在任何地方重新添加 CR 变得越来越痛苦。我在哪里可以找到让这种疯狂停止的设置。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-05T22:46:57.557

转到工具-> 选项。

展开文本编辑器

展开 JScript

取消选中所有格式选项。

![替代文字](https://docs.google.com/a/insomdev.com/File?id=dhgqrtmk_46pqpnctdr_b)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-05T22:48:29.847

对于 javascript，您应该养成将大括号放在行尾的习惯，就像 Visual Studio 建议的那样。这样做的原因是解释器可以偶尔添加一个 ; 在解释可能导致奇怪行为的文件时。例如：

```
return
{
    'foo': 3
}; 
```

这返回未定义，而不是您期望的散列文字，因为解释器将其转换为：

```
return;
{
    'foo': 3
}; 
```

你可能认为我在编造这个。我向你保证我不是。

我建议您教育您的团队并养成按照 VS 建议格式化 javascript 的习惯。它会把你从你自己身上救出来。

* * *

另外，还有一件事。而不是这样做：

```
myArray[idx] != -1 
```

我建议你这样做：

```
myArray[idx] !== -1 
```

这将阻止它进行类型强制。事实上...永远不要使用 == 或 != 总是使用 === 和 !==。

# windows - 有人知道翻译时区描述的来源吗？

> ID：617011
> 
> 赞同：4
> 
> 时间：2009-03-05T22:43:10.750
> 
> 标签：windows, internationalization, timezone

有谁知道 Windows 中时区名称的编译列表？我需要德语、法语和西班牙语的全部 75 个左右。或者，我将如何使用 .Net 来编译这样的列表？

示例格式：(GMT+01:00) 贝尔格莱德、布拉迪斯拉发、布达佩斯、卢布尔雅那、布拉格

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-05T23:17:19.543

[从https://iana.org/time-zones](https://iana.org/time-zones)或[ftp://ftp.iana.org/tz](ftp://ftp.iana.org/tz)（或网络上的许多其他来源）获取时区数据库。这些将输入联合国 ISO 代码和英文国家/城市名称

然后从[http://www.unicode.org/cldr/翻译它们](http://www.unicode.org/cldr/)

例如

*   法语 [http://unicode.org/cldr/data/common/main/fr.xml](http://unicode.org/cldr/data/common/main/fr.xml)
*   西班牙语 [http://unicode.org/cldr/data/common/main/es.xml](http://unicode.org/cldr/data/common/main/es.xml)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-07T23:58:51.597

Microsoft 术语集[可供](http://www.microsoft.com/Language/en-US/Terminology.aspx)[非商业用途](http://www.microsoft.com/about/legal/en/us/IntellectualProperty/Copyright/Default.aspx)下载。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-05T23:50:59.277

注册表中的所有时区列表位于：

HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Time Zones

可以使用以下方式加载：

```
ArrayList zones = new ArrayList();

using( RegistryKey key = Registry.LocalMachine.OpenSubKey(
    @"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Time Zones" ) )
{
    string[] zoneNames = key.GetSubKeyNames();

    foreach( string zoneName in zoneNames )
    {
        using( RegistryKey subKey = key.OpenSubKey( zoneName ) )
        {
            TimeZoneInformation tzi = new TimeZoneInformation();
            tzi.Name = zoneName;
            tzi.DisplayName = (string)subKey.GetValue( "Display" );
            tzi.StandardName = (string)subKey.GetValue( "Std" );
            tzi.DaylightName = (string)subKey.GetValue( "Dlt" );
            object value = subKey.GetValue( "Index" );
            if( value != null )
            {
                tzi.Index = (int)value;
            }

            tzi.InitTzi( (byte[])subKey.GetValue( "Tzi" ) );

            zones.Add( tzi );
        }
    }
} 
```

其中 TimeZoneInformation 只是一个存储信息以便于访问的类。

您要查找的描述位于“显示”值中。

# cocoa - 在哪里可以找到用于 Cocoa 的彩色指示器？

> ID：617033
> 
> 赞同：10
> 
> 时间：2009-03-05T22:47:30.037
> 
> 标签：cocoa, user-interface, colors, status

我需要颜色指示器。需要能够做到绿色、黄色和红色。有人知道怎么做吗？我查看了 Interface Builder 中可用的图标/等，但没有看到类似的东西。

像这样： [绿色指示器 http://allynbauer.com/permafrost/green_indicator.png](http://allynbauer.com/permafrost/green_indicator.png)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-06T00:45:10.737

您可以在 InstantMessage.framework 中找到 iChat/Mail/etc 中使用的图像。目录是`/System/Library/Frameworks/InstantMessage.framework/Resources`

你可以得到`status-available.png`, `status-away.png`, 和`status-idle.png`

当然，除了在您的应用程序中不必要地包含额外的图像文件，您还可以在您的应用程序中包含 InstantMessage.framework 并使用它`[IMService imageNameForStatus:]`来获取每个状态的系统图像的名称。请参阅[IMService 类参考](http://developer.apple.com/documentation/AppleApplications/Reference/InstantMessageFrameworkRef/Classes/IMService_Class/Reference/Reference.html#//apple_ref/occ/clm/IMService/imageNameForStatus:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-08-26T15:07:04.807

`InstantMessage`使用 10.6.8 并在框架资源文件夹中找不到图标。

所以或者从`/Applications/uTorrent.app/Contents/Resources`

（如果你当然有 uTorrent）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-29T12:23:25.527

使用 10.8，我发现它们`/System/Library/Frameworks/IMCore.framework/Resources`是一个符号链接`/System/Library/PrivateFrameworks/IMCore.framework/Resources`

这篇文章很老了，但我很难找到这些图标，所以...... :)

# javascript - 附加到对象

> ID：617036
> 
> 赞同：171
> 
> 时间：2009-03-05T22:47:48.150
> 
> 标签：javascript

我有一个包含警报和一些关于它们的信息的对象：

```
var alerts = { 
    1: { app: 'helloworld', message: 'message' },
    2: { app: 'helloagain', message: 'another message' }
} 
```

除此之外，我还有一个变量表示有多少警报，`alertNo`. 我的问题是，当我添加新警报时，有没有办法将警报附加到`alerts`对象上？

* * *

## 回答 #1

> 赞同：247
> 
> 时间：2009-03-05T22:54:11.347

如何将警报存储为数组中的记录而不是单个对象的属性？

```
var alerts = [ 
    {num : 1, app:'helloworld',message:'message'},
    {num : 2, app:'helloagain',message:'another message'} 
] 
```

然后添加一个，只需使用`push`：

```
alerts.push({num : 3, app:'helloagain_again',message:'yet another message'}); 
```

* * *

## 回答 #2

> 赞同：61
> 
> 时间：2010-06-11T18:20:10.583

jQuery`$.extend(obj1, obj2)`会为您合并 2 个对象，但您确实应该使用数组。

```
var alertsObj = {
    1: {app:'helloworld','message'},
    2: {app:'helloagain',message:'another message'}
};

var alertArr = [
    {app:'helloworld','message'},
    {app:'helloagain',message:'another message'}
];

var newAlert = {app:'new',message:'message'};

$.extend(alertsObj, newAlert);
alertArr.push(newAlert); 
```

* * *

## 回答 #3

> 赞同：53
> 
> 时间：2018-07-02T20:30:19.833

您可以使用[Object.assign()](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/assign)来做到这一点。有时您需要一个数组，但在使用需要单个 JSON 对象的函数时（例如 OData 调用），我发现此方法比仅创建一个数组来解压缩它更简单。

```
var alerts = { 
    1: {app:'helloworld',message:'message'},
    2: {app:'helloagain',message:'another message'}
}

alerts = Object.assign({3: {app:'helloagain_again',message:'yet another message'}}, alerts)

//Result:
console.log(alerts)
{ 
    1: {app:'helloworld',message:'message'},
    2: {app:'helloagain',message:'another message'}
    3: {app: "helloagain_again",message: "yet another message"}
} 
```

[编辑：要解决有关获取下一个键的评论，您可以使用Object.keys()](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/keys)函数获取键的数组——有关递增键的示例，请参见 Vadi 的答案。同样，您可以使用[Object.values()获取所有值，使用](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/values)[Object.entries()](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/entries)获取键值对。

```
var alerts = { 
    1: {app:'helloworld',message:'message'},
    2: {app:'helloagain',message:'another message'}
}
console.log(Object.keys(alerts))
// Output
Array [ "1", "2" ] 
```

* * *

## 回答 #4

> 赞同：22
> 
> 时间：2019-01-27T14:26:17.457

您可以使用扩展语法如下..

```
var alerts = { 
1: { app: 'helloworld', message: 'message' },
2: { app: 'helloagain', message: 'another message' }
 }

alerts = {...alerts, 3: {app: 'hey there', message: 'another message'} } 
```

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2019-05-16T06:11:04.500

现在有了 ES6，我们有了一个非常强大的扩展运算符（...Object），它可以使这项工作变得非常容易。可以按如下方式完成：

```
let alerts = { 
   1: { app: 'helloworld', message: 'message' },
   2: { app: 'helloagain', message: 'another message' }
} 

//now suppose you want to add another key called alertNo. with value 2 in the alerts object. 

alerts = {
   ...alerts,
   alertNo: 2
 } 
```

就是这样。它将添加您想要的密钥。希望这可以帮助！！

* * *

## 回答 #6

> 赞同：13
> 
> 时间：2018-03-09T18:30:55.170

就像其他答案指出的那样，您可能会发现使用数组更容易。

如果不：

```
var alerts = { 
    1: {app:'helloworld',message:'message'},
    2: {app:'helloagain',message:'another message'}
}

// Get the current size of the object
size = Object.keys(alerts).length

//add a new alert 
alerts[size + 1] = {app:'Your new app', message:'your new message'}

//Result:
console.log(alerts)
{ 
    1: {app:'helloworld',message:'message'},
    2: {app:'helloagain',message:'another message'}
    3: {app: "Another hello",message: "Another message"}
} 
```

尝试一下：

[https://jsbin.com/yogimo/edit?js,console](https://jsbin.com/yogimo/edit?js,console)

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2009-03-05T23:06:13.627

您确实应该使用警报建议数组，但否则添加到您提到的对象将如下所示：

```
alerts[3]={"app":"goodbyeworld","message":"cya"}; 
```

但是由于您不应该使用文字数字作为名称引用所有内容并使用

```
alerts['3']={"app":"goodbyeworld","message":"cya"}; 
```

或者您可以将其设为对象数组。

访问它看起来像

```
alerts['1'].app
=> "helloworld" 
```

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2009-03-05T22:55:07.663

您是否有能力将最外层的结构更改为数组？所以它看起来像这样

```
var alerts = [{"app":"helloworld","message":null},{"app":"helloagain","message":"another message"}]; 
```

因此，当您需要添加一个时，您只需将其推送到阵列上即可

```
alerts.push( {"app":"goodbyeworld","message":"cya"} ); 
```

然后，您有一个内置的从零开始的索引，用于枚举错误的方式。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2019-07-11T08:19:50.367

使用 ES6 更容易：

```
let exampleObj = {
  arg1: {
    subArg1: 1,
    subArg2: 2,
  },
  arg2: {
    subArg1: 1,
    subArg2: 2,
  }
};

exampleObj.arg3 = {
  subArg1: 1,
  subArg2: 2,
};

console.log(exampleObj);
```

```
{
arg1: {subArg1: 1, subArg2: 2}
arg2: {subArg1: 1, subArg2: 2}
arg3: {subArg1: 1, subArg2: 2}
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-01-24T11:47:39.777

作为替代方案，在 ES6 中，可能会使用扩展语法。`${Object.keys(alerts).length + 1}`返回下一个`id`警报。

```
let alerts = { 
    1: {app:'helloworld',message:'message'},
    2: {app:'helloagain',message:'another message'}
};

alerts = {
  ...alerts, 
  [`${Object.keys(alerts).length + 1}`]: 
  { 
    app: `helloagain${Object.keys(alerts).length + 1}`,message: 'next message' 
  } 
};

console.log(alerts);
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2019-09-26T15:37:38.460

很抱歉，由于我的声誉，我已经无法评论您的答案！...所以，如果您想修改对象的结构，**您必须**像 Thane Plummer 所说的那样做，但是如果您不在乎在哪里，请使用一个小技巧放置项目：如果您不指定插入的数量，它将被插入到第一个位置。

例如，如果您想将 Json 对象传递给 mongoDB 函数调用并在您收到的条件中插入一个新键，那就太好了。在这种情况下，我将在我的代码中插入一个项目 myUid，其中包含来自变量的一些信息：

```
// From backend or anywhere
let myUid = { _id: 'userid128344'};
// ..
// ..

  let myrequest = { _id: '5d8c94a9f629620ea54ccaea'};
  const answer = findWithUid( myrequest).exec();

// ..
// ..

function findWithUid( conditions) {
  const cond_uid = Object.assign({uid: myUid}, conditions);
  // the object cond_uid now is:
  // {uid: 'userid128344', _id: '5d8c94a9f629620ea54ccaea'}
  // so you can pass the new object Json completly with the new key
  return myModel.find(cond_uid).exec();
}
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2020-01-31T12:08:12.947

[Javascript] 经过一番折腾后，这对我有用：

```
 let dateEvents = (
            {
                'Count': 2,
                'Items': [
                    {
                        'LastPostedDateTime': {
                            "S": "10/16/2019 11:04:59"
                        }
                    },
                    {
                        'LastPostedDateTime': {
                            "S": "10/30/2019 21:41:39"
                        }
                    }
                ],
            }
        );
        console.log('dateEvents', dateEvents); 
```

我需要解决的问题是我可能有任意数量的事件并且它们都具有相同的名称：LastPostedDateTime 唯一不同的是日期和时间。

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2010-05-20T12:40:01.653

试试这个：

```
alerts.splice(0,0,{"app":"goodbyeworld","message":"cya"}); 
```

效果很好，它会将它添加到数组的开头。

# ruby-on-rails - Getting offline_access to work with Facebook

> ID：617043
> 
> 赞同：10
> 
> 时间：2009-03-05T22:50:59.047
> 
> 标签：ruby-on-rails, facebook

I am using Facebooker with Rails to connect my application to Facebook. I can direct the user through the authorization process and through the process of granting offline access to my application.

How do I actually go about accessing the information offline? Is there a way to request a session_key that does not expire that I can use at a later point, so long as the user has not revoked the permissions for my application on Facebook?

Any help greatly appreciated. Advice need not be rails specific.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-11T13:47:17.337

一旦您请求并获得授权，您在 Facebook 的 HTTP POST 参数中获得的会话密钥 (fb_sig_session_key) 将不会过期。

您可以通过检查 fb_sig_expires 参数来检查您是否有这样的密钥，如果这是“0”，则会话密钥没有到期。

如果您有 auth_token，那么您可以调用 getSession 来获取会话密钥并检查 expires 字段：

```
var auth = _auth.getSession(AuthToken);
string sessionKey = auth.session_key;
long uid = auth.uid;
bool expires = auth.expires > 0; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-09-10T12:11:18.197

我刚刚在我的博客上做了一个[教程](http://modelix.net/2009/09/facebook-connect-working-with-offline-users-data-access/)，一步一步地解释了如何访问离线用户的数据。它假定您正在使用 RoR 和 Facebooker 插件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-06T03:27:43.920

编辑：[显然](http://forum.developers.facebook.com/viewtopic.php?id=29517)，授予“offline_access”仍然给你（并将继续这样做）一个无限的会话密钥。只需保存此特殊键并在调用 Status.get 等时使用它。请参阅[此处](http://wiki.horde.org/Doc/Dev/Horde_Service_Facebook#toc3)以获取（PHP）代码示例。

[http://wiki.developers.facebook.com/index.php/New_Design_User_Login](http://wiki.developers.facebook.com/index.php/New_Design_User_Login)：

> 许多 API 调用不再需要会话密钥

因此，如果您的应用程序被授予离线访问权限，您可以使用[此处列出](http://wiki.developers.facebook.com/index.php/New_Design_Platform_Changes#Changes_to_Session_Keys)的 API 调用而无需 session_key。

> 我们正在更改更多方法，因此当用户离线时您不需要会话密钥来执行某些操作，例如发送通知。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-09-05T19:20:51.987

一旦您从用户那里获得离线访问权限，诀窍就是使用`filter_key`“网络”参数进行调用。

在 PHP 中，它是：

```
$feed = $facebook->api_client->stream_get($uid, '', '', '', 20, 'network', ''); 
```

试试吧，它的工作原理......

# naming-conventions - What would you name this object?

> ID：617050
> 
> 赞同：2
> 
> 时间：2009-03-05T22:54:10.863
> 
> 标签：naming-conventions

So I have a table like so:

```
 =========================
   ID | Col2 | col3 | col4 |
   =========================
-> 21 | balh | blah |  foo |
   22 | balh | blah |  foo | 
```

I am making a object that can read the data from one row using the column name in an expression. Something like this:

```
 myrow.getValue(col => col.Col2) 
```

The problem I am having is at the moment is naming the object, I can't really find a name that describes what it does without being really long.

What would you call it?

**EDIT** Ok I'll add a few more details, I am working with a COM object which will only let me read one column at a time. So I am writing a wrapper which can fetch a row from a table(inside the COM object) using the ID, then let the user supply a column name using expression(details not important). The object goes off to the table and get the data for that row using the ID and column name.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-05T22:57:51.713

RowReader?

Code would look like (some variations of the Get naming)

```
var reader = new RowReader(sourceRow);

//var value = reader.GetValue(col => col.Col2);
//var value = reader.ByColumn(col => col.Col2);
//var value = reader.ReadColumn (col => col.Col2); 
```

Based on info by others, perhaps: RowColumnsReader. In which case the method would be Read.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-05T22:59:15.017

I would take this one step back and ask: **Why are you creating a new object specifically for reading values from a column?**

It sounds to me that it would be better to create a new *method* (e.g. readColumn()) in the class which is encapsulating the table itself.

**This would be better OO practice.**

A class models an object which has:

*   Certain attributes/data (member *data*)
*   Certain behaviour (member *methods*).

In your particular case, the table is the *data*, and reading is the *behaviour* that is performed on that *data*.

For this reason, a read method should be implemented as a method in the existing data class.

If you create another class to read the data, you will probably need to open up the class which is storing the data (e.g. by using friend classes in C++). This violates the encapsulation of the class, as you are suddenly allowing outside classes free access to your data, albeit in a potentially controlled fashion.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-05T23:03:55.770

ColumnSpaceShipRowReader

If you are storing space ships.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-05T23:04:45.317

Bob? :-)

If you creating a method for getting some data from a row using a column name, then the thing you want is a method not an object?

```
data = row.read(columnName); 
```

matches your description. If you're more specific than that, you can use that names that closer reflect your actual domain or level of abstraction.

In general, if you can describe what you are doing in a sentence or two, the nouns are objects and the verbs are methods.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-05T23:09:15.913

That's a method of an object rather than an object itself, but my personal choice would be `myRow.ReadRowByCol(...)` since that captures the intent. But I like Paul's "Bob" as well :-)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-05T22:57:23.227

`ColumnReader`?

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-05T22:57:47.797

这与做有什么不同：

```
myrow.Select(col => col.Col2); 
```

?

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-05T22:58:31.570

What about:

ColumnDataFetcher

**EDITED**

after: abatishchev comments. Thank you abatishchev.

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-05T22:59:45.843

RowRenderer

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-05T22:59:56.170

`RowReader`? `RowByColumn`? `ColumnGrabber`?

Really, the issue is that you should be designing the `Row` object--an object that encapsulates the data associated with a given row (the `ID`, I guess in your case) and the methods *on* that object should be returning the values. Call the `Row` object the "`Row`" or "`Case`" or "`DataReference`" or whatever makes sense for your application. Then the methods are easy to name (e.g., `Row.getColumn('col2')`)

**Note**: `RowReader`, on reflection, is a terrible name for this class. It's ambiguous, because it's reading *columns*, not rows. `ColumnReader` is also bad, for the opposite reason (it reads columns by reading a row). The `Row` needs the class, not the function.

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-03-05T23:03:10.030

It sounds to me like you're describing a method, not an object.

If your object is to represent the value of a column at a certain row, then I guess it'd be pretty save to call it a Cell.

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2009-03-05T23:04:12.977

I prefer `valueAt` over `getValue`:

```
myrow. valueAt( col => col.Col2 ); 
```

Also, it could be nice and meaningful to have the `[]` operator overloaded:

```
var x = myRow["name"];
var x = myRow[ col => col.Col2 ]; 
```

# c# - 如何将此 XAML 代码转换为 C# 代码？

> ID：617052
> 
> 赞同：3
> 
> 时间：2009-03-05T22:54:26.277
> 
> 标签：c#, wpf

如何将此 XAML 代码转换为 C# 代码？

```
<Window.Resources>
    <DataTemplate x:Key="itemtemplate">
        <TextBlock Text="{Binding Path=Text}"/>
    </DataTemplate>
</Window.Resources> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-05T23:20:49.863

从 C# 创建 DataTemplates 的正确方法是使用 XamlReader 并提供您在问题中所写的内容。

至少可以这么说，这令人不快。对不起。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-05T23:26:06.963

试试下面的。不是命令式 WPF 专家，因此您可能需要稍微改变一下

```
public void Example()
{
    var factory = new FrameworkElementFactory(typeof(TextBlock));
    factory.SetBinding(TextBlock.TextProperty, new Binding("Text"));

    var dataTemplate = new DataTemplate();
    dataTemplate.VisualTree = factory;
    dataTemplate.Seal();
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-06T06:09:39.943

我刚刚检查了在线文档 - Alun 是正确的 - 使用 XamlReader。根据 Microsoft 的说法，FrameworkElementFactory 类不支持 XAML 的所有功能，将来可能会被弃用。

话虽如此，我已经使用 FrameworkElementFactory 即时更改 DataTemplates，并且没有任何问题。

# ruby-on-rails - 在 Rails 应用程序中设置下载文件的文件名

> ID：617055
> 
> 赞同：15
> 
> 时间：2009-03-05T22:55:10.580
> 
> 标签：ruby-on-rails, controller, download

我有一个控制器操作，允许用户下载扩展名为 .ppt 的文件。它不是真正的 powerpoint 二进制文件，只是 powerpoint 可以读取的 xml-ish 格式。该文件是从名为 ElementsController 的控制器的显示操作中下载的，但显示操作实际上并未在控制器中定义，但是在 app/views/elements/show.ppt.builder 中有一个模板文件。我在 config/initializers/mime_types.rb 中注册了 Mime::Type，如下所示：

`Mime::Type.register "multipart/related", :ppt`

并且文件正确下载，并在windows系统上使用powerpoint打开，但问题是文件名。文件的名称是 3.ppt，其中 3 是 url 中的 id 参数。我想知道是否有办法将文件名设置为比 3.ppt 更具描述性的名称。

谢谢，

-C

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-03-05T23:02:13.950

您可以使用[send_data](http://apidock.com/rails/ActionController/DataStreaming/send_data)：

```
send_data pptdata, :filename => 'your_file_name.ppt', 
   :disposition => 'inline', :type => "multipart/related" 
```

这样做的另一个优点是您可以使用 x-sendfile，这样您就不会在客户端下载数据时等待。

* * *

另一种选择是有如下路线：

/elements/3/files/foo.ppt

然后在 FilesController 的 show 方法中，您可以发送任何 id 参数。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2010-10-06T19:07:48.987

一个可能的例子：

```
def show
    @item = Item.find(params[:id])
    respond_to do |format|
        format.html # show.html.erb
        format.ppt {
            response.headers['Content-Disposition'] = "attachment; filename=\"#{@item.filename}.ppt\""
        } # show.ppt.erb
        format.xml  { render :xml => @item }
    end
end 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-05-17T14:24:21.387

行。这是一个非常古老的问题的答案，但从 Rails 3.2 开始，最简单的方法是将其设置为：

```
respond_to do |format|
  format.html # index.html.erb
  format.json { render json: @product }
  format.csv { send_data @product.to_csv, :filename => "New-Product-filename.csv" }
  format.xls 
end 
```

[源 API 文档](http://apidock.com/rails/ActionController/Streaming/send_data)

# c# - 在 C# 中对 TextBox 实施输入限制的最佳方法是什么？

> ID：617062
> 
> 赞同：7
> 
> 时间：2009-03-05T22:57:51.027
> 
> 标签：c#, winforms

`TextBox`将控件（或 .NET 3.5 附带的任何其他标准）的输入限制为浮点数的最优雅的方法是什么？

目前，我正在通过继承`TextBox`和覆盖来完成所有繁重的工作`OnKeyPress`。但是，我不禁想知道我是否在重新发明轮子。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-05T23:13:26.340

如果您沿着建议的路线走，请不要忘记以下您将面临的问题/极端情况：

*   用户可以使用`Ctrl`-`V`或`Shift`-`Insert`粘贴“无效”值（第二个有点难以捕捉）......但用户可能应该被允许将合法值粘贴到控件中
*   用户可以右键单击，使用默认上下文菜单粘贴无效值
*   即使您尝试通过为文本框提供自己的上下文菜单来解决上一个问题，用户也可以在您的控件之外单击鼠标右键，按住右键，拖动您的文本框并松开以访问默认的上下文菜单（并粘贴无效值）
*   无论您执行什么键处理，都不应禁用`Alt`-`F4`等键组合（是的，如果您`SuppressKeyPress`为所有非有效数字设置，您将破坏它）
*   用户应该能够输入部分值（例如`"-."`，当他们开始键入时`"-.23"`），而您的文本框不会惩罚他们
*   像这样的数字`"-.1e-2"`可以被认为是合法的
*   用户可以输入一个仅包含数字的值，但会溢出`float`
*   **最糟糕的一个：** 您的用户在您发货后会发现的其他一些神秘的角落案例（！！）

道德？执行您的建议可能非常棘手。

您可能想要执行以下组合：

*   使用一个知道所有极端情况的人构建的控件（如微软）
*   在`TextChanged`事件中进行基本验证（并做一些被动的事情，比如更改文本框背景颜色）
*   保存验证，直到您真正尝试使用他们输入的值
*   使用系统库`Parse`为您带来用户的价值

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-05T23:02:43.323

看一下[MaskedTextBox](http://msdn.microsoft.com/en-us/library/system.windows.forms.maskedtextbox(VS.80).aspx)控件。它还继承自 TextBoxBase 并且可能具有您正在构建的功能。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-05T23:08:08.990

使用 NumericUpDown 怎么样？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-05T23:03:52.680

我认为轮子还没有被发明出来（至少在 .NET 框架中）。我敢肯定 CodeProject 或类似的东西有一些东西，做的和你一样，所以它可能值得谷歌。

不过，繁重的工作应该不会太糟糕。它比乍一看要多一点。

过于简化的例子是你可以处理`OnKeyPress`, 用附加的新字符做 a `Float.TryParse`。如果为真，保持按键；如果为假，则取消它（`e.Handled = true`）。

困难的部分是如果他们删除、剪切或粘贴选择。另一件事是当他们刚刚开始时（您可能希望接受“-”作为部分有效输入）......

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-05T23:06:40.803

或使用检查匹配

```
void TextBox_KeyUp(object sender, KeyEventArgs e)
{
  if(..) // your condition
  {
    e.SuppressKeyPress = false;
  }
  else
  {
    e.SuppressKeyPress = true;
  }
} 
```

或者

```
void TextBox_KeyUp(object sender, KeyEventArgs e)
{
   e.SuppressKeyPress = CheckInput(e.KeyValue); // where CheckInput is boolean method
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-05T23:13:41.550

我发现了一个 maskedTextBox 的 ValidatingType 属性：

```
maskedTextBox1.ValidatingType = typeof(System.Double); 
```

它确实告诉你它是否有效。不幸的是，它似乎只验证焦点何时发生变化（即使这样它实际上也没有做任何事情）；但也许有一些方法可以使用它。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-05T23:18:55.080

是否有必要在数据输入期间进行验证，或者一旦失去焦点，您是否可以检查输入的最终值？

如果是后者，您还可以使用[ErrorProvider](http://msdn.microsoft.com/en-us/library/system.windows.forms.errorprovider.aspx)控件来帮助限制功能，直到输入被解析。

# ruby-on-rails - Ruby on Rails 连接表关系

> ID：617068
> 
> 赞同：0
> 
> 时间：2009-03-05T22:58:50.227
> 
> 标签：ruby-on-rails, activerecord, join

我正在尝试使用我的连接表“显示”来获取电影列表

我试图使用此代码，但它不起作用。

* * *

```
@showing_list = Showing.find_sorted_showings("time")

@movie_list = @showing_list.movies <-- NoMethodError 
```

* * *

这是我的表演课

* * *

```
class Showing < ActiveRecord::Base
belongs_to :movie

def self.find_sorted_showings(order)
    find(:all, :order => order)
end
end 
```

* * *

如何更改我的显示类以从显示列表中获取 move_list 而无需手动执行？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-05T23:01:18.007

@showing_list 是一个数组。

```
@showing_list.collect(&:movie).uniq 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-05T23:20:28.147

使用急切加载功能：

```
 def self.find_sorted_showings(order)
    find(:all, :order => order, :include => :movie)
   end 
```

生成的数据集现在将包括电影以及可通过以下方式访问的放映时间：

```
@showing.each do |show_time|
  show_time.movie.title
end 
```

当然，如果您希望创建一个更具可读性的列表，这会带来分组问题。但是你可以用 group_by 方法做一些漂亮的事情，比如：

```
find(:all, :order => order, :include => :movie).group_by {|s| s.show_time} 
```

希望有帮助。

-克里斯

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-05T23:09:49.670

尝试：

```
named_scope :find_sorted_showings, lambda { |order|
  { :order => order }
} 
```

# grails - 两个应用程序之间的 Spring Security

> ID：617079
> 
> 赞同：1
> 
> 时间：2009-03-05T23:02:13.793
> 
> 标签：grails

我正在使用 Spring Source 2.0 安全插件，并且我已经使用 Requestmap 安全方法完成了此页面上描述的教程。

[Acegi 插件教程](http://www.grails.org/AcegiSecurity+Plugin+-+Basic+Tutorial)

我现在想按如下方式创建第二个书店并实施相同的教程。

```
grails create-app bookstore2

```

两个应用程序将共享相同的数据库，因此两个应用程序之间的所有用户、角色等都是通用的。最后，如果给定用户在第一个书店进行身份验证，我希望他在第二个书店中自动进行身份验证。实现这一点的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-06T12:01:54.387

您可能想看看[CAS](http://www.jasig.org/cas)。它是一个联合登录服务器，允许跨多个 Web 应用程序使用单点登录 - 独立于它的平台。它是基于 Java 和 Spring 的，但需要您熟悉它的架构。Spring Security 内置了对 CAS 的支持。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T02:02:58.700

您可以利用 Acegi 提供的“记住我”功能。由于它是基于cookie的，一旦你对第一个应用程序进行身份验证，它将丢弃一个cookie，然后当你尝试登录第二个应用程序时，只要安全模型相同，你将立即通过cookie进行身份验证.

有关详细信息，请参阅：[Acegi 文档](http://www.acegisecurity.org/guide/springsecurity.html#remember-me)。

# objective-c - 什么导致 Mac OS X 上找不到合适的图像错误？

> ID：617084
> 
> 赞同：1
> 
> 时间：2009-03-05T23:03:40.810
> 
> 标签：objective-c, cocoa, unit-testing, xcode, debugging

我遵循了 Chris Hanson 关于在 Xcode 3.1 中调试框架单元测试的[建议](http://chanson.livejournal.com/119578.html)，但是当尝试运行自定义可执行文件时，程序崩溃，并说明以下错误消息 [用 $(BUILD_PRODUCTS_DIR) 代替构建产品的真实位置]。

```
2009-03-02 19:56:03.414 otest[28059:10b] Error loading
    $(BUILD_PRODUCTS_DIR)/Debug/Unit Tests.octest/
    Contents/MacOS/Unit Tests: dlopen($(BUILD_PRODUCTS_DIR_)/Unit
    Tests.octest/Contents/MacOS/Unit Tests, 265):
    no suitable image found. Did find:
    $(BUILD_PRODUCTS_DIR)/Unit Tests.octest/Contents/MacOS/Unit Tests:
    mach-o, but wrong architecture
2009-03-02 19:56:03.561 otest[28059:10b] The test bundle at
    $(BUILD_PRODUCTS_DIR)/Unit Tests.octest could not be loaded because
    it is built for a different architecture than the currently-running
    test rig (which is running as unknown).
2009-03-02 19:56:03.568 otest[28060:203] *** NSTask: Task create for path
    '$(BUILD_PRODUCTS_DIR)/Unit Tests.octest/Contents/MacOS/Unit Tests'
    failed: 8, "Exec format error". Terminating temporary process. 
```

我的问题是，是什么导致*找不到合适的图像。发现：...*错误消息，我怎样才能让*otest*可执行文件正确运行，以便调试我的框架单元测试？

在不使用 otest 的情况下，有没有更简单的方法来做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-06T00:51:45.463

otest 运行良好。该错误告诉您它无法加载*测试包*，并且它无法加载测试包的原因是因为它不知道它正在运行的架构。

解决方法是设置`ARCHPREFERENCE`在otest的环境中。您可以在 Xcode 的自定义可执行编辑器中执行此操作。将其设置为您要在其下运行测试的架构。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-05T23:48:18.393

该行`Unit Tests.octest could not be loaded because it is built for a different architecture than the currently-running test rig`表明依赖项是为不同的系统构建的 - 也许它是 PPC / Intel 不匹配或类似的？

# asp.net - 对集合或对象列表进行数据绑定时对网格视图进行排序

> ID：617088
> 
> 赞同：13
> 
> 时间：2009-03-05T23:04:09.327
> 
> 标签：asp.net, data-binding, gridview, sorting, webforms

我通过以下方式设置了 GridView：

*   绑定到`List<T>`代码隐藏（我使用自己的自定义 BOL）
*   HTML 页面上没有 DataSource 对象
*   可在我选择的每一列上排序（`SortExpression`s 都设置正确）

但是，我收到以下错误消息：

> GridView 'myGridView' 触发了未处理的事件排序。

让我`List<T>`允许排序的最佳方法是什么？

我怀疑它与为`OnSorting`属性指定一个函数有关，即：

```
OnSorting = "MySortingMethod" 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-03-06T17:27:27.690

感谢您对排序的回答。我求助于 LINQ 来帮助进行动态排序。由于网格知道是按 ASC 还是 DESC 排序，以及哪个字段，所以我使用了 LINQ 表达式。表达式执行排序，然后我简单地将这些结果绑定到我的网格视图。

我怀疑 jQuery 方法会更快，并且不需要完整的回发。

```
using System.Linq.Expressions;

public SortDirection GridViewSortDirection
{
    get
    {
        if (ViewState["sortDirection"] == null)
            ViewState["sortDirection"] = SortDirection.Ascending;

        return (SortDirection)ViewState["sortDirection"];
    }
    set { ViewState["sortDirection"] = value; }
}

protected void gridView_Sorting(object sender, GridViewSortEventArgs e)
{
    //re-run the query, use linq to sort the objects based on the arg.
    //perform a search using the constraints given 
    //you could have this saved in Session, rather than requerying your datastore
    List<T> myGridResults = PerfomSearch();

    if (myGridResults != null)
    {
        var param = Expression.Parameter(typeof(T), e.SortExpression);
        var sortExpression = Expression.Lambda<Func<T, object>>(Expression.Convert(Expression.Property(param, e.SortExpression), typeof(object)), param);

        if (GridViewSortDirection == SortDirection.Ascending)
        {
            myGridView.DataSource = myGridResults.AsQueryable<T>().OrderBy(sortExpression);
            GridViewSortDirection = SortDirection.Descending;
        }
        else
        {
            myGridView.DataSource = myGridResults.AsQueryable<T>().OrderByDescending(sortExpression);
            GridViewSortDirection = SortDirection.Ascending;
        };

        myGridView.DataBind();
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-05T23:29:09.250

正确 - 您将需要处理排序、排序列表并重新绑定。

或者，您可以查看使用 jQuery 之类的 javascript 框架处理排序客户端。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-01-14T18:11:35.313

如果您收到此错误：

> 数据源不支持服务器端分页

尝试添加`.ToList<T>()`到您的查询：

```
if (e.SortDirection == SortDirection.Ascending)
{
    GridViewTrackerLoans.DataSource = myGridResults.AsQueryable<T>().OrderBy(sortExpression).ToList<T>();
}
else
{
    GridViewTrackerLoans.DataSource = myGridResults.AsQueryable<T>().OrderByDescending(sortExpression).ToList<T>();
}; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-05T23:37:36.140

您可以为您的对象编写一个比较：

```
private int CompareObject(YourObject object1, YourObject object2)
{
    int iReturnValue = 0;
    if ((object1 != null) && (object2 != null) &&
        (object1.SomeField != object2.SomeField))
    {
        iReturnValue = (object1.SomeField > object2.SomeField) ? 1 : -1;
    }
    return iReturnValue;
} 
```

然后，在您的排序事件中，只需将比较函数传递到您的对象排序例程中（假设您有类似列表的内容）。

```
// Your list of data from the session or viewstate or whereever you have it stored.
lstObjects.Sort(CompareObject); 
```

你现在有一个排序列表，所以只需重新绑定它。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-05T23:44:45.140

正确，您需要处理 OnSorting 事件并将 AllowSorting 属性设置为 true。

# c# - call a web service from a httpmodule

> ID：617091
> 
> 赞同：0
> 
> 时间：2009-03-05T23:04:46.097
> 
> 标签：c#, asp.net, web-services

I set up a web service, and I've tried to call it from my httpmodule using a Proxy class and it will just timeout. I did more testing and tried a WebRequest and that times out also. If I specify the wrong url it will throw an exception with a 404 so it seems like this *should* be possible. Calling the web service from a web browser works fine so that isn't the problem. Any ideas?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-05T23:18:23.270

HttpModules 与任何其他代码没有什么不同。如果您可以从其他任何地方执行此操作，则可以从模块中执行此操作。由于您没有说任何关于实际需要代理的内容，因此我不清楚您为什么在这种情况下使用 Proxy 类。在不需要时尝试使用代理可能会导致超时，因为您将请求发送到不存在的网络代理。

不能只使用[Web Reference](http://msdn.microsoft.com/en-us/library/d9w023sx.aspx)或[WebRequest](http://msdn.microsoft.com/en-us/library/system.net.webrequest.aspx)连接到服务吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-05T23:42:34.070

您确定您和 Web 服务之间没有代理服务器吗？.Net 在尝试解决这个问题时做得很好，但是我发现了很多问题让框架尝试解决代理的位置。

这是一个硬编码的解决方案，虽然不是任何类型的最佳实践，但它显示了如何将代理附加到 webclient 请求..

```
WebProxy proxy = new WebProxy("111.222.333.444:8080");
proxy.Credentials = CredentialCache.DefaultCredentials;
WebClient wc = new WebClient();
wc.Proxy = proxy;
// do your other stuff 
```

我注意到当端口不是 80 并且服务器平台没有在 Internet Explorer 中设置代理时，.Net 真的很挣扎，我更愿意说实话，我相信默认设置只是查看为本地 Internet 连接设置的内容，但是不要引用我的话

# python - Iterative version of Python's deepcopy

> ID：617097
> 
> 赞同：4
> 
> 时间：2009-03-05T23:07:10.363
> 
> 标签：python, recursion, iteration

Is there an existing implementation of an iterative version of deepcopy for Python 2.5.2? The deepcopy method available from the copy module is recursive and fails on large trees. I am not in a position where we can safely increase the stack limit at runtime.

EDIT

I did track this down:

[http://code.activestate.com/recipes/302535/](http://code.activestate.com/recipes/302535/)

I haven't tested it, but it looks like it has potential.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-05T23:11:45.877

I'm not sure this would make sense. Isn't the whole point of `deepcopy` that each object will ask its children to copy themselves?

Presumably you know exactly what kind of object you're copying and what its children look like as well, so if I were you, I'd just write my own function to copy it. Shouldn't be too hard.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-06T01:08:35.237

也许它可以与[Stackless Python一起工作](http://en.wikipedia.org/wiki/Stackless_Python)

# .net - 我可以将 WPF 页面路径转换为类名吗

> ID：617099
> 
> 赞同：1
> 
> 时间：2009-03-05T23:08:12.700
> 
> 标签：.net, wpf, vb.net

我有一个从数据库中提取 XAML 页面路径的应用程序。然后，我可以在需要时使用导航服务导航到相关页面。但是，我遇到了一种情况，我想在导航到该页面之前使用特定的构造函数来实例化页面。

是否可以在运行时获取诸如“\Pages\MyPage.xaml”之类的字符串值并创建一个对象 MyPage？显然，我可以在页面路径上使用 switch 语句来做到这一点，但我希望它比这更动态。

如果有人有任何想法，或者有更好的方法来做我想做的事情，我将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-05T23:17:43.223

可以解析字符串去掉扩展名和子目录，然后看一下[Activator.CreateInstance](http://msdn.microsoft.com/en-us/library/system.activator.createinstance.aspx)

# .net - Unmanaged x64 assemblies in mixed .NET development environment

> ID：617100
> 
> 赞同：3
> 
> 时间：2009-03-05T23:08:47.647
> 
> 标签：.net, visual-studio, x86, 64-bit

What do we do if we have some devs working on 64 bit machines and some on 32 bit machines, but we need to reference unmanaged assemblies that need to be in x86 for half the team and x64 for the other half? Is there a solution besides manually updating the references every time someone on a 64 bit rig gets latest?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-06T01:53:12.103

您想将此作为构建的一部分，对吗？

编写一个预构建步骤，将引用的 DLL 从源代码树中的永久位置复制到本地项目。使用 $(ConfigurationName) 或 $(PlatformName) 宏来选择实际复制的非托管 DLL 的版本。您只需将 DLL 保存在名称与配置名称或平台名称匹配的单独文件夹中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-06T13:37:10.070

使用 x64 机器的开发人员愿意运行 64 位版本是相当奇怪的。Visual Studio 不支持 x64 模式下的 Edit+Continue，那是相当损失的。解决方法很简单，将 Platform Target 设置为 x86。自动也解决您的非托管 DLL 问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-09-18T20:31:32.287

还有另一种解决方案涉及稍微编辑您的代码。[Milan Gardian](https://stackoverflow.com/users/23843/milan-gardian)[对此问题](https://stackoverflow.com/questions/108971/using-side-by-side-assemblies-to-load-the-x64-or-x32-version-of-a-dll)的回答中对此进行了描述。

基本上，它涉及编写您自己的程序集引用处理程序以确定在运行时加载哪个程序集，前提是您可以访问程序集的两个（32 位和 64 位）版本。我刚刚自己实施了这个解决方案，它就像一个魅力。

我的情况是这样的：
我正在开发一个针对 Windows 7 64 位上的“任何 CPU”的 .NET 程序。我添加了 32 位程序集引用，并将 Copy Local 设置为 false。我使用构建后事件将 32 位和 64 位程序集复制到输出文件夹，并确保为 32 位程序集提供与参考文件中不同的名称。这是因为我想强制我的自定义程序集解析器启动并执行它的操作，因为 .NET 的默认程序集解析器无法解析引用。在运行时加载了正确的程序集，并且在编译时我没有收到任何错误。应该注意的是，我还没有时间真正确认它现在可以在 32 位操作系统上运行，但我看不出它不应该运行的任何原因。

# asp.net - ASP.NET HTTPHandlers and long running processes

> ID：617105
> 
> 赞同：2
> 
> 时间：2009-03-05T23:09:25.960
> 
> 标签：asp.net, ajax, xmlhttprequest, httphandler

This is a multi-part question.

I have a process that can take several minutes to complete, it is ran by a calling a HTTPHandler using a asynchronous javascript request.

Question 1: How can I ensure that this request does not time out on both the server and the client?

Question 2: Is it possible to emit data from the HTTPHandler while processing that is sent back to the XmlHttpRequest object before the final page is completed?

I'd like to calculate actual workload and return percentage done. I'm guessing that this is possible.

Any tips?

EDIT:

A quick test:

```
 public void ProcessRequest(HttpContext context)
    {
        context.Response.ContentType = "text/plain";
        for (int i = 0; i < 100; i++)
        {
            context.Response.Write("Hello World " + i + Environment.NewLine);
            System.Threading.Thread.Sleep(500);
            context.Response.Flush();
        }            
    } 
```

Pushes Hello World bit by bit to the client...This works on a synchronious request, I'll see if a xmlHttpRequest gets a readystatechange event for each line.

I've always avoiding multithreading on ASP.NET apps because you don't have control of when the working process will die, which will result in all of its spawned threads dieing.

Instead, why re-invent a separate thread pool when IIS is already doing this for you.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-05T23:25:11.040

我过去所做的是在一个新线程上启动长时间运行的进程，并在进程类上有一个属性来说明完成百分比。然后每隔一段时间，浏览器就可以对 HttpHandler 进行 AJAX 调用，该 HttpHandler 只是轮询该 % complete 属性。这样 HttpHandler 立即返回。

如果作业很重要，可能需要考虑一些问题，例如缓解工作进程以回收中间作业或保存作业的状态以便重新启动它。如果作业非常关键，最好写一个Windows Service来执行作业，并使用[Remoting](http://msdn.microsoft.com/en-us/library/d9w023sx.aspx)之类的来查询进度。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-06T00:40:33.307

根据定义，HTTP 请求是无状态的。正如其他人指出的那样 - 您无法预测 IIS 何时会回收该进程。

更好的方法是创建一个 Windows 服务来完成实际工作，并创建一个 HTTPHandler 或页面或其他任何东西来查询它的进度并将其返回给客户端。您可以在同一台机器上安装服务，然后使用管道或任何您想在页面/处理程序与服务之间连接的远程通道。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-05T23:25:55.547

1.  您可以在 web.config 中更改请求超时值，例如： `<configuration> <system.web><httpRuntime executionTimeout="1000" /></system.web></configuration>`

2.  据我所知，没有办法将信息发送回同一个异步请求。我见过的大多数 Ajax UI 都是通过拥有一个静态类来创建该行为的，该类保存正在运行的任务的统计信息，然后使用另一个异步请求或 iframe 轮询它。类似的一个很好的例子是[Neat Upload Control](http://www.brettle.com/neatupload)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-05T23:26:25.700

这是一个想法...

如果您有一个需要“几分钟”来处理的进程，则最好创建一个单独的线程（或单独的线程队列），而不是使用 ASP.NET 工作线程。这是因为如果您用完所有工作线程，那么您的 Web 服务器可能会挂起。有关此问题的更多信息：http: [//msdn.microsoft.com/en-us/magazine/cc164128.aspx](http://msdn.microsoft.com/en-us/magazine/cc164128.aspx)

您的第一个 AJAX 请求是启动该进程。随后的调用将获取进程的状态，包括完成百分比。使用计时器进行轮询（每隔几秒或似乎最有效的方式）以获取完成百分比，直到全部完成。

AJAX 请求（XmlHttpRequest）在客户端本身没有超时（[http://luke.breuer.com/tutorial/xmlhttprequest.aspx](http://luke.breuer.com/tutorial/xmlhttprequest.aspx) ...向下滚动到超时），但我不认为这是一个好的如果可能的话，让他们休息几分钟做工作的想法：

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-06T04:29:03.477

物有所值，

```
public void ProcessRequest(HttpContext context)
{
    context.Response.ContentType = "text/plain";
    for (int i = 0; i < 100; i++)
    {
        context.Response.Write("Hello World " + i + Environment.NewLine);
        System.Threading.Thread.Sleep(500);
        context.Response.Flush();
    }            
} 
```

在客户端：

```
httpObject.onreadystatechange = function()
{
    // This is called whenever Flush() is called on the server.
    // when readyState = 4, everything is done, but I can check responseText at anytime.
} 
```

工作得很好。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2009-03-05T23:26:36.637

从这个网站下载源文件

[http://www.stonebroom.com/dafiles/6744-code.zip](http://www.stonebroom.com/dafiles/6744-code.zip)

检查 url ~/loadpost/stagedloading.aspx。

# ssl - TCP 服务器上的 SslStream 无法使用 RemoteCertificateNotAvailable 验证客户端证书

> ID：617109
> 
> 赞同：3
> 
> 时间：2009-03-05T23:10:21.743
> 
> 标签：ssl, cryptography, certificate, tcpclient, sslstream

这个问题都是关于解决`SslPolicyError.RemoteCertificateNotAvailable`错误的。

我为另一端开发了一个带有 SSLStream 的 TCP 服务器和一个 TCP 客户端。

我通过以下方式验证服务器：

```
sslStream.BeginAuthenticateAsServer 
```

我通过以下方式验证客户端：

```
sslStream.BeginAuthenticateAsClient 
```

我正在从`Trusted Publishers - Local Machine`.

两者都在同一台机器上运行。

我尝试从 .cer 和 .pfx 文件而不是受信任的发布者存储中加载客户端证书。但是服务器的客户端（远程）证书验证器回调因发现`SslPolicyErrors`有`RemoteCertificateNotAvailable`错误而失败。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-05T23:21:01.250

链接没有通过，但我可以通过声明发现一个问题：“我从受信任的发布者加载了我的客户端证书”

*客户端*证书（即在其增强密钥使用字段中包括*客户端身份验证*的证书）通常存在于用户帐户的**个人**存储中。您始终需要证书的私钥才能“成为”该证书中的实体。

与*服务器*证书相同（尽管它们具有不同的预期用途 OID -*服务器身份验证*）。我认为，在**Trusted Publishers**商店中*拥有带有私钥*的证书对您来说很奇怪。

 **如果您双击 CertMgr.msc 中的客户端或服务器证书，您应该会在底部看到一条*This certificate has a private key* -type 消息。

If you don't, you only have half a key pair - signatures and authentication require the private key. (The server cert needs a private key at the server end, and the client cert needs a private key at the client end.)

# asp.net-mvc - ASP.net MVC RC 2 - 无法安装...因为 NGEN 出现灾难性故障！

> ID：617116
> 
> 赞同：0
> 
> 时间：2009-03-05T23:13:29.927
> 
> 标签：asp.net-mvc

我看到新的[ASP.NET MVC 1.0 Release Candidate 2](http://www.microsoft.com/downloads/details.aspx?FamilyID=ee4b2e97-8a72-449a-82d2-2f720d421031&displaylang=en)已经发布。 Scott Gu 的博客上还[没有帖子。](http://weblogs.asp.net/scottgu/default.aspx)知道这是否破坏了任何东西吗？我目前在几个项目中使用 MVC 的 beta 版本。我即将开始一个新的。

从 Beta 版迁移时，RC 2 会破坏任何东西吗？

**[更新]**由于错误，无法安装 RC2“安装向导永久结束”。这是[有人](http://tinyurl.com/badtw3)遇到同样的问题。有任何想法吗？

**[更新]**好的，现在我发现对 NGEN 的依赖是失败的根源。NGEN 正在记录“灾难性故障”，然后关闭。

我需要重新安装什么吗？操作系统？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-06T00:11:55.543

我找到了**UPDATE**半个[答案](http://forums.asp.net/p/1380126/2916346.aspx)。需要运行以下服务才能完成安装。

*   .Net 优化服务
*   ASP.Net 状态服务

可惜优化服务不开心

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-05T23:20:01.863

从 RC1 到 RC2 没有重大变化，但我认为从 BETA 到 RC1 可能会有一些变化。

Scott Gu 通常在 ASP.NET RC1 上发表的史诗般的博文。

[http://weblogs.asp.net/scottgu/archive/2009/01/27/asp-net-mvc-1-0-release-candidate-now-available.aspx](http://weblogs.asp.net/scottgu/archive/2009/01/27/asp-net-mvc-1-0-release-candidate-now-available.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-06T20:10:04.103

试试这个[修补程序](http://blogs.msdn.com/webdevtools/archive/2009/03/03/hotfix-available-for-asp-net-mvc-crashes-with-azure-power-commands-resharper.aspx)。你可以[在这里](https://connect.microsoft.com/VisualStudio/Downloads/DownloadDetails.aspx?DownloadID=16827&wa=wsignin1.0)下载。

Phil Haack 在这里写下了这个问题：http: [//haacked.com/archive/2009/03/06/hotfix-for-installing-aspnetmvc.aspx](http://haacked.com/archive/2009/03/06/hotfix-for-installing-aspnetmvc.aspx)

您很可能也遇到了这个问题。

# c# - 有没有一种好方法来执行 WPF/C# 对象取消引用以进行垃圾收集？

> ID：617118
> 
> 赞同：4
> 
> 时间：2009-03-05T23:14:37.787
> 
> 标签：c#, memory-management, pointers, object, object-reference

## 应用背景

我们的平台是一个点击一次的 WPF 应用程序。我们有一个包含导航菜单结构的“shell”，它托管我们自己的自定义“页面”类。当您导航到新页面时，我们会（基本上）换掉 shell 的内容。

## 问题

所以，我为一家从事大型软件项目的公司工作。我们发现有很多代码存在内存问题。

问题是在我们的应用程序中有很多地方是事件是有线的而不是无线的。我不确定开发人员为什么要这样做，我猜他们希望每次用户导航到新的“页面”时都会清理对象。

我们没有重构每个页面的选项（在此版本中）。C# 有没有办法从对象中删除所有引用？（因此允许垃圾收集器将该对象连同它的所有内部引用一起丢弃）

我们正在尝试取回这些内存，但是当我们需要处理 WPF 时，要找到仍在引用我们的页面（对象引用）的对象是相当复杂的。

我们已经查看了可视化和逻辑树，并使用分析应用程序来帮助我们手动清理事物（为了证明这个想法），这也被证明是非常困难的。

我坐下来想，为什么我们要做所有这些工作来查找对象引用，我们不能在关闭时“取消引用”这个“页面”吗？

这把我带到了这里:)
非常感谢任何帮助！

* * *

## 更新 1

在评论中，有人问了以下问题：

**问：**应用程序。真的有记忆问题吗？这些是如何展示/检测的？还是在 GC2 发生之前这段记忆一直存在？– 米奇小麦

**A：**内存有问题。如果我们离开一个页面（保存页面的属性被设置为一个新对象），旧对象永远不会被垃圾收集器收集。所以记忆只是不断增长。如果我们公司重新开始，请使用此应用程序。我们应该看的第一件事是实现 WeakEvent 模式并在 WPF 中使用更多路由命令。

## 更新 2

我能够想出自己的[解决方案](https://stackoverflow.com/questions/617118/is-there-a-good-way-to-perform-wpf-c-object-dereferencing-for-garbage-collectio/622268#622268)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-06T15:14:26.827

你用过 CLRProfiler 吗？我发现这非常适合查找对象并查找包含对它们的引用的内容。

这个“如何”页面...

[http://msdn.microsoft.com/en-us/library/ms979205.aspx](http://msdn.microsoft.com/en-us/library/ms979205.aspx)

...链接到下载站点。

但是，我认为您的问题的答案是“不”。没有办法说“不再需要对象 foo - 无论它是否已植根，请收集它”。收集有根对象可能会给您的应用程序带来各种不良后果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-07T18:30:35.800

我实现了[WeakEvents](http://msdn.microsoft.com/en-us/library/aa970850.aspx)来解决这个问题。

不幸的是，Microsoft 建议您使用他们的 WeakEventManager 作为基类，并为您的应用程序中的每个事件创建一个管理器类型！！！我试图编写一个继承自这个基础的管理器，并让它更加“通用”（不是在 C# 术语中表示通用）。这种“通用”事件管理器在 Microsoft 的基类中是不可能的。我不得不从头开始编写一个事件管理器。

感谢您对此问题的任何帮助。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-03-06T14:17:11.143

如果漏洞页面超出范围，包括所有底层数据，GC 将收集它。最终。但是，如果该页面被仍在范围内的任何内容引用，则该页面及其所有数据将保留在内存中，并且 GC 将无法收集它。

据我所知，在修复不良内存管理方面没有简单的按钮。在我看来，这意味着唯一的工作就是清理引用。这将使 GC 更容易收集超出范围的对象。

您可以建议 GC 通过其算法来查看是否可以通过调用 GC.Collect() 来收集任何东西。但是，除非数据确实超出范围，否则除了浪费 CPU 周期外，这几乎没有什么作用。

Phobis 的问题，您的应用程序使用了多少内存？

编辑：

链接到适用于 .net3.5 应用程序的 CLR Profiler 2.0。 [https://github.com/MicrosoftArchive/clrprofiler](https://github.com/MicrosoftArchive/clrprofiler)

# sql - 处理数据库中的幻数有哪些好的策略？

> ID：617143
> 
> 赞同：4
> 
> 时间：2009-03-05T23:21:33.467
> 
> 标签：sql, database-design

我正在处理各种具有 WHERE 子句的过程，如下所示：

```
WHERE ... AND ( ( myTbl.myValue = 1234) 
    or (myTbl.myValue = 1235) )-- Value =  No 
```

我已经和一些同事讨论过这个问题，这种代码似乎是不可避免的。我认为将这种代码放在一个（也是唯一一个）地方是个好主意。那可能是一个视图，它可能是一个表等。我正在考虑一个从基础表中选择的视图，并且有一个位字段表示 1234 或 1235 的值是 0。或“N”等。这样我就可以随意添加“否”值而无需更改任何代码。我不会为此使用 UDF，如果您在连接中使用它会调用太多函数。

处理数据库中的特殊值还有哪些其他选项？视图是一个很好的解决方案吗？有没有办法完全避免这种事情？我在想，如果该值出于某种原因需要更改，我不想处理数百个 procs 的更改。另一方面，额外的加入，所以它是一个性能打击。

更新：如果有人有策略来摆脱那些该死的东西，那也很棒。就像我说的，与同事讨论过，这些事情在数据库层中有很多业务逻辑的组织中似乎是不可避免的。

PS：我看到了一些幻数问题，但没有特定于数据库。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-05T23:29:09.547

在 Oracle 上，您可以设置[确定性函数](http://download.oracle.com/docs/cd/B12037_01/appdev.101/b10807/08_subs.htm#sthref992)，这种函数会通知 RDBMS，只需要调用一次。

```
create or replace package MAGIC is
  function magic_number return  number DETERMINISTIC;
end;
/

create or replace package body MAGIC is
  function magic_number return  number DETERMINISTIC
  is
  begin
    return 123;
  end;
end;
/

SELECT MAGIC_DATE
  FROM MAGIC_TABLE
 WHERE MAGIC_ID = magic.magic_number; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-05T23:44:46.623

我们在谈论多少个神奇的数字？如果少于几千，请将它们放在一个表中并进行连接。如果它们经常在 WHERE 子句中用作一致的分组（如示例中的 1234 和 1235），请分配一个类别列并使用 IN 或 EXISTS。（这些都不会对少量的幻数和适当的索引产生有意义的性能影响。）

除了临时 SQL 语句之外，我讨厌像您的示例中那样的硬编码数值。它使维护以后成为真正的 PITA。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-05T23:51:17.137

幻数总是可以避免的，但避免它们可能并不总是理想的（例如你提到的性能影响）。在完美的代码中，您将在数据库中拥有另一个表，其中包含`myMagicNumber`您引用的简单标识符（字符串）。

但是，我发现最好的解决方案是在您的程序代码（或 SP，如果这是您正在使用的）中保留查找（函数/枚举等）。确保您始终使用该查找来添加或选择数据库中的数据。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-06T00:25:43.450

我同意这种神奇的数字都应该放在一个地方。那个地方应该在哪里可能取决于你的应用周围的文化。如果有一个通用的配置文件或区域，尤其是一组级联的配置，那是一个好地方。

我想你应该弄清楚的第一部分是你的号码有什么神奇之处。它对配置敏感吗？它是一个数学常数吗？它是由某些外部标准规范定义的值吗？知道这可能有助于找到幻数的定义。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-06T03:51:45.470

通常，像这样的幻数可以存储在数据库中，并在数据库首次启动时加载到静态只读变量中。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-05T23:33:41.923

使用 SqlServer 和可能的其他方言，您可以创建返回幻数的函数，因此您的 sql 将变为

```
WHERE ... AND ( ( myTbl.myValue = MagicFunction1())     or (myTbl.myValue = MagicFunction2()) )-- Value =  No 
```

或者，您可以创建一个函数，或者创建一个函数/逻辑组幻数并传入一个参数。

```
WHERE ... AND ( ( myTbl.myValue = ProductFunction(1))     or (myTbl.myValue = ProductFunction(2)) )-- Value =  No 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-06T02:34:14.873

我发现很多老一代的开发人员喜欢在他们的代码中添加注释并提供系统文档来支持它。请注意，我自己并不坚持——只是让人们猜测这一切意味着什么。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-03-05T23:31:45.750

当我们以字符串形式进行查询时，这通常类似于

```
"AND myTbl.iTpe = "+AnEnum.THE_TYPE.ordinal()+"..." 
```

# hibernate - Hibernate 获取策略 - 何时使用“加入”以及何时使用“选择”？

> ID：617145
> 
> 赞同：49
> 
> 时间：2009-03-05T23:22:50.997
> 
> 标签：hibernate, fetch

大多数 Hibernate 关联都支持“fetch”参数：

```
fetch="join|select" 
```

“选择”是默认值。

如何决定将哪个用于哪个关联？

我尝试将所有应用程序范围从“选择”更改为“加入”——生成的查询数量可能减少了 10 倍，但性能保持不变（甚至变得更糟）。

谢谢。

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2009-03-06T05:14:43.257

加入应该解决n+1问题。如果您有 10 个父母，每个父母有 10 个孩子，则 join 将需要一个查询，而 select 将需要 11 个（父母一个，每个父母的孩子一个）。如果数据库与应用程序在同一台服务器上，或者网络非常快，这可能没什么大不了的，但如果每次数据库调用都有延迟，它就会累加。join 方法在初始查询上的效率稍低，因为您在每一行中复制父列，但您只对数据库进行一次往返。

一般来说，如果我知道我需要所有父母的孩子，我会加入。如果我只需要几个父母的孩子，我会使用 select。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-06T00:18:06.450

Select 将通过向数据库发出新查询来获取子项。Join 将通过将子项连接到父项的查询中来获取子项。这就是为什么您会看到类似的性能，即使查询数量有所下降。

选择：

```
SELECT * FROM parent WHERE id=(whatever)
SELECT * FROM child WHERE id=(parent.child.id) 
```

加入：

```
SELECT *
FROM parent
LEFT OUTER JOIN child ON parent.child.id=child.id
WHERE parent.id=(whatever) 
```

至于何时使用一个而不是另一个......不完全确定。它可能取决于数据库系统。如果一个总是比另一个更好，我怀疑他们会费心给你选择！如果你看到每个都有相似的性能，我不会担心。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-04-24T20:34:57.563

如果父母有很多孩子，而这些孩子又有很多其他孩子，那么在这种情况下，最初的“加入”可能会阻塞网络。我的建议是在这种情况下使用“选择”来拆分选择。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-10-08T08:50:10.573

**fetching="join"** 如果您执行 fetching="join"，它将在单个 select 语句中检索所有信息。

**fetching="select"** 如果你想使用第二个 select 语句来获取关联的集合，那么你将使用 fetch="select"。

来源：[休眠获取策略](http://javawebtutorial.blogspot.in/2013/09/hibernate-fetching-strategies.html/%22Hibernate%20Fetching%20Strategies%22)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-06-29T15:34:37.940

通常，出于性能原因，JOIN 是首选。

使用 SELECT 的一个原因是，如果您要对具有多对多关系的结果（设置偏移量和限制）进行分页。如果您使用 JOIN，如果根实体包含多个多对多子实体，并且这些“副本”会超出您的限制（即使 Hibernate 在使用 DISTINCT_ROOT_ENTITY 事实后将它们折叠），它将出现多次。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-04-14T18:29:29.540

人们总是谈论使用**fetch=JOIN**对性能的影响。但我认为，了解我们正在获取的父/子记录的数量对我们来说很重要：

如果您只想获取单个 Parent 记录并期望它没有很多孩子，那么我建议您使用**fetch=SELECT**。

如果您想获取所有父记录，包括其子记录，那么最好使用**fetch=JOIN**

只是要补充一点，如果记录是懒惰地获取子项（**lazy=true**），那么使用**fetch=JOIN**没有任何意义，因为所有父项和子项记录都是一次性加载的。

# outlook - 如何在 3 次或更少的点击中将多个事件发送到 Outlook 2003 日历？

> ID：617149
> 
> 赞同：1
> 
> 时间：2009-03-05T23:23:30.527
> 
> 标签：outlook, calendar, icalendar, sync

基本上，我希望有人能够单击我网站上的一堆事件，并以一种无痛的方式将它们全部同步到他们的主要 Outlook 日历。

*   我知道我可以发送一个包含多个事件的 ics，但这会创建第二个日历（除非您导入超过 3 次点击的日历）。

*   我还可以让用户同步到 webcal，但这在 Outlook 2003 或更早版本中不起作用（并且还会创建第二个日历）。

*   我也可以发送一封包含会议请求的电子邮件，但这是 O(n)（接受每个请求

这也必须在 Firefox 中工作，所以没有 ActiveXObject 黑客。

三击是答案的“精神”。如果需要4，那很好。

到目前为止，webcal 是我所拥有的最好的，但能够将事件粘贴在其原始日历中会更好。

编辑：已经提到了重复规则 - 有没有办法使用 RRULE（BYDAY、BYMONTH 等）将所有事件集中到一个 VEVENT 中，然后为每个事件设置不同的摘要/描述？这将是一个完美的解决方案。

EDIT2：是的，实际上 Outlook 不支持在同一天重复（或任何不错的 BYMONTHDAY、SECONDS 等参数）。因此，重复无法在 Outlook 中生成任意事件时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-05T23:37:12.633

如果没有 ActiveX 技巧，您将无法做到这一点，因为您要求在 Outlook 的日历中设置后门。使用 Outlook 的本地插件就可以了，但是通过 Firefox，您只能使用 Outlook 的普通界面，而且您已经看过所有这些界面。

使用电子邮件路线并尝试利用重复或预定的事件，以便它们都可以被视为单个事件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-07T00:14:39.477

它不能按照我想要的方式完成 - Outlook 很糟糕。

最佳选择：

1.  如果您对第二个日历没问题：

给他们一个指向 webcal://blah.com/blah.ics 的链接，他们可以订阅该链接并永远保持 Outlook 2007 的最新状态。使用 Outlook 2003，它将是静态的。

2.  如果您对每天 1 个事件感到满意，并且所有事件的组合只有一组描述：

给他们一个带有 RDATE 的事件，用于设置任意重复。

3.  如果你只支持 IE：

ActiveXObject - 但除非你是个混蛋，否则不要这样做。

3.  如果您负担不起上述费用：

必须一次做一件事。糟透了。

# java - 是否有用于读取 UNIX /etc/group 文件的 Java 包？

> ID：617165
> 
> 赞同：1
> 
> 时间：2009-03-05T23:29:14.553
> 
> 标签：java, class, posix

我一直在 Internet 上搜索一个 Java 包/类，它可以让我解析 UNIX /etc/group 文件。虽然从头开始写这个真的不会那么难，但我很惊讶没有找到已经存在的东西。有一个 POSIX passwd 类（参见[http://www.bmsi.com/java/posix/docs/posix.Passwd.html](http://www.bmsi.com/java/posix/docs/posix.Passwd.html)），但我没有为 /etc/group 找到类似的类。这样的事情存在吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-06T00:11:07.357

这是我再次更新的 tofubeer 更新的代码。他的没有编译。缺少 InvalidGroupException 类。此外，没有指定包。将 EMPTY_LIST 切换为 emptyList() 以避免缺少参数化。

```
package fileutils;

import java.util.ArrayList;
import java.util.Arrays;
import java.util.Collections;
import java.util.List;

public class GroupReader2 {
    public static class InvalidGroupException extends Exception {
        private static final long serialVersionUID = 1L;

        public InvalidGroupException(String string) {
            super(string);
        }
    }

    public static GroupReader2 parseGroup(final String groupLine)
            throws InvalidGroupException {
        final String line;
        final String[] parts;

        if (groupLine == null) {
            throw new IllegalArgumentException("groupLine cannot be null");
        }

        line = groupLine.trim();

        if (line.startsWith("#") || line.isEmpty()) {
            return null;
        }

        parts = line.split(":");

        if (parts.length < 3) {
            throw new InvalidGroupException(groupLine
                    + "must be in the format of name:passwd:gid[:userlist]");
        }

        try {
            final GroupReader2 group;
            final String name;
            final String passwd;
            final int gid;
            final List<String> userList;

            name = parts[0];
            passwd = parts[1];
            gid = Integer.parseInt(parts[2]);

            if (parts.length == 4) {
                userList = Arrays.asList(parts[3].split(","));
            } else {
                userList = Collections.emptyList();
            }

            group = new GroupReader2(name, passwd, gid, userList);

            return group;
        } catch (final NumberFormatException ex) {
            throw new InvalidGroupException(groupLine + " gid must be a number");
        }
    }

    private final int gid;
    private final String name;
    private final String passwd;

    private final List<String> userList;

    public GroupReader2(final String nm, final String pw, final int id,
            final List<String> users) {
        name = nm;
        passwd = pw;
        gid = id;
        userList = Collections.unmodifiableList(new ArrayList<String>(users));
    }

    public int getGid() {
        return (gid);
    }

    public String getName() {
        return (name);
    }

    public String getPasswd() {
        return (passwd);
    }

    public List<String> getUserList() {
        return (userList);
    }

    @Override
    public String toString() {
        final StringBuilder sb;

        sb = new StringBuilder();
        sb.append(name);
        sb.append(":");
        sb.append(passwd);
        sb.append(":");
        sb.append(gid);
        sb.append(":");

        for (final String user : userList) {
            sb.append(user);
            sb.append(",");
        }

        sb.setLength(sb.length() - 1);

        return (sb.toString());
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-06T17:15:06.973

这是 John Ellinwood 提供的代码，但更安全（编辑：添加了 Johns 的更改，略有不同，以便与评论保持同步。很高兴看到两个人如何实现相同类型的代码）。

我选择在无效行的情况下抛出异常，您可以像他最初所做的那样简单地返回 null （我没有看到使用包含错误数据的文件的意义......）。

唯一“必须做”的更改是将 userList 包装为 UnmodifableList（或返回列表的新副本），否则此方法的恶意用户可能会向 userList 添加内容（调用 getUserList 然后继续向其中添加项目或删除它的项目）。

由于 Group 类是不可变的（所有实例变量都是最终变量），因此不必担心它们会被调用者更改。

```
import java.util.Arrays;
import java.util.ArrayList;
import java.util.Collections;
import java.util.List;

public class Group
{
    private final int gid;
    private final String name;
    private final String passwd;
    private final List<String> userList;

    public static Group parseGroup(final String groupLine)
        throws InvalidGroupException
    {
        final String   line;
        final String[] parts;

        if(groupLine == null)
        {
            throw new IllegalArgumentException("groupLine cannot be null");
        }

        line = groupLine.trim();

        if(line.startsWith("#") || line.isEmpty())
        {
             return null;
        }

        parts = line.split(":");

        if(parts.length < 3)
        {
            throw new InvalidGroupException(groupLine + "must be in the format of name:passwd:gid[:userlist]", line);
        }

        try
        {
            final Group        group;
            final String       name;
            final String       passwd;
            final int          gid;
            final List<String> userList;

            name   = parts[0];
            passwd = parts[1];
            gid    = Integer.parseInt(parts[2]);

            if(parts.length == 4)
            {
                userList = Arrays.asList(parts[3].split(","));
            }
            else
            {
                userList = Collections.emptyList();
            }

            group = new Group(name, passwd, gid, userList);

            return group;
        }
        catch(final NumberFormatException ex)
        {
            throw new InvalidGroupException(groupLine + " gid must be a number", line);
        }
    }

    public Group(final String nm, final String pw, final int id, final List<String> users)
    {
        name     = nm;
        passwd   = pw;
        gid      = id;
        userList = Collections.unmodifiableList(new ArrayList<String>(users));
    }

    public int getGid()
    {
        return (gid);
    }

    public String getName()
    {
        return (name);
    }

    public String getPasswd()
    {
        return (passwd);
    }

    public List<String> getUserList()
    {
        return (userList);
    }

    @Override
    public String toString()
    {
        final StringBuilder sb;

        sb = new StringBuilder();
        sb.append(name);
        sb.append(":");
        sb.append(passwd);
        sb.append(":");
        sb.append(gid);
        sb.append(":");

        for(final String user : userList)
        {
            sb.append(user);
            sb.append(",");
        }

        sb.setLength(sb.length() - 1);

        return (sb.toString());
    }
}

public class InvalidGroupException
    extends Exception
{
     private static final long serialVersionUID = 1L;
     private final String line;

     public InvalidGroupException(final String msg, final String ln)
     {
         super(msg);

         line = ln;
     }

     public String getLine()
     {
         return (line);
     }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-06T00:52:59.347

如果您要在除您自己的机器之外的任何地方运行该程序，那么阅读 /etc/group 并不是一个好主意。

现实世界使用 nis/ldap 等来保存所有这些信息。

您可能想用 JNI 包装 getpwent / getgrent 系列您可能会得到一些包装这些的 java posix 实现。

希望有帮助..

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-06T00:02:55.440

Java 是独立于机器的，那么我对此并不感到惊讶。你指的班级不是标准的。

我认为与向所有人隐藏 /etc/group 文件的原因相同，可以为我们提供了解 java 不提供它的原因的线索。

# ruby - 线程在 Ruby Shoes 中工作了吗？

> ID：617166
> 
> 赞同：1
> 
> 时间：2009-03-05T23:29:44.227
> 
> 标签：ruby, shoes

有什么工作可以让其他红宝石线程与鞋子一起工作吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-05T23:48:32.370

线程在红宝石鞋中工作，问题是它们是[绿色线程](http://en.wikipedia.org/wiki/Green_threads)，你必须非常小心不要取出你的 UI。此外，您还有像“every”这样的原语，允许您每隔一定的时间间隔运行一些代码。

我认为_为什么要在 1.9 上运行鞋子，这将提供一个更引人注目的多线程故事。

# javascript - JS/jQuery：当悬停在另一个（下部）LI 元素上时，如何选择 UL 导航的第一个 LI 项？

> ID：617167
> 
> 赞同：1
> 
> 时间：2009-03-05T23:31:01.743
> 
> 标签：javascript, jquery, jquery-ui, navigation, css-selectors

我正在尝试制作一个使用简单无序列表列出所有链接的导航。基本的东西。然而，第一个 LI 元素的类名是“section-title”。在这个“section-title”之后是其他页面的链接。

现在我想将 li.section-title 的背景颜色更改为黑色，同时将鼠标悬停在该部分的链接之一（部分标题下方的 LI 元素）上。

问题是我的导航中有超过 1 个 UL LI.section-title 所以直接方法（有效）正在使用：

```
$(document).ready(function() {

$('#navigation ul li a').hover(
function() {
    $('#navigation ul li.section-title').animate( {
        backgroundColor: "#000",
        color: "#F9B60F"
    }, "fast" );
},
function() {
    $('#navigation ul li.section-title').animate( {
        backgroundColor: "#FFF",
        color: "#000000",
    }, "fast" );
}
);

}); 
```

但它会同时改变页面所有 li.section-title 元素的颜色。

目前我正在尝试使用 (this).parent 仅获取包含当前悬停在 li 元素上的组的 li.section-title ，但这由于某种原因根本不起作用。也许是它背后的理论是错误的，或者是我的代码。

这是我当前的代码（不起作用）：

```
$(document).ready(function() {

$('#navigation ul li a').hover(
function() {
    $(this).parents(".section-title").animate( {
        backgroundColor: "#000",
        color: "#F9B60F"
    }, "fast" );
},
function() {
    $(this).parents(".section-title").animate( {
        backgroundColor: "#FFF",
        color: "#000000",
    }, "fast" );
}
);

}); 
```

我对 jQuery 还很陌生，并且在网上搜索了很多这类东西的文档，但根本无法弄清楚。

也许你可以。可以在以下网址找到相关网站（包括损坏的脚本）：www.jannisgundermann.com

请注意，li 项目的“轻推”和颜色变化是由与此无关的另一个脚本完成的。

谢谢阅读。詹尼斯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-05T23:34:14.980

你没有正确定位你想要的 li 。试试这个：

```
$('#navigation ul li a').hover(
    function() {
        $(this).parents('ul').find('li.section-title').animate( {
            backgroundColor: "#000",
            color: "#F9B60F"
        }, "fast" );
    },
    function() {
        $(this).parents('ul').find('li.section-title').animate( {
            backgroundColor: "#FFF",
            color: "#000000",
        }, "fast" );
    }
); 
```

您必须先找到父 ul，然后在该 ul 中找到要突出显示的元素。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-05T23:34:56.007

试试这个。如果您指定一个元素作为第二个参数，那么它将只查找该元素的子元素。

```
$(document).ready(function() {

$('#navigation ul li a').hover(
function() {
        $('li.section-title', $(this).parent()).animate( {
                backgroundColor: "#000",
                color: "#F9B60F"
        }, "fast" );
},
function() {
        $('li.section-title', $(this).parent()).animate( {
                backgroundColor: "#FFF",
                color: "#000000",
        }, "fast" );
}
);

}); 
```

# sql-server - SQL Server 中的查询持续时间估计

> ID：617170
> 
> 赞同：5
> 
> 时间：2009-03-05T23:31:46.203
> 
> 标签：sql-server, progress

我在 Oracle 10g 中看到了一个估计长时间运行查询的剩余时间的功能，我想知道这在 SQL Server 中是否也可能（至少在 2008 年？）？

假设我有一个非常大的表，其中包含数千万行（索引良好等），我需要搜索一些特定的行。我知道这会花费很多时间，我对此很满意，但我想向用户展示某种进度条。

如何显示进度？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-06T00:15:52.867

我会忘记它，只是放一个旋转的圆圈！

不过，说真的，为了让 MrTelly 的想法更进一步，有一些动态管理视图可以为您提供某些查询的平均执行时间——也许这可以让您到达某个地方。

[http://msdn.microsoft.com/en-us/library/ms188754.aspx](http://msdn.microsoft.com/en-us/library/ms188754.aspx)

编辑：我在 Adam Machanic 的 sp_whoisactive 过程中看到了完成百分比。也许那是另一个值得研究的地方。SQL 2016 具有保留计划缓存信息的查询存储 - 替代 dmv 计划缓存，该缓存在重新启动时被清除。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-07-23T12:51:28.450

有关的：

*   [Surajit Chaudhuri、Vivek Narasayya 和 Ravi Ramamurthy。估计 SQL 查询的执行进度。ACM SIGMOD 2004。](https://research.microsoft.com/apps/pubs/?id=76556)

> 当今的数据库系统很少向用户/DBA 提供关于 SQL 查询执行完成量的反馈。对于长时间运行的查询，这样的反馈可能非常有用，例如，有助于决定是否应该终止查询或允许运行完成。尽管上述要求很容易表达，但为查询执行开发一个健壮的进度指标是具有挑战性的。在本文中，我们研究了上述问题并提出了可以形成有效进度估计基础的技术。在 Microsoft SQL Server 中通过实验验证我们的技术的结果是有希望的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-05T23:38:31.130

我不知道有一种工具会自动执行此操作，但有几种选择。将您的查询分成块...

```
select blah from table where IdRange between (1 and 100000)

select blah from table where IdRange between (100001 and 200000) 
```

随着每个 sql 完成，更新进度条。

或者，您可以记录每个选择所花费的时间长度，可能以每个用户为基础存储这些值。然后使用该信息返回进度条长度。

这两种方法都很笨拙，希望有人知道更好的方法。

当然，您可以尝试破译查询计划并据此做出判断，但在代码中会很难。

# file - Wippien 是否使用直接连接？

> ID：617175
> 
> 赞同：-1
> 
> 时间：2009-03-05T23:34:45.353
> 
> 标签：file, vpn, p2p, transfer, nat

我开始使用 Wippien 在 2 个远程 Windows 服务器之间建立 p2p 连接。我使用 2 个不同的 GMail 帐户。

Wippien 使用“Mediators”来启动连接。但海量数据传输真的是直接的，还是通过中介路由的？

我还发现这篇文章似乎相关：[P2P 应用程序中的直接 TCP/IP 连接](https://stackoverflow.com/questions/44205/direct-tcp-ip-connections-in-p2p-apps)

如何确定连接是否直接以及如何确定速度？

传输文件时连接似乎很慢，但这不是衡量的，只是我的第一印象。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-12-02T16:38:09.783

Wippien 确实使用直接连接。

它只使用服务器来设置 IP 地址和突破防火墙。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-07-22T11:44:08.403

我建议您使用真正的 VPN 解决方案，例如 OpenVPN。

# bash - 如何使用 Bash 抑制命令的所有输出？

> ID：617182
> 
> 赞同：342
> 
> 时间：2009-03-05T23:38:25.810
> 
> 标签：bash, shell, scripting, echo

我有一个运行带有参数的程序的 Bash 脚本。该程序输出一些状态（做这个，做那个......）。该程序没有任何选项可以保持安静。如何防止脚本显示任何内容？

我正在寻找类似 Windows 的["echo off"](https://ss64.com/nt/echo.html)的东西。

* * *

## 回答 #1

> 赞同：602
> 
> 时间：2009-03-05T23:39:17.587

以下将标准输出发送到空设备（位桶）。

```
scriptname >/dev/null 
```

如果您还希望在那里发送错误消息，请使用其中一个（第一个可能不适用于所有 shell）：

```
scriptname &>/dev/null
scriptname >/dev/null 2>&1
scriptname >/dev/null 2>/dev/null 
```

而且，如果您想记录消息，但看不到它们，请替换`/dev/null`为实际文件，例如：

```
scriptname &>scriptname.out 
```

为了完整起见，在 Windows cmd.exe 下（其中“nul”相当于“/dev/null”），它是：

```
scriptname >nul 2>nul 
```

* * *

## 回答 #2

> 赞同：50
> 
> 时间：2009-03-05T23:41:10.313

就像是

```
script > /dev/null 2>&1 
```

这将阻止标准输出*和*错误输出，将它们都重定向到`/dev/null`.

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2015-09-23T01:48:22.973

尝试

```
: $(yourcommand) 
```

`:`是“什么都不做”的缩写。

`$()`只是你的命令。

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2016-03-18T01:00:28.417

在某些情况下可能适合的替代方法是将命令的结果分配给变量：

```
$ DUMMY=$( grep root /etc/passwd 2>&1 )
$ echo $?
0
$ DUMMY=$( grep r00t /etc/passwd 2>&1 )
$ echo $?
1 
```

由于 Bash 和其他 POSIX 命令行解释器不将变量赋值视为命令，因此尊重当前命令的返回码。

**注意：**带有`typeset`or`declare`关键字的赋值被认为是一个命令，因此在 case 中评估的返回码是赋值本身，而不是在子 shell 中执行的命令：

```
$ declare DUMMY=$( grep r00t /etc/passwd 2>&1 )
$ echo $?
0 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2009-03-05T23:44:57.513

像[andynormancx' post](https://stackoverflow.com/questions/617182/how-can-i-suppress-all-output-from-a-command-using-bash/617184#617184)一样，使用它（如果您在 Unix 环境中工作）：

```
scriptname > /dev/null 
```

或者您可以使用它（如果您在 Windows 环境中工作）：

```
scriptname > nul 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2017-05-09T21:51:46.837

看看**[Linux 文档项目](http://tldp.org/HOWTO/Bash-Prog-Intro-HOWTO-3.html)**中的这个例子：

> **3.6 示例：stderr 和 stdout 2 文件**
> 
> 这会将程序的每个输出放置到文件中。如果您希望命令以绝对静默方式传递，这有时适用于 cron 条目。
> 
> ```
>  rm -f $(find / -name core) &> /dev/null 
> ```

也就是说，您可以使用这个简单的重定向：

```
/path/to/command &>/dev/null 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2013-02-12T20:50:26.520

这是另一种选择

```
scriptname |& : 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-06-17T12:09:00.763

在您的脚本中，您可以将以下内容添加到您知道将提供输出的行中：

```
some_code 2>>/dev/null 
```

否则你也可以试试

```
some_code >>/dev/null 
```

# c++ - 使用傅里叶描述符逼近形状边界

> ID：617185
> 
> 赞同：2
> 
> 时间：2009-03-05T23:39:31.427
> 
> 标签：c++, image-processing, fft, approximation, boundary

我试图通过使用傅里叶描述符来近似形状边界。我知道这是可以做到的，因为我在课堂上了解到它并在多个来源中阅读过它。

为了获得 (x,y) 坐标边界的傅里叶描述符，我执行以下操作： 1) 将 (x,y) 坐标转换为 x + iy 形式的复数 2) 将这组新数字输入 1D傅里叶变换 3) 输出是傅里叶描述符

为了近似边界，我简单地移除（设置为零）高频，然后应用傅里叶逆变换，然后将复数转换回 (x,y) 坐标，然后从这组新坐标重建图像。我的项目的目标是根据我设置为零的项的数量来找出我可以近似边界的程度。

我的问题是，每当我将任何频率设置为 0 时，我的输出图像都会非常小，并且会以非常奇怪的模式出现。

我在下面提供了一个示例。输入图像是一个普通的正方形。给出的第一个输出图像是使用所有傅里叶描述符正常重建的图像。请注意，整个边界不存在，因为边界像素的数量被采样为 256，并且我在输出时没有费心连接点。另请注意，输出被翻译到左下角，这是故意的。第二个输出图像是当我只使用前 128 个频率时。

[输入图片 http://img19.imageshack.us/my.php?image=square0.bmp](http://img19.imageshack.us/my.php?image=square0.bmp)

[输出图像 1：所有频率 http://img27.imageshack.us/my.php?image=square0normal.bmp](http://img27.imageshack.us/my.php?image=square0normal.bmp)

[输出图像 2：频率的前半部分 http://img23.imageshack.us/my.php?image=square0out.bmp](http://img23.imageshack.us/my.php?image=square0out.bmp)

有谁知道为什么会发生这种情况？

**编辑：**第一次把图像放在这里，不知道为什么它们没有出现..这里是链接：
[输入图像](http://img19.imageshack.us/my.php?image=square0.bmp)
[输出1](http://img27.imageshack.us/my.php?image=square0normal.bmp)
[输出2](http://img23.imageshack.us/my.php?image=square0out.bmp)

这里还有[一个文档的链接，它有点讨论这个问题](http://homepages.inf.ed.ac.uk/rbf/CVonline/LOCAL_COPIES/MORSE/boundary-rep-desc.pdf)，它从第 5 页的末尾开始。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-06T02:50:17.863

如果你扔掉低频而不是高频，你得到的结果就是预期的。你确定哪个频率是哪个？

# c++ - 使用 MSVC++ 9 进行 C 编程的建议

> ID：617192
> 
> 赞同：2
> 
> 时间：2009-03-05T23:44:08.527
> 
> 标签：c++, c, visual-c++

大家好。我对编程并不陌生，但我是 C 和 C++ 编码的初学者。到目前为止，我只知道 C 语言的基础知识以及如何编写小而简单的程序。我对长期学习 C++ 不感兴趣，但我有兴趣成为流利的 C 程序员。我的困境是严格为 C 编程（不是 C++）适应 MS Visual Studio 2008 环境。目前我只编写了一些基本的 C 控制台应用程序并在此环境中构建它们。

话虽如此，我会喜欢一些关于从哪里开始的建议。我有一些不错的 C 编程书籍可以学习，所以学习整个 C 语言对我来说不会是一个问题（我多年来一直在使用 Delphi 和 VB 进行编程）。我需要一些建议是为纯 C 编程选择一个好的商业 IDE。我想在 Windows 中创建 GUI 应用程序，而不仅仅是控制台应用程序。我在 Windows 中没有找到很多 C 编码 GUI 应用程序的资源，主要是 C++ GUI 应用程序开发。在我看来，MSVC++ 9 非常适合 C++ 开发，而 C 是一个奇怪的人。任何关于从哪里开始的建议将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-05T23:58:35.233

我不会太担心 C 和 C++ 代码之间的划分。如果您想坚持使用 C 编程，您仍然可以获得 C++ 编译器的好处。C++ 编译器不会强迫您编写面向对象的代码，它只是让通用的、面向对象的代码更方便。

您当然不需要编写面向对象的 C++ 代码来利用 VC2008。毕竟，Win32 本质上是一个函数式 API（与 MFC 等面向对象的框架相反）。

总而言之，我认为用于纯 C 编程的良好商业 IDE 是 VC2008 IDE。如果您选择进行纯函数式 C 开发，它为您提供了一个非常好的调试环境，没有任何缺点。要进行 GUI 开发，您需要使用 Win32 API。那里有很多描述 API 的好书，但我会推荐 Charles Petzold 的“Programming Windows”，它很好地概述了 API。我还推荐 Everett N. McKay 和 Mike Woodring 的“调试 Windows 程序”（我喜欢这本书，它是我的调试圣经）。

祝你好运。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-06T07:37:49.777

我看不出用 C 语言的 windows api 编程窗口有什么可怕的困难。而且我肯定看不出有什么好的理由选择 C++ 而不是 C，你不会告诉我 MFC 比 win api“更简单” .

Pelles C 有一个很好的资源编辑器，肯定可以很好地使用。我们自己使用 lcc-win32 工具进行 Win 开发，并且您在运行 wedit 时所看到的一切都是在没有自己的工具的情况下使用的。所以我们对它们的工作很有信心。它可能需要一些时间来“沉入”，但无处不在。而且复杂性远低于现代“工具”附近的任何东西。一个问题是什么让 C++ 变得更好？直到 Charles Petzhold 编程窗口，您可以轻松地使用它来学习 C 编程窗口。

我只能说我们早在 15 年前就开始编写 lcc-win32 了。它仍然运行，我们不必“重写”任何一个，因为另一个 Windows 版本已经出来了。整个下载大约 5 MB 左右，它包含编译器、链接器、汇编器、资源编辑器、集成开发环境和数百个库。只是下载另一个编译器是在 elswhere > 100 MB“事件”。

问候

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-06T06:55:15.903

我从未尝试过（还），但 Pelles C 似乎是您可能想看看的东西：

*   [http://www.smorgasbordet.com/pellesc/](http://www.smorgasbordet.com/pellesc/)

请注意，VS2009 可以很好地处理 C - 我假设您希望 GUI 设计工具输出 C 代码而不是 C++。Pelles IDE 在这方面提供了多少帮助，我不知道。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-06T00:04:36.933

您找不到很多关于用 C 编写 Windows GUI 的书籍是有原因的——它非常非常困难且冗长！您会发现，与使用 C++ 类库或诸如 Delphi 等 RAD 工具相比，您需要编写的代码至少多 10 倍（也许是 100 倍）。为什么你如此坚决地只使用 C 语言？

# iphone - 如何检测我的 appengine 应用程序是否正在被 iphone/ipod touch 访问？

> ID：617202
> 
> 赞同：11
> 
> 时间：2009-03-05T23:46:26.900
> 
> 标签：iphone, python, google-app-engine, web-applications

如果通过 iphone/ipod touch 访问页面，我需要以不同的方式呈现页面。我想信息在请求对象中，但是语法是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-10T20:27:02.740

这是我一直在寻找的语法，适用于 iphone 和 ipod touch：

```
uastring = self.request.headers.get('user_agent')
if "Mobile" in uastring and "Safari" in uastring:
  # do iphone / ipod stuff 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-05T23:53:04.420

[本文](http://www.askdavetaylor.com/detect_apple_iphone_user_web_site_server.html)概述了通过检查 HTTP_USER_AGENT 代理变量来检测 iPhone 的几种方法。根据您要在哪里进行检查（HTML 级别、Javascript、CSS 等），我相信您可以将其推断到您的 Python 应用程序中。对不起，我不是蟒蛇人。8^D

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-06T08:31:02.677

苹果网站上的[在 iPhone 用户代理字符串上使用 Safari](http://developer.apple.com/safari/library/documentation/AppleApplications/Reference/SafariWebContent/OptimizingforSafarioniPhone/chapter_3_section_3.html)文章指出了 iPhone 和 iPod touch 的不同用户代理。

```
Mozilla/5.0 (iPhone; U; CPU like Mac OS X; en) AppleWebKit/420+ (KHTML, like Gecko) Version/3.0 Mobile/1A543 Safari/419.3
Mozilla/5.0 (iPod; U; CPU like Mac OS X; en) AppleWebKit/420.1 (KHTML, like Gecko) Version/3.0 Mobile/4A93 Safari/419.3
Mozilla/5.0 (iPhone; U; CPU iPhone OS 2_0 like Mac OS X; en-us) AppleWebKit/525.18.1 (KHTML, like Gecko) Version/3.1.1 Mobile/XXXXX Safari/525.20 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-06T08:17:57.170

以下是如何在 Django 中将其实现为中间件，假设这是您在 appengine 上使用的。

```
class DetectiPhone(object):
    def process_request(self, request):
        if 'HTTP_USER_AGENT' in request.META and request.META['HTTP_USER_AGENT'].find('(iPhone') >= 0:
            request.META['iPhone'] = True 
```

基本上在 HTTP_USER_AGENT 中寻找“iPhone”。请注意，iPod Touch 的签名与 iPhone 略有不同，因此是广泛的“iPhone”搜索，而不是更严格的搜索。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-06T08:25:39.617

如果您使用的是标准 webapp 框架，则用户代理将位于请求实例中。这应该足够好：

```
 if "iPhone" in request.headers["User-Agent"]:
    # do iPhone logic 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-05T23:53:29.863

检查用户代理。这将是

> Mozilla/5.0 (iPhone; U; CPU like Mac OS X; en) AppleWebKit/420+ (KHTML, like Gecko) Version/3.0 Mobile/1A543a Safari/419.3

我不确定如何使用 appengine 执行此操作，但可以在此处找到等效的 PHP 代码：http: [//www.mattcutts.com/blog/iphone-user-agent/](http://www.mattcutts.com/blog/iphone-user-agent/)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-06T12:39:39.820

```
import os

class MainPage(webapp.RequestHandler):
  @login_required
  def get(self):
    userAgent = os.environ['HTTP_USER_AGENT']
    if userAgent.find('iPhone') > 0:
      self.response.out.write('iPhone support is coming soon...')
    else:
      self.response.out.write('Hey... you are not from iPhone...') 
```

# .net - 德尔福和.NET。使用 Visual Studio

> ID：617203
> 
> 赞同：3
> 
> 时间：2009-03-05T23:46:27.430
> 
> 标签：.net, visual-studio, delphi

我有一个用 Delphi 4 编写的旧项目。我正在寻找一种方法：

1.  在 .NET 中使用该代码进行最少的更改
2.  使用该 Delphi 代码中的其他 .NET 程序集
3.  使用 Visual Studio 处理将包含 Delphi 项目和 C# 项目的解决方案。

那可能吗？我需要什么？

谢谢

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-06T00:00:49.360

很不幸的是，不行。

CodeGear 从未在任何版本的 Visual Studio 中支持 Delphi for .NET，并且 VCL for .NET 在 Delphi 2007 之后就死了。

新的“Delphi”.NET 解决方案是 Delphi Prism，它*可以*在 Visual Studio 中工作；不幸的是，它不能向后兼容 Delphi 代码。[Rem Objects](http://www.remobjects.com)（Prism 编译器的实际所有者，以前称为 Oxygene）提供了一个实用应用程序，它试图自动转换语法差异，但我还没有尝试过任何东西。

您可以通过将您可以转换的内容转换为 ActiveX 控件并使用 COM 使它们在 .NET 中可用，从而重用一些旧的 Delphi 4 代码。然后，您可以在 Visual Studio 中使用 C#（以及 Prism，如果您想要或需要它）来做您需要的事情。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-06T17:14:45.303

你可以看看[Remobjects Hydra](http://www.remobjects.com/hydra.aspx)这将允许你混合 win32 和 .net 程序集。不确定是否支持 Delphi 4，但移植到受支持的更高版本的 Delphi 应该没有问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-05T23:50:31.413

如果您的 Delphi 代码已经在基于 COM 的库中，则可以通过 RCW（运行时可调用包装器）从 .net 调用它，当您添加 COM 组件作为参考时，IDE 会自动生成该代码。类似地，您想从 Delphi 调用的任何组件都可以包装在 CCW（COM 可调用包装器）中并像本机一样调用。

# c# - System.Drawing：如何控制字体粗细？

> ID：617213
> 
> 赞同：1
> 
> 时间：2009-03-05T23:51:28.743
> 
> 标签：c#, .net, system.drawing

我发现我无法更改字体粗细，即使我是通过 win32 pinvoke 创建的。我正在使用 Graphics.DrawString 来使用字体。我很困惑，找不到任何东西。

```
[DllImport("gdi32.dll")]
static extern IntPtr CreateFont(int nHeight, int nWidth, int nEscapement,
   int nOrientation, int fnWeight, uint fdwItalic, uint fdwUnderline, uint
   fdwStrikeOut, uint fdwCharSet, uint fdwOutputPrecision, uint
   fdwClipPrecision, uint fdwQuality, uint fdwPitchAndFamily, string lpszFace);

private void CreateLabelFont()
{
    // Remove -13 magic number later.
    IntPtr hFont = CreateFont(-13, 0, 0, 0, 100, 0, 0, 0, 1, 0, 0, 0, 0, "Arial\0");
    labelFont = Font.FromHfont(hFont);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-05T23:59:09.147

来自 MSDN 参考[`CreateFont`](http://msdn.microsoft.com/en-us/library/dd183499(VS.85).aspx)：

> **fnWeight [in]** 在 0 到 1000 范围内指定字体的粗细。例如，400 是正常的，700 是粗体。如果此值为零，则使用默认权重。

这意味着您在创建字体时固定权重。如果您需要不同的字体粗细，则必须`CreateFont`多次调用。

# ruby - 按日期排序的更好方法是什么？

> ID：617220
> 
> 赞同：2
> 
> 时间：2009-03-05T23:54:04.993
> 
> 标签：ruby, date, sorting

我有一个事件数组，我想将它们分成一个基于 event_date 的二维数组（它返回一个时间对象）。但我希望它是日期的一部分。这是我到目前为止所拥有的：

```
def divide_events_by_day(events)
  # Sort, so we can start with the first day.
  events = events.sort { |x,y| x.event_date <=> y.event_date }
  days = []
  current_date = events[0].event_date # A Time object.
                                      # With meaningful hours and minutes.
  while events.length > 0 do
    # Find events for the current date.
    day_events = events.select { |e|
      (e.event_date.year == current_date.year) && 
        (e.event_date.yday == current_date.yday)
    }
    # Move them to their subarray.
    days << day_events
    events = events - day_events

    # Advance the current_date by one day.
    current_date = (current_date + (60 * 60 * 24))
  end
  days
end 
```

有什么建议可以让它更简单或更快吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-06T00:26:05.900

首先，你可以尝试这样的事情：

```
def divide_events_by_day(events)
    days = [[]]
    events.sort_by { |x| x.event_date }.each { |e| 
        if days.last.empty? or days.last.event_date_date == e.event_date.date
            days.last << e
          else
            days << [e]
          end
        }
    days
    end 
```

它不会产生空旷的日子，但除此之外，你的日子非常紧。

我的机器上有一个`Time#date`方法，但在干净的分发版本 (1.8.7) 中没有看到它，因此您可能需要添加如下内容：

```
class Time
    def date
        to_i/(60*60*24)
        end
    end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-06T00:25:06.027

这应该更快：

```
def divide(events)
  hash = {}
  events.each do |event| 
    key = "#{event.event_date.year} #{event.event_date.yday}" 
    hash[key] ||= []
    hash[key] << event
  end
  hash.to_a.sort do|pair1,pair2| 
    pair1[0] <=> pair2[0]
  end.map do |pair| 
    pair[1].sort{|x,y| x.event_date <=> y.event_date}
  end
end 
```

# c# - 如何更改 .NET 中菜单条和菜单的默认背景颜色？

> ID：617224
> 
> 赞同：3
> 
> 时间：2009-03-05T23:56:57.950
> 
> 标签：c#, .net, visual-studio, menu

这些天来使用 Visual C#（特别是 Visual C# 2008），菜单条和菜单的默认颜色似乎是蓝色，这对我来说看起来很奇怪，而且我真的很想覆盖它。我猜 Visual Studio 正在从我选择的系统主题或其他东西中选择这种蓝色，但是在我的系统上运行的其他 Windows 应用程序都没有这种蓝色，所以我不知道为什么我的 .NET 应用程序必须有它. ;)

无论如何，我注意到如果我使用旧版本的 Visual Studio (Visual Studio.NET) 创建应用程序，菜单条和菜单的默认背景颜色是您希望看到的标准灰色。这是我认为的问题的一种解决方案，但它似乎有点愚蠢，我真的很想找到一种方法在当前版本的 Visual C# 中覆盖它。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-09T13:54:27.977

将 MenuStrip 的“ **RenderMode** ”选项设置为“ **System** ”而不是“managerRenderMode”

:)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-06T00:08:12.993

您是否尝试过设置 menuStrip 的背景颜色？您应该能够执行以下操作：

```
this.menuStrip1.BackColor = Color.FromKnownColor(KnownColor.Control); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-07-21T22:04:19.887

您可以制作自己的渲染器

```
 public class BrowserMenuRenderer : ToolStripProfessionalRenderer
{
    public BrowserMenuRenderer() : base(new BrowserColors()) {}
}
public class BrowserColors : ProfessionalColorTable
{
    public override Color MenuItemSelected
    {
        get { return Color.FromArgb(30, 30, 30); }
    }
    public override Color MenuItemBorder
    {
        get { return Color.FromArgb(30, 30, 30); }
    }
    public override Color MenuItemSelectedGradientBegin
    {
        get { return Color.FromArgb(30, 30, 30); }
    }
    public override Color MenuItemSelectedGradientEnd
    {
        get { return Color.FromArgb(30, 30, 30); }
    }
} 
```

然后，您只需将 menustrip 的渲染器设置为 YourRenderer

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-06T02:41:45.420

DotNet 1.x 没有 MenuStrip，而是使用标准的 Windows 菜单。

DotNet 2.0 及更高版本具有 MenuStrip，VS 7 及更高版本从工具箱中删除 MainMenu 并用使用 Office 的 MenuStrip 替换它~~Xp~~2003 主题，因此 MenuStrip 和 ToolStrip 采用蓝色配色方案。

MainMenu 仍然可以添加到标准 Windows 菜单的工具箱中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-07-21T05:01:33.790

您可以使用渲染模式，但这只会将系统主题设置为默认值。.net 允许您更改背景颜色和颜色，但是当您将鼠标悬停在它上面时，它仍然显示默认颜色。这是一种解决方法...

通过使用 "DropDownOpening" 、 "DropDownClosed" 和 "MouseEnter" 事件，这非常简单。

```
private void fileToolStripMenuItem_DropDownOpening(object sender, EventArgs e){

    // When the user clicks on "File" it will change to red.
    fileToolStripMenuItem.ForeColor = Color.Red;
} 
```

```
private void testToolStripMenuItem_MouseEnter(object sender, EventArgs e){

    // When the user hovers over a child of "file" called "test", "file" turns orange.
    fileToolStripMenuItem.ForeColor = Color.Orange;
} 
```

```
private void test2ToolStripMenuItem_MouseEnter(object sender, EventArgs e){

    // When the user hovers on a child of "file" called "test2", "file" turns blue.
    fileToolStripMenuItem.ForeColor = Color.Blue;
} 
```

```
private void fileToolStripMenuItem_DropDownClosed(object sender, EventArgs e){

    // When the user leaves the "file" menu, it gets restored back to black.
    fileToolStripMenuItem.ForeColor = Color.Black;
} 
```

# nhibernate - 审计日志策略

> ID：617225
> 
> 赞同：7
> 
> 时间：2009-03-05T23:57:03.223
> 
> 标签：nhibernate, logging, audit

我正在尝试确定在我的应用程序中审计日志记录的最佳方法。日志的主要原因是报告事件的顺序（更改）。

我有一个对象层次结构，当该层次结构的任何部分发生变化时，我需要在以后创建报告。

我认为我有三个选择：

1.  每个表都有一个日志，因此匹配对象的层次结构，然后为报告创建一个视图。
2.  扁平化层次结构和去规范化表格，使报告更容易 - 简单的选择语句。
3.  拥有一个日志表并记录每个更改，这使得报告更难但更灵活地更改更改。

我目前倾向于选项1。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2010-01-08T23:06:30.037

我必须谈谈这个话题，即使它已经过时了。

只有一个审计表通常是一个糟糕的主意，因为当一切都命中该表时，您将在数据库中产生锁定问题。为每个表使用单独的审计表。

让应用程序进行审计也是一个糟糕的主意。审计必须在数据库级别进行，否则您可能会丢失一些信息。数据不仅仅来自大多数数据库中的应用程序；当您需要将所有 10,000,000 种产品的价格提高 10% 时，没有人会从用户界面一次更改所有产品的价格。审计应该捕捉所有的变化，而不仅仅是其中的一部分。这应该在大多数数据库中的触发器中完成（SQL Server 2008 具有内置的审计功能）。一些最糟糕的潜在变化（员工进行欺诈或想要恶意破坏数据）也经常来自应用程序以外的地方，特别是如果您允许用户访问表级访问（您不应该在任何财务数据库或包含个人信息）。从应用程序进行审计不会捕捉到这一点。开发人员经常忘记，在保护他们的数据时，外部来源并不是唯一的威胁。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-06T00:01:01.390

审核日志基本上是按时间顺序排列的已发生事件、执行这些事件的人员以及事件内容的列表。

我认为平面视图会更好，因为它可以轻松订购和查询。所以我更倾向于你的选项#2/#3。

包括交易类型、时间、用户 ID、更改内容的描述以及与您的产品相关的其他相关信息。

随着时间的推移，您还可以将内容添加到您的产品中，而无需不断修改审核日志模块。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-06T00:15:07.457

如果出于审计目的，我将使用真正的仅附加介质，而不是同一数据库中的表/表。

您建议将其用于更改历史记录-在这种情况下，我将重组您的应用程序/数据库以首先记录实际事件，而不仅仅是当前状态。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-06T00:33:50.267

我会选择（2）和（3）：为所有审计条目创建一个表。

平面视图是好的，前提是额外的工作压平不会影响性能。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-06T00:39:16.943

您可以查看 AOP 框架来帮助解决此问题。它将允许您在任何/所有方法的开头或结尾注入日志记录功能。如果你走这条路，它可能有助于定义存储日志数据的意义。

# drag-and-drop - 具有自定义行为的文件夹“投递箱”

> ID：617233
> 
> 赞同：0
> 
> 时间：2009-03-05T23:59:59.503
> 
> 标签：drag-and-drop, directory

我正在考虑尝试创建一个“投递箱”应用程序，该应用程序可以在您将文件放入文件夹时自动组织文件。我总是在我的桌面上得到一堆随机文件，我认为能够将它们拖到桌面上的图标/文件夹并根据某些规则（文件扩展名）自动将它们分类到其他位置会很有用，命名约定等）

我不确定如何实现这一点。谁能指出我如何完成这样的事情的任何资源/提示？也许某种拖放文件夹扩展？

一个想法是有一个后台进程定期检查文件夹并只是移动文件，但如果没有后台进程自动发生这种情况会很酷。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-06T00:11:40.770

在 C# [FileSystemWatcher](http://msdn.microsoft.com/en-us/library/system.io.filesystemwatcher.aspx)是你的朋友，检查一个[小教程](http://www.switchonthecode.com/tutorials/csharp-snippet-tutorial-using-the-filesystemwatcher-class)。它只是 Win32 上[ReadDirectoryChangesW](http://msdn.microsoft.com/en-us/library/aa365465.aspx)的包装器，因此如果您使用另一种语言，您可以使用它。Linux 通过[dnotify](http://en.wikipedia.org/wiki/Dnotify)提供相同的功能。

# svn - svn switch --relocate 不持久

> ID：617239
> 
> 赞同：4
> 
> 时间：2009-03-06T00:03:01.260
> 
> 标签：svn

我们已将 subversion 存储库移至另一台服务器。我已经运行`svn swtich --relocate`将我的开发工作站存储库更改为新位置。

问题是它看起来像它工作，因为没有报告错误消息。但是当我在命令之后检查存储库的位置时，它没有更新。

有谁知道这可能是什么原因或如何解决问题？

我在 XP 上运行具有本地管理员权限的用户。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-06T02:03:23.450

我正在运行以下命令。

```
svn switch --relocate svn://oldrepositry/trunk svn://newrepository/trunk 
```

我发现运行这个命令我能够持久化重定位。

```
svn switch --relocate svn://oldrepositry svn://newrepository 
```

我没有检查整个存储库，只是主干。

本文可能会阐明为什么第一个命令会静默失败。它表明 from url 比“Repository Root”（您可以使用“svn info”找到）长可能会导致此问题。

[http://archives.devshed.com/forums/development-94/new--svn-switch---relocate-silently-fails-1264627.html](http://archives.devshed.com/forums/development-94/new--svn-switch---relocate-silently-fails-1264627.html)

# asp.net-mvc - ASP.Net MVC RC2 Ajax.Form 成为 Ajax.BeginForm 停止工作

> ID：617244
> 
> 赞同：1
> 
> 时间：2009-03-06T00:06:19.613
> 
> 标签：asp.net-mvc

我们刚刚从 TCP 4 升级到 .net 的 MVC 框架的 RC 2。以下代码有效，现在只是进行常规发布（即导航到创建页面）：

```
<% using (Ajax.BeginForm("Create", "LEEDBoardItem", new AjaxOptions()
   {
    UpdateTargetId = "LEEDBoardDisplay",
    HttpMethod = "POST"
   }))
{ %>
 <%= Html.Hidden("Selling_Color_Name", ViewData.Model.SelectedColor == null ? "" : ViewData.Model.SelectedColor.SellingColorName) %>
 <%= Html.Hidden("Selling_Color_Number", ViewData.Model.SelectedColor == null ? "" : ViewData.Model.SelectedColor.SellingColorNumber) %>
 <%= Html.Hidden("Selling_Style_Name", ViewData.Model.Style_Name) %>
 <%= Html.Hidden("Selling_Style_Number", ViewData.Model.Style_Number) %>
 <%= Html.AntiForgeryToken() %>
 <% Html.RenderPartial("~/Views/LEEDBoardItem/Form.ascx", new LEEDBoardItem());%>
 <input type="submit" value="New" />
<% } %>

```

有人对 RC2 有类似的问题吗？我可以切换到 ActionLink，但我宁愿使用表单帖子。

谢谢！布赖恩

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-06T03:49:39.500

我唯一能想到的就是确保您从 RC2 中获取最新的 .js 文件并将它们放入您的项目中并正确引用它们。

# c++ - 来自 CreateWindow/CreateDialog 的 HWND 可以从另一个线程获取消息吗？

> ID：617248
> 
> 赞同：3
> 
> 时间：2009-03-06T00:07:32.527
> 
> 标签：c++, c, windows, multithreading, winapi

使用 Win32 API，是否可以在一个线程中创建一个窗口或对话框，然后从另一个线程为它收集事件？

HWND 是否与线程绑定？

尝试下面的人为示例，我从未看到 GetMessage() 触发。

```
HWND g_hWnd;

DWORD WINAPI myThreadProc(LPVOID lpParam)
{
    while(GetMessage(&msg, hWnd, 0, 0) > 0)
    {
       ...
    }

}

int WINAPI WinMain(HINSTANCE hInstance, HINSTANCE hPrevInstance, LPSTR lpCmdLine, int nShowCmd)
{
    hWnd = CreateDialog(hInstance, MAKEINTRESOURCE(IDD_MYDIALOG), 0, myDlgProc);
    CreateThread(NULL, 0 myThreadProc, NULL, 0, NULL);
    ...
}

```

但在这里，我愿意。

```
HWND g_hWnd;
HINSTANCE g_hInstance；

DWORD WINAPI myThreadProc(LPVOID lpParam)
{
    hWnd = CreateDialog(hInstance, MAKEINTRESOURCE(IDD_MYDIALOG), 0, myDlgProc);

    while(GetMessage(&msg, hWnd, 0, 0) > 0)
    {
       ...
    }

}

int WINAPI WinMain(HINSTANCE hInstance, HINSTANCE hPrevInstance, LPSTR lpCmdLine, int nShowCmd)
{
    g_hInstance = hInstance;
    CreateThread(NULL, 0 myThreadProc, NULL, 0, NULL);
    ...
}

```

有人可以解释我所看到的吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-06T00:12:23.327

不。

GetMessage 在当前线程的输入队列中返回消息。HWND 参数是一个过滤器，因此 GetMessage 只返回当前线程的输入队列中用于该窗口的消息。

Windows 具有线程关联性 - 用于窗口的消息在创建并因此拥有该窗口的线程上得到处理。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-06T00:11:33.657

从[MSDN](http://msdn.microsoft.com/en-us/library/ms644936(VS.85).aspx)：

> GetMessage 函数从调用线程的消息队列中检索消息

所以不，你描述的不是直接可能的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-06T00:12:29.473

在您的第一个示例中，Dialog 和[GetMessage](http://msdn.microsoft.com/en-us/library/ms644936(VS.85).aspx)位于不同的线程中。文件说：

> GetMessage 函数从调用线程的消息队列中检索消息。

第二个示例有效，因为调用线程 (for `GetMessage`) 也拥有`Dialog`.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-07T10:20:12.267

使用[AttachThreadInput](http://msdn.microsoft.com/en-us/library/ms681956(VS.85).aspx)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-06T00:19:12.703

在您的示例程序中，在创建窗口后完成。

但无论如何在win32中所有线程都有自己的消息队列。

并且所有消息队列都会为在此线程中创建的窗口获取消息。

看：

[http://msdn.microsoft.com/en-us/library/ms644928](http://msdn.microsoft.com/en-us/library/ms644928(VS.85).aspx) (VS.85).aspx（使用消息和消息队列）

[http://msdn.microsoft.com/en-us/library/ms644936(VS.85).aspx（GetMessage](http://msdn.microsoft.com/en-us/library/ms644936(VS.85).aspx)函数）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-06T05:09:08.170

您当然可以更改为任何窗口处理消息的窗口过程。检查 SetWindowLong 函数 - [http://msdn.microsoft.com/en-us/library/ms633591(VS.85).aspx](http://msdn.microsoft.com/en-us/library/ms633591(VS.85).aspx) - 关于新 proc 的地址空间有一些规则。我建议使用 dll。另一种方法是对窗口消息队列进行子类化。

* * *

## 回答 #7

> 赞同：-3
> 
> 时间：2009-03-07T10:12:10.803

当然可以 ！

只需使用远程代码注入！（非常经典！）

# .net - 有没有人成功地将免注册 COM 与 .NET 组件一起使用？

> ID：617253
> 
> 赞同：21
> 
> 时间：2009-03-06T00:10:20.947
> 
> 标签：.net, com, regfreecom, winsxs, sxs

直到最近，我们还在为我们的本机和 .NET COM 组件愉快地使用[免注册](http://msdn.microsoft.com/en-us/library/ms973913.aspx)COM。但是，我们遇到了一个奇怪的问题，我们的应用程序在 Windows XP SP3 上开始随机崩溃（但不是在 vista 上），因为我们只更改了 .NET 程序集的版本号以从候选发布版移动到发布版。（你不只是讨厌墨菲定律吗？）

经过许多人日和磨牙，我们发现这个问题是[sxs.dll](http://support.microsoft.com/kb/943232)中的一个已知错误，它在检索有关 .NET 类的信息时会导致堆损坏。有一个热修复程序可以使问题消失，但热修复程序并不打算重新分发。

我们有点难过，免注册的 COM 实现中存在如此可怕的错误。有没有人成功地为 .NET 组件使用免注册 COM？你是如何解决这个问题的？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-19T10:45:38.787

这个问题与 SxS 如何计算类信息的大小有关。程序集的版本号是此信息的一部分。

由于它使用的是候选发布版本号，也许您的解决方法是使发布的版本号与 RC 发布的长度相同。

如果这对您不起作用，则有一个已建立的流程来请求修补程序的重新分发权限。我会聘请 Microsoft 客户支持来追求这条路线。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-08T05:32:23.417

我们对本机和 .NET 组件都使用免注册 COM。我们决定为这些组件使用固定的程序集版本号（主要是为了防止在重复重新填充具有动态内部版本号/* 的 .NET 组件时使注册表混乱）。不理想，但我们有其他方法来确定正在使用的给定组件的哪个版本（它们从不单独修补）。

这听起来确实是一个非常讨厌的问题！那篇知识库文章几乎让人觉得使用 SxS 是可选的……据我所知，这是实现无注册 COM 的唯一方法？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-20T06:09:41.760

仅供参考，现在可以直接下载修补程序：http: [//www.microsoft.com/en-us/download/details.aspx?id=27680](http://www.microsoft.com/en-us/download/details.aspx?id=27680)

# terminology - “捕获”返回值的术语是什么

> ID：617255
> 
> 赞同：4
> 
> 时间：2009-03-06T00:10:43.427
> 
> 标签：terminology

前几天我正在培训一位新开发人员，并意识到我不知道在变量中“捕获”返回值的实际术语。例如，考虑这个伪编码方法：

```
String updateString(newPart) {
  string += newPart;
  return string;
} 
```

假设调用它来简单地更新字符串 - 不需要返回值：

```
updateString("add this"); 
```

现在，假设我们想对返回的值做一些事情。我们想要更改调用，以便我们可以使用新更新的字符串。我发现自己在说“catch the return value”，意思是我想看看：

```
String returnedString = updateString("add this"); 
```

那么，如果您试图要求某人进行此更改，您会使用什么术语？它在不同的语言中是否不同（因为从技术上讲，您可能正在调用函数或方法，具体取决于语言）？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-06T00:14:37.270

**将**返回值分配*给变量*？

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-06T00:16:04.113

返回值可以分配或丢弃/忽略/不使用/[在此处插入同义词]。

没有真正的技术术语。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-06T00:13:34.213

我会说“returnedString 将使用 updateString 的返回值进行初始化”。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-06T00:14:17.800

“Catch”让我想到了异常，这有点误导。诸如“使用”或“存储”或“分配”之类的东西怎么样？

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-06T00:15:43.007

我知道的常见的：

*   您为变量赋值。
*   您将值存储到变量中。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-06T00:29:26.687

检查函数的返回值，不要忽略返回值

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-06T02:32:08.467

在示例中，您只是将函数的返回值分配给一个新变量。

在描述单行代码的行为时，返回值对于函数的使用不是必需的并不重要。然而，在更广泛的背景下，了解这个“有趣的返回值”服务的目的是非常重要的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-06T00:29:51.663

正如其他人所说，您所描述的确实没有一个词。但是，这里有一些术语供您参考：您给出的示例看起来可能是[Fluent Interface](http://www.martinfowler.com/bliki/FluentInterface.html)。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-06T02:01:53.843

我建议“缓存”，意思是存储它以备后用。也许你说“抓住”是有潜意识的原因。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2009-03-06T00:30:33.097

最好也说明目的而不是实现细节（因为实际实现在不同的编程语言中可能会有所不同）。

一般来说： - 保存调用的返回值。

如果您知道返回值是某事的结果： - 保存调用的结果。

如果您知道返回值是表示状态（例如错误）： - 保存调用的状态。

通过使用“保存”一词，您可以全面使用相同的语句，而不管该特定语言中使用何种机制来保存返回值。

# .net - 在两个 .net 应用程序之间共享“会话状态”类型数据的最佳方式

> ID：617256
> 
> 赞同：3
> 
> 时间：2009-03-06T00:10:45.033
> 
> 标签：.net, .net-2.0, session-state, state-server

我们有一个 Web 应用程序，开始时很小，添加的任何新功能都只是作为同一个项目的一部分，但是现在我们想为这些插件创建新项目......

我们创建了一个新项目，它继承了主项目的 global.asax，并且还可以访问主项目的 web.config，但是，在全局 asax 代码中有会话检查数据完整性，以查看用户是否已登录..这是我们遇到问题的地方..用户已登录，但站点错误指出他们未登录，因为插件项目无法访问由主项目设置的会话用户 ID。

目前我们没有使用会话状态服务器或 sql 状态服务器，我们希望避免使用它以避免对一些旧代码造成任何麻烦。

我们也不想走互斥锁的路线..如果可以的话，我们也想远离 Windows 编码......

会话发生的情况的站点概述：用户使用 asp 代码（.net 1.1 代码）登录 用户经过身份验证并成功登录，将该用户的 guid 发送到数据库，主项目（.net 2.0 代码）抓住它guid，获取用户数据并将用户 ID 存储在会话中。任何需要知道用户是谁的页面，都从 session("userid")

所以：我们创建另一个继承 global.asax 的项目，可以访问 web.config - 完成！

我们想要在此之上做的：让这个新项目包含一个页面（来自主项目的插件功能）让这个页面访问从主项目设置的会话（“userid”）。- 不知道该怎么做...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-06T00:42:27.780

我会在我的建议之前说，将复杂性保持在最低限度的*最佳*方法是**使用状态服务器**。这是他们旨在解决的问题。

说了这么多...

由于这两个应用程序必须在不同的进程中运行（因为它们在不同的运行时版本中），它们不能直接共享数据。

一种选择是使用 Web Services 或[Remoting](http://msdn.microsoft.com/en-us/library/d9w023sx.aspx)。[您可以拥有一个存储所有会话数据的 CustomSession 对象，并通过Guid](http://msdn.microsoft.com/en-us/library/system.guid.aspx)识别每个数据。您可以跟踪 Guid-CustomSession 在应用程序 A 中创建的所有现有会话，并通过查询字符串将 Guid 传递给应用程序 B。应用程序 B 可以通过 Web 服务或远程处理使用 Guid 查询应用程序 A，并获取相应的 CustomSession 对象. 你也可以反过来做同样的事情。

这里唯一的问题是，当从 App A 中的页面移动到 App B 中的页面时，您必须确保在 URL 中始终提供 Guid，反之亦然。应用程序总是可以检查会话是否不存在，以回退到使用 Guid 来查看其他应用程序是否有会话。

请注意，某些 .NET 数据结构（不多）在 .NET 1.1 和 2.0 之间的序列化方式不同，因此在通过远程处理或 Web 服务共享对象时，您可能需要考虑这一点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-06T01:02:42.990

我知道你说过你想远离会话状态服务器......

但我仍然认为这是最好的选择。特别是如果您计划共享更多数据而不仅仅是登录 ID，以实现未来的可扩展性和可维护性。通过会话状态服务器共享登录数据也比通过查询字符串等将其保存在客户端更安全。

但是同样，无论您最终共享会话数据是什么，就像另一位海报“Rex M”指出的那样，您需要小心您共享的会话数据类型以及它需要可序列化。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-06T05:17:23.360

使用 Web 服务或远程处理类似于会话状态服务器，不同之处在于您必须自己实现它——可能不值得付出努力。

如果您要自己执行此操作，还有一个之前未提及的问题：会话超时。您需要确保两个进程对上次使用会话的时间有相同的想法。如果你做的不对（我也遇到过这种情况），你可能会进入一种看起来像是登录到应用程序的一部分而不是另一部分的状态。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-09T13:32:21.740

Rex M：我们正在尝试在相同版本的 .net 之间共享会话数据。两者都在运行 .net 3.5，（在 .net 2.0 框架上运行）我们已经有了将登录数据转移到 2.0 框架的代码。

我们有主项目工作，但是我们想用模块添加到它上面，我们想简单地说，如果你添加另一个 .net Web 应用程序，不要使用命名空间，并设置会话状态服务器，设置你的引用，然后编译，一切都将是肉汁..

两个应用程序（试图与之共享会话数据的应用程序）都运行 2.0 框架，都在同一个应用程序池中，都具有相同的机器密钥和状态服务器信息，都运行在同一台机器上，只是在不同的文件夹中， （但是共享相同的父文件夹）

我们能做些什么来让它发挥作用吗？

（不使用 sql 状态服务器）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-06T01:12:00.923

您可以使用 cookie 来存储您的用户 ID。您的 1.1 和 2.0 应用程序都可以毫无问题地访问它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-15T15:29:43.680

在两个 Web 应用程序之间导航时，您可以使用一个或多个加密的查询字符串变量来传递，以便您可以在两个 Web 应用程序中查询并重新建立重要的会话变​​量。这是最简单的方法。

# c# - 属性构造函数在运行时的什么时间运行？

> ID：617273
> 
> 赞同：2
> 
> 时间：2009-03-06T00:17:06.920
> 
> 标签：c#, .net, attributes

试图找到一些关于属性复杂性的详细参考。任何帮助，将不胜感激。

在这一点上，我特别想知道属性构造函数在运行时的什么时间运行？

*   如果上课结束
*   如果它超过了一个属性
*   如果它结束了一个方法

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-06T00:23:35.687

当您对类型或 MemberInfo 调用 GetCustomAttributes() 时，将调用构造函数。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-06T00:24:01.957

阅读规范（C# 2.0 版本中的 17.3.2）未指定。只有从元数据转换为实例的方法是。

因此，您可能需要对不同的实现进行测试，因为如果未指定它，它必然会被不同地解释。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-06T00:22:06.003

唯一可以确定的是它会在需要之前被调用。没有定义调用构造函数的确切时间。

无论如何，行为是未指定的，所以你不应该依赖当前实现调用构造函数的时候。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-23T07:21:54.180

属性是存储元数据或类型信息的装饰。.Net 框架在创建实例时大量利用此类信息进行额外处理。

该属性仅在其他类询问时才构造，例如 Type.GetCustomAttributes()。因此，即使您可以创建自己的属性，然后询问您的自定义属性。

```
public class MyOwnAttribute: Attribute {} 
```

/* 在另一个类的某个时刻 */

```
void CheckIfClassIsDecoratedWithMyOwnAttribute()
{
    var instance = new MyClass();
    if (instance.GetType().GetCustomAttributes(typeof(MyOwnAttribute)))
    {
       //do whatever you want
    }
} 
```

# jquery - 在 JQuery 中交换行

> ID：617274
> 
> 赞同：29
> 
> 时间：2009-03-06T00:17:25.063
> 
> 标签：jquery

如果我有一个如下所示的表格，并且有一个上下箭头可以上下移动行，我将如何在 JQuery 中交换行？

```
<tr id="Row1">
  <td>Some label</td>
  <td>Some complex control</td>
</tr>
<tr id="Row2">
  <td>Some label</td>
  <td>Some complex control</td>
</tr>
<tr id="Row3">
  <td>Some label</td>
  <td>Some complex control</td>
</tr> 
```

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2009-09-10T16:10:59.120

这是另一个解决方案。

向下移动一行：

```
jQuery("#rowid").next().after(jQuery("#rowid")); 
```

向上移动一行：

```
jQuery("#rowid").prev().before(jQuery("#rowid")); 
```

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2009-03-06T00:22:04.723

```
$("#Row1").after($("#Row2")); 
```

将工作

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2014-05-28T06:33:55.787

这是一个稍微扩展的示例，希望您会发现它有用... :)

```
$('table').on('click', '.move-up', function () {
    var thisRow = $(this).closest('tr');
    var prevRow = thisRow.prev();
    if (prevRow.length) {
        prevRow.before(thisRow);
    }
});

$('table').on('click', '.move-down', function () {
    var thisRow = $(this).closest('tr');
    var nextRow = thisRow.next();
    if (nextRow.length) {
        nextRow.after(thisRow);
    }
}); 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-06T00:19:56.290

这是一个可以拖放表格行[的插件](http://www.isocra.com/2008/02/table-drag-and-drop-jquery-plugin/)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-03-06T00:22:59.527

要将 Row1 向下移动一步，您可以：

```
$me = $("#Row1");
$me.after($me.nextSibling()); 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2016-03-01T08:33:21.763

这是交换行的代码。让我们采取#Row1 和#Row3

```
$('#Row1').replaceWith($('#Row3').after($('#Row1').clone(true))); 
```

使用 clone(true) 以便也考虑事件。

如果要上下移动行，请使用此代码。向上移动行

```
var tableRow = $("#Row1");
tableRow.insertBefore(tableRow.prev()); 
```

向下移动行

```
var tableRow = $("#Row1");
tableRow.insertAfter(tableRow.next()); 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-06T00:23:58.010

我会尝试：

```
var tmp = $ ('#Row1')
$ ('#Row1').remove
$ ('#Row2').after ($ ('#Row1')) 
```

但我想最好交换行的内容而不是交换行本身，这样你就可以依赖编号。因此，

```
var tmp = $ ('#Row1').html ()
$ ('#Row1').html ($ ('#Row2').html ())
$ ('#Row2').html (tmp) 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-08-17T08:20:43.920

我正在使用拖放插件来交换表中的类别（带有子类别），并且在不工作之后。insertAfter 工作。 [类似的话题](https://stackoverflow.com/questions/6712706/jquery-change-the-order-of-two-rows-of-a-table)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-09-25T18:50:21.343

这是一个具有 3 个参数的通用函数：源行、目标行和一个布尔值，指示该行是向上还是向下移动。

```
var swapTR = function (sourceTR, targetTR, isBefore) {
    sourceTR.fadeOut(300, function () {
        sourceTR.remove();
        if (isBefore) {
            targetTR.before(sourceTR);
        }
        else {
            targetTR.after(sourceTR);
        }
        sourceTR.fadeIn(300);
        initializeEventsOnTR(sourceTR);
    });
}; 
```

你可以这样使用它：

```
swapTR(sourceTR, targetTR, true); 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-05-18T05:25:47.353

我通常做这样的事情：

```
<table id="mytable">
    <tr>
        <td>-------------ROW 1-----------</td>
        <td><input type="button" value="↑" class="move up" disabled /></td>
        <td><input type="button" value="↓" class="move down" /></td>
    </tr>
    <tr>
        <td>-------------ROW 2-----------</td>
        <td><input type="button" value="↑" class="move up" /></td>
        <td><input type="button" value="↓" class="move down" /></td>
    </tr>
    <tr>
        <td>-------------ROW 3-----------</td>
        <td><input type="button" value="↑" class="move up" /></td>
        <td><input type="button" value="↓" class="move down" /></td>
    </tr>
    <tr>
        <td>-------------ROW 4-----------</td>
        <td><input type="button" value="↑" class="move up" /></td>
        <td><input type="button" value="↓" class="move down" disabled /></td>
    </tr>
</table>
<script>
    $('#mytable input.move').click(function() {
        var row = $(this).closest('tr');
        if ($(this).hasClass('up')){
            row.prev().before(row);
        }

        else{
            row.next().after(row);
        }            

        $(this).closest('table').find('tr:first').find('td:eq(1) input').prop('disabled', true);
        $(this).closest('table').find('tr:last').find('td:eq(2) input').prop('disabled', true );
        $(this).closest('table').find('tr').not(':first').not(':last').find('td:eq(1) input').prop('disabled', false);
        $(this).closest('table').find('tr').not(':first').not(':last').find('td:eq(2) input').prop('disabled', false);
    });
</script> 
```

[编辑器示例](https://www.w3schools.com/code/tryit.asp?filename=GA0U7QODB8MU)

因此，这也使第一行的 UP 和最后一行的 DOWN。如果在最后一行下降，您可以将其更改为再次上升。但这就是我需要它的方式。

问候

# network-programming - 多人/在线游戏编程中最常见的新手错误？

> ID：617281
> 
> 赞同：4
> 
> 时间：2009-03-06T00:19:43.140
> 
> 标签：network-programming

你见过什么样的新手错误，有什么解决方法？

一次又一次发生的一个是客户端没有针对服务器进行任何检查。

例如：

*   用户反编译 Flash 游戏源或监听网络流量，查看高分数据的去向，并发送虚假的高分，甚至不玩游戏。
*   用户使用培训师并获得甚至可能不会出现在当前级别的项目。这发送到服务器，如“客户端 X 得到项目 Y”，服务器只是接受。

简单的解决方法当然是将游戏客户端仅作为服务器的 API 处理。然后用户可以使用他们喜欢的训练器和其他内存操作，但服务器只是说你不能这样做。将服务器视为数据库，您可以在其中查询带有游戏规则的事物。

例如

*   客户端：开始游戏
*   客户端：连接到服务器
*   客户端：从服务器查询可用金额
*   用户：启用将钱设置为无限的培训师
*   客户端：server.buyItem('非常昂贵')
*   服务器：检查游戏状态（用户现在可以购买东西）。检查 player[0].money -> 没有奖金。
*   客户端：server.buyItem('可以得到这个')
*   服务器：检查游戏状态（用户现在可以购买东西）。检查 player[0].money，好的。player[0].items.add('can get this') 这将减少来自 player[0].money 的成本。然后通知客户端 send(player[0], 'items', 'can get this'); 发送（玩家[0]，'钱'，玩家[0].money）。

另一种方法是记录客户端的动作并将其发送到服务器播放它的高分服务器。当然，这会导致该记录非常大。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-06T00:37:51.113

毫无疑问，是对客户的盲目信任。在我正在开发的游戏中，我们现在将所有“业务逻辑”保留在服务器端，并且让客户端机器只向我们发送它们正在执行的命令；例如“玩家 B 想要向右移动”——但服务器会计算他们向右移动了多远。这会产生性能开销（当然还有滞后问题，可以更好地处理），因此可能的中间立场是在客户端进行繁重的计算，并且仍然在服务器上进行检查；例如，检查客户端的播放器在更新之间的移动时间是否超出预期；即，如果最大播放器速度为 200 个单位/秒，如果您在 0.5 秒后收到更新说他们移动了 150 个单位，请启动它们。

当然，这并不一定会阻止某人编写机器人来发送这些按键，因此还有其他方法可以防止这种情况发生。尽管如此，根本没有验证在很大程度上是一个新手错误（当我走捷径时，我承认我是有罪的）

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-06T02:37:32.760

Valve 采取的方法（至少在某一时刻）是让客户端和服务器独立地模拟游戏。然后服务器进行权威模拟并向所有客户端发送状态更新以纠正他们的错误/黑客攻击。

例如，如果您按向左箭头，您的角色将立即向左移动；无需等待服务器说“OK”。但是，如果事实证明你已经把自己穿过了一堵墙，下一次服务器更新会让你出现在墙旁边，因为服务器认为它是坚固的。

类似地，如果客户端看到一个角色向前移动，它会假设它会继续向前移动，直到服务器返回一个权威响应。

这种方法在服务器做出主要决策（并在模拟过程中执行健全性检查）时击败了黑客尝试，并且还处理了客户端在从服务器获得消息之前做出预测时的延迟。

另一个与“信任客户端”相关的大错误是认为您的网络协议不能被伪造。人们倾向于假设，如果他们向服务器发送二进制块，这些二进制块将永远不会被逆向工程，并且没有人会试图弄乱数据以查看会发生什么。这导致了各种各样的问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-06T02:00:13.443

你们几乎涵盖了服务器信任客户端可能出现的所有问题。我想不出其他真正的问题。

因此，与其告诉你什么可能出错，不如看看什么是对的。

[Valve 在他们的网络代码](http://www.rage3d.com/board/archive/index.php?t-33820957.html)中投入了大量工作。阅读它

# c# - 选择字典 使用 LINQ

> ID：617283
> 
> 赞同：190
> 
> 时间：2009-03-06T00:20:24.323
> 
> 标签：c#, .net, linq, generics

我已经使用“select”关键字和扩展方法来返回一个`IEnumerable<T>`带有 LINQ 的，但我需要返回一个泛型`Dictionary<T1, T2>`并且无法弄清楚。我从中学到的示例使用了类似于以下形式的内容：

```
IEnumerable<T> coll = from x in y 
    select new SomeClass{ prop1 = value1, prop2 = value2 }; 
```

我也对扩展方法做了同样的事情。我假设因为 a 中的项目 `Dictionary<T1, T2>`可以迭代，`KeyValuePair<T1, T2>`所以我可以将上面示例中的“SomeClass”替换为“ `new KeyValuePair<T1, T2> { ...`”，但这不起作用（键和值被标记为只读，所以我无法编译这段代码）。

这可能吗，还是我需要分多个步骤执行此操作？

谢谢。

* * *

## 回答 #1

> 赞同：323
> 
> 时间：2009-03-06T00:23:42.303

扩展方法还提供了一个[ToDictionary](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.todictionary.aspx)扩展。它使用起来相当简单，一般的用法是为键传递一个 lambda 选择器并将对象作为值，但您可以为键和值都传递一个 lambda 选择器。

```
class SomeObject
{
    public int ID { get; set; }
    public string Name { get; set; }
}

SomeObject[] objects = new SomeObject[]
{
    new SomeObject { ID = 1, Name = "Hello" },
    new SomeObject { ID = 2, Name = "World" }
};

Dictionary<int, string> objectDictionary = objects.ToDictionary(o => o.ID, o => o.Name); 
```

然后`objectDictionary[1]`将包含值“Hello”

* * *

## 回答 #2

> 赞同：56
> 
> 时间：2017-01-16T10:14:02.447

一个更明确的选择是将集合投影到 IEnumerable 中`KeyValuePair`，然后将其转换为 Dictionary。

```
Dictionary<int, string> dictionary = objects
    .Select(x=> new KeyValuePair<int, string>(x.Id, x.Name))
    .ToDictionary(x=>x.Key, x=>x.Value); 
```

* * *

## 回答 #3

> 赞同：45
> 
> 时间：2009-03-06T00:30:16.840

```
var dictionary = (from x in y 
                  select new SomeClass
                  {
                      prop1 = value1,
                      prop2 = value2
                  }
                  ).ToDictionary(item => item.prop1); 
```

这是假设这是字典`SomeClass.prop1`所需的。`Key`

# ruby - Time.advance 记录在哪里？

> ID：617284
> 
> 赞同：9
> 
> 时间：2009-03-06T00:20:27.520
> 
> 标签：ruby, api, time

在网上环顾四周，我发现 Ruby`Time`类有`Time#advance`. 这是在哪里记录的？[我在这里](http://apidock.com/ruby/Time)的 Ruby API 文档中没有提到它。

API 文档的搜索功能表明在任何地方都没有称为“高级”的方法。

尽管如此，在 IRB...

```
>> t = Time.now
=> Thu Mar 05 16:08:57 -0800 2009
>> t.advance :months => 1
=> Sun Apr 05 16:08:57 -0700 2009 
```

令我困惑的另一件事......在时间类的文档中，它说的第一件事是“实现 time.rb 库文档中描述的 Time 类的扩展”。

他们的意思是“time.rb 库实现了这个类的扩展”？

我想也许这就是 Time#advance 的来源，但我发现的只是[这个](http://www.ruby-doc.org/stdlib/libdoc/time/rdoc/index.html)。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-06T00:52:22.110

它实际上在[`ActiveSupport::CoreExtensions::Numeric::Time`](http://api.rubyonrails.org/classes/Time.html)模块中。

这是我对 Ruby 的抱怨之一——不可能为对象的每个方法找到全面的文档，因为方法列表会根据上下文而变化。强大，但也令人恼火。

我正在开发一个我最初没有编写的大型 Rails 应用程序，有时我在谷歌上搜索了几分钟我不认识的方法，然后才意识到……是的，以前的开发人员在 /lib 中定义了它。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-06T00:27:04.790

看起来不像`advance`是该语言的核心部分，因此缺乏文档。看起来是包含在 Rails 中的包的一部分，即 ActiveSupport 模块。

文档在这里： [http ://api.rubyonrails.org/classes/Time.html#method-i-advance](http://api.rubyonrails.org/classes/Time.html#method-i-advance)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-06T00:24:48.650

这与 Time 的许多其他扩展一起，是 ActiveSupport 的一部分，您可能作为 Rails 的一部分获得了它，尽管该库本身是完全可用的。

请参阅[文档](http://api.rubyonrails.org/classes/ActiveSupport/CoreExtensions/Numeric/Time.html)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-06T16:36:52.680

这是你的第二个问题的答案。

> 在 time 类的文档中，它说的第一件事是“实现 time.rb 库文档中描述的 Time 类的扩展”。
> 
> 他们的意思是“time.rb 库实现了这个类的扩展”？

很多地方都开设了Time课：

*   在红宝石中：
    *   时间.c
    *   库/日期.rb
    *   lib/rss/rss.rb
    *   库/时间.rb
    *   lib/yaml/rubytypes.rb
*   在 Rails 中：
    *   activesupport/lib/active-support/core-ext/numeric/time.rb

APIdock 区分 Ruby 和 Rails，但是当在一个项目中多次定义单个元素时，它会“组合”单个元素的 RDoc。如果单个元素有多个 RDoc（如本例中的 Time 类），则只显示其中一个，其他不显示。这可能会令人困惑。

本文：

> 实现 time.rb 库文档中描述的 Time 类的扩展。

...来自 lib/time.rb。它来自标准库并扩展了核心库的 Time 类（在 time.c 中定义）。所以，你需要打电话...

```
require 'time' 
```

... 使用 time.rb 中定义的扩展。否则只能使用 time.c 中定义的方法。

# tracking - 跟踪号码模式

> ID：617298
> 
> 赞同：3
> 
> 时间：2009-03-06T00:25:15.277
> 
> 标签：tracking, fedex, ups

是否有任何地方可以获取所有运输公司（如 UPS、FedEX、DHL、AirBorne、USPS 等）的运输跟踪号模式...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-08-20T06:43:07.063

Fedex：12、14、15、20、22 位数字都是有效的追踪号码

UPS：1Z + 16 位或以 W、T、H + 10 位开头

DHL：仅 10 位数字（如果您提到快递，因为 DHL 也有货物、海运等）

美国邮政：[https ://tools.usps.com/go/TrackConfirmAction!input.action](https://tools.usps.com/go/TrackConfirmAction!input.action)

请注意，据我所知，那里没有完整的列表。

如果有人知道新的跟踪号格式，也请告诉我。

当我运行一个启动[http://www.aftership.com](http://www.aftership.com)时，它还需要检测跟踪号模式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-06T00:31:12.347

联邦快递：XXXXXXXXXXXX（12 个号码）

敦豪快递：

*   国际空运 - 7 位 HAWB 编号 1234567
*   国际海运 - 9 个字符的 HBL 编号 SEA123456
*   美国国内货件* – 3 个字符的原产地代码和 HAWB 编号，最长可达 10 位。海1234567

[DHL 追踪号码信息页面](http://www.us.danzas.com/frameset.cgi?winLocation=http://www.us.danzas.com/help/tandt.html)

加拿大邮政服务： [加拿大邮政服务跟踪信息页面](http://www.canadapost.ca/Personal/Help/UsingTrack.aspx#Tracking)

UPS：从 1Z 开始

如果是 UPS、Fedex 或 USPS，您可以将号码发送到 Google 并从 Google 结果中获取类型。

Airborne现在是DHL。

# python - Python Popen，关闭流和多个进程

> ID：617308
> 
> 赞同：2
> 
> 时间：2009-03-06T00:30:08.963
> 
> 标签：python, stream, popen, eof

我有一些数据要 gzip、uuencode 然后打印到标准输出。我基本上拥有的是：

```
compressor = Popen("gzip", stdin = subprocess.PIPE, stdout = subprocess.PIPE)
encoder    = Popen(["uuencode", "dummy"], stdin = compressor.stdout) 
```

我向压缩器提供数据的方式是通过compressor.stdin.write(stuff)。

我真正需要做的是向压缩器发送 EOF，我不知道该怎么做。

在某些时候，我尝试了compressor.stdin.close() 但这不起作用——当压缩器直接写入文件时效果很好，但在上述情况下，进程不会终止并在压缩器上停止。等待（）。

建议？在这种情况下，gzip 就是一个例子，我真的需要做一些事情，将一个进程的输出通过管道传输到另一个进程。

注意：我需要压缩的数据不适合内存，所以在这里交流并不是一个好的选择。另外，如果我只是跑

```
compressor.communicate("Testing") 
```

在上面的 2 行之后，它仍然挂起错误

```
  文件“/usr/lib/python2.4/subprocess.py”，第 1041 行，在通信中
    rlist, wlist, xlist = select.select(read_set, write_set, [])

```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-06T01:37:43.090

我怀疑问题出在打开管道的顺序上。UUEncode 有趣的是，如果没有以正确的方式传入管道，它会在您启动它时发出呜呜声（尝试在 Popen 调用中自行启动该死的东西，以查看仅使用 PIPE 作为标准输入和标准输出的爆炸）

试试这个：

```
encoder = Popen(["uuencode", "dummy"], stdin=PIPE, stdout=PIPE)
compressor = Popen("gzip", stdin=PIPE, stdout=encoder.stdin)

compressor.communicate("UUencode me please")
encoded_text = encoder.communicate()[0]
print encoded_text

begin 644 dummy
F'XL(`%]^L$D``PL-3<U+SD])5<A-52C(24TL3@4`;2O+"!(`````
`
end 
```

你是对的，顺便说一句......没有办法将通用 EOF 发送到管道中。毕竟，每个程序确实定义了自己的 EOF。这样做的方法是关闭管道，就像你试图做的那样。

编辑：我应该更清楚 uuencode。作为一个 shell 程序，它的默认行为是期待控制台输入。如果您在没有“实时”传入管道的情况下运行它，它将阻止等待控制台输入。通过第二次打开编码器，在您将材料发送到压缩机管道之前，编码器正在阻塞等待您开始输入。Jerub 是对的，因为有什么东西挡住了。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-06T00:49:17.887

这不是你应该直接在 python 中做的事情，关于事情的工作方式有一些怪癖，这使得用 shell 来做这件事是一个更好的主意。如果您可以只使用 subprocess.Popen("foo | bar", shell=True)，那就更好了。

可能发生的情况是 gzip 尚未能够输出其所有输入，并且该进程将在其 stdout 写入完成之前不会退出。

如果您使用 strace，您可以查看进程正在阻塞的系统调用。用于`ps auxwf`发现哪个进程是 gzip 进程，然后用于`strace -p $pidnum`查看它正在执行的系统调用。请注意，stdin 是 FD 0 而 stdout 是 FD 1，您可能会看到它在这些文件描述符上读取或写入。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-06T00:34:00.420

如果您只想压缩并且不需要文件包装器，请考虑使用 zlib 模块

```
import zlib
compressed = zlib.compress("text") 
```

shell=True 和 unix 管道建议不起作用的任何原因？

```
from subprocess import *

pipes = Popen("gzip | uuencode dummy", stdin=PIPE, stdout=PIPE, shell=True)
for i in range(1, 100):
    pipes.stdin.write("some data")
pipes.stdin.close()
print pipes.stdout.read() 
```

似乎工作

# .net - 什么是依赖属性？

> ID：617312
> 
> 赞同：140
> 
> 时间：2009-03-06T00:31:54.123
> 
> 标签：.net, workflow-foundation, dependency-properties

.Net 中的依赖属性是什么（尤其是在 WPF 上下文中）。与普通财产有什么区别？

* * *

## 回答 #1

> 赞同：96
> 
> 时间：2012-10-16T16:02:58.693

我发现有帮助且写得很好的唯一解释是这个： http: [//www.wpftutorial.net/dependencyproperties.html](http://www.wpftutorial.net/dependencyproperties.html)

基本上，DependencyProperties 与常规属性的不同之处在于它们不仅仅是类中字段的设置器/获取器，而且它们在运行时动态地检索它们的实际值。DPs的`SetValue()`方法非常简单，将属性的本地值设置为您给它的值。但是，当您尝试`GetValue()`从 DependencyProperty 中进行操作时，它会首先查找本地值，如果不存在（这在 DependencyProperties 中与常规属性不同），它将继续沿着逻辑 UI 树向上直到找到这样的值。如果框架在没有找到任何本地值的情况下到达树的顶部，那么它将使用预定义的默认值作为属性的值。

此方法允许 DependencyProperties 消耗比常规属性更少的内存，因为只有用户明确设置的值才会存储在本地。

而且，如上所述，DependencyProperties 还允许我们在 XAML 代码中绑定到它们并在它们上设置触发器，这在常规属性上是不允许的。

我希望我已经设法消除了一些模糊性:)

* * *

## 回答 #2

> 赞同：91
> 
> 时间：2009-03-06T00:43:00.353

依赖属性是派生自 DependencyObject 的类的属性，它们的特殊之处在于它们不是简单地使用支持字段来存储它们的值，而是在 DependencyObject 上使用了一些辅助方法。

关于它们的最好的事情是它们内置了所有数据绑定管道。如果您将某些内容绑定到它们，它们会在更改时通知它。

* * *

## 回答 #3

> 赞同：36
> 
> 时间：2009-03-06T00:40:42.463

[http://techpunch.wordpress.com/2008/09/25/wpf-wf-what-is-a-dependency-property/](http://techpunch.wordpress.com/2008/09/25/wpf-wf-what-is-a-dependency-property/)在 WF 和 WPF 的上下文中提供了对依赖属性的很好解释。

摘录：

> **关键点——依赖属性的价值得到解决**
> 
> 与任何属性一样，依赖属性的最终目标是管理状态。但与普通的 .Net 属性不同，本地属性值不存储在实例变量中。
> 
> 相反，依赖属性在依赖属性框架中注册，并且底层属性值被解析——这意味着该值由依赖属性框架根据属性注册定义的规则确定。

# c - C: double == -0 是什么意思？

> ID：617314
> 
> 赞同：7
> 
> 时间：2009-03-06T00:33:29.860
> 
> 标签：c, double

我只是使用 gdb 打印出一个 double 的值，令我惊讶的是它打印了 -0

C中-0值的双倍是什么意思？

顺便说一句，当我检查它与 0 的相等性时，它返回了 true：为了进行比较，我只做了以下操作

在 gdb 中

```
> print some_double
-0
> print some_double == 0
1 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-03-06T00:34:58.953

[负零](http://en.wikipedia.org/wiki/Negative_zero)是数值计算的有用概念，并且是 C 中的有效浮点数。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-06T00:35:26.673

这是一个众所周知的问题`printf`。由于您使用的是浮点数，因此二进制中不可能有一种表示形式。而且大多数时候二进制表示并不完美。因此，0 存储为`0.00000000000000...0042`有时和`-0.000000000000000000000123`。当 printf 打印第二个时，你得到奇数 -0。

我真的不知道你是如何与 0 进行比较的，只记得在进行浮点比较时添加一个 epsilon 以调整奇数。例如：测试两个浮点数是否相等永远不要写`a == b`，但`fabs(a-b) < 1e-13`1e-13 是 epsilon（选择一个适合您的指数）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-01-14T00:58:01.987

实际上阅读第 4 章中的“Writing great code, Volume 1”一书作者给出的答案非常清楚，这是因为在 IEEE FP 标准中使用 1 的补码来表示有符号浮点数。他说：

> 尾数使用一个补码格式而不是二进制补码。这意味着尾数的 24 位值只是一个无符号二进制数，位位置 31 中的符号位确定该值是正数还是负数。一个补码具有不寻常的特性**，即零有两种表示（符号位设置或清除）**。通常，这仅对设计浮点软件或硬件系统的人很重要。

强调我的

# scheme - 为什么 Scheme 不支持一流的环境？

> ID：617325
> 
> 赞同：19
> 
> 时间：2009-03-06T00:39:02.017
> 
> 标签：scheme, racket

我一直在阅读 SICP（计算机程序的结构和解释），并且非常兴奋地发现了这种奇妙的特殊形式：“make-environment”，他们演示了将其与 eval 结合使用作为编写模块化代码的一种方式（摘录来自第 4.3 节“包”）：

```
(define scientific-library
  (make-environment
   ...
   (define (square-root x)
    ...))) 
```

然后他们展示了它是如何工作的

```
((eval 'square-root scientific-library) 4) 
```

在他们的例子中，他们接着*准确*地展示了我想要的用法——一种优雅的、极简主义的方式在方案中做“OO”风格......他们“cons”在一起一个“type”，这实际上是什么由“make-environment”特殊形式（即 vtable）和 arg（“状态”）返回...

我非常兴奋，因为这*正是*我一直在寻找的一种在 Scheme 中“按符号”进行多态调度的方法，而无需编写大量显式代码或宏。

即我想创建一个“对象”，它有*两个*函数，我在不同的上下文中调用它们......但我不想用“car”和“cdr”来引用它们，我想同时*声明*并通过它们的符号名称*来评估它们。*

无论如何，当我读到这篇文章时，我迫不及待地想回家试试。

想象一下，当我在 PLT 计划和 Chez 计划中遇到以下情况时，我会感到失望：

```
> (make-environment (define x 3))
Error: invalid context for definition (define x 3).
> (make-environment)
Error: variable make-environment is not bound. 
```

SICP 中提到的“make-environment”发生了什么？这一切看起来如此优雅，正是我想要的，但似乎任何现代 Scheme 解释器都不支持它？

理由是什么？仅仅是“make-environment”的名称不同吗？

**更多信息稍后发现**

我看了一下在线版本：

[http://mitpress.mit.edu/sicp/full-text/book/book-ZH-28.html#%_sec_4.3](http://mitpress.mit.edu/sicp/full-text/book/book-Z-H-28.html#%_sec_4.3)

我正在读的是SICP的第一版。第二版似乎用关于非确定性编程和“amp”运算符的部分取代了对包的讨论。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-09T08:52:14.690

经过更多的挖掘，我在新闻网上发现了这个[信息丰富的线程](http://groups.google.com/group/comp.lang.scheme/browse_frm/thread/78ee853ca52c84fd/6a452d426eab0e53?lnk=gst&q=make-environment#6a452d426eab0e53)：

“R5RS EVAL 和环境说明符是那些极度不喜欢一流环境并想要受限 EVAL 的人和那些在没有第二个参数即环境的情况下无法接受/理解 EVAL 的人之间的妥协。”

另外，发现了这个“解决方法”：

```
(define-syntax make-environment 
  (syntax-rules () 
    ((_ definition ...) 
     (let ((environment (scheme-report-environment 5))) 
       (eval '(begin definition 
                     ...) 
             environment) 
       environment)))) 

(define arctic 
  (make-environment 
    (define animal 'polarbaer))) 
```

（取自[此](http://groups.google.com/group/comp.lang.scheme/browse_frm/thread/b083c43f0f1545e1/37ebb30db69cd507?lnk=gst&q=make-environment#37ebb30db69cd507)）

然而，我最终采用了一种“消息传递”风格，有点像第一个人建议的那样——我返回一个函数列表，并有一个通用的“发送”方法来按名称调用特定函数......即类似这样

```
(define multiply
  (list
    (cons 'differentiate (...))
    (cons 'evaluate (lambda (args) (apply * args)))))

(define lookup
  (lambda (name dict)
    (cdr (assoc name dict))))

; Lookup the method on the object and invoke it
(define send
  (lambda (method arg args)
    ((lookup method arg) args)))

((send 'evaluate multiply) args) 
```

我一直在进一步阅读，并且知道如果我真的想采用完全 OO 风格，那么所有的 CLOS 都可以 - 但我认为即使是上面的内容也有点过头了。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2010-01-11T22:55:40.803

他们之所以这样写，是因为 MIT Scheme 实际上确实拥有一流的环境，并且大概这就是作者计划用它来教授他们的课程的（因为这本书是在 MIT 写的）。

查看[http://groups.csail.mit.edu/mac/projects/scheme/](http://groups.csail.mit.edu/mac/projects/scheme/)

然而，我注意到 MIT 方案虽然仍在积极开发中，但缺乏真正现代方案所具有的许多特性，例如外部函数接口或 GUI 支持。您可能不想将它用于严肃的软件开发项目，至少不会单独使用它。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-06T11:21:08.993

由于性能原因，Scheme 没有一流的环境。在创建 Scheme 时，由于一流的函数、延续等漂亮的东西，它并不是最快的语言。添加一流的环境会进一步削弱性能。因此，这是在早期 Scheme 时代做出的权衡。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-06T11:24:35.833

经典的调度程序功能会起作用吗？我认为这与您正在寻找的相似。

```
(define (scientific-library f)
  (define (scientific-square-root x) (some-scientific-square-root x))
  (cond ((eq? f 'square-root) scientific-square-root)
        (else (error "no such function" f))))
(define (fast-library f)
  (define (fast-square-root x) (some-fast-square-root x))
  (cond ((eq? f 'square-root) fast-square-root)
        (else (error "no such function" f))))

((scientific-library 'square-root) 23)
((fast-library 'square-root) 23) 
```

您甚至可以将示例科学和快速库组合成一个大的调度方法：

```
(define (library l f)
  (define (scientific-library f)
    ...)
  (define (fast-library f)
    ...)
  (cond ((eq? l 'scientific) (scientific-library f))
        ((eq? l 'fast) (fast-library f))
        (else (error "no such library" l))))
(library 'fast 'square-root) 
```

# css - 使用 Jquery 的自动 ajax 选择器

> ID：617334
> 
> 赞同：0
> 
> 时间：2009-03-06T00:44:01.677
> 
> 标签：css, ajax, jquery, xmlhttprequest, css-selectors

我正在尝试制作概念验证网站，但我想要完美的退化。因此，我将首先用纯 XHTML 对网站进行编码，然后添加类和 id 以将它们挂接到 jQuery 中。

我想做的一件事是最终为我的所有链接启用 Ajax xmlhttprequest，以便它们显示在视口 div 中。我希望这个视口成为来自多个外部页面的任何 xmlhttprequest 的“通用”转储。

我想知道我是否能够对以下内容进行硬编码：

```
<a href="blah.html" class="ajax">, <a href="bleat.html" class="ajax"> 
```

等等。如您所见，我给出了我想从类 ajax 调用 Ajax 请求的所有链接标签。在我基于 jQuery 的 JS 中，我希望能够对其进行编码，以便所有积极的 ${"a").filter(".ajax") 将自动加载它们各自的 href [variable] 作为 ajax 请求。

请帮忙。我是n00b。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-06T00:46:58.330

使用您的示例，您应该能够：

```
$('.ajax').click(function () { 
    // Your code here. You should be able to get the href variable and
    // do your ajax request based on it. Something like:
    var url = $(this).attr('href');
    $.ajax({
        type: "GET",
        url: url
    });
    return false; // You need to return false so the link
                  // doesn't actually fire.
}); 
```

我建议使用与“ajax”不同的类，因为它会使代码读起来有点奇怪，因为`$('.ajax')`可能会被误读为`$.ajax()`.

该`$('.ajax').click()`部分使用“ajax”类为页面上的每个元素注册一个 onClick 事件处理程序，这正是您想要的。然后你`$(this).attr('href')`用来获取点击的特定链接的href，然后做你需要的任何事情！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-06T00:58:06.820

就像是：

```
function callback(responseText){
    //load the returned html into a dom object and get the contents of #content
    var html = $('#content',responseText)[0].innerHTML;
    //assign it to the #content div
    $('#content').html(html);
}

$('a.ajax').click(function(){
    $.get(this.href, callback);
    return false;
}); 
```

您需要解析 #content div 之外的所有内容，以便导航不会显示多次。我正在考虑一个正则表达式，但可能更容易使用 jQuery 来做到这一点，所以我更新了这个例子。

# c# - 构造函数和继承

> ID：617336
> 
> 赞同：14
> 
> 时间：2009-03-06T00:44:26.793
> 
> 标签：c#, oop, inheritance

让我们以 C# 为例

```
public class Foo
{
    public Foo() { }
    public Foo(int j) { }
}

public class Bar : Foo
{

} 
```

现在， Foo 的所有公共成员都可以在 Bar 中访问，除了构造函数。我不能做类似的事情

```
Bar bb = new Bar(1); 
```

为什么构造函数不可继承？

***更新***

我确实知道我们可以链接构造函数，但我想知道为什么上述构造无效。我相信应该有一个正当的理由。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-03-06T00:48:54.923

构造函数是不可继承的，因为它可能会导致奇怪和意外的行为。更具体地说，如果您向基类添加了新的构造函数，则所有派生类都会获得该构造函数的实例。在某些情况下，这是一件坏事，因为您的基类可能指定了对派生类没有意义的参数。

一个常见的例子是，在许多语言中，所有对象（通常称为“对象”）的基类都有一个没有参数的构造函数。如果构造函数是继承的，这将意味着所有对象都有一个无参数的构造函数，并且没有办法说“我希望创建此类实例的人提供参数 X、Y 和 Z，否则他们的代码不应该编译。 " 对于许多类，为它们的正确功能定义某些参数很重要，并且使构造函数不可继承是类作者可以保证始终定义某些参数的方式的一部分。

编辑以回应评论：Ramesh 指出，如果构造函数按照他的意愿被继承，他总是可以在每个派生类中使用私有声明的构造函数来覆盖基类构造函数。这当然是对的，但这种策略存在后勤问题。它要求派生类的编写者必须密切关注基类并添加私有构造函数，如果他们想要阻止基类构造函数的继承。这不仅对编写派生类的人来说是很多工作，而且这种跨类的隐式依赖正是那种会导致奇怪行为的事情。

Ramesh - 这并不是说您描述的内容不可能添加到一种语言中。一般来说，它没有完成，因为这种行为可能会使人们感到困惑并导致大量额外的调试和代码编写。

Quintin Robinson 在绝对值得一读的评论中对这个问题提供了一些非常有价值的回答。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-06T00:47:21.090

它们是（通过链接），您必须在派生对象中链接构造函数.. IE：

```
public class Foo
{
    public Foo() { }
    public Foo(int j) { }
}

public class Bar : Foo
{
    public Bar() : base() { }
    public Bar(int j) : base(j) { }
} 
```

然后，派生对象中的构造函数将链接对基础对象中的构造函数的调用。

[如果您想进一步阅读，本文](http://weblogs.asp.net/scottcate/archive/2005/11/23/431412.aspx)提供了更多示例。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-06T00:51:12.890

您可能会在类中引入构造函数的一个原因是，如果没有特定的“依赖关系”，则拥有该类的实例是没有意义的。例如，它可能是一个必须连接到数据库的数据访问类：

```
public class FooRepository
{
    public FooRepository(IDbConnection connection) { ... }
} 
```

如果基类中的所有公共构造函数都可用，那么存储库类的用户将能够使用 System.Object 的默认构造函数来创建类的无效实例：

```
var badRepository = new FooRepository(); 
```

默认情况下隐藏继承的构造函数意味着您可以强制执行依赖项，而不必担心用户创建“无效”实例。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-06T00:54:07.907

构造`Foo`函数只能知道如何初始化一个 Foo 对象，所以它也应该知道如何初始化任何潜在的子类是没有意义的

```
public class Bar : Foo
{
public Bar(int i) : base(i) { }
} 
```

构造函数讲述的故事是：“嘿，基类请做任何你需要做的工作以保持良好状态，以便我可以继续并正确设置自己”。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-06T01:14:01.447

假设构造函数是可继承的。在许多情况下，如果继承的构造函数对子类没有意义，你将如何禁用它们？

语言设计者没有使用阻止继承的机制使语言复杂化，而是选择简单地使构造函数不可继承。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-06T00:50:02.020

由于设计原因，构造函数不可继承。（请注意，在我所知道的每种面向对象语言中，情况都是一样的。）简单的答案是，在许多情况下，您真的不希望与基类相同的构造函数可用。有关更完整的解释，请参阅[此 SO 线程。](https://stackoverflow.com/questions/426484/why-are-constructors-not-inherited)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-06T00:51:22.813

一些讨论

*   [乔尔的论坛](http://discuss.joelonsoftware.com/default.asp?design.4.50459.27)
*   [埃里克·冈纳森的博客](http://blogs.msdn.com/ericgu/archive/2004/04/22/118231.aspx)

基本思想是为创建者提供尽可能多的控制。你可以有私人基地。那你是怎么创建对象的？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-06T00:48:16.923

我认为您可以执行以下操作：

```
public class Bar : Foo
{
  public Bar (int i)
    : base (i)
  {
  }
} 
```

我可能有点不对劲——但这是一般的想法。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-06T00:51:00.317

简单的答案是该语言不是那样工作的。

不过，您要问的真正问题是为什么它不能那样工作:-) 嗯，这是一个任意选择，它继承自 C++ 和 Java（以及很可能影响 C# 的许多其他语言）。

可能的原因是编译器只会生成一个不带参数并简单地调用父级的构造函数，如果你想要的不仅仅是编译器让你自己做的事情。这是最好的选择，因为您所做的不仅仅是调用父构造函数。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-06T01:16:52.563

真的，这是因为父构造函数不会完全初始化子对象。在这方面，构造函数是一种个人的东西。这就是为什么大多数语言不继承构造函数的原因。

# php - 检查用户的位置，然后应用特定的样式？

> ID：617345
> 
> 赞同：1
> 
> 时间：2009-03-06T00:49:07.187
> 
> 标签：php, geolocation

如何为美国人应用美式风格，为英国人应用英式风格？

例如，我想根据用户在我的站点中的位置更改标志。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-06T00:57:55.060

首先，您需要找到访问者的 IP 地址。它将在 $_SERVER['REMOTE_ADDR'] 全局变量中。然后，您可以根据 IP 到国家/地区映射的数据库查找此 IP，以获取 IP 的国家/地区代码。

这种方法不是 100% 准确，但对于大多数用途来说“足够好”，更重要的是它速度快。如果您期望高流量，您可能希望将国家/地区代码缓存在 cookie 中以避免重复查找。

一个这样的映射可以在这里找到：http: [//software77.net/cgi-bin/ip-country/geo-ip.pl](http://software77.net/cgi-bin/ip-country/geo-ip.pl)

一个 PHP 类，它接受 IP 并使用捆绑的映射文件返回国家/地区代码： [http ://www.phpclasses.org/browse/package/2363.html](http://www.phpclasses.org/browse/package/2363.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-06T00:56:15.173

这称为地理定位： [我可以使用哪些服务来根据用户的 IP 地址查找用户的位置？](https://stackoverflow.com/questions/37015/how-can-i-find-a-users-location-based-on-their-ip-address-free-and-not-free-s)

[所有标记为地理位置的问题](https://stackoverflow.com/questions/tagged/geolocation?sort=votes)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-06T00:57:30.520

如果你真的想要用户的位置，关键字是[geolocation](https://stackoverflow.com/search?q=geolocation)。

但是，出于您的目的，您可以检查`$_SERVER["ACCEPT_LANGUAGE"]`. [语法](https://www.rfc-editor.org/rfc/rfc2616#section-14.4)有点复杂。幸运的是，几乎每个客户都会立即做应该做的事情并订购首选位置。因此，计算您支持的所有语言环境（如“en-us”）并采用最低的，丢弃产生错误的语言环境。[`stripos`](http://php.net/strpos)`($_SERVER["ACCEPT_LANGUAGE"], $lang)``$lang`

# c++ - 获取 optarg 作为 C++ 字符串对象

> ID：617358
> 
> 赞同：2
> 
> 时间：2009-03-06T00:52:08.287
> 
> 标签：c++, string, getopt, getopt-long

我正在使用 getopt_long 来处理 C++ 应用程序中的命令行参数。这些示例都显示了类似于`printf("Username: %s\n", optarg)`处理示例中的内容。这非常适合展示示例，但我希望能够实际存储这些值以供以后使用。其余大部分代码都使用`string`对象而不是对象，`char*`因此我需要将 optarg 的内容转换/复制/任何内容转换为字符串。

```
string bar;
while(1) {
    c = getopt_long (argc, argv, "s:U:", long_options, &option_index);
    if (c == -1) break;
    switch(c)
        {
            case 'U':
                // What do I need to do here to get
                // the value of optarg into the string
                // object bar?
                bar.assign(optarg);
                break;
        }
} 
```

上面的代码可以编译，但是当它执行时，`Illegal instruction`如果我尝试使用 printf 打印出 bar 的值，我会得到一个错误（它似乎对 cout 工作得很好）。

```
// Runs just fine, although I'm not certain it is actually safe!
cout << " bar: " << bar << "\n";

// 'Illegal instruction'
printf(" bar: %s\n", bar); 
```

我对命令行调试知之甚少，无法更好地挖掘非法指令可能是什么。我一直在运行 valgrind，但由于此错误导致的大量内存错误使我很难准确找出可能导致此错误的原因。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-06T00:54:17.797

您告诉 printf 您在指定 %s 时提供了 ac 样式字符串（以空字符结尾的字符数组），但您提供了一个字符串类。假设您正在使用 std::string 尝试：

```
printf("bar : %s\n", bar.c_str()); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-06T00:55:51.227

`printf()`无法处理 C++ `string`。改为使用`bar.c_str()`。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-06T01:12:38.860

```
cout << " bar: " << bar << "\n"; 
```

非常安全。是什么让你认为它可能不是？

# php - 从 Magento 导出订单以进行装运

> ID：617360
> 
> 赞同：9
> 
> 时间：2009-03-06T00:52:39.253
> 
> 标签：php, magento, export, shipping

我正在 Magento 平台上的在线商店工作，遇到了一个主要障碍：由于某种原因**，我无法弄清楚如何导出当前订单（包含运输信息/运输类型/等）。**有没有人有什么建议？对于这样的系统来说，这似乎应该是最基本的事情之一，但我一直无法找到如何去做。

预先感谢您的帮助，

安迪

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-03-27T12:32:32.170

看到你想要这个运输，你可能想问谁处理你的运输，他们是否有某种 API，这样你就可以构建/购买/下载适当的运输模块，省去处理 CSV 文件的麻烦。

如果你真的想要一个 CSV 文件，但是我可以告诉你如何创建它。你没有提到这个脚本将在哪里运行，所以我假设它是一个外部脚本（这将使它更容易与 cron 作业一起使用）。您想要执行以下操作：

```
//External script - Load magento framework
require_once("C:\Program Files\Apache Software Foundation\Apache2.2\htdocs\magento\app\Mage.php");
Mage::app('default');

$myOrder=Mage::getModel('sales/order'); 
$orders=Mage::getModel('sales/mysql4_order_collection');

//Optional filters you might want to use - more available operations in method _getConditionSql in Varien_Data_Collection_Db. 
$orders->addFieldToFilter('total_paid',Array('gt'=>0)); //Amount paid larger than 0
$orders->addFieldToFilter('status',Array('eq'=>"processing"));  //Status is "processing"

$allIds=$orders->getAllIds();
foreach($allIds as $thisId) {
    $myOrder->reset()->load($thisId);
    //echo "<pre>";
    //print_r($myOrder);
    //echo "</pre>";

    //Some random fields
    echo "'" . $myOrder->getBillingAddress()->getLastname() . "',";
    echo "'" . $myOrder->getTotal_paid() . "',";
    echo "'" . $myOrder->getShippingAddress()->getTelephone() . "',";
    echo "'" . $myOrder->getPayment()->getCc_type() . "',";
    echo "'" . $myOrder->getStatus() . "',";
    echo "\r\n";
} 
```

为了简洁（和理智），我没有列出所有可用的订单信息。您可以通过转储相关对象并查看它们的字段来找出可用的字段。

例如，如果您要执行 print_r($myOrder->getBillingAddress()); 你会看到像“address_type”和“lastname”这样的字段。您可以将它们分别与 $myOrder->getBillingAddress()->getAddress_type() 和 $myOrder->getBillingAddress()->getLastname() 一起使用。

**编辑**：根据 craig.michael.morris 的回答更改了代码

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-20T05:35:39.707

我正在实施您的解决方案，并注意到它只返回所有外键的第一个值，例如帐单地址、送货地址、付款等...

这可以通过更改来解决

$myOrder->load($thisId);

到

$myOrder->reset()->load($thisId);

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-02T13:02:52.030

您可能还想看看这个扩展： http: [//www.magentocommerce.com/extension/1158/manual-order-export](http://www.magentocommerce.com/extension/1158/manual-order-export)

你也可以通过soap连接：这个例子是为localhost设置的，并假设你已经在admin的system>>web services下设置了一个web services用户和角色。

```
 <?php 
$time = microtime(); 
$time = explode(' ', $time); 
$time = $time[1] + $time[0]; 
$begintime = $time; 
?> 
<?php 
ini_set('error_reporting', E_ALL); 
ini_set('display_errors', 1); 
// hostname 
$host= '127.0.0.1'; 
// if store in /magento change /shop, if store in root remove /shop 
$client= new SoapClient('http://'.$host.'/magento/index.php/api/soap/?wsdl'); 

// Can be added in Magento-Admin -> Web Services with role set to admin 
$apiuser= 'soap'; 
// API key is password 
$apikey = '******'; 
$sess_id= $client->login($apiuser, $apikey); 
echo "<html>"; 
echo "<head>"; 
echo "<LINK REL=StyleSheet HREF=\"style.css\" TYPE=\"text/css\" MEDIA=screen>"; 
echo "</head>"; 
echo "<body>";

$result= $client->call($sess_id, 'sales_order.list',  array(array('status'=>array('='=>'Pending'))));
echo '<pre>';
print_r($result);
echo '<pre>';

?> 
<?php 
// Let's see how long this took… 
$time = microtime(); 
$time = explode(" ", $time); 
$time = $time[1] + $time[0]; 
$endtime = $time; 
$totaltime = ($endtime - $begintime); 
echo '<br /><br /><em>This Magento SOAP API script took ' .$totaltime. ' seconds, precisely.</em>'; 
// ...and close the HTML document 
echo "</body>"; 
echo "</html>"; 
?> 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-08-09T14:13:48.200

如果这对任何人有帮助，您可以使用发票表作为键。带有auth+capture信用卡设置的magento发票意味着钱已经进来了。在我们的例子中，我们只需要在phpmyadmin中运行一个sql查询，它将导出订单号和发票号，以便我们核对以检查订单是否导出xtento 的扩展正在工作。这是我们使用的：

```
 SELECT sales_flat_order.increment_id AS 'order', sales_flat_invoice.increment_id AS 'invoice'
   FROM sales_flat_order
  RIGHT JOIN sales_flat_invoice ON sales_flat_invoice.order_id = sales_flat_order.entity_id
  WHERE sales_flat_invoice.updated_at >= "2011-07-01 00:00:00"
  ORDER BY sales_flat_order.increment_id DESC 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-26T01:45:55.320

如果系统不支持任何直接导出订单的方式，您可以在数据库中创建一个视图，列出您需要导出的订单。然后使用 phpMyAdmin 之类的工具将视图中的数据导出为 CSV。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-20T14:48:17.687

Saho 对使用 SOAP 的建议很棒，但可能需要很长时间（Apache 只能分配有限的 CPU 资源来处理该请求）

建议你写一个php脚本，然后通过终端运行。

索南

# .net - 脚本 Visual Studio 构建、Clickonce 部署、Dotfuscator 和 Mage

> ID：617366
> 
> 赞同：4
> 
> 时间：2009-03-06T00:54:38.560
> 
> 标签：.net, visual-studio, deployment, clickonce

将我的应用程序发布给客户的过程是每个标题

*   建造
*   Clickonce 部署
*   使用 Dotfuscator 混淆主可执行文件
*   使用 mage 签署清单和 .application 文件
*   邮编

我想开发一个开源程序来自动执行此操作，因为每次客户端需要发布时它都会花费大量时间。我认为寻求解决方案有点过分；）那么理想的格式是什么？批处理脚本，C# 应用程序？

是否有人知道此过程的现有解决方案或愿意合作解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-06T08:58:46.667

所以我猜你不是在考虑使用 MSBuild 吗？

因为 .net SDK 也是免费提供的。您的 Visual Studio 项目已经是 MSBuild 项目文件，因此您可以使用这些文件并对其进行修改以进行完整的集成构建。

要生成 ClickOnce 部署，您将使用以下 MSBuild 任务：

*   生成应用程序清单
*   生成部署清单
*   执行
*   标志文件

由于一些问题，我还需要在这些之后运行 mage，例如更新清单并对其进行签名，我为此使用 Exec 任务：

```
<!-- Correct the codebase property pointing to the application manifest file -->
<Exec 
  Command="&quot;$(SdkPath)bin\mage&quot; -Update &quot;$(DeploymentManifest)&quot; -AppManifest &quot;$(ApplicationManifest)&quot;" 
  WorkingDirectory="$(PublishDir)" />

<!-- Signing the Deployment manifest -->
<Exec 
  Command="&quot;$(SdkPath)bin\mage&quot; -Sign &quot;$(DeploymentManifest)&quot; -CertFile &quot;$(SolutionRoot)\$(Branch)\Source\esamba.pfx&quot; -Password esamba" 
  WorkingDirectory="$(PublishDir)" /> 
```

我希望这可以帮助你。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-06T01:14:11.057

为什么不使用像[nant](http://nant.sourceforge.net/)这样的构建工具，它可以根据需要通过自定义任务进行扩展。

由于这是一个常见问题，您拥有的大多数任务可能都有预定义的任务，您可以轻松调用其他可执行文件，或使用任何 .NET 语言编写自定义代码来添加任务。

# string - Powershell 连接

> ID：617369
> 
> 赞同：10
> 
> 时间：2009-03-06T00:56:21.803
> 
> 标签：string, powershell, join

我试图使用这个将数组的许多元素加入一个字符串；

```
$a = "h","e","l","l","o"
$b = [string]::join("", $a[0,1,2,3]) 
```

但是我在方法调用中得到一个“缺少')'错误。连接文档只提到连接数组的所有元素，而不是特定索引处的元素。这可以做到吗？

干杯

安迪

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-06T01:05:37.740

用 "$()" 或 "()" 包裹 "$a[0,1,2,3]" 的内容

```
PS> [string]::join("", $($a[0,1,2,3]))
hell
PS> [string]::join("", ($a[0,1,2,3]))
hell 
```

- 或者 -

您可以使用范围运算符“..”

```
PS> [string]::join("", $a[0..3])
hell 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-06T14:47:57.000

```
PS > & {$ofs=""; "$($a[0,1,2,3])"}  
hell 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-03-21T10:56:23.897

更惯用：使用 PowerShell 的内置连接运算符，如下所示：

```
PS> $a[0,1,2,3] -join ""
hell 
```

# c# - 如何在 IList 上执行 FindAll() ? （例如，SortedList.Values）

> ID：617374
> 
> 赞同：1
> 
> 时间：2009-03-06T00:58:44.450
> 
> 标签：c#, ilist, sortedlist, findall

我正在处理 C# 2.0/.NET 2.0 中的一个问题，其中我有一个 Sortedlist，并且想要搜索此 SortedList 的所有“值”（而不是“键”）以查找某个子字符串并计算出现次数.

这就是我想要做的：

```
{
   Sortedlist<string,string> mySortedList;
   // some code that instantiates mySortedList and populates it with data
   List<string> myValues = mySortedList.Values;  // <== does not work
   int namesFound = myValues.FindAll(ByName(someName)).Count;
} 
```

当然，这不起作用，因为 mySortedList.Values 返回一个 IList，而“myValues”是一个列表。我尝试“强制转换”IList 以便 myValues 接受它，但它似乎不起作用。

当然，我可以在“foreach”循环中循环 mySortedList.Values，但我真的不想这样做。

有人有什么建议吗？

EDIT-1：好的，看起来没有本地方法可以轻松做到这一点。我以为我只是错过了一些东西，但显然我没有。所以我想我只是要对 IList 做一个“foreach”。

感谢大家的反馈！我给每个人投了 1 票，因为我认为所有的反馈都很好。再次感谢！:-)

EDIT-2：看起来 CMS 有我正在寻找的答案。唯一需要注意的是（正如 Qwertie 指出的那样），这可能会导致性能下降，因为它涉及将所有值复制到另一个列表，然后从头到尾搜索该列表。所以对于短名单，这个答案是有效的。更长的列表？好吧，这由你决定......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-06T01:08:36.330

您不能将 Values 属性强制转换为 List<string>，因为它不是 List<string>——它是 Dictionary<TKey, TValue>.ValueCollection。

但是如果你使用[LinqBridge](http://www.albahari.com/nutshell/linqbridge.aspx)（对于 .NET Framework 2.0 和 C# 3.0），这个问题很容易用 LINQ 解决，如下所示：

```
SortedList<string, string> m = ...;
int namesFound = m.Values.Where(v => v.Contains("substring")).Count(); 
```

(if you're still on C# 2.0, you can use [Poor-man's LINQ](http://www.codeproject.com/KB/linq/linq2005.aspx) instead, with slightly more work)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-06T01:35:51.723

Since the [IList Interface](http://msdn.microsoft.com/en-us/library/system.collections.ilist(VS.80).aspx) implements [IEnumerable](http://msdn.microsoft.com/en-us/library/system.collections.ienumerable(VS.80).aspx), you can actually get a `List<T>` of values using the [`List<T> (IEnumerable) Constructor`](http://msdn.microsoft.com/en-us/library/fkbw11z0(VS.80).aspx):

```
List<string> myValues = new List<string>(mySortedList.Values); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-06T01:03:10.757

太糟糕了，你在 .Net 2.0 中。这正是 LINQ 的用途。;)

你不能真正做到这一点，因为 FindAll() 是 List 的成员。您可以在 mySortedList.Values 上创建一个新列表，但这似乎是一种浪费，因为需要分配一个新对象和底层数组来调用一个函数。

我只是在某个类中为名为 FindAll() 的列表编写一个实用函数，然后传递您的 IList 和委托。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-06T01:06:19.830

```
 static void Main(string[] args)
    {
        string someName = "two";
        SortedList<string, string> mySortedList = new SortedList<string,string>()
        {
            {"key1", "This is key one"},
            {"key2", "This is key two"},
            {"key3", "This is key three"},
        };

        int namesFound = mySortedList.Values.Where(i => i.Contains(someName)).Count();
        Console.WriteLine(namesFound);
        Console.ReadKey();
    } 
```

在 Framework 2.0 中，也许可以这样做：

```
 static void Main(string[] args)
    {
        string someName = "two";
        SortedList<string, string> mySortedList = new SortedList<string,string>()
        {
            {"key1", "This is key one"},
            {"key2", "This is key two"},
            {"key3", "This is key three"},
        };

        int namesFound = FindAll(mySortedList.Values, someName).Count ;
        Console.WriteLine(namesFound);
        Console.ReadKey();
    }
    public static IList<String> FindAll(IList<String> items, string item)
    {
        List<String> result = new List<string>();
        foreach (String s in items)
        {
            if (s.Contains(item))
            {
                result.Add(s);
            }
        }
        return result;
    } 
```

但那是你真正不想做的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-06T01:08:29.120

你试过了`SortedList`吗[`GetValueList`](http://msdn.microsoft.com/en-us/library/system.collections.sortedlist.getvaluelist(VS.71).aspx)？这会给你一个`IList`价值。

# wcf - 将 Silverlight 客户端与服务引用生成的类解耦

> ID：617377
> 
> 赞同：4
> 
> 时间：2009-03-06T01:00:04.617
> 
> 标签：wcf, silverlight, prism

我正在通过快速入门研究 Prism v2。我创建了一个具有以下签名的 WCF 服务：

```
namespace HelloWorld.Silverlight.Web
{
[ServiceContract(Namespace = "http://helloworld.org/messaging")]
[AspNetCompatibilityRequirements(RequirementsMode =
                                 AspNetCompatibilityRequirementsMode.Allowed)]
  public class HelloWorldMessageService
  {
    private string message = "Hello from WCF";

    [OperationContract]
    public void UpdateMessage(string message)
    {
      this.message = message;
    }

    [OperationContract]
    public string GetMessage()
    {
      return message;
    }
  }
} 
```

当我在 silverlight 项目中添加对此服务的服务引用时，它会生成一个接口和一个类：

```
[System.ServiceModel.ServiceContractAttribute
        (Namespace="http://helloworld.org/messaging",
         ConfigurationName="Web.Services.HelloWorldMessageService")]
public interface HelloWorldMessageService {

  [System.ServiceModel.OperationContractAttribute
          (AsyncPattern=true,
      Action="http://helloworld.org/messaging/HelloWorldMessageService/UpdateMessage", 
ReplyAction="http://helloworld.org/messaging/HelloWorldMessageService/UpdateMessageResponse")]
    System.IAsyncResult BeginUpdateMessage(string message, System.AsyncCallback callback, object asyncState);

    void EndUpdateMessage(System.IAsyncResult result);

    [System.ServiceModel.OperationContractAttribute(AsyncPattern=true, Action="http://helloworld.org/messaging/HelloWorldMessageService/GetMessage", ReplyAction="http://helloworld.org/messaging/HelloWorldMessageService/GetMessageResponse")]
    System.IAsyncResult BeginGetMessage(System.AsyncCallback callback, object asyncState);

    string EndGetMessage(System.IAsyncResult result);
}

public partial class HelloWorldMessageServiceClient : System.ServiceModel.ClientBase<HelloWorld.Core.Web.Services.HelloWorldMessageService>, HelloWorld.Core.Web.Services.HelloWorldMessageService {
{
    // implementation
} 
```

我试图通过传递接口而不是具体类来解耦我的应用程序。但我很难找到如何做到这一点的例子。当我尝试调用 EndGetMessage 然后更新我的 UI 时，我得到一个关于在错误线程上更新 UI 的异常。如何从后台线程更新 UI？

* * *

我试过了，但我得到了`UnauthorizedAccessException : Invalid cross-thread access`。

```
string messageresult = _service.EndGetMessage(result);

Application.Current.RootVisual.Dispatcher.BeginInvoke(() => this.Message = messageresult ); 
```

异常由`Application.Current.RootVisual`.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-11-09T18:38:35.183

这是我喜欢做的事情......服务代理是用一个接口生成的

```
HelloWorldClient : IHelloWorld 
```

但问题是`IHelloWorld`不包括该方法的异步版本。所以，我创建了一个异步接口：

```
public interface IHelloWorldAsync : IHelloWorld
{
    void HelloWorldAsync(...);
    event System.EventHandler<HelloWorldEventRgs> HelloWorldCompleted;
} 
```

然后，您可以告诉服务代理通过部分实现接口：

```
public partial class HelloWorldClient : IHelloWorldAsync {} 
```

因为`HelloWorldClient`确实实现了这些异步方法，所以这是可行的。

然后，我可以在`IHelloWorldAsync`任何地方使用并告诉接口`UnityContainer`使用`HelloWorldClient`。`IHelloWorldAsync`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-06T11:53:06.373

好的，所以我真正的问题是如何解耦我对由我的服务引用创建的代理类的依赖。我试图通过使用与代理类一起生成的接口来做到这一点。这本来可以正常工作，但是我还必须引用拥有服务引用的项目，因此它不会真正解耦。所以这就是我最终要做的。这有点像黑客，但到目前为止它似乎正在工作。

首先，这是我的接口定义和使用我的代理生成的自定义事件处理程序 args 的适配器类：

```
using System.ComponentModel;

namespace HelloWorld.Interfaces.Services
{
    public class GetMessageCompletedEventArgsAdapter : System.ComponentModel.AsyncCompletedEventArgs
    {
        private object[] results;

        public GetMessageCompletedEventArgsAdapter(object[] results, System.Exception exception, bool cancelled, object userState) :
            base(exception, cancelled, userState)
        {
            this.results = results;
        }

        public string Result
        {
            get
            {
                base.RaiseExceptionIfNecessary();
                return ((string)(this.results[0]));
            }
        }
    }

    /// <summary>
    /// Create a partial class file for the service reference (reference.cs) that assigns
    /// this interface to the class - then you can use this reference instead of the
    /// one that isn't working
    /// </summary>

    public interface IMessageServiceClient
    {
        event System.EventHandler<GetMessageCompletedEventArgsAdapter> GetMessageCompleted;
        event System.EventHandler<AsyncCompletedEventArgs> UpdateMessageCompleted;

        void GetMessageAsync();
        void GetMessageAsync(object userState);

        void UpdateMessageAsync(string message);
        void UpdateMessageAsync(string message, object userState);
    }
} 
```

然后我只需要创建一个扩展服务引用生成的代理类的部分类：

```
using System;

using HelloWorld.Interfaces.Services;
using System.Collections.Generic;

namespace HelloWorld.Core.Web.Services
{
    public partial class HelloWorldMessageServiceClient : IMessageServiceClient
    {

        #region IMessageServiceClient Members

        private event EventHandler<GetMessageCompletedEventArgsAdapter> handler;
        private Dictionary<EventHandler<GetMessageCompletedEventArgsAdapter>, EventHandler<GetMessageCompletedEventArgs>> handlerDictionary 
            = new Dictionary<EventHandler<GetMessageCompletedEventArgsAdapter>, EventHandler<GetMessageCompletedEventArgs>>();

        /// <remarks>
        /// This is an adapter event which allows us to apply the IMessageServiceClient
        /// interface to our MessageServiceClient. This way we can decouple our modules
        /// from the implementation
        /// </remarks>
        event EventHandler<GetMessageCompletedEventArgsAdapter> IMessageServiceClient.GetMessageCompleted
        {
            add 
            { 
                handler += value;
                EventHandler<GetMessageCompletedEventArgs> linkedhandler = new EventHandler<GetMessageCompletedEventArgs>(HelloWorldMessageServiceClient_GetMessageCompleted);
                this.GetMessageCompleted += linkedhandler;
                handlerDictionary.Add(value, linkedhandler);
            }
            remove 
            { 
                handler -= value;
                EventHandler<GetMessageCompletedEventArgs> linkedhandler = handlerDictionary[value];
                this.GetMessageCompleted -= linkedhandler;
                handlerDictionary.Remove(value);
            }
        }

        void HelloWorldMessageServiceClient_GetMessageCompleted(object sender, GetMessageCompletedEventArgs e)
        {
            if (this.handler == null)
                return;

            this.handler(sender, new GetMessageCompletedEventArgsAdapter(new object[] { e.Result }, e.Error, e.Cancelled, e.UserState));
        }

        #endregion
    }
} 
```

这是事件处理程序的显式实现，因此我可以将事件链接在一起。当用户注册我的适配器事件时，我注册了实际触发的事件。当事件触发时，我触发我的适配器事件。到目前为止，这是“在我的机器上工作”。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-06T23:05:53.197

好的，我整天都在搞这个，解决方案真的比这简单得多。我最初想调用接口上的方法而不是 concreate 类。代理类生成器生成的接口只包含`BeginXXX`and`EndXXX`方法，当我调用`EndXXX`.

好吧，我刚刚读完`System.Threading.Dispatcher`，我终于明白如何使用它了。是从UI 元素`Dispatcher`继承的任何类的成员。`DispatcherObject`在`Dispatcher`UI 线程上运行，对于大多数 WPF 应用程序来说，只有 1 个 UI 线程。有例外，但我相信你必须明确地这样做，这样你就会知道你是否正在这样做。否则，您只有一个 UI 线程。因此，存储对 Dispatcher 的引用以在非 UI 类中使用是安全的。

就我而言，我使用的是 Prism，我的 Presenter 需要更新 UI（不是直接更新，而是触发`IPropertyChanged.PropertyChanged`事件）。所以我所做的是在我`Bootstrapper`将 shell 设置为时，`Application.Current.RootVisual`我还存储了对`Dispatcher`这样的引用：

```
public class Bootstrapper : UnityBootstrapper
{
    protected override IModuleCatalog GetModuleCatalog()
    {
    // setup module catalog
    }

    protected override DependencyObject CreateShell()
    {
        // calling Resolve instead of directly initing allows use of dependency injection
    Shell shell = Container.Resolve<Shell>();

        Application.Current.RootVisual = shell;

        Container.RegisterInstance<Dispatcher>(shell.Dispatcher);

        return shell;
    }
} 
```

然后我的演示者有一个接受`IUnityContainer`作为参数的 ctor（使用 DI）然后我可以执行以下操作：

```
_service.BeginGetMessage(new AsyncCallback(GetMessageAsyncComplete), null);    

private void GetMessageAsyncComplete(IAsyncResult result)
{
    string output = _service.EndGetMessage(result);
    Dispatcher dispatcher = _container.Resolve<Dispatcher>();
    dispatcher.BeginInvoke(() => this.Message = output);
} 
```

这太简单了。只是我之前没看懂。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-06T01:12:11.657

传递接口（一旦您实例化了客户端）应该与使用 HelloWorldMessageService 而不是 HelloWorldMessageServiceClient 类一样简单。

为了更新 UI，您需要使用 Dispatcher 对象。这使您可以提供在 UI 线程的上下文中调用的委托。有关详细信息，请参阅此[博客文章](http://wildermuth.com/2008/05/06/Executing_Code_on_the_UI_Thread_in_Silverlight_2.aspx)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-11-03T18:51:49.407

你可以让这更简单。

代理起作用而您的合同副本不起作用的原因是，WCF 使用代码生成代理，该代码将回调“发布”回调用线程，而不是在服务调用返回时执行的线程上进行回调。

一个非常简化、未经测试的部分实现，可让您了解 WCF 代理如何工作，如下所示：

```
{
    var state = new
        {
            CallingThread = SynchronizationContext.Current,
            Callback = yourCallback
            EndYourMethod = // assign delegate
        };

    yourService.BeginYourMethod(yourParams, WcfCallback, state);
}

private void WcfCallback(IAsyncResult asyncResult)
{
    // Read the result object data to get state
    // Call EndYourMethod and block until the finished
    state.Context.Post(state.YourCallback, endYourMethodResultValue);
} 
```

关键是syncronizationContext的存储和调用Post方法。这将使回调发生在与调用 Begin 相同的线程上。如果您从 UI 线程调用 Begin，它将始终工作而不涉及 Dispatcher 对象。如果您不这样做，那么您将回到使用 Dispatcher 的方方面面，但是 WCF 代理也会出现同样的问题。

此链接很好地解释了如何手动执行此操作：http:
[//msdn.microsoft.com/en-us/library/dd744834 (VS.95).aspx](http://msdn.microsoft.com/en-us/library/dd744834(VS.95).aspx)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-12-08T01:08:06.173

只是重温旧帖子没有得到答案，我终于找到了答案。这是我最近写的一篇文章，详细介绍了我最终如何处理这一切：

[http://www.developmentalmadness.com/archive/2009/11/04/mvvm-with-prism-101-ndash-part-6-commands.aspx](http://www.developmentalmadness.com/archive/2009/11/04/mvvm-with-prism-101-ndash-part-6-commands.aspx)

# enterprise - 是什么让应用程序或软件开发过程成为“企业”？

> ID：617380
> 
> 赞同：9
> 
> 时间：2009-03-06T01:02:56.827
> 
> 标签：enterprise, fizzbuzz

在阅读了 Wolfbyte对[Enterprise](http://code.google.com/p/fizzbuzz/) [FizzBu​​zz 的回答](https://stackoverflow.com/questions/437/what-is-your-solution-to-the-fizzbuzz-problem/1902#1902)后，我想到了什么构成了“企业”程序。

是什么使应用程序或软件开发过程成为*企业*？

**编辑：***企业*这个词似乎有很多负面影响。有没有人真正*喜欢*编写企业级应用程序？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-06T01:13:31.357

“企业级”的真正含义是：

*   与架构方案和长期技术计划的兼容性，这些计划涵盖了您或您的团队将要做的任何事情，因此无法更改。
*   符合治理要求
*   建造和维护成本高昂；）

具有以下品质：

*   可维护性
*   可扩展性
*   功能性
*   可重用性
*   可靠性
*   易懂
*   可用性
*   可修改性
*   可测试性
*   可移植性
*   效率
*   灵活性
*   模块化
*   互操作性

就“享受”编写企业级应用程序而言，这样做可能很困难，因为企业系统的特征之一是它比任何人都大。人们通常喜欢他们的工作，因为他们可以拥有它，但从这个意义上说，企业发展并不是真正“拥有”的，而是通过验收门、指导委员会和业务项目所有者引导的严格、复杂的项目路径“产生”的.

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-03-06T01:17:50.673

想想你作为程序员在软件产品中关心的所有事情。现在想想你作为用户在软件产品中关心的所有事情。

现在忘记所有这些事情。企业软件不是由用户或程序员购买的。诸如“直观”、“快速”或“可互操作”之类的要求并不适用。

相反，他们必须满足一些要求，例如“供应商发布了大量的白皮书，其中充满了‘快速’、‘直观’和‘可互操作’等字眼，所以当员工抱怨这让他们的工作变得更加困难时，我们有一些东西要指出。同时在员工记录中写入‘困难’”。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-06T01:06:58.237

慢的。难用。昂贵的。基于过时的技术。请参阅 rails 插件“ [acts_as_enterprisey](http://agilewebdevelopment.com/plugins/acts_as_enterprisey) ”

我小子。

不过说真的，它通常是指为财富 1000 强类型编写的东西，其中有大量用户和复杂的业务规则。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-06T01:19:57.517

如果你是一个普通的开发者，它比你现在正在做的事情要大。

如果你是一名建筑师，那就是你在上一个客户那里所做的事情。

如果您是首席信息官，那么“真正重要”的就是所有的东西——高于基线的东西，保持灯亮的操作。

如果你在做销售，这就是你要出价的东西。

如果它是您的产品，那么它当然是企业级的。你只花了一年时间让它“可扩展”，这样它就会成长为支持“企业”。

如果它是开源的，当然它不可能是企业级的。就此而言，您的竞争对手的产品也不是。

当然，它因客户而异。对于每年 10 亿美元的公司来说，一些 Oracle 财务报告是一项企业计划。对于一家财富 100 强的公司来说，几乎没有什么是真正的“企业”，因为整个企业是如此之大且跨越全球，以至于很难理解任何一件真正适合该企业集团所有角落和缝隙的东西。

通常企业用于否定。“您的软件/服务/产品/产品不适合企业”或“开源不适合企业计算”。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-06T01:10:46.417

[企业应用程序](http://en.wikipedia.org/wiki/Enterprise_application)通常具有多层并在许多机器上运行，旨在满足更大组织的需求。在实践中，它通常具有数据库后端、业务逻辑中间层和某种前端，例如 Web 界面。可能具有性能和高可用性要求，以及备份、日志记录、审计和身份验证。

# css - 将文本限制为同级图像的宽度/CSS中的自动宽度

> ID：617386
> 
> 赞同：26
> 
> 时间：2009-03-06T01:06:13.870
> 
> 标签：css, layout, html

我实际上是在尝试创建一个版本的“figure”元素（即将在 HTML5 中推出），其中我有一个带有简短描述的图像。

但是，我想将整个元素的宽度限制为图像的宽度，因此文本不会比图像宽（如果需要，可以换成多行）。

基本 HTML：

```
<div class="figure">
<img src="..." alt="..." width="..." height="..." /><br />
A description for the image
</div> 
```

我精通 CSS，但我想不出任何纯 CSS 解决方案，而不添加 a`style="width:100px"`以`div`匹配图像宽度。

**更新**：经过一番搜索和思考，最好的方法似乎是在 div 上使用内联宽度。我将保留图像上的宽度属性，以防我希望 div 比图像宽一点（例如容纳更长的标题）。

这种方法还意味着我可以将两张图片并排放置，并在下方添加标题。如果我有一组相同大小的图像，我当然可以为每个`div`.

感谢所有回答的人！

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2014-08-19T14:53:06.330

这也可以使用`'display: table-caption'`标题来完成，如下所示：

### HTML

```
<div class="wrapper">
  <img src="image.jpg" />
  <div class="caption">My caption...</div>
</div> 
```

### 样式表

```
.wrapper {
  display: table;
}

.caption {
  display: table-caption;
  caption-side: bottom;
} 
```

该块也可以在其他文本的左右浮动。我已经在 IE8+ 中测试过了。这是一个 JSBin 示例：http: [//jsbin.com/xiyevovelixu/1](http://jsbin.com/xiyevovelixu/1)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-06T01:39:03.853

要设置宽度以自动匹配图像，您可以使用

```
.figure {
  display: table;
  width: 1px;
} 
```

这使得 div 表现得像一个表（Internet Explorer 不支持）。或者您可以使用表格而不是 div。我认为没有另一种自动设置宽度的方法。

**编辑**：最简单的方法是忘记自动宽度并手动设置它。如果确实需要，您可以使用 JavaScript 或表格。在这种情况下，表格的使用并不是那么难看，因为您正在解决 HTML 版本的限制。在服务器端脚本的情况下，您还可以在生成页面时设置宽度。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-06T12:47:57.223

**样式表**

```
div.figure img,
div.figure div.caption {
    width: 100%;
}
div.figure div {
    overflow: hidden;
    white-space: nowrap;
} 
```

*注意：要启用换行，只需删除最后的 css 行*

**HTML**

```
<div class="figure" style="width:150px;">
    <img src="logo.png" alt="logo" />
    <div class="caption">A description for the image</div>
</div> 
```

我在 Chrome、Firefox 和 IE7 中检查过它，在这三个中看起来都不错。我意识到这有 div 上的宽度而不是 img，但至少你只需要在一个地方设置宽度。缺少使用 css 表达式（仅限 IE）我看不到将外部 div 宽度设置为第一个子元素宽度的方法。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-06T19:55:29.940

我遇到了同样的问题，在阅读完[这篇](http://www.cs.tut.fi/~jkorpela/www/captions.html)文章后决定在周围元素上使用内联样式。对我来说，似乎比使用桌子更好的解决方案。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-06T08:20:05.247

您可以将`display:table`解决方案用于所有其他浏览器，并将[CSS 行为](http://www.google.nl/search?hl=en&rlz=1C1GGLS_en-USNL292NL304&q=)用于 Internet Explorer。

# php - 在windows上的php中带有点（隐藏）文件的require_once不起作用

> ID：617396
> 
> 赞同：1
> 
> 时间：2009-03-06T01:10:01.363
> 
> 标签：php, windows

如果我删除文件名上的前导点，我的代码可以正常工作，否则会中断。

**[编辑]**
文件以点（句点）字符开头
**[结束编辑]**

require_once(' **.** htMyClass.inc.php'); //失败

require_once('htMyClass.inc.php'); //作品

我想保留这些点以确保安全——领先的**ht**只是 apache 的保留。我不希望在 Windows 上做任何特别的事情。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-06T02:37:16.460

我只是运行了一个测试代码，并且工作正常。我在 Windows 中使用 xammp，它可能是您机器中的 apache 或 php 配置。

```
<?php
require_once(".htphp.inc.php");
?>

<?php
echo "test";
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-06T03:28:41.797

阅读这篇 Microsoft 文章“ [IIS 隐藏的静态文件返回 HTTP 404 或拒绝访问错误](http://support.microsoft.com/kb/216803)”，它可能会故意失败。将其扩展到甚至无法包含该文件。

# iphone - 在 iPhone 应用程序中实例化的 UIWindow 在哪里？

> ID：617397
> 
> 赞同：3
> 
> 时间：2009-03-06T01:10:16.777
> 
> 标签：iphone, cocoa-touch, uikit

当您从 iPhoneSDK 中的“基于视图”模板创建应用程序时，会生成以下代码。我基本上明白这里发生了什么，但我没有看到 window 和 viewController 是在哪里实例化的。有什么帮助吗？

```
@class jojojViewController;

@interface jojojAppDelegate : NSObject <UIApplicationDelegate> {
    UIWindow *window;
    jojojViewController *viewController;
}

@property (nonatomic, retain) IBOutlet UIWindow *window;
@property (nonatomic, retain) IBOutlet jojojViewController *viewController;

@end 
```

================================================

```
@implementation Test6AppDelegate

@synthesize window,mainView;    

- (void)applicationDidFinishLaunching:(UIApplication *)application {    

    // Override point for customization after application launch
    [window makeKeyAndVisible];
}    

- (void)dealloc {
    [window release];
    [super dealloc];
}
@end 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-06T01:35:14.750

它们来自项目中的 MainWindow.xib（或类似）文件。

这是在 info.plist 中设置为应用程序窗口的文件。当您的应用程序启动时，此 xib 已加载，并且视图控制器和窗口未归档并已加载。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-06T03:09:06.540

如果您查看 MainWindow.xib，窗口和 viewcontroller 被分配给您的 AppDelegate 的窗口和 viewController 出口，当 nib 加载时实例化它们（右键单击 AppDelegate 以查看它）。

# hyperlink - 在不牺牲传入链接的情况下，在 IIS 中搜索引擎友好 url 的 Geeky url

> ID：617404
> 
> 赞同：1
> 
> 时间：2009-03-06T01:13:35.460
> 
> 标签：hyperlink, friendly-url

我有一个网站，我现在的“极客”网址如下所示：

> [http://www.bestatdubaiholidays.co.uk/pages/Quote/Details.aspx?GUID=01a25b0c-e0ac-40ba-abd1-298f3abd9612](http://www.bestatdubaiholidays.co.uk/pages/Quote/) **_**

我想将这些更改为搜索引擎友好的 - 例如：

> [http://www.bestatdubaiholidays.co.uk/the-palm-atlantis.aspx](http://www.bestatdubaiholidays.co.uk/) **_**

或者

> [http://www.bestatdubaiholidays.co.uk/the-palm-atlantis](http://www.bestatdubaiholidays.co.uk/) **_**

我有数百个传入链接（来自广告活动和其他网站）指向我想要保留的极客网址。

因此，如果有人键入一个极客 url，我希望地址栏显示等效的搜索引擎友好 url。

任何人都可以帮忙吗？参考其他文章无济于事。相信我，我读过每一本。任何示例网址都会有所帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-06T01:20:22.570

我建议使用 Front 控制器。这意味着您使用您使用的任何 httpd 服务器的重写引擎将所有请求重定向到单个文件（index.php 或 index.aspx 或 whathaveyou），然后使用该文件中的代码分派到适当的页面。您可以从极客 URL 重定向到友好 URL，如果它是友好 URL，则加载适当的页面。

这比为您可能拥有的每种类型的页面编写巨大的重写规则要容易得多。通过这种方式，所有工作都以您的站点已经运行的相同语言完成，因此您不必为了重定向而学习和维护使用自己语言的新文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-06T01:40:08.267

使用类似[http://blog.eworldui.net/post/2008/04/ASPNET-MVC---Legacy-Url-Routing.aspx](http://blog.eworldui.net/post/2008/04/ASPNET-MVC---Legacy-Url-Routing.aspx)

您不必使用 MVC，路由类现在是独立的

# .net - ImageList 透明度错误的解决方法？

> ID：617405
> 
> 赞同：7
> 
> 时间：2009-03-06T01:13:48.860
> 
> 标签：.net, winforms

如果您将 PNG 图像添加到 ImageList 控件并在 Windows 窗体 (.Net 2.) 应用程序中将该 ImageList 与 ListView 或 TreeView 一起使用，则 ListView 中显示的图标周围有一个蓝色“光环”。

例如：

[![替代文字](https://i.stack.imgur.com/hNFQC.png)](https://i.stack.imgur.com/hNFQC.png)
[（来源：[wordpress.com](http://deeperdesign.wordpress.com/files/2009/03/blue-halo.png)）]

有谁知道一种解决方法，允许您将带有 Alpha 通道的 32 位 PNG 添加到 ImageList 并保留透明像素并避免光环效果/错误？

谢谢。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-06T02:24:11.840

我不认为这是一个错误。您应该将 ImageList 颜色深度设置为 32 位，并且您需要使用视觉样式。

如果应用程序启用了视觉样式，WinForms 将使用支持 Alpha 透明度的 Windows 通用控件 6.0 版。否则它将使用不支持 alpha 透明度的先前版本，并错误地渲染带有蓝色光晕的 ARGB 图像。

如果您需要解决方法，您可以尝试创建相同大小的新位图，用 ListView 的 BackColor 填充它们，在位图上创建一个 Graphics 对象，然后将 ARGB 图像绘制到位图上。然后您可以将这些预混合位图插入到 ImageList 中。但是，如果您这样做，则列表视图中的图标上的选择看起来很有趣。

另一种解决方法是直接访问位图数据（使用 LockBits()）并手动混合任何半透明像素，这将导致图像正确渲染，并且看起来几乎与选择时应有的方式相同。

# scripting - 更改 MSI 中的动作序列记录的脚本

> ID：617409
> 
> 赞同：6
> 
> 时间：2009-03-06T01:14:47.670
> 
> 标签：scripting, build-process, windows-installer

要解决[此处列出](https://stackoverflow.com/questions/451573/how-do-i-eliminate-the-specified-service-already-exists-when-i-install-new-versio/617385#617385)的问题，我必须更改 MSI 中的 InstallExecuteSequence .RemoveExistingProducts 记录。

我想将此作为构建过程的一部分，而不是与 Orca 混在一起

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-06T01:18:04.900

修改 MSI_SetProperty.js 脚本给出

```
// MSI_SetActionSequence.js <msi-file> <table> <action> <sequence>
// Performs a post-build fixup of an msi to set the specified table/action/sequence

// Constant values from Windows Installer SDK
var msiOpenDatabaseModeTransact = 1;

var msiViewModifyInsert         = 1;
var msiViewModifyUpdate         = 2;
var msiViewModifyAssign         = 3;
var msiViewModifyReplace        = 4;
var msiViewModifyDelete         = 6;

if (WScript.Arguments.Length != 4)
{
    WScript.StdErr.WriteLine("Usage: " + WScript.ScriptName + " file table action sequence");
    WScript.Quit(1);
}

var filespec = WScript.Arguments(0);
var table = WScript.Arguments(1);
var action = WScript.Arguments(2);
var sequence = parseInt(WScript.Arguments(3));

var installer = WScript.CreateObject("WindowsInstaller.Installer");
var database = installer.OpenDatabase(filespec, msiOpenDatabaseModeTransact);

WScript.StdOut.WriteLine("Looking for action:" + action);

try
{   
    var sql = "SELECT Action, Sequence FROM " + table + " WHERE Action = '" + action + "'";
    var view = database.OpenView(sql);  

    view.Execute();     
    var record = view.Fetch();  

    if (record)
    {       
        while (record)
        {
            WScript.StdOut.Write("Found: " + record.StringData(0) + ", " + record.StringData(1) + ", " + record.StringData(2));
            if (record.IntegerData(2) != sequence)
            {
                WScript.StdOut.WriteLine(" - changing to " + sequence);
                record.IntegerData(2) = sequence;
                view.Modify(msiViewModifyUpdate,record);
            }
            else
                WScript.StdOut.WriteLine(" - OK");

            record = view.Fetch();
        }

        view.Close();
        database.Commit();
    }
    else
    {           
        view.Close();   
        throw("Warning - Could not find " + table + "." + action);
    }
}
catch(e)
{
    WScript.StdErr.WriteLine(e);
    WScript.Quit(1);
} 
```

要调用此脚本以执行对上述操作序列的更改，您可以将以下内容放入批处理文件中并从构建后事件中调用它，例如 PostBuildEvent = $(ProjectDir)PostBuild.bat

```
cscript.exe MSI_SetActionSequence.js YOURINSTALLER.MSI InstallExecuteSequence RemoveExistingProducts 1525 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-11-16T19:31:13.787

给其他人的一些笔记。我遇到了“错误 1001。指定的服务已经存在”的问题，并尝试了上述方法，但似乎没有用。这是我遇到的：

*** 确保安装程序项目上的 RemovePreviousVersions 属性设置为 True。这似乎很明显——很明显，也就是说，如果你知道的话。默认情况下，它设置为 False。如果为 False，上述过程将无法解决您的问题。***

我在 GAC 中安装了一些程序集。看来，当我移动 RemoveExistingProducts 序列时，这些文件已从 GAC 中删除，但未重新安装。为了解决这个问题，我在应用程序文件夹中安装了所有程序集。仅供参考，我正在使用 VS2010。

此外，另一个挑剔。如果用户在尝试重新安装相同版本的产品时选择“修复”，他们仍然会收到“指定的服务已存在”错误。如果我有时间，我会尝试解决这个问题。如果那里的其他人知道如何解决它，您可以发布吗？

说了这么多，谢谢发帖！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-02-14T12:54:00.750

Ryan 提供的解决方案解决了我面临的部分问题。它确实执行完全卸载，然后安装。

但是，我还有另一个问题，在我的情况下，一些程序在后台运行。在安装程序可以运行之前，安装程序会抱怨某些文件正在使用中。并提供标准对话框，要求关闭应用程序或重新启动以完成更新。

有没有办法，例如。自定义操作或设置，以终止在后台运行的进程，以便安装程序顺利进行？

# java - 如何在 Java 中创建临时目录/文件夹？

> ID：617414
> 
> 赞同：403
> 
> 时间：2009-03-06T01:17:55.057
> 
> 标签：java, file, file-io, directory, temporary-directory

在 Java 应用程序中创建临时目录是否有标准且可靠的方法？[Java的问题数据库中](http://bugs.java.com/bugdatabase/view_bug.do?bug_id=4735419)有一个条目，评论中有一些代码，但我想知道是否可以在常用库之一（Apache Commons等）中找到标准解决方案？

* * *

## 回答 #1

> 赞同：425
> 
> 时间：2009-03-06T01:31:27.817

如果您使用的是 JDK 7，请使用新的[Files.createTempDirectory](http://docs.oracle.com/javase/7/docs/api/java/nio/file/Files.html#createTempDirectory%28java.nio.file.Path,%20java.lang.String,%20java.nio.file.attribute.FileAttribute...%29)类来创建临时目录。

```
Path tempDirWithPrefix = Files.createTempDirectory(prefix); 
```

在 JDK 7 之前应该这样做：

```
public static File createTempDirectory()
    throws IOException
{
    final File temp;

    temp = File.createTempFile("temp", Long.toString(System.nanoTime()));

    if(!(temp.delete()))
    {
        throw new IOException("Could not delete temp file: " + temp.getAbsolutePath());
    }

    if(!(temp.mkdir()))
    {
        throw new IOException("Could not create temp directory: " + temp.getAbsolutePath());
    }

    return (temp);
} 
```

如果你愿意，你可以做出更好的例外（子类 IOException）。

* * *

## 回答 #2

> 赞同：183
> 
> 时间：2011-06-19T17:15:17.127

Google Guava 库有很多有用的实用程序。这里要注意的一点是[Files 类](http://google.github.io/guava/releases/19.0/api/docs/com/google/common/io/Files.html)。它有很多有用的方法，包括：

```
File myTempDir = Files.createTempDir(); 
```

这正是您在一行中所要求的。如果您阅读[此处](http://google.github.io/guava/releases/19.0/api/docs/com/google/common/io/Files.html#createTempDir())的文档，您会发现建议的改编`File.createTempFile("install", "dir")`通常会引入安全漏洞。

* * *

## 回答 #3

> 赞同：177
> 
> 时间：2011-05-31T09:10:49.917

如果您需要一个临时目录进行测试并且您正在使用 jUnit，则`@Rule`可以`TemporaryFolder`解决您的问题：

```
@Rule
public TemporaryFolder folder = new TemporaryFolder(); 
```

从[文档](https://junit.org/junit4/javadoc/latest/index.html)中：

> TemporaryFolder Rule 允许创建保证在测试方法完成时删除的文件和文件夹（无论是通过还是失败）

* * *

**更新：**

如果您使用的是 JUnit Jupiter（5.1.1 或更高版本），您可以选择使用 JUnit Pioneer，它是 JUnit 5 扩展包。

从[项目文档](https://junit-pioneer.org/docs/temp-directory/)中复制：

> 例如，以下测试为单个测试方法注册扩展，创建文件并将其写入临时目录并检查其内容。

```
@Test
@ExtendWith(TempDirectory.class)
void test(@TempDir Path tempDir) {
    Path file = tempDir.resolve("test.txt");
    writeFile(file);
    assertExpectedFileContent(file);
} 
```

[JavaDoc](https://javadoc.io/doc/org.junit-pioneer/junit-pioneer/0.1.2)和[TempDirectory 的 JavaDoc 中](https://static.javadoc.io/org.junit-pioneer/junit-pioneer/0.1.2/org/junitpioneer/jupiter/TempDirectory.html)的更多信息

摇篮：

```
dependencies {
    testImplementation 'org.junit-pioneer:junit-pioneer:0.1.2'
} 
```

马文：

```
<dependency>
   <groupId>org.junit-pioneer</groupId>
   <artifactId>junit-pioneer</artifactId>
   <version>0.1.2</version>
   <scope>test</scope>
</dependency> 
```

* * *

**更新 2：**

@TempDir注释[已](https://junit.org/junit5/docs/5.4.0/api/org/junit/jupiter/api/io/TempDir.html)作为实验性功能添加到 JUnit Jupiter 5.4.0 版本中。[从JUnit 5 用户指南](https://junit.org/junit5/docs/5.4.0/user-guide/#writing-tests-built-in-extensions-TempDirectory)复制的示例：

```
@Test
void writeItemsToFile(@TempDir Path tempDir) throws IOException {
    Path file = tempDir.resolve("test.txt");

    new ListWriter(file).write("a", "b", "c");

    assertEquals(singletonList("a,b,c"), Files.readAllLines(file));
} 
```

* * *

## 回答 #4

> 赞同：43
> 
> 时间：2011-10-18T07:21:52.683

天真地编写代码来解决这个问题会受到竞争条件的影响，包括这里的几个答案。从历史上看，您可以仔细考虑竞争条件并自己编写，或者您可以使用第三方库，如 Google 的 Guava（如 Spina 的回答所建议的那样）。或者您可以编写有缺陷的代码。

但是从 JDK 7 开始，有好消息！Java 标准库本身现在为这个问题提供了一个正常工作（非竞争性）的解决方案。你想要[java.nio.file.Files#createTempDirectory()](http://download.oracle.com/javase/7/docs/api/java/nio/file/Files.html#createTempDirectory(java.nio.file.Path,%20java.lang.String,%20java.nio.file.attribute.FileAttribute...))。从[文档](http://download.oracle.com/javase/7/docs/api/java/nio/file/Files.html#createTempDirectory(java.nio.file.Path,%20java.lang.String,%20java.nio.file.attribute.FileAttribute...))中：

```
public static Path createTempDirectory(Path dir,
                       String prefix,
                       FileAttribute<?>... attrs)
                                throws IOException 
```

> 在指定目录中创建一个新目录，使用给定的前缀生成其名称。生成的 Path 与给定目录相同的 FileSystem 相关联。
> 
> 关于如何构造目录名称的细节取决于实现，因此未指定。在可能的情况下，前缀用于构造候选名称。

这有效地解决了Sun 错误跟踪器中[令人尴尬的古老错误报告](http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=4735419)，该报告要求提供这样的功能。

* * *

## 回答 #5

> 赞同：38
> 
> 时间：2012-01-25T06:58:52.853

这是 Guava 库的 Files.createTempDir() 的源代码。它没有你想象的那么复杂：

```
public static File createTempDir() {
  File baseDir = new File(System.getProperty("java.io.tmpdir"));
  String baseName = System.currentTimeMillis() + "-";

  for (int counter = 0; counter < TEMP_DIR_ATTEMPTS; counter++) {
    File tempDir = new File(baseDir, baseName + counter);
    if (tempDir.mkdir()) {
      return tempDir;
    }
  }
  throw new IllegalStateException("Failed to create directory within "
      + TEMP_DIR_ATTEMPTS + " attempts (tried "
      + baseName + "0 to " + baseName + (TEMP_DIR_ATTEMPTS - 1) + ')');
} 
```

默认情况下：

```
private static final int TEMP_DIR_ATTEMPTS = 10000; 
```

[看这里](http://code.google.com/p/guava-libraries/source/browse/guava/src/com/google/common/io/Files.java)

* * *

## 回答 #6

> 赞同：30
> 
> 时间：2009-10-01T22:08:08.820

`deleteOnExit()`即使您稍后明确删除它也不要使用。

[谷歌“deleteonexit is evil”](http://www.google.com/search?q=deleteonexit+is+evil)以获取更多信息，但问题的要点是：

1.  `deleteOnExit()`仅在正常 JVM 关闭时删除，不会崩溃或终止 JVM 进程。

2.  `deleteOnExit()`仅在 JVM 关闭时删除 - 不适合长时间运行的服务器进程，因为：

3.  最邪恶的 -`deleteOnExit()`为每个临时文件条目消耗内存。如果您的进程运行了几个月，或者在短时间内创建了大量临时文件，那么您会消耗内存并且在 JVM 关闭之前永远不会释放它。

* * *

## 回答 #7

> 赞同：20
> 
> 时间：2012-01-09T20:33:18.900

从 Java 1.7 开始`createTempDirectory(prefix, attrs)`，`createTempDirectory(dir, prefix, attrs)`包含在`java.nio.file.Files`

例子： `File tempDir = Files.createTempDirectory("foobar").toFile();`

* * *

## 回答 #8

> 赞同：14
> 
> 时间：2009-08-20T12:47:02.137

这就是我决定为自己的代码做的事情：

```
/**
 * Create a new temporary directory. Use something like
 * {@link #recursiveDelete(File)} to clean this directory up since it isn't
 * deleted automatically
 * @return  the new directory
 * @throws IOException if there is an error creating the temporary directory
 */
public static File createTempDir() throws IOException
{
    final File sysTempDir = new File(System.getProperty("java.io.tmpdir"));
    File newTempDir;
    final int maxAttempts = 9;
    int attemptCount = 0;
    do
    {
        attemptCount++;
        if(attemptCount > maxAttempts)
        {
            throw new IOException(
                    "The highly improbable has occurred! Failed to " +
                    "create a unique temporary directory after " +
                    maxAttempts + " attempts.");
        }
        String dirName = UUID.randomUUID().toString();
        newTempDir = new File(sysTempDir, dirName);
    } while(newTempDir.exists());

    if(newTempDir.mkdirs())
    {
        return newTempDir;
    }
    else
    {
        throw new IOException(
                "Failed to create temp dir named " +
                newTempDir.getAbsolutePath());
    }
}

/**
 * Recursively delete file or directory
 * @param fileOrDir
 *          the file or dir to delete
 * @return
 *          true iff all files are successfully deleted
 */
public static boolean recursiveDelete(File fileOrDir)
{
    if(fileOrDir.isDirectory())
    {
        // recursively delete contents
        for(File innerFile: fileOrDir.listFiles())
        {
            if(!FileUtilities.recursiveDelete(innerFile))
            {
                return false;
            }
        }
    }

    return fileOrDir.delete();
} 
```

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2008-12-17T20:33:03.067

好吧，“createTempFile”实际上是创建文件。那么为什么不先删除它，然后在上面执行 mkdir 呢？

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2008-12-17T20:55:24.833

这段代码应该可以很好地工作：

```
public static File createTempDir() {
    final String baseTempPath = System.getProperty("java.io.tmpdir");

    Random rand = new Random();
    int randomInt = 1 + rand.nextInt();

    File tempDir = new File(baseTempPath + File.separator + "tempDir" + randomInt);
    if (tempDir.exists() == false) {
        tempDir.mkdir();
    }

    tempDir.deleteOnExit();

    return tempDir;
} 
```

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2008-12-17T20:33:56.297

如[本 RFE](http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=4735419)及其评论中所述，您可以`tempDir.delete()`先致电。或者您可以`System.getProperty("java.io.tmpdir")`在那里使用并创建一个目录。无论哪种方式，您都应该记住调用`tempDir.deleteOnExit()`，否则完成后文件不会被删除。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2016-06-21T12:56:54.727

只是为了完成，这是来自谷歌番石榴库的代码。这不是我的代码，但我认为在这个线程中展示它是有价值的。

```
 /** Maximum loop count when creating temp directories. */
  private static final int TEMP_DIR_ATTEMPTS = 10000;

  /**
   * Atomically creates a new directory somewhere beneath the system's temporary directory (as
   * defined by the {@code java.io.tmpdir} system property), and returns its name.
   *
   * <p>Use this method instead of {@link File#createTempFile(String, String)} when you wish to
   * create a directory, not a regular file. A common pitfall is to call {@code createTempFile},
   * delete the file and create a directory in its place, but this leads a race condition which can
   * be exploited to create security vulnerabilities, especially when executable files are to be
   * written into the directory.
   *
   * <p>This method assumes that the temporary volume is writable, has free inodes and free blocks,
   * and that it will not be called thousands of times per second.
   *
   * @return the newly-created directory
   * @throws IllegalStateException if the directory could not be created
   */
  public static File createTempDir() {
    File baseDir = new File(System.getProperty("java.io.tmpdir"));
    String baseName = System.currentTimeMillis() + "-";

    for (int counter = 0; counter < TEMP_DIR_ATTEMPTS; counter++) {
      File tempDir = new File(baseDir, baseName + counter);
      if (tempDir.mkdir()) {
        return tempDir;
      }
    }
    throw new IllegalStateException(
        "Failed to create directory within "
            + TEMP_DIR_ATTEMPTS
            + " attempts (tried "
            + baseName
            + "0 to "
            + baseName
            + (TEMP_DIR_ATTEMPTS - 1)
            + ')');
  } 
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2013-01-29T01:15:47.310

我遇到了同样的问题，所以这只是对那些感兴趣的人的另一个答案，它类似于上述之一：

```
public static final String tempDir = System.getProperty("java.io.tmpdir")+"tmp"+System.nanoTime();
static {
    File f = new File(tempDir);
    if(!f.exists())
        f.mkdir();
} 
```

对于我的应用程序，我决定添加一个选项以清除退出时的**温度**，因此我添加了一个关闭挂钩：

```
Runtime.getRuntime().addShutdownHook(new Thread() {
        @Override
        public void run() {
            //stackless deletion
            String root = MainWindow.tempDir;
            Stack<String> dirStack = new Stack<String>();
            dirStack.push(root);
            while(!dirStack.empty()) {
                String dir = dirStack.pop();
                File f = new File(dir);
                if(f.listFiles().length==0)
                    f.delete();
                else {
                    dirStack.push(dir);
                    for(File ff: f.listFiles()) {
                        if(ff.isFile())
                            ff.delete();
                        else if(ff.isDirectory())
                            dirStack.push(ff.getPath());
                    }
                }
            }
        }
    }); 
```

**该方法在删除temp**之前删除所有子目录和文件，而不使用调用堆栈（这完全是可选的，此时您可以使用递归来完成），但我想安全起见。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2014-06-24T10:30:16.530

正如您在其他答案中看到的那样，没有出现标准方法。[因此，您已经提到了 Apache Commons，我建议使用来自Apache Commons IO](http://commons.apache.org/proper/commons-io/)的 FileUtils 的以下方法：

```
/**
 * Creates a temporary subdirectory in the standard temporary directory.
 * This will be automatically deleted upon exit.
 * 
 * @param prefix
 *            the prefix used to create the directory, completed by a
 *            current timestamp. Use for instance your application's name
 * @return the directory
 */
public static File createTempDirectory(String prefix) {

    final File tmp = new File(FileUtils.getTempDirectory().getAbsolutePath()
            + "/" + prefix + System.currentTimeMillis());
    tmp.mkdir();
    Runtime.getRuntime().addShutdownHook(new Thread() {

        @Override
        public void run() {

            try {
                FileUtils.deleteDirectory(tmp);
            } catch (IOException e) {
                e.printStackTrace();
            }
        }
    });
    return tmp;

} 
```

这是首选，因为 apache 共享最接近所要求的“标准”的库，并且适用于 JDK 7 和旧版本。这也返回一个“旧” File 实例（基于流）而不是“新” Path 实例（基于缓冲区，将是 JDK7 的 getTemporaryDirectory() 方法的结果）-> 因此它返回大多数人需要什么时候他们想创建一个临时目录。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2020-02-13T11:10:51.433

**试试这个小例子：**

**代码：**

```
try {
    Path tmpDir = Files.createTempDirectory("tmpDir");
    System.out.println(tmpDir.toString());
    Files.delete(tmpDir);
} catch (IOException e) {
    e.printStackTrace();
} 
```

**导入：**
java.io.IOException
java.nio.file.Files
java.nio.file.Path

**Windows 机器上的控制台输出：**
C:\Users\userName\AppData\Local\Temp\tmpDir2908538301081367877

**评论：**
Files.createTempDirectory 自动生成唯一 ID - 2908538301081367877。

**注意：**
阅读以下递归
[删除目录：在 Java 中递归删除目录](https://stackoverflow.com/questions/779519/delete-directories-recursively-in-java)

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2011-01-12T19:04:30.487

我喜欢多次尝试创建唯一名称，但即使是这个解决方案也不排除竞争条件。在测试`exists()`和`if(newTempDir.mkdirs())`方法调用之后，另一个进程可能会进入。我不知道如何在不诉诸本机代码的情况下完全确保它的安全，我认为这是隐藏在`File.createTempFile()`.

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2017-05-15T08:56:48.713

在 Java 7 之前，您还可以：

```
File folder = File.createTempFile("testFileUtils", ""); // no suffix
folder.delete();
folder.mkdirs();
folder.deleteOnExit(); 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-03-06T09:55:44.017

使用`File#createTempFile`and`delete`为目录创建一个唯一的名称似乎没问题。您应该添加一个`ShutdownHook`以在 JVM 关闭时（递归地）删除目录。

# ruby-on-rails - 测试突然出错。有人看到这个错误吗？

> ID：617419
> 
> 赞同：2
> 
> 时间：2009-03-06T01:20:09.797
> 
> 标签：ruby-on-rails, ruby, unit-testing, testing

Ruby 1.8.6、Rails 2.2.2、OS X Tiger

我的 Test::Unit 测试开始返回以下错误。相关行似乎是：

```
`load_missing_constant': 
  Expected /Users/ethan/project/mtc/webcalendars/app/models/calendar.rb 
  to define Calendar (LoadError) 
```

提到的文件，`calendar.rb`看起来不错。我在其中找不到任何错误。我尝试删除日历模型的单元和功能测试文件，但这对错误没有影响。

在浏览器中，应用程序似乎运行正常。

有什么见解吗？谁能提出一种隔离问题的方法？

更长的摘录：

```
$ rake test
(in /Users/ethan/project/mtc/webcalendars)
/usr/local/bin/ruby -Ilib:test "/usr/local/lib/ruby/gems/1.8/gems/rake-0.8.3/lib/rake/rake_test_loader.rb" 
  "test/unit/calendar_event_test.rb" "test/unit/calendar_test.rb" "test/unit/committee_test.rb" 
  "test/unit/event_test.rb" "test/unit/general_app_mailer_test.rb" "test/unit/location_test.rb" 
  "test/unit/persistent_login_test.rb" "test/unit/role_test.rb" "test/unit/user_role_test.rb" 
  "test/unit/user_test.rb" 
/usr/local/lib/ruby/gems/1.8/gems/activesupport-2.2.2/lib/active_support/dependencies.rb:428:in 
  `load_missing_constant': Expected /Users/ethan/project/mtc/webcalendars/app/models/calendar.rb to define Calendar (LoadError)
    from /usr/local/lib/ruby/gems/1.8/gems/activesupport-2.2.2/lib/active_support/dependencies.rb:77:in `const_missing'
    from /usr/local/lib/ruby/gems/1.8/gems/activesupport-2.2.2/lib/active_support/dependencies.rb:89:in `const_missing'

[ ... ]

/usr/local/bin/ruby -Ilib:test "/usr/local/lib/ruby/gems/1.8/gems/rake-0.8.3/lib
  /rake/rake_test_loader.rb"  
Errors running test:units and test:functionals! 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-06T01:50:33.543

Ethan，我唯一一次看到这种情况是我在一个文件中定义了多个类。我自己并没有过多地使用 test:unit，但是您是否有可能在定义 Calendar 之前定义了另一个类？

希望有帮助。

# javascript - JavaScript 增强原型生命周期

> ID：617422
> 
> 赞同：3
> 
> 时间：2009-03-06T01:24:20.003
> 
> 标签：javascript, prototype

如果我想向所有 JavaScript 数组添加一个 isEmpty 方法，我会使用以下代码

```
Array.prototype.isEmpty = function() {
  return this.length == 0;
} 
```

假设此代码在文件 foo.js 中。如果我希望 isEmpty 在网站的所有页面上都可用，我是否需要在所有 HTML 文件中包含 foo.js？换句话说，当用户导航到不同的页面时，原型是否会“重置”？

谢谢，唐

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-06T05:14:35.287

是的，您需要在每个页面加载时包含您的代码。

将每个页面加载视为一个编译/链接周期。页面上所有不同的 Javascript 位都链接在一起¹然后作为一个巨大的程序执行。下次加载页面时，默认 Javascript 对象会以全新状态启动。

* * *

1\. 以“每段代码共享相同的全局命名空间”的方式链接在一起

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-06T01:31:59.393

是的，您必须在每个页面加载后修改原型

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-06T01:31:08.210

是的，http 是无状态的，所以每个页面都是单独加载的。

但是添加到 Array.prototype 并不是一个好主意。这意味着如果您尝试循环使用它，您可能会遇到麻烦。

# c# - 如何从数组中找到前几个值？

> ID：617424
> 
> 赞同：2
> 
> 时间：2009-03-06T01:24:25.150
> 
> 标签：c#, algorithm, arrays, max

我有一个浮点值数组，想要这个值，更重要的是最大四个值的位置。

我最初构建系统是为了遍历数组并以通常的方式找到最大值，方法是将当前位置的值与记录的 max-so-far 进行比较，并在 max-so-far 变化时更新位置变量。这很好用，一个非常简单的 O(n) 算法。后来我才知道，我不仅需要保持最高价值，还需要保持前三四​​名。我扩展了相同的过程并将 max-so-far 复杂化为一个包含四个 max-so-far 的数组，现在代码很难看。

它仍然可以工作并且仍然足够快，因为只在过程中添加了少量的计算。它仍然有效地遍历数组并检查每个值一次。

我在 MATLAB 中使用返回两个数组、排序列表和随附的原始位置列表的排序函数来执行此操作。通过查看前几个值，我得到了我所需要的。我正在将此功能复制到 C# .NET 2.0 程序中。

我知道我可以对 List 对象做类似的事情，并且 List 对象具有内置的排序例程，但我不相信它可以告诉我原始位置，而这些正是我所追求的。

它一直运行良好，但现在我发现自己想要第五个最大值，并且看到重写目前是一个丑陋的 if 语句混乱的 max-so-far 检查器只会加剧丑陋。添加第五个级别会很好并且不会变慢，但我想问问 SO 社区是否有更好的方法。

对整个列表进行排序比我当前的方法需要更多的计算，但我认为这不是问题，因为列表“只有”一两千个浮点数；因此，如果有一个排序例程可以返回原始位置，那将是理想的。

作为背景，该数组是对一千字节波形文件进行傅立叶变换的结果，因此最大值的位置对应于样本数据的峰值频率。我一直对前四名感到满意，但我认为需要真正收集前五名或六名以获得更准确的样本分类。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-06T01:30:18.087

我可以建议您必须编码的替代算法:)

使用大小为 K 的堆，其中 K 表示要保存的顶部元素的数量。将其初始化为原始数组的前 K 个元素。对于所有 N - K 元素遍历数组，并在需要时插入。

```
proc top_k (array<n>, heap<k>)
heap <- array<1..k-1>
for each (array<k..n-1>) 
  if array[i] > heap.min
     heap.erase(heap.min)
     heap.insert(array[i])
  end if
end for 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-06T01:33:24.100

您仍然可以使用您的列表想法 - 您放入列表中的元素可以是存储索引和值的结构；但仅按值排序，例如：

```
class IndexAndValue : IComparable<IndexAndValue>
{
    public int index;
    public double value;

    public int CompareTo(IndexAndValue other)
    {
        return value.CompareTo(other.value);
    }
} 
```

然后您可以将它们粘贴在列表中，同时保留有关索引的信息。如果你只保留列表中最大的 m 个项目，那么你的效率应该是 O(mn)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-06T02:04:38.847

我不知道您当前使用的是哪种算法，但我会建议一个简单的算法。承认您有一个浮点数组`f`和最大`capacity` 数字，您可以执行以下操作：

```
int capacity = 4; // number of floats you want to retrieve
float [] f; // your float list
float [] max_so_far = new float[capacity]; // max so far

// say that the first 'capacity' elements are the biggest, for now
for (int i = 0; i < capacity; i++)
  max_so_far[i] = i;

// for each number not processed
for (int i = capacity; i < f.length; i++)
{
  // find out the smallest 'max so far' number
  int m = 0;
  for (int j = 0; j < capacity; j++)
    if (f[max_so_far[j]] < f[max_so_far[m]])
      m = j;

  // if our current number is bigger than the smallest stored, replace it
  if (f[i] > f[max_so_far[m]])
    max_so_far[m] = i;
} 
```

在算法结束时，您将拥有存储在 中的最大元素的索引`max_so_far`。

请注意，如果`capacity`值增长，它将比替代方案稍慢，后者在跟踪初始位置的同时对列表进行排序。请记住，排序需要 O(n *log n) 比较，而该算法需要 O(n*容量)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-01-07T11:16:26.437

另一种选择是使用快速选择。快速选择返回列表中第 k 个元素的位置。在获得第 k 个元素的位置和值后，遍历列表并获取值小于/大于第 k 个元素的每个元素。

我在这里找到了快速选择的 ac# 实现：[链接文本](http://dpatrickcaldwell.blogspot.com/2009/03/more-ilist-extension-methods.html)

优点：

1.  O(n+k) 平均运行时间。

缺点：

1.  找到的 k 个元素未排序。如果对它们进行排序，则运行时间为 O(n + logk)
2.  我没有检查过这个，但我认为对于一个非常小的 k 最好的选择是在数组上运行 k ，每次都找到下一个最小/最大的元素。

# java - “找不到符号方法 getGL()”（现在也是 getGLU()）

> ID：617429
> 
> 赞同：0
> 
> 时间：2009-03-06T01:28:37.823
> 
> 标签：java, opengl, jogl

我正在尝试学习如何使用 JoGL，出于某种原因，尽管导入了所有这些，但我还是遇到了这个错误：

```
导入 javax.media.opengl.*；
导入 javax.media.opengl.glu.*；
导入 com.sun.opengl.util.*；
导入 com.sun.opengl.util.j2d.*；

```

```
公共无效显示（javax.media.opengl.GLDrawable gLDrawable）
    {
      最终 GL gl = gLDrawable.getGL();
    }

```

也不

```
公共无效显示（GLDrawable gLDrawable）
    {
      最终 GL gl = gLDrawable.getGL();
    }

```

工作。

我该如何解决？

（编辑：将下一个问题移至此处...如果您得到的答案发生变化，您可以编辑您的问题或提出新问题）

好的，这适用于 getGL()，但现在我仍然遇到“找不到符号方法 getGL **U** ()”的问题

```
public void reshape(GLAutoDrawable gLDrawable, int x, int y, int width, int height)
{
  final GL gl = gLDrawable.getGL();
  final GLU glu = gLDrawable.getGLU();
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-06T01:46:01.090

这是因为 GLDrawable 实际上*没有*这样的方法 - 请参见[此处](http://download.java.net/media/jogl/builds/archive/jsr-231-beta5/javadoc_public/javax/media/opengl/GLDrawable.html)。

这是一个由 GLCanvas 和 GLJPanel 实现的接口，它们都有这样的方法。

我认为你需要做的是传入一个 GLAutoDrawable 并使用它的 getGL 方法。见[这里](http://download.java.net/media/jogl/builds/archive/jsr-231-beta5/javadoc_public/javax/media/opengl/GLAutoDrawable.html)。

[这篇维基百科文章](http://en.wikipedia.org/wiki/Java_OpenGL)有一些示例源，显示了它是如何完成的。

在回答您询问为什么`final GLU glu = gLDrawable.getGLU();`不起作用的进一步查询时，您可能正在使用 API 的最新 JSR-231 版本，但您自己的代码基于较旧的源代码示例。

在该规范之前，您曾经从以下位置获取 GLU：

```
final GLU glu = glAutoDrawable.getGLU(); 
```

有了它，您现在只需使用：

```
final GLU glu = new GLU(); 
```

有关该特定对象的详细信息，请参见[此处](http://download.java.net/media/jogl/builds/archive/jsr-231-beta5/javadoc_public/javax/media/opengl/glu/GLU.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-06T02:00:40.040

好的，这适用于 getGL()，但现在我仍然遇到“找不到符号方法 getGL **U** ()”的问题

```
public void reshape(GLAutoDrawable gLDrawable, int x, int y, int width, int height)
    {
      最终 GL gl = gLDrawable.getGL();
      最终 GLU glu = gLDrawable.getGLU();
    }

```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-06T02:30:27.817

看起来，根据您使用的 API 版本，getGLU 方法不存在。您可以通过查看（希望）与您下载的版本一起提供的 javadoc 来了解存在哪些方法。

您使用的是什么版本（指向您下载位置的链接会很棒）。

# jquery - jQuery 插件仅适用于最后声明的元素

> ID：617432
> 
> 赞同：0
> 
> 时间：2009-03-06T01:30:06.980
> 
> 标签：jquery, jquery-plugins

我编写了一个 jQuery 插件来控制同一页面上多个图像的动画。调用在开始时初始化为：

$("#image1").anims({top: "240px", left: "300px"});

$("#image2").anims({top: "160px", left: "430px"});

动画插件基本上根据提供的顶部和左侧参数在鼠标悬停和鼠标悬停（使用悬停）上应用一堆动画。但是，一旦在 Safari 中加载了所有内容，将鼠标悬停在 #image2 上会导致 #image1 使用为 #image2 设置的参数进行动画处理。将鼠标悬停在#image1 上会按照应为#image1 设置的参数为#image1 设置动画。在 Firefox 中，情况正好相反。我想这与他们加载的顺序有关。

我可能做错了什么？我在整个插件中使用 $(this) 进行 animate() 和其他各种调用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-06T02:13:33.067

我解决了我的问题。在我的插件中，我写道：

img = $(这个);

然后使用 img 变量来控制之后的一切。将其更改为：

var img = $(this);

解决了我的问题。愚蠢的错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-06T01:39:54.663

我会仔细检查此页面上的所有要点：http: [//docs.jquery.com/Plugins/Authoring](http://docs.jquery.com/Plugins/Authoring)

> *   将您的文件命名为 jquery.[插入插件名称].js，例如。jquery.debug.js
> *   所有新方法都附加到 jQuery.fn 对象，所有函数都附加到 jQuery 对象。
> *   在方法内部，'this' 是对当前 jQuery 对象的引用。
> *   您附加的任何方法或函数都必须在末尾有一个分号 (;) - 否则压缩时代码会中断。
> *   您的方法必须返回 jQuery 对象，除非另有明确说明。
> *   您应该使用 this.each 来迭代当前匹配的元素集 - 它以这种方式生成干净且兼容的代码。
> *   始终在插件代码中使用 jQuery 而不是 $ - 这允许用户在一个地方更改 jQuery 的别名。请参阅下面的解释和更优雅的解决方案。

例如，您说您正在使用`$(this)`，但您应该使用`jQuery(this)`. 我怀疑那是问题所在，但您应该密切关注文档，以防因不遵循其中之一而导致一些意外行为。你要返回 jQuery 对象吗？

除此之外，您确实需要发布您的动画插件的来源，以便我们可以尝试查看可能出现的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-26T11:18:51.840

当某些操作仅应用于选择/数组的最后一个元素或您获得选择的最后一个 ID/属性时，您可能还会发现[这篇文章解释了常见的 javascript 问题。](http://jquery-howto.blogspot.com/2009/03/only-last-element-is-boundinsertedetc.html)

# c# - 字典 或 NameValueCollection

> ID：617443
> 
> 赞同：32
> 
> 时间：2009-03-06T01:34:44.910
> 
> 标签：c#, generics

我有一个场景，我可以使用 NameValueCollection 或 IDictionary。但我想知道哪一个在性能方面会更好。

-- 使用 NameValueCollection

```
NameValueCollection options()
{
    NameValueCollection nc = new NameValueCollection();

    nc = ....; //populate nc here

    if(sorting)
       //sort NameValueCollection nc here

    return nc;
} 
```

-- 使用字典

```
IDictionary<string, string> options()
{
    Dictionary<string, string> optionDictionary = new Dictionary<string, string>();

    optionDictionary = ....; //populate

    if(sorting)
       return new SortedDictionary<string, string>(optionDictionary);
    else
       return optionDictionary;
} 
```

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-03-06T02:02:52.470

这些集合类型不能完全互换：`NameValueCollection`允许通过**整数索引**进行访问。如果您不需要该功能，则不应使用 a `NameValueCollection`，因为索引不是**“免费”提供的**。

根据您正在查看的字符串数量，我会考虑`Hashtable<string, string>`或`IDictionary<string, string>`。Krzysztof Cwalina 在这里讨论了其中的微妙之处：http: [//blogs.gotdotnet.com/kcwalina/archive/2004/08/06/210297.aspx](http://blogs.msdn.com/b/kcwalina/archive/2004/08/06/210297.aspx)。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-06T03:30:14.867

IDictionary 的另一个优点是它不像 NameValueCollection 那样特定于实现。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-06T04:19:19.850

我同意 fatcat 和 lomaxx （并且对这两个答案都投了赞成票）。我要补充一点，在选择集合类型时，集合类型的性能很可能是最后考虑的因素。使用最适合您使用需求的类型。如果您处于代码的性能关键部分（很可能不是），那么唯一的答案是衡量每个案例 - 不要相信 Interweb，相信数字。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-01-22T16:17:33.777

.NET 中的 NameValueCollection 基本上是 QueryStrings 用来保存键/值对的。最大的区别是添加具有相同键的两个项目时。使用 IDictionary，有两种设置值的方法。当键已经存在时，使用 .Add() 方法会在重复键上引发错误。但简单地将项目设置为一个值将覆盖该值。这就是 IDictionary 处理重复键的方式。但 NameValueCollection 将添加如下值：“value1,value2,value3”。因此，现有的项目值会附加一个逗号，然后每次都附加新的值。

在我看来，这个 NameValueCollection 是专门为 QueryString 的使用和访问而构建的。.NET 中像 "?a=1&b=2&a=3" 这样的 QueryString 将产生 item["a"] = "1,3" 的结果。这种如何处理重复键的差异是“真正的”差异，即两者之间的最大差异。

我*怀疑*NameValueCollection 在集合很大时也不会使用任何哈希表来快速访问键，因为这种访问对于小型集合来说比没有哈希表时要慢。我还没有找到明确的信息来说明 NameValueCollection 是否使用哈希表来访问密钥。我*确实*知道 IDictionary 使用哈希表，因此使用许多键访问 IDictionary 中的键非常快。所以我*怀疑*NameValueCollection 对于小型集合来说比 IDictionary 更快。如果我的猜测是正确的，那么它意味着 NameValueCollection 绝对不能用于大型集合，因为它越大，如果没有哈希表来访问键，它就会大大减慢。

对于查询字符串中的键数，这个数字通常非常小，所以我*猜*NameValueCollection 不*使用*散列，以获得更好的性能。但是，如果 Microsoft 设计的东西是为了性能，以及为用户提供最好的东西，*那么*Windows 将与今天大不相同。所以我们不能假设任何“不应该”的事情。

另外，我想通过对这个问题的最普遍投票的答案来澄清一个不正确的主张。Kateroh 在错误答案下方的评论说它很好，我不需要添加任何东西。但是我在这里重复 Kateroh 的评论，所以也许更多的人会意识到最受欢迎的答案是*错误*的。卡特罗正确地指出：

*   根据这篇关于 NameValueCollection 的 msdn 文章：[https](https://msdn.microsoft.com/en-us/library/system.collections.specialized.namevaluecollection.aspx) ://msdn.microsoft.com/en-us/library/system.collections.specialized.namevaluecollection.aspx “这种类型的集合不保留元素的顺序，也没有特定的顺序在枚举集合时得到保证。” – 2011 年 3 月 4 日 18:38

# html - CSS中选择器的速度/冗余

> ID：617446
> 
> 赞同：2
> 
> 时间：2009-03-06T01:35:47.947
> 
> 标签：html, css, performance, css-selectors

有人知道 CSS 中的浏览器选择器速度吗？换句话说，不同的选择器如何相互比较（在同一浏览器中）。

例如，我经常看到（并编写）这样的代码：

```
#content #elem { ...rules... } 
```

但由于这些元素是唯一的 ID，我应该只需要`#elem`，对吗？这让我开始思考浏览器是否拥有更复杂的选择器是否会更快——我的想法是浏览器可能会找到`#content`并知道只查看该元素，而不是其他地方。

另一个例子可能是`table tr td .class`vs`table .class`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-06T02:54:16.543

[**这**](http://ajaxian.com/archives/css-child-selector-performance)是我快速搜索后得到的一些信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-06T01:45:23.400

速度可能存在差异，但在任何正常使用情况下都无法察觉。像这样编写 CSS 的真正原因是特异性。也就是说，如果你有

```
#content #elem {color: black;} 
```

和

```
#elem {color: red;} 
```

该元素应为黑色，因为这是更具体的规则。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-06T01:45:37.020

老实说，你说的时间太短了，我认为这并没有什么不同。

在使用更具体的选择器方面 - 我认为这是一个很好的做法，原因有几个：

1.  它增强了代码的可读性 - 一眼就能看到更多选择器相对于 HTML 的应用位置。
2.  它减少了您的选择器在其他地方被覆盖的可能性，因为将编写一个更具体的选择器，这不太可能发生。

在使用诸如 jQuery 之类的 JavaScript 库时，您所说的*可能*会有所不同——因为它们必须自己解析整个文档，但我自己当然从未注意到任何速度差异。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-06T02:44:00.733

不是一个聪明人，但你写这个问题所花费的时间可能超过了所有访问你网站的用户所节省的时间总和（相对于#id #id2 与 #id2）。写这个答案的时间也是如此......

你现在可以投票给我了:)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-06T18:38:58.660

[Mozilla 的指导方针](https://developer.mozilla.org/en/Writing_Efficient_CSS)可能很有趣。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-09-27T08:32:59.153

1.  在效率和可读性之间总是有一些选择。当然`table tr td .class`是最易读的，但效率很低，可以简化——你有没有在任何地方看到过（假设有效标记）`tr`没有`table`或`td`没有`tr`？至少您可以评论多余的部分，例如：

    ```
    /* table tr */ td .class {
        color: #ccf;
    } 
    ```

2.  有时正如其他人提到的那样，您需要额外的特异性，例如，`#elem`除非在特定上下文中，否则您应该在任何地方都是红色的`#content`。

    ```
    #elem {
        /* usually red */
        color: red;
    }

    #content #elem {
        /* except when in specific context */
        color: black;
    } 
    ```

# math - 来自可计算正常数的伪随机数生成器

> ID：617449
> 
> 赞同：0
> 
> 时间：2009-03-06T01:37:11.860
> 
> 标签：math, random, prng

以这种方式构建 PRNG 不是很容易吗？为什么没有完成？

也就是说，据我所知，我们可以简单地拥有一个带有种子 n 的 PRNG。当你要求一个随机位时，它取可计算正常数的二进制扩展的第 n 位，并递增 n。

我的第一个想法是，也许我们没有找到可计算的正常数，但我们[找到](http://www.sciencedirect.com/science?_ob=ArticleURL&_udi=B6V1G-44NM184-1F&_user=994540&_rdoc=1&_fmt=&_orig=search&_sort=d&view=c&_acct=C000050024&_version=1&_urlVersion=0&_userid=994540&md5=374f53e97045c282254c5968eaba2f98)了. 剩下的想法是，有一个很好的理由不这样做——要么是我不熟悉的 PRNG 的某些属性，而这种方法不具备，要么在某种程度上不切实际，要么被其他方法超越。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-06T01:57:28.567

这将使预测输出变得非常简单。

例如，假设您生成整数 0x54a30b7f。如果您有 4GiB 的 pi（或随机噪声或实际的正常数），那么该特定整数可能只会出现一次（或少数），我可以以相当高的概率预测所有未来的数字。在密码学强 PRNG 的情况下，这是一个严重的问题。如果你使用一些函数而不是简单的顺序扫描，我只需要遵循这个函数，如果它很难遵循它本身就会变成一个 PRNG。

如果您不关心生成器的加密强度，那么可以使用更紧凑的方法来生成随机数。例如，[Mersenne Twister的周期要长得多，而不需要 4GiB 查找表。](http://en.wikipedia.org/wiki/Mersenne_twister)

# javascript - 引用 div 中的 div 与另一个 div 中的另一个 div 具有相同的 ID

> ID：617450
> 
> 赞同：1
> 
> 时间：2009-03-06T01:37:40.877
> 
> 标签：javascript, html, dom, getelementbyid

当嵌套的 div 与嵌套在类似命名的 div 中的 div 具有相同的 id 时，如何通过 id 引用嵌套的 div

例如

```
<div id="obj1">
    <div id="Meta">
        <meta></meta>
    </div>
</div>

<div id="obj2">
    <div id="Meta">
        <meta></meta>
    </div>
</div> 
```

我想获取 meta 的 innerHTML

```
document.getElementById('obj1').getElementById('Meta').getElementsByTagName('meta') 
```

不工作

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-03-06T01:42:13.377

仅当页面上有该项目之一时才应使用 ID，无论是 SPAN、DIV 还是其他。当您可能有重复元素时，您应该使用 CLASS。

那里的代码不起作用，因为您通过唯一 ID 引用一个元素，但页面上有多个元素。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-03-06T01:39:51.900

ID 应该是唯一的。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2010-01-21T04:53:05.903

讨厌指出明显的问题，但在您的示例中， obj1_Meta 和 obj2_Meta 是唯一的 id，因此如果您的工作代码是这种情况：

```
document.getElementById('obj1_Meta').getElementsByTagName('meta')[0].innerHTML; 
```

将按描述工作。作为一个双重检查，你有没有想过这个？

如果没有，那就糟了……

无论您的代码是“坏”还是“错误”，一个可行的选择是使用像 jQuery 这样的 JavaScript 框架。包含它后，您可以通过向其传递 CSS 选择器（甚至是语义不正确的选择器）来获取元素，如下所示：

```
$('#obj1 #obj1_Meta meta').html() 
```

$() 是 jQuery 在类固醇上说 document.getElementById() 的方式。.html() 相当于 .innerHTML

其他框架，如 PrototypeJS 和 MooTools 也提供类似的功能。

原型例如：

```
$$('#obj1 #obj1_Meta meta').innerHTML;//note the double $'s 
```

框架在浏览器兼容性、“缺少”JavaScript 方法（如 getElementsByClassName）和快速编码 AJAX 方面节省了大量时间和麻烦。无论如何，这些东西使它们成为一个好主意。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2010-01-21T05:06:24.653

ID 是唯一的，智能地使用类。

```
<div id="obj1" class="obj">
    <div id="obj1_Meta" class="obj_Meta">
        <meta></meta>
    </div>
</div>

<div id="obj2" class="obj">
    <div id="obj2_Meta" class="obj_Meta">
        <meta></meta>
    </div>
</div> 
```

*   `.obj`= 针对两个元素
*   `#obj1.obj`= 只针对第一个
*   `#obj1.obj_Meta`= 目标 obj1 内部 DIV
*   `#obj2.obj`= 只针对第二个
*   `#obj2.obj_Meta`= 目标 obj2 内部 DIV

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-03-06T02:03:42.373

您也可能会遇到此标记的问题，因为“元”标记仅在头标记内合法，而不是正文标记。据我看 Firebug 可以看出，Firefox 甚至会将这些元标记从正文中拉出并将它们扔到头部（并且，在这种情况下，将任何文本内容放入父 div 中），所以你根本不会在 DOM 中看到它们。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-03-06T03:03:06.677

对于您提供的 HTML，这应该有效：

```
document.getElementById('obj1').getElementsByTagName('div')[0].getElementsByTagName('meta'); 
```

只需忽略内部 div 上的虚假 id 并通过标签名称获取它。您还应该能够完全忽略内部 div，因为 getElementsByTagName 搜索整个子树：

```
document.getElementById('obj1').getElementsByTagName('meta'); 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-03-06T02:25:10.247

由于 id 属性是唯一的文档范围标识符，您可能应该命名您的 id。

```
<div id="obj1">
    <div id="obj1_Meta">
        <meta></meta>
    </div>
</div>

<div id="obj2">
    <div id="obj2_Meta">
        <meta></meta>
    </div>
</div>

document.getElementById('obj1_Meta').getElementsByTagName('meta') 
```

# c# - 用于迭代关联值集的模式是什么？

> ID：617452
> 
> 赞同：5
> 
> 时间：2009-03-06T01:37:48.303
> 
> 标签：c#, linq, iteration

这是很常见的 - 特别是当你试图让你的代码变得更加数据驱动时 - 需要迭代关联的集合。例如，我刚写完一段代码，如下所示：

```
string[] entTypes = {"DOC", "CON", "BAL"};
string[] dateFields = {"DocDate", "ConUserDate", "BalDate"};
Debug.Assert(entTypes.Length == dateFields.Length);

for (int i=0; i<entTypes.Length; i++)
{
    string entType = entTypes[i];
    string dateField = dateFields[i];
    // do stuff with the associated entType and dateField
} 
```

在 Python 中，我会写如下内容：

```
items = [("DOC", "DocDate"), ("CON", "ConUserDate"), ("BAL", "BalDate")]
for (entType, dateField) in items:
   # do stuff with the associated entType and dateField 
```

我不需要声明并行数组，不需要断言我的数组长度相同，不需要使用索引来取出项目。

我觉得在 C# 中使用 LINQ 可以做到这一点，但我不知道它可能是什么。是否有一些简单的方法可以遍历多个关联的集合？

**编辑：**

我认为这会更好一些 - 至少在我可以在声明时手动压缩集合并且所有集合都包含相同类型的对象的情况下：

```
List<string[]> items = new List<string[]>
{
    new [] {"DOC", "DocDate"},
    new [] {"CON", "ConUserDate"},
    new [] {"SCH", "SchDate"}
};
foreach (string[] item in items)
{
    Debug.Assert(item.Length == 2);
    string entType = item[0];
    string dateField = item[1];
    // do stuff with the associated entType and dateField
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-06T01:46:24.240

在 .NET 4.0 中，他们向 IEnumerable 添加了“Zip”扩展方法，因此您的代码可能类似于：

```
foreach (var item in entTypes.Zip(dateFields, 
    (entType, dateField) => new { entType, dateField }))
{
    // do stuff with item.entType and item.dateField
} 
```

目前，我认为最简单的方法是将其保留为 for 循环。有一些技巧可以引用“其他”数组（例如，通过使用提供索引的 Select() 的重载），但它们都不像简单的迭代器那样干净。

[这是一篇关于 Zip 的博客文章以及自己实现它的方法](http://community.bartdesmet.net/blogs/bart/archive/2008/11/03/c-4-0-feature-focus-part-3-intermezzo-linq-s-new-zip-operator.aspx)。同时应该让你去。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-06T01:46:37.610

创建一个结构？

```
struct Item
{
    string entityType;
    string dateField;
} 
```

与您的 Pythonic 解决方案几乎相同，除了类型安全。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-15T21:42:07.407

这确实是其他主题的变体，但这也可以解决问题......

```
var items = new[]
          {
              new { entType = "DOC", dataField = "DocDate" },
              new { entType = "CON", dataField = "ConUserData" },
              new { entType = "BAL", dataField = "BalDate" }
          };

foreach (var item in items)
{
    // do stuff with your items
    Console.WriteLine("entType: {0}, dataField {1}", item.entType, item.dataField);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-06T06:35:32.907

如果您只想声明内联列表，您可以一步完成：

```
var entities = new Dictionary<string, string>() {
    { "DOC", "DocDate" },
    { "CON", "ConUserDate" },
    { "BAL", "BalDate" },
};
foreach (var kvp in entities) {
    // do stuff with kvp.Key and kvp.Value
} 
```

如果它们来自其他东西，我们有一堆扩展方法可以从各种数据结构构建字典。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-06T01:48:18.900

您可以使用该对和一个通用列表。

```
List<Pair> list = new List<Pair>();

list.Add(new Pair("DOC", "DocDate"));
list.Add(new Pair("CON", "ConUserDate"));
list.Add(new Pair("BAL", "BalDate"));

foreach (var item in list)
{
    string entType = item.First as string;
    string dateField = item.Second as string;

    // DO STUFF
} 
```

Pair 是 Web.UI 的一部分，但您可以轻松创建自己的自定义类或结构。

# php - 基本的 if/then 与 PHP

> ID：617456
> 
> 赞同：1
> 
> 时间：2009-03-06T01:39:17.567
> 
> 标签：php

好的，所以我设置了这个东西，以便我可以打印出人们来自的页面，然后在某些页面上放置虚拟标签。一些页面已经注释掉了“linkto”标签，它们之间有文本。

我的问题是我的一些页面没有“链接到”文本。当我从那里链接到此页面时，我希望它获取“title”和“/title”之间的所有内容。我怎样才能改变eregi，如果它变成空的，它应该抓住标题？

这是我到目前为止所拥有的，我知道我只需要某种 if/then 但我是一个等级初学者。预先感谢您的任何帮助：

```
<?php
$filesource = $_SERVER['HTTP_REFERER'];
$a = fopen($filesource,"r"); //fopen("html_file.html","r");
$string = fread($a,1024);
?>
<?php
if (eregi("<linkto>(.*)</linkto>", $string, $out)) {
     $outdata = $out[1];
}
//echo $outdata;
$outdatapart = explode( " " , $outdata);
echo $part[0];
?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-06T01:52:02.683

给你：如果 eregi() 匹配失败，$outdata 分配将永远不会发生，因为 if 块将不会被执行。如果匹配，但标签之间没有任何内容，则 $outdata 将被分配一个空字符串。在这两种情况下，!$outdata 都会为真，因此我们可以回退到标题标签上的第二个匹配项。

```
if(eregi("<linkto>(.*?)</linkto>", $string, $link_match)) {
    $outdata = $link_match[1];
}
if(!$outdata && eregi("<title>(.*?)</title>", $string, $title_match)) {
    $outdata = $title_match[1];
} 
```

我还将匹配中的 (.*) 更改为 (.*?)。这意味着，不要贪婪。在 (.*) 形式中，如果您将 $string 设置为

```
<title>Page Title</title>  ... 
  ... <iframe><title>A second title tag!</title></iframe> 
```

正则表达式将匹配

```
Page Title</title> ... ... <iframe><title>A second title tag! 
```

因为它试图尽可能地匹配，只要文本在任何和任何其他之间！在 (.*?) 形式中，匹配符合您的预期 - 它匹配

```
Page Title 
```

并尽快停止。

...

顺便说一句，这个东西是一个有趣的方案，但你为什么需要它呢？页面可以链接到其他页面并通过查询字符串传递参数：

```
<a href="somescript.php?prevpage=Foo">...</a> 
```

然后 somescript.php 可以通过 $_GET['prevpage'] 超全局变量访问 prevpage 参数。

那能解决你的问题吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-10T03:45:47.120

自 PHP 5.3.0 起，POSIX 正则表达式扩展（ereg 等）将被弃用，并且可能在 PHP 6 中完全消失，您最好使用 PCRE 函数（preg_match 和朋友）。

PCRE 函数也更快，二进制安全，并支持更多特性，如非贪婪匹配等。

只是一个指针。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-06T01:53:08.797

你需要如果，否则。

```
if(eregi(...))
{
    .
    .
    .
}
else
{
    just grab title;
} 
```

也许您应该快速进行谷歌搜索以找到这个非常简单的答案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-06T01:59:56.283

`if`只需在将匹配分配给之前添加另一个测试`$outdata`：

```
if (eregi("<linkto>(.*)</linkto>", $string, $out)) {
    if ($out[1] != "") {
        $outdata = $out[1];
    } else {
        // Look in the title.
    }
} 
```

# sharepoint - 如何与 Sharepoint 交谈：如果我只有全名

> ID：617463
> 
> 赞同：1
> 
> 时间：2009-03-06T01:42:52.970
> 
> 标签：sharepoint, sharepoint-2007

似乎所有通过其 Web 服务与 Sharepoint 对话的努力都需要一个域\用户名。例如：

```
UserProfileService.GetUserProfileByName(string accountName) 
```

accountName 应该是域\用户名。

如果我只有全名 (FirstName LastName)，是否可以与 SharePoint 通信？有没有办法将全名转换为域\用户名？域\用户名是唯一的方法吗？

先感谢您。:)

* * *

谢谢你的回答。:)

代码如下所示：

```
using System.DirectoryServices;

const string ADPATH = "LDAP://myLDAPserver,validUserforAD";
const string USERNAME = "myDomain\\myUserName";
const string PASSWORD = "myPassword";
const string DOMAIN = "myDomain\\";

public static DirectoryEntry GetDirectoryObject()
{
        DirectoryEntry directoryObject = new DirectoryEntry(ADPATH, USERNAME, PASSWORD, AuthenticationTypes.Secure);
        return directoryObject;
}

public string GetUserNameByCompleteName(string completeName)
{
            DirectoryEntry adObject = GetDirectoryObject();

            //filter based on complete name
            DirectorySearcher searcher = new DirectorySearcher(adObject);
            searcher.Filter = "displayname=" + completeName;
            SearchResult result = searcher.FindOne();

            DirectoryEntry userInfo = result.GetDirectoryEntry();

            //getting user name
            string userName = (string)userInfo.Properties["samaccountname"].Value ?? string.Empty;
            userInfo.Close();
            adObject.Close();

            return DOMAIN + userName;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-06T01:48:36.293

我想您可以尝试在活动目录中查询用户的名字和姓氏，以确定他们的帐户名。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-06T03:36:17.753

尝试使用[`UserGroup.GetAllUserCollectionsFromWeb()`](http://msdn.microsoft.com/en-us/library/ms772661.aspx)，可以迭代结果以获取给定显示名称的登录名。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-06T19:33:31.507

您可以使用一个`PeopleEditor`控件，如果您输入姓氏、名字的组合，它将抓取用户，或者您可以浏览目录。

```
people = new PeopleEditor();
people.MultiSelect = false;

this.Controls.Add(people);

...

int userID = Int32.Parse((((PickerEntity)people.ResolvedEntities[0]).EntityData["SPUserID"]).ToString());

SPUser user = SPContext.Current.Site.RootWeb.SiteUsers.GetByID(userID); 
```

这有点麻烦和荒谬，但它确实有效。如果您需要以编程方式获取它，您可以按照 Jason 上面所说的进行操作，并`SPUserCollection`通过 and 循环，寻找`SPUser`具有适当显示名称的 。

# .net - VB.NET 接口/后期绑定排序

> ID：617468
> 
> 赞同：2
> 
> 时间：2009-03-06T01:46:03.460
> 
> 标签：.net, vb.net, dll, versioning, version

让我给出一个场景，然后看看是否有人有解决方案/解决方法。

我有一个只包含类的库（DLL）。在另一个库中，我有第一个库中的类实现的接口。客户端将始终仅引用包含接口的库的一个版本（始终是最新版本） - 并且只会对这些接口进行添加（更多接口/方法）。此外，该接口库只有一个版本——因此客户端不需要更新引用（接口库将通过反射加载——因此通常的探测规则不适用，我们只能加载客户端具体的内容要求）。实现接口的库将具有不同客户端同时引用的多个版本。

当客户端程序集引用旧版本的实现库时会出现此问题。它从实现库中的类类型创建一个对象 - 然后将其传递给另一个客户端程序集。该客户端程序集使用最新（也是唯一）版本的接口库，并尝试使用适当的接口类型转换传递给它的对象。此转换失败，出现异常“System.TypeLoadException：来自程序集 Z 的类型 Y 中的方法 X 没有实现”。我预计会出现此异常，因为在新版本的接口（相同的版本号 - 旧库被破坏）中，定义了方法 X，但即使传递的旧版本对象包含表示它实现相应接口的元数据，

所以，我的问题是这样的；有没有办法让客户端使用该接口，但仅在调用未在引用对象上实现的方法时才导致异常（而不是在将引用对象转换为较新的接口类型时生成异常）？

顺便说一句 - 后期绑定不是一个选项，因为我们想要智能感知/编译时类型检查......另外，我知道如何使用函数指针和包装类来做到这一点 - 我只是希望有一个更好的解决方案，更多使用常规 .NET 类型进行调整。

谢谢 - 非常感谢任何帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-06T03:11:30.823

您可以在包含接口的库中使用抽象（MustInherit）类而不是接口，并将方法和属性设置为可覆盖。这样，即使这些方法只是抛出了一个未实现的异常，接口库中的每个方法也总会有一个实现。通过使方法为 Overridable 而不是 MustOverride 应该避免 TypeLoadException。

# php - 为什么 CakePHP 身份验证组件不对我的密码进行哈希处理？

> ID：617471
> 
> 赞同：1
> 
> 时间：2009-03-06T01:47:28.763
> 
> 标签：php, authentication, cakephp, cakephp-1.2

我正在使用带有 Auth 和 ACL 组件的[CakePHP](http://en.wikipedia.org/wiki/CakePHP) 1.2。

在我的用户注册操作中，密码未经过哈希处理。具体来说，这个表达式：

```
if ($this->data['User']['password'] !=
    $this->Auth->password($this->data['User']['confirm_password'])) 
```

即使我为`password`和提交相同的值，这也评估为真`confirm_password`。我知道密码是未散列的，因为当我删除对 的调用时`Auth->password`，表达式的计算结果为 false。

我希望 Auth 模块自动散列密码。我究竟做错了什么？

这是我的看法：

```
<?php
    echo $form->create('User', array('action' => 'register'));

    echo $form->input('email',
                      array('after' => $form->error(
                        'email_unique', 'This email is already registered.')));
    echo $form->input('password');
    echo $form->input('confirm_password', array('type' => 'password'));
    echo $form->end('Register');
?> 
```

这是用户控制器的注册操作：

```
function register(){
    if ($this->data) {
        if ($this->data['User']['password'] !=
            $this->Auth->password($this->data['User']['confirm_password'])) {

            $this->Session->setFlash(__('Password and Confirm Password must match.', true));
            $this->data['User']['password'] = '';
            $this->data['User']['confirm_password'] = '';
        }
        else{
            $this->User->create();
            if ($this->User->save($this->data)){
                $this->redirect(array('action' => 'index'), null, true);
            }
            else {
                $this->data['User']['password'] = '';
                $this->data['User']['confirm_password'] = '';
                $this->Session->setFlash(__('Some problem saving your information.', true));
            }
        }
    }
} 
```

这是我`appController`包含`Auth`和`Acl`模块的地方：

```
class AppController extends Controller {
    var $components = array('Acl', 'Auth');

    function beforeFilter(){
        if (isset($this->Auth)) {
            $this->Auth->allow('display');
            $this->Auth->fields =
              array(
                'username' => 'email',
                'password' => 'password');
            $this->Auth->authorize = 'actions';
        }
    }
} 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-06T23:05:22.183

除非用户名包含提交的值，否则 CakePHP 不会散列密码。我正在用电子邮件替换用户名字段。但是，我通过设置 Auth->fields 数组重新映射了这些字段。但是，我是在 appController 而不是 userController 中这样做的。所以移动这条线：

```
$this->Auth->fields = array('username' => 'email', 'password' => 'password'); 
```

从 appController 到 userController 解决了它。
现在问题变成了“为什么我不能重置 appController 中的 Auth-> 字段？”

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-23T15:57:20.010

你可能会`AppController::beforeFilter()`用你的`UsersController::beforeFilter()`.

要“修复”它，只需放在`parent::beforeFilter()`函数的开头即可。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-06T02:29:53.717

您应该在保存到数据库之前对密码进行哈希处理。将此功能放入您的用户模型中：

```
function beforeSave() {
  if(isset($this->data[$this->alias]['password']))
    $this->data[$this->alias]['password'] = Security::hash($this->data[$this->alias]['password'], null, true);
  return true;
} 
```

并且不要忘记将其放入`beforeFilter()`您的用户控制器中：

```
if(in_array($this->action, array('register'))) {
  $this->Auth->fields = array('username' => 'email', 'password' => 'wrongfield');
} 
```

这意味着在注册过程中不会对密码进行哈希处理（以防注册表单验证失败）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-06T02:02:55.293

我想你在找

```
hashPasswords ($data) 
```

看看这些页面。他们应该为您指明正确的方向。您还可以尝试在核心配置文件中更改调试级别。将其从 0（生产）更改为 3 可以让您看到 sql 输出。可能会有所帮助。

[AuthComponent-方法](http://book.cakephp.org/view/247/AuthComponent-Methods)

[Cakephp 疑难解答](http://book.cakephp.org/view/565/Troubleshooting-Auth-Problems)

对不起，我无能为力，只能为您指明正确的方向。我是 cakephp 的新手。

# .net - .Net Profiling API 方法

> ID：617474
> 
> 赞同：5
> 
> 时间：2009-03-06T01:50:25.963
> 
> 标签：.net, profiling

我有一种感觉，我可能已经知道这个问题的答案，但我还是会问。

有没有比 COM/Managed C++ 路由*更好的使用 .Net Profiling API 的方法？*

我不愿意遵循建议的 COM 方法是这样的：

*   努力，开始需要很多的跑腿
*   不喜欢连接 C++ dll 所涉及的魔法，不容易与项目重新分配
*   感觉很难进行单元测试
*   不想在 C++ 中行为。我可以创建一个互操作层，但这需要更多的工作
*   很难调试。根据我收集到的信息，您无法将调试器附加到实际的 C++ 层，因此您又回到了日志文件等

我遇到了一个名为[NProf](http://sourceforge.net/projects/nprof)的项目，它试图用托管层包装 API。不幸的是，它自 2003 年以来一直没有更新。

有没有人有任何可能有帮助的线索？这一切只是感觉有点恶心。

**说明：**

*   这描述了我所指的 API：[Profiling API](http://www.blong.com/Conferences/DCon2003/Internals/Profiling.htm)
*   我正在使用 Visual Studio 2008 和框架的 v3.5

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-06T07:23:20.063

你可以看看 Part-Cover。它是一个代码覆盖工具 (GPL)，但它的工作方式与 NCover 类似，这意味着它使用分析 API 来完成它的工作。不确定代码的好坏，以及它对您有多大帮助（GPL 也可能是一个问题），但您可能想看看它。它已于去年年底更新，然后就沉寂了，所以我不确定该项目是否仍然活跃。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-06T02:04:54.040

分析是一个非常低级和性能敏感的领域，因此它被公开为一个低级 API。我认为这只是这种功能的领域。

您能否详细说明调试问题...您应该能够将非托管调试器附加到您正在分析的托管可执行文件并使用它来调试您的分析器 dll。

# linq - 如何在每列上使用 Distinct 将这个 LINQ 查询简化为单个语句

> ID：617481
> 
> 赞同：0
> 
> 时间：2009-03-06T01:54:51.850
> 
> 标签：linq

这是我的 LINQ 查询，它获取每个选定列的唯一值并将它们作为列表存储在字典中。

```
var serialTable = serialNoAdapter.GetData();
var distinctValue = (from row in serialTable
                    select new
                    {
                        row.CodePractice,
                       row.LockType,
                       row.Software
                    }).Distinct().ToList();
var softwareValue = distinctValue.Select(p => p.Software).Distinct().ToList();
var codeValue = distinctValue.Select(p => p.CodePractice).Distinct().ToList();
var lockValue = distinctValue.Select(p => p.LockType).Distinct().ToList();

return new Dictionary<string, List<string>>()
       {
           {"software", softwareValue},
           {"codepractice", codeValue},
           {"locktype", lockValue}
       }; 
```

唯一的问题是它被分解成几个语句。我的问题是是否可以简化它并将其压缩为单个语句？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-06T04:29:22.850

我相信您可以通过省略中间步骤来大大简化它。

```
var softwareValue = serialTable.Select(p => p.Software).Distinct().ToList();
var codeValue = serialTable.Select(p => p.CodePractice).Distinct().ToList();
var lockValue = serialTable.Select(p => p.LockType).Distinct().ToList();

return new Dictionary<string, List<string>>()
       {
           {"software", softwareValue},
           {"codepractice", codeValue},
           {"locktype", lockValue}
       }; 
```

也许其他人可以进一步改进。

# delphi - Delphi中存储的“主窗体”名称在哪里？

> ID：617484
> 
> 赞同：3
> 
> 时间：2009-03-06T01:59:54.927
> 
> 标签：delphi

哪个物理文件存储了 Delphi 应用程序的主窗体名称？

例如`MyApplication`，有一个`MyForm`通过项目选项设置为“主表单”的表单。信息“Main Form = MyForm”实际存储在哪里？

在 Delphi IDE 中，应用程序“主窗体”通过菜单指定：`Project | Options | Forms`。

显而易见的文件是 .bdsproj 或 .dpr ，但其中任何一个似乎都没有任何内容表明哪种形式是“主要”形式。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-03-06T02:01:08.747

它在项目 (.DPR) 文件中。第一次以表单为参数调用 Application.CreateForm() 来标识应用程序的主表单。

请注意，TDataModule 不满足上述要求；这实际上很有用，因为您可以在主窗体之前自动创建一个数据模块，然后在主窗体的构造函数中访问该数据模块。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-06T10:36:55.340

只是为了补充肯怀特的答案。

如果您查看 CreateForm 的源代码：

```
procedure TApplication.CreateForm(InstanceClass: TComponentClass; var Reference);
var
  Instance: TComponent;
begin
  Instance := TComponent(InstanceClass.NewInstance);
  TComponent(Reference) := Instance;
  try
    Instance.Create(Self);
  except
    TComponent(Reference) := nil;
    raise;
  end;
  if (FMainForm = nil) and (Instance is TForm) then
  begin
    TForm(Instance).HandleNeeded;
    FMainForm := TForm(Instance);
  end;
end; 
```

您会看到该函数（尽管它的名称）可用于创建其他组件。但只有成功创建的第一个 TForm 组件才能成为主窗体。

然后是对全局变量的咆哮。

是的，全局变量通常是错误的，但是对于应用程序对象和主窗体对象，您可以例外。虽然您可以省略主窗体的全局，但您需要自己编辑 dpr 文件：

改变：

```
begin
  Application.Initialize;
  Application.CreateForm(TMyMainForm, MyMainFormGlobal);
  Application.Run
end. 
```

到：

```
procedure CreateMain;
var
  mainform : TMyMainForm;
begin
  Application.CreateForm(TMyMainForm, mainform);
end;

begin
  Application.Initialize;
  CreateMain;
  Application.Run
end. 
```

你失去了所有的全局形式。

# mysql - 我可以在 INSERT 语句中使用子查询吗？

> ID：617493
> 
> 赞同：10
> 
> 时间：2009-03-06T02:02:53.967
> 
> 标签：mysql, subquery

我需要在表中插入一行，其中一个字段值是从另一个表中计算出来的。与其进行两次查询并冒着竞争条件的风险，我认为最好在一个语句中完成所有操作。

```
INSERT INTO `myTable` (`someData`, `averageAtThisTime`)
VALUES (
    "some stuff",
    SELECT AVG(`myField`) FROM `myOtherTable`
) 
```

...但这不起作用。有没有一种方法可以在一个声明中实现这一目标？如果没有，你的建议是什么？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-03-06T02:05:55.677

```
INSERT INTO `myTable` (`someData`, `averageAtThisTime`)
select "some stuff", AVG(`myField`) 
FROM `myOtherTable` 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-01-23T16:10:20.450

您的子查询应该用括号括起来。此代码应该可以工作：

```
INSERT INTO `myTable` (`someData`, `averageAtThisTime`)
VALUES (
"some stuff",
(SELECT AVG(`myField`) FROM `myOtherTable`)
); 
```

# .htaccess - 如何使用 .htaccess 重定向我的网页，以便将旧链接重定向到新链接？

> ID：617509
> 
> 赞同：3
> 
> 时间：2009-03-06T02:07:50.617
> 
> 标签：.htaccess, mod-rewrite, redirect

我有旧格式的链接

```
 www.mydomain.com/dir/this_my_page.html 
```

我的新脚本需要转发到

```
 www.mydomain.com/newdir/this+my+page.htm 
```

我要在我的 .htaccess 文件中编辑什么以便使这成为可能？任何人都可以帮助我使用htaccess的**mod_rewrite功能吗？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-06T02:11:31.777

我建议使用 Front 控制器。这意味着您使用 htaccess 文件将所有请求重写到单个文件 (index.php)，然后使用该文件中的代码分派到相应的页面。您可以从旧 URL 重定向到新 URL，如果它是新 URL，那么您将分派到相应的页面控制器。

这比为您可能拥有的每种类型的页面编写巨大的重写规则要容易得多。通过这种方式，所有工作都以您的网站已经运行的相同语言完成，因此您不必学习和维护一个可怕的巨大 .htaccess 文件，无论如何处理这往往是一场噩梦！

下面是一个将所有非静态请求重定向到 index.php 的 .htaccess 文件示例：

```
RewriteEngine on
RewriteRule !\.(js|ico|gif|jpg|png|css)$ index.php 
```

然后在 index.php 中，您需要执行解释请求并弄清楚如何处理它的所有逻辑。我个人喜欢使用 Zend Framework MVC： http: [//framework.zend.com/manual/en/zend.controller.html](http://framework.zend.com/manual/en/zend.controller.html)

但是，如果您已经将其转换为不同的格式，则可能需要做很多工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-06T18:40:12.323

If you're just changing parts of the URL, e.g. directories, you can use

```
RedirectMatch ^/oldPath/(.*) http://www.example.com/newPath/$1 
```

(might work with relative urls, not tested...)

If the document names also change you either have to figure out an algorithm to translate or place one redirection for each url you want to redirect. Depending on the number of documents you could do the non-magical and completely uncool

```
RedirectMatch ^/dir/first_document.html /newdir/first+document.html
RedirectMatch ^/dir/second_document.html /newdir/second+document.html
RedirectMatch ^/dir/third_document.html /newdir/third+document.html 
```

Some Regexp wizard probably can add regexps for all numbers of underscores to be translated to plusses, but *I*'ll leave that open ;)

If that's too much, you don't actually need to rewrite, you could also opt for a 404 error document, e.g.

```
ErrorDocument 404 /redirect.php (or .jsp, .asp, .whatever) 
```

Then use that script to lookup the original request url and use your favourite scripting/programming language to translate old urls to new urls (examine the request headers to figure out what the original URL is named. In PHP place in the error document (don't forget to remove it in production version) and find the original URL header in the request. Then send a [301 Moved Permanently](http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.3.2) Response with the new URL.

# ruby-on-rails - 我的 [has_many :through] 关联“路径”可以有多深（多少张桌子）？

> ID：617511
> 
> 赞同：1
> 
> 时间：2009-03-06T02:10:07.740
> 
> 标签：ruby-on-rails, has-many

Agile Rails 书中给出了以下数据库设计示例，用于教授 has_many ：通过代码...

[文章]----<[阅读]>----[用户]

这一切一开始都很容易理解。但是，我有可能使用以下数据库设计的情况：

[类型]-----<[文章]-----<[阅读]>-----[用户]

现在这是我的问题：

我可以使用 has_many :through 关联，这样我就可以编写如下代码：

艺术头脑 _users = art.users

如果可以做到这一点，那么如何设置 has_many 关联？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-06T02:38:34.210

这在 Rails 中是不可能开箱即用的。尝试寻找 nested_has_many_through 插件或类似的插件（因为我不确定它的代码是否已针对最新版本的 Rails 进行了更新）。

# c++ - 如何确定一个对象是否应该在堆栈上？

> ID：617513
> 
> 赞同：7
> 
> 时间：2009-03-06T02:11:45.303
> 
> 标签：c++, stack, heap-memory, stack-size

我一直在寻找在 C++ 中在堆栈或堆上分配对象的经验法则。我在这里找到了很多关于 SO 的讨论。很多人说，这关乎一个物体的生命周期。如果您需要比函数范围更长的生命周期，请将其放入堆中。这很有意义。

但是让我感到困惑的是，许多人说，如果对象很小，就将它们分配给堆栈。如果对象很大，则将其放入堆中。但是他们都没有说如何识别物体是否大？

我有以下问题，

1.  如何识别物体是否大？
2.  堆栈的最大大小是多少？每个操作系统会有不同的堆栈大小？
3.  我有一个包装类`vector<string>`。它将有大约 100 个项目。如果我将此类分配给堆栈，它会导致堆栈溢出吗？我试过这个，但效果很好。不确定我做错了什么。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-06T02:18:38.500

首先，向量（以及所有 STL 容器类）总是从堆中分配，所以您不必担心这一点。对于任何大小可变的容器，几乎不可能使用堆栈。

如果您考虑堆栈分配的工作原理（在编译时，基本上是通过为每个对象递增一个指针），那么应该清楚向量内存来自堆。

```
std::vector<int> myInts;
std::string myString;
SomeOther Class;

// this memory must come from the heap, there's no way it
// can now be allocated on the stack since there are other
// objects and these parameters could be variable
myString = "Some String";
myInts.reserve(256); 
```

除非您在递归函数中，否则您可以将几千字节的数据放在堆栈上而不必担心。堆栈大小由程序（而不是操作系统）控制，默认值范围为 32kb - 1mb。大多数桌面软件都在 1mb 范围内。

单个对象几乎从来都不是问题。一般来说，它们要么对堆栈足够小，要么从堆内部分配。

如果对象是函数的本地对象，则将它们放入堆栈。如果不把它们放在堆上。

将堆用于为加载/排序/操作数据分配的大缓冲区。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-06T02:16:34.527

根据[MSDN](http://msdn.microsoft.com/en-us/library/tdkhxaks(VS.80).aspx)堆栈大小默认为 1mb。（这显然是给 Msdev 的）。

从文章中可以看出，您可以在编译时使用 /F 标志修改堆栈大小。

我认为您关于堆栈与堆使用的第一个指南非常准确，条件是如果您的临时范围变量大于 mb，请将其粘贴在堆上（并且可能会问为什么您要在短时间内分配这么多内存首先时间）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-06T02:21:18.917

您可以在堆栈上分配大对象的唯一方法是在某些时候使用旧式数组。例如：

```
void f() {
   char a[1000000];    // big object on the stack
}

struct A {
   char c[1000000];
};

void g() {
   A a;      // another big object on the stack
} 
```

如果你不使用数组（你不应该），那么大多数东西都会在堆上为你分配：

```
void h() {
   std::string s( 100000 );
} 
```

上面在堆栈上为指针、大小信息等分配了几个字节，然后在堆上分配实际存储。

所以别担心了！你可能做对了！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-06T02:17:31.357

> 如何识别物体是否大？

取决于您的编译器/平台组合。没有一个真正的限制。编译器通常允许您对此进行调整。

> 堆栈的最大大小是多少？每个操作系统会有不同的堆栈大小？

主要取决于上述。唯一的事情是您对调音的控制较少。

> 我有一个包装矢量的包装类。它将有大约 100 个项目。如果我将此类分配给堆栈，它会导致堆栈溢出吗？我试过这个，但效果很好。不确定我做错了什么。

只要此包装器和该块中其他对象的总内存需求不超过您的堆栈帧大小，就可以工作。这又取决于平均字符串 sie。

一个好主意是单步调试器并查看堆栈地址——这将在某种程度上为您提供宽度的开始。和文档。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-06T02:20:53.627

还有一点我要提到的是，因为`vector<>`必须能够调整自身的大小，所以如果它变得足够大（见下文），它*必须*使用堆来存储其包含的对象，即使它`vector<>`本身被声明为堆栈变量。

**[编辑]**正如 Motti 在评论中指出的那样，有可能`vector<>`在其堆栈分配的对象中保留少量空间作为小向量的优化。在这种情况下，使用足够小以适合此空间的向量将不需要任何堆分配。（这个预先分配的空间必须非常小，以避免在使用较小的向量时浪费空间。）无论如何，如果向量变得足够大，它将需要在堆上（重新）分配。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-06T06:25:41.310

**1.如何识别物体是否大？**

使用“大小”

```
class c {
  std::vector<std::string> s;
}; 
```

int 大小 = sizeof(c);

在我的机器上，“大小”是 16 个字节。

**2\. 堆栈的最大大小是多少？每个操作系统会有不同的堆栈大小？**

你不能说，但它绝对不是分配大量数据的好地方。

**3\. 我有一个包装矢量的包装类。它将有大约 100 个项目。如果我将此类分配给堆栈，它会导致堆栈溢出吗？我试过这个，但效果很好。不确定我做错了什么。**

不，std::vector 分配堆中的 100 个项目。

# eclipse - 是否有任何新的 Eclipse 发行版？

> ID：617514
> 
> 赞同：1
> 
> 时间：2009-03-06T02:13:12.477
> 
> 标签：eclipse, groovy

我已经使用 EasyEclispe 很长时间了，我注意到他们并没有真正跟上主要的 Eclipse 发行版。所以我想知道是否有人知道一个类似于 EasyEclipse 的发行版，其中包含 Java/Groovy 开发不同领域的人们可能需要的常见东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-06T03:11:46.860

转到[eclipse 下载站点](http://www.eclipse.org/downloads/)并单击成员发行版。有许多不同的插件分组可以满足不同的人的需求。其中之一是 Yaxos。Yaxos[点播](http://yoxos.com/ondemand/)站点允许您在下载之前配置您的插件。他们那里有时髦的猴子。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-06T02:36:00.330

我更喜欢只安装最新的“真正的”Eclipse (Ganymede) 并使用它的内置工具来安装和更新我使用的所有不同的插件和功能。

这样一来，它就永远不会落后于主流版本，而且我不必向那些真正只是重新包装我可以免费获得的东西的公司支付任何费用。

这个成本尤其重要，因为 MyEclipse 是按用户授权的，它很快就会变得昂贵。我什至不确定人们为什么会选择使用它。它似乎在基线 Eclipse 上提供的唯一东西是教程和支持，其中在互联网上有大量的内容，而无需花钱。

至于 EasyEclipse，至少它是免费的，并且它提供了比 Eclipse 本身更多的预打包 Eclipse 变体，但是通过查看[Epic](http://www.eclipseplugincentral.com/)从 Eclipse 中获取所需的一切实际上并不难。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-06T02:23:04.637

如果您不在乎它是免费的还是商业的，我已经使用[MyEclipse](http://www.myeclipseide.com/)很长时间了。我觉得价格合理，功能设置不错。我认为这是 Eclipse 以及许多插件的更大商业发行版之一。

[您可以在此处](http://www.myeclipseide.com/module-htmlpages-display-pid-1.html)查看宣传的 MyEclipse 功能集。请注意，价格要贵得多的“Blue”版本专门用于 WebSphere 开发。我没有用过这个，也不能评论它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-10-22T07:39:32.080

您可以从springsource（groovy inside）查看**[http://www.springsource.com/products/sts](http://www.springsource.com/products/sts)**

# ruby-on-rails - Ruby on Rails 多态关联

> ID：617535
> 
> 赞同：5
> 
> 时间：2009-03-06T02:34:32.720
> 
> 标签：ruby-on-rails

这是我想要实现的目标：我有一个用户表，每个用户可以是十几种类型中的任何一种：演员、舞者、导演……这是在注册后确定的。每种类型的用户都可以有任意数量的配置文件。例如。演员可以有任意数量的actor_profiles，舞者可以有任意数量的dancer_profiles，...

问题是如何将配置文件与用户链接。一个明显的解决方案是为每个配置文件类型创建一个附加表，以便我可以在 User 中使用多态的 belongs_to，然后在每个配置文件中使用简单的 belongs_to，但这似乎不是最佳的。一个可以说是更好的方法是告诉 Rails 用户它的类型为 actor，这样 user.profiles 就可以自然地工作，没有任何混乱。rails 是否支持这种行为，或者有什么比前一种方法更好的方法吗？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-09T22:02:20.283

pjb 的答案使用单表继承。为此，您需要在您的用户和 Profiles* 表中添加一个名为 type 的列，以便 Rails 可以保存这是什么类型的用户（因为演员、舞者等只是用户的子类）。

这意味着它们都将保存在用户/配置文件表中，但是当您实例化它们时，ActiveRecord 会将它们实例化为正确的类型。有了这个你就可以打电话

```
User.find 
```

但也做类似的事情

```
Actor.find, Actor.all, etc 
```

并将其范围仅限于演员

谷歌`rails single table inheritance`了解更多细节和例子。

*   当然，您需要像声明 User 子类一样声明 Profile 子类

class Profile < ActiveRecord::Base belongs_to :user end

类 ActorProfile < 配置文件结束

class DancerProfile < Profile end

ETC

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-06T02:42:33.623

定义子类中的关系：

```
class User < ActiveRecord::Base
end

class Actor < User
  has_many :profiles, :class_name => "ActorProfile"
end

class Dancer < User
  has_many :profiles, :class_name => "DancerProfile"
end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T13:36:02.823

您需要确保您的用户表有一个名为“类型”的列。Rails 将在该数据库字段中保存类的类型（用户、演员等）。

# vb.net - 在 Eng 字符串和 Unicode 字符串中查找一个单词（每个单词之间没有空格）

> ID：617553
> 
> 赞同：0
> 
> 时间：2009-03-06T02:44:28.000
> 
> 标签：vb.net

（VB.NET，.NET 3.5）

我正在尝试编写一个函数来以这种格式在字符串中查找一个单词：“ThisissometextthatIneedtofindandthisisthetext。这是另一个文本。”

它读作“这是我需要找到的一些文本，这是文本。这是另一个文本。” 但是每个单词之间没有空格。我想得到单词“text”或该字符串中的任何单词。你能用代码示例帮我实现这个功能吗？

而且我认为这个方法可以用一个Unicode字符串来实现，因为在一个Unicode句子中它包含一个或几个，有时每个单词之间的空格为零。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-06T02:50:21.887

请参阅 String.IndexOf()。它完全符合您的要求。

实际上，在尝试在帮助文件中找到它之后，我重新考虑了我在评论中对您的问题的回答。有关示例和文档，请参阅[MSDN](http://msdn.microsoft.com/en-us/library/system.string.indexof.aspx)。（找到它，本来应该很简单，但并不那么简单。:-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-06T14:49:46.417

我会查找有关拼写检查器的文章。[这](http://norvig.com/spell-correct.html)是一个体面的。我希望这两个问题有非常相似的解决方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-08-05T15:41:33.373

要测试字符串或 unicode 中是否存在子字符串，您可以使用：

```
exists = InStr"ThisissometextthatIneedtofindandthisisthetext. This is another text.", "text") <> 0 
```

# c - 覆盖 C 中的函数调用

> ID：617554
> 
> 赞同：72
> 
> 时间：2009-03-06T02:44:35.410
> 
> 标签：c, function, linker, overriding

为了记录调用，我想覆盖对各种 API 的某些函数调用，但我也可能想在将数据发送到实际函数之前对其进行操作。

例如，假设我`getObjectName`在源代码中使用了数千次调用的函数。有时我想暂时覆盖此函数，因为我想更改此函数的行为以查看不同的结果。

我像这样创建一个新的源文件：

```
#include <apiheader.h>    

const char *getObjectName (object *anObject)
{
    if (anObject == NULL)
        return "(null)";
    else
        return "name should be here";
} 
```

我像往常一样编译我的所有其他源代码，但在与 API 的库链接之前，我先将它与这个函数链接起来。这很好用，除非我显然不能在我的覆盖函数中调用真正的函数。

有没有更简单的方法来“覆盖”一个函数而不会出现链接/编译错误/警告？理想情况下，我希望能够通过编译和链接一个或两个额外文件来覆盖该函数，而不是摆弄链接选项或更改我程序的实际源代码。

* * *

## 回答 #1

> 赞同：87
> 
> 时间：2009-03-06T03:24:15.427

使用 gcc，在 Linux 下，您可以`--wrap`像这样使用链接器标志：

```
gcc program.c -Wl,-wrap,getObjectName -o program 
```

并将您的功能定义为：

```
const char *__wrap_getObjectName (object *anObject)
{
    if (anObject == NULL)
        return "(null)";
    else
        return __real_getObjectName( anObject ); // call the real function
} 
```

这将确保所有调用`getObjectName()`都重新路由到您的包装函数（在链接时）。然而，在 Mac OS X 下的 gcc 中没有这个非常有用的标志。

`extern "C"`如果您使用 g++ 编译，请记住声明包装函数。

* * *

## 回答 #2

> 赞同：82
> 
> 时间：2009-03-06T02:49:22.577

如果您只想捕获/修改调用，则最简单的解决方案是将头文件 ( `intercept.h`) 与以下内容放在一起：

```
#ifdef INTERCEPT
    #define getObjectName(x) myGetObjectName(x)
#endif 
```

然后按如下方式实现函数（`intercept.c`其中*不*包括`intercept.h`）：

```
const char *myGetObjectName (object *anObject) {
    if (anObject == NULL) return "(null)";
    return getObjectName(anObject); 
```

然后确保要拦截调用的每个源文件在顶部都有以下内容：

```
#include "intercept.h" 
```

当你用“ `-DINTERCEPT`”编译时，所有文件都会调用*你的*函数而不是真正的函数，而你的函数仍然会调用真正的函数。

不带“”的编译`-DINTERCEPT`将防止发生拦截。

如果您想拦截所有调用（不仅仅是来自您的源的调用），这会有点棘手 - 这通常可以通过动态加载和解析真实函数（使用`dlload-`和`dlsym-`类型调用）来完成，但我认为在您的案子。

* * *

## 回答 #3

> 赞同：39
> 
> 时间：2009-03-06T08:29:47.580

`LD_PRELOAD`您可以使用trick-see覆盖函数`man ld.so`。你用你的函数编译共享库并启动二进制文件（你甚至不需要修改二进制文件！），比如`LD_PRELOAD=mylib.so myprog`.

在你的函数体（在共享库中）你这样写：

```
const char *getObjectName (object *anObject) {
  static char * (*func)();

  if(!func)
    func = (char *(*)()) dlsym(RTLD_NEXT, "getObjectName");
  printf("Overridden!\n");     
  return(func(anObject));    // call original function
} 
```

您可以覆盖共享库中的任何函数，甚至是 stdlib 中的函数，而无需修改/重新编译程序，因此您可以对没有源代码的程序进行操作。这不是很好吗？

* * *

## 回答 #4

> 赞同：27
> 
> 时间：2009-03-06T03:13:15.780

如果你使用 GCC，你可以让你的函数`weak`. 这些[可以被](http://www.tortall.net/projects/yasm/manual/html/objfmt-elf-directives.html#objfmt-elf-dir-weak)非弱函数覆盖：

**测试.c**：

```
#include <stdio.h>

__attribute__((weak)) void test(void) { 
    printf("not overridden!\n"); 
}

int main() {
    test();
} 
```

它有什么作用？

```
$ gcc test.c
$ ./a.out
not overridden! 
```

**测试1.c**：

```
#include <stdio.h>

void test(void) {
    printf("overridden!\n");
} 
```

它有什么作用？

```
$ gcc test1.c test.c
$ ./a.out
overridden! 
```

可悲的是，这不适用于其他编译器。但是您可以在自己的文件中包含包含可覆盖函数的弱声明，如果您使用 GCC 进行编译，则只需将 include 放入 API 实现文件中：

**弱decls.h**：

```
__attribute__((weak)) void test(void);
... other weak function declarations ... 
```

**函数.c**：

```
/* for GCC, these will become weak definitions */
#ifdef __GNUC__
#include "weakdecls.h"
#endif

void test(void) { 
    ...
}

... other functions ... 
```

这样做的缺点是，如果不对api 文件做一些事情（需要这三行和weakdecls），它就不能*完全工作。*但是，一旦您进行了更改，就可以通过在一个文件中编写全局定义并将其链接到其中来轻松覆盖函数。

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2009-03-23T13:23:53.950

> 通常希望通过包装或替换函数来修改现有代码库的行为。当编辑这些函数的源代码是一个可行的选择时，这可能是一个直接的过程。当无法编辑函数的源代码时（例如，如果函数由系统 C 库提供），则需要替代技术。在这里，我们介绍了适用于 UNIX、Windows 和 Macintosh OS X 平台的此类技术。

这是一个很棒的 PDF，涵盖了如何在 OS X、Linux 和 Windows 上完成此操作。

它没有任何此处未记录的惊人技巧（顺便说一句，这是一组惊人的响应）......但它是一本不错的读物。

[在 Windows、UNIX 和 Macintosh OS X 平台上拦截任意函数 (2004)，作者 Daniel S. Myers 和 Adam L. Bazinet](http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.75.747)。

您可以[直接从其他位置下载 PDF（为了冗余）](https://pdfs.semanticscholar.org/7b76/fdeea9513cc3c9d3f13035ec31b5ed04456b.pdf)。

最后，如果前两个来源不知何故火了，[这里有一个谷歌搜索结果](https://www.google.com/search?q=Intercepting+arbitrary+functions+on+Windows%2C+UNIX%2C+and+Macintosh+OS+X+platforms%2C+by+Daniel+S.+Myers+and+Adam+L.+Bazinet)。

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2009-03-06T03:03:48.063

您可以将函数指针定义为全局变量。调用者语法不会改变。当您的程序启动时，它可以检查是否设置了某些命令行标志或环境变量以启用日志记录，然后保存函数指针的原始值并用您的日志记录函数替换它。您不需要特殊的“启用日志记录”构建。用户可以“在现场”启用日志记录。

您将需要能够修改调用者的源代码，但不能修改被调用者（因此这在调用第三方库时会起作用）。

富.h：

```
typedef const char* (*GetObjectNameFuncPtr)(object *anObject);
extern GetObjectNameFuncPtr GetObjectName; 
```

foo.cpp：

```
const char* GetObjectName_real(object *anObject)
{
    return "object name";
}

const char* GetObjectName_logging(object *anObject)
{
    if (anObject == null)
        return "(null)";
    else
        return GetObjectName_real(anObject);
}

GetObjectNameFuncPtr GetObjectName = GetObjectName_real;

void main()
{
    GetObjectName(NULL); // calls GetObjectName_real();

    if (isLoggingEnabled)
        GetObjectName = GetObjectName_logging;

    GetObjectName(NULL); // calls GetObjectName_logging();
} 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2017-07-11T19:47:16.057

以@Johannes Schaub 的回答为基础，采用适合您不拥有的代码的解决方案。

将要覆盖的函数别名为弱定义函数，然后自己重​​新实现。

**覆盖.h**

```
#define foo(x) __attribute__((weak))foo(x) 
```

**foo.c**

```
function foo() { return 1234; } 
```

**覆盖.c**

```
function foo() { return 5678; } 
```

在 Makefile 中使用[特定于模式的变量值](http://www.gnu.org/software/make/manual/make.html#Target_002dspecific)`-include override.h`来添加编译器标志。

```
%foo.o: ALL_CFLAGS += -include override.h 
```

旁白：也许你也可以`-D 'foo(x) __attribute__((weak))foo(x)'`用来定义你的宏。

编译并链接文件与您的重新实现 ( `override.c`)。

*   这允许您覆盖任何源文件中的单个函数，而无需修改代码。

*   缺点是您必须为要覆盖的每个文件使用单独的头文件。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-03-06T02:57:33.493

在涉及两个存根库的链接器中还有一个棘手的方法。

库 #1 与宿主库链接，并公开以另一个名称重新定义的符号。

库#2 链接到库#1，拦截调用并调用库#1 中重新定义的版本。

此处的链接订单要非常小心，否则它将不起作用。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-06T05:04:11.537

您也可以使用共享库 (Unix) 或 DLL (Windows) 来执行此操作（会降低性能）。然后，您可以更改 DLL/以便加载（一个版本用于调试，一个版本用于非调试）。

我过去做过类似的事情（不是为了实现您想要实现的目标，但基本前提是相同的）并且效果很好。

[根据OP评论编辑]

> 事实上，我想要覆盖函数的原因之一是因为我怀疑它们在不同的操作系统上表现不同。

有两种常见的方法（我知道）来处理这个问题，共享的 lib/dll 方式或编写您链接的不同实现。

对于这两种解决方案（共享库或不同的链接），您将拥有 foo_linux.c、foo_osx.c、foo_win32.c（或者更好的方法是 linux/foo.c、osx/foo.c 和 win32/foo.c）然后编译并与适当的链接。

如果您正在为不同的平台寻找不同的代码和调试 -vs- 版本，我可能会倾向于使用共享的 lib/DLL 解决方案，因为它是最灵活的。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-08-04T14:43:15.977

下面是我的实验。正文和结尾有4个结论。

## 简洁版本

一般来说，要成功覆盖一个函数，你必须考虑：

*   弱属性
*   翻译单元安排

## 长版

我有这些源文件。

```
.
├── decl.h
├── func3.c
├── main.c
├── Makefile1
├── Makefile2
├── override.c
├── test_target.c
└── weak_decl.h 
```

> 主程序

```
#include <stdio.h>

void main (void)
{
    func1();    
} 
```

> test_target.c

```
#include <stdio.h>

void func3(void);

void func2 (void)
{
    printf("in original func2()\n");
}

void func1 (void)
{
    printf("in original func1()\n");
    func2();
    func3();
} 
```

> 函数3.c

```
#include <stdio.h>

void func3 (void)
{
    printf("in original func3()\n");
} 
```

> decl.h

```
void func1 (void);
void func2 (void);
void func3 (void); 
```

> weak_decl.h

```
void func1 (void);

__attribute__((weak))
void func2 (void);

__attribute__((weak))
void func3 (void); 
```

> 覆盖.c

```
#include <stdio.h>

void func2 (void)
{
    printf("in mock func2()\n");
}

void func3 (void)
{
    printf("in mock func3()\n");
} 
```

> 生成文件1：

```
ALL:
    rm -f *.o *.a
    gcc -c override.c -o override.o
    gcc -c func3.c -o func3.o
    gcc -c test_target.c -o test_target_weak.o -include weak_decl.h
    ar cr all_weak.a test_target_weak.o func3.o
    gcc main.c all_weak.a override.o -o main -include decl.h 
```

> 生成文件2：

```
ALL:
    rm -f *.o *.a
    gcc -c override.c -o override.o
    gcc -c func3.c -o func3.o
    gcc -c test_target.c -o test_target_strong.o -include decl.h # HERE -include differs!!
    ar cr all_strong.a test_target_strong.o func3.o
    gcc main.c all_strong.a override.o -o main -include decl.h 
```

> Makefile1 结果的输出：

```
in original func1()
in mock func2()
in mock func3() 
```

> Makefile2 的输出：

```
rm *.o *.a
gcc -c override.c -o override.o
gcc -c func3.c -o func3.o
gcc -c test_target.c -o test_target_strong.o -include decl.h # -include differs!!
ar cr all_strong.a test_target_strong.o func3.o
gcc main.c all_strong.a override.o -o main -include decl.h 
override.o: In function `func2':
override.c:(.text+0x0): multiple definition of `func2'  <===== HERE!!!
all_strong.a(test_target_strong.o):test_target.c:(.text+0x0): first defined here
override.o: In function `func3':
override.c:(.text+0x13): multiple definition of `func3' <===== HERE!!!
all_strong.a(func3.o):func3.c:(.text+0x0): first defined here
collect2: error: ld returned 1 exit status
Makefile4:2: recipe for target 'ALL' failed
make: *** [ALL] Error 1 
```

符号表：

> all_weak.a：

```
test_target_weak.o:
0000000000000013 T func1  <=== 13 is the offset of func1 in test_target_weak.o, see below disassembly
0000000000000000 W func2  <=== func2 is [W]eak symbol with default value assigned
                 w func3  <=== func3 is [w]eak symbol without default value
                 U _GLOBAL_OFFSET_TABLE_
                 U puts

func3.o:
0000000000000000 T func3 <==== func3 is a strong symbol
                 U _GLOBAL_OFFSET_TABLE_
                 U puts 
```

> all_strong.a：

```
test_target_strong.o:
0000000000000013 T func1
0000000000000000 T func2 <=== func2 is strong symbol
                 U func3 <=== func3 is undefined symbol, there's no address value on the left-most column because func3 is not defined in test_target_strong.c
                 U _GLOBAL_OFFSET_TABLE_
                 U puts

func3.o:
0000000000000000 T func3  <=== func3 is strong symbol
                 U _GLOBAL_OFFSET_TABLE_
                 U puts 
```

在这两种情况下，`override.o`符号：

```
0000000000000000 T func2  <=== func2 is strong symbol
0000000000000013 T func3  <=== func3 is strong symbol
                 U _GLOBAL_OFFSET_TABLE_
                 U puts 
```

> 拆卸：

```
test_target_weak.o:     file format elf64-x86-64

Disassembly of section .text:

0000000000000000 <func2>: <===== HERE func2 offset is 0
   0:   55                      push   %rbp
   1:   48 89 e5                mov    %rsp,%rbp
   4:   48 8d 3d 00 00 00 00    lea    0x0(%rip),%rdi        # b <func2+0xb>
   b:   e8 00 00 00 00          callq  10 <func2+0x10>
  10:   90                      nop
  11:   5d                      pop    %rbp
  12:   c3                      retq   

0000000000000013 <func1>: <====== HERE func1 offset is 13
  13:   55                      push   %rbp
  14:   48 89 e5                mov    %rsp,%rbp
  17:   48 8d 3d 00 00 00 00    lea    0x0(%rip),%rdi        # 1e <func1+0xb>
  1e:   e8 00 00 00 00          callq  23 <func1+0x10>
  23:   e8 00 00 00 00          callq  28 <func1+0x15>
  28:   e8 00 00 00 00          callq  2d <func1+0x1a>
  2d:   90                      nop
  2e:   5d                      pop    %rbp
  2f:   c3                      retq 
```

所以结论是：

1.  文件中定义的函数`.o`可以覆盖文件中定义的相同函数`.a`。在上面的**Makefile1**中，`func2()`and `func3()`in`override.o`覆盖了`all_weak.a`. 我尝试了这两个`.o`文件，但它不起作用。

2.  对于**GCC**，您不需要将函数拆分为单独的[文件](https://stackoverflow.com/questions/5097961/windows-static-library-with-default-functions)`.o`，如**Visual Studio toolchain**中所述。我们可以在上面的示例中看到，（在与 相同的文件中）和（在单独的文件中）都可以被覆盖。**`func2()``func1()``func3()`**

***   要覆盖一个函数，在编译其**消费者**的**翻译单元**时，您需要将该函数指定为弱。这将在`consumer.o`. 在上面的示例中，当编译`test_target.c`消耗`func2()`and的 , 时`func3()`，您需要添加`-include weak_decl.h`, 将`func2()`and声明`func3()`为弱。`func2()`也定义了，但`test_target.c`没关系。** 

 **## 一些进一步的实验

还是上面的源文件。但是稍微改变`override.c`一下：

> 覆盖.c

```
#include <stdio.h>

void func2 (void)
{
    printf("in mock func2()\n");
}

// void func3 (void)
// {
//     printf("in mock func3()\n");
// } 
```

在这里，我删除了`func3()`. **我这样做****是因为我想回退到`func3()`.`func3.c`**

我仍然使用`Makefile1`构建。构建是好的。但是运行时错误发生如下：

```
xxx@xxx-host:~/source/override$ ./main
in original func1()
in mock func2()
Segmentation fault (core dumped) 
```

所以我检查了决赛的符号`main`：

```
0000000000000696 T func1
00000000000006b3 T func2
                 w func3 
```

所以我们可以看到`func3`没有有效的地址。这就是发生段故障的原因。

**所以为什么？我没有将其添加`func3.o`到`all_weak.a`存档文件中吗？**

> ar cr all_weak.a **func3.o** test_target_weak.o

我尝试了同样的事情`func2`，我从中删除了`func2`实现`ovrride.c`。但这一次没有段错误。

> 覆盖.c

```
#include <stdio.h>

// void func2 (void)
// {
//     printf("in mock func2()\n");
// }

void func3 (void)
{
    printf("in mock func3()\n");
} 
```

> 输出：

```
xxx@xxx-host:~/source/override$ ./main
in original func1()
in original func2()  <====== the original func2() is invoked as a fall back
in mock func3() 
```

我的猜测是，*因为*`func2`与. 所以总是带进来。所以链接器总是可以解析，无论是从or 。*`func1``func2``func1``func2``test_target.c``override.c`*

 *但是对于`func3`，它是在单独的*文件/翻译单元*(func3.c) 中定义的。如果声明为弱，消费者`test_target.o`仍将记录`func3()`为弱。但**不幸的是，GCC 链接器不会检查`.o`同一`.a`文件中的其他文件以查找`func3()`.** 虽然它确实存在。

> all_weak.a：

```
func3.o:
0000000000000000 T func3 <========= func3 is indeed here!
                 U _GLOBAL_OFFSET_TABLE_
                 U puts

test_target_weak.o:
0000000000000013 T func1
0000000000000000 W func2
                 w func3
                 U _GLOBAL_OFFSET_TABLE_
                 U puts 
```

所以我必须提供一个覆盖版本，`override.c`否则`func3()`无法解决。

**但我仍然不知道为什么 GCC 会这样。如果有人可以解释，请。**

（2021 年 8 月 8 日上午 9:01 更新： [这个](https://stackoverflow.com/questions/68689260/why-the-weak-symbol-defined-in-the-same-a-file-but-different-o-file-is-not-use)线程可能会解释这种行为，*希望*如此。）

所以进一步的结论是：

4.  如果您将某个符号声明为弱，则最好提供**所有**弱函数的覆盖版本。否则，除非原始版本位于调用者/消费者的同一**文件/翻译单元**中，否则无法解析原始版本。

# c++ - 两种链接 boost 正则表达式的方法出错

> ID：617555
> 
> 赞同：1
> 
> 时间：2009-03-06T02:44:55.613
> 
> 标签：c++, regex, boost, linker

我知道 boost regex 静态库是使用 ar 实用程序通过归档单个目标文件创建的。

我使用 gcc 中的 -l 选项链接了 boost 正则表达式库。这工作得很好。

```
g++ *.o libboost_regex-gcc-1_37.a -o sairay.out 
```

我单独编译了 boost regex 源文件，然后尝试将我的应用程序的目标文件和 boost regex 的目标文件链接到一个可执行文件中。但是现在我遇到了错误。

```
 g++ *.o -o sairay.out
  Undefined                       first referenced
  symbol                             in file
  main                                /opt/csw/gcc3/lib/gcc/sparc-sun-solaris2.8/3.4.5/crt1.o 
```

我想知道链接静态库和链接静态库文件的各个对象与应用程序之间有什么区别？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-06T04:41:55.550

我认为应该是：

```
g++ *.o -L. -lboost_regex-gcc -o sairay.out -static 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-06T02:52:40.947

您显然忘记包含定义该`main`功能的应用程序的目标文件。也许您键入`g++ myapp.cpp`而不是`g++ -c myapp.cpp`（实际创建一个目标文件而不是已经准备好的链接二进制文件）？

静态库实际上不仅仅是一个包含许多或几个目标文件（由`ar`实用程序存档）的存档，并附加了一个符号表索引以便快速查找。因此，如果您在链接中手动包含目标文件，我认为它的作用基本相同。

尝试以下操作以查看它包含的目标文件

```
ar tv libboost_regex-gcc-1_37.a 
```

# project-management - 您如何在不同的新兴技术之间做出选择？

> ID：617569
> 
> 赞同：2
> 
> 时间：2009-03-06T02:58:30.637
> 
> 标签：project-management

我将来面临开发一个新的网络应用程序，我想知道如何决定使用什么框架。我已经选择 Python 作为我的首选语言。但是仍然有可能的框架可供选择！更一般地说，您如何在最新一轮 Web 框架仍在开发中的不同相似技术之间进行选择？我很好奇你决定你从未使用过的技术的过程是什么。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-06T03:03:53.680

认识到没有选择是完美的——甚至是非常好的。

无论您选择什么，都会有人提出--他们声称--更好的建议。

不管你选择什么，你的技术的一部分。堆栈将无法达到您的期望。

最重要的是“无共享”，以便可以更换组件。

在那之后，下一个最重要的事情是自动生成的功能，以减少或防止编程。

看看姜戈。许多自动管理功能使生活变得非常愉快。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-06T03:13:17.777

您可以做很多事情：

*   下载框架并用它们构建类似的东西以进行比较。
*   寻找其他人的比较，但尝试理解审稿人的偏见。
*   观察工作中的社区，了解人们正在构建什么以及他们在使用该技术时遇到的问题。论坛、博客、邮件列表等是查看的好地方。
*   参加会议并结识志趣相投的开发人员。

您还可以采用使用稳定版本而不是 alpha 位的方法。一段时间后，您可能会更接近流血的边缘。与相关项目相关的人通常比从其他平台接近的人更有偏见，要小心你信任的人。

考虑使用前沿框架与已建立框架的影响。有时，对您的客户而言，重要的是您处于一个被认为是稳定的状态。在其他时候，这无关紧要。您对修复框架本身感觉如何？优秀的开发人员将学习内部结构，或者至少知道足够的知识以在将错误发送到框架邮件列表等时保持进展。

考虑一些在 python 平台上构建抽象和可重用代码的一般最佳实践。在迁移到另一个平台时，您也许可以为自己节省一些工作。但是，不要成为重用迷，因为这会限制您使用框架的有效性。当 37Signals 的人谈论从工作代码中提取框架而不是从头开始构建框架时，他们是对的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-31T16:03:03.193

我知道这是一个旧帖子，但我（再次）处于类似情况，我认为还有其他人可能想要寻找不同的意见，并听到（有些）成功的经验。

由于 baudtack 提到了 Python，我将尝试按照我使用 Python 的经验来回答这个问题。这是对我有用的：

1.  确定你的项目范围——在不引入任何编程或设计说明的情况下概述你的应用程序应该能够做什么，这将大大阐明你的目标
2.  确定您希望如何处理代码、堆栈和数据：

    一种。您想使用哪种编程范式？即面向对象的、函数式的等等。你想玩你的编程风格还是你想跟随别人的编程风格？

    湾。是否使用语义网？您想更好地控制 URI 及其设计吗？（顺便说一下，我发现 web.py 非常适合 - 我选择在 Python 中创建 REST API）

    C。您是否希望被框架要求所困，或者您是否希望将应用程序与 Web 组件更好地分离，例如，使用框架将您的应用程序用作一组模块。我对 Django 的问题是我最终没有编程 Python，而是不得不学习比我需要的更多的 Django。如果这对你有用，那么这就是要走的路。

    d。数据存储...某种 SQL 与非 RDBMS（xml 数据库，如具有完整 xquery 支持的 eXist-db）与 OODBMS 与上述组合？你需要这有多复杂？对于如何在应用程序中存储和调用数据，您需要多少控制/分离？

    e. 测试：单元测试......感谢python！如果您的 Web 应用程序有增长的潜力（就像他们经常做的那样），那么拥有一个健全且连贯的测试平台将对未来有很大帮助 - 我希望我早点了解这一点。哦，好吧……迟到总比没有好。

    F。您需要对服务器进行多少控制？托管注意事项？您需要对 Apache 实例进行多少控制？操作系统特定需求？我发现使用像 Webfaction 这样的共享托管服务提供商非常棒。我最终发现我需要更大的灵活性和带宽需求。换句话说，您的预算可以得到什么？如果您每个月有 50 美元可花，最好考虑像 Linode 这样的虚拟主机解决方案......

最后，我赞同 S.Lott 的观点，即没有一个解决方案的选择是完美的，并且会过时。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-06T03:22:40.920

经验胜过传闻。我发现原型设计是一个巨大的帮助。制作一个原型，使用您期望对各种框架最重要的功能。这有助于排除可能无法“像宣传的那样”工作的任何功能。

不过，总的来说，愿意研究新技术是值得称赞的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-11-07T04:50:40.530

我有一组不同类别的标准：

**活动与文档**

1.  是否有活跃的用户群？
2.  是否有活跃的开发基地？
3.  支持响应和信息可访问吗？
4.  是否有用户和开发指南和参考资料？

这些是必不可少的，所有这些都需要可追溯性才能建立对解决方案的信心。

**便于使用**

基本特征是简单的，复杂的特征是可能的吗？我通常会给一个新框架一个测试驱动器，并尝试推出一组用例来看看这个框架的使用有多直观。

1.  对于本地/开发安装和生产部署，安装是否直观且简单？
2.  它是如何备份和升级的？
3.  实现“Hello World”类型的博客文章、静态页面、菜单项和插件的工作量和用户体验是什么？
4.  如何处理核心和插件的版本？

**示例（关于自动化测试/持续集成解决方案的主题）**

几年前，我评估了几个自动化测试解决方案。当时[Jenkins](http://jenkins-ci.org/)和[TeamCity](https://www.jetbrains.com/teamcity/)是领先者，最终我选择了 TeamCity，因为它的用户体验、活跃的用户和开发基础以及可访问文档的质量。

**示例（博客的 CMS）**

这个标准也是我更喜欢使用 Wordpress 而不是其他选项的原因。虽然 wordpress 有其缺点，但用户和开发基础强大且活跃，这导致软件架构随着时间的推移具有更大的发展潜力并保持其相关性，以及提供优质插件和主题可供选择的开发社区。

# c++ - Microsoft _s 函数，它们现在是 C++ 标准的一部分吗？

> ID：617571
> 
> 赞同：6
> 
> 时间：2009-03-06T03:02:39.067
> 
> 标签：c++, standards

我最近将我的 IDE 更改为来自 MSVC++ 6 的 MS Visual Studio 2005，并且收到了很多弃用警告。我没有忽略警告，而是开始将它们更改为 _s 等效项。但是，我后来发现这些只是微软的实现。

我在某处读到他们正在推动这些成为标准的一部分。是吗？

使用这些 _s 函数是个好主意吗？还是我应该使用其他东西？

谢谢。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-06T03:12:40.337

这些`*_s()`函数不是 C 标准的一部分，但有一个待定的“技术报告”建议添加它们（我不确定 TR 中的例程是否与 Microsoft 的例程完全相同，或者它们是否只是相似） .

TR 24731-1：C 库扩展第一部分：边界检查接口：

*   [http://www.open-std.org/JTC1/SC22/WG14/www/docs/n1225.pdf](http://www.open-std.org/JTC1/SC22/WG14/www/docs/n1225.pdf)

如果您想继续使用旧功能，您可以通过定义宏来保持弃用警告安静`_CRT_SECURE_NO_WARNINGS`（`_CRT_SECURE_NO_DEPRECATE`可能仍受支持）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-06T03:08:12.343

您升级了 IDE 并升级了 Microsoft 库。坦率地说，您可以继续使用您的旧库，因为它们会继续保留（为了向后兼容），尽管 Microsoft 已经表示他们实际上将开始删除其中一些旧功能。我想说，如果您正在向前发展，那么您可以使用更新的功能；如果您正在向后开发（或不担心版本是什么），那么您可能想要使用较旧的功能。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-06T03:09:22.730

如果您的目标是 Microsoft 平台，请务必使用它们。即使您不是，您也可以在需要将软件移植到非 Microsoft 平台时（或如果）自己实现它们。

最坏的情况是你最终使用了几个`#ifdef`s 来有条件地编译。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-06T03:16:16.787

据我所知，他们正在考虑进行标准化。该提案是[TR 24731](http://www.open-std.org/jtc1/sc22/wg14/www/projects#24731)。

至于使用它们是否是一个好主意，我会说是的。我不太喜欢他们捕获错误的方式，但我相信您可以为他们提供自己的处理程序。如果您需要跨平台兼容性，您有两种选择：在非 Windows 平台上使用宏实现它们或关闭弃用警告。

在对大型代码库进行审查后，我确定几乎不可能让所有程序员都正确使用 C 标准库函数进行字符串操作，因此所有旨在纠正这一点的内容都是值得欢迎的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-08-14T07:17:32.310

您应该使用标准函数并禁用 Microsoft 默认打开的任何虐待狂警告，以阻止您编写符合标准的代码。我严重怀疑“_s 函数”是否会被添加到标准 C 中（尽管它们已被提议），因为它们是单个供应商的发明，并且从未被任何其他供应商实现过。（嘿，让我们将所有 POSIX 合并到 C 标准中，而我们正在使用它......）

# isapi - 从 ISAPI 过滤器确定响应长度

> ID：617579
> 
> 赞同：1
> 
> 时间：2009-03-06T03:08:47.147
> 
> 标签：isapi

我正在开发一个 ISAPI 过滤器，以从响应中去除某些内容。在进行处理之前，我需要收集响应的所有主体，因为我正在剥离的内容可能会与发送缓冲区重叠。

为此，我想缓冲每个`SF_NOTIFY_SEND_RAW_DATA`通知的响应内容，直到我到达最后一个，然后发送翻译后的数据。我想知道确定哪个`SF_NOTIFY_SEND_RAW_DATA`实际上是最后一个的最佳方法。如果我等到`SF_NOTIFY_END_OF_REQUEST`通知，那么我不知道如何发送我缓冲的数据。

一种方法是使用内容长度。这需要我检测到标题的结尾。它还需要假设 content-length 标头是正确的（可以保证吗？）。由于 HTTP 甚至不需要 content-length 标头，我什至不确定它是否会一直存在。似乎应该有一个更简单的方法。

我假设响应没有被分块，所以在我做响应更改之前我没有处理去分块。另外，当我对响应体进行修改时，响应体的大小不会改变，所以我不需要回去更新内容长度。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-06T17:23:11.587

我最终通过谷歌找到了一些很好的讨论。

这篇文章回答了我的问题，并提出了更复杂的过滤器必须解决的问题： [http ://groups.google.com/group/microsoft.public.platformsdk.internet.server.isapi-dev/browse_thread/thread/ 85a5e75f342fad2b/cbb638f9a85c9e03?q=HTTP_FILTER_RAW_DATA&_done=%2Fgroups%3Fq%3DHTTP_FILTER_RAW_DATA%26start%3D20%26&_doneTitle=返回+搜索&&d&pli=1](http://groups.google.com/group/microsoft.public.platformsdk.internet.server.isapi-dev/browse_thread/thread/85a5e75f342fad2b/cbb638f9a85c9e03?q=HTTP_FILTER_RAW_DATA&_done=%2Fgroups%3Fq%3DHTTP_FILTER_RAW_DATA%26start%3D20%26&_doneTitle=Back+to+Search&&d&pli=1)

我拥有的过滤器将完整的请求缓冲到自己的缓冲区中，然后使用 SF_NOTIFY_END_OF_REQUEST 发送内容。修改它不会改变大小，并且排除了响应被分块的可能性，所以在我的情况下过滤器相对简单。

# java - Java lib压缩html文件？

> ID：617585
> 
> 赞同：11
> 
> 时间：2009-03-06T03:12:30.493
> 
> 标签：java, html, compression

有谁知道任何可以从 html 文件中去除多余空格（换行符、制表符等）的好的 java 库（或单一方法）？所以html文件基本上变成了1行。

谢谢。

**更新：**看起来没有库可以做到这一点，所以我创建了自己的开源项目来解决这个任务：[http ://code.google.com/p/htmlcompressor/](http://code.google.com/p/htmlcompressor/)

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-03-14T00:50:00.740

看起来没有库可以做到这一点，所以我创建了自己的开源项目来解决这个任务，也许有人会发现它有帮助：[http ://code.google.com/p/htmlcompressor/](http://code.google.com/p/htmlcompressor/)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-06T03:20:52.533

就我个人而言，我只是在服务器中启用了**HTTP 压缩**，并让我的 HTML 可读。

但是对于您想要的，您可以将 String.replaceAll() 与匹配您指定的正则表达式一起使用。在我的头顶上，类似：

```
small=large.replaceAll("\\s{2,}"," "); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-06T07:39:06.343

小心点。pre 和 textarea 元素内的文本将被损坏。此外，脚本元素内的内联 javascript 必须以 column; 结尾。最后，如果您使用 html 注释编写内联 javascript（以避免一些旧的浏览器错误行为），这最终将注释掉整个内联 javascript 代码。

你为什么要这样做？如果您想减少 html 的下载大小，那么您只需要一个[GZIP 过滤器](https://stackoverflow.com/questions/550024/tomcat-compression-does-not-add-a-content-encoding-gzip-in-the-header/611577#611577)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-04-03T10:28:57.247

您需要以下库：

[com.googlecode.htmlcompressor/htmlcompressor/1.5.2](https://mvnrepository.com/artifact/com.googlecode.htmlcompressor/htmlcompressor/1.5.2)
[com.google.javascript/closure-compiler/r1043](https://mvnrepository.com/artifact/com.google.javascript/closure-compiler/r1043)
[com.yahoo.platform.yui/yuicompressor/2.4.6](https://mvnrepository.com/artifact/com.yahoo.platform.yui/yuicompressor/2.4.6)

版本不是最新的，但它们是兼容的。
Closure 用于内联 JavaScript，yui 用于内联 CSS。

```
import com.googlecode.htmlcompressor.compressor.HtmlCompressor;
import com.googlecode.htmlcompressor.compressor.ClosureJavaScriptCompressor;
import com.google.javascript.jscomp.CompilationLevel;

public class Html {
  private static final HtmlCompressor compressor = new HtmlCompressor();
  static {
    compressor.setPreserveLineBreaks(false);
    compressor.setCompressCss(true);
    compressor.setCompressJavaScript(true);
    compressor.setJavaScriptCompressor(
      new ClosureJavaScriptCompressor(CompilationLevel.WHITESPACE_ONLY)
    );
  }

  public static String minify(String html) {
    return compressor.compress(html);
  }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-06T03:32:12.007

假设希望使 HTML 更小以优化通过网络发送的字节，为什么不让 HTTP 服务器来完成这项工作？[在这里](http://en.wikipedia.org/wiki/HTTP_compression)阅读。

[这](http://www.servletsuite.com/servlets/trimflt.htm)行得通吗？不幸的是不是免费的。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-03-06T03:27:17.540

```
input.replaceAll("\s+", " "); 
```

将任何空格转换为单个空格

# java - Future.get() 是 Thread.join() 的替代品吗？

> ID：617591
> 
> 赞同：8
> 
> 时间：2009-03-06T03:15:33.637
> 
> 标签：java, concurrency

我想编写一个永远运行的命令行守护程​​序。我知道，如果我希望 JVM 能够在 linux 中正常关闭，则需要通过一些 C 代码包装引导程序。我想我现在可以使用关机钩子了。

关于我的问题：

1.  我的 main(String[]) 块将触发一个单独的超级守护进程。
2.  超级守护进程将永远轮询和循环。

所以通常我会这样做：

```
class Superdaemon extends Thread { ... }

class Bootstrap
{
    public static void main( String[] args )
    {
        Thread t = new Superdaemon();
        t.start();

        t.join();
    }
} 
```

现在我想如果我通过 Executor 启动 Superdaemon，我可以做到

```
Future<?> f = exec.submit( new Superdaemon() );

f.get(); 
```

是`Future.get()`用 Thread.join() 实现的吗？如果不是，它的行为是否相同？

问候，

明孝

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-06T05:21:28.233

是的，你写这些的方式是等价的。

但是，您实际上并不需要等待 Superdaemon 线程完成。当主线程完成执行 main() 时，该线程退出，但 JVM 不会。JVM 将继续运行，直到最后一个非守护线程退出其运行方法。

例如，

```
public class KeepRunning {
  public static void main(String[] args) {
    Superdaemon d = new Superdaemon();
    d.start();
    System.out.println(Thread.currentThread().getName() + ": leaving main()");
  }
}

class Superdaemon extends Thread {
  public void run() {
    System.out.println(Thread.currentThread().getName() + ": starting");
    try { Thread.sleep(2000); } catch(InterruptedException e) {}
    System.out.println(Thread.currentThread().getName() + ": completing");
  }
} 
```

你会看到输出：

```
main: leaving main()
Thread-0: starting
Thread-0: completing 
```

换句话说，主线程首先完成，然后辅助线程完成，JVM 退出。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-06T04:01:32.887

> 问题是像 JCIP 这样的书提倡我们使用 Executors 来启动 Threads。所以我尽量不使用 Thread.start()。我不确定我是否一定会仅仅基于简单性而选择一种特定的做事方式。一定有一个更有说服力的理由，不是吗？

使用*java.util.concurrent*令人信服的理由是多线程编程非常棘手。Java为此提供了工具（线程，*同步*和易*失性*关键字），但这并不意味着您可以安全地直接使用它们而不会自欺欺人：同步过多会导致不必要的瓶颈和死锁，或者同步过少，由于竞争条件导致行为不稳定）。

使用*java.util.concurrent*，您可以获得一组实用程序（由专家编写），用于最常见的使用模式，您可以直接使用这些实用程序，而不必担心您得到了正确的低级内容。

但是，在您的特定情况下，我完全不明白为什么您需要一个单独的线程，您不妨使用主线程：

```
public static void main( String[] args )
{
    Runnable t = new Superdaemon();
    t.run();
} 
```

执行器适用于您希望在后台运行的任务（当您有多个并行任务或当前线程可以继续执行其他操作时）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-06T03:20:21.690

Future.get() 将从异步调用中获得未来的响应。如果调用尚未完成，这也会阻塞。它很像线程连接。

[http://java.sun.com/j2se/1.5.0/docs/api/java/util/concurrent/Future.html](http://java.sun.com/j2se/1.5.0/docs/api/java/util/concurrent/Future.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-06T03:19:01.880

排序。`Future.get()`是为了让一个线程关闭并计算一些东西，然后以一种安全的方式将它返回给调用线程。如果`get`从未返回，它会起作用。但是，我会坚持`join`调用，因为它更简单并且没有 Executer 开销（并不是说会有那么多）。

**编辑**

它看起来像是[`ExecutorService.submit(Runnable)`](http://java.sun.com/j2se/1.5.0/docs/api/java/util/concurrent/ExecutorService.html#submit(java.lang.Runnable))打算做你正在尝试的事情。它只是`null`在`Runnable`完成时返回。有趣的。

# jvm - 更好地理解 JVM

> ID：617592
> 
> 赞同：18
> 
> 时间：2009-03-06T03:16:03.153
> 
> 标签：jvm

我想知道 JVM 的内部结构、它的执行方式以及重要的细节。你能推荐任何可用的资源或最好的书吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-12T21:44:41.333

我对 JVM 的了解大部分来自 Sun 文档。他们在 HotSpot VM 上有一些很棒的白皮书：http: [//java.sun.com/javase/technologies/hotspot/index.jsp](http://java.sun.com/javase/technologies/hotspot/index.jsp)

您提到了性能，所以也许您会对 Sun 性能文档感兴趣：http: [//java.sun.com/docs/performance/](http://java.sun.com/docs/performance/)

要获得更多动手方法，请尝试查看[Kaffe](http://kaffe.org)。这将向您展示虚拟机的功能，但不一定是 Java 代码在 Sun 的 JVM 中的工作方式：

> Kaffe 是 Java 虚拟机的无尘室实现，以及提供 Java 运行时环境所需的相关类库。

OpenJDK 是了解 Java 平台如何实现的好地方：http: [//openjdk.java.net/](http://openjdk.java.net/)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-06T03:37:54.050

“Java 2 虚拟机内部”的章节：

[http://www.artima.com/insidejvm/ed2/index.html](http://www.artima.com/insidejvm/ed2/index.html)

Bill Venners 的“幕后”文章

[http://www.artima.com/underthehood/index.html](http://www.artima.com/underthehood/index.html)

如果您想亲自动手并尝试使用 JVM 进行低级编程，还有“Jasmin”，它是 JVM 的汇编程序。

[http://jasmin.sourceforge.net/](http://jasmin.sourceforge.net/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-06T03:22:33.963

显而易见的首选是[Java 虚拟机规范](http://java.sun.com/docs/books/jvms/)。还有[The Wikipedia Page](http://en.wikipedia.org/wiki/Java_Virtual_Machine)，它链接到其他资源。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-06T03:51:45.157

如果您的动机是找出如何编写运行速度更快或使用更少内存的代码，那么 VM 规范不会有太大帮助。

VM 规范并非旨在为您提供相关信息，它旨在让 VM 开发人员大致了解如何实现 VM。

话虽这么说，读它也不能急。

找出速度/内存问题的最佳方法是在更高的层次上，有许多书籍可以帮助您更快/更精简的代码。

探查器是一个非常宝贵的工具，用于测试您的代码以查看更快/使用更少内存的内容。配置文件，看看什么是慢/使用大量内存，更改它，配置文件，看看更改做了什么。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-05-04T01:56:54.657

这是对堆、对象分配和垃圾收集的一个简短的解释， [理解内存管理](https://docs.oracle.com/cd/E13150_01/jrockit_jvm/jrockit/geninfo/diagnos/garbage_collect.html#wp1086013)。你可以从那里开始探索更多。

# database-design - 为所有客户提供一个模式，还是为每个客户提供不同的模式？

> ID：617594
> 
> 赞同：3
> 
> 时间：2009-03-06T03:16:48.517
> 
> 标签：database-design

假设您构建了一个需要为多个客户服务的应用程序（数据从不在客户之间共享）并且客户数据本身是敏感的。

您将如何设计数据库以防止来自一个客户的突然（例如错误）数据对另一个客户可见？

例如，我们有一个包含客户项目的项目表。现在我们可以将所有项目（所有客户）放入该表或为每个客户创建一个模式。

我喜欢模式分离的想法（因为它会完全分离数据），但因为我从来没有这样做过，所以我不确定这是否是一个好方法（例如，改变模式需要维护所有客户方案）。

**重要提示：**该应用程序还包含所有客户共享的主数据（例如客户帐户、设置、模板等）。所以我期望的另一个缺点是同时维护多个连接......

**更新：**是否可以自动复制模式？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-06T05:46:25.630

为了正确衡量选项，我认为您需要分析应用程序代码的质量。我为大客户构建了许多系统，这些系统可以很好地共享数据库，而我们从未担心过交叉共享数据。如果您有授权逻辑安全的高质量代码，那么我将始终使用一种模式；这样维护就容易多了

另一方面。如果您拼凑了没有业务对象库、没有标准和集中授权逻辑的 asp 页面；那么肯定会使用不同的数据库，每个客户都有唯一的登录名。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-06T03:26:13.940

我认为您将每个客户分开的想法将是最佳选择。您的主数据可以自己保存，只要客户不访问该表（或至少经常访问它）就可以了。关键在于分离所有客户的敏感数据，同意这会导致更多的工作。但是，嘿，这就是您扩展业务所获得的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-06T03:26:23.720

根据您的要求，单独的客户数据库模式听起来是个好主意。这会有点让人头疼，但不像诉讼那么严重。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-06T03:33:26.340

您可以改为创建一个主表并为每个客户提供一个视图。然后，所有查询都将通过此视图，该视图将过滤掉相关客户之外的所有内容。

这使得维护变得容易，因为视图只定义了一个单一的约束（在客户上）并且不包含任何其他模式信息。

这是 MySQL 中的一个示例（不是最好的视图数据库，但是嘿）

```
CREATE VIEW projects.foocust AS SELECT * FROM projects WHERE customer = 'foocust'; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-06T03:43:52.913

我的建议是尽可能将每个客户的数据分开。使用 SQL Server，我会将每个客户的数据存储在单独的数据库中（您可以在 SQL Server 实例中拥有许多单独的数据库）。如果您没有该选项，则架构可以执行非常相似的操作。

# java - Weblogic 9.2 是否支持 Sun Jdk 1.6？

> ID：617597
> 
> 赞同：3
> 
> 时间：2009-03-06T03:19:43.970
> 
> 标签：java, weblogic, compatibility

有没有人有在 JDK 1.6 上运行 Weblogic 9.2 的经验？我无法在 Oracle 网站上找到该信息。在[支持的配置](http://e-docs.bea.com/platform/suppconfigs/configs92/92_over/overview.html)页面中，他们只提到了 Sun 32/64 位 JDK，但我没有找到对特定 java 版本的任何引用。

我想从 java 1.5 升级到 1.6，但我们还没有准备好升级 Weblogic。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-06T03:32:19.073

Java 1.5 是[WebLogic 9.2](http://e-docs.bea.com/platform/suppconfigs/configs/rhelinux/rhel50_92.html#101911)支持的版本。看起来 10.0.3 为 64 位 RH AS 5 引入了 Java 6。

[在此处](http://e-docs.bea.com/platform/suppconfigs/platform.html)查找有关每个 WebLogic 版本的信息的链接。从那里，您必须选择您的操作系统和架构，以了解支持哪些 JVM。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-03-03T10:06:32.417

Weblogc 9.2.1 - 9.2.3 不支持 JDK 1.6，JDK 1.5 的任何补丁/修订版都将得到支持。今天最新的是 JDK 1.5 的补丁 22。

# mysql - 同步两个 MySql 服务器（不在同一个集群中）的最佳方法/工具是什么

> ID：617598
> 
> 赞同：1
> 
> 时间：2009-03-06T03:20:15.450
> 
> 标签：mysql, synchronization, mysqldump

我发现自己在家中开发应用程序，然后在商业服务器上充满数据。
我需要一种简单易用的方法将 MySql DB 从商业服务器转储到我的私人服务器中。
有没有工具/命令可以做到这一点？
（我想过让我的数据库成为奴隶，但是，我并不总是有权访问商业 MySql 服务器，而且我确实在我的服务器上开发......如果它们以这种方式链接，可能会导致问题） .

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-06T03:24:05.380

这就是您可以备份数据库并重新加载它的方式。

在主服务器上

```
mysqldump -u[username] -p[password] databasename > database.sql 
```

或者，如果您需要包含函数和/或触发器，请执行

```
mysqldump -u[username] -p[password] --routines --triggers databasename > database.sql 
```

将 database.sql 复制到开发服务器

在开发服务器上

```
mysql -u[username] -p[password] databasename < database.sql 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-06T03:35:08.300

你可以试试[SQLyog Job Agent——](http://www.google.com/search?q=SQLyog+Job+Agent)它得到了很好的评价。

# ruby - 为 PostgreSQL 8.3 安装 PL/Ruby

> ID：617600
> 
> 赞同：7
> 
> 时间：2009-03-06T03:20:42.547
> 
> 标签：ruby, postgresql

这是为了能够使用嵌入式**ruby​​ 代码开发****postgres**函数，但我一直无法构建它。

 **根据 [http://www.robbyonrails.com/articles/2005/08/22/installing-untrusted-pl-ruby-for-postgresql的建议](http://www.robbyonrails.com/articles/2005/08/22/installing-untrusted-pl-ruby-for-postgresql)

我正在尝试从 ftp://moulon.inra.fr/pub/ruby/ 提供的最新版本 (plruby-0.5.3.tar.gz) 构建所需的 [plruby.so](ftp://moulon.inra.fr/pub/ruby/)

我已经整理出我的本地 postgres 设置在哪里，并将调用调整为：

```
ruby extconf.rb --with-pgsql-include=/usr/postgresql-8.3.4/include/server --enable-shared --disable-conversion --with-pgsql-version=83 
```

我已经尝试了很多变体，但似乎无法成功制作“conftest.c”文件

它是这样说的：

```
checking for catalog/pg_proc.h... yes
*** extconf.rb failed ***
Could not create Makefile due to some reason, probably lack of
necessary libraries and/or headers.  Check the mkmf.log file for more
details.  You may need configuration options. 
```

这就是我在 mkmf.log 中得到的结果

```
have_header: checking for catalog/pg_proc.h... -------------------- yes
"gcc -E -I. -I/usr/lib/ruby/1.8/x86_64-linux -I. -I/usr/postgresql-8.3.4/include/server   -g -O2  -fPIC  conftest.c -o conftest.i"
checked program was:
/* begin */
1: #include <catalog/pg_proc.h>
/* end */ 
```

当我手动运行 gcc 行时，它说没有“conftest.c”（没有，但应该生成）。

```
'uname -a' ... gives
Linux vdev1 2.6.18.8-xen #2 SMP Thu May 8 11:52:29 PDT 2008 x86_64 x86_64 x86_64 GNU/Linux
'ruby -v' ... gives
ruby 1.8.6 (2008-08-11 patchlevel 287) [x86_64-linux] 
```

任何帮助和/或建议将不胜感激。

——迈克·贝罗

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-09T20:52:07.160

好的，我设法通过谷歌搜索成功构建的日志文件来**手动构建**这个（绕过*脆弱*的extconf.rb 和 makefile），从我在那里看到的 gcc 行开始，然后摆弄 gcc 编译标志和路径，直到它工作。

在 plruby.h 中将 SAFE_LEVEL 更改为 0，如下所示

```
#ifndef SAFE_LEVEL
//#define SAFE_LEVEL 12
#define SAFE_LEVEL 0
#endif 
```

从 shell 编译每个然后链接

```
gcc -I. -I. -I/usr/lib/ruby/1.8/x86_64-linux -I. -DHAVE_CATALOG_PG_PROC_H -DHAVE_RB_HASH_DELETE -DHAVE_ST_H -DHAVE_UTILS_ARRAY_H -I/usr/postgresql-8.3.4/include/server  -D_FILE_OFFSET_BITS=64  -fPIC -fno-strict-aliasing -g -g -O2  -fPIC  -DHAVE_RB_HASH_DELETE -DHAVE_RB_INITIALIZE_COPY -DPG_UTILS_ARRAY -DPG_PL_TRYCATCH -DPG_PL_VERSION=83 -DPLRUBY_CALL_HANDLER=plruby_call_handler -DPLRUBY_VALIDATOR=plruby_validator  -c plruby.c
gcc -I. -I. -I/usr/lib/ruby/1.8/x86_64-linux -I. -DHAVE_CATALOG_PG_PROC_H -DHAVE_RB_HASH_DELETE -DHAVE_ST_H -DHAVE_UTILS_ARRAY_H -I/usr/postgresql-8.3.4/include/server  -D_FILE_OFFSET_BITS=64  -fPIC -fno-strict-aliasing -g -g -O2  -fPIC  -DHAVE_RB_HASH_DELETE -DHAVE_RB_INITIALIZE_COPY -DPG_UTILS_ARRAY -DPG_PL_TRYCATCH -DPG_PL_VERSION=83 -DPLRUBY_CALL_HANDLER=plruby_call_handler -DPLRUBY_VALIDATOR=plruby_validator  -c plplan.c
gcc -I. -I. -I/usr/lib/ruby/1.8/x86_64-linux -I. -DHAVE_CATALOG_PG_PROC_H -DHAVE_RB_HASH_DELETE -DHAVE_ST_H -DHAVE_UTILS_ARRAY_H -I/usr/postgresql-8.3.4/include/server  -D_FILE_OFFSET_BITS=64  -fPIC -fno-strict-aliasing -g -g -O2  -fPIC  -DHAVE_RB_HASH_DELETE -DHAVE_RB_INITIALIZE_COPY -DPG_UTILS_ARRAY -DPG_PL_TRYCATCH -DPG_PL_VERSION=83 -DPLRUBY_CALL_HANDLER=plruby_call_handler -DPLRUBY_VALIDATOR=plruby_validator  -c plpl.c
gcc -I. -I. -I/usr/lib/ruby/1.8/x86_64-linux -I. -DHAVE_CATALOG_PG_PROC_H -DHAVE_RB_HASH_DELETE -DHAVE_ST_H -DHAVE_UTILS_ARRAY_H -I/usr/postgresql-8.3.4/include/server -D_FILE_OFFSET_BITS=64  -fPIC -fno-strict-aliasing -g -g -O2  -fPIC  -DHAVE_RB_HASH_DELETE -DHAVE_RB_INITIALIZE_COPY -DPG_UTILS_ARRAY -DPG_PL_TRYCATCH -DPG_PL_VERSION=83 -DPLRUBY_CALL_HANDLER=plruby_call_handler -DPLRUBY_VALIDATOR=plruby_validator  -c pltrans.c
gcc -shared -o plruby.so plruby.o plplan.o plpl.o pltrans.o -L. -L/usr/lib -L/usr/postgresql-8.3.4/lib -L. -Wl,-Bsymbolic -rdynamic -Wl,-export-dynamic -lruby  -lpthread -ldl -lcrypt -lm -lc 
```

将上面构建的 '.so' 文件放在动态库路径 ($libdir) [使用 `pg_config --pkglibdir`给定（在我的情况下）/usr/postgresql-8.3.4/lib 确定]

采用这种方法的其他人很可能不得不自己进行调整。

添加这些功能...

```
CREATE OR REPLACE FUNCTION plruby_call_handler()
  RETURNS language_handler AS
'$libdir/plruby', 'plruby_call_handler'
  LANGUAGE 'c' VOLATILE
  COST 1;
ALTER FUNCTION plruby_call_handler() OWNER TO postgres;

CREATE OR REPLACE FUNCTION plruby_validator(oid)
  RETURNS void AS
'$libdir/plruby', 'plruby_validator'
  LANGUAGE 'c' VOLATILE
  COST 1;
ALTER FUNCTION plruby_validator(oid) OWNER TO postgres; 
```

添加“plruby”作为程序语言

```
CREATE PROCEDURAL LANGUAGE 'plruby' HANDLER plruby_call_handler; 
```

测试它：

```
CREATE FUNCTION ruby_max(int4, int4) RETURNS text AS '
    if args[0].to_i > args[1].to_i
        return "The one on the left is bigger"
    else
        return "The one on the right is bigger"
    end
' LANGUAGE 'plruby';

select ruby_max(8, 9); 
```

还有其他构建选项可以启用类型“转换”。上面的构建是最简单的构建，所有函数参数实际上都是作为字符串进入 ruby​​ 的（即使它们被声明为 int4）。因此这里需要'to_i'调用。

# objective-c - 在Objective-C中将一个类的实例转换为@protocol

> ID：617616
> 
> 赞同：106
> 
> 时间：2009-03-06T03:32:24.593
> 
> 标签：objective-c, protocols

我有一个对象（UIViewController），它可能符合也可能不符合我定义的协议。

我知道我可以确定对象是否符合协议，然后安全地调用该方法：

```
if([self.myViewController conformsToProtocol:@protocol(MyProtocol)]) {
    [self.myViewController protocolMethod]; // <-- warning here
} 
```

但是，XCode 显示警告：

```
warning 'UIViewController' may not respond to '-protocolMethod' 
```

防止此警告的正确方法是什么？我似乎无法`self.myViewController`作为一个`MyProtocol`班级。

* * *

## 回答 #1

> 赞同：177
> 
> 时间：2010-11-26T01:47:56.103

这样做的正确方法是：

```
if ([self.myViewController conformsToProtocol:@protocol(MyProtocol)])
{
        UIViewController <MyProtocol> *vc = (UIViewController <MyProtocol> *) self.myViewController;
        [vc protocolMethod];
} 
```

`UIViewController <MyProtocol> *`类型转换转换为“vc 是符合 MyProtocol 的 UIViewController 对象”，而 using转换`id <MyProtocol>`为“vc 是符合 MyProtocol 的未知类的对象”。

这样，编译器将为您提供正确的类型检查- 如果任何未在其中声明或调用`vc`的方法，编译器只会给您一个警告。仅应在您不知道要转换的对象的类/类型的情况下使用。`UIViewController``<MyProtocol>``id`

* * *

## 回答 #2

> 赞同：63
> 
> 时间：2009-03-06T03:38:17.903

你可以像这样投射它：

```
if([self.myViewController conformsToProtocol:@protocol(MyProtocol)])
{
    id<MyProtocol> p = (id<MyProtocol>)self.myViewController;
    [p protocolMethod];
} 
```

这也让我有点失望。在 Objective-C 中，协议不是类型本身，因此您需要指定`id`（或其他类型，例如`NSObject`）以及所需的协议。

# algorithm - 缩放图像以完全填充边界框

> ID：617623
> 
> 赞同：8
> 
> 时间：2009-03-06T03:36:16.940
> 
> 标签：algorithm, image, image-scaling

例如，如果我需要填充 100px 宽 x 50px 高的边界框，以下输入图像将具有以下行为：

1.  200w x 200h 缩小了 50%，顶部和底部减少了 25%。

2.  200w x 100h 在没有裁剪的情况下缩小了 50%。

3.  100w x 200h 没有缩放，但 75px 被切掉顶部和底部。

这似乎是一个常见的调整大小功能，但我无法找到该算法的示例。

将接受任何语言的答案，包括伪代码。带有答案的页面的链接也很棒！

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-06T03:41:11.673

你要的很简单。计算宽度和高度的不同比例因子，然后为您的实际比例因子选择较大的比例因子。将您的输入大小乘以比例，然后裁剪任何一个太大。

```
scale = max(maxwidth/oldwidth, maxheight/oldheight)
scaledwidth = oldwidth * scale
scaledheight = oldheight * scale
if scaledheight > maxheight:
    croptop = (scaledheight - maxheight) / 2
    cropbottom = (scaledheight - maxheight) - croptop
if scaledwidth > maxwidth:
    cropleft = (scaledwidth - maxwidth) / 2
    cropright = (scaledwidth - maxwidth) - cropleft 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-06T03:45:19.400

在这里，我们确保仅在 X 大于 100% 时进行缩放；然后在我们完成之后，我们确保我们在 Y 上只有 50 像素。如果我们大于 50，那么我们将差值除以 2 以获得从顶部/底部移除的数量。

```
double percent_x = 1.0;

if(X > 100) {
 percent_x = (float)100/X;
 X *= percent_x;
 Y *= percent_x;
}

int diff_y;
int top_cut, bott_cut;
if( Y > 50 ) {
 diff_y = (Y - 50) / 2;
 top_cut = bott_cut = diff_y;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-08-27T00:37:50.253

**很大程度上**受到 Mark Ransom 的回答的启发（非常感谢 - 你救了我）。对于任何想要在*不*裁剪图像的情况下执行此操作的人（刚好适合范围内），我发现这可行：

```
if (maxWidth > width && maxHeight > height) {
  return { width, height };
}

aspectRatio = width / height,
scale       = max(maxWidth / width, maxHeight / height);

scaledHeight = height * scale,
scaledWidth  = width * scale;

if (scaledHeight > maxHeight) {
  scaledHeight = maxHeight;
  scaledWidth  = aspectRatio * scaledHeight;
} else if (scaledWidth > maxWidth) {
  scaledWidth  = maxWidth;
  scaledHeight = scaledWidth / aspectRatio;
}

return { scaledHeight, scaledWidth }; 
```

# java - 如何输出缓存文件并进行自定义日志记录 - jboss/java 项目

> ID：617644
> 
> 赞同：0
> 
> 时间：2009-03-06T03:52:24.313
> 
> 标签：java, apache, outputcache

我是一名 .Net 开发人员，他开始在工作中进行越来越多的 Java 开发。我有一个关于缓存的具体问题，希望你们能解决或提供建议。我们正在启动一个 java 项目，该项目将部署在运行 JBoss 的 Linux 机器上。我们正在提前计划并尝试考虑我们的缓存策略。我们想做的一件事是输出缓存页面，因为我们的内容可能会缓存 8 小时左右。我开始查看 mod_cache ，这正是我们想要做的。我需要满足的另一个要求是，对于每个请求，我都需要进行一些自定义日志记录。我需要基本的请求 URL，然后是一些其他业务逻辑的东西，然后将其填充到数据库中。我的问题是：

1) 如何将代码放在 mod_cache 级别以启动自定义日志记录过程？
2）我想以某种方式将这些日志消息排队，因为我不想每次请求都去数据库。解决这个问题的最佳方法是什么？

如果您有任何建议或解决方案，我将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-07T22:53:59.613

我假设您计划的设置是 Apache httpd -> mod_cache -> mod_proxy/mod_jk -> JBoss

1）你不能，因为 Apache 级别的 mod_cache 甚至没有开始调用 Java。因此，您需要检查 mod_cache 本身是否有一些可以挂钩的日志记录工具，或者您需要修改 mod_cache 并重新编译它。这与 Java 无关，我认为你不能在 Java 中做到这一点。

2) 同样，当 mod_cache 自己处理响应而不调用 JBoss 时，这不是 Java 问题。

JBoss/Catalina/Tomcat 在交付由 JSP 或其他 Web 框架呈现的页面时非常快。设置缓存过期日期，让浏览器处理缓存。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-26T00:28:55.350

您可能会考虑改用 memcached。我不知道这个程序是否有 Tomcat/JBoss 包装模块。它可以让您缓存几乎所有可以序列化并为其创建字符串键值的数据。

你必须为你需要的东西编写一个访问器，它试图从 memcached 进程中提取东西，和/或在缓存未命中时调用生成器函数（以及缓存生成器的结果）。在此访问器中，您可以记录缓存命中和未命中。

当然，memcached 守护进程是用 C 语言编写的，因此它不会像 java（或大多数其他“现代”语言运行时）那样“标记和扫描”自己死持有数据。

另一方面，也许 mod_cache 有一些日志钩子。也许您应该研究一下，因为这将减轻您的 java 进程的负载。

这是否接近您正在寻找的那种东西？

# php - 这是 PDO“好代码”的包装器吗？有没有潜在的问题？

> ID：617646
> 
> 赞同：5
> 
> 时间：2009-03-06T03:55:41.450
> 
> 标签：php, refactoring, pdo

我构建了这个类来使用 PDO，使 SQL 查询“更容易”并且不用担心。

这是我的想法

*   它应该更像 DB 类扩展 PDO 吗？
*   查询方法是否太大？是否应该将其拆分为称为的私有方法..这就是所谓的*松散耦合*吗？
*   我检测 SELECT 查询的方式是否太丑陋了？
*   还有哪些明显的问题？由于我是在边学习边学习，我敢肯定我可能会忽略很多潜在的问题。

谢谢

`

```
 class Db
 {
    private static $_instance = NULL;

    private function __construct() {

        // can not call me
    }

    private function __clone() {

        // no!
    }

    public static function getInstance() {

        if (!self::$_instance)
        {

            try {

                self::$_instance = new PDO('mysql:host=' . CONFIG_MYSQL_SERVER . ';dbname=' . CONFIG_MYSQL_DATABASE, CONFIG_MYSQL_USERNAME, CONFIG_MYSQL_PASSWORD);;
                self::$_instance-> setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);

            } catch(PDOException $e) {

                trigger_error($e->getMessage());

            }

        }

        return self::$_instance;

    }

    public static function query($query /*string*/, $bindings = NULL)
    {

        $queryPortion = substr($query,0, 6);

        try {

            if ($bindings) {

                    $prepared = self::getInstance()->prepare($query);

                    foreach($bindings as $binding=>$data) { // defaults to string

                        if (!is_array($data)) {
                            $prepared->bindParam($binding, $data); 

                        } else {

                            switch(count($data)) {

                                case 1:
                                    $prepared->bindParam($binding, $data['value']);
                                    break;                          

                                case 2:
                                    $prepared->bindParam($binding, $data['value'], $data['dataType']);
                                    break;

                                case 3:
                                    $prepared->bindParam($binding, $data['value'], $data['dataType'], (int)$data['length']);
                                    break;                          

                                default:
                                    trigger_error('An error has occured with the prepared statement bindings.');
                                    return false;
                                    break;
                            }
                        }

                    }

                    $prepared->execute();

                    return $prepared->fetchAll(PDO::FETCH_ASSOC);

            } else if (String::match($queryPortion, 'select')) { // if this is a select query

                $rows = self::getInstance()->query($query);

                return $rows->fetchAll(PDO::FETCH_ASSOC);

            } else {

                return self::getInstance()->exec($query);

            }

        } 
        catch(PDOException $e)
        {
            trigger_error($e->getMessage());
        }

    }

    public static function getLastInsertId()
    {
        try {
            self::getInstance()->lastInsertId();
          }
        catch(PDOException $e)
        {
            trigger_error($e->getMessage());
        }

    }

    public static function disconnect()
    {
        // kill PDO object
        self::$_instance = NULL;

    }
 } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-06T04:33:25.073

这还不错，正如人们所说，它可能对小型应用程序有所帮​​助，尽管它主要是对另一个抽象的非常薄的抽象。它没有带来很多其他功能。

除其他事项外，您可能需要考虑以下事项：

*   由于这是 PHP5 代码，请使用[异常](http://www.php.net/exceptions)代替，`trigger_error`如有[`set_exception_handler`](http://www.php.net/manual/en/function.set-exception-handler.php)必要，直到异常更普遍，但它绝对更干净，更面向未来。
*   您正在使用单例，这不一定是一件坏事，但在这种情况下，例如，一个缺点是您只能处理一个到一个数据库的连接。
*   我不知道您是否使用存储过程，但是存储过程也可能通过该方法[返回结果集](http://publib.boulder.ibm.com/infocenter/db2luw/v9/index.jsp?topic=/com.ibm.db2.udb.apdv.php.doc/doc/t0023501.htm)`query()`。
*   行尾有两个分号 ( `;;`) `new PDO`。

话虽如此，我认为您的查询方法并不太大，目前从那里的其他地方也没有太多可以回忆的东西。尽管一旦您看到可以从另一个函数调用的两三行代码，请将其拆分。[这是DRY](http://en.wikipedia.org/wiki/DRY)的好方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-06T04:11:01.680

是和否。

对于简单的快速而肮脏的应用程序来说，这是一个很好的代码。

当您在更复杂的结构化应用程序中使用它时，就会出现问题。错误处理的位置取决于您正在执行的 sql。

此外，任何严重错误都将显示为“第 999 行的问题”类型错误，其中 999 在您的超级骗子例程中，您将难以将其追溯到特定的 sql 请求。

话虽如此，我一直在自己的小项目上做这种事情。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-06T05:10:10.867

这是我使用的（只需用 $GLOBALS['db_conf'] 或其他东西替换对 Zzz_Config 的引用）：

```
/**
 * Extended PDO with databse connection (instance) storage by name.
 */
class Zzz_Db extends PDO
{
    /**
     * Named connection instances.
     *
     * @var array
     */
    static private $_instances;

    /**
     * Retrieves (or instantiates) a connection by name.
     *
     * @param  string $name  Connection name (config item key).
     * @return Zzz_Db        Named connection.
     */
    static public function getInstance($name = null)
    {
        $name = $name === null ? 'db' : "db.$name";
        if (!isset(self::$_instances[$name])) {
            if (!$config = Zzz_Config::get($name)) {
                throw new RuntimeException("No such database config item: $name");
            }
            if (!isset($config['dsn'])) {
                if (!isset($config['database'])) {
                    throw new RuntimeException('Invalid db config');
                }
                $config['dsn'] = sprintf('%s:host=%s;dbname=%s',
                    isset($config['adapter']) ? $config['adapter'] : 'mysql',
                    isset($config['host']) ? $config['host'] : 'localhost',
                    $config['database']);
            }

            $db = self::$_instances[$name] = new self(
                $config['dsn'],
                isset($config['username']) ? $config['username'] : null,
                isset($config['password']) ? $config['password'] : null);
            $db->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
            //$db->setAttribute(PDO::ATTR_STATEMENT_CLASS, 'Zzz_Db_Statement');

            if ($db->getAttribute(PDO::ATTR_DRIVER_NAME) == 'mysql') {
                $db->setAttribute(PDO::ATTR_EMULATE_PREPARES, true);
                $db->exec('SET CHARACTER SET utf8');
            }
        }

        return self::$_instances[$name];
    }
} 
```

用法应该是：

```
$db = Zzz_Db::getInstance(); // or Zzz_Db::getInstance('some_named_db')
$stmt = $db->prepare('SELECT ... 
```

目标是将 db 配置保存在 *.ini 文件中（可由非编码人员编辑）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-09T03:21:17.403

`prepare()`我采取了另一种方式，并创建了一个类，该类使用/周围的一堆包装函数来扩展 PDO `execute()`，它比内置函数好得多（尽管这有点主观......）。

另一件事：除非您使用的是真正旧版本的 mysql (<=4.0) ，否则您应该设置`PDO::ATTR_EMULATE_PREPARES`为。`false`它默认为`true`，这是一个非常令人头疼的问题，并导致事情以模糊的方式中断......我猜这就是你首先拥有一个巨大的包装的原因`bindParam()`。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-06T18:16:33.847

要回答你的问题，如果它是一个好代码，问问你自己：
与直接使用 PDO 相比，我的代码的附加值是什么？

如果您找到一个好的答案，请使用您的代码。如果没有，我会坚持使用 PDO。

还可以尝试考虑实现[Zend Framework](http://framework.zend.com)的 DB 类，它可以独立工作并支持 PDO。

# javascript - 我在 JavaScript 中的 rot13 实现哪里出错了？

> ID：617647
> 
> 赞同：28
> 
> 时间：2009-03-06T03:58:19.900
> 
> 标签：javascript, algorithm, rot13

有问题的代码在此处突出显示语法：[通过 Friendpaste](http://friendpaste.com/7EbFwfzYSemBxmL2u5879f)

rot13.js：

> 错误
> 
> ```
> <script>
> String.prototype.rot13 = rot13 = function(s)
>  {
>     return (s = (s) ? s : this).split('').map(function(_)
>      {
>         if (!_.match(/[A-Za-z]/)) return _;
>         c = Math.floor(_.charCodeAt(0) / 97);
>         k = (_.toLowerCase().charCodeAt(0) - 96) % 26 + 13;
>         return String.fromCharCode(k + ((c == 0) ? 64 : 96));
>      }).join('');
>  };
> </script> 
> ```

正如您所看到的，使用非常简单的一行将一个方法附加到 String 对象（一个原型设计），我有一个我之前设置的 map() 方法（我确信该代码可以完美运行；它只是遍历数组中的每个元素并应用参数中指定的函数）遍历字符串中的每个字符并执行我认为正确的计算以将字符串转换为它的 rot13'd 对应物。可悲的是，我错了。谁能发现我哪里出错了？

* * *

## 回答 #1

> 赞同：77
> 
> 时间：2009-03-06T04:32:26.870

您可以使用超短：

```
s.replace(/[a-zA-Z]/g,function(c){return String.fromCharCode((c<="Z"?90:122)>=(c=c.charCodeAt(0)+13)?c:c-26);}); 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2015-02-13T00:04:39.607

这是使用`replace`和`indexOf`功能的解决方案：

```
function rot13(s) {
  return s.replace(/[A-Z]/gi, c =>
    "NOPQRSTUVWXYZABCDEFGHIJKLMnopqrstuvwxyzabcdefghijklm"[
    "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".indexOf(c) ] )
} 
```

这由以下部分组成：

*   `/[A-Z]/gi`仅匹配字符的正则表达式
*   `replace`用于替换那些字符
*   一个写成箭头函数的替换函数
*   `indexOf`是将字符转换为数字查找索引
*   我们在替换数组中查找索引，我们就完成了

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2013-04-01T17:06:07.437

这给出了正确的结果。

```
function rot13(s)
 {
    return (s ? s : this).split('').map(function(_)
     {
        if (!_.match(/[A-Za-z]/)) return _;
        c = Math.floor(_.charCodeAt(0) / 97);
        k = (_.toLowerCase().charCodeAt(0) - 83) % 26 || 26;
        return String.fromCharCode(k + ((c == 0) ? 64 : 96));
     }).join('');
 }

 alert(rot13(rot13("Mark this as accepted answer :)")));
```

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2013-01-27T22:47:11.623

仅仅因为它更短，也更容易理解/合乎逻辑：

```
function rot13(s) {
  return s.replace( /[A-Za-z]/g , function(c) {
    return String.fromCharCode( c.charCodeAt(0) + ( c.toUpperCase() <= "M" ? 13 : -13 ) );
  } );
} 
```

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2014-04-26T22:05:11.603

Kevin M 的解决方案紧凑而优雅。但是，它有一个小错误：与替换函数一起使用的正则表达式不会将替换限制为字母字符。`[A-z]`字符范围包括标点符号 ( )，当`[``\``] ^ _ ``它们应该单独放置时，它们将被交换为字母。

固定版本如下所示：

```
function r(a,b){return++b?String.fromCharCode((a<"["?91:123)>(a=a.charCodeAt()+13)?a:a-26):a.replace(/[a-zA-Z]/g,r)} 
```

它仍然只有 116 个字节。非常小而且非常聪明。

（很抱歉发布完整的答案；我仍然缺少 50 个代表来发布此作为对凯文出色答案的评论。）

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-03-06T04:31:25.810

```
var rot13 = String.prototype.rot13 = function(s)
{
  return (s = (s) ? s : this).split('').map(function(_)
  {
    if (!_.match(/[A-Za-z]/)) return _;
    c = _.charCodeAt(0)>=96;
    k = (_.toLowerCase().charCodeAt(0) - 96 + 12) % 26 + 1;
    return String.fromCharCode(k + (c ? 96 : 64));
  }
  ).join('');
};

alert('abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ'.rot13());
yields nopqrstuvwxyzabcdefghijklmNOPQRSTUVWXYZABCDEFGHIJKLM 
```

混合从零开始和从一开始的指数损失。我责怪网景。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2014-03-13T01:07:13.290

这是一个 80 列的版本，不更新 string.prototype，缩进良好且相当短。

```
function rot13(str) {
  return str.replace(/[a-zA-Z]/g, function(chr) {
    var start = chr <= 'Z' ? 65 : 97;
    return String.fromCharCode(start + (chr.charCodeAt(0) - start + 13) % 26);
  });
} 
```

还有一个例子表明它正在工作：

```
rot13('[abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ]')
"[nopqrstuvwxyzabcdefghijklmNOPQRSTUVWXYZABCDEFGHIJKLM]"
rot13(rot13('[abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ]'))
"[abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ]" 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2014-01-05T05:09:35.373

116 字节的单行：

```
function r(a,b){return++b?String.fromCharCode((a<"["?91:123)>(a=a.charCodeAt()+13)?a:a-26):a.replace(/[a-zA-Z]/g,r)} 
```

用法：

`r('The Quick Brown Fox Jumps Over The Lazy Dog.');`

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2015-01-31T15:23:28.377

仍有改进的空间，检查 (c<="Z") 实际上是对代码点的检查（我们稍后需要），遵循这个想法给了我们胜利！

//与 Kevin M 的风格相比：115 个字符（对 116 个）
//102 个字符与 nodejs 缓冲区（见下文）

```
function r(a,b){return++b?String.fromCharCode(((a=a.charCodeAt())<91?78:110)>a?a+13:a-13):a.replace(/[a-zA-Z]/g,r)}
//nodejs style
function r(a,b){return++b?Buffer([((a=Buffer(a)[0])<91?78:110)>a?a+13:a-13]):a.replace(/[a-zA-Z]/g,r)} 
```

//与 Ben Alpert 风格相比：107 个字符（对 112 个）
//93 个字符与 nodejs 缓冲区（见下文）

```
s.replace(/[a-zA-Z]/g,function(a){return String.fromCharCode(((a=a.charCodeAt())<91?78:110)>a?a+13:a-13)});
//nodejs style
s.replace(/[a-zA-Z]/g,function(a){return Buffer([((a=Buffer(a)[0])<91?78:110)>a?a+13:a-13])}) 
```

// 相同的代码，为生产而格式化

```
String.prototype.rot13 = function() {
  return this.replace(/[a-zA-Z]/g, function(a){
    return String.fromCharCode(((a=a.charCodeAt())<91?78:110)>a?a+13:a-13);
  });
} 
```

在 nodejs 中，您可以使用 Buffer 来转换/序列化代码点，例如：

```
var a=65;
""+Buffer([a])           == "A" // note that the cast is done automatically if needed
String.fromCharCode(a)   == "A"

var b="A";
Buffer(a)[0]             == 65
a.charCodeAt()           == 65 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2017-01-03T03:03:47.537

我打高尔夫球的版本是 82 字节长（与 Ben Albert 相比，它重 35%，但启发了我的）：

`S.replace(/[a-z]/gi,c=>String.fromCharCode((c=c.charCodeAt())+((c&95)>77?-13:13)))`

差异：

*   不区分大小写以仅捕获英文字母。
*   没有返回和大括号的箭头函数。
*   从 charCodeAt 中删除参数。
*   针对插入字符串的代码进行测试。
*   做+13-26=-13。
*   针对 77（78+13=91，溢出）测试大写 ( `&95`)。

* * *

额外：如果要对数字执行 ROT5，请添加： `.replace(/\d/gi,c=>(c>4?-5:5)+c*1)`

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2017-01-13T05:11:54.257

在这里结合各种技术，我想出了这个 78 个字符的 JavaScript ES6 函数，它适用于 Node：

```
rot13=s=>s.replace(/[a-z]/ig,c=>Buffer([((d=Buffer(c)[0])&95)<78?d+13:d-13])); 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2014-06-16T10:39:18.360

这是一个执行 ROT-n 字母替换的 JavaScript 库：[https ://github.com/mathiasbynens/rot](https://github.com/mathiasbynens/rot)

> *rot*是一个执行旋转字母替换的 JavaScript 库。它可用于将输入字符串中的任何 ASCII 字母移动字母表中给定数量的位置。对于 ROT-13 字符串`'abc'`，例如：
> 
> ```
> // ROT-13 is the default
> rot('abc');
> // → 'nop'
> 
> // Or, specify `13` explicitly:
> rot('abc', 13);
> // → 'nop' 
> ```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2016-05-26T00:12:29.593

这绝不是试图与这里的优秀东西竞争，正如你所见，我无法发表评论，但我有自己的新手尝试用 JS 编写它并在我在这里阅读更优雅的解决方案之前让它工作 - 我是将在这里分享。

我试着用`indexOf`, a `switch`, 加上 13,`String.fromCharCode()`和来写它`CharCodeAt()`。他们变得太长了——这个中的辅助函数是不必要的，但这是我最短的:)

```
function rot13(string) { 
  var result = '', 
      store,
      str = string.toLowerCase();  

  //helper function
  function strgBreak(a){
    var result = [];
    return result = a.split('');
  }

  //rot13 arrays
  var alphArr = strgBreak('abcdefghijklmnopqrstuvwxyz');
  var inverseArr = strgBreak('nopqrstuvwxyzabcdefghijklm');

 for ( var i = 0; i < str.length; i++ ) {
     if (alphArr.indexOf( str[i] ) !== -1) {
        result += inverseArr[ alphArr.indexOf( str[i] ) ];
    } else result += str[i];
  }
 return result.toUpperCase(); 
} 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2018-10-25T02:43:37.287

这是 ROT13 替换密码的现代方法：

```
const ROT13 = s =>
  s.replace(/[a-z]/gi, c =>
    String.fromCharCode(c.charCodeAt() + 13 - 26 * /[n-z]/i.test(c)));

console.log(ROT13('The quick brown fox jumps over 13 lazy dogs.'));
```

* * *

上面测试用例的结果是：

**Gur dhvpx oebja sbk whzcf bire 13 ynml qbtf。**

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-03-06T16:06:37.013

虽然我*真的很*喜欢 RegEx 解决方案，但我主要负责这个项目，看看我是否能完成它。很高兴地报告我终于做到了：

```
String.prototype.rot13 = rot13 = function(s)
 {
    return (s ? s : this).split('').map(function(_)
     {
        if (!_.match(/[A-za-z]/)) return _;
        c = Math.floor(_.charCodeAt(0) / 97);
        k = (_.toLowerCase().charCodeAt(0) - 83) % 26 || 26;
        return String.fromCharCode(k + ((c == 0) ? 64 : 96));
     }).join('');
 } 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2015-09-28T19:58:14.760

@ben-alpert[答案](https://stackoverflow.com/a/617685/1320932)的 CoffeeScript 版本：

```
string.replace /[a-zA-Z]/g, (c) -> String.fromCharCode if (if c <= 'Z' then 90 else 122) >= (c = c.charCodeAt(0) + 13) then c else c - 26 
```

或作为函数：

```
ROT13 = (string) -> string.replace /[a-zA-Z]/g, (c) -> String.fromCharCode if (if c <= 'Z' then 90 else 122) >= (c = c.charCodeAt(0) + 13) then c else c - 26
ROT13('asd') # Returns: 'nfq' 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2020-04-15T06:12:28.730

我最喜欢且易于理解的决策 ROT13 版本

```
function rot13(message) {
  var a = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"
  var b = "nopqrstuvwxyzabcdefghijklmNOPQRSTUVWXYZABCDEFGHIJKLM"
  return message.replace(/[a-z]/gi, c => b[a.indexOf(c)])
} 
```

`a`- 经典字母表，`b`- 带有第 13 个替换的字典，`return`简单的 RegEx 替换结果

# delphi - WriteLn() 是如何工作的？

> ID：617654
> 
> 赞同：12
> 
> 时间：2009-03-06T04:04:37.920
> 
> 标签：delphi, arguments

自恐龙时代以来，Turbo Pascal 和现在的 Delphi 都有一个 Write() 和 WriteLn() 程序，它们可以安静地做一些简洁的事情。

*   参数的数量是可变的；

*   每个变量可以是各种类型；您可以提供整数、双精度、字符串、布尔值，并以任意顺序将它们混合在一起；

*   您可以为每个参数提供附加参数：

> 写（'你好'：10，'世界！'：7）；//对齐参数

*   它甚至以一种特殊的方式出现在代码完成下拉菜单中：
    *   写 ([var F:File]; P1; [...,PN] )
    *   WriteLn ([var F:File]; [ P1; [...,PN]] )

现在我正在输入这个，我注意到 Write 和 WriteLn 在代码完成下拉列表中没有相同的括号。因此，看起来这不是自动生成的，而是有人硬编码的。

无论如何，我是否能够自己编写这样的程序，或者所有这些都是一些神奇的硬编码编译器诡计？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-03-06T04:40:03.870

Writeln 就是我们所说的编译器“魔术”函数。如果您在 System.pas 中查找，您将找不到一个被声明为您所期望的任何内容的 Writeln。编译器从字面上将其分解为对各种特殊运行时库函数的单独调用。

简而言之，在不修改编译器的情况下，没有办法实现您自己的版本，它与内置的 writeln 做所有相同的事情。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-06T06:59:58.747

正如艾伦所说，您不能编写自己的函数来完成所有相同的事情。

但是，您可以编写一个执行自定义操作的文本文件驱动程序，并在使用标准 Write(ln) 写入您的文本文件驱动程序时。我们在过去的 DOS 时代就这样做了：）

（前面语句上下文中的“驱动程序”只是一段 Pascal 代码，它通过切换系统单元 IIRC 中的指针连接到系统中。自从我上次使用这个技巧以来已经很久了。）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-06T04:43:39.337

据我所知，帕斯卡标准不包括可变参数。

话虽如此，IIRC，GNU Pascal 让我们这样说：Procecdure Foo(a: Integer; b: Integer; ...);

尝试在编译器的语言文档中搜索“变量参数列表”或“一致性数组”。这是后者的示例：[http](http://www.gnu-pascal.de/demos/conformantdemo.pas) ://www.gnu-pascal.de/demos/conformantdemo.pas 。

正如上一张海报所说， writeln() 很神奇。我认为问题与堆栈如何在帕斯卡函数中组装有关，但是自从我考虑堆栈上的位置以来已经有很长时间了:)

但是，除非您正在编写“writeln”函数（已经编写好了），否则您可能*不需要*实现带有变量参数的过程。尝试迭代或递归:)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-01-08T02:10:22.727

这是神奇的编译器行为，而不是常规过程。不，没有办法编写这样的子例程（不幸的是！）。代码生成解析实际参数及其类型的计数，并在编译时转换为适当的 RTL 调用（例如**Str()**）。这反对经常建议**的 const 数组**（实际上是单个变量数组形式参数）导致在运行时执行相同的操作。我发现后来的方法很笨拙，它在一定程度上损害了代码的可读性，并且 Bugland（Borland/Inprise/Codegear/Embarcadero/name it）破坏了变体开放数组构造函数的 Code Insight（是的，我很在意，我使用 OutputDebugString(PChar(Format ('...', [...])))) 和代码完成在那里不能正常工作（或根本不能）。因此，模拟魔术行为的最接近的方法是声明许多重载子例程（实际上很多，每个特定形式参数类型在特定位置一个）。也可以称其为 kludge，但这是获得可变参数列表灵活性的唯一方法，并且可以隐藏在单独的模块中。

PS：我故意忽略了格式说明符，因为语法不允许分号在**Str()**、**Write()**和**Writeln()**接受它们的地方使用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-06T05:42:03.130

是的，您可以在 Delphi 和朋友（例如 free pascal、Kylix 等）中做到这一点，但不能在更“标准”的 pascal 中做到这一点。查找变体开放数组参数，这些参数与以下语法一起使用：

```
procedure MyProc(args : array of const); 
```

（已经有几年了，我手头没有手册，所以在继续之前检查详细信息）。这为您提供了一个开放数组`TVarData`（或类似的东西），您可以从中提取 RTTI。

不过请注意：我认为您无法匹配 x:y 格式化语法（这是特殊的），并且可能必须使用稍微冗长的包装器。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-06T08:02:51.760

大部分已经说了，但我想补充一些东西。

首先，您可以使用格式功能。将几乎任何类型的变量转换为字符串并控制其大小都很棒。虽然它有缺点：

```
myvar := 1;
while myvar<10000 do begin
  Memo.Lines.Add(Format('(%3d)', [myVar]));
  myvar := myvar * 10;
end; 
```

产生：

```
(  1)
( 10)
(100)
(1000) 
```

所以尺寸是最小尺寸（就像 :x:y 结构一样）。

要获得最少数量的变量参数，您可以使用默认参数和重载函数：

```
procedure WriteSome(const A1: string; const A2: string = ''; const A3: string = ''); 
```

或者

```
procedure WriteSome(const A1: string); overload;
procedure WriteSome(const A1: Integer); overload; 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-06T08:56:55.767

你不能用旧的 Pascal 编写自己的 write/writeln。它们是由编译器、格式化、对齐等生成的。这就是为什么一些程序员喜欢 C 语言，甚至是灵活的标准函数，例如 printf、scanf，都可以由任何有能力的程序员实现。

如果您倾向于创建比 C 供应商实现的更高性能的东西，您甚至可以为 C 创建相同的 printf 函数。它们中没有魔术，您的代码只需要“遍历”变量参数。

附言

但正如 MarkusQ 所指出的，Pascal 的一些变体（Free Pascal、Kylix 等）可以促进可变参数。自 DOS 时代以来，我最后一次修补 Pascal，Turbo Pascal 7。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-02T12:32:04.600

Writeln 不是基于“const 数组”，而是由编译器分解为各种调用，这些调用将参数转换为字符串，然后调用原语 writestring。“LN”只是一个将 lineending 写入字符串的函数。（取决于操作系统）。原语的过程变量（函数指针）是文件类型（Textrec/filerec）的一部分，这就是它们可以定制的原因。（例如TP中的AssignCrt）

如果 {$I+} 模式打开，则在每个元素之后，都会调用 iocheck 函数。

上面制作的 GPC 构造是无限的 C 开放数组。FPC（和 afaik Delphi 也是）也支持这一点，但语法不同。

过程 somehting (a:array of const);cdecl;

将被转换为与 C、printf 样式兼容的 ABI。这意味着相关函数（在这种情况下为somehting）无法获取参数的数量，而必须依赖格式字符串解析。所以这与 const 数组不同，后者是安全的。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-01-09T10:18:46.233

虽然不是直接回答您的问题，但我想添加以下评论：我最近使用 Writeln(...) 语法将一些代码重写为使用 StringList，用 Format(...) 填充“行”和只是普通的 IntToStr(...)、FloatToStr(...) 函数等。

这种变化的主要原因是速度的提高。使用 StringList 和 SaveFileTo 比 WriteLn、Write 组合快得多。

如果您正在编写一个创建大量文本文件的程序（我正在研究一个网站创建程序），这会产生很大的不同。

# java - 如何将资源指定为不翻译？

> ID：617663
> 
> 赞同：1
> 
> 时间：2009-03-06T04:11:47.107
> 
> 标签：java, localization, internationalization

我从事 Java 软件的本地化工作，我的项目既有 .properties 文件也有 XML 资源。我们目前使用注释来指示翻译人员不要翻译某些字符串，但注释的问题是它们不是机器可读的。

我能想到的唯一解决方案是在每个不翻译键前面加上类似的东西，`_DNT_`并训练我们的翻译工具忽略这些条目。有没有人有更好的主意？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-06T04:17:32.567

你能把文件分成要翻译的文件或不翻译的文件，然后只发送要翻译的文件吗？（不知道结构，所以在回答是否实用时很难知道......）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-06T07:45:49.180

Eclipse JDT 还使用注释来防止某些字符串的翻译：

[如何编写面向国际市场的 Eclipse 插件](http://www.ibm.com/developerworks/library/os-i18n/)

我认为您的翻译工具应该以类似的方式工作？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-06T08:10:36.360

就像在他的链接中发布的 axelclk... eclipse 提供了一个

//$非NLS-1$

通知项目此行中的第一个字符串不应翻译的语句。您可以通过调用 Source->Externalize Strings 找到所有其他字符串

外部字符串包括您想要支持的所有语言。

包含如下翻译的文件：PluginPage.Error1 = text1 PluginPage.Error2 = text2

读翻译的班级

```
private static final String BUNDLE_NAME = "com.plugin.name"; //$NON-NLS-1$

    private static final ResourceBundle RESOURCE_BUNDLE = ResourceBundle.getBundle(BUNDLE_NAME);

    private PluginMessages() {
    }

    public static String getString(String key) { 
        // TODO Auto-generated method stub
        try {
            return RESOURCE_BUNDLE.getString(key);
        } catch (MissingResourceException e) {
            return '!' + key + '!';
        }
    } 
```

你可以这样称呼它：

```
String msg = PluginMessages.getString("PluginPage.Error2"); //$NON-NLS-1$ 
```

**编辑：**

当字符串被外部化并且您想使用原始字符串时，您可以从所有属性文件中删除外部化字符串，而不是默认字符串。当 Bundle 找不到与本地语言匹配的消息文件时，使用默认值。

但这在运行时不起作用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-06T12:32:23.283

最简单的解决方案是不在资源文件中放置不翻译字符串 (DNT)。

*.properties*文件在元数据处理方面提供的不多，并且由于您在运行时不需要数据，因此它在*.properties*文件中的存在将是一种副作用，而不是理想的东西。还要考虑部分 DNT，其中您有无法翻译的内容包含在可翻译的字符串中（例如品牌名称或 URI）。

```
"IDENTIFIER english en en en" -> "french fr IDENTIFIER fr fr" 
```

据我所知，即使像[XLIFF](http://www.ibm.com/developerworks/xml/library/x-localis/)这样的标准也没有考虑 DNT，您必须通过自定义元数据文件、[术语文件](http://www.lisa.org/Standards.30.0.html)和/或注释（例如 XLIFF 中的[注释](http://docs.oasis-open.org/xliff/v1.2/os/xliff-core.html#note)元素）来管理它们。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-29T07:11:45.007

如果您决定在属性文件中使用不翻译注释，我建议您遵循[Eclipse 约定](http://wiki.eclipse.org/Eclipse_Globalization_Guidelines#Non-translatable_Message_Strings)。没什么特别的，但是如果我们都使用相同的魔线，生活会更轻松！

（据我所知，Eclipse 实际上还不支持 DO-NOT-TRANSLATE 注释，但[Tennera Ant-Gettext](https://fedorahosted.org/tennera/)实现了上述方案，用于从资源包转换为 Gettext PO 文件。）

# opengl - OpenGL 中的自引用渲染缓冲区

> ID：617667
> 
> 赞同：0
> 
> 时间：2009-03-06T04:13:36.103
> 
> 标签：opengl, rendering, textures

我有一些 OpenGL 代码在不同硬件上的行为不一致。我有一些代码：

1.  创建渲染缓冲区并将纹理绑定到其颜色缓冲区（纹理 A）
2.  将此渲染缓冲区设置为活动，并调整视口等
3.  激活像素着色器（在本例中为高斯模糊）。
4.  将四边形绘制到全屏，上面带有纹理 A。
5.  取消绑定渲染缓冲区等。

在我的开发机器上，这工作正常，并且具有“就地”模糊纹理的预期效果，但是在其他硬件上这似乎不起作用。

我把它归结为两种可能性。

A）对自己进行渲染缓冲区渲染不应该工作，并且由于某种侥幸而只能在我的开发机器上工作。

或者

B）这种方法应该有效，但还有其他问题。

有任何想法吗？老实说，我很难找到关于这个问题的细节。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-06T07:12:49.590

A) 是正确答案。在读取时渲染到同一个缓冲区是未定义的。它可能有效，也可能无效——这正是正在发生的事情。

在 OpenGL 的情况下，[framebuffer_object 扩展](http://oss.sgi.com/projects/ogl-sample/registry/EXT/framebuffer_object.txt)有“4.4.3 当绑定纹理对象的图像也附加到帧缓冲区时的渲染”部分，它说明了会发生什么（基本上，未定义）。在 Direct3D9 中，如果您使用该设置，调试运行时会大声抱怨（但它可能会根据硬件/驱动程序工作）。我认为，在 D3D10 中，运行时总是取消绑定用作目标的目标。

为什么这是未定义的？GPU 速度如此之快的原因之一是它们可以做出很多假设。例如，他们可以假设获取像素的单元不需要与写入像素的单元通信。因此可以读取表面，N 个周期后读取完成，N 个周期后像素着色器结束执行，然后将其放入 GPU 上的一些输出合并缓冲区，最后在某个点将其写入内存。最重要的是，GPU 以“未定义”顺序光栅化（一个 GPU 可能按行光栅化，另一个以缓存友好的顺序，另一个以完全不同的顺序），所以你不知道表面的哪些部分将被写入到第一。

所以你应该做的是创建几个缓冲区。在模糊/发光的情况下，两个通常就足够了——先渲染，然后在写入第二个时读取和模糊。如果需要以乒乓方式重复此过程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-06T09:54:44.193

在某些特殊情况下，即使是后备缓冲区也可能就足够了。您根本不执行 glClear，并且您之前绘制的内容仍然存在。当然，需要注意的是，您不能真正从后台缓冲区中读取。但是对于像淡入淡出这样的效果，这是可行的。

# python - 寻找一个独立的方程渲染库

> ID：617668
> 
> 赞同：8
> 
> 时间：2009-03-06T04:15:29.110
> 
> 标签：python, parsing, latex, equation, mathml

是否有一个小型的、自包含的库，它将以基于文本的格式（例如 LaTeX 或 MathML）编写的方程呈现为图像（矢量或光栅）？

如果它是 Python 或 Python 友好的，那将是更可取的。

（我发现的一种可能性：[Matplotlib](http://matplotlib.sourceforge.net/)有 Python 代码来解析和显示 LaTeX 方程，使用 gl2ps。如果我没有找到其他任何东西，似乎可以将所有相关位提取到一个单独的库中。）

**编辑：** “自包含”我的意思是他们不能使用 TeX/LaTex 本身，因为不幸的是我不能依赖它被安装

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-06T08:12:08.697

您可以尝试[将 MathML 转换为 SVG](http://www.grigoriev.ru/svgmath/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-06-14T21:03:38.207

有 mimetex 一个用于渲染乳胶数学的独立程序......但是它不是一个库

[http://www.forkosh.com/mimetex.html](http://www.forkosh.com/mimetex.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-06T04:38:27.557

一个通用程序和 Python 模块，允许将 LaTeX 数学方程转换为 PNG 图像：[http](http://code.google.com/p/latexmath2png/) ://code.google.com/p/latexmath2png/ （MIT 许可证，依赖于`dvipng`）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-06T07:06:20.383

我不知道这是否符合您的要求，但我知道 MoinMoin 已经有一段时间的乳胶扩展，所以我再次查看并发现：

[MoinMoin 乳胶支持](http://johannes.sipsolutions.net/Projects/new-moinmoin-latex)

您应该能够获取此代码并在您的应用程序中重新使用它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-05-10T17:13:10.427

试试 ReforMath (http://reformath.webnode.com)。它基于 C++，可在 Windows 和 Linux 下运行。虽然未完成，但它可以渲染多个 MathML 元素。

# sql - 表中记录的索引

> ID：617674
> 
> 赞同：1
> 
> 时间：2009-03-06T04:18:28.400
> 
> 标签：sql, drupal, pagination

我需要在大型数据库表中定位记录的索引位置，以便将寻呼机预设到该项目的页面。我需要一个可以给我这个数字的高效 SQL 查询。可悲的是 SQL 不提供类似的东西：

```
SELECT INDEX(*) FROM users WHERE userid='123' 
```

有什么好主意吗？

编辑：假设这里附加了一个 ORDER BY 子句。关键是我不想加载所有记录来定位特定记录的位置。我正在尝试打开一个寻呼机到包含先前已选择的现有项目的页面 - 因为我想在允许用户选择其他项目的上下文中提供有关该已选择项目的信息。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-06T13:00:23.340

您可能会使用类似（伪代码）的东西：

*   计数查询： $n = select count(uid) from {users} where ...（您的分页条件包括用户 ID 123 作为限制）
*   $page = floor($n / $pager_size);
*   显示查询：从 {users} 中选择什么，你，想要什么（你的分页条件没有限制），传递给 db_query_range(thequery, $page, $pager_size)

但是，您应该真正查看[pager_query](http://api.drupal.org/api/function/pager_query/6)，因为这就是它的全部内容，并且它基本上是这样工作的：计数查询和显示查询，除了它尝试自动构建计数查询。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-06T06:02:31.130

假设您真的在询问如何在 SQL Server 2005 及更高版本中对记录进行分页，请查看[David Hayden](http://www.davidhayden.com/blog/dave/archive/2005/12/30/2652.aspx)的以下代码：

（您需要将日期、描述更改为您的列）

```
CREATE PROCEDURE dbo.ShowUsers
    @PageIndex INT, 
    @PageSize INT 
AS

BEGIN 

  WITH UserEntries AS ( 
  SELECT ROW_NUMBER() OVER (ORDER BY Date DESC) AS Row, Date, Description 
  FROM users)

  SELECT Date, Description
  FROM UserEntries 
  WHERE Row BETWEEN (@PageIndex - 1) * @PageSize + 1 AND @PageIndex * @PageSize

END 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-06T04:26:40.877

SQL 不保证表中对象的顺序，除非您使用 OrderBy 子句。换句话说，任何特定行的索引都可能在后续查询中发生变化。你能描述一下你想用寻呼机完成什么吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-06T04:46:36.257

您可能对在 MySQL 中[模拟`rownum()`](http://markmal.blogspot.com/2006/04/oracle-like-rownum-in-mysql.html)Oracle 的东西感兴趣……当然，如果您使用的是 MySQL，因为它没有在问题中指定。

* * *

**备注**：

当然，您必须查看页面的所有记录才能正常工作。您不需要将它们从数据库服务器取回 PHP 页面，但您必须将它们包含在查询中。除了查询结果集之外，没有什么魔术可以确定行在结果集中的位置，因为它可能会因为 where 条件、订单和组而改变。它需要在上下文中。

当然，如果你所有的行都是连续的，有递增的 id，没有一个会被删除，而且你知道第一个和最后一个 id；那么您可以使用计数并通过简单的数学获得位置而无需查询所有内容....但我怀疑这是您的情况，从来都不是。

# sql - 如何正确创建索引

> ID：617687
> 
> 赞同：2
> 
> 时间：2009-03-06T04:33:24.573
> 
> 标签：sql, sql-server, indexing

我在 SQL Server 2005 中有以下非常大的表：

```
create table Blah 
(
  FirstName varchar(30),
  Rank int,
  Position int,
  ...
) 
```

我将对其运行以下查询：

```
declare @PassedInFirstName varchar(30)
set @PassedInFirstName = 'SomeName'

select TOP 1 Position
from Blah
where FirstName = @PassedInFirstName
order by Rank DESC 
```

我在上面设置了以下索引：

```
CREATE INDEX IX_Blah ON Blah (FirstName, Rank) 
```

鉴于我按 Rank DESC 排序，我是否应该将索引更改为以降序方式排序 Rank：

```
CREATE INDEX IX_Blah ON Blah (FirstName ASC, Rank DESC) 
```

还是没关系？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-06T04:54:15.303

如果 WHERE 返回许多行，则如果应该受益。

我已经看到通过在 INDEX 中使用 DESC 来匹配 ORDER BY，逻辑 IO 减少了 50% 的结果

此外，将查询更改为覆盖：

SQL 2005 +：

```
CREATE INDEX IX_Blah ON Blah (FirstName, Rank DESC) INCLUDE (Position) 
```

SQL 2000、SQL 7：

```
CREATE INDEX IX_Blah ON Blah (FirstName, Rank DESC, Position) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-06T04:47:44.273

在索引中添加 Rank 作为降序值只是一个很小的变化。Sql Server 可能*会*反转使用的排序，或者在这种情况下，很容易迭代到列表中的最后一项。

位置是您的主键吗？索引由索引列、主键和可选包含的列组成。如果 Position 不是您的主键，那么您当前正在索引中查找主键，然后使用主索引查找结果以查找 Position 值。尝试将 Position 值添加为包含列，您应该能够仅基于一个索引执行查询，不会使用其他索引。

```
CREATE INDEX IX_Blah ON Blah (FirstName, Rank DESC) INCLUDE (Position) 
```

不要忘记检查您的查询计划，他们可以告诉您是否缺少任何索引（假设是 Sql Server 2008）、使用了哪些索引等。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-06T07:42:12.403

我在之前的帖子中搞砸了身份验证，这是我的注册用户。

索引基于您选择的那些列和主键。您基本上是在存储一个哈希图，其中键 (FirstName, Rank) 解析为您的 Id（假设您的主键是 Id）。然后使用此 ID 读取位置值。

我的建议是将 Position 值作为包含列包含到索引中。这将允许您从索引中读取数据，避免第二次查找。

# .net - 安装 Visual Studio SP1 后，构建找不到 LC.exe。解决方案？

> ID：617689
> 
> 赞同：1
> 
> 时间：2009-03-06T04:35:40.277
> 
> 标签：.net, visual-studio-2008, vsx, visual-studio-2008-sp1

安装 VS Sp1 后，构建中断，因为它找不到 LC.exe（在许可证文件之上运行）。好像 SP1 没有安装 LC.exe

我在这个 MSDN 论坛帖子中找到了我找到的解决方案，我应该安装 Windows SDK。

[http://social.msdn.microsoft.com/Forums/en-US/vssetup/thread/93fe03a0-117c-406e-b0ea-c2e2227e1835/](http://social.msdn.microsoft.com/Forums/en-US/vssetup/thread/93fe03a0-117c-406e-b0ea-c2e2227e1835/)

适用于 Windows Server 2008 和 .NET Framework 3.5 的 Microsoft Windows SDK 的下载量超过 1.3Gb，我不想下载和安装它来解决这样一个简单的问题。Argggg ...任何其他快速修复？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-04-12T17:55:06.397

我在某个论坛上读到（抱歉，不记得是哪个），删除文件 licenses.licx 就足够了；我做到了，问题停止了。我没有试图找出为什么首先添加了文件（我的项目之前构建时没有遇到任何问题）。我希望这有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-06T04:40:00.563

前段时间有同样的问题，对我有用的唯一方法是卸载 VS 2008 并与服务包一起重新安装。

# c# - 提交动态复选框值的问题

> ID：617701
> 
> 赞同：0
> 
> 时间：2009-03-06T04:44:22.253
> 
> 标签：c#, asp.net

我正在创建一个动态清单列表，并进行了以下实现。我已经尝试了一周来获取提交按钮上的 fnameID 文本值，单击以将值发送到数据库中。我不想在每次检查时都使用回发 oncheckedchanged.on，因为检查表的长度超过 1000 行，而且每次回发/重新加载都会浪费太多资源。我只是希望能够使用某种方法来获取选中的值，这样我就可以在提交按钮“点击我！”上将它们插入到数据库中。点击。

我用谷歌搜索并找到了 FindControl 方法，但我仍然无法获取 fnameID 值。我要么得到一个未定义的，要么它在我身上出错。任何帮助将不胜感激！谢谢！

aspx：

```
<div id="aGAccountabilityCheckListBox">
  "Panel1" runat="server">

<asp:LinkButton ID="LinkButton1" Width="66px" runat="server" onclick="LinkButton1_Click">
  Click Me!
</asp:LinkButton> 
```

后面的代码：

```
protected void Page_Load(object sender, EventArgs e)
{
    for (int i = 0; i < 50; i++)
    {
        CheckBox _checkbox = new CheckBox();
        _checkbox.ID = "dynamicCheckListBox" + Convert.ToString(i);

        Panel1.Controls.Add(_checkbox);
        Panel1.Controls.Add("&nbsp; <span id='fnameID" + i + "' >test" + i + "&lt;/span>");
    }
}

protected void LinkButton1_Click(object sender, EventArgs e)
{

    SqlConnection cn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["cnDatabase"].ToString());
    SqlCommand cmd = new SqlCommand("usp_CreateUser", cn);

    cmd.CommandType = CommandType.StoredProcedure;

    cn.Open();
    cmd.ExecuteNonQuery();
    cn.Close();

} 
```

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-06T04:52:49.003

在加载事件运行*之前*将状态恢复到控件。如果到那时您的控件还不存在，它们将失去其状态，您将不知道它们已被检查。而是在 Init 或 PreInit 事件中创建您的复选框。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-06T07:14:00.460

您的 fnameID 是作为文字控件创建的跨度。如果您以这种方式进行设置，您将不会获得回发价值。从 asp.net 的角度来看，它只是任意的 html 或文本。

为什么不使用 CheckBox 的 Text 属性？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-06T04:55:27.280

将复选框创建移动到`CreateChildControls`页面方法

要在 LinkBut​​ton1_Click 处理程序中检索复选框状态，您可以使用以下代码

```
for (int i = 0; i < 50; i++)
    {
        string cbxId = string.Format("dynamicCheckListBox{0}", i);
        CheckBox _checkbox = Panel1.FindControl(cbxId) as CheckBox;
        if (_checkbox == null )
          continue;

        if ( _checkbox.Checked )
          //do something
    } 
```

# sql-server - 通过存储过程传递“in”列表

> ID：617706
> 
> 赞同：18
> 
> 时间：2009-03-06T04:51:39.007
> 
> 标签：sql-server, tsql, stored-procedures

我怎样才能构造一个存储过程来允许我传递（例如）一个`@IDList`以便我可以编写：

```
Select * from Foo Where ID in @IDList 
```

这是可行的吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-06T05:34:01.200

使用 SQL2005 及更高版本，您可以直接从代码发送数组。

首先创建一个自定义类型

```
CREATE TYPE Array AS table (Item varchar(MAX)) 
```

比存储过程。

```
CREATE PROCEDURE sp_TakeArray
    @array AS Array READONLY
AS BEGIN
    Select * from Foo Where ID in (SELECT Item FROM @array)
END 
```

然后从传递 DataTable 作为数组的代码调用

```
DataTable items = new DataTable();
items.Columns.Add( "Item", typeof( string ) );

DataRow row = items.NewRow();
row.SetField<string>( "Item", <item to add> );
items.Rows.Add( row );

SqlCommand command = new SqlCommand( "sp_TakeArray", connection );
command.CommandType = CommandType.StoredProcedure;
SqlParameter param = command.Parameters.Add( "@Array", SqlDbType.Structured );
param.Value = items;
param.TypeName = "dbo.Array";

SqlDataReader reader = command.ExecuteReader(); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-06T05:19:45.913

看到这个答案...

[接受多个 Id 值的 T-SQL 存储过程](https://stackoverflow.com/questions/43249/t-sql-stored-procedure-that-accepts-multiple-id-values/43767#43767)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-06T05:09:43.253

将各个 ID 写入表 B，全部使用相同的“密钥”（可能是 GUID）。
然后，您对表 A 的查询将包括

```
where ID in (select ID from B where key = @TempKey) 
```

（如果你用完它们，你可能会删除它们。或者，给它们加上时间戳，然后让一个 sql 作业来做。）

**优点：**

*   您不发送字符串，这可能会使您在某些情况下暴露于 sql 注入。
*   根据您的其他应用程序逻辑，您不必一次跟踪或编写所有可能性。

**缺点：**

*   它可能效率极低，尤其是在重负载下。

# eclipse - 如何以非模式方式在 Eclipse 插件中使用 JFace FileDialog？

> ID：617707
> 
> 赞同：2
> 
> 时间：2009-03-06T04:52:19.677
> 
> 标签：eclipse, swt

我正在编写一个 Eclipse 插件，作为对某些操作的响应，我对开始一系列操作（在单独的工作中）很感兴趣。其中一项操作是请求用户提供文件名，我正在尝试使用 JFace JDialog 来完成此操作。

但是，我不清楚如何以非模式方式执行此操作；例如，我从哪里获得显示器和外壳？当开发人员可以在对话框中编辑内容时，如何确保 UI 继续工作？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-06T06:39:50.387

也许您可以看到 Eclipse 本身是如何做到的：

**[`FindAndReplaceDialog.java`](http://kickjava.com/src/org/eclipse/ui/texteditor/FindReplaceDialog.java.htm)**

```
 /**
  * Creates a new dialog with the given shell as parent.
  * @param parentShell the parent shell
  */
 public FindReplaceDialog(Shell parentShell) {
     super(parentShell);

     fParentShell= null;

     [...]

     readConfiguration();

     setShellStyle(SWT.CLOSE | SWT.MODELESS | SWT.BORDER | SWT.TITLE | SWT.RESIZE);
     setBlockOnOpen(false);
 }

 /**
  * Returns this dialog's parent shell.
  * @return the dialog's parent shell
  */
 public Shell getParentShell() {
     return super.getParentShell();
 }

/**
 * Sets the parent shell of this dialog to be the given shell.
 *
 * @param shell the new parent shell
 */
public void setParentShell(Shell shell) {
    if (shell != fParentShell) {

        if (fParentShell != null)
            fParentShell.removeShellListener(fActivationListener);

        fParentShell= shell;
        fParentShell.addShellListener(fActivationListener);
    }

    fActiveShell= shell;
} 
```

它确实根据对话框的焦点管理其父外壳。

```
 /**
  * Updates the find replace dialog on activation changes.
  */
 class ActivationListener extends ShellAdapter {
     /*
      * @see ShellListener#shellActivated(ShellEvent)
      */
     public void shellActivated(ShellEvent e) {
         fActiveShell= (Shell)e.widget;
         updateButtonState();

         if (fGiveFocusToFindField && getShell() == fActiveShell && 
               okToUse(fFindField))
             fFindField.setFocus();

     }

     /*
      * @see ShellListener#shellDeactivated(ShellEvent)
      */
     public void shellDeactivated(ShellEvent e) {
         fGiveFocusToFindField= false;

         storeSettings();

         [...]

         fActiveShell= null;
         updateButtonState();
     }
 } 
```

A[**`ShellAdapter`**](http://kickjava.com/src/org/eclipse/swt/events/ShellAdapter.java.htm)为接口描述的方法提供了默认实现[**`ShellListener`**](http://kickjava.com/src/org/eclipse/swt/events/ShellListener.java.htm)，它提供了处理`Shell`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-06T06:55:51.173

重要的是样式值应该包括 SWT.MODELESS。

样式是您应该关注的 SWT 中最重要的事情之一，因为您可以控制和初始化很多仅因为样式值。

# flash - 调试闪存堆栈溢出

> ID：617709
> 
> 赞同：2
> 
> 时间：2009-03-06T04:53:50.297
> 
> 标签：flash, actionscript-3, debugging, actionscript, flexbuilder

我有一个由第三方 swf 加载的 swf。我有源代码并重新编译了我的 swf，但没有第三方 swf 的代码。

某处，可能在我的代码中，有一个堆栈溢出。在调试 Flash 播放器中，当溢出发生时，我会得到一个带有堆栈跟踪的漂亮弹出对话框：

```
Error: Error #1023: Stack overflow occurred.
    at Object$/Object::_hasOwnProperty()
    at Object/http://adobe.com/AS3/2006/builtin::hasOwnProperty()
    at Object$/Object::_hasOwnProperty()
    at Object/http://adobe.com/AS3/2006/builtin::hasOwnProperty()
    at Object$/Object::_hasOwnProperty() 
```

64 行就是这样。但是，看起来我只看到最后 64 个堆栈帧，而不是整个堆栈跟踪。

有没有办法查看完整的堆栈跟踪？作为替代方案，有没有办法限制堆栈深度？

我花了一整天的时间尝试调试它，但运行的信息很少，而且缺乏工具。这是我尝试过的：

*   将我的代码连接到调试器。这是在虚拟机内的 windows 中运行的 flash 9.0.28 中，连接到在虚拟机外运行的 flex builder。它似乎已连接，但我没有得到跟踪语句，并且断点不会触发。
*   将日志行发送到 http 服务器。这可行，但我怀疑我错过了溢出/服务器崩溃之前的最后 n 个堆栈帧。
*   一种盲目的、二进制搜索类型的方法会禁用部分代码——这很慢，但可能会起作用。

我应该尝试其他任何策略吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-06T05:13:29.797

[这](http://bugs.adobe.com/jira/browse/FP-939?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel)听起来像同样的问题吗？抱歉，这不是关于如何进一步调试此问题的直接答案，而是指向遇到类似问题并找到解决方案的人的指针。

# java - 在 Swing 应用程序中运行 SWT 组件

> ID：617713
> 
> 赞同：3
> 
> 时间：2009-03-06T04:57:53.780
> 
> 标签：java, user-interface, swing, swt

我想知道是否有人有任何尝试运行托管在 Swing 组件中的复杂 SWT UI 的经验。

我已经设法进行了一个非常简单的演示，但是如果其他人尝试过并且失败/成功地做到了这一点，那么从他们的经验中学习会很棒。

所以重申一下我的应用程序是一个 Swing 应用程序，我希望使用一个复杂的 SWT UI 组件（拖放、弹出窗口和对话框）——有人管理过这个吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-17T12:21:50.920

我使用过 Swing 和 SWT，尽管以前从未在同一个应用程序/项目中使用过。

只要您不尝试在同一个窗口中将组件混合在一起，我看不出有任何理由您不能拥有完全独立的窗口/对话框，每个窗口/对话框都使用特定的小部件集。然而，试图在一个窗口中混合 SWT 和 Swing 可能永远不会奏效，或者至少会导致很多问题，因为这两个小部件集都依赖于完全不同的绘图/布局方式 - Swing 的组件都直接在 Java 中处理并且是与底层操作系统完全分离，而 SWT 显式依赖底层操作系统来完成所有（或大部分）GUI 渲染。试图将两者混合起来可能会导致各种问题。

当然，我也会抛出通常的“这不是推荐的做法”响应：除非您在这里有一些非常具体的目标，否则在同一个应用程序中混合不同的小部件集并不是一个好主意。Swing 和 SWT 有两种完全不同的理念和底层架构。事实上，SWT 的诞生是因为 IBM/OTI 不喜欢 Swing 采用的方法，因此选择实现自己的小部件。对于 GUI 小部件的这种对比方法，您最好选择一个并坚持使用它，而不是将两者混合在一起。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-11T06:41:01.760

混合 Swing 和 SWT 并不是最好的选择，但如果你别无选择，它也不是很难杀死的野兽。试着在你的代码中强制执行一些规则/标准。例如。将所有对话框保留在 Swing 中（如果没有理由，不要混合使用两者），使用命名约定来区分 Swing 和 SWT 组件等。确保您充分了解 Swing 和 SWT 的方式在您开始处理任何复杂的 UI 问题之前，组件由 OS/JVM 处理。

需要注意的一件事是在 Swing 和 SWT 组件之间拖放。这有点棘手，但特别是如果您开始使用自定义数据类型。

# security - 运行 Activex 控件并维护安全性

> ID：617714
> 
> 赞同：0
> 
> 时间：2009-03-06T05:02:09.107
> 
> 标签：security, browser, activex, controls

在我的 Web 应用程序中，我有一部分可以调用 Activex 控件。Activex 控件可用于从 Web 服务器访问我的 Web 应用程序的所有客户端 PC。但是当试图从客户端机器的浏览器中运行这个 ActiveX 控件时（使用 Wshell），它没有被调用，因为我的浏览器中禁用了“**运行 Activex 控件和插件”。**所以我将浏览器设置更改为**启用**模式，然后 Activex 控件给了我预期的输出。我担心浏览器设置的这种变化会让任何其他网站损害我的系统。我怎么能摆脱这个问题？有什么想法吗？提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-06T05:17:28.540

从 Vista + IE7 开始引入了很多安全变化。在 IE 中以 procted 模式启动，这有助于保护用户免受攻击，方法是运行具有极大受限权限的 Internet Explorer 进程。保护模式显着降低了攻击在用户机器上写入、更改或破坏数据或安装恶意代码的能力。

更多详情：http: [//msdn.microsoft.com/en-us/library/bb250462.aspx#wpm_aarwm](http://msdn.microsoft.com/en-us/library/bb250462.aspx#wpm_aarwm)

因此开发人员必须修改应用程序以确认新标准，例如从插件启动进程 - 将寡妇消息从 LI（Low Intergirty）发送到 HI 进程等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-06T05:18:38.833

您可以对您的 ActiveX 进行数字签名，这样用户就不必为了允许其运行而过多地损害其浏览器的安全性。但是，本质上，ActiveX 不是很安全，当您选择 ActiveX 时，这些问题总是会出现......

# c++ - 如何在 C++ 中获取抽象（？）pimpl 的调试信息？

> ID：617726
> 
> 赞同：2
> 
> 时间：2009-03-06T05:13:40.280
> 
> 标签：c++, visual-studio, debugging, pimpl-idiom

我有一个包装类，它将其工作委托给一个 pimpl，而 pimpl 是一个指向基类/接口的指针，它没有以几种不同方式专门化的数据。

像这样：

```
class Base
{
    void doStuff=0;
};

class Derived
{
    int x,y;
    void doStuff()
    {
        x = (x+y*2)*x; //whatever
    }
};

class Wrapper
{
    Base*   _pimpl;
    void doStuff()
    {
        _pimpl->doStuff();
    }
}; 
```

现在这在大多数情况下都可以正常工作，但是当进入调试器时，我无法查看 Derived 类的 x,y （因为它可以是任何东西）。通常这是无关紧要的，但是当出现问题时，查看 Derived 的状态可能很重要，但是 pimpl 过于模糊了状态（但是这是 pimpl 的原始想法，所以我想我真的不能抱怨）。

现在我有一个 tostring() 函数，可以打印出状态以进行调试，但想知道是否有更好的解决方案，特别是在 VisualStudio 中调试这种结构，但一般的解决方案会更好。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-06T05:16:12.223

您是否尝试在监视窗口中将变量转换为 Derived*？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-06T05:55:34.203

只需继续在 Autos 窗口或 Watch 窗口之一中展开树：

[替代文字 http://www.freeimagehosting.net/uploads/626b4a37ee.png](http://www.freeimagehosting.net/uploads/626b4a37ee.png)

# javascript - 如何使用 javascript 创建冻结/非滚动窗口区域？

> ID：617733
> 
> 赞同：1
> 
> 时间：2009-03-06T05:18:37.443
> 
> 标签：javascript

很想知道如何使用 javascript 在网页上创建冻结/非滚动区域！就像 Stackoverflow 使用的那样，当他们通过“X”关闭按钮提醒您已获得徽章时！

加思

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-06T05:22:17.250

您不需要使用 javascript，只需将 CSS 属性“display”设置为“fixed”即可使用 CSS。如果您愿意，您当然可以使用 javascript 执行此操作，如下所示：

```
var element = ...code to get the element you want...;
element.style.display = 'fixed'; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-06T05:22:34.923

那是使用 CSS 的位置：固定

```
body {
    margin-top: 20px;
}

#banner {
    position: fixed;
    height: 20px;
} 
```

# jquery - 在jQuery中同时迭代两组元素

> ID：617735
> 
> 赞同：2
> 
> 时间：2009-03-06T05:19:02.263
> 
> 标签：jquery

我有一个表格，其中包含多对单独列中的文本输入字段。我想遍历第一列中的输入字段并使用这些值来设置相邻列中相应输入字段的值。

```
<table>
    <tr>
         <td><input type="text" class="left" /></td>
         <td><input type="text" class="right" /></td>
    </tr>
    <tr>
         <td><input type="text" class="left" /></td>
         <td><input type="text" class="right" /></td>
    </tr>
  ...
</table> 
```

我刚刚开始学习 jQuery，所以答案可能很明显。到目前为止我只有

```
$("input.left").each(function() {
    // use the value of $(this) to set the 
    // value of the text field to the .right
}) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-06T05:25:51.890

您想要做的就是所谓的“压缩”操作。这在函数式编程语言中非常常见。它是将两个等长的序列组合成一个包含一对（或 n 元组）元素的序列的函数。

在这里，您可以找到 jquery 的“zip”实现。这是一个 jQuery 插件。[在谷歌代码上可用](http://code.google.com/p/jquery-utils/wiki/JqueryArrayUtils)

看起来你可以像 tihs 一样使用它：

```
$.zip($("input.left"), $("input.right")).each(function () {
   var left = this[0];
   var right = this[1];
}) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-06T05:24:38.273

很多方法可以做到这一点。这是一个。

```
$("tr").each(function() {
  $(this).find(":last-child input").val($(this).find(":first-child input").val());
}); 
```

或其他：

```
$("input.left").each(function() {
  $(this).parent().nextSibling().find("input.right").val(this.value);
}); 
```

等等。

# c - 布尔定义

> ID：617741
> 
> 赞同：2
> 
> 时间：2009-03-06T05:22:19.493
> 
> 标签：c, embedded, boolean

每当 BOOL 数据类型不容易预定义时，我曾经使用以下定义进行布尔值，

typedef unsigned char BOOL;

（由于内存使用）。

我意识到出于性能原因使用本机总线宽度可能会更好。例如，对于 32 位处理器，它可以是

typedef unsigned int BOOL;

现在，如果我仍然想为本地总线宽度定义 BOOL，64 位处理器会发生什么。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-06T05:31:40.860

*我不会像有效*宽度那样担心本机总线宽度（这是你的目标，对吧）？在几乎任何机器上，任何体面的 c 编译器都会编译`unsigned int`到相当有效的宽度，所以你很高兴。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-06T06:35:35.653

永远不要猜测性能，**衡量**。测量，将给出更好的明确答案 - 请记住，这可能会在每个新的编译器版本、系统升级时发生变化......

还有一天，您可能需要一个布尔数组，在这种情况下，将处理器字用作布尔值*并不是*最好的解决方案。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-06T05:42:15.343

为什么不在[stdbool.h](http://en.wikipedia.org/wiki/Stdbool.h)中使用 bool 类型？

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-06T05:37:06.590

[尺寸_t](http://www.embedded.com/columns/programmingpointers/200900195)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-06T05:38:30.377

我建议使用预处理器。

```
 #ifndef BOOL 
   #ifdef ILP32
     #define BOOL uint32_t
   #endif
   #ifdef LP64
     #define BOOL uint64_t
   #endif
 #endif 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-06T06:40:13.490

至少 x86 和 ARM 能够在 32 位寄存器中加载和存储字节而不会受到任何惩罚，因此使用 char 确实没有性能影响。我不完全确定，但我敢打赌 x86-64 也有这样的说明。（当然 x86 和 x86-64 也可以直接在寄存器中处理 8 位值。）。

所以唯一关心的可能是内存布局。当然，编译器会对齐所有内容，因此大多数情况下，结构中的 char 值会被填充，除非它们彼此相邻，否则您实际上可能会节省几个字节的空间并获得更好的缓存性能。如果你有大量的 BOOL 数组并且内存是一个问题，那么无论如何你都应该打包它们。

无论如何，这不是问题。为什么不尝试运行一个双向编译的程序，看看是否对性能或内存使用有任何重大影响。如果你发现有，你可以给自己买一瓶啤酒，假装是我送的。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-06T09:24:11.660

最适合大多数平台

typedef enum { FALSE = 0, TRUE = 1, } BOOL;

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-06T05:32:53.680

好吧，您总是可以将 typedef 定义为`long long`或其他东西，但实际上我不确定这是人们出于某种原因所做的事情。（您可能还可以根据 sizeof(int*) 或类似的东西进行条件定义）。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-06T06:10:34.357

使用 char 可能比使用整数慢。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-06T10:25:47.160

[stdint.h 中的int_fast8_t](http://www.gnu.org/software/libtool/manual/libc/Integers.html)应该是一个不错的选择

# crystal-reports - Crystal 报表中的最大列数？

> ID：617743
> 
> 赞同：1
> 
> 时间：2009-03-06T05:24:32.563
> 
> 标签：crystal-reports

水晶报表最多可以显示多少列？[包括横向、A4....等所有格式]

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-15T23:15:48.337

据我所知，水晶报表中的列数没有理论上的限制。您可以将纸张尺寸（取决于打印机驱动程序）更改为大得离谱的尺寸。

例如，我安装的可爱 PDF 驱动程序允许 24 x 108 英寸的页面 - 超过 2.7 米。您还可以将列缩小到几乎没有宽度。我在通过报告将数据导出到 CSV 文件时做到了这一点，不需要打印报告，一行中有大约 40 个不同的数据列。

# asp.net - 为什么我在本地数据库上而不是在实时数据库上收到此错误？

> ID：617745
> 
> 赞同：0
> 
> 时间：2009-03-06T05:24:42.017
> 
> 标签：asp.net, sql-server, configuration, indexing, full-text-search

当我查询本地数据库而不是实时数据库时，我收到以下错误：

> 不能对表或索引视图“Shop”使用 CONTAINS 或 FREETEXT 谓词，因为它不是全文索引。

为什么会这样？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-06T05:32:21.577

它的意思几乎就是它所说的。您的 Shop 表未启用全文索引。全文索引允许在查询时搜索字段中的所有文本，这是我假设您想要做的。

**您可能在您的开发系统上关闭了**全文索引，但在您的实时服务器上。

请[阅读此页面](http://www.developer.com/db/article.php/3446891)，其中解释了如何启用它。

# resharper - Resharper 4.1 是否支持驼峰和正常选择模式？

> ID：617746
> 
> 赞同：6
> 
> 时间：2009-03-06T05:25:00.003
> 
> 标签：resharper, devtools, camelcasing

我在 resharper 中找到了 Camel Humps 的设置：

Resharper -> 选项 -> 编辑器 -> 使用 CamelHumps

问题是我仍然希望能够使用正常选择模式（即 CTRL+Arrow 和 CTRL+SHIFT+Arrow 的默认行为）以及 CamelHumps 模式。

例如考虑这个变量：

私人 int MyVeryLongCamelCaseName;

现在，如果我想复制整个变量，那么我想要 CTRL+SHIFT+左箭头的 VS 默认行为，如果光标在 M 上，则选择整个变量。

但是，如果我想将名称更改为 MyExtremelyLongCamelCaseName，那么我想要 Resharper 提供的 CamelHumps 行为。

**有没有办法让这两种行为都有不同的快捷方式？**

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2010-04-19T14:40:00.830

*   在 Resharper -> 选项 -> 编辑器 -> 使用 CamelHumps 中禁用 CamelHumps。
*   转到工具 -> 选项 -> 键盘和
    *   将您想要的键绑定到“Resharper.HumpNext”和“ResharperHuntPrev”（我使用 alt+left / alt+right）
    *   并将键绑定到“Resharper.HumpNextExtent”和“Resharper.HumpPrevExtent”用于选择快捷键。（我必须首先从 'Edit.Char[Left/Right]ExtentColumn' 中删除 shift+alt+left/right 的键绑定）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-04-15T12:51:52.830

我认为 ctrl+W 快捷键会有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-06T05:41:39.480

我不认为有这个选项，但作为一种解决方法，您可以使用扩展选择快捷方式，即 CTRL+ALT+Right。对于有很多驼峰的符号，不理想但比多次按 CTRL+SHIFT+Right 更快。

# c# - 重载operator==后，如何比较两个变量是否指向同一个对象？

> ID：617757
> 
> 赞同：5
> 
> 时间：2009-03-06T05:35:29.493
> 
> 标签：c#, operators, operator-overloading, equals-operator

重载比较运算符，如果两个变量指向同一个对象（即不是值）如何比较

```
public static bool operator ==(Landscape a, Landscape b)
{
    return a.Width == b.Width && a.Height == b.Height;
}

public static bool operator !=(Landscape a, Landscape b)
{
    return !(a.Width == b.Width && a.Height == b.Height);
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-06T05:40:07.720

使用 Object.ReferenceEquals 静态方法。

当然，为了让 == 和 != 方法保留其全部功能，您还应该重写 Equals 和 GetHashCode 以便它们向调用者返回一组一致的响应。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-06T05:39:17.973

尝试[`a.ReferenceEquals(b);`](http://msdn.microsoft.com/en-us/library/system.object.referenceequals.aspx)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-06T06:09:41.130

检查两者是否指向同一个对象。您应该使用 Object.ReferenceEquals 方法。如果两者相同或两者都为空，它将返回 true。否则它将返回 false

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-11-03T17:09:10.580

我知道这是一个老问题，但如果你要重载 == 或 Object.Equals 方法，你还应该重载反向运算符！=。

在这种情况下，由于您正在比较内部数字，因此您应该重载其他比较运算符 <、>、<=、>=。

将来使用您的类的人，无论是第三方消费者，还是接管您的代码的开发人员，可能会使用 CodeRush 或 Refactor 之类的东西，这将自动“翻转”逻辑（也称为反转条件）和然后将其展平，以突破 25 嵌套 if 综合症。如果他们的代码这样做，并且您重载了 == 运算符而没有重载 != 运算符，它可能会改变您的代码的预期含义。

# mysql - 单个参数或 Build Where 子句

> ID：617759
> 
> 赞同：3
> 
> 时间：2009-03-06T05:36:32.457
> 
> 标签：mysql, oop, coldfusion

我正在构建一个对象来在我的数据库中搜索订单。用户可以设置许多可能的参数，他们可以为每次搜索设置任意数量的参数。我创建了 setter 方法来收集搜索所需的所有参数。

我的问题是这个。什么是“最佳实践”

1.  存储参数，并在调用方法`WHERE`时构建子句`doSearch`
2.  设置`WHERE`子句作为参数

我想了解任何建议背后的原因。

请注意，该对象会针对每次搜索进行实例化，因此我不必担心使用不同参数进行第二次搜索。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-07T17:01:23.893

您应该将订单搜索的代码与构建 SQL 的代码分开。SQL 应该构建在类的派生（或[策略](http://en.wikipedia.org/wiki/Strategy_pattern)派生）中`OrderSearch`。一旦进行了这种分离，构建 SQL 就不再重要*了。*

为了使这更清楚一点。给定一个名为的类`OrderSearch`，它有一堆用于搜索条件的 setter 方法，您希望有一个名为 的子类`OrderSearchSQLBuilder`。请注意，子类依赖于基类，而基类独立于子类。这个非常重要。这种独立性允许您忽略 SQL 是在 setter 方法中还是在 search 方法中构建的。请参阅[依赖倒置原则 (DIP)](http://www.objectmentor.com/resources/articles/dip.pdf)。

一旦你有了这种分离，你就可以用其他策略来代替导数。例如，如果您想在不将其连接到 SQL 数据库的情况下测试您的应用程序，您可以创建一个虚拟 in-ram 数据库并创建一个`OrderSearch`处理该虚拟数据库的派生数据库。应用程序的其余部分将完全不知道，然后您的测试将独立于数据库连接、预先存在的数据等的恐怖。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-06T05:56:39.427

在您的方法中，只需使用执行搜索的动态 SQL 中的参数。这样，where 子句就在 SQL 运行之前构建。您只需将搜索参数作为参数传递给您的方法。

像这样的东西...

```
<cffunction name="getByAttributesQuery" access="public" output="false" returntype="query">
    <cfargument name="id" type="numeric" required="false" />
    <cfargument name="userName" type="string" required="false" />
    <cfargument name="firstName" type="string" required="false" />
    <cfargument name="lastName" type="string" required="false" />
    <cfargument name="createdAt" type="date" required="false" />
    <cfargument name="updatedAt" type="date" required="false" />
    <cfargument name="orderby" type="string" required="false" />

    <cfset var qList = "" />        
    <cfquery name="qList" datasource="#variables.dsn#">
        SELECT  
            id,
            userName,
            firstName,
            lastName,
            createdAt,
            updatedAt
        FROM    users
        WHERE       0=0
    <cfif structKeyExists(arguments,"id") and len(arguments.id)>
        AND id = <cfqueryparam value="#arguments.id#" CFSQLType="cf_sql_integer" />
    </cfif>
    <cfif structKeyExists(arguments,"userName") and len(arguments.userName)>
        AND userName = <cfqueryparam value="#arguments.userName#" CFSQLType="cf_sql_varchar" />
    </cfif>
    <cfif structKeyExists(arguments,"firstName") and len(arguments.firstName)>
        AND firstName = <cfqueryparam value="#arguments.firstName#" CFSQLType="cf_sql_varchar" />
    </cfif>
    <cfif structKeyExists(arguments,"lastName") and len(arguments.lastName)>
        AND lastName = <cfqueryparam value="#arguments.lastName#" CFSQLType="cf_sql_varchar" />
    </cfif>
    <cfif structKeyExists(arguments,"createdAt") and len(arguments.createdAt)>
        AND createdAt = <cfqueryparam value="#arguments.createdAt#" CFSQLType="cf_sql_timestamp" />
    </cfif>
    <cfif structKeyExists(arguments,"updatedAt") and len(arguments.updatedAt)>
        AND updatedAt = <cfqueryparam value="#arguments.updatedAt#" CFSQLType="cf_sql_timestamp" />
    </cfif>
    <cfif structKeyExists(arguments, "orderby") and len(arguments.orderBy)>
        ORDER BY #arguments.orderby#
    </cfif>
    </cfquery>

    <cfreturn qList />
</cffunction> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-06T05:44:30.860

在需要执行搜索之前不要构建 where 子句。您最终可能会得到一个在迭代中提供参数的用户界面，并且您不知道什么时候拥有一切。此外，您可能永远不会执行搜索，所以为什么要担心 where 子句。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-06T05:56:57.727

我认为这没什么区别，但我认为在执行搜索时构建 WHERE 子句似乎更好。我认为将参数添加到某处的 WHERE 子句字符串不应该是 setter 的责任。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-06T05:45:59.110

在 SQLServer 数据库上，将所有参数包含在 where 子句中比即时构建它更有效。然后有一个数据库索引，其中包含您将搜索的所有列。这可确保在执行语句时始终使用索引。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-06T09:41:40.103

听起来你的抽象不太正确。

搜索作为“订单”对象的一种方法可能会更好。[将参数传递给搜索功能并按照russ](https://stackoverflow.com/questions/617759/individual-parameters-or-build-where-clause/617785#617785)的建议手动构建查询。然后可以在 orders init 方法上设置特定于订单而不是搜索的任何内容。

您可能想要构建一个订单搜索对象，但这应该通过一个订单对象来完成，以保持您的前端代码简单。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-06T21:23:05.783

选项 1 是您最好的选择。选项 2 听起来很危险。如果参数更新了怎么办？如何在 WHERE 子句中替换它？

我会做这样的事情：

```
<cffunction name="doSearch" access="public" output="false" returntype="query">        
    <cfset var qList = "" />
    <cfquery name="qList" datasource="#variables.dsn#">
       SELECT
           ...
       FROM
           ...
       WHERE 0=0 
         <cfif len(getID())>
           AND id = <cfqueryparam value="#getID()#" CFSQLType="cf_sql_integer" />
         </cfif>       
         <cfif len(getUserName())>
           AND userName = <cfqueryparam value="#getUserName()#" CFSQLType="cf_sql_varchar" />
         </cfif>
    </cfquery>
    <cfreturn qList />
</cffunction> 
```

# asp.net - 是否有任何关于将 Asp.net 托管为 Portlets 的论坛或知识库

> ID：617777
> 
> 赞同：1
> 
> 时间：2009-03-06T05:48:54.767
> 
> 标签：asp.net, ajax, plumtree

我对 Plumtree 很陌生，将 asp.net 页面托管为 portlet 并不容易。

每次都会出现一些奇怪的问题，比如

-> 会话变量不能跨页面工作 -> 内置 Ajax 不能工作 -> Response.redirect 失败

我想了解更多关于在 plumtree 中托管 asp.net 页面的信息，如果您遇到任何有关 Plumtree 的论坛或知识库，请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-20T02:15:05.067

你最好的地方是 BEA/Oracle 论坛，用于 Aqualogic、LiquidSomething、Interaction 或他们现在所说的任何东西。

在这里解释 Plumtree 的内部工作需要很长时间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-29T11:59:38.807

最好的方法是使用 Web 服务定义 B 中的会话首选项

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-02-16T21:12:01.863

使用会话首选项。更多信息和细节可以在这里找到：http: [//download.oracle.com/docs/cd/E13174_01/alui/devdoc/docs60/Portlets/Basics/PlumtreeDevDoc_Integration_Portlets_Settings.htm](http://download.oracle.com/docs/cd/E13174_01/alui/devdoc/docs60/Portlets/Basics/PlumtreeDevDoc_Integration_Portlets_Settings.htm)

另请查看[http://www.function1.com/blog](http://www.function1.com/blog)以了解 Plumtree/Aqualogic Interaction/WebCenter Interaction 讨论。

# asp.net - 这是企图破坏我的 ASP.Net 站点的安全性吗？

> ID：617782
> 
> 赞同：9
> 
> 时间：2009-03-06T05:55:06.250
> 
> 标签：asp.net, security, exception

我对 ASP.NET 相当陌生。我最近从我的网站设置了自动电子邮件，以通知我未处理的异常。就在几个小时前的 3 分钟内，有 10 个未处理的异常，并且所有堆栈跟踪都相似。错误消息中有很多我不明白的地方，但我不喜欢它的外观。

这是其中一封电子邮件：

```
An unhandled exception occurred:
Message: Padding is invalid and cannot be removed.

 Stack Trace:
    at System.Security.Cryptography.RijndaelManagedTransform.DecryptData(Byte[] inputBuffer, Int32 inputOffset, Int32 inputCount, Byte[]& outputBuffer, Int32 outputOffset, PaddingMode paddingMode, Boolean fLast)
    at System.Security.Cryptography.RijndaelManagedTransform.TransformFinalBlock(Byte[] inputBuffer, Int32 inputOffset, Int32 inputCount)
    at System.Security.Cryptography.CryptoStream.FlushFinalBlock()
    at System.Web.Configuration.MachineKeySection.EncryptOrDecryptData(Boolean fEncrypt, Byte[] buf, Byte[] modifier, Int32 start, Int32 length, IVType ivType, Boolean useValidationSymAlgo)
    at System.Web.UI.Page.DecryptStringWithIV(String s, IVType ivType)
    at System.Web.Handlers.AssemblyResourceLoader.System.Web.IHttpHandler.ProcessRequest(HttpContext context)
    at System.Web.HttpApplication.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute()
    at System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously) 
```

这是企图侵入我的网站还是其他什么？

* * *

非常感谢那些提供答案和评论的人，这为我指明了正确的方向，以得到这个例外的答案。它的原因可能很难确定，尤其是当不在网络场中发生时。

IE 5.5 并没有像我之前所想的那样引起问题。

这不是很容易找到的，但是其中一位工作人员在我的网络主机论坛上发帖提到了 Viewstate 错误的报告。原因归结为asp工作进程或服务器回收。

asp worker 进程设置是指 machine.config 文件中的 processModel 元素。有关详细信息，请参阅[http://msdn.microsoft.com/en-us/library/7w2sway1(VS.80).aspx](http://msdn.microsoft.com/en-us/library/7w2sway1(VS.80).aspx)。

建议的修复方法是在 web.config 文件中设置加密的 machineKey。机器密钥节点位于 system.web 元素中。

由于方便的 ASP.NETResources 站点具有 MachineKey Generator，这很容易完成并解决了问题。请参阅[http://www.aspnetresources.com/tools/keycreator.aspx](http://www.aspnetresources.com/tools/keycreator.aspx)。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-06T06:04:37.990

当程序集资源处理程序收到无效请求时，将引发此异常。这不太可能与任何恶意活动有关；它通常是由服务器上配置错误的机器配置引起的。

一些背景：

ASP.NET 具有通过 HttpHandler 从程序集 (dll) 公开资源的内置机制。JavaScript 和图像等资源可以作为文本存储在程序集中，并由浏览器通过 .axd 处理程序请求。但是出于安全原因，处理程序不接受资源的纯文本位置，这可能会暴露有关您的代码如何工作的线索。相反，它使用服务器上 machine.config 中的信息来加密资源的唯一标识符。当请求资源时会引发此异常，但当服务器尝试解密提供的标识符时，它会失败。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-06T07:20:03.457

该错误是因为您的 appdomain 已被回收/重新启动。当发生这种情况时，应用程序和机器密钥设置为自动，它会改变。这会影响资源 url (.axd) 的 url 中信息的解密。设置一个固定的机器密钥将防止它再次发生。

请检查此以获取有关类似案例的更多信息（解释与视图状态验证问题有关，但原因相同）： http: [//www.developmentnow.com/blog/InvalidViewstate+Or+Unable+To+验证+数据+错误.aspx](http://www.developmentnow.com/blog/InvalidViewstate+Or+Unable+To+Validate+Data+Error.aspx)

附言。这解释了单服务器部署:) - 尽管多单服务器的解决方案是相同的，但通常只解释修复以使所有服务器使用相同的机器密钥。

**更新 1：**填充无效消息与 css 填充无关。如果它只发生在 ie 5.5 上，则很可能 webresource.axd 的参数被搞砸了，就像在这个问题中一样：[Invalid Webresource.axd parameters being generated](https://stackoverflow.com/questions/461605/invalid-webresource-axd-parameters-being-generated)。

# multithreading - 为什么我应该使用线程而不是使用进程？

> ID：617787
> 
> 赞同：54
> 
> 时间：2009-03-06T06:02:10.070
> 
> 标签：multithreading, process

将程序的不同部分分成不同的进程似乎（对我来说）比仅仅线程化所有内容更优雅。在什么情况下让事情在线程上运行而不是将程序分成不同的进程是有意义的？我什么时候应该使用线程？

* * *

### 编辑

任何关于它们如何（或是否）在单核和多核上表现不同的任何事情也会有所帮助。

* * *

## 回答 #1

> 赞同：86
> 
> 时间：2009-03-06T06:05:59.360

您更喜欢多线程而不是多进程，原因有两个：

1.  线程间通信（共享数据等）比进程间通信更容易编程。
2.  线程之间的上下文切换比进程之间的切换要快。也就是说，操作系统停止一个线程并开始运行另一个线程比对两个进程执行相同操作更快。

例子：

带有 GUI 的应用程序通常使用一个线程用于 GUI，而其他线程用于后台计算。例如，MS Office 中的拼写检查器是一个独立于运行 Office 用户界面的线程。在此类应用程序中，改为使用多个进程会导致性能下降，并且代码难以编写和维护。

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2009-03-06T06:20:06.203

除了使用线程而不是进程的优点之外，例如：

优点：

*   创建线程比创建进程快得多。
*   在线程之间切换比在进程之间切换要快得多。
*   线程轻松共享数据

也考虑一些缺点：

*   线程之间没有安全性。
*   一个线程可以踩到另一个线程的数据。
*   如果一个线程阻塞，则任务中的所有线程都阻塞。

至于你的问题的重要部分“我什么时候应该使用线程？”

好吧，您应该考虑几个事实，即线程不应该改变程序的语义。他们只是改变了操作的时间。因此，它们几乎总是被用作性能相关问题的优雅解决方案。以下是一些可能使用线程的情况示例：

*   进行冗长的处理：当 Windows 应用程序正在计算时，它不能再处理任何消息。结果，无法更新显示。
*   做后台处理：有些任务可能不是时间关键的，但需要连续执行。
*   执行 I/O 工作：磁盘或网络的 I/O 可能会有不可预知的延迟。线程允许您确保 I/O 延迟不会延迟应用程序的不相关部分。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-03-06T06:45:37.517

你听起来肯定不像个新手。这是一个很好的观察，流程在许多方面都更加优雅。线程基本上是一种优化，以避免过多的转换或内存空间之间的过多通信。

从表面上看，使用线程似乎也使您的程序更易于读写，因为您可以在线程之间自由共享变量和内存。在实践中，这样做需要非常小心以避免竞争条件或死锁。

有一些操作系统内核（最著名的是[L4](http://en.wikipedia.org/wiki/L4_microkernel_family)）非常努力地提高进程间通信的效率。对于这样的系统，人们可能会提出一个令人信服的论点，即线程毫无意义。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-03-06T06:06:04.740

我假设你已经知道你需要一个线程或进程，所以我想说选择一个而不是另一个的主要原因是数据共享。

使用进程意味着您还需要进程间通信 (IPC) 来将数据传入和传出进程。但是，如果要隔离该过程，这是一件好事。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2019-12-18T07:30:43.863

我想以不同的方式回答这个问题。“这取决于您的应用程序的工作场景和性能 SLA”将是我的答案。

例如，线程可能共享相同的地址空间，线程之间的通信可能更快更容易，但在某些情况下线程死锁也有可能，然后你认为你的进程会发生什么。

即使你是一个编程高手并且已经使用了所有花哨的线程同步机制来防止死锁，除非遵循确定性模型，否则这肯定不是火箭科学，这可能是在实时操作系统上运行的硬实时系统的情况您对线程优先级有一定程度的控制，并且可以期望操作系统尊重这些优先级，但对于像 Windows 这样的通用操作系统可能并非如此。

从设计的角度来看，您也可能希望将您的功能隔离到独立的自包含模块中，在这些模块中它们可能不需要共享相同的地址空间或内存，甚至不需要相互通信。在这种情况下，流程将变得有意义。

以 Google Chrome 为例，它生成多个进程，而不是大多数使用多线程模型的浏览器。Chrome 中的每个选项卡都可以与不同的服务器通信并呈现不同的网站。想象一下，如果一个网站停止响应，并且您的线程因此而停止，整个浏览器要么变慢要么停止。所以谷歌决定产生多个进程，这就是为什么即使一个标签卡死了，你仍然可以继续使用 Chrome 浏览器的其他标签。

在此处阅读更多相关信息， 并[在此处](https://blog.chromium.org/2008/09/multi-process-architecture.html)[查看](https://www.google.com/googlebooks/chrome/med_00.html)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2010-09-15T15:40:25.350

我同意上面的大部分答案。但是从设计的角度来看，当我希望一组逻辑上相关的操作并行执行时，我宁愿选择一个线程。例如，如果您运行文字处理器，则会有一个线程在前台作为编辑器运行，而另一个线程在后台运行，定期自动保存文档，因此没有人会设计一个进程来单独执行自动保存任务。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-07-10T13:55:13.373

除了其他答案之外，维护和部署单个进程比拥有几个可执行文件要简单得多。

一个人会使用多个进程/可执行文件来提供定义良好的接口/解耦，以便一个或另一个部分可以更容易地重用或重新实现，而不是将所有功能保留在一个进程中。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-08-20T17:49:23.493

偶然发现了这个帖子。有趣的讨论。但我觉得缺少一点或间接指出。

由于必须分配和初始化所有数据结构，因此创建新进程的成本很高。将进程细分为不同的控制线程，实现进程内部的多线程。

使用线程或进程来实现目标取决于您的程序使用要求和资源利用率。

# vb.net - vb.net 中的拆分器代码

> ID：617789
> 
> 赞同：0
> 
> 时间：2009-03-06T06:03:18.540
> 
> 标签：vb.net

我的页面中有一个树视图和一个网格视图。我的应用程序是 vb 中的 Windows 应用程序。我想使用拆分器来移动树视图和一个网格视图。任何人都可以帮助提供拆分器代码来执行此操作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-06T06:28:22.613

请浏览提供的示例

[http://msdn.microsoft.com/en-us/library/system.windows.forms.splitcontainer.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.splitcontainer.aspx)

您可以实施您的解决方案。

# sql-server - T-SQL 内带有“回复”标头的 SPF 兼容消息

> ID：617791
> 
> 赞同：0
> 
> 时间：2009-03-06T06:03:48.053
> 
> 标签：sql-server, sql-server-2005, tsql

下面的 T-SQL 代码在 SQL Server 2005 内部工作。我希望添加一个“回复”标头，以便任何回复都会发送到“回复”地址，而不是FROM 地址。是的，我知道在数据库邮件中进行设置，但我只是想在我现有的解决方案中添加一些代码。我不想使用数据库邮件。

我正在寻找类似于以下 VB 代码的东西，但我想要一个 T-SQL 版本......

```
Dim objMessage
objMessage = Server.CreateObject("CDO.Message")

objMessage.Fields("urn:schemas:mailheader:reply-to").Value = "SOME_OTHER_EMAIL_NOT_FROM" 
```

这是 T-SQL 代码...

```
EXEC @hr = sp_OACreate 'CDO.Message', @iMsg OUT

EXEC @hr = sp_OASetProperty @iMsg, 'Configuration.fields("http://schemas.microsoft.com/cdo/configuration/sendusing").Value','2'

EXEC @hr = sp_OASetProperty @iMsg, 'Configuration.fields("http://schemas.microsoft.com/cdo/configuration/smtpserver").Value','smtp.mymailserver.com'

EXEC @hr = sp_OASetProperty @iMsg, 'Configuration.fields("http://schemas.microsoft.com/cdo/configuration/sendusername").Value', 'username'

EXEC @hr = sp_OASetProperty @iMsg, 'Configuration.fields("http://schemas.microsoft.com/cdo/configuration/sendpassword").Value', 'password'

EXEC @hr = sp_OASetProperty @iMsg, 'Configuration.fields("http://schemas.microsoft.com/cdo/configuration/smtpauthenticate").Value', '1'

EXEC @hr = sp_OAMethod @iMsg, 'Configuration.Fields.Update', null

EXEC @hr = sp_OASetProperty @iMsg, 'To', @To

EXEC @hr = sp_OASetProperty @iMsg, 'From', @From

EXEC @hr = sp_OASetProperty @iMsg, 'Subject', @Subject

EXEC @hr = sp_OASetProperty @iMsg, 'TextBody', @Body

EXEC @hr = sp_OAMethod @iMsg, 'Send', NULL 
```

我不明白使用 T-SQL 等效项设置标头的语法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-06T06:59:17.873

EXEC @hr = sp_OASetProperty @iMsg, 'Configuration.fields(" [http://schemas.microsoft.com/cdo/configuration/](http://schemas.microsoft.com/cdo/configuration/) **senduserreplyemailaddress** ").Value', 'search@google.com'

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-06T06:10:07.337

请改用[SQL Server 2005 的数据库邮件](http://www.sql-server-performance.com/articles/dba/email_functionality_p1.aspx)功能。

# php - 在 PHP 中使用表单持久化对象的最佳方法是什么？

> ID：617793
> 
> 赞同：1
> 
> 时间：2009-03-06T06:05:49.280
> 
> 标签：php, oop, object, persistence

我有一个 PHP 应用程序，我希望某些对象以下列方式持久存在：

1.  该对象不得存在于 $_SESSION 中。单独的 Web 浏览器窗口必须控制对象的单独实例。
2.  最终用户不能通过手动更改 $_REQUEST 变量的内容来修改对象（如果发生这种情况，则应将请求视为已损坏）。

是否有最佳实践/正确的方法来做到这一点？随着 PHP 变得越来越面向对象，我担心我正在重新发明轮子。

这段代码的主要目的是允许在不使用数据库的情况下创建和操作复杂对象，直到它们被提交，然后我将使用适当的事务将它们完全提交到数据库。我想让我的数据库只包含完整的发票，或者根本不包含发票。

我目前的方法如下：

```
<?php

include('encrypt.php');
include('invoice.class.php');

if(isset($_REQUEST['invoice']))
{
    $invoice = unserialize(decrypt(base64_decode($_REQUEST['invoice'])));
    if(!($invoice instanceOf invoice)) throw new exception('Something bad happened');
}
else
{
    // Some pages throw an exception if the $_REQUEST doesn't exist.
    $invoice = new invoice();
}

if(isset($_REQUEST['action']) && $_REQUEST['action'] == 'addLine')
{
    $invoice->addLine(new invoiceLine($_REQUEST['description'], $_REQUEST['qty'], $_REQUEST['unitprice']);
}

?>
<form action="index.php" method="post">
<input type="text" name="qty" />
...
<input type="hidden" name="invoice" value="<?php echo(base64_encode(encrypt(serialize($invoice)))); ?>" />
</form> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-06T07:04:01.543

这里有一个技巧：把它放在饼干里！

简洁的算法：

$data = 序列化($object); $时间=时间（）；$signature = sha1($serverSideSecret . $time . $data); $cookie = base64("$signature-$time-$data");

好处是你

a) 可以在需要时使 cookie 过期，因为您使用时间戳作为签名哈希的一部分。

b) 可以验证数据没有在客户端被修改，因为您可以从 cookie 中的数据段重新创建散列。

此外，如果它太大，您不必将整个对象存储在 cookie 中。只需将您需要的数据存储在服务器上，并使用 cookie 中的数据作为密钥。

我不能把算法归功于这个算法，我是从 Flickr 成名的 Cal Henderson 那里学到的。

编辑：如果您发现使用 cookie 过于复杂，请忘记它们，并将本应进入 cookie 的数据存储在隐藏的表单字段中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-06T07:28:40.750

您还可以使用简单的隐藏表单输入在客户端上保存状态，无需 cookie。只要数据（可能是序列化的 blob）经过加密和签名，用户就无法在不中断会话的情况下对其进行修改。

Steve Gibson 将这种方法用于他的定制电子商务系统。虽然他的代码不是开源的，但他在[Security Now 第 109 集](http://www.grc.com/securitynow.htm)“GRC 的电子商务系统”中彻底解释了保存状态的方法，无需在服务器上存储敏感数据或需要 cookie 支持。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-06T06:45:56.690

我要做的是将加密*密钥*（而不是整个结构，就像您的示例那样）存储在隐藏的表单变量中。此键是`uncreated_invoices`存储不完整发票的表的索引。

在页面之间，您更新 uncreated_invoices 表中的数据，完成后，将其拉出并提交。如果您将用户名放入 uncreate_invoices 表中，这也会让他们从上次中断的地方继续（不确定这是否是一个有效的用例）。无论如何，将用户名放在其中可能是个好主意，这样人们就不能试图劫持其他人的发票。

如果您愿意，您可能可以在 uncreated_invoices 表中存储序列化数据。就个人而言，我会对其进行规范化（多少取决于您的架构），以便您可以轻松添加/删除各个部分。

编辑：我忘了提到你应该`uncreated_invoices`定期清理桌子，这样它就不会被过期的发票填满。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-06T08:22:22.730

您不能将数据存储在 $_SESSION 中的数组中，然后为每个窗口设置一个唯一的 ID。如果每个窗口都有唯一的 id，您可以将 id 作为表单的一部分传递。根据窗口 ID 存储/检索会话或数据库中的数据。

所以像这样的东西？$_SESSION['data'][$windowid]->$objectname

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-06T06:16:05.433

如果你不能使用 SESSION 那么你必须自己持久化数据。您必须将数据放置在可以持久保存的位置，例如数据库或其他文件。除了 SESSION 之外，它是保存数据的唯一方法。

我收回这一点，您可以在每个 HTML 页面中发送数据并在本地使用它。每个接受数据的页面都必须创建延续数据序列的 HTML/Javascript。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-06T06:17:00.457

如果您将内容存储在客户端，则可以对其进行修改。是否有您不想将对象存储在会话中的特定原因？如果存储对象实际上不可行，则需要将其保存在服务器上的其他位置。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-06T06:19:13.743

没关系，他们将能够添加他们想要的所有项目。您的代码中的问题是您从请求中获取项目描述符、数量和价格，价格确实应该在后台查找，否则，用户可以手工制作他们的价格。哎呀，负值物品，你可以免费得到东西。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-06T06:22:00.850

你想存储一些东西。这通常在数据库中完成。如果不在数据库中查找，您如何知道某物的价格？所以使用相同的数据库来存储有关当前用户/会话的信息。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-06T07:31:24.443

您可以使用[魔术方法](http://de2.php.net/manual/en/language.oop5.magic.php) `__sleep()`和`__wakeup()`

# iphone - 如何在 iPhone 上使用滚动视图？

> ID：617796
> 
> 赞同：9
> 
> 时间：2009-03-06T06:08:46.373
> 
> 标签：iphone, objective-c, cocoa-touch, uikit, uiscrollview

我想显示一个有很多行的文本。我在滚动视图中添加了一个多行标签，但它没有显示任何内容。看起来这不是使用滚动视图的正确方法。如何使用滚动视图使用户可以向下拖动以查看更多文本？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-03-06T06:55:28.927

Apple 的[UIScollView 文档](http://developer.apple.com/iphone/library/documentation/UIKit/Reference/UIScrollView_Class/Reference/UIScrollView.html)非常好，您应该从那里开始并了解该类。

将 Scrollview 视为屏幕在其上滑动的大视图表面*。您可以将子视图添加到滚动视图，然后滚动就像将屏幕定位在滚动视图上 - 屏幕就像一个窗口，您可以看到下面滚动视图的部分内容。

为此，滚动视图比普通 UIView 具有一些额外的属性 - 但它在一个重要方面就像 UIView：它本身不直接呈现任何内容。您需要添加一个子视图来绘制您的文本。滚动视图的设置和显示方式与 UIView 完全相同 - 即您设置框架将其添加到另一个视图并显示您的文本，您需要将子视图添加到可以实际呈现文本的 UIScrollView。

为了设置您请求的基本 UIScrollView，您应该像普通的全屏视图一样创建它 - 将框架设置为与窗口相同的大小，并将滚动视图作为子视图添加到窗口中。然后制作一个大的 UITextView 来保存您的文本。UIText 视图可以随心所欲——特别是它可以比屏幕大。将 UIScrollView 的 contentSize 属性设置为与 UITextView 的 frame 相同，然后将 UIText 视图添加为 UIScrollView 的子视图。

完成此操作后，您可以使用 contentOffset 属性自动移动内容，控制缩放并设置委托以观察滚动事件。

* 更准确地说，框架在其上滑动，但我假设您正在制作全屏 UIScrollView。如果你想要一个更小的视图，我相信你可以概括它。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-03-06T06:38:20.373

您可以只使用 UITextView。它是 UIScrollView 的子项，如果将它的 text 属性设置为不适合其框架的文本量，则视图将变为可滚动的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-03-16T14:28:35.367

我以这种方式使用 UIScrollView 作为我的一个应用程序中的说明窗格。它奏效了，但我对结果不满意。然后我切换到使用 UIWebView 并且对结果更满意。它自动处理滚动视图的大小，我获得了 HTML 的所有格式化功能，并且我可以拥有指向其他信息（或外部站点）的链接，只需添加另一个 HTML 文件和一些委托代码。这是我使用的代码（我将 HTML 文件作为资源添加到我的应用程序中）：

```
NSString *path = [[NSBundle mainBundle] pathForResource:@"instructions" ofType:@"html"];
NSFileHandle *readHandle = [NSFileHandle fileHandleForReadingAtPath:path];
NSString *htmlString = [[NSString alloc] initWithData: [readHandle readDataToEndOfFile] encoding:NSUTF8StringEncoding];
[self.instructionsView loadHTMLString:htmlString baseURL:nil]; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-08-19T02:18:03.513

你可以参考这个网站[http://www.edumobile.org/iphone/iphone-programming-tutorials/scrollview-example-in-iphone/](http://www.edumobile.org/iphone/iphone-programming-tutorials/scrollview-example-in-iphone/)

你按照一步一步在iphone中制作滚动视图......祝你好运:)

# iphone - 无线网络应用

> ID：617802
> 
> 赞同：3
> 
> 时间：2009-03-06T06:10:20.830
> 
> 标签：iphone, cocoa-touch, wifi

你好

我正在开发游戏，因为我想通过 Wi-Fi 玩那个游戏。这么多一个

玩家也可以玩游戏。我想为iphone开发这个游戏。我通过了 WiTap

developer.apple.com 上的应用程序，因为它很难使用。因此，如果有人知道如何通过 iphone 的 Wi-Fi 向 iphone 发送简单的数据，如整数或字符串等。请帮助我使用简单的应用程序。:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-06T06:13:37.220

iphone 具有基本的 Unix 功能。所以简单的套接字就可以了。

这是一个很好的起点。

[http://students.cs.byu.edu/~cs460ta/cs460/labs/sockettutorial.html](http://students.cs.byu.edu/~cs460ta/cs460/labs/sockettutorial.html)

# c++ - 在结构化异常的情况下展开堆栈

> ID：617809
> 
> 赞同：4
> 
> 时间：2009-03-06T06:13:59.870
> 
> 标签：c++, mfc, exception-handling, stack, seh

这个问题更清楚地说明了[这里](https://stackoverflow.com/questions/616270/reasons-for-stack-unwinding-fail)描述的问题。我做了更多调查，发现堆栈展开没有发生在以下代码中：

```
class One
{
public:
    int x ;
};

class Wrapper
{
public:
    Wrapper(CString csText):mcsText(csText)
    {
        CString csTempText;
        csTempText.Format("Wrapper constructor :: %s\n", mcsText);
        OutputDebugString(csTempText);
    }

    ~Wrapper()
    {
        CString csTempText;
        csTempText.Format("Wrapper destructor :: %s\n", mcsText);
        OutputDebugString(csTempText);
    }
    CString mcsText;
};
class Test
{
    public:

    void notifyError()
    {
        try
        {
            int x = 10; 
        }
        catch(...)  {}
    }

    void OnRecvBuffer()
    {
        try
        {
            Wrapper a("AddRef");    
            One* p = NULL;
            p->x = 10;
        }
        catch(...)
        {
            notifyError();
        }   
    }   
};

int main() 
{
    Test* pTest = new Test;

    pTest->OnRecvBuffer();

    OutputDebugString("Test");
} 
```

我使用 VC6 SP5 编译器编译了这段代码，输出为“Wrapper constructor :: AddRef !!!” （即未调用在堆栈上构造的包装器对象的析构函数。这是预期的行为吗？还是 VC 编译器的错误？我可以使用一些编译器标志以便在这种情况下发生堆栈展开吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-06T06:24:38.033

**在未定义行为的情况下，C++ 标准没有提供任何可使用的东西。即使 MS 有。这是特定于平台的事情——所以要小心。一些这样的浮点异常被转换为 Win32 异常，您可以尝试用`_set_se_translator()`. 问题是您可以捕获 Win32 异常，但是您的堆栈将无法正确展开。至少这不是你可以赌上生命的事情。这就是练习的徒劳。**

> 更新：故意抛出异常以检查堆栈展开。问题是为什么 Wrapper 类的析构函数没有被调用。– 纳文

如果是这种情况 - 不要这样做。有比通过未定义行为更好的方法来引发异常。

例如：

```
void OnRecvBuffer()
{
    try
    {
        Wrapper a("AddRef");    
        throw 42; // this'll throw an exception without invoking UB
    }
    catch(...)
    {
        notifyError();
    }
} 
```

您不能取消引用 NULL 指针。您在这里调用未定义的行为：

```
One* p = NULL;
p->x = 10; 
```

在那条线之后，所有的赌注都被取消了，你本**可以**杀了我们所有人；）

`p`是指向`One`对象的指针。它应该包含一个`One`对象的地址。您已将其初始化为 0 - 地址 0 处没有对象。0 不是任何对象的有效地址（这是由标准保证的）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-06T06:41:55.140

如果要使用 SEH，则必须使用 _set_se_translator 函数和 /EHa 编译器选项。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-06T06:30:23.200

因为 C++ 常规异常不处理这种异常，所以您必须使用对应用程序一无所知且不会展开的 SEH。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-06T08:35:18.673

这是未定义的行为：

```
One* p = NULL;
p->x = 10; 
```

此时，应用程序可以在不展开堆栈的情况下自由崩溃。
如果要测试堆栈展开，请将其替换为：

```
 throw 42; // Life the Universe and Everything thrown away 
```

您不应该动态分配所有对象，这是 C++ 而不是 Java！

```
int main() 
{
    Test    pTest;   // Note the lack of new!

    pTest.OnRecvBuffer();

    OutputDebugString("Test");
} 
```

# asp.net-ajax - 使用 ScriptManager 时解析错误

> ID：617818
> 
> 赞同：1
> 
> 时间：2009-03-06T06:22:42.250
> 
> 标签：asp.net-ajax

我有一个两天前运行良好的 Web 应用程序。当我将此网站移至另一台机器时，遇到以下问题。

在我的网页中，我已将 ScriptManager 声明为：

```
<asp:ScriptManager ID="scriptMgr" runat="server">
</asp:ScriptManager> 
```

当我访问网页时，我收到此错误：

```
The base class includes the field 'scriptMgr', but its type (System.Web.UI.ScriptManager) is not compatible with the type of control (System.Web.UI.ScriptManager). 
```

在另一个网页上，我收到以下错误：

```
The base class includes the field 'upProgress', but its type (System.Web.UI.UpdateProgress) is not compatible with the type of control (System.Web.UI.UpdateProgress). 
```

我的 Web 应用程序基于 ASP.NET 2.0 构建，并且我还验证了 System.Web.Extensions.Dll 的正确 (1.0.61025.0) 版本是否存在于我的应用程序的 bin 文件夹中。

web.config 中 System.Web.Extensions.Dll 的条目是：

```
<configSections>
<sectionGroup name="applicationSettings" type="System.Configuration.ApplicationSettingsGroup, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" >
  <section name="CSI.OLS.Library.Properties.Settings" type="System.Configuration.ClientSettingsSection, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" requirePermission="false" />
</sectionGroup>
<sectionGroup name="system.web.extensions" type="System.Web.Configuration.SystemWebExtensionsSectionGroup, System.Web.Extensions, Version=1.0.61025.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35">
  <sectionGroup name="scripting" type="System.Web.Configuration.ScriptingSectionGroup, System.Web.Extensions, Version=1.0.61025.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35">
    <section name="scriptResourceHandler" type="System.Web.Configuration.ScriptingScriptResourceHandlerSection, System.Web.Extensions, Version=1.0.61025.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" requirePermission="false" allowDefinition="MachineToApplication"/>
    <sectionGroup name="webServices" type="System.Web.Configuration.ScriptingWebServicesSectionGroup, System.Web.Extensions, Version=1.0.61025.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35">
      <section name="jsonSerialization" type="System.Web.Configuration.ScriptingJsonSerializationSection, System.Web.Extensions, Version=1.0.61025.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" requirePermission="false" allowDefinition="Everywhere" />
      <section name="profileService" type="System.Web.Configuration.ScriptingProfileServiceSection, System.Web.Extensions, Version=1.0.61025.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" requirePermission="false" allowDefinition="MachineToApplication" />
      <section name="authenticationService" type="System.Web.Configuration.ScriptingAuthenticationServiceSection, System.Web.Extensions, Version=1.0.61025.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" requirePermission="false" allowDefinition="MachineToApplication" />
    </sectionGroup>
  </sectionGroup>
</sectionGroup> 
```

似乎这两个错误都与使用 AJAX 功能有关。谁能告诉我，什么可能导致上述错误？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-06T06:34:46.450

asp.net 2.0 不需要扩展补丁来正确支持 ajax 应用程序吗？

[http://www.asp.net/AJAX/downloads/](http://www.asp.net/AJAX/downloads/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-01T19:57:10.807

这似乎是 .NET 2.0 AJAX 1.0 与 .NET 3.5 AJAX 的问题。（即，AJAX 库直接包含在 .NET 3.5 中，看来您正在尝试使用 .NET 3.5 版本的 AJAX 库。）

我在应用程序中遇到了同样的问题，并找到了[该](http://forums.asp.net/t/1160833.aspx "论坛.asp.net")问题的参考，并提供了两个解决问题的建议。

一个建议是在您的项目文件对 System.Web.Extensions.dll 程序集的引用中将*Specific Version*属性设置为*True*。由于您明确引用了该程序集的 1.0.61025.0 版本，我怀疑这会解决问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-11-03T15:55:49.370

一个迟到的答案:)但我在我的产品中遇到了类似的问题，并通过将以下内容添加到 web.config 来解决它

```
<runtime>
        <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
            <dependentAssembly>
                <assemblyIdentity name="System.Web.Extensions" publicKeyToken="31bf3856ad364e35"/>
                <bindingRedirect oldVersion="1.0.0.0-1.1.0.0" newVersion="3.5.0.0"/></dependentAssembly>
            <dependentAssembly>
                <assemblyIdentity name="System.Web.Extensions.Design" publicKeyToken="31bf3856ad364e35"/>
                <bindingRedirect oldVersion="1.0.0.0-1.1.0.0" newVersion="3.5.0.0"/></dependentAssembly>
        </assemblyBinding>
</runtime> 
```

这会重定向程序集绑定以便使用新版本，从而解决冲突

# iis - 访问指向网络共享的虚拟目录时出现 401.1 错误

> ID：617819
> 
> 赞同：4
> 
> 时间：2009-03-06T06:23:31.830
> 
> 标签：iis, virtual-directory, sharing, network-share

IIS5 在 SERVER1 上运行。

IIS 中的一个虚拟目录 myfiles 指向“另一台计算机上的共享位置”，//SERVER2/myfilesshare

当我尝试访问该页面时： [http://SERVER1/myfiles](http://SERVER1/myfiles)

...我得到错误：

**您无权查看此页面**

**HTTP 401.1 - 未经授权：登录失败**

**互联网信息服务**

我已经三重检查了 IIS 中的“连接为...”设置。我用来访问共享的凭据是正确的——它们在 Windows 资源管理器中连接到共享时有效，但不是通过 IIS 虚拟目录。我已经尝试向 SERVER2 中的文件夹上的每个人授予完全权限，但没有运气。

有什么想法吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2015-04-21T15:39:23.643

这就是我解决问题的方法，可能会对你有所帮助。

默认情况下，IIS`IUSR`在使用匿名身份验证时使用为虚拟目录调用的本地用户。**它不使用应用程序标识**，如果您使用`procmon`.

如何强制它使用应用程序身份？

很简单，在 IIS 管理器下：

1) 去认证

2）编辑“匿名认证”

3) 选择“应用程序池标识”

4）重新启动IIS，它应该可以工作。

使用 PS 完成相同的操作：`Set-WebConfigurationProperty -filter /system.WebServer/security/authentication/AnonymousAuthentication -name username -value ""`

此链接包含优点/缺点：http: [//blogs.technet.com/b/tristank/archive/2011/12/22/iusr-vs-application-pool-identity-why-use-either.aspx](http://blogs.technet.com/b/tristank/archive/2011/12/22/iusr-vs-application-pool-identity-why-use-either.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-06T06:45:16.520

权限问题可能很棘手。尝试在“其他计算机”上运行**filemon**它可以在这里下载：[http](http://technet.microsoft.com/en-us/sysinternals/bb896642.aspx) ://technet.microsoft.com/en-us/sysinternals/bb896642.aspx （它不是一个大应用程序，只是一个小型轻量级工具）

启动 filemon 后，停止监视进程（我相信当您启动应用程序时它默认打开），清除记录的数据，为您无法访问的文件夹创建一个过滤器。启动监控进程。请求您的网页。停止监视进程并在 filemon 中查找“拒绝访问”消息。找到后，filemon 还将提及尝试访问的实际用户的名称。这可能会帮助您找到解决方案。

顺便说一句，当使用 Windows Server 2008 时，您将需要**processmon**：[http ://technet.microsoft.com/en-us/sysinternals/bb896645.aspx](http://technet.microsoft.com/en-us/sysinternals/bb896645.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-22T08:35:38.647

想象一个场景，无论出于何种原因，您希望 IIS 服务器访问文件服务器上的共享，但它们不在同一个域中。

如果你可以按照并让它为你工作（我已经用 IIS 7 完成了 Win2008-R1 32 位文件服务器和 Win2008-R2 64 位），那么你应该在任何情况下都处于良好状态。

*   两台服务器上的同名本地帐户，密码相同
*   在 IIS 上，用于`aspnet_regiis -ga MyAccount`授予对 IIS 内脏的本地帐户访问权限
*   现在将其用作网站的应用程序池标识
*   使用本地安全策略（管理工具）为本地帐户启用委派信任
*   重新启动 IIS 服务器
*   在文件服务器上，使用本地安全策略为本地帐户启用网络访问
*   创建共享向本地帐户授予所需的权限（根据需要还包括安全选项卡权限）
*   在两者上打开文件和打印共享端口（尽可能限制），以指出当您在两者之间使用 Windows 资源管理器时它适用于您的位置
*   返回 IIS，使用文件服务器中共享文件夹的 UNC 路径创建虚拟目录
*   只需使用直通身份验证（将使用您的本地帐户）
*   您可以告诉虚拟目录的匿名身份验证设置也使用应用程序池标识

使用可以测试/验证的东西。真正的关键是信任使用`Service Account`（域或其他）委派，并让 IIS 使用您希望它使用的帐户而不是本地服务器或网络服务。

这花了我一整天的时间才弄清楚。StackOverflow 和其他 Internet 资源中的各种线程帮助我找到了各种资源，但在任何地方都没有找到我的确切答案。希望下一个遇到这个问题的人能够通过我对对我有用的描述来解决问题的速度。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-06T06:26:39.060

尝试在虚拟目录安全选项卡上启用 Windows 身份验证（在 IIS 中）。

# c++ - 在字符串中搜索垃圾字符

> ID：617825
> 
> 赞同：2
> 
> 时间：2009-03-06T06:26:49.403
> 
> 标签：c++

朋友们

我想将以下代码集成到主应用程序代码中。使用 o/p 字符串填充的垃圾字符会转储应用程序以下代码片段不起作用..

```
void stringCheck(char*);

int main()
{
    char some_str[] = "Common Application FE LBS Serverr is down";
    stringCheck(some_str);
}

void stringCheck(char * newString)
{
    for(int i=0;i<strlen(newString);i++)
    {
        if ((int)newString[i] >128)
        {

TRACE(" JUNK Characters in  Application Error message FROM DCE IS = "<<(char)newString[i]<<"++++++"<<(int)newString[i]);

        }
    }
} 
```

有人可以告诉我在字符串中查找垃圾字符的更好方法吗？

非常感谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-06T06:33:48.217

您`char`可能已签名。将其转换为`unsigned char`以避免在转换为时它变成负整数`int`：

```
if ((unsigned char)newString[i] >128) 
```

根据您的需要，`isprint`可能会做得更好，检查可打印字符，包括空格：

```
if (!isprint((unsigned char)newString[i])) 
    ... 
```

请注意，您必须强制转换为`unsigned char`: input for`isprint`需要介于`0`和`UCHAR_MAX`作为字符值之间的值。

# c# - 验证货币、浮点数或整数的 C# 正则表达式是什么？

> ID：617826
> 
> 赞同：8
> 
> 时间：2009-03-06T06:26:58.263
> 
> 标签：c#, regex, numbers, currency

什么是适合 C# 的正则表达式，如果它与以下匹配，它将验证一个数字？

> ```
>  $1,000,000.150
>  $10000000.199
>  $10000 
>  1,000,000.150
>  100000.123
>  10000 
> ```

还是负等价物？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-06T06:42:21.877

如果您对它稍作修改，就可以使用 csmba 的正则表达式。

```
^\$?(\d{1,3},?(\d{3},?)*\d{3}(.\d{0,3})?|\d{1,3}(.\d{2})?)$ 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-06T06:49:24.870

我觉得ssg是对的。正则表达式的使用并不是很好，尤其是当您的软件必须处理以非美国为中心的数据输入时。

例如，如果货币符号是欧元、日元或英镑，那么其他十几种货币符号中的哪一种？

数字格式规则呢？

在美国你会进入`1,000,000.00`，但在法国，这应该是`1.000.000,00`。其他国家/地区允许数字分组之间的间距...

如果您在不考虑文化的情况下使用直接的正则表达式，那么除非您 100% 确定您的软件永远不会在非美国为中心的环境中使用，否则您永远不会成功验证。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-06T06:37:03.823

```
^\$?(\d{1,3},?(\d{3},?)*\d{3}(\.\d{1,3})?|\d{1,3}(\.\d{2})?)$ 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-18T07:14:39.477

我想我发现 ssg 的解决方案有问题（或者可能是 MS 错误！）。

运行这个：

```
float.TryParse("0,2",NumberStyles.Currency, CultureInfo.GetCultureInfo("en-US"), out num) 
```

返回真。当然“0,2”不是有效的货币价值吗？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-06T19:19:48.530

小心浮动。最终，您将遇到一个案例，例如 0.01，表示为 0.00999999。字符串或整数更好用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-06T06:37:10.267

试试这个。它可能需要一些微调以只允许一个小数点，但它确实符合您的测试用例。我希望这有帮助。

```
[$\d,.]+ 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-24T14:09:38.133

对美国货币使用此正则表达式 \$(\d)*\d 匹配 $300,$12900 不匹配 $12900.00

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-09-26T04:57:46.693

这个正则表达式对我有用：

```
'^[$]{0,1}([0-9]+[,]?[0-9]+|[0-9]{1,3}([.][0-9]{3})*([,][0-9]+)?)$' 
```

带开关

```
'^\${0,1}(\d+,?[0-9]+|\d{1,3}(\.\d{3})*(,\d+)?)$' 
```

它适用于

*   1,000,000.150 美元
*   10000000.199
*   10000 美元
*   1,000,000.150
*   100000.123
*   10000

# php - 将站点从 asp.net 移植到 LAMP (php) 堆栈时，我们将面临哪些挑战？

> ID：617829
> 
> 赞同：1
> 
> 时间：2009-03-06T06:28:33.267
> 
> 标签：php, asp.net, porting

我们有一个用 asp.net c# (3.5) 和 SQL server 编写的企业应用程序，我们希望为客户捆绑和发布。

但是，由于成本原因，一些人表示担心它**需要Microsoft 服务器。**是的，我知道...因此，我们正在考虑将其移植到 LAMP 堆栈，其中“P”指的是 php。

**在来自 Visual Studio asp.net 环境的 LAMP 堆栈上进行开发可能会面临哪些挑战？**

我确定的问题是：

1.  调试：Visual Studio 非常适合客户端和服务器端调试。
2.  框架：模型背后的代码运行良好，MVC 框架也不错。
3.  维护：我们希望该功能集在两个平台上都通用。
4.  数据库层：代码与 mssql 数据类型松散耦合。

如果您经历过这个令人兴奋的过程，我很想知道一些建议/提示是什么感觉。

*作为一个方面，我们有什么办法可以按原样运行这段代码吗？单核细胞增多症？其他的？*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-06T11:16:44.930

您可以考虑的另一个 PHP IDE 是 NetBeans。

作为一名 .NET、Java 和 LAMP 开发人员，最大的变化主要是文化方面的。例如，PHP 具有不使用 OO 原则的传统，而 ASP .NET 最初是作为具有完全 OO 支持的 .NET 语言开始的。这种基本差异会导致重大问题，例如 PHP 的保留关键字列表过长等等。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-09T15:50:04.170

其他 MVC 框架：

*   代码点火器
*   小花
*   易

（刚刚发现了 Yii。[这是一篇](http://www.beyondcoding.com/2009/03/02/choosing-a-php-framework-round-2-yii-vs-kohana-vs-codeigniter/)比较它们的文章。）

那里可能还有六个。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-06T10:56:17.163

与 *AMP 堆栈相比，我在 .NET 方面的经验更多，但根据我在 XAMPP 方面的经验，我将提供以下意见

1.  调试：Visual Studio 非常适合客户端和服务器端调试。

    [Eclipse PDT](http://www.eclipse.org/pdt/)非常适合设计、开发和调试。我听说过有关 Zend Studio 的好消息，但还没有使用它。

2.  框架：模型背后的代码运行良好，MVC 框架也不错。

    有一些框架允许您将表示与逻辑分开（例如[Smarty](http://www.smarty.net/rightforme.php)），并且至少有一个 MVC 框架可用（例如[CakePHP](http://cakephp.org/)）

3.  维护：我们希望该功能集在两个平台上都通用。

    如果您排除了 Windows 特定功能（Windows 集成安全等），那么您在两个堆栈**中都不**能做太多事情，但是如果您必须重现像 gridview 这样的控件，那将是劳动密集型的。

4.  数据库层：代码与 mssql 数据类型松散耦合。

    我不知道任何无法在 mysql 和 sql server 之间映射的数据类型，并且有很好的文档来[处理迁移](http://dev.mysql.com/doc/migration-toolkit/en/index.html)

Mono 可能会减少移植您的解决方案所需的时间，但我不知道您可以“按原样”重用所有代码的任何方式。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-09T02:08:01.980

我自己有 Asp.net 背景，过去几个月一直在研究开源框架。我还没有拿定主意。我最近一直在看 Grails。似乎两全其美——企业平台上的脚本化、易于使用、开源的 RAD MVC 框架。它使用 Groovy 脚本语言（类似 ruby​​），但在 JVM 上运行，因此您可以根据需要使用完整的 Java 框架。有大量预先编写的 Java 组件可供使用。这东西很酷。您将能够非常快速地移植您现有的应用程序。不过，您需要一个 Tomcat 虚拟主机。

如果您需要 PHP，直接 PHP 的性能相当不错，但大多数框架的性能都很差。如果直接使用 PHP，则没有 mvc。您将使用传统的基于页面的模型。但你会感觉更自在。您可以使用 PDO 滚动您自己的 DAL 并使用存储过程。不过，您将需要一个模板系统。远离使用自己的模板语言的 Smarty。它很慢，为什么您需要学习单独的模板语言。我从来没有得到那个。改用 Savant：http: [//phpsavant.com/](http://phpsavant.com/)。它使用 php 作为模板语言，速度很快。您也可以通过为每个站点页面创建模板页面来模仿代码隐藏。就 mvc 而言，有一个名为 Yii 的新 PHP 框架（[http://www.yiiframework.com/](http://www.yiiframework.com/)) 声称对 php 框架具有最佳性能。它也有据可查。如果您来自 .Net，它可能是目前最好的 php 框架。感觉像 Zend 一样有进取心，但没有糟糕的表现。其他大多数都是玩具式的，或者像 Symphony 和 Cake 一样非常慢。PHP 与 Apache 配合得很好。与 Rails 和 Django 不同，没有太多的调整或维护。

接下来，您需要一个 IDE。使用 Netbeans。使用 PHP 版本并安装[http://www.xdebug.org/](http://www.xdebug.org/)。会觉得不如VS，但也不错。

对于数据库，MySql 是一个性感的选择，但 Postgres 更胜一筹。它有一个可以完成所有工作的数据库引擎。使用 Mysql，您想要的一些功能在 InnoDB 中，一些在 MyIsam 中。如果您需要外键和事务，则必须使用 InnoDB。使用 MyIsam 进行全文搜索和更快的读取性能。Postgres 的性能随着版本 8 的发布（现在和 mysql 一样）有了很大的提高，并且最终有了一个不错的 windows 安装程序。

# java - 在使用preparedStatement 选择时更新数据库

> ID：617831
> 
> 赞同：1
> 
> 时间：2009-03-06T06:30:20.253
> 
> 标签：java, prepared-statement

我正在从 MS SQL 数据库中选择一个数据子集，使用`PreparedStatement`. 在遍历结果集时，我还想更新行。目前我使用这样的东西：

```
prepStatement = con.prepareStatement(
                    selectQuery,
                    ResultSet.TYPE_FORWARD_ONLY,
                    ResultSet.CONCUR_UPDATABLE);

 rs = prepStatement.executeQuery();

while(rs.next){
rs.updateInt("number", 20)
rs.updateRow();
} 
```

使用正确的值更新数据库，但出现以下异常：

```
Optimistic concurrency check failed. The row was modified outside of this cursor. 
```

我已经用谷歌搜索了它，但在这个问题上找不到任何帮助。

如何防止此异常？或者既然程序做了我想做的事，我可以忽略它吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-06T14:17:48.973

记录在从数据库中检索（通过光标）到您尝试将其保存回来的那一刻之间已被修改。如果`number`列可以独立于记录的其余部分*或*独立于已经将`number`列设置为其他值的其他进程安全地更新，您可能会尝试这样做：

```
con.execute("update table set number = 20 where id=" & rs("id") ) 
```

但是，**竞争条件仍然存在**，您的更改可能会被另一个进程覆盖。

最好的策略是**忽略异常**（记录未更新），可能将失败的记录推送到队列（在内存中），**然后**对失败的记录进行第二次传递（重新评估条件`query`并酌情更新 -如果还不是这种情况，请添加`number <> 20`为条件之一。）重复直到没有更多记录失败。`query`最终所有记录都会被更新。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-09T04:24:51.443

假设您确切知道要更新哪些行，我会这样做

*   将您的自动提交设置为关闭
*   将隔离级别设置为可序列化
*   SELECT row1, row1 FROM table WHERE somecondition FOR UPDATE
*   更新行
*   犯罪

这是通过悲观锁定实现的（假设您的数据库支持行锁定，它应该可以工作）

# asp.net - 每个客户端使用单个数据库时的用户身份验证？

> ID：617833
> 
> 赞同：1
> 
> 时间：2009-03-06T06:32:25.957
> 
> 标签：asp.net, sql-server, security, authentication

我的公司正在构建一个 ASP.NET HR 应用程序，我们决定为每个客户端创建一个数据库。这确保客户端不会意外查看另一个客户端的数据，同时还允许轻松扩展（以及其他好处，已在[此处](https://stackoverflow.com/questions/13348/what-are-the-advantages-of-using-a-single-database-for-each-client)讨论）。

我的问题是 - 在这种情况下处理安全和数据访问的最佳方法是什么？我的意图是使用一个通用的登录/帐户数据库，将用户引导到正确的服务器/数据库。该公共数据库还将包含每个用户/角色可以访问的应用程序功能。

我不打算将任何用户信息放在每个单独的客户端数据库中，但我团队中的其他人认为每个数据库缺乏安全性是一个巨大的漏洞（但他们无法清楚地说明复制公共访问逻辑会有多大用处）。

我错过了什么吗？我们是否应该在客户端数据库级别添加额外的安全/身份验证层？

**更新：**
我的团队认为双用户管理是必要的原因之一是访问控制。所有用户都有一个默认角色（例如管理员、最小访问权限、高级用户等），但客户端管理员将能够为有权访问其数据库的用户细化权限。对我来说，将其放在中央数据库中似乎仍然可行，但我的团队不同意。想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-06T16:07:09.443

我们有一个 SaaS 解决方案，每个客户端模型使用一个数据库。我们也有一个通用的“安全”数据库。但是，我们将所有用户信息存储在各个客户数据库中。

当用户登录系统时，他们会告诉我们三个信息，用户名、密码和客户端 ID。客户端 ID 用于在“安全”数据库中查找他们的主数据库，然后代码连接到他们的主数据库以检查他们的用户名/密码。通过这种方式，客户端在其数据库中是完全独立的。当然，除了用户名之外，您还需要一些信息来确定他们的主数据库。可能是我们的客户端 ID 方法，或者如果您使用每个客户端的子域方法，则可能是请求的域名。

这里的优点是您可以移动“客户端”数据库，而不必让它们与安全数据库同步。另外，当您尝试查找用户信息时，您不需要处理 w/cross-db 连接。

**更新：**响应您的更新......每个客户拥有自己的数据库的优势之一是如果他们真的需要它，他们能够恢复客户。如果您将客户的数据拆分为两个数据库，您如何恢复它？同样，如果用户是在主数据库以外的数据库中定义的，您将需要担心跨数据库数据访问。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-06T06:38:05.350

我一直认为应该在应用程序级别而不是数据库级别强制执行安全性。话虽如此，我认为您的预期方法没有问题。通过中央数据库管理帐户和角色使应用程序从长远来看更易于维护。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-06T06:44:16.193

您可能希望研究使用[ASP.NET 成员资格提供程序](http://msdn.microsoft.com/en-us/library/yh26yfzy.aspx)来处理身份验证管道。这将适用于您声明的方法，您仍然可以将所有身份验证数据保存在单独的数据库中。但是，我同意 Chris 的观点，即保留一个 DB 最终将更易于维护。

# version-control - 版本管理/备份解决方案

> ID：617838
> 
> 赞同：1
> 
> 时间：2009-03-06T06:36:24.043
> 
> 标签：version-control, backup

这不是**严格意义**上的技术问题，但我觉得这对许多技术人员也很有用。

我正在寻找一种**不仅**适用于源代码的版本管理/备份解决方案。这可能适用于非文本文件，例如图像。

要求是这样的——

1.  每次我从应用程序中保存文件时，它都应该创建一个版本。
2.  我应该能够为重大修订添加评论。
3.  在任何时候，都应该只有一个当前版本。
4.  我应该能够查看以前的版本而无需进行“恢复”
5.  我应该能够在版本之间来回移动。
6.  如果我可以从资源管理器上下文菜单中获取特定文件的日历功能，则显示文件的各种版本会很有帮助

我真的不需要比较不同的版本或类似的东西。

仅限 Windows 解决方案。我看过[NTI Shadow](http://www.ntius.com/shadow.asp)，它有点接近我正在寻找的东西。

是否有针对上述要求的付费/免费/开源解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-06T06:48:15.030

我所知道的几乎所有版本控制系统都支持二进制上传。[Subversion](http://subversion.tigris.org/)（简称 SVN）是免费的并且非常受欢迎。如果您还下载[TortoiseSVN](http://tortoisesvn.net/downloads)，您可以在 Explorer 中处理所有内容。

我无法帮助您的唯一要求是 1\. 从您的应用程序中自动保存。但是您当然可以通过在文件系统中复制旧版本的文件并通过 TortoiseSVN 提交您的更改来做到这一点。

PS 由于某种原因，我现在无法连接到 SVN 站点。目前可能已经下线了。不过，它仍然是一个很棒的产品:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-06T07:40:23.080

我认为您正在寻找版本控制文件系统的好处，该系统在每次写入时获取文件的不可变快照。如果某些东西设置了对版本化目录中包含的文件的监视（每次更改文件时提交），您可以将其构建到 DVCS 中，但这会变得丑陋、快速。

[在这个问题](https://stackoverflow.com/questions/406155/in-place-editing-version-control-whats-your-solution/406167#406167)中也探讨了这个话题。我认为您理想的解决方案将是驻留在某种类型的版本控制/cow 文件系统上的 DVCS 存储库。这使您可以独立于在 DVCS 中进行的提交来管理每个文件的修订。

当然，除非有毒的修订对您来说不是问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-06T06:51:37.207

我强烈建议使用颠覆。我使用了 4 种不同的版本控制系统，发现 subversion 功能强大且易于使用。

对于 Windows，这是最容易安装的服务器是[Visual SVN](http://www.visualsvn.com/server/)

[Smart SVN](https://www.smartsvn.com/)是我用过的最好的颠覆客户端。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-06T07:09:37.367

[不是一个实际的答案，只是关于 DVCS 备份功能的说明]

我不建议使用 Git 之类的 DVCS（分布式版本控制系统）或类似的备份策略。

如[**DVCS 神话中所述**](http://derekslager.com/blog/posts/2008/06/dvcs-myths.ashx)

> 那么，为什么要备份有这么多备份的源代码控制服务器呢？
> 
> *   许多服务器同时遭受灾难性硬件故障是不可能的，但也不是不可能。
> *   更可能的情况可能是一种特别讨厌的计算机病毒，它会侵入整个易受攻击的机器网络。
> 
> 无论如何，您的任何或所有备份突然变得不可用的可能性真的不是重点。
> **底线是使用独立克隆作为规范备份（而不是临时权宜之计）是一种次优策略。**
> 
> *   *例如，应该考虑***安全性。***
>     如果您使用授权规则来控制对存储库特定部分的访问，则规范化存储库的任意克隆会有效地使这些规则变得无用。
>     虽然这在受控的公司环境中很少成为实际关注的问题，但它仍然是可能的。*

 **   （我的输入：）使用 DVCS 不可能实现***完整的数据备份****，因为这意味着所有*存储库都将其更改推送到“中央”存储库，这不是 DVCS 中的主要用例场景（而对于经典的 VCS，任何提交的东西都存储在一个地方）

> **DVCS 备份的关键优势在于，您实际上不需要投资“热”备份**。
> 当服务器不可避免地出现故障时，DVCS 将为您争取时间。很多时间。当您从备份重建服务器时，您将基本上以全生产力（或几乎如此）运行。
> 当服务器停机期间创建的变更集被推回恢复的服务器时，新恢复的授权规则将被重新应用，您将回到正轨。

所以，对我们来说：

*   热“备份”实际上是通过[**SRDF**](http://en.wikipedia.org/wiki/SRDF)（Symmetrix Remote Data Facility）实现的，但这是商业化的，并且与我们支持[LUN](http://en.wikipedia.org/wiki/Logical_Unit_Number)复制以实现数据复制的基础架构相关联。
*   每日增量备份是针对一组有限的存储库（包括一些“中央”Git 存储库）实现的，但在我们的例子中，使用的是自定义工具。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-07T03:13:05.100

为了使这对应用程序透明（即，不需要让应用程序实现不同的 API 来保存/加载文件以访问这些备份功能），您需要在操作系统的文件系统中执行此操作层。

[可以包装ZFS 文件系统](http://en.wikipedia.org/wiki/ZFS)以提供您描述的用户界面功能，但是这个文件系统是否会到达 Windows（至少直接）是值得怀疑的。

考虑这一点的一种更简单的方法是查看可以为您提供所需功能的网络存储系统。

[NetApp Snapshot](http://www.netapp.com/us/products/platform-os/snapshot.html)提供了可用于在网络存储级别执行此操作的功能。它实现了 CIFS，因此绝对可以在 Windows 上使用。打开你的钱包。

如果您认为这是一个极其重要的功能，您可以考虑使用 Windows 以外的其他操作系统；Windows 以外的操作系统中的文件系统和文件系统支持更加多样化。

# apache-flex - 地图服务器和 Flex

> ID：617839
> 
> 赞同：1
> 
> 时间：2009-03-06T06:36:44.043
> 
> 标签：apache-flex, arcgis, mapserver

任何人都知道我如何以与 Flex 和 ArcServer 对话相同的方式集成 Flex 和 Mapserver？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-09T02:36:47.870

由于 Mapserver 与 WMS 兼容，您应该能够使用[ModestMaps](http://modestmaps.com/)或[UMap](http://www.afcomponents.com/components/umap_as3/)库在 Flex 中显示地图图块。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-11T08:57:34.193

在适用于 ArcGIS Server 的 JavaScript API 1.3 中，有一些新方法可以为您自己的地图处理创建自定义类（即与 WMS 或您使用的任何地图格式集成）。我想类似的可能性也会出现在用于 AGS 的新 Flex API 中——如果它们还没有的话。

当然，仅当您想要（并且可能，出于许可原因）使用 ArcGIS Server API 时才可以选择。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-09-08T18:37:58.987

简单的答案是肯定的。您从 ArcGIS 服务器放入 flex 应用程序的每个图层都使用地图服务 url 端点。同一服务总是有一个 wms url。我建议用 ArcGIS Server 中的 WMS 版本替换图层 url，以测试您的 FLEX 应用程序在这些图层上的工作，然后将服务迁移到 MapServer。

# c++ - 带有结构的向量范围

> ID：617842
> 
> 赞同：-1
> 
> 时间：2009-03-06T06:37:29.610
> 
> 标签：c++

这里的初学者问题：

我正在读取一个文件，将字段存储到结构成员中，然后将结构的名称存储到一个向量中。

我输出了我的向量的大小并对其进行调试以查看它是否有效，并且我将文件中的字段隔离了。

我在向量 *ptrFunc() 函数中执行此操作。

我返回 &vectorObject 所以我不需要使用向量类型 ptr obj 声明。

从一个函数移动到另一个函数，即使使用我的返回类型，我是否需要重新解析文件？

继承人一些代码，我不认为我很清楚：

```
 //Varaible Declartions/Intializations
  //Open File

   vector<myStruct> *firstFunc()
   {

    while ( !inFile->eof() )
    {
    // Isolating each feild delimited by commas
    getline( *inFile, str1, ',' );
    myStruct.f1 = str1;

    getline( *inFile, str2, ',' );
    myStruct.f2 = str2;

    getline( *inFile, str3, ',' );
    myStruct.f3 =  atof( str3.c_str()  );

    getline( *inFile, str4 );
    myStruct.f4 = atof( str4.c_str() );

    v.push_back( myStruct );
       // We have the isolated feilds in the vector...
       // so we dance
        }
     return &v;
      }
   // Now do i still have to do the getlines and push_back with the vector again in  another function?

   vector<myStruct> *otherFunc()
   {
      sStruct myStruct;
      vector<myStruct> *v = firstFunc(),
      vInit;
      v = &vInit
      vInit.push_back( myStruct );
      ... 
```

所以这就是我调试它的地方，我的结构成员丢失了所有数据！

我应该在第一个函数中做什么，以便我的结构成员不会丢失他们的数据？

我的猜测是只创建一个 void 函数或其他东西。但是然后将其存储到向量中就会出现问题。

我只是有范围问题。:p

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-06T06:55:28.257

以这种方式声明您的函数：

```
void firstFunc(vector<myStruct> &v) 
{
...
}

void otherFunc(vector<myStruct> &v) 
{
...
} 
```

并以这种方式使用它们

```
void foo()
{
vector<myStruct> v;
firstFunc(v);
otherFunc(v);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-06T06:53:56.233

是否可能是您返回的向量'v'`firstFunc()`被分配在堆栈上？如果是这样，那么这可能是您的问题，因为您正在返回一个对象的地址，该地址在函数退出时超出范围。

所以修复这个问题，按值返回向量，或者在堆上使用`new`.

# ruby-on-rails - Rails 中是否有用于复数的辅助方法？

> ID：617845
> 
> 赞同：14
> 
> 时间：2009-03-06T06:39:03.367
> 
> 标签：ruby-on-rails, ruby

```
def plural(value, string)
  "#{value} #{value.abs == 1 ? string.singularize : string.pluralize}"
end 
```

如果不是，这个方法的简短而甜美的名字是什么？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-03-06T07:54:30.813

ActionView::Helpers::TextHelper

```
 pluralize(1, 'person')
  # => 1 person

  pluralize(2, 'person')
  # => 2 people 
```

[此处](http://apidock.com/rails/v2.2.1/ActionView/Helpers/TextHelper/pluralize)提供更多文档和示例

# dll - 从 .NET DLL 调用 VB6 方法

> ID：617846
> 
> 赞同：7
> 
> 时间：2009-03-06T06:39:20.650
> 
> 标签：dll, vb6, interop

我有一个用 VB 6 编写的 DLL 和另一个用 Visual Studio 2005 (VB.NET) 编写的 DLL。

现在我想从我的 .NET DLL 中调用 VB DLL 的方法。我该怎么办？有什么想法吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-06T07:32:49.727

由于 VB6 创建 COM DLL，Visual Studio 为您生成互操作存根应该没有问题。通过在 Visual Studio 中选择添加引用并在 COM 选项卡下找到您的 DLL，只需从您的 .NET 项目中添加对 VB6 DLL 的引用。在执行此操作之前，请确保 VB6 DLL[已在您的计算机上注册](http://technet.microsoft.com/en-us/library/bb490985.aspx)。

# java - 我可以使用 java 开发 iPhone 应用程序吗？

> ID：617850
> 
> 赞同：3
> 
> 时间：2009-03-06T06:40:50.897
> 
> 标签：java, iphone

是否可以使用 Java 为 iPhone 开发应用程序？如果是这样，它是否允许使用自定义 jar 文件？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-06T06:44:06.227

最初的答复是否定的。Apple 协议曾经规定不允许任何解释/其他语言。时期。

这已经改变了，有几个这样的解决方案：

Codename One - 专注于使用带有可视化工具和模拟器的 Java 构建应用程序。具有 SaaS 后端的开源，无需 Mac。

XMLVM - 将 Java 字节码转换为 C/Objective-C 的转换器。开源，但目前需要编写 iOS 特定代码。

还有几个专有解决方案，但我没有使用它们的经验。例如，Software AG 有一个名为 web objects 的工具。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-06T06:50:29.173

[AlcheMo](http://www.innaworks.com/alcheMo.html)可能值得一看（我还没有时间研究它）

# google-sheets - Google 电子表格范围名称

> ID：617852
> 
> 赞同：13
> 
> 时间：2009-03-06T06:41:50.410
> 
> 标签：google-sheets, named-ranges

在 Google Docs 电子表格中，可以使用[范围名称](http://docs.google.com/support/bin/answer.py?answer=63175&cbid=-1586dzdl3v9vb&src=cb&lev=answer)在单元格范围上放置标签，以使公式更易读。在大多数公式中，可以使用范围 C:C 表示整个 C 列，使用 C2:C 表示整个 C 列，包括 C2 之后（包括 C2）。

有没有办法创建相同性质的范围名称？当我尝试 C:C 或 C2:C 或 Sheet!C:C 或 'Sheet'!C:CI 时，总是会收到错误“您指定的范围不是有效的范围格式”。我希望在我的表单向电子表格中添加行时扩展范围名称。谢谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2014-10-02T18:50:42.090

我刚刚发现如果您使用“ ***-*** ”运算符，它从底行开始。所以，

```
=INDIRECT("-D:D12") 
```

从最后一行开始，一直到 D12！

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-11-17T00:56:54.423

我有一个类似的问题。尽管我不知道如何完全按照您的要求进行操作，但您可以通过引用尚未创建的单元格来完成基本相同的操作。

例如：C 列当前有 100 个单元格（工作表中有 100 行）而不是用 C:C 引用它，而是使用 C1:C999

如果您使行引用足够高，那么您可以考虑将来要创建的行。希望能帮助到你。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-06T07:10:19.203

我不这么认为......即使您在“范围名称”选择器中手动选择一列，它也会抱怨。这将是一个不错的功能，而且很有意义，因为它们已经支持公式的列范围。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2011-01-12T23:33:16.783

我相信这现在确实有效。我有一个“Sheet1！A10：AW10”的范围名称，没有问题。

如果您尝试制作一整列，我认为它只会占用该列中的所有可用单元格。即如果您稍后制作更多单元格，则需要手动添加到范围名称。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-11-07T19:06:07.497

我对`A3:A`通常在其他地方工作的范围（`ARRAYFORMULA()`例如`A:A`. 如果这会成为问题，您可以使用`ARRAYFORUMULA(A25:A)`公式之类的东西通过另一列代理数据。

更新：显然我没有正确阅读这个问题。我看到 OP 曾尝试省略行号，所以当时它可能不起作用，但现在可以了。符号仍然不起作用。

更新2：我没有注意到谷歌电子表格替换了像`A:A`to这样的范围`A1:A50`，所以以后添加的新行仍然不会被包括在内。我认为这就是@Dean 在他的回答中试图说的。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2011-12-14T18:47:33.640

我认为使用 Insert -> Define new range 使向导出现并使语法正确是一个有用的工具。呵呵

[我在其他话题中的回应](https://webapps.stackexchange.com/a/21975/15587)

# cocoa - Spotlight 不在 Cocoa 的所有目录中搜索 mp3 文件

> ID：617857
> 
> 赞同：1
> 
> 时间：2009-03-06T06:44:18.953
> 
> 标签：cocoa, spotlight

我必须在所有目录中搜索 mp3 文件。我使用 Spotlight 实现它，但它仅在 /user/userAccount/Music/Itunes Music 中搜索。我已将我的歌曲存储在 Desktop/Songs/*.mp3 上，但它不在此目录中搜索。

我应该怎么做才能让我的应用程序在所有目录中搜索。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-10T15:43:53.600

如果您不需要 Spotlight，您可以使用 unix command [`find`](http://developer.apple.com/documentation/Darwin/Reference/ManPages/man3/popen.3.html)。一个示例命令行是：

```
find ~ -name '*.mp3' 
```

前提是您所有的 mp3 文件都有`.mp3`扩展名。

在 Cocoa 应用程序中，您必须将其包装在 a[`NSTask`](http://developer.apple.com/DOCUMENTATION/Cocoa/Reference/Foundation/Classes/NSTask_Class/Reference/Reference.html)或使用[`popen()`](http://developer.apple.com/documentation/Darwin/Reference/ManPages/man3/popen.3.html)调用中。

# wcf - 与 MassTransit 或手写 MSMQ 客户端等框架相比，使用 WCF 有哪些优势？

> ID：617859
> 
> 赞同：8
> 
> 时间：2009-03-06T06:44:57.893
> 
> 标签：wcf, architecture, msmq, soa, masstransit

我正在考虑使用 MSMQ 作为在我即将进行的项目中执行异步执行的解决方案。我想知道使用 WCF 和 MassTransit 等框架甚至手写 MSMQ 客户端来放置/读取 MSMQ 任务之间的区别。

基本上，应用程序将是几个网站（内部通过 LAN 或外部通过 Internet）通过服务层（无论是 WCF 还是普通 Web 服务）读取/写入数据。然后这个服务层将做以下两件事之一： 1\. 将数据写入数据库 2\. 和/或通过将消息放入队列来触发后台进程。3.显然它也可以从数据库中检索数据。队列另一端的小代理（一个windows服务）会监控队列并根据任务命令执行。

与 RPC 或分布式执行等相比，这种架构将非常容易扩展（添加更多队列和代理）并且易于实现。并且代理处理不需要是实时的。并且代理和服务层是独立的应用程序，除了它们共享公共域对象和存储库等。

你怎么看？欢迎针对上述要求提出架构建议。谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-06T18:09:23.363

WCF 添加了对 MSMQ 的抽象。事实上，一旦你定义了兼容的合约（操作必须是 OneWay），你就可以在配置中透明地切换 MSMQ。（例如，您可以切换到普通的 HttpWS 或 NetTcp 绑定。）

您应该评估其他 WCF 优势，例如安全性等，以了解这些优势如何满足您的需求。同样，它们应该对您在下面使用 MSMQ 的事实相当透明。例如，添加 SOAP 安全性等应该“正常工作”，与使用 MSMQ 无关。

*（尽管，IIRC，您仍然需要使用将使用 MSMQ 的服务帐户*登录到每台使用 MSMQ 的机器上的桌面，以在机器本地配置文件中生成证书。然后，它不能很好地从IIS6，因为没有加载用户配置文件。一般来说真的很痛苦，但与 WCF 无关。）

* * *

除此之外：

你看过 SQL Server 服务代理吗？使用 MSMQ + WCF 和 SSSB 后，我认为 SSSB*更*易于配置和管理。SSSB 可以在任何 SQL 客户端上使用 T-SQL 命令（我在 Mono 上使用它，在 Linux 上使用事务）。它还将为您提供事务性发送/接收，甚至是远程的（我认为 MSMQ 4 现在允许这样做）。消息队列确实减轻了很多痛苦，如果您已经在使用 SQL Server...

SSSB 经常被忽视，因为 SQL Management Studio 没有所有的 GUI 设计器，但它并不难，而且是一个不错的选择。一个缺点是，如果您想要本地发送功能（即，当网络中断时排队消息），您将需要运行本地 SQL Express 实例。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-06T08:48:09.093

您的架构看起来合理且合理。但是，您应该考虑使用 WCF 网络 MSMQ 传输而不是手动编码的 MSMQ 类。WCF 将这个通用功能包装成一个很好的编程模型。此外，我相信 wcf 使用的协议与基本 System.Messaging 相比有一些改进

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-26T18:15:05.080

看看普通 MSMQ 的增值：

[http://readthedocs.org/docs/masstransit/en/latest/overview/valueadd.html](http://readthedocs.org/docs/masstransit/en/latest/overview/valueadd.html)

总而言之，您会在使用 MassTransit 的 API 中清楚地呈现很多消息传递概念；如果您手动编码或使用 WCF，您将不会有这样的程度。

# django - Django 平板备份？

> ID：617860
> 
> 赞同：14
> 
> 时间：2009-03-06T06:45:16.410
> 
> 标签：django, django-flatpages

我在本地服务器中开发的站点中使用[平面页面。](http://docs.djangoproject.com/en/dev/ref/contrib/flatpages/)我需要备份平面页面的数据，以便在最终服务器中使用。有谁知道该怎么做？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-03-06T07:04:57.440

在你的本地服务器上运行这个：

```
python manage.py dumpdata flatpages --indent=2 > backup.json 
```

然后将 backup.json 复制到您的最终服务器并加载它：

```
python manage.py loaddata backup.json 
```

# math - 标量三重乘积和确定

> ID：617866
> 
> 赞同：3
> 
> 时间：2009-03-06T06:47:13.800
> 
> 标签：math

当我今天试图解决一个问题时，我注意到了一些事情。标量三重乘积与行列式或以三个向量作为行的三乘三矩阵相同：

A = [ **a** , **b** , **c** ]

det(A) = ( **a** X **b** ) * **c**

*我在Real Timer Rendering*中遇到过这个问题，但我不知道为什么会这样，或者它是否有用。它似乎与使用确定的在矩阵顶部编写单位向量的位置计算叉积的捷径方法有关，但我一直认为这更像是一种助记符，而不是真正合理的数学。

这里有真正的关系，还是这只是某种快乐的巧合？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-06T06:56:54.120

绝非巧合；这是一个相当标准的结果。请注意，叉积 a X b 通常以行列式形式写成，最上面一行是单位向量 ijk，下一行是 a1 a2 a3，最下面一行是 b1 b2 b3。

```
|i  j   k|
|a1 a2 a3|
|b1 b2 b3| 
```

现在将它与另一个向量 c 相乘，你得到的结果就像你刚刚在第一行写了 c 一样。

```
|i  j   k|                      |c1 c2 c3|     |c1 c2 c3|    |a1 a2 a3|
|a1 a2 a3| .  (c1,c2,c3)  =     |a1 a2 a3|  = -|a1 a2 a3|  = |b1 b2 b3|
|b1 b2 b3|                      |b1 b2 b3|     |b1 b2 b3|    |c1 c2 c3| 
```

编辑：[标量三元积的维基百科页面](http://en.wikipedia.org/wiki/Triple_product)也说它相当于使用向量作为行或列的矩阵的行列式。量子点

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-06T08:24:39.883

最多一个符号，n×n 矩阵的行列式是由其 n n 维行（或列）向量（或由该矩阵线性变换的单位立方体的体积）跨越的平行六面体的体积。(axb).c 产品在三个维度上完全相同；axb 给出一个垂直于 a 和 b 且长度等于由 a 和 b 跨越的平行四边形的面积的向量；(axb).c 给出了 c 在该平行四边形上的高度，乘以它的面积。所以，不，这不是巧合。

# asp.net-mvc - 如何将关系数据添加到 ASP.net MVC 数据实体创建视图？

> ID：617867
> 
> 赞同：2
> 
> 时间：2009-03-06T06:47:44.780
> 
> 标签：asp.net-mvc, entity-framework, ado.net

假设我有一个员工表，以及一个单独的员工角色表，它们之间存在多对多关系（即，中间有一个 StaffMembersInRoles 表）。使用 ADO.net 实体框架，我们有一个像这样的对象模型： [alt text http://martindoms.com/img/datamodel.png](http://martindoms.com/img/datamodel.png)

我有一个带有 create 方法的 StaffController 控制器和一个几乎是标准自动生成类型的 Create 视图。我希望创建页面列出 StaffRoles 表中的角色，每个角色旁边都有一个复选框，当按下提交按钮时，这些角色被添加到新的 StaffMember StaffRole IEnumable 中（因此在 StaffMembersInRoles 表中创建了适当的条目）。我将如何使用强类型视图来解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-10T05:44:33.837

我就是这样做的：

首先，您需要一系列所有可能的角色。在控制器中，我会做这样的事情（我正在对你的 DAO 做一些假设）：

```
ViewData["AllRoles"] = (StaffRole[])StaffRole.FindAll(); 
```

然后在您看来，遍历角色：

```
<% foreach (StaffRole Role in (StaffRole[])ViewData["AllRoles"]) { %>

 <p>
  <label>
   <%= Html.CheckBox("Role_"+Role.RoleId.ToString()) %>
   <%= Html.Encode(Role.RoleName) %>
  </label>
 </p>

<% } %> 
```

然后在您的 POST 控制器中，执行以下操作：

```
foreach (StaffRole Role in (StaffRole[])StaffRole.FindAll())
{
  if (Request.Params["Role_"+Role.RoleId.ToString()]=="true")
    MyStaff.Roles.Add(Role);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-12T03:44:08.103

嗨，这种方法的问题是您实际上并没有将强类型实体传递给视图。在这个问题中，您需要 StaffMember 信息和所有 StaffRole 实体的列表。PS：我真的不喜欢在视图中投射列表的方法：StaffRole[])ViewData["AllRoles"]

基本上我更喜欢使用 DTO。

DTO：

```
public StaffMemberDto
{ 
    public int StaffMemberId { get; set; }
    public IList<StaffRoleDto> AllStaffRoles { get; set;}
    public IList<StaffRoleDto> MembersRolesAttached  { get; set;}
}

public StaffRoleDto
{
    public int RoleId {get; set;}
    public string RoleName { get; set; }
} 
```

控制器：

```
return View(StaffMemberDto); 
```

因此，在视图中，您将获得所有角色的强类型：

```
foreach (var role in ViewDate.Model.AllStaffRoles)
{
    ...
} 
```

在帖子中，您可以发送已在视图中分配好的 RoleDto 的 StaffMemberDto，或者您可以使用 Request 技巧来勾选复选框的 id。

好吧，在这样的视图中，每次有人勾选框以添加角色时，我可能会使用 jquery 来请求 addRole。它会在您的表单中添加一些 ajax，并且您不会有一些回发。

# internet-explorer-6 - IE6中的水平滚动条

> ID：617876
> 
> 赞同：1
> 
> 时间：2009-03-06T06:50:52.527
> 
> 标签：internet-explorer-6

我在 IE6 中得到一个水平滚动条。附上zip文件夹的路径。下载并在 IE6 中打开 index.html 页面。让我知道如何删除滚动条。
[IE6-水平滚动条](http://shivanand.in/temp/IE6-horizontal-scroll.zip)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-06T07:04:00.780

**它在padding**中的一个或多个错误值。尝试将所有“填充”替换为“xxx”片刻，您会发现问题消失了。

您还需要研究[IE 上的破盒模型](http://en.wikipedia.org/wiki/Internet_Explorer_box_model_bug)。

**解决方案：**

1.  将所有**padding: 10px**替换为**padding: 10px 0;**
2.  修复看起来不正确的东西（填充明智）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-06T10:08:14.317

您还需要将水平填充设置`div#container`为零。您现在只是将顶部填充设置`skin-ie.css`为零。更改`padding-top: 0px`为`skin-ie.css`（`padding: 0`零`px`不需要）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-06T10:14:10.637

试过了

```
html{
width:100%;
overflow-x: hidden;
}

body{
width:100%;
overflow-x: hidden;
} 
```

然而？

**编辑：**

*这有效，但隐藏了右侧边缘内容。请参阅链接屏幕截图。[http://shivanand.in/temp/rightside-edges-hidden.gif](http://shivanand.in/temp/rightside-edges-hidden.gif) – Shivanand*

嗯，这很奇怪。您是否使用任何位置：宽度设置为像素（而不是 %）的绝对 DIV 导致这种情况发生？

# sharepoint-2007 - 从 WSS 中提取解决方案文件

> ID：617879
> 
> 赞同：3
> 
> 时间：2009-03-06T06:51:29.610
> 
> 标签：sharepoint-2007, wss

我试图弄清楚如何从 SharePoint 服务器中提取解决方案文件 .wsp 文件。这可能吗？如果可以，怎么办？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-17T13:21:50.480

您可以制作一个小型控制台应用程序并使用 SPFarm.Local.Solutions 属性访问解决方案。包括 Microsoft.SharePoint.Administration 命名空间并使用以下代码段下载解决方案文件：

```
SPSolutionCollection solutions = SPFarm.Local.Solutions;

foreach (SPSolution solution in solutions)
{
    SPPersistedFile wspFile = solution.SolutionFile;
    wspFile.SaveAs("c:\\Temp\\Solutions\\" + solution.Name);
} 
```

在调用 SaveAs() 方法之前，您需要确保您的输出目录存在。如果不存在，则抛出异常。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-06T07:00:18.073

您可以使用[SPFarm](http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.administration.spfarm.aspx)访问农场上的解决方案。[本地](http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.administration.spfarm.local.aspx). [解决方案](http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.administration.spfarm.solutions.aspx)属性。我不确定您是否可以检索基础文件。那就是我要开始的地方。

# debugging - 调试时 Visual Studio 2005 挂起

> ID：617889
> 
> 赞同：2
> 
> 时间：2009-03-06T06:54:44.890
> 
> 标签：debugging, visual-studio-2005

Visual Studio 调试器在为我的应用程序（本机 IA64）加载符号时挂起，安装了 SP1。在我安装了 Windows 调试工具（64 位版本）并重新启动计算机后，这种情况开始发生。这个问题不取决于我的项目，即使新项目调试器挂起。

**更新：** 当我尝试附加到正在运行的进程时，同样的情况会重复。Visual Studio 在加载符号时挂起（对于 kernell32.dll）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-06T07:07:24.873

`symsrv.dll`负责从符号服务器加载符号 - 您可以尝试重命名由 Debugging Tools for Windows 安装的符号，并查看 VS 调试器是否再次开始工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-06T06:59:44.987

它是完全挂起，还是只需要很长时间才能加载符号？

如果您使用符号服务器访问 Windows DLL 的调试符号，则 VS2005 可以在每次调试时尝试访问符号服务器。

解决这个问题的方法是加载符号一次，然后在 Tools->Options->Debugging->Symbols 下取消选中符号服务器 URL。只要自您上次下载符号以来操作系统库没有更改，就没有理由每次都访问远程服务器。

另请参阅[此答案](https://stackoverflow.com/questions/588857/start-debugging-takes-forever-in-visualstudio-2005/588916#588916)。

# python - Poplib 无法正常工作？

> ID：617892
> 
> 赞同：1
> 
> 时间：2009-03-06T06:55:18.367
> 
> 标签：python, python-2.5, poplib

我想从我的 gmail 收件箱中获取所有邮件，但我面临 2 个问题。

1.  它没有收到所有的电子邮件，（根据统计函数中的计数）
2.  它收到的电子邮件顺序是随机的。

我不确定是 poplib 还是 gmail pop 服务器的问题。

我在这里想念什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-09T21:39:14.737

您也可以尝试`imaplib`模块，因为 GMail 还提供通过 IMAP 协议访问电子邮件的功能。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-09T21:19:39.747

你的代码是什么样的？使用 poplib，您可以决定下载消息的顺序和数量。[poplib 文档](http://docs.python.org/library/poplib.html#id2)中的代码应该可以工作：

```
import getpass, poplib

M = poplib.POP3('localhost')
M.user(getpass.getuser())
M.pass_(getpass.getpass())
numMessages = len(M.list()[1])
for i in range(numMessages):
    for j in M.retr(i+1)[1]:
        print j 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-06T12:28:55.443

你为什么不尝试使用[libgmail](http://libgmail.sourceforge.net/)？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-06-03T18:20:53.677

It's the problem of gmail: [https://mail.google.com/support/bin/answer.py?answer=13291](https://mail.google.com/support/bin/answer.py?answer=13291)

Try to use recent:username@gmail.com as your email address. At least you'll have all your last month mail in correct order.

# javascript - 解析多级 JSON 时遇到问题

> ID：617897
> 
> 赞同：0
> 
> 时间：2009-03-06T06:55:51.547
> 
> 标签：javascript, jquery, json, parsing

我有一大块 JSON，看起来像：

```
{
  "map": [
    [
      "zimbraFeatureCalendarUpsellEnabled",
      "FALSE"
    ],
    [
      "zimbraPrefCalendarDayHourStart",
      "8"
    ],
    [
      "zimbraFeatureOptionsEnabled",
      "TRUE"
    ],
    [
      "zimbraAttachmentsViewInHtmlOnly",
      "FALSE"
    ]
  ]
} 
```

（等等；有 200 多个条目）

我需要能够从 JSON 响应中挑选出单独的键/值对，无论是使用 jQuery 还是普通的旧 Javascript。不过，我无法弄清楚如何解决特定的键。有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-06T06:58:29.013

您可以使用对象而不是使用数组：

```
{
    map : {
      "zimbraFeatureCalendarUpsellEnabled" : "FALSE",
      "zimbraPrefCalendarDayHourStart" : "8",
      "zimbraFeatureOptionsEnabled" : "TRUE",
      "zimbraAttachmentsViewInHtmlOnly" : "FALSE" 
    }
} 
```

然后访问它：

```
myJSONObject.map.zimbraFeatureCalendarUpsellEnabled; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-06T07:00:00.587

你所描述的是一个单级对象，有一大堆嵌套数组，所以访问将是

```
myObject.map[entryNumber][0 or 1] // 0 == key, 1 == value 
```

您可能想要类似的东西（除非您正在使用现有的 API 或类似的东西）：

```
{
    "map": {
        "zimbraFeatureCalendarUpsellEnabled": "FALSE",
        "zimbraPrefCalendarDayHourStart": "8",
         ...
    }
} 
```

# javascript - 对 href 使用 JavaScript 单引号和双引号

> ID：617901
> 
> 赞同：12
> 
> 时间：2009-03-06T06:57:50.390
> 
> 标签：javascript, escaping

我在转义`href`s JavaScript 函数中的单引号和双引号时遇到问题。

我有这个 JavaScript 代码里面`href`。就像是 -

```
<a href = "javascript:myFunc("fileDir/fileName.doc", true)"> click this </a> 
```

现在，由于双引号内的双引号无效，我需要转义内部双引号以将其视为字符串的一部分 - 所以，我需要这样做 -

```
<a href = "javascript:myFunc(\"fileDir/fileName.doc\" , true)"> click this </a> 
```

问题是，即使上面的代码也不起作用。JavaScript 代码在以下位置被截断—— `myFunc(`

我也尝试使用单引号变体 - 但即使这样似乎也不起作用（这意味着如果我的字符串文字中有单引号，那么代码会被截断）。

这就是我用单引号所做的：

```
<a href = 'javascript:myFunc("fileDir/fileName.doc" , true)'> click this </a> 
```

这可行，但如果我在字符串中有一个单引号，那么代码会以与双引号相同的方式被截断。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-03-06T07:01:15.107

使用反斜杠来转义引号是它在 JavaScript 中的工作方式，但您实际上并没有在那里编写 JavaScript 代码：您正在编写 HTML。您可以使用 HTML 转义方法来做到这一点：字符实体。

```
&quot;  // "
&#39;   // ' 
```

例如：

```
<a href="javascript: alert('John O&#39;Brien says &quot;Hi!&quot');">...</a> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-05-28T03:06:06.367

作为一般的最佳实践，在 HTML 中使用双引号，在 JavaScript 中使用单引号。这将解决你的大部分问题。如果您需要 JavaScript 字符串中的单引号，您可以使用 \' 对其进行转义 - 而且您可能不应该将文字字符串嵌套得比这更深。

如其他地方所述，如果代码嵌入在 HTML 中，则 HTML 实体是可能的。但是您仍然需要处理 JavaScript 源文件中字符串中的转义引号，因此最好使用一致的策略来处理 JavaScript。

如果您遵循此策略并最终在 HTML 中嵌入 JavaScript 中嵌入双引号，则只需使用 HTML 实体 "。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-08-30T12:46:13.980

如果有人需要逃避这样的事情：

```
<a href="www.google.com/search?q="how+to+escape+quotes+in+href""</a> 
```

您可以对双引号使用 ASCII 代码`%22`：

```
<a href="www.google.com/search?q=%22how+to+escape+quotes+in+href%22"</a> 
```

如果您从 PHP 传递到 JavaScript 的链接，这将特别有用

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-03-06T07:01:47.523

通常，这种代码可以正常工作：

```
<a href="#" onclick="myFunc('...')">Click this</a> 
```

有了这段代码，你有什么问题吗？

# sharepoint - Sharepoint 网站中标题的特定格式？

> ID：617903
> 
> 赞同：1
> 
> 时间：2009-03-06T06:59:12.867
> 
> 标签：sharepoint, sharepoint-2007

我需要在每个网页中显示以下标题结构：

"网站/项目的标题" +","+ "1º 站点的标题" +","+ "2º 站点的标题" +","+ "页面标题"

例如，我有一个标题为“最新新闻网页”的网页，我在一个具有以下路径的站点中：/news/international/new1.aspx。站点“新闻”的标题为：“新闻”，站点“国际”的标题为“国际新闻”，页面的标题为“发现新星球”。结果应该是：

最新新闻网页、新闻、国际新闻、新星球发现

我如何使用 Sharepoint 的 ProjectProperty 标签来做到这一点？

如果做不到，我怎么能用至少一个级别的网站来做呢？（“最新新闻网页、新闻、新星球发现”）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-06T07:01:59.037

您可能想要调查构建您自己的服务器控件，以创建适当的标题并将其添加到站点的母版页。

这是[创建自定义服务器控件的教程](http://msdn.microsoft.com/en-us/library/yhzc935f.aspx)。

获取自定义服务器控件以呈现适当的站点信息的代码将类似于以下内容：

```
protected override void RenderContents(HtmlTextWriter writer)
{
  if (Context != null)
  {
      SPWeb l_web = SPContext.Current.Web;
      StringBuilder l_titleBuilder = new StringBuilder();
      l_titleBuilder.AppendFormat("{0}, ", l_web.Title);

      char[] l_delim = new char { '/' };
      foreach ( string l_pathComponent in 
                     l_web.ServerRelativeUrl.Split(l_delim) )
         l_titleBuilder.AppendFormat("{0}, ", l_pathComponent);

      l_titleBuilder.Remove(l_titleBuilder.Length - 2, 2);
      writer.Write(l_titleBuilder.ToString());
   }
} 
```

# active-directory - 聚合 LDAP/AD 服务器

> ID：617909
> 
> 赞同：2
> 
> 时间：2009-03-06T07:00:19.103
> 
> 标签：active-directory, ldap, single-sign-on

目前，我们有一小群用户设置在 Microsoft SBS 机器上，因此可以在活动目录下使用。

这些用户以及其他一些用户在第二个 LDAP 服务器 (openLDAP) 上也有条目。这第二台服务器用于对一些不同的事物进行身份验证和访问控制，例如我们内部的基于 Web 的时间表系统、足球小费系统、论坛和颠覆存储库控制。

因此，对于办公室中的组，他们有两个单独的帐户，他们必须记住其 ID 和密码。其中一些内部系统不容易配置为针对多个 LDAP 服务器 (mod_authnz_ldap) 进行身份验证。

由于各种原因，我们不希望额外的用户和组在 SBS 机器上弄乱 Active Directory。

我希望能够以某种方式设置一个可以跨两个现有 LDAP 服务器工作并提供统一视图的虚拟 LDAP 服务器。它会从 AD 中提取用户信息，也可以从 openLDAP 服务器中提取用户信息，或者在内部维护其他用户和组。

（实际上，内部可能会更好，因为有些组仅存在于聚合服务器上，我们希望将 AD 服务器中的用户分配为成员。）

我所知道的唯一一个接近于做我想做的事情的想法是[Penrose 虚拟目录服务器](http://docs.safehaus.org/display/PENROSE/Home)，但在我进一步调查之前，我想看看是否还有其他选择。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-02-03T17:57:10.383

如上所述，您可以使用[虚拟目录](http://en.wikipedia.org/wiki/Virtual_directory)产品为集中式 LDAP 服务提供接口。

一些拥有虚拟目录产品的公司：

*   软件
*   辐射逻辑
*   八字串
*   持续查询
*   iPlanet 目录访问路由器
*   甲骨文
*   太阳
*   好多其它的

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-06T12:28:56.070

您要查找的内容通常称为虚拟目录，或者可能是 LDAP 代理。

一旦您开始变得比两个简单的系统更复杂，您就想开始考虑一个身份管理解决方案，也许是一个元目录系统。

如果足够的话，虚拟目录很好，但通常将所有数据实际收集到一个元目录中并根据需要公开其中的一部分更为方便。

这两个空间都有很多产品，通常是成本，因为你得到你所支付的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-06T08:35:19.733

我完全不确定，但是您可以使用[ADAM](http://www.microsoft.com/windowsserver2003/adam/default.mspx)和[代理身份验证](http://technet.microsoft.com/en-us/magazine/2008.12.proxy.aspx)做一些事情。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-23T10:18:12.837

您至少可以为 AD 和 OpenLDAP 使用相同的用户 ID。这将解决双重用户ID问题。

此外，您可以自动将密码从 AD 同步到 OpenLDAP 或其他方式。这将解决用户必须记住多个密码的问题。

# wordpress - 有没有办法阻止 wordpress 中的 WYSISYG 编辑器修剪某些标签？

> ID：617917
> 
> 赞同：2
> 
> 时间：2009-03-06T07:04:50.653
> 
> 标签：wordpress

我厌倦了这个 WYSISYG 的 wordpress 编辑器。每次我从 HTML 视图切换到 WYSISYG 视图并返回时，它都会删除许多标签。就是这样一个标签。我知道我可以强制 wordpress 禁用 WYSISYG 编辑器，但是有什么方法/补丁可以要求 WYSISYG 编辑器不要修剪标签。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-06T14:36:47.900

要查看的一件事是在写作设置中，取消选中“WordPress 应该自动纠正无效嵌套的 XHTML”它可能无法解决所有问题，但它确实可以解决其中的一些问题。

# windows-mobile - 如何在 Windows Mobile 中解压 .zip 文件？

> ID：617924
> 
> 赞同：3
> 
> 时间：2009-03-06T07:07:03.160
> 
> 标签：windows-mobile, zip, mobile-phones, unzip

我需要以编程方式将 zip 存档解压缩到 Windows Mobile 上的文件夹中。是否有一个易于使用的 API 可以直接使用，还是应该使用一些外部库？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-06T09:42:46.640

您需要一个外部库。有一个 zlibce.dll，一个本地 DLL，如果 C++ 是您的首选，您可以使用它。

如果您喜欢 .NET，那么我可以推荐[DotNetZip](http://dotnetzip.codeplex.com)，它在 .NETCF 2.0 上运行，是免费的、开源的，并且具有良好的文档和良好的性能。在 DotNetZip 源代码分发中，有一个 CF-Unzipper 项目，您可以查看和编译；它演示了如何在设备上解压缩文件。这是一个链接，您可以在其中[查看设备应用程序的代码](http://dotnetzip.codeplex.com/SourceControl/changeset/view/29776#380835)。

这是代码中与 zip 相关的部分的片段。它将解压缩到一个目录，该目录取自 zip 文件的名称（不带 .zip 扩展名）。

```
 private void UnzipSelectedFile()
    {
        string parent = System.IO.Path.GetDirectoryName(_selectedpath);
        string dir = System.IO.Path.Combine(parent,
            System.IO.Path.GetFileNameWithoutExtension(_selectedpath));
        try
        {
            using (var zip1 = new Ionic.Zip.ZipFile(_selectedpath))
            {
                foreach (var entry in zip1)
                {
                    entry.Extract(dir, true);
                }
            }

            // re-populate the treeview with the extracted files:
            AddChildren(tvFolders.SelectedNode.Parent);

        }
        catch (Exception ex)
        {
            MessageBox.Show("Exception! " + ex);
        }
    } 
```

这是该库[文档的在线版本的链接。](http://cheeso.members.winisp.net/DotNetZipHelp)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-06T09:23:03.207

如果您使用的是 .Net Compact Framework，则可以使用[http://www.icsharpcode.net/OpenSource/SharpZipLib](http://www.icsharpcode.net/OpenSource/SharpZipLib)。我相信它支持在 CF 上运行。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-03-06T09:47:54.893

无论您使用哪种语言，都可以将[Info-ZIP](http://www.info-zip.org/)用作外部可执行文件。

# ruby-on-rails - 序数解析问题

> ID：617926
> 
> 赞同：1
> 
> 时间：2009-03-06T07:08:52.843
> 
> 标签：ruby-on-rails, ruby

Rails 有一个很好的函数[ordinalize](http://api.rubyonrails.org/classes/ActiveSupport/CoreExtensions/Integer/Inflections.html#M001092)，它将整数转换为友好的字符串表示形式。即 1 成为第 1，2 成为第 2，依此类推。我的问题是如何实现逆功能？

更笼统地说，我想处理以下两种情况：

```
>> s = "First"
>> s.integerize
=> 1
>> s = 1st
>> s.integerize
=> 1 
```

我正在寻找一种聪明的方法来做到这一点，而不是一个巨大的查找表或只是破解​​最后两个字符。任何想法，将不胜感激。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-06T07:14:40.457

to_i 基本上是其中的 1/2：

```
"72nd".to_i
=> 72 
```

它不检查有效性，但如果您需要在“72x”之类的错误输入上失败，您可以重新排序并与原始输入字符串进行比较。

对于解析序数词，[维基百科似乎很有帮助](http://en.wikipedia.org/wiki/Names_of_numbers_in_English#Ordinal_numbers)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-06T14:36:10.630

第一种情况相对较难——我想说的聪明方法是找到已经做过的人并使用他们的代码。如果找不到人，下一个最明智的做法可能是重述（或重新协商）问题，以便不再需要它。除此之外，我认为您正在使用解析器编写...

第二种情况与已经提供的 to_i 一样微不足道。我想你也可以使用正则表达式：

```
"1000000th".scan(/\d+/).first.to_i #=> 1000000 
```

# winapi - 如何让 Windows 资源管理器在“缩略图”视图中显示我的文件预览？

> ID：617927
> 
> 赞同：6
> 
> 时间：2009-03-06T07:09:32.483
> 
> 标签：winapi, windows-explorer

我正在制作一个 3D 编辑器，我希望 Windows 资源管理器在缩略图视图模式下显示文件中 3D 模型的预览。

我怎么做？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-06T07:36:30.873

您必须实现一个[预览处理程序](http://msdn.microsoft.com/en-us/library/bb776867(VS.85).aspx)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-06T07:36:21.013

您必须编写一个实现 IExtractImage2 并为资源管理器提取缩略图的 shell 扩展。哦，它是COM，所以最好期待之后会感到肮脏。

# php - 什么 IDE 对 Symfony 框架的支持最强？

> ID：617930
> 
> 赞同：22
> 
> 时间：2009-03-06T07:11:35.567
> 
> 标签：php, ide, symfony1

我正在寻找与[Symfony Framework](http://www.symfony-project.org)一起使用的 IDE 。

我有一些使用[NetBeans 6.5 IDE](http://www.netbeans.org)的经验，但它似乎并不总是完成类方法，而且它似乎没有内置任何 PHP 代码片段。

以下是我希望从 IDE 中按重要性排序的理想功能：

*   所有 Symfony 和 Propel 类方法的代码完成（我永远记不住它们）
*   代码模板，（类骨架、HTML 结构、Symfony 模板？）
*   直接的代码调试
*   源代码控制

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-06T09:01:10.483

如果你可以等待，Symfony 支持很快就会来到 Netbeans：http: [//www.netbeans.org/issues/show_bug.cgi?id=](http://www.netbeans.org/issues/show_bug.cgi?id=145913) 145913 。我将暂时使用 Zend Studio 5.5 的调试和检查功能。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-06T07:23:29.313

带[PDT的](http://www.eclipse.org/pdt/)[Eclipse](http://www.eclipse.org)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-07T16:17:38.397

[Komodo IDE](http://www.activestate.com/komodo/)（或者，没有调试和源代码控制，免费的[Komodo Edit](http://www.activestate.com/komodo_edit/)）+[一组 Komodo 使用 symfony 任务的命令](http://code.google.com/p/ksf/)。完成所有 4 点，并且也适用于 Perl、Python、Ruby 和 Tcl。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2010-09-11T10:38:35.260

~~我推荐 NetBeans。您可以按照本教程：[使用 NetBeans 设置 PHP Symfony 项目](http://peterlong.info/use-netbeans-to-setup-a-php-symfony-project/)~~

> 很多事情都变了。上面的链接现在坏了。甲骨文现在拥有 Netbeans。所以，我不再向你推荐 netbeans 了！试试gvim！

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2010-04-12T12:44:53.407

NetBeans 6.8 支持 Symfony。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-01-15T20:37:22.763

我从 0.6 版开始就一直在使用 Symfony，并且使用过 Zend Studio（早期版本和后期基于 Eclipse 的版本）、Eclipse、Komodo、NetBeans、VIM、e TextEditor 和 Sublime Text。

我最近切换到**[PHP Storm](http://www.jetbrains.com/phpstorm/)**，我不得不说......它完全消灭了所有其他选项。绝对是我的选择！

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-06T12:51:36.577

至于我，它是 Eclipse + PDT。但是 NetBeans 已经支持 phpDoc 1.4（而 PDT 没有），因此您可以记录（并且 IDE 将能够自动完成）“神奇”属性和方法。教义用户肯定会欣赏的:)

**UPD：**一段时间过去了，我首先转向了 NetBeans（它看起来更轻、更快、更简单）。然后我使用了 PhpStorm EAP，很喜欢它，甚至还买了一个许可证 :)

所以，此时此地，我选择的 IDE 是：

*   NetBeans — 免费
*   PhpStorm——付费，最智能（静态源分析是真正的杀手锏）

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-05-06T20:31:02.623

我推荐你使用**PHPEDIT**，它是对所有 symfony 版本支持最好的软件，

你可以观看一个截屏视频，了解使用 phpedit 开发 symfony 项目是多么容易。 [关联](http://www.waterproof.fr/%7Eshordeaux/phpedit-3.2/screencast/en/)

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2011-11-14T10:10:52.367

您可以简单地使用 Textmate 进行 Symfony 开发。握住它之后，它也可以完美贴合。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-06-26T17:45:37.823

我过去使用 Eclipse PDT，一个月前切换到 Netbeans... 在尝试了这两种方法之后，我会推荐 Netbeans：它具有更好的重构工具，并且总体上表现更好。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2010-04-12T09:10:03.597

查看 Symfoclipse，一个用于 Eclipse + PDT 环境的 Symfony 插件。[这是链接;-)](http://marketplace.eclipse.org/content/symfoclipse-symfony-framework-support-eclipse)

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2010-11-27T12:16:55.100

它是用于 PHP 的 NetBeans。它支持symfony。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-05-26T18:43:18.927

PHPEdit 击败了竞争对手。当然你必须为此付费，但它支持 SVN、所有 symfony 命令的 GUI、yaml 编辑等。

您可以物有所值，并使开发变得更加轻松和快捷。

您将通过节省的时间通过一个项目收回您的资金。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2011-11-02T22:28:20.923

我更喜欢 old school、textmate 或 bbedit（我正在成为真正的粉丝）

# asp.net-3.5 - Web 服务器与 SQL Server Express 通信时的 TCP 端口

> ID：617931
> 
> 赞同：0
> 
> 时间：2009-03-06T07:11:41.697
> 
> 标签：asp.net-3.5, sql-server-2005-express

我们有一个运行在托管公司的 Web 服务器上的 asp.net 3.5 Web 应用程序，该服务器具有非常严格的防火墙设置。Web 应用程序与我们位于完全不同的网络上的 sql server express 2005 通信。

问题是，当 Web 应用程序在端口 1433 上连接到我们的 sql 服务器时，Web 应用程序会向我们的 sql 服务器发送一个随机端口号来连接。因此，Web 应用程序无法连接到我们的 sql 服务器，因为它们必须打开整个范围他们不准备做的防​​火墙上的端口号。

我的问题如下。您可以在连接字符串或 web.config 中的某处指定客户端发送到 sql server 以连接回的端口吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-06T07:52:00.133

如果我没听错的话，你想做一些违背 TCP/IP 端口处理应该如何工作的事情。

您希望 Web 应用程序在连接到 SQL 服务器时始终使用相同的端口？这意味着您在任何给定时间只能打开一个连接，因此在任何给定时间只能打开一个用户。客户端应该从“随机”端口与服务器通信。这是网络的基础。至少我是怎么学的。

我不确定您是否甚至可以强制它每次都使用相同的端口，即使您可以，我也会建议您不要这样做。

我会说问题是防火墙，而不是您的应用程序。我可以理解 SQL 服务器只想与您的站点所在的 IP 地址通信，但它不应该真正关心客户端想要通过哪个端口进行通信（类似于 [website-ip]:* -> [sql -ip]:1433)。对我来说，似乎曾经设置过防火墙的人有某种疯狂的防火墙想法，但也许这只是我。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-06T07:36:28.627

您的 SQL Server Express 是否可以配置为侦听动态端口？如果“TCP 动态端口”的值为 0，我认为即使您配置了特定端口，它也是动态的。该值应完全清除。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-07-18T16:42:50.110

如果您使用 TCP/IP，您可以指定端口。

例如：

```
Data Source=190.190.200.100,1433;Network Library=DBMSSOCN;Initial Catalog=myDataBase;User ID=myUsername;Password=myPassword; 
```

其中 DBMSSOCN=TCP/IP

# asp.net - 如何在 asp.net 应用程序中实现“悲观锁定”？

> ID：617934
> 
> 赞同：6
> 
> 时间：2009-03-06T07:14:22.410
> 
> 标签：asp.net, locking

我想从任何有经验的人那里得到一些建议，比如在 asp.net 应用程序中实现“悲观锁定”。这是我正在寻找的行为：

1.  用户 A 打开订单 #313
2.  用户 B 尝试打开订单 #313，但被告知用户 A 已将订单仅打开 X 分钟。

由于我之前没有实现过这个功能，所以我有几个设计问题：

*   我应该在订单记录中附加哪些数据？我正在考虑：
    *   锁定拥有者
    *   锁定获取时间
    *   锁定刷新时间

如果 LockRefreshedTime <（现在 - 10 分钟），我会考虑解锁记录。

*   我如何保证锁的持有时间不会超过必要的时间，但也不会意外过期？

我对 jQuery 非常满意，因此欢迎使用客户端脚本的方法。这将是一个内部 Web 应用程序，因此我可以相当自由地使用带宽/周期。我还想知道“悲观锁定”是否适合这个概念。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-06T07:24:41.883

听起来你大部分时间都在那里。我不认为你真的需要 LockRefreshedTime ，它并没有真正添加任何东西。您也可以使用 LockAcquiredTime 来确定锁何时变得陈旧。

您要做的另一件事是确保您使用交易。您需要将锁的检查和设置包装在数据库事务中，这样您就不会得到两个认为他们拥有有效锁的用户。

如果您的任务需要获得对多个资源的锁定（即，给定类型的多个记录或多个记录类型），那么您需要在执行锁定的任何位置以相同的顺序应用锁定。否则，您可能会遇到死锁，其中一位代码已锁定记录 A 并想要锁定记录 B，而另一位代码已锁定 B 并正在等待记录 A。

至于如何确保不会意外释放锁。确保如果您有任何长时间运行的进程可能运行时间超过锁定超时时间，那么它会在运行期间刷新其锁定。

术语“显式锁定”也用于描述这种锁定时间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-07-21T00:35:48.650

我已经手动完成了。

*   将记录的主键存储到锁表中，并将记录模式属性标记为编辑。
*   当另一个用户尝试选择此记录时，请指明该用户的仅就绪记录。
*   设置锁定记录的最长时间。
*   刷新锁定记录的页面数据。虽然允许用户进行更改，但所有其他用户只允许检查。

锁表应该有类似这样的设计：

```
User_ID, //who locked
Lock_start_Time,
Locked_Row_ID(Entity_ID), //this is primary key of the table of locked row.
Table_Name(Entity_Name) //table name of the locked row. 
```

剩下的逻辑是你必须弄清楚的。

这只是我在 4 年前应客户的特殊要求实施的一个想法。在那个客户之后，没有人再要求我做类似的事情，所以我还没有实现任何其他方法。

# c++ - 如何知道 CThreadPool 的工作何时完成？

> ID：617938
> 
> 赞同：1
> 
> 时间：2009-03-06T07:16:54.307
> 
> 标签：c++, multithreading, atl

我最近发现了 ATL 的 CThreadPool 类并且对这个发现非常满意。这是一个简洁的小类，它将处理让多个工作线程处理一些任务队列的同步语义。这些任务由一些外部进程提供给 CThreadPool 对象。

虽然非常干净整洁，但似乎没有办法确定所有任务是否都已完成。最好的方法是什么？

例如，假设我需要完成 10 个繁重的计算任务，然后继续做其他事情。在我知道任务已经完成之前，我不能继续前进。

因此，我创建了一个具有 10 个线程的 CThreadPool，将任务放入队列，然后将它们转到线程。我怎么知道任务何时完成？

波阿斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-09-05T21:03:21.873

等待完成任务的最干净的方法是创建一个[事件](http://msdn.microsoft.com/en-us/library/ms686915%28VS.85%29.aspx)，然后通过调用等待工作线程完成[`WaitForSingleObject`](http://msdn.microsoft.com/en-us/library/ms687032%28VS.85%29.aspx)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-06T15:10:21.813

我认为您需要让工作对象的`Execute()`方法使用“主”线程可以监视的某种形式的 IPC。诸如在主线程可以等待的信号量上`Execute()`调用方法并计算等待完成的次数。`ReleaseSemaphore()`或者线程池工作人员可以向主线程从中获取消息的消息队列发布一条消息，指示他们已完成工作项。

# c# - WPF框架控制

> ID：617939
> 
> 赞同：2
> 
> 时间：2009-03-06T07:17:31.043
> 
> 标签：c#, wpf, wpf-controls

我有一个包含 Frame 控件的 WPF 应用程序。框架控件显示 html 内容。html 页面包含一个 JavaScript 函数，我想在 Frame 和 WPF 代码加载 html 页面后调用该函数？有没有一种方法可以调用在 WPF 框架控件和 WPF 代码中加载的 html 页面的 JavaScript 方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-06T08:29:46.860

您不能与框架内的 HTML 进行交互。为了与 HTML 交互，您可以使用 .NET 3.5 SP1 的 WPF 的 WebBrowser 控件。

您可以在此视频中看到正在运行的 WebBrowser 控件：

[http://channel9.msdn.com/posts/AdamKinney/WPF-35-SP1-App-Model-with-Jennifer-Lee/](http://channel9.msdn.com/posts/AdamKinney/WPF-35-SP1-App-Model-with-Jennifer-Lee/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-06T08:14:29.440

无法访问 DOM，所以恐怕不行。如果它是您绝对需要的东西，那么您最好的选择可能是从 System.Windows.Forms 嵌入 WinForms WebBrowser 控件。

```
<Page
  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
  xmlns:f="clr-namespace:System.Windows.Forms;assembly=System.Windows.Forms" 
  xmlns:fi="clr-namespace:System.Windows.Forms.Integration;assembly=WindowsFormsIntegration.dll" >
  <Grid>  
    <fi:WindowsFormsHost>
      <f:WebBrowser x:Name="BrowserControl" Url="http://www.myurl.com/"/>
    </fi:WindowsFormsHost>
  </Grid>
</Page> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-07-08T13:32:30.697

Use `<body onload="javascript:alert('hi its loaded. do what you want here');">` in your HTML page, say ***myhtmlpage.html***.

Then use a frame XAML control (`<Frame Name="myWpfFrame" Source="http://myurl/myhtmlpage.html">`) in your WPF code.

* * *

This solution will work assuming you want to call the javascript ***only once*** and thats ***only after*** the HTML page is loaded.

If you want to call the js more than once, you can possibly set the source property of the frame control from code as and when you need... as in .. `myWpfFrame.Source = myWpfFrame.Source;`

# oop - OOD：表示计算值的多个对象

> ID：617942
> 
> 赞同：1
> 
> 时间：2009-03-06T07:21:22.640
> 
> 标签：oop

抱歉，问题标题不好。

假设我有 DateRange 类，它基本上只包含开始日期和结束日期。

我的问题是：我如何表示计算的日期范围，例如“本周”、“过去两周”、“上个月”和“本季度”，以便多个客户可以以一致的方式使用这些计算的日期范围? 也就是说，我将拥有多个类的多个对象，它们都需要知道“本周”是什么。

我可以将它们构建到 DateRange 中，但这似乎不是一个好的解决方案，因为可能会添加更多内容，或者随着时间的推移某些内容可能会过时......事实上，这肯定会发生。我可以使 DateRange 抽象并扩展它，但是我将有一堆小类。我可以创建某种计算这些日期的静态助手类。你会如何处理这个问题？

dateRange = new DateRange(RangeEnum.THISWEEK));

或者

dateRange = new ThisWeek();

或者

dateRange = DateHelper.getThisWeek();

或者

?

为了在这件事上加个扳手，假设我还需要表示一个范围，例如“包含日期为 2008 年 5 月 1 日的工作周”。说到这里，我倾向于帮助类……有一大堆愚蠢的方法感觉很尴尬。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-06T07:43:02.747

为什么要创建一个助手类。.NET 框架中使用的常见习惯用法是将静态属性添加到现有类。

```
class DateRange
{
     DateRange ourCurrentWeek = null;

     public static DateRange ThisWeek
     {
          get
          {
              //create ourCurrentWeek if not yet assigned.
              //test current week; is it still correct or does it need updating
              return ourCurrentWeek;
          }
     }
 } 
```

用法很简单：-

```
DateRange.ThisWeek 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-06T07:30:58.733

我会和助手类​​一起走。

```
DateRange dr = Helper.getThisWeek(); 
```

你是对的，你会得到一堆方法，但是如果你将某些东西子类化，你会得到一堆类。这样您就可以确定在哪里寻找。

# c++ - 字符数组的最佳替换

> ID：617943
> 
> 赞同：2
> 
> 时间：2009-03-06T07:21:32.220
> 
> 标签：c++, data-structures

我们有一个数据结构

```
struct MyData
{
       int length ;
       char package[MAX_SIZE];  
}; 
```

其中 MAX_SIZE 是一个固定值。现在我们要更改它以支持大于 MAX_SIZE 的“无限”包长度。建议的解决方案之一是用指针替换静态数组，然后根据我们的需要动态分配大小对于 EX

```
struct MyData
{
       int length ;
       char* package;  
}; 
```

进而

```
package = (char*)malloc(SOME_RUNTIME_SIZE) ; 
```

现在我的问题是，这是满足需求的最有效方法，还是有任何其他方法.. 可能使用 STL 数据结构，如可增长数组等。我们想要一个解决方案，其中大多数适用于静态 char 数组的代码也适用于新结构..

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-06T07:34:59.083

更好/更安全：

```
struct my_struct
{
    std::vector<char>package;  
}; 
```

要调整它的大小：

```
my_struct s;
s.package.resize(100); 
```

看看它有多大：

```
my_struct s;
int size = s.package.size(); 
```

您甚至可以将函数放在结构中以使其更好：

```
struct my_struct
{
  std::vector<char>package;  

  void resize(int n) {
    package.resize(n);
  }
  int size() const {
    return package.size();
  }
};

my_struct s;
s.resize(100);
int z = s.size(); 
```

在不知不觉中，您正在编写出色的代码...

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-06T07:40:27.183

> 使用 STL 数据结构，如可增长数组

STL 为您提供了大量容器。不幸的是，选择取决于您的要求。您多久添加一次容器？你删除多少次？你从哪里删除/添加到？你需要随机访问吗？您需要什么性能保证？一旦您对这些事情有了足够清晰的了解，请查看, `vector`,`deque`等。`list``set`

如果您可以提供更多详细信息，我们一定可以帮助您选择合适的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-06T07:45:46.500

我还会包装一个向量：

```
// wraps a vector. provides convenience conversion constructors
// and assign functions. 
struct bytebuf {
    explicit bytebuf(size_t size):c(size) { }

    template<size_t size>
    bytebuf(char const(&v)[size]) { assign(v); }

    template<size_t size>
    void assign(char const(&v)[size]) {
        c.assign(v, v+size);
    }

    // provide access to wrapped vector
    std::vector<char> & buf() {
        return c;
    }

private:
    std::vector<char> c;
};

int main() {
    bytebuf b("data");
    process(&b.buf()[0], b.buf().size()); // process 5 byte

    std::string str(&b.buf()[0]);
    std::cout << str; // outputs "data"

    bytebuf c(100);
    read(&c.buf()[0], c.buf().size()); // read 100 byte
    // ...
} 
```

我认为没有必要为其添加更多功能。您始终可以使用向量获取向量`buf()`并直接对其进行操作。由于向量的存储是连续的，您可以像使用 C 数组一样使用它，但它仍然可以调整大小：

```
c.buf().resize(42) 
```

模板转换构造函数和`assign`函数允许您直接从 C 数组初始化或赋值。如果您愿意，您可以添加更多构造函数，这些构造函数可以从一组两个迭代器或一个指针和一个长度进行初始化。但我会尽量保持低添加功能的数量，所以它一直是一个紧密、透明的向量包装结构。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-06T07:53:52.237

如果这是 C：

*   [不要强制转换的返回值`malloc()`](https://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc)。
*   用于`size_t`表示分配的“包”的大小，而不是`int`.

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-06T08:10:55.347

如果您将字符数组用作字符数组，请使用 a `std::vector<char>`，因为这就是向量的用途。如果您将字符数组用作字符串，请使用 a 以`std::string`与 a 几乎相同的方式存储其数据`std::vector<char>`，但会更清楚地传达其目的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-06T07:33:12.300

是的，我会为此使用 STL 向量：

```
struct
{
    std::vector<char> package;
    // not sure if you have anything else in here ?
}; 
```

但是你的结构长度成员只是变成了 package.size ()。

您可以像在原始 char 数组 (package[index]) 中一样对向量中的字符进行索引。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-06T07:45:02.867

使用双端队列。确保向量可以正常工作，但是双端队列会使用碎片内存并且几乎一样快。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-06T08:50:24.190

你是如何使用你的结构的？
它是像数组还是像字符串？

我只需 typedef 一个 C++ 容器：

```
typedef  std::string  MyData; // or std::vector<char> if that is more appropriate 
```

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2009-03-06T07:33:20.040

如果您不需要即时调整大小，您所写的内容可以工作，并且可能是最好的做法。如果你发现你需要扩展你的数组，你可以运行

```
package = (char*)realloc((void*)package, SOME_RUNTIME_SIZE) ; 
```

您可以使用 STL 向量

```
include <vector>

std::vector<char> myVec();  //optionally myVec(SOME_RUNTIME_SIZE) 
```

然后您可以使用 myVec.resize(newSize) 或使用诸如 push_back 等添加到向量并自动调整大小的函数来调整大小。向量解决方案的好处是它消除了许多内存管理问题——如果向量是堆栈分配的，它的析构函数将在它超出范围时被调用，并且它底层的动态分配数组将被删除。但是，如果您传递向量，数据将被复制，这可能会很慢，因此您可能需要将指针传递给向量。

# c++ - 从 CThreadPool 下的工作线程传输错误信息的最佳方法是什么？

> ID：617944
> 
> 赞同：0
> 
> 时间：2009-03-06T07:21:53.327
> 
> 标签：c++, multithreading, error-handling, atl

我最近发现了 ATL 的 CThreadPool 类并且对这个发现非常满意。这是一个简洁的小类，它将处理让多个工作线程处理一些任务队列的同步语义。这些任务由一些外部进程提供给 CThreadPool 对象。

现在假设其中一个工作线程遇到错误，或者有异常。我并不是指您希望整个应用程序死掉的异常类型，但这是您想要更优雅地处理的事情。优雅地说，我的意思是应用程序可能会死掉，但我需要做一些清理工作，并在某处放置一条正确的消息，说明它为什么会死掉。

将错误信息（消息、错误代码、源等）传输到拥有 CThreadPool 对象的主线程的最佳方式是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-06T13:10:08.107

如果我正在使用这个系统，我会使用应用程序的消息处理程序可以响应的自定义事件从错误任务中发布消息。您应该捆绑您需要的任何信息以便正确清理。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-06T13:30:40.507

使用具有同步访问权限的队列来记录队列中的消费者事件的所有错误和线程。

# c# - 文件上传和根目录

> ID：617948
> 
> 赞同：0
> 
> 时间：2009-03-06T07:24:49.903
> 
> 标签：c#, .net, file-upload, root

FileUpload 控件要求我在 SaveAs() 方法中提供根目录。但是，我更希望上传的文件进入一个虚拟目录，例如“~/UserFiles/[username]/[filename]”。有没有办法让我做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-06T07:33:23.750

使用页面 MapPath 方法：-

```
ctl.SaveAs(MapPath("~/UserFiles/[username]/[filename]")); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-06T07:28:37.290

不，关键字是要求。下载后，您可以使用脚本复制文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-06T07:47:52.577

有时 MapPath 不能直接访问。

在这种情况下使用

```
ctl.SaveAs(Server.MapPath("~/UserFiles/[username]/[filename]")); 
```

# iphone - 在导航控制器中的子视图之间转换？

> ID：617949
> 
> 赞同：0
> 
> 时间：2009-03-06T07:25:49.980
> 
> 标签：iphone, navigation, transition, hierarchy

在我的应用程序中，我有一个向下钻取类型的界面，如下所示：
我的根视图，它有一个项目列表和一个“添加”按钮。
选择一个项目会推动导航控制器上的“详细信息”视图。
选择“添加”按钮会推送“添加”视图。

如何在 Add 视图和 Detail 视图之间转换？

我正在考虑在 Add 视图上做一个无动画的“pop”并推动 Detail 控制器，但是我如何使第二部分动画化，所以细节视图要么垂直滑入，要么从 Add 视图淡入？

谢谢，
凯尔索

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-08T09:43:42.173

您可以将 Add View 推送到 Details 视图并设置一个变量来记住这一点。当用户尝试弹出 Add View 时，您检查先前的变量，如果设置，则直接弹出到根控制器（应该会自动弹出 Details 视图）。

马可

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-23T23:42:07.833

使添加视图成为模式，并在其中提供“完成”（或“保存”）和“取消”按钮。如果用户点击取消，您只需关闭模式。如果他们点击完成，则将新记录保存到表模型中，然后在返回之前在根视图上重新加载表。为了更好，您可以闪烁新添加的项目。

一个干净的设置方法是让模态控制器实现一个期望“完成”协议方法的委托，并让根控制器实现它并将自己设置为委托。

这样，当用户点击“完成”时，根控制器会收到通知，因此它可以封装所有需要发生的事情。如果您想直接从添加到详细视图，委托方法可以为新添加的记录执行“推送”，您将获得从模式向下滑动到详细视图的良好过渡。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-24T02:59:28.920

根据 Ramin 的回复，您可以尝试这种方式，Apple 在几个示例中使用了这种方式：

**MyListViewController.h**

```
#import "MyAddViewController.h"

@interface MyListViewController : UITableViewController <MyAddViewControllerDelegate> {
}

- (IBAction)add:(id)sender;
@end 
```

**MyListViewController.m**

```
// Action for bring up add view controller
- (IBAction)add:(id)sender {
    MyAddViewController *addViewController = [[MyAddViewController alloc] initWithStyle:UITableViewStyleGrouped];
    addViewController.delegate = self;

    UINavigationController *navigationController = [[UINavigationController alloc] initWithRootViewController:addViewController];
    [self presentModalViewController:navigationController animated:YES];

    [navigationController release];
    [addViewController release];     
}

// MyAddViewController's delegate method, dismiss the add view controller in here
- (void)addViewController:(MyAddViewController *)addViewController didAddData:(MyData *)data{
if (data) {
   MyDetailViewController *detailViewController = [[MyDetailViewController alloc] initWithStyle:UITableViewStylePlain];
   detailViewController.data = data;
   [self.navigationController pushViewController:detailViewController animated:YES];
   [detailViewController release]; 
}
[self dismissModalViewControllerAnimated:YES];
} 
```

**MyAddViewController.h**

```
@protocol MyAddViewControllerDelegate;
@class MyData;

@interface MCCourseAddTableViewController : UITableViewController {
@private
    MyData *data;
    id <MCCourseAddDelegate> delegate;
}

// MyData could be NSManagedObject if you want to use Core Data
@property(nonatomic, retain) MyData *data;
@property(nonatomic, assign) id <MyAddViewControllerDelegate> delegate;

- (void)save;
- (void)cancel;
@end

@protocol MyAddViewControllerDelegate <NSObject>
@optional
- (void)addViewController:(MyAddViewController *)addViewController didAddData:(MyData *)data;;
@end 
```

**MyAddViewController.m**

```
- (void)save {
    if (self.delegate != nil) {
        if ([self.delegate conformsToProtocol:@protocol(MyAddViewControllerDelegate)]){
            if ([self.delegate respondsToSelector:@selector(addViewController:didAddData:)]){
                // Send data back to List View, to bring up detail view controller and dismiss add view controller
                [self.delegate addViewController:self didAddData:self.data];
            }
        }
    }
}

- (void)cancel {
    if (self.delegate != nil) {
        if ([self.delegate conformsToProtocol:@protocol(MyAddViewControllerDelegate)]){
            if ([self.delegate respondsToSelector:@selector(addViewController:didAddData:)]){
                // Send nil back to ListView, to dismiss the add view controller only
                [self.delegate addViewController:self didAddData:nil];
            }
        }
    }
} 
```

# web-services - 从远程客户端简单查询 WSS/MOSS 列表

> ID：617950
> 
> 赞同：0
> 
> 时间：2009-03-06T07:26:20.883
> 
> 标签：web-services, moss, wss

从远程客户端查询 WSS/MOSS 列表的最简单方法是什么

使用 /_vti_bin/lists.asmx 和 XML 片段进行查询似乎是一项简单任务的大量工作？

我找到了[U2U CAML Query Builder](http://www.u2u.info/Blogs/karine/Lists/Posts/Post.aspx?ID=28)这有点帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-06T08:03:46.690

如果您使用 .NET 编写，请参考 Microsoft.SharePoint.Dll，获取一个 SPWeb 实例，并通过该实例获取您的列表实例。然后您可以直接访问它，或者通过定义 SPQuery q、将 CAML 查询字符串设置为 q.Query 并获取 SPListItemCollection col = list["myList"].GetItems(q); 创建 CAML 查询。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-06T12:19:47.387

我找到了解决方案——Linq for Sharepoint 真是太酷了！

[http://www.codeplex.com/LINQtoSharePoint](http://www.codeplex.com/LINQtoSharePoint)

它还没有完成，但它对我来说很好

# python - 如何使这个 python 命令行成为 bash 中的别名？

> ID：617952
> 
> 赞同：1
> 
> 时间：2009-03-06T07:27:36.777
> 
> 标签：python, bash, alias

在阅读了最近在 SO 上回答的问题后，我想要一种快速简单的方法来检查我的 IP 地址。为了将来参考，有没有办法使以下别名起作用？

```
alias myip='python -c "from urllib import urlopen; print urlopen("http://whatismyip.appjet.net").read()[:-1]"' 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-06T07:34:49.300

```
alias myip="python -c 'from urllib import urlopen; print urlopen(\"http://whatismyip.appjet.net\").read()[:-1]'" 
```

您需要在别名中使用单引号来阻止 bash 尝试解释其中的部分代码。在处理别名本身的内容时，双引号上的转义符会被去除。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-06T07:34:21.813

引用内部双引号：

```
alias myip='python -c "from urllib import urlopen; print urlopen(\"http://whatismyip.appjet.net\").read()[:-1]"' 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-06T08:19:46.247

也可以用 curl 完成：

```
alias myip='curl "http://whatismyip.appjet.net"' 
```

或使用 wget：

```
alias myip='wget -O - "http://whatismyip.appjet.net" 2>/dev/null' 
```

# iphone - 在 iPhone 桌面上添加图标

> ID：617960
> 
> 赞同：2
> 
> 时间：2009-03-06T07:32:08.310
> 
> 标签：iphone, objective-c, cocoa-touch

我想在我的应用程序的 iPhone 屏幕上放置一个图标，例如放置一个图标，如果我触摸该图标，它将执行所需的操作，例如打开声音文件或图像。

所以我想问是否可以通过应用程序在屏幕上放置一个图标并在其上执行一些事件。

问候， 维沙尔

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-06T07:34:07.180

你不能那样做。iPhone 主屏幕上出现的唯一图标将是您的应用程序本身的图标。

编辑：

扩展 Gene 建议的 Web 快捷方式的想法，您*可能*会通过使用特定协议处理程序的 Web 快捷方式来打开您的应用程序，并将 Web 快捷方式添加到主屏幕，从而实现您想要的。看看这篇文章：

[http://www.mobileorchard.com/apple-approved-iphone-inter-process-communication/](http://www.mobileorchard.com/apple-approved-iphone-inter-process-communication/)

我相信这仍然需要用户添加快捷方式，我不*认为*第三方应用程序可以添加网络快捷方式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-06T07:38:51.880

Andynormancx 是正确的。这条规则的唯一例外（据我所知）是 Web 快捷方式——在 Mobile Safari 中，您可以选择“添加到主屏幕”，并且书签页面的快捷方式将出现在 Springboard 上。该图标是网页的部分屏幕截图。

我不知道这对您是否有用，但我想您可以为声音文件或图像的链接添加书签。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-08-21T11:17:24.747

我发现谷歌地图无法在主屏幕上添加书签很烦人。这是一个几乎快速的解决方案：

1.  创建目标 Google 地图的 Tiny URL。旧金山湾区交通为[http://maps.google.com/maps?hl=en&ie=UTF8&ll=37.55111,-122.121277&spn=0.810034,1.182404&z=10&layer=t](http://maps.google.com/maps?hl=en&ie=UTF8&ll=37.55111,-122.121277&spn=0.810034,1.182404&z=10&layer=t)

2.  将 Tiny URL 邮寄给自己。

3.  在电子邮件应用程序中选择 URL。

4.  在 Safari 意识到它是 Google Map url 之前，触摸 url 行上的 x 以取消传输到 Google Map App。

5.  轻触 Safari 底部的 + 并轻触“添加到主屏幕”

适当地命名它，然后在你的主屏幕上就有一个谷歌地图条目。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-02-11T03:09:27.330

您可以做的是创建一个应用程序，然后`ApplicationDidLoad`在您的下方`ApplicationViewController.h` 输入您的代码。（如果您没有 SDK，请不要发布带有 iPhone-SDK 和 Cocoa 标签的问题。）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-10-08T12:40:33.177

除了 Gene 的回答，您可能还需要设置以下元标记：

```
<link rel="apple-touch-icon" href="https://path/to/icon.png" />
<meta name="apple-mobile-web-app-capable" content="yes" /> 
```

# iphone - IB 中的 tabBar viewControllers：发送自定义初始化？

> ID：617973
> 
> 赞同：3
> 
> 时间：2009-03-06T07:36:25.740
> 
> 标签：iphone, cocoa-touch, interface-builder, uitabbarcontroller

我的基于 tabBarController 的应用程序有几个选项卡。每个都有一个自定义的 viewController 类，唯一的区别是实例的初始化方式。有没有办法让界面构建器发送不同的选项卡自定义初始化参数？

目前我正在 viewWillAppear 中进行初始化，但出于多种原因，在 IB 中而不是在代码中进行初始化是有意义的。

有什么建议么？

谢谢，凯尔索

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-12T00:10:30.270

Interface Builder 创建一个对象存档，当您执行程序时该存档未存档。你不能真正告诉 IB 调用特定的方法。

如果您需要在`viewWillAppear:`调用之前进行初始化，您可以在 中进行`awakeFromNib`，保证在所有对象都已加载并且所有出口都已连接到它们的目标后调用。

如果您想更早地进行初始化，可以通过覆盖来实现`initWithCoder:`（请参阅`NSCoding`协议以获取文档）。我不知道它是否记录在任何地方，但这是为从档案中解码的对象指定的初始化。

在上述所有情况下，您将无法接收参数，但在代码中，您应该能够通过明智地使用全局变量来访问您需要的任何内容。您还可以使用`[[UIApplication sharedApplication] delegate]`它来访问您的应用程序委托对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-07T03:22:22.410

我不认为有任何方法可以更改加载 nib 时 IB 运行时调用的方法。如果您描述了您想要完成的工作（即为什么在 viewDidAppear 中进行设置对您不起作用），您可能会得到有关处理初始化的更好方法的建议。

# c# - C#：我怎样才能优雅地或简单地进行跨线程调用？

> ID：617982
> 
> 赞同：3
> 
> 时间：2009-03-06T07:41:33.187
> 
> 标签：c#, visual-studio-2008

我有一个 tcp 服务器，当客户端连接时，它会创建一个新线程并将它们添加到其中，但是每次我尝试访问有关连接的信息或任何有关它的信息时，甚至要计算连接了多少客户端，我得到一个跨线程非法异常或类似的东西。

我阅读了几篇关于委托、调用和反射的教程，但所有示例或教程都让我感到困惑，因为以某种方式调用在另一种方式中失败。

有没有一种优雅或简单的方式来做到这一点？我需要先学习如何做其他事情吗？还是我只是让事情变得比现在更复杂？任何建议、链接或提示都非常感谢和接受。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-06T07:59:03.440

我想您从客户端连接线程直接进入 UI。不是很好。相反，考虑使用 MVP 模式的一些变体来将表示逻辑与视图分离。因此，您的“连接线程”将与一些中介对话，演示者将与同一个中介对话，并且只是交出一些数据以供视图显示。

就跨线程操作而言，特别是 UI 线程操作，我发现`SynchronizationContext`在您想将非 UI 线程的调用编组到 UI 线程时非常有用。有关更深入的讨论，请参阅[本文。](http://www.codeproject.com/KB/threads/SynchronizationContext.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-06T07:45:31.973

使用**委托**和**事件**。

那将是我最好的答案。

[http://www.codeproject.com/KB/cs/Cross_thread_Events.aspx](http://www.codeproject.com/KB/cs/Cross_thread_Events.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-06T07:54:07.057

网上有很多例子可以帮助你： [http ://www.google.com/search?q=tcp+server+multi+thread](http://www.google.com/search?q=tcp+server+multi+thread)

使用 C# 时，[并发和协调运行时 (CCR)](http://msdn.microsoft.com/en-us/library/bb648752.aspx)也有一个关于实现多线程 tcp 服务器的示例。CCR 允许更好的范例来实现并行处理，它简化了许多标准的多线程代码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-06T08:37:41.770

我猜你得到了这个跨线程异常，因为你试图从你的线程代码中更新屏幕元素。如果您需要这样做，您可以使用匿名方法获得一个简单的解决方案。

假设您想将一个项目添加到名为 ListBoxLog 的列表框中。这段代码可以从任何线程中解决问题：

```
ListBoxLog.Invoke((MethodInvoker)delegate { ListBoxLog.Items.Add("Done"); }); 
```

还有一个属性可以检查 .InvokeRequired 你可以检查调用是否是必要的。您通常会在可由主 UI 线程和任何后台线程调用的函数中检查该属性。

您也可以像使用 Invoke 一样使用 BeginInvoke。BeginInvoke 是完全异步的，不会等待委托中的代码完成。

# .net - 部署先决条件最佳实践

> ID：617990
> 
> 赞同：0
> 
> 时间：2009-03-06T07:46:23.237
> 
> 标签：.net, deployment, visual-studio-2005, setup-deployment

我有一个需要 .NET Framework 3 的应用程序。我计划使用由 VS2005 部署项目构建的安装工具包来部署该应用程序。在部署包中包含最后一个已知的 .NET 版本（在我的情况下为 3.5 SP1）引导程序或包含我的项目需要的内容（.NET3）的最佳实践是什么？

谢谢你的时间。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-06T07:55:37.690

在这种特殊情况下，我更喜欢最新版本并绑定它，因为 3.0 版本有点匆忙，只是因为 Vista 必须发布。另一方面，这意味着 3.0 预装在 Vista 上，这简化了您的部署。并且在 3.5SP1 机器上安装 3.0 将跳过安装，因此在发布 3.0 时没有什么坏处。

由于错误修复和性能改进，我仍然会部署 3.5SP1，并且因为 3.5SP1 完全向后兼容 3.0。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-06T07:58:57.340

这帮助我反其道而行之，使用 VS2008 创建一个 .NET 2.0 包。也许它可以阐明您需要配置的安装项目中的两个部分：http: [//www.codeproject.com/KB/dotnet/targetnet2fromvs2008.aspx](http://www.codeproject.com/KB/dotnet/targetnet2fromvs2008.aspx)

1.  先决条件
2.  发射条件

# iphone - 如何使用 iPhone UIImageView 链接缩放动画？

> ID：617992
> 
> 赞同：11
> 
> 时间：2009-03-06T07:46:44.220
> 
> 标签：iphone, animation, transform, scale

我正在尝试缩小图像，更改图像，然后将其放大。

```
CABasicAnimation* shrink = [CABasicAnimation animationWithKeyPath:@"transform.scale"];
shrink.toValue = [NSNumber numberWithDouble:0];
shrink.duration = 1;
    shrink.delegate = self;
    [myImageView.layer addAnimation:shrink forKey:@"shrink"]; 
```

进行收缩，然后当它完成时，我更改图像，并开始增长：

```
- (void)animationDidStop:(CAAnimation *)theAnimation finished:(BOOL)flag 
{
    myImageView.image = [images objectAtIndex:image];
CABasicAnimation* grow = [CABasicAnimation animationWithKeyPath:@"transform.scale"];
grow.toValue = CGAffineTransformMakeScale(1,1);
    grow.delegate = self;
grow.duration = 1;
[myImageView.layer addAnimation:grow forKey:@"grow"];   
} 
```

这在模拟器上效果很好，但在设备上，当收缩完成时，我会得到一个完整尺寸的旧图像的闪光，然后增长动画从新图像开始。

知道如何摆脱那个闪光吗？

（我尝试过“removedOnCompletion = NO;”并尝试将 affineTransform 设置为第一次完成后按比例缩小的大小，但运气不佳。）

任何提示表示赞赏。

KB

编辑：

优秀的！设置以下内容：

```
shrink.fillMode = kCAFillModeForwards; 
shrink.removedOnCompletion = NO; 
```

去掉了闪退。谢谢，本！

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-06T11:54:59.660

尝试将动画设置`fillMode`为`kCAFillModeForwards`. 这应该使项目在动画结束时保持原样，而不是之前。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-06T08:02:41.590

当我尝试在 animationDidStop 方法中创建另一个 CAAnimation 时，我遇到了同样的问题。我建议使用 CAKeyframeAnimation。

# shell - 找到文本时失败的 cmd 脚本

> ID：617995
> 
> 赞同：0
> 
> 时间：2009-03-06T07:49:29.767
> 
> 标签：shell, scripting, batch-file, cmd

在 Windows 外壳中：

`echo "foo bar" | find "foo"`

成功（即errorlevel = 0）。但是，我想要一个在某些输入文本中找到特定单词时*失败*的脚本（即 errorlevel <> 0）。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-06T08:04:35.550

一点点诡计就可以模仿你想要的。只有前三行是必需的，其余的只是一个测试。

```
c:> echo "foo bar" | find "foo"
c:> if x%errorlevel%==x0 echo 1 | find "2"
c:> if not x%errorlevel%==x0 echo 1 | find "1" >nul 2>nul
c:> echo %errorlevel%
1 
```********