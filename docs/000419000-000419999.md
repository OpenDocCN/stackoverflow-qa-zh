# StackOverflow 问答 000419000-000419999

# asp.net - 管理 URL 路径的困难

> ID：419004
> 
> 赞同：0
> 
> 时间：2009-01-07T02:39:09.167
> 
> 标签：asp.net, url, path

在 ASP.NET 中管理 url 路径可能是一个真正的痛苦。AbsolutePath vs RelativePath vs 等等让我发疯。我发现许多解决方案需要用户编辑 web.config 元素以包含正确的子文件夹路径；前任。

网站根目录：http: [//www.domain.com](http://www.domain.com) Web.config 设置：/

网站根目录：http: [//www.domain.com/blog](http://www.domain.com/blog) web.config 设置：/blog/

有没有办法在不更改 web.config 的情况下正确处理这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-07T03:25:06.407

您可以使用 Request.ApplicationPath。用法参考在[这里](http://msdn.microsoft.com/en-us/library/system.web.httprequest.applicationpath.aspx)。

例如，这样您的图像文件夹将是 Request.ApplicationPath + "/images/";

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-07T03:50:39.100

我认为[Rick 的博客条目](http://www.west-wind.com/Weblog/posts/154812.aspx)有助于解决我的一些问题......

# python - 如何在模块的版本号上引发异常

> ID：419010
> 
> 赞同：4
> 
> 时间：2009-01-07T02:39:56.590
> 
> 标签：python, versioning

当您导入的模块小于或大于其 __version__ 的给定值时，如何引发异常？

有很多不同的方法可以做到这一点，但我觉得现在一定有一些非常简单的方法让我望而却步。在这种情况下，版本号的格式为 xxx

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-07T02:52:13.710

Python 作为 distutils 的一部分内置了这个。该模块被调用`distutils.version`并能够比较几种不同的版本号格式。

```
from distutils.version import StrictVersion

print StrictVersion('1.2.2') > StrictVersion('1.2.1') 
```

有关比您需要的更多信息，请参阅文档：

```
>>> import distutils.version
>>> help(distutils.version) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-07T03:34:59.430

如果您正在谈论使用 easy_install 安装的模块，这就是您所需要的

```
import pkg_resources
pkg_resources.require("TurboGears>=1.0.5") 
```

如果安装的模块版本较低，这将引发错误

```
Traceback (most recent call last):
  File "tempplg.py", line 2, in <module>
    pkg_resources.require("TurboGears>=1.0.5")
  File "/usr/lib/python2.5/site-packages/pkg_resources.py", line 626, in require
    needed = self.resolve(parse_requirements(requirements))
  File "/usr/lib/python2.5/site-packages/pkg_resources.py", line 528, in resolve
    raise VersionConflict(dist,req) # XXX put more info here
pkg_resources.VersionConflict: (TurboGears 1.0.4.4 (/usr/lib/python2.5/site-packages/TurboGears-1.0.4.4-py2.5.egg), Requirement.parse('TurboGears>=1.0.5')) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-07T02:51:06.723

像这样？

```
assert tuple(map(int,module.__version__.split("."))) >= (1,2), "Module not version 1.2.x" 
```

这很罗嗦，但效果很好。

另外，查看[pip](http://pypi.python.org/pypi/pip/)，它提供了更高级的功能。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-07T11:51:04.373

您应该使用 setuptools：

它允许您锁定应用程序的依赖关系，因此即使系统上存在多个版本的 egg 或包，也只会使用正确的版本。

这是一种更好的工作方式：如果存在错误版本的依赖关系，与其失败，不如确保存在正确的版本。

Setuptools 提供了一个安装程序，它保证运行应用程序所需的一切都在安装时存在。它还为您提供了一种方法来选择您的 PC 上可能存在的许多版本的包中的哪一个是在您发出导入语句时被加载的版本。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2009-01-07T03:24:51.680

如果您知道版本字符串的确切格式，则可以进行简单的比较：

```
>>> "1.2.2" > "1.2.1"
True 
```

这只有在版本的每个部分都是个位数时才有效，但是：

```
>>> "1.2.2" > "1.2.10" # Bug!
True 
```

# c# - 使用 LINQ 将列表拆分为子列表

> ID：419019
> 
> 赞同：429
> 
> 时间：2009-01-07T02:43:22.107
> 
> 标签：c#, linq, data-structures

有什么方法可以将 a`List<SomeObject>`分成几个单独的列表`SomeObject`，使用项目索引作为每个拆分的分隔符？

让我举例说明：

我有一个`List<SomeObject>`并且我需要一个`List<List<SomeObject>>`or `List<SomeObject>[]`，因此这些结果列表中的每一个都将包含一组原始列表的 3 项（按顺序）。

例如。：

*   原始清单：`[a, g, e, w, p, s, q, f, x, y, i, m, c]`

*   结果列表：`[a, g, e], [w, p, s], [q, f, x], [y, i, m], [c]`

我还需要将结果列表大小作为此函数的参数。

* * *

## 回答 #1

> 赞同：420
> 
> 时间：2009-01-07T03:05:45.947

试试下面的代码。

```
public static IList<IList<T>> Split<T>(IList<T> source)
{
    return  source
        .Select((x, i) => new { Index = i, Value = x })
        .GroupBy(x => x.Index / 3)
        .Select(x => x.Select(v => v.Value).ToList())
        .ToList();
} 
```

这个想法是首先按索引对元素进行分组。除以三具有将它们分组为 3 组的效果。然后将每个组转换为列表，将`IEnumerable`of`List`转换`List`为`List`s

* * *

## 回答 #2

> 赞同：372
> 
> 时间：2011-06-15T18:40:09.887

我刚刚写了这个，我认为它比其他提出的解决方案更优雅一点：

```
/// <summary>
/// Break a list of items into chunks of a specific size
/// </summary>
public static IEnumerable<IEnumerable<T>> Chunk<T>(this IEnumerable<T> source, int chunksize)
{
    while (source.Any())
    {
        yield return source.Take(chunksize);
        source = source.Skip(chunksize);
    }
} 
```

* * *

## 回答 #3

> 赞同：119
> 
> 时间：2012-05-03T05:15:01.517

一般来说，[CaseyB](https://stackoverflow.com/a/6362642/17174)建议的方法效果很好，事实上，如果你传入 a`List<T>`很难出错，也许我会将其更改为：

```
public static IEnumerable<IEnumerable<T>> ChunkTrivialBetter<T>(this IEnumerable<T> source, int chunksize)
{
   var pos = 0; 
   while (source.Skip(pos).Any())
   {
      yield return source.Skip(pos).Take(chunksize);
      pos += chunksize;
   }
} 
```

这将避免大量的调用链。尽管如此，这种方法有一个普遍的缺陷。它实现了每个块的两个枚举，以突出尝试运行的问题：

```
foreach (var item in Enumerable.Range(1, int.MaxValue).Chunk(8).Skip(100000).First())
{
   Console.WriteLine(item);
}
// wait forever 
```

为了克服这个问题，我们可以尝试[Cameron 的](https://stackoverflow.com/a/10426375/17174)方法，它通过了上述测试，因为它只遍历了一次枚举。

问题是它有一个不同的缺陷，它实现了每个块中的每个项目，这种方法的问题是你的内存很高。

为了说明尝试运行：

```
foreach (var item in Enumerable.Range(1, int.MaxValue)
               .Select(x => x + new string('x', 100000))
               .Clump(10000).Skip(100).First())
{
   Console.Write('.');
}
// OutOfMemoryException 
```

最后，任何实现都应该能够处理块的乱序迭代，例如：

```
Enumerable.Range(1,3).Chunk(2).Reverse().ToArray()
// should return [3],[1,2] 
```

许多高度优化的解决方案，比如我对这个答案的第一次[修订，都在那里失败了。](https://stackoverflow.com/posts/10425490/revisions)[在casperOne 的优化](https://stackoverflow.com/a/419058/17174)答案中可以看到同样的问题。

要解决所有这些问题，您可以使用以下方法：

```
namespace ChunkedEnumerator
{
    public static class Extensions 
    {
        class ChunkedEnumerable<T> : IEnumerable<T>
        {
            class ChildEnumerator : IEnumerator<T>
            {
                ChunkedEnumerable<T> parent;
                int position;
                bool done = false;
                T current;

                public ChildEnumerator(ChunkedEnumerable<T> parent)
                {
                    this.parent = parent;
                    position = -1;
                    parent.wrapper.AddRef();
                }

                public T Current
                {
                    get
                    {
                        if (position == -1 || done)
                        {
                            throw new InvalidOperationException();
                        }
                        return current;

                    }
                }

                public void Dispose()
                {
                    if (!done)
                    {
                        done = true;
                        parent.wrapper.RemoveRef();
                    }
                }

                object System.Collections.IEnumerator.Current
                {
                    get { return Current; }
                }

                public bool MoveNext()
                {
                    position++;

                    if (position + 1 > parent.chunkSize)
                    {
                        done = true;
                    }

                    if (!done)
                    {
                        done = !parent.wrapper.Get(position + parent.start, out current);
                    }

                    return !done;

                }

                public void Reset()
                {
                    // per http://msdn.microsoft.com/en-us/library/system.collections.ienumerator.reset.aspx
                    throw new NotSupportedException();
                }
            }

            EnumeratorWrapper<T> wrapper;
            int chunkSize;
            int start;

            public ChunkedEnumerable(EnumeratorWrapper<T> wrapper, int chunkSize, int start)
            {
                this.wrapper = wrapper;
                this.chunkSize = chunkSize;
                this.start = start;
            }

            public IEnumerator<T> GetEnumerator()
            {
                return new ChildEnumerator(this);
            }

            System.Collections.IEnumerator System.Collections.IEnumerable.GetEnumerator()
            {
                return GetEnumerator();
            }

        }

        class EnumeratorWrapper<T>
        {
            public EnumeratorWrapper (IEnumerable<T> source)
            {
                SourceEumerable = source;
            }
            IEnumerable<T> SourceEumerable {get; set;}

            Enumeration currentEnumeration;

            class Enumeration
            {
                public IEnumerator<T> Source { get; set; }
                public int Position { get; set; }
                public bool AtEnd { get; set; }
            }

            public bool Get(int pos, out T item) 
            {

                if (currentEnumeration != null && currentEnumeration.Position > pos)
                {
                    currentEnumeration.Source.Dispose();
                    currentEnumeration = null;
                }

                if (currentEnumeration == null)
                {
                    currentEnumeration = new Enumeration { Position = -1, Source = SourceEumerable.GetEnumerator(), AtEnd = false };
                }

                item = default(T);
                if (currentEnumeration.AtEnd)
                {
                    return false;
                }

                while(currentEnumeration.Position < pos) 
                {
                    currentEnumeration.AtEnd = !currentEnumeration.Source.MoveNext();
                    currentEnumeration.Position++;

                    if (currentEnumeration.AtEnd) 
                    {
                        return false;
                    }

                }

                item = currentEnumeration.Source.Current;

                return true;
            }

            int refs = 0;

            // needed for dispose semantics 
            public void AddRef()
            {
                refs++;
            }

            public void RemoveRef()
            {
                refs--;
                if (refs == 0 && currentEnumeration != null)
                {
                    var copy = currentEnumeration;
                    currentEnumeration = null;
                    copy.Source.Dispose();
                }
            }
        }

        public static IEnumerable<IEnumerable<T>> Chunk<T>(this IEnumerable<T> source, int chunksize)
        {
            if (chunksize < 1) throw new InvalidOperationException();

            var wrapper =  new EnumeratorWrapper<T>(source);

            int currentPos = 0;
            T ignore;
            try
            {
                wrapper.AddRef();
                while (wrapper.Get(currentPos, out ignore))
                {
                    yield return new ChunkedEnumerable<T>(wrapper, chunksize, currentPos);
                    currentPos += chunksize;
                }
            }
            finally
            {
                wrapper.RemoveRef();
            }
        }
    }

    class Program
    {
        static void Main(string[] args)
        {
            int i = 10;
            foreach (var group in Enumerable.Range(1, int.MaxValue).Skip(10000000).Chunk(3))
            {
                foreach (var n in group)
                {
                    Console.Write(n);
                    Console.Write(" ");
                }
                Console.WriteLine();
                if (i-- == 0) break;
            }

            var stuffs = Enumerable.Range(1, 10).Chunk(2).ToArray();

            foreach (var idx in new [] {3,2,1})
            {
                Console.Write("idx " + idx + " ");
                foreach (var n in stuffs[idx])
                {
                    Console.Write(n);
                    Console.Write(" ");
                }
                Console.WriteLine();
            }

            /*

10000001 10000002 10000003
10000004 10000005 10000006
10000007 10000008 10000009
10000010 10000011 10000012
10000013 10000014 10000015
10000016 10000017 10000018
10000019 10000020 10000021
10000022 10000023 10000024
10000025 10000026 10000027
10000028 10000029 10000030
10000031 10000032 10000033
idx 3 7 8
idx 2 5 6
idx 1 3 4
             */

            Console.ReadKey();

        }

    }
} 
```

您还可以为块的无序迭代引入一轮优化，这超出了这里的范围。

至于你应该选择哪种方法？这完全取决于您要解决的问题。如果您不关心第一个缺陷，那么简单的答案非常吸引人。

**请注意**，与大多数方法一样，这对于多线程是不安全的，如果您希望使其线程安全，您需要修改`EnumeratorWrapper`.

* * *

## 回答 #4

> 赞同：71
> 
> 时间：2009-01-07T03:02:43.627

您*可以*使用许多使用[`Take`](http://msdn.microsoft.com/en-us/library/bb503062.aspx)and的查询[`Skip`](http://msdn.microsoft.com/en-us/library/bb358985.aspx)，但我相信这会在原始列表上添加太多迭代。

相反，我认为您应该创建自己的迭代器，如下所示：

```
public static IEnumerable<IEnumerable<T>> GetEnumerableOfEnumerables<T>(
  IEnumerable<T> enumerable, int groupSize)
{
   // The list to return.
   List<T> list = new List<T>(groupSize);

   // Cycle through all of the items.
   foreach (T item in enumerable)
   {
     // Add the item.
     list.Add(item);

     // If the list has the number of elements, return that.
     if (list.Count == groupSize)
     {
       // Return the list.
       yield return list;

       // Set the list to a new list.
       list = new List<T>(groupSize);
     }
   }

   // Return the remainder if there is any,
   if (list.Count != 0)
   {
     // Return the list.
     yield return list;
   }
} 
```

然后您可以调用它，它启用了 LINQ，因此您可以对生成的序列执行其他操作。

* * *

根据[Sam 的回答](https://stackoverflow.com/a/10425490/50776)，我觉得有一种更简单的方法可以做到这一点，而无需：

*   再次遍历列表（我最初没有这样做）
*   在释放块之前将项目分组实现（对于大块项目，会有内存问题）
*   Sam 发布的所有代码

就是说，这是另一个过程，我已经在一个扩展方法中将其编码为[`IEnumerable<T>`](http://msdn.microsoft.com/en-us/library/9eekhta0.aspx)调用`Chunk`：

```
public static IEnumerable<IEnumerable<T>> Chunk<T>(this IEnumerable<T> source, 
    int chunkSize)
{
    // Validate parameters.
    if (source == null) throw new ArgumentNullException(nameof(source));
    if (chunkSize <= 0) throw new ArgumentOutOfRangeException(nameof(chunkSize),
        "The chunkSize parameter must be a positive value.");

    // Call the internal implementation.
    return source.ChunkInternal(chunkSize);
} 
```

没有什么令人惊讶的，只是基本的错误检查。

继续`ChunkInternal`：

```
private static IEnumerable<IEnumerable<T>> ChunkInternal<T>(
    this IEnumerable<T> source, int chunkSize)
{
    // Validate parameters.
    Debug.Assert(source != null);
    Debug.Assert(chunkSize > 0);

    // Get the enumerator.  Dispose of when done.
    using (IEnumerator<T> enumerator = source.GetEnumerator())
    do
    {
        // Move to the next element.  If there's nothing left
        // then get out.
        if (!enumerator.MoveNext()) yield break;

        // Return the chunked sequence.
        yield return ChunkSequence(enumerator, chunkSize);
    } while (true);
} 
```

基本上，它获取[`IEnumerator<T>`](http://msdn.microsoft.com/en-us/library/78dfe2yb.aspx)并手动迭代每个项目。它检查当前是否有要枚举的项目。枚举完每个块后，如果没有剩余任何项目，它就会爆发。

`IEnumerable<T>`一旦它检测到序列中有项目，它将内部实现的责任委托给`ChunkSequence`：

```
private static IEnumerable<T> ChunkSequence<T>(IEnumerator<T> enumerator, 
    int chunkSize)
{
    // Validate parameters.
    Debug.Assert(enumerator != null);
    Debug.Assert(chunkSize > 0);

    // The count.
    int count = 0;

    // There is at least one item.  Yield and then continue.
    do
    {
        // Yield the item.
        yield return enumerator.Current;
    } while (++count < chunkSize && enumerator.MoveNext());
} 
```

由于[`MoveNext`](http://msdn.microsoft.com/en-us/library/system.collections.ienumerator.movenext.aspx)已经在`IEnumerator<T>`传递的 to上被调用`ChunkSequence`，它产生返回的项目[`Current`](http://msdn.microsoft.com/en-us/library/58e146b7.aspx)然后增加计数，确保永远不会返回超过`chunkSize`项目并在每次迭代后移动到序列中的下一个项目（但如果产生的项目超过了块大小）。

如果没有剩余项目，则该`InternalChunk`方法将在外循环中进行另一次传递，但是当`MoveNext`第二次调用时，它仍将返回 false，[根据文档](http://msdn.microsoft.com/en-us/library/system.collections.ienumerator.movenext.aspx)（强调我的）：

> 如果 MoveNext 超过集合的末尾，则枚举数位于集合中的最后一个元素之后，并且 MoveNext 返回 false。**当枚举数位于此位置时，对 MoveNext 的后续调用也将返回 false，直到调用 Reset。**

此时，循环将中断，序列序列将终止。

这是一个简单的测试：

```
static void Main()
{
    string s = "agewpsqfxyimc";

    int count = 0;

    // Group by three.
    foreach (IEnumerable<char> g in s.Chunk(3))
    {
        // Print out the group.
        Console.Write("Group: {0} - ", ++count);

        // Print the items.
        foreach (char c in g)
        {
            // Print the item.
            Console.Write(c + ", ");
        }

        // Finish the line.
        Console.WriteLine();
    }
} 
```

输出：

```
Group: 1 - a, g, e,
Group: 2 - w, p, s,
Group: 3 - q, f, x,
Group: 4 - y, i, m,
Group: 5 - c, 
```

需要注意的是，如果您没有耗尽整个子序列或在父序列中的任何点中断，这将不起作用*。*这是一个重要的警告，但如果您的用例是您将消耗序列序列中的*每个*元素，那么这将适合您。

此外，如果您使用订单，它会做一些奇怪的事情，就像[Sam's 在某一时刻所做的那样](https://stackoverflow.com/questions/419019/split-list-into-sublists-with-linq/419058#comment13455703_10425490)。

* * *

## 回答 #5

> 赞同：56
> 
> 时间：2014-01-06T15:40:39.367

好的，这是我的看法：

*   完全懒惰：适用于无限枚举
*   没有中间复制/缓冲
*   O(n) 执行时间
*   当内部序列仅被部分消耗时也有效

```
public static IEnumerable<IEnumerable<T>> Chunks<T>(this IEnumerable<T> enumerable,
                                                    int chunkSize)
{
    if (chunkSize < 1) throw new ArgumentException("chunkSize must be positive");

    using (var e = enumerable.GetEnumerator())
    while (e.MoveNext())
    {
        var remaining = chunkSize;    // elements remaining in the current chunk
        var innerMoveNext = new Func<bool>(() => --remaining > 0 && e.MoveNext());

        yield return e.GetChunk(innerMoveNext);
        while (innerMoveNext()) {/* discard elements skipped by inner iterator */}
    }
}

private static IEnumerable<T> GetChunk<T>(this IEnumerator<T> e,
                                          Func<bool> innerMoveNext)
{
    do yield return e.Current;
    while (innerMoveNext());
} 
```

**示例用法**

```
var src = new [] {1, 2, 3, 4, 5, 6}; 

var c3 = src.Chunks(3);      // {{1, 2, 3}, {4, 5, 6}}; 
var c4 = src.Chunks(4);      // {{1, 2, 3, 4}, {5, 6}}; 

var sum   = c3.Select(c => c.Sum());    // {6, 15}
var count = c3.Count();                 // 2
var take2 = c3.Select(c => c.Take(2));  // {{1, 2}, {4, 5}} 
```

**解释**

该代码通过嵌套两个`yield`基于迭代器的方式工作。

外部迭代器必须跟踪内部（块）迭代器有效消耗了多少元素。这是通过关闭来完成`remaining`的`innerMoveNext()`。在外部迭代器产生下一个块之前，块中未使用的元素被丢弃。这是必要的，因为否则当内部可枚举没有（完全）消耗（例如`c3.Count()`将返回 6）时，您会得到不一致的结果。

> **注意：** *答案已更新以解决@aolszowka 指出的缺点。*

* * *

## 回答 #6

> 赞同：18
> 
> 时间：2015-02-23T19:57:46.213

完全懒惰，不计算也不复制：

```
public static class EnumerableExtensions
{

  public static IEnumerable<IEnumerable<T>> Split<T>(this IEnumerable<T> source, int len)
  {
     if (len == 0)
        throw new ArgumentNullException();

     var enumer = source.GetEnumerator();
     while (enumer.MoveNext())
     {
        yield return Take(enumer.Current, enumer, len);
     }
  }

  private static IEnumerable<T> Take<T>(T head, IEnumerator<T> tail, int len)
  {
     while (true)
     {
        yield return head;
        if (--len == 0)
           break;
        if (tail.MoveNext())
           head = tail.Current;
        else
           break;
     }
  }
} 
```

* * *

## 回答 #7

> 赞同：14
> 
> 时间：2014-09-19T21:03:29.913

我认为以下建议将是最快的。我牺牲了源 Enumerable 的懒惰来使用 Array.Copy 并提前知道我的每个子列表的长度。

```
public static IEnumerable<T[]> Chunk<T>(this IEnumerable<T> items, int size)
{
    T[] array = items as T[] ?? items.ToArray();
    for (int i = 0; i < array.Length; i+=size)
    {
        T[] chunk = new T[Math.Min(size, array.Length - i)];
        Array.Copy(array, i, chunk, 0, chunk.Length);
        yield return chunk;
    }
} 
```

* * *

## 回答 #8

> 赞同：11
> 
> 时间：2012-05-03T06:42:07.340

几年前我写了一个 Clump 扩展方法。效果很好，并且是这里最快的实现。:P

```
/// <summary>
/// Clumps items into same size lots.
/// </summary>
/// <typeparam name="T"></typeparam>
/// <param name="source">The source list of items.</param>
/// <param name="size">The maximum size of the clumps to make.</param>
/// <returns>A list of list of items, where each list of items is no bigger than the size given.</returns>
public static IEnumerable<IEnumerable<T>> Clump<T>(this IEnumerable<T> source, int size)
{
    if (source == null)
        throw new ArgumentNullException("source");
    if (size < 1)
        throw new ArgumentOutOfRangeException("size", "size must be greater than 0");

    return ClumpIterator<T>(source, size);
}

private static IEnumerable<IEnumerable<T>> ClumpIterator<T>(IEnumerable<T> source, int size)
{
    Debug.Assert(source != null, "source is null.");

    T[] items = new T[size];
    int count = 0;
    foreach (var item in source)
    {
        items[count] = item;
        count++;

        if (count == size)
        {
            yield return items;
            items = new T[size];
            count = 0;
        }
    }
    if (count > 0)
    {
        if (count == size)
            yield return items;
        else
        {
            T[] tempItems = new T[count];
            Array.Copy(items, tempItems, count);
            yield return tempItems;
        }
    }
} 
```

* * *

## 回答 #9

> 赞同：9
> 
> 时间：2012-05-03T06:24:02.977

[System.Interactive](http://www.nuget.org/packages/Ix-Main)提供`Buffer()`了这个目的。一些快速测试显示性能类似于 Sam 的解决方案。

* * *

## 回答 #10

> 赞同：9
> 
> 时间：2012-07-11T22:59:40.037

我们可以改进@JaredPar 的解决方案来进行真正的惰性评估。我们使用一种[`GroupAdjacentBy`](https://gist.github.com/2277055)产生具有相同键的连续元素组的方法：

```
sequence
.Select((x, i) => new { Value = x, Index = i })
.GroupAdjacentBy(x=>x.Index/3)
.Select(g=>g.Select(x=>x.Value)) 
```

因为这些组是一个接一个地产生的，所以这个解决方案可以有效地处理长序列或无限序列。

* * *

## 回答 #11

> 赞同：9
> 
> 时间：2018-08-09T21:58:37.923

对于任何对打包/维护解决方案感兴趣的人，[MoreLINQ](https://morelinq.github.io/)库提供了[`Batch`](https://morelinq.github.io/3.0/ref/api/html/T_MoreLinq_Extensions_BatchExtension.htm)与您请求的行为相匹配的扩展方法：

```
IEnumerable<char> source = "Example string";
IEnumerable<IEnumerable<char>> chunksOfThreeChars = source.Batch(3); 
```

[该`Batch`实现](https://github.com/morelinq/MoreLINQ/blob/master/MoreLinq/Batch.cs)类似于[Cameron MacFarland 的 answer](https://stackoverflow.com/a/10426375/503410)，增加了一个重载，用于在返回之前转换块/批处理，并且执行得很好。

* * *

## 回答 #12

> 赞同：8
> 
> 时间：2021-10-19T04:41:37.477

### 更新 .NET 6.0

.NET 6.0 向System.Linq 命名空间添加了一个新的本机[Chunk方法：](https://docs.microsoft.com/en-us/dotnet/api/system.linq.enumerable.chunk?view=net-6.0)

```
public static System.Collections.Generic.IEnumerable<TSource[]> Chunk<TSource> (
   this System.Collections.Generic.IEnumerable<TSource> source, int size); 
```

使用这种新方法，除了最后一个块之外的每个块都是 size `size`。最后一个块将包含剩余的元素，并且可能具有较小的大小。

这是一个例子：

```
var list = Enumerable.Range(1, 100);
var chunkSize = 10;

foreach(var chunk in list.Chunk(chunkSize)) //Returns a chunk with the correct size. 
{
    Parallel.ForEach(chunk, (item) =>
    {
        //Do something Parallel here. 
        Console.WriteLine(item);
    });
} 
```

您可能在想，为什么不使用 Skip and Take 呢？这是真的，我认为这更简洁一些，并使事情更具可读性。

* * *

## 回答 #13

> 赞同：6
> 
> 时间：2009-01-07T14:41:54.107

这是我几个月前写的一个列表拆分例程：

```
public static List<List<T>> Chunk<T>(
    List<T> theList,
    int chunkSize
)
{
    List<List<T>> result = theList
        .Select((x, i) => new {
            data = x,
            indexgroup = i / chunkSize
        })
        .GroupBy(x => x.indexgroup, x => x.data)
        .Select(g => new List<T>(g))
        .ToList();

    return result;
} 
```

* * *

## 回答 #14

> 赞同：6
> 
> 时间：2015-04-01T20:18:57.047

我发现这个小片段很好地完成了这项工作。

```
public static IEnumerable<List<T>> Chunked<T>(this List<T> source, int chunkSize)
{
    var offset = 0;

    while (offset < source.Count)
    {
        yield return source.GetRange(offset, Math.Min(source.Count - offset, chunkSize));
        offset += chunkSize;
    }
} 
```

* * *

## 回答 #15

> 赞同：5
> 
> 时间：2010-04-09T10:28:17.070

我们发现 David B 的解决方案效果最好。但我们将其调整为更通用的解决方案：

```
list.GroupBy(item => item.SomeProperty) 
   .Select(group => new List<T>(group)) 
   .ToArray(); 
```

* * *

## 回答 #16

> 赞同：5
> 
> 时间：2013-08-13T08:45:52.690

这个如何？

```
var input = new List<string> { "a", "g", "e", "w", "p", "s", "q", "f", "x", "y", "i", "m", "c" };
var k = 3

var res = Enumerable.Range(0, (input.Count - 1) / k + 1)
                    .Select(i => input.GetRange(i * k, Math.Min(k, input.Count - i * k)))
                    .ToList(); 
```

据我所知，[GetRange()](http://msdn.microsoft.com/en-us/library/21k0e39c.aspx)与所取项目的数量呈线性关系。所以这应该表现良好。

* * *

## 回答 #17

> 赞同：5
> 
> 时间：2014-05-13T13:56:30.553

这是一个老问题，但这就是我的结论；它仅枚举一次可枚举，但确实为每个分区创建列表。它不会`ToArray()`像某些实现那样被调用时出现意外行为：

```
 public static IEnumerable<IEnumerable<T>> Partition<T>(IEnumerable<T> source, int chunkSize)
    {
        if (source == null)
        {
            throw new ArgumentNullException("source");
        }

        if (chunkSize < 1)
        {
            throw new ArgumentException("Invalid chunkSize: " + chunkSize);
        }

        using (IEnumerator<T> sourceEnumerator = source.GetEnumerator())
        {
            IList<T> currentChunk = new List<T>();
            while (sourceEnumerator.MoveNext())
            {
                currentChunk.Add(sourceEnumerator.Current);
                if (currentChunk.Count == chunkSize)
                {
                    yield return currentChunk;
                    currentChunk = new List<T>();
                }
            }

            if (currentChunk.Any())
            {
                yield return currentChunk;
            }
        }
    } 
```

* * *

## 回答 #18

> 赞同：5
> 
> 时间：2015-02-25T09:31:10.977

旧代码，但这是我一直在使用的：

```
 public static IEnumerable<List<T>> InSetsOf<T>(this IEnumerable<T> source, int max)
    {
        var toReturn = new List<T>(max);
        foreach (var item in source)
        {
            toReturn.Add(item);
            if (toReturn.Count == max)
            {
                yield return toReturn;
                toReturn = new List<T>(max);
            }
        }
        if (toReturn.Any())
        {
            yield return toReturn;
        }
    } 
```

* * *

## 回答 #19

> 赞同：4
> 
> 时间：2014-12-12T21:21:31.697

以下解决方案是我能想到的最紧凑的解决方案，即 O(n)。

```
public static IEnumerable<T[]> Chunk<T>(IEnumerable<T> source, int chunksize)
{
    var list = source as IList<T> ?? source.ToList();
    for (int start = 0; start < list.Count; start += chunksize)
    {
        T[] chunk = new T[Math.Min(chunksize, list.Count - start)];
        for (int i = 0; i < chunk.Length; i++)
            chunk[i] = list[start + i];

        yield return chunk;
    }
} 
```

* * *

## 回答 #20

> 赞同：3
> 
> 时间：2009-01-07T02:51:53.820

如果列表是 system.collections.generic 类型，您可以使用可用的“CopyTo”方法将数组的元素复制到其他子数组。您指定要复制的起始元素和元素数量。

您还可以对原始列表进行 3 个克隆，并在每个列表上使用“RemoveRange”将列表缩小到您想要的大小。

或者只是创建一个辅助方法来为你做这件事。

* * *

## 回答 #21

> 赞同：3
> 
> 时间：2016-10-27T06:31:18.863

这是一个旧的解决方案，但我有不同的方法。我`Skip`用来移动到所需的偏移量并`Take`提取所需数量的元素：

```
public static IEnumerable<IEnumerable<T>> Chunk<T>(this IEnumerable<T> source, 
                                                   int chunkSize)
{
    if (chunkSize <= 0)
        throw new ArgumentOutOfRangeException($"{nameof(chunkSize)} should be > 0");

    var nbChunks = (int)Math.Ceiling((double)source.Count()/chunkSize);

    return Enumerable.Range(0, nbChunks)
                     .Select(chunkNb => source.Skip(chunkNb*chunkSize)
                     .Take(chunkSize));
} 
```

* * *

## 回答 #22

> 赞同：2
> 
> 时间：2018-11-29T06:21:03.473

另一种方法是使用[Rx](http://reactivex.io/) [Buffer 运算符](http://reactivex.io/documentation/operators/buffer.html)

```
//using System.Linq;
//using System.Reactive.Linq;
//using System.Reactive.Threading.Tasks;

var observableBatches = anAnumerable.ToObservable().Buffer(size);

var batches = aList.ToObservable().Buffer(size).ToList().ToTask().GetAwaiter().GetResult(); 
```

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2012-08-15T18:38:05.253

使用模块化分区：

```
public IEnumerable<IEnumerable<string>> Split(IEnumerable<string> input, int chunkSize)
{
    var chunks = (int)Math.Ceiling((double)input.Count() / (double)chunkSize);
    return Enumerable.Range(0, chunks).Select(id => input.Where(s => s.GetHashCode() % chunks == id));
} 
```

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2017-08-30T15:27:49.050

只需投入我的两分钱。如果您想“存储”列表（从左到右可视化），您可以执行以下操作：

```
 public static List<List<T>> Buckets<T>(this List<T> source, int numberOfBuckets)
    {
        List<List<T>> result = new List<List<T>>();
        for (int i = 0; i < numberOfBuckets; i++)
        {
            result.Add(new List<T>());
        }

        int count = 0;
        while (count < source.Count())
        {
            var mod = count % numberOfBuckets;
            result[mod].Add(source[count]);
            count++;
        }
        return result;
    } 
```

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2019-09-18T07:33:18.357

```
public static List<List<T>> GetSplitItemsList<T>(List<T> originalItemsList, short number)
    {
        var listGroup = new List<List<T>>();
        int j = number;
        for (int i = 0; i < originalItemsList.Count; i += number)
        {
            var cList = originalItemsList.Take(j).Skip(i).ToList();
            j += number;
            listGroup.Add(cList);
        }
        return listGroup;
    } 
```

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2021-02-10T15:06:01.950

问题是如何“**使用 LINQ 将列表拆分为子列表**”，但有时您可能希望这些子列表成为对原始列表的引用，而不是副本。这允许您从子列表中修改原始列表。在这种情况下，这可能对您有用。

```
public static IEnumerable<Memory<T>> RefChunkBy<T>(this T[] array, int size)
{
    if (size < 1 || array is null)
    {
        throw new ArgumentException("chunkSize must be positive");
    }

    var index = 0;
    var counter = 0;

    for (int i = 0; i < array.Length; i++)
    {
        if (counter == size)
        {
            yield return new Memory<T>(array, index, size);
            index = i;
            counter = 0;
        }
        counter++;

        if (i + 1 == array.Length)
        {
            yield return new Memory<T>(array, index, array.Length - index);
        }
    }
} 
```

用法：

```
var src = new[] { 1, 2, 3, 4, 5, 6 };

var c3 = RefChunkBy(src, 3);      // {{1, 2, 3}, {4, 5, 6}};
var c4 = RefChunkBy(src, 4);      // {{1, 2, 3, 4}, {5, 6}};

// as extension method
var c3 = src.RefChunkBy(3);      // {{1, 2, 3}, {4, 5, 6}};
var c4 = src.RefChunkBy(4);      // {{1, 2, 3, 4}, {5, 6}};

var sum = c3.Select(c => c.Span.ToArray().Sum());    // {6, 15}
var count = c3.Count();                 // 2
var take2 = c3.Select(c => c.Span.ToArray().Take(2));  // {{1, 2}, {4, 5}} 
```

随意使此代码更好。

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2015-01-13T09:55:22.010

插入我的两分钱......

通过对要分块的源使用列表类型，我发现了另一个非常紧凑的解决方案：

```
public static IEnumerable<IEnumerable<TSource>> Chunk<TSource>(this IEnumerable<TSource> source, int chunkSize)
{
    // copy the source into a list
    var chunkList = source.ToList();

    // return chunks of 'chunkSize' items
    while (chunkList.Count > chunkSize)
    {
        yield return chunkList.GetRange(0, chunkSize);
        chunkList.RemoveRange(0, chunkSize);
    }

    // return the rest
    yield return chunkList;
} 
```

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2017-09-06T16:09:36.897

我采用了主要答案并将其作为 IOC 容器来确定拆分位置。（*对于谁真正希望只拆分 3 个项目，在寻找答案时阅读这篇文章？*）

此方法允许根据需要拆分任何类型的项目。

```
public static List<List<T>> SplitOn<T>(List<T> main, Func<T, bool> splitOn)
{
    int groupIndex = 0;

    return main.Select( item => new 
                             { 
                               Group = (splitOn.Invoke(item) ? ++groupIndex : groupIndex), 
                               Value = item 
                             })
                .GroupBy( it2 => it2.Group)
                .Select(x => x.Select(v => v.Value).ToList())
                .ToList();
} 
```

* * *

因此，对于 OP，代码将是

```
var it = new List<string>()
                       { "a", "g", "e", "w", "p", "s", "q", "f", "x", "y", "i", "m", "c" };

int index = 0; 
var result = SplitOn(it, (itm) => (index++ % 3) == 0 ); 
```

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2018-03-03T05:01:27.097

[与Sam Saffron](https://stackoverflow.com/questions/419019/split-list-into-sublists-with-linq/10425490#10425490)的方法一样具有表演性。

```
public static IEnumerable<IEnumerable<T>> Batch<T>(this IEnumerable<T> source, int size)
{
    if (source == null) throw new ArgumentNullException(nameof(source));
    if (size <= 0) throw new ArgumentOutOfRangeException(nameof(size), "Size must be greater than zero.");

    return BatchImpl(source, size).TakeWhile(x => x.Any());
}

static IEnumerable<IEnumerable<T>> BatchImpl<T>(this IEnumerable<T> source, int size)
{
    var values = new List<T>();
    var group = 1;
    var disposed = false;
    var e = source.GetEnumerator();

    try
    {
        while (!disposed)
        {
            yield return GetBatch(e, values, group, size, () => { e.Dispose(); disposed = true; });
            group++;
        }
    }
    finally
    {
        if (!disposed)
            e.Dispose();
    }
}

static IEnumerable<T> GetBatch<T>(IEnumerator<T> e, List<T> values, int group, int size, Action dispose)
{
    var min = (group - 1) * size + 1;
    var max = group * size;
    var hasValue = false;

    while (values.Count < min && e.MoveNext())
    {
        values.Add(e.Current);
    }

    for (var i = min; i <= max; i++)
    {
        if (i <= values.Count)
        {
            hasValue = true;
        }
        else if (hasValue = e.MoveNext())
        {
            values.Add(e.Current);
        }
        else
        {
            dispose();
        }

        if (hasValue)
            yield return values[i - 1];
        else
            yield break;
    }
} 
```

}

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2018-06-05T15:03:35.020

可以使用无限生成器：

```
a.Zip(a.Skip(1), (x, y) => Enumerable.Repeat(x, 1).Concat(Enumerable.Repeat(y, 1)))
 .Zip(a.Skip(2), (xy, z) => xy.Concat(Enumerable.Repeat(z, 1)))
 .Where((x, i) => i % 3 == 0) 
```

演示代码：[https ://ideone.com/GKmL7M](https://ideone.com/GKmL7M)

```
using System;
using System.Collections.Generic;
using System.Linq;

public class Test
{
  private static void DoIt(IEnumerable<int> a)
  {
    Console.WriteLine(String.Join(" ", a));

    foreach (var x in a.Zip(a.Skip(1), (x, y) => Enumerable.Repeat(x, 1).Concat(Enumerable.Repeat(y, 1))).Zip(a.Skip(2), (xy, z) => xy.Concat(Enumerable.Repeat(z, 1))).Where((x, i) => i % 3 == 0))
      Console.WriteLine(String.Join(" ", x));

    Console.WriteLine();
  }

  public static void Main()
  {
    DoIt(new int[] {1});
    DoIt(new int[] {1, 2});
    DoIt(new int[] {1, 2, 3});
    DoIt(new int[] {1, 2, 3, 4});
    DoIt(new int[] {1, 2, 3, 4, 5});
    DoIt(new int[] {1, 2, 3, 4, 5, 6});
  }
} 
```

```
1

1 2

1 2 3
1 2 3

1 2 3 4
1 2 3

1 2 3 4 5
1 2 3

1 2 3 4 5 6
1 2 3
4 5 6 
```

但实际上我更愿意在没有 linq 的情况下编写相应的方法。

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2019-09-13T09:59:15.383

看一下这个！我有一个带有序列计数器和日期的元素列表。每次序列重新启动时，我都想创建一个新列表。

前任。消息列表。

```
 List<dynamic> messages = new List<dynamic>
        {
            new { FcntUp = 101, CommTimestamp = "2019-01-01 00:00:01" },
            new { FcntUp = 102, CommTimestamp = "2019-01-01 00:00:02" },
            new { FcntUp = 103, CommTimestamp = "2019-01-01 00:00:03" },

            //restart of sequence
            new { FcntUp = 1, CommTimestamp = "2019-01-01 00:00:04" },
            new { FcntUp = 2, CommTimestamp = "2019-01-01 00:00:05" },
            new { FcntUp = 3, CommTimestamp = "2019-01-01 00:00:06" },

            //restart of sequence
            new { FcntUp = 1, CommTimestamp = "2019-01-01 00:00:07" },
            new { FcntUp = 2, CommTimestamp = "2019-01-01 00:00:08" },
            new { FcntUp = 3, CommTimestamp = "2019-01-01 00:00:09" }
        }; 
```

我想在计数器重新启动时将列表拆分为单独的列表。这是代码：

```
var arraylist = new List<List<dynamic>>();

        List<dynamic> messages = new List<dynamic>
        {
            new { FcntUp = 101, CommTimestamp = "2019-01-01 00:00:01" },
            new { FcntUp = 102, CommTimestamp = "2019-01-01 00:00:02" },
            new { FcntUp = 103, CommTimestamp = "2019-01-01 00:00:03" },

            //restart of sequence
            new { FcntUp = 1, CommTimestamp = "2019-01-01 00:00:04" },
            new { FcntUp = 2, CommTimestamp = "2019-01-01 00:00:05" },
            new { FcntUp = 3, CommTimestamp = "2019-01-01 00:00:06" },

            //restart of sequence
            new { FcntUp = 1, CommTimestamp = "2019-01-01 00:00:07" },
            new { FcntUp = 2, CommTimestamp = "2019-01-01 00:00:08" },
            new { FcntUp = 3, CommTimestamp = "2019-01-01 00:00:09" }
        };

        //group by FcntUp and CommTimestamp
        var query = messages.GroupBy(x => new { x.FcntUp, x.CommTimestamp });

        //declare the current item
        dynamic currentItem = null;

        //declare the list of ranges
        List<dynamic> range = null;

        //loop through the sorted list
        foreach (var item in query)
        {
            //check if start of new range
            if (currentItem == null || item.Key.FcntUp < currentItem.Key.FcntUp)
            {
                //create a new list if the FcntUp starts on a new range
                range = new List<dynamic>();

                //add the list to the parent list
                arraylist.Add(range);
            }

            //add the item to the sublist
            range.Add(item);

            //set the current item
            currentItem = item;
        } 
```

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2020-06-20T22:38:32.687

如果源集合实现 IList < T >（按索引随机访问），我们可以使用以下方法。它仅在元素真正被访问时才获取元素，因此这对于惰性求值的集合特别有用。类似于无界 IEnumerable< T >，但用于 IList< T >。

```
 public static IEnumerable<IEnumerable<T>> Chunkify<T>(this IList<T> src, int chunkSize)
    {
        if (src == null) throw new ArgumentNullException(nameof(src));
        if (chunkSize < 1) throw new ArgumentOutOfRangeException(nameof(chunkSize), $"must be > 0, got {chunkSize}");

        for(var ci = 0; ci <= src.Count/chunkSize; ci++){
            yield return Window(src, ci*chunkSize, Math.Min((ci+1)*chunkSize, src.Count)-1);
        }
    }

    private static IEnumerable<T> Window<T>(IList<T> src, int startIdx, int endIdx)
    {
        Console.WriteLine($"window {startIdx} - {endIdx}");
        while(startIdx <= endIdx){
            yield return src[startIdx++];
        }
    } 
```

* * *

## 回答 #33

> 赞同：0
> 
> 时间：2021-11-28T20:57:17.387

从 .NET 6 开始，您现在可以使用本机`Chunk()`方法，可用于.NET`IEnumerable<T>`和`IQueryable<T>`.

更多信息（和链接）在这里：[https ://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/concepts/linq/partitioning-data](https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/concepts/linq/partitioning-data)

* * *

## 回答 #34

> 赞同：-1
> 
> 时间：2020-06-21T02:17:24.757

没有办法在一个解决方案中结合所有理想的特性，如完全惰性、无复制、完全通用性和安全性。最根本的原因是无法保证在访问块之前输入不会发生变异。假设我们有如下签名的函数：

```
public static IEnumerable<IEnumerable<T>> Chunk<T>(this IEnumerable<T> source, int chunkSize)
{
    // Some implementation
} 
```

那么下面的使用方式是有问题的：

```
var myList = new List<int>()
{
    1,2,3,4
};
var myChunks = myList.Chunk(2);
myList.RemoveAt(0);
var firstChunk = myChunks.First();    
Console.WriteLine("First chunk:" + String.Join(',', firstChunk));
myList.RemoveAt(0);
var secondChunk = myChunks.Skip(1).First();
Console.WriteLine("Second chunk:" + String.Join(',', secondChunk));
// What outputs do we see for first and second chunk? Probably not what you would expect... 
```

根据具体的实现，代码要么会因运行时错误而失败，要么会产生不直观的结果。

因此，至少需要削弱其中一项属性。如果您想要一个防弹的惰性解决方案，您需要将您的输入类型限制为不可变类型，即使这样，掩盖所有用例也不是一件容易的事。但是，如果您可以控制使用，您仍然可以选择最通用的解决方案，只要您确保它以一种有效的方式使用。否则，您可能会放弃懒惰并接受一些复制。

最后，这完全取决于您的用例和要求，哪种解决方案是您的最佳选择。

# java - Java 的 PreparedStatement 是如何工作的？

> ID：419021
> 
> 赞同：7
> 
> 时间：2009-01-07T02:44:37.300
> 
> 标签：java, jdbc, prepared-statement

我打算用对象替换重复执行的 Statement 对象`PreparedStatement`以提高性能。我正在使用 MySQL 函数`now()`和字符串变量等参数。

`PreparedStatement`我见过的大多数查询都包含常量值（如`10`和字符串`"New York"`）作为`?`查询中使用的参数。我将如何使用`now()`, 和变量等函数作为参数？是否有必要`?`在查询中使用 s 而不是实际值？我很困惑。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-07T03:25:42.117

如果您有一个来自用户输入的变量，那么您必须使用 ? 而不是连接字符串。用户可能会恶意输入字符串，如果您将字符串直接放入 SQL 中，它可能会运行您不想要的命令。

我意识到这个被过度使用了，但它完美地说明了这一点：

![小鲍比桌](https://imgs.xkcd.com/comics/exploits_of_a_mom.png)

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-01-07T02:58:08.647

如果您有变量，请使用“？”

```
int temp = 75;
PreparedStatement pstmt = con.prepareStatement(
    "UPDATE test SET num = ?, due = now() ");
pstmt.setInt(1, temp); 
pstmt.executeUpdate(): 
```

生成如下所示的 sql 语句：

```
UPDATE test SET num = 75, due = now(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-08T15:47:21.993

您不必在 PreparedStatement 中使用占位符。就像是：

```
PreparedStatement stmt = con.prepareStatement("select sysdate from dual"); 
```

会工作得很好。但是，您不能使用占位符然后将函数调用绑定到它。像这样的东西不能用来调用 sysdate 函数：

```
PreparedStatement stmt = con.prepareStatement("select ? from dual");
stmt.setSomethingOrOther(1, "sysdate"); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-11T02:45:00.330

如果您正在调用 SQL 服务器的内置函数，请使用[PreparedStatement](http://java.sun.com/j2se/1.5.0/docs/api/java/sql/PreparedStatement.html)。

如果您正在调用已加载到 SQL 服务器上的存储过程，请使用[CallableStatement](http://java.sun.com/j2se/1.5.0/docs/api/java/sql/CallableStatement.html)。

使用问号作为要传递的函数/过程参数和接收的函数返回值的占位符。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-12-10T08:27:33.013

我开发了一个函数，允许您在 SQL 查询中使用命名参数：

```
private PreparedStatement generatePreparedStatement(String query, Map<String, Object> parameters) throws DatabaseException
    {
        String paramKey = "";
        Object paramValue = null;
        PreparedStatement statement = null;
        Pattern paramRegex = null; 
        Matcher paramMatcher = null;
        int paramIndex = 1;

        try
        {
            //Create the condition
            paramRegex = Pattern.compile("(:[\\d\\w_-]+)", Pattern.CASE_INSENSITIVE | Pattern.MULTILINE);
            paramMatcher = paramRegex.matcher(query);
            statement = this.m_Connection.prepareStatement(paramMatcher.replaceAll("?"),
                                ResultSet.TYPE_FORWARD_ONLY,
                                ResultSet.CONCUR_READ_ONLY, 
                                ResultSet.HOLD_CURSORS_OVER_COMMIT);

            //Check if there are parameters
            paramMatcher = paramRegex.matcher(query);
            while (paramMatcher.find()) 
            {
                paramKey = paramMatcher.group().substring(1);
                if(parameters != null && parameters.containsKey(paramKey))
                {
                    //Add the parameter 
                    paramValue = parameters.get(paramKey);
                    if (paramValue instanceof Date) 
                    {
                        statement.setDate(paramIndex, (java.sql.Date)paramValue);                 
                    } 
                    else if (paramValue instanceof Double) 
                    {
                        statement.setDouble(paramIndex, (Double)paramValue);                  
                    } 
                    else if (paramValue instanceof Long) 
                    {
                        statement.setLong(paramIndex, (Long)paramValue);                  
                    } 
                    else if (paramValue instanceof Integer) 
                    {
                        statement.setInt(paramIndex, (Integer)paramValue);                
                    } 
                    else if (paramValue instanceof Boolean) 
                    {
                        statement.setBoolean(paramIndex, (Boolean)paramValue);                
                    } 
                    else 
                    {
                        statement.setString(paramIndex, paramValue.toString());     
                    }
                }
                else
                {
                    throw new DatabaseException("The parameter '" + paramKey + "' doesn't exists in the filter '" + query + "'");
                }

                paramIndex++;
            }
        }
        catch (SQLException  l_ex) 
        {
            throw new DatabaseException(tag.lib.common.ExceptionUtils.getFullMessage(l_ex));
        }

        return statement;
    } 
```

你可以这样使用它：

```
Map<String, Object> pars = new HashMap<>();
pars.put("name", "O'Really");
String sql = "SELECT * FROM TABLE WHERE NAME = :name"; 
```

# c - char x[256] 与 char* = malloc(256*sizeof(char));

> ID：419022
> 
> 赞同：13
> 
> 时间：2009-01-07T02:44:42.307
> 
> 标签：c, arrays, malloc

最近有人在我正在使用的一段代码中向我指出

```
char* name = malloc(256*sizeof(char));
// more code
free(name); 
```

我的印象是这种设置数组的方式与使用

```
char name[256]; 
```

并且这两种方式都需要使用free()。我错了，如果是这样，有人可以用低级的术语解释一下有什么区别吗？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-01-07T02:48:14.687

在第一个代码中，内存是在堆上动态分配的。需要使用 free() 释放该内存。它的生命周期是任意的：它可以跨越函数边界等。

在第二个代码中，256 个字节分配在堆栈上，并在函数返回时自动回收（或者如果它在所有函数之外，则在程序终止时）。因此，您不必（也不能）对其调用 free() 。它不能泄漏，但它也不会超过函数的末尾。

根据对内存的要求在两者之间进行选择。

附录（人）：

如果我可以补充一点，Ned，大多数实现通常会提供比堆栈更多的堆（至少在默认情况下）。这对于 256 字节通常无关紧要，除非您已经用完堆栈或执行大量递归操作。

此外，根据标准， sizeof(char) 始终为 1，因此您不需要多余的乘法。即使编译器可能会优化它，它也会使代码变得丑陋 IMNSHO。

结束附录（Pax）。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-07T02:52:39.187

> 并且这两种方式都需要使用free()。

不，只有第一个需要免费使用。第二个分配在堆栈上。这使得分配速度非常快。看这里：

```
void doit() {
    /* ... */
    /* SP += 10 * sizeof(int) */
    int a[10];
    /* ... (using a) */

} /* SP -= 10 */ 
```

当您创建它时，编译器在编译时知道它的大小，并将在堆栈中为其分配正确的大小。堆栈是位于某处的一大块连续内存。将某些内容放入堆栈只会增加（或减少取决于您的平台）堆栈指针。超出范围将做相反的事情，并且您的数组被释放。这将自动发生。因此，以这种方式创建的变量具有*自动*存储持续时间。

使用 malloc 是不同的。它将订购一些任意的大内存块（来自一个名为*freestore*的地方）。运行时将不得不查找相当大的内存块。大小可以在运行时确定，因此编译器一般无法在编译时对其进行优化。因为指针可以超出范围，或者被复制，分配的内存和分配内存地址的指针之间没有内在的耦合，所以即使你很久以前离开函数，内存仍然是分配的. 如果时间到了，您必须调用 free 并手动将您从 malloc 获得的地址传递给它。

一些“最新”形式的 C，称为 C99，允许您为数组指定运行时大小。即你可以这样做：

```
void doit(int n) {
    int a[n]; // allocate n * sizeof(int) size on the stack */
} 
```

但是，如果您没有理由使用它，最好避免使用该功能。一个原因是它不是故障安全的：如果没有可用的内存，任何事情都可能发生。另一个是 C99 在编译器中的可移植性不是很好。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-07T04:07:28.473

这里有第三种可能性，即数组可以在函数外部声明，但是是静态的，例如，

```
// file foo.c
char name[256];

int foo() {
    // do something here.
} 
```

我对另一个关于 SO 的问题的回答感到相当惊讶，有人认为这在 C 中是不合适的；这里甚至没有提到，对此我有点困惑和惊讶（比如“他们这些天在学校教孩子什么？”）。

如果使用此定义，则内存是静态分配的，既不在堆上，也不在堆栈上，而是在映像的数据空间中。因此，既不必像 malloc/free 那样进行管理，也不必像使用自动定义那样担心地址被重用。

在这里回顾整个“声明”与“定义”的事情很有用。这是一个例子

```
/* example.c */

char buf1[256] ;           /* declared extern, defined in data space */
static char buf2[256] ;    /* declared static, defined in data space */
char * buf3 ;              /* declared extern, defined one ptr in data space */
int example(int c) {       /* c declared here, defined on stack */
    char buf4[256] ;       /* declared here, defined on stack   */
    char * buf5 = malloc(256)]   /* pointer declared here, defined on stack */
                           /* and buf4 is address of 256 bytes alloc'd on heap */
    buf3 = malloc(256);    /* now buf3 contains address of 256 more bytes on heap */

    return 0;              /* stack unwound; buf4 and buf5 lost.      */
                           /* NOTICE buf4 memory on heap still allocated */
                           /* so this leaks 256 bytes of memory */
} 
```

现在在一个完全不同的文件中

```
/* example2.c */

extern char buf1[];             /* gets the SAME chunk of memory as from example.c */
static char buf2[256];          /* DIFFERENT 256 char buffer than example.c */
extern char * buf3 ;            /* Same pointer as from example.c */
void undoes() {
     free(buf3);                /* this will work as long as example() called first */
     return ;
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-07T02:46:44.177

这是不正确的 - 数组声明不需要 free。此外，如果这是在函数内，它会在堆栈上分配（如果内存服务）并随着函数返回自动释放 - 不要将引用传递回调用者！

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-07T04:34:28.390

分解你的陈述

```
char* name = malloc(256*sizeof(char)); // one statement
char *name; // Step 1 declare pointer to character
name = malloc(256*sizeof(char)); // assign address to pointer of memory from heap
name[2]; // access 3rd item in array
*(name+2); // access 3rd item in array
name++; // move name to item 1 
```

翻译：name 现在是一个指向字符的指针，它被分配了堆上一些内存的地址

```
char name[256]; // declare an array on the stack
name++; // error name is a constant pointer
*(name+2); // access 3rd item in array
name[2]; // access 3rd item in array
char *p = name;
p[2]; // access 3rd item in array
*(p+2); // access 3rd item in array
p++; // move p to item 1
p[0]; // item 1 in array 
```

翻译：name是一个指向某个字符的常量指针，该字符指向栈上的一些内存

在 C 中，数组和指针或多或少是一回事。数组是指向内存的常量指针。主要区别在于，当您调用 malloc 时，您从堆中获取内存，并且从堆中获取的任何内存都必须从堆中释放。当您声明具有大小的数组时，它会从堆栈中分配内存。您无法释放此内存，因为 free 是为了从堆中释放内存。当前程序单元返回时，堆栈上的内存将自动释放。在第二个例子中，free(p) 也是一个错误。p 是堆栈上的名称数组的指针。因此，通过释放 p 您正在尝试释放堆栈上的内存。

这与：

```
int n = 10;
int *p = &n; 
```

在这种情况下释放 p 将是一个错误，因为 p 指向 n ，它是堆栈上的一个变量。因此 p 在堆栈中拥有一个内存位置并且不能被释放。

```
int *p = (int *) malloc(sizeof(int));
*p = 10;
free(p); 
```

在这种情况下，free 是正确的，因为 p 指向堆上由 malloc 分配的内存位置。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-11T20:11:36.220

根据您在哪里运行，堆栈空间可能非常宝贵。例如，如果您正在为 Verizon/Alltel 手机编写 BREW 代码，那么您通常会被限制在极小的堆栈中，但会不断增加堆访问。

此外，由于 char[] 最常用于字符串，因此允许字符串构造方法为所讨论的字符串分配所需的内存并不是一个坏主意，而不是希望永远永远是 256（或任何数字法令）就足够了。

# vb.net - Integer.TryParse - 更好的方法？

> ID：419027
> 
> 赞同：33
> 
> 时间：2009-01-07T02:47:55.640
> 
> 标签：vb.net, tryparse

我发现自己经常需要使用 Integer.TryParse 来测试一个值是否为整数。但是，当您使用 TryParse 时，您必须将引用变量传递给函数，所以我发现自己总是需要创建一个空白整数来传递。通常它看起来像：

```
Dim tempInt as Integer
If Integer.TryParse(myInt, tempInt) Then 
```

考虑到我想要的只是一个简单的真/假响应，我觉得这很麻烦。有没有更好的方法来解决这个问题？为什么没有一个重载函数，我可以只传递我想测试的值并获得真/假响应？

* * *

## 回答 #1

> 赞同：87
> 
> 时间：2009-01-07T03:03:33.207

无需声明整数。

```
If Integer.TryParse(intToCheck, 0) Then 
```

或者

```
If Integer.TryParse(intToCheck, Nothing) Then 
```

* * *

如果你有 .Net 3.5 的能力，你可以为字符串创建一个扩展方法。

```
Public Module MyExtensions

    <System.Runtime.CompilerServices.Extension()> _
    Public Function IsInteger(ByVal value As String) As Boolean
        If String.IsNullOrEmpty(value) Then
            Return False
        Else
            Return Integer.TryParse(value, Nothing)
        End If
    End Function

End Module 
```

然后像这样调用：

```
If value.IsInteger() Then 
```

* * *

抱歉，我知道，我得意忘形了，但您也可以将其添加到 .Net 3.5 中的上述 MyExtensions 类中，除非您需要验证，否则不要担心。

```
<System.Runtime.CompilerServices.Extension()> _
Public Function ToInteger(ByVal value As String) As Integer
    If value.IsInteger() Then
        Return Integer.Parse(value)
    Else
        Return 0
    End If
End Function 
```

然后只需使用

```
value.ToInteger() 
```

如果它不是有效的整数，这将返回 0。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-07T02:59:47.660

由于您使用的是 VB.net，因此您可以使用 IsNumeric 函数

```
If IsNumeric(myInt) Then
    'Do Suff here
End If 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-07T03:22:49.873

```
public static class Util {

    public static Int32? ParseInt32(this string text) {
        Int32 result;
        if(!Int32.TryParse(text, out result))
            return null;
        return result;
    }

    public static bool IsParseInt32(this string text) {
        return text.ParseInt32() != null;
    }

} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-07T02:58:40.627

试试这个代码。

```
Module IntegerHelpers

  Function IsInteger(ByVal p1 as String) as Boolean
    Dim unused as Integer = 0
    return Integer.TryParse(p1,unused)
  End Function
End Module 
```

好的部分是，由于它被声明为模块级函数，它可以在没有限定符的情况下使用。示例用法

```
return IsInteger(mInt) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-07T03:08:27.720

为什么不写一个**扩展方法**来清理你的代码呢？我有一段时间没有写 VB.Net，但这里有一个 c# 示例：

```
public static class MyIntExtensionClass
{
  public static bool IsInteger(this string value)
  {
    if(string.IsNullOrEmpty(value))
      return false;

    int dummy;
    return int.TryParse(value, dummy);
  }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-07T03:34:58.320

[J Ambrose Little](http://dotnettemplar.net/)[早在 2003 年就对 IsNumeric 检查](http://aspalliance.com/80_Benchmarking_IsNumeric_Options.all)进行了计时测试。您可能希望使用 CLR v2 重试上述测试。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-03-10T14:36:42.917

一个变化是：

```
Int32.TryParse(input_string, Globalization.NumberStyles.Integer) 
```

# c# - C# 复选框

> ID：419044
> 
> 赞同：1
> 
> 时间：2009-01-07T02:53:13.913
> 
> 标签：c#

我在总共 8 行的每一行中有 3 个复选框。我希望每行中的第三个复选框仅在前两个复选框未选中时才被选中。我不想为每一行编写一个 checkRow() 方法。

最好的方法是什么？

```
private void checkRow()
{
    for (int i = 0; i < 8; i++)
    {
        var arraylist = new[] { checkbox1, checkbox2, checkbox3 };
        if (checkbox1.Checked || checkbox2.Checked)
        {
            arraylist[2].Checked = false;
        }
        else
            arraylist[2].Checked = true;
    }
}

private void checbox1_CheckedChanged(object sender, EventArgs e)
{
    checkRow();
}

private void checbox2_CheckedChanged(object sender, EventArgs e)
{
    checkRow();
}

private void checbox3_CheckedChanged(object sender, EventArgs e)
{
    checkRow();
} 
```

作为回应。

```
private void checkRow()
{
    var arraylist = new[] { checkEdit1, checkEdit2, checkEdit3 };
    var arraylist1 = new[] { checkEdit4, checkEdit5, checkEdit6 };
    var arraylist2 = new[] { checkEdit7, checkEdit8, checkEdit9 };
    var array = new[] { arraylist, arraylist1, arraylist2 };

    for (int i = 0; i < 8; i++)
    {
        //if checkedit1 or checkedit2 is checked the checkedit3 should not be checked
        if (array[i]....Checked || array[i]....Checked)
        {
            arraylist[i]...Checked = false;
        }
        else
            arraylist[i]...Checked = true;
    }
} 
```

我试图做这样的事情，这样我就不必为每一行编写 checkRow()

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-07T02:56:20.850

您应该对所有三个委托使用与处理程序相同的方法。

```
chkbox.CheckedChanged += new EventHandler(chkbox_CheckedChanged);
chkbox2.CheckedChanged += new EventHandler(chkbox_CheckedChanged);
chkbox3.CheckedChanged += new EventHandler(chkbox_CheckedChanged);

private void chkbox_CheckedChanged(object sender, EventArgs e)
{
    // do your stuff here
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-07T03:28:51.593

假设您没有使用一种`DataGridView`或其他方式将它们组织成逻辑行，为什么不执行以下操作：

将复选框存储在数组中，以便您轻松访问它们。

```
 CheckBox[,] checkArray = new CheckBox[8,3]... 
```

将行索引存储在`Tag`第一个和第二个复选框的属性中。

```
 checkBox01.Tag = 0;
  checkBox02.Tag = 0;
  checkBox11.Tag = 1;
  checkBox12.Tag = 1; 
```

让所有第一个和第二个复选框都指向同一个事件处理程序：

```
 checkBox01.CheckedChanged += new EventHandler(aCheckBox_CheckedChanged);
  checkBox02.CheckedChanged += new EventHandler(aCheckBox_CheckedChanged);
  checkBox11.CheckedChanged += new EventHandler(aCheckBox_CheckedChanged);
  checkBox12.CheckedChanged += new EventHandler(aCheckBox_CheckedChanged); 
```

在事件处理程序中，您现在确切地知道要更新哪个复选框并且不再需要循环：

```
 private void aCheckBox_CheckedChanged(object sender, EventArgs e)
  {
      int rowIndex = (int)((CheckBox)sender).Tag;
      checkArray[rowIndex,2].Checked = !(checkArray[rowIndex,0].Checked || 
                                         checkArray[rowIndex,1].Checked);
  } 
```

您也可以使用带有复选框名称的字符串查找来执行此操作，但是如果您选择重命名复选框，它肯定会更慢并且以后重构会很痛苦。

# c++ - 如何将填充字节添加到位图中？

> ID：419045
> 
> 赞同：1
> 
> 时间：2009-01-07T02:54:11.273
> 
> 标签：c++, bitmap, visual-c++-6, padding

假设我有一些要写入文件的栅格数据。现在我想将其写为 bmp 文件。

该数据恰好不是 DWORD 对齐的，如果我理解正确，需要用足够的字节填充才能到达下一个 DWORD ..

但是，当我尝试用这段代码填充它时：

```
bmFile.Write(0x0, (4-(actualWidth%4))); 
```

我得到一个错误..如果我尝试调试（我使用的是 MSVC++ 6.0），下一条语句指向 CFile::Write 中的一个断言，它断言第一个参数为 NULL..所以这失败了..

我应该怎么垫？我应该写出：

```
bmFile.Write("0x0"(4-(actualWidth%4))); 
```

反而？还是会按字面意思对待...？

谢谢..

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-07T02:58:46.367

也许尝试：

```
bmFile.Write("\0\0\0\0", (4-(actualWidth%4))); 
```

正如您所说，您的第一个示例是尝试写入空指针指向的数据。您的第二个示例将从具有 ASCII 值 0x30、0x78、0x30 的字节“0”、“x”、“0”写入，这可能不是您想要的。

# c - 如何使用 GMP 计算 2 ^ -18？

> ID：419071
> 
> 赞同：4
> 
> 时间：2009-01-07T03:10:42.113
> 
> 标签：c, gmp

令我尴尬的是，我刚刚发现，向负指数提供负指数`mpz_pow_ui`效果不佳。（“手册确实说无符号长，你知道。”）对于其他`mpz_pow`功能，手册使用了我不理解的概念。例如下面的“ *base* ^ *exp* mod *mod* ”：

```
void mpz_powm (mpz_t rop, mpz_t base, mpz_t exp, mpz_t mod) 
void mpz_powm_ui (mpz_t rop, mpz_t base, unsigned long int exp, mpz_t mod)
Set _rop_ to _base_^_exp_ mod _mod_.
Negative exp is supported if an inverse base-1 mod mod exists (see mpz_invert in Section 5.9 [Number Theoretic Functions], page 35). If an inverse doesn’t exist then a divide by zero is raised. 
```

在以下代码中，我必须进行哪些更改才能使其能够处理负指数？

```
#define Z(x) mpz_t x; mpz_init( x );

BSTR __stdcall IBIGPOWER(BSTR p1, long p2 ) {
    USES_CONVERSION;

    Z(n1);
    Z(res);

    LPSTR sNum1 = W2A( p1 );

    mpz_set_str( n1, sNum1, 10 );

    mpz_pow_ui( res, n1, p2 );

    char * buff =  (char *) _alloca( mpz_sizeinbase( res, 10 ) + 2 );

    mpz_get_str(buff, 10, res);

    BSTR bResult = _com_util::ConvertStringToBSTR( buff );
    return bResult;
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-07T03:22:12.683

我不会为你删减代码，但我会让你知道：

`2^(-n) = ¹/[2^n]`

因此，您可以只传递正指数，然后将 1 除以该数字（并选择非整数类型，例如`mpf_t`-`mpz_t`类型是整数，因此不能表示实数，例如）。`2^(-18)`

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-07T03:28:55.667

`mpz_t`数据类型只能存储整数，2 -18^(不是)整数。要计算它，您必须使用浮点类型[`mpf_t`](http://gmplib.org/manual/Floating_002dpoint-Functions.html#Floating_002dpoint-Functions)或有理数类型[`mpq_t`](http://gmplib.org/manual/Rational-Number-Functions.html#Rational-Number-Functions)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-07T03:23:37.657

我对 GMP 了解不多，但是：

```
2 ^ -18 
```

相当于：

```
1 / (2 ^ 18) 
```

那么为什么不写一个以这种方式处理负指数的函数呢？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-08T01:45:56.903

> 如果存在逆 base-1 mod mod，则支持负 exp（参见第 5.9 节 [数论函数]，第 35 页中的 mpz_invert）。如果逆不存在，则引发除以零。

If you're talking about that, that's involves number theory. Division, or more precisely inverse of multplication, only exists on certain conditions. I don't exactly remember the rules, but basically it's saying that the division operation won't work if *base-1* mod *mod* doesn't exist.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-07T03:24:01.340

您需要做什么取决于您希望在操作中丢失的位发生什么。由于您正在处理整数，因此提高到负幂意味着除法（嗯，互惠），但 GMP 提供了几种[除法](http://gmplib.org/manual/Integer-Division.html#Integer-Division)形式。

# statistics - 比较静态类型代码和动态类型代码 - 成本和收益

> ID：419072
> 
> 赞同：0
> 
> 时间：2009-01-07T03:11:27.993
> 
> 标签：statistics, strong-typing, error-detection

不管它的优点是什么，Adobe 的 Actionscript 3 提供了一个独特的机会来探索类型化语言与非类型化语言的后果，因为它几乎是 javascript 的严格超集，具有严格类型声明的所有语法优势/开销、声明性强制转换、等等

这使得可能的是比较两种方式编写的相同代码，同时分解出基本的语言语法。

这让我想知道是否有任何量化证据表明强类型的真正好处，特别是在编译期间的错误检查方面，在错误率、编程效率和代码量方面；还是我们的观点完全基于推测和猜想？是否有任何其他可以同时使用的语言（不包括老式的 VB——无论哪种方式都不是一种备受推崇的语言。）

我已经在这两种语言上花费了大量时间，但还没有最终决定我更喜欢哪种方式，我宁愿不添加轶事证据 - 我正在寻找客观信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-07T03:42:32.893

在我看来，像 C# 这样的强类型语言可以在编译期间识别许多被忽略的错误，这些错误不会在松散类型的语言中被捕获，因此会在以后导致运行时错误。我不认为这只是一种猜测，因为严格编译可以预见到以后会在运行时导致错误的问题。这可能会消除您在实现过程中忽略的大多数编码错误，但编译器可以轻松找到并修复这些错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-07T04:27:13.677

这是编程中最伟大的宗教战争之一，也许只有一个真正的编辑器 EMACS 和撒旦 vi 的邪恶产物之间的冲突才能超越。

基本上，如果用动态语言编写的程序是正确的，那么它可以转换为静态类型语言并且仍然是正确的，反之亦然。真正静态类型语言的优势在于，在动态语言中运行时出现的错误可以在静态类型语言中在编译时识别出来。

然而，在这些情况下经常被忽视的是，静态类型语言通常具有逃逸舱口（如类型转换），并且显然动态语言可以使用类型推断来推断显然是动态表达式的类型并将其视为静态类型。

在幕后，真正重要的是程序员。如果程序员认为程序是正确的，那么它在静态或动态语言中都是正确的。我不知道有任何好的实验证据表明其中任何一个在实践中更有成效或更容易出错。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-07T04:35:27.717

静态类型的价值对我来说似乎非常有限，如果你像我一样相信，除非你有一个测试证明它是真实的，否则你不能说一个软件是真的。如果您接受并实践这一点，那么在编译时还是在测试时识别错误在很大程度上是无关紧要的。

在这一点上，我宁愿使用这两种语言中更简洁的一种，根据我的经验，这两种语言都是动态语言。

另一方面，静态类型只有在您不编写测试时才能真正帮助您。如果是这种情况，静态类型可能不足以确保您的软件正常运行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-07T04:42:35.720

OP 和 felipecsl 在谈论打字学科时对使用的术语感到困惑。

静态类型意味着在编译时检查类型（无论编译时在语言中意味着什么）。动态类型意味着在执行表达式/语句时检查类型。例如，强类型意味着您不能将指针颠覆（强制转换）为整数。弱打字与强打字相反。

据我所知，没有“严格打字”。

现在让其他人回答实际问题;-)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-07T14:29:32.847

Weak typed requires more maintenance time. As programs get more complex, more problems arise due to there not being a compiler to pick up obvious problems. Not recommended for big complex projects. I speak from experience.

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2011-09-17T12:51:31.377

统计类型的语言。将它们的变量和表达式作为固定类型，由程序员明确声明或推断。编译器。使用这个。信息，此处的类型检查将在编译时进行。虽然动态类型的 lang 的值是固定的，但变量和 xxpressions 不是固定的。由于事实是，当计算操作数时，它可能返回不同的值，然后在计算操作数后执行类型检查。即在计算之后但在运行时执行操作之前

# c# - 检测编码转换问题

> ID：419082
> 
> 赞同：0
> 
> 时间：2009-01-07T03:21:28.690
> 
> 标签：c#, encoding, utf-8, windows-1252

我公司网站上的大部分内容都以 Word 文档（Windows-1252 编码）开始，最终被复制并粘贴到我们的 UTF-8 编码内容管理系统中。转换通常会阻塞一些必须手动清理的字符（特殊中断字符、智能引号、科学记数法），但当然有一些总是会漏掉。

你认为最好的方法是检测这些？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-29T22:53:44.617

你究竟是如何进行转换的？

整个从 Word 复制的问题是我经常遇到的问题，但它应该真的很容易解决。

您提到的那些字符都在Windows `0x80`- [1252 代码页与 ISO-8859-1 代码页不同的](http://en.wikipedia.org/wiki/Windows-1252)`0x9F`范围内。该范围在 ISO-8859-1 中未定义。

您必须从 ISO-8859-1（或者可能是 ISO-8859-15）而不是 Windows-1252 进行转换，导致它在该范围内的字符上阻塞。

您应该调整转换的源编码，或者，如果这不可能（我不熟悉 C#，但我对此表示怀疑），请使用代码页图表来修复与主转换分开的 32 个问题字符。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-07T03:55:20.043

您可以将文本保存为 .rtf，然后使用其他程序对其进行解析吗？

您可以使用 Word 的 VBA 将文本保存为理智的东西吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-07T04:07:36.307

如前所述，最好将 Word 内容导出为可解析的格式（RTF 或 XML 都可以）。

使用复制和粘贴将材料添加到您的 CMS 可能有一个特定的原因，但是通过复制和粘贴，除非您创建一个监视剪贴板的工具，否则您可能总是会以某种视觉检查和修复回合结束。

从 Word（最新版本）复制和粘贴时，剪贴板有几种不同的格式可供使用，其中一种格式是基于 XML 的。可以创建一些内容来清理剪贴板上的 Word XML，并将文本版本（您可能粘贴到 CMS）“设置”为清理后的格式。

您可以使用 Office 附带的 Word.interop 和标准 C# 剪贴板功能来创建它。该工具可以在 Word 的顶部（在后台）工作，同时将内容添加到 CMS。

# eclipse - 在tomcat服务器上调试时如何修复eclipse旋转CPU

> ID：419085
> 
> 赞同：2
> 
> 时间：2009-01-07T03:22:58.610
> 
> 标签：eclipse, cpu

我知道 stackoverflow 是用来解决编程问题的，但这正是你在谷歌上搜索的那种东西，而其他人问同样的问题却没有答案，这正是我读到 stackoverflow 的那种东西。

我运行 ganymede 我正在 Windows 上的 tomcat 中调试一个 servlet。当我逐行跟踪时，CPU 突然出现峰值。windows进程状态说它是eclipse。另一个奇怪的证据是角落里的堆大小报告（如果你打开了垃圾收集按钮，就在旁边）每秒都在上下变化。我给了它 256 兆，它在 155、169、159、164 之间弹跳……它只是不断地上下变化。但是我的进度视图窗格中没有任何事情发生。我试着给它 512 megs 没有帮助（机器中的 2 gig）

知道如何让 eclipse 告诉我它对我所有的 cpu 做了什么吗？它使调试器无响应并且没有任何作用。我的 step 命令出现超时错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-07T07:06:12.670

您可以使用附加的[jconsole](https://stackoverflow.com/questions/100161#101164)启动 eclipse ，前提是您将[eclipse.ini 设置](https://stackoverflow.com/questions/142357)中

```
-Dcom.sun.management.jmxremote 
```

选项。

然后，您将能够在会话期间跟踪/记录任何线程/内存/对象的使用情况，收集更多关于正在发生的事情的线索。

# javascript - Packed/minified javascript failing in IE6 - how to debug?

> ID：419094
> 
> 赞同：0
> 
> 时间：2009-01-07T03:27:01.643
> 
> 标签：javascript, debugging, internet-explorer-6, minify

I have a number of files which I combine and pack to produce a single, minified JS file. The problem is that when I minify the file (using [packer](http://dean.edwards.name/packer/)), IE6 gives one of its characteristic helpful error messages.

```
Line: 12      // of course, line 12 is an empty line
Char: 1
Error: Expected ')'
Code: 0 
```

The thing is: it works fine in IE7, Firefox and Chrome the problem only comes up for IE6.

Unpacked, I have almost 200kb of scripts spread through 8 files. How on earth do I fix this?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-07T03:33:06.173

Microsoft have their way of doing it:

[http://blogs.msdn.com/ie/archive/2004/10/26/247912.aspx](http://blogs.msdn.com/ie/archive/2004/10/26/247912.aspx)

[http://www.jonathanboutelle.com/mt/archives/2006/01/howto_debug_jav.html](http://www.jonathanboutelle.com/mt/archives/2006/01/howto_debug_jav.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-01-21T17:17:09.523

您是否已经验证过未缩小的代码可以在 IE6 中成功运行？如果是这样，因为这是一个语法错误而不是运行时错误，我要采取的下一步是开始将 javascript 减半，缩小它，并查看何时停止报告问题。然后从那里继续二进制搜索。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-07T05:01:35.323

就像 CMS 所说，[YUI 压缩器](http://developer.yahoo.com/yui/compressor/)是压缩和混淆代码的好工具，试试吧。

我在我的 javascript 文件中使用以下代码。我在 OSX 上运行，但命令在 Linux 上应该相同，也可能在 Windows 上相同（尽管我从未尝试过）。

```
java -jar /path/to/yuicompressor-2.4.jar --charset utf8 -o ~/path/to/scriptname.min.js ~/path/to/scriptname.js 
```

其中**~/path/to/**是您的 javascript 文件所在的路径，**scriptname.min.js**是最小化/混淆的最终结果的名称，而**scriptname.js**是原始文件。

我假设您不能只是“忘记”IE6？我的新年愿望之一是互联网上最后 23% 的 IE6 用户*最终*升级到更体面/最新的浏览器:-)。

希望这可以帮助！

-戴夫

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-07T05:13:01.713

这是ie6很常见的问题，你要注意代码中的闭包，

条件语句必须带有 { - } ... 和函数。

```
if(){
}

function(){
}; 
```

你必须把; 在每个语句的末尾，如果没有，这些行将合并为浏览器无法理解的内容。

我使用[jslint.com](http://jslint.com)进行 javascript 调试。在错误列表中查找“缺少的分号”。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-01-22T02:09:45.847

从记忆中，我认为我最终解决这个问题的方式，以及我现在解决缩小代码问题的方式，是通过[JSLint](http://jslint.com)运行它。其非凡的严格性将发现不会在非缩小代码上引起问题的问题（例如缺少分号）。您将不得不费力地阅读大量并非真正的错误消息，但问题就在某个地方！

# c# - gridview in asp.net VS2008

> ID：419095
> 
> 赞同：0
> 
> 时间：2009-01-07T03:27:05.717
> 
> 标签：c#, asp.net

Have a gridview control and i want to display checkboxes for each row. The checkboxes should only appear if Session["DisplayBox"] == true.

```
<asp:GridView ID="gridView" runat="server" AutoGenerateColumns="False" EnableSortingAndPagingCallbacks="True"
    AllowPaging="True" DataSourceID="JObjectDataSource" PageSize="5" OnRowCommand="gridView_RowCommand"
    DataKeyNames="ID" Width="100%">
    <Columns>
        <asp:TemplateField HeaderText="Review">
            <ItemTemplate>
                <asp:CheckBox  ID="chkRejectFile" AutoPostBack="true" runat="server" OnCheckedChanged="chkRejectFile_CheckedChanged" />
            </ItemTemplate>
        </asp:TemplateField>
    </Columns> 
```

I removed some of the columns and kept the one that i am asking the question about. How would I place a conditional code in the aspx page and check for the session value?

Also, if I page, do i have to explicitly handle keeping track of which row was checked and which wasn't?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-07T04:12:21.757

Add a callback handler for the OnDataBind event of the GridView. Then on each row, determine whether or not to show the checkbox.

The code will of course be in your *.cs* file.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-07T04:13:57.493

Add a new event property to the grid like this one:

```
OnRowDataBound="gridView_RowDataBound" 
```

And then, in the code-behind, add the following corresponding event handler:

```
protected void gridView_RowDataBound(object sender, GridViewRowEventArgs e)
{
  if(e.Row.RowType == DataControlRowType.DataRow)
  {
    // check for null first
    object displayBoxFlag = Session["DisplayBox"];
    if(displayBoxFlag!=null && (bool) displayBoxFlag)
    {
      e.Row.FindControl("chkRejectFile").Visible = true;
    }
    else
    {
      e.Row.FindControl("chkRejectFile").Visible = false;
    }
  }
} 
```

Plenty of room to optimize, but it should work.

What happens is that ASP.NET will raise this event and call the method for each row of the grid right after they are bound. You now may go ahead and override or customize the way they appear.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-07T04:10:11.790

You want to set the Visible property based on the value of the session variable. Add something like the following (untested) code to your control:

```
 Visible='<%# Convert.ToBoolean(HttpContext.Current.Session["DisplayBox"]) %>' 
```

Note that this doesn't check if the session variable is actually defined, i.e., it depends on it being set and set to either `true` or `false`.

If you do paging and care about retaining checked status, you'll need to keep track of the checked status for each item explicitly. The only thing that will get posted back on submit are the controls that are actually on the page at the time of the submit.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-07T04:13:27.790

You could override the "OnRowDataBound" event in the code behind, and for each row, perform your logic and set the visisble property accordingly.

# c++ - 轻量级 Windows 应用程序的最佳开源示例是什么？

> ID：419096
> 
> 赞同：8
> 
> 时间：2009-01-07T03:27:43.500
> 
> 标签：c++, c, windows, open-source

我想了解如何在不使用 .net 框架的情况下编写和安装程序。我正在寻找一个以轻量级和健壮着称的项目。类似于 uTorrent 客户端。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-07T03:55:11.307

试试[Anki](http://ichi2.net/anki/)，一种间隔学习工具。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-07T03:29:36.210

[chromium是](http://code.google.com/chromium/)[Google Chrome](http://www.google.com/chrome)背后的开源项目，它充满了干净、健壮（并且经过单元测试）的代码。如果您选择潜水，请将[地图](http://dev.chromium.org/developers/how-tos/getting-around-the-chrome-source-code)放在手边。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-07T03:39:58.297

[Notepad++](http://notepad-plus.sourceforge.net/uk/site.htm)似乎是一个不错的轻量级 C++ Win32 程序，您可以查看一下。许多功能，包括插件系统。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-07T06:07:58.683

只需使用 Win32 非托管代码、C 或 C++

没有其他的 ！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-03T18:14:26.283

查看 Charles Petzold 的[Programming Windows](https://rads.stackoverflow.com/amzn/click/com/157231995X)。它是对基本 Win32 API 的介绍，它可以让您在 Windows 中做几乎任何您想做的事情，而无需任何额外的外部依赖。它本身不是一个开源应用程序，但它确实包含许多完整的示例应用程序。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-03T18:04:55.430

为此，我在几年前创建了一个非常小的示例 C++ [Windows 应用程序示例。](http://networkdls.com/Software.Asp?Review=24)我一点也不健壮，但它写得很干净，没有绒毛。因此，如果您正在寻找一个真正全新的开始……请查看。

# objective-c - 如何在按钮 onclick 事件中使用“takeStringValueFrom”？

> ID：419104
> 
> 赞同：1
> 
> 时间：2009-01-07T03:31:34.117
> 
> 标签：objective-c, cocoa, macos

我有一个正确连接的按钮，当单击它时，会点击“登录”IBAction。

```
- (IBAction) login: (id)sender
{
    NSLog(@"OK");
} 
```

现在，我使用“takeStringValueFrom”将按钮连接到用户名/密码文本字段，但我不明白如何获取这些值？

希望这是有道理的。

编辑：基本上，当我单击“登录”按钮时，上述事件会触发。我想从同一个窗口的两个文本框中获取值，完成此操作的最佳方法是什么？我想我可以为每个文本框使用 IBOutlet ...这是正确的方法吗？

重新阅读[文档](http://developer.apple.com/library/mac/#documentation/Cocoa/Reference/ApplicationKit/Classes/NSControl_Class/Reference/Reference.html#//apple_ref/occ/instm/NSControl/takeStringValueFrom:)，“takeStringValueFrom”可能不是我想的那样。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-07T03:52:08.567

您想将您的用户名和密码文本字段声明为`IBOutlet`s，然后将它们连接到 Interface Builder。然后，在您的`login`处理程序中，您使用`stringValue`消息来提取它们的值：

```
- (IBAction) login: (id)sender
{
    NSString *username = [usernameTextField stringValue];
    NSString *password = [passwordTextField stringValue];

    // check username & password
} 
```

# xcode - 问题设置 QMAKESPEC 环境变量

> ID：419117
> 
> 赞同：2
> 
> 时间：2009-01-07T03:40:51.103
> 
> 标签：xcode, qmake

请参阅这篇文章在命令行中编译 Xcode 项目 从命令行 [构建 Qt Xcode 项目](https://stackoverflow.com/questions/377992/building-xcode-projects-from-the-command-line) QMAKESPEC 变量无法设置为 macx-g++。

我在终端中这样做，`QMAKESPEC=macx-g++`但这仍然无法为我生成我的 Xcode 项目的 make 文件。

设置 QMAKESPEC 环境变量的正确方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-07T04:48:07.003

您忘记导出该变量。

在 bash 下：

```
export QMAKESPEC=macx-g++ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-07T06:02:31.270

是的，我做到了，导出 QMAKESPEC=macx-g++ 当我写命令 $QMAKESPEC 它返回结果 mac-g++ command not found

# ios - Launch an app from within another (iPhone)

> ID：419119
> 
> 赞同：177
> 
> 时间：2009-01-07T03:41:47.760
> 
> 标签：ios, iphone, cocoa-touch, deep-linking, openurl

Is it possible to launch any arbitrary iPhone application from within another app?, **For example** *in my application if I want the user to push a button and launch right into the Phone app (close the current app, open the Phone app)*.

would this be possible? I know this can be done for making phone calls with the tel URL link, but I want to instead just have the Phone app launch without dialing any specific number.

* * *

## 回答 #1

> 赞同：82
> 
> 时间：2009-01-07T05:35:38.453

正如 Kevin 所指出的，URL 方案是应用程序之间通信的唯一方式。所以，不，不可能启动任意应用程序。

但是可以启动任何注册 URL Scheme 的应用程序，无论是 Apple 的、您的或其他开发人员的。文档在这里：

[为您的应用定义自定义 URL 方案](https://developer.apple.com/documentation/xcode/allowing_apps_and_websites_to_link_to_your_content/defining_a_custom_url_scheme_for_your_app)

至于启动手机，看起来您的`tel:`链接至少需要三位数才能启动手机。因此，您不能不拨打号码就直接进入应用程序。

* * *

## 回答 #2

> 赞同：79
> 
> 时间：2014-06-04T09:31:42.033

我发现编写一个可以打开另一个应用程序的应用程序很容易。

假设我们有两个名为`FirstApp`和的应用程序`SecondApp`。当我们打开 FirstApp 时，我们希望能够通过单击按钮打开 SecondApp。这样做的解决方案是：

1.  在 SecondApp

    进入SecondApp的plist文件，你需要添加一个带有字符串**iOSDevTips的****URL Schemes**（当然你可以写另一个字符串，这取决于你）。

 **![在此处输入图像描述](https://i.stack.imgur.com/DWTsi.png)

2\. 在 FirstApp 中

使用以下操作创建一个按钮：

```
- (void)buttonPressed:(UIButton *)button
{
  NSString *customURL = @"iOSDevTips://";

  if ([[UIApplication sharedApplication] canOpenURL:[NSURL URLWithString:customURL]])
  {
    [[UIApplication sharedApplication] openURL:[NSURL URLWithString:customURL]];
  }
  else
  {
    UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"URL error"
                              message:[NSString stringWithFormat:@"No custom URL defined for %@", customURL]
                              delegate:self cancelButtonTitle:@"Ok" 
                              otherButtonTitles:nil];
    [alert show];
  }

} 
```

而已。现在，当您可以单击 FirstApp 中的按钮时，它应该会打开 SecondApp。

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2015-11-17T17:35:31.283

对于 8 之前的 iOS，lee 的答案是绝对正确的。

在 iOS 9+ 中，您必须在 LSApplicationQueriesSchemes 键（字符串数组）下的 Info.plist 中将您的应用想要查询的任何 URL 方案列入白名单：

[![在此处输入图像描述](https://i.stack.imgur.com/txMUq.png)](https://i.stack.imgur.com/txMUq.png)

* * *

## 回答 #4

> 赞同：23
> 
> 时间：2016-01-19T13:30:50.017

**在斯威夫特**

以防万一有人正在寻找快速的 Swift 复制和粘贴。

```
if let url = URL(string: "app://"), UIApplication.shared.canOpenURL(url) {
            UIApplication.shared.open(url, options: [:], completionHandler: nil)
        } else if let itunesUrl = URL(string: appLink), UIApplication.shared.canOpenURL(itunesUrl) {
            UIApplication.shared.open(itunesUrl, options: [:], completionHandler: nil)
        } 
```

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2017-05-25T08:07:13.457

为了让您从另一个应用程序打开您的应用程序，您需要在两个应用程序中进行更改。以下是使用带有**iOS 10**更新的**Swift 3的步骤：**

 ****1.注册您要打开的应用程序**

`Info.plist`通过定义应用程序的自定义和唯一 URL 方案来更新。

[![在此处输入图像描述](https://i.stack.imgur.com/OJM5v.png)](https://i.stack.imgur.com/OJM5v.png)

*请注意，您的方案名称应该是唯一的，否则如果您的设备上安装了具有相同 URL 方案名称的另一个应用程序，那么这将取决于运行时打开哪个应用程序。*

**2\. 在您的主应用程序中包含之前的 URL 方案**

您需要指定您希望应用程序能够与类的`canOpenURL:`方法一起使用的 URL 方案`UIApplication`。因此，打开主应用程序`Info.plist`并将其他应用程序的 URL 方案添加到`LSApplicationQueriesSchemes`. *（在 iOS 9.0 中引入）*

[![在此处输入图像描述](https://i.stack.imgur.com/ducnT.png)](https://i.stack.imgur.com/ducnT.png)

**3\. 实现打开应用程序的操作**

现在一切都设置好了，所以您可以在打开其他应用程序的主应用程序中编写代码。这应该看起来像这样：

```
let appURLScheme = "MyAppToOpen://"

guard let appURL = URL(string: appURLScheme) else {
    return
}

if UIApplication.shared.canOpenURL(appURL) {

    if #available(iOS 10.0, *) {
        UIApplication.shared.open(appURL)
    }
    else {
        UIApplication.shared.openURL(appURL)
    }
}
else {
    // Here you can handle the case when your other application cannot be opened for any reason.
} 
```

*请注意，如果您希望现有应用（从 AppStore 安装）打开，这些更改需要新版本。如果要打开已发布到 Apple AppStore 的应用程序，则需要先上传包含 URL 方案注册的新版本。*

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2011-12-26T11:04:24.817

这是从另一个应用程序中启动应用程序的一个很好的教程：
[iOS SDK：使用 URL Schemes](http://mobile.tutsplus.com/tutorials/iphone/ios-sdk-working-with-url-schemes/)
而且，不能启动任意应用程序，但可以启动注册了[URL Schemes](http://developer.apple.com/library/ios/documentation/iPhone/Conceptual/iPhoneOSProgrammingGuide/AdvancedAppTricks/AdvancedAppTricks.html#//apple_ref/doc/uid/TP40007072-CH7-SW50)的本机应用程序。

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2017-07-19T11:09:11.890

为此，我们需要在两个 App 中添加几行代码

**应用 A：**您想从另一个应用打开的应用。**（资源）**

**App B** : 从 App B 你想打开**App A** **(Destination)**

**应用程序 A 的**代码

 **在 App A的 Plist 中添加几个标签打开**App A 的** Plist Source 和 XML 下面的 Past

```
<key>CFBundleURLTypes</key>
<array>
    <dict>
        <key>CFBundleURLName</key>
        <string>com.TestApp</string>
        <key>CFBundleURLSchemes</key>
        <array>
            <string>testApp.linking</string>
        </array>
    </dict>
</array> 
```

在 App **A**的 App 代表中- 在此处获取回调

```
- (BOOL)application:(UIApplication *)application openURL:(NSURL *)url
  sourceApplication:(NSString *)sourceApplication annotation:(id)annotation
{
// You we get the call back here when App B will try to Open 
// sourceApplication will have the bundle ID of the App B
// [url query] will provide you the whole URL 
// [url query] with the help of this you can also pass the value from App B and get that value here 
} 
```

现在来到**App B 代码**-

如果你只是想在没有任何输入参数的情况下打开 App A

```
-(IBAction)openApp_A:(id)sender{

    if(![[UIApplication sharedApplication] openURL:[NSURL URLWithString:@"testApp.linking://?"]]){
         UIAlertView *alert = [[UIAlertView alloc]initWithTitle:@"App is not available!" message:nil delegate:self cancelButtonTitle:@"Ok" otherButtonTitles:nil, nil];
            [alert show];

        }
} 
```

如果您想将参数从**App B**传递给**App A** ，请使用以下代码

```
-(IBAction)openApp_A:(id)sender{
    if(![[UIApplication sharedApplication] openURL:[NSURL URLWithString:@"testApp.linking://?userName=abe&registered=1&Password=123abc"]]){
         UIAlertView *alert = [[UIAlertView alloc]initWithTitle:@"App is not available!" message:nil delegate:self cancelButtonTitle:@"Ok" otherButtonTitles:nil, nil];
            [alert show];

        }
} 
```

注意：您也可以通过键入**testApp.linking://?** 在 Safari 浏览器上

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2014-09-04T13:54:52.447

尝试以下代码将帮助您从应用程序启动应用程序

注意：将名称幻想替换为实际的应用程序名称

```
NSString *mystr=[[NSString alloc] initWithFormat:@"fantacy://location?id=1"];
NSURL *myurl=[[NSURL alloc] initWithString:mystr];
[[UIApplication sharedApplication] openURL:myurl]; 
```

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2009-01-07T11:43:10.987

您只能启动已注册 URL 方案的应用程序。然后就像您使用 sms: 打开 SMS 应用程序一样，您将能够使用其 URL 方案打开该应用程序。

在名为 LaunchMe 的文档中有一个非常好的示例，它演示了这一点。

[截至 2017 年 11 月 6 日的LaunchMe 示例代码](https://developer.apple.com/library/content/samplecode/LaunchMe/Introduction/Intro.html#//apple_ref/doc/uid/DTS40007417)。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2009-01-07T04:59:54.420

不，这不对。除了记录在案的 URL 处理程序之外，没有办法与/启动另一个应用程序进行通信。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2018-07-19T08:04:28.057

在 Swift 4.1 和 Xcode 9.4.1

我有两个应用程序 1）PageViewControllerExample 和 2）DelegateExample。现在我想用 PageViewControllerExample 应用打开 DelegateExample 应用。当我单击 PageViewControllerExample 中的打开按钮时，将打开 DelegateExample 应用程序。

为此，我们需要对两个应用程序的 .plist 文件进行一些更改。

**步骤1**

在 DelegateExample 应用程序中打开 .plist 文件并添加 URL 类型和 URL 方案。在这里，我们需要添加我们所需的名称，例如“myapp”。

[![在此处输入图像描述](https://i.stack.imgur.com/gSwM7.png)](https://i.stack.imgur.com/gSwM7.png)

**第2步**

在 PageViewControllerExample 应用程序中打开 .plist 文件并添加此代码

```
<key>LSApplicationQueriesSchemes</key>
<array>
    <string>myapp</string>
</array> 
```

现在，当我们单击 PageViewControllerExample 中的按钮时，我们可以打开 DelegateExample 应用程序。

```
//In PageViewControllerExample create IBAction
@IBAction func openapp(_ sender: UIButton) {

    let customURL = URL(string: "myapp://")
    if UIApplication.shared.canOpenURL(customURL!) {

        //let systemVersion = UIDevice.current.systemVersion//Get OS version
        //if Double(systemVersion)! >= 10.0 {//10 or above versions
            //print(systemVersion)
            //UIApplication.shared.open(customURL!, options: [:], completionHandler: nil)
        //} else {
            //UIApplication.shared.openURL(customURL!)
        //}

        //OR

        if #available(iOS 10.0, *) {
            UIApplication.shared.open(customURL!, options: [:], completionHandler: nil)
        } else {
            UIApplication.shared.openURL(customURL!)
        }
    } else {
         //Print alert here
    }
} 
```

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2011-12-26T22:03:43.500

不久前我也尝试过（[使用标识符启动 iPhone 应用程序](https://stackoverflow.com/questions/7374540/launch-iphone-application-with-identifier)），但绝对没有文档化的方法可以做到这一点。:)

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2019-07-01T14:28:24.860

关于这个主题的旁注......

未注册的协议有 50 个请求限制。

[在这个讨论](https://developer.apple.com/documentation/uikit/uiapplication/1622952-canopenurl#discussion)中，苹果提到对于特定版本的应用程序，您只能查询`canOpenUrl`有限的次数，并且**在 50 次未声明的方案调用后将失败**。我还看到，如果在您进入此失败状态后添加协议，它仍然会失败。

请注意这一点，可能对某人有用。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2017-05-03T12:34:57.327

@villy393 的 Swift 3 快速粘贴版答案：

```
if UIApplication.shared.canOpenURL(openURL) {
    UIApplication.shared.openURL(openURL)
} else if UIApplication.shared.canOpenURL(installUrl) 
    UIApplication.shared.openURL(installUrl)
} 
```

# c# - 记录用户登录以报告客户端超出许可数量

> ID：419122
> 
> 赞同：2
> 
> 时间：2009-01-07T03:44:08.083
> 
> 标签：c#, sql

我是商业 Windows 应用程序 (c#) 的首席开发人员。一项新要求是跟踪滥用许可证的客户。

例如：假设客户购买了 10 个用户的许可协议，即在任何给定时间同时有 10 个用户。

我需要能够报告，回顾历史，客户有超过 10 个用户同时登录的所有时间。

我已经有一个包含列的用户表：userid（主键）、pw、lastLogin、lastLogout。

我正在考虑创建一个新的“日志记录”表，每次用户注销时都会在其中添加一个新行......列可能包括：

LogId、UserId、LoginDateTime、LogoutDateTime

...然后我会记录每次用户登录/退出应用程序的历史...

但我不确定此表设计是否有助于有效计算报告...我使用 SQL 还是 c# 来执行计算对我来说并不重要，只要它相当快...

希望有人对如何更好地设计此表有一个好主意，以便我可以快速计算客户超过许可限制时的任何/所有时间点。

注意：我不想阻止 11t、12th 等用户使用该应用程序...要求是向用户显示警告消息但允许他继续工作...

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-07T04:14:54.247

将开始和结束会话视为需要记录的事件。您创建一个表来记录这些事件。

因此，开始和结束的会话将在表中有两个条目 - 一个用于会话开始，一个用于会话结束。您只需将记录添加到表中，从不修改以前的记录。该表现在可以非常简单地跟踪打开的会话数，方法是向记录添加一个“会话计数”字段，当会话开始事件发生时，该字段从先前记录的会话计数值增加，当会话结束事件发生时减少。

“会话计数”列现在为我们提供了随着时间的推移并发会话数的分段连续函数。

示例数据：

```
 SessionId  EventType  .... your session data here ... SessionCount   
1\.     1         Login         ................                 1
2\.     2         Login         ................                 2
3\.     3         Login         ................                 3
4\.     1         Logout        ................                 2
5\.     4         Login         ................                 3
6\.     4         Logout        ................                 2
7\.     2         Logout        ................                 1
8\.     3         Logout        ................                 0
9\.     5         Login         ................                 1
10\.    6         Login         ................                 2 
```

需要担心的事情：

1.  您必须确保配对开始/结束事件，因此在发生任何故障时，仍必须生成会话结束事件。
2.  你需要桌子是防篡改的吗？如果是这样，我也有一个技术。

编辑：请注意，我将“您的会话数据放在这里”的地方，我的意思是“您的会话事件数据”。时间戳等信息将输入此处。应该使用另一个表来跟踪两个事件共有的会话信息，例如拥有会话的用户的身份（对两个表使用相同的 SessionId 键）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-07T03:58:35.107

另一种选择是创建用户会话表。当用户登录时，将他们的会话插入到表中。当他们注销时，将其删除。这样，您始终可以轻松了解有多少用户已连接。

然后，您可以在插入（也可能是删除）时创建触发器，然后您可以根据会话计数从那里登录。如果您也记录删除，您就会知道他们使用过多用户的时间长度。

另请记住，您必须适当地清理孤立的连接。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-07T05:05:29.497

我推荐一个电话回家功能，比如提醒你或通过网络方法登录，这样你就可以跟踪谁在做什么......但只有当他们超过他们的限制时。（研究 WCF 的几种方法）

这样您就可以跟踪它们的使用情况。通过真实数据向他们收取额外费用或重新谈判他们的合同变得有意义。如果您擅长客户服务，那么这不应该激怒他们，特别是如果您指出您需要一个基础设施来为庞大的用户群提供服务。大概你也让他们很清楚你的许可计划......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-07T10:47:15.937

我会谨慎地以这种方式实施许可证检查，因为（如[Daniel 的回答](https://stackoverflow.com/questions/419122/logging-user-logins-for-the-purpose-of-reporting-that-the-client-is-exceeding-num#419176)中所述，如果您的应用程序崩溃，或者即使用户以特定方式退出它，您也不会收到注销事件（End Process from任务管理器，ALT+F4，而不是通过文件 | 退出等）。

因此，当用户使用该应用程序时，您可能会遇到越来越多的无效会话。不仅您可能会获得有关用户的错误数据和印象，而且更重要的是，他们会因收到不应有的警告消息而感到沮丧。如果你试图告诉他们他们违反了许可证，而他们实际上并没有，他们可能会变得非常冒犯。失去客户的好方法。

我想说一个合理的许可证检查方案需要客户控制之外的中央服务器，并且客户可以访问互联网。它可能是这样的：

1.  在启动应用程序时，程序通知许可证服务器一个新的会话；
2.  在应用程序工作期间，程序会定期（比如说 1x 5 分钟左右）向许可证服务器发送状态信号；
3.  正常退出程序时，向许可证服务器发送会话结束信号；
4.  如果在 10 分钟内没有从程序接收到状态信号，则无论如何都认为会话被许可服务器终止。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-08T00:55:46.613

注意：这是以前处理过的问题。我见过的最佳选择是由未登录的用户（在本例中为深度 10）维护用户活动的 MRU 堆栈，并从数据库事务活动中派生 - SELECT TOP 10 DISTINCT usercode FROM atable WHERE（最近的事务类型是't "注销") 按时间戳 DESC 排序。一旦有人访问不属于最近 10 个系统的系统，您就有两种选择。您允许他们登录，并将最旧的状态更改为注销状态（这会造成麻烦，但让他们继续工作）；或者你让他们等到前 10 名之一明确注销。有时用户可以做出选择。有时它需要管理员。但这是政策上的区别。

Then you bill them for every time they log in (using the first scheme) or you just enforce the limit (with the second scheme).

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-01-07T03:56:39.433

具有 (LogId, UserId, LoginDateTime, LogoutDateTime) 的表结构的问题在于它变得难以聚合 - 查询查看每个人在指定时间使用系统很容易，但始终获取用户数量却很困难.

一种可能的方法是对数据进行一些非规范化 - 并记录使用单位，而不是跨度。您可以使用表结构（UserId、BlockDateTime）在 30 分钟内跟踪使用情况。

如果 BettyR 从上午 10:05 到上午 11:45 使用系统，请在您的表中创建四个记录：

```
BettyR, 10:00am
BettyR, 10:30am
BettyR, 11:00am
BettyR, 11:30am 
```

然后，您可以使用带有 group by 子句的普通 SQL 查询来查找在每半小时内使用系统的不同用户的数量。

```
select ...
from UsageBlocks
group by BlockDateTime
having count(*) > 10 
```

根据您的要求，您可以使用报告应用程序对这些特定时间段进行更深入的分析。

# asp.net-membership - 如何最好地在会员提供者上实施自定义搜索

> ID：419127
> 
> 赞同：8
> 
> 时间：2009-01-07T03:46:53.010
> 
> 标签：asp.net-membership

开箱即用，System.Web.Security.Membership 实现了几个搜索方法：

*   通过电子邮件查找用户
*   按名称查找用户

我正在使用[CodePlex 的 WSAT 项目](http://www.codeplex.com/AspNetWSAT)来管理我的会员数据库。该工具在 ProfileCommon 类中实现了额外的配置文件属性。

假设我在用户的个人资料中有一个名为**Firm的属性。**

我需要实现一个自定义搜索方法来搜索公司属性，我想在代码中完成这一切。不想编写存储过程（因为所有配置文件属性都存储在 WSAT 工具的 1 个数据库列中）。

这样的事情显然不是正确的方法，但这里只是为了演示访问用户的配置文件属性：

```
 private MembershipUserCollection SearchByFirm(string firmName, MembershipUserCollection allRegisteredUsers)
{
    MembershipUserCollection searchResults = new MembershipUserCollection();

    foreach (MembershipUser user in allRegisteredUsers)
    {
        ProfileCommon profile = Profile.GetProfile(user.UserName);
        if (profile.Firm.ToLowerInvariant().Contains(firmName.ToLowerInvariant()))
        {
            searchResults.Add(user);
        }
    }
    return searchResults;
} 
```

我可以把它变成一些 LINQ 的优点吗？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-04-23T09:36:06.283

那么你不能直接投吗？

```
IEnumerable<MembershipUser> searchResults = Membership.GetAllUsers().Cast<MembershipUser>(); 
```

希望这对你们有帮助

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-07T22:24:16.543

从一个擅长linq的同事那里得到了一些帮助。这里的挑战是 MembershipUserCollection 没有实现 IEnumerable< T > (!)。

```
 List<MembershipUser> searchResults = allUsers.Where(user => 
        Profile.GetProfile(user.UserName).Firm.ToLowerInvariant()
        .Contains(firmName.ToLowerInvariant())).ToList(); 
```

在这种情况下 allUsers 是一个列表，我必须用 Membership.GetAllUsers() 集合中的项目填充它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-10-22T17:04:49.103

只是为了记录，我创建了这个扩展方法，我认为它有点工作：

```
namespace WebDibaelsaMVC.Utils.MembershipUserCollectionExtensions
{
    public static class MembershipUserCollectionExtensions
    {
        public static IEnumerable<MembershipUser> Where(this MembershipUserCollection userCollection,Func<MembershipUser,bool> func)
        {
            foreach (MembershipUser membershipUser in userCollection)
            {
                 if (func(membershipUser))
                    yield return membershipUser;
            }
        }
    }
} 
```

它还将 转换为`MembershipUserCollection`，`IEnumerable<MembershipUser>`以便所有其他 LINQ 方法在之后工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-27T13:00:22.370

微软没有提供内置功能。这是具有用户名和电子邮件地址的搜索会员用户
**示例：**
**只需复制下面的功能并实现它 - 完成...**

```
Public List<MembershipUser> SearchMembershipUser(string strUserName, String strEmail)
        {           
            IEnumerable<MembershipUser> MUser;
            if ((!string.IsNullOrEmpty(strUserName) || !string.IsNullOrEmpty(strEmail)))
            {
                if (!string.IsNullOrEmpty(strUserName) && !string.IsNullOrEmpty(strEmail))
                {
                    MUser = Membership.GetAllUsers().Cast<MembershipUser>()
                        .Where(x => x.UserName != CurrentUser && x.UserName == strUserName && x.Email == strEmail);
                }
                else if (!string.IsNullOrEmpty(strUserName))
                {
                    MUser = Membership.GetAllUsers().Cast<MembershipUser>()
                        .Where(x => x.UserName != CurrentUser && x.UserName == strUserName);
                }
                else
                {
                    MUser = Membership.GetAllUsers().Cast<MembershipUser>()
                        .Where(x => x.UserName != CurrentUser && x.Email == strEmail);
                }
            }
            else
            {
                MUser = Membership.GetAllUsers().Cast<MembershipUser>().Where(x => x.UserName != CurrentUser);
            }
            return MUser.OrderBy(x => x.UserName).ToList();
        } 
```

# wpf - 在 UserControl 中公开 ImageSource 属性以在 Blend 中使用

> ID：419128
> 
> 赞同：0
> 
> 时间：2009-01-07T03:47:34.707
> 
> 标签：wpf, user-controls, expression-blend, dependency-properties

我有一个用户控件，它公开了 ImageSource 类型的属性。我想在 Blend 中公开这个属性，以便我可以在 Blend 中编辑它，而不是在代码中指定图像。

根据我在 Google 上搜索到的内容，我添加了一个依赖属性，并指定了适当的属性以在 Blend 中公开该属性。

我可以在那里看到它，并对其进行编辑（作为文本字段）。我想要做的是有一个可用图像资源的下拉列表，以及一个用于加载另一个图像的浏览按钮。换句话说，我希望它表现得像“图像”控件的“源”属性。

*编辑*顺便说一句，我注意到公开 Alignment 或 Margin 属性的行为符合预期，它似乎只是图像不起作用。我真的坚持这个，希望能得到帮助！

我当前的代码如下所示：

```
public static readonly DependencyProperty ImageSourceProperty =
        DependencyProperty.Register("ImageSource", typeof(ImageSource), typeof(SmartButton));

[Category("Appearance")]
[Bindable(true)]
[DesignerSerializationVisibility(DesignerSerializationVisibility.Hidden)]
public ImageSource ImageSource
{
    get { return (ImageSource)GetValue(ImageSourceProperty); }
    set
    {
        SetValue(ImageSourceProperty, value);
        this.BackgroundImage.Source = value;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-01-06T23:33:43.347

我几乎一直在研究这个问题（减去 Blend，加上在 XAML 的 ControlTemplate 中使用该属性。）

就我而言，我通过更改`ImageSource`为`BitmapSource`. ImageSource 是抽象的，BitmapSource 扩展了 ImageSource。

但是，对此感觉有些不对劲。Image.Source 的类型是 ImageSource。无论它是否抽象，似乎我应该能够使用 ImageSource 类型的 DependencyProperty。

因此，对于我自己的情况，我已经开始使用它，`BitmapSource`但我仍在调查中。

编辑：希望你不介意在你问了差不多一年后得到答案，+/- 12 小时。;)

EDIT2：乔治，我也确实让这个为我工作，`ImageSource`使用：

```
public static readonly DependencyProperty SourceProperty =
    Image.SourceProperty.AddOwner(typeof(MyCustomButton));
public ImageSource Source
{
    get { return (ImageSource)GetValue(SourceProperty); }
    set { SetValue(SourceProperty, value); }
} 
```

# svn - Code freeze in SVN - Build management

> ID：419133
> 
> 赞同：4
> 
> 时间：2009-01-07T03:53:13.947
> 
> 标签：svn, version-control, build-automation, cruisecontrol, code-freeze

Is there a better way to implement code freeze in SVN than asking all developers to not check in any new code?
We have CruiseControl running, which automatically deploys the latest build to environment. So if new code comes in, the build that was made available earlier changes to the latest one. I want that the build that is deployed is the one from a particular branch/tag, so that any new code check-ins dont affect the deployed build. Only when i tag/branch next time, the new code should be again deployed. How can we achieve this?

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-07T03:54:57.173

Use SVN's built in [branching](http://svnbook.red-bean.com/en/1.1/ch04.html) functionality. The following link shows you all the details on how to branch (you can also use tags if you prefer): [http://svnbook.red-bean.com/en/1.1/ch04.html](http://svnbook.red-bean.com/en/1.1/ch04.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-07T14:23:55.797

做你正在谈论的事情的颠覆约定是创建一个标签。当然，标签与分支没有什么不同，因为它只是某个版本的某个开发线的副本（通常......有复杂的标签）。然而，颠覆的最佳实践是标签被创建一次并且永远不会被提交——它们只是快照。

因此，我的建议是在您想要冻结的修订版上标记您的构建，与您的所有开发人员沟通，不要对该标签进行任何提交（如果他们还不知道），并从该标签构建你的版本。如果有人承诺标签，请举起地狱。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-07T13:51:04.910

使用稳定的分支和 Subversion >=1.5（服务器、存储库格式和客户端）。

从 Trunk 创建一个分支并将其指定为您的稳定分支。禁止您的开发人员提交到此分支，最好使用您可用的任何权限的 authz 文件。

制定一项策略，确保在部署之前将任何代码更改提交到 Trunk，即使这些更改源自单独的分支。

让巡航控制从指定的稳定分支而不是主干监视、构建和部署。

当需要部署新软件时，使用 subversion 的合并功能从主干合并到分支中。始终以这种方式合并，仅从主干合并，合并跟踪（仅 1.5 及更高版本）将确保您可以从主干中挑选并仅包含您想要的更改，同时排除您不想要的内容。它还可以让您直观地检查当前版本包含哪些修订版以及排除哪些修订版。

合并并检查结果后，提交代码将导致 Cruise Control 发布 - 因此发布仅发生在受控点。

如果您需要回滚到以前的版本，请从您的稳定分支的所需修订版创建一个标签，并暂时将 Cruise Control 指向该版本而不是您的稳定分支，当您解决了稳定分支上的问题后，您可以再次从稳定分支部署，而不是标签。

您可能希望在问题发生之前主动制作标签，可能会自动使用 CruiseControl，以便在您需要切换时标签已经到位。

除了修复合并冲突或合并来自除主干以外的位置的更改之外，不要在稳定分支上进行任何开发 - 很难准确判断部署了什么。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-07T06:07:55.767

如果您更愿意强硬，您可以通过 pre-commit 挂钩脚本禁用任何提交。由于历史原因，我们保留了一些停放的存储库，因此不需要新的提交。这就是我们冻结这些回购的方式。

```
 #!/bin/sh
exit 1 

```

它们仍然可以被访问和签出，但所有新的提交都将失败。因此，在您的情况下，您可以有一个进程在构建过程的时间表上锁定存储库。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-07T06:25:45.340

当然，访问机制也有阻塞——例如调整 authz 文件。

# javascript - JavaScript：未命名函数的参数

> ID：419144
> 
> 赞同：3
> 
> 时间：2009-01-07T03:56:53.770
> 
> 标签：javascript, parameters, function

在下面的 jQuery JavaScript 代码中，参数“e”在函数中取什么值？我很难理解这一点，因为这个函数不能在代码的其他地方传递一个参数，那么有一个参数如何工作？以及如何在这些未命名且未在代码中其他任何地方调用的函数中使用参数？

```
 $(document).ready( function() { 
        $('div').each(function() {
            $(this).click(function(e){
                //some code
            });
        });
    }); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-07T04:02:10.653

`click`设置事件处理程序。当事件发生时，浏览器会调用点击处理程序，并且`e`参数包含有关该事件的信息。

对于按键事件，它包含按下了哪些键以及当时按下了哪些修饰符（移位、控制等）。

对于鼠标事件，它包含单击的位置和使用的按钮。

有关事件结构属性的更多信息，请参见[http://www.quirksmode.org/js/events_properties.html 。](http://www.quirksmode.org/js/events_properties.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-07T04:07:22.313

e 是一个*eventObject*，您可以在[jQuery click 文档](http://docs.jquery.com/Events/click)中看到。

我不知道你可以用它做什么，但它应该包含有关点击事件的信息。也许这是标准的[DOM 事件](http://www.w3schools.com/htmldom/dom_obj_event.asp)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-07T04:03:56.983

触发事件时调用该匿名函数，并且 e 是一个 eventObject：

[点击（fn）](http://docs.jquery.com/Events/click#click.28.C2.A0fn_.29)

```
// fn, a function to bind to the click event on each of the matched elements.
function callback(eventObject) {
  this; // dom element
} 
```

# python - Python 线程 - 关键部分

> ID：419145
> 
> 赞同：15
> 
> 时间：2009-01-07T03:58:18.180
> 
> 标签：python, multithreading, language-agnostic

什么是线程的“关键部分”（在 Python 中）？

> 线程通过调用acquire() 方法进入临界区，该方法可以是阻塞的，也可以是非阻塞的。线程通过调用 release() 方法退出临界区。

-[了解 Python 中的线程，Linux Gazette](http://linuxgazette.net/107/pai.html)

另外，锁的目的是什么？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-01-07T04:42:43.037

其他人给出了非常好的定义。这是一个经典的例子：

```
import threading
account_balance = 0 # The "resource" that zenazn mentions.
account_balance_lock = threading.Lock()

def change_account_balance(delta):
    global account_balance
    with account_balance_lock:
        # Critical section is within this block.
        account_balance += delta 
```

假设`+=`运算符由三个子组件组成：

*   读取当前值
*   将 RHS 添加到该值
*   将累计值写回 LHS（技术上用 Python 术语*绑定它）*

如果您没有该`with account_balance_lock`语句并且`change_account_balance`并行执行两个调用，则最终可能会以危险的方式交错三个子组件操作。假设您同时调用`change_account_balance(100)`(AKA pos) 和`change_account_balance(-100)`(AKA neg)。这可能发生：

```
pos = threading.Thread(target=change_account_balance, args=[100])
neg = threading.Thread(target=change_account_balance, args=[-100])
pos.start(), neg.start() 
```

*   pos: 读取当前值 -> 0
*   neg: 读取当前值 -> 0
*   pos：将当前值添加到读取值 -> 100
*   neg：将当前值添加到读取值 -> -100
*   pos: 写入当前值 -> account_balance = 100
*   neg: 写入当前值 -> account_balance = -100

因为您没有强制操作在离散的块中发生，所以您可以得到三种可能的结果（-100、0、100）。

该`with [lock]`语句是一个单一的、不可分割的操作，它说：“让我成为执行此代码块的唯一线程。如果正在执行其他东西，那很酷——我会等。” 这确保了对 的更新`account_balance`是“线程安全的”（并行安全）。

**注意：**此模式有一个警告：您必须记住每次要操作`account_balance_lock`(via )以使代码保持线程安全。有一些方法可以减少这种脆弱性，但这是另一个问题的答案。`with``account_balance`

**编辑：**回想起来，提到该`with`语句隐式调用`acquire`锁上的阻塞可能很重要——这是上述线程对话框的“我将等待”部分。相反，非阻塞获取会说，“如果我不能立即获取锁，请告诉我”，然后依靠您检查是否获得了锁。

```
import logging # This module is thread safe.
import threading

LOCK = threading.Lock()

def run():
    if LOCK.acquire(False): # Non-blocking -- return whether we got it
        logging.info('Got the lock!')
        LOCK.release()
    else:
        logging.info("Couldn't get the lock. Maybe next time")

logging.basicConfig(level=logging.INFO)
threads = [threading.Thread(target=run) for i in range(100)]
for thread in threads:
   thread.start() 
```

我还想补充一点，锁的主要目的是保证获取的原子性（`acquire`跨线程的不可分割性），一个简单的布尔标志不能保证。原子操作的语义可能也是另一个问题的内容。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-01-07T04:07:50.797

代码的关键部分是一次只能由一个线程执行的代码。以聊天服务器为例。如果每个连接（即每个最终用户）都有一个线程，则一个“关键部分”是假脱机代码（向所有客户端发送传入消息）。如果不止一个线程试图同时假脱机一条消息，您将得到 BfrIToS MANtwD PIoEmesCEsaSges 交织在一起，这显然一点都不好。

锁是可用于同步对关键部分（或一般资源）的访问的东西。在我们的聊天服务器示例中，锁就像一个锁着的房间，里面有一台打字机。如果一个线程在那里（输入消息），则没有其他线程可以进入房间。一旦第一个线程完成，他解锁房间并离开。然后另一个线程可以进入房间（锁定它）。“获得”锁只是意味着“我得到了房间”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-07T04:09:57.347

“[临界区”](http://en.wikipedia.org/wiki/Critical_section)是一段代码，为了正确起见，有必要确保一次只能有一个控制线程在该部分中。通常，您需要一个临界区来包含将值写入内存的引用，这些引用*可以*在多个并发进程之间共享。

# java - 有没有一种简单的方法可以从显示的 JFreeChart 图表中删除 TimeSeries？

> ID：419157
> 
> 赞同：1
> 
> 时间：2009-01-07T04:07:59.393
> 
> 标签：java, swing, user-interface, jfreechart

我有一个 Swing 应用程序，它使用 JFreeChart 来显示一系列查询中的一个。其中一些查询具有复合 TimeSeries 键。该键的每个组件都可以包含一些值，但是在渲染时会产生非常嘈杂的图形。我想要一种简单的方法让用户在显示的图表组件中隐藏/显示一些时间序列。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-07T16:28:55.047

看起来 AbstractRenderer 的[setSeriesVisible](http://www.jfree.org/jfreechart/api/javadoc/org/jfree/chart/renderer/AbstractRenderer.html#setSeriesVisible(java.lang.Boolean))方法就是您要寻找的。虽然这个[论坛](http://www.jfree.org/phpBB2/viewtopic.php?t=21999&highlight=&sid=45b7aa7cd39577633e555cb3978b1ca4)讨论表明它可能只在最新版本中有效，但对于早期版本有一个变通方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-07T19:05:07.663

我不太确定您的意思，但是如果您想将项目形状分开，请查看`AnalysisXYItemRenderer`该类（或相应的）。有一个`transXDiff`可用于此类计算（例如累积差异并仅在累积值达到限制时显示绘图形状）。

几年前我这样做了，所以从那时起 JFreeChart 中的情况可能发生了变化。

# python - if __name__ == "__main__": 做什么？

> ID：419163
> 
> 赞同：7342
> 
> 时间：2009-01-07T04:11:00.010
> 
> 标签：python, namespaces, main, python-module, idioms

给定以下代码，它的作用是`if __name__ == "__main__":`什么？

```
# Threading example
import time, thread

def myfunction(string, sleeptime, lock, *args):
    while True:
        lock.acquire()
        time.sleep(sleeptime)
        lock.release()
        time.sleep(sleeptime)

if __name__ == "__main__":
    lock = thread.allocate_lock()
    thread.start_new_thread(myfunction, ("Thread #: 1", 2, lock))
    thread.start_new_thread(myfunction, ("Thread #: 2", 2, lock)) 
```

* * *

## 回答 #1

> 赞同：8092
> 
> 时间：2009-01-07T04:26:43.380

# 简答

它是样板代码，可防止用户在无意中意外调用脚本。以下是脚本中省略守卫时的一些常见问题：

*   如果您在另一个脚本（例如`import my_script_without_a_name_eq_main_guard`）中导入无保护脚本，那么第二个脚本将触发第一个脚本*在导入时*运行并*使用第二个脚本的命令行参数*。这几乎总是一个错误。

*   如果您在无保护脚本中有一个自定义类并将其保存到一个 pickle 文件中，那么在另一个脚本中将其取消腌制将触发无保护脚本的导入，与上一个项目符号中概述的问题相同。

# 长答案

为了更好地理解这为什么以及如何重要，我们需要退后一步来了解 Python 如何初始化脚本以及它如何与其模块导入机制进行交互。

每当 Python 解释器读取源文件时，它会做两件事：

*   它设置了一些特殊变量，例如`__name__`, 然后

*   它执行在文件中找到的所有代码。

让我们看看它是如何工作的，以及它与您关于`__name__`我们在 Python 脚本中经常看到的检查的问题有何关系。

## 代码示例

让我们使用一个稍微不同的代码示例来探索导入和脚本是如何工作的。假设以下内容位于名为`foo.py`.

```
# Suppose this is foo.py.

print("before import")
import math

print("before functionA")
def functionA():
    print("Function A")

print("before functionB")
def functionB():
    print("Function B {}".format(math.sqrt(100)))

print("before __name__ guard")
if __name__ == '__main__':
    functionA()
    functionB()
print("after __name__ guard") 
```

## 特殊变量

当 Python 解释器读取一个源文件时，它首先定义了一些特殊的变量。在这种情况下，我们关心`__name__`变量。

**当你的模块是主程序时**

如果您将模块（源文件）作为主程序运行，例如

```
python foo.py 
```

解释器会将硬编码的字符串分配给`"__main__"`变量`__name__`，即

```
# It's as if the interpreter inserts this at the top
# of your module when run as the main program.
__name__ = "__main__" 
```

**当您的模块被另一个模块导入时**

另一方面，假设某个其他模块是主程序，它会导入您的模块。这意味着在主程序中或在主程序导入的其他模块中存在这样的语句：

```
# Suppose this is in some other main program.
import foo 
```

解释器将搜索您的`foo.py`文件（以及搜索其他一些变体），并且在执行该模块之前，它会将`"foo"`导入语句中的名称分配给`__name__`变量，即

```
# It's as if the interpreter inserts this at the top
# of your module when it's imported from another module.
__name__ = "foo" 
```

## 执行模块的代码

设置特殊变量后，解释器执行模块中的所有代码，一次一条语句。您可能希望在代码示例旁边打开另一个窗口，以便您可以按照此说明进行操作。

**总是**

1.  它打印字符串`"before import"`（不带引号）。

2.  它加载`math`模块并将其分配给一个名为`math`. 这等效于替换`import math`为以下内容（请注意，这`__import__`是 Python 中的一个低级函数，它接受一个字符串并触发实际导入）：

```
# Find and load a module given its string name, "math",
# then assign it to a local variable called math.
math = __import__("math") 
```

3.  它打印字符串`"before functionA"`。

4.  它执行该`def`块，创建一个函数对象，然后将该函数对象分配给一个名为 的变量`functionA`。

5.  它打印字符串`"before functionB"`。

6.  它执行第二个`def`块，创建另一个函数对象，然后将其分配给一个名为 的变量`functionB`。

7.  它打印字符串`"before __name__ guard"`。

**仅当您的模块是主程序时**

8.  如果您的模块是主程序，那么它会看到`__name__`确实设置为`"__main__"`并调用这两个函数，打印字符串`"Function A"`和`"Function B 10.0"`.

**仅当您的模块被另一个模块导入时**

8.  （**相反**）如果您的模块不是主程序而是由另一个程序导入，那么`__name__`将是`"foo"`，不是`"__main__"`，它会跳过`if`语句的主体。

**总是**

9.  它会在这两种情况下打印字符串`"after __name__ guard"`。

***概括***

总而言之，以下是两种情况下打印的内容：

```
# What gets printed if foo is the main program
before import
before functionA
before functionB
before __name__ guard
Function A
Function B 10.0
after __name__ guard 
```

```
# What gets printed if foo is imported as a regular module
before import
before functionA
before functionB
before __name__ guard
after __name__ guard 
```

## 为什么它会这样工作？

你可能自然想知道为什么有人会想要这个。好吧，有时您想编写一个`.py`文件，该文件既可以被其他程序和/或模块用作模块，也可以作为主程序本身运行。例子：

*   您的模块是一个库，但您希望有一个脚本模式，它可以运行一些单元测试或演示。

*   您的模块仅用作主程序，但它有一些单元测试，并且测试框架通过导入`.py`脚本等文件和运行特殊的测试功能来工作。您不希望它仅仅因为它正在导入模块而尝试运行脚本。

*   您的模块主要用作主程序，但它也为高级用户提供了对程序员友好的 API。

除了这些示例之外，在 Python 中运行脚本只是设置一些魔术变量并导入脚本，这很优雅。“运行”脚本是导入脚本模块的副作用。

## 深思熟虑

*   问题：我可以有多个`__name__`检查块吗？答：这样做很奇怪，但语言不会阻止你。

*   假设以下内容在`foo2.py`. 如果你`python foo2.py`在命令行上说会发生什么？为什么？

```
# Suppose this is foo2.py.
import os, sys; sys.path.insert(0, os.path.dirname(__file__)) # needed for some interpreters

def functionA():
    print("a1")
    from foo2 import functionB
    print("a2")
    functionB()
    print("a3")

def functionB():
    print("b")

print("t1")
if __name__ == "__main__":
    print("m1")
    functionA()
    print("m2")
print("t2") 
```

*   现在，弄清楚如果您删除`__name__`签入会发生什么`foo3.py`：

```
# Suppose this is foo3.py.
import os, sys; sys.path.insert(0, os.path.dirname(__file__)) # needed for some interpreters

def functionA():
    print("a1")
    from foo3 import functionB
    print("a2")
    functionB()
    print("a3")

def functionB():
    print("b")

print("t1")
print("m1")
functionA()
print("m2")
print("t2") 
```

*   当用作脚本时，它会做什么？当作为模块导入时？

```
# Suppose this is in foo4.py
__name__ = "__main__"

def bar():
    print("bar")

print("before __name__ guard")
if __name__ == "__main__":
    bar()
print("after __name__ guard") 
```

* * *

## 回答 #2

> 赞同：2049
> 
> 时间：2009-01-07T04:28:23.207

当您的脚本通过将其作为命令传递给 Python 解释器来运行时，

```
python myscript.py 
```

所有处于缩进级别 0 的代码都会被执行。定义的函数和类已经定义好了，但是它们的代码都没有运行。与其他语言不同，没有`main()`自动运行的函数 - 该`main()`函数隐含地是顶层的所有代码。

在这种情况下，顶层代码是一个`if`块。 `__name__`是一个内置变量，其计算结果为当前模块的名称。但是，如果一个模块正在直接运行（`myscript.py`如上），则`__name__`改为设置为 string `"__main__"`。因此，您可以通过测试来测试您的脚本是直接运行还是被其他东西导入

```
if __name__ == "__main__":
    ... 
```

如果你的脚本被导入另一个模块，它的各种函数和类定义将被导入，它的顶层代码将被执行，但`if`上面子句的 then-body 中的代码不会运行，因为条件是没见过。作为一个基本示例，请考虑以下两个脚本：

```
# file one.py
def func():
    print("func() in one.py")

print("top-level in one.py")

if __name__ == "__main__":
    print("one.py is being run directly")
else:
    print("one.py is being imported into another module") 
```

```
# file two.py
import one

print("top-level in two.py")
one.func()

if __name__ == "__main__":
    print("two.py is being run directly")
else:
    print("two.py is being imported into another module") 
```

现在，如果您将解释器调用为

```
python one.py 
```

输出将是

```
top-level in one.py
one.py is being run directly 
```

如果您`two.py`改为运行：

```
python two.py 
```

你得到

```
top-level in one.py
one.py is being imported into another module
top-level in two.py
func() in one.py
two.py is being run directly 
```

因此，当模块`one`被加载时，它的`__name__`equals`"one"`而不是`"__main__"`.

* * *

## 回答 #3

> 赞同：819
> 
> 时间：2009-01-07T11:35:17.370

变量（imho）的最简单解释`__name__`如下：

创建以下文件。

```
# a.py
import b 
```

和

```
# b.py
print "Hello World from %s!" % __name__

if __name__ == '__main__':
    print "Hello World again from %s!" % __name__ 
```

运行它们将为您提供以下输出：

```
$ python a.py
Hello World from b! 
```

正如你所看到的，当一个模块被导入时，Python`globals()['__name__']`在这个模块中设置模块的名称。此外，在导入后，模块中的所有代码都在运行。由于该`if`语句`False`对这部分的评估不被执行。

```
$ python b.py
Hello World from __main__!
Hello World again from __main__! 
```

如您所见，当一个文件被执行时，Python`globals()['__name__']`在这个文件中设置为`"__main__"`. 这一次，该`if`语句评估为`True`并正在运行。

* * *

## 回答 #4

> 赞同：569
> 
> 时间：2013-11-23T04:38:25.760

> ## 做什么的`if __name__ == "__main__":`？

概述基础知识：

*   `__name__`作为程序入口点的模块中的全局变量是`'__main__'`。否则，它是您导入模块的名称。

*   因此，`if`只有当模块是程序的入口点时，块下的代码才会运行。

*   它允许模块中的代码可以被其他模块导入，而无需在导入时执行下面的代码块。

* * *

我们为什么需要这个？

## 开发和测试你的代码

假设您正在编写一个旨在用作模块的 Python 脚本：

```
def do_important():
    """This function does something very important""" 
```

您*可以*通过将此函数调用添加到底部来测试模块：

```
do_important() 
```

并使用以下内容运行它（在命令提示符下）：

```
~$ python important.py 
```

## 问题

但是，如果要将模块导入另一个脚本：

```
import important 
```

在导入时，将调用该函数，因此您可能会在底部`do_important`注释掉您的函数调用 , 。`do_important()`

```
# do_important() # I must remember to uncomment to execute this! 
```

然后你必须记住你是否已经注释掉了你的测试函数调用。而这种额外的复杂性意味着您可能会忘记，使您的开发过程更加麻烦。

## 更好的方法

该`__name__`变量指向 Python 解释器当前所在的命名空间。

在导入的模块中，它是该模块的名称。

但是在主模块（或交互式 Python 会话，即解释器的 Read、Eval、Print Loop 或 REPL）内，您正在运行其`"__main__"`.

因此，如果您在执行前检查：

```
if __name__ == "__main__":
    do_important() 
```

有了上述内容，您的代码只会在您将其作为主要模块运行（或有意从另一个脚本中调用它）时执行。

## 更好的方法

不过，有一种 Pythonic 方法可以改进这一点。

如果我们想从模块外部运行这个业务流程怎么办？

如果我们将开发和测试的代码放入这样的函数中，然后`'__main__'`立即进行检查：

```
def main():
    """business logic for when running this module as the primary one!"""
    setup()
    foo = do_important()
    bar = do_even_more_important(foo)
    for baz in bar:
        do_super_important(baz)
    teardown()

# Here's our payoff idiom!
if __name__ == '__main__':
    main() 
```

我们现在有一个用于模块末尾的最终函数，如果我们将模块作为主模块运行，它将运行。

它将允许在不运行该函数的情况下将模块及其函数和类导入其他脚本`main`，并且还允许在从不同模块运行时调用模块（及其函数和类）`'__main__'`，即

```
import important
important.main() 
```

[这个成语也可以在 Python 文档的`__main__`模块解释中找到。](https://docs.python.org/2/library/__main__.html)该文本指出：

> 这个模块代表解释器的主程序执行的（或者匿名的）范围——从标准输入、脚本文件或交互式提示中读取的命令。正是在这种环境中，惯用的“条件脚本”节导致脚本运行：
> 
> ```
> if __name__ == '__main__':
>     main() 
> ```

* * *

## 回答 #5

> 赞同：158
> 
> 时间：2009-01-07T04:14:23.233

`if __name__ == "__main__"`是当脚本从（比方说）命令行使用类似的命令运行时运行的部分`python myscript.py`。

* * *

## 回答 #6

> 赞同：97
> 
> 时间：2014-10-14T20:22:55.220

> # 做什么`if __name__ == "__main__":`？

`__name__`是一个存在于所有命名空间中的全局变量（在 Python 中，global 实际上是指[模块级别）。](https://docs.python.org/tutorial/modules.html#modules)它通常是模块的名称（作为一种`str`类型）。

然而，作为唯一的特殊情况，在你运行的任何 Python 进程中，如在 mycode.py 中：

```
python mycode.py 
```

否则匿名的全局命名空间被分配`'__main__'`给它的`__name__`.

因此，包括[最后几行](https://docs.python.org/library/__main__.html)

```
if __name__ == '__main__':
    main() 
```

*   在 mycode.py 脚本的末尾，
*   当它是由 Python 进程运行的主要入口点模块时，

将导致您的脚本的唯一定义`main`函数运行。

使用此构造的另一个好处：您还可以将代码作为模块导入另一个脚本中，然后在您的程序决定时运行 main 函数：

```
import mycode
# ... any amount of other code
mycode.main() 
```

* * *

## 回答 #7

> 赞同：89
> 
> 时间：2016-09-29T04:33:07.940

这里对所讨论的代码机制有很多不同的看法，即“如何”，但对我来说，在我理解“为什么”之前，这一切都没有意义。这应该对新程序员特别有帮助。

获取文件“ab.py”：

```
def a():
    print('A function in ab file');
a() 
```

第二个文件“xy.py”：

```
import ab
def main():
    print('main function: this is where the action is')
def x():
    print ('peripheral task: might be useful in other projects')
x()
if __name__ == "__main__":
    main() 
```

> 这段代码实际上在做什么？

当你执行`xy.py`时，你`import ab`. import 语句在导入时立即运行模块，因此`ab`' 的操作在 ' 的其余部分之前执行`xy`。一旦完成`ab`，它会继续`xy`。

解释器跟踪哪些脚本正在运行`__name__`。当你运行一个脚本时——不管你给它起什么名字——解释器都会调用它`"__main__"`，使它成为运行外部脚本后返回的主脚本或“主”脚本。

从此`"__main__"`脚本调用的任何其他脚本都被指定为其文件名`__name__`（例如，`__name__ == "ab.py"`）。因此，该行`if __name__ == "__main__":`是解释器的测试，以确定它是否正在解释/解析最初执行的“主”脚本，或者它是否暂时窥视另一个（外部）脚本。这使程序员可以灵活地让脚本在直接执行与外部调用时表现不同。

让我们通过上面的代码来了解发生了什么，首先关注未缩进的行以及它们在脚本中出现的顺序。请记住，函数或`def`块在被调用之前不会自己做任何事情。如果口译员自言自语，可能会说什么：

*   打开 xy.py 作为“主”文件；`"__main__"`在`__name__`变量中调用它。
*   使用 .导入和打开文件`__name__ == "ab.py"`。
*   哦，一个函数。我会记住的。
*   好的，函数`a()`；我刚刚学到了。打印' *ab 文件中的一个函数*'。
*   文件结束；回`"__main__"`！
*   哦，一个函数。我会记住的。
*   另一个。
*   功能`x()`；好的，打印“*外围任务：可能在其他项目中有用*”。
*   这是什么？一份`if`声明。嗯，条件已经满足（变量`__name__`已经设置为`"__main__"`），所以我就进入`main()`函数，打印'*主函数：这就是动作所在的地方*'。

下面两行的意思是：“如果这是`"__main__"`or 'home' 脚本，则执行名为`main()`“的函数。这就是为什么您会`def main():`在顶部看到一个块，其中包含脚本功能的主要流程。

> 为什么要实施这个？

还记得我之前说过的关于 import 语句的内容吗？当您导入一个模块时，它不仅会“识别”它并等待进一步的指令 - 它实际上会运行脚本中包含的所有可执行操作。因此，将脚本的内容放入`main()`函数中可以有效地隔离它，将其隔离，这样它在被另一个脚本导入时不会立即运行。

同样，会有例外，但通常的做法是`main()`通常不会被外部调用。所以你可能想知道另外一件事：如果我们不调用`main()`，我们为什么要调用脚本呢？这是因为许多人使用独立的函数来构建他们的脚本，这些函数被构建为独立于文件中的其余代码运行。然后在脚本正文的其他地方调用它们。这让我想到了这一点：

> 但是代码没有它就可以工作

是的，这是正确的。**可以**从不包含在函数中的内联脚本调用这些单独的`main()`函数。如果您习惯于（就像我一样，在我编程的早期学习阶段）构建完全符合您需要的内联脚本，并且如果您再次需要该操作，您将尝试再次弄清楚...... . 好吧，你不习惯代码的这种内部结构，因为它构建起来更复杂，而且阅读起来也不那么直观。

但这是一个可能无法在外部调用其函数的脚本，因为如果这样做，它将立即开始计算和分配变量。如果您尝试重用一个函数，那么您的新脚本与旧脚本的相关性非常密切，可能会出现变量冲突。

在拆分独立函数时，您可以通过将它们调用到另一个脚本中来重用以前的工作。例如，“example.py”可能会导入“xy.py”并调用“xy.py”`x()`中的“x”函数。（也许它将给定文本字符串的第三个单词大写；从数字列表中创建一个 NumPy 数组并将它们平方；或者去除 3D 表面的趋势。可能性是无限的。）

（顺便说一句，[这个问题](https://stackoverflow.com/questions/23000075/purpose-of-if-name-main)包含@kindall 的答案，它最终帮助我理解了 - 为什么，而不是如何。不幸的是，它被标记为这个的副本[，](https://stackoverflow.com/questions/419163/what-does-if-name-main-do)我认为这是一个错误。）

* * *

## 回答 #8

> 赞同：66
> 
> 时间：2013-04-03T14:09:11.270

当我们的模块（ ）中有某些语句时，`M.py`我们希望在它作为 main（未导入）运行时执行，我们可以将这些语句（测试用例，打印语句）放在这个`if`块下。

默认情况下（当模块作为主模块运行时，未导入），`__name__`变量设置为`"__main__"`，当它被导入时，`__name__`变量将获得不同的值，很可能是模块的名称（`'M'`）。这有助于一起运行模块的不同变体，并分离它们的特定输入和输出语句以及是否有任何测试用例。

**简而言之**，使用这个' `if __name__ == "main"`'块来防止在导入模块时运行（某些）代码。

* * *

## 回答 #9

> 赞同：65
> 
> 时间：2020-02-01T13:26:02.650

*仅*当模块作为脚本调用时，才会执行`if __name__ == '__main__':`下面的代码。

 *例如，考虑以下模块`my_test_module.py`：

```
# my_test_module.py

print('This is going to be printed out, no matter what')

if __name__ == '__main__':
    print('This is going to be printed out, only if user invokes the module as a script') 
```

* * *

**第一种可能性：`my_test_module.py`在另一个模块中导入**

```
# main.py

import my_test_module

if __name__ == '__main__':
    print('Hello from main.py') 
```

现在，如果您调用`main.py`：

```
python main.py

>> 'This is going to be printed out, no matter what'
>> 'Hello from main.py' 
```

请注意，仅执行顶级`print()`语句 in `my_test_module`。

* * *

**第二种可能性：`my_test_module.py`作为脚本调用**

现在，如果您`my_test_module.py`作为 Python 脚本运行，两条`print()`语句都将被执行：

```
python my_test_module.py

>>> 'This is going to be printed out, no matter what'
>>> 'This is going to be printed out, only if user invokes the module as a script' 
```

* * *

如需更全面的说明，您可以阅读*[Python 中的](https://towardsdatascience.com/what-does-if-name-main-do-e357dd61be1a)**[功能`if __name__ == '__main__'`](https://towardsdatascience.com/what-does-if-name-main-do-e357dd61be1a)*。

* * *

## 回答 #10

> 赞同：61
> 
> 时间：2016-10-15T09:07:42.043

简而言之，`__name__`是为每个脚本定义的变量，用于定义脚本是作为主模块运行还是作为导入模块运行。

所以如果我们有两个脚本；

```
#script1.py
print "Script 1's name: {}".format(__name__) 
```

和

```
#script2.py
import script1
print "Script 2's name: {}".format(__name__) 
```

执行 script1 的输出是

```
Script 1's name: __main__ 
```

执行 script2 的输出是：

```
Script1's name is script1
Script 2's name: __main__ 
```

如您所见，`__name__`它告诉我们哪个代码是“主”模块。这很棒，因为您可以只编写代码而不必担心像 C/C++ 中的结构问题，如果文件没有实现“main”函数，那么它就无法编译为可执行文件，如果确实如此，然后它不能用作库。

假设您编写了一个很棒的 Python 脚本，并且您实现了一大堆可用于其他目的的函数。如果我想使用它们，我可以只导入你的脚本并使用它们而不执行你的程序（假设你的代码只在 `if __name__ == "__main__":`上下文中执行）。而在 C/C++ 中，您必须将这些部分分成一个单独的模块，然后包含该文件。想象下面的情况；

[![C中复杂的导入](https://i.stack.imgur.com/hWLqr.png)](https://i.stack.imgur.com/hWLqr.png)

箭头是导入链接。对于三个模块，每个模块都试图包含以前的模块代码，有六个文件（九个，计算实现文件）和五个链接。这使得很难将其他代码包含到 C 项目中，除非将其专门编译为库。现在为 Python 描绘它：

[![Python 中的优雅导入](https://i.stack.imgur.com/Eql0u.png)](https://i.stack.imgur.com/Eql0u.png)

您编写一个模块，如果有人想使用您的代码，他们只需导入它，该`__name__`变量可以帮助将程序的可执行部分与库部分分开。

* * *

## 回答 #11

> 赞同：54
> 
> 时间：2015-01-20T17:48:56.970

让我们以更抽象的方式来看答案：

假设我们有这段代码`x.py`：

```
...
<Block A>
if __name__ == '__main__':
    <Block B>
... 
```

块 A 和 B 在我们运行时运行`x.py`。

但是，当我们运行另一个模块时，只运行块 A（而不是 B），`y.py`例如，在其中`x.py`导入并从那里运行代码（就像从`x.py`调用函数 in 时一样`y.py`）。

* * *

## 回答 #12

> 赞同：53
> 
> 时间：2018-06-24T15:48:36.050

简而言之，你需要知道几点：

1.  `import a`action 实际上运行了所有可以运行的东西`a.py`，这意味着每一行`a.py`

2.  由于第 1 点，您可能不希望在`a.py`导入时运行所有内容

3.  为了解决第 2 点中的问题，Python 允许您使用条件检查

4.  `__name__`是所有`.py`模块中的隐式变量：

*   当ed 时，模块的值`a.py`设置为其文件名“ ”`import``__name__``a.py``a`
*   `a.py`直接使用“”运行时`python a.py`，值`__name__`设置为字符串`__main__`

5.  基于Python如何`__name__`为每个模块设置变量的机制，你知道如何实现第3点吗？答案很简单，对吧？使用*if*条件：`if __name__ == "__main__": // do A`

*   然后`python a.py`将运行该部分`// do A`
*   并将`import a`跳过该部分`// do A`

6.  您甚至可以`__name__ == "a"`根据您的功能需要放置 if ，但很少这样做

Python 的特别之处在于第 4 点！其余的只是基本逻辑。

[我一直在阅读此页面上的所有答案。我想说，如果你知道这件事，你肯定会明白那些答案，否则，你还是一头雾水。]

* * *

## 回答 #13

> 赞同：43
> 
> 时间：2013-12-11T11:23:53.607

当您以交互方式运行 Python 时，会为局部`__name__`变量分配`__main__`. 同样，当您从命令行执行 Python 模块时，而不是将其导入另一个模块，它的`__name__`属性被分配一个值`__main__`，而不是模块的实际名称。通过这种方式，模块可以查看它们自己的`__name__`值以确定它们是如何被使用的，无论是作为对另一个程序的支持还是作为从命令行执行的主应用程序。因此，以下成语在 Python 模块中很常见：

```
if __name__ == '__main__':
    # Do something appropriate here, like calling a
    # main() function defined elsewhere in this module.
    main()
else:
    # Do nothing. This module has been imported by another
    # module that wants to make use of the functions,
    # classes and other useful bits it has defined. 
```

* * *

## 回答 #14

> 赞同：41
> 
> 时间：2017-08-22T18:53:15.693

考虑：

```
if __name__ == "__main__":
    main() 
```

它检查`__name__`Python 脚本的属性是否为`"__main__"`. 换句话说，如果程序本身被执行，属性将为`__main__`，因此程序将被执行（在这种情况下是`main()`函数）。

但是，如果您的 Python 脚本被模块使用，则`if`语句之外的任何代码都将被执行，因此`if \__name__ == "\__main__"`仅用于检查程序是否用作模块，从而决定是否运行该代码。

* * *

## 回答 #15

> 赞同：39
> 
> 时间：2018-04-03T19:32:56.963

*在解释有关它的任何内容之前，了解`if __name__ == '__main__'`它是什么以及它做什么是很重要的`__name__`。*

> **是什么`__name__`？**

`__name__`是一个[DunderAlias](https://wiki.python.org/moin/DunderAlias) - 可以被认为是一个全局变量（可从模块访问），其工作方式与[`global`](https://stackoverflow.com/questions/13881395/in-python-what-is-a-global-statement).

`type(__name__)`它是由(yielding )指示的字符串（如上所述的全局`<class 'str'>`），并且是[Python 3](https://docs.python.org/3/library/__main__.html)和[Python 2](https://docs.python.org/2/library/__main__.html)版本的内置标准。

> **在哪里：**

它不仅可以在脚本中使用，还可以在解释器和模块/包中找到。

**口译员：**

```
>>> print(__name__)
__main__
>>> 
```

**脚本：**

*测试文件.py*：

```
print(__name__) 
```

导致`__main__`

**模块或包：**

*一些文件.py：*

```
def somefunction():
    print(__name__) 
```

*测试文件.py：*

```
import somefile
somefile.somefunction() 
```

导致`somefile`

请注意，当在包或模块中使用时，`__name__`采用文件名。没有给出实际模块或包路径的路径，但有它自己的 DunderAlias `__file__`，允许这样做。

你应该看到， where `__name__`，它是主文件（或程序）的位置将*始终*返回`__main__`，如果它是一个模块/包，或者任何其他 Python 脚本运行的东西，将返回它所在的文件的名称起源于。

> **实践：**

作为变量意味着它的值*可以*被覆盖（“can”并不意味着“should”），覆盖的值`__name__`将导致缺乏可读性。因此，无论出于何种原因，都不要这样做。如果您需要一个变量，请定义一个新变量。

总是假定`__name__`to的值`__main__`是文件名。再次更改此默认值将导致更多的混乱，它会做得很好，从而导致进一步的问题。

*例子：*

```
>>> __name__ = 'Horrify' # Change default from __main__
>>> if __name__ == 'Horrify': print(__name__)
...
>>> else: print('Not Horrify')
...
Horrify
>>> 
```

`if __name__ == '__main__'`将 包含在脚本中通常被认为是一种良好的做法。

> **现在回答`if __name__ == '__main__'`：**

*现在我们知道`__name__`事物的行为变得更加清晰：*

An[`if`](https://docs.python.org/3/tutorial/controlflow.html#if-statements)是一个流控制语句，如果给定的值为真，则包含将执行的代码块。我们已经看到，它`__name__`可以采用其中一个 `__main__`或从中导入的文件名。

这意味着如果`__name__`等于`__main__`则该文件必须是主文件并且必须实际运行（或者它是解释器），而不是导入到脚本中的模块或包。

如果确实`__name__`取值，`__main__`那么该代码块中的任何内容都将执行。

这告诉我们，如果运行的文件是主文件（或者您直接从解释器运行），那么该条件必须执行。如果它是一个包，那么它不应该，并且值不会是`__main__`.

> **模块：**

`__name__`也可以在模块中使用来定义模块的名称

> **变体：**

也可以用 做其他不太常见但有用的事情`__name__`，我将在这里展示一些：

**仅当文件是模块或包时才执行：**

```
if __name__ != '__main__':
    # Do some useful things 
```

**如果文件是主要文件，则运行一个条件，如果不是，则运行另一个条件：**

```
if __name__ == '__main__':
    # Execute something
else:
    # Do some useful things 
```

您还可以使用它为包和模块提供可运行的帮助功能/实用程序，而无需精心使用库。

它还允许模块作为主脚本从命令行运行，这也非常有用。

* * *

## 回答 #16

> 赞同：35
> 
> 时间：2013-01-24T13:48:38.440

当从命令行调用 Python 文件时，它是特殊的。这通常用于调用“main()”函数或执行其他适当的启动代码，例如命令行参数处理。

它可以写成几种方式。另一个是：

```
def some_function_for_instance_main():
    dosomething()

__name__ == '__main__' and some_function_for_instance_main() 
```

我并不是说您应该在生产代码中使用它，但它可以说明`if __name__ == '__main__'`.

它只是在 Python 文件中调用 main 函数的约定。

* * *

## 回答 #17

> 赞同：35
> 
> 时间：2016-11-30T06:47:44.283

我认为最好用简单的话深入地打破答案：

`__name__`：Python 中的每个模块都有一个特殊的属性，称为`__name__`. 它是一个返回模块名称的内置变量。

`__main__`：与其他编程语言一样，Python 也有一个执行入口点，即 main。`'__main__'` *是顶级代码执行的范围的名称*。基本上你有两种使用 Python 模块的方法：直接作为脚本运行它，或者导入它。当模块作为脚本运行时，其`__name__`设置为`__main__`.

因此，该`__name__`属性的值被设置为`__main__`当模块作为主程序运行时。否则，值将`__name__` 设置为包含模块的名称。

* * *

## 回答 #18

> 赞同：26
> 
> 时间：2015-11-25T12:26:57.610

系统（Python 解释器）为源文件（模块）提供了许多变量。您可以随时获取它们的值，因此，让我们关注**__name__**变量/属性：

当 Python 加载源代码文件时，它会执行其中找到的所有代码。（请注意，它不会调用文件中定义的所有方法和函数，但会定义它们。）

不过，在解释器执行源代码文件之前，它会为该文件定义一些特殊变量；**__name__**是 Python 为每个源代码文件自动定义的特殊变量之一。

如果 Python 将此源代码文件作为主程序（即您运行的文件）加载，那么它会将此文件的特殊**__name__**变量设置为具有值**"__main__"**。

如果这是从另一个模块导入的，**则 __name__**将设置为该模块的名称。

因此，在您的示例中部分：

```
if __name__ == "__main__":
   lock = thread.allocate_lock()
   thread.start_new_thread(myfunction, ("Thread #: 1", 2, lock))
   thread.start_new_thread(myfunction, ("Thread #: 2", 2, lock)) 
```

表示代码块：

```
lock = thread.allocate_lock()
thread.start_new_thread(myfunction, ("Thread #: 1", 2, lock))
thread.start_new_thread(myfunction, ("Thread #: 2", 2, lock)) 
```

只有当你直接运行模块时才会执行；如果另一个模块正在调用/导入代码块，则该代码块将不会执行，因为**__name__**的值在该特定实例中将不等于“ **main ”。**

希望这会有所帮助。

* * *

## 回答 #19

> 赞同：23
> 
> 时间：2016-04-24T08:23:01.327

`if __name__ == "__main__":`基本上是顶级脚本环境，它指定解释器（'我有最高优先级首先执行'）。

`'__main__'`是顶级代码执行的范围的名称。模块的`__name__`设置等于`'__main__'`从标准输入、脚本或交互式提示读取时。

```
if __name__ == "__main__":
    # Execute only if run as a script
    main() 
```

* * *

## 回答 #20

> 赞同：23
> 
> 时间：2016-06-22T10:47:06.407

考虑：

```
print __name__ 
```

上面的输出是`__main__`.

```
if __name__ == "__main__":
  print "direct method" 
```

上述陈述为真，并打印出*“直接方法”*。假设如果他们在另一个类中导入这个类，它不会打印*“直接方法”*，因为在导入时，它会设置`__name__ equal to "first model name"`.

* * *

## 回答 #21

> 赞同：20
> 
> 时间：2017-03-13T21:44:26.833

> 您可以使该文件可用作**脚本**以及**可导入模块**。

**fibo.py（一个名为 的模块`fibo`）**

```
# Other modules can IMPORT this MODULE to use the function fib
def fib(n):    # write Fibonacci series up to n
    a, b = 0, 1
    while b < n:
        print(b, end=' ')
        a, b = b, a+b
    print()

# This allows the file to be used as a SCRIPT
if __name__ == "__main__":
    import sys
    fib(int(sys.argv[1])) 
```

参考：[https ://docs.python.org/3.5/tutorial/modules.html](https://docs.python.org/3.5/tutorial/modules.html)

* * *

## 回答 #22

> 赞同：19
> 
> 时间：2017-09-22T18:32:24.243

的原因

```
if __name__ == "__main__":
    main() 
```

主要是为了避免[直接导入代码](https://stackoverflow.com/questions/46326059/)会引起的[导入锁定](https://docs.python.org/2/library/threading.html#importing-in-threaded-code)问题。如果您的文件被直接调用（就是这种情况），您希望运行，但如果您的代码是导入的，那么导入器必须从真正的主模块输入您的代码以避免导入锁定问题。`main()``__name__ == "__main__"`

副作用是您自动登录到支持多个入口点的方法。`main()`您可以使用作为入口点来运行您的程序，*但您不必*. 虽然`setup.py`期望`main()`，但其他工具使用备用入口点。例如，要将文件作为`gunicorn`进程运行，您需要定义一个`app()`函数而不是`main()`. 与 , 一样`setup.py`，`gunicorn`导入您的代码，因此您不希望它在导入时做任何事情（因为导入锁定问题）。

* * *

## 回答 #23

> 赞同：16
> 
> 时间：2019-06-12T09:28:39.150

Python 中的每个模块都有一个名为`__name__`. `__name__` 属性 的值是`__main__`当模块直接运行时，比如`python my_module.py`. 否则（就像你说的那样`import my_module`）的值`__name__` 是模块的名称。

简短的小例子来解释。

### 脚本*test.py*

```
apple = 42

def hello_world():
    print("I am inside hello_world")

if __name__ == "__main__":
    print("Value of __name__ is: ", __name__)
    print("Going to call hello_world")
    hello_world() 
```

我们可以直接执行

```
python test.py 
```

输出

```
Value of __name__ is: __main__
Going to call hello_world
I am inside hello_world 
```

现在假设我们从另一个脚本调用上述脚本：

### 脚本*external_calling.py*

```
import test

print(test.apple)
test.hello_world()

print(test.__name__) 
```

当您执行此操作时，

```
python external_calling.py 
```

输出

```
42
I am inside hello_world
test 
```

因此，上面的内容是不言自明的，当您从另一个脚本调用*test*`__name__`时， if 循环`test.py`将不会执行。

* * *

## 回答 #24

> 赞同：14
> 
> 时间：2018-10-07T04:52:46.110

此答案适用于学习 Python 的 Java 程序员。每个 Java 文件通常都包含一个公共类。您可以通过两种方式使用该类：

1.  从其他文件调用类。您只需在调用程序中导入它。

2.  单独运行该类，用于测试目的。

对于后一种情况，该类应包含一个公共静态 void main() 方法。在 Python 中，这个目的是由全局定义的 label 来实现的`'__main__'`。

* * *

## 回答 #25

> 赞同：10
> 
> 时间：2018-06-19T11:44:29.860

如果这个 .py 文件被其他 .py 文件导入，“if 语句”下的代码将不会被执行。

如果这个 .py`python this_py.py`在 shell 下运行，或者在 Windows 中双击。“if 语句”下的代码将被执行。

它通常是为测试而编写的。

* * *

## 回答 #26

> 赞同：10
> 
> 时间：2019-07-30T16:22:15.500

如果 Python 解释器正在运行特定模块，则`__name__`全局变量将具有以下值`"__main__"`：

```
 def a():
      print("a")

  def b():
      print("b")

  if __name__ == "__main__":

          print ("you can see me")
          a()
  else:

          print ("You can't see me")
          b() 
```

当你运行这个脚本时，它会打印**你可以看到我**。

**一种**

如果你导入这个文件，说A到文件B，然后执行文件B，那么`if __name__ == "__main__"`在文件A中就变成了假，所以它打印 **你看不到我**。

**b**

* * *

## 回答 #27

> 赞同：10
> 
> 时间：2020-10-22T18:01:00.980

简单来说：

您在下面看到的代码 `if __name__ == "__main__":`只会在您的 python 文件作为“python example1.py”执行时被调用。

但是，如果您希望将 python 文件“example1.py”作为模块导入以与另一个 python 文件“example2.py”一起使用，则下面的代码`if __name__ == "__main__":`将不会运行或生效。

* * *

## 回答 #28

> 赞同：9
> 
> 时间：2018-04-04T14:32:34.617

# 如果**名称**== '**主要**'：

我们`__name__ == '__main__':`经常看到。

它检查是否正在导入模块。

换句话说，`if`只有当代码直接运行时，块内的代码才会被执行。这里的`directly`意思是`not imported`。

让我们看看它使用打印模块名称的简单代码做了什么：

```
# test.py
def test():
   print('test module name=%s' %(__name__))

if __name__ == '__main__':
   print('call test()')
   test() 
```

如果我们直接通过 运行代码`python test.py`，模块名称为`__main__`：

```
call test()
test module name=__main__ 
```

* * *

## 回答 #29

> 赞同：8
> 
> 时间：2021-10-30T09:46:38.393

如果您是初学者，那么您现在唯一需要的答案可能是该代码对于简单的脚本*来说是不必要的。*仅当您希望能够使用`import`您的脚本（或`unpickle`等等；请参阅此处的其他答案以了解其他一些非初学者场景）时，它才有用。

稍微详细一点，假设您有一个简单的脚本`fib.py`（改编自[这个答案](https://stackoverflow.com/a/42773985/874188)）：

```
# XXX FIXME: useless (see below)
if __name__ == "__main__":
    n = int(input('Write a number: '))
    a, b = 0, 1
    while b < n:
        a, b = b, a+b
    print('Fibonacci number %i: %i' % (n, b)) 
```

现在，如果你简单地运行`python fib.py`它就可以了。但是`__name__`会一直`"__main__"`在这种情况下，所以这个条件其实是没有必要的。脚本可以简化为

```
n = int(input('Write a number: '))
a, b = 0, 1
while b < n:
    a, b = b, a+b
print('Fibonacci number %i: %i' % (n, b)) 
```

现在，你不能`import fib`用新版本，但如果你一开始不打算这样做，这个版本实际上更好，因为它更简单、更清晰。

如果您*确实*希望能够，那么第一个版本也是无用的，因为有用的代码位于当您使用此文件`import fib`时不会运行的部分中（在这种情况下不会运行）。在这种情况下，正确的设计是重构代码，以便有用的部分位于一个函数中，您可以在编辑后随时运行。`import``__name__``"__main__"``import`

```
def main():
    n = int(input('Write a number: '))
    a, b = 0, 1
    while b < n:
        a, b = b, a+b
    print('Fibonacci number %i: %i' % (n, b))

if __name__ == "__main__":
    main() 
```

现在，如果你`import fib`，调用`main()`将不会被执行；但是当你运行时`python fib.py`，它会。

实际上，更好的设计仍然是将可重用部分（实际计算）与用户可见的输入/输出隔离开来：

```
def fibn(n: int) -> int:
    a, b = 0, 1
    while b < n:
        a, b = b, a+b
    return b

def main() -> None:
    n = int(input('Write a number: '))
    print('Fibonacci number %i: %i' % (n, fibn(n)))

if __name__ == "__main__":
    main() 
```

现在，您可以从执行 this 的代码中`from fib import fibn`调用该函数。`fibn()``import`

（我调用这个函数`fibn()`只是为了更清楚地说明这个例子是什么。在现实生活中，你可能会调用它`fib()`并执行`from fib import fib`.）

同样，如果您想重用它，您可以`import`调用该函数。`main`

回到问题中的代码，我同样会将代码从 移动`if`到函数中，以便调用者可以根据需要调用该函数。

```
def main():
    lock = thread.allocate_lock()
    thread.start_new_thread(myfunction, ("Thread #: 1", 2, lock))
    thread.start_new_thread(myfunction, ("Thread #: 2", 2, lock))

if __name__ == "__main__":
    main() 
```

这改变了`lock`变量的范围；如果周围的代码需要访问它，您将需要制作它`global`（或者，也许更好，重构`main`为`return lock`，并让调用者在它自己的局部变量中捕获值）。

* * *

## 回答 #30

> 赞同：7
> 
> 时间：2018-05-04T08:25:42.867

所有答案都几乎解释了该功能。但我将提供一个它的用法示例，这可能有助于进一步澄清这个概念。

假设您有两个 Python 文件，a.py 和 b.py。现在，a.py 导入 b.py。我们运行 a.py 文件，其中首先执行“import b.py”代码。在其余的 a.py 代码运行之前，文件 b.py 中的代码必须完全运行。

在 b.py 代码中，有一些代码是该文件 b.py 独有的，我们不希望导入 b.py 文件的任何其他文件（除了 b.py 文件）运行它。

这就是这行代码检查的内容。如果它是运行代码的主文件（即 b.py），在这种情况下它不是（a.py 是运行的主文件），那么只有代码被执行。

* * *

## 回答 #31

> 赞同：5
> 
> 时间：2018-01-08T15:24:38.693

创建一个文件**a.py**：

```
print(__name__) # It will print out __main__ 
```

`__name__`总是等于`__main__`只要该文件**直接运行**表明这是主文件。

在同一目录中创建另一个文件**b.py**：

```
import a  # Prints a 
```

运行。它将打印**一个**，即**导入**的文件的名称。

因此，要显示**同一文件的两种不同行为**，这是一个常用的技巧：

```
# Code to be run when imported into another python file

if __name__ == '__main__':
    # Code to be run only when run directly 
```

* * *

## 回答 #32

> 赞同：5
> 
> 时间：2020-04-27T12:12:54.777

Python 中的每个模块都有一个名为**name**的特殊属性。当模块作为主程序执行（例如，running ）时， **name**属性的值 被设置为' **main**`python foo.py` ' 。

否则，**name**的值 将设置为调用它的模块的名称。

* * *

## 回答 #33

> 赞同：4
> 
> 时间：2021-04-09T05:12:24.713

执行 Python 文件时，它会创建许多特殊变量，例如`__name__`. 变量`__name__`保存文件的名称。你的问题的答案是

```
if __name__ == "__main__":
       # Do something 
```

这意味着如果正在执行的文件的名称作为源文件而**不是模块**运行，那么它将运行其中的代码。这可以用一个简单的例子来证明。创建两个 Python 文件`foo.py`和`second.py`. 然后在 中`foo.py`，键入：

```
if __name__ == "__main__":
       print("file is not imported")
else:
       print("file is imported") 
```

在 中`second.py`，键入：

```
import foo

if foo.__name__ == "__main__":
       print("file is not imported")
else:
       print("file is imported") 
```

除此之外，如果您要这样做，`print(__name__)`那么它将打印`__main__`. 为什么？

因为该文件作为**主**源运行，如果您这样做`print(foo.__name__)`，它将打印*foo*因为`__name__`变量的默认值是文件的名称，默认情况下我的意思是您也可以更改它。为此，只需转到`foo.py`文件并执行以下操作：`__name__ = "name"`. 然后，例如，当您运行该文件时，

```
__name__ = "Hello, World!"
print(__name__) 
```

那么输出将是：

```
Hello, World! 
```

* * *

## 回答 #34

> 赞同：2
> 
> 时间：2020-04-21T11:48:53.900

**Python main 函数**是任何程序的起点。当程序运行时，Python 解释器按顺序运行代码。main 函数只有在作为 Python 程序运行时才会执行...

```
def main():
    print("I am in the function")

print("I am out of the function") 
```

运行脚本时显示：

```
I am out of the function 
```

而不是“我在函数中”的代码。

这是因为我们没有声明调用函数“if__name__==” **main** ”。

如果您从中使用：

```
def main():
    print("I am in the function")

if __name__ == "__main__":
    main()

print("I am out of the function") 
```

输出等于

```
I am in the function
I am out of the function 
```

在 Python 中，“if__name__==” **main**允许您将 Python 文件作为可重用模块或独立程序运行。

当 Python 解释器读取源文件时，它将执行在其中找到的所有代码。当 Python 将“源文件”作为主程序运行时，它会将特殊变量 ( **name** ) 设置为具有值 (“ **main** ”)。

当您执行 main 函数时，它将读取“if”语句并检查**name**是否等于**main**。

在 Python 中，“if__name__==” **main**允许您将 Python 文件作为可重用模块或独立程序运行。

* * *

## 回答 #35

> 赞同：2
> 
> 时间：2021-07-04T12:56:39.713

假设我在 Wikipedia 上为网页抓取编写了函数和类。当然，这可能不是一个很好的例子。

我想在另一个程序中使用这些函数而不重写它。

好吧，我导入它们，但在该文件的末尾我放了 __ name __ = '__ main __'

当我们导入一个模块时，它里面的所有代码都会从头到尾执行。但是当它达到条件时，它并没有运行*func*、*func2*等，这就是维基百科的**抓取**。

好吧，在全局范围内，Python __ 名称 __ 被定义为当前程序的 '__ main __'。

当我们导入一个模块时，它被定义为我们当前程序的名称空间中的一个变量，当前程序__name__是'__ main __'：

### 文件*test.py*

```
def func():
    # Do something
    pass

def func2():
    # Do something
    pass

print('The program name is set to ', globals()['__name__'])

if __name__=='__main__':
    # In the current program, __name__ is equal to '__main__'
    func('https://www.wikipedia.org')
    func2('https://www.wikipedia.org')
    # Or do more jobs 
```

```
import test1
print('inside of current program')
print('name is current program', __name__)
print(globals()['test1'])
test1.func('another site')
test1.func2('another site') 
```

### 输出

```
inside of test 1
name of program is set to test1
end of module
inside of current
__main__
<module 'test1' from 'C:\\users\\ir\\appdata\\local\\programs\\python\\python38\\lib\\test1.py'> 
```

* * *

## 回答 #36

> 赞同：1
> 
> 时间：2019-02-03T19:36:21.837

简单地说，它是运行文件的入口点，就像*C*编程语言`main`中的函数一样。

 ** * *

## 回答 #37

> 赞同：1
> 
> 时间：2020-01-31T17:53:28.540

`__name__`您可以使用这个简单的示例检查特殊变量：

创建*file1.py*

```
if __name__ == "__main__":
    print("file1 is being run directly")
else:
    print("file1 is being imported") 
```

创建 *file2。*py*

```
import file1 as f1

print("__name__ from file1: {}".format(f1.__name__))
print("__name__ from file2: {}".format(__name__))

if __name__ == "__main__":
    print("file2 is being run directly")
else:
    print("file2 is being imported") 
```

执行文件2.py

*输出*：

```
file1 is being imported
__name__ from file1: file1
__name__ from file2: __main__
file2 is being run directly 
```

* * *

## 回答 #38

> 赞同：1
> 
> 时间：2021-02-09T09:57:40.480

`if __name__ = "__main__"`意味着如果你正常运行 Python 文件`python foo.py`，它会将特殊变量分配`__name__`给`"__main__"`.

但是，如果您正在导入像“import foo”这样的文件，它将分配`__name__`给`"foo"`并且不会运行该函数。

* * *

## 回答 #39

> 赞同：1
> 
> 时间：2021-05-05T17:52:32.837

当您执行模块（源文件）时，*if*条件检查模块是直接调用还是从另一个源文件调用。这里直接表示不导入。

如果直接调用执行，模块名设置为“main”，然后执行*if*块内的代码。

# project-management - Web application platforms

> ID：419164
> 
> 赞同：-1
> 
> 时间：2009-01-07T04:11:32.257
> 
> 标签：project-management, bug-tracking

I work for a small software development company and we currently lack support/bug tracking/software license software so in an effort to better ourselves and de-stress because of a lack of easily accessible information we're looking for some software. Without going into detail, our size means we work a different way to most other support/development teams so a lot of existing helpdesk/bug tracking programs aren't suitable.

I don't really want to spend my time writing a completely new system for us so I've been looking for a web application platform (I call it this because I don't know what else to) like [limbas](http://www.limbas.org/) which basically allows me to define entities (think bugs, feature requests, support calls, customers, software installs), view lists of them, and link them together (this support call belongs to this customer who has this software installed which has these modules etc).

Is anyone aware of similar kinds of software?

TIA

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-07T04:19:00.387

Try looking at [Trac](http://trac.edgewall.org) i use it to track my bugs.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-07T04:21:10.803

试试 Fog Creek Software 的 FogBugz

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-07T04:22:19.363

[BugZilla](http://www.bugzilla.org/)也是另一个开源替代品。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-07T08:38:12.827

我们喜欢[JIRA](http://www.atlassian.com/software/jira/)，它可以让您跟踪“错误、功能请求、支持电话、客户”。我不太确定记录每个客户（JIRA 用户）拥有哪些软件版本的最佳方法，但 JIRA 确实允许您向每个用户添加键值对，这可能会为您提供所需的内容。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-07T07:11:58.070

我可能想看看[这篇](https://stackoverflow.com/questions/101774/what-is-your-bug-task-tracking-tool)文章。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-07T15:19:31.987

如果你下载[Django](http://www.djangoproject.org)，你可以定义你的模型并使用默认的管理页面。

您将为错误、功能请求、支持电话、客户、软件安装定义一个模型（基本上是 Python 类）。

您的模型包括模型类之间的关系。包括“支持电话属于客户”、“客户已安装软件”、“软件已安装模块”。

默认管理页面将显示它们的列表，

您可以毫不费力地通过视图函数和 HTML 模板编写这些模型的自定义视图。

您永远不需要编写事务处理，它已经作为 Django 的一部分提供。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-30T04:01:54.447

查看[间隔](http://www.myintervals.com "间隔 - 基于网络的项目管理")。我们为我们的软件开发机构构建了它，希望它也可以让您不必编写自己的代码。它处理错误跟踪和功能请求，以及时间跟踪和报告。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-07T05:20:55.643

如果您不介意一点编码，您可以在[DotNetNuke](http://www.dotnetnuke.com/)中制作一个模块或一组模块。这使您可以跳入您的工作并将管理留给框架。您还可以购买并轻松安装一些第 3 方模块，这些模块涵盖了 Snowcovered 的帮助台[类型](http://www.snowcovered.com/snowcovered2/)。DotNetNuke 终于（我从 3.0 开始使用它）变得快速、功能丰富且安全。

它实际上是一个有趣的 CMS。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-07T07:40:05.987

Microsoft CRM 在查看您想要的内容时会立即想到，它具有您要求的所有自定义项，根本不需要接触任何代码。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-12-20T22:17:10.590

另请参阅[Redmine](http://redmine.org)

# sql-server - MISSING SERIES

> ID：419175
> 
> 赞同：0
> 
> 时间：2009-01-07T04:14:46.010
> 
> 标签：sql-server

Im creating a stored procedure/function in MS SQL which should return the missing series.

Example:

the table "orders" contain field name "ordNo".

ordNo

000001

000003

000005

the functions should return these values:

000002

000004

any idea?

thank you very much.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-07T04:28:58.463

像这样简单的东西呢：

```
SELECT ordNo - 1
FROM Orders o
WHERE NOT EXISTS (
    SELECT *
    FROM Orders n
    WHERE n.ordNo = o.OrdNo - 1        
)
AND ordNo > 1 
```

**编辑：**啊 - 虽然这不会在系列中找到丢失的“运行”。只有一个缺失的数字。

这是一个我认为至少可以找到“缺失”订单号的“从”和“到”值的版本：

```
SELECT (SELECT MAX(ordNo) + 1 FROM Orders m WHERE m.ordNo < o.OrdNo) fromOrdNo,
    (ordNo - 1) toOrdNo
FROM Orders o
WHERE NOT EXISTS (
    SELECT *
    FROM Orders n
    WHERE n.ordNo = o.OrdNo - 1        
)
AND ordNo > 1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-07T04:19:18.917

它的伪代码是这样的：

1.从 00001 开始

2.递增1并检查表中是否存在（ordNo）。

3.如果不存在，返回号码，否则重复该过程。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-07T05:16:38.333

也许下面的例子应该有所帮助。

```
 -- the table that will have rows numbered from 1 to 1000
select top 1000 identity(int,1,1) as id into #X from syscolumns

-- the table with missing values
select top 200 identity(int,1,2) as id into #Y from syscolumns

-- select * from #x
-- select * from #y

select #x.id, #y.id from #x
left outer join #y on #x.id = #y.id
where  #y.id is null 

```

你应该有一个像#x 这样的临时表，它将包含所有值（包括行的最大值）。在上面的例子中，我假设范围是从 1 到 1000。

# java - 构建管理/持续集成最佳实践

> ID：419181
> 
> 赞同：10
> 
> 时间：2009-01-07T04:22:18.210
> 
> 标签：java, build-process, release

您的团队如何处理构建？
我们使用 Cruise Control，但是（由于缺乏知识）我们面临一些问题 - [SVN 中的代码冻结 - 构建管理](https://stackoverflow.com/questions/419133/code-freeze-in-svn)
具体来说，当代码不断被签入时，如何使特定版本可用？

一般来说，您能讨论一下您在发布管理中使用的最佳实践吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-07T04:38:19.503

我很惊讶这不是重复的，但我找不到另一个。

好的，这是交易。它们是两个独立但相关的问题。

对于构建管理，最重要的一点是您应该有一个自动的、可重复的构建，它从头开始重新构建整个软件集合，并一直到您的可交付配置。换句话说，您应该每次都有效地构建一个发布候选。许多项目并没有真正做到这一点，但我已经看到它烧人（读“被它烧死”）太多次了。

持续集成表示，如果可能的话，每次代码发生重大更改事件（如签入）时，都应重复此构建过程。我已经完成了几个项目，在这些项目中，这变成了每晚的构建，因为代码足够大，需要花费几个小时来构建，但理想的情况是设置构建过程，以便一些自动机制 --- 像蚂蚁脚本或制作文件 --- 仅重建受更改影响的部分。

您通过以某种方式保留每个构建的所有受影响工件的确切配置来处理提供特定版本的问题，因此您可以将可重复的构建过程应用于您拥有的确切配置。（这就是为什么它被称为“配置管理”。）通常的版本控制工具，如 git 或 subversion，提供了识别和命名配置的方法，以便可以恢复它们；例如，在 svn 中，您可以为特定构建构建一个标签。您只需要保留一些元数据，以便了解您使用的配置。

您可能想阅读一本“实用版本控制”书籍，当然，Martin Fowler 网站上有关 CI 和 Cruise Control 的内容是必不可少的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-07T04:28:53.453

查看Martin Fowler的[持续集成：最佳实践。](http://www.martinfowler.com/articles/continuousIntegration.html)

好吧，我设法找到了一个[相关的线程](http://www.coderanch.com/t/130861/Agile-Other-Processes/Continuous-Integration-builds-version-tags)，我在一年前参与了。您可能会发现它也很有用。这就是我们如何做到的。

**[已编辑]**

我们使用 Cruise Control 作为集成工具。我们只处理主干，在我们的例子中它是主要的 Subversion 存储库。当有可能发生复杂的冲突时，我们很少会抽出新的分支来制作新的故事卡。通常，我们会为版本发布拉出一个分支，并从中创建构建并将其交付给我们的测试团队。同时我们在trunk中继续工作，等待测试团队的反馈。一旦所有测试完成，我们就从分支创建一个标签，在我们的例子中它在逻辑上是不可变的。因此，我们可以随时向任何客户发布任何版本以防万一。如果版本中出现错误，我们不会创建标签，我们会修复分支中的内容。在测试团队修复并批准所有内容后，我们将更改合并回主干，并从特定于该版本的分支创建一个新标签。

所以，我们的想法是我们的​​分支和标签并没有真正直接参与持续集成。将分支代码合并回主干会自动使该代码成为 CI（持续集成）的一部分。我们通常只在分支中针对特定版本进行错误修复，因此我相信它并没有真正参与 CI 过程。相反，如果我们出于某些原因在一个分支中开始制作新的故事卡，那么我们不会将该分支分开太久。我们尝试尽快将其合并回主干。

恰恰，

*   当我们计划下一个版本时，我们手动创建分支
*   我们为发布创建一个分支并修复该分支中的错误以防万一
*   一切顺利后，我们从那个分支制作一个标签，它在逻辑上是不可变的
*   最后，如果有一些修复/修改，我们将分支合并回主干

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-07T05:19:39.763

发布管理远远超出了持续集成。

在您的情况下，您应该使用 Cruise Control 自动制作标签，这允许开发人员在您的增量构建发生时继续编码。

如果您的构建是增量的，这意味着您可以每 x 分钟触发一次（而不是每次提交，因为如果它们过于频繁，并且如果您的构建太长，那么在下一个构建尝试之前可能没有时间完成发生）。'x' 应该被定制为比编译/单元测试周期更长。

持续集成还应该包括单元测试的自动启动。

除此之外，完整的发布管理流程将涉及：

*   在认证服务器上的一系列部署
*   一个完整的认证周期/UAT（用户验收测试）
*   非回归测试
*   性能/压力测试
*   预生产（和并行运行测试）

在最终投入生产之前。

同样，“发布管理”比“持续集成”复杂得多；）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-07T05:12:40.340

长话短说：创建一个从主干复制的分支，并在构建服务器上的该分支上签出/构建您的版本。

然而，使用 cc.net 以完全自动化的方式达到这一点并不是一件容易的事。如果您愿意，我可以详细介绍我们的构建过程，但对于本次讨论来说，它可能过于细化。

我同意查理关于从头开始自动、可重复构建的观点。但我们并不为“连续”构建做*所有事情，只为每晚、测试、每周或欧米茄（GA/RTM/黄金）版本构建。*仅仅是因为某些事情，例如生成文档，可能需要很长时间，并且对于持续构建，您希望向开发人员提供有关构建结果的快速反馈。

我完全同意保留确切的配置，这就是为什么分支发布或标记是必须的。如果您必须维护一个发布，即您不能只发布另一个主干副本，那么发布分支方法是可行的方法，但您需要熟悉合并。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2009-01-07T04:30:22.797

您可以使用 Team Foundation Server 2008 和 Microsoft Studio Team System 来完成源代码控制、分支和发布。

# android - 如何以编程方式从 Android 的收件箱中删除短信？

> ID：419184
> 
> 赞同：99
> 
> 时间：2009-01-07T04:25:01.763
> 
> 标签：android, sms

在 Android 手机上，注册到应用程序的 SMS 消息也会发送到设备的收件箱。但是，为了防止混乱，最好能够从收件箱中删除特定于应用程序的 SMS 消息，以减少这些消息的潜在溢出。

其他 Google 小组关于以编程方式从 Android 收件箱中删除 SMS 消息的明确答案的问题似乎并不紧迫。

所以场景：

*   安卓应用启动。
*   注册 SMS 消息类型 X、Y 和 Z
*   消息 P、Q、X、Y、Z 在一段时间内流入，全部存入收件箱
*   Android 应用程序检测到 X、Y、Z 的接收（可能是程序中断事件的一部分）
*   过程 X,Y,Z
*   *愿望！！！*X、Y、Z 从 Android 收件箱中删除

已经完成了吗？可以做到吗？

* * *

## 回答 #1

> 赞同：87
> 
> 时间：2011-06-02T06:29:41.567

`android.provider.Telephony.SMS_RECEIVED`“从 Android 1.6 开始，传入的SMS 消息广播（

这意味着您可以拦截传入的消息并进一步中止广播它。

在您的`AndroidManifest.xml`文件中，确保将优先级设置为最高：

```
<receiver android:name=".receiver.SMSReceiver" android:enabled="true">
    <intent-filter android:priority="1000">
        <action android:name="android.provider.Telephony.SMS_RECEIVED" />
    </intent-filter>
</receiver> 
```

在您的`BroadcastReceiver`, in`onReceive()`方法中，在对您的消息执行任何操作之前，只需调用`abortBroadcast();`

编辑：从 KitKat 开始，这显然不再有效。

EDIT2：有关如何在 KitKat 上执行此操作的更多信息：

[在 4.4.4 上从 android 中删除 SMS（删除后受影响的行 = 0（零））](https://stackoverflow.com/questions/25988574/delete-sms-from-android-on-4-4-4-affected-rows-0zero-after-deleted)

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2009-01-13T15:53:00.567

使用其他人的建议，我想我得到了它的工作：

（使用 SDK v1 R2）

这并不完美，因为我需要删除整个对话，但出于我们的目的，这是一个足够的妥协，因为我们至少知道所有消息都会被查看和验证。然后，我们的流程可能需要侦听消息，捕获我们想要的消息，执行查询以获取最近入站消息的 thread_id 并执行 delete() 调用。

在我们的活动中：

```
Uri uriSms = Uri.parse("content://sms/inbox");
Cursor c = getContentResolver().query(uriSms, null,null,null,null); 
int id = c.getInt(0);
int thread_id = c.getInt(1); //get the thread_id
getContentResolver().delete(Uri.parse("content://sms/conversations/" + thread_id),null,null); 
```

注意：我无法删除 content://sms/inbox/ 或 content://sms/all/

看起来线程优先，这是有道理的，但错误消息只会让我更加生气。在 sms/inbox/ 或 sms/all/ 上尝试删除时，您可能会得到：

```
java.lang.IllegalArgumentException: Unknown URL
    at com.android.providers.telephony.SmsProvider.delete(SmsProvider.java:510)
    at android.content.ContentProvider$Transport.delete(ContentProvider.java:149)
    at android.content.ContentProviderNative.onTransact(ContentProviderNative.java:149) 
```

如需其他参考，请确保将其放入您的意图接收器的清单中：

```
<receiver android:name=".intent.MySmsReceiver">
    <intent-filter>
        <action android:name="android.provider.Telephony.SMS_RECEIVED"></action>
    </intent-filter>
</receiver> 
```

请注意，接收者标签不是这样的：

```
<receiver android:name=".intent.MySmsReceiver" 
    android:permission="android.permission.RECEIVE_SMS"> 
```

当我有这些设置时，android 给了我一些疯狂的权限异常，不允许 android.phone 将收到的 SMS 交给我的意图。所以，不要把那个 RECEIVE_SMS 权限属性放在你的意图中！希望比我更聪明的人能告诉我为什么会这样。

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2009-05-12T04:38:45.863

所以，我玩了一下*，*可以删除收到的短信。不幸的是，这并非一帆风顺:(

我有一个接收器接收传入的 SMS 消息。现在，Android SMS 传入路由的工作方式是，负责解码消息的代码片段在消息到达时发送广播（它使用该`sendBroadcast()`方法 - 不幸的是，它不是让您简单调用的版本`abortBroadcast()`）。

我的接收器可能会或可能不会在系统 SMS 接收器之前被调用，并且在任何情况下接收到的广播都没有可以反映`_id`SMS 表中的列的属性。

但是，不是一个容易被阻止的人，我（通过处理程序）向自己发布了一条延迟消息，其中 SmsMessage 作为附加对象。（我想你也可以给自己发一个 Runnable ......）

```
handler.sendMessageDelayed(handler.obtainMessage(MSG_DELETE_SMS, msg), 2500); 
```

延迟是为了确保在消息到达时所有广播接收器都完成了他们的工作，并且消息将安全地存放在 SMS 表中。

当收到消息（或 Runnable）时，我会这样做：

```
case MSG_DELETE_SMS:
    Uri deleteUri = Uri.parse("content://sms");
    SmsMessage msg = (SmsMessage)message.obj;

    getContentResolver().delete(deleteUri, "address=? and date=?", new String[] {msg.getOriginatingAddress(), String.valueOf(msg.getTimestampMillis())}); 
```

我使用原始地址和时间戳字段来确保仅删除我感兴趣的消息的可能性非常高。如果我想更加偏执，我可以将`msg.getMessageBody()`内容作为查询的一部分包含在内。

是的，该消息已删除（万岁！）。不幸的是，通知栏没有更新:(

当您打开通知区域时，您会看到为您准备的消息......但是当您点击它打开它时 - 它消失了！

对我来说，这还不够好 - 我希望消息的所有痕迹都消失 - 我不希望用户认为没有 TXT（这只会导致错误报告）。

在操作系统内部调用电话`MessagingNotification.updateNewMessageIndicator(Context)`，但我对 API 隐藏了该类，我不想仅仅为了使指标准确而复制所有代码。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2012-12-15T18:54:13.760

```
public boolean deleteSms(String smsId) {
    boolean isSmsDeleted = false;
    try {
        mActivity.getContentResolver().delete(Uri.parse("content://sms/" + smsId), null, null);
        isSmsDeleted = true;

    } catch (Exception ex) {
        isSmsDeleted = false;
    }
    return isSmsDeleted;
} 
```

在 AndroidManifyt 中使用此权限

```
<uses-permission android:name="android.permission.WRITE_SMS"/> 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2011-08-16T12:56:33.680

最好使用 _id 和 thread_id 来删除消息。

Thread_id 是分配给来自同一用户的消息的东西。因此，如果您仅使用 thread_id，则来自发件人的所有消息都将被删除。

如果您使用 _id、thread_id 的组合，那么它将删除您要删除的确切消息。

```
Uri thread = Uri.parse( "content://sms");
int deleted = contentResolver.delete( thread, "thread_id=? and _id=?", new String[]{String.valueOf(thread_id), String.valueOf(id)} ); 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-01-08T21:23:56.353

您需要找到消息的[URI](http://groups.google.com/group/android-developers/browse_thread/thread/23068c27b99141b2/ff87f089e03754ac?lnk=raot)。但是一旦你这样做，我认为你应该能够 android.content.ContentResolver.delete(...) 它。

这里有更多[信息](http://code.google.com/p/android/issues/detail?id=914)。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-06-08T13:56:07.827

我认为这暂时不能完美地完成。有2个基本问题：

1.  当您尝试删除短信时，如何确保短信已经在收件箱中？
    请注意，SMS_RECEIVED 不是有序广播。
    所以dmyung的解决方案完全是碰运气；甚至道格回答的延迟也不能保证。

2.  SmsProvider 不是线程安全的。（请参阅[http://code.google.com/p/android/issues/detail?id=2916#c0](http://code.google.com/p/android/issues/detail?id=2916#c0)）
    多个客户端请求删除并插入其中的事实同时会导致数据损坏甚至立即运行时异常。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-06-12T13:08:18.310

我无法使用 dmyung 的解决方案让它工作，它在获取消息 ID 或线程 ID 时给了我一个异常。

最后，我使用了以下方法来获取线程 id：

```
private long getThreadId(Context context) {
    long threadId = 0;

    String SMS_READ_COLUMN = "read";
    String WHERE_CONDITION = SMS_READ_COLUMN + " = 0";
    String SORT_ORDER = "date DESC";
    int count = 0;

    Cursor cursor = context.getContentResolver().query(
                    SMS_INBOX_CONTENT_URI,
          new String[] { "_id", "thread_id", "address", "person", "date", "body" },
                    WHERE_CONDITION,
                    null,
                    SORT_ORDER);

    if (cursor != null) {
            try {
                count = cursor.getCount();
                if (count > 0) {
                    cursor.moveToFirst();
                    threadId = cursor.getLong(1);                              
                }
            } finally {
                    cursor.close();
            }
    }

    return threadId;
} 
```

然后我可以删除它。但是，正如 Doug 所说，通知仍然存在，甚至在打开通知面板时会显示消息。只有在点击消息时，我才能真正看到它是空的。

因此，我想唯一可行的方法是在短信发送到系统之前，甚至在它到达收件箱之前，以某种方式拦截短信。但是，我高度怀疑这是可行的。如果我错了，请纠正我。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2014-03-15T12:53:01.067

**使用此功能删除特定的消息线程或根据您的需要进行修改：**

```
public void delete_thread(String thread) 
{ 
  Cursor c = getApplicationContext().getContentResolver().query(
  Uri.parse("content://sms/"),new String[] { 
  "_id", "thread_id", "address", "person", "date","body" }, null, null, null);

 try {
  while (c.moveToNext()) 
      {
    int id = c.getInt(0);
    String address = c.getString(2);
    if (address.equals(thread)) 
        {
     getApplicationContext().getContentResolver().delete(
     Uri.parse("content://sms/" + id), null, null);
    }

       }
} catch (Exception e) {

  }
} 
```

**在下面简单地调用这个函数：**

```
delete_thread("54263726");//you can pass any number or thread id here 
```

**不要忘记在下面添加 android mainfest 权限：**

```
<uses-permission android:name="android.permission.WRITE_SMS"/> 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2010-12-27T10:10:05.923

看看这个链接，它会给你一个简单的逻辑思路：

[https](https://gist.github.com/5178e798d9a00cac4ddb)
: //gist.github.com/5178e798d9a00cac4ddb 调用deleteSMS()函数有一定的延迟，因为时间有细微的差别通知的内容以及实际保存的时间....，有关详细信息，还请查看此链接..........

[http://htmlcoderhelper.com/how-to-delete-sms-from-收件箱-in-android-programmatically/](http://htmlcoderhelper.com/how-to-delete-sms-from-inbox-in-android-programmatically/)

谢谢............

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2011-08-08T12:11:51.240

还要更新清单文件以删除您需要写入权限的短信。

```
<uses-permission android:name="android.permission.WRITE_SMS"/> 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2010-06-21T17:34:22.403

只需关闭默认短信应用的通知即可。为所有短信处理您自己的通知！

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2012-07-03T12:19:12.020

Now`abortBroadcast();`方法可用于限制传入消息进入收件箱。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2010-12-28T10:44:48.080

您只需尝试以下代码。它将删除所有手机中的所有短信（已接收或已发送）

```
Uri uri = Uri.parse("content://sms");

ContentResolver contentResolver = getContentResolver();

Cursor cursor = contentResolver.query(uri, null, null, null,
  null);

while (cursor.moveToNext()) {

 long thread_id = cursor.getLong(1);
 Uri thread = Uri.parse("content://sms/conversations/"
   + thread_id);
 getContentResolver().delete(thread, null, null);
} 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2011-01-22T02:37:19.130

删除一条短信而不是对话的示例：

```
getContentResolver().delete(Uri.parse("content://sms/conversations/" + threadID), "_id = ?", new String[]{id}); 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2013-10-14T09:29:15.187

```
@Override
protected void onListItemClick(ListView l, View v, int position, long id) {
    SMSData sms = (SMSData) getListAdapter().getItem(position);
    Toast.makeText(getApplicationContext(), sms.getBody(),
            Toast.LENGTH_LONG).show();
    Toast.makeText(getApplicationContext(), sms.getNumber(),
            Toast.LENGTH_LONG).show();

    deleteSms(sms.getId());

}

public boolean deleteSms(String smsId) {
    boolean isSmsDeleted = false;
    try {
        MainActivity.this.getContentResolver().delete(
                Uri.parse("content://sms/" + smsId), null, null);
        isSmsDeleted = true;

    } catch (Exception ex) {
        isSmsDeleted = false;
    }
    return isSmsDeleted;
} 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2013-09-03T11:36:50.733

试试这个，我 100% 确定这会正常工作：-//只需将转换地址放在这里，以便按地址删除整个转换（不要忘记在 mainfest 中添加读、写权限）这是代码：

```
String address="put address only";

Cursor c = getApplicationContext().getContentResolver().query(Uri.parse("content://sms/"), new String[] { "_id", "thread_id", "address", "person", "date", "body" }, null, null, null);

try {
    while (c.moveToNext()) {
        int id = c.getInt(0);
        String address = c.getString(2);
        if(address.equals(address)){
        getApplicationContext().getContentResolver().delete(Uri.parse("content://sms/" + id), null, null);}
    }
} catch(Exception e) {

} 
```

* * *

## 回答 #18

> 赞同：-1
> 
> 时间：2012-12-10T18:06:50.783

使用这种方法之一选择最后收到的短信并将其删除，在这种情况下，我将获得最多的短信并使用短信的线程和 id 值删除，

```
try {
    Uri uri = Uri.parse("content://sms/inbox");
    Cursor c = v.getContext().getContentResolver().query(uri, null, null, null, null);
    int i = c.getCount();

    if (c.moveToFirst()) {
    }
} catch (CursorIndexOutOfBoundsException ee) {
    Toast.makeText(v.getContext(), "Error :" + ee.getMessage(), Toast.LENGTH_LONG).show();
} 
```

# python - 您如何在 Google App Engine 项目中查询 Google App Domain 中的用户集？

> ID：419197
> 
> 赞同：1
> 
> 时间：2009-01-07T04:33:53.320
> 
> 标签：python, google-app-engine, google-apps, gql, gqlquery

如果您有一个 Google App Engine 项目，您可以基于 a) 拥有 google 帐户的任何人或 b) 特定的 google 应用程序域进行身份验证。由于您可以连接这两个实体，我假设有一些方法可以查询可以通过身份验证的用户列表。该用例将组织中所有成员的名册输出到在 Google App Engine 上运行的网页。有什么想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-07T22:31:57.637

查询所有可能在“a”（所有 gmail 用户）的情况下进行身份验证的用户将是数百万用户，所以我相信你不希望这样做。

我确定您实际上的意思是查询以前登录过您的应用程序的人，在这种情况下，您只需创建一个表来存储他们的用户信息，并在经过身份验证的用户在您的站点上时填充该表。

您可以在 Google App Engine Docs 中的[Using User Values With the Datastore中阅读更多内容](http://code.google.com/appengine/docs/users/userobjects.html "对数据存储使用用户值")

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-07T10:38:41.507

App Engine 没有内置任何功能来执行此操作。但是，如果您拥有 Apps 高级版，则可以使用[报告 API](http://code.google.com/apis/apps/reporting/google_apps_reporting_api.html)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-18T21:14:07.270

You would have to use the Premium (or Education) Google apps version, and you can use the api to list all users in the apps domain:

`GET https://apps-apis.google.com/a/feeds/domain/user/2.0`

see docs here:

[http://code.google.com/apis/apps/gdata_provisioning_api_v2.0_reference.html](http://code.google.com/apis/apps/gdata_provisioning_api_v2.0_reference.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-08T22:27:33.573

是的，没有办法获取有关尚未登录您的应用程序的人的信息。

# c# - 在c#中映射gps坐标的好api是什么？

> ID：419205
> 
> 赞同：2
> 
> 时间：2009-01-07T04:38:54.387
> 
> 标签：c#, map, gps, gis

我有一个包含 gps 坐标列表的项目。我想找到一种方法来制作这些坐标的简单地图（一次可能只有一个）。地图应该有基本的街道信息。

我们项目的这一部分非常简单，所以我认为它不需要是一个功能异常丰富的产品。这也意味着它不应该真的很贵。

什么是实现这一目标的好产品？

编辑：这是一个桌面应用程序，可能无法使用互联网连接。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-07T04:42:18.637

谷歌地图非常适合这一点。

如果这是一个可以访问 Internet 的桌面应用程序，您仍然可以托管一个 IE 控件并在那里显示它。

编辑：如果这是一个无法访问互联网的桌面应用程序，您将不得不购买 Microsoft Streets & Trips 之类的东西。我不知道它是否有可重复使用的控件。您可能必须购买更昂贵的东西才能获得它。这种性质的应用程序通常属于“GIS”类别。尝试在 Google 上搜索。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-10T20:58:33.353

[Sharpmap](http://www.codeplex.com/SharpMap)是用 C# 编写并在 LGPL 下发布的开源项目。从页面引用第一行：

> SharpMap 是一个易于使用的地图库，可用于 Web 和桌面应用程序。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-09-11T10:12:23.007

我会选择这个解决方案

*   地图渲染：[SharpMap](http://www.codeplex.com/SharpMap)
*   几何操作：[NetTopologySuite](http://code.google.com/p/nettopologysuite/)
*   地图数据存储：文件系统中的 shapefile 或[PostGis](http://postgis.refractions.net/) over [PostgreSQL](http://www.postgresql.org/)
*   地图数据本身：最简单的方法可能是从[OpenStreetMaps](http://www.openstreetmap.org/)数据中提取。例如，您可以[在此处下载所需位置的 shapefile。](http://download.geofabrik.de/osm/)

Everyting 是开源的（或多或少，请检查许可证）并且在 Windows 上运行良好。

希望能帮助到你

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-11-25T17:15:22.517

ESRI 有一个 API。他们有[javascript](http://resources.esri.com/help/9.3/arcgisserver/apis/javascript/arcgis/help/jssamples_start.htm)、[silverlight、wpf](http://resources.esri.com/help/9.3/arcgisserver/apis/silverlight/samples/start.htm)和[flash](http://mapapps.esri.com/serverdemos/FlexViewer/index.html)。他们可能有更多。ESRI 几乎是映射的标准。

# testing - 初级 QA 工程师的面试问题

> ID：419209
> 
> 赞同：4
> 
> 时间：2009-01-07T04:41:09.733
> 
> 标签：testing, qa

http://stackoverflow.com/questions/61532/tips-for-hiring-good-testers

上面的帖子我已经参考过了，但是我想知道一个没有丰富经验的应届大学毕业生在面试时可以期待哪些面试问题？他可能已经在课程中完成了质量保证测试课程。具体来说，他最有可能被问到关于基本测试的哪些问题？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-07T09:40:09.253

如果我正在采访软件测试员，我最感兴趣的是了解他们的一般计算机知识水平。这是因为他们对一般计算的经验和知识越多，他们对程序如何工作以及需要注意的潜在问题就越了解。这种知识通常只在对计算机有浓厚兴趣并花费大量空闲时间使用计算机的人身上得到巩固。在大学才开始使用计算机或仅在必要时才使用计算机的人通常对它们不太了解。

首先，我会问一些一般性问题。他们是在成长过程中拥有一台计算机，还是经常使用一台计算机？他们是否知道计算机中的基本硬件组件以及它们各自的功能是什么？他们了解什么是操作系统吗？我不会雇用在这个级别上挣扎的人。

如果他们要测试互联网应用程序，我也会检查一些关于互联网的一般知识。什么是 DNS？什么是路由器？他们了解客户端（浏览器）与服务器端处理吗？这里缺乏知识不会自动失败，但会在我心中留下严重的疑问。

我的问题会逐渐变得更详细，特别是如果候选人表示他们是专家或在某个领域非常有知识。

我的第三种方法是测试他们解决问题的能力。您的 QA 测试人员可能不会修复代码中的错误，但他们越能缩小问题范围并确定触发它的具体情况，您的开发人员纠正错误的速度就越快，成本也就越低。为此，我会提出一些示例问题，并询问候选人他们将如何进行并报告错误。在 PC 上展示实际的现场演示是理想的，但假设也可以。

最后，我试着看看候选人有多么有条不紊。理想的候选人将有条不紊地进行测试 - 他/她将能够创建一个测试清单/方法，该清单/方法将彻底涵盖程序功能的所有重要方面。这是一个很难测试的。您可以在向候选人提出假设（或真实）问题时拿起它，并仔细观察它们是如何进行的。

如果你在进行面试，并且对上述领域不太了解，试着找一个会面试的人，否则那些口齿伶俐的候选人很容易把羊毛蒙在你的眼睛上，并以他们自信的无知给你留下深刻印象。如果您是那个潜在的候选人，并且您知道自己在上述任何领域都不是很胜任，那么请为自己和任何潜在的雇主省去很多痛苦，并进行一些职业能力倾向测试以找到您真正的职业道路。

# wpf - WPF ComboBox 字体绑定 FileFormatException

> ID：419216
> 
> 赞同：0
> 
> 时间：2009-01-07T04:43:31.507
> 
> 标签：wpf, vb.net, data-binding, combobox, fonts

我有一个绑定到的 WPF 组合框

```
Me.fontComboFast.ItemsSource = Fonts.SystemFontFamilies

<ComboBox x:Name="fontComboFast">
    <ComboBox.ItemsPanel>
        <ItemsPanelTemplate>
            <VirtualizingStackPanel />
        </ItemsPanelTemplate>
    </ComboBox.ItemsPanel>
    <ComboBox.ItemTemplate>
        <DataTemplate>
            <TextBlock Text="{Binding}" FontFamily="{Binding}" FontSize="15" Height="20"/>
        </DataTemplate>
    </ComboBox.ItemTemplate>
</ComboBox> 
```

发生以下异常。清除任何无效字体的 Fonts.SystemFontFamilies 的最佳方法是什么？

'file:///C:/Program Files (x86)/Common Files/Adobe/SING/AssocCache/Generic.otf' 文件不符合预期的文件格式规范。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-07T08:00:36.303

好的，下面的示例帮助了[Sample Font Chooser](http://blogs.msdn.com/text/archive/2006/11/01/sample-font-chooser.aspx)

以下代码还排除了在我的情况下不可用的符号字体：

```
Friend Function IsSymbolFont(ByVal FontFamily As FontFamily) As Boolean
    For Each typeface As Typeface In FontFamily.GetTypefaces()
        Dim Face As New GlyphTypeface

        Try
            If typeface.TryGetGlyphTypeface(Face) Then
                Return Face.Symbol
            End If
        Catch e As Exception
            Return True
        End Try

    Next
    Return False
End Function 
```

# jquery - jQuery Hover Menu - 当悬停在子菜单上时 - 菜单消失

> ID：419218
> 
> 赞同：2
> 
> 时间：2009-01-07T04:44:26.183
> 
> 标签：jquery

所以我创建了一个简单的小悬停，它使用链接中的一个类来显示下面的 div。

显示/隐藏工作正常，但我不知道如何设置它，以便如果鼠标在 div 上，它不会隐藏。我尝试使用 (this) 和 .hover，但没有成功。

这是我的代码：

```
$(document).ready(function()
{

    // hide all dropdown
    $("#dropdown1").hide();

    //hover show dropdown

    $(".menu-level-one").hover(
        function () {
            $("#dropdown1").show();
        },
        function () {
            var postTimer1 = setTimeout(function(){ $("#dropdown1").hide(); }, 1000);        
        }
    );
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-07T05:07:47.807

您可以使用`clearTimeout(postTimer1)`来停止计时器的执行。因此，如果用户将鼠标悬停在 上`#dropdown1`，请清除计时器。

也许是这样的：

```
$(document).ready(function() {
  var hideTimer = null
  var dropdown = $("#dropdown1", this)
  var menu = $(".menu-level-one", this)

  dropdown.hide();

  $([dropdown[0], menu[0]]).hover(
    function() {
      if (hideDropdownTimer)
        clearTimeout(hideDropdownTimer);

      dropdown.show();
    },
    function() {
      if (hideDropdownTimer)
        clearTimeout(hideDropdownTimer);

      hideDropdownTimer = setTimeout(function() {
        dropdown.hide()
      }, 300)
    }
  )
}) 
```

# cocoa-touch - 如何让 -[NSString sizeWithFont:forWidth:lineBreakMode:] 工作？

> ID：419222
> 
> 赞同：21
> 
> 时间：2009-01-07T04:46:17.850
> 
> 标签：cocoa-touch

我更新了我的问题“ [Sizing a UILabel (in the iPhone SDK) to fit?](https://stackoverflow.com/questions/406212/sizing-a-uilabel-in-the-iphone-sdk-to-fit) ”，并用建议的解决方案描述了我的问题，但没有得到答案。通过提出一个新问题，也许我会得到更好的结果......

我在以下代码之后设置了一个断点：

```
NSString *theText = @"When in the Course of human events, it becomes necessary for one people to dissolve the political bands which have connected them with another, and to assume among the powers of the earth, the separate and equal station to which the Laws of Nature and of Nature's God entitle them, a decent respect to the opinions of mankind requires that they should declare the causes which impel them to the separation.";
CGSize theSize = [theText sizeWithFont:[UIFont systemFontOfSize:17.0f] forWidth:260.0 lineBreakMode:UILineBreakModeWordWrap]; 
```

`theSize.height`是 21 和`theSize.width`231。我做错了什么？该高度不能以像素为单位，也不能以行数为单位。

请注意，这`[UIFont systemFontOfSize:17.0f]`是为了指定默认字体。

**更新**：我将代码更改为：

```
CGSize constraintSize;
constraintSize.width = 260.0f;
constraintSize.height = MAXFLOAT;
NSString *theText = @"When in the Course of human events, it becomes necessary for one people to dissolve the political bands which have connected them with another, and to assume among the powers of the earth, the separate and equal station to which the Laws of Nature and of Nature's God entitle them, a decent respect to the opinions of mankind requires that they should declare the causes which impel them to the separation.";
CGSize theSize = [theText sizeWithFont:[UIFont systemFontOfSize:17.0f] constrainedToSize:constraintSize lineBreakMode:UILineBreakModeWordWrap]; 
```

`theSize.height`是273。这似乎更像它。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-01-07T05:03:09.640

该高度以像素为单位。我希望它会被截断，即如果您将此文本设置在具有 1 行的 UILabel 上，则会为您提供您会看到的指标。

尝试使用`sizeWithFont:constrainedToSize:`并将其`MAXFLOAT`作为尺寸的高度分量。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-02-03T16:50:39.267

正如任何对此感到困惑的人所了解的那样，该方法的名称不恰当，并且与您的预期不一致（这违反了良好的 API 设计，但正如任何经验丰富的开发人员都知道的那样：Apple 的 API 设计得不好，对不起，伙计们）。值得一读：[Josh Bloch](http://lcsd05.cs.tamu.edu/slides/keynote.pdf)关于良好 API 设计的演讲。

我假设他们应该重命名它（如果必须保留它）并使这个有用，这样你就不会最终使用`CGSize`你知道的尺寸太大的常见做法。

```
[someString sizeWithFont:yourFont 
       constrainedToSize:CGSizeMake(maxWidthYouSpecify, self.frame.size.height)  
           lineBreakMode:UILineBreakModeWordWrap]; 
```

或者，这也可以：

```
[someString sizeWithFont:yourFont 
       constrainedToSize:CGSizeMake(maxWidthYouSpecify, CGFLOAT_MAX)
           lineBreakMode:UILineBreakModeWordWrap]; 
```

可以说，这就是该功能的工作方式。（FWIW，`CGFLOAT_MAX`在[CGGeometry](https://developer.apple.com/library/mac/#documentation/graphicsimaging/reference/CGGeometry/Reference/reference.html)中定义）

顺便说一句，但相当重要：所有核心图形都处理点而不是像素。

> 一点不一定对应屏幕上的一个像素。

这是一个重要的区别，在处理不同的分辨率（iPhone 3GS vs 4 vs iPad 等）时您需要了解这一点。有关“点与像素”的信息，请参阅 Apple 的[文档](https://developer.apple.com/library/ios/#documentation/2DDrawing/Conceptual/DrawingPrintingiOS/GraphicsDrawingOverview/GraphicsDrawingOverview.html)和 Command+F。

# matlab - matlab中的分箱

> ID：419223
> 
> 赞同：11
> 
> 时间：2009-01-07T04:46:36.990
> 
> 标签：matlab, matrix, octave

我一直无法在 matlab 或 octave 中找到一个函数来做我想做的事。我有一个包含两列（x 和 y 值）的矩阵 m。我知道我可以通过执行 m(:,1) 或 m(:,2) 来提取列。我想将其拆分为 [可能] 大小相等的较小矩阵，并绘制这些矩阵的平均值。换句话说，我想根据 x 值将值放入 bin 中，然后找到 bin 的平均值。我觉得 hist 函数应该对我有帮助，但似乎没有。

有谁知道一个内置函数来做这样的事情？

*编辑*

我本来打算提到我看着 hist 并不能让它做我想做的事，但它一定是我的想法。

示例：假设我有以下内容（我正在八度音阶中尝试这个，但是 afaik 它在 matlab 中有效）：

```
x=1:20;
y=[1:10,10:1];
m=[x, y]; 
```

如果我想要 10 个垃圾箱，我希望将 m 分成：

```
m1=[1:2, 1:2]
...
m5=[9:10, 9:10]
m6=[10:11, 10:-1:9]
...
m10=[19:20, 2:-1:1] 
```

然后得到每个 bin 的平均值。

[更新：我在这里](https://stackoverflow.com/questions/427221/better-non-linear-binning)发布了一个后续问题。我将不胜感激。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-01-07T18:54:22.850

我已经在我的博客上以视频形式回答了这个问题：

[http://blogs.mathworks.com/videos/2009/01/07/binning-data-in-matlab/](http://blogs.mathworks.com/videos/2009/01/07/binning-data-in-matlab/)

这是代码：

```
m = rand(10,2); %Generate data

x = m(:,1); %split into x and y
y = m(:,2);

topEdge = 1; % define limits
botEdge = 0; % define limits
numBins = 2; % define number of bins

binEdges = linspace(botEdge, topEdge, numBins+1);

[h,whichBin] = histc(x, binEdges);

for i = 1:numBins
    flagBinMembers = (whichBin == i);
    binMembers     = y(flagBinMembers);
    binMean(i)     = mean(binMembers);
end 
```

# linux - 在 Linux 中区分 IOWAIT

> ID：419231
> 
> 赞同：-1
> 
> 时间：2009-01-07T04:50:35.687
> 
> 标签：linux, networking, iowait

我正在开发一个与使用 Linux 内核的系统一起工作的监控代理。通过打开 /proc/stat ，您可以轻松了解一个或所有 CPU（聚合）等待 I/O 请求完成的时间。

我试图找到一种方法来分解这个数字，以便我可以区分磁盘和网络 i/o。例如，将内核节拍的单位转换为秒后，您会看到所有 CPU 的总和花费了 1024 秒等待 I/O。我想知道其中有多少是由于网络连接速度慢而被烧毁的。

我不确定这是否可能，感谢任何帮助:) 我在 /proc/net 或 sysfs 中看不到任何有帮助的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-07T05:39:42.983

尝试查看[SystemTap](http://sourceware.org/systemtap/documentation.html)。它与 Solaris DTrace 非常相似，您可以获得不同级别的详细信息。

# python - 有人知道我可以使用的基于 Python 的优秀网络爬虫吗？

> ID：419235
> 
> 赞同：67
> 
> 时间：2009-01-07T04:53:21.737
> 
> 标签：python, web-crawler

我有点想自己写，但我现在真的没有足够的时间。我已经看过[开源爬虫](http://en.wikipedia.org/wiki/Web_crawler#Open-source_crawlers)的维基百科列表，但我更喜欢用 Python 编写的东西。我意识到我可能只使用 Wikipedia 页面上的一种工具并将其包装在 Python 中。我最终可能会这样做——如果有人对这些工具有任何建议，我愿意听取他们的意见。我通过它的网络界面使用了 Heritrix，我发现它非常麻烦。我绝对不会在即将到来的项目中使用浏览器 API。

提前致谢。另外，这是我的第一个 SO 问题！

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2009-01-07T05:13:20.043

*   [机械化](http://wwwsearch.sourceforge.net/mechanize/)是我的最爱；强大的高级浏览功能（超级简单的表单填写和提交）。
*   [Twill](http://twill.idyll.org/)是一种建立在 Mechanize 之上的简单脚本语言
*   [BeautifulSoup](http://www.crummy.com/software/BeautifulSoup/) + [urllib2](http://docs.python.org/library/urllib2.html)也很好用。
*   [Scrapy](http://scrapy.org/)看起来是一个非常有前途的项目；这是新的。

* * *

## 回答 #2

> 赞同：44
> 
> 时间：2009-01-07T19:11:00.537

使用[Scrapy](http://scrapy.org/)。

它是一个基于twisted的网络爬虫框架。仍在大力开发中，但它已经可以工作了。有很多好东西：

*   内置支持解析 HTML、XML、CSV 和 Javascript
*   用于使用图像（或任何其他媒体）抓取项目并下载图像文件的媒体管道
*   支持通过使用中间件、扩展和管道插入您自己的功能来扩展 Scrapy
*   广泛的内置中间件和扩展，用于处理压缩、缓存、cookie、身份验证、用户代理欺骗、robots.txt 处理、统计、抓取深度限制等
*   交互式爬虫控制台，对开发和调试非常有用
*   用于监视和控制机器人的 Web 管理控制台
*   用于对 Scrapy 进程进行低级访问的 Telnet 控制台

通过在返回的 HTML 上使用 XPath 选择器，提取有关今天在[mininova种子站点中添加的所有种子文件的信息的示例代码：](http://www.mininova.org/)

```
class Torrent(ScrapedItem):
    pass

class MininovaSpider(CrawlSpider):
    domain_name = 'mininova.org'
    start_urls = ['http://www.mininova.org/today']
    rules = [Rule(RegexLinkExtractor(allow=['/tor/\d+']), 'parse_torrent')]

    def parse_torrent(self, response):
        x = HtmlXPathSelector(response)
        torrent = Torrent()

        torrent.url = response.url
        torrent.name = x.x("//h1/text()").extract()
        torrent.description = x.x("//div[@id='description']").extract()
        torrent.size = x.x("//div[@id='info-left']/p[2]/text()[2]").extract()
        return [torrent] 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-07T05:11:40.793

检查[HarvestMan](http://bulba.sdsu.edu/docwiki/HarvestMan)，一个用 Python 编写的多线程网络爬虫，也看看[spider.py](http://pypi.python.org/pypi/spider.py/0.5)模块。

[在这里](http://www.example-code.com/python/pythonspider.asp)你可以找到代码示例来构建一个简单的网络爬虫。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-07T05:07:59.070

我用过[Ruya](http://ruya.sourceforge.net/)，发现它很不错。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2010-11-11T10:04:04.530

我破解了上面的脚本以包含一个登录页面，因为我需要它来访问一个 drupal 站点。不漂亮，但可以帮助那里的人。

```
#!/usr/bin/python

import httplib2
import urllib
import urllib2
from cookielib import CookieJar
import sys
import re
from HTMLParser import HTMLParser

class miniHTMLParser( HTMLParser ):

  viewedQueue = []
  instQueue = []
  headers = {}
  opener = ""

  def get_next_link( self ):
    if self.instQueue == []:
      return ''
    else:
      return self.instQueue.pop(0)

  def gethtmlfile( self, site, page ):
    try:
        url = 'http://'+site+''+page
        response = self.opener.open(url)
        return response.read()
    except Exception, err:
        print " Error retrieving: "+page
        sys.stderr.write('ERROR: %s\n' % str(err))
    return "" 

    return resppage

  def loginSite( self, site_url ):
    try:
    cj = CookieJar()
    self.opener = urllib2.build_opener(urllib2.HTTPCookieProcessor(cj))

    url = 'http://'+site_url 
        params = {'name': 'customer_admin', 'pass': 'customer_admin123', 'opt': 'Log in', 'form_build_id': 'form-3560fb42948a06b01d063de48aa216ab', 'form_id':'user_login_block'}
    user_agent = 'Mozilla/4.0 (compatible; MSIE 5.5; Windows NT)'
    self.headers = { 'User-Agent' : user_agent }

    data = urllib.urlencode(params)
    response = self.opener.open(url, data)
    print "Logged in"
    return response.read() 

    except Exception, err:
    print " Error logging in"
    sys.stderr.write('ERROR: %s\n' % str(err))

    return 1

  def handle_starttag( self, tag, attrs ):
    if tag == 'a':
      newstr = str(attrs[0][1])
      print newstr
      if re.search('http', newstr) == None:
        if re.search('mailto', newstr) == None:
          if re.search('#', newstr) == None:
            if (newstr in self.viewedQueue) == False:
              print "  adding", newstr
              self.instQueue.append( newstr )
              self.viewedQueue.append( newstr )
          else:
            print "  ignoring", newstr
        else:
          print "  ignoring", newstr
      else:
        print "  ignoring", newstr

def main():

  if len(sys.argv)!=3:
    print "usage is ./minispider.py site link"
    sys.exit(2)

  mySpider = miniHTMLParser()

  site = sys.argv[1]
  link = sys.argv[2]

  url_login_link = site+"/node?destination=node"
  print "\nLogging in", url_login_link
  x = mySpider.loginSite( url_login_link )

  while link != '':

    print "\nChecking link ", link

    # Get the file from the site and link
    retfile = mySpider.gethtmlfile( site, link )

    # Feed the file into the HTML parser
    mySpider.feed(retfile)

    # Search the retfile here

    # Get the next link in level traversal order
    link = mySpider.get_next_link()

  mySpider.close()

  print "\ndone\n"

if __name__ == "__main__":
  main() 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2011-11-29T12:32:03.197

相信我，没有什么比 curl 更好的了…… 以下代码可以在不到 300 秒的时间内在 Amazon EC2 上并行抓取 10,000 个 url

**注意：** *不要以如此高的速度访问同一个域......*

```
#! /usr/bin/env python
# -*- coding: iso-8859-1 -*-
# vi:ts=4:et
# $Id: retriever-multi.py,v 1.29 2005/07/28 11:04:13 mfx Exp $

#
# Usage: python retriever-multi.py <file with URLs to fetch> [<# of
#          concurrent connections>]
#

import sys
import pycurl

# We should ignore SIGPIPE when using pycurl.NOSIGNAL - see
# the libcurl tutorial for more info.
try:
    import signal
    from signal import SIGPIPE, SIG_IGN
    signal.signal(signal.SIGPIPE, signal.SIG_IGN)
except ImportError:
    pass

# Get args
num_conn = 10
try:
    if sys.argv[1] == "-":
        urls = sys.stdin.readlines()
    else:
        urls = open(sys.argv[1]).readlines()
    if len(sys.argv) >= 3:
        num_conn = int(sys.argv[2])
except:
    print "Usage: %s <file with URLs to fetch> [<# of concurrent connections>]" % sys.argv[0]
    raise SystemExit

# Make a queue with (url, filename) tuples
queue = []
for url in urls:
    url = url.strip()
    if not url or url[0] == "#":
        continue
    filename = "doc_%03d.dat" % (len(queue) + 1)
    queue.append((url, filename))

# Check args
assert queue, "no URLs given"
num_urls = len(queue)
num_conn = min(num_conn, num_urls)
assert 1 <= num_conn <= 10000, "invalid number of concurrent connections"
print "PycURL %s (compiled against 0x%x)" % (pycurl.version, pycurl.COMPILE_LIBCURL_VERSION_NUM)
print "----- Getting", num_urls, "URLs using", num_conn, "connections -----"

# Pre-allocate a list of curl objects
m = pycurl.CurlMulti()
m.handles = []
for i in range(num_conn):
    c = pycurl.Curl()
    c.fp = None
    c.setopt(pycurl.FOLLOWLOCATION, 1)
    c.setopt(pycurl.MAXREDIRS, 5)
    c.setopt(pycurl.CONNECTTIMEOUT, 30)
    c.setopt(pycurl.TIMEOUT, 300)
    c.setopt(pycurl.NOSIGNAL, 1)
    m.handles.append(c)

# Main loop
freelist = m.handles[:]
num_processed = 0
while num_processed < num_urls:
    # If there is an url to process and a free curl object, add to multi stack
    while queue and freelist:
        url, filename = queue.pop(0)
        c = freelist.pop()
        c.fp = open(filename, "wb")
        c.setopt(pycurl.URL, url)
        c.setopt(pycurl.WRITEDATA, c.fp)
        m.add_handle(c)
        # store some info
        c.filename = filename
        c.url = url
    # Run the internal curl state machine for the multi stack
    while 1:
        ret, num_handles = m.perform()
        if ret != pycurl.E_CALL_MULTI_PERFORM:
            break
    # Check for curl objects which have terminated, and add them to the freelist
    while 1:
        num_q, ok_list, err_list = m.info_read()
        for c in ok_list:
            c.fp.close()
            c.fp = None
            m.remove_handle(c)
            print "Success:", c.filename, c.url, c.getinfo(pycurl.EFFECTIVE_URL)
            freelist.append(c)
        for c, errno, errmsg in err_list:
            c.fp.close()
            c.fp = None
            m.remove_handle(c)
            print "Failed: ", c.filename, c.url, errno, errmsg
            freelist.append(c)
        num_processed = num_processed + len(ok_list) + len(err_list)
        if num_q == 0:
            break
    # Currently no more I/O is pending, could do something in the meantime
    # (display a progress bar, etc.).
    # We just call select() to sleep until some more data is available.
    m.select(1.0)

# Cleanup
for c in m.handles:
    if c.fp is not None:
        c.fp.close()
        c.fp = None
    c.close()
m.close() 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-12-15T10:47:30.890

另一个[简单的蜘蛛](http://www.grenadepod.com/2009/12/13/python-web-crawler/) 使用 BeautifulSoup 和 urllib2。没什么太复杂的，只需读取所有href 构建一个列表并通过它。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-08-06T19:25:55.163

[pyspider.py](http://bauerdata.bauerhost.dk/python-program-eksempler/pyspider)

# asp.net-mvc - MVC Beta 1 Routing - 多少路由会开始导致性能问题？

> ID：419236
> 
> 赞同：1
> 
> 时间：2009-01-07T04:54:31.047
> 
> 标签：asp.net-mvc, asp.net-mvc-routing

我正在考虑预加载静态内容页面的路由，允许内容的 n 深度嵌套。我有一个解决方案，它在注册的潜在路线数量方面提供了一些安慰，但我想知道我是否让系统过于复杂。

您怀疑基本托管帐户在多少注册路由时会开始出现性能下降？这些路由是纯文本的，不需要解析值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-07T05:25:42.047

路由解析，与数据库访问相比？我猜路由解析非常便宜。直到您进入数千条路线。

# php - 如何将 JavaScript 函数数据放入 PHP 变量中

> ID：419240
> 
> 赞同：10
> 
> 时间：2009-01-07T05:02:20.080
> 
> 标签：php, javascript, function

我正在使用 PHP 和 JavaScript。我的 JavaScript 代码包含一个函数 get_data()：

```
function get_Data(){
    var name;
    var job;
    .....

    return buffer;
} 
```

现在我有以下 PHP 代码。

```
<?php
    $i=0;
    $buffer_data;

    /* Here I need to get the value from JavaScript get_data() of buffer;
       and assign to variable $buffer_data. */
?> 
```

如何将 JavaScript 函数数据分配给 PHP 变量？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-07T05:48:28.753

使用 jQuery 将 JavaScript 变量发送到您的 PHP 文件：

```
$url = 'path/to/phpFile.php';

$.get($url, {name: get_name(), job: get_job()}); 
```

在您的 PHP 代码中，从以下方式获取`$_GET['name']`变量`$_GET['job']`：

```
<?php
    $buffer_data['name'] = $_GET['name'];
    $buffer_data['job']  = $_GET['job'];
?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-07T05:06:09.730

JavaScript 代码在客户端执行，而 PHP 在服务器端执行，因此您必须将 JavaScript 值发送到服务器。这可能隐藏在 Ajax 中`$_POST`或通过[Ajax](http://en.wikipedia.org/wiki/Ajax_%28programming%29)进行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-07T05:05:31.790

您必须使用[Ajax](http://en.wikipedia.org/wiki/Ajax_%28programming%29)，因为服务器端代码无法调用客户端脚本，结果在服务器端范围内可用。您可能必须在客户端进行 Ajax 调用，这将设置 PHP 变量。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-07T06:01:46.310

如果您没有使用 Ajax 的经验或不需要 Ajax，那么只需将您的数据填充到 post/get 中，然后将数据发送回您的页面。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-26T08:14:06.747

```
 <script>
        function get_Data(){
            var name;
            var job;
            .....
            return buffer;
        }

        function getData()
        {
            var agree=confirm("get data?");
            if (agree)
            {
                document.getElementById('javascriptOutPut').value = get_Data();
                return true;
            }
            else
            {
                return false;
            }
        }
    </script>

    <form method="post" action="" onsubmit="return getData()"/>
        <input type="submit" name="save" />
        <input type="hidden" name="javascriptOutPut" id="javascriptOutPut"/>
    </form>

    <?php
        if(isset($_POST['save']))
        {
            var_dump($_POST['javascriptOutPut']);
        }
    ?> 
```

# perl - 如何将 PDF 文件与 Perl 合并？

> ID：419244
> 
> 赞同：9
> 
> 时间：2009-01-07T05:03:55.863
> 
> 标签：perl, pdf, merge

使用 Perl，我如何将示例 PDF 文件合并或合并为单个 PDF 文件？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-01-07T05:07:08.290

[CAM::PDF](http://search.cpan.org/perldoc?appendpdf.pl)可以很容易地做到这一点，并且有一个简单的命令行前端来提供帮助。注意：我是该库的作者。例子：

```
appendpdf.pl file1.pdf file2.pdf outfile.pdf 
```

* * *

从[perldoc](http://search.cpan.org/~cdolan/CAM-PDF-1.59/lib/CAM/PDF.pm)的 SYNOPSIS 部分：

```
my $anotherpdf = CAM::PDF->new('test2.pdf');
$pdf->appendPDF($anotherpdf); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-07T06:52:53.850

为什么你需要从 Perl 来做呢？克里斯已经提到过[CAM::PDF](http://search.cpan.org/dist/CAM-PDF)。

如果您只需要合并它们，[pdftk (PDF ToolKit)](http://www.accesspdf.com/pdftk/)就可以了。这是一个简单的命令行：

```
pdftk file1.pdf file2.pdf cat output merged.pdf 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-07T05:05:50.913

您可以使用[GhostScript](http://www.ghostscript.com/)实用程序`pdf2ps`将 PDF 转换为 PostScript 文件，连接 PostScript 文件，然后用于`ps2pdf`将结果转换回 PDF。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2021-02-05T17:14:53.033

[Perlmonks 对这个话题进行了很好的讨论，而且不止一种方法。](https://www.perlmonks.org/?node_id=470301)

# python - 从网页抓取文本

> ID：419260
> 
> 赞同：3
> 
> 时间：2009-01-07T05:14:40.490
> 
> 标签：python, c, text, webpage

我想编写一个程序来查找公交车站时间并相应地更新我的个人网页。

如果我要手动执行此操作，我会

1.  访问 www.calgarytransit.com
2.  输入停靠点编号。即）9510
3.  点击按钮“下一班车”

结果可能如下所示：

> 10:16p 154 号公路
> 10:46p 154 号公路
> 11:32p 154 号公路

一旦我抓住了时间和路线，我就会相应地更新我的网页。

我不知道从哪里开始。我知道对 Web 编程很深，但会写一些 C 和 Python。我可以研究哪些主题/库？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-07T05:17:21.517

[Beautiful Soup](http://www.crummy.com/software/BeautifulSoup/documentation.html#Quick%20Start)是一个用于解析网页的 Python 库。在它和[urllib2](http://docs.python.org/library/urllib2.html)（ Python 3 中的[urllib.request](http://docs.python.org/py3k/library/urllib.request)）之间，你应该能够弄清楚你需要什么。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-07T05:18:24.087

你问的是所谓的“网络抓取”。我敢肯定，如果你用谷歌搜索你会发现一些东西，但核心概念是你想要打开一个到网站的连接，在 HTML 中啜饮，解析它并识别你想要的块。

[Python Wiki](http://wiki.python.org/moin/WebProgramming)在这方面有很多东西。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-07T05:17:13.153

由于您是用 C 编写的，因此您可能需要查看[cURL](http://curl.haxx.se/ "卷曲")；特别是，看看 libcurl。这很棒。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-07T05:35:48.500

您可以使用 Perl 来帮助您完成任务。

```
use strict;
use LWP;

my $browser = LWP::UserAgent->new;

my $responce = $browser->get("http://google.com");
print $responce->content; 
```

您的响应对象可以告诉您它是否成功以及返回页面的内容。您也可以使用同一个库发布到页面。

这是一些文档。[http://metacpan.org/pod/LWP::UserAgent](http://metacpan.org/pod/LWP::UserAgent)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-07T06:43:38.283

您可以使用可用于 Python [http://wwwsearch.sourceforge.net/mechanize/的 mechanize 库](http://wwwsearch.sourceforge.net/mechanize/)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-07T05:19:33.820

该站点不提供 API 让您能够获取所需的适当数据。在这种情况下，您需要解析由例如 CURL 请求返​​回的实际 HTML 页面。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-07T05:27:11.793

这称为**Web 抓取**，它甚至有自己的[Wikipedia 文章](http://en.wikipedia.org/wiki/Web_scraping)，您可以在其中找到更多信息。

此外，您可能会在此[SO 讨论](https://stackoverflow.com/questions/419235/anyone-know-of-a-good-python-based-web-crawler-that-i-could-use)中找到更多详细信息。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-07T05:20:06.550

只要您尝试“抓取”的网页布局没有定期更改，您就应该能够使用任何现代编程语言解析 html。

# php - 通过在 PHP 和 Javascript 登录页面上按 enter 进行提交工作

> ID：419279
> 
> 赞同：1
> 
> 时间：2009-01-07T05:23:29.833
> 
> 标签：php, javascript, login, onclick

我对 Javascript 很陌生，我确信这是一个简单的解决方法，但我无法弄清楚。

我正在使用[此页面](http://marakana.com/blog/examples/php-implementing-secure-login-with-php-javascript-and-sessions-without-ssl.html)中代码的略微修改版本，我想通过输入信息并按 Enter 来使表单工作，而不必单击按钮。

仅供参考，我已阅读[此主题](https://stackoverflow.com/questions/239082/javascript-login-form-doesnt-submit-when-user-hits-enter)，但无法从那里得出自己的答案。我尝试将类型从“按钮”更改为“提交”，但登录无效。我也尝试将“onlick”更改为“onsubmit”并且遇到了同样的问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-07T05:27:25.020

使用“提交”类型，但将 onclick 更改为`onclick="loginFunction(); return false;"`

`return false`停止提交按钮实际执行提交。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-07T09:46:09.040

如果您想在单击按钮而不是输入时提交表单，则无需使用 input type="submit" 而不是这个，您可以使用 input type='button' 并在此设置 onclick 函数，例如 input type="button " onclick="my_func()" 并且在这个函数 my_func 的定义中，您可以使用 document.formname.submit() 来提交表单。希望它对你有用。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-01-07T05:26:23.447

使用具有最高索引的按钮设置 html 元素的“标签索引”属性（或在最后一个 html 元素之后向上）

# security - Web 浏览器的哪些方面应该可以通过插件进行配置？

> ID：419288
> 
> 赞同：0
> 
> 时间：2009-01-07T05:29:05.627
> 
> 标签：security, browser, plugins, interface

我是从插件开发人员而不是浏览器用户的角度来看待这个问题，所以我对开发人员认为浏览器插件的理想接口感兴趣。例如：插件可以重新排序、创建和销毁选项卡，插件可以在浏览器页面的前后绘制等。

我特别关心安全方面

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-07T05:37:32.020

一个网络浏览器应该有一个萤火虫插件来帮助开发者。关注安全的浏览器应该阻止网络钓鱼。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-07T05:44:59.883

我立即寻找的主要内容是打开首选项窗格、新窗口和安全首选项变量是多么容易。

我还喜欢遍历选项卡、搜索各个方面的能力，例如每个选项卡中当前显示的页面。

# operating-system - Historical reason behind different line ending at different platforms

> ID：419291
> 
> 赞同：35
> 
> 时间：2009-01-07T05:32:37.133
> 
> 标签：operating-system, history, text-files, line-endings, eol

Why did DOS/Windows and Mac decide to use \r\n and \r for line ending instead of \n? Was it just a result of trying to be "different" from Unix?

And now that Mac OS X is Unix (-like), did Apple switch to \n from \r?

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-01-07T07:16:12.353

DOS inherited CR-LF line endings (what you're calling \r\n, just making the ascii characters explicit) from CP/M. CP/M inherited it from the various DEC operating systems which influenced CP/M designer Gary Kildall.

CR-LF was used so that the teletype machines would return the print head to the left margin (CR = carriage return), and then move to the next line (LF = line feed).

The Unix guys handled that in the device driver, and when necessary translated LF to CR-LF on output to devices that needed it.

And as you guessed, Mac OS X now uses LF.

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2010-01-31T08:23:40.737

Really adding to @Mark Harrison...

The people who tell you that Unix is "just outputting the text the programmer specified" whereas DOS is broken are plain wrong. There are also claims that it's stupid for DOS to flag EOF when it sees an EOF character, raising the question of what exactly that EOF character is for.

There is no one true convention for text file line endings - only platform-specific conventions. After all, even CR-LF, CR and LF aren't the only line end conventions to ever be used, and ASCII was never even the one and only character set. The problem is the C standard library and runtime, which didn't abstract away this platform-dependent detail. Other third generation languages (such as Pascal and even Basic) managed it, at least to some degree. Because of this, when C compilers were written for other platforms, runtime library hacks were needed to achieve compatibility with existing source code and books.

In fact, it's Unix and Multics that originally needed string translation for console I/O, since users usually sat at an ASCII terminal that required CR LF line ends. This translation was done in a device driver, though - the goal was to abstract away the device-specifics, assuming that it was better to adopt one convention and stick to it for stored text files.

The C text I/O hack is similar in principle to what CygWin does now, hacking Linux runtimes to work as well as can be expected on Windows. There's a real history of hacking things about to turn them into Unix-alikes - but then there's also Wine, turning Linux into Windows. Oddly enough, you can read some misplaced line-end criticism of Windows in the [CygWin FAQ](http://web.archive.org/web/20100117052820/http://cygwin.com/faq/faq-nochunks.html#faq.api.cr-lf) (Internet Archive link added 2013 - the page no longer exists). Maybe it's just their sense of humour, since they are basically doing what they are criticising, but on a much grander scale ;-)

~~The C++ standard library (whatever platform its implemented on) avoids this issue using iostreams, which abstract away line ends.~~ For output, that suits me fine. For input, I need more control, so I either interpret character-by-character or else use a scanner generator.

[**EDIT** It turns out that the struck-out claim above isn't true, and never was. The `std::endl` literally translates to a `\n` and a flush. The `\n` is exactly the same `\n` you get in C - it tends to get called "new line", but it's actually an ASCII line feed character, which then gets translated by the runtime if necessary. Funny how false assumptions can get so ingrained you never question them - basically, C++ had no choice to do what C did (other than adding more layers on top) for compatibility reasons, and that should always have been obvious.]

The biggest slice of blame from my POV is with C, but C isn't the only project to fail to anticipate its move to other platforms. Blaming Bill Gates is just nuts - all he did was buy and polish a variant of the then popular CP/M. Really, it's just history - the same reason why we don't know what character codes 128 to 255 refer to in most text files. Given the ease of coping with all three line end conventions, it's odd that some developers still insist on that "my platforms convention is the one true way, and I shall force it on you like it or not" attitude.

Also - will the Unicode line separator codepoint U+2028 replace all these conventions in future text files? ;-)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2010-01-31T09:06:34.143

It's interesting to note the CRLF is pretty much the internet standard. That is, pretty much every standard internet protocol that is line oriented uses CRLF. SMTP, POP, IMAP, NNTP, etc.. The body of email consists of lines terminated by CRLF.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-03-30T21:40:21.937

According to Wikipedia: in the beginning, the program had to put in extra CR characters before the LF to slow the program down so the printer had time to keep up - and CP/M and then later Windows used this method. But Multics's printer driver put in extra characters automatically so the program didn't have to - and Unix developer from that. But none of that explains why the early Mac didn't do that (they do now that they are based on Unix).

[https://en.wikipedia.org/wiki/Newline#History](https://en.wikipedia.org/wiki/Newline#History):

> The sequence CR+LF was commonly used on many early computer systems that had adopted Teletype machines—typically a Teletype Model 33 ASR—as a console device, because this sequence was required to position those printers at the start of a new line. The separation of newline into two functions concealed the fact that the print head could not return from the far right to the beginning of the next line in time to print the next character. Any character printed after a CR would often print as a smudge in the middle of the page while the print head was still moving the carriage back to the first position. "The solution was to make the newline two characters: CR to move the carriage to column one, and LF to move the paper up."[1] In fact, it was often necessary to send extra characters—extraneous CRs or NULs—which are ignored but give the print head time to move to the left margin. Many early video displays also required multiple character times to scroll the display.
> 
> On such systems, applications had to talk directly to the Teletype machine and follow its conventions since the concept of device drivers hiding such hardware details from the application was not yet well developed. Therefore, text was routinely composed to satisfy the needs of Teletype machines. Most minicomputer systems from DEC used this convention. CP/M also used it in order to print on the same terminals that minicomputers used. From there MS-DOS (1981) adopted CP/M's CR+LF in order to be compatible, and this convention was inherited by Microsoft's later Windows operating system.
> 
> The Multics operating system began development in 1964 and used LF alone as its newline. Multics used a device driver to translate this character to whatever sequence a printer needed (including extra padding characters), and the single byte was more convenient for programming. What seems like a more obvious[citation needed] choice—CR—was not used, as CR provided the useful function of overprinting one line with another to create boldface and strikethrough effects. Perhaps more importantly, the use of LF alone as a line terminator had already been incorporated into drafts of the eventual ISO/IEC 646 standard. Unix followed the Multics practice, and later Unix-like systems followed Unix. This created conflicts between Windows and Unix-like OSes, whereby files composed on one OS cannot be properly formatted or interpreted by another OS (for example a UNIX shell script written in a Windows text editor like Notepad).

# c# - 匹配来自两个列表（或数组）的项目

> ID：419295
> 
> 赞同：30
> 
> 时间：2009-01-07T05:35:23.850
> 
> 标签：c#, .net, arrays, list

我的工作有问题，希望可以减少到以下问题：我有两个`List<int>`s，我想看看是否有任何`int`s in`ListA`等于任何`int`in `ListB`。（如果这让生活更轻松，它们可以是数组，但我认为`List<>`有一些内置的魔法可能会有所帮助。）而且我确信这是一个 LINQ 友好的问题，但我在这里使用 2.0。

到目前为止，我的解决方案是`foreach`通过 ListA，然后`foreach`通过 ListB，

```
foreach (int a in ListA)
{
    foreach (int b in ListB)
    {
        if (a == b)
        {
            return true;
        }
    }
} 
```

当它们每三个项目长时实际上非常光滑，但现在它们有 200 长并且它们经常不匹配，所以我们得到了 N^2 比较的最坏情况。即使是 40,000 次比较也很快，但我想我可能会遗漏一些东西，因为 N^2 对于这个特定问题似乎很幼稚。

谢谢！

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2009-01-07T06:05:24.070

使用[LINQ](http://msdn.microsoft.com/en-us/library/bb397926.aspx)，这很简单，因为您可以调用[类的](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.aspx)[`Intersect`扩展方法](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.intersect.aspx)来为您提供两个数组的集合交集：[`Enumerable`](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.aspx)

```
var intersection = ListA.Intersect(ListB); 
```

但是，这是*集合*交集，这意味着如果`ListA`其中`ListB`没有唯一值，您将不会得到任何副本。换句话说，如果您有以下情况：

```
var ListA = new [] { 0, 0, 1, 2, 3 };
var ListB = new [] { 0, 0, 0, 2 }; 
```

然后`ListA.Intersect(ListB)`产生：

```
{ 0, 2 } 
```

如果您期待：

```
{ 0, 0, 2 } 
```

然后，您将不得不自己维护项目的计数，并在扫描两个列表时进行产量/减量。

首先，您需要收集[`Dictionary<TKey, int>`](http://msdn.microsoft.com/en-us/library/xfhwa508.aspx)带有单个项目列表的 a：

```
var countsOfA = ListA.GroupBy(i => i).ToDictionary(g => g.Key, g => g.Count()); 
```

`ListB`当您遇到以下项目时，您可以从那里扫描并将其放置在列表中`countsOfA`：

```
// The items that match.
IList<int> matched = new List<int>();

// Scan 
foreach (int b in ListB)
{
    // The count.
    int count;

    // If the item is found in a.
    if (countsOfA.TryGetValue(b, out count))
    {
        // This is positive.
        Debug.Assert(count > 0);

        // Add the item to the list.
        matched.Add(b);

        // Decrement the count.  If
        // 0, remove.
        if (--count == 0) countsOfA.Remove(b);
    }
} 
```

您可以将其包装在延迟执行的扩展方法中，如下所示：

```
public static IEnumerable<T> MultisetIntersect(this IEnumerable<T> first,
    IEnumerable<T> second)
{
    // Call the overload with the default comparer.
    return first.MultisetIntersect(second, EqualityComparer<T>.Default);
}

public static IEnumerable<T> MultisetIntersect(this IEnumerable<T> first,
    IEnumerable<T> second, IEqualityComparer<T> comparer)
{
    // Validate parameters.  Do this separately so check
    // is performed immediately, and not when execution
    // takes place.
    if (first == null) throw new ArgumentNullException("first");
    if (second == null) throw new ArgumentNullException("second");
    if (comparer == null) throw new ArgumentNullException("comparer");

    // Defer execution on the internal
    // instance.
    return first.MultisetIntersectImplementation(second, comparer);
}

private static IEnumerable<T> MultisetIntersectImplementation(
    this IEnumerable<T> first, IEnumerable<T> second, 
    IEqualityComparer<T> comparer)
{
    // Validate parameters.
    Debug.Assert(first != null);
    Debug.Assert(second != null);
    Debug.Assert(comparer != null);

    // Get the dictionary of the first.
    IDictionary<T, long> counts = first.GroupBy(t => t, comparer).
        ToDictionary(g => g.Key, g.LongCount(), comparer);

    // Scan 
    foreach (T t in second)
    {
        // The count.
        long count;

        // If the item is found in a.
        if (counts.TryGetValue(t, out count))
        {
            // This is positive.
            Debug.Assert(count > 0);

            // Yield the item.
            yield return t;

            // Decrement the count.  If
            // 0, remove.
            if (--count == 0) counts.Remove(t);
        }
    }
} 
```

请注意，这两种方法都是（如果我在这里使用 Big-O 表示法，我深表歉意）第一个数组中的项目数是`O(N + M)`哪里，第二个数组中的项目数是哪里。您只需扫描每个列表一次，并且假定获取哈希码并在哈希码上执行查找是一个（恒定的）操作。`N``M``O(1)`

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-01-07T05:43:38.640

将整个 ListA 加载到 HashSet 实例中，然后针对 HastSet 测试 ListB 中的每个项目：我很确定这将是 O(N)。

```
//untested code ahead
HashSet<int> hashSet = new HashSet<int>(ListA);
foreach (int i in ListB)
{
    if (hashSet.Contains(i))
        return true;
} 
```

这是一行中的相同内容：

```
return new HashSet<int>(ListA).Overlaps(ListB); 
```

HashSet 在 .NET 3.5 中不存在，因此在 .NET 2.0 中您可以使用`Dictionary<int,object>`（而不是使用`HashSet<int>`），并且始终将 null 作为对象/值存储在 Dictionary 中，因为您只对键感兴趣。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-07T05:53:51.910

不要遍历每个列表，而是看一下[List.Contains](http://msdn.microsoft.com/en-us/library/bhkz42b3(VS.80).aspx)方法：

```
foreach (int a in ListA)
{
  if (ListB.Contains(a))
    return true;
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-07T06:04:59.423

Chris 通过散列给出了一个 O(N) 的解决方案。现在，根据常数因子（由于散列），可能值得通过排序考虑 O(N log(N)) 解决方案。根据您的用例，您可以考虑几种不同的变体。

1.  对 ListB 排序（ O(N log(N) ），并使用搜索算法解析 ListA 中的每个元素（同样是 O(N) * O(log(N))）。

2.  对 ListA 和 ListB 进行排序（ O(N log(N) ），并使用 O(N) 算法比较这些列表的重复项。

如果要多次使用这两个列表，则首选第二种方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-07T05:39:48.180

使用 BinarySearch 方法而不是遍历内部循环中的所有元素怎么样？

# linux - Windows 开发人员如何最轻松地让他的软件在 Wine 下正常工作

> ID：419312
> 
> 赞同：10
> 
> 时间：2009-01-07T05:40:39.783
> 
> 标签：linux, unix, cross-platform, wine

我的许多用户一直告诉我，他们希望在他们的 Linux 机器上使用 Wine 运行我的软件。

但我是一名几乎没有 Linux 经验的 Windows 开发人员。

现在我可以花一两个月的时间安装 Linux，学习 Linux，安装 Wine，学习 Wine，并彻底确保我的应用程序在 Wine 下运行良好。但我仍在为 Windows 开发，所以我现在不想花太多时间进行开发。

那么我能做些什么而不费力气让我的程序在 Wine 下尽可能好地运行呢？

* * *

我确实找到[了有关在 Wine 下运行应用程序的一般帮助](http://appdb.winehq.org/help/?sTopic=generic)。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-07T09:57:59.763

从 VMWare 站点下载[VMWare](http://www.vmware.com/products/player/)和[Ubuntu 虚拟机](http://www.vmware.com/appliances/directory/1224)（Ubuntu 是一种流行的 Linux 发行版）。这将在您的 Windows 环境中为您提供一个正常工作的 Linux O/S，而无需手动安装 Linux。

然后，您可以使用[此处](https://help.ubuntu.com/community/Wine)的说明安装 Wine，该 Wiki 页面还为您提供了一些有关如何使用它的说明。

如果您按照 Adam Rosenfield 的建议，尝试在未修改的 Wine 中运行您的应用程序，您将能够快速确定是否存在问题。我的猜测是有一些，否则您的用户不会就此与您联系:)

在 Wine 中获得调试应用程序的帮助有很多方法，请查阅[网站](http://www.winehq.org/help/)以获取选项并选择一些适合您的方法。与往常一样，最好不要依赖单一渠道进行沟通。

此外，如果您更习惯在 Windows 中进行开发，使用虚拟机的方法将允许您像往常一样在 Windows 中编译代码并将二进制文件复制到虚拟机中进行测试（Ubuntu 支持浏览/挂载 Windows 共享）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-07T05:47:03.110

只要您没有做任何不寻常的事情，例如玩弄硬件或在未记录的 API 调用和数据结构中四处寻找，您应该能够在 Wine 下运行您的代码，而只需很少或无需修改。Wine 有一个相当完整的公共 Windows API 实现，所以如果你的程序运行良好并且不会乱七八糟，它应该可以工作。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-07T05:45:56.340

不要使用太多的 Windows API！不要使用微软的任何新东西；）

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-07T15:05:05.730

避免使用 WPF 是#1 建议。

但是在 Wine 下测试你的应用程序真的不会杀死你。尝试并不难；当然不会需要几个月的时间。例如：

使用[http://www.ubuntu.com/getubuntu/downloadmirrors#wubi](http://www.ubuntu.com/getubuntu/downloadmirrors#wubi)将 Ubuntu 安装到 Windows 机器上的文件中，然后启动 ubuntu 并从 [http://winehq.org/download/deb](http://winehq.org/download/deb)安装最新的 Wine 然后尝试运行您的应用程序的安装程序。如果它不起作用，请查看 Wine 常见问题解答，在其中一个 wine 论坛中寻求帮助，和/或在 wine 的错误跟踪器中提交错误。

从死机开始到试用安装程序大约需要三个小时。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-09T06:33:40.830

当我的一个 Delphi5 应用程序刚刚从 zip 中运行时，我感到相当惊讶。

唯一真正可行的方法是自己动手，即按照 Sean 的建议安装 vmware 和 linux 发行版。Linux 实际上并不难，我们都在这里提供帮助。

完成快速测试后，我可以确认它在很大程度上有效。启动过程中有一个ACCVIO读取0x34，可以忽略错误对话框并运行应用程序，我打开了Steve McCarthy GEDCOM。

[截屏](http://chateau-logic.com/images/behold-screenshot-linux)

这是在 VMWare 下使用 MEPIS 7.9.94-rc1_32 下的 Wine 1.1.12。强烈建议将 VMWare 用于此类事情。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-07T05:46:47.260

你用什么语言/平台开发？取决于它是什么，让它在本地运行应该没有问题。例如，如果您使用 Java 或 Python，它们都可以在 Linux 上运行得非常干净。同样，如果您是 .NET 开发人员，您应该能够在一定程度上让您的应用程序在 Mono 中运行。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-09-09T06:11:24.250

查找 Linux beta 测试人员。它可以向 WINE 开发人员报告错误或在您的应用程序中查找错误。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-12-15T16:26:41.173

Wine 比 Windows 对错误更敏感。例如，Wine 会在 NULL 窗口句柄上崩溃，并且如果类无效，则无法创建窗口，而 Windows 更健壮，只会规避错误。

这是清理代码的机会。

在我第一次尝试时，我对 Wine 运行我的应用程序的效果感到惊讶。但是，我必须摆脱基于第三方驱动程序的组件。

# java - 使用 jar 归档时头文件无效

> ID：419314
> 
> 赞同：8
> 
> 时间：2009-01-07T05:40:53.467
> 
> 标签：java, jar

当我使用这个 cmd 行时： jar cmf arshad.mf ars.jar *.class 我得到这个错误：

```
invalid header field name:Manifest-version 
```

这是我的清单文件：

```
Manifest-Version: 1.0
Main-Class:t 
```

我用 UTF-8 编码的记事本制作了清单文件 - 清单有什么问题吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-01-07T05:44:23.817

在冒号后添加一个空格：

```
Manifest-Version: 1.0
Main-Class: t 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T13:41:52.477

是的，它是真实的。

人们在为 jar 编写清单文件时常犯的一个错误是，他们没有在冒号后放置空格。我不知道，根据您在这里写的内容，是否是这样，但请尝试一下。

例子：

```
Main-Class:someClass //wrong
Main-Class: someClass //correct 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-06-04T20:38:41.840

此外，您的清单文件必须保存为 UTF-8。在 MS 记事本上写入并保存为 UTF-8 编码不一定安全。这篇文章有一些很好的细节：

[使用 Eclipse 将清单添加到 JAR 时标头字段名称无效](https://stackoverflow.com/questions/13320631/invalid-header-field-name-when-adding-manifest-to-jar-using-eclipse)

记事本在前面添加了一些字节以广播数据的字节序。这将破坏 jar 命令。一个不错的解决方案是不使用记事本并下载记事本++。在 Notepad++ 中，您从顶部栏中选择“编码”，然后选择“不带 BOM 的 UTF-8”。应用此设置保存清单文件应该可以解决问题。如果没有其他人。

# git - 在版本控制下处理系统特定信息的最佳实践是什么？

> ID：419322
> 
> 赞同：6
> 
> 时间：2009-01-07T05:46:13.283
> 
> 标签：git, version-control, configuration-files

我是版本控制的新手，所以如果有一个众所周知的解决方案，我深表歉意。特别是对于这个问题，我正在使用 git，但我很好奇如何为所有版本控制系统处理这个问题。

我正在开发服务器上开发 Web 应用程序。我在两个地方定义了 Web 应用程序（不是文档根目录）的绝对路径名。在生产服务器上，这条路径是不同的。我很困惑如何处理这个问题。

我可以：

1.  重新配置开发服务器以与生产服务器共享相同的路径
2.  每次更新产品时编辑这两个事件。

我不喜欢#1，因为我宁愿让应用程序灵活应对未来的任何变化。我不喜欢#2，因为如果我开始在具有第三条路径的第二个开发服务器上进行开发，我将不得不在每次提交和更新时更改它。

处理这个问题的最佳方法是什么？我想到了：

1.  使用自定义关键字和变量扩展（例如在版本控制属性中设置属性 $PATH$ 并在所有文件中扩展它）。Git 不支持这一点，因为这会对性能造成巨大影响。

2.  使用更新后和预提交挂钩。可能是 git 的可能解决方案，但每次我查看状态时，它都会报告这两个文件正在更改。不是很干净。

3.  从版本控制之外的配置文件中提取路径。然后我必须将配置文件放在所有服务器上的相同位置。还不如从相同的路径开始。

有没有简单的方法来处理这个问题？我是不是想多了？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-07T06:44:24.367

不要对文件系统路径等配置数据进行硬编码并强制多个部署匹配。那是黑暗的一面，那里有很多痛苦。

我发现构建我的系统以轻松支持多种配置很有用且容易，我经常将配置文件并排提交到源代码管理中，但是生产的被混淆了（没有真正的密码）并且开发的被模板化了（所以结帐可以' t 覆盖开发人员的配置）。代码始终以与配置无关的方式打包——相同的二进制文件可以部署在任何地方。

不幸的是，大多数语言/开发平台都不容易支持这一点（与 Ruby on Rails 不同）。因此，您必须在不同程度上自己构建它。

一般来说，基本原则是在你的配置中加入间接：在你的代码中指定的不是配置，而是如何找到配置。并且通常会调用几种间接方式：特定于用户的、特定于应用程序的、特定于机器的、特定于环境的。每个都应该以明确定义的位置/方式找到，并且它们之间应该有一个非常明确的优先级（通常是用户优先于机器优先于应用程序优先于环境）。您通常会发现每个可配置设置在一个位置都有一个自然归宿，但不要将该依赖项硬编码到您的应用程序中。

我发现设计应用程序以报告其配置并对其进行验证是非常有价值的。在大多数情况下，缺少或无效的配置项会导致应用程序中止。尽可能在启动时执行验证（和中止）=快速失败。只有在可以可靠地使用硬代码默认值时。

抽象配置访问，以便大多数应用程序不知道它来自哪里或如何处理它。我更喜欢创建`Config`将可配置设置公开为单独属性（相关时强类型化）的类，然后我通过 IOC 将它们“注入”到应用程序类中。不要让所有应用程序类直接调用所选平台的原始配置框架；抽象是你的朋友。

在大多数企业级（财富 500 强）组织中，除了该环境的管理团队之外，没有人看到生产（甚至测试）环境配置。配置文件永远不会部署在版本中，它们是由管理团队手工编辑的。相关的配置文件肯定永远不会与代码并排检查到源代码控制中。管理团队可能会使用源代码控制，但它是他们自己的私有存储库。Sarbanes-Oxley 和类似法规也倾向于严格禁止开发人员对（近）生产系统或任何敏感配置数据进行一般访问。在设计方法时要注意。

享受。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-07T07:27:58.897

您应该始终将历史记录（源代码管理的用途）与部署分开。

部署涉及：

*   一组已识别的数据（SCM 提供的标签或标签派上用场）
*   处理这些数据的过程（至少将它们复制到正确的位置，还可以扩展一些压缩文件，等等......）

在部署执行的各种操作中，您应该包括一个**去变量化**阶段。

变量是一个关键字，表示可能会根据您的部署平台（可以是用于持续集成的 PC、用于基本认证的 linux、用于预生产认证的旧 Solaris8 以及带有生产区域的完整 F15K Solaris10）的关键字：它很短，它可以变化很大）。有关实际示例，请参阅[Jonathan Leffler 的答案](https://stackoverflow.com/questions/419322/whats-the-best-practice-for-handling-system-specific-information-under-version-c#419428)。

变量可以表示路径、JVM 版本、一些 JVM 设置等，您放入 SCM 中的应该是其中包含变量的数据，而不是硬编码设置。

The next step would be to include in your executable a way to detect any change in a setting files in order to update while running some parameters (avoiding the the all "shutdown / change settings / restart" sequence).
That means they are **two types of deployment variables**:

*   **static** ones (which will never change),
*   **dynamic** ones (which should be ideally taken into account during the runtime session)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-07T06:55:36.170

尽可能避免使用绝对路径。

不要依赖你当前的版本控制来做一些神奇的事情——你将来可能会改变版本控制系统。

最简单的方法对我有用：有一个“config.live”，并且为开发配置了“config”。在部署期间，只需将 config.live 移动到 config 就可以了。对于更复杂的配置，可能需要每个配置的子目录。

一套部署程序是必不可少的——因为配置只是一个不同的领域。

任何更复杂的东西几乎肯定会导致比它解决的问题更多的问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-07T08:17:16.567

Use an SCM such as Git for version control and a deployment tool [such as Capistrano for deployment](http://capify.org/getting-started/from-the-beginning). Although Capistrano was initially created for Ruby on Rails it's perfectly fine to use it for other frameworks and languages.

The main thing is that a specific deployment tool will give you all flexibility to automate things like paths on both ends.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-07T06:07:40.447

我喜欢 Ruby on Rails 处理这类问题的方式——特定于环境的配置文件。Rails 支持开发、测试和生产数据库连接——由 database.yml 文件中的配置控制。这是一篇关于创建其他特定于环境的配置选项的博客文章，它适用于 Rails，但可能会给你一些关于如何为你的环境做类似事情的想法。[http://usablewebapps.com/2008/09/yaml-and-custom-config-for-rails-projects/](http://usablewebapps.com/2008/09/yaml-and-custom-config-for-rails-projects/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-07T06:38:53.410

听起来您的生产代码是完整的 git 存储库，并且要更新生产，您会执行`git pull`? 您可能想尝试一个单独的构建过程，从存储库中检查代码并创建一个干净的构建（没有 .git 文件夹）。您可以拥有特定于环境的配置文件，其中包含与它一起复制或创建的路径。

# c# - .NET 中的 MD5 生成有多贵？

> ID：419327
> 
> 赞同：7
> 
> 时间：2009-01-07T05:49:29.750
> 
> 标签：c#, .net, asp.net, performance, md5

为了与外部数据源交互，我需要传递一个经过 MD5 散列的滚动安全密钥（每天我们都需要生成一个新的 MD5 散列密钥）。

每次我们调用外部提要时，我都会权衡是否这样做。我需要有一个大约 10 个字符的字符串作为提要。

它适用于 ASP.NET (C#/ .NET 3.5) 站点，并且几乎每个页面都使用提要。我最好每天生成一次散列，然后将其存储在应用程序缓存中，并获取内存命中，还是在每次请求时生成它？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-07T06:28:43.883

唯一可接受的优化基础是数据。测量生成此内联并测量缓存它。

我的高端工作站可以在一秒钟内计算出超过 10 万个 10 字节数据段的 MD5 哈希值。缓存这个对我来说是零好处，我敢打赌对你来说也是一样的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-07T06:22:26.860

生成一些样本数据。嗯，很多。计算样本数据的 MD5。测量所需的时间。自己决定。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-07T06:46:29.450

**计算算法的时间复杂度！**

看下面的代码：

```
 public string GetMD5Hash(string input)
    {
        System.Security.Cryptography.MD5CryptoServiceProvider x = new System.Security.Cryptography.MD5CryptoServiceProvider();
        byte[] bs = System.Text.Encoding.UTF8.GetBytes(input);
        bs = x.ComputeHash(bs);
        System.Text.StringBuilder s = new System.Text.StringBuilder();
        foreach (byte b in bs)
        {
            s.Append(b.ToString("x2").ToLower());
        }
        string password = s.ToString();
        return password;
    } 
```

如果我们要计算时间复杂度，我们会得到 T= 11 + n * 2 但这只是“我们所看到的”，即 ToLower 可能会做一些我们不知道的繁重工作。但是从这一点我们可以看出，这个算法在所有情况下都是 O(n)。意味着时间随着数据的增长而增长。

另外为了解决缓存问题，我宁愿在内存中进行“繁重”的工作，因为与 CPU 使用相比，内存更便宜。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-07T06:30:23.880

如果在给定的一天缓存中它是相同的，那可能是一个想法。您甚至可以将缓存设置为 24 小时，并编写代码以在缓存过期时重新生成哈希

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-07T07:44:13.543

使用 Asp.Net 缓存非常容易，所以我不明白为什么不应该缓存密钥。

将密钥存储在缓存中甚至可以节省一些内存，因为您可以重复使用它，而不是为每个请求创建一个新的。

# c++ - 当键盘日志不可用时如何记录击键？

> ID：419328
> 
> 赞同：0
> 
> 时间：2009-01-07T05:50:14.507
> 
> 标签：c++, windows-vista, journaling

最初使用 MS 特定的键盘日志挂钩 (WH_JOURNALRECORD) 设置 C++ 应用程序后，我们发现它无法在 Vista 上运行，除非以管理员身份运行并启用 uiAccess。[MSDN 问题 - Vista 上的日志挂钩？](http://social.msdn.microsoft.com/forums/en-US/windowssecurity/thread/3dc0a67e-c2f0-4e70-8990-3a6947f1155a/)

我们希望以一种友好的方式记录来自用户的键序列，该序列将在以后重复。用户按下录制按钮，将显示一个带有停止按钮和录制键的对话框。

使用日志钩子的一个优点是你只得到了做某事的击键。按住 shift 键并没有报告 100 个 shift 键，但是当你敲击一个字母时确实报告了使用情况。另一个优点是您可以将焦点设置到应用程序之外的区域，例如另一个应用程序窗口，并在用户交互时记录操作。

除了将现有应用程序的键盘捕获部分作为单独的可执行文件以管理员身份使用 uiAccess 运行之外，我还在寻求其他想法，了解如何记录在 2K、2K3、2K8、XP、Vista 的 Windows 上工作的击键。

编辑：我知道仅记录任何内容都会存在安全问题，显然，如果您可以在没有用户注意到的情况下执行此类操作，则您拥有用于黑客攻击的典型击键记录器。呜呜呜……

有没有办法让这个用户和他们的应用程序在相同级别（或更低级别）运行并捕获击键？让它弹出 vista 安全性，你确定对话框没问题，但该进程不能用 uiAccess 标记（否则它不会与系统的其余部分正确交互），并且在 98% 的情况下它将由用户运行而无需提升为管理员的权限。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-08T12:26:53.613

即使可以，您也可能会发现 Microsoft 在下一个补丁中修复了该错误。Vista 中的更改是有意的，并且有一个明确的方法 (uiAccess==true) 仍然可以做你想做的事。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-03T07:26:03.940

我们已经通过使用 SetWindowsHook 解决了主要问题。

```
const HMODULE hDLL = ::GetModuleHandle(DLL_NAME);
::SetWindowsHookEx(WH_KEYBOARD_LL, myKeyboardProcCallback, hDLL, 0); 
```

回调现在必须管理击键信息并将其转换为可用序列 - 即不要记录多次按下 ctrl 按下 ctrl + 键。

# python - 如何在其他平台上完成系统托盘应用程序？

> ID：419334
> 
> 赞同：11
> 
> 时间：2009-01-07T05:55:55.057
> 
> 标签：python, cross-platform, operating-system, wxpython, system-tray

Windows 有一个“系统托盘”，其中包含时钟和 MSN、Steam 等始终运行的服务。

我想开发一个 wxPython 托盘应用程序，但我想知道这将如何移植到其他平台。每个平台上对应的托盘是多少，以及需要多少手动工作才能支持 Windows、OSX 和 Linux（尤其是哪些 shell 最友好）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-07T07:01:31.603

wx 是一个跨平台的 GUI 和工具库，支持 Win32、Mac OS X、GTK+、X11、Motif、WinCE 等。如果您使用它的类，那么您的应用程序应该可以在所有这些平台上运行。对于系统托盘，请查看 wxTaskBarIcon ( [http://docs.wxwidgets.org/stable/wx_wxtaskbaricon.html#wxtaskbaricon](http://docs.wxwidgets.org/stable/wx_wxtaskbaricon.html#wxtaskbaricon) )。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-07T07:34:54.547

在 OS X 下，您有状态菜单栏 - 最右侧的项目通常是与状态相关的内容（如电池状态、WiFi 连接等）。

尝试搜索[NSStatusBar](http://developer.apple.com/documentation/Cocoa/Reference/ApplicationKit/Classes/NSStatusBar_Class/Reference/Reference.html)和[NSMenuExtra](http://www.cocoadev.com/index.pl?NSMenuExtra)。将一个应用程序变成一个具有 NSStatusBar 菜单并且不出现在 Dock 中的应用程序几乎是微不足道的。有[关于](http://files.semaja2.net/NSStatusItem%20-%20ObjC.html)如何做到这一点的[教程。](http://www.mactech.com/articles/mactech/Vol.22/22.02/Menulet/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-07T07:00:14.287

对于许多 Linux 桌面系统（Gnome、KDE ​​等），实现了 Freedesktop 的[SysTray 协议](http://standards.freedesktop.org/systemtray-spec/systemtray-spec-latest.html)。如果任何其他解决方案失败，您可以尝试。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-07T06:39:42.193

在 Linux 上，这真的取决于 - 你在那里有不同的编程环境，一些窗口管理器甚至没有托盘区域。尽管如此，如果您使用 Gtk（并且 wx 确实是 Gtk），那么[gtk.StatusIcon](http://www.pygtk.org/docs/pygtk/class-gtkstatusicon.html)就是您的朋友。

[以下](http://marcin.af.gliwice.pl/if-then-else-20070121143245)是一些示例（尚未检查它们是否真的有效，但应该向您展示路径）。

因为我在[这里](http://markmail.org/message/27uwfecsmmpeyoey)`wx`找到了一些示例代码。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-07T10:12:14.337

使用 Qt：[Qt 系统托盘示例](http://doc.trolltech.com/4.2/desktop-systray.html)

这将在运行 Qt 并支持此类图标的所有平台上显示一个系统托盘图标。但是，当不支持系统托盘功能时，您需要制定策略。

# sql-server - 为什么我得到“服务器在编译时遇到堆栈溢出”错误是 SQL Server 2000 Sp4

> ID：419336
> 
> 赞同：0
> 
> 时间：2009-01-07T05:57:15.663
> 
> 标签：sql-server

我试图在此查询中有大约 6290 个“与”条件。对于大约 11945 'OR' 条件，我得到相同的结果。

异常详细信息：服务器在编译期间遇到堆栈溢出。在 System.Data。lClient.SqlConnection.OnError(SqlException 异常，布尔型 breakConnection) 在 System.Data.SqlClient.SqlInternalConnection.OnError(SqlException 异常，布尔型 breakConnection)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-07T07:42:57.540

尝试优化您的 AND/OR 条件。

```
SELECT * FROM foo
WHERE ([fooKey] = 1 AND Year = 1995)
OR ([fooKey] = 1 AND Year = 1996)
OR ([fooKey] = 1 AND Year = 1997)
OR ([fooKey] = 1 AND Year = 1998)
OR ([fooKey] = 1 AND Year = 1999)
OR ([fooKey] = 1 AND Year = 2000)
OR ([fooKey] = 1 AND Year = 2001)
OR ([fooKey] = 1 AND Year = 2002)
... ad infinitum 
```

变成

```
SELECT * FROM fooWHERE ([fooKey] = 1 AND Year between 1995 and 2002)
union
SELECT * FROM fooWHERE ([fooKey] = 10017 AND Year = 1995)
union
SELECT * FROM fooWHERE ([fooKey] = 10018 AND Year = 1997)
... slightly less 
```

或者转到 64 位并尝试添加足够的内存以防止这种情况发生......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-07T06:03:20.080

有趣的错误！要问你的明显问题是，*为什么？* 堆栈溢出是因为递归是解析这样的 SQL 语句的典型方法，它构建了一个语法树。根据每次递归调用压入堆栈的内容，这并不奇怪。它伤害了服务器吗？;)

# c# - 我们可以访问可重用的 DaysOfWeek 控件吗？

> ID：419339
> 
> 赞同：0
> 
> 时间：2009-01-07T05:57:46.880
> 
> 标签：c#, winforms, windows-mobile

只是想知道我们是否可以访问 PocketOutlook DaysOfWeek 控件/编辑器，或者是否有人免费使用了自己的控件/编辑器。

我正在寻找与 Outlook 日历约会重复出现模式编辑器中的内容完全相同的内容。

1.  打开日历
2.  创建一个新约会
3.  单击“发生”，然后单击“< 编辑图案... >”
4.  点击下一步”
5.  具有 SMTWTFS 的控件，您可以在其中点击当天的方块以启用/禁用，或使用硬件键进行导航。

- 更新 - - - - - - - - - - - -

嗯，我刚刚推出了自己的 Control。

不太难，我只使用了 7 个带有点击处理程序的 LinkLabels。实际上，最困难的部分是在它周围设置边框（使用手动定位将白色链接标签放在黑色面板内）。不知何故，.NET CF 设计者认为我们不需要 BORDERS，这太荒谬了。

我使用 Value 属性和 ValueChanged 事件公开了 DaysOfWeek 值。Presto，DaysOfWeek 控件！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-07T06:36:39.267

这些只是复选框控件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-07T18:45:46.813

这是我自制控件的一些代码片段：

```
public partial class DaysOfWeekPicker : UserControl
{
    public event EventHandler ValueChanged;

    private DaysOfWeek myValue;

    [DefaultValue (0)]
    public DaysOfWeek Value
    {
        get { return myValue; }
        set { myValue = value; RefreshData (); }
    }

    public DaysOfWeekPicker ()
    {
        InitializeComponent ();
    }

    private void DayOfWeekClick (object sender, EventArgs e)
    {
        if (Object.ReferenceEquals (sender, g_l_Sunday))
        {
            this.Value = this.Value ^ DaysOfWeek.Sunday;
        }
        else if (Object.ReferenceEquals (sender, g_l_Monday))
        {
            this.Value = this.Value ^ DaysOfWeek.Monday;
        }
        else if (Object.ReferenceEquals (sender, g_l_Tuesday))
        {
            this.Value = this.Value ^ DaysOfWeek.Tuesday;
        }
        else if (Object.ReferenceEquals (sender, g_l_Wednesday))
        {
            this.Value = this.Value ^ DaysOfWeek.Wednesday;
        }
        else if (Object.ReferenceEquals (sender, g_l_Thursday))
        {
            this.Value = this.Value ^ DaysOfWeek.Thursday;
        }
        else if (Object.ReferenceEquals (sender, g_l_Friday))
        {
            this.Value = this.Value ^ DaysOfWeek.Friday;
        }
        else if (Object.ReferenceEquals (sender, g_l_Saturday))
        {
            this.Value = this.Value ^ DaysOfWeek.Saturday;
        }
    }

    private void RefreshData ()
    {
        SetLabelDisplay (g_l_Sunday, (this.Value & DaysOfWeek.Sunday) == DaysOfWeek.Sunday);
        SetLabelDisplay (g_l_Monday, (this.Value & DaysOfWeek.Monday) == DaysOfWeek.Monday);
        SetLabelDisplay (g_l_Tuesday, (this.Value & DaysOfWeek.Tuesday) == DaysOfWeek.Tuesday);
        SetLabelDisplay (g_l_Wednesday, (this.Value & DaysOfWeek.Wednesday) == DaysOfWeek.Wednesday);
        SetLabelDisplay (g_l_Thursday, (this.Value & DaysOfWeek.Thursday) == DaysOfWeek.Thursday);
        SetLabelDisplay (g_l_Friday, (this.Value & DaysOfWeek.Friday) == DaysOfWeek.Friday);
        SetLabelDisplay (g_l_Saturday, (this.Value & DaysOfWeek.Saturday) == DaysOfWeek.Saturday);

        if (this.ValueChanged != null) this.ValueChanged (this, EventArgs.Empty);
    }

    private void SetLabelDisplay (LinkLabel label, bool enabled)
    {
        if (enabled)
        {
            label.BackColor = Color.Black;
            label.ForeColor = Color.White;
        }
        else
        {
            label.BackColor = Color.White;
            label.ForeColor = Color.Black;
        }
    }
} 
```

可能有更好的方法来进行价值比较，但这正是我很快想到的。

至于它的设计部分，我不会把它放在这里，因为它很冗长，但它相当简单。每一天都由一个 LinkLabel 表示，点击事件设置为 DayOfWeekClick。每个 LinkLabel 位于 (1,1) 处，并且在两个维度上都比父面板小 2 个像素。每个父面板都有一个黑色的前景色，提供边框效果。每个Panel设置为DockStyle.Left，整体控件大小相当于panel.Width * 7，panel.Height。

# php - PHP类：需要帮助继承两个类

> ID：419342
> 
> 赞同：3
> 
> 时间：2009-01-07T05:58:24.287
> 
> 标签：php, class, oop

在设计需要从多个类扩展的 PHP 类时，我需要帮助。

我有一个通用类 Pagination.php，它执行各种分页和排序。所有其他类将使用它进行分页。

为了让我的生活更轻松，我制作了一个从 MySQL 表生成类的类生成器。所有的属性、getter、setter 和常用方法都是自动创建的，真正节省了时间和金钱。

例如，Staff_Base.php 中的 Staff_Base 类是从 SQL 表 t_staff 自动生成的。

由于 Staff_Base 类是从 SQL 表中自动生成的，因此任何“自定义”方法/属性都位于另一个扩展 Staff_Base.php 的类中。（这样每当添加一个新字段时，我就可以简单地重新生成 Staff_Base 类并在 Staff_Base.php 中覆盖）。

所以我有扩展 Staff_Base.php 的类 Staff.php。

问题是，Staff.php 还需要扩展另一个类 Pagination.php。（目前的解决方法是将 Pagination.php 中的方法放入每个类中。每当我更改分页/排序方法时，这真的很麻烦。）

我该怎么做呢？实现这一目标的最佳设计模式是什么？

我知道重组课程的常见建议，但我真的很想其他解决方法/解决方案。此外，我可能还需要扩展 Pagination.php 以外的其他类。

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-07T06:04:48.767

你可以让你生成的 Staff_Base 类继承自 Pagination 吗？或者 Staff_Base 是否已经从另一个基类（您无法控制）继承...

听起来像 Doctrine 或 Propel，我不记得哪个使用 *_Base 类系统。

我的建议是重写分页以供您的实体类使用，而不是要求您的实体类对其进行扩展。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-07T06:09:15.093

因此，如果我正在阅读您正确编写的内容，因为您不能从 2 个类继承，所以您将分页复制到您拥有的每个类中。

类堆叠是一种解决方案。[我用谷歌搜索](http://www.serversidemagazine.com/php/how-to-inherit-from-multiple-objects-workaround)的第一件事。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-07T06:05:09.220

我建议更改您的`Staff_Base.php`生成器以使该类默认扩展分页。这种方式`Staff`延伸`Staff_Base`和`Staff_Base`延伸`Pagination`。我认为这可能是获得所需结果的最简洁（也是最面向对象）的方式。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-07T06:01:18.010

你不能，php中不支持多重继承，但是如果你在这个主题上进行谷歌搜索，你可以找到一些解决方法......

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-01-06T22:23:55.333

听起来你在这里把事情搞混了。一个类（例如 Staff 类）用于表示单个实体。例如：

```
$john = new Staff('John'); 
```

分页到底是如何适应这个的？可分页（可分页？）听起来像是允许访问这些员工实体的任何属性，而不是实体本身的属性。这样，您创建的从基类继承的每种类型的 Staff 类的方式就很清楚了。

所以，我相信你需要的解决方案是：

1.  一个 Staff 类（Staff_Base 及其子图）
2.  员工数据访问对象（如果您使用命名空间，DAO\Staff 将是一个不错的名称）
3.  一个接口，向世界发出一个 DAO 可以被分页的信号

需要注意的是DAO类和Staff类之间没有直接的继承关系。您仍然可以根据其在数据库中的属性生成 Staff_Base 类，并从那里扩展......只要您不包括该类中的实际数据访问。

使用它的代码将如下所示：

```
 <?php
 $staffDao = new DAO\Staff;
 $staffMembers = $staffDao->getPagedResult($start, $amount);
 ?> 
```

*编辑强调继承结构应该与实际检索分开*

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-01-07T06:03:25.527

好吧，您可能已经知道 PHP 不支持多重继承。一种解决方法可能是使用接口而不是超类，但是，如果接口的每个实现的逻辑相同，这可能会变得乏味。编写一个代码生成器怎么样，它只是将方法注入每个类？您似乎已经在“常用方法”上这样做了。

哦，在 PHP 中使用 getter 和 setter（它们在例如 Java 中使用）被认为不是一个好主意。对象虽然很慢，但使用公共字段被认为是常态。

**编辑：**然后是[__call()](http://php.net/__call) -hack，它可以识别实际驻留在其他类中的方法，并手动调用它们。

# .net - C++ 'GET' 请求或如何下载文件以在 C++ 中使用？

> ID：419344
> 
> 赞同：4
> 
> 时间：2009-01-07T06:00:54.877
> 
> 标签：.net, c++, visual-c++, curl, libcurl

好吧，我已经花了三天时间尝试这个，这是场景：

我想从 Google 下载一个“.csv”文件，然后对文件中的数据进行处理。它适用于 Win32 控制台应用程序。我有后者，我一生都无法弄清楚如何下载文件。我听说过 libcurl、curlpp、ptypes，我自己滚动，只是使用 .NET api，并且被告知了很多次：

> ...这只是一个 GET 请求

好吧，这一切都很好，但我一定错过了一些东西，因为似乎每个人都生来就知道如何做到这一点。我一直在梳理书籍以解决这个问题，甚至在与“C++ 的艺术”一起旅行了一段时间后，LNKerrors 也出现了巨大的问题。

话虽如此，我从中学到了很多，但在这一点上，我只想知道如何去做。C++ 的 API 严重缺乏，找不到示例代码。在线教程几乎不存在。似乎没有一本书认为这很重要。

有人可以给我扔一个救生筏吗？我在这里是一个处于边缘的人。

**编辑**

“来自 Google”是指我想下载他们托管的 .csv 文件。一个例子可以在[这里找到。](http://finance.google.com/finance/historical?q=NASDAQ:AAPL)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-07T06:20:12.090

你应该能够根据你的[意愿](http://www.luckyspin.org/?p=28)来改变它。

既然我已经回答了你的问题。为什么选择 C++？没有反对语言，但选择最适合工作的语言。Perl、PHP 和 Python（我相信还有更多）都有很好的文档和对这种操作的支持。

在 perl（我熟悉的那个）中，它只有大约 3-5 行代码。

* * *

[这是以前在](http://www.luckyspin.org/?p=28)（来自[WayBackMachine](https://web.archive.org/web/20060903181348/http://www.luckyspin.org/?p=28) ）中可用的代码片段：

```
/*
 * This is a very simple example of how to use libcurl from within 
 * a C++  program. The basic idea is that you want to retrieve the 
 * contents of a web page as a string. Obviously, you can replace 
 * the buffer object with anything you want and adjust elsewhere 
 * accordingly.
 * 
 * Hope you find it useful..
 * 
 * Todd Papaioannou
 */

#include <string>
#include <iostream>
#include "curl/curl.h"

using namespace std;

// Write any errors in here
static char errorBuffer[CURL_ERROR_SIZE];

// Write all expected data in here
static string buffer;

// This is the writer call back function used by curl
static int writer(char *data, size_t size, size_t nmemb,
                  std::string *buffer)
{
  // What we will return
  int result = 0;

  // Is there anything in the buffer?
  if (buffer != NULL)
  {
    // Append the data to the buffer
    buffer->append(data, size * nmemb);

    // How much did we write?
    result = size * nmemb;
  }

  return result;
}

// You know what this does..
void usage()
{
  cout < < "curltest: \n" << endl;
  cout << "  Usage:  curltest url\n" << endl;
} 

/*
 * The old favorite
 */
int main(int argc, char* argv[])
{
  if (argc > 1) 
  {
    string url(argv[1]);

    cout < < "Retrieving " << url << endl;

    // Our curl objects
    CURL *curl;
    CURLcode result;

    // Create our curl handle
    curl = curl_easy_init();

    if (curl)
    {
      // Now set up all of the curl options
      curl_easy_setopt(curl, CURLOPT_ERRORBUFFER, errorBuffer);
      curl_easy_setopt(curl, CURLOPT_URL, argv[1]);
      curl_easy_setopt(curl, CURLOPT_HEADER, 0);
      curl_easy_setopt(curl, CURLOPT_FOLLOWLOCATION, 1);
      curl_easy_setopt(curl, CURLOPT_WRITEFUNCTION, writer);
      curl_easy_setopt(curl, CURLOPT_WRITEDATA, &buffer);

      // Attempt to retrieve the remote page
      result = curl_easy_perform(curl);

      // Always cleanup
      curl_easy_cleanup(curl);

      // Did we succeed?
      if (result == CURLE_OK)
      {
        cout << buffer << "\n";
        exit(0);
      }
      else
      {
        cout << "Error: [" << result << "] - " << errorBuffer;
        exit(-1);
      }
    }
  }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-07T06:47:32.113

为什么不直接使用已经存在的东西？

[UrlDownloadToFile()](http://msdn.microsoft.com/en-us/library/ms775123(VS.85).aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-07T06:25:26.603

由于您在 Win32 平台上，因此您可以使用一个内置库以*相对*简单的方式实现 GET 请求：WinInet，它是 Win32 SDK 的一部分。[WinInet](http://msdn.microsoft.com/en-us/library/aa385483.aspx)的基本参考可以在 MSDN 上找到。

请注意，如果您不熟悉 Win32 API，将会有一些困难。[这里](http://msdn.microsoft.com/en-us/library/aa384322(VS.85).aspx)有一个相当有用的示例代码块

如果您未能将适当的库引用添加到您的项目，您将收到链接器错误。听起来你已经在那里学到了一些教训，所以我会保持简短，但请放心，你会在 Win32 文档中找到所需的库和头文件引用的引用（你只需要了解在哪里寻找它的页面）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-07T07:03:58.820

你不能用标准库做到这一点。既然是win32，你可以听从Paul Keister的建议。

但是看看[libcurl](http://curl.haxx.se/libcurl/)，因为你在 C++ 中，我推荐[POCO](http://pocoproject.org/docs/)它也非常有用。它们是非常方便的工具！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-07T07:10:07.403

另一个选择是[WinHTTP](http://msdn.microsoft.com/en-us/library/aa382925(VS.85).aspx)，它也随 Windows 一起提供。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-07T10:00:16.140

*> 找不到示例代码*

？？？

数十个示例已经发布了 15 年。请参阅 api ng news://comp.os.ms-windows.programmer.win32（C 中的示例）

（COM、INET 等）

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-08T00:18:54.333

我也一直在为 C++ 寻找一个好的 http 库，但还没有找到“完美”的库。 [Boost.Asio](http://www.boost.org/doc/libs/1_37_0/doc/html/boost_asio.html)非常棒，但对于一个简单的 http 库来说级别很低（尽管[http 客户端示例](http://www.boost.org/doc/libs/1_37_0/doc/html/boost_asio/examples.html)是一个好的开始）。[C++ 网络库*](http://cpp-netlib.wiki.sourceforge.net/) ( cpp-netlib) 看起来正在走上正轨，在 asio 之上构建更高级别的 api，但还不是很成熟。查看[http_client 示例](http://cpp-netlib.svn.sourceforge.net/viewvc/cpp-netlib/trunk/libs/network/example/http_client.cpp?view=markup)。

除非我能找到更好的选择，否则我要么编写自己的 asio 包装器，要么扩展（并贡献）到 cpp-netlib。

（顺便说一句，libcurl对我来说*不是*一个更好的选择。它的 api 比我想要的要大得多，而且对于 http 客户端之类的东西非常笨拙，尤其是在 C++ 中。不要误会我的意思，它是一个很棒的库，但不适合简单的http 客户端。）

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-07T06:10:08.553

C++ 本身并没有真正的 API。要执行 GET 请求，您的程序需要打开到相关站点的 TCP 套接字连接，并将信息发送到套接字以符合 HTTP 规范，请参见[此处](http://www.ietf.org/rfc/rfc2616.txt)。您可能可以找到许多库来帮助解决此问题，例如，您可以查看开源程序 wget 使用什么。如果您自己编写代码，那么使用数据包嗅探工具会很有帮助。您可以准确地看到您的浏览器发送到 Web 服务器以取回文件的内容，并准确地发送该消息。这不是太难，但它是相当难的。TCP 最初是一个相当大的学习曲线。

顺便问一下，“来自谷歌”是什么意思？

# vb6 - 在 VB 6.0 中开发

> ID：419352
> 
> 赞同：1
> 
> 时间：2009-01-07T06:03:47.880
> 
> 标签：vb6

我们在 VB 6.0 中有多个项目。这些项目中的大多数都是 ActiveX DLL。开发时，项目采用其他项目的“.dll”引用，但这不允许我们调试。因此，为此我们必须参考“.vbp”项目。但是，获取项目参考意味着我们被要求提供二进制兼容性。

在开发过程中，我们是否应该使用项目兼容性并将项目构建到 DLL 中进行部署？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-07T06:28:37.847

在开发过程中引用 vbp 很好，只要确保保持二进制兼容性即可。如果你不这样做，你将使注册表变得一团糟，部署将是一场灾难。但是请记住，即使启用了二进制兼容性，每次更改 DLL 的公共接口时，都会在注册表的 OLE 条目中创建前向引用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-07T13:18:18.487

我们用于我公司切割机的 CAD/CAM 软件中有四个级别的 DLLS。我们通过创建一个包含上一个版本的 DLL 的兼容性目录来处理这个问题。有了这个，我们可以继续使用二进制兼容性。

这个过程看起来像这样。

*   兼容性中包含修订版 119 DLL。
*   我们编译修订版 120 并发布它
*   将修订版 120 DLL 复制到兼容性目录。
*   开发
*   测试
*   我们编译修订版 121 并发布它。
*   将修订版 121 DLL 复制到兼容性目录。
*   [重复]

您需要注意的主要问题是对您使用的最低级别的 DLL 的更改。Visual Basic 6 使用#include 语句生成其内部类型库。这样做需要混淆它是否仍然是二进制兼容的。请注意，您可以使用 Visual Studio 6 附带的 OLE View 工具看到这一点。

解决这个问题的方法是编译低级DLL，并立即放入兼容目录。生成的更高级别 DLL 的内部类型库现在将正确检测您是否与二进制兼容。

请记住二进制兼容意味着您所能做的就是添加方法或属性。您不能更改现有方法的名称或参数列表。（它是 COM 术语中的签名）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-08T23:56:30.820

您应该能够调试引用 dll。您是否以正确的顺序开始项目？或者您可以将所有/一些 dll 添加到同一个“项目组”(*.vbg) 中。

# objective-c - Cocoa/Objective-C - 我能以某种方式看到实现文件吗？

> ID：419362
> 
> 赞同：4
> 
> 时间：2009-01-07T06:08:23.723
> 
> 标签：objective-c, cocoa

如果我能看到实现文件（.m 文件），我相信我可以学到一两件事。有什么办法可以查看 NSString.m 或 NSNumber.m 文件？和别的？如果我尝试使用聚光灯查找这些文件，我什么也得不到。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-07T06:16:52.567

不，大多数（全部？）Cocoa 库实现仅以编译后的二进制形式分发。您可以拆卸它们，但这可能违反 Mac OS X EULA，而且它也根本无法帮助您理解它们。

您可以查看[Cocotron](http://www.cocotron.org/)，它是 Cocoa 的开源实现。它不会完全相同，但至少对于核心类来说，它几乎是相同的。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-07T08:08:22.310

许多基本的 cocoa 类，如 NSString 和 NSNumber，都在核心基础中实现，并“免费桥接”到 Objective-c 类。核心基础是一个 C（不是 ObjC）API，[源代码](http://www.opensource.apple.com/darwinsource/10.5.5/CF-476.15/)作为 Darwin 开源项目的一部分提供。

因此，要了解 NSString 或 NSNumber 是如何在后台实现的，请点击上面的链接并分别查看 CFString 和 CFNumber（您需要一个 Apple 开发人员帐户，但注册是免费的）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-07T07:38:01.980

还值得一看[mySTEP 来源](http://www.quantum-step.com/download/sources/mySTEP/)。

[这](http://www.quantum-step.com/download/sources/mySTEP/AppKit/Sources/NSMatrix.m)有助于我在前一段时间做一些子类化 NSMatrix 的事情。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-07T06:12:47.207

我猜他们已经编译成库了。

我只是在我的 mac 上做了一个快速检查，也找不到 NSString.m 文件。你在使用 Xcode 的文档吗？我发现它拥有我需要的大部分东西。

# sql-server - 如何在 Microsoft SQL 中将一年中的一天“存储”到一年中的几周？用于材料要求的制造场景

> ID：419372
> 
> 赞同：1
> 
> 时间：2009-01-07T06:15:31.680
> 
> 标签：sql-server, datediff, dateadd

我需要创建一个总需求报告，从开始日期开始计算库存中物品的供应和需求量，并将其“存储”到一年中的不同周，以便物料计划人员知道他们何时需要物品和如果他们当时有足够的库存。

例如，今天的日期（报告日期）是 8/27/08。第一步是找到报告日期所在周的星期一的日期。在这种情况下，星期一将是 8/25/08。这成为第一个桶的第一天。在此之前的所有交易都分配到第 0 周，并将汇总为报表的期初余额。剩余的桶是从那个点开始计算的。对于第 8 个存储桶，没有结束日期，因此在第 8 个存储桶开始日期之后的任何交易都被视为第 8 周。

WEEK# 开始日期 结束日期
0.......无............8/24/08
1.......8/25/08...... 2008年 8 月 31
日 2........9/1/08........9/7/08
3........9/8/08....... ....9/14/08
4.......9/15/08.......9/21/08
5.......9/22/08... ....9/28/08
6.......9/29/08.......10/5/08
7.......10/06/08... ..10/12/08 8..10/13/08
......无

如何获取给定日期的周#、开始日期、结束日期？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-07T06:25:29.413

我一直发现（对于 SQL Server）最简单和最有效的方法是在您的域范围内为未来每周构建一个包含一行的表；并加入其中（使用“WHERE GETDATE() >= MONDATE AND NOT EXISTS (SELECT 1 FROM table WHERE MONDATE < GETDATE())”。

你尝试用 UDF 做的任何事情都会效率低得多，而且我发现更难使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-07T08:20:57.807

您可以在一周内的任何给定日期获得星期一：

```
DATEADD(d, 1 - DATEPART(dw, @date), @date) 
```

您可以使用以下主体编写存储过程

```
-- find Monday at that week
DECLARE @currentDate SMALLDATETIME
SELECT @currentDate = DATEADD(d, 1 - DATEPART(dw, @date), @date)

-- create a table and insert the first record
DECLARE @weekTable TABLE (Id INT, StartDate SMALLDATETIME, EndDate SMALLDATETIME)
INSERT INTO @weekTable VALUES (0, NULL, @currentDate)

-- increment the date
SELECT @currentDate = DATEADD(d, 1, @currentDate)

-- iterate for 7 more weeks
DECLARE @id INT
SET @id = 1
WHILE @id < 8
BEGIN
    INSERT INTO @weekTable VALUES (@id, @currentDate, DATEADD(d, 6, @currentDate))
    SELECT @currentDate = DATEADD(ww, 1, @currentDate)
    SET @id = @id + 1
END

-- add the last record
INSERT INTO @weekTable VALUES (8, @currentDate, NULL)

-- select the values
SELECT Id 'Week #', StartDate 'Start Date', EndDate 'End Date'
FROM @weekTable 
```

当我经过

```
@date = '20080827' 
```

对于这个过程，我得到以下

```
Week #  Start Date     End Date
0   NULL                2008-08-24 00:00:00
1   2008-08-25 00:00:00 2008-08-31 00:00:00
2   2008-09-01 00:00:00 2008-09-07 00:00:00
3   2008-09-08 00:00:00 2008-09-14 00:00:00
4   2008-09-15 00:00:00 2008-09-21 00:00:00
5   2008-09-22 00:00:00 2008-09-28 00:00:00
6   2008-09-29 00:00:00 2008-10-05 00:00:00
7   2008-10-06 00:00:00 2008-10-12 00:00:00
8   2008-10-13 00:00:00 NULL 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-07T06:16:04.923

--SQL 将一周的第一天设置为星期日，并且出于我们的目的，我们希望它是星期一。
--这个命令就是这样做的。

```
SET DATEFIRST 1

DECLARE 
    @ReportDate DATETIME, 

    @Weekday INTEGER, 
    @NumDaysToMonday INTEGER, 
    @MondayStartPoint DATETIME,
    @MondayStartPointWeek INTEGER,
    @DateToProcess DATETIME,
    @DateToProcessWeek INTEGER,
    @Bucket VARCHAR(50),
    @DaysDifference INTEGER,
    @BucketNumber INTEGER,
    @NumDaysToMondayOfDateToProcess INTEGER,
    @WeekdayOfDateToProcess INTEGER,
    @MondayOfDateToProcess DATETIME,
    @SundayOfDateToProcess DATETIME

SET @ReportDate = '2009-01-01'
print @ReportDate

SET @DateToProcess = '2009-01-26'
--print @DateToProcess

SET @Weekday = (select DATEPART ( dw , @ReportDate ))
--print @Weekday

--print DATENAME(dw, @ReportDate)

SET @NumDaysToMonday = 
    (SELECT
      CASE 
         WHEN @Weekday =  1 THEN 0
         WHEN @Weekday =  2 THEN 1
         WHEN @Weekday =  3 THEN 2
         WHEN @Weekday =  4 THEN 3
         WHEN @Weekday =  5 THEN 4
         WHEN @Weekday =  6 THEN 5
         WHEN @Weekday =  7 THEN 6
      END)

--print @NumDaysToMonday

SET @MondayStartPoint =  (SELECT DATEADD (d , -1*@NumDaysToMonday, @ReportDate))
--print @MondayStartPoint

SET @DaysDifference = DATEDIFF ( dd , @MondayStartPoint , @DateToProcess )
--PRINT @DaysDifference

SET @BucketNumber = @DaysDifference/7
--print @BucketNumber

----Calculate the start and end dates of this bucket------
PRINT 'Start Of New Calc'

print @DateToProcess

SET @WeekdayOfDateToProcess = (select DATEPART ( dw , @DateToProcess ))
print @WeekdayOfDateToProcess

SET @NumDaysToMondayOfDateToProcess= 
    (SELECT
      CASE 
         WHEN @WeekdayOfDateToProcess =  1 THEN 0
         WHEN @WeekdayOfDateToProcess =  2 THEN 1
         WHEN @WeekdayOfDateToProcess =  3 THEN 2
         WHEN @WeekdayOfDateToProcess =  4 THEN 3
         WHEN @WeekdayOfDateToProcess =  5 THEN 4
         WHEN @WeekdayOfDateToProcess =  6 THEN 5
         WHEN @WeekdayOfDateToProcess =  7 THEN 6
      END)

print @NumDaysToMondayOfDateToProcess
SET @MondayOfDateToProcess =  (SELECT DATEADD (d , -1*@NumDaysToMondayOfDateToProcess, @DateToProcess))
print @MondayOfDateToProcess   ---This is the start week

SET @SundayOfDateToProcess = (SELECT DATEADD (d , 6, @MondayOfDateToProcess))
PRINT @SundayOfDateToProcess 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-07T06:22:19.357

我在一次一个桶的方法中看到的问题是它很难扩展，

如果您加入用户定义的函数，您将获得更好的性能，您可以[以此为起点](https://stackoverflow.com/questions/196415/date-ranges-in-t-sql)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-07T08:48:47.407

为什么不使用 DATEPART(year, date-column) 和 DATEPART(week, date-column) 的组合并按这些值分组。如果[DATEPART](http://msdn.microsoft.com/en-us/library/ms174420.aspx)中的星期按照 ISO 8601 的要求在星期一对齐，则此方法有效。概述：

```
SELECT DATEPART(year, date_column) AS yyyy,
       DATEPART(week, date_column) AS ww,
       ...other material as required...
    FROM SomeTableOrOther
    WHERE ...appropriate filters...
    GROUP BY yyyy, ww -- ...and other columns as necessary... 
```

# sql - SQL 连接差异

> ID：419375
> 
> 赞同：44
> 
> 时间：2009-01-07T06:18:26.743
> 
> 标签：sql, join

内连接和外连接（左连接，右连接）有什么区别，它们的性能最好？

谢谢！

* * *

## 回答 #1

> 赞同：80
> 
> 时间：2009-01-07T06:29:15.537

检查这篇文章：

[SQL 连接的可视化解释](http://blog.codinghorror.com/a-visual-explanation-of-sql-joins/)

**内部联接：**

![](https://technofriends.files.wordpress.com/2008/02/conceptual_inner_join1.gif)

**左外连接：**

![](https://technofriends.files.wordpress.com/2008/02/left_outer_join.gif)

**右外连接：**

![](https://technofriends.files.wordpress.com/2008/02/right_outer_join.gif)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-07T14:25:00.303

连接类型之间的性能比较是无关紧要的，因为它们给出了不同的结果集。即使内部联接更快，如果您需要左联接的结果（甚至包括与联接中的第二个表不匹配的记录），您也不会使用它。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-07T07:33:20.710

A`LEFT JOIN B`与 相同`B RIGHT JOIN A`。一些 RDBMS 没有`RIGHT JOIN`，所以你必须将你的`RIGHT JOIN`逻辑重写为`LEFT JOIN`逻辑

```
A 1 2 3
B 2 3 4 3

SELECT A.I FROM INNER JOIN B ON B.I = A.I;

output: 2 3, 3

SELECT A.I AS X, B.I AS Y FROM A LEFT JOIN B ON B.I = A.I;

read above code as A on LEFT, JOINs B

output: 

X Y
1 NULL
2 2
3 3
3 3

SELECT A.I AS X, B.I AS Y FROM B RIGHT JOIN A ON A.I = B.I; 
```

将上面的代码读为`B on RIGHT, JOINs A`. 这与 A 在 LEFT 相同

左边的东西总是被评估，总是有输出。您可以将 A LEFT JOIN B, B RIGHT JOIN A 想象为：

```
 var result = new Dictionary<int, int?>();

        var A = new int[] { 1, 2, 3 };
        var B = new int[] { 2, 3, 4, 3 };

        foreach (int aElem in A)
        {

            bool hasMatch = false;
            foreach (int bElem in B)
            {
                if (bElem == aElem)
                {
                    result.Add(aElem, bElem);
                    hasMatch = true;
                }
            }

            if (!hasMatch)
                result.Add(aElem, null);
        }

        foreach(int X in result.Keys)
        {
            MessageBox.Show(string.Format("X {0} Y {1}", X, result[X].HasValue ? result[X].Value.ToString() : "NULL"  ));
        } 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-07T14:53:44.940

左、右、内、外不影响性能，这里已经很好地解释了它们。

但是，您可以将一些提示添加到影响性能的连接中：散列、循环和合并。

通常，查询计划器会决定执行哪些操作，但有时您可以通过覆盖它来提高性能。

对于第一个表中的每一行，A遍历第二个表中的每一行。如果您有一张非常大的桌子和一张小得多的桌子，这很好。**`loop`** `join`

A按顺序一起遍历两个表。如果两个表都已按您要加入的字段排序，则速度会非常快。**`merge`** `join`

A在对连接数据进行排序时，使用大量临时表对输出进行分组。**`hash`** `join`

一些专业数据库还支持其他类型，例如位图连接。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-07T06:47:48.930

希望你能看懂图片。在性能方面，它们是等效的 - 没有区别。

编辑：哎呀。猜猜你不关心答案的那一部分。

# python - 如何在 Python 中维护函数调用之间的列表和字典？

> ID：419379
> 
> 赞同：4
> 
> 时间：2009-01-07T06:21:19.560
> 
> 标签：python, variables, function-calls

我有一个功能。在里面，我正在维护一个值字典。我希望在不同的函数调用之间维护该字典

假设 dic 是：

```
a = {'a':1,'b':2,'c':3} 
```

在第一次通话时，比如说，我将 a[a] 更改为 100 Dict 变为`a = {'a':100,'b':2,'c':3}`

在另一个电话中，我将 a[b] 更改为 200 我希望该 dic 成为`a = {'a':100,'b':200,'c':3}`

但在我的代码中，a[a] 不会保持 100。它会变为初始值 1。

我需要尽快回答......我已经迟到了......请帮助我的朋友......

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-01-07T11:13:21.813

您可能在谈论可调用对象。

```
class MyFunction( object ):
    def __init__( self ):
        self.rememberThis= dict()
    def __call__( self, arg1, arg2 ):
        # do something
        rememberThis['a'] = arg1
        return someValue

myFunction= MyFunction() 
```

从那时起，将 myFunction 用作一个简单的函数。您可以使用 访问`rememberThis`字典`myFunction.rememberThis`。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-01-07T06:25:35.263

您可以使用[静态变量](https://stackoverflow.com/questions/279561/what-is-the-python-equivalent-of-static-variables-inside-a-function)：

```
def foo(k, v):
  foo.a[k] = v
foo.a = {'a': 1, 'b': 2, 'c': 3}

foo('a', 100)
foo('b', 200)

print foo.a 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-01-07T14:39:05.470

与其在代码库上强制使用全局变量（这可能是调用者的决定），我更喜欢保持与函数实例相关的状态的想法。一个类对此有好处，但不能很好地传达你想要完成的内容，并且可能有点冗长。在我看来，利用闭包要干净得多。

```
def function_the_world_sees():
    a = {'a':1,'b':2,'c':3}

    def actual_function(arg0, arg1):
        a[arg0] = arg1
        return a

    return actual_function
stateful_function = function_the_world_sees()

stateful_function("b", 100)    
stateful_function("b", 200) 
```

要记住的主要注意事项是，当您在“actual_function”中进行分配时，它们会发生在“actual_function”中。这意味着您不能将 a 重新分配给不同的变量。我使用的解决方法是将我计划重新分配的所有变量放入每个变量的单个元素列表或字典中。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-01-07T06:26:29.473

如果在函数内部创建了“a”。它超出了范围。只需在函数外部（在调用函数之前）创建它。通过这样做，程序离开函数后不会删除列表/散列。

```
a = {'a':1,'b':2,'c':3}

# call you funciton here 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-07T13:59:00.013

您可以使用 Python 的默认参数行为“作弊”。默认参数只计算一次；它们在每次调用函数时都被重用。

```
>>> def testFunction(persistent_dict={'a': 0}):
...     persistent_dict['a'] += 1
...     print persistent_dict['a']
...
>>> testFunction()
1
>>> testFunction()
2 
```

这不是最优雅的解决方案；如果有人调用该函数并传入一个参数，它将覆盖默认值，这可能不是您想要的。

如果您只是想要一种快速而肮脏的方式来获得结果，那将是可行的。如果您正在做一些更复杂的事情，最好将其分解到像 S. Lott 提到的类中。

编辑：重命名字典，这样它就不会`dict`按照下面的评论隐藏内置。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-01-08T00:26:50.727

就个人而言，我喜欢全局声明的想法。它没有引入全局变量，但指出本地标识符实际上是指全局命名空间中的一个。

```
d = dict()
l = list()
def foo(bar, baz):
    global d
    global l
    l.append(bar, baz)
    d[bar] = baz 
```

在 python 3.0 中还有一个“非本地”语句。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-01-07T21:35:00.670

在我看来，这个问题没有一个优雅的答案。选项是可调用对象、默认值和属性黑客。可调用对象是正确的答案，但它们为另一种语言中的单个“静态”声明带来了很多结构。默认值是对代码的微小更改，但它很笨拙，并且可能会让新的 Python 程序员在查看您的代码时感到困惑。我不喜欢它们，因为它们的存在并没有对任何可能正在查看您的 API 的人隐藏。

我通常会使用属性破解。我的首选方法是：

```
def myfunct():
    if not hasattr(myfunct, 'state'): myfunct.state = list()
    # access myfunct.state in the body however you want 
```

这将状态声明保留在其所属函数的第一行，并将 myfunct 保留为函数。缺点是每次调用函数时都要进行属性检查。这几乎肯定不会成为大多数代码的瓶颈。

# c# - 触发进度更改事件处理程序时如何减少 CPU 使用率？

> ID：419402
> 
> 赞同：0
> 
> 时间：2009-01-07T06:34:53.717
> 
> 标签：c#, internet-explorer, plugins, bho

[在此链接](http://www.codeproject.com/KB/cs/Attach_BHO_with_C_.aspx?fid=447248&df=90&mpp=25&noise=3&sort=Position&view=Quick&fr=51&select=2421069)的帮助下，我创建了一个 BHO 应用程序。

**如果我 Build 上面文章中得到的源代码，CPU 使用率提高到 70-80%。**

**我怎样才能减少这种情况？**

在上面的文章中，我使用了 progresschange 事件处理程序，而不是 Document complete 事件处理程序。

在 foreach 循环中，我曾经检查网页的每个标签的标签名，在构建上述代码时（或在注册 dll 之后），CPU 使用率从 10% 到 80% 持续增加，如果有可能会导致问题是包含大量数据（元素）的网页.....

我想避免这种情况，是否有任何方法可以让我获取网页中存在的所有标签的所有标签名。请提出一些建议，以便我可以避免这个问题。谢谢...导致问题的代码是粗体字符。对于找到的每个标记元素，它都显示包含标记元素标记名的消息框。

我遇到问题的代码是：

```
public void onProgressChange(int Progress, int ProgressMax) 
{    
    document = (HTMLDocument)webBrowser.Document; 
    foreach(IHTMLElement tempElement in (IHTMLElementCollection)document.documentElement.all)   
    {      
        System.Windows.Forms.MessageBox.Show(" Tagname:"+ tempElement.tagname);   
    }                 
}

public int SetSite(object site) 
{
    if (site != null)   
    {     
        webBrowser = (WebBrowser)site; 
        webBrowser.ProgressChange += new DWebBrowserEvents2_ProgressChangeEventHandler(this.onProgressChange);    
    }    
    else    
    { 
        webBrowser.ProgressChange = new DWebBrowserEvents2_ProgressChangeEventHandler(this.onProgressChange);
        webBrowser = null;     
    }

    return 0;
} 
```

此事件重复生成。如何降低 CPU 使用率？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-08-28T02:16:51.000

这是一个没有答案的问题。您的 CPU 使用问题是您所做的事情的结果，而不是如何操作的结果。IE 是一条狗，尤其是如果你走的所有集合。请记住，必须将每个对象编组到 .Net 中才能访问它。我建议您以另一种方式解决您的问题，或者使用 IE 以外的解析器来处理 HTML。您可以使用 WebClient 类加载 HTML，然后将结果提供给您喜欢的任何解析器。运行一个简单的谷歌搜索将出现几个替代解析器：

[http://www.google.com/search?hl=en&rlz=1C1GGLS_enUS330US330&q=html+parser+C%23+.net&aq=f&oq=&aqi=](http://www.google.com/search?hl=en&rlz=1C1GGLS_enUS330US330&q=html+parser+C%23+.net&aq=f&oq=&aqi=)

如果出于某种原因您坚持使用 IE，您需要在 document.all 集合上找到 foreach 语句的替代答案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-12-04T19:33:01.347

> 此事件重复生成。如何降低 CPU 使用率？

根据实现，函数`onProgressChange`可能会被非常非常快地调用`webBrowser`。

尝试重写`onProgressChange`以跳过它的一些调用并偶尔做一次实际工作，例如每秒一次。

# c++ - 断言总是不好的吗？

> ID：419406
> 
> 赞同：20
> 
> 时间：2009-01-07T06:37:20.183
> 
> 标签：c++, exception, assertions

我曾经在一家公司工作，那里的一些首席架构师/开发人员已在各种项目中强制要求不得使用断言，并且它们通常会从代码中删除并替换为异常。

我觉得它们对于编写正确的代码非常重要。任何人都可以建议如何证明这样的授权是合理的吗？如果是这样，断言有什么问题？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-01-07T08:19:12.333

根据 JaredPar 的评论，我们使用了一个修改版本的断言，它就像一个合同。此版本被编译到发布代码中，因此存在较小的开销，但除非设置了诊断开关，否则将被禁用，从而将性能开销降至最低。在这种情况下，我们的断言处理程序可以设置为禁用、静默模式（例如，记录到文件）或嘈杂模式（例如，使用 abort/ignore 在屏幕上显示，abort 会引发异常）。

我们使用自动化回归测试作为我们预发布测试的一部分，并且断言在这里非常重要，因为它们允许我们发现在 GUI 级别无法发现的潜在内部错误，并且最初在用户级别可能不会致命。通过自动化，我们可以在有和没有诊断的情况下运行测试，除了执行时间之外几乎没有开销，因此我们还可以确定断言是否有任何其他副作用。

使用断言要小心的一件事是副作用。例如，您可能会看到类似*assert(MyDatabasesIsOk())*的内容，它会无意中更正数据库中的错误。这是一个错误，因为断言不应该改变正在运行的应用程序的状态。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-07T06:44:49.763

关于断言，我能说的唯一真正负面的事情是它们不在零售代码中运行。因此，在我们的团队中，我们倾向于避免断言。相反，我们使用合约，它们是在零售和调试中运行的断言。

我们现在唯一使用断言的情况是以下条件之一是否为真。

1.  断言代码具有**显**着的性能影响
2.  特定情况不是致命的
3.  偶尔会有一段代码可能会死也可能不会死。我们将添加一个断言，基本上说“你是怎么到这里的”。不触发并不意味着代码确实已经死了，但是如果 QA 给我发电子邮件并说“这个断言是什么意思”，我们现在有一个重现来获取特定的代码（当然它会立即记录下来）。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-07T06:41:47.960

断言和异常用于两种不同的事情。

断言用于不应该发生的状态。例如，signalton 指针永远不应该为空，并且应该在开发过程中使用断言来发现这个错误。处理它有一个例外是更多的工作。

另一方面，异常用于在应用程序的正常运行中可能发生的罕见状态。例如使用 fopen ，它返回一个空指针。它可能会发生，但大多数时候它会返回一个有效的指针。

使用断言既不是错误也不是正确的，但归结为个人喜好，因为归根结底，它是一种使编程更容易的工具，并且可以被其他工具取代。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-07T09:48:55.493

这取决于**您系统的关键程度**：断言是一种**故障快速策略**，而当系统可以执行某种恢复时可以使用异常。

例如，我不会在银行应用程序或电信系统中使用断言：我会抛出一个异常，该异常将在调用堆栈中被捕获。在那里，可以清理资源，处理下一个调用/事务；只有一个会丢失。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-07T10:08:17.653

断言是一件很棒的事情，但不要与参数/返回值检查混淆。您在您认为不会发生的情况下使用它们，而不是在您期望可能发生的情况下使用它们。

我最喜欢使用它们的地方是在真正不应该到达的代码块中 - 例如在一个枚举上的`default`case in `switch`-statement`case`对每个可能的枚举值都有一个。

您可能会使用新值扩展枚举，但不要更新所有`switch`涉及枚举的语句，这是相对常见的，您会想尽快知道这一点。在这种情况下，快速失败是你最好的愿望。

诚然，在那些地方，您通常也需要在生产构建中中断的东西。但`abort()`强烈推荐这种情况下的ing原则。调试器中良好的堆栈跟踪为您提供了修复错误的信息，而不是猜测。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-07T06:41:01.690

调试版本中确实存在断言，但发布版本中不存在断言吗？

如果您想验证/断言某些内容，您不想在发布版本和调试版本中这样做吗？

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-07T06:53:08.983

唯一的猜测是，因为异常通常是非致命的，所以它使代码库不会在某种奇怪的状态下死亡。与之相反的是，断言的致命性指向问题所在，因此易于调试。

就我个人而言，我更喜欢冒断言的风险，因为我觉得它会导致更容易调试的更可预测的代码。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-07T08:43:35.593

断言可以简单地通过不定义 NDEBUG 来保留，所以这不是一个真正的问题。

真正的问题是断言调用 abort()，它会立即停止程序。如果您的程序在退出之前必须进行关键清理，这可能会导致问题。异常具有正确调用析构函数的优点，即使异常从未被捕获。

因此，在清理确实很重要的情况下，异常更合适。否则，断言就好了。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-07T11:21:54.290

我们使用断言来*记录假设*。

我们确保在代码审查中不会在断言中执行应用程序逻辑，因此在发布前不久将其关闭是非常安全的。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-07T10:11:17.397

否决的一个原因`assert()`是，可以编写在`NDEBUG`定义时正常工作但在未定义时失败的代码`NDEBUG`。或相反亦然。

这是一个*好的*程序员不应该经常陷入的陷阱，但有时原因可能非常微妙。例如，代码中的代码`assert()`可能会微调可执行文件中的内存分配或代码位置，从而不会发生分段错误（反之亦然）。

根据团队的技能水平，引导他们远离危险区域可能是个好主意。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-26T14:12:00.070

请注意，在析构函数中抛出异常是未定义的行为。

# c# - 从没有打印对话框的 Windows 服务打印 html 文档

> ID：419412
> 
> 赞同：15
> 
> 时间：2009-01-07T06:41:39.647
> 
> 标签：c#, windows-services, printing

我正在使用 Windows 服务，我想在服务启动时打印一个 .html 页面。我正在使用此代码，并且打印效果很好。但是打印对话框来了，没有打印对话框怎么打印？

```
public void printdoc(string document)
{
    Process printjob = new Process();

    printjob.StartInfo.FileName = document;
    printjob.StartInfo.UseShellExecute = true;
    printjob.StartInfo.Verb = "print";
    printjob.StartInfo.CreateNoWindow = true;
    printjob.StartInfo.WindowStyle = ProcessWindowStyle.Hidden;

    printjob.Start();
} 
```

有没有其他方法可以在不显示打印对话框的情况下打印它。

* * *

**更新：对此作出[回应](https://stackoverflow.com/questions/419412/print-html-document-from-windows-service-without-print-dialog/419427#419427)：**

但是我已经使用过这个类但是当我打电话给

```
axW.ExecWB(SHDocVw.OLECMDID.OLECMDID_PRINT,SHDocVw.OLECMDEXECOPT.OLECMDEXECOPT_PROMPTUSER , ref em, ref em); 
```

当我从窗口服务使用时，我的程序在这里被阻塞，但它在 Windows 应用程序中运行良好。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-11-11T04:18:59.480

首先，这是代码：

```
using System.Reflection;
using System.Threading;
using SHDocVw;

namespace HTMLPrinting
{
  public class HTMLPrinter
  {
    private bool documentLoaded;
    private bool documentPrinted;

    private void ie_DocumentComplete(object pDisp, ref object URL)
    {
      documentLoaded = true;
    }

    private void ie_PrintTemplateTeardown(object pDisp)
    {
      documentPrinted = true;
    }

    public void Print(string htmlFilename)
    {
      documentLoaded = false;
      documentPrinted = false;

      InternetExplorer ie = new InternetExplorerClass();
      ie.DocumentComplete += new DWebBrowserEvents2_DocumentCompleteEventHandler(ie_DocumentComplete);
      ie.PrintTemplateTeardown += new DWebBrowserEvents2_PrintTemplateTeardownEventHandler(ie_PrintTemplateTeardown);

      object missing = Missing.Value;

      ie.Navigate(htmlFilename, ref missing, ref missing, ref missing, ref missing);
      while (!documentLoaded && ie.QueryStatusWB(OLECMDID.OLECMDID_PRINT) != OLECMDF.OLECMDF_ENABLED)
        Thread.Sleep(100);

      ie.ExecWB(OLECMDID.OLECMDID_PRINT, OLECMDEXECOPT.OLECMDEXECOPT_DONTPROMPTUSER, ref missing, ref missing);
      while (!documentPrinted)
        Thread.Sleep(100);

      ie.DocumentComplete -= ie_DocumentComplete;
      ie.PrintTemplateTeardown -= ie_PrintTemplateTeardown;
      ie.Quit();
    }
  }
} 
```

1.  您可以通过添加对“Microsoft Internet Controls”的引用来访问 SHDocVw 命名空间，该引用位于“添加引用”对话框的 COM 选项卡上。
2.  可以在[MSDN](http://msdn.microsoft.com/en-us/library/aa752084%28VS.85%29.aspx)上找到有关 InternetExplorer 对象的更多信息。
3.  Navigate() 方法将加载 HTML 文件。其他参数允许您指定可选参数，例如标志和标题。
4.  在加载文档之前，我们无法打印。在这里，我进入一个循环，等待 DocumentComplete 事件被调用，在该事件上设置一个标志，通知我们导航已完成。请注意，每当导航完成时都会调用 DocumentComplete - 无论是成功**还是**失败。
5.  设置 documentLoaded 标志后，将通过 QueryStatusWB() 查询打印状态，直到启用打印。
6.  使用 ExecWB() 调用开始打印。该`OLECMDID_PRINT`命令已指定，以及`OLECMDEXECOPT_DONTPROMPTUSER`无需用户交互即可自动打印的选项。一个重要的注意事项是，这将打印到默认打印机。要指定打印机，您必须设置默认打印机（在代码中，您可以调用[SetDefaultPrinter()](http://www.pinvoke.net/default.aspx/winspool/SetDefaultPrinter.html?diff=y)）。最后两个参数允许可选的输入和输出参数。
7.  我们不想在打印完成之前退出，所以再次进入一个循环。触发 PrintTemplateTeardown 事件后，将设置 documentPrinted 标志。然后可以清理对象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-08-27T06:45:24.487

这是另一种没有打印对话框的打印方式。您创建一个 PrintDialog 对象，对其进行初始化，然后调用 Print() 方法。

下面的函数用于打印一个小的 2"x0.75" 条码标签。您需要找到一种`Document`从 html 文件中获取对象的方法。

```
public void PrintToPrinter(string printerName)
{
    PrintDialog pd = new PrintDialog();
    pd.Document = userControl11.PrintDoc; // <--- Update this line with your doc
    pd.PrinterSettings.PrinterName = printerName;
    try
    {
            pd.Document.DocumentName = "My Label";
            pd.Document.DefaultPageSettings.PaperSize = new System.Drawing.Printing.PaperSize("2-.75", 200, 75);
            pd.Document.DefaultPageSettings.Margins = new System.Drawing.Printing.Margins(0, 0, 0, 0);
            //pd.PrinterSettings.Copies = (short)mNumCopies;
            pd.Document.PrinterSettings.Copies = (short) mNumCopies;
            pd.Document.Print();
    }
    catch
    {
        MessageBox.Show("INVALID PRINTER SPECIFIED");
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-07T06:50:14.480

从这个网站[http://www.ussbd.com/printhtm.html](http://www.ussbd.com/printhtm.html)

```
using HtmlPrinter;
hpObj=new HtmlPrinter.HtmlPrinter();
hpObj.PrintUrlFromMemory(txtUrl.Text); 
```

现在您在项目中添加代码以从其源文本打印 html 页面：

```
HtmlPrinter.HtmlPrinter hpObj=new HtmlPrinter.HtmlPrinter();
hpObj.PrintHtml(txtString.Text, true); 
```

如果要在没有打印对话框的情况下打印，请使用以下行：

```
hpObj.PrintHtml(txtString.Text, false); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-15T19:18:13.990

`OLECMDEXECOPT_PROMPTUSER`似乎强制提示用户选择打印机和所有相关的东西，我很确定服务不允许这样做。有人可以验证吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-10-30T16:54:42.793

您可以使用 System.Drawing.Printing 命名空间中的 PrintDocument 类来更好地控制打印，请参阅[此处](http://msdn.microsoft.com/en-us/library/system.drawing.printing.printdocument.aspx)了解更多信息。

例如，您可以执行以下操作：

```
using (PrintDocument doc = new PrintDocument())
{
    doc.PrintPage += this.Doc_PrintPage;
    doc.DefaultPageSettings.Landscape = true;
    doc.DocumentName = fileNameOfYourDocument;
    doc.Print();
} 
```

然后为要打印的每一页引发一个函数，并为您提供一个要绘制的图形区域

```
private void Doc_PrintPage(object sender, PrintPageEventArgs ev)
{
    ....
    ev.Graphics.DrawImage(image, x, y, newWidth, newHeight);
} 
```

这确实需要您将文本/图像上的实际绘图处理到页面，有关更多信息，请参见[此处](http://msdn.microsoft.com/en-us/library/cwbe712d.aspx)。

# javascript - 在 Mozilla Firefox 上按下回车键时触发按钮事件

> ID：419415
> 
> 赞同：0
> 
> 时间：2009-01-07T06:43:35.680
> 
> 标签：javascript, firefox, dom-events

```
function CaptureKeys (e,btn) {
  var c //= document.layers ? evt.which: document.all ? event.keyCode : evt.keyCode 
  if(window.event) { 
    c = e.keyCode; // IE
  } else if(e.which) {
    c = e.which; // Netscape/Firefox/Opera
  }
      if (c == 13) {
        //return /enter key
        if (btn=="go") {
            if (document.getElementById("ctl00_ContentPlaceHolder1_btnGo")!=null) {
                document.getElementById("ctl00_ContentPlaceHolder1_btnGo").focus();
                return true;
            }
        } else {
            if (document.getElementById('ctl00_ContentPlaceHolder1_ImgFilter') != null) {
            //__doPostBack('ctl00_ContentPlaceHolder1_ImgFilter','');
            document.getElementById('ctl00_ContentPlaceHolder1_ImgFilter').focus();
            return true;
           }
       }
      return false;
     }
 } 
```

此代码适用于 IE7，但不适用于 Mozilla Firefox。请帮我在按键时引发按钮事件`Enter`。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-07-08T13:08:36.663

I dont know if anyone is checking this thread anymore, but for future reference.

I had the same problem in FF and I got the answer here:

~~[http://www.webdeveloper.com/forum/showthread.php?t=108382](http://www.webdeveloper.com/forum/showthread.php?t=108382)~~

Good luck!

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-07T06:53:30.683

你也可以试试这段代码：

```
theButton.click(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-14T23:38:41.223

你有一个错字。

`window.event`应该是`window.Event`！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-03-26T05:52:52.993

利用：

```
 __doPostBack('ctl00$ContentPlaceHolder1$btnGo',''); 
```

代替：

```
document.getElementById("ctl00_ContentPlaceHolder1_btnGo").focus(); 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-01-07T06:49:50.033

您可以简单地将**UseSubmitBehavior="true"**属性值添加到应在键上触发的按钮`Enter`。

# c# - 调试在 .NET 中调用 AppDomain.CreateInstanceAndUnwrap 时引发的 AmbiguousMatchException

> ID：419436
> 
> 赞同：1
> 
> 时间：2009-01-07T06:54:05.970
> 
> 标签：c#, .net

我有一个应用程序在调用 AppDomain.CreateInstanceAndUnwrap 以实例化另一个 AppDomain 中的类型时抛出 AmbiguousMatchException。这发生在我无法直接访问的客户计算机上。我认为问题在于加载了同一个程序集的两个副本。有什么方法可以确定是否是这种情况以及从哪里加载两个程序集？启用融合日志会提供任何其他信息吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-07T07:50:48.883

融合日志可能会有所帮助，但另一种选择可能是挂钩`AssemblyLoad`事件：

```
 AppDomain.CurrentDomain.AssemblyLoad += (s, a) =>
    {
        Console.WriteLine(a.LoadedAssembly.FullName);
        Console.WriteLine(a.LoadedAssembly.CodeBase);
    }; 
```

此错误有两个主要原因：

*   巧合的命名 - 即 Foo.dll 和 Bar.dll 都有一个`Some.Namespace.Type`类型
*   不同组件引用的不同版本（主要是 GAC） - 即您的 DAL 加载某些 dll 的 v2，而您的 UI/实用程序代码加载相同 dll 的 v4

当然，另一种选择是您的 s 已经相互感染（通过将引用暴露在对象的 API 上，`AppDomain`很容易意外地将引用吸过边界）。`AppDomain``MarshalByRef`

# palm - 需要 Palm Desktop datebook.dat 文件格式

> ID：419441
> 
> 赞同：4
> 
> 时间：2009-01-07T06:56:19.990
> 
> 标签：palm

我正在寻找有关 Palm Desktop >= 4.1 版本的 Palm Desktop 的“datebook.dat”文件的文件格式的文档。

请注意，[http:](http://www.notsofaqs.com/datebook_dat.php) //www.notsofaqs.com/datebook_dat.php 记录了 <4.1 日期簿格式的一部分，但我正在寻找当前版本的 Palm Desktop 使用的当前“日历”格式。

存在尝试对格式的部分进行逆向工程的[Perl](http://webcalendar.cvs.sourceforge.net/viewvc/webcalendar/webcalendar/tools/palm_datebook.pl?revision=1.8&view=markup)和[PHP脚本，但完整的规范将是最有帮助的。](http://palm2ical.googlecode.com/svn/trunk/datebook.php)

我在 Palm Developer Web 站点上找不到任何东西。

我唯一的额外线索是

1.  文件的前四个字节是“0xCAFEBABE”，就像在 Java 类文件和 Mach-O 文件中一样（？！）
2.  用户组中的一篇论坛帖子提到 Palm 正在使用某种“MS 序列化”技术，并链接到 Palm Developer Network 先前版本的已失效帖子

任何帮助将不胜感激！例如，如果有人知道使用“0xCAFEBABE”幻数的微软序列化格式，这可能有助于我的侦查。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-13T14:19:42.780

Palm Desktop 6（“ACCESS 的 Palm Desktop”）以 MS Access 格式存储文件。正如其他人所提到的，Palm Desktop 的早期版本（例如 4.x 和更早版本）以专有格式存储文件。如果您使用 Palm Desktop 将日历保存为 Datebook Archive 格式（与 Ca​​lendar Archive 格式相反，后者令人困惑地使用 DBA 扩展名），它将采用此处完整记录的格式：[http://www.notsofaqs .com/palmrecs.php](http://www.notsofaqs.com/palmrecs.php)。

我知道这些文档是完整的，因为我用它们编写了[Palm2CSV](https://www.palm2csv.com/ "Palm2CSV")，这是一个 Palm 到 CSV/iCal 的转换器，可以同时处理 Palm 4 和 Palm 6 文件。（它通过首先通过[MDBTools](https://github.com/mdbtools/mdbtools)运行 Palm 6 文件，然后解析 CSV 输出来处理它们。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-14T02:24:02.717

另一个值得关注的地方是[jpilot](http://www.jpilot.org)项目。它是一个 linux PIM，它创建 palm 数据库，然后可以直接同步到 palm。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-07T07:13:26.663

我不想让你失望，但这几乎是不可能的。我有一个手掌已经 5 年了，花了好几个小时将我的手掌与任何开放平台同步。

它仍然无法正常工作。唯一可行的解​​决方案是与 Outlook 同步。

没有关于 Palm 文件格式的官方文档。在我看来，他们对开放开发不感兴趣，Palm Inc. 的问题比他们的文件格式更重要。

我放弃。很遗憾，但没有办法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-11-24T13:41:57.943

看[这里](http://webcalendar.cvs.sourceforge.net/viewvc/webcalendar/webcalendar/tools/palm_datebook.pl?revision=1.8&view=markup)，有一个非常好的 perl 阅读器，你可以在上面看到格式。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-12T06:26:54.003

IIRC 格式是 Microsoft 基础类 (MFC) 使用的序列化格式。它高度依赖于保存到磁盘的 C++ 对象的实际实现。由于 MFC 源代码随 Visual Studio 一起提供，因此您可以查看它以了解发生了什么。

但是，随着 4.1 桌面应用程序的更新，二进制格式确实发生了变化，以处理添加的新字段。我不知道这些更改，或者代码是否使用与原始桌面相同的方法。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-02-04T05:30:48.813

只是在寻找同样的东西，偶然发现了这个讨论。到目前为止，我发现最好的是[dbapipe](http://dbapipe.sourceforge.net/)，它可以读写 dba 文件（使用它自己的文本格式作为中间表示）。该程序处理 4.1.4 和更早的格式。当然，这并不构成文档，但工作程序是一个好的开始。该程序是用 C 语言编写的，下载内容包括 Windows 的预编译版本。

编辑：

请注意，如果 dbapipe 遇到带有位置的日历条目，则会失败。

我找到的另一个资源是 Palm 日期簿操作模块，它是[Gabbie 自然语言命令系统](http://sourceforge.net/projects/gabbie/)的一部分。它的[palm.c 文件](http://www.koders.com/cpp/fid2C5AFAAD7A1F6686763E9B1BAB1314F52E4094C9.aspx)有一些文档。

很遗憾 Palm 没有为其文件格式提供官方文档。我想知道这是否部分是对笨拙的设计的尴尬。

# .net - 序列化顺序和 Unity 问题

> ID：419442
> 
> 赞同：2
> 
> 时间：2009-01-07T06:58:17.227
> 
> 标签：.net, serialization, unity-container

我有一个使用 XML 和自定义序列化程序的应用程序，并且最近使用 Unity 1.2 添加了一些 DI 以在我的类中设置两个属性。

现在，当我对类进行序列化时，Unity 设置的属性首先被序列化，然后是所有其他属性。

因此，如果 Unity 设置了类属性 2 和 3，则序列化类按以下顺序出现：23145

对于 XmlSerialiser，我可以使用 XmlElement 属性来设置顺序，但是我的自定义序列化器仍然以错误的顺序输出类，并且它的长度格式是固定的，所以顺序很重要。

有谁知道在仍然使用 Unity 的同时让我的课程按顺序序列化的方法？

谢谢

代码示例类

```
 [Serializable]
[DataContract]
[XmlInclude(typeof(HeaderDocument))]
public class HeaderDocument
{
    [InjectionConstructor]
    public HeaderDocument()
    {
        DateTimeCreated  = DateTime.Now;
        TransactionId  = Guid.NewGuid().ToString();
        HasPayload = true;
    }

    /// <summary>Gets or sets the service name of the target service.</summary>
    [DataMember, CopyBookElement("REQUESTED-SERVICE", CopyBookDataType.String, Length = 40)]
    public string ServiceName { get; set; } 

    /// <summary>Gets or sets the entry application name of the request.</summary>
    [DataMember, CopyBookElement("CONSUMER-APPLICATION-ID", CopyBookDataType.UnsignedInteger, Length = 3)]
    public int ApplicationId { get; set; } 

    /// <summary>Gets or sets the quality of service required for the request.</summary>
    [DataMember, CopyBookElement("QUALITY-OF-SERVICE", CopyBookDataType.String, Length = 1)]
    public string QualityOfService { get; set; }

    /// <summary>Gets or sets the transaction identifier.</summary>
    [DataMember, CopyBookElement("TRANSACTION-ID", CopyBookDataType.String, Length = 36)]
    public string TransactionId { get; set; }

    /// <summary>Gets or sets the time the document was created.</summary>
    public DateTime DateTimeCreated { get; set; }

    [DataMember, CopyBookElement("HAS-PAYLOAD", CopyBookDataType.Boolean)]
    public bool HasPayload { get; set; }
} 
```

统一配置

```
<unity>
<typeAliases />
<containers>
  <container name="TechnicalArchitecture">
    <types>
      <type type="ILogger, ApplicationServices" mapTo="Logger, ApplicationServices" />
      <type type="HeaderDocument, ApplicationServices">
        <typeConfig extensionType="Microsoft.Practices.Unity.Configuration.TypeInjectionElement, Microsoft.Practices.Unity.Configuration">
          <property name="ApplicationId" propertyType="System.Int32">
            <value value="19" />
          </property>
          <property name="QualityOfService" propertyType="System.String">
            <value value="1" />
          </property>
        </typeConfig>
      </type>
    </types>
  </container>
</containers> 
```

构建 HeaderDocument 时，我调用

```
HeaderDocument = IOC.Container.Resolve<HeaderDocument>(); 
```

我不希望修改自定义序列化器，目前我刚刚将属性 1 添加到 Unity 配置中，因此我可以进行一些测试。

但我真正想知道的是，为什么 Unity 填充的属性与任何其他方法设置的属性的处理方式不同。（反射、构造函数或属性设置器）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-07T08:32:16.287

那么，您的自定义序列化程序如何选择顺序？你控制这个序列化器吗？还是第三者？您描述的“2、3、1、4、5”模式让我们怀疑您的对象是否不是“属性包”，它只是按照设置的顺序序列化数据 - 这将是*非常*危险的。您设置属性的顺序不应该（通常）重要。

属性没有定义的顺序，您不应依赖构建之间的此顺序。该系统也不能保证反射与源代码与任何事实的属性顺序。

所以你需要以某种方式自己定义顺序，也许是按字母顺序（但是当有人添加`AardvarkCount`属性时这很脆弱），也许是通过自定义属性。

我有一个[自定义（二进制）序列化](http://code.google.com/p/protobuf-net/)程序，并且我使用自定义属性方法，尽管在某些情况下我支持字母顺序。例如：

```
[ProtoContract]
public class MyClass {
    [ProtoMember(1)]
    public int Foo {get;set;}

    [ProtoMember(2)]
    public string Bar {get;set;}
} 
```

然后，反射以什么顺序对属性进行排序并不重要 - 序列化程序总是按顺序读取/写入数据`Foo`，`Bar`.

(And for the observant: yes, the above example looks a lot like WCF / data-contracts with the `Order` property set, so I support that too ;-p)

# javascript - 通过 AJAX 和 javascript 进行屏幕抓取

> ID：419457
> 
> 赞同：1
> 
> 时间：2009-01-07T07:15:14.540
> 
> 标签：javascript, ajax

我想使用 AJAX 和 javascript 抓取屏幕。这怎么可能？

需要刮这个：**[http ://www.fedex.com/Tracking?ascend_header=1&clienttype=dotcom&cntry_code=us&language=english&tracknumbers=776812461212825](http://www.fedex.com/Tracking?ascend_header=1&clienttype=dotcom&cntry_code=us&language=english&tracknumbers=776812461212825)**

我使用了 w3school.com 中提供的技术，但它显示“访问被拒绝”。为什么显示“拒绝访问”？请解决我的问题..

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-07T07:23:57.610

如果您通过尝试直接从您自己域上的 Javascript/网站访问 FedEx URL 来进行屏幕抓取，那是您的问题。如果您真的想这样做，最简单的方法是对您域中某处的脚本进行 AJAX 调用，并让它为您发出跟踪请求。

[查看有关创建代理的信息。](http://developer.yahoo.com/javascript/howto-proxy.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-07T16:13:00.397

Building on Beau Simensen answer, you could make an Ajax call to your own domain:

```
Ajax.Request("http://mydomain.com/proxy.php?url=http://www.fedex.com/Tracking?ascend_header=1&clienttype=dotcom&cntry_code=us&language=english&tracknumbers=776812461212825"); 
```

The proxy.php file would just make a CURL request (or something else) to the url parameter provided and return its result, this way you can access all sites on your local domain through that proxy.php.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-07T07:46:16.397

出于安全原因，Ajax/XMLHttpRequest 调用仅限于同站点策略；您不能使用它们直接加载远程站点。Firefox 3.1[显然](https://developer.mozilla.org/En/HTTP_Access_Control)增加了对跨站点请求的支持，但我还没有听说是否有其他浏览器支持。

# linux - SVN中结帐和导出的区别

> ID：419467
> 
> 赞同：76
> 
> 时间：2009-01-07T07:22:47.283
> 
> 标签：linux, svn, export, svn-checkout

SVN 结帐和 SVN 导出之间的确切区别是什么？

据我所知，export 不包括包含元数据的 .svn 目录，而 checkout 包括该 .svn 目录。然而，我的同事最近遇到了这个问题，即从签出和从 SVN 存储库导出的源编译的东西有不同的行为。它们都编译正确，但是编译`svn export`的那个可以工作，但是签出的那个根本不起作用。

PS：正在编译的东西是嵌入式设备中使用的 Linux 2.4 内核。图像可以正确编译和加载，但检出的图像不起作用。它会在 insmod 期间导致内核崩溃。为什么会发生这种情况？

PPS：我们尝试了校验和和差异工具来检查从 SVN 导出和签出的两个目录之间的差异。除了 .svn 目录之外，它们都是相同的。

* * *

## 回答 #1

> 赞同：105
> 
> 时间：2009-01-07T07:26:44.797

`svn export`只是从修订中提取所有文件，并且不允许对其进行修订控制。它也不会在每个目录中乱扔 .svn 目录。

`svn checkout`允许您在创建的目录中使用版本控制，例如您的标准命令，例如`svn update`和`svn commit`.

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-01-07T07:26:16.670

正如您所说，结帐包括 .svn 目录。因此它是一个工作副本，并且将具有适当的信息来进行提交（如果您有许可）。如果您进行导出，则您只是获取存储库当前状态的副本，并且无法提交任何更改。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2011-02-22T11:35:49.397

您是重新运行结帐还是导出到现有目录？

因为如果您是，结帐将更新工作副本，包括删除任何文件。

但是导出只会将所有文件从存储库传输到目标 - 如果目标是同一目录，这意味着存储库中删除的任何文件都不会被删除。

因此，您导出副本可能仅起作用，因为它依赖于已在存储库中删除的文件？

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-01-07T08:18:14.707

构建过程是否有机会查看子目录并包含不应该包含的内容？顺便说一句，您可以进行合法结帐，然后删除 .svn 及其包含的所有内容。这应该给你和出口一样的东西。尝试在删除元数据之前和之后编译它，就像它一样。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-08-12T12:25:02.717

（补充杰拉德的回答......）另一个微妙的区别是，虽然命令：

`svn checkout ...repos_location/my_dir .`

将文件`my_dir`放入当前目录（与`.svn`文件夹）

在某些版本的 svn 中，命令：

`svn export ...repos_location/my_dir .`

将在当前目录中创建一个名为的文件夹`my_dir`，然后将导出的文件放入其中。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-07T07:37:54.273

如果您想上传（或给某人）一个项目，请使用导出。如果您正在处理项目，请使用结帐。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-07T18:03:07.180

额外的沉思。你说 insmod 崩溃了。Insmod 加载模块。这些模块是在构建内核的另一个编译操作中构建的。内核和模块必须从相同的头文件构建等等。是在内核构建期间构建的所有模块，还是它们“存在”？

另一个我不太了解的想法是 svn externals，它（如果使用）会影响到您的项目中签出的内容。看看导出时是否有任何不同。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-10-17T06:07:49.820

非常简单的区别，如果您只想查看项目的结构，请进行导出。

如果你想处理你的文件，那么你需要签出，因为它将包含 .svn 文件夹，其中包含制作工作副本的元数据，否则你会在导出时遇到错误。

如果你这样做`svn export`然后编辑一些文件然后提交，那么你会得到一个错误：

> ../../xxx 不是您的工作副本。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2019-12-11T08:49:27.577

如果您使用的是 tortoise svn 客户端 - 在导出时 - 它会显示 ..export / checkout ，这很令人困惑，它只是导出而已。仅查看/读取使用 export ，提交使用 - “checkout”

# cocoa-touch - 更改时有一个 UITableView 动画的 reloadData

> ID：419472
> 
> 赞同：199
> 
> 时间：2009-01-07T07:25:26.327
> 
> 标签：cocoa-touch, animation

我有一个 UITableView 有两种模式。当我们在模式之间切换时，我有不同数量的部分和每个部分的单元格。理想情况下，当表格增长或缩小时，它会做一些很酷的动画。

这是我尝试过的代码，但它什么也没做：

```
CGContextRef context = UIGraphicsGetCurrentContext(); 
[UIView beginAnimations:nil context:context]; 
[UIView setAnimationCurve:UIViewAnimationCurveEaseInOut]; 
[UIView setAnimationDuration:0.5]; 

[self.tableView reloadData];
[UIView commitAnimations]; 
```

关于我如何做到这一点的任何想法？

* * *

## 回答 #1

> 赞同：406
> 
> 时间：2011-09-23T12:24:23.743

其实很简单：

```
[_tableView reloadSections:[NSIndexSet indexSetWithIndex:0] withRowAnimation:UITableViewRowAnimationFade]; 
```

从[文档中](https://developer.apple.com/documentation/uikit/uitableview/1614954-reloadsections?language=objc#discussion)：

> 调用此方法会使表视图向其数据源询问指定部分的新单元格。表格视图动画插入新单元格，因为它动画旧单元格。

* * *

## 回答 #2

> 赞同：290
> 
> 时间：2012-11-07T00:45:16.040

您可能想使用：

**Objective-C**

```
[UIView transitionWithView: self.tableView
                  duration: 0.35f
                   options: UIViewAnimationOptionTransitionCrossDissolve
                animations: ^(void)
 {
      [self.tableView reloadData];
 }
                completion: nil]; 
```

**迅速**

```
UIView.transitionWithView(tableView,
                          duration: 0.35,
                          options: .TransitionCrossDissolve,
                          animations:
{ () -> Void in
    self.tableView.reloadData()
},
                          completion: nil); 
```

**斯威夫特 3、4 和 5**

```
UIView.transition(with: tableView,
                  duration: 0.35,
                  options: .transitionCrossDissolve,
                  animations: { self.tableView.reloadData() }) // left out the unnecessary syntax in the completion block and the optional completion parameter 
```

没有麻烦。:D

您还可以使用任何`UIViewAnimationOptionTransitions`您想要的更酷的效果：

*   `transitionNone`
*   `transitionFlipFromLeft`
*   `transitionFlipFromRight`
*   `transitionCurlUp`
*   `transitionCurlDown`
*   `transitionCrossDissolve`
*   `transitionFlipFromTop`
*   `transitionFlipFromBottom`

* * *

## 回答 #3

> 赞同：83
> 
> 时间：2013-03-10T22:03:13.147

# `CATransition`使用类有更多的自由。

## 它不仅限于褪色，还可以做运动。

* * *

## 例如：

*（别忘了导入`QuartzCore`）*

```
CATransition *transition = [CATransition animation];
transition.type = kCATransitionPush;
transition.timingFunction = [CAMediaTimingFunction functionWithName:kCAMediaTimingFunctionEaseInEaseOut];
transition.fillMode = kCAFillModeForwards;
transition.duration = 0.5;
transition.subtype = kCATransitionFromBottom;

[[self.tableView layer] addAnimation:transition forKey:@"UITableViewReloadDataAnimationKey"]; 
```

更改`type`以符合您的需求，例如`kCATransitionFade`等。

## 在 Swift 中的实现：

```
let transition = CATransition()
transition.type = kCATransitionPush
transition.timingFunction = CAMediaTimingFunction(name: kCAMediaTimingFunctionEaseInEaseOut)
transition.fillMode = kCAFillModeForwards
transition.duration = 0.5
transition.subtype = kCATransitionFromTop
self.tableView.layer.addAnimation(transition, forKey: "UITableViewReloadDataAnimationKey")
// Update your data source here
self.tableView.reloadData() 
```

**[CATransition](https://developer.apple.com/library/mac/#documentation/graphicsimaging/reference/CATransition_class/Introduction/Introduction.html)的参考**

### 斯威夫特 5：

```
let transition = CATransition()
transition.type = CATransitionType.push
transition.timingFunction = CAMediaTimingFunction(name: CAMediaTimingFunctionName.easeInEaseOut)
transition.fillMode = CAMediaTimingFillMode.forwards
transition.duration = 0.5
transition.subtype = CATransitionSubtype.fromTop
self.tableView.layer.add(transition, forKey: "UITableViewReloadDataAnimationKey")
// Update your data source here
self.tableView.reloadData() 
```

* * *

## 回答 #4

> 赞同：61
> 
> 时间：2010-04-29T03:53:53.727

我相信你可以更新你的数据结构，然后：

```
[tableView beginUpdates];
[tableView deleteSections:[NSIndexSet indexSetWithIndex:0] withRowAnimation:YES];
[tableView insertSections:[NSIndexSet indexSetWithIndex:0] withRowAnimation:YES];
[tableView endUpdates]; 
```

此外，“withRowAnimation”并不完全是布尔值，而是一种动画样式：

```
UITableViewRowAnimationFade,
UITableViewRowAnimationRight,
UITableViewRowAnimationLeft,
UITableViewRowAnimationTop,
UITableViewRowAnimationBottom,
UITableViewRowAnimationNone,
UITableViewRowAnimationMiddle 
```

* * *

## 回答 #5

> 赞同：26
> 
> 时间：2012-03-20T02:32:32.313

所有这些答案都假设您使用的 UITableView 只有 1 个部分。

要准确处理您有超过 1 个部分的情况，请使用：

```
NSRange range = NSMakeRange(0, myTableView.numberOfSections);
NSIndexSet *indexSet = [NSIndexSet indexSetWithIndexesInRange:range];
[myTableView reloadSections:indexSet withRowAnimation:UITableViewRowAnimationAutomatic]; 
```

（注意：你应该确保你有超过 0 个部分！）

另一件需要注意的事情是，如果您尝试使用此代码同时更新数据源，您可能会遇到 NSInternalInconsistencyException。如果是这种情况，您可以使用与此类似的逻辑：

```
int sectionNumber = 0; //Note that your section may be different

int nextIndex = [currentItems count]; //starting index of newly added items

[myTableView beginUpdates];

for (NSObject *item in itemsToAdd) {
    //Add the item to the data source
    [currentItems addObject:item];

    //Add the item to the table view
    NSIndexPath *path = [NSIndexPath indexPathForRow:nextIndex++ inSection:sectionNumber];
    [myTableView insertRowsAtIndexPaths:[NSArray arrayWithObject:path] withRowAnimation:UITableViewRowAnimationAutomatic];
}

[myTableView endUpdates]; 
```

* * *

## 回答 #6

> 赞同：19
> 
> 时间：2009-01-07T17:02:43.200

解决这个问题的方法是告诉 tableView 删除和添加行和节

`insertRowsAtIndexPaths:withRowAnimation:`,
`deleteRowsAtIndexPaths:withRowAnimation:`,
`insertSections:withRowAnimation:`和
`deleteSections:withRowAnimation:`

UITableView 的方法。

当您调用这些方法时，表格将对您请求的项目进行动画处理，然后对其自身调用 reloadData，以便您可以在此动画之后更新状态。这部分很重要 - 如果您对所有内容进行动画处理但不更改表的 dataSource 返回的数据，则动画完成后行将再次出现。

因此，您的应用程序流程将是：

`[self setTableIsInSecondState:YES];`

`[myTable deleteSections:[NSIndexSet indexSetWithIndex:0] withRowAnimation:YES]];`

只要您的表的 dataSource 方法通过检查`[self tableIsInSecondState]`（或其他方式）返回正确的新部分和行集，这将达到您正在寻找的效果。

* * *

## 回答 #7

> 赞同：18
> 
> 时间：2016-08-10T21:24:16.623

我无法评论最佳答案，但快速实施将是：

```
self.tableView.reloadSections([0], with: UITableViewRowAnimation.fade) 
```

您可以在 reloadSections 的第一个参数中包含想要更新的任意数量的部分。

文档中提供的其他动画： [https ://developer.apple.com/reference/uikit/uitableviewrowanimation](https://developer.apple.com/reference/uikit/uitableviewrowanimation)

**淡入淡出** 插入或删除的一行或多行淡入或淡出表格视图。

**right** 插入的一行或多行从右侧滑入；删除的一行或多行向右滑出。

**left** 插入的一行或多行从左侧滑入；被删除的一行或多行向左滑出。

**top** 插入的一行或多行从顶部滑入；被删除的一行或多行滑向顶部。

**底部** 插入的一行或多行从底部滑入；被删除的一行或多行向底部滑出。

**case none** 插入或删除的行使用默认动画。

**中间** 表格视图试图将新旧单元格保持在它们已经或将占用的空间的中心。适用于 iPhone 3.2。

**自动** 表格视图为您选择合适的动画样式。（在 iOS 5.0 中引入。）

* * *

## 回答 #8

> 赞同：15
> 
> 时间：2018-06-07T10:42:05.753

**@dmarnel 的**Swift 4版本回答：****

 **```
tableView.reloadSections(IndexSet(integer: 0), with: .automatic) 
```

* * *

## 回答 #9

> 赞同：9
> 
> 时间：2014-08-01T19:51:18.710

**快速实施：**

```
let range = NSMakeRange(0, self.tableView!.numberOfSections())
let indexSet = NSIndexSet(indexesInRange: range)
self.tableView!.reloadSections(indexSet, withRowAnimation: UITableViewRowAnimation.Automatic) 
```

* * *

## 回答 #10

> 赞同：8
> 
> 时间：2018-12-06T22:06:25.423

对于**斯威夫特 4**

```
tableView.reloadSections([0], with: UITableView.RowAnimation.fade) 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2018-12-20T08:57:26.767

重新**加载所有部分**，而不仅仅是一个具有**自定义持续时间**的部分。

用于设置自定义持续时间的用户`duration`参数。`UIView.animate`

```
UIView.animate(withDuration: 0.4, animations: { [weak self] in
    guard let `self` = self else { return }
    let indexSet = IndexSet(integersIn: 0..<self.tableView.numberOfSections)
    self.tableView.reloadSections(indexSet, with: UITableView.RowAnimation.fade)
}) 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2015-04-17T18:52:02.393

就我而言，我想在 tableview 中再添加 10 行（用于“显示更多结果”类型的功能），我执行了以下操作：

```
 NSInteger tempNumber = self.numberOfRows;
  self.numberOfRows += 10;
  NSMutableArray *arrayOfIndexPaths = [[NSMutableArray alloc] init];
  for (NSInteger i = tempNumber; i < self.numberOfRows; i++) {
    [arrayOfIndexPaths addObject:[NSIndexPath indexPathForRow:i inSection:0]];
  }
  [self.tableView beginUpdates];
  [self.tableView insertRowsAtIndexPaths:arrayOfIndexPaths withRowAnimation:UITableViewRowAnimationTop];
  [self.tableView endUpdates]; 
```

在大多数情况下，您通常会使用 tableview 的对象数组的计数来代替“self.numberOfRows”。因此，为了确保此解决方案适合您，“arrayOfIndexPaths”需要是插入行的索引路径的准确数组。如果任何索引路径都存在该行，则代码可能会崩溃，因此您应该对这些索引路径使用“reloadRowsAtIndexPaths:withRowAnimation:”方法以避免崩溃

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2015-06-23T16:47:27.280

如果您想将自己的自定义动画添加到 UITableView 单元格，请使用

```
[theTableView reloadData];
[theTableView layoutSubviews];
NSArray* visibleViews = [theTableView visibleCells]; 
```

获得一组可见单元格。然后将任何自定义动画添加到每个单元格。

查看我发布的这个要点，以获得流畅的自定义单元格动画。 [https://gist.github.com/floprr/1b7a58e4a18449d962bd](https://gist.github.com/floprr/1b7a58e4a18449d962bd)

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2016-05-25T17:30:44.093

**在Swift**中没有 reloadData() 的动画可以这样完成（从 2.2 版开始）：

```
tableview.beginUpdates()
var indexPathsToDeleteForAnimation: [NSIndexPath] = []
var numOfCellsToRemove = ArrayOfItemsToRemove ?? 0

// Do your work here
while numOfCellsToRemove > 0 {
    // ...or here, if you need to add/remove the same amount of objects to/from somewhere
    indexPathsToDeleteForAnimation.append(NSIndexPath(forRow: selectedCellIndex+numOfCellsToRemove, inSection: 0))
    numOfCellsToRemove -= 1
}
tableview.deleteRowsAtIndexPaths(indexPathsToDeleteForAnimation, withRowAnimation: UITableViewRowAnimation.Right)
tableview.endUpdates() 
```

如果您需要在动画结束后调用 reloadData()，您可以像这样接受 CATransaction 中的更改：

```
CATransaction.begin()
CATransaction.setCompletionBlock({() in self.tableview.reloadData() })
tableview.beginUpdates()
var indexPathsToDeleteForAnimation: [NSIndexPath] = []
var numOfCellsToRemove = ArrayOfItemsToRemove.count ?? 0

// Do your work here
while numOfCellsToRemove > 0 {
     // ...or here, if you need to add/remove the same amount of objects to/from somewhere
     indexPathsToDeleteForAnimation.append(NSIndexPath(forRow: selectedCellIndex+numOfCellsToRemove, inSection: 0))
     numOfCellsToRemove -= 1
}
tableview.deleteRowsAtIndexPaths(indexPathsToDeleteForAnimation, withRowAnimation: UITableViewRowAnimation.Right)
tableview.endUpdates()
CATransaction.commit() 
```

删除行的情况下显示了逻辑，但同样的想法也适用于添加行。您还可以将动画更改为 UITableViewRowAnimation.Left 以使其整洁，或从其他可用动画列表中进行选择。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2015-11-04T07:49:53.600

```
CATransition *animation = [CATransition animation];
animation.duration = .3;
[animation setType:kCATransitionPush];
[animation setSubtype:kCATransitionFromLeft];
[animation setTimingFunction:[CAMediaTimingFunction functionWithName:kCAMediaTimingFunctionEaseInEaseOut]];
[animation setDuration:.3];

[[_elementTableView layer] addAnimation:animation forKey:@"UITableViewReloadDataAnimationKey"];

[tableView reloadData]; 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2020-11-12T23:03:47.233

UITableView 有一个名为“indexPathsForVisibleRows”的字段，您可以使用“reloadItemsAtIndexPaths”方法为可见行设置动画。

```
 guard let indexPaths = tableView.indexPathsForVisibleRows
    else { return }

    self.tableView.layoutIfNeeded()
    self.tableView.reloadItemsAtIndexPaths(indexPaths, animationStyle: .automatic) 
```

* * *

## 回答 #17

> 赞同：-1
> 
> 时间：2020-05-28T23:42:41.483

**Swift 中的原生`UITableView`动画**

一次插入和删除所有行，`tableView.performBatchUpdates`以便它们同时发生。基于@iKenndac 的答案，使用以下方法：

*   `tableView.insertSections`
*   `tableView.insertRows`
*   `tableView.deleteSections`
*   `tableView.deleteRows`

前任：

```
 tableView.performBatchUpdates({
   tableView.insertSections([0], with: .top)
 }) 
```

这会在零位置插入一个部分，其中包含从顶部加载的动画。这将重新运行该`cellForRowAt`方法并检查该位置的新单元格。您可以使用特定动画以这种方式重新加载整个表格视图。

回复：OP 问题，需要一个条件标志来显示备用表格视图状态的单元格。

# sql - SQL 查询建议 - 获取上一个项目

> ID：419476
> 
> 赞同：0
> 
> 时间：2009-01-07T07:27:35.013
> 
> 标签：sql, sql-server

[我在这里](https://stackoverflow.com/questions/361135/sql-query-advice-most-recent-item)问了相反的问题，现在我面临另一个问题。假设我有以下表格（根据上一篇文章中的海报）

```
客户 ID 姓 名
------ -------- ---------
1 女性测试
2人测试

产品 ID 产品名称
------ --------
123 纽约时报
234波士顿环球报

ProdID IssueID PublishDate
------ -------- -----------
123 1 2008 年 12 月 5 日
123 2 2008 年 12 月 6 日

客户 ID 订单 ID 订单日期
------ -------- ---------
1 1 12/04/2008

OrderID ProdID IssueID 数量
-------- ------ -------- --------
1 123 1 5
2 123 2 12

```

如何按工作日名称从表 3 中获取上一期（发布日期）？今天（星期三）的重要问题不是昨天星期二，而是上周星期三。结果将是 3 列。产品名称、当前问题 (PublishDate) 和上一问题 (PublishDate)。

谢谢

编辑〜这是我面临的一个问题。如果上一个问题不存在怎么办，它也必须回到 pror 周。我尝试了以下作为测试但不起作用

```
SELECT TOP 1 publishdate FROM dbo.issue 
WHERE prodid = 123 AND datename(dw,publishdate) = datename(dw,'2008-12-31') 
ORDER BY publishdate desc 
```

这是在 SQL Server 2000 上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-07T08:29:54.747

可以假设 IssueID 正确排序，即。每个下一个问题的 ID 都大 1？

在这种情况下，这样的事情应该起作用：

```
SELECT Curr.ProdID, Curr.PublishDate As CurrentIssue, Prev.PublishDate AS PrevIssue
FROM Issues Curr, Issues Prev
WHERE ProdID=123 AND Curr.PublishDate='12/06/2008' AND Prev.IssueID=Curr.IssueID - 1 
```

否则需要有一种方法来确定哪个日期对于上一期（上周，上个月？）是正确的，并使用带有日期减法的子选择。

PS 如果您还包括表的名称以便于参考，并且还指定您正在使用的 SQL 服务器，那就太好了，例如，日期函数语法在它们之间有很大的不同。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-07T09:22:19.213

也许像（语法可能不正确）

```
select ProdID, IssueID, max(PublishDate) 
where PublishDate<'2008-1-1'
group by ProdID, IssueID 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-07T11:44:29.720

您可以使用这样的子查询

```
(SELECT TOP (1) PublishDate From Table3 as newName WHERE newName.PublishDate < PublishDate ORDER BY PublishDate DESC) As PrevDate 
```

我在头上写了这个，您可能还需要过滤产品 ID，并且可能需要更改一些内容。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-07T16:58:36.420

我认为您是说在这种情况下，您对“上一期”的定义是“在前一周的同一天出现的问题”。

这能实现你想要的吗？（调用您的“表 2”产品和您的“表 3”问题。）

```
SELECT ProdName, current.IssueID, previous.IssueID
  FROM products, issues current, issues previous
  WHERE current.prodID = products.prodID
    AND previous.prodID = current.prodID
    AND previous.publishDate = current.publishDate - 7; 
```

目前尚不清楚您是否需要最新一期、本周所有问题或所有问题的此信息。您可以在 current.publishDate 上添加一个条件来限制查看哪些“当前”问题。

我假设以前的问题总是存在的。如果它可能没有（某些产品跳过几天），您可能需要在“当前”和“以前”之间进行外部连接。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-07T11:11:23.300

使用 ROW_NUMBER() 分析函数（PARTITION BY ProdID ORDER BY PublishDate DESC）。将 MAX(PublishDate) 与给定分析函数的值为 2 的行结合起来。

它在 Oracle 中工作，并且 SQL Server 规范对于这个函数似乎是相同的，所以它应该工作。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-12T16:59:07.517

今天或昨天或前一天是否存在问题不应该成为问题。您有一个包含发布日期的集合。您知道所有有效的发布日期。因此，您需要此集合中最大的 publishDate，其中 publishDate 小于今天的日期。

# x86 - SMP多线程如何共享内存和中断？

> ID：419486
> 
> 赞同：9
> 
> 时间：2009-01-07T07:36:30.377
> 
> 标签：x86, kernel, multicore, osdev

我正在为我的内核做一些输入缓冲区的工作，我有一些问题。在双核机器上，我知道可以同时运行多个“进程”。我不知道操作系统和各个程序如何保护数据冲突。

关于这个话题，我想知道两件事：

(1) 中断发生在哪里？它们是否保证发生在一个核心上而不是另一个核心上，这是否可以用来确保一个核心上的实时操作不会被另一个核心上可以处理的文件 IO 中断？（我从逻辑上假设中断会发生在第一个核心上，但这总是正确的，你怎么知道？或者也许每个核心都有自己的中断设置？这不会导致每个核心都发生中断吗？核心可以同时对同一个中断做出反应，可能以不同的方式？）

(2) 双核处理器如何处理操作码内存冲突？如果一个核心正在读取内存中的地址，而另一个核心正在写入内存中的同一地址，会发生什么？是抛出异常，还是读取了值？（我假设写入会以任何一种方式工作。）如果读取了一个值，是否保证它是碰撞时的旧值或新值？

我知道理想情况下应该编写程序以避免这些并发症，但操作系统当然不能指望这一点，并且需要能够处理此类事件而不会自己窒息。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-22T18:33:44.267

在 x86 处理器中，这是由 APIC 处理的。[您可以在英特尔® 64 和 IA-32 架构软件开发人员手册](http://www.intel.com/products/processor/manuals/ "英特尔® 64 和 IA-32 架构软件开发人员手册")中查看详细信息，特别是在[第 3 卷](http://www.intel.com/Assets/PDF/manual/253668.pdf "英特尔® 64 和 IA-32 架构软件开发人员手册第 3A 卷：系统编程指南")第 9[章和 x2APIC 规范](http://www.intel.com/Assets/PDF/manual/318148.pdf "英特尔® 64 位架构 x2APIC 规范")中。

如果您不想深入了解所有细节，我将简要介绍一下。

中断可以来自三个不同的来源：

*   外部引脚（在高达 Core i7 的 Intel 处理器中，您有 LINT0、LINT1、SMI、INIT。我不知道它们在 Core i7 或 AMD 或 Via 处理器中的名称）。
*   总线事务。这是现代系统中一个线程向另一个线程发送中断的主要方式。它们被称为**IPI** **-**处理器间**中断**。
***   内部事件，例如热中断、事件监视器或内部错误。**

 **每个逻辑处理器（SMT 系统中的线程、非 SMT 多核系统中的内核、非 SMT 非多核系统中的处理器）都有一个 APIC。APIC 控制逻辑处理器如何响应任何此类中断。

简而言之：

SMI 和 INIT 引脚始终分别连接到 SMI 或 INIT。

如果 APIC 被禁用，LINT0 被路由到 INTR，LINT1 被路由到 NMI，并且 IPI 被忽略。

如果启用：

*   **LINT0** 、 LINT1 、热事件、事件监视器和错误在**LVT** （逻辑向**量表**）中都有一个条目，指定它是否被屏蔽，如果没有，它将是什么类型的中断。
*   处理 IPI。IPI 包括中断类型（即 INTR、SMI、NMI、INIT、SIPI）和目的地。每个逻辑处理器都有一个 APIC-ID，即 . 如果 IPI 的目标与其 ID 匹配，则它处理中断。否则它会忽略它。

如果您想了解有关启用 APIC、LVT 编程、设置 APIC-ID 和发送 IPI 的详细信息，您必须查看我链接到的手册。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-12T10:19:16.390

操作系统开始设置处理中断的位置。Linux 对中断进行负载平衡，以便它们可以由两个 CPU 处理。每个中断处理程序都需要获取一个锁，以避免在不同的 CPU 上同时执行相同的处理程序，还可以防止其他内核代码在非中断上下文中运行并访问相同的数据结构。但是，我认为可以在给定的 CPU 上绑定给定中断的执行。

关于问题（2）：保证与SMP机器给出的保证基本相同，即不抛出异常，结果取决于谁先执行/将值提交到内存/将值提交到共享缓存。无论如何，您都不能依赖读取值 - 事实上，给出的保证远没有您预期的那么强大。

在 Internet 上（在 Google 或 Wikipedia 上）查看什么是数据竞争，并从研究如何在 Java 中正确编写多线程代码开始。学习这让我更容易理解 Linux 内核的并发机制。

或者只是去[C/C++ 几乎“官方”的内存模型常见问题解答](http://www.hpl.hp.com/personal/Hans_Boehm/c++mm/)、Linux 内核源代码树中的 Documentation/memory-barriers.txt 或[Jeremy Manson 的关于该问题的帖子](http://jeremymanson.blogspot.com/2007/08/atomicity-visibility-and-ordering.html)。无论如何，我忘了指出您读取的值不一定是由某个处理器实际写入的。对于 32 位值，这是由 32 位写入是原子的事实来保证的。对于 64 位值，这通常不是真的（我不确定 64 位平台，但由于可移植性的原因，我通常不依赖它）。

无论如何，如果您发现自己在问这个问题，您可能应该改进代码使用的锁定。在内核中工作，您首先需要编写自己的自旋锁/信号量库来解决这个问题。

当您说“您的内核”时，您的意思并不清楚，但我认为您实际上不太可能是指“我正在编写的内核”。无论如何，我不会让任何人提出问题 (2) 在我的机器上运行多线程程序 :-)。

> 我知道理想情况下应该编写程序以避免这些并发症，但操作系统当然不能指望这一点，并且需要能够处理此类事件而不会自己窒息。

这个问题的答案是你在编写用户空间多线程程序时需要知道的。好吧，您不需要知道“您读取的值”的确切答案，但仅仅因为您不能依赖它，即使您为特定处理器编写汇编代码，它也是实现定义的。仅仅因为您不能依赖两个并行线程的相对速度。曾经。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-07T08:10:47.483

IA-32 参考手册将明确回答您的问题。

我的直觉是两个内核 rx 都会中断，操作系统会对其进行排序。每个内核上可能都有一个设置寄存器，用于指定哪个内核获得哪个中断。

碰撞。没有保证。更准确地说，研究缓存机制以及它们如何解决一致性问题。

对于与此相关的其他线程：

[多核/多 CPU 机器中的中断如何工作？](https://stackoverflow.com/questions/301018/how-do-interrupts-in-multicore-multicpu-machines-work)

# dynamics-crm - 如何在 BizTalk 2006 中为 MS CRM 3.0/4.0 创建动态发送端口？

> ID：419497
> 
> 赞同：2
> 
> 时间：2009-01-07T07:44:09.630
> 
> 标签：dynamics-crm, biztalk, dynamics-crm-3

你好 ，

我想为 MS CRM 3.0/4.0 适配器创建一个动态发送端口。但我不知道如何创建它？此外，我没有任何方法来设置访问 CRM 所需的用户名和密码。

CRM URL 是：[http://localhost:5555](http://localhost:5555)

用户名：管理员

密码：密码

组织名称：MicrosoftCRM

我安装了 MS CRM 适配器[既适用于 3.0/4.0 通用，也适用于 CRM 4.0 的单独适配器]。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-07T08:07:25.010

从 BizTalk 端有很多配置。

我建议看看这个博客，因为它介绍了 MS CRM Web 服务，包括他们的 FetchXML 语法和 BizTalk 适配器。

[https://blogs.msdn.com/brajens/archive/2007/05/27/using-microsoft-biztalk-dynamics-crm-adapter-part-1.aspx](https://blogs.msdn.com/brajens/archive/2007/05/27/using-microsoft-biztalk-dynamics-crm-adapter-part-1.aspx)

[http://blogs.msdn.com/brajens/archive/2007/05/30/using-microsoft-biztalk-dynamics-crm-adapter-part-2.aspx](http://blogs.msdn.com/brajens/archive/2007/05/30/using-microsoft-biztalk-dynamics-crm-adapter-part-2.aspx)

这里还有 CRM SDK Webservices 的链接

[http://msdn.microsoft.com/en-gb/library/aa682250.aspx](http://msdn.microsoft.com/en-gb/library/aa682250.aspx)

和他们一起开发 [http://msdn.microsoft.com/en-gb/library/aa681429.aspx](http://msdn.microsoft.com/en-gb/library/aa681429.aspx)

最后，使用 MS CRM Webservices 的宝贵工具是 [FetchXML Builder](http://jamesdowney.net/blog/page/Request-FetchXML-Builder-Key.aspx)

**

1.  您还应该阅读 MS CRM 4 的安装指南，因为还有使用当前和不同 CRM 帐户设置 BizTalk 适配器的过程。

**

[http://www.microsoft.com/downloads/details.aspx?FamilyID=1ceb5e01-de9f-48c0-8ce2-51633ebf4714&displaylang=en](http://www.microsoft.com/downloads/details.aspx?FamilyID=1ceb5e01-de9f-48c0-8ce2-51633ebf4714&displaylang=en)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T20:55:06.120

**工作解决方案**

这是你需要做的...

添加 Dynamics CRM 属性架构“PropertySchema.xsd”。在 Microsoft CRM Dynamics BizTalk 适配器安装文件夹中找到此架构

```
C:\Program Files\[CRM Adapter installation folder]\Schemas 
```

在编排中设置以下属性

```
// NOTE: Use the complete MS CRM 4.0 Web Service URL and not the short form
    CrmQueryRequest(PropertySchema.ServerUrl)  
        = "http://server_name/MSCRMServices/2007/CrmService.asmx";
    CrmQueryRequest(PropertySchema.UserName) = @"domain-name\user-name";
    CrmQueryRequest(PropertySchema.Password) = @"p@ssword";

    CRMQueryPort(Microsoft.XLANGs.BaseTypes.Address)="http://server_name/MSCRMServices/2007/CrmService.asmx";
    // The name of the adapter listed in the BizTalk administration console
    CRMQueryPort(Microsoft.XLANGs.BaseTypes.TransportType) = "Microsoft Dynamics CRM 4.0"; 
```

有关动态端口的更多信息，请通过...

[我的代码项目文章](http://www.codeproject.com/KB/biztalk/DynamicRouting.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-09T09:08:11.017

不幸的是，我没有任何特定于 CRM 的经验，也没有可以用来测试的 CRM 系统，但我会尽我所能“离线”提供帮助。

从动态发送要求开始 - 我查看了从注册表项开始的适配器设置 (HKEY_CLASSES_ROOT\CLSID{D38D5DCC-2B30-43b9-9C69-3BBFD0926986})，我找到了此适配器的注册别名 - “MicrosoftDynamicsCRM ://"

基于此，当您在进程中设置动态端口的 url 时，您是否尝试过使用此别名作为所需 url 的前缀？

BizTalk 使用别名来决定将哪个适配器用于动态发送端口。

至于用户名/密码 - 查看 adpater 的安装文件夹，我可以看到有一个 schemas 文件夹，其中有一个 propertySchema.xsd - 这个包含我假设用于控制 adpater 在运行时的行为的上下文属性（因为这个几乎总是这样） - 架构包含用户名和密码的属性 - 我会尝试在传出消息上设置它们；它们很可能被适配器使用。

顺便说一句 - 第三个属性是“serverUrl” - 您可能想尝试设置它以覆盖为静态端口配置的任何 url 作为执行“动态发送”的一种方式，尽管如果您可以让动态发送端口工作，并且你应该可以，我认为这是更好的方法

重要说明 - 至少在我的机器上，属性模式没有作为服务器安装的一部分部署，因此您可能需要手动部署它（并从您的项目中引用它）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-16T11:53:43.447

嗨，我收到**MS CRM 动态请求响应发送端口的新错误**

1.在发送端口“CreateContactOrch_1.0.0.0_CreateContactOrch.Orchestration_1_Dynamic_CRM_Solicit_Response_Port_8de755fbdbd4eff7”上发送到适配器**“Microsoft Dynamics CRM”**的消息被暂停 ， **URI 为“MicrosoftDynamicsCRM:// [http://10.1.3.140:5555](http://10.1.3.140:5555) ” 。****错误详细信息：文件“/metadataservice.asmx”不存在。** 消息 ID：{79866086-E694-4965-A6A4-83AD3D83D6F4} 实例 ID：{95B7B876-6710-4230-851D-8ABD6DA10795}

2.在发送端口“CreateContactOrch_1.0.0.0_CreateContactOrch.Orchestration_1_Dynamic_CRM_Solicit_Response_Port_8de755fbdbd4eff7”上发送到适配器**“Microsoft Dynamics CRM”的消息被暂停，** **URI 为“MicrosoftDynamicsCRM://10.1.3.140:5555”**。 **错误详细信息：文件“/metadataservice.asmx”不存在。** 消息 ID：{C34375C3-56D5-465F-96D1-3D72C34B7F67} 实例 ID：{1B6AD9FE-9984-4F55-8852-60B095DD9F3F}

# c# - 如何从 C# 中的预编译器获取当前日期时间？

> ID：419507
> 
> 赞同：6
> 
> 时间：2009-01-07T07:49:07.670
> 
> 标签：c#, .net, c-preprocessor

在 C# 3.0 中，我有一个属性，它应该包含类的版本。版本号只是编译的日期和时间。现在，我有以下代码：

```
public DateTime Version
{
    get { return DateTime.UtcNow; }
} 
```

显然，这是错误的，因为这个属性返回给我当前的日期和时间。**那么，预编译器是否可以在编译时*打印*DateTime？**在这种情况下，我可以做类似下面的事情。

```
public DateTime Version
{
    get { return new DateTime("PRECOMPILER DATE"); }
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-07T08:31:45.790

您可以从 dll 本身中检索它（[来源：codinghorror](http://www.codinghorror.com/blog/archives/000264.html)）

```
 private DateTime RetrieveLinkerTimestamp() {
        string filePath = System.Reflection.Assembly.GetCallingAssembly().Location;
        const int c_PeHeaderOffset = 60;
        const int c_LinkerTimestampOffset = 8;
        byte[] b = new byte[2048];
        System.IO.Stream s = null;

        try {
            s = new System.IO.FileStream(filePath, System.IO.FileMode.Open, System.IO.FileAccess.Read);
            s.Read(b, 0, 2048);
        } finally {
            if (s != null) {
                s.Close();
            }
        }

        int i = System.BitConverter.ToInt32(b, c_PeHeaderOffset);
        int secondsSince1970 = System.BitConverter.ToInt32(b, i + c_LinkerTimestampOffset);
        DateTime dt = new DateTime(1970, 1, 1, 0, 0, 0);
        dt = dt.AddSeconds(secondsSince1970);
        dt = dt.AddHours(TimeZone.CurrentTimeZone.GetUtcOffset(dt).Hours);
        return dt;
    } 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-07T07:53:54.227

C#没有宏的概念；但是，您可以在构建脚本（csproj / NANT / 等）中使用其他工具在源代码编译之前对其进行操作。例如，我使用它来将修订号设置为当前的 SVN 修订。

一个便宜的选项是预构建事件（您可以通过 VS 中的项目属性对话框来执行此操作）：本质上是一个在构建之前运行的 bat 文件；然后，您可以编写所需的任何更改。一个更复杂的选项是构建任务。

例如，[这里](http://msbuildtasks.tigris.org/)的实用程序库包括一个`Time`任务和一个`FileUpdate`任务；它应该（理论上）可以将两者链接在一起以模拟您需要的东西。

就个人而言，我会使用`[AssemblyVersion]`细节而不是时间——如果你将它链接到你的源代码控制系统，这将很容易找到有问题的版本；所以对于我的 SVN 版本，然后我使用（在我的构建项目中）：

```
<!-- See http://msbuildtasks.tigris.org -->
<Import Project="$(MSBuildExtensionsPath)\MSBuildCommunityTasks\MSBuild.Community.Tasks.Targets"/>
...
<SvnInfo LocalPath=".">
  <Output TaskParameter="Revision" PropertyName="BuildRev" />
</SvnInfo>
...
<FileUpdate Files="Path\To\My\AssemblyInfo.cs"
    Regex='(\[\s*assembly:\s*AssemblyVersion\(\s*"[^\.]+\.[^\.]+)\.([^\.]+)(\.)([^\.]+)("\)\s*\])'
    ReplacementText='$1.$2.$(BuildRev)$5' />
<FileUpdate Files="Path\To\My\AssemblyInfo.cs"
    Regex='(\[\s*assembly:\s*AssemblyFileVersion\(\s*"[^\.]+\.[^\.]+)\.([^\.]+)(\.)([^\.]+)("\)\s*\])'
    ReplacementText='$1.$2.$(BuildRev)$5' /> 
```

现在我的程序集版本是正确的，包括操作系统报告的文件版本。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-07T07:58:45.153

C#中的预处理器指令没有等效`__TIME__`项，您可以做的最好的事情是获取当前程序集并获取创建日期，它将包含编译时间。看[这里](http://www.eggheadcafe.com/software/aspnet/31622500/timestamp-and-time.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-07T08:02:23.087

我认为在 C# 中没有办法做到这一点 - C++ 风格的宏定义被明确禁止。

您可以使用程序集的最后修改日期来解决它，或者可能包含一个文本文件作为嵌入式资源并添加一个自定义构建操作，将当前日期/时间写入其中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-07T08:13:13.190

没有预处理器`__TIME__`指令，但您可以使用其他东西，例如程序集的创建时间。您也可以考虑使用源代码控制系统中的关键字替换（在 subversion 中为 $Date$）。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-01-07T08:47:56.660

可以从程序集的元数据中检索内部版本号，并且可以将其设置为与构建日期相匹配[。](http://msdn.microsoft.com/en-us/library/system.version.build.aspx)

通常您会在 AssemblyInfo.cs 文件中找到或创建一个条目。使用 Visual Studio 创建项目时。一个例子：

```
[assembly: AssemblyVersion("1.0.*")] 
```

对[AssemblyVersionAttribute](http://msdn.microsoft.com/en-us/library/system.reflection.assemblyversionattribute.aspx)文档的引用。（我把一些重要的部分加粗了）

> *您可以指定所有值，也可以使用星号 ( )***接受默认内部版本号、修订号或两者。*例如，[assembly:AssemblyVersion("2.3.25.1")] 表示 2 为主要版本，3 为次要版本，25 为内部版本号，1 为修订号。* ***诸如 [assembly:AssemblyVersion("1.2.*** **")] 的版本号指定 1 作为主要版本，2 作为次要版本，并接受默认的构建和修订号。**诸如 [assembly:AssemblyVersion("1.2.15.*")] 的版本号指定 1 作为主要版本，2 作为次要版本，15 作为内部版本号，并接受默认修订号。**默认内部版本号每天递增。默认修订号是随机的。****

 **如您所见，如果您可以使用此设置默认内部版本号。默认内部版本号是每天递增的值。

然后，您可以使用[AssemblyName.Version](http://msdn.microsoft.com/en-us/library/system.reflection.assemblyname.version.aspx)属性检索内部版本号。MSDN 提供的示例应该可以帮助您。

默认内部版本号是自 2000 年 1 月 1 日以来的天数。

[这个问题](https://stackoverflow.com/questions/356543/can-i-automatically-increment-the-file-build-version-when-using-visual-studio)对如何使用它也有明确的解释。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-08-28T08:17:33.250

您是否正在寻找这样的东西：（
通过 Version-Info 获取构建程序集的日期；Build-Number 是自 1.1.2000 以来的天数）

```
 var version = System.Reflection.Assembly.GetExecutingAssembly().GetName().Version;
        DateTime versionsDatum = new DateTime(2000, 1, 1);
        versionsDatum = versionsDatum.AddDays(version.Build); 
```

# windows - SVN 存储库的 Windows 备份

> ID：419511
> 
> 赞同：16
> 
> 时间：2009-01-07T07:53:07.443
> 
> 标签：windows, svn, backup

我在我的 Windows Server 上运行 SVN 服务器，并想安排一个自动备份过程。我将永远是唯一一个在存储库上工作的人。我应该使用 hotcopy 还是可以使用简单的 Windows 备份应用程序来备份存储库？xcopy 或 robocopy 呢？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-07T08:04:10.820

我发现简单地复制/粘贴（XCopy）存储库是最简单的解决方案。您可能需要考虑在复制之前将存储库转储到单个文件，因为我发现复制单个大文件比复制一堆小文件要快得多。如果您的存储库很小，这可能不是问题，但需要考虑：

```
svnadmin dump /path/to/repository > repository-name.dmp 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-07T08:10:30.777

一种重复的[SVN 备份..热拷贝就足够了，还是我应该担心完整和增量转储？](https://stackoverflow.com/questions/309322)问题。

不要忘记思考：

*   备份的频率（如果它在两次备份之间崩溃会发生什么？）
*   清理过程（你想随着时间的推移保留多少备份？）
*   可用空间管理（每个备份占用什么样的磁盘空间？）
*   恢复过程：测试它；）从未测试过的备份不是“真正的”备份；）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-07T07:58:12.173

只要您确定在备份存储库时没有人访问（尤其是提交）存储库，就不需要使用 hotcopy。您可以使用所需的任何工具简单地复制/备份存储库。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-07T08:36:39.273

您可以作为唯一的用户，因为您知道在备份期间您永远不会提交更改，（对吗？:) 尽管如此，使用热复制或转储似乎没有任何“麻烦”。它们同样易于使用。

另外，如果您使用它，您将获得两个奖金。一种是如果您的情况发生变化（您让更多人使用您的存储库），您不必记住并返回并更改您的操作方式。第二个是，如果在恢复时遇到问题，你真的不想发布这样的问题，“我只是通过制作 repo 的副本来进行备份......”

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-07T07:56:21.617

我使用[Mozy Home](http://mozy.com/home)来备份我所有的个人开发文件（Subversion、Visual Studio 项目等）。它很简单，不占用太多资源，易于配置，最重要的是：免费。

我曾想过使用 xcopy 或类似的东西编写自己的备份解决方案，但为什么要重新发明轮子呢？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-05-08T15:06:21.330

如果 SVN 存在于您的计算机中，您可以使用简单的文件副本，最安全的方法是使用转储备份。

请记住，您必须将备份保存在计算机之外，这里有一个免费的 svn 备份[工具](http://www.bitframeworks.com/en-bit/index.php/our-frameworks/bit-svnbackup)

它进行两种备份、热复制和转储，并将其发送到您的电子邮件或 FTP

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-04-22T07:51:17.603

这是一个用于转储本地和远程颠覆存储库的 GUI Windows 工具：

[SVN 备份工具](https://falsinsoft-software.blogspot.com/p/svn-backup-tool.html)

工具说明说：

*这个简单的工具允许对本地和远程 Subversion 存储库进行转储备份。该软件的工作方式与“svnadmin”相同，但不是它的 GUI 前端。而是直接使用 subversion 库来允许在独立模式下创建转储，而无需任何其他附加工具。*

您的问题是这个工具需要手动启动才能进行备份，目前没有自动备份计划。

# iphone - 从终端启动 xcodeproj

> ID：419517
> 
> 赞同：6
> 
> 时间：2009-01-07T07:59:28.257
> 
> 标签：iphone, xcode

我试图`xcodeproj`在命令行中构建和编译我的，它现在正在工作。

那么也可以`xcodeproject`从 Xcode 启动 from 终端吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-07T09:44:40.667

如果要从命令行运行应用程序，请使用

```
打开 /path/to/appname.app

```

“Build and Go”实际上就相当于

```
xcodebuild [参数] && open /path/to/appname.app

```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-09-04T21:10:24.890

从终端运行 Xcode 项目：

`open *.xcodeproj`

创建别名也可能会有所帮助：

```
alias xcode="open *.xcodeproj" 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-07T08:19:00.353

您是否要求从命令行构建命令？

只是：

```
xcodebuild 
```

有很多选项可用于选择非默认选项：

```
Usage: xcodebuild [-project <projectname>] [-activetarget] [-alltargets] [-target <targetname>]... [-parallelizeTargets] [-activeconfiguration] [-configuration <configurationname>] [-sdk <sdkfullpath>|<sdkname>] [<buildsetting>=<value>]... [<buildaction>]...
   xcodebuild [-version [-sdk <sdkfullpath>|<sdkname>]]
   xcodebuild [-showsdks]
   xcodebuild [-find <binary>] [-sdk <sdkfullpath>|<sdkname>]
   xcodebuild [-list] 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-13T23:31:03.637

xcodebuild - 配置调试；打开 /path/to/build/Debug/your.app

顺便说一句，您只需执行不带路径或扩展名的 open -a 即可使用给定文档打开任何 LaunchServices-findable 应用程序，例如 open -a Xcode myProject.xcodeproj

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-02-13T05:23:03.910

在终端中，在您的项目目录中，只需运行：

```
xed . 
```

**奖励：** `xed`将正确选择`.xcworkspace`是否可用。

# c# - 将 Unicode 设置为控制台编码时出现“参数不正确”

> ID：419518
> 
> 赞同：6
> 
> 时间：2009-01-07T07:59:38.990
> 
> 标签：c#, encoding

我收到以下错误：

```
Unhandled Exception: System.IO.IOException: The parameter is incorrect.
 at System.IO.__Error.WinIOError(Int32 errorCode, String maybeFullPath)
 at System.IO.__Error.WinIOError()
 at System.Console.set_OutputEncoding(Encoding value)
 at (my program) 
```

当我运行以下代码行时：

```
 Console.OutputEncoding = Encoding.Unicode; 
```

知道为什么吗？如果我将编码设置为 UTF8，则不会出现此错误。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-28T01:16:04.003

Encoding.Unicode 是 UTF-16，它使用 2 个字节对所有字符进行编码。ASCII 字符（英文字符）在 UTF-8 中是相同的（单字节，相同的值），所以这可能就是它起作用的原因。

我的猜测是 Windows Command Shell 并不完全支持 Unicode。有趣的是，Powershell 2 GUI 确实支持 UTF-16（据我所知），但程序在那里抛出了同样的异常。

以下代码有效，表明 Console 对象可以重定向其输出并支持 Encoding.Unicode：

```
FileStream testStream = File.Create("test.txt");
TextWriter writer = new StreamWriter(testStream, Encoding.Unicode);
Console.SetOut(writer);            
Console.WriteLine("Hello World: \u263B");  // unicode smiley face
writer.Close(); // flush the output 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-15T20:39:33.553

根据[MSDN 上的 Code Page Identifiers](http://msdn.microsoft.com/en-us/library/dd317756(VS.85).aspx)列表，UTF-16 和 UTF-32 编码是仅托管的：

```
1200   utf-16       Unicode UTF-16, little endian byte order (BMP of ISO 10646); available only to managed applications
1201   unicodeFFFE  Unicode UTF-16, big endian byte order; available only to managed applications
12000  utf-32       Unicode UTF-32, little endian byte order; available only to managed applications
12001  utf-32BE     Unicode UTF-32, big endian byte order; available only to managed applications 
```

例如，它们没有与 HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Nls\CodePage 下的其他系统代码页一起列在注册表中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-07T08:12:47.357

我认为这与您使用的`CodePage`有关`Encoding`。特别参见[SetConsoleOutputCP Function](http://msdn.microsoft.com/en-us/library/ms686036(VS.85).aspx)。我不知道更多，对不起。

编辑：我报告了对的引用，`SetConsoleOutputCP`因为这个函数是由 (set operation of) 内部调用的（通过 PInvoke）`Console.OutputEncoding`。

# f# - F# 测量单位 - '提升' 值浮动

> ID：419521
> 
> 赞同：3
> 
> 时间：2009-01-07T08:01:23.853
> 
> 标签：f#, units-of-measurement

从 csv 文件导入数字时，我需要将它们转换为带有单位的浮点数。

目前我使用内联函数执行此操作：

```
data |> List.map float |> List.map (fun n -> n * 1.0<m>) 
```

但我想知道是否有更优雅的方法来做到这一点 - 还是我必须创建自己的带有转换功能的“单位”模块？

像这样真的很好，但我怀疑这可能......

```
data |> List.map float |> List.map lift<m> 
```

*这与我之前的问题（[如何普遍删除 F# 度量单位](https://stackoverflow.com/questions/412459/how-to-generically-remove-f-units-of-measure)）相反。*

更新：对于自制装置，我试过这个，效果很好：

```
[<Measure>]
type km = 
    static member lift (v:float) = v * 1.0<km>

data |> List.map float |> List.map km.lift 
```

或者，按照[这个答案中的问题](https://stackoverflow.com/questions/419521/f-units-of-measure-lifting-values-to-floatsomething#424111)

```
data |> List.map (float >> km.lift) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-07T09:58:26.690

看起来度量单位暂时不能是类型参数（不知道这是否会改变）。所以写这个的最短方法是：

```
data |> List.map float |> List.map ((*) 1.0<m>) 
```

编辑

现在也可以`FloatWithMeasure`在这里查看

[http://msdn.microsoft.com/en-us/library/ee806527(VS.100).aspx](http://msdn.microsoft.com/en-us/library/ee806527(VS.100).aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-08T12:49:35.830

有什么理由必须映射两次吗？这有什么问题：

```
data |> List.map (fun x -> (float x) * 1.0<m>) 
```

# java - 使用什么数据挖掘应用程序？

> ID：419524
> 
> 赞同：4
> 
> 时间：2009-01-07T08:03:30.027
> 
> 标签：java, data-mining

我使用的最后一个是[weka](http://www.cs.waikato.ac.nz/ml/weka/) 。我最后一次听说 java 正在为它提出一个 API (JDM)。任何人都可以分享他们使用这些工具的经验。我最感兴趣的是使用分类/聚类工具（weka 在这里做得不错）并且该工具应该具有良好的 API 支持。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-07T08:17:42.120

我使用 Weka 进行文本分类。很不错。书[也](http://www.cs.waikato.ac.nz/~ml/weka/book.html)不错。可以保留数据表示并修改算法的框架的想法很棒。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-24T21:54:36.903

我正在使用[RapidMiner](http://rapid-i.com/content/blogcategory/38/69/)（以前来自多特蒙德大学的 YALE）。它是一个基于 Java 的开源工具，实现了大多数流行的分类器/聚类方法。它还附带了为 Weka 工具包实现的算法，因此那里有更多选项。带有一个非常易于使用的 GUI，以及一个基于 Java 的 API。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-05T09:05:03.327

Weka 是一个流行的数据挖掘平台，为分类、聚类等实现了许多教科书算法。它非常适合快速原型设计，即快速设置系统并验证它是否符合预期目的。

然而，Weka 有两个主要问题。首先是它是在 GPL 许可下分发的，这意味着您不能将其用作商业包的一部分，也不能对其进行修改，也不能发布更改。此外，Weka 的另一个弱点是它不能处理大量数据。如果您的数据无法放入计算机的内存中，那么您就有问题了。

[Apache Mahout](http://lucene.apache.org/mahout/)包解决了这两个问题。它相对较新，缺少一些功能，但根据您遇到的数据挖掘问题，它可能是您的正确选择

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-07T08:35:34.500

我们在为分类和聚类开发的一些软件中使用了 Weka。我不是数据挖掘方面的专家，但是评估它以及许多其他产品的团队肯定知道他们的东西，并且通常习惯于使用非常昂贵的现成产品。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-09-06T19:14:14.430

根据 KDnuggets 2007、2008 和 2009 年年度民意调查，RapidMiner 是全球数据挖掘专家中使用最广泛的开源数据挖掘解决方案： [KDnuggets Data Mining Tool Poll 2009](http://www.kdnuggets.com/polls/2009/data-mining-tools-used.htm)

RapidMiner 是开源的并且 100% Java，RapidMiner 比 Weka 更灵活并且提供更多的功能。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-09-10T04:18:33.537

您真的应该查看 Orange 数据挖掘工具包。它带有一个拖放 gui 以及一个 Python API。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-03-18T16:30:02.180

我使用自己用 Java 开发的软件，专门从事务数据库或序列数据库中挖掘频繁模式和关联规则：

[http://www.philippe-fournier-viger.com/spmf/](http://www.philippe-fournier-viger.com/spmf/)

它提供了 46 种算法，包括一些您在任何其他流行的数据挖掘软件中都找不到的算法。有GUI版和源代码版。

# signals - 我可以忽略除以零导致的 SIGFPE 吗？

> ID：419527
> 
> 赞同：4
> 
> 时间：2009-01-07T08:05:08.883
> 
> 标签：signals, posix, divide-by-zero, sigfpe

我有一个程序故意执行除以零（并将结果存储在 volatile 变量中）以便在某些情况下停止。但是，我希望能够禁用这种暂停，而无需更改执行除以零的宏。

有没有办法忽略它？

我试过使用

```
#include <signal.h>
...
int main(void) {
  signal(SIGFPE, SIG_IGN);
  ...
} 
```

但它仍然因消息“浮点异常（核心转储）”而死。

我实际上并没有使用该值，所以我并不真正关心分配给变量的内容；0、随机、未定义...

编辑：我知道这不是最便携的，但它适用于在许多不同操作系统上运行的嵌入式设备。默认停止动作是除以零；其他平台需要不同的技巧来强制看门狗引起的重启（例如禁用中断的无限循环）。对于 PC (linux) 测试环境，我想禁用除以零时的暂停，而不依赖于断言之类的东西。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-07T09:00:07.243

好的，首先，您应该使用*sigaction(2)*而不是 deprecated `signal()`。

其次，使用 SIGFPE 来终止程序显然是荒谬的，因为您应该发出 SIGTERM 或 SIGUSR1 之类的信号，而不是因为它的副作用而临时操纵其他一些信号，而忽略其语义价值。更具体地说，*sigaction(2)*的手册页有一个 NOTES 部分，其中包含关于 SIGFPE 的简介，表明您对它的预期用途被破坏的一种或两种方式。

当您想终止时，您应该做的是*raise(3)一个信号。*然后，使用结构中的`sa_handler`字段`sigaction`来更改是忽略 ( `SIG_IGN`) 还是终止 ( `SIG_DFL`) 该信号。

```
诠释主要（无效）{
  结构 sigaction my_action;

  my_action.sa_handler = SIG_IGN;
  my_action.sa_flags = SA_RESTART;
  sigaction(SIGUSR1, &my_action, NULL);

  提高（SIGUSR1）；/* 忽略 */

  my_action.sa_handler = SIG_DFL;
  sigaction(SIGUSR1, &my_action, NULL);

  提高（SIGUSR1）；/* 终止 */

  返回0；
}

```

也就是说，我不明白你为什么要使用信号而不是简单的`exit()`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-07T08:09:53.993

为什么要故意除以零来停止？你不能`exit(-1)`或其他类似的人吗？

尤其是如果您不需要除以 0 的结果，这是没有意义的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-07T09:06:30.070

检查返回值

```
signal(SIGFPE, SIG_IGN); 
```

如果得到`SIG_ERR`，请检查 的值`errno`以找出问题所在。这就是您可以便携地做的尽可能多的事情。

我知道您不想更改除以零，但它是不可移植且违反直觉的。如果发生某些情况，您想进行核心转储，但能够在不编辑代码的情况下禁用此行为？使用`assert`和`NDEBUG`。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-07T08:22:49.427

这不是可移植的，但在 x86 上，您可以通过控制 FPU：

在 Linux 上使用 gcc（我相信其他编译器也有类似的功能）：

```
#include <fpu_control.h>

_FPU_SETCW (_FPU_DEFAULT); 
```

由于 _FPU_DEFAULT 默认设置为 _FPU_MASK_ZM（ZM 代表零除法掩码）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-22T12:39:57.053

```
void handler(int trapId)
{
   // Whatever
}

signal(SIGFPE, handler); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-07T08:30:02.813

你能通过一个不那么做作的表达式让程序退出吗？例如：

```
#include <signal.h>

#ifdef DEBUG
#define DIE_HERE raise(SIGFPE)
#else
#define DIE_HERE
#endif 
```

我会犹豫是否要覆盖默认行为，以免程序的其他部分无意中除以零。或者，如果您强制它以这种方式退出以获取核心转储，您可能需要考虑在调试器中使用断点。或者，如果您使用的是带有 gdb 调试器的系统，那么 gcore 实用程序可能会很有用。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-07T09:55:14.577

如果您可以控制崩溃的代码，那么我还建议您将代码更改为以其他方式死亡。如果你不这样做，你可以尝试安装一个空的信号处理程序（即使用`signal(SIGFPE, &EmptyFunction`）），但你仍然依赖于未定义的行为，所以不能保证它仍然可以在其他系统或其他内核或 C 库上工作版本。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-02-16T09:54:19.963

lnmiit l over the crashing code，那么我还建议更改代码以其他方式死掉。如果你不这样做，你可以尝试安装一个

# profiling - 您最喜欢的适用于 Windows 的免费 Netstat GUI / Connection Monitor 应用程序是什么？

> ID：419534
> 
> 赞同：3
> 
> 时间：2009-01-07T08:09:51.027
> 
> 标签：profiling, tcp, sysadmin

我需要比 Sysinternals TCPView（我经常使用）功能更丰富的东西……但它也必须是免费软件。:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-03-27T10:19:33.880

好吧，这个问题有点老了，我意识到您可能已经找到了您正在寻找的软件......以防万一，一个有趣的连接监控实用程序是Nir ​​Sofer 的[CurrPorts](http://www.nirsoft.net/utils/cports.html)。

自由改编自程序主页：

*   显示本地计算机上所有当前打开的 TCP/IP 和 UDP 端口的列表；
*   对于列表中的每个端口，还会显示打开该端口的进程的信息，包括进程名称、进程的完整路径、进程的版本信息（产品名称、文件描述等）、打开端口的时间。进程已创建，以及创建它的用户；
*   允许您关闭不需要的 TCP 连接，并终止打开端口的进程；
*   允许自定义过滤器以包含/排除连接。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-16T22:59:02.810

[也许像Wireshark](http://www.wireshark.org)这样成熟的流量嗅探器可以补充您的工具集？

Wireshark 的特性包括：

*   数据包分析
*   流量统计
*   捕获
*   染色
*   数据导出

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-08T13:52:36.653

我推荐[Windows v2.53 的 TCPView](http://technet.microsoft.com/en-us/sysinternals/bb897437.aspx)。

[图片 http://i.technet.microsoft.com/bb897437.TcpView(en-us,MSDN.10).gif](http://i.technet.microsoft.com/bb897437.TcpView(en-us,MSDN.10).gif)

TCPView 是一个 Windows 程序，它将向您显示系统上所有 TCP 和 UDP 端点的详细列表，包括本地和远程地址以及 TCP 连接的状态。在 Windows Server 2008、Vista、NT、2000 和 XP TCPView 上，还报告拥有端点的进程的名称。TCPView 提供了 Windows 附带的 Netstat 程序的更多信息和方便呈现的子集。TCPView 下载包括 Tcpvcon，一个具有相同功能的命令行版本。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-07T12:34:28.187

有[MS 网络监视器](http://www.microsoft.com/en-us/download/details.aspx?id=4865)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-08-03T21:35:44.877

不确定您正在寻找什么功能，所以这是我的建议。

没有使用它，我已经看到过[几次 TCPStat](http://www.mfcsnet.com/mfcstcpstat.htm)广告。看起来这是一个在 2003 年左右停止的项目，而且它是一种可怕的蓝色。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-04-08T00:15:35.233

Process Hacker 还显示发送/接收字节、速度、国家标志等。

# text - 将 RTF 流转换为纯文本流

> ID：419544
> 
> 赞同：1
> 
> 时间：2009-01-07T08:13:35.683
> 
> 标签：text, crystal-reports, stream, rtf

我有水晶报告，我需要将其转换为文本文件。目前我只能将其转换为 RTF Stream。现在我需要将 RTF 流转换为文本流。我正在使用 C#。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-07T09:50:00.483

如果我错了，请纠正我，但您正在使用带有[ExportFormatType.RichText的](http://msdn.microsoft.com/en-us/library/ms226443.aspx)[ExportToStream](http://msdn.microsoft.com/en-us/library/ms225995.aspx)方法：

```
Stream stream = report.ExportToStream(ExportFormatType.RichText); 
```

这会将报告导出到 RTF 流中。现在您希望将此流转换为纯文本（从 RTF 中提取文本）。如果这是真的，那么[这个线程](https://stackoverflow.com/questions/22346/how-do-i-extract-insert-text-into-rtf-string-in-c)可能会为您提供答案。

# c# - .Net WSDL 命令行实用程序错误

> ID：419547
> 
> 赞同：0
> 
> 时间：2009-01-07T08:17:29.437
> 
> 标签：c#, .net, visual-studio-2005, soap, wsdl.exe

我将 Visual Studio 2005 附带的 .Net 命令行 WSDL 实用程序指向用 Java 实现的 Web 服务（我无法控制），它会吐出以下错误：

```
WSDL : error WSDL1: Unable to cast object of type 'System.Xml.XmlElement' 
to type 'System.Web.Services.Description.ServiceDescriptionFormatExtension'. 
```

然而，如果我通过“添加 Web 引用”对话框将 Visual Studio 2005 本身指向该服务，它会为我生成一个代理类就好了。

我正在使用 WSDL 实用程序来生成我所有的其他服务代理（尽管旧的确实会发出一堆警告）。

目前，我将 WSDL 实用程序指向已部署 Web 服务的 URL。所有这些都是用Java开发的。

我想在构建过程中使用 WSDL 命令行实用程序来确保每次编译时我都拥有最新的代理代码。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-30T12:05:15.657

尝试指定选项**协议[SOAP12](http://msdn.microsoft.com/en-us/library/microsoft.web.services3.soap12_properties.aspx)**

/protocol:protocol（[如 MSDN 上所示](http://msdn.microsoft.com/en-us/library/7h3ystb6.aspx)）

指定要实现的协议。您可以指定 SOAP（默认）、HttpGet、HttpPost 或配置文件中指定的自定义协议。使用 /parameters 选项时，此值是元素并包含字符串。

如果这没有帮助，那么......

Visual Studio 的“添加 Web 引用”在添加 Web 引用时调用 WSDL.exe。基本上[没有区别](http://bytes.com/groups/net-web-services/427848-wsdl-exe-vs-add-web-reference)，除了从命令行运行[WSDL.exe命令时保留的控制。](http://msdn.microsoft.com/en-us/library/7h3ystb6.aspx)我怀疑您的其中一个论点与 Visual Studio 设置的论点不正确或不同。

要对此进行测试，您需要比较生成的 2 个不同 XSD 文件的输出，这将为您提供更多关于错误的线索（正如 Klathzazt 所建议的那样）。

祝你好运

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-27T17:05:55.527

这是一个 XSD 文件吗？文件有依赖关系。下载依赖文件并将它们与您下载的 XSD 并排/并排放置。我会假设 Visual Studio 可能会获取依赖项。

如果这不能解决问题，请提供更多详细信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-06-01T19:40:54.107

我能够通过使用 ServiceBehavior 装饰（具体）服务并给它一个命名空间来摆脱这个错误。

```
using System.ServiceModel;

[ServiceBehavior(Name = "MyConcreteServiceName", Namespace = "http://www.mycompany.com/services/")]
public class MyConcreteService: IMyService
{
} 
```

注意：通过***服务类***（而不是合同（接口））上的 ServiceBehavior 属性设置

而不是这个：

```
<wsdl:definitions name="MyConcreteServiceName" targetNamespace="http://tempuri.org/"> 
```

我懂了：

```
<wsdl:definitions name="MyConcreteServiceName" targetNamespace="http://www.mycompany.com/services/"> 
```

# sql - 如何在VB代码中编写特殊字符

> ID：419554
> 
> 赞同：2
> 
> 时间：2009-01-07T08:19:27.390
> 
> 标签：sql, vb.net

我有一个使用特殊字符（例如：（'）、（/）、（&））的 Sql 语句，但我不知道如何在我的 VB.NET 代码中编写它们。请帮我。谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-07T08:31:35.103

找出字符的 Unicode 代码点（来自[http://www.unicode.org](http://www.unicode.org)），然后使用 ChrW 将代码点转换为字符。（要将其放在另一个字符串中，请使用连接。我有点惊讶 VB 没有转义序列，但我们开始了。）

例如，对于欧元符号 (U+20AC)，您可以这样写：

```
Dim euro as Char = ChrW(&H20AC) 
```

与将字符直接放入源代码相比，这样做的优点是您的源代码保持“纯 ASCII” - 这意味着您不会遇到任何其他程序尝试读取它、区分它等的任何奇怪问题。缺点当然，在代码中更难看到符号。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-07T08:28:07.543

最常见的方法似乎是附加 Chr(34)... 形式的字符。 34 表示双引号字符。字符代码可以从windows程序“charmap”中找到......只需windows/Run......然后输入charmap

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-07T13:34:33.650

如果您传递要作为 SQL 语句处理的字符串，请尝试将字符加倍。

```
"SELECT * FROM MyRecords WHERE MyRecords.MyKeyField = ""With a "" Quote"" " 
```

'' 双精度也适用于其他特殊字符。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-07T10:49:54.573

' 字符可以加倍以允许它变成一个字符串，例如

```
lSQLSTatement = "Select * from temp where name = 'fred''s'" 
```

将搜索 name = fred's 的所有记录

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-07T13:49:29.470

Chr() 可能是最受欢迎的。如果要生成 unicode 字符，可以使用 ChrW() ControlChars 类包含一些特殊和“不可见”字符，以及引号 - 例如，ControlChars.Quote

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-07T08:21:03.203

三点：

1）您给出的示例字符不是特殊字符。它们直接在您的键盘上可用。只需按相应的键。

2) 要键入键盘上没有相应键的字符，请使用以下命令：

**Alt** + **（特殊字符的 ASCII 码号）**

例如，要键入 ¿，请按**Alt**并键入**168**，这是该特殊字符的 ASCII 代码。

您可以使用此方法在几乎*任何*程序中键入特殊字符，而不仅仅是 VB.Net 文本编辑器。

3）您可能正在寻找的是字符串中所谓的“转义”字符。在您的 SQL 查询字符串中，只需在每个字符之前放置一个**\ 。**应该这样做。

# c++ - 这可能在宏中使用省略号吗？可以转成模板吗？

> ID：419559
> 
> 赞同：4
> 
> 时间：2009-01-07T08:23:32.827
> 
> 标签：c++, visual-c++, logging, c-preprocessor

在实现了 CLogClass 以进行体面的日志记录之后，我还定义了宏，但它只适用于一个参数......

```
class CLogClass
{ 
public:
       static void DoLog(LPCTSTR sMessage, ...);
};
#define DebugLog(sMessage, x) ClogClass::DoLog(__FILE__, __LINE__, sMessage, x) 
```

好吧，当使用超过 2 个参数调用时它会失败 :( ... 是否有可能避免它？可以以某种方式将其转换为模板吗？

编辑：可变参数宏是在 VS 2005 中引入的（但我目前在 VS 2003 中......）。有什么建议吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-07T10:05:19.843

您可以让 MYLOG 宏返回一个自定义函子对象，该对象接受可变数量的参数。

```
#include <string>
#include <cstdarg>

struct CLogObject {

  void operator()( const char* pFormat, ... ) const {
    printf( "[%s:%d] ", filename.c_str(), linenumber );
    va_list args;
    va_start( args, pFormat );
    vfprintf( stderr, pFormat, args );
    va_end( args );
  }

  CLogObject( std::string filename, const int linenumber )
    : filename( filename ), linenumber( linenumber )
  {}
  std::string filename;
  int linenumber;
};

#define MYLOG CLogObject( __FILE__, __LINE__ )

int _tmain(int argc, _TCHAR* argv[])
{

  MYLOG( "%s, %d", "string", 5 );
  return 0;
} 
```

[请注意，跨步到此答案](https://stackoverflow.com/questions/419559/is-this-possible-use-ellipsis-in-macro-can-it-be-converted-to-template#419828)涉及的类型安全变体并不难：由于`operator<<`.

```
struct CTSLogObject {

  template< typename T >
  std::ostream& operator<<( const T& t ) const {
    return std::cout << "[" << filename << ":" << linenumber << "] ";
  }

  CTSLogObject( std::string filename, const int linenumber )
    : filename( filename ), linenumber( linenumber )
  {}
  std::string filename;
  int linenumber;
};
#define typesafelog CTSLogObject( __FILE__, __LINE__ )

int _tmain(int argc, _TCHAR* argv[])
{
  typesafelog << "typesafe" << ", " << 5 << std::endl;
  return 0;
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-07T08:54:16.897

您的问题实际上吸引了两个答案。您想要执行通用日志记录功能，该功能类似于 printf 但可以完全自定义。所以你需要：

*   采用可变数量参数的宏
*   接受可变数量参数的函数

这是您的代码示例：

```
#include <stdio.h>
#include <stdarg.h>

class CLogClass
{
public:
    static void DoLogWithFileLineInfo( const char * fmt, ... )
    {
        va_list ap;
        va_start( ap, fmt );
        vfprintf( stderr, fmt, ap );
        va_end( ap );
    }

};

#define MYLOG(format, ...) CLogClass::DoLogWithFileLineInfo("%s:%d " format , __FILE__, __LINE__, __VA_ARGS__)

int main()
{
    MYLOG("Hello world!\n", 3); // you need at least format + one argument to your macro
    MYLOG("%s\n", "Hello world!");
    MYLOG("%s %d\n", "Hello world!", 3);
} 
```

C99 中引入了可变参数宏，因此它适用于支持 C99 或 C++0x 的编译器。我使用 gcc 3.4.2 和 Visual Studio 2005 成功测试了它。

函数的可变参数一直存在，所以这里不用担心兼容性。

使用一些模板元编程可能可以做到这一点，但鉴于上面代码的简单性，我看不出它的兴趣。

最后一点，为什么在空类中使用静态方法而不是函数？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-07T10:13:25.053

```
class Log {
    stringstream buffer;
    public:
        class Proxy {
            public:
                Proxy(Log& p) : parent(p) {}
                template<class T>
                Proxy& operator,(T const& t) {
                    parent.buffer << t;
                    return *this;
                }
                ~Proxy() {
                    parent.buffer << endl;
                    cout << parent.buffer.str();
                    parent.buffer.str("");
                }
            private:
                CLog& parent;
        };

        template<class T>
        Proxy operator<<(T const& t) {
            buffer << t;
            return Proxy(*this);
        }
}; 
```

可以简单地扩展为写入时间戳、检查日志级别、写入文件等。

或者，更简单但不太灵活：

```
class Log {
    public:
        class Proxy {
            public:
                template<class T>
                Proxy& operator,(T const& t) {
                    cout << t;
                    return *this;
                }
                ~Proxy() {
                    cout << endl;
                }
        };

        template<class T>
        Proxy operator<<(T const& t) {
            cout << t;
            return Proxy();
        }
}; 
```

用法：

```
Log log;
void f() {
     log << "hey, my age is ", age;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-07T08:41:39.670

在这种情况下，我倾向于使用全局可见的外部函数而不是宏，并使用 va_list 解决此函数中的省略号。[有关如何实现此目的的示例，](https://stackoverflow.com/questions/205529/c-c-passing-variable-number-of-arguments-around#205584)请参见我以前的帖子。

# web-services - “wsse:InvalidSecurity”是什么意思？

> ID：419563
> 
> 赞同：1
> 
> 时间：2009-01-07T08:25:37.190
> 
> 标签：web-services, security, wss, pki

```
An error was discovered processing the <wsse:Security> header 
```

顺便说一句，这是一个 WS-Security 问题...

我看不出我的 WS 端点有什么问题（除了它在 TIBCO BW 引擎中运行的事实！）。有人对这种错误有任何“先验”吗？我意识到 WS-Security 标头可能会在任何地方被破坏以获取此错误，但是对于某种常见错误，必须有 90% 的百分比。

这是受保护的 SOAP - 客户端是独立的 java (WSS4J 1.5.0)，仅在此阶段执行签名。

```
<soapenv:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/">
    <soapenv:Header>
        <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" soapenv:mustUnderstand="1">
            <ds:Signature xmlns:ds="http://www.w3.org/2000/09/xmldsig#" Id="Signature-20237898">
                <ds:SignedInfo>
                    <ds:CanonicalizationMethod Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>
                    <ds:SignatureMethod Algorithm="http://www.w3.org/2000/09/xmldsig#rsa-sha1"/>
                    <ds:Reference URI="#id-18414151">
                        <ds:Transforms>
                            <ds:Transform Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>
                        </ds:Transforms>
                        <ds:DigestMethod Algorithm="http://www.w3.org/2000/09/xmldsig#sha1"/>
                        <ds:DigestValue>DvjhvAtEVxwntL/RjMCNhId57cg=</ds:DigestValue>
                    </ds:Reference>
                </ds:SignedInfo>
                <ds:SignatureValue>
YbOB3FRduCr5rutpIvch9sDZfZToy3pjm+Kyl/Oqz6cAPqMVKqvKBb4P7ebnzP/3SVjm+PfLqlE5
BGgcT3Vz93apyg+eY1rAIYUs7K1Zt9F5ejMmij6HQpQTGpyM9BUXJi1x5bt9GuMtD0SK939bIIE2
ZUyZ0jPJp/wUhMonskw=
</ds:SignatureValue>
                <ds:KeyInfo Id="KeyId-15734641">
                    <wsse:SecurityTokenReference xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd" wsu:Id="STRId-3852606">
                        <ds:X509Data>
                            <ds:X509IssuerSerial>
                                <ds:X509IssuerName>CN=Mark Hesketh,OU=asdf,O=DVA,L=Canberra,ST=ACT,C=AU</ds:X509IssuerName>
                                <ds:X509SerialNumber>1231310305</ds:X509SerialNumber>
                            </ds:X509IssuerSerial>
                        </ds:X509Data>
                    </wsse:SecurityTokenReference>
                </ds:KeyInfo>
            </ds:Signature>
        </wsse:Security>
    </soapenv:Header>
    <soapenv:Body xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd" wsu:Id="id-18414151">
        <message xmlns="http://www.tibco.com/schemas/CertificateWork/Resources/Schema.xsd" text="Sample msg with SHA1 signature"/>
    </soapenv:Body>
</soapenv:Envelope> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-10-12T14:05:25.280

哇......如果你仍然有这个问题，你比我更有耐心......但以防万一，这是我的想法：

*   [http://schemas.xmlsoap.org/specs/ws-security/ws-security.htm#ws-security__toc6201567](http://schemas.xmlsoap.org/specs/ws-security/ws-security.htm#ws-security__toc6201567) - 表明这是读取标签的问题。
*   让我印象深刻的一件事是，我没有看到将签名与密钥信息联系起来的参考。当然，我会假设 KeyInfo 元素正在描述使用私钥生成 SignatureValue 的证书，但我没有看到告诉软件的 XML 片段。我认为包括 KeyInfo 是不够的，可能必须有一个链接。
*   如果不是这样，我会仔细检查这个模式，也许是一个独立的模式验证源。标题级别的错误让我想到的是格式而不是内容。

这是我对这个的第一次猜测，这只是一个猜测，没有亲身体验你的系统并尝试了一堆不同的东西。如果这不起作用，这是我针对此类错误的一般逻辑链：

1.  **格式**- 根据架构，XML 是否正确？
2.  **签名**——签名需要三样东西：数据、密钥、一组生成它的算法。检查所有三个 - 数据是否正确，密钥是否正确，算法是否适合密钥以及如何处理消息？此外，您的图书馆是否正确引用并找到了关键和数据项？
3.  **信息的外部来源**- 在这种情况下，您的密钥信息引用可能是从其他地方提取的证书 - 例如 LDAP 证书存储。那么..您的代码可以访问该外部源吗，是否可以从您运行代码的位置访问正在运行的数据源和网络？等等
4.  **如果 PKI——证书验证/信任**——系统必须在幕后做什么才能信任签名者？OCSP 检查？在 LDAP 中查找？链接到受信任的根？等等。信任算法是否正常工作，是否具备所需的一切 - 即访问 OCSP 响应程序、正确配置的证书存储等。

我根据我对错误含义的猜测重新排列了这些步骤。这些错误不是那么直观——所以我经常经历所有这些步骤，以防我对错误的解释是错误的。此外，我可能会在以后防止出现问题......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-10-22T13:37:15.360

检查标题中的*SOAPAction*。WSDL 中的值必须与调用中的值相同。错误的值可能会导致*InvalidSecurity*错误。

在Java中，您可以将消息作为文本获取

```
soapMessage.getSOAPPart().getEnvelope(); 
```

您可以在此处检查值和设置。

# c# - C# Sockets：如何在 C#.NET 中处理套接字，就像在 VB6 或 Delphi（事件驱动）中处理它们一样？

> ID：419575
> 
> 赞同：2
> 
> 时间：2009-01-07T08:31:53.887
> 
> 标签：c#, sockets

C# Sockets：如何在 C#.NET 中处理套接字，就像在 VB6 或 Delphi（事件驱动）中处理它们一样？

在 VB6 或 Delphi 上，在创建套接字时，您将 onconnect、onreceive 和 onerror 事件放置在主代码文件中，我将如何复制它们？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-07T09:01:27.880

您没有像 VB6/Delphi 中那样的行为，并且您有 Async 方法和事件来做类似的事情，例如：[AsyncTCP Client](http://www.java2s.com/Code/CSharp/Network/AsyncTcpClient.htm)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-07T08:58:41.553

您应该阅读 TcpClient 类，网络编码不像在 vb6 中那样拖放，但您确实对协议有更多的控制权。

此外，还有相当多的 WinSock 克隆库，其行为和接口与 vb6 等效项大致相同。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-08T04:51:52.860

简短的回答是：通过使用多线程技术。

长的答案是事件实际上只是由其他代码引发的信号，这些代码不断检查特定的一组环境。例如，负责引发 DataAvailable 事件的一段非常简单的代码可能如下所示：

```
While Socket Is Connected
   If Data Is Available Raise Event DataAvailable
Loop 
```

.Net 库有一个 Socket 类，您可以用您设计的类包装它，使其行为更像 VB6 中可用的 Winsock 类。一旦您深入研究了 Socket 类的文档并了解了如何为类创建自定义事件，就不难想象如何设计这样的包装器。对于大多数来自 VB6 的开发人员（对我而言）来说，真正的障碍是您必须了解一些关于多线程应用程序的知识才能使其正常工作。

您可能可以通过一些搜索找到这样的包装器，但我强烈建议您至少尝试编写自己的包装器。随着单核机器迅速成为过去，多线程技术的经验将成为任何体面的程序员的要求。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-07T11:53:25.773

.Net 框架 afaik 中没有这样的类。

用 OnConnect、OnReceive 等封装套接字类非常容易创建一个类。如果你没有制作发送事件的类的经验，这是一个非常好的学习体验。

这是我从 VB6 转到 .Net 并需要“winsock”时做的第一件事。

# performance - 我怎样才能使这个 Processing.org 草图更有效？

> ID：419577
> 
> 赞同：1
> 
> 时间：2009-01-07T08:32:03.807
> 
> 标签：performance, processing

我有一个简单的草图（在[Processing](http://processing.org/)中），基本上是一堆点四处游荡，如果它们相互接触，它们就会战斗（每个都有一个力量值，每次获胜都会增加，如果相等，获胜者是随机选择的）

它适用于大约 5000 个 12 像素“僵尸”（有半秒的轻微减速，而僵尸最初会相互碰撞），问题是当僵尸变得更小时，它们不会相互碰撞其他一样快，而且减速可以持续更长的时间..

代码非常简单——基本上每个僵尸都是一个类，它有一个 X/Y 坐标。每一帧所有的僵尸都被轻推一个像素，随机转动`lurching`角度（或不转动）。我认为缓慢的最大原因是碰撞检测 - 每个僵尸检查每隔一个（所以僵尸 1 检查 2-5000，僵尸 2 检查 1,3-5000 等..）

我想保持一切简单和“简单处理”（不使用外部库，这可能更高效、更容易，但我觉得它对学习没有多大用处）

```
int numZombies = 5000;

Zombie[] zombies = new Zombie[numZombies];

void setup(){
  size(512, 512);
  noStroke();
  for(int i = 0; i < numZombies; i++){
    zombies[i] = new Zombie(i, random(width), random(height), random(360), zombies);
  }
}

void draw(){
  background(0);

  for(int i = 0; i < numZombies; i++){
    zombies[i].move();
    zombies[i].display();
  }
}

class Zombie{
  int id; // the index of this zombie

  float x, y; // current location
  float angle; // angle of zombies movement
  float lurching = 10; // Amount angle can change
  float strength = 2;

  boolean dead = false; // true means zombie is dead

  float diameter = 12; // How big the zombie is
  float velocity = 1.0; // How fast zombie moves

  Zombie[] others; // Stores the other zombies

  Zombie(int inid, float xin, float yin, float inangle, Zombie[] oin){
    id = inid;
    x = xin;
    y = yin;
    angle = inangle;
    others = oin;
  }

  void move(){
    if(dead) return;

    float vx = velocity * sin(radians(180-angle));
    float vy = velocity * cos(radians(180-angle));

    x = x + vx;
    y = y + vy;

    if(x + vx < 0 || x + vx > width || y + vy < 0 || y + vy > height){
      // Collided with wall
      angle = angle + 180;
    }

    float adecide = random(3);

    if(adecide < 1){
      // Move left
      angle=angle - lurching;
    }
    else if(adecide > 1 && adecide < 2){
      // Don't move x
    }
    else if(adecide > 2){
      // Move right
      angle = angle + lurching;
    }

    checkFights();
  }

  void checkFights(){
    for (int i=0; i < numZombies; i++) {
      if (i == id || dead || others[i].dead){
        continue;
      }

      float dx = others[i].x - x;
      float dy = others[i].y - y;
      float distance = sqrt(dx*dx + dy*dy);

      if (distance < diameter){
        fight(i);
      }
    }
  }

  void fight(int oid){
    Zombie o = others[oid];

    //println("Zombie " + id + "(s: "+ strength +") fighting " + oid + "(s: "+ o.strength +")");

    if(strength < o.strength){
      kill();
      o.strength++;
    } 
    else if (strength == o.strength){
      if(random(1) > 0.5){
        kill();
        o.strength++;
      }
      else{
        o.kill();
        strength++;
      }
    }
  }

  void kill(){
    dead = true;
  }

  void display(){
    if(dead) return;
    ellipse(x, y, diameter, diameter);
  }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-07T08:44:48.850

你得到了自己`O(n^2)`的复杂性，这正在扼杀你的算法。正确的是，每个移动的僵尸都必须与所有其他僵尸检查是否发生碰撞，这会将您带到二次复杂度。

一个方向可能是创建一个代表您的屏幕的矩阵，而不是遍历所有其他僵尸，只需更新当前僵尸在矩阵上的位置，并检查是否有另一个僵尸已经占据了同一个单元格。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-07T09:08:31.923

就像 1800 INFORMATION 说的那样，您需要以某种方式减少比较次数。

将比赛区域分成多个区域是个好主意。我想将当前位置与区域边界进行比较并从适当的集合中添加/删除僵尸所花费的时间是值得的。假设他们通常会直线前进，他们不应该过于频繁地改变区域。

尽管区域之间可能发生冲突，但我们遇到了问题。为了支持这个想法，您可以将屏幕分成 4 个区域，然后再分成 9 个区域。想想一个覆盖在十字架上的井字游戏。这是一幅糟糕的图画，但是：

```
 |  ! |
    |  ! |
----+--!-+----
    |  ! |
====|==x=|====
----+--!-+----
    |  ! |
    |  ! | 
```

这样，每个僵尸同时位于两个区域中，并且一个方案中的每个边界都被另一个区域覆盖。你甚至不必再次检查所有相同的僵尸，因为要么我们死了，要么他们死了。所以唯一的双重处理是单次`others[i].dead`检查。

* * *

我可以很快看到的另一件事是，即使您已经死了，您仍然会遍历其余元素：

```
 if (i == id || dead || others[i].dead){
    continue;
  } 
```

它可能不会节省很多处理时间，但如果您：

```
 if (dead) return; 
```

反而。

* * *

另外作为旁注，您是否要根据距离检查直径或半径？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-15T22:59:54.743

您的基本碰撞检测算法具有**O(n^2)**复杂度。

您需要一些可以减少比较次数的方法。

已经提到的一种方法是将比赛场地划分为区域/区域，并且仅当僵尸在同一区域/区域中时才检查碰撞。这是对实体进行拓扑排序（按距离）的尝试。你想要的不是简单地通过地理来区分这些僵尸，而是对它们进行排序，以便它们仅在它们“接近”彼此时进行比较。你想忽略空白区域。

考虑您的区域的树结构。当一个区域的僵尸数量超过一定数量**N**时，您可以将区域拆分得更小，直到区域半径接近您的碰撞距离。使用地图查找区域，并检查给定区域（以及任何“足够近”的区域）中的所有僵尸。

您可能希望**N** <= log(n) ...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-07T08:38:18.007

也许您应该将比赛场地划分为多个区域，并且只检查同一区域内的僵尸之间的碰撞。您需要减少比较次数。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-07T17:10:35.493

它让我想起了这个线程：[不知道可能是什么问题！](http://processing.org/discourse/yabb_beta/YaBB.cgi?board=Syntax;action=display;num=1221446441 "处理 1.0 - 不知道可能是什么问题！"). [碰撞检测帮助](http://processing.org/discourse/yabb_beta/YaBB.cgi?board=Programs;action=display;num=1230698202 "处理 1.0 - 碰撞检测帮助")我指向维基百科的碰撞检测文章。
[四叉树](http://en.wikipedia.org/wiki/Quadtree "Quadtree - 维基百科，免费的百科全书")似乎经常用于 2D 分区。

# .net - 没有数据库的 WPF 的最佳报告引擎？

> ID：419579
> 
> 赞同：8
> 
> 时间：2009-01-07T08:32:55.647
> 
> 标签：.net, wpf, xml, reporting

有人知道 WPF 的报告引擎吗？我能找到的大多数仍然适用于 WinForms。

我很高兴在 WPF 中使用带有 WinForms 主机的 WinForms，只要该工具具有可以嵌入到窗口中的 UserControl。

另外，我没有使用数据库，我的所有数据都是 XML 格式，因此报告引擎需要能够处理它。

有什么建议么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-20T08:57:35.757

也许您可以在 FlowDocument 的 FixedDocument 中进行报告？我有同样的问题，在我的情况下（打印单页发票），使用 FixedDocument 是一个优雅而简单的解决方案......（而且价格便宜，因为我不需要购买第 3 方报告套件...... )

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-15T23:01:55.257

我们最终选择了[Telerik](http://www.telerik.com/products/reporting.aspx)，但作为 WPF 中嵌入的 WinForms 解决方案。截至 2009 年 1 月，没有可以处理非数据库报表源的 WPF 报表查看器。

市场上似乎有一个洞。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-07T23:51:35.620

在我工作的地方，我们使用[Stimulsoft Reports.Net](http://www.stimulsoft.com/)。它可以绑定到很多东西（包括 XML），并且可以导出到 XPS，然后您可以使用[DocumentViewer](http://msdn.microsoft.com/en-us/library/system.windows.controls.documentviewer.aspx)在 WPF 中显示，或者，如果您有野心，您可以使用 XPS API 打开 XPS 文档，从每个 FixedPage 中取出 Glyphs 和 Paths，将它们放在 Canvas 上，然后将其显示在您的应用程序中。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-04-09T10:21:16.200

[有一个用于 WPF](http://wpfreports.codeplex.com/)的开源.NET 报告引擎。它支持页眉和页脚、DataTable 绑定、条形码生成和 XPS 创建。虽然不确定 XML 绑定。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-10T01:00:55.863

ComponentOne Reports 可以处理非数据库报表源，它是基于 WPF 的。我试过了，感觉还不错

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-04-17T15:02:54.117

以下报告引擎也可能很有用。 [http://www.eggheadcafe.com/tutorials/aspnet/22ac97f3-4a3d-4fee-a411-e456f77f6a90/wpf-report-engine-part-3.aspx](http://www.eggheadcafe.com/tutorials/aspnet/22ac97f3-4a3d-4fee-a411-e456f77f6a90/wpf-report-engine-part-3.aspx)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-09-14T07:35:30.370

我已经发布了它，它是开源的，只需要你可以在 WPF 中创建的任何用户控件，所以它非常灵活。

[https://wpfreportingengine.codeplex.com/](https://wpfreportingengine.codeplex.com/)

# image - “JPG”/“JPEG”/“PNG”/“BMP”/“GIF”/“TIFF”图像有什么区别？

> ID：419584
> 
> 赞同：110
> 
> 时间：2009-01-07T08:35:37.590
> 
> 标签：image, file-format

我见过许多类型的图像扩展，但从未理解它们之间的真正区别。是否有任何链接可以清楚地解释它们之间的差异？

在选择要在应用程序中使用的特定类型的图像时，是否有需要考虑的标准？我们在 Web 应用程序中使用什么？

* * *

## 回答 #1

> 赞同：96
> 
> 时间：2009-01-07T08:42:25.313

是的。它们是不同的文件格式（及其文件扩展名）。

每种格式的维基百科条目将为您提供大量信息：

*   [JPEG](http://en.wikipedia.org/wiki/JPEG)（或 JPG，用于文件扩展名；联合图像专家组）
*   [PNG](http://en.wikipedia.org/wiki/Portable_Network_Graphics)（便携式网络图形）
*   [BMP](http://en.wikipedia.org/wiki/BMP_file_format)（位图）
*   [GIF](http://en.wikipedia.org/wiki/Graphics_Interchange_Format)（图形交换格式）
*   [TIFF](http://en.wikipedia.org/wiki/Tagged_Image_File_Format)（或 TIF，用于文件扩展名；标记图像文件格式）

图像格式可以分为三大类：

*   有损压缩，
*   无损压缩，
*   未压缩，

未压缩格式占用的数据量最多，但它们是图像的精确表示。BMP 等位图格式通常是未压缩的，但也有压缩的 BMP 文件。

[有损压缩](http://en.wikipedia.org/wiki/Lossy_compression)格式通常适用于照片。它不适合插图、绘图和文本，因为[压缩图像的压缩伪影](http://en.wikipedia.org/wiki/Compression_artifact)会很突出。有损压缩，顾名思义，不会对文件的所有信息进行编码，所以当恢复成图像时，它不会是原始图像的精确表示。但是，与无损格式相比，它能够非常有效地压缩图像，因为它会丢弃某些信息。有损压缩格式的一个主要示例是 JPEG。

[无损压缩](http://en.wikipedia.org/wiki/Lossless_data_compression)格式适用于插图、绘图、文本和其他在使用有损压缩时看起来不太好看的材料。顾名思义，无损压缩将对原始图像中的所有信息进行编码，因此当图像解压缩时，它将是原始图像的精确表示。由于无损压缩不会丢失信息，因此在大多数情况下，它无法达到有损压缩那么高的压缩率。无损图像压缩的示例是 PNG 和 GIF。（GIF 只允许 8 位图像。）

TIFF 和 BMP 都是“包装”格式，因为其中的数据可能取决于所使用的压缩技术。它可以包含压缩和未压缩的图像。

何时使用某种图像压缩格式实际上取决于压缩的内容。

相关问题：[无情地为网络压缩大图像](https://stackoverflow.com/questions/319403/ruthlessly-compressing-large-images-for-the-web)

* * *

## 回答 #2

> 赞同：81
> 
> 时间：2013-05-02T13:27:02.067

你应该知道几个关键因素...

首先，有两种类型的压缩：[无损](http://en.wikipedia.org/wiki/Lossless_data_compression)和[有损](http://en.wikipedia.org/wiki/Lossy_compression)。

**无损**意味着图像变得更小，但不损害质量。**有损**意味着图像变得（甚至）更小，但会损害质量。如果您一遍又一遍地以有损格式保存图像，图像质量会越来越差。

还有不同的颜色深度（调色板）：[索引颜色](http://en.wikipedia.org/wiki/Indexed_color)和[直接颜色](http://en.wikipedia.org/wiki/Color_depth#16-bit_direct_color)。

使用**索引**意味着图像只能存储图像作者选择的有限数量的颜色（通常为 256 种），使用**直接**意味着您可以存储作者未选择的数千种颜色。

* * *

**BMP** - 无损/索引和直接

这是一种旧格式。它是无损的（保存时不会丢失图像数据），但也几乎没有压缩，这意味着保存为 BMP 会导致文件非常大。它可以有索引和直接的调色板，但这是一个小小的安慰。文件大小太大，以至于没有人真正使用过这种格式。

适合：真的没什么。BMP 没有什么擅长的，或者没有其他格式做得更好。

![BMP 与 GIF](https://i.stack.imgur.com/J1EEX.png)

* * *

**GIF** - 无损/仅索引

GIF 使用无损压缩，这意味着您可以一遍又一遍地保存图像而不会丢失任何数据。文件大小比 BMP 小很多，因为实际使用了良好的压缩，但它只能存储索引调色板。这意味着文件中最多只能有 256 种不同的颜色。这听起来是一笔不小的数目，而且确实如此。

GIF 图像也可以是动画的并且具有透明度。

适用于：徽标、线条图和其他需要很小的简单图像。只真正用于网站。

![GIF 与 JPEG](https://i.stack.imgur.com/F7VtM.png)

* * *

**JPEG** - 有损/直接

JPEG 图像旨在通过删除人眼不会注意到的信息来使详细的照片图像尽可能小。因此，它是一种有损格式，并且一遍又一遍地保存同一个文件将导致更多数据随着时间的推移而丢失。它有数千种颜色的调色板，因此非常适合照片，但有损压缩意味着它对徽标和线条图不利：它们不仅看起来模糊，而且与 GIF 相比，此类图像的文件大小也会更大！

适合：照片。还有，渐变。

![JPEG 与 GIF](https://i.stack.imgur.com/agaQv.png)

* * *

**PNG-8** - 无损/索引

PNG 是一种较新的格式，PNG-8（PNG 的索引版本）确实是 GIF 的一个很好的替代品。然而，遗憾的是，它有一些缺点：首先它不能像 GIF 那样支持动画（它可以，但似乎只有 Firefox 支持它，不像每个浏览器都支持的 GIF 动画）。其次，它对 IE6 等较旧的浏览器存在一些支持问题。第三，像Photoshop这样的重要软件对格式的实现很差。（该死的，Adobe！）PNG-8 只能存储 256 种颜色，比如 GIF。

优点：PNG-8 比 GIF 做得更好的主要方面是支持 Alpha Transparency。

![PNG-8 与 GIF](https://i.stack.imgur.com/B09oZ.png)

**重要说明：** Photoshop 不支持 PNG-8 文件的 Alpha 透明度。（该死的，Photoshop！）有一些方法可以将 Photoshop PNG-24 转换为 PNG-8 文件，同时保持其透明度。一种方法是[PNGQuant](http://pngquant.org)，另一种方法是使用[Fireworks](http://www.adobe.com/uk/products/fireworks.html)保存文件。

* * *

**PNG-24** - 无损/直接

PNG-24 是一种很好的格式，它结合了无损编码和直接颜色（数千种颜色，就像 JPEG）。在这方面它非常像 BMP，除了 PNG 实际上压缩图像，因此它产生的文件要小得多。不幸的是，PNG-24 文件仍将比 JPEG、GIF 和 PNG-8 大得多，因此您仍然需要考虑是否真的要使用其中一个。

尽管 PNG-24 在进行压缩时允许使用数千种颜色，但它们并非旨在取代 JPEG 图像。保存为 PNG-24 格式的照片可能至少比等效的 JPEG 图像大 5 倍，这在可见质量方面几乎没有改善。（当然，如果您不关心文件大小并希望获得最佳质量的图像，这可能是一个理想的结果。）

就像 PNG-8 一样，PNG-24 也支持 alpha 透明度。

我希望这会有所帮助！

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2009-01-07T08:42:08.497

通常这些是：

**无损压缩** 无损压缩算法在不损失图像质量的情况下减小文件大小，尽管它们不会像有损压缩文件那样压缩成小文件。当图像质量高于文件大小时，通常会选择无损算法。

**有损压缩** 有损压缩算法利用人眼的固有局限性，丢弃不可见的信息。大多数有损压缩算法允许可变质量级别（压缩），并且随着这些级别的增加，文件大小会减小。在最高压缩级别下，图像劣化作为“压缩伪影”变得明显。下图展示了有损压缩算法的明显伪影；选择缩略图以查看完整大小的版本。

每种格式都不同，如下所述：

**JPEG** JPEG（联合图像专家组）文件（在大多数情况下）是有损格式；DOS 文件扩展名是 JPG（其他操作系统可能使用 JPEG）。几乎每台数码相机都可以以 JPEG 格式保存图像，该格式支持每种颜色 8 位（红色、绿色、蓝色），总共 24 位，生成相对较小的文件。如果不是太大，压缩不会显着降低图像质量，但 JPEG 文件在反复编辑和保存时会出现代际退化。如果要重新编辑照片图像，或者如果不能接受小的“伪像”（由 JPEG 的压缩算法引起的瑕疵），则以无损的非 JPEG 格式存储可能会更好。JPEG 格式也被用作许多 Adob​​e PDF 文件中的图像压缩算法。

**TIFF** TIFF（标记图像文件格式）是一种灵活的格式，通常使用 TIFF 或 TIF 文件名分别为 24 位和 48 位总计分别保存每种颜色（红色、绿色、蓝色）8 位或 16 位. TIFF 的灵活性既是福也是祸，因为没有一个阅读器可以读取每种类型的 TIFF 文件。TIFF 是有损和无损的；有些为双层（黑白）图像提供了相对较好的无损压缩。一些数码相机可以保存为 TIFF 格式，使用 LZW 压缩算法进行无损存储。Web 浏览器不广泛支持 TIFF 图像格式。TIFF 仍然被广泛接受为印刷行业的照片文件标准。TIFF 可以处理特定于设备的颜色空间，例如由一组特定印刷机油墨定义的 CMYK。

**PNG** PNG（便携式网络图形）文件格式是作为 GIF 的免费、开源继承者而创建的。PNG 文件格式支持真彩色（1600 万色），而 GIF 仅支持 256 色。当图像具有大而均匀的颜色区域时，PNG 文件表现出色。无损PNG格式最适合编辑图片，而像JPG这样的有损格式最适合最终分发照片图像，因为JPG文件比PNG文件小。许多较旧的浏览器目前不支持 PNG 文件格式，但是，在 Internet Explorer 7 中，所有现代 Web 浏览器都完全支持 PNG 格式。即使只传输了一小部分图像数据，Adam7 隔行扫描也可以进行早期预览。

**GIF** GIF（图形交换格式）仅限于 8 位调色板或 256 种颜色。这使得 GIF 格式适合存储颜色相对较少的图形，例如简单的图表、形状、徽标和卡通风格的图像。GIF 格式支持动画，至今仍被广泛用于提供图像动画效果。它还使用无损压缩，当大面积区域只有单一颜色时更有效，而对于细节图像或抖动图像则无效。

**BMP** BMP 文件格式（Windows 位图）处理 Microsoft Windows 操作系统中的图形文件。通常，BMP 文件是未压缩的，因此它们很大；优点是它们的简单性、广泛接受性和在 Windows 程序中的使用。

**用于网页/Web 应用程序**

以下是在将它们与网页/应用程序一起使用时对这些图像格式的简要总结。

*   PNG 非常适合 IE6 及更高版本（需要一个小的 CSS 补丁才能使透明度正常工作）。非常适合插图和照片。*   JPG 非常适合在线照片*   当您不想迁移到 PNG 时，GIF 非常适合插图*   BMP 不应该在网页中在线使用 - 浪费带宽

来源：[图像文件格式](http://en.wikipedia.org/wiki/Image_file_formats)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-01-07T08:48:38.610

由于其他人已经涵盖了差异，因此我将使用它。

扫描仪通常使用 TIFF。它产生巨大的文件，并没有真正用于应用程序。

BMP 是未压缩的，也可以生成巨大的文件。它也没有真正用于应用程序。

GIF 曾经遍布网络，但由于它只支持有限数量的颜色并且已获得专利，因此已经失宠。

JPG/JPEG 主要用于任何具有照片质量的内容，但不用于文本。使用的有损压缩往往会损坏清晰的线条。

PNG 不像 JPEG 那样小，但它是无损的，因此它适用于线条清晰的图像。现在在网络上很常用。

就个人而言，我通常会在任何可能的地方使用 PNG。这是 JPG 和 GIF 之间的一个很好的折衷。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-02-19T07:01:35.070

**JPG > 联合摄影专家组**

1 JPG 图像支持 1600 万色，最适合照片和复杂图形

2 JPG 不支持透明度。

**PNG > 便携式网络图形**

1 当 GIF 技术受版权保护且需要使用许可时，它被用作 GIF 文件格式的替代品。

2 PNG 的压缩率比 GIF 高 5% 到 25%，并且颜色范围更广。PNG 使用二维交错，这使得它们的加载速度是 GIF 图像的两倍。”</p>

3 具有多种颜色或需要高级可变透明度的图像，PNG 是首选文件类型。

**GIF > 图形交换格式**

1 将图像中的颜色数减少到 256。

2 GIF 也支持透明度。

3 GIF 具有显示一系列图像的独特能力，类似于视频，称为动画 GIF。

4 如果图像的颜色很少并且不需要任何高级的 alpha 透明效果，那么 GIF 是要走的路。

**SVG > 可缩放矢量图形**

1 SVG 是一种基于 XML 的 Web 标准，它在二维中描述静态图像和动画。

2 SVG 允许您创建质量非常高的图形和动画，它们不会随着尺寸的增加/减小而丢失细节。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-07T08:45:58.693

这些名称指的是对像素图像数据进行编码的不同方式（JPG 和 JPEG 是同一种东西，TIFF 可能只是将 jpeg 与一些额外的元数据封装在一起）。

这些图像格式可能使用不同的压缩算法、不同的颜色表示、携带图像本身以外的附加数据的不同能力等等。

对于 Web 应用程序，我会说 jpeg 或 gif 就足够了。Jpeg 因其较高的压缩比而被更频繁地使用，而 gif 通常用于轻量级动画，其中闪光灯（或类似的东西）是一种过度杀戮，或者需要透明背景的地方。PNG也可以使用，但我没有太多经验。BMP 和 TIFF 可能不适合 Web 应用程序。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-07T08:47:46.210

coobird 和 Gerald 说了什么。

此外，JPEG 是文件格式名称。JPG 是这种格式常用的缩写文件扩展名，因为您需要为早期的 Windows 系统提供 3 个字母的文件扩展名。TIFF 和 TIF 也是如此。

目前的 Web 浏览器只显示 JPEG、PNG 和 GIF 文件——所以这些是可以在网页上显示的文件。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-15T05:21:00.687

PNG 支持 alpha 通道透明度。

TIFF 可以具有扩展选项，即 [GIS](http://en.wikipedia.org/wiki/GIS)应用程序的[地理参考](http://en.wikipedia.org/wiki/GeoTIFF)。

我建议只将 JPEG 用于照片，切勿用于剪贴画、徽标、文本、图表、线条艺术等图像。

喜欢PNG。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-15T05:56:31.393

命名的都是光栅图形，但除此之外不要忘记越来越重要的矢量图形。有压缩和未压缩类型（或多或少），但它们都是无损的。最重要的是：

*   [SVG](http://en.wikipedia.org/wiki/Svg) / [SVGZ](http://en.wikipedia.org/wiki/SVGZ#Compression)
*   [每股收益](http://en.wikipedia.org/wiki/Encapsulated_PostScript)
*   电磁场/（[WMF](http://en.wikipedia.org/wiki/Windows_Metafile)）

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-07T08:39:06.490

文件扩展名告诉您如何保存图像。其中一些格式只是按原样保存位，一些以不同的方式压缩图像，包括无损和有损方法。网络可以告诉你，虽然我知道一些病人响应者会在这里概述它们。

网络主要支持 gif、jpg 和 png。JPEG 与 jpg 相同（或非常接近）。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-12-23T02:45:40.993

对于不同图像格式之间的指定差异和用法，上面已经进行了很好的讨论。

但是，我想为捕获图片和存储它们的整个过程添加一些内容。

### 捕获过程

或者你可以说构建过程（因为我们现在可以用计算机绘制或制作图片）。如果你用相机拍照，你已经在使用很多传感器（CCD 或 CMOS）和算法（拜耳模式过滤器、二次采样和量化等）。还有像`Pixel Format`和之类的东西`Color Space`。得到基本的像素信息后，肯定有办法存储它们。

### 基本图像文件结构

为了将像素信息存储到文件中，我们需要一个约定和相关算法。为了节省空间，有压缩，但基本上问题是将像素编码为字节并将字节解码为像素以进行显示。

一个典型的图像文件可能由几个部分组成，基本上是两个：`meta data or file header`和`pixel data section`. `meta data`讲述了图像本身，可能是`height`and `width`，`file format`等。而 the`pixel data section`是真实`section`的处理`real picture`.

### 存储和显示

正如我们之前所说，文件存储在硬盘中，以字节/位为单位。所以图像文件没有优先级，但实际上还有字节流。对于显示，也许我们应该了解一下监视器是如何工作的。典型的 PC 显示器使用 RGB 模型进行显示。

希望这可以帮助：-）

# asp.net - 缓存还是类变量？

> ID：419585
> 
> 赞同：0
> 
> 时间：2009-01-07T08:35:52.643
> 
> 标签：asp.net, session, caching

使用类变量或 ASP.NET 中的会话缓存是更好的做法吗？我有一个变量，我需要在页面加载时保持它。是否更好地使用：

```
public class MyClass {
  private SomeObject anObject;
  private method1() {
    anObject = new SomeObject();
  }
  private method2() {
    // do something with anObject
  }
} 
```

或者

```
public class MyClass {
  private method1() {
    Session["anObject"] = new SomeObject();
  }
  private method2() {
    SomeObject anObject = (SomeObject)Session["anObject"];
  }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-07T08:44:04.267

使用缓存。我不是在 .NET 上工作，而是在带有 servlet 的 Java 中工作。在那里我肯定会使用 HTTP 会话，因为我的应用程序可以在服务器集群中运行，并且我知道在 HTTP 会话中存储值将在此设置中起作用，而将其存储在类变量中可能会有点问题。您可以将整个类 MyClass 存储在 HTTP 会话中，然后您可以将值存储在类变量中。

基本上，您可以像查看哈希表一样查看 HTTP 会话。

# django - Django 和 Joomla 有什么区别？

> ID：419594
> 
> 赞同：12
> 
> 时间：2009-01-07T08:41:23.867
> 
> 标签：django, frameworks, content-management-system, joomla

Django 和 Joomla 有什么区别？

或者更好的是 CMS（Joomla、Drupal 等）和 Web 框架（Django、Symphony、Zend 等）之间的区别是什么？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-01-12T13:35:58.240

使用玩具积木类比-

**CMS：**可与娃娃屋套件相媲美。您可以对其进行大量自定义，但它非常适合主要构建一种玩具。

**Web 应用程序框架：**类似于乐高积木。您可以快速构建各种玩具结构，因为您不需要自己制作左砖。

**没有框架：**仅使用编程语言的标准库开发 Web 应用程序就像用普通粘土制作玩具一样。它提供了最大的自由度，但您也付出了自己制作所有作品的代价。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-01-07T08:49:41.337

Django（和 Web 框架）提供构建最常见网站所需的通用功能。此功能主要是技术性的，新手用户（阅读：非程序员）对如何使用它知之甚少。

Joomla（以及一般的 CMS）是针对非程序员（但仍然是技术用户，至少在某种程度上）使用它们部署和运行网站的软件包。

如果您安装了 Joomla，您可以将内容添加到您的网站

如果你安装了 Django，你可以开始编写一些允许你添加内容的东西

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-01-07T09:23:38.930

直接访问 Django 网站：

> **Django 是内容管理系统（CMS）吗？**
> 
> 不，Django 本身不是 CMS，也不是任何类型的“交钥匙产品”。它是一个 Web 框架；它是一种编程工具，可让您构建网站。
> 
> 例如，将 Django 与 Drupal 之类的东西进行比较没有多大意义，因为 Django 是您用来创建 Drupal 之类的东西的东西。
> 
> 当然，Django 的自动管理站点非常棒且省时——但管理站点是 Django 框架的一个模块。此外，尽管 Django 为构建“CMS-y”应用程序提供了特殊的便利，但这并不意味着它不仅仅适用于构建“非 CMS-y”应用程序（不管这意味着什么！）。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-07T12:17:36.190

**Web 框架**是帮助构建**内容管理器**和类似 Web 应用程序的程序员工具。

正如内容管理器可以分为*简单易用*（Wordpress？和 Joomla？）到*高度可定制和复杂*（Typo3？），框架可以最适合某些任务（而在其他任务中则不那么优雅）。一些 Web 框架（Rails？、Django？和 TurboGears？）更适合类似 CMS 的应用程序，而其他一些（[Werkzeug](http://werkzeug.pocoo.org/)？和[Twisted](http://twistedmatrix.com/trac/)？）试图为更复杂的应用程序提供基础。还有其他人（[塔架](http://wiki.pylonshq.com/display/pylonsdocs/Home)？）试图找到中间地带。

**注意：**括号中的项目名称都有一个问号，因为分类是我个人的意见。它们可能是也可能不是正确的例子。

# wpf - WPF Button.IsCancel 属性如何工作？

> ID：419596
> 
> 赞同：33
> 
> 时间：2009-01-07T08:41:43.897
> 
> 标签：wpf, button

Cancel 按钮背后的基本思想是启用 Escape Keypress 关闭窗口。

> 您可以将 Cancel 按钮上的 IsCancel 属性设置为 true，从而使 Cancel 按钮自动关闭对话框而不处理 Click 事件。

资料来源：Programming WPF (Griffith, Sells)

所以这应该有效

```
<Window>
<Button Name="btnCancel" IsCancel="True">_Close</Button>
</Window> 
```

但是，我期望的行为对我不起作用。父窗口是由 Application.StartupUri 属性指定的主应用程序窗口。有效的是

```
<Button Name="btnCancel" IsCancel=True" Click="CloseWindow">_Close</Button>

private void CloseWindow(object sender, RoutedEventArgs) 
{
    this.Close();
} 
```

*   IsCancel 的行为是否根据 Window 是普通窗口还是对话框而有所不同？IsCancel 是否仅在调用 ShowDialog 时才像宣传的那样工作？
*   按钮（IsCancel 设置为 true）是否需要显式 Click 处理程序才能在 Escape 按下时关闭窗口？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-01-07T08:46:37.740

是的，它只适用于对话框，因为普通窗口没有“取消”的概念，它与 WinForms 中从 ShowDialog 返回的 DialogResult.Cancel 相同。

如果你想关闭一个带有转义的窗口，你可以在窗口上添加一个处理程序到 PreviewKeyDown，选择它是否是 Key.Escape 并关闭表单：

```
public MainWindow()
{
    InitializeComponent();

    this.PreviewKeyDown += new KeyEventHandler(CloseOnEscape);
}

private void CloseOnEscape(object sender, KeyEventArgs e)
{
    if (e.Key == Key.Escape)
        Close();
} 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-02-04T17:06:50.117

我们可以将史蒂夫的回答更进一步，并创建一个附加属性，为任何窗口提供“关闭时转义”功能。编写一次属性并在任何窗口中使用它。只需将以下内容添加到窗口 XAML：

```
yournamespace:WindowService.EscapeClosesWindow="True" 
```

这是该属性的代码：

```
using System.Windows;
using System.Windows.Input;

/// <summary>
/// Attached behavior that keeps the window on the screen
/// </summary>
public static class WindowService
{
   /// <summary>
   /// KeepOnScreen Attached Dependency Property
   /// </summary>
   public static readonly DependencyProperty EscapeClosesWindowProperty = DependencyProperty.RegisterAttached(
      "EscapeClosesWindow",
      typeof(bool),
      typeof(WindowService),
      new FrameworkPropertyMetadata(false, new PropertyChangedCallback(OnEscapeClosesWindowChanged)));

   /// <summary>
   /// Gets the EscapeClosesWindow property.  This dependency property 
   /// indicates whether or not the escape key closes the window.
   /// </summary>
   /// <param name="d"><see cref="DependencyObject"/> to get the property from</param>
   /// <returns>The value of the EscapeClosesWindow property</returns>
   public static bool GetEscapeClosesWindow(DependencyObject d)
   {
      return (bool)d.GetValue(EscapeClosesWindowProperty);
   }

   /// <summary>
   /// Sets the EscapeClosesWindow property.  This dependency property 
   /// indicates whether or not the escape key closes the window.
   /// </summary>
   /// <param name="d"><see cref="DependencyObject"/> to set the property on</param>
   /// <param name="value">value of the property</param>
   public static void SetEscapeClosesWindow(DependencyObject d, bool value)
   {
      d.SetValue(EscapeClosesWindowProperty, value);
   }

   /// <summary>
   /// Handles changes to the EscapeClosesWindow property.
   /// </summary>
   /// <param name="d"><see cref="DependencyObject"/> that fired the event</param>
   /// <param name="e">A <see cref="DependencyPropertyChangedEventArgs"/> that contains the event data.</param>
   private static void OnEscapeClosesWindowChanged(DependencyObject d, DependencyPropertyChangedEventArgs e)
   {
      Window target = (Window)d;
      if (target != null)
      {
         target.PreviewKeyDown += new System.Windows.Input.KeyEventHandler(Window_PreviewKeyDown);
      }
   }

   /// <summary>
   /// Handle the PreviewKeyDown event on the window
   /// </summary>
   /// <param name="sender">The source of the event.</param>
   /// <param name="e">A <see cref="KeyEventArgs"/> that contains the event data.</param>
   private static void Window_PreviewKeyDown(object sender, KeyEventArgs e)
   {
      Window target = (Window)sender;

      // If this is the escape key, close the window
      if (e.Key == Key.Escape)
         target.Close();
   }
} 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2011-12-01T01:22:16.150

这不太正确，不是吗... MSDN 说：当您将按钮的 IsCancel 属性设置为 true 时，您将创建一个向 AccessKeyManager 注册的 Button。然后，当用户按下 ESC 键时，该按钮被激活。因此，您的代码中确实需要一个处理程序并且您不需要任何附加属性或类似的东西

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-11T09:57:58.547

是的，这是正确的。在 WPF 中的 Windows 应用程序中，AcceptButton 和 Cancel 按钮在那里。但有一件事是，如果您将控件可见性设置为 false，那么它将无法按预期工作。为此，您需要在 WPF 中将可见性设置为 true。例如：（它不适用于取消按钮，因为这里的可见性是错误的）

```
<Button x:Name="btnClose" Content="Close" IsCancel="True" Click="btnClose_Click" Visibility="Hidden"></Button> 
```

所以，你需要做到：

```
<Button x:Name="btnClose" Content="Close" IsCancel="True" Click="btnClose_Click"></Button> 
```

然后你`btnClose_Click`在文件后面写了代码：

```
private void btnClose_Click (object sender, RoutedEventArgs e)
    { this.Close(); } 
```

# php - 你认为 foreach((array)$foo as $bar) 是一种代码味道吗？

> ID：419598
> 
> 赞同：2
> 
> 时间：2009-01-07T08:41:46.190
> 
> 标签：php

你认为这是一种代码味道吗？

```
foreach((array)$foo as $bar)
{
    $bar->doStuff();
} 
```

我应该改用它吗？

```
if (isset($foo) && is_array($foo))
{
    foreach($foo as $bar)
    {
        $bar->doStuff();
    }
} 
```

还有其他好的做法来涵盖未设置变量和断言数组吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-07T09:12:42.307

它们都是代码气味。第二个只是逃避所有的错误信息，有点像在你把厨房着火之前关掉火警。这两个都告诉您，您不知道变量中的内容，`$foo`或者它是否已在上面的代码中定义。您需要重新查看代码并准确了解`$foo`.

如果是我的代码，$foo 可能总是被定义为一个数组，或者 false 表示不需要该数组：

```
if(do_we_need_an_array())
  $foo = function_returning_an_array();
else
  $foo = false;

[...snip...]

if($foo)
  foreach($foo as $f) { ... } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-07T09:11:37.737

如果您正在测试是否设置了变量，则可以初始化它们：

```
if (! $foo or !is_array($foo))
    $foo = array();

foreach($foo as $bar)
{
    $bar->doStuff();
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-07T08:53:39.520

就个人而言，我永远不会使用第一种方法，而总是选择第二种方法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-07T12:12:31.397

如果 $foo 应该始终是一个数组，那么如果您对错误情况进行某种处理，那么第二种形式会好得多，例如：

```
if (isset($foo) && is_array($foo))
{
    foreach($foo as $bar)
    {
        $bar->doStuff();
    }
} 
else
{
    // This should not happen, exit angrily.
    exit("Oh crap, foo isn't an array!");
} 
```

当然，您不必只是退出应用程序，而是在这种情况下做任何适当的事情，可能是日志记录或一些替代逻辑。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-08T10:01:33.453

```
(array)$foo != if (isset($foo) && is_array($foo)) 
```

转换对于`(array)`将对象转换为数组或将标量转换为数组很有用，因此您可以为可能包含单个值或数组的变量创建一致的接口。

```
(array)$foo == array($foo) 
```

如数组类型[的 PHP 手册中所定义。](http://us.php.net/manual/en/language.types.array.php#language.types.array.casting)

因此，如果您需要始终使用数组，那么您提供的第一个代码片段就是答案。但是类型转换规则仍然适用，因此您可能无法获得所需的内容，因此请查看手册以获取更多信息。否则，第二个选项将阻止访问不是数组的未设置变量。

就代码气味而言，我想说肯定可以避免检查未设置的变量，但是总是知道一个变量将有一个数组往往会爬上去。所以我的目标是尽量减少包含在`is_array($foo)`if-then 语句中的代码。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-08-03T11:57:40.237

我通常这样做是为了确保 foreach 可以同时处理标量和集合：

```
<?php

foreach (makeSureTraversable($scalarOrCollection) as $val)
{
    // Do something.
}

function
makeSureTraversable($anything)
{
    if (is_array($anything) || ($anything instanceof Traversable))
    {
        return $anything;
    }
    else
    {
        return array($anything);
    }
} 
```

这样，我还处理实现 Traversable（来自 SPL）的类，这意味着允许它们在 foreaches 中使用。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-09-16T12:59:14.777

```
if (!isset($foo) && !is_array($foo)) {
    throw new InvalidArgumentException('Wrong array passed'); 
    // Or do something to recover lost array
}
foreach($foo as $bar) {
    $bar->doStuff();
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-09-16T13:16:09.590

很多时候，您想编写一个函数来为参数获取一个或多个值：

```
function getNamesById($id) { } 
```

在这种情况下，如果使用 id 数组调用此函数，它可能应该返回一个名称数组，这将是有意义的。同样，为了避免调用代码必须将输入包装在数组中然后解包输出，如果您只传递一个标量，那么应该返回一个标量。考虑设计用于处理标量和数组参数的函数的可能内容：

```
function getNamesById($id) {
    $returnAnArray = is_array($id);
    $output = array();
    foreach ((array)$id as $theId) {
        // perform some logic
        $output[] = someFunction($theId);
    }
    return $returnAnArray ? $output : $output[0];
} 
```

您可以看到，在这种情况下，强制转换为数组肯定会让每个人的事情变得更容易。正如他们所说，对您接受的内容要自由...只要有文件证明变量*可能*是其中一个，那么我认为没有问题。PHP 是一种[鸭子类型的](http://en.wikipedia.org/wiki/Duck_Typing)语言，它既有优点也有缺点，但这是优点之一，尽情享受吧！

# c - 在 C 中使用 strcat

> ID：419604
> 
> 赞同：13
> 
> 时间：2009-01-07T08:43:06.390
> 
> 标签：c, string

好的，所以我有以下代码，它在 C# 中将一个字符串附加到另一个字符串，请注意，这只是一个**示例**，因此在 C# 中提供替代字符串连接方法并不是必需的，这只是为了简化示例。

```
string Data = "";
Data +="\n\nHTTP/1.1 " + Status_code;
Data += "\nContent-Type: " + Content_Type;
Data += "\nServer: PT06";
Data += "\nContent-Length: " + Content_Lengt;
Data += "\nDate: " + Date;
Data += "\n" + HTML; 
```

现在我想在 C 中做同样的事情，我试图通过以下方式做到这一点

```
time_t rawtime;

time ( &rawtime );

char *message = "\n\nHTTP/1.1 ";
message = strcat(message, Status_code);
message = strcat(message, "\nContent-Type: ");
message = strcat(message, Content_Type);
message = strcat(message, "\nServer: PT06");
message = strcat(message, "\nContent-Length: ");
message = strcat(message, Content_Lengt);
message = strcat(message,  "\nDate: ");
message = strcat(message, ctime(&rawtime));
message = strcat(message, "\n");
message = strcat(message, HTML); 
```

现在，这给了我一个段错误，我知道为什么，我访问和读取了我不应该访问的内存。但问题是，我该如何解决？我可以使用 string.h 并像在 C# 中那样做吗？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-01-07T08:48:09.483

改变

```
char *message = "\n\nHTTP/1.1 "; 
```

到

```
char message[1024];  
strcpy(message,"\n\nHTTP/1.1 "); 
```

你应该没问题，总消息长度为 1023。

编辑：（根据 mjy 的评论）。以这种方式使用 strcat 是获得缓冲区溢出的好方法。您可以轻松编写一个小函数来检查缓冲区的大小和传入字符串添加的长度来克服这个问题，或者在动态缓冲区上使用 realloc。IMO，程序员有责任检查使用它们的正确缓冲区大小，就像*sprintf*和其他 C 字符串函数一样。我假设出于性能原因在 C++ 上使用 C，因此 STL 不是一个选项。

编辑：根据 Filip 评论的请求，基于固定大小的字符缓冲区的简单 strcat 实现：

```
char buffer[MAXSIZE] = "";

int mystrcat(char *addition)
{
   if (strlen(buffer) + strlen(addition) + sizeof(char)  >= MaxSize)
     return(FAILED);
   strcat(buffer,addition);
   return(OK);
} 
```

使用动态分配：

```
char *buffer = NULL;

int mystrcat(char *addition)
{
   buffer = realloc(buffer, strlen(buffer) + strlen(addition) + sizeof(char));
   if (!buffer)
     return(FAIL);
   strcat(buffer, addition);
   return(OK);
} 
```

在这种情况下，您必须在完成后手动释放缓冲区。（由 C++ 等效项中的析构函数处理）

附录（人）：

好的，既然您实际上并没有**解释**为什么必须创建`message[1024]`，就在这里。

使用 char *x = "hello"，实际字节 ('h','e','l','l','o',0)（最后为 null）存储在与变量（很可能是只读的）和变量 x 设置为指向它。在 null 之后，可能还有其他非常重要的东西。所以你根本不能追加。

使用`char x[1024]; strcpy(x,"hello");`，您首先分配完全专用于 x 的 1K om 内存。然后你把“hello”复制进去，最后仍然留出相当多的空间来附加更多的字符串。除非您追加超过允许的 1K 奇数，否则您不会遇到麻烦。

结束附录（Pax）：

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-07T09:40:48.147

我想知道为什么还没有人提到`snprintf()`。`stdio.h`这是输出多个值的 C 方式，您甚至不必事先将原语转换为字符串。

下面的示例使用堆栈分配的固定大小的缓冲区。否则，您必须`malloc()`使用缓冲区（并存储其大小），这将使`realloc()`溢出成为可能......

```
char buffer[1024];
int len = snprintf(buffer, sizeof(buffer), "%s %i", "a string", 5);
if(len < 0 || len >= sizeof(buffer))
{
    // buffer too small or error
} 
```

**编辑：**您也可以考虑使用该`asprintf()`功能。它是一个广泛可用的 GNU 扩展，是 TR 24731-2 的一部分（这意味着它可能会成为下一个 C 标准）。上面的示例将读取

```
char * buffer;
if(asprintf(&buffer, "%s %i", "a string", 5) < 0)
{
    // (allocation?) error
} 
```

使用完后请记住`free()`缓冲区！

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-07T08:51:09.883

从使用更安全的`strncat`功能开始。一般来说，如果字符串的大小大于特定大小，则始终使用不会溢出的更安全的 'n' 函数。

在 C 中，您需要自己处理字符串大小。所以你需要知道生成的字符串有多大并适应它。如果您知道左侧所有字符串的大小，则应该创建一个足够大的缓冲区来保存结果字符串。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-07T08:46:46.163

message 指向您无法写入的 char const[] ，但这正是 strcat 正在写入的位置。您需要 malloc() 一个足够大的缓冲区。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-07T09:11:46.177

如前所述，您必须写入足够大的缓冲区。不幸的是，这样做需要做很多额外的工作。大多数处理字符串的 C 应用程序使用可动态调整大小的字符串缓冲区来进行连接。

glib 包含一个实现，[glib strings](http://library.gnome.org/devel/glib/stable/glib-Strings.html)，我建议将它用于任何大量使用字符串的应用程序。它使管理内存更容易，并防止缓冲区溢出。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-07T22:04:26.333

没有看到任何提到 strlcpy、strlcat 函数，它类似于“n”函数，除了也考虑到尾随 0。两者都采用第三个参数指示输出缓冲区的最大长度，可以在 string.h 中找到.

例子：

```
char blah[]="blah";
char buffer[1024];
strlcpy(buffer,"herro!!!",sizeof(buffer));
strlcat(buffer,blah,sizeof(buffer));
printf("%s\n",buffer); 
```

将输出“herro!!!blah”

```
char blah[]="blah";
char buffer[10];
strlcpy(buffer,"herro!!!",sizeof(buffer));
strlcat(buffer,blah,sizeof(buffer));
printf("%s\n",buffer); 
```

由于缓冲区 [] 的大小有限，将输出“herro!!!b”，没有段错误。^^

唯一的问题不是所有平台似乎都将它包含在它们的 libc 中（例如 linux ._.），大多数 BSD 变体似乎都有它。

在这种情况下，可以在这里找到这两个函数的代码并轻松添加：[strlcpy](http://www.openbsd.org/cgi-bin/cvsweb/src/lib/libc/string/strlcpy.c?rev=1.11;content-type=text%2Fplain)、[strlcat](http://www.openbsd.org/cgi-bin/cvsweb/src/lib/libc/string/strlcat.c?rev=1.13;content-type=text%2Fplain)、 [string.h 的其余部分](http://www.openbsd.org/cgi-bin/cvsweb/src/lib/libc/string/)

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2009-01-07T09:19:13.010

以经典 C 风格执行此操作的安全方法是：

```
 char *strconcat(char *s1, char *s2)
 {
    size_t old_size;
    char *t;

    old_size = strlen(s1);

    /* cannot use realloc() on initial const char* */
    t = malloc(old_size + strlen(s2) + 1);
    strcpy(t, s1);
    strcpy(t + old_size, s2);
    return t;
  }

  ...

  char *message = "\n\nHTTP/1.1 ";
  message = strconcat (message, Status_code);
  message = strconcat (message, "\nContent-Type: "); 
```

现在你可以说很多关于它的坏话：它效率低下，它会破坏你的记忆，它很丑陋......但它或多或少是任何具有字符串连接运算符和 C 类型（零终止）字符串的语言都会做的（除了这些语言中的大多数都将内置垃圾收集）。

# sharepoint - Sharepoint 文档协作

> ID：419628
> 
> 赞同：1
> 
> 时间：2009-01-07T08:51:00.117
> 
> 标签：sharepoint

**文档协作** 这是否可以根据用户来限制文档中的部分。Egg：文档包含三个部分，Section 1、Section 2、Section 3 三个用户需要为文档准备做出贡献，用户 1 为第 1 部分用户 2 为第 2 部分用户 3 为第 3 部分。

谢谢， Gunasekaran Sambandhan

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-08T02:45:22.337

SharePoint 只能为离散对象（列表、库、网站、文档等）设置权限，无法分割单个文件。

我们在工作中做了两件不同的事情来应对这种需求。我们要么为给定文档创建一个库，然后为每个部分创建单独的文件（即使您不需要限制每个部分的访问，这对于协作处理大型文档也很有用），或者我们为这些部分创建单独的库。后者是一种更好的安全方式，因为它降低了某人创建文档而不设置权限的风险。

FWIW：我快速检查了 Word 是否允许我对文档的某些部分进行 DRM，答案是否定的。

干杯，里夫斯

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-07T12:46:23.217

SharePoint 不知道文档中的实际内容（搜索索引除外）。

要执行您想要的操作，您必须将文档分成 3 个不同的文档并在每个文档上使用项目级别权限，或者将每个部分放在一个单独的文档库中，该文档库已经设置了与用户相对应的权限级别你希望能够为那部分做出贡献。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-07T19:19:05.263

你好，

SharePoint 将所有协作和安全功能限制在文档级别。我们成功使用的一个解决方案是拥有 3 个文档库，每个文档库都有一个用户访问。
这些库中的文档中存在一个快速部件，它在文档库列中提取信息。
第四个文档库有 3 个查找列从上述 3 个文档库列中提取信息。
这可以再次使用 Quickparts 链接到单个文档。

亲切的问候，

# visual-studio-2008 - VS2008：在模式文件上运行 xsd.exe 会给出 XMLSchema：未声明日期时间

> ID：419630
> 
> 赞同：1
> 
> 时间：2009-01-07T08:51:31.897
> 
> 标签：visual-studio-2008, xsd.exe

我有一个看起来像这样的 XSD（大致）

```
<xs:schema id="Appointment" targetNamespace="http://tempuri.org/Record.xsd" elementFormDefault="qualified"
attributeFormDefault="qualified" xmlns="http://tempuri.org/Record.xsd" xmlns:mstns="http://tempuri.org/Record.xsd"
xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:msdata="urn:schemas-microsoft-com:xml-msdata">
<xs:element name="Record" msdata:IsDataSet="true">
    <xs:complexType>
        <xs:choice maxOccurs="unbounded">
            <xs:element name="Record">
                <xs:complexType>
                    <xs:sequence>
                        <xs:element name="ID" type="xs:string" minOccurs="0" />
                        <xs:element name="TimeStart" type="xs:datetime" minOccurs="0" />
                        <xs:element name="TimeEnd" type="xs:datetime" minOccurs="0" />
                    </xs:sequence>
                </xs:complexType>
            </xs:element>
        </xs:choice>
    </xs:complexType>
</xs:element> 
```

当我尝试使用 VS2008 中的 xsd.exe 从中生成类时，我得到字符串字段而不是日期字段，并发出警告

```
Schema validation warning: Type 'http://www.w3.org/2001/XMLSchema:datetime' is not declared. Line 13, position 9. 
```

有什么线索吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-07T08:58:51.710

呸，没关系。

是区分大小写的问题。

使用的正确形式是

```
xs:dateTime 
```

代替

```
xs:datetime 
```

# sharepoint - 可以在另一个内部加载一个 Web 部件吗？

> ID：419632
> 
> 赞同：11
> 
> 时间：2009-01-07T08:52:57.697
> 
> 标签：sharepoint, web-parts

所以，这就是我们想要做的：我们想要一个通用的 Web 部件，其周围有一个自定义框架，然后在其中动态加载其他 Web 部件（无框架）。你认为这可能吗？有点像[Jan Tielens SmartPart](http://www.codeplex.com/smartpart)，只是不是用于 ASP.Net 用户控件，而是用于其他 Web 部件......；）

编辑：我们现在已经能够做到这一点。解决方案实际上非常简单。查看代码：

```
public class WebPartWrapper : System.Web.UI.WebControls.WebParts.WebPart {
    protected override void CreateChildControls() {    
        Panel pnl = new Panel();
        this.Controls.Add(pnl);
        WebPart dynamicPart = WebPartFactory.CreateWebPart("RSSViewer");
        pnl.Controls.Add(dynamicPart);
    }
} 
```

就这么简单...我们还使用反射将 webparts 存储为 Xml 等，但这不是重点。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-07T09:02:49.330

我不这么认为。我前一阵子尝试过，它抱怨只能在 Page Init 中添加 WebPartZone 项目。我认为在初始化“容器”WebPart 时，添加更多区域为时已晚，因为已经初始化了保留页面。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-12T14:14:42.293

```
public class WebPartWrapper : System.Web.UI.WebControls.WebParts.WebPart {
    protected override void CreateChildControls() {    
        Panel pnl = new Panel();
        this.Controls.Add(pnl);
        var factory = new WebPartFactory()
        WebPart dynamicPart = factory.CreateWebPart("RSSViewer", this.Guid);
        pnl.Controls.Add(dynamicPart);
    }
}

public class WebPartFactory {
    public WebPart CreateWebpart(string webpartName, Guid parentWebPartGuid)
    {
        var config = ConfigurationFactory.LoadConfiguration(webpartName);

        Assembly webPartAssembly = Assembly.Load(config.Assembly);
        Type webPartType = webPartAssembly.GetType(config.Class);
        object actualWebPart = Activator.CreateInstance(webPartType);

        foreach (var item in config.Properties)
        {
            PropertyInfo webPartProperty = webPartType.GetProperty(item.Name);
            object webPartPropertyValue = Convert.ChangeType(itemValue, Type.GetType(item.Type));
            if (!String.IsNullOrEmpty(item.Value))
                webPartProperty.SetValue(actualWebPart, webPartPropertyValue, null);
        }

        RunMethod("set_StorageKeyInternal", actualWebPart, new object[] { parentWebPartGuid });
        return actualWebPart as WebPart;
    }

    private void RunMethod(string methodName, object objectInstance, object[] methodParameters)
    {
        BindingFlags flags = BindingFlags.Instance | BindingFlags.Public |
            BindingFlags.NonPublic;

        Type t = objectInstance.GetType();
        MethodInfo m = GetMethod(t, methodName, flags);
        if (m != null)
        {
            m.Invoke(objectInstance, methodParameters);
        }
    }

    private MethodInfo GetMethod(Type instanceType, string methodName, BindingFlags flags)
    {
        MethodInfo m = instanceType.GetMethod(methodName, flags);
        if (m != null)
        {
            return m;
        }

        if (instanceType.GetType() == typeof(object) || instanceType.BaseType == null)
        {
            return null;
        }

        return GetMethod(instanceType.BaseType, methodName, flags);
    } 
} 
```

这段代码需要一些解释......如果它不能编译，请原谅，我不得不删除相当多的原始代码，这是非常特定于实现的东西。我也没有展示“config”类，它只是一个用于配置 webpart 的容器，只是一堆属性。我想更详细地讨论两个问题：

1.  parentWebPartGuid - 这是托管 Web 部件的 Guid (UniqueId?)。出于某种原因，我们必须使用反射将“StorageKeyInternal”设置为这个值（它是一个私有属性）。您可以不设置它而侥幸逃脱，但至少对于大多数 Web 部件来说，我们必须设置它。

2.  config.Properties - 这是配置值（我们将它们设置在自定义的 .xml 文件中，但可以从任何地方随意获取）。它看起来有点像[这样](http://cid-3a746453fc8ad1ba.skydrive.live.com/embedphoto.aspx/Offentlig/xml.PNG)..

在我们的框架中，我们还支持动态属性值等内容，但那是另一天......希望这一切都有意义并且可以帮助某人。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-07T09:02:55.210

有（至少）两种方法可以做到这一点：使用 iframe HTML 元素，或者只是一个内容由 JavaScript 更改的 div（可能使用 Ajax）。

[注意] 我的答案是通用的（即在网页设计方面），我不知道它在您的技术背景下如何，所以也许我应该删除这个答案......

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-11-24T19:39:41.450

没有机会获得 WebPartFactory 类的源代码吗？或者可能有更多关于它的信息？可能是伪代码？如果自定义 Web 部件在库中，它可以以与 RSSViewer 相同的方式引用它是否正确？我只是不确定如何去做你在这里所做的事情，我非常想更好地了解如何做到这一点。

谢谢！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-04-15T12:56:49.087

当想要在另一个自定义 Web 部件中实例化自定义 Web 部件时，我在 .ascx 中使用以下代码

```
<%@ Register tagPrefix="uc1" Namespace="Megawork.Votorantim.Intranet.Webparts_Intranet.LikeButton" Assembly="Megawork.Votorantim.Intranet, Version=1.0.0.0, Culture=neutral, PublicKeyToken=769156d154035602"  %> 
```

命名空间值和程序集值可以从 webconfig 中的 SafeControls 行或从包文件（在清单选项卡中）复制:)

当我想实例化它时（实际上）是在 .cs 中使用以下代码

```
//This is the namespace of the control that will be instantiated dinamically    
string type = "My.Custom.Namespace.WebpartToBeAdded.WebpartToBeAdded";

// Instantiate the control dinamically based on his type
System.Web.UI.WebControls.WebParts.WebPart genericWP = (System.Web.UI.WebControls.WebParts.WebPart)Activator.CreateInstance(Type.GetType(type));

// sets the page to the genericWP (i dont know if this is required)
genericWP.Page = this.Page;

// Note: if you want to call custom methods of the dinamically instantiated controls (like a custom load method) you will need to create an interface and make your dinamically instantiated webpart implement it. You will need to do it in that file that have the following code: private const string _ascxPath @"~/_CONTROLTEMPLATES/...". Then you can do the following
//IMyInterface ig = (IMyInterface)genericWP;
//ig.MyCustomLoadMethod(someParam);

// Adds the controls to a container, an asp panel by example.
panelDinamicControls.Controls.Add(genericWP); 
```

# debugging - 你觉得源代码分析器有用吗？

> ID：419637
> 
> 赞同：6
> 
> 时间：2009-01-07T08:55:20.717
> 
> 标签：debugging, code-analysis, static-analysis

*   你使用源代码分析器吗？如果是这样，哪些和哪些语言发展？
*   您是否发现它们有助于解决代码中的潜在错误？还是他们的大多数警告都是微不足道的？
*   长时间使用后，您是否发现您的代码质量比以前更高了？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-07T09:24:02.437

我在 Java 中使用了一些静态分析工具。[FindBugs](http://findbugs.sourceforge.net/)是第一道防线，可以捕捉到很多常见错误并提供非常有用的反馈。它经常发现疲倦的程序员的愚蠢错误，并且不会给用户带来沉重的负担。

[PMD](http://pmd.sourceforge.net/)适用于许多其他更棘手的错误，但需要更多配置。您会发现 PMD 的默认值通常超过顶部。有太多的规则可能在很小的范围内是有益的，但最终不会帮助其他程序员维护你的代码。一些 PMD 规则通常带有过早优化的味道。

可能更有用的是 PMD 中的[CPD](http://pmd.sourceforge.net/cpd.html)支持。它试图找到在别处重复的代码，以使重构更容易。运行整个项目，这确实有助于确定清理代码和停止任何 DRY 违规的最大优先事项。

[Checkstyle](http://checkstyle.sourceforge.net/)也很方便，确保您的编码器符合一些编码风格标准。它与 PMD 有一些重叠，但通常更有用。

最后，[Cobertura](http://cobertura.sourceforge.net/)是一个很棒的测试覆盖套件。非常方便找出缺少单元测试的地方，以及应该优先考虑创建新测试的地方。

哦，我也一直在测试[Jester](http://jester.sourceforge.net/)。即使在代码有一定覆盖率的情况下，它似乎也能很好地发现测试中的漏洞。暂时不推荐，只是因为我用的还不够多，只能试一试。

我在 Eclipse 中和作为自动化构建套件的一部分运行这些工具。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-07T09:08:08.990

我是[PC-Lint](http://www.gimpel.com/) for C 和 C++ 的长期用户，发现它非常有帮助。在接管您不熟悉的代码库时，这些工具最有用。随着时间的推移，您会遇到收益递减规律，您发现的新错误的数量往往会逐渐减少。

我总是对一个大版本的完整项目进行 lint。

[编辑：这里](http://en.wikipedia.org/wiki/Static_code_analysis)有一个很好的维基百科相关工具列表

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-07T09:44:07.280

对于 C，我使用[MEMWATCH](http://directory.fsf.org/project/memwatch/)。它真的很容易使用和免费。

过去我用它来查找许多内存错误。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-07T10:47:52.050

我使用了 resharper 和 MS TS（基本上是 FXCop），它们都非常有用，尤其是在以下领域：

*   识别死代码
*   范围广
*   性能改进（与全球化等有关）

建议并不总是很好，但通常会提高代码的质量。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-07T09:08:47.353

我将[StyleCop](http://code.msdn.microsoft.com/sourceanalysis)用于 C#。这是一个很好的工具，可以保持一致的代码风格，从而提高代码质量。[ReSharper](http://www.jetbrains.com/resharper)还进行了一些代码分析，但它非常基础。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-07T10:08:01.943

我对[ReSharper](http://www.jetbrains.com/resharper)非常满意。它不仅在编码时提供有用的信息位（例如，不必要的强制转换、只读应用等），而且它的重构功能非常适合快速重新排列代码。

它并没有涵盖所有内容，因此 FxCop（或类似的）是工具箱的一个不错的补充。但是，由于 Resharper 会立即提供反馈，因此周转时间非常好。（我知道 FxCop 可以从 VS 运行，但它与 imo 不同）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-07T10:49:05.170

我发现分析器有些用处，我使用 Visual Studio 的 buildin（例如 /analyze 用于 c/c++ 和 .net 的自定义规则），偶尔我将[stylecop](http://code.msdn.microsoft.com/sourceanalysis)和[codeitright](http://submain.com/codeit.right/)用于 c#，主要用于指导事情应该如何。

我不认为有一个完美的工具可以找到所有的错误，但我认为这些工具有助于找到一些错误，不是无法追踪的，但相信我你会花费大量时间来找到它们。

是的，您的代码质量比以前好一些，但我也相信仍然需要大量手动调试。源分析器不是最终的治疗方法，但它们是一种好药。如果有一个工具，您只需执行它并找到任何类型的错误并为您修复它，将花费数百万美元。

我认识的一些程序员发誓 IBM Rational PurifyPlus 非常棒，但他们认为我只使用了 2-3 次工具。

但永远记住编程逻辑错误的基本原则之一是最难发现和修复，因此长时间的调试是不可避免的。一个好的代码分析器结合单元测试可能会创造奇迹。

PS。我倾向于在 C# 中产生比在 C++ 中少得多的错误，有人可能会说我错了，但是虽然我使用 c++ 的年头比 c# 多，但我发现 C# 的“编码它，我会处理它”的 gc 方法比 c++ 容易得多特别是对于您急于在时间限制/截止日期完成的项目，每个项目都像现在这样......

# language-agnostic - C# 数据结构算法

> ID：419638
> 
> 赞同：4
> 
> 时间：2009-01-07T08:56:04.100
> 
> 标签：language-agnostic, data-structures, sorting

我最近接受了一家顶级软件公司的采访。我完全被面试官问我的一个问题所困扰，那就是

问：我有一台 512 mb / 1 GB RAM 的机器，我必须对 4 GB 大小的文件（XML 或任何文件）进行排序。我将如何进行？数据结构是什么，我将使用哪种排序算法以及如何使用？

你认为它可以实现吗？如果是，那么你能解释一下吗？

提前致谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-07T09:09:17.117

面试官可能想要的答案可能是您如何有效地对超出系统内存的数据集进行排序。以下部分摘自[维基百科](http://en.wikipedia.org/wiki/Sorting_algorithm#Memory_usage_patterns_and_index_sorting)：

> **内存使用模式和索引排序**
> 
> 当要排序的数组的大小接近或超过可用的主内存时，必须使用（慢得多的）磁盘或交换空间，排序算法的内存使用模式变得很重要，并且可能已经相当公平的算法当阵列很容易适合 RAM 时，效率可能变得不切实际。在这种情况下，比较的总数变得（相对）不那么重要，并且必须从磁盘复制或交换内存部分的次数可以支配算法的性能特征。因此，通过次数和比较的本地化可能比原始比较次数更重要，因为附近元素之间的比较发生在系统总线速度下（或者，使用缓存，甚至在 CPU 速度下），其中，
> 
> 例如，流行的递归快速排序算法在 RAM 充足的情况下提供了相当合理的性能，但由于它复制数组部分的递归方式，当数组不适合 RAM 时，它变得不太实用，因为它可能会导致大量慢速复制或从磁盘移动操作。在这种情况下，另一种算法可能更可取，即使它需要更多的总比较。
> 
> 当复杂记录（例如在关系数据库中）按相对较小的键字段排序时，解决此问题的一种方法是在数组中创建索引，然后对索引进行排序，而不是对整个索引进行排序。大批。（然后可以通过一次从索引读取整个数组的排序版本，但通常即使这样也是不必要的，因为有排序索引就足够了。）因为索引比整个数组小得多，它可能可以轻松放入整个阵列无法放入的内存中，从而有效地消除了磁盘交换问题。这个过程有时被称为“标签排序”。 [5]
> 
> 克服内存大小问题的另一种技术是将两种算法结合起来，利用每种算法的优势来提高整体性能。例如，数组可能被细分为大小可以轻松放入 RAM 中的块（例如，几千个元素），使用有效算法（例如快速排序或堆排序）对块进行排序，并根据合并排序合并结果. 这比首先进行合并排序效率低，但它需要的物理 RAM（实用）比对整个阵列的完整快速排序要少。
> 
> 也可以结合技术。为了对大大超出系统内存的非常大的数据集进行排序，甚至可能需要使用一种算法或算法组合对索引进行排序，该算法或算法旨在合理地使用虚拟内存执行，即减少所需的交换量。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-07T09:04:36.720

使用[分而治之](http://en.wikipedia.org/wiki/Divide_and_conquer_algorithm)。

这是伪代码：

```
function sortFile(file)
    if fileTooBigForMemory(file)
       pair<firstHalfOfFile, secondHalfOfFile> = breakIntoTwoHalves()
       sortFile(firstHalfOfFile)
       sortFile(secondHalfOfFile)
    else
       sortCharactersInFile(file)
    endif

    MergeTwoHalvesInOrder(firstHalfOfFile, secondHalfOfFile)
end 
```

属于分而治之的两种著名算法是[归并排序](http://en.wikipedia.org/wiki/Merge_sort)和[快速排序](http://en.wikipedia.org/wiki/Quick_sort)算法。所以你可以用它们来实现。

至于数据结构，一个包含文件中字符的字符数组就可以了。如果您想更加面向对象，请将其包装在一个名为 File 的类中：

```
class File {
    private char[] characters;
    //methods to access and mutate 'characters'
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-07T09:01:59.970

[Guido van Rossum博客](http://neopythonic.blogspot.com/2008/10/sorting-million-32-bit-integers-in-2mb.html)上有一篇不错的帖子，其中有一些建议。请注意，代码是用 Python 编写的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-07T09:06:03.737

将文件拆分为适合内存的块。使用快速排序对每个块进行排序并将其保存到单独的文件中。然后合并结果文件，你得到你的结果。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-22T03:23:43.003

我会使用多路合并。有一本很棒的书叫做[管理千兆字节](http://books.google.com/books?id=2F74jyPl48EC&dq=managing+gigabytes&printsec=frontcover&source=bn&hl=en&ei=RIvuSfWnHN6rtge3ncnMDw&sa=X&oi=book_result&ct=result&resnum=4#PPR6,M1)，它展示了几种不同的方法。他们还对大于物理内存的文件进行基于排序的反转。查看第 240 页，了解关于磁盘上的块排序的非常详细的算法。

上面的帖子是正确的，因为您拆分了文件并对每个部分进行了排序。

假设您有 4GB 的文件，并且只想加载最大 512MB。这意味着您需要将文件分成至少 8 个块。如果您不确定您的排序将使用多少额外开销，您甚至可以将该数字加倍以确保 16 个块的安全。

然后将 16 个文件一次排序一个，以保证顺序。所以现在你有块 0-15 作为排序文件。

现在您打开这些文件的 16 个文件句柄并一次读取一个条目，将最低的一个写入最终输出。由于您知道每个文件都已排序，因此从每个文件中取最低的意味着您将它们以正确的顺序写入最终输出。

我在 C# 中使用了这样一个系统来对电子邮件中的大量垃圾邮件进行分类。原始系统要求所有这些都加载到 RAM 中，以便对它们进行排序并为垃圾邮件计数建立字典。一旦文件增长超过 2 GB，内存结构就需要 6+GB 的 RAM，并且由于分页和 VM 的原因需要超过 24 小时才能进行排序。使用上述分块的新系统在 40 分钟内对整个文件进行了排序。对于如此简单的更改，这是一个令人印象深刻的加速。

我使用了各种加载选项（每个块 1/4 系统内存等）。事实证明，对于我们的情况，最好的选择是大约 1/10 系统内存。然后 Windows 有足够的内存留给体面的文件 I/O 缓冲来抵消增加的文件流量。这台机器对运行在它上面的其他进程非常敏感。

是的，我也经常喜欢在面试中问这些类型的问题。只是看看人们是否可以跳出框框思考。当您不能只在列表上使用 .Sort() 时，您会怎么做？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-07T09:28:36.563

只需模拟一个虚拟内存，重载数组索引运算符，[]

查找在 C++ 或 C# 中对数组进行排序的快速排序实现。重载索引器运算符 [] ，它将读取并保存到文件中。这样，您只需插入现有的排序算法，您只需更改那些 []

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-01-07T20:42:32.100

这是在 C# 上模拟虚拟内存的一个示例

来源： http: [//msdn.microsoft.com/en-us/library/aa288465 (VS.71).aspx](http://msdn.microsoft.com/en-us/library/aa288465(VS.71).aspx)

```
// indexer.cs
// arguments: indexer.txt
using System;
using System.IO;

// Class to provide access to a large file
// as if it were a byte array.
public class FileByteArray
{
    Stream stream;      // Holds the underlying stream
                        // used to access the file.
// Create a new FileByteArray encapsulating a particular file.
    public FileByteArray(string fileName)
    {
        stream = new FileStream(fileName, FileMode.Open);
    }

    // Close the stream. This should be the last thing done
    // when you are finished.
    public void Close()
    {
        stream.Close();
        stream = null;
    }

    // Indexer to provide read/write access to the file.
    public byte this[long index]   // long is a 64-bit integer
    {
        // Read one byte at offset index and return it.
        get 
        {
            byte[] buffer = new byte[1];
            stream.Seek(index, SeekOrigin.Begin);
            stream.Read(buffer, 0, 1);
            return buffer[0];
        }
        // Write one byte at offset index and return it.
        set 
        {
            byte[] buffer = new byte[1] {value};
            stream.Seek(index, SeekOrigin.Begin);
            stream.Write(buffer, 0, 1);
        }
    }

    // Get the total length of the file.
    public long Length 
    {
        get 
        {
            return stream.Seek(0, SeekOrigin.End);
        }
    }
}

// Demonstrate the FileByteArray class.
// Reverses the bytes in a file.
public class Reverse 
{
    public static void Main(String[] args) 
    {
        // Check for arguments.
        if (args.Length == 0)
        {
            Console.WriteLine("indexer <filename>");
            return;
        }

        FileByteArray file = new FileByteArray(args[0]);
        long len = file.Length;

        // Swap bytes in the file to reverse it.
        for (long i = 0; i < len / 2; ++i) 
        {
            byte t;

            // Note that indexing the "file" variable invokes the
            // indexer on the FileByteStream class, which reads
            // and writes the bytes in the file.
            t = file[i];
            file[i] = file[len - i - 1];
            file[len - i - 1] = t;
        }

        file.Close();
    } 
} 
```

使用上面的代码来滚动你自己的数组类。然后只需使用任何数组排序算法。

# .net - 使用 MSI 在我的应用程序中安装 .NET Framework

> ID：419639
> 
> 赞同：3
> 
> 时间：2009-01-07T08:57:21.370
> 
> 标签：.net, windows-installer, prerequisites

我在 VS2008 中创建了一个安装项目。我的 WinForms 应用程序使用 .NET 2.0，所以我选择了 .NET 2.0 Prerequisity 并构建了安装项目。

当我在干净的 PC 上运行 Setup.msi 时，它会正确检测到 .NET 丢失并询问是否应该安装它。成功安装 .NET 后，安装程序会退出并且不会继续安装我的应用程序（我认为应该如此）。

当我在已安装 .NET 的 PC 上运行 MSI 文件时，我的应用程序安装正确。

有什么方法可以一步安装 .NET 2.0 和我的应用程序？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-07T09:21:13.770

您是如何安装产品的？

安装项目将输出两个文件：

*   Windows 安装程序包 (.msi)，以及
*   所谓的引导程序（setup.exe）

引导程序将检查您指定的任何先决条件是否存在，如果尚未安装，则可能下载并安装它**，然后继续安装您的应用程序**（通过调用 .msi）。因此，您应该始终启动 setup.exe 来安装您的应用程序，而不是 .msi 文件（除非您知道所有先决条件都在目标系统上）。

正如 Krakkos 所说，引导程序将安装先决条件和您的应用程序（即您的 .msi 文件）。但是，我不知道有任何配置设置会阻止引导程序安装 msi。

要进行故障排除，您可以尝试创建安装日志并在日志文件中查找任何问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-07T09:37:41.070

谢谢迪沃，

我正在运行 MSI 文件。

运行 Setup.EXE 文件时是否有任何限制？如果我没记错的话，我曾尝试在 Windows 2000 上运行它，但它没有运行。我只能运行 MSI 文件。我打算用干净的Win2000检查PC并回来。

编辑：我已经在干净的 Windows 2000 SP4 上尝试过，结果如下：

*   Setup.exe 不会运行并显示有关 Kernel32.dll 中缺少 HeapSetInformation 的消息
*   Setup.msi 也不会运行（.msi 扩展名未知）

然后我手动安装了 Windows Installer 3.1：

*   Setup.exe 仍不会运行并显示相同的错误消息
*   Setup.msi 将成功运行（但在没有我的应用程序的情况下仅安装 .NET ......我的初始问题）

在 Windows XP 上，Setup.exe 运行没有任何问题。

似乎使用 Win2000 的用户必须通过安装 Windows Installer 3.1、.NET 2.0 和我的应用程序来手动安装我的应用程序。即使手动安装 .NET，Setup.exe 在 Win2000 SP4 下仍会显示相同的错误消息。

编辑：可以通过安装[适用于 Windows 2000 SP4 (KB891861) 的更新汇总 1](http://www.microsoft.com/DOWNLOADS/details.aspx?familyid=B54730CF-8850-4531-B52B-BF28B324C662&displaylang=en)来修复 Win 2000 问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-07T13:16:33.467

[Hanselminutes 的这一集](http://www.hanselminutes.com/default.aspx?showID=156)非常详细地介绍了 Paint.Net 如何安排按需下载和安装所需的 .NET 框架，以及与应用程序安装集成。诚然，这可能比大多数应用程序所需的复杂得多，但仍然是一个有趣的讨论。

# iis - IIS 6.0 虚拟目录设置

> ID：419652
> 
> 赞同：0
> 
> 时间：2009-01-07T09:03:12.120
> 
> 标签：iis, iis-6, directory, virtual

我建立了一个网站，并在网站中创建了一个文件夹名称（文档）作为包含一些文档的虚拟目录。

因此 URL 是 xxxxxxyyyyzzzz.com/docs

问题是当我尝试访问 xxxxxxyyyyzzzz.com/docs/1.doc 时，需要进行身份验证。你能告诉我如何删除它并让任何用户访问这个文件夹有任何限制吗？

大卫

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-07T09:07:04.533

不是真正的编程问题，但是如果您启动 IIS 管理器，请右键单击您的虚拟目录，单击匿名访问和身份验证控制下的编辑，选择“目录安全”并选择“匿名”。

您还需要确保匿名 IIS 帐户具有对相关目录的读取权限（该帐户显示在您启用/禁用匿名访问的屏幕上）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-07T09:07:09.070

检查您是否允许使用以下有效帐户进行匿名访问`Properties| Directory Security | Authentication and access control | Edit...`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-18T01:55:09.160

这里有两个支持文档，可帮助 1.) [设置虚拟目录][1] 和 2.) [如何在 IIS 中管理文件夹权限][2]。

我希望这能给你一些指导。

# delphi - 使用哪种简单的面向未来的 Delphi 串行通信代码？

> ID：419653
> 
> 赞同：10
> 
> 时间：2009-01-07T09:03:14.117
> 
> 标签：delphi, serial-port

多年来，我一直是 Turbopower Async Pro 的粉丝，现在开始使用 SourceForge，它运行良好。但是，它很复杂，除了端口组件之外，我从未真正使用过它的功能。我正在为 D2009 等更新我的代码，并且很想转向更简单的东西，因为我有自己的包装器。那里有很多端口组件，但这里有什么建议吗？谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-08T06:43:47.003

Lars Dybdahl recently blogged about the open source **TComport** component that's sprung back to life, and how Delphi 2007 and 2009 support have been added.

*   Lars's blog: [http://compaspascal.blogspot.com/2008/11/delphi-bigger-than-c-tcomport-history.html](http://compaspascal.blogspot.com/2008/11/delphi-bigger-than-c-tcomport-history.html)

*   TComport home on SourceForge: [http://sourceforge.net/projects/comport/](http://sourceforge.net/projects/comport/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-07T17:04:07.517

另请查看[SynaSer](http://synapse.ararat.cz/doku.php/download)（朝向该页面的底部）。我已经使用他的 TCP/IP 库有一段时间了，发现它非常易于使用和扩展，并且希望他的串行通信库是相似的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-09T11:31:56.220

Delphi 中的任何东西真的是面向未来的吗？无论如何都要坚持开源——如果它在 Sourceforge 上，至少你有源代码，而且如果制造它的公司退出 Delphi 软件业务，它也不会消失。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-07T09:07:21.740

使用任何对你有用的东西。如果 Turbopower Async Pro（呃，这个名字）有效，请不要更改它。:)

# c# - xUnit : 断言两个列表 是平等的吗？

> ID：419659
> 
> 赞同：136
> 
> 时间：2009-01-07T09:06:34.407
> 
> 标签：c#, xunit

我是 TDD 和 xUnit 的新手，所以我想测试我的方法，看起来像：

```
List<T> DeleteElements<T>(this List<T> a, List<T> b); 
```

我可以使用任何 Assert 方法吗？我认为这样的事情会很好

```
List<int> values = new List<int>() { 1, 2, 3 };
List<int> expected = new List<int>() { 1 };
List<int> actual = values.DeleteElements(new List<int>() { 2, 3 });

Assert.Exact(expected, actual); 
```

有这样的吗？

* * *

## 回答 #1

> 赞同：176
> 
> 时间：2009-01-07T09:33:38.207

### 2021 年 4 月 1 日更新

我建议使用[FluentAssertions](https://fluentassertions.com/)。它有一个庞大的 IntelliSense 友好断言库，适用于包括[集合在内的许多用例](https://fluentassertions.com/collections/)

```
collection.Should().Equal(1, 2, 5, 8);
collection.Should().NotEqual(8, 2, 3, 5);
collection.Should().BeEquivalentTo(8, 2, 1, 5); 
```

* * *

### 原始答案

**xUnit.Net**可以识别集合，所以您只需要这样做

```
Assert.Equal(expected, actual); // Order is important 
```

[您可以在CollectionAsserts.cs](https://github.com/xunit/assert.xunit/blob/master/CollectionAsserts.cs)中查看其他可用的集合断言

对于**NUnit**库集合比较方法是

```
CollectionAssert.AreEqual(IEnumerable, IEnumerable) // For sequences, order matters 
```

和

```
CollectionAssert.AreEquivalent(IEnumerable, IEnumerable) // For sets, order doesn't matter 
```

更多细节在这里：[CollectionAssert](https://github.com/nunit/docs/wiki/Collection-Assert)

**MbUnit**也有类似于 NUnit 的集合断言：[Assert.Collections.cs](https://github.com/Gallio/mbunit-v3/blob/master/src/MbUnit/MbUnit/Framework/Assert.Collections.cs)

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2009-08-09T13:10:22.953

在当前版本的 XUnit (1.5) 中，您可以使用

> Assert.Equal（预期，实际）；

上述方法将对两个列表进行逐个元素的比较。我不确定这是否适用于任何以前的版本。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2016-08-31T09:28:11.147

使用 xUnit，如果您想挑选每个元素的属性进行测试，您可以使用 Assert.Collection。

```
Assert.Collection(elements, 
  elem1 => Assert.Equal(expect1, elem1.SomeProperty),
  elem2 => { 
     Assert.Equal(expect2, elem2.SomeProperty);
     Assert.True(elem2.TrueProperty);
  }); 
```

这会测试预期计数并确保每个操作都经过验证。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2019-04-26T10:03:59.930

最近，我在我的 asp.net core 2.2 应用程序中使用`xUnit 2.4.0`和包。`Moq 4.10.1`

就我而言，我设法通过两个步骤使其工作：

1.  定义一个实现`IEqualityComparer<T>`

2.  将比较器实例作为第三个参数传递给`Assert.True`方法：

    `Assert.True(expected, actual, new MyEqualityComparer());`

但是还有另一种更好的方法可以使用[FluentAssertions](https://fluentassertions.com/)包获得相同的结果。它允许您执行以下操作：

```
// Assert          
expected.Should().BeEquivalentTo(actual)); 
```

有趣的是，`Assert.Equal()`即使我订购了两个列表的元素以使它们以相同的顺序排列，它也总是失败。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-08-25T12:06:37.637

刚刚找到了似乎可以做到的 NotStrictEqual。

# mysql - 如何获取给定日期之间每天的行数？

> ID：419660
> 
> 赞同：1
> 
> 时间：2009-01-07T09:06:46.840
> 
> 标签：mysql

我有以下格式的表格。当我给出 2008-10-12 和 2008-10-13 之间的日期时，我需要 mysql 查询来获取每天的行数

```
姓名 | 千瓦| 千伏 | 我 | 日期 |
------+--------+------+------+-------- -+
 UPS1 | 353.50 | 空 | 空 | 2008-10-12 00:54:36 |
 UPS1 | 352.50 | 空 | 空 | 2008-10-12 01:54:36 |
 UPS1 | 351.90 | 空 | 空 | 2008-10-12 02:54:36 |
 UPS1 | 351.60 | 空 | 空 | 2008-10-12 03:54:36 |
 UPS1 | 352.20 | 空 | 空 | 2008-10-12 04:54:36 |
 UPS1 | 352.20 | 空 | 空 | 2008-10-12 05:54:36 |
 UPS1 | 351.90 | 空 | 空 | 2008-10-12 06:54:36 |
 UPS1 | 352.50 | 空 | 空 | 2008-10-12 07:54:36 |
 UPS1 | 352.50 | 空 | 空 | 2008-10-12 08:54:36 |
 UPS1 | 353.20 | 空 | 空 | 2008-10-12 09:54:36 |
 UPS1 | 353.50 | 空 | 空 | 2008-10-12 10:54:36 |
 UPS1 | 352.20 | 空 | 空 | 2008-10-12 11:54:36 |
 UPS1 | 352.50 | 空 | 空 | 2008-10-12 12:54:36 |
 UPS1 | 352.20 | 空 | 空 | 2008-10-12 13:54:36 |
 UPS1 | 353.20 | 空 | 空 | 2008-10-12 14:54:36 |
 UPS1 | 353.50 | 空 | 空 | 2008-10-12 15:54:36 |
 UPS1 | 352.90 | 空 | 空 | 2008-10-12 16:54:36 |
 UPS1 | 352.20 | 空 | 空 | 2008-10-12 17:54:36 |
 UPS1 | 352.20 | 空 | 空 | 2008-10-12 18:54:36 |
 UPS1 | 352.90 | 空 | 空 | 2008-10-12 19:54:36 |
 UPS1 | 352.20 | 空 | 空 | 2008-10-12 20:54:36 |
 UPS1 | 352.50 | 空 | 空 | 2008-10-12 21:54:36 |
 UPS1 | 352.90 | 空 | 空 | 2008-10-12 22:54:36 |
 UPS1 | 353.20 | 空 | 空 | 2008-10-12 23:54:36 |
 UPS1 | 355.80 | 空 | 空 | 2008-10-13 00:54:36 |
 UPS1 | 358.40 | 空 | 空 | 2008-10-13 01:54:36 |
 UPS1 | 358.00 | 空 | 空 | 2008-10-13 02:54:36 |
 UPS1 | 359.00 | 空 | 空 | 2008-10-13 03:54:36 |
 UPS1 | 357.70 | 空 | 空 | 2008-10-13 04:54:36 |
 UPS1 | 357.40 | 空 | 空 | 2008-10-13 05:54:36 |
 UPS1 | 357.40 | 空 | 空 | 2008-10-13 06:54:36 |
 UPS1 | 359.00 | 空 | 空 | 2008-10-13 07:54:36 |
 UPS1 | 357.10 | 空 | 空 | 2008-10-13 08:54:36 |
 UPS1 | 359.00 | 空 | 空 | 2008-10-13 09:54:36 |
 UPS1 | 357.70 | 空 | 空 | 2008-10-13 10:54:36 |
 UPS1 | 357.40 | 空 | 空 | 2008-10-13 11:54:36 |
 UPS1 | 357.40 | 空 | 空 | 2008-10-13 12:54:36 |
 UPS1 | 359.00 | 空 | 空 | 2008-10-13 13:54:36 |
 UPS1 | 357.10 | 空 | 空 | 2008-10-13 14:54:36 |
 UPS1 | 358.00 | 空 | 空 | 2008-10-13 15:54:36 |
 UPS1 | 359.30 | 空 | 空 | 2008-10-13 16:54:36 |
 UPS1 | 357.10 | 空 | 空 | 2008-10-13 17:54:36 |
 UPS1 | 358.40 | 空 | 空 | 2008-10-13 18:54:36 |
 UPS1 | 357.70 | 空 | 空 | 2008-10-13 19:54:36 |
 UPS1 | 359.00 | 空 | 空 | 2008-10-13 20:54:36 |
 UPS1 | 358.70 | 空 | 空 | 2008-10-13 21:54:36 |
 UPS1 | 358.70 | 空 | 空 | 2008-10-13 22:54:36 |
 UPS1 | 358.40 | 空 | 空 | 2008-10-13 23:54:36 |

```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-07T09:10:53.243

我已更改查询，以便日期列大小写与您在查询结果中的内容完全匹配。

```
select Date, count(Date)
from TABLE
where Date >= '2008-10-12' and Date <= '2008-10-13'
group by Date 
```

您将需要在 from 子句中更改 TABLE，但其他所有内容都应该适合您的表。

编辑：

我有一个结构相似的表，我将一个日期列更改为“日期”。以下对我有用。

```
mysql> select Date, count(Date) 
    from calendar_items 
    where date between '2008-12-12' and '2008-12-13' 
    group by Date;

+------------+-------------+
| Date       | count(Date) |
+------------+-------------+
| 2008-12-12 |          14 | 
| 2008-12-13 |           6 | 
+------------+-------------+
2 rows in set (0.00 sec)

mysql> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-07T09:15:19.053

不应该是：

select date, count(date) where date >= '2008-10-12' and date <= '2008-10-13' **group by date**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-07T13:45:31.163

我会试试这个：

```
SELECT count( * ) , date( `date` )
FROM `myTableName`
GROUP BY date( `date` ) 
```

（在 MySql 4.1 上测试）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-07T09:16:26.277

请查看每天获取记录的情况。您可以像这样使用---> SELECT something FROM tbl_name WHERE DATE_SUB(CURDATE(),INTERVAL 30 DAY) <= date_col;

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-07T09:27:45.660

关于您的语法错误：由于“日期”是 mysql 中的保留术语，您必须在查询中对其进行转义。

考虑到这一点，ewalshes 查询应该可以工作：

```
select `Date`, count(`Date`)
from TABLENAME
where `Date` between '2008-10-12' and '2008-10-13'
group by `Date` 
```

# binary - Symbian 中的二进制短信

> ID：419670
> 
> 赞同：3
> 
> 时间：2009-01-07T09:10:50.623
> 
> 标签：binary, sms, symbian

我想知道是否有人设法创建了一个用于发送二进制消息（配置 Symbian 手机）的工作代码，并且还有一些二进制数据样本。到目前为止，我发现的所有样本都无法离开发件箱或永远不会返回。

```
// Current entry is the Draft folder.
    iSmsMtm->SwitchCurrentEntryL( KMsvDraftEntryId );
    // Create a new SMS message entry as a child of the current context.
    iSmsMtm->CreateMessageL( KUidMsgTypeSMS.iUid );
    CMsvEntry& serverEntry = iSmsMtm->Entry();
    TMsvEntry entry( serverEntry.Entry() );

    /* Send Binary SMS */
    CSmsHeader &hdr = iSmsMtm->SmsHeader(); 
    CSmsMessage &msg = hdr.Message(); 
    CSmsPDU &pdu = msg.SmsPDU(); 
    CSmsUserData &userdata = pdu.UserData(); 

    // Set the DCS byte
    pdu.SetBits7To4(TSmsDataCodingScheme::ESmsDCSTextUncompressedWithNoClassInfo);
    pdu.SetAlphabet(TSmsDataCodingScheme::ESmsAlphabet8Bit);
    pdu.SetClass(ETrue, TSmsDataCodingScheme::ESmsClass2);

    char buf[]= {...}; //my binary data, 247 bytes long

    // Construct a dummy message
    HBufC8 * iMessage = HBufC8::NewL(300);

    TPtr8 TempUDHBufDesc((TUint8*)buf,247,247);
    iMessage->Des().Copy(TempUDHBufDesc);
    _LOGFENTRY1(_L("mess length %d"),iMessage->Des().Length());
    userdata.SetBodyL(*iMessage); 
    delete iMessage; 

    // Message will be sent immediately.
    entry.SetSendingState( KMsvSendStateWaiting );

    entry.iDate.UniversalTime(); // insert current time //Solution for HomeTime()
    // Set the SMS message settings for the message.
    CSmsHeader& header = iSmsMtm->SmsHeader();
    CSmsSettings* settings = CSmsSettings::NewL();
    CleanupStack::PushL( settings );

    settings->CopyL( iSmsMtm->ServiceSettings() ); // restore settings
    settings->SetDelivery( ESmsDeliveryImmediately ); // to be delivered immediately
    settings->SetDeliveryReport(EFalse);
    settings->SetCharacterSet(TSmsDataCodingScheme::ESmsAlphabet8Bit); // IMPORTANT! For sending binary SMS
    header.SetSmsSettingsL( *settings ); // new settings

    // Let's check if there is a service center address.
    if ( header.Message().ServiceCenterAddress().Length() == 0 )
    {
        // No, there isn't. We assume there is at least one service center
        // number set and use the default service center number.
        CSmsSettings* serviceSettings = &( iSmsMtm->ServiceSettings() );
        // Check if number of service center addresses in the list is null.
        if ( !serviceSettings->ServiceCenterCount() )
        {        _LOGENTRY("No SC");
            return ; // quit creating the message
        }
        else
        {
            CSmsNumber* smsCenter= CSmsNumber::NewL();
            CleanupStack::PushL(smsCenter);
            smsCenter->SetAddressL((serviceSettings->GetServiceCenter( serviceSettings->DefaultServiceCenter())).Address());
            header.Message().SetServiceCenterAddressL( smsCenter->Address() );
            CleanupStack::PopAndDestroy(smsCenter);
        }
    }

    CleanupStack::PopAndDestroy( settings );

    // Recipient number is displayed also as the recipient alias.
    entry.iDetails.Set( _L("+3725038xxx") );
    iSmsMtm->AddAddresseeL( _L("+3725038xxx") , entry.iDetails );

    // Validate message.
    if ( !ValidateL() )
    {    _LOGENTRY("Not valid");
        return ;
    }

    entry.SetVisible( ETrue ); // set message as visible
    entry.SetInPreparation( EFalse ); // set together with the visibility flag
    serverEntry.ChangeL( entry ); // commit changes 
    iSmsMtm->SaveMessageL(); // save message

    TMsvSelectionOrdering selection;
    CMsvEntry* parentEntry = CMsvEntry::NewL( iSmsMtm->Session(), KMsvDraftEntryId, selection );
    CleanupStack::PushL( parentEntry );

    // Move message to Outbox.
    iOperation =parentEntry->MoveL( entry.Id(), KMsvGlobalOutBoxIndexEntryId, iStatus );

    CleanupStack::PopAndDestroy( parentEntry );

    iState = EWaitingForMoving;
    SetActive(); 
```

大多数情况下，我不确定 port 和 class 的正确值。一些正确的二进制字符串也可以用于测试。现在我不确定代码是坏的还是数据。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-07T12:34:47.390

使用 JSR120 规范和无线工具包。它们包含肯定会工作的 java 示例代码。

这些是使用 Symbian C++ 中的 RSocket 对象直接实现的。

如果你真的想用 C++ 做，最简单的方法就是把你的 TMsvEntry 复制到 sms 服务的入口。在上面的代码中，这意味着使用“iSmsMtm->ServiceId()”而不是“KMsvGlobalOutBoxIndexEntryId”。此外，只需将消息复制到服务，但在成功发送后将其移动到发件箱。

无耻插件：[http](http://www.quickrecipesonsymbianos.com) ://www.quickrecipesonsymbianos.com将包含一个解释 Symbian C++ 消息传递 API 的简单且可重用的示例代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-08-26T08:40:29.290

有效的解决方案是使用 RComm 和“DATAPORT::1”使用 AT 命令（如使用调制解调器）发送二进制 SMS。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-15T13:42:18.537

如果您想静默发送 SMS（并避免使用消息 API 的复杂性），您应该通过以下方式发送它`RSocket`：[http ://wiki.forum.nokia.com/index.php/How_to_send_an_SMS_using_sockets](http://wiki.forum.nokia.com/index.php/How_to_send_an_SMS_using_sockets)

根据您的需要，这可能比使用消息传递 API 更合适。

# apache - 重定位apache的配置文件

> ID：419675
> 
> 赞同：1
> 
> 时间：2009-01-07T09:13:30.307
> 
> 标签：apache, apache-config

是否有机会为 apache 的配置文件使用不同的位置（在 Windows 上）？除了必须自己编译并设置正确的#define HTTPD_ROOT 值之外。

谢谢雷兹纳

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-07T09:21:10.540

这可以通过`-f`在 Windows 上将 apache 安装为服务时指定选项来完成。

该`-f`选项接受配置文件的位置。例如，如果您安装服务的命令是

```
httpd.exe -k install -n "MyServiceName"
```

使用您的配置文件添加`-f "c:\files\my.conf"`, 如下所示：

```
httpd.exe -k install -n "MyServiceName" -f "c:\files\my.conf"
```

有关更多信息，请参阅[Apache 手册](http://httpd.apache.org/docs/2.2/platform/windows.html#winsvc)。

# quicktime - 如何存储 QuickTime 电影的“原始拍摄日期”元数据项？

> ID：419684
> 
> 赞同：1
> 
> 时间：2009-01-07T09:18:21.593
> 
> 标签：quicktime

Quicktime 具有丰富的元数据 API，允许将各种任意数据存储在 .mov 文件（或其流之一）中。我正在寻找用于存储视频剪辑拍摄日期的标准键名和值格式，类似于 EXIF 的 DateTimeOriginal。

苹果网站上的以下讨论使苹果似乎没有定义一个，因为他们似乎并不觉得这很重要。 [http://discussions.apple.com/message.jspa?messageID=6267622](http://discussions.apple.com/message.jspa?messageID=6267622)

这与[如何从我的家庭电影文件中获取原始捕获时间戳有关:: AVI 和 MPG4？](https://stackoverflow.com/questions/213015/)（处理 .mp4 和 .avi）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-15T07:54:55.023

恐怕这种元数据没有标准密钥。您可能会尝试使用合理的标准密钥，例如

kQTMetaDataCommonKey 信息，

kQTMetaDataCommonKeyDescription 或

kQTMetaDataCommonKeyProducer

尽管这不是“标准”（即很可能只能由您的应用程序正确处理）。

关于使用此示例代码和问答文章的值格式的问题（尽管它不完全合适）可能会让您走上正确的轨道：

[http://developer.apple.com/qa/qa2007/qa1515.html](http://developer.apple.com/qa/qa2007/qa1515.html) [http://developer.apple.com/samplecode/QTMetaData/listing1.html](http://developer.apple.com/samplecode/QTMetaData/listing1.html)

# eclipse - Eclipse 子流程（通过“运行”菜单启动）出现在哪里？

> ID：419695
> 
> 赞同：15
> 
> 时间：2009-01-07T09:22:33.893
> 
> 标签：eclipse, eclipse-3.4

我正在使用 Eclipse 3.4.1，迈出了第一步。当我运行我的项目（服务器进程）时，会打开一个控制台。但是由于某些原因，一段时间后我再也找不到它了（即使进程仍在运行）。我想找到它能够看到它的输出和/或杀死它。在 Eclipse 中是否有可以找到所有正在运行的子进程的地方？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-01-07T09:25:58.237

控制台面板中有一个看起来像监视器的小按钮。它列出了所有打开的控制台。我很惭愧在发布问题之前我自己没有找到它，但也许它对某人有用。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-07T09:27:00.373

如果您在谈论“eclipse 控制台”，则只有一个“控制台视图”，但有多个控制台实例。

您可以通过单击控制台视图左侧的第二个按钮（看起来像监视器的那个）来浏览不同的控制台

您的控制台可能会“消失”，因为主控制台 (stdout) 进程中显示了另一条消息，而您的服务器仍与其他控制台实例一起运行。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-07-17T17:56:11.577

如果您要处理大量进程，一种更简单的方法是使用调试视图（注意：不是调试透视图，只是调试“视图”或“窗口”）。

它显示了正在运行的进程列表，包括使用 Run 而不是 Debug 启动的进程。在 Debug 视图中选择一个进程将打开相应的控制台，反之亦然。

我将调试视图放在控制台视图上方，并将其调整为仅显示几行。

# python - 自动上课时间表优化爬虫？

> ID：419698
> 
> 赞同：0
> 
> 时间：2009-01-07T09:24:20.673
> 
> 标签：python, screen-scraping, scheduling

**总体规划**

获取我的班级信息以自动优化和选择我的大学课程时间表

整体算法

1.  使用其 Enterprise Sign On Engine 登录名登录网站
2.  查找我当前的学期及其相关科目（预设置）
3.  导航到右侧页面并获取每个相关主题的数据（讲座、实践和研讨会时间）
4.  剥离无用信息的数据
5.  将彼此接近的班级排名较高，随机日期的班级排名较低
6.  解决最佳时间表解决方案
7.  给我输出一份BEST CASE信息的详细清单
8.  向我输出可能的类信息的详细列表（例如，有些可能是完整的）
9.  获取程序以自动选择最佳课程
10.  继续检查，看看我们是否可以达到 7。

6 详细 获取所有课程，以讲座为重点，排名最高（每个科目只有一个），并尝试围绕该课程安排课程。

**问题**

任何人都可以向我提供可能与希望用 python 编写的类似内容的链接吗？关于 6.：您建议将这些信息存储在什么数据结构中？每个uniclass对象的链表在哪里？我应该将所有信息写入文本文件吗？

我正在考虑将 uniclass 设置为以下属性：

*   学科
*   秩
*   时间
*   类型
*   老师

我在 Python 方面几乎没有经验，并认为这将是一个很好的学习项目，可以尝试完成。感谢您提供的任何帮助和链接，以帮助我开始，**打开编辑以适当地标记或任何必要的**（不知道这属于编程和 python 之外的什么？）

编辑：无法真正获得我想要的这个 SO 帖子的正确格式><

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-07T10:29:08.360

取决于您计划在#6 上走多远，以及数据集有多大，这可能不是微不足道的；它对我来说肯定带有 NP-hard 全局优化的味道......

尽管如此，如果您谈论的是数十个（而不是数百个）节点，那么一个相当愚蠢的算法应该可以提供足够好的性能。

所以，你有两个限制：

1.  按分数对班级进行总排序；这是灵活的。
2.  阶级冲突；这不灵活。

我所说的灵活是指您*可以*去更多间隔的课程（分数较低），但您*不能*同时上两个课程。有趣的是，得分和冲突之间可能存在正相关关系。得分较高的班级更有可能发生冲突。

我第一次通过算法：

```
selected_classes = []
classes = sorted(classes, key=lambda c: c.score)
for clas in classes:
    if not clas.clashes_with(selected_classes):
        selected_classes.append(clas) 
```

如果课程长度不均匀、从奇怪的时间开始等等，解决冲突可能会很尴尬。将开始和结束时间映射为时间“块”的简化表示（每 15 分钟/30 分钟或任何您需要的时间）将使查找不同类的开始和结束之间的重叠变得更容易。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-07T09:39:56.103

[BeautifulSoup](http://www.crummy.com/software/BeautifulSoup/)在这里被提到过几次，例如[get-list-of-xml-attribute-values-in-python](https://stackoverflow.com/questions/87317/get-list-of-xml-attribute-values-in-python)。

> Beautiful Soup 是一个 Python HTML/XML 解析器，专为屏幕抓取等快速周转项目而设计。三个功能使其功能强大：
> 
> 1.  如果你给它错误的标记，Beautiful Soup 不会窒息。它会生成一个解析树，其意义与您的原始文档大致相同。这通常足以收集您需要的数据并逃跑。
> 2.  Beautiful Soup 提供了一些用于导航、搜索和修改解析树的简单方法和 Pythonic 习惯用法：用于剖析文档和提取所需内容的工具包。您不必为每个应用程序创建自定义解析器。
> 3.  Beautiful Soup 自动将传入文档转换为 Unicode，将传出文档自动转换为 UTF-8。您不必考虑编码，除非文档未指定编码并且 Beautiful Soup 无法自动检测编码。然后你只需要指定原始编码。
> 
> Beautiful Soup 解析你给它的任何东西，并为你做树遍历的东西。您可以告诉它“查找所有链接”，或“查找类 externalLink 的所有链接”，或“查找所有 url 匹配“foo.com”的链接，或“查找带有粗体文本的表格标题，然后给出我那条短信。”
> 
> 曾经锁定在设计不佳的网站中的宝贵数据现在触手可及。使用 Beautiful Soup 需要数小时才能完成的项目只需几分钟。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-07T12:09:58.797

这里有太多的问题。

请将其分解为主题领域，并针对每个主题提出具体问题。请专注于其中一个有具体问题的问题。请定义您的术语：“最佳”并不意味着没有一些特定的衡量标准来优化。

这是我认为我在您的主题列表中看到的内容。

1.  抓取 HTML

    1 使用其企业登录引擎登录名登录网站

    2 查找我当前的学期及其相关科目（预设置）

    3 导航到右侧页面并获取每个相关主题的数据（讲座、实践和研讨会时间）

    4 剥离无用信息的数据

2.  一些算法基于“彼此更接近”来“排名”以寻找“最佳时间”。由于这些术语未定义，因此几乎不可能对此提供任何帮助。

    5 将彼此接近的班级排名较高，随机日期的班级排名较低

    6 解决最佳时间表解决方案

3.  输出一些东西。

    7 给我输出一份BEST CASE信息的详细列表

    8 向我输出可能的类信息的详细列表（例如，有些可能是完整的）

4.  优化某些东西，寻找“最佳”。另一个无法定义的术语。

    9 让程序自动选择最好的课程

    10 继续检查，看看我们是否能达到 7。

顺便说一句，Python 有“[列表](http://docs.python.org/tutorial/introduction.html#lists)”。他们是否“链接”并没有真正参与其中。

# c# - 如何为方法重载创建一个 cref C# 中的标记？

> ID：419702
> 
> 赞同：24
> 
> 时间：2009-01-07T09:26:26.707
> 
> 标签：c#, xml-documentation

我在 MSDN 链接中看到，例如“CompareOrdinal Overloads”。如何在 C# 中编写这样的链接？

我试过：

```
<seealso cref="MyMethod">MyMethod Overloads</seealso> 
```

但是编译器给了我一个警告，说它是具有其他重载的方法的模棱两可的引用。

（初学者问题：我真的需要编写这个标签来链接到重载，还是它是由文档处理器自动生成的？）

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-01-07T09:29:56.013

要针对*特定*​​成员，我相信您只需匹配签名：

```
/// <seealso cref="Foo(int)"/>
static void Foo() { }
/// <seealso cref="Foo()"/>
/// <seealso cref="Foo(float)"/> <------ complains
static void Foo(int a) { } 
```

老实说，我不确定如何生成“所有重载”链接；我假设任何明智的生成器都会自动执行此操作。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-01-07T18:08:31.000

使用 Sandcastle 很简单：

```
<seealso cref="overloads:FullyQualifiedMyMethod">MyMethod Overloads</seealso> 
```

fullyQualifiedMyMethod 是您需要达到重载的完整路径，包括命名空间和类，即：System.Linq.Enumerable.Sum

但是 VB 编译器会发出警告，说该属性无法解析，可以忽略。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-07T10:00:00.557

XML 文档没有办法引用方法的所有重载。

最流行的 C# 项目文档生成器是 Sandcastle。如有必要，它将自动创建指向重载列表页面的链接。因此，在成员列表页面中，重载方法的名称只会出现一次，单击它将导航到该方法的重载列表页面，然后从那里转到特定的重载。

在 Xml 文档中放置到重载列表页面的链接需要对正在使用的外部工具有深入的了解，这可能不是一个好主意。

如果您真的必须拥有它，那么也许一种方法是使用具有特定格式 ID 的锚点。大多数文档生成器都提供了一些对生成的文件进行预处理或后处理的神秘方法，并且应该让您有机会挑选出这些锚点并为它们提供适当的 href。

OTH，它可能比它的价值更麻烦；）

# c# - 一周中天数的系统常数 (7)

> ID：419707
> 
> 赞同：14
> 
> 时间：2009-01-07T09:29:07.233
> 
> 标签：c#, .net, datetime, date

任何人都可以在 .NET 框架中找到定义一周中的天数 (7) 的常量吗？

```
DateTime.DaysInAWeek // Something like this??? 
```

当然，我可以定义我自己的，但如果它已经在某个地方，我宁愿不要。

## 更新：

我正在寻找这个，因为我需要允许用户从 DropDownList 的列表中选择一周（按日期，而不是周数）。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-01-07T09:36:00.247

您可能会使用[System.Globalization.DateTimeFormatInfo.CurrentInfo.DayNames](http://msdn.microsoft.com/en-us/library/system.globalization.datetimeformatinfo.daynames.aspx) .Length。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-01-07T09:33:24.027

我认为对这个进行硬编码是可以的。我不认为它会很快改变。

*编辑：我取决于你想在哪里使用这个常量。在一些与日历相关的算法中，7 的含义是显而易见的。另一方面，有时命名为常量会使代码更具可读性。*

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-07T09:35:32.650

试试这个：

```
Enum.GetNames(System.DayOfWeek).Length 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-07T09:45:52.287

如果您查看 Calendar.AddWeeks 的 IL 代码，您会发现 Microsoft 本身在代码中使用了硬编码的 7。

[转子源](http://www.123aspx.com/Rotor/RotorSrc.aspx?rot=40097)也使用硬编码的 7。

不过，我建议使用 const。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-07T14:54:25.593

我不确定您到底在寻找什么，但您可以尝试[DateHelper (CODE.MSDN)](http://code.msdn.microsoft.com/datehelper/)。这是我为典型的约会需求而整理的一个库。您也许可以使用 week 方法或 List 方法。[方法列表](http://code.msdn.microsoft.com/datehelper/Wiki/View.aspx?title=Method%20List&referringTitle=Home)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2021-03-23T17:59:11.877

我用这个：

```
public static readonly int WeekNumberOfDays = Enum.GetNames(typeof(DayOfWeek)).Length; 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-07T09:30:51.333

我不相信有一个。TimeSpan 定义了每毫秒/秒/分钟/小时/天的刻度数的常量，但在一周的级别上没有定义。

我在标准库中对包含单词“Week”的符号（方法/常量/字段/等）进行了查询。什么都没有回来。仅供参考，我使用 ReSharper 运行此查询。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-07T09:37:36.857

[`GregorianCalendar`](http://msdn.microsoft.com/en-us/library/system.globalization.gregoriancalendar(v=vs.110).aspx)有[`AddWeeks(1)`](http://msdn.microsoft.com/en-us/library/system.globalization.calendar.addweeks(v=vs.110).aspx)这将使日期增加 7 天。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-07T10:39:53.363

你是指日历周还是普通周？

显然，有些日历周可能短于 7 天。一年中的最后一个日历周通常较短，根据您对日历周的定义，第一周也可能较短。

在这种情况下，恐怕您将不得不推出自己的周长功能。上课真的不难`DateTime`，我以前做过，如果您需要更多帮助，请告诉我。

# cocoa-touch - 如何在 UIImageView 中平移图像？

> ID：419710
> 
> 赞同：26
> 
> 时间：2009-01-07T09:29:28.793
> 
> 标签：cocoa-touch, core-animation

我有一个`UIImageView`显示的图像比实际更宽更高`UIImageView`。我想使用动画在视图中平移图像（以便平移美观且平滑）。

在我看来，我应该能够调整 的`bounds.origin`，并且图像应该移动（因为图像应该以它作为**其**`UIImageView`原点在视图内绘制，对吗？）但这似乎不起作用。更改，但图像绘制在相同的位置。**`bounds.origin`**

 **几乎起作用的是改变`contentsRect`视图层的。但这从一个单位正方形开始，即使图像的可视区域不是整个图像。所以我不确定如何检测到图像的远边缘被拉入可视区域（我需要避免，因为它通过将边缘拉伸到无穷大来显示，看起来，嗯，低于标准杆）。

我的视图当前通过 Interface Builder`contentsGravity`设置为`kCAGravityTopLeft`，如果这会有所不同（它会导致图像移动吗？）。不过，似乎没有其他选择更好。

更新：要清楚，我想在视图**内**移动图像，同时将视图保持在同一位置。

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2009-01-07T19:11:11.723

我强烈建议您将您的文件包含`UIImageView`在`UIScrollView`. `UIImageView`显示完整图像，并将 contentSize 设置为与您的尺寸`UIScrollView`相同。`UIImageView's`您`window`进入图像将是 的大小`UIScrollView`，并且通过使用`scrollRectToVisible:animated:`您可以以动画方式平移到图像上的特定区域。

如果不希望出现滚动条，可以将`showsHorizontalScrollIndicator`和`showsVerticalScrollIndicator`属性设置为`NO`。

`UIScrollView`还提供捏缩放功能，这可能对您有用，也可能没用。

* * *

## 回答 #2

> 赞同：40
> 
> 时间：2009-01-08T06:01:23.580

布拉德·拉尔森（Brad Larson）建议我把`UIImageView`里面放一个`UIScrollView`.

最后，我将 a 的`UIImageView`内部放入`UIScrollView`，并将 scrollView`contentSize` **和**'的`imageView`边界设置为与 UIImage 中的图像相同的大小：

```
UIImage* image = imageView.image;
imageView.bounds = CGRectMake(0, 0, image.size.width, image.size.height);
scrollView.contentSize = image.size; 
```

然后，我可以为 scrollView 设置动画`contentOffset`以实现漂亮的平移效果：

```
[UIView beginAnimations:@"pan" context:nil];
[UIView setAnimationDuration:animationDuration];
scrollView.contentOffset = newRect.origin;
[UIView commitAnimations]; 
```

在我的特殊情况下，我正在平移到图像中的随机空间。为了找到一个合适的矩形平移**和**一个合适的持续时间来获得一个好的恒定速度，我使用以下内容：

```
UIImage* image = imageView.image;

float xNewOrigin = [TCBRandom randomIntLessThan:image.size.width - scrollView.bounds.size.width];
float yNewOrigin = [TCBRandom randomIntLessThan:image.size.height - scrollView.bounds.size.height];

CGRect oldRect = scrollView.bounds;
CGRect newRect = CGRectMake(
    xNewOrigin,
    yNewOrigin, 
    scrollView.bounds.size.width,
    scrollView.bounds.size.height);

float xDistance = fabs(xNewOrigin - oldRect.origin.x);
float yDistance = fabs(yNewOrigin - oldRect.origin.y);
float hDistance = sqrtf(powf(xDistance, 2) + powf(yDistance, 2));
float hDistanceInPixels = hDistance;

float animationDuration = hDistanceInPixels / speedInPixelsPerSecond; 
```

我正在使用`speedInPixelsPerSecond`of `10.0f`，但其他应用程序可能想要使用不同的值。

# visual-studio - 如何在批处理文件中从 Visual Studio 调用 Nunit

> ID：419714
> 
> 赞同：2
> 
> 时间：2009-01-07T09:30:58.947
> 
> 标签：visual-studio, nunit, batch-file

我已将我的 Visual Studio 设置为将 Nunit 作为外部程序启动，以运行在模块中编写的所有测试。

现在我要做的是创建一个将调用 Myproj.exe 的批处理文件。我期望它会运行 Nunit，因为我已将其设置为运行外部程序并在 nunit.exe 中执行我的所有测试，但是当我运行该批处理文件时，它会从 Visual Studio 开始运行，而不是打开 NUnit。

任何人都可以给我一个明确的想法来完成它吗？

我太困了。

* * *

现在我正在尝试在 shell 中运行以下命令

nunit-x86.exe 你能告诉我应该如何在这里加载我的visualbasic项目文件（exe），然后从这里运行所有测试，因为无法执行以下命令

```
nunit nunit.tests.vbproj /config:release 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-15T06:08:01.183

您可以在每次调试“NUnit 测试”时启动 NUnit。

您可以通过[这种](http://thespoke.net/forums/923583/ShowPost.aspx)方式在 Visual Studio Express 中附加调试器。如果您使用 VS 的“完整版”，请这样做：

> 请注意，如果您使用的是 Visual Studio 2005 的完整版本而不是 express 版本，您可以通过打开项目的属性来执行此操作，并在“调试”选项卡中选择“启动外部程序”：并导航到 NUnit 可执行文件，然后设置 YourCompanyname .YourProject.Test.dll 作为命令行参数。

我从[本教程](http://www.taumuon.co.uk/jabuka/Tutorial2/Tutorial2_v1.pdf)（第 4/5 页）中得到了这些想法并喜欢它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T05:10:17.783

您还可以在 Visual Studio 中每次成功构建后使用构建后事件运行 NUnit。

在 VS2005 中，右键单击包含您的测试的项目并选择属性。然后在 Build Events 选项卡上，在“Post-build event command line”中，将 this* 用于使用控制台：

```
nunit-console /xml:$(ProjectName).xml $(TargetPath) 
```

或者这个使用 GUI::

```
nunit $(TargetPath) /run 
```

在“运行构建后事件：”中，保留默认值：“成功构建”

如果您使用 GUI，请知道在您关闭 GUI 应用程序之前，您的构建似乎已挂起。

*注意：nunit 控制台[命令行文档](http://nunit.com/index.php?p=consoleCommandLine&r=2.4.8)说“默认情况下，nunit-console 程序不会添加到您的路径中。”

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-07T09:34:40.933

您可以使用命令行将 nunit.exe 壳装到您的程序集中运行测试。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-10-07T10:35:07.540

您可以使用 Visual Studio 中的外部工具功能加载 nUnit.exe（用于命令行执行的 nUnit-Console.exe）。通过外部工具功能添加命令后（[如本博客所述](http://qtp-automate.blogspot.co.uk/2013/10/how-to-execute-invoke-nunit-from-visual.html)），您可以将其用于任何项目以执行测试。（其他是通过项目属性添加，但需要为每个项目完成）。同样在参数中，您可以传递 /include 或 /exclude 以包含或排除测试类别。

这种方法的优点是您不必担心提供 DLL 文件的路径，它适用于您所在的任何项目，只需单击几下即可执行

# html - 撇号的 HTML 代码

> ID：419718
> 
> 赞同：236
> 
> 时间：2009-01-07T09:33:54.337
> 
> 标签：html, ascii

看起来很简单，但我在网上找不到任何相关的东西。

撇号的正确 HTML 代码是什么？是`&#8217;`吗？

* * *

## 回答 #1

> 赞同：315
> 
> 时间：2009-01-07T09:36:33.660

* * *

## 回答 #2

> 赞同：106
> 
> 时间：2009-01-07T09:45:42.223

A List Apart has a nice [reference on characters and typography in HTML](http://alistapart.com/article/emen). According to that article, the correct HTML entity for the apostrophe is `&#8217;`. Example use: ’ .

* * *

## 回答 #3

> 赞同：41
> 
> 时间：2009-01-07T09:35:51.150

是`&apos;`。

正如 msanders 所指出的，这实际上是 XML 和 XHTML，但没有在 HTML4 中定义，所以我想`&#39;`在这种情况下使用。我站得更正了。

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2009-01-07T09:37:13.723

* * *

## 回答 #5

> 赞同：19
> 
> 时间：2014-11-17T17:16:52.297

A standard-compliant, easy-to-remember set of html quotes, starting with the right single-quote which is normally used as an apostrophe:

*   right single-quote — `&rsquo;` — ’
*   left single-quote — `&lsquo;` — ‘
*   right double-quote — `&rdquo;` — ”
*   left double-quote — `&ldquo;` — “

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2009-01-07T13:05:47.157

Firstly, it would appear that &apos; should be avoided - [The curse of &apos;](http://fishbowl.pastiche.org/2003/07/01/the_curse_of_apos/)

Secondly, if there is ever any chance that you're going to generate markup to be returned via AJAX calls, you should avoid the entity names (As not all of the HTML entities are valid in XML) and use the &#XXXX; syntax instead.

Failure to do so may result in the markup being considered as invalid XML.

The entity that is most likely to be affected by this is &nbsp;, which should be replaced by &#160;

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2009-01-07T09:35:57.093

这是 HTML Ascii 代码的一个很好的参考：

[http://www.ascii.cl/htmlcodes.htm](http://www.ascii.cl/htmlcodes.htm)

您正在寻找的代码是： '

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2013-02-15T12:46:46.007

Note that `&apos;` IS defined in HTML5, so for modern websites, I would advise using `&apos;` as it is much more readable than `&#39;`

Check: [http://www.w3.org/TR/html5/syntax.html#named-character-references](http://www.w3.org/TR/html5/syntax.html#named-character-references)

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2017-05-09T14:18:18.847

Even though `&apos;` reads nicer than `&#39;` and it's a shame not to use it, as a fail-safe, use `&#39;`.

`&apos;` is a valid **HTML 5** entity, however it is not a valid **HTML 4** entity.

Unless `<!DOCTYPE html>` is at the top of your HTML document, use `&#39;`

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-01-07T09:37:18.357

`&#39;` in decimal.

`%27` in hex.

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2013-12-01T14:01:48.193

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2014-09-28T19:07:07.710

I've found [**FileFormat.info's Unicode Character Search**](http://www.fileformat.info/info/unicode/char/search.htm) to be most helpful in finding exact character codes.

Entering simply `'` (the character to the left of the `return` key on my US Mac keyboard) into their search yields [several results of various curls and languages](http://www.fileformat.info/info/unicode/char/search.htm?q=%27&preview=entity).

I would presume the original question was asking for the typographically correct [U+02BC `ʼ`](http://www.fileformat.info/info/unicode/char/02bc/index.htm), rather than the typewriter fascimile [U+0027 `'`](http://www.fileformat.info/info/unicode/char/0027/index.htm).

The W3C recommends hex codes for HTML entities (see below). For U+02BC that would be `&#x2bc;`, rather than `&#x27;` for U+0027.

[http://www.w3.org/International/questions/qa-escapes](http://www.w3.org/International/questions/qa-escapes)

> **Using character escapes in markup and CSS**
> 
> **Hex vs. decimal.** Typically when the Unicode Standard refers to or lists characters it does so using a hexadecimal value. … Given the prevalence of this convention, it is often useful, though not required, to use hexadecimal numeric values in escapes rather than decimal values…</p>

[http://www.w3.org/TR/html4/charset.html](http://www.w3.org/TR/html4/charset.html)

> **5 HTML Document Representation** … **5.4 Undisplayable characters**
> 
> …If missing characters are presented using their numeric representation, use the hexadecimal (not decimal) form, since this is the form used in character set standards.

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2015-02-06T09:19:23.947

Just a one more link with nicely maintained collection [Html Entities](http://dev.w3.org/html5/html-author/charref)

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2017-03-20T16:45:52.827

Sorry if this offends anyone, but there is a reasonable article on [Ted Clancy's blog](https://tedclancy.wordpress.com/2015/06/03/which-unicode-character-should-represent-the-english-apostrophe-and-why-the-unicode-committee-is-very-wrong/) that argues against the Unicode committee's recommendation to use &#8217; (RIGHT SINGLE QUOTATION MARK) and proposes using U+02BC (MODIFIER LETTER APOSTROPHE) (aka &#700; or &#x2bc;) instead.

In a nutshell, the article argues that:

*   A punctuation mark (such as a quotation mark) normally separates words and phrases, while the sides of a contraction really can't be separated and still make sense.
*   Using a modifier allows one to select a contraction with the regular expression \w+
*   It's easier to parse quotes embedded in text if there aren't quotation marks also appearing in contractions

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2009-01-07T09:38:36.747

As far as I know it is `&#39;` but it seems yours works as well

See [http://w3schools.com/tags/ref_ascii.asp](http://w3schools.com/tags/ref_ascii.asp)

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2009-01-07T09:40:51.530

Use `&apos;` for a straight apostrophe. This tends to be more readable than the numeric `&#39;` (if others are ever likely to read the HTML directly).

Edit: msanders points out that `&apos;` isn't valid HTML4, which I didn't know, so follow most other answers and use `&#39;`.

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2014-04-12T16:34:25.237

You can try `&#x0027;` as seen in [http://unicodinator.com/#0027](http://unicodinator.com/#0027)

# version-control - 你有任何提交政策吗？

> ID：419723
> 
> 赞同：6
> 
> 时间：2009-01-07T09:35:56.597
> 
> 标签：version-control, policy

我的老板昨天宣布了一项新的提交政策，用于签入存储库。该策略对头部/主干和分支的提交有效。
提交消息必须包含以下项目：

*   原因（错误 ID、项目 ID 或非功能更改）
*   审稿人姓名

提交之后，我们还必须在我们的 CMS 中创建一个更改博客条目。

我不是这个提交政策的忠实拥护者，因为当我在非生产性分支中做新的或实验性的东西时，我通常不需要审阅者。

您是否有任何必须遵循的提交政策？

我认为仅由于错误报告而更改生产分支是一个好主意，但对开发分支的提交应该不那么严格。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-07T09:44:12.477

**尽早提交并经常提交。**

我们实际上使用 /trunk 作为开发和标签来分支不同的版本。只有结构性的侵入性更改进入 /branches。

我们积极使用标签进行生产和验收发布，因此我们可以轻松地回到过去。在主干中提交的任何内容都应该只有一条消息，描述提交更改或添加的内容。

我不太喜欢使用消息空间与错误 ID 链接，它仍然需要查找 ID，在这种情况下，您也可以在错误跟踪软件中查找并关闭它，这对我来说是关于同样的努力。

并不是说我不喜欢任何 svn 集成： - 我们使用更多的自动化 nant 脚本来制作在 /tags 中分支它们的版本 - svn props 实际上存储我们的版本号：p。- 用于电子邮件通知和消息记录的挂钩脚本（非常适合复制粘贴发行说明）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-07T09:57:52.683

我们有许多策略，这些策略是通过 Visual Studio 的内部插件强制执行的。我们检查代码是否编译并且单元测试是否已成功运行。目前，我们还检查代码覆盖率并对没有足够测试的代码发出警告。我们还进行各种一致性检查并验证我们的变更管理系统中是否存在适当的任务，以便为所有变更提供可追溯性。

工具支持的优势是巨大的，因为人们并不真正尊重这些政策，但显然存在一个缺点，而且这些检查需要时间来运行。然而，对于许多开发人员来说，如果没有适当的工具支持，就很难执行标准。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-07T09:43:37.673

由于您提到的原因，审稿人似乎毫无意义，因为并非所有内容都需要他人审阅。

在过去，我们唯一的提交策略（我曾经工作过的地方）是包含一个注释，说明你改变了什么以及为什么，但这比其他任何事情都更符合常识。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-07T10:00:10.213

一个常见的提交策略是将错误 ID 关联到主干的提交作为理由。有时，版本控制和错误跟踪系统被配置为强制执行此策略。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-07T12:19:12.523

我们的提交策略听起来有点像你的，只是我们不会在任务分支上强制执行（任务分支就像开发人员的试验沙箱）。

我们的提交评论必须包含变更控制 ID（新功能、增强功能）或问题 ID（错误修复）。您还必须简要说明您进行此更改的*原因；*版本控制跟踪谁、什么、何时和何地。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-07T10:04:29.173

我的提交消息包括一个简短的描述我在类中实现或更改的内容。

我在新代码上方的注释中添加了错误编号和其他描述。当我们将更改合并到标记的分支中时，我们放置的提交消息中的 ID。

每天晚上，自动构建都会检查不同的功能和产品，以确保代码库是稳定的。

但最后我认为你不能对新的或改变的类有太多的描述，但在提交之前你必须做太多的策略。审阅者的名字是我不会放在提交消息中的。

想想你有时不得不理解你在 2 年前实现的代码。然后你会很高兴提交消息不像“调试后更新”。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-08T09:49:01.513

我们为每个已发布的主要版本的软件都有分支，这些版本仍然受到积极支持。检查这些分支中的任何一个都需要一个错误 ID - 这是由[scmbug](http://www.mkgnu.net/?q=scmbug)强制执行的，它不仅会检查注释是否以错误 ID 为前缀，还会在错误数据库中查找此错误，确保将其分配给提交者，并可能检查其他标准（例如，“分支中的修复”字段是被提交到的分支）。

其中一种产品更有可能以令人尴尬的方式失败，并且签入这不仅需要错误 ID，还需要代码审查。但是，代码审查的标准是在我们的错误数据库中处理的——我们为此有自定义字段，并且在审查之前无法接受和关闭错误。对我来说，这从概念层面上是有效的——最好检查那些被认为可以在未经审查的存储库中工作的代码，然后重新打开错误并在必要时对其进行更改，而不是推迟提交，直到你**确定**它已经准备好释放。

除此之外，没有明确的主干策略（当然，在不破坏构建的情况下经常签入的一般原则，包括良好的描述性提交消息，原子地签入工作单元仍然适用）。

# php - PHP - 保护 URL 中传递的参数

> ID：419738
> 
> 赞同：0
> 
> 时间：2009-01-07T09:38:50.177
> 
> 标签：php, security, validation, cakephp

我有一个应用程序根据部分 URL 做出决定：

```
 if ( isset($this->params['url']['url']) ) {
    $url = $this->params['url']['url'];
    $url = explode('/',$url);
    $id = $this->Provider->getProviderID($url[0]);

    $this->providerName = $url[0]; //set the provider name

    return $id;

    } 
```

这恰好在蛋糕应用程序中，因此 $this->params['url'] 包含 URL 元素。然后我使用 URL 的元素来决定在我的应用程序的其余部分中使用哪些数据。我的问题是...

什么是保护这个输入的最好方法，这样人们就不能传入任何讨厌的东西？

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-07T10:00:52.567

什么是有效的提供者名称？测试 URL 参数是否为 1，否则拒绝。

希望您知道，绝对没有办法阻止用户提交任何内容，包括他们不应该使用的提供者名称。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-07T13:46:24.157

我会重申卡斯滕的评论：定义“任何讨厌的东西”

你期望参数是什么？如果您希望它是一个 URL，请使用正则表达式来验证 URL。如果您期望整数，请将其转换为整数。浮点数、布尔值等也是如此。

这些 PHP 函数可能会有所帮助： www.php.net/strip_tags www.php.net/ctype_alpha

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-07T16:52:17.353

该参数将是一个providername - 字母数字字符串。我认为答案基本上是结合使用 ctype_alpha() 并根据其他应用程序逻辑检查提供程序名称是否有效。

感谢您的回复

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-07T20:33:40.357

这里的其他评论是正确的，在 AppController 的 beforeFilter 中针对您的数据库中的提供者验证提供者。

但是，如果所有 URL 都应以提供程序字符串为前缀，那么您将通过查看 $this->params['url'] 以错误的方式从 URL 中提取它。

这类问题正是路由器类所要解决的问题，它能够将参数传递给动作。查看说明书[http://book.cakephp.org/view/46/Routes-Configuration](http://book.cakephp.org/view/46/Routes-Configuration)中的手册页。您可以尝试以下方法：

```
Router::connect('/:provider/:controller/:action'); 
```

您还将在手册中看到通过正则表达式验证路由本身中的提供者参数的能力 - 如果您有一小部分已知提供者的明确列表，您可以在路由正则表达式中对它们进行硬编码。

通过设置捕获这部分 URL 的路由，它会立即在 $this->params['provider'] 中可用，但比这更好的是 html 帮助器 link() 方法自动构建正确格式的 URL，例如

```
$html->link('label', array(
  'controller' => 'xxx',
  'action' => 'yyy',
  'provider' => 'zzz'
)); 
```

这会返回一个类似 /zzz/xxx/yyy 的链接

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-07T17:30:17.793

此外，如果您有一组已知的允许 URL，最好将这些允许的 URL 列入白名单。您甚至可以通过拥有一个包含允许的 URL 的数据库表来动态地做到这一点——从数据库中提取它，与传递的 URL 参数进行比较。或者，您可以将模式列入白名单（例如，您已允许可以通过的域，但其余的 url 会更改......您可以将域列入白名单和/或使用正则表达式来确定有效性）。

至少，确保使用 strip_tags，或内置的 mysql 转义序列（如果使用 PHP5，参数化 SQL 查询可以解决这些问题）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-23T17:06:22.340

[使用Sanitize](http://api.cakephp.org/class/sanitize)类会更像蛋糕。在这种情况下， [Sanitize::escape()](http://api.cakephp.org/class/sanitize#method-Sanitizeescape)或[Sanitize::paranoid()](http://api.cakephp.org/class/sanitize#method-Sanitizeparanoid)似乎合适。

# windows - 如何防止 .NET 服务在等待依赖服务时超时

> ID：419739
> 
> 赞同：1
> 
> 时间：2009-01-07T09:38:53.173
> 
> 标签：windows, service, timeout

我有一个依赖于 MSMQ 服务的基于 C# 的服务。在某些情况下，MSMQ 服务需要很长时间才能启动，显然会导致 C# 服务超时。如何以编程方式解决此问题？

编辑：看来我正在处理的错误报告不正确，该服务确实最终启动了。我为混乱道歉

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-07T09:41:31.700

通常在队列上等待应该在一个单独的线程中进行，该线程应该直接在服务的 OnStart 方法中启动。如果你这样做，启动命令成功并且服务不会超时。

# java - JMF 和 RTP 协议

> ID：419748
> 
> 赞同：0
> 
> 时间：2009-01-07T09:42:45.020
> 
> 标签：java, jmf, rtp

我正在做一个项目，其中包含一个 Java 视频会议系统并使用 RTP 协议。问题是我无法将流传递给我在网络摄像头中捕获的客户端。我已经关闭了我的防火墙，但它仍然不起作用。

有人可以帮我一把吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-07T10:40:59.960

尝试查看网络流量，例如使用 Wireshark。

# javascript - 托管 Yui、Google 地图、JQuery - 一种监控网站使用情况的简单方法？

> ID：419763
> 
> 赞同：1
> 
> 时间：2009-01-07T09:47:44.997
> 
> 标签：javascript, jquery, yui

Yahoo Javascript 库 (YUI)、JQuery 等 Google 地图都允许您使用以下格式引用他们的文件：

```
<script type="text/javascript" src="http://yui.yahooapis.com/2.6.0/build/yahoo-dom-event/yahoo-dom-event.js"></script> 
```

这会从他们的服务器发出对脚本的请求，这也会将 HTTP 引荐来源网址传递给他们的 Web 服务器。雅虎等是否使用它来统计哪些网站获得了哪些流量？或者这是一个阴谋论？

当然，他们的服务器大部分时间都会比任何小公司购买的服务器快得多，因此使用脚本的托管版本更有意义。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-07T18:14:07.610

克里斯，

我在雅虎的 YUI 团队工作。

我们只在 yui.yahooapis.com 上托管 YUI；Google 在其 CDN 上托管 YUI 和许多其他库。我可以从雅虎方面告诉你，我们不会从我们的 CDN 监控 YUI 的站点使用情况。我们确实跟踪 yui.yahooapis.com 使用的总体增长，但我们不跟踪哪些网站正在产生流量。您建议我们可以跟踪使用情况是正确的 - 我们在托管文​​档中尽可能清楚地声明，如果我们这边生成的流量日志不代表隐私问题，您应该只使用这种服务你。

不过，总的来说，我不认为库使用的 CDN 流量是衡量任何事情的可靠指标。大多数 YUI 的使用，即使是在 Yahoo，也没有使用 yui.yahooapis.com 或 Google 的等价物，我相信其他库也是如此。即使网站使用我们服务器上的 YUI，我们也不会拥有您从 Google Analytics 或 Yahoo Analytics 获得的那种全面的流量数据——因为并非所有页面都会统一使用 YUI 或 CDN。

鉴于托管服务的优势——包括来自 Google 的 SSL 和来自 Yahoo 的 YUI 组合处理——我认为 CDN 对大多数实施者来说是一个巨大的胜利，几乎没有缺点。

-埃里克

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-07T10:00:48.637

当然，他们会产生统计数据——至少他们需要知道他们在托管这些脚本上花费了多少资源。而且很高兴知道谁使用您的代码。

我不认为这是一件坏事。

使用托管版本更有意义，因为您的访问者在访问另一个站点后可能已经缓存了脚本。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-07T10:02:30.800

当然，他们可以很容易地统计哪些站点使用 YUI 以及使用频率，以及 YUI API 的哪些部分更受欢迎（在小型站点中）。然而，他们无法知道网站访问者究竟对他们的库做了什么。

鉴于他们（谷歌和雅虎）索引了很多网页，如果他们分析他们的索引，他们可以获得更精确的统计数据。因此，如果您的网站是公开的，您就无法隐藏您正在使用 YUI。

这同样适用于谷歌地图和 jQuery。

# asp.net - 如何验证动态创建的控件？

> ID：419769
> 
> 赞同：2
> 
> 时间：2009-01-07T09:48:59.330
> 
> 标签：asp.net, ajax

我有一个asp.net页面，它的一些控件是动态创建的，这些控件是以下之一；文本框、日历或下拉列表。

在某些情况下，这些控件是否应该根据从 db 读取的标志进行验证？

> 有没有办法验证动态创建的控件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-07T10:00:40.820

基本上，您需要通过代码创建验证器，并通过代码将它们附加到动态创建的控件。然后，该页面将在页面中为您呈现您的验证器。

如果验证需要从数据库中读取标志，那么也许可以使用自定义验证器，它允许您在客户端和服务器上设置特定逻辑以满足您的特定验证要求。如果您不想，则不必提供客户端验证。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-07T09:55:08.943

您可以在创建这些控件的同时创建验证器

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-07T09:55:28.287

当您动态创建任何控件时，还要附加所需的验证器控件，您可以在运行时启用/禁用验证器控件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-03T12:26:08.593

我找到了解决这个问题的方法。我在这个页面上遇到的主要问题之一是它启用了 ajax，我需要验证动态创建的控件。

我的解决方案及其正常工作，在创建控件时，我向它添加了一个输入属性，将其标记为是否需要，另一个属性将其标记为要验证的字段？

使用Javascript，我通过属性“动态控制”的所有输入标签并基于“验证属性”，我验证它与否。很简单，对吧？

示例代码：在创建控件时，将其标记如下

```
txtBox.Attributes.Add("Type", "T"); // Type of control.
txtBox.Attributes.Add("IsKeyField", "Y"); // Is dynamically created field.
txtBox.Attributes.Add("IsMandatory", "Y");  // Is mandatory or not? 
```

JavaScript 代码

```
 var inputControls = document.getElementsByTagName("input");
            for(var i=0 ; i<inputControls.length ; i++)
            {
                if ( inputControls[i].getAttribute("IsKeyField") == "Y" )                                        
                {
                    if (inputControls[i].getAttribute("Type") == "T" || (inputControls[i].getAttribute("Type") == "C"))
                    {
                        if(inputControls[i].getAttribute("IsMandatory") == "Y")
                        {
                            if(inputControls[i].value == "")
                            {
                                errorMsg += "\n" + inputControls[i].getAttribute("KeyField_Name") + " is required.";
                                isValidated = false;
                            }                            
                        }                         
                    }
                }
            } 
```

当然，您可以在单击所需按钮时调用该代码。

```
btnUpload.Attributes.Add("onClick", "javascript:if(!ValidateMandatoryFields()) return false;"); 
```

# java - 提高图表的清晰度

> ID：419770
> 
> 赞同：1
> 
> 时间：2009-01-07T09:49:11.983
> 
> 标签：java, jfreechart

我正在使用 jfreechart 来绘制图表。问题是如果 X 轴上有更多条目，则 X 轴参数不可见。我该如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-07T11:00:36.223

更改图表的比例，直到您可以看到参数。

# .net - 如何阻止 Winforms 面板滚动？

> ID：419774
> 
> 赞同：24
> 
> 时间：2009-01-07T09:50:16.613
> 
> 标签：.net, winforms, panel

如果您将一个 400 像素高的 DataGridView 放在一个 300 像素高的面板上，这样面板上有一个滚动条，然后向下滚动以显示网格的下半部分，然后单击面板外的一个控件，然后单击网格中的一行，面板向上滚动到顶部并选择网格中的错误行。

它不仅仅是一个 DataGridView；它发生在任何高于面板的控件上，例如 Infragistics UltraWinGrid、Rich Text Box。我将其作为 Infragistics 的错误提出，但他们说这是 Microsoft 的问题。

我已经尝试使用控件的所有相关事件，但面板滚动发生在事件触发之前。

有什么建议么？

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2009-05-26T20:33:49.373

这是由 ScrollableControl 类自动触​​发的 ScrollToControl 事件引起的，并且事件处理程序滚动以显示获得焦点的控件的左上角。当可滚动容器控件仅包含一个控件时，此行为没有帮助。我对这种行为感到非常沮丧，直到我发现如何阻止它。

停止此行为的方法是覆盖 ScrollToControl 事件处理程序，如下所示：

```
class PanelNoScrollOnFocus : Panel
{
    protected override System.Drawing.Point ScrollToControl(Control activeControl)
    {
        return DisplayRectangle.Location;
    }
} 
```

用此面板控件替换您的面板控件。完毕。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-07T18:00:44.330

我猜您正在将面板的 AutoScroll 属性设置为 true。当您这样做时，切换应用程序会将滚动位置重置为零，并且面板会重置其位置。

如果关闭 AutoScroll 并添加自己的滚动条，您可以设置滚动条的最大值和最小值以匹配面板的要求，然后在滚动条的 Scroll 事件中设置面板的滚动值。切换窗口时不会重置。

就像是：

```
private void vScrollBar1_Scroll(object sender, ScrollEventArgs e)
{
    panel1.VerticalScroll.Value = vScrollBar1.Value;
} 
```

这对我来说是一个新的，我不得不重新创建它。我可能需要在我的网站上添加一篇关于它的文章 :-)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-12-09T11:29:23.607

谢谢skypecakes，效果很好:) 这是您的控件的编辑版本，它还跟踪滚动条的位置：

```
class AutoScrollPanel : Panel
{
    public AutoScrollPanel()
    {
        Enter += PanelNoScrollOnFocus_Enter;
        Leave += PanelNoScrollOnFocus_Leave;
    }

    private System.Drawing.Point scrollLocation;

    void PanelNoScrollOnFocus_Enter(object sender, System.EventArgs e)
    {
        // Set the scroll location back when the control regains focus.
        HorizontalScroll.Value = scrollLocation.X;
        VerticalScroll.Value = scrollLocation.Y;
    }

    void PanelNoScrollOnFocus_Leave(object sender, System.EventArgs e)
    {
        // Remember the scroll location when the control loses focus.
        scrollLocation.X = HorizontalScroll.Value;
        scrollLocation.Y = VerticalScroll.Value;
    }

    protected override System.Drawing.Point ScrollToControl(Control activeControl)
    {
        // When there's only 1 control in the panel and the user clicks
        //  on it, .NET tries to scroll to the control. This invariably
        //  forces the panel to scroll up. This little hack prevents that.
        return DisplayRectangle.Location;
    }
} 
```

这仅在面板中只有一个控件时才有效（尽管我没有使用多个控件对其进行测试）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-07T16:54:26.740

我理解你的痛苦，这让我不止一次。

如果您的 DataGridView 是面板中唯一的内容，只需将 Dock 设置为 Fill 并让 DGV 自行处理滚动。我认为它不会再做跳跃的事情了。否则，我想你可以调整它的大小，使它小于面板，让它自己滚动。

# c++ - DirectDraw 问题 - 将应用程序作为常规 Windows 应用程序运行

> ID：419775
> 
> 赞同：0
> 
> 时间：2009-01-07T09:50:37.440
> 
> 标签：c++, windows-mobile, directshow, directdraw

我正在开发一个视频录制应用程序，我想用徽标和录制计时器覆盖视频预览。

我尝试运行全屏应用程序，一切正常。然后我尝试将该应用程序作为常规 Windows 应用程序运行，但它返回了一个错误。

如果有办法修改它以将应用程序作为常规 Windows 应用程序运行，任何人都可以看看下面的代码吗？

```
HRESULT CViewfinderRenderer::OnStartStreaming()
{
  HRESULT hr = S_OK;
  DDSURFACEDESC ddsd;

  m_pDD = NULL;

  //full screen settings
  hr = DirectDrawCreate(NULL, &m_pDD, NULL);
  hr = m_pDD->SetCooperativeLevel(m_hWnd, DDSCL_FULLSCREEN);

  ddsd.dwSize = sizeof(ddsd); 
  ddsd.dwFlags = DDSD_CAPS | DDSD_BACKBUFFERCOUNT; 
  ddsd.ddsCaps.dwCaps = DDSCAPS_FLIP | DDSCAPS_PRIMARYSURFACE;
  ddsd.dwBackBufferCount = 1;

  //end full screen settings

  //normal settings
  /*hr = DirectDrawCreate(NULL, &m_pDD, NULL);
  hr = m_pDD->SetCooperativeLevel(m_hWnd, DDSCL_NORMAL);

  ddsd.dwSize = sizeof(ddsd);
  ddsd.dwFlags = DDSD_BACKBUFFERCOUNT;
  ddsd.dwBackBufferCount = 1;*/
  //end normal settings

  hr = m_pDD->CreateSurface(&ddsd, &m_pSurface, NULL);
  if (hr != DD_OK) {
    return hr;
  }

  // Get backsurface
  hr = m_pSurface->EnumAttachedSurfaces(&m_pBackSurface, EnumFunction);

  return S_OK;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-07T11:29:01.967

它返回了什么错误？

也试试这个：

```
ddsd.dwFlags = DDSD_CAPS;
ddsd.ddsCaps.dwCaps = DDSCAPS_PRIMARYSURFACE; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-07T11:46:44.397

即使在运行窗口时，您也需要创建一个主表面，只是它不是可翻转的表面。

```
 //full screen settings
 hr = DirectDrawCreate(NULL, &m_pDD, NULL);
 hr = m_pDD->SetCooperativeLevel(m_hWnd, DDSCL_NORMAL);

 ddsd.dwSize = sizeof(ddsd); 
 ddsd.dwFlags = DDSD_CAPS; 
 ddsd.ddsCaps.dwCaps = DDSCAPS_PRIMARYSURFACE; 
```

除了创建表面之外，您很可能还想为窗口创建一个裁剪器。有关完整示例，请参阅[此 GameDev 文章](http://www.gamedev.net/reference/articles/article608.asp)中的窗口运行段落。

# windows - 使用 IMessageFilter 和 DoEvents 的模态操作

> ID：419776
> 
> 赞同：1
> 
> 时间：2009-01-07T09:53:01.757
> 
> 标签：windows, winforms, user-interface, winapi

这是一个 Windows 窗体应用程序。我有一个函数可以模态捕获一些鼠标事件，直到满足条件。例如，我想在函数返回之前等待用户在窗口的客户区域中选择一个点（或者可选地使用 Escape 键取消操作）。我正在使用以下结构：

```
Application::AddMessageFilter(someFilter);
while(someFilter->HasUserSelectedAPoint_Or_HitEscapeKey()){
    Application::DoEvents();
}
Application::RemoveMessageFilter(someFilter); 
```

除了在控制进入 while 循环时占用近 100% 的 CPU 使用率之外，这非常有效。我正在寻找类似于如下所示的替代方案：

```
Application::AddMessageFilter(someFilter);
while(someFilter->HasUserSelectedAPoint_Or_HitEscapeKey()){
    // Assuming that ManagedGetMessage() below is a blocking
    // call which yields control to the OS
    if(ManagedGetMessage())
        Application::DoEvents();
}
Application::RemoveMessageFilter(someFilter); 
```

使用`IMessageFilter`and的正确方法是什么`DoEvents`？在收到消息之前，如何将控制权交给操作系统？`GetMessage`托管世界中的任何等价物？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-07T09:58:48.920

您可以在两次调用之间让线程休眠 500 毫秒左右`DoEvents()`。尝试不同的值，看看感觉正确。

# sql-server - sqlserver 2008（与 2005 相比）的缺点是什么

> ID：419788
> 
> 赞同：2
> 
> 时间：2009-01-07T09:58:26.643
> 
> 标签：sql-server, sql-server-2005, sql-server-2008

我正在开始一个新项目，我正在考虑使用 sqlserver 2008。

我在让 teamsystem 使用它时遇到了很多麻烦，我想知道 sql server 2008 是否已广泛用于生产环境。

你选谁？您如何比较 sqlserver 2005 和 2008？

**编辑：**我同意新的（新功能，将来避免一次痛苦的迁移）和旧的（更少的错误，更多的文档）之间明显和一般的权衡。我已经在网上浏览了 2005 年和 2008 年之间的差异。我的问题更具体：您使用的是 2008 年吗？您是否遇到问题（例如下面提到的 FTS？）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-07T10:08:03.207

如果您使用 2005 并尝试稍后升级，也许您应该查看[SQL Server 2008 中数据库引擎功能的重大更改。](https://stackoverflow.com/questions/77217/moving-sql2005-app-to-sql2008)

在这个阶段，我个人会选择 2005 并避免文章中的功能概述。您的客户/应用程序/开发人员不会失去很多（如果有的话）功能。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-07T10:08:11.147

数据库系统是考虑更改成本高昂的领域之一。从我目前看到的情况来看，自 2005 年以来运行良好，大型项目可能仍在使用它（一些大型项目甚至仍在使用 2000）。然而，这并不意味着 2008 年不好或不值得。如果您正在考虑一个新项目，您可能应该选择 2008 年。我认为这样做没有什么大的缺点。

关于 TFS，我不得不说，Team Foundation Server 是我在 Microsoft 产品*中见过的***最糟糕**的安装体验之一。我认为这是 TFS 而不是 SQL Server 2008 的问题。顺便说一下，TFS SP1 与 2008 兼容，但您必须先集成服务包。

 ** * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-07T10:07:15.613

2008 年的一个缺点：[全文搜索速度较慢](https://blog.stackoverflow.com/2008/11/sql-2008-full-text-search-problems/)（至少在某些情况下）。这击中了 Stack Overflow（链接是 SO 博客）。更改背后有充分的理由，但在开始之前值得了解。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-08T08:51:33.830

如果您不需要 SQL Server 2008 的任何功能，那么我建议您使用 SQL Server 2005 SP3。这是一个成熟、健壮且功能丰富的数据库平台。我目前正在为客户实施一个战略性数据库平台，并在 SQL Server 2005 SP3 64 位集群上进行了标准化。我的客户的应用程序都不需要任何 SQL Server 2008 功能，我很高兴知道 SQL Server 2005 已经在该领域使用了三年。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-07T12:36:09.227

主要缺点：您将发现新的错误，您将等待相应的包或修补程序。请查看[此页面](http://support.microsoft.com/kb/958735)（SQL server 2005 的累积更新包 11）或在[Microsoft 知识库](http://support.microsoft.com/search/default.aspx?catalog=LCID%3D1033&query=Cumulative+update+package+for+SQL+Server+2005&mode=r)中导航，闭上眼睛想象其他用户在发现这些错误时所经历的所有痛苦......

编辑：我们不使用 SQL 2008。我们不需要它的任何新功能。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-01-19T14:30:51.477

这始终是迁移到新版本程序的风险。这些是您应该问自己的一些问题：

*   您是否已经在旧版本上完成了大量的手动测试？
*   你能应对新版本中的错误吗？
*   新版本被其他人使用多久了？
*   您处于项目周期的开始还是结束？

现在不迁移到新版本的最大风险是：

*   **您将被迫**稍后搬家，这对您来说可能不是一个好时机。（但您可能可以跳过释放，因此不必多次重复疼痛）
*   您不能使用已添加到新版本中的内容
*   从长远来看，很少有人会知道如何使用旧版本
*   使用太多非常旧版本的不同事物对您的员工的简历是不利的——因此它可能会影响您的员工流动率等。

**所以你需要对时间进行“痛苦”和“获益”的规划，然后你就会清楚地看到移动的正确时间；然而，我们无法及时看到前方，也无法及时后退！**

# sql-server - 如何按列中的关键字出现对查询结果进行排序？（SQL Server 全文）

> ID：419792
> 
> 赞同：0
> 
> 时间：2009-01-07T09:59:21.650
> 
> 标签：sql-server, full-text-search

如何按列中的关键字出现对查询结果进行排序？我正在使用带有全文索引的 SQL Server 2008。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-07T12:23:25.557

select columnname, count(columnname) as cnt from tablename group by columnname order by count(columnname) desc

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-07T10:16:58.977

select * from tablename order by columnname

那是你要找的吗？

# java - 显式的serialVersionUID 被认为是有害的？

> ID：419796
> 
> 赞同：25
> 
> 时间：2009-01-07T10:00:20.603
> 
> 标签：java, serialization, serialversionuid

在我看来，为新类明确指定 serialVersionUID 是不好的。考虑两种情况，当布局有它应该改变时不改变它，当它不应该改变它时改变它。

当它应该被改变时不改变几乎只发生在它是明确的时候。在这种情况下，它会导致一些非常微妙、难以发现的错误。特别是在开发过程中，当类布局经常变化时。但是如果没有明确指定，它会改变并且反序列化会大声中断，很可能通过清除存储库来解决。

几乎只有在它是隐式的时候才会在不应该的时候改变它。这是类布局已更改但我们仍希望从旧的序列化 blob 中反序列化的罕见情况。这可能会在 QA 期间被捕获（*从 5.2 升级到 5.2.1 后出现奇怪的错误，请参阅附加的堆栈跟踪*），并且可以通过设置显式值来轻松修复。

评论？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-01-07T10:05:49.827

除了类布局更改之外的其他原因可能会更改不应该发生的时间 - 问题在于它依赖于编译器实现。如果您使用 Eclipse 进行调试，但使用 javac 进行生产构建，您最终*可能会*得到两组不兼容的数据。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-07T12:19:58.450

在我的工作中，我们明确禁止指定serialVersionUID，正是因为您提出的问题。

另外，我们持久化的类只是用来存储数据，里面没有逻辑，所以唯一的改变就是因为改变了数据成员。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-07T15:26:34.780

进一步强调 john skeet 所说的话并反驳评论：

“如果你不需要那个（即你总是使用相同的类版本进行序列化和反序列化），那么你可以安全地跳过显式声明”

即使您没有长期序列化并且使用相同的类版本，*您仍然可能遇到问题*。如果您正在编写客户端-服务器代码，并且客户端代码可以使用与服务器不同的 jvm 版本/实现运行，那么您可能会遇到与不兼容的 serialversionuids 相同的问题。

总而言之，**唯一**不指定 serialversionuids 是“安全”的情况是当您不进行长期序列化并且保证序列化数据的所有消费者将使用与原始生产者相同的 jvm 实现和版本时。

简而言之，*不*使用serialversionuid通常是更有害的情况。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-07T10:06:21.650

当您需要通过序列化支持长期持久性时，您几乎总是需要使用自定义代码来支持这一点，并且需要显式设置`serialVersionUID`，否则较旧的序列化版本将无法被较新的代码反序列化。

当类发生变化时，这些场景已经需要非常小心才能使所有案例都正确，因此 serialVersionUID 是您的问题中最少的。

如果您不需要（即您总是使用相同的类版本进行序列化和反序列化），那么您可以安全地跳过显式声明，因为计算值将确保使用正确的版本。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-07T12:13:53.047

无论您是否选择`serialVersionUID`（我建议您这样做），您都应该真正考虑为串行兼容性创建一套全面的测试。

仔细设计串行格式也是值得的。它实际上是一个公共 API。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-01-16T15:20:01.933

如果您只是将序列化用于远程方法调用，例如调用 EJB，其中客户端和服务器类以及 jvm 是相同的，我怀疑这是迄今为止最常见的用途，然后显式设置 serialVersionUID（例如 eclipse建议）可能会以偶然的、莫名其妙的错误的形式给您带来极大的痛苦，其中不兼容的类实例由于固定的 serialVersionUID 而被视为兼容。远程调用在低级序列化过程中会默默地出错，并且只有在对象的状态不一致时才会出现问题。只有当您意识到您的客户端和服务器类在某种程度上不同时，您才能找到问题的根源（尽管 serialVersionUID 当然不是）。根据我的经验，出于这个原因设置 serialVersionUID 弊大于利。

另一方面，如果您明确设置 serialVersionUID 以读取旧数据，则根据定义，您读取的是不兼容的版本，并且可能最终导致对象处于不一致或不完整的状态。在这种情况下，设置 serialVersionUID 是解决不同问题的一种解决方法。

# parsing - Windows 和 Unix 中文件扩展名的规则是什么？

> ID：419800
> 
> 赞同：1
> 
> 时间：2009-01-07T10:01:30.413
> 
> 标签：parsing, filenames

我目前正在使用 File::Basename fileparse 来分离文件的目录、基本文件名及其扩展名，使用如下所示：

```
my($myfile_name,$mydirectory, $file_extension) = fileparse($$rhash_params{'storage_full_path_location'},'\..{1,4}'); 
```

但是请注意，您实际上可以为函数提供一个后缀数组，该数组将包含所有已知的文件扩展名。

所以我试图找到一种安全的方法来执行此操作，因为我已经看到我有一些奇怪的文件名要处理，即 file.0f1.htm 等。

## 问题：

2.  是否有适用于 Windows 和 Unix 系统的常用扩展名列表？但就我而言，它主要用于 Windows。
3.  是否可以安全地假设 Windows 中的所有文件名都应具有以三个字母字符结尾的扩展名？

如果有更好的方法可以做到这一点，请分享。

谢谢。

## 更新：

所以很明显我必须喝醉了才能忘记那些其他的扩展。:) 因此，我更新了当前的正则表达式以允许 1-4 个字符。

在这种情况下，我应该如何更改我的正则表达式行以正确匹配它？或者从谷歌查找所有常用的扩展并将它们放入一个数组中以传递给函数是一个更好的主意吗？我的用户通常是学生或老师。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-07T10:07:31.977

> `1`. 是否有适用于 Windows 和 Unix 系统的常用扩展名列表？但就我而言，它主要用于 Windows。

是的，加载，整个互联网：[http ://www.google.com/search?q=common+file+extensions](http://www.google.com/search?q=common+file+extensions)

> `2`. 是否可以安全地假设 Windows 中的所有文件名都应具有以三个字母字符结尾的扩展名？

不，完全可以在 Windows 中使用`'.c'`,`'.java'`等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-07T10:14:43.083

您的代码中有几个错误假设：

*   文件不需要有扩展名。例如，Unix/Linux/...上的大多数二进制可执行文件根本没有扩展名。它们被简单地称为“bash”、“wget”、“sed”、“Xorg”……
*   扩展名不必是三个字符长，正如@Alnitak 已经告诉你的那样：“.c”、“.java”、“.mpeg”、“.jpeg”、“.html”都是非常好的和相当广泛的扩展名
*   在最后一个“。”处切割。可能会更省钱，但对于没有扩展名或具有多个（或多部分）扩展名的文件（例如“.tar.gz”、“tar.bz2”）仍然可能失败，这些文件经常出现在 Unix/Linux/.. 。-世界

# wpf - WPF：如何在 VS2008 XAML 编辑器智能感知中显示枚举属性值？

> ID：419802
> 
> 赞同：4
> 
> 时间：2009-01-07T10:02:59.177
> 
> 标签：wpf, xaml, enums, properties, intellisense

我创建了一个具有枚举类型依赖属性的 WPF 自定义控件。

我希望该控件的用户在 VS 中编辑 XAML 时在智能感知窗口中查看枚举的可选值。

有谁知道怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-11T00:34:49.317

我相信如果您将“XmlnsDefinition”属性添加到包含该控件的程序集，它将起作用。顺便说一句，我在尝试在同一个项目中引用控件时遇到了问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-02T10:16:08.447

这里也有人问了这个问题：

[如何让 IntelliSense 在 XAML 中的自定义/用户控件上自动完成枚举？](https://stackoverflow.com/questions/596089/how-can-i-get-intellisense-to-auto-complete-an-enum-on-a-custom-user-control-in-x/596145)

有答案但没有标记，也许您可​​以尝试该建议并返回您的测试结果。

# php - 闭包作为类成员？

> ID：419804
> 
> 赞同：7
> 
> 时间：2009-01-07T10:05:09.673
> 
> 标签：php, closures

我喜欢 jQuery/Javascript 通过闭包扩展功能的方式。是否可以在 PHP 5.3 中做类似的事情？

```
class Foo
{
    public $bar;
}

$foo = new Foo;
$foo->bar = function($baz) { echo strtoupper($baz); };
$foo->bar('lorem ipsum dolor sit amet');
// LOREM IPSUM DOLOR SIT AMET 
```

[编辑] 在我的问题中混淆了“它”和“是”。呵呵。

# 更新

我下载了 5.3a3，它确实有效！

```
class Foo
{
    protected $bar;
    public $baz;

    public function __construct($closure)
    {
        $this->bar = $closure;
    }

    public function __call($method, $args)
    {
        $closure = $this->$method;
        call_user_func_array($closure, $args);
    }

}

$foo = new Foo(function($name) { echo "Hello, $name!\n"; });
$foo->bar('Mon'); 
// Hello, Mon!
$foo->baz = function($s) { echo strtoupper($s); };
$foo->baz('the quick brown fox jumps over the lazy dog');
// THE QUICK BROWN FOX JUMPS OVER THE LAZY DOG 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-07T11:12:54.030

PHP 5.3 将允许创建 lambda 函数和闭包，这将允许您实现代码示例。来自[PHP RFC](http://wiki.php.net/rfc/closures)：

```
function & (parameters) use (lexical vars) { body } 
```

该函数作为引用返回，并且可以作为回调传递。例如，创建一个函数：

```
$lambda = function () { echo "Hello World!\n"; }; 
```

将 lambda 函数作为回调传递：

```
function replace_spaces ($text) {
    $replacement = function ($matches) {
        return str_replace ($matches[1], ' ', '&nbsp;').' ';
    };
    return preg_replace_callback ('/( +) /', $replacement, $text);
} 
```

闭包还允许您从本地范围导入变量：

```
$map = function ($text) use ($search, $replacement) {
    if (strpos ($text, $search) > 50) {
       return str_replace ($search, $replacement, $text);
    } else {
        return $text;
    }
}; 
```

其中 $search 和 $replacement 都在闭包之外声明，$text 是函数参数。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-07T11:51:21.597

您可以利用`__call`方法来重新路由不存在的方法调用。将注册表添加到您的类，以便您可以即时添加/删除方法。外部函数的调用约定是第一个参数是函数绑定的对象。

```
clas Foo {

    private $registry;

    public function __call($alias, $args) {
        if (array_key_exists($alias, $this->registry)) {
            // prepend list of parameters with $this object
            array_unshift($args, $this);
            return call_user_func_array($this->registry[$alias], $args)
        }
    }

    public function register($method, $alias = null) {
        $alias or $alias = $method; // use original method name if no alias
        $this->registry[$alias] = $method;
    }

    public function unregister($alias) {
        unset($this->registry[$alias]);
    }

} 
```

想象一下`clone_object`返回克隆对象数组的函数。第一个参数是要克隆的对象，第二个参数是克隆的数量。

```
function clone_object($foo, $n) {
    $a = array();
    while ($n--) {
        $a[] = clone $foo;
    }
    return $a;
} 
```

现在，您可以通过这种方式将方法注入`clone_object`到类中`Foo`并为其命名`bar`：

```
$f = new Foo();
$f->register('clone_object', 'bar');
$f->bar(5); // this will return array of 5 cloned objects 
```

在最后一行调用方法`bar`将导致重定向到函数`clone_object`。请注意，调用约定会将参数`$this`插入参数列表，因此`(5)`将更改为`($this, 5)`.

需要注意的是，外部函数不能在私有/受保护的属性和方法上工作。

最后一句话，如果您能想到一个不会动态更改对象的解决方案，您可能应该使用它。以上是黑色巫术，应谨慎使用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-07T10:44:20.343

PHP 可以通过[create_function()](http://nl3.php.net/create_function)。尽管使语法几乎完全无用，但语法却很痛苦。

似乎[PHP5.3+](http://www.toosweettobesour.com/2008/07/21/php-53-and-closures/)正在获得/支持[闭包和 lambda！](http://wiki.php.net/rfc/closures)

然而也来自[RFC](http://wiki.php.net/rfc/closures)

> Lambda 函数/闭包不是在运行时通过其他方法动态扩展类的方法。还有其他几种可能性可以做到这一点，包括已经存在的 __call 语义。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-07T10:52:42.977

正确的匿名函数/闭包仅在 PHP 5.3 中可用，暂时不会广泛使用 -[一些有用的信息](http://wiki.php.net/rfc/closures)。我不认为真的可以做你想做的事。

您可以`create_function()`在一定程度上使用：

```
$func = create_function('$baz', ' echo strtoupper($baz); ');
$func("hello"); 
```

但是，以下内容无法按您的预期工作：

```
$foo = new Foo;
$foo->bar = create_function('$baz', ' echo strtoupper($baz); ');
$foo->bar('lorem ipsum dolor sit amet'); 
```

您需要改为：

```
call_user_func($foo->bar, 'lorem ipsum dolor sit amet'); 
```

您也不能`$this`在创建的函数内部使用，因为它的范围与方法不同。

**编辑**

我不小心复制了一些 Martijn 的答案，因为他在我写我的时候编辑了他的答案。为了完整起见，我将完整保留我的答案

**另一个编辑**

你也许也可以做类似的事情

```
class Foo
{
    public $bar;

    protected $anonFuncs = array();

    public function create_method($name, $params, $code) {
        if (strlen($params)) $params .= ',';
        $params .= '$self';
        $this->anonFuncs[$name] = create_function($params, $code);
    }

    public function __call($name, $args) {
        if (!isset($this->anonFuncs[$name])) {
            trigger_error("No method $name", E_USER_ERROR);
        }

        $args[] = $this;

        return call_user_func_array($this->anonFuncs[$name], $args);
    }
}

$foo = new Foo;
$foo->create_method('bar', '$baz', ' echo strtoupper($baz) . get_class($self); ');
$foo->bar('lorem ipsum dolor sit amet'); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-08T08:49:09.497

使用 create 函数，您可以执行以下操作：

```
$Dynamic->lambda = create_function('$var', 'return $var." world."; ');
$classic = $Dynamic->lambda("hello"); // classic would contain "hello world." 
```

类代码将包含以下内容：

```
public function __set($methodname, $function)
{
    $this->methods[$methodname] = $function;
}

public function __get($methodname)
{
    return $this->methods[$methodname];
}

public function __call($method, $args)
{
   $funct = $this->{$method};
   //$args[] = $this; --to add the current object as a parameter option
   return call_user_func_array($funct, $args);
} 
```

注意：您将无法`$this`在 create 函数中使用对象范围（变量），因为基本上这只是使用全局命名空间中 create_function 的对象接口。但是，您可以轻松地将对象的实例附加到参数列表并将其拉入类中，但同样您只能访问拉入的类的公共方法。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-10T07:11:30.250

自 PHP5.4 发布以来，您可以做的更多：

1.  **动态**地将您的方法添加到对象
2.  在这些方法中使用**$this**
3.  **从另一个继承**一个动态对象

基本思想在这里实现：[https ://github.com/ptrofimov/jslikeobject](https://github.com/ptrofimov/jslikeobject)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-06-10T05:00:56.490

我在工作中使用这个 create_closure() 将回调分离到类中：

```
<?php
function create_closure($fun, $args, $uses)
         {$params=explode(',', $args.','.$uses);
          $str_params='';
          foreach ($params as $v)
                  {$v=trim($v, ' &$');
                   $str_params.='\''.$v.'\'=>&$'.$v.', ';
                  }
          return "return function({$args}) use ({$uses}) {{$fun}(array({$str_params}));};";
         }
?> 
```

例子：

```
<?php
$loop->addPeriodicTimer(1, eval(create_closure('pop_message', '$timer', '$cache_key, $n, &$response, &$redis_client')));

function pop_message($params)
         {extract($params, EXTR_REFS);
          $redis_client->ZRANGE($cache_key, 0, $n)
                            ->then(//normal
                                   function($data) use ($cache_key, $n, &$timer, &$response, &$redis_client)
                                   {//...
                                   },
                                   //exception
                                   function ($e) use (&$timer, &$response, &$redis_client)
                                   {//...
                                   }
                                  );
         }
?> 
```

# javascript - 如果最后修改的缓存到位，location.replace() 是否不执行条件获取？

> ID：419810
> 
> 赞同：1
> 
> 时间：2009-01-07T10:06:27.127
> 
> 标签：javascript, web-applications, caching, web

这是我所看到的：我有一个条件获取缓存策略（缓存控制：私有，必须重新验证）。

如果我在页面上，它工作正常，然后尝试点击浏览器的刷新按钮。

但是，在我网站的另一部分，我使用 location.replace(url) 转到该页面......如果我这样做，它不会进行检查并始终检索缓存的版本。

关于这里可能有什么问题的任何提示？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-07T10:38:11.853

您可以通过执行强制未缓存版本`location.replace(url + "?tid=" + Math.random())`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-07T11:46:31.870

尝试使用普通链接。如果你得到相同的结果，那么问题不在于 JavaScript。

# sql-server - 用于恢复 SQL Server 数据库的 Msbuild 任务

> ID：419811
> 
> 赞同：2
> 
> 时间：2009-01-07T10:06:48.203
> 
> 标签：sql-server, msbuild

什么是 msbuild 任务的快速示例/演示，用于删除然后恢复数据库并可能针对恢复的数据库运行任何 .sql 文件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-07T10:18:08.740

使用[ExecTask](http://msdn.microsoft.com/en-us/library/x8zx72cd.aspx)并调用 sqlcmd.exe 或 cmd 脚本来对数据库执行任何操作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-07T10:42:37.083

我们使用 ExecTask 和 powershell 脚本。相关的 Powershell 代码在这里：

```
$Server = new-object ("Microsoft.SqlServer.Management.Smo.Server") $ServerName
$Database = new-object ("Microsoft.SqlServer.Management.Smo.Database") ($Server, $DatabaseName)

function RestoreDb([string] $BackupFile =  $(throw "Backup file required."))
{

  write-host "Taking db offline"
  $Database.SetOffline()
  $restore = new-object ('Microsoft.SqlServer.Management.Smo.Restore')

  $fil=new-object "Microsoft.SqlServer.Management.Smo.BackupDeviceItem"
  $fil.DeviceType='File'
  $fil.Name= $BackupFile
  $restore.Action="Database"
  $restore.Devices.Add($fil)
  $restore.Database=$DatabaseName
  $restore.ReplaceDatabase = $true
  $restore.Restart  = $true
  write-host "Restoring database $DatabaseName  on  $ServerName from file $BackupFile"
  $restore.SqlRestore($Server)
  write-host "Taking db online"
  $Database.SetOnline()
} 
```

和相关的MSBuild

```
<Exec WorkingDirectory="$(BuildRoot)"   Command="powershell -command  .\run_migration.ps1"/> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-26T15:35:47.017

这是我为此编写的 msbuild 任务的大纲：

```
 public class RestoreDb : Task
    {
        #region RequiredParameters
        [Required]
        public string ServerName
        {
            get
            {
                return m_ServerName;
            }
            set
            ...
        }
        [Required]
        public string DbName
        ...
        public string BackupFileName
        ...
        #endregion
        public override bool Execute()
        {
            try
            {
                SqlConnectionStringBuilder connectionStringBuilder = new SqlConnectionStringBuilder();
                connectionStringBuilder.IntegratedSecurity = true;
                connectionStringBuilder.DataSource = ServerName;
                SqlConnection connection = new SqlConnection(connectionStringBuilder.ToString());
                connection.Open();

                Server server = new Server(new ServerConnection(connection));

                if (server.Databases[DbName] != null)
                {
                    Log.LogMessage("Dropping existing " + DbName + " on " + ServerName);
                    server.Databases[DbName].Drop();
                }
                else
                {
                    Log.LogMessage(DbName + " on " + ServerName + " doesn't exist.");
                }

                Log.LogMessage(MessageImportance.High, "Restoring " + DbName + " on " + ServerName);
                Database newDb = new Database(server, DbName);

                Restore rs = new Restore();
                rs.NoRecovery = false;
                FileInfo fi = new FileInfo(server.Settings.BackupDirectory + "\\" + BackupFileName);
                BackupDeviceItem bdi = new BackupDeviceItem(fi.FullName, DeviceType.File);
                rs.Devices.Add(bdi);
                rs.Database = DbName;
                rs.Action = RestoreActionType.Database;

                rs.SqlRestore(server);
                Log.LogMessage(MessageImportance.High, "Restoring done.");
            }
            catch( Exception exc)
            {
                Log.LogErrorFromException(exc);
            }
            return !Log.HasLoggedErrors;
        }
        private string m_DbName;
        ...
    }
} 
```

用于：

```
<UsingTask AssemblyFile="bin\Release\MyTask.dll" TaskName="RestoreDb" />
    <RestoreDb ServerName="localhost\sql2005" DbName="myDb" BackupFileName="myDb.bak"/> 
```

欢迎任何和所有评论！

简

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-05T18:22:27.260

我使用 MSBuild 扩展包[MSBuild 扩展包](http://msbuildextensionpack.codeplex.com/)来修改配置文件、创建应用程序池，甚至发送电子邮件。

# asp.net - 每次打开解决方案时，Visual Studio 2008 都会尝试转换 Web 部署项目

> ID：419822
> 
> 赞同：1
> 
> 时间：2009-01-07T10:09:27.370
> 
> 标签：asp.net, visual-studio, visual-studio-2008, web-deployment-project

我**在 Visual Studio 2008 中使用 Web 部署项目**。

现在，每次我打开包含 Web 部署的 ASP.NET Web 项目解决方案时，Visual Studio 都会**要求转换项目**（我猜是从 VS 2005 到 2008）。我进行转换并保存，但如果我关闭重新打开解决方案，VS 坚持尝试转换项目。

有谁知道如何解决这个烦人的问题？

更新 - 配置：

*   Visual Studio 2008 专业版（德语）
*   ASP.NET 3.5（VB.NET 作为语言）
*   颠覆/VisualSVN
*   1 个 Web 项目 + 4 个库项目 + 1 个 Web 部署项目（新）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-13T10:49:58.713

我找到了一个解决方案：

*   在 Visual Studio 2008 的解决方案资源管理器中右键单击 Web 部署项目。
*   选择“打开项目文件”
*   将 ToolsVersion 值从“3.5”更改为“4.0”

（.wdproj 文件的 XML）

```
<Project ToolsVersion="3.5" DefaultTargets="Build" ... 
```

进入

```
<Project ToolsVersion="4.0" DefaultTargets="Build" ... 
```

*就这样！*

# business-rules - 用于实施 ERP 和其他企业应用程序的资源？

> ID：419826
> 
> 赞同：6
> 
> 时间：2009-01-07T10:12:30.110
> 
> 标签：business-rules, erp

在开发类似 ERP 的软件或任何其他复杂的业务系统时，您会使用哪些资源来获得最佳实践？

我是开发商，不是会计师，不是采购员，也不是经理。
我确实有工程项目管理经验（非软件相关），并且我在设计、采购、库存管理、销售、制造、质量控制、售后服务等方面的业务流程方面有相当多的经验。

但我的问题是，在开发业务软件时，您总是会遇到缺乏专业知识的领域，我相信对流程的良好理解以及其他人如何解决类似问题对于开发合格的软件是绝对必要的。

那么，是否有任何在线资源具有一些​​关于人们如何在 ERP 系统等中解决和实施业务规则和流程的最佳实践或实践经验集合？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-07T10:55:06.513

我假设您不是指软件的最佳实践。你说的是商业惯例，对吧？

你去哪里？这似乎很明显，但是您必须在某个地方找到领域专家。如果您的公司有任何规模，它们都应该在您的公司内部。如果您不太了解该主题，并且您不太可能成为专家开发人员和 GAAP 专家，那么您需要找到知道的来源。

我认为这是购买与构建决策的正确位置。既然有这么多可以为您做的会计包，为什么还要编写一个会计包？大多数决定需要编写自己的总账的人通常会以“荒谬的”许可成本来证明这一点，但他们无法准确估计设计、实施、测试和维护自己系统的真实成本。购买软件包意味着获得那些开发人员联系的所有人的精炼专业知识。你认为他们也做得很好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-07T12:22:44.963

为了了解“事情是如何运作的”，您首先必须查看客户的内部程序：采购程序就是很好的例子。它们通常有完整的记录，因为采购过程被认为是大多数公司的潜在问题来源（相反，会计程序通常记录不充分，因为它们依赖于官方和强制性规则）。

通过这些程序，您将了解公司使用的所有标准表格、谁做什么、必须保存或归档什么等。这将有助于您在与负责人会面之前了解流程。始终记住，您的应用程序应遵守这些程序，如果程序不存在，该应用程序将事实上成为程序：在这种情况下，您通常有机会 (1) 按照 #duffymo 的建议购买或(2) 按照客户的要求和规格进行构建。在最后一种情况下，我建议您从用户那里收集他们已经使用的不同文档，通常是一些 Word 模板 + 一些 Excel 表格，用于数据跟进。它可能是灵感的主要来源，可以帮助您制定明智的建议......

程序跟进和管理模块（附件、提案草案等）可能是开始使用“类似 ERP”系统的好方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-07-13T19:31:11.440

有 APICS，即[www.apics.org](http://www.apics.org)上的运营管理协会。（“I”代表库存，但范式发生了变化……）许多城市都有一个地方分会定期开会。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-02-02T04:39:14.877

您已经拥有比其他任何人都更了解贵公司业务流程的内部专家。只需与您的会计师、经理、采购员、主管和系统的常规用户交谈即可。他们会告诉您他们需要 ERP 系统来做什么。然后，作为开发人员，您只需在此基础上添加一些小改进，让每个人都开心。

# digital-signature - 对 pdf 进行数字签名

> ID：419830
> 
> 赞同：2
> 
> 时间：2009-01-07T10:15:05.877
> 
> 标签：digital-signature, digital-certificate

我的公司有一个网络文档管理应用程序，我被指派寻找一种使用用户数字证书签署 pdf 文件的方法。

pdf 可以从几 kb 到超过 100Mb，这是通过 Internet 进行的，因此***必须***在 Web 服务器上进行签名。

为此，我构建了一个 activeX 控件，要求用户选择证书，然后使用 WebClient.UploadData 将证书作为字节数组发送到网页。

在网页上，当我尝试签署 pdf 文档时，我收到错误“密钥不存在”。这对我来说并不奇怪，因为当我在选择正确的证书后直接通过 https 连接使用证书时，我会提示输入密钥。activeX 不会发生这种情况。

这就是我从用户那里获得证书的方式：

```
private static X509Certificate2 PickCertificate()
        {
            X509Store store = new X509Store(StoreName.My, StoreLocation.CurrentUser);
            try
            {
                store.Open(OpenFlags.ReadOnly);

                // pick a certificate from the store
                X509Certificate2 cert = X509Certificate2UI.SelectFromCollection(store.Certificates, "Title", "Message", X509SelectionFlag.SingleSelection)[0];

                // show certificate details dialog
                X509Certificate2UI.DisplayCertificate(cert);
                store.Close();
                return cert;
            }
            finally { store.Close(); }
        } 
```

如何要求用户提供我缺少的密钥？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-07T12:17:56.783

您希望用户将其证书的私钥上传到网络服务器，以便它可以签署 PDF？如果是这样，从安全的角度来看，这从根本上被打破了。

我认为您可能错过了公共证书！= 私钥这一点。（我们大多数人都很草率，使用“证书”这个词来指代其中一个（或两个），所以这并不完全令人惊讶）。根据记忆，CryptoAPI 只有一组允许您访问密钥的方法。其中必须有一种“导出为 PFX”的方法，所以如果你真的、真的想要的话，你可以让你的设计工作，但我不建议这样做。（将私钥发送到网络服务器的风险、破坏的不可否认性等）。

如果您确实必须在服务器上进行签名[我不太了解您的论点，签名不应该向上传添加太多数据]，那么您可能应该考虑多层架构和密钥托管机制。这样你至少可以最小化一些安全问题（但你仍然会失去不可否认性......并引入其他风险。这里没有免费的午餐）。

所以...您可能需要考虑重新构建您的应用程序，以便在上传 PDF 文件之前，在客户端（在您的 ActiveX 控件中）发生 PDF 签名。我想您将需要一个 3rd-party 库来执行[此 SO 线程](https://stackoverflow.com/questions/378247/how-to-digitally-sign-pdf-files)中讨论的签名步骤。

# server-hardware - 拥有服务器硬件是否过度？

> ID：419832
> 
> 赞同：7
> 
> 时间：2009-01-07T10:15:53.147
> 
> 标签：server-hardware

由于这个社区有大量充满热情的开发人员，我想就此事收集您的意见 - 您认为在家购买和操作实际的服务器硬件来为自己的开发和学习增添趣味是过度还是有利？努力？

早在2003/4跳入开发线时，我就觉得服务器只属于数据中心，不相信家用服务器的定价；消费者的计算能力（当时）已经相当强大，并且可以以一小部分成本获得类似规格的个人电脑。我从小就组装了自己的 PC，我认为获得二手组件以构建新 PC 的活动是一件容易的事。为我的开发测试准备一台充当专用 Windows 2003 服务器的 PC 非常简单。但是三年多来，我一直[在真正的服务器上运行](http://icelava.net/mycomputers.aspx)，尽管是低端模型。由于多种因素，我最终处于这种状态。

1.  **稳定**。构建为可以正常协同工作的服务器硬件。经测试可运行服务器操作系统。由于所有这些有趣的意外不兼容实例，我组装在一起的硬件可能会也可能不会工作。不幸的是，我遇到这些情况的次数比我应该的要多，比如必须弄清楚为什么 PC 无法启动，因为我按特定顺序插入了 RAM 模块，或者简单地使用了特定的 DVD 驱动器。我的服务器没有看到一个 BSOD。
2.  **耐用性**。我让我的服务器 24x7 运行，并且多年来（谢天谢地）没有遇到任何服务器硬件故障。相比之下，我的电脑只是被快速故障率所诅咒。甚至我的供应商购买的笔记本电脑最终也会以一种或另一种方式出现有趣的问题（尤其是电源装置）。
3.  **保修**。我可能对个别 PC 部件有保修，但对整个计算机的保修对*我自己*不利。如果有什么事情失败了，我自己就是呼救的人。并称自己为我做了几次。但是，对于服务器，我致电技术支持并让他们更换零件。
4.  **容量**。虚拟化确实是一件美妙的事情。使设置单一用途机器变得更容易管理。我直接用 4GB RAM 将我的第一台服务器加载到最大，并愉快地运行各种虚拟机，模拟我需要的多服务器/工作站环境。现在我的新服务器具有 24GB RAM 的容量，可以支持我正在尝试试验的更大场景（例如 AD 域、BizTalk 服务器组、TFS 组等）。

总而言之，对于胡思乱想的 DIY，我花在解决硬件问题上的时间比解决实际开发问题的时间要多。当我花钱购买真正的服务器时，我生活中的硬件问题立即减少了。如果我能找到适合我的开发需求的配置，我可能也会购买供应商构建的工作站。

现在，我的一些对工作充满热情的技术朋友也在家里运行自己的服务器。问题是，大多数其他人/同事对我实际上会为这类机器花钱感到相当惊讶。有些人会把我归类为疯子。我真的过火了吗？

**更新 - 澄清服务器使用情况**

基本服务器 (Windows Server 2008) 提供基本的 IIS 7/ASP.NET、SQL Server 2008 和 Subversion 服务。但它发挥的最大作用是**在 Hyper-V 中托管各种虚拟机**。我不是一个只被告知针对单个数据库编写应用程序代码并将其检入某个版本控制存储库然后回家而不用担心应用程序和实现在生产环境中如何工作的开发人员。作为解决方案集成商，我必须了解客户/客户环境，并考虑包括*基础设施和部署问题*在内的全局解决方案。软件应用程序开发虽然是我的主要角色，但只是解决方案的一部分。

我经常发现自己必须进行试验并发现某些建议或方法是否适用于给定环境，并且必须准备虚拟服务器，例如域（控制器）森林、Web 服务器、数据库服务器、BizTalk 服务器组、Team Foundation 服务器等来进行我的分析并巩固我的建议。这些虚拟机作为我的个人 POC 工作。我面临的场景越来越大，如果没有允许我虚拟化和模拟它们的基础平台，我肯定无法学习如何处理这些情况。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-07T10:36:44.117

我认为熟悉服务器硬件会让你成为更全面的技术专家，所以去吧。您通常不会将“适当”服务器的某些元素构建到家庭构建系统中，例如热插拔驱动器和 PSU、远程访问卡（例如[Dell DRAC](http://en.wikipedia.org/wiki/Dell_DRAC)）等。

即使服务器管理员不是您的主要工作职能，随着您的职业发展，您可能会越来越多地参与购买硬件和评估供应商的报价。额外的知识当然可以在那里派上用场。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-07T11:13:15.167

如果您只是想学习，而且作为程序员而不是网络或服务器工程师，我同意花在专业服务器设置上的费用是多余的。在最初的几周内，您将完成新奇事物，然后它会像搁浅的鲸鱼一样坐在您的腿上。

您是否有任何安装了服务器软件的普通计算机无法满足的特定需求？

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-07T11:37:36.943

运行数据中心级别的硬件将是最重要的——你不需要热插拔驱动器之类的东西，它们会浪费钱，但如果你认真对待自己的开发工作，那么肯定会运行低端中小企业级服务器是一个很好的举措，它为您提供了安全性和便利性。

我自己经营自己的[咨询/开发](https://stackoverflow.com/questions/166588/how-to-become-a-programmer-for-hire#167326)（公认的答案）业务，并经营一个小型网络来支持它。我运行具有 250GB RAID、4Gb RAM、Windows 2003 的 HP SME 服务器。它在 24/7 运行，并且可以完成您期望服务器在任何小型企业中执行的所有操作。主网通过优质的中小企业级ADSL账号接入互联网。

此外，我在类似的硬件上运行 Linux 服务器，该服务器通过单独的电话线上的另一个 ADSL 帐户（只是一个基本的廉价商业帐户）连接到 Internet。这为我提供了在 ADSL 问题的情况下的备份（偶尔会发生一个故障而另一个保持正常），但也意味着我可以运行一个低级别的 Internet 服务器，以便在专用和隔离的线路上向客户端显示内容 - 显然不是生产质量但足以进行测试（我有几个专用服务器共同托管在其他地方运行客户端站点，但它们显然不能广泛用于非生产目的，并且拥有内部硬件意味着我可以更多地调整配置容易地）

这实际上是一个调整您对硬件的要求以支持它的问题 - 就像实际上将任何硬件部署到客户端一样。作为开发人员，您需要与任何小型企业一样的安全性和便利性，但同样需要良好的投资回报率——例如，如果您可以购买一台 30 英寸的显示器，那么花 1000 美元购买额外的服务器镀金是没有意义的。假装你有一个关键但理解的商业伙伴（乔尔级别的程序员专注），你必须证明你的支出是合理的，并且对你自己的需要诚实——稍微放纵一下。

编辑以响应阅读其他一些关于不需要服务器硬件用于您自己的个人开发用途的评论：您必须要问的是，当您的替代方案遇到硬件故障时会发生什么？我建议拥有一台单独的服务器使您更有可能更快地从灾难性故障中恢复：无论如何这种情况发生的频率可能会降低，您更有可能进行备份，并且恢复可能会更简单。

即使你只是在搞乱个人发展，失去工作并不得不恢复复杂的配置，这既需要时间，也是令人沮丧的痛苦。你应该以合理的 $/h 费率来评估你自己的时间，即使它只是有趣的东西，并将其与基本服务器和相关备份机制的成本相结合——硬件价格处于它们的水平，这真的是不费吹灰之力。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-07T10:29:02.510

我认为如果你是一名程序员，你应该专注于编程。拥有一个实际的实时网络服务器并不容易或便宜。

想想看，你必须有一个良好的网络连接和良好的上传速度，一台好的机器专门用来作为服务器。甚至不打算谈论电力成本或制冷系统，因为您需要将服务器放置在您不使用的房间中（因为当您尝试休息时听到这些通风口工作只是很烦人）。

有数百家公司几乎免费提供这项服务，当我做出这个决定时，我只是选择其中一家而从未三思而后行。

不要误会我的意思，我在家里确实有一个网络服务器，只是为了学习如何设置一个，这很有趣而且很有回报，但我永远无法提供专业的服务器，因为它需要 24/7 全天候关注以防止停机。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-07T10:53:00.543

我认为任何 ROI（投资回报率）高于 1.1 的都可以。在您的具体情况下，我认为在短期内您会毫无顾忌地松散资金，但从长远来看，您可能会获得其他附加价值。您可以选择比普通硬件便宜一些的价格来平衡成本。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-07T10:53:31.027

我曾经操作自己的 Web 服务器，它建立在 Compaq 服务器级硬件上。但是，这些天来，我不想对这样一个机器野兽负责。该服务器的功率消耗非常大，它产生的噪音和热量也是如此。忽略提供电力和冷却的财务问题，一个简单的事实是（对我而言）不值得付出努力。我不需要*做*任何需要服务器级硬件的事情。事实上，在我的 MacBook 上的虚拟机上，没有什么我需要做的事情是无法在家里完成的。

YMMV，当然。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-07T11:01:35.487

这实际上取决于您的特定需求。

一般来说，拥有自己的*开发*和学习服务器可能被认为是多余的。

事实上，对于典型的开发，我相信您甚至可以在[VirtualBox](http://www.virtualbox.org/)或任何您喜欢的开发桌面工作站上放置一个虚拟服务器。无需单独的物理 PC 或服务器。

但是，如果您确实需要它们，那么完成工作就足够了，对吗？当然，“服务器”-服务器通常更适合这项工作。如果您能负担得起价格差异并且对您有意义，为什么不呢？

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-07T11:08:23.197

我同意 Gnudiff 的观点，为什么您需要具有坚如磐石的 24x7 可用性的服务器硬件来在家中玩耍？是的，有一些技术性可能对学习有用，但在工作中拿一个旧盒子并摆弄它可能更容易。然后可以将它保存在不碍事的某个地方，并且不会花费您任何费用。

在这个网站、Google Reader 和 Facebook 之间，我没有足够的时间陪伴我的妻子，更不用说在家里管理自己的服务器了！

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-07T11:56:47.670

除非您需要在该硬件方面有经验，否则我认为这太过分了。在过去的 13 年里，我至少在家里运行了一台服务器。我建立/升级我自己的电脑。我支持我的家人（5 台工作站和 5 台笔记本电脑）的时间更长。我使用的服务器是由升级遗留下来的部件构建的。我目前有 3 个服务器配置。我有用于家庭文件服务器和 IIS Web 服务器的主服务器（AMD 3800 X2 w/4 gig）。它还在虚拟机中运行 Ubuntu。这个盒子处理我们所有的备份。我有一个用于 Windows Media Center 的第二个盒子（AMD 2600 w/4 gig），作为我的主服务器的备份，它将我的主服务器的内容复制到它的本地存储中。我的第三个盒子（AMD 3200 w/4 gig）是我的播放盒，目前运行的是 Windows Server 2008。

在 13 年（24x7 全天候运行）中，我遇到过两次与电源有关的硬件故障（它们发生在断电后）、网卡和主板。我有一个硬盘故障（它刚刚开始出现很多错误/重试，我没有丢失任何数据）。主板故障后，我买了一个便宜的 UPS。然后，当我添加第三台服务器时，我添加了第二台。

我用过的剩余硬件非常可靠。我在硬件兼容性方面遇到的唯一问题是康柏上的 Ubuntu。在那一集之后，我开始只使用通用硬件。我建议每个人至少拥有一台服务器来集中定位需要备份的内容。

我所有的服务器都已经退役了，都转给了亲戚用作第二或第三台 PC。我运行一台服务器大约 5 年，两台服务器大约 6 年，过去 2 年我一直运行三台服务器。我最古老的服务器盒 AMD 2600 作为我妻子的 PC 使用了 3 年，并且已经作为服务器使用了 2 年。

**更新**

我以前从未真正考虑过，但我突然意识到我拥有如此可靠的硬件的原因是因为我使用的硬件已经过几年的测试。除了少数硬盘驱动器外，我的所有硬件在用作服务器之前都已被证明是可靠的。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-07T11:12:00.800

我的工作站是 Core 2 Quad，配备 8GB RAM 和运行 Vista x64 的 RAID 0 和 RAID 1 硬盘。它可以很好地满足我的所有需求。我认为我不需要单独的服务器。投资您的工作站，忘记花费大量时间配置东西！

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-07T11:13:05.620

我认为在以下两个极端之间有一系列选择：

*   从头开始构建您自己的 PC（付出很多努力 - 您可能是第一个在特定组件组合上运行操作系统的人）
*   从主要制造商处购买服务器级硬件

对于您描述的需求，高端联想台式机可能会提供您所需的可靠性和弹性，远低于服务器级硬件。

当然，具有讽刺意味的是，*真正*的大型服务公司（谷歌、亚马逊等）正在*减少*在单个服务器上的支出，购买更多服务器，并编写绕过故障节点的软件。

# java - 如何在略有不同的 jar 列表上运行测试用例？

> ID：419833
> 
> 赞同：0
> 
> 时间：2009-01-07T10:16:36.437
> 
> 标签：java, junit, jar

我有一个 jar 文件列表，所有文件都包含同一系统的略有不同的版本。

我想在每个 jar 文件上执行一组测试用例，同时能够获得每个 jar 的结果（通过 RunListener 或类似的东西）。

我对隐含的类加载问题有点困惑。

我怎样才能很好地做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-07T11:08:09.560

如果您使用的是 ant，则 JUnit 任务采用类路径。

```
<target name="test">
  <junit ...">
    <classpath>
      <pathelement path="${test.jar.path}" />
    </classpath>
    ...
  </junit>
</target> 
```

您可以使用 antcall 任务使用不同的 test.jar.path 属性值重复调用您的测试目标。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-07T10:40:54.593

如果 jar 保持相同的界面，那么您所要做的就是使用稍微不同的类路径运行每个测试 - 每次使用来自另一个版本的 jar。

如果您使用 Eclipse JUnit 集成，只需创建 N 个运行配置，在类路径选项卡中的每个配置中指定所需的 jar。

如果您想以编程方式执行此操作，那么我建议您从空类路径开始并使用[URLClassLoader](http://java.sun.com/j2se/1.4.2/docs/api/java/net/URLClassLoader.html)，每次都给它一组不同的 jar。

像这样的东西：

```
URLClassloader ucl = new URLClassLoader( list of jars from version1 );
TestCase tc = ucl.loadClass("Your Test Case").newInstance();
tc.runTest();

ucl = new URLClassLoader( list of jars from version2 );
TestCase tc = ucl.loadClass("Your Test Case").newInstance();
tc.runTest(); 
```

# language-agnostic - 函数级常量 - 在函数顶部声明？

> ID：419839
> 
> 赞同：1
> 
> 时间：2009-01-07T10:29:25.207
> 
> 标签：language-agnostic, constants

我有一个常量值，我只打算在我的代码库中使用一次。我将使用`const`声明来声明它。

如果这是一个函数级变量，我会在使用时声明它，但是使用常量这样做似乎会使我的函数变得混乱。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-07T10:36:09.157

使用常量而不是硬编码值的两个原因是为了可读性，因此以后可以很容易地找到和更改它，对吧？所以在以后最容易找到的地方声明它。通常我发现这是在函数、类或文件的开头——同样，无论范围是什么都有意义。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-07T10:35:48.160

我将常量视为一种配置。如果它们可以更改，它们将成为应用程序属性，如果不能，我将它们放在类的顶部，即使是函数级常量也将在其中使用它们。

这样您就可以打开文件并在一个列表中查看它们

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-07T10:38:41.867

我通常将它们声明为尽可能靠近我将使用它们的位置。

原因是当我在浏览其他人的代码时，必须在一个文件中上下跳转才能理解发生了什么，这非常不方便。所以我在自己写代码的时候尽量让别人轻松。

对于函数顶部的小（ish）函数可以增加可读性（从而提高其他人的可理解性），因此这条规则远非一成不变。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-07T11:03:51.440

我把它们放在文件的开头，把它们当作整个班级的配置。同样，在只用鼠标悬停编码时，无论您闪亮的 IDE 位于何处，都会告诉您它的价值。

如果它还没有引入你的常量，编码它，尝试你想要的任何东西，然后当你完成重构，并使它成为一个常量，它就不是你不断改变的东西。

# asp.net-mvc - 从一个控制器动作发布到另一个控制器动作（不重定向）

> ID：419840
> 
> 赞同：2
> 
> 时间：2009-01-07T10:30:39.980
> 
> 标签：asp.net-mvc, forms, post

我有一个动作，如果它满足某些条件，我需要转发到另一个动作，但是在传递到下一个动作时我无法保留表单数据。

接收动作接受一个 FormCollection，发送动作

目前，我正在做一个 return RedirectToAction("action","controller", form)。而且我可以确定表单变量在重定向之前有键（form.HasKeys() = true）。

但是，当操作被触发时，FormCollection 为空（form.HasKeys() = false）。

有任何想法吗？是否有我缺少的“PostToAction”方法？

仅供参考：我正在使用 ASP.NET MVC Beta。非常感谢！

**编辑：**对于那些有这个问题的人，请查看[PRG Pattern](http://en.wikipedia.org/wiki/Post/Redirect/Get)。这是我想要做的实际术语，它也启用了漂亮的 url。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-07T10:50:15.430

我会重构这两个控制器并将公共代码放入帮助程序或公共基类中。这样，两个控制器中的操作可以委托给公共代码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-07T11:19:35.683

当调用 RedirectToAction 时，它将进行 HTTP 重定向，并将 GET 到另一个操作 URL。如果您需要重用来自另一个控制器的代码，我会按照 ewalshe 的建议进行操作，将 common 移至 BaseController 或业务服务，并将这两个操作委托给它。

此链接可能会有所帮助：

*   [ASP.NET MVC 技巧 #6 – 提交表单后调用 RedirectToAction](http://stephenwalther.com/blog/archive/2008/06/20/asp-net-mvc-tip-6-call-redirecttoaction-after-submitting-a-form.aspx)
*   [如何在 ASP.NET MVC (Preview 4) 中 RedirectToAction 而不会丢失请求数据](https://stackoverflow.com/questions/1936/how-to-redirecttoaction-in-aspnet-mvc-preview-4-without-losing-request-data)

# php - 最好使用私有方法还是受保护方法？

> ID：419844
> 
> 赞同：36
> 
> 时间：2009-01-07T10:35:13.747
> 
> 标签：php, oop

在我的许多 PHP 项目中，我最终得到了具有我不打算扩展的非公共函数的类。

最好将这些声明为受保护的还是私有的？

我可以看到两种方式的论点 - 将它们设为私有是一种更为保守的方法，但可以争辩说，如果我希望扩展该方法并且可以清楚地说明哪些方法由基类扩展，它们可以在以后受到保护。

另一方面，是否使用 private 以某种方式反社会，因为它阻碍了理论上的未来开发人员在不修改的情况下扩展我的代码？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-01-07T10:51:33.103

我的直觉是将它们保密，直到您需要它们不公开为止。

有人认为（遗憾的是我放错了链接）将方法设为私有是反社会的，就像将它们设为“最终”一样，因为它对人们如何使用您的代码是相当独裁的。

但是，我不相信，并且同意您应该只公开您真正需要的内容。例外情况是库或工具包，您会期望用户希望以您从未预见到的方式（在一般意义上）扩展您的代码。在这种情况下，保护精心选择的方法可以被视为提供弹性点。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-01-07T10:39:19.337

我认为你应该只在需要时公开你需要的东西。这使得对变更的影响评估更容易。即如果一个方法是私有的，你**知道**如果你改变它，影响将是最小的。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-07T11:20:22.297

就个人而言，我认为尽可能多地进行私有化是合适的。我只是查看每个方法并问自己是否希望派生类能够调用它。使所有内容都受到保护，这为错误调用方法打开了大门。

我想这可以归结为“除非特别允许，否则一切都禁止”或“除非特别禁止，否则一切都允许”这样的问题。

另一个因素是，在未来的版本中保护私有方法很容易。一旦方法受到保护，几乎不可能将其私有化，因为您永远不知道您使哪些其他代码无效。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-01-07T10:53:28.187

如果您打算为继承构建一个类，则必须以这种方式设计它，即保护那些允许其他开发人员按照您的意图更改类的行为的方法。简单地保护所有方法并不是一个很好的设计。请记住，所有受保护的方法都成为公共 API 的一部分，因此如果您稍后更改内容，您将破坏其他人的代码。

一般来说，如果你不是为继承而设计，你应该禁止它。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-01-09T21:44:53.167

我一般会避免`private`。我的推理是，如果你在两个类之间有继承关系，并且有私有成员，那么它是一个非常强烈的指示，你应该将私有部分分解为一个单独的对象。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-01-07T11:19:36.557

好吧，private 关键字是有目的的。如果您不希望变量弄乱您继承的类（或者您不希望人们在继承的类中使用它们），那么您为什么还要考虑让它们受到保护呢？

不要让别人碰你的私处:)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-07T10:42:09.597

我会将这些方法声明为私有的。它清楚地表明它们不是公共 API 的一部分。

不要担心将来会发生什么。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-07T10:49:14.683

如果您实现的函数是特定于类的并且不应该在该类的上下文之外使用，那么不要允许它被继承。例如，如果我们有一个动物层次结构，其中一只动物只有它们非常独特的东西，比如乌龟一样说“layEggsInSand()”。这可能是乌龟（乌龟，无论如何！）完全独特的，因此不应由任何其他动物继承。在这种情况下，我们会说它是私有的。另一方面，如果函数是“walk()”，那么它不是唯一的，因此它应该是可继承的。

一开始似乎很模糊，因为大多数时候事物应该被继承，但在极少数情况下它们不应该被继承，因为它们是该类型所独有的。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-07-26T11:08:52.143

如前所述，如果您稍后要扩展一个类，那么您可以随时更改它。

但是，如果您可以避免使用继承，您应该这样做。如果可能的话，在设计时最好使用其他模式。

基本上要做的事情是有利于组合而不是继承和程序到接口，而不是实现。

如果您让类只具有一个严格定义的目的，那么您可以组合对象而不是让它们相互继承。如果您使用接口而不是继承，您很可能会定义小而有效的接口。然后你会看到继承会减少，因此对“受保护”的需求也会减少。

例子

```
interface sound {
 public function makeSound();
}

class bark implements sound{
 public function makeSound() {
   return "Bark!!!";  
 }
}

class meow implements sound{
 public function makeSound() {
   return "Meowmeow!!!";  
 }
}

class fourLeggedAnimal {
  private $sound;

  public function fourLeggedAnimal($sound){
    $this->sound = $sound;
  }

  public function eat(){
    echo $this->sound->makeSound();
  }

}

$cat = new fourLeggedAnimal(new meow());
$dog = new fourLeggedAnimal(new bark()); 
```

我知道这远非一个完美的例子。但它说明了该技术，您可以通过多种方式使用它。例如，您可以将其与不同的创建模式结合起来构建猫和狗，必须知道猫是否吠叫或喵喵叫可能不是那么明智。但无论如何......它不同于必须创建一个基类然后扩展它与猫和狗并驾齐驱，因此不得不使“声音”方法受到保护或凌驾于公共吃法之上。

/彼得

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2014-05-02T00:19:13.770

我通常在一些非常特定的场合使用私有，其中方法/变量非常内部，不应该被任何其他子类读取或写入（所以基本上几乎从不）。我使用私有变量的唯一情况是例如：

```
final public function init():void
{
    if(!_initialized)
    {
        _init();
        _initialized = true;
    }

}

protected function _init():void
{
    // specific code.
} 
```

在大多数其他情况下，方法和变量应该对继承有用，至少作为读取函数。因为大多数时候当我使用别人制作的代码时，当这段代码使用私有的东西时，它总是很麻烦：

*   想要的行为尚未实现或完成

*   我不能使用方法，因为它是私有的

*   我无法更改此方法，因为它是私有的

*   如果它受到保护（或者如果我将其更改为受保护），那么我无法重新编写代码（也就是在两条其他指令之间添加行为，因为此代码的一部分使用私有方法或变量......

    = 最后，您几乎将所有访问器更改为受保护以获得扩展类的能力！

因此，如果你认为这个类可以扩展，除了非常特殊的情况外，所有的东西都喜欢受保护（如果你认为一个特定的方法应该只被使用但不应该改变，使用 final protected）。

如果你认为这个类在任何情况下都不应该被扩展：使用 private。

# asp.net - Web 应用程序编译错误 - ASP.NET 参考

> ID：419849
> 
> 赞同：3
> 
> 时间：2009-01-07T10:37:07.953
> 
> 标签：asp.net, assemblies, reference

我当前的 Web 应用程序在本地和现场运行良好，我目前正在使用的是使用 Visual Studio 选项“添加 Web 部署项目”编译我的 Web 应用程序，因此后面的所有代码都被编译成 DLL。

有一个特定的构建错误我无法摆脱

错误 50 名称空间“ASP”中不存在类型或名称空间名称“usercontrols_calendarcell_ascx”（您是否缺少程序集引用？） c:\page.ascx.cs 30 1 test_deploy

实际的代码行如下：

```
protected ASP.usercontrols_calendarcell_ascx[] calendarCells; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-20T07:52:11.240

问题在于命名空间 ASP 是一个“伪”命名空间，在编译时无法引用。

我找到的解决方案是将当前命名空间实际集成到用户控件定义中。我根据您的命名约定调整了元素的名称，但我对您使用的命名空间一无所知。因此，我只是将其命名为“Project.NameSpace”。

1.  *在 calendarcell.ascx 文件中：*

    <%@ Control Language="C#" AutoEventWireup="true" Codefile="calendarcell.ascx.cs" Inherits="Project.NameSpace.usercontrols_calendarcell" %>

2.  *在 calendarcell.ascx.cs 文件中：*

    命名空间 Project.NameSpace
    {
    公共部分类 usercontrols_calendarcell ： System.Web.UI.UserControl
    {

3.  *在 page.ascx.cs 文件中：*

    使用项目名称空间；

希望这可以帮助。就我而言，它完美地做到了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-13T08:35:11.537

您可以将页面上使用的 Control 属性公开给某个接口（例如 ICalendarCell）并将其放置在 App_Code 中。为您的控件实现接口并在 .cs 文件中使用接口。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-07T11:02:28.933

我在这里猜测，但看起来您的 calendarcell 用户控件没有正确编译。

发生这种情况时，您的部署项目可能正在使用不包含该类的旧 dll。

尝试编译你的项目，当你能够做到这一点且没有错误时，编译部署项目。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-07T11:16:44.397

您还需要确保编译 page.ascx.designer.cs。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-07T11:41:22.863

您是否在 aspx 页面中正确引用了它？

我是说这部分

（应该是您的 aspx 页面中的类似标签，并且 SRC 应该是指日历控件所在的位置。

# java - Java：接收多部分 HTTP 响应

> ID：419850
> 
> 赞同：10
> 
> 时间：2009-01-07T10:37:12.277
> 
> 标签：java, http, multipart

我正在编写一个 Java 客户端应用程序来接收来自 IP 摄像机的实时 M-JPEG 视频。摄像头将视频作为无限的多部分 HTTP 消息发送，其中每个部分都是一个 JPEG 帧。我需要在这些帧到达时对其进行处理，因此我希望有一种方法可以发出 HTTP 请求，在接收到每个消息部分/视频帧时异步触发事件。

有人知道任何可以做到这一点的图书馆吗？我可以在 Google 上找到的所有示例都不起作用，因为它们使用阻塞调用，只解析响应并在整个响应完成后将其分解为多个部分（这显然不适用于无休止的响应）。

我意识到我可以通过搜索消息边界在数据到达时手动将其分解为多个部分，但感觉就像我在重新发明轮子一样。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-08T19:18:05.687

这个项目： http: [//fmj-sf.net](http://fmj-sf.net/)，确实有一个类来解析 multipart/x-mixed-replace 响应： http: [//fmj-sf.net/doc/fmj/net/sf/fmj/media/解析器/MultipartMixedReplaceParser.html](http://fmj-sf.net/doc/fmj/net/sf/fmj/media/parser/MultipartMixedReplaceParser.html)

搜索谷歌代码：multipart/x-mixed-replace lang:java

我发现了一些其他示例，例如：[http ://www.google.com/codesearch?as_q=multipart%2Fx-mixed-replace&btnG=Search+Code&hl=en&as_lang=java&as_license_restrict=i&as_license=&as_package=&as_filename=&as_case=](http://www.google.com/codesearch?as_q=multipart%2Fx-mixed-replace&btnG=Search+Code&hl=en&as_lang=java&as_license_restrict=i&as_license=&as_package=&as_filename=&as_case=)

[http://www.google.com/codesearch/p?hl=en#FCmBlvKk1MA/cambozola-0.50/src/com/charliemouse/cambozola/shared/CamStream.java&q=multipart/x-mixed-replace%20lang:java](http://www.google.com/codesearch/p?hl=en#FCmBlvKk1MA/cambozola-0.50/src/com/charliemouse/cambozola/shared/CamStream.java&q=multipart/x-mixed-replace%20lang:java)

[http://www.google.com/codesearch/p?hl=en#Xnnd-VJLMBY/src/Grabber.java&q=multipart/x-mixed-replace%20lang:java](http://www.google.com/codesearch/p?hl=en#Xnnd-VJLMBY/src/Grabber.java&q=multipart/x-mixed-replace%20lang:java)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-08T15:42:28.790

试试 Apache Commons 的 HttpClient。源代码有几个类显示如何以流方式读取多部分。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-05-04T21:34:35.920

我已经为我的项目[Sceye-Fi](http://code.google.com/p/sceye-fi/)编写了处理多部分请求的类，Sceye-Fi是一个 HTTP 服务器，它使用`com.sun.net.httpserver`java 6 附带的类来接收来自[Eye-Fi](http://www.eye.fi)卡的照片上传。从理论上讲，没有什么可以阻止它处理无休止的多部分请求。希望它会有所帮助。

# mysql - 使用 ActiveRecord 进行 MySQL 分区

> ID：419857
> 
> 赞同：2
> 
> 时间：2009-01-07T10:40:12.427
> 
> 标签：mysql, ruby-on-rails, database, database-design, activerecord

我想利用 MySQL 5.1 中的新分区，但使用标准的 ActiveRecord 模型。我遇到的问题是要使用分区表上的主键必须包含分区函数中使用的列。（[http://dev.mysql.com/doc/refman/5.1/en/partitioning-limitations-partitioning-keys-unique-keys.html](http://dev.mysql.com/doc/refman/5.1/en/partitioning-limitations-partitioning-keys-unique-keys.html)）

现在，我想要一个自动递增的“id”字段（通常用作 Rails 中的主键），但我想使用另一列进行分区，在本例中为“task_id”。至关重要的是，我不想在我的 Rails 应用程序中使用复合主键。我的问题是这样的：

如果我按如下方式设置表：

```
"CREATE TABLE `annotations` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `task_id` int(11) DEFAULT NULL,
  `user_id` int(11) DEFAULT NULL,
  `value` text,
  `created_at` datetime DEFAULT NULL,
  `updated_at` datetime DEFAULT NULL,
  PRIMARY KEY (`id`, `task_id`),
  KEY `index_annotations_on_task_id` (`task_id`),
  KEY `index_annotations_on_user_id` (`user_id`)
) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8
PARTITION BY RANGE(task_id)(
PARTITION 1_to_5 VALUES LESS THAN (6),
PARTITION 6_to_10 VALUES LESS THAN (11),
PARTITION 11_to_15 VALUES LESS THAN (16))" 
```

我的主键由 'id' 和 'task_id' 列组成，并且我没有对 ActiveRecord 模型做任何特别的事情，我是否会为将来的任何头痛做好准备？

基本上，我正在创建一个基于两列的主键表，但没有告诉 ActiveRecord 第二列，因为我仍然有一个自动递增的 id 字段 - 任何人都可以看到这种方法有什么问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-07T19:37:05.413

我相信您所描述的，创建 ActiveRecord 模型然后直接在 MySQL 中更改它会起作用。可能的缺点是 Rails 不会知道“task_id”，当然也不会在查询中包含它。问题是分区的主要优点是查询优化器会看到查询包含“task_id = 7”并且知道查询只需要在第二个分区中运行。

您仍然应该看到一些优势，因为连接（尤其是来自任务表的连接）将包含此键并且查询优化器可以做正确的事情。

Rails / Active Record 也有更新每一列的习惯，无论它是否已更改。MySQL 通常会注意到您正在将列更新为它已经存在的值 - 但请注意这一点，因为如果 MySQL 认为它需要将记录从一个分区移动到另一个分区，您的更新将会受到影响。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-07T22:23:35.797

虽然不完全是您正在寻找的东西，但作为替代方案，您见过[DataFabric 吗？](http://github.com/fiveruns/data_fabric/tree/master) 这是一种跨多个数据库分片数据的应用程序级方式。它还为您提供了一种使用主->从复制的方法。就像我说的，与数据库级分区不完全相同，但似乎更容易实现。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-08T09:41:50.093

好的，谢谢你的意见。是的，我一直在研究 DataFabric，它看起来有一些非常有用的功能，可用于分片和复制数据库。无论如何，感谢您的意见，在做出决定之前，我将不得不阅读更多内容。

# java - 如何深度复制不规则的二维数组

> ID：419858
> 
> 赞同：5
> 
> 时间：2009-01-07T10:40:31.347
> 
> 标签：java, arrays, deep-copy, multidimensional-array

如何在 Java 中深度复制形状不规则的二维数组？

IE。

```
int[][] nums =  {{5},
                 {9,4},
                 {1,7,8},
                 {8,3,2,10}} 
```

`Arrays.arrayCopy()`由于某种原因我无法使用（版本控制？）

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-07T10:54:10.243

```
int[][] copy = new int[nums.length][];

for (int i = 0; i < nums.length; i++) {
    copy[i] = new int[nums[i].length];

    for (int j = 0; j < nums[i].length; j++) {
        copy[i][j] = nums[i][j];
    }
} 
```

您可以用 System.arraycopy() 或 Arrays.copyOf() 替换第二个循环。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-07T11:04:05.077

我在 Eclipse 中编写了这个，对其进行了测试，回来后发现 João 以几乎完全相同的解决方案击败了我。我赞成他，但这是我的比较。我想看看人们选择做不同的微小细节是有启发性的。

```
private static int[][] copy2d(int[][] nums) {
    int[][] copy = new int[nums.length][];

    for (int i = 0; i < copy.length; i++) {
        int[] member = new int[nums[i].length];
        System.arraycopy(nums[i], 0, member, 0, nums[i].length);
        copy[i] = member;
    }

    return copy;
} 
```

为了获得额外的荣誉，请尝试编写一个复制 n 维数组的数组，其中 n 是任意的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-07T13:37:31.507

N维深拷贝

```
public class ArrayTest extends TestCase {

    public void testArrays() {
        Object arr = new int[][]{
                {5},
                {9, 4},
                {1, 7, 8},
                {8, 3, 2, 10}
        };

        Object arrCopy = copyNd(arr);
        int height = Array.getLength(arr);
        for (int r = 0; r < height; r++) {
            Object rowOrigonal = Array.get(arr, r);
            Object rowCopy = Array.get(arrCopy, r);
            int width = Array.getLength(rowOrigonal);
            for (int c = 0; c < width; c++) {
                assertTrue(rowOrigonal.getClass().isArray());
                assertTrue(rowCopy.getClass().isArray());
                assertEquals(Array.get(rowOrigonal, c), Array.get(rowCopy, c));
                System.out.println(Array.get(rowOrigonal, c) + ":" + Array.get(rowCopy, c));
            }
        }
    }

    public static Object copyNd(Object arr) {
        if (arr.getClass().isArray()) {
            int innerArrayLength = Array.getLength(arr);
            Class component = arr.getClass().getComponentType();
            Object newInnerArray = Array.newInstance(component, innerArrayLength);
            //copy each elem of the array
            for (int i = 0; i < innerArrayLength; i++) {
                Object elem = copyNd(Array.get(arr, i));
                Array.set(newInnerArray, i, elem);
            }
            return newInnerArray;
        } else {
            return arr;//cant deep copy an opac object??
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-07-07T12:11:05.403

有些人建议`clone()`——为了更加清楚，`clone()`在多维数组上只是一个浅克隆。`original.clone()[0] == original[0]`. 但是（对于原语）您可以使用一维数组来`clone()`代替。`System.arraycopy()`

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-07-13T13:49:13.860

这是一个专门进行深度克隆的`int[][]`。它还允许`int[]`任何`null`.

```
import java.util.*;

public class ArrayDeepCopy {

    static int[][] clone(int[][] arr) {
        final int L = arr.length;
        int[][] clone = new int[L][];
        for (int i = 0; i < clone.length; i++) {
            clone[i] = (arr[i] == null) ? null : arr[i].clone();
        }
        return clone;
    }

    public static void main(String[] args) {
        int[][] a = {
            { 1, },
            { 2, 3, },
            null,
        };
        int[][] b = a.clone();
        System.out.println(a[0] == b[0]); // "true", meaning shallow as expected!

        b = clone(a); // this is deep clone!
        System.out.println(Arrays.deepEquals(a, b)); // "true"
        System.out.println(a[0] == b[0]); // "false", no longer shallow!
    }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-08T02:40:16.340

另一个任意nd副本。这很难看，而且由于 Java 的类型系统，您无法将结果转换回您开始使用的数组类型。尽管如此，它仍然有效。就像其他评论说的那样，使用 clone() :)

```
public  void testMultiDimArray()
{
   int[][][] arr = new int[][][] {
           { {5}, {5, 6 }, {3, 3, 1} },
           { {1, 2, 3}, {4, 5 } }
   };

   Object[] dest = (Object[]) deepCopy(arr);
   // System.out.println(Arrays.deepToString(dest));
   assertTrue(Arrays.deepEquals(arr, dest));
}

public static Object deepCopy(Object src)
{
    int srcLength = Array.getLength(src);
    Class srcComponentType = src.getClass().getComponentType();

    Object dest = Array.newInstance(srcComponentType, srcLength);

    if (srcComponentType.isArray())
    {
        for (int i = 0; i < Array.getLength(src); i++)
            Array.set(dest, i, deepCopy(Array.get(src, i)));
    }
    else
    {
        System.arraycopy(src, 0, dest, 0, srcLength);
    }

    return dest;
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-07-13T13:31:36.540

这是复制二维数组的一种简单方便的方法（与 DEEP 复制兼容）：

```
public static char[][] cloneArray(char[][] array){
 char[][] copy = new char[array.length][];
 for(int i = 0 ; i < array.length ; i++){
  System.arraycopy(array[i], 0, copy[i] = new char[array[i].length], 0, array[i].length);
 }
 return copy;
} 
```

请注意，您必须将数组类型更改为其他任何类型，例如 int

# xcode - 从终端打开一个 iPhone 应用程序

> ID：419859
> 
> 赞同：2
> 
> 时间：2009-01-07T10:40:49.913
> 
> 标签：xcode, terminal

是否可以从终端打开 iPhone 应用程序或 Xcode 项目？我已经尝试过：

`open /path/to/project.app`

但这会返回警告并在启动模拟器时由于图像加载错误而意外退出。有没有人有什么建议？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-07T11:29:12.437

您无法从终端启动 iPhone 应用程序。当您构建您的 Xcode 项目时，它所做的部分工作是将应用程序“安装”到 iPhone 模拟器中，就像在真实环境中一样。例如，如果您删除您的 Xcode 项目和所有文件，然后运行模拟器，您仍然会在那里找到您的应用程序。它旨在尽可能地模拟真实环境。但是，您可以`xcodebuild`从终端使用来构建和更新您的项目文件，然后自己运行模拟器应用程序。

对于常规的 Mac OS X 应用程序，您可以从终端运行它们，但您必须记住 project.app 只是一个目录包装器，Finder 将其伪装成用户的单文件应用程序。您的实际可执行文件位于`/path/to/project.app/Contents/MacOS/project`. 因此，例如，如果我有一个生成应用程序 Foo.app 的项目，我会从终端启动它：

`$ /path/to/project/Foo.app/Contents/MacOS/Foo`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-07-07T14:33:23.150

借助 idevice，您可以从终端启动 iPhone 应用程序。

[https://stackoverflow.com/a/31271484/4622092](https://stackoverflow.com/a/31271484/4622092)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-11-18T18:02:00.140

可以为此使用工具，例如

```
/usr/bin/instruments -w '<device-UDID>' -t 'Activity Monitor' 'com.example.myApp' 
```

`com.example.myApp`您的应用程序包标识符在哪里。您还需要知道您连接的设备的 UDID（使用 Finder 和选项+单击设备名称下方）。

# c# - IE7文件下载对话框消失

> ID：419868
> 
> 赞同：2
> 
> 时间：2009-01-07T10:44:36.533
> 
> 标签：c#, asp.net, .net-3.5, internet-explorer-7, filedialog

以下代码将无法在安装了最新服务包的 IE7 中正确运行。

```
System.Web.HttpResponse response = System.Web.HttpContext.Current.Response;
response.Clear();
response.AddHeader("Content-Disposition", "attachment;filename=Contacts.xls");
response.ContentType = "application/octet-stream";

System.Text.UnicodeEncoding Encoding = new System.Text.UnicodeEncoding();

byte[] unicodeBytes = {255,254};
int length = 2 + Encoding.GetByteCount(_exportContent); // _exportContent is string.
response.AddHeader("Content-Length", length.ToString());
response.OutputStream.Write(unicodeBytes, 0, 2);
unicodeBytes = Encoding.GetBytes(_exportContent);
response.OutputStream.Write(unicodeBytes, 2, unicodeBytes.Length);
response.End(); 
```

我正在用 js (window.open()) 打开 aspx 页面，并在 Page_Load() 中执行上述代码。

奇怪的是窗口弹出，尝试加载/显示文件对话框，然后你听到弹出窗口被阻止的声音（尽管弹出窗口阻止程序已停用！）。

额外信息：
- XP 和 W2k3（这是一个真正的 Web 服务器，除了 IE7 和 FW 3.5 SP1 和最新的服务包之外没有安装任何其他东西。） - 相同的代码适用于 FW 2.0 - Firefox 没有问题显示文件对话框。

我会很好奇是否有其他人遇到过同样的问题，并且可以提供一个解决方案来让这个东西在 IE7 中工作。

干杯，
迪米

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-07T13:03:13.650

添加一个 Header*明确*告诉 IE缓存文件。如果将文件作为无缓存文件发送，则 IE 存在无法正确保存文件的已知错误。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-09-04T21:44:02.170

我有同样的问题，花了一个小时完全沮丧。像往常一样，微软的 IE 浏览器是所有问题的根源。在其他浏览器中一切正常。解决方案很简单：用户必须通过转到“工具”>“Internet 选项”>“安全”选项卡>“Internet”和/或“本地 Intranet”来调整 IE7 设置，通过单击按钮调整安全设置, '自定义级别...'

转到“下载”节点“>自动提示文件下载”>选中“启用”

这为我的用户修复了它。

希望有帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-03-31T10:01:45.907

在我们的 Intranet 上遇到此问题，自动提示下载对我不起作用（已被选中），但这确实......

工具 -> Internet 选项

在安全选项卡上选择“本地 Intranet”，然后单击站点

单击高级

输入“http://your.url.com”并点击添加

单击关闭->确定->确定

希望这对你也有用；）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-12T17:56:30.617

我仍然无法让对话框不消失。当应用程序访问 [webmethod] 以收集信息以传递到尝试将结果下载到 Excel 的页面时，就会发生这种情况。

```
 Response.Clear();

            Response.ClearHeaders();
            Response.ClearContent();

            Response.Charset = "";
            Response.ContentType = "application/vnd.ms-excel";
            Response.AddHeader("Content-Disposition", "attachment; filename=\"" + fileNameToUse + "\"");
             Response.CacheControl = "Public";

            Response.Write(output);
            Response.Flush();
            Response.Close(); 
```

这似乎也仅在使用 IP 地址 (999.11.1.111\default.aspx ....) 访问网站时才会发生。通过 loacalhost\default.aspx 访问它时有效

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-10T22:49:01.330

要测试安全性是否导致此问题，请将目标设置为 _self。应该会出现 IE 顶部的警告栏。如果这是原因，请检查 IE 安全性。特别是下载部分的提示。

# c# - C#我可以从另一个类中取消一个对象吗

> ID：419878
> 
> 赞同：3
> 
> 时间：2009-01-07T10:50:33.153
> 
> 标签：c#, .net, null

我有一个在一个类中生成的对象

```
public class CreatingClass
{
    public T CreateObject<T>(Dictionary<string, object> parameters) where T : IMyInterface, new()
    {
        ....
    }

    public void DestroyObject(IMyInterface objectToDestroy)
    {
        ....
    }
} 
```

我从客户端类调用此函数，然后有时需要通过创建类通过我的应用程序将其取消。

我可以执行以下操作吗

```
public class ClientClass
{
    MyObject obj;
    CreatingClass creatingClass = new CreatingClass();

    private void AFunctionToCreateMyClass()
    {
        obj = creatingClass.CreateObject<MyClass>(parameters);
    }

    private void AFunctionToDeleteMyObject()
    {
        CreatingClass.DestroyObject(obj);
        Assert.IsNull(obj);//Doesn't fail
    }
} 
```

我曾尝试过 objectToDestroy = null，但认为它不会起作用（而且它没有）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-07T11:11:02.207

请注意，您实际上不能销毁对象；您必须遵守垃圾收集规则。在推送中，您可以检查`IDisposable`并调用 Dispose()，

您可以使用`ref`提供的示例，但我不确定是否有什么意义；使用“obj = null;”清除字段更简单。

用法可能会令人`ref`困惑，因为它适用于*变量*- 即如果你这样做：

```
var tmp = obj;
DestroyObject(ref tmp); 
```

那么`obj`仍将是原始值。除非你有充分的理由，否则我不推荐这种`ref`方法。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-07T10:55:05.500

你想要的是

```
public void DestroyClass(ref IMyInterface objectToDestroy)
{
    ....
    objectToDestroy = null;
} 
```

这会将您的本地引用设置为 null

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-07T10:58:34.713

C#中所有的参数都是传值的，所以如果要修改引用本身，就需要使用`ref`关键字来传递。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-07T11:10:16.937

您在寻找[IDisposable 模式](http://msdn.microsoft.com/en-us/magazine/cc163392.aspx)吗？

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-07T10:57:08.303

[您的“CreatingClass”通常被称为工厂]

不知道为什么你会关心使一个对象无效；只有在删除所有对它的“根”引用后，它才会被垃圾收集。但是，如果您更改为：

```
 public void DestroyClass(ref IMyInterface objectToDestroy)   
 {       
     ....    
     objectToDestroy = null;
 } 
```

并调用：

```
private void AFunctionToDeleteMyObject()    
{        
   CreatingClass.DestroyObject(ref obj);    
   Assert.IsNull(obj);  
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-07T11:19:21.800

对提供的答案进行一点澄清......

C# 中的参数按类型传递，值类型传递值，引用类型传递引用。但是，您传递的接口可能与类（引用类型）或结构（值类型）相关，因此您需要将其显式声明为 ref 变量。

但是，您真正应该遵循的（如前所述）是 IDisposable 模式，它是为此功能而设计的。

编辑：参数按值传递，但对于引用类型，引用就是值。因此是你破坏了函数中的引用，原来的引用类型不受影响。如果您对引用变量进行更改，即修改数据集中的数据，则原始引用类型将在函数外部更新。

# session - 在 CodeIgniter 中“记住我”登录

> ID：419900
> 
> 赞同：10
> 
> 时间：2009-01-07T10:59:54.413
> 
> 标签：session, codeigniter, login

你如何在 CodeIgniter 中实现这一点？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-01-07T11:09:53.490

*（这个答案是对原始问题的回应）*

> *你会怎么做？或者，您将如何创建一个过期日期比其他会话更长的会话？*
> 
> *所有创建的会话都将在配置文件中使用相同的 $config['sess_expiration']（默认值：7200 秒），有没有办法传递自定义值？*

延长会话 cookie 的有效期不适用于“记住我”功能，因为用户在关闭浏览器时会丢失会话 cookie。如果 Code Igniter 没有原生的“记住功能”，那么您需要编写一些东西来删除一个长寿命的 cookie，其中包含允许在服务器再次看到它时自动登录的信息。

有一篇关于[Persistent Login Cookie Best Practice](http://fishbowl.pastiche.org/2004/01/19/persistent_login_cookie_best_practice/)的好文章，可以总结为：

> 1.  当用户在选中记住我的情况下成功登录时，除了标准会话管理 cookie 之外，还会发出一个登录 cookie。[2](http://jaspan.com/improved_persistent_login_cookie_best_practice)
> 2.  登录 cookie 包含用户的用户名和一个来自适当大空间的随机数（从这里开始的“令牌”）。用户名和令牌作为一对存储在数据库表中。
> 3.  当未登录用户访问该站点并显示登录 cookie 时，会在数据库中查找用户名和令牌。1\. 如果该对存在，则认为用户已通过身份验证。使用的令牌将从数据库中删除。生成一个新令牌，与用户名一起存储在数据库中，并通过新的登录 cookie 发给用户。2\. 如果该对不存在，则忽略登录 cookie。
> 4.  仅通过此机制进行身份验证的用户不得访问某些受保护的信息或功能，例如更改密码、查看个人身份信息或花钱。要执行这些操作，用户必须首先成功提交正常的用户名/密码登录表单。
> 5.  由于这种方法允许用户从不同的浏览器或计算机中获得多个记住的登录信息，因此为用户提供了一种机制，可以在一次操作中清除所有记住的登录信息。

[另一篇文章在改进的持久登录 Cookie 最佳实践](http://jaspan.com/improved_persistent_login_cookie_best_practice)中为这些想法构建了更多安全性

如果您遵循这些文章中的做法，您将不会出错！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-25T04:05:34.143

您可能需要重新考虑“改进的持久登录 Cookie 最佳实践”中的建议。我已经在网站上发布了我对问题的分析，但它的要点是：

> **无论如何，如果没有**安全线路，您将无法防止 cookie 窃取

 **（*“安全线路”是指 SSL / VPN 隧道 / 公钥加密 - 或强大的质询 - 响应方案 *）

我完全赞成持久登录的最佳实践，但在某一点上，再多的诡计也无济于事，而**唯一**的出路就是 SSL。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-01-12T02:14:08.983

感谢您的解决方案。我已经在我的 CI 项目中实现了这一点。

开发人员注意：cookie 应该有一个安全散列作为记住我的密钥。- 不只存储用户 ID） - 不存储密码， - 不存储密码哈希。这样人们就无法自动登录任何帐户。

最坏的情况：一旦黑客发现哈希方法，您可以在一个地方调整密钥生产者功能，并重新设置安全性。我只是调整盐和胡椒串。

希望有帮助。Chris D. - 来自澳大利亚 :)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-02-01T04:56:31.927

对于这些东西，所有类中的CI变量都可以通过自己的库来访问：

例如：

```
$this->session->sess_expiration = 500000; 
```

希望能解决您的问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-03-17T10:11:23.977

github上有图书馆，记得我下载它。

使用这个库的 setCookie() 函数，会发生以下情况：

1\. 生成一个包含唯一编号的 cookie 该编号被记录到数据库表中，称为 ci_cookies 以及传递给 setCookie() 的 netid/用户名

2.verifyCookie()函数被调用时，浏览器的cookie hash必须匹配记录到数据库的hash。如果是，verifyCookie() 返回 true 转发到主页

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-10-19T19:19:33.223

你需要在加载会话之前设置 conf

```
$do_not_remember = (boolean) $this->input->post('do_not_remember');
if ($do_not_remember) {
   $this->config->set_item('sess_expiration', 0);
   $this->config->set_item('sess_expire_on_close', true);
}
$this->load->library('session'); 
```

# javascript - 从html表单中的下拉框中获取选定的值而不提交

> ID：419908
> 
> 赞同：1
> 
> 时间：2009-01-07T11:05:14.480
> 
> 标签：javascript, python, html, google-app-engine, drop-down-menu

如何从 html 表单中的下拉框元素中获取所选项目的文本？（使用python）当我使用鼠标从下拉框中选择一项时，如何将值存储到变量中？（即不使用提交按钮）

这是针对我在仅支持 Python 的应用程序引擎中执行的应用程序。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-01-07T11:43:06.200

您的问题显示了对[Web 应用程序](http://en.wikipedia.org/wiki/Web_application)如何工作的一些误解。

用户必须在浏览器中输入地址才能访问应用程序。这向服务器发送请求。服务器代码（用 python 编写）接收到这个请求并有机会发送一个答案。答案是通常用[HTML](http://www.w3.org/html/)编写的文档。本文档的某些部分可以是动态的，即由 python 代码生成。文档的其他部分可以是静态的。然后浏览器在用户窗口上呈现文档。

在那之后，你的 python 代码可以知道浏览器窗口上发生的事情或运行 python 代码的任何部分的唯一方法是让浏览器发送另一个请求。

这可能在许多情况下发生，最常见的是：

*   用户单击指向另一个 url 的链接，使浏览器向这个新 url 发送另一个请求。
*   用户单击`submit`按钮，使浏览器将表单作为请求提交到表单`action`属性中配置的地址。
*   实际页面中的一些代码，通常用[ECMAscript](http://www.ecmascript.org/)（也称为*javascript*）编写，在后台发出请求。

后者是你想要的。您必须在*javascript*中编写一些代码，以使浏览器将下拉列表中选择的信息发送到服务器。这样，您在服务器上的 python 代码就可以对其进行处理。

简单的方法是让`onchange`下拉事件进行提交：

```
<select name='myfield' onchange='this.form.submit()'>
<option .... >
...
</select>
</form> 
```

这样，当用户更改下拉列表中的值时，表单将被提交，就像用户单击提交一样。服务器上的 Python 代码将运行。浏览器将加载答案。

另一种流行的方法是使用 javascript 的[XmlHTTPRequest](http://en.wikipedia.org/wiki/XMLHttpRequest) DOM API 来发送请求。这样您就可以在 python 中接收值并发送答案，然后浏览器中的 javascript 代码将接收到该答案。该代码可以根据答案更改部分页面，而无需更改整个页面。这种技术称为[AJAX](http://en.wikipedia.org/wiki/Ajax_(programming))。

如果您打算编写大量 javascript 代码，我强烈建议您至少使用 javascript 库来减轻处理许多浏览器版本的痛苦。[jQuery](http://jquery.com/ "少写多做 Javascript 库")是我的首选库。

换句话说，在浏览器中运行的用 javascript 编写的代码与在服务器中运行的用 python 编写的代码*进行对话。*

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-07T11:22:07.410

您的 python 代码在服务器上运行（google appengine）。HTML 表单在客户端（在浏览器中）运行。客户端和服务器通过 HTTP 协议进行通信。客户端发送*请求*，服务器响应*响应*。你必须向服务器发送一些东西，让你的 python 代码知道用户操作。

在客户端，您可以使用 Javascript（考虑使用 jQuery 库）。可能您无需与服务器通信就可以逃脱。

如果您必须与服务器通信但不想重新加载页面，请使用[AJAX 技术](http://en.wikipedia.org/wiki/Ajax_(programming))。在这种情况下，您必须在您的 python 应用程序中创建特殊视图并在 Javascript 中发起请求。

请记住，Javascript 用于客户端，Python 用于服务器端。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-07T13:42:55.847

如果您需要将选定的值发送到您的服务器而不提交，我认为最好的（如果不是唯一的）方法是使用一些 ajax。

如果您使用的是 jQuery，请查看[它的 ajax 内容。](http://docs.jquery.com/Ajax.)它是[事件模型](http://docs.jquery.com/Events)。您首先必须将下拉菜单的事件附加到您要执行的功能。因此，当用户更改下拉列表时，浏览器将在后台打开一个新连接。因此，您可以获得该值并将其保存在服务器端。会是…… 像这样：

```
$(document).ready( 

    $("#select_id").change(function() {
        $(this).getJSON("/method", {"selectValue":$(this).val()}, function() {
                   alert("value received!");
              });
    });

); 
```

希望能帮助到你！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-09-02T14:14:07.910

使用 onchange 的问题在于并非所有用户都使用鼠标。如果您有一个组合框并使用键盘更改值，那么如果不提交表单，您将永远无法超过第一个值。

~西里克斯

# .net - 何时使用集合 与列表

> ID：419914
> 
> 赞同：34
> 
> 时间：2009-01-07T11:09:36.920
> 
> 标签：.net, list, collections, generics

> **可能重复：**
> [List (of T) 和 Collection(of T) 有什么区别？](https://stackoverflow.com/questions/398903/what-is-the-difference-between-list-of-t-and-collectionof-t)

何时使用一种与另一种的最佳做法是什么？

两者都实现 IList<T> 并以有序方式保存数据，但只有 List 公开排序语义......

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-01-07T11:21:08.363

*   [`Collection<T>`](http://msdn.microsoft.com/en-us/library/ms132397.aspx)：

    > 提供泛型集合的基类。

*   [`List<T>`](http://msdn.microsoft.com/en-us/library/6sh2ey19.aspx)：

    > 表示可以通过索引访问的对象的强类型列表。提供搜索、排序和操作列表的方法。

因此，根据文档，一个旨在作为集合的基类。另一个旨在用作容器。

所以**使用** `List<T>`和**继承**自`Collection<T>`.

# url - 您能否建议生成用于查看标记内容的 URL 的好方法

> ID：419925
> 
> 赞同：2
> 
> 时间：2009-01-07T11:14:32.230
> 
> 标签：url, tags, friendly-url

例如，在堆栈溢出时，URL [https://stackoverflow.com/questions/tagged/javascript+php](https://stackoverflow.com/questions/tagged/javascript+php)将为您提供所有带有 javascript 和 php 标记的问题。

我的系统允许标签中有空格，所以这里使用的方法不适合我。

您将使用什么字符来分隔标签，因此 URL 仍然是人类可读的、谷歌可读的和网络浏览器兼容的。

我的直觉是使用逗号。例如[http://example.com/tagged/first+tag,second+tag](http://example.com/tagged/first+tag,second+tag)

欢迎任何反馈或建议。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-07T11:18:06.047

空格的破折号怎么样？查看您问题的链接，您就知道了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-07T11:19:39.257

为什么不坚持使用 + 作为标签分隔符并使用下划线 '_' 或仅使用 %s 作为标签名称中的空格？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-07T11:21:44.540

请记住：在搜索引擎蜘蛛的眼中，使用“-”而不是“_”更好，这是 SEO 规则

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-07T11:22:43.853

如果您的语言具有 URLEncode 函数，则使用它来修改您的标签。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-09-09T11:20:31.810

那么 + 表示空格和 - 表示标签空格怎么样（只是编译两个答案中最好的）？

我还有另一个小窍门，一点点放在一边，以防你没有想到。您可以通过在标记之前添加[未回答/](https://stackoverflow.com/unanswered/tagged/tags+link)来包含带有特定标签的未回答问题。

请参阅相关问题[How to display questions with tag X that unanswered](https://stackoverflow.com/questions/1015463/how-to-display-questions-with-tag-x-that-are-unanswered)

# .net - PictureBoxSizeMode.Zoom - 什么是缩放系数？

> ID：419933
> 
> 赞同：1
> 
> 时间：2009-01-07T11:18:50.413
> 
> 标签：.net, user-interface, image, zooming, picturebox

我有一个包含图像的 PictureBox（其 SizeMode 属性设置为 Zoom），两者的大小都可能不同。

由于用户必须直接与图像交互，我需要能够将 PictureBox 点击坐标转换为图像坐标。

到目前为止，我所做的是将 PictureBox 的纵横比与图像的纵横比进行比较。例如，如果 PictureBox 相对于图像“更宽屏”（见截图），这意味着 PictureBox 会将图像拉伸到它自己的高度并水平居中，将其背景颜色（在本例中为红色）显示给图像的左侧和右侧。然后我假设图像的显示高度与 PictureBox.Height 相同，并从那里开始工作。

不过有一个问题。正如您在屏幕截图（绿色注释我的）中看到的那样，被拉伸以适合（缩放）红色 PictureBox 内的白色图像在底部留下了一个小边距。

[screenie http://img132.imageshack.us/img132/3541/bordernl6.th.png 点击查看完整尺寸。](http://img132.imageshack.us/img132/3541/bordernl6.png)

不过，并非所有 PictureBox.Size / Image.Size 组合都会发生这种情况。这使我相信必须有更好的方法来做到这一点。

* * *

当然，我会这样做的。我只需要修改代码以删除上下文依赖项。

但底部的边距不是来自我的代码。它来自 PictureBox 本身。帮我一个忙并尝试以下操作：

将 PictureBox (PictureBox1) 添加到窗体，将其停靠到窗体的所有四个侧面。代码应如下所示：

```
Public Class Form1

    Private Sub Form1_Shown(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Shown

        PictureBox1.SizeMode = PictureBoxSizeMode.Zoom

        PictureBox1.BackColor = Color.Red
        PictureBox1.Image = New Bitmap(PictureBox1.Width, PictureBox1.Height)
        Dim g As Graphics = Graphics.FromImage(PictureBox1.Image)

        g.FillRectangle(Brushes.White, 0, 0, PictureBox1.Image.Width, PictureBox1.Image.Height)

    End Sub

End Class 
```

运行它并调整窗体的大小，使图像被拉伸（缩放）以填充 PictureBox 的高度，在白色方块的左侧和右侧留下红色条。现在垂直调整窗体的大小，尽可能慢。您应该时不时地在底部看到一个红色边距。

宽度和水平调整大小也会发生同样的情况，显示右侧的边距。

正是由于这个小缺陷，我知道无法按照我一直这样做的方式计算缩放系数；结果只是一个近似值。如果在尝试后您仍然认为代码是相关的，那么我很乐意发布它。

感谢您抽出宝贵时间阅读和回复。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-07T21:08:23.467

我认为没有办法获得缩放因子。我猜你的数学可能有错误，因为底部的边距（也许你有一次性错误或类似的东西）。

您能否发布一个完整的示例来显示您正在执行的计算？

# c++ - 虚拟继承

> ID：419943
> 
> 赞同：73
> 
> 时间：2009-01-07T11:20:59.253
> 
> 标签：c++, inheritance, virtual

“虚拟”继承是什么意思？

看了下面的代码，没看懂`virtual`下面上下文中关键字的含义：

```
class A {};
class B : public virtual A; 
```

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2009-01-07T11:40:15.657

虚拟继承用于解决 DDD 问题（Dreadful Diamond on Derivation）。

看下面的例子，你有两个继承自同一个基类的类：

```
class Base
{

public:

 virtual void  Ambig();

}; 
```

* * *

```
class C : public Base
{

public:

//...

};

class D : public Base
{
public:

    //...

}; 
```

* * *

现在，您要创建一个继承自 C 和 D 类的新类（它们都继承了 Base::Ambig() 函数）：

```
class Wrong : public C, public D
{

public:

...

}; 
```

当您在上面定义“错误”类时，您实际上创建了 DDD（钻石派生问题），因为您不能调用：

```
Wrong wrong;
wrong.Ambig(); 
```

这是一个模棱两可的函数，因为它被定义了两次：

```
Wrong::C::Base::Ambig() 
```

和：

```
Wrong::D::Base::Ambig() 
```

为了防止这种问题，你应该使用虚拟继承，它会知道引用正确的`Ambig()`函数。

所以 - 定义：

```
class C : public virtual Base

class D : public virtual Base

class Right : public C, public D 
```

# c# - 如何优化/加速代码执行 C#, Windows.Net

> ID：419954
> 
> 赞同：0
> 
> 时间：2009-01-07T11:25:52.100
> 
> 标签：c#

我有以下代码块，我在优化部分尝试优化

```
DataSet dsLastWeighing = null;
DataSet ds = null;
DataSet dsWeight = null;
string strQuery = string.Empty;
string strWhere = string.Empty;
Database db = null;

#region Original Code Block
            try
            {   
                db = DatabaseFactory.CreateDatabase();

                strWhere = "WHERE SESSION_ID = '"+pSessionID+"'"; 
                strQuery = SQ.BusinessLogic.SQLQueryFactory.GetPatientLastWeighing("DeleteWeightRecent",db.ToString(),pFacilityID,pSessionID,strWhere,0,DateTime.Now.ToUniversalTime(),0,"");
                db.ExecuteNonQuery(System.Data.CommandType.Text, strQuery);

                strWhere = "WHERE LAB_ID = 0";
                strQuery = SQ.BusinessLogic.SQLQueryFactory.GetPatientLastWeighing("InsertWeightRecent",db.ToString(),pFacilityID,pSessionID,strWhere,0,DateTime.Now.ToUniversalTime(),0,"");
                db.ExecuteNonQuery(System.Data.CommandType.Text, strQuery);

                strWhere = strWhere = "WHERE SESSION_ID = '"+pSessionID+"'"; 
                strQuery = SQ.BusinessLogic.SQLQueryFactory.GetPatientLastWeighing("GetPatientID",db.ToString(),pFacilityID,pSessionID,strWhere,0,DateTime.Now.ToUniversalTime(),0,"");
                ds = (DataSet) db.ExecuteDataSet(System.Data.CommandType.Text, strQuery);

                foreach(DataRow dr in ds.Tables[0].Rows)
                {
                    if (db.ToString() == "Microsoft.Practices.EnterpriseLibrary.Data.SqlBase.SqlBaseDatabase")
                    {
                        strWhere = "WHERE LAB_ID=0 AND PAT_ID ="+ int.Parse(dr["PAT_ID"].ToString())+" AND WHEN IN(SELECT MAX(WHEN) FROM PATIENT_LAB WHERE LAB_ID=0 AND PAT_ID="+ int.Parse(dr["PAT_ID"].ToString())+")"; 
                    }
                    else if (db.ToString() == "Microsoft.Practices.EnterpriseLibrary.Data.Sql.SqlDatabase")
                    {
                        strWhere = "WHERE LAB_ID=0 AND PAT_ID ="+ int.Parse(dr["PAT_ID"].ToString())+" AND [WHEN] IN(SELECT MAX([WHEN]) FROM PATIENT_LAB WHERE LAB_ID=0 AND PAT_ID="+ int.Parse(dr["PAT_ID"].ToString())+")"; 
                    }
                    strQuery = SQ.BusinessLogic.SQLQueryFactory.GetPatientLastWeighing("GetWeight",db.ToString(),pFacilityID,pSessionID,strWhere,0,DateTime.Now.ToUniversalTime(),0,"");

                    strMain.append(strQuery+" ");
                    dsWeight = (DataSet) db.ExecuteDataSet(System.Data.CommandType.Text, strQuery);

                    foreach(DataRow drWeight in dsWeight.Tables[0].Rows)
                    {                           
                        strWhere =  "WHERE PAT_ID = "+int.Parse(dr["PAT_ID"].ToString())+" AND SESSION_ID ='"+pSessionID+"'";
                        strQuery = SQ.BusinessLogic.SQLQueryFactory.GetPatientLastWeighing("UpdateWeightRecent",db.ToString(),pFacilityID,pSessionID,strWhere,decimal.Parse(drWeight["LEVEL"].ToString()),DateTime.Parse(drWeight["WHEN"].ToString()).ToUniversalTime(),int.Parse(drWeight["IS_BAD"].ToString()),drWeight["NOTE"].ToString());
                        db.ExecuteNonQuery(System.Data.CommandType.Text, strQuery); 
                    }

                }

                strWhere = " ORDER BY W.IS_BAD DESC, P.LASTNAME ASC, P.FIRSTNAME ASC,P.MIDDLENAME ASC";
                strQuery = SQ.BusinessLogic.SQLQueryFactory.GetPatientLastWeighing("GetPatientLastWeight",db.ToString(),pFacilityID,pSessionID,strWhere,0,DateTime.Now.ToUniversalTime(),0,"");
                dsLastWeighing = (DataSet) db.ExecuteDataSet(System.Data.CommandType.Text, strQuery);                   
            }
            catch(Exception ex)
            {
                throw ex;
            }
            finally
            {
                db = null;
                ds= null;
                dsWeight= null;
            }
            return dsLastWeighing;
            #endregion

--Optimized Section--

    #region Optimized Code Block

            try
            {   
                StringBuilder strMain=new StringBuilder();
                db = DatabaseFactory.CreateDatabase();

                //StartTime=DateTime.Now.ToLongTimeString();
                strWhere = "WHERE SESSION_ID = '"+pSessionID+"'"; 
                strQuery = SQ.BusinessLogic.SQLQueryFactory.GetPatientLastWeighing("DeleteWeightRecent",db.ToString(),pFacilityID,pSessionID,strWhere,0,DateTime.Now.ToUniversalTime(),0,"");
                //EndTime=DateTime.Now.ToLongTimeString();
                //db.ExecuteNonQuery(System.Data.CommandType.Text, strQuery);
                strMain.append(strQuery+" ");

                strWhere = "WHERE LAB_ID = 0";

                //StartTime=DateTime.Now.ToLongTimeString();
                  strQuery = SQ.BusinessLogic.SQLQueryFactory.GetPatientLastWeighing("InsertWeightRecent",db.ToString(),pFacilityID,pSessionID,strWhere,0,DateTime.Now.ToUniversalTime(),0,"");
                //EndTime=DateTime.Now.ToLongTimeString();

                //db.ExecuteNonQuery(System.Data.CommandType.Text, strQuery);
                strMain.append(strQuery+" ");

                strWhere = strWhere = "WHERE SESSION_ID = '"+pSessionID+"'"; 
                //StartTime=DateTime.Now.ToLongTimeString();
                  strQuery = SQ.BusinessLogic.SQLQueryFactory.GetPatientLastWeighing("GetPatientID",db.ToString(),pFacilityID,pSessionID,strWhere,0,DateTime.Now.ToUniversalTime(),0,"");
                //EndTime=DateTime.Now.ToLongTimeString();
                //ds = (DataSet) db.ExecuteDataSet(System.Data.CommandType.Text, strQuery);

                strMain.append(strQuery+" ");
                //StartTime=DateTime.Now.ToLongTimeString();
                 ds = (DataSet) db.ExecuteDataSet(System.Data.CommandType.Text, strMain.ToString());
                //EndTime=DateTime.Now.ToLongTimeString();

                strMain=null;

                foreach(DataRow dr in ds.Tables[0].Rows)
                {
                    //StartTime=DateTime.Now.ToLongTimeString();
                    if (db.ToString() == "Microsoft.Practices.EnterpriseLibrary.Data.SqlBase.SqlBaseDatabase")
                    {
                        strWhere = "WHERE LAB_ID=0 AND PAT_ID ="+ int.Parse(dr["PAT_ID"].ToString())+" AND WHEN IN(SELECT MAX(WHEN) FROM PATIENT_LAB WHERE LAB_ID=0 AND PAT_ID="+ int.Parse(dr["PAT_ID"].ToString())+")"; 
                    }
                    else if (db.ToString() == "Microsoft.Practices.EnterpriseLibrary.Data.Sql.SqlDatabase")
                    {
                        strWhere = "WHERE LAB_ID=0 AND PAT_ID ="+ int.Parse(dr["PAT_ID"].ToString())+" AND [WHEN] IN(SELECT MAX([WHEN]) FROM PATIENT_LAB WHERE LAB_ID=0 AND PAT_ID="+ int.Parse(dr["PAT_ID"].ToString())+")"; 
                    }
                    strQuery = SQ.BusinessLogic.SQLQueryFactory.GetPatientLastWeighing("GetWeight",db.ToString(),pFacilityID,pSessionID,strWhere,0,DateTime.Now.ToUniversalTime(),0,"");

                    strMain.append(strQuery+" ");
                    //EndTime=DateTime.Now.ToLongTimeString();
                    //dsWeight = (DataSet) db.ExecuteDataSet(System.Data.CommandType.Text, strQuery);

                    /*
                    foreach(DataRow drWeight in dsWeight.Tables[0].Rows)
                    {                           
                        strWhere =  "WHERE PAT_ID = "+int.Parse(dr["PAT_ID"].ToString())+" AND SESSION_ID ='"+pSessionID+"'";
                        strQuery = SQ.BusinessLogic.SQLQueryFactory.GetPatientLastWeighing("UpdateWeightRecent",db.ToString(),pFacilityID,pSessionID,strWhere,decimal.Parse(drWeight["LEVEL"].ToString()),DateTime.Parse(drWeight["WHEN"].ToString()).ToUniversalTime(),int.Parse(drWeight["IS_BAD"].ToString()),drWeight["NOTE"].ToString());
                        db.ExecuteNonQuery(System.Data.CommandType.Text, strQuery); 
                    }
                    */
                }

                dsWeight = (DataSet) db.ExecuteDataSet(System.Data.CommandType.Text, strMain.ToString());
                strMain=null;
                //StartTime=DateTime.Now.ToLongTimeString();
                for(int i=0;i<dsWeight.Tables.Count;i++)
                {
                    foreach(DataRow drWeight in dsWeight.Tables[i].Rows)
                    {                           
                        strWhere =  "WHERE PAT_ID = "+int.Parse(dr["PAT_ID"].ToString())+" AND SESSION_ID ='"+pSessionID+"'";
                        strQuery = SQ.BusinessLogic.SQLQueryFactory.GetPatientLastWeighing("UpdateWeightRecent",db.ToString(),pFacilityID,pSessionID,strWhere,decimal.Parse(drWeight["LEVEL"].ToString()),DateTime.Parse(drWeight["WHEN"].ToString()).ToUniversalTime(),int.Parse(drWeight["IS_BAD"].ToString()),drWeight["NOTE"].ToString());
                        strMain.append(strQuery+" ");
                        //db.ExecuteNonQuery(System.Data.CommandType.Text, strQuery);   
                    }
                }
                db.ExecuteNonQuery(System.Data.CommandType.Text, strMain.ToString());   
                //EndTime=DateTime.Now.ToLongTimeString();

                //StartTime=DateTime.Now.ToLongTimeString();
                strWhere = " ORDER BY W.IS_BAD DESC, P.LASTNAME ASC, P.FIRSTNAME ASC,P.MIDDLENAME ASC";
                strQuery = SQ.BusinessLogic.SQLQueryFactory.GetPatientLastWeighing("GetPatientLastWeight",db.ToString(),pFacilityID,pSessionID,strWhere,0,DateTime.Now.ToUniversalTime(),0,"");
                dsLastWeighing = (DataSet) db.ExecuteDataSet(System.Data.CommandType.Text, strQuery);   
                //EndTime=DateTime.Now.ToLongTimeString();
            }
            catch(Exception ex)
            {
                throw ex;
            }
            finally
            {
                db = null;
                ds= null;
                dsWeight= null;
            }
            return dsLastWeighing;

            #endregion 
```

这可以进一步优化..只专注于最小化循环..我没有进一步的想法..任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-07T11:32:30.540

我会建议：

*   使用参数化 SQL
*   摆脱 catch 块，或者*至少*使用“throw”而不是“throw ex”，这样你就不会丢失信息
*   摆脱 finally 块 - 它对你没有帮助
*   在第一次需要时声明变量，而不是全部在方法的顶部
*   将方法分解为更易于管理的部分

当所有这些都完成后，您将可以更好地调整性能。此时，分析应用程序并查看痛点实际上是在 .NET 代码中还是在与数据库的交互中。根据我的经验，数据库应用程序通常通过以下方式改进：

*   改进 SQL 查询
*   减少往返行程
*   优化数据库（应用索引等）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-07T11:38:08.703

也许您已经优化了 SQL 字符串的创建，但我认为这与与 SQL 服务器通信所需的时间相比是微不足道的。

通过优化字符串可以赢得几毫秒，但使用数据集会损失很多。

我认为你应该首先关注那部分。不仅是数据集，如果您优化 SQL 服务器，还有更多收获。也许抛出一个存储过程，看看索引等。

此外，此代码对于 SQL 注入攻击**根本不安全。**你应该使用参数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-07T11:31:03.790

如果 C# 的 StringBuilder 与 Java 的 StringBuilder 类似，那么一行就像

```
strMain.append(strQuery+" "); 
```

是一个明确的信号，表明您还没有理解 StringBuilder 的用途。

在 Java 中，该行将被编译为

```
strMain.append(new StringBuilder().append(strQuery).append(" ").toString()); 
```

我很确定这*不能**称为*“优化”。

 ** * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-07T11:32:36.673

我不知道循环，但这里有一些指针

*   不要在你的字符串生成器中使用 strQuery+" " 系统。也附加“”。
*   如果您正在寻找优化的 SQL 性能，那么您在使用数据集做什么。请改用数据阅读器。
*   听乔恩·斯基特。

我认为您的代码需要重新设计它的建模方式以获得良好的性能提升。我个人尽可能避免使用数据集。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-07T11:34:12.097

小问题：`strWhere`是 a `string`，并且您正在做很多操作。你可能会更好地使用`StringBuilder`这个。`StringBuilder`您可能还会看到使用合适的长度初始化您的小好处。

# c# - 在一个解决方案中混合 VB ASP.NET 和 C# ASP.MVC 项目

> ID：419961
> 
> 赞同：3
> 
> 时间：2009-01-07T11:27:55.310
> 
> 标签：c#, asp.net-mvc, vb.net

**背景**

我们是一个 TDD 团队，他们继承了一个遗留的 ASP.NET 应用程序，并试图通过分离表示、业务和数据访问问题来控制它，从而提高可测试性。我们已经为新添加的页面使用 MVP 模式取得了一些成功，但正在研究 MS MVC 框架，看看它是否比 MVP 给我们带来任何好处。重要的是，我们希望新的 MVC 工作在 C# 中，而旧应用程序在 VB 中。我们查看了[这个](http://www.hanselman.com/blog/PlugInHybridsASPNETWebFormsAndASPMVCAndASPNETDynamicDataSideBySide.aspx)博客条目，它主要实现了我们想要的，但不允许我们用 C# 编写代码。此外，还有许多关于将单个 Web 应用程序划分为多个项目的博客文章，这些文章看起来很有用（[这里](http://weblogs.asp.net/scottgu/archive/2006/08/16/Tip_2F00_Trick_3A00_-Creating-Sub_2D00_Web-Projects-using-the-VS-2005-Web-Application-Project-Option.aspx)）

**问题**

**您**能否创建一个由两个项目（默认的 VB ASP.NET 项目和默认的 C# MVC 项目）组成的单个 Web 应用程序组成的工作原型，并让它们很好地协同工作。我无法成功地做到这一点（我认为是由于路由问题）。如果可以，我想查看您的 web.config 和 global.asax 文件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-07T16:06:26.947

The default MVC app contains two important bits of code in the root of the project, and they will need to exist in the root of your app too:

1.  The **Global.asax** - the code behind sets up the all the routing.
2.  The **Default.aspx** - the code behind fires up the MvcHttpHandler, and starts you off down the MVC routes

Both of these will need to be in the root of your website (or be set up in a similar way somewhere) to load up correctly and start handling all the routing properly - you should also ensure that your routes are specific enough not to catch the legacy apps pages.

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-01-07T14:52:04.007

如果您不做纯 MVC，请不要打扰。ASP.NET MVC 框架的优势在于它分离了应用程序的各个层，并为您提供了对每一层的更多控制。我认为你正在做的是在 MVC 中推出新功能，只是因为它是新鲜的，但你不会利用它给你的优势。我认为它会变得更加难以维护，这不是重点。情况可能并非如此，我不知道你想用这个 MVC 项目实现什么，如果是这样，请详细说明。

# objective-c - 使用 NSXMLParser 从 HTTPS URL 解析 XML？

> ID：419963
> 
> 赞同：4
> 
> 时间：2009-01-07T11:29:04.683
> 
> 标签：objective-c, xml, cocoa, cocoa-touch, parsing

我正在尝试直接从 HTTPS URL 解析 XML，如下所示：

```
NSString *const URL = @"https://some/HTTPS/url";
NSURL* url = [NSURL URLWithString:URL];
NSXMLParser* parser = [[NSXMLParser alloc] initWithContentsOfURL:url];
[parser setDelegate:self];
[parser parse]; 
```

我有以下解析器的委托方法：

```
- (void) parser:(NSXMLParser *)parser 
didStartElement:(NSString *)elementName 
namespaceURI:(NSString *)namespaceURI 
qualifiedName:(NSString *)qualifiedName 
attributes:(NSDictionary *)attributeDict
{
    NSLog(@"Started parsing %@", elementName);
} 
```

这似乎适用于 HTTP URL，但没有显示 HTTPS URL 的结果。

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-08T00:01:19.593

1.  initWithContentsOfURL:... 方法都不允许您回答来自 https 服务器的身份验证消息。因此，请查看[NSURLConnection](http://developer.apple.com/documentation/Cocoa/Reference/Foundation/Classes/NSURLConnection_Class/Reference/Reference.html)和[NSURLDownload](http://developer.apple.com/documentation/Cocoa/Reference/Foundation/Classes/NSURLDownload_Class/Reference/Reference.html#//apple_ref/doc/uid/20001832)，它们具有可帮助您处理身份验证的委托消息。

2.  要了解有关使用 URL 与服务器通信的更多信息，请阅读[URL 加载系统简介](http://developer.apple.com/documentation/Cocoa/Conceptual/URLLoadingSystem/URLLoadingSystem.html)。

3.  就使用 XML 解析器解析 HTML 而言，它只能可靠地与 XHTML 一起工作。因此，如果您正在创建和解析自己的 XHTML 文件，那么在大多数情况下应该可以工作。但是，如果您从 Internet 加载任何 HTML 文件，则 XML 解析器通常无法解析该文件。你可能想看看[WebKit](http://developer.apple.com/documentation/Cocoa/Conceptual/DisplayWebContent/DisplayWebContent.html)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-07T23:18:17.543

您应该使用 NSURLConnection 下载 XML 数据，然后解析输出，而不是使用 -initWithContentsOfURL:。

NSURLConnection 更健壮，还允许您执行您绝对应该执行的异步获取， -initWithContentsOfURL: 将阻塞主线程。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-08T11:21:29.877

此外，大多数 HTTPS 服务器会检查 User-Agent 字符串，并且在未指定此类标头值时无法正常播放。在 url 请求中包含一些（有效的）用户代理字符串肯定会有所帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-02T18:36:52.317

我不确定您是否在进行 iPhone 编程，但作为记录，在 NSXMLParser 类参考（在 iPhone 3.0 beta 2 SDK 中）中，initWithContentsOfURL:(NSURL *)url 似乎**没有**被弃用。

# iphone - 看起来不错的默认 UITextfield 字体的更大替代品

> ID：419964
> 
> 赞同：1
> 
> 时间：2009-01-07T11:29:07.210
> 
> 标签：iphone, cocoa-touch, interface-builder

在界面生成器中，我在 UITableViewCell 的子类中创建了一个 UITextfield。

默认字体太小了。如果我在界面生成器中让它变得更大，它看起来有点难看。没有那么清晰地呈现。当您编辑联系人时，我想要一种类似于地址簿应用程序中使用的字体。它们的文本比默认值大，显示效果很好。

有人有好的字体/样式/大小吗？我应该在 IB 中设置它对吗？

UITextfield 类声明：@property(nonatomic,retain) UIFont *font; // 默认为零。使用系统字体 12 pt

这是否意味着他们只希望您使用 12 号？

谢谢！ **编辑：较大的字体在选择编辑时看起来很清晰，但在不编辑时看起来有点扭曲。在下图中，EC1V 是第一响应者（因此质量很好），而下面的 url 不是第一响应者，质量很差。（缓存的图像？）**

![替代文字](https://farm4.static.flickr.com/3494/3175998957_a6c65faf91.jpg?v=0)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-07T12:14:12.003

好的 - 我想我已经想通了。基本上一些字体大小，例如（Helevetica 13,14）只是不显示漂亮。我正在使用看起来很清晰的 helvetica 15。获得正确的显示只涉及一些试验和错误。

# c++ - C ++中的QNX面向对象线程

> ID：419966
> 
> 赞同：0
> 
> 时间：2009-01-07T11:30:06.850
> 
> 标签：c++, multithreading, qnx

我想使用 c++ 和线程在 QNX 中创建一个并行的面向对象系统。我该怎么做呢？

我试过了：

```
pthread_t our_thread_id;
pthread_create(&our_thread_id, NULL, &functionA ,NULL); 
```

函数 A 是指向函数的指针：

```
void *functionA()
{ //do something
} 
```

但是，此函数仅适用于 C 而不是 C++。我怎样才能使它在 C++ 中工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-07T11:49:39.290

请参阅[“如何将指向成员函数的指针传递给信号处理程序、X 事件回调、启动线程/任务的系统调用等？”](http://www.parashift.com/c++-faq-lite/pointers-to-members.html#faq-33.2) .

简而言之，您传递一个静态函数（“蹦床”）作为函数指针。您将“this”作为用户定义的参数传递。然后静态函数将调用反弹回真实对象。

例如：

```
class Thread {
public:
    int Create()
    {
        return pthread_create(&m_id, NULL, start_routine_trampoline, this);
    }

protected:
    virtual void *start_routine() = 0;

private:
    static void *start_routine_trampoline(void *p)
    {
        Thread *pThis = (Thread *)p;
        return pThis->start_routine();
    }
}; 
```

并且您需要确保 C++ 函数具有与 pthread_create 预期的相同的调用约定。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-10-30T12:10:51.617

Your `functionA` is not a pointer to a function, it's a function returning a `void*`. The function is also expected to take a void* as argument. This argument is used to pass a pointer to the data needed in the thread.

If you replace

```
void* functionA() { 
```

with

```
void functionA(void* threadData) { 
```

I'd expect it to work in both C and C++.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-07T11:49:54.377

我认为您需要声明`functionA`为存在`extern "C"`（并给它正确的签名，请参阅[QNX 上的 pthreads 文档](http://www.qnx.com/developers/docs/6.3.0SP3/neutrino/lib_ref/p/pthread_create.html)）。此函数将实例作为用户参数`this`：

```
extern "C"
{
   void* DoSomethingInAThread(void* pGenericThis)
   {
     YourClass* pThis = reinterpret_cast<YourClass*>(pGenericThis);
     pThis->DoSomethingInAThread();
   }
}

int main()
{
  YourClass* pSomeInstance = new YourClass();
  pthread_t our_thread_id;
  pthread_create(&our_thread_id, NULL, &DoSomethingInAThread, pSomeInstance);
} 
```

# c# - 测试事件是否分配了 EventHandler

> ID：419967
> 
> 赞同：5
> 
> 时间：2009-01-07T11:30:35.723
> 
> 标签：c#, unit-testing, events, event-handling

我想测试一个类是否有一个分配给事件的 EventHandler。基本上我正在使用我的 IoC 容器为我连接 EventHandlers，我想检查它们是否被正确分配。所以真的，我正在测试我的 IoC 配置。

```
[Test]
public void create_person_event_handler_is_hooked_up_by_windsor()
{
    IChangePersonService changePersonService = IoC.Resolve<IChangePersonService>();

    // check that changePersonService.PersonCreated has a handler attached
} 
```

我不确定如何测试 changePersonService.PersonCreated 是否有任何附加内容。

有任何想法吗？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-07T13:26:26.223

不要质疑你用这个假装什么，测试和枚举已注册事件的唯一方法是你是否将它们注册到你自己的集合中。

看这个例子：

```
public class MyChangePersonService : IChangePersonService
{
    private IList<EventHandler> handlers;

    private EventHandler _personEvent;

    public event EventHandler PersonCreated
    {
        add
        {
            _personEvent += value;
            handlers.Add(value);
        }

        remove
        {
            _personEvent -= value;
            handlers.Remove(value);
        }
    }

    public IList<EventHandler> PersonEventHandlers { get { return handlers; } }

    public MyChangePersonService()
    {
        handlers = new List<EventHandler>();
    }

    public void FirePersonEvent()
    {
        _personEvent(this, null);
    }
} 
```

然后您可以使用 prop 访问已注册的处理程序`PersonEventHandlers`。

你能实现这样的东西吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-07T11:47:01.463

在我看来，您正在尝试对 Castle Windsor 进行单元测试。由于它可能已经有单元测试，我认为这是浪费精力。您最好测试您的对象是否在正确的时间引发适当的事件（可能通过将模拟对象注册为事件处理程序）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-07T11:34:16.683

听起来你正试图从你的对象中*提取*一些信息，以*断言*它是一回事。请注意，这不一定是单元测试，因为您不是在测试功能。

如果您必须对此进行测试，似乎您需要打开一个公共 API`IChangePersonService`才能获取注册的事件处理程序。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-07T11:56:19.527

这不是真正的单元测试，而是集成测试。而且我不是在测试温莎城堡，而是我的配置。我正在测试我所有的解耦类是否按照我的意图连接起来。

最终，我想测试我的配置是否正确连接了我想要的事件，但我不确定 C# 是否会让我不改变我的 API，如 Yuval 所说。

# c# - 日文电子邮件主题编码

> ID：419977
> 
> 赞同：14
> 
> 时间：2009-01-07T11:33:18.277
> 
> 标签：c#, email, unicode, encoding

显然，对日文电子邮件进行编码有点挑战性，我正在慢慢发现这一点。如果有任何专家（即使是经验有限的人也会这样做），我能否提供一些关于如何做、如何测试以及如何验证的指导？

请记住，我从未涉足日本附近的任何地方，只是我正在开发的产品在那里使用，以及其他地方。

到目前为止（我认为）我所知道的如下：
- 日文电子邮件应使用 ISO-2022-JP、日文 JIS 代码页 50220 或可能的 SHIFT_JIS 代码页 932
编码 - 纯文本的电子邮件传输编码应设置为 Base64，Html 应设置为 7Bit
- 电子邮件主题应单独编码，以“=?ISO-2022-JP?B?”开头 （不知道这应该是什么意思）。我试过用

```
"=?ISO-2022-JP?B?" + Convert.ToBase64String(Encoding.Unicode.GetBytes(subject)) 
```

它基本上按预期给出了编码字符串，但它不会在电子邮件程序中显示为任何日文文本
- 我已经在 Outlook 2003、Outlook Express 和 GMail 中进行了测试

任何帮助将不胜感激

* * *

好的，所以发布一个简短的更新，感谢两个有用的答案，我已经设法获得正确的格式和编码。现在，Outlook 给出了类似于正确主题的内容：
`=?iso-2022-jp?B?6 Japanese test に各々の視点で語ってもらった。 6相当の防水?=`

但是，Outlook Express 中完全相同的电子邮件给出的主题如下：
`=?iso-2022-jp?B?6 Japanese test 縺ｫ蜷・・・隕也せ縺ｧ隱槭▲縺ｦ繧ゅｉ縺｣縺溘・ 6逶ｸ蠖薙・髦ｲ豌ｴ?=`

此外，在 Outlook Express 的收件箱视图中查看时，电子邮件主题更加奇怪，如下所示：
`=?iso-2022-jp?B?6 Japanese test ??????????????? 6???????=`

Gmail 似乎以与 Outlook 类似的方式工作，看起来是正确的。

我只是无法理解这个。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-01-29T17:13:34.553

我处理日语编码已经将近 20 年了，所以我对你的困难表示同情。我工作的网站每天都会向日本客户发送数百封电子邮件，以便我可以与您分享对我们有用的内容。

*   首先，不要使用 Shift-JIS。我个人收到了大量的日语电子邮件，几乎从来没有使用 Shift-JIS 对其进行编码。我认为 Outlook Express 的旧（大约是 Win 98？）版本使用 Shift-JIS 对外发邮件进行编码，但现在您只是看不到它。

*   正如您所知道的，您至少需要使用 ISO-2022-JP 作为邮件标头中任何内容的编码。这包括主题、收件人行和抄送行。UTF-8 在大多数情况下也可以使用，*但*它不适用于 Yahoo Japan 邮件，而且您可以想象，许多日本用户使用 Yahoo Japan 邮件。

*   您可以在电子邮件正文中使用 UTF-8，但建议您对 UTF-8 编码的日语文本进行 base64 编码，并将其放在正文中，而不是原始 UTF-8 文本。然而，在实践中，我相信这些天原始 UTF-8 文本对于电子邮件的正文可以正常工作。

*   正如我在上面提到的，您至少需要在 Outlook (Exchange)、Outlook Express (IMAP/POP3) 和 Yahoo Japan 网络邮件上进行测试。Yahoo Japan 是最棘手的，因为我相信他们使用 EUC 对其网页进行编码，因此您需要遵循正确的电子邮件标准，否则它们将无法正常工作（ISO-2022-JP 是发送日本电子邮件的标准）。

*   此外，您的主题行每行不应超过 75 个字符。也就是说，在您使用 ISO-2022-JP 和 base64 编码*后的 75 个字符，而不是转换前的 75 个字符。*如果超过 75 个字符，则需要将编码主题分成多行，以“=?iso-2022-jp?B?”开头 并在每一行以“？=”结尾。如果您不这样做，您的主题可能会被截断（取决于电子邮件阅读器以及主题文本的内容）。根据 RFC 2047：

“一个‘编码词’的长度不得超过 75 个字符，包括‘字符集’、‘编码’、‘编码文本’和分隔符。如果希望编码的文本比‘编码 - word' 为 75 个字符，可以使用多个 'encoded-word'（由 CRLF SPACE 分隔）。”

*   这是一些用于编码主题的示例 PHP 代码：

```
 // Convert Japanese subject to ISO-2022-JP (JIS is essentially ISO-2022-JP)

 $subject = mb_convert_encoding ($subject, "JIS", "SJIS");

 // Now, base64 encode the subject

 $subject = base64_encode ($subject);

 // Add the encoding markers to the subject

 $subject = "=?iso-2022-jp?B?" . $subject . "?=";

 // Now, $subject can be placed as-is into the raw mail header. 
```

*   有关如何编码电子邮件标头的完整说明，请参阅 RFC 2047。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-07T11:36:30.003

查看[http://en.wikipedia.org/wiki/MIME#Encoded-Word](http://en.wikipedia.org/wiki/MIME#Encoded-Word)以获取有关如何在符合 MIME 的消息中对标头字段进行编码的说明。您的主题末尾似乎缺少“？=”。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-07T11:56:29.540

**=?ISO-2022-JP?B?文本...**

ISO_2022-JP 表示字符串在 ISO-2022-JP 代码页中编码（例如，不是 Unicode） B 表示字符串是 bese64 编码的

在您的示例中，您应该只提供 ISO-2022-JP 中的字符串，而不是 Unicode。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-16T13:19:44.893

我有一些用日文撰写和发送电子邮件的经验……通常你必须注意操作系统使用的编码以及如何存储日文字符串！我的邮件对象通常编码如下：

```
 string s = "V‚µ‚¢ŠwK–@‚Ì‚²’ñˆÄ"; // Our japanese are shift-jis encoded, so it appears like garbled
    MailMessage message = new MailMessage();
    message.BodyEncoding = Encoding.GetEncoding("iso-2022-jp");
    message.SubjectEncoding = Encoding.GetEncoding("iso-2022-jp");
    message.Subject = s.ToEncoding(Encoding.GetEncoding("Shift-Jis")); // Change the encoding to whatever your source is
    message.Body = s.ToEncoding(Encoding.GetEncoding("Shift-Jis")); // Change the encoding to whatever your source is 
```

然后我有一个扩展方法可以为我进行转换：

```
public static string ToEncoding(this string s, Encoding targetEncoding)
        {   
            return s == null ? null : targetEncoding.GetString(Encoding.GetEncoding(1252).GetBytes(s)); //1252 is the windows OS codepage            
        } 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-04T11:01:13.773

像这样的东西应该可以在 python 中完成工作：

```
 #!/usr/bin/python                                                                                                            
# -*- mode: python; coding: utf-8 -*-                                                                                        
import smtplib
from email.MIMEText import MIMEText
from email.Header import Header
from email.Utils import formatdate

def send_from_gmail( from_addr, to_addr, subject, body, password, encoding="iso-2022-jp" ):

    msg = MIMEText(body.encode(encoding), 'plain', encoding)
    msg['Subject'] = Header(subject.encode(encoding), encoding)
    msg['From'] = from_addr
    msg['To'] = to_addr
    msg['Date'] = formatdate()

    s = smtplib.SMTP('smtp.gmail.com', 587)
    s.ehlo(); s.starttls(); s.ehlo()

    s.login(from_addr, password)
    s.sendmail(from_addr, to_addr, msg.as_string())
    s.close()
    return "Sent mail to: %s" % to_addr

if __name__ == "__main__":
    import sys
    for n,item in enumerate(sys.argv):
        sys.argv[n] = sys.argv[n].decode("utf8")

    if len(sys.argv)==6:
        print send_from_gmail( sys.argv[1], sys.argv[2], sys.argv[3], sys.argv[4], sys.argv[5] )
    elif len(sys.argv)==7:
        print send_from_gmail( sys.argv[1], sys.argv[2], sys.argv[3], sys.argv[4], sys.argv[5], encoding=sys.argv[6] )
    else:
        raise "SYNTAX: %s <from_addr> <to_addr> <subject> <body> <password> [encoding]" 
```

**公然盗用/改编自：

[http://mtokyo.blog9.fc2.com/blog-entry-127.html](http://mtokyo.blog9.fc2.com/blog-entry-127.html)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-16T13:01:58.627

首先你应该使用：

`Encoding.GetEncoding("ISO-2022-JP")`

将您的主题行转换为将由 Convert.ToBase64String() 处理的字节。

=?ISO-2022-JP?B?TEXTTEXT...?= 告诉接收邮件客户端发送方使用哪种编码将日文“字母”转换为字节流。

目前您使用 UTF-16 进行编码，但指定 ISO-2022-JP 进行解码。我猜这显然是两种不同的编码，就像 ISO-8859-1 与 Unicode 不同（大多数扩展的西欧字符在 ISO-XXX 中用一个字节表示，但在 Unicode 中用两个字节表示）。

我不确定您对 UTF-8 作为二等公民的意思。只要接收邮件客户端理解 UTF-8 并且能够将其转换为当前的日语语言环境，一切都很好。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-12-31T10:28:43.003

```
<?php

function sendMail($to, $subject, $body, $from_email,$from_name)
 {
$headers  = "MIME-Version: 1.0 \n" ;
$headers .= "From: " .
       "".mb_encode_mimeheader (mb_convert_encoding($from_name,"ISO-2022-JP","AUTO")) ."" .
       "<".$from_email."> \n";
$headers .= "Reply-To: " .
       "".mb_encode_mimeheader (mb_convert_encoding($from_name,"ISO-2022-JP","AUTO")) ."" .
       "<".$from_email."> \n";

$headers .= "Content-Type: text/plain;charset=ISO-2022-JP \n";

/* Convert body to same encoding as stated
in Content-Type header above */

$body = mb_convert_encoding($body, "ISO-2022-JP","AUTO");

/* Mail, optional parameters. */
$sendmail_params  = "-f$from_email";

mb_language("ja");
$subject = mb_convert_encoding($subject, "ISO-2022-JP","AUTO");
$subject = mb_encode_mimeheader($subject);

$result = mail($to, $subject, $body, $headers, $sendmail_params);

return $result;
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-08-21T12:08:45.633

90 年代初，在 JUNET（基于 UUCP 的全国网络）中将日语编码引入电子邮件。

当时定义了 RFC1468。如果您在纯文本邮件中遵循 RFC1468，则没有问题。

如果你想处理 html 邮件，RFC1468 除了标题部分是没用的。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-12-02T08:12:56.390

这是我用来发送日语电子邮件的方法。主题行在 Outlook 2010、gmail 和 iPhone 上看起来不错。

```
Encoding encoding = Encoding.GetEncoding("iso-2022-jp");
byte[] bytes  = encoding.GetBytes(subject);
string uuEncoded = Convert.ToBase64String(bytes);
subject = "=?iso-2022-jp?B?" + uuEncoded + "?=";

// not sure this is actually necessary...
mailMessage.SubjectEncoding = Encoding.GetEncoding("iso-2022-jp"); 
```

# windows - 在预构建事件中设置环境变量并在编译步骤中使用

> ID：419979
> 
> 赞同：19
> 
> 时间：2009-01-07T11:33:48.543
> 
> 标签：windows, visual-studio, compilation, environment-variables, visual-studio-2003

在 Visual Studio 2003 中，我试图在预构建事件中设置一个环境变量，然后在编译步骤中使用该变量，但该值似乎没有被传播。例如，如果预构建事件包含此（直接或在批处理文件中）：

```
set MY_LIB_VERSION=1.0.0 
```

和 AdditionalIncludeDirectories 有这个：

```
c:\path\to\library\my_lib_v$(MY_LIB_VERSION)\include 
```

`my_lib_v1.0.0`那么如果目录存在，我希望编译能够工作。但相反，我得到

```
c:\path\to\prog\my_prog.c(22)：致命错误 C1083：无法打开包含文件：'my_lib.h'
项目：警告 PRJ0018：未找到以下环境变量：
$(MY_LIB_VERSION)

```

我推断在预构建事件中设置的环境变量因此不会传播到编译步骤，但我可能会遗漏一些东西。

**如何在预构建事件中设置环境变量并在编译步骤中使用它？**

（或者，定义一个库版本一次并将其多次用于 AdditionalIncludeDirectories 和 AdditionalLibraryDirectories 的任何其他合理方法也可以。）

* * *

**更新**：我最终以不同的方式解决了我们的问题。`svn:externals`我们正在使用 Subversion，并在名为 的项目源的子目录中设置属性`dependencies`，这样项目的检出将另外检出并在工作副本中`<svn_path>\libraries\my_lib_v1.0.0`调用它。`dependencies\my_lib`然后项目设置可以参考之`dependencies\my_lib\include`类的。升级到 1.0.1 版`my_lib`只需编辑`svn:externals`属性即可——无需更改代码和项目设置。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-07T11:44:58.723

我必须承认，我从未尝试在预构建步骤中设置环境变量，我可以理解为什么它不一定有效（运行批处理文件很可能会触发一个单独的进程，而你想要操纵父进程的环境）。

我一直在使用的一种解决方法，但只有在您可以在启动 Visual Studio 之前确定必要的设置时才有效，即创建一个批处理文件来设置必要的环境变量，然后使用适当的解决方案文件启动 Visual Studio。我在下面复制了这个批处理文件的骨架：

```
REM
REM Set up VS environment with defaults (this is for 2008) - need to do this first
REM
call "C:\Program Files\Microsoft Visual Studio 9.0\Common7\Tools\vsvars32.bat"
REM
REM Set the environment variables required by the project
REM
set BOOST_BASE=C:\Boost\include\boost-1_35
REM
REM If you need to manipulate the path, do it here
REM
REM
REM Finally, start VS with the appropriate solution file
REM
devenv MyProjectWithBoost.sln 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2020-04-24T11:51:58.973

**这比最初提出这个问题的时间晚了 11 年。我正在使用 VS 2019**

如果您想在事件中分配变量，例如......

设置ABC=123

然后你不能使用 $(ABC) 因为 $(ABC) 在它被交给命令行运行之前被处理。

您必须使用命令行所使用的 %ABC%。它不知道 $(ABC) 是什么，因为它只有 Visual Studio 才能理解。

为了使事情更加复杂，Visual Studio 事件编辑器使用 % 作为转义字符。我注意到从 %D 开始的东西不好，%K、%Z 和 %K 是好的。

显然您可以使用 %25 作为 % 的转义符。

%DESTDIR% 不会因为转义造成乱码 - 因此将其更改为 %25DESDIR%25 可以修复它。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-07T13:05:08.920

您可能想调查此工具：[http ://workspacewhiz.com/SolutionBuildEnvironmentReadme.html](http://workspacewhiz.com/SolutionBuildEnvironmentReadme.html)

我们一直使用它来管理构建环境中的环境变量。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-07T12:15:18.943

使用 SET 命令设置的环境变量是临时的，并且仅在设置它们的进程的生命周期内持续存在。当进程到期时，它们会立即到期 - 并且不能被其他进程看到。

Visual Studio 预生成事件是一个单独的过程。一旦该进程到期，该环境变量就不再存在。

您确定环境变量是您想要的吗？您可以通过在中央网络位置上保存的文本文件中设置一个值来做到这一点吗？

*编辑*：如果你真的想在 Windows 中持续更改环境变量，你可以这样做，但它会涉及调用一些 Windows API 而不仅仅是调用 SET。例如[http://code.activestate.com/recipes/416087/](http://code.activestate.com/recipes/416087/)

尝试谷歌搜索[环境变量窗口持久化](http://www.google.co.uk/search?hl=en&q=environment+variable+windows+persisting&meta=)

# c# - 如何更改虚拟模式DataGridView的行位置？

> ID：419980
> 
> 赞同：1
> 
> 时间：2009-01-07T11:33:52.707
> 
> 标签：c#, winforms, datagridview, scroll, virtualmode

如何更改虚拟模式DataGridView的行位置？

我正在使用[Windows 窗体](http://en.wikipedia.org/wiki/Windows_Forms)。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-08T20:51:24.623

您必须清除旧位置并设置新位置

集合 dataGridView1.SelectedRows 具有当前选定的行。根据网格的 MultiSelect 属性，您可能必须遍历 SelectedRows 中的所有行并将它们标记为未选中。如果您是单选模式，只需将新行设置为选中即可清除旧选择。

要选择特定行（在本例中为索引 0 处的行），您只需添加行 dataGridView1.Rows[0].Selected = true;

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-09T17:44:53.213

Marcus 的回答是正确的，但您可能还需要设置 DataGridView 的当前单元格属性...

```
dgv.CurrentCell = dgv.Rows[0].Cells[0]; 
```

我相信这会滚动网格。此外，为了绝对安全，您可能希望在另一行代码之前添加它......

```
dgv.CurrentCell = null; 
```

这将确保如果您想要的行已经是活动行但只是滚动出视图，它将滚动回视图。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-09T07:46:39.817

```
Private Sub GridSaleItem_SelectionChanged(ByVal sender As Object, ByVal e As System.EventArgs) Handles GridSaleItem.SelectionChanged
    Dim rowcount As Integer
    rowcount = GridSaleItem.Rows.Count
    For i As Integer = 1 To rowcount
        If i = 1 Then
            '
        Else
            If i = rowcount Then
                Me.GridSaleItem.CurrentCell = Me.GridSaleItem.Rows(i - 1).Cells(0)
                Me.GridSaleItem.Rows(i - 1).Selected = True
            End If
        End If
    Next

End Sub 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-12-26T16:41:49.163

```
Else
        If i = rowcount Then
            Me.GridSaleItem.CurrentCell = Me.GridSaleItem.Rows(i - 1).Cells(0)
            Me.GridSaleItem.Rows(i - 1).Selected = True
        End If
    End If
Next 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-05-05T08:01:28.670

您似乎不仅需要设置选定的行，还需要设置显示的行。`FirstDisplayedScrollingRowIndex`您可以使用DataGridView 上的属性访问后者。有用的设置之一：

```
int lastShown = FirstDisplayedScrollingRowIndex + DisplayedRowCount(false) - 2;

if (lastShown < yourIndex)
  FirstDisplayedScrollingRowIndex += yourIndex - lastShown;
else if (FirstDisplayedScrollingRowIndex > yourIndex)
  FirstDisplayedScrollingRowIndex = yourIndex; 
```

以编程方式向上/向下滚动时，将确保您新选择的行不会从屏幕上消失。

# terminal - 如何将大型机与运行 Windows 的 PC 连接起来？

> ID：419992
> 
> 赞同：5
> 
> 时间：2009-01-07T11:37:37.007
> 
> 标签：terminal, mainframe, zseries

如何将大型机与运行 Windows 的 PC 连接起来？它仍然将大型机视为运行 Unix 或 IBM System360 的具有高处理能力的计算机

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-01-07T11:53:40.467

我们每天都这样做。您可以使用标准 telnet 或 ssh（如果大型机已设置）连接到 OMVS/USS（UNIX 系统服务）子系统，但要访问 z/OS 接口（TSO/E 或 ISPF），您需要3270 仿真器，例如 x3270（我们使用 IBM 的 Personal Communicator 产品，因为它非常强大）。

大型机没有很快消失的危险。世界各地的各个 IBM 实验室仍在进行大量工作，而 64 位 z/OS（nee MVS、nee OS/390，...）已经走过了漫长的道路。

它仍然在大公司中使用，因为它是唯一可以信任其交易的东西 - System z 中的 z 意味着零停机时间，而这不仅仅是营销炒作。大型机的强大之处不在于它的 CPU 性能（单个处理器没有那么强大，但它们包含 54 个 CPU 并带有热备份，并且您可以在单个 System z 机器中运行许多书籍），但事实上CPU所做的只是处理指令。

*其他一切*都被卸载到专业处理器、用于 DB2 的 zIIP、用于 Java 工作负载的 zAAP、用于 I/O 的其他设备（而 I/O 是大型机使用光纤和*非常*大的磁盘阵列杀死所有其他系统的地方）。我不会将它用于蛋白质折叠，但它非常适合它的目标，大规模疯狂的交易处理水平。

z/OS 有一个 UNIX 子系统，z/VM 可以运行 z/OS、其他 z/VM 甚至 zLinux（RHEL 和 SLES）的多个副本——我见过一个 z800 机器同时运行数千个 RHEL 实例。这让所有 PC 制造商的“绿色”声明感到羞耻，并且实例之间的通信速度非常快，使用 HyperSockets（TCP/IP 但使用共享内存而不是通过慢速网络电缆（是的，与 HyperSockets 相比，即使是千兆以太网也爬行）（抱歉嵌套括号:-)))。

它在 Unix 空间中很好地运行 Websphere Application Server 和 Java，同时仍然允许所有传统的东西运行。事实上，大型机商店根本不需要购买基于 PC 的服务器，他们只需安装几个 zLinux 虚拟机并在一个机器上运行所有东西。

最近，有传言称 IBM 可能也会为其大型机提供 xSeries（即 PC）插件设备。虽然大多数大型机制造商会认为这是他们漂亮盒子侧面的一个疣，但它确实为第三方供应商开辟了*很多可能性。*我不确定他们是否能够运行数千个 Windows 实例，但这似乎是他们的目标（一个环来统治他们所有人？:-)。

如果您有兴趣，有一个名为 Hercules 的 System z 仿真器，我已经看到它在 Windows 机器上以 23 MIPS 运行（几乎不足以为您的大型机启动 ISPF），但它运行最后一个合法可用的 MVS 3.8j速度足够快，可以感受一下。

要为我工作中的一个朋友刚刚写的一本书提供一个无耻的插件，请查看[什么是大型机？](https://rads.stackoverflow.com/amzn/click/com/1409225356)大卫斯蒂芬斯 (ISBN-13 = 978-1409225355)。我发现这是非常宝贵的，因为我来自 PC/UNIX 背景，这是一个相当大的范式转变。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-07T11:40:39.463

为此，我们使用了一款名为[Rumba](http://www.microfocus.com/products/RUMBA/RUMBAMainframe.asp)的软件。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-07T11:46:45.257

大型机通常指的是像 IBM 的[zSeries](http://www.ibm.com/systems/z/)这样的“大铁”机器。连接到这样的机器的最佳方法是使用[5250 仿真器](http://en.wikipedia.org/wiki/5250)。有几个在 Windows 上运行的开源/免费模拟器可用，从该页面链接到。

您通常可以通过 telnet 或 SSH 进入机器，但进入某种 UNIX 仿真，它隐藏了本机操作系统的真正威力。如果您实际上是直接在一块硬件上运行 UNIX（例如[zLinux](http://www.ibm.com/systems/z/os/linux)），那么 SSH 应该没问题。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-07T11:57:11.380

对于 IBM z 系列，390 或其前身使用 3270 仿真器。

对于 IBM AS/400、iSeries，使用 5250 仿真器。

对于 Unix、VMS 和大多数其他系统，请使用 telnet 或 ssh。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-12T13:12:36.007

您还可以使用 IBM 的理性开发工具连接到大型机。它们提供了一个基于 eclipsed 的 GUI，允许您执行诸如编辑存储在 mvs 数据集中的源、提交和查看作业以及使用 GUI 调试程序等操作。我以前用过它，它比 ISPF 更容易使用，但我也是一名大学生，ISPF 经验很少，而且有很多 eclipse 经验。有关更多信息，请参阅此链接。 [http://www-01.ibm.com/software/awdtools/rdz/](http://www-01.ibm.com/software/awdtools/rdz/)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-07T11:41:04.503

[远程登录](http://en.wikipedia.org/wiki/Telnet)或[SSH](http://en.wikipedia.org/wiki/Ssh)。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-07T13:09:04.637

[MochaSoft](http://www.mochasoft.dk/tn3270.htm)出售价格相对较低的 Telnet3270 仿真器，以及许多其他终端仿真东西。通常比主流供应商（IBM、Attachmate 等）更轻、更友好

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-07T11:48:10.573

是的你可以。大型机使用 TCP/IP，它们被用作网络服务器。

您也可以使用终端仿真器。

如果我是正确的，System360 被称为 zOS。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2009-01-07T11:45:04.573

超级终端和长 RS232 电缆应该可以解决问题。在某种程度上还取决于 IBM 是否可以做 ASCII 或仅限于[EBCDIC](http://en.wikipedia.org/wiki/EBCDIC)。********************