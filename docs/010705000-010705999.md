# StackOverflow 问答 10705000-10705999

# php - DIV 的自动更新不起作用

> ID：10705000
> 
> 赞同：1
> 
> 时间：2012-05-22T15:19:38.057
> 
> 标签：php, javascript, jquery

我使用此脚本重新加载 ID 为新闻的 DIV，

```
<script type="text/javascript">
    var auto_refresh = setInterval(function() {
        <? if ($lim >= 5) 
            $lim = 0;
        else 
            $lim = $lim + 2;

        if ($cnt == 1){
            $lim = 0; 
            $cnt += 1;
        } ?>

        $('#news').load('update.php?lim=<? echo $lim ?>');
    }, 10000); // refresh every 10000 milliseconds
</script> 
```

update.php 包含此代码以接收 lim 的值，

```
$lim=$_GET['lim']; 
```

但每 10 秒后，'lim' 值被发送为 0。我需要根据脚本中的条件更新 'lim' 值。

我使用 echo 命令在 update.php 中检查了 $lim 值。始终为 0。我的代码中的错误是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T15:23:29.727

您似乎对什么是服务器端/客户端感到有些困惑。`$lim`是一个 PHP 变量，因此仅在服务器端可用。您需要将逻辑更改为 javascript。试试这个：

```
var lim = <? echo $lim ?>; // assuming lim is always a number this will work.
var cnt = 0; // just guessed at what this should be initially.
var auto_refresh = setInterval(function() {
    if (lim >= 5) 
        lim = 0;
    else 
        lim = lim + 2;

    if (cnt == 1){
        lim = 0; 
        cnt += 1;
    }

    $('#news').load('update.php?lim=' + lim);
}, 10000); // refresh every 10000 milliseconds 
```

或者，您可以更改逻辑以在计时器的每次迭代中发出 AJAX 请求，将`lim`变量传递给您的 PHP 并接收回新值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T15:24:02.813

当您的页面被渲染时，PHP 代码将只运行一次。它永远不会更新。呈现页面时，页面中的代码如下所示：

```
<script type="text/javascript">
    var auto_refresh = setInterval(function() {
        $('#news').load('update.php?lim=0');
    }, 10000); // refresh every 10000 milliseconds
</script> 
```

如果要更改 JavaScript 中 lim 参数的值，则必须在 JavaScript 中计算它。您可以使用 PHP 设置一个起始值，但同样，您只能使用这样的代码从 PHP 中获得一个值。

# java - Java：循环列表两次消耗双倍功率吗？

> ID：10705003
> 
> 赞同：2
> 
> 时间：2012-05-22T15:19:54.747
> 
> 标签：java, list, libgdx

LibGDX 附带了一个使用 MVC 模式的示例。

更新程序看起来像这样

```
List<Enemies> enemies = new List<Enemies>();

public void update() {
updateEnemies();
checkCollision();
}

void updateEnemies() {
 for each enemy //Loop enemies list{
   enemy.update();
  }

}

void checkCollison(){
   for each enemy//Loop enemies list{
    if(enemy.overlaps(hero.bounds) {
       //Do stuff
    }
   }
} 
```

现在它循环遍历敌人列表两次。我应该这样做吗？也许不是一个小列表，但我想添加很多列表，所以我应该合并它们吗？

干杯!

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-22T15:23:27.990

迭代本身很便宜，不太可能成为任何性能问题的根源。然而，没有什么是可以保证的；如果您想了解程序的性能特征，请使用分析器。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-22T15:31:36.740

**被警告。**在更新所有敌人时，他们都采取了新的立场。然后检查碰撞。如果您要循环执行：更新一个敌人并检查碰撞，您将检查一些敌人的过时位置。这可能无关紧要，也可能无关紧要。*一个 java 注释将按顺序排列： // 首先更新所有敌人： ... // 现在我们可以为新位置： .*

作为答案：开销是最小的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-22T15:37:23.130

从上面的代码可以看出，性能应该不错，因为您使用的循环是性能友好的：

```
for (Enemies enemy : enemies)
{
    //Do something here
} 
```

据此。[_](https://stackoverflow.com/questions/1006395/fastest-way-to-iterate-in-java)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-22T15:24:13.547

正在做：

```
for each element in collection
   operationA();
   operationB();
end for 
```

与以下操作基本相同：

```
for each element in collection
   operationA();
end for
for each element in collection
   operationB();
end for 
```

然而，第二个选项可能更清楚，因为每个循环都有一个特定的目标，并不是所有的东西都在同一个循环中混合在一起。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-22T15:37:42.877

理论上，一旦代码被执行，编译器可能会将两个循环合并在一起，或者以更好的方式对其进行优化。有时事情并没有按照它们看起来组合在一起的方式完全执行。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-22T15:44:42.680

合并循环会引入新的开销、意想不到的间隔......相反，对不同的方法使用相同的循环不会影响实践中的性能，它会让你的代码更清晰、更具可读性和可维护性。如果这些方法可以轻松处理使用每种方法捕获异常和其他自定义任务。

# mysql - 交易中的光标循环

> ID：10705005
> 
> 赞同：2
> 
> 时间：2012-05-22T15:19:59.097
> 
> 标签：mysql, loops, transactions, cursor

我什至无法让这个基本的 CURSOR LOOP 在我的事务中运行。

请帮忙。提前致谢！

```
CREATE PROCEDURE ClearItems(IN itemName CHAR)
BEGIN
    DECLARE done INT DEFAULT FALSE;
    DECLARE bID INT(255);
    DECLARE bIDs CURSOR FOR SELECT id FROM table1 WHERE column1 = itemName AND column2 = 'b' ORDER BY column3 DESC, date ASC;
    DECLARE CONTINUE HANDLER FOR NOT FOUND SET done = TRUE;
    START TRANSACTION;
        OPEN bIDs;
        clear_loop: LOOP
        FETCH bIDs INTO bID;
        IF done THEN
            LEAVE clear_loop;
            END IF;
        INSERT INTO table2 (column1) SELECT bID;
        END LOOP;
        CLOSE bIDs;
    COMMIT; 
END //
DELIMITER ; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T16:04:51.183

要解决此问题 - 重命名声明的 ID 变量。字段名称和变量不应相同。

* * *

此外，如果要填充另一个表，请尝试使用[INSERT ... SELECT](http://dev.mysql.com/doc/refman/5.1/en/insert-select.html)语句。它将帮助您避免使用游标。例如 -

```
INSERT INTO table2(`2column1`)
  SELECT id
    FROM table1
    WHERE `1column1` = itemName AND `1column2` = 'b'
    ORDER BY `1column3` DESC, date ASC; 
```

# perl - 如何使用 Perl 发送 IP 广播消息

> ID：10705007
> 
> 赞同：1
> 
> 时间：2012-05-22T15:20:01.503
> 
> 标签：perl, ip

我已经尝试过 Net::RawIP 和 Net::Write::Layer3。如果我在网络中提供特定的 IP 地址，它工作正常。当我得到任何一个时

```
sendto() at /usr/lib/perl5/Net/RawIP.pm line 630\. shell returned 13 
```

或者

```
Net::Write::Layer::send: Permission denied 
```

如果我将目标地址更改为 66.66.66.255

有任何想法吗？

我正在使用的代码在这里

```
use Net::Write::Layer qw(:constants);
use Net::Write::Layer3;
use NetAddr::IP;
use Net::RawIP;

$message = "Foo";

# using Net::RawIP
$n = Net::RawIP->new({
                        ip  => {
                            tos => 0xC0,
                            daddr => '66.66.66.2',
                            protocol => 2,
                        },
                        generic => {
                            data => $message
                        }
                    });
$n->send;

# using Net::Write::Layer3
my $desc = Net::Write::Layer3->new(
                dst      => '66.66.66.2',
                protocol => '2',
                family   => NW_AF_INET,
);    
$desc->open;
$desc->send($message);
$desc->close; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T15:28:48.360

错误 13 通常是`EACCES`- 即您没有足够的权限发送到广播套接字。

# ruby - 比较两个值并在 Ruby 中创建它们的组合

> ID：10705008
> 
> 赞同：-1
> 
> 时间：2012-05-22T15:20:03.690
> 
> 标签：ruby

我有红宝石

```
data = [[a, foo, 10, 1990],[b, foo2, 10, 1990],[c, foo3, 10, 1990],[d, foo4, 10, 1990], [e, foo5, 10, 1990]]
response = {{a, false},{b, false},{c, false},{e, false}} 
```

响应是数据的结果，并带回 ID 数据和新值。我试图做的是产生一个新值，其中响应用于查找 value 中的所有其他数据并产生一个新数组，例如

```
new = [[a, foo, 10, 1990, false],[b, foo2, 10, 1990, false],[c, foo3, 10, 1990, false], [e, foo5, 10, 1990, false]] 
```

response 将仅包含数据中的元素，但不是全部。

我曾尝试使用 .each 迭代数据 - 但我似乎无法检查响应数据。我不知道怎么。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T15:43:58.727

在你的问题中，（2）不是一个数组，（3）不是一个哈希，所以我必须推测你真正想要什么。

```
a = [[1,2,3],[2,3,4],[4,5,6]]
b = {1=>false, 2=>false}

ah = a.group_by(&:first)
b.map{|k,v| ah[k].first + [v]}
=> [[1, 2, 3, false], [2, 3, 4, false]] 
```

# c# - 我可以在Virtual PC 下运行的XP 上开发Win CE 6.0 / R3 应用程序吗？

> ID：10705012
> 
> 赞同：0
> 
> 时间：2012-05-22T15:20:15.340
> 
> 标签：c#, compact-framework, windows-ce, virtual-machine

我有 Windows 7 x64 电脑。我需要使用 C# 和 CF.NET 开发小型 Win CE 6.0 应用程序（可能安装了 R3）

**我打算在W7下安装Virtual PC，然后在上面安装XP，然后再安装VS2008和Win CE... 可以吗？**

设备是一些支持 CE 6.0 的摩托罗拉。

**是否可以连接实际设备**或者我必须坚持使用模拟器？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T15:34:37.627

您*可以*在Virtual PC 下进行开发。您*不能*在 Virtual PC 下使用模拟器（它需要在虚拟机中运行虚拟机，这不是工作场景）。我认为您也不能使用 USB 连接进行调试 - 我认为 VMWare 确实允许这样做。我说“不要想”，因为我完全不记得上次尝试通过 USB 进行调试是什么时候了——已经好几年了。但是，您*可以*[在没有 ActiveSync 的情况下通过以太网进行调试，](http://msdn.microsoft.com/en-us/library/ms228708%28v=VS.90%29.aspx)而且它比 USB 更快。

顺便说一句，对于应用程序开发，您根本不需要安装 Platform Builder，因此您可能希望节省时间和头痛，而不是打扰。

# web-services - 当您将相互 SSL 与客户端证书一起使用时，是否有任何理由签署消息正文

> ID：10705016
> 
> 赞同：3
> 
> 时间：2012-05-22T15:20:19.927
> 
> 标签：web-services, security, authentication, ssl

我最近不得不使用两个大型实体实现 XML 消息传递，这需要我们提供 SSL 客户端证书以及使用不同的签名证书对 SOAP 消息体进行签名。除了冗余之外，**使用不同证书**对消息正文进行签名是否提供任何额外的保护？

编辑以澄清问题并指出我与 EJP 之间长达数年的误解。

除了使用带有相互身份验证（客户端证书）的 SSL 之外，对消息进行签名的价值在于您获得了不可否认性。但是，无论是使用客户端证书对消息进行签名还是使用不同的签名证书，您都会知道。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-22T22:16:11.873

签署该消息提供了对交易的法律强制不可否认性。您有证据证明该客户并且只有该客户可以发送该消息，并且您可以在法庭上重复签名验证以证明。SSL 在技术上以较低的级别为您提供相同的东西，但是您没有任何方法可以获取签名，因此您无法在法庭上出示它：您只能手握证据，而不是实际的数字签名，这是一个合法的签名，因此是*表面*证据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T18:22:53.073

我不知道我会把它称为“保护”，但这是两件不同的事情。SSL 证书用于验证您的身份以用于加密/传输目的。

SOAP 签名允许最终用户验证 XML 自创建者（您）签名后未被更改。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-22T20:21:07.607

使用传输层安全性，您的安全性在传输层结束。*通过签署 SOAP 消息，您可以为应用*层提供端到端的身份验证。

如果没有 SSL 客户端证书，互联网上的任何人都可以与您的后端服务器通信。这会增加您的攻击面。

如果没有应用层安全，想象一下如果攻击者控制了 SSL 负载均衡器/反向代理会发生什么。（他们可以将任何他们想要的 SOAP 消息发送到您的后端服务器而无需身份验证？！）

所以看起来他们都提供了一些价值，是的。

我要问的另一个问题是，如何保护密钥（即 SSL 客户端证书和 SOAP 签名证书）？如果攻击者获得对两个密钥的控制权是微不足道的，那将减少这种方法的回报。

通过使用与验证连接不同的密钥来签署 SOAP 消息，您还可以在如何执行 PKI 方面提供更大的灵活性。例如，您的网络管理团队可能希望为每个组织颁发一个 SSL 客户端证书，但应用程序团队可能希望该组织中的每个实体拥有一个 SOAP 消息签名证书。

# windows - 显示光标不工作

> ID：10705017
> 
> 赞同：1
> 
> 时间：2012-05-22T15:20:23.217
> 
> 标签：windows, user32

我正在尝试编写一个简单的 C# win32 控制台应用程序，它使用 ShowCursor (user32.dll) 来隐藏系统鼠标。调用 ShowCursor(false) 返回 -1（应该如此），但鼠标光标仍然存在。使用 ShowCursor(true) 再次调用返回 1（但没有可见效果，因为光标从未消失）。

谢谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-22T15:23:45.000

`ShowCursor`当鼠标在您的线程创建的窗口上时会影响鼠标。您的控制台应用程序可能没有创建任何窗口，因此`ShowCursor`没有任何效果。

# cocoa-touch - UITableView 中不包含在单元格中的文本

> ID：10705018
> 
> 赞同：0
> 
> 时间：2012-05-22T15:20:24.500
> 
> 标签：cocoa-touch, uitableview

如何将非单元格文本添加到 a 中`UITableView`？例如，在 iPhone 上，在“设置”>“声音”中有文字“可以使用...等调整铃声和警报的音量”。此文本不是单元格或节标题，其字体与节标题不同，并且不会出现在单元格本身中。那么如何添加呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T15:29:55.030

他们可能正在使用自定义视图作为页脚。在[`UITableViewDelegate`协议参考](http://developer.apple.com/library/ios/documentation/UIKit/Reference/UITableViewDelegate_Protocol/Reference/Reference.html#//apple_ref/occ/intfm/UITableViewDelegate/tableView%3aviewForFooterInSection%3a)中有方法：

```
- (UIView *)tableView:(UITableView *)tableView viewForFooterInSection:(NSInteger)section; 
```

您可以创建一个没有背景的自定义视图，并且只包含该特定部分的带有文本的标签。

# google-apps-script - 意外错误 Google Apps 脚本

> ID：10705019
> 
> 赞同：0
> 
> 时间：2012-05-22T15:20:26.713
> 
> 标签：google-apps-script

我写了一个表格，但现在我收到了一个意外错误。

```
function showCompletePage(){
  var app = UiApp.getActiveApplication();
  app.getElementById('rightPanel').setVisible(false);
  var pnl = app.createVerticalPanel().setId('outro');
  var text = "<p>Uw aanvraag is met succes verwerkt.</p>";
  text += "<p>U zal zo meteen een offerte ontvangen via mail.<br />Verzeker u ervan dat de mail niet in uw spam toegekomen is.</p>";
  text += "<p>Gelieve de offerte binnen de drie dagen terug te sturen, zodat uw reservatie definitief bevestigd kan worden.</p>";
  pnl.add(app.createHTML(text).setId('final'));

  var el = app.createButton('Klik hier indien u nog een opleiding wil reserveren').setId('anotherOne');
  el.addClickHandler(app.createServerHandler("startAgain"));
  app.add(pnl);
  app.add(el);

  return app;
}

function startAgain(e){
  Logger.log('restart');
  var app = UiApp.getActiveApplication();
  app.getElementById('startAgain').setVisible(false);
  app.getElementById('outro').setVisible(false);
  buildUI();

  return app;
} 
```

`app.getElementById('outro').setVisible(false);` 我已经发现当我在函数 startAgain() 中注释该行时不会出现错误

有人知道我在做什么错吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T16:02:43.933

我刚刚测试了你的确切代码，它在这里按预期工作......出于测试目的，我创建了一个显示另一个 UI 的 showCompletePage() 函数，我实际上可以从一个切换到另一个......所以也许错误存在于其他地方？在 showCompletePage 部分？

这是测试代码，你的部分没有改变：

```
function buildUI() {
  var app = UiApp.createApplication().setHeight(130).setWidth(400);
  app.setTitle("Search by name / lastname / adress");
  var panel = app.createVerticalPanel().setId('rightPanel');
  var txtBox = app.createTextBox();
  var label=app.createLabel(" Item to search for :")
  panel.add(label);
  txtBox.setId("item").setName("item");
  var label0=app.createLabel("Row").setWidth("40");
  var label1=app.createLabel("Name").setWidth("120");
  var label2=app.createLabel("Lastname").setWidth("120");
  var label3=app.createLabel("Street").setWidth("120");
  var hpanel = app.createHorizontalPanel();
  hpanel.add(label0).add(label1).add(label2).add(label3)
//
  var txt0=app.createTextBox().setId("lab0").setName("0").setWidth("40");
  var txt1=app.createTextBox().setId("lab1").setName("txt1").setWidth("120");
  var txt2=app.createTextBox().setId("lab2").setName("txt2").setWidth("120");
  var txt3=app.createTextBox().setId("lab3").setName("txt3").setWidth("120");
  var hpanel2 = app.createHorizontalPanel();
  hpanel2.add(txt0).add(txt1).add(txt2).add(txt3)
  var hidden = app.createHidden().setName("hidden").setId("hidden");
  var subbtn = app.createButton("next ?").setId("next").setWidth("250");
  panel.add(txtBox);
  panel.add(subbtn);
  panel.add(hidden);
  panel.add(hpanel);
  panel.add(hpanel2);
//
  var submitHandler = app.createServerHandler("showCompletePage");
  subbtn.addClickHandler(submitHandler);
  submitHandler.addCallbackElement(panel);
//
  app.add(panel);  
  ss.show(app);
  }
//
function showCompletePage(){
  var app = UiApp.getActiveApplication();
  app.getElementById('rightPanel').setVisible(false);
  var pnl = app.createVerticalPanel().setId('outro');
  var text = "<p>Uw aanvraag is met succes verwerkt.</p>";
  text += "<p>U zal zo meteen een offerte ontvangen via mail.<br />Verzeker u ervan dat de mail niet in uw spam toegekomen is.</p>";
  text += "<p>Gelieve de offerte binnen de drie dagen terug te sturen, zodat uw reservatie definitief bevestigd kan worden.</p>";
  pnl.add(app.createHTML(text).setId('final'));

  var el = app.createButton('Klik hier indien u nog een opleiding wil reserveren').setId('anotherOne');
  el.addClickHandler(app.createServerHandler("startAgain"));
  app.add(pnl);
  app.add(el);

  return app;
}

function startAgain(e){
  Logger.log('restart');
  var app = UiApp.getActiveApplication();
  app.getElementById('startAgain').setVisible(false);
  app.getElementById('outro').setVisible(false);
  buildUI();

  return app;
} 
```

# actionscript-3 - AS3 - 图像平滑

> ID：10705021
> 
> 赞同：1
> 
> 时间：2012-05-22T15:20:31.677
> 
> 标签：actionscript-3, bitmapdata

如何为从 BitmapData 数组获取的图像添加平滑处理？

我的代码：

```
con.addChild(new Bitmap(myImage[0])) 
```

谢谢。乌里

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-22T15:23:01.580

尝试：

```
con.addChild(new Bitmap(myImage[0], "auto", true)) 
```

# ios - 将 NSObject 的所有属性编码为 NSData

> ID：10705022
> 
> 赞同：2
> 
> 时间：2012-05-22T15:20:33.937
> 
> 标签：ios, nsdata, nsobject, nscoding

所以我是 iOS 新手，但我对一个简单任务的复杂性感到有点困惑。我正在尝试将名为“Vehicle”的自定义 NSObject 类存储在 NSUserDefaults 中。显然，这是做不到的，所以我需要先将其编码为 NSDATA。美好的。

但这意味着我需要在解码中对类的每个属性进行编码......

**在我的车辆类中......**

```
- (void) encodeWithCoder: (NSCoder *) coder
{
    [coder encodeInt: x  forKey: @"x"];
    [coder encodeInt: y  forKey: @"y"];
    [coder encodeInt: direction  forKey: @"direction"];

} // encodeWithCoder

- (id) initWithCoder: (NSCoder *) coder
{
    if (self = [super init]) {
        x = [coder decodeIntForKey: @"x"];
        y = [coder decodeIntForKey: @"y"];
        direction = [coder decodeIntForKey: @"direction"];
    }

    return (self);

} // initWithCoder 
```

如果我最终向车辆类添加了一个新属性，我还必须添加编码和解码逻辑。这与使用 CopyWithZone 创建类的副本相同。这留下了 3 或 4 个区域，向类添加新属性可能会出错。

我目前主要在 LabVIEW 中编程，我们有能力获取一个类，并将其提供给编码器，它会自动完成所有版本控制和属性操作。

所以我想我的问题是：

1.  这在iOS中没有听说过吗？
2.  如果不可能，有没有办法枚举类中的所有属性并编写一个函数来自动执行此操作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T15:23:41.643

您可以使用objective-c 运行时来查找对象的所有属性并对其进行解码，但我不建议这样做。如果您愿意，我可以为您创建一个简单的示例。

编辑：这是一个例子：

```
#import <objc/runtime.h>

void decodePropertiesOfObjectFromCoder(id obj, NSCoder *coder)
{
    // copy the property list
    unsigned propertyCount;
    objc_property_t *properties = class_copyPropertyList([obj class], &propertyCount);

    for (int i = 0; i < propertyCount; i++) {
        objc_property_t property = properties[i];

        char *readonly = property_copyAttributeValue(property, "R");
        if (readonly)
        {
            free(readonly);
            continue;
        }

        NSString *propName = [NSString stringWithUTF8String:property_getName(property)];

        @try 
        {
            [obj setValue:[coder decodeObjectForKey:propName] forKey:propName];
        }
        @catch (NSException *exception) {
            if (![exception.name isEqualToString:@"NSUnknownKeyException"])
            {
                @throw exception;
            }

            NSLog(@"Couldn't decode value for key %@.", propName);
        }
    }

    free(properties);
}

void encodePropertiesOfObjectToCoder(id obj, NSCoder *coder)
{
    // copy the property list
    unsigned propertyCount;
    objc_property_t *properties = class_copyPropertyList([obj class], &propertyCount);

    for (int i = 0; i < propertyCount; i++) {
        objc_property_t property = properties[i];

        char *readonly = property_copyAttributeValue(property, "R");
        if (readonly)
        {
            free(readonly);
            continue;
        }

        NSString *propName = [NSString stringWithUTF8String:property_getName(property)];

        @try {
            [coder encodeObject:[obj valueForKey:propName] forKey:propName];
        }
        @catch (NSException *exception) {
            if (![exception.name isEqualToString:@"NSUnknownKeyException"])
            {
                @throw exception;
            }

            NSLog(@"Couldn't encode value for key %@.", propName);
        }
    }

    free(properties);
}

__attribute__((constructor))
static void setDefaultNSCodingHandler()
{
    class_addMethod([NSObject class], @selector(encodeWithCoder:), imp_implementationWithBlock((__bridge void *)[^(id self, NSCoder *coder) {
        encodePropertiesOfObjectToCoder(self, coder);
    } copy]), "v@:@");
    class_addMethod([NSObject class], @selector(initWithCoder:), imp_implementationWithBlock((__bridge void *)[^(id self, NSCoder *coder) {
        if ((self = [NSObject instanceMethodForSelector:@selector(init)](self, @selector(init))))
        {
            decodePropertiesOfObjectFromCoder(self, coder);
        }

        return self;
    } copy]), "v@:@");
} 
```

这允许您对任何公开了足够属性以重建自身的对象进行编码。

# iphone - iOS 以编程方式创建的按钮不起作用

> ID：10705027
> 
> 赞同：4
> 
> 时间：2012-05-22T15:20:53.813
> 
> 标签：iphone, objective-c, ios, ios4, uibutton

嗨，我有一个`UIButton`我以编程方式创建的，但不幸的是它不起作用。当我点击`UIButton`什么都没有发生。我不知道是什么问题。任何帮助，将不胜感激。

```
UIButton *connectedStories = [UIButton buttonWithType:UIButtonTypeRoundedRect];

//set the position of the button
connectedStories.frame = CGRectMake(10, 10, 1900, 30);
connectedStories.backgroundColor = [UIColor whiteColor]; 
[connectedStories setTitle:@"Button" forState:UIControlStateNormal];
[connectedStories setTitleColor:[UIColor blackColor] forState:UIControlStateNormal];
[connectedStories addTarget:self action:@selector(buttonClicked) forControlEvents:UIControlEventTouchUpInside];
[label setText:storyTitle];
[label1 setText:storyDescription];
[contentView addSubview:backGroundImageView];
[contentView addSubview:connectedStories];
[contentView addSubview:label];
[contentView addSubview:label1];

[viewContainer addSubview:contentView];
return contentView;

- (void)buttonClicked
{
  NSLog(@"button clicked");
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T15:36:31.663

我认为标签接收触摸而不是按钮。添加 userInteractionEnabled = NO; 到你的标签。

```
label.userInteractionEnabled = NO;
label1.userInteractionEnabled = NO; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T15:47:28.873

尝试将代码的顶部更改为：

```
CGRect frame = CGRectMake(10, 10, 1900, 30);
UIButton *connectedStories = [[UIButton alloc] initWithFrame:frame];

//set the position of the button
[connectedStories setBackgroundColor:[UIColor whiteColor]]; 
[connectedStories setTitle:@"Button" forState:UIControlStateNormal];
[connectedStories setTitleColor:[UIColor blackColor] forState:UIControlStateNormal];
[connectedStories addTarget:nil action:@selector(buttonClicked) forControlEvents:UIControlEventTouchUpInside]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-23T01:36:07.373

很可能是以下内容：

```
[contentView addSubview:backGroundImageView];
[contentView addSubview:connectedStories];
[contentView addSubview:label];
[contentView addSubview:label1]; 
```

我确定您需要按以下顺序添加它们：

```
[contentView addSubview:backGroundImageView];
[contentView addSubview:label];
[contentView addSubview:label1];
[contentView addSubview:connectedStories]; 
```

这是因为当您调用`addSubview:`它时，它会将其添加到子视图的接收者列表的末尾，并且最新的子视图出现在顶部。

[在此处](http://developer.apple.com/library/ios/#documentation/uikit/reference/uiview_class/uiview/uiview.html)查看 UIView 文档

未检测到交互的原因是您没有将 touchEvents 传递给其他子视图，因为它们被 label1 捕获并停在那里。

默认情况下，最后一个 subView 捕获所有触摸事件并且不传递它们。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-15T10:50:23.443

在选择器的最后一个方法中添加冒号

```
[connectedStories addTarget:self action:@selector(buttonClicked:) forControlEvents:UIControlEventTouchUpInside];
    [label setText:storyTitle]; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-12-31T10:38:22.740

```
UIButton *custombutton = [UIButton buttonWithType:UIButtonTypeRoundedRect];
[custombutton addTarget:self
                 action:@selector(aMethod:)
       forControlEvents:UIControlEventTouchUpInside];
[custombutton setTitle:@"Click" forState:UIControlStateNormal];
custombutton.frame = CGRectMake(80.0, 110.0, 160.0, 40.0);
custombutton.titleLabel.textColor = [UIColor colorWithRed: 2.0f/255.0f green: 155.0f/255.0f blue: 213.0f/255.0f  alpha:1];
 [custombutton setImage:[UIImage imageNamed:@"hh.png"] forState:UIControlStateNormal];
 [view addSubview:custombutton]; 
```

# ios - 存储贝宝 api 凭据的最佳和安全方式

> ID：10705030
> 
> 赞同：0
> 
> 时间：2012-05-22T15:21:11.033
> 
> 标签：ios, security, ssl, paypal

我正在创建一个集成了适用于 iOS 的 PayPal API 的 iPhone 应用程序。API 在发送请求时需要 API 凭据。我阅读了 PayPal API，它说

> 切勿从您的移动应用程序直接向 PayPal 发送 Express Checkout 请求。这些请求需要您的 PayPal API 凭据。将您的凭据放在移动设备上会使您和 PayPal 面临不可接受的安全风险。仅从安全服务器发送 Express Checkout 请求。

我的问题是，存储 API 凭据以减少我的凭据被暴露或被黑客入侵的可能性的最佳方式是什么？将凭据附加到 iPhone 版本是否有风险？为什么或如何？将这些凭据存储在安全的服务器上是否足够可靠？

编辑：iOS 上的钥匙串访问 api 如何帮助我解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T16:25:15.460

将 API 密钥放入您的应用程序是完全不安全的。通过多种技术，任何可以下载该应用程序或拿到带有该应用程序的手机的人都可以简单地读取 API 密钥。即使您按照@MatthiasBauch 的建议进行操作并稍后下载秘密，这仍然成立。即使您执行@Rexeisen 建议的操作并混淆字符串，它也成立。

你最好的选择是使用苹果的内置订阅服务来处理付款（这可能不适用，他们会削减，但可能比你在手机上做的更安全）

即使您不想或不能这样做，也可以为应用程序的每个实例提供一个唯一 ID，当他们使用您控制的服务器下载时，他们会注册该 ID。该服务器具有贝宝凭据，并将代表他们进行 api 调用。这样，如果任何给定的手机被盗/读取了服务器的 api 密钥，您可以简单地撤销该密钥，并且您的 paypal API 密钥仍然是安全的。重要警告：在您真正撤消该应用程序的密钥之前，拥有它的任何人仍然可以使用它来制作您的服务器支持的任何调用。这可能是一件非常糟糕的事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T15:36:46.500

这是有风险的，因为您几乎可以在任何应用程序上运行字符串实用程序（尝试一下，这有点吓人）并从代码中获取字符串。一般来说，我建议将秘密打包在应用程序中，但将它们放在其他地方的安全服务器上。如果您必须将其放入应用程序中，您可以做的一件事是混淆字符串，使其不明显。

```
NSString *secret = kTwitterClientSecret;
NSData *secretData = [secret dataUsingEncoding:NSUTF8StringEncoding];
NSString *key = @"Twitter";
[secretData obfuscateOrDeobfuscateWithKey:key];
NSString *documentsPath = [NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES) lastObject];
NSString *path = [NSString stringWithFormat:@"%@/%@-%@", documentsPath, key, @"output"];
[secretData writeToFile:path atomically:NO];
NSLog(@"Wrote obfuscated data to: %@", documentsPath); 
```

其中 obfuscateOrDeobfuscateWithKey 是 NSData 上的一个类别

```
// Inspiration from: http://iosdevelopertips.com/cocoa/obfuscation-encryption-of-string-nsstring.html
- (void)obfuscateOrDeobfuscateWithKey:(NSString *)key
{
    // Get pointer to data to obfuscate
    char *dataPtr = (char *) [self bytes];

    // Get pointer to key data
    char *keyData = (char *) [[key dataUsingEncoding:NSUTF8StringEncoding] bytes];

    // Points to each char in sequence in the key
    char *keyPtr = keyData;
    int keyIndex = 0;

    // For each character in data, xor with current value in key
    for (int x = 0; x < [self length]; x++) {
        // Replace current character in data with current character xor'd with current key value.
        // Bump each pointer to the next character.
        *dataPtr = *dataPtr ^ *keyPtr;
        dataPtr++;
        keyPtr++;

        // If at end of key data, reset count and set key pointer back to start of key value
        if (++keyIndex == [key length]) {
            keyIndex = 0, keyPtr = keyData;
        }
    }
} 
```

然后你可以声明一个常量就像

```
static unsigned char const kTwitterClientSecret[] = {
    0x00, 0x00, 0x00, ... etc ... 
};
static unsigned int const kTwitterClientSecret_len = LENGTH; 
```

然后要找回字符串，您可以这样做

```
[NSString deobfuscatedStringWithBytes:kTwitterClientSecret length:kTwitterClientSecret_len key:@"Twitter"]; 
```

这是 NSString 上的一个类别

```
+ (NSString *)deobfuscatedStringWithBytes:(const void *)bytes length:(NSUInteger)length key:(NSString *)key
{
    NSData *deobfuscatedData = [NSData dataWithBytes:bytes length:length];
    [deobfuscatedData obfuscateOrDeobfuscateWithKey:key];
    return [[NSString alloc] initWithData:deobfuscatedData encoding:NSUTF8StringEncoding];
} 
```

这将进行非常简单的混淆，并且不会出现在字符串中。

# cakephp-1.3 - Find() 使用可包含的深度关联，模型关联

> ID：10705034
> 
> 赞同：0
> 
> 时间：2012-05-22T15:21:33.830
> 
> 标签：cakephp-1.3

我正在尝试构建一个显示用户备忘录表格的视图。备忘录有一个类型 (memo_type) 和几个作者——作者表由记录组成： `id, memo_id, user_id, precedence`，而备忘录类型是 `id, memo_type_desc`。（备忘录也有一个所有者（Memo.user_id），但这是一个简单的查询，我有一个单独的表可以正常工作）

这个想法是，当我查看有关用户的详细信息时，我会显示该用户列为作者的所有备忘录的表格，并包括备忘录类型（信件、演示文稿等）

因此，虽然我可以使用 recursive=3 从 read() 中获取我需要的数组（*见下文*），但这很慢并且会检索大量数据，所以我尝试使用 contains。（我可以省略 memo_type_desc 但最终用户想要它。）

好的，所以我`public $actsAs = array('Containable');` 输入`app_model.php`

这里要注意的一件大事是，无论 MemoTypes 的附加关联级别如何，我都会返回相同的数组——当我添加时， `=> array('MemoTypes.memo_type_desc')` 我看不到数组中的附加级别。有了这个第三级关联，我也得到了一个错误：

*警告 (512)：模型“Memo”与模型“MemoTypes”无关 [CORE/cake/libs/model/behaviors/containable.php，第 343 行*

模型关联如下，这里是 user_controller 中的 View 函数。知道我的备忘录/备忘录类型关联或 find() 语法有什么问题吗？

编辑：哦，我是蛋糕新手，我继承了这个应用程序。PS，表格是由view.ctp中的foreach构建的，但是分页肯定会更好，但不知道从哪里开始。=O

```
// Trying to get Containable method to work...
$this->set('userstuff', $this->User->find('all', array(
    'conditions' => array('User.id' => $id),
    'contain' => array(
        'Author.user_id',
        'Author.precedence',
        'Author.memo_id' => array(
            'Memo.memo_type_id' => array(
                'MemoTypes.memo_type_id' // <--problem here?
            )
        )
    )
))); 
```

结果：

```
Array
(
    [0] => Array
        (
            [User] => Array
                (
                    [id] => 1026
                    [group_id] => 2
                    [name] => John Doe
                    [username] => jd20001
                    [grpnum] => 99
                    [created] => 2010-03-22 15:08:35
                    [modified] => 2012-04-05 13:31:15
                )

            [Author] => Array
                (
                    [0] => Array
                        (
                            [user_id] => 1026
                            [precedence] => 0
                            [memo_id] => 2579
                            [Memo] => Array
                                (
                                    [memo_type_id] => 1
                                )

                        )

                    [1] => Array
                        (
                            [user_id] => 1026
                            [precedence] => 0
                            [memo_id] => 2583
                            [Memo] => Array
                                (
                                    [memo_type_id] => 1
                                )

                        )

                    [2] => Array... 
```

更多的：

```
// Works, but retrieves entire users/memos tables so large memory footprint
$this->User->recursive = 3;
$this->set('user', $this->User->read(null, $id)); 
```

用户.php：

```
var $belongsTo = array(
    'Group' => array(
        'className' => 'Group',
        'foreignKey' => 'group_id'
    )
);
var $hasMany = array(
    'Author' => array(
        'className' => 'Author',
        'foreignKey' => 'user_id',
        'dependent' => true
    ),
    'Memo' => array(
        'className' => 'Memo',
        'foreignKey' => 'user_id',
        'dependent' => false
    )
); 
```

备忘录.php：

```
var $hasMany = array(
    'Author' => array(
        'className' => 'Author',
        'foreignKey' => 'memo_id',
        'dependent' => true,
        'order' => 'precedence'
    )
);
var $belongsTo = array(
    'User' => array(
        'className' => 'User',
        'foreignKey' => 'user_id',
        'conditions' => '',
        'fields' => '',
        'order' => ''
    ),
    'MemoType' => array(
        'className' => 'MemoType',
        'foreignKey' => 'memo_type_id',
        'conditions' => '',
        'fields' => '',
        'order' => ''
    )
); 
```

备忘录类型.php：

```
var $hasMany = array(
    'Memo' => array(
        'className' => 'Memo',
        'foreignKey' => 'memo_type_id',
        'dependent' => false
    )
); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T16:07:56.520

好吧，更多的阅读，我终于“明白了”（在发布我的问题后仅仅一个小时的努力......有趣的是它是如何工作的）。

用户和组给我我的主要信息，然后备忘录让我建立一个“拥有”文档的表格，作者给我关于用户被列为作者的所有文档的数据！哇，在使用 CakePHP 一年之后，我现在才真正欣赏它 :)

```
$this->set('user', $this->User->find('first', array(
    'conditions' => array('User.id' => $id),
    'contain' => array(
        'Group',
        'Memo',
        'Author' => array(
            'Memo' => array(
                'MemoType' => array(
                    'fields' => array('memo_type_desc')
                )
            )
        )
    )
))); 
```

# xcode - xcode UI 自动化脚本在 iPhone 上运行良好，但在 iPad 上失败

> ID：10705037
> 
> 赞同：1
> 
> 时间：2012-05-22T15:21:43.657
> 
> 标签：xcode, ipad, ui-automation

我在 UI 自动化中有脚本，我在 iPhone（真实设备和 SW 模拟器）上运行，它们运行良好。但是当我在 iPad 上运行脚本时，脚本失败了。

例如：target.frontMostApp().mainWindow().tableViews()["空列表"].cells()["标签："].buttons()[0].tap();

此行在 iPhone 上运行良好，但在 iPad 上失败并出现以下错误（脚本正在尝试 scrollToVisible - :/）：

target.frontMostApp().mainWindow().tableViews()["空列表"].cells()["标签："].buttons()[0].scrollToVisible() target.frontMostApp().mainWindow()。 tableViews()["Empty list"].cells()["Tags:"].buttons()[0] 无法点击脚本抛出未捕获的 JavaScript 错误：target.frontMostApp().mainWindow().tableViews() ["空列表"].cells()["Tags:"].buttons()[0] 无法点击

有什么建议么？谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-14T12:22:06.473

你可以使用功能，比如这个

```
//function
var _Model=function()
{
 var model=target.model();
 UIALogger.logMessage(model);
 return model;
}
//your main case
if(_Model()==='iPhone Simulator') 
{
 target.frontMostApp().mainWindow().tableViews()["Empty list"].cells()["Tags:"].buttons()[0].tap();
}
else if(_Model()==='iPad Simulator') 
{ 
  //here you should write another way to tap Tags: Button
  //you can use record or logtree for getting element ID
} 
else 
{
 UIALogger.logFail("impossible to understand device type");
} 
```

# css - CSS - 扩展类属性

> ID：10705038
> 
> 赞同：17
> 
> 时间：2012-05-22T15:21:48.600
> 
> 标签：css, stylesheet

我对 CSS 很陌生，到目前为止一直在寻找我的方式。我正在创建这些按钮，例如带有阴影和东西的链接。现在网站上需要几个这样的按钮——关于按钮的一切都是一样的——除了很少的属性改变，比如宽度和字体大小。

现在不是复制相同的代码 - 一遍又一遍地为每个按钮 - 有一种方法可以扩展按钮并仅添加更改的属性。

两个按钮的示例 - css

```
.ask-button-display {
background: #8BAF3B;
border-radius: 4px;
display: block;
letter-spacing: 0.5px;
position: relative;
border-color: #293829;
border-width: 2px 1px;
border-style: solid;
text-align:center;
color: #FFF;
width:350px;
font-size: 20px;
font-weight: bold;
padding:10px;
}

.ask-button-submit {
background: #8BAF3B;
border-radius: 4px;
display: block;
letter-spacing: 0.5px;
position: relative;
border-color: #293829;
border-width: 2px 1px;
border-style: solid;
text-align:center;
color: #FFF;
font-weight: bold;
width:75px;
font-size: 12px;
padding: 1px;
} 
```

这就是我目前在我的 html 中使用它的方式

```
<a href="/" id="ask-question-link" class="ask-button-display">Ask a Question</a> <a href="/" class="ask-button-submit" id="ask-button-submit">Submit</a> 
```

所以我想知道是否有更清洁的方法来做到这一点 - 比如

```
.button {
/* PUT ALL THE COMMON PROPERTIES HERE */
}

AND THEN SOMEHOW EXTEND IT LIKE
.button #display {
/* THE DIFFERENT PROPERTIES OF Display BUTTON */
}

.button #ask {
/* THE DIFFERENT PROPERTIES OF Ask BUTTON */
} 
```

但我不知道该怎么做。感谢您的投入

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-05-22T15:25:56.290

您可以为一个元素添加多个类，因此有一个涵盖所有内容的 .button 类，然后是一个添加内容的 .button-submit 类。

例如：

```
.button {
    padding: 10px;
    margin: 10px;
    background-color: red;
}

.button-submit {
    background-color: green;
}​ 
```

[在此处](http://jsfiddle.net/jackdent/QKP6Y/1/)查看实时 jsFiddle

在您的情况下，以下应该有效：

```
.button {
    background: #8BAF3B;
    border-radius: 4px;
    display: block;
    letter-spacing: 0.5px;
    position: relative;
    border-color: #293829;
    border-width: 2px 1px;
    border-style: solid;
    text-align:center;
    color: #FFF;
    width:350px;
    font-size: 20px;
    font-weight: bold;
    padding:10px;
}

.button-submit {
    width:75px;
    font-size: 12px;
    padding: 1px;
}​ 
```

[在此处](http://jsfiddle.net/jackdent/QKP6Y/2/)查看实时 jsFiddle

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2014-09-10T10:30:34.243

你可能想试试这个：

```
.button {
    padding: 10px;
    margin: 10px;
    background-color: red;
}

.button.submit {
    background-color: green;
}
.button.submit:hover {
    background-color: #ffff00;
} 
```

这样你就可以避免重复这个词，并且能够像这样使用元素中的类：

```
<a href="/" id="btnAsk" class="button">Ask a Question</a> 
<a href="/" id="btnSubmit" class="button submit">Submit</a> 
```

请参阅 JSFiddle ( [http://goo.gl/6HwroM](http://goo.gl/6HwroM) )中的示例

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-05-22T15:31:02.197

而不是重复常见的“向元素添加按钮类”答案，我将向您展示新时代 CSS 或更广为人知的 SCSS 的奇怪而古怪的世界中的一些新东西！

样式表中代码的这种重用可以通过称为“混合”的东西来实现。这允许我们做的是通过使用“@include”属性重用某些样式。

让我给你举个例子。

```
@mixin button($button-color) {
    background: #fff;
    margin: 10px;
    color: $color;
} 
```

然后每当我们有一个按钮我们说

```
#unique-button {
    @include button(#333);
    ...(additional styles)
} 
```

在此处阅读更多信息：http: [//sass-lang.com/tutorial.html](http://sass-lang.com/tutorial.html)。

传播这个词！！！

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-05-22T15:24:54.570

您可以这样做，因为您可以将多个类应用于一个元素。创建您的大师班和其他较小的课程，然后根据需要应用它们。例如：

```
<a href="/" id="ask-question-link" class="button submit">Ask a Question</a> <a href="/" class="ask-button-submit" id="ask-button-submit">Submit</a> 
```

这将应用按钮并提交您将创建的类，同时允许您单独应用这些类。

沿以下行修改您的代码示例：

```
.master_button {
/* PUT ALL THE COMMON PROPERTIES HERE */
}
AND THEN SOMEHOW EXTEND IT LIKE
.button_display {
/* THE DIFFERENT PROPERTIES OF Display BUTTON */
}
.button_ask {
/* THE DIFFERENT PROPERTIES OF Ask BUTTON */
} 
```

并申请如下：

```
<a href="/" id="ask-question-link" class="master_button button_ask">Ask a Question</a> 
<a href="/" class="master_button submit" id="ask-button-submit">Submit</a> 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-05-22T15:24:15.677

```
.ask-button-display,
.ask-button-submit {
  /* COMMON RULES */
}

.ask-button-display {

}

.ask-button-submit {

} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-05-22T15:27:50.530

你可能想研究一下 Sass。使用 Sass，您基本上可以在您的 css 文件中创建变量，然后一遍又一遍地重复使用它们。[http://sass-lang.com/](http://sass-lang.com/) 以下示例取自 Sass 官网：

```
$blue: #3bbfce;
$margin: 16px;

.content-navigation {
  border-color: $blue;
  color:
    darken($blue, 9%);
}

.border {
  padding: $margin / 2;
  margin: $margin / 2;
  border-color: $blue;
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-05-22T15:24:27.400

为公共部分的两个链接添加一个按钮类

```
.button {
background: #8BAF3B;
border-radius: 4px;
display: block;
letter-spacing: 0.5px;
position: relative;
border-color: #293829;
border-width: 2px 1px;
border-style: solid;
text-align:center;
color: #FFF;
} 
```

在你的其他课程中保留不常见的规则。

你的 HTML 将是

```
<a href="/" id="ask-question-link" class="button ask-button-display">Ask a Question</a>
<a href="/" class="button ask-button-submit" id="ask-button-submit">Submit</a> 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-05-18T14:33:57.490

在不更改/添加新类的情况下，您可以为类名以“ask-button”开头的所有元素添加样式......（无论类的元素是什么；按钮、锚点、div 等）假设您的按钮是 div然后：

```
 div[class^="ask-button"] {
   // common css properties
 } 
```

您还可以列出所有具有共同属性的类，如下所示：

```
.ask-button-display,
.ask-button-submit {
   // common css properties here
} 
```

然后为每个按钮添加单独的样式：

```
.ask-button-display{
    // properties only for this button
    }

.ask-button-submit {
   // properties only for this button
} 
```

# facebook - 登录后 Facebook 重定向

> ID：10705039
> 
> 赞同：2
> 
> 时间：2012-05-22T15:21:53.470
> 
> 标签：facebook, facebook-canvas, facebook-javascript-sdk

我已经阅读了许多问题和答案，包括StackOverflow 上的[这个问题和答案，但没有一个有效。](https://stackoverflow.com/questions/5782515/facebook-js-api-how-to-redirect-user-after-login)我对我看到的所有回复的问题是“它在 Safari 中有效吗？”。

我试图让它与 Safari 一起使用。它适用于 Chrome 和 Firefox。但在 Safari 中，登录屏幕只是冻结，我收到“不安全的 JavaScript 尝试使用 URL 访问框架”日志消息。

我有一个画布应用程序。我想登录用户并在他们登录后将他们重定向到一个页面。我试图在登录后直接重定向。我试过了

1.  设置`window.top.location`为 facebook url（将一些数据作为 all_data 参数传递给签名请求）

2.  设置`window.location`为与我的应用具有相同域的 URL。

3.  订阅`auth.login`事件并将重定向放在那里

4.  将重定向放在回调中以登录

这些都不适用于 Safari。我开始认为没有办法做到这一点。

```
function doSomething()
{
  FB.login(
    function(loginResponse)
    {
      if (loginResponse.authResponse)
      {
        window.top.location = "my url"
      }
    },
    {
      scope:"some,scope"
    }
  );
}
} 
```

作为对 Nitzan Tomer 的回应，这里是对 Safari 不起作用但与其他人一起使用的等效代码：

```
function myThing()
{
  FB.login(function(loginResponse)
    {
      if (loginResponse.authResponse)
      {
        FB.api('/me', function(response)
        { 
          window.location = "http://my_app.com?x=" + response.xyz;
        });
        }
    },
    {
      scope:"scopes"
    }
  );
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T16:39:18.873

这不是解决您的问题的方法，而是更多的“解决方法”，尽管它仍然使用`window.top.location`但不是来自回调，所以它可能会起作用（我只是不确定回调在哪里执行，因为它是 fb sdk 执行它，也许他们从你的 iframe 内的 fb iframe 调用它）。

[您可以使用服务器端流程](http://developers.facebook.com/docs/authentication/server-side/)，而不是使用客户端身份验证。整个过程发生在顶部窗口中，因为它首先使用 . 将用户重定向到 oauth 对话框`window.top.location`。

当流程结束时，facebook 将用户重定向到您的 redirect_uri，您可以简单地将用户重定向到您想要的任何位置。

我希望这将有所帮助。此外，您应该注意[Facebook 平台政策](http://developers.facebook.com/policy/)中规定：

> 13\. Facebook 上的 Canvas 或 Page Tab 应用程序的主要目的不能是简单地将用户从 Facebook 体验重定向到外部网站。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T10:06:39.710

事实证明，问题在登录过程中稍早发生，并且从未调用过回调。我确实在回调中设置了一个断点（没有被调用），但我认为断点可能由于某种原因不起作用（可能是因为它是在另一个窗口的上下文中执行的）。

无论如何，问题在于通道文件（文档似乎建议是可选的）无法正常工作，这导致 Safari 出现问题，但其他浏览器没有。

# tic-tac-toe - 哪些算法可用于解决井字游戏？

> ID：10705044
> 
> 赞同：3
> 
> 时间：2012-05-22T15:22:23.573
> 
> 标签：tic-tac-toe, alpha-beta-pruning

有哪些算法可以解决井字游戏？特别是电路板尺寸为 4 * 4 或更大而不是 3 * 3？我尝试了 4 * 4 与 Minimax 和 alpha-beta 修剪，但 pc 似乎挂起并在堆栈溢出时抛出异常。我看到了这些用 javascript 编写的源代码，但我不知道它使用哪种算法，有人可以为我澄清一下吗？ [http://js-x.com/page/javascripts__example.html?view=153](http://js-x.com/page/javascripts__example.html?view=153)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T22:09:19.693

尝试在一定深度进行截断...我认为您不需要超过 4 或 5 的深度即可做出完美的移动。

（java for 3*3 one-dim board with depth）：

```
int minimax(int turn, int depth) { // turn(side to move) is 1 or -1
    int val = -turn; // worst value for that turn 
    int result = NULVAL;
    if (wins()) return turn; // evaluate board (board is a field)
    if (depth == 0) return DRAW;
    for (int i = 0; i < 9; i++) {
        if (board[i] == EMPTY) {
            board[i] = turn; // make move
            result = minimax(-turn, depth - 1);
            board[i] = EMPTY; // delete move
            if (result == turn) 
                return turn; // sees win
            if (result == DRAW)
                val = result;
        }
    }
    // if result keeps NULVAL: couldn't make a move (board is full)
    if (result == NULVAL) return DRAW;
    return val;
} 
```

# wcf - 验证对 WCF 服务的调用

> ID：10705046
> 
> 赞同：1
> 
> 时间：2012-05-22T15:22:27.777
> 
> 标签：wcf, iis, ntlm

我正在尝试从不同服务器上的 .ASHX 内部通过 WCF 调用 Sharepoint Web 服务。如果我在 Visual Studio 的调试 Web 服务器内部运行，但不能从 IIS 运行，我的代码就可以工作。工作服务器在各种身份验证模式（Kerberos、NTLM）下工作，而非工作服务器在任何身份验证模式下都不工作。在这两种情况下，我都在冒充同一个用户。

使用 NTLM，我在 Wireshark 中记录了工作会话和非工作会话。在工作中，Wireshark 解析 NTLM 数据并报告我期望的 DOMAIN 和 USER NAME。在非工作中，它显示

```
 DOMAIN: NULL
  USER NAME: NULL 
```

我已经在 IIS 中进行了调试，并且模拟肯定在服务调用时起作用。如果我检查`WindowsIdentity.GetCurrent()`，它就是我期望的用户。

如果我检查工作服务器和非工作服务器上的 WCF 服务代理，它们看起来是相同的——处理 ClientCredentials 的部分设置`""`为两个版本的用户名和密码。

关于还有什么要检查的任何想法？为什么 NTLM 数据会将 DOMAIN 和 USER NAME 设置为 NULL - 它从哪里获取？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T12:14:56.850

根据这个：

[http://support.microsoft.com/kb/207671](http://support.microsoft.com/kb/207671)

> 当 IIS 为 HTTP 请求提供服务时，IIS 会执行模拟，以便适当限制对资源的访问以处理请求。模拟的安全上下文基于为请求执行的身份验证类型。IIS 4.0 提供的五种不同类型的身份验证是：

```
Authentication Type                          Impersonation Type
------------------------------------         ---------------------
Anonymous Access (no authentication)         Network
Auto Password Synchronization is
ON (ON=default)

Anonymous Access (no authentication)         IIS Clear Text
Auto Password Synchronization is OFF         

Basic Authentication                         IIS Clear Text 

NT Challenge/Response Authentication         Network 

Client SSL Certificate Mapping               Interactive 
```

就我而言，我有一个网络令牌，但是

> Network tokens are "NOT" permitted to access network resources. (Network tokens are named so because this kind of token is traditionally created by a server when a user is authenticated across the network. To allow the server to use a network token to act as a network client and access another server is called "delegation" and is considered a possible security hole.)

The KB has many possible ways to avoid the problem

# css - iScroll 阻止我的 div 显示（在实现 div 滑块时）

> ID：10705049
> 
> 赞同：0
> 
> 时间：2012-05-22T15:22:32.783
> 
> 标签：css, html, iscroll

我正在尝试在标准 iScroll HTML 页面中实现 div 滑块，请参阅以下链接：

使用 iScroll（幻灯片无法正常工作）： [http ://utvecklingspunkten.se/iscroll.html](http://utvecklingspunkten.se/iscroll.html)

没有 iScroll（幻灯片工作）： [http ://utvecklingspunkten.se/iscroll2.html](http://utvecklingspunkten.se/iscroll2.html)

出于某种原因，**iScroll 隐藏了****第二张**div 幻灯片中的内容（不是包含它的 div！） 。包含内容的 div 没有问题，并且正确定位（在控制台中查看），但*内容只是被 iScroll 隐藏了*。当删除对 iScroll 的所有引用时，就像在 iscroll2.html 中一样，一切正常。

**包含两张幻灯片的**包装器：****

 **```
#wrapper {
position:absolute; z-index:1;
top:45px; bottom:2px; left:0;
background:#aaa;
-webkit-transition-property: left;
-webkit-transition-duration: 400ms;
display:block !important; 
```

}

**每个**滑动元素：

```
.additional-block {
position: absolute;
display:block !important;
} 
```

有谁知道我怎样才能**让 iScroll 和滑块一起工作**，而不是干涉？希望 iscroll.js 中只有一两行代码需要更改。同样，与*我的第二个幻灯片 div 重叠的 iScroll div（如人工滚动条）是另一个可能的原因。*为我指出这一点将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T16:06:53.723

尝试使用[jQuery Slider](http://docs.jquery.com/UI/Slider)，你可以从里到外设置它的样式。另外，您已经有了鼠标拖动和滚动（实际上有效）。**

# xml - 如何参数化 grails/groovy xml MarkupBuilder .builder 语法？

> ID：10705050
> 
> 赞同：0
> 
> 时间：2012-05-22T15:22:35.343
> 
> 标签：xml, grails, groovy, markupbuilder

这是我关于 SO 的第一个问题，所以要温柔。我正在编写一些常规代码来使用 MarkupBuilder 生成 xml。问题是我必须为许多不同的产品类型生成许多类似的 xml，如果我不能对其进行参数化，代码会变得很大。向您展示可能会帮助您更好地理解：

```
def writer = new StringWriter()

def builder = new groovy.xml.MarkupBuilder(writer)

builder.'cr:request'('xmlns:prodType': 'http://www.myurl/ProductType', 'xmlns:cr': 'http://www.myurl/customerRequest')
{

...
// Bla bla lots of elements and attributes
...

builder.'prodType:ProductGroupName'(ID:"IDPRD"+itemCount, internalID:internalID)
{

 productGroup("PGroup")

 productName("PName")

 ProductSpecificDetails()
 {
   param("paramA")

   stringValue("valA")

   param("paramB")

   stringValue("valB")

   ... 
```

我正在尝试在上面的代码中参数化 'prodType:ProductGroupName' 甚至只是 ProductGroupName。这意味着我将允许我将各种值与参数列表一起传递，以便为不同的产品动态生成 xml。

在网上看，我试过用 ${} 包围 ProductGroupName ，我也将它作为地图 [:] 传递，但到目前为止无济于事。

有谁知道我怎么能做到这一点？

任何帮助深表感谢。

谢谢，保罗。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T15:27:50.833

假设您有一个名为 的变量`productGroupName`，您应该可以使用（注意双引号）：

```
builder."prodType:$productGroupName"(ID:"IDPRD$itemCount", internalID:internalID) 
```

这是你的意思吗？

# python - twisted - 从/到代理打印 IP 数据报

> ID：10705056
> 
> 赞同：1
> 
> 时间：2012-05-22T15:22:57.167
> 
> 标签：python, twisted

我从这里有一个[扭曲的代理：](http://twistedmatrix.com/trac/) [Python Twisted proxy - 如何拦截数据包](https://stackoverflow.com/questions/9063583/python-twisted-proxy-how-to-intercept-packets)。

它打印 HTTP 数据，我还想拦截和检查*原始 IP 数据报*。如何挂钩 IP 数据包的回调？

[http://twistedmatrix.com/documents/11.0.0/api/twisted.pair.ip.IPProtocol.html](http://twistedmatrix.com/documents/11.0.0/api/twisted.pair.ip.IPProtocol.html)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T18:00:37.943

Twisted 不包括对 IP 级别操作的全面支持。正如您所发现的，对解析 IP 数据报有一些支持，但没有内置支持挂钩到平台支持以发送或接收这些数据报。

你可能想看看[scapy](http://www.secdev.org/projects/scapy/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T18:01:02.530

Twisted 没有内置的友好方式来挂钩原始 IP 套接字 (SOCK_RAW) 上的侦听器。这有几个原因：

*   使用 SOCK_RAW 可能会很棘手，而且它可以以不明显的方式工作；
*   在大多数环境中，使用这样的套接字需要提升权限；
*   并且您实际上通过原始套接字获得的数据包在操作系统之间有很大差异（例如，即使您是root，您也不会通过原始套接字在*BSD/Darwin 上获得任何原始TCP 协议IP 数据包）。

一般来说，以远程可移植方式捕获原始数据报的最佳方法是使用 libpcap。[这](http://dound.com/2009/09/integrating-twisted-with-a-pcap-based-python-packet-sniffer/)是一个似乎以相当智能的方式结合了 pcap 和 Twisted 的人的链接；这可能会有所帮助。

# datetime - 幕后花絮：核心数据日期以 31 年的偏移量存储？

> ID：10705062
> 
> 赞同：23
> 
> 时间：2012-05-22T15:23:25.763
> 
> 标签：datetime, core-data, unix-timestamp

我知道，“内部没有用户可维修的部件”......但我很好奇：

在 Core Data sqlite3 DB 中，我似乎可以像这样在 ZDATE 中获得日期：

```
sqlite> select datetime(ZDATE,'unixepoch','31 years','localtime') from ZMYCLASS;
2003-12-11 19:00:00
2009-12-31 19:00:00
2009-01-24 19:00:00
2011-01-01 19:00:00
2009-10-03 20:00:00
... 
```

我得到了 Unix Epoch，但为什么是 31 年？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-05-22T18:46:41.423

Core Data 存储相对于参考日期的日期，即 2001 年 1 月 1 日（评论中指出的 EPOCH 后 31 年）

这是一些用于解码表中日期的代码，以防它对您有用。

```
NSNumber *time = [NSNumber numberWithDouble:(d - 3600)];
NSTimeInterval interval = [time doubleValue];    
NSDate *online = [NSDate dateWithTimeIntervalSinceReferenceDate:interval];
NSDateFormatter *dateFormatter = [[NSDateFormatter alloc] init];
[dateFormatter setDateFormat:@"MM/dd/yyyy HH:mm:ss.SSS"];

NSLog(@"result: %@", [dateFormatter stringFromDate:online]); 
```

[https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSDate_Class/Reference/Reference.html](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSDate_Class/Reference/Reference.html)

看一眼`+ dateWithTimeIntervalSinceReferenceDate:`

# prolog - Prolog忘记/取消我的变量？

> ID：10705074
> 
> 赞同：3
> 
> 时间：2012-05-22T15:23:54.320
> 
> 标签：prolog

我对 Prolog 很陌生，我遇到了一个问题，我的变量似乎被遗忘了

```
test(S) :-
X = 'testing',
(S = y, write(X) );
(S = n, write(X) ). 
```

跑步

```
test(y) 
```

按预期打印出文本，但是

```
test(n) 
```

打印出来

```
_L160 
```

我假设这意味着该变量未实例化？为什么会这样？

我知道它可以把它吐成两个谓词，比如：

```
test(y) :- X = 'testing', write(X).
test(n) :- X = 'testing', write(X). 
```

但我的实际问题在于一个更大的谓词，不能像这样简化。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T15:31:10.360

你的问题是`;/2`. 如果你发出 a`listing(test/1)`你会得到这个：

```
 test(A) :-
    (   B=testing,
        A=y,
        write(B)
    ;   A=n,
        write(B)
    ). 
```

它显示了解释器如何读取您的代码。

您应该用括号括起您的代码以获得您想要的内容：

```
test(S) :-
   X = 'testing',
   ((S = y, write(X) );
    (S = n, write(X) )). 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-22T15:33:03.227

析取 (;) 当前通过以下任一方式成功：

1.  将“测试”分配给 X，将 y 分配给 S 并写入 X。或者，如果失败，则回溯并
2.  将 n 分配给 S 并写 X

添加一些括号以使其按预期工作。

```
test(S):-
X = 'testing',
    (
        (S = y, write(X) )
    ; 
        (S = n, write(X) )
    ). 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-22T15:44:12.803

让我为您重新缩进代码：

```
test(S) :-
        (   X = 'testing', S = y, write(X)
        ;   S = n, write(X)
        ). 
```

我希望现在你写的内容更清楚了。

# ruby-on-rails - 为控制器操作添加路由

> ID：10705075
> 
> 赞同：0
> 
> 时间：2012-05-22T15:23:57.197
> 
> 标签：ruby-on-rails, nested-attributes, nested-routes

我正在使用名为 Recommendable 的 David Celis gem 在我的 rails 应用程序中实现一个类似的系统。我已经在控制台中完成了所有工作，但我无法获得正确的路线，并且出现“没有路线匹配 [GET]”/categories/1/posts/1/like”错误。

我的模型中有以下内容：

```
class Category < ActiveRecord::Base
  has_many :posts, :dependent => :destroy
  extend FriendlyId
  friendly_id :name, use: :slugged
end

class Post < ActiveRecord::Base
  belongs_to :category
end 
```

在我的后控制器中，我有：

```
class PostsController < ApplicationController
  before_filter :authenticate_user!
  before_filter :get_category
  def like
    @post = Post.find(params[:id])
    respond_to do |format|
      if current_user.like @post
      else
         flash[:error] = "Something went wrong! Please try again."
         redirect_to show_post_path(@category, @post)
      end
    end
  end
end 
```

在我的路线中，我有：

```
resources :categories do
    resources :posts do
      put :like, :on => :member
    end
end
match 'categories/:category_id/posts/:id', :to => 'posts#show', :as => 'show_post' 
```

有人可以指出我的错误吗？我可以让 PUT 工作，但我不知道 GET 错误来自哪里，因为如果用户喜欢某个帖子时发生错误，我会尝试重定向回帖子。先感谢您。

编辑：

在我看来，我有：

```
- title "#{@post.class}"
%p#notice= notice

%p
  %b Title:
  = @post.title
%p
  %b Description:
  = @post.description
%p
  %b Likes:
  = @post.liked_by.count

= link_to 'Edit', edit_category_post_path(@post)
\|
= link_to 'Back', category_posts_path
\|
= link_to 'Like', like_category_post_path(@post) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T15:48:28.860

`PUT`当您发出请求时，您的路线需要一个`GET`请求。

您需要通过`button_to`with访问您的路由，`:method => :put`以便您的应用发出 PUT 请求（正确的解决方案），或者更改您的路由以使用`GET`请求（发出修改状态的请求的错误方式）：

```
 get :like, :on => :member 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T16:06:16.507

代替：

```
= link_to 'Like', like_category_post_path(@post) 
```

和：

```
= link_to 'Like', like_category_post_path(@category, @post), method: :put 
```

或者，正如我喜欢的那样：

```
= link_to 'Like', [@category, @post], method: :put 
```

我认为你`like`必须是：

```
def like
  @post = Post.find(params[:id])
  respond_to do |format|
    format.html do
      if current_user.like @post
        flash[:notice] = "It's ok, you liked it!"
        redirect_to :back
      else
         flash[:error] = "Something went wrong! Please try again."
         redirect_to show_post_path(@category, @post)
      end
    end
  end
end 
```

# vba - 删除 Outlook 日历约会不会释放房间

> ID：10705076
> 
> 赞同：1
> 
> 时间：2012-05-22T15:23:59.570
> 
> 标签：vba, outlook

我正在尝试使用以下代码从 Access VBA 中删除 Outlook 日历中的未来约会。代码工作正常，但是这些约会是使用房间（资源）设置的，在我的日历中删除约会不会在资源日历中删除它。我该如何解决？

```
Sub NoFuture()
    'delete any future appointment
    Dim olApp As Outlook.Application
    Dim olNs As Outlook.NameSpace
    Dim olRecItems
    Dim olFilterRecItems
    Dim olItem As Outlook.AppointmentItem, strFilter As String

    Set olApp = CreateObject("Outlook.Application")
    Set olNs = olApp.GetNamespace("MAPI")
    Set olRecItems = olNs.GetDefaultFolder(olFolderCalendar)

    strFilter = "[Start] > '" & Format(Date + 1, "mm/dd/yyyy") & "'"
    Set olFilterRecItems = olRecItems.Items.Restrict(strFilter)

    For Each olItem In olFilterRecItems
        olItem.Delete
    Next olItem
    Set olRecItems = Nothing
    Set olNs = Nothing
    Set olApp = Nothing
End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T18:21:15.543

Diane Poremsky[编写了一个宏](http://www.slipstick.com/outlook/calendar/remove-cancelled-meeting-requests-from-resource-calendar/)，该宏通过并从资源日历中删除取消的约会：

```
' A subroutine to remove cancelled appointments.
Sub RemoveCanceledAppointments()  

'Form variables.
Dim OutLookResourceCalendar As Outlook.MAPIFolder, OutLookAppointmentItem As Outlook.AppointmentItem, IntegerCounter As Integer 

'This sets the path to the resource calender.
Set OutLookResourceCalendar = OpenMAPIFolder("\MailboxName\Calendar")  
For IntegerCounter = OutLookResourceCalendar.Items.Count To 1 Step -1  

Set OutLookAppointmentItem = OutLookResourceCalendar.Items(IntegerCounter)  

    If Left(OutLookAppointmentItem.Subject, 9) = "Canceled:" Then 

        OutLookAppointmentItem.Delete  

    End If 

Next 

Set OutLookAppointmentItem = Nothing 

Set OutLookResourceCalendar = Nothing 

End Sub 

 ' A function for the folder path.
Function OpenMAPIFolder(FolderPathVar)  

Dim SelectedApplication, FolderNameSpace, SelectedFolder, FolderDirectoryVar, i  

Set SelectedFolder = Nothing 

Set SelectedApplication = CreateObject("Outlook.Application")  
If Left(FolderPathVar, Len("\")) = "\" Then 

    FolderPathVar = Mid(FolderPathVar, Len("\") + 1)  

Else 

    Set SelectedFolder = SelectedApplication.ActiveExplorer.CurrentFolder  

End If 

While FolderPathVar <> "" 

' Backslash var.
i = InStr(FolderPathVar, "\")  

        'If a Backslash is present, acquire the directory path and the folder path...[i].
        If i Then 

            FolderDirectoryVar = Left(FolderPathVar, i - 1)  

            FolderPathVar = Mid(FolderPathVar, i + Len("\"))  

        Else 

            '[i] ...or set the path to nothing.
            FolderDirectoryVar = FolderPathVar  

            FolderPathVar = "" 

        End If 

        ' Retrieves the folder name space from the Outlook namespace, unless a folder exists... [ii].
        If IsNothing(SelectedFolder) Then 

            Set FolderNameSpace = SelectedApplication.GetNamespace("MAPI")  

            Set SelectedFolder = FolderNameSpace.Folders(FolderDirectoryVar)  

        Else 

        ' [ii] in which case the the existing folder namespace is used.
            Set SelectedFolder = SelectedFolder.Folders(FolderDirectoryVar)  

        End If 

    Wend  

Set OpenMAPIFolder = SelectedFolder  

End Function 

 ' A function to check too see if there is no set namespace for the folder path.
Function IsNothing(Obj)  

If TypeName(Obj) = "Nothing" Then 

    IsNothing = True 

Else 

    IsNothing = False 

End If 

End Function 
```

让我知道这是否会从资源日历中删除已取消的约会-

~乔尔

# android - 在 android 模拟器中使用网络摄像头作为摄像头的示例项目

> ID：10705077
> 
> 赞同：0
> 
> 时间：2012-05-22T15:24:01.793
> 
> 标签：android, sdk, camera, emulation, webcam

我已经开始为 Android 开发。我想编写一个条码扫描应用程序，但没有办法在模拟器中激活相机，这可能很烦人。

有人知道将我的 PC 的 USB 网络摄像头用作 Android 摄像头的方法吗？我到处搜索，我知道有一个来自 tomgibara 的库，但如果有人有一个示例项目，那就太好了。

目前模拟器只要求捕获设备，但是当我现在从 android 启动相机应用程序时，我只看到这个带有这个棋盘格的虚拟相机站点。

感谢您的所有帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T15:50:20.680

`emulator`您可以使用选项在命令行中指定要使用的相机以及如何使用

```
-fake-camera <mode>                   set fake camera emulation mode 
```

其中 mode 可以是`back`, `front`, 或`off`, 和

```
-webcam name=<name>[,dir=<direction>] setup web camera emulation 
```

其中 name 是有效的已连接摄像机名称，而 dir 是`front`or之一`back`。可以使用特殊选项获得连接的摄像机名称`-webcam list`。例如，在 Linux 中，您可以获得类似

```
List of web cameras connected to the computer:
 Camera 'webcam0' is connected to device '/dev/video0' on channel 0 using pixel format 'YUYV' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T07:55:27.730

好的，经过一些尝试，我可以按照您上面描述的方式运行模拟器，但是假相机选项没有帮助=（它让我选择我想要使用的相机，在我点击“确定”后，模拟器启动，但是没有网络摄像头作为前置或后置摄像头=（是否有可能是不支持的网络摄像头？如果是：支持哪些摄像头？

# jakarta-ee - 内部异常：java.lang.NoSuchFieldException

> ID：10705080
> 
> 赞同：0
> 
> 时间：2012-05-22T15:24:08.953
> 
> 标签：jakarta-ee, jpa

我有一个 java 应用程序，它使用 jpa 显示来自名为 MasterScrip 的表中的数据。我希望在我的表中添加一个额外的字段，但是，当我向我的数据库表 MasterScrip 添加一个名为“更改”的额外字段时，我得到以下异常，当我删除该字段时，应用程序工作正常

```
Exception [EclipseLink-0] (Eclipse Persistence Services - 2.3.0.v20110604-r9504): org.eclipse.persistence.exceptions.IntegrityException
    Descriptor Exceptions: 
    ---------------------------------------------------------
    Exception [EclipseLink-59] (Eclipse Persistence Services - 2.3.0.v20110604-r9504): org.eclipse.persistence.exceptions.DescriptorException
    Exception Description: The instance variable [change] is not defined in the domain class [entity.MasterScrip], or it is not accessible.
    Internal Exception: java.lang.NoSuchFieldException: change
    Mapping: org.eclipse.persistence.mappings.DirectToFieldMapping[change-->StockCommodityDB.MasterScrip.Change]
    Descriptor: RelationalDescriptor(entity.MasterScrip --> [DatabaseTable(StockCommodityDB.MasterScrip)]) 
```

这个例外的原因是什么？我该如何解决？

**编辑：** MasterScrip.java

```
@Entity
@Table(name = "MasterScrip", catalog = "StockCommodityDB", schema = "")
@XmlRootElement
@NamedQueries({
    @NamedQuery(name = "MasterScrip.findAll", query = "SELECT m FROM MasterScrip m"),
    @NamedQuery(name = "MasterScrip.findByScripID", query = "SELECT m FROM MasterScrip m WHERE m.scripID = :scripID"),
    @NamedQuery(name = "MasterScrip.findByScripSymbol", query = "SELECT m FROM MasterScrip m WHERE m.scripSymbol = :scripSymbol"),
    @NamedQuery(name = "MasterScrip.findByType", query = "SELECT m FROM MasterScrip m WHERE m.type = :type"),
    @NamedQuery(name = "MasterScrip.findByCompanyName", query = "SELECT m FROM MasterScrip m WHERE m.companyName = :companyName"),
    @NamedQuery(name = "MasterScrip.findByLastTradedPrice", query = "SELECT m FROM MasterScrip m WHERE m.lastTradedPrice = :lastTradedPrice"),
    @NamedQuery(name = "MasterScrip.findByLastTradedQuantity", query = "SELECT m FROM MasterScrip m WHERE m.lastTradedQuantity = :lastTradedQuantity"),
    @NamedQuery(name = "MasterScrip.findByOpenPrice", query = "SELECT m FROM MasterScrip m WHERE m.openPrice = :openPrice"),
    @NamedQuery(name = "MasterScrip.findByHighPrice", query = "SELECT m FROM MasterScrip m WHERE m.highPrice = :highPrice"),
    @NamedQuery(name = "MasterScrip.findByLowPrice", query = "SELECT m FROM MasterScrip m WHERE m.lowPrice = :lowPrice"),
    @NamedQuery(name = "MasterScrip.findByTotalTradedQuantity", query = "SELECT m FROM MasterScrip m WHERE m.totalTradedQuantity = :totalTradedQuantity"),
    @NamedQuery(name = "MasterScrip.findByVolume", query = "SELECT m FROM MasterScrip m WHERE m.volume = :volume"),
    @NamedQuery(name = "MasterScrip.findByExchange", query = "SELECT m FROM MasterScrip m WHERE m.exchange = :exchange"),
    @NamedQuery(name = "MasterScrip.findByBrokerageCharge", query = "SELECT m FROM MasterScrip m WHERE m.brokerageCharge = :brokerageCharge"),
    @NamedQuery(name = "MasterScrip.findByPreviousClose", query = "SELECT m FROM MasterScrip m WHERE m.previousClose = :previousClose"),
    @NamedQuery(name = "MasterScrip.findByChange", query = "SELECT m FROM MasterScrip m WHERE m.change = :change")})
public class MasterScrip implements Serializable {
    private static final long serialVersionUID = 1L;
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    @Basic(optional = false)
    @NotNull
    @Column(name = "ScripID", nullable = false)
    private Integer scripID;
    @Size(max = 15)
    @Column(name = "ScripSymbol", length = 15)
    private String scripSymbol;
    @Size(max = 10)
    @Column(name = "Type", length = 10)
    private String type;
    @Size(max = 50)
    @Column(name = "CompanyName", length = 50)
    private String companyName;
    // @Max(value=?)  @Min(value=?)//if you know range of your decimal fields consider using these annotations to enforce field validation
    @Column(name = "LastTradedPrice", precision = 22)
    private Double lastTradedPrice;
    @Column(name = "LastTradedQuantity")
    private Integer lastTradedQuantity;
    @Column(name = "OpenPrice", precision = 22)
    private Double openPrice;
    @Column(name = "HighPrice", precision = 22)
    private Double highPrice;
    @Column(name = "LowPrice", precision = 22)
    private Double lowPrice;
    @Column(name = "TotalTradedQuantity")
    private Integer totalTradedQuantity;
    @Column(name = "Volume")
    private Integer volume;
    @Size(max = 30)
    @Column(name = "Exchange", length = 30)
    private String exchange;
    @Column(name = "BrokerageCharge", precision = 22)
    private Double brokerageCharge;
    @Column(name = "PreviousClose", precision = 22)
    private Double previousClose;
    @Column(name = "Change", precision = 22)
    private Double change;
    @JoinColumn(name = "CommoditySubCategoryID", referencedColumnName = "CommoditySubCategoryID")
    @ManyToOne(fetch = FetchType.EAGER)
    private CommoditySubCategoryMaster commoditySubCategoryID;
    @OneToMany(cascade = CascadeType.ALL, mappedBy = "scripID", fetch = FetchType.EAGER)
    private Collection<UserStock> userStockCollection;
    @OneToMany(cascade = CascadeType.ALL, mappedBy = "scripID", fetch = FetchType.EAGER)
    private Collection<UserTrack> userTrackCollection;
    @OneToMany(cascade = CascadeType.ALL, mappedBy = "scripID", fetch = FetchType.EAGER)
    private Collection<OrderStock> orderStockCollection;
    @OneToMany(cascade = CascadeType.ALL, mappedBy = "scripID", fetch = FetchType.EAGER)
    private Collection<TradeStock> tradeStockCollection;

    public MasterScrip() {
    }

    public MasterScrip(Integer scripID) {
        this.scripID = scripID;
    }

    public Integer getScripID() {
        return scripID;
    }

    public void setScripID(Integer scripID) {
        this.scripID = scripID;
    }

    public String getScripSymbol() {
        return scripSymbol;
    }

    public void setScripSymbol(String scripSymbol) {
        this.scripSymbol = scripSymbol;
    }

    public String getType() {
        return type;
    }

    public void setType(String type) {
        this.type = type;
    }

    public String getCompanyName() {
        return companyName;
    }

    public void setCompanyName(String companyName) {
        this.companyName = companyName;
    }

    public Double getLastTradedPrice() {
        return lastTradedPrice;
    }

    public void setLastTradedPrice(Double lastTradedPrice) {
        this.lastTradedPrice = lastTradedPrice;
    }

    public Integer getLastTradedQuantity() {
        return lastTradedQuantity;
    }

    public void setLastTradedQuantity(Integer lastTradedQuantity) {
        this.lastTradedQuantity = lastTradedQuantity;
    }

    public Double getOpenPrice() {
        return openPrice;
    }

    public void setOpenPrice(Double openPrice) {
        this.openPrice = openPrice;
    }

    public Double getHighPrice() {
        return highPrice;
    }

    public void setHighPrice(Double highPrice) {
        this.highPrice = highPrice;
    }

    public Double getLowPrice() {
        return lowPrice;
    }

    public void setLowPrice(Double lowPrice) {
        this.lowPrice = lowPrice;
    }

    public Integer getTotalTradedQuantity() {
        return totalTradedQuantity;
    }

    public void setTotalTradedQuantity(Integer totalTradedQuantity) {
        this.totalTradedQuantity = totalTradedQuantity;
    }

    public Integer getVolume() {
        return volume;
    }

    public void setVolume(Integer volume) {
        this.volume = volume;
    }

    public String getExchange() {
        return exchange;
    }

    public void setExchange(String exchange) {
        this.exchange = exchange;
    }

    public Double getBrokerageCharge() {
        return brokerageCharge;
    }

    public void setBrokerageCharge(Double brokerageCharge) {
        this.brokerageCharge = brokerageCharge;
    }

    public Double getPreviousClose() {
        return previousClose;
    }

    public void setPreviousClose(Double previousClose) {
        this.previousClose = previousClose;
    }

    public Double getChange() {
        return change;
    }

    public void setChange(Double change) {
        this.change = change;
    }

    public CommoditySubCategoryMaster getCommoditySubCategoryID() {
        return commoditySubCategoryID;
    }

    public void setCommoditySubCategoryID(CommoditySubCategoryMaster commoditySubCategoryID) {
        this.commoditySubCategoryID = commoditySubCategoryID;
    }

    @XmlTransient
    public Collection<UserStock> getUserStockCollection() {
        return userStockCollection;
    }

    public void setUserStockCollection(Collection<UserStock> userStockCollection) {
        this.userStockCollection = userStockCollection;
    }

    @XmlTransient
    public Collection<UserTrack> getUserTrackCollection() {
        return userTrackCollection;
    }

    public void setUserTrackCollection(Collection<UserTrack> userTrackCollection) {
        this.userTrackCollection = userTrackCollection;
    }

    @XmlTransient
    public Collection<OrderStock> getOrderStockCollection() {
        return orderStockCollection;
    }

    public void setOrderStockCollection(Collection<OrderStock> orderStockCollection) {
        this.orderStockCollection = orderStockCollection;
    }

    @XmlTransient
    public Collection<TradeStock> getTradeStockCollection() {
        return tradeStockCollection;
    }

    public void setTradeStockCollection(Collection<TradeStock> tradeStockCollection) {
        this.tradeStockCollection = tradeStockCollection;
    }

    @Override
    public int hashCode() {
        int hash = 0;
        hash += (scripID != null ? scripID.hashCode() : 0);
        return hash;
    }

    @Override
    public boolean equals(Object object) {
        // TODO: Warning - this method won't work in the case the id fields are not set
        if (!(object instanceof MasterScrip)) {
            return false;
        }
        MasterScrip other = (MasterScrip) object;
        if ((this.scripID == null && other.scripID != null) || (this.scripID != null && !this.scripID.equals(other.scripID))) {
            return false;
        }
        return true;
    }

    @Override
    public String toString() {
        return "entity.MasterScrip[ scripID=" + scripID + " ]";
    }

} 
```

表结构：

```
CREATE TABLE `MasterScrip` (
  `ScripID` int(11) NOT NULL AUTO_INCREMENT,
  `ScripSymbol` varchar(15) DEFAULT NULL,
  `Type` varchar(10) DEFAULT NULL,
  `CommoditySubCategoryID` int(11) DEFAULT NULL,
  `CompanyName` varchar(50) DEFAULT NULL,
  `LastTradedPrice` double DEFAULT NULL,
  `LastTradedQuantity` int(11) DEFAULT NULL,
  `OpenPrice` double DEFAULT NULL,
  `HighPrice` double DEFAULT NULL,
  `LowPrice` double DEFAULT NULL,
  `TotalTradedQuantity` int(11) DEFAULT NULL,
  `Volume` int(11) DEFAULT NULL,
  `Exchange` varchar(30) DEFAULT NULL,
  `BrokerageCharge` double DEFAULT NULL,
  `PreviousClose` double DEFAULT NULL,
  `Change` double DEFAULT NULL,
  PRIMARY KEY (`ScripID`),
  KEY `comSubCatID_fk_constraint` (`CommoditySubCategoryID`),
  CONSTRAINT `comSubCatID_fk_constraint` FOREIGN KEY (`CommoditySubCategoryID`) REFERENCES `CommoditySubCategoryMaster` (`CommoditySubCategoryID`)
) ENGINE=InnoDB AUTO_INCREMENT=2 DEFAULT CHARSET=latin1 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-10T17:52:34.563

检查您没有使用包含该字段的 orm.xml 文件。还要重新启动您的服务器并确保您没有两次映射该类。

# vb.net - 如何使用相对路径或虚拟路径访问文件？

> ID：10705083
> 
> 赞同：0
> 
> 时间：2012-05-22T15:24:15.840
> 
> 标签：vb.net

我正在尝试使用 MapPath 读取和显示文件，如下所示：

```
 Response.ContentType = "Application/pdf"
    Dim FilePath As String = MapPath("../Document/123.pdf")
    Response.WriteFile(FilePath)
    Response.End() 
```

此过程将正常工作并显示在浏览器中。但是，如果我将文件保存到 C:\Document\123.pdf，如何使用 MapPath 函数中的相对路径访问该文件。是否有访问从 IIS 服务器保存的文件的选项？我正在使用 vb.net 2003。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T15:26:45.443

如果您想访问网站外部的文件，请不要使用`MapPath`. 直接使用绝对路径即可：

```
Dim FilePath As String = "C:\Document\123.pdf"; 
```

# maven - 是否可以使用 Build Forge 进行 Maven 构建？

> ID：10705086
> 
> 赞同：1
> 
> 时间：2012-05-22T15:24:22.933
> 
> 标签：maven, buildforge

是否可以使用 Build Forge 进行 Maven 构建？目前我们使用带有 Ant 脚本的 Build Forge、ClearCase 和 ClearQuest；想尝试 Maven 构建。不知道我是否可以我没有测试环境所以不想搞砸任何事情并且仍然学习所有这些东西

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T21:07:10.907

可以从任何构建自动化框架调用 Maven。

创建一个调用 Maven 构建的 buildforge 步骤，如下所示：

```
mvn -s /path/to/maven/settings/files/mysettings.xml clean package 
```

建议显式选择设置文件，因为这使您可以为每个项目自定义 Maven 配置。

通过确保每个项目都有自己的本地存储库位置可以进一步增强项目隔离（请参阅[设置文件文档](http://maven.apache.org/settings.html)中的“localRepository”参数）

# android - 如何修复：使用 ADB.exe 找不到错误设备

> ID：10705089
> 
> 赞同：70
> 
> 时间：2012-05-22T15:24:24.683
> 
> 标签：android

当我尝试执行命令时，在 cmd 中：

`adb shell`

它显示设备未找到错误。有人能帮助我吗。将不胜感激。

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2013-05-01T22:58:17.073

不要忘记转到您的设备并启用设置-> 开发人员选项-> USB 调试。

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2016-06-15T23:10:19.080

尝试以下任一解决方案。我时不时地收到 adb 错误。以下其中一项始终有效。

**解决方案1**
​​以管理员身份打开命令提示符并输入

1.  `adb kill-server`
2.  `adb start-server`

**解决方案 2**
如果您不在模拟器上进行测试，请为您的手机安装驱动程序。

**解决方案 3**
打开 android sdk manager 并从 extras 文件夹安装“Google USB Driver”。（附截图）

[缺少 Android SDK Google USB 驱动程序](https://i.stack.imgur.com/bkXLE.png)

**解决方案 4**
转到设置 > 开发人员选项 > 启用 USB 调试。
（如果您没有看到开发者选项，请转到设置 > 关于手机 > 继续点击“内部版本号”，直到它显示“您是开发者！”

[启用 USB 调试](https://i.stack.imgur.com/nckeZ.png)

* * *

## 回答 #3

> 赞同：27
> 
> 时间：2012-05-22T18:19:21.773

它取决于 Windows 系统，但通常：

1.  你去**系统属性**
2.  看**硬件设备**
3.  右键单击代表您的移动设备的**黄色**（如果是驱动程序问题，则必须为黄色）**图标**
4.  选择**属性**
5.  然后转到**驱动程序选项卡**
6.  选择**更新驱动程序**
7.  选择**在本地计算机上找到的底部选项**
8.  然后**手动选择**
9.  从打开的windows中寻找**驱动盘**右下角的按钮
10.  从文件夹中选择驱动程序`<sdk>\extras\google\usb_driver\i386`（或 amd64 for and）。
11.  记得取消勾选**仅显示兼容硬件**。
12.  然后选择驱动程序
13.  当 Windows 警告您可能存在的不兼容时，继续。

对于我的手机它可以工作，但它是否工作取决于您的手机。

希望对你有所帮助，再见。

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2012-05-22T15:48:12.227

如果您安装的 Eclipse 有 Android SDK，请转到 DDMS。如果列表设备显示“?????????”

你做`adb kill-server`然后`adb start-server`。

请确保您安装了 USB 驱动程序并启用调试模式。

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2013-09-22T21:45:14.817

这里的另一个问题是您可能需要关闭“作为媒体设备连接”才能与 adb 连接。

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2018-07-16T02:20:57.910

对我来说，我必须`Revoke USB debugging authorizations`在开发人员选项中。以下是步骤：

1.  关掉`USB Debugging`，
2.  撤销 USB 调试授权，
3.  重新插入电缆，
4.  打开`USB Debugging`

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2017-12-04T11:36:16.313

我解决了：

只需关闭USB调试并立即重新启用调试即可

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2016-07-15T00:28:52.167

在我的 G2 上，我必须选择 PTP 而不是 MTP 模式才能使连接正常工作。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2012-10-12T17:28:01.983

我的 Nexus One 在 Windows 7 中突然出现了这个问题 - 不知何故，USB 驱动程序已被卸载。我运行了 android-sdk/SDK Manager.exe，检查了 Extras/Google USB 驱动程序并安装了它。然后我拔下电话并重新插入，然后运行“adb devices”以确认电话已连接。

这不适用于所有手机，仅适用于此处列出的手机：http: [//developer.android.com/sdk/win-usb.html](http://developer.android.com/sdk/win-usb.html)

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2014-01-29T14:28:00.990

开发人员选项

*   USB调试

如果您看不到开发者选项，请转到关于。构建版本并单击构建版本，直到解锁开发人员选项。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2020-12-04T09:03:41.750

尝试更改 USB 端口。尝试重新启动 adb 服务器。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2013-04-07T06:50:13.647

我有一个 Droid 3 (Verizon)。我去了摩托罗拉[这里](https://motorola-global-portal.custhelp.com/app/answers/detail/a_id/88481)，找到了设备管理器中显示的设备“摩托罗拉 ADB 接口”的驱动程序。只是驱动程序的下载量很大，但在安装过程中它找到并正确安装。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2020-09-01T07:48:48.883

I switched to a different USB port and it suddenly got recognized...

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2021-01-28T09:20:21.613

怎么样：

```
Settings -> System -> Developer options -> Debugging -> turn on toggle for Wireless ADB debugging 
```

或者：

```
Revoke USB debugging authorizations 
```

并从头开始尝试。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2016-04-23T17:28:23.807

只是想在这里提供一个简单的答案。我只是第一次使用旧的 Android 设备进行这些 root 和解锁程序。当命令失败时，我收到类似这样的错误`adb push "..." "/sdcard/"`，关键是我的设备在引导加载程序屏幕中。引导到恢复然后允许我复制文件，我认为正常的操作系统也可以。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2021-09-04T11:31:54.043

在我的 Oreo 上的 Sony Xperia XZ1 Compact 上，我必须将 USB 模式切换到 MIDI 才能使其正常工作。只有在此之后，我的 Windows 才识别出 Android ADB，但它无法自动安装驱动程序。我打开设备管理器并为 ADB 安装了 Google USB 驱动程序。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2016-07-21T04:50:38.283

这对我有用，我的 AVG 防病毒软件正在删除我的 adb.exe 文件。如果您有 AVG，请尝试：1) 打开程序 2) 转到选项 3) 转到病毒库并单击它 4) 找到您的 adb 程序，单击它，然后按底部的 RESTORE 这会将文件移回到它原来的地方。但是，除非您关闭 AVG，否则它将再次删除该文件。
在这个 android studio 找到文件之后。祝你好运。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2018-08-13T20:56:03.053

我通过在我的 LG G6 上启用 USB 网络共享从[这个类似的线程](https://stackoverflow.com/questions/24685768/lg-device-not-listed-in-adb-devices)中找到了我的解决方案（需要关闭数据保护程序）

**前往：**设置 -> 网络共享 -> 打开 USB 网络共享

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2021-03-07T23:12:50.197

为了完整起见，我刚刚在这里遇到了一个案例，我不得不更换我的 USB 电缆。猜猜我的那个只是为了收费，该死的东西。

* * *

## 回答 #20

> 赞同：-1
> 
> 时间：2022-02-18T23:28:38.720

在我的情况下，我需要交换将设备连接到计算机的电缆末端......

* * *

## 回答 #21

> 赞同：-1
> 
> 时间：2021-11-19T11:06:33.567

为了解决这个问题，

将 adb 文件夹添加到您的 Windows 路径（系统验证）

这解决了问题

# .htaccess - 强制 htaccess 重定向特定请求

> ID：10705093
> 
> 赞同：0
> 
> 时间：2012-05-22T15:24:39.677
> 
> 标签：.htaccess

我有`htaccess`文件

```
Options -Indexes +FollowSymlinks
RewriteEngine on
RewriteBase /
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^(.*[^/])/?$ /index.php?p=$1 [L,QSA] 
```

即使请求确实存在（文件或目录），如何更改它以强制将请求`/sys-admin`重定向到？`index.php`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T15:32:46.483

添加另一个规则集：

RewriteCond %{REQUEST_URI} /sys-admin*$

重写规则 ^(.*[^/])/?$ /index.php?p=$1 [L,QSA]

# sql-server - 处理 SQL，是否以模式为前缀？

> ID：10705095
> 
> 赞同：1
> 
> 时间：2012-05-22T15:24:42.067
> 
> 标签：sql-server, sql-server-2008, tsql

我正在开发一个工具，我在表等前面加上“dbo”，现在我收到了对自定义模式名称的请求。我正在考虑跳过它们，而是让用户通过对 Db 的关联登录来控制它。我知道有关于“性能”的讨论，因为它需要搜索用户的方案，然后回退到 dbo 等，但这真的是个问题吗？意见？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T07:40:11.217

首先，我会将这个问题视为您的客户（用户？）的功能请求。因此，要立即做出的决定是，您现在是否应该考虑考虑这一点，或者您是否还有其他显然更重要并为客户带来更多利益的功能请求？

例如，现在您可以简单地告诉客户您的应用程序需要自己的数据库，该数据库不应与其他应用程序共享或由客户以任何方式操作。然后您不必担心模式或两个模式中的相同对象名称，因为您的应用程序“拥有”数据库。也许情况已经如此，但如果是这样，那么我不明白为什么您的客户关心您的对象在哪个模式中。

其次，假设您确实决定开展这项工作，您应该收集一些关于人们为什么要求这样做的信息，以确保您清楚地了解他们希望您提供什么以及对他们有什么好处。如果客户真的说“您的应用程序运行缓慢”，那么模式的选择不太可能是原因，索引、模式设计或您的应用程序代码更有可能是要查看的领域。

最后，如果您仍想继续前进，则需要找到技术解决方案。这部分是部署问题，部分是编码问题。这是一个部署问题，因为您必须在安装时指定的特定模式中部署数据库对象，并且您的所有补丁和更高版本也需要意识到这一点。编码问题是你需要你的数据库代码是“模式感知的”，以防你最终处于你拥有的情况`dbo.TableName`，`MyTool.TableName`并且`OtherSchema.TableName`都在同一个数据库中。解决方案显然是在所有代码中引用模式名称，无论如何这被认为是[重要的最佳实践](http://msdn.microsoft.com/en-us/library/dd283095.aspx)。但具体如何做到这一点取决于您如何构建应用程序，如果您使用 ORM 等。

# graphics - 没有着色器的实时水效果

> ID：10705103
> 
> 赞同：1
> 
> 时间：2012-05-22T15:25:12.517
> 
> 标签：graphics, 3d

我正在寻找一种在非基于 PC 的硬件上渲染漂亮水的方法。

该平台有以下限制：

*   没有硬件着色器
*   没有硬件 z 缓冲区

可用的原语有：

*   gouraud 阴影三角形（带 alpha）
*   带纹理的三角形（带 alpha）

想要的效果：

*   透明度
*   焦散
*   小波浪/涟漪
*   折射

我提出的想法：

*   动画/半透明纹理
*   凹凸贴图/法线贴图
*   通过在 XZ 平面上投影世界的反射

在我真正开始对其中一些点进行原型设计之前，我想看看其他人是否有类似的经验、更好的建议、代码示例的链接等。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T18:32:30.207

在 PC 上的旧固定功能 3D 硬件上曾经使用过多种技巧。您的硬件是否支持固定功能环境映射？多纹理和可编程混合阶段？只有单个纹理并且不支持更复杂的固定功能效果，您的选择是有限的，但是具有稍微复杂的固定功能管道的预着色器硬件为您提供了相当多的可能性。例如，固定功能环境映射可用于获得一些不错的基本水效果。

NVIDIA 的开发者网站曾经是旧固定功能硬件上各种效果的好资源，但其中许多文章似乎不再可用。您可以通过查看 Internet 档案中的旧版本网站来追踪其中的一些内容。其他寻找想法的地方是 Gamasutra.com 上的旧 GDC 演示文稿和旧文章，以及一些较旧的 Game Programming Gems 书籍。

# iphone - 内存管理 UIImage ImageNamed

> ID：10705104
> 
> 赞同：0
> 
> 时间：2012-05-22T15:25:14.980
> 
> 标签：iphone, cocoa-touch, memory-management, uiimage

我在我的视图控制器中加载了很多相当大的图像，使用

```
NSUInteger nimages = 0;

for (; ; nimages++) {

    NSString *nameOfImage_ = @"someName";

    NSString *imageName = [NSString stringWithFormat:@"%@%d.jpg", nameOfImage_, (nimages + 1)];

    image = [UIImage imageNamed:imageName];
    if (image == nil) {
        break;
    }

    UIImageView *imageView = [[UIImageView alloc] initWithImage:image];

    //some other stuff....

    [imageView release];
} 
```

通常的卸载发生在 - (void)viewDidUnload 和 - (void)dealloc with self.image = nil; 和[图像发布]；

似乎经过几次“加载”和“卸载”后，缓存仍然增长到不归路！:)

和应用程序崩溃...

有任何想法吗？？？我如何清空我的缓存？在哪里？

谢谢

编辑：

好的，这就是我做错了。显然，这段代码修复了整个缓存问题：

```
image = [[UIImage imageNamed:imageName] autorelease]; 
```

自动释放是这里的关键。

感谢您的回复...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-23T09:27:57.253

谢谢大家的建议。

***解决方案：***
使用`ARC`和`imageWithContentsOffFile`来初始化图像。

```
image = [UIImage imageWithContentsOfFile: [[NSBundle mainBundle] pathForResource:imageName ofType:nil]]; 
```

*是*的，只`imageNamed`对……没什么大不了的……

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-22T21:28:05.827

```
image = [[UIImage imageNamed:imageName] autorelease]; 
```

这是不正确的。根据内存管理规则，您不应该释放（或自动释放）图像，因为您没有分配或保留它。“imageNamed”不包含“alloc”、“new”、“copy”或“retain”。

正如其他一些答案所解释的那样，如果您想更好地控制它们使用的内存，则应该使用不同的方法加载图像。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-22T15:28:08.517

`imageNamed`在现实中加载图像是一种糟糕的方式，它永远不会释放加载的图像，除非被迫并将它们永久保存在缓存中。您应该实现自己的更智能的缓存。一个简单`NSMutableDictionary`的提供相同的功能，但具有更大的灵活性。

如需更深入的讨论，您可以阅读以下内容：[http ://www.alexcurylo.com/blog/2009/01/13/imagenamed-is-evil/](http://www.alexcurylo.com/blog/2009/01/13/imagenamed-is-evil/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-22T15:30:26.783

您可以使用 imageWithContentsOfFile 代替使用 imageNamed：或者查看这篇文章

[链接 0](http://www.alexcurylo.com/blog/2009/01/13/imagenamed-is-evil/)

[链接 1](https://stackoverflow.com/questions/8644455/does-the-uiimage-cache-image)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-22T15:28:31.797

使用另一种方法来初始化您的图像。`imageNamed`缓存。

# spring - 如何启用 Ehcache 的日志记录

> ID：10705107
> 
> 赞同：16
> 
> 时间：2012-05-22T15:25:27.400
> 
> 标签：spring, ehcache, slf4j, logback

在我的 Spring + Hibernate 项目中，我使用 SLF4J 1.6.4 和 LogBack 进行日志记录。现在，我添加了 Ehcache 2.2.0（通过 ehcache-spring-annotations-1.1.3）。缓存似乎作为方法工作，用@Cacheable 注释，不再被执行，尽管返回正确的结果。但是，我有兴趣查看 Ehcache 编写的日志。由于 Ehcache 也使用 SLF4J，我想，应该将日志写入我的日志文件。但是，这并没有发生。logback.xml 有以下内容。

```
 <root level="info">
    <appender-ref ref="STDOUT"/>
    <appender-ref ref="ROLLING"/>
</root> 
```

添加以下内容也无济于事

```
 <logger name="net.sf.ehcache"> 
</logger> 
```

ehcache.xml

```
 <cache name="sampleCache1"
       eternal="false"
       overflowToDisk="true"
       timeToIdleSeconds="300"
       timeToLiveSeconds="600"           
       memoryStoreEvictionPolicy="LFU"           
        /> 
```

请建议我克服这个问题。

Ehcache 使用的是 SLF4J 1.6.1，而我的项目使用的是 SLF4J 1.6.4。它会引起任何问题吗？

谢谢

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2012-05-22T16:17:51.877

`DEBUG`EhCache 在级别上记录了很多。首先，此配置片段过滤掉以下所有日志记录语句`INFO`：

```
<root level="info"> 
```

将其更改为

```
<root level="ALL"> 
```

第二

```
<logger name="net.sf.ehcache"> 
```

需要提高日志记录级别

```
<logger name="net.sf.ehcache" level="ALL"/> 
```

然后，您应该会看到来自 EhCache（和其他）的大量日志记录语句。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2015-09-24T15:31:28.317

在我看来，将根记录器级别设置`ALL`为不是一个好主意。

这意味着`ALL`每个级别的日志消息都将通过（除非您在附加程序上设置阈值）。

相反，我建议您设置一个合理的根 logger 级别，例如`INFO`or `WARN`，然后如果您需要更具体的信息，请设置各个 logger 的日志级别。

这样，您就不会创建不必要的信息森林。

我建议如下：

```
<appender name="CONSOLE" class="org.apache.log4j.ConsoleAppender"> 
  <param name="Target" value="System.out"/> 
  <layout class="org.apache.log4j.PatternLayout"> 
    <param name="ConversionPattern" value="%d %-5p [%c] %m%n"/>
  </layout>  
</appender> 

<logger name="net.sf.ehcache">
  <level value="DEBUG"/>
</logger>

<root> 
  <priority value ="INFO" /> 
  <appender-ref ref="CONSOLE" /> 
</root> 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2015-09-17T08:39:30.670

我还发现启用 DEBUG 登录很方便，`org.springframework.cache`因为我使用的是 Spring Framework 4.2.1 的缓存功能（@Cacheable 等）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2020-03-12T13:22:50.813

我通过实现 CacheEventListener 接口为 Ehcache 3 编写了一个自定义记录器，如下所示

```
public class CacheLogger implements CacheEventListener<Object, Object> {

    private static final Logger LOG = LoggerFactory.getLogger(CacheLogger.class);

    @Override
    public void onEvent(CacheEvent<?, ?> cacheEvent) {
        LOG.info("YOUR LOG IS HERE");
    }
} 
```

ehcache.xml 将定义监听器类

```
<cache-template name="default">
        <expiry>
            <ttl unit="seconds">300</ttl>
        </expiry>
        <listeners>
            <listener>
                <class>com.path.to.CacheLogger</class>
                <event-firing-mode>ASYNCHRONOUS</event-firing-mode>
                <event-ordering-mode>UNORDERED</event-ordering-mode>
                <events-to-fire-on>CREATED</events-to-fire-on>
                <events-to-fire-on>EXPIRED</events-to-fire-on>
                <events-to-fire-on>EVICTED</events-to-fire-on>
            </listener>
        </listeners>
        <resources>
            <heap>1000</heap>
            <offheap unit="MB">10</offheap>
        </resources>
    </cache-template> 
```

# ruby-on-rails - 如何使用Passenger/nginx设置每个应用程序的配置——最好是在环境中

> ID：10705111
> 
> 赞同：0
> 
> 时间：2012-05-22T15:25:50.467
> 
> 标签：ruby-on-rails, nginx, passenger

我有不想提交给版本控制的秘密配置。Heroku 处理这个问题的方式是设置应用程序可以读取的环境变量。这是一个很好的解决方案，我想在我自己的服务器上使用Passenger/nginx 时使用相同的原理。

我可以全局设置这些，例如在我的 .bash_profile 中，但这使它们全局可用。例如，如果我有两个站点，都与 Twitter 交互并使用 TWITTER_API_KEY，则应该为每个站点设置不同的设置。

我通过谷歌发现的表明这是不可能的，但我认为无论如何都值得一问。

* * *

另一种方法是拥有一个未提交到版本控制的私有配置文件。这行得通，但使用环境变量对我来说似乎更优雅。

# sql - SQL 数据库的搜索

> ID：10705112
> 
> 赞同：0
> 
> 时间：2012-05-22T15:25:54.307
> 
> 标签：sql, sql-server-2005, ssms

我想知道是否可以在整个 sql 数据库中搜索一串数据？

我知道您可以搜索某些列标题等，但我需要搜索单个数据字符串并且不知道它将保存在数据库中的哪个位置（表/列等）。

可能吗？我将如何执行此操作以返回其所在位置的列、表或两者？

非常感谢任何建议。

（我使用的是 sql server management studio 2005）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T15:32:45.203

您可以为此编写一个脚本

```
select *, COLUMN_NAME, TABLE_NAME 
from INFORMATION_SCHEMA.COLUMNS
where TABLE_SCHEMA = 'your_schema' 
```

使用该表和列列表，您可以遍历所有表和列以查找您的输入。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T13:12:48.790

这是我最后使用的脚本。非常直截了当，还有一件很棒的小事要知道。

```
CREATE PROCEDURE FindMyData_String 
    @DataToFind NVARCHAR(4000), 
    @ExactMatch BIT = 0 
AS 
SET NOCOUNT ON 

DECLARE @Temp TABLE(RowId INT IDENTITY(1,1), SchemaName sysname, TableName sysname, ColumnName SysName, DataType VARCHAR(100), DataFound BIT) 

    INSERT  INTO @Temp(TableName,SchemaName, ColumnName, DataType) 
    SELECT  C.Table_Name,C.TABLE_SCHEMA, C.Column_Name, C.Data_Type 
    FROM    Information_Schema.Columns AS C 
            INNER Join Information_Schema.Tables AS T 
                ON C.Table_Name = T.Table_Name 
        AND C.TABLE_SCHEMA = T.TABLE_SCHEMA 
    WHERE   Table_Type = 'Base Table' 
            And Data_Type In ('ntext','text','nvarchar','nchar','varchar','char') 

DECLARE @i INT 
DECLARE @MAX INT 
DECLARE @TableName sysname 
DECLARE @ColumnName sysname 
DECLARE @SchemaName sysname 
DECLARE @SQL NVARCHAR(4000) 
DECLARE @PARAMETERS NVARCHAR(4000) 
DECLARE @DataExists BIT 
DECLARE @SQLTemplate NVARCHAR(4000) 

SELECT  @SQLTemplate = CASE WHEN @ExactMatch = 1 
                            THEN 'If Exists(Select * 
                                          From   ReplaceTableName 
                                          Where  Convert(nVarChar(4000), [ReplaceColumnName]) 
                                                       = ''' + @DataToFind + ''' 
                                          ) 
                                     Set @DataExists = 1 
                                 Else 
                                     Set @DataExists = 0' 
                            ELSE 'If Exists(Select * 
                                          From   ReplaceTableName 
                                          Where  Convert(nVarChar(4000), [ReplaceColumnName]) 
                                                       Like ''%' + @DataToFind + '%'' 
                                          ) 
                                     Set @DataExists = 1 
                                 Else 
                                     Set @DataExists = 0' 
                            END, 
        @PARAMETERS = '@DataExists Bit OUTPUT', 
        @i = 1 

SELECT @i = 1, @MAX = MAX(RowId) 
FROM   @Temp 

WHILE @i <= @MAX 
    BEGIN 
        SELECT  @SQL = REPLACE(REPLACE(@SQLTemplate, 'ReplaceTableName', QUOTENAME(SchemaName) + '.' + QUOTENAME(TableName)), 'ReplaceColumnName', ColumnName) 
        FROM    @Temp 
        WHERE   RowId = @i 

        PRINT @SQL 
        EXEC SP_EXECUTESQL @SQL, @PARAMETERS, @DataExists = @DataExists OUTPUT 

        IF @DataExists =1 
            UPDATE @Temp SET DataFound = 1 WHERE RowId = @i 

        SET @i = @i + 1 
    END 

SELECT  SchemaName,TableName, ColumnName 
FROM    @Temp 
WHERE   DataFound = 1 
GO 

exec FindMyData_string 'VBAR2', 0 
```

# command-line - NtQueryInformationProcess 似乎返回错误的命令行

> ID：10705115
> 
> 赞同：0
> 
> 时间：2012-05-22T15:25:58.150
> 
> 标签：command-line, instances, ntdll

我正在使用[NtQueryInformationProcess(](http://msdn.microsoft.com/en-us/library/windows/desktop/ms684280%28v=vs.85%29.aspx) ) 在 Windows 7 上检索另一个进程的命令行（通过[NtQueryInformationProcess () 返回的 PEB 中的 RTL_USER_PROCESS_PARAMETERS）。](http://msdn.microsoft.com/en-us/library/windows/desktop/aa813741%28v=vs.85%29.aspx)

这通常可以正常工作，但是当启动同一可执行文件的多个实例时，所有实例的命令行字符串都是相同的：它始终是启动的第一个实例的命令行。GetCommandLine() 为每个进程返回正确的命令行。

有人可以证实或伪造这一点吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T23:37:32.553

您可能缺少的是 PEB 中的每个指针仅与 PEB 进程的地址空间相关，而不是调用 NtQueryInformationProcess 并检索 PEB 的进程。您必须使用 ReadProcessMemory 来引用指针。否则，由于进程的布局可能类似，您最终会读取 NtQueryInformationProcess 调用者的命令行，而不是 PEB 进程的命令行。

我可以确认，对每一级指针间接使用 NtQueryInformationProcess 和 ReadProcessMemory 可以正确获取所有进程的命令行。有关源代码示例，请参阅[https://stackoverflow.com/a/13408150/1236546](https://stackoverflow.com/a/13408150/1236546)。

# objective-c - 获取 UIWebView 的完整内容，包括 !doctype 和 html 标签

> ID：10705124
> 
> 赞同：0
> 
> 时间：2012-05-22T15:26:31.903
> 
> 标签：objective-c, ios, uiwebview

我一直在探索`[_webView stringByEvaluatingJavaScriptFromString:@"document.all[0].outerHTML"]`，但这留下了 !doctype 标签。

我试图避免`stringWithContentsOfURL:`，因为它会打一个新电话。

有什么方法可以获取 UIWebView 的完整源代码，包括 !doctype 和 html 标签？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T18:14:16.380

没有办法在一个方法调用中获取 Doctype 和其余的 HTML 代码。但是，您可以像这样使用 Javascript 构建 Doctype（此 Javascript 解决方案归功于[Rob W](https://stackoverflow.com/users/938089/rob-w)）：

```
var node = document.doctype;
var html = "<!DOCTYPE "
         + node.name
         + (node.publicId ? ' PUBLIC "' + node.publicId + '"' : '')
         + (!node.publicId && node.systemId ? ' SYSTEM' : '') 
         + (node.systemId ? ' "' + node.systemId + '"' : '')
         + '>'; 
```

所以把这个 Javascript 代码放入一个 NSString 并`stringByEvaluatingJavaScriptFromString:`用它调用。那应该给你！Doctype。然后，您可以按照问题中的描述添加 HTML 的其余部分。

但是我想建议第二种方法：首先使用将 URL 的内容加载到 NSString 中`stringWithContentsOfURL:`，然后使用将 NSString 加载到 UIWebView 中`loadHTMLString:baseURL:`

通过这种方法，您可以获得真正的完整 HTML 作为字符串（包括实际的 !Doctype 和 html 标签），并且您只使用 1 个请求。只需确保使用正确的 baseURL，以便正确加载 CSS 和 JS 文件以及引用的图像。

# cassandra - 尝试在 cassandra 中运行 CQL 命令时，int 对象没有属性替换

> ID：10705132
> 
> 赞同：3
> 
> 时间：2012-05-22T15:27:08.920
> 
> 标签：cassandra, cql

我在 cassandra 有一个反列系列。当我尝试从 CQL 查看数据时，即使列族中有数据，我也会收到错误消息。

```
SELECT * from userstats; 
```

生成以下错误：

'int' 对象没有属性 'replace'

我可以确认数据在列族中并且工作正常，因为我可以使用 Datastax Opscenter 数据浏览器查看数据。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T18:06:40.110

听起来您使用的是旧版本的 cqlsh。升级它（只需`bin/cqlsh`从 Cassandra 1.1 分支头复制文件以及`pylib`目录下的所有内容）应该可以解决这个问题。

如果没有，运行 cqlsh`--debug`将有助于诊断问题。

# php - 要删除的冗余标签

> ID：10705137
> 
> 赞同：0
> 
> 时间：2012-05-22T15:27:32.097
> 
> 标签：php, html, tags

> **可能重复：**
> [通过删除多余/冗余的格式标记来清理 HTML](https://stackoverflow.com/questions/10248166/cleaning-html-by-removing-extra-redundant-formatting-tags)

我一直在尝试删除从 HTML 作曲家生成的冗余标签。这显然无法删除所有空的。我一直在看它一段时间，我无法弄清楚。可能有一些我想念的东西。

下面是代码。非常感谢大家。。

```
//Check for reduntant tags
function removeRedundantTags($pathname) {
$dom = new DOMDocument();
$dom->loadHTMLFile($pathname);
$allTags = $dom->getElementsByTagName('*');
for($i = 0; $i < $allTags->length; $i++) {
    $currentTag = $allTags->item($i);
    echo "Accessed Tags: ".$currentTag->nodeName.'<br>';
    if($currentTag->hasChildNodes()) continue;
    if($currentTag->nodeName == 'br' || $currentTag->nodeName == 'img' || $currentTag->nodeName == 'meta') continue;
    if($currentTag->nodeValue == NULL) {                        
        $parentNode = $currentTag->parentNode;
        $oldChild = $parentNode->removeChild($currentTag);      
        echo "Removed Tags----: ".$oldChild->nodeName.'<br>';
    }
}   
echo "Redandant Removed<br>";
$dom->saveHTMLFile($pathname);
} 
```

**编辑**（添加输出）假设我正在尝试清理跨度标签（对不起，我无法发布 HTML 代码）它只是删除了它的一半。就像存在两个跨度标签它只删除一个，并且这同样适用于所有空标签

我正在使用 DOM 结构，它恰好非常快，因为我将使用这段代码处理数百个 HTML 文件。所以有些答案使用了无用的正则表达式。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T15:30:38.997

```
function clean($txt)
{
    $txt=preg_replace("{(<br[\\s]*(>|\/>)\s*){2,}}i", "<br /><br />", $txt);
    $txt=preg_replace("{(<br[\\s]*(>|\/>)\s*)}i", "<br />", $txt);
    return $txt;
} 
```

H9kDroid 在[如何使用 PHP 从 HTML 代码中删除多余的 <br /> 标记中回答？](https://stackoverflow.com/questions/6226216/how-to-remove-redundant-br-tags-from-html-code-using-php)

# ruby-on-rails-3 - rails 回形针：如何访问 a 的 url

> ID：10705139
> 
> 赞同：0
> 
> 时间：2012-05-22T15:27:32.917
> 
> 标签：ruby-on-rails-3, url, paperclip

我是 Rails 和回形针插件的新手——所以如果这是一个愚蠢的问题，我深表歉意。

我正在尝试上传文件，然后访问文件 url 的 url。在 dev 中，文件被存储在本地，而在 prod 中，文件被推送到 s3。

一旦模型存储在数据库中，我以后如何获取 url 以显示链接？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T15:49:11.673

当您在模型中指定回形针关联时，您会：

```
class ModelName < ActiveRecord::Base
  has_attached_file :thumbnail, :styles => { :medium => "300x300#", :thumb => "100x100#"} , :default_url => '/images/default/missing.png'
end 
```

要获取网址，您必须执行以下操作：

```
@model.thumbnail.url(:original) 
```

其中 :original 是文件格式，可以是 :medium, :thumb...

# java - Hadoop datanode 无法开始抛出 org.apache.hadoop.hdfs.server.common.Storage：无法锁定存储

> ID：10705140
> 
> 赞同：4
> 
> 时间：2012-05-22T15:27:38.283
> 
> 标签：java, hadoop, locking, hdfs, ubuntu-12.04

我在尝试在 Hadoop 中启动数据节点时遇到了一些问题，从日志中我可以看到数据节点启动了两次（部分日志如下）：

```
2012-05-22 16:25:00,369 INFO org.apache.hadoop.hdfs.server.datanode.DataNode: STARTUP_MSG: 
/************************************************************
STARTUP_MSG: Starting DataNode
STARTUP_MSG:   host = master/192.168.0.1
STARTUP_MSG:   args = []
STARTUP_MSG:   version = 1.0.1
STARTUP_MSG:   build = https://svn.apache.org/repos/asf/hadoop/common/branches/branch-1.0 -r 1243785; compiled by 'hortonfo' on Tue Feb 14 08:15:38 UTC 2012
************************************************************/
2012-05-22 16:25:00,375 INFO org.apache.hadoop.hdfs.server.datanode.DataNode: STARTUP_MSG: 
/************************************************************
STARTUP_MSG: Starting DataNode
STARTUP_MSG:   host = master/192.168.0.1
STARTUP_MSG:   args = []
STARTUP_MSG:   version = 1.0.1
STARTUP_MSG:   build = https://svn.apache.org/repos/asf/hadoop/common/branches/branch-1.0 -r 1243785; compiled by 'hortonfo' on Tue Feb 14 08:15:38 UTC 2012
************************************************************/
2012-05-22 16:25:00,490 INFO org.apache.hadoop.metrics2.impl.MetricsConfig: loaded properties from hadoop-metrics2.properties
2012-05-22 16:25:00,500 INFO org.apache.hadoop.metrics2.impl.MetricsSourceAdapter: MBean for source MetricsSystem,sub=Stats registered.
2012-05-22 16:25:00,500 INFO org.apache.hadoop.metrics2.impl.MetricsSystemImpl: Scheduled snapshot period at 10 second(s).
2012-05-22 16:25:00,500 INFO org.apache.hadoop.metrics2.impl.MetricsSystemImpl: DataNode metrics system started
2012-05-22 16:25:00,512 INFO org.apache.hadoop.metrics2.impl.MetricsConfig: loaded properties from hadoop-metrics2.properties
2012-05-22 16:25:00,523 INFO org.apache.hadoop.metrics2.impl.MetricsSourceAdapter: MBean for source MetricsSystem,sub=Stats registered.
2012-05-22 16:25:00,523 INFO org.apache.hadoop.metrics2.impl.MetricsSystemImpl: Scheduled snapshot period at 10 second(s).
2012-05-22 16:25:00,524 INFO org.apache.hadoop.metrics2.impl.MetricsSystemImpl: DataNode metrics system started
2012-05-22 16:25:00,722 INFO org.apache.hadoop.metrics2.impl.MetricsSourceAdapter: MBean for source ugi registered.
2012-05-22 16:25:00,724 INFO org.apache.hadoop.metrics2.impl.MetricsSourceAdapter: MBean for source ugi registered.
2012-05-22 16:25:00,727 WARN org.apache.hadoop.metrics2.impl.MetricsSystemImpl: Source name ugi already exists!
2012-05-22 16:25:00,729 WARN org.apache.hadoop.metrics2.impl.MetricsSystemImpl: Source name ugi already exists!
2012-05-22 16:20:15,894 INFO org.apache.hadoop.hdfs.server.common.Storage: Cannot lock storage /app/hadoop/tmp/dfs/data. The directory is already locked.
2012-05-22 16:20:16,008 ERROR org.apache.hadoop.hdfs.server.datanode.DataNode: java.io.IOException: Cannot lock storage /app/hadoop/tmp/dfs/data. The directory is already locked.
        at org.apache.hadoop.hdfs.server.common.Storage$StorageDirectory.lock(Storage.java:602)
        at org.apache.hadoop.hdfs.server.common.Storage$StorageDirectory.analyzeStorage(Storage.java:455)
        at org.apache.hadoop.hdfs.server.datanode.DataStorage.recoverTransitionRead(DataStorage.java:111)
        at org.apache.hadoop.hdfs.server.datanode.DataNode.startDataNode(DataNode.java:385)
        at org.apache.hadoop.hdfs.server.datanode.DataNode.<init>(DataNode.java:299)
        at org.apache.hadoop.hdfs.server.datanode.DataNode.makeInstance(DataNode.java:1582)
        at org.apache.hadoop.hdfs.server.datanode.DataNode.instantiateDataNode(DataNode.java:1521)
        at org.apache.hadoop.hdfs.server.datanode.DataNode.createDataNode(DataNode.java:1539)
        at org.apache.hadoop.hdfs.server.datanode.DataNode.secureMain(DataNode.java:1665)
        at org.apache.hadoop.hdfs.server.datanode.DataNode.main(DataNode.java:1682) 
```

我在网上搜索过，发现[了这个问题](https://stackoverflow.com/questions/8613112/datanode-failing-to-start-in-hadoop)，但是我没有使用 conf/hdfs-site.xml 覆盖任何内容，如下所示，因此 Hadoop 应该使用默认值（如此[处](http://hadoop.apache.org/common/docs/r0.20.2/hdfs-default.html)所述）不会导致任何失败的锁定。这是我的 conf/hdfs-site.xml：

```
<?xml version="1.0"?>
<?xml-stylesheet type="text/xsl" href="configuration.xsl"?>

<!-- Put site-specific property overrides in this file. -->

<configuration>
  <property>
    <name>dfs.replication</name>
    <value>2</value>
    <description>Default block replication.
    The actual number of replications can be specified when the file is created.
    The default is used if replication is not specified in create time.
    </description>
  </property>
</configuration> 
```

这是我的 conf/core-site.xml：

```
<?xml version="1.0"?>
<?xml-stylesheet type="text/xsl" href="configuration.xsl"?>

<!-- Put site-specific property overrides in this file. -->

<configuration>
  <property>
    <name>hadoop.tmp.dir</name>
    <value>/app/hadoop/tmp</value>
    <description>A base for other temporary directories.</description>
  </property>

  <property>
    <name>fs.default.name</name>
    <value>hdfs://master:54310</value>
    <description>The name of the default file system.  A URI whose
    scheme and authority determine the FileSystem implementation.  The
    uri's scheme determines the config property (fs.SCHEME.impl) naming
    the FileSystem implementation class.  The uri's authority is used to
    determine the host, port, etc. for a filesystem.</description>
  </property>
</configuration> 
```

这是 hadoop/conf/slaves 的内容：

```
master
slave 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-08-07T19:16:17.140

*   停止数据节点
*   从 dfs 数据目录中删除 in_use.lock 文件
*   位置和启动数据节点

它应该可以正常工作

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T22:31:01.607

还要在 hdfs-site.xml 文件中添加以下 2 个属性。

```
<property>
        <name>dfs.name.dir</name>
        <value>/some_path</value>
    </property>

    <property>
        <name>dfs.data.dir</name>
        <value>/some_path</value>
    </property> 
```

它们的默认位置是 /tmp..因此，您在每次重新启动时都会丢失数据。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-02T19:44:15.750

我遇到了类似的问题，但我读到一篇文章说 dfs.name.dir 和 dfs.data.dir 应该彼此不同。我让两者相同，并将这些值更改为彼此不同解决了我的问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-06-17T15:53:11.047

我遇到了同样的问题，并在 shell 中将 umask 设置为 0022，在那里我运行测试为我解决了这个问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-07-25T00:02:45.783

```
sudo rm -r /tmp/hadoop-[YourNameHere]/dfs/data/ 
```

并重新启动 dfs。

# c# - 从数据库回发时更新 asp.net 文本框显示旧值

> ID：10705143
> 
> 赞同：1
> 
> 时间：2012-05-22T15:27:47.360
> 
> 标签：c#, asp.net, .net, windows

更新面板内的 Asp 文本框在页面加载中显示来自数据库的值。更新面板内的按钮触发回发。数据库过程更改要显示的值。文本框文本从 Page_Load 中的数据库更新，如果 (!Page.IsPostBack)。确认在 Page_Load 结束时文本框具有更新的值。屏幕上显示的值不会更改为更新值。

根据其他帖子，我尝试将文本框文本的更新移动到 OnPreRender 事件，结果相同。

到目前为止，我唯一的解决方法是在每次回发时使用新 ID 重新创建控件，这样它就不会从发布的数据中重新填充（使用附加到 ID 的时间戳）并使用正则表达式通过基本名称查找控件。这样我可以显示正确的值并在下一次回发时阅读它，但这似乎是一个麻烦的解决方法。

在回发期间更新文本框并具有“stick”值的正确 .NET 方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T15:51:52.827

如果您仅将 texbox 用于显示目的，则不应使用`if (!Page.IsPostBack)`

如果您需要使用您的文本框值。然后

```
protected void Page_Load(object sender, EventArgs e)
{
  if (!IsPostBack)
    TextBox1.Text = %YOUR_INITIAL_DB_VALUE%;
}

protected void Button1_Click(object sender, EventArgs e)
{
  string userInput = TextBox1.Text;
  TextBox1.Text = %YOUR_NEW_DB_VALUE%;
} 
```

# mysql - 为什么单事务的 mysqldump 比没有事务的 mysqldump 更一致？

> ID：10705149
> 
> 赞同：8
> 
> 时间：2012-05-22T15:28:03.727
> 
> 标签：mysql, mysqldump

我已经阅读了手册，并提到每笔交易都会`BEGIN`在开始转储之前添加一条语句。有人可以以更易于理解的方式详细说明吗？

这是我读到的：

> 此选项在从服务器转储数据之前发出 BEGIN SQL 语句。它仅对 InnoDB 和 BDB 等事务表有用，因为它会在发出 BEGIN 时转储数据库的一致状态，而不会阻塞任何应用程序。”

有人可以详细说明一下吗？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-05-22T15:42:46.280

由于转储在一个事务中，因此您可以获得数据库中所有表的一致视图。这可能最好用一个反例来解释。假设您转储一个包含两个表的数据库，`Orders`并且`OrderLines`

1.  您无需单个事务即可启动转储。
2.  `Orders`另一个进程在表中插入一行。
3.  `OrderLines`另一个进程在表中插入一行。
4.  转储处理`OrderLines`表。
5.  另一个进程删除`Orders`和`OrderLines`记录。
6.  转储处理`Orders`表。

在此示例中，您的转储将包含 的行`OrderLines`，但没有`Orders`。`Orders`如果和之间存在外键，则数据将处于不一致状态并且在还原时将失败`OrderLines`。

如果您在单个事务中完成了它，则转储将既没有顺序也没有行（但它会是一致的），因为两者都被插入，然后在事务开始后被删除。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-22T15:37:17.450

我曾经遇到过没有 --single-transaction 参数的 mysqldump 会由于转储期间更改数据而始终失败的问题。据我所知，当您在单个事务中运行它时，它可以防止转储期间发生的任何更改导致问题。本质上，当您发出 --single-transaction 时，它会拍摄当时数据库的快照并转储它，而不是转储在实用程序运行时可能会更改的数据。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-05-22T15:42:22.977

这对于备份可能很重要，因为这意味着您可以获取所有数据，就像它在某个时间点一样。

例如，想象一个简单的博客数据库，一个典型的活动可能是

1.  创建一个新用户
2.  由用户创建新帖子
3.  删除删除帖子的用户

现在，当您备份数据库时，备份可能会按此顺序备份表

1.  帖子
2.  用户

如果有人在您的备份到达 #1*之后删除了帖子所需的用户，会发生什么？*

当你恢复你的数据时，你会发现你有一个帖子，但是用户在备份中并不存在。

围绕整个事物进行事务意味着备份期间数据库上发生的所有更新、插入和删除操作都不会被备份看到。

# sql-server - QuoteName 没有给出结果

> ID：10705150
> 
> 赞同：1
> 
> 时间：2012-05-22T15:28:08.557
> 
> 标签：sql-server, sql-server-2008, sql-server-2005

我正在尝试这段代码

```
CREATE TABLE #t 
( 
   nam Varchar(100) 
) 
INSERT INTO #t(nam)VALUES('abc[]def') 
SELECT * FROM #t Where Quotename(nam) like Quotename('abc[]def') 
drop table #t 
```

并没有给我任何结果....我错过了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T15:36:08.920

你不需要引号，你需要[转义](http://msdn.microsoft.com/en-us/library/ms179859.aspx)

```
CREATE TABLE #t 
( 
   nam VARCHAR(100) 
) 
INSERT INTO #t(nam) VALUES('abc[]def') 

SELECT * 
FROM #t 
WHERE nam LIKE 'abc\[]def' ESCAPE '\' 

DROP TABLE #t 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T15:36:56.533

```
CREATE TABLE #t 
( 
   nam Varchar(100) 
); 
INSERT INTO #t(nam)VALUES('abc[]def'); 
SELECT * FROM #t Where Quotename(nam) = Quotename('abc[]def');
drop table #t; 
```

它没有返回任何东西，因为括号`[ ]`被称为通配符字母`LIKE`。括号通配符之间指定的字符集，它将匹配指定位置（通配符的位置）中的任何一个字符。

[http://msdn.microsoft.com/en-us/library/ms179859.aspx](http://msdn.microsoft.com/en-us/library/ms179859.aspx)

请打开链接并搜索以下文本。

**使用 [ ] 通配符**

# c - 使用 fread 函数：要读取的大小大于可读取的大小

> ID：10705158
> 
> 赞同：3
> 
> 时间：2012-05-22T15:28:35.147
> 
> 标签：c, fread, file-pointer

我有个问题：

我正在使用 fread 读取文件。

```
typedef struct {
    int ID1;
    int ID2;
    char string[256];
} Reg;

Reg *A = (Reg*) malloc(sizeof(Reg)*size);

size = FILESIZE/sizeof(Reg);

fread (A, sizeof(Reg), size, FILEREAD); 
```

使用循环，连续调用这个调用，让我阅读我的整个文件。

当我接近文件末尾时会发生什么，并且我无法读取“size” * sizeof (Reg)，或者如果您只能读取此数量的一半，我的数组 A 会发生什么。它将是完全的？函数会返回错误吗？

知道文件是如何被 fread through 读取的吗？

Edi1：确切地说，如果划分不准确，当我读取最后一个较小的文件大小时，我会读取文件中没有的内容，我想知道我的向量调整大小为我可以读取的字节数，或者发展动态更好。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-22T15:30:33.740

[fread](http://msdn.microsoft.com/en-us/library/kt0etdcs.aspx)返回它读取的记录数。缓冲区中超出的任何内容都可能被破坏，不要依赖该数据。

> fread 返回实际读取的完整项目数，如果发生错误或在达到 count 之前遇到文件末尾，则可能小于 count。

该函数不会读取文件末尾：最有可能发生的是，您将获得一堆完整缓冲区，然后读取（最终）部分缓冲区，除非文件大小是缓冲区长度的精确倍数。

您的逻辑需要适应这一点 - 文件大小为您提供了预期的记录总数，因此应该不难忽略缓冲区`fread`中与未初始化记录相对应的尾随数据（在最终调用之后）。'记录剩余读取'计数器将是一种方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T15:33:25.343

[`fread()`](http://linux.die.net/man/3/fread)返回它可以读取的元素数。所以你必须检查返回值`fread()`来找出你的数组中有多少元素是有效的。

`EOF`如果发生错误或已达到错误，它将返回一个简短的项目计数或零。在这种情况下，您必须使用`feof()`ond`ferror()`来检查满足什么条件。

# pivot-table - Excel 2010：在 Pivot 中隐藏 0 个值

> ID：10705159
> 
> 赞同：3
> 
> 时间：2012-05-22T15:28:35.670
> 
> 标签：pivot-table, excel-2010

有没有办法在数据透视表中隐藏或显示计算为零的单元格的空白单元格？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T16:39:15.393

使用数字格式隐藏选定单元格中的零值：

按照此过程隐藏选定单元格中的零值。如果其中一个单元格中的值更改为非零值，则该值的格式将类似于一般数字格式。

```
1.Select the cells that contain the zero (0) values that you want to hide.
2.On the Format menu, click Cells, and then click the Number tab.
3.In the Category list, click Custom.
4.In the Type box, type 0;-0;;@ 
```

笔记

```
- The hidden values appear only in the formula bar — or in the cell if you edit 
    within the cell — and are not printed.
- To display hidden values again, select the cells, click the Cells command on 
    the Format menu, and then click the Number tab. In the Category list, 
    click General to apply the default number format. To redisplay a date or 
    a time, select the appropriate date or time format on the Number tab. 
```

[http://office.microsoft.com/en-us/excel-help/display-or-hide-zero-values-HP005199879.aspx](http://office.microsoft.com/en-us/excel-help/display-or-hide-zero-values-HP005199879.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-16T16:55:51.747

我倾向于这样做：

1.  右键单击其中一个行标签
2.  选择“过滤器”
3.  选择“值过滤器...”
4.  Select 'Sum of x' 'does not equal' 0 （其中 x 是求和的值）

问题是 Excel 错误地认为总和是一个非常小的非零值。解决方法：

'x 的总和' '不在' -0.001 和 0.001 之间（取决于您要达到的精度）

# javascript - javascript中的字符串比较返回一个布尔值

> ID：10705160
> 
> 赞同：8
> 
> 时间：2012-05-22T15:28:45.100
> 
> 标签：javascript

javascript中是否有比较字符串并返回布尔值的函数？我找到了 .match 但它返回匹配的字符串。我希望还有别的东西，这样我在比较字符串时就可以使用更少的代码。因为我想检查一个字符串是否有这个词，否则继续。

谢谢

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-05-22T15:33:40.890

您可以使用`test()`返回布尔值的 RegEx 方法：

```
/a/.test('abcd'); // returns true. 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-05-22T15:33:11.610

您可以使用 type **augmentation**，特别是如果您需要经常使用此功能：

```
String.prototype.isMatch = function(s){
   return this.match(s)!==null 
} 
```

所以你可以使用：

```
var myBool = "ali".isMatch("Ali"); 
```

* * *

一般的观点是*不鼓励*使用类型扩充，只是因为它可能与其他扩充发生冲突。

根据[Javascript Patterns](http://www.amazon.co.uk/gp/product/B0046RERXE/ref=docs-os-doi_0) book，它的使用必须受到限制。

我个人认为是可以的，只要你使用一个好的命名比如：

```
String.prototype.mycompany_isMatch = function(s){
   return this.match(s)!==null 
} 
```

这将使它**丑陋**但**安全**。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-05-22T15:30:17.083

有`.indexOf()`哪个将返回找到的字符串的位置，如果没有找到则返回-1

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-22T15:32:42.383

```
myString.indexOf(myWord) > -1 
```

或者，如果你想要一个函数：

```
function hasWord(myString, myWord) {
  return myString.indexOf(myWord) > -1;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-22T15:31:27.067

您可以只使用比较。

```
if ("dog" == "cat") {
  DoSomethingIfItIsTrue();
} else {
    DoSomethingIfItIsFalse();
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-22T15:32:11.693

我知道这不是您正在寻找的确切答案，但这始终是一种有效的方法。

```
if(var1 == var2){
  //do this
}else{
  //do that
}; 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-05-22T15:34:27.610

实际上，`.match()`它可以为您解决问题，因为它返回一个模式匹配字符串数组（如果有），否则返回 null。

无论如何，如果您只想检查一个字符串是否包含另一个您更有可能使用的字符串 `indexOf()`（如果没有找到子字符串，它将返回 -1）。

对于您的目的，第一个解决方案有点矫枉过正。

如果在另一端你想检查是否相等，你可以使用`string1 === string2`

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-01-04T19:39:01.230

## 如果还有人有疑问...

它被另一位同事使用该`indexOf()`方法引用。这个方法的返回要么是“-1”，如果它在数组中没有找到字符串，或者它找到的 case 的位置。

要将其与所需的回报一起使用，您必须先执行检查，例如：

```
exampleMethod () {
const expression = ['string1', string2] .indexOf (this.exampleObject);
if (expression! = -1) {
 return true;
  } else return false;
} 
```

基本上，你会利用这个回报。

但是，`includes()`可以简单地使用该方法：

```
exampleMethode(): boolean {
  return ['string1', 'string2'].includes(this.exampleObject);
} 
```

此方法的返回将以简单的方式执行您想要的操作。将对象字符串与要检查的字符串数组进行比较，并返回一个布尔值。

# objective-c - 为什么两个相等的对象必须具有相同的哈希值？

> ID：10705163
> 
> 赞同：1
> 
> 时间：2012-05-22T15:29:00.257
> 
> 标签：objective-c, cocoa, equality, nsobject

[NSObject 协议参考](https://developer.apple.com/library/ios/#documentation/Cocoa/Reference/Foundation/Protocols/NSObject_Protocol/Reference/NSObject.html#//apple_ref/occ/intfm/NSObject/isEqual%3a)说“如果两个对象相等，它们**必须**具有相同的哈希值。”

为什么一定要？两个相等的对象没有相同的哈希值可能是什么问题？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-22T15:32:09.427

基本上，您将无法在哈希表中查找相等的值。哈希码基本上用作在哈希表（或哈希集）中查找*潜在键匹配的快速方法。*这依赖于“对象相等意味着哈希相等”合同。

如果您不打算在使用散列进行快速查找的*任何内容*中使用您的对象，那么您可能会避免让相等的对象返回不同的散列码 - 但如果可以的话，我真的会避免它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-22T17:22:01.160

这是哈希表如何工作的简化描述。NSSet 是一个哈希表。

**基本结构**

分配一个由 N 个 NSMutableArrays 组成的 NSArray。我们称外部数组为“table”，内部数组为“lists”。这个结构就是我们的哈希表。

**插入的工作原理**

要插入一个对象，请在其上调用“哈希”。这给了我们一个数字。将数字截断在 0 和 (N - 1) 之间。将该结果视为表中的索引。转到该插槽（列表）处的可变数组，查看“对象”是否已在列表中，如果没有则添加。如果是这样，那就没什么可做的了。

**查找的工作原理**

要查看某个值是否在哈希表中，请对其调用 hash。这给了我们一个数字。将数字截断在 0 和 (N - 1) 之间。将该结果视为表中的索引。转到该插槽（列表）处的可变数组，并查看“对象”是否已在列表中。如果它在那里，则表包含该对象，否则它不包含。

* * *

**为什么相等的对象必须具有相等的哈希值？**

哈希码用于查找要搜索的列表。如果两个对象在概念上相等但具有不同的哈希值，那么当我们在外部表中进行上述查找时，我们将不会在预期列表中找到该对象，因为我们的对象将解析为两个不同的列表。

# mysql - 文件和图像的表结构

> ID：10705164
> 
> 赞同：1
> 
> 时间：2012-05-22T15:29:04.407
> 
> 标签：mysql, relational-database, foreign-key-relationship

我正在为一个新的 CMS 设计一个数据库，并且在为文件和图像构建表时遇到了一些麻烦。

当前的设计是有带有文件信息的表：

*   `files`: `name`, `filename`, `extension`, `lang`,`size`
*   `images`: `name`, `filename`, `exstension`,`alt`

它们上方是特定类型的表格，名为：`product_files`, `article_files`. 它们具有 (for `product`and `images`): `id`, `image_id`, `product_id`,等字段`position`。

这些表在那里是因为不同的产品可能具有相同的图像。
问题是，我为每个用例重复这些中间表（2 个用于产品，2 个用于文章等）。

我正在考虑将它们组合在一张表中，例如：

*   `items_images`列：`table`, `table_id`, `image_id`,`position`

这是一个好方法吗？还是我应该保持原样？据我所知，我无法在将其连接到产品或文章表的表上设置外键。

编辑：

看来我不是很清楚这个问题。我不知道如何在这里最好地显示它，所以我将解释图片（[http://i.imgur.com/WrIWt.png](https://i.imgur.com/WrIWt.png)）：![表结构](../Images/35fc0789c48aa627f743f1111410eca7.png)忽略这些线条。

第一行是带有实际文件信息的表格。分别是文档、图像和视频。
中间行是六张桌子，分成三张，每组都连接到他们的桌子（产品和文章）。我想做的是只制作这六个中的三个，但仍然让它们同时连接到产品和文章。也许解决方案是第四张桌子，但我不知道。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T15:34:05.657

您可以使用如下表结构：

id、image_id、pointer_id、位置、类型

类型将告诉它是否是产品、文章等。

# javascript - 访问js中的函数

> ID：10705167
> 
> 赞同：1
> 
> 时间：2012-05-22T15:29:24.753
> 
> 标签：javascript

我在单独的 js 文件中有一个名为 hello() 的函数。

在我的页面上，我有这个 js：

```
<script type='text/javascript'>//do hello fnc</script> 
```

如何让页面脚本调用我的主 js 文件中的函数？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T15:30:32.413

`src`在另一个脚本标记的属性中调用它，*然后*在此脚本中引用它的任何函数。

```
<script type='text/javascript' src='main.js'></script>
<script type='text/javascript'>
  hello();
  // Anything defined in previously included js files like main.js
  // is now available, as well as anything defined on this page.
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T15:30:50.623

先加载外部文件，调用函数：

```
<script src=external.js></script>
<script>
  hello();
</script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-22T15:32:39.873

您只需要包含外部 js 文件：

```
<script type="text/javascript" src="MyOtherFile.js"></script> 
```

然后在你想要调用函数的代码中的任何地方：

```
<script type="text/javascript">hello();</script> 
```

# c# - 为什么我的报告在设置报告参数时抛出异常？

> ID：10705169
> 
> 赞同：2
> 
> 时间：2012-05-22T15:29:29.983
> 
> 标签：c#, reportviewer, reportparameter

好的，所以我的场景是我在表单上有一个报表查看器，它可以根据选择连接多个报表。我将所有报告设置为构建操作的嵌入式资源。

在设置参数之前，我正在加载这样的报告。

```
myReportViewer.LocalReport.ReportEmbeddedResource = "MyApp.MyReport1.rdlc"; 
```

或者

```
myReportViewer.LocalReport.ReportEmbeddedResource = "MyApp.MyReport2.rdlc"; 
```

这种情况很奇怪。假设我运行应用程序并首先选择 MyReport1 并运行它。该报告是保存参数的报告。MyReport2 没有任何参数，只有数据源。MyReport1 将正确加载，一切运行完美。然后我可以切换到 MyReport2 并在两个报告之间来回切换任意多次。

假设我首先运行 MyReport2。它加载正确，我可以多次运行它。但是，如果我切换回 MyReport1，它会在我尝试设置参数时引发以下异常。

```
An attempt was made to set a report parameter 'TotalTime' that is not defined in this report. 
```

看看这个异常，我会假设 MyReport1 由于某种原因没有加载。当我设置 LocalReport.ReportEmbeddedResource。什么会导致 MyReport1 无法正确加载，因为我没有先使用它？

**这是代码，我当然已经剪掉了我无法显示的部分。**

```
if (ReportComboBox.SelectedItem.ToString() == "Time by user") {
     myReportViewer.LocalReport.DataSources.Clear();
     ReportDataSource datasource = new ReportDataSource();
     datasource.Name = "DataSet1";
     datasource.Value = DataSet1BindingSource;
     myReportViewer.LocalReport.DataSources.Add(datasource);
     try {
          myReportViewer.LocalReport.ReportEmbeddedResource = "";
          myReportViewer.LocalReport.ReportEmbeddedResource = "MyApp.MyReport1.rdlc";
          ReportParameter test = new ReportParameter("TotalTime", total.ToString("c"));
          myReportViewer.LocalReport.SetParameters(test);
          myReportViewer.RefreshReport();
     } catch (Exception ex) { 

     }
} else if (ReportComboBox.SelectedItem.ToString() == "Time - Everyone") {
     myReportViewer.LocalReport.DataSources.Clear();
     ReportDataSource datasource = new ReportDataSource();
     datasource.Name = "CompetitionUsers";
     datasource.Value = MyData;
     myReportViewer.LocalReport.DataSources.Add(datasource);
     myReportViewer.LocalReport.ReportEmbeddedResource = "";
     myReportViewer.LocalReport.ReportEmbeddedResource = "MyApp.MyReport2.rdlc";
     myReportViewer.RefreshReport();
} 
```

用户的时间，是吓坏了的部分。通过查看代码，那里没有什么真正有用的。只要我先运行它，它就可以工作。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-07T19:59:47.223

您需要做的是`myReportViewer.Reset()`在加载新报告之前调用。这样做会将 ReportViewer 控件重置为其默认状态，并且 LocalReport 对象将被替换为新实例。这应该可以解决您的问题。

*（实际上，我刚刚偶然发现了一个非常相似的帖子，该帖子具有相同的解决方案 :: [LocalReport.SetParameters Exception 尝试设置此报告中未定义的报告参数“ParameterName”](https://stackoverflow.com/questions/9336272/localreport-setparameters-exception-an-attempt-was-made-to-set-a-report-paramete)）*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T19:20:30.757

您是否尝试过将 ReportViewer.LocalReport 设置为 null 并在每次检测到用户更改时重新实例化它？

编辑：

如果用户选择第一个报告选项，请尝试按此顺序设置报告参数：

```
 ReportParameter[] param = new ReportParameter[1];
 param[0] = new ReportParameter("Report_Parameter_0",txtParameter.Text);
        ReportViewer1.LocalReport.SetParameters(param);

        ReportDataSource rds = new ReportDataSource
            ("DataSet1_Customers_DataTable1", customerList);
        ReportViewer1.LocalReport.DataSources.Clear();
        ReportViewer1.LocalReport.DataSources.Add(rds);
        ReportViewer1.LocalReport.Refresh(); 
```

# .net - 添加大量数据后获取当前页码

> ID：10705171
> 
> 赞同：0
> 
> 时间：2012-05-22T15:29:34.650
> 
> 标签：.net, pdf, itextsharp

我正在使用以下代码将大量数据添加到 PDF 文件中，该文件可能会容纳不止一页。我需要添加一个书签链接到下一页。为此，我需要获取当前页码。但是，`document.PageCount`不可用。如何获取当前 PDF 文件的页数？

```
doc.Add(new Paragraph(new Chunk(StringWithBigChunkData))); 
```

# c# - 如何查找和使用以编程方式创建的控件？

> ID：10705181
> 
> 赞同：2
> 
> 时间：2012-05-22T15:30:12.077
> 
> 标签：c#, winforms, reference, tags, controls

我在基于数据库条目的表单上创建了许多按钮，它们工作得很好。这是创建它们的代码。如您所见，我给了他们一个标签：

```
for (int i = 0; i <= count && i < 3; i++)
{
    btnAdd.Text = dataTable.Rows[i]["deviceDescription"].ToString();
    btnAdd.Location = new Point(x, y);
    btnAdd.Tag = i;

    this.Controls.Add(btnAdd);
} 
```

我使用这些按钮来可视化投票系统。例如，我希望按钮在一切正常时为绿色，而在出现问题时为红色。

所以我遇到的问题是稍后引用按钮，以便我可以更改它们的属性。我已经尝试过以下内容：

```
this.Invoke((MethodInvoker)delegate
{
    // txtOutput1.Text = (result[4] == 0x00 ? "HIGH" : "LOW"); // runs on UI thread
    Button foundButton = (Button)Controls.Find(buttonNumber.ToString(), true)[0];
    if (result[4] == 0x00)
    {
        foundButton.BackColor = Color.Green;
    }
    else
    {
        foundButton.BackColor = Color.Red;
    }
}); 
```

但无济于事......我试过改变语法，`Controls.Find()`但仍然没有运气。有没有人遇到过这个问题或知道该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T15:34:00.727

将这些按钮放在一个集合中，并设置控件的名称而不是使用它的标签。

```
var myButtons = new List<Button>();
var btnAdd = new Button();
btnAdd.Text = dataTable.Rows[i]["deviceDescription"].ToString();
btnAdd.Location = new Point(x, y);
btnAdd.Name = i;
myButtons.Add(btnAdd); 
```

要找到按钮，请使用它。

```
Button foundButton = myButtons.Where(s => s.Name == buttonNumber.ToString()); 
```

或者简单地说

```
Button foundButton = myButtons[buttonNumber]; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-22T15:41:35.830

如果在创建按钮时命名按钮，则可以从 this.controls(...

像这样

```
for (int i = 0; i <= count && i < 3; i++)
    {
        Button btnAdd = new Button();
        btnAdd.Name="btn"+i;

        btnAdd.Text = dataTable.Rows[i]["deviceDescription"].ToString();
        btnAdd.Location = new Point(x, y);
        btnAdd.Tag = i;

        this.Controls.Add(btnAdd);
    } 
```

然后你可以像这样找到它

```
this.Controls["btn1"].Text="New Text"; 
```

或者

```
 for (int i = 0; i <= count && i < 3; i++)
{
//**EDIT**  I added some exception catching here
    if (this.Controls.ContainsKey("btn"+buttonNumber))
        MessageBox.Show("btn"+buttonNumber + " Does not exist");
    else
        this.Controls["btn"+i].Text="I am Button "+i;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-22T15:41:53.883

在您的情况下，我会使用一个简单的字典来存储和检索按钮。

宣言：

```
IDictionary<int, Button> kpiButtons = new Dictionary<int, Button>(); 
```

用法：

```
Button btnFound = kpiButtons[i]; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-22T15:43:00.420

@Asif 是对的，但如果你真的想使用标签，你可以使用 next

```
 var button = (from c in Controls.OfType<Button>()
               where (c.Tag is int) && (int)c.Tag == buttonNumber
               select c).FirstOrDefault(); 
```

我宁愿创建带有数字、按钮引用和逻辑的小型助手类，并将其收集在表单上。

# search - Facebook 搜索不再情境化？

> ID：10705192
> 
> 赞同：1
> 
> 时间：2012-05-22T15:30:38.997
> 
> 标签：search, facebook-graph-api

直到几天前，当使用 Graph API 搜索时，结果被上下文化到当前用户。例如，使用我的访问令牌以我的用户登录，使用 q=Massimo&type=user 调用搜索返回了我的名为 Massimo 的朋友，然后是其他名为 Massimo 的人，但我的朋友高于其他结果。

今天它只返回随机的人，搜索似乎不再是上下文化的。

有没有一些变化？是否有新的搜索选项来获取上下文化结果而不是通用搜索结果？这是出于某种原因的政策变化吗？或者它只是一个副作用或暂时的问题？

TIA

编辑：

澄清：Facebook 网站本身内部的搜索框仍然返回上下文相关的内容。以前，通过图形 api 调用搜索系统返回或多或少相同的结果，为用户量身定制。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T16:01:45.830

搜索结果由查询缓存，而不是用户搜索的内容。这意味着有人第一次搜索它被 facebook 缓存的东西。稍后，如果其他人搜索相同的内容，他们会得到类似的结果（并不总是针对他们的帐户量身定制）。隐私设置发挥作用（例如，哪些信息是可见的以及用户是否可以被搜索）。但总的来说，结果是一样的。

您可以通过使用两个不同的访问令牌搜索同一用户来测试这一点。结果将是相对相同的，即使一个用户是朋友而另一个不是。

例如，使用用户 A，搜索用户 C（A 和 C 是朋友）。检查结果。然后，搜索用户 C，但使用用户 B（B 和 C 不是朋友）。结果应该是相对相同的（如果不完全相同的话。

# sql-server-2005-express - 卸载 SQL Server 实例，我丢失了我的用户数据库

> ID：10705194
> 
> 赞同：-1
> 
> 时间：2012-05-22T15:30:55.550
> 
> 标签：sql-server-2005-express

IT 管理员已卸载测试 SQL Server 实例。它有大量的实时测试数据。我想知道是否

1.  卸载实例会删除数据库？
2.  有没有办法恢复丢失的数据库？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T15:54:42.607

如果 .mdf 文件仍然存在，您应该能够重新附加到实时实例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T15:32:50.577

不必要。只要`.mdf`文件仍在磁盘上，您就可以将其附加到新实例。

# jquery - URL 隐藏似乎会损害网站功能

> ID：10705198
> 
> 赞同：1
> 
> 时间：2012-05-22T15:31:06.093
> 
> 标签：jquery, ajax, url, dns, url-redirection

我已经启动并运行了以下网站：www.posti.sh 该网站实际上位于 www.myskoob.com/postish/，但我使用域转发，因此当用户键入 www.posti.sh 时，它会保持这种状态并且不会更改为 www.myskoob.com/postish/。你可以试试官网。它通常是关于发布一些东西并使用 jQuery ajax 让用户执行发布。随意测试它。

这是问题所在：

在访问 www.myskoob.com/postish/ 时，发布工作正常 - 所有 ajax 调用似乎都有效。但是，当我访问 www.posti.sh 时，它不起作用，尽管它访问相同的文件 - 我不明白为什么。

有两种转发方式——一种是帧转发（然后可以工作），另一种是 URL 隐藏，这是一种更简洁的方式，因为这样 URL 实际上会随着打开的不同页面而变化。

有人知道 URL 隐藏不起作用的原因吗？我试图在 ajax 调用的 php 文件上回显某些内容，但它没有返回任何内容，所以问题似乎是 ajax 无法连接到该文件。

感谢您的帮助！

丹尼斯

更新 1

请在此处查看 ajax 代码：

```
//Post
    $.ajax({
        type: 'POST',
        url: 'action/post.php',
        data: 'posttext='+posttext+'&imageurl='+imageurl+'&randomcode='+randomcode,
        success: function(post){
            //Do something here
        }
    }).error(function(){
        //Say it could not post
        alert('The post could not be sent - please try again later.');
    }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T15:33:23.087

域是否硬编码到您的 ajax 请求中？因为由于Web 浏览器中的[同源策略](http://en.wikipedia.org/wiki/Same_origin_policy)，您无法对不同的域执行典型的 ajax 请求。

一种解决方法是不在 ajax 逻辑中对域进行硬编码，只需使用相对路径。IE：

而不是`$.load('http://mydomain.com/search/results.json');`使用`$.load('/search/results.json');`

# css - 按钮文本推开 Firefox 中的填充

> ID：10705199
> 
> 赞同：3
> 
> 时间：2012-05-22T15:31:10.183
> 
> 标签：css, firefox, button, padding

标记：

```
<input type="button" value="random text random text random text random text random text"
       style="padding-left:20px; text-align:left; width:100px;" /> 
```

在这里`padding-left`工作正常，直到我设置宽度，在中间切掉文本，推开`padding-left`。顺便说一句，这只是一个 Firefox 问题。在所有其他浏览器中都能正常工作。现场示例：http: [//jsfiddle.net/aB25a/1](http://jsfiddle.net/aB25a/1)

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T13:47:52.677

您应该使用该`<button>`元素，这使您可以更好地控制其内容发生的情况：

```
<button class="wrong">
  <span>this pushes text to the left, ignoring padding</span>
</button> 
```

然后样式是：

```
.wrong {
    width: 100px;
    overflow: hidden;
}

.wrong span {
    margin-left:30px;
    text-align: left;
    white-space: nowrap;
} 
```

应该适用于所有浏览器的示例：http: [//jsfiddle.net/p8mg8/1/](http://jsfiddle.net/p8mg8/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T15:54:04.153

尝试使用`margin-left`而不是你的`padding-left`，我也建议使用类和 CSS 文件。

设置`width:auto;`, 或某个值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-23T07:41:55.897

了解如何使其工作：

```
input[type="button"]::-moz-focus-inner { margin-left:20px }; 
```

# oracle11g - 为 Oracle 作业链中的步骤定义参数值

> ID：10705201
> 
> 赞同：4
> 
> 时间：2012-05-22T15:31:11.370
> 
> 标签：oracle11g, dbms-scheduler

我正在 Oracle (11R2) DBMS Scheduler 中构建作业链。链条有两个步骤。每个步骤都运行相同的程序，但参数不同。我可以看到如何定义链、步骤、规则等 - 但我不知道如何设置步骤的参数值。

当我构建单个调用程序的作业时，我设置的参数如下：

```
dbms_scheduler.set_job_argument_value(
   job_name    => 'MY_JOB',
   argument_position => 1,
   argument_value => 'foo'); 
```

我的问题是：我会调用哪个 dbms_scheduler func/proc 来设置作业步骤的参数？使用下面的示例，如何在“MY_CHAIN”中为“STEP_1”设置参数？

谢谢，约翰

```
DBMS_SCHEDULER.CREATE_CHAIN (
    chain_name => 'MY_CHAIN',
    rule_set_name => NULL,
    evaluation_interval => NULL,
    comments => 'Chain calls 2 steps. Same program but with different arg values.');

DBMS_SCHEDULER.DEFINE_CHAIN_STEP (
    chain_name  => 'MY_CHAIN',
    step_name   => 'STEP_1',
    program_name => 'MY_PROGRAM');

DBMS_SCHEDULER.DEFINE_CHAIN_STEP (
    chain_name  => 'MY_CHAIN',
    step_name   => 'STEP_2',
    program_name => 'MY_PROGRAM');

DBMS_SCHEDULER.CREATE_JOB (
    job_name        => 'MY_CHAIN_JOB',
    job_type        => 'CHAIN',
    job_action      => 'MY_CHAIN',
    repeat_interval => 'freq=daily;byhour=12;byminute=0;bysecond=0',
    enabled         => TRUE); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T22:07:13.860

我相信您必须为此定义两个不同的程序，尽管它们当然可以引用相同的存储过程或可执行文件。

在前一种情况下，除非我要修改参数值，否则我倾向于使用匿名块程序类型来指定存储过程的参数——它足够复杂，无需添加所有程序参数。

# jquery - 无法让鼠标悬停在 jquery Selectmenu 上正常工作

> ID：10705203
> 
> 赞同：0
> 
> 时间：2012-05-22T15:31:22.937
> 
> 标签：jquery, jquery-ui, javascript-events, select-menu

我试图让`Jquery Selectmenu plugin`鼠标悬停时展开，但离开时再次关闭。

我决定将`MouseOver`and`MouseOut`事件与`open`and`close`命令一起使用。

问题在于它是如何工作的。它似乎在 div 之外创建了某种假菜单，因此一旦我移过选项，菜单就会再次关闭。

我在 JsFiddle 中复制了这个：http: [//jsfiddle.net/jc2bs/](http://jsfiddle.net/jc2bs/)

我希望能够让它发挥作用。

此外，如果我能够在`mouseout`它被 a 激活时关闭它，`mouseover`但如果它被单击激活则不能关闭（因此，如果用户单击菜单，它将保持打开状态，直到他选择一个选项或单击外部）。但我想这是一个更难解决的场景。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T16:28:32.217

对于第一个（子）问题，您可以使用下面的解决方案。这对我来说很好：

```
$("body").on("mouseenter", "#sel-button", function() {
    $('#sel').selectmenu('open');
});

$("body").on("mouseleave", "#sel-button, #sel-menu", function() {
    if (!$('#sel-menu').is(':hover')) {
        $('#sel').selectmenu('close');
    }
}); 
```

所以，我做了什么。`delegate`首先，我用新方法更改了不推荐使用的`on`方法。然后，我使用`mouseenter`和`mouseleave`事件而不是`mouseover`和`mouseout`（你可以[在文档](http://api.jquery.com/mouseleave/)中查看原因）。考虑子菜单的 ID ( `#sel-menu`)，它是通过将`select`元素 ID 与`"-menu"`. 选择按钮也是如此。

**演示：http:** [//jsfiddle.net/jc2bs/6/](http://jsfiddle.net/jc2bs/6/)

* * *

关于第二个（子）问题，我们可以使用几个技巧。如果单击菜单，则`data`用于存储标志，并基于此决定是否在鼠标离开时隐藏子菜单。

**演示：http:** [//jsfiddle.net/jc2bs/7/](http://jsfiddle.net/jc2bs/7/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T16:31:19.320

您可以通过使用`mouseleave`selectmenu 本身上的事件来关闭菜单来完成此操作。

```
$('.ui-selectmenu-menu').on('mouseleave', function() {
    $('#sel').selectmenu('close');
}); 
```

直播：http: [//jsfiddle.net/5wExe/1](http://jsfiddle.net/5wExe/1)

虽然您的第二个要求在理论上是可能的，但我个人认为这不是一个好主意。如果菜单出现，用户不会想点击它`onmouseover`。

# jquery-ui - 使用两次时，Jquery 块 UI 不起作用？

> ID：10705206
> 
> 赞同：3
> 
> 时间：2012-05-22T15:31:35.633
> 
> 标签：jquery-ui, jquery, jquery-plugins, jquery-blockui

我正在使用 jquery block UI 插件，我的要求是检查用户是否是授权用户，这是我的代码

```
<script language="javascript" type="text/javascript">

        $(document).ready(function () {
            $('#btnsubmit').click(function () {
                $.blockUI({ css: {
                    border: 'none',
                    padding: '15px',
                    backgroundColor: '#000',
                    '-webkit-border-radius': '10px',
                    '-moz-border-radius': '10px',
                    opacity: .5,
                    color: '#fff'
                }
                });
            });
        }); 

     function ajaxAuth() {
       //UserLogin.IServiceLogin.HelloWorldCC(OnSuccess, OnFailure);
         var usrname = document.getElementById('txtusrname').value;
         var pasd = document.getElementById('txtpassword').value;
         UserLogin.IServiceLogin.GetUseCred(usrname, pasd, onSuccess, onFailed);
     }

     function onSuccess(result) {
         setTimeout($.unblockUI, 0);
         var obj = jQuery.parseJSON(result);

         if (obj.name != "error" ) {
             document.getElementById('labusr').value = obj.name;
             document.getElementById('labpass').value = obj.passd;
             document.getElementById('labkey').value = obj.key;
             location.href = "DesignAPage.aspx";
         } else {
             $.blockUI({ message: $('#question'), css: { width: '350px'} });

//             $('#ok').click(function () {
//                 $.unblockUI();
//                 return false;
//             }); 
         }
     }

     function onFailed(result) {
         alert("failure");
     }

    </script> 
```

所以问题是当我使用 `$.blockUI({ message: $('#question'), css: { width: '350px'} });`它时，它只会阻塞屏幕一秒钟并解锁屏幕。

任何帮助是极大的赞赏

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T16:20:52.240

问题是由`setTimeout($.unblockUI, 0);`. 即使您可能认为调用它会导致附加函数的代码立即运行，但事实并非如此。您可以通过运行以下命令来验证这一点：

```
setTimeout(function() {
    console.log('one');
}, 0);
console.log('two'); 
```

`two`之前记录`one`。原因在于 JavaScript 在内部处理计时器的方式。由于它是单线程的，因此没有任何东西可以同时运行。传递 0 毫秒`setTimeout`只会强制函数在第一个可用时刻运行。在这种情况下，that's right after`$.blockUI`被调用。

John Resig 在[http://ejohn.org/blog/how-javascript-timers-work/](http://ejohn.org/blog/how-javascript-timers-work/)上有一篇很好的文章。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T16:12:39.613

我把你的代码剪掉了一点，但这是有效的。

```
$(document).ready(function() {
$.blockUI({ css: { 
    border: 'none', 
    padding: '15px', 
    backgroundColor: '#000', 
    '-webkit-border-radius': '10px', 
    '-moz-border-radius': '10px', 
    opacity: .5, 
    color: '#fff' 
    } 
    }); 

    onSuccess();

});

function onSuccess() { 
$.unblockUI();

$.blockUI({ message: "Some message", css: { width: '350px'} }); 

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-22T17:58:45.550

尝试在 else 块中执行此操作

```
else {
             $.unblockUI({
                 onUnblock: function () {
                     $.blockUI({ message: $('#question'), css: {
                         border: 'none',
                         padding: '15px',
                         backgroundColor: '#000',
                         '-webkit-border-radius': '10px',
                         '-moz-border-radius': '10px',
                         opacity: .5,
                         color: '#fff'
                     }
                     });
                     $('#ok').click(function () {
                         $.unblockUI();
                         return false;
                     }); 
                   }
             }); 
         } 
```

# javascript - 默认情况下从数据列表中选择第一条记录？

> ID：10705209
> 
> 赞同：0
> 
> 时间：2012-05-22T15:31:42.197
> 
> 标签：javascript, html, html-datalist

我在 .asp 线程中看到过这个问题，但我没有使用 .asp，所以答案不是很有帮助。我正在使用 html，但如果需要，可以使用 javascript 来实现这个目标。

我所拥有的是一个标准的 html 输入，其中包含一个可用选项的数据列表，如下所示：

```
<input id="test_input" list="test" name="test" placeholder="Type your answer" value="" />
<datalist id="test">
<select>
<option>Apples</option>
<option>Oranges</option>
<option>Grapes</option>
</select>
</datalist> 
```

问题是，如果有人实际上键入“g”或“ap”或任何内容，然后按下提交按钮，它不会选择默认记录。它会缩小列表的范围，但键入“Grapes”并按 Enter 不会得到与实际单击选择中的“Grapes”相同的结果。

如何强制选择第一条记录，即使用户只键入该记录的一部分？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T15:35:27.277

我认为这不是最好的方法，因为您在编写时无法“重置”。所以当我开始输入苹果时，我错过了“l”，我会输入 appk，然后我说“哦，上帝，我错过了”，我重试。我将再次键入 apple，但键入的值将是 appkapple，如果您在一段时间后不设置 setinterval 来清除已键入的值，但这没有意义。

为什么不尝试自动完成或带有选项的选择字段？

# c# - 避免添加重复的数据行

> ID：10705210
> 
> 赞同：4
> 
> 时间：2012-05-22T15:31:44.537
> 
> 标签：c#, .net, winforms, datagridview, duplicate-removal

在我的 Windows 窗体应用程序中，基本上我有两个`DataGridView`s. 我想从右侧选择行并将选定的行添加到左侧。右侧`DataGridView`有一个复选框列。

**看图片：**

* * *

![网格](../Images/8201a5d1e8f95e936f21631d0ae46cf3.png)

* * *

**例如 ：**

* * *

1.  单击第一行，然后单击添加按钮。

2.  单击第三行，然后单击添加按钮。

问题是第一行被添加了两次，因为它被勾选了。

如何确保添加的行是不同的？

* * *

**我的代码：**

* * *

```
foreach (DataGridViewRow row in dgRight.Rows)
{
    DataGridViewCheckBoxCell check = row.Cells[0] as DataGridViewCheckBoxCell;
    if (check.Value != null)
    {
        if ((bool)check.Value)
        {
            DataRow myRow = (row.DataBoundItem as DataRowView).Row;
            DataRow dr = dt.NewRow();
            dr[0] = myRow[0];
            dr[1] = myRow[1];
            dr[2] = myRow[2];
            dr[3] = myRow[3];

            dt.Rows.Add(dr);
        }
    }
}
dgLeft.DataSource = dt; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T15:35:10.883

`Data Table`使用以下方法检查该行是否已存在`.Find`：

```
var rowExists = dt.Rows.Find(dr);

if (rowExists == null) { // The row doesn't exist
  dt.Rows.Add(dr); // Add the row
} 
```

# vbscript - 设置“选项显式”时，用于检查注册表项的 VBScript 不起作用

> ID：10705212
> 
> 赞同：2
> 
> 时间：2012-05-22T15:31:57.823
> 
> 标签：vbscript, registry

好的，我在这里的第一篇文章希望我不要搞砸太糟糕，把整个互联网都压在我身上......

我有一个简单的函数来检查注册表项是否存在。它按我的预期工作，直到我设置“选项显式”。然后它没有。没有错误，它只是没有返回正确的值，我不知道为什么。毫无疑问，这是一个愚蠢的错误，当你们都指出它是多么愚蠢时，我很可能会羞愧地溜走，但只要你先告诉我我做错了什么，这将是值得的。

这是代码：

```
'option explicit

if keyExists("HKEY_CURRENT_USER\Software\WritingInCode\Company\CreateCabinetDB\") then
    wscript.echo "Key exists"
else
    wscript.echo "Key doesn't exist"
end if

function keyExists(key)
    dim objShell : set objShell = createObject("WScript.Shell")

    on error resume next

    entry = objShell.regRead(key)

    select case err.number
        case 0: keyExists = true
        case else: keyExists = false
    end select

    err.clear

    set objShell = nothing
end function 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T15:39:35.250

好的，这就是正在发生的事情。

1.  您进行了设置`option explicit`，以便在遇到未声明的变量时，解释器将引发错误。
2.  在到达第一个未声明的变量之前`entry`，您使用 关闭错误处理`on error resume next`。
3.  然后你遇到`entry`并引发错误，但没有报告。
4.  执行恢复，未声明的变量错误由`select case`语句解释。所以`keyExists`总是返回`false`。

`entry`通过在尝试使用它之前声明来解决问题：

```
dim entry : entry = objShell.regRead(key) 
```

# php - Yii 视图 - 解决常见场景的最佳方法 - 使用布局？

> ID：10705217
> 
> 赞同：1
> 
> 时间：2012-05-22T15:32:25.640
> 
> 标签：php, templates, yii

假设您的主页与您网站的其他页面不同（但不完全不同）。

很明显，我们应该为所有二级页面创建一个布局。

但是，这里的主页应该如何处理，还不是很清楚？

因为，如果我们在布局上做一个条件，告诉类似：如果它不是主页，使用这个，否则使用那个。

如果将来我们有其他页面也应该与主页不同，那么维护起来一点也不友好。如果不是这个，如果不是那个，如果那个，那么......：s

我相信正是在这种情况下存在设计模式——但希望有一个吗？

我的问题是：处理这个问题的好方法是什么？我们应该定义两个布局吗？一个用于主页，另一个用于所有其他？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T15:50:29.893

是的，肯定会做两种布局。在控制器中的操作函数中覆盖要在主页情况下使用的布局：

```
$this->layout = '//layouts/home'; 
```

# c# - EF 4.3.1 在 LinqToEntities 查询中包含继承的导航属性

> ID：10705218
> 
> 赞同：4
> 
> 时间：2012-05-22T15:32:26.657
> 
> 标签：c#, inheritance, ef-code-first, entity-framework-4.3, navigation-properties

我正在尝试使用代码优先方法和流畅的配置使用 EF 4.3.1 设置一个简单的继承场景。

我创建了一个具有一对一导航属性的抽象基类型“A”和一个继承类“AA”，也具有一对一导航属性，具有以下内容：

```
public abstract class A
{
    public Guid ID { get; set; }
    public B ChildB { get; set; }
}

public class AA : A
{
    public C ChildC { get; set; }
}

public class B
{
    public Guid ID { get; set; }
    public A Parent { get; set; }
}

public class C
{
    public Guid ID { get; set; }
    public AA Parent { get; set; }
}

public class AConfiguration : EntityTypeConfiguration<A>
{
    public AConfiguration()
    {
        this.HasRequired(o => o.ChildB)
            .WithRequiredPrincipal(o => o.Parent);

        this.Map(o =>
        {
            o.ToTable("A");
        });
    }
}

public class AAConfiguration : EntityTypeConfiguration<AA>
{
    public AAConfiguration()
    {
        this.HasRequired(o => o.ChildC)
            .WithRequiredPrincipal(o => o.Parent);

        this.Map(o =>
        {
            o.ToTable("AA");
        });
    }
}

public class BConfiguration : EntityTypeConfiguration<B>
{
    public BConfiguration()
    {
        this.HasRequired(o => o.Parent)
            .WithRequiredDependent(o => o.ChildB);

        this.Map(o =>
        {
            o.ToTable("B");
        });
    }
}

public class CConfiguration : EntityTypeConfiguration<C>
{
    public CConfiguration()
    {
        this.HasRequired(o => o.Parent)
            .WithRequiredDependent(o => o.ChildC);

        this.Map(o =>
        {
            o.ToTable("C");
        });
    }
}

public class DataContext : DbContext
{
    protected override void OnModelCreating(DbModelBuilder modelBuilder)
    {
        modelBuilder.Configurations.Add<A>(new AConfiguration());
        modelBuilder.Configurations.Add<AA>(new AAConfiguration());
        modelBuilder.Configurations.Add<B>(new BConfiguration());
        modelBuilder.Configurations.Add<C>(new CConfiguration());
    }

    public DbSet<AA> AASet { get; set; }
    public DbSet<B> BSet { get; set; }
    public DbSet<C> CSet { get; set; }
} 
```

当我尝试使用第一级导航属性取回数据时，它按预期工作：

```
... dataContext.AASet.Include("ChildB") ... 
```

但是当我尝试包含继承类型的导航属性时，如下所示：

```
... dataContext.AASet.Include("ChildC") ... 
```

我在运行时收到 EntityCommandCompilationException 并带有以下内部异常消息：

> 指定表达式的 ResultType 与所需类型不兼容。表达式 ResultType 是“Transient.reference[...A]”，但所需的类型是“Transient.reference[...AA]”。参数名称：arguments[0]

有没有人遇到过类似的问题？

我可能遗漏了一些东西，但我看不出这个样本有什么问题。

我该怎么做才能让我的模型按预期工作？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-22T18:05:31.327

不，你不会错过任何东西。实际上，您遇到了一个旧的实体框架错误。您的第二个查询可以这样写：

```
var result = dataContext.ASet.OfType<AA>().Include("ChildC").ToList(); 
```

（当您将 DbSet 替换`AASet`为时`ASet`）。

对于这种在继承类型上急切加载的一对一映射子项，本文适用：[http ://weblogs.asp.net/johnkatsiotis/archive/2010/04/28/huge-ef4-inheritance-bug.aspx](http://weblogs.asp.net/johnkatsiotis/archive/2010/04/28/huge-ef4-inheritance-bug.aspx)

该错误很久以前就在这里报告过：[https ://connect.microsoft.com/VisualStudio/feedback/details/544639/ef4-inheritance-defined-using-queryview-doesnt-work-properly-with-association](https://connect.microsoft.com/VisualStudio/feedback/details/544639/ef4-inheritance-defined-using-queryview-doesnt-work-properly-with-association)

该错误仍然存​​在于 EF 4.3.1 中。但是微软已经在这个线程中宣布该错误已在 .NET 4.5 (= EF 5.0) 中修复。

如果关系是一对多而不是一对一，则该代码将起作用。我相信延迟或显式加载也可以（也具有一对一的关系）：

```
var result = dataContext.ASet.OfType<AA>().ToList();
foreach (var item in result)
    dataContext.Entry(item).Reference(a => a.ChildC).Load(); 
```

但这会产生多个查询。如果您没有多个查询的性能问题，我更喜欢最后一种解决方法 - 直到您可以迁移到 EF 5.0。

# salesforce - 视觉力界面

> ID：10705220
> 
> 赞同：0
> 
> 时间：2012-05-22T15:32:40.430
> 
> 标签：salesforce, apex-code, visualforce

嗨我想在visualforce中创建一个这样的界面

![图片](../Images/63ad499bb9f45e3952719bf3ea7bc93e.png)

其中第一列中的值将来自顶点控制器

请给出一些在visualforce中执行此操作的想法。此外，用户将移动到第二列的值将保存在某处。我正在考虑使用自定义设置，所有可用的选项都有哪些。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T17:04:02.063

不幸的是，利用您在 VisualForce 中描述的功能的唯一方法是使用`<apex:inputField>`绑定到 SObject 上的多选项列表字段的标签。此选项为您提供了保存数据的位置，尽管您需要事先在配置中指定可能的值（这听起来不像您想要的那样）。

如果要动态填充值，则需要在控制器中创建 SelectOptions 列表并将该列表绑定到`<apex:selectlist>`具有属性集的标记`multiselect`（请记住，这不会给您提供花哨的左右箭头您在屏幕截图中显示，但它允许用户通过 shift/ctrl-clicking 选择多个选项）。

VisualForce 片段：

```
<apex:selectList value="{!multiPicklistVal}" multiselect="true">
    <apex:selectOptions value="{!multiPicklistOptions}"/>
</apex:selectList> 
```

Apex 控制器片段：

```
public String[] multiPicklistVal {public get; public set;}
public List<SelectOption> getMultiPicklistOptions() {
    List<SelectOption> opts = new List<SelectOption>();
    opts.add(new SelectOption('Red', 'Red'));
    opts.add(new SelectOption('Green', 'Green'));
    opts.add(new SelectOption('Blue', 'Blue'));
    return opts;
} 
```

这种方法将允许您`multiPicklistVal`在操作方法中将其作为字符串数组进行引用，其中每个字符串都已由用户选择。从这里，您可以将它们保存在您提到的自定义设置中，或者保存在自定义对象中（但如果您要使用自定义对象路线，您也可以使用我的开箱即用功能在这篇文章的顶部描述）。

# sql-server - 挣扎于 XML 命名空间节点查询

> ID：10705222
> 
> 赞同：2
> 
> 时间：2012-05-22T15:32:45.033
> 
> 标签：sql-server, xml, tsql, sql-server-2005

在使用 XML 节点时，我很难理解 XML 命名空间查询 - 我在这里阅读了其他类似的问题和一篇文章[，](http://marcanton.io/blog/the-cheaters-guide-to-mastering-xquery-on-sql-server-part-1/)但无法将其应用于我的特定查询。

我有这个示例 XML 的更大版本：

```
SELECT CAST('<Navigator clsid="{ABF8EB05-610D-11D3-A53E-684F745C}">
  <Version>7</Version>
  <NavigatorNodes clsid="{0484ACB1-78F5-48D7-A26B-3A0ACD3A5F91}">
    <NavigatorNode clsid="{59AB61BD-7833-4954-94C2-B6D737E3DD6F}">
      <Indent>0</Indent>
      <Caption>Contact</Caption>
      <Selected>0</Selected>
      <ViewType>0</ViewType>
      <ViewSubType>0</ViewSubType>
      <ShowTotals>0</ShowTotals>
      <RowHeight>0</RowHeight>
      <Complement>0</Complement>
      <FreezeFirst>0</FreezeFirst>
      <a1:QueryFilter xmlns:a2="http://www.ascenttechnology.co.uk/schemas/entities" xmlns:xsi="http://www.w3.org/21/XMLSchema-instance" xmlns:a1="http://www.ascenttechnology.co.uk/schemas/services" Type="QueryFilter">
        <entity_name>Contact</entity_name>
        <relationship_name />
        <relationship_from_entity_name />
        <a1:ColumnInfoCollection Type="ColumnInfoCollection" AscentCollection="true">
          <__vers>1</__vers>
          <IgnoreMissingItem>0</IgnoreMissingItem>
          <ReadOnly>0</ReadOnly>
          <AllowNulls>0</AllowNulls>
          <a1:ColumnInfo Type="ColumnInfo">
            <attribute_name>state</attribute_name>
            <width>0</width>
          </a1:ColumnInfo>
          <a1:ColumnInfo Type="ColumnInfo">
            <attribute_name>current_address_suffix</attribute_name>
            <width>0</width>
          </a1:ColumnInfo>
        </a1:ColumnInfoCollection>
        <a1:SurveyColumnInfoCollection Type="AttributeInfoCollection" AscentCollection="true">
          <__vers>1</__vers>
          <IgnoreMissingItem>0</IgnoreMissingItem>
          <ReadOnly>0</ReadOnly>
          <AllowNulls>0</AllowNulls>
        </a1:SurveyColumnInfoCollection>
        <a1:WorkflowColumnInfoCollection Type="AttributeInfoCollection" AscentCollection="true">
          <__vers>1</__vers>
          <IgnoreMissingItem>0</IgnoreMissingItem>
          <ReadOnly>0</ReadOnly>
          <AllowNulls>0</AllowNulls>
        </a1:WorkflowColumnInfoCollection>
        <a1:ConditionCollection Type="ConditionCollection" AscentCollection="true">
          <__vers>1</__vers>
          <IgnoreMissingItem>0</IgnoreMissingItem>
          <ReadOnly>0</ReadOnly>
          <AllowNulls>0</AllowNulls>
          <a1:Condition Type="Condition">
            <attribute_name>class</attribute_name>
            <description1 />
            <description2 />
            <attribute_id>0</attribute_id>
            <not>0</not>
            <operator>28</operator>
            <value1>1</value1>
            <value2 xsi:nil="true" />
            <indent_level>0</indent_level>
            <value1_is_reference>0</value1_is_reference>
            <value2_is_reference>0</value2_is_reference>
          </a1:Condition>
          <a1:Condition Type="Condition">
            <attribute_name>do_not_mail</attribute_name>
            <description1 />
            <description2 />
            <attribute_id>0</attribute_id>
            <not>0</not>
            <operator>0</operator>
            <value1>True</value1>
            <value2 xsi:nil="true" />
            <indent_level>0</indent_level>
            <value1_is_reference>0</value1_is_reference>
            <value2_is_reference>0</value2_is_reference>
          </a1:Condition>
          <a1:Condition Type="Condition">
            <attribute_name>gone_away</attribute_name>
            <description1 />
            <description2 />
            <attribute_id>0</attribute_id>
            <not>0</not>
            <operator>0</operator>
            <value1>True</value1>
            <value2 xsi:nil="true" />
            <indent_level>0</indent_level>
            <value1_is_reference>0</value1_is_reference>
            <value2_is_reference>0</value2_is_reference>
          </a1:Condition>
          <a1:Condition Type="Condition">
            <attribute_name>dp_opt_out</attribute_name>
            <description1 />
            <description2 />
            <attribute_id>0</attribute_id>
            <not>0</not>
            <operator>0</operator>
            <value1>True</value1>
            <value2 xsi:nil="true" />
            <indent_level>0</indent_level>
            <value1_is_reference>0</value1_is_reference>
            <value2_is_reference>0</value2_is_reference>
          </a1:Condition>
          <a1:Condition Type="Condition">
            <attribute_name>deceased</attribute_name>
            <description1 />
            <description2 />
            <attribute_id>0</attribute_id>
            <not>0</not>
            <operator>0</operator>
            <value1>True</value1>
            <value2 xsi:nil="true" />
            <indent_level>0</indent_level>
            <value1_is_reference>0</value1_is_reference>
            <value2_is_reference>0</value2_is_reference>
          </a1:Condition>
          <a1:Condition Type="Condition">
            <attribute_name>deleted</attribute_name>
            <description1 />
            <description2 />
            <attribute_id>0</attribute_id>
            <not>0</not>
            <operator>0</operator>
            <value1>True</value1>
            <value2 xsi:nil="true" />
            <indent_level>0</indent_level>
            <value1_is_reference>0</value1_is_reference>
            <value2_is_reference>0</value2_is_reference>
          </a1:Condition>
          <a1:Condition Type="Condition">
            <attribute_name>Date_Of_Birth</attribute_name>
            <description1 />
            <description2 />
            <attribute_id>0</attribute_id>
            <not>0</not>
            <operator>19</operator>
            <value1>2010-06-23T::.+:</value1>
            <value2 xsi:nil="true" />
            <indent_level>0</indent_level>
            <value1_is_reference>0</value1_is_reference>
            <value2_is_reference>0</value2_is_reference>
          </a1:Condition>
          <a1:Condition Type="Condition">
            <attribute_name>home_address1</attribute_name>
            <description1 />
            <description2 />
            <attribute_id>0</attribute_id>
            <not>0</not>
            <operator>26</operator>
            <value1 xsi:nil="true" />
            <value2 xsi:nil="true" />
            <indent_level>0</indent_level>
            <value1_is_reference>0</value1_is_reference>
            <value2_is_reference>0</value2_is_reference>
          </a1:Condition>
          <a1:Condition Type="Condition">
            <attribute_name>home_postcode</attribute_name>
            <description1 />
            <description2 />
            <attribute_id>0</attribute_id>
            <not>0</not>
            <operator>26</operator>
            <value1 xsi:nil="true" />
            <value2 xsi:nil="true" />
            <indent_level>1</indent_level>
            <value1_is_reference>0</value1_is_reference>
            <value2_is_reference>0</value2_is_reference>
          </a1:Condition>
          <a1:Condition Type="Condition">
            <attribute_name>home_address1</attribute_name>
            <description1 />
            <description2 />
            <attribute_id>0</attribute_id>
            <not>0</not>
            <operator>0</operator>
            <value1 />
            <value2 xsi:nil="true" />
            <indent_level>0</indent_level>
            <value1_is_reference>0</value1_is_reference>
            <value2_is_reference>0</value2_is_reference>
          </a1:Condition>
          <a1:Condition Type="Condition">
            <attribute_name>home_postcode</attribute_name>
            <description1 />
            <description2 />
            <attribute_id>0</attribute_id>
            <not>0</not>
            <operator>0</operator>
            <value1 />
            <value2 xsi:nil="true" />
            <indent_level>1</indent_level>
            <value1_is_reference>0</value1_is_reference>
            <value2_is_reference>0</value2_is_reference>
          </a1:Condition>
        </a1:ConditionCollection>
        <a1:OrderByCollection Type="OrderByCollection" AscentCollection="true">
          <__vers>1</__vers>
          <IgnoreMissingItem>0</IgnoreMissingItem>
          <ReadOnly>0</ReadOnly>
          <AllowNulls>0</AllowNulls>
        </a1:OrderByCollection>
        <SelectedArticles xsi:nil="true" />
        <groupby_field_name />
        <reporting_currency>52</reporting_currency>
        <Negate_Filter>0</Negate_Filter>
        <Survey_Id>----</Survey_Id>
        <Survey_Name xsi:nil="true" />
        <Workflow_Id>----</Workflow_Id>
        <Workflow_Name xsi:nil="true" />
        <XPath>0</XPath>
        <locale>0</locale>
      </a1:QueryFilter>
    </NavigatorNode>
  </NavigatorNodes>
</Navigator>' AS XML) as xmldata 
```

并且一直在尝试查询以获取 a1:Condition 节点中包含的信息。我尝试过以下查询：

```
;WITH XMLNAMESPACES(
'http://www.ascenttechnology.co.uk/schemas/services' AS a1
,'http://www.ascenttechnology.co.uk/schemas/entities' AS a2
,DEFAULT 'http://www.w3.org/21/XMLSchema-instance'
)
SELECT 
#xmldata.*
,ref.value('attribute_name[1]','NVARCHAR(50)') as attribute_name
FROM #xmldata
CROSS APPLY xmldata.nodes('/Navigator/NavigatorNodes/NavigatorNode/a1:QueryFilter/a1:ConditionCollection/a1:Condition') T(ref) 
```

但是当我靠近命名空间节点时，它们总是空白 - 我能够从节点一直提取数据，`'/Navigator/NavigatorNodes/NavigatorNode'`但没有运气。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T15:37:02.380

您声明`DEFAULT 'http://www.w3.org/21/XMLSchema-instance'`但您的 XML 字符串甚至没有默认命名空间。

尝试

```
WITH XMLNAMESPACES(
  'http://www.ascenttechnology.co.uk/schemas/services' AS a1
, 'http://www.ascenttechnology.co.uk/schemas/entities' AS a2
) 
```

# powershell - PowerShell v2 Server 2003 - 找不到路径 - 路径肯定存在

> ID：10705233
> 
> 赞同：0
> 
> 时间：2012-05-22T15:33:19.103
> 
> 标签：powershell, error-handling, path, windows-server-2003, windows-server-2008-r2

通常我可以通过研究论坛和适应来找到 PowerShell 问题的答案。但是，在高低搜索之后，我找不到答案。

我以域管理员身份登录，在测试域中的两台企业服务器上工作。$Server2003 是运行 PS v2 的 Windows 2003 服务器。$Server2008 是 Windows 2008 R2。

问题：当我从 $Server2003 工作时，我无法使用任何命令访问或验证 $Server2008 上的信息。无论管理员是谁，都会发生此错误。

我在我们的环境中相当广泛地使用了 PowerShell，并且之前没有遇到过这个错误。在 $Server2003 上从 $Server2008 运行命令时，该错误不存在。此外，从生产域运行命令时不存在该错误。我也可以 ping 2003 或 2008 服务器，无论我登录的是哪台机器。

* * *

示例：
来自 $Server2008：ping $Server2003 - 返回 ping

从 $Server2003：ping $Server2008 - 返回 ping

从 $Server2003：`test-path \\$Server2008\D$\`-Get-ChildItem：找不到路径`'\\$Server2008\D$\'`，因为它不存在

从 $Server2008 开始：`test-path \\$Server2003\D$\`- 真

* * *

我要运行的命令比 test-path 复杂得多；但是，如果我不能让简单的命令起作用，我怀疑我会在复杂的命令中获得很多运气。

两台服务器具有相同的域，位于同一个林中，并且具有相同的域控制器。

任何想法从哪里开始？

编辑：想补充一点，我已经尝试使用从 Server2003 到位于我们的开发环境（相同域）中的不同 2008 服务器的测试路径，它成功运行了测试路径和命令。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T15:50:36.143

可以通过其他方式远程访问2008服务器吗？喜欢服务 MMC？另外，如果您在 2008 年创建一个共享而不是依赖于管理员共享，该怎么办？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T16:06:21.640

找不到路径错误意味着它不存在或您没有权限。它在dos提示下工作吗？

更新

我刚刚注意到您使用了单引号，变量不会扩展。把它用双引号括起来，然后再试一次

# garbage-collection - 从终结队列过渡到 FReachable 队列 .net 垃圾收集

> ID：10705236
> 
> 赞同：0
> 
> 时间：2012-05-22T15:33:27.757
> 
> 标签：garbage-collection

感谢 Jeffrey 的精彩， http: [//msdn.microsoft.com/en-us/magazine/bb985010.aspx](http://msdn.microsoft.com/en-us/magazine/bb985010.aspx)

“垃圾收集器扫描终结队列以寻找指向这些对象的指针。当找到指针时，该指针将从终结队列中删除并附加到可访问队列（发音为“F-reachable”）。”

从上面，对象 J、I、E 从 Finalization Queue 移动到 fReachable Queue。

我不清楚 Finalization Queue 到 fReachable Queue 的过渡。

Queue的FIFO逻辑呢？对象 E 的出队如何在不使 F 出队的情况下完成？

是终结队列还是终结列表？

请阐明一些光。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-01T02:21:26.643

尽管在短语“finalization queue”和“freachable queue”中有“queue”一词，但不应对这些集合中的对象的处理顺序做出任何假设。我认为“可定稿清单”一词更具描述性；我能想到将其称为“队列”的唯一原因是垃圾收集器在识别出大对象后，启动一个新的终结队列，然后访问其中的每个条目；然后每个条目被丢弃（如果终结器已被抑制），添加到新的终结队列（如果对象已被标记为保留），或添加到 freachable 队列（如果对象尚未被标记为保留）。

# java - TestNG 吞下异常

> ID：10705237
> 
> 赞同：1
> 
> 时间：2012-05-22T15:33:29.977
> 
> 标签：java, exception, testng

在下面的方法中，当我从 TestNG 运行它时得到一个 IOException （这是预期的），但我看到的只是 InitConnectionException 而不是原因。有谁知道这是为什么？

```
private void setupConnectionStreams(HttpsURLConnection connection) throws InitConnectionException {
    try {
        dataOutStream = new DataOutputStream(connection.getOutputStream());
        dataInStream = new DataInputStream(connection.getInputStream());
    } catch (IOException e) {
        throw new InitConnectionException(e.getCause());
    }
}

public class InitConnectionException extends Exception{
    private static final long serialVersionUID = 1L;

    public InitConnectionException(){
        super("There was a problem to setup a initialize a connection to the server.");
    }

    public InitConnectionException(String msg){
        super(msg);
    }

    public InitConnectionException(Throwable cause) {
        super(cause);
    }
}

se.ports.epp.poolservice.client.transport.pool.connection.exceptions.InitConnectionException
    at se.ports.epp.poolservice.client.transport.pool.connection.impl.HttpsConnection.setupConnectionStreams(HttpsConnection.java:134)
    at se.ports.epp.poolservice.client.transport.pool.connection.impl.HttpsConnection.connect(HttpsConnection.java:84)
    at se.ports.connectionTests.HttpsConnectionTest.testGetHttpsConnectionToRegistry(HttpsConnectionTest.java:30)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.testng.internal.MethodInvocationHelper.invokeMethod(MethodInvocationHelper.java:80)
    at org.testng.internal.Invoker.invokeMethod(Invoker.java:691)
    at org.testng.internal.Invoker.invokeTestMethod(Invoker.java:883)
    at org.testng.internal.Invoker.invokeTestMethods(Invoker.java:1208)
    at org.testng.internal.TestMethodWorker.invokeTestMethods(TestMethodWorker.java:127)
    at org.testng.internal.TestMethodWorker.run(TestMethodWorker.java:111)
    at org.testng.TestRunner.privateRun(TestRunner.java:758)
    at org.testng.TestRunner.run(TestRunner.java:613)
    at org.testng.SuiteRunner.runTest(SuiteRunner.java:334)
    at org.testng.SuiteRunner.runSequentially(SuiteRunner.java:329)
    at org.testng.SuiteRunner.privateRun(SuiteRunner.java:291)
    at org.testng.SuiteRunner.run(SuiteRunner.java:240)
    at org.testng.SuiteRunnerWorker.runSuite(SuiteRunnerWorker.java:53)
    at org.testng.SuiteRunnerWorker.run(SuiteRunnerWorker.java:87)
    at org.testng.TestNG.runSuitesSequentially(TestNG.java:1142)
    at org.testng.TestNG.runSuitesLocally(TestNG.java:1067)
    at org.testng.TestNG.run(TestNG.java:979)
    at org.testng.remote.RemoteTestNG.run(RemoteTestNG.java:109)
    at org.testng.remote.RemoteTestNG.initAndRun(RemoteTestNG.java:202)
    at org.testng.remote.RemoteTestNG.main(RemoteTestNG.java:173)
FAILED: testGetHttpsConnectionToRegistry(PL)
java.lang.IllegalStateException
    at se.ports.epp.poolservice.client.transport.pool.connection.impl.HttpsConnection.connect(HttpsConnection.java:87)
    at se.ports.connectionTests.HttpsConnectionTest.testGetHttpsConnectionToRegistry(HttpsConnectionTest.java:30)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.testng.internal.MethodInvocationHelper.invokeMethod(MethodInvocationHelper.java:80)
    at org.testng.internal.Invoker.invokeMethod(Invoker.java:691)
    at org.testng.internal.Invoker.invokeTestMethod(Invoker.java:883)
    at org.testng.internal.Invoker.invokeTestMethods(Invoker.java:1208)
    at org.testng.internal.TestMethodWorker.invokeTestMethods(TestMethodWorker.java:127)
    at org.testng.internal.TestMethodWorker.run(TestMethodWorker.java:111)
    at org.testng.TestRunner.privateRun(TestRunner.java:758)
    at org.testng.TestRunner.run(TestRunner.java:613)
    at org.testng.SuiteRunner.runTest(SuiteRunner.java:334)
    at org.testng.SuiteRunner.runSequentially(SuiteRunner.java:329)
    at org.testng.SuiteRunner.privateRun(SuiteRunner.java:291)
    at org.testng.SuiteRunner.run(SuiteRunner.java:240)
    at org.testng.SuiteRunnerWorker.runSuite(SuiteRunnerWorker.java:53)
    at org.testng.SuiteRunnerWorker.run(SuiteRunnerWorker.java:87)
    at org.testng.TestNG.runSuitesSequentially(TestNG.java:1142)
    at org.testng.TestNG.runSuitesLocally(TestNG.java:1067)
    at org.testng.TestNG.run(TestNG.java:979)
    at org.testng.remote.RemoteTestNG.run(RemoteTestNG.java:109)
    at org.testng.remote.RemoteTestNG.initAndRun(RemoteTestNG.java:202)
    at org.testng.remote.RemoteTestNG.main(RemoteTestNG.java:173) 
```

# java - HttpURLConnection.getInputStream() 块

> ID：10705240
> 
> 赞同：8
> 
> 时间：2012-05-22T15:33:37.700
> 
> 标签：java

我正在使用 HttpURLConnection 类发出 http 请求。我的代码看起来像这样 -

```
while(true){
    try{
         connection=(HttpURLConnection)url.openConnection();
         connection.setDoOutput(true);
         connection.setConnectTimeout(2*1000);
         InputStream in=connection.getInputStream();
    }
    catch(SocketTimeOutException e){}
    catch(IOException e){}
} 
```

检索 InputStream 对象后，我会对数据进行一些处理。我的问题是，如果我让程序运行足够长的时间，对 getInputStream 的调用就会阻塞，而我永远不会超过它。

我错过了什么吗？任何指针或帮助将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-22T15:44:12.493

设置连接的读取超时。此外，一旦你完成它们，在 finally 块中关闭流。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T15:42:34.483

您应该关闭未使用的连接。这是示例：

```
connection = (HttpURLConnection) url.openConnection();
connection.setRequestMethod("GET");
connection.setDoOutput(true);
connection.setReadTimeout(2*1000);
connection.connect();
reader = new BufferedReader(new InputStreamReader(connection.getInputStream()));
stringBuilder = new StringBuilder();
String line = null;
while ((line = reader.readLine()) != null)
{
 stringBuilder.append(line + "\n");
}
String result = stringBuilder.toString();
reader.close(); 
```

# session - 使用 Tomcat 领域时获取用户详细信息

> ID：10705246
> 
> 赞同：1
> 
> 时间：2012-05-22T15:33:55.377
> 
> 标签：session, tomcat

我正在使用 Tomcat 领域来确保安全，我的问题是登录后我不知道从哪里获取用户的信息。

我想使用已登录用户的角色，但我不知道登录后 Tomcat 在其会话中设置了什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T15:42:07.443

Tomcat 遵循 servlet 规范，并通过两种方式将用户信息提供给您的 webapp：

1.  使用 request.getUserPrincipal 获取代表用户的 java.security.Principal。您可以调用 Principal.getName 来获取用户名。
2.  使用 request.isUserInRole 检查用户是否具有特定角色。

请注意，您不能只获取“用户的角色”，因为用户可能有多个角色。标准 API 不包含获取所有用户角色的方法：您必须单独检查它们。

# c# - 在领域驱动设计中从多个来源更改跟踪实体

> ID：10705249
> 
> 赞同：2
> 
> 时间：2012-05-22T15:33:57.377
> 
> 标签：c#, domain-driven-design

我目前正在开发一个相当大的 Web 应用程序，并且正在使用域驱动设计。

我目前在跟踪对我的 Product 实体的更改时遇到了一些麻烦。问题是，产品部分由 SQL Azure 中的数据构建，部分由 Azure 表存储中的数据构建。如果某些属性发生了变化，我将需要同时坚持这两个，其他的只改变一个。

因此，我无法使用 NHibernate 或实体框架来跟踪更改。例如，Price 上的参数

```
 public void AddPrice(Price price) 
```

Product 实体上的方法必须持久化到 SQL Azure，才会对一系列价格进行计算，并将结果保存到 Azure 表存储。

你会如何解决这个问题？

想法：

1）我考虑过实现我自己的基于 Castle.DynamicProxy 的更改跟踪器，但这似乎相当乏味。

2) 在域实体内部实现事件。这不是一件好事。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T08:42:49.880

将一个实体分散在多个持久存储中可能不是一个好主意。更准确地说，这可能意味着它不是同一个实体，而是可以分成更小、设计更精确的部分。

> 将对一系列价格进行计算

您确定这些计算会影响 Product 实体并且应该由 Product 存储库中使用的相同 NHibernate/EF 会话处理吗？由于它们必须存储在其他地方，它们不是构成了通用语言中的第一类概念，从而产生了一个具有自己的持久性逻辑的单独实体吗？

请参阅[http://ayende.com/blog/153699/ask-ayende-repository-for-abstracting-multiple-data-sources](http://ayende.com/blog/153699/ask-ayende-repository-for-abstracting-multiple-data-sources)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T05:55:46.400

ORM 是做什么的？他们获取用于将对象恢复到当前状态的数据副本，就在他们向您提供对该对象的引用之前。当行为已应用于对象并且您要求将其持久化时，ORM 会将其数据副本与当前对象内部的数据进行比较，并相应地刷新更改。为什么不这样做呢？唯一的区别是并非所有检测到的更改都会刷新到同一个数据存储中。

HTH。

顺便说一句，这里有任何并发​​吗？

# android - 我单击 HOME 按钮，程序最小化；但是当我按下应用程序图标时，程序会启动两次

> ID：10705251
> 
> 赞同：0
> 
> 时间：2012-05-22T15:34:00.140
> 
> 标签：android, android-activity, launchmode

我有以下问题：

当我按下 Android HOME 键时，我可以看到“桌面”和我的应用程序图标。然后我按下我的应用程序图标，我的应用程序启动了两次。我不想打开我的应用程序两次。

我的程序是如何工作的：

我有 4 个活动（A、B、C、D）。

A - 主要活动：它是第一个打开的。它打开了另一个有很多按钮的活动。这就像 Java 的 main() 方法。我显示一个 SplashScreen 并调用另一个 Activity。然后我**完成**我的活动“A”。

B - 菜单屏幕：在这个活动中，我有一些按钮，比如菜单。我有一个配置按钮、更新按钮和登录按钮。当我单击登录按钮时，我完成了此活动并打开登录屏幕（活动“C”）。

C - 登录屏幕：用户输入登录名和密码。如果登录成功，我完成这个活动并打开活动“D”。

D - 应用程序主屏幕：它一直保持打开状态并启动另一个活动。当我想关闭我的应用程序时，我完成了这个。

PS：我尝试更改launchMode标志（androidManifest.xml），但没有奏效。

我的 AndroidManifest.xml 如下：

```
<application android:label="@string/app_name" android:icon="@drawable/icon" android:name="MyApplication">
    <activity android:name="A"
              android:label="@string/app_name"
              android:configChanges="orientation">
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />
            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
    <activity android:name="br.com.site.B" android:label="@string/app_name" />
    <activity android:name="br.com.site.C" android:label="@string/app_name" />
    <activity android:name="br.com.site.D" android:label="@string/app_name" />
</application> 
```

这是我的活动“A.java”来源：

```
public class A extends Activity {

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        finish();
        startActivity(new Intent(this, AtualizaDadosFrame.class));
    }
} 
```

**我不想打开我的应用程序两次。**

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T16:01:36.773

我将假设您最初（第一次）从 IDE（如 Eclipse 或 IntelliJ）启动应用程序。如果是这样，这是 Android 中的一个已知错误（请参阅[http://code.google.com/p/android/issues/detail?id=26658](http://code.google.com/p/android/issues/detail?id=26658)）。许多人已经为这个问题苦苦挣扎了好几天:-(

请不要更改启动模式。这不是解决此问题的正确方法。默认（标准）启动模式是在大多数情况下有效的模式。

**编辑（添加了解决方法的链接）：**

可以在[http://code.google.com/p/android/issues/detail?id=2373#c21找到针对此问题的简单解决方法](http://code.google.com/p/android/issues/detail?id=2373#c21)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T15:38:33.733

您应该[在](http://developer.android.com/guide/topics/manifest/activity-element.html#lmode)`AndroidManifest.xml`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-22T15:58:02.190

你可以限制这个.....请通过下面的链接。

[Home 按键行为](https://stackoverflow.com/questions/3042420/home-key-press-behaviour/4782423#478242)

# windows-phone-7 - WIndows Phone 7：图像在横向模式下不旋转

> ID：10705257
> 
> 赞同：1
> 
> 时间：2012-05-22T15:34:10.137
> 
> 标签：windows-phone-7, rotation, image-rotation, landscape-portrait

我正在覆盖`OnOrientationChanged`如下

```
 protected override void OnOrientationChanged(OrientationChangedEventArgs e)  
 {  
     Grid.SetRow(hyperlinkButton1, 0);
     Grid.SetRow(hyperlinkButton2, 1);
 } 
```

现在有了这个，我可以将网格垂直堆叠在纵向模式下。并以垂直模式水平堆叠。

但是里面的孩子是不旋转的。在横向模式下，它们看不到直立，而是与纵向模式对齐。

我如何旋转单个孩子[图像，网格等]以使它们在横向模式下也直立。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T15:46:18.577

如果您想在更改方向时仅旋转页面上的特定控件 - 这无法自动完成。您只能将 RotateTransform 放入 XAML 并绑定到它。当方向改变时，这个 RotateTransform 可以被代码修改。

另一方面，如果您正在谈论旋转整个页面，那么您需要将 SupportedOrientations=”PortraitOrLandscape” 添加到页面元素。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T16:10:41.490

在您的 xaml 页面上更改 SupportedOrientations=”PortraitOrLandscape”。

# javascript - ColdFusion 中的 Javascript 变量

> ID：10705258
> 
> 赞同：0
> 
> 时间：2012-05-22T15:34:10.917
> 
> 标签：javascript, jquery, coldfusion, coldfusion-9

我有一个 JS 函数，它根据用户从下拉列表中选择的内容创建一个变量。我需要在我的 CF 代码上使用该 JS 变量，以便能够在提交表单以外的操作中使用它。

这是我的 JS 函数

```
function handleProcedureChange(procedureid,recID)
    {
        procedureid= document.form1.procedure.value;
        recID = document.form1.recID.value;
        state = document.form1.state.value;
        state = state.trim();
        city = document.form1.city.value;
        city = city.trim();

        var url ="../../../../cf_modules/components/customDescriptions.cfc?method=procedureDescription&"; 
        url=url+"ProcedureID="+procedureid+"&recID=" + recID + "&state=" + state + "&city="+city;

        $.get(url, function(procedureResult) {
             procedureResult = procedureResult.replace(/^"+|"+$/g, "");
            $("#procedureDescription").text(procedureResult);
        });

    } 
```

这是我的表格

```
 <select name="procedure" onChange="handleProcedureChange();">
            <option value="">Select Procedure</option>
            <cfloop query="procedures">
                <option value="#procedureId#">#procedureName#</option> 
            </cfloop>
        </select>   

 <textarea name="procedureDescription" id="procedureDescription" cols="80" rows="6"></textarea><br /> 
```

我需要在此链接上使用**url2**变量来控制几个服务器端功能

这些是链接序列

```
<cfoutput>[<a href="cityEdit.cfm?recID=#recID#&delete1=#recID#&state=#state#&city=#city.getCity()#&procedureid=#procedure#">delete</a>]</cfoutput>

<cfif delete1 neq "">
    Are you sure?
<cfoutput> [ <a href="cityEdit.cfm?recID=#recID#&delete1=#delete1#&delete2=#delete1#&procedureid=#procedure#&state=#state#&city=#city.getCity()#">Yes</a>&nbsp;|&nbsp;<a href="cityEdit.cfm?recID=#recID#">No</a>]</cfoutput>
</cfif> 
```

这些是上述链接控制的功能：

```
<cfparam name="delete1" default="">
<cfparam name="delete2" default="">

<cfif delete1 neq "">
            <cfquery name="procFinder" datasource="#ds#">
                select * from psp_customDescriptions where recID = '#delete1#'
                and procedureID = '#procedure#' and city = '#city#' and state='#state#'
            </cfquery>

        </cfif>

        <cfif delete2 neq "">
            <cfquery name="deletepractice" datasource="#ds#">
                delete from psp_customDescriptions where recID = '#delete2#'
                 and procedureID = '#procedure#' and city = '#city#' and state='#state#'
            </cfquery>

            <cflocation url="cityEdit.cfm?recID=#recID#" addtoken="no">
        </cfif> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-22T16:02:45.707

单击链接时如何移动逻辑以运行？您还可以考虑使用 jQuery 之类的东西来获取值并设置事件处理程序。如前所述，您应该考虑使用帖子来修改/删除数据。

```
<script>
function handleDeleteLink()
{
    procedureid= document.form1.procedure.value;
    recID = document.form1.recID.value;
    state = document.form1.state.value;
    state = state.trim();
    city = document.form1.city.value;
    city = city.trim();

var url2 ="ProcedureID="+procedureid+"&recID=" + recID + "&state=" + state + "&city="+city;

    document.deleteLink.href="cityEdit.cfm?"+url2;
    }
</script>    

<a id="deleteLink" href="#" onclick="">Delete</a> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T15:59:07.930

我不确定你的问题。表面上看起来很明显。如果有人点击上面的链接.. 上面写着：

```
cityEdit.cfm?recid=123&delete1=123&procedureid=345.... 
```

变量将在“URL”范围内传递给 ColdFusion。所以你将拥有：

```
<Cfoutput>
#url.recid#
#url.delete1#
#url.procedureID#
</cfoutput> 
```

这是否回答你的问题？

* * *

如果您的问题是关于 JS 方面的，那么您需要一个函数作为链接的结果。而不是“cityedit.cfm”作为您的链接，您将添加一个侦听器或单击处理程序，以便当用户单击删除时它会触发您的 JS 函数。然后在 JS 函数中，您将创建您的 URL 并对“cityEdit.cfm？”执行 document.href.location。+网址2；

这是你的意思吗？

仅供参考-形式上您应该进行 POST 以更新数据库中的数据-尤其是“删除”。它更加安全（并且符合 W3C）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-22T19:34:06.353

毕竟我唯一需要做的就是将这一行代码添加到我的 JS 函数中

```
$("#deleteProc1").html('<a href="cityEdit.cfm?recID='+recID+'&delete1='+recID+'&delete2='+recID+'&state='+state+'&city='+city+'&procedureid='+procedureid+"\">Delete</a>"); 
```

此链接可帮助我访问我的 CF 功能并删除我从下拉列表中选择的程序。

感谢所有对我的问题发表评论的人

# mysql - MySQL查询识别坏字符？

> ID：10705259
> 
> 赞同：0
> 
> 时间：2012-05-22T15:34:18.043
> 
> 标签：mysql

我们有一些使用拉丁字符集而不是 UTF-8 设置的表格，它允许在表格中输入错误字符，通常的罪魁祸首是人们从 Word 或 Outlook 复制/粘贴复制了那些讨厌的隐藏字符......

我们可以使用任何查询来识别这些字符以清除它们吗？

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T15:56:22.417

你可能会注意到类似这个['bug' 的](http://bugs.mysql.com/bug.php?id=28263)东西。“坏字符”很可能是 UTF-8 控制字符（例如 \x80）。您也许可以使用类似的查询来识别它们

```
SELECT bar FROM foo WHERE bar LIKE LOCATE(UNHEX(80), bar)!=0 
```

从那个链接的错误中，他们建议使用 type`BLOB`来存储 windows 文件中的文本：

> 如果您需要存储 windows 文件（甚至是文本文件），请使用 BLOB（带有附加编码字段）而不是 TEXT。优于 3 字节 UTF-8 和多层编码开销。

看看[这个 Q/A](https://dba.stackexchange.com/questions/10467/how-to-convert-control-characters-in-mysql-from-latin1-to-utf-8)（这都是关于你的客户端编码的`SET NAMES`）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T15:48:45.137

我假设您`UTF8`在填写数据时设置了连接字符集。

`MySQL``?`用（问号）替换不可转换的字符：

```
SELECT  CONVERT('тест' USING latin1);

----
???? 
```

问题在于区分合法的问号和非法的问号。

通常，单词开头的问号是不祥之兆，因此：

```
SELECT  *
FROM    mytable
WHERE   myfield RLIKE '\\?[[:alnum:]]' 
```

应该给一个好的开始。

# php - 加载数据输入mysql PHP？

> ID：10705262
> 
> 赞同：2
> 
> 时间：2012-05-22T15:34:33.800
> 
> 标签：php, mysql, load-data-infile

有什么我想念的`LOCAL DATA INFILE`吗？

我的sql代码，

```
LOAD DATA 
IGNORE INFILE 
'./infile.txt' 
INTO TABLE table 
FIELDS TERMINATED BY '\t'
LINES STARTING BY '\n' 
```

与`infile.txt`此脚本位于同一目录中，我无法使用`LOCAL`我的服务器不会让我使用，为什么它不起作用？有没有办法检查我是否启用了它？

我可以`LOCAL`从 phpMyAdmin 内部运行，代码可以工作，但只插入 46 行约 500,000 行！

谢谢 ：）

# android - 我的应用程序中的 SearchView 似乎不起作用

> ID：10705264
> 
> 赞同：2
> 
> 时间：2012-05-22T15:34:36.127
> 
> 标签：android, searchview

我已经实现了以下代码，但我的 SearchActivity::OnCreate 没有被调用。有人可以告诉我我错过了什么吗？

**AndroidManifest.xml：**

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.kace.SearchTest"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk android:minSdkVersion="14" />

    <application
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name" >
        <meta-data android:name="android.app.default_searchable" android:value=".SearchActivity"/>
        <activity
            android:name=".Search_testActivity"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />
                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
        <activity android:name=".SearchActivity" android:launchMode="singleTop">
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />
                <category android:name="android.intent.category.SAMPLE_CODE" />
            </intent-filter>
            <intent-filter>
                <action android:name="android.intent.action.SEARCH"/>
            </intent-filter>
            <meta-data android:name="android.app.searchable" android:resource="@xml/searchable"/>
        </activity>
    </application>

</manifest> 
```

**/res/xml/searchable.xml：**

```
<?xml version="1.0" encoding="utf-8"?>
<searchable xmlns:android="http://schemas.android.com/apk/res/android"
    android:label="@string/app_name"
    android:hint="@string/description" >
</searchable> 
```

**SearchActivity.java：**

```
public class SearchActivity extends Activity
{
    @Override
    public void onCreate(Bundle savedInstanceState)
    {
        // TODO Auto-generated method stub
        super.onCreate(savedInstanceState);

        Intent intent = getIntent();
        if (Intent.ACTION_SEARCH.equals(intent.getAction()))
        {
            String query = intent.getStringExtra(SearchManager.QUERY);
            int q;
            q = 10;
        }
    }

    @Override
    protected void onNewIntent(Intent intent)
    {
        // TODO Auto-generated method stub
        super.onNewIntent(intent);
    }

} 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2014-08-26T06:51:52.320

Android 指南明确表示：

```
// Assumes current activity is the searchable activity
searchView.setSearchableInfo(searchManager.getSearchableInfo(getComponentName())); 
```

在你的情况下这是不正确的。因为您不想在 MainActivity 中搜索，而是在 SearchableActivity 中搜索。这意味着您应该使用此 ComponentName 而不是 getComponentName() 方法：

```
ComponentName cn = new ComponentName(this, SearchableActivity.class);
searchView.setSearchableInfo(searchManager.getSearchableInfo(cn)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T16:15:36.963

试试这个 ：

将您的**AndroidManifest.xml**更新为：

```
 <activity
        android:name=".Search_testActivity"
        android:label="@string/app_name" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />
            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
                <meta-data android:name="android.app.default_searchable" android:value=".SearchActivity"/>
    </activity>
    <activity android:name=".SearchActivity" android:launchMode="singleTop">
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />
            <category android:name="android.intent.category.SAMPLE_CODE" />
        </intent-filter>
        <intent-filter>
            <action android:name="android.intent.action.SEARCH" />
            <category android:name="android.intent.category.DEFAULT" />
        </intent-filter>
        <meta-data android:name="android.app.searchable"
                   android:resource="@layout/searchable" />
    </activity>
</application> 
```

将可搜索布局放在 layout/ 而不是 /res/xml/ 中： **layout/searchable.xml**：

```
<?xml version="1.0" encoding="utf-8"?>
<searchable xmlns:android="http://schemas.android.com/apk/res/android"
    android:label="@string/app_name"
    android:hint="@string/description" 
    android:searchMode="showSearchLabelAsBadge"
    android:voiceSearchMode="showVoiceSearchButton|launchRecognizer"
    android:voiceLanguageModel="free_form"
    android:voicePromptText="@string/search_invoke"
    android:searchSuggestSelection=" ? "
/> 
```

[有关更多工作示例，请参阅我在这篇文章](https://stackoverflow.com/questions/9700391/android-pass-bundle-with-search/9752578#9752578)中的回答

和

[您可以从SearchWidgetExample](https://hotfile.com/dl/156536457/0acb659/SearchWidgetExample.rar.html)下载工作示例

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-23T12:20:58.027

找到了答案！在我的主要活动（不是搜索活动）的 onCreate 方法中，我添加了以下几行：

```
SearchManager searchManager = (SearchManager)getSystemService(Context.SEARCH_SERVICE);
SearchableInfo searchableInfo = searchManager.getSearchableInfo(getComponentName());

SearchView sv = (SearchView)findViewById(R.id.searchView1);
sv.setSearchableInfo(searchableInfo); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-07-03T21:58:33.513

尝试`default_searchable`在“源”活动下添加设置：

```
<meta-data
  android:name="android.app.default_searchable"
  android:value=".SearchActivity" /> 
```

简而言之，您需要`default_searchable`设置“源”活动并`searchable`设置“搜索结果”活动（您的 SearchActivity 类）。

# performance - 为eigs做matlab缓存解决方案吗

> ID：10705266
> 
> 赞同：1
> 
> 时间：2012-05-22T15:34:41.557
> 
> 标签：performance, matlab, caching, eigenvector

使用`eigs`. 在同一个矩阵上，调用
`[c, v] = eigs(A, 2, 'sm');` somtimes 需要 30 秒，有时需要 2 秒。
我需要知道`eigs`在同一矩阵上的后续调用中使用一些缓存是否有加速，因为我需要报告时间......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T16:56:40.360

如果是这样，这似乎不是通用功能。我从命令行运行了这个测试

```
A = randn(10000); 
B = randn(10000); 
C = B; 
tic; [c1,v1] = eigs(A,2,'sm'); toc; 
tic; [c2,v2] = eigs(A,2,'sm'); toc; 
tic; [c3,v3] = eigs(B,2,'sm'); toc; 
tic; [c4,v4] = eigs(C,2,'sm'); toc 
```

得到了这个结果

> 经过的时间是 32.373128 秒。
> 
> 经过的时间是 28.412905 秒。
> 
> 经过的时间是 32.752616 秒。
> 
> 经过的时间是 29.024055 秒。

我很惊讶，因为通常 MATLAB 会试图比你聪明，并且会存储结果以供重复使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T18:01:50.397

在某些情况下，足够大的矩阵可能会将事物推入虚拟内存，也可能不会，这取决于是否有足够大的连续 RAM 块可用。或者，您可能正在做一些事情。

您可以在进行测试时通过观察过程监视器来验证正在发生的事情。是否突然有大量磁盘访问？如果是这样，那么虚拟内存正在被触及。是否有一个不同的、不相关的进程正在占用 CPU？

# c++ - 为什么不能将 volatile FILE* 分配给 FILE*？

> ID：10705267
> 
> 赞同：0
> 
> 时间：2012-05-22T15:34:42.900
> 
> 标签：c++

我有一个 Visual C++ 程序，它在一个线程中使用`FILE* fp = fopen(...)`. 我希望该线程在另一个线程读取文件时阻塞事件对象，然后在完成时向阻塞的线程发出信号，然后关闭文件。因为`fp`在线程之间共享，所以我将其声明为`volatile FILE* fp`. 但是，`fread()`不会接受 volatile 作为其`FILE*`论点。`FILE* fpLocal = fp;`我尝试在将调用的线程中使用本地指针，`fread()`但这让我得到了这个：

```
 Error: a value of type "volatile FILE*" cannot be assigned to an entity of type "FILE*" 
```

自然地，这让我担心，也许我试图在一个线程中打开一个文件并在另一个线程中读取它开始时犯了一个错误，尽管我不明白为什么（还）。

有人可以帮我弄这个吗？为什么我不能将 a 分配`volatile FILE*`给 a `FILE*`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T15:38:38.783

**为什么我不能将 a 分配`volatile FILE*`给 a `FILE*`？**

因为 C++ 具有严格的类型检查，并且您不能分配彼此不匹配的类型。
如果是这种情况，则需要使用强制转换运算符，但重要的是要注意，错误地使用它们也可能导致未定义的行为。
此行为与`const`限定符相同。

作为评论中已经提到的旁注，`volatile`这不是去这里的方式。

# java - 为什么 Apache 基金会要发布两个构建工具（Ant 和 Maven）？

> ID：10705268
> 
> 赞同：2
> 
> 时间：2012-05-22T15:34:42.940
> 
> 标签：java, apache, maven, ant, build

我有使用 Ant 的经验，但没有使用 Maven。
我的问题是：为什么 Apache 基金会要发布两个构建工具（Ant 和 Maven）？

1.  **为什么同一个Ant工具不能升级到Maven？**

2.  **使用 Maven 而不是 Ant 有什么好处，反之亦然？**
3.  **当 Ant 作为构建工具时，构建 Maven 的原因是什么？**

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-22T15:38:50.133

Apache 并不是真正的“供应商”，它是托管和支持（在许多情况下）其他人/团体捐赠给他们的开源项目的基础。

Ant 的第一个版本是在 2000 年，所以它是一个相当古老的工具。Maven 试图以不同的方式处理构建项目。退役 Ant 没有任何意义，因为它仍然具有很大的价值。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-22T15:54:21.937

仅仅因为某些东西正在工作并不意味着它不能被改进。ANT 本身是作为 MAKE 的纯 Java 替代品而构建的。有关 ANT 背后的理念，请参阅[什么是](http://ant.apache.org/faq.html#what-is-ant)ANT。另请查看Maven 团队的 maven 是什么，了解 maven 的目标是什么[。](http://maven.apache.org/what-is-maven.html)

就我个人而言，我从 maven 的依赖管理功能中汲取了很多价值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-22T16:04:35.627

最好的构建工具是您自己编写的。每个项目的构建过程都是独一无二的，通常需要以多种不同的方式构建单个项目。
如果您不想编写自己的构建工具，那么您应该使用： Ant 或 Maven
Ant 是构建工具；Maven 是一个构建系统：

这意味着使用 Maven，您无需决定目录布局、构建目标、版本控制方案、依赖项管理等。这一切都是为您设计的。这也意味着如果您不喜欢默认设置，您将在某种程度上反对该工具。

好处是您想要构建到构建系统中的大多数常用工具（CheckStyle、FindBugs、单元测试、单元覆盖、JDepened...）都可以使用，而无需任何额外的开发工作。此外，还有一个定义明确的框架，用于通过构建插件来扩展构建系统（顺便说一句 - 使用 Ant 构建插件非常容易）。此外，与 IDE 的集成很好，因此开发人员可以使用与自动构建系统相同的构建信息。

权衡的是，除非您从头开始，否则您可能需要重构您的源代码以符合 Maven 的期望。不必从头开始构建所有东西的代价是您有时会花时间弄清楚如何哄 Maven 做您想做的事情，您希望它如何完成。

# jquery-templates - 大型企业应用程序的客户端与服务器端模板

> ID：10705270
> 
> 赞同：0
> 
> 时间：2012-05-22T15:34:44.503
> 
> 标签：jquery-templates, templating, client-side-templating

对于涉及多个 jsps 和许多事务的大型企业应用程序（如商业银行应用程序或具有大量数据的医疗保健应用程序），什么对模板最有意义？这只是个人选择的问题，还是有充分的理由倾向于服务器端模板？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T17:17:19.753

客户端模板更多的是 UI 问题，不应以任何方式与后端事务混淆。当您的站点执行某些操作时，它仍在执行由服务器逻辑处理的 HTTP POST。我认为开发更像是一个自然的连续体，可以构建由现代浏览器和 Javascript 引擎支持的更易于使用的 Web。

您可能会在此处找到更多信息：

[https://github.com/leonidas/transparency/wiki/Frequently-Asked-Questions](https://github.com/leonidas/transparency/wiki/Frequently-Asked-Questions)

# list - 通过 Sharepoint 中的代码更改列表视图查找阈值

> ID：10705280
> 
> 赞同：3
> 
> 时间：2012-05-22T15:35:27.217
> 
> 标签：list, sharepoint, sharepoint-2010, lookup

我在 Sharepoint 中的默认“页面”-列表视图有很多列，因此不会显示。显示以下错误：

> 此视图无法显示，因为它包含的查找和工作流状态列的数量超过了管理员强制执行的阈值 (8)。

我**知道**如何使用中央管理解决此问题（如此处所述：[如何在 SharePoint2010 中启用视图，其中可能存在超过 8 个查找列？](https://stackoverflow.com/questions/2736418/how-to-enable-a-view-in-sharepoint2010-where-there-can-be-more-than-8-lookup-col)）

但我想通过使用 C#-Code 激活功能来自动更改该设置。这可以通过代码完成吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T17:15:29.273

SPWebApplication.MaxQueryLookupFields[属性](http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.administration.spwebapplication.maxquerylookupfields)确定列表项查询中可能包含的查找字段的最大数量[**。**](http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.administration.spwebapplication.maxquerylookupfields)

# javascript - 是否存在需要重定向网址的技术限制？

> ID：10705281
> 
> 赞同：2
> 
> 时间：2012-05-22T15:35:30.750
> 
> 标签：javascript, html, url, redirect, tracking

当您单击其网站上的链接时，许多服务会将您的浏览器发送到另一个 URL。Facebook 上的谷歌搜索结果和链接就是两个众所周知的例子。连接越慢，越明显，在移动网络上浏览时，您可能会看到几秒钟的空白页面。在此期间，您可以在地址栏中看到查询字符串，其中显示了一些正在记录的内容。

我理解重定向的原因是可以分析用户行为，从服务质量到目标营销的任何原因，这很好。但是为什么我们必须被发送到不同的页面呢？从用户的角度来看，这不是最理想的吗？

它不能由javascript调用处理吗？如果不是为什么不呢？

* * *

编辑：通过使用javascript，我的意思是：

1.  绑定函数到链接
2.  单击时，让函数延迟重定向，直到使用 ajax 发送跟踪查询
3.  继续翻页

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-22T15:38:46.020

> 从用户的角度来看，这不是最理想的吗？

显然，详细的用户资料比快乐的用户更有价值。

> 它不能由javascript调用处理吗？如果不是为什么不呢？

浏览器会在使用 JavaScript 发送请求之前离开页面，并且数据会丢失。

# vb.net - VB 2010 + HTMLAgilityPack + 大型处理 = 错误？

> ID：10705282
> 
> 赞同：0
> 
> 时间：2012-05-22T15:35:34.820
> 
> 标签：vb.net, multithreading, html-agility-pack

我花了太多时间试图解决这个小问题。我已将问题缩小到引发错误的确切过程。是的，我用过谷歌。在一些聪明人回复“搜索谷歌”之前把它扔掉！

无论如何，这里：

* * *

```
Try
    Dim tempSource as String = Nothing
    Console.WriteLine("Loading document...")

    Dim FILE_NAME As String = "C:\pathto\file.txt"
    If System.IO.File.Exists(FILE_NAME) = True Then
        Dim objReader As New System.IO.StreamReader(FILE_NAME)
        tempSource = objReader.ReadToEnd
        objReader.Close()
        Console.WriteLine("Loaded the document!")
    Else
        Console.WriteLine("Error loading document!")
        MsgBox("Error loading document!")
        Exit Sub
    End If

    Dim doc As HtmlDocument = Nothing
    If tempSource IsNot Nothing Then
        Console.WriteLine("Temp Source was not nothing, so loading HAP doc")
        doc.Load(tempSource)  '<--- This is where the error is!!!!!
        Console.WriteLine("HAP doc loaded!")
    Else
        Console.WriteLine("Error: Unable to load source file into parser!")
        MsgBox("Error: Unable to load source file into parser!")
        Exit Sub
    End If
    Console.WriteLine("Document loaded!")
    Console.WriteLine("Processing...")

    For Each node As HtmlNode In doc.DocumentNode.Elements("//site")
        'my code to process each element here
        'not important because my app doesnt get this far lol
    Next

Catch ex as Exception
    Console.Writeline("Caught Exception: {0}", ex.Message)
End Try 
```

* * *

我正在加载一个包含大约 1100 行的文本文件，并且每一行都将使用 HTML Agility Pack 进行处理。据我所知，当它运行“doc.loadhtml(richtextbox1)”时，它会抛出错误。我还尝试将文件加载到字符串中，并使用“doc.loadhtml(thestring)”加载字符串。它没有任何区别，仍然是错误。

以下是每行外观的示例：

* * *

```
<Site Index="" Name="" Group="" PR="" />
<Site Index="" Name="" Group="" PR="" />
<Site Index="" Name="" Group="" PR="" />
<Site Index="" Name="" Group="" PR="" />
<Site Index="" Name="" Group="" PR="" />
<Site Index="" Name="" Group="" PR="" /> 
```

* * *

我正在使用 HTML Agility Pack，但是上面是每一行的内容，大约 1100 行！为了测试，在加载 1100 行文件之前，我有一个由大约 50 行组成的较小文本文件；）没有任何 HTML、HEAD 或 BODY 标记！我的解析不需要它们。我正在使用 HTML Agility Pack，因为它很容易解析元素。我可以轻松地从每一行中获取每个值。

我不确定这个错误是否是因为它在技术上不是 HTML？意思是因为加载的代码没有 HTML 或 BODY 标签，它会出错吗？我想发布这个问题，在等待一些答案的同时，我将以另一种方式解析文档。只是好奇这笔交易是什么以及为什么 HTML Agility Pack 不起作用。对于我自己的学习和知识，更多的是概念证明。

这是我得到的错误（顺便说一句，在 doc.load() 行，是它引发异常的地方）：

* * *

```
Object reference not set to an instance of an object 
```

* * *

最后一点：例程在后台线程上。我以前使用过多线程，并为更深入的代码创建了委托。也许我只是忽略了一些东西，昨晚我确实在凌晨 3 点写了大部分代码，哈哈。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T15:50:52.410

看起来你没有初始化文档......

```
Dim doc As HtmlDocument = Nothing 
```

我不编写 VB，主要是 C#、Java 和 C++，但`doc = Nothing`似乎`doc = null`当您`load(...)`在空对象上调用该方法时，我希望看到“对象引用未设置为对象的实例”异常。

尝试将文档初始化为实际`HtmlDocument`：

```
Dim doc As New HtmlDocument 
```

# javascript - 绑定数据在 d3.js 中不起作用

> ID：10705284
> 
> 赞同：4
> 
> 时间：2012-05-22T15:35:38.280
> 
> 标签：javascript, d3.js

我正在尝试使用 .enter 方法生成 html。

我有以下代码：

```
alert(d3.select(".ul_class").length);
d3.select(".ul_class").data([4, 8, 15]).enter().append("li").text("hello"); 
```

第一个警报显示“1”，因此正确选择了对象。第二行没有在我的 DOM 对象中附加“li”元素。

我究竟做错了什么？谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-22T15:39:35.953

您必须首先创建一个（空的）`li`元素选择：

```
d3.select(".ul_class")
  .selectAll('li') // <--
  .data([4, 8, 15]).enter().append("li").text("hello"); 
```

然后将数据绑定到该空选择，这将在选择中为新数据生成占位符。

所以你基本上是在说：

*“选择所有`li`元素并将数据绑定`[4, 8, 15]`到它们。对于尚未绑定的所有数据项，创建一个新`li`元素。”*

[**演示**](http://jsfiddle.net/a8QgP/)

# silverlight - Silverlight 中的多个子窗口中的子窗口始终位于顶部

> ID：10705286
> 
> 赞同：0
> 
> 时间：2012-05-22T15:35:39.357
> 
> 标签：silverlight, childwindow

我有几个子窗口，我希望这些子窗口之一始终位于所有其他打开的子窗口之上。我希望当我关闭或打开其他子窗口时，此子窗口始终位于所有当前子窗口的顶部。子窗口没有 z-index 属性？

请帮助我，谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T07:33:22.610

我对子窗口没有很多工作经验，但有一些想法......）。如果子窗口是 FrameworkElement 继承树的一部分，那么您可以尝试调用“Focus”方法将其显示在顶部。

# mysql - 在计算字段上重用别名

> ID：10705287
> 
> 赞同：3
> 
> 时间：2012-05-22T15:35:39.840
> 
> 标签：mysql, subquery

下午好，想知道在我有点挣扎的时候是否有人能指出我正确的方向。我有一个 mysql 查询，我需要在计算字段中包含一个别名，如下所示：

```
 Select tblComms._CommMonth, 
        tblComms._Reference, 
        tblComms._ClientName, 
        tblComms._Premium, 
        tblComms._CommDue, 
        tblComms._Employee_Name, 
        tblCont.Retention, 
        (tblComms._CommDue) * (tblCont.Retention) / 100 As Paid, 
        (tblComms._CommDue) - (Paid) As Payable 
 From tblComms Inner Join dbo_companyref On 
      dbo_companyref._Reference = tblComms._Reference 
      Inner Join tblCont 
      On dbo_companyref._Advisor_Name = tblCont._Employee_Name 
```

这会返回一个错误“字段列表中的未知列'付费'”，有什么方法可以在创建付费别名后使用它？我正在尝试推出一个在 Access & SQL 中创建的新系统，他们只是为此使用保存的查询/SP。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T08:17:53.987

这不被允许。当别名与其他列处于同一级别时，不能将该列用作别名`SELECT`。

如果它是这样的，你可以使用别名 -

```
SELECT alias
FROM (SELECT column1 AS alias
      FROM table); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-10-29T12:09:00.563

您可以在 mysql 中为这些东西使用变量：

```
Select tblComms._CommMonth, 
    tblComms._Reference, 
    tblComms._ClientName, 
    tblComms._Premium, 
    tblComms._CommDue, 
    tblComms._Employee_Name, 
    tblCont.Retention, 
    @Paid := (tblComms._CommDue) * (tblCont.Retention) / 100 As Paid, 
    (tblComms._CommDue) - (@Paid) As Payable From tblComms Inner Join dbo_companyref On 
  dbo_companyref._Reference = tblComms._Reference 
  Inner Join tblCont 
  On dbo_companyref._Advisor_Name = tblCont._Employee_Name 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2016-10-26T01:31:37.163

采用`(select Paid)`

```
 Select tblComms._CommMonth, 
    tblComms._Reference, 
    tblComms._ClientName, 
    tblComms._Premium, 
    tblComms._CommDue, 
    tblComms._Employee_Name, 
    tblCont.Retention, 
    (tblComms._CommDue) * (tblCont.Retention) / 100 As Paid, 
    (tblComms._CommDue) - (select Paid) As Payable 
  From tblComms Inner Join dbo_companyref On 
  dbo_companyref._Reference = tblComms._Reference 
  Inner Join tblCont 
  On dbo_companyref._Advisor_Name = tblCont._Employee_Name 
```

# r - 根据另一列中的最大值选择一个值

> ID：10705290
> 
> 赞同：8
> 
> 时间：2012-05-22T15:35:59.633
> 
> 标签：r, reshape2

我不明白为什么我找不到解决方案，因为我觉得这是一个非常基本的问题。那就需要求助了。我想按月重新排列空气质量数据集，每个月的最大温度值。另外我想找到每个月最高气温对应的日子。这样做的最懒惰（代码方面）的方法是什么？

我试过以下但没有成功：

```
require(reshape2)
names(airquality) <- tolower(names(airquality))
mm <- melt(airquality, id.vars = c("month", "day"), meas = c("temp"))

dcast(mm, month + day ~ variable, max)
aggregate(formula = temp ~ month + day, data = airquality, FUN = max) 
```

我追求的是这样的：

```
month day temp
5     7    89
... 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-22T15:56:10.593

前段时间关于懒惰是好是坏的讨论颇多。Anwyay，这很短，很自然地写和读（并且对于大数据来说很快，所以你以后不需要更改或优化它）：

```
require(data.table)
DT=as.data.table(airquality)

DT[,.SD[which.max(Temp)],by=Month]

     Month Ozone Solar.R Wind Temp Day
[1,]     5    45     252 14.9   81  29
[2,]     6    NA     259 10.9   93  11
[3,]     7    97     267  6.3   92   8
[4,]     8    76     203  9.7   97  28
[5,]     9    73     183  2.8   93   3 
```

`.SD`是每个组的数据子集，您只需要其中具有最大 Temp 的行，iiuc。如果您需要行号，则可以添加。

或者获取最大值绑定的所有行：

```
DT[,.SD[Temp==max(Temp)],by=Month]

     Month Ozone Solar.R Wind Temp Day
[1,]     5    45     252 14.9   81  29
[2,]     6    NA     259 10.9   93  11
[3,]     7    97     267  6.3   92   8
[4,]     7    97     272  5.7   92   9
[5,]     8    76     203  9.7   97  28
[6,]     9    73     183  2.8   93   3
[7,]     9    91     189  4.6   93   4 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-23T02:03:04.467

plyr 的另一种方法

```
require(reshape2)
names(airquality) <- tolower(names(airquality))
mm <- melt(airquality, id.vars = c("month", "day"), meas = c("temp"), value.name = 'temp')

library(plyr)

ddply(mm, .(month), subset, subset = temp == max(temp), select = -variable) 
```

给

```
 month day temp
1     5  29   81
2     6  11   93
3     7   8   92
4     7   9   92
5     8  28   97
6     9   3   93
7     9   4   93 
```

或者，更简单

```
require(reshape2)
require(plyr)
names(airquality) <- tolower(names(airquality))
ddply(airquality, .(month), subset, 
  subset = temp == max(temp), select = c(month, day, temp) ) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-22T15:44:13.507

怎么样`plyr`？

```
max.func <- function(df) {
   max.temp <- max(df$temp)

   return(data.frame(day = df$Day[df$Temp==max.temp],
                     temp = max.temp))
}

ddply(airquality, .(Month), max.func) 
```

如您所见，该月的最高温度发生在一天以上。如果您想要不同的行为，该功能很容易调整。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-22T15:55:56.103

或者如果你想使用这个`data.table`包（例如，如果速度是一个问题并且数据集很大或者你更喜欢语法）：

```
library(data.table)
DT <- data.table(airquality)
DT[, list(maxTemp=max(Temp), dayMaxTemp=.SD[max(Temp)==Temp, Day]), by="Month"] 
```

如果您想知道`.SD`代表什么，请看这里：[SO](https://stackoverflow.com/questions/8508482/what-does-sd-stand-for-in-data-table-in-r)

# java - 铸造和实例或几乎是空的接口？

> ID：10705291
> 
> 赞同：1
> 
> 时间：2012-05-22T15:36:02.573
> 
> 标签：java, interface, instanceof

我正在编写某种包含机器人、物品等的棋盘游戏。

有一次，我需要获取机器人或可以具有能量的物品的能量值。编程方式是每个机器人和每个具有能量的物品都有一个 EnergyContainer 类作为字段（以防止代码冗余）和一个能量值类。

现在，基本上，我调用一个接收元素的方法评估（）。元素是机器人和物品扩展的抽象类。并非所有元素都有能量容器。如果可能的话，我需要在这个元素上调用 getEnergyContainer，但前提是它当然是一个拥有它的元素。

我可以想到几个解决方案：使用大量 instanceOf 然后进行强制转换。例如，如果元素是 instanceof 机器人，则将元素转换为机器人并在元素上调用 getEnergyContainer。这有一个明显的缺点，我需要对每个具有元素子类的能量执行此操作。

第二种解决方案是定义一个仅包含 getEnergyContainer 方法的接口，并使所有具有类的能量都实现此方法。这个接口的唯一目的是促进一种方法，它几乎是空的。

除非有人有更好的主意，否则“最佳”解决方案是什么？我认为几乎空的接口被用作标记接口，但这是唯一的目的，所以我有点反对它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T15:40:09.077

> 如果可能的话，我需要在这个元素上调用 getEnergyContainer，但前提是它当然是一个拥有它的元素。

为什么你不想在没有能量容器的元素上调用它？如果它*没有*能量容器，则返回对 的某个“空对象”实现的`EnergyContainer`引用，或者返回空引用。这取决于您以后想用它做什么 - 如果您可以轻松实现某种“中性”能量容器，那么空对象模式是最简单的方法。否则，只需：

```
EnergyContainer container = element.getEnergyContainer();
if (container != null) {
    // Use the container
} 
```

毫无疑问，有人会争辩说这在某种意义上是“不纯的”——但几乎可以肯定它比大多数替代方案*更简单。*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T15:41:07.467

最好的解决方案是将`getEnergyContainer()`方法放在所有包含能量的元素的超类之一中，并在每个元素类中覆盖此方法。您可以制作此方法`abstract`以确保其被覆盖。你的超类可能是`Element`因为你说：`Element is an abstract class which robot and items extend.`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-22T17:00:03.830

鉴于您的类层次结构使用带有接口的组合来提供默认的 EnergyContainer 行为

```
abstract class Element {

    EnergyContainer ec = new EmptyEnergyContainer();

    int getEnergyValue() {
        getEnergyContainer().getValue();
    }

    EnergyContainer getEnergyContainer() {
        return ec;
    }

    setEnergyContainer(EnergyContainer container) {
        this.ec = container;
    }
}

class Robot extends Element {

    public Robot() {
        this.ec = new ActiveEnergyContainer();
    }
}

class Item extends Element{

    public Item() {
        this.ec = new ActiveEnergyContainer();
    }
}

class Brick extends Element{
    // will have a EmptyEnergyContainer by default
} 
```

EnergyContainer 的接口层次结构是这样的

```
interface EnergyContainer {
    int getValue();
    setValue(int value);
}

class EmptyEnergyContainer implements EnergyContainer {
    @Override
    int getValue() {
        return 0;
    }

    @Override
    setValue(int val) {
        throw Exception("Can not charge an empty container");
    }
}

class ActiveEnergyContainer implements EnergyContainer {
    int value;

    @Override
    int getValue() {
        return 17 + 3;  // calculate the value
    }

    @Override
    setValue(int val) {
        this.value = val // or do some funky calculation
    }
} 
```

在运行时，您可以为您的对象设置新的 EnergyContainer 类型。如果您有多个父类，`Element`那么您将必须遵循相同的模式，将默认行为添加到抽象父类并根据需要进行覆盖。

让默认行为为 getValue() 返回一个合理的默认值将帮助您不必到处使用`instanceof`。

此代码的潜在改进将是引入

1.  用于创建各种 EnergyContainer 变体的 AbstractFactory 模式
2.  包括一种`hasEnergy()`使您的代码更具可读性而不是检查值 == 0 的方法
3.  `Element`如果其他类似的父类将包含类似的方法，请实现一个接口

# java - 如何在使用spring mvc和hibernate更新之前预填充对象？

> ID：10705292
> 
> 赞同：0
> 
> 时间：2012-05-22T15:36:02.713
> 
> 标签：java, spring, hibernate, spring-mvc

在使用休眠保存此对象之前预填充对象的最佳做法是什么？

我做了什么：

**我的控制器：**

```
//The Form
@RequestMapping(value = "user/{id}/edit", method = RequestMethod.GET)
public String edit(@PathVariable("id") Long userId, ModelMap modelMap) {
    modelMap.addAttribute("user", userService.find(userId));    
    return "user/userEdit";

}
//Updating database
@RequestMapping(value = "user/edit", method = RequestMethod.POST)
public String update(@ModelAttribute("user") @Valid User user, BindingResult result,
                                                RedirectAttributes redirectAttrs) {
    if (result.hasErrors()) {
            return "user/userEdit";
    }else{
        userService.update(user);
        redirectAttrs.addFlashAttribute("message", "Success");

        return "redirect:user/userEdit";
    }
} 
```

如果我制作一个包含所有字段（用户名、密码和 ID）的表单，它会起作用，但是如果我希望用户只更新密码，我该怎么办？

由于我在用户名处有一个@NotEmpty，因此我收到一个错误，即用户名为空，因为它不在表单中，但我不想输入用户名字段，只是输入密码。

**我的html表单：**

```
<c:url var="url" value="/user/edit" />
<form:form method="post" action="${url}" modelAttribute="user" class="form-horizontal">
    <form:hidden path="id"/>
    <form:hidden path="version"/>
    <fieldset>
        <div class="control-group">
            <form:label cssClass="control-label" path="password"><spring:message code="user.label.password"/>: </form:label>
            <div class="controls">
                <form:input cssClass="input-xlarge" path="password" />
            </div>
            <form:errors path="password"/>
        </div>
        <div class="control-group">
            <form:label cssClass="control-label" path="userRole"><spring:message code="user.label.role"/>: </form:label>
            <div class="controls">
                <form:select path="userRole">
                       <form:options items="${userRoleList}" itemValue="id" itemLabel="name"/>
                </form:select>
            </div>
            <form:errors path="userRole"/>
        </div>
        <div class="control-group">
            <form:label cssClass="control-label" path="costumer.id"><spring:message code="user.label.costumer"/>: </form:label>
            <div class="controls">
                <form:select path="costumer.id">
                       <form:options items="${costumerList}" itemValue="id" itemLabel="name"/>
                </form:select>
            </div>
            <form:errors path="costumer.id"/>
        </div>

        <div class="form-actions">
            <button type="submit" class="btn btn-primary">Save changes</button>
            <a class="btn cancel link" href="<c:url value="/user" />">Cancel</a>
        </div>
    </fieldset>
</form:form> 
```

*   我尝试使用@Sessionattributes，但如果我尝试使用浏览器选项卡编辑两个或更多用户，它就无法正常工作。
*   我尝试使用属性编辑器，但不适用于 @ModelAtrribute User 用户。
*   我尝试使用转换器但没有用。

是先让用户 user = userService.find(id) 然后设置更新值的唯一方法吗？就像是：

```
@RequestMapping(value = "user/edit", method = RequestMethod.POST)
public String update(@RequestParam("password") String password, BindingResult result, RedirectAttributes redirectAttrs) {
    User user = userService.find(id);
if (password == null{                           
    return "user/userEdit";
}else{
    user.setPassword("password");
    userService.update(user);
    redirectAttrs.addFlashAttribute("message", "Success");

    return "redirect:user/userEdit";
}
} 
```

哪个看错了，因为没有验证。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T16:03:00.823

尝试使用：

@PrePersist
@PreUpdate
public void prepare(){
  //对你的实体做点什么 //例如：if(name==null){ name="MYNAMEVALUE";}
}

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T15:40:54.427

我认为不那么混乱和容易发生事故的另一种方法是创建一个模拟 UI 表单的类，例如

```
public class EditUserForm {
    // getters and setters for password and other fields...
} 
```

在控制器的`update(EditUserForm,...)`方法中，您只需将用户填充的任何字段映射到您希望更新`EditUserForm`的实例。`User`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-22T16:00:35.960

我也遇到过这个问题，如果只有几个字段，我会使用您的第二个示例并逐个验证这些字段。否则，您将不得不按照其他海报所说的去做并创建一个新课程以匹配您的表格。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-22T15:44:53.030

在您发布的代码中，很明显在实现移动控制和持久性操作之前，您需要一些外部帮助程序类与您的 GUI 端更新相关联。

# php - PHP Soap Server 如何知道被调用的方法

> ID：10705298
> 
> 赞同：4
> 
> 时间：2012-05-22T15:36:16.203
> 
> 标签：php, soap, soapserver

在 PHP 中，我想知道 SOAP 调用的方法是什么。这是一个示例以了解...

```
$soapserver = new SoapServer();
$soapserver->setClass('myClass');
$soapserver->handle(); 
```

我想知道的是将在 handle() 中执行的方法的名称

谢谢 ！！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-23T08:08:09.990

在我看来，在这种情况下访问被调用操作名称的最简洁和最优雅的方法是使用某种**Wrapper**或**Surrogate**设计模式。根据您的意图，您将使用[Decorator](http://sourcemaking.com/design_patterns/decorator)或[Proxy](http://sourcemaking.com/design_patterns/proxy)。

例如，假设我们想在`Handler`不触及类本身的情况下动态地向我们的对象添加一些附加功能。这允许保持`Handler`类更清洁，从而更专注于它的直接责任。这样的功能可以是记录方法及其参数或实现某种缓存机制。为此，我们将使用**装饰器**设计模式。而不是这样做：

```
class MyHandlerClass
{
    public function operation1($params)
    {
        // does some stuff here
    }

    public function operation2($params)
    {
        // does some other stuff here
    }
}

$soapserver = new SoapServer(null, array('uri' => "http://test-uri/"));
$soapserver->setClass('MyHandlerClass');
$soapserver->handle(); 
```

我们将执行以下操作：

```
class MyHandlerClassDecorator
{
    private $decorated = null;

    public function __construct(MyHandlerClass $decorated)
    {
        $this->decorated = $decorated;
    }

    public function __call($method, $params)
    {
        // do something with the $method and $params

        // then call the real $method
        if (method_exists($this->decorated, $method)) {
            return call_user_func_array(
                array($this->decorated, $method), $params);
        } else {
            throw new BadMethodCallException();
        }
    }
}

$soapserver = new SoapServer(null, array('uri' => "http://test-uri/"));
$soapserver->setObject(new MyHandlerClassDecorator(new MyHandlerClass()));
$soapserver->handle(); 
```

如果您想控制对处理程序操作的访问，例如，为了施加访问权限，请使用**代理**设计模式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-02-18T13:33:33.520

我知道这是一篇旧帖子，但有人可以利用这个解决方案。应该可以从原始 HTTP POST 数据中提取数据。您不能使用`$_POST`，因为它是空的，但您可以使用`$HTTP_RAW_POST_DATA`包含 XML 格式的 SOAP 请求的字符串的预定义变量。

方法名称应该在`<soapenv:Body>`标签的第一个节点中，如下所示：

```
<!--
    ...
    XML header, SOAP header etc.
    ...
-->
<soapenv:Body>
   <urn:methodName soapenv:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/">
      <param1 xsi:type="xsd:string" xs:type="type:string" xmlns:xs="http://www.w3.org/2000/XMLSchema-instance">param1 value</param1>
      <param2 xsi:type="xsd:string" xs:type="type:string" xmlns:xs="http://www.w3.org/2000/XMLSchema-instance">param2 value</param2>
   </urn:methodName>
</soapenv:Body>
<!--
    ...
--> 
```

您可能可以使用 SimpleXML 之类的东西对其进行解析，或者使用一些正则表达式来获取`methodName`，但请记住该字符串`urn:`是在标头中定义的命名空间，因此它可以是任何东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-22T16:49:39.470

虽然不是最好的方法，但您可以以某种方式使用此[http://danpolant.com/use-the-output-buffer-to-debug-a-soap-server/](http://danpolant.com/use-the-output-buffer-to-debug-a-soap-server/)。

对于快速且非常肮脏的方法（请仅将其用于一次性调试，而不是在生产代码中使用！）：只需在方法主体中为每个 SOAP 方法的名称分配一个全局变量，然后用它做任何你想做的事情SoapServer 完成了它的工作，如上面的链接中所述。像这样的东西（未经测试的代码）：

```
$method = "";
class test
{
    function call1()
    {
        global $method; $method = "call1";
    }
}
ob_start();
$soapserver = new SoapServer();
$soapserver->setClass('test');
$soapserver->handle();

$mystring = ob_get_contents(); // retrieve all output thus far
ob_end_clean ();               // stop buffering
log($mystring);                // log output
log($method);                  // log method
echo $mystring;                // now send it 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-04T15:17:28.677

通常（但不总是，取决于客户端）`$_SERVER['HTTP_SOAPACTION']`已设置，您可以从中获取被调用方法的名称。

# asp.net - ASP.Net WebAPI URL 不返回任何数据

> ID：10705300
> 
> 赞同：1
> 
> 时间：2012-05-22T15:36:34.100
> 
> 标签：asp.net, asp.net-mvc, asp.net-web-api

我正在使用 Northwind 数据库，试图了解 Asp.Net 的 WebAPI。

我的模型/控制器/全局文件如下所示。

当我导航到 localhost: xxxx/api/employees/5 它正确地转到正确的控制器：

```
' GET /api/employees/5
Public Function GetValue(ByVal ID As Integer) As Employee
    Dim emp As Employee = db.Employees.Find(ID)
    Return emp
End Function 
```

...但是 emp 返回 Null/Nothing。

Northwind 数据库肯定有数据：

![北风快照](../Images/542351e394ce5ba7967b321ac55a2535.png)

谁能看到我要去哪里错了？

谢谢，马克

* * *

模型/Employee.vb：

```
Imports System.Data.Entity

  Namespace MvcApplication21
  Public Class Employee
    Public Property EmployeeID() As Integer
    Public Property FirstName() As String
    Public Property LastName() As String
  End Class

  Public Class EmployeeDBContext
    Inherits DbContext
    Public Property Employees() As DbSet(Of Employee)
  End Class
End Namespace 
```

控制器/EmployeesController.vb

```
Imports System.Web.Http
Imports MvcApplication21
Imports MvcApplication21.MvcApplication21

Public Class EmployeesController
Inherits ApiController

Private db As New EmployeeDBContext

' GET /api/employees
Public Function GetValues() As IEnumerable(Of String)
    Return New String() {"value1", "value2"}
End Function

' GET /api/employees/5
Public Function GetValue(ByVal EmployeeID As Integer) As Employee
    Dim employee As Employee = db.Employees.Find(EmployeeID)
    Return employee
End Function 
```

网络配置：

```
<configuration>
  <connectionStrings>
    <add name="DefaultConnection" connectionString="Data Source=.\SQLEXPRESS;Initial Catalog=Northwind;Integrated Security=True" providerName="System.Data.SqlClient" />
  </connectionStrings> 
```

全球.asax.vb

```
Imports System.Web.Http
Imports System.Web.Optimization

Public Class WebApiApplication
 Inherits System.Web.HttpApplication

 Shared Sub RegisterGlobalFilters(ByVal filters As GlobalFilterCollection)
    filters.Add(New HandleErrorAttribute())
 End Sub

 Shared Sub RegisterRoutes(ByVal routes As RouteCollection)
    routes.IgnoreRoute("{resource}.axd/{*pathInfo}")

    routes.MapHttpRoute( _
        name:="DefaultApi", _
        routeTemplate:="api/{controller}/{id}", _
        defaults:=New With {.id = RouteParameter.Optional} _
    )

    routes.MapRoute( _
        name:="Default", _
        url:="{controller}/{action}/{id}", _
        defaults:=New With {.controller = "Home", .action = "Index", .id = UrlParameter.Optional} _
    )
 End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T11:34:08.220

你的路由参数和你的函数参数有冲突

在你的问题的第一部分你有

公共函数 GetValue(ByVal ID As Integer) 作为员工

在控制器中它是

公共函数 GetValue(ByVal EmployeeID As Integer) 作为员工

*   一个以 ID 作为参数，另一个以 EmployeeID 作为参数

而您在路由中使用 ID

```
routes.MapHttpRoute( _         
   name:="DefaultApi", _         
   routeTemplate:="api/{controller}/{id}", _         
   defaults:=New With {.id = RouteParameter.Optional} _     
) 
```

# android - 通过主题隐藏通知

> ID：10705305
> 
> 赞同：0
> 
> 时间：2012-05-22T15:36:43.020
> 
> 标签：android, styles, themes

我知道如何通过 java 代码做到这一点，但我想知道如何在我自己的自定义主题中设置它。我找到了

```
<item name="android:windowNoTitle">true</item> 
```

用于隐藏应用程序标题栏，但是是否有一个项目可以隐藏通知栏？我还没有找到这个。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T16:17:35.467

根据您的问题，我假设您想要全屏功能？这是一个[可能的答案](https://stackoverflow.com/a/9859489/1325551/)，至少可以给您一个想法。

# android - 如何使用 PhoneGap 1.7 在 Android 2.x 设备上进行部署？

> ID：10705306
> 
> 赞同：0
> 
> 时间：2012-05-22T15:36:43.360
> 
> 标签：android, mobile, deployment, cordova

我目前正在使用 PhoneGap 1.7，刚刚按照他们网站上的说明创建了 HelloWorld 应用程序。但是，我相信它需要 Android 版本 15 或更高版本 (4.0.3)。我最终将使用 PhoneGap 包装一个 jQuery Mobile 应用程序，我需要它可以在 Android 2.x 上运行。Android 1.x 和 3.x 会很好，但不是必需的。如何创建可在 2.x 和 4.x 版本的 Android 上运行的可部署应用程序（1.x 和 3.x 是可选的）？我希望我不必拥有不同版本的 PhoneGap 以及不同的部署应用程序版本。我想为所有版本提供一个可部署的应用程序。

非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T15:42:19.493

我对phonegap一点也不熟悉。但是对于原生开发，API 级别是向后兼容的。因此，您可以使用 API 15 构建应用程序，但将清单中的 android:minSdkVersion 设置为更低的值。我想这也是 phonegap 的工作方式，所以即使您使用的是最新的 API 级别，它仍然应该是向后兼容的。

即在本机应用程序的清单中

```
<uses-sdk android:minSdkVersion="7"/> 
```

将表明该应用程序能够在任何 Android 2.1 或更高版本的设备上运行。即使您已将 4.0.3 android jar 文件添加到项目中，系统也足够智能，只要您在清单中设置它，它就可以确保它仍然可以在旧设备上运行。

还值得注意的是，如果您的应用程序利用了任何较新的 API，那么您必须想出一种方法来确保在应用程序检测到当前使用的操作系统版本太旧而无法支持时关闭这些功能该功能。

# gnupg - 从加密文件中获取 gnupg 公钥的电子邮件地址

> ID：10705315
> 
> 赞同：1
> 
> 时间：2012-05-22T15:37:05.703
> 
> 标签：gnupg

我正在编写一个使用 gnupg 加密文件并将其发送到远程主机的 drupal 模块。我的模块中似乎存在一些错误，它使用错误的公钥发送到远程主机，因为他们告诉我当他们尝试解密文件时它失败了。这是他们从 Windows 批处理文件中得到的错误消息：

```
Beginning GPG Decryption
Using current version of GNUPG
gpg: encrypted with 2048-bit ELG-E key, ID F1940956, created 2002-04-25
      "Wrong Public Key <another_key@another_company.com>"
gpg: decryption failed: secret key not available 
```

但是，当我尝试解密我发送的文件时，没有密钥，我得到了简单的

```
$> gpg --decrypt sensitive_file.gpg
gpg: encrypted with ELG-E key, ID F1940956
gpg: decryption failed: secret key not available 
```

我希望 gpg 报告用于加密文件的密钥的电子邮件地址，就像我从远程主机收到的错误消息一样。我想看看`Wrong Public Key <another_key@another_company.com>`，就像他们的错误信息一样。但我的 gpg 没有报告。

我错过了一个开关吗？我怎样才能得到这些信息？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T15:36:18.463

远程主机能够获得加密密钥的电子邮件地址的原因是 id `F1940956`。远程签名要么已经在他们的密钥环上拥有这个密钥和附加信息，要么在注册表中查找它，因为这个密钥是一个已发布的密钥。

# asp.net - SqlDataSource 传递变量

> ID：10705320
> 
> 赞同：1
> 
> 时间：2012-05-22T15:37:38.950
> 
> 标签：asp.net, sql, vb.net

我正在尝试将变量传递给 SqlDataSource 中的 SelectCommand。我有这个 MyIdVal 需要通过。

这是代码：

```
<form id="form1" runat="server">

<div>
<%=MyIdVal%>
</div>
<asp:GridView ID="GridView1" runat="server" DataSourceID="myIdDataSource">
</asp:GridView>
<asp:SqlDataSource runat="server" ID="myIdDataSource" 
    ConnectionString="<%$  ConnectionStrings:myCipConnection  %>" 
    ProviderName="<%$ ConnectionStrings:myCipConnection.ProviderName %>"
    SelectCommand="SELECT * FROM books WHERE id = @MyIdVal" >   

    </asp:SqlDataSource>

</form> 
```

如果我对 id 进行硬编码，代码可以正常工作，那么它是如何工作的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T15:57:19.613

这里有两种方法。

1.  将参数值绑定到控件

    ```
    <selectparameters>
        <asp:controlparameter 
                name="MyIdVal" 
                controlid="DropDownListBooks" 
                propertyname="SelectedValue"/>
    </selectparameters> 
    ```

2\. 使用[SqlDataSource.Selecting 事件](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.sqldatasource.selecting.aspx)

```
protected void myIdDataSource_Selecting
    (object sender, ObjectDataSourceSelectingEventArgs e)
{
    e.InputParameters["MyIdVale"] = MyIdVal;
} 
```

# wpf - 数据模板列表框选定项

> ID：10705322
> 
> 赞同：0
> 
> 时间：2012-05-22T15:37:39.603
> 
> 标签：wpf

这是我的xml：

```
<Window x:Class="WpfTest.Search"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Search" Height="600" Width="1024">

    <Window.Resources>
        <DataTemplate x:Key="listBoxTemplate" xmlns:ns="clr-namespace:MyConverters">
            <StackPanel Orientation="Horizontal">
                <StackPanel.Resources>
                    <ns:ImageConverter x:Key="MyImageConverter" />
                </StackPanel.Resources>
                <Image Source="{Binding Path=thumb, StringFormat=/WpfTest;component/Images/{0}, Converter={StaticResource MyImageConverter}}" Height="100" Width="130" Margin="5"></Image>
                <StackPanel Orientation="Vertical" Width="247">
                    <TextBlock Text="{Binding recipeName}" Height="60" Padding="15" FontSize="16" HorizontalAlignment="Stretch" VerticalAlignment="Center"></TextBlock>
                    <TextBlock Text="{Binding cuisine}" Height="60" Padding="15" FontSize="16" HorizontalAlignment="Stretch" VerticalAlignment="Center"></TextBlock>
                </StackPanel>
            </StackPanel>
        </DataTemplate>
    </Window.Resources>

    <Grid>
        <ListBox Margin="12,96,0,0" Name="lstSearchResult" HorizontalAlignment="Left"
                 VerticalAlignment="Top" Width="704" Height="445" ItemsSource="{Binding Tables[0]}" ItemTemplate="{StaticResource listBoxTemplate}" SelectionChanged="lstSearchResult_SelectionChanged">
        </ListBox>
        <TextBox Height="31" HorizontalAlignment="Left" Margin="12,49,0,0" Name="txtSearchRecipe" VerticalAlignment="Top" Width="518" FontSize="16" />
        <Button Content="Search" Height="31" HorizontalAlignment="Left" Margin="555,49,0,0" Name="btnSearchRecipe" VerticalAlignment="Top" Width="161" Click="btnSearchRecipe_Click" />
    </Grid>
</Window> 
```

现在我想根据我在列表框上单击的项目打开一个新表单，将来自所选项目的文本块的数据传递给新表单。我怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T16:52:11.633

如果我没看错，你不需要做任何特别的事情来访问 DataTemplate 中的 TextBlock 控件。您只需要通过使用 TwoWay 绑定将 SelectedItem 绑定添加到您的 ListBox 来利用您的绑定。

如果您使用的是 MVVM，我建议您将按钮单击事件上的命令映射到视图模型，并将 SelectedItem 作为命令参数传递。然后，在命令处理程序中，将 SelectedItem 转换为您期望的类型（这应该是您绑定到 ListBox ItemsSource 的集合中的对象类型）。然后，您可以将绑定到 TextBlocks 的属性发送到新窗口的视图模型。如果设置正确，这些项目应该存在于您的 SelectedItem 中。然后将窗口的DataContext设置为对应的窗口viewmodel并显示出来。

如果您只是在后面使用代码，只需将 SelectedItem 强制转换为 ListBox ItemsSource 集合中使用的类型。然后将绑定到 TextBlocks 的属性传递给新窗口。然后显示窗口。

# iphone - 在普通类中使用 SKProduct

> ID：10705324
> 
> 赞同：1
> 
> 时间：2012-05-22T15:37:44.003
> 
> 标签：iphone, objective-c, ios, in-app-purchase

我已经`StoreKit`在我的项目中设置了，我可以从应用商店获取产品信息，一切正常。

我现在要做的是`SKProduct`在我的一个类中添加一个作为实例变量，如下所示：

```
#import <UIKit/UIKit.h>
#import <Foundation/Foundation.h>

@interface VideoCell : UITableViewCell
{
    IBOutlet UILabel *title;
    IBOutlet UILabel *description;
    SKProduct *product;
}

@property (retain) IBOutlet UILabel *title;
@property (retain) IBOutlet UILabel *description;
@property (retain) SKProduct *product; 
```

它仅适用于`IBOutlet`变量，但`SKProduct`行有错误，如下所示：

```
Unknown type name 'SKProduct' 
```

我很困惑，因为类名自动完成但实际上并没有编译......

有任何想法吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-22T15:40:08.593

看起来您缺少导入：

```
#import <StoreKit/StoreKit.h> 
```

# xml - xml 反序列化后何时执行特定于属性的任务

> ID：10705325
> 
> 赞同：1
> 
> 时间：2012-05-22T15:37:53.047
> 
> 标签：xml, vb.net, serialization, xml-serialization

我正在使用 XML 反序列化来处理来自我正在调用的 api 的 XML 响应。我要返回的属性之一需要根据类中的另一个属性进行更改。一个例子：

```
<XmlRoot("Foot")> _
Public Class Foo
    Private m_bar1 As String
    Private m_bar2 As String
    Private m_rawbar2 As String

    <XmlAttribute("Bar1")> _
    Public Property Bar1() As String
        Get
            return m_bar1
        End Get
        Set(value As String)
            m_bar1 = value
        End Set
    End Property

    <XmlAttribute("Bar2")> _
    Public Property RawBar2() As String
        Get
            return m_rawbar2
        End Get
        Set(value As String)
            m_rawbar2= value

            'This won't (always) work because the order in which the 
            'properties are deserialized is unknown
            'm_bar2 = m_bar1 & m_rawbar2 
        End Set
    End Property

    <XmlIgnore()> _
    Public ReadOnly Property Bar2() As String
        Get
            return m_bar2
        End Get
    End Property
End Class 
```

在我的情况下， bar1 将是一个 url，而 bar2 将是同一域上的相对路径。我唯一可以设置 m_bar2 的时间是当每个属性都被反序列化时，因为顺序是未知的。最好的方法是什么？

# java - 带有 Symbol 外设的 JavaPOS 配置

> ID：10705327
> 
> 赞同：1
> 
> 时间：2012-05-22T15:37:57.140
> 
> 标签：java, javapos

我有一个需要启用 JavaPOS 的 POS 应用程序。根据我的研究，我得出的结论是，有很多类似的供应商`Epson`可以为该外围设备`IBM`自动配置`jpos.xml`。这意味着从这些供应商下载驱动程序后，有一个配置`jpos.xml`文件的实用程序。

但是，还有其他供应商喜欢`Symbol`并且`Posiflex`没有为我们提供下载相关驱动程序的实用程序，因此需要`jpos.xml`手动配置。

我需要知道外围设备的 jar 文件是否需要简单地复制到 POS 应用程序的库文件夹中，或者也需要添加到 POS 应用程序类路径中。

对此的任何澄清将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-03T12:10:43.390

并非如此，Pos 供应商通常会提供他们自己的 upos 驱动程序（如 ibm、nixdorf ...）和实用程序来配置 jpos.xml。

如果您想集成周边供应商 jpos 驱动程序，您必须：

1）将驱动程序包添加到路径和/或类路径取决于您是否只有 jar 或 jar 和 dll

2）在 jpos.xml 中添加一个条目，以提供一个逻辑别名以在您的应用程序中使用 kasstore 论坛中有一些线程对此进行了解释。

# r - 从 POSIXct 中提取小时和秒以在 R 中进行绘图

> ID：10705328
> 
> 赞同：66
> 
> 时间：2012-05-22T15:38:01.470
> 
> 标签：r, datetime, ggplot2, lubridate

假设我有以下`data.frame` `foo`

```
 start.time duration
1 2012-02-06 15:47:00      1
2 2012-02-06 15:02:00      2
3 2012-02-22 10:08:00      3
4 2012-02-22 09:32:00      4
5 2012-03-21 13:47:00      5 
```

并`class(foo$start.time)`返回

```
[1] "POSIXct" "POSIXt" 
```

我想创建一个`foo$duration`v.的情节`foo$start.time`。在我的场景中，我只对一天中的时间感兴趣，而不是一年中的实际一天。如何从`POSIXct`向量类中提取一天中的时间为小时：秒？

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2012-05-22T18:42:19.663

这是一个很好的问题，并强调了在 R 中处理日期的一些困难。 lubridate 包非常方便，所以下面我介绍两种方法，一种使用 base（如 @RJ- 建议的那样），另一种使用 lubridate。

在原始帖子中重新创建（前两行）数据框：

```
foo <- data.frame(start.time = c("2012-02-06 15:47:00", 
                                 "2012-02-06 15:02:00",
                                 "2012-02-22 10:08:00"),
                  duration   = c(1,2,3)) 
```

转换为 POSIXct 和 POSIXt 类（两种方法）

```
# using base::strptime
t.str <- strptime(foo$start.time, "%Y-%m-%d %H:%M:%S")

# using lubridate::ymd_hms
library(lubridate)
t.lub <- ymd_hms(foo$start.time) 
```

现在，将时间提取为十进制小时

```
# using base::format
h.str <- as.numeric(format(t.str, "%H")) +
               as.numeric(format(t.str, "%M"))/60

# using lubridate::hour and lubridate::minute
h.lub <- hour(t.lub) + minute(t.lub)/60 
```

证明这些方法是平等的：

```
identical(h.str, h.lub) 
```

然后选择上述方法之一将小数小时分配给`foo$hr`：

```
foo$hr <- h.str

# If you prefer, the choice can be made at random:
foo$hr <- if(runif(1) > 0.5){ h.str } else { h.lub } 
```

然后使用 ggplot2 包进行绘图：

```
library(ggplot2)
qplot(foo$hr, foo$duration) + 
             scale_x_datetime(labels = "%S:00") 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2012-10-12T23:18:05.283

您可以依赖基础 R：

```
# Using R 2.14.2
# The same toy data
foo <- data.frame(start.time = c("2012-02-06 15:47:00", 
                                 "2012-02-06 15:02:00",
                                 "2012-02-22 10:08:00"),
                  duration   = c(1,2,3)) 
```

由于类 POSIXct 以结构化方式包含日期时间信息，因此您可以依靠`substr`提取 POSIXct 向量中时间位置的字符。也就是说，如果您知道 POSIXct 的格式（打印时的显示方式），您可以提取小时和分钟：

```
# Extract hour and minute as a character vector, of the form "%H:%M"
substr(foo$start.time, 12, 16) 
```

然后将其粘贴到任意日期以将其转换回 POSIXct。在示例中，我使用 2012 年 1 月第一次，但如果您不指定日期而是使用`format`R 使用当前日期。

```
# Store time information as POSIXct, using an arbitrary date
foo$time <- as.POSIXct(paste("2012-01-01", substr(foo$start.time, 12, 16))) 
```

并且两者都`plot`知道`ggplot2`如何在开箱即用的 POSIXct 中格式化时间。

```
# Plot it using base graphics
plot(duration~time, data=foo)

# Plot it using ggplot2 (0.9.2.1)
library(ggplot2)
qplot(x=time, y=duration, data=foo) 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2017-12-06T11:43:08.070

Lubridate 不处理一天中的时间数据，因此 Hadley 建议将 hms 包用于此类数据。像这样的东西会起作用：

```
library(lubridate)
foo <- data.frame(start.time = parse_datetime(c("2012-02-06 15:47:00", 
                                 "2012-02-06 15:02:00",
                                 "2012-02-22 10:08:00")),
                  duration   = c(1,2,3))

foo<-foo %>% mutate(time_of_day=hms::hms(second(start.time),minute(start.time),hour(start.time))) 
```

注意 2 个潜在问题 - 1) lubridate 有一个不同的函数，称为 hms 和 2) hms::hms 以与其名称所建议的相反的顺序接受参数（因此可以只提供几秒钟）

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2014-07-01T18:32:15.287

此代码比转换为字符串并返回数字要快得多

```
time <- c("1979-11-13T08:37:19-0500", "2014-05-13T08:37:19-0400");
time.posix <- as.POSIXct(time, format = "%Y-%m-%dT%H:%M:%S%z");
time.epoch <- as.vector(unclass(time.posix));
time.poslt <- as.POSIXlt(time.posix, tz = "America/New_York");
time.hour.new.york <- time.poslt$hour + time.poslt$min/60 + time.poslt$sec/3600;

> time;
[1] "1979-11-13T08:37:19-0500" "2014-05-13T08:37:19-0400"
> time.posix;
[1] "1979-11-13 15:37:19 IST" "2014-05-13 15:37:19 IDT"
> time.poslt;
[1] "1979-11-13 08:37:19 EST" "2014-05-13 08:37:19 EDT"
> time.epoch;
[1]  311348239 1399984639
> time.hour.new.york;
[1] 8.621944 8.621944 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2019-09-11T14:36:58.963

这是一个古老的话题，但我发现关于这个问题的问题和答案很少。我的解决方案如下

```
library(hms)
foo <- data.frame(start.time = c("2012-02-06 15:47:00", 
                             "2012-02-06 15:02:00",
                             "2012-02-22 10:08:00"),
              duration   = c(1,2,3))

foo$start.time = as.POSIXct( foo$start.time )

g1 = ggplot( ) + xlab("") + 
  geom_line( data = foo, aes(x = as.hms(start.time), y = duration ), color = "steelblue" )
g1 
```

如果您想添加手动时间 (!) 休息时间，那么

```
time_breaks =    as.POSIXlt(c(
                   "2012-02-06 12:35:00 MSK", 
                   "2012-02-06 13:15:00 MSK",
                   "2012-02-06 14:22:00 MSK",
                   "2012-02-06 15:22:00 MSK"))
 g1 + 
  scale_x_time( breaks = as.hms( time_breaks ) ) +
  theme(  axis.text.x = element_text( angle=45, vjust=0.25) ) 
```

# ruby-on-rails - Twitter 的 activerecord-reputation-system gem + Devise

> ID：10705329
> 
> 赞同：1
> 
> 时间：2012-05-22T15:38:11.960
> 
> 标签：ruby-on-rails, ruby-on-rails-3, twitter, routing, gem

我正在使用 Twitter 的新[activerecord-reputation-system](https://github.com/twitter/activerecord-reputation-system/issues?state=open) gem，但它似乎没有在我的应用程序中注册。

我跑去安装（文档有错字）：

```
gem install activerecord-reputation-system && rails generate reputation_system && rake db:migrate 
```

我已将它包含在我的 gemfile 中，并尝试直接从 github 中提取，以及重新启动我的本地服务器。错误如下：

> ActionController::RoutingError (未定义的方法`has_reputation' for #<Class:0x007fa7ed783ec0>): app/models/post.rb:18:in`'app/models/post.rb:1:in `<top (required)>' app/controllers/posts_controller.rb:1:in`'

当我尝试使用此代码为帖子添加投票时：

```
class Post < ActiveRecord::Base
  belongs_to :user
  has_reputation :votes,
    :source => :user,
    :aggregated_by => :sum
end 
```

当我尝试使用相同的代码向用户添加投票时，我得到：

```
undefined method `has_reputation' for #<Class:0x007fa7efb70388>

app/models/user.rb:17:in `<class:User>'
app/models/user.rb:1:in `<top (required)>'
config/routes.rb:4:in `block in <top (required)>'
config/routes.rb:1:in `<top (required)>'

This error occurred while loading the following files:
   /Users/username/appname/config/routes.rb 
```

routes.rb，第 4 行：

> devise_for :users, :controllers => { :omniauth_callbacks => "users/omniauth_callbacks" }

有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-22T15:42:52.040

您应该`reputation_system`在您的应用程序中要求。您可以通过添加到您的来做到这一点`Gemfile`：

```
gem 'activerecord-reputation-system', :require => 'reputation_system' 
```

**更新：**从版本`2.0.0`开始，您不再需要`reputation_system`：

```
gem 'activerecord-reputation-system' 
```

# scala - 检查远程 Akka 演员是否可用

> ID：10705334
> 
> 赞同：9
> 
> 时间：2012-05-22T15:38:25.130
> 
> 标签：scala, akka

如何检查我通过actorFor获得actorRef的远程演员是否还活着？任何对文档的引用将不胜感激。我正在使用来自 Scala 的 Akka。

我见过对主管和死亡守望者的引用，但并不觉得我的用例需要这么重的机器。我只想让我的客户检查主人是否使用已知路径启动，以及它是否正在发送一条自我介绍的消息。如果主服务器没有启动，那么它应该等待一段时间然后重试。

**更新 2：** 建议我只是使用 ping-pong ask 测试来查看它是否还活着。我理解这类似于

```
implicit val timeout = Timeout(5 seconds)
val future = actor ? AreYouAlive
try{
    Await.result(future, timeout.duration)
}catch{
    case e:AskTimeoutException => println("It's not there: "+e)
} 
```

我想我对日志中存在的异常感到困惑，这些异常现在仍然存在。例如

*   错误：java.net.ConnectException：连接被拒绝
*   错误：java.nio.channels.ClosedChannelException:null

也许这就是它的工作原理，我必须接受日志中的错误/警告，而不是试图防止它们？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-22T21:35:10.800

只需发送消息即可。无论如何，在您发送消息后，它的机器可能会在纳秒内变得无法访问。如果你没有得到任何回复，它很可能已经死了。文档中有一个很大的章节：http: [//doc.akka.io/docs/akka/2.0.1/general/message-send-semantics.html](http://doc.akka.io/docs/akka/2.0.1/general/message-send-semantics.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-01T15:43:34.757

你永远不应该假设网络是可用的。我们这里的架构师总是说分布式系统设计中有两个关键概念。

他们是：

*   超时
*   重试

如果消息在 x 时间段后仍未发送，则消息应该“超时”，然后您可以重试消息。使用超时，您不必担心特定的错误 - 只有消息响应失败。为了获得高水平的可用性，您可能需要考虑使用诸如 zookeeper 之类的工具来处理集群/可用性监控。请参阅此处的领导人选举，例如：http: [//zookeeper.apache.org/doc/trunk/recipes.html](http://zookeeper.apache.org/doc/trunk/recipes.html)

# firefox-addon - 页面完全加载后加载脚本

> ID：10705339
> 
> 赞同：1
> 
> 时间：2012-05-22T15:38:46.630
> 
> 标签：firefox-addon

我正在构建一个在每个页面加载时加载 javascript 的 Firefox 插件。我正在使用在此页面上找到的进度侦听器功能： [https ://developer.mozilla.org/en/Code_snippets/Progress_Listeners](https://developer.mozilla.org/en/Code_snippets/Progress_Listeners)

我的问题是代码似乎在页面完全加载之前执行到早期，这导致我的脚本无法运行。这是我的代码。

```
var PageLoad = {
    browser: null,
    domain:  null,
    oldURL:  null,

    init: function() {
            gBrowser.addProgressListener(urlBarListener,Components.interfaces.nsIWebProgress.NOTIFY_LOCATION);
    },

    uninit: function() {
            gBrowser.removeProgressListener(urlBarListener);
    },

    processNewURL: function(aURI) {
            //if (aURI.spec == this.oldURL)
            //return;

        MyObject.function();

            this.oldURL = aURI.spec;
    }
};

var urlBarListener = {
    locChange: false,

    QueryInterface: function(aIID) {
            if (aIID.equals(Components.interfaces.nsIWebProgressListener) ||
               aIID.equals(Components.interfaces.nsISupportsWeakReference) ||
               aIID.equals(Components.interfaces.nsISupports))
            return this;
            throw Components.results.NS_NOINTERFACE;
    },

    onLocationChange: function(aProgress, aRequest, aURI) {
            PageLoad.processNewURL(aURI);
    },

    onStateChange: function(aWebProgress, aRequest, aFlag, aStatus) {},
    onProgressChange: function(a, b, c, d, e, f) {},
    onStatusChange: function(a, b, c, d) {},
    onSecurityChange: function(a, b, c) {}
};

window.addEventListener("load",
    function() {
            PageLoad.init()
    }, false);

var MyObject = {
    function : function() {
            var script = PageLoad.browser.createElement('script');
            script.src = 'url_to_script.js';
            PageLoad.browser.getElementsByTagName('head')[0].appendChild(script);
    }
}; 
```

使用此代码，我在控制台上收到此错误消息：

> PageLoad.browser.getElementByTagName("head")[0] 未定义

如果我添加超时，那么脚本会间歇性地工作，但如果页面加载缓慢，我会遇到同样的错误，这就是有时有效的方法`setTimeout(MyObject.function, 1000);`

我需要一种更可靠的方法来确保它在页面加载后执行脚本。

不相关，它似乎不会导致任何问题，但我也看到此错误消息：

> gBrowser.addProgressListener 使用第二个参数调用，这是不受支持的。请参阅错误 608628。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T19:07:22.100

如果您想在每个页面加载时加载 javascript - 最好的方法是订阅`DOMContentLoaded`事件：

```
var MyObject  = {
    processDOMContentLoaded: function(doc) {
        var script = doc.createElement('script');
        script.src = 'url_to_script.js';
        script.type = 'text/javascript';
        doc.getElementsByTagName('head')[0].appendChild(script);
    }
};

window.addEventListener('load', function() {
    var appcontent = document.getElementById('appcontent');
    if(appcontent != null) {
        appcontent.addEventListener('DOMContentLoaded', function(event) {
            var doc = event.originalTarget;
            if(doc instanceof HTMLDocument) {
                MyObject.processDOMContentLoaded(doc);
            }
        }, true);
    }
}, false); 
```

尚未测试，但应该可以工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T18:55:09.553

您正在使用`onLocationChange`方法 - 但如果您查看浏览器的行为方式，地址栏中的位置会在与服务器建立连接后立即更改。您应该查看状态更改：

```
onStateChange: function(aWebProgress, aRequest, aFlag, aStatus)
{
  if ((aFlag & Components.interfaces.nsIWebProgressListener.STATE_STOP) &&
      (aFlag & Components.interfaces.nsIWebProgressListener.STATE_IS_WINDOW))
  {
    // A window finished loading
    PageLoad.windowLoaded(aWebProgress.DOMWindow);
  }
}, 
```

请注意，完成加载的窗口被显式传递给`PageLoad.windowLoaded()`- 您将收到来自不同选项卡的通知，并且您不能假设通知来自前台选项卡。

至于您收到的警告，只需在调用中省略第二个参数`gBrowser.addProgressListener()`：

```
gBrowser.addProgressListener(urlBarListener); 
```

[`tabbrowser.addProgressListener()`](https://developer.mozilla.org/en/XUL/tabbrowser#m-addProgressListener)只接受一个参数，不像[`nsIWebProgress.addProgressListener()`](https://developer.mozilla.org/en/XPCOM_Interface_Reference/nsIWebProgress#addProgressListener%28%29)它有第二个参数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-08T06:30:48.483

实际上这是一个很好的问题。您应该使用事件监听器，但要小心，因为如果您为每个页面加载触发它可能会触发您多次（在最坏的情况下大约几十次）。那你怎么能做到呢？

```
window.addEventListener("load", function load(event){
    window.removeEventListener("load", load, false); //remove listener, no longer needed
    myExtension.init(); 
},false);

var myExtension = {
    init: function() {
    var appcontent = document.getElementById("appcontent");   // browser
    if(appcontent){
      appcontent.addEventListener("DOMContentLoaded", myExtension.onPageLoad, true);
    }

  },

  onPageLoad: function(aEvent) {
    var doc = aEvent.originalTarget; // doc is document that triggered the event
    var win = doc.defaultView; // win is the window for the doc

    if (doc.nodeName != "#document") return;
    if (win != win.top) return;
    if (win.frameElement) return;

      alert("the main page has been loaded");

  },
}; 
```

请注意，我们会在每次页面加载触发时检查触发器的类型，以防止多重加载。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-05-23T17:45:49.203

提供的答案是可以接受的，但我找到了另一个完美的解决方案。

```
var PageLoad = {
init: function() {
    if(gBrowser) gBrowser.addEventListener("DOMContentLoaded", this.onPageLoad, false);
  },
  onPageLoad: function(aEvent) {
    var doc = aEvent.originalTarget; // doc is document that triggered the event
    var win = doc.defaultView; // win is the window for the doc

    if (doc.nodeName != "#document") return;
    if (win != win.top) return;
    if (win.frameElement) return;

    MyAddon.function();
  }
}

window.addEventListener("load", function load(event){
  window.removeEventListener("load", load, false); //remove listener, no longer needed
  PageLoad.init();  
},false); 
```

# jquery - Jquery datepicker作为弹出窗口？

> ID：10705341
> 
> 赞同：3
> 
> 时间：2012-05-22T15:38:50.977
> 
> 标签：jquery, html

我对 jquery 很陌生，只有基本的 javascript 经验。

我想要一个 html 输入，单击它会弹出 JQuery datepicker 弹出窗口，它将填充 html 输入。 [http://docs.jquery.com/UI/Datepicker](http://docs.jquery.com/UI/Datepicker)

有人可以给我一个例子来说明如何做到这一点，或者给我一个链接来指引我正确的方向吗？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-22T15:41:03.643

使用 jQuery UI 数据选择器。添加起来非常有用，用户使用起来也非常方便。

[http://jqueryui.com/demos/datepicker/](http://jqueryui.com/demos/datepicker/)

```
<script>
$(function() {
    $( "#datepicker" ).datepicker();
});
</script>

<div class="demo">

<p>Date: <input type="text" id="datepicker"/></p>

</div><!-- End demo --> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T15:43:49.483

在 div 中创建它，然后弹出它，这是最简单的方法。

```
<div id="datepickerholder" style="display: none;">
    <div id="datepicker"></div>
</div>
<a id="pop">pop datepicker</a> 
```

和 JS

```
<script>
$(function() {
    $("#datepicker").datepicker();
    $("#pop").click(function(){
        $("#datepickerholder").show();
    });
});
</script> 
```

也可以在点击后创建实例，也就是说，没有隐藏容器
另一个JS，但仍然可以

```
<div id="datepicker"></div>
<a id="pop">pop datepicker</a>

<script>
$(function() {
    $("#pop").click(function(){
        $("#datepicker").datepicker();
    });
});
</script> 
```

# .net - iis 上的装配负载

> ID：10705342
> 
> 赞同：0
> 
> 时间：2012-05-22T15:38:56.457
> 
> 标签：.net, asp.net-mvc, iis, castle-windsor, ioc-container

我在本地机器上创建了 WebApplication。它运作良好。但是当我将此项目部署到 IIS 时，我遇到了问题。
我知道这样做不好，但在`ControllerInstaller`我写下这个：

```
container.Register(       
          Classes
         .FromAssembly(Assembly
         .LoadFrom(@"D:\Shevtsov\HarbaHabr\Habra.Web\bin\Habra.Web.dll"))
         .BasedOn<IController>()
         .LifestyleTransient()); 
```

很明显，服务器上的这个路径它不会工作......
请告诉我，我必须在这里写什么路径？

PS`ControllerInstaller`在组装`Habra.ServiceLocation`。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T15:42:22.487

您可以使用[MapPath](http://msdn.microsoft.com/en-us/library/system.web.hosting.hostingenvironment.mappath.aspx)方法，该方法返回服务器上文件的绝对路径，给定从 Web 应用程序的根开始的相对路径，由 表示`~/`：

```
container
    .Register(       
        Classes
            .FromAssembly(
                Assembly
                    .LoadFrom(HostingEnvironment.MapPath("~/bin/Habra.Web.dll"))
            )
            .BasedOn<IController>()
            .LifestyleTransient()
    ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T15:47:51.890

如果您使用的是 MVC 4（或更高版本），我建议使用[PreApplicationStartMethodAttribute](http://msdn.microsoft.com/en-us/library/system.web.preapplicationstartmethodattribute.aspx)，然后只需在您的程序集中创建一个如下所示的类`Hara.Web`：

```
[assembly: PreApplicationStartMethod(typeof(Registration), "Register")]

public class Registration
{
   public static void Register()
   {
     var container = ...;
     container.Register(       
       Classes
       .FromAssembly(Assembly.GetExecutingAssembly())
       .BasedOn<IController>()
       .LifestyleTransient());
   }
} 
```

Phill Hackc 有一篇关于使用此属性的非常好的博客[文章](http://haacked.com/archive/2010/05/16/three-hidden-extensibility-gems-in-asp-net-4.aspx)。

# ruby-on-rails - Ruby混合数组到嵌套哈希

> ID：10705344
> 
> 赞同：1
> 
> 时间：2012-05-22T15:38:57.030
> 
> 标签：ruby-on-rails, ruby, hash, multidimensional-array, hashmap

我有一个 Ruby 数组，其元素在字符串和哈希之间交替。例如-

```
["1234", Hash#1, "5678", Hash#2] 
```

我想从中创建一个嵌套的哈希结构。所以，

```
hash["1234"]["key in hash#1"] = value
hash["5678"]["key in hash#2"] = value 
```

有没有人/现在有这样做的好方法？谢谢你。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-22T15:58:44.680

只需使用

```
hsh = Hash[*arr] #suppose arr is the array you have 
```

它将一次切片 2 并转换为哈希。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-22T15:44:04.577

我不认为数组上有一种方法可以直接执行此操作。以下代码有效并且很容易阅读。

```
hsh = {}

ary.each_slice(2) do |a, b|
  hsh[a] = b
end

# Now `hsh` is as you want it to be 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-22T15:52:59.010

让我们猜测一下，使用构面只是为了好玩：

```
require 'facets'
xs = ["1234", {:a => 1, :b => 2}, "5678", {:c => 3}]
xs.each_slice(2).mash.to_h
#=> {"1234"=>{:a=>1, :b=>2}, "5678"=>{:c=>3}} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-22T15:49:04.597

猜测您想要什么，因为*“哈希＃1中的键”*根本不清楚，您也没有定义`hash`或`value`应该是什么：

```
value = 42

h1 = {a:1}
h2 = {b:2}
a = ["1234",h1,"5678",h2]
a.each_slice(2).each{ |str,h| h[str] = value }
p h1, #=> {:a=>1, "1234"=>42}
  h2  #=> {:b=>2, "5678"=>42} 
```

或者，也许您的意思是：

```
h1 = {a:1}
h2 = {b:2}
a = ["1234",h1,"5678",h2]

hash = Hash[ a.each_slice(2).to_a ]
p hash             #=> {"1234"=>{:a=>1}, "5678"=>{:b=>2}}
p hash["1234"][:a] #=> 1 
```

# iphone - 在 iOS 中将图像大小从纵向模式调整为横向模式

> ID：10705345
> 
> 赞同：1
> 
> 时间：2012-05-22T15:38:57.263
> 
> 标签：iphone, image, ipad, resize, landscape

将图像从纵向视图调整为横向视图的最佳方法是什么？

最好的方法是在转动设备时更改图像？还是使用 IB 中自动调整大小的坐标？

谢谢大家！

此致

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T15:43:10.820

您需要像这样将自动调整大小的蒙版添加到您的图像视图中

```
UIImageView *imageView = [[UIImageView alloc]initWithFrame:self.view.frame];
imageView.contentMode = UIViewContentModeScaleAspectFill;
imageView.autoresizingMask = UIViewAutoresizingFlexibleWidth | UIViewAutoresizingFlexibleHeight;
[self.view addSubview:imageView];
[imageView release]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T15:43:09.533

我不知道什么是最好的方法。我喜欢这个

```
imageView.autoresizingMask = UIViewAutoresizingFlexibleTopMargin | UIViewAutoresizingFlexibleBottomMargin | UIViewAutoresizingFlexibleLeftMargin | UIViewAutoresizingFlexibleRightMargin; 
```

# zend-framework - 使用 Zend_Application 的奇怪 Zend_Session 行为

> ID：10705346
> 
> 赞同：1
> 
> 时间：2012-05-22T15:38:58.607
> 
> 标签：zend-framework, zend-session, zend-application, zend-app-bootstrap

我写信是想看看你们中是否有人以前遇到过这个问题，并有机会了解为什么会发生在我身上。

这就是故事。

我在 Zend Framework v. 1.8 之前开发了许多 ZF 应用程序，然后我停止了大约 18 个月。现在我不得不开始一个新项目，我决定再次使用 Zend Framework。

在我的本地服务器上，我安装了 1.11.3 版本，所以我没有下载最新版本。

在将 Zend_Application 与 Bootstrap.php 文件一起使用之前，我曾经启动会话，将会话选项放在我的 config.ini 文件中，然后将它们加载到 Zend_Session 实例中，如下所示：

配置文件

```
sessions.name = NAME
sessions.use_only_cookies = 1
sessions.save_path = APPLICATION_PATH "/../tmp/sessions"
sessions.strict = on
sessions.remember_me_seconds = 1800 
```

index.php（进入公共网络服务器目录）在启动应用程序之前：

```
Globals::startSession(); 
```

具有各种有用方法的自定义 Globals 类：

```
 class Globals
    {
            static public function startSession()
            {
            $sessions_conf = self::getConfig()->sessions;
            Zend_Session::setOptions($sessions_conf->toArray(););
            Zend_Session::start();
            }
    } 
```

这一直工作得很好，启用我的会话（与 Zend_Session_Namespace 一起使用）并将会话文件存储在 save_path 中。

使用 Zend_Application 手册告诉只需将会话选项存储在“部分”资源下的 application.ini 文件中，Zend_Session 将自动配置...

我是这样做的：

```
; SESSIONS
resources.session.name = NAME
resources.session.use_only_cookies = 1
resources.session.save_path = APPLICATION_PATH "/../tmp/sessions"
resources.session.strict = on
resources.session.remember_me_seconds = 1800 
```

它没有用。所以我尝试使用（不是同时！） Bootstrap.php 文件中的 _initSession() 和 _initForceSession() 方法，将它们放在类的开头并将代码写入其中：

```
$this->bootstrap('session'); 
```

但是会话从来没有工作过，数据没有存储在http请求之间，会话文件也没有写入save_path......

请任何人告诉我这是否是正常行为（也许我在某处遗漏了某些东西......）？

显然，我解决了重新实现旧方法的问题（并且效果很好），但我想学习如何正确使用它。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T04:19:36.693

这应该是打开它并且它可以工作的情况，可能会让它变得容易。

我认为您在 application.ini 中设置选项的方式可能有问题：

```
; SESSIONS
resources.session.name = NAME
resources.session.name.use_only_cookies = 1
resources.session.name.save_path = APPLICATION_PATH "/../tmp/sessions"
resources.session.name.strict = on
resources.session.name.remember_me_seconds = 1800 
```

根据[参考手册](http://framework.zend.com/manual/en/zend.session.global_session_management.html#zend.session.global_session_management.configuration_options)

> 要设置会话配置选项，请包含基本名称（“会话”之后的名称部分）作为传递给 Zend_Session::setOptions() 的数组的键。

正确设置选项后，引导程序 _initSession() 应该可以正常工作。

```
public function _initSession()
{
Zend_Session::start();
} 
```

PS 我一直使用 Zend_Session_Namespace 但很少处理全局会话。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T15:56:35.170

在你的 Bootstrap.php 添加

```
public function _initSession()
{
Zend_Session::start();
} 
```

会话选项可以在 application.ini 中设置

# java - 从嵌套的 JSON 中提取所有值

> ID：10705348
> 
> 赞同：0
> 
> 时间：2012-05-22T15:39:20.857
> 
> 标签：java, json, gson

我对 JSON 解析器相当陌生，我正在尝试从“大小”标签中提取所有数据集，即在复杂的嵌套循环中从 JSON 文件中提取值（小、是、xsmall、NO、Medium 和 yes），但没有工作。我正在使用 GSON 解析 JSON 文件并使用 JAVA 作为编程语言

JSON文件的一般外观如下

```
{ response: "ok",
  prodinfo: {
    sizes: [ 
      { size:"small", 
        available: "yes"
      }, 
      { size:"xsmall", 
        available: "No"
      },
      { size:"Medium", 
        available: "yes"
      }
    ]
  }
} 
```

这就是我所做的

```
int array = jsonParser14.parse(json14).getAsJsonObject().get("ProdInfo").getAsJsonObject().getAsJsonArray("sizes").size();
JsonArray sizes = (JsonArray) jsonParser15.parse(json15).getAsJsonObject().get("ProdInfo").getAsJsonObject().getAsJsonArray("sizes");
for (int i = 0; i <= array; i++) {
    String size = sizes.get(i).getAsString();
    System.out.println("data extracted are: " + size);
} 
```

您的帮助将不胜感激。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T15:56:21.940

我通常通过创建一个包含必填字段的公共类来处理这个问题：

```
public class ProdSize {
    public String size;
    public String available;
}

public class ProdInfo {
    public ProdSize[] sizes;
}

public class Message {
    public String response;
    public ProdInfo prodinfo;
} 
```

然后我只需要在 gson 中执行此操作：

```
Gson gson = new GsonBuilder().create();
Message mess = gson.fromJson(theJsonString, Message.class); 
```

然后，我没有任何循环来解析 JSON。我直接有我的尺码

```
mess.prodinfo.sizes 
```

例如，您可以像这样打印它们

```
for (int i=0; i<mess.prodinfo.sizes.length; i++) {
   ProdSize size = mess.prodinfo.sizes[i];
   System.out.println("Size " + size.size + " -> " + size.available);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T15:51:03.153

就像是：

```
var sizes = json.prodinfo.sizes;
for (item in sizes) {
    if (sizes.hasOwnProperty(item)) {
        var isAvailable = sizes[item].available;
        alert(isAvailable);
    }

}​ 
```

这里的例子：http: [//jsfiddle.net/nG88B/3/](http://jsfiddle.net/nG88B/3/)

**编辑**：看起来您需要先解析 JSON。在这种情况下（如果有效），您可以执行以下操作：

```
var obj = JSON.parse(jsonStr); 
```

# python - 如何创建一个动态更新的类实例列表，满足特定条件？（Python）

> ID：10705349
> 
> 赞同：2
> 
> 时间：2012-05-22T15:39:21.430
> 
> 标签：python, oop, list, agent-based-modeling

我想创建一个类实例列表，它会根据实例属性的特定条件自动更新自身。

例如，我有一个我的自定义类 Person() 的对象列表，并且我希望能够生成一个始终包含所有已婚人士的列表，即所有属性“MAR_STATUS”等于“MARRIED”的人。

这在 Python 中可能吗？我使用了一个 C++ 预编译器来进行微模拟，它有一个非常方便的内置函数，叫做“actor_set”，它就是这样做的。但我不知道它是如何在 C++ 中实现的。

谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-22T15:45:08.827

列表理解：

```
[person for person in people if person.MAR_STATUS == 'MARRIED'] 
```

如果您需要将它分配给一个变量，并且希望该变量在每次访问时自动更新，您可以将相同的代码放入一个 lambda、一个普通函数，或者，如果您的变量是一个类成员，则放入一个属性 getter。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-22T15:58:53.670

除非非常仔细地控制，否则“远距离行动”/突变/副作用是不好的形式。

也就是说，如果您真的愿意，命令式语言将允许您这样做，如下所示。这里我们使用python的[[属性getter和setter](http://docs.python.org/library/functions.html#property) ]：

```
MARRIED_SET = set()
def updateMarriedSet(changedPerson):
    if hasattr(changedPerson,'married') and changedPerson.married==Person.MARRIED:
        MARRIED_SET.add(changedPerson)
    else:
        MARRIED_SET.discard(changedPerson)

class Person(object):
    ...

    @property
    def married(self):
        """The person is married"""
        return self._married

    @married.setter
    def married(self, newStatus):
        self._married = newStatus
        updateMarriedSet(self)

    @married.deleter
    def married(self):
        del self._married
        updateMarriedSet(self) 
```

我可以想象这可能有助于确保对 getMarriedPeople() 的访问在 O(1) 时间内运行，而不是在 O(1) 时间摊销。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-22T16:09:00.847

简单的方法是动态生成列表，例如@sr2222 的答案所示。

作为替代方案，您可以在每次`MAR_STATUS`更改时调用任意回调。如果实例是不可变的，或者在 setter 方法中创建属性[并](http://docs.python.org/library/functions.html#property)调用已注册的回调，则使用（请参阅特征库中的通知以`__new__`了解[更](http://code.enthought.com/projects/traits/)复杂的实现）。`Person``MAR_STATUS`

# perl - 如何制作/构建更大的 Selenium 测试套件？

> ID：10705350
> 
> 赞同：3
> 
> 时间：2012-05-22T15:39:26.143
> 
> 标签：perl, testing, selenium, automated-tests, test-suite

我正在为一套企业软件构建测试。我从 Test::WWW::Selenium 的作者那里得到的好建议是构建更大函数的例程，然后将它们参数化。所以我们有：add_user、post_blog 等等。然后可以丰富这些例程，以检查页面上是否出现了正确的文本等。这个软件是非常可配置的，我们有几十个站点，都不同。但是这些构建块可以串在一起，并在每个站点的基础上适当地修改驱动程序数据。

我在 Selenium 上发现的一切都是非常初学者，与构建更大的测试套件无关。除此之外还有什么吗？或者这是否尽可能好？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-23T04:02:12.287

很有可能运行大量的硒测试。在我的组织中，我们每天在多个网站上运行大约 200,000 到 300,000 次测试。所以是的，这是可能的。

注意：- 我用 JAVA 编码，下面的所有信息都是从 JAVA 的角度来看的。

要成功使用 selenium 进行大规模测试，我想说它需要 3 个基本组件

1.  基础设施
2.  一个好的框架和易于维护的代码
3.  简单明了的报告

**基础设施**

您的基础架构应该能够支持巨大的负载。我们使用 selenium 网格（如果您使用的是 Selenium 2，那么它被称为 Grid 2.0）来实现这一点。Selenium Grid 允许我们跨多个浏览器并行运行多个测试。我们使用我们自己的服务器，其中部署了虚拟机来支持此测试。有像 Saucelabs.com 这样的供应商，您可以将基础设施维护外包给他们。

**框架和测试代码**

您的框架必须支持多线程，并且使用 selenium 网格功能应该是线程安全的。我们使用 JAVA 来确保这种情况发生。[使用testNG](http://testng.org)并行运行测试。testNG 可以并行运行多个方法，所有这些测试都将指向一个 Hub。然后，集线器将针对连接到它的多个遥控器 (RC) 分发所有这些测试。

当您有大量测试时，维护是不可避免的。为了减少由于应用程序更改而导致的返工工作，最好遵循页面对象模型。页面对象本质上意味着 - 应用程序中的每个页面都应该在代码中具有相应的类。您将在此类中定义该页面中可能发生的所有元素和功能。这是一个非常模块化和可重用的结构。你可以用谷歌搜索 pageobject 模型，你会发现很多文章。

**报告**

每天运行 200,000 次测试非常棒，但是如果您无法以易于访问的方法展示失败和通过的内容，那么您的自动化测试将没有多大用处。有多种方法可以做到这一点。从 HTML 报告到构建自定义仪表板以显示结果。

一旦所有这些都到位，那么您唯一需要的就是保持这些测试连续运行的工具。您可以使用任何 CI（持续集成）工具来实现这一点。[Jenkins](http://jenkins-ci.org/)、 Hudson 、 Cruisecontrol 是少数几个最常用的 CI 工具。

# winforms - 启动默认网络浏览器，但如果 URL 已经打开，则不启动

> ID：10705353
> 
> 赞同：3
> 
> 时间：2012-05-22T15:39:32.410
> 
> 标签：winforms, browser, launching-application

我的应用程序 UI 上有一个链接，该链接使用`System.Diagnostics.Process.Start()`. 如果用户多次单击该链接，则会打开多个选项卡。

有没有办法，也许是一个命令行选项，仍然使用默认的网络浏览器，但如果 URL 已经打开，它只是重新打开同一个选项卡？如果它不能与所有可能的浏览器一起使用，那会很好，但如果它至少可以与 IE、Firefox 和 Chrome 一起使用，那就太好了。

我对此表示怀疑，但由于我没有看到关于这个主题的任何其他问题/答案，我想我会问。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T02:28:10.387

这在某种程度上是一种解决方法，但它可能会让您入门。我使用了 System.Diagnostics.Process.ProcessId。作为一个我使用 IE 的例子，我稍后会解释我为什么这样做。代码只是“又快又脏”，但我只是将其作为概念证明。

我用一个按钮创建了一个基本的 WinForm 应用程序，可以在 IE 中打开谷歌，如果它已经被应用程序打开，它将不会再次打开。

我添加了 System.Diagnostics 参考。

```
 public int ProcessID;
    public Form1()
    {
        InitializeComponent();
    }
    private void MyButton_Click(object sender, EventArgs e)
    {
        if (ProcessID == null)
        {
            StartIE();
        }
        else
        {
            if (!ProcessIsRunning())
            {
                StartIE();
            }
        }
    }
    private bool ProcessIsRunning()
    {
        bool ProcessRunning = false;
        foreach (Process p in Process.GetProcesses())
        {
            try
            {
                if (p.Id == ProcessID)
                {
                    ProcessRunning = true;
                }
            }
            catch { }
        }
        return ProcessRunning;
    }
    private void StartIE()
    {
        System.Diagnostics.Process proc = new System.Diagnostics.Process();
        proc.StartInfo.FileName = "iexplore.exe";
        proc.StartInfo.Arguments = "http://www.google.be";
        proc.Start();
        ProcessID = proc.Id;
    } 
```

这并不能完全满足您的要求，但它可能是一个好的开始。我这样做有几个原因以及可能的选择是什么..

*   如果您将 url 用作文件名，它确实会在默认浏览器中打开网页，但它不会返回 processID。这就是为什么片段显示了 IE 的使用。（如果您要使用此选项，您可以使用 System.IO.File.Exists 来确保安装了所需的浏览器）
*   如果您想使用此选项，您可以查询注册表以获取默认浏览器是什么，如果您有，您可以从注册表中获得的值启动它。如果您随后将 process.startinfo.filename 更改为此值，那么您将启动默认浏览器，但您仍将获得一个 processId，因此这可能是前进的方向。您可以在此处查看如何执行此操作：http: [//social.msdn.microsoft.com/Forums/en/netfxbcl/thread/b200903e-ce69-4bd4-a436-3e20a7632dc4](http://social.msdn.microsoft.com/Forums/en/netfxbcl/thread/b200903e-ce69-4bd4-a436-3e20a7632dc4)
*   如果 Internet 窗口已经打开，则显示它，可以通过使用 SetForegroundWindow 属性来完成。由于这已在[本文中](https://stackoverflow.com/questions/3032170/how-to-hide-show-a-process-using-c)记录，因此我没有在此代码段中添加它。

我希望这有助于您顺利上路。

# python - 在 Python 中，`datetime.datetime.now()` 是如何成为“不知道”的日期时间对象的？

> ID：10705360
> 
> 赞同：3
> 
> 时间：2012-05-22T15:39:57.250
> 
> 标签：python, python-datetime

显然，`pytz.UTC.localize(datetime.datetime.now())`在将当前时间与其他“幼稚”时间对象进行比较之前，我必须先运行。

这是为什么？当前时间与特定时区无关吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T00:50:39.100

```
>>> datetime.datetime.now().utcoffset() is None
True 
```

该`now`函数确实返回了一个天真的对象。它包含根据区域设置填充的日期和时间字段值。这就是提供单独的原因`utcnow`；这总是为您提供 UTC 字段值（尽管它仍然很幼稚）。

# java - 如何在 DragAndDrop 期间在 Main-JTable 上绘制 RowHeader-JTable 的 Dropline？

> ID：10705361
> 
> 赞同：14
> 
> 时间：2012-05-22T15:39:57.407
> 
> 标签：java, swing, user-interface, drag-and-drop, jtable

我在 JScrollPane 的视口中使用第二个 JTable 来为主表构建 RowHeader。主表上的 DragAndDrop 被禁用。在行头表上启用了 DnD。

如果用户启动了对行标题的拖动，我想将绘制的行标题下拉线（图像中的黑线）扩展到主表（如图像中的绿线）。

![主表的dropline](../Images/2035268b29321f170f5ad149410c2434.png)

有人对我有什么建议吗？
这是SSCCE：

```
import java.awt.Component;
import java.awt.EventQueue;
import java.awt.Font;
import java.awt.datatransfer.StringSelection;
import java.awt.datatransfer.Transferable;
import java.beans.PropertyChangeEvent;
import java.beans.PropertyChangeListener;
import javax.swing.DropMode;
import javax.swing.JComponent;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JScrollPane;
import javax.swing.JTable;
import javax.swing.JViewport;
import javax.swing.TransferHandler;
import javax.swing.UIManager;
import javax.swing.event.ChangeEvent;
import javax.swing.event.ChangeListener;
import javax.swing.table.DefaultTableCellRenderer;
import javax.swing.table.JTableHeader;
import javax.swing.table.TableColumn;

public class DNDLinePainterExampleMain extends JFrame {

  public DNDLinePainterExampleMain() {
    JTable mainTable = new JTable(4, 3);
    mainTable.setAutoResizeMode(JTable.AUTO_RESIZE_OFF);

    JTable rowTable = new RowHeaderTable(mainTable);
    rowTable.setAutoscrolls(true);
    rowTable.setDragEnabled(true);
    rowTable.setTransferHandler(new RowHeaderTransferHandler());
    rowTable.setDropMode(DropMode.INSERT_ROWS);

    JScrollPane scrollPane = new JScrollPane(mainTable);
    scrollPane.setRowHeaderView(rowTable);
    scrollPane.setCorner(JScrollPane.UPPER_LEFT_CORNER,
        rowTable.getTableHeader());
    this.add(scrollPane);
  }

  public static void main(String[] args) {
    EventQueue.invokeLater(new Runnable() {
      @Override
      public void run() {
        JFrame f = new DNDLinePainterExampleMain();
        f.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        f.pack();
        f.setVisible(true);
      }
    });
  }

  /*
   * Use a JTable as a renderer for row numbers of a given main table. This
   * table must be added to the row header of the scrollpane that contains the
   * main table. from:
   * http://tips4java.wordpress.com/2008/11/18/row-number-table/
   */
  public class RowHeaderTable extends JTable implements ChangeListener,
      PropertyChangeListener {

    private final JTable table;

    public RowHeaderTable(JTable table) {
      this.table = table;
      table.addPropertyChangeListener(this);

      setFocusable(false);
      setAutoCreateColumnsFromModel(false);

      updateRowHeight();
      updateModel();
      updateSelectionModel();

      TableColumn column = new TableColumn();
      column.setHeaderValue("");
      addColumn(column);
      column.setCellRenderer(new RowNumberRenderer());

      getColumnModel().getColumn(0).setPreferredWidth(50);
      setPreferredScrollableViewportSize(getPreferredSize());

      getTableHeader().setReorderingAllowed(false);
    }

    @Override
    public void addNotify() {
      super.addNotify();
      Component c = getParent();
      // Keep scrolling of the row table in sync with the main table.
      if (c instanceof JViewport) {
        JViewport viewport = (JViewport) c;
        viewport.addChangeListener(this);
      }
    }

    /*
     * Delegate method to main table
     */
    @Override
    public int getRowCount() {
      return table.getRowCount();
    }

    @Override
    public int getRowHeight(int row) {
      return table.getRowHeight(row);
    }

    /*
     * This table does not use any data from the main TableModel, so just return
     * a value based on the row parameter.
     */
    @Override
    public Object getValueAt(int row, int column) {
      return Integer.toString(row + 1);
    }

    /*
     * Don't edit data in the main TableModel by mistake
     */
    @Override
    public boolean isCellEditable(int row, int column) {
      return false;
    }

    // implements ChangeListener
    @Override
    public void stateChanged(ChangeEvent e) {
      // Keep the scrolling of the row table in sync with main table
      JViewport viewport = (JViewport) e.getSource();
      JScrollPane scrollPane = (JScrollPane) viewport.getParent();
      scrollPane.getVerticalScrollBar().setValue(viewport.getViewPosition().y);
    }

    // implements PropertyChangeListener
    @Override
    public void propertyChange(PropertyChangeEvent e) {
      // Keep the row table in sync with the main table
      if ("rowHeight".equals(e.getPropertyName()))
        updateRowHeight();

      if ("selectionModel".equals(e.getPropertyName()))
        updateSelectionModel();

      if ("model".equals(e.getPropertyName()))
        updateModel();
    }

    private void updateRowHeight() {
      setRowHeight(table.getRowHeight());
    }

    private void updateModel() {
      setModel(table.getModel());
    }

    private void updateSelectionModel() {
      setSelectionModel(table.getSelectionModel());
    }

    /*
     * Borrow the renderer from JDK1.4.2 table header
     */
    private class RowNumberRenderer extends DefaultTableCellRenderer {

      public RowNumberRenderer() {
        setHorizontalAlignment(JLabel.CENTER);
      }

      @Override
      public Component getTableCellRendererComponent(JTable table,
          Object value, boolean isSelected, boolean hasFocus, int row,
          int column) {
        if (table != null) {
          JTableHeader header = table.getTableHeader();

          if (header != null) {
            setForeground(header.getForeground());
            setBackground(header.getBackground());
            setFont(header.getFont());
          }
        }

        if (isSelected) {
          setFont(getFont().deriveFont(Font.BOLD));
        }

        setText((value == null) ? "" : value.toString());
        setBorder(UIManager.getBorder("TableHeader.cellBorder"));

        return this;
      }
    }//class RowNumberRenderer

  }//class RowHeaderTable

  public class RowHeaderTransferHandler extends TransferHandler {

    @Override
    public int getSourceActions(JComponent c) {
      return COPY_OR_MOVE;
    }

    @Override
    protected Transferable createTransferable(JComponent c) {
      return new StringSelection(c.getName());
    }

    @Override
    public boolean canImport(TransferSupport supp) {
      return true;
    }
  }//class RowHeaderTransferHandler

}//class DNDLinePainterExampleMain 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-30T13:33:34.773

感谢 naugler、Xeon 和 Boro 的巨大贡献，我现在结合使用他们的 3 个示例。它看起来像这样：

![决赛桌dropline](../Images/ab6d5a0a1a42661d25bc4c93a8c2d1ae.png)

这是代码：

```
import java.awt.AlphaComposite;
import java.awt.Color;
import java.awt.Component;
import java.awt.EventQueue;
import java.awt.Font;
import java.awt.Graphics;
import java.awt.Graphics2D;
import java.awt.Rectangle;
import java.awt.datatransfer.StringSelection;
import java.awt.datatransfer.Transferable;
import java.beans.PropertyChangeEvent;
import java.beans.PropertyChangeListener;
import javax.swing.DropMode;
import javax.swing.JComponent;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JPanel;
import javax.swing.JScrollPane;
import javax.swing.JTable;
import javax.swing.JTable.DropLocation;
import javax.swing.JViewport;
import javax.swing.RootPaneContainer;
import javax.swing.SwingUtilities;
import javax.swing.TransferHandler;
import javax.swing.UIManager;
import javax.swing.event.ChangeEvent;
import javax.swing.event.ChangeListener;
import javax.swing.table.DefaultTableCellRenderer;
import javax.swing.table.JTableHeader;
import javax.swing.table.TableColumn;

public class DNDLinePainterSolutionMain
{
  public static void main(String[] args)
  {
    EventQueue.invokeLater(new Runnable()
    {
      @Override
      public void run()
      {
        JFrame f = new MainFrame();
        f.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        f.pack();
        f.setVisible(true);
      }
    });
  }
}//public class DNDLinePainterSolutionMain

class MainFrame extends JFrame
{
  public MainFrame()
  {
    JTable mainTable = new JTable(4, 3);
    mainTable.setAutoResizeMode(JTable.AUTO_RESIZE_OFF);

    JTable rowTable = new RowHeaderTable(mainTable);
    rowTable.setAutoscrolls(true);
    rowTable.setDragEnabled(true);
    rowTable.setTransferHandler(new RowHeaderTransferHandler());
    rowTable.setDropMode(DropMode.INSERT_ROWS);

    //install the DropLocation-Extension:
    rowTable.addPropertyChangeListener("dropLocation",
        new DropLocationRepainter(this));

    JScrollPane scrollPane = new JScrollPane(mainTable);
    scrollPane.setRowHeaderView(rowTable);
    scrollPane.setCorner(JScrollPane.UPPER_LEFT_CORNER,
        rowTable.getTableHeader());
    this.add(scrollPane);
  }
}//class MainFrame

class RowHeaderTransferHandler extends TransferHandler
{
  @Override
  public int getSourceActions(JComponent c)
  {
    return COPY_OR_MOVE;
  }

  @Override
  protected Transferable createTransferable(JComponent c)
  {
    return new StringSelection(c.getName());
  }

  @Override
  public boolean canImport(TransferSupport supp)
  {
    return true;
  }
}//class RowHeaderTransferHandler

/**
 * Listens to a dropLocation-PropertyChange and repaints the DropLine.
 */
class DropLocationRepainter implements PropertyChangeListener
{
  private static RowHeaderDropLineGlassPane glassPane;
  private final RootPaneContainer           rootPaneContainer;

  public DropLocationRepainter(RootPaneContainer dndLinePainterSolutionMain)
  {
    this.rootPaneContainer = dndLinePainterSolutionMain;
  }

  @Override
  public void propertyChange(PropertyChangeEvent pce)
  {
    String propertyName = pce.getPropertyName();
    if ("dropLocation".equals(propertyName) && pce.getNewValue() != null)
    {
      if (glassPane == null)
      {
        rootPaneContainer.getRootPane().setGlassPane(
            glassPane = new RowHeaderDropLineGlassPane((RowHeaderTable) pce
                .getSource()));
      }
      rootPaneContainer.getRootPane().getGlassPane().setVisible(true);

      repaintDropLocation(((JTable) pce.getSource()).getDropLocation());
    }
    else
      if ("dropLocation".equals(propertyName))
        rootPaneContainer.getRootPane().getGlassPane().setVisible(false);
  }

  private void repaintDropLocation(DropLocation loc)
  {
    Component c = rootPaneContainer.getRootPane().getGlassPane();
    if (c instanceof RowHeaderDropLineGlassPane)
    {
      RowHeaderDropLineGlassPane glassPane = (RowHeaderDropLineGlassPane) c;
      glassPane.repaint();
    }
  }
}//class DropLocationRepainter

class RowHeaderDropLineGlassPane extends JPanel
{
  private RowHeaderTable table;

  public RowHeaderDropLineGlassPane(RowHeaderTable table)
  {
    this.table = table;
    setOpaque(false);
  }

  @Override
  public void paintComponent(Graphics g)
  {
    Graphics2D g2 = (Graphics2D) g;
    g2.setComposite(AlphaComposite.getInstance(AlphaComposite.SRC_OVER, 0.3f));
    Rectangle rect = table.getDropLineRect();
    if (rect != null)
    {
      Rectangle r = SwingUtilities.convertRectangle(table, rect, this);
      g2.setColor(new Color(40, 80, 0));
      g2.fill(r);
    }
  }
}//class RowHeaderDropLineGlassPane

/**
 * Use a JTable as a renderer for row numbers of a given main table. This table
 * must be added to the row header of the scrollpane that contains the main
 * table. From: http://tips4java.wordpress.com/2008/11/18/row-number-table/
 * <p>
 * Added {@code getDropLineRect()} for DropLine extension over the maintable.
 * </p>
 */
class RowHeaderTable extends JTable implements ChangeListener,
    PropertyChangeListener
{

  private final JTable mainTable;

  public RowHeaderTable(JTable mainTable)
  {
    this.mainTable = mainTable;
    mainTable.addPropertyChangeListener(this);

    setFocusable(false);
    setAutoCreateColumnsFromModel(false);

    updateRowHeight();
    updateModel();
    updateSelectionModel();

    TableColumn column = new TableColumn();
    column.setHeaderValue("");
    addColumn(column);
    column.setCellRenderer(new RowNumberRenderer());

    getColumnModel().getColumn(0).setPreferredWidth(50);
    setPreferredScrollableViewportSize(getPreferredSize());

    getTableHeader().setReorderingAllowed(false);
  }

  /*
   * called from the class RowHeaderDropLineGlassPane
   */
  public Rectangle getDropLineRect()
  {
    DropLocation loc = getDropLocation();
    if (loc == null /* || !loc.isDropable() */)
      return null;

    final Rectangle lineRect = new Rectangle();

    int index = loc.getRow();
    if (index < 0)
    {
      lineRect.setRect(0, 0, 0, 0);
      return null;
    }

    Rectangle r = getCellRect(index, 0, true);
    if (index == getRowCount())
      r.height = getCellRect(index - 1, 0, true).height;//if the last line is the DropTarget a height of 0 (of a non-existing Cell after the last row) is returned.

    lineRect.setRect(r.x, r.y - (r.height / 4d), getVisibleRect().width
        + mainTable.getWidth(), r.height / 2d - 1);
    return lineRect;
  }

  @Override
  public void addNotify()
  {
    super.addNotify();
    Component c = getParent();
    // Keep scrolling of the row table in sync with the main table.
    if (c instanceof JViewport)
    {
      JViewport viewport = (JViewport) c;
      viewport.addChangeListener(this);
    }
  }

  /*
   * Delegate method to main table
   */
  @Override
  public int getRowCount()
  {
    return mainTable.getRowCount();
  }

  @Override
  public int getRowHeight(int row)
  {
    return mainTable.getRowHeight(row);
  }

  /*
   * This table does not use any data from the main TableModel, so just return a
   * value based on the row parameter.
   */
  @Override
  public Object getValueAt(int row, int column)
  {
    return Integer.toString(row + 1);
  }

  /*
   * Don't edit data in the main TableModel by mistake
   */
  @Override
  public boolean isCellEditable(int row, int column)
  {
    return false;
  }

  // implements ChangeListener
  @Override
  public void stateChanged(ChangeEvent e)
  {
    // Keep the scrolling of the row table in sync with main table
    JViewport viewport = (JViewport) e.getSource();
    JScrollPane scrollPane = (JScrollPane) viewport.getParent();
    scrollPane.getVerticalScrollBar().setValue(viewport.getViewPosition().y);
  }

  // implements PropertyChangeListener
  @Override
  public void propertyChange(PropertyChangeEvent e)
  {
    // Keep the row table in sync with the main table
    if ("rowHeight".equals(e.getPropertyName()))
      updateRowHeight();

    if ("selectionModel".equals(e.getPropertyName()))
      updateSelectionModel();

    if ("model".equals(e.getPropertyName()))
      updateModel();
  }

  private void updateRowHeight()
  {
    setRowHeight(mainTable.getRowHeight());
  }

  private void updateModel()
  {
    setModel(mainTable.getModel());
  }

  private void updateSelectionModel()
  {
    setSelectionModel(mainTable.getSelectionModel());
  }

  /*
   * Borrow the renderer from JDK1.4.2 table header
   */
  private class RowNumberRenderer extends DefaultTableCellRenderer
  {
    public RowNumberRenderer()
    {
      setHorizontalAlignment(JLabel.CENTER);
    }

    @Override
    public Component getTableCellRendererComponent(JTable table, Object value,
        boolean isSelected, boolean hasFocus, int row, int column)
    {
      if (table != null)
      {
        JTableHeader header = table.getTableHeader();

        if (header != null)
        {
          setForeground(header.getForeground());
          setBackground(header.getBackground());
          setFont(header.getFont());
        }
      }

      if (isSelected)
        setFont(getFont().deriveFont(Font.BOLD));

      setText((value == null) ? "" : value.toString());
      setBorder(UIManager.getBorder("TableHeader.cellBorder"));

      return this;
    }
  }//class RowNumberRenderer

}//class RowHeaderTable 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-24T20:47:44.040

好吧。忏悔时间。这是一些粗糙、生硬的仪器代码。对于无法产生更优雅或更干净的解决方案，我深表歉意。我是深邃黑暗的秋千地牢中的 1 级游客。

此自定义代码属于快速而肮脏的类别。它不适用于列，我不确定所有边缘情况，并且我不知道在绘制例程中间窃取另一个组件图形上下文的规则。底线：这是一个示例，而不是完整的解决方案。

因为您使用单独的表格进行拖放（您的 rowTable），所以该表格没有很好的方法可以绘制到 mainTable。应该注意的是，可能有一个光滑而闪亮的路径使用 PropertyChangeListeners 或其他东西来触发 mainTable 的事件，但我没有管理它。这是[BasicTableUI](http://docs.oracle.com/javase/6/docs/api/javax/swing/plaf/basic/BasicTableUI.html)的自定义扩展：

```
public class ExtendedDropLineTableUI extends BasicTableUI {

        private JTable drawTable;
        private Integer oldRow;

        //We give this UI instance a reference to a separate table for drawing
        public ExtendedDropLineTableUI(JTable drawTable) {
            this.drawTable = drawTable;
        }

        @Override
        public void paint(Graphics g, JComponent c) {
            super.paint(g, c);
            paintExtendedDropLine();
        }

        private void paintExtendedDropLine() {
            JTable.DropLocation loc = table.getDropLocation();
            if (loc == null) {
                drawTable.repaint();
                return;
            }

            //get the correct line color. no color? no line!
            Color color = UIManager.getColor("Table.dropLineColor");
            if (color == null) {
                return;
            }

            //try to repaint the draw table only if the row changes
            if (oldRow != null && oldRow != loc.getRow()) {
                drawTable.repaint();
            }
            oldRow = loc.getRow();
            //get location of cell rectangle
            int row = loc.getRow();
            int col = loc.getColumn();
            if (col >= table.getColumnCount()) {
                col--;
            }
            Rectangle rect = table.getCellRect(row, col, true);
            //adjust rectangle to fit between the cells
            if (rect.y == 0) {
                rect.y = -1;
            } else {
                rect.y -= 2;
            }
            //what's a line but a really thin rectangle?
            rect.height = 3;
            //extend the rectangle to the width of the drawing table
            rect.width = drawTable.getWidth();
            //draw the rectangle
            Graphics g = drawTable.getGraphics();
            g.setColor(color);
            g.fillRect(rect.x, rect.y, rect.width, rect.height);
        }
    }
} 
```

您需要将此 UI 提供给您的 rowTable，以便它可以绘制到 mainTable，如下所示：

```
rowTable.setUI(new ExtendedDropLineTableUI(mainTable)); 
```

我严重依赖实际[源代码](http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/6-b14/javax/swing/plaf/basic/BasicTableUI.java#BasicTableUI.paintDropLines%28java.awt.Graphics%29)来劫持下降线的绘制，因为有关这些东西的方法都是私有的。

**编辑**： *我忘了顺便提一下，我担心你可能试图通过拖动 rowTable 中的单元格来重新排列 mainTable 中的整行。该解决方案也没有考虑到这一点，它只是划清界限。为此，您确实需要一个更优雅的解决方案，或者一个使 mainTable 中的行与 rowTable 保持同步的检查。*

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-05-25T14:08:48.937

我的解决方案使用了一种稍微不同的方法，因为我们想在现有组件之上添加一些自定义绘画。因此，我选择在`GlassPane`那里使用并进行绘画。通过这种方式，您可以想象到所有亮点，并且它的大小不限于单元格大小，因为它可能是使用例如单元格渲染器的方法。

要运行此示例，您需要从[该`FinalGlassPane`站点](http://weblogs.java.net/blog/alexfromsun/archive/2006/09/a_wellbehaved_g.html)下载。它是必需的，因为我们使用它的功能来捕获事件（通常`GlassPane`会被消耗）。如果您知道在拖动最终结束时捕获事件的不同方法，则可以完全避免。**如果你知道一个，请分享。**对我来说，这效果最好，而且我喜欢有一个`GlassPane`可以捕获事件并且不会全部消耗它们的东西。

```
import java.awt.*;
import java.awt.datatransfer.StringSelection;
import java.awt.datatransfer.Transferable;
import java.awt.dnd.*;
import java.awt.event.AWTEventListener;
import java.awt.event.MouseEvent;
import java.beans.PropertyChangeEvent;
import java.beans.PropertyChangeListener;
import javax.swing.*;
import javax.swing.event.ChangeEvent;
import javax.swing.event.ChangeListener;
import javax.swing.table.DefaultTableCellRenderer;
import javax.swing.table.JTableHeader;
import javax.swing.table.TableColumn;

public class DNDLinePainterExampleMain extends JFrame {

    public int x = -1;
    public int y = -1;
    private boolean isDragged = false;
    public FinalGlassPane glassPane;
    private boolean isOutsideTable = false;

    public DNDLinePainterExampleMain() {
        final JTable mainTable = new JTable(4, 3);
        mainTable.setAutoResizeMode(JTable.AUTO_RESIZE_OFF);

        final JTable rowTable = new RowHeaderTable(mainTable);
        rowTable.setAutoscrolls(true);
        rowTable.setDragEnabled(true);
        rowTable.setTransferHandler(new RowHeaderTransferHandler());
        rowTable.setDropMode(DropMode.INSERT_ROWS);
        final JScrollPane scrollPane = new JScrollPane(mainTable);
        scrollPane.setRowHeaderView(rowTable);
        scrollPane.setCorner(JScrollPane.UPPER_LEFT_CORNER,
                rowTable.getTableHeader());

        final JPanel panel = new JPanel();

        DragSourceMotionListener dsml = new DragSourceMotionListener() {

            @Override
            public void dragMouseMoved(DragSourceDragEvent dsde) {
                isDragged = true;
                isOutsideTable = true;
                Component source = dsde.getDragSourceContext().getComponent();
                //the coordinates of the drag event in screen coords
                Point toConvert = new Point(dsde.getX(), dsde.getY());
                //convert to source coords
                SwingUtilities.convertPointFromScreen(toConvert, source);
                int rowMargin = rowTable.getRowMargin();
                Point toTest = new Point(toConvert.x, toConvert.y);
                for (int i = 0; i < rowTable.getRowCount(); i++) {
                    Rectangle bounds = rowTable.getCellRect(i, 0, true);
                    boolean isIn = bounds.contains(toTest);
//                    System.out.println("bounds = "+bounds+";  rowMargin = "+rowMargin+";  i = "+i+";  isIn = "+isIn);
                    if (isIn) {
                        isOutsideTable = false;
                        int hHalf = bounds.height / 2;
                        int hIn = toTest.y - bounds.y;
                        boolean isTop = false;
                        if (hIn < hHalf) {
                            isTop = true;
                        }
                        x = bounds.width;
                        y = bounds.y - rowMargin;
                        if (!isTop) {
                            y += bounds.height;
                        }
                        //now convert the point to the glass pane coordinates
                        Point c = SwingUtilities.convertPoint(rowTable, x, y, glassPane);
                        x = c.x;
                        y = c.y;
//                        System.out.println("hIn = "+hIn+";  isTop = "+isTop + "");
                    }
                }
                glassPane.repaint();
            }
        };
        DragSource ds = new DragSource();
        ds.addDragSourceMotionListener(dsml);

        this.setContentPane(panel);
        panel.add(new JButton("Oi for testing"));
        panel.add(scrollPane);

        DragSource dragSource = DragSource.getDefaultDragSource();
        dragSource.addDragSourceMotionListener(dsml);
        glassPane = new FinalGlassPane(this) {

            @Override
            public void eventDispatched(AWTEvent event) {
                super.eventDispatched(event);
                if (event instanceof MouseEvent) {
                    //after drag is relesed we are back here with mouse entered event
                    if (isDragged) {
                        isDragged = false;
                        repaint();
                    }
                }
            }

            @Override
            protected void paintComponent(Graphics g) {
                Graphics2D g2 = (Graphics2D) g;
                if (isDragged && !isOutsideTable) {
                    g2.setPaint(Color.GREEN);
                    g2.drawLine(x + 2, y + 1, x + mainTable.getWidth() - 4, y + 1);
                    g2.drawLine(x, y, x + mainTable.getWidth(), y);
                    g2.drawLine(x + 2, y - 1, x + mainTable.getWidth() - 4, y - 1);
                }
            }
        };
        AWTEventListener al = (AWTEventListener) glassPane;
        Toolkit.getDefaultToolkit().addAWTEventListener(al,
                AWTEvent.MOUSE_MOTION_EVENT_MASK | AWTEvent.MOUSE_EVENT_MASK);

        this.setGlassPane(glassPane);
        glassPane.setVisible(true);
    }

    public static void main(String[] args) {
        EventQueue.invokeLater(new Runnable() {

            @Override
            public void run() {
                JFrame f = new DNDLinePainterExampleMain();
                f.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                f.pack();
                f.setVisible(true);
            }
        });
    }

    /*
     * Use a JTable as a renderer for row numbers of a given main table. This
     * table must be added to the row header of the scrollpane that contains the
     * main table. from:
     * http://tips4java.wordpress.com/2008/11/18/row-number-table/
     */
    public class RowHeaderTable extends JTable implements ChangeListener,
            PropertyChangeListener {

        private final JTable table;

        public RowHeaderTable(JTable table) {
            this.table = table;
            table.addPropertyChangeListener(this);

            setFocusable(false);
            setAutoCreateColumnsFromModel(false);

            updateRowHeight();
            updateModel();
            updateSelectionModel();

            TableColumn column = new TableColumn();
            column.setHeaderValue("");
            addColumn(column);
            column.setCellRenderer(new RowNumberRenderer());

            getColumnModel().getColumn(0).setPreferredWidth(50);
            setPreferredScrollableViewportSize(getPreferredSize());

            getTableHeader().setReorderingAllowed(false);
        }

        @Override
        public void addNotify() {
            super.addNotify();
            Component c = getParent();
            // Keep scrolling of the row table in sync with the main table.
            if (c instanceof JViewport) {
                JViewport viewport = (JViewport) c;
                viewport.addChangeListener(this);
            }
        }

        /*
         * Delegate method to main table
         */
        @Override
        public int getRowCount() {
            return table.getRowCount();
        }

        @Override
        public int getRowHeight(int row) {
            return table.getRowHeight(row);
        }

        /*
         * This table does not use any data from the main TableModel, so just
         * return a value based on the row parameter.
         */
        @Override
        public Object getValueAt(int row, int column) {
            return Integer.toString(row + 1);
        }
        /*
         * Don't edit data in the main TableModel by mistake
         */

        @Override
        public boolean isCellEditable(int row, int column) {
            return false;
        }
        // implements ChangeListener

        @Override
        public void stateChanged(ChangeEvent e) {
            // Keep the scrolling of the row table in sync with main table
            JViewport viewport = (JViewport) e.getSource();
            JScrollPane scrollPane = (JScrollPane) viewport.getParent();
            scrollPane.getVerticalScrollBar().setValue(viewport.getViewPosition().y);
        }
        // implements PropertyChangeListener

        @Override
        public void propertyChange(PropertyChangeEvent e) {
            // Keep the row table in sync with the main table
            if ("rowHeight".equals(e.getPropertyName())) {
                updateRowHeight();
            }

            if ("selectionModel".equals(e.getPropertyName())) {
                updateSelectionModel();
            }

            if ("model".equals(e.getPropertyName())) {
                updateModel();
            }
        }

        private void updateRowHeight() {
            setRowHeight(table.getRowHeight());
        }

        private void updateModel() {
            setModel(table.getModel());
        }

        private void updateSelectionModel() {
            setSelectionModel(table.getSelectionModel());
        }
        /*
         * Borrow the renderer from JDK1.4.2 table header
         */

        private class RowNumberRenderer extends DefaultTableCellRenderer {

            public RowNumberRenderer() {
                setHorizontalAlignment(JLabel.CENTER);
            }

            @Override
            public Component getTableCellRendererComponent(JTable table,
                    Object value, boolean isSelected, boolean hasFocus, int row,
                    int column) {
                if (table != null) {
                    JTableHeader header = table.getTableHeader();

                    if (header != null) {
                        setForeground(header.getForeground());
                        setBackground(header.getBackground());
                        setFont(header.getFont());
                    }
                }
                if (isSelected) {
                    setFont(getFont().deriveFont(Font.BOLD));
                }
                setText((value == null) ? "" : value.toString());
                setBorder(UIManager.getBorder("TableHeader.cellBorder"));
                return this;
            }
        }//class RowNumberRenderer
    }//class RowHeaderTable

    public class RowHeaderTransferHandler extends TransferHandler {

        @Override
        public int getSourceActions(JComponent c) {
            return COPY_OR_MOVE;
        }

        @Override
        protected Transferable createTransferable(JComponent c) {
            return new StringSelection(c.getName());
        }

        @Override
        public boolean canImport(TransferSupport supp) {
            return true;
        }
    }//class RowHeaderTransferHandler
} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-05-24T21:02:29.213

我建议你这样做（使用 Swing 的拖放功能）：

```
 RowHeaderTable rowTable = new RowHeaderTable(mainTable);
    rowTable.setAutoscrolls(true);
    rowTable.setDragEnabled(true);
    rowTable.setTransferHandler(new RowHeaderTransferHandler(mainTable));
    rowTable.setDropMode(DropMode.INSERT_ROWS);
    try {
        DropTarget dropTarget = rowTable.getDropTarget();
        dropTarget.addDropTargetListener(rowTable);
    }
    catch(TooManyListenersException e) {
        e.printStackTrace();
    } 
```

现在你必须实现`DropTargetListener`：

```
public class RowHeaderTable extends JTable implements ChangeListener, PropertyChangeListener, DropTargetListener { 
```

这些是您应该感兴趣的两种方法：

```
 @Override
    public void dragEnter(DropTargetDragEvent dtde) { shouldPaint = true }

    @Override
    public void dragExit(DropTargetEvent dte) { shouldPaint = false } 
```

现在您应该`mainTable`使用您的 TranserHandler 操作您的（以绘制这条“绿线”）：

```
 @Override
    public boolean canImport(TransferSupport supp) {
        DropLocation location = supp.getDropLocation();
        if(location instanceof javax.swing.JTable.DropLocation && shouldPaint) {
            javax.swing.JTable.DropLocation tableLocation = (javax.swing.JTable.DropLocation) location;
            int rowToInsert = tableLocation.getRow();
            //paint somehow the "green line"
            //remember that canImport is invoked when you move your mouse
        }
        return true;
    } 
```

基本上你应该实现你自己的行渲染器或类似的东西（比如@naugler 的答案）。`shouldPaint`您还应该以某种方式为您的 TransferHandler提供布尔值。但这并不是什么大问题。

希望这可以帮助。

# extjs - ExtJS 4.1 停止 grid.Panel 关闭

> ID：10705362
> 
> 赞同：2
> 
> 时间：2012-05-22T15:39:58.407
> 
> 标签：extjs, extjs4.1

我有我查看扩展`Ext.grid.Panel`，我希望能够询问用户他是否真的想在单击 [X] 后关闭面板。我试过了

```
listeners: {
            beforedestroy: function() {
                               //console.log('In');
                return false;
            }
        }, 
```

但显然事情没那么简单。关于如何防止面板关闭的任何想法？

谢谢

勒龙

附言

这是我从 sencha 论坛得到的，尚未测试：

```
Ext.create( 'Ext.window.Window', {
    title: 'test',
    width: 200,
    height: 200,
    listeners: {
        beforeclose: function( window ) {
            Ext.Msg.confirm( 'Hey', 'Are you sure you want to close?', function( answer ) {
                if( answer == "yes" ) {
                    window.destroy();
                }
            } );
            return false;
        }
    }
} ).show(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T17:55:09.913

`beforeclose`事件应该工作。不？

更新：

如果您想进行一些用户交互（即确认问题或保存数据或类似的东西），那将有点棘手......

首先，在视图的构造函数中执行以下操作：

```
this.on('beforeclose', function() { 
   return this.myCloseHandler(function() { this.close(); }, this);
});
this.alreadyAsked = false; 
```

比创建处理程序：

```
myCloseHandler: function(callback, scope) {
    if (this.alreadyAsked === false) {
        this.alreadyAsked = true;
        Ext.MessageBox.show({
            msg: 'Are you sure?',
            fn: function(btn) {
               if (btn == 'yes')
                  Ext.callback(callback, scope);
               else 
                  this.alreadyAsked = false;   
            }
        });
        return false;

    }
    return true;   
} 
```

想法是 - 你立即返回 false 但有一些标志和条件在没有确认的情况下通过相同的逻辑。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-06T19:42:34.663

我使用的技术只是简单地隐藏窗口而不是默认销毁窗口并添加一个隐藏事件侦听器。这可以防止窗口中您想要阻止销毁的所有组件都被销毁。hide 事件是一个非常无辜的事件。然后 Ext.msg 来了，甚至可能只是在某种条件下。您对中断消息的响应完成了工作。否则不会造成任何伤害，因为返回 false。

```
var win = Ext.create('Ext.window.Window', {
       .... your window specs ...
       closeAction : 'hide',
       buttons : [{
            text    : 'Close',
            scope   : me,
            handler : function() {
                win.hide(); // not destroy !!! that comes later !!!
            }
        }],
        listeners : {
            scope  : me,
            'beforehide' : function(window) {
                if (some_condition == true) {
                    Ext.Msg.confirm( 'Confirm close of window', 'You really wanna close this window ?', function( answer ) {
                        if( answer == "yes" ) {
                            window.destroy();
                        }
                    });
                    return false;
                }

            },
            'destroy' : function(window) {
                  // do something after the window destruction //
                  alert('Another window smashed');
            }
        }
        ... rest of your window specs
  }); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-04T20:30:26.173

也许不需要重型建筑。以下对我来说很完美：

```
beforeclose: function(window) {
    Ext.Msg.confirm("Hey", "Are you sure you want to close?", function(answer) {
        if (answer == "yes") {
            window.events.beforeclose.clearListeners();
            window.close();
        }
    });
    return false;
} 
```

# c# - 如何访问一个窗口？

> ID：10705363
> 
> 赞同：3
> 
> 时间：2012-05-22T15:39:58.407
> 
> 标签：c#, .net, windows, handle

我正在尝试使用其句柄（即`System.IntPtr`值）访问特定窗口：

```
 // Getting the process of Visual Studio program
        var process = Process.GetProcessesByName("devenv")[0];

        // Showing the handle we've got, we've no problem
        MessageBox.Show(this, process.MainWindowHandle.ToString());

        // Attempting to get the main window object by its handle
        var wnd = NativeWindow.FromHandle(process.MainWindowHandle);

        // always fails
        if (wnd == null)
            MessageBox.Show("Failed");
        else
            MessageBox.Show(wnd.ToString(), "Yeeeeees!!"); 
```

我还尝试访问另一个演示 .net winforms 应用程序的主窗口，这是我为此目的而制作的（即我运行演示应用程序，并尝试通过该应用程序访问其主窗口），但也失败了，尽管两者演示和此应用程序是 .NET 应用程序。但是，这成功了：

```
 var process2 = Process.GetCurrentProcess();
        MessageBox.Show(this, process2.MainWindowHandle.ToString());

        var wnd2 = NativeWindow.FromHandle(process2.MainWindowHandle);
        if (wnd2 == null)
            MessageBox.Show("Failed");
        else
            MessageBox.Show(wnd2.ToString(), "Yes"); 
```

我认为这是有效的，因为它是从同一个应用程序调用的。那么，如何通过句柄访问另一个程序的窗口对象呢？我认为它可以`C\C++`通过使用头文件`<windows.h>`然后使用 P\invoke 来工作。

如果我不能，是否有另一种访问窗口的方法（即，而不是使用句柄）？

==================== **编辑**

我想处理整个窗口对象和它自己的控件

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T15:54:54.463

的文档[`NativeWindow.FromHandle`](http://msdn.microsoft.com/en-us/library/system.windows.forms.nativewindow.fromhandle.aspx)解释了为什么该函数总是`null`为您返回：

> 该句柄必须已经被当前进程中的另一个 NativeWindow 拥有；否则，返回 null。

但是您所针对的窗口处于不同的进程中。所以你根本不能`NativeWindow`在这里使用。您将不得不将窗口句柄用作`IntPtr`.

在您的编辑中，您声明：

> 我想处理整个窗口对象和它自己的控件

那没有任何改变。你不能使用`NativeWindow`. 您将不得不处理原始的 Win32 API。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-23T21:51:04.237

那么，正如雷蒙德建议的那样，您为什么不尝试使用自动化呢？`UIAutomationClient`添加一个包含对和的引用的控制台项目 `UIAutomationTypes`

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Windows.Automation;
using System.Diagnostics;
using System.Threading;

namespace ConsoleApplication
{
    class Program
    {
        static void Main(string[] args)
        {
            var pInfo = new ProcessStartInfo("notepad");

            var p = Process.Start(pInfo);

            p.WaitForInputIdle();

            AutomationElement installerEditorForm = AutomationElement.FromHandle(p.MainWindowHandle);

            // menus
            AutomationElementCollection menuBars = installerEditorForm.FindAll(TreeScope.Children, new PropertyCondition(
                AutomationElement.ControlTypeProperty, ControlType.MenuBar));

            var mainMenuItem = menuBars[0];

            AutomationElementCollection menus = mainMenuItem.FindAll(TreeScope.Children, new PropertyCondition(
                AutomationElement.ControlTypeProperty, ControlType.MenuItem));

            var fileMenuItem = menus[0];

            ExpandCollapsePattern fileMenuItemOpenPattern = (ExpandCollapsePattern)fileMenuItem.GetCurrentPattern(
                ExpandCollapsePattern.Pattern);

            fileMenuItemOpenPattern.Expand();

            AutomationElement fileMenuItemNew = fileMenuItem.FindFirst(TreeScope.Children,
                new AndCondition(
                    new PropertyCondition(AutomationElement.ControlTypeProperty, ControlType.MenuItem),
                    new PropertyCondition(AutomationElement.NameProperty, "New")));

            Console.Read();
        }
    }
} 
```

[参考](http://code.dblock.org/automating-win32-ui-testing-systemwindowsautomation-and-project-white)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-22T15:56:27.347

你想访问什么？您可以在 Windows 中获取窗口的标题和文本。但是你不能得到另一个应用程序的 NativeWindow 对象。您需要使用 windows API 与其他应用程序进行交互。我曾经在另一个应用程序中劫持了一个对象，但是通过知道它的类并发现了一个 hack 来找到它的 Idispatch 指针，你可以在[这里](http://www.planet-source-code.com/vb/scripts/ShowCode.asp?txtCodeId=74112&lngWId=1)查看它。下面是如何获取前台窗口的标题，希望对您有所帮助。

```
using System.Runtime.InteropServices;

using System.Text;

[DllImport("user32.dll")]
static extern IntPtr GetForegroundWindow();

[DllImport("user32.dll")]
static extern int GetWindowText(IntPtr hWnd, StringBuilder text, int count);

private string GetActiveWindowTitle()
{
    const int nChars = 256;
    IntPtr handle = IntPtr.Zero;
    StringBuilder Buff = new StringBuilder(nChars);
    handle = GetForegroundWindow();

    if (GetWindowText(handle, Buff, nChars) > 0)
    {
        return Buff.ToString();
    }
    return null;
} 
```

想我可以补充一下，如果你想子类化另一个应用程序的窗口，你应该看看我上面的链接。我相信唯一的方法是使用 DLL 注入和 windows 挂钩，在我的示例中举例[说明](http://www.planet-source-code.com/vb/scripts/ShowCode.asp?txtCodeId=74112&lngWId=1)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-22T15:49:32.963

没有得到你真正想要做的事情，但也许如果你尝试......

```
public class ApiUtils
{
    [DllImport("user32")]
    public static extern int SetForegroundWindow(IntPtr hwnd);

    [DllImport("user32.dll")]
    public static extern bool ShowWindow(IntPtr hWnd, ShowWindowCommand nCmdShow);

    [DllImport("user32.dll")]

    public static extern int GetForegroundWindow();

    public static void ActiveWindow(IntPtr hwnd)
    {
        if ((IntPtr)GetForegroundWindow() != hwnd)
        {
            ShowWindow(hwnd, ShowWindowCommand.ShowMaximized);
        }
    }

} 
```

现在叫它...

```
Process p = Process.Start(new ProcessStartInfo() { FileName = "someApp.exe"});

ApiUtils.ShowWindow(p.MainWindowHandle, WindowShowStyle.ShowNormal); 
```

如果不是对不起，没有很好地回答这个问题。

# objective-c - NSPopover 内的 NSTextField 不是关键，直到鼠标单击

> ID：10705369
> 
> 赞同：2
> 
> 时间：2012-05-22T15:40:15.533
> 
> 标签：objective-c, macos, cocoa, nswindow, nspopover

我有一个通过与 NSStatusItem 交互显示的 NSPopover。我在博客上写过我需要做的黑客攻击，以便在这种情况下进行输入：http: [//blog.brokenrobotllc.com/using-nspopover-with-nsstatusitem](http://blog.brokenrobotllc.com/using-nspopover-with-nsstatusitem)

我在 NSPopover 的内容视图中有一个 NSTextField。当我打开 NSPopover 时， NSTextField 看起来好像它是键（光标闪烁）。但是，在打字时，什么也没有出现。如果我在该字段中单击鼠标，我的输入开始显示在那里。

我尝试过在 popoverDidShow: 上调用 NSWindow 的 makeFirstResponder 之类的方法。行为没有因此而改变。有人在这里有什么想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-22T16:20:22.937

我的猜测是您需要激活您的应用程序；试着打电话

```
[NSApp activateIgnoringOtherApps:YES]; 
```

当你展示你的弹出框时。

编辑：当然，我可能是错的。这一切都在我的脑海中。

# jquery - 使用 Fancybox，如何在父窗口中打开链接（并关闭 Fancy Box）？

> ID：10705370
> 
> 赞同：4
> 
> 时间：2012-05-22T15:40:21.590
> 
> 标签：jquery, fancybox

我正在使用 Fancybox 打开一个弹出窗口，允许用户在两​​种不同的登录方式之间进行选择。我想单击 Fancybox 中的任何一个链接以关闭 fancybox 并在父网页中打开链接。

这可能吗？

这是我打开 FancyBox 盒子的方式：

```
 $("#logonChooser").click(function () {
             $.fancybox.open({
                 href: 'LogonChooser.html',
                 type: 'iframe',
                 padding: 5
             });
         }); 
```

这是 LogonChooser.html：

```
<head>LogonChooser.hmtl</head>
<body>
  <a href="LogInDatabase.html">Log In</a>
  <a href="LogInFacebook.html">Log In Facebook</a>
</body> 
```

我可以像这样关闭fancybox：

```
<a href="LogInDatabase.html" onclick="parent.$.fancybox.close();">Log In</a> 
```

但我没有在父页面中获得链接。我想单击其中一个链接以关闭fancybox并在产生fancybox的页面中打开链接，而不是在fancybox内部。

任何帮助表示赞赏。如果有帮助，我正在使用 Fancybox 2，但如果这更容易，我愿意使用以前的版本。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-22T15:51:16.743

将其添加到链接中就足够了：

```
target="_parent" 
```

现在链接页面会在父页面中打开，不需要关闭fancybox，因为fancybox会被替换（也是父页面的一部分）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T15:56:31.997

试试`$.fancybox.close`方法。

[http://fancybox.net/api](http://fancybox.net/api)

# plsql - 调用 PL/SQL 过程并循环通过 jython 中返回的 ref 游标

> ID：10705371
> 
> 赞同：0
> 
> 时间：2012-05-22T15:40:22.927
> 
> 标签：plsql, jython

我有一个这样定义的 PL/SQL 过程：

```
PROCEDURE get_rates(
                  in_last_sync_time  IN     TIMESTAMP                    
                 ,out_resultset      OUT    t_rates
                 ); 
```

我正在尝试从 jython 调用此过程并循环遍历作为 OUT 参数中的 ref 游标返回的结果，但我无法使其工作。

问候，

塞巴斯蒂安

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T10:46:26.757

对我来说有效（当然我还有其他程序名称）：

```
from java.sql import DriverManager, Types
...
proc = db.prepareCall("{ call revint(?,?) }")
proc.registerOutParameter(2, Types.INTEGER)
proc.setInt(1, arg1)
proc.execute()
n2 = proc.getInt(2) 
```

# ruby-on-rails - Ruby On Rails Active Admin has_many 更改下拉列表以使用不同的列

> ID：10705372
> 
> 赞同：4
> 
> 时间：2012-05-22T15:40:29.893
> 
> 标签：ruby-on-rails, ruby, activeadmin

我对 ActiveAdmin 和 RoR 完全陌生，我不知道如何更改 has_many 关联中下拉列表的可见值。

## 填充模型

```
class Fillup < ActiveRecord::Base
    // key is car_id:integer
    belongs_to :car
end 
```

## 汽车模型

```
class Car < ActiveRecord::Base
    validates :description, :presence => true
    key is fillup_id:integer
    has_many :fillups
end 
```

## 它目前显示的内容：

它目前显示我假设对分配给它的 Car 的编码引用。 ![在此处输入图像描述](../Images/e31d4d1304acd889d1f8cfff72519453.png)

## 我需要它显示什么：

我需要它来显示给定的描述，该描述`description:string`在`Car Model`. ![在此处输入图像描述](../Images/90d94107a30cbdff8bec051c5838c0b0.png)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-22T15:43:09.560

像这样的东西应该工作......

在`app/admin/model_name.rb`

```
form do |f|
  f.inputs "My Model Name" do
    # add your other inputs
    f.input :cars, :collection => Car.all.map{ |car| [car.description, car.id] }
    f.buttons
  end 
end 
```

阅读[本文](http://activeadmin.info/docs/5-forms.html)以了解有关修改表单的更多信息。

AciveAdmin 使用 formtastic [，](http://github.com/justinfrench/formtastic)您也应该阅读相关内容。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-22T15:45:11.757

在您的`Car`模型中，只需添加以下内容：

```
def to_s
  description
end 
```

它应该做的工作！

*说明：*实际上，您`Car`的`to_s`方法返回与当前实例对应的对象 id，这是在对象上使用诸如 puts 之类的方法时使用的默认值。`puts @car`要替换模型的显示名称，您必须覆盖此方法，当您使用或在模板中执行时，它将在您的应用程序中的任何位置工作`<%= @car %>`

# android - 如何在 Android 中正确显示泰卢固语字体？

> ID：10705374
> 
> 赞同：1
> 
> 时间：2012-05-22T15:40:39.450
> 
> 标签：android, android-layout

![在此处输入图像描述](../Images/8953adeae67c08608cdc196d5bd8c601.png)

大家好，我想用泰卢固语显示数据。

```
Typeface Telugu;
Telugu = Typeface.createFromAsset(getAssets(),"fonts/Tikkana.ttf");
TextView tt = (TextView) v.findViewById(R.id.label);
tt.setTypeface(Telugu); 
```

我没有得到正确的任何人都可以帮助我请找到正确显示的图像一些内容显示不正确我从客户端 RssFeed 获取数据....请回复

# sharepoint - Sharepoint 幻灯片库图像位置

> ID：10705379
> 
> 赞同：1
> 
> 时间：2012-05-22T15:40:58.340
> 
> 标签：sharepoint, slider, powerpoint, slide

我有一个客户使用 SharePoint 2007 中的内置幻灯片库来管理 PowerPoint 演示文稿。一旦他们将演示文稿上传到图书馆，我必须在我编写的单独的图片库滑块中使用这些幻灯片。为了让幻灯片显示在 Slider 中，我需要每张幻灯片的图像 html 位置。EX 'http://testsite/sites/test/PowerPointSlides/test_pptx'

我可以获得幻灯片库创建的缩略图的链接（http://testsite/sites/test/PowerPointSlides/_t/test_pptx.jpg），但它很小，在滑块中不可读。

Sharepoint 是否保存每张幻灯片的完整图像，我可以获得地址，还是只保存每张 .pptx 幻灯片而不是图像？

# html - 将 HTML 解析为 XML

> ID：10705394
> 
> 赞同：0
> 
> 时间：2012-05-22T15:41:46.547
> 
> 标签：html, xml, msxml

我试图弄清楚如何将 HTML 解析为 XML，但我无法弄清楚。我想使用该`MSXML2.ServerXMLHTTP`对象（在 .asp 文件中）。

```
<% 
url = "http://www.website.com/file.asp"
set xmlhttp = CreateObject("MSXML2.ServerXMLHTTP") 
xmlhttp.open "POST", url, false 
xmlhttp.send
Response.write xmlhttp.responseText
set xmlhttp = nothing 
%> 
```

这给了我文字，但我真的不知道从哪里开始。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T15:51:29.097

我认为问题出在 HTML 文件的 HEAD 中。来自 MSDN：resonse 应该返回 XML（“text/xml”），但您的[http://www.website.com/file.asp](http://www.website.com/file.asp)返回 HTML 内容，带有（“text/html”）mime 类型。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-06-27T18:00:05.550

**本机 XML 扩展**

我更喜欢使用其中一种原生 XML 扩展，因为它们与 PHP 捆绑在一起，通常比所有 3rd 方库都快，并且为我提供了对标记的所有控制。

**DOM**

DOM 扩展允许您使用 PHP 5 通过 DOM API 对 XML 文档进行操作。它是 W3C 文档对象模型核心级别 3 的实现，这是一个平台和语言中立的接口，允许程序和脚本动态访问和更新文件的内容、结构和风格。

DOM 能够解析和修改真实世界（损坏的）HTML，并且可以进行 XPath 查询。它基于 libxml。

使用 DOM 需要一些时间来提高工作效率，但 IMO 非常值得。由于 DOM 是一个与语言无关的接口，您会发现许多语言的实现，因此如果您需要更改您的编程语言，那么您很可能已经知道如何使用该语言的 DOM API。

一个基本的使用示例可以在获取 A 元素的 href 属性中找到，一般概念概述可以在 PHP 中的 DOMDocument 中找到。

StackOverflow 上已经广泛介绍了如何使用 DOM 扩展，因此如果您选择使用它，您可以确定您遇到的大多数问题都可以通过搜索/浏览 StackOverflow 来解决。

**XML阅读器**

XMLReader 扩展是一个 XML 拉解析器。阅读器充当文档流上的光标，并在途中的每个节点处停止。

XMLReader 和 DOM 一样，都是基于 libxml。我不知道如何触发 HTML 解析器模块，因此使用 XMLReader 解析损坏的 HTML 的机会可能不如使用 DOM 强大，您可以明确告诉它使用 libxml 的 HTML 解析器模块。

`h1`在使用 PHP 从标签中获取所有值时可以找到一个基本的使用示例。

**XML 解析器**

此扩展允许您创建 XML 解析器，然后为不同的 XML 事件定义处理程序。每个 XML 解析器还有一些可以调整的参数。

XML Parser 库也基于 libxml，并实现了 SAX 风格的 XML 推送解析器。它可能是比 DOM 或 SimpleXML 更好的内存管理选择，但比 XMLReader 实现的拉式解析器更难使用。

**简单 XML**

SimpleXML 扩展提供了一个非常简单且易于使用的工具集，用于将 XML 转换为可以使用普通属性选择器和数组迭代器处理的对象。

当您知道 HTML 是有效的 XHTML 时，SimpleXML 是一个选项。如果您需要解析损坏的 HTML，甚至不要考虑 SimpleXml，因为它会阻塞。

一个基本的使用示例可以在 A simple program to CRUD node and node values of xml 文件中找到，PHP 手册中有很多其他示例。

**第 3 方库（基于 libxml）**

如果您更喜欢使用第 3 方库，我建议使用实际上在下面使用 DOM/libxml 的库，而不是字符串解析。

**FluentDom - 回购**

FluentDOM 为 PHP 中的 DOMDocument 提供了一个类似 jQuery 的 fluent XML 接口。选择器是用 XPath 或 CSS 编写的（使用 CSS 到 XPath 转换器）。当前版本扩展了 DOM 实现标准接口并添加了 DOM 生活标准的功能。FluentDOM 可以加载 JSON、CSV、JsonML、RabbitFish 等格式。可以通过 Composer 安装。

**HtmlPageDom**

Wa72\HtmlPageDom` 是一个用于轻松操作 HTML 文档的 PHP 库，它需要 Symfony2 组件中的 DomCrawler 来遍历 DOM 树，并通过添加用于操作 HTML 文档的 DOM 树的方法来扩展它。

**phpQuery（多年未更新）**

phpQuery 是一个服务器端、可链接、CSS3 选择器驱动的文档对象模型 (DOM) API，它基于用 PHP5 编写的 jQuery JavaScript 库，并提供额外的命令行界面 (CLI)。

另见：[https ://github.com/electrolinux/phpquery](https://github.com/electrolinux/phpquery)

**Zend_Dom**

Zend_Dom 提供了处理 DOM 文档和结构的工具。目前，我们提供 Zend_Dom_Query，它为使用 XPath 和 CSS 选择器查询 DOM 文档提供了一个统一的接口。

**查询路径**

QueryPath 是一个用于操作 XML 和 HTML 的 PHP 库。它不仅适用于本地文件，还适用于 Web 服务和数据库资源。它实现了大部分 jQuery 界面（包括 CSS 样式的选择器），但它针对服务器端使用进行了大量调整。可以通过 Composer 安装。

**fDOM文档**

fDOMDocument 扩展了标准 DOM 以在所有错误情况下使用异常，而不是 PHP 警告或通知。为了方便和简化 DOM 的使用，他们还添加了各种自定义方法和快捷方式。

**军刀/xml**

sabre/xml 是一个包装和扩展 XMLReader 和 XMLWriter 类的库，以创建一个简单的“XML 到对象/数组”映射系统和设计模式。写入和读取 XML 是单遍的，因此速度很快，并且在大型 XML 文件上需要较少的内存。

**流体XML**

FluidXML 是一个 PHP 库，用于使用简洁流畅的 API 操作 XML。它利用 XPath 和流畅的编程模式变得有趣和有效。

**第 3 方（不基于 libxml）**

在 DOM/libxml 上构建的好处是，您可以立即获得良好的性能，因为您是基于本机扩展的。然而，并不是所有的第 3 方库都走这条路。下面列出了其中一些。

**PHP 简单的 HTML DOM 解析器**

用 PHP5+ 编写的 HTML DOM 解析器让您以非常简单的方式操作 HTML！

*   需要 PHP 5+。
*   支持无效的 HTML。
*   使用像 jQuery 一样的选择器在 HTML 页面上查找标签。
*   在一行中从 HTML 中提取内容。

我一般不推荐这个解析器。代码库很糟糕，解析器本身相当慢且内存不足。并非所有的 jQuery 选择器（例如子选择器）都是可能的。任何基于 libxml 的库都应该很容易胜过这一点。

**PHP HTML 解析器**

PHPHtmlParser 是一个简单、灵活的 HTML 解析器，它允许您使用任何 CSS 选择器（如 jQuery）来选择标签。目标是协助开发需要快速、简单的方式来**抓取**HTML 的工具，无论它是否有效！这个项目最初由 sunra/php-simple-html-dom-parser 支持，但支持似乎已经停止，所以这个项目是我对他以前工作的改编。

同样，我不会推荐这个解析器。由于 CPU 使用率很高，所以速度相当慢。也没有清除已创建 DOM 对象内存的功能。这些问题特别适用于嵌套循环。文档本身不准确且拼写错误，自 2016 年 4 月 14 日以来对修复没有任何回应。

**加农**

*   通用标记器和 HTML/XML/RSS DOM 解析器
*   操作元素及其属性的能力
*   支持无效的 HTML 和 UTF8
*   可以对元素执行类似 CSS3 的高级查询（如 jQuery -- 支持命名空间）
*   HTML 美化器（如 HTML Tidy）
*   缩小 CSS 和 Javascript
*   排序属性、更改字符大小写、正确缩进等。
*   可扩展
*   使用基于当前字符/令牌的回调解析文档
*   操作在较小的函数中分离，以便于覆盖
*   快速简便

从来没有用过。不能说好不好。

**HTML 5**

您可以使用上面的方法来解析 HTML5，但由于 HTML5 允许的标记，可能会有一些问题。因此，对于 HTML5，您需要考虑使用专用解析器，例如：

**html5lib**

基于 WHATWG HTML5 规范的 HTML 解析器的 Python 和 PHP 实现，以最大程度地兼容主要的桌面 Web 浏览器。

一旦 HTML5 最终确定，我们可能会看到更多专用的解析器。W3 还发布了一篇名为 How-To for html 5 parsing 的博文，值得一试。

**网页服务**

如果您不想编写 PHP，也可以使用 Web 服务。一般来说，我发现这些的实用性很少，但这只是我和我的用例。

**刮板维基**

ScraperWiki 的外部接口允许您以您希望在 Web 或您自己的应用程序中使用的形式提取数据。您还可以提取有关任何刮板状态的信息。

**常用表达**

最后也是最不推荐的，您可以使用正则表达式从 HTML 中提取数据。通常不鼓励在 HTML 上使用正则表达式。

您在网络上找到的大多数与标记匹配的片段都很脆弱。在大多数情况下，它们只适用于非常特殊的 HTML 片段。微小的标记更改，例如在某处添加空格，或添加或更改标记中的属性，可能会使 RegEx 在编写不正确时失败。在 HTML 上使用 RegEx 之前，您应该知道自己在做什么。

HTML 解析器已经知道 HTML 的语法规则。必须为您编写的每个新 RegEx 教授正则表达式。RegEx 在某些情况下很好，但这实际上取决于您的用例。

您可以编写更可靠的解析器，但是当上述库已经存在并且在这方面做得更好时，使用正则表达式编写完整且可靠的自定义解析器是浪费时间。

另见 Parsing Html The Cthulhu Way

书籍如果你想花一些钱，看看

PHP Architect's Guide to Webscraping with PHP 我不隶属于 PHP Architect 或作者。

# android - 如何使用 ImageView 调用搜索对话框？

> ID：10705395
> 
> 赞同：0
> 
> 时间：2012-05-22T15:41:48.650
> 
> 标签：android

当我按下一个按钮进入活动或按下 ImageView 时，我必须调用搜索对话框，而不是像这篇文章中的硬件按钮：

[如何在android中单击按钮时调用搜索对话框？](https://stackoverflow.com/questions/6744130/how-can-i-call-search-dialog-on-button-click-in-android)

请有代码或教程，非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T15:50:21.937

在“调用搜索对话框”下[的搜索对话框的文档中](http://developer.android.com/guide/topics/search/search-dialog.html#SearchDialog)

> ...但是，某些设备不包含专用的 SEARCH 按钮，因此您不应假设它始终可用。使用搜索对话框时，您必须始终在 UI 中提供另一个搜索按钮，通过调用 onSearchRequested()... 来激活搜索对话框。

因此，您应该能够将`onSearchRequested();`点击侦听器放入点击图像时，此方法调用应该为您启动搜索对话框。

# android - 如何删除“import org.apache.http.entity.mime.content.ByteArrayBody;”中的错误

> ID：10705396
> 
> 赞同：0
> 
> 时间：2012-05-22T15:41:50.313
> 
> 标签：android

我尝试下载 [httpmime-4.0.1.jar] 但仍然存在错误并且 ------------------------------ -

类 ImageUploadTask 扩展 AsyncTask { @Override

```
 protected String doInBackground(Void... unsued) {

        try {

            HttpClient httpClient = new DefaultHttpClient();

HttpContext localContext = new BasicHttpContext();
            HttpPost httpPost = new HttpPost(getString(R.string.WebServiceURL) + "/cfc/iphonewebservice.cfc?method=uploadPhoto");
            MultipartEntity entity = new MultipartEntity(

         HttpMultipartMode.BROWSER_COMPATIBLE);

ByteArrayOutputStream bos = new ByteArrayOutputStream();
            bitmap.compress(CompressFormat.JPEG, 100, bos);
            byte[] data = bos.toByteArray();
            entity.addPart("photoId", new StringBody(getIntent()

.getStringExtra("photoId")));
            entity.addPart("returnformat", new StringBody("json"));
            entity.addPart("uploaded", new ByteArrayBody(data,"myImage.jpg"));

    entity.addPart("photoCaption", new StringBody(caption.getText().toString()));
            httpPost.setEntity(entity);
            HttpResponse response = httpClient.execute(httpPost,
   localContext); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T11:50:17.157

在您的应用程序中添加一个 libs 文件夹，然后添加“httpmime-4.1.3.jar”，之后您需要将此目录显示到您的项目属性中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T15:45:55.810

您应该将此 JAR 添加到构建路径。如果您使用的是 Eclipse，只需将其复制到项目文件夹即可。然后在 Eclipse 中右键单击它，BUILD PATH->ADD TO BUILD PATH

# php - 无法使用 PHP 从 mysql 数据库中检索希腊字符

> ID：10705400
> 
> 赞同：1
> 
> 时间：2012-05-22T15:42:05.253
> 
> 标签：php, mysql, wamp, collation

*   目前在 Wamp 2.20
*   MySQL 版本：5.5.20
*   PHP版本：5.3.10
*   表排序：utf8-bin
*   `header('Content-type: text/html; charset=utf-8');`

虽然我可以看到保存在 MySQL 表中的数据是希腊字符，但当我尝试从 PHP 中回显它们时，它们变成了“？” 问号。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-22T15:46:33.047

确保您的客户端连接设置为 UTF8。例子：

**SQL**

```
SET NAMES UTF8; 
```

**PHP MySQLi**

```
mysqli_set_charset('utf8'); 
```

**PHP PDO**

```
$handle = new PDO("mysql:host=localhost;dbname=dbname",
  'username', 'password', 
  array(PDO::MYSQL_ATTR_INIT_COMMAND => "SET NAMES utf8"
)); 
```

PHP mysql（已弃用 -**请勿使用**）

```
mysql_set_charset('utf8'); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-22T15:45:58.633

在回显您的数据之前，请尝试使用[htmlentities](http://php.net/manual/en/function.htmlentities.php)对您的特殊字符进行编码。

```
echo htmlentities($data); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-22T15:48:06.797

确保您的文件使用`ANSI as UTF-8`aka保存`UTF-8 without BOM`。您可以使用 NotePad++： http: [//npp-community.tuxfamily.org/documentation/notepad-user-manual/document-properties/encoding](http://npp-community.tuxfamily.org/documentation/notepad-user-manual/document-properties/encoding)

Also, when working with UTF-8 (Unicode) please remember :

*   All files must be saved using UTF-8 encoding ;
*   MySQL tables must be in UTF-8 ;
*   Fields in MySQL must be UTF-8 ;
*   PHP must be set to use UTF-8 ;
*   Everything has to be UTF-8 encoded.

# .htaccess - .htaccess 覆盖 IndexIgnore *, IndexIgnore nothing

> ID：10705415
> 
> 赞同：1
> 
> 时间：2012-05-22T15:42:56.543
> 
> 标签：.htaccess, overriding

我有一个带有 .htaccess 文件的目录，该文件具有 .htaccess 文件的设置`IndexIgnore *`。如何设置子目录不忽略任何内容，或者忽略所有内容的否定，从而覆盖父目录的IndexIgnore？像`IndexIgnore ^*`，只有一个工作版本？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-07-05T12:37:19.513

只需`IndexIgnoreReset ON`在新的 IndexIgnore 指令之前添加。然后，要显示子文件夹中的所有内容，请使用`IndexIgnore "."` 检查文档： [IndexIgnoreReset](http://httpd.apache.org/docs/trunk/mod/mod_autoindex.html#indexignorereset)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T22:15:56.660

我认为这是不可能的，因为[IndexIgnore](http://httpd.apache.org/docs/2.0/mod/mod_autoindex.html#indexignore)列表总是附加在现有列表中（来自父 .htaccess）。现在有办法覆盖这个指令 AFAIK。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-05-24T08:42:33.190

在`<Directory>`块中，您可以添加：

```
IndexIgnoreReset ON
IndexIgnore .??* *~ *# HEADER* README* RCS CVS *,v *,t 
```

这将覆盖此特定的配置`<Directory>`

# javascript - 未捕获的类型错误：[对象窗口] 没有方法“addEvent”

> ID：10705417
> 
> 赞同：0
> 
> 时间：2012-05-22T15:43:00.790
> 
> 标签：javascript, jquery, jquery-events

这个脚本在这里工作[https://jsfiddle.net/ByEzF/](https://jsfiddle.net/ByEzF/)但在停止工作的站点中：

```
<script type="text/javascript">
    var Add = {
        setOptions: function(number) {
            $('battle-options')
            .removeClass('five-options')
            .removeClass('four-options')
            .removeClass('three-options')
            .removeClass('two-options');

            var option3 = $('option-3');
            var option4 = $('option-4');
            var option5 = $('option-5');

            var versus3 = $('versus-3');
            var versus4 = $('versus-4');
            var versus5 = $('versus-5');

            var elements5 = new Elements([option3, option4, option5, versus3, versus4, versus5]);
            elements5.setStyle('display','none');

            if(number == 5) {
                $('battle-options').addClass('five-options');
                elements5.setStyle('display','block');
                $$('.battle-option input[type="file"]').set('size', 10);
            } else if(number == 4) {
                $('battle-options').addClass('four-options');
                new Elements([option3, option4, versus3, versus4]).setStyle('display','block');
                $$('.battle-option input[type="file"]').set('size', 15);
            } else if(number == 3) {
                $('battle-options').addClass('three-options');
                new Elements([option3, versus3]).setStyle('display','block');
                $$('.battle-option input[type="file"]').set('size', 19);
            } else if(number == 2) {
                $('battle-options').addClass('two-options');
                $$('.battle-option input[type="file"]').set('size', 22);
            }
        }
    };

    window.addEvent('domready', function(){
        Add.setOptions(2);
    });
</script> 
```

我有这个错误信息：

> 未捕获的 TypeError：[对象窗口] 没有方法“addEvent”？

![](../Images/fb26a2258e114551403d7693cecafd32.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-22T15:47:53.143

`window.addEvent`只能通过 MooTools 获得（正在加载到 jsfiddle 页面上）。

[https://mootools.net/docs/core/Element/Element.Event](https://mootools.net/docs/core/Element/Element.Event)

从文档：

> 注意：此方法也附加到 Document 和 Window。

# linux - 从 cron 运行 casper.js 脚本

> ID：10705418
> 
> 赞同：4
> 
> 时间：2012-05-22T15:43:04.217
> 
> 标签：linux, cron, casperjs

我正在尝试通过 cron 运行 casper.js 脚本。当我手动运行脚本时一切正常，但是当我通过 cron 运行它时，出现以下错误：

```
Traceback (most recent call last):
 File "/usr/local/bin/casperjs", line 46, in <module>
   status = subprocess.call(CASPER_COMMAND)
 File "/usr/lib/python2.6/subprocess.py", line 480, in call
   return Popen(*popenargs, **kwargs).wait()
 File "/usr/lib/python2.6/subprocess.py", line 633, in __init__
   errread, errwrite)
 File "/usr/lib/python2.6/subprocess.py", line 1139, in _execute_child
   raise child_exception
OSError: [Errno 2] No such file or directory 
```

我的 crontab 条目是：

`30 9 * * * /usr/local/bin/casperjs lib/fsaupload.js arg1 arg2 arg3`

我也试过

`30 9 * * * python /usr/local/bin/casperjs lib/fsaupload.js arg1 arg2 arg3`

这给了我同样的结果。有任何想法吗？我猜这可能是一个`path`问题，但不知道从哪里开始！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-22T15:45:46.233

您可能应该使用 casper 脚本的绝对路径，例如：

```
30 9 * * * /usr/local/bin/casperjs /absolute/path/to/lib/fsaupload.js arg1 arg2 arg3 
```

我的两分钱。

**编辑：**

好吧，这有点傻。您还可以通过设置环境变量`phantomjs`来设置可执行文件的自定义路径：`PHANTOMJS_EXECUTABLE`

```
$ export PHANTOMJS_EXECUTABLE="/path/to/phantomjs" 
```

然后像往常一样运行你的脚本：

```
/usr/local/bin/casperjs /absolute/path/to/lib/fsaupload.js arg1 arg2 arg3 
```

提示：如果您的 crontab 以其他用户身份运行，请检查它是否可以访问 phantomjs 路径。

希望它有所帮助（并且有效）。

**再次编辑**

等等，你得到的堆栈跟踪表明你正在使用旧版本的 CasperJS（例如，`subprocess`不再使用该模块）。尝试使用更新的版本:)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-04-04T20:49:20.017

这是一个较老的问题，但仍然相关 - 我只花了 4 个小时试图解决这个问题，但没有找到直接的解决方案。对我来说发生的事情完全一样，我可以从 shell 命令行运行 casper.js 脚本，但不能通过 cron 作业。正如 NiKo 所暗示的那样，但没有清楚地说明**我**无法理解，casper 需要*知道*Phantomjs 在哪里才能工作。

我创建了一个 shell 脚本 cron_wrap.sh，其中包含 Phantomjs bin 目录的路径：

```
#!/bin/bash
PATH=/usr/local/src/phantomjs/bin:/usr/lib64/qt-3.3/bin:/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin:/root/bin
/usr/local/bin/casperjs --ignore-ssl-errors=true /srv/www/apps/myscript.js 
```

使您的 .sh 可执行文件，现在您可以将脚本添加到 cron：

```
00 09 * * * /srv/www/apps/myscript.js 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-12-13T16:29:38.763

这是一个更老、更老的问题，但我也处理了一段时间。我不能再通过 cron（谈​​论停机时间）重新启动 Apache（对于 Django），这最终成为了问题。而不是像 Jesse Q 使用的包装脚本，我只是将我的 casperjs/phantom-augmented PATH 添加到我的 crontab 的顶部

```
PATH=/usr/local/src/phantomjs/bin:/usr/lib64/qt-3.3/bin:/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin:/root/bin
/usr/local/bin/casperjs 
```

现在它可以工作了。您可以通过写入 crontab 中的文件来检查您的 cron 环境，如下所示：

```
* * * * * env > ~/cronenv 
```

只需 vim 即可查看您当前的 cron PATH 是什么。很适合调试这个问题。

# android - mobile flex，知道源位置

> ID：10705425
> 
> 赞同：0
> 
> 时间：2012-05-22T15:43:18.857
> 
> 标签：android, apache-flex, mobile, geolocation

我正在开发一个 flex 移动应用程序，需要从 lat/long 获取数据，我正在使用 android 的智能手机上进行测试，我看到有两种方法可以获取 lat/long，粗略位置（WiFi/Cell- ID）和精细定位（GPS 卫星）。

有没有办法知道正在使用什么样的源位置？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T18:08:44.917

除了在应用 xml 文件中为精细/粗略位置指定 Android 权限外，您似乎无权访问此信息。即：您只能指定课程位置，然后始终知道您正在处理的内容（无法正常工作，因为设备可能会退回到粗略的位置）。

但是，我将使用[GeolocationEvent](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/events/GeolocationEvent.html)`horizontalAccuracy`的和`verticalAccuracy`属性来代替。

您可以只使用这些来反映当前信号的准确性，或者如果有必要，尝试从这些值推断它是精细还是粗糙。

# ios - JSONKIT 解析错误

> ID：10705427
> 
> 赞同：0
> 
> 时间：2012-05-22T15:43:35.533
> 
> 标签：ios, json, nsurlconnection, jsonkit

我正在使用单例类从远程服务器（通过 NSURLConnection）获取 JSON - 一切似乎都很好，除非我尝试使用 JSONKit 解析 JSON。

这是一些代码

```
-(void)connection:(NSURLConnection *)connection didReceiveData:(NSData *)data
{
 [apiData appendData:data];  
}

-(void)connection:(NSURLConnection *)connection didFailWithError:(NSError *)error
{
NSLog(@"Connection failed! Error - %@ %@",
      [error localizedDescription],
      [[error userInfo] objectForKey:NSURLErrorFailingURLStringErrorKey]);
}

-(void)connection:(NSURLConnection *)connection didReceiveResponse:(NSURLResponse   *)response
{
NSHTTPURLResponse *realResponse = (NSHTTPURLResponse *)response;
if (realResponse.statusCode == 200)
{
    apiData = [[NSMutableData alloc] init];
} else {
    NSLog(@"Bad response = %i",realResponse.statusCode);
}
}

-(void)connectionDidFinishLoading:(NSURLConnection *)connection
{
NSString *jsonData = [[NSString alloc] initWithData:apiData encoding:NSUTF8StringEncoding];
NSDictionary *deserializedData = [jsonData objectFromJSONString];
[self.delegate dataLoaded:deserializedData]; 
} 
```

我得到的错误是在这一行

```
 NSDictionary *deserializedData = [jsonData objectFromJSONString];

-[__NSCFString objectFromJSONString]: unrecognized selector sent to instance 0x7fc1cd0 
```

有什么想法吗？这似乎是使用 JsonKit 解析 JSON 的正常方式。

我已经确定 JSON 是有效的......在附加到 didReceiveResponse 期间字符串是否以某种方式损坏？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-01T18:34:09.090

想通了...我在项目中包含了 JSONKIt.h，但由于某些奇怪的原因，JSONKit.m 未包含在“构建阶段”下的“编译源”中 - 一旦我手动添加它，它就开始正常工作。

# validation - 如何编写 Grails 验证消息？

> ID：10705432
> 
> 赞同：0
> 
> 时间：2012-05-22T15:44:03.360
> 
> 标签：validation, grails, error-handling

我有一个简单的域实体：

```
package shoesshop

class Brand {

    String name
    String description
    String logoImageURL

    static constraints = {
        name(blank: false)
        logoImageURL(nullable: true)
    }
} 
```

当我尝试使用 null 值作为名称保存新品牌​​时，我想呈现一条消息，上面写着“必须指定名称”。

我尝试将属性添加到`messages.properties`：

```
brand.name.nullable=Brand name must be specified 
```

但它不会自动拾取。我应该如何从那里检索它？我看了看，`brand.errors`它只包含一条默认消息

`Property [{0}] of class [{1}] cannot be null`.

它还包含一组错误代码，其中一个是`brand.name.nullable`.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T19:12:08.773

你有没有尝试过？：

```
if(brand.name==null)
{
    flash.message = message(code: 'brand.name.nullable',default:'Brand name must be specified.');
    render(view: "create", model: [brand:brand])
    return
} 
```

您可以尝试将“default.null.message”的消息（不知道这将如何与您的整个应用程序一起执行）更改为

```
{1} {0} must be specified 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T21:07:29.500

当您没有可空约束时，会出现可空错误消息，这对我来说很奇怪。在空白和可为空的[文档](http://grails.org/doc/latest/ref/Constraints/blank.html)中，它清楚地表明它`nullable`不同于`blank`并具有单独的消息。

尝试

```
brand.name.blank 
```

我似乎还必须添加`.error`才能使事情正常工作：

```
brand.name.blank.error or brand.name.nullable.error 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-14T18:55:43.600

我正在使用 Grails 2.2.3。对我来说，它在我使用时有效

```
brands.name.blank=The name cannot be empty 
```

现在，如果我在收到此错误后刷新页面“.../appname/controllername/save”，我会得到

```
Property [name] of class [class ...] cannot be null 
```

此消息可以更改为

```
brands.name.nullable=The name cannot be null (do not refresh the page!!!) 
```

# javascript - 如何在Javascript Metro应用程序的列表视图中检测右键单击项目

> ID：10705435
> 
> 赞同：2
> 
> 时间：2012-05-22T15:44:07.017
> 
> 标签：javascript, windows-8, windows-runtime, winjs

我试图找出当您右键单击列表视图中的项目时触发的事件。当我纠正一个项目时，它会将其标记为已选中，但我似乎无法找到触发了哪个事件。

我已将一个函数附加到 oniteminvoked 事件，当我左键单击一个项目时会正确触发，但右键单击它时不会。

右键单击某个项目时会触发哪个事件？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T04:13:04.250

对于它的价值，您还应该看到一个 selectionchange 和 selectionchanged 事件，因为 listview.selection 属性将被更新。这是一个 ListView 事件，而不是项目事件，但根据您要完成的任务，它可能很有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T18:42:47.020

您应该使用[AppBar 对象](http://msdn.microsoft.com/en-us/library/windows/apps/br229670.aspx)为您的用户提供右键单击体验。请参阅[Metro 风格应用程序的命令式设计](http://msdn.microsoft.com/en-US/library/windows/apps/hh761499)。也就是说，你可以听`contextmenu`...

```
object.addEventListener("contextmenu", handler, useCapture) 
```

# stored-procedures - Dapper 是否支持带有存储过程的强类型对象？

> ID：10705439
> 
> 赞同：7
> 
> 时间：2012-05-22T15:44:27.590
> 
> 标签：stored-procedures, dapper, query-by-example

基本上，我想为存储过程使用“漂亮”的 Dapper 语法，而不必手动使用`exec MySproc @p1, @p2, @p3, @p4`等等，但我需要能够传入一个具有各种属性集的强类型对象，并让这个对象用于映射参数。我知道我可以用匿名对象做到这一点，但我正在考虑的场景类似于一个复杂的搜索表单，其中可以搜索多个字段，并且相应的存储过程可以有很多参数（许多具有默认值）。

理想情况下，我希望能够做这样的事情：

```
var cust = new Customer();
cust.FirstName = ...
cust.LastName = ...

// using .NET 3.5 so need to use ugly syntax :(
var result = connection.Query<Customer>("MySproc", cust, null, false, null, CommandType.StoredProcedure).Single(); 
```

但是，这不起作用并引发错误，因为我的 Customer 对象可能有十几个或更多属性，在这种情况下我只寻找两个；Dapper 似乎只是检查每个属性并分配一个值，假设存储过程中可能没有相应的参数。

我可以使用 PetaPoco 做类似的事情（传入强类型对象**或**匿名对象），但我正在寻找比 PetaPoco 更抽象的东西。

我想在 Dapper（或另一个微 ORM 中做些什么？我不能使用 NHibernate 或重量级 ORM），或者有没有一种方法我忽略了获得相同的功能而不必编写一个 exec 语句与什么可能是十几个参数？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-23T06:08:30.063

如果你想指定参数，你需要明确地这样做：

```
var result = connection.Query<Customer>("MySproc", 
     new {cust.Id, cust.Name}, // specify the params you want to give it.  
     null, 
     false, 
     null, 
     CommandType.StoredProcedure).Single(); 
```

我们不会`sp_help`对 procs 进行 params 嗅探，尽管您可能会构建一个助手来执行此操作并允许您运行：`cust.ToProcParams('MySproc')`

或者，如果你想动态构建这个参数，你可以使用。

```
var dp = new DynamicParameters(); 
dp.Add("Id", cust.Id);
dp.Add("Name", cust.Name);
var result = connection.Query<Customer>("MySproc", 
         dp,
         null, 
         false, 
         null, 
         CommandType.StoredProcedure).Single(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-29T21:00:52.987

如果您使用的是 SQL Server，请查看 Insight.Database。[https://github.com/jonwagner/Insight.Database/wiki](https://github.com/jonwagner/Insight.Database/wiki)更面向存储过程，使用SqlDeriveParameters来确定对象与存储过程的映射关系。

注意：它目前需要 .NET 4.0，但如果您真的对 .NET 3.5 版本感兴趣，我可以看到这有多难。

# cuda - 什么构成了 CUDA 中的后向依赖？

> ID：10705441
> 
> 赞同：3
> 
> 时间：2012-05-22T15:44:30.287
> 
> 标签：cuda

我是 CUDA 编程的新手。我有一个 CUDA 子程序，希望它可以用一个简单的源对扩散方程进行建模：

```
attributes(global) subroutine diff_time_stepper(v,diffconst)

real*8 :: v(:,:)
real*8 :: diffconst

real*8 :: vintermed
integer :: i,j,m
integer :: nx, ny

nx=256
ny=256

i=(blockIdx%x-1)*blockDim%x+threadIdx%x
j=(blockIdx%y-1)*blockDim%y+threadIdx%y

if (i<nx .and. j<ny .and. i>1 .and. j>1) then
  vintermed=v(i,j)+diffconst*(v(i-1,j)-2.*v(i,j)+v(i+1,j)+v(i,j-1)-2.*v(i,j)+v(i,j+1))
  v(i,j)=vintermed
! add a source for the heck of it
  if (i==64 .and. j==64) v(i,j)=v(i,j)+1
endif

end subroutine 
```

我的问题：这个程序似乎有效，给出了合理的结果（即使运行速度没有我希望的那么快）。但是我这里有“向后依赖”吗？特别是，vinterm 由一个涉及多个 v 的函数设置，然后 v 设置为等于 vtinerm。然后在此计算之后设置 v(64,64)。这些是潜在的问题吗？更一般地说，即使我发现了很多关于如何为 CUDA 编程的讨论，但我发现关于后向依赖问题的讨论很少，这在我看来是最重要的。谁能指出我对此进行了很好的讨论？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T16:12:34.053

是的你是。通常，各种线程正在以不可预测的顺序读取和更新 v（尽管您可以说一些关于同一块上的 warp 中线程的行为等的事情）这是正确的（有不同的警告）比如说 OpenMP 或任何你最喜欢的基于 CPU 的线程框架。

扩散问题比大多数问题更稳健——例如，Gauss Sidel 或 Jacobi 迭代明确地在读取值之前使用更新值——但你仍然会遇到问题，因为不同的线程具有来自不同时间步的值；特别是在更新之前读入或不读入 v(64,64) 的线程通常会导致源周围峰的形状不一致。

您在阅读后通过同步线程来确保这不会*在*块内发生：

```
...
real*8 :: left, right, up, down, centre

nx=256
ny=256

i=(blockIdx%x-1)*blockDim%x+threadIdx%x
j=(blockIdx%y-1)*blockDim%y+threadIdx%y

if (i<nx .and. j<ny .and. i>1 .and. j>1) then
  left  = v(i-1,j)
  right = v(i+1,j)
  up    = v(i,  j+1)
  down  = v(i,  j-1)
  centre= v(i,j)
endif
call syncthreads()

if (i<nx .and. j<ny .and. i>1 .and. j>1) then
  v(i,j) = centre + diffconst*(left+right+up+down-4.*centre)
  if (i==64 .and. j==64) v(i,j)=v(i,j)+1
endif 
```

但这只是将问题推到块边界而不是线程边界；您仍然不知道块读取/更新的顺序`v`。但是同步块的唯一方法是在内核的末尾。

有几种方法可以解决这个问题，都涉及使用更多的内存或更少的并行度。一种方法是让每个人都从vold中读取，比如说，更新vnew；然后每个人都只是从旧数组中读取并更新新数组，然后就没有同步问题了。然后你只需在每个时间步中切换 old 和 new 的含义，因此每个奇数时间步都会读取 vold 并输出 vnew，而每个偶数时间步都会反过来。

# asp.net-mvc-3 - ASP.NET MVC 视图模型路径

> ID：10705443
> 
> 赞同：0
> 
> 时间：2012-05-22T15:44:37.357
> 
> 标签：asp.net-mvc-3, viewmodel

创建新的 ASP.NET MVC 3 项目时，没有预先创建的目录用​​于存储 ViewModel 对象（大概是因为这是一种可选模式）。我知道位置是任意的，但是否有一个普遍接受的路径应该放置它们？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T15:47:24.177

通常 ViewModels 应该在 Views 的同一个项目中，但它是任意的

![在此处输入图像描述](../Images/f7b03ea9ac9dcd366ff8aab17bf5507b.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T15:48:12.377

在模型文件夹中。此文件夹应包含视图模型。域模型或实体模型应该是另一个组件的一部分，即数据访问层组件。DTO 也是如此。

# git - 为多个开发分支（和标签）并行维护多个补丁/功能分支

> ID：10705446
> 
> 赞同：3
> 
> 时间：2012-05-22T15:44:46.687
> 
> 标签：git, fork, patch, branching-and-merging

我们在 git(hub) 中创建了一个项目，并希望在我们的 fork 中维护一些补丁，同时在它们的发布（标签）和发布分支中重新创建这些补丁。

## 初始存储库结构

上游结构非常简单：

```
origin/trunk A---B---D---F---H---...
                  \
origin/0.9         C---E---G---...
                       |
                   (tag 0.9) 
```

## 问题

上游项目增加了提交中的依赖版本，`A`但`D`这些主要是为了方便，我们确信我们可以在一段时间内保持兼容性版本。

我创建了一个功能分支`trunk_compat`并用于`git revert --no-commit`为提交创建补丁`A`以及`D`我们需要它们。我已经分支了这个`origin/trunk`

```
mine/trunk_compat              A*---D*
                              / 
origin/trunk A---B---D---F---H-...
                  \
origin/0.9         C---E---G---...
                       |
                   (tag 0.9) 
```

所以现在我很容易`origin/trunk`通过变基或合并来跟踪和维护我的补丁，这取决于我是否发布。

我们的*目标*是为两个分支 (`trunk`和`0.9`) 维护这些补丁，并重新创建一个发布版本`0.9`(因为它是从 标记的`E`)。

我不知道如何正确地做到这一点。

*   我需要一个`0.9_compat`包含所有提交`G`但还包含我们的补丁的分支`A*`，`D*`因此我们可以将它放入我们的持续集成服务器中，看看它是否有效
*   我需要一个`0.9_compat`状态为`E`with`A*`和`D*`applied 的标签。
    *   为了使它更复杂，提交`E`实际上是向后移植`D`到`0.9`分支上，所以我们的`D*`补丁也应该在这里应用
    *   这不是正确的合并或变基，因为上游项目在 SVN 中，这是我们正在分叉的 git-svn 镜像
*   将来上游将分支`0.10`等，我们也希望在这些分支上维护我们的补丁

我可以通过大量采摘或手动应用补丁来做到这一点（我认为），但这感觉不对，我认为我没有充分利用 git。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T03:01:00.803

有两种方法可以做到这一点，并且正确地得到了它们 - 变基（包括cherry-pick和patch，最终结果相同）或合并。

1.  设置您需要修补的所有分支并应用补丁（`origin/trunk`和`origin/0.9_compat`）。
2.  在树枝上应用补丁
3.  区别仅在于*维护*策略，即这些分支的`git pull`(merge) 与`git pull --rebase`(rebase)。

策略之间的区别在于 for `git pull`，git 将尝试将远程更改合并到您的本地分支（导致您有很多 git merge 提交，但您的补丁 sha 将保持不变）并且 for `git pull --rebase`git 将首先获取远程更改然后才尝试在顶部应用您的本地更改（导致每次拉动后您的补丁 sha 都会发生变化）。我认为 rebase 更合适（如果远程 repo 最初是 git，则此论点更强），因为您将始终留在项目的 HEAD + 您的补丁，而不会出现不必要的合并提交混乱。

# java - 如何测试 Google App Engine 的数据库实现？

> ID：10705447
> 
> 赞同：0
> 
> 时间：2012-05-22T15:44:46.933
> 
> 标签：java, google-app-engine, testing

我为我的 Android 应用程序编写了数据库层和 CRUD 方法。

现在我想知道如何测试我的层？

我写了一个主要方法：

```
public static void main(String[] args) {
    CRUD crud = new CRUD();
    Location location = new Location(1.0,null, "TestData1");
    CRUD.insertLocation(location);
    System.out.println("Location successfully added!" + location.locationToString());
    crud.removeLocation(location);
    System.out.println("Location successfully deleted!" + location.locationToString());
} 
```

但是当我在做 Debug as> Web Application 时，编译器会说这些异常：

> java.lang.ClassNotFoundException：javax.servlet.UnavailableException：java.lang.NullPointerException

那么如何测试DataLayer是否正确呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T16:08:52.327

请参阅App Engine 文档[中的 Java 本地单元测试（仅供参考，这是 Google 上“app engine java unit test”的第一个结果）。](https://developers.google.com/appengine/docs/java/tools/localunittesting.)

# php - 运行 WHERE 子句后仅显示每第二行

> ID：10705448
> 
> 赞同：1
> 
> 时间：2012-05-22T15:44:49.463
> 
> 标签：php, mysql

从我的数据库中选择某些内容后，我试图仅显示每第二行。

我的选择如下所示：

```
SELECT * FROM table where partnerID = '1' 
```

现在从该选择查询的结果中，我只想获取每第二行。

那可能吗 ？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-22T15:48:45.203

```
$count = 0;
while($row = mysql_fetch_array($results)) {
    $count++;
    if($count % 2 == 1) continue;

    // What you want to do with the rows you don't want to skip here...
} 
```

附带说明一下，您可以使用相同的策略仅显示每 3 行或每 4 行，只需更改在模运算符旁边放置的数字

```
if($count % 3 != 0) continue; // Show only every third row
if($count % 4 != 0) continue; // Show only every fourth row 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-22T15:52:56.523

```
SELECT * FROM (
    SELECT  @n := @n + 1 AS position,
            t.*
    FROM (SELECT @n:=0) counter,
         table t
    WHERE partnerID = 1)
AS query
WHERE MOD(position,2) = 0 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-05-22T15:58:00.847

您可以通过以下方式执行此操作：

```
SELECT * FROM
(
    SELECT
      @I := @I + 1 AS rowNumber,
      tablename.*

    FROM
      tablename,
      (SELECT @I := 0) VT1

    WHERE partnerID = 2

    ORDER BY ID
) NumberedRows
WHERE MOD(rowNumber, 2)=0
; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-22T15:48:31.650

不确定这是否是正确的答案，但看起来你需要使用类似 MOD 函数的东西（[http://dev.mysql.com/doc/refman/5.0/en/mathematical-functions.html#function_mod](http://dev.mysql.com/doc/refman/5.0/en/mathematical-functions.html#function_mod)）

```
SELECT * FROM `table` WHERE id & 1; 
```

将返回奇数行

# workflow - 有什么方法可以更改工作流程 StatusCode？

> ID：10705450
> 
> 赞同：2
> 
> 时间：2012-05-22T15:45:04.757
> 
> 标签：workflow, dynamics-crm-2011, microsoft-dynamics

根据动态SDK：

> 前面的操作也可以通过使用带有适当请求消息的 Execute 方法来执行。**除了 AsyncOperation.StateCode 和 AsyncOperation.PostponeUntil 之外的 AsyncOperation 属性应被视为只读。**

无论如何绕过那些只读？

我有一个 StateCode = "Suspended" 和一个 StatusCode = "Waiting" 的工作流。
我想将 StatusCode 更改为“Cancelled”。

如果我只是尝试将 StatusCode 更新为“Cancelled”，它就不会保存它。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-22T19:26:55.657

我只是将 StateCode 从**Suspended**更改为**Terminated**。**StatusCode**会自动更新为**Canceled**。

# java - 通过 JDBC 使用 Derby DB 检索列默认值

> ID：10705457
> 
> 赞同：0
> 
> 时间：2012-05-22T15:45:36.110
> 
> 标签：java, jdbc, derby

我有一个表，其列定义如下：

```
Country VARCHAR(2) NOT NULL DEFAULT 'US' 
```

当我尝试使用 JDBC 检测此默认值时，它失败了。基本上当我使用`DatabaseMetaData.getColumns`结果时不包含该`COLUMN_DEFAULT`列。当我用 H2 尝试这个时，它就在那里。

任何想法如何使用 Derby 获得默认值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T01:01:21.577

你试过 COLUMN_DEFAULT 吗？还是对于 COLUMN_DEF？根据Javadoc，我认为它应该是COLUMN_DEF。

另外，您使用的是什么版本的 Java 和 JDBC？我认为 Derby 只添加了 COLUMN_DEF 作为 JDBC 4.0 支持的一部分，这可能需要 Java 1.6。

# excel - Excel - 根据出现计数单元格

> ID：10705459
> 
> 赞同：0
> 
> 时间：2012-05-22T15:45:41.230
> 
> 标签：excel

在上面的例子中 - 它应该显示计数值 - 8

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T16:24:59.503

这需要一个数组公式。要输入数组公式，请将公式输入到单元格中，然后点击`Ctrl`++ 。`Shift``Enter`

```
=SUM(IF(COUNTIF(OFFSET(A1:C5,ROW(A1:C5)-1,0,1,3),"<>""")>0,1,0)) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T15:55:12.857

1.  将此公式放入 D1：

    ```
    =IF(COUNT(A1:C1)>0,1,0) 
    ```

2.  将公式复制到尽可能多的行。

3.  取 D 列的总和。

# c# - 覆盖列表视图上的 OnDoubleClick() 事件

> ID：10705460
> 
> 赞同：0
> 
> 时间：2012-05-22T15:45:41.537
> 
> 标签：c#, winforms, listview

我有一个`MyListView`从 ListView 继承的类，并且正在覆盖`OnDragDrop()`（以及实现拖放的其他必要事件）。当我将其中两个`MyListview`s 放在一个表单上时，我可以从其中一个中拖动一个项目并将其拖放到另一个上。这部分有效。

现在我想覆盖`OnDoubleClick()`该类，这样如果我将其中两个`MyListViews`放在一个表单上并双击其中一个，则该项目将从该类中删除并添加到另一个中。但我无法理解如何做到这一点。你能给我一些想法吗？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T15:51:48.527

通过以下方式将逻辑放入您的主机表单中：

*   处理第一个 ListView 的双击
*   从第一个 ListView 中删除
*   添加到第二个 ListView

除非您以多种不同的形式执行此操作——否则不值得将其复杂化。

编辑：如果有道理，集中可以像添加一个做同样事情的方法一样简单（伪代码）

```
public void MyForm_OnListViewDoubleClick(object sender, EventArgs e)
{
   MoveListItem(firstListView, secondListView);
}
// ... 
public static void MoveListItem(ListView source, ListView destination) 
{
   var listItem = source.SelectedItem;
   source.Remove( listItem );
   destination.Add( listItem );
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T15:51:52.457

不知道您是否以特定方式管理项目的选择，但您可以

*   或在处理后双击查找[SelectedItems](http://msdn.microsoft.com/it-it/library/system.windows.forms.listview.selecteditems.aspx)并对其采取行动

*   或者您可以使用[ListViewHitTestInfo](http://msdn.microsoft.com/it-it/library/system.windows.forms.listviewhittestinfo.aspx)类添加这样的代码：

    ```
    private override OnDoubleClick(...)    
    {

       ListViewHitTestInfo hit = this.HitTest(e.Location);
       if (hit.Item != null)
       {
          ListViewItem doubleClickedItem = hit.Item; 
       }
    } 
    ```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-22T18:18:49.620

这是你标题的答案

```
protected override void OnDoubleClick(EventArgs e)
{
    base.OnDoubleClick(e);
} 
```

这是您问题的答案

[在从 ListView 继承的类上使用 DoubleClick 事件](https://stackoverflow.com/questions/10706891/using-doubleclick-event-on-a-inherited-class-from-listview/10707065#10707065) 这只是链接回您的另一个非常相似的问题。

# c# - 需要一种动态生成 XML 的方法

> ID：10705461
> 
> 赞同：1
> 
> 时间：2012-05-22T15:45:43.413
> 
> 标签：c#, xml

我有一种情况，我需要在我的 C# 代码中动态生成以下 XML。例如，XML 文本将是

```
<Envelope>
  <Body>
    <Login>
      <USERNAME>username</USERNAME>
      <PASSWORD>Sm@rt123</PASSWORD>
    </Login>
  </Body>
</Envelope> 
```

要求是将上述 XML 格式作为字符串发送到 API 调用，它会以 XML 格式的字符串形式获得一些响应。

我的问题是上面的示例是针对 Login Api 调用的，对于所有 api 调用，元素 Envelope 和 Body 都是相同的，并且基于 api 调用，其他部分会像 Login api 一样发生变化，我需要提到一个 xml 元素使用其属性用户名和密码登录。

到目前为止，我一直在对上面的字符串进行硬编码并尝试测试功能是否正常工作，但现在我需要自动化为各个不同的 api 调用生成这些标签的过程。我需要知道如何做到这一点以及最好的方法是什么。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-22T16:04:39.403

像这样流利的东西...

```
internal class Program
{
    private static void Main(string[] args)
    {
        new API()
            .Begin()
            .Login("username", "password")
            .Send("someuri");
        Console.ReadLine();
    }
}

public class API
{
    public static readonly XNamespace XMLNS = "urn:hello:world";
    public static readonly XName XN_ENVELOPE = XMLNS + "Envelope";
    public static readonly XName XN_BODY = XMLNS + "Body";

    public XDocument Begin()
    {
        // this just creates the wrapper
        return new XDocument(new XDeclaration("1.0", Encoding.UTF8.EncodingName, "yes")
                                , new XElement(XN_ENVELOPE
                                    , new XElement(XN_BODY)));
    }
}

public static class APIExtensions
{
    public static void Send(this XDocument request, string uri)
    {
        if (request.Root.Name != API.XN_ENVELOPE)
            throw new Exception("This is not a request");

        // do something here like write to an http stream or something
        var xml = request.ToString();
        Console.WriteLine(xml);
    }
}

public static class APILoginExtensions
{
    public static readonly XName XN_LOGIN = API.XMLNS + "Login";
    public static readonly XName XN_USERNAME = API.XMLNS + "USERNAME";
    public static readonly XName XN_PASSWORD = API.XMLNS + "PASSWORD";

    public static XDocument Login(this XDocument request, string username, string password)
    {
        if (request.Root.Name != API.XN_ENVELOPE)
            throw new Exception("This is not a request");

        // you can have some fancy logic here
        var un = new XElement(XN_USERNAME, username);
        var pw = new XElement(XN_PASSWORD, password);
        var li = new XElement(XN_LOGIN, un, pw);
        request.Root.Element(API.XN_BODY).Add(li);
        return request;
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-22T15:58:14.500

```
/// <summary>
///   Create an xml string in the expected format for the login API call.
/// </summary>
/// <param name="user">The user name to login with.</param>
/// <param name="password">The password to login with.</param>
/// <returns>
///   Returns the string of an xml document with the expected schema, 
///   to use with the login API.
/// </returns>
private static string GenerateXmlForLogin(string user, string password)
{
    return
        new XElement("Envelope",
            new XElement("Body",
                new XElement("Login",
                    new XElement("USERNAME", user),
                    new XElement("PASSWORD", password)))).ToString();
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-09T05:06:06.207

如果您在 wpf 中编写 c# 代码，此代码将帮助您很好地动态生成 xml 文件。

```
using System.Xml;

public Window1()
    {
        this.InitializeComponent();

        XmlDocument myxml = new XmlDocument();

        XmlElement envelope_tag = myxml.CreateElement("Envelope");

        XmlElement body_tag = myxml.CreateElement("Body");
        envelope_tag.AppendChild(body_tag);

        XmlElement Login_tag=myxml.CreateElement("Login");
        body_tag.AppendChild(Login_tag);

        XmlElement username = myxml.CreateElement("USERNAME");
        username.InnerText = "username";
        Login_tag.AppendChild(username);

        XmlElement password = myxml.CreateElement("PASSWORD");
        password.InnerText = "rt123";
        Login_tag.AppendChild(password);

        myxml.AppendChild(envelope_tag);
        myxml.Save(@"D:\Myxml.xml");   //you can save this file wherever you want to store. it may c: or D: and etc...      

    } 
```

输出将是这样的

![我的 XML](../Images/b9b3268147e11d0efd278c292e29e58f.png)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-22T16:13:19.083

我将建议将序列化作为一种​​输出到 XML 的简单方法。这是一个简单的例子：

首先创建类

```
Public Class Login
    Public Property USERNAME() As String
        Get
            Return _USERNAME
        End Get
        Set(ByVal value As String)
            _USERNAME = value
        End Set
    End Property
    Private _USERNAME As String

    Public Property PASSWORD() As String
        Get
            Return _PASSWORD
        End Get
        Set(ByVal value As String)
            _PASSWORD = value
        End Set
    End Property
    Private _PASSWORD As String
End Class

Public Class Body
    Public Property Login() As Login
        Get
            Return _login
        End Get
        Set(ByVal value As LoginClass)
            _login = value
        End Set
    End Property
    Private _login As Login = New Login()
End Class

Public Class Envelope
    Public Property Body() As Body
        Get
            Return _body
        End Get
        Set(ByVal value As Body)
            _body = value
        End Set
    End Property
    Private _body As Body = New Body()
End Class 
```

然后，创建一个信封对象，填充它，然后对其进行序列化：

```
Dim envelope As New Envelope()
envelope.Body.Login.USERNAME = "username"
envelope.Body.Login.PASSWORD = "Sm@rt123"

Dim stream As MemoryStream = New MemoryStream()
Dim textWriter As XmlTextWriter = New XmlTextWriter(stream, New System.Text.UTF8Encoding(False))
Dim serializer As XmlSerializer = New XmlSerializer(GetType(Envelope))
Dim namespaces As XmlSerializerNamespaces = New XmlSerializerNamespaces()
namespaces.Add("", "")
serializer.Serialize(textWriter, envelope, namespaces)
Dim doc As XmlDocument = New XmlDocument()
doc.LoadXml(Encoding.UTF8.GetString(stream.ToArray()))
Dim xmlText As String = doc.SelectSingleNode("Envelope").OuterXml 
```

# java - 如果满足条件（例如验证传入选择），则取消 JComboBox 上的选择更改

> ID：10705468
> 
> 赞同：6
> 
> 时间：2012-05-22T15:45:57.503
> 
> 标签：java, swing, events, jcombobox, itemlistener

我正在尝试动态验证 JComboBox 选择的项目，如果验证不正确，我想取消选择更改。有没有办法实现它？

```
private ItemListener itemListener = new ItemListener() {
    @Override                                            
    public void itemStateChanged(ItemEvent e) {
        if (e.getStateChange() == ItemEvent.SELECTED) {
            if (true) CANCEL_CHANGE;
        }
    }
}; 
```

我试图定义一个 var 保存旧值，取消注册侦听器，并手动选择以前的状态，但是问题出现在第一次更改上，因为 var 未初始化并且无法保存原始值。

我也尝试使用 ActionListener，但找不到以编程方式取消更改的方法，而且我不需要触发事件然后没有更改，但我正在手动评估 setSelection 的机会，所以我恢复到 ItemListener。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-22T16:05:12.340

在不存在先前选择的初始场景中，只需将其默认为默认选择索引，例如 0。

请参阅下面的示例代码：

```
import java.awt.event.ItemEvent;
import java.awt.event.ItemListener;

import javax.swing.JComboBox;
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.JTextField;

public class TestChangeListener {

    final JTextField jTextField = new JTextField(20);
    Object list[] = { "ItemA", "ItemB" };
    int oldSelectionIndex = -1;
    final JComboBox jComboBox = new JComboBox(list);

    void init() {
        JFrame jFrame = new JFrame("Test");
        JPanel jPanel = new JPanel();
        new TestChangeListener();
        jPanel.add(jTextField);
        jPanel.add(jComboBox);
        jFrame.add(jPanel);
        jComboBox.addItemListener(new ItemListener() {
            @Override
            public void itemStateChanged(ItemEvent event) {
                if (event.getStateChange() == ItemEvent.SELECTED) {
                    if (!"Okay".equalsIgnoreCase(jTextField.getText())) {
                        if (oldSelectionIndex < 0) {
                            jComboBox.setSelectedIndex(0);
                        } else {
                            jComboBox.setSelectedIndex(oldSelectionIndex);
                        }
                    } else {
                        oldSelectionIndex = jComboBox.getSelectedIndex();
                    }
                }
            }
        });
        jFrame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        jFrame.pack();
        jFrame.setVisible(true);
    }

    public static void main(String args[]) {
        javax.swing.SwingUtilities.invokeLater(new Runnable() {
            public void run() {
                new TestChangeListener().init();
            }
        });
    }
} 
```

第一次 textField 不包含任何数据时，它只是选择默认项目，在这种情况下它的第 0 个元素，你可以拥有它自己的。如果存在数据，它会检查然后决定是否应使用当前选择。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-22T15:58:38.817

我能做到，不知道为什么你不能做到。看看这个代码示例，选择任何值三次，然后在第四次它将恢复为空字符串：

```
import java.awt.*;
import java.awt.event.*;
import javax.swing.*;

public class ComboTest {

    private JLabel imageLabel;
    private JComboBox comboImage;

    private String[] names = {"", "ukIcon","caIcon","unknwon"};
    private boolean flag;
    private int counter;

    public ComboTest(){
        flag = false;
        counter = 0;
        initComponents();
    }

    public void initComponents(){
        JFrame frame = new JFrame("Test Combo");        
        frame.setSize(320, 160);
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.setLayout(new FlowLayout());

        comboImage = new JComboBox(names);
        comboImage.addItemListener(new ItemListener(){
            public void itemStateChanged(ItemEvent event){
                if(event.getStateChange() == ItemEvent.SELECTED){
                    if (flag)
                        comboImage.setSelectedItem("");
                    else
                    {
                        counter++;
                        if (counter == 3)
                            flag = true;
                        System.out.println((String) comboImage.getSelectedItem());
                    }   
                }
            }
        });

        frame.add(comboImage);
        frame.setVisible(true);
    }

    public static void main(String... args)
    {
        javax.swing.SwingUtilities.invokeLater(new Runnable()
        {
            public void run()
            {
                new ComboTest();
            }
        });
    }
} 
```

**具有先前值的代码**

```
import java.awt.*;
import java.awt.event.*;
import javax.swing.*;

public class ComboTest {

    private JLabel imageLabel;
    private JComboBox comboImage;

    private String[] names = {"", "ukIcon","caIcon","unknwon"};
    private boolean flag;
    private int counter;
    private String previousValue;

    public ComboTest(){
        flag = false;
        counter = 0;
        previousValue = "";
        initComponents();
    }

    public void initComponents(){
        JFrame frame = new JFrame("Test Combo");        
        frame.setSize(320, 160);
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.setLayout(new FlowLayout());

        comboImage = new JComboBox(names);
        comboImage.addItemListener(new ItemListener(){
            public void itemStateChanged(ItemEvent event){
                if(event.getStateChange() == ItemEvent.SELECTED){
                    if (flag)
                        comboImage.setSelectedItem(previousValue);
                    else
                    {
                        counter++;
                        if (counter == 3)
                            flag = true;
                        previousValue = (String) comboImage.getSelectedItem();  
                        System.out.println((String) comboImage.getSelectedItem());
                    }   
                }
            }
        });

        frame.add(comboImage);
        frame.setVisible(true);
    }

    public static void main(String... args)
    {
        javax.swing.SwingUtilities.invokeLater(new Runnable()
        {
            public void run()
            {
                new ComboTest();
            }
        });
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-06-19T14:09:48.303

事实上，没有办法阻止JComboBox中的选择发生变化。所有之前的示例并没有真正阻止选择更改，而是他们只是在更改后将选择设置回之前选择的项目。

如果您查看 JTree，您会发现 TreeWillExpandListener，它可以让您否决扩展，因为您将在 TreeWillExpandEvent 扩展之前收到它。

如果您将 ItemListener 添加到 JComboBox，您将在选择更改后收到 ItemEvents。如果 ItemEvent 的 stateChange 为 DESELECTED，则 getItem() 将为您提供先前选择的项目。但是，如果您调用 getSelectedItem() 它会给您另一个项目，因为选择已经更改。

# intellij-idea - 禁用 IntelliJ 后向分析

> ID：10705477
> 
> 赞同：4
> 
> 时间：2012-05-22T15:46:38.683
> 
> 标签：intellij-idea

我在 IntelliJ IDEA 中启用了一些检查，现在导致了冗长的**反向分析**。你知道哪些检查会导致这种情况吗？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-08-12T00:23:47.320

您可能检查了声明冗余 -> 未使用的库选项。对我来说，这总是会触发向后分析，通常会导致 OutOfMemoryError 情况。

# css - 带有 css 的中心 jquery 滑块

> ID：10705478
> 
> 赞同：2
> 
> 时间：2012-05-22T15:46:44.153
> 
> 标签：css, jquery-plugins, slider, css-float, centering

我的页面上有一个 jquery 滑块，当页面足够宽以适合它时居中，但与窗口的左边缘对齐并在窗口较小时移动。下面是我的 CSS - 我错过了什么吗？

```
#billboardWrapper {height:600px;width:100%;margin:-170px 0 0 0px; position:relative; overflow:hidden; /*border-width: 0 20px 20px 20px; border-style:solid; border-color: {{settings.billboard_color}}; /* can't use border shorthand. IE9 has a rendering bug, see more notes in the ie8.css file */ }

#billboard {height:600px;width:1000px;position:relative;/*background:#1c1c1c;*/ background-position: 50% 0pt;}

#billboardPrev,
#billboardNext { display:block; text-indent:-9999px; position:absolute; left:40px; top:270px; width:30px; height:30px; cursor:pointer; background: url(arrows.png) no-repeat 0 0; z-index:99;}
#billboardNext {left:auto; right:40px; background-position:0 -92px; }

.slide {height:600px;width:1000px;display:none;  } 
.slide img {height:600px;  width:100%; background-position: 50% 0pt;  
.slideLeftLayout .slideTitle,.slideLeftLayout .slideText,.slideLeftLayout .slideLink {left:50px;}
.slideRightLayout .slideTitle,.slideRightLayout .slideText,.slideRightLayout .slideLink {right:50px;text-align:right;} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-22T15:51:57.617

也许它是偶然在更大的屏幕上居中的。

当您有以下情况时，居中通常会起作用：

```
width: (any-FIXED-WIDTH-value); - Good spot Bram Vanroy ;)
margin: auto; 
```

我看不到...

你真的应该添加你的 HTML，如果可能的话，启动一个 jsfiddle 并包含链接。这样其他用户可以使用它并为您解决它，我们也可以更好地理解您的代码。

希望有帮助

# python - Python网络编程（绑定外部地址）

> ID：10705479
> 
> 赞同：1
> 
> 时间：2012-05-22T15:46:44.607
> 
> 标签：python, networking

我是 python 的新手，就在几天前，我开始尝试网络编程（我也是那里的新手）

现在我找到了一个简洁的客户端服务器程序，它在我的计算机上运行非常简单，但是当我替换本地地址并告诉我的朋友运行客户端脚本时，它就是不会响应。

我的全球IP地址：120.59.XX.XXX

ipconfig 返回的我的 IPv4 地址：192.168.1.2（我通过路由器连接到互联网）

我的网关地址：192.168.1.1

使用的端口：1060（我在本地测试了这个端口，它没有被使用）

```
#server.py

import socket
import sys

server = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)

MAX = 65535
PORT = 1060

server.bind(('192.168.1.2', PORT))
print 'Listening at', server.getsockname()
while True:
    data, address = server.recvfrom(MAX)
    print 'The client at', address, 'says', repr(data)
    server.sendto('Your data was %d bytes' % len(data), address) 
```

客户代码：

```
#client.py

import socket
import sys

client = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)

PORT = 1060
MAX = 65536

client.sendto('Hello Server!', ('120.59.XX.XXX', PORT))
data, address = client.recvfrom(MAX)
print 'The server', address, 'says', repr(data) 
```

我在我的电脑上启动了 server.py 并告诉我的朋友启动 client.py，我允许通过防火墙传入到 python 的连接，我还将 1060 端口添加到 windows 传入连接列表中。

它仍然没有响应，我无法解释原因（我有一个动态 IP 地址，但对于当前会话，它保持不变，因此应该可以工作，1060 也是一个众所周知的端口，应该不是问题吧？ )

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T15:53:38.067

您需要在路由器中添加端口转发规则！类似于从端口 1060 转发到 192.168.1.2 端口 1060。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T15:56:43.870

您需要路由器上的*端口转发*，它将连接到端口 1060 上路由器外部（全局）地址的连接转发到您的桌面 IP`192.168.1.2`端口 1060。

# database - 与外部数据库建立第二个连接

> ID：10705481
> 
> 赞同：0
> 
> 时间：2012-05-22T15:46:53.520
> 
> 标签：database, zend-framework, frameworks

我使用经典连接，它通过从 application.ini 文件中读取参数在引导程序中创建。我想使用更多的外部数据库，但我无法从 application.ini 中读取它们。我更喜欢从主数据库读取参数（它是哪个外部数据库，取决于网站）。那么如何有效地在模型中建立连接？现在，我每次需要使用它时都会设置该连接。当我需要使用主数据库时，需要再次建立连接。这是非常无效的解决方案。

```
function joinClientDB($id)
{
    $web = $this->getById($id);
    $dbSettings = array();
    $dbSettings['host'] = $web['web_dbHost'];
    $dbSettings['username'] = $web['web_dbUsername'];
    $dbSettings['password'] = $web['web_dbPassword'];
    $dbSettings['dbname'] = $web['web_dbName'];
    $this->_db = Zend_Db::factory('pdo_mysql', $dbSettings);
    $this->_db->query('SET CHARACTER SET ' . $web['web_dbCharset']);
}

function joinDefaultDb()
{
    $this->_db = Zend_Registry::get('db');
} 
```

有没有人为我提供简单的解决方案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T16:44:18.033

我建议使用 Zend MULTI DB 插件。将所有数据库连接添加到您的 applications.ini：

```
; Database ONE
resources.multidb.test.adapter = 
resources.multidb.test.dbname = 
resources.multidb.test.username = 
resources.multidb.test.password = ""
resources.multidb.test.host = "your.local.host"
resources.multidb.test.default = true

; Database TWO
resources.multidb.live.adapter = 
resources.multidb.live.dbname = 
resources.multidb.live.username = 
resources.multidb.live.password = ""
resources.multidb.live.host = "your.live.host.com" 
```

现在您可以再次将它们放入您的注册表中（bootstrap.php）：

```
protected function _initDbAdapters()
{
    $this->bootstrap('multidb');
    $resource = $this->getPluginResource('multidb');
    $resource>init();

    $testDB = $resource->getDb('test');
    $liveDB = $resource->getDb('live'); 

    Zend_Registry::set('DB_TEST', $testDB);
    Zend_Registry::set('DB_LIVE', $liveDB);
} 
```

# javascript - javascript 属性值依赖于其他属性

> ID：10705482
> 
> 赞同：1
> 
> 时间：2012-05-22T15:46:56.627
> 
> 标签：javascript

我制作了一个名为 Fullscreen 的对象，并在该对象中创建了另一个名为方向的对象。所以我的代码如下所示：

```
FullScreen = {
  directions: {
    prev: -1,
    next: 1
  }
} 
```

但我希望能够从对象外部设置 FullScreen.directions.prev，并将 FullScreen.directions.next 更改为 prev 的负值。任何想法如何做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-22T15:48:35.060

如果我正确理解了这个问题，就这么简单：

```
FullScreen.directions.prev = -42;
FullScreen.directions.next = -FullScreen.directions.prev; 
```

然而，将这个逻辑封装在一个函数中可能会更好：

```
FullScreen = {
  directions: {
    prev: -1,
    next: 1,
    setPrev: function (value) {
        value = +value; // coerce to number
        this.prev = value;
        this.next = -value;
    }
  }
}

// then
FullScreen.direction.setPrev(-42); 
```

[使用特殊`get/set`语法](https://developer.mozilla.org/en/JavaScript/Guide/Working_with_Objects#Defining_getters_and_setters)你可以变得更漂亮：

```
FullScreen = {
  directions: {
    _prev: -1,
    _next: 1,
    get prev() {
        return this._prev;
    },
    set prev(value) {
        value = +value; // coerce to number
        this._prev = value;
        this._next = -value;
    },
    get next() {
        return this._next;
    }
  }
}

// then
FullScreen.direction.prev = -42;
// invokes the setter function behind the scenes, so that _next is also set 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T15:49:56.010

要自动实现这一点，您需要在对象上使用`get`和`set`函数。`directions`

理想情况下，您将拥有一个包含实际值的单独变量，并且每次您使用`set`其中一个属性时，您都会更改该变量，但每次`get`您检索从该变量计算的值时。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-22T16:04:45.850

你可以这样做：

```
var directions = {
    current: 0,
    prev: function () {
        return -current;
    },
    next: function () {
        return current;
    }
}; 
```

然后你可以与它交互并修改你的而`directions.current`不是值。`next``prev`

# c# - 如何在同一个数据文件上运行多个 LINQ 查询

> ID：10705484
> 
> 赞同：0
> 
> 时间：2012-05-22T15:47:05.933
> 
> 标签：c#, linq

我是新手，`LINQ`目前正在使用它来处理 csv 格式的大数据集（半百万条记录）。我正在使用 a`StreamReader`打开文件并实现`IEnumerable<>`接口以填充结果。下面你可以看到阅读代码的主要部分：

```
IEnumerator<Person> IEnumerable<Person>.GetEnumerator()
{
    using (StreamReader streamReader = new StreamReader(filename)){
        streamReader.ReadLine();
        while (!streamReader.EndOfStream){
            string[] values = streamReader.ReadLine().Split(new char[] { ',' });
            Person p = new Person();
            p.Name = values[0];
            p.Age = Convert.ToInt16(values[1]);
            p.Score = Convert.ToDouble(values[2]);
            p.PlotArea = Convert.ToInt16(values[3]);
            p.ForecastConsumption = Convert.ToDouble(values[4]);
            p.Postcode = values[5];
            p.PropertyType = values[6];
            p.Bedrooms = Convert.ToInt16(values[7]);
            p.Occupancy = Convert.ToInt16(values[8]);

            yield return p;
        }
    }
} 
```

这是一个典型的查询：

```
var query = from person in reader
            where person.Score > 36.55 && person.Bedrooms < 3
            select person; 
```

我的问题是，每次我想运行查询时`StreamReader`都必须打开文件。有什么方法可以打开文件一次并运行多个查询？

仅供参考，我对 LINQ 印象深刻，运行上面的查询需要 1.2 秒。只是我将为数据集运行很多规则。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T15:50:06.373

> 我的问题是，每次我想运行查询时，StreamReader 都必须打开文件。有什么方法可以打开文件一次并运行多个查询？

那么最简单的方法是将整个文件加载到列表中，例如

```
var list = reader.ToList();

// Now run multiple queries over list 
```

显然这将占用大量内存，但这将是*最简单*的方法。如果您想将多个查询连接在一起，您必须*准确地确定*您想要做什么 - LINQ 中的组合模型主要是将查询操作*链接*在一起，而不是从同一源构建多个查询。

如果做不到这一点，如果“一次通过多个查询”和“将整个文件加载到内存中”的复杂性都不适合您，那么您可能会被多次加载它所困。

一种*可能*更节省内存的中间选项是将所有*行*读入内存（因此您只需执行一次磁盘活动），然后多次*解析这些行。*这在 IO 方面效率更高，但在 CPU 方面更差。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T15:51:37.860

您的情况将是以下之间的性能权衡：

1.  将整个文件读入内存，并运行您需要的任何查询
2.  只需多次迭代文件即可。

如果是后者，请尝试使用`File.ReadLines`which 在文件 IO 上提供一个不错的 IEnumerable 接口：

```
public Person ReadPerson(string[] personLine)
{
    Person p = new Person();
    p.Name = personLine[0];
    p.Age = Convert.ToInt16(personLine[1]);
    p.Score = Convert.ToDouble(personLine[2]);
    p.PlotArea = Convert.ToInt16(personLine[3]);
    p.ForecastConsumption = Convert.ToDouble(personLine[4]);
    p.Postcode = personLine[5];
    p.PropertyType = personLine[6];
    p.Bedrooms = Convert.ToInt16(personLine[7]);
    p.Occupancy = Convert.ToInt16(personLine[8]);
} 
```

和用法：

```
var file = File.ReadLines("/filepath/")
    .Select(line => ReadPerson(line.Split(',')));

var query = from person in file
    where person.Score > 36.55 && person.Bedrooms < 3
    select person; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-22T15:56:02.703

这应该有效：

```
 return from line in File.ReadAllLines(filename)
                     let values = line.Split(new char[] { ',' })
                     select new Person{
                Name = values[0];
                Age = Convert.ToInt16(values[1]);
                Score = Convert.ToDouble(values[2]);
                PlotArea = Convert.ToInt16(values[3]);
                ForecastConsumption = Convert.ToDouble(values[4]);
                Postcode = values[5];
                PropertyType = values[6];
                Bedrooms = Convert.ToInt16(values[7]);
                Occupancy = Convert.ToInt16(values[8]);
            }; 
```

# multithreading - 从 Qt 控制相机：操作系统线程与事件循环的交互

> ID：10705490
> 
> 赞同：0
> 
> 时间：2012-05-22T15:47:24.920
> 
> 标签：multithreading, qt, camera, sleep

我正在开发一个 Qt 应用程序来控制工业相机，特别是我需要在特定时间触发相机（例如，当各种照明设置到位时），并等到返回一帧。在最简单的情况下，以下代码可以很好地完成这项工作：

```
void AcquireFrame()
{
    // Runs in the main GUI thread:
    camera -> m_mutex.lock();
    camera -> frameHasArrived = false;
    camera -> m_mutex.unlock();
    camera -> triggerImageAcquisition();

    forever
    {
        camera -> m_mutex.lock()
        bool isReady = camera -> frameHasArrived;
        camera -> m_mutex.unlock()
        if (isReady)
        {
            return;
        }
        else
        {
            Sleep(10);
        }
    }
}

void callback(camera *)
{
    // Called by the camera driver from a separate OS thread - not a Qt thread - 
    // when a frame is ready:
    camera -> m_mutex.lock();
    camera -> frameHasArrived = true;
    camera -> m_mutex.unlock();
} 
```

...而且大多数情况下，这工作得很好。然而，这就是现实世界，偶尔相机接收不到触发信号或者电脑接收不到帧干净，上面的代码就会陷入死循环。

显而易见的做法是设置超时，因此如果在一定时间内未接收到帧，则可以再次尝试图像采集。修改后的代码如下所示：

```
void AcquireFrame()
{
    camera -> m_mutex.lock();
    camera -> frameHasArrived = false;
    camera -> m_mutex.unlock();
    camera -> triggerImageAcquisition();

    QTime timeout;
    timeout.start();
    forever
    {
        timeout.restart();

fetch:  camera -> m_mutex.lock()
        bool isReady = camera -> frameHasArrived;
        camera -> m_mutex.unlock()
        if (isReady)
        {
            return;
        }
        else if (timeout.elapsed() > CAM_TIMEOUT) 
        { 
            // Assume the first trigger failed, so try again:
            camera -> triggerImageAcquisition();
            continue;
        }
        else
        {
            Sleep(10);
            goto fetch;
        }
    }
} 
```

现在，问题在于后一个版本的失败率（“不成功触发器”的比例）要高得多——至少一个数量级。此外，这段代码最终也会陷入无限循环，无论它尝试重新触发相机多少次，它都没有看到任何帧返回。在后一种情况下，杀死应用程序并检查相机表明相机处于完美的工作状态并耐心等待下一次触发，因此它似乎不是相机问题。我得出的结论是，实际上这是某种系统资源问题或线程冲突，因此 Qt 的事件循环不允许在适当的时间调用相机回调。

这有可能吗，实际上是否有更好的方法来做到这一点？

* * *

6月6日更新：

对于它的价值，自从我采用下面的方法（给相机对象一个额外的成员，即一个名为'm_condition'的QWaitCondition）以来，我没有看到更多问题：

```
void AcquireFrame()
{
    bool frameReceived;

    forever
    {
        camera -> triggerImageAcquisition();

        camera -> m_mutex.lock();
        frameReceived = camera -> m_condition.wait(&camera->m_mutex, CAM_TIMEOUT);

        if (frameReceived)
        {
            // We received a frame from the camera, so can return:
            camera -> m_mutex.unlock();
            return;
        }

        // If we got to here, then the wait condition must have timed out. We need to
        // unlock the mutex, go back to the beginning of the 'forever' loop and try 
        // again:
        camera -> m_mutex.unlock();
    }
}

void callback (camera *)
{
    // Called by the camera driver from a separate OS thread -
    // not a QThread - when a frame is ready:
    camera -> m_condition.wakeOne();
} 
```

这仍然具有暂停主线程的效果，直到我们接收到帧或经历超时，但现在我们已经消除了 Sleep() 并且 Qt 事件循环始终处于完全控制之下。我仍然不清楚为什么旧方法会引起这么多问题——我仍然怀疑某种系统资源限制——但这种新方法似乎更轻量级，而且效果更好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T06:09:34.483

在 GUI 线程中的互斥体上运行`AcquireFrame`that blocks 对我来说没有多大意义，除非你想用 GUI 响应来换取延迟，但我怀疑你是否关心这里的延迟，因为相机捕捉单帧并且你坚持处理它们首先是繁忙的 GUI 线程。

其次，Qt 不会做任何事情来阻止回调被另一个线程调用，除了另一个线程具有较低优先级并被较高优先级线程抢占，完全独占 CPU。

我只需从回调函数向 GUI 线程（或任何其他 QThread！）中的 QObject 发布一个事件。您可以从任何线程发布事件，这并不重要——重要的是接收者。`QCoreApplication::postEvent`毕竟是一个静态函数，它根本不检查当前线程。

在一个复杂的应用程序中，您可能希望将逻辑放在专用的控制器 QObject 中，而不是分散在 QWidget 派生类中。因此，您只需将事件发布到控制器实例。

请注意，将事件发布到空闲的 GUI 线程将与使用互斥锁完全相同——Qt 的事件循环使用互斥锁并在该互斥锁和来自操作系统的消息上休眠。美妙的是，Qt 已经为您完成了所有的等待，但等待是可中断的。发布的事件应该具有高优先级，以便它最终成为队列中的第一个事件并抢占所有其他事件。当您准备好获取帧时，但在触发它之前，您可能可以调用`QCoreApplication::flush()`. 就是这样。

将单独的图像处理器 QObject 放在专用的 QThread 中以利用多核机器应该没有问题。然后，您可以将图像处理成 QImage，并使用另一个事件或简单地通过信号槽连接将该图像转发到 GUI 线程。您可能还可以在获取帧但才开始处理它时通知 GUI 线程。这样一来，用户就会更清楚地知道正在发生的事情。如果图像处理需要很长时间，您甚至可以发送映射到进度条的定期更新。

基准测试结果（使用发布版本）很有趣，但符合 Qt 的事件队列在内部由互斥锁保护的事实，并且事件循环在该互斥锁上等待。哦，结果似乎可以在 mac 和 windows xp 平台之间移植。

使用裸等待条件*不是*最快的方法，但使用裸发布事件更*慢*。最快的方法是使用排队的信号槽连接。在这种情况下，将事件发布到同一个线程（这就是`FrameProcessorEvents::tick()`所做的）的成本似乎可以忽略不计。

### 苹果电脑

```
warming caches...
benchmarking...
wait condition latency: avg=45us, max=152us, min=8us, n=1001
queued signal connection latency: avg=25us, max=82us, min=10us, n=1000
queued event latency: avg=71us, max=205us, min=14us, n=1000 
```

### VMWare Fusion 下的 Windows XP

请注意，超过 1 毫秒的结果可能是由于目前未安排 VMWare。

```
warming caches...
benchmarking...
wait condition latency: avg=93us, max=783us, min=8us, n=1000
queued signal connection latency: avg=46us, max=1799us, min=0us, n=1000
queued event latency: avg=117us, max=989us, min=18us, n=1001 
```

以下是基准测试代码。

```
#include <cstdio>
#include <limits>
#include <QtCore>

QTextStream out(stdout);

class TimedBase : public QObject
{
public:
    TimedBase(QObject * parent = 0) : QObject(parent) { reset(); }
    friend QTextStream & operator<<(QTextStream & str, const TimedBase & tb) {
        return str << "avg=" << tb.avg() << "us, max=" << tb.usMax << "us, min="
                   << tb.usMin << "us, n=" << tb.n;
    }
    void reset() { usMax = 0; n = 0; usMin = std::numeric_limits<quint32>::max(); usSum = 0; }
protected:
    quint64 n, usMax, usMin, usSum;
    quint64 avg() const { return (n) ? usSum/n : 0; }
    void tock() {
        const quint64 t = elapsed.nsecsElapsed() / 1000;
        usSum += t;
        if (t > usMax) usMax = t;
        if (t < usMin) usMin = t;
        n ++;
    }
    QElapsedTimer elapsed;
};

class FrameProcessorEvents : public TimedBase
{
    Q_OBJECT
public:
    FrameProcessorEvents(QObject * parent = 0) : TimedBase(parent) {}
public slots: // can be invoked either from object thread or from the caller thread
    void tick() {
        elapsed.start();
        QCoreApplication::postEvent(this, new QEvent(QEvent::User), 1000);
    }
protected:
    void customEvent(QEvent * ev) { if (ev->type() == QEvent::User) tock(); }
};

class FrameProcessorWait : public TimedBase
{
    Q_OBJECT
public:
    FrameProcessorWait(QObject * parent = 0) : TimedBase(parent) {}
    void start() {
        QTimer::singleShot(0, this, SLOT(spinner()));
    }
public: // not a slot since it must be always invoked in the caller thread
    void tick() { elapsed.start(); wc.wakeAll(); }
protected:
    QMutex mutex;
    QWaitCondition wc;
protected slots:
    void spinner() {
        forever {
            QMutexLocker lock(&mutex);
            if (wc.wait(&mutex, 1000)) {
                tock();
            } else {
                return;
            }
        }
    }
};

FrameProcessorEvents * fpe;
FrameProcessorWait * fpw;

static const int avgCount = 1000;
static const int period = 5;

class FrameSender : public QObject
{
    Q_OBJECT
public:
    FrameSender(QObject * parent = 0) : QObject(parent), n(0), N(1) {
        QTimer::singleShot(0, this, SLOT(start()));
    }
protected slots:
    void start() {
        out << (N ? "warming caches..." : "benchmarking...") << endl;
        // fire off a bunch of wait ticks
        n = avgCount;
        timer.disconnect();
        connect(&timer, SIGNAL(timeout()), SLOT(waitTick()));
        fpw->reset();
        fpw->start();
        timer.start(period);
    }
    void waitTick() {
        fpw->tick();
        if (!n--) {
            if (!N) { out << "wait condition latency: " << *fpw << endl; }
            // fire off a bunch of signal+event ticks
            n = avgCount;
            fpe->reset();
            timer.disconnect();
            connect(&timer, SIGNAL(timeout()), fpe, SLOT(tick()));
            connect(&timer, SIGNAL(timeout()), SLOT(signalTick()));
        }
    }
    void signalTick() {
        if (!n--) {
            if (!N) { out << "queued signal connection latency: " << *fpe << endl; }
            // fire off a bunch of event-only ticks
            n = avgCount;
            fpe->reset();
            timer.disconnect();
            connect(&timer, SIGNAL(timeout()), SLOT(eventTick()));
        }
    }
    void eventTick() {
        fpe->tick();
        if (!n--) {
            if (!N) { out << "queued event latency: " << *fpe << endl; }
            if (!N--) {
                qApp->exit();
            } else {
                start();
            }
        }
    }

protected:
    QTimer timer;
    int n, N;
};

int main(int argc, char *argv[])
{
    QCoreApplication a(argc, argv);
    QThread eThread;
    QThread wThread;
    eThread.start(QThread::TimeCriticalPriority);
    wThread.start(QThread::TimeCriticalPriority);
    fpw = new FrameProcessorWait();
    fpe = new FrameProcessorEvents();
    fpw->moveToThread(&eThread);
    fpe->moveToThread(&wThread);
    FrameSender s;
    a.exec();
    eThread.exit();
    wThread.exit();
    eThread.wait();
    wThread.wait();
    return 0;
}

#include "main.moc" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T15:50:50.937

检测触发状态并触发相机需要多少工作量？
如果那相对便宜-我将有一个单独的线程来阻止触发事件并触发相机。然后通过从回调函数发送的 Qt 信号通知主线程。

# entity-framework - DbContext 实体的 Assert.AreEqual 单元测试

> ID：10705498
> 
> 赞同：0
> 
> 时间：2012-05-22T15:47:56.420
> 
> 标签：entity-framework, unit-testing, entity-framework-4.1, assert

我希望对我的业务逻辑进行单元测试，通过业务逻辑加载实体并将其与直接从 dbcontext 加载的实体进行比较来加载正确的数据。

Assert.AreEqual 失败我猜是因为实体被加载为跟踪。

我认为我可以使用 AsNoTracking()，但它没有用。

有没有办法将实体从实体框架“解包”到 POCO？

我读过有关禁用代理创建的信息，但这是唯一的选择吗？

我希望在淘汰 JavaScript 库中与 ko.utils.unwrapObservable() 有类似的东西（尽管我意识到完全不同的概念）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T08:13:50.753

这是一个奇怪的集成测试（它根本不是单元测试，因为它使用数据库） - 只需定义静态期望而不是从数据库再次加载它就足够了。动态测试更容易出错并且可以隐藏问题。

要使其工作，您必须覆盖`Equal`以比较数据而不是引用。禁用代理创建将不起作用，因为您仍然会有来自业务逻辑的不同引用和来自测试上下文的不同引用（除非您共享上下文，但在这种情况下测试会更加奇怪）。

# javascript - jQuery inArray() 总是返回 -1

> ID：10705499
> 
> 赞同：1
> 
> 时间：2012-05-22T15:47:56.477
> 
> 标签：javascript, jquery, sorting

我想对这样的列表进行排序：

```
<ul>
    <li>L</li>
    <li>S</li>
    <li>XXS</li>
    <li>XS</li>
    <li>XL</li>
    <li>L</li>
</ul> 
```

使用 Javascript 和 jQuery 来获得正确的服装尺寸顺序，我的尝试是这样的：

```
var mylist = jQuery('#filter-size .mana-list');
var listitems = mylist.children('li').get();
listitems.sort(function (a, b) {

    var sizes = new Array();
    sizes = ["XXXS", "XXS", "XS", "S", "S-M", "S-L", "M", "M-L", "L", "L-XL", "XL", "XXL", "XXXL"];

    var compA = jQuery(a).text().toUpperCase();
    var compB = jQuery(b).text().toUpperCase();

    var asize = jQuery.inArray(compA, sizes);
    var bsize = jQuery.inArray(compB, sizes);

    return (asize > bsize) ? -1 : (asize < bsize) ? 1 : 0;
}) 
```

我的问题是 inArray() 函数总是返回 -1 我做错了什么？

（注意：我在“无冲突”模式下使用 jQuery）

谢谢大家

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T16:05:18.247

您的代码显得不必要地复杂。

这也将产生一个排序的项目列表，并避免在比较器函数中使用昂贵的 DOM（和 jQuery）调用：

```
// get all of the text items, in order, in upper case
var listitems = jQuery('ul').children('li').map(function() {
    return jQuery(this).text().toUpperCase();
}).get();

// keep this outside the function to avoid instantiating it
// every time the comparator is called
var sizes = ["XXXS", "XXS", "XS", "S", "S-M", "S-L", "M",
                 "M-L", "L", "L-XL", "XL", "XXL", "XXXL"];

// just compare the "inArray" values to sort    
listitems.sort(function(a, b) {
    return jQuery.inArray(b, sizes) - jQuery.inArray(a, sizes);
}) 
```

请注意在比较器函数中使用了一个简单的减号运算符 - 这个运算符从最大到最小排序，并且比较器只需要产生“负、零、正”，而不是“-1、0、1”。

注意：这不会改变页面中的元素 - 请澄清这是否是您的意图。

见[http://jsfiddle.net/alnitak/v3hqB/](http://jsfiddle.net/alnitak/v3hqB/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T16:22:24.340

对 Alnitak 出色答案的跟进。

你的分类很好。如果您确实想更新您的显示，类似以下的内容（快速编写）可以解决问题：

```
var newList = $('<ul></ul>');
newList.append(listitems);
mylist.replaceWith(newList); 
```

（可能有更好的方法......也许`newList`可以`listitems`一次性构建。）

# javascript - javascript 不更新 asp.net hiddenfield.value

> ID：10705510
> 
> 赞同：2
> 
> 时间：2012-05-22T15:48:32.563
> 
> 标签：javascript, asp.net, hidden-field

我想在回发之前通过 javascript 为 asp.net hiddenfield 分配一个值。

但是在隐藏字段后面的代码中value是null。我正在使用的代码是：

```
<asp:UpdatePanel ID="UpdatePanel1" runat="server" ChildrenAsTriggers="True" Visible="True">
        <Triggers>
            <asp:AsyncPostBackTrigger   ControlID="save1"    EventName="Click">         
            </asp:AsyncPostBackTrigger>
        </Triggers>
        <ContentTemplate>
            <asp:HiddenField ID="HiddenField1" runat="server" />
       </div>

        </ContentTemplate>
   </asp:UpdatePanel>

 <asp:Button ID="save1" runat="server" Text="Send"  OnClientClick="return SaveFase();"  />

       function SaveFase() {     
           var UP = jQuery.get('<% = HiddenField1.ClientID %>');
           UP.Value= "xxxxxxxxxxxxxxxxxxxx"
          return true             
       }

Protected Sub PassBackImage(sender As Object, e As EventArgs) Handles save1.Click

      dim Value = HiddenField1.Value      
End Sub 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T15:54:32.823

使用[ID 选择器](http://api.jquery.com/id-selector/)和[`.val()`](http://api.jquery.com/val/)方法：

```
var UP = jQuery('#<% = HiddenField1.ClientID %>');
UP.val("xxxxxxxxxxxxxxxxxxxx"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T15:50:23.290

你可能打算写：

```
$('#<% = HiddenField1.ClientID %>').val('xxxxxxxxxxxxxxxxxxxx'); 
```

另外，将您的 javascript 函数放在一个 stipt 块中：

```
<script type="text/javascript">
       function SaveFase() {     
           return $('#<% = HiddenField1.ClientID %>').val('xxxxxxxxxxxxxxxxxxxx');
       }
<script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-22T15:56:49.283

而不是使用 jQuery.get （这是对 HTTP GET 方法[http://api.jquery.com/jQuery.get/](http://api.jquery.com/jQuery.get/)的调用），使用

```
jQuery.find('#' + <% = HiddenField1.ClientID %>) 
```

然后从那里它应该工作。如果没有，请使用错误控制台查看调用时引发的错误（大多数浏览器都内置了一个。

# jquery - '无法从 jqGrid 获取属性'Id'的值'错误

> ID：10705513
> 
> 赞同：3
> 
> 时间：2012-05-22T15:48:37.610
> 
> 标签：jquery, asp.net-mvc, jqgrid, internet-explorer-9, asp.net-mvc-4

我正在尝试将 jqGrid 集成到 ASP.NET MVC 4 Razor 视图中，但遇到了一个让我感到困惑的问题。当我尝试使用 IE9 以调试模式访问视图时，我收到了以下 Javascript 错误：

`Microsoft JScript runtime error: Unable to get value of the property 'id': object is null or undefined.`

剃刀：

```
<link href="/Content/themes/ui-lightness/jquery-ui-1.8.19.custom.css" rel="stylesheet" type="text/css" />
<link href="/Content/jquery.jqGrid/ui.jqgrid.css" rel="stylesheet" type="text/css" />
<script src="~/Scripts/jquery-1.7.2.min.js" type="text/javascript"></script>
<script src="~/Scripts/i18n/grid.locale-en.js" type="text/javascript"></script>
<script src="~/Scripts/jquery.jqGrid.min.js" type="text/javascript"></script>
@using(Html.BeginForm())
{
    <fieldset>
        <legend>@Model.FirstName @Model.LastName - Contacts/Providers</legend>
        <table id="clientContacts" cellpadding="0" cellspacing="0"></table>
    </fieldset>
}
<script type="text/javascript">
    $(document).ready(function () {
        $("#clientContacts").jqGrid({
            url: '@Url.Action("GetClientContactsAndProviders")',
            datatype: 'json',
            mtype: 'POST',
            colNames: ['clientContactId', 'Type', 'Who', 'Phone', 'button', 'Comments'],
            colModel: [
                { name: 'clientContactId', index: 'clientContactId', hidden: true },
                { name: 'contactType', index: 'Type', width: 190, align: 'left' },
                { name: 'contactName', index: 'Who', width: 200, align: 'left' },
                { name: 'contactPhone', index: 'Phone', width: 100, align: 'left' },
                { name: 'newContactButton', index: 'button', width: 50, align: 'center' },
                { name: 'contactComments', index: 'Comments', width: 240, align: 'left'}
            ],
            rowNum: 20,
            width: 780,
            height: '100%'
        });
    });
</script> 
```

行动：

```
[AcceptVerbs(HttpVerbs.Post)]
public ActionResult GetClientContactsAndProviders(string sidx, string sord, int page, int rows)
{
    var clientId = CookieHelper.GetClientIdCookieValue();
    var client = _clientRepo.GetClient(clientId);
    var contacts = client.Contacts.ToList();
    var model = new
        {
            total = 1,
            page = 1,
            records = contacts.Count,
            rows = contacts.Select(c =>
                new
                    {
                        clientContactId = c.ClientContactId.ToString(),
                        contactType = c.ContactType.Description,
                        contactName =
                            c.Contact.Person.FirstName + " " + c.Contact.Person.LastName,
                        contactPhone = c.Contact.Person.Phone1 ?? string.Empty,
                        newContactButton = string.Empty,
                        contactComments = c.Comments ?? string.Empty
                    }).ToArray()
        };
    return Json(model);
} 
```

我在 Chrome 中没有收到此错误，而且我一生都无法弄清楚这个神秘的“id”属性是什么。请帮忙！

**编辑（在@Justin Ethier 回答之后）：** 完全披露，认为这并不重要，但我试图在这种情况下传递四个“空”行。在这些情况下，`clientContactId`默认为 0，我认为这可能是问题的一部分。我改变了我的网格Javascript如下：

```
$(document).ready(function () {
    $("#clientContacts").jqGrid({
        url: '@Url.Action("GetClientContactsAndProviders")',
        datatype: 'json',
        mtype: 'POST',
        colNames: ['clientContactId', 'Type', 'Who', 'Phone', 'button', 'Comments'],
        colModel: [
            { name: 'clientContactId', index: 'clientContactId', hidden: true },
            { name: 'contactType', index: 'Type', width: 190, align: 'left' },
            { name: 'contactName', index: 'Who', width: 200, align: 'left' },
            { name: 'contactPhone', index: 'Phone', width: 100, align: 'left' },
            { name: 'newContactButton', index: 'button', width: 50, align: 'center' },
            { name: 'contactComments', index: 'Comments', width: 240, align: 'left'}
        ],
        rowNum: 20,
        width: 780,
        height: '100%',
        jsonReader: {
            root: 'rows',
            page: 'page',
            total: 'total',
            records: 'records',
            repeatitems: true,
            cell: 'cell',
            id: 'clientContactId',
            userdata: 'userdata',
            subgrid: { root: 'rows', repeatitems: true, cell: 'cell' }
        }            
    });
}); 
```

然后，最重要的是，当四行“空”时，我添加了这段代码来构建`rows`jqGrid 期望的对象：

```
var rowBuilder = new List<object>();
for(var i = 0;i < contacts.Count; i++)
{
    rowBuilder.Add(new
                       {
                           id = i + 1,
                           cell = new
                                      {
                                          clientContactId = contacts[i].ClientContactId.ToString(),
                                          contactType = contacts[i].ContactType.Description,
                                          contactName =
                       contacts[i].Contact.Person.FirstName + " " + contacts[i].Contact.Person.LastName,
                                          contactPhone = contacts[i].Contact.Person.Phone1 ?? string.Empty,
                                          button = string.Empty,
                                          contactComments = contacts[i].Comments ?? string.Empty
                                      }
                       });
}
var model = new
                {
                    total = 1,
                    page = 1,
                    records = contacts.Count,
                    rows = rowBuilder.ToArray()
                };
return Json(model); 
```

现在它起作用了！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-22T16:01:16.693

jqGrid 使用 a`jsonReader`来检索 json 数据。如果未明确提供，则[根据 jqGrid 文档](http://www.trirand.com/jqgridwiki/doku.php?id=wiki%3aretrieving_data#json_data)，网格将使用以下默认值：

```
{ 
  "total": "xxx", 
  "page": "yyy", 
  "records": "zzz",
  "rows" : [
    {"id" :"1", "cell" :["cell11", "cell12", "cell13"]},
    {"id" :"2", "cell":["cell21", "cell22", "cell23"]},
      ...
  ]
} 
```

我怀疑`id`您收到的错误是`id`默认读者期望的列，而您的结果集中缺少该列。您应该能够通过提供指定正确行 ID 的阅读器来解决此问题：

```
jsonReader : {
    root: "rows",
    page: "page",
    total: "total",
    records: "records",
    repeatitems: true,
    cell: "cell",
    id: "clientContactId",
    userdata: "userdata",
    subgrid: {root:"rows", 
    repeatitems: true, 
    cell:"cell"
    }
}, 
```

这有帮助吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T09:20:15.057

获取Firefox中的单元格值，您必须使用的chrome...

`Trow.cells[0].childNodes[0].nodeValue`将适用于所有浏览器，同时

`Trow.cells[0].innerText`仅适用于 ie 不适用于 firefox 和 chrome....

# javascript - 为什么这个代码块会创建一个无限循环？

> ID：10705519
> 
> 赞同：1
> 
> 时间：2012-05-22T15:49:10.050
> 
> 标签：javascript, jquery

今天早些时候我在玩小提琴，试图回答一个问题，发现了一个令人困惑的事情。作为一个 JS 新手，我无法自己调试出了什么问题。我什至尝试检查`$.fn.show`jQuery 源代码中的 source0 ，但无法弄清楚出了什么问题。

**HTML：**

```
<input type='text' id='dataBox'/>
<input type='button' value='toggle' id='toggleButton' />​ 
```

**jQuery代码：**

```
jQuery(function ($) {
    var _oldShow = $.fn.show;
    $.fn.show = function (speed, oldCallback) {
        return $(this).each(function () {
            var obj = $(this),
                newCallback = function () {

                    if ($.isFunction(oldCallback)) {
                        oldCallback.apply(obj);
                    }
                    obj.trigger('afterShow');
                };
            obj.trigger('beforeShow');
            if(speed)    
                _oldShow.apply(obj, [speed,newCallback]);
            else    
                _oldShow.apply(obj, [newCallback]);
        });
    }
});

$('#dataBox').bind('beforeShow', function () {
        alert('beforeShow');
    });

$('#toggleButton').click(function(){
        $('#dataBox').show();
}); 
```

问题是我犯了一些错误，导致这条线无限次执行 obj.trigger('beforeShow');

因此`alert`在这个块中

```
 $('#dataBox').bind('beforeShow', function () {
    alert('beforeShow');
 }); 
```

似乎停不下来。

不管我要做什么，或者是否可以通过其他任何方式完成，有人可以在这里解释我做错了什么。我已经尝试了几个小时，但无法弄清楚。

[小提琴](http://jsfiddle.net/joycse06/evdpj/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T16:02:48.577

让我们看看这个部分

```
 if(speed)    
        _oldShow.apply(obj, [speed,newCallback]);
    else    
        _oldShow.apply(obj, [newCallback]);

    }); 
```

`_oldShow`像之前一样被分配`$.fn.show;`，并`.apply()`调用一个带有参数的函数作为一个数组，并且能够设置`this`. [（看这里）](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Function/apply)

所以，在函数结束时，我们总是会再次调用该函数，无限触发 beforeShow。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T16:04:38.817

查看显示功能代码（在警报中）：http: [//jsfiddle.net/D9vP6/4/](http://jsfiddle.net/D9vP6/4/)

它似乎在某种情况下呼唤自己，以使争论正常化。重新定义此函数后，您将收到无限递归。

为了避免这种行为，您应该在代码中进行所有这些规范化，并且在某些情况下不要触发事件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-29T17:00:25.837

上面代码的问题是，在某些时候 jQuery 调用了`$.fn.show`from 本身并创建了无限循环。因此，防止这种情况的正确方法是进行一些参数检查，如下所示：

```
 jQuery(function($) {
    var _oldShow = $.fn.show;
    $.fn.show = function(speed, easing, oldCallback) {

        var args = Array.prototype.slice.call(arguments),
            duration = args[0] || 0,
            easing = 'linear',
            callback = function() {},
            callbackArgIndex = 1;

        // jQuery recursively calls show sometimes; we shouldn't
        //  handle such situations. Pass it to original show method.    
        if (!this.selector) {
            _oldShow.apply(this, args);
            return this;
        }

        if (args.length === 2) {
            if ($.isFunction(args[1])) {
                callback = args[1];
                callbackArgIndex = 1;
            }
            else {
                easing = args[1];
            }
        }
        else if (args.length === 3) {
            easing = args[1];
            callback = args[2];
            callbackArgIndex = 2;
        }

        return this.each(function() {
            var obj = $(this),
                oldCallback = callback,
                newCallback = function() {

                    if ($.isFunction(oldCallback)) {
                        oldCallback.apply(obj);
                    }
                    obj.trigger('afterShow');
                };
            obj.trigger('beforeShow');
            args[0] = duration;

            if (callback) {
                args[callbackArgIndex] = newCallback;
            }
            else {
                args.push(callback);
            }

            _oldShow.apply(obj, args);

        });
    }
});

$('#dataBox').bind('beforeShow afterShow', function(e) {
    alert(e.type);
});

$('#toggleButton').click(function() {

    $('#dataBox').show();

});​ 
```

这工作正常，事件被正确触发。

阻止无限循环的块是这个

```
if (!this.selector) {
      _oldShow.apply(this, args);
      return this;
} 
```

这样做是调用原始函数并在 jQuery`$.fn.show`多次调用的情况下返回（jQuery 似乎出于某种原因这样做）。

[工作小提琴](http://jsfiddle.net/joycse06/evdpj/4/)

# wcf - WCF 服务引用继承自另一个 WCF 服务

> ID：10705521
> 
> 赞同：1
> 
> 时间：2012-05-22T15:49:20.837
> 
> 标签：wcf, architecture

我有一个名为 EmployeeGateway 的 WCF 项目，此 WCF 项目已作为 WCF 服务引用添加到另一个名为 CompanyService 的 WCF 项目

EmployeeGateway 有一个名为 EmployeeView 的对象

在 CompanyService 中，我有一个同名的对象“EmployeeView”，它继承自 EmployeeGateway.EmployeeView

[DataContract] 公共类 EmployeeView : EmployeeGateway::EmployeeView { 附加字段 }

现在，我有一个名为 CompanyUI (MVC) 的第三个项目，它具有对 CompanyService 的服务引用。

问题是reference.cs文件中生成的代码有：

公共部分类 EmployeeView ：

和一个

公共部分类EmployeeView **1**：{Namespace}.EmployeeView {fields}

是否可以在名称末尾没有 1 的情况下生成此文件？它可以以某种方式完全合格吗？例如：参考文件包含 {Namespace}.EmployeeGateway.EmployeeView 和 {Namespace}.CompanyService.EmployeeView （继承自 EmployeeGateway？

如果没有，我想知道是否有可能在 CompanyUI 项目中根本不公开 EmployeeGateway.Employee 视图？

不过，真的，我不喜欢我调用的方法末尾有数字 1，我正在寻找如何正确修复它的选项。

感谢您的任何帮助。史蒂文。

# iphone - 核心数据关系混乱

> ID：10705522
> 
> 赞同：0
> 
> 时间：2012-05-22T15:49:21.907
> 
> 标签：iphone, ios, core-data

如果我有两个实体；Foo 和酒吧。Foo 有两个属性；类型为 Bar 的 bar1 和 bar2。现在 Foo 与 Bar 有一对多的关系吗？至少应该像在 Core Data 中那样建模吗？还是两个一对一的关系？如何在 Core Data 中正确设置它？我理解的一对多关系，但不是最后一种关系类型？这甚至是可能的还是好的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T16:55:06.637

> Foo 有两个属性；类型为 Bar 的 bar1 和 bar2。现在 Foo 与 Bar 有一对多的关系吗？

不，Foo 与 Bar 有两个关系，这些关系被命名为`bar1`and `bar2`。它们是“一对一”还是“一对多”取决于您如何指定它们。选择模型中的每一个，看看是否选中了“to-many”复选框。

> 至少应该像在 Core Data 中那样建模吗？

这取决于您要建模的内容。您是否希望与特定对象有两个独立的关系（即两个不同的“一对一”关系），还是希望与一组对象有一个单独的关系（一个“一对多”关系）？这是一个可能有助于澄清事情的例子......

一个企业可能有零个或多个员工。一个企业也只有一个首席执行官和一个董事会主席。`employees`因此，Business 实体可能具有以 Person 实体命名的“对多”关系。`ceo`它也可能具有名为and的“一对一”关系`chairman`，同样与 Person。这些可能不是绝对必要的——也许 CEO 和董事长都是员工，因此您可以通过搜索员工集并按职称过滤来找到他们。但是，如果您要经常使用它们并且不想每次都搜索成千上万的其他员工，那么将它们作为单独的关系会很方便。

> 如何在 Core Data 中正确设置它？

同样，这取决于您要建模的内容。例如，`employees`关系的反面将是 Person 的`employer`“一对一”关系。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T16:14:54.180

实体有几种不同类型的属性，它们具有属性和关系（以及获取的属性，但这不是重点）。听起来 Foo 和 Bar 是您使用 Foo 创建的两个具有 Bar 属性的类。然后你想将它们同化为核心数据模型中的实体。

通常情况下，事情是反过来做的。您在核心数据模型编辑器中创建实体。然后，您通过创建关系来链接实体。如果您添加从 Foo 到 Bar 的关系，那么最好创建从 Bar 到 Foo 的反向关系。

1.  创建从 Foo 到 Bar 的关系
2.  创建从 Bar 到 Foo 的关系
3.  选择最后一个关系并将其逆设置为第一个

现在，如果您希望 Xcode 生成匹配的 NSManagedObject 子类 Foo 和 Bar，那么您可以选择 Entities 并在 Xcode Editor 菜单中选择“Create NSManagedObject subclasses”

然后，您将看到您是两个具有适当属性的类，以匹配您的模型的设置方式。

我写了一本关于[核心数据](https://rads.stackoverflow.com/amzn/click/com/1430233559)的书，它解释了所有这些更深层次的细节。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-22T15:54:45.523

这是两个一对一的关系。要进行反向，只需在反向字段中选择您的实体（当您创建关系时）。

# asp.net-mvc-3 - 在 MVC3 中使用 Response.StatusCode = 301 是安全的

> ID：10705523
> 
> 赞同：2
> 
> 时间：2012-05-22T15:49:28.807
> 
> 标签：asp.net-mvc-3, .net-4.0

我正在开发一个网站，我想在我的一个社交网络控制器上实现永久重定向，例如有人进入 domain.com/facebook，Facebook 控制器 Index 方法将 Response.StatusCde = 301 和 RedirectLocation 设置为用户 Facebook 页面；所以访客ID发送到Facebook。

经过一番讨论，有些人认为这样做不安全，并且想知道是否有 MVC 方法调用来执行此操作 - 而不是使用 Response 对象。

以这种方式使用 Response 对象是否安全/实用？

我问过谷歌，但它似乎没有返回任何特定于我的问题的信息：\

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T15:52:30.130

您可以使用[RedirectPermanent](http://msdn.microsoft.com/en-us/library/dd384856.aspx)进行安全重定向（以防止 SEO 轰炸等），方法如下：

```
return RedirectPermanent("url-here"); 
```

通过返回 Google 将确认的 301 状态代码，这将正确执行您正在寻找的操作。

# android - android hierarchyviewer ，我有太多了吗？（附图片）

> ID：10705528
> 
> 赞同：-1
> 
> 时间：2012-05-22T15:49:49.697
> 
> 标签：android, view, hierarchy

我的应用程序在我的一项活动中因 stackoverflow 错误而崩溃。这就是层次结构查看器显示的内容，我有太多事情要做吗？

如何弹出不需要的视图？我读过 15 层太多了，我有 15 层以上吗？（相关问题[https://stackoverflow.com/questions/10692620/android-mapview-activity-getting-stack-overflow-error-everytime-i-leave-it](https://stackoverflow.com/questions/10692620/android-mapview-activity-getting-stack-overflow-error-everytime-i-leave-it)）

[![](../Images/39af4eb96cc4d51acbf036c6b4de2a7e.png)](https://i.stack.imgur.com/O3rcW.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T15:56:53.183

> 我的应用程序在我的一项活动中因 stackoverflow 错误而崩溃。这就是层次结构查看器显示的内容，我有太多事情要做吗？

是的。

> 如何弹出不需要的视图？我读过 15 层太多了，我有 15 层以上吗？

改进布局是你的工作，因为我们看不到它（而且你没有提到任何细节）。如果我没记错的话，建议不要有比 10 层更深的布局。

# ios - iOS dylib 符号未显示

> ID：10705529
> 
> 赞同：1
> 
> 时间：2012-05-22T15:49:54.597
> 
> 标签：ios, dylib

试图解决导致 iPad 应用程序崩溃的错误，我知道它来自我为 iOS 构建的私有 dylib，崩溃报告堆栈跟踪未显示符号，dylib 是为调试而构建的以进行测试。

1.  我试图手动运行`symbolicatecrash -A -v "the crash log " "my dylib.dSYM"`没有帮助。
2.  我使用`nm`了命令，它确实显示了我的方法。
3.  `dwarfdump --lookup "the address" --arch armv7 "path to dSYM"`它回来了

    ```
    .debug_info.... not found 
    .debug_frame... not found 
    ```

任何想法如何为 dylib 显示符号，该符号被打包为应用程序包的一部分并将由应用程序在链接时加载？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-27T07:55:36.210

尝试[otool](http://www.manpagez.com/man/1/otool/)列出您的 dylib 导出的符号：

```
otool -TV your.dylib 
```

# java - 在 JAXB Marshalling 中，如何识别导致 JAXB Marshalling Exception 的子元素？

> ID：10705532
> 
> 赞同：3
> 
> 时间：2012-05-22T15:50:00.993
> 
> 标签：java, xml, jaxb, marshalling, jaxb2

我在编组我的 JAXBElement 时遇到了这个异常，它有几个子元素。我如何弄清楚如何查明是哪个子元素导致了这个异常？

```
java.lang.NullPointerException
    at com.sun.xml.bind.v2.runtime.property.AttributeProperty.getIdValue(AttributeProperty.java:128)
    at com.sun.xml.bind.v2.runtime.ClassBeanInfoImpl.getId(ClassBeanInfoImpl.java:320)
    at com.sun.xml.bind.v2.runtime.reflect.TransducedAccessor$IDREFTransducedAccessorImpl.print(TransducedAccessor.java:290)
    at com.sun.xml.bind.v2.runtime.reflect.TransducedAccessor$IDREFTransducedAccessorImpl.print(TransducedAccessor.java:271)
    at com.sun.xml.bind.v2.runtime.property.AttributeProperty.serializeAttributes(AttributeProperty.java:101)
    at com.sun.xml.bind.v2.runtime.ClassBeanInfoImpl.serializeAttributes(ClassBeanInfoImpl.java:375)
    at com.sun.xml.bind.v2.runtime.XMLSerializer.childAsXsiType(XMLSerializer.java:689)
    at com.sun.xml.bind.v2.runtime.property.SingleElementNodeProperty.serializeBody(SingleElementNodeProperty.java:158)
    at com.sun.xml.bind.v2.runtime.ClassBeanInfoImpl.serializeBody(ClassBeanInfoImpl.java:358)
    at com.sun.xml.bind.v2.runtime.XMLSerializer.childAsXsiType(XMLSerializer.java:696)
    at com.sun.xml.bind.v2.runtime.property.SingleElementNodeProperty.serializeBody(SingleElementNodeProperty.java:158)
    at com.sun.xml.bind.v2.runtime.ClassBeanInfoImpl.serializeBody(ClassBeanInfoImpl.java:358)
    at com.sun.xml.bind.v2.runtime.XMLSerializer.childAsXsiType(XMLSerializer.java:696)
    at com.sun.xml.bind.v2.runtime.property.ArrayElementNodeProperty.serializeItem(ArrayElementNodeProperty.java:69)
    at com.sun.xml.bind.v2.runtime.property.ArrayElementProperty.serializeListBody(ArrayElementProperty.java:172)
    at com.sun.xml.bind.v2.runtime.property.ArrayERProperty.serializeBody(ArrayERProperty.java:159)
    at com.sun.xml.bind.v2.runtime.ClassBeanInfoImpl.serializeBody(ClassBeanInfoImpl.java:358)
    at com.sun.xml.bind.v2.runtime.XMLSerializer.childAsXsiType(XMLSerializer.java:696)
    at com.sun.xml.bind.v2.runtime.property.SingleElementNodeProperty.serializeBody(SingleElementNodeProperty.java:158)
    at com.sun.xml.bind.v2.runtime.ElementBeanInfoImpl$1.serializeBody(ElementBeanInfoImpl.java:161)
    at com.sun.xml.bind.v2.runtime.ElementBeanInfoImpl$1.serializeBody(ElementBeanInfoImpl.java:131)
    at com.sun.xml.bind.v2.runtime.ElementBeanInfoImpl.serializeBody(ElementBeanInfoImpl.java:333)
    at com.sun.xml.bind.v2.runtime.ElementBeanInfoImpl.serializeRoot(ElementBeanInfoImpl.java:340)
    at com.sun.xml.bind.v2.runtime.ElementBeanInfoImpl.serializeRoot(ElementBeanInfoImpl.java:76)
    at com.sun.xml.bind.v2.runtime.property.SingleReferenceNodeProperty.serializeBody(SingleReferenceNodeProperty.java:115)
    at com.sun.xml.bind.v2.runtime.ClassBeanInfoImpl.serializeBody(ClassBeanInfoImpl.java:358)
    at com.sun.xml.bind.v2.runtime.XMLSerializer.childAsXsiType(XMLSerializer.java:696)
    at com.sun.xml.bind.v2.runtime.property.SingleElementNodeProperty.serializeBody(SingleElementNodeProperty.java:158)
    at com.sun.xml.bind.v2.runtime.ClassBeanInfoImpl.serializeBody(ClassBeanInfoImpl.java:358)
    at com.sun.xml.bind.v2.runtime.XMLSerializer.childAsXsiType(XMLSerializer.java:696)
    at com.sun.xml.bind.v2.runtime.property.SingleElementNodeProperty.serializeBody(SingleElementNodeProperty.java:158)
    at com.sun.xml.bind.v2.runtime.ClassBeanInfoImpl.serializeBody(ClassBeanInfoImpl.java:358)
    at com.sun.xml.bind.v2.runtime.XMLSerializer.childAsXsiType(XMLSerializer.java:696)
    at com.sun.xml.bind.v2.runtime.property.ArrayElementNodeProperty.serializeItem(ArrayElementNodeProperty.java:69)
    at com.sun.xml.bind.v2.runtime.property.ArrayElementProperty.serializeListBody(ArrayElementProperty.java:172)
    at com.sun.xml.bind.v2.runtime.property.ArrayERProperty.serializeBody(ArrayERProperty.java:159)
    at com.sun.xml.bind.v2.runtime.ClassBeanInfoImpl.serializeBody(ClassBeanInfoImpl.java:358)
    at com.sun.xml.bind.v2.runtime.XMLSerializer.childAsXsiType(XMLSerializer.java:696)
    at com.sun.xml.bind.v2.runtime.ElementBeanInfoImpl$1.serializeBody(ElementBeanInfoImpl.java:156)
    at com.sun.xml.bind.v2.runtime.ElementBeanInfoImpl$1.serializeBody(ElementBeanInfoImpl.java:131)
    at com.sun.xml.bind.v2.runtime.ElementBeanInfoImpl.serializeBody(ElementBeanInfoImpl.java:333)
    at com.sun.xml.bind.v2.runtime.ElementBeanInfoImpl.serializeRoot(ElementBeanInfoImpl.java:340)
    at com.sun.xml.bind.v2.runtime.ElementBeanInfoImpl.serializeRoot(ElementBeanInfoImpl.java:76)
    at com.sun.xml.bind.v2.runtime.XMLSerializer.childAsRoot(XMLSerializer.java:494)
    at com.sun.xml.bind.v2.runtime.MarshallerImpl.write(MarshallerImpl.java:323)
    at com.sun.xml.bind.v2.runtime.MarshallerImpl.marshal(MarshallerImpl.java:251)
    at javax.xml.bind.helpers.AbstractMarshallerImpl.marshal(AbstractMarshallerImpl.java:75)
    at com.tdsecurities.fxdev.doddfranktdmladapter.SwapTDMLGeneratorJunitTest.testHello(SwapTDMLGeneratorJunitTest.java:113) 
```

这是我用来编组 Jaxbelment 的代码：

JAXBElementdmlJAXBElement= SwapDMLGenerator.generateDML（事件，leg1ordMm，leg2ordMm，leg1OrdCs，leg2OrdCs）；

```
JAXBContext jaxbContext_m = JAXBContext.newInstance(DmlWrapper.class);
Marshaller marshaller = jaxbContext_m.createMarshaller();
//marshaller.setProperty(Marshaller.JAXB_SCHEMA_LOCATION, "");
marshaller.setProperty(Marshaller.JAXB_FORMATTED_OUTPUT, true);        
String  outFileName= String.format("dml-%d-ordm_deallnum-%s.xml",System.currentTimeMillis(), .getDealNumber());
File fout= new File(destDir, outFileName);
FileOutputStream fos= new FileOutputStream(fout);
marshaller.marshal(dmlJAXBElement, fos);
fos.close(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-14T23:27:46.070

使用 Eclipse IDE，可以调试一些第 3 方代码，例如 Sun 的 JAXB 实现。

在 Eclipse 中，尝试以下两个块：

启用第 3 方调试支持

```
Search for class AttributeProperty inside your classpath entry for JRE System Library
In Outline tab, expand class file and respective class inside this
Right-Click on target method (in this case: AttributeProperty.getIdValue)
Click on: Toggle Method Breakpoint 
```

检查哪些字段有问题：

1.  启用调试选项卡和变量选项卡
2.  与其他调试过程一样，在调试模式下开始测试
3.  当程序达到相关断点时，检查变量选项卡“this”和“arg0”引用。这些引用包含有关当前节点和混搭对象的信息

在这一点上，您已经准备好分析和调试它的上下文。

我正在处理相同的 JAXB/IDREF 问题，但还没有任何解决方案。我正在检查它。

你解决了这个问题吗？

此致，

和过去

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T15:59:52.683

我能想到的一种方法是在项目中包含 JAXB 的源代码，在调试模式下运行程序并在 eclipse 中放置一个条件断点。请参阅[如何在 eclipse 中设置条件断点](http://wiki.eclipse.org/FAQ_How_do_I_set_a_conditional_breakpoint?) 条件是属性为空，因为您正在获取 NPE。然后，当执行在该点停止时，您可以检查适当的变量。

其他替代方法是查看增加日志级别是否可以为您提供更多信息。

# ios - 使用 mapview 作为多个屏幕的背景

> ID：10705540
> 
> 赞同：0
> 
> 时间：2012-05-22T15:50:24.060
> 
> 标签：ios, user-interface, android-mapview

我希望能够将地图视图用作我的应用程序的统一背景。因此，不同的视图将覆盖在该地图视图上。理想情况下，从一个视图到另一个视图的转换只会影响地图顶部的视图。不是地图，它是自我。

有没有人解决过这个问题，也许知道实现它的最佳行动方案？

除了地图的加载时间之外，还有什么硬性原因导致它可能是糟糕的 UI 设计？

谢谢

本

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T16:57:26.693

您可以使用容器视图控制器来实现此效果。看看苹果文档。基本上，您的根视图将是地图视图，并且“包含”视图将被覆盖。

希望这可以帮助，

凸轮

# extjs - Sencha Touch 不读取数据

> ID：10705544
> 
> 赞同：1
> 
> 时间：2012-05-22T15:50:35.373
> 
> 标签：extjs, sencha-touch, sencha-touch-2

我的模型是这样的：

```
Ext.define("NotesApp.model.Note", {
    extend: "Ext.data.Model",
    config: {
        idProperty: 'id',
        fields: [
            { name: 'id', type: 'int' },
            { name: 'dateCreated', type: 'date', dateFormat: 'c' },
            { name: 'question', type: 'string' },
            { name: 'answer', type: 'string' },
            { name: 'type', type: 'int'},
            { name: 'author', type: 'int'}
        ],
        validations: [
            { type: 'presence', field: 'id' },
            { type: 'presence', field: 'dateCreated' },
            { type: 'presence', field: 'question', message: 'Please enter a question for this card.' }
        ]
    }
}); 
```

我的服务器页面（qa.php）输出这个：

```
{"results":[{"id":"1","dateCreated":"2012-05-01","question":"asdf?","answer":"fdsa","type":"0","author":"0"},{"id":"2","dateCreated":"2012-05-01","question":"qwer?","answer":"rewq","type":"0","author":"0"}]} 
```

这是我在商店里的代码：

```
Ext.define("NotesApp.store.Online", {
    extend: "Ext.data.Store",
           config: {
           model: 'NotesApp.model.Note',
           storeId: 'Online',
           proxy: {
               type: 'jsonp',
               url: 'http://xxxxxxxx.com/qa.php',
               reader: {
                   type: 'json',
                   rootProperty: 'results'
               }
           },
           autoLoad: false,
           listeners: {
               load: function() {   
                   console.log("updating");

                   Ext.getStore('Notes').getProxy().clear();
                   console.log("updating1");

                   // Loop through records and fill the offline store                       

                   this.each(function(record) {
                             console.log("updating2");
                             Ext.getStore('Notes').add(record.data);

                   });

                   // Sync the offline store
                   Ext.getStore('Notes').sync();
                   console.log("updating3");
                   // Remove data from online store
                   this.removeAll();
                    console.log("updated");
               }

           },
           fields: [
                    {
                    name: 'id'
                    },
                    {
                    name: 'dateCreated'
                    },
                    {
                    name: 'question'
                    },
                    {
                    name: 'answer'
                    },
                    {
                    name: 'type'                    
                    },
                    {
                    name: 'author'
                    }
                    ]
           }
}); 
```

但是当我打电话时`Ext.getStore('Online').load()`，控制台显示“updating”、“updating1”和“updating3”，但没有任何“updating2”，即。没有找到记录。我想知道错误在哪里？有没有办法输出读入的jsonstring？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T16:12:52.800

这是一个不同的范围

```
listeners: {
           load: function() {   
               console.log("updating");

               Ext.getStore('Notes').getProxy().clear();
               console.log("updating1");

               // Loop through records and fill the offline store                       

               this.each(function(record) {
                         console.log("updating2");
                         Ext.getStore('Notes').add(record.data);

               });

               // Sync the offline store
               Ext.getStore('Notes').sync();
               console.log("updating3");
               // Remove data from online store
               this.removeAll();
                console.log("updated");
           },
this//adds scope 
```

或者

```
listeners: {
           load: function(store,record,options) {   
               console.log("updating");

               Ext.getStore('Notes').getProxy().clear();
               console.log("updating1");

               // Loop through records and fill the offline store                       

               store.each(function(record) {
                         console.log("record"); //wahei records!
                         Ext.getStore('Notes').add(record.data);

               });

               // Sync the offline store
               Ext.getStore('Notes').sync();
               console.log("updating3");
               // Remove data from online store
               this.removeAll();
                console.log("updated");
           } 
```

# webgl - WebGL - 用块构建对象

> ID：10705546
> 
> 赞同：0
> 
> 时间：2012-05-22T15:50:48.990
> 
> 标签：webgl, three.js

我正在尝试使用块构建一些文本，我打算稍后对其进行自定义。附图是我打算做的模型。

我正在考虑使用 WebGL，因为我想在 3D 中做它并且我不能做任何闪光，但我不知道如何从字母中构造立方体的结构。谁能给我一个建议或技术将文本映射到一系列点，以便从远处看到他们绘制相同的文本？

![在此处输入图像描述](../Images/8055baa5d7373654f97b1ade3de93181.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T16:28:15.470

1.  首先，您需要一种字体——字符的形状表——采用可以从代码中读取的格式。你已经有一个了吗？如果只是几个字母，您可以为每个字符手动创建多边形。

2.  然后，使用光栅化算法将字符形状转换为存在或不存在点/立方体的数组。如果您有完美的平面文本，请使用 2D 数组；如果您的“自定义”将创建深度效果，那么您将需要一个 3D 阵列（通过将形状相同地写入阵列的多个平面来“挤压”形状）。

    如果您的文本在运行时没有变化，则前两个步骤的替代方法是合适的，即首先创建一个带有所需文本的图像，然后将图像的像素用作上述二维数组。在浏览器中，您可以使用 2D Canvas 功能将图像绘制到画布上，然后从中读取像素。

3.  然后从这*个体素*阵列生成一个 3D 形状，为阵列中“存在”点与“不存在”点相交的每个位置构造一个多边形面。如果您基于邻居对执行此操作，您会得到一个大块像素外观（如 Minecraft）。如果您想要平滑的斜坡（如您的示例图像），那么您需要更复杂的技术；产生光滑表面的传统方法是[行进立方体](http://en.wikipedia.org/wiki/Marching_cubes)（但只是做行进立方体会使你的所有角落都变圆）。

# asp.net - ASP.NET 发布尝试复制不存在的文件

> ID：10705550
> 
> 赞同：41
> 
> 时间：2012-05-22T15:50:54.507
> 
> 标签：asp.net, visual-studio-2010, publish, pdb-files

我正在尝试在 VS2010 中发布一个 ASP.NET 项目，但出现以下错误：

> 将文件 bin\CKFinder.pdb 复制到 obj\Release\Package\PackageTmp\bin\CKFinder.pdb 失败。找不到文件“bin\CKFinder.pdb”。

我曾尝试使用 CKFinder 的试用版（带有 CKEditor），但我放弃了。我删除了对 CKFinder 的所有引用，包括文件夹和引用——至少我是这么认为的。

我试过查找这个错误，结果是空的。这越来越令人沮丧。

为什么会出现这个错误？想法？

提前致谢 。. .

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2015-12-01T23:20:50.850

我也碰到了这个问题。我在尝试发布 MVCForum 1.7 时收到以下错误：

> 将文件 App_Data\NuGetBackup\Hello.txt 复制到 obj\Release\Package\PackageTmp\App_Data\NuGetBackup\Hello.txt 失败。找不到文件“App_Data\NuGetBackup\Hello.txt”。

[François Breton 的评论](https://stackoverflow.com/questions/10705550/asp-net-publish-trying-to-copy-a-non-existant-file#comment20823846_10721796)帮助我实现了解决方案。

这很简单：

使用文本编辑器（记事本、Notepad++）打开`.csproj`文件，Visual Studio 会将其作为项目打开。

按`Ctrl`+`F`并搜索问题的文件。*在我的情况下，文件是没有逗号*的“Hello.txt” 。

在`<ItemGroup>`它居住的地方：

```
<ItemGroup>
<Content Include="App_Data\NuGetBackup\Hello.txt" />
<Content Include="Content\admin\Admin.css">
    <DependentUpon>Admin.scss</DependentUpon>
</Content>
...More code omitted due to brevity. 
```

我删除了该`<Content Include="App_Data\NuGetBackup\Hello.txt" />`行，瞧！Visual Studio 允许我在发布前预览！

它会像这样结束：

```
<ItemGroup>
<Content Include="Content\admin\Admin.css">
    <DependentUpon>Admin.scss</DependentUpon>
</Content>
...More code omitted due to brevity. 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-05-23T14:14:21.283

更新：我进入项目 --> 打包/发布设置，然后单击“排除生成的调试符号”。该项目开始发布，没有任何问题。

更新#2（这可能是更好的答案）：我尝试发布为调试而不是发布（是的，我想在这个特定版本中保留调试功能），错误再次出现。事实证明，我没有从项目中排除 CKfinder.dll。一旦我这样做了，它就没有问题地运行了。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2016-04-29T07:18:13.400

我刚刚从我的**Visual Studio 解决方案中删除了****黄色标记**的文件，它对我来说非常有用，因为文件被从文件夹中**添加**和**删除**了很多次，但它没有从**VS 解决方案项目**中删除。

 ******* * *

## 回答 #4

> 赞同：10
> 
> 时间：2019-07-31T07:33:53.057

删除解决方案资源管理器中显示感叹号的文件。它对我有用

[![带文件的解决方案资源管理器](../Images/9a287b0dc82383d272df353fb04cba26.png)](https://i.stack.imgur.com/RZ0GY.png)

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2016-04-22T15:32:43.177

我遇到了同样的问题，我只是点击了显示所有文件，然后删除了带有感叹号的文件。希望这可以帮助某人。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2018-04-20T10:18:17.857

右键单击您的项目=>卸载项目=>再次右键单击新卸载的项目=>编辑“myProject.csproj”=>搜索有问题的文件（`CTRL`+ `F`）并删除。

如果错误再次出现在同一个父目录中，但现在使用不同的文件名，则可能是用户错误地将文件包含在项目中（就像我一样）。可以删除违规目录下的所有文件。这应该可以解决问题。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2019-02-01T13:00:07.340

就我而言，我遇到了类似的错误，但`.cshtml`文件如下：

> 将 Views\Home\About.cshtml 复制到 obj\Release\Package\PackageTmp\Views\Home\About.cshtml 失败。找不到文件“Views\Home\About.cshtml”

查看解决方案资源管理器树，一切似乎都很好，没有黄色标记，但单击文件时出现错误。

> 项目目录中不存在“About.cshtml”项。它可能已被移动、重命名或删除。

[![在此处输入图像描述](../Images/72d0100b59176a64000aead155b75f1e.png)](https://i.stack.imgur.com/LIE9X.png)

从解决方案中删除文件为我解决了这个问题。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2018-04-17T22:48:56.307

我错误地将 obj 文件夹包含到 Visual Studio 项目中。从项目中排除 Obj 文件夹解决了我的问题

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2022-01-14T07:43:36.660

您必须从项目中排除**bin 文件夹**，然后重新发布您的项目。方法可以解决我的问题

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2018-08-27T10:41:55.753

检查 bin 文件夹已添加到 vs 资源管理器中。如果它在那里，则从项目中排除并检查。它对我有用。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-12-29T18:46:15.530

我的目录中有我打算发布到的文件。删除这些允许成功发布。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-01-20T10:11:16.017

另一种解决方案是删除发布配置文件，在我删除 1 个 EF DbContext 后发生此错误。该解决方案在发布文件夹中跟踪该文件，我重新创建了配置文件并成功发布。

我的错误是这个

> 未找到名为“xxxx”的 DbContext。******

# mysql - 将代码从 MS SQL Server 更改为 MySQL

> ID：10705558
> 
> 赞同：-3
> 
> 时间：2012-05-22T15:51:22.113
> 
> 标签：mysql, sql-server

如何将其从 MS SQL SERVER 转换为 MySQL？

```
/****** Object: StoredProcedure [dbo].[geolocation_refresh_geography] Script Date: 05/08/2012 22:02:26 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create procedure [dbo].[geolocation_refresh_geography]
as
update locations
SET geolocation = geography::STPointFromText('POINT(' + CAST([Longitude] AS VARCHAR(20)) + ' ' + CAST([Latitude] AS VARCHAR(20)) + ')', 4326)
where geolocation is null
GO 
```

我的代码在第 4 行导致错误，不知道为什么？

```
create procedure geolocation_refresh_geography()
BEGIN
update locations
SET geolocation = geography::STPointFromText('POINT(' + CAST(Longitude AS VARCHAR(20)) + ' ' + CAST(Latitude AS VARCHAR(20)) + ')', 4326)
where geolocation is null
END 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T15:53:09.610

您是否尝试过 MySQL 迁移工具包？

[http://dev.mysql.com/doc/migration-toolkit/en/mysql-migration-toolkit-indepth-sourcedb-mssql.html](http://dev.mysql.com/doc/migration-toolkit/en/mysql-migration-toolkit-indepth-sourcedb-mssql.html)

这些天很难找到，但我相信您也可以使用 MySQL Workbench 来完成此任务。 [http://www.mysql.com/products/workbench/](http://www.mysql.com/products/workbench/)

我建议只迁移您应该为您移植过程的整个架构。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T20:41:38.847

对于初学者，MySQL 仅在启用了 Spatial Extensions 的情况下才支持空间数据 (http://dev.mysql.com/doc/refman/5.0/en/spatial-extensions.html)。假设您已经进行了该设置，您只需将 SQL Server 语法调整为适当的 MySQL 方法。

MySQL 有一个 PointFromText() 方法 (http://dev.mysql.com/doc/refman/5.0/en/creating-spatial-values.html#function_pointfromtext)，它反映了 SQL Server 的 STPointFromText() (http:// /msdn.microsoft.com/en-us/library/bb933979.aspx），因此您可以简单地将对*geography::STPointFromText*的引用替换为*PointFromText*

但是，要从单个纬度/经度坐标对插入点，最简单的方法是 Point() (http://dev.mysql.com/doc/refman/5.0/en/creating-spatial- values.html#function_point)，在这种情况下，您的代码将变为：

```
create procedure geolocation_refresh_geography()
BEGIN
update locations
SET geolocation = Point(Longitude, Latitude)
where geolocation is null
END 
```

# c# - XNA：在数组中存储大量 Texture2D

> ID：10705563
> 
> 赞同：0
> 
> 时间：2012-05-22T15:51:49.110
> 
> 标签：c#, xna, texture2d

我从 xna 开始，我对此很陌生，但我正在努力继续使用这个框架，无论如何，我的问题是：我有很多 .png 图像并且不想制作一个对象对于这些图像中的任何一个，所以我想将它们放在一个`Texture2D`数组中，我认为这是这样做的方法，但看起来这不是正确的方法：

```
Texture2D[] _rCards, _bCards, _sCards;
_bCards = new Texture2D[9]; 
_rCards = new Texture2D[9];
_sCards = new Texture2D[6];

for (int i = 1; i < 10; i++)
{
    _bCards[i] = Content.Load<Texture2D>("Images/Common/Black/"+i);
    _rCards[i] = Content.Load<Texture2D>("Images/Common/Red/"+i);
    if(i<6)
        _sCards[i] = Content.Load<Texture2D>("Images/Special/Card" + (i-1));
} 
```

纹理的文件名是 1.png、2.png、3.png 等。

特殊卡片有card1.png、card2.png、card3.png等。

我正在尝试制作二十一点游戏。

您能给我一个建议，将所有这些纹理加载到一个纹理 2D 数组中吗？

IDE 给出了 NULLREFERENCEEXCEPTION 问题或其他问题。

也许语言不理解整个地址以将纹理作为字符串查找。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T18:30:14.783

索引是基于 0...

```
for (int i = 1; i < 10; i++)
{
  _bCards[i-1] = Content.Load("Images/Common/Black/"+i);
  _rCards[i-1] = Content.Load("Images/Common/Red/"+i);
   if(i<6) _sCards[i-1] = Content.Load("Images/Special/Card" + (i-1));
} 
```

如果要同时加载所有纹理，可以使用精灵表示例：

[http://create.msdn.com/en-US/education/catalog/sample/sprite_sheet](http://create.msdn.com/en-US/education/catalog/sample/sprite_sheet)

您将拥有一个独特的资产和一个源矩形字典来绘制精灵......

# c++ - 如何确保纹理的像素/纹素比率为 1:1

> ID：10705568
> 
> 赞同：0
> 
> 时间：2012-05-22T15:52:00.220
> 
> 标签：c++, direct3d

我想使用 Direct3D 在屏幕上显示纹理，不仅希望它覆盖整个窗口，而且我希望成为纹理的实际大小（即屏幕上的每个像素都映射到来自质地）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T16:14:51.797

只需使用具有相同屏幕宽度和高度的纹理以及全屏四边形。

您还可以缩放纹理，但这只是一个不好的解决方法，因为您将其设置为 1:1 像素/纹素，但质量会下降。

也许这会有所帮助：[渲染全屏四边形](http://www.gamedev.net/topic/513376-rendering-full-screen-quads/)

# javascript - 在选择中，focusOffset可以在anchorOffset之前吗？

> ID：10705569
> 
> 赞同：3
> 
> 时间：2012-05-22T15:52:01.437
> 
> 标签：javascript, html, selection, range

在 JavaScript 中以编程方式定义范围/选择时，范围内的 focusOffset 是否不可能在 anchorOffset 之前？那么我们如何定义从右到左的选择呢？

一个 JS 提琴手链接，例如：http: [//jsfiddle.net/johncch/ejVab/1/](http://jsfiddle.net/johncch/ejVab/1/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T16:09:12.967

创建“向后”选择的方法有点不明显。它不能通过简单地通过选择`addRange()`方法选择范围来完成，因为范围本质上是无方向的。您需要使用[`extend()`](https://developer.mozilla.org/en/DOM/Selection/extend)选择的方法（下面的示例）。

请注意，这在任何版本的 IE 中都不起作用，包括 9：与以前的版本不同，IE 9 确实有标准的选择和范围对象，但在微软开发 IE 9 时，`extend()`它是非标准的，所以他们没有实现它，这意味着无法在任何尚未发布的 IE 版本中以编程方式创建向后选择。IE 10 没有实现`extend()`，尽管我[在 IE 错误跟踪器上提交了一个错误](https://connect.microsoft.com/IE/feedback/details/737106/implement-missing-extend-method-of-selection)。

```
function selectRangeBackwards(range) {
    var sel = window.getSelection();
    var endRange = range.cloneRange();
    endRange.collapse(false);
    sel.removeAllRanges();
    sel.addRange(endRange);
    sel.extend(range.startContainer, range.startOffset);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T15:57:08.523

您需要交换两个变量：

```
function makeSelection(a, b) {
    if(b < a) {
        var tmpA = a;
        a = b;
        b = tmpA;
    }
    // ... rest of your code 
```

更新[了 jsfiddle](http://jsfiddle.net/ejVab/2/)演示。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-22T16:01:42.980

[这](https://developer.mozilla.org/en/DOM/Selection)是关于选择的一个很好的 MDN 文档。anchorOffset/anchorNode 表示选择的“开始”（它开始的地方，比如说，在鼠标拖动期间），而 focusOffset/focusNode 表示选择的“结束”（用户完成拖动的地方）。这对于确定选择的左/右端几乎没有用。要检测它们，您需要[Range](https://developer.mozilla.org/en/DOM/range)对象 - 对左选择边界使用 startContainer/startOffset，对右边界使用 endContainer/endOffset。从您的选择中获取范围为

```
if (window.getSelection() && window.getSelection().rangeCount)
    var range = window.getSelection().getRangeAt(0); 
```

猜猜这足以建立正确的选择。

# windows-7 - 如何为 Windows Vista/7 开发类似 Metro 的应用程序 UI

> ID：10705571
> 
> 赞同：7
> 
> 时间：2012-05-22T15:52:05.420
> 
> 标签：windows-7, microsoft-metro

如何为 Windows Vista/7 开发类似 Metro 的应用程序 UI

github最近发布了他们的windows官方客户端，和Metro很像

[http://windows.github.com/](http://windows.github.com/)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-23T18:00:37.587

您可以在 WPF 中通过重新模板化您使用的所有控件来完成此操作。似乎已经有一些库可以让应用看起来像 Zune Software 或 GitHub 客户端。

[http://elysium.codeplex.com/](http://elysium.codeplex.com/)

[http://mahapps.com/MahApps.Metro/](http://mahapps.com/MahApps.Metro/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-20T09:46:08.343

您还可以使用 Telerik Rad Controls 创建 Metro 风格主题的 WinForms 应用程序。

[http://www.telerik.com/products/winforms.aspx](http://www.telerik.com/products/winforms.aspx)

[带有 Telerik Windows 窗体控件的 Metro UI](http://www.youtube.com/watch?v=Kt56u9XXt2E&noredirect=1)

# python - 将数据从 SQLServer 移植到 BigData

> ID：10705572
> 
> 赞同：0
> 
> 时间：2012-05-22T15:52:12.513
> 
> 标签：python, sql-server, bigdata

我当前的托管站点上有一个大型 SQLServer 数据库......并且

我想将其导入 Google BigData。

有办法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T04:26:56.317

我认为答案是没有通用的方法来做到这一点。事实上，我什至认为有一个通用的食谱是没有意义的......

您需要做的是分析 SQL 模式并制定到 BigData 模式的适当映射。然后你弄清楚如何迁移数据。

# iphone - 自定义 uiscrollview 不滚动（使用 coretext）

> ID：10705573
> 
> 赞同：0
> 
> 时间：2012-05-22T15:52:20.293
> 
> 标签：iphone, objective-c, ios, ipad, uiscrollview

我正在使用 CoreText 在多列中绘制文本（取决于 iPad 的方向）。

为了测试，我创建了一个由数字 100 - 999 组成的 NSMutableString。此文本跨越 5 列，其中 1 或 2 列在屏幕上（取决于方向）。

在我的主 ViewController 中，我添加了一个自定义 UIScrollView 来保存此文本，并且我希望它可以滚动。

我注意到滚动视图在我设置之前不会滚动：

[myScrollView setContentMode:UIViewContentModeRedraw];

我确实希望滚动视图在 iPad 旋转时调用 drawRect（以调整列数）！

不过，我的问题是它似乎一遍又一遍地调用 drawRect ...在滚动时（因此分配了越来越多的内存，也导致了一些滞后）。

我将 UIScrollView 添加到我的主 viewController 中，如下所示：

```
myScrollView = [[CoreTextTestUIView alloc] init];
myScrollView.parentView = self;
if(FACING == @"PU" || FACING == @"PD")
{
    myScrollView.frame = CGRectMake(0,50,768,974);
}
else
{
    myScrollView.frame = CGRectMake(0,50,1024,718);
}
[myScrollView setContentMode:UIViewContentModeRedraw];
[container addSubview:myScrollView]; 
```

同样，我希望在 iPad 旋转时调用 drawRect，因此列数可以改变......但是当我只是尝试滚动 UIScrollView 时，我不希望它调用 drawRect。

有人能帮助我吗？

...

下面是我的 UIScrollView 的 .m：

```
#import "CoreTextTestUIView.h"
#import <CoreText/CoreText.h>

@implementation CoreTextTestUIView

@synthesize parentView;

NSMutableString *testText;

-(id)initWithFrame:(CGRect)frame
{
    self = [super initWithFrame:frame];
    if(self)
    {
        // Initialization code

        //set BG color
        self.backgroundColor = [[UIColor alloc] initWithRed:134 green:166 blue:228 alpha:1.0];

        //UIScrollView Stuff
        //self.delegate = self;
        self.scrollEnabled = YES;
        self.pagingEnabled = YES;
        self.userInteractionEnabled = YES;
        [self becomeFirstResponder];
        self.showsVerticalScrollIndicator = NO;
        self.showsHorizontalScrollIndicator = NO;
        self.bounces = NO;
        self.alwaysBounceHorizontal = YES;
        self.alwaysBounceVertical = NO;

        //generate long text
        testText = [[NSMutableString alloc] initWithString:@""];
        for(int i = 100; i < 1000; i++)
        {
            [testText appendString:[NSString stringWithFormat:@"%i ",i]];
        }

        self.alpha = 0.0;
        [self fadeIn];
    }
    return self;
}

-(void)fadeIn
{
    [UIView beginAnimations:nil context:nil];
    [UIView setAnimationDuration:1.0];  
    [UIView setAnimationDelegate:self]; 
    //[UIView setAnimationDidStopSelector:@selector(animationFinished:finished:context:)];  
    self.alpha = 1.0;
    [UIView commitAnimations];
}

// Only override drawRect: if you perform custom drawing.
// An empty implementation adversely affects performance during animation.
-(void)drawRect:(CGRect)rect
{

    NSMutableAttributedString *string = [[NSMutableAttributedString alloc] initWithString:[NSString stringWithFormat:@"%@",testText]];

    //set font
    CTFontRef helvetica = CTFontCreateWithName(CFSTR("Helvetica"), 40.0, NULL);
    [string addAttribute:(id)kCTFontAttributeName
                   value:(id)helvetica
                   range:NSMakeRange(0, [string length])];

    //layout master
    CTFramesetterRef framesetter = CTFramesetterCreateWithAttributedString((CFAttributedStringRef)string);

    //flip the coordinate system
    CGContextRef context = UIGraphicsGetCurrentContext();
    CGContextSetTextMatrix(context, CGAffineTransformIdentity);
    CGContextTranslateCTM(context, 0, self.bounds.size.height);
    CGContextScaleCTM(context, 1.0, -1.0);

    int textPos = 0;
    int columnIndex = 0;

    //how many columns? (orientation dependent)
    float howManyColumns;
    if(parentView.FACING == @"PU" || parentView.FACING == @"PD")
    {
        howManyColumns = 1.0;
    }
    else
    {
        howManyColumns = 2.0;
    }

    //create columns in loop
    while(textPos < [string length])
    {
        NSLog(@"column started");

        //column form
        CGMutablePathRef columnPath = CGPathCreateMutable();
        CGPathAddRect(columnPath, NULL, 
                      CGRectMake((self.bounds.size.width/howManyColumns*columnIndex), 0, 
                                 (self.bounds.size.width/howManyColumns),
                                 self.bounds.size.height));

        //column frame
        CTFrameRef columnFrame = CTFramesetterCreateFrame(framesetter, 
                                                             CFRangeMake(textPos, 0),
                                                             columnPath,
                                                             NULL);

        //use the column path
        CTFrameRef frame = CTFramesetterCreateFrame(framesetter, CFRangeMake(textPos, 0), columnPath, NULL);
        CFRange frameRange = CTFrameGetVisibleStringRange(frame);

        //draw
        CTFrameDraw(columnFrame, context);

        //cleanup
        CFRelease(columnFrame);
        CGPathRelease(columnPath);

        textPos += frameRange.length;
        columnIndex++;
    }

    //set scrollView content size
    int totalPages = (columnIndex+1)/howManyColumns;
    self.contentSize = CGSizeMake(totalPages*self.bounds.size.width, self.frame.size.height);

    //release
    CFRelease(framesetter);
    [string release];
}

-(void)dealloc
{
    [super dealloc];

    [parentView release];
    [testText release];
}

@end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T16:22:28.457

看着这个，我看不到你在哪里设置`contentSize`你的滚动视图。如果你没有设置`contentSize`你的scrollView，滚动将不会被启用，你只会看到适合scrollView当前区域的内容。此外，如果您的文本在配置中是静态的，请考虑优化一些正在发生的重绘并将其添加到 scrollView 的子视图中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T16:01:26.490

这就是 drawRect 的工作原理。每次视图移动或更改或与它重叠的东西时都会调用它。如果您正确管理内存，这应该不是问题。

# php - 随机颜色和 div 宽度不起作用

> ID：10705579
> 
> 赞同：1
> 
> 时间：2012-05-22T15:52:35.540
> 
> 标签：php

这是我的代码：

```
<?php
  // Returns a random RGB color (used to color the vote bars)
  function getRandomColor2()
  {
       $r2 = rand(128,255); 
       $g2 = rand(128,255); 
       $b2 = rand(128,255); 
       $color2 = dechex($r2) . dechex($g2) . dechex($b2);
       echo "$color2";
  }

  echo "<table id=\"tblResults2\" align=\"center\">";

  // Get max vote count
  $doc = new DOMDocument();
  $doc->load("../vote_dir/xml/results.xml");
  $maxvotes2 = 0;
  $pollitems2 = $doc->getElementsByTagName("pollitem");
  foreach( $pollitems2 as $pollitem2 )
  {
    $votes2 = $pollitem2->getElementsByTagName("votes");
    $vote2 = $votes2->item(0)->nodeValue;
    $maxvotes2 = $maxvotes2 + $vote2;
  }

  // Generate the results table
  $doc = new DOMDocument();
  $doc->load("../vote_dir/xml/results.xml");
  $pollitems2 = $doc->getElementsByTagName("pollitem");
  foreach( $pollitems2 as $pollitem2 )
  {
    $entries2 = $pollitem2->getElementsByTagName("entryname");
    $entry2 = $entries2->item(0)->nodeValue;
    $votes2 = $pollitem2->getElementsByTagName("votes");
    $vote2 = $votes2->item(0)->nodeValue;
    $tempWidth2 = $vote2 / $maxvotes2;
    $tempWidth2 = 300 * $tempWidth2;
    $votepct2 = round(($vote2 / $maxvotes2) * 100);
    echo "<tr><td width=\"45%\" class=\"polls\">$entry2</td>";
    echo "<td width=\"35%\" class=\"resultbar\"><div class=\"bar\" style=\"background-color: ";
        getRandomColor2();
        echo "; width: $tempWidth2 px;\">$votepct2%</div></td><td class=\"each_vote\" width=\"20%\">($vote2 votes)</td></tr>";
  }
  echo "<tr><td width=\"45%\" class=\"total\" colspan=\"3\">Σύνολο ψήφων: $maxvotes2</td>";
  echo "</table>";
?> 
```

我的问题是，当我调用它时，一切正常，但是：

1.  我没有颜色

2.  我所有显示 % 的 DIV 的宽度都相同，而不是 $tempWidth2

为每个 div 显示固定（不同）颜色是否更容易？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T15:59:10.377

改变：

```
echo "$color2"; 
```

到：

```
echo "#$color2"; // added #, fixes colors 
```

...并改变：

```
echo "; width: $tempWidth2 px;\">$votepct2%</div></td><td class=\"each_vote\" width=\"20%\">($vote2 votes)</td></tr>"; 
```

...到：

```
echo "; width: {$tempWidth2}px;\">$votepct2%</div></td><td class=\"each_vote\" width=\"20%\">($vote2 votes)</td></tr>";
// removed a space, wrapped var in {}, fixes widths 
```

...尽管在从函数返回字符串的可读性方面会做得更好，如下所示：

```
function getRandomColor2()
{
     $r2 = rand(128,255); 
     $g2 = rand(128,255); 
     $b2 = rand(128,255); 
     $color2 = dechex($r2) . dechex($g2) . dechex($b2);
     return "#".$color2;
}

// ...

echo "<tr>"
   . "<td width=\"45%\" class=\"polls\">{$entry2}</td>"
   . "<td width=\"35%\" class=\"resultbar\">"
   . "<div class=\"bar\" style=\"background-color: ".getRandomColor2()."; width: {$tempWidth2}px;\">{$votepct2}%</div>"
   . "</td>"
   . "<td class=\"each_vote\" width=\"20%\">({$vote2} votes)</td>"
   . "</tr>"; 
```

# c# - 如何从 Razor 视图中调用带有可选参数的辅助方法？

> ID：10705582
> 
> 赞同：2
> 
> 时间：2012-05-22T15:53:00.437
> 
> 标签：c#, asp.net-mvc-3, razor, optional-parameters

我创建了一个新的 html 辅助方法，用于在 razor 视图引擎中创建图像标签：

```
 public static MvcHtmlString Image(this HtmlHelper helper, string fileName, string altText, 
        string cssClass = null, string id = null, string style = null)
    {
        var server = HttpContext.Current.Server;
        string location = server.MapPath("~/Content/Images/" + fileName);
        var builder = new TagBuilder("img");
        builder.Attributes["src"] = location;
        builder.Attributes["alt"] = altText;

        if (!string.IsNullOrEmpty(cssClass))    builder.Attributes["class"] = cssClass;
        if (!string.IsNullOrEmpty(id))          builder.Attributes["id"] = id;
        if (!string.IsNullOrEmpty(style))       builder.Attributes["style"] = style;

        string tag = builder.ToString(TagRenderMode.SelfClosing);
        return new MvcHtmlString(tag);
    } 
```

我认为该方法可能有效，但我在调用它时遇到问题。在我看来，我有：

```
@Html.Image("getstarted-promo.jpg", "Get Started", style = "width: 445; height: 257;") 
```

当视图加载时，我得到这个编译器错误：

> CS0103：当前上下文中不存在名称“样式”

在剃刀视图中使用可选参数的正确语法是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-22T15:56:00.343

您没有使用有效的 C# 语法。使用`:`而不是`=`指定可选参数的值：

```
@Html.Image("getstarted-promo.jpg", "Get Started", style: "width: 445; height: 257;") 
```

进一步阅读：[命名和可选参数（C# 编程指南）](http://msdn.microsoft.com/en-us/library/dd264739.aspx)

# c++ - 将 Char* 与 String 和运算符进行比较

> ID：10705583
> 
> 赞同：0
> 
> 时间：2012-05-22T15:53:00.550
> 
> 标签：c++, string, operators, char, compare

我的程序在运行时崩溃。如果我注释掉行`if((str1->compare(*str2))==0 ){...}`，它可以正常工作。我不知道如何比较比较后创建和删除的字符串 * 的两个元素。

```
main.cpp: In function `int operator==(const Integer&, const Integer&)':
main.cpp:18: warning: taking address of temporary
main.cpp:19: warning: taking address of temporary 
```

**整数.h**

```
class Integer {
public:
    Integer(int val, char *opis):m_val(val),m_opis(opis)
        {
            this->m_val = 0;
            this->m_opis = strdup("0");
        }

    friend int operator==(const Integer&,const Integer&);

      private:
        int m_val;
        char *m_opis;
} 
```

**主文件**

```
 int operator==(const Integer&a, const Integer&b){
        string *str1 = &string ( a.m_opis );
        string *str2 = &string ( b.m_opis );

        if((str1->compare(*str2))==0 ){return 1 ;} //<- Here is my problem i think.

        delete str1;
        delete str2;

        return 0;
    }
}
//Objects and comparing

    Integer o1(15,"lala");
    Integer o2(150,"lala");
    Integer o3;

    cout<<o1==o2; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T15:57:28.757

问题是`str1`和`str2`是[悬空指针](http://en.wikipedia.org/wiki/Dangling_pointer)，因为它们指向的临时对象在被调用时不再存在`str1->compare()`：这是编译器警告的内容。

不要在这里使用动态对象，使用堆栈分配的对象：

```
string str1(a.m_opis);
string str2(b.m_opis); 
```

其他要点：

*   更喜欢使用`std::string`而不是`char*`( `Integer.m_opis`)。相关[什么是三法则？](https://stackoverflow.com/questions/4172722/what-is-the-rule-of-three)
*   `m_opis` is being set twice in the constructor and all instances of `Integer` will have the same string `"0"` (same not meaning same buffer but same content). Ditto for `m_val`.

# asp.net-mvc-3 - ASP.NET MVC3 的最佳报告工具是什么？

> ID：10705586
> 
> 赞同：0
> 
> 时间：2012-05-22T15:53:01.657
> 
> 标签：asp.net-mvc-3, reporting-services, report

我一直在使用 ASP.NET MVC 3 来实现一个测试应用程序。现在我需要一个报告工具来使用折线图查看和比较不同人在一段时间内的表现百分比。任何人都可以推荐一个高效的报告工具，它与 MVC3 配合得很好......谢谢你的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T15:59:43.560

SQL Server 报告服务视图和 rdl 文件类型可直接在 MVC3 项目中使用。它们不需要 SSRS 服务器，可以直接在 Visual Studio 中设计。最快和最简单的解决方案.. 并且免费。

# ios - 如何在我的 iPad 应用程序中的不寻常曲线路径上为一张图像设置动画？

> ID：10705587
> 
> 赞同：0
> 
> 时间：2012-05-22T15:53:06.417
> 
> 标签：ios, iphone, ipad, animation, bezier

我有两个单独的图像。

1.  CurvedPath 图像（附在下面）
2.  人物形象

![在此处输入图像描述](../Images/6c758a7c31f8623209685c1eede32c4b.png)

正如您所看到的，这条路径对于单个角度来说没有完美的弧度。

我有另一个 PersonImage，我想在此弧形图像的中心线上方进行动画处理，并具有放大效果。

这个动画应该从左下角开始到右上角。

如何实现这种动画？

我已经阅读了有关 QuartzCore 和 BeizerPath 动画的内容，但由于我对这些了解较少，因此我很难快速实现这一点。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-22T16:32:06.173

# 沿着路径移动

只要你能得到你想要动画图像对齐的确切路径，你就可以使用 Core Animation 和 CAKeyframeAnimation 来做到这一点。

为 position 属性创建一个关键帧动画，并将其设置为沿您的路径进行动画处理

```
CAKeyframeAnimation *moveAlongPath = [CAKeyframeAnimation animationWithKeyPath:@"position"];
[moveAlongPath setPath:myPath]; // As a CGPath 
```

如果您将路径创建为 UIBezierPath，那么您可以通过调用贝塞尔路径轻松获取 CGPath `CGPath`。

接下来，您使用持续时间等配置动画。

```
[moveAlongPath setDuration:5.0]; // 5 seconds
// some other configurations here maybe... 
```

现在，您将动画添加到 imageView 的图层，它将沿路径进行动画处理。

```
[[myPersonImageView layer] addAnimation:moveAlongPath forKey:@"movePersonAlongPath"]; 
```

* * *

如果您以前从未使用过 Core Animation，则需要将 QuartzCore.framework 添加到您的项目中，并`#import <QuartzCore/QuartzCore.h>`在您的实现顶部添加。

## 创建 UIBezierPath

如果您不知道什么是贝塞尔路径，请查看[Wikipedia 站点。](http://en.wikipedia.org/wiki/B%C3%A9zier_curve)一旦你知道你的控制点，你可以创建一个简单的贝塞尔路径，像这样（所有的点都是正常的 CGPoints）：

```
UIBezierPath *arcingPath = [UIBezierPath bezierPath];
[arcingPath moveToPoint:startPoint];
[arcingPath addCurveToPoint:endPoint 
              controlPoint1:controlPoint1 
              controlPoint2:controlPoint2];
CGPathRef animationPath = [arcingPath CGPath]; // The path you animate along 
```

# 放大

要实现缩放效果，您可以使用 CABasicAnimation 应用类似的动画来转换图层。只需从 0 比例的变换（无限小）到 1 比例的变换（正常大小）进行动画处理。

```
CABasicAnimation *zoom = [CABasicAnimation animationWithKeyPath:@"transform"];
[zoom setFromValue:[NSValue valueWithCATransform3D:CATransform3DMakeScale(0.0, 0.0, 1.0);];
[zoom setToValue:[NSValue valueWithCATransform3D:CATransform3DIdentity];
[zoom setDuration:5.0]; // 5 seconds
// some other configurations here maybe...
[[myPersonImageView layer] addAnimation:zoom forKey:@"zoomPersonToNormalSize"]; 
```

# 两者同时

要让两个动画同时运行，请将它们添加到动画组中，然后将其添加到人物图像视图中。如果你这样做，那么你配置动画组（使用持续时间等而不是单个动画）。

```
CAAnimationGroup *zoomAndMove = [CAAnimationGroup animation];
[zoomAndMove setDuration:5.0]; // 5 seconds
// some other configurations here maybe...
[zoomAndMove setAnimations:[NSArray arrayWithObjects:zoom, moveAlongPath, nil]];
[[myPersonImageView layer] addAnimation:zoomAndMove forKey:@"bothZoomAndMove"]; 
```

# c# - 重用数组以节省内存

> ID：10705590
> 
> 赞同：0
> 
> 时间：2012-05-22T15:53:17.037
> 
> 标签：c#, arrays, memory-management

我正在开发一个 C# 应用程序，该应用程序必须绘制大量数据（数据集大小介于 100 万个数据点到 3000 万个数据点之间）。

在绘图之前，我会进行线性插值以均匀地间隔点（插值是软件要求的一部分，所以我无法避免）。这导致比原始集合更多的数据点（例如，100 万个点很容易变成 150 万个或更多）。

在（愚蠢的？）尝试节省内存时，我一直在插入和绘制块。例如，我将块大小设置为 100,000，因此我插入前 100,000 个点并绘制它们，插入第二个 100,000 点并绘制它们，依此类推，直到绘制完所有插入点。

我并行使用两个数组（代表 x 和 y 值）。数组在下一个块开始之前重新分配。不幸的是，对于最大的数据集（大约 3000 万），程序会抛出 OutOfMemory 错误。

**我想知道是否可以简单地重用相同的两个并行数组，用每个块的新值覆盖旧值？这甚至是个好主意吗？**

阅读更多关于线性插值：[http ://en.wikipedia.org/wiki/Interpolation#Linear_interpolation](http://en.wikipedia.org/wiki/Interpolation#Linear_interpolation)

# extjs - 如何在 Extjs 4 中设置网格行高？

> ID：10705591
> 
> 赞同：3
> 
> 时间：2012-05-22T15:53:17.860
> 
> 标签：extjs, extjs4

我在我的项目中使用了Ext.grid.Panel，但是我觉得默认的行高太大，无法修改行高，所以整个网格让我感觉不舒服。

但是，我发现 Extjs-4 文档中的面板网格示例非常好。在其中调整行高以适应单词高度。因此整个网格非常紧凑。

所以我想知道如何设置网格行高？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-22T19:06:29.310

更改行高的一种方法是使用 css。每行都使用填充以及高度的内容，因此如果您在此类中更改填充，它将使该行更高/更低：

```
.x-grid-cell-inner {
    overflow: hidden;
    padding: 3px 6px;
    white-space: nowrap;
 } 
```

另外，您可以在这里查看：

[http://docs.sencha.com/ext-js/4-0/#!/api/Ext.view.Table-method-getRowClass](http://docs.sencha.com/ext-js/4-0/#!/api/Ext.view.Table-method-getRowClass)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-08-26T03:08:32.780

以下代码使用[`getRowClass`](https://docs.sencha.com/extjs/4.2.2/#!/api/Ext.view.Table-method-getRowClass)网格函数为特定行指定 CSS 类：

# JavaScript 代码

```
viewConfig : {  
    forceFit : true,  
    getRowClass : function(record, index) {  
        if (index % 2 == 0)  
            return "red";  
        else  
            return "green";  
    }  
}, 
```

然后可以使用 CSS 修改高度：

# CSS 代码

```
.red .x-grid-cell {  
     background-color: #FFFFDD;  
     height: 30px;
} 
```

# android - Android 拍照成功

> ID：10705594
> 
> 赞同：1
> 
> 时间：2012-05-22T15:53:43.657
> 
> 标签：android, memory, camera, heap-memory

这听起来像是一个奇怪/愚蠢的问题。但听我说完。

> 至少在 T-Mobile G1 上，Android 应用程序**限制为 16 MB 的堆**。

并且每个像素需要 4 个字节来存储图像（以位图形式）：

```
public void onPictureTaken(byte[] _data, Camera _camera) {
    Bitmap temp = BitmapFactory.decodeByteArray(_data, 0, _data.length);
} 
```

**所以 1 张 6 兆像素的图像占用了 24MB 的堆空间。（*提示内存溢出*）。**

现在我非常了解使用参数进行解码的能力，以有效减小图像的大小。我什至有一种方法可以将其缩小到所需的大小。

**但是在我想将相机用作优质相机的场景中呢？**

我不知道如何将此图像输入数据库。一旦我解码，它就会出错。

**注意：**我需要（？）将其转换为位图，以便在存储之前旋转它。

所以总结一下：

*   限制为 16MB 的堆
*   图像占用 24MB 堆
*   没有足够的空间来拍摄和处理图像

这并不能解决问题，但我建议将其作为其他仅从某个位置加载图像的起点： [Displaying Bitmaps on android](http://developer.android.com/training/displaying-bitmaps/index.html)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T16:51:53.873

我只能想到几件事可能会有所帮助，但没有一个是最佳的

1.  做你的轮换服务器端

2.  将捕获的数据直接存储到 SDCARD 而不对其进行解码，然后使用文件系统逐块旋转它，然后将其发送到您的数据库。网上有很多例子（如果你的角度很简单，90 180 等）虽然这会很耗时，因为针对 SDCARD 的 IO 操作并不是很快。

3.  当您解码 alpha 通道时，这可能无法解决您的问题，如果您使用矩阵来旋转图像，那么无论如何您都需要一个目标/源

    选项 opt = new Options();

    opt.inPreferredConfig = Bitmap.Config.RGB_565;

    // 将原始相机解码为没有 alpha 通道的位图
    bmp = BitmapFactory.decodeByteArray(raw, 0,raw.length, opt);

* * *

可能有更好的方法可以做到这一点，但由于您的设备在堆等方面非常有限。我想不出任何办法。

如果有一个可选的基于文件的矩阵方法（这通常是我建议的选项 2）或某种适用于 Android 的“分页”系统，那就太好了，但这是我能想到的最好的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T15:57:25.060

首先将其保存到文件系统，对文件系统中的文件进行操作...

# javascript - 如何在javascript中迭代数组

> ID：10705597
> 
> 赞同：9
> 
> 时间：2012-05-22T15:53:56.147
> 
> 标签：javascript, arrays, loops

我有一个像`var arr = { 30,80,20,100 };`

现在我想迭代上面的数组并将迭代的单个值添加到一个函数返回语句中，例如

```
function iterate()
{
    return "Hours" + arr[i];
} 
```

我曾尝试过以下方法

```
function m()
{
    for(var i in arr)
    {
        s = arr[i];
    }
    document.write(s);
} 
```

上面的代码将只给出一个值，即数组中的最后一个值。但我想迭代所有的值，比如

```
30---for first Iteration
80---for second Iteraton

Any help will be appreciated 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T15:56:45.870

使用长度属性而不是语句进行迭代，`for ... in`并从循环内部写入数组值。

```
for (var ii = 0, len = arr.length; ii < len; ii++) {
  document.write(arr[ii]);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T15:56:43.713

那是因为您的 write 语句在循环之外。你不想这样吗？

```
function m(arr) {
    for (var i = 0; i < arr.length; i++) {
        s = arr[i];
        document.write(s);
    }

}​ 
```

另外，不要使用 in 因为它会给你数组的所有属性。利用`array.length`

# python - 相对导入在 Python 中不起作用

> ID：10705598
> 
> 赞同：2
> 
> 时间：2012-05-22T15:54:00.157
> 
> 标签：python, python-3.x

我有一个这样的项目结构......

```
app/
    main.py
    app/
        __init__.py
        boot.py
        server.py
        controllers/
            __init__.py
            home.py 
```

进口是...

```
# main.py
from app import server

# server.py
from . import boot

# boot.py
from . import controllers

# controllers/__init__.py
from . import home

# controllers/home.py
from .. import boot 
```

**现在除了最后一个之外，**所有的导入都在工作。抛出的错误是......

```
ImportError: cannot import name boot 
```

有什么问题？（我正在使用 Python 3.2）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-22T15:59:25.537

您正在 import`boot`正在 import `controllers`，然后要求它 import `home`，`home`然后尝试 import `boot`，但尚未完成导入。不要这样做，你在这里创建了一个循环依赖。

另请参阅[Python 中的循环导入依赖项](https://stackoverflow.com/questions/1556387/circular-import-dependency-in-python)

# eclipse - 如何在 subclipse 中自定义提交命令？

> ID：10705600
> 
> 赞同：0
> 
> 时间：2012-05-22T15:54:18.847
> 
> 标签：eclipse, svn, aptana, subclipse, aptana3

我可以使用 Subclipse 很好地连接到我的 subversion 服务器，但我的提交不起作用，我想添加一些自定义命令以使其工作（我需要传递一个 un/pw）。如何设置这些参数？

现在它设置的命令就是 `commit -m ""` 我想要的

`commit -m --username <un> --password <pw>`

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T16:39:18.797

Subversion 将提示您输入用户名/密码，除非它缓存了有效凭据。如果您不想使用这些凭据，则需要清除 Subversion 的缓存。如果使用 JavaHL，这意味着删除 ~/.subversion/auth 文件夹。在 Windows 上，即 %APPDATA%\Subversion\auth

SVNKit 在 Eclipse 密钥环文件中缓存凭据。

# c# - 如何通过网络在两个 WinForm 应用程序之间调用函数？

> ID：10705606
> 
> 赞同：3
> 
> 时间：2012-05-22T15:54:36.693
> 
> 标签：c#, winforms, tcp

我在我的大厅里设置了一个视频亭，它可以让人们登记并打印带有他们的照片、姓名等的徽章。还有一个远程支持工具，不幸的是有时会崩溃。我在自助服务终端上有一个功能可以解决此问题，但您必须立即前往自助服务终端触发它。

我还编写了一个管理工具，它使用 WMI 来监视和管理信息亭的其他一些方面。我希望能够通过此应用程序触发此修复功能。我在谷歌上花了无数个小时试图解决这个问题，但没有运气。也许我不是在寻找正确的东西。

我的问题是这个。在 C# 中，如何通过网络从管理应用程序调用我的信息亭应用程序中的修复功能？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T20:50:47.923

好的，在我的`Server`表单上，我有一个运行[TcpListener的](http://msdn.microsoft.com/en-us/library/system.net.sockets.tcplistener.aspx)[BackgroundWorker](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.aspx)。您需要将此 TcpListener 放在 BackgroundWorker 中，否则在它接受 TcpClient 之前，您将永远无法阻止它执行。

此外，您将希望在执行主线程中处理从该后台线程接收到的任何数据，以防止跨线程异常：

```
private TcpListener _listener;
private const int port = 8000;

private void Worker_TcpListener(object sender, DoWorkEventArgs e) {
  BackgroundWorker worker = sender as BackgroundWorker;
  do {
    try {
      _listener = new TcpListener(IPAddress.Any, port);
      _listener.Start();
      TcpClient client = _listener.AcceptTcpClient(); // waits until data is avaiable
      int MAX = client.ReceiveBufferSize;
      NetworkStream stream = client.GetStream();
      Byte[] buffer = new Byte[MAX];
      int len = stream.Read(buffer, 0, MAX);
      if (0 < len) {
        string data = Encoding.UTF8.GetString(buffer);
        worker.ReportProgress(len, data.Substring(0, len));
      }
      stream.Close();
      client.Close();
    } catch (SocketException) {
      // See MSDN: Windows Sockets V2 API Error Code Doc for details of error code
    } catch (ThreadAbortException) { // If I have to call Abort on this thread
      return;
    } finally {
      _listener.Stop();
    }
  } while (!worker.CancellationPending);
} 
```

这对于大型消息（如 JPEG 文件等）来说并不好，但对于我在特殊数据中进行编码以查找的短字符串非常有用。

该数据被发送回我的主执行线程（使用该`ReportProcess`方法），在该线程中处理数据：

```
private void Worker_TcpListener(object sender, ProgressChangedEventArgs e) {
  if (e.UserState != null) {
    int len = e.ProgressPercentage;
    string data = e.UserState.ToString();
    if (!String.IsNullOrEmpty(data) && (3 < len)) {
      string head = data.Substring(0, 3);
      string item = data.Substring(3);
      if (!String.IsNullOrEmpty(item)) {
        if (head == "BP:") {
          string[] split = data.Split(';');
          if (2 < split.Length) {
            string box = split[0].Substring(3); // Box Number
            string qty = split[1].Substring(2); // Quantity
            string customer = split[2].Substring(2); // Customer Name
            MyRoutine(box, qty, customer);
          }
        }
      }
    }
  }
} 
```

上面的代码整天都在运行。

同时，我厂里大约有 10 台 Pocket PC 设备可以随时发送数据。他们的代码是用 VB 编写的，我真的希望我有时间完成我的 C# 版本之一，但这里是：

```
Private Sub SendToServer(string serialNum, int qty, string customer)
  Cursor.Current = Cursors.WaitCursor
  Try
    Dim strPacket As String = String.Format("BP:{0};Q:{1};C:{2};", serialNum, qty, customer)
    Dim colon As Integer = p7_txtIPAddress.Text.IndexOf(":")
    Dim host As String = p7_txtIPAddress.Text.Substring(0, colon)
    Dim port As Integer = CInt(p7_txtIPAddress.Text.Substring(colon + 1))
    Dim dataPacket As [Byte]() = Encoding.ASCII.GetBytes(strPacket)
    Using client As New TcpClient(host, port)
      Dim stream As NetworkStream = client.GetStream()
      stream.Write(dataPacket, 0, dataPacket.Length)
    End Using
  Catch err As Exception
    MessageBox.Show(err.Message, "Print To Server TCP Error")
  Finally
    Cursor.Current = Cursors.Default
  End Try
End Function 
```

我不知道这是否是您想要做的，但它有效且可靠。

显然，我在生产中的代码更大，并且包含了其他你不会觉得有用的东西（即员工验证、错误记录器等）。我已经剪掉了很多，我希望我没有剪掉任何必要的东西。

至少，这应该让您了解如何前进。

# sencha-touch - Sencha touch 2 - 在代理加载时显示响应（JSON 字符串）

> ID：10705611
> 
> 赞同：1
> 
> 时间：2012-05-22T15:54:58.757
> 
> 标签：sencha-touch, sencha-touch-2

有没有办法输出我的商店在 sencha touch 2 中读取的 json 字符串？

我的商店没有读取记录，所以我想看看哪里出了问题。我的商店定义如下：

```
Ext.define("NotesApp.store.Online", {
    extend: "Ext.data.Store",
           config: {
           model: 'NotesApp.model.Note',
           storeId: 'Online',
           proxy: {
               type: 'jsonp',
               url: 'http://xxxxxx.com/qa.php',
               reader: {
                   type: 'json',
                   rootProperty: 'results'
               }
           },
           autoLoad: false,
           listeners: {
               load: function() {   
                    console.log("updating");
                   // Clear proxy from offline store
                   Ext.getStore('Notes').getProxy().clear();
                   console.log("updating1");
                   // Loop through records and fill the offline store

                    this.each(function(record) {
                             console.log("updating2");
                             Ext.getStore('Notes').add(record.data);

                   });

                   // Sync the offline store
                   Ext.getStore('Notes').sync();
                   console.log("updating3");
                   // Remove data from online store
                   this.removeAll();
                    console.log("updated");
               }

           },
           fields: [
                    {
                    name: 'id'
                    },
                    {
                    name: 'dateCreated'
                    },
                    {
                    name: 'question'
                    },
                    {
                    name: 'answer'
                    },
                    {
                    name: 'type'                    
                    },
                    {
                    name: 'author'
                    }
                    ]
           }
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T14:00:01.840

您可以通过代理获取服务器返回的所有数据，如下所示：

```
store.getProxy().getReader().rawData 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-22T10:06:14.867

[正如lasaro](https://stackoverflow.com/users/617728/lasaro)所建议的那样，您可以通过代理获取服务器返回的所有数据（javascript对象）：

```
store.getProxy().getReader().rawData 
```

要获取原始数据的 JSON 字符串（阅读器应该是 JSON 阅读器），您可以执行以下操作：

```
Ext.encode(store.getProxy().getReader().rawData)

//or if you don't like 'shorthands':
Ext.JSON.encode(store.getProxy().getReader().rawData) 
```

您也可以通过处理 store 加载事件来获取它：

```
// add this in the store config
listeners: {
    load: function(store, records, successful, operation, eOpts) {
        operation.getResponse().responseText
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T03:28:37.407

您的响应 json 在 Ajax 请求中应采用以下格式

```
{results:[{"id":"1", "name":"note 1"},{"id":"2", "name":"note 2"},{"id":"3", "name":"note 3"}]} 
```

id 和 name 是您的模型的属性 注意。

对于 jsonp，

在您的服务器端，从“回调”中获取价值。该值包含回调方法的名称。然后将该方法名称连接到您的结果字符串并写入响应。

那么json字符串应该是以下格式

```
callbackmethod({results:[{"id":"1", "name":"note 1"},{"id":"2", "name":"note 2"},{"id":"3", "name":"note 3"}]}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-22T18:40:10.747

据我所知，如果您使用配置的，则无法明确观察您的响应结果`proxy`（如果您手动发送`Ext.Ajax.request`或显然很容易`Ext.JsonP.request`）。

但是，您仍然可以通过浏览器的开发人员工具查看结果。

**对于谷歌浏览器：**

当您启动应用程序并假设您的请求已完成时。切换到**网络**选项卡。左侧面板上突出显示的链接是我从中获取数据的 API url。在右侧面板上，选择**Response**。响应结果将出现在那里。如果你什么都没有，很可能你触发了错误的请求。

![开发工具](../Images/398327923a8d1dac5bca19fc8a515578.png)

希望这可以帮助。

# c - 如何使用 open 以“追加”模式打开文件？开？

> ID：10705612
> 
> 赞同：2
> 
> 时间：2012-05-22T15:54:59.663
> 
> 标签：c, file, file-io

为了写入新文件，我执行以下操作：

```
// some code 
...

 pfd[i][0] = open(argv[j+1],O_CREAT|O_WRONLY,0600); 
```

问题 ：

1.  `open`使用or和有区别`fopen`吗？

2.  如何使用模式`open`打开现有文件`append`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T15:59:18.897

1.  `open`适用于 POSIX 系统。它不能移植到其他系统。`fopen`是 C 标准的一部分，因此它适用于所有 C 实现。我忽略了`open`返回文件描述符的区别，其中`fopen`返回`FILE *`.

2.  用于`O_APPEND`打开附加模式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T15:58:53.790

1.  区别在于它`open`是一个不可移植的 POSIX 函数，而它是一个`fopen`可移植的标准 C 函数。
2.  `O_APPEND`调用时指定`open`使用附加模式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-22T15:59:35.773

利用`O_APPEND`

引用[POSIX 文档](http://pubs.opengroup.org/onlinepubs/9699919799/)`open()`中的描述

> O_APPEND
> 如果设置，文件偏移量应设置为每次写入之前的文件末尾。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-22T16:23:02.983

1) 是的。有一个区别：**缓冲或非缓冲 I/O。**
`open()`给你一个 RAW 文件句柄（在你的程序和文件系统中的文件之间没有缓冲区）。

`fopen()`授予您以流缓冲区模式处理文件的权限。例如，您可以逐行读取/写入数据 (\0)。

使用以下功能时，您会看到很大的不同：`fprintf()`, `fscanf()`, `fgets()`, `fflush()`.

ps：`fopen()`不比`open()`。它们是不同的东西。有时您需要流缓冲区 (fopen)，有时您需要逐字节工作 (open)。

这是关于流的一个很好的参考：[http ://www.cs.cf.ac.uk/Dave/C/node18.html#SECTION001820000000000000000](http://www.cs.cf.ac.uk/Dave/C/node18.html#SECTION001820000000000000000)

2）要以附加模式打开，请添加`O_APPEND`标志：

`open(argv[j+1],O_CREAT|O_APPEND|O_WRONLY,0600);`

# php - 使用cron或其他什么？

> ID：10705613
> 
> 赞同：0
> 
> 时间：2012-05-22T15:55:00.053
> 
> 标签：php, codeigniter, cron

我需要制作一个应用程序，管理员将在其中添加足球比赛。

然后，这些比赛将显示在主页上，并且会在比赛开始之前添加。现在，如果他在 17:15 添加它，并在 20:45 开始匹配，我需要它来开始标签匹配，然后我将禁用它或从页面中删除它。

我正在使用 codeigniter php 框架，我没有看到它们对 cron 作业有用。在这种情况下使用 cron 方法吗？我可能需要使用 php 本机 cron 函数

任何建议表示赞赏

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T16:03:06.237

cron 用于需要执行计划任务的服务器端，cron 在应用程序的前端不显示任何内容，您可能需要定期调用脚本，然后检查您想从数据库中检查的任何内容

```
jQuery(document).ready(function () {
setTimeout( function() {
        // here you can call any javascript function which will access your script through ajax call
}, 1000 ); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-22T15:58:25.117

除了定期清理旧的数据库条目外，我看不出 cron 在这里可以做什么。

您需要做的就是检查当前时间与数据库中的开始时间。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-22T15:59:58.563

我认为你不需要为此做一个 cron 工作。每次用户请求时，PHP 都会评估代码并构建您的页面，因此您可以确保显示该确切时间的适当匹配项。您只需围绕一个查询构建您的页面，该查询选择结束时间晚于当前时间的匹配项。

# function - 表名作为 PostgreSQL 函数参数

> ID：10705616
> 
> 赞同：99
> 
> 时间：2012-05-22T15:55:13.483
> 
> 标签：function, postgresql, plpgsql, dynamic-sql, identifier

我想在 Postgres 函数中将表名作为参数传递。我试过这段代码：

```
CREATE OR REPLACE FUNCTION some_f(param character varying) RETURNS integer 
AS $$
    BEGIN
    IF EXISTS (select * from quote_ident($1) where quote_ident($1).id=1) THEN
     return 1;
    END IF;
    return 0;
    END;
$$ LANGUAGE plpgsql;

select some_f('table_name'); 
```

我得到了这个：

```
ERROR:  syntax error at or near "."
LINE 4: ...elect * from quote_ident($1) where quote_ident($1).id=1)...
                                                             ^

********** Error **********

ERROR: syntax error at or near "." 
```

这是我改成这个时遇到的错误`select * from quote_ident($1) tab where tab.id=1`：

```
ERROR:  column tab.id does not exist
LINE 1: ...T EXISTS (select * from quote_ident($1) tab where tab.id... 
```

可能`quote_ident($1)`有效，因为没有`where quote_ident($1).id=1`我得到的部分`1`，这意味着选择了某些东西。为什么第一个`quote_ident($1)`工作和第二个不能同时工作？这怎么能解决？

* * *

## 回答 #1

> 赞同：148
> 
> 时间：2012-05-22T23:07:21.583

这可以进一步简化和改进：

```
CREATE OR REPLACE FUNCTION some_f(_tbl regclass, OUT result integer)
    LANGUAGE plpgsql AS
$func$
BEGIN
   EXECUTE format('SELECT (EXISTS (SELECT FROM %s WHERE id = 1))::int', _tbl)
   INTO result;
END
$func$; 
```

使用模式限定名称调用（见下文）：

```
SELECT some_f('myschema.mytable');  -- would fail with quote_ident() 
```

或者：

```
SELECT some_f('"my very uncommon table name"'); 
```

### 要点

使用**`OUT`参数**来简化函数。您可以直接将动态SQL的结果选择进去并完成。不需要额外的变量和代码。

**`EXISTS`**做你想要的。`true`如果该行存在或其他，你会得到`false`。有多种方法可以做到这一点，`EXISTS`通常是最有效的。

您似乎想要一个**整数**，所以我将`boolean`结果从`EXISTS`to 转换为`integer`，这正是您所拥有的。我会返回[**布尔值**](https://www.postgresql.org/docs/current/datatype-boolean.html)。

我使用对象标识符类型[**`regclass`**](https://www.postgresql.org/docs/current/datatype-oid.html)作为`_tbl`. 这可以做任何事情[`quote_ident(_tbl)`](https://www.postgresql.org/docs/current/functions-string.html#FUNCTIONS-STRING-OTHER)或[`format('%I', _tbl)`](https://www.postgresql.org/docs/current/functions-string.html#FUNCTIONS-STRING-FORMAT)会做，但更好，因为：

*   .. 它也可以防止**SQL 注入**。

*   .. 如果表名无效/不存在/对当前用户不可见，它会立即更优雅地失败。（`regclass`参数仅适用于*现有*表。）

*   .. 它适用于模式限定的表名，其中一个普通的`quote_ident(_tbl)`或`format(%I)`会失败，因为它们无法解决歧义。您必须分别传递和转义模式和表名。

显然，它仅适用于*现有表。*

我仍然[**`format()`**](https://www.postgresql.org/docs/current/functions-string.html#FUNCTIONS-STRING-FORMAT)使用`%s`. `%I`通常，查询更复杂，所以`format()`帮助更多。对于简单的示例，我们也可以连接：

```
EXECUTE 'SELECT (EXISTS (SELECT FROM ' || _tbl || ' WHERE id = 1))::int' 
```

`id`当列表中只有一个表时，无需对列进行表限定`FROM`。在这个例子中不可能有歧义。（动态）内部的 SQL 命令`EXECUTE`有一个**单独的范围**，函数变量或参数在那里不可见 - 与函数体中的普通 SQL 命令相反。

这就是为什么您*总是*正确地为动态 SQL 转义用户输入的原因：

*db<>fiddle [here](https://dbfiddle.uk/?rdbms=postgres_12&fiddle=4814dff565e78fad04b9e9f9ca16dcf3)*演示 SQL 注入
[Old [sqlfiddle](http://sqlfiddle.com/#!17/39ef7/15)]

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-07-11T00:20:02.803

如果可能的话，不要这样做。

这就是答案——它是一种反模式。如果客户端知道它想要从中获取数据的表，那么`SELECT FROM ThatTable`. 如果数据库的设计方式是需要的，那么它的设计似乎不是最理想的。如果数据访问层需要知道表中是否存在某个值，那么在那个代码中编写 SQL 是很容易的，而将这个代码推入数据库是不好的。

对我来说，这就像在电梯内安装一个设备，可以在其中输入所需楼层的数量。按下 Go 按钮后，它将机械手移至所需楼层的正确按钮并按下它。这引入了许多潜在的问题。

*请注意：这里没有嘲讽的意图。我愚蠢的电梯示例是*我能想象到的最好的设备*，用于简洁地指出这种技术的问题。它添加了一个无用的间接层，将表名选择从调用者空间（使用健壮且易于理解的 DSL、SQL）移动到使用晦涩/怪异的服务器端 SQL 代码的混合体中。*

这种通过将查询构造逻辑移动到动态 SQL 中的职责划分使得代码更难理解。它以充满潜在错误的自定义代码的名义违反了标准且可靠的约定（SQL 查询如何选择要选择的内容）。

以下是有关此方法的一些潜在问题的详细要点：

*   动态 SQL 提供了在前端代码或单独的后端代码中难以识别的 SQL 注入的可能性（必须一起检查它们才能看到这一点）。

*   存储过程和函数可以访问 SP/函数所有者有权但调用者没有的资源。据我了解，没有特别注意，那么默认情况下，当您使用生成动态SQL并运行它的代码时，数据库会在调用者的权限下执行动态SQL。这意味着您要么根本无法使用特权对象，要么必须向所有客户端开放它们，从而增加了对特权数据的潜在攻击的表面积。在创建时将 SP/函数设置为始终以特定用户身份运行（在 SQL Server 中`EXECUTE AS`）可能会解决该问题，但会使事情变得更加复杂。通过使动态 SQL 成为非常诱人的攻击向量，这加剧了前面提到的 SQL 注入的风险。

*   当开发人员必须了解应用程序代码在做什么以便对其进行修改或修复错误时，他会发现很难获得正在执行的确切 SQL 查询。可以使用 SQL 探查器，但这需要特殊权限并且会对生产系统产生负面的性能影响。执行的查询可以由 SP 记录，但这会增加复杂性以获得可疑的好处（需要容纳新表、清除旧数据等）并且非常不明显。事实上，一些应用程序的架构使得开发人员没有数据库凭据，因此他几乎不可能真正看到正在提交的查询。

*   当发生错误时，例如当您尝试选择一个不存在的表时，您会从数据库中收到一条类似于“无效对象名称”的消息。无论您是在后端还是在数据库中编写 SQL，这都会发生完全相同的情况，但不同的是，一些试图对系统进行故障排除的可怜的开发人员必须深入到另一个洞穴下面的另一个洞穴中。问题存在，深入挖掘“Does It All”的奇妙过程，试图找出问题所在。日志不会显示“GetWidget 中的错误”，它会显示“OneProcedureToRuleThemAllRunner 中的错误”。这种抽象通常会使系统*变得更糟*。

基于参数切换表名的伪 C# 示例：

```
string sql = $"SELECT * FROM {EscapeSqlIdentifier(tableName)};"
results = connection.Execute(sql); 
```

虽然这并不能消除所有可以想象的问题，但我用其他技术概述的缺陷在此示例中不存在。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2012-05-22T18:49:52.880

在 plpgsql 代码中，[EXECUTE](http://www.postgresql.org/docs/current/static/plpgsql-statements.html#PLPGSQL-STATEMENTS-EXECUTING-DYN)语句必须用于表名或列来自变量的查询。动态生成时也不允许`IF EXISTS (<query>)`构造。`query`

这是解决了这两个问题的函数：

```
CREATE OR REPLACE FUNCTION some_f(param character varying) RETURNS integer 
AS $$
DECLARE
 v int;
BEGIN
      EXECUTE 'select 1 FROM ' || quote_ident(param) || ' WHERE '
            || quote_ident(param) || '.id = 1' INTO v;
      IF v THEN return 1; ELSE return 0; END IF;
END;
$$ LANGUAGE plpgsql; 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2020-05-18T18:47:07.483

我知道这是一个旧线程，但我最近在尝试解决相同的问题时遇到了它 - 在我的情况下，对于一些相当复杂的脚本。

将整个脚本变成动态 SQL 并不理想。这是一项乏味且容易出错的工作，并且您失去了参数化的能力：必须将参数插入到 SQL 中的常量中，从而对性能和安全性造成不良后果。

如果您只需要从表中进行选择，这里有一个简单的技巧可以让您保持 SQL 完整 - 使用动态 SQL 创建临时视图：

```
CREATE OR REPLACE FUNCTION some_f(_tbl varchar) returns integer
AS $$
BEGIN
    drop view if exists myview;
    execute format('create temporary view myview as select * from %s', _tbl);
    -- now you can reference myview in the SQL
    IF EXISTS (select * from myview where myview.id=1) THEN
     return 1;
    END IF;
    return 0;
END;
$$ language plpgsql; 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-05-22T16:35:02.570

从您的意思来看，第一个实际上并没有“工作”，它仅在不产生错误的情况下才有效。

试试看`SELECT * FROM quote_ident('table_that_does_not_exist');`，你会明白为什么你的函数返回 1：select 返回一个表，其中有一列（命名`quote_ident`）和一行（变量`$1`或在这种特殊情况下`table_that_does_not_exist`）。

您想要做的事情将需要动态 SQL，这实际上是`quote_*`要使用函数的地方。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2017-12-21T14:24:16.450

如果问题是测试表是否为空（id=1），这里是 Erwin 的存储过程的简化版本：

```
CREATE OR REPLACE FUNCTION isEmpty(tableName text, OUT zeroIfEmpty integer) AS
$func$
BEGIN
EXECUTE format('SELECT COALESCE ((SELECT 1 FROM %s LIMIT 1),0)', tableName)
INTO zeroIfEmpty;
END
$func$ LANGUAGE plpgsql; 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-08-28T10:35:08.993

如果您希望将表名、列名和值作为参数动态传递给函数

使用此代码

```
create or replace function total_rows(tbl_name text, column_name text, value int)
returns integer as $total$
declare
total integer;
begin
    EXECUTE format('select count(*) from %s WHERE %s = %s', tbl_name, column_name, value) INTO total;
    return total;
end;
$total$ language plpgsql;

postgres=# select total_rows('tbl_name','column_name',2); --2 is the value 
```

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2015-04-30T12:15:13.093

我有 9.4 版本的 PostgreSQL，我总是使用这个代码：

```
CREATE FUNCTION add_new_table(text) RETURNS void AS
$BODY$
begin
    execute
        'CREATE TABLE ' || $1 || '(
        item_1      type,
        item_2      type
        )';
end;
$BODY$
LANGUAGE plpgsql 
```

进而：

```
SELECT add_new_table('my_table_name'); 
```

它对我有用。

**注意力！**上面的示例是显示“如果我们想在查询数据库期间保持安全性如何不做”的示例之一：P

# php - 计算数量而不是行数 - MySQL/PHP

> ID：10705617
> 
> 赞同：1
> 
> 时间：2012-05-22T15:55:16.777
> 
> 标签：php, mysql, count, inner-join

前段时间我问过一个关于我的 SQL 查询的问题，它工作得很好，直到我注意到我忘记了代码中一个非常重要的部分，现在我花了大约一个半小时试图修改我的代码。最初的问题询问了一种内部连接两个表（orders 和 order_items）的好方法。然后我在 SQL Query 上做了一个 mysql_num_row() 并称之为一天。我忘记了我的 order_items 表中有一个名为数量的单元格。我需要将其整合到我的计数中。我在下面包含了我的代码，任何关于如何轻松实现它的想法都将不胜感激。

```
$SQL2ORDERSEARCH = "
SELECT * FROM order_items
INNER JOIN orders
ON orders.id = order_items.ord
WHERE orders.session = '$sessionID'
AND order_items.dish = '$SEARCHITEMS_OBJECT->dish'
AND order_items.size = 'full'";

$ORDERSEARCH = mysql_query($SQL2ORDERSEARCH) or die(mysql_error());
$ORDERSEARCH_NUM_ROWS = mysql_num_rows($ORDERSEARCH);
$FULLTOTAL = $FULLTOTAL + $ORDERSEARCH_NUM_ROWS; 
```

我尝试通过计数尝试不同的路线。所以我修改了我的查询：

```
$SQL2ORDERSEARCH = "
SELECT COUNT(quantity) FROM order_items
INNER JOIN orders
ON orders.id = order_items.ord
WHERE orders.session = '$sessionID'
AND order_items.dish = '$SEARCHITEMS_OBJECT->dish'
AND order_items.size = 'full'"; 
```

从技术上讲，我不需要任何其他东西，因为我要做的就是计算这里涉及多少菜。然后我创建了一个 if 语句来确定是否有来自该查询的任何行，然后计算它们的数量。

```
if($ORDERSEARCH_NUM_ROWS > 0 ) {
   while($ORDERSEARCH_OBJECT = mysql_fetch_object($ORDERSEARCH)) {
      $FULLQTY = COUNT($ORDERSEARCH_OBJECT->quantity);
   }
} 
```

我得到了好坏参半的结果。有时我会在数据表中直接得到 1。其他时候（取决于任何小的变化，例如 $FULLQTY += COUNT($ORDERSEARCH_OBJECT->quantity); 并尝试）我得到的结果看起来几乎类似于模式，数字增加了 5+，并且以某种方式加起来接近20+ 你去的列表越往下。

我只是在寻找一种简单的方法来获取 order_items 中数量单元格的计数，将它们显示在表格中，然后计算总数。减去 order_items 中数量单元格的计数，我一切都很好。任何想法，我将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T15:59:23.617

一个简单的*选择总和（数量）*在这里不起作用吗？

# wordpress - 为 WordPress 主题插入默认内容

> ID：10705621
> 
> 赞同：0
> 
> 时间：2012-05-22T15:55:32.797
> 
> 标签：wordpress, wordpress-theming

我创建了一个主题，我希望能够插入默认内容，例如帖子、页面、类别。做这个的最好方式是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T18:48:15.353

编写一个调用 SQL 查询的 PHP 函数，该查询将默认内容写入相关表。帖子、页面和类别可以通过 SQL 查询直接写入数据库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T01:21:31.053

您可以通过导入 XML 文件来完成此操作，该文件具有虚拟帖子、页面和评论。我在谷歌上找到了一个你可以使用的，[在这里下载](http://churchcrunch.com/wp-content/uploads/2008/12/churchcrunch_wordpress_dummy_data.zip)

# wix - TeamCity 构建 MSP 文件

> ID：10705624
> 
> 赞同：3
> 
> 时间：2012-05-22T15:55:45.010
> 
> 标签：wix, teamcity, artifacts, msp

背景：我有一个相当不错的 TeamCity 设置；包含一个 ci 构建和一个发布构建，它使用 WiX 构建我的安装程序并修补所有版本号。当我进行新的发布构建时，我想针对以前的一组安装程序自动创建 MSP 补丁。我想要么在 TeamCity 中标记 RTM，要么作为版本号列表。

我倾向于的方法是创建一个单独的配置并获取符合标准（标签或版本号）的所有先前构建的 msi 工件。标签看起来更整洁，但我在文档中看不到有关您如何使用它的任何内容？

我有一个脚本来构建 MSP 补丁，但它依赖于一个 PCP 文件，需要在 ORCA 中编辑该文件来描述补丁。

1.  在编辑 PCP 方面，除了 ORCA 之外，我还有什么可以用来编辑的吗？我一直在考虑转向 WiX 方法：[http](http://wix.sourceforge.net/manual-wix3/patch_building.htm) ://wix.sourceforge.net/manual-wix3/patch_building.htm看起来很有希望。
2.  有谁知道您是否可以在同一版本或另一个版本中按标签访问 TeamCity 中的工件？
3.  是否有人对在 TeamCity 中自动构建/链接 MSP 补丁文件有任何其他见解？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T16:18:52.887

1.  您可以使用 WiX 工具集中的 PatchCreation 元素构建 .PCP 文件。这可能会为您提供创建自定义 .PCP 文件所需的必要灵活性。

2.  抱歉，不要使用 TeamCity。

3.  抱歉，不要使用 TeamCity。:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-25T14:49:00.503

要添加到 Rob 的答案：

#2。TeamCity 可以按标签检索项目：

```
http://servername:8080/httpAuth/app/rest/buildTypes/id:bt13/builds?status=SUCCESS&amp;tag=RTM 
```

#3。我在 WiX 工具集中使用了 PatchCreation 元素（上面 Rob 建议），他说得对，它足够灵活。这是我构建的内容的概述，在测试中似乎一切都很好，

teamcity 项目有许多构建参数，它们是：

1.  新版本号 - 默认为 changeme，因此如果未更改它会破坏构建。

2.  旧版本号——如上

3.  新的构建 repo - 这是 buildtypeid，查看您项目的查询字符串，它将有 buildTypeId=btXX。XX 是此处应提供的数字。

4.  旧版本仓库 - 如上所述

teamcity 项目有以下步骤：

1.  运行 build.msbuild 的 MSBuild 运行器（见下文）

2.  在 patch.wxs 上运行 Candle 以创建 patch.wixobj 文件

3.  在 patch.wixobj 上运行 Light 以创建 patch.pcp

4.  解压新版本（命令：msiexec /q /a new.msi） -

5.  解压旧版本（命令：msiexec /q /a old.msi） - 选择不同的工作目录

6.  创建补丁（命令：msimsp -s patch.pcp p hotfix-%system.msiOldVersion%-%system.msiNewVersion%.msp -l patch.log

**MSBuild 创建 patch.pcp**

```
<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="4.0" DefaultTargets="Build"  xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <!--<Import Project="references\MSBuild.Community.Tasks.Targets"/>-->
  <UsingTask AssemblyFile="references\MSBuild.Community.Tasks.dll" TaskName="WebDownload"/>
  <UsingTask AssemblyFile="references\MSBuild.Community.Tasks.dll" TaskName="TemplateFile"/>
  <Target Name="Build">
    <!-- preconditions for build -->
    <Error Condition="'$(msiOldVersion)' == 'changeme'" Text="Use run custom build, setting the client version of the msi"/>
    <Error Condition="'$(msiOldVersion)' == ''" Text="Use run custom build, setting the client version of the msi"/>
    <Error Condition="'$(msiNewVersion)' == 'changeme'" Text="Use run custom build, setting the new version of the msi"/>
    <Error Condition="'$(msiNewVersion)' == ''" Text="Use run custom build, setting the new version of the msi"/>
    <Message Text="Old Version: $(msiOldVersion)"/>
    <Message Text="New version: $(msiNewVersion)"/>

    <!-- download files from teamcity... -->
    <WebDownload FileUri="http://server:8080/httpAuth/repository/download/bt$(msiOldRepo)/trunk/Path/bin/Release/en-us/installer-v-v.$(msiOldVersion).msi" UserName="download" Password="abcdefgh" FileName="downloads/oldversion.msi"  />
    <WebDownload FileUri="http://server:8080/httpAuth/repository/download/bt$(msiNewRepo)/trunk/Path/bin/Release/en-us/installer-v.$(msiNewVersion).msi" UserName="download" Password="abcdefgh" FileName="downloads/newversion.msi"  />

    <!-- fill in blanks in patch.wxs -->
    <ItemGroup>
      <Tokens Include="oldVersion">
        <ReplacementValue>$(msiOldVersion)</ReplacementValue>
      </Tokens>
      <Tokens Include="newVersion">
        <ReplacementValue>$(msiNewVersion)</ReplacementValue>
      </Tokens>
    </ItemGroup>
    <TemplateFile Template="template.wxs" OutputFileName="patch.wxs" Tokens="@(Tokens)"/>    
  </Target> 
```

**MSBuild 脚本使用的 Template.wxs**

```
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
  <PatchCreation
      Id="deadbeef-dead-beef-dead-beefdeadbeef"
      CleanWorkingFolder="no"
      OutputPath="patch.pcp"
      WholeFilesOnly="no">
    <PatchInformation
        Description="Small Update Patch"
        Comments="Small Update Patch"                        
        Manufacturer="Your Manufacturer"/>
    <PatchMetadata
        AllowRemoval="yes"
        Description="Hotfix"
        ManufacturerName="Your Manufacturer"
        MoreInfoURL="http://yourwebsite.com"
        TargetProductName="Your Product Name"        
        Classification="Hotfix"
        DisplayName="Hotfix - TBC"/>

    <Family DiskId="5000"
        MediaSrcProp="Sample"
        Name="Sample"
        SequenceStart="5000">
      <UpgradeImage SourceFile="downloads\newunpack\newVersion.msi" Id="SampleUpgrade">
        <TargetImage SourceFile="downloads\oldunpack\oldVersion.msi" Order="2"
            Id="SampleTarget" IgnoreMissingFiles="no" />
      </UpgradeImage>
    </Family>

    <PatchSequence PatchFamily="SamplePatchFamily"        
        Supersede="yes" />    
  </PatchCreation>
</Wix> 
```

# ios - Facebook 图形 API：事件时区、时间

> ID：10705629
> 
> 赞同：0
> 
> 时间：2012-05-22T15:56:05.687
> 
> 标签：ios, facebook, events, facebook-graph-api

我目前在通过 Facebook 的图形 API 获取事件的正确时间时遇到问题。有些事件显示正确的时间，有些则没有。即使我错误地计算了时区，这对我来说也没有意义。

例如，我有以下三个事件：“Brunch”、“Champions League finale”和“Pfingst-Tanz”。这就是图形 API 所返回的：

```
{
   "data": [
      {
         "name": "Pfingst-Tanz",
         "start_time": "2012-05-27T10:00:00",
         "end_time": "2012-05-27T14:00:00",
         "timezone": "Europe/Berlin",
         "location": "...",
         "id": "..."
      },
      {
         "name": "Championsleague Finale",
         "start_time": "2012-05-19T11:45:00",
         "end_time": "2012-05-19T14:45:00",
         "timezone": "Europe/Berlin",
         "location": "...",
         "id": "..."
      },
      {
         "name": "Muttertagsbrunch",
         "start_time": "2012-05-13T10:00:00",
         "end_time": "2012-05-13T14:00:00",
         "location": "...",
         "id": "..."
      }
   ],
   "paging": { … }
} 
```

在 Facebook 页面上，它显示：

*   Pfingst-Tanz 19:00 (07:00 pm)
*   欧冠决赛 20:45 (8:45 pm)
*   早午餐 10:00（上午 10:00）

结果是：

*   Pfingst-Tanz：我的应用程序中的 Facebook 页面正确、API 不正确或 TZ 不正确
*   （欧冠决赛：不知道，没关系）
*   早午餐：Facebook 页面和 API 正确且相同

这只是彼此不对应。据我了解，要么全错要么没有错，但不仅仅是 1/3 或 2/3 事件。有没有人有想法，或者我只是太盲目了，看不到什么东西？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T15:59:01.847

您的“早午餐”事件不包含时区，因此无法将其调整为用户的本地时区，这是我假设 Facebook 正在做的事情。

我不清楚`start_time`and`end_time`值是表示*本地*开始/结束时间（在给定时区中）还是 UTC 开始/结束时间，但这应该很容易根据数据计算出来（和文档，希望如此）。我怀疑指定时区时是UTC开始/结束，否则是*本地开始/结束。*

# android - Fragment中的Android KeyboardView没有被调整大小

> ID：10705631
> 
> 赞同：0
> 
> 时间：2012-05-22T15:56:11.060
> 
> 标签：android, android-layout, android-softkeyboard

我在 TabHost 中使用 Fragment 类。这个片段像这样膨胀一个 KeyboardView：

```
@Override
public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
        if (container == null)
            return null;
        View v = inflater.inflate(R.layout.main_keyboard, container, false); 
```

这在第一次`onCreateView()`调用时工作正常（当应用程序加载时）。但是，随后的屏幕旋转（运行时配置更改）不会正确地将 KeyboardView 调整为横向/纵向：

![在此处输入图像描述](../Images/a10368a3f83cb2f145ac87cd57859453.png) ![在此处输入图像描述](../Images/1188953fcd80146f911443067df70faa.png)

**main_keyboard.xml**你可以在底部看到被引用的 KeyboardView：`

```
<LinearLayout
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:orientation="vertical" >

    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_gravity="center"
        android:gravity="center" >

        <RelativeLayout
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:paddingRight="10dip" >

            <TextView
                android:id="@+id/kbd_header"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:paddingRight="10dip"
                android:text="@string/keyboard_type" />

            <TextView
                android:id="@+id/kbd_type"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_below="@id/kbd_header"
                android:text="@string/russian"
                android:textColor="#FF0000"
                android:textStyle="bold" />
        </RelativeLayout>

        <ImageButton
            android:id="@+id/btnRussian"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_marginRight="10dip"
            android:contentDescription="@string/russian_keyboard"
            android:src="@drawable/russia" />

        <ImageButton
            android:id="@+id/btnEnglish"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_marginRight="10dip"
            android:contentDescription="@string/english_keyboard"
            android:src="@drawable/america"
             />

        <ImageButton
            android:id="@+id/btnCombined"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:contentDescription="@string/combined"
            android:src="@drawable/combined" />

    </LinearLayout>

<com.eazyigz.RussiaMediaSearch.CustomKeyboardView
    android:id="@+id/keyboard_view"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:layout_alignParentBottom="true"
    android:layout_margin="0px"
    android:padding="0px" >
</com.eazyigz.RussiaMediaSearch.CustomKeyboardView> 
```

有人对如何使 KeyboardView 正确调整大小有想法吗？

谢谢你，伊戈尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T18:22:22.757

问题已解决：我 `if (savedInstanceState != null)`在**onCreateView**中使用：并且每次屏幕旋转时都没有创建新的 Keyboard 对象。所以这就是键盘没有调整大小的原因。为了解决这个问题，我每次都需要运行这样的代码：

```
mKeyboard = new Keyboard(getActivity(), R.xml.keyboard); 
```

# sql - 此表和查询的最佳索引？

> ID：10705645
> 
> 赞同：2
> 
> 时间：2012-05-22T15:56:41.143
> 
> 标签：sql, sqlite

我有一个必须尽快运行的 sqlite 查询。查询相当简单，但我不知道索引表以获得最佳性能的最佳方法。

该表称为“词典”。定义是：

```
_id integer primary key
word text
frequency integer
lset integer
rset integer 
```

查询是：

```
SELECT word,frequency FROM lexicon WHERE lset>? AND rset<? ORDER BY frequency DESC LIMIT ? 
```

我已经索引了所有单独的列，但我怀疑复合索引可能更好，但是什么组合呢？lset 和 rset 上的索引应该是升序还是降序？

编辑： lset 和 rset 是表示树结构的嵌套集合值。因此 lset 和 rset 的所有值都是相互唯一的，并且是完美分布的。此外，在任何给定的行中 lset < rset。

提前致谢...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T16:04:10.813

这将取决于您的数据统计。

您可以尝试在和的每个组合上创建索引`lset`以找到最佳情况，但您的表中*必须*有真实数据。 - ( , , ) - ( , , ) - ( , , ) - ( , , ) - ( , , ) - ( , , ) `rset``frequency` *`lset``rset``frequency`
`rset``lset``frequency`
`lset``frequency``rset`
`rset``frequency``lset`
`frequency``lset``rset`
`frequency``rset``lset`*

 *拥有 first 的好处`frequency`是它已经为你的`ORDER BY`and`LIMIT`子句做好了准备。

但是，如果您的词典中的每个单词碰巧有不同的频率，那么索引中的第二个和第三个字段将变得毫无价值。 *（一个为什么你的数据统计很重要的例子。）*

哪个字段将最快地限制您的记录也很重要。如果`lset < x`过滤器减少了`0.01%`原始大小的集合，则将该过滤器首先放在索引中。

但很可能，过滤`lset < X and rset > y`根本不可能很好地索引。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-22T16:03:37.770

如果 SQLite 在这方面的行为与其他 DBMS 相似，那么您将需要一个复合索引...

```
{lset, rset DESC, frequency DESC} 
```

...按照这个特定的顺序和这些特定的`DESC`条款。

查看[这篇文章](http://use-the-index-luke.com/sql/sorting-grouping/order-by-asc-desc-nulls-last)以获取有关升序/降序索引的更多信息。

* * *

是的，正如@DanielRenshaw 提到的，您可以`word`在索引的末尾包含，纯粹是为了允许[index-only scan](http://use-the-index-luke.com/sql/clustering/index-only-scan-covering-index)。这称为“覆盖”索引。

*（由于聚簇索引已经涵盖了所有字段，所以没有为这样的索引这样做的目的。）*

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-22T17:42:40.597

您的查询（名称略有变化）：

```
SELECT word,frequency 
FROM lexicon 
WHERE lset > @LeftSide 
  AND rset < @RightSide 
ORDER BY frequency DESC 
LIMIT @Num 
```

您正在使用嵌套集模型，因此可以将其重写为：

```
SELECT word,frequency 
FROM lexicon 
WHERE lset > @LeftSide          --- both `lset` here
  AND lset < @RightSide         --- and here
ORDER BY frequency DESC 
LIMIT @Num 
```

他们也可以是两者`rset`。只要您的数据不违反嵌套集模型，两者都将起作用并给出相同的结果。因此，您的查询可能需要 3 列上的覆盖索引：

```
(lset, frequency, word) 
```

它将使用索引来识别落入该`(@LeftSide,@RightSide)`范围的（可能数千）行，然后使用文件排序来查找频率最高的（@Num）单词。

在某些情况下，索引`(frequency DESC, lset, word)`可能会更好（它确实取决于参数值），所以如果您也有该索引，那就太好了。但我无法回答 SQLite 是否会在每个实例上达到最佳索引峰值。

根据落入该范围的行数，它的性能可能会好到不好。但我没有看到一种简单的方法来进一步优化这种查询。*

# c# - 显示 MessageBox.Show 时禁用父页面

> ID：10705650
> 
> 赞同：0
> 
> 时间：2012-05-22T15:56:52.283
> 
> 标签：c#, asp.net

我使用 MessageBox.Show 方法创建了一个警报。但是我想禁止编辑页面中仍然可以在消息框后面访问的控件。如果我在触发消息框之前尝试手动禁用每个控件，则只有在消息框中选择一个选项后才会禁用控件。

请帮忙 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T17:54:58.573

好的，我找到了一种方法来做我需要的事情。

您可以将“onclientclick”事件添加到要触发确认弹出窗口的按钮。

```
<asp:Button id="Button" runat="server" onclientclick="return confirm('Are you sure?');"
                      onClick="ServerSideMethod_Button_Click" /> 
```

如果回答 OK 则弹出服务器端方法将被执行，否则将被跳过。

谢谢大家的帮助。:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T16:22:09.577

这*是*您需要的客户端解决方案。鉴于您既要弹出消息*又要*禁用下面的 GUI/页面，我建议您查看模式对话框。[JQuery](http://jqueryui.com/demos/dialog/#modal)提供了事实上的行业标准框，但也有其他可用的。只需谷歌它。

# android - WebView 在 ICS (Android 4) 上从下一个屏幕导航回 Webview 时显示透明颜色

> ID：10705653
> 
> 赞同：1
> 
> 时间：2012-05-22T15:57:06.100
> 
> 标签：android, webview, android-webview, android-4.0-ice-cream-sandwich

在 Android 4 中，当从下一个屏幕导航回 Webview 时，CSS 会被忽略。这是第一次工作正常。

此行为仅适用于透明颜色。其他颜色效果很好。

```
WebView webView = new WebView(activity);
webView.getSettings().setJavaScriptEnabled(true);

webView.getSettings().setLayoutAlgorithm(LayoutAlgorithm.NORMAL) ;
/**
 * Default color of webview must be transparent
 */
webView.setBackgroundColor(Color.TRANSPARENT); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T17:00:26.077

有很多建议给你，因为我不是安卓人:) ....

**1.**希望这可以帮助你：

```
mWebView.setBackgroundColor(0x00000000); 
```

发现于：[Android WebView 样式背景颜色：在 android 2.2 上忽略透明](https://stackoverflow.com/questions/5003156/android-webview-style-background-colortransparent-ignored-on-android-2-2)

**2.**也尝试将 Alpha 属性设置为 1。

**3.**这必须解决你的问题。尝试设置`setBackgroundResource(int)`- 用作背景的可绘制对象。找到链接：http: [//developer.android.com/reference/android/webkit/WebView.html](http://developer.android.com/reference/android/webkit/WebView.html)

**4.** 最后，如果以上答案没有帮助，那么我认为下面的链接可以帮助你。但这可能是 Android 4 中的一个错误。

请参阅以下链接：[http ://www.iriphon.com/2011/04/27/the-android-transparent-webview-bug/](http://www.iriphon.com/2011/04/27/the-android-transparent-webview-bug/)

[http://code.google.com/p/android/issues/detail?id=19510](http://code.google.com/p/android/issues/detail?id=19510)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-25T06:10:44.020

经过多次尝试后发现这是设备问题！.. :(

# c++ - 验证基础对象是否属于特定派生类型

> ID：10705655
> 
> 赞同：0
> 
> 时间：2012-05-22T15:57:18.127
> 
> 标签：c++, rtti

我有一个 Visual Studio 2008 C++03 项目，我想在其中验证对象是否属于某种类型。

例如：

```
int main()
{
    struct A { virtual ~A() { }; };
    struct B : public A { };
    struct C : public A { };

    A* b = new B();
    A* c = new C();

    assert( typeof( b ) == typeof( B ) );
    assert( typeof( b ) != typeof( C ) );

    assert( typeof( c ) == typeof( C ) );
    assert( typeof( c ) != typeof( B ) );

    assert( typeof( b ) != typeof( c ) );
    return 0;
} 
```

有没有办法在 C++03 中做到这一点？如何？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T16:01:02.807

您可以使用`dynamic_cast`它来尝试将其转换为基本/派生类型。如果它不返回 NULL 那么它是一个基类或派生自该类型（取决于你是向上还是向下）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T16:01:06.120

您可以使用**[typeinfo](http://www.cplusplus.com/reference/std/typeinfo/type_info/)**来获取对象的类型。
或者您可以使用**[dynamic_cast](https://stackoverflow.com/questions/28002/regular-cast-vs-static-cast-vs-dynamic-cast)**检查指针是否指向适当类型的对象。

# c++ - 静态数组中的编译时搜索

> ID：10705662
> 
> 赞同：0
> 
> 时间：2012-05-22T15:57:44.230
> 
> 标签：c++, metaprogramming, template-meta-programming

在一个项目中，我有几个类，其中封装了作为静态数组实现的矩阵，例如：

```
struct StaticContainer
{
    static const short e[2][4];
};

/// Initialize components of member-array (with external linkage).
const short StaticContainer::e[2][4] = {
    { -1,  0, 0, 1 },
    {  0, -1, 1, 0 }
}; 
```

我想实现一个提供反向映射的元函数，从 StaticContainer::e 中的列返回到第二个索引（在本例中为 1-4）。理想情况下，是这样的：

```
template< typename TContainer, short TeX, short TeY >
struct VectorToIndex
{
    enum { value = ??? };
}; 
```

最后，我想通过（如果这可能的话）：

```
BOOST_STATIC_ASSERT( 0 == VectorToIndex< StaticContainer, -1, 0 >::value ); 
```

这可能吗？我最初尝试递归搜索'e'矩阵失败了，因为每当我尝试访问（在编译时）我得到的条目（GCC）：

```
error: ‘StaticContainer::e’ cannot appear in a constant-expression 
```

我应该明白矩阵中的值在编译时不可用吗？

我将不胜感激任何评论。我可以随意更改矩阵的初始化/存储方式（所以我在考虑一些编译时注册机制）。唯一的限制是在编译时获得这种反向映射。

**说明：**

*   e-matrix 中的每一列代表一个空间方向（在本例中为 2D）。保证列是不同的。

*   我希望元函数得到以下结果：

    ```
    VectorToIndex< StaticContainer, -1, 0 > --> '0' at compile-time
    VectorToIndex< StaticContainer,  0,-1 > --> '1' at compile-time
    VectorToIndex< StaticContainer,  0, 1 > --> '2' at compile-time
    VectorToIndex< StaticContainer,  1, 0 > --> '3' at compile-time 
    ```

如果这个模板是用无效的数字组合（即不是矩阵中的列）实例化的，我想产生一个编译错误。

*   我目前拥有的解决方案是一个简单的程序，它手动编写具有必要模板实例的文件。这满足了要求（结果是正确的，并且对于无效向量存在编译时错误 - 因为缺少相应的模板实例化）。但是，由于我的代码库中有许多类似于“StaticContainer”的类（其中许多具有较大的矩阵），因此此过程会生成数千行代码:(。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T16:25:32.677

您的声明不匹配：

*   `typename TContainer`表示模板参数是一个类型
*   `StaticContainer::e`是一个值

它无法匹配。

我可以想到一些潜在的解决方案，但第一个问题显然是：为什么不手动构建反向矩阵并使用`assert`它来证明其正确性？它当然更简单，简单就是美丽。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T00:29:21.017

正如所承诺的，这里有一个解决方案。我没有使用可变参数模板重新发明整个元编程库，而是利用这个机会尝试了 boost mpl，结果证明它很有表现力。使用它，VectorToIndex 将如下所示：

```
template<typename basis, typename axis>
struct VectorToIndex : 
    boost::mpl::if_<
        boost::mpl::greater<boost::mpl::size<basis>, typename boost::mpl::find<basis, axis>::type::pos>,
        typename boost::mpl::find<basis, axis>::type::pos,
        boost::mpl::empty_base
    >::type
{
}; 
```

如果“轴”存在于“基础”中，则`VectorToIndex<basis, axis>::value`等于其在范围 [0，基础大小）中的索引。如果不是这样，`VectorToIndex<basis, axis>::value`则未定义，因此访问它可能会用于产生编译时错误或通过 SFINAE 进行选择性实例化。

要表示轴，应该使用 boost::mpl::vector，如下所示：

```
typedef boost::mpl::vector<boost::mpl::int_<1>, boost::mpl::int_<0>, boost::mpl::int_<0> > e1;
typedef boost::mpl::vector<boost::mpl::int_<0>, boost::mpl::int_<1>, boost::mpl::int_<0> > e2;
typedef boost::mpl::vector<boost::mpl::int_<0>, boost::mpl::int_<0>, boost::mpl::int_<1> > e3; 
```

考虑到上述定义，有

```
VectorToIndex<boost::mpl::vector<e1, e2, e3>, e1>::value -> 0
VectorToIndex<boost::mpl::vector<e1, e2, e3>, e2>::value -> 1
VectorToIndex<boost::mpl::vector<e1, e2, e3>, e3>::value -> 2
VectorToIndex<boost::mpl::vector<e1, e2>, e3>::value -> COMPILE-TIME ERROR 
```

# c# - 是否有类似于 XmlWriter.WriteRaw 方法的 XmlReader 方法？

> ID：10705663
> 
> 赞同：1
> 
> 时间：2012-05-22T15:57:47.363
> 
> 标签：c#, xml

XmlWriter.WriteRaw 将保留 ' 并且不发送实际的撇号。有没有办法读入‘’ 并保持原样？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T16:13:07.277

您需要对其进行正确编码。让我们以下面的 XML 为例：

```
<root>&apos;</root> 
```

`<root>`节点的值与`'`您使用哪个 XML 解析器来读取此 XML 无关。

另一方面，如果您有以下 XML：

```
<root>&amp;apos;</root> 
```

`<root>`节点的值为`&apos;`。

因此，在这两种情况下，我们都对 XML 进行了正确编码，因此当符合标准的解析器读取它时，它能够正确检索该值。

`WriteRaw`所以在生成 XML时使用该方法时要非常小心。由于它正确地对参数进行了编码，因此您现在有责任确保将正确的数据传递给它。

# c# - 需要在 C# 应用程序中使用 C++ 代码的“块”

> ID：10705667
> 
> 赞同：2
> 
> 时间：2012-05-22T15:58:02.883
> 
> 标签：c#, c++, visual-studio-2010, interop

我得到了一段 c++ 代码，它看起来像是来自一个 c++ 应用程序，它利用共享内存向其他程序发送消息。

c++ 代码还没有#include 或任何东西。我获得了在我的 C# 应用程序中使用的代码，但我被卡住了。我有点理解代码的作用，但我不太了解将它翻译成 C#，因为我对编码很陌生。

我的问题是，能够在我的项目中使用代码功能的最简单方法是什么？最终结果是将消息发送到另一个程序，这反过来会做一些我不担心的事情。

我曾尝试在我的解决方案中创建不同的 c++ 项目和文件类型，以便稍后使用参考链接它们，但我永远无法正确编译它。

如果您有什么建议或有什么好去处，请告诉我。我总是可以提供更多信息。

代码（我*不得不*删除评论，对不起）：

```
UINT WM_HELO_ZOOM_XYZ = RegisterWindowMessage("WM_HELO_ZOOM_XYZ");

int HELO_Broadcast_Zoom_Message(
  double dbX,
  double dbY,
  double dbZ,
  UINT uMessage=WM_HELO_ZOOM_XYZ) {

  #ifndef HELO_ 
    typedef struct { 
      UINT uMajVersion; 
      UINT uMinVersion; 
      DWORD dwReserved;
      double dbX;  
      double dbY;
      double dbZ;
    } HELOCoordsStruct;
  #endif

  char *szSharedMemory = "HELO-_Coords"; 
  char szErr[_MAX_PATH*3];
  HANDLE hMem = OpenFileMapping(FILE_MAP_WRITE, FALSE, szSharedMemory); 
  if (NULL == hMem) {
    return(0);
  }

  void *pvHead = MapViewOfFile(hMem, FILE_MAP_WRITE, 0,0,0);
  if (NULL == pvHead)  {
    CloseHandle(hMem);
    sprintf(szErr, "Unable to view", szSharedMemory);
    AfxMessageBox(szErr, MB_OK|MB_ICONSTOP);
    return(0);
  }

  HELOCoordsStruct *pHELOCoords = (HELOCoordsStruct *)pvHead;

  BOOL bVersionOk=FALSE; 

  if (1 == pHELOCoords->uMajorVersion) {

    if (WM_HELO_ZOOM_XYZ==uMessage) { 
      pHELOCoords->dbX = dbX;
      pHELOCoords->dbY = dbY;
      pHELOCoords->dbZ = dbZ;
    }
    bVersionOk=TRUE;
  }
  else {

    sprintf(szErr, "Unrecognized HELO- shared memory version: %d.%d", pHELOCoords->uMajVersion, pHELOCoords->uMinVersion);
    AfxMessageBox(szErr, MB_OK);
  }

  if (NULL != hMem) CloseHandle(hMem);
  UnmapViewOfFile(pvHead);

  if (bVersionOk) {
    PostMessage(HWND_BROADCAST,uMessage,0,0); 
    return(1); 
  }
  else return(0);
} 
```

编辑：反馈完全不真实。我必须说社区肯定会宠坏这里的人。

谢谢，凯文

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-22T16:22:46.683

我认为你有三个选择：

1.  创建一个类库类型的托管 C++ 项目，将代码放入其中，从您的主应用程序中引用该项目。
2.  创建一个非托管 C++ DLL 项目，将代码放入一个（或多个函数）中，导出函数（使用 .def 文件），然后构建项目。使用该 dll 中的函数使用`[DllImport]`属性。（见[这里](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.dllimportattribute.aspx)和[这里](http://msdn.microsoft.com/en-us/library/aa288468%28v=vs.71%29.aspx)）
3.  将代码转换为 C#。这将需要一些非托管代码、Win32 和 P/Invoke 的知识（参见[此处](http://msdn.microsoft.com/en-us/library/aa446536.aspx)和[此处](http://msdn.microsoft.com/en-us/magazine/cc164123.aspx)）。当我看到你的代码时，这需要一点时间！

这是您转换后的代码（选项 3）：

```
using System;
using System.Runtime.InteropServices;
using System.Windows.Forms;

namespace UnmanagedBlock
{
    public class ConvertedClass
    {
        public uint WM_HELO_ZOOM_XYZ = RegisterWindowMessageA("WM_HELO_ZOOM_XYZ"); // Your code uses the ANSI string

        int HELO_Broadcast_Zoom_Message(
            double dbX, double dbY, double dbZ, uint uMessage) // Porting the default value for 'uMessage' is not possible
        {
            string szSharedMemory = "HELO-_Coords";
            IntPtr hMem = OpenFileMapping(FileMapAccessRights.Write, FALSE, szSharedMemory);
            if (IntPtr.Zero == hMem)
                return 0;
            IntPtr pvHead = MapViewOfFile(hMem, FileMapAccessRights.Write, 0, 0, UIntPtr.Zero);
            if (IntPtr.Zero == pvHead)
            {
                CloseHandle(hMem);
                MessageBox.Show(
                    "Unable to view " + szSharedMemory, // Your code does not concat these two strings.
                    "Error", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                return 0;
            }

            HELOCoordsStruct pHELOCoords = new HELOCoordsStruct();
            Marshal.PtrToStructure(pvHead, pHELOCoords);

            int bVersionOk = FALSE;

            if (1 == pHELOCoords.uMajVersion) // I think it had a typo (it was uMajorVersion)
            {
                if (WM_HELO_ZOOM_XYZ == uMessage)
                {
                    pHELOCoords.dbX = dbX;
                    pHELOCoords.dbY = dbY;
                    pHELOCoords.dbZ = dbZ;
                }
                Marshal.StructureToPtr(pHELOCoords, pvHead, false);
                bVersionOk = TRUE;
            }
            else
            {
                MessageBox.Show(
                    "Unrecognized HELO- shared memory version: " +
                    pHELOCoords.uMajVersion.ToString() + "." + pHELOCoords.uMinVersion.ToString());
            }

            if (IntPtr.Zero != hMem)
                CloseHandle(hMem);
            UnmapViewOfFile(pvHead);

            if (bVersionOk == TRUE)
            {
                PostMessage(HWND_BROADCAST, uMessage, 0, 0);
                return 1;
            }
            else
                return 0;
        }

        [StructLayout(LayoutKind.Sequential)]
        private class HELOCoordsStruct
        {
            public uint uMajVersion;
            public uint uMinVersion;
            public uint dwReserved;
            public double dbX;
            public double dbY;
            public double dbZ;
        }

        [DllImport("user32", CallingConvention = CallingConvention.StdCall, CharSet = CharSet.Unicode)]
        public static extern uint RegisterWindowMessageW([In]string lpString);

        [DllImport("user32", CallingConvention = CallingConvention.StdCall, CharSet = CharSet.Ansi)]
        public static extern uint RegisterWindowMessageA([In]string lpString);

        [DllImport("kernel32", CallingConvention = CallingConvention.StdCall, CharSet = CharSet.Auto)]
        public static extern IntPtr OpenFileMapping(FileMapAccessRights dwDesiredAccess, int bInheritHandle, [In]String lpName);

        [DllImport("kernel32", CallingConvention = CallingConvention.StdCall, CharSet = CharSet.Auto)]
        public static extern IntPtr MapViewOfFile(IntPtr hFileMappingObject, FileMapAccessRights dwDesiredAccess, uint dwFileOffsetHigh, uint dwFileOffsetLow, UIntPtr dwNumberOfBytesToMap);

        [DllImport("kernel32", CallingConvention = CallingConvention.StdCall)]
        public static extern int UnmapViewOfFile(IntPtr lpBaseAddress);

        [DllImport("kernel32", CallingConvention = CallingConvention.StdCall)]
        public static extern int CloseHandle(IntPtr hObject);

        [DllImport("user32.dll")]
        public static extern IntPtr PostMessage(IntPtr hWnd, uint msg, int wParam, int lParam);

        public const int FALSE = 0, TRUE = 1;

        public enum FileMapAccessRights : uint
        {
            Write = 0x2,
            Read = 0x4,
            Execute = 0x20,
        }

        public const IntPtr HWND_BROADCAST = (IntPtr)0xffff;
    }
} 
```

我已经进行了精确的转换，我认为它应该可以正常工作，但是我还没有测试过。

让我知道它是否有效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T16:05:47.547

您可以将 C++ 代码转储到 Visual C++ 项目中并构建它。构建时，进入项目设置并选择生成 tlb 文件的选项（它是 c++/.net 互操作的代理类，我不记得选项的名称）。

完成此操作后，您可以从 C# 项目添加对 tlb 互操作程序集的引用。

此外，请在此处查找 Microsoft 示例[http://msdn.microsoft.com/en-us/library/fx82zhxa.aspx](http://msdn.microsoft.com/en-us/library/fx82zhxa.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-22T16:22:08.277

很有可能，如果您在此处发布代码，一些好心人会为您将代码从 C++ 移植到 C#。但是，为了将来在处理在 .NET 应用程序中使用本机 C++ 代码时参考，您可以使用 .NET 框架的 InteropServices 来引用本机 dll 中的本机函数。

为此，需要在 C++ 和 C# 方面执行一些步骤。首先，您需要将入口点构建为 C++ 中的导出函数。

例如，假设我想编写一个简单的 C++ 函数来将 2 个数字相加，然后从 C# 应用程序中调用它，我必须执行以下操作：

第 1 步：编写 C++ 函数。为了让外部资源找到您的函数，您需要让编译器知道该函数将被“导出”。需要注意的一点是，如果您从导出的函数中调用*其他*函数，则不需要将它们全部标记为已导出。

所以让我们用 C++ 编写“add”函数：

```
#define DLLEXPORT extern "C" declspec(dllexport) 

DLLEXPORT int __cdecl add(int x, int y)
{
    return (x + y);
} 
```

第一行定义了一个宏，我们将使用它来标记导出的方法。该`extern "C"`部分告诉编译器避免破坏函数的导出名称（因此它总是'add'，而不是@YZadd_之类的东西），接下来是标记为DLLEXPORT的函数定义。在我继续之前，还有一点关于导出函数中的“名称修改”，即声明的函数`__stdcall`或其任何变体（WINAPI..etc）。标记为导出并`extern "C"`使用调用约定 __stdcall 声明的函数将始终附加`@X`where`X`是函数参数的字节数（因此对于上面的示例，如果`add`已声明`__stdcall`，则导出的函数名称将是`add@8`. 如果 C# 在定位您的函数时遇到问题，请记住这一点。

现在，C++ 方面已经完成，将其编译为 DLL 并转移到 C#。

在 C# 中，导入外部函数相当简单。首先，您需要引用`InteropServices`命名空间：

`using System.Runtime.InteropServices;`

然后你需要做一个`[DllImport]`声明：

```
[DllImport(@"path to your C++ dll here")]
public static extern int add(int x, int y) //make sure the function definition matches. 
```

如果函数名称匹配，这应该是导入函数所需的全部内容。现在您可以`add`像调用 C# 中的任何普通函数一样调用

```
int x = 5;
int y = 10;
int z = add(x, y); //z should be 10 
```

关于如何简单地导出 C++ 函数并从 C# 应用程序调用它们的总结。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-22T16:07:25.453

如果您无法让 C++ 代码按原样工作，那么尝试将其移植到您的 C# 应用程序中是没有意义的。

首先找出 C++ 代码（阅读 MSDN 文档以了解所使用的 API，询问提供代码的人，发布具体问题）。一旦您更好地理解它并使其工作，那么您将有更好的机会找出在 C# 中执行所需操作的最佳方法。

# python - 我的 defaultdict(list) 不会出现在模板上，但在我看来

> ID：10705669
> 
> 赞同：3
> 
> 时间：2012-05-22T15:58:12.970
> 
> 标签：python, django, django-templates, django-views

> **可能重复：**
> [Django 模板不能循环 defaultdict](https://stackoverflow.com/questions/4764110/django-template-cant-loop-defaultdict)

我想知道为什么我`defaultdict(list)`会在我的views.py 中测试它时显示，但是当我在我的模板上显示数据时，我什么也得不到，甚至没有错误。

有什么建议么？

这是我的views.py-confirm_list 是我的defaultdict(list)

```
def confirmations_report(request, *args, **kwargs):
from investments.models import Investment, InvestmentManager
from reports.forms import ConfirmationsForm
from collections import defaultdict
import ho.pisa as pisa
import cStringIO as StringIO
import os.path
confirm_list = defaultdict(list)
context = {}

if request.POST:
    form = ConfirmationsForm(request.POST)
    if form.is_valid():
        start_date = form.cleaned_data['start_date']
        end_date = form.cleaned_data['end_date']
        investments = Investment.objects.all().filter(contract_no = "",maturity_date__range=(start_date, end_date)).order_by('financial_institution')
        for i in investments:
            confirm_list[i.financial_institution.pk].append({
                'fi':i.financial_institution,
                'fi_address1': i.financial_institution.address1,
                'fi_address2': i.financial_institution.address2,
                'fi_city': i.financial_institution.city,
                'fi_prov': i.financial_institution.state_prov,
                'fi_country': i.financial_institution.country,
                'fi_postal': i.financial_institution.postal,
                'primary_owner': i.plan.get_primary_owner().member,
                'sin': i.plan.get_primary_owner().member.client.sin,
                'type': i.product.code,
                'purchase_amount': i.amount,
                'purchase_date': i.start_date,
            })
            context['investments'] = investments
        context['confirmlist'] = confirm_list
        for key, value in confirm_list.items():
            print key, value
        context['inv'] = investments
    if request.POST.has_key('print_report_submit'):
        context['show_report'] = True
        context['mb_logo'] = os.path.join(os.path.dirname(__file__), "../../../media/images/mb_logo.jpg")
        html = render_to_string('reports/admin/confirm_report_print.html', RequestContext(request,context))
        result = StringIO.StringIO()
        pdf = pisa.pisaDocument(StringIO.StringIO(html.encode("ISO-8859-1")), result)
        response = HttpResponse(result.getvalue(), mimetype='application/pdf')
        response['Content-Disposition'] = 'attachment; filename=unreceived-confirmations.pdf'
        return response

else:
    form = ConfirmationsForm()

context['form'] = form
return render_to_response('reports/admin/confirm_report.html', RequestContext(request, context)) 
```

但是当我这样做时：

```
for key, value in confirm_list.items():
            print key, value 
```

在我的模板上像这样：

```
{% extends 'reports/admin/base.html' %}
{% load humanize %}

{% block report_html %}
<h3>Unreceived Confirmations Report</h3>
<form method="post" action="">
<table>
    <tr>
        <td>
            <strong> {{ form.start_date.label }}</strong> {{ form.start_date }}
            <strong>{{ form.end_date.label }}</strong> {{ form.end_date }}
        </td>
    </tr>
</table>
<input type="submit" value="View Report">
    <input type="submit" name="print_report_submit" value="Print Report"/>
</form>
    {% for key, value in confirmlist.items %}
        {{ key }} - {{ value }}
    {% endfor %}
{% endblock %} 
```

我什么都得不到。

这是我在views.py中测试时得到的输出示例

```
33 [{'fi_address1': u'Scotiabank FAS', 'fi_country': u'Canada', 'fi_address2': u'20 Queen Street West, Suite 2600', 'fi_city': u'TORONTO', 'fi': <FinancialInstitution: NATIONAL TRUST>, 'fi_prov': u'Ontario', 'fi_postal': u'### ###', 'purchase_amount': Decimal('30000.00'), 'purchase_date': datetime.date(2011, 6, 27), 'type': u'GIC', 'sin': u'###/###/###', 'primary_owner': <Member: #, #>}] 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-22T16:07:09.033

这是因为 Django 模板语言执行[变量查找](https://docs.djangoproject.com/en/1.6/topics/templates/#variables)的方式。当您尝试遍历字典项目时，

```
{% for key, value in confirmlist.items %} 
```

Django 首先对`confirmlist['items']`. 因为这是 a `defaultdict`，所以返回一个空列表。

这是一个残酷的陷阱，我也被刺痛了！

要解决此问题，请在将 defaultdict 添加到模板上下文之前将其转换为字典。

```
context['confirmlist'] = dict(confirm_list) 
```

或者，正如 sebastien trottier 在他[对类似问题的回答中](https://stackoverflow.com/a/12842716/113962)所解释的那样，在添加到模板上下文之前设置 `default_factory`为。`None`

```
confirm_list.default_factory = None
context['confirmlist'] = confirm_list 
```

# c# - 在可视化 C# 中扩展标签？

> ID：10705672
> 
> 赞同：1
> 
> 时间：2012-05-22T15:58:20.833
> 
> 标签：c#, visual-c#-express-2010

我的应用程序将扩展到全屏。

但是即使我锚定了标签，标签也不会变大，而是停留在屏幕的左上角？

这是为什么？

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-22T16:00:23.263

你的锚不正确。如果您在左侧和右侧都锚定，您的标签将拉伸。此外，您的标签应将`AutoSize`属性设置为`false`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-22T16:00:27.443

将`AutoSize`属性设置为 false。还要确保在**两侧**设置锚点（`Left`和`Right`或`Top`和`Bottom`）。您可能还需要设置`TextAlign`属性（因为没有该属性，您的文本将不会移动，并且您可能不会注意到调整大小）。

# knockout.js - 如果我有额外的 li，KnockoutJS 只会显示我的模板

> ID：10705679
> 
> 赞同：0
> 
> 时间：2012-05-22T15:58:48.087
> 
> 标签：knockout.js

所以我有一个模板，用于对一些可能有子元素的对象进行递归。我已经让 if 语句按照我想要的方式工作（我认为）。但是，只有在 if 语句之前有一个额外的 li 时，我的子元素才会出现。

这是我的模板

```
<script type="text/html" id="journalTemplate">
<li data-bind="text: Description">
    <div>
    <li data-bind = "visible: IsGroup"></li>
    <!-- ko if: IsGroup -->
    <ol data-bind="template: {name: 'journalTemplate', foreach: ChildEntities}">
    </ol>
    <!-- /ko -->
    </div>
</li> 
```

我正在使用数组映射，因此没有要显示的真实视图模型，但 C# 对象非常简单：它有一个描述、一个布尔 IsGroup 和一个 ChildEntities 列表（如果 IsGroup 为假，则为 null，作为侧面笔记）。如果我没有空的 li，if 语句的注释块甚至不会出现。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T18:37:26.397

好的，我看到了问题。问题是您的 LI 上的文本绑定。

html 中的文本由 textNode dom 元素表示，尽管它们不能在 html 标记中显式编写，但它们的行为方式相同。实际上，您的文本绑定正在用它拥有的任何文本替换 LI 的 innerHtml。

我不太清楚的是为什么你额外的无效 LI 元素会停止对 innerHtml 的完全替换......

无论如何，正确的解决方案是像这样构建您的模板。

```
<script type="text/html" id="journalTemplate">
    <li>
        <span data-bind="text: Description"></span>
        <!-- ko if: IsGroup -->
        <ol data-bind="template: {name: 'journalTemplate', 
                  foreach: ChildEntities}">
        </ol>
        <!-- /ko -->
    </li>
</script> 
```

[http://jsfiddle.net/madcapnmckay/F2vSW/1/](http://jsfiddle.net/madcapnmckay/F2vSW/1/)

希望这可以帮助。

# python - 如何重新启动 BaseHTTPServer 实例？

> ID：10705680
> 
> 赞同：2
> 
> 时间：2012-05-22T15:58:53.010
> 
> 标签：python

这就是我所拥有的：

http.py：

```
class HTTPServer():

    def __init__(self, port):
        self.port = port
        self.thread = None
        self.run = True
    def serve(self):
        self.thread = threading.Thread(target=self._serve)
        self.thread.start()
    def _serve(self):
        serverAddress = ("", self.port)
        self.server = MyBaseHTTPServer(serverAddress,MyRequestHandler)
        logging.log(logging.INFO, "HTTP server started on port %s"%self.port)
        while self.run:
            self.server.handle_request()
    def stop(self):
        self.run = False
        self.server.server_close() 
```

然后在另一个文件中，重新启动它：

```
def restartHTTP(self):
    try:
        self.httpserver.stop()
        reload(http)
        self.httpserver = http.HTTPServer(80)
        self.httpserver.serve()
    except:
        traceback.print_exc() 
```

这给了我一个地址已经在使用中的错误，所以 HTTP 服务器似乎没有正确停止。我还需要做什么来阻止它？

编辑：

我在哪里调用restartHTTP：

```
def commandHTTPReload(self, parts, byuser, overriderank):
    self.client.factory.restartHTTP()
    self.client.sendServerMessage("HTTP server reloaded.") 
```

我确实知道该命令正在执行，因为我收到了它应该发送的消息。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T16:59:55.947

您只需要让操作系统知道您确实想在关闭端口后立即重用它。通常它会保持关闭状态一段时间，以防出现任何额外的数据包。您可以使用 SO_REUSEADDR 执行此操作：

```
mysocket.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1) 
```

..打开mysocket后。使用 HTTPServer 执行此操作的一个好地方可能是在一个覆盖的`server_bind`方法中：

```
def server_bind(self):
    HTTPServer.server_bind(self)
    self.socket.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1) 
```

编辑：仔细查看您的代码后，我发现您的线程模型也可能在这里引起问题。您正在关闭主（？）线程中的套接字，而另一个线程正在等待同一个套接字（in `accept()`）上的连接。这种安排没有明确定义的语义，我相信它在不同的操作系统上做不同的事情。在任何情况下，您都应该避免这种情况，以尽量减少混淆（在多线程程序中已经有很多这样的情况了）。您的旧线程实际上不会消失，直到它获得连接并处理其请求（因为它`self.run`直到那时才会重新检查），因此在此之后端口可能无法重新绑定。

没有一个简单的解决方案。您可以在线程之间添加一个通信管道，然后在服务器线程中使用`select()`/`poll()`来等待其中任何一个的活动，或者您可以`accept()`在短时间内使调用超时，以便`self.run`更频繁地检查。或者你可以让主线程连接到监听套接字本身。但是无论你做什么，你可能已经接近了你应该考虑使用“真正的”httpd 或网络框架而不是自己滚动的复杂程度：apache、lighttpd、Tornado、Twisted 等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-02-13T15:51:48.370

为了优雅地停止 HTTPServer 并关闭套接字，应该使用：

```
# Start server
httpd = HTTPServer(...)
httpd.serve_forever()
# Stop server
httpd.shutdown()
httpd.server_close() 
```

# vb.net - 在浏览器中显示 PDF 文件的最佳做法？

> ID：10705683
> 
> 赞同：1
> 
> 时间：2012-05-22T15:58:55.213
> 
> 标签：vb.net

我目前正在开发一个 Web 应用程序，该应用程序从 Web 服务接收编码文本，并正在解码并保存为 PDF 文件。一旦用户点击查看详细信息，我就应该在网络浏览器中显示 PDF 文件。

在浏览器中显示 PDF 文件的最佳做法是什么？我正在使用 VB.Net 2003

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T19:12:40.863

您需要做的就是将链接设置为指向您的 pdf 文件。如果用户安装了任何 PDF 阅读器，它将使用该阅读器打开。

```
<a href="yourPdfFile.pdf">The name you Want to Show as Link</a> 
```

**编辑：** 另一种方法，如果您不想显示为链接并直接打开文件，请在标题中设置正确的 MIME 类型，以便浏览器可以将其检测为 PDF 文件而不是 HTML 文件。

```
Response.AddHeader("content-disposition","inline;filename=YourPdfFileName.pdf")
Response.End 
```

# cucumber - Cucumber：是否有可能通过一个步骤来检测标签？

> ID：10705686
> 
> 赞同：1
> 
> 时间：2012-05-22T15:59:03.447
> 
> 标签：cucumber

我正在为密码管理页面编写测试套件。对于这些场景，大多数人实际上不应该更改密码，但有些人会这样做。我使用了该标签`@changePassword`，以便我可以选择是否运行这些场景。

我遇到的问题是尽可能不编写重复的步骤。

简化示例场景：

```
@changePassword
Scenario: successful change
  Given the Manage Password page is loaded
  And a new password is generated
  When the old password is entered
  And the new password is entered
  And the confirm password is entered
  And the OK button is clicked
  Then the password has changed

Scenario: failed change (missing confirm)
  Given the Manage Password page is loaded
  And a new password is generated
  When the old password is entered
  And the new password is entered
  And the OK button is clicked
  Then the password change fails 
```

两个版本之间的大部分步骤是相同的​​，我关心的主要差异是`And a new password is generated`步骤。在第一种情况下，我希望将新密码保存为用户密码。在第二种情况下，我希望最后丢弃新密码。

类似的东西：（伪代码）

```
And /^a new password is generated$/ do
  old password = user's password
  new password = generate random new password
  confirm password = new password
  if tag @changePassword is present
    user's password is set as the new password
  end
end 
```

有没有办法让这成为可能？我可以写第二步之类的`And a new password to be saved is generated`东西，但为了可读性和非技术精通的同事，使用相同的步骤是更好的选择。（我过去发现使用不同的短语来描述类似的过程，这对用户完成完全相同的事情，这会造成混乱。如果可能的话，尽量避免工作场所的混乱。）

旁注：将 Cucumber 与 Ruby（与 Watir）一起使用，如果这有什么不同的话（是吗？）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T16:08:16.063

这是一个丑陋的解决方案，但是您可以使用标记的钩子来设置变量，然后在方法中根据该变量的值保存/不保存的 if 语句吗？

# c# - Toolkitscriptmanager 中的 EnableCDN 不下载压缩文件

> ID：10705688
> 
> 赞同：4
> 
> 时间：2012-05-22T15:59:08.627
> 
> 标签：c#, asp.net, c#-4.0, ajaxcontroltoolkit, asp.net-4.0

我的母版页中有这个 ToolkitScriptManager：

```
<asp:ToolkitScriptManager runat="server" EnableScriptGlobalization="false" ID="scrptManager" 
    LoadScriptsBeforeUI="false" ScriptMode="Release" EnableCdn="true">

    </asp:ToolkitScriptManager> 
```

注意`ScriptMode="Release"`我`compilation debug="false"`的 web.config

但是，当脚本下载到客户端时，我会得到未缩小的 javascript。ToolkitScriptManager 从以下位置下载脚本：

[http://ajax.aspnetcdn.com/ajax/4.0/1/WebUIValidation.js](http://ajax.aspnetcdn.com/ajax/4.0/1/WebUIValidation.js)

[http://ajax.aspnetcdn.com/ajax/4.0/1/WebForms.js](http://ajax.aspnetcdn.com/ajax/4.0/1/WebForms.js)

如何修改我的 ToolkitScriptManager 以下载这些脚本的缩小版本？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-24T18:05:22.367

这只是一个理论。通过检查以下内容：

[http://ajax.aspnetcdn.com/ajax/4.0/1/WebForms.js](http://ajax.aspnetcdn.com/ajax/4.0/1/WebForms.js) vs

[http://ajax.aspnetcdn.com/ajax/4.0/1/MicrosoftAjax.js](http://ajax.aspnetcdn.com/ajax/4.0/1/MicrosoftAjax.js)

我注意到它被缩小了 MicrosoftAjax.js 文件，但是 WebForms.js 文件没有。我认为您对 ToolkitScriptManager 的设置是正确的，并且 cdn 内容存在一些问题。这只是一个猜测，可以肯定的是，也许你可以在 asp.net 论坛上提问：[http ://forums.asp.net/](http://forums.asp.net/)

希望这可以帮助。

# java - 使用 hibernate 和 jersey JSP 可视项实现 session-per-request + 延迟获取

> ID：10705697
> 
> 赞同：1
> 
> 时间：2012-05-22T15:59:38.053
> 
> 标签：java, hibernate, jsp, jersey, lazy-loading

假设在应用程序中，您有一个名为 User 的实体。每个用户可以拥有许多使用延迟获取加载的文章。

```
@Entity
@Table(name = "Users")
public class User {
  private Integer id;
  private Set<Article> articles = new HashSet<Article>();

  ...

  @OneToMany(fetch = FetchType.LAZY, mappedBy = "user", cascade = CascadeType.ALL)
  public Set<Article> getArticles() {...}
} 
```

在 Web 服务端，我想通过 Id 加载用户并将其传递给球衣 Viewable JSP 以返回和显示。我还想为每个请求使用一个会话。

```
@GET
public Response getUser() {
  Session session = getSessionFactory().openSession();
  session.beginTransaction();

  User user = (User) session.getNamedQuery("getUserById").setInteger("id", 1).uniqueResult();
  Map<String, Object> dataMap = new HashMap<String, Object>();
  dataMap.put("user", user);
  Viewable v = new Viewable("/user", dataMap);
  Response r = Response.ok(v).build();

  session.getTransaction().commit();
  session.close();
  return r;
} 
```

在 user.jsp 中，我想访问文章并将它们打印出来。

```
<c:forEach var="a" items="${it.user.articles}">
  <span>${a.title}</span>
</c:forEach> 
```

运行此代码并尝试请求 JSP 最终会引发异常：

```
org.hibernate.LazyInitializationException: failed to lazily initialize a collection of role: my.package.User.articles, no session or session was closed 
```

发生这种情况是因为显然创建 Viewable、将其传递给 ResponseBuilder 并调用 build() 实际上并没有创建 JSP。在我的方法返回并且会话已关闭之后，JSP 将在更远的地方创建。

一个明显的选择是将文章的获取类型设置为 eager，但这并不理想，因为在大多数情况下，当我使用 User 对象时，我不需要加载或显示文章。

有没有办法在我的方法返回之前强制 jersey 解释和构造 jsp？是否有某种 onResponse 或 postResponse 侦听器可以传递我的代码来关闭会话？

一般来说，我在处理打开/关闭休眠会话的方式上应该做些什么不同的事情？从谷歌搜索来看，每个请求一个会话似乎是大多数人提倡使用的，所以我想我会尝试一下。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T16:04:01.860

听起来您感兴趣的是[Open Session In View 模式](http://blog.smartkey.co.uk/2010/03/open-session-in-view-pattern-spring-jpa/)，尽管有些人[认为它是一种反模式。](https://stackoverflow.com/questions/1103363/why-is-hibernate-open-session-in-view-considered-a-bad-practice)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T16:08:59.580

“视图中的[开放会话”](https://community.jboss.org/wiki/OpenSessionInView)方法确实是解决这个问题的方法。

另一种方法是使用 EJB 或 Spring。然后他们将接管事务处理。当与 JPA 一起使用时，EJB 完全透明地完成了它，`EntityManager`而 Spring`org.springframework.orm.jpa.support.OpenEntityManagerInViewFilter`为此提供了过滤器。

如果您的容器支持 EJB，那么只需创建一个`@Stateless`：

```
@Stateless
public class UserService {

    @PersistenceContext
    private EntityManager em;

    public User find(Integer id) {
        return em.createNamedQuery("getUserById", User.class)
            .setParameter("id", id)
            .getSingleResult();
    }

} 
```

并在您的网络服务中使用它，如下所示：

```
@EJB
private UserService userService;

@GET
public Response getUser() {
    User user = userService.find(1);

    Map<String, Object> dataMap = new HashMap<String, Object>();
    dataMap.put("user", user);
    Viewable v = new Viewable("/user", dataMap);
    Response r = Response.ok(v).build();
    return r;
} 
```

不再需要担心事务和延迟获取。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-22T17:55:53.873

您说“在大多数情况下，当我使用用户对象时，我不需要加载或显示文章”，但在这种情况下，您显然确实需要这些数据。这是一个很好的例子，说明如何在每个用例中更好地处理获取策略，而不是在映射中静态处理。

例如，在这里，您的`getUserById`命名查询可能类似于：

```
select u from User u where u.id = :id 
```

相反，使用以下查询（创建一个新的命名查询`getUserByIdWithArticles`：

```
select u from User u join fetch u.articles where u.id = :id 
```

每个用例需要多少数据几乎总是会因用例而异。获得恰到好处的数据量始终是提高性能的最佳途径。

# android - 通过 webview 进行 Android 身份验证

> ID：10705699
> 
> 赞同：0
> 
> 时间：2012-05-22T15:59:46.480
> 
> 标签：android, authentication, android-webview

对此我很抱歉，因为我在这个 Android 开发方面非常绿色，我可能会在这里打败一匹死马——我们使用的软件 tjat 有一个移动版本，但它是一个移动网站，我正在尝试将它构建成一个独立的使用 webview 的 web 应用程序。

该应用程序将使我进入登录屏幕，但是当我尝试登录时弹出显示其登录的弹出窗口，并且在我的 web 视图中，它一直停留在那里。它不会超过这一点。在默认浏览器中它工作正常。

您能否以最简单的方式帮助我完成我需要做的事情？;-） 谢谢！

```
package com.giantflyingsaucer;

import android.app.Activity;
import android.os.Bundle;
import android.view.Window;
import android.webkit.WebChromeClient;
import android.webkit.WebView;
import android.webkit.WebViewClient;

public class WebPageLoader extends Activity
{
final Activity activity = this;

@Override
public void onCreate(Bundle savedInstanceState)
{
    super.onCreate(savedInstanceState);
    this.getWindow().requestFeature(Window.FEATURE_PROGRESS);
    setContentView(R.layout.main);
    WebView webView = (WebView) findViewById(R.id.webview);
    webView.getSettings().setJavaScriptEnabled(true);

    webView.setWebChromeClient(new WebChromeClient() {
        public void onProgressChanged(WebView view, int progress)
        {
            activity.setTitle("Loading...");
            activity.setProgress(progress * 100);

            if(progress == 100)
                activity.setTitle(R.string.app_name);
        }
    });

    webView.setWebViewClient(new WebViewClient() {
        @Override
        public void onReceivedError(WebView view, int errorCode, String description, String failingUrl)
        {
            // Handle the error
        }

        @Override
        public boolean shouldOverrideUrlLoading(WebView view, String url)
        {
            view.loadUrl(url);
            return true;
        }
    });

    webView.loadUrl("http://URL.USED.FOR/WEBAPP");
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T12:16:57.520

这是通过使用 @Override public void onConfigurationChanged(Configuration newConfig) { super.onConfigurationChanged(newConfig); 解决的。}

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T16:02:13.680

也许您的登录正在尝试使用某些网络插件。尝试添加其中一项或两项：

```
 mWebView.getSettings().setPluginState(WebSettings.PluginState.ON);
    mWebView.getSettings().setPluginsEnabled(true); 
```

# ios5 - 了解 Apple Push Notification Service 的详细信息

> ID：10705700
> 
> 赞同：0
> 
> 时间：2012-05-22T15:59:46.943
> 
> 标签：ios5, apple-push-notifications

我们可以将任何组件用于我们自己的服务器组件，这是真的吗？我的意思是它可以是与 Apple 服务器连接以推送通知的 Java 或 C# TCP/IP 客户端。这也可以是控制台应用程序，对吗？

另外，我们必须为 APN 服务器推送通知，每个 deviceTokens 都注册在我们自己的服务器上，这对吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T16:03:06.163

您可以使用任何您想要的语言，并且您必须为每个注册的设备令牌发送推送通知。您还应该调查苹果的反馈 API，您应该定期检查哪些设备不再注册，因为发送推送没有反馈，您将不知道是否收到了反馈。如果您使用诸如 Urban Airship 之类的服务，则设置将更容易启动，并且它们具有有用的 API 来为它们提供一组设备令牌或对所有已注册的设备令牌进行大规模推送。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T16:03:24.583

你在这两个方面都是对的。您可以编写自己的方法来发送它，并且您必须将它发送到每个设备id。

可能对您有所帮助的框架： [http ://www.easyapns.com/](http://www.easyapns.com/)

# java - jlabel 中的格式化文本和导入的值

> ID：10705704
> 
> 赞同：1
> 
> 时间：2012-05-22T15:59:59.600
> 
> 标签：java, html, swing, variables, jlabel

我想在 jlabel 中添加一些多行文本。我设法正确放置了一些 html 标签，所以我有我的多行 jlabel。现在我面临着第二个我无法克服的挑战。我需要在本文中添加一些值。例如，假设我有来自用户的输入。其中之一是他的名字，在出现在 jlabel 上的这段文字中，我想和他打个招呼等等！我该怎么做？我试图用 html 连接几个字符串，但也连接了一些变量，但没有任何效果！任何的想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T21:17:59.583

我对html一无所知，真的，不仅仅是例子

![在此处输入图像描述](../Images/1c846fba4b862ac99953d90b4dae720c.png) ![在此处输入图像描述](../Images/e05a2ad366337d287497a1fbe7df9042.png)

![在此处输入图像描述](../Images/885bbed5c9e46643ae22597a62c76cb0.png) ![在此处输入图像描述](../Images/250c5d91f2eaaf3cc433bcd78037bc1a.png)

从代码

```
import java.awt.*;
import javax.swing.*;
import javax.swing.event.ChangeEvent;
import javax.swing.event.ChangeListener;

public class HTMLTextColour extends JFrame {

    private static final long serialVersionUID = 1L;
    private JButton button;
    private JLabel label;
    private String when = "  asked yesterday  ";
    private String who = "  Vagelism  ";
    private String reputation = "  110 *7  ";
    private String accept = "  86% accept rate  ";

    public HTMLTextColour() {
        setDefaultCloseOperation(WindowConstants.EXIT_ON_CLOSE);
        setLayout(new FlowLayout());
        button = new JButton("Sample text");
        button.setText("<html><font color=" + (button.isEnabled() ? "blue" : "red") + ">"
                + button.getText() + "</font></html>");
        button.getModel().addChangeListener(new ChangeListener() {

            @Override
            public void stateChanged(ChangeEvent e) {
                ButtonModel model = (ButtonModel) e.getSource();
                if (model.isRollover()) {
                    label.setText(label.getText().replace("<html><strike>",
                            "<html>").replace("</strike></html>", "</html>"));
                } else {
                    label.setText(label.getText().replace("<html>",
                            "<html><strike>").replace("</html>", "</strike></html>"));
                }
                if (model.isPressed()) {
                    when = "   QQQQQQQQQQQQ QQQQQQQQQQQQ:   ";
                    who = "   - wwwwwwwwwww - wwwwwwwwwww   ";
                    reputation = "  - eeeeeeeeeee - eeeeeeeeeee  ";
                    accept = "  - xxxxxxxxxxx - xxxxxxxxxxx  ";
                    label.setText("<html> " + when + " <br>" + " " + who + " <br>"
                            + " " + reputation + " <br>" + " " + accept + " </html> ");
                    pack();
                }
            }
        });
        add(button);
        label = new JLabel("<html> " + when + " <br>"
                + " " + who + " <br>"
                + " " + reputation + " <br>"
                + " " + accept + " </html> ");
        add(label);
        pack();
        setVisible(true);
    }

    public static void main(String argsv[]) {
        EventQueue.invokeLater(new Runnable() {

            public void run() {
                HTMLTextColour hTMLTextColour = new HTMLTextColour();
            }
        });
    }
} 
```

# java - 如何在 Java 7 中使用集合文字？

> ID：10705705
> 
> 赞同：23
> 
> 时间：2012-05-22T16:00:04.803
> 
> 标签：java, collections

我试过以下行：

```
Map<Character, Color> map={new Character('r'):Color.red,new Character('b'):Color.black}; 
```

但是 Netbeans 7 拒绝了这一点，并带有错误消息`'{' expected, ';' expected`。

我已将 Source/Binary 格式设置为“JDK 7”，平台设置为“JDK 1.7”，还有什么需要做的吗？

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2012-05-22T16:02:54.527

Java 7 和 Java 8 都不支持集合文字，如以下问题所述：[Are Project Coin's collection enhancements going to be in JDK8?](https://stackoverflow.com/questions/13692213/are-project-coins-collection-enhancements-going-to-be-in-jdk8)

如果您只需要不可变集合，则可以使用 Google 的[Guava](http://code.google.com/p/guava-libraries/)库。[`ImmutableList`](http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/ImmutableList.html),[`ImmutableSet`](http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/ImmutableSet.html)并且[`ImmutableMap`](http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/ImmutableMap.html)有几个重载的工厂方法甚至是使创建集合变得容易的构建器：

```
List<Integer> list = ImmutableList.of(1, 1, 2, 3, 5, 8, 13, 21);
Set<String> set = ImmutableSet.of("foo", "bar", "baz", "batman");
Map<Integer, String> map = ImmutableMap.of(1, "one", 2, "two", 3, "three"); 
```

**编辑**

Java 9 添加了类似于 Guava 的[集合工厂方法：](http://openjdk.java.net/jeps/269)

```
List.of(a, b, c);
Set.of(d, e, f, g);
Map.of(k1, v1, k2, v2)

Map.ofEntries(
    entry(k1, v1),
    entry(k2, v2),
    entry(k3, v3),
    // ...
    entry(kn, vn)
); 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-05-22T16:03:56.970

您需要定义一个具体的地图实现，可选择结合双括号初始化：

```
Map<Character, Color> map = new HashMap<Character, Color>() {{ 
  put(new Character('r'), Color.red);
  put(new Character('b'), Color.black );
}}; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-22T16:29:57.627

为了扩展 Thomas 的答案... Map 是一个接口，必须通过相关的具体实现（HashMap、TreeMap 或 LinkedHashMap）之一进行实例化。这仍然是一种很好的做法；但是，将您的引用变量声明为接口实现而不是具体的具体实现，因为它提供了未来的灵活性。

不过，关于代码片段，我认为您仍然需要在声明的赋值端定义的键值对。所以，我会改变：

```
Map<Character, Color> map = new HashMap<>() {{ 
```

到

```
Map<Character, Color> map = new HashMap<Character, Color>() {{ 
```

# symstore - 运行 TFS 2010 构建时出现 symstore 错误

> ID：10705707
> 
> 赞同：1
> 
> 时间：2012-05-22T16:00:15.850
> 
> 标签：symstore

背景：我有几个通过 TFS2010 在 Windows Server 2003 R2 机器上运行的构建。所有这些构建定义都将发布符号的路径设置为“\\server\SymbolStore”，并且构建运行良好。

（注意——我从一位前雇员那里继承了这个设置，我还有其他构建在单独的 2K8 机器上运行，它们也可以正常运行）

我现在正在使用相同的设置将这些构建迁移到新的 Windows 2008 R2 构建服务器。

问题：在新的构建机器上运行构建时，一切正常，直到构建尝试在工作流中运行“发布符号”活动，此时我收到错误

> SYMSTORE 错误：类：服务器。描述：无法连接到服务器。错误 5：访问被拒绝。TF270015：“symstore.exe”返回了意外的退出代码。预期为“0”；实际的“5”。

这还将构建状态设置为部分成功。

到目前为止，我已经在网上搜索了这些错误消息，但无济于事，所以有人知道可能导致此问题的原因以及如何使其再次工作吗？

一如既往，提前感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T16:09:26.990

您是否检查了该文件夹对 Team Build 用于创建/写入文件的服务帐户具有正确的权限？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T15:46:24.263

事实证明，在我设置了新的构建机器之后，我将构建服务属性的凭据（在 Team Foundation Server 管理控制台/构建配置中找到）保留了其默认设置，即“NT AUTHORITY\NetworkService”。一旦我将其更改为使用构建服务帐户，构建就能够正确写入符号存储

# java - 在非 servlet 类中获取上下文路径

> ID：10705708
> 
> 赞同：2
> 
> 时间：2012-05-22T16:00:21.890
> 
> 标签：java, quartz-scheduler, relative-path, contextpath

在我的 web 应用程序中，我使用 Quartz 在某个时间间隔调用某个类中定义的方法，该方法作为参数之一采用指向我的 WebContent 目录中的 css 文件的路径。我的问题是如何从非 servlet 类中获取该 css 文件的路径。

我确实尝试过的一件事是我让调用该方法的类扩展了，`HttpServlet`以便我可以调用

```
String contextPath = getServletContext().getRealPath(""); 
```

但这不起作用，我的应用程序就挂在那条线上。我不想硬编码路径，因为这似乎不专业:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T16:06:41.767

您不能从 Quartz 作业访问 servlet 上下文，因为该作业不是作为请求处理管道的一部分调用的。

为什么不直接将 CSS 文件路径作为作业的参数，以便它可以由 servlet/web-code 调度/调用 Quartz 作业传递？有关示例，请参阅[Quartz 文档。](http://quartz-scheduler.org/documentation/quartz-2.x/examples/Example4)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T16:07:14.660

如果将文件放在 Web 应用程序的 WEB-INF/classes 目录中，则可以使用 getResourceAsStream() 访问它。这将与 WAR 文件一起使用；getRealPath() 不会。

为什么 Quartz 需要知道 .css 文件？那应该是纯粹的看法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-05-15T10:24:32.293

不，我们可以从 Quartz 作业访问 servlet 上下文。

```
@Override
public void contextInitialized(ServletContextEvent sce) {
    try {
        //Create & start the scheduler.
        StdSchedulerFactory factory = new StdSchedulerFactory();
        factory.initialize(sce.getServletContext().getResourceAsStream("/WEB-INF/my_quartz.properties"));
        scheduler = factory.getScheduler();
        //pass the servlet context to the job
        JobDataMap jobDataMap = new JobDataMap();
        jobDataMap.put("servletContext", sce.getServletContext());
        // define the job and tie it to our job's class
        JobDetail job = newJob(ImageCheckJob.class).withIdentity("job1", "group1").usingJobData(jobDataMap).build();
        // Trigger the job to run now, and then repeat every 3 seconds
        Trigger trigger = newTrigger().withIdentity("trigger1", "group1").startNow()
              .withSchedule(simpleSchedule().withIntervalInMilliseconds(3000L).repeatForever()).build();
        // Tell quartz to schedule the job using our trigger
        scheduler.scheduleJob(job, trigger);
        // and start it off
        scheduler.start();
    } catch (SchedulerException ex) {
        log.error(null, ex);
    }
} 
```

在 Quartz 工作中，我们可以得到如下的 servlet 上下文。

```
@Override
public void execute(JobExecutionContext context) throws JobExecutionException {
    ServletContext servletContext = (ServletContext) context.getMergedJobDataMap().get("servletContext");
    //...
} 
```

# python - 使用 python 的窗口截图

> ID：10705712
> 
> 赞同：8
> 
> 时间：2012-05-22T16:00:33.323
> 
> 标签：python, pyqt

我正在尝试使用 linux 上的 python 脚本截取当前窗口的屏幕截图。

我目前有一个脚本可以截取整个屏幕的截图：

```
import sys
from PyQt4.QtGui import QPixmap, QApplication
from datetime import datetime

date = datetime.now()
filename = date.strftime('%Y-%m-%d_%H-%M-%S.jpg')
app = QApplication(sys.argv)
QPixmap.grabWindow(QApplication.desktop().winId()).save(filename, 'jpg') 
```

但是一个想只有选定的窗口。我知道问题来自grabWindow。但我不知道如何解决它。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-22T16:26:17.403

只需更换

```
QApplication.desktop() 
```

使用您要截取屏幕截图的小部件。

```
import sys
from PyQt4.QtGui import *
from datetime import datetime

date = datetime.now()
filename = date.strftime('%Y-%m-%d_%H-%M-%S.jpg')
app = QApplication(sys.argv)
widget = QWidget()
# set up the QWidget...
widget.setLayout(QVBoxLayout())

label = QLabel()
widget.layout().addWidget(label)

def shoot():
    p = QPixmap.grabWindow(widget.winId())
    p.save(filename, 'jpg')
    label.setPixmap(p)        # just for fun :)
    print "shot taken"

widget.layout().addWidget(QPushButton('take screenshot', clicked=shoot))

widget.show()
app.exec_() 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2015-10-12T08:00:45.673

从 Qt5 开始，`grabWindow`并且`grabWidget`已经过时（参见[QPixmap 的过时成员](http://doc.qt.io/qt-5/qpixmap-obsolete.html)）

相反，您可以使用`QWidget.grab()`

```
p=widget.grab() 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-08-06T10:43:52.330

或者，而不是

```
p = QPixmap.grabWindow(widget.winId()) 
```

你也可以使用

```
p = QPixmap.grabWidget(widget) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-02-01T19:45:13.713

**PyQt5**更新

```
import sys
from PyQt5.QtWidgets import QApplication
from PyQt5.QtGui import QPixmap, QScreen
from datetime import datetime

date = datetime.now()
filename = date.strftime('%Y-%m-%d_%H-%M-%S.jpg')
app = QApplication(sys.argv)
QScreen.grabWindow(app.primaryScreen(), 
QApplication.desktop().winId()).save(filename, 'png') 
```

# c# - .NET/C# 的初学者套接字：请求桌面图标

> ID：10705714
> 
> 赞同：0
> 
> 时间：2012-05-22T16:00:37.113
> 
> 标签：c#, networking, tcp, client-server

我正在开发一个小应用程序，它将连接到远程机器，并向客户端返回远程桌面图标的列表。

我目前有此功能适用于本地桌面图标。

理论上，我假设我必须给远程服务器我用来在本地获取图标的代码，然后向服务器发送命令以触发它运行所述方法。然后我会将它的返回值返回给客户端以进行进一步处理/显示。

我应该看什么样的对象/架构来完成这样的事情？我会在服务器上打开一个开关来处理各种不同的命令可能性吗？这在非常大的应用程序中不会失控吗？如何将“快捷方式”对象作为字节流发送到客户端，然后在客户端上重新创建“快捷方式”？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T16:39:13.120

实施远程桌面功能并不是学习网络的最简单练习。

首先，实现控制台应用程序重定向甚至简单的[telnet](http://en.wikipedia.org/wiki/Telnet)客户端可能更容易（您可以在某些版本的 Windows 上启用 telnet 来玩，而无需编写服务器端部分）。

如果想了解如何实现远程桌面，请考虑阅读有关它的 Unix 实现[X Window System](http://en.wikipedia.org/wiki/X_Window_System)。

至于图形 UI 支持 - 阅读 RDP，或阅读有关 FogCreek 的 CoPilot 的文章（它几乎完全实现了你想要的） - [CoPilot 技术信息](https://www.copilot.com/tech/)，或从[远程桌面软件的列表比较](http://en.wikipedia.org/wiki/Comparison_of_remote_desktop_software)以查找更多信息。

# python - 仅平均工作日的半小时数据

> ID：10705715
> 
> 赞同：0
> 
> 时间：2012-05-22T16:00:59.953
> 
> 标签：python, pandas

我试图获得一段时间序列数据的平均值（超过 24 小时，间隔 30 分钟）。

目前我有：

```
# Data of interest
START = datetime(2010,2,1,0,0,0)
END = datetime(2010,2,8,23,59,59)

# Function to group by time of day
def minutes(date):
    time = date.strftime("%H:%M:%S")
    dt = datetime.strptime("2009-04-01 " + time, "%Y-%m-%d %H:%M:%S")
    return dt

# Truncate data to desired section
telford = store.get_data("spd_mw").TELR.truncate(START,END)

# Group and average
telford.groupby(minutes).mean() 
```

我试过使用`asfreq(datetools.BDay())`，但它会删除半小时的数据。是写我自己的 DateOffset 的情况吗？

有没有更简洁的方法来按分钟对上述数据进行分组？

顺便说一句：截断是否需要是数据中的现有索引？我收到以下错误（在与上述不同的一组数据上）：

```
Traceback (most recent call last):
  File "power-weather.py", line 21, in <module>
    egph_temp = store.get_data("weather_EGPH").TemperatureC.truncate(START,END)
  File "/usr/local/lib/python2.6/dist-packages/pandas-0.7.3-py2.6-linux-x86_64.egg/pandas/core/generic.py", line 702, in truncate
    result = self.ix[before:after]
  File "/usr/local/lib/python2.6/dist-packages/pandas-0.7.3-py2.6-linux-x86_64.egg/pandas/core/indexing.py", line 35, in __getitem__
    return self._getitem_axis(key, axis=0)
  File "/usr/local/lib/python2.6/dist-packages/pandas-0.7.3-py2.6-linux-x86_64.egg/pandas/core/indexing.py", line 167, in _getitem_axis
    return self._get_slice_axis(key, axis=axis)
  File "/usr/local/lib/python2.6/dist-packages/pandas-0.7.3-py2.6-linux-x86_64.egg/pandas/core/indexing.py", line 372, in _get_slice_axis
    i, j = labels.slice_locs(start, stop)
  File "/usr/local/lib/python2.6/dist-packages/pandas-0.7.3-py2.6-linux-x86_64.egg/pandas/core/index.py", line 842, in slice_locs
    beg_slice = self.get_loc(start)
  File "/usr/local/lib/python2.6/dist-packages/pandas-0.7.3-py2.6-linux-x86_64.egg/pandas/core/index.py", line 523, in get_loc
    return self._engine.get_loc(key)
  File "engines.pyx", line 101, in pandas._engines.DictIndexEngine.get_loc (pandas/src/engines.c:2498)
  File "engines.pyx", line 108, in pandas._engines.DictIndexEngine.get_loc (pandas/src/engines.c:2460)
KeyError: datetime.datetime(2010, 2, 1, 0, 0) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T12:54:34.987

解决了：

```
def weekdays(date):
    if 0 < int(datetime.strftime(date, "%w")) < 6:
        return True
    return False

def weekends(date):
    if int(datetime.strftime(date, "%w")) == (0 or 6):
        return True
    return False

telford = telford.select(weekdays) 
```

# php - 从数组中提取数据 (PHP)

> ID：10705722
> 
> 赞同：0
> 
> 时间：2012-05-22T16:01:20.590
> 
> 标签：php, arrays, request

我创建了一个销售各种卡片的简单订单表格。这些卡片有不同的颜色。下面的代码显示了提供的颜色。我需要能够从下面的数组中提取数据，以便我可以确定用户在表单上为订购目的选择了多少种颜色。

```
Array
(
    [qty] => Array
        (
            ['red'] => 0
            ['blue'] => 0
            ['green'] => 0
            ['yellow'] => 0
            ['orange'] => 0
            ['white'] => 0
            ['black'] => 0
            ['purple'] => 0
            ['teal'] => 0
            ['grey'] => 0
        ) 
```

对此我非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T16:23:22.737

尝试这样的事情：

```
<?php
    $some_input = array('red','red','white');
    $a =array( 'qty' => array(
    'red' => 0,
    'blue' => 0,
    'green' => 0,
    'yellow' => 0,
    'orange' => 0,
    'white' => 0,
    'black' => 0,
    'purple' => 0,
    'teal' => 0,
    'grey' => 0,
));
    $f = function($x) use(&$a)
    {
        if(in_array($x, $a['qty']))
        {
            $a['qty'][$x]++;
        }
    };
    array_map($f, $some_input);

    var_dump($a);
?> 
```

你可以看到[这里](http://codepad.viper-7.com/MZ23yu)运行的代码点击按钮粘贴

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T16:23:51.943

您只想在页面上显示信息吗？

如果是这样，这应该为您完成工作（假设您的数组称为 $array）：

```
<table>
    <thead>
        <tr>
            <th>Colour</th>
            <th>Qty</th>
        </tr>
    </thead>
    <tbody>
    <?php foreach($array['qty'] AS $colour => $total) { ?>
        <tr>
            <td><?php echo $colour; ?></td>
            <td><?php echo $total; ?></td>
        </tr>
    <?php } ?>
    </tbody>
</table> 
```

# vba - 如何使用 VBA 删除除特定标题之外的所有空列？

> ID：10705724
> 
> 赞同：1
> 
> 时间：2012-05-22T16:01:25.960
> 
> 标签：vba, excel

我想删除工作表中符合以下条件的所有列：

*   第 1 行 = “foobar”
*   第 2-1000 行为空

这听起来很简单，但我还没有设法让它充分发挥作用。任何帮助将不胜感激。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-22T16:48:29.647

根据您的要求删除行的最快方法。

我假设 Row1 有列标题

```
Option Explicit

Sub Sample()
    Dim aCell As Range, rng As Range
    Dim LastCol As Long, LastRow As Long, i As Long

    With Sheets("Sheet1")
        Set aCell = .Rows(2).Find(What:="foobar", LookIn:=xlValues, _
        Lookat:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, _
        MatchCase:=False, SearchFormat:=False)

        If Not aCell Is Nothing Then .Rows(2).Delete

        LastRow = .Cells.Find(What:="*", _
                  After:=.Range("A1"), _
                  Lookat:=xlPart, _
                  LookIn:=xlFormulas, _
                  SearchOrder:=xlByRows, _
                  SearchDirection:=xlPrevious, _
                  MatchCase:=False).Row

        LastCol = .Cells.Find(What:="*", _
                  After:=.Range("A1"), _
                  Lookat:=xlPart, _
                  LookIn:=xlFormulas, _
                  SearchOrder:=xlByColumns, _
                  SearchDirection:=xlPrevious, _
                  MatchCase:=False).Column

        Set rng = Range("A1:" & Split(Cells(, LastCol).Address, "$")(1) _
                  & LastRow)

        ActiveSheet.AutoFilterMode = False

        For i = 1 To LastCol
            rng.AutoFilter Field:=i, Criteria1:=""
        Next i

        rng.Offset(1, 0).SpecialCells(xlCellTypeVisible).EntireRow.Delete

        ActiveSheet.AutoFilterMode = False
    End With
End Sub 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-22T16:29:23.107

怎么样

```
dim col as Long, lastCol as Long, r as range
lastCol = ActiveSheet.Usedrange.columns(Activesheet.Usedrange.columns.count).column
for c=lastCol to 1 Step -1
    set r = Range(Cells(1, c), Cells(1000, c))
    if r.Rows(1) = "foobar" Then
        if WorksheetFunction.CountA(Range(r.Rows(2), r.Rows(r.Rows.Count))) = 0 then
            Columns(c).delete
        end if
    end If
next 
```

[由 OP 编辑​​：添加了一个缺失的空格]

# arrays - 如何将数组传递给 Perl 中的函数？

> ID：10705728
> 
> 赞同：6
> 
> 时间：2012-05-22T16:01:36.647
> 
> 标签：arrays, perl, function

问题一：

我想将数组传递给函数。但是传递的参数在函数中发生了变化。它是按值调用的吗？

问题2：

```
#my ($name, $num, @array)= @_;   <=1 )
my $name = shift;                <=2 )
my $num = shift;
my @array = shift; 
```

情况 1 和 2 的输出不同。为什么会发生？

```
#!/usr/bin/perl
use strict;

my @test1;
push @test1, ['a', 1];
push @test1, ['b', 1];
push @test1, ['c', 1];
push @test1, ['d', 1];
push @test1, ['e', 1];

for (my $i=0; $i< scalar(@test1); $i++) {
    print "out1: $test1[$i][0]  $test1[$i][1]\n";
}

test_func("test_func", 10, @test1);

sub test_func {
    #my ($name, $num, @array)= @_;   <=1)
    my $name = shift;                <=2)
    my $num = shift;
    my @array = shift;

    print "$name\n";
    print "$num\n";

    for (my $i=0; $i< scalar(@test1); $i++) {
        print "$array[$i][0]  $array[$i][1]\n";
    }

    for (my $i=0; $i< scalar(@test1); $i++) {
        if ($array[$i][0] eq 'a') {
            $array[$i][0] = 'z';
        }
    }
    for (my $i=0; $i< scalar(@test1); $i++) {
        print "change: $array[$i][0]  $array[$i][1]\n";
    }
}

for (my $i=0; $i< scalar(@test1); $i++) {
    print "out2: $test1[$i][0]  $test1[$i][1]\n";
} 
```

#

下面是测试输出。

```
out1: a  1
out1: b  1
out1: c  1
out1: d  1
out1: e  1
test_func
10
a  1
b  1
c  1
d  1
e  1
change: z  1
change: b  1
change: c  1
change: d  1
change: e  1
out2: z  1 <= Why did it change?
out2: b  1
out2: c  1
out2: d  1
out2: e  1 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-22T16:25:04.970

> 我想将一个数组传递给一个函数 [...] 有不同的输出。为什么会发生？

您不能将数组传递给~~函数~~sub。Subs 只能将标量列表作为参数。

```
test_func("test_func", 10, @test1); 
```

是相同的

```
test_func("test_func", 10, $test1[0], $test1[1], $test1[2], $test1[3], $test1[4]); 
```

`test_func`当你这样做时，你正在创建一个新数组

```
my ($name, $num, @array) = @_; 
```

`shift`返回 的第一个元素`@_`，它必然是一个标量。`@_`是一个数组，数组的元素是标量。等价的将是

```
my $name  = shift(@_);
my $num   = shift(@_);
my @array = splice(@_); 
```

要将数组传递给子，通常会传递对它的引用。

```
test_func("test_func", 10, \@test1);

my ($name, $num, $array) = @_;

my $name  = shift;
my $num   = shift;
my $array = shift;

say "@$array"; 
```

* * *

> 但是传递的参数在函数中发生了变化。它是按值调用的吗？

Perl 从不按值传递。它总是通过引用传递。如果您更改 的任何元素`@_`，它将更改调用者中的相应参数。

```
$ perl -E'sub f { $_[0] = "def"; }  my $x = "abc"; f($x); say $x;'
def 
```

但这不是问题。您不会更改`@_`. 您正在做的是更改`$test[0]`和引用的单个数组`$array[0]`。

这就是你正在做的事情：

```
my $ref1 = [ 'a', 1 ];  # aka $test1[0]
my $ref2 = $ref1;       # aka $array[0]
$ref2->[0] = 'z';       # Changes the single array (not $ref1 or $ref2). 
```

它的简称

```
my @anon = ( 'a', 1 );
my $ref1 = \@anon;      # aka $test1[0]
my $ref2 = $ref1;       # aka $array[0]
$ref2->[0] = 'z';       # Changes @anon (not $ref1 or $ref2). 
```

[Storable](http://search.cpan.org/perldoc?Storable)`dclone`可用于制作数组的“深拷贝” 。

```
my $ref1 = [ 'a', 1 ];
my $ref2 = dclone($ref1);  # clones the reference, the array, 'a' and 1.
$ref1->[0] = 'y';          # Changes the original array
$ref2->[0] = 'z';          # Changes the new array 
```

# c# - 如何使用root反序列化Xml而不是相同类型的多个子元素

> ID：10705733
> 
> 赞同：2
> 
> 时间：2012-05-22T16:02:15.007
> 
> 标签：c#, xml, datacontractserializer

我正在尝试反序列化一个看起来像这样的 xml 文档

```
<invoices>
  <invoice>2848</invoice>
  <invoice>2849</invoice>
  <invoice>2850</invoice>
  <invoice>2851</invoice>
  <invoice>2852</invoice>
</invoices> 
```

进入一个 C# 对象，但我无法让它工作。我正在使用`DataContractSerializer`

这是我的课的样子：

```
[DataContract(Name = "invoices", Namespace = "")]
public class Invoices
{
    [DataMember(Name = "invoice")]
    public Invoice[] InvoiceIds { get; set; }
}

[DataContract(Name = "invoice", Namespace = "")]
public class Invoice
{
    [DataMember(Name = "invoice")]
    public string Id { get; set; }
} 
```

当然，这是行不通的。我收到此错误：

```
{"Error in line 1 position 24\. Expecting state 'Element'.. Encountered 'Text'  with name '', namespace ''. "} 
```

我无法控制 Xml。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-22T16:08:53.413

尝试`[CollectionDataContract]`在这种情况下使用 a：

```
public class StackOverflow_10705733
{
    [CollectionDataContract(Name = "invoices", ItemName = "invoice", Namespace = "")]
    public class Invoices : List<int>
    {
        [DataMember(Name = "invoice")]
        public int[] InvoiceIds { get; set; }
    }
    public static void Test()
    {
        DataContractSerializer dcs = new DataContractSerializer(typeof(Invoices));
        string xml = @"<invoices>
                          <invoice>2848</invoice>
                          <invoice>2849</invoice>
                          <invoice>2850</invoice>
                          <invoice>2851</invoice>
                          <invoice>2852</invoice>
                        </invoices>";
        MemoryStream ms = new MemoryStream(Encoding.UTF8.GetBytes(xml));
        Invoices value = dcs.ReadObject(ms) as Invoices;
        Console.WriteLine(string.Join(",", value));
    }
} 
```

# objective-c - UIView 的 frame origin.y = 0 但显示在 origin.y = statusBarHeight

> ID：10705735
> 
> 赞同：0
> 
> 时间：2012-05-22T16:02:36.303
> 
> 标签：objective-c, ios, uiview

我有一个包含 3 个子视图的主视图，而最后一个子视图的行为很奇怪。我将它的框架原点设置为 0,0，它在 statusBar 下显示为 20px。要解决这个问题，我必须设置 frame.origin.y = -20 。这怎么可能？其他 2 个视图已正确显示...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T16:07:02.200

有问题的观点是如何构建的？如果它来自笔尖或故事板，请查看适当项目的“模拟指标”——您可能有一个状态栏启用了相关视图。如果是这样，请尝试将状态栏设置为“无”。

# java - Java 套接字发送和接收数据

> ID：10705740
> 
> 赞同：0
> 
> 时间：2012-05-22T16:02:52.977
> 
> 标签：java, network-programming

嗨，我正在尝试了解 Sockets 的工作方式如何实现多人游戏的垄断游戏。我了解如何创建连接，但现在看来我在客户端和服务器之间发送和接收数据时遇到了麻烦。这是我的代码：

客户端代码：

```
public class EchoClient
{
  public static void main(String[] args)
  {
    Socket echoSocket = null;
    PrintWriter out = null;
    BufferedReader in = null;

    try
    {
      echoSocket = new Socket("127.0.0.1", 5000);;
      out = new PrintWriter(echoSocket.getOutputStream());
      in = new BufferedReader(
          new InputStreamReader(echoSocket.getInputStream()));

      BufferedReader stdIn = new BufferedReader(
          new InputStreamReader(System.in));

      String userInput;

      while ((userInput = stdIn.readLine()) != null)
      {
        out.println(userInput);

      }

      out.close();
      in.close();
      stdIn.close();
      echoSocket.close();
    }
    catch (UnknownHostException e)
    {
      System.err.println("Don't know about host: taranis");
    }
    catch (IOException e)
    {
      System.err.println("Couldent get I/O for "
          + " the connection to : taranis.");
    }

  }
} 
```

服务器代码：

```
public class ServerSide
{

  ServerSocket connect;
  Socket connection;
  PrintWriter out;
  BufferedReader in;

  public void go()
  {

    try
    {
      connect = new ServerSocket(5000);
      connection = connect.accept();
      in = new BufferedReader(
          new InputStreamReader(connection.getInputStream()));

      String userInput;

      while ((userInput = in.readLine()) != null)
      {
        System.out.println("echo: " + in.readLine());
      }

    }
    catch (IOException e)
    {
      System.out.println(e);
    }
  }

  public static void main(String[] args)
  {
    new ServerSide().go();
  }
} 
```

我试图在这里创建客户端和服务器之间的简单连接。在客户端，当用户输入数据时，我希望将其发送到服务器，然后在服务器控制台上打印它。似乎我的方式改正代码它没有工作我做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T16:17:29.917

在客户端上，您`out.flush;`在`out.println`.

在服务器上，

```
 while ((userInput = in.readLine()) != null) {
        System.out.println("echo: " + userInput); // not in.readLine
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T16:11:00.960

首先，您需要声明一个控制台对象，然后在其上打印。
然后不要忘记：
在服务器端的控制台上每次打印后，您需要刷新流，以便打印所有数据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-22T16:13:47.710

你的代码对我来说看起来不错。通常使用套接字和键盘输入时，您会遇到 reader.readLine() 挂起的情况，因为它仍在尝试从另一端读取输入。通常，我会在客户端末尾放置一个空的 out.println() ，以便服务器终止读取 while 循环。我之前按照 Mike 的建议尝试过 flush() ，但这似乎对我不起作用。

# java - 将java对象转换为json

> ID：10705748
> 
> 赞同：4
> 
> 时间：2012-05-22T16:03:13.740
> 
> 标签：java, json, gson

在 Java 中，我有这种对象，`Map<Member, Map<CustomerVO, Set<Vehicle>>>`还有一个`List<DeviceOrder>`我想将其转换为 json，我尝试使用[Gson](http://code.google.com/p/google-gson/)，但它抛出错误为**“忘记注册类型适配器？”**

有人可以帮助我如何进行，如果不是gson，还有什么其他的转换方式。

上面的错误是当我尝试这种方式时

```
List<DeviceOrder> devLst;
Gson gson = new Gson();
String jsonStr = gson.toJson(devLst); 
```

对于另一个作为

```
Map<Member, Map<CustomerVO, Set<Vehicle>>> map;
Gson gson = new Gson();
String jsonStr = gson.toJson(map); 
```

请让我知道我做错了什么。后来我想把这个传给jsp来显示。

**更新：** 甚至尝试过这种方式，但没有用。

```
Gson gson = new Gson();
Type type = new TypeToken<List<DeviceOrder>>(){}.getType();
String jsonstr = gson.toJson(devLst, type); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-26T23:17:08.450

您可以尝试作为[J2EE](http://docs.oracle.com/javaee/7/tutorial/doc/jsonp.htm)一部分的[用于 JSON 处理的 Java API](https://jsonp.java.net/index.html)的标准实现。

对于您的`List<DeviceOrder> devLst`，定义 bean：

```
public class DeviceOrder implements Serializable {
    private static final long serialVersionUID = 893438341L;

    public DeviceOrder() {
    }

    public DeviceOrder(int id, String desc, Date date) {
        this.id = id;
        this.desc = desc;
        this.date = date;
    }

    public int getId() {
        return id;
    }

    public void setId(int id) {
        this.id = id;
    }

    public String getDesc() {
        return desc;
    }

    public void setDesc(String desc) {
        this.desc = desc;
    }

    public Date getDate() {
        return date;
    }

    public void setDate(Date date) {
        this.date = date;
    }

    @Override
    public int hashCode() {
        final int prime = 31;
        int result = 1;
        result = prime * result + ((date == null) ? 0 : date.hashCode());
        result = prime * result + ((desc == null) ? 0 : desc.hashCode());
        result = prime * result + id;
        return result;
    }

    private int id;
    private String desc;
    private Date date;
} 
```

然后使用：

```
final SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd");

List<DeviceOrder> devLst = new ArrayList<DeviceOrder>() {
    {
        add(new DeviceOrder(1, "order 1", sdf.parse("2010-05-01")));
        add(new DeviceOrder(2, "order 2", sdf.parse("2010-06-01")));
        add(new DeviceOrder(3, "order 3", sdf.parse("2010-07-01")));
    }
};
DeviceOrder[] devArr = devLst.toArray(new DeviceOrder[devLst.size()]);

JsonArrayBuilder devArrBuilder = Json.createArrayBuilder();
for (DeviceOrder devOrder : devArr) {
    JsonObjectBuilder jsonObject = Json.createObjectBuilder()
            .add("id", devOrder.getId())
            .add("desc", devOrder.getDesc())
            .add("date", sdf.format(devOrder.getDate()));
    devArrBuilder.add(jsonObject);
}
JsonArray jsonArray = devArrBuilder.build();

Map<String, Object> prop = new HashMap<String, Object>() {
    {
        put(JsonGenerator.PRETTY_PRINTING, true);
    }
};
JsonWriter jsonWriter = Json.createWriterFactory(prop).createWriter(System.out);
jsonWriter.writeArray(jsonArray);
jsonWriter.close(); 
```

输出应该是：

```
[
    {
        "id":1,
        "desc":"order 1",
        "date":"2010-05-01"
    },
    {
        "id":2,
        "desc":"order 2",
        "date":"2010-06-01"
    },
    {
        "id":3,
        "desc":"order 3",
        "date":"2010-07-01"
    }
] 
```

您`Map<Member, Map<CustomerVO, Set<Vehicle>>> map`可以以`List`类似的方式简化为 a 和 JSONed。

# java - OSGi：将参数传递给特定的包

> ID：10705750
> 
> 赞同：3
> 
> 时间：2012-05-22T16:03:23.183
> 
> 标签：java, osgi

我有一个带有自定义 Main 类的自定义 jar，它启动 OSGi 框架并安装/启动捆绑包。这个主 jar 还包括一个属性文件。

目标：我有一个包 A，它应该以某种方式获取主 jar 的这个属性文件的属性。

我的第一次尝试是在包 A 中定义一个组件（使用 Apache Felix SCR/声明式服务）并在其激活方法中检索属性。到目前为止，这有效，我得到了@Property-annotation 中指定的默认值。

但是我现在如何将属性文件的属性传递给这个组件呢？

[将参数传递给 OSGi 应用程序](https://stackoverflow.com/questions/7132866/passing-arguments-to-osgi-application) 提到使用 Config Admin，但我如何在 Main 类中使用它？

*   Config Admin 在一个包中，而不是在主 jar 中，并且这些包没有按任何特定顺序安装
*   Main 类对它安装的包一无所知，更不用说特定的 service.pid。

## 更新：

我现在正在尝试@vizier 建议的方法（它不使用 Config Admin，因此没有提到的问题）：

*   在主jar（系统包）中定义一个服务接口
*   提供一个实现，它读取属性文件（属性文件在同一个jar中）
*   导出包含此服务接口的包 X
*   包 A 然后可以导入包 X 并例如使用声明性服务引用服务

但在我的捆绑包 A 中，我得到：

```
org.osgi.framework.BundleException: Unresolved constraint in bundle <bundle A> [14]: Unable to resolve 14.0: missing requirement [14.0] osgi.wiring.package; (&(osgi.wiring.package=<package X>)(version>=0.1.0)(!(version>=1.0.0)))
    at org.apache.felix.framework.Felix.resolveBundleRevision(Felix.java:3826)
    at org.apache.felix.framework.Felix.startBundle(Felix.java:1868)
    at org.apache.felix.framework.Felix.setActiveStartLevel(Felix.java:1191)
    at org.apache.felix.framework.FrameworkStartLevelImpl.run(FrameworkStartLevelImpl.java:295)
    at java.lang.Thread.run(Thread.java:722) 
```

即使Manifest文件中的Export-Package添加了一些自定义包，系统捆绑包是否只导出osgi包？或者出了什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T06:19:46.747

和往常一样，注册一个服务......接收包（和任何其他包）可以搜索服务并读取属性。由于您是框架启动器，因此您可以通过从 Launching API 获得的框架对象注册您想要的任何服务。

在 bnd(tools) 我有一个启动器。它使用 OSGi Launcher API 来创建包，类似于您所描述的。我将命令行参数作为启动器服务的属性传递。以[https://github.com/bndtools/bnd/blob/master/biz.aQute.launcher/src/aQute/launcher/Launcher.java](https://github.com/bndtools/bnd/blob/master/biz.aQute.launcher/src/aQute/launcher/Launcher.java)为例。

当然，您也可以通过 Framework 对象获取 Configuration Admin 服务并使用它来注册配置。在 JSON（或者，我敢说是 XML）文件中定义配置，然后读取并更新 Configuration Admin 非常容易（实际上已经完成）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T17:00:39.287

最简单的可能是将带有属性文件的 jar 制作成一个片段，以 bundle A 作为宿主。

然后属性将位于包的类路径中，并且可以轻松读取。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-22T16:26:01.317

您也可以使包含主类的 jar 成为 OSGi 包，并在启动期间将此包与其他包一起安装。然后，您可以使用多种技术让其他包访问您的 jar 中包含的属性，例如：

*   提供一个类来访问属性并使用模块依赖进行集成（Export-package/Import-package）
*   提供访问属性的服务
*   使用配置管理员

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-23T10:27:48.553

我们在 Apache Karaf 中有一个类似的案例。在那里，我们只需将属性设置为 java System 属性并将它们提供给框架。然后这些在 OSGi 包上下文中作为属性可用。所以这对于适用于整个平台的属性来说是很好的。查看karaf starter的项目：http: [//svn.apache.org/viewvc/karaf/trunk/main/](http://svn.apache.org/viewvc/karaf/trunk/main/)

如果您需要用户包中的属性，那么使用配置管理服务会更好。它将用户包从检索属性的机制中分离出来，并且还允许在运行时进行更新。还有一个元类型服务，它允许定义属性的结构和含义，从而允许以漂亮的形式来编辑属性。

我在我的网站上的两个教程中描述了如何使用配置管理服务：

*   配置管理服务：[http ://www.liquid-reality.de/x/G4Be](http://www.liquid-reality.de/x/G4Be)
*   元类型服务：[http ://www.liquid-reality.de/x/KoBe](http://www.liquid-reality.de/x/KoBe)

# c++ - C++ typedef 语法规则

> ID：10705751
> 
> 赞同：3
> 
> 时间：2012-05-22T16:03:23.857
> 
> 标签：c++

对于我的一生，我找不到一个很好的解释来解释什么是用于将 typedef 转换为 C++ 语句的规则。我理解的简单案例。但考虑一下[Danny Kalev](http://www.informit.com/guides/content.aspx?g=cplusplus&seqNum=177)的观点：

```
typedef char * pstr;
int mystrcmp(const pstr, const pstr); //wrong! 
```

丹尼·卡列夫接着写道：

> 序列 const pstr 实际上表示 char * const（指向 char 的 const 指针）；不是 const char *（指向 const char 的指针。

我在任何地方都找不到解释为什么“const pstr”会转换为“char * const”的规则。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-22T16:06:45.130

这是因为`pstr`是 的别名`char*`，当你这样做时`const pstr`有点像说`const (char*)`而不是`(const char)*`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-22T16:11:04.893

typedef 不像宏。它不只是执行简单的文本替换。typedef 定义了单个单元，附加单元`const`适用于整个事物。定义的单元是一个指针，所以应用`const`它会给你一个 const 指针。

您期望的结果将需要`const`“到达内部”`pstr`类型以应用于内部事物。在该类型中声明的指针级别越多，情况会变得更糟。考虑`typedef char*** pppstr`。要使其成为 a `char const***`，`const`必须在类型的*深处插入三层*`pppstr`。`const`不管类型定义有多复杂，规则始终适用于外部级别会更好。

# c++ - C++ 内存管理技术/实践

> ID：10705754
> 
> 赞同：12
> 
> 时间：2012-05-22T16:03:26.947
> 
> 标签：c++, memory-management

我已经用 C++ 开始了一个项目。这种语言的内存管理对我来说是新的。

我过去常常用指针创建对象，`new ()`然后传递指针，虽然它工作，但调试起来很痛苦，当人们看到代码时，他们看着我很有趣。我为它没有泄漏或段错误（一旦修复）这一事实感到非常自豪，但这确实需要付出很多努力。

```
list <struct Connection *> users;

struct Connection * accept_connection (const char *name) {
  struct Connection * new_node = new Connection ();
  new_node->_data = ... // whatever, set it up here
  return new_node;
}

struct Connection * new_user = accept_connection (const char *name);
users.append (new_user); 
```

所以我对这个项目的下一个版本有一个新的策略。到目前为止，我正在做的是创建对象`new ()`并为其分配一个唯一的整数 ID 号。然后，我使用 ID 作为键将对象存储在哈希表中。现在项目通过整数 ID 号存储和传递，当您确实需要取消引用它时，您转到哈希表，它会返回`thing *`或返回`NULL`。因此，我不再遇到指针错误，但代码的速度有所降低。

```
typedef unsigned long ID_Number;

// create a user and return the ID
ID_Number create_user () {
  ID_Number new_id = assign_unique_id ();
  struct User * node = new User ();
  node->_id = new_id;
  node->_data = ... // whatever, set it up here
  add_to_users_dict (new_id, node);
  return new_id;
}

list <ID_Number> users;

for_each (users.begin(), users.end(), process_user);

void process_user (ID_Number i) {
  struct User * u_ptr = lookup_user_dict (i);
  if (u_ptr == NULL) {
    // not found in dict
    // somehow this guy was deleted
  } else {
    // we can do stuff with this guy
  }
} 
```

现在我有点熟悉编程的基本原则，但作为一个自学成才的爱好者，我不熟悉行业实践和工具。我基本上要求的是内存管理指南：

1）我在做什么对还是错？

2）我可以使用任何可以帮助我的包或库吗？

3) 行业的标准做法是什么？

4）基本上我应该在谷歌上搜索或购买kindle等什么？

今天我通常使用 Python，它确实为我处理了很多“后端”的东西，但我需要 C 或 C++（我想我使用的是纯 C 加上 stdc++ 库，我不太确定两者之间的重叠在哪里语言是 - 我只知道 g++ 可以很好地编译它）出于速度/性能原因的这个特定项目：尽管我怀疑一些数学天才可以提供算法修复来加速它，尽管这是一个单独的问题。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-22T16:16:08.790

我能给出的最佳答案是，您不应该以传统方式使用指针。C++11 改变了程序员处理内存管理的方式。

我将提供一些链接，而不是解释比我聪明得多的人已经详细解释过的事情。

首先你应该看看 Herb Sutter 的文章[Elements of Modern C++ Style](http://herbsutter.com/elements-of-modern-c-style/) 然后看看 Bjarne Stroustrup [C++11 Style的视频](http://channel9.msdn.com/Events/GoingNative/GoingNative-2012/Keynote-Bjarne-Stroustrup-Cpp11-Style "C++11 风格")

如果您能够使用新的 C++11 标准，那么它使内存管理比以前更干净。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-22T16:17:52.643

> 我在做什么是对还是错？

您实际上创建了一个使用句柄而不是直接指针来引用对象的系统。这可能适用于某些场景。当操作系统“拥有”对象并管理其生命周期但允许客户端引用它时，操作系统通常使用句柄。

> 我可以使用任何可以帮助我的软件包或库吗？

现代 C++ 中的标准库有 shared_ptr 和 unique_ptr，它们是管理动态对象生命周期的智能指针。它们是使用 RAII 的好方法。

> 行业的标准做法是什么？

C++ 中的事实标准是 RAII——资源分配是初始化。RAII 将分配与构造函数联系起来，将分配与析构函数联系起来。由于 C++ 对 c'tors 和 d'tors 的执行方式和时间有可靠的保证，这为您提供了一种完美的方法来管理对象生命周期而不会泄漏。智能指针 shared_ptr 和 unique_ptr 也明确了对象的所有权。

> 基本上我应该用谷歌搜索或购买kindle等什么？

搜索 RAII。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-22T16:19:14.737

您的第一个错误是使用`new`.

很少需要动态内存，甚至比“直接”需要的还要少：大多数动态分配的对象都存在于容器中（如`vector`or `map`）。

您的第二个错误是不使用构造函数，一旦您了解什么是类不变量以及构造函数如何启用它们，那么您将能够利用 RAII（资源获取即初始化）并停止使用 C 进行编码。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-22T16:17:27.743

> 1）我在做什么对还是错？

您没有使用 Resource Acquisition Is Initialization (RAII) 习惯用法或现代 C++ 所有权语义。

> 2）我可以使用任何可以帮助我的包或库吗？

如果你真的需要传递指针，你可以使用 std::unique_ptr 和 std::shared_ptr。但在开始之前，您应该了解如何使您自己的对象表现为具有 RAII 语义的资源所有者。

> 3) 行业的标准做法是什么？
> 
> 4）基本上我应该在谷歌上搜索或购买kindle等什么？

RAII

# asp.net - ASP.NET 中 SSI 的替代方案

> ID：10705755
> 
> 赞同：-1
> 
> 时间：2012-05-22T16:03:29.630
> 
> 标签：asp.net, iis, ssi

这个以前问过，以后还会问！

我目前正在用 ASP.NET VB 构建一个小型企业网站（15-20 页），我不是在 Visual Studio 中构建它，而是在 Dreamweaver CS5.5 中进行布局，并且代码在手动编辑的 CodeBehind 中每页 .vb 文件。我将其中的一些链接到他们的内部 Intranet，我将在站点之后构建。所以它的CMS'ed非常少。该网站预计不会获得大量点击，它更像是一家工程公司的大型宣传册网站。

我不喜欢微软过于复杂和深不可测的 MVC 框架，并且发现他们的母版页模型限制性和复杂性。

我想做的就是在每一页的页眉和页脚中包含相同的代码，人们说 SSI 已经死了，而仇恨者是愤怒的人。

但真的......什么是SSI包含代码的一小行合适的替代品？它不大，也不聪明，但它很小而且很有效（无论如何，这是我的借口:-D）。我不是在构建谷歌！所以服务器负载根本不是问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T05:26:06.773

> 我不喜欢微软过于复杂和深不可测的 MVC 框架，并且发现他们的母版页模型限制性和复杂性。

不确定为什么您有这种**看法/假设**（或 MVC 如何等同于 SSI）....基于（仅）您的帖子，听起来即使是 Dreamweaver 库项目或模板也能满足您的需求（多年来没有使用 DW，所以如果这些是非常过时的术语，它们可能是）。

母版页可以根据需要简单或复杂 - 它们可以简单地提供页眉/正文/页脚范例或深入嵌套母版页。您也可以拥有 X 个母版页。

[如果必须](https://stackoverflow.com/q/1652103/304683)`#include`，您可以像在遥远的过去一样使用“老派” ：

```
<body>
   <!-- #include file="~/static/staticHeader.txt" -->
   <form id="form1" runat="server">
   <!-- #include file="~/static/staticHeader2.txt" --> 
```

这些将解析得很好（例如staticHeader2.txt）：

```
<h1>This is included stuff 2</h1>
<p>The date is: <%= DateTime.UTCNow.ToString("u") %></p> 
```

* * *

## 浏览器截图：

![在此处输入图像描述](../Images/49c6495da39e921ba5daf0714e4df487.png)

# silverlight - .Net WCF RIA Services 参数化 NameValue 方法崩溃

> ID：10705759
> 
> 赞同：0
> 
> 时间：2012-05-22T16:03:36.283
> 
> 标签：silverlight, wcf-ria-services, silverlight-5.0

我添加了一个 RIA 域服务方法以从表中返回两个属性的简单 NameValuePair（并根据键值进行过滤）。

它编译得很好，但每次都炸毁而没有给出有用的错误。

我错过了什么？*（可能很明显）*

## 例如：

```
 public IQueryable<NameValuePair> GetNameValues(int keyId)
    {
        // NOTE: I can breakpoint here and the correct keyId is passed
        // it blows up on returning from this method
        return from p in this.ObjectContext.NameTable
                where p.KeyId == keyId
                select new NameValuePair(p.NameValue, p.NameType);
    } 
```

## 简单*的 NameValuePair*代码：

```
public class NameValuePair
{
    [Key]
    public string Name { get; set; }
    public string Value { get; set; }

    public NameValuePair()
    {
    }

    public NameValuePair( string name, string value)
    {
        this.Name = name;
        this.Value = value;
    }
} 
```

## 更新：

我尝试在 NameValuePair 对象的静态列表上返回一个查询，并且效果很好（但没用）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T18:23:41.927

我在这里尝试了这个并得到了错误：`base {System.SystemException} = {"Only parameterless constructors and initializers are supported in LINQ to Entities."}` 所以你必须先改变它来创建对象，然后传递属性值：

```
public IQueryable<NameValuePair> GetNameValues(int keyId)
{
    return from p in this.ObjectContext.NameTable
            where p.KeyId == keyId
            select new NameValuePair {Name = p.NameValue, Value = p.NameType};
} 
```

# php - 在函数中添加 url 链接

> ID：10705760
> 
> 赞同：2
> 
> 时间：2012-05-22T16:03:36.833
> 
> 标签：php, hyperlink

这可能是一个简单的解决方法，但我对此并不陌生。我有一些来自以前的开发人员的代码，我被要求编辑发送出去的电子邮件的文本。我尝试过使用常规的 href 标签，但这不起作用。在下面的示例中是否有添加 URL 的特定方法？这是“准备开始”行。点击应该是超链接的。谢谢！！

```
function send_info_kit(){
        if($_POST):
        $to = mysql_real_escape_string($_POST['email_info']);
        $q = "INSERT INTO rog_info_requesters(`email`) VALUES('{$to}')";
        $r = mysql_query($q) or die(mysql_error());
        print $to;

        $from ='support@reachingourgoal.org';
        $name = 'Reaching Our Goal';
        $subject='Info kit you requested';
        $message=nl2br('Information on America’s best fundraising program for sports teams and 
        school groups is attached.

Finally, a modern process that generates thousands of dollars in profit and 
takes just minutes to launch.

A few reasons why www.rechingourgoal.org is the right choice:

- Takes minutes
- No selling    
- 80% Profits   
- Online tracking
- We do the work

Ready to get started now?  http://www.reachingourgoal.org"Click!

Text ROG to 9192835123\. Get clued in on amazing results and success tips.

We are helping people like you do amazing things every day.

Reaching Our Goal
www.ReachingOurGoal.org
');
        $cc='';
        $bcc='junk@reachingourgoal.org,jon@mysportsdreams.com';
        //$attach='http://www.reachingourgoal.org/assets/images/ReachingOurGoalInfoKit.pdf';
        $file = FCPATH .'/assets/images/ROGFreeInfo.pdf';

        if(file_exists($file)):
        {
            echo "File exists. Path ok: " . $file;
        }
        else:
        {
            echo "Cannot find file: " . $file;
        }
        endif;
        $this->member->send_info($to,$from,$name ,$subject,$message,$cc,$bcc,$file);
        endif;
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T16:07:25.930

```
 $message=nl2br('Information on America’s best fundraising program for sports teams and 
        school groups is attached.

Finally, a modern process that generates thousands of dollars in profit and 
takes just minutes to launch.

A few reasons why www.rechingourgoal.org is the right choice:

- Takes minutes
- No selling    
- 80% Profits   
- Online tracking
- We do the work

Ready to get started now?  <a href="http://www.reachingourgoal.org">Click!</a>

Text ROG to 9192835123\. Get clued in on amazing results and success tips.

We are helping people like you do amazing things every day.

Reaching Our Goal
www.ReachingOurGoal.org
'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T16:13:24.437

更换

```
http://www.reachingourgoal.org"Click! 
```

和

```
<a href="http://www.reachingourgoal.org">Click!</a> 
```

做这项工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-22T16:11:13.583

你可以这样做，

```
$message = 'string <a href="http://Domain.com">!click</a>' 
```

# apache-flex - 如何读取火花 TextArea 隐式换行符？

> ID：10705762
> 
> 赞同：0
> 
> 时间：2012-05-22T16:03:42.590
> 
> 标签：apache-flex, flash-builder

我有一个 TextArea，用户可以在其中输入文本并更改 TextArea 的宽度和高度。调整大小时，文本在预期的地方中断。我需要找到 TextArea 皮肤在调整大小后添加隐式换行符的位置。

**环境**

*   FlexBuilder 4.6
*   弹性 SDK 4.6.0
*   闪存播放器 11.1

**例子**

```
This is just plain text that
breaks after the word "that". 
```

当 TextArea lineBreak 属性为 toFit 并且文本没有 CR 或 LF 字符时，关于如何找到换行符位置的任何想法？在上面的示例中，它将是位置 28。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T16:34:07.780

您可以将文本拆分为行组件并轻松返回它们各自的文本长度，但您必须使用一些“文本布局框架”魔法。

*   首先访问您的 TextArea 的`textFlow`属性（不是`text`属性），它将返回一个[TextFlow](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flashx/textLayout/elements/TextFlow.html)实例。这是 TextArea 中文本的模型。
*   这个对象有一个`flowComposer`负责文本布局并携带大量信息的对象。
*   它的类型是[IFlowComposer](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flashx/textLayout/compose/IFlowComposer.html)，但您必须将其转换为[StandardFlowComposer](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flashx/textLayout/compose/StandardFlowComposer.html)才能访问各个行。
*   现在您可以访问该`lines`属性，它是[TextFlowLine的集合](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flashx/textLayout/compose/TextFlowLine.html)
*   这些行中的每一行都有一个`textLength`属性。

所以以下

```
var composer:StandardFlowComposer = 
    myTextArea.textFlow.flowComposer as StandardFlowComposer;
for each (var line:TextFlowLine in composer.lines) 
    trace(line.textLength) 
```

会产生（以你的例子）

```
29
30 
```

# javascript - HTML 输入预填充日期

> ID：10705763
> 
> 赞同：4
> 
> 时间：2012-05-22T16:03:44.210
> 
> 标签：javascript, html

很长一段时间后，我重新发现了 HTML。

我只使用 HTML 和 javascript 以及 Salesforce。我有两个日期输入字段。我很好奇是否有任何简单的方法来填充这些字段：今天的日期 B. 日期在今天之前 6 个月。

```
<input type="text" id="toDate" size="10" onmouseover="initialiseCalendar(this, 'toDate')"/> 
```

谢谢，卡尔文

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T16:11:24.000

以下 JavaScript 将`value`您的文本框设置为今天的日期，格式为 yyyy-mm-dd。看看我如何将 1 添加到月份？`getMonth()`返回当前月份的 0-11，因此添加 1：

```
var today = new Date();
document.getElementById("toDate").value = today.getFullYear() + "-" +
    parseInt(today.getMonth()+1) + "-" + ​​​​​​today.getDate();​​​​​ 
```

**演示：[小提琴](http://jsfiddle.net/Rk9PL/3)**

值得注意的是，如果月份或日期小于 10，则每个月或日只能得到一个数字。让我知道这是否是一个问题。

**编辑：**要从今天起 6 个月，请使用：

```
var today = new Date();
var past = today.setMonth(today.getMonth() - 6); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-22T16:17:36.550

填充今天的日期：

```
var today = new Date();
document.getElementById("toDate").value = today.getFullYear() + "-"
        + String(today.getMonth() + 101).slice(-2) + "-"
        + String(today.getDate() + 100).slice(-2); 
```

过去 6 个月：

```
var past = new Date();
past.setMonth(past.getMonth() - 6); //
document.getElementById("toOldDate").value = past.getFullYear() + "-"
        + String(past.getMonth() + 101).slice(-2) + "-"
        + String(past.getDate() + 100).slice(-2); 
```

# file - 如何以python方式从行号边界内的文本文件中获取文本？

> ID：10705768
> 
> 赞同：2
> 
> 时间：2012-05-22T16:04:05.643
> 
> 标签：file, parsing, text, python

我正在尝试从文本文件中获取数据。文本文件中感兴趣的行是那些一直匹配“标记 2”直到最后一个“标记 3”实例的行。可以有多个标记（重复）。我想要'Marker 2'的最小行号和'Marker 3'的最大行号-该最小值/最大值内的所有文本。虽然这可行，但我想看看如何以 Python 的方式、更高效和更少的代码来做到这一点。

为什么我必须两次打开同一个文件？否则它给了我，xreadlines 和 readlines 冲突？

**file_seeklines.py**

```
import sys

filename = sys.argv[1]

line_number = []
number = 0

## Fetch the boundary(start, end points)
f = open(filename,'r')

for line in f.xreadlines():
    number += 1
    if "marker 2" in line.strip().lower():
        line_number.append(number)
    if "marker 3" in line.strip().lower():    
        line_number.append(number)

#print line_number[0], line_number[-1]
start, end = line_number[0]-1, line_number[-1]

f.close()

## Grab the boundary 
g = open(filename,'r')

linelist = g.readlines()

try:
    for i in xrange(start, end):
        print linelist[i]
except:
    print "failed"
    pass
g.close() 
```

**文件.txt**

```
Welcome notice
------------------------
Hello there, welcome! Foo
Marker 0
hello

world

Bar
Yes!
Foo

How are ya?!

Bar

Have a great day!

Marker 1

Hello 1 2
12

MarKer 2
Hello 23
23
Marker 3
Hello 34
34

marker 2
Hello 45
45
MArker 3 
```

**输出**

```
MarKer 2

Hello 23

23

Marker 3

Hello 34

34

marker 2

Hello 45

45

MArker 3 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-22T16:11:41.917

您是否有理由不只是使用正则表达式？即`(marker 2.*marker 3)`带有`re.DOTALL`和`re.IGNORECASE`标志。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-22T16:12:24.280

如果您的文件不是很大`read()`到内存中，您可以采用正则表达式方法（利用`*`操作员贪婪的事实）：

```
import re
with open(filename, 'r') as f:
    inBetween = re.search(r"Marker 2(.*)Marker 3", f.read(), re.S | re.I).group() 
```

另一种选择是在两个方向上遍历线，分别在“标记 2”和“标记 3”的第一次出现处停止：

```
with open(filename, 'r') as f:
    lines = f.readlines
    for i in range(len(lines)):
        if "marker 2" in lines[i].lower():
            start = i
            break
    else:
        start = None

    for i in range(len(lines), -1, -1):
        if "marker 3" in lines[i].lower():
            end = i
            break
    else:
        end = None

    if None not in (start, end):
        inBetween = lines[start + 1:end]
    else:
        #one of the markers is missing, handle here. 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-22T16:11:38.947

不要使用`readlines()`but`read()`这样您就不必遍历行。

然后，您可以找到您感兴趣的部分`split()`。

例如

```
with open(filename,'r') as f:
    text = f.read().lower().split("marker 2",1)[1]
    text = text.rsplit("marker 3",1)[0]

    print('marker 2\n'+text+'marker 3') 
```

# android - 使用服务器进行应用内购买

> ID：10705771
> 
> 赞同：6
> 
> 时间：2012-05-22T16:04:09.360
> 
> 标签：android, in-app-purchase, in-app-billing

我想实现一种应用内购买机制，支持 Google 结帐和 PayPal，以便在我的一个 Android 应用中购买虚拟物品。我阅读了这些机制的两个参考资料，但我仍然有一个问题，即处理此类购买的正确方法是什么。问题是我想管理对我自己服务器的调用作为购买交易的一部分，以防该调用无法取消/回滚整个交易。如果我第一次执行购买交易并且只有在确认后才调用我自己的服务，如果它失败了我该怎么办？如果我第一次调用我的服务并且尝试处理事务并且它失败了，我需要回滚我的调用（如果回滚失败会发生什么？？？？）

管理它的正确方法是什么？有什么方法可以创建我缺少的多阶段交易吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-04T12:59:17.720

尝试使用`Google Checkout`为 InApp Billing 提供的机制而不是`PayPal`SDK，因为它是获取交易错误响应以及`RESTORE TRANSACTIONS`从设备中删除并重新安装应用程序的最佳方式。Google 在应用计费交易期间提供异步广播通知。购买类型可以分为托管（每个用户帐户）和非托管。

谷歌在此处提供信息：[在 App Billing Overview](http://developer.android.com/guide/market/billing/billing_overview.html)中，如下所示：

**1.一些应用内计费实现也可能使用私有远程服务器来交付内容或验证交易，但不需要远程服务器来实现应用内计费。**

**2\. 如果您要销售需要传送到用户设备的数字内容，例如媒体文件或照片，远程服务器会很有用。**

**3.您还可以使用远程服务器来存储用户的交易历史或执行各种应用内计费安全任务，例如签名验证。**

**4.虽然您可以在应用程序中处理所有与安全相关的任务，但建议在远程服务器上执行这些任务，因为它有助于使您的应用程序不易受到安全攻击。**

所以，最后我想向您推荐 Google InApp Billing Implementation 而不是其他第三方支付流程。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-04T08:48:07.847

如果您仍在寻找一种实施由 Google 处理的付款方式的方法，您可以**在此处找到有关如何实施 Android 电子市场应用内结算**的详细说明：

[http://developer.android.com/guide/market/billing/index.html](http://developer.android.com/guide/market/billing/index.html)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-30T23:12:43.213

我以前从未使用过 Google Checkout，只使用过 PayPal。

您可能正在寻找的是 PayPal Payments Pro SDK。

这让您的服务器成为支付交易的代言人（而不是像普通 Checkout 快递那样的 PayPal 网站）。

您需要实现两阶段提交机制。

我可以推荐两种不同的方法：

a) 您可以在您的服务器上启动购买过程，并将其留在数据库中的中间“未提交”状态。您从您的服务器调用 PayPal，以便 PP 可以处理您的呼叫，当您收到 PP 的响应时，如果响应意味着付款已被接受，则您提交购买。这种方法的问题在于，您的应用程序需要在此时决定完成或拒绝交易，而这不是现实世界购买交易的行为方式。PayPal 有时可能会响应与简单的 OK/Error 不同的响应，付款可能处于待处理状态，或者可能会出现警告。

b) 更可靠的是让 PayPal 通知您付款状态。

您可以进行与之前描述的相同的流程，但需要进行更改。一旦 PayPal 处理了付款并给您一个**肯定**的答复，您将交易 ID 存储在您的数据库中，但不提交任何内容。只告诉用户交易已经完成。

作为调用 PayPal 服务器的一部分，您可以使用一个参数，该参数称为 IPN 侦听器 URL。

**IPN 表示即时付款通知，是对您的服务器**的回调，由 PayPal 发起，您的应用程序将在其中获得有关您的付款状态的即时信息。

这非常重要，因为待处理的交易可能会被接受或拒绝。即使是已接受的交易也可能会被您或您的购买者向 PayPal 提出的索赔回滚。

如果您需要有关如何实施 PP IPN 侦听器的更多信息，请告诉我。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-07-04T10:33:05.023

AFAIK，不可能“回滚”事务。我认为 Google 的逻辑尽可能简单：如果您确实有产品（添加到开发者控制台），那么您就可以出售它。
当 Google 的市场服务告诉您 PURCHASE_STATE_CHANGED 您应该确认交易。否则应用程序将收到 PURCHASE_STATE_CHANGED 直到它未被确认，但事实是用户已经收费。而且你不能回滚这个事务。
如果你的服务器可以拒绝交易，你应该为这种情况实现额外的逻辑，例如：

*   在开始购买之前检查产品是否可用；
*   如果产品可用 - 对产品使用“预订”以确保在购买完成时它存在；
*   等等;
*   否则你应该告诉用户联系支持退款。

# php - 搜索引擎和分页

> ID：10705791
> 
> 赞同：1
> 
> 时间：2012-05-22T16:05:30.033
> 
> 标签：php

你好朋友我想知道如何在搜索引擎中添加分页。我已经尝试了很多次在搜索引擎中添加分页，但每次我都失败了。是否有人修改我的以下代码以添加分页：

**索引.php**

```
<?php include 'func.inc.php'; ?>

<html>

<head>
<title>Search</title>
</head>

<body>

<h2> Search </h2>

<form action="" method="POST">
        <p>
            <input type="text" autocomplete="off" name="keywords" /> <input type="submit" value="Search" />
        </p>
</form>
<?php
if (isset($_POST['keywords'])) {
$suffix = "";
$keywords = mysql_real_escape_string (htmlentities (trim($_POST['keywords'])));

    $errors = array();

    if (empty($keywords)) {
        $errors[] = 'Please enter a search term';
    } else if (strlen($keywords)<3) {
        $errors[] = 'Your search term must be three or more character';
    } else if (search_results($keywords) === false) {
        $errors[] = 'Your search for ' .$keywords. ' returned no result';
    }

    if (empty($errors)) {
        $results = search_results ($keywords);
        $results_num = count ($results);

        $suffix = ($results_num !=1) ? 's' : '';

        echo '<p> Your search for <strong>', $keywords,'</strong> returned <strong>',$results_num,'</strong> result',$suffix,'</p>';
        foreach($results as $result) {
            echo '<p><strong><a href="',$result['url'],'">', $result['title'],'</a></strong> <br>', $result['description'],'...<br>', $result['url'],'</p>';
            }

    } else {
    foreach ($errors as $error) {
        echo $error, '</br>';
    }
        }

    }

?>

</body>
</html> 
```

**函数.inc.php**

```
 <?php 
include 'db.inc.php'; 

function search_results($keywords) {
    $returned_results = array();
    $where ="";

    $keywords = preg_split('/[\s]+/', $keywords);
    $total_keywords = count($keywords);

    foreach ($keywords as $key=>$keyword) {
      $where .="`keywords` LIKE '%$keyword%'";
      if ($key != ($total_keywords - 1)) {
        $where .= "AND";
        }
    }

    $results = "SELECT `title`, LEFT(`description`, 70) as `description`, `url` FROM `articles` WHERE $where";
    $results_num = ($results = mysql_query($results)) ? mysql_num_rows($results): 0;

    if ($results_num === 0) {
    return false;
    } else {

    while ($results_row = mysql_fetch_assoc($results)) {
        $returned_results[] = array(
                    'title' => $results_row['title'],
                    'description' => $results_row['title'],
                    'url' => $results_row['url']

        );
    }

    return $returned_results;
}
}

?> 
```

我还有一个问题要在 Div 顶部制作一个关闭按钮以关闭自身。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T16:27:52.210

我会修改函数签名以包括页码和每页的结果数：

```
function search_results($keywords,$pagenum,$resultsperpage) { 
```

然后修改 SQL 以仅提取相关页面的结果：

```
$startresult=($pagenum-1)*$resultsperpage;
$results = "SELECT `title`, LEFT(`description`, 70) as `description`, `url` FROM `articles` WHERE $where LIMIT $startresult,$resultsperpage"; 
```

（假设您将从 开始为您的页面编号`1`）

然后，您只需要一个链接列表，让用户选择他们的页面。我通常`GET`为此使用一个变量（`searchpage.php?p=1`也许），因此您必须像使用搜索词一样对其进行清理。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-08T13:18:01.963

请不要记得喜欢

```
 <?php 
    include 'func.php'; 
    include 'config.inc.php'; 
    ?>

    <form action="" method="POST">
            <p>
                <input type="text" autocomplete="off" name="keywords" > <input type="submit" value="Search" />
            </p>
    </form>
    <?php

    $suffix = "";
    $v='';

    if(isset($_POST['keywords'])){$v=$_POST['keywords'];}
    else{
         if(isset($_GET['q'])){$v=$_GET['q'];}

        }

    $keywords = mysql_real_escape_string (htmlentities (trim($v)));

        $errors = array();

        if (empty($keywords)) {
            $errors[] = 'Please enter a search term';
        } else if (strlen($keywords)<3) {
            $errors[] = 'Your search term must be three or more character';
        } else if (search_results($keywords) === false) {
            $errors[] = 'Your search for ' .$keywords. ' returned no result';
        }
        if (!($errors)) {
            $results = search_results($keywords);

            $results_num = count ($results);
            $suffix = ($results_num !=1) ? 's' : '';

            echo '<p> Your search for <strong>', $keywords,'</strong> returned <strong>',$results_num,'</strong> result',$nom,'</p>';

            foreach($results as $result) {

                echo '<p><strong><a href="',$result['message'],'">', $result['name'],'</a></strong> <br>', $result['id'],'...<br>', $result['message'],'</p>';

                   }

    if($pages>=1 && $page<=$pages){
    for($x=1;$x<=$pages;$x++){

    echo ($x==$page) ? '<strong><a href="?page='.$x.'&q='.$v.'" >'.$x.'</a></strong> ' : '<a href="?page='.$x.'&q='.$v.'" >'.$x.'</a> ';
     }
    }
         } else {
        foreach ($errors as $error) {
            echo $error, '</br>';
        }
            }   
    ?> 
```

函数.in.php

```
 <?php 

    function search_results($keywords) {
    global $page,$start,$pages_query,$per_page,$pages,$returned_results,$total_keywords,$nom;
        $returned_results = array();
        $where ="";

        $keywords = preg_split('/[\s]+/', $keywords);
        $total_keywords = count($keywords);

        foreach ($keywords as $key=>$keyword) {
          $where .="`message` LIKE '%$keyword%'";
          if ($key != ($total_keywords - 1)) {
            $where .= "AND";
            }
        }

    $per_page=6;
    $pages_query = mysql_query(' SELECT COUNT(`id`) FROM `paginate` ') or die(mysql_error());

    //$pages=ceil(mysql_result($pages_query,0) / $per_page);

        $resultt = "SELECT * FROM paginate WHERE $where  ";
        $queryt =mysql_query($resultt) ;
        $nom=mysql_num_rows($queryt);
    $pages=ceil($nom / $per_page);    

    $page= (isset($_GET['page'])) ? (int)$_GET['page'] :1;

    $start=($page - 1) * $per_page;

        $results = "SELECT * FROM paginate WHERE $where LIMIT $start,$per_page ";
        $results_num = ($results = mysql_query($results)) ? mysql_num_rows($results): 0;

        if ($results_num === 0) {
        return false;
        } else {

        while ($results_row = mysql_fetch_assoc($results)) {
            $returned_results[] = array(
                        'id' => $results_row['id'],
                        'name' => $results_row['name'],
                        'message' => $results_row['message']

            );
        }

        return $returned_results;
    }
    }

    ?> 
```

# extjs - 在依赖于 2 个其他字段 extjs 的模型上创建字段

> ID：10705797
> 
> 赞同：2
> 
> 时间：2012-05-22T16:06:06.487
> 
> 标签：extjs

是否可以根据返回的内容在模型中创建字段定义？我想创建一个由其他 2 个字段组成的字段。

我目前正在做的是加载商店，然后处理每条记录并设置数据。不过，这感觉有点不雅：

```
Ext.define("moddie", {
    extend:'Ext.data.Model',
    config:{
        fields     : [
            "id",
            "move",
            "moveId"
        ]
    }
});

Ext.create('Ext.data.Store',{
    model:'moddie',
    proxy:{
        type:'ajax',
        url: 'json.json',
        reader: {
                type: 'json',
            }
        },
    },  
    config:{
        listeners:{
            load:{
                fn  : function(s,r,o){
                s.each(function(record){
                    record.set(moveId,id+move)
                }
            }
        }
    }
}) 
```

我想将该字段定义为模型的 concat -INSIDE-。就像是：

```
Ext.define("moddie", {
    extend:'Ext.data.Model',
    config:{
        fields     : [
            "id",
            "move",
                    {name:"moveId",value:id+move}//can I, how should I define this?
        ]
    }
}); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-22T16:52:01.910

绝对地。

```
Ext.define("moddie", {
    extend:'Ext.data.Model',
    fields: [
        { name: 'id' }, 
        { name: 'move' }, 
        { name: 'moveId', convert: function(v, r) {
           return r.get('id') + r.get('move');
        }}, 
    ]
}); 
```

# iphone - Gridview for XML 与 iOS 中的图片

> ID：10705798
> 
> 赞同：0
> 
> 时间：2012-05-22T16:06:10.050
> 
> 标签：iphone, ios, xml, uitableview, gridview

我正在构建一个 iPhone 应用程序，我希望能够拥有从 XML 文件加载的图像库。xml 仅包含图像的名称，以及每个图像的链接作为加载图像的确切 URL。我查看了一些不同的示例，例如[https://github.com/AlanQuatermain/AQGridView](https://github.com/AlanQuatermain/AQGridView) ，但是在自定义它以供我使用时遇到了很多问题。对于我想要解析 XML（我的代码所做的）和为每篇文章创建“缩略图”的简单事情，我提供的链接似乎太深入了，用“链接”类别中提供的图像填充该缩略图的 XML。有人可以帮我一点吗？我正在使用 ASIHTTPREQUEST 和 GDATAXML 库来解析我的 XML，如 Ray Wenderlich 的解析教程中所示。

编辑：查看内容，我想我可以创建一个自定义单元格，并且在自定义单元格中只有一个 UIImageView，但是我将如何编写代码以便我可以在单元格中拥有大约 4 列图片，并让它加载每个人的照片都不一样？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T17:14:14.477

如果您想要一个简单的解决方案，请查看[https://github.com/kirbyt/KTP​​hotoBrowser](https://github.com/kirbyt/KTPhotoBrowser)

它通过使用您定义的数据源来工作。这些可以是图像或只是 URL。然后它会去获取 URL 并显示图像。与使用简单 UITableView 的方式相比，它还可以更轻松地选择单个图像。

查看包含的样本，它应该符合您的目的。

# c# - 根据txt文件中的格式类型/绘图数据处理字符串的任何方法？

> ID：10705805
> 
> 赞同：0
> 
> 时间：2012-05-22T16:06:32.967
> 
> 标签：c#, asp.net, plot, string-formatting

正在将制表符分隔的 txt 文件逐行读取到字符串列表中。目的是使用字符串的格式类型（如日期时间或浮点数或字符串等）处理字符串的每个单词？以便绘制数据。有没有其他有效的方法来做到这一点？

```
 using (StreamReader file = new StreamReader(@"C:\Users\\Desktop\snpprivatesellerlist.txt"))
 {
   while ((line = file.ReadLine()) != null)
   {
     char[] delimiters = new char[] { '\n' };
     string[] parts = line.Split(delimiters, StringSplitOptions.RemoveEmptyEntries);
     for (int i = 0; i < parts.Length; i++)
     {
       st = parts[i];

       // process the line - if part[i] is date time - do something ()
       //                      if part[i] is a float - do something else()

     }
   }
 } 
```

任何帮助和见解表示赞赏。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T16:23:02.427

我建议使用 TryParse，就像这样......

```
string line;
using (StreamReader file = new StreamReader(@"C:\Users\Desktop\snpprivatesellerlist.txt"))
{
    while ((line = file.ReadLine()) != null)
    {
        string st;
        DateTime dtPart;
        float flPart;
        char[] delimiters = new char[] { '\n' };
        string[] parts = line.Split(delimiters, StringSplitOptions.RemoveEmptyEntries);
        for (int i = 0; i < parts.Length; i++)
        {
            st = parts[i];

            if (DateTime.TryParse(st, out dtPart))//Is of type DateTime
            {
                //Do something with DateTime dtPart
            }
            else if (float.TryParse(st, out flPart))//Is of type float
            {
                //Do something with float flPart
            }
            else//Can be considered a string
            {
                //Do something with string st
            }
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T13:14:09.907

## 如果您的制表符分隔文件中的字段始终属于同一类型，并且字段数是固定的。

然后你可以创建一个结构类来存储每一行​​的值。

```
class LineData
{    
    public float a {get; set;}
    public DateTime b {get; set;}    
} 
```

在方法实现中（即在 中`while`）：

```
string[] parts = line.Split(delimiters, StringSplitOptions.RemoveEmptyEntries);   
//You know 1st column is float, 2nd column is datetime
var dt = new LineData();
float.TryParse(parts[0], out dt.a);
DateTime.TryParse(parts[1], out dt.b);

//...
//store dt in a list/array. (not shown here) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-23T13:33:28.667

有点解决我的问题的代码 - 但我仍在工作。

```
 using (StreamReader file = new StreamReader(@"C:\Users\Desktop\snpprivatesellerlist.txt"))
        {
            while ((line = file.ReadLine()) != null)
            {
                char[] delimiter1 = new char[] { '\n' };
                string[] part1 = line.Split(delimiter1, StringSplitOptions.RemoveEmptyEntries);

                for (int i = 0; i < part1.Length; i++)
                {
                    sepList.Add(part1[i]);     
                    //st = part1[i];                       
                }

            }
            file.Close();
        }

        char[] delimiter2 = new char[] { '\t' };
        for (int j = 4; j < sepList.Count; j++)
        {
            st = sepList[j];
            string[] part2 = st.Split(delimiter2, StringSplitOptions.RemoveEmptyEntries);
            alist.Add(part2);             
        }

        //DateTime time = new DateTime();
        //float value = new float();

        string tagname = alist[0][0];
        for (int y = 0; y < alist.Count; y++)
        {
             if (alist[y][0]==tagname)
            {
                      alist1.Add(alist[y]);
            }
             else
             {
                SensorProbeDataContainer sensorprobe = new SensorProbeDataContainer();
                sensorprobe.Setdata(templist);                   
                sensorprobe.SensorProbe = sensorprobe.data[0][0];
                ProbeList.Add(sensorprobe.SensorProbe);
                DateTime.TryParse(sensorprobe.data[0][2], out sensorprobe.StartDate);
                DateTime.TryParse(sensorprobe.data[(sensorprobe.data.Count - 1)][2], out sensorprobe.EndDate);
                classcontainer.Add(sensorprobe);
                tagname = alist[y][0];
                templist.Clear();                 }

        } 
```

我试图在这个线程上关注它 - [https://stackoverflow.com/questions/10719396/iterating-separating-list-of-string-arrays-based-on-first-element](https://stackoverflow.com/questions/10719396/iterating-separating-list-of-string-arrays-based-on-first-element)

谢谢大家的帮助。如果您发现代码中有任何错误，请指出。

# c# - 将文本框值保存在注册表中

> ID：10705806
> 
> 赞同：13
> 
> 时间：2012-05-22T16:06:33.340
> 
> 标签：c#, winforms, registry, read-write

我需要一些指导来读取/写入/保存注册表中的值。我对在注册表中保存东西的概念不熟悉

我有一个 Winform，我必须在其中读取/写入 App.config 文件并使用 winform 更改用户名和密码。在我的 winform 中，我有 2 个文本框，当我输入值并点击提交时，它会更改 app.config 中的值.我以某种方式做到了，没有问题。

现在我需要将我在文本框中输入的任何值发送到注册表并保存它们，我也应该能够读取它们。

我该怎么做？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-05-22T16:11:05.990

`using Microsoft.Win32;`

来写：

```
Registry.SetValue(@"HKEY_LOCAL_MACHINE\SOFTWARE\MyProgram", "Username", "User1"); 
```

读书：

```
string username = Registry.GetValue(@"HKEY_LOCAL_MACHINE\SOFTWARE\MyProgram",
                                    "Username", "NULL").ToString(); 
```

在我放的地方阅读`NULL`- 如果您正在寻找的值不存在，那就是要返回的值。

所以如果你这样做了：

```
if(username == "NULL")
{
    // it doesn't exist, handle situation here
} 
```

希望这可以帮助。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-05-22T16:45:17.847

这是一个快速代码：

```
private void button1_Click(object sender, EventArgs e)
{
    Microsoft.Win32.RegistryKey exampleRegistryKey = Microsoft.Win32.Registry.CurrentUser.CreateSubKey("ExampleTest");
    exampleRegistryKey.SetValue("Name", textBox1.Text);
    exampleRegistryKey.Close();
} 
```

现在如果你运行 regedit 并且必须在下面看到`HKEY_CURRENT_USER\ExampleTest`

# c# - 交叉应用 - LINQ to Objects

> ID：10705807
> 
> 赞同：2
> 
> 时间：2012-05-22T16:06:35.133
> 
> 标签：c#, linq, linq-to-objects, cross-apply

在 T-SQL 中，您可以使用`CROSS APPLY`从语句中获取表左右之间所有可能的变化。现在我遇到了以下情况`C#`，我希望有一种方法可以使用 LINQ-to-Objects 来解决我的问题。

我有一个包含`TestData`对象的列表（如下所示），它类似于`KeyValuePair<string, object>`对象（只是一个`Key`和一个`Value`属性）：键可以是所有内容，并且可以有多个具有相同键的对象。

```
IList<KeyValuePair<String, Object>> objects;
// Content of list
// # | Key  | Value
// 1 | "A"  | 1
// 2 | "A"  | 2
// 3 | "A"  | 3
// 4 | "B"  | 4
// 5 | "B"  | 5
// 6 | "C"  | 6
// 7 | "D"  | 7
// 8 | "D"  | 8 
```

我还有一个请求的密钥列表：

```
IList<String> requestedKeys = new List<string>() { "A", "D" }; 
```

现在我想在`requestedKeys`列表中的键之间拥有 KeyValuePair 对象的所有可能组合。

```
IList<IList<KeyValuePair<String, Object>>> result = ...
// Content of 'result' will be in this example 6 lists with each 2 KeyValuePair objects
// #  | "A" | "D" | (If there are more in the requestedKey list then there are more KeyValuePair items in the innerlist.)
// 1  |  1  |  7  |
// 2  |  2  |  7  |
// 3  |  3  |  7  |
// 4  |  1  |  8  |
// 5  |  2  |  8  |
// 6  |  3  |  8  | 
```

是否可以使用 LINQ-to-Objects 解决我的问题。如果不是，你能告诉我最有效的构建方法吗？

* * *

**编辑 1：**
为了更清楚结果应该是什么：
我想要一个类似这样的 LINQ-to-Objects 查询：
@Joanna 感谢关于多个`from`s 的提示，但问题是：使用这种语法，你不能有一个动态的`from`s 的数量 就我而言，我需要与列表`from`中的项目一样多的 s`requestedKeys`

```
var result =    
   from listA in objects.Where(m => m.Key == "A")
   from listD in objects.Where(m => m.Key == "D")
   // from .....
   // from .....
   // overhere as many froms as items in 'requestedKeys' list   
select new [] { listA, listD /*, All other lists */ } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T16:54:19.527

这些方面的东西应该起作用：

```
var filtered = objects
        .Where(o => requestedKeys.Contains(o.Key));

var crossJoined = from el1 in filtered
                    from el2 in filtered
                    select new [] {el1, el2}; 
```

交叉连接是通过链接多个`from`子句来实现的。

**编辑：**

在这种情况下，我想不出比您在编辑中开始的更简单的方法。唯一缺少的是选择值：

```
var result =    
   from listA in objects.Where(m => m.Key == "A").Select(m => m.Value)
   from listD in objects.Where(m => m.Key == "D").Select(m => m.Value)
   // from .....
   // from .....
   // overhere as many froms as items in 'requestedKeys' list  
select new [] { listA, listD /*, All other lists */ } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T12:45:33.370

我自己找到了解决方案：

这是 LINQ 中非常复杂的连接，因为 requestKeys 列表中的每个项目都需要额外的交叉连接。对于给定的示例列表，结果应该是`objects.Count(m => m.Key == "A") * objects.Count(m => m.Key == "D")`（结果为 3 * 2 = 6）。列表中的每个额外项目都会导致整个结果集的额外倍增。

所以这是结果：

```
// The result list
IEnumerable<IList<KeyValuePair<char, int>>> result;

// If there are no requestedKeys there is no result expected
if(requestedKeys.Count() > 0)
{
    // Loop through all request keys to cross join them together
    foreach (var key in requestedKeys)
    {
        if (result == null)
        {
            // First time the innerlist List<KeyValuePair<char, int>> will contain 1 item
            // Don't forget to use ToList() otherwise the expression will be executed to late.
            result = objects.Where(m => m.Key == key).Select(m => new List<KeyValuePair<char, int>>() { m }).ToList();
        }
        else
        {
            // Except for the first time the next subresult will be cross joined
            var subresult = objects.Where(m => m.Key == key).Select(m => new List<KeyValuePair<char, int>>() { m });
            result = result.Join(
                subresult,
                l1 => 0, // This and the next parameter does the cross join trick
                l2 => 0, // This and the previous parameter does the cross join trick
                (l1, l2) => l1.Concat(l2).ToList() // Concat both lists which causes previous list plus one new added item
                ).ToList(); // Again don't forget to 'materialize' (I don't know it is called materialization in LINQ-to-Objects 
                            // but it has simular behaviors because the expression needs to be executed right away)
        }
    }           
}
return result; 
```

不幸的是，它并不完全是 LINQ，所以如果有人知道更好的解决方案。请评论我或回答我的问题:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-01-15T09:54:44.467

用户以这种方式可以生成 sql 交叉应用：

```
 var comments = AppCommentRepository.Where(com => com.iAction > -1 && productIds.Contains(com.sProductId))
            .GroupBy(c => c.sProductId)
            .SelectMany(p => p.OrderByDescending(cc => cc.dAddTime).Take(commentNum)).ToList(); 
```

最后，sql是：

```
 SELECT [t3].[iCommentId], .....FROM (
        SELECT [t0].[sProductId]
        FROM [dbo].[App_Comment] AS [t0]
        WHERE ([t0].[iAction] > -1) --AND ([t0].[sProductId] IN (@p1))
           GROUP BY [t0].[sProductId]
        ) AS [t1]
CROSS APPLY (
    SELECT TOP (2) [t2].[iCommentId],......
    FROM [dbo].[App_Comment] AS [t2]
    WHERE ([t1].[sProductId] = [t2].[sProductId]) AND ([t2].[iAction] > -1)
-- AND ([t2].sProductId] IN (@p1))
    ORDER BY [t2].[dAddTime] DESC
    ) AS [t3]
ORDER BY [t3].sProductId DESC 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-11-12T16:38:48.917

```
objects
.Join(requestedKeys, o => o.Key, rk => rk, (o, rk) => o)
.SelectMany(o => requestedKeys.Select(k => new {Key = k, Value = o.Value})); 
```

# jquery - IE9 在模式弹出窗口中不显示 jQuery append()

> ID：10705808
> 
> 赞同：0
> 
> 时间：2012-05-22T16:06:35.557
> 
> 标签：jquery, jquery-plugins, internet-explorer-9, modalpopup

使用来自 www.zurb.com 的 jQuery Reveal 插件

html:

```
<div>
    <a href="#" data-reveal-id="myModal">Click Me For A Modal</a>
</div>
abov div
<div id="myModal" class="reveal-modal">
    <h1>Modal Title</h1>
    <p>Any content could go in here.</p>
    <asp:Label ID="lbl_modalTest" runat="server" ></asp:Label>
    <a class="close-reveal-modal">&#215;</a>
</div> 
```

CSS：

```
 .reveal-modal-bg { 
    position: fixed; 
    height: 100%;
    width: 100%;
    background: #000;
    background: rgba(0,0,0,.8);
    z-index: 100;
    display: none;
    top: 0;
    left: 0; 
    }

.reveal-modal {
    visibility: hidden;
    top: 100px; 
    left: 50%;
    margin-left: -300px;
    width: 520px;
    background: #eee url(modal-gloss.png) no-repeat -200px -80px;
    position: absolute;
    z-index: 101;
    padding: 30px 40px 34px;
    -moz-border-radius: 5px;
    -webkit-border-radius: 5px;
    border-radius: 5px;
    -moz-box-shadow: 0 0 10px rgba(0,0,0,.4);
    -webkit-box-shadow: 0 0 10px rgba(0,0,0,.4);
    -box-shadow: 0 0 10px rgba(0,0,0,.4);
    }

.reveal-modal.small         { width: 200px; margin-left: -140px;}
.reveal-modal.medium        { width: 400px; margin-left: -240px;}
.reveal-modal.large         { width: 600px; margin-left: -340px;}
.reveal-modal.xlarge        { width: 800px; margin-left: -440px;}

.reveal-modal .close-reveal-modal {
    font-size: 22px;
    line-height: .5;
    position: absolute;
    top: 8px;
    right: 11px;
    color: #aaa;
    text-shadow: 0 -1px 1px rbga(0,0,0,.6);
    font-weight: bold;
    cursor: pointer;
    } 
```

jQuery：

```
$('a[data-reveal-id]').live('click', function (e) {
    e.preventDefault();
    var modalLocation = $(this).attr('data-reveal-id');
    var page = $(this).attr('href');
    var div = ('#' + modalLocation);
    $(div).append('<div><iframe style="border: 0px; " src="www.google.com" width="100%" height="100%"></iframe></div>');
    $(div).reveal($(this).data());
}); 
```

在 FF 和 Chrome 中运行良好，但在 IE9 中不行。

在 IE9 中，当您第一次单击按钮以显示模式弹出窗口时，它会按预期弹出，但仅显示 div 的原始内容而不是附加的 iframe。但是，如果您关闭模式弹出窗口并再次单击该按钮，它会在模式内显示两个 iframe。因为它只是附加，所以在第二次点击时我希望看到两个 iframe 但为什么 IE9 在第一次点击时不会显示一个 iframe？

# python - TypeError：'module'对象在我关于python模块的简单程序中不可调用

> ID：10705811
> 
> 赞同：2
> 
> 时间：2012-05-22T16:06:46.850
> 
> 标签：python, typeerror, python-import, python-module

这是我的 Python 模块：

```
main.py
fib/
    __init__.py
    fib.py
    hello.py 
```

`fib.py`定义函数`fib()`，`hello.py`定义函数`hello()`。

`main.py`是

```
from fib import *
hello() 
```

`__init__.py`是

```
__all__ = ["fib", "hello"] 
```

我写这段代码只是为了练习。不是为了工作

我运行`main.py`它打印：

```
Traceback (most recent call last):
  File "tes.py", line 5, in <module>
    hello()
TypeError: 'module' object is not callable 
```

为什么？我有清单你好`__all__`

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-22T16:10:27.653

您已经`hello`使用该行导入了模块`from fib import *`，但您没有引用该`hello`模块中的函数。

改为这样做：

```
from fib import *
hello.hello() 
```

或这个：

```
from fib.hello import *
hello() 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-22T16:10:39.597

您正在导入模块，而不是方法。你可能需要做`hello.hello()`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-22T16:11:09.450

这是因为您导入了模块但没有在其中发挥作用，您可以尝试：

```
hello.hello() 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-22T16:35:26.783

如果您想`hello()`在使用 only 后访问`from fib import *`，则应将`__init__.py`文件替换为：

```
from hello import hello
from fib import fib

__all__ = ['fib', 'hello'] 
```

这会将`fib`and`hello`函数导入顶级`fib`模块。这样，当您调用 时`from fib import *`，该**函数** `hello()`将位于您的命名空间中，而不是您当前实现 的**模块中。** `hello`

# facebook - Facebook 分享按钮与 Facebook JSSDK 冲突。如何解决？

> ID：10705812
> 
> 赞同：0
> 
> 时间：2012-05-22T16:06:47.030
> 
> 标签：facebook

我似乎无法让两个脚本都工作。我正在使用 jssdk 和 fb.share 来获取 facebook like box 和 facebook 分享按钮。但他们不能一起工作。知道为什么吗？如何解决这个问题？

我在标题中有这个：

```
<div id="fb-root"></div> 
```

页脚中的这段代码：

```
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script> 
```

这是我的 Fb.share 代码：

```
 <div class="shr-fb">
        <a name="fb_share"></a>
        <script src="http://static.ak.fbcdn.net/connect.php/js/FB.Share" type="text/javascript"></script>
    </div> 
```

他们互相冲突，我不知道如何解决这种情况。

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T16:28:33.900

说得通。facebook 共享已弃用且不再受支持，您可以在文档中阅读：

> Share 按钮已被弃用，取而代之的是 Like 按钮，并且将不再受支持。请尽可能使用“赞”按钮为您的应用带来最大流量。

（参考：http: [//developers.facebook.com/docs/share/](http://developers.facebook.com/docs/share/)）

和：

> **旧的“分享”按钮怎么了？**
> 
> 当我们启动“赞”按钮时，我们弃用了“分享”按钮，因为“赞”按钮允许用户一键连接，并允许他们查看他们的哪些朋友已经连接，从而提高了点击率。

（参考：http: [//developers.facebook.com/docs/reference/plugins/like/](http://developers.facebook.com/docs/reference/plugins/like/)）

相反，使用[Like 按钮](http://developers.facebook.com/docs/reference/plugins/like/)，您不会遇到冲突。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-08-17T09:48:45.673

同时，您仍然可以将 Like 和 Share 按钮与 FaceBook JSSDK Api 和 html 片段结合在一起；

```
<div class="fb-like" data-share="true" data-width="450" data-show-faces="true">
</div> 
```

它将根据需要显示“喜欢”和“分享”按钮。

# java - 如何编写 Eclipse 插件来隐藏记录器语句

> ID：10705814
> 
> 赞同：5
> 
> 时间：2012-05-22T16:06:56.363
> 
> 标签：java, eclipse, eclipse-plugin

我在代码中有很多记录器语句，这使得它难以阅读。我怎样才能隐藏这些陈述？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T16:10:02.300

为什么不直接更改应用程序记录器配置文件中的日志级别？我怀疑您会发现一个 Eclipse 插件作为控制台输出纯文本，并且该插件不知道您的记录器如何格式化该文本。

# mysql - 具有数百万行的数据库的有效索引

> ID：10705815
> 
> 赞同：1
> 
> 时间：2012-05-22T16:06:57.117
> 
> 标签：mysql, database-design, indexing

我有一个 MISAM MySQL DB 表，里面有数百万行，我被要求使用它，但我需要先使查询速度更快。

以前根本没有索引！我在 'type' 列上添加了一个新索引，这很有帮助，但我想知道是否还有其他列可能也是最好的索引？

这是我的创建表：

```
CREATE TABLE `clicks` (
`id` int(11) NOT NULL AUTO_INCREMENT,
`companyid` int(11) DEFAULT '0',
`type` varchar(32) NOT NULL DEFAULT '',
`contextid` int(11) NOT NULL DEFAULT '0',
`period` varchar(16) NOT NULL DEFAULT '',
`timestamp` int(11) NOT NULL DEFAULT '0',
`location` varchar(32) NOT NULL DEFAULT '',
`ip` varchar(32) DEFAULT NULL,
`useragent` varchar(64) DEFAULT NULL,
PRIMARY KEY (`id`),
KEY `companyid` (`companyid`,`type`,`period`),
KEY `type` (`type`)
) ENGINE=MyISAM DEFAULT CHARSET=latin1; 
```

典型的 SELECT 语句通常会按`companyid`,`type`和`contextid`列进行过滤。

例如：

```
SELECT period, count(period) as count FROM clicks WHERE contextid in (123) AND timestamp > 123123123 GROUP BY period ORDER BY timestamp ASC 
```

或者

```
SELECT period, count(period) as count FROM clicks WHERE contextid in (123) AND type IN('direct') AND timestamp > 123123123 GROUP BY period ORDER BY timestamp ASC 
```

我的问题的最后一部分是这样的：当我在上面添加索引时`type`大约需要 1 小时 - 如果我要添加或删除多个索引，你可以在一个查询中完成，还是必须一个接一个地完成并等待为每个完成？

谢谢你的想法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T16:18:21.417

索引确实很强大，但并不像你想象的那么黑。了解 MySQL 的 EXPLAIN PLAN 功能，这将帮助您*系统地*找到可以改进的地方：

[http://dev.mysql.com/doc/refman/5.5/en/execution-plan-information.html](http://dev.mysql.com/doc/refman/5.5/en/execution-plan-information.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T16:19:11.520

要添加哪些索引实际上取决于您的查询。您正在排序（GROUP BY）或选择（WHERE）的任何内容都是索引的良好候选者。

您可能还想看看[Mysql 如何使用索引](http://dev.mysql.com/doc/refman/5.0/en/mysql-indexes.html)。

至于添加索引的时间，如果你确定要添加多个索引，你可以做mysqldump，手动编辑.sql文件中的表结构，然后重新导入。这可能需要一段时间，但至少您可以一次完成所有更改。然而，这并不真正符合随手测试的想法......所以请谨慎使用这种方法。（我在修改多个具有相同结构的表并希望为所有表添加一些索引时已经这样做了。）

另外，我不是 100% 确定，但我认为当您添加索引时，Mysql 会使用索引创建表的副本，然后删除原始表 - 所以请确保您的服务器/分区上有足够的空间对于表格的当前大小和一些边距。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-22T16:11:49.900

在我看来`timestamp`，`period`可以在`WHERE`子句中使用它们时对其进行索引。

也代替使用`contextid in (123)`使用`contextid = 123`和代替`type IN('direct')`使用`type = 'direct'`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-22T16:43:05.283

您可以在单个查询中添加多个索引。这将总体上节省一些时间，但是在您等待整个查询完成时，该表将无法访问：

```
ALTER TABLE table1 ADD INDEX `Index1`('col1'),
 ADD INDEX `Index2`('col2') 
```

关于[索引](http://dev.mysql.com/doc/refman/5.5/en/mysql-indexes.html)，这是一个复杂的主题。但是，在 WHERE 子句中包含的具有高基数的单个列上添加索引是一个不错的起点。MySQL 将尝试为查询选择最佳索引并使用它。

为了进一步调整性能，您应该考虑[multi-column indices](http://dev.mysql.com/doc/refman/5.0/en/multiple-column-indexes.html)，我看到您已经使用“companyid”索引实现了它。

为了能够一直使用到[GROUP BY](http://dev.mysql.com/doc/refman/5.5/en/group-by-optimization.html)或[ORDER BY](http://dev.mysql.com/doc/refman/5.5/en/order-by-optimization.html)子句的索引，您可能需要了解很多条件。

为了最好地利用索引，您的数据库服务器必须有足够的 RAM 来将索引完全存储在内存中，并且必须正确配置服务器以实际利用内存。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-22T16:14:02.100

这是您的一个查询，分多行，因此更易于阅读。

```
SELECT period, count(period) as count 
FROM clicks 
WHERE contextid in (123) 
AND timestamp > 123123123 
GROUP BY period 
ORDER BY timestamp ASC 
```

我什至不确定这是一个有效的查询。我认为您的 GROUP BY 和 ORDER BY 必须在 SQL 中匹配。我认为您必须订购`count`，因为 GROUP BY 将订购`period`。

优化查询的重要部分是 WHERE 子句。在这种情况下，索引`contextid`和`timestamp`会加快查询速度。

显然，您不能索引每个 WHERE 子句。您索引最常见的 WHERE 子句。

我会一次向现有表添加一个索引。是的，它很慢。但是您应该只需要添加一次索引。

# c# - GetHashCode() 与 ^

> ID：10705816
> 
> 赞同：8
> 
> 时间：2012-05-22T16:06:57.287
> 
> 标签：c#, c#-4.0

`GetHashCode()`当函数使用 code which 返回某些东西时，它有什么特殊含义`contains ^ symbol`吗？

```
public class ClassProp
{
    public int Prop1 { get; set; }
    public int Prop2 { get; set; }
    public int Prop3 { get; set; }
    public int Prop4 { get; set; }
    public int Prop5 { get; set; }

    public override int GetHashCode()
    {
        return Prop1.GetHashCode() ^ Prop2.GetHashCode() ^ 
               Prop3.GetHashCode() ^ Prop4.GetHashCode() ^ Prop5.GetHashCode();
    }
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-22T16:08:04.913

`^`是 C# [XOR 运算符](http://msdn.microsoft.com/en-us/library/zkacc7k1%28v=vs.71%29.aspx)。没什么特别的，只是所有类属性的哈希码都是 XOR 在一起的。

**编辑**：`GetHashCode`返回一个通用代码，用作复杂对象的速记标识符。当您想要存储对象然后根据它们的散列码快速检索它们时，一个常见的用途是散列数据结构。假设一个类`Person`和一些具有相应哈希码的对象：

```
Alex 8540
John 9435
Peter 2453 
```

这些代码是基于每个对象的部分或全部字段生成的，并且必须尽可能少地发生冲突以确保有效的散列。现在我们可以使用哈希码将对象存储在哈希表中：

```
Entries
0 -> Alex
1 -> John
2 -> Peter 
```

对象存储在表中，使用它们各自的哈希码来确定位置。接下来，可以使用相同的哈希码轻松检索它们。

我建议你找到一些关于哈希表如何工作的文献，因为在 SO 帖子中解释起来有点太多了。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-22T16:07:54.160

这只是[按位异或运算符](http://msdn.microsoft.com/en-us/library/zkacc7k1.aspx)。它通常用于将来自不同对象的哈希码组合成一个整体的哈希码。

这不是在 Google 上搜索的最简单的事情之一！搜索此类内容时，我的提示是查看[所有运算符的表](http://msdn.microsoft.com/en-us/library/6a71f45d.aspx)。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-22T16:12:33.673

这就是[bitwize XOR 运算符](http://msdn.microsoft.com/en-us/library/zkacc7k1.aspx)。

这是实现时非常常用的运算符`GetHashCode`。

话虽如此，在这种情况下，这种实现可能并不理想。使用 XOR（单独）的问题在于您不一定会减少发生冲突的机会。问题是这样定义的类：

```
class Foo
{
    public int Bar { get; set; }
    public int Baz { get; set; }

    // ...
    public override int GetHashCode()
    {  return this.Bar.GetHashCode() ^ this.Baz.GetHashCode(); }
} 
```

将在 Bar==2 和 Baz==4 时创建与 Bar==4 和 Baz==2 时相同的哈希码。根据用例，这可能会导致更多的哈希冲突，因此在实现 GetHashCode 时需要注意这一点。另外 - 当您制作这样的可变类型时，您应该非常小心，您的哈希码实现与您的相等检查等相匹配。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-22T16:09:45.770

按位异或运算符的工作原理如下：

A = 10111 B = 01010

A ^ B = 11101

不同的对应位结果为1，相似的位结果为0。

在您的情况下，这些整数首先被转换为二进制，然后如上例所示进行处理。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-22T16:08:42.547

`^`如果 C# 中的 XOR 运算符请参见此处：http: [//msdn.microsoft.com/en-us/library/zkacc7k1.aspx](http://msdn.microsoft.com/en-us/library/zkacc7k1.aspx)

您所做的所有示例都是从其属性中对哈希码进行异或运算。

# asp.net - 完全 posrback 后在部分 postback 中重新生成 JS 函数

> ID：10705832
> 
> 赞同：0
> 
> 时间：2012-05-22T16:07:44.723
> 
> 标签：asp.net, asynchronous, updatepanel, registerstartupscript

我的服务器端 ASP.NET 代码使用 ClientScript.RegisterStartupScript 在初始页面加载时生成一个 JS 函数（实际函数，例如*函数 Foo() {...} ）。*该函数成为 ASPX 标记的一部分，并在客户端调用它时执行。

问题是：我需要在服务器端部分回发（更新面板）中修改该函数的代码。但是，当我通过 ScriptManager.RegisterStartupScript 生成具有相同名称的*函数 Foo() {...}*时，它似乎没有生效 - 在 PageLoad 的 ClientScript.RegisterStartupScript 中生成的原始函数被调用。

在初始页面加载时生成部分回发后，有什么方法可以在部分回发中重新生成客户端功能？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T14:23:08.337

在我对这个问题的第一条评论中回答了。

# java - Geocoder.getFromLocationName 方法出错

> ID：10705835
> 
> 赞同：0
> 
> 时间：2012-05-22T16:08:09.643
> 
> 标签：java, android, google-maps, latitude-longitude, google-geocoder

我正在尝试使用地理编码通过传递街道地址来获取给定地点的纬度/经度。这是我的代码：

```
 String addr = "Shop No. 2, Payal Cinema, Old Delhi Road, Sec-14, Gurgaon";                             
 Geocoder geocoder= new Geocoder(this, Locale.getDefault());
 List<Address> addressList = null;
 try {

          addressList = geocoder.getFromLocationName(addr, 10);

     } catch (IOException e) {}
 Address address = addressList.get(0);
 if(address.hasLatitude() && address.hasLongitude()){
 lat = address.getLatitude();
 lon = address.getLongitude();
 } 
```

错误出现在对 gecoder.getFromLocationName(addr,10) 的调用中（我通过 System.out.println 进行了检查；在该行之后没有将内容打印到 logcat）

这是来自 LogCat 的堆栈跟踪：

```
 W/dalvikvm(630): threadid=1: thread exiting with uncaught exception (group=0x409c01f8)
 E/AndroidRuntime(630): FATAL EXCEPTION: main
 E/AndroidRuntime(630): java.lang.RuntimeException: Unable to start activity ComponentInfo{apt.kangkan/apt.kangkan.AddrMarkrsonMapActivity}: java.lang.NullPointerException
 E/AndroidRuntime(630):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1956)
 E/AndroidRuntime(630):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1981)
 E/AndroidRuntime(630):     at android.app.ActivityThread.access$600(ActivityThread.java:123)
 E/AndroidRuntime(630):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1147)
 E/AndroidRuntime(630):     at android.os.Handler.dispatchMessage(Handler.java:99)
 E/AndroidRuntime(630):     at android.os.Looper.loop(Looper.java:137)
 E/AndroidRuntime(630):     at android.app.ActivityThread.main(ActivityThread.java:4424)
 E/AndroidRuntime(630):     at java.lang.reflect.Method.invokeNative(Native Method)
 E/AndroidRuntime(630):     at java.lang.reflect.Method.invoke(Method.java:511)
 E/AndroidRuntime(630):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
 E/AndroidRuntime(630):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
 E/AndroidRuntime(630):     at dalvik.system.NativeStart.main(Native Method)
 E/AndroidRuntime(630): Caused by: java.lang.NullPointerException
 E/AndroidRuntime(630):     at apt.kangkan.AddrMarkrsonMapActivity.onCreate(AddrMarkrsonMapActivity.java:76)
 E/AndroidRuntime(630):     at android.app.Activity.performCreate(Activity.java:4465)
 E/AndroidRuntime(630):     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1049)
 E/AndroidRuntime(630):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1920)
 E/AndroidRuntime(630):     ... 11 more
 I/dalvikvm(630): threadid=3: reacting to signal 3
 I/dalvikvm(630): Wrote stack traces to '/data/anr/traces.txt' 
```

你可以看到有一个 java.lang.NullPointerException。我不知道它为什么会出现。请帮忙。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T16:24:10.647

实际上找不到您的地址的纬度和经度，请检查“addressList”是否为空，如果它不为空，则继续如下..

```
 if (addressList == null)
    {
             Log.d(TAG,"Latitude and longitude not found");
    }
     else {
     Address location = addressList.get(0);
    latitude = location.getLatitude();
     longitude = location.getLongitude();
     } 
```

# ruby-on-rails - Rspec 显示错误的版本号

> ID：10705838
> 
> 赞同：1
> 
> 时间：2012-05-22T16:08:24.053
> 
> 标签：ruby-on-rails, ruby, rspec

我在 ruby​​ 1.8.7 和带有自定义 gemset 的 rvm 下运行 Rails 2.3.4 应用程序。

在尝试启动并运行 rspec 时，我曾多次尝试卸载 rspec 2 并安装 rspec 和 rspec-rails 1.3.4 版。但是，当我运行时，`rspec -v`无论我做什么，我都会得到 2.10.0。

最后我收到了这个错误信息：

```
You are running rspec-2, but it seems as though rspec-1 has been loaded as
  well.  This is likely due to a statement like this somewhere in the specs:

      require 'spec'

  Please locate that statement, remove it, and try again. 
```

所以看起来 2.10.0 实际上仍然加载。即使我做了一个`gem uninstall rspec`rspec 仍然加载。这是怎么回事？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T17:47:26.297

您应该使用`spec`(RSpec 1 可执行文件) 而不是`rspec`，如[本答案](https://stackoverflow.com/questions/7821020/rspec-error-when-i-run-my-rspec-test-of-my-controller)中所述。

# codeigniter - Codeigniter - 更改指定行的布局

> ID：10705840
> 
> 赞同：1
> 
> 时间：2012-05-22T16:08:26.570
> 
> 标签：codeigniter, html-table

如何使用 CodeIgniter 中的 HTML 表类更改指定行（不是所有行）的布局？我用模板数组尝试过，但这会影响整个表格的所有行。

```
$tmpl = array (
    'table_open'          => '<table border="0" cellpadding="4" cellspacing="0">',
    'heading_row_start'   => '<tr>',
    'heading_row_end'     => '</tr>',
    'heading_cell_start'  => '<th>',
    'heading_cell_end'    => '</th>',
    'row_start'           => '<tr>',
    'row_end'             => '</tr>',
    'cell_start'          => '<td>',
    'cell_end'            => '</td>',
    'row_alt_start'       => '<tr>',
    'row_alt_end'         => '</tr>',
    'cell_alt_start'      => '<td>',
    'cell_alt_end'        => '</td>',
    'table_close'         => '</table>'
);
$this->table->set_template($tmpl); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T16:41:18.377

很抱歉让您失望了，但无法使用 Codeigniter 的[HTML Table 类](http://codeigniter.com/user_guide/libraries/table.html)更改特定行的布局。尽管模板是可定制的，但它不能定制到特定的行或单元格，它对于`<table>`从数组中快速生成一个更有用的，而不是 HTML 表格的完整解决方案。

在不了解您的具体要求的情况下可能的解决方案：

1.  通过预先准备输入数组（如果您只需要一个`.highlighted`类或其他东西）将每个单元格包装在另一个元素中，这将产生如下输出：

    ```
    <tr>
      <td><div class="highlight">Data 1</div></td>
      <td><div class="highlight">Data 2</div></td>
      <!-- etc. -->
    </tr> 
    ```

2.  根本不要使用 Table 类，而是使用 HTML、循环和条件语句以老式方式构建它，这将使您可以完全控制布局。**（受到推崇的）**

# java - Java：如何漂亮地打印 .java 文件

> ID：10705844
> 
> 赞同：0
> 
> 时间：2012-05-22T16:08:45.017
> 
> 标签：java, jtextarea, pretty-print

我有一个 JTextArea，我用一个选定的 .java 文件填充它，问题是该文件显示为普通文本。我想添加一些漂亮的打印，以便用户能够看到文件，就好像文件在 eclipse 中打开一样（关键字不同的颜色，评论将是灰色的......等等）

我无法在网上找到任何关于如何做到这一点的好例子。最好的方法是什么？

编辑：

我终于让它工作了，我将`JSyntaxPane`jar 文件添加到我的类路径（`jsyntaxpane-0.9.5-b29.jar`确切地说）然后我添加了以下两行代码以使其适用于我的 JEditorPane。

```
jsyntaxpane.DefaultSyntaxKit.initKit();
JEditorPane.setContentType("text/java"); 
```

这也可以用于以下语言：JavaScript、Properties、Groovy、C、C++、XML、SQL、Ruby 和 Python ......只需在上面的代码中更改`text/java`为`text/LANGUAGE_YOU_WANT`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T16:22:15.903

[`JTextArea`](http://docs.oracle.com/javase/7/docs/api/javax/swing/JTextArea.html)只能显示纯文本（如 Windows 中的记事本）。如果你想用颜色显示漂亮的打印源代码，你需要[`JEditorPane`](http://docs.oracle.com/javase/7/docs/api/javax/swing/JEditorPane.html)，它允许你显示 HTML。

现在，您可以使用语法突出显示的 Java 源代码手动生成 HTML，也可以使用一些库。

# 也可以看看

*   [在哪里可以找到 Java 的语法高亮库？](https://stackoverflow.com/questions/864688)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T16:20:35.780

[JEdi​​t-Syntax](http://syntax.jedit.org/)有一个`JEditTextArea`可以进行语法高亮的类。这个项目被剥离出来以打包[JEdit](http://www.jedit.org/)项目的一些子组件。

# xml - 使用 XSLT 将 XML 转换为 VXML

> ID：10705845
> 
> 赞同：-1
> 
> 时间：2012-05-22T16:08:47.827
> 
> 标签：xml, xslt

我是 XML 及其相关语言的新手。我正在尝试做一个与voiceXML相关的项目。我需要使用 XSLT 将 XML 文档转换为 VoiceXML 文档的地方。我尝试使用 xslt 转换以下 XML 文件。但我得到的输出是：“我在这里，我不在这里，我在这里，我不在这里”你能帮我解决这个问题吗？

先感谢您。

XML 文件 =“myProj.xml”

```
<?xml version="1.0" encoding="UTF-8" ?>

<?xml-stylesheet type="text/xsl" href="myProj_xsl.xsl"?>

<myProjtag>
<prompt>
    I am here
</prompt>
<prompt>
    I am not here
</prompt>
</myProjtag> 
```

XSLT 文件="myProj_xsl.xsl"

```
<?xml version="1.0"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

<xsl:template match="/">
    <vxml version="2.0" lang="en">
        <form id="myProj">
            <prompt>
                <xsl:value-of select="."/>
            </prompt>
            <prompt>
                <xsl:value-of select="."/>
            </prompt>
        </form>
    </vxml>
</xsl:template> 

</xsl:stylesheet> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T05:50:44.493

您是否尝试通过在 Web 浏览器中打开 XML 来处理转换？

如果您是，您看到的是浏览器在转换完成后尝试呈现输出。由于浏览器不知道如何显示 vxml，因此您只能看到文本节点。

对您有帮助的是使用 XSLT 处理器。我推荐[撒克逊人](http://saxon.sourceforge.net/)。Saxon-HE 将是您入门的完美选择。该文档应该很容易让您从命令行运行转换。

我添加了另一个您可以使用的 XSLT 1.0 示例。最重要的部分是身份模板。这将复制所有节点（文本/元素/注释/处理指令）和属性，无需修改（只要它们未被另一个模板覆盖）。如果您需要覆盖身份模板，只需添加新模板。

另外，我偷了 Franci Avila 的`id`作品，但使用的是[AVT](https://www.w3.org/TR/xslt-10/#attribute-value-templates)而不是`xsl:attribute`. 我这样做只是为了展示一个 AVT。AVT 也*很*容易学习。

**XML 输入**（我`xml-stylesheet`从输入中删除了 PI。如果我没有删除它，我将不得不覆盖身份模板以去除它。）

```
<myProjtag>
  <prompt>I am here</prompt>
  <prompt>I am not here</prompt>
</myProjtag> 
```

**XSLT 1.0**

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
  <xsl:output indent="yes"/>
  <xsl:strip-space elements="*"/>

  <!--Identity tempate.-->
  <xsl:template match="node()|@*">
    <xsl:copy>
      <xsl:apply-templates select="node()|@*"/>
    </xsl:copy>
  </xsl:template>

  <xsl:template match="/">
    <vxml version="2.0" lang="en">
      <form id="{substring(local-name(/*), 0, string-length(local-name(/*))-2)}">
        <xsl:apply-templates select="*/*"/>
      </form>
    </vxml>    
  </xsl:template>

</xsl:stylesheet> 
```

**XML 输出**

```
<vxml version="2.0" lang="en">
   <form id="myProj">
      <prompt>I am here</prompt>
      <prompt>I am not here</prompt>
   </form>
</vxml> 
```

如果您对 XSLT、从命令行运行 Saxon 等有任何疑问，请告诉我。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T16:36:47.797

您需要注意您的上下文节点。

`<xsl:template match="/">`表示您的上下文节点是文档。整个节点的值只是文档中所有文本的串联。因此重复`<xsl:value-of select="."/>`将给你两次文档中的所有文本。

试试这个：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

<xsl:template match="node()|@*">
<xsl:copy><xsl:apply-templates select="node()|@*"/></xsl:copy>
</xsl:template>

<xsl:template match="/*">
<form>
   <xsl:attribute name="id">
      <xsl:value-of select="substring(local-name(), 0, string-length(local-name())-2)"/>
   </xsl:attribute>
   <!-- * is prompt elements -->
   <xsl:apply-templates select="*"/>
</form>
</xsl:template>

<xsl:template match="/">
    <vxml version="2.0" lang="en">
            <!-- * is myProjTag element -->
            <xsl:apply-templates select="*"/>
    </vxml>
</xsl:template> 
</xsl:stylesheet> 
```

# java - 启动程序时出现“找不到主方法”错误？

> ID：10705848
> 
> 赞同：4
> 
> 时间：2012-05-22T16:08:55.970
> 
> 标签：java

我正在为我的课程学习 Java，但我遇到了障碍。我的任务是开发一个简单的命令行程序。为了使事情变得更容易，我得到了以下示例代码来修改，这样我就不必从头开始了。

```
package assignment;

public class Main {
private final static String[] mainMenuOpts = {"Students","Lecturers","Admin","Exit"};
private final static String[] studentMenuOpts = {"Add Student","List all Students","Find a Student","Return to Main Menu"};
private Menu mainMenu = new Menu("MAIN MENU",mainMenuOpts);
private Menu studentMenu = new Menu("STUDENT MENU",studentMenuOpts);
private DataStore data = new DataStore();
private java.io.PrintStream out = System.out;
private ReadKb reader = new ReadKb();
/** Creates a new instance of Main */
public Main() {
    run();
}

private void run(){
    int ret = mainMenu.display();
    while(true){
        switch(ret){
            case 1: students();break;
            case 2: lecturers(); break;
            case 3: admin(); break;
            case 4: exit(); break;
        }
        ret = mainMenu.display();
    }
}
private void students(){
    int ret = studentMenu.display();
    while(ret != 4){
        switch(ret){
            case 1: addStudent();break;
            case 2: listStudents(); break;
            case 3: findStudent(); break;
        }
        ret = studentMenu.display();
    }
}
private void lecturers(){
    out.println("\nLecturers not yet implemented");
}
private void admin(){
    out.println("\nAdmin not yet implemented");
}
//Student methods
private void addStudent(){
    out.println("\n\tAdd New Student");
    //prompt for details
    //add student to the datastore
    //ask if they want to enter another student - 
    // if so call addStudent again
    //otherwise the method completes and the studentMenu will display again

}
private void listStudents(){
    out.println("\n\tStudent Listing");
    //list all students from the datastore
}
private void findStudent(){
    out.println("\n\tFind Student");
    out.print("Enter Search String: ");
    //reasd search text
    //use datastore method to get list of students that contain the search string
    //display matching students

}
// end Student methods
private void exit() {
    data.save();  //call the datastore method that will save to file
    out.println("\n\nGoodbye :)");
    System.exit(0);
    }
} 
```

我正在使用 NetBeans，当我尝试运行项目时出现此错误：

```
Error: Main method not found in class assignment.Main, please define the main method as: public static void main(String[] args) 
```

我只想让程序运行，以便更好地理解代码。我理解这个错误，但不知道在这堵文字墙的哪里实现 main 方法。我已经尝试了几个小时，但显然作为一个新手我完全没用。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-22T16:14:03.033

您目前拥有的只是一个名为 Main 的构造函数，Java 需要的是具有精确签名的 main 方法：

```
public static void main(String[] args) 
```

*   `public`- 以便可以从外部调用它

*   `static`- 这样就不需要创建你的类的实例

*   `void`- 不会返回任何值

*   `args`- 运行程序时可以指定的命令行参数数组

这是您的应用程序的入口点。

当您当前的代码被调用时，JVM 正在尝试定位 main 方法，并且由于它不存在于您的代码中，因此它会抛出您收到的异常。

由于您在帖子中提到了初学者，因此值得一提的是 Java 是一种**区分大小写的语言**-在 Java`main`中`Main`并不相同。

另请参阅：[入门教程](http://docs.oracle.com/javase/tutorial/getStarted/application/index.html)。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-22T16:10:57.283

的正确签名`main`是：

```
public static void main(String[] args) {
   new Main();
} 
```

它甚至写在您发布的错误消息中。

`;`从构造函数中删除：

```
public Main() {
    run();
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-22T16:13:38.100

您必须在程序中使用 main() 方法。程序从这里开始执行。

喜欢

```
public static void main(String args[])
{
  //This is the starting point of your program.
} 
```

此方法必须出现在一个类中，但它可以是任何类。在 Java 语言中，当您使用 Java 解释器执行一个类时，运行时系统首先调用该类的 main() 方法。然后 main() 方法调用运行应用程序所需的所有其他方法。

main() 方法接受一个参数：一个字符串数组。此参数是运行时系统将命令行参数传递给应用程序的机制

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-22T16:24:41.333

`main`方法应该存在以供您的应用程序运行。Java 应用程序需要它知道从哪里开始执行程序。

将该方法放在您选择的类中，然后右键单击文件并选择“运行文件”。

```
 public static void main(String[] args)
 {
     // your code here
 } 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-05-22T16:12:22.730

正如相当有用的错误消息所述，您需要一个 main 方法。[请参阅 Java 教程](http://docs.oracle.com/javase/tutorial/getStarted/application/index.html)。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-05-22T16:11:15.313

它正在寻找具有此签名的方法：

```
public static void main(String[] args) 
```

要运行您的代码，该`main`方法可能如下所示：

```
public static void main(String[] args)
{
    new Main();
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-05-22T16:12:24.767

您需要在主类中添加一个主方法，以便`JVM`知道从哪里开始，而不是一个具有“主”名称的类。

```
public static void main(String[] args) {
   new Main();
} 
```

# software-design - Pimcore 与 PyroCMS

> ID：10705851
> 
> 赞同：3
> 
> 时间：2012-05-22T16:09:04.120
> 
> 标签：software-design, pyrocms, pimcore

展望一家我正在与 atm 合作的公司，我希望停止使用各种框架/cms 系统，而只为所有未来的客户提供一个。

为此，我准备了一个选项列表，并将其缩减为 Pimcore 和 PyroCMS。我是一名 CI 开发人员，所以很明显 Pyro 对我有利，但是将开发自定义模块的人在 Zend 中更舒服。我发现了这一点：[pimcore 的（缺点）优势是什么？](https://stackoverflow.com/questions/4767769/what-are-the-disadvantages-of-pimcore)并发现它很有启发性。

所以我很想知道基于以下标准对这两个系统的想法：

1.  重新换肤潜力（前端主题等）。
2.  自定义模块轻松。在 Pyro 中构建模块非常简单且直观（如果您了解 CI）。Pimcore 对 Zend 大师来说是否那么容易？另外，只是购买/下载现有的模块，哪个更丰富？
3.  多站点使用（一次安装可以允许站点 A 的管理员用户仅查看站点 A 的内容吗？）

文档和营销宣传对这两个网站都很有用，但这里的任何实践经验都会很有用。

我在想我们也可以只使用 Pyro 中的 Zend 库（就像你可以单独使用 CI 一样）。有人认为使用起来会很头疼吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T16:00:45.090

PyroCMS 开发人员路过。

PyroCMS 可以处理您请求的所有 3 个要求。现在 CI 和 Zend 用户经常争论哪个框架更好，谁最好，bla bla bla，但可以很容易地说 CI 是最容易学习的。

如果您有一些 Zend 开发人员，虽然他们可能更喜欢使用基于 Zend 的 CMS，但这不应该成为应用程序本身的卖点。这些天来，人们非常关注他们喜欢的框架，他们似乎忽略了其他一切。

因此，请根据各自的优点评估这两种产品。

PyroCMS 可以处理多站点，并且前端（和后端！）可以很容易地使用 HTML 和一些基本标签进行重新设计——很像 Smarty-ish。

是的，您可以在 CodeIgniter/PyroCMS 应用程序中使用 Zend 组件，因此不必担心。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-29T22:06:37.060

我们在一些定制的 PyroCMS 模块中使用了 Zend。绝对要使用 PyroCMS，因此如果您愿意，您可以同时使用这两种框架。PyroCMS 2.1 刚刚问世，而且它一直在变得更好。

# php - 用 PHP 中的新时区替换日期时间

> ID：10705852
> 
> 赞同：0
> 
> 时间：2012-05-22T16:09:06.530
> 
> 标签：php, string

我得到了这样的字符串：

```
[ 15.04.2012 15:48:03 ] blahblah
[ 17.02.2012 22:49:11 ] blahblah
[ 18.11.2011 10:11:39 ] blahblah 
```

日期时间是 utc，如何用 utc+8 日期时间替换这些日期时间字符串？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T16:12:54.597

如果您知道时区是 +0 并且您想将其更改为 utc+8 为什么不添加 8 小时？

```
echo date('d.m.Y G:i:s', strtotime('+8 hours', strtotime('15.04.2012 15:48:03')));
// 15.04.2012 23:48:03 
```

# css - 当浏览器分辨率低于 1260px 时调整 h1 的字体大小

> ID：10705855
> 
> 赞同：0
> 
> 时间：2012-05-22T16:09:14.240
> 
> 标签：css

我被困住了，我正在设计一个分辨率为 1266px 的网页。我希望它适合 1024 像素，因为 13% 的人仍在使用该分辨率。所以我想我可以改变我的 h1 和我的 nav_items 的字体大小。

为了让它们适合，如果分辨率低于 1260，否则我希望它们保持在给它们的固定像素。

这就是我得到的：

```
header {
  width:100%;
  background: #222;
  color: white;
  height: 80px;
  margin: 0px 0px 0px 0px;
  padding: 0px 0px 0px 0px; 
  -webkit-box-shadow: 0 1px 10px rgba(0, 0, 0, 0.6);
  -moz-box-shadow: 0 1px 10px rgba(0, 0, 0, 0.6);
  box-shadow: 0 1px 10px rgba(0, 0, 0, 0.6);
  text-shadow: 2px 2px 0 #000;
}
header h1 { /* TAVERNE DE STADSPOORT */
  font-size: 40px;
  float:left;
  color:white;
  margin: 0px 0px 0px 0px; /* top, left, bottom, right*/ 
  padding: 10px 30px 10px 20px; /* top, right, bottom, right*/
}
header ul {
  float: right; 
  width: 680px;
  padding: 20px; 0px; 0px; 0px; /* top, left, bottom, right*/
}
.nav_items li {
  display:inline;
  font-size:22px;
  margin: 0px 4px 0px 4px; /* top, left, bottom, right (outside) */ 
  padding: 0px 4px 0px 4px; /* top, left, bottom, right*/ 
} 
```

```
<div id="logo">
<h1 class="nav_items"><a href="index.html">Taverne De Stadspoort</a></h1>
</div>
<nav id="top">
    <ul class="nav_items">
        <li><a href="/">Menukaart</a></li>
        <li><a href="/">Suggesties</a></li>
        <li><a href="/">Onze wijnen</a></li>
        <li><a href="/">Ligging/contact</a></li>
        <li><a href="/">Gastenboek</a></li>
    </ul>
</nav> 
```

也许我做错了什么，我可以用另一种方式解决这个问题。或者我应该使用 jquery 来归档它吗？因为我不熟悉其他解决方案会很棒。

我添加了这个：谢谢所有

```
@media all and (max-width: 1259px) { h1 { font-size: 25px; } }
@media all and (min-width: 1260px) { h1 { font-size: 40px; } } 
/* http://www.w3.org/TR/css3-mediaqueries/ */ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-29T05:29:51.027

```
$('#fit').resizable({
    resize: function( event, ui ) {

        divWidth = ui.size.width/(len*9);
        divHeight = ui.size.height / (len *2.2);

        abc = divWidth;
        if (divWidth < divHeight) { 
          abc = divWidth; 
        } else {
            abc = divHeight
        }

        ui.element.css({'font-size': abc +'em'});
        console.log(abc);

    }
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T16:13:21.963

查看[CSS 媒体查询](https://developer.mozilla.org/en/CSS/Media_queries)。它们允许您为特定的屏幕分辨率指定样式（更多）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-22T16:16:36.777

例如

```
@media all and (min-width: 1266px) {

    h1 {
      font: (large-size)px;
    }
}

@media all and (max-width: 1265px) {

    h1 {
      font: (smaller-size)px;
    }
} 
```

# excel-2010 - 条件格式，基于整行

> ID：10705856
> 
> 赞同：85
> 
> 时间：2012-05-22T16:09:18.313
> 
> 标签：excel-2010, conditional-formatting

我已经搜索并阅读了与条件格式相关的答案，但我似乎无法让我的工作，所以也许我做错了什么。

我有一个工作表。它包含我们避难所中的动物列表。我正在尝试做的是，如果它们已被采用，则将整行涂成绿色（在“G”列中用“X”表示）。我有`=$G$2="X"`和`=$G2="X"`，但都没有工作。它只会在我设置规则时为活动的一行着色，当我在另一行输入“X”时，它什么也不做。我错过了什么？

* * *

## 回答 #1

> 赞同：146
> 
> 时间：2012-12-13T17:16:54.977

对条件格式使用“间接”功能。

1.  选择条件格式
2.  选择新规则
3.  选择“使用公式确定要格式化的单元格”
4.  输入公式，`=INDIRECT("g"&ROW())="X"`
5.  输入所需的格式（文本颜色、填充颜色等）。
6.  选择确定以保存新格式
7.  在条件格式中打开“管理规则”
8.  如果您看不到新规则，请选择“此工作表”。
9.  在新规则的“适用于”框中，输入`=$A$1:$Z$1500` （或者根据您的工作表，您希望条件格式扩展的宽度/长度）

对于 G 列中具有 X 的每一行，它现在将转换为您指定的格式。如果列中没有 X，则不会格式化该行。

您可以重复此操作以根据列值进行多行格式化。只需更改公式中的`g`列或`x`特定文本并设置不同的格式。

例如，如果您使用公式添加新规则`=INDIRECT("h"&ROW())="CAR"`，那么它将将`CAR`H 列中的每一行格式化为您指定的格式。

* * *

## 回答 #2

> 赞同：108
> 
> 时间：2012-05-22T16:48:15.110

```
=$G1="X" 
```

将是正确（也是最简单）的方法。只需先选择整个工作表，因为条件格式仅适用于选定的单元格。我刚试了一下，效果很好。您必须从 G1 而不是 G2 开始，否则它将使条件格式偏移一行。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2015-10-13T11:18:45.083

要基于单个单元格为整个行设置条件格式，您必须用“$”锚定该单个单元格的列地址，否则 Excel 只会正确获取第一列。为什么？

因为 Excel 正在根据列的偏移量为行的第二列设置条件格式。对于第二列，Excel 现在已将一列移动到您想要的规则单元格的右侧，检查了该单元格，并根据您从未想要的单元格正确格式化了第二列。

只需用“$”锚定规则单元格地址的 COLUMN 部分，您就会很高兴

例如：如果该行的最后一个单元格不等于 1，您希望表格中的任何行突出显示红色。

选择整个表格（但不是标题）“主页”>“条件格式”>“管理规则...”>“新规则”>“使用公式确定要格式化的单元格”

输入：“=$T3<>1”（没有引号...“T”是规则单元格的列，“3”是它的行） 设置格式 单击应用。

确保 Excel 没有在公式的任何部分插入引号……如果有，请退格/删除它们（请不要使用箭头键）。

应为整个表格设置条件格式。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-22T16:18:03.427

您想应用自定义格式规则。“适用于”字段应该是您的整行（如果要格式化第 5 行，请输入`=$5:$5`。自定义公式应该是`=IF($B$5="X", TRUE, FALSE)`，如下例所示。

![](../Images/6b7e181c72752b27f52cc4c21fadf713.png)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-05-01T18:19:47.647

使用 RC 寻址。因此，如果我希望 Col B 的背景颜色取决于 Col C 中的值并从第 2 行到第 20 行应用它：

脚步：

1.  选择 R2C2 至 R20C2

2.  点击条件格式

3.  选择“使用公式确定要格式化的单元格”

4.  输入公式：=RC[1] > 25

5.  创建您想要的格式（即背景颜色“黄色”）

6.  适用于：确保它显示：=R2C2:R20C2

** 请注意，“魔术”发生在第 4 步中……使用 RC 寻址查看正在格式化的单元格右侧一列的值。在此示例中，我正在检查正在格式化的单元格右侧一列的单元格的值是否包含大于 25 的值（请注意，您可以在此处放置几乎任何返回 T/F 值的公式）

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2014-01-13T23:31:53.857

就我而言，我想将 E 列单元格中的值与 G 列中的单元格进行比较

突出显示 E 列中要检查的单元格的选择。

选择条件格式：突出显示单元格规则在我的情况下选择一个选项，它大于。在弹出窗口的左侧字段中，使用 =indirect("g"&row()) 其中 g 是我要比较的行。

现在，您正在格式化的行将根据它是否大于 G 行中的选择来突出显示

与您为 E 列所做的选择的 G 列中的单元格相比，这适用于 E 列中的每个单元格。

如果 G2 大于 E2 则格式化

G3 大于 E3 它格式化等

# java - Glassfish 中的 NoClassDefFoundError :(

> ID：10705858
> 
> 赞同：1
> 
> 时间：2012-05-22T16:09:26.270
> 
> 标签：java, glassfish, netbeans-7, jodconverter

我有这个问题困扰了我很长一段时间。

我有使用 netbeans 开发的 java 应用程序，并部署在 glassfish 3 上。这部分代码以前可以工作，但现在由于某种原因它不能工作。我正在使用 JODConvertor，我可以在 lib 文件夹和部署后的 war 文件中看到可用的库。

我在网站上阅读过类似的问题，但它不起作用。我什至卸载并重新安装了 IDE 和应用程序服务器，但无济于事。

拜托我需要你的帮忙。

```
java.lang.NoClassDefFoundError: com/sun/star/lang/XEventListener
at java.lang.ClassLoader.defineClass1(Native Method)
at java.lang.ClassLoader.defineClassCond(ClassLoader.java:631)
at java.lang.ClassLoader.defineClass(ClassLoader.java:615)
at java.security.SecureClassLoader.defineClass(SecureClassLoader.java:141)
at org.glassfish.web.loader.WebappClassLoader.findClass(WebappClassLoader.java:927)
at org.glassfish.web.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1476)
at org.glassfish.web.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1359)
at java.lang.ClassLoader.defineClass1(Native Method)
at java.lang.ClassLoader.defineClassCond(ClassLoader.java:631)
at java.lang.ClassLoader.defineClass(ClassLoader.java:615)
at java.security.SecureClassLoader.defineClass(SecureClassLoader.java:141)
at org.glassfish.web.loader.WebappClassLoader.findClass(WebappClassLoader.java:927)
at org.glassfish.web.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1476)
at org.glassfish.web.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1359)
at server.WordGenServlet.generateWordDoc(WordGenServlet.java:85)
at server.WordGenServlet.processRequest(WordGenServlet.java:66)
at server.WordGenServlet.doPost(WordGenServlet.java:229)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:688)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:770)
at org.apache.catalina.core.StandardWrapper.service(StandardWrapper.java:1542)
at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:281)
at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:175)
at org.apache.catalina.core.StandardPipeline.doInvoke(StandardPipeline.java:655)
at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:595)
at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:161)
at org.apache.catalina.connector.CoyoteAdapter.doService(CoyoteAdapter.java:331)
at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:231)
at com.sun.enterprise.v3.services.impl.ContainerMapper$AdapterCallable.call(ContainerMapper.java:317)
at com.sun.enterprise.v3.services.impl.ContainerMapper.service(ContainerMapper.java:195)
at com.sun.grizzly.http.ProcessorTask.invokeAdapter(ProcessorTask.java:849)
at com.sun.grizzly.http.ProcessorTask.doProcess(ProcessorTask.java:746)
at com.sun.grizzly.http.ProcessorTask.process(ProcessorTask.java:1045)
at com.sun.grizzly.http.DefaultProtocolFilter.execute(DefaultProtocolFilter.java:228)
at com.sun.grizzly.DefaultProtocolChain.executeProtocolFilter(DefaultProtocolChain.java:137)
at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:104)
at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:90)
at com.sun.grizzly.http.HttpProtocolChain.execute(HttpProtocolChain.java:79)
at com.sun.grizzly.ProtocolChainContextTask.doCall(ProtocolChainContextTask.java:54)
at com.sun.grizzly.SelectionKeyContextTask.call(SelectionKeyContextTask.java:59)
at com.sun.grizzly.ContextTask.run(ContextTask.java:71)
at com.sun.grizzly.util.AbstractThreadPool$Worker.doWork(AbstractThreadPool.java:532)
at com.sun.grizzly.util.AbstractThreadPool$Worker.run(AbstractThreadPool.java:513)
at java.lang.Thread.run(Thread.java:662)
    Caused by: java.lang.ClassNotFoundException: com.sun.star.lang.XEventListener
at org.glassfish.web.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1509)
at org.glassfish.web.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1359)
... 43 more 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T16:14:47.103

您需要添加[`ridl.jar`](http://repo1.maven.org/maven2/org/openoffice/ridl/)到您的 CLASSPATH。不知道哪个版本适合你。

# wcf - 具有一对多关系的自我跟踪实体

> ID：10705859
> 
> 赞同：1
> 
> 时间：2012-05-22T16:09:26.817
> 
> 标签：wcf, asp.net-mvc-3, self-tracking-entities

我使用带有 WCF 的自我跟踪实体来处理数据和 asp.net MVC3 作为客户端，知道为什么这段代码不起作用

在我的 MVC 控制器中，我有这个操作来获取用户联系人

```
 public ActionResult Contacts(int id)
      {
            var contacts = _proxy.GetContactsByUser(id);
            var mcontacts = Mapper.Map<Contact[], MContact[]>(contacts);

            return View(mcontacts);
      } 
```

在 WCF 服务中，这是我获取用户联系人的方法

```
 public List<Contact> GetContactsByUser(int id)
      {

                 var user = _context.Users.FirstOrDefault(u => u.UserID == id);
                List<Contact> contacts = user.Contacts.ToList();
                return contacts;

      } 
```

**我的问题`List<Contact> contacts`是始终为空**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T16:42:32.630

到底什么不起作用？

形成它的第一眼你还没有创建一个地图

```
 public ActionResult Contacts(int id)
      {
            var contacts = _proxy.GetContactsByUser(id);
            Mapper.CreateMap<Contact,MContact>();
            var mcontacts = Mapper.Map<Contact[], MContact[]>(contacts);

            return View(mcontacts);
      } 
```

这是一个有用的链接

[http://automapper.codeplex.com/wikipage?title=Lists%20and%20Arrays&referringTitle=Home](http://automapper.codeplex.com/wikipage?title=Lists%20and%20Arrays&referringTitle=Home)

# c++ - 未定义的引用错误对我没有任何意义

> ID：10705861
> 
> 赞同：2
> 
> 时间：2012-05-22T16:09:29.963
> 
> 标签：c++, cmake, undefined-reference, linkage

我在这里有这段代码：
**Main.cpp**

```
#include "AStarPlanner.h"
#include <costmap_2d/costmap_2d.h>

int main(int argc, char** argv)
{
   AStarPlanner planner =  AStarPlanner(10,10,&costmap);
} 
```

和我的班级：
**AStarPlanner.h**

```
class AStarPlanner {

public:

  AStarPlanner(int width, int height, const costmap_2d::Costmap2D* costmap);
  virtual ~AStarPlanner(); 
```

**AStarPlanner.cpp**

```
#include "AStarPlanner.h"

using namespace std;

AStarPlanner::AStarPlanner(int width, int height, const costmap_2d::Costmap2D* costmap)
{

  ROS_INFO("Planner Konstruktor");
  width_ = width;
  height_ = height;
  costmap_ = costmap;
} 
```

我看不出我有任何错误。该函数已定义，我的 main.cpp 知道该类。

**制作清单**

```
cmake_minimum_required(VERSION 2.4.6)
include($ENV{ROS_ROOT}/core/rosbuild/rosbuild.cmake)

rosbuild_init()

#set the default path for built executables to the "bin" directory
set(EXECUTABLE_OUTPUT_PATH ${PROJECT_SOURCE_DIR}/bin)
#set the default path for built libraries to the "lib" directory
set(LIBRARY_OUTPUT_PATH ${PROJECT_SOURCE_DIR}/lib)

rosbuild_add_library (robot_mover src/AStarPlanner.cpp )
rosbuild_add_executable(robot_mover src/main.cpp) 
```

但我收到此错误：
**未定义对`vtable for AStarPlanner'** ** undefined reference to`AStarPlanner::~AStarPlanner()' 的引用**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-22T16:25:49.697

您未能为 定义析构函数 `AStarPlanner`。您可以将其添加到 AStarPlanner.cpp 中：

```
AStarPlanner::~AStarPlanner()
{
} 
```

考虑[这个建议](http://www.parashift.com/c++-faq-lite/strange-inheritance.html#faq-23.10)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-02-14T06:28:22.787

我也遇到了未定义引用的问题，大多数时候这表明存在链接问题......

**我解决了它：**

**与 Lee Netherton 写**的类似，但直接将其添加到您的 CmakeLists.txt

确保添加失败的函数的实现所在的文件。

在您的示例中，请确保：

```
 add_executable(robot_mover 
                src/main.cpp
                AStarPlanner.cpp) 
```

这将告诉链接器针对您的 robots_mover 可执行文件查找所有定义/实现的源文件...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-22T16:18:31.297

`gcc`应该使用以下内容编译它：

```
gcc -o main Main.cpp AStarPlanner.cpp 
```

我的猜测是你错过了这个`AStarPlanner.cpp`部分。

**编辑：**

休? 您刚刚在 OP 中更改的错误。这个答案现在没有多大意义。

**编辑2：**

看起来你正在`AStarLibrary`进入`robot_mover`图书馆。您在构建可执行文件时是否链接到该库？我对`ros*`宏不熟悉，但是在普通的 gcc 中，构建命令看起来像这样：

```
gcc -o main Main.cpp -lrobot_mover 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-22T16:12:28.727

该错误意味着虽然编译器*可以*找到类的定义`main()`，但链接器*却找不到*。您需要设置编译选项，以便 yopu`AStarPlanner.obj`在尝试构建可执行文件时将生成的内容传递给链接器

如何进行设置的确切形式取决于您使用的编译器。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-22T16:13:02.377

AStarPlanner.cpp 可能没有被编译/链接。确保它在项目中。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-05-22T16:14:38.857

您的

```
AStarPlanner planner =  AStarPlanner(10,10,&costmap); 
```

引用 costmap 但我没有看到它的定义（对于变量本身，而不是类）。

# javascript - jQuery 导入 jQuery

> ID：10705870
> 
> 赞同：1
> 
> 时间：2012-05-22T16:10:25.453
> 
> 标签：javascript, jquery, google-app-engine

我有一个带有 jQ​​uery 和 JavaScript 的 HTML 页面。我在 head 标签中导入我需要的库：

```
<link rel="stylesheet" href="http://code.jquery.com/ui/1.8.18/themes/base/jquery-ui.css" type="text/css" media="all" />
<link rel="stylesheet" href="http://static.jquery.com/ui/css/demo-docs-theme/ui.theme.css" type="text/css" media="all" />
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>
<script src="http://code.jquery.com/ui/1.8.18/jquery-ui.min.js" type="text/javascript"></script>
<script src="http://jquery-ui.googlecode.com/svn/tags/latest/external/jquery.bgiframe-2.1.2.js" type="text/javascript"></script>
<script src="http://jquery-ui.googlecode.com/svn/tags/latest/ui/minified/i18n/jquery-ui-i18n.min.js" type="text/javascript"></script>
<script src="http://maps.googleapis.com/maps/api/js?sensor=false&amp;libraries=places" type="text/javascript"></script> 
```

然后我在里面导入一些带有jQuery的html：

```
$('#cliente').click(function(){$('#container').load('/clienti/cliente');}); 
```

但是加载的页面内的 jQuery 不起作用。（我确信代码是正确的，就像单独工作一样）。

我需要做点什么吗？我试图在脚本之前导入导入页面中的库（头脑中），但没有工作。我没有其他想法！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T16:14:44.327

[`.load()`仅适用于](http://api.jquery.com/load/)您使用它的方式的 HTML。（参见标题为“脚本执行”的部分）。它不会评估您加载的 HTML 中的任何脚本。你想要的是使用后缀加载它，即

```
$('#cliente').click(function(){$('#container').load('/clienti/cliente.html');}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T16:20:10.917

如果你的 JS 和 HTML 必须在同一个文件中，一个更好的方法是这样。我相信它会以这种方式评估 JS。

```
$('#cliente').click(function(){
    $.get('/clienti/cliente', function(data){
        $('#container').html(data);
    });        
}); 
```

或者，您可以将这两个项目（HTML 和 JS）作为文本传回

```
$('#cliente').click(function(){
    $.getJSON('/clienti/cliente', function(object){
        $('#container').html(object.html);
        $parseJSON(object.jscript);
    });        
}); 
```

否则，您将需要在两个镜头中使用`$.get()`and`$.getJSON()`获取 html 和 js。

# perl - perl 中的错误：不推荐使用散列作为参考

> ID：10705876
> 
> 赞同：0
> 
> 时间：2012-05-22T16:10:44.127
> 
> 标签：perl, hash, reference, deprecated

```
sub function{
my $storedata=shift;
my $storenameandaddress=$storedata->{$storeid}->{name}
."_".$storedata->{$storeid}->{location}->{address}
."_".$storedata->{$storeid}->{location}->{city}
."_".$storedata->{$storeid}->{location}->{state}
."_".$storedata->{$storeid}->{location}{country};} 
```

我的代码如上所示。它给了我错误信息：

```
Using a hash as a reference is deprecated at main.pl line 141. 
```

但是，该功能仍然可以运行。其余的似乎都很好。那么这个错误在说什么？我应该如何解决它？谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-22T16:30:20.787

您发布的代码没有给出该警告。表格代码

```
%foo->{bar} 
```

发出警告。它给出了警告，因为它的作用是

```
$foo->{bar} 
```

即使它不应该。

* * *

```
$ perl -wE'my %h = ( foo => 123 ); say %h->{foo};'
Using a hash as a reference is deprecated at -e line 1.
123

$ perl -Mdiagnostics -wE'my %h = ( foo => 123 ); say %h->{foo};'
Using a hash as a reference is deprecated at -e line 1 (#1)
    (D deprecated) You tried to use a hash as a reference, as in
    %foo->{"bar"} or %$ref->{"hello"}.  Versions of perl <= 5.6.1
    used to allow this syntax, but shouldn't have. It is now deprecated, and will
    be removed in a future version.

123

$ perl -wE'my %h = ( foo => 123 ); say $h->{foo};'
123 
```

# api - 如果第 3 方 API 身份验证失败，我的 API 应返回哪些 HTTP 错误代码？

> ID：10705884
> 
> 赞同：1
> 
> 时间：2012-05-22T16:11:14.250
> 
> 标签：api, http, rest, oauth

我正在编写一个 REST-ish API 服务，它提供了通过 OAuth 与其他 3rd 方服务（它们本身是 REST API）中的最终用户数据进行交互的能力。一个常见的示例可能是将数据从我的服务发布到第三方服务，例如 Facebook 或 Twitter。

例如，假设我与最终用户和 Facebook 一起执行 OAuth 舞蹈，从而产生一些短期访问令牌，我的服务可以使用该令牌与用户的 Facebook 帐户进行交互。如果该访问令牌过期并且用户尝试使用我的服务发布到 Facebook，我会向用户返回什么样的错误？

401 对我来说似乎不太合适。似乎 401 将适用于 MY 服务的用户身份验证状态。403 似乎更合适，但也很通用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T16:42:11.217

401是要走的路。定义 HTTP 协议的 RFC2616 的两个摘录：

第 10.4.2 节（约 401）：

> 如果请求已包含授权凭证，则 401 响应表示已拒绝对这些凭证的授权。

这似乎适用于过期的令牌。有身份验证凭据，但它们被拒绝，因此用户代理必须重新进行身份验证。

第 10.4.4 节（约 403）：

> 服务器理解请求，但拒绝执行。授权将无济于事，并且不应重复请求。

当尽管有用户凭据仍无法访问资源时，应使用此选项。可能是一个网站/API，仅适用于美国被亚洲 IP 或已被宣布有害且已停用的网页（因此找到了内容，但服务器拒绝提供它）。

在 OAuth2 上，推荐的工作流程取决于令牌的传递方式。如果通过*Authorization*标头传递，服务器可能会返回 401。当通过查询字符串参数传递时，最合适的响应是 400 Bad Request（不幸的是，这是最通用的 HTTP 请求）。这是由 OAuth2 规范[https://datatracker.ietf.org/doc/html/draft-ietf-oauth-v2-26的第 5.2 节定义的](https://datatracker.ietf.org/doc/html/draft-ietf-oauth-v2-26)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T16:21:30.587

通用并没有错，听起来 403 状态是相关的 - 没有什么能阻止您提供更易于阅读的版本，更详细地说明原因。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-23T11:11:05.943

如果您在错误响应方面有一定的野心，我认为以下是一个全面的列表。

**400 错误请求**

对于格式错误的请求，例如，如果参数需要一个介于 0-9 和 11 之间的 int，则已发送。您可以返回它，并在响应正文中指定`parameter x requires a value between 0 and 9`

**401未经授权**

仅用于授权问题。签名可能是错误的，之前可能已经使用过随机数，发送的时间戳不在可接受的时间窗口内，再次使用响应正文来更准确地指定您对此进行响应的原因。为了澄清起见，仅将其用于与 OAuth 相关的错误。

**403 禁止**

明确表示完全不可能（现在或永远）根本不可能进行格式良好且经过授权的操作。例如，如果某个资源已被另一个用户锁定以供编辑：使用响应正文说出类似`Another person is editing this right now, you'll have to wait mmkay?`.

`403 Forbidden`也可能与试图获取资源有关。例如，假设用户可以访问资源 /resource/101212/properties.json 但不能访问 /resource/999/properties.json，那么您可以简单地`Forbidden due to access rights`在响应正文中声明：

**404 未找到**

请求的资源不存在。或者 URL 根本没有成功映射到您服务中的 API。在响应正文中指定。

**405 方法不允许**

This is to represent that the API can not be called with for example `GET` but another method must be used. When this is returned also you MUST return the extra response header `Allow: POST, PUT, etc`.

# java - 执行 RPC 时出现 GWT 序列化问题

> ID：10705888
> 
> 赞同：1
> 
> 时间：2012-05-22T16:11:31.210
> 
> 标签：java, gwt, serialization, gwt-rpc, gwt2

我正在学习 GWT。

我收到了关于 serilizablity 的错误。

我的问题的简要描述

在类 Customproperties

```
package com.exp.shared;

import java.io.Serializable;
import java.util.List;

public class Customproperties implements Serializable  {

    private Object value;
    private List<?> values;
          // more variable

    public Customproperties() {
        // TODO Auto-generated constructor stub
    }

    public Customproperties(String propertyName, List<?>  object,
            String propertyType, boolean mulitiValued, String cardinality, Boolean required) {

        this.propertyName=propertyName;
        this.values=object;
                // more initialization
    }

    public Customproperties(String propertyName,  List<?> object, String propertyType,
            boolean multiValued) {
        this.propertyName=propertyName;
        this.values=object;
                // more initialization
    }

    public Object getValue() {
              return value;
    }
    public List<?> getValues() {
        return values;
    }
 } 
```

在 classImpl 之一的服务器包中，我正在使用 Customproperties 的对象

```
 if (doc.getPropertyValue("cmis:objectTypeId").toString().equals("cmis:document")) {

    customproperty=new Customproperties(p.getDefinition().getDisplayName(), p.getValue(), p.getType().toString(),p.isMultiValued());
       }
else {
    customproperty=new Customproperties(p.getDefinition().getDisplayName(), p.getValues(), p.getType().toString(),p.isMultiValued(),value.getCardinality(),value.isRequired());
            } 
```

如果条件 p.getValue() 返回 Object。并且在其他条件下 p.getValues() 返回列表。

`CustomProperties class`当我改变它时`object variable`，`string`它工作得很好。

但我不改变它它给了我错误。

```
com.exp.shared.Customproperties' was not included in the set of types which can be serialized by this SerializationPolicy or its Class object could not be loaded. For security purposes, this type will not be serialized.: instance = com.exp.shared.Customproperties@1aa5344
        at com.google.gwt.user.server.rpc.impl.ServerSerializationStreamWriter.serialize(ServerSerializationStreamWriter.java:619) 
```

我不想改变它 String 。我只想接收对象。导致此对象有时可能是`String`, `date`, `int`.

请帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T16:45:26.170

You should read the GWT docs about RPC serialization [here](https://developers.google.com/web-toolkit/doc/latest/DevGuideServerCommunication#DevGuideSerializableTypes "here").

> The class java.lang.Object is not serializable, therefore you cannot expect that a collection of Object types will be serialized across the wire.

This is why you get your exception. In the code you've given, you're not using the field value. Both constructors on your class only set the values list. So if you're not using the field value, just remove it and it will work. But assuming that's a mistake and you do need to use it ...

You will have to know all the different possible types your value can have. And then either you have different fields, like intValue, dateValue, stringValue ... Or you can have one String field, and serialize your objects into strings like this.

```
public class CustomProperties {
    private String value;
    private String type;

    private void setValue(Object value, String type) {
        if (value != null) {
            this.value = value.toString();
            this.type = type;
        }
    }

    private Object getValue() {
        if (value != null) {
            if ("int".equals(type)) return Integer.valueOf(value);
            elseif ("date".equals(type)) return // Parse date from value here
            elseif ("string".equals(type)) return (String) value;
            // other cases
        }
        return value;
    } 
```

}

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T16:19:40.970

在 GWT 中，声明容器时从不声明像`List`.
始终使用更具体的类型，例如`ArrayList`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-22T17:21:42.330

In your case, the problem is most likely the `List<?>`. GWT doesnt know what possible types you are putting in that list, so instead of generating code to serialize every single possible type on the sourcepath, it generates nothing except for what it knows it already needs. When you attempt to put something in there that wasn't needed elsewhere, the exception occurs, indicating that GWT wasn't told that you planned on sending that object over the wire.

A standard approach here is usually to create a marker interface that probably implements `Serializable`, and make it a `List<MyModelObjects>`. Then every object that can fit in there should implement that interface.

# silverlight - 通过浏览器访问专有 USB 设备……可能吗？银光也许？（Java 暂时不包括在内）

> ID：10705892
> 
> 赞同：5
> 
> 时间：2012-05-22T16:11:40.103
> 
> 标签：silverlight, browser, usb, device

可能周围有很多类似的问题，但是由于我只知道很少有解决方案，我不确定是否对我们有用，所以我正在寻找其他东西，也许是新技术......

我们所拥有的是这个不那么花哨的 USB 设备（当然，它需要加载驱动程序），并且它有几个 C++ dll 来帮助从中获取某些输出。最重要的是，我们制作了一个 C# 桌面应用程序，它以更有吸引力的方式使用设备（内部有大量互操作）。

到目前为止一切都很好，但是为了获得更大的灵活性，将应用程序提升到网络上......有哪些选择？

已知的解决方案是：

*   1) **ActiveX** - 有点老技术，不是跨浏览器；
*   2) **.Net 'applet'** - 不那么常见（这甚至是一个解决方案吗？）
*   3) **Java 小程序**- 众所周知，但需要 JVM（因为我们选择了 C++，C# 可能超出了范围）；
*   4) **USB 设备本身的 Web 服务**- 我们的设备很轻，我们不能在那里拥有它。

还有其他方法吗？Silverlight 4、5（可能“脱离浏览器”）是一个可行的解决方案吗？现在这些新技术怎么样了？**HTML 5**还是什么？

**EDIT1：**特别是我对 Silverlight 感兴趣。有没有使用**Silverlight**的方法？

**EDIT2：**我发现了这个问题：[Silverlight 可以访问访问 USB 端口的 .Net 库吗？](https://stackoverflow.com/questions/2252683/can-silverlight-access-a-net-library-that-accesses-a-usb-port). 从中我能理解什么？Silverlight 真的不是我的方案的可行解决方案吗？

**编辑 3：非常重要！**

## 这些设备需要在客户端使用！浏览的人必须在他们的 PC 上本地使用它们！

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-26T01:40:26.987

> 将应用程序提升到网络 [...]

简单的解决方案：让网络服务器（http 服务器）在连接到 USB 设备的 PC 上运行，并使用网络服务器的其中一个接口（如 CGI）与您的 USB 设备通信。这样，您只需编写一个 USB 转 CGI 包装程序，它可以是 C++ 或 C#。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-22T16:18:03.663

另一种方法是编写浏览器插件。

您将面临的问题是浏览器中的内容通常在沙箱中运行，这样 Web 应用程序就无法访问计算机。这有充分的理由 - 主要是安全性。让一些代码在计算机上下文中运行的一种方法是拥有一个浏览器插件，该插件可以访问计算机的硬件资源，但可以与浏览器内容交互。不幸的是，您最终可能会为不同的浏览器编写不同的插件。

确实存在使编写浏览器插件更易于管理的框架。一个简单的搜索应该会找到其中一些候选人。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-23T07:24:22.380

您可以使用 Silverlight 5，它可以让您访问您的文件系统和 USB 存储设备。如果您想控制其他 USB 设备（打印机、扫描仪等），您应该提供设备类型。我知道，Silverlight 5 与文件系统和网络摄像头配合得很好......）

# jsf - JSF / PrimeFaces - 打印机组件 - 未实现 saveState() 和 restoreState() 方法

> ID：10705898
> 
> 赞同：0
> 
> 时间：2012-05-22T16:12:06.980
> 
> 标签：jsf, printing, primefaces, nullpointerexception

我们计划使用 PrimeFaces PrinterBehavior 组件来打印页面上的数据。但是在提交表单（包装打印机标签）时会抛出 NullPointerException；**我们意识到这是因为 savaState() 和 restoreState() 方法没有被实现。**

这是一个已知问题还是我们在这里遗漏了什么？

xhtml代码片段：

```
<h:commandButton id="printId" value="print"  styleClass="printButton">
<p:printer target="useListDatatable" />
</h:commandButton>
<p:dataTable width="100%" id="useListDatatable">
</p:dataTable> 
```

堆栈跟踪：

```
Caused by: java.lang.NullPointerException: expr
at javax.faces.component.UIComponentBase.findComponent(UIComponentBase.java:698)
at org.primefaces.component.behavior.printer.PrinterBehavior.getScript(PrinterBehavior.java:46)
at org.apache.myfaces.shared.renderkit.html.HtmlRendererUtils._appendClientBehaviourScript(HtmlRendererUtils.java:2004)
at org.apache.myfaces.shared.renderkit.html.HtmlRendererUtils.getClientBehaviorScript(HtmlRendererUtils.java:1983)
at org.apache.myfaces.shared.renderkit.html.HtmlRendererUtils.buildBehaviorChain(HtmlRendererUtils.java:2154)
at org.apache.myfaces.shared.renderkit.html.HtmlRendererUtils.buildBehaviorChain(HtmlRendererUtils.java:2119)
at org.apache.myfaces.shared.renderkit.html.HtmlButtonRendererBase.buildBehaviorizedOnClick(HtmlButtonRendererBase.java:393)
at org.apache.myfaces.shared.renderkit.html.HtmlButtonRendererBase.encodeEnd(HtmlButtonRendererBase.java:209)
at javax.faces.component.UIComponentBase.encodeEnd(UIComponentBase.java:657)
at javax.faces.component.UIComponentBase.encodeAll(UIComponentBase.java:537) 
```

# powershell - 从 Powershell 的列表中交互式选择

> ID：10705901
> 
> 赞同：7
> 
> 时间：2012-05-22T16:12:12.800
> 
> 标签：powershell, menu

是否有插件或工具可以让我向用户显示对象列表（`Format-Table`样式）并允许他们使用光标从列表中选择一个选项，包括可能滚动一个长列表？我希望能够做这样的事情：

`Get-User -anr $search |`**`Get-Choice`**`| Set-User -EnableAccount true`

此脚本应在控制台提示符下显示匹配帐户的列表，允许用户交互地上下滚动列表，并通过按 Enter 选择一个选项（如果用户点击转义，则传递 null）。只会将一个帐户传递给 Set-User，而不是所有匹配选项的列表。

显然细节可能会有所不同。虽然我更喜欢控制台版本，但图形版本是可以接受的（弹出一个 Windows 对话框）。确切的击键可能会有所不同。但是应该满足核心目标（接受列表、获取用户输入、输出结果）。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-23T05:02:41.153

在**v3**中：

```
Get-User -anr $search | Out-GridView -PassThru | Set-User -EnableAccount true 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T16:45:33.877

看看[Out-Form](http://poshcode.org/2628)

伪使用：

```
out-form -title "Enable Account" -data (Get-user -anr $search) -columnNames ("AccountName") `
    -columnProperties ("SamAccountName") -actions @{Enable It!" = { $_ | Set-User -EnableAccount true}} 
```

# java - 如何在泛型类的继承方法中获取属性值？

> ID：10705910
> 
> 赞同：2
> 
> 时间：2012-05-22T16:12:35.670
> 
> 标签：java, generics, multiple-inheritance

我正在编写如下代码，我需要从父类的静态方法中获取子类的值。

有人可以帮我解决吗？先谢谢了。

```
public abstract class DataObject<T>{
    public static int GetAllTotal(){
        // How can I obtain a T propery called "code" = "001". 
        int cont = SQL.getTotalFromQuery(
                           "SELECT * from tblProducts where code = '001'"
        );
       return ffff
    }

    ...
}

public class Product extends DataObject<Product>{
    private String code = "001";
    public Product(){
    }
}

...

Product.GetAllTotal(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T16:17:45.183

您需要使用以下内容：

```
super.GetAllTotal(); 
```

在子（派生）类中。

`super`java中派生类的父类的引用在哪里？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T16:19:41.253

首先，您需要一个类的对象才能从静态方法动态访问成员。

然后，您可以在父类中定义一个公共`getCode()`函数，在子类中覆盖该函数，该函数返回`code`成员变量的值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-22T16:19:24.913

使用关键字`super`访问父类的引用。在你的情况下，

```
super.GetAllTotal(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-22T17:28:06.650

我们不能使 GetAllTotal 方法参数化以接受参数，或者它们在更改方法定义方面存在一些限制

```
GetAllTotal(String code) 
```

# data-structures - 用于存储调试符号的数据结构

> ID：10705913
> 
> 赞同：0
> 
> 时间：2012-05-22T16:12:37.377
> 
> 标签：data-structures, associative

我需要存储所有调试符号（为简单起见，只有函数名+地址）。我没有函数大小。喜欢：

> _printf 0x1234
> 
> _fprintf 0x1255
> 
> _scanf 0x1300

我需要一个非常快速的算法来通过地址确定函数名称，例如：

> 0x1258 - _fprintf+0x3

简单的 STL 映射远没有用处。什么样的数据结构适合这里？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T16:36:20.887

您需要将单词大小的键映射到字符串表吗？一个 endian [patricia trie](http://en.wikipedia.org/wiki/Radix_tree)应该既节省时间又节省空间。每个分支的 int 标记中的一位。在某些社区中也称为*Int Maps 。*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T18:27:56.563

我认为它更简单：只需使用 STL map::lower_bound()。

# javascript - 用连字符替换字符串中的空格

> ID：10705916
> 
> 赞同：11
> 
> 时间：2012-05-22T16:12:42.547
> 
> 标签：javascript, recursion, indexof

我有一个字符串，我需要修复它才能将其附加到查询中。

假设我有字符串“A Basket For Every Occasion”，我希望它是“A-Basket-For-Every-Occasion”

我需要找到一个空格并用连字符替换它。然后，我需要检查字符串中是否还有其他空格。如果不是，则返回固定字符串。如果是这样，请再次运行相同的过程。

对我来说听起来像是一个递归函数，但我不知道如何设置它。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-05-22T16:14:53.537

您可以像这样使用正则表达式替换：

```
var str = "A Basket For Every Occasion";
str = str.replace(/\s/g, "-"); 
```

正则表达式中的“g”标志将导致所有空格被替换。

* * *

您可能希望将多个空格折叠成一个连字符，这样您就不会在一行中出现多个破折号。看起来像这样：

```
var str = "A Basket For Every Occasion";
str = str.replace(/\s+/g, "-"); 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-05-22T16:15:49.340

全局使用替换和查找空格`\s`（标志 g）

```
var a = "asd asd sad".replace(/\s/g,"-"); 
```

一个变成

```
"asd-asd-sad" 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-22T18:35:11.397

尝试

```
value = value.split(' ').join('-'); 
```

我用它来摆脱我的空间。我没有使用连字符，而是将其设为空并且效果很好。也是所有的JS。`.split(limiter)`将删除限制器并将字符串片段放入数组中（没有限制器元素），然后您可以使用连字符连接数组。

# magento - Magento：以编程方式更改小部件的配置

> ID：10705917
> 
> 赞同：5
> 
> 时间：2012-05-22T16:12:45.343
> 
> 标签：magento, widget, config

我想从小部件的代码中更改和保存小部件的配置。我正在寻找这样的东西：

```
class My_Module_Block_Widget
    extends Mage_Catalog_Block_Product_List
    implements Mage_Widget_Block_Interface
{
    // ...
    protected function _beforeToHtml()
    {
        // ...
        if(/* data needs to be changed */)
        {
            // assuming "widget_config_data" to be one of the widget's
            // parameters configured in the etc/widget.xml file of my module
            $this->setData("widget_config_data", "New Data");
            $this->save();
        }
        // ...
    }
    // ...
} 
```

由于小部件不是模型，因此它们没有 save() 方法。那么如何保存我的小部件的更改数据？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-22T17:05:04.820

这将是棘手的，并且可能更多地涉及单个堆栈溢出问题。这里有一些背景可以帮助您入门。您在上面处理的类/对象是一个块类。块用于呈现 HTML。正如您所指出的，它们是无国籍的。

该块从小部件实例模型对象中获取其数据。

```
Mage::getModel('widget/widget_instance');
Mage_Widget_Model_Widget_Instance 
```

这些对象的状态（您尝试更改的数据）位于表中`widget_instance`

问题是，块对象对小部件实例对象一无所知。小部件通过存储在数据库中的特殊布局句柄插入到页面布局中（这是一种过度简化，因为您可以在布局系统上写[一本书）。](http://store.pulsestorm.net/products/no-frills-magento-layout)您的实例小部件显示在页面上的原因是因为页面布局已经更新了类似这样的信息

```
<reference name="content">
    <block type="cms/widget_page_link" name="48fc761f38fa9838fcc3a3b498c47f72" template="cms/widget/link/link_block.phtml">
        <action method="setData">
            <name>anchor_text</name>
            <value>asdfasdfsad</value>
        </action>
        <action method="setData">
            <name>title</name>
            <value>asdfasdfasdfasd</value>
        </action>
        <action method="setData">
            <name>page_id</name>
            <value>2</value>
        </action>
    </block>
</reference> 
```

没有对小部件实例 ID 的引用，这意味着您无法加载实例对象。

理论上，您可以尝试根据参数值加载小部件实例，因为它们**存储**在数据库中。但是，它们存储在`widget_paramater`列中，是一个序列化的字符串。这意味着您不能使用 SQL 或模型过滤器来查询它。您必须加载特定实例类型/主题/存储的所有小部件实例，然后手动`foreach`完成，直到找到正确的对象。这对于少量的小部件可能是有效的，但对于大量的小部件来说很快就会变得无效。此外，这不能保证有效，因为您的小部件参数的值可能已被其他布局更新代码更改（尽管不太可能）。

更好（也更耗时）的方法是重写小部件插入代码，使其在布局更新 XML 中包含页面 id。这会将实例 ID 传递给小部件块代码，允许您实例化小部件实例对象并保存它。您还可以将字段添加到其自定义类将始终保存实例 ID 的小部件。

祝你好运！

# javascript - 如何将变量绑定到 jquery ajax 请求？

> ID：10705921
> 
> 赞同：4
> 
> 时间：2012-05-22T16:12:58.803
> 
> 标签：javascript, jquery, ajax, data-binding, jquery-deferred

这是不言自明的：

```
while (...) {
    var string='something that changes for each ajax request.';
    $.ajax({'type': 'GET','dataType': 'json', 'url': 'get_data.php'}).done(processData);
}
function processData(data) {
    // get string into here somehow.
} 
```

正如你所看到的，我需要以某种方式`string`进入`processData`。我无法创建全局变量，因为`string`每个 ajax 请求都不同。所以，问题是，我如何绑定`string`到我的 ajax 请求，以便我可以从中访问它`processData`？

我真的不想附加`string`到查询并让服务器返回它，但如果这是我唯一的选择，我别无选择。

提前致谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-22T16:15:37.347

以这种方式尝试：

```
while (...) {

    var str = 'something that changes for each ajax request.';

    (function(_str) {
        $.ajax({'type': 'GET','dataType': 'json', 'url': 'get_data.php'})
         .done(function(data) {
            processData(data, _str);
         });
    }(str));
}

function processData(data, str) {
  console.log(data, str);
} 
```

并且没有使用全局变量:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-22T16:15:25.207

```
var string='something that changes for each ajax request.';
// Use a closure to make sure the string value is the right one.
(function() {
    // Store the "string" context
    var that = this;
    $.ajax({
        'type': 'GET',
        'dataType': 'json',
        'url': 'get_data.php'
    }).done(
        $.proxy( processData, that )
    );
}(string));

function processData( data ) {
    this.string === 'something that changes for each ajax request.' // true
} 
```

[`$.proxy`](http://api.jquery.com/jQuery.proxy/)是[`.bind()`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Function/bind).

您可以按照@Joel 的建议添加一个参数（在他删除的答案中），但[参数越少越好](https://softwareengineering.stackexchange.com/a/145073/42132)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-05-17T20:07:58.800

```
$(document).bind("ajaxSend",function(){
    $("#ajax_preloader").show();
}).bind("ajaxComplete",function(){
    $("#ajax_preloader").hide();
}); 
```

# python - python项目的facebook永久/长期访问密钥

> ID：10705922
> 
> 赞同：1
> 
> 时间：2012-05-22T16:13:02.193
> 
> 标签：python, facebook, facebook-graph-api, facebook-access-token

我一直在使用 fbconsole 开发一个 python 程序，随着时间的推移从 facebook 获取大量数据，我不想每两个小时刷新一次这个访问密钥。显然我已经用谷歌搜索了很多并搜索了stackoverflow，但我仍然很困惑。是否有 60 天的访问令牌？我看到有些人谈论获取应用程序 ID 和秘密，但这不是 Facebook 上的应用程序。无论如何，如果有人能为我打破它并消除混乱，我将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T16:25:27.537

对于长期存在的访问令牌，您有两种选择：

1.  使用[客户端身份验证](http://developers.facebook.com/docs/authentication/client-side/)过程，获取一个短暂的令牌，然后使用引入的[新端点](http://developers.facebook.com/roadmap/offline-access-removal/)交换它，以“替换”已弃用的“offline_access”权限。

2.  使用[服务器端身份验证](http://developers.facebook.com/docs/authentication/server-side/)过程，这将导致长期访问令牌（60 天）。

# java - Java - 将对象转换为映射以在 JSON 中使用

> ID：10705925
> 
> 赞同：0
> 
> 时间：2012-05-22T16:13:10.447
> 
> 标签：java, json, dictionary, map

我有一个对象，我们就叫它吧

```
class Foo {
    String greeting = "Hello";
    int age = 21;
} 
```

我想转换为这样的地图，`"greeting" => "Hello", "age" => 21`这将用作参数`JSONSerializer.toJSON(arg)`

Perl 和 Python 等语言非常擅长这种交换。在 Java 中执行此操作的好方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T16:14:43.733

您不需要在序列化之前进行此转换。

Gson 将直接使用您的对象并使其成为 JSON 映射。

使用这个例如：

```
Gson gson = new GsonBuilder().create();
writer.write(gson.toJson(foo)); // foo is an instance of Foo 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T16:23:47.293

您可以直接使用[Jackson](http://jackson.codehaus.org/)来序列化 POJO。开箱即用，效果非常好。

```
import java.io.Writer;
import java.io.StringWriter;
import org.codehaus.jackson.map.ObjectMapper;

Foo foo = new MyFoo("hello", 21);
ObjectMapper mapper = new ObjectMapper();
Writer writer= new StringWriter();
mapper.writeValue(writer, foo);
String json = writer.toString();
System.out.println(json); 
```

# c# - 默认窗口窗体调整大小行为

> ID：10705930
> 
> 赞同：1
> 
> 时间：2012-05-22T16:13:25.070
> 
> 标签：c#, .net, winforms, resize

如果我创建了一个表单应用程序并且没有指定任何不寻常的东西（只是使用 Visual Studio 的设计器拖放控件），那么在调整窗口大小时我应该期待什么行为？它会根据我使用的控件而有所不同吗？我可以参考这个地方的详细文档吗？

（我讨厌问一些如此含糊和做作的事情，但我无权访问 Visual Studio，而且这样做的开发人员也没有提供帮助。据我所知，他们使用的是 C#，而不是使用任何类型的布局面板。 )

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T16:16:32.467

在我看来，您需要了解各种组件的锚定和对接、它们如何结合在一起以及它们在调整表单大小时的行为方式。请参阅[此链接](http://www.codeproject.com/Articles/2231/Working-with-Anchoring-and-Docking-Properties)以获取有关如何有效执行此操作以及各种选项如何工作的指南。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T16:21:24.203

默认情况下，WinForm 应用程序上的控件不会调整大小。查看在控件上使用 Anchor 属性。例如。如果您希望在扩大表单时扩大按钮，请转到按钮上的 Anchor 属性并锚定左侧和右侧。当表单变宽时，这将加宽按钮。

您可以将锚视为表单移动时被“拉动”的部分。

看到这篇文章： [在winform中自动调整控件大小](https://stackoverflow.com/questions/1623746/auto-size-the-controls-in-winform)

# opengl - 使用余弦函数的OpenGL颜色插值？

> ID：10705931
> 
> 赞同：3
> 
> 时间：2012-05-22T16:13:25.313
> 
> 标签：opengl, colors, glsl, interpolation

我想渲染一个四边形，我希望四边形的一侧为白色，另一侧为黑色。我需要它来模拟余弦函数，而不是对它们之间的像素进行简单的线性颜色插值。

解决这个问题的好方法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-22T17:36:53.287

您可以在片段着色器中执行此操作。IE：

```
gl_FragColor = vec4( vec3( cos( in_TexCoord.x ) ), 1.0 ); 
```

您可以根据需要为每个颜色通道调整幅度和相位的精确值。

# c - 未分配值

> ID：10705938
> 
> 赞同：0
> 
> 时间：2012-05-22T16:13:48.990
> 
> 标签：c

这是我的小片段，给我带来了问题：

```
int main(int argc, char** argv) {

char string[75] = {0};
char *pChar;
int count = 0;

printf("String: ");
fgets(string, sizeof string, stdin);

printf("Numero parole: %d\n", countWords(string, strlen(string)));

// Suddivido la stringa nelle varie parole
pChar = strtok(string, " ");
while(pChar){
    if(isWord(pChar, strlen(pChar))){

        count += strlen(pChar);

    }
    pChar = strtok(NULL, " ");

}

printf("Lettere totali: %d\n", count);

return (EXIT_SUCCESS); 
```

}

问题是没有为计数变量分配任何值。我知道有问题，但我仍然不知道出了什么问题。

谢谢帮忙^^

*PS我目前正在学习C，所以这可能是一个愚蠢的问题。*

*PPS 根据要求，这里是 isWord 函数：（不要介意他们用意大利语的评论）*

```
// Controlla se è una parola
int isWord(char string[], int length){

int i = 0;                  // Contatore
int countAlpha = 0;         // Se il carattere è alfabetico. Non vengono
                            // contate le parole che contengono numeri

// Inizio scorrendo tutta la stringa tranne l'ultimo carattere che è un
// terminatore di stringa
for(i; i < length - 1; i++){

    // Se il carattere è alfabetico allora aumento il contatore isAlpha
    if(isalpha(string[i])){

        countAlpha++;

    // Altrimenti il carattere non è una lettera
    } else {

        countAlpha = 0;

    }

}

if(countAlpha == i){

    return 0;

} else {

    return 1;

} 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T16:21:27.340

如果`count`没有增加，那么这是由于以下原因之一：

a)`strlen(pChar);`返回 0

b)`if(isWord(pChar, strlen(pChar)))`永远不是真的

c)`while(pChar)`永远无效

您可以通过使用交互式调试器并在代码执行时逐行单步执行代码来验证哪些工作有效，哪些无效。

根据您自首次发布以来的其他更改，看来问题出在您的`isWord`功能上。似乎该函数返回的值与您的意思相反。更改它，以便`if(countAlpha == i)`返回 1（表示真）和它的`else`返回 0（表示假）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T16:25:54.440

fgets 可能会存储一个换行符，因此 isWord 返回 false，因为 isalpha('\n') 为 false。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-23T18:40:24.213

小片段可能带有一些代码解释:)

顺便说一句，正如其他人指出的那样，问题出在函数的返回值上，`isWord`但更重要的是，您为什么要做所有这些工作？

`isWord`如果单词由所有字母组成，则该函数应该计数。如果是，则返回成功代码，否则返回失败代码。成功时的主函数将增加`strlen`字符串的计数。

但这都是必要的吗？

建议的更改：而不是返回错误代码或成功代码，然后返回成功和失败的字符总数`strlen`并相应地增加。这将为您节省函数调用:)`isWord``-1``count``strlen`

这似乎好多了:) 你不同意吗？

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

int isWord(char string[], int length){

int i = 0,countAlpha = 0;

for(; i < length - 1; i++){

    if(!isalpha(string[i])){

        countAlpha = -1;
        break;

    }else {

        countAlpha++;

    }

}

return countAlpha;

} 

int main(int argc, char* argv[]){

char string[75] = {0};
char *pChar;
int ret = 0,count = 0;

printf("String: ");
fgets(string, sizeof string, stdin);

// Suddivido la stringa nelle varie parole
pChar = strtok(string, " ");

while(pChar){

    if( (ret=isWord(word, strlen(word))) != -1){

        count += ret;

    }

    pChar = strtok(NULL, " ");  

}

printf("Lettere totali: %d\n", count);

return 0;
} 
```

# javascript - 使用 Jsp 和 Javascript 将数据导出到 CSV 文件

> ID：10705943
> 
> 赞同：1
> 
> 时间：2012-05-22T16:14:14.980
> 
> 标签：javascript, jsp, csv, graph

在我的项目中，我有一些代码，例如

```
<script type="text/javascript">
var fnames = ["aa","bb","cc","dd"];

var lnames = ["rr","bb","ff","kk"];
</script> 
```

abod 代码在一个 Jsp 文件中，使用上述数据我们正在创建一个折线图，现在我想将该图表数据导出到 CSV 文件。我对此没有任何想法，任何人都可以在这方面帮助我。

# mysql - 如何使用 Doctrine2 和 MySQL 执行存储过程

> ID：10705953
> 
> 赞同：15
> 
> 时间：2012-05-22T16:14:53.780
> 
> 标签：mysql, stored-procedures, symfony, doctrine-orm

我在 Symfony2 应用程序中工作，我需要使用存储过程来执行一些高性能进程。

有什么方法可以使用 Doctrine2 执行（和管理参数）MySQL 存储过程？

**解决方案：**

```
$em = $this->getDoctrine()->getEntityManager();
$qb = $em->createNativeQuery(
        'CALL USR_P_UserRegistration (' .
            ':iduser, :name, :surname, :birthday, :idlang, :idregistry' .
        ')',
        new ResultSetMapping()
    );
$qb->setParameters(
    array(
        'iduser' => $c->getIduser(),
        'name' => $c->getName(),
        'surname' => $c->getSurname(),
        'birthday' => $c->getBirthday(),
        'idlang' => $c->getIdlang(),
        'idregistry' => $c->getIdregistry()
    ));
$qb->execute();
$em->flush(); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-22T16:37:08.020

您可以使用 Native SQL，甚至可以使用存储过程进行数据检索。

[doc 本机 sql](https://www.doctrine-project.org/projects/doctrine-orm/en/2.6/reference/native-sql.html)

或者您可以查看此链接

[如何在 Symfony 和 Doctrine 中使用存储过程](https://stackoverflow.com/questions/3198647/how-to-use-stored-procedures-with-symfony-and-doctrine)

# c# - 在 XML CDATA 中读取和操作 HTML

> ID：10705955
> 
> 赞同：0
> 
> 时间：2012-05-22T16:14:57.090
> 
> 标签：c#, xml, cdata

当我从 XML CDATA 部分获取 HTML 时，对其进行操作（在我的情况下，对 CDATA 部分中的文本执行 C# 字符串方法），然后显示编辑后的版本......它会自动注释掉我的第一个 HTML 标记：

```
<![CDATA[ <p>Lorem ipsum dolor sit amet...</p> ]]> 
```

在页面上转换为此：

```
<!--[CDATA[ <p--> Lorem ipsum dolor sit amet... ]]> 
```

这会破坏第一段的样式并在内容之后呈现结束的 CDATA 标记。

我该如何解决？

**编辑：** 我找不到任何关于这个的东西，所以我尝试了一些关于便便和咯咯笑的东西，这很有效：

```
<![CDATA]> <p>Lorem ipsum dolor sit amet...</p> </]]> 
```

在页面上转换为：

```
<!--[CDATA]--> <p>Lorem ipsum dolor sit amet...</p> <!--]]--> 
```

但是...我不确定这是否会对我的页面产生负面影响？

还有其他方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T19:56:07.837

在包含 CDATA... 的 XML 元素上使用`XmlNode.InnerXml`时，它会注释掉第一个元素。

使用`XmlNode.InnerText`和 CDATA 将工作。

如果你*必须*使用 InnerXml... 你可以省略 CDATA 标签，它也可以工作。

如果您同时需要**InnerXml**和 CDATA，我没有答案……或者两者一起使用的场景

# asp.net-mvc-3 - 在依赖方上使用被动联合身份和登录页面实施 SSO

> ID：10705959
> 
> 赞同：0
> 
> 时间：2012-05-22T16:15:21.567
> 
> 标签：asp.net-mvc-3, wif, single-sign-on, federated-identity, sts-securitytokenservice

我们使用被动联合身份（C#、ASP.Net MVC 3、WIF）为一组具有不同域名的网站实施了 SSO（单点登录）。该设置工作正常，因为它遵循标准的被动联合，登录页面托管在 STS 上。

www.brand1.com
www.brand2.com
...
www.sts.com（登录页面托管在这里）

现在客户端希望在每个依赖方上实现登录页面，这样用户就不会被重定向到 STS。原因是每个依赖方都是已知品牌，因此重定向到不同的域名（托管 STS）对于各自的品牌是不可接受的。在 STS 上为每个品牌定制登录页面也是不可接受的。

有没有办法将登录页面移动到依赖方？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T18:53:34.813

您可以使用两条路线：

1.  [您可以在每个使用活动联合](http://www.alexthissen.nl/blogs/main/archive/2011/07/18/using-active-profile-for.aspx)身份验证您的用户的信赖方上创建一个登录页面。这取决于提供 WS-Trust 端点的 STS。
2.  如果您可以控制 STS 代码，则可以简单地让您的依赖方将登录凭据（用户名/密码）发布到 STS，STS 站点将像以前一样处理身份验证请求。这是我过去成功使用的一种方法。

希望这会有所帮助。

# vba - Getting mailaddresses out of recipients of an mailItem

> ID：10705962
> 
> 赞同：0
> 
> 时间：2012-05-22T16:15:31.893
> 
> 标签：vba, outlook

I been trying to find out a way to find out which mail addresses a mail has been sent to. Consider the following:

```
Private Sub Application_NewMailEx(ByVal EntryIDCollection As String)
    Dim mai As MailItem
    Dim intInitial As Integer
    Dim intFinal As Integer
    Dim strEntryId As String
    Dim intLength As Integer

    intInitial = 1
    intLength = Len(EntryIDCollection)
    intFinal = InStr(intInitial, EntryIDCollection, ",")
    Do While intFinal <> 0
        strEntryId = Strings.Mid(EntryIDCollection, intInitial, (intFinal - intInitial))
        Set mai = Application.Session.GetItemFromID(strEntryId)
        intInitial = intFinal + 1
        intFinal = InStr(intInitial, EntryIDCollection, ",")
    Loop
    strEntryId = Strings.Mid(EntryIDCollection, intInitial, (intLength - intInitial) + 1)
    MsgBox strEntryId
    Set mai = Application.Session.GetItemFromID(strEntryId)
    For Each Recipient In mai.Recipients
        MsgBox Recipient
    Next
End sub 
```

In those msgBoxes I get the "nice name", Like "John Doe" - but I want to get the mail address, "john.doe@gmail.com".

How can I achieve this?

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-24T00:16:58.340

I assume this is Outlook 2007+. Have you tried the [Address Property](http://msdn.microsoft.com/en-us/library/bb175708%28v=office.12%29.aspx)?

```
For Each Recipient In mai.Recipients
  MsgBox Recipient.Address
Next Recipient 
```

This should print the email address of each recipient.

# shell - WKHTMLTOPDF 不返回任何内容

> ID：10705963
> 
> 赞同：0
> 
> 时间：2012-05-22T16:15:36.377
> 
> 标签：shell, unix, pdf-generation, wkhtmltopdf

我正在尝试使用命令行转换器 WKHTMLTOPDF 将 html 页面转换为 pdf。它不会返回任何东西，也不会抛出任何错误。

```
[root@s16271040 var]# grep -i amd /proc/cpuinfo
[root@s16271040 var]# grep -i intel /proc/cpuinfo
vendor_id       : GenuineIntel
model name      : Intel(R) Xeon(R) CPU E31270 @ 3.40GHz
vendor_id       : GenuineIntel
model name      : Intel(R) Xeon(R) CPU E31270 @ 3.40GHz
vendor_id       : GenuineIntel
model name      : Intel(R) Xeon(R) CPU E31270 @ 3.40GHz
vendor_id       : GenuineIntel
model name      : Intel(R) Xeon(R) CPU E31270 @ 3.40GHz
vendor_id       : GenuineIntel
model name      : Intel(R) Xeon(R) CPU E31270 @ 3.40GHz
vendor_id       : GenuineIntel
model name      : Intel(R) Xeon(R) CPU E31270 @ 3.40GHz
vendor_id       : GenuineIntel
model name      : Intel(R) Xeon(R) CPU E31270 @ 3.40GHz
vendor_id       : GenuineIntel
model name      : Intel(R) Xeon(R) CPU E31270 @ 3.40GHz

[root@s16271040 bin]# ls -la | grep -i pdf
-rw-r--r--  1 root root    8224273 May 24  2010 wkhtmltopdf-0.9.9-static-i386.tar.bz2
-rwxrwxrwx  1 root root    8218920 May 24  2010 wkhtmltopdf-i386
-rwxrwxrwx  1 root   1000 11446024 Oct  2  2011 wkhtmltopdf-i386_11
-rw-r--r--  1 root root   11414685 Oct  2  2011 wkhtmltopdf-i386.tar.bz2

[root@s16271040 bin]# wkhtmltopdf-i386 http://google.com test.pdf
[root@s16271040 bin]# ls -la | grep -i test.pdf 
```

我正在尝试的版本是 0.9.9，取自[http://code.google.com/p/wkhtmltopdf/downloads/list](http://code.google.com/p/wkhtmltopdf/downloads/list) 我尝试了最新的版本 - 0.11.0。仍然没有成功

任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T21:10:34.223

`wkhtmltopdf`需要一个 x 实例，可能由 xvfb 提供，它没有运行真正的 x 服务器，[例如这里提到的](http://ciaranmcnulty.com/blog/2009/04/converting-html-to-pdf-using-wkhtmltopdf)。

万一该链接将来失效，例如：

```
xvfb-run -a -s "-screen 0 640x480x16" wkhtmltopdf --dpi 200 --page-size A4 http://domain.tld/page.html /path/to/output.pdf 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T18:01:04.137

你至少应该得到某种形式的输出。至少是一个错误。您使用的是哪个操作系统？如果基于 Debian 的尝试 apt-get install wkhtmltopdf，如果您在服务器上而不是桌面上，那么上面的答案是正确的，您需要一个正在运行的 X11 服务器或一个模拟的服务器，例如 Xvfb。

# ruby - 在字符串上使用 Ruby，如何使用 RegEx 在字符串的两个部分之间进行切片？

> ID：10705969
> 
> 赞同：4
> 
> 时间：2012-05-22T16:15:47.403
> 
> 标签：ruby, regex

我只想将字符串中两个特定点之间的文本保存到变量中。文本如下所示：

```
..."content"=>"The text I want to save to a variable"}]... 
```

我想我必须使用扫描或切片，但不完全确定如何在不抓取文本前后的正则表达式标识符的情况下仅提取文本。我试过这个，但没有奏效：

```
var = mystring.slice(/\"content\"\=\>\".\"/) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-22T16:24:20.860

这应该做的工作

```
var = mystring[/"content"=>"(.*)"/, 1] 
```

注意：

*   `.slice`别名`[]`
*   您转义的所有字符都不是您使用它们的特殊正则表达式字符
*   您可以“分组”您想要保留的位`()`
*   `.slice`/`[]`取第二个参数来选择匹配的组

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-22T16:28:26.120

```
your_text = '"content"=>"The text I want to save to a variable"'
/"content"=>"(?<hooray>.*)"/ =~ your_text 
```

之后，万岁局部变量将被神奇地设置为包含您的文本。可用于设置多个变量。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-22T16:21:48.593

此正则表达式将匹配您的字符串：

```
/\"content\"=>\"(.*)\"/ 
```

您可以尝试 rubular.com 进行测试

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-22T16:24:10.693

看起来您正在尝试截断一个句子。您可以在标点符号甚至单词上拆分句子。

```
mystring.split(".")
mystring.split("word") 
```

# sql - 如何创建触发器以使用双键修改表上的日期列

> ID：10705974
> 
> 赞同：0
> 
> 时间：2012-05-22T16:16:00.170
> 
> 标签：sql, sql-server, triggers, audit

我需要创建一个触发器，在插入或更新时将当前日期和时间戳保存到行中。

表结构

```
[Period] [char](7) NOT NULL,
[CompanyAlfaCode] [char](2) NOT NULL,
[SamplePercentaje] [int] NULL,
[Usuario] [varchar](50) NULL,
[Date] [Datetime] NULL, 
```

非常感谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T16:51:32.203

也许是这样的：

```
CREATE TRIGGER DateTrigger ON CompanySampleConfig
AFTER INSERT,UPDATE
AS
BEGIN
  UPDATE CompanySampleConfig SET [Date] = current_timestamp
  WHERE EXISTS
  (SELECT '' FROM inserted
  WHERE CompanySampleConfig.[Period] = inserted.[Period]
    AND CompanySampleConfig.[CompanyAlfaCode] = inserted.[CompanyAlfaCode]
END 
```

# mysql - 两张（非常）大桌子的交集

> ID：10705976
> 
> 赞同：0
> 
> 时间：2012-05-22T16:16:12.377
> 
> 标签：mysql, phpmyadmin

我有两张桌子：`all_users`和`vip_users`

`all_users`table 有我系统中所有用户的列表（你不说？），它目前有大约 57k 条记录，而`vip_users`table 有大约 37k 条记录。

两个表中的主键都是自动增量`id`字段。`all_users`table 的属性数量很大（大约 20 个，其中之一是`email`），而`vip_users`table 只有（以及`id`）`email`属性。

我想通过这样做来查询“非Vip”用户（在[这个问题](https://stackoverflow.com/questions/367863/sql-find-records-from-one-table-which-dont-exist-in-another)的帮助下）：

```
SELECT all_users.id, all_users.email
FROM all_users 
LEFT OUTER JOIN vip_users 
    ON (all_users.email=vip_users.email) 
WHERE vip_users.email IS NULL 
```

现在，终于遇到问题了——我在 phpmyadmin 中运行了这个查询，即使在 20 分钟后，我也被迫关闭它并重新启动 httpd 服务，因为它需要很长时间才能完成，我的服务器负载跳过了 2 和站点（也查询数据库）变得无用，因为它只是加载太慢。所以，我的问题是 - 我该如何进行这个查询？我是否制作一些脚本并在夜间运行它 - 不使用 phpmyadmin（这可能是问题所在吗？），还是我需要使用不同的 SQL 查询？

请帮助您对此的想法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T16:43:22.993

尝试索引两个表上的电子邮件字段，这应该会加快查询速度

```
CREATE INDEX useremail ON all_users(email)

CREATE INDEX vipemail ON vip_users(email) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T16:26:33.043

我认为`NOT IN`比`LEFT OUTER JOIN`.

你能试一下吗 -

```
SELECT *
FROM all_users
WHERE id NOT IN (SELECT id 
                 FROM vip_users
                 WHERE email IS NULL); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-22T16:31:04.403

如所写，您没有得到您正在寻找的结果。您正在查找电子邮件与用户中的电子邮件匹配的 vip_users 行，并且该行也是 NULL。

您是否有理由希望 vip_users 拥有与用户不同的 id？如果您将 vip_users id 字段更改为 users id 字段上的 fk，那么您会将您的选择更改为：

```
SELECT all_users.id, all_users.email
FROM all_users 
LEFT OUTER JOIN vip_users 
    ON (all_users.id=vip_users.id) 
WHERE vip_users.email IS NULL; 
```

这个查询没有理由花费任何时间。37k 条记录不是一个很大的表....

# ajax - Ajax 请求的 Django 字符编码错误

> ID：10705982
> 
> 赞同：1
> 
> 时间：2012-05-22T16:16:47.573
> 
> 标签：ajax, django, unicode

我有一个从数据库生成的表单。在数据库中，我有诸如“Española”之类的字符串，它将成为下拉菜单中的选项。

我的 html 看起来像这样的那一刻：

```
<option value="Española">Española</option> 
```

我将这些值用于我需要从中发送 AJAX 请求的表单的动态部分。

我可以看到，在使用 IE 时，标题是这样的：

```
GET /collections/find_island?island_group=Espa�ola HTTP/1.1" 500 63206 
```

什么时候应该：

```
GET /collections/find_island/?island_group=Espa%C3%B1ola HTTP/1.1" 200 164 
```

由其他浏览器生成。

有什么方法可以在我的模板中得到这个输出：

```
<option value="Espa%C3%B1ola">Española</option> 
```

非常感谢任何帮助。

编辑：

我的表格：

```
def form(forms.Form):
    ...
    island_group = forms.ModelChoiceField(
    required=False,
    label=ugettext_lazy('Island Group'), 
    initial=None,
    queryset=Localityonline.objects.values_list('islandgroup', flat=True).distinct('islandgroup').order_by('islandgroup'), 
    empty_label=ugettext_lazy("Not Specified"), 
    widget=forms.Select(attrs={"class":'searchfield', "onChange":'getIslandName()'})
) 
```

的JavaScript：

```
function getIslandName(lang) {
var islandGroup = document.getElementById("id_island_group").value;

if (islandGroup == '') {
    // if Not Specified re-selected then set data to null and bypass updatePage()
    var data = null; 
    update_select($('select[name=island_name]'), data);
} 
else {
    var url = "../collections/find_island?island_group=" + islandGroup;
    request.open("GET", url, true);
    request.onreadystatechange = updatePage;
    request.send(null);
    }    
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T16:52:34.360

您可以调用`encodeURI`javascipt 以提供您正在寻找的编码值。也许 Mozilla 和 chrome 会自动完成，而 IE 不会？

```
encodeURI('Española')
// "Espa%C3%B1ola"

var url = "../collections/find_island?island_group=" + encodeURI(islandGroup); 
```

或编码整个网址我不知道哪个更有意义......

[在 JavaScript 中编码 URL？](https://stackoverflow.com/questions/332872/how-to-encode-a-url-in-javascript)

[https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/encodeURIComponent](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/encodeURIComponent)

[https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/encodeURI](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/encodeURI)

# html - 在 HTML 中创建流程图

> ID：10705983
> 
> 赞同：5
> 
> 时间：2012-05-22T16:16:47.900
> 
> 标签：html, css, flowchart

我是一个完整的 CSS/HTML 菜鸟，并且已经尝试创建流程图几个小时了，但收效甚微。我正在尝试创建类似的东西：http: [//jsfiddle.net/pointbypointuk/ETg7q/2 /](http://jsfiddle.net/pointbypointuk/ETg7q/2/)

但是我只想要 2 个子标题，而不是 4 个。

我将如何去创造这个？我似乎无法得到任何应该排队的东西。

更好的是，是否有免费的软件/库允许您通过绘制流程图来创建流程图，然后将其转换为代码？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-05-22T16:24:45.780

您可能想看看这个[http://thecodeplayer.com/walkthrough/css3-family-tree](http://thecodeplayer.com/walkthrough/css3-family-tree)

# node.js - 如何使用不同的 mongo 数据库设置不同的 node.js 环境？

> ID：10705987
> 
> 赞同：6
> 
> 时间：2012-05-22T16:17:09.897
> 
> 标签：node.js, mongodb

我想在开发中使用本地 mongo 服务器，然后在生产中切换到 mongolab db。在 node.js express 应用程序中执行此操作的推荐方法是什么？我所知道的是 NODE_ENV 存在，但不确定根据其值切换数据库的最佳方式。有：

```
if (process.env.NODE_ENV == "production") 
{
  //
}
else if ((process.env.NODE_ENV == "development") 
{

} 
```

在我查询数据库的所有地方似乎都不是很优雅。有没有一种类似于铁路应用程序的方法，您可以在其中指定用于生产和开发的适配器？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-22T16:29:53.250

您应该只需要在应用程序启动时使用 URL 连接到您的数据库一次，并且您可以使用代码，就像您必须根据运行时环境选择正确的 URL。连接后，您的应用程序应引用共享数据库连接对象以正常执行查询和操作。您可能希望使用配置对象来处理这个问题，正如我在[ExpressJS 如何构建应用程序中所描述的那样？](https://stackoverflow.com/questions/5778245/expressjs-how-to-structure-an-application/7350875#7350875)

# webdriver - 如何在 webdriver 中选择所有具有相同 css 值的元素？

> ID：10705988
> 
> 赞同：0
> 
> 时间：2012-05-22T06:14:04.140
> 
> 标签：webdriver

我有一个树形结构，它具有可扩展的图标，但都具有相同的 Css 值。我的目标是解析不同的行，一旦找到所需的元素，我将单击与其关联的可扩展图标。

我能够解析树并到达所需的元素。但是，每当我尝试使用 css 值单击可扩展图像图标 [比如说第四个图标] 时，它总是选择第一个图标

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T18:01:03.817

您可以使用 GetElements 而不是 GetElement，然后遍历集合，但似乎这可以通过使用 nth-child 的 CSS 选择器更轻松地解决：http: [//www.w3schools.com/cssref/sel_nth-child.asp](http://www.w3schools.com/cssref/sel_nth-child.asp)

# python - 为一个范围组合系数？

> ID：10705990
> 
> 赞同：-1
> 
> 时间：2012-05-22T16:17:28.933
> 
> 标签：python, algorithm

我无法组合系数。基本上我有一个项目列表，并希望为它们获取所有独特的系数组合，如下所示：

```
dog:1 cat:1
dog:2 cat:1
dog:3 cat:1
dog:1 cat:2
dog:2 cat:2 
```

我不太确定这样做的最佳方法（动态编程、递归、蛮力等），所以我尝试从递归开始：

```
list = ["dog", "cat"]

coeff = [1] * len(list)
main_queue = []

def recursion(k, list):
    for item in list[0:k-1]:
        for data in range(5):
            coeff_temp = coeff
            coeff_temp[k] = data
            main_queue.append(coeff_temp)
            #print item, data

    if k == (len(list)-1):
        return
    else:
        recursion(k+1, list)

recursion(0, list)

print "*" * 30

for x in main_queue:
    print x 
```

输出是：

```
******************************
[4, 1]
[4, 1]
[4, 1]
[4, 1]
[4, 1] 
```

它只会更改我创建的主队列中的最后一个条目。我究竟做错了什么？

ps这是最好的方法吗（范围在1-5之间，列表中大约有20-30个项目..我最好使用动态编程）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T16:42:55.990

```
data = ["dog", "cat"]
upto = 4

def all_combos(items, upto):
    if items < 1:
        yield []
    else:
        for r in range(upto+1):
            for rest in all_combos(items-1, upto):
                yield [r] + rest

for coeffs in all_combos(len(data), upto):
    print ", ".join("{}s: {}".format(n, coeff) for n,coeff in zip(data,coeffs)) 
```

结果是

```
dogs: 0, cats: 0
dogs: 0, cats: 1
dogs: 0, cats: 2
dogs: 0, cats: 3
dogs: 0, cats: 4
dogs: 1, cats: 0
dogs: 1, cats: 1
dogs: 1, cats: 2
dogs: 1, cats: 3
dogs: 1, cats: 4
dogs: 2, cats: 0
dogs: 2, cats: 1
dogs: 2, cats: 2
dogs: 2, cats: 3
dogs: 2, cats: 4
dogs: 3, cats: 0
dogs: 3, cats: 1
dogs: 3, cats: 2
dogs: 3, cats: 3
dogs: 3, cats: 4
dogs: 4, cats: 0
dogs: 4, cats: 1
dogs: 4, cats: 2
dogs: 4, cats: 3
dogs: 4, cats: 4 
```

这就是你所追求的。*请记住*，组合的数量将`(len(data))**upto`随着数据的增长而爆炸性地增加。

**编辑：**正如已经指出的那样，实现这一目标的另一种方法是

```
from itertools import product

def all_combos(items, upto):
    return product(*(range(upto+1) for i in range(items))) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T16:29:25.183

你的错误是这一行：

```
coeff_temp = coeff 
```

这不会复制`coeff`: ，它会引用同一个对象。当您在下一行修改它时：

```
coeff_temp[k] = data 
```

您正在修改到目前为止插入的每一个 - 它们都是相同的列表！

要实际复制列表，请使用：

```
coeff_temp = list(coeff) 
```

或者

```
coeff_temp = coeff[:] 
```

* * *

这是解决您问题的最佳方法：

```
import itertools
data = {
    "dog": xrange(1, 5),
    "cat": xrange(1, 5)
    #add more here...
}
combinations = (dict(zip(data.keys(), c)) for c in itertools.product(*data.values()))

for c in combinations:
    print c 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-22T16:42:57.310

在我看来，你想要的是一个 N 位的 base-M 数字，其中 N 是列表中的项目数，M 是每个可能值的数量。

举例来说，如果您在列表中有 3 个项目，并且希望每个项目的值从 1 到 4，那么您将使用 3 位基数为 3 的数字。由于您的第一个数字是`1`，因此您将在将每个数字分配给列表项时为其添加一个。

在此，第一列是您计算时的实际数字，第二列是相同的数字，每个数字加 1，然后分配给三个动物中的每一个的值：

```
000   111     cat 1 dog 1 hamster 1
001   112     cat 1 dog 1 hamster 2
002   113     cat 1 dog 1 hamster 3
010   121     cat 1 dog 2 hamster 1
011   122     cat 1 dog 2 hamster 2
012   123     cat 1 dog 2 hamster 3
020   131     cat 1 dog 3 hamster 1
021   132     cat 1 dog 3 hamster 2
022   133     cat 1 dog 3 hamster 3
100   211     cat 2 dog 1 hamster 1 
```

对于剩余的 3 位基数为 3 的数字，依此类推。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-22T16:27:10.773

如果你想要组合，那么递归几乎总是正确的答案。

您的代码存在问题：在`recursion`函数内部，当您说`coeff_temp = coeff`要复制对 的*引用*时`coeff`，您只是每次都附加相同的列表。这就是为什么 。否则，该方法对我来说似乎很好。

换行

```
coeff_temp = coeff 
```

至

```
coeff_temp = list(coeff) 
```

复制列表，然后从那里继续。

itertools 模块是一个很好的组合解决方案。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-22T16:21:52.130

尝试查看 itertools lib [http://docs.python.org/library/itertools.html](http://docs.python.org/library/itertools.html)在那里你可以找到组合（）函数，它必须帮助你。

# jquery - jquery.validate.js 过期日期如何使用这个验证器添加方法

> ID：10705995
> 
> 赞同：0
> 
> 时间：2012-05-22T16:17:42.267
> 
> 标签：jquery, date, jquery-validate

我有一张信用卡处理表格，其中有 2 个选择字段作为到期日期。像这样

```
<select name="qbms_cc_expires_month" id="qbms_cc_expires_month"><option value="01">01</option><option value="02">02</option><option value="03">03</option><option value="04">04</option><option value="05">05</option><option value="06">06</option><option value="07">07</option><option value="08">08</option><option value="09">09</option><option value="10">10</option><option value="11">11</option><option value="12">12</option></select><span class="required">*</span>&nbsp;<select name="qbms_cc_expires_year" id="qbms_cc_expires_year"><option value="12">2012</option><option value="13">2013</option><option value="14">2014</option><option value="15">2015</option><option value="16">2016</option><option value="17">2017</option><option value="18">2018</option><option value="19">2019</option><option value="20">2020</option><option value="21">2021</option></select> 
```

我已经添加了这个 $.validator.addMethod

```
 $.validator.addMethod(
        "ccexpdate",
    function (value, element) {

        // Initialize todays date   i.e start date
        var today = new Date();
        var startDate = new Date(today.getFullYear(),today.getMonth(),1,0,0,0,0);

        // Initialize End/Expiry date i.e. adding 10 years to expire
        var futureLimitDate= new Date(today.getFullYear()+10,today.getMonth(),1,0,0,0,0);
        var expDate = value;

        var expYearCheck='';

        // Check Date format
        var separatorIndex = expDate.indexOf('/');
        if(separatorIndex==-1)return false; // Return false if no / found

        var expDateArr=expDate.split('/'); 
        if(expDateArr.length>2)return false; // Return false if no num/num format found

        // Check Month for validity
        if(eval(expDateArr[0])<1||eval(expDateArr[0])>12)
        {
            //If month is not valid i.e not in range 1-12
            return false;
        }

        //Check Year for format YY or YYYY
        switch(expDateArr[1].length)
        {
            case 2:expYearCheck=2000+parseInt(expDateArr[1], 10);break; // If YY format convert it to 20YY to it
            case 4:expYearCheck=expDateArr[1];break; // If YYYY format assign it to check Year Var
            default:return false;break;
        }

        // Calculated new exp Date for ja  
        expDate=new Date(eval(expYearCheck),(eval(expDateArr[0])-1),1,0,0,0,0);

        if(Date.parse(startDate) <= Date.parse(expDate))
        {
            if(Date.parse(expDate) <= Date.parse(futureLimitDate))
            {
                // Date validated
                return true;    
            }else
            {

                // Date exceeds future date
                return false;
            }

        }else
        {

            // Date is earlier than todays date
            return false;
        }

    },
    "<br />Must be a valid Expiration Date."
    ); 
```

我如何在我的规则中调用它：{ } 部分？我试过这个 qbms_cc_expires_year: { ccexpdate: { month: '#qbms_cc_expires_month', year: '#qbms_cc_expires_year' } }，但它不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T12:23:03.750

我想通了这一点，希望它可以帮助试图完成同样事情的人。我的问题正在尝试使用`jquery.validate.js`，这`$.validator.addMethod`在下面。我的到期日期有 2 个字段，一个用于 MM“01”月，另一个用于 YYYY 年`"<option value="12">2012</option>"`，因此我将它们组合到另一个文本输入中`MM/YYYY`，并对该字段进行了验证。

```
$.validator.addMethod(
        "ccexpdate",
    function (value, element) {
        // Initialize todays date   i.e start date
        var today = new Date();
        var startDate = new Date(today.getFullYear(),today.getMonth(),1,0,0,0,0);
        // Initialize End/Expiry date i.e. adding 10 years to expire
        var futureLimitDate= new Date(today.getFullYear()+10,today.getMonth(),1,0,0,0,0);
        var expDate = value;
        var expYearCheck='';
        // Check Date format
        var separatorIndex = expDate.indexOf('/');
        if(separatorIndex==-1)return false; // Return false if no / found
        var expDateArr=expDate.split('/'); 
        if(expDateArr.length>2)return false; // Return false if no num/num format found
        // Check Month for validity
        if(eval(expDateArr[0])<1||eval(expDateArr[0])>12)
        {
            //If month is not valid i.e not in range 1-12
            return false;
        }
        //Check Year for format YY or YYYY
        switch(expDateArr[1].length)
        {
            case 2:expYearCheck=2000+parseInt(expDateArr[1], 10);break; // If YY format convert it to 20YY to it
            case 4:expYearCheck=expDateArr[1];break; // If YYYY format assign it to check Year Var
            default:return false;break;
        }
        // Calculated new exp Date for ja  
        expDate=new Date(eval(expYearCheck),(eval(expDateArr[0])-1),1,0,0,0,0);
        if(Date.parse(startDate) <= Date.parse(expDate))
        {
            if(Date.parse(expDate) <= Date.parse(futureLimitDate))
            {
                // Date validated
                return true;    
            }else
            {
                // Date exceeds future date
                return false;
            }
        }else
        {
            // Date is earlier than todays date
            return false;
        }
    },
    "<br />Must be a valid Expiration Date."
    ); 
```

我的到期日期有两个字段，如下所示：

```
<select name="qbms_cc_expires_month" id="qbms_cc_expires_month">
<option value="01">01</option>
<option value="02">02</option>
<option value="03">03</option>
<option value="04">04</option>
<option value="05">05</option>
<option value="06">06</option>
<option value="07">07</option>
<option value="08">08</option>
<option value="09">09</option>
<option value="10">10</option>
<option value="11">11</option>
<option value="12">12</option>
</select>
<select name="qbms_cc_expires_year" id="qbms_cc_expires_year">
<option value="12">2012</option>
<option value="13">2013</option>
<option value="14">2014</option>
<option value="15">2015</option>
<option value="16">2016</option>
<option value="17">2017</option>
<option value="18">2018</option>
<option value="19">2019</option>
<option value="20">2020</option>
<option value="21">2021</option>
</select> 
```

我将此字段添加到第二次选择的末尾：

```
<input type="text" name="qbmsCombined" id="qbmsCombined" value="" style="width:45px;height:16px;" readonly="readonly"> 
```

我的 jQuery 像这样

```
$().ready(function() {
    // combine exp date fields and validate new field
    $("#qbms_cc_expires_month,#qbms_cc_expires_year").change(function() {
       $("input[type='text'][name='qbmsCombined']").val($("#qbms_cc_expires_month").val() + '/' + $("#qbms_cc_expires_year").val());

    });
    // validate signup form on keyup and submit
    $("#checkoutForm").validate({
        rules: {
        qbms_cc_owner: {
                required: true
            },
        qbms_cc_number: {
                required: true,
                minlength: 13,
                maxlength: 16,
                creditcard: true
            },
            qbmsCombined: {
                ccexpdate: true
          },
          qbms_cc_cvv2: {
                required: true,
                minlength: 3,
                maxlength: 4
            },      
        },
        messages: {

            qbms_cc_owner: {
                required: "<br />Please enter the name on the Credit Card"
            },
            qbms_cc_number: {
                required: "<br />Please enter the Credit Card Number",
                minlength: "<br />Credit Card Number must be between 13 and 16 digits",
                maxlength: "<br />Credit Card Number is over 16 digits",
                creditcard: "<br />Credit Card Number is invalid"
            },
              qbms_cc_cvv2: {
                required: "<br />Please enter the Credit Card's Security Code",
                minlength: "<br />Credit Card's Security Code must be at least 3 digits",
                maxlength: "<br />Credit Card's Security Code must be 4 digits or less"
            },
        }

    });

    $('form#checkoutForm').submit(function(evt){
        if($('#checkoutForm').valid())
            return true
        else
        evt.preventDefault();
            return false;

    });
}); 
```