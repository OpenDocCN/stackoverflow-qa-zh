# StackOverflow 问答 000815000-000815999

# c++ - 在 Qt 中，如何按下按钮将旋转框设置为某个值？

> ID：815002
> 
> 赞同：1
> 
> 时间：2009-05-02T15:12:49.583
> 
> 标签：c++, user-interface, qt

我正在尝试掌握 Qt 的信号和插槽机制。我有一个带有 QPushButton 和 QSpinBox 的应用程序。当我单击按钮时，我希望 spinbox 更改为 20。我需要设置什么信号和插槽？

下面的代码显示了该应用程序，连接功能是我遇到的问题。据我了解，QSpinBox 的 setValue(int) 插槽在这里不起作用，因为 QPushButton 的 clicked() 信号具有不同的签名，无论如何我将如何将值 20 传递给 spinbox？我是否需要编写某种辅助函数来充当调用 spinbox->setValue(20) 的插槽？如果是这样，那将采取什么形式？

```
int main(int argc, char *argv[])
{
    QApplication app(argc, argv);

    QWidget *window = new QWidget;
    QSpinBox *spinbox = new QSpinBox;
    QPushButton *button = new QPushButton("Set to 20");

    spinbox->setRange(0, 100);

    // What should I put below?
    QObject::connect(button, SIGNAL(clicked()), spinbox, SLOT(???????));

    QLayout *layout = new QHBoxLayout;
    layout->addWidget(spinbox);
    layout->addWidget(button);
    window->setLayout(layout);

    window->show();

    return app.exec();

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-02T16:08:08.200

你可以这样做：

```
class AuxSignals : public QObject
{
    Q_OBJECT
    ...
    signals:
        void valueChanged(int);
    public slots:
        void buttonClicked() { emit valueChanged(20); }
};

...

// On main.cpp
AuxSignals *auxSignals = new AuxSignals;

QObject::connect(button, SIGNAL(clicked()), auxSignal, SLOT(buttonClicked));
QObject::connect(auxSignals, SIGNAL(valueChanged(int)), spinbox, SLOT(setValue(int))); 
```

或者

```
class AuxSignals : public QObject
{
    Q_OBJECT
    ...
    QSpinBox *m_spinBox;
    public:
        AuxSignals(QSpinBox *spinBox) : m_spinBox(spinBox) {}
    public slots:
        void buttonClicked() { m_spinBox->setValue(20); }
};

...

// On main.cpp
AuxSignals *auxSignals = new AuxSignals(spinBox);

QObject::connect(button, SIGNAL(clicked()), auxSignals, SLOT(buttonClicked())); 
```

我更喜欢第一个选项，因为它不需要 AuxSignals 类具有指向特定 QWidget 的指针。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-02T15:40:16.520

我认为您在这里查看的是自定义 SLOT。一个`QPushButton::clicked`信号将给出一个布尔 ( `true|false`) 事件。如果你抓住它，`QSpinBox::setValue`你不会走得很远。需要一个 int 并将输入布尔值转换为 0 或 1 视情况而`QSpinBox::setValue`定，并且您的 spinbox 仅增加 1 个单位。如果您要编写自定义`SLOT`内容，您实际上可以通过更多控制来设置确切的滑块值。

# php - 每预定义秒刷新一个 PHP 页面

> ID：815003
> 
> 赞同：0
> 
> 时间：2009-05-02T15:13:28.223
> 
> 标签：php, javascript, mysql, ajax, web-applications

我想每 10 秒加载/刷新一个特定页面，以查看从数据库中获取的更新数据。

我用 META 来做这件事

```
 <META HTTP-EQUIV=Refresh CONTENT='10; URL=livedata.php'> 
```

> 但我仍然同意我们也通过使用来做到这一点：
> 
> *   通过 settimeout 加载 div 的 Javascript
>     
> *   Ajax 动态刷新

如果您使用 META、AJAX 动态刷新、Javascript settimeout 分享性能问题，那就太好了。同时分享最好的方法。

注意：需要刷新整个页面而不是特定的框架或 div。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-02T15:21:39.857

使用 AJAX 对用户的干扰最小，因为用户在完成之前不会注意到正在刷新/重新加载某些内容。

请注意，根据情况，AJAX 的性能可能比 META 更好或更差：

*   如果要更新的数据相对于整个 HTML 页面大小来说很小，那么 AJAX 比 META 更好，因为使用 AJAX 您可以只发送数据差异，和/或您可以以比 HTML 更紧凑的格式发送数据。
*   运行 JavaScript 会给用户的浏览器带来负担。如果用户打开了 20 个选项卡（这并不少见），并且每个选项卡都在后台运行一些 setTimeout，那么将所有选项卡都转换为无 JavaScript 刷新可能会对浏览器的响应能力产生巨大影响。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-02T15:19:48.600

如果您打算刷新整个页面，使用`<META>`标签是最干净的方式。当您拥有完全支持的纯 HTML 方式时，让 JS 计时器刷新您的页面似乎很尴尬。

但是，如果您只需要刷新页面的特定部分，请使用 AJAX。它在用户体验和性能方面都更好。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-15T23:19:51.693

使用 javascript 获取动态内容还有一个好处：如果内容一次没有加载，它仍然可以继续尝试。如果您重新加载整个页面并且它没有加载，那么它将停在那里。

此外，如果您使用 Ajax，那么显示效果会更好，因为您不会看到整个页面被消隐并一次又一次地重新渲染。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-15T23:08:24.700

对于客户而言，您提到的所有方法之间确实没有区别。我能找到的唯一区别是 using 不需要 javascript，就像其他解决方案一样，但现在每个人都有 javascript。

对我来说，最大的不同在于服务器的使用。如果您有 100 个用户每 10 秒刷新一次，那已经是大约 10 个请求/秒。根据您必须生成页面的逻辑（可能是动态的），这可能会导致服务器使用率飙升。确保你对此很小心。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-15T23:14:37.260

请注意，您也可以在 PHP 中使用 header() 来完成元标记所做的事情。只要确保在其他输出之前进行 header() 调用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-02T15:19:42.093

使用 jQuery 你可以做到）：

```
var seconds = 10;
var id = setInterval(function()
{
     $('#container').load('whatever.php');
}, 1000*seconds); 
```

:)

# sql - 在基于查询构造的对象构造中插入数组

> ID：815005
> 
> 赞同：0
> 
> 时间：2009-05-02T15:14:21.857
> 
> 标签：sql, oracle

如果我还需要在父对象中插入值，如何使用查询构造对象？

显然我使用了错误的语法。

编辑，越来越近：

```
insert into myTable
select
    mybigtype('foo', 'bar', 'fizzle', myarrayoflittletypes(
        select ref(S)
        from anotherTable S
        where S.stname='dingle'
            or S.stname='fangle'))); 
```

mylittletype 被创建为：

```
CREATE TYPE myarrayoflittletypes AS VARRAY(20) OF REF mylittletype 
```

anotherTable 创建为：

```
CREATE TABLE anotherTable OF mylittletype 
```

mybigtype 有一些字符串和一个类型，该类型被定义为保存对 mylittletype 对象的引用数组。因此，我希望能够在此表中插入一行，该行创建一个 mybigtype 类型的对象，其数组基于我定义的查询构造。我可以在一次插入中完成所有这些吗？还是我需要放入一个空占位符并随后更新此字段？

甲骨文目前的投诉是

```
ORA-01427: single-row subquery returns more than one row 
```

那么，如何将多个 OID 返回到此查询中的数组中我正在构建的对象中呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-02T15:27:46.397

你几乎拥有它！

```
insert into myTable
select 
    mybigtype('foo', 'bar', 'fizzle', myarrayoflittletypes(
        (select
            ref(S.mylittletype)
        from anotherTable S
        where S.mylittletype.stname='dingle
            or S.mylittletype.stname='fangle'))); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-02T17:44:46.580

可能有更好的方法可以做到这一点，以便我可以从单个查询中将多行插入到我的数组中，但以下方法有效：

```
insert into myTable
    values(mybigtype('foo', 'bar', 'fizzle', myarrayoflittletypes(
        (select ref(S)
        from anotherTable S
        where S.stname='dingle'),
        (select ref(S)
         from anotherTable S
         where S.stname='fangle')))); 
```

# ajax - 在 httpxml.responseText 中查找字符串

> ID：815008
> 
> 赞同：0
> 
> 时间：2009-05-02T15:15:00.187
> 
> 标签：ajax

下面是我的代码，我试图在响应文本中找到“用户名 OK”，然后将 UserNameOk 标记为 true。我无法让这个工作。

```
function check_username(username)
{
    var httpRequest;
    make_request()
    function stateck() 
    {

        if(httpxml.readyState==4)

         {  
            if (httpxml.responseText == "Username Ok")
            {
                 UserNameOk = true;

            }
             else 
            {
                UserNameOk = false;
            }
        checkCanSubmit();
        document.getElementById("user_div").innerHTML=httpxml.responseText;
         }
    }

    httpxml.onreadystatechange=stateck;
    user_url="ajax_username.php?username=" + username.value;
    httpxml.open("GET",user_url,true);
    httpxml.send(null);

} 
```

下面是我的 checkCanSubmit 代码

```
function checkCanSubmit()
{
    if (UserNameOk && PasswordOk && EmailOk)
    {
    document.getElementById("button").disabled= false;
    }
    else
    {
    document.getElementById("button").disabled= true;
    }
    } 
```

任何帮助将不胜感激谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-02T15:47:43.163

只是猜测：响应可能类似于 "Username Ok\n" （'\n' 是你看不到的换行符）。或者它可能在开头或结尾有空格。您可以打印出（警告）字符串的长度来测试它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-02T15:28:21.230

您是否看到通过萤火虫获得的正确响应？

第一步是通过查看 firebug 来确保您的服务器返回正确的响应。我还可以简化代码以帮助缩小问题范围。尝试：

```
function check_username(username)
{
    var httpRequest;
    make_request()
    function stateck() 
    {

            if(httpxml.readyState==4)

             {  
                    if (httpxml.responseText == "Username Ok")
                    {
                             alert('1');
                             UserNameOk = true;

                    }
                     else 
                    {
                            alert('2');
                            UserNameOk = false;
                    }
             }
    }

    httpxml.onreadystatechange=stateck;
    user_url="ajax_username.php?username=" + username.value;
    httpxml.open("GET",user_url,true);
    httpxml.send(null); 
```

你能更具体地说明问题出在哪里吗？

# c# - 使用 waitone() 方法

> ID：815011
> 
> 赞同：15
> 
> 时间：2009-05-02T15:18:18.650
> 
> 标签：c#

```
static Mutex mutex = new Mutex (false, "oreilly.com OneAtATimeDemo");

static void Main()
{
    // Wait a few seconds if contended, in case another instance
    // of the program is still in the process of shutting down.

    if (!mutex.WaitOne (TimeSpan.FromSeconds (3), false))
    {
      Console.WriteLine ("Another instance of the app is running. Bye!");
      return;
    }

    try
    {
      Console.WriteLine ("Running. Press Enter to exit");
      Console.ReadLine();
    }
    finally { mutex.ReleaseMutex(); }
} 
```

[http://www.albahari.com/nutshell/ch20.aspx](http://www.albahari.com/nutshell/ch20.aspx)

在这段代码中：

```
if(mutex.WaitOne(TimeSpan.Zero, true)) 
{
    Application.EnableVisualStyles();
    Application.SetCompatibleTextRenderingDefault(false);
    Application.Run(new Form1());
    mutex.ReleaseMutex();
} 
else 
{
    MessageBox.Show("only one instance at a time");
} 
```

[http://sanity-free.org/143/csharp_dotnet_single_instance_application.html](http://sanity-free.org/143/csharp_dotnet_single_instance_application.html)

if/bool 没有反转。

如果 waitone() 为真，这是否意味着实例已经在运行？如果返回true，当前线程将被阻塞，这意味着调用同一个应用程序的两个进程都将停止？

我的理解如下：

```
// Don't block the thread while executing code. 
//Let the code finish and then signal for another process to enter 
```

没有的含义是什么！（返回真），反之亦然。或者换句话说，无论哪种方式都会发生什么？

我知道 waitAll 例如，等待所有线程完成。Jon Skeet 在他的网站上展示了一个很好的例子，这让我印象深刻（归功于他的解释）。所以显然 waitOne 等待一个线程完成。返回值让我感到困惑。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-05-02T15:50:00.303

等待互斥体意味着等到你可以获取它。

`true`如果可以在给定时间内获取互斥锁，则互斥锁上的 WaitOne 将返回。如果不能，该方法将返回`false`。如果获得了互斥锁，则您有责任在完成后释放互斥锁。

如果您可以获得一个命名的互斥锁，那么目前没有其他人拥有它。

所以，回顾一下。如果您可以获得互斥锁，则该方法返回`true`并且您是您的应用程序的第一个/唯一实例，就您的问题而言。

如果您无法获取互斥锁，则该方法返回`false`，并且当前有另一个应用程序实例以该名称拥有该互斥锁。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-02T15:41:44.193

在 MSDN 中 mutex.WaitOne() 的描述是这样的：

> 阻塞当前线程，直到当前 WaitHandle 收到信号。

并且返回值为：如果当前实例接收到信号则为真

因此，在应用程序启动一次之前，它不会收到来自 mute.WaitOne() 方法的任何信号。就像描述中所说的那样，线程被阻塞了。

所以回答你的问题：

> 没有的含义是什么！（返回真），反之亦然。

如果你否定 mutex.WaitOne() 方法，那么你将检查这个：如果不是 waitOne()，这意味着你检查 waitOne 是否没有以**true**响应。

我希望这现在更清楚了。

# security - 未加密密码用户群的加密密码

> ID：815013
> 
> 赞同：2
> 
> 时间：2009-05-02T15:19:06.103
> 
> 标签：security, encryption, passwords, salt

前段时间我加入了新项目。它已经开发了很长时间。令我惊讶的是所有用户的**密码都以非加密形式存储**。

我向我们的管理层解释了这个巨大的安全漏洞——看起来他们同意这一点，并希望使项目更安全。团队成员也同意。

我们在系统中有大约 20,000 个用户。

其实做这项工作压力很大——**将非加密密码迁移到加密形式**。如果出现问题，可能会导致项目的灾难。

我怎样才能降低这种压力？备份？单元测试（集成测试）？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-02T15:27:35.647

好吧，请小心您的备份，因为它将包含未加密的用户密码:-)

假设密码存储在数据库中，一个简单的解决方案是这样的：

1）对整个表数据进行安全备份

2）创建新列（PasswordEncrypted 或类似名称）

3) 在使用 32 字节或更大的 salt 时，使用 UPDATE 查询使用未加密密码的 MD5 更新每一行的新列。今天几乎每个数据库系统都有一个 MD5 函数，所以你甚至不必离开你的 SQL 提示符

4）临时保留明文列并相应地更新您的应用程序/脚本以使用加盐密码。

5) 重命名明文旧密码列以暂时停止使用并测试您的应用程序 - 如果有任何问题，请返回第 4 步并修复您的错误。

6）当一切正常时删除明文密码列

7) 鼓励用户选择新密码，因为您已经具备一定程度的安全性，可以减轻之前可能成功的任何攻击的影响。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-02T15:35:58.700

这是一个什么样的项目？Web 应用程序，桌面应用程序？

如果您要走重构之路，是否有理由将密码存储在加密等可逆的东西中？一般来说，最好用 SHA 之类的东西对密码进行哈希处理，然后用相同的算法对输入进行哈希处理并比较结果。您只存储散列值，而不是实际密码。这使您能够检查是否有人输入了正确的密码，而不会让您的用户暴露于您的加密被破坏和他们的密码暴露的可能性。

关于你的方法的具体信息不是我可以提供的（因为我不知道它是如何工作的），但你最好的办法是创建一个额外的列来存储散列密码，散列现有密码，然后保持它们任何密码更改的日期。将此新列用于所有新开发，然后在移动完成并经过测试后，删除带有明文密码的列。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-02T15:30:05.687

编写大量测试，测试大量极端情况（大小写、数字、符号、Unicode 字符、长密码等）。当您在开发和测试时，创建一个系统以移回旧系统（当然，通过提供旧密码列表，因为一旦密码被散列，您将无法直接将它们转换回来）。保存当前密码列表的副本。在测试文件或测试数据库中转换密码，然后使用保存的密码副本来测试一切是否正常。现在将系统投入生产，并确保它适用于您的用户。如果没有，您已经测试了迁移回旧系统的计划。一旦它被证明可以工作几个星期，您就可以删除明文密码列表，一切就绪。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-02T15:31:32.830

我只是散列当前密码，将它们存储在一个新的数据库字段中，然后在删除密码字段时开始使用该字段。然后我会通知我的用户，现在是更改密码的好时机，因为您已经实施了更多的安全机制来保证他们的数据安全。

要备份，只需执行`SELECT * INTO Backup FROM UserData`

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-02T15:34:45.223

通过为每次登录尝试运行两种身份验证方法（加密和未加密），您可以获得额外的信心，如果它们产生不同的结果，则会收到一封发送给您的警报电子邮件。此更改对您的用户不可见，因此它可以运行数周甚至数月。一旦您看到新旧身份验证对足够高比例的用户有效，请停用旧身份验证。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-02T15:24:53.827

如果可能的话，你可以试试这个：向你的所有用户发送一封电子邮件，让他们在超时期限内更新他们的密码，如果他们不更改密码，他们将无法工作。散列这些新密码并存储散列。这将需要在前端进行一些更改（即它发回的数据）。

# .net - 是否有使用 SQL Server express 部署应用程序的标准方法？

> ID：815017
> 
> 赞同：1
> 
> 时间：2009-05-02T15:22:15.160
> 
> 标签：.net, deployment, connection-string, sql-server-express, app-config

在 Winforms 或 WPF 中是否有使用 SQL Server express 部署应用程序的标准方法？是否有标准方法来创建本地 SQL Server express 数据库并在应用程序安装期间更新 app.config connectionStrings 设置？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-02T15:51:41.533

请阅读这篇文章，了解如何使用[SQL Server Express部署应用程序](http://msdn.microsoft.com/en-us/library/bb264562.aspx)

这是另一个关于如何创建[安装包的内容](http://www.codeproject.com/KB/install/sqlscriptinstall.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-11-29T03:51:23.510

单击“一次”是将 SQL Express 与您的应用程序一起部署的“标准”解决方案。

# asp.net - 如何验证至少选择了 1 个单选按钮？

> ID：815022
> 
> 赞同：0
> 
> 时间：2009-05-02T15:25:03.017
> 
> 标签：asp.net, radio-button

如何验证至少选择了 1 个单选按钮？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-02T15:33:52.027

如果所有单选按钮都是同一个**RadioButtonList**的一部分，则可以使用简单的**RequiredFieldValidator**。这是一个例子：

```
<asp:RadioButtonList 
    ID="RadioButtonList1"
    runat="server"
    RepeatColumns="3">
    <asp:ListItem>Red</asp:ListItem>
    <asp:ListItem>Yellow</asp:ListItem>
    <asp:ListItem>Blue</asp:ListItem>
    <asp:ListItem>Green</asp:ListItem>
</asp:RadioButtonList>
<asp:RequiredFieldValidator 
    ID="ReqiredFieldValidator1"
    runat="server"
    ControlToValidate="RadioButtonList1"
    ErrorMessage="You must Select your favorite color!">*
</asp:RequiredFieldValidator> 
```

如果您在不同的 RadioButtonLists 中有 RadioButtons，并且您想验证在多个列表中至少选择了一个，那么您将需要一个**[CustomValidator](http://www.codeproject.com/KB/validation/MultiDependValidator.aspx)。**

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-02T15:42:57.560

另一种方法可能是，如果您默认选中其中一个，则在页面加载期间（可能是您认为大多数用户会选择的那个），那么用户将被“强制”更改选择或继续使用默认选项，这样您就可以确保始终选择一个选项。

# symfony1 - 如何将 Symfony 从 1.2.4 升级到 1.2.7

> ID：815025
> 
> 赞同：0
> 
> 时间：2009-05-02T15:26:17.553
> 
> 标签：symfony1

我有一个 Symfony 1.2.4 应用程序，从[Symfony 沙盒应用](http://www.symfony-project.org/tutorial/1_2/my-first-project)程序中获取和修改，没有努力确保 Symfony 引擎与我的应用程序分离，所以现在 Symfony 引擎只是我应用程序中的一个文件夹。

从 Symfony 1.2.4 升级到 1.2.7 的最佳方式是什么？有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-06T04:07:49.880

我找到了解决方案。

首先，必须将 Symfony 框架从沙盒应用程序中移出，然后使用 PEAR 升级 Symfony 框架，如[本文](http://itscommonsensestupid.blogspot.com/2009/05/move-symfony-framework-out-of-sandbox.html)所述。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-13T08:45:25.030

最简单的方法：

下载新的 symfony 沙盒版本，从该存档中获取数据和库文件并将其放入项目文件夹中（覆盖现有的数据和库文件夹）。之后清理您的项目缓存并重建模型（以及表单和过滤器）。

```
php symfony clear:cache
php symfony propel:build-all 
```

或者如果使用学说：

```
php symfony clear:cache
php symfony doctrine:build-all 
```

这将始终适用于次要修订（1.2.3 到 1.2.9 或 1.1.2 到 1.1.5）。对于从 1.0 升级到 1.1 或 1.2 或 1.3，您将有额外的步骤（您在文档中有详细说明）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-08T08:48:34.247

您还应该考虑使用 SVN 和/或在项目的 lib/vendor 文件夹中安装 symfony。这将使 symfony 项目依赖，这在同一服务器上有多个 symfony 项目的情况下很有用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-17T10:52:16.873

Symfony 1.2 是一个**稳定**版，这是什么意思？

> **稳定**：symfony 团队致力于修复稳定版本的错误和安全问题，直到维护结束。平均而言，我们每月发布一个错误修复版本。 **这些版本从不包含新功能，即使是小功能，但只包含错误修复**。因此，它们始终向后兼容，**升级到**.

就像 Oncle Tom 说的，如果你正在处理多个 Symfony 项目，如果它们共享同一个 Symfony 库，更新它们会更容易。

从 SVN 存储库签出 Symfony 库：

```
daemon@dev:/home/dev/symfony$ svn co http://svn.symfony-project.com/branches/1.2 
```

编辑您的 config/ProjectConfiguration.class.php ：

```
#require_once dirname(__FILE__).'/../lib/vendor/symfony/lib/autoload/sfCoreAutoload.class.php';
require_once '/home/dev/symfony/1.2/lib/autoload/sfCoreAutoload.class.php'; // use the shared lib instead
sfCoreAutoload::register();

class ProjectConfiguration extends sfProjectConfiguration
{
  public function setup()
  {
    // for compatibility / remove and enable only the plugins you want
    $this->enableAllPluginsExcept(array('sfPropelPlugin', 'sfCompat10Plugin'));
  }
} 
```

然后你就完成了。您现在正在使用一个共享且易于更新的 Symfony 库，并且您已经更新了您的项目。

开始新项目：

> daemon@dev:/home/dev/sfProjects$ php /home/dev/symfony/1.2/data/bin/symfony generate:project 项目

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-03-26T17:36:14.027

这是一个老问题，但我想我会添加一个想法。以前认为最好的做法是在服务器上拥有一个 symfony 位置，因为可以升级它并神奇地升级单个服务器上的所有站点。实际上，这并不容易。首先，当将站点从一台服务器移动到另一台服务器时，可能需要修复符号链接或库文件夹的绝对路径。此外，正如@deresh 所说，需要在升级之间清除缓存 - 这需要花费多个项目的时间，并且可能会将它们关闭，直到它们全部完成。

所以总而言之，这些天我将 symfony 1.x 嵌入到任何 symfony 项目中，而不是引用外部位置。它将 symfony 的“已知良好版本”带入版本控制，使其更易于部署，升级只是在开发副本中删除和替换它们的问题`lib/symfony`，`data/symfony`并用新 tarball 中的`lib`和文件夹替换它们。`data`这些应该被提交，然后项目可以很容易地部署在服务器上——`svn up`如果你在服务器上使用 Subversion，则可以使用 `./symfony cc'。

通常你不需要重建你的模型，除非你知道你的 ORM 版本在 symfony 版本之间已经改变了。

# asp.net - 处理此 ASP.NET 验证的正确方法是什么？

> ID：815026
> 
> 赞同：-1
> 
> 时间：2009-05-02T15:26:21.843
> 
> 标签：asp.net, validation

我有需要执行的条件验证。逻辑应该像这样工作：

> 如果选择单选按钮 1，则需要 textbox1。
> 如果选择单选按钮 2，则需要 dropdownlist1。

实现这一目标的最佳方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-02T15:32:34.590

使用[CustomValidator](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.customvalidator.aspx)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-02T15:38:32.797

客户端使用 JQuery 验证插件。如果使用 ASP.NET 控件，请调整名称以适合 ASP.NET 给出的名称。服务器端相对容易 - 检查选择了哪个单选并确保文本框或下拉列表的值不为空。

```
$(function() {
   $('form').validate( {
      rules: {
         required-textbox: function() {  return $('#radio_yes:checked').size(); }
         required-ddl: function() { return $('#radio_no:checked').size(); }
      }
   });
})

<input type='radio' id='radio_yes' name='radio' value='1' /> Choice 1
<input type='radio' id='radio_no' name='radio' value='2' /> Choice 2

<input type='text' id='textinp' name='textinp' class='required-textbox' />
<select id='ddl' name='ddl' class='required-ddl'>
   <option ... />
</select> 
```

您也可以使用 CustomValidator 执行此操作——再次使用 jQuery 客户端。同样，服务器端功能是微不足道的（与其他情况基本相同）。

```
function validateTextBox(source, args)
{
    args.IsValid = $('[id$="radio_yes"]:checked').size() && $(source).val();
}

function validateDDL(source, args)
{
    args.IsValid = $('[id$="radio_no"]:checked').size() && $(source).val();
}

<asp:RadioButton ID="radio_yes" runat="server" GroupName="radio" /> Choice 1
<asp:RadioButton ID="radio_no" runat="server" GroupName="radio" /> Choice 2

<asp:TextBox ID="textbox" runat="server" />
<asp:CustomValidator ID="textboxValidator" runat="server"
     ControlToValidate="textbox"
     ClientValidationFunction="validateTextBox"
     OnServerValidate="ddl_Validate"
     Display="Static"
     ErrorMessage="*" />

<asp:DropDownList ID="ddl" runat="server">
 ....
</asp:DropDownList>
<asp:CustomValidator ID="ddlValidator" runat="server"
     ControlToValidate="ddl"
     ClientValidationFunction="validateDDL"
       OnServerValidate="textbox_Validate"
       Display="Static"
       ErrorMessage="*" /> 
```

# c - 一种在嵌入式设备上将字节流转换为 C89 中的数据包流的方法

> ID：815029
> 
> 赞同：12
> 
> 时间：2009-05-02T15:26:52.950
> 
> 标签：c, embedded, communication, c89

我正在使用使用 rs232（通过 USB 的 rs232）连接到 PC 的嵌入式设备。

我正在考虑开发自己的协议：

`<MAGIC><LENGTH><BINARY DATA><CRC>`

但我不想重新发明轮子。

请**注意**：我正在考虑非常受限的设备：4kb 的 RAM，没有内核，也没有标准的 C 库。

你能想出一个标准的方法来做到这一点（也许是开源库）？

如果您编写自己的解决方案，是否有任何最佳实践？

*   您是否也在包的末尾使用 MAGIC 字节？
*   也许使用时间间隔而不是分隔符更好？
*   如何在流二进制数据中找到包的开头？
*   也许使用文本协议更好？

**更新：** 请重新阅读问题。我不应该要求图书馆，而是要求良好的做法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-03T14:10:14.200

请参阅[我对一个非常相似的问题给出的](https://stackoverflow.com/questions/815758/simple-serial-point-to-point-communication-protocol/817134#817134)关于简单协议细节的答案。

回应您的具体观点：

1.  数据包末尾的“魔术”字节不会造成任何伤害，但如果您已经知道数据包应该有多长并且具有 CRC，它们就是多余的。
2.  指定超时时间是明智的，因此如果一个数据包内的字节之间的间隙太大，则会标记错误。使用[Modbus](http://en.wikipedia.org/wiki/Modbus)后，我不相信在其他地方使用基于时间的分隔符的价值。
3.  您的意思是“如何在二进制数据流中找到数据包的开头”？如果是这样，可以指定数据包之间的最小间隔，和/或要求接收者在每个数据包后确认。
4.  使调试更容易，并且不需要PC上的任何特殊软件，但效率不高。当然，如果可用性比效率更重要，那么基于文本的系统是完全合适的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-02T17:58:18.280

对于这样的事情，当您获得在您的设备上运行的现有解决方案时，重新发明轮子会更容易。

```
void buffer_packet(unsigned char rx_byte)
{
    static unsigned char byte_count = 0;
    static unsigned char packet[8];

    packet[byte_count++] = rx_byte;
    if (byte_count == 8)
    {
        unsigned char crc = calculate_crc(packet, 8);

        write_uart(0x55);
        write_uart(8);
        while (byte_count--)
        {
            write_uart(packet[7 - byte_count]);
        }
        write_uart(crc);
    }
} 
```

或者，也许我低估了你的问题。如果您正在寻找如何生成 RS232 位，请查看您的微控制器数据表。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-02T16:28:41.570

除了 I/O 原语之外，唯一的事情就是 CRC 计算。[这里](http://www.netrino.com/Embedded-Systems/How-To/CRC-Calculation-C-Code)有一篇带代码的漂亮文章。

# zend-framework - 是否有一个 Zend_Form_Element 可以呈现带有一些内容的普通 div？

> ID：815030
> 
> 赞同：0
> 
> 时间：2009-05-02T15:26:55.260
> 
> 标签：zend-framework, zend-form, zend-form-element

目前正在处理一堆表单，我发现我希望能够将表单拆分为多个部分，中间有一些文本。是否有一个 Zend_Form_Element 允许我将一些文本与我的表单混合（而不是作为链接到单个输入的标签或描述）？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-02T16:18:23.793

我认为没有。

虽然，您可以执行以下操作之一：

*   如果中间的文本更像标题，您可以将它们分组到[display groups](http://framework.zend.com/manual/en/zend.form.forms.html#zend.form.forms.displaygroups)中。
*   如果您想放置大量文本，则必须编写自己的[自定义表单元素](http://framework.zend.com/manual/en/zend.form.elements.html#zend.form.elements.custom)。

如果您选择第二个选项，请注意您的表单装饰。如果您希望文本从页面的一侧到另一侧（即左侧没有标签空间并且不与其余输入表单对齐），您可能必须[禁用默认装饰器](http://framework.zend.com/manual/en/zend.form.elements.html#zend.form.elements.decorators)并设置新的装饰器。

# php - Memcached vs APC 我应该选择哪一个？

> ID：815041
> 
> 赞同：163
> 
> 时间：2009-05-02T15:31:26.650
> 
> 标签：php, caching, memcached, apc

我从很久以前读过这篇文章：[http](http://www.mysqlperformanceblog.com/2006/09/27/apc-or-memcached/) ://www.mysqlperformanceblog.com/2006/09/27/apc-or-memcached/ 。我想获得最好的缓存引擎，以便我的应用程序非常快。当然我不想过度缓存，但我想至少选择最好的东西。在那篇文章中，它说 Memcached 很慢，而 apc 很快，那么为什么每个人都选择[memcached](http://en.wikipedia.org/wiki/Memcache)呢？

[http://framework.zend.com/manual/en/zend.cache.backends.html#zend.cache.backends.twolevels](http://framework.zend.com/manual/en/zend.cache.backends.html#zend.cache.backends.twolevels)这里说“使用一个快速的（但有限的）像 Apc、Memcache ...... “慢”一个，比如 File、Sqlite……”你认为使用 Apc 作为快速而 Memcache 作为慢速是一个好主意吗？

* * *

## 回答 #1

> 赞同：274
> 
> 时间：2009-05-02T15:33:50.640

Memcached 是一个分布式缓存系统，而 APC 是非分布式的 - 主要是一个操作码缓存。

如果（且仅当）您的 Web 应用程序必须存在于不同的 Web 服务器上（负载平衡），您必须使用 memcache 进行分布式缓存。如果没有，请坚持使用 APC 及其缓存。

您应该始终使用操作码缓存，即 APC（APC 也将集成到 php6 iirc 中，所以为什么不现在开始使用它）。

您可以/应该将两者用于不同的目的。

* * *

## 回答 #2

> 赞同：44
> 
> 时间：2009-05-02T15:33:44.837

Memcached 如果您需要跨多个 Web 服务器保留状态（如果您是负载平衡的并且重要的是缓存中的内容对于所有服务器都是相同的）。

如果您只需要访问快速内存以在（或每个）服务器上读取（和写入），APC。

请记住，APC 还可以编译并加快您的脚本执行时间。例如，您可以使用 APC 来提高执行性能，同时使用 memcached 进行缓存存储。

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2014-01-07T04:06:44.127

The main advatage of APC is opcode cache. Since PHP 5.5 integrated OpCache to its core and APC for PHP 5.4 is still flagged as beta, it's not official annoucement, but the development of APC would be dropped in near future.

So I would recommend you to choose Memcached.

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2012-03-22T00:32:15.700

我同时使用一个来提高速度，另一个来同步我的所有服务器。如果您确实使用了 memcache，那么请记住您需要使用 iptables 阻止的开放端口。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-08-04T07:39:08.147

嘿 Thomaschaaf，我希望这对你来说不是迟到的工具，但请注意 APC 有一些与“用户缓存”相关的问题。长话短说，当您为缓存条目设置超时，或者如果您的 apache 在内部 APC 代码中崩溃（例如超时），那么您可能会遇到一些问题。

我在这里有一个关于这个问题的条目： http: [//nirlevy.blogspot.com/2009/06/apc-futexwait-lockdown-make-your-apache.html](http://nirlevy.blogspot.com/2009/06/apc-futexwait-lockdown-make-your-apache.html)，你也应该阅读[http://t3.dotgnu。 info/blog/php/user-cache-timebomb.html](http://t3.dotgnu.info/blog/php/user-cache-timebomb.html)（来自我认为的 APC 开发人员之一）

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-03-02T19:45:43.463

这取决于你在做什么，但对于我在 VPS 上运行的 drupal 网站，我发现 APC 工作得很好！如果您运行的是 CentOS 6，它可以作为 yum 更新使用，安装起来非常简单，并且没有配置，因为默认值是合理的。恕我直言。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-04-21T12:37:35.050

我只使用 APC，因为 APC 是一个代码缓存，就像 memcache 一样！只有 1 个配置文件而不是 2 个。

并且只有 1 个地方可以监控两个缓存.....

# c# - 绑定到 Linq to SQL 的 DataGridView 不显示在其他地方添加到数据库上下文的新行

> ID：815043
> 
> 赞同：1
> 
> 时间：2009-05-02T15:31:48.943
> 
> 标签：c#, linq-to-sql, datagridview

我`DataGridView`绑定了一个 LINQ to SQL 查询表达式。我希望它可编辑以进行更新，但对于插入，我希望用户在网格下方使用单独的控件（文本框、日期选择器等 - 目前未绑定到任何东西）。我有一个“添加”按钮，它根据控件中的值创建 linq to sql 实体类的对象，然后调用`InsertOnSubmit()`. 当我稍后调用时`SubmitChanges()`，来自网格的任何更新以及添加的任何对象都正确地保存到数据库中。

我的问题是在调用`SubmitChanges()`. 我希望在创建新对象后立即将它们添加到网格中。另外，我只希望网格下方的控件用于插入新记录，而不是编辑现有记录，所以我认为它们不应该绑定到数据源......实现这一点的最佳方法是什么？

我确实尝试简单地重新设置`DataSource`网格（即`dataGridView.DataSource = db.<TableName>`，它可以工作，但是很笨拙，因为它再次滚动到网格的顶部 - 我确信存在更好的方法。

（请原谅 n00b 问题，我对所有这些 .net 东西都很陌生：P）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-02T18:29:34.493

首先要尝试的是[GetNewBindingList()](http://msdn.microsoft.com/en-us/library/bb534545.aspx)，但是这个线程：“ [Linq-SQL canonical editable datagridview sample code](http://groups.google.co.uk/group/microsoft.public.dotnet.languages.csharp/browse_thread/thread/49fd93763695c4ad/6bb545f09b7c7e0c) ”对其他场景有一些想法。

# delphi - 显示第二个表单时如何阻止 UI 锁定？

> ID：815051
> 
> 赞同：2
> 
> 时间：2009-05-02T15:35:47.577
> 
> 标签：delphi, graphics

我有一个用 Delphi7 编写的聊天程序。作为一种特殊的“效果”，当播放特定的枪声文件时，我们会显示一些弹孔。我们通过在弹孔的 bmp 图像文件的形状中绘制一个新形式来做到这一点，并延迟几秒使其可见然后消失。

然而，所有这些都有效，当弹孔图像在屏幕上时，程序被有效地锁定......当最后一个图像消失时，将焦点返回给用户。

我的程序员并不精通图形，并认为这只是您获得这种效果所必须付出的代价，但我希望这不是真的……任何关于随机显示弹孔图像的更好方法的建议隔着屏幕？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-02T16:01:46.390

如果没有看到代码并确切地知道如何打开/加载第二个表单，很难说，但听起来你正在打开它们，`ShowModal`这将锁定父表单，直到模态表单返回结果。

如果是这种情况，那么您可以使用 Show 方法简单地打开它，然后像这样将焦点设置回主窗体。

```
procedure TForm1.Button1Click(Sender: TObject);
   var obj:TForm2;
begin
    obj := TForm2.Create(nil);
    try
        obj.FormStyle := fsStayOnTop;
        obj.show;
        Self.SetFocus; //set focus back to the form1
    except
        FreeAndNil(obj);
    end;
end; 
```

上面还有趣的是，您正在运行时动态创建表单，而第二个表单负责释放自身。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-02T17:34:49.973

在表单上覆盖图形并不是很简单，但我认为这就是 TCustomTransparentPanel（内存中的名称）的用途。

但无论如何，它不应该减慢或冻结程序。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-04T15:56:30.240

打开第二个表格确实不是这样做的方法。也许是一个带有部分透明图像的图片控件，其大小刚好比您可以放置​​在表单上任何位置的弹孔大。如果你不能做一个透明的控制，你可以拍一张表格那部分的快照，然后把弹孔放在上面。

1.  当子弹应该出现时，您使图片可见并放在前面
2.  启动一个定时器两秒并告诉图片控件刷新
3.  当计时器响起时，隐藏子弹图片

如果要为淡出设置动画，只需使用在不同时间关闭的计时器在不同时间用不同的图片替换图片

*   在 0 秒时使图片可见
*   在 1.5 秒时，将图片替换为褪色版本的图片
*   2秒隐藏图片

使用它，不需要其他表单，并且应用程序保持响应。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-05T21:29:14.410

请参阅[http://msdn.microsoft.com/en-us/library/dd183353(VS.85).aspx](http://msdn.microsoft.com/en-us/library/dd183353(VS.85).aspx)，它有一个很好的例子，说明了将 alpha 混合位图的 API 调用。对于动画的每一帧，您可能需要获取代表主屏幕的图像副本，然后以适当的透明度级别将其与字形混合。

如前所述，您可以重复执行 Application.ProcessMessages，尽管我更喜欢向后执行并使用 PostMessage 来触发动画的下一帧。

您将在循环中使用 ProcessMessages，但在第一个动画完成之前，该调用可能会导致您在该循环中发生其他事情 - 窗口移动、最小化、关闭或再次触发动画事件。只要您注意您不一定总是在循环范围内操作，这一切都很好。

出于这个原因，我更喜欢让每一帧动画都做一个 PostMessage 来触发下一帧。它只是帮助我保持正确的观点。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-03T07:39:04.970

我相信需要的是使用 SetWinRegion 方法在“弹孔”周围绘制轮廓。这样它们就可以被点击通过，但是孔本身会浮在上面（前提是使用了 fsStayOnTop 的先前答案）。

即使是 Flash 图像也需要某种形式的形式来充当图像的容器。这一切都归结为创建一个窗口并将图像爆破到该窗口。它不必“锁定”屏幕，如果你将它设置为始终在顶部并且只是“显示”它（不是 ShowModal）它应该出现并浮动。然后我会使用计时器来控制它何时被销毁。SetWinRegion 的优点是您可以创建一个形状不规则的窗口，用户无法单击的唯一位置是包含实际窗体的窗口部分（区域内）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-04T21:15:54.280

这是一个有效的解决方案。您希望将触发过程包装到计时器或其他一些事件驱动的过程中。

表格定义：

```
 TForm1 = class(TForm)
    btnTurnOn: TButton;
    ListBox1: TListBox;
    btnTurnOff: TButton;
    procedure FormCreate(Sender: TObject);
    procedure FormDestroy(Sender: TObject);
    procedure btnTurnOnClick(Sender: TObject);
    procedure btnTurnOffClick(Sender: TObject);
  private
    { Private declarations }
  public
    { Public declarations }
    F:TForm;
    Bullet:TBitmap;
    x,y:integer;

    procedure SubFormPaint(Sender: TObject);
  end; 
```

代码：

```
procedure TForm1.btnTurnOnClick(Sender: TObject);
begin
if F=nil then
   begin
   F:=TForm.Create(self);
   F.Parent:=self;
   F.FormStyle:=fsStayOnTop;
   F.BorderStyle:=bsNone;
   F.Left:=x;
   F.Top:=y;
   F.Width:=Bullet.Width;
   F.Height:=Bullet.Height;
   F.OnPaint:=Self.SubFormPaint;
   F.Show;
   end
else
   begin
   inc(x,5);
   inc(y,5);
   F.Left:=x;
   F.Top:=y;
   F.Invalidate;
   end;
end;

procedure TForm1.btnTurnOffClick(Sender: TObject);
begin
F.Free;
F:=nil;
end;

procedure TForm1.FormCreate(Sender: TObject);
begin
F:=nil;
Bullet:=TBitmap.Create;
Bullet.LoadFromFile('C:\source\glyfx\glyfx\Emoticon\BMP\16x16\wink_16.bmp');
x:=1;
y:=1;
end;

procedure TForm1.FormDestroy(Sender: TObject);
begin
Bullet.Free;
end;

procedure TForm1.SubFormPaint(Sender: TObject);
begin
if F<>nil then
   F.Canvas.Draw(1,1,Bullet);
end; 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-04T21:25:47.093

如果弹孔的动画被写成一个循环执行直到完成，那么这可能就是问题所在。如果是这样，那么尝试`Application.ProcessMessages`在循环中的某个位置插入以允许在动画发生时发生其他事情。

# c# - 在 Visual Studio 中移动 C# 项目的中间目录

> ID：815056
> 
> 赞同：15
> 
> 时间：2009-05-02T15:37:15.640
> 
> 标签：c#, visual-studio

我目前正在剥离、重构和清理一个中型（15 个 ish 项目）Visual Studio 解决方案。该解决方案包含 C++ 和 C# 中的项目。

我热衷于在输出方面保持尽可能整洁 - 将任何从源代码创建的编译器分开，因为它有助于颠覆（好吧，我可以告诉它忽略文件，但我仍然觉得它很乱）吓坏了。

我想实现的输出如下：

```
SolutionDir/
SolutionDir/src/project1/{ Code here }
SolutionDir/int/project1/configuration/{.obj files and other misc compiler junk here}
SolutionDir/bin/project1/configuration/{The fun stuff goes here} 
```

这对于 C++ 项目来说似乎微不足道，因为您可以同时指定输出和中间目录。但是对于 C#，至少通过 Visual Studio 2008 用户界面似乎不可能移动 obj 目录？

在做了一些挖掘之后，我添加了

```
<IntermediateOutputPath>..\..\int\ProjectName\Debug\</IntermediateOutputPath> 
```

到 C# .csproj

这似乎工作，排序。确实，中间体似乎最终在那里，但是在旧位置创建了一个目录'obj'，在它下面有一个配置目录（例如'debug'），然后是一个'TempPE'目录——所有这些都是空的。

这并不是什么大问题，但很高兴知道这种行为的原因以及可能的解决方法。

提前致谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2011-12-30T05:27:06.143

如果您将以下两行添加到每个构建配置，则默认情况下不会创建“obj”文件夹，并且不需要构建后操作：

```
<IntermediateOutputPath>Assembly\obj\Debug\</IntermediateOutputPath>
<BaseIntermediateOutputPath>Assembly\obj\Debug\</BaseIntermediateOutputPath> 
```

如果需要，SVN / SCC 忽略属性也很有用

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-02T16:21:16.657

我建议将要忽略的目录添加到 SVN 忽略属性一级。此外，当您进行初始提交并且不添加 bin 和 obje 目录时，SVN 客户端不会发疯。另一方面，考虑将生成的文件放入项目的 GeneratedFiles 子目录，而不是将该目录检入 SVN。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-02-21T22:49:03.540

我自己一直在寻找解决这个问题的方法，并想出了一些不那么侵入性的方法。

在某处（我将我的放在我的项目路径中）创建一个名为“CleanSrcDir.bat”的 bat 文件，其中包含以下内容：

```
rmdir /S /Q %1obj
SET %ERRORLEVEL%=0 
```

在此之后，添加类似于 C# 项目的构建后事件的内容：

```
$(ProjectDir)CleanSrcDir.bat $(ProjectDir) 
```

（当然，这假设您将 bat 文件放在项目目录中。）然后将构建后设置更改为“始终”，您就完成了。

这有点骇人听闻，但肯定会使版本控制问题消失。

# cocoa - 你如何让你的应用程序在登录时打开？

> ID：815063
> 
> 赞同：29
> 
> 时间：2009-05-02T15:41:07.987
> 
> 标签：cocoa, login

只是想知道如何让我的应用程序在登录时自动打开，但可以使用首选项窗口中的复选框打开和关闭它。

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2010-02-23T12:22:23.610

这是我使用的一些代码，它基于 Growl 源代码。

```
+ (BOOL) willStartAtLogin:(NSURL *)itemURL
{
    Boolean foundIt=false;
    LSSharedFileListRef loginItems = LSSharedFileListCreate(NULL, kLSSharedFileListSessionLoginItems, NULL);
    if (loginItems) {
        UInt32 seed = 0U;
        NSArray *currentLoginItems = [NSMakeCollectable(LSSharedFileListCopySnapshot(loginItems, &seed)) autorelease];
        for (id itemObject in currentLoginItems) {
            LSSharedFileListItemRef item = (LSSharedFileListItemRef)itemObject;

            UInt32 resolutionFlags = kLSSharedFileListNoUserInteraction | kLSSharedFileListDoNotMountVolumes;
            CFURLRef URL = NULL;
            OSStatus err = LSSharedFileListItemResolve(item, resolutionFlags, &URL, /*outRef*/ NULL);
            if (err == noErr) {
                foundIt = CFEqual(URL, itemURL);
                CFRelease(URL);

                if (foundIt)
                    break;
            }
        }
        CFRelease(loginItems);
    }
    return (BOOL)foundIt;
}

+ (void) setStartAtLogin:(NSURL *)itemURL enabled:(BOOL)enabled
{
    OSStatus status;
    LSSharedFileListItemRef existingItem = NULL;

    LSSharedFileListRef loginItems = LSSharedFileListCreate(NULL, kLSSharedFileListSessionLoginItems, NULL);
    if (loginItems) {
        UInt32 seed = 0U;
        NSArray *currentLoginItems = [NSMakeCollectable(LSSharedFileListCopySnapshot(loginItems, &seed)) autorelease];
        for (id itemObject in currentLoginItems) {
            LSSharedFileListItemRef item = (LSSharedFileListItemRef)itemObject;

            UInt32 resolutionFlags = kLSSharedFileListNoUserInteraction | kLSSharedFileListDoNotMountVolumes;
            CFURLRef URL = NULL;
            OSStatus err = LSSharedFileListItemResolve(item, resolutionFlags, &URL, /*outRef*/ NULL);
            if (err == noErr) {
                Boolean foundIt = CFEqual(URL, itemURL);
                CFRelease(URL);

                if (foundIt) {
                    existingItem = item;
                    break;
                }
            }
        }

        if (enabled && (existingItem == NULL)) {
            LSSharedFileListInsertItemURL(loginItems, kLSSharedFileListItemBeforeFirst,
                                          NULL, NULL, (CFURLRef)itemURL, NULL, NULL);

        } else if (!enabled && (existingItem != NULL))
            LSSharedFileListItemRemove(loginItems, existingItem);

        CFRelease(loginItems);
    }       
} 
```

如果您想要一个易于实现的复选框，`@property BOOL startAtLogin;`请在您的一个类中创建一个并按如下方式实现它。只需将复选框值绑定到属性，它应该都能无缝工作。

```
- (NSURL *)appURL
{
    return [NSURL fileURLWithPath:[[NSBundle mainBundle] bundlePath]];
}

- (BOOL)startAtLogin
{
    return [LoginItem willStartAtLogin:[self appURL]];
}

- (void)setStartAtLogin:(BOOL)enabled
{
    [self willChangeValueForKey:@"startAtLogin"];
    [LoginItem setStartAtLogin:[self appURL] enabled:enabled];
    [self didChangeValueForKey:@"startAtLogin"];
} 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-05-02T16:10:31.613

[在CocoaDev](http://www.cocoadev.com/index.pl?StartingMyAppOnStartup "不同方法的 CocoaDev 概述")有一个不错的描述。

基本上，如果您可以针对 Mac OS X 10.5 或更高版本，您将希望使用 LaunchServices/LSSharedFileList.h 中的 API。在 10.5 之前没有干净的 API，因此您必须手动操作登录项（[Developer Connectiong 中的示例代码](http://developer.apple.com/samplecode/LoginItemsAE/index.html "Apple 的 LoginItemsAE 示例代码")）。

这是我在评论中提到的 Leopard 的[示例代码](http://github.com/carpeaqua/Shared-File-List-Example "10.5 或更高版本的示例代码")^(（死）)。通过[这篇博文](http://carpeaqua.com/2008/03/01/adding-an-application-to-login-items-in-mac-os-x-leopard/ "Carpeaqua 上的博客文章")找到。您需要在登录时启用或禁用启动的代码位于 Controller.m 中。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-05-02T16:36:01.363

使用指向您的应用程序的文件 URL 调用下面粘贴的方法，以将其添加到当前用户的登录项。

要再次禁用，您需要获取相同的 loginListRef，将其转换为数组，然后遍历它，直到找到具有要禁用的 url 的项目。最后，使用适当的参数调用 LSSharedFileListItemRemove。

祝你好运 ：）

```
- (void)enableLoginItemWithURL:(NSURL *)itemURL
{
    LSSharedFileListRef loginListRef = LSSharedFileListCreate(NULL, kLSSharedFileListSessionLoginItems, NULL);

    if (loginListRef) {
        // Insert the item at the bottom of Login Items list.
        LSSharedFileListItemRef loginItemRef = LSSharedFileListInsertItemURL(loginListRef, 
                                             kLSSharedFileListItemLast, 
                                             NULL, 
                                             NULL,
                                             (CFURLRef)itemURL, 
                                             NULL, 
                                             NULL);     
        if (loginItemRef) {
            CFRelease(loginItemRef);
        }
        CFRelease(loginListRef);
    }
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-02T16:32:49.453

另见SO问题：[Register as login item with cocoa](https://stackoverflow.com/questions/608963/register-as-login-item-with-cocoa)

# c# - 需要帮助将 Delphi 时间转换为 .Net 时间

> ID：815066
> 
> 赞同：3
> 
> 时间：2009-05-02T15:42:25.673
> 
> 标签：c#, .net, delphi, datetime

我正在将 Delphi 应用程序移植到 C#，但遇到了问题。Delphi 应用程序将时间记录到日志文件中，然后将其读回程序中。但它记录的时间格式让我感到困惑。我找不到 .Net 库来正确转换它。

Delphi 在日志文件中记录的时间：976129709（这在 Delphi 代码中转换为 1/14/2009 5:53:26 PM）

```
//Here is the Delphi code which records it: 
IntToStr(DirInfo.Time);

//Here is the Delphi code which reads it back in:
DateTimeToStr(FileDateToDateTime(StrToInt(stringTime)); 
```

有人知道我如何在.Net中阅读这个吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-02T16:45:03.230

Delphi 的 TSearchRec.Time 格式是旧的 DOS 32 位日期/时间值。据我所知，它没有内置转换器，所以你必须写一个。例如：

```
public static DateTime DosDateToDateTime(int DosDate)
{
     Int16 Hi = (Int16)((DosDate & 0xFFFF0000) >> 16);
     Int16 Lo = (Int16)(DosDate & 0x0000FFFF);

     return new DateTime(((Hi & 0x3F00) >> 9) + 1980, (Hi & 0xE0) >> 5, Hi & 0x1F,
        (Lo & 0xF800) >> 11, (Lo & 0x7E0) >> 5, (Lo & 0x1F) * 2);
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-03T07:21:59.877

[这是不同日期/时间格式的描述](http://blogs.msdn.com/oldnewthing/archive/2003/09/05/54806.aspx)（Delphi 的原生 TDateTime 是 OLE 自动化日期格式）。据此，您需要[System.DateTime.FromFileTime()](http://msdn.microsoft.com/en-us/library/system.datetime.fromfiletime.aspx)和[System.DateTime.ToFileTime()](http://msdn.microsoft.com/en-us/library/system.datetime.tofiletime.aspx) + [DosDateTimeToFileTime()](http://msdn.microsoft.com/en-us/library/ms724247(VS.85).aspx)和[FileTimeToDosDateTime()](http://msdn.microsoft.com/en-us/library/ms724274(VS.85).aspx)函数。实际上，这是两步转换。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-02T16:36:55.900

我已经尝试过谷歌搜索和实验，从虚拟代码开始寻找类似于 unix epoch 的东西。

```
 var x = 976129709;
  var target = new DateTime(2009, 1, 14, 17, 53, 26);
  var testTicks = target.AddTicks(-x);     // 2009-01-14 17:51:48
  var testMs = target.AddMilliseconds(-x); // 2009-01-03 10:44:36
  var testS = target.AddSeconds(-x);       // 1978-02-08 22:44:57
  // No need to check for bigger time units
  // since your input indicates second precision. 
```

你能验证你的输入是否正确吗？

为了飞行意大利面怪物的爱，放弃你的 12 小时时间格式！;)

# jquery - jquery 没有看到新元素

> ID：815074
> 
> 赞同：19
> 
> 时间：2009-05-02T15:51:28.477
> 
> 标签：jquery, dom, refresh

我是 JQuery 的新手，所以请耐心等待:)。

我有一个简单的问题：

```
$(document).ready(function() {

     $("#instrument").change(function() {
         $("#tunings").html("<select id=\"TuningSelector>\"[..]</div>");
     });

     $("#TuningSelector").change(function() {
         DoSomethingWithTheValue();
      }); 

 }); 
```

问题是：当仪器发生变化时，脚本不再响应 TuningSelector 的变化。就像 JQuery 没有看到新的 TuningSelector 元素...

我需要在 JQuery 上调用刷新吗？这样它就可以看到刷新的 DOM？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-05-02T15:56:06.483

通常，您希望使用[on](http://api.jquery.com/on)以便它将处理程序应用于与选择器匹配的新元素并委托给 DOM 中的更高元素。

```
$('body').on( 'change', '#control', function() {
    DoSomething();
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-02T16:19:57.363

对于 jQuery 事件，如果您希望将事件应用于新元素，您可以使用[.live](http://docs.jquery.com/Events/live)方法，但是 jQuery 1.3 不支持 blur、focus、mouseenter、mouseleave、change、submit 事件作为实时事件。（更改、提交和模糊/聚焦在jQuery 1.4的[路线图上）](http://docs.jquery.com/JQuery_1.4_Roadmap#Events)

作为替代方案，您可以使用[liveQuery](http://plugins.jquery.com/project/livequery)插件。

# list - Haskell：根据第一个值在列表中查找元组的第二个值

> ID：815086
> 
> 赞同：3
> 
> 时间：2009-05-02T16:00:56.097
> 
> 标签：list, search, haskell

我在这里有一个函数，旨在查看元组列表并通过获取第一个值来查找元组中的第二个值。这是到目前为止的功能：

```
lookup :: String -> [(String,String)] -> String
lookup _ _ [] = "Not found"
lookup x y zs = if (notFound x zs)
    then "Not found"
    else (head [b | (a,b) <- zs, (a==x)]) 
```

如果没有包含给定第一个字符串的元组，notFound 函数只会返回一个 Bool 作为 true。问题是，我在 Hugs 中遇到了这种类型的错误：

```
ERROR "find.hs" (line 22): Type error in explicitly typed binding
*** Term           : lookup
*** Type           : String -> [(String,String)] -> [a] -> String
*** Does not match : String -> [(String,String)] -> String 
```

我认为这与虚拟“未找到”值与生成列表中的字符串具有不同类型有关，但我不确定。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-02T16:06:29.843

我认为您的明确类型声明是错误的。你有：

```
lookup :: String -> [(String,String)] -> String 
```

但我认为应该是

```
lookup :: String -> String -> [(String,String)] -> String 
```

实际上，再看一遍之后，您似乎没有使用第二个参数“y”。所以你可以像这样删除它和下划线

```
lookup :: String -> [(String,String)] -> String
lookup _ [] = "Not found"
lookup x zs = if (notFound x zs)
  then "Not found"
  else (head [b | (a,b) <- zs, (a==x)]) 
```

这将允许您保留您拥有的类型声明。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-02T17:07:03.083

顺便问一下，你知道 Haskell Prelude 已经有一个“查找”功能来查找关联列表中的条目吗？这是类型签名（它更通用，接受任何实例 Eq 的密钥类型）：

```
lookup :: (Eq a) => a -> [(a,b)] -> Maybe b 
```

所以你的功能会完成类似下面的事情

```
myLookup x zs = Maybe.fromMaybe "Not found" $ lookup x zs 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-02T16:06:34.773

乍一看，似乎应该删除第二个参数（'y' 和第二个下划线）？声明lookup 采用两个参数，而不是三个。

# jquery - jQuery：填充下拉列表的最佳实践？

> ID：815103
> 
> 赞同：288
> 
> 时间：2009-05-02T16:10:55.073
> 
> 标签：jquery, select

我一直看到的示例似乎不是最理想的，因为它涉及连接字符串，这似乎不是 jQuery。它通常看起来像这样：

```
$.getJSON("/Admin/GetFolderList/", function(result) {
    for (var i = 0; i < result.length; i++) {
        options += '<option value="' + result[i].ImageFolderID + '">' + result[i].Name + '</option>';
    }
}); 
```

有没有更好的办法？

* * *

## 回答 #1

> 赞同：489
> 
> 时间：2009-05-04T02:29:12.617

Andreas Grech 非常接近......它实际上是`this`（注意引用`this`而不是循环中的项目）：

```
var $dropdown = $("#dropdown");
$.each(result, function() {
    $dropdown.append($("<option />").val(this.ImageFolderID).text(this.Name));
}); 
```

* * *

## 回答 #2

> 赞同：75
> 
> 时间：2009-05-02T16:16:46.683

```
$.getJSON("/Admin/GetFolderList/", function(result) {
    var options = $("#options");
    //don't forget error handling!
    $.each(result, function(item) {
        options.append($("<option />").val(item.ImageFolderID).text(item.Name));
    });
}); 
```

我在上面所做的是创建一个新`<option>`元素并将其添加到`options`列表中（假设`options`是下拉元素的 ID。

*PS我的javascript有点生疏所以语法可能不完美*

* * *

## 回答 #3

> 赞同：42
> 
> 时间：2009-05-02T16:23:13.890

当然 - 制作`options`一个字符串数组并使用`.join('')`而不是`+=`每次循环。处理大量选项时性能略有提升......

```
var options = [];
$.getJSON("/Admin/GetFolderList/", function(result) {
    for (var i = 0; i < result.length; i++) {
        options.push('<option value="',
          result[i].ImageFolderID, '">',
          result[i].Name, '</option>');
    }
    $("#theSelect").html(options.join(''));
}); 
```

是的。我一直在使用字符串。信不信由你，这是构建 DOM 片段的最快方法......现在，如果您只有几个选项，那并不重要 -如果您喜欢这种风格，请使用[Dreas 演示的技术。](https://stackoverflow.com/questions/815103/jquery-best-practice-to-populate-drop-down/815112#815112)但请记住，您调用的是浏览器的内部 HTML 解析器`i*2`时间，而不仅仅是一次，并且每次都通过循环修改 DOM……有足够数量的选项。您最终会为此付出代价，尤其是在较旧的浏览器上。

**注意：**`ImageFolderID`正如Justice指出的那样，如果[编码](https://stackoverflow.com/questions/24816/escaping-strings-with-jquery)`Name`不正确，这将分崩离析......

* * *

## 回答 #4

> 赞同：27
> 
> 时间：2013-04-19T10:04:44.500

或许：

```
var options = $("#options");
$.each(data, function() {
    options.append(new Option(this.text, this.value));
}); 
```

* * *

## 回答 #5

> 赞同：20
> 
> 时间：2009-07-01T08:50:23.260

最快的方法是这样的：

```
 $.getJSON("/Admin/GetFolderList/", function(result) {
        var optionsValues = '<select>';
        $.each(result, function(item) {
            optionsValues += '<option value="' + item.ImageFolderID + '">' + item.Name + '</option>';
        });
        optionsValues += '</select>';
        var options = $('#options');
        options.replaceWith(optionsValues);
    }); 
```

根据[此链接](http://www.tvidesign.co.uk/blog/improve-your-jquery-25-excellent-tips.aspx#tip7)是最快的方法，因为在进行任何类型的 DOM 插入时，您将所有内容包装在一个元素中。

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2016-03-16T09:00:04.200

我发现这是在 jquery 网站上工作的

```
$.getJSON( "/Admin/GetFolderList/", function( data ) {
  var options = $("#dropdownID");
  $.each( data, function(key, val) {
    options.append(new Option(key, val));
  });
}); 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2016-03-04T09:32:58.770

我读过使用[文档片段](https://developer.mozilla.org/en-US/docs/Web/API/Document/createDocumentFragment)是高效的，因为它避免了每次插入 DOM 元素时的页面重排，所有浏览器（甚至 IE 6）也很好地支持它。

```
var fragment = document.createDocumentFragment();

$.each(result, function() {
  fragment.appendChild($("<option />").val(this.ImageFolderID).text(this.Name)[0]);
});

$("#options").append(fragment);
```

我第一次在[CodeSchool 的 JavaScript 最佳实践课程](https://www.codeschool.com/courses/javascript-best-practices)中了解到这一点。

这是[不同方法的比较](https://jsperf.com/documentfragment-appendchild-vs-jquery-append/50)，感谢作者。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2016-05-06T00:16:14.860

ES6 的其他方法

```
fetch('https://restcountries.eu/rest/v1/all')
  .then((response) => {
    return response.json()
  })
  .then((countries) => {
    var options = document.getElementById('someSelect');
    countries.forEach((country) => {
      options.appendChild(new Option(country.name, country.name));
    });
  }) 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2016-02-04T17:05:37.520

我希望它有所帮助。我通常使用函数而不是每次都编写所有代码。

```
 $("#action_selector").change(function () {

        ajaxObj = $.ajax({
            url: 'YourURL',
            type: 'POST', // You can use GET
            data: 'parameter1=value1',
            dataType: "json",
            context: this,                
            success: function (data) {
                json: data              
            },
            error: function (request) {
                $(".return-json").html("Some error!");
            }
        });

        json_obj = $.parseJSON(ajaxObj.responseText);            

        var options = $("#selector");
        options.empty();
        options.append(new Option("-- Select --", 0));
        $.each(ajx_obj, function () {
            options.append(new Option(this.text, this.value));
        });
    });
}); 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-05-02T16:17:51.500

我使用选择[框](http://www.texotela.co.uk/code/jquery/select/)jquery 插件。它把你的例子变成：

```
$('#idofselect').ajaxAddOption('/Admin/GetFolderList/', {}, false); 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2012-03-15T17:47:18.193

```
$.get(str, function(data){ 
            var sary=data.split('|');
            document.getElementById("select1").options.length = 0;
            document.getElementById("select1").options[0] = new Option('Select a State');
            for(i=0;i<sary.length-1;i++){
                document.getElementById("select1").options[i+1] = new Option(sary[i]);
                document.getElementById("select1").options[i+1].value = sary[i];
            }
            }); 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2017-05-03T16:08:47.140

```
function LoadCategories() {
    var data = [];
    var url = '@Url.Action("GetCategories", "InternalTables")';
    $.getJSON(url, null, function (data) {
        data = $.map(data, function (item, a) {
            return "<option value=" + item.Value + ">" + item.Description + "</option>";
        });
        $("#ddlCategory").html('<option value="0">Select</option>');
        $("#ddlCategory").append(data.join(""));
    });
} 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2017-08-28T04:50:19.507

```
function generateYears() {
                    $.ajax({
                        type: "GET",
                        url: "getYears.do",
                        data: "",
                        dataType: "json",
                        contentType: "application/json",
                        success: function(msg) {
                            populateYearsToSelectBox(msg);
                        }
                    });
}

function populateYearsToSelectBox(msg) {
  var options = $("#selectYear");
$.each(msg.dataCollecton, function(val, text) {
   options.append(
        $('<option></option>').val(text).html(text)
    );
});
} 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2017-12-11T12:21:10.520

这是我在更改时所做的一个示例，我在第二个选择中获得了第一个选择的孩子

```
jQuery(document).ready(function($) {
$('.your_select').change(function() {
    $.ajaxSetup({
        headers:{'X-CSRF-TOKEN': $("meta[name='csrf-token']").attr('content')}
    });

    $.ajax({
        type:'POST',
        url: 'Link',
        data:{
          'id': $(this).val()
        },
        success:function(r){
          $.each(r, function(res) {
                console.log(r[res].Nom);
                 $('.select_to_populate').append($("<option />").val(r[res].id).text(r[res].Nom));
            });
        },error:function(r) {
          alert('Error');
        }
    });
}); 
```

});`enter code here`

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2020-11-15T16:47:48.367

对于像我这样的 JavaScript 新手，更不用说 JQuery，更多的 JavaScript 方法是：

```
result.forEach(d=>$("#dropdown").append(new Option(d,d))) 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2016-09-05T21:44:28.180

我一直在使用 jQuery 并调用一个函数来填充下拉列表。

```
function loadDropDowns(name,value)
{
   var ddl = "#Categories";
   $(ddl).append('<option value="' + value + '">' + name + "</option>'");
} 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2020-05-06T06:46:43.443

下面是填充 id 为“FolderListDropDown”的下拉列表的 Jquery 方式

```
$.getJSON("/Admin/GetFolderList/", function(result) {
    for (var i = 0; i < result.length; i++) {
        var elem = $("<option></option>");
        elem.attr("value", result[i].ImageFolderID);
        elem.text(result[i].Name);
        elem.appendTo($("select#FolderListDropDown"));
     }
}); 
```

* * *

## 回答 #18

> 赞同：-1
> 
> 时间：2022-01-09T14:56:46.027

您可以从 SQL 端（合并）创建选项并作为字符串返回并将该字符串附加到下拉列表中您可以删除代码中的循环。即，如果您使用任何后端，如 SQL 服务器，您可以使用 coalesce 创建选项标签，即您将获得一个包含整个选项的字符串

然后您可以从后端返回整个字符串并附加到您的下拉列表中

# c# - 如何在处理经过的事件时阻止计时器？

> ID：815104
> 
> 赞同：14
> 
> 时间：2009-05-02T16:10:59.910
> 
> 标签：c#, .net, multithreading, timer

我有一个计时器，它不需要同时处理其经过的事件处理程序。但是处理一个 Elapsed 事件*可能会*干扰其他事件。我实施了以下解决方案，但感觉有些不对；似乎我应该以不同的方式使用计时器或在线程空间中使用另一个对象。计时器似乎最合适，因为我确实需要定期检查状态，但有时检查会比我的间隔时间长。这是解决这个问题的最佳方法吗？

```
// member variable
private static readonly object timerLock = new object();
private bool found = false;

// elsewhere
timer.Interval = TimeSpan.FromSeconds(5).TotalMilliseconds;
timer.Elapsed = Timer_OnElapsed;
timer.Start();

public void Timer_OnElapsed(object sender, ElapsedEventArgs e)
{
  lock(timerLock)
  {
    if (!found)
    {
      found = LookForItWhichMightTakeALongTime();
    }
  }
} 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-02T16:48:37.323

您可以将 AutoReset 设置为 false，然后在完成处理后显式重置计时器。当然，您如何处理它实际上取决于您期望计时器如何操作。这样做会使您的计时器偏离实际指定的时间间隔（就像停止和重新启动一样）。您的机制将允许触发和处理每个间隔，但它可能会导致未处理事件的积压，这些事件现在在接近导致调用处理程序的计时器到期的地方处理。

```
timer.Interval = TimeSpan.FromSeconds(5).TotalMilliseconds;
timer.Elapsed += Timer_OnElapsed;
timer.AutoReset = false;
timer.Start();

public void Timer_OnElapsed(object sender, ElapsedEventArgs e)
{
    if (!found)
    {
      found = LookForItWhichMightTakeALongTime();
    }
    timer.Start();
} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-02T16:13:17.300

我通常在处理它时停止计时器，输入一个 try/finally 块，并在完成后恢复计时器。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-02T17:10:43.403

如果`LookForItWhichMightTakeALongTime()`需要很长时间，我建议不要使用 a`System.Windows.Forms.Timer`因为这样做会锁定您的 UI 线程，并且用户可能会认为您的应用程序已冻结而杀死您的应用程序。

您可以使用的是 a `BackgroundWorker`（`Timer`如果需要，还可以使用 a ）。

```
public class MyForm : Form
{
  private BackgroundWorker backgroundWorker = new BackgroundWorker();

  public MyForm()
  {
    InitializeComponents();
    backgroundWorker.DoWork += backgroundWorker_DoWork;
    backgroundWorker.RunWorkerCompleted +=
                                backgroundWorker_RunWorkerCompleted;
    backgroundWorker.RunWorkerAsync();
  }

  private void backgroundWorker_DoWork(object sender, DoWorkEventArgs e)
  {
    e.Result = LookForItWhichMightTakeALongTime();
  }

  private void backgroundWorker_RunWorkerCompleted(object sender,
                                             RunWorkerCompletedEventArgs e)
  {
    found = e.Result as MyClass;
  }
} 
```

您可以`RunWorkerAsync()`从任何您想拨打的电话，即使您愿意，也可以拨打电话`Timer`。并且只需确保检查是否`BackgroundWorker`已经在运行，因为`RunWorkerAsync()`在运行时调用会引发异常。

```
private void timer_Tick(object sender, EventArgs e)
{
  if (!backgroundWorker.IsBusy)
    backgroundWorker.RunWorkerAsync();
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-02T16:15:26.093

```
timer.enabled = false 
```

或者

```
timer.stop(); 
```

和

```
timer.enabled = true 
```

或者

```
timer.start(); 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-05-02T16:45:50.123

我像这样使用 System.Threading.Timer

```
 class Class1
    {
        static Timer timer = new Timer(DoSomething,null,TimeSpan.FromMinutes(1),TimeSpan.FromMinutes(1));

        private static void DoSomething(object state)
        {
            timer = null; // stop timer

            // do some long stuff here

            timer = new Timer(DoSomething, null, TimeSpan.FromMinutes(1), TimeSpan.FromMinutes(1));
        }

    } 
```

# python - 是否有一个装饰器可以简单地缓存函数返回值？

> ID：815110
> 
> 赞同：209
> 
> 时间：2009-05-02T16:15:40.493
> 
> 标签：python, caching, decorator, memoization

考虑以下：

```
@property
def name(self):

    if not hasattr(self, '_name'):

        # expensive calculation
        self._name = 1 + 1

    return self._name 
```

我是新手，但我认为缓存可以分解为装饰器。只是我没有找到喜欢的;）

PS真正的计算不依赖于可变值

* * *

## 回答 #1

> 赞同：252
> 
> 时间：2012-03-12T20:28:46.620

从 Python 3.2 开始，有一个内置的装饰器：

[`@functools.lru_cache(maxsize=100, typed=False)`](http://docs.python.org/dev/library/functools.html#functools.lru_cache)

> 装饰器用一个可保存最多 maxsize 最近调用的记忆可调用函数来包装函数。当使用相同的参数定期调用昂贵的或 I/O 绑定的函数时，它可以节省时间。

[用于计算斐波那契数](http://en.wikipedia.org/wiki/Fibonacci_number)的 LRU 缓存示例：

```
from functools import lru_cache

@lru_cache(maxsize=None)
def fib(n):
    if n < 2:
        return n
    return fib(n-1) + fib(n-2)

>>> print([fib(n) for n in range(16)])
[0, 1, 1, 2, 3, 5, 8, 13, 21, 34, 55, 89, 144, 233, 377, 610]

>>> print(fib.cache_info())
CacheInfo(hits=28, misses=16, maxsize=None, currsize=16) 
```

* * *

如果你被 Python 2.x 卡住了，这里是其他兼容的记忆库的列表：

*   `functools32`| [派皮](https://pypi.python.org/pypi/functools32)| [源代码](https://github.com/MiCHiLU/python-functools32)
*   `repoze.lru`| [派皮](https://pypi.python.org/pypi/repoze.lru/)| [源代码](https://github.com/repoze/repoze.lru)
*   `pylru`| [派皮](https://pypi.python.org/pypi/pylru/)| [源代码](https://github.com/jlhutch/pylru)
*   `backports.functools_lru_cache`| [派皮](https://pypi.python.org/pypi/backports.functools_lru_cache)| [源代码](https://github.com/jaraco/backports.functools_lru_cache)

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2009-05-02T16:42:33.143

听起来您**不是**在要求通用的记忆装饰器（即，您对要缓存不同参数值的返回值的一般情况不感兴趣）。也就是说，你想要这个：

```
x = obj.name  # expensive
y = obj.name  # cheap 
```

而一个通用的记忆装饰器会给你这个：

```
x = obj.name()  # expensive
y = obj.name()  # cheap 
```

我认为方法调用语法是更好的风格，因为它暗示了计算成本高昂的可能性，而属性语法则暗示了快速查找。

[更新：我之前在这里链接和引用的基于类的记忆装饰器不适用于方法。我已经用装饰器函数替换了它。] 如果你愿意使用通用的记忆装饰器，这里有一个简单的：

```
def memoize(function):
  memo = {}
  def wrapper(*args):
    if args in memo:
      return memo[args]
    else:
      rv = function(*args)
      memo[args] = rv
      return rv
  return wrapper 
```

示例用法：

```
@memoize
def fibonacci(n):
  if n < 2: return n
  return fibonacci(n - 1) + fibonacci(n - 2) 
```

可以在[此处](http://code.activestate.com/recipes/496879/)找到另一个对缓存大小有限制的记忆装饰器。

* * *

## 回答 #3

> 赞同：35
> 
> 时间：2019-05-12T09:15:51.190

**Python 3.8`functools.cached_property`装饰器**

[https://docs.python.org/dev/library/functools.html#functools.cached_property](https://docs.python.org/dev/library/functools.html#functools.cached_property)

`cached_property`来自 Werkzeug 的内容在：[https](https://stackoverflow.com/a/5295190/895245) ://stackoverflow.com/a/5295190/895245 中被提及，但据说派生的版本将合并到 3.8 中，这太棒了。

这个装饰器可以被看作是缓存，或者当你没有任何参数时`@property`作为一个清洁器 。`@functools.lru_cache`

文档说：

> ```
> @functools.cached_property(func) 
> ```
> 
> 将类的方法转换为属性，其值被计算一次，然后在实例的生命周期内作为普通属性缓存。与 property() 类似，但增加了缓存。对于实例的昂贵计算属性很有用，否则这些属性实际上是不可变的。
> 
> 例子：
> 
> ```
> class DataSet:
>     def __init__(self, sequence_of_numbers):
>         self._data = sequence_of_numbers
> 
>     @cached_property
>     def stdev(self):
>         return statistics.stdev(self._data)
> 
>     @cached_property
>     def variance(self):
>         return statistics.variance(self._data) 
> ```
> 
> 3.8 版中的新功能。
> 
> 注意此装饰器要求每个实例上的**dict**属性是可变映射。这意味着它不适用于某些类型，例如元类（因为类型实例上的**dict**属性是类名称空间的只读代理），以及那些指定**插槽**而不包括**dict**作为已定义插槽之一的类型（如此类根本不提供**dict**属性）。

* * *

## 回答 #4

> 赞同：26
> 
> 时间：2014-03-21T07:27:09.240

```
class memorize(dict):
    def __init__(self, func):
        self.func = func

    def __call__(self, *args):
        return self[args]

    def __missing__(self, key):
        result = self[key] = self.func(*key)
        return result 
```

样品用途：

```
>>> @memorize
... def foo(a, b):
...     return a * b
>>> foo(2, 4)
8
>>> foo
{(2, 4): 8}
>>> foo('hi', 3)
'hihihi'
>>> foo
{(2, 4): 8, ('hi', 3): 'hihihi'} 
```

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2020-10-26T12:26:22.213

`functools.cache`已在 Python 3.9 ( [docs](https://docs.python.org/dev/library/functools.html?highlight=s#functools.cache) ) 中发布：

```
from functools import cache

@cache
def factorial(n):
    return n * factorial(n-1) if n else 1 
```

在以前的 Python 版本中，[早期的答案之一](https://stackoverflow.com/a/9674327/6900838)仍然是`lru_cache`作为没有限制和 lru 功能的普通缓存使用的有效解决方案。（[文档](https://docs.python.org/3/library/functools.html#functools.lru_cache)）

> 如果 maxsize 设置为 None，则禁用 LRU 功能，并且缓存可以无限制地增长。

这是它的一个更漂亮的版本：

```
cache = lru_cache(maxsize=None)

@cache
def func(param1):
   pass 
```

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2011-03-14T05:48:16.467

Werkzeug 有一个`cached_property`装饰器 ( [docs](http://werkzeug.pocoo.org/docs/utils/#werkzeug.utils.cached_property) , [source](https://github.com/mitsuhiko/werkzeug/blob/master/werkzeug/utils.py) )

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2015-06-07T21:53:33.240

我编写了这个简单的装饰器类来缓存函数响应。我发现它对我的项目非常有用：

```
from datetime import datetime, timedelta 

class cached(object):
    def __init__(self, *args, **kwargs):
        self.cached_function_responses = {}
        self.default_max_age = kwargs.get("default_cache_max_age", timedelta(seconds=0))

    def __call__(self, func):
        def inner(*args, **kwargs):
            max_age = kwargs.get('max_age', self.default_max_age)
            if not max_age or func not in self.cached_function_responses or (datetime.now() - self.cached_function_responses[func]['fetch_time'] > max_age):
                if 'max_age' in kwargs: del kwargs['max_age']
                res = func(*args, **kwargs)
                self.cached_function_responses[func] = {'data': res, 'fetch_time': datetime.now()}
            return self.cached_function_responses[func]['data']
        return inner 
```

用法很简单：

```
import time

@cached
def myfunc(a):
    print "in func"
    return (a, datetime.now())

@cached(default_max_age = timedelta(seconds=6))
def cacheable_test(a):
    print "in cacheable test: "
    return (a, datetime.now())

print cacheable_test(1,max_age=timedelta(seconds=5))
print cacheable_test(2,max_age=timedelta(seconds=5))
time.sleep(7)
print cacheable_test(3,max_age=timedelta(seconds=5)) 
```

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2009-05-03T03:25:54.390

啊，只需要为此找到正确的名称：“[惰性属性评估](http://code.activestate.com/recipes/363602/)”。

我也经常这样做；也许我会在某个时候在我的代码中使用那个食谱。

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2015-04-27T08:46:35.023

**免责声明：**我是[kids.cache](https://github.com/0k/kids.cache)的作者。

你应该检查一下`kids.cache`，它提供了一个`@cache`适用于 python 2 和 python 3 的装饰器。没有依赖关系，大约 100 行代码。它使用起来非常简单，例如，考虑到您的代码，您可以像这样使用它：

```
pip install kids.cache 
```

然后

```
from kids.cache import cache
...
class MyClass(object):
    ...
    @cache            # <-- That's all you need to do
    @property
    def name(self):
        return 1 + 1  # supposedly expensive calculation 
```

或者您可以将`@cache`装饰器放在`@property`（相同的结果）之后。

在属性上使用缓存称为*惰性评估*，`kids.cache`可以做更多事情（它适用于具有任何参数、属性、任何类型的方法甚至类的函数......）。对于高级用户，`kids.cache`支持`cachetools`为 python 2 和 python 3（LRU、LFU、TTL、RR 缓存）提供精美的缓存存储。

**重要说明**：默认的缓存存储`kids.cache`是标准字典，不建议将其用于具有不同查询的长时间运行的程序，因为它会导致缓存存储不断增长。对于这种用法，您可以使用例如插件其他缓存存储（`@cache(use=cachetools.LRUCache(maxsize=2))`以装饰您的函数/属性/类/方法...）

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2018-11-08T13:06:21.767

有[fastcache](https://pypi.org/project/fastcache/)，它是“Python 3 functools.lru_cache 的 C 实现。提供超过标准库 10-30 倍的加速。”

与[选择的答案](https://stackoverflow.com/a/9674327/1073426)相同，只是导入不同：

```
from fastcache import lru_cache
@lru_cache(maxsize=128, typed=False)
def f(a, b):
    pass 
```

此外，它安装在[Anaconda](https://www.anaconda.com/distribution/)中，与[需要安装](https://anaconda.org/travis/functools)的 functools 不同。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2010-01-14T00:40:44.637

Python Wiki上还有另一个*memoize装饰器示例：*

[http://wiki.python.org/moin/PythonDecoratorLibrary#Memoize](http://wiki.python.org/moin/PythonDecoratorLibrary#Memoize)

这个例子有点聪明，因为如果参数是可变的，它就不会缓存结果。（检查那个代码，它非常简单有趣！）

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2013-05-09T10:00:02.690

如果您使用的是 Django 框架，它有这样一个属性来缓存 API 使用的视图或响应，`@cache_page(time)`并且还可以有其他选项。

例子：

```
@cache_page(60 * 15, cache="special_cache")
def my_view(request):
    ... 
```

更多细节可以在[这里](https://docs.djangoproject.com/en/dev/topics/cache/)找到。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2018-03-03T08:19:55.197

试试joblib [https://joblib.readthedocs.io/en/latest/memory.html](https://joblib.readthedocs.io/en/latest/memory.html)

```
from joblib import Memory
memory = Memory(cachedir=cachedir, verbose=0)
@memory.cache
    def f(x):
        print('Running f(%s)' % x)
        return x 
```

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2016-04-26T06:36:31.360

除了[Memoize 示例](http://wiki.python.org/moin/PythonDecoratorLibrary#Memoize)，我还发现了以下 python 包：

*   [缓存](https://pypi.python.org/pypi/cachepy/); 它允许设置 ttl 和\或缓存函数的调用次数；此外，可以使用加密的基于文件的缓存...
*   [每缓存](https://pypi.python.org/pypi/percache)

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2018-12-24T23:57:00.037

`@lru_cache`默认属性不好

我的`@mem`装饰师：

```
import inspect
from copy import deepcopy
from functools import lru_cache, wraps
from typing import Any, Callable, Dict, Iterable

# helper
def get_all_kwargs_values(f: Callable, kwargs: Dict[str, Any]) -> Iterable[Any]:
    default_kwargs = {
        k: v.default
        for k, v in inspect.signature(f).parameters.items()
        if v.default is not inspect.Parameter.empty
    }

    all_kwargs = deepcopy(default_kwargs)
    all_kwargs.update(kwargs)

    for key in sorted(all_kwargs.keys()):
        yield all_kwargs[key]

# the best decorator
def mem(func: Callable) -> Callable:
    cache = dict()

    @wraps(func)
    def wrapper(*args, **kwargs) -> Any:
        all_kwargs_values = get_all_kwargs_values(func, kwargs)
        params = (*args, *all_kwargs_values)
        _hash = hash(params)

        if _hash not in cache:
            cache[_hash] = func(*args, **kwargs)

        return cache[_hash]

    return wrapper

# some logic
def counter(*args) -> int:
    print(f'* not_cached:', end='\t')
    return sum(args)

@mem
def check_mem(a, *args, z=10) -> int:
    return counter(a, *args, z)

@lru_cache
def check_lru(a, *args, z=10) -> int:
    return counter(a, *args, z)

def test(func) -> None:
    print(f'\nTest {func.__name__}:')

    print('*', func(1, 2, 3, 4, 5))
    print('*', func(1, 2, 3, 4, 5))
    print('*', func(1, 2, 3, 4, 5, z=6))
    print('*', func(1, 2, 3, 4, 5, z=6))
    print('*', func(1))
    print('*', func(1, z=10))

def main():
    test(check_mem)
    test(check_lru)

if __name__ == '__main__':
    main() 
```

输出：

```
Test check_mem:
* not_cached:   * 25
* 25
* not_cached:   * 21
* 21
* not_cached:   * 11
* 11

Test check_lru:
* not_cached:   * 25
* 25
* not_cached:   * 21
* 21
* not_cached:   * 11
* not_cached:   * 11 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2013-09-12T21:01:43.943

我实现了类似的东西，使用 pickle 来实现持久性，并使用 sha1 来实现几乎肯定唯一的简短 ID。基本上，缓存对函数的代码和参数的历史进行哈希处理以获取 sha1，然后查找名称中包含该 sha1 的文件。如果存在，则打开它并返回结果；如果没有，它会调用该函数并保存结果（可选地，仅在需要一定时间来处理时才保存）。

也就是说，我发誓我找到了一个执行此操作的现有模块，并发现自己在这里试图找到该模块......我能找到的最接近的是这个，看起来很正确：[http://chase-seibert.github。 io/blog/2011/11/23/pythondjango-disk-based-caching-decorator.html](http://chase-seibert.github.io/blog/2011/11/23/pythondjango-disk-based-caching-decorator.html)

我看到的唯一问题是它不适用于大型输入，因为它散列 str(arg)，这对于巨型数组来说并不是唯一的。

如果有一个**unique_hash** () 协议让一个类返回其内容的安全散列，那就太好了。对于我关心的类型，我基本上是手动实现的。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2018-03-15T23:00:44.550

如果您使用 Django 并想要缓存视图，请参阅[Nikhil Kumar 的回答](https://stackoverflow.com/a/16459127/2693875)。

但是如果你想缓存任何函数结果，你可以使用[django-cache-utils](https://github.com/infoscout/django-cache-utils)。

它重用 Django 缓存并提供易于使用的`cached`装饰器：

```
from cache_utils.decorators import cached

@cached(60)
def foo(x, y=0):
    print 'foo is called'
    return x+y 
```

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2021-05-16T09:46:06.783

# 函数缓存简单解决方案

## 使用 ttl（生命周期）和 max_entries

*   当修饰函数将不可散列的类型作为输入（例如字典）时不起作用
*   可选参数：ttl（每个条目的生存时间）
*   可选参数：max_entries（如果缓存参数组合过多而不会使存储混乱）
*   确保该功能没有重要的副作用

# 示例使用

```
import time

@cache(ttl=timedelta(minutes=3), max_entries=300)
def add(a, b):
    time.sleep(2)
    return a + b

@cache()
def substract(a, b):
    time.sleep(2)
    return a - b

a = 5
# function is called with argument combinations the first time -> it takes some time
for i in range(5):
    print(add(a, i))

# function is called with same arguments again? -> will answer from cache
for i in range(5):
    print(add(a, i)) 
```

# 复制装饰器代码

```
from datetime import datetime, timedelta

def cache(**kwargs):
  def decorator(function):
    # static function variable for cache, lazy initialization
    try: function.cache
    except: function.cache = {}
    def wrapper(*args):
        # if nothing valid in cache, insert something
        if not args in function.cache or datetime.now() > function.cache[args]['expiry']:
            if 'max_entries' in kwargs:
                max_entries = kwargs['max_entries']
                if max_entries != None and len(function.cache) >= max_entries:
                    now = datetime.now()
                    # delete the the first expired entry that can be found (lazy deletion)
                    for key in function.cache:
                        if function.cache[key]['expiry'] < now:
                            del function.cache[key]
                            break
                    # if nothing is expired that is deletable, delete the first
                    if len(function.cache) >= max_entries:
                        del function.cache[next(iter(function.cache))]
            function.cache[args] = {'result': function(*args), 'expiry': datetime.max if 'ttl' not in kwargs else datetime.now() + kwargs['ttl']}

        # answer from cache
        return function.cache[args]['result']
    return wrapper
  return decorator 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2022-01-21T00:10:20.443

```
from functools import wraps

def cache(maxsize=128):
    cache = {}

    def decorator(func):
        @wraps(func)
        def inner(*args, no_cache=False, **kwargs):
            if no_cache:
                return func(*args, **kwargs)

            key_base = "_".join(str(x) for x in args)
            key_end = "_".join(f"{k}:{v}" for k, v in kwargs.items())
            key = f"{key_base}-{key_end}"

            if key in cache:
                return cache[key]

            res = func(*args, **kwargs)

            if len(cache) > maxsize:
                del cache[list(cache.keys())[0]]
                cache[key] = res

            return res

        return inner

    return decorator

def async_cache(maxsize=128):
    cache = {}

    def decorator(func):
        @wraps(func)
        async def inner(*args, no_cache=False, **kwargs):
            if no_cache:
                return await func(*args, **kwargs)

            key_base = "_".join(str(x) for x in args)
            key_end = "_".join(f"{k}:{v}" for k, v in kwargs.items())
            key = f"{key_base}-{key_end}"

            if key in cache:
                return cache[key]

            res = await func(*args, **kwargs)

            if len(cache) > maxsize:
                del cache[list(cache.keys())[0]]
                cache[key] = res

            return res

        return inner

    return decorator 
```

## 示例使用

```
import asyncio
import aiohttp

# Removes the aiohttp ClientSession instance warning.
class HTTPSession(aiohttp.ClientSession):
    """ Abstract class for aiohttp. """

    def __init__(self, loop=None) -> None:
        super().__init__(loop=loop or asyncio.get_event_loop())

    def __del__(self) -> None:
        if not self.closed:
            self.loop.run_until_complete(self.close())
            self.loop.close()

        return 

session = HTTPSession()

@async_cache()
async def query(url, method="get", res_method="text", *args, **kwargs):
    async with getattr(session, method.lower())(url, *args, **kwargs) as res:
        return await getattr(res, res_method)()

async def get(url, *args, **kwargs):
    return await query(url, "get", *args, **kwargs)

async def post(url, *args, **kwargs):
    return await query(url, "post", *args, **kwargs)

async def delete(url, *args, **kwargs):
    return await query(url, "delete", *args, **kwargs) 
```

# asp.net - 即使文本框为空，如何使自定义验证器触发？

> ID：815111
> 
> 赞同：3
> 
> 时间：2009-05-02T16:16:28.807
> 
> 标签：asp.net, validation, custom-validators

我在文本框上设置了一个自定义验证器。

它只验证文本框中是否有一些文本，当有人点击提交按钮时，我需要它一直触发。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-02T16:43:07.353

将您的设置[`CustomValidator.ValidateEmptyText`](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.customvalidator.validateemptytext.aspx)为`true`.

来自 MSDN：

> [ValidateEmptyText] [g] 设置或设置一个布尔值，指示是否应验证空文本。

# java - 什么 Java Swing 事件可用于知道应用程序何时完成启动？

> ID：815129
> 
> 赞同：6
> 
> 时间：2009-05-02T16:26:07.893
> 
> 标签：java, swing

我正在寻找一个地方来挂钩一些代码，以便在应用程序完成加载后以编程方式创建、调整大小和定位 JPanel。

我刚开始使用Java。我正在使用带有 jdk1.6.0_13 的 NetBeans 6.5.1。我已经使用新项目向导创建了一个基本的 Java/Swing 桌面应用程序。这是一个 SingleFrameApplication，它使用带有中央主 JPanel 的 FrameView，其中放置了所有 UI 元素。

我首先在 FrameView 构造函数中尝试了我的代码，但是当我尝试根据我添加到 UI 的设计时控件之一的边界矩形来排列我的 JPanel 时，该控件尚未完成定位和调整大小，所以我得到坐标全为零。

我已经通过在应用程序加载后从单击事件调用它来验证我的代码是否按预期工作，所以我的问题是找到一种方法来了解所有内容何时完成调整大小和排列。

我还尝试了主 JPanel 中的 componentShown 事件，但后来我读到只有在显式调用 setVisible 时才会触发该事件，这在正常应用程序启动期间显然不会发生。

任何人都可以提供一些指示吗？谢谢。

**更新：**

除了我在下面的回答中提到的内容之外，我还阅读了有关 Application.ready() 方法的信息。这也是了解应用程序的 UI 部分何时完成它需要做的所有事情的兴趣点。不过，从应用程序与我的观点交流似乎有点混乱。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-02T19:24:51.067

我采用的解决方案实际上是 Charles Marin 和 JRL 的答案的组合（我赞成你的两个答案，谢谢）。

我让我的 FrameView 类实现了 WindowListener。

```
...
public class MyView extends FrameView implements WindowListener
... 
```

在我的 FrameView 构造函数中，我向应用程序的主框架添加了一个侦听器。

```
...
getFrame().addWindowListener((WindowListener) this);
... 
```

然后在我的 windowActivated 实现中，我可以调用我必须根据其他控件的位置和大小在主 JPanel 上安排和调整控件大小的代码。

```
public void windowActivated(WindowEvent e)
{
    // The application should now be finished doing its startup stuff.
    // Position and size a control based on other UI controls here
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-02T16:33:33.553

我*想*你想要WindowActivated。看看[教程的这一部分](http://java.sun.com/docs/books/tutorial/uiswing/events/windowlistener.html)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-02T16:36:56.463

我会尝试使用`getFrame().isValid()`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-02T19:23:57.623

我认为这是所见即所得的编辑器。我正在查看 NetBeans 6.1，因此您的体验可能会有所不同。

布局 Swing 组件的传统方式是使用[LayoutManager](http://java.sun.com/javase/6/docs/api/java/awt/LayoutManager.html)（或[LayoutManager2](http://java.sun.com/javase/6/docs/api/java/awt/LayoutManager2.html)）。根据 NetBeans 帮助，可视化编辑器支持这些，只要它们不需要对约束的支持。

程序是这样的：

1.  创建一个新的 JavaBean 并让它实现 LayoutManager（调色板支持也需要一个 BeanInfo - 您可以通过右键单击 bean 类来创建一个）
2.  构建项目
3.  右键单击 bean 并选择*Tools > Add to Palette...*并添加它
4.  右键单击要设置布局的面板，然后选择*设置布局 > 您的 Bean 名称*

您可能会发现设计时体验有些欠缺。

示例布局实现：

```
public class StepLayoutBean extends Object implements Serializable, LayoutManager {

    public void addLayoutComponent(String name, Component component) {
    }

    public void layoutContainer(Container container) {
        Dimension space = container.getSize();
        int xoffset = 0;
        int yoffset = 0;
        for (Component kid : container.getComponents()) {
            Dimension prefSize = kid.getPreferredSize();
            if (prefSize.width + xoffset > space.width) {
                xoffset = 0;
            }
            Rectangle bounds = new Rectangle(xoffset, yoffset, prefSize.width, prefSize.height);
            kid.setBounds(bounds);
            xoffset += prefSize.width;
            yoffset += prefSize.height;
        }
    }

    public Dimension minimumLayoutSize(Container container) {
        Dimension size = new Dimension();
        for (Component kid : container.getComponents()) {
            Dimension minSize = kid.getMinimumSize();
            size.width = minSize.width > size.width ? minSize.width : size.width;
            size.height += minSize.height;
        }
        return size;
    }

    public Dimension preferredLayoutSize(Container container) {
        Dimension size = new Dimension();
        for (Component kid : container.getComponents()) {
            Dimension prefSize = kid.getPreferredSize();
            size.width += prefSize.width;
            size.height += prefSize.height;
        }
        return size;
    }

    public void removeLayoutComponent(Component component) {
    }
} 
```

如果自定义布局不符合要求，请查看组件属性面板下的事件绑定 - 尽管以这种方式调整大小可能会导致某种递归事件风暴。

# asp.net - 为什么我的错误显示在我的控件旁边和验证控件摘要中？

> ID：815132
> 
> 赞同：2
> 
> 时间：2009-05-02T16:27:50.917
> 
> 标签：asp.net, validation

为什么我的错误显示在我的控件旁边和验证控件摘要中？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-02T16:32:21.483

默认情况下，如果您有[`ValidationSummary`](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.requiredfieldvalidator(v=vs.110).aspx)控件，则错误消息会显示在两个位置。如果您希望错误消息仅显示在 中`ValidationSummary`，则将`Display`验证控件中的属性设置为`None`。

从[BaseValidator.Display 属性](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.basevalidator.display(v=vs.110).aspx)：

```
None    The validation message is never displayed inline.
Static  Space for the validation message is allocated in the page layout.
Dynamic Space for the validation message is dynamically added to the page if validation fails. 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-02T16:31:26.913

很可能是因为您没有设置

```
Display="None" 
```

在您的验证控件中。通过设置`Display`为`None`您表示您不希望错误消息出现在验证控件本身的位置，仅出现在验证摘要中。

# c# - C# Foreach 循环 - 继续问题

> ID：815134
> 
> 赞同：6
> 
> 时间：2009-05-02T16:28:46.967
> 
> 标签：c#, datagridview, foreach, continue

我的 C# Foreach 循环中的 continue 语句有问题。

我希望它检查 datagridview 中是否有空白单元格，如果有，则跳过打印值并继续检查下一个单元格。

非常感谢帮助。

这是代码：

```
foreach (DataGridViewRow row in this.dataGridView1.Rows)
{                            
    foreach (DataGridViewCell cell in row.Cells)
    {
        if (cell.Size.IsEmpty)
        {
            continue;
        }
        MessageBox.Show(cell.Value.ToString());
    }
} 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-02T16:33:35.270

好吧，您当前正在检查单元格的*大小*是否为零。在网格中，列中的每个单元格都具有相同的宽度，而行中的每个单元格都具有相同的高度（通常，无论如何）。

您想根据单元格的*值*进行检查。例如：

```
if (cell.Value == null || cell.Value.Equals(""))
{
    continue;
} 
```

调整它以获得您感兴趣的“空”值的任何其他表示。如果有很多，您可能想要为此编写一个特定的方法，并在检查中调用它：

```
if (IsEmptyValue(cell.Value))
{
    continue;
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-02T16:31:59.597

你不需要在这里使用 continue 关键字，你可以这样做：

```
foreach (DataGridViewRow row in this.dataGridView1.Rows)
{                            
    foreach (DataGridViewCell cell in row.Cells)
    {
        if (!cell.Size.IsEmpty) MessageBox.Show(cell.Value.ToString()); // note the ! operator
    }
} 
```

此外，您正在检查单元格的*大小*是否为空。这真的是你想做的吗？

你得到什么错误？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-02T16:32:12.667

您不应该检查单元格的值是否为空而不是大小吗？

```
if(String.IsNullOrEmpty(cell.Value.ToString()))
    continue; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-04-21T07:11:21.840

我只想读取单元格 [1] 数据...olny

```
foreach (DataGridViewRow row in this.dataGridView1.Rows)
{                            
    foreach (DataGridViewCell cell in row.Cells[1])
    {
       if (cell[1].Value == null || cell.Value.Equals(""))
{
    continue;
}

        MessageBox.Show(cell[1].Value.ToString());
    }
} 
```

# jquery - 如何使用 jQuery 获取在文本框中输入的文本长度？

> ID：815146
> 
> 赞同：143
> 
> 时间：2009-05-02T16:34:13.193
> 
> 标签：jquery

如何使用 jQuery 获取在文本框中输入的文本长度？

* * *

## 回答 #1

> 赞同：331
> 
> 时间：2009-05-02T16:35:51.100

```
var myLength = $("#myTextbox").val().length; 
```

* * *

## 回答 #2

> 赞同：106
> 
> 时间：2009-05-02T16:40:01.993

如果您的文本框的 id 属性为“mytextbox”，那么您可以像这样获得长度：

```
var myLength = $("#mytextbox").val().length; 
```

*   `$("#mytextbox")`通过 id 查找文本框。
*   `.val()`获取用户输入的输入元素的值，为字符串。
*   `.length`获取字符串中的字符数。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2012-05-03T06:34:03.430

对我来说，它不是文本框，而是跨度标签，这对我有用。

```
var len = $("span").text().length; 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-12-16T12:11:15.927

下面提到的代码非常适合获取文本框中输入的任何字符的长度。

`$("#Texboxid").val().length;`

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-03-27T10:13:14.137

## **代码**

```
$('#montant-total-prevu').on("change", function() {

var taille = $('#montant-total-prevu').val().length;

    if (taille > 9) {

//TODO

}

}); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-02T20:42:00.197

您只需要使用适当的 jQuery 选择器获取元素，然后`.val()`获取包含在输入文本框中的字符串的方法，然后`.length`在该字符串上调用。

`$('input:text').val().length`

但是，请注意，如果选择器匹配多个输入，`.val()`则只会返回第**一个**文本框的值。您还可以更改选择器以获取更具体的元素，但保留它`:text`以确保它是输入文本框。

另一方面，要获取另一个非输入元素中包含的字符串的长度，您可以使用该`.text()`函数获取字符串，*然后*`.length`在*该*字符串上使用以查找其长度。

# design-patterns - 如何处理基于消息类型的不同处理？

> ID：815154
> 
> 赞同：1
> 
> 时间：2009-05-02T16:38:01.280
> 
> 标签：design-patterns, oop, observer-pattern

我有一个进程，它有一个“通知”方法，它接收消息类型的基类作为参数。我想根据派生的消息类型进行不同的处理。这是否意味着我需要添加一个名为“process”或类似于消息类型的方法，并使用多态调用它？为每种特定的消息类型添加“通知”会更好吗？

更多细节：语言是 C++。我认为 notify 在这里是个好主意，因此我只需要一种方法来通知各种消息类型。控制器从指定纯虚拟通知（MsgBaseClass）方法的侦听器类继承。我仍然喜欢这个想法，因为我不必为每种新消息类型添加通知。但是在控制器代码本身中，除了动态转换或向消息添加消息类型之外，我没有看到任何区分消息类型的方法。

编辑：我想我将使用访客模式。它允许我只保留一种通知方法，并且我可以避免在我的代码中使用 switch 语句。“访问者”接口将指定侦听器处理各种派生消息类型所需的各种方法。这将只需要将一条消息添加到 Message 基类，即纯虚拟“accept(MyMessageTypeVisitor v)。派生的消息类将使用 v.visit(this); 来实现它。

我*认为*这应该可行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-02T16:42:21.600

**编辑：我认为 dirkgently 有一个很好的观点，消息不应该知道如何处理自己。因此，我描述的可以将消息用作工厂的方法不是一个好主意。我确实认为抽象流程工厂可能是一个很好的解决方案。**

使用抽象工厂创建一个可以处理处理的对象，并使用多态调用它。这个工厂可能直接包含在消息类中，或者您可以创建一个单独的工厂类，它接受消息类型作为参数并返回适当的对象。

```
class Message {
public:
  virtual Processor *getProcessor() = 0;
  // other methods
};

class Processor {
public:
  virtual void doWork() = 0;
};

class MyListener : Listener {
public:
  void notify(Message *message);
};

void MyListener::notify(Message *message) {
  Processor *proc = message->getProcessor();
  proc->doWork();
}; 
```

（对不起，如果这是不正确的。我的 C++ 有点弱，但我相信它说明了原理。）

这将允许您只为每种消息类型覆盖 getProcessor()，并在那里创建适当的处理器。

IMVHO，多态是要走的路。我猜你想要做的那种处理逻辑不属于消息类，应该移动到单独的类中。我更喜欢这种方法的另一个原因是，如果我添加其他消息，它不需要我更改被通知的类的结构。如果只有一种或两种消息类型，这可能不是问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-02T16:54:26.233

经典的 OO 答案要求基本消息类提供一个抽象方法，具体消息子类覆盖该抽象方法以提供特定处理。

一些（不是很普遍的）语言，如 Dylan 和 CLisp 提供了“通用函数”（在参数类型上动态调度），可以彻底解决问题。

在流行语言中可行的一种灵活方法是鲍勃叔叔的“非循环访问者”设计模式，[http:](http://www.objectmentor.com/resources/articles/acv.pdf) //www.objectmentor.com/resources/articles/acv.pdf ；有关更多访客变体，请参阅 www.ccs.neu.edu/research/demeter/adaptive-patterns/visitor-usage/papers/plop96/variations-visitor-nordberg.ps。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-02T16:44:01.110

您是否坚持观察者设计模式？

重载`notify`看起来像一个候选人。观察者模式非常简单。它基于[好莱坞原则](http://en.wikipedia.org/wiki/Hollywood_Principle)，即“不要打电话给我们，我们会打电话给你！”。这个想法是有一组对象（观察者）并通知他们而不是让他们查询你。您将通用`Event`类型的数据传递给观察者。应该由观察者决定如何处理。如果观察者对不同的事件做出反应，就会有一些`dynamic_casts`（是的，你也需要一个事件层次结构）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-02T16:50:04.480

你可以这样做：

```
DerivedType *dt = dynamic_cast< DerivedType >( &BaseType );
if( dt != NULL )
{
    // Handle processing of DerivedType
} 
```

只需尝试对每个处理的 DerivedType 进行 dynamic_cast。如果你得到一个非空指针，那么你就知道你已经收到了你试图转换到的类型。

# regex - 如何优化正则表达式 (\bL\s*\d{6}\s*\d{7}\b)

> ID：815166
> 
> 赞同：0
> 
> 时间：2009-05-02T16:44:39.050
> 
> 标签：regex

这是对较早问题（[Help Refining RegEx ("\b\d{6}([ ]{1,15})\d{7}\b")](https://stackoverflow.com/questions/814042/help-refining-regex-b-d6-1-15-d7-b)）的跟进。目标是从文件中获取纬度/经度。这由 L 或 6d/7d 的模式表示。我错误地指出在 Lat (305455) 和 Lon (1025446) 的开始之间不可能有 alpha。当我实施建议的正则表达式时，一切都很好，直到我点击了这个文件。请注意，'6770G37 包含一个字母并破坏了模式，或者它有 6 位数字并重新启动了模式。Reg Ex 不够好，无法弄清楚。这是我需要找到的三种不同模式。谢谢！

```
I  FST E  030                                                       66686500    
    L  305455                                              '6770G37 66686501    
       1025446                                             '6770G37 66686502    
    O  ZCA/999                                                      66686503    
    H  05                                                           66686504 
```

* * *

```
I  ARA                                    '* ACADIANA  AIRPORT         29865996    
            L    300216                               '2425     29865997    
                 0915302                              '2425     29865998    
            S    MSY                                            29865999 
```

* * *

```
I JENNA078033 ' ZFW L 322823 0923754 ' ZFW 
```

**（从已删除的答案转移）**

这是 Gishu 的回答的后续，但无法让评论区的格式足够好。他提出的正则表达式`L\s*(\d{6})\s*(?:'.*\n)?\s*(\d{7})`适用于几种可能性，但使用打开多行选项的 .Net 引擎在这种模式上失败了。

目标是捕获 Lat 322441 和 Lon 0994055。

返回匹配：

```
L 322441 '1325 66685780 

```

样本数据.....

```
I ABI E 018 66685779    
        L 322441 '1325 66685780    
           0994055 '1325 66685781    
        O ZCF/999 66685782    
        H 05 66685783    

```

再次感谢各位！

* * *

这是 Gishu 的回答的后续，但无法让评论区的格式足够好。他提出的正则表达式`L\s*(\d{6})\s*(?:'.*\n)?\s*(\d{7})`适用于几种可能性，但使用打开多行选项的 .Net 引擎在这种模式上失败了。

目标是捕获 Lat 322441 和 Lon 0994055。

返回匹配：

```
L 322441 '1325 66685780 

```

样本数据.....

```
I ABI E 018 66685779    
        L 322441 '1325 66685780    
           0994055 '1325 66685781    
        O ZCF/999 66685782    
        H 05 66685783    

```

再次感谢各位！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-02T17:13:41.367

看看这个能不能用。。 `L\s*(\d{6})\s*(?:'.*\n)?\s*(\d{7})`

```
string sText = @" ..." // all the different patterns you posted. I think I have 4
Regex regex = new Regex(@"L\s*(\d{6})\s*(?:'.*\n)?\s*(\d{7})", RegexOptions.Multiline);
foreach (Match everyMatch in regex.Matches(sText))
{
  Console.WriteLine("L {0}, {1}", everyMatch.Groups[1], everyMatch.Groups[2]);
} 
```

输出：

```
L 305455, 1025446
L 300216, 0915302
L 322823, 0923754
L 322441, 0994055 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T22:20:17.220

您可以尝试通过强制执行合法的纬度/经度值来帮助匹配。0994055 似乎意味着 99 40' 55"。如果是这种情况，这意味着你的第一个数字总是 1 或 0（我认为它可能从 0 到 360，因为没有指示符号，但没有符号表示lat 也一样，而且似乎仅限于 6 个字符，这表明符号要么存储在其他地方，要么根本不存储）。

所以代替 (\d{7}) 也许尝试 ([01]\d{6})

我还注意到 '###### 在 lat 和 lon 之后的模式，它总是相同的。所以也许也可以尝试使用反向引用：

```
L\s*(\d{6})\s*(('\d*)\s*.*\n)?\s*(\d{7}(\s*\3)?) 
```

您也可以尝试针对每种一般情况（多行、单行等）创建更小的正则表达式，并用或 | 分隔它们。正则表达式会有点难看，但可能更容易找到解决方案。

祝你好运！

# c# - 在电子商务应用程序中实现按颜色搜索选项

> ID：815175
> 
> 赞同：0
> 
> 时间：2009-05-02T16:47:31.663
> 
> 标签：c#, sql-server-2005

我有一个现有的电子商务应用程序，允许管理员上传产品图片。

截至目前，该功能仅允许为具有多种颜色的产品上传单个图像。颜色由管理员上传为简单的 csv 格式。

业务需求发生了变化，业务希望*在更改产品颜色的下拉列表时，*应用程序目录中显示的产品图像与从下拉列表中选择的颜色相同。

请建议我该怎么做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-02T17:09:15.620

您可以使用 product.color.ext 等文件名存储不同的图像，当下拉列表的状态发生变化时，将其结尾附加到文件名（例如，shirt.red.jpg、shirt.blue.jpg 等）。有多种方法可以做到这一点，这可能是一种解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-03-04T04:54:09.903

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-02T17:07:16.797

由于您尚未发布任何代码。根据您的描述，我假设您使用的是 ASP.NET。如果是这种情况，您可以使用[主题和皮肤](http://msdn.microsoft.com/en-us/library/tx35bd89.aspx)来实现此目的。只需根据您在数据库中选择的默认颜色设置以编程方式设置皮肤。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-02T19:36:53.317

我不明白你的问题，或者业务需求是什么。

很明显，当用户更改下拉列表中的哪个项目被选中时，应该会发生一些事情。这种变化的结果是我不明白的。

这是否像面向客户的页面，并且您希望为特定客户更改图像？或者这就像一个管理员页面，并且您希望为站点的所有用户更改图像（即下拉分类元数据，图像 X 的颜色为 Y）？

# search - Stack Overflow Windows 7 搜索连接器

> ID：815178
> 
> 赞同：4
> 
> 时间：2009-05-02T16:48:46.480
> 
> 标签：search, windows-7

如何为 Stack Overflow 编写 Windows 7 搜索连接器？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-02T16:49:33.063

这是 MSN，因为 Google 不支持 RSS 输出：

```
<?xml version="1.0" encoding="UTF-8"?>
<OpenSearchDescription xmlns="http://a9.com/-/spec/opensearch/1.1/" xmlns:ms-ose="http://schemas.microsoft.com/opensearchext/2009/">
    <ShortName>Stackoverflow.com</ShortName>
    <Description>Stackoverflow search with MSN</Description>
    <Url type="application/rss+xml" template="http://search.msn.com/results.aspx?q=site%3Astackoverflow.com+{searchTerms}&amp;num=10&amp;format=rss"/>
    <Url type="text/html" template="http://search.msn.com/results.aspx?q=site%3Astackoverflow.com+{searchTerms}"/>
</OpenSearchDescription> 
```

将以上内容另存为“Stackoverflow.osdx”并双击它。

# java - JPanel 翻转，FlowLayout 未按预期工作

> ID：815192
> 
> 赞同：-1
> 
> 时间：2009-05-02T16:55:18.150
> 
> 标签：java, alignment, jpanel, jlabel, flowlayout

前几天这段代码正在工作。我改变了一些东西并重新运行它，现在它不能按预期工作。显然，我更改的某些内容改变了行为，但我已经返回并恢复了所有这些更改，但它仍然不起作用。忽略那一点信息（开始），为什么这段代码没有在 JPanel 内放置一个 15x15 的 JLabels 网格？

```
gameBoard.setLayout(new FlowLayout());

for (int i = 0; i < 15; i++)
{
    for (int j = 0; j < 15; j++)
    {
        JLabel tile = new JLabel("");                       
     tile.setHorizontalAlignment(SwingConstants.CENTER);
        tile.setPreferredSize(new Dimension(27, 27));
        tile.setBorder(new EtchedBorder());
        tile.setEnabled(false);

        gameBoard.add(tile);
    }
} 
```

gameBoard 是通过 NetBeans 的 GUI Builder 定义的 JPanel。它有一个首选大小，一个最大大小（与首选相同）。水平/垂直可调整大小选项被禁用，但是当此代码运行时，每个按钮都水平延伸成一行而不会中断。

如果我理解正确，FlowLayout 应该在元素到达其包含元素的末尾时对其进行包装。这发生在今天之前，我真的不知道为什么这种行为停止了？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-02T16:58:33.573

[使用GridLayout](http://java.sun.com/docs/books/tutorial/uiswing/layout/grid.html)会好得多。

```
GridLayout gridLayout = new GridLayout(15, 15); 
```

由于使用了新的外观、不同的字体或某些 Java VM 升级，流程布局可能已更改。不建议为此用途定义流布局，因为您依赖于可能因虚拟机或外观而异的底层大小。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-02T17:54:30.130

为了教一个人如何钓鱼：

修订控制系统很棒。甚至您的系统也在频繁地备份您的源。

一种有用的调试技术是在它起作用之前删除一些东西。设置边框是否会导致代码中断。换一种方式，你能不能写一个简单的程序来演示这个问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-02T17:18:22.417

我发现使用[TableLayout](http://java.sun.com/products/jfc/tsc/articles/tablelayout/)取得了巨大的成功和控制，我会向任何人推荐它。您可以使用特定数量的像素来定义列和行，或者您可以只`TableLayout.PREFERRED`用于每列和/或行。非常漂亮和灵活的布局。我们到处使用它。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-05-02T18:00:57.183

我想到了。显然我必须在代码本身中设置 preferredSize。仅在 Netbeans 属性窗口中设置它是不够的。奇怪的。

# iphone - 添加UITabBar

> ID：815200
> 
> 赞同：0
> 
> 时间：2009-05-02T17:01:28.260
> 
> 标签：iphone, cocoa-touch

我有一个基于 UINavigationBar 的应用程序 - 只有一个导航栏处理我的应用程序中的所有视图工作。

我想在每个视图的底部都有一个标签栏，可以将用户带到他想去的任何视图。

向应用程序添加标签栏的最简单方法是什么？

提前谢谢你，伊利亚。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-02T17:58:31.523

如果您想拥有一个对所有视图都相同且始终可见的选项卡栏，那么您必须：

1.  在您的应用程序委托类中，为名为 tabBarController 的新 UITabBarController 添加一个 IBOutlet
2.  在您的 mainwindow.xib 文件中，您必须添加一个标签栏视图控制器，界面生成器会自动为您创建标签栏
3.  在界面生成器中，配置选项卡栏设置，选项卡，您可以将 UINavigationController 嵌套在选项卡栏中。
4.  将 UITabBarController 实例绑定到您在步骤 1 中创建的 IBOutlet
5.  将您的 applicationDidFinihedLaunching 方法更改为类似于以下代码。

    *   (void)applicationDidFinishLaunching:(UIApplication *)application { [window addSubview:tabBarController.view]; }

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-02T18:09:12.730

请务必在视图层次结构中将 tabBar 添加到导航栏上方。根据您的用户流的结构，您最终可能会使用多个导航控制器。

```
                         tabBarController（在这个例子中，有 3 个部分）
                                |
                  ------------------------------
                  | | |
            导航控制器1 导航控制器2 导航控制器3

```

每个 navController 都维护自己的堆栈。

# jquery - 将页面上的选定文本插入 textarea (jQuery)

> ID：815202
> 
> 赞同：2
> 
> 时间：2009-05-02T17:03:36.947
> 
> 标签：jquery

需要将页面上选定的文本插入到 textarea 中。必须有一些按钮来做到这一点。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-02T17:19:56.843

```
jQuery(function() {
    // Bind the click handler of some button on your page
    jQuery('#someButton').click(function(evt) {
        // Insert the selected text into a given textarea
        var textarea = jQuery('textarea#someTextArea');
        textarea.val(textarea.val() + getSelectedText());
        evt.preventDefault();
    });
});

// Get user selection text on page
function getSelectedText() {
    if (window.getSelection) {
        return window.getSelection();
    }
    else if (document.selection) {
        return document.selection.createRange().text;
    }
    return '';
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-02T17:21:44.560

你可以这样做：

*   [复制所选文本，您可以使用此处](https://stackoverflow.com/questions/717224/how-to-get-selected-text-in-textarea/717226#717226)列出的一些 jquery 插件。
*   将其粘贴到文本区域中：

    $('#textareaselector').text(selectedText)

# jquery - Jquery Ui Sortable 在 IE8 中显示损坏的图像

> ID：815217
> 
> 赞同：1
> 
> 时间：2009-05-02T17:11:21.200
> 
> 标签：jquery, css, jquery-ui, internet-explorer-8

我有一个查询可排序的图像集合，即。项目设置为 img （由于它位于选项卡控件中并且是一个水平列表，无法在列表项目上排序，我只是无法让它工作），除了 IE8（即使在标准合规模式下），其中占位符显示损坏的图像。是否有任何类型的 CSS 设置可用于使占位符在 IE8 中不可见。我试过了

```
visibility : hidden; 
```

我试过设置

```
content : url(transparent.gif); 
```

似乎都没有任何效果。我能做些什么来解决这个问题？关于如何检查显示的 CSS 的任何建议，如在 Dom Explorer 中（或在 IE8 开发人员工具中调用的任何内容）我看不到 img，因为一旦我松开鼠标，它就会消失并且 Dom Explorer 似乎并没有像 Firebug 那样实时更新。

编辑：这是重复的问题[http://jsbin.com/irozu](http://jsbin.com/irozu)

我过度简化了我的示例，另一个问题是整个选项卡是可滚动的，由滑块控制。改变

```
display : inline; 
```

到

```
float : left; 
```

不起作用，因为我们不再有可滚动的项目列表。同样出于某种奇怪的原因，当有滚动条并且您使用“li”而不是“img”作为目标时，可排序停止工作。

更新的示例位于：http: [//jsbin.com/ahawi](http://jsbin.com/ahawi)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-03T03:32:53.453

如果您不想显示占位符，请确保您*没有*设置可排序的`placeholder`选项。

我认为 IE8 中的默认可排序行为没有问题。我试图重新创建您在此托管示例中描述的内容：http: [//jsbin.com/osobu](http://jsbin.com/osobu)（可排序的图像位于第三个选项卡中。）

[如果您提供更多代码或仅编辑我提供的示例（通过http://jsbin.com/osobu/edit](http://jsbin.com/osobu/edit)）以复制问题，这将很有帮助。

**编辑**

针对您的评论，您只需将`items`选项设置为即可`"li"`，问题已解决。另外，我必须给你使用

```
#images li { float: left; } 
```

代替

```
#images li { display: inline: } 
```

否则图像将在您拖动时偏移。

这是固定的演示：http: [//jsbin.com/osezu](http://jsbin.com/osezu)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-06T08:20:59.477

> **占位符显示损坏的图像的位置**。是否有任何类型的 CSS 设置可用于使占位符在 IE8 中不可见。我试过了

出现损坏的图像是因为 jQuery UI 创建（在您的情况下）没有为占位符设置 src 属性的 IMG 元素。要解决这个问题：

1.  不要设置占位符选项或
2.  将您的 .showPlace 类更改为类似

    ```
    .showPlace {
       margin: 20px;
       overflow: hidden;
       width: 0; height: 0;
    } 
    ```

上面的代码将隐藏（不存在的）图像内容，但会使元素可见。

顺便提一句。在我的测试用例中，设置`visibility: hidden`也`.showPlace`很好

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-06T09:47:26.803

我修复了它并减少了很多代码。

主要问题是您设置 DIV 可排序而不是 UL

似乎按照您想要的方式工作：http: [//jsbin.com/egiwu](http://jsbin.com/egiwu)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-03T02:35:09.257

你可以试试：`display: none;`。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-11-01T00:54:52.917

这是另一种解决方法：

```
$('.mysortthings').sortable({
  start: function(event,ui) {
        $('.ui-sortable-placeholder').each( function() {
           this.setAttribute('src','/ico/unipixel.gif'); } );
       }
}); 
```

换句话说，设置一个启动事件处理程序，它设置占位符 img 的 'src' 属性，只要事情开始。

# security - 墨菲定律适用于互联网安全

> ID：815220
> 
> 赞同：2
> 
> 时间：2009-05-02T17:13:02.523
> 
> 标签：security, phishing

我是墨菲定律的狂热爱好者，我在编程时就想到了它。在各个领域都有很多“应用”版本。也许（作为堆栈溢出用户）我们可以编译一个**应用于 Internet Security**的列表。我建议这样做是因为在网络钓鱼、XSS、CSRF 以及围绕程序员和用户的更多对待时，最好列出预期的内容，以便跟踪您的应用程序中可能存在的漏洞和系统。

一个例子是：“漏洞自发出现，但不会以同样的方式消失”。

请展示你对它的想法。提前致谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-08T03:58:45.173

唯一真正安全的系统是关闭电源、浇筑在混凝土块中并密封在配备武装警卫的铅衬房间内的系统——即便如此，我仍有疑问。

——尤金·H·斯帕福德

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-08T01:04:16.793

您的安全系统将成功阻止您跟进破解者的所作所为。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-04T18:59:05.607

绕过讨厌的安全功能的最佳方法是 13 岁。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-08T03:09:28.413

无法穿透的安全性不是。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-04T01:35:49.513

“任何时候遇到安全漏洞，只能找到更多。”

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-08T01:06:50.970

你问的专业人士越多，你的安全漏洞就越多。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-02T17:32:02.243

“期待意外。” （里奇鸭 8-）

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-08T00:59:57.647

这是我今天找到的一个：

一个**“牢不可破”**的安全解决方案是公认的，因为一旦它被破坏，它就会让系统完全开放并且容易受到攻击。

# asp.net-mvc - 如何重定向到 ASP.NET MVC 中的上一个操作？

> ID：815229
> 
> 赞同：132
> 
> 时间：2009-05-02T17:18:02.013
> 
> 标签：asp.net-mvc, routing, redirect

假设我有一些页面

*   `some.web/articles/details/5`
*   `some.web/users/info/bob`
*   `some.web/foo/bar/7`

可以调用一个通用的实用程序控制器，例如

`locale/change/es`或者`authorization/login`

如何让这些方法 ( `change`, `login`) 重定向到先前的操作 ( `details`, `info`, `bar`) 同时将先前的参数传递给它们 ( `5`, `bob`, `7`)？

简而言之：在另一个控制器中执行操作后，如何重定向到我刚刚访问的页面？

* * *

## 回答 #1

> 赞同：164
> 
> 时间：2009-05-02T17:37:33.837

尝试：

```
public ActionResult MyNextAction()
{
    return Redirect(Request.UrlReferrer.ToString());
} 
```

或者，谈到达林所说的，试试这个：

```
public ActionResult MyFirstAction()
{
    return RedirectToAction("MyNextAction",
        new { r = Request.Url.ToString() });
} 
```

然后：

```
public ActionResult MyNextAction()
{
    return Redirect(Request.QueryString["r"]);
} 
```

* * *

## 回答 #2

> 赞同：48
> 
> 时间：2013-08-01T09:28:28.790

如果要从视图中的按钮重定向，可以使用：

```
@Html.ActionLink("Back to previous page", null, null, null, new { href = Request.UrlReferrer}) 
```

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2012-11-05T15:18:44.037

如果您不关心单元测试，那么您可以简单地编写：

```
return Redirect(ControllerContext.HttpContext.Request.UrlReferrer.ToString()); 
```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-05-03T16:41:36.600

关于如何做到这一点的建议：

1.  返回 url 在表单的 POST 请求（以及任何失败的验证）中仍然存在
2.  返回 url 由初始推荐 url 确定
3.  不使用 TempData[] 或其他服务器端状态
4.  处理对操作的直接导航（通过提供默认重定向）

.

```
public ActionResult Create(string returnUrl)
{
    // If no return url supplied, use referrer url.
    // Protect against endless loop by checking for empty referrer.
    if (String.IsNullOrEmpty(returnUrl)
        && Request.UrlReferrer != null
        && Request.UrlReferrer.ToString().Length > 0)
    {
        return RedirectToAction("Create",
            new { returnUrl = Request.UrlReferrer.ToString() });
    }

    // Do stuff...
    MyEntity entity = GetNewEntity();

    return View(entity);
}

[AcceptVerbs(HttpVerbs.Post)]
public ActionResult Create(MyEntity entity, string returnUrl)
{
    try
    {
        // TODO: add create logic here

        // If redirect supplied, then do it, otherwise use a default
        if (!String.IsNullOrEmpty(returnUrl))
            return Redirect(returnUrl);
        else
            return RedirectToAction("Index");
    }
    catch
    {
        return View();  // Reshow this view, with errors
    }
} 
```

您可以像这样在视图中使用重定向：

```
<% if (!String.IsNullOrEmpty(Request.QueryString["returnUrl"])) %>
<% { %>
    <a href="<%= Request.QueryString["returnUrl"] %>">Return</a>
<% } %> 
```

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2015-09-02T11:22:18.837

在 Mvc 中使用纯 html**在 View Page** 中使用 java 脚本 onclick

```
<input type="button" value="GO BACK" class="btn btn-primary" 
onclick="location.href='@Request.UrlReferrer'" /> 
```

这很好用。希望对某人有所帮助。

@JuanPieterse 已经回答使用`@Html.ActionLink`所以如果可能的话有人可以评论或回答使用`@Url.Action`

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2017-11-22T14:34:45.977

我正在使用 .Net Core 2 MVC ，这个对我有用，在控制器使用中 `HttpContext.Request.Headers["Referer"];`

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2009-05-02T17:30:54.493

将 returnUrl 参数（url 编码）传递给*更改*和*登录*操作，并在内部重定向到这个给定的 returnUrl。您的登录操作可能如下所示：

```
public ActionResult Login(string returnUrl) 
{
    // Do something...
    return Redirect(returnUrl);
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2016-07-09T20:44:45.347

`ViewBag.ReturnUrl`您可以使用属性返回上一页。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2017-04-25T09:40:01.077

要在任何视图中动态构造 returnUrl，请尝试以下操作：

```
@{
    var formCollection =
        new FormCollection
            {
                new FormCollection(Request.Form),
                new FormCollection(Request.QueryString)
            };

    var parameters = new RouteValueDictionary();

    formCollection.AllKeys
        .Select(k => new KeyValuePair<string, string>(k, formCollection[k])).ToList()
        .ForEach(p => parameters.Add(p.Key, p.Value));
}

<!-- Option #1 -->
@Html.ActionLink("Option #1", "Action", "Controller", parameters, null)

<!-- Option #2 -->
<a href="/Controller/Action/@object.ID?returnUrl=@Url.Action(ViewContext.RouteData.Values["action"].ToString(), ViewContext.RouteData.Values["controller"].ToString(), parameters)">Option #2</a>

<!-- Option #3 -->
<a href="@Url.Action("Action", "Controller", new { object.ID, returnUrl = Url.Action(ViewContext.RouteData.Values["action"].ToString(), ViewContext.RouteData.Values["controller"].ToString(), parameters) }, null)">Option #3</a> 
```

> 这也适用于布局页面、部分视图和 Html 助手

相关：[MVC3 动态返回 URL](https://stackoverflow.com/questions/7919918/mvc3-dynamic-return-url/43606815#43606815)（相同但来自任何控制器/动作）

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-12-24T08:55:00.747

对于**ASP.NET Core** ，您可以使用 asp-route-* 属性：

```
<form asp-action="Login" asp-route-previous="@Model.ReturnUrl"> 
```

**其他详细示例：** 假设您有一个带有动作的车辆控制器

指数

细节

编辑

并且您可以从索引或详细信息中编辑任何车辆，因此如果您单击从索引编辑，则必须在编辑后返回到索引；如果您单击从详细信息编辑，则必须在编辑后返回到详细信息。

```
//In your viewmodel add the ReturnUrl Property
public class VehicleViewModel
{
     ..............
     ..............
     public string ReturnUrl {get;set;}
}

Details.cshtml
<a asp-action="Edit" asp-route-previous="Details" asp-route-id="@Model.CarId">Edit</a>

Index.cshtml
<a asp-action="Edit" asp-route-previous="Index" asp-route-id="@item.CarId">Edit</a>

Edit.cshtml
<form asp-action="Edit" asp-route-previous="@Model.ReturnUrl" class="form-horizontal">
        <div class="box-footer">
            <a asp-action="@Model.ReturnUrl" class="btn btn-default">Back to List</a>
            <button type="submit" value="Save" class="btn btn-warning pull-right">Save</button>
        </div>
    </form> 
```

在您的控制器中：

```
// GET: Vehicle/Edit/5
    public ActionResult Edit(int id,string previous)
    {
            var model = this.UnitOfWork.CarsRepository.GetAllByCarId(id).FirstOrDefault();
            var viewModel = this.Mapper.Map<VehicleViewModel>(model);//if you using automapper
    //or by this code if you are not use automapper
    var viewModel = new VehicleViewModel();

    if (!string.IsNullOrWhiteSpace(previous)
                viewModel.ReturnUrl = previous;
            else
                viewModel.ReturnUrl = "Index";
            return View(viewModel);
        }

[HttpPost]
    public IActionResult Edit(VehicleViewModel model, string previous)
    {
            if (!string.IsNullOrWhiteSpace(previous))
                model.ReturnUrl = previous;
            else
                model.ReturnUrl = "Index";
            ............. 
            .............
            return RedirectToAction(model.ReturnUrl);
    } 
```

# c# - C# Foreach 循环哈希表问题

> ID：815234
> 
> 赞同：2
> 
> 时间：2009-05-02T17:19:22.960
> 
> 标签：c#, hashtable, foreach

我有一些代码填充了一个哈希表，其中一个问题作为键，一个答案数组列表作为值。

然后我想从哈希表中打印出这些值，以便它显示哈希表中每个单独问题的问题和相应的解决方案。

我知道我用 foreach 循环做了一些完全愚蠢的事情来打印出哈希表的内容，但是我已经连续编码了好几个小时，我想不出打印出嵌套数组列表的逻辑。

非常感谢帮助。

这是代码：

```
//Hashtable Declaration
static Hashtable sourceList = new Hashtable();    

//Class For Storing Question Information
public class QuestionAnswerClass
{
    public string simonQuestion;
    public ArrayList simonAnswer = new ArrayList();
}

//Foreach loop which populates a hashtable with results from
//a linq query that i need to print out.
foreach (var v in linqQueryResult)
        {
            Debug.WriteLine(v.question);
            newques.simonQuestion = v.question;
            //Debug.WriteLine(v.qtype);
            //newques.simonQType = v.qtype;

            foreach (var s in v.solution)
            {
                Debug.WriteLine(s.Answer);
                newques.simonAnswer.Add(s.Answer);
            }
        }          

        sourceList.Add(qTextInput,newques);

//foreach loop to print out contents of hashtable
foreach (string key in sourceList.Keys)
        {
            foreach(string value in sourceList.Values)
            {
                Debug.WriteLine(key);
                Debug.WriteLine(sourceList.Values.ToString());
            }
        } 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-02T17:45:42.007

当您使用 LINQ 时，您显然不受框架 1.1 的限制，因此您不应该使用`HashTable`and`ArrayList`类。您应该改用严格类型的泛型`Dictionary`和`List`类。

你不需要一个类来保存问题和答案，因为你有`Dictionary`. 该类只是一个没有真正用途的额外容器。

```
//Dictionary declaration
static Dictionary<string, List<string>> sourceList = new Dictionary<string, List<string>>();

//Foreach loop which populates a Dictionary with results from
//a linq query that i need to print out.
foreach (var v in linqQueryResult) {
   List<string> answers = v.solution.Select(s => s.Answer).ToList();
   sourceList.Add(v.question, answers);
}          

//foreach loop to print out contents of Dictionary
foreach (KeyValuePair<string, List<string>> item in sourceList) {
   Debug.WriteLine(item.Key);
   foreach(string answer in item.Value) {
      Debug.WriteLine(answer);
   }
} 
```

如果您出于其他原因需要该课程，则可能如下所示。

（请注意，问题字符串在类中被引用并用作字典中的键，但字典键并未真正用于此代码中的任何内容。）

```
//Class For Storing Question Information
public class QuestionAnswers {

   public string Question { get; private set; }
   public List<string> Answers { get; private set; }

   public QuestionAnswers(string question, IEnumerable<string> answers) {
      Question = question;
      Answers = new List<string>(answers);
   }

}

//Dictionary declaration
static Dictionary<string, QuestionAnswers> sourceList = new Dictionary<string, QuestionAnswers>();

//Foreach loop which populates a Dictionary with results from
//a linq query that i need to print out.
foreach (var v in linqQueryResult) {
   QuestionAnswers qa = new QuestionAnswers(v.question, v.solution.Select(s => s.Answer));
   sourceList.Add(qa.Question, qa);
}          

//foreach loop to print out contents of Dictionary
foreach (QustionAnswers qa in sourceList.Values) {
   Debug.WriteLine(qa.Question);
   foreach(string answer in qa.Answers) {
      Debug.WriteLine(answer);
   }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-02T17:29:48.113

试试这个

```
foreach (DictionaryEntry entry in sourceList)
            {
                Debug.WriteLine(entry.Key);
                foreach (object item in (ArrayList)entry.Value)
                {
                    Debug.WriteLine(item.ToString());
                }

            } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-02T17:30:40.517

小调整

```
foreach (string key in sourceList.Keys)
{
  Console.WriteLine(key);
  foreach(string value in sourceList[key])
  {
    Console.WriteLine("\t{0}", value);  // tab in answers one level
  }
  Console.WriteLine(); // separator between each set of q-n-a
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-02T17:25:31.853

这不应该：

```
Debug.WriteLine(sourceList.Values.ToString()); 
```

是这个吗？

```
foreach(var obj in sourceList.Values)
    Debug.WriteLine(obj); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-02T18:20:56.433

首先，强类型的泛型集合会更容易。让我们首先为强类型集合定义一个别名：

```
using MyHash = System.Collections.Generic.Dictionary<string,
    System.Collections.Generic.List<string>>; 
```

从现在开始，MyHash 的含义与冗长的泛型定义相同。现在您可以像这样声明哈希表成员：

```
static MyHash sourceList = new MyHash(); 
```

并像这样迭代它：

```
foreach (var pair in sourceList)
{
    var question = pair.Value;
    Console.WriteLine(question);
    foreach (var answer in pair.Value)
        Console.WriteLine("    " + answer);
} 
```

希望这是有用的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-08-28T11:33:31.940

foreach（哈希表中的字典条目）{

[在http://www.dotnetperls.com/hashtable](http://www.dotnetperls.com/hashtable)中查找更多信息

# emacs - 如何在启动时在 Windows 上最大化 Emacs？

> ID：815239
> 
> 赞同：44
> 
> 时间：2009-05-02T17:20:31.413
> 
> 标签：emacs, elisp

这让我发疯：我只是想让 Emacs 最大化到我在启动时拥有的任何屏幕分辨率。理想情况下，我喜欢适用于任何屏幕分辨率的跨平台（Windows 和 Linux）解决方案，但我什至无法让它在具有硬编码尺寸的 Window XP 上运行。

这是我尝试过的：

1.  使用适当的高度/宽度设置初始帧列表
2.  设置默认帧列表
3.  （Windows 特定的东西）向 emacs 窗口发送消息，告诉它通过最大化`(w32-send-sys-command 61488)`
4.  尝试了我在某处找到的这个功能：

    ```
    (defun toggle-fullscreen ()
      "toggles whether the currently selected frame consumes the entire display
    or is decorated with a window border"
      (interactive)
      (let ((f (selected-frame)))
        (modify-frame-parameters 
         f
         `((fullscreen . ,(if (eq nil (frame-parameter f 'fullscreen)) 
                              'fullboth
                            nil)))))) 
    ```

5.  在我的 init 文件的开头和结尾都尝试了上述方法，以尝试消除其他 init 事物的干扰。

不幸的是，以上都不起作用！！对于上述某些情况，我可以看到我的 emacs 窗口在一瞬间正确调整大小，然后恢复为较小的默认大小。如果我在初始化后运行上述方法，emacs 窗口会正确调整大小。这里到底发生了什么？

[ps对此还有其他SO问题，但没有一个答案有效]

* * *

***更新：***

答案让我认为我的 init 文件中的其他内容导致了问题。确实如此！经过一番尝试和错误，我找到了罪魁祸首。如果我注释掉以下行，一切正常：

```
(tool-bar-mode -1) 
```

工具栏到底与最大化窗口有什么关系？

所以现在的问题是：如何禁用工具栏（毕竟，emacs 的工具栏很丑，占用宝贵的屏幕空间）并最大化我的 init 文件中的窗口？工具栏干扰窗口大小可能是一个错误？

澄清： (tool-bar-mode -1) 关闭工具栏，但这条线会干扰 Emacs 窗口的最大化。因此，如果我尝试将功能最大化窗口并关闭工具栏，则最大化部分将失败；如果工具栏部分被注释掉，那么最大化部分就可以了。我使用什么解决方案（在我列出的 4 个中）甚至都无关紧要。

* * *

***解决方案：（***或者至少现在对我有用）

这可能是 Emacs 中的一个错误。解决方法是通过注册表禁用工具栏，而不是在 .emacs 中。将以下内容另存为 .reg 文件，并在 Windows 资源管理器中执行该文件：

```
Windows Registry Editor Version 5.00

[HKEY_CURRENT_USER\Software\GNU\Emacs]
"Emacs.Toolbar"="-1" 
```

（此解决方案是 OtherMichael 建议的工作版本）。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-05-04T15:56:21.457

大约一年前我找到[了一个答案](http://www.weitz.de/win/#emacs)，它解释了你必须操纵注册表才能正确地做事：

> 要启动 Emacs 最大化，请将这一行放在 ~/.emacs 文件的末尾：

```
(w32-send-sys-command 61488) 
```

> 如果您不想要 Emacs 工具栏，您可以在 ~/.emacs 文件中添加**(tool-bar-mode -1)** [注意：原始页面上的值为 0] 行，但 Emacs 不会在此完全最大化case - 工具栏占用的不动产丢失。您必须禁用注册表中的工具栏才能将其取回：

```
[HKEY_LOCAL_MACHINE\SOFTWARE\GNU\Emacs\Emacs.Toolbar]
@="0" 
```

如果您查看[W32SendSys 命令代码](http://www.emacswiki.org/emacs/WThirtyTwoSendSysCommand#commandcodes)`61488`下的 EmacsWiki，您会发现*最大化当前帧*

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2011-01-02T07:42:34.920

这是对我有用的最简单的修复：

```
(w32-send-sys-command #xf030)
(add-hook 'window-setup-hook (lambda () (tool-bar-mode -1))) 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2012-02-23T18:24:08.407

大佬，怎么了

`emacs -mm`?

这使 Emacs 完全最大化。把它放在你的快捷方式中，它真的取决于你使用的窗口管理器；我自己只是在我的[.*shrc](https://github.com/xaccrocheur/kituu)中取别名。

在另一个但并非不相关的说明中，我实际上启动 Emacs 的方式是，如果它已经启动，则所选文件只是在我现有的 Emacs 会话中作为新缓冲区打开：

```
if [ "$(pidof emacs)" ] ; then
    emacsclient "$@"
else
    emacs -mm "$@"
fi 
```

我把它放在一个 ~/bin/e 中，然后我只用“e”启动 Emacs。我在文件管理器中右键单击一个文本文件，选择“用另一个程序打开”并输入“e”，现在我只需双击文件，它们都可以在同一个会话中整齐地打开。

一切都是桃子和口齿不清的:)

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-06-22T19:44:33.697

在 X.org 上，系统调用是（因为您最初要求跨平台解决方案）：

> ````
> (defun x11-maximize-frame ()
>   "Maximize the current frame (to full screen)"
>   (interactive)
>   (x-send-client-message nil 0 nil "_NET_WM_STATE" 32 '(2 "_NET_WM_STATE_MAXIMIZED_HORZ" 0))
>   (x-send-client-message nil 0 nil "_NET_WM_STATE" 32 '(2 "_NET_WM_STATE_MAXIMIZED_VERT" 0)))
> 
> ````

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2015-10-05T21:29:06.577

这在以下情况下可靠地工作`Emacs 24.5.1 (i686-pc-mingw32)`：

```
(add-to-list 'initial-frame-alist '(fullscreen . maximized)) 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-11-25T00:33:14.477

首先，感谢关于 (tool-bar-mode -1) 的错误提示；省了我很多麻烦！我宁愿将所有内容都保留在 .emacs 文件中（我没有注册表模块），因此如果您在最大化之前打开工具栏，然后再次将其关闭，您将可以很好地最大化：

```
(defun maximize-current-frame () "Resizes the current frame to fill the screen"
    (interactive)
    ;; There is a bug in tool-bar-mode that prevents it from being
    ;; maximized, so turn it on before maximizing.
    ;; See http://stackoverflow.com/questions/815239/how-to-maximize-emacs-on-windows-at-startup)
    (tool-bar-mode 1)
    (w32-send-sys-command 61488)
    (tool-bar-mode -1)
) 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-09-14T13:44:04.267

解决此类问题的另一种方法是在

```
(menu-bar-mode -1)
(tool-bar-mode -1)
(tooltip-mode -1)
(scroll-bar-mode 1) 
```

和 set-frame-* 函数。例如：

```
 (tool-bar-mode -1)
 (when window-system
  (run-at-time (format "%d sec" 1) nil '(lambda () (set-frame-position (selected-frame) 1 1)))
  (run-at-time (format "%d sec" 2) nil '(lambda () (set-frame-width (selected-frame) 150 t)))
  (run-at-time (format "%d sec" 3) nil '(lambda () (set-frame-height (selected-frame) 60 t)))
  ) 
```

也必须在 set-frame-* 函数之间设置延迟！

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2015-09-10T03:22:21.307

我遇到了一个似乎有效的命令`(toggle-frame-maximized)`，它适用于 Linux 和 Windows。

我只是在设置完所有内容后将它放在我的初始化文件的末尾附近，并假设在设置结束时所有内容*都不会*最大化，瞧，它可以工作。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-02T19:48:16.143

嘿 - 不错的功能！感谢发帖

我认为它可能对您不起作用，因为您的 init 文件中其他地方的代码如下所示。在创建框架后应用默认框架列表。我删除了 size 和 position 元素，你的功能在 emacs 启动时效果很好。

```
 (setq default-frame-alist
     (list
      (cons 'left                 350)
      (cons 'top                  0)
      (cons 'width                80)
      (cons 'height               45)
     ...... 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2011-05-10T14:25:35.347

如果您真的想在没有窗口镶边（标题栏和最大/最小/关闭按钮）的情况下全屏运行 Emacs，请尝试以下模式。这对我在 XP SP3 上的 Emacs 23.3.1 有效。

[http://www.martyn.se/code/emacs/darkroom-mode/](http://www.martyn.se/code/emacs/darkroom-mode/)

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2011-05-12T02:08:34.890

每个人。emacs 23.3.1，blow 代码无效。因为 (menu-bar-mode -1) 也会导致窗口不全屏。

```
(w32-send-sys-command #xf030)
(add-hook 'window-setup-hook (lambda () (tool-bar-mode -1))) 
```

我搜索 Eamcs wiki，找到一个可用的方法。

[http://www.emacswiki.org/emacs/FullScreen#toc3](http://www.emacswiki.org/emacs/FullScreen#toc3)

微软视窗

如果您使用的是 MS Windows，并且想使用“真正的全屏”，即摆脱顶部标题栏和所有内容，请参阅网站上的 w32-fullscreen 了解暗室模式

或者，此处提供了一个补丁，使全屏帧参数在 Windows 上真正全屏。

要获得最大化的窗口，您可以使用：（w32-send-sys-command #xf030）

注意力！如果您希望 emacs 开始最大化，您必须将此代码放入您的 .emacs 文件中：

```
(defun jbr-init ()
  "Called from term-setup-hook after the default
terminal setup is
done or directly from startup if term-setup-hook not
used.  The value
0xF030 is the command for maximizing a window."
  (interactive)
  (w32-send-sys-command #xf030)
  (ecb-redraw-layout)
  (calendar)
)
(setq term-setup-hook 'jbr-init)
(setq window-setup-hook 'jbr-init) 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-05-02T19:48:47.563

```
(defun resize-frame ()
"Set size"
(interactive)
(set-frame-width (selected-frame) 110)
(set-frame-height (selected-frame) 33)
(set-frame-position (selected-frame) 0 1)) 
```

以下是我的 .emacs 文件中调用的最后一个函数，它设置屏幕的高度和宽度，它在 debian 和 mac os x 上的 emacs 22 和 emacs 23 上都有效。根据您的屏幕设置高度和宽度数字。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-05-04T14:40:36.680

要禁用工具栏，请添加行

```
(tool-bar-mode nil) 
```

到您的自定义文件（通常是根目录中的 .emacs）。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2011-10-19T09:22:09.910

[emacs-full-screen-win32](https://bitbucket.org/alexander_manenko/emacs-fullscreen-win32/wiki/Home)项目将为您提供帮助:)

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2013-06-20T09:06:03.713

[来自emacswiki](http://www.emacswiki.org/emacs/FullScreen#toc10)的以下片段对我来说效果很好：（添加到您的启动配置文件中）

```
(defun jbr-init ()
"Called from term-setup-hook after the default
terminal setup is
done or directly from startup if term-setup-hook not
used.  The value
0xF030 is the command for maximizing a window."
  (interactive)
  (w32-send-sys-command #xf030)
  (ecb-redraw-layout)
  (calendar)
  )
(setq term-setup-hook 'jbr-init)
(setq window-setup-hook 'jbr-init) 
```

# java - 在这种情况下，Terracotta 是如何工作的？

> ID：815243
> 
> 赞同：9
> 
> 时间：2009-05-02T17:24:56.927
> 
> 标签：java, failover, high-availability, terracotta

所以假设我有一个**N**大小的服务器阵列，如下所示：

[替代文字 http://www.terracotta.org/web/download/attachments/43909161/ServerArrayMirrorGroup.png](http://www.terracotta.org/web/download/attachments/43909161/ServerArrayMirrorGroup.png)

我有一个简单的 JavaBean/POJO：

```
package example;

public class Person {
  private OtherObject obj;

  public void setObj(OtherObject theObj) {
    synchronized (this) {
      obj = theObj;
    }
  }

  public OtherObject getObj() {
    synchronized (this) {
      return obj;
    }
  }
} 
```

现在，如果其中一个客户端在 TC 根（数据结构）中的 Person 对象上调用 Person.setObj(OtherObject)，则该客户端上的**同步块**（在 Person.setObj(OtherObject) 中）持有：

1) 直到**N**大小的服务器阵列中的所有**N**个服务器都已与该 Person.obj 属性同步/更新？

 ****或者**

2) 直到“活动”服务器与更新的 Person.obj 属性同步？那么阵列中的其他（**N-1**）台服务器是否尽可能同步？

**或者**

3）我正在寻找其他一些方法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-04T14:24:55.907

答案不是真正的 1 或 2。对象是跨服务器镜像组条带化的。第一次设置此字段时，会创建一个事务，为第一个事务选择的镜像组将在此之后“拥有”该对象。

对于 1 和 2，并非所有活动服务器组都需要更新，因此无需等待其中任何一个条件。

您可以在 Terracotta 文档中找到有关配置 Terracotta 服务器阵列的更多信息：

*   [http://terracotta.org/web/display/docs/Terracotta+Server+Arrays](http://terracotta.org/web/display/docs/Terracotta+Server+Arrays)

从锁定的角度来看，在执行对象修改时，将持有此 Person 对象上的集群锁（跨集群互斥）。同步块的范围形成了上面提到的事务。在 getObj() 方法中，您可以将其配置为读取锁，这将允许跨集群的多个并发读取器。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-03T22:52:19.220

假设其他人都引用了您的对象，并且可以在您这样做时/之前/之后触摸它。因此解决方案是添加锁，并且

*   获得锁
*   修改对象
*   释放锁

这正是*synchronized*所做的......它创建了一个队列，并且*同步方法*不能被多次调用......但是如果在某处引用了底层对象，它可能会被触及。

看：

*   [http://www.terracotta.org/web/display/orgsite/Hello+Clustered+World](http://www.terracotta.org/web/display/orgsite/Hello+Clustered+World)
*   [http://www.terracotta.org/web/display/orgsite/Tutorials](http://www.terracotta.org/web/display/orgsite/Tutorials)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-03T00:31:27.087

我不熟悉他们的（Terracotta）实现，但从 JMM 的角度来看，它*应该*采用集群范围的锁。然而，这个例子非常简单；只是一个引用的改变，这可能会导致它被转换成更像是一个 volatile write 的东西，并且完全避免了锁定。

但是，如果您在同步块中做一些重要的事情，那么我会假设 TC 在同步块开始时悲观地采用集群范围的锁。如果他们不这样做，他们将与 JMM 规范不一致。据我了解。

换句话说，您的选项#1。因此，请注意您在集群中共享的内容，并尽可能使用不可变对象和 java.util.concurrent.* 数据结构 - 后者在 TC 中得到了特别的内在喜爱。

# jquery - 如何克隆 StackOverFlow JQuery 接口？

> ID：815253
> 
> 赞同：1
> 
> 时间：2009-05-02T17:29:37.740
> 
> 标签：jquery, ajax, user-interface, interface

有没有类似 StackOverFlow 的网站的 JQuery 用法的开源示例......

在这个方向上有什么帮助吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-02T17:32:32.477

网络上到处都是。对于初学者，我建议通读[文档](http://docs.jquery.com/Main_Page)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-02T20:03:07.340

您可以使用[插件](http://plugins.jquery.com/)制作相同的效果。

*   [http://www.jqueryplugins.com/](http://www.jqueryplugins.com/)

*   [http://www.sastgroup.com/jquery/240-plugins-jquery](http://www.sastgroup.com/jquery/240-plugins-jquery)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-02T20:43:17.777

如果每个人都只是列出正在使用的插件列表，这可能会有所帮助。例如，对于绘图，他们使用：[flot](http://code.google.com/p/flot/)。对于 IE 上的 flot 支持，您需要[excanvas](http://excanvas.sourceforge.net/) ......我觉得这个问题之前已经得到了回答......

# multithreading - 在 wx python 应用程序中使用线程和 pyGST

> ID：815255
> 
> 赞同：0
> 
> 时间：2009-05-02T17:29:51.000
> 
> 标签：multithreading, wxpython

好的，所以我正在编写一个应用程序，它使用 pyGST 绑定播放音乐。

这需要使用线程来处理播放。绑定库为我处理了大部分线程控制，这很好（以及我在其中寻找的内容）。

现在，我对这个概念没有完全掌握，所以我渴望一些参考。但我理解它的方式是，我必须基本上通知应用程序它可以使用多个线程。

[我从 gstreamer 网站上的示例](http://pygstdocs.berlios.de/pygst-tutorial/playbin.html)中收集了这些信息，他们使用了这个调用：

```
gtk.gdk.threads_init()  
gtk.main() 
```

根据[这里](http://www.moeraki.com/pygtktutorial/pygtk2reference/gdk-functions.html#function-gdk--threads-init)，这告诉应用程序它可以使用多个线程（或多或少），这就是我上述假设的来源。

这就是背景。现在得到这个。我已将这些行放在我的代码中，它们工作正常。我的应用程序播放音乐而不是在尝试时崩溃。但是感觉有些不对劲。
在我得到这些行的示例中，他们对整个 GUI 使用 gtk，但我想使用 wxWidgets，所以调用这个 gtk 函数来执行此操作感觉不对。

**有与此等效的 wx 吗？**还是可以使用它，它仍然可以跨平台工作吗？

另外，我必须弄清楚如何在退出时杀死所有这些线程（它现在不这样做）我在示例中再次使用 gtk 方法看到它们是如何做到的，所以再次寻找 wx 等价物。

PS：我认为这个（或解决方案）可能与 wx.App.MainLoop() 函数有关，但我在试图理解这个循环是如何工作的时候迷失了方向，所以再次感谢关于这个的良好参考，但我假设没有必要，只要我有一个好的解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-10T10:57:20.930

尝试改用这个：

```
import gobject
gobject.threads_init() 
```

我想知道为什么它不是在每个 python gstreamer 插件文档的开头都用大字体写的：我只花了几个小时就找到了它。

[这里](http://www.jejik.com/articles/2007/01/python-gstreamer_threading_and_the_main_loop/)有更多细节。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-04T09:07:45.887

我没有使用 pyGST 的经验，但使用线程和 wxPython 的一般建议是只从主线程（即启动 MainLoop 的线程）更新 GUI。有关详细信息，请参阅[http://wiki.wxpython.org/LongRunningTasks](http://wiki.wxpython.org/LongRunningTasks)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-05T02:06:49.417

我没有使用 python 绑定的经验，但我在 Windows 上成功使用了 wxWidgets 和 GStreamer。问题是 wxWidgets 运行 Windows 事件循环，而 GStreamer 使用 GLib 事件循环。如果您不关心任何 GStreamer 事件，则无需执行任何操作。但是，如果您希望接收任何 GStreamer 事件，则必须在具有单独 GMainContext 的单独线程中运行您自己的 GLib 事件循环 (GMainLoop)。使用 gst_bus_create_watch 创建 GST 事件源，使用 g_source_set_callback 添加回调到源，然后使用 g_source_attach 将其附加到 GLib 事件循环的主上下文。然后，您可以在回调中处理 GST，例如，将事件转发到 wx 主事件循环。

# javascript - 如何使用 jquery 解码返回的 json 对象？

> ID：815261
> 
> 赞同：1
> 
> 时间：2009-05-02T17:31:46.347
> 
> 标签：javascript, json, jquery-plugins

我尝试使用 jQuery 的上传插件。 [http://valums.com/ajax-upload/](http://valums.com/ajax-upload/)

当我将返回响应类型设置为 json 时，firefox 会弹出一个对话框，询问我喜欢如何处理返回的 json 对象。

人们在上传脚本的作者页面上提出了同样的问题，但到目前为止还没有答案。希望这里的 javascript 人员可以弄清楚我们如何处理这个问题。

谢谢。

```
<script type= "text/javascript">
      /*<![CDATA[*/
        $(document).ready(function(){

            /* example 1 */
            var button = $('#button1'), interval;
            new AjaxUpload(button, {
                //action: 'upload-test.php', // I disabled uploads in this example for security reasons
                action: '/posts/upload_images/', 
                name: 'myfile',
                responseType: 'json',
                onSubmit : function(file, ext){
                    // change button text, when user selects file           
                    button.text('Uploading');

                    // If you want to allow uploading only 1 file at time,
                    // you can disable upload button
                    this.disable();

                    // Uploding -> Uploading. -> Uploading...
                    interval = window.setInterval(function(){
                        var text = button.text();
                        if (text.length < 13){
                            button.text(text + '.');                    
                        } else {
                            button.text('Uploading');               
                        }
                    }, 200);
                },
                onComplete: function(file, response){
                    var json = response;
                    alert(json);
                    button.text('Upload');

                    window.clearInterval(interval);

                    // enable upload button
                    this.enable();

                    // add file to the list
//                    $('<li></li>').appendTo('#example1 .files').text(json.response_text);                     
                    $('<li></li>').appendTo('#example1 .files').text(file);                     
                }
            });
        });
    /*]]>*/
</script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-11-10T06:11:15.923

[http://api.jquery.com/jQuery.parseJSON/](http://api.jquery.com/jQuery.parseJSON/)

```
var obj = jQuery.parseJSON('{"name":"John"}');
alert( obj.name === "John" ); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-02T17:36:28.940

这个 jQuery 插件使与 JSON 之间的转换变得简单：[http ://code.google.com/p/jquery-json/](http://code.google.com/p/jquery-json/)

此外，您可能对您引用的博客文章中的[此评论感兴趣：](http://valums.com/ajax-upload/#comment-769)

> 很抱歉向您的博客文章发送垃圾邮件（这很棒），但我想我会提到我发现了问题：
> 
> 无论出于何种原因，`<pre>`当响应类型为 时，响应总是在整个响应周围有标签`plain/text`。这导致`eval()`调用失败。我目前的解决方案是在通话之前去掉这些标签`eval()`，现在一切正常。不是一个很好的解决方案，但至少我现在可以继续工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-02T17:39:40.913

可能是这样，我不知道，因为我对那个插件一无所知，但是您可能需要查看您在服务器端设置的响应类型；您应该将 HTTP 响应设置为具有“text/plain”、“text/javascript”或“application/javascript”之类的内容/MIME 类型 - 看看这是否能解决您的问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-26T23:50:41.013

I was looking for a solution for the same script and stumbled upon this page. I didn't found a solution online so here's how I fixed it:

@ `upload-file.php`: replace

```
echo "success".$cc; 
```

with

```
echo json_encode(array(
status' => 'success',
'id' => $picid,
'image' => $imgurl
)); 
```

@ `front end`: replace

```
var bb=response.substr(0,7)
var idd=response.replace('success',' ');
var idb =idd.replace(/^\s*|\s*$/g,'');
if(bb==="success")
{
    $('<span></span>').appendTo('#files').html('<img src="images/'+file+'" alt="" width="120" height="120" style="margin:5px;" />').addClass('success');
}
else
{
    $('<span></span>').appendTo('#files').text(file).addClass('error');
} 
```

with

```
var what = jQuery.parseJSON(response);
if(what.status == 'success')
{
    $('<span id='+what.id+'></span>').appendTo('#files').html('<img src="'+what.image+'" alt="" width="120" height="120" style="margin:5px;" /><br><a href="javascript:void(0)" onClick="deleteFile('+what.id+');">Delete</a>').addClass('success');
}
else 
{
    $('<span></span>').appendTo('#files').text(response).addClass('error');
} 
```

And to actually answer this question.

`jQuery.parseJSON(response);`

does..

# javascript - IFRAME onload 事件究竟何时触发？

> ID：815263
> 
> 赞同：22
> 
> 时间：2009-05-02T17:32:15.287
> 
> 标签：javascript, html, iframe, onload

IFRAME 的 onload 事件是在 HTML 完全下载时触发​​，还是仅在所有相关元素也加载时触发？(css/js/img)

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-05-02T17:35:16.993

后者：`<body onload=`仅在所有相关元素（css/js/img）也已加载时触发。

如果要在加载 HTML 时运行 JavaScript 代码，请在 HTML 末尾执行以下操作：

```
<script>alert('HTML loaded.')</script></body></html> 
```

这是有关*加载*和*就绪*之间区别的[相关电子邮件线程](http://groups.google.com/group/mochikit/browse_thread/thread/ecd1ff24a780ae2f/1dc3eafb37b1e7b7?pli=1)（jQuery 支持两者）。

 *** * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-12T10:36:57.670

上面的答案（使用 onload 事件）是正确的，但是在某些情况下这似乎行为不端。尤其是在为 Web 内容动态生成打印模板时。

我尝试通过创建动态 iframe 并打印它来打印页面的某些内容。如果它包含图像，我无法在加载图像时触发它。当图像仍在加载导致打印不完整时，它总是过早触发：

```
function printElement(jqElement){
    if (!$("#printframe").length){
        $("body").append('<iframe id="printframe" name="printframe" style="height: 0px; width: 0px; position: absolute" />');
    }

    var printframe = $("#printframe")[0].contentWindow;
    printframe.document.open();
    printframe.document.write('<html><head></head><body onload="window.focus(); window.print()">');
    printframe.document.write(jqElement[0].innerHTML);
    printframe.document.write('</body></html>');
//  printframe.document.body.onload = function(){
//      printframe.focus();
//      printframe.print();
//  };
    printframe.document.close();
//  printframe.focus();
//  printframe.print();

//  printframe.document.body.onload = function()...
} 
```

正如你所看到的，我尝试了几种方法来绑定 onload 处理程序......无论如何它都会过早触发。我知道这是因为浏览器打印预览（谷歌浏览器）包含损坏的图像。当我取消打印并再次调用该函数（图像现在被缓存）时，打印预览很好。

...幸运的是我找到了解决方案。不漂亮但合适。它的作用是扫描子树中的“img”标签并检查这些标签的“完整”状态。如果未完成，则会在 250 毫秒后延迟重新检查。

```
function delayUntilImgComplete(element, func){
    var images = element.find('img');
    var complete = true;
    $.each(images, function(index, image){
        if (!image.complete) complete = false;
    });
    if (complete) func();
    else setTimeout(function(){
        delayUntilImgComplete(element, func);}
    , 250);
}    

function printElement(jqElement){
    delayUntilImgComplete(jqElement, function(){
        if (!$("#printframe").length){
            $("body").append('<iframe id="printframe" name="printframe" style="height: 0px; width: 0px; position: absolute" />');
        }

        var printframe = $("#printframe")[0].contentWindow;
        printframe.document.open();
        printframe.document.write(jqElement[0].innerHTML);
        printframe.document.close();
        printframe.focus();
        printframe.print();
    });
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-02T17:37:01.263

就在 html 加载时，而不是依赖元素。（或者我认为）。

要在页面的其余部分加载时触发 jQuery(window).load(function(){ 或 window.onload not document onready。

您还可以检查是否加载了图像元素，并且存在...如果图像。负载——等等。

# javascript - 日语/汉字的编程技巧

> ID：815292
> 
> 赞同：7
> 
> 时间：2009-05-02T18:00:20.240
> 
> 标签：javascript, language-agnostic, unicode, nlp, cjk

我有一个想法，可以编写一些网络应用程序来帮助我和其他人更好地学习日语，因为我正在学习日语。

我的问题是该网站主要是英文的，所以它需要混合流利的日文字符，通常是平假名和片假名，但后来是汉字。我越来越接近实现这一目标；我发现页面和源文件需要是 unicode 和 utf-8 内容类型。

但是，我的问题出在实际编码中。我需要的是操作假名的文本字符串。一个例子是：

けす 我需要把那个动词转换成 te 形式的 けして。我更喜欢在 javascript 中执行此操作，因为这将有助于进行更多操作，但如果我必须进行 DB 调用并将所有内容保存在 DB 中。

我的问题不仅是如何用 javascript 来做，还有用其他语言做这些事情的一些技巧和策略。我希望更多地参与语言学习应用程序，但在这方面我迷失了。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-05-03T17:05:41.660

*   到处都坚持使用 Unicode 和 utf-8。
*   远离原生的日语编码：euc-jp、shiftjis、iso-2022-jp，但请注意，如果继续，您可能会在某个时候遇到它们。
*   熟悉用于进行 POS 分析、分词等复杂工作的分词器。大多数在日语上进行 NLP（自然语言处理）工作的人使用的标准工具是按受欢迎程度/功能排序的。

[**MeCab**](http://taku910.github.io/mecab/)（最初在[SourceForge 上](http://mecab.sourceforge.net/)）很棒：它允许您获取文本，例如，

```
「日本语は、とても难しいです。」</pre>

并获得各种重要信息

```
kettle:~$ echo 日本語は、難しいです | mecab 
日本語 名詞,一般,*,*,*,*,日本語,ニホンゴ,ニホンゴ
は   助詞,係助詞,*,*,*,*,は,ハ,ワ
、   記号,読点,*,*,*,*,、,、,、
難しい 形容詞,自立,*,*,形容詞・イ段,基本形,難しい,ムズカシイ,ムズカシイ
です  助動詞,*,*,*,特殊・デス,基本形,です,デス,デス
EOS
```

这基本上是对词性，阅读，发音等的详细介绍。它还有助于分析动词时态，

```
kettle:~$ echo メキシコ料理が食べたい | mecab 
メキシコ    名詞,固有名詞,地域,国,*,*,メキシコ,メキシコ,メキシコ
料理  名詞,サ変接続,*,*,*,*,料理,リョウリ,リョーリ
が   助詞,格助詞,一般,*,*,*,が,ガ,ガ
食べ  動詞,自立,*,*,一段,連用形,食べる,タベ,タベ
たい  助動詞,*,*,*,特殊・タイ,基本形,たい,タイ,タイ
EOS
```

但是，文档都是日文的，设置和弄清楚如何按照您想要的方式格式化输出有点复杂。有可用于 ubuntu/debian 的软件包，以及多种语言的绑定，包括 perl、python、ruby...

适用于 ubuntu 的 Apt-repos：

```
deb http://cl.naist.jp/~eric-n/ubuntu-nlp intrepid all
deb-src http://cl.naist.jp/~eric-n/ubuntu-nlp intrepid all
```

要安装的软件包：
`$ apt-get install mecab-ipadic-utf8 mecab python-mecab`

应该做我认为的伎俩。

mecab 的其他替代品是[ChaSen](http://chasen.naist.jp/hiki/ChaSen/)，它是几年前由 MeCab 的作者（他现在偶然在谷歌工作）和[Kakasi](http://kakasi.namazu.org/)的作者，它的功能要小得多。

我肯定会尽量避免滚动你自己的共轭程序。这样做的问题在于，它需要大量的工作，而其他人已经完成了这些工作，并且在一天结束时用规则覆盖所有边缘情况是不可能的。  

MeCab 是统计驱动的，并根据大量数据进行训练。它采用了一种称为*条件随机场*(CRF) 的复杂机器学习技术，结果非常好。

和日本人一起玩。我不确定您的日语有多好，但是如果您需要有关 mecab 文档的帮助或其他任何问题，也可以随时询问。汉字一开始可能会很吓人。

```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-03T17:58:45.713

> 我的问题不仅是如何在 javascript 中做到这一点，还有在其他语言中做这些事情的一些技巧和策略。

您想要做的是非常基本的字符串操作 - 除了缺少的单词分隔符，正如 Barry 指出的那样，尽管这不是技术问题。

基本上，对于现代的 Unicode 感知编程语言（我相信 JavaScript 自 1.3 版以来一直是这样），日文假名或汉字与拉丁字母之间没有真正的区别——它们都只是字符。一个字符串就是一个字符串。

当您必须在字符串和字节之间进行转换时，变得困难的地方，因为您需要注意您使用的编码。不幸的是，许多程序员，尤其是以英语为母语的程序员倾向于掩盖这个问题，因为 ASCII 是拉丁字母的事实上的标准编码，而其他编码通常试图兼容。如果您只需要拉丁字母，那么您可以幸福地对字符编码一无所知，相信字节和字符基本上是同一件事 - 并编写程序来破坏任何不是 ASCII 的东西。

所以 Unicode 感知编程的“秘密”是这样的：学会识别字符串/字符何时何地转换为字节和从字节转换，并确保在所有这些地方使用正确的编码，即将使用相同的编码用于反向转换，并且可以对您正在使用的所有字符进行编码。UTF-8 正在慢慢成为事实上的标准，通常应该在您有选择的任何地方使用。

典型示例（非详尽）：

*   使用非 ASCII 字符串文字编写源代码时（在编辑器/IDE 中配置编码）
*   编译或解释此类源代码时（编译器/解释器需要知道编码）
*   读取/写入字符串到文件时（编码必须在 API 中的某处或文件的元数据中指定）
*   将字符串写入数据库时​​（必须在数据库或表的配置中指定编码）
*   通过网络服务器交付 HTML 页面时（必须在 HTML 标头或页面的元标头中指定编码；表单可能更加棘手）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-04T04:55:00.173

您需要做的是查看语法规则。对每个共轭都有一系列规则。让我们以〜て形式为例。伪代码：

```
def te_form(verb)
  switch verb.substr(-1, 1) == "る" then return # verb minus ru plus te
  case "る" #return (verb - る) + て
  case "す" #return (verb - す）＋して 
```

等等。基本上，将其分解为 I、II 和 III 类动词。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-02T20:00:30.343

你的问题对我来说完全不清楚。

但是，我有一些使用日语的经验，所以我会给我 2 美分。

由于日语文本没有分词（例如空格字符），因此我们必须获得的最重要工具是基于字典的单词识别器。

一旦你得到文本分割，使用“普通”工具更容易操作它。

只有 2 个工具可以完成上述操作，并且作为副产品，它们还可以用作标记器（即名词、动词等）。

编辑：在使用 w 语言时始终使用 unicode。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-02T18:39:06.530

如果我没记错的话（我在学日语的那一年偷懒了很多，所以我可能是错的），你想要做的替换是由单词中的最后一个或两个符号决定的。以您的第一个示例为例，以“す”结尾的任何动词在以这种方式共轭时将始终具有“して”。む -> んで 也是如此。您能否建立最后一个字符的映射 -> 共轭形式。您可能必须考虑例外情况，例如与 xxって 共轭的任何内容。

至于语言之间的可移植性，您必须根据它们的工作方式以不同的方式实现逻辑。这个解决方案对于西班牙语也很容易实现，因为变位取决于动词是否以 -ar、-er 或 -ir 结尾（有些动词需要逻辑中的例外）。不幸的是，这是我的多语言技能的限制，所以我不知道超出这两个技能会做得如何。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-07T05:14:34.067

由于日语中的大多数动词都遵循一小组可预测的模式，因此生成给定动词的所有形式的最简单和最可扩展的方法是让动词知道它应该遵循什么变位，然后编写函数来生成每种形式取决于关于共轭。

伪代码：

```
generateDictionaryForm(verb)
  case Ru-Verb: verb.stem + る
  case Su-Verb: verb.stem + す
  case Ku-Verb: verb.stem + く
  ...etc.

generatePoliteForm(verb)
  case Ru-Verb: verb.stem + ります
  case Su-Verb: verb.stem + します
  case Ku-Verb: verb.stem + きます
  ...etc. 
```

不规则动词当然是特例。

这种情况的一些变体适用于任何其他相当常规的语言（即不是英语）。

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2016-01-28T00:17:53.027

尝试安装我的 gem (rom2jap)。它在红宝石中。

```
gem install rom2jap 
```

打开你的终端并输入：

```
require 'rom2jap' 
```

# security - 终极哈希保护 - 概念讨论

> ID：815297
> 
> 赞同：-2
> 
> 时间：2009-05-02T18:04:43.537
> 
> 标签：security, hash, rainbowtable

好的，所以哈希的整个问题是用户输入的密码长度不能超过 15 个字符。大多数只使用 4-8 个字符，使攻击者很容易用彩虹表破解它们。

解决方案，使用用户 salt 使哈希输入更复杂，超过 50 个字符，这样他们就永远无法生成表（对于这种大小的字符串来说太大了）。另外，他们必须为每个用户创建一个新表。问题：如果他们下载数据库，他们将获得用户盐，所以如果他们足够关心，你就会回到第一方。

解决方案，使用站点“pepper”加上用户盐，那么即使他们获得了数据库，他们仍然必须知道配置文件。问题：如果他们可以进入您的数据库，他们也可能会进入您的文件系统并发现您的站点。

因此，在所有这些已知的情况下 - 让我们假设攻击者进入您的网站并获得一切，一切。那你现在怎么办？

在讨论的这一点上，大多数人的回答是“谁在乎这一点？”。但这只是一种廉价的说法，“我不知道下一步该做什么，所以它不可能那么重要”。可悲的是，我在其他任何地方都问过这个问题，这就是答案。这表明大多数程序员错过了一个非常重要的点。

让我们想象您的网站与其他 95% 的网站一样，并且用户数据——甚至是完全服务器访问权限——不值得蹲下。攻击者碰巧在追捕您的一位用户“Bob”，因为他知道“Bob”在您的网站上使用的密码与他在银行网站上使用的密码相同。他也碰巧知道鲍勃在那里有他毕生的积蓄。现在，如果攻击者可以破解我们网站的哈希值，那么剩下的就是小菜一碟了。

所以这是我的问题——如何在没有任何可追踪路径的情况下延长密码的长度？或者您如何使散列过程变得复杂以便及时复制？我想出的唯一一件事是您可以重新散列哈希数千次，并将创建最终彩虹表所需的时间增加 1,000 倍。这是因为攻击者在创建表时必须遵循相同的路径。

还有其他想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-02T18:55:07.007

> 解决方案，使用用户 salt 使哈希输入更复杂，超过 50 个字符，这样他们就永远无法生成表（对于这种大小的字符串来说太大了）。另外，他们必须为每个用户创建一个新表。问题：如果他们下载数据库，他们将获得用户盐，所以如果他们足够关心，你就会回到第一方。

这种推理是错误的。

彩虹表（这是通用字典攻击的具体实现）以空间换时间。但是，生成字典（彩虹或其他）需要很多时间。只有当它可以用于多个哈希时才值得。盐可以防止这种情况。盐不需要是秘密的，它只需要对于给定的密码是不可预测的。这使得攻击者为该特定盐生成字典的机会小到可以忽略不计。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-02T18:38:00.790

> “我想出的唯一一件事是，你可以重新散列数千次哈希，并将创建最终彩虹表所需的时间增加 1000 倍。”

这不正是基于 Blowfish 的[BCrypt](http://www.openwall.com/crypt/)哈希的意义所在吗？增加计算哈希所需的时间，以便暴力破解（和彩虹表创建）变得不可撤销？

> “我们提出了两种*成本可调的*算法（...）”

有关自适应成本哈希算法的更多信息：[http ://www.usenix.org/events/usenix99/provos.html](http://www.usenix.org/events/usenix99/provos.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-02T18:42:43.867

如何采用“胡椒”的想法并在专门用于散列密码的单独服务器上实现它 - 并锁定，除了这个简单且尽可能安全的服务 - 甚至可能设置速率限制以防止滥用。为攻击者提供了另一个需要克服的障碍，要么获得对该服务器的访问权限，要么对胡椒、自定义 RNG 和明文扩展算法进行逆向工程。

当然，如果他们可以访问所有内容，他们可以在一段时间内偷听用户活动......

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-02T18:51:45.577

嗯...好吧，我对此的看法：

*   您无法从哈希中取回原始密码。我有你的哈希值，我可能会找到一个适合该哈希值的密码，但我无法登录使用此密码的任何其他站点，假设它们都使用盐。这里没有真正的问题。
*   如果有人让您的数据库甚至您的网站来获取您的配置，那么无论如何您都搞砸了。
*   对于管理员或其他超级帐户，实施第二种验证方式，即将登录限制在某些 IP 范围内，使用客户端 SSL 证书等。
*   对于普通用户，您将没有太多机会。您使用他们的密码所做的一切都需要存储在某个配置或数据库中，所以如果有您的网站，我也有您的魔法蛇油。
*   强密码限制并不总是有效。一些网站要求密码包含数字字符 - 因此，大多数用户在他们常用的密码上加 1。

所以我不完全确定你想在这里实现什么？在用户密码前面添加一个 Salt 并使用第二种身份验证方式保护管理员帐户似乎是最好的方法，因为用户根本不会选择正确的密码并且也不能被迫选择。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-06-18T22:56:52.270

我希望有人可能有解决方案，但遗憾的是，当我第一次发布问题时，我的情况并没有好转。似乎没有什么可以做的，只能找到一个耗时的算法或重新散列 1000 次以减慢生成彩虹表（或暴力破解）散列的整个过程。

# java - 如何知道 .jar 文件中的哪些类被引用？

> ID：815300
> 
> 赞同：3
> 
> 时间：2009-05-02T18:06:05.033
> 
> 标签：java, class

我只需要在非常有限的环境中将引用的类部署为交互式电视[的数据轮播。](http://en.wikipedia.org/wiki/Data_and_object_carousel)带宽昂贵且不支持 .jar 文件。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-02T18:12:51.803

查看[ProGuard](http://proguard.sourceforge.net/)，它是一个混淆器，将列出未使用的代码和类。混淆本身通常会导致更小的足迹。

> ProGuard 是一个免费的 Java 类文件收缩器、优化器、混淆器和预验证器。它检测并删除未使用的类、字段、方法和属性。它优化字节码并删除未使用的指令。它使用简短的无意义名称重命名剩余的类、字段和方法。最后，它会为 Java 6 或 Java Micro Edition 预先验证处理后的代码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-02T18:12:26.810

听起来你需要一个依赖分析器。[这个](http://www.dependency-analyzer.org/)可能会奏效。

[ProGuard](http://proguard.sourceforge.net/)可能会更好，因为它还可以缩小现有的 .class 文件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-02T21:12:41.450

也许您可以加载一个支持 jar 文件或理想情况下 pack200 文件的自定义类加载器。

# .net - 如何在不使用树视图的情况下将 XmlNodes 放入 TreeNode？

> ID：815304
> 
> 赞同：-1
> 
> 时间：2009-05-02T18:09:28.237
> 
> 标签：.net, winforms, treenode, xmlnode

我已经有一个带有 TreeNode 类的项目，它创建了像树视图这样的节点层次结构。现在我想向该树节点添加一个 XML 节点。

以一种简单的方式，我可以通过使用 Windows 窗体 Treeview 小部件来做到这一点，但我不想使用它。

有没有其他方法可以将节点添加到树节点？

谢谢..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-02T18:25:57.573

您的问题不是很清楚，您是说您使用的是没有 TreeView 的 Windows.Forms.TreeNode 吗？

如果是这样，TreeNode 像所有控件一样，有一个 Tag 属性，您可以使用它来存储任何数据。 Tag 是 System.Object 类型，因此您在读回它时必须进行类型转换。

添加：

在[这个问题](https://stackoverflow.com/questions/602495/how-to-display-treenodes-by-binding-nodes-in-the-treeview-to-nodes-of-the-xml-doc)中，也由你。我说不出区别。如果您在这里有一个特定的新问题，则不清楚。

# python - 如何指定无法访问的python代码

> ID：815310
> 
> 赞同：16
> 
> 时间：2009-05-02T18:16:06.787
> 
> 标签：python

在python中指定无法访问的代码的pythonic方法是什么：

```
gender = readFromDB(...) # either 'm' or 'f'
if gender == 'm':
    greeting = 'Mr.'
elif gender == 'f':
    greeting = 'Ms.'
else:
    # What should this line say? 
```

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-05-02T18:22:36.037

```
raise ValueError('invalid gender %r' % gender) 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-02T18:24:22.430

你可以提出一个例外：

```
raise ValueError("Unexpected gender; expected 'm' or 'f', got %s" % gender) 
```

如果您希望数据库仅返回“m”或“f”，则使用断言 False：

```
assert False, "Unexpected gender; expected 'm' or 'f', got %s" % gender 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-02T18:23:00.920

这取决于您对性别为`'m'`或的确定程度`'f'`。

如果您绝对确定，请使用`if...else`而不是`if...elif...else`. 只是让每个人都更容易。

但是，如果有任何可能出现格式错误的数据，您可能应该提出异常以使测试和错误修复更容易。在这种情况下，您*可以*使用不分性别的问候语，但对于更大的值，特殊值只会使错误更难找到。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-05-02T20:11:43.780

我实际上认为这是一个地方。

```
class SeriousDesignError(Exception):
    pass 
```

所以你可以这样做

```
if number % 2 == 0:
    result = "Even"
elif number % 2 == 1:
    result = "Odd"
else:
    raise SeriousDesignError() 
```

我认为这是最有意义的错误信息。这种事情只能通过设计错误（或维护不当，这是同一件事）出现。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-05-02T23:51:45.200

这完全取决于您希望错误发出什么信号，但在这种情况下我会使用字典：

```
greetings = {'m': 'Mr.', 'f': 'Ms.'}
gender = readFromDB(...)  # either 'm' or 'f'
greeting = greetings[gender] 
```

如果性别既不是 m 也不是 f，这将引发一个包含意外值的 KeyError：

```
greetings = {'m': 'Mr.', 'f': 'Ms.'}

>>> greetings['W']

Traceback (most recent call last):
  File "<pyshell#4>", line 1, in <module>
    greetings['W']
KeyError: 'W' 
```

如果您想在消息中获得更多详细信息，您可以抓住并重新提出：

```
try:
    greeting = greetings[gender]
except KeyError,e:
    raise ValueError('Unrecognized gender %s' % gender) 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-05-02T23:26:18.507

我有时会：

```
if gender == 'm':
    greeting = 'Mr.'
else:
    assert gender == 'f'
    greeting = 'Ms.' 
```

我认为这很好地告诉了代码的读者只有（在这种情况下）两种可能性，以及它们是什么。尽管您可以提出比 AssertionError 更具描述性的错误。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2012-04-06T03:11:54.910

到目前为止，我通常使用 John Fouhy 答案的变体——但这并不完全正确，正如 Ethan 指出的那样：

```
assert gender in ('m', 'f')
if gender == 'm':
    greeting = 'Mr.'
else:
    greeting = 'Ms.' 
```

使用断言的主要问题是，如果有人使用 -O 或 -OO 标志运行您的代码，断言会被优化掉。正如 Ethan 在下面指出的那样，这意味着您现在根本没有数据检查。断言是一种开发辅助工具，不应用于生产逻辑。我将养成使用 check() 函数的习惯——这允许像断言一样干净的调用语法：

```
def check(condition, msg=None):
    if not condition:
        raise ValueError(msg or '')

check(gender in ('m', 'f'))
if gender == 'm':
    greeting = 'Mr.'
else:
    greeting = 'Ms.' 
```

回到最初的问题，我声称在 if/else 逻辑之前使用 assert() 或 check() 更容易阅读、更安全、更明确：

*   它在开始对其采取行动之前首先测试数据质量——如果 if/else 链中存在除 '==' 以外的运算符，这可能很重要
*   它将断言测试与分支逻辑分开，而不是将它们交错——这使得阅读和重构更容易

# python - 使用计算成本低廉的 Python 散列算法检测转推

> ID：815313
> 
> 赞同：2
> 
> 时间：2009-05-02T18:17:58.483
> 
> 标签：python, hash, twitter, md5

为了能够检测特定推文的 RT，我计划将每条格式化推文的哈希值存储在数据库中。

我应该使用什么哈希算法。神秘当然不是必需的。只是一种将数据存储为某种东西的最小方法，如果它相同，则可以以一种有效的方式进行比较。

我的第一次尝试是使用 md5 哈希。但我认为可以有更有效的散列算法，因为不需要安全性。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-02T18:21:12.453

你真的需要散列吗？Twitter 消息足够短（并且磁盘空间足够便宜），最好只存储整个消息，而不是消耗时钟周期来散列它。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-02T18:57:56.373

我对 Python 不熟悉（抱歉，Ruby 人在这里打字）但是你可以尝试一些事情。

**假设：** 随着时间的推移，您可能会存储数十万条推文，因此将一个哈希与表中的“每条记录”进行比较将是低效的。此外，RT 并不总是原始推文的副本。毕竟，通常会包含原作者的姓名，并且会占用 140 个字符的限制。因此，也许您可​​以使用比“哑”哈希更准确匹配的解决方案？

1.  **标记和索引**

    以标准方式标记和索引消息的组成部分。这可能包括将散列 #....、at-marked @.... 和 URL 字符串视为“标签”。去除干扰词和标点符号后，您还可以将剩余的词也视为标签。

2.  **快速搜索**

    数据库很难快速找到多个组成员（我假设您使用的是 Mysql 或 Postgresql，这很糟糕）。[而是尝试使用Sphinx Search](http://www.sphinxsearch.com/)等自由文本引擎之一 。他们在解决多个组成员身份方面非常快速（即检查关键字是否存在）。

    使用 Sphinx 或类似工具，我们搜索我们提取的所有“标签”。这可能会返回一个较小的“潜在原始推文”结果集。然后使用相似度匹配算法将它们一一进行比较（这里是 Python [http://code.google.com/p/pylevenshtein/](http://code.google.com/p/pylevenshtein/)中的一个）

现在让我热烈欢迎您来到*文本挖掘*的世界。

祝你好运！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-02T18:52:58.943

我回应 Chris 关于根本不使用哈希的评论（您的数据库引擎有望有效地索引 140 个字符的字段）。

如果您确实想使用哈希，MD5 也是我的首选（16 字节），然后是 SHA-1（20 字节）。

无论您做什么，都不要使用字符总和。我不能立即想出一个会产生更多冲突的函数（所有字谜哈希都相同），而且它更慢！

```
$ python -m timeit -s 'from hashlib import md5' 'd=md5("There once was a man named Michael Finnegan.").digest()'
100000 loops, best of 3: 2.47 usec per loop
$ python -m timeit 'd=sum(ord(c) for c in "There once was a man named Michael Finnegan.")'
100000 loops, best of 3: 13.9 usec per loop 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-07-16T19:07:47.130

这里有几个问题。首先，RT 并不总是相同的。有些人添加评论。其他人更改 URL 以进行跟踪。其他人添加了他们正在 RT 的人（可能是也可能不是发起人）。

因此，如果您要对推文进行哈希处理，您需要将其归结为推文的内容，并且只对其进行哈希处理。祝你好运。

上面，有人提到使用 32 位，您将在大约 65K 条推文处开始发生冲突。当然，您可能会在推文 #2 上发生冲突。但我认为该评论的作者很困惑，因为 2^16 = ~65K，但 2^32 = ~4 万亿。所以你有更多的空间。

更好的算法可能是尝试导出推文的“独特”部分，并对其进行指纹识别。它不是散列，而是定义唯一性的几个关键词的指纹。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-02T18:22:41.840

好吧，推文只有 140 个字符长，所以你甚至可以将整个推文存储在数据库中......

但如果你真的想以某种方式“散列”它们，一个简单的方法是只取推文中所有字符的 ASCII 值的总和：

```
sum(ord(c) for c in tweet) 
```

当然，每当你有匹配的哈希时，你应该检查推文本身是否相同，因为找到两条给出相同“sum-hash”的推文的概率可能是不可忽略的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-02T18:20:51.707

Python的搁置模块？[http://docs.python.org/library/shelve.html](http://docs.python.org/library/shelve.html)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-03T18:59:30.030

您正在尝试对字符串进行哈希处理吗？内置类型可以立即进行散列，只需执行此操作即可`hash("some string")`获得一些 int。它与 python 用于字典的函数相同，因此它可能是最佳选择。

# authentication - 基于数字签名的登录系统是个好主意吗？

> ID：815326
> 
> 赞同：0
> 
> 时间：2009-05-02T18:24:08.250
> 
> 标签：authentication, login, openid, digital-signature

OpenID 的目标之一是抵御任何一家公司的失败。这听起来不错，但还有另一个问题：如果托管您的 ID 的站点出现故障，那么您的 ID 也会出现故障。我认为必须有一个完全抵抗失败的登录系统。

我的想法是这样的：我去一个网站，我必须登录。我给他们我的公钥。该网站向我发送了一些随机数据。我用我的私钥签署这些数据并将其发回给他们。如果签名有效，我就会登录。这样做的好处是我的 ID 只是我的公钥，所以我不依赖任何外部站点。

为了使用户不必记住那里的密钥，系统还可以选择允许类似 OpenID 的系统，其中我的密钥托管在某个服务器上，原始站点将我重定向到那里登录，并且该站点对数据进行签名并将其发送回原始站点，然后我已登录。此方法的工作方式类似于 OpenID，但允许我备份我的密钥，因此如果该站点出现故障，我可以使用另一个站点。

这是一个实用的系统吗？我只是在浪费时间吗？我不应该重新发明轮子而只使用 OpenID 吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-02T18:50:39.747

身份证，如 Windows Cardspace，是一个不错的选择，因为它们存储在您的计算机上并且可以备份。这在技术上称为[身份元系统](http://en.wikipedia.org/wiki/Identity_Metasystem)或[身份卡](http://en.wikipedia.org/wiki/Information_Card)。

这与 OpenID 等集中式身份服务不同。OpenID 系统的好处是每个人的身份服务器宕机的可能性都非常小。但是，单独地，每个用户都可能会遇到中断。

Microsoft 的 InfoCard 系统是一个很好的解决方案，虽然它不是很流行。

这不是一个新问题——电子邮件签名和加密是与私钥/公钥系统类似的解决方案。GPG 实际上确实有密钥库，您可以在其中发布您的公钥，以便人们可以验证您的签名。

如果您真的想避免身份服务器关闭的任何可能性（非常严格的要求），请使用 CardSpace 或其他一些用户自己拥有密钥的私钥/公钥系统，并且只需要证明他们有他们通过一些挑战 - 响应散列算法。

此外，cardspace 解决方案并不是严格意义上的微软产品，所有操作系统都有大量的应用程序。我相信这是一个公共标准。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-02T18:34:19.567

[这与HTTPS 的工作](http://www.verisign.com/ssl/ssl-information-center/how-ssl-security-works/)方式非常相似。

根据您的想法，您需要妥善保管您的私钥。如果您的计算机崩溃等怎么办。另外，从其他人的计算机登录怎么办？您是否相信将带有您私钥的拇指驱动器放入其他人的计算机中？

这也与军方对身份证的处理方式非常相似，他们将私钥嵌入到他们发给军人的芯片上。会员需要将自己的 ID 放入专用阅读器，并使用必须定期更改的唯一 ID 和密码登录。这是为了处理成员丢失他的 ID 并且其他人试图使用它的情况。

所以我想我的答案是肯定的，你有一个好主意，但也许你只需要进一步完善它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-02T18:29:27.300

使用 OpenID。它很容易设置，您不必调试它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-02T18:34:18.600

[Windows CardSpace](http://msdn.microsoft.com/en-us/library/aa480189.aspx)支持这样的东西。但它并没有真正起飞。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-02T18:34:40.033

您的系统的问题是，如果您由于硬件问题或系统崩溃而丢失了密钥，您将失去访问您使用该密钥的站点的唯一途径。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-02T19:39:44.213

我会说 OpenID 就足够了。

我发现您的系统存在一些问题

1.  我需要有那个密钥才能登录。如果我出去了，并且没有我的文件或远程托管的文件，我就不走运了。我也可能无法在我的手机或其他设备上输入它。

2.  您还需要保护密钥不丢失。这可能意味着密码保护密钥，这带走了系统的很多便利。

为了让 OpenID 更能抵抗 ID 提供者的失败，需要做的是让网站允许多个 OpenID 与一个帐户相关联，就像 SO 所做的那样。所以，你的想法可能最终是可行的，但我认为让它工作和采用的努力将比广泛采用允许多个 OpenID 的网站的工作要大得多。

此外，请查看此[链接](http://blogs.adobe.com/simplicity/2009/02/using_tls_client_auth.html)以获取 TLS 客户端身份验证的描述

# latex - LaTeX 中的多个目录

> ID：815334
> 
> 赞同：6
> 
> 时间：2009-05-02T18:29:36.660
> 
> 标签：latex, tableofcontents

我想制作一个包含两个目录的 LaTeX 文档，例如：

> 内容概述
> 
> *   1 - 简介
> *   2 - 解决方案
> 
> 详细内容
> 
> *   1 - 简介
>     *   1.1 - 问题
>     *   1.2 - 为什么？
> *   2 - 解决方案
>     *   2.1 - A 阶段
>     *   2.2 - B 阶段

我试过了

```
\setcounter{tocdepth}{1}
\tableofcontents

\setcounter{tocdepth}{2}
\tableofcontents 
```

但这仅根据需要显示第一个目录。第二个目录是空的......（即使没有两`\setcounter`行，第二个目录实际上也是空的。）

（一个相关问题：如何更改目录的标题（与默认内容不同）？）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-02T19:03:55.253

您是否尝试过[shorttoc](http://www.ctan.org/tex-archive/macros/latex/contrib/shorttoc/)包？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-02T19:08:58.487

您可以使用 \renewcommand 更改 ToC 的名称，

```
\renewcommand{\contentsname}{My New Table Of Contents} 
```

例子：

```
\documentclass{amsart}
\usepackage{hyperref}
\renewcommand{\contentsname}{My New Table of Contents}
\begin{document}

\setcounter{tocdepth}{3}
\tableofcontents
\newpage

\newpage
\section{Section a}
Some a text.
\subsection{Subsection b}
Some b text.
\subsubsection{Subsubsection c}
Some c text.

\newpage
\section{Section d}
Some d text.
\subsection{Subsection e}
Some e text.

\end{document} 
```

我已经使用 \renewcommand 自定义了 \maketitle 命令的外观，因此您可能想要查看更新 \tableofcontents。

# c# - 如何获取已安装更新和修补程序的列表？

> ID：815340
> 
> 赞同：19
> 
> 时间：2009-05-02T18:32:30.320
> 
> 标签：c#, .net, windows, list

已安装在我的计算机上的每个更新和修补程序的列表，来自 Microsoft Windows 更新或知识库。我需要以 KBxxxxxx 或类似表示形式的每个 ID...

目前我有：

```
const string query = "SELECT HotFixID FROM Win32_QuickFixEngineering";
var search = new ManagementObjectSearcher(query);
var collection = search.Get();

foreach (ManagementObject quickFix in collection)
    Console.WriteLine(quickFix["HotFixID"].ToString()); 
```

但这似乎并没有列出所有内容，它只列出了 QFE。

我需要它在 Windows XP、Vista 和 7 上工作。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-02T20:16:29.807

在对我之前发现的内容进行了进一步搜索之后。（是的，和 VolkerK 首先建议的一样）

1.  在 %SystemRoot%\System32\ 中的 VS2008 CMD 下运行命令以获取托管 dll：
    **tlbimp.exe wuapi.dll /out=WUApiInterop.dll**
2.  添加 WUApiInterop.dll 作为项目引用，以便我们查看函数。

使用以下代码，我可以获得一个列表，从中可以提取 KB 编号：

```
var updateSession = new UpdateSession();
var updateSearcher = updateSession.CreateUpdateSearcher();
var count = updateSearcher.GetTotalHistoryCount();
var history = updateSearcher.QueryHistory(0, count);

for (int i = 0; i < count; ++i)
    Console.WriteLine(history[i].Title); 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-05-02T19:06:46.790

您可以使用[IUpdateSession3::QueryHistory 方法](http://msdn.microsoft.com/en-us/library/bb394842(VS.85).aspx)。
返回条目的属性在[http://msdn.microsoft.com/en-us/library/aa386400(VS.85).aspx中描述](http://msdn.microsoft.com/en-us/library/aa386400(VS.85).aspx)

```
设置 updateSearch = CreateObject("Microsoft.Update.Session").CreateUpdateSearcher
设置 updateHistory = updateSearch.QueryHistory(1, updateSearch.GetTotalHistoryCount)

对于 updateHistory 中的每个 updateEntry
  Wscript.Echo "标题：" & updateEntry.Title
  Wscript.Echo "应用程序 ID:" & updateEntry.ClientApplicationID
  Wscript.Echo "--"
下一个
```

编辑：也看看[http://msdn.microsoft.com/en-us/library/aa387287%28VS.85%29.aspx](http://msdn.microsoft.com/en-us/library/aa387287%28VS.85%29.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-10-31T20:29:19.107

```
const string querys = "SELECT HotFixID FROM Win32_QuickFixEngineering";
var search = new ManagementObjectSearcher(querys);
var collection = search.Get();

foreach (ManagementObject quickfix in collection)
{
    hotfix = quickfix["HotFixID"].ToString();
}

listBox1.Items.Add(hotfix); 
```

这将使用当前安装的修补程序或更新填充列表框

如果您想列出所有更新和修补程序的历史记录，那么上面提到的 Tom Wijsman 示例将起作用

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-11-19T20:42:25.513

以防万一您只想要更新列表而不关心是通过代码还是 GUI 获取它，以下是如何在 Powershell 中执行此操作：

1.  打开 PowerShell（最好“以管理员身份运行”）
2.  键入“get-hotfix”并按回车键。而已。

![获取修补程序](https://i.stack.imgur.com/yq9MM.png)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-09-30T03:45:49.080

```
 string ExtractString(string s)
    {
        // You should check for errors in real-world code, omitted for brevity
        try
        {
            var startTag = "(";
            int startIndex = s.IndexOf(startTag) + startTag.Length;
            int endIndex = s.IndexOf(")", startIndex);
            return s.Substring(startIndex, endIndex - startIndex);
        }
        catch
        {
            return ("CNVFL");
        }
    } 
```

上面是一个简单的提取字符串方法，我用它来发现 KB 像 Tom Wijsman 提到的那样在安全包中并运行他的。

```
var updateSession = new UpdateSession();
var updateSearcher = updateSession.CreateUpdateSearcher();
var count = updateSearcher.GetTotalHistoryCount();
var history = updateSearcher.QueryHistory(0, count);

for (int i = 0; i < count; ++i){
   //sets KB here!!
   string _splitstring = ExtractString(history[i].Title);
   Console.WriteLine(_splitstring);
} 
```

这会让你得到你正在寻找的 KB 编号，我相信

# version-control - 如果禁止使用版本控制关键字，如何防止文件混淆？

> ID：815341
> 
> 赞同：1
> 
> 时间：2009-05-02T18:32:31.520
> 
> 标签：version-control, version-control-keywords

至少有两位出色的程序员，Linus Torvalds 和 Guido von Rossum，贬低将关键字放入文件中以显示版本号、最后作者等的做法。

我知道关键字差异如何混淆差异。我喜欢 SlickEdit 的 DiffZilla 的原因之一是它可以设置为跳过前导注释。

但是，我对团队编程有生动的回忆，我们有四个版本的文件（两个不同的版本，一个客户一次性版本和开发版本）都同时打开以进行修补，并且非常有助于验证一目了然，每次我们导航到包含的标题时，我们都会得到正确的标题，并且每次粘贴代码时，源和目标都是我们所期望的。

当仓促的开发人员使用文件系统将文件从一个地方复制到另一个地方，而不是使用该工具将其从存储库中签出时，还会出现这个文件来自哪里的问题；或者，更具防御性的是，当需要将位置 A、B 和 C 中受控制的文件编组（通过挑选）到分发位置 D 时。

在VCS关键字被禁止的地方，你是如何应对的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-03-29T02:15:30.873

在我 30 多年的整个职业生涯中，我从未使用过 VCS 关键字。从我使用过的最原始的 VCS 系统到现在（TFS），我使用了一些其他的结构来理解“我在哪里”。

我很少遇到只有一个文件可以使用的情况。我通常拥有构建项目或项目集所需的所有其他文件。我通常使用分支（或有时*流*），并且我正在处理给定分支或流的某个部分。

如果我正在处理多个分支或流，我将为每个分支或流创建一个目录树。要知道我正在处理什么文件，我需要做的就是检查文件路径，最糟糕的是。

在最好的情况下，版本控制系统会准确地告诉您您正在处理的文件版本、更改历史记录、还有谁在处理文件的不同版本，以及您想知道的任何其他信息.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-02T18:44:44.457

这并不能完全回答您的问题，但我认为 Linus 和 Guido 有理由不喜欢不适用于小团队企业发展的关键字。

例如`$Id$`，标签具有您可以认为是全局版本号的内容。Linux 和我猜 Python 开发也足够分散，没有一个数字可以是全局的。很多人在各处都有自己的存储库来填充他们自己的`$Id$`值，然后这些补丁可能会被发送到 Linus 或 Guido 的存储库，在那里它们没有任何意义。

但是，在您的环境中，您可能有一个中央存储库来分配这些，这很好。听起来你正在使用 git。我想知道是否可以将中央 git 存储库配置为进行标记替换，而本地开发人员存储库则没有。或者也许最好在标签中获取提交哈希。

# c# - 为什么结构存储在堆栈上，而类存储在堆（.NET）上？

> ID：815354
> 
> 赞同：27
> 
> 时间：2009-05-02T18:37:18.640
> 
> 标签：c#, .net

我知道类和结构之间的区别之一是结构实例存储在堆栈上，而类实例（对象）存储在堆上。

因为类和结构非常相似。有人知道这种特殊区别的区别吗？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2009-05-02T19:16:13.943

（编辑以涵盖评论中的要点）

强调一下：值类型和引用类型之间存在差异和相似之处，但这些差异与堆栈与堆**无关**，与复制语义与引用语义有关。特别是，如果我们这样做：

```
Foo first = new Foo { Bar = 123 };
Foo second = first; 
```

那么“第一”和“第二”是在谈论同一个副本`Foo`吗？或不同的副本？碰巧堆栈是将值类型作为变量*处理*的一种方便且有效的方式。但这是一个实现细节。

（结束编辑）

关于整个“值类型在堆栈上”的事情...... - 值类型**并不**总是在堆栈上；

*   如果它们是类上的字段
*   如果他们被装箱
*   如果它们是“捕获的变量”
*   如果它们在迭代器块中

然后他们继续堆（最后两个实际上只是第一个的奇异示例）

IE

```
class Foo {
    int i; // on the heap
}

static void Foo() {
    int i = 0; // on the heap due to capture
    // ...
    Action act = delegate {Console.WriteLine(i);};
}

static IEnumerable<int> Foo() {
    int i = 0; // on the heap to do iterator block
    //
    yield return i;
} 
```

此外，Eric Lippert（如前所述）有一篇关于这个主题的[优秀博客文章](https://docs.microsoft.com/en-us/archive/blogs/ericlippert/the-stack-is-an-implementation-detail-part-one)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-05-02T18:39:57.057

在实践中，能够为某些目的在堆栈上分配内存很有用，因为这些分配非常快。

然而，值得注意的是，并不能从根本上保证所有结构都将放在堆栈上。Eric Lippert 最近就这个话题写[了一篇有趣的博客文章。](https://docs.microsoft.com/en-us/archive/blogs/ericlippert/the-stack-is-an-implementation-detail-part-one)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-02T18:51:30.617

每个进程都有一个数据块，由两个不同的可分配内存段组成。这些是堆栈和堆。栈主要作为程序流管理器，保存局部变量、参数和返回指针（在从当前工作函数返回的情况下）。

与诸如结构（或基本类型——整数、字符等）之类的值类型相比，类是非常复杂且大多是非常大的类型。由于堆栈分配应该专门用于程序流的效率，因此它不能提供最佳环境来保持大物体。

因此，为了满足这两种期望，这种分离的架构出现了。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-02T20:29:41.943

在某些语言中，例如 C++，对象也是值类型。

找到相反的例子更难，但在经典的 Pascal 联合结构下，只能在堆上实例化。（普通结构可以是静态的）

简而言之：这种情况是一种选择，而不是硬法。由于 C#（以及之前的 Java）缺乏程序基础，人们可以问自己为什么它需要结构。

它存在的原因可能是外部接口需要它并具有高性能且紧凑的复杂（容器）类型。比课堂更快的一种。然后最好将其设为值类型。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-02T20:45:03.323

编译器和运行时环境处理内存管理的方式已经发展了很长时间。堆栈内存与堆内存分配决策与编译时可能知道的内容和运行时可能知道的内容有很大关系*。*这是在托管运行时间之前。

一般来说，编译器可以很好地控制堆栈上的内容，它可以根据调用约定来决定清理什么以及何时清理。另一方面，堆更像是狂野的西部。编译器无法很好地控制事情何时来去去去。通过将函数参数放在堆栈上，编译器能够创建一个*范围*——该范围可以在调用的生命周期内进行控制。这是放置值类型的自然位置，因为它们很容易控制，而引用类型可以将内存位置（指针）分发给他们想要的任何人。

现代内存管理改变了很多。.NET 运行时可以通过复杂的垃圾收集和内存管理算法来控制引用类型和托管堆。 [这也是一个非常非常深刻的课题](https://rads.stackoverflow.com/amzn/click/com/0471941484)。

我建议你查看一些关于编译器的文本——我是在 Aho 长大的，所以我[推荐](https://rads.stackoverflow.com/amzn/click/com/0321486811). 您还可以通过阅读[Gosling](http://java.sun.com/docs/books/jls/)了解有关该主题的很多信息。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-02T22:20:44.873

Marc Gravell 已经精彩地解释了值和引用类型如何复制的区别，这是它们之间的主要区别。

至于为什么通常在堆栈上创建值类型，那是因为它们的复制方式允许它。堆栈在性能方面比堆有一些明显的优势，特别是因为编译器可以计算在某个代码块中创建的变量的确切位置，这使得访问速度更快。

创建引用类型时，您会收到对堆中存在的实际对象的引用。每当您与对象本身交互时，都会有一个小级别的间接性。这些引用类型不能在堆栈上创建，因为堆栈中值的生命周期很大程度上取决于代码的结构。例如，当函数返回时，方法调用的函数框架将从堆栈中弹出。

但是，对于值类型，它们的复制语义允许编译器根据它的创建位置将其放入堆栈中。如果您在方法中创建一个包含结构实例的局部变量，然后返回它，则会创建它的副本，正如 Marc 上面解释的那样。这意味着该值可以安全地放置在堆栈中，因为实际实例的生命周期与方法的函数框架相关联。每当您将其发送到当前函数之外的某个地方时，都会创建它的副本，因此您是否将原始实例的存在与函数的范围联系起来并不重要。沿着这些思路，您还可以看到为什么由闭包捕获的值类型需要放入堆中：它们的寿命超过其范围，因为它们还必须可以从闭包内访问，并且可以自由传递。

如果它是引用类型，那么您将不会返回对象的副本，而是返回引用，这意味着实际值必须存储在其他地方，否则，如果您返回引用并且对象的生命周期与在创建它的范围内，它最终会指向内存中的一个空白空间。

区别实际上并不是“值类型在堆栈上，引用类型在堆上”。真正的一点是，访问堆栈中的对象通常更有效，因此编译器会尝试将这些值放置在那里。事实证明，由于它们的复制语义，值类型比引用类型更符合要求。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-02T18:41:38.567

我相信是否使用堆栈或堆空间是两者之间的主要区别，也许这篇文章会对您的问题有所了解：[Csharp classes vs structs](http://www.johnnycantcode.com/post/Csharp-Classes-vs-Structs.aspx)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-02T22:06:07.577

主要区别在于堆可能会保存永远存在的对象，而堆栈上的某些东西是临时的，因为当封闭的调用站点退出时它会消失。这是因为当一个人进入一个方法时，它会增长到保存局部变量以及调用者方法。当方法正常退出（ab）时，例如返回或由于异常，每个帧都必须从堆栈中弹出。最终，感兴趣的框架被弹出，上面的所有东西都丢失了。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-03-16T11:02:01.047

使用堆栈的全部意义在于它自动实现和尊重范围。存储在堆栈中的变量一直存在，直到创建它的函数退出并且该函数堆栈帧被弹出。具有本地范围的东西对于堆栈存储来说是很自然的，具有更大范围的东西在堆栈上更难管理。堆上的对象可以具有以更复杂的方式控制的生命周期。

编译器总是将堆栈用于变量 - 值或引用几乎没有什么区别。引用变量不必将其值存储在堆栈中 - 它可以在任何地方，如果引用的对象很大并且有多个引用，堆会更有效。关键是引用变量的范围与它引用的对象的生命周期不同，即变量可能会通过从堆栈中弹出而被破坏，但它引用的对象（在堆上）可能会继续存在。

如果值类型足够小，您不妨将它存储在堆栈中，而不是在堆上对其进行引用——它的生命周期与变量的范围相关。如果值类型是较大引用类型的一部分，那么它也可能有多个引用，因此将其存储在堆上并将其生命周期与任何单个引用变量分离更为自然。

堆栈和堆是关于生命周期的，值 v 引用语义几乎是副产品。

看看[价值和参考](http://www.i-programmer.info/ebooks/deep-c/362-deep-c-c1.html)

* * *

## 回答 #10

> 赞同：-3
> 
> 时间：2009-05-02T19:13:58.007

值类型放在栈上，引用类型放在堆上。结构是一种值类型。

但是，规范中对此没有任何保证，因此它可能会在未来的版本中发生变化:)

# iis-7 - 在 IIS7 下运行的 IIS5 或 IIS6 Web 应用程序？

> ID：815360
> 
> 赞同：1
> 
> 时间：2009-05-02T18:41:30.330
> 
> 标签：iis-7, iis-6, iis-5

我有一个在 IIS5 或 IIS6 下运行良好的 Web 应用程序。我刚刚安装了具有 IIS7 的 Vista。我只是按原样复制了整个网络应用程序，没有更改任何文件。我进入 IIS7 管理器并在默认网站下创建了一个 Web 应用程序，并将其指向我复制过来的应用程序。

当我尝试在 IE 中浏览应用程序时，它告诉我没有任何东西可以处理它并且目录浏览没有打开。这是一个 .NET 应用程序，因此它使用 Default.aspx。我查看了管理器，没有处理 Default.aspx 设置。IIS7默认情况下不启用吗？

所以，我添加了 Default.aspx，现在错误是“HTTP Error 404.3 - Not Found The page you are requesting cannot be serving because of extension configuration. 如果页面是脚本，添加处理程序。如果文件应该是下载，添加 MIME 映射。”

我想可能是因为 IIS7 的默认设置是集成模式，所以我为经典模式创建了一个新的 AppPool 并更改了我的应用程序以使用它。我仍然得到同样的错误。

我的印象是我可以将 .NET 应用程序迁移到 IIS7 而无需任何更改。这不是真的吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-02T18:53:20.240

0) 检查您是否在程序和功能 - Windows 功能 - WWW 服务 - 应用程序开发功能 - .Net Extensibility / ASP.Net 下安装了 asp.net 扩展

1) Microsoft .net 框架

2) 尝试将整个目录复制到 IIS 的根文件夹（通常是 wwwroot），常见错误 iuser/iwam 没有读取其他文件夹的权限。

3) 检查“处理程序设置”下是否有与任何 Isapi 模块关联的 .aspx。

# visual-studio - 安装到 GAC 中的程序集物理存储在哪里？

> ID：815362
> 
> 赞同：7
> 
> 时间：2009-05-02T18:42:27.800
> 
> 标签：visual-studio, assemblies

我想导出项目中构建的程序集。但是它们物理存储在哪里？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-02T18:54:27.910

在我写完我的问题之后，我实际上找到了这篇文章。真的很好解释：

如果您导航到

`c:\windows\assembly`

使用 Explorer，您将在其中看到格式精美的程序集列表。
负责此视图的 shell 扩展不仅显示 GAC 中的程序集，还显示使用 ngen.exe 预编译的程序集的本机版本。
但这些文件实际上并没有存储在这里——shell 扩展名只是掩盖了它们的真实位置。您可以通过命令提示符导航到同一目录来查看文件的实际存储位置。
在这个位置有许多子目录，包括一个名为 GAC 的子目录。隐藏在几层哈希码和程序集名称下的是物理程序集，以及一个老式的 .INI 文件，其中包含强名称等。值得在这个未知领域进行探索，以了解幕后发生的事情，但要小心进行更改，因为 GAC 旨在不透明。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-02T18:51:14.877

它们存储在 %systemroot% 的名为**assembly的文件夹中**

%SystemRoot% 变量是在 Microsoft Windows NT 及其衍生版本中发现的特殊系统范围的环境变量。它的值是系统文件夹的位置，包括驱动器和路径。

驱动器与 %SystemDrive% 相同，全新安装的默认路径取决于操作系统的版本。默认情况下，在全新安装中：

```
* Windows NT 5.1 (Windows XP) and newer versions use \WINDOWS
* Windows NT 5.0 (Windows 2000), Windows NT 4.0 and Windows NT 3.1 use \WINNT
* Windows NT 3.5x uses \WINNT35 
```

（来自维基百科）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-02T18:50:39.107

GAC的物理位置是%WINDIR%下的Assembly目录，fe

```
c:\windows\assembly 
```

您可以使用 Explorer 或 gacutil 程序将程序集复制到 gac。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-08-25T07:33:16.587

不，物理程序集不存储在“C:\Windows\assembly”中。只有对程序集的引用存储在那里。例如，程序集“System.Windows.Forms.dll”（以及大部分 .NET Framework 程序集）在许多版本中物理存储在“C:\Windows\winsxs”中，针对许多平台进行了优化（只需转到“ C:\Windows\winsxs”并在搜索框中键入“System.Windows.Forms.dll”）。例如，您可以创建强命名程序集，将其注册到 GAC，但它的物理位置是您放置程序集文件的位置。（例如“C:\Users\%username%\Documents\Visual Studio 2008\Projects\YourAssemblyProjectName\YourAssemblyProjectName\bin\Debug” - VS 项目默认目录）。还有更多，在 GAC 中只存储对程序集的引用，

# python - 从交叉引用包导入 Python

> ID：815367
> 
> 赞同：0
> 
> 时间：2009-05-02T18:46:15.000
> 
> 标签：python

目前我正在尝试编写我的第一个 Python 库，但遇到了以下问题：

我的包 myapp.factories 中有以下导入：

```
from myapp.models import * 
```

我的包 myapp.models 中有以下内容：

```
from myapp.factories import * 
```

我需要我的工厂包中的模型，但在一个模型中我还需要其中一个工厂。如果我现在调用需要工厂的代码，我会收到以下错误：

```
NameError: global name 'MyModelFactory' is not defined 
```

我很确定这与加载脚本的顺序有关，但我似乎无法弄清楚如何让这些交叉引用起作用。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-02T18:49:18.347

“在一个模型中，我还需要其中一个工厂” - 只需在您需要的地方导入该工厂即可：

```
class SomeModel:
    def some_method(self):
        from myapp.factories import SomeFactory
        SomeFactory().do_something() 
```

# delphi - Delphi组件spTbxToolbar换肤

> ID：815371
> 
> 赞同：2
> 
> 时间：2009-05-02T18:47:48.520
> 
> 标签：delphi, components, skinning

如何在运行时通过代码（不适用于 groupskintype）更改 sptbxtoolbar 组件的皮肤类型？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-02T20:34:10.277

您一次只能更改所有 SpTBXLib 组件的外观。

使用此代码

```
SkinManager.SetSkin('Office 2007 Blue'); 
```

`SkinType`但是，您可以通过设置分配属性来设置每个 SpTBXLib 组件是否使用皮肤、Windows 外观或默认外观绘制。

```
MyComponent.SkinType := sknWindows; 
```

**提示：**工具栏本身没有 SkinType 属性。它们总是使用皮肤绘制。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-02T18:59:23.813

我不知道那个组件，但在Google 上找到[了这个。](http://www.mytreedb.com/downloads/m-subcat/a-skins.html)希望能帮助到你。

# ruby-on-rails - 在 Rails 中处理发送到应用程序特定地址的电子邮件的最佳实践？

> ID：815373
> 
> 赞同：2
> 
> 时间：2009-05-02T18:48:50.077
> 
> 标签：ruby-on-rails, ruby

我们希望实现一个功能，用户可以通过该功能向特定于应用程序的地址发送电子邮件，我们将解析消息并对其采取某些操作，类似于 37signals 的背包（可能还有他们的一些其他应用程序）。

如果有人做过类似的事情，你能告诉我你是怎么做的吗？我不确定如何从高层次上将电子邮件“导入”到应用程序中以便我可以处理它。

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-02T22:58:44.643

以下是我从 POP 服务器获取的方法：

```
require 'net/pop'

pop = Net::POP3.new('mail.yourdomain.com')
pop.start(account, password)
pop.each_mail do |m|
  email = TMail::Mail.parse(m.pop)
  email.base64_decode
  OttoMailer.process_email_in(email, m.unique_id)
  m.delete
end 
pop.finish 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-03T11:31:49.463

我最近在 Rails 中实现了这个确切的功能。[我建议您查看“高级 Rails 食谱”一书中](http://www.pragprog.com/titles/fr_arr/advanced-rails-recipes)的“通过 POP 或 IMAP 可靠地接收电子邮件” 。

我个人发现这是启动和运行它的最佳来源，它解释了如何做得比我做得更好。祝你好运，无论你选择哪种方式：）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-02T18:58:30.507

为什么不运行一个[Ruby SMTP 邮件服务器](http://adamesterline.com/2007/03/06/rumbster-ruby-fake-email-server/)，它将通过端口 25 接收邮件，然后您可以根据需要解析/解释等？

（我说Ruby，因为这就是您标记问题的方式）

另一种解决方案是运行[procmail](http://www.procmail.org/)（或类似的），对主题进行模式匹配，然后调用脚本（在`.procmailrc`文件中配置）。但是，对于大量邮件，这可能无法很好地扩展。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-02T20:44:26.227

`ActionMailer` [可以接收电子邮件](http://api.rubyonrails.org/classes/ActionMailer/Base.html#M001530)以及发送它们！我不记得这是如何完成的，但是如果您查看文档，您可以在那里看到。但是从内存中，电子邮件会通过 procmail 传送到脚本目录中的脚本中。

似乎还有[一本关于这个主题的书](https://peepcode.com/products/mms2r-pdf)。

祝你好运！:)

# c++ - 等到 QWidget 关闭

> ID：815380
> 
> 赞同：20
> 
> 时间：2009-05-02T18:52:15.453
> 
> 标签：c++, qt

我正在使用 C++ 和 QT 开发一个项目，我想打开一个新的 QWidget 窗口，让用户与之交互等，然后让执行返回到打开窗口的方法。示例（MyClass 继承 QWidiget）：

```
void doStuff(){

     MyClass newWindow = new Myclass();
     /* 
        I don't want the code down here to 
        execute until newWindow has been closed
      */
} 
```

我觉得很可能有一种非常简单的方法可以做到这一点，但由于某种原因我无法弄清楚。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-05-02T19:58:06.807

有`MyClass`继承`QDialog`。然后将其作为模式对话框打开，使用`exec()`.

```
void MainWindow::createMyDialog()
{
  MyClass dialog(this);
  dialog.exec();
} 
```

查看[http://qt-project.org/doc/qt-4.8/qdialog.html](http://qt-project.org/doc/qt-4.8/qdialog.html)

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-07-16T15:42:56.363

另一种方法是使用等待关闭事件的循环：

```
#include <QEventLoop>

void doStuff()
{
    // Creating an instance of myClass
    MyClass myInstance;
    // (optional) myInstance.setAttribute(Qt::WA_DeleteOnClose);  
    myInstance.show();

    // This loop will wait for the window is destroyed
    QEventLoop loop;
    connect(this, SIGNAL(destroyed()), & loop, SLOT(quit()));
    loop.exec();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-02T18:54:19.427

为什么不把你不想在窗口关闭之前执行的代码放在一个单独的函数中，并将它作为窗口关闭的 a 连接`SLOT`呢`SIGNAL`？

# .net - 有没有办法在我的应用程序中使用 mstest

> ID：815394
> 
> 赞同：0
> 
> 时间：2009-05-02T18:58:34.877
> 
> 标签：.net, mstest

有没有办法在我的应用程序中运行 mstests？

这些它应该如何工作我应该将项目放在一个文件夹中，将我的应用程序指向它并运行测试

谢谢你的时间

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-02T20:29:21.600

我知道[Galio 项目](http://code.google.com/p/mb-unit/)的路线图上有它为 MSTest 创建测试运行程序，并且项目中已经有 MSTest 扩展的[源代码。](http://www.google.com/codesearch/p?hl=en#--kv20-JHyI/v3/src/Extensions/MSTest/Gallio.MSTestRunner/GallioTestAdapter.cs&q=mstest%20package%3Ahttp%3A//mb-unit.googlecode.com)虽然不知道它的状态，但看看它可能会很有用。

# c# - 我可以获得导致异常的代码行吗？

> ID：815395
> 
> 赞同：4
> 
> 时间：2009-05-02T18:59:16.060
> 
> 标签：c#, exception-handling

除了读取`GetFileName()`文件和读取`GetFileLineNumber()`堆栈帧的行

```
new StackTrace(exception).GetFrame(x) 
```

有没有办法获取导致异常的实际代码行（作为字符串）？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-02T19:02:04.803

我不这么认为。代码已编译，因此不再可用。但是，如果您*也*有可用的源代码，则可能有一些解决方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-02T19:07:04.510

不，据我所知，这是你唯一的选择。为了获得导致异常的原始代码行，那么有必要提供可用的源代码。我想说，这[`StackFrame`](http://msdn.microsoft.com/en-us/library/system.diagnostics.stackframe_members.aspx)已经使您能够获得行号（通过调试符号 - 在大多数情况下是 PDB 文件），这使得它足够简单。

您建议的方法有什么特别的问题吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-02T19:08:33.587

没有可靠的方法来执行此操作，因为行信息不存储在 DLL 文件中。将 IL 块映射到源代码行的信息存储在 PDB 文件中。您需要访问 PDB 以获取异常的行信息。

如果 PDB 可用，则 StackFrame 类有足够的信息来获取适当的 ISymUnmanagedMethod 类。主要是你只需要方法标记和方法的当前偏移量。这确实需要您了解 PDB 的内部结构，我不确定它是否记录在任何地方。

PDB API：http: [//msdn.microsoft.com/en-us/library/ms233503.aspx](http://msdn.microsoft.com/en-us/library/ms233503.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-02T19:09:42.430

它将被编译，因此在运行时您将只有 IL。充其量，您可以获取 IL 并将其反编译回 C#，就像反射器一样。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-02T19:18:21.833

后期调试很困难，但并非不可能。您可以使用一些工具（例如[此处](http://www.microsoft.com/downloads/details.aspx?FamilyID=28bd5941-c458-46f1-b24d-f60151d875a3&displaylang=en)和[此处](http://www.microsoft.com/whdc/devtools/debugging/default.mspx)）以及[技术](http://blogs.msdn.com/tess/archive/2009/03/20/debugging-a-net-crash-with-rules-in-debug-diag.aspx)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-01-05T08:12:23.003

您可以使用`try catch`块获取线路：

```
catch(Exception exception) {
    //exception.StackTrace at the first line has the line you are looking for
} 
```

# linq-to-sql - 为什么 Linq to Entities 比 Linq to SQL 更“难”

> ID：815397
> 
> 赞同：1
> 
> 时间：2009-05-02T18:59:53.983
> 
> 标签：linq-to-sql, linq-to-entities

为什么在 Linq to Entities 中我需要指定与 Include(string) 的关系？Linq to SQL 不需要。

这是开发者的选择还是限制？

还有一个问题，Linq to SQL 更多的是“POCO”类，Linq to Entities 太复杂了。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-02T19:28:27.737

Linq to Entities（实体框架）比 Linq-To-SQL 复杂得多 - 但它更复杂，因为它提供了更多的灵活性。

在 Linq-to-SQL 中，您基本上可以在数据库表和内存中的 .NET 类之间获得 1:1 映射。这对于许多更简单的场景来说都很好，这就是 Linq-to-SQL 真正闪耀的地方。

但在更大、更复杂的企业场景中，这可能还不够。实体框架和 Linq-to-Entities 允许您拥有一个单独的概念模型（您的 .NET 对象），该模型不一定与您的数据库结构以 1:1 的方式绑定（继承、将多个表合并为一个对象和更多）。虽然这听起来太复杂太复杂，但在许多高级场景中，这是一个救生员和必备功能。

所以我认为你不能将 Linq-to-SQL 和 Linq-to-Entities (EF) 相互比较——它们真的是为不同的、独立的问题空间而设计的，有不同的要求，因此也有不同的方法/风格的编程。

如果 Linq-To-SQL 对您和您的要求足够好 - 太好了 - 一定要使用它！

马克

# javascript - 模态对话框与灯箱 - 谁赢了？

> ID：815404
> 
> 赞同：4
> 
> 时间：2009-05-02T19:08:08.080
> 
> 标签：javascript, modal-dialog, lightbox

在我看来，模态对话框和灯箱都有相同的用途。似乎一方面是性感（但大量使用 javascript），另一方面是经济（但无聊）。

是什么促使您决定使用其中一种？或者，有没有更好的方法来向用户询问复杂数据而无需导航到另一个页面？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-02T19:56:14.190

这取决于您的应用程序。如果您的应用程序不太像网页，而更像是应用程序（如 Google Docs），那么当您希望将用户注意力集中在特定任务上时，模式对话框是有意义的。

如果您的应用程序是一个网站，我会说您不应该通过模式对话框来混淆用户。人们习惯于去单独的页面，甚至通过一系列的页面来完成复杂的任务。如果它是复杂的数据，我通常会将其分解为逻辑步骤，以减少任务的压倒性。您可以使用 Ajax 使其更酷，而无需实际加载整个页面。

模态对话框应该很少使用。我认为如何不使用模式对话框的一个很好的例子是 Facebook。Facebook 有花哨的 ajax 让东西滑出，滑回。它们的界面非常复杂，但大部分复杂性是隐藏的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-07-26T11:55:36.500

网页中的灯箱和模式窗口有很多共同点。Kekoa 描述得很好。

另一个区别：灯箱通常可以通过单击弹出窗口外部（在变暗的背景上）来关闭，而模式窗口通常只能通过在弹出窗口内部进行交互来关闭（例如，单击确定/取消/X）。

这是因为模态窗口是“模态的”并且“要求用户在返回之前与 [它们] 进行交互”（http://en.wikipedia.org/wiki/Modal_window）。

# iframe - 重定向后是否可以找到跨域 iframe 的新 URL？

> ID：815409
> 
> 赞同：8
> 
> 时间：2009-05-02T19:09:58.343
> 
> 标签：iframe, cross-domain

我正在尝试在我网站的另一个子域上发布应用程序的登录表单。这是我没有源访问权限的第三方应用程序。

[我知道由于同源策略](http://en.wikipedia.org/wiki/Same_origin_policy)，您无法访问跨域 iframe 的大多数功能。然而，我需要访问的是在 iframe 中被重定向到（通过 JavaScript）的 URL。它有一个我想通过的会话令牌。

这似乎是允许的足够安全的事情，但我还没有找到一种方法来做到这一点。我正在使用 jQuery，并且我已经尝试过`$('iframe').contents()`，但我似乎对该对象根本没有权限。我也检查了`$('iframe').attr('src')`，但它仍然是预重定向 URL。还有其他方法吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-02T19:29:01.667

不，您无权访问 iframe 中的*任何*属性。您只能访问外部定位和样式属性。

这就是为什么使用框架是如此痛苦的原因。我通常只在我不在乎它们里面做了什么的时候才使用它们。

你不能做服务器端身份验证和令牌传递吗？您可以不在您的服务器上执行此操作，而不是让客户端进行身份验证吗？您可能需要做一些额外的工作来创建 HTTP 请求并解析响应，但可以避免任何 iframe 问题。

底线是 iframe 可能不是最好的依赖（尤其是在跨浏览器功能方面）用于身份验证等重要事情。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-01T16:56:36.017

试试这个[例子](http://mcknut.googlepages.com/iframetest.html)（方法 2），作者在第一个 iframe 中设置了另一个 iframe，在原始域中加载页面。允许内部页面调用外部父级上的 javascript，因为它们加载在同一个域中。只需使用适当的参数加载内部页面，这些参数可以传递给父级。

# iphone - 哪款手机的软件市场潜力最大？

> ID：815410
> 
> 赞同：2
> 
> 时间：2009-05-02T19:11:28.090
> 
> 标签：iphone, mobile, java-me, windows-mobile, symbian

不久前我开发了一个抽认卡程序来学习日语。我一直在考虑把它移植到手机上。什么是好的目标平台？我在考虑 iPhone、HTC Touch HD（系统软件：Windows Mobile）或诺基亚（系统软件：Symbian）。因为我知道一点 JavaME，所以运行起来也很酷。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-02T19:14:06.367

[这是最新的市场份额数据](http://en.wikipedia.org/wiki/File:Market_share_of_mobile_os_s_2008.JPG)。您是否考虑过为所有配备不错网络浏览器的智能手机构建一个基于网络的产品？像[x.facebook.com](http://x.facebook.com)这样的网站不是特定于操作系统的，而是类似于应用程序的，足以提供良好的用户体验。建立这样一个网站并收取订阅费用将是服务所有市场的一种方法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-02T19:15:56.660

好吧，苹果商店前几天刚刚庆祝了它的 1,000,000,000 次下载，所以我想说 iPhone 是最大和最容易瞄准的手机市场。此外，Apple 商店使您的应用程序的销售变得非常容易（他们当然保留了部分收入）。

或许您想问一下，哪款手机在日本的市场份额最大？

此外，我了解微软计划为 Windows Mobile 开设应用商店。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-02T19:44:58.227

既然您了解 JavaME，请看一下为[Android](http://code.google.com/android/)开发。它没有很大的市场份额，但至少你可以利用你现有的技能。

您将无法找到适用于大多数手机平台的通用语言和开发环境。一旦你选择了一个平台，除非你想将你的应用程序移植到完全不同的语言，否则你就会对它做出某种承诺。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-02T20:39:19.470

诺基亚已经开始大力推动基于 Qt 的移动开发平台。诺基亚的手机销量比苹果多得多。

[当您有幸获得 500 美元的投资](http://www.mobileorchard.com/iphone-app-sales-figures-32k-vs-535/)时，为什么还要编写 iPhone 应用程序 #1,000,001 ？

围绕 iPhone 应用程序出现了巨大的热潮……在这一点上，从开发人员的角度来看，这是完全不合理的。（这对用户来说很棒）

Qt 是一个非常出色的 C++ 平台（显然是诺基亚买的 :)。我在用它编写 PC 应用程序时玩得很开心……我打算买一部诺基亚手机，我很快就可以编写 Qt 应用程序了。到那时，我将放弃我的旧 iPhone（原始设备，而不是 3G）。

当 SDK 出来的时候，我想到了 iPhone 的世界。我什至买了苹果股票。然而，因为乔布斯是个控制狂，所以没有 Java 也没有 Flash，这简直是愚蠢的。GPL 不兼容也很痛苦。我也不是为了开发软件而购买 Mac。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-02T20:18:55.540

几周前，我正在阅读一篇关于名为“rohmobile”的产品的文章，该产品是一个自定义 Ruby 框架，运行在微型 Rub​​y Web 服务器上。它允许您针对所有流行的手机（Apple、Microsoft、Android、BlackBerry、Symbian）编译您的应用程序。这似乎是一个非常酷的想法，并且它的开源正在积极开发中。该框架带有一个同步解决方案，因此您可以使用 REST/SOAP 将数据持久化到本地设备。当我对产品进行更多探索时，唯一看起来会很痛苦的是为各种设备编译代码所需的环境设置......如果你能做到这一点，那么你就有了一个解决方案，你可以用一个代码库支持一堆不同的设备！

[http://www.rhomobile.com/](http://www.rhomobile.com/)

** 我从未使用过 Ruby 编程，但语法和演示让它看起来非常简单，因为它实际上只是在设备上安装的微型 Web 服务器上运行的本地网页！UI 是基于 HTML/CSS 的。我认为该产品仍处于测试阶段...

就我的2cents~

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-05-02T19:28:15.037

好吧，我会开始寻找一种可用于市场上顶级手机的系统/编程语言。

我认为一个好的选择是python。这使得在所有将要支持的手机上使用大部分相同的代码变得很容易。

那我可能会从 iPhone 开始，因为我相信它的用户群仍然对新玩具有需求:)

创建 Web 应用程序将是另一种方式……但这意味着您需要在线。如果您不使用闪存或其他一些持久存储的可能性。

PS：我不会使用 javame :) .. 我仍然不喜欢任何 java

# java - 如何使用 Java 播放 WAV 文件？

> ID：815411
> 
> 赞同：1
> 
> 时间：2009-05-02T19:11:41.833
> 
> 标签：java

我使用客户端和服务器发送 WAV 文件，但我想在收到 WAV 时播放它。我尝试了这种方法，但没有奏效：

```
Runtime.getRuntime().exec("C:\\Documents and   Settings\\Administratore\\Desktop\\gradpro\\test1\\s1.wav") ; 
```

这是我得到的例外：

> “错误！它不起作用！java.io.IOException：无法运行程序“C:\Documents”：CreateProcess 错误=193，%1 不是有效的 Win32 应用程序”

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-02T19:16:50.713

您需要执行音频播放器程序（可能是 windows 媒体播放器或类似的东西），然后将文件名（文件的完整路径）作为参数传递：

```
String wavPlayer = "/path/to/winmediaplayer.exe";
String fileToPlay = "/path/to/wav/file.wav";

Runtime.getRuntime().exec(wavPlayer, new String[]{fileToPlay}) ; 
```

那应该行得通。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-17T16:32:20.113

内置 WAV 播放支持的 Java 有什么问题？您可以使用 AudioClip 播放它：

```
private void playBackClip(String fileName) {
    try {
        AudioInputStream soundStream = null;
        if (fileName.startsWith("res:")) {
            soundStream = AudioSystem.getAudioInputStream(
                Object.class.getResourceAsStream(fileName.substring(4)));
        } else {
            File audioFile = resMap.get(fileName);
            soundStream = AudioSystem.getAudioInputStream(audioFile);
        }
        AudioFormat streamFormat = soundStream.getFormat();
        DataLine.Info clipInfo = new DataLine.Info(Clip.class,
                streamFormat);

        Clip clip = (Clip) AudioSystem.getLine(clipInfo);
        soundClip = clip;
        clip.open(soundStream);
        clip.setLoopPoints(0, -1);
        clip.start();
    } catch (UnsupportedAudioFileException e) {
        e.printStackTrace();
    } catch (IOException e) {
        e.printStackTrace();
    } catch (LineUnavailableException e) {
        e.printStackTrace();
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-02T19:20:30.283

是否必须使用默认音频播放器？如果没有，您可能想查看 Java 的[AudioSystem](http://java.sun.com/j2se/1.5.0/docs/api/javax/sound/sampled/AudioSystem.html)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-17T16:17:18.363

不要指定要使用的媒体播放器，而是让 windows 为您查找它：

```
String comspec = System.getenv().get("ComSpec");
String fileToPlay = "/path/to/wav/file.wav";

Runtime.getRuntime().exec(comspec, new String[]{"/c", "start", fileToPlay}) ; 
```

你基本上是在做类似的事情：

```
cmd.exe /c start path_to_wav_file.wav 
```

要查看 start 为您提供的所有选项（start 是 cmd.exe 的内置操作，而不是独立程序，这就是为什么您必须运行 cmd.exe 而不是 'start.exe'），请执行

```
start /h 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-12-03T19:11:43.293

老问题，但为了记录：

```
java.awt.Desktop.getDesktop().open(new java.io.File(my_filename)); 
```

* * *

## 回答 #6

> 赞同：-4
> 
> 时间：2009-05-02T19:18:24.483

尝试：

```
Runtime.getRuntime().exec("'C:\Documents and Settings\Administratore\Desktop\gradpro\test1\s1.wav'") ; 
```

注意额外的单引号。我什至不确定您的方法是否有效，但请尝试一下。

# objective-c - 通过窗口的工具栏按钮禁用 NSToolbar 自定义？

> ID：815412
> 
> 赞同：4
> 
> 时间：2009-05-02T19:12:17.777
> 
> 标签：objective-c, xcode, macos, cocoa

我希望禁用 Cocoa 窗口中工具栏按钮（位于右上角）上的 Command + Click 组合。我仍然想让用户显示和隐藏工具栏，但我不希望他们能够选择不同的显示模式（例如小图标、无图标等）。

有没有人找到办法做到这一点？提前致谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-03T14:26:25.147

您不需要子类 NSToolbar 来执行此操作。在您的 NSWindowController 子类中，将以下内容放入您的 awakeFromNib 中：

```
- (void) awakeFromNib
{
  NSToolbar *tb = [[self window] toolbar];
  [tb setAllowsUserCustomization:NO];
} 
```

您还可以获得避免使用私有 API 的额外好处。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-02T19:56:33.770

您是否尝试过使用覆盖 setDisplayMode: 和 setSizeMode: 的自定义 NSToolbar 子类什么都不做？当然，这不会删除菜单项或自定义表中的 UI（假设您也没有使用 setAllowsUserCustomization 禁用它：），但它可能会阻止它们执行任何操作。

# iphone - iphone 2.x sdk - 对另一个视图控制器内的视图控制器的引用显示为空

> ID：815422
> 
> 赞同：0
> 
> 时间：2009-05-02T19:17:16.127
> 
> 标签：iphone, uiviewcontroller, reference

我正在尝试为自定义选择器视图控制器的新创建实例提供对另一个视图控制器的引用（这是在点击 tableView 行后调用的 ponceViewController 实例的选择器内部）...

```
 - (IBAction)rowTapped:(id)sender {
  TimerPickerViewController *viewController = [[TimerPickerViewController alloc] initWithNibName:@"TimerPickerView" bundle:nil]
  self.timerPickerViewController = viewController;
  timerPickerViewController.ponceViewController = self.rootViewController;
  [viewController release];
} 
```

然后在我的 timerPickerViewController 实例中，我有：

```
- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil {
  if (self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil]) {
    ...
    // ponceViewController is null here
    ... 
  }
}
```

timerPickerViewController 显示得很好，我什至可以在点击“完成”按钮后从 ponceViewController 访问东西，但我正在合成 ponceViewController，它在我的标题和所有内容中，我似乎无法在 timerPickerViewController 的 initWithNibName 中访问它方法 - 它始终为空。：（ 有人有想法么？

编辑：我还应该提到，在 timerPickerViewController 的 viewDidLoad 方法中 ponceViewController 也是 null ......

```
- (void)viewDidLoad {
  ... no such thing as ponceViewController here! ...
}
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-03T04:26:24.480

所以我通过`initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil`从 timerPickerViewController 中完全删除并改用它来修复它`viewDidLoad`。一切似乎都很好。我认为问题在于在内部引用该属性时该属性尚不可用`initWithNibName`。希望对其他人有所帮助。

# c++ - 用于聚类的 C/C++ 机器学习库

> ID：815423
> 
> 赞同：10
> 
> 时间：2009-05-02T19:18:01.613
> 
> 标签：c++, c, cluster-analysis, machine-learning

有哪些支持多维数据聚类的 C/c++ 机器学习库？（例如 K 均值）

到目前为止，我遇到了

*   SGI MLC++ [http://www.sgi.com/tech/mlc/](http://www.sgi.com/tech/mlc/)
*   OpenCV MLL

我很想自己动手，但我敢肯定，预先存在的优化性能要好得多，并且更多地关注代码。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-03T07:05:04.817

东京大学人类基因组团队的[开源 C 聚类库看起来很有希望。](http://bonsai.hgc.jp/~mdehoon/software/cluster/)它具有 K-means 以及其他平面层次聚类算法。在他们的页面中向下滚动以查看没有 GUI 的裸库。[Wikipedia-Clustering 项目](http://wikipedia-clustering.speedblue.org/clustering.php)看起来不错，而且更轻一些。[这是马里兰大学的一个专门的 K-means 图书馆](http://www.cs.umd.edu/~mount/Projects/KMeans/)。我建议您考虑您的数据类型来查看这些。预处理数据以创建特征向量可能具有挑战性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-02T19:22:00.467

我不确定您是否正在寻找 C4.5、ID3 等算法。如果你这样做了，你可以从大学网站上下载他们正在积极研究的各个来源。

例如：C4.5 源代码可以在[Quinlan 的网站上](http://www.rulequest.com/Personal/)找到。

# c# - 单一窗体 Windows 窗体应用程序的设计模式

> ID：815428
> 
> 赞同：2
> 
> 时间：2009-05-02T19:19:42.813
> 
> 标签：c#, winforms, design-patterns

我的应用程序正在扩展，但要求始终只打开一个窗口，想想 Nodepad 那里有一个菜单，每个菜单项都有不同的功能，但始终只打开一个窗口，而不是 Excel用户可能一次打开几个窗口。

因此，就 Windows 窗体而言，我正在考虑在主窗体中放置一个窗体。然后我可以根据用户菜单选择加载所需的嵌入式表单。或者我可以将控件添加到主窗体（以及它们的事件动态取决于用户菜单选择）。我会为此使用演示者课程。

这只是我会使用的两个解决方案。你们有任何关于如何做得更好的提示/经验吗？

我现在意识到我必须重新编写我的应用程序的某些部分，但让我们假设我是从头开始的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-02T20:16:46.373

不要嵌入表单，这不是表单的用途。而且没有必要。

将模块/部分的 UI 放在 UserControls 上。这使它保持良好和模块化，并且您可以保持选项开放：这些 UserControls 可以直接嵌入（一次 1 个）在 MainForm 或 MDI ChildWindows 或 TabPages 中或......

使用基本用户控件（视觉继承）和/或接口来实现通用功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-02T19:25:32.907

听起来您所描述的是[Multiple-Document Interface (MDI) Applications](http://msdn.microsoft.com/en-us/library/aa983667(VS.71).aspx)。幸运的是，WinForms 中对 MDI 有很好的支持。这是一个快速[介绍](http://www.dotnetjunkies.com/quickstart/winforms/doc/WinFormsMDI.aspx)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-02T19:39:07.697

如果您的要求是“一个窗口 - 多种功能”，我当然会选择可组合的 UI 开发风格。[智能客户端软件工厂](http://msdn.microsoft.com/en-us/library/aa480482.aspx)是 imo的一个很好的起点。

# c++ - 是否可以在 C++ 中使用正则表达式？

> ID：815429
> 
> 赞同：5
> 
> 时间：2009-05-02T19:19:56.417
> 
> 标签：c++, c, regex

重复：[在C++中有一个使用模式匹配（使用正则表达式）的函数？](https://stackoverflow.com/questions/329517/there-is-a-function-to-use-pattern-matching-using-regular-expressions-in-c)

我不确定在哪里使用它......是否有任何解析器类型的函数将一些正则表达式作为参数或其他东西？我刚刚发现我的编辑器将 / 之后的一行突出显示为 C/C++ 语法的“正则表达式”，我认为这很奇怪......

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-05-02T19:21:48.407

在 vanilla C++ 语言中，不支持正则表达式。但是，有几个支持正则表达式的库。Boost是一种流行的方法。

查看 Boost 的 Regex 实现。

*   [http://www.onlamp.com/pub/a/onlamp/2006/04/06/boostregex.html](http://www.onlamp.com/pub/a/onlamp/2006/04/06/boostregex.html)
*   [http://www.boost.org/doc/libs/1_39_0/libs/regex/doc/html/boost_regex/syntax.html](http://www.boost.org/doc/libs/1_39_0/libs/regex/doc/html/boost_regex/syntax.html)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-02T19:22:18.920

[PCRE](http://www.pcre.org/)是 C 的事实上的标准正则表达式库（它也适用于 C++）。

（我不知道你的编辑在做什么。使用 PCRE 之类的库或任何其他建议的库都不会改变 C 的语法——你的正则表达式定义将始终保存在字符串中。）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-02T19:30:17.513

请参阅：[在 C++ 中有使用模式匹配（使用正则表达式）的函数吗？](https://stackoverflow.com/questions/329517/there-is-a-function-to-use-pattern-matching-using-regular-expressions-in-c)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-02T19:52:42.453

正则表达式是 TR1 中定义的 C++ 标准库扩展的一部分（[参见文档中的第 7 章](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2005/n1836.pdf)）。dinkumware[库](http://www.dinkumware.com)ie 已经实现了 regEx 扩展。我不知道其他实现。

扩展程序简单易用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-02T19:40:58.113

[Boost.Xpressive](http://boost-sandbox.sourceforge.net/libs/xpressive/doc/html/index.html)允许您将正则表达式编写为字符串（如在[Boost.Regex 中](http://www.boost.org/doc/libs/1_39_0/libs/regex/doc/html/index.html)）或使用表达式模板静态编写。它类似于语法的[Boost.Spirit](http://spirit.sourceforge.net/)。

例如，这两个是等价的：

```
sregex rex1 = sregex::compile("(\\w+) (\\w+)!"); //normal string based way
sregex rex2 = (s1= +_w) >> ' ' >> (s2= +_w) >> '!'; //expression template way 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-02T19:56:14.673

为了完整起见，Qt 有一个[QRegExp](http://doc.trolltech.com/4.5/qregexp.html)可以进行正则表达式匹配。
如果您的大型 Qt 应用程序中的远程功能需要一个小的正则表达式，这通常会很好。对于更严重的事情，PCRE 绝对是要走的路。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-02T20:20:43.883

不，C++ 没有也不会使用某些语言中使用的 /.../ 语法的正则表达式。你的编辑错了。

正如所有其他答案所示，C++ 的正则表达式库确实存在（并且一个计划包含在 C++0x 中），但它们处理由“分隔的字符串，而不是斜线，因此它们不是编辑器行为的原因。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-03T19:38:13.663

如果您使用 Visual Studio 并且可移植性不是主要问题，那么您可以使用名为[CAtlRegExp](http://msdn.microsoft.com/en-us/library/k3zs4axe(VS.80).aspx)的可爱 ATL 工具快速获得结果（无需下载，无需安装） 。它包含完整高效的正则表达式解析和匹配（[在线示例](http://msdn.microsoft.com/en-us/library/6w2611dd(VS.80).aspx)）。不过，还没有将其性能与 BOOST 进行比较。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-02T19:24:29.133

我不认为您可以在不使用某些第三方库的情况下在 C++ 中执行正则表达式。Qt 和 Gtk+/Gtkmm 都带有这些。Visual C++ 2008 也具有这种能力。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-03T17:19:35.573

如果您在 Visual Studio 中，您可以使用 Greta（搜索 greta regex），但我认为它比 boost 慢一点。不过它真的很容易使用。

# assembly - 延续（如在 Smalltalk 中）和中断（如在汇编器中）有什么区别？

> ID：815431
> 
> 赞同：3
> 
> 时间：2009-05-02T19:20:14.370
> 
> 标签：assembly, smalltalk, interrupt, continuations, seaside

我正在努力理解延续的概念（在 Seaside with Smalltalk 中使用）。维基百科的一个片段说：

> “......指的是一流的延续，它是使编程语言能够在任何时候保存执行状态并在程序中稍后返回到该点的结构......”

这难道不是另一种表达汇编程序员在编写中断时会做什么的方式吗？还是我完全错过了重点！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-07T05:53:41.770

延续可以被视为正在运行的进程的快照副本。捕获延续意味着当前进程被复制并放在一边。之后，代码继续正常执行。评估一个延续意味着当前进程被终止，并且复制的进程被恢复到它被捕获的状态。延续通常可以恢复多次。

中断更像是一个协程，其中有两个不同的执行线程（应用程序代码、中断处理程序）相互交错。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-02T23:23:32.960

延续大致相当于 C 中的 setjump/longjump。离开后调用延续（堆栈、标志、寄存器、指令指针等）时，您可以期望上下文保持不变。所以它类似于软件中断调用，除了你不必在处理程序完成后返回（或更准确地说，调用延续）并且延续不是隐式的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-02T19:28:16.020

在某些方面，它们是相似的。但是，延续由程序本身调用，中断通常由计算机上的 CPU 或设备生成。此外，中断更像是一个 C 信号，它只是被调用，然后控制权返回给程序。中断负责保存状态并在之后恢复它。

另外，应该注意的是，您可以很容易地在汇编程序中实现延续。

# c - How to free dynamic allocated variable by SIGTERM?

> ID：815439
> 
> 赞同：0
> 
> 时间：2009-05-02T19:23:52.693
> 
> 标签：c, free, signals, sigterm

I work on code something like this

```
... HEADERS ...

int *var;

void child() {
  ... //some work
  free(var);
  exit(EXIT_SUCCESSFUL);
}

int main(void) {
  ...
  //allocate variable
  var = (int *) malloc(N*sizeof(int));
  ... //work with var

  for(int i; i<PROC_COUNT; i++) {
    pid_t child = fork();
    if(pid == 0) {
      child(); //main function of new proces
      break;
    }
    elseif(pid < 0) {
      //there is enormous problem -> kill every proces
      kill(0, SIGTERM);
      waitpid(0, NULL, 0); //wait for children
      free(var);
      exit(EXIT_FAILURE);
    }

  }
  free(var);
  return EXIT_SUCCESS;
} 
```

When process is forked, all variables are cloned too. In regular case all copies of var are freed.

If there is error by `fork()`, I send signal SIGTERM to all created processes. And I need to write signal handler for SIGTERM which free var and terminate application. However, free() is not `signal safe function` -- so I shouldn`t call it. But how to free() that variable?

A lot of thanks for your answers...

EDIT: valgrind also shows still reacheable variable:

```
==5928== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 15 from 1)
==5928== malloc/free: in use at exit: 20 bytes in 1 blocks.
==5928== malloc/free: 1 allocs, 0 frees, 20 bytes allocated.
==5928== For counts of detected errors, rerun with: -v
==5928== searching for pointers to 1 not-freed blocks.
==5928== checked 49,164 bytes. 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-02T19:29:00.823

I doubt that you need to. Any OS which supports fork(), will also automatically free allocations from malloc() when a process exits, regardless of how it does so (including termination).

There do exist environments where C programs don't run in processes, and where you have to be very careful what you leave lying around at exit. But those environments aren't POSIX, and won't support fork(). They might not support signals, for that matter. If you're writing for any such unusual environment, check your documentation...

If you want to see a clean valgrind report, then you could have the handler stick an event into the child's event loop (or set a flag and post a semaphore, or whatever), and process the event as a clean exit. That's also what you'd do if your program was an interactive application and you wanted to save the user's data on a SIGTERM, assuming your UI framework didn't already translate SIGTERM into an event for you.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-02T19:27:39.533

I may be misunderstanding something, but surely after SIGTERM the whole process will disappear, taking your variable with it?

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-02T20:11:10.740

You could use exec to start the child process from main rather than calling the child() function directly. Use a command line argument to notify the child program to do the work in main. Then the child process will be able to cleanup properly.

# javascript - 将 div 子项扩展到画布的宽度，而不仅仅是视口？

> ID：815443
> 
> 赞同：0
> 
> 时间：2009-05-02T19:25:11.207
> 
> 标签：javascript, html, css

对不起，如果这是一个重复；我还没有发现任何会造成同样问题的问题。

这张截图说明了这个问题，讽刺的是取自[一个 CSS 博客网站](http://nettuts.com/html-css-techniques/solving-5-common-css-headaches/)（它就在文本“为了设置定位上下文”的下方。）我在自己的代码中遇到了同样的问题。

大约在这张图片的中间，有一条带有长注释的线，强制封闭`div`提供水平滚动条（通过`overflow: auto`设置）。如屏幕截图所示，灰色背景的周围线不会拉伸以填充整个宽度父母的画布。相反，它们保持固定在父**视口**的宽度上。（那些背景属于`div`包含单独文本行的 s。）

我在 Firefox 3.1 和 IE8 中看到了这一点（无论 IE7 兼容模式如何。）

是否有任何跨浏览器方法可以强制这些子项`div`拉伸到画布的整个宽度（或者换句话说，将它们的宽度设置为对等体的最大宽度）？我的猜测是“不”，否则该网站的作者会使用它。

[![替代文字](https://i.stack.imgur.com/NafHA.jpg)](https://i.stack.imgur.com/NafHA.jpg)
[（来源：[outofwhatbox.com](http://outofwhatbox.com/images/nettuts-css.jpg)）]

**编辑**：这是一个简单的例子。出于某种原因，滚动条不会在 IE 中显示，但它会在 Firefox 3.1 中显示（并且与我在其他地方看到的行为相同。）

```
Note: The CSS shown here is derived from SyntaxHighlighter
(http://alexgorbatchev.com/), released under GPL 3.

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
  <head>
    <title>sample</title>

<style type="text/css">

.syntaxhighlighter .line.alt1 .content {
    background-color:#FFFFFF !important;
}

.syntaxhighlighter .line .content {
    color:#000000 !important;
    display:block !important;
    font-family: "Consolas","Monaco","Bitstream Vera Sans Mono","Courier New",Courier,monospace;
    font-size: 12pt;
    font-weight: 400;
    color: #000000;
    white-space: nowrap;
}

.syntaxhighlighter .line.alt2 .content {
    background-color:#F0F0F0 !important;
}

.syntaxhighlighter {
    background-color:#E7E5DC !important;
    margin:1em 0 !important;
    padding:1px !important;
    width:497px !important;
    height: auto !important;
}

.line {
    overflow:visible !important;
}

.lines {
    overflow-x:auto !important;
}
 </style>

  </head>
  <body>
<div class="syntaxhighlighter" >
  <div class="lines">
    <div class="line alt1">
      <span class="content">
        <span style="margin-left: 0px ! important;" class="block">
          <code class="plain">this is line 1 </code>
        </span>
      </span>
    </div>
    <div class="line alt2">
      <span class="content">
        <span style="margin-left: 20px ! important;" class="block">
          <code class="plain">this is line 2</code>
        </span>
      </span>
    </div>
    <div class="line alt1">
      <span class="content">
        <span style="margin-left: 40px ! important;" class="block">
          <code class="plain">this is a very very very very very very long line number 3</code>
        </span>
      </span>
    </div>
    <div class="line alt2">
      <span class="content">
        <span style="margin-left: 0px ! important;" class="block">
          <code class="keyword">this is line 4</code>
        </span>
      </span>
    </div>
    <div class="line alt1">
      <span class="content">
        <span style="margin-left: 20px ! important;" class="block">
          <code class="plain">and this is line 5.</code>
        </span>
      </span>
    </div>
  </div>
</div> 
```

**更新**2009/05/14：这是我部署的脚本，基于下面[brianpeiris 的回答](https://stackoverflow.com/questions/815443/expand-div-children-to-width-of-the-canvas-not-just-the-viewport/815549#815549)。如果有人感兴趣，这里是对所需更改的[更详细描述。](http://www.outofwhatbox.com/blog/2009/05/fixing-a-scroll-where-the-grays-came-in/)

```
// Ensure that each content <span> is sized to fit the width of the scrolling region.
// (When there is no horizontal scrollbar, use the width of the parent.)
fixContentSpans : function() {
    jQuery('.syntaxhighlighter > div.lines').each(function(){
        var container = jQuery(this);
        var scrollWidth = this.scrollWidth;
        var width = jQuery(this).width();
        var contents = container.find('.content');
        jQuery(contents).each(function(){
            var child = jQuery(this);
            var widthAvail = 
                scrollWidth - parseFloat(child.css("margin-left"))  
                - parseFloat(child.css("padding-left"))
                - parseFloat(child.css("padding-right"));
            var borderLeft = parseFloat(child.css("border-left-width"));
            // IE uses names (e.g. "medium") for border widths, resulting in NaN
            // when we parse the value.  Rather than trying to get the numeric
            // value, we'll treat it as 0\. This may add a few additional pixels 
            // in the scrolling region, but probably not enough to worry about.
            if (!isNaN(borderLeft)) {
                widthAvail -= borderLeft;
            }
            child.width(widthAvail);
        });
    });
}, 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-02T20:27:49.980

如果您不介意一点 jQuery，请在 nettuts+ 网站上的 Firebug 中运行以下代码来解决问题。

```
$('.dp-highlighter').each(function(){
  var container = $(this);
  if(this.scrollWidth !== $(this).width()) {
    container.children().each(function(){
      var child = $(this);
      var childPaddingLeft = parseInt(child.css('paddingLeft').slice(0, -2));
      child.width(container.get(0).scrollWidth - childPaddingLeft);
    });
  }
}); 
```

**编辑：**似乎也适用于 IE7/8。

**进一步编辑：** 这是修复您提供的代码所需的 JavaScript：

```
$('.syntaxhighlighter > div').each(function(){
  var container = $(this);
  if(this.scrollWidth !== $(this).width()) {
    container.find('.content').each(function(){
      var child = $(this);
      child.width(container.get(0).scrollWidth);
    });
  }
}); 
```

## 演示

我已经通过 JavaScript 修复将您的代码托管在 JS Bin 上：http: [//jsbin.com/axeso](http://jsbin.com/axeso)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-02T20:13:40.280

我认为没有办法将 div 拉伸为整个宽度。问题是文本实际上并不在 div 内。它溢出到行的 div 之外（包含阴影）

一种解决方案是使用表格。使用表格行来保存源代码的每一行。

以下是代码示例。第一个容器使用 div，第二个使用表格。

```
<style>
    .container {
        width: 300px;
        overflow: auto;
    }
    .lineA {
        height: 20px;
        overflow: visible;
    }
    .lineB {
        height: 20px;
        background-color: #888888;
        overflow: visible;
    }
</style>

<div class="container">
    <div class="lineA">Hello World</div>
    <div class="lineB">Hello World</div>
    <div class="lineA">Hello World</div>
    <div class="lineB">Hello World</div>
    <div class="lineA">Really&nbsp;Long&nbsp;Line.&nbsp;Really&nbsp;Long&nbsp;Line.&nbsp;Really&nbsp;Long&nbsp;Line.&nbsp;Really&nbsp;Long&nbsp;Line.&nbsp;Really&nbsp;Long&nbsp;Line.&nbsp;Really&nbsp;Long&nbsp;Line.</div>
    <div class="lineB">Hello World</div>
</div>

<div class="container">
<table>
    <tr><td class="lineA">Hello World</td></tr>
    <tr><td class="lineB">Hello World</td></tr>
    <tr><td class="lineA">Hello World</td></tr>
    <tr><td class="lineB">Hello World</td></tr>
    <tr><td class="lineA">Really&nbsp;Long&nbsp;Line.&nbsp;Really&nbsp;Long&nbsp;Line.&nbsp;Really&nbsp;Long&nbsp;Line.&nbsp;Really&nbsp;Long&nbsp;Line.&nbsp;Really&nbsp;Long&nbsp;Line.&nbsp;Really&nbsp;Long&nbsp;Line.</td></tr>
    <tr><td class="lineB">Hello World</td></tr>
</table>
</div> 
```

这是一个屏幕截图：

[替代文字 http://img354.imageshack.us/img354/9418/csstest.png](http://img354.imageshack.us/img354/9418/csstest.png)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-02T21:18:26.410

刚刚对此进行了测试，它似乎可以工作，甚至可以回到 ie6。

```
#wrapper{width:300px; height:100px;border:1px solid black; overflow:auto;position:relative;}
#inner{width:auto;position:absolute;}
.content{white-space:pre;height:20px;width:auto;overflow:show;}
.alt {background:gray;}

<div id="wrapper">
<div id="inner">
    <div class="content">content content content content content content content content content </div>
    <div class="content alt">content content content content content content content content content </div>
</div>
</div> 
```

一个缺点是您必须指定包装器的高度，否则整个东西会垂直折叠。您可以使用 javascript 来解决这个问题（包装器高度 = 内容 div 的数量 * 内容 div 的高度）。

# php - C# Web 服务器：实现动态语言

> ID：815446
> 
> 赞同：0
> 
> 时间：2009-05-02T19:25:41.940
> 
> 标签：php, asp.net, python, webserver

我刚刚用 C# 编写了一个 Web 服务器。它非常基础，目前只提供静态内容，如 html、xml 和图像。但是，我想实现一种动态语言。我正在尝试在以下之一之间进行选择：

*   ASP.NET
*   PHP
*   Python

我更喜欢实现 PHP 或 Python，因为我对它们更熟悉，但是我想实现可能最简单的那个。我将如何将此功能添加到我的服务器，这三种语言中的哪一种最容易实现？

编辑：这不是关于我想用什么语言进行网络编程，而是关于我想让使用服务器程序的人使用什么语言。我希望服务器能够为用任何一种 asp 编写的应用程序提供服务。网络、PHP 或 Python。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-02T19:26:54.183

ASP.NET 肯定是最简单的，因为您可以使用所有内置类。本质上您不需要构建它，只需将它连接到 Web 服务器（我不知道我们是否可以将其算作*编写*ASP.NET ；））

您可能想查看[Cassini 源代码](http://blogs.msdn.com/dmitryr/archive/2006/03/09/548131.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-02T19:31:51.783

你考虑过嘘吗？它有一个非常可配置的编译器，并且有一些很好的 OSS 示例（例如 Monorail 和 ASP.NET MVC 的盲文视图引擎）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-02T20:28:46.763

如果你实现了一个 cgi 接口，你可以使用任何类型的后端语言。如果你想变得花哨，你可以考虑研究 fastcgi。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-02T19:56:27.950

也许你应该看看[IronPython](http://www.codeplex.com/Wiki/View.aspx?ProjectName=IronPython)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-02T20:09:30.430

好吧，看起来你这样做是一种学习体验，毕竟微软已经为 Windows (IIS) 提供了一个 Web 服务器。

类似的 PHP 已经移植到[Windows](http://www.php.net/downloads.php)上，你可以直接使用那个移植。类似地，您可以将其用作“参考实现”并编写自己的 PHP 用于 Windows 的实现。

无论哪种方式，它都会允许您的 Web 服务器托管许多现有的应用程序，例如 Wordpress 等。

# jquery - 需要优化jQuery函数

> ID：815448
> 
> 赞同：0
> 
> 时间：2009-05-02T19:26:31.533
> 
> 标签：jquery, optimization

1套：

```
$('#tabs li:first-child').addClass('first-child');
$('.photos li:first-child').addClass('first-child');
$('#alphabet li:first-child').addClass('first-child'); 
```

2套：

```
$(function(){
    $("#header-thumbs img").fadeTo("fast",1);
    $("#header-thumbs img").hover(function(){
        $(this).fadeTo("fast",.7)},function(){
        $(this).fadeTo("fast",1)})});
$(function(){$(".catalog dt img").fadeTo("fast",1);
    $(".catalog dt img").hover(function(){
        $(this).fadeTo("fast",.7)},function(){
        $(this).fadeTo("fast",1)})});
$(function(){$(".photos li img").fadeTo("fast",1);
    $(".photos li img").hover(function(){
    $(this).fadeTo("fast",.7)},function(){
    $(this).fadeTo("fast",1)})}); 
```

**是否可以针对更少的代码进行优化？**

* * *

感谢[Paolo Bergantino](https://stackoverflow.com/users/16417/paolo-bergantino)的帮助，结果是：

优化和打包的第一组（540->171）：

```
$(function(){$("#header-thumbs, .catalog dt, .photos li").find("img").fadeTo("fast",1).hover(function(){$(this).fadeTo("fast",.7)},function(){$(this).fadeTo("fast",1)})}); 
```

第二组（158->78）：

```
$('#tabs, .photos, #alphabet').find('li:first-child').addClass('first-child'); 
```

使用[Dean Edwards](http://dean.edwards.name/packer/)封隔器

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-02T19:35:14.100

在处理元素集和 CSS/Javascript 时，通常的做法是尽可能为它们提供一个相似的类，以使它们更易于使用。然后你可以这样做：

```
$('.mysimilarclass li:first-child').addClass('first-child'); 
```

如果这不是一个选项，您也可以将所有选择器聚合为一个：

```
$('#tabs, .photos, #alphabet').find('li:first-child').addClass('first-child'); 
```

对于第二组同样适用。您可以将它们全部“分组”到一个类中，或者只是聚合所有您想要的选择器，然后只从它们中找到图像。另外，您可以利用 jQuery 的链接来不多次查询 DOM：

```
$(function(){
    $("#header-thumbs, .catalog dt, .photos li")
     .find("img")
     .fadeTo("fast", 1)
     .hover(function() {
         $(this).fadeTo("fast", .7);
     }, function() {
         $(this).fadeTo("fast", 1);
     });
}); 
```

此外，如果可能的话，最好总是在选择器中添加预期具有类的元素。因此，`.photos li`最好不要这样做，`ul.photos li`否则任何元素都将具有`photos`. 当然，这并不总是可能的，但无论何时都是可取的。

# .net - 以原生方式和 XBAP 双重部署 WPF 应用程序

> ID：815461
> 
> 赞同：2
> 
> 时间：2009-05-02T19:37:11.570
> 
> 标签：.net, wpf, deployment, xbap

如何创建一个 WPF 应用程序，该应用程序可以部署为 XBAP 或本地 Windows 应用程序，并且开销尽可能少？XBAP 与 WPF Windows 应用程序二进制兼容，并在相同的 CLR 之上运行（与 Silverlight 不同）。它们在某些方面仍然不同。

从部署的角度来看，它们最大的区别是 XBAP 有一个 Page 控件作为主容器，而 Windows 应用程序有一个 Window 控件。让 Windows 应用程序使用 Page 控件相当简单，但我觉得（尽管不同意）在 Windows 应用程序中使用 Page 导航方法是相当不直观的。

第二个主要区别是默认情况下 XBAP 在部分受信任的环境中执行。不过，这可以绕过，XBAP 可以在完全信任模式下运行。XBAP 的部分信任模式意味着您不能直接从 XBAP 访问远程 Web 服务或本机代码。

对于上述问题，实现以下目标的简单且可维护的方法是什么？

**要求**

1.  可通过两种方式部署：作为基于 http 的 XBAP 和作为独立的 WPF 可执行文件。
2.  显示来自远程 Web 服务器（如 flickr）或通过非托管 API 的信息。
3.  如果可能，部署方法应该忠实于他们的平台。也就是说：使用 XBAP 中有意义的页面和 Windows 应用程序中有意义的对话框。

**限制**

1.  平台优化。XBAP 所需的东西不应影响 Windows 客户端，反之亦然。
2.  部署选项共享尽可能多的代码。这有助于测试和维护。
3.  运行 XBAP 应该尽可能简单。证书前置要求会破坏 XBAP 的目的。

我收集到的是第一个要求需要两个单独的项目。第二个限制可以通过拥有一个包含所有 UI 并被两个部署项目引用的用户控件项目来解决。WCF Web 服务可以解决 XBAP 的限制。

如果采用类似于上述行的解决方案，则第一个限制将需要一些工作，因为 Windows 客户端可以在没有 WCF 服务的情况下完成，因为它已经在完全信任模式下运行。第三个要求还需要一些特定于部署的代码，因此所有 UI 代码都不能在用户控件项目中。

我想知道可以使用哪些解决方案来解决这些问题。随意忽略部分解决方案。它主要是为了解释这一点并防止“已经想到这一点”的评论。所以澄清一下，我对这个问题的**所有**解决方案都感兴趣，而不仅仅是那些遵守部分解决方案的解决方案。

对此感兴趣的原因是，解决方案意味着无需在 WPF Windows 应用程序和 XBAP 之间进行考虑，因为这两者都可以轻松创建，并且客户可以选择最适合他们的那个。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-12T21:45:40.597

[这篇 scorbs 文章](http://scorbs.com/2006/06/04/vs-template-flexible-application/)解释了如何做到这一点，它甚至有一个应用程序模板来做到这一点。

[![替代文字](https://i.stack.imgur.com/iiHew.png)](https://i.stack.imgur.com/iiHew.png)
[（来源：[scorbs.com](http://scorbs.com/vstemplates/flowchart.PNG)）]

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-02T22:42:14.697

您可能想看看 Prism（[在 codeplex 上](http://compositewpf.codeplex.com/)）它有助于以最少的代码更改定位 Wpf、Xbap 和 Silverlight（额外工作量取决于您的项目）。

以下是如何使用它来创建 Wpf 和 Xbap 应用程序：[Prism 和 XBap 应用程序](http://mokosh.co.uk/post/2008/09/29/prism-and-wpf-browser-application-xbap/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-01-01T09:22:20.900

多年来，我尝试了几种方法。对我来说效果最好的一个是在一个解决方案中包含四个项目：

*   构建包含业务对象、通信和 UI 的 dll 的主项目。
*   包含手动和自动单元测试的测试项目
*   用于 Windows 应用程序的小型 .exe 项目
*   一个很小的 ​​.xbap 项目

在主项目中既没有 Pages 也没有 Windows，只有 UserControls 和自定义控件。还有一个用于显示 UI 的服务类。此类是 Windows 和 XBAP 项目中的子类，以更改事物的显示方式。在每种情况下，子类都会在应用程序启动时安装在静态属性中。所有其余的代码只是简单地引用这个静态属性并调用它的方法。这些方法执行 Windows 和 XBAP 应用程序之间不同的服务。

例如，我的服务类有一个“ShowDialog”方法，它接受一个 FrameworkElement 并以对话框样式显示它，或者作为窗口（对于 Windows 应用程序）或作为页面上的弹出窗口（对于 XBAP）。

使用这种技术可以在 Windows 应用程序和 XBAP 之间实现大约 98% 的代码共享。

我的主应用程序还定义了一个客户端-服务器接口，并将 WCF 属性应用于其数据对象。所有代码都使用一个静态属性来访问服务。此静态属性被初始化（在类构造函数中）为具体实现类的实例，但 XBAP 项目中的启动代码将其替换为 WCF 客户端，因此 XBAP 运行客户端-服务器，Windows 应用程序实际上是本地来电。在每种情况下，它都是服务器端完全相同的对象。

因为我将 WCF 实现为一个接口，所以我只需要一个用于 WCF 服务端的简单 .svc 文件就可以逃脱，并且不需要单独的代码生成或代理/存根代码中的链接。

# c# - 在实体框架中获取新记录的身份列？

> ID：815462
> 
> 赞同：2
> 
> 时间：2009-05-02T19:38:20.303
> 
> 标签：c#, entity-framework, stored-procedures

任何人都可以帮忙吗？我一直在使用实体框架并且进展顺利:-)

但是我刚刚使用这样的实体类添加了一条新记录

this._entities.AddToUsers(user);

AddTo 是自动创建的......用户是我的表......一切都很好，但我如何返回标识列？

听起来就像我需要的，而不是调用存储过程，我之前确实有一个存储过程 -

我想我可以继续使用存储过程，但这意味着我必须将我的 User 实体类转换为 Sql 参数。

我正在使用 EFExtensions。

一旦添加，我是否需要调用 SaveChanges 或其他什么？

有任何想法吗 ？？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-02T19:46:51.327

是的，AddToUsers 仅将您的对象添加到内存中的实体上下文中 - 它尚未保存在磁盘上，因此尚未分配您的新标识值。

只有调用 .SaveChanges() 才会真正将更改写入数据库 - 然后并且只有这样，才会生成标识值（如果您的字段是 INT IDENTITY 类型）。

马克

# c# - 在 ASP.NET MVC 中解决整个页面缓存的方法

> ID：815465
> 
> 赞同：4
> 
> 时间：2009-05-02T19:39:59.097
> 
> 标签：c#, asp.net-mvc

目前 ASP.NET MVC 的 OutputCache 属性有一个巨大的下降。如果要缓存站点的某些部分，则必须使用解决方法，因为 MVC 所依赖的 ASP.NET 管道的限制。

假设您有一个页面，其中包含您通过 RenderAction 显示的统计模块，您不能开箱即用地缓存页面的那部分。

我的问题是，您找到了哪些优雅且易于使用的方法来解决这个限制？我个人发现其中两个我都不是特别满意。尽管它们可以工作，但在围绕它们构建应用程序时似乎只是感觉不对。

解决方案 1 - 子控制器 [http://mhinze.com/subcontrollers-in-aspnet-mvc/](http://mhinze.com/subcontrollers-in-aspnet-mvc/)

解决方案 2 - 部分请求 [http://blog.codeville.net/2008/10/14/partial-requests-in-aspnet-mvc/](http://blog.codeville.net/2008/10/14/partial-requests-in-aspnet-mvc/)

因此，如果您有另一种解决方案，或者甚至有一种优雅地使用这些解决方案的方式，我会喜欢一些关于设计和/或使用的想法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-02T20:23:27.400

我已经使用选项 2（使用 Html.RenderAction）完成了这项工作，并取得了相当大的成功。我还为我的控制器创建了不同的基类，一个缓存，一个不缓存，以便我将所有缓存的操作放在一个地方。我不经常这样做，因此隔离这些操作并不算太糟糕。通过结合缓存和我编写的 GZip 压缩过滤器，我从 MVC 中获得了非常出色的性能。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-02T20:51:49.283

在某些情况下，最好不要使用 ASP.NET OutputCache 功能。而是在您的业务/服务层中使用缓存和可选的 gzip 压缩。有时这种组合甚至比完全输出缓存还要快。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-02T20:10:01.927

如何使用 jQuery 通过 ajax 加载一些区域（div 等）。然后您可以将不同的区域缓存为完整的请求，具有不同的粒度。

# objective-c - 如何移动 QTMovie 的光标？

> ID：815468
> 
> 赞同：1
> 
> 时间：2009-05-02T19:41:02.603
> 
> 标签：objective-c, cocoa, macos, quicktime

我有一组具有 QTTime 结构作为属性的对象。对象位于绑定到 NSTableView 的 NSArrayController 中。我将 QTMovieView 设置为 IBOutlet。I want to have it such that when an item in the NSTableView is selected the QTMovieView's cursor is moved to the time indicated in the selected objects QTTime attribute. 有没有一种方法可以让我将 QTMovie 的当前时间点移动到 QTTime？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-02T21:29:29.537

你试过[setCurrentTime:](http://developer.apple.com/documentation/QuickTime/Reference/QTKitFramework/Classes/QTMovie_Class/Reference/Reference.html#//apple_ref/occ/instm/QTMovie/setCurrentTime:)吗？

# objective-c - 如何获取给定路径的文件大小？

> ID：815471
> 
> 赞同：69
> 
> 时间：2009-05-02T19:43:11.740
> 
> 标签：objective-c, cocoa, macos

我有一个包含在 NSString 中的文件路径。有没有办法获取它的文件大小？

* * *

## 回答 #1

> 赞同：138
> 
> 时间：2011-03-06T17:19:26.960

这一个班轮可以帮助人们：

```
unsigned long long fileSize = [[[NSFileManager defaultManager] attributesOfItemAtPath:someFilePath error:nil] fileSize]; 
```

这将返回以字节为单位的文件大小。

* * *

## 回答 #2

> 赞同：74
> 
> 时间：2009-11-10T12:54:54.697

请记住，从 Mac OS X v10.5 开始不推荐使用 fileAttributesAtPath:traverseLink:。改用`attributesOfItemAtPath:error:`，在[相同的 URL](http://developer.apple.com/mac/library/documentation/Cocoa/Reference/Foundation/Classes/NSFileManager_Class/Reference/Reference.html#//apple_ref/occ/instm/NSFileManager/attributesOfItemAtPath:error:) thesamet 中描述。

需要注意的是，我是 Objective-C 新手，并且我忽略了调用中可能发生的错误`attributesOfItemAtPath:error:`，您可以执行以下操作：

```
NSString *yourPath = @"Whatever.txt";
NSFileManager *man = [NSFileManager defaultManager];
NSDictionary *attrs = [man attributesOfItemAtPath: yourPath error: NULL];
UInt32 result = [attrs fileSize]; 
```

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2015-02-28T08:49:16.367

如果有人需要 Swift 版本：

```
let attr: NSDictionary = try! NSFileManager.defaultManager().attributesOfItemAtPath(path)
print(attr.fileSize()) 
```

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2012-06-27T12:31:28.783

[CPU 使用 attributesOfItemAtPath:error:](https://stackoverflow.com/questions/10580422/cpu-raises-with-attributesofitematpatherror)
你应该使用[stat](http://developer.apple.com/library/mac/#documentation/Darwin/Reference/ManPages/man1/stat.1.html)引发。

```
#import <sys/stat.h>

struct stat stat1;
if( stat([inFilePath fileSystemRepresentation], &stat1) ) {
      // something is wrong
}
long long size = stat1.st_size;
printf("Size: %lld\n", stat1.st_size); 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2017-09-28T13:26:34.477

如果您只想使用带有字节的文件大小，

```
unsigned long long fileSize = [[[NSFileManager defaultManager] attributesOfItemAtPath:yourAssetPath error:nil] fileSize]; 
```

**[NSByteCountFormatter](https://developer.apple.com/documentation/foundation/nsbytecountformatter)**文件大小的字符串转换（来自字节）与精确的 KB、MB、GB ......它的返回类似于`120 MB`或`120 KB`

```
NSError *error = nil;
NSDictionary *attrs = [[NSFileManager defaultManager] attributesOfItemAtPath:yourAssetPath error:&error];
if (attrs) {
    NSString *string = [NSByteCountFormatter stringFromByteCount:fileSize countStyle:NSByteCountFormatterCountStyleBinary];
    NSLog(@"%@", string);
} 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2013-05-20T14:00:55.103

按照 Oded Ben Dov 的回答，我宁愿在这里使用一个对象：

```
NSNumber * mySize = [NSNumber numberWithUnsignedLongLong:[[[NSFileManager defaultManager] attributesOfItemAtPath:someFilePath error:nil] fileSize]]; 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2016-03-28T16:47:02.210

斯威夫特 2.2：

```
do {
    let attr: NSDictionary = try NSFileManager.defaultManager().attributesOfItemAtPath(path)
    print(attr.fileSize())
} catch {
        print(error)
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2016-08-02T05:59:12.253

它将以字节为单位提供文件大小...

```
uint64_t fileSize = [[[NSFileManager defaultManager] attributesOfItemAtPath:_filePath error:nil] fileSize]; 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-03-03T13:52:26.037

斯威夫特4：

```
 let attributes = try! FileManager.default.attributesOfItem(atPath: path)
        let fileSize = attributes[.size] as! NSNumber 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-08-27T09:37:02.720

在 Swift 3.x 及更高版本中，您可以使用：

```
do {
    //return [FileAttributeKey : Any]
    let attr = try FileManager.default.attributesOfItem(atPath: filePath)
    fileSize = attr[FileAttributeKey.size] as! UInt64

    //or you can convert to NSDictionary, then get file size old way as well.
    let attrDict: NSDictionary = try FileManager.default.attributesOfItem(atPath: filePath) as NSDictionary
    fileSize = dict.fileSize()
} catch {
    print("Error: \(error)")
} 
```

# windows-vista - 如何在 Windows Vista 家庭版上授予 SeCreateSymbolicLink

> ID：815472
> 
> 赞同：6
> 
> 时间：2009-05-02T19:43:20.837
> 
> 标签：windows-vista, ntfs, symlink, rights-management

我希望能够使用 mklink 在我的 Windows Vista 家庭版计算机上创建符号链接。

但是，我必须先授予 SeCreateSymbolicLink，然后 mklink 才能在 Vista 家庭版上运行（默认情况下，该权利被撤销）。

家庭版不提供 UI 或工具工具来授予/撤销谨慎的权利。

NTFS 符号链接上的[维基百科链接](http://en.wikipedia.org/wiki/NTFS_symbolic_link)说，Windows Server 2003 资源工具包工具中的 ntrights.exe 工具可用于在家庭版中授予此权限。但是，安装这些工具后，事实证明这是不正确的。该版本的 ntrights.exe 无法识别 SeCreateSymbolicLink，并且 Microsoft 的网站没有显示任何可用于此特定资源工具包工具的更新。

是否有 PowerShell 脚本方法来执行此操作？或者任何其他可以在 Vista Home 版上使用的工具/技术？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-02T20:33:14.553

[polsedit](http://polsedit.southsoftware.com/)

[![替代文字](https://i.stack.imgur.com/nwRNu.jpg)](https://i.stack.imgur.com/nwRNu.jpg)
[（来源：[southsoftware.com](http://polsedit.southsoftware.com/screenshot.jpg)）]
*“Polsedit 是一个免费软件实用程序，它允许您修改用户策略，例如本地或远程基于 Windows NT 的系统上的用户帐户权限和用户权限。当您由于某种原因无法ro 运行 secpol.msc 管理单元，例如 XP Home 和 Vista Home 根本没有 secpol.msc。Polsedit 的用户界面与 Windows 的标准策略编辑器非常相似，但它也显示了一些内部数据，这对开发人员很有用。”*

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-01-18T11:01:58.697

如何运行`secpol.msc`并向组或用户授予`Create symbolic links`权限。默认情况下，此权限仅授予`Administrators`组。

从编程方面来看，您需要`SE_CREATE_SYMBOLIC_LINK_NAME`特权或其文本变体：`SeCreateSymbolicLinkPrivilege`. 更多细节在[msdn](http://msdn.microsoft.com/en-us/library/bb530716(VS.85).aspx)

[secpol.msc - 创建符号链接权限 http://blog.i18n.ro/wp-content/uploads/2010/01/policy_create_symbolic_links.png](http://blog.i18n.ro/wp-content/uploads/2010/01/policy_create_symbolic_links.png)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2022-01-07T09:20:23.843

对于**德语**安装

*   `Win`+ `r`gpedit.msc
*   找到“Computerkonfigurationen\Windows-Einstellungen\Sicherheitseinstellungen\Lokale Richtlinien\Zuweisen von Benutzerrechten”
*   将用户添加到“Erstellen symbolischer Verknüpfungen”

# objective-c - 您如何获得类似于 Spotlight 或 iTunes 的搜索功能？

> ID：815480
> 
> 赞同：1
> 
> 时间：2009-05-02T19:48:14.070
> 
> 标签：objective-c, cocoa, macos, search, spotlight

我有一个 NSTableView，其中包含一些填充了数据的列。如何设置可以根据特定列的内容过滤行的搜索栏？我正在寻找使用 Finder 中的 Spotlight 或 iTunes 中的搜索栏可以按元数据过滤歌曲的类型。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-03T14:13:09.203

“Spotlight”功能实际上是通过 SearchKit API 提供给您的，尽管对于像您描述的 NSPredicate 这样的简单情况可能是更好的选择。不过，如果有人感兴趣，我为 CocoaHeads 写了一个 SearchKit 演示文稿，你可以[看看这里](http://blog.mbcharbonneau.com/2009/02/26/searchkit-example-project/)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-02T20:49:13.737

你的数据源可以由 NSArrayController 管理吗？

有两种[标准](http://developer.apple.com/documentation/Cocoa/Conceptual/CocoaBindings/Tasks/filtering.html)方法。第一种（Tiger 之前的）技术是继承 NSArrayController 的子类，覆盖排列对象。第二个（后Tiger）是将NSSearchField 的谓词绑定到NSArrayController 的filterPredicate。在任何一种情况下，将您的视图属性绑定到控制器的`arrangedObject`键（例如，将“名称”NSTableColumn 绑定到控制器的`arrangedObjects.name`键并将 NSTableView 的内容绑定到`arrangedObjects`）。您可能想阅读有关[编写谓词](http://developer.apple.com/documentation/Cocoa/Conceptual/Predicates/predicates.html)的内容。

# .net - 帮助我开始制作文件 -> Vista 中的右键单击上下文菜单

> ID：815483
> 
> 赞同：0
> 
> 时间：2009-05-02T19:50:04.953
> 
> 标签：.net, windows, filesystems, contextmenu, right-click

我是新手 .Net 2.0 和 3.5 开发人员。我想创建一个在 Vista 中右键单击文件时创建上下文菜单的应用程序。右键单击后——我想我可以弄清楚其余的，但我不知道访问 Vista API 的技术。

跟进：

当我一直在阅读人们回应的一些信息时，我发现我在这里使用 shell 扩展有点矫枉过正。如果我只是调用我的应用程序并将文件名作为参数传递，我想我可以让这个项目变得更简单。当右键单击具有某些扩展名的文件时，这仍然需要我的应用程序出现在资源管理器的上下文菜单中。我该怎么做呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-02T20:08:08.763

由于听起来无济于事，我建议不要在 .Net 2.0 或 3.5 中这样做。正如布赖恩所说，您要实现的东西是外壳扩展。这些实现为 Vista shell 加载的库。

虽然网络上有几个教程给出了在 .Net 2.0 中实现这些的说明，但其中很少有人提到这是多么糟糕的主意。如果你让 Vista shell 加载一个 .Net shell 扩展，它会被迫加载你的 shell 扩展需要的整个 .Net CLR。更糟糕的是，您只能在一个进程中加载​​完整的 .Net CLR 的一个版本。因此，如果您有一个需要 .Net 1.0 CLR 的 shell 扩展并且 Vista 已经加载了它，它就无法加载您的 shell 扩展所需的 2.0 CLR。

Also there are some [Stack Overflow articles](https://stackoverflow.com/questions/117651/how-can-i-create-my-custom-shell-context-handlers-for-windows) already discussing this.

Some information on [implementing a shell extension in unmanaged C++](http://www.kbcafe.com/articles/HowTo.Shell.pdf) (KBCafe PDF, couldn't find a simple html link)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-02T19:58:20.550

您尝试编写的东西称为“shell 扩展”。我从来没有写过，所以我不能给你一个简单的例子，但现在你知道它叫什么，你可能可以通过在谷歌上搜索教程来取得更大的进步。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-02T20:07:41.200

我相当肯定您不允许在任何版本的 Windows 中使用托管代码为资源管理器编写 shell 扩展。所以如果你想写一个，你需要用一种“传统”的语言来写，比如 C++。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-02T20:08:00.217

[您需要一个*Context Menu Shell Extension*](http://chestermr.blogspot.com/2007/03/shell-extension-context-menu.html)，现在要记住的一件事是您**[不允许在 .net 中编写它们](http://blogs.msdn.com/oldnewthing/archive/2006/12/18/1317290.aspx)**（旧的新事物博客）。
您可以尝试编写进程外扩展（骨架是非托管的，它通过 IPC 调用托管服务）但我没有看到有人这样做。

# excel - 在 SSIS 中从 Excel 导入数据，空值

> ID：815493
> 
> 赞同：2
> 
> 时间：2009-05-02T19:56:59.040
> 
> 标签：excel, ssis

我正在使用 SSIS 将 Excel 工作表中的数据导入 SQL Server 2005，数据包含一些列，其中的数据应该具有同一列中前一个非空单元格的值，它看起来像这样：

```
2005 | 15 | Something1
     | 12 | Something2
     | 14 | Something3
2006 | 10 | Something4
     |  2 | Something5
     | 18 | Something6
     | 15 | Something7 
```

它应该填写 2005 年和 2006 年，但我能得到的只是空值。如果该字段的值不为空，我可以将其放入变量中，并使用它来替换它之后的空值吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-02T20:00:34.260

您必须在数据流中使用脚本组件并遍历每一行，使用变量来保存最后一个已知值。

更新：这是代码。我在 SSIS 2008 的 VB 中执行此操作，因此您可能需要进行一些编辑（例如，您可能必须使用 Dts.Variables["User::LastYear"].Value.ToInt32() 而不是 Variables.LastYear ——我不记得了）：

```
Dim LastYear As Integer

Public Overrides Sub PreExecute()
    MyBase.PreExecute()
    LastYear = 0
End Sub

Public Overrides Sub Input0_ProcessInputRow(ByVal Row As Input0Buffer)
    If Row.year_IsNull Then
        Row.year = LastYear
    Else
        LastYear = Row.year
    End If
End Sub 
```

希望这会有所帮助！

# java - IntelliJ 上的 Google App Engine Java 开发？

> ID：815499
> 
> 赞同：13
> 
> 时间：2009-05-02T20:00:44.990
> 
> 标签：java, google-app-engine, intellij-idea

令人讨厌的是，Google App Engine 已成为另一个只发布 Eclipse 插件（如 Spring Webflow）的项目，而我更喜欢 IntelliJ。你能用 IntelliJ 成功运行本地测试环境吗？并调试/部署本地或实时应用程序？如果是这样，Eclipse 版本中是否缺少任何功能？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-02T20:09:21.150

是的，您可以配置 IntelliJ 以运行本地应用程序引擎。有一个带有分步说明 的[博客条目。](http://www.gridshore.nl/2009/04/08/java-on-google-app-engine-with-intellij/)

Eclipse插件的区别

*   不启动浏览器
*   没有自动神奇地运行数据核增强
*   没有部署到 Google 按钮。

您可以通过使运行目标依赖于 datanucleusenhance ant 任务来解决数据核增强问题。另外两个太小了，我没有费心去自动化它们。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-05T11:42:58.423

用于 Google App Engine 集成的 IntelliJ 插件[http://plugins.intellij.net/plugin/?id=4254](http://plugins.intellij.net/plugin/?id=4254)

# java - Dom4j 规则与所有预期节点不匹配

> ID：815503
> 
> 赞同：2
> 
> 时间：2009-05-02T20:03:23.627
> 
> 标签：java, xml, xslt, dom4j

如果预定义的模式 //authorize 与以下 xml 片段中的元素匹配，我将使用 dom4j 的规则 api 来触发操作。

```
 <authorize role_required="admin">
        <node title="node which is visible only to admin" path="" >
            <authorize role_required="admin">
                <node title="node which is visible only to admin" path=""/>
            </authorize>
            <authorize role_required="admin">
                <node title="node which is visible only to admin" path="">
                    <authorize role_required="admin">
                    </authorize>
                        <node title="node which is visible only to admin" path=""/>
                </node>
            </authorize>
        </node>
    </authorize>
    <authorize role_deny="admin">
        <node title="Node which is not visible to admin" path=""/>
    </authorize> 
```

不幸的是，它似乎不适用于嵌套元素，只能找到第一级的授权元素。该动作仅触发两次，但有 5 个授权元素。有人知道如何解决这个问题吗？提前致谢。

我尝试将授权标签与以下规则匹配：

```
 Rule authorizationRule = new Rule();
 authorizationRule.setPattern( DocumentHelper.createPattern( "//authorize" ) );
 authorizationRule.setAction( new AuthorizationRule() );

this.stylesheet = new Stylesheet();

this.stylesheet.addRule(authorizationRule);
this.stylesheet.run(document); 
```

该规则在第一层的元素上匹配两次。我用 document.selectNodes 方法交叉检查了 XPath 模式，得到了所有五个元素。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-03T19:53:07.577

你的规则有这条线吗？

```
stylesheet.applyTemplates(node); 
```

请记住，您的规则控制下降到更深的元素。

似乎模式不是用于选择元素，而是用于在遍历树时检查元素是否匹配。如果元素与模式匹配，则调用您的操作，但您有责任在子元素中继续。如果不这样做，则会跳过子元素。

（免责声明：我的理解可能是错误的，我没有使用 dom4j，只是看了[cookbook](http://www.dom4j.org/dom4j-1.6.1/cookbook.html)）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-03T20:54:06.557

我认为[彼得解决了这个问题](https://stackoverflow.com/questions/815503/dom4j-rule-does-not-match-all-expected-nodes/817842#817842)；我只是建立在他的回答之上。

Thomas 的代码示例中的这一行有点令人困惑：

```
 authorizationRule.setAction( new AuthorizationRule() ); 
```

...除非 AuthorizationRule 是[Action](http://www.dom4j.org/dom4j-1.6.1/apidocs/org/dom4j/rule/Action.html)的自定义实现，因为这就是 setAction 所需要的。

无论如何，使用以下代码，确实会为每五个“授权”元素调用操作的 run 方法：

```
Rule authorizationRule = new Rule();
authorizationRule.setPattern(DocumentHelper.createPattern("//authorize"));

final Stylesheet stylesheet = new Stylesheet();                                 
authorizationRule.setAction(new Action(){
    public void run(Node node) throws Exception {
       stylesheet.applyTemplates(node);
    }
 });

stylesheet.addRule(authorizationRule);
stylesheet.run(document); 
```

（仅在将 XML 片段更改为格式良好的文档后才有效。）

您需要在动作中使用样式表的方式似乎有点尴尬，我不确定这种事情*应该*如何在 dom4j 中完成。遗憾的是，[Stylesheet](http://www.dom4j.org/dom4j-1.6.1/apidocs/org/dom4j/rule/Stylesheet.html)和[Rule](http://www.dom4j.org/dom4j-1.6.1/apidocs/org/dom4j/rule/Rule.html)等相关类似乎没有充分记录。（考虑例如[`run(Node node, String mode)`](http://www.dom4j.org/dom4j-1.6.1/apidocs/org/dom4j/rule/Stylesheet.html#run%28java.util.List,%20java.lang.String%29)模式参数似乎完全缺乏解释的方法。）

# objective-c - 使用应用程序菜单启动窗口的 LSUIElement 应用程序？

> ID：815504
> 
> 赞同：1
> 
> 时间：2009-05-02T20:03:55.920
> 
> 标签：objective-c, cocoa

我正在编写一个最初仅以 NSStatusItem 元素开头的应用程序。从其菜单中，用户可以单击打开 NSWindow 的菜单项。

我希望当该窗口处于焦点时，将显示应用程序菜单。可能吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-03T04:08:57.937

不，为了获得您的应用程序菜单，您必须将应用程序转换为前台进程（即不再是 LSUIElement）。一旦您将应用程序转换到前台，它就不能再转换回来。

[在Carbon Process Manager](http://developer.apple.com/documentation/Carbon/Reference/Process_Manager/Reference/reference.html#//apple_ref/doc/uid/TP30000208-CH1g-F08201)`TransformProcessType`中可以找到将应用程序转换到前台的功能。

您在此处的选择是 1) 在使用 将进程置于前台之后`TransformProcessType`，编写一个巧妙的小技巧来关闭并重新启动应用程序。您的另一个选项 2）是创建一个两阶段应用程序（如果在您的情况下可能的话，我可能会喜欢这个选项），其中应用程序的一部分始终在后台（即 LSUIElement）。当该应用程序想要提供一个带有菜单的窗口时，它会启动一个包含该窗口等的帮助应用程序作为常规应用程序。用户完成后，该应用程序将被关闭并关闭。这两个应用程序可以通过任意数量的 IPC 机制轻松进行通信，包括 UD 套接字、Cocoa 分布式对象、NSMessagePorts 等。

# visual-studio-2008 - 重构 Visual Studio 项目的工具/技巧

> ID：815513
> 
> 赞同：1
> 
> 时间：2009-05-02T20:10:04.250
> 
> 标签：visual-studio-2008, resharper

类似于 Resharper 将类型复制或移动到另一个文件并调整所有 using 语句的方式，我希望能够重构 VS 项目，并且知道我的所有引用、程序集名称和文件位置将是适当调整。

Resharper 或任何其他工具是否使项目级重构变得容易？

谢谢，贝里尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-02T21:38:33.447

我不确定你会得到你想要的一切，但那里有很多。你可以用 Resharper 做三件事来帮助你：

1）在项目或解决方案级别，您可以在 Visual Studio 中右键单击它并选择“清理代码...”，这将重新格式化该项目中的所有文件并使用语句等进行更改。

2）您可以右键单击项目中的每个依赖项并选择“查找用法...”以确保需要依赖项。

3) Resharper 最近有一些新功能，您可以右键单击项目，然后对所选项目使用的其他项目和程序集中的代码说“查找依赖代码”，对引用该代码的代码说“查找引用代码”在选定的项目中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-03T00:34:21.807

ReSharper 4.5 版现在甚至可以指出解决方案中的任何代码都无法访问的公共成员。它不会为您删除它们，但可以突出显示它们，以便您自己这样做。这确实假设您拥有解决方案中重要的所有代码。我相信它还可以告诉您可以将特定的公共成员设置为内部成员，但我实际上还没有看到它这样做（我刚刚升级）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-03T05:47:22.413

关于文件位置 - ReSharper 的下一个版本将跟踪文件移动和重命名，并调整它的所有引用。它对 ASP.NET 项目非常有用——母版页、用户控件、JS、CSS、图像参考。

# asp.net - 在 ASP.net/GDI+ 上设置调色板生成的 PNG 图像

> ID：815519
> 
> 赞同：1
> 
> 时间：2009-05-02T20:12:16.553
> 
> 标签：asp.net, gdi+, png

我刚刚在 ASP.net 中构建了一个返回 PNG 图像的应用程序。

生成的图像在透明背景上完全是黑色的。有没有办法索引图像以减小文件大小？

我无法在创建新图像时为其编制索引，因为我正在使用不允许它的图形对象。

非常感谢您的帮助 - 我一直在寻找年龄，我似乎无法弄清楚如何设置它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-02T21:04:32.920

据我所知，你不能使用直接的 GDI+ 来做到这一点——内置的 PNG 编码器在支持输出颜色深度方面非常有限......即使你设法创建一个`Bitmap`带有良好调色板的索引 -内存，你仍然会发现它被写成 32bpp PNG。要获得所需的控制，您必须求助于第三方图像库。

### 看：

> *   [将内存图像中的 24 位转换为索引颜色](https://stackoverflow.com/questions/727987/convert-a-24-bit-in-memory-image-to-indexed-color)
> *   [.NET 中最好的免费/开源图像转换库是什么？](https://stackoverflow.com/questions/719616/what-is-the-best-free-open-source-image-conversion-library-in-net)

# windows - How do you copy text from Firefox in Windows to bash shell in Unix?

> ID：815524
> 
> 赞同：3
> 
> 时间：2009-05-02T20:15:17.513
> 
> 标签：windows, bash, unix, copy-paste

I have a long URL on a web page in Windows that I need to copy into bash shell in Unix. Is there a way to do this without retyping the URL?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-02T20:21:35.080

If you connect to unix using putty, copy the text from the browser, then right click on the putty window to paste.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-02T20:18:18.460

You could use [Synergy](http://synergy2.sourceforge.net/) to share your clipboard between the two machines.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-02T20:35:58.603

I routinely run x2vnc from a Linux box, and have a VNC server (RealVNC) running on a Windows box. This lets me share one mouse and keyboard across the two machines, and the clipboard is also shared across the machines.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-08-10T17:08:59.657

As an alternative to right clicking in the putty window, you can also paste by pressing Shift+Insert in the putty window.

(I learned this from the FAQ at the putty website)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-02T20:23:06.780

If you are on Windows, and you have a Putty session into your unix box, then you can copy the URL to the clipboard in Windows, and then right-click in the putty window. This will do a paste. You could do that paste into a vi session and save the url.

Another option is using the `write` command. That is, open a terminal on the unix box, and then use Putty to SSH into that same box. do a `write tonge` (assuming 'tonge' is your user name), paste the URL, and press enter. The recipient (that is, you, with a bash terminal open) will receive that URL.

# apache-flex - Flex：复制图像的实例

> ID：815527
> 
> 赞同：0
> 
> 时间：2009-05-02T20:17:04.577
> 
> 标签：apache-flex, image, proxy, duplicates, drag

我的 Flex 应用程序中有一个拖放处理程序。拖动代理或拖动时要显示的“幽灵”图像必须在我拖动之前加载，这需要一些时间。我怎样才能让它立即加载或预加载？一种解决方案是复制图像，但据我所知，如果不创建另一个变量，就无法复制图像对象，这仍然需要一些时间来加载。

也许这段代码会更好地说明它：

```
public function DragApp (e : MouseEvent) : void {
    var dragInitiator : Image = e.currentTarget as Image;
    var dragSource : DragSource = new DragSource ();

    var dragProxy : Image = new Image ();
    dragProxy.source = e.currentTarget.source; // Won't work unless image is embedded
    dragProxy.load (e.currentTarget.source); // Must load

    setTimeout (DragManager.doDrag, 350, dragInitiator, dragSource, e, dragProxy);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-02T20:51:24.823

我相信问题是您没有为图像设置宽度和高度（对于嵌入式图像来说有点多余）：

> dragImage:IFlexDisplayObject (default = null) — 要拖动的图像。此参数是可选的。如果省略，则在拖放操作期间使用标准拖动矩形。如果指定图像，则**必须显式设置图像的高度和宽度，否则不会出现**。

如果您在示例中为 Image 代理定义宽度和高度，它可能会起作用：

```
var dragProxy : Image = new Image ();
dragProxy.source = dragInitiator.source;
dragProxy.width = dragInitiator.width;
dragProxy.height = dragInitiator.height; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-02T21:19:04.943

您最好使用图像的位图捕获并将其用作您的 dragProxy。下面是一些从任何 UIComponent 中捕获 BitmpData 的简单代码：

```
private function getUIComponentBitmapData( target : UIComponent ) : BitmapData
{ 
    var bd : BitmapData = new BitmapData( target.width, target.height );
    var m : Matrix = new Matrix();
    bd.draw( target, m );
    return bd;  
} 
```

一旦你有了它，你可以使用 BitmapData 创建一个新的 Bitmap 并将 Bitmap 提供为 Image 组件的源。此博客文章中的更多详细信息/示例：

[http://www.cynergysystems.com/blogs/page/andrewtrice?entry=flex_2_bitmapdata_tricks_and](http://www.cynergysystems.com/blogs/page/andrewtrice?entry=flex_2_bitmapdata_tricks_and)

# design-patterns - 如何回答面试问题：什么是单例，你会如何使用它？

> ID：815528
> 
> 赞同：2
> 
> 时间：2009-05-02T20:17:58.227
> 
> 标签：design-patterns, architecture, singleton

我已经阅读了有关 Singleton 的 SO 问题，并且刚刚观看了一个小时的谷歌技术讲座。据我所知，OO 世界的共识似乎是单例更像是一种反模式，而不是一种有用的设计模式。

也就是说，这几天我在面试，问题出现了很多——什么是单例，你将如何使用它？

回答这个问题的最佳方法是什么？我是否应该简单地描述设计模式，然后说我听说过的唯一可接受的用途是用于日志记录，并且它经常被误用于全局状态？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-02T20:28:54.270

棘手。有很多人认为单例本质上是一种反模式，就像你说的（包括我在内），但也有很多人认为它只是一种 OOP 可接受的全局方法。

如果面试官在那个阵营，那么是的，我认为他错了，但这可能不是在面试时说的最好的话。;)

所以我可能会尽量保持中立并坚持事实。你不知道你的面试官属于哪个阵营，所以坚持无可争辩的事实。单身人士做什么？为了演示用法，请坚持大多数人同意单例是可接受的答案的少数情况。或者解释你的经历（因为人们也不能不同意）。

但无论你是“支持”还是“反对”单身人士，面试可能都不是为这个事业讨价还价的合适时机。;)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-02T20:22:23.300

结合您自己使用/不使用它的经验。这是任何一天最好的答案。如果您没有使用过它，但知道它是什么，请继续说。大多数时候，面试官不会冒险超越单身人士——所以试一试吧。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-02T20:24:26.603

只要你准备好讨论，我认为你建议的答案是一个很好的答案。但请注意，我们中的一些人仍然认为单例是一个有用的想法。一些数据在范围内自然是全局的，单例提供了一种抽象数据的明智方法。当然，如果您的语言支持这种结构，您当然也可以在更有限的范围内使用单例，例如在特定命名空间内。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-02T20:41:01.120

一个单身汉。

根据定义，它是一个在整个应用程序中只有一个实例的对象。这可以通过将构造函数设为私有并通过对象定义中的公共属性提供静态实例来保证。

当您处理只有一个对象可以随时访问它的资源时，这是一种有用的模式。

但是，它有许多取舍。单例实例很多都有自己的要求，这使得测试任何使用它的类变得繁重，因为它们必须满足其先决条件以及被测试类的先决条件。

此外，在维护项目并尝试修改某些抽象时，这可能是一个问题。因此，我发现最好通过接口抽象单例。将“单个实例”保留为实现细节，并将单个实例作为接口传递，这意味着调用代码与类定义（和静态属性）无关。这使得以后的测试和抽象变得更容易，但代价是架构管道（例如，将其传递给 Ctors 或 setter 属性）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-03T00:27:08.580

同样提醒大家，在 GoF 之前世界确实存在，我将补充一点，人们还可以使用单例模式的修改来确保每个会话、每个线程或任何其他对象只有一个实例。只需使用 per-Session 或 per-Thread 或 per-whatever 状态来保存一个实例。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-02T20:25:17.227

我的答案：

> 哦，拜托，你不能至少找到关于这个疲惫的老话题的 *第二个*最受欢迎的问题吗？你必须先去？我走了。面试结束了。

或者，我希望它可以...

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-02T20:22:14.237

我的回答是：

> 单例是一种设计模式，它指定一种方法来确保在运行时只存在一个对象实例。
> 
> 我会谨慎使用它。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-02T20:53:59.107

没有状态的单例呢？我特别喜欢策略模式中一些可能的幂等具体策略，纯算法，没有数据。

或 Java 枚举类，它们是单例。我发现这样的东西很有用：

```
public enum StringComparator implements Comparator {

  CASE_SENSITIVE {
    int compare(Object lhs, Object rhs) {
      // check for null omitted for brevity
      return lhs.equals(rhs);
    }
  },

  CASE_INSENSITIVE {
    int compare(Object lhs, Object rhs) {
      return String.CASE_INSENSITIVE_ORDER( lhs, rhs ) ;
    }
  };

  boolean equals( Object o ) {
   return this == o ;
  }
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-17T06:46:21.630

我遇到了一些用途。日志很明显。另一个是使用 nCurses 的控制台输出。我制作了一个使用 Panel 对象的库，但每个对象都需要与一个控制器进行通信，该控制器控制诸如 z-orders 之类的东西。另一个是游戏的随机数生成器。你真的想在每个函数中重新植入那个 mersenne twister，还是到处传递它？

但在大多数情况下，它们会导致糟糕的设计。

# python - 如何使用颠覆 Ctypes Python Bindings？

> ID：815530
> 
> 赞同：4
> 
> 时间：2009-05-02T20:18:33.047
> 
> 标签：python, svn

Subversion 1.6 引入了一些叫做“Ctypes Python Binding”的东西，但它没有被记录。是否有任何可用的信息，这个绑定是什么以及如何使用它？例如，我有一个新的 Windows XP 并想使用 subversion 1.6 和这个神秘的 python 绑定来控制 SVN 存储库。我到底需要下载/安装/编译什么才能做类似的事情

```
import svn from almighty_ctype_subversion_bindings
svn.get( "\\rep\\project" ) 
```

这与 pysvn 项目有什么关系？这是相同的技术，还是不同的技术？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T21:54:54.877

您需要 Subversion 源代码分发版、Python (>= 2.5) 和[ctypesgen](http://code.google.com/p/ctypesgen/)。

构建 ctypes 绑定的说明在[这里](http://svn.apache.org/repos/asf/subversion/trunk/subversion/bindings/ctypes-python/README)。

你最终会得到一个名为 的包`csvn`，它的使用示例在[这里](http://svn.apache.org/repos/asf/subversion/trunk/subversion/bindings/ctypes-python/examples/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-02T20:41:22.337

ctypes 的全部意义在于你不需要在任何地方编译任何东西。也就是说，绑定的自述文件提到了一些依赖项和构建步骤。

至少可以在 Subversion 源代码分发版中找到绑定`subversion/bindings/ctypes-python/`，其中包含 distutils setup.py。

它们似乎是 pysvn 的继任者/替代品。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-05-02T21:54:00.663

我查看了 subversion 的 python 绑定，但最后我发现像这样调用 svn.exe 更简单：

```
(stdout, stderr, err) = execute('svn export "%s" "%s"' \
   % (exportURL, workingCopyFolder)) 
```

`execute`像这样的函数在哪里：

```
def execute(cmd):
    import subprocess
    proc = subprocess.Popen(\
          cmd, shell=True, stdout=subprocess.PIPE, stderr=subprocess.PIPE)
    (stdout, stderr) = proc.communicate()
    return (stdout, stderr, proc.returncode) 
```

svn.exe 的输出被设计为在必要时易于解析。甚至还有一个 --xml 输出选项。

# emacs - Emacs：操作后保持选中区域

> ID：815540
> 
> 赞同：17
> 
> 时间：2009-05-02T20:22:21.303
> 
> 标签：emacs

在 emacs 中，在进行诸如`comment-region`之类的操作后，选中的区域会被自动取消选中。

有没有办法禁用这种行为？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-02T20:57:42.530

如果取消选择该区域，那听起来您必须使用[`transient-mark-mode`](http://www.gnu.org/software/emacs/manual/html_mono/emacs.html#Transient-Mark). 在`transient-mark-mode`中，当您执行对区域进行操作的命令时，该区域被取消选择（特别是，标记仍然存在，但它处于非活动状态）。`C-x C-x`您可以使用( )重新选择区域（重新激活标记`exchange-point-and-mark`）。

如果要完全禁用取消选择，可以关闭`transient-mark-mode`. 这意味着您不会对当前区域进行任何突出显示，但如果您想设置标记并突出显示该区域，您可以使用或[短暂打开瞬态标记模式](http://www.gnu.org/software/emacs/manual/html_mono/emacs.html#Momentary-Mark)。`C-<SPC> C-<SPC>``C-u C-x C-x`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-10-06T00:01:04.057

使用变量`deactivate-mark`：

```
(defun acg/with-mark-active (&rest args)
  "Keep mark active after command. To be used as advice AFTER any
function that sets `deactivate-mark' to t."
  (setq deactivate-mark nil))

(advice-add 'comment-region :after #'acg/with-mark-active) 
```

在上面的示例中，您可以替换`comment-region`为您想要的任何其他功能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-05-30T22:51:55.903

幸运的是，键盘宏在更改区域时不会取消选择该区域。因此，您可以编写函数，然后创建一个调用您的函数的 kbd 宏，然后执行 Cx Cx 一次，或者，如果您关心点和标记原样，请执行两次。然后命名您的 kbd 宏。然后 Mx write-kbd-macro 并在出现提示时给它您希望宏附加到的文件的名称，然后给它您的新宏的名称。如果您现在将宏绑定到某个键，您可以重复按下该键而不会丢失该区域。如果 Emacs 的 'interactive' 将 '_' 作为字符串参数的一部分来保留该区域并突出显示 XEmacs 的 'interactive' 的方式，那肯定会很好。

# html - 如何在 VI 中整理 HTML 文件的缩进？

> ID：815548
> 
> 赞同：144
> 
> 时间：2009-05-02T20:26:57.127
> 
> 标签：html, vim, vi, indentation

如何修复他的巨大 html 文件的缩进，这一切都搞砸了？

我尝试了通常的[`"gg=G`命令](https://stackoverflow.com/questions/506075/how-do-i-fix-the-indentation-of-an-entire-file-in-vi)，这是我用来修复代码文件缩进的。但是，它似乎不适用于 HTML 文件。它只是删除了所有格式。

我还尝试了设置`:filetype = xml`，看看是否欺骗它认为这是一个 XML 文件会有所帮助，但它仍然没有这样做。

* * *

## 回答 #1

> 赞同：204
> 
> 时间：2013-01-01T22:43:04.587

有几件事都需要到位。只是将它们全部汇总在一个位置：

设置以下选项：

```
:filetype indent on
:set filetype=html           # abbrev -  :set ft=html
:set smartindent             # abbrev -  :set si 
```

然后将光标移动到文件顶部并缩进到末尾：`gg` `=G`
或选择要缩进的所需文本并点击`=`缩进。

* * *

## 回答 #2

> 赞同：96
> 
> 时间：2009-05-02T20:34:31.323

在`filetype indent on`my`.vimrc`中，Vim 可以很好地缩进 HTML 文件。

`shiftwidth`a为 2的简单示例：

```
<html>
  <body>
    <p>
    text
    </p>
  </body>
</html> 
```

* * *

## 回答 #3

> 赞同：73
> 
> 时间：2013-11-13T17:43:21.603

使用智能缩进的主要问题是，如果 XML（或 HTML）位于一行上，因为它可能最终从 curl 请求中返回，那么`gg=G`就无法解决问题。相反，我刚刚使用从 VI 直接调用的 tidy 体验了一个很好的缩进：

```
:!tidy -mi -xml -wrap 0 % 
```

这基本上告诉 VI 调用 tidy 来清理 XML 文件，而不是换行以使其适合默认的 68 个字符宽的行。我处理了一个 29MB 的大型 XML 文件，花了 5 到 6 秒。我猜对于 HTML 文件，命令应该是：

```
:!tidy -mi -html -wrap 0 % 
```

正如评论中提到的，`tidy`它是一个基本工具，您可以在许多基础 Linux / MacOS 系统上找到它。这是项目的页面，以防您希望拥有它但没有：[HTML Tidy](http://www.html-tidy.org)。

* * *

## 回答 #4

> 赞同：49
> 
> 时间：2013-10-13T23:16:01.010

正如上面 tylerl 解释的那样，设置以下内容：

```
:filetype indent on
:set filetype=html
:set smartindent 
```

但是，请注意在 vim 7.4 中 HTML 标签`html`、`head`、`body`和其他一些默认情况下**不**缩进。这是有道理的，因为 HTML 文件中的几乎所有内容都属于这些标签。如果你真的想要，你可以让这些标签像这样缩进：

```
:let g:html_indent_inctags = "html,body,head,tbody" 
```

有关更多信息，请参阅“ [HTML 缩进在编译的 Vim 7.4 中不起作用，有什么想法吗？](https://stackoverflow.com/questions/19323607/html-indenting-not-working-in-compiled-vim-7-4-any-ideas) ”和“[替代 html 缩进脚本](http://www.vim.org/scripts/script.php?script_id=2075)”。

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2013-05-01T18:56:07.667

这是我的解决方案，可以很好地以间隔良好的方式打开“丑陋”的 HTML：

```
vim fileIn.html -c "set sw=2 | %s/>/>\r/ | execute 'normal gg=G' | set nohlsearch | g/^\\s*\$/d" 
```

*   该`sw`命令是因为我的默认值是 4，这对于 HTML 来说太高了。
*   下一部分在每个元素 ( ) 之后添加一个换行符（Vim 认为这是一个回车，叹气`>`）。
*   然后用 重新缩进整个文件`=`。
*   然后取消突出`>`显示（因为我`set hlsearch`在我的 vimrc 中有）。
*   然后删除所有空行/仅空白行（有关更多信息，请参阅“ [Vim 删除空白行](https://stackoverflow.com/questions/706076/vim-delete-blank-lines)”，这也是双转义的，因为它在 shell 中）。

`| wq! fileOut.html`如果您根本不想进入 Vim，您甚至可以添加到最后，只需清理文件即可。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2014-04-17T13:16:10.243

我使用这个脚本： [https ://github.com/maksimr/vim-jsbeautify](https://github.com/maksimr/vim-jsbeautify)

在上面的链接中，您拥有所有信息：

1.  安装
2.  配置（从第一个示例复制）
3.  跑`:call HtmlBeautify()`

把工作做得漂亮！

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2020-08-15T10:58:18.453

没有一个答案对我有用，因为我所有的 HTML 都在一行中。

基本上，您首先需要使用以下命令分隔每一行，该命令替换`><`为相同的字符，但中间有一个换行符。

```
:%s/></>\r</g 
```

然后命令

```
gg=G 
```

将缩进文件。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-05-02T20:44:00.393

你试过在 Vim 网站上使用 HTML 缩进脚本吗？

*   [http://www.vim.org/scripts/script.php?script_id=2075](http://www.vim.org/scripts/script.php?script_id=2075)

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2013-02-08T01:42:09.467

这是一个重量级的解决方案，可以让您缩进，以及您在编辑时不一定要关心的所有 HTML 漂亮打印。

首先，下载[Tidy](http://tidy.sourceforge.net/#binaries)。确保将二进制文件添加到路径中，以便可以从任何位置调用它。

接下来，创建一个描述您最喜欢的 HTML 风格的配置文件。文档对 Tidy 来说不是很好，但这里有一个[概述](http://www.w3.org/People/Raggett/tidy/)和[所有选项](http://tidy.sourceforge.net/docs/quickref.html)的列表。这是我的配置文件：

```
bare: yes
break-before-br: no
clean: yes
drop-proprietary-attributes: yes
fix-uri: yes
indent-spaces: 4
indent: yes
logical-emphasis: yes
markup: yes
output-xhtml: yes
quiet: yes
quote-marks: yes
replace-color: yes
tab-size: 4
uppercase-tags: no
vertical-space: yes
word-2000: yes
wrap: 0 
```

将其保存`tidyrc_html.txt`在您的`ftplugin`文件夹中（在 vimfiles 下）。

另一个文件：将以下行添加到（或创建）`html.vim`，也在`ftplugin`：

```
map <leader>tidy :%! tidy -config ~/vimfiles/ftplugin/tidyrc_html.txt <CR> 
```

要使用它，只需打开一个 HTML 文件，然后键入`/tidy`. （这`/`是`<leader>`关键。）

给你！无论如何，这不是一个快速的解决方案，但现在您可以更好地编辑那些巨大的、混乱的 HTML 文件。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2015-06-13T15:58:16.933

您可以通过安装插件[vim-autoformat](https://github.com/vim-autoformat/vim-autoformat)自动集成[tidy](http://tidy.sourceforge.net/)和[html-beautify](https://github.com/beautify-web/js-beautify)。之后，您可以通过单次击键执行安装的任何格式化程序。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2018-06-22T17:47:51.003

> 我尝试了通常的“gg=G”命令，这是我用来修复代码文件缩进的。但是，它似乎不适用于 HTML 文件。它只是删除了所有格式。

如果 vim 的 autoformat/indent`gg=G`似乎“损坏”（例如左缩进每一行），很可能是 indent 插件未启用/加载。它真的应该给出一个错误消息，而不是仅仅做不好的缩进，否则用户只会认为自动格式化/缩进功能很糟糕，而实际上它非常好。

要检查缩进插件是否已启用/加载，请运行`:scriptnames`. 看看是否`.../indent/html.vim`在列表中。如果没有，那么这意味着插件没有加载。在这种情况下，将此行添加到`~/.vimrc`：

```
filetype plugin indent on 
```

现在，如果您打开文件并运行`:scriptnames`，您应该会看到`.../indent/html.vim`. 然后运行`gg=G`，它现在应该执行正确的自动格式化/缩进。（虽然它不会添加换行符，所以如果所有的 html 代码都在一行上，它就不会缩进）。

注意：如果您`:filetype plugin indent on`在 vim 命令行上运行而不是`~/.vimrc`，则必须重新打开文件`:e`.

此外，您无需担心`autoindent`和`smartindent`设置，它们与此无关。

# asp.net - 如何在 ZedGraph 中的每个点显示标签？

> ID：815556
> 
> 赞同：4
> 
> 时间：2009-05-02T20:32:39.640
> 
> 标签：asp.net, charts, controls, zedgraph

如何为 ZedGraph 图表中绘制的每个点显示标签？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2011-07-27T23:42:42.037

由于该站点现在已关闭，这里有一个代码片段来举例说明如何做到这一点：

```
myLine.GetRange(out other, out other, out minY, out maxY, false, false, myPane);
                double Yinterval = Math.Abs(maxY - minY) / 25;
                // Loop to add text labels to the points
                for (int i = 0; i < tempPoints.Count; i++) {
                    // Get the pointpair
                    ZedGraph.PointPair pt = tempPoints[i];
                    // Create a text label from the Y data value
                    ZedGraph.TextObj text = new ZedGraph.TextObj(pt.Y.ToString(), pt.X, pt.Y + Yinterval,
                        ZedGraph.CoordType.AxisXYScale, ZedGraph.AlignH.Left, ZedGraph.AlignV.Center);
                    text.FontSpec.FontColor = tempHolder.Color;
                    text.ZOrder = ZedGraph.ZOrder.A_InFront;
                    // Hide the border and the fill
                    text.FontSpec.Border.IsVisible = false;
                    text.FontSpec.Fill.IsVisible = false;
                    text.FontSpec.Size = 10f;
                    text.FontSpec.Angle = 45;

                    string lblString = "name";

                    Link lblLink = new Link(lblString, "#", "");
                    text.Link = lblLink;

                    myPane.GraphObjList.Add(text);
                } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-02T20:37:19.210

对于每个点，使用您的标签文本创建一个文本对象，并将其添加到图表中。

点[标签演示](http://zedgraph.org/wiki/index.php?title=Point_Label_Demo)演示...

# objective-c - 如何保持调整大小窗口的纵横比？

> ID：815558
> 
> 赞同：3
> 
> 时间：2009-05-02T20:33:58.313
> 
> 标签：objective-c, cocoa, macos

我有一个包含一个 QTMovieView 的窗口。如何使调整窗口大小使窗口的纵横比保持不变？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-02T21:23:26.743

```
[window setContentAspectRatio:NSMakeSize(width, height)] 
```

更多信息：[Apple 的文档](http://developer.apple.com/documentation/Cocoa/Conceptual/WinPanel/Tasks/SizingPlacingWindows.html)，[NSWindow 类参考](http://developer.apple.com/documentation/Cocoa/Reference/ApplicationKit/Classes/NSWindow_Class/Reference/Reference.html)

# .net - 身份验证票（表单身份验证）

> ID：815563
> 
> 赞同：2
> 
> 时间：2009-05-02T20:36:40.413
> 
> 标签：.net, asp.net, encryption

Q1 - Forms 身份验证模块在将其身份验证信息 (ticket) 放入 cookie 之前对其进行加密。

现在，我对加密算法知之甚少的是，它们通常使用一些随机生成的值来加密和解密一段数据。因此，如果相同的算法使用值 A 来加密某些数据，那么它也需要相同的值才能解密这些数据。

A) 由于多个用户可以登录（通过表单身份验证模块）到特定的 Web 应用程序，这些用户中的每一个的身份验证信息是否会使用相同的随机生成值进行加密？

*   如果是，那这不代表安全风险吗？

*   如果不是，那么在下一次请求时，Asp.Net 从用户那里收到身份验证 cookie（其中包含票证），它如何知道它用于加密票证的随机生成的值（我假设它需要相同的值来解密票证）

Q2 Authentication ticket 包含几条关于已通过身份验证的用户的信息，但这些数据中的哪一条实际上告诉 Asp.Net（当用户再次请求页面时）它正在处理已通过身份验证的用户？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-02T20:45:32.950

Q1：Forms 身份验证使用[machineKey](http://msdn.microsoft.com/en-us/library/w8h3skw9.aspx)加密 cookie。由于它的值在 machine.config 中是恒定的，因此 ASP.NET 能够解密使用相同密钥加密的 cookie。

cookie 使用相同的密钥加密，但该密钥只有服务器知道，这意味着用户无法篡改 cookie 的数据，因此无法冒充其他用户，因此使用相同的私有密钥不存在安全风险用于加密 cookie 的密钥。

Q2：票据包含以下信息：用户名和用于确定其是否有效的日期（如果设置了滑动到期，ASP.NET 可以重写 cookie，因为它会在每个请求上检查其有效性）。如果 cookie 是由客户端发送的，并且当它被解密时它仍然有效，则 ASP.NET 假定客户端已通过身份验证。

# asp.net - 强制 SSL 连接

> ID：815566
> 
> 赞同：2
> 
> 时间：2009-05-02T20:40:41.243
> 
> 标签：asp.net, iis, ssl

A）您能否在服务器端仅对每个 Web 应用程序强制执行 SSL 连接（通过选择“要求安全通道”选项），或者您是否也可以对每个虚拟目录或什至仅对每个网页强制执行 SSL 连接？

B) 强制 SSL 连接究竟是如何工作的？如果用户指定 http 而不是 https 协议（在请求的 URL 中），请求将自动被 IIS 拒绝？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-06T17:37:29.810

如上所述，1) SSL 可以设置在服务器、端或虚拟目录中。

2) 如果使用“要求安全通道”设置配置服务器/站点/vdir，则服务器的响应将是“403.4 Forbidden: SSL is required to view this resource”。错误或“403.5 Forbidden: SSL 128 is required to view this resource.”。

您实际上可以自定义 403.4 或 403.5 错误以重定向回 HTTPS。**在您的站点下创建一个没有 SSL 要求**的 VDIR （****这很重要**） - 我使用“CustomError”。在此目录中创建一个名为 403_4_Error.asp 的 ASP 文件，其中包含以下内容：

```
<%@ LANGUAGE="VBScript" %> 
<%
if Request.ServerVariables("HTTPS") <> "on" then
    sServer = Request.ServerVariables("SERVER_NAME")
    sScript = Request.ServerVariables("SCRIPT_NAME")
    sQuery  = Request.ServerVariables("QUERY_STRING")
    Response.Write("https://" & sServer & sScript & "?" & sQuery)
end if
%> 
```

编辑 server/site/vdir 的 403.4/403.5 的自定义错误属性，并将 MessageType 设置为 URL，将 URL 设置为“/CustomError/403_4_Error.asp”。

请注意，使用了 ASP，您可以轻松使用 ASP.net 或任何其他脚本语言。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-02T20:52:48.580

可能有一个配置设置可以在 IIS 级别强制执行此操作，但在代码中，您可以检查[Request.IsSecureConnection](http://msdn.microsoft.com/en-us/library/system.web.httprequest.issecureconnection.aspx)值，如下所示：

```
if (!Request.IsSecureConnection)
{
    try
    {
        Response.redirect("https://....", true);
    }
    catch (ThreadAbortException)
    {}
} 
```

其中“....”是当前页面的 url。此类代码的一个好地方是在 MasterLayout.master 文件的 Page_Load 方法中。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-07-14T14:38:21.387

一个巧妙的方法是注册一个 HttpModule 来检查每个传入的请求并在必要时重定向：然后不需要自定义错误。

这是一篇[博客文章](http://blogs.msdn.com/sojesh/archive/2009/05/26/http-to-https-redirection-using-asp-net-http-module.aspx)，展示了它是如何完成的。

# java - 在java中检索matlab结果

> ID：815571
> 
> 赞同：0
> 
> 时间：2009-05-02T20:42:40.430
> 
> 标签：java, matlab, matlab-engine

我在我的项目中使用 matlab，我想在 java 中检索 matlab 的结果。只是我想要结果。我想检索我在 java 中的 matlab 中创建的文件的结果。我使用此代码，但它在 matlab windows 中给了我结果，我只想在 java 中检索结果。这是代码

```
public class matlab {
    private static File myMATLABScript;
    //private static File myMATLABScript;
    public static String runScript(File scriptName) {
        String output = ""  ;
        String error = "";
        try {
            //String commandToRun = "matlab -r myMATLABScript -nodisplay < " + scriptName;
            String commandToRun = "matlab  -nosplash -r myMATLABScript -nodisplay -nodesktop < " + scriptName;

            System.out.println(commandToRun);
            Process p = Runtime.getRuntime().exec(commandToRun);
            String s;
            BufferedReader stdInput = new BufferedReader(new InputStreamReader(p.getInputStream()));
            BufferedReader stdError = new BufferedReader(new InputStreamReader(p.getErrorStream()));
            // read the output from the command
            System.out.println("\nHere is the standard output of the command:\n");
            while ((s = stdInput.readLine()) != null) {
                output = s + "\n";
                System.out.println(s);
                //System.out.println("what is the problem");
            }
            // read any errors from the attempted command
            //System.out.println("\nHere is the standard error of the command (if any):\n);
            while ((s = stdError.readLine()) != null) {
                error = s + "\n";
                System.out.println(s);
            }
        } catch (Exception e) {
            System.out.println("exception happened - here’s what I know: ");
            e.printStackTrace();
            System.exit(-1);
        }
        return output + error;
    }

    public static void main(String[] args) throws IOException{
        matlab m = new matlab();
        matlab.runScript(myMATLABScript);
    }
} 
```

请你帮助我好吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-13T03:41:49.150

你在什么操作系统上运行？Matlab 应用程序在不同的操作系统上表现不同。我假设您在 Windows 上，因为即使您传递了“-nodesktop”，您也提到了“Matlab 窗口”。在 Windows 上，Matlab 本质上是一个 GUI 应用程序，stdin/stdout 是无用的。

尝试更改脚本以将其输出写入文件，该文件由环境变量、传递给 mymatlabscript 的函数参数或众所周知的路径确定。然后读入那个文件而不是 Matlab 的标准输出。仅使用“-r”开关，而不是“<”。这将可以跨操作系统移植，您可能会发现它更容易解析，因为输出文件不会有额外的 Matlab 命令窗口输出。

您可能还需要使用“-wait”开关来阻止，直到您的 Matlab 脚本完成。Windows 上的正常 Matlab.exe 调用将立即返回。确保您的脚本以“exit()”结尾，否则 Matlab 将无限期运行，在脚本完成后等待用户输入。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-04T12:20:47.780

尝试调用[Matlab 引擎](http://forums.sun.com/thread.jspa?threadID=5311658)而不是创建一个新的 matlab 进程（[这里是](http://matlabdb.mathematik.uni-stuttgart.de/download.jsp?MC_ID=9&MP_ID=163)另一个描述）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-07-08T23:05:40.420

[matlabcontrol](http://matlabcontrol.googlecode.com)是一个 Java API，它允许您这样做。可以像使用 MATLAB 的命令行窗口一样使用 API，并且可以将结果作为 Java 对象检索。无需写入或读取输入/输出/错误流或外部文件。要运行您的脚本，您需要 MATLAB到您的脚本所在的目录，`cd`然后是脚本。要开始，请查看[演练](http://code.google.com/p/matlabcontrol/wiki/Walkthrough)。`eval``feval`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-03-12T03:03:30.490

您是否有机会获得 MATLAB Builder JA 的许可证并且现在知道它？

[http://www.mathworks.com/products/javabuilder/](http://www.mathworks.com/products/javabuilder/)

这将是一种在 Java 中访问 MATLAB 函数结果的简单方法。

# java - 如何在 Eclipse 中使用 MiG 布局？

> ID：815577
> 
> 赞同：5
> 
> 时间：2009-05-02T20:44:04.933
> 
> 标签：java, eclipse, ide, miglayout

我一直在谷歌搜索和检查堆栈溢出，但没有任何帮助......希望有人可以。

我通常只是手动编写代码，但我正在开发一个具有 GUI 方面的 Java 项目，我喜欢 MiG Layout 提供的功能，所以我想使用它。我已经从网站下载了 .jar 文件，但我似乎无法从我的项目中访问它。

我现在使用 Eclipse 作为这个项目的 IDE，因为我不想手动处理这个特殊的事情。我是 Eclipse 的新手，但这是我一直在尝试的：导入 .jar 文件（通过项目的导入工具），然后将以下代码添加到我的文件中：

```
import net.miginfocom.swing.MigLayout;
import javax.swing.*; 
```

根据[这个页面](http://migcalendar.com/forum/viewtopic.php?f=8&t=2307)，这应该可行，对吧？

但是当我尝试运行该程序时，我遇到了以下消息：

```
Exception in thread "main" java.lang.Error: Unresolved compilation problem: 
    MigLayout cannot be resolved to a type 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-02T20:48:43.283

听起来“导入工具”部分无法正常工作 - Eclipse 实际上并没有使用 jar 文件。

我建议您右键单击该项目，选择“属性”，然后转到“构建路径”页面。在“库”选项卡下查看。假设 jar 文件不存在，添加它，一切都应该很好。

# c++ - Qt：创建一个“svg图像按钮”

> ID：815581
> 
> 赞同：7
> 
> 时间：2009-05-02T20:45:26.227
> 
> 标签：c++, qt

我是Qt新手，请原谅我的无知。

我正在尝试使用 QSizePolicy::Preferred 为水平和垂直创建一个“svg 图像按钮”。那部分有效。调整窗口大小时，按钮会按照我想要的方式增长和缩小......但按钮内的图像保持相同大小。我想用按钮缩放图像。我试图重载resizeEvent，并调用setImageSize，但这会无限递归。

```
#ifndef SVGPUSHBUTTON_H
#define SVGPUSHBUTTON_H

#include <QtGui>

class SVGPushButton : public QPushButton
{
public:
    SVGPushButton(QString path, QString name = "");
    ~SVGPushButton();

    void resizeEvent(QResizeEvent * event);
private:
};

#endif // SVGPUSHBUTTON_H

#include "SVGPushButton.h"

SVGPushButton::SVGPushButton(QString svgPath, QString name)
: QPushButton(name)
{
    QIcon icon(svgPath);
    setSizePolicy( QSizePolicy::Preferred, QSizePolicy::Preferred );
    setFlat(true);
    setIcon(icon);
}

SVGPushButton::~SVGPushButton()
{}

void SVGPushButton::resizeEvent(QResizeEvent * event)
{
    setIconSize( event->size() );
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-03T01:41:24.283

这就是我最终解决它的方法：

```
SVGPushButton::SVGPushButton(QString svgPath, QString name)
: QPushButton()
{
    setSizePolicy( QSizePolicy::Preferred, QSizePolicy::Preferred );
    QSvgWidget *icon = new QSvgWidget(svgPath,this);
    setLayout( new QHBoxLayout(this) );
    layout()->addWidget( icon );
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-02T20:56:29.070

避免无限递归很容易。向您的 SVGPushButton 添加一个布尔数据成员，指示您在调整大小事件中，并在您输入事件时检查它，如下所示：

```
void SVGPushButton::resizeEvent (QResizeEvent * event)
{
    if (m_insideResize)
        return;
    m_insideResize = true;
    // call setImageSize()...
    m_insideResize = false;
} 
```

有了这个，你就可以确保它确实做了你想做的事情。让它工作后，您可以尝试找出导致递归调用的原因。我的猜测是您将图像的大小设置为略大于应有的大小，这会导致按钮想要再次调整大小等。
那么解决它的正确方法是找出你想要调整图像大小的正确尺寸。
在此工作之后，为了安全起见，我仍然会保留递归检查以防万一。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-03T00:04:09.213

通过查看文档，看起来您想要做的是`QLabel`在按钮中有一个。然后调用`setPixmap()`标签，然后将属性设置`scaledContents()`为`true`。

现在我不确定是否只是向按钮添加标签会起作用，因为按钮已经具有图标和文本属性。

我会将其标记为社区 wiki，以便您可以根据需要进行更改。

此外，根据我的经验，搞乱`resizeEvent()`很少是一个好主意:-)

# c# - 使用事务或 SaveChanges(false) 和 AcceptAllChanges()？

> ID：815586
> 
> 赞同：359
> 
> 时间：2009-05-02T20:50:03.390
> 
> 标签：c#, entity-framework, transactions

我一直在调查交易，似乎只要我传递`false`给他们，他们就会在 EF 中照顾自己`SaveChanges()`，然后`AcceptAllChanges()`在没有错误的情况下调用：

```
SaveChanges(false);
// ...
AcceptAllChanges(); 
```

万一出事了怎么办？我不必回滚，或者，只要我的方法超出范围，事务就结束了吗？

在事务中途分配的任何 indentiy 列会发生什么情况？我想如果在我的坏之前其他人在我的之后添加了一条记录，那么这意味着将缺少 Identity 值。

有什么理由`TransactionScope`在我的代码中使用标准类吗？

* * *

## 回答 #1

> 赞同：465
> 
> 时间：2009-05-02T21:24:26.007

使用实体框架大部分时间`SaveChanges()`就足够了。这将创建一个事务，或加入任何环境事务，并在该事务中完成所有必要的工作。

有时虽然`SaveChanges(false) + AcceptAllChanges()`配对很有用。

最有用的地方是在您想要跨两个不同上下文执行分布式事务的情况下。

即这样的东西（坏）：

```
using (TransactionScope scope = new TransactionScope())
{
    //Do something with context1
    //Do something with context2

    //Save and discard changes
    context1.SaveChanges();

    //Save and discard changes
    context2.SaveChanges();

    //if we get here things are looking good.
    scope.Complete();
} 
```

如果 `context1.SaveChanges()`成功但`context2.SaveChanges()`失败，则整个分布式事务被中止。但不幸的是，Entity Framework 已经放弃了对 的更改`context1`，因此您无法重播或有效记录失败。

但是，如果您将代码更改为如下所示：

```
using (TransactionScope scope = new TransactionScope())
{
    //Do something with context1
    //Do something with context2

    //Save Changes but don't discard yet
    context1.SaveChanges(false);

    //Save Changes but don't discard yet
    context2.SaveChanges(false);

    //if we get here things are looking good.
    scope.Complete();
    context1.AcceptAllChanges();
    context2.AcceptAllChanges();

} 
```

当调用向`SaveChanges(false)`数据库发送必要的命令时，上下文本身并没有改变，因此如果需要，您可以再次执行此操作，或者您可以根据需要询问`ObjectStateManager`。

`ObjectStateManager`这意味着如果事务实际上引发了异常，您可以通过在某处重试或记录每个上下文的状态来进行补偿。

有关更多信息，请参阅[我的](https://twitter.com/adjames) [博客文章](https://docs.microsoft.com/en-gb/archive/blogs/alexj/savechangesfalse)。

* * *

## 回答 #2

> 赞同：120
> 
> 时间：2014-07-28T21:53:08.810

如果您使用的是 EF6（实体框架 6+），则数据库调用 SQL 的情况已更改。
请参阅：http: [//msdn.microsoft.com/en-us/data/dn456843.aspx](http://msdn.microsoft.com/en-us/data/dn456843.aspx)

使用 context.Database.BeginTransaction。

## 来自 MSDN：

> ```
> using (var context = new BloggingContext()) 
> { 
>     using (var dbContextTransaction = context.Database.BeginTransaction()) 
>     { 
>         try 
>         { 
>             context.Database.ExecuteSqlCommand( 
>                 @"UPDATE Blogs SET Rating = 5" + 
>                     " WHERE Name LIKE '%Entity Framework%'" 
>                 ); 
> 
>             var query = context.Posts.Where(p => p.Blog.Rating >= 5); 
>             foreach (var post in query) 
>             { 
>                 post.Title += "[Cool Blog]"; 
>             } 
> 
>             context.SaveChanges(); 
> 
>             dbContextTransaction.Commit(); 
>         } 
>         catch (Exception) 
>         { 
>             dbContextTransaction.Rollback(); //Required according to MSDN article 
>             throw; //Not in MSDN article, but recommended so the exception still bubbles up
>         } 
>     } 
> } 
> ```

* * *

## 回答 #3

> 赞同：-6
> 
> 时间：2015-03-06T02:19:31.803

因为某些数据库可以在 dbContextTransaction.Commit() 抛出异常所以更好：

```
using (var context = new BloggingContext()) 
{ 
  using (var dbContextTransaction = context.Database.BeginTransaction()) 
  { 
    try 
    { 
      context.Database.ExecuteSqlCommand( 
          @"UPDATE Blogs SET Rating = 5" + 
              " WHERE Name LIKE '%Entity Framework%'" 
          ); 

      var query = context.Posts.Where(p => p.Blog.Rating >= 5); 
      foreach (var post in query) 
      { 
          post.Title += "[Cool Blog]"; 
      } 

      context.SaveChanges(false); 

      dbContextTransaction.Commit(); 

      context.AcceptAllChanges();
    } 
    catch (Exception) 
    { 
      dbContextTransaction.Rollback(); 
    } 
  } 
} 
```

# xml - 仅转换指定元素，丢弃其余元素

> ID：815587
> 
> 赞同：3
> 
> 时间：2009-05-02T20:50:03.967
> 
> 标签：xml, xslt, copy, identity

我正在尝试开发一个 XSLT 样式表，它将通过保持视图将 xml 转换为另一个：

1.  默认情况下，样式表不应该为每个元素显示任何内容（甚至不显示文本）。
2.  如果某个元素存在显式模板匹配，则复制该元素、它的属性及其所有子元素（及其属性）。

换句话说，恒等式只转换明确指定的元素。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-02T20:53:21.107

好吧，对大多数人什么都不做，肯定是这样的：

```
<xsl:template match="/*">
  <xsl:copy>
    <xsl:apply-templates select="*"/>
  </xsl:copy>
</xsl:template>
<xsl:template match="*">
    <xsl:apply-templates select="*"/>
</xsl:template> 
```

然后为您想要的添加匹配*项*：

```
<xsl:template match="Foo | Bar">
    <xsl:copy-of select="."/>
</xsl:template> 
```

然而，这似乎是一个*非常*不寻常的要求。通常，您只需使用通过 xml 知识导航到已知内容的匹配项。

# python - WxPython：FoldPanelBar 没有真正折叠

> ID：815589
> 
> 赞同：1
> 
> 时间：2009-05-02T20:51:28.333
> 
> 标签：python, wxpython, sizer

我使用 FoldPanelBar 编写了以下代码：

```
import wx
import wx.lib.agw.foldpanelbar as fpb

class frame(wx.Frame):
    def __init__(self,*args,**kwargs):
        wx.Frame.__init__(self,*args,**kwargs)
        self.text_ctrl_1=wx.TextCtrl(self,-1,style=wx.TE_MULTILINE)

        self.fpb=fpb.FoldPanelBar(self,-1, style=fpb.FPB_HORIZONTAL)
        self.fold_panel=self.fpb.AddFoldPanel("Thing")
        self.thing=wx.TextCtrl(self.fold_panel,-1, size=(400,-1), style=wx.TE_MULTILINE)
        self.fpb.AddFoldPanelWindow(self.fold_panel, self.thing)

        self.sizer_1=wx.BoxSizer(wx.HORIZONTAL)

        self.sizer_1.Add(self.text_ctrl_1,1,wx.EXPAND)
        self.sizer_1.Add(self.fpb,1,wx.EXPAND)

        self.SetSizer(self.sizer_1)

        self.Show()

if __name__=="__main__":
    app=wx.PySimpleApp()
    frame(None,-1)
    app.MainLoop() 
```

这是折叠前的样子：

[替代文字 http://img23.imageshack.us/img23/4309/before.gif](http://img23.imageshack.us/img23/4309/before.gif)

右侧的文本框位于折叠面板中，因此当我单击箭头时，它会消失。但是，它看起来像这样：

[替代文字 http://img22.imageshack.us/img22/6306/afterz.gif](http://img22.imageshack.us/img22/6306/afterz.gif)

我希望左边的文本框会变大以填满整个框架。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T16:15:57.080

This does what you want I think. I haven't tested multiple panels in the foldpanelbar, you might need to limit the size of the foldpanelbar explicitly to prevent it from getting too wide.

```
import wx
import wx.lib.agw.foldpanelbar as fpb

class frame(wx.Frame):
    def __init__(self, *args, **kwargs):
        wx.Frame.__init__(self, *args, **kwargs)
        self.text_ctrl_1=wx.TextCtrl(self, -1, size=(400, 100),
                                     style=wx.TE_MULTILINE)
        self.fpb = fpb.FoldPanelBar(self, -1,
            style=fpb.FPB_HORIZONTAL|fpb.FPB_DEFAULT_STYLE)
        self.fold_panel = self.fpb.AddFoldPanel("Thing")
        self.thing = wx.TextCtrl(self.fold_panel, -1, size=(400, -1),
                                 style=wx.TE_MULTILINE)
        self.fpb.AddFoldPanelWindow(self.fold_panel, self.thing)
        self.fpb.Bind(fpb.EVT_CAPTIONBAR, self.onCaptionBar)
        self.sizer_1 = wx.BoxSizer(wx.HORIZONTAL)
        self.sizer_1.Add(self.text_ctrl_1, 1, wx.EXPAND)
        self.sizer_1.Add(self.fpb, 0, wx.EXPAND)
        self.SetSizer(self.sizer_1)
        self.ResizeFPB()

    def onCaptionBar(self, event):
        event.Skip()
        wx.CallAfter(self.ResizeFPB)

    def ResizeFPB(self):
        sizeNeeded = self.fpb.GetPanelsLength(0, 0)[2]
        self.fpb.SetMinSize((sizeNeeded, self.fpb.GetSize()[1]))
        self.Fit()

app = wx.App(0)
f = frame(None)
f.Show()
app.MainLoop() 
```

# svn - 如何避免“svn：过时：”问题？

> ID：815604
> 
> 赞同：14
> 
> 时间：2009-05-02T21:00:52.523
> 
> 标签：svn

在使用 svn 的过去几年中，我经常遇到提交会因上述错误而失败的问题。我最初认为这与使用 samba 安装的工作空间有关，但我已经看到它也通过 svn+ssh 远程发生。

这是最近出现的一个例子：

1.  使用 svn move 重命名目录
2.  提交更改到新目录
3.  尝试删除旧目录 - 失败：

    删除（子目录）svn：提交失败（详细信息如下）：svn：过期：事务x中的'（某些路径）/（旧目录）/（子目录）'

补充：当这些问题确实发生时，解决这些问题的最佳方法是什么？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-02T21:10:04.497

查看[有关此问题的 SVN 常见问题解答条目](http://subversion.apache.org/faq.html#wc-out-of-date)。我相信你真的过时了，只需要运行“svn update”。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-02T21:06:35.940

您应该从[Subversion 常见问题解答](http://subversion.tigris.org/faq.html#wc-out-of-date)中检查这些内容：

1.  来自失败提交的碎片乱扔你的工作副本。
2.  混合修订
3.  你可能真的过时了

您的重命名示例指向2号作为问题的根源：如果您提交新目录，则新旧的父目录将混合修订，因此如果您尝试提交父目录，它将失败。通过提交父目录在一个事务中提交移动（这是一个组合的复制和删除）是很有意义的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-02T21:09:30.410

我认为您应该一步完成整个更改，这样 bot 父级和移动的目录将处于同一个修订版中。

在您的情况下，您必须在父目录中执行 svn update ，这将恢复您删除的目录，然后 svn 再次删除它并尝试另一个提交

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-01-03T23:35:39.483

在尝试了所有明显的事情，以及这里的一些其他建议之后，没有任何运气，谷歌搜索导致了这个链接 - [Subversion 说：你的文件或目录可能已经过时了](http://pageworthy.com/blog/2009/apr/14/subversion-says-your-file-or-directory-probably-ou/)

简而言之，诀窍是转到**.svn 目录**（在包含有问题文件的目录中），然后**删除“all-wcprops”文件**。

在没有其他事情的时候为我工作。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-04-24T15:39:58.253

**好吧，我认为。**

1）我在记事本中复制我的修改代码。

2）接下来，更新文件。

3）将记事本的代码复制到更新的文件中。

4）在svn中提交。

# python - 如何使用 Universal Feed Parser 删除 html 标签？

> ID：815606
> 
> 赞同：3
> 
> 时间：2009-05-02T21:01:15.267
> 
> 标签：python, django, feed, parsing

文档列出了默认允许/删除的标签：

[http://www.feedparser.org/docs/html-sanitization.html](http://www.feedparser.org/docs/html-sanitization.html)

但它没有说明如何指定要删除的附加标签。

有没有办法使用 Universal Feed Parser 来做到这一点，或者您是否必须使用您自己的正则表达式和/或 Beautiful Soup 之类的东西进行进一步处理？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-02T21:34:41.037

我快速浏览了代码，我认为没有办法直接覆盖它们。但是你可以覆盖`feedparser._HTMLSanitizer.acceptable_elements`在做之前不会被删除的标签列表`feedparser.parse`

# diagram - 如何制作径向图？

> ID：815607
> 
> 赞同：2
> 
> 时间：2009-05-02T21:02:00.290
> 
> 标签：diagram, radial

有谁知道如何在 .net、java、ruby、php 或 python 中创建径向图？我不在乎哪个。我之前曾要求一个图书馆并到处搜索。我找不到任何东西。如果我要建立自己的，我想我会检查一下是否有人知道资源。

如果可能，首选是在网页中显示它。

感谢您的任何帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-02T22:21:12.580

[我认为您可以使用GraphViz](http://www.graphviz.org/) / [DOT 文件](http://en.wikipedia.org/wiki/DOT_language)实现您的目标。
有大量适用于各种语言的 GraphViz[包和工具。](http://www.graphviz.org/Resources.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-02T21:40:54.640

这类？（[谷歌图表 API](http://code.google.com/apis/chart/)）

![替代文字](https://chart.apis.google.com/chart?cht=rs&chs=200x200&chd=s:voJATd9v,MW9BA9&chco=FF0000,FF9900&chls=2.0,4.0,0.0|2.0,4.0,0.0&chxt=x&chxl=0:|0|45|90|135|180|225|270|315&chxr=0,0.0,360.0&chg=25.0,25.0,4.0,4.0&chm=B,FF000080,0,1.0,5.0|B,FF990080,1,1.0,5.0|h,0000FF,0,1.0,4.0|h,3366CC80,0,0.5,5.0|V,00FF0080,0,1.0,5.0|V,008000,0,5.5,5.0|v,00A000,0,6.5,4)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-09-22T22:37:44.667

我想到的主要想法是：径向图（如overdisk）可以由多个同心饼图组成：最中心：父节点最不中心：叶节点

有一个重要要求：对齐（每个子组都需要与父母对齐）。

==== 编辑：我认为可以使用 Google Chart API 在网络上轻松完成

# google-app-engine - 微小的随机 ID 生成

> ID：815622
> 
> 赞同：6
> 
> 时间：2009-05-02T21:07:10.433
> 
> 标签：google-app-engine, md5

我正在尝试生成用于 Google App Engine 应用程序的唯一 ID，并希望就我正在考虑使用的方法的可行性提供反馈（最后有问题）。我已经阅读了很多关于这个主题的问题，但我不记得遇到过这种特殊的方法。

我想要看起来随机的 ID，例如 MD5 哈希，但我也希望它们很小。沿着 tinyurl 行的四到六个字符将是理想的。ID 将用于用户生成的内容，在我的应用程序的上下文中，例如人们将要编写的测试问题。ID 没有必要看起来是随机的（如果它们看起来像序列 ID 就可以了），但我正在考虑使用的方法适合这一点，所以这不是一个真正的问题。

熟悉 Google App Engine 的人都知道，写入数据存储的成本特别高，如果同一实体组的写入次数过多，可能会导致超时。分片计数器是一种通常用于避免单个全局计数器上的写争用以及随之而来的失败事务的方法。

除了获得短 ID 和避免写入争用之外，我还试图避免生日悖论。我想为有数百万个 ID 的可能性做准备，即使这有点过火了。

我正在考虑按照以下方式使用分片计数器：

*   计数器在用户上分片，因此每个用户都有一个分片。每个计数器对象都有自己的特定于给定用户的计数，当该用户创建新项目时，该计数会增加。无论项目是否成功创建，计数都会增加。
*   ID 的基础是以下字符串的 MD5 哈希：“<user-email-address>|<latest-counter-value>”。
*   然后将生成的 MD5 散列截断，最初截断为四个字符。
*   维护单个全局“长度”值。每当前面的步骤导致重复键时（人们想象这会很快发生），长度的值将增加一。新 ID 的 MD5 哈希现在将被截断为“长度”字符，而不是四个字符。
*   我不想公开用户电子邮件地址，这表明某种哈希值将是一个好方法。

我的问题是：我是否正确地认为这将在很大程度上避免由于重复键而导致的写入争用，并且长度字段上的写入争用可能不是问题，尤其是在更长的长度时？谁能描述这里涉及的数学？长度会很快增加到接近 MD5 哈希的长度，从而质疑整个方法的价值吗？使用完整（更长）的 MD5 哈希以使事情更易于维护会更好吗？有什么我忽略的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-03T03:20:16.027

像这样的东西怎么样：

1.  如果您想要使用 a-zA-Z0-9 的 4 个字符键，那么您将拥有：62^4 = > 1400 万个可能的值。

2.  将其分成 N 个分区： 0000 ... 1000, 1001 ... 2000 , ... , ZZAA ... ZZZZ

    每个分区由一个实体表示：start id end id current id

现在，要生成一个 ID：

1.  随机选择一个分区。使用每个分区的开始键作为键。开始交易：
2.  get_or_create() 那个分区实体。
3.  如果当前 id == 结束 id，则转到步骤 1
4.  保存当前id
5.  将当前 id 增加一个 End Transaction

使用保存为您的 ID 的当前 ID。

如果您选择 N 作为 140，则每个分区将有 100,000 个值。这将允许相当多的并发插入，同时由于选择“空”分区而限制重试次数。

您可能需要更多地考虑这一点。特别是，当您需要移动到 5 位或 6 位数字键时，您将如何处理？

-戴夫

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-03T04:25:27.883

只是为了在上面的问题中添加一些硬数字，我已经实现了一个小程序来按照问题中提到的方式生成 id，这些是其中一次试运行的结果：

```
Length     Count      MD5             Base 62
4          400        3d0e            446
5          925        4fc04           1Myi
6          2434       0e9368          40V6
7          29155      e406d96         GBFiA
8          130615     7ba787c8        2GOiCm
9          403040     75525d163       YNKjL9
10         1302992    e1b3581f52      H47JAIs
Total:     1869561 
```

每次哈希的长度增加时，这是由于碰撞，因此在这种情况下发生了六次碰撞。计数是在冲突之前生成的给定长度的键的数量。MD5 列显示在出现重复键错误之前成功添加的最后一个截断键。最右边的列显示以 62 为基数的键（如果我已正确完成转换）。

看起来每个额外的字符都会生成越来越多的键，这是您可以想象的。我希望这种方法能够适用于用户生成的内容。

对于任何感兴趣的人，以下是我如何获得最后一列的 base 62 表示：

```
def base_62_encode(input):
    "Inspired by code at http://en.wikipedia.org/wiki/Base_36."
    CLIST="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz"
    rv = ""
    while input != 0:
        rv = CLIST[input % 62] + str(rv)
        input /= 62
    return rv

base62_id = base_62_encode(long(truncated_hash, 16)) 
```

* * *

（后来补充：）

这是一个在 Google App Engine 上下文中处理与这些 ID 生成相关的几件事的类。默认情况下，此类生成的密钥不是纯 62 进制的，因为 GAE 密钥名称的第一个字符必须是字母。该要求已在此处通过使用基数 52 作为第一个字符来解决。

通过更改已传递到（或从）构造函数中省略的“clist”值，可以将主基数更改为 62 以外的值。可能想要删除容易混淆的字符，例如“1”、“l”、“i”等。

用法：

```
keygen = LengthBackoffIdGenerator(SomeClass, initial_length=5)
small_id, modified = keygen.small_id(seed_value_from_sharded_counter) 
```

这是课程：

```
class LengthBackoffIdGenerator(object):
    """Class to generate ids along the lines of tinyurl.

    By default, ids begin with a alphabetic character.  Each id that is created is checked against previous ones
    to ensure uniqueness.  When a duplicate is generated, the length of the seed value used is increased by one
    character.

    Ids become gradually longer over time while remaining relatively short, and there are very few retries in 
    relation to the number of keys generated.
    """
    ids = set()

    def __init__(self, cls, clist='0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ', alpha_first=False,
            initial_length=5, check_db=False):
        self.clist = clist
        self.alpha_first = alpha_first
        if self.alpha_first:
            import re
            alpha_list = re.sub(r'\d', '', clist)
            if len(alpha_list) < 1:
                raise Exception, 'At least one non-numeric character is required.'
            self.alpha_list = alpha_list
        self.cls = cls
        self.length = initial_length
        self.check_db = check_db

    def divide_long_and_convert(self, radix, clist, input, rv):
        "Inspired by code at http://en.wikipedia.org/wiki/Base_36."
        rv += clist[input % radix]
        input /= radix
        return (input, rv)

    def convert_long(self, input):
        rv = ""
        if self.alpha_first:
            input, rv = self.divide_long_and_convert(len(self.alpha_list), self.alpha_list, input, rv)
        while input != 0:
            input, rv = self.divide_long_and_convert(len(self.clist),      self.clist,      input, rv)
        return rv

    def hash_truncate_and_binify(self, input, length):
        """Compute the MD5 hash of an input string, truncate it and convert it to a long.

        input  - A seed value.
        length - The length to truncate the MD5 hash to.
        """
        from assessment.core.functions import md5_hash
        input = md5_hash(input)[0:length]
        return long(input, 16)

    def _small_id(self, input):
        """Create an ID that looks similar to a tinyurl ID.

        The first letter of the ID will be non-numeric by default.
        """
        return self.convert_long(self.hash_truncate_and_binify(input, self.length))

    def small_id(self, seed):
        key_name = self._small_id(seed)
        increased_length = False
        if self.check_db and not self.cls.get_by_key_name(key_name) is None:
            self.ids.add(key_name)
        if key_name in self.ids:
            self.length += 1
            increased_length = True
            key_name = self._small_id(seed)
        self.ids.add(key_name)
        return (key_name, increased_length) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-08T09:40:46.943

这个算法很聪明，并且确实可以最小化写操作。**所以长度值将收敛到最短长度和没有**碰撞 之间的平衡。

您可以通过使用哈希表中使用的策略来放松没有冲突的约束。在回退到增加长度之前尝试一些其他唯一 ID。

因此，我建议您在初始化为 0 的散列字符串的末尾添加一个测试计数器。如果生成的 ID 已被使用，请增加计数器并重试，直到在增加长度后达到最大计数器值。

您最终将更有效地使用您的 ID 地址空间，并且长度增量的频率要低得多。

关于您关于 MD5 长度限制的问题，我认为选择 MD5 是一种矫枉过正。您真的不需要加密（伪）安全哈希。您需要的是一个随机位生成器，您可以使用 crc32 （或更快的 adler）。特别是如果代码要在手机上运行。要使用 crc32 实现随机位生成器，请在字符串前面添加一个 32 位值以进行散列，并使用您选择的常量值（种子）对其进行初始化。然后计算这个字符串的 crc32。如果需要更多字节，将得到的 crc32 值写入字符串前面的 32 位，重新计算 crc32。迭代直到你有足够的位。您可以用您选择的算法替换 crc32。这产生了一个廉价且快速的随机位生成器，其中初始常数是种子。

使用此算法，您可以最大限度地减少生成的随机位数，并且长度也没有上限。

关于编码，您没有指定约束。你可以在数字上使用大写和小写字母吗？您的示例使用 36 个不同 ASCII 值的字母表。一旦你有了上面描述的可以生成任意多字节的伪随机数生成器，只需将长度定义为你的 ID 的字母数，然后用下一个随机字节的模数选择下一个字母。然后您将确切知道一次生成多少字节，并且生成 ID 是微不足道的。

# database - 做或不做：将图像存储在数据库中

> ID：815626
> 
> 赞同：34
> 
> 时间：2009-05-02T21:09:07.730
> 
> 标签：database, performance, blob

在 web 应用程序的上下文中，我的老老板总是说在数据库中放一个对图像的引用，而不是图像本身。我倾向于同意将 url 与图像本身存储在数据库中是一个好主意，但是我现在工作的地方，我们在数据库中存储了很多图像。

我能想到的唯一原因可能是它更安全？您不希望有人直接链接到网址吗？但如果是这种情况，您始终可以让网站/服务器处理图像，例如 asp.net 中的处理程序，以便用户需要进行身份验证才能查看图像。我还认为从数据库中提取图像会损害性能。将图像存储在数据库中可能是个好主意/不太好主意的任何其他原因？

* * *

**完全重复：** [用户图像：数据库或文件系统存储？](https://stackoverflow.com/questions/585224/user-images-database-vs-filesystem-storage)
**完全重复：** [在数据库中存储图像：是还是不是？](https://stackoverflow.com/questions/3748/storing-images-in-db-yea-or-nay)
**完全重复：** [我应该将图像存储在数据库还是文件夹中？](https://stackoverflow.com/questions/713243/should-i-store-my-images-in-the-database-or-folders)
**完全重复：** [您会将二进制数据存储在数据库还是文件夹中？](https://stackoverflow.com/questions/662488/would-you-store-binary-data-in-database-or-in-file-system)
**完全重复：** [将图片存储为文件或网络应用程序的数据库？](https://stackoverflow.com/questions/561447/store-pictures-as-files-or-in-the-database-for-a-web-app)
**完全重复：** [存储少量图像：blob 还是 fs？](https://stackoverflow.com/questions/325126/storing-a-small-number-of-images-blob-or-fs)
**完全重复：** [将图像存储在文件系统或数据库中？](https://stackoverflow.com/questions/766048/store-image-in-database-or-in-a-system-file)

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2009-05-02T23:26:47.803

将图像放入数据库的优点。

1.  交易。保存 blob 时，您可以像提交任何其他数据库数据一样提交它。这意味着您可以将 blob 与任何关联元数据一起提交，并确保两者同步。如果磁盘空间不足？没有承诺。文件没有完全上传？没有承诺。愚蠢的应用程序错误？没有承诺。如果保持图像及其相关元数据彼此一致对您的应用程序很重要，那么数据库可以提供的事务可能是一个福音。

2.  一个系统来管理。需要备份元数据和 blob？备份数据库。需要复制它们吗？复制数据库。需要从部分系统故障中恢复？重新加载数据库并向前滚动日志。DB 为一般数据带来的所有优势（卷映射、存储控制、备份、复制、恢复等）都适用于您的 blob。一致性更高，管理更轻松。

3.  安全。数据库具有可以利用的非常细粒度的安全功能。模式、用户角色，甚至诸如“只读视图”之类的东西，以提供对数据子集的安全访问。所有这些功能也适用于保存 blob 的表。

4.  集中管理。与 #2 相关，但基本上 DBA（好像他们没有足够的权力）可以管理一件事：数据库。现代数据库（尤其是大型数据库）在跨多台机器的大型安装中运行良好。单一管理来源简化了程序，简化了知识转移。

5.  大多数现代数据库都可以很好地处理 blob。借助数据层中对 blob 的一流支持，您可以轻松地将 blob 从数据库流式传输到客户端。虽然您可以执行一些操作，但会一次性“吸入”整个 blob，但如果您不需要该工具，请不要使用它。研究数据库的 SQL 接口并利用其功能。没有理由将它们视为“大字符串”，它们被单独处理并将您的 blob 变成大的、内存吞噬、缓存粉碎的炸弹。

6.  就像您可以为图像设置专用文件服务器一样，您可以在数据库中设置专用 Blob 服务器。给他们专用的磁盘卷、专用的模式、专用的缓存等。数据库中的所有数据都不相同，或者行为相同，没有理由将其配置为完全相同。好的数据库具有良好的控制水平。

从数据库中提供 blob 的主要任务是确保您的 HTTP 层实际上利用所有 HTTP 协议来执行服务。

许多幼稚的实现只是简单地抓取 blob，然后将它们全部倾倒到套接字中。但是 HTTP 有几个非常适合流式传输图像等的重要特性。特别是缓存标头、ETag 和分块传输以允许客户端请求 blob 的“片段”。

确保您的 HTTP 服务正确地处理所有这些请求，并且您的数据库可以成为一个非常好的 Web 公民。通过将文件缓存在文件系统中以供 HTTP 服务器提供服务，您可以获得“免费”的一些优势（因为一个好的服务器无论如何都会为“静态”资源做到这一点），但请确保如果您这样做，您尊重图像的修改日期等。

例如，有人请求 spaceshuttle.jpg，这是 2009 年 1 月 1 日创建的图像。最终在请求日期（例如 2009 年 2 月 1 日）缓存在文件系统上。之后，图像从缓存中清除（FIFO 策略, 或其他)，然后有人在 2009 年 3 月 1 日再次请求它。好吧，现在它有一个 2009 年 3 月 1 日的“创建日期”，尽管它的创建日期实际上是 1 月 1 日。所以，你可以看到，特别是如果你的缓存经常转，客户端可能正在使用 If-修改后的标头可能会获得比实际需要更多的数据，因为服务器认为资源已更改，而实际上并未更改。

如果您将缓存创建日期与实际创建日期保持同步，则问题可能会更小。

但关键是，为了成为“优秀的网络公民”，需要仔细考虑整个问题，并为您和您的客户节省一些带宽等。

我刚刚为一个从数据库提供视频的 Java 项目完成了所有这些工作，这一切都是一种享受。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-05-02T21:16:23.890

如果您*有时*需要检索图像并且它必须在多个不同的 Web 服务器上可用。但我认为差不多就是这样。

*   如果它不必在多个服务器上可用，最好将它们放在文件系统中。
*   如果它必须在多台服务器上可用并且系统中实际上存在某种负载，那么您将需要某种分布式存储。

我们在这里讨论的是一个边缘案例，您可以通过利用数据库来避免给您的系统增加额外级别的复杂性。

除此之外，不要这样做。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-05-02T21:28:43.237

我知道如果您将图像存储在数据库中（甚至提到它），大多数数据库专业人员都会对您表示不满和嘶嘶声。是的，当使用数据库作为任何类型的大块二进制数据的存储库时，肯定会影响性能和存储（图像往往是最常见的无法标准化的数据位）。但是，在大多数情况下，图像的数据库存储不仅是允许的，而且是*可取*的。

例如，在我以前的工作中，我们有一个应用程序，用户可以在其中将图像附加到他们正在编写的报告的几个不同点，并且这些图像必须在完成后打印出来。这些报告是通过 SQL Server 复制移动的，如果尝试以任何可靠性跨多个系统和服务器管理这些图像和文件路径，将会带来巨大的麻烦。将它们存储在数据库中为我们“免费”提供了所有这些，并且报告工具不必进入文件系统来检索图像。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-05-02T21:18:32.167

我的一般建议是不要将自己局限于一种方法或另一种方法——使用适合情况的技术。文件系统非常擅长存储文件，而数据库非常擅长根据请求提供一口大小的数据块。另一方面，我公司的一个产品要求将应用程序的整个状态存储在数据库中，这意味着文件附件也会存储在数据库中。使用我们的数据库服务器 (SQL Server 2005)，即使是大型客户和数据库，我也没有遇到明显的性能问题。

Microsoft 的 SQL 2008 通过 FileStream 功能为您提供了两全其美的功能 - 可能值得一试。 [http://technet.microsoft.com/en-us/library/bb933993.aspx](http://technet.microsoft.com/en-us/library/bb933993.aspx)

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-05-02T21:14:06.187

将图像存储到数据库的优点之一是它可以跨系统移植并且独立于文件系统布局。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-05-02T21:13:23.803

最简单/最高性能/最具可扩展性的解决方案是将图像存储在文件系统上。如果需要考虑安全性，请将它们放在 Web 服务器无法访问的位置，并编写一个脚本来处理安全性并提供文件。

假设您的 Web/应用服务器和 DB 服务器是不同的机器，您将图像放入 DB 会受到一些影响：(1) 两台机器之间的网络延迟，(2) DB 连接开销，(3) 消耗额外的 DB提供的每个图像的连接。我会更关心最后一点：如果您的站点提供大量图像，您的 Web 服务器将消耗许多数据库连接并可能耗尽您的连接池。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2009-05-02T21:16:27.120

如果您的应用程序在多台服务器上运行，我会将您的图像的参考副本存储在数据库中，然后根据需要将它们缓存在文件系统上。与尝试横向同步文件系统相比，这样做更不容易出错。

如果您的应用程序位于单个服务器上，那么是的，请坚持使用文件系统并让数据库维护数据的路径。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-05-02T22:37:12.650

大多数 SQL 数据库当然在设计时并没有考虑到提供图像，但是将它们放在数据库中会带来一定的便利。

例如，如果您已经有一个数据库正在运行并配置了复制。您立即拥有一个 HA 映像存储，而不是尝试进行一些基于 rsync 或 nfs 的文件系统复制。此外，拥有一堆 Web 进程（或设计一些新服务）来将文件写入磁盘会稍微增加您的复杂性。真的，它只是更多的活动部分。

至少，我建议将有关图像的“元”数据（例如任何权限、谁拥有它等）和实际数据分开到不同的表中，这样可以很容易地切换到不同的数据存储线。再加上某种 CDN 或缓存应该可以在一定程度上为您提供相当不错的性能，所以我认为这取决于该应用程序需要的可扩展性以及您如何在易于实现的情况下平衡它。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-05-02T21:12:46.673

您不必存储 URL（如果您觉得这不安全）。您可以只存储一个在其他地方引用图像的唯一 ID。

数据库存储往往比文件系统更昂贵且维护成本更高——因此我不会在数据库中存储大量图像。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-05-02T21:32:00.467

*   数据数据库
*   文件的文件系统

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-05-02T22:40:09.960

当您在数据库中存储 TB 的图像数据时，灾难恢复绝对没有乐趣。您最好找到一种更好的方法来分发数据以使其更可靠等......当然，复制时所有的开销（上面提到的）都会成倍增加等等......

只是不要这样做！

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-05-02T22:55:14.447

这看起来真的像一个 KISS（保持简单愚蠢）问题。文件系统是为了方便处理图片文件的存储而设计的，但在数据库中做起来并不容易，而且容易弄乱数据。当您只需担心文件安全性时，为什么还要在 sql 和渲染中遇到性能损失和所有困难？您还可以使用 NFS 或 CIFS 处理混合系统。文件系统是成熟的技术。更简单，更健壮。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-05-03T03:07:37.710

我将图像存储在数据库中以用于演示应用程序。我这样做的原因是安全 - 删除我不应该删除的记录不是一个大问题，但删除我不应该删除的文件可能是个问题！

如果性能成为问题，我会调查流氓文件删除是否真的有可能。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-05-04T11:36:36.793

如果是定期从数据库中提取的图像，我总是会尝试使用文件系统。

如果是需要偶尔拉出的图像，并将它们保存在数据库中会使生活更轻松，我对此完全没有问题。

# javascript - 带有事件的 javascript cloneNode

> ID：815642
> 
> 赞同：1
> 
> 时间：2009-05-02T21:16:30.440
> 
> 标签：javascript, gmail, greasemonkey

我正在为gmail编写一个greasemonkey脚本，我需要在其中复制“收件箱”链接。使用 cloneNode 工作正常，但我认为有一个 onclick 事件会在运行时附加到它。所以，这是一个由两部分组成的问题： 1\. 有没有办法查看节点上附加了哪些事件？2\. 有没有办法复制这些事件？我发现的最接近的东西是 jQuery，我还没有准备好去那里。谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-02T21:29:42.220

1.  除非它是使用`onclick`元素上的属性设置的。
2.  不可靠（您可以复制该`onclick`属性，但它是否会继续工作取决于它是否被使用以及它的作用）。

您最好添加自己的`click`处理程序，然后在原始事件上触发该事件......或者以其他方式模拟行为。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-10T18:20:03.307

我认为我们可以使用这个理论来解决这个问题：

我们在 JS 中有 NodeList，也称为 liveLists。我们可以检查它们的长度何时发生变化，将所需的公共事件添加到列表中 (length-1) 处的新元素。

说啥....

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-10T19:02:06.093

这是使用 Nodelist 添加事件的示例。

```
<body>
        <div id="one" class="clones" style="background:red;width:100px;height:100px"></div>
    </body>

    <script>

        //Selecor based live list [Advantage]
        var nodeList = document.getElementsByClassName('clones')

        //Common Function for nodelist
        nodeList.addEvents = function(){
            nodeList.item(nodeList.length-1).addEventListener('click',function(){
                    console.log(this.id);
            });
        }
        nodeList.addEvents();

        //Making Clone
        var _clone  =  document.getElementsByTagName('div')[0].cloneNode(true);

        //Changing Id
        _clone.id="two"

        document.body.appendChild(_clone);
        nodeList.addEvents();
    </script> 
```

# visual-studio - VS 2008 - 发布网站 - 排除 App_Data

> ID：815643
> 
> 赞同：1
> 
> 时间：2009-05-02T21:16:52.563
> 
> 标签：visual-studio, visual-studio-2008, deployment

如何防止 Visual Studio 2008（标准版）发布 App_Data 文件夹？我无法发布 App_Data 的内容，因为它无情地覆盖了生产数据。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-03T22:14:11.293

The publish dialog has a checkbox option at the bottom to "Include files from the App_Data folder".

# javascript - 基于 Ajax 的 Web 应用程序的替代“html”界面

> ID：815644
> 
> 赞同：0
> 
> 时间：2009-05-02T21:17:34.527
> 
> 标签：javascript, ajax, browser

在基于 Ajax 的网络应用程序中，是否必须为那些没有启用 javascript 且连接速度慢的用户提供替代的“html”界面？

例如，Google Mail 提供 Ajax 和纯 HTML 应用程序**，但**Microsoft SharePoint 不提供。

我们是否必须关心它们（禁用 javascript/慢速连接）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-02T21:22:40.613

这确实是一个你需要自己回答的问题。您需要能够衡量在没有 Ajax 支持的情况下不提供/支持人员会拒绝什么样的用户群。此外，您可能需要考虑 SEO 和/或可访问性方面。

如果这是一个内部/控制的网络应用程序，那么我不会太担心它。但是，对于一个公共网站，我倾向于针对最低公分母进行编程并从那里开始构建。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-02T21:32:00.607

“强制的”？“不得不”？根据谁？没有法律规定您必须（至少在美国），除非您碰巧签订了需要遵守[第 508 节](http://www.section508.gov/)的政府合同（对盲人等残疾人的[无障碍访问](http://www.w3.org/TR/WAI-WEBCONTENT/)；JavaScript 解决方案可能无法在屏幕阅读器）或任何您当地的同类产品。

现在，你应该吗？可能是。你真的想告诉那些喜欢在禁用 JavaScript 的情况下运行的用户他们不能使用你的服务吗？或者您是否希望那些在处理器速度较慢且可能更糟糕或不支持 JavaScript 的手机上运行的人无法使用您的服务？还要考虑您的盲人用户，他们可能会通过屏幕阅读器使用您的网站。此外，如果所有内容都在页面的静态版本中，而不是隐藏在通过 XMLHTTPRequest 加载的内容中[，搜索引擎更容易为您的站点编制索引。](http://google.com/support/webmasters/bin/answer.py?answer=35769)一个设计良好的静态网站也可以比基于 JavaScript 的动态网站更容易适应[REST](http://en.wikipedia.org/wiki/Representational_State_Transfer)类型的 API。

当然，总有一些应用程序作为静态 HTML 页面没有意义。如果您正在使用 HTML5 实现绘图应用程序`canvas`，那么真的没有办法让它成为静态的。但总的来说，如果你可以做一个静态版本，并且不会增加太多的项目成本，你可能应该这样做。事实上，有些人主张你先做一个纯 HTML 静态版本，并将样式和 JavaScript 视为静态版本的[渐进](http://en.wikipedia.org/wiki/Progressive_enhancement) [增强](http://www.alistapart.com/articles/understandingprogressiveenhancement)，而不是主要关注点。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-02T21:35:44.123

这不是强制性的。取决于如果某人没有设法做他需要做的事情的重要性，您决定是否实施“html”唯一的替代方案。

例如，它在 eshop 中很重要**，**而在社交网站的照片库中可能没有那么重要

# java - 无法将客户端包中的类与 GWT 一起使用

> ID：815645
> 
> 赞同：2
> 
> 时间：2009-05-02T21:17:50.890
> 
> 标签：java, gwt

我正在尝试在 com.mycompany.myproject.client 中的类中使用包 com.mycompany.myproject 中声明的 myType 类，但编译时出现以下错误：

> [错误] 行 [X]：无法解析导入的 com.mycompany.myproject.myType

如果我尝试运行托管浏览器，我会得到：

> [ERROR] Line [X]: No source code is available for type com.mycompany.myproject.myType; 你忘了继承一个必需的模块吗？

任何的想法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-02T22:13:07.420

此错误意味着 GWT 编译器找不到您的类。GWT 编译器只能为您的项目找到 .gwt.xml 文件引用的类。

这一切都在这里解释： [http ://code.google.com/webtoolkit/doc/latest/DevGuideOrganizingProjects.html](http://code.google.com/webtoolkit/doc/latest/DevGuideOrganizingProjects.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-02T22:31:46.453

编译器首先扫描应用程序的 module.gwt.XML。然后，模块 XML 可以或继承其他模块 xml。模块还可以声明它们希望哪些包对编译器可见。

不仅将 •.java 文件放在编译路径上，还必须使用模块 XML 机制。这是因为不是所有的子包都应该是可翻译的，例如一个 servlet 组件，它补充了客户端预期的组件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-05T09:14:43.240

项目结构：

*   com.mycompany.service
*   com.mycompany.myproject
    *   客户
    *   服务
    *   我的项目.gwt.xml

默认情况下，源包是“client”，它与 gwt.xml 文件放在同一目录中。如果要添加或更改源目录 - 您必须编辑 gwt.xml。

1) 例如，您想让 gwt 包“com.my~ny.p~ct.service”可用。在 gwt.xml 文件中添加 <source path="service"/>。

路径属性值，例如“../”、“.” - 不管用。

2）如果你想提供“com.my~ny.service”包。

在 com.mycompany 中创建模块（gwt.xml 文件），
其中您有点源目录
并继承默认 gwt 用户模块。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-07T21:10:48.243

我遇到了类似的问题，我设法找到了一种[解决方法](https://stackoverflow.com/questions/958879/problems-passing-class-objects-through-gwt-rpc/962823#962823)，在这种情况下可能会对您有所帮助。

# javascript - 帮助修改 jquery 插件：jsRepeater

> ID：815646
> 
> 赞同：0
> 
> 时间：2009-05-02T21:17:55.757
> 
> 标签：javascript, jquery, jquery-plugins

[jsRepeater](http://jsrepeater.devprog.com/introduction.html)（jquery 的模板引擎）具有[输出格式](http://jsrepeater.devprog.com/formatting.html)，可让您向模板引擎传递一个函数，该函数将在引擎呈现最终值之前执行。

当我循环遍历一组值时，我希望格式化函数除了一个值之外还接收整个数组。

**如何修改格式化函数调用，使其获得单个值和数组？**我试图绝望地摸索代码，但无法弄清楚。

### 数据示例：

```
var data = {items:[{"file_name":"test1.txt", "file_size":5000,"bytes_sent":2500},     
{"file_name":"test2.txt", "file_size":6000, "bytes_sent":3000}]}; 
```

### 模板示例：

```
<div>Bytes Remaining: ${file_size:formatRemaining}</div> 
```

### 格式化功能：

```
 function formatRemaining(data, row) {  
  var remaining = data - row[bytes_sent];
  return remaining;
} 
```

在此示例中，我希望我的格式化函数对“文件大小”和“发送的字节数”进行计算，以输出要发送的剩余字节数。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-06T04:12:56.657

我最终创建了自己的 jquery 插件，它完全符合我的要求。

# php - 理想的“始终/随处可用”的 Web 开发环境？

> ID：815651
> 
> 赞同：6
> 
> 时间：2009-05-02T21:19:52.163
> 
> 标签：php, development-environment, usb-drive

**理由：**

*如何尽可能轻松地从多个相距较远的位置和计算机使用相同的代码进行编辑和推进？*

我有这个想法有一段时间了。当我不得不从不同的计算机上处​​理一个项目时，我经常遇到问题，因为我没有采取任何措施或任何措施来缓解这种情况。这部分是由于我很少做自由项目，而且它们通常是小型网站。

想象一下，你需要在家里处理一个项目，在那里你有设置数据库、网络服务器、phpmyadmin 以及让你的应用程序运行所需的一切。然后你去你女朋友家过周末，但你需要推进项目，在那段时间你想做一些编码。

我目前正在做的是归档我的整个项目，通常还有一个 DB 转储，并将其放在 ftp 主机上，以便以后需要时可以访问它。我可能不必解释这可能是多么乏味，特别是如果您需要在当前所在的 PC 上设置整个环境。

**注意事项：**

*   将我的家用 PC 变成启用了远程桌面的开发服务器 - 这样做的问题是远程连接并不总是快速而简洁的，因为人们需要它才能进行 RAD。这也意味着必须始终在家里打开 PC，不管我什至可能不需要它，如果说，周末有更好的事情要做。我可能需要购买 UPS，因为这里时常发生停电。我已经不喜欢这个解决方案了。

*   在公共托管服务和结帐代码处创建数据库和 SVN 存储库。这仍然存在一些问题，因为您可能需要在每次更换计算机时安装软件、SVN 客户端并最终编辑一些配置。哦，和之前的“解决方案”一样——你完全依赖互联网访问。

*   购买一台 Eee PC 并随身携带 - 这样您就可以随身携带所有环境。也不需要网络。你必须把这该死的东西拖到周围，即使它很小，也不是你口袋里装得下的东西。我还认为这些 EEE PC 不太适合普通编码（小键盘、屏幕等）。

*   最后，我一直在考虑一个理想的场景，我有一个 Linux 发行版，它可以放在一张 CD 甚至一个[**闪存驱动器**](http://www.pendrivelinux.com/)上。在最新版本中，您可以始终拥有所有环境以及所有项目。你可以把它放在你的口袋里。Nova days 所有的电脑都有内置的 USB 端口，相反并不是每台电脑都有 CD ROM。

考虑到这一点，我认为最后一个解决方案是最佳的并且完全令人满意。问题是，我不是很精通 linux，而且我也没有太在意它。尤其是闪存驱动器操作系统。

**底线问题**：

1.  您是否同意闪存驱动器是最佳解决方案？有没有更好的实践可以投入工作？也许我应该重新考虑这种工作方式？:)
2.  你认为像[http://www.pendrivelinux.com/](http://www.pendrivelinux.com/)这样的闪存驱动器操作系统完全适合这种 Web 开发环境吗？有更好的操作系统候选者吗？
3.  通常从 USB 启动有什么问题吗？当然，我想这在大多数 PC 上应该不是问题？
4.  您在同一个项目的多个地点工作的个人经历是什么？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-02T21:36:46.523

这是另一种解决方案：携带一个便携式硬盘驱动器，该硬盘驱动器具有便携式安装的虚拟机播放器和具有您需要的所有开发工具的虚拟机。只需将其插入任何可用的计算机，启动 VM，将其置于全屏模式，您就可以开始使用了。具有不必弄乱 live-cd 或 live-usb Linux 设置的优点，特别是因为您说您对 Linux 不是很熟悉。

编辑：你也可以从闪存驱动器上运行你的虚拟机，尽管性能会很糟糕。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-02T21:23:17.350

你真的应该买一台笔记本电脑，在这台机器上完成所有的编码。使用上网本和/或拇指驱动器并不是一个长期的解决方案。我有一台 MacBook，我用它来完成所有的编码工作。当我在家时，它连接到一个 21 英寸的显示器和一个完整的键盘和鼠标。当我需要旅行时，我会拔下所有电源线并将其放入包中。由于我使用同一台机器，我不必担心来回迁移文件或设置，虽然屏幕有点小，但在旅途中完成一些工作也不错。

如果我不能随身携带笔记本电脑，我会在 Linux 服务器上建立一个开发环境。但是，此解决方案高度依赖于您正在进行的开发类型以及您对 Linux 和命令行的熟悉程度。对于刚起步的人，我绝对不推荐它。但是，使用 Screen 和 Emacs（或者 vim，如果您喜欢这种方式），您可以在任何可以访问 Internet 的地方拥有一个成熟的开发环境。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-02T21:38:55.083

笔记本电脑：太贵了，键盘太小了，写代码很烦人。

远程处理桌面：你会感觉到延迟，甚至几分之一秒，一天后你会发疯。

SVN：总是需要到处安装相同的软件（存储库客户端、FTP、文本编辑器、mysql 等）太麻烦了。

我的解决方案是我个人使用的……USB闪存驱动器！

安装所有软件的便携式版本。我设法找到了我需要的所有东西的便携版本：

小猫 (SSH)

Filezilla (SFTP)

USBWebserver（Apache 2、PHP 5、Mysql 5、PHPMyAdmin）

记事本++ 5，Eclipse PDT（PHP IDE）

SNES9X (snes 模拟器) ;)

Keepass（密码加密器数据库的东西）

HeidiSQL（类似于 PHPMyAdmin）

Menu（有点系统托盘菜单的东西）

我所有项目/音乐/笔记的目录

这是一个[很好的链接](http://www.portablefreeware.com/all.php)，我在其中找到了我的大部分软件。

PS 适用于 Windows 和 Linux（通过 wine）。我还在上面放了一个自动运行的 ini 文件，所以当我插入它时，我的系统托盘菜单程序运行并且 apache/mysql 启动。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-02T21:24:35.740

我认为 SSH 可以解决所有问题。无论我身在何处，它都能让我完全控制我的服务器，它不仅让我可以访问 shell，还可以上传和下载文件，以及使用端口转发。

如果我只需要做一些快速的调整，我通常只是通过 SSH 连接到服务器并使用 nano 或类似的东西来进行编辑。结合屏幕，它实际上可以是一个令人惊讶的高效环境。

当我需要做更严肃的工作时，我会下载 notepad++（免费）和 expandrive（Windows 等效于 sshfs，30 天演示可用）。这使我可以远程编辑文件，就像它们存在于我的本地硬盘上一样（尽管它需要良好的连接）。非常有成效。:)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-02T21:39:24.630

上网本怎么样？我听说 Scott Hanselman 之类的人使用效果很好的一款来运行 Visual Studio 和 SQL Server 进行 ASP.NET 开发，所以我相信它们的功能足以满足您的需求。

屏幕尺寸可能是一个限制，但更小、更轻的单元具有很大的优势。与我共事的几个人推荐了[华硕 Eee 901 。](http://eeepc.asus.com/global/product901.html)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-02T21:48:08.337

我将[Dropbox](http://getdropbox.com/)用于不依赖安全性的代码项目。

至于开发环境，我的需求很少，所以通常一份 Notepad++ 就足够了。目前，这是在我使用的每台机器上本地安装的，但我已经考虑过在 USB 驱动器上使用便携式安装的想法。

但是，您的需求比我的要复杂得多，在我看来，建议的笔记本电脑可能是您的最佳选择

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-03T10:57:10.983

我认为开发人员的计算机就像一件泳衣。当您使用的不是您的时，您会非常清楚。此外，众所周知，我们发现的任何计算机都极有可能存在一千个问题，这些问题将影响我们的假设以及我们的 USB/VM 选项的持续成功。我想大多数人都会同意这将取决于我们项目的优先级以及我们对在特定时刻无法运行的可能性的容忍度。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-02T21:24:37.893

简单的答案：笔记本电脑。是的，它不像手机那么小……但它让你的编码变得如此容易。

# zsh - 无法将“X”放在右侧提示符以指示 Zsh 中的作业数

> ID：815652
> 
> 赞同：2
> 
> 时间：2009-05-02T21:20:04.100
> 
> 标签：zsh, prompt, job-control

本文[的](http://www.miek.nl/blog/archives/2008/02/20/my_zsh_prompt_setup/index.html)代码对我不起作用。我已将其所有代码粘贴到我的 .zshrc 中。

我有以下内容`.zshrc`

```
RPROMPT='%{\[0;33m%}%1v%{\[0m%}' 
```

它应该表明您是否有工作。但是，它不适合我。

我想在正确的提示符处加一个 X，表示您有工作正在运行。

**如果您在 Zsh 中有多个工作，您如何获得显示 X 的正确提示？**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-08T06:41:30.773

您正在使用的代码将不起作用，因为它正在尝试使用`$psvar`您尚未设置的变量。可能那篇文章在其他地方提到了它。

无论如何，要显示 中的作业数`RPROMPT`，请使用

```
$> RPROMPT="%j Job(s)" 
```

如果您至少有一项工作正在运行，要让它显示“X”，请使用

```
$> RPROMPT="%1(j.X.)" 
```

查看手册`zshmisc`页的提示部分，或获取链接： http: [//www.manpagez.com/man/1/zshmisc/](http://www.manpagez.com/man/1/zshmisc/)。它解释了可用于在提示中显示信息的所有扩展序列。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-08T06:29:05.330

看起来您的 ANSI 转义序列中缺少额外的左括号，而且我认为这并没有`\[`达到您的预期。

这就是你想要的：

```
RPROMPT="%(1j.%{^[[33m%} X%{^[[0m%}.)" 
```

但是，您可能会发现提示显示后台有*多少*作业更有用：

```
RPROMPT="%(1j.%{^[[33m%} (%j jobs)%{^[[0m%}.)" 
```

**注意**：`^[`以上是文字转义字符——例如，`0x1B`. 在命令行上（或者在 Vim 的插入模式下，如果你使用 Vim 来编辑你的`.zshrc`），输入 Control-V 然后 Control-[ 来插入一个转义字符。

# iphone - iPhone SDK 3.0 beta 4 损坏，内部错误

> ID：815655
> 
> 赞同：1
> 
> 时间：2009-05-02T21:22:28.243
> 
> 标签：iphone, objective-c, xcode, macos, sdk

**最终编辑：这个问题解决了，在我降级到 SDK for iPhone 2.2 后，然后删除了管理器窗口中崩溃日志中的所有文件（然后升级回 3.0 beta 4）。显然有太多与我的 iPhone 相关的崩溃日志（比如 300+）。谢谢大家的见解！**

原始问题：在我将我的 iPhone SDK 更新到最新的 Beta 4（4 月 28 日发布）后，Xcode 在我打开它时完全崩溃，给我留下了这个：

[替代文字 http://ivzhao.com/temp/sdkbroken.jpg](http://ivzhao.com/temp/sdkbroken.jpg)

有人知道这个内部错误，NSCFString 越界业务是什么吗？现在我什至无法打开 Xcode 来进行一些正常的、非 iPhone 相关的编程。太令人沮丧了。

我的猜测可能与我的设备有关（在管理器窗口中）。那么有没有办法删除我的 iPhone 配置文件（Ivan Zhao 的 iPhone），这样我就可以开始一个新的了。我尝试卸载/重新安装 SDK，但我的旧 iPhone 的配置文件仍然存在。

编辑：我从控制台（应用程序/实用程序/控制台）复制粘贴了错误消息。现在看起来外部编辑器兼容性有问题（我使用 TextMate 作为我的外部文本编辑器。）现在的问题是我什至无法打开 Xcode->Preference 将文本编辑器设置回 Xcode 的默认值。有任何想法吗？

> 03/05/09 9:22:49 PM Xcode[2457] 加载 /Library/InputManagers/Edit in ODBEditor/Edit in ODBEditor.bundle/Contents/MacOS/Edit in ODBEditor 时出错：dlopen(/Library/InputManagers/Edit in ODBEditor /Edit in ODBEditor.bundle/Contents/MacOS/Edit in ODBEditor, 265)：找不到合适的图像。确实找到：/Library/InputManagers/Edit in ODBEditor/Edit in ODBEditor.bundle/Contents/MacOS/Edit in ODBEditor: GC 能力不匹配
> 
> 03/05/09 9:22:50 PM Xcode[2457] ODCompletionDictionary（版本 4.1.v255）已加载
> 
> 03/05/09 9:22:51 PM Xcode[2457] 引发了未捕获的异常

谢谢，请帮帮我；我的发展生活现在陷入了停滞：（

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-03T03:15:26.600

尝试删除 Completion Dictionary，这是一个与 Xcode 挂钩的第三方扩展。其中一部分没有加载，因为它与 Objective-C 垃圾收集不兼容，我想当另一部分加载时，它会尝试使用加载失败的代码，并导致 Xcode 崩溃。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-02T22:26:44.687

在最基本的层面上，-[NSCFString substringToIndex:] 方法提供了一个越界的索引。由于看起来其他人没有报告您的问题，因此可能是您的系统上的某些字符串比预期的要短（即 substringToIndex 的索引超出了字符串的末尾）。

基本上，它看起来可能是一个 XCode 错误。将它说打印到控制台的堆栈跟踪信息发布到控制台，也许它会给我们一个更好的主意。

[这篇旧文章](http://www.scriptsoftware.com/forum/viewtopic.php?f=78&t=2504&p=6594)描述了另一个 Cocoa 应用程序的类似问题。在这种情况下，问题在于国际化——尤其是日期和时间的国际化。您是否碰巧在“系统偏好设置”中“国际”偏好设置面板的“格式”选项卡中将“地区”设置为美国以外的其他内容？如果是这样，请尝试将其设置为美国，看看是否有任何改善。

如果不是这样，来自控制台的数据可能会有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-02T21:29:41.720

> 那么有没有办法删除我的 iPhone 配置文件（Ivan Zhao 的 iPhone），这样我就可以开始一个新的了。

配置文件位于 ~/Library/MobileDevice/Provisioning Profiles 中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-03T14:07:59.700

你什么时候收到这个错误？

我昨天更新到 beta 4，每次打开 mail.app 都会崩溃。它会打开我的一个帐户的第一页，研磨几秒钟然后崩溃。当我离开邮件应用程序时，iPhone 似乎很迟钝。当我的 iPhone 插入 MBP 并让 XCode 运行时，XCode 会占用我所有的处理器资源。

我查看了首选项，发现了一个邮件帐户，其背后没有任何信息。我删除了它，mail.app 按预期工作。所以我怀疑正在发生的事情是 iPhone 一遍又一遍地试图从这个 nil 电子邮件帐户中提取信息。

所以只是为了笑，我会看看你对邮件的偏好，看看你那里是否有一个空帐户。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-08-06T13:55:21.587

不知何故与此相关 - 对我来说，当显示 Organizer 时 Xcode 开始崩溃。似乎它与我的 iPhone 项目中的格式错误的 plist 条目有关......我在这里记录了它：http: [//spielhaus-ftw.com/blog/2010/08/xcode-crash-loop-countbyenumeratingwithstate](http://spielhaus-ftw.com/blog/2010/08/xcode-crash-loop-countbyenumeratingwithstate)

# programming-languages - “翻译”困境

> ID：815659
> 
> 赞同：0
> 
> 时间：2009-05-02T21:23:35.103
> 
> 标签：programming-languages, translation

我正在尝试建立一个网站来读取以特定字体编写的冰岛文本，然后以不同的字符编码（ascii/uc）呈现并在最终显示之前进行缓存。哪种语言最适合这份工作？Python 还是 PHP？还是别的什么？提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-02T21:59:29.200

Python 已用于创建[自然语言处理工具包](http://www.nltk.org/)，它可能对您有用。PHP 通常被认为在留下 8 位文本方面落后于曲线，尽管它在当前版本中正在迎头赶上。

# apache-flex - 在 flex 中创建一个“定制的”soap 客户端

> ID：815666
> 
> 赞同：1
> 
> 时间：2009-05-02T21:26:18.500
> 
> 标签：apache-flex, soap, xmlhttprequest

我正在开发一个说它使用“SOAP”的网络服务，但经过仔细检查，它与我在其他地方看到的标准肥皂请求/响应结构非常不同。

我能够使用 javascript（使用 xmlhttprequest）与服务交谈并手动解析结果。我试过用 flex 来做，但不能根据需要复制标题（即使正文内容变化很大）。我想将此应用程序移动到 flex 但不确定如何实现它 - 是否有任何类似于 xmlhttprequest 的方法？

此处显示了服务可以容纳的请求示例（我设法通过 js 使其工作）： http: [//pastie.org/466214](http://pastie.org/466214)

我对 web 服务和 flex 都很陌生，我会很感激*任何和所有*的建议。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-03T01:34:52.020

更新。我想我找到了一种方法来使用 httpservice 并将我自己的 XML 转储到请求中。

它不是最好的解决方案，但目前似乎运行良好。如果有更好的选择，我将不胜感激您对此的看法。

PS。如果其他人走这条路，那么[这篇文章](http://tacfug.org/blog/index.cfm/2007/3/26/Flex--Posting-XML-without-using-mxhttpservice-)对于使用 httpservice 发送原始 xml 很有帮助。

# c# - 如何在另一个应用程序之上绘制图形/文本

> ID：815667
> 
> 赞同：8
> 
> 时间：2009-05-02T21:26:56.547
> 
> 标签：c#, windows, winapi, graphics

我想增强应用程序，但没有可用的 3:e 派对 API。所以基本上这个想法是在应用程序窗口的顶部绘制图形/文本。

z 顺序、剪辑和将鼠标单击指向我的应用程序或其他应用程序时存在问题。

这样做的优雅方式是什么？

示例图像在这里。这是一个交易应用程序，我的应用程序想要在交易应用程序的窗口中添加额外的信息。[URL= [http://img104.imageshack.us/my.php?image=windowontop.png][/URL]](http://img104.imageshack.us/my.php?image=windowontop.png][/URL])

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-04T07:05:24.247

没有很好的方法可以做到这一点，但可能对您有用的一种方法是使用 SetWindowsHookEx(...) 挂钩有问题的应用程序以添加 GetMsgProc，它会绘制您的叠加层以响应 WM_PAINT 消息。基本思想是您在应用程序完成自己的绘图后立即绘制您的图形。

在您的主应用程序中：

```
....
HMODULE hDllInstance = LoadLibrary("myFavoriteDll");
HOOKPROC pOverlayHook = (HOOKPROC)GetProcAddress(hDllInstance, "OverlayHook");
SetWindowsHookEx(WH_GETMESSAGE, pOverlayHook, hDllInstance, threadId); 
```

在某处的 DLL 中关闭：

```
LRESULT CALLBACK OverlayHook(int code, WPARAM wParam, LPARAM lParam)
{
  //Try and be the LAST responder to WM_PAINT messages;
  //Of course, if some other application tries this all bets are off
  LRESULT retCode = CallNextHookEx(NULL, code, wParam, lParam);

  //Per GetMsgProc documentation, don't do anything fancy
  if(code < 0) return retCode;

  //Assumes that target application only draws when WM_PAINT message is
  //removed from input queue.
  if(wParam == PM_NOREMOVE) return retCode;

  MSG* message = (MSG*)lParam;

  //Ignore everything that isn't a paint request
  if(message->message != WM_PAINT) return retCode;

  PAINTSTRUCT psPaint;    

  BeginPaint(message->hwnd, &psPaint);
  //Draw your overlay here
  ...
  EndPaint(message->hwnd, &psPaint);

  return retCode;
} 
```

这都是 win32，因此您的 C# 代码将是 p/invoke 繁重且相应地非常丑陋。您的 DLL 也必须是非托管的（如果您打算注入到您自己的进程之外的进程中），这使得它成为一个更糟糕的解决方案。

当您渲染到窗口本身时，这将解决您的 z 顺序和剪辑问题。但是，如果您的目标应用程序在 WinProc 之外进行任何响应 WM_PAINT 的绘图，事情就会崩溃；这并非完全不常见的情况。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-08-20T00:12:42.233

您可能想在 DirectX 之上为游戏绘制它

[http://spazzarama.com/2011/03/14/c-screen-capture-and-overlays-for-direct3d-9-10-and-11-using-api-hooks/](http://spazzarama.com/2011/03/14/c-screen-capture-and-overlays-for-direct3d-9-10-and-11-using-api-hooks/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-11-30T12:21:45.083

> z 顺序、剪辑和将鼠标单击指向我的应用程序或其他应用程序时存在问题。

这些都是窗口管理器旨在处理的任务。您应该在应用程序窗口的顶部创建一个分层窗口。

另请参阅：[防止在 C++ 中重新绘制窗口](https://stackoverflow.com/questions/4261227/prevent-repainting-of-window-in-c)

# bash - 如何在 linux 上列出非空子目录？

> ID：815668
> 
> 赞同：37
> 
> 时间：2009-05-02T21:27:55.827
> 
> 标签：bash, unix, directory

我有一个包含多个子目录的目录。我只想列出那些至少包含一个文件的子目录。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2009-05-02T21:38:45.113

```
 find . -mindepth 1 -maxdepth 1 -not -empty -type d 
```

将为您提供所有非空目录。如果要排除仅包含其他目录（但不包含文件）的目录，则其他答案之一可能会更好...

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-02T21:38:12.120

```
find . -type f -print0 | xargs -0 -n 1 dirname | sort -u 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-02T21:37:09.173

怎么样：

```
find /nominated/directory -type f |
sed 's%/[^/]*$%% |
sort -u 
```

查找文件 - 删除文件名部分 - 唯一排序。

它不会列出仅包含其他子子目录的子目录。

# perl - 如何使用 Perl CGI 脚本提供图像？

> ID：815670
> 
> 赞同：3
> 
> 时间：2009-05-02T21:28:56.807
> 
> 标签：perl, image

我的 Google fu 让我失望了。如何使用 Perl 提供已经生成的图像？

例子：

```
<html><body><img src="getimage.pl"></body></html> 
```

getimage.pl 中有什么内容？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-02T22:03:18.427

干得好：

```
#!/usr/bin/perl -w
my $file = "inner-nav.gif";

## my $length = (stat($file)) [10];
## (stat($file)) [10]; is the inode change time in seconds since  00:00 January 1, 1970 GMT. 
my $length = (stat($file)) [7];
print "Content-type: image/gif\n";
print "Content-length: $length \n\n";
binmode STDOUT;
open (FH,'<', $file) || die "Could not open $file: $!";
my $buffer = "";
while (read(FH, $buffer, 10240)) {
    print $buffer;
}
close(FH); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-02T22:03:24.417

像这样的东西...

```
#!/usr/bin/perl

use strict;
use warnings;
use CGI;

my $gfx='';
$gfx = makeImage();
print CGI::header( type=>'image/png',
                   expires=>'+1m',
                   content_length=>length($gfx)});
print $gfx; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-08-22T15:54:08.290

对代码的一个小修正——提供的 stat 命令没有返回文件的长度。一些浏览器不在乎，但其他浏览器将无法加载图像。(stat($file))[10] 是'ctime'，而不是文件的长度。

```
#!/usr/bin/perl -w
my $file = "inner-nav.gif";
my $length = -s $file;
print "Content-type: image/gif\n";
print "Content-length: $length \n\n";
binmode STDOUT;
open (FH,'<', $file) || die "Could not open $file: $!";
my $buffer = "";
while (read(FH, $buffer, 10240)) {
    print $buffer;
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-02T21:56:09.050

[WWW 常见问题解答：“我如何从 Perl/CGI 或 PHP 脚本输出图像”](http://www.boutell.com/newfaq/creating/emitimage.html)应该让您朝着正确的方向前进。您将不得不原谅我没有直接回答您的问题，因为我大约 5 年没有接触过 Perl。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-18T18:24:20.743

处理 png 或 jpg 文件的简单解决方案。如果您想做更多文件类型，请查找最新版本的 GD。

[http://www.perlmonks.org/?node_id=18565](http://www.perlmonks.org/?node_id=18565)

#

```
sub serveImage
{
    use GD;

    my ( $localPath ) = @_;

    if( $localPath =~ /\.png/i )
    {
        print "Content-type: image/png\n\n";
        binmode STDOUT;
        my $image = GD::Image->newFromPng( $localPath );
        print $image->png;
    }
    else
    {
        print "Content-type: image/jpeg\n\n";
        binmode STDOUT;
        my $image = GD::Image->newFromJpeg( $localPath );
        print $image->jpeg(100);
    }

} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-07-27T02:05:18.207

一位用户询问是否缺少某些东西。我认同。`exit 1;`脚本末尾缺少。这是我的修改版（哈哈，我只添加在`exit 1;`）

```
#!/usr/bin/perl -w
my $file = "inner-nav.gif";
my $length = (stat($file)) [10];
print "Content-type: image/gif\n";
print "Content-length: $length \n\n";
binmode STDOUT;
open (FH,'<', $file) || die "Could not open $file: $!";
my $buffer = "";
while (read(FH, $buffer, 10240)) {
    print $buffer;
}
close(FH);
exit 1; 
```

无论如何，我认为更好的方法是这样做：

```
#!/usr/bin/perl

# must haves!
use strict;
use warnings;

use CGI;
my $cgi = new CGI; # used in 'getParam($)' for getting URL paramaters

use lib "pm"; # my own perl modules library
use user; # my user related functions
use dir; # my directory handling functions

# these will be used for $fn if $fn not found, read error, or no user
my $file_not_found = "/img_srvr/error-file-not-found.jpg";
my $read_error = "/img_srvr/error-reading-image.jpg";
my $no_such_user = "/img_srvr/error-no-such-user.jpg";

# the premise of the following is to capture all input into separate vars
# verify that each element is correct, and then spit out the image.

 # for my site.  remove it if you like.  see below for getParam($) definition
my $uid = getParam("uid");
if (not userExists($uid)) { printImage($no_such_user); exit 1; }

my $folder = "/img_srvr/$uid"; # the folder where the images are stored

my $fn = getParam("img"); # see below for definition
my $path = "$folder/$fn"; # this, too, _is_ better

if (not fileExists($path))
  { printImage($file_not_found); exit 1; } else
  { printImage($path); }

exit 1;

#########################################################################

######################
sub printImage($) {
  # be sure to do your error checking BEFORE calling this. it'll just
  # blindly rip along.
  my $fn = $_[0];
  my $type = getType($fn); # see sub below
  my $buffer = "";

  print "content-type: image/$type\n"; # these are awful, but ok for now
  print "\n"; # separate just in case we want to add more to the header.

  binmode STDOUT;

  open my $FH, "<", $fn or die "$!";
  while (read ($FH, $buffer, 10240)) {
    print $buffer; # prefer NOT to print as I read...
  }
  close $FH;

  # return $OUTPUT; # this would be better, no?
}

######################
# there's gotta be a better way, spock!
sub getType($) {
  my $f = $_[0];

  if ($f =~ /\.gif$/i) { return "gif"; }
  if ($f =~ /\.jpg|\.jpeg$/i) { return "jpeg"; }
  if ($f =~ /\.png$/i) { return "png"; }

  return "bmp";
}

sub getParam($) {
  return $cgi->param($_[0]);
} 
```

哦！这可能是[一个有用的链接](http://www.freeformatter.com/mime-types-list.html)（哑剧类型！）：

====

最后，使用我制作的上述`printImage`功能，是否可以“调整”图像？如果是这样，怎么做？我不想安装另一个包或类似的东西。它必须很简单。

# ruby-on-rails - 有没有更简单的方法让某些东西只在非错误状态下显示？(Ruby on Rails)

> ID：815678
> 
> 赞同：0
> 
> 时间：2009-05-02T21:32:24.320
> 
> 标签：ruby-on-rails

我有一些文本/图像，我只想在表单的正常状态下显示——也就是说，它还没有提交。如果用户提交了表单，并返回到浏览器并出现错误，我想显示其他内容。目前，我正在使用：

```
<% if !@user.errors.empty? -%>
    # Leaving this area blank.
<% else -%>
    # Inserting something here
<% end -%> 
```

但这似乎有点沉重，必须有一个更简单的方法。

这可能真的很简单，但我找不到任何关于它的信息——不过，我可能没有正确地表达这个问题。

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-02T22:26:40.850

我现在无法想象完全不同的东西。`if`但是，当您只需要一个分支时，为什么不只使用该语句呢？

```
<% if @users.errors.empty? %>
  # Inserting something here
<% end %> 
```

# php - 使用 PHP 向 Yahoo IM 发送消息

> ID：815680
> 
> 赞同：4
> 
> 时间：2009-05-02T21:33:52.303
> 
> 标签：php, yahoo-messenger

我正在尝试连接到 Yahoo Messenger 帐户并使用 PHP 或 CURL 发送 PM。我从连接到 eBuddy Web Messenger（[http://www.ebuddy.com/](http://www.ebuddy.com/)）的 phpclasses.org 下载了以下类，以将消息发送到所需的 IM 原始代码不起作用，所以我做了一些更改（原始语句被注释掉），仍然没有运气。

如果有人帮助我找出我在这里出错的地方，我将不胜感激。

谢谢。

```
<?php

class My_Yahoo_Messenger {

    /**
    * Server host
    * @access private
    */
    var $serverHost = 'denver.ebuddy.com';

    /**
    * Login user name
    * @access private
    */
    var $username   = null;

    /**
    * Login session
    * @access private
    */
    var $_cookie    = null;

    /**
    *Connection handle
    * @access private
    */
    var $fp_handle  = null;

    /**
    * Construct
    *@params:
    *   username: String Yahoo account user name
    *   password: String Yahoo account password
    *   login status: Boolean true from visible
    * @access public
    */
    function __construct($username, $password, $inv = false)
    {
        $this->login($username, $password, $inv);
    }

    /**
    * Construct PHP 4
    *@params:
    *   username: String Yahoo account user name
    *   password: String Yahoo account password
    *   login status: Boolean true from visible
    * @access public
    */
    function My_Yahoo_Messenger($username, $password, $inv = false)
    {
        $this->__construct($username, $password, $inv);
    }

    /**
    * Function provide login to yahoo account
    *@params:
    *   username: String Yahoo account user name
    *   password: String Yahoo account password
    *   login status: Boolean true from visible
    *@return: String cookie data
    * @access public
    */
    function login($username, $password, $inv = false)
    {
        $inv = $inv === false ? 'FALSE' : 'TRUE';
        $username = urlencode($username);
        $password = urlencode($password);

        $content = "password=$password&network=yahoo&initial=FALSE&login_network=yahoo&username=$username&pwd=&init_status=$inv";

        //$this->_createConnection('POST', '/vo074922/login.jsp', 'http://www.ebuddy.com/?web_messenger', "yahoo_uname=$username; Emessenger=yahoo; network=YAHOO;", $content, false);

        $this->_createConnection('POST', '/vo7.3.11/start.html', 'http://www.ebuddy.com/?web_messenger', "yahoo_uname=$username; Emessenger=yahoo; network=YAHOO;", $content, false);

        $headers = array();
        $content = '';

        $atStart = true;
        $atHeader= true;
        while (!feof($this->fp_handle)) {
            $line = fgets($this->fp_handle, 4096);

            if($atStart) {
                $atStart = false;
                if (!preg_match('/HTTP\/(\\d\\.\\d)\\s*(\\d+)\\s*(.*)/', $line, $m)) {
                    break;
                }
            }
            if ($atHeader) {
                if (trim($line) == '') {
                    $atHeader = false;
                    continue;
                }
                if (!preg_match('/([^:]+):\\s*(.*)/', $line, $m)) {
                    continue;
                }
                $key = strtolower(trim($m[1]));
                $val = trim($m[2]);
                if (isset($headers[$key])) {
                    if (is_array($headers[$key])) {
                        $headers[$key][] = $val;
                    } else {
                        $headers[$key] = array($headers[$key], $val);
                    }
                } else {
                    $headers[$key] = $val;
                }
                continue;
            }
            $content .= $line;
        }

        foreach ($headers as $name=>$header)
        {
            switch (true) {
                case strpos($name, 'location') !== false :
                    if(preg_match('@time\s*=\s*([0-9]+)@i', $header, $m)) {
                        $this->time = $m[1];
                    }
                    if(preg_match('@hash\s*=\s*([a-z0-9]+)@i', $header, $m)) {
                        $this->hash = $m[1];
                    }
                    break;
                case strpos($name, 'set-cookie') !== false :
                    if(is_array($header)) $header = implode(';', $header);
                    $this->_cookie = $header;
                    break;
            }
        }
        @fclose ($this->fp_handle);

        $this->username = $username;

        return $this->_cookie;
    }

    /**
    * Function for send message to fav. yahoo account
    *@params:
    *   to: String Yahoo account
    *   message: String Your message
    * @access public
    */
    function sendMessage($to, $message)
    {
        $message = urlencode($message);

        $message = preg_replace( '!<br.*>!iU', "\n", $message );

        $hash = isset($this->hash) ? $this->hash : '';
        $time = isset($this->time) ? $this->time : time();

        $content = "e_hash=$hash&e_action=send_message&e_user=$to&e_message=$message&e_format=FN%3DVerdana%3B%20EF%3D%3B%20CO%3D000000%3B%20CS%3D0%3B%20PF%3D00%3B%20RL%3D0&e_network=YAHOO&_=";

        //$this->_createConnection('POST', '/dispatch', "http://".$this->serverHost."/vo074922/main.jsp?hash=$hash&u=$this->username&network=YAHOO&time=$time", $this->_cookie, $content, false);

        $this->_createConnection('POST', '/dispatch', "http://".$this->serverHost."/vo7.3.11/main.html?hash=$hash&u=$this->username&network=YAHOO&time=$time", $this->_cookie, $content, false);
    }

    /**
    * Function for get unread  message from yahoo account
    *@return : Array From:Message
    * @access public
    */
    function getMessage()
    {
        $content = "e_format=short&e_action=poll&e_time=0&e_timeout=10000&e_max=100&_=";

        $hash = isset($this->hash) ? $this->hash : '';
        $time = isset($this->time) ? $this->time : time();

        //$this->_createConnection('POST', '/dispatch', "http://".$this->serverHost."/vo074922/main.jsp?hash=$hash&u=$this->username&network=YAHOO&time=$time", null, $content, false);

        $this->_createConnection('POST', '/dispatch', "http://".$this->serverHost."/vo7.3.11/main.html?hash=$hash&u=$this->username&network=YAHOO&time=$time", null, $content, false);

        $reciveMessage = array();

        $atStart = true;
        $atHeader= true;
        while (!feof($this->fp_handle)) {
            $line = fgets($this->fp_handle, 4096);

            if($atStart) {
                $atStart = false;
                if (!preg_match('/HTTP\/(\\d\\.\\d)\\s*(\\d+)\\s*(.*)/', $line, $m)) {
                    break;
                }
            }
            if ($atHeader) {
                if (trim($line) == '') {
                    $atHeader = false;
                    continue;
                }
                if (!preg_match('/([^:]+):\\s*(.*)/', $line, $m)) {
                    continue;
                }
                continue;
            }
            if(strpos($line, 'from') !== false) {
                $from = null; $message = null;
                if(preg_match('@from\s*=\s*([^;]*);?@i', $line, $m)) {
                    $from = $m[1];
                }
                if(preg_match('@msg\s*=\s*([^;]*);?@i', $line, $m)) {
                    $message = $m[1];
                }
                if(!empty($message)) {
                    $reciveMessage[ ] = array($from, $message);
                }
            }
        }
        return $reciveMessage;
    }

    /**
    * Function for create connection
    *@params:
    *   method: String Request method
    *   file: String Request file
    *   referer: String Referer
    *   cookie: String cookie for send by request
    *   content: String data content to post to server
    *   close: Boolean False for keep connection handle and not close it
    * @access public
    */
    function _createConnection($method = 'GET', $file = '/', $referer = null,
                                $cookie = null, $content = null, $close = true)
    {
        $this->fp_handle = @fsockopen ($this->serverHost, 80, $errno, $errstr, 100);
        if(!$this->fp_handle) {
            exit("can not connect to $this->serverHost");
        }

        $method = strtoupper($method);
        if(!in_array($method, array('GET', 'POST')) || is_null($content)) {
            $method = 'GET';
        }

        if(is_null($referer)) {
            $referer = $this->serverHost;
        }

        if(is_null($cookie)) {
            $cookie = $this->_cookie;
        }

        $data = "$method $file HTTP/1.1\n";
        $data.= "Accept: */*\n";
        $data.= "Accept-Language: fa\n";
        $data.= "Referer: $referer/\n";
        $data.= "Content-Type: application/x-www-form-urlencoded; charset=UTF-8\n";
        $data.= "Accept-Encoding: gzip, deflate\n";
        $data.= "User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; Avant Browser [avantbrowser.com]; .NET CLR 1.1.4322)\n";
        $data.= "Host: $this->serverHost\n";
        $data.= "Connection: Keep-Alive\n";
        $data.= "Cache-Control: no-cache\n";
        $data.= "Cookie: $cookie\n";

        if($method == 'POST') {
            $length = strlen($content);
            $data.= "Content-Length: $length\n\n";
            $data.= $content;
        } else {
            $data.= "\n";
        }

        @fputs ($this->fp_handle, $data);
        if($close) @fclose($this->fp_handle);
    }
}

?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-07-31T20:27:47.453

可能你忘记了 var $password = '', var $to = ''，我不确定'因为我不是 php 专家......

# search - 您如何在网上搜索与编程相关的信息？

> ID：815683
> 
> 赞同：3
> 
> 时间：2009-05-02T21:35:59.707
> 
> 标签：search

你能分享一下你在网上搜索编程相关信息的常用技巧吗？

这是我的工具箱：

*   要查找库或应用程序，我使用 del.icio.us 搜索（例如[通信 java python](http://delicious.com/search?p=communication+java+python&u=&chk=&context=main&fr=del_icio_us&lc=0)）或最近的 stackoverflow。
*   要查看有关项目或库的最新消息，我使用谷歌并将搜索结果缩小到月份（例如[spellchecker.net](http://www.google.com/search?hl=en&q=spellchecker.net&as_qdr=m)）
*   要查找库的示例，我使用谷歌代码搜索（例如[lang:C# log4net configure](http://www.google.com/codesearch?hl=en&lr=&q=lang:C%23+log4net+configure&sbtn=Search)）
*   对于一般搜索，我使用谷歌自定义搜索，并将 stackoverflow.com 添加为首选站点。这使我的搜索重点放在了计算机编程上，因此搜索[Outlook 选定的文本](http://www.google.com/cse?cx=001787910164584516386:boip5sey8hy&ie=UTF-8&q=outlook+selected+text&sa=Search)会返回与编程相关的页面，而不是[Outlook 用户指南](http://www.google.com/search?hl=en&q=outlook+select+&btnG=Search):)。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-02T21:43:16.320

只是谷歌它，但谷歌它[很好](http://www.googleguide.com/advanced_operators_reference.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-02T21:40:20.617

我发现开箱即用的* Google 充分涵盖了我的所有基础。如果我需要有关特定内容的文档，我只需将源添加为查询的一部分，而不是去源本身在那里搜索（例如，“msdn”用于 BCL 信息）

*可以这么说

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-02T22:11:16.427

除了在 Google 中输入搜索字词。

我广泛使用谷歌阅读器。我通过 RSS 订阅了大量的项目博客和编程网站。然后，我每天至少分配 30 分钟来浏览提要。

这有助于我了解最新情况**，并**在我想找到答案时帮助我。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-02T21:38:10.047

当事情变得非常困难时，我会登录图书馆的邮件列表。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-02T21:42:35.543

## 视窗

*   MSDN

## *尼克斯

*   手册页

## 一般编程

*   堆栈溢出
*   SGI STL 参考

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-02T21:44:08.223

如果这是我的问题，取决于项目，而你真的被困住了，我经常求助于 IRC 频道。

然而，你问一个已经被问过一百次的问题是有风险的。所以有时你可能会遇到一些不友好的事情。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-02T22:02:29.800

好吧，取决于您所说的“网络”是什么意思。如果它意味着 www。然后我只是谷歌它。如果它意味着整个网络，我更喜欢usenet。有点像类固醇上的stackoverflow。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-02T22:04:20.577

[谷歌代码搜索](http://www.google.com/codesearch)是无价的。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-02T23:50:59.947

在所有情况下，请注意所有这些来源除了当前信息之外还包括过时的信息。检查文章上的日期 - 2002 年的内容与 2007 年的内容相比，相关性要小得多，即使它写得很清楚并且非常有意义 - 对于 2002 年。

我经常提到的例子是关于 WSE 的文章数量，这些文章将出现在 MSDN 上的“Web 服务安全”搜索结果中。我收到过有人实施 WSE 的报告，因为它出现在搜索结果中，但不知道 WSE 已过时。

# tabs - 无法在 Zsh 中将向后的 TAB 作为 Shift-TAB

> ID：815686
> 
> 赞同：36
> 
> 时间：2009-05-02T21:37:31.840
> 
> 标签：tabs, zsh

**问题：**在 Zsh 中使用 TAB 向后导航，就像在 Firefox 中一样

```
Shift-TAB 
```

**Shift-TAB 应该做什么的示例**

我在终端中运行以下代码

```
ls <TAB> 
```

我明白了

```
A B C D E F G H I J K H L M N... 
```

当我按 TAB [替代文本 http://dl.getdropbox.com/u/175564/smallEx.png时，我在 Zsh 中看到以下内容](http://dl.getdropbox.com/u/175564/smallEx.png)

我通过 TAB 导航到文件夹 J。然后，我发现我太频繁地按了一次 tab 键。

**如何为 Zsh 制作**类似于 Firefox 的 Shift-TAB 的向后 TAB？

* * *

## 回答 #1

> 赞同：86
> 
> 时间：2009-05-09T00:22:58.327

试试这个：

```
bindkey '^[[Z' reverse-menu-complete 
```

如果这不起作用，请尝试像这样运行执行 zsh（确实如此`setopt MENU_COMPLETE`）：

```
zsh -Y 
```

然后再试一次！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-08T06:36:52.550

这份文件应该给你一个很好的解释：

*   [问：如何让 Shift-Tab 在文本终端或 XTerm 上后退？](http://stuff.mit.edu/afs/sipb/user/daveg/Info/backtab-howto.txt)

简而言之，很少有终端支持移位的 Tab，但您可以让终端支持“backtab”键序列，您可以将 X 配置为发送。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-08T06:51:34.103

我不确定向后选项卡到底需要什么，但是 zsh*确实*有一个 undo zle 小部件，它可以撤消最后一次按下的击键的效果，无论是 Tab 还是其他任何东西。通过将其绑定到键来使用它：

```
$> bindkey "<Ctrl-V><Shift-Tab>" undo 
```

这意味着你按下那些组合键，不要输入字母。

我认为这就是您所要求的，但是如果没有更多示例，我无法确定。

# javascript - Javascript在下拉更改时设置隐藏表单值

> ID：815687
> 
> 赞同：33
> 
> 时间：2009-05-02T21:37:50.123
> 
> 标签：javascript, jquery

javascript 新手，但我相信这很容易。不幸的是，大多数谷歌搜索结果都没有帮助。

无论如何，当下拉选择更改时，我想通过 javascript 设置隐藏表单元素的值。

我可以使用 jQuery，如果它可以更简单地获取或设置值。

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2009-05-02T21:45:27.563

如果你有这样的 HTML，例如：

```
<select id='myselect'>
    <option value='1'>A</option>
    <option value='2'>B</option>
    <option value='3'>C</option>
    <option value='4'>D</option>
</select>
<input type='hidden' id='myhidden' value=''> 
```

您所要做的就是[将一个函数绑定到`change`select 的事件](http://docs.jquery.com/Events/change#fn)，并在那里做您需要的事情：

```
<script type='text/javascript'>
$(function() {
    $('#myselect').change(function() {
        // if changed to, for example, the last option, then
        // $(this).find('option:selected').text() == D
        // $(this).val() == 4
        // get whatever value you want into a variable
        var x = $(this).val();
        // and update the hidden input's value
        $('#myhidden').val(x);
    });
});
</script> 
```

考虑到所有因素，如果您要进行大量 jQuery 编程，请始终打开[文档](http://docs.jquery.com/Main_Page)。如果你给它一个机会，很容易在那里找到你需要的东西。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-05-02T21:47:55.827

普通的旧Javascript：

```
<script type="text/javascript">

function changeHiddenInput (objDropDown)
{
    var objHidden = document.getElementById("hiddenInput");
    objHidden.value = objDropDown.value; 
}

</script>
<form>
    <select id="dropdown" name="dropdown" onchange="changeHiddenInput(this)">
        <option value="1">One</option>
        <option value="2">Two</option>
        <option value="3">Three</option>
    </select>

    <input type="hidden" name="hiddenInput" id="hiddenInput" value="" />
</form> 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2011-08-24T14:24:22.610

我已经为此奋斗了很长时间`$('#myelement').val(x)`只是没有工作......直到我意识到`#`建造需要一个ID，而不是一个NAME。因此，如果“`.val(x)`不起作用！” 是你的问题，检查你的元素并确保它有一个 ID！

这是一个令人尴尬的问题，但我觉得我必须分享才能为他人省去很多麻烦。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-02T21:42:19.973

在这里，您可以在下拉列表的 onchange 事件中设置隐藏的值：

```
$('#myDropDown').bind('change', function () {
  $('#myHidden').val('setted value');
}); 
```

您的隐藏和下拉列表：

```
<input type="hidden" id="myHidden" />

<select id="myDropDown">
   <option value="opt 1">Option 1</option>
   <option value="opt 2">Option 2</option>
   <option value="opt 3">Option 3</option>
</ select> 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-02T21:43:41.513

这是使用 jQuery。

```
$('#selectFormElement').change( function() {
    $('#hiddenFormElement').val('newValue');
} ); 
```

**在 html**

```
<select id="selectFormElement" name="..."> ... </select>
<input type="hidden" name="..." id="hiddenFormElement" /> 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-02T21:45:04.163

只是为了与众不同，更改了我的答案，以便这个问题没有 5 个具有相同代码的答案。

```
<html>
<head>
   <title>Page</title>  
   <script src="jquery-1.3.2.min.js"></script>
   <script>
       $(function() {
           var select = $("body").append('<form></form>').children('form')
                .append('<input type="hidden" value="" />').children('input[type=hidden]')
                .attr('id', 'hiddenValue').end()
                .append('<select></select>').children('select')
                .attr('id', 'dropdown')
                .change(function() {
                    alert($(this).val());
                });

           $.each({ one: 1, two: 2, three: 3, four: 4, five: 5 }, function(txt, val) {
               select.append('<option value="' + val + '">' + txt + '</option>');
           });
       });
</script>
</head>
   <body></body>
</html> 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-02T21:47:22.177

```
<form>
  <input type="hidden" name="selval">
  <select onchange="this.form.selval.value=this.selectedIndex">
    <option>val1</option>
    <option>val2</option>
  </select>
</form> 
```

表单中的纯 javascript

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-07-27T01:26:12.813

```
$(function() {
$('#myselect').change(function() {
   $('#myhidden').val =$("#myselect option:selected").text();
    });
}); 
```

# ios - 如何隐藏UITabBar？

> ID：815690
> 
> 赞同：40
> 
> 时间：2009-05-02T21:38:22.697
> 
> 标签：ios, iphone, cocoa-touch, uikit, uitabbar

在我的应用程序中，我有一个标签栏。在某些视图中，我也有一个工具栏。因此，当我使用工具栏查看这些视图时，它看起来很丑 - 视图底部有两个栏。我认为在输入这些特定视图时隐藏标签栏是一个最佳解决方案。但我只是不知道如何以正确的方式做到这一点。我尝试将 UITabBarController 的 tabBar 隐藏属性设置为 YES，但没有成功。而且我也尝试以任何观点做以下事情：

```
self.hidesBottomBarWhenPushed = YES; 
```

但它也没有奏效。

这种情况的正确解决方案是什么？我不想在任何视图中有 2 个酒吧。

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2009-05-02T22:14:39.520

您必须在您推送的控制器上使用将 hidesBottomBarWhenPushed 属性设置为 YES，而不是设置为 UITabBarController。

```
otherController.hidesBottomBarWhenPushed = YES;
[navigationController pushViewController: otherController animated: TRUE]; 
```

或者您可以在首次初始化要推送的控制器时设置该属性。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-04-11T07:31:28.900

界面构建器在选项卡栏中嵌入了视图控制器的复选框 - 推送时隐藏底部栏。在简单的情况下，现在不需要通过代码来完成。

对于@Micah

![按下时隐藏底部栏。](https://i.stack.imgur.com/u9ou3.png)

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-05-06T20:59:44.437

我也为此挣扎了一段时间。隐藏标签栏是朝着正确方向迈出的一步，但会留下一个黑色矩形。诀窍是调整支持 UIViewController 视图的层的大小。

我在这里写了一个带有解决方案的小演示：

[https://github.com/tciuro/FullScreenWithTabBar](https://github.com/tciuro/FullScreenWithTabBar)

我希望这有帮助！

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2010-01-04T00:40:02.297

**不要使用这个解决方案！**

```
BOOL hiddenTabBar;
UITabBarController *tabBarController;

- (void) hideTabBar {

     [UIView beginAnimations:nil context:NULL];
     [UIView setAnimationDuration:0.4];
     for(UIView *view in tabBarController.view.subviews)
     {
          CGRect _rect = view.frame;
          if([view isKindOfClass:[UITabBar class]])
          {
               if (hiddenTabBar) {
                    _rect.origin.y = [[UIScreen mainScreen] bounds].size.height-49;
                    [view setFrame:_rect];
               } else {
                    _rect.origin.y = [[UIScreen mainScreen] bounds].size.height;
                    [view setFrame:_rect];
               }
          } else {
               if (hiddenTabBar) {
                    _rect.size.height = [[UIScreen mainScreen] bounds].size.height-49;
                    [view setFrame:_rect];
               } else {
                    _rect.size.height = [[UIScreen mainScreen] bounds].size.height;
                    [view setFrame:_rect];
               }
          }
     }    
     [UIView commitAnimations];

     hiddenTabBar = !hiddenTabBar;
} 
```

[资源](http://www.developers-life.com/hide-uitabbarcontrolleruitabbar-with-animation.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-01-14T02:53:49.493

没有内置方法可以隐藏当前视图的选项卡栏。

`hidesBottomBarWhenPushed`您可以在使用变量推送视图时隐藏它。

如果要在当前视图中隐藏标签栏，可以执行以下操作：

[要点在这里](https://gist.github.com/BrentMifsud/a967020dceaf4ebe28a448a049e7f67c)

请注意，UIKit 似乎将标签栏带回应用程序恢复。所以你必须订阅通知`UIApplication.didBecomeActiveNotification`并调用上述函数。

# asp.net - asp.net 自定义错误页面和文件没有扩展名

> ID：815692
> 
> 赞同：1
> 
> 时间：2009-05-02T21:38:35.303
> 
> 标签：asp.net, iis-7, custom-error-pages

如何让 IIS 7 为没有扩展名的文件返回自定义错误页面？我让它适用于带有扩展名的文件，但是当没有指定扩展名时，我得到了通用页面。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-02T21:56:24.590

尝试添加映射到 aspnet_isapi.dll[的通配符应用程序扩展。](http://learn.iis.net/page.aspx/508/wildcard-script-mapping-and-iis-7-integrated-pipeline/)

如果没有该映射，请求将永远不会命中 aspnet dll 进行处理，并且将返回默认的 IIS 404 页面。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-02T22:22:30.423

好吧，如果您正在处理这种情况，您应该处理这些无扩展名文件，然后重定向到您的自定义错误页面。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-02T22:17:27.503

IIS 7 支持无扩展的 URL，您可以将其与 Urlrewriting.net 结合使用

这是关于实现您想要的东西的非常好的文章。

[http://www.vinodunny.com/blog/post/ASPNET-Extensionless-URL-ReWriting-in-IIS-7.aspx](http://www.vinodunny.com/blog/post/ASPNET-Extensionless-URL-ReWriting-in-IIS-7.aspx)

# eclipse - 避免日食“更改文件系统”对话框？

> ID：815707
> 
> 赞同：28
> 
> 时间：2009-05-02T21:47:45.873
> 
> 标签：eclipse

是否有一个首选项或调整会阻止 Eclipse 显示“此文件已在文件系统上更改”对话框。当我从另一个编辑器切换到 Eclipse 时？

脚步：

*   打开eclipse项目
*   编辑一些文件并保存（页面现在是“干净的”，但之前已被触及）
*   切换到其他编辑器
*   编辑同一个文件
*   切换回日食
*   见对话框

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-05-02T22:06:52.660

也许告诉 Eclipse 自动刷新工作区会有所帮助：

> 首选项 -> 常规 -> 工作区 -> 自动刷新

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-10-31T22:14:34.107

这适用于我使用 Indigo Service Release 1，Build id：20110916-0149，Preferences->General->Workspace->“Refresh Using Native Hooks or Polling”和“Refresh on Access”选中。

@Piotr Dobrogost，只需其中一个选项即可摆脱对话框提示，但这取决于您想要的行为。他们做不同的事情，但每个人都自己阻止对话。使用“使用本机挂钩或轮询刷新”，文件将在文件更改时自动更新，无需用户干预。使用“访问时刷新”，仅当上下文更改为包含更改文件的编辑器时，文件才会更新。出于我的目的（观察脚本输出的变化），我发现“使用本机挂钩或轮询刷新”本身是最有用的。

此外，这似乎很明显，但请注意，这仅适用***于 eclipse 工作区中的***文件。

# spring - Maven 的 Spring 在线存储库

> ID：815713
> 
> 赞同：7
> 
> 时间：2009-05-02T21:54:47.667
> 
> 标签：spring, maven-2, repository

我刚刚第一次安装了 Maven2。

默认情况下，它会将一些有用的 jars 拉入本地项目：jakarta-commons、junit 等。

我想引入最新的 Spring 版本（撰写本文时为 2.5.6）。但我查看的在线存储库（iBiblio 和 Maven）只有更旧版本的 Spring 库。

是否有任何其他存储库保持最新？这里的最佳做法是什么？我们可以自己维护它们吗？我会准备帮助维护这些东西！

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-06-18T16:33:19.760

实际上，我认为如果您使用 spring 企业存储库会更好。

[http://www.springsource.com/repository/](http://www.springsource.com/repository/)

不仅有可用的 spring 发行版，还有许多其他库，它们相互之间具有正确的依赖关系（官方 maven 存储库不是这种情况！）。此外，它也是一个 OBR，所以每个库也已经是一个 OSGI 包！

```
<repository>
    <id>com.springsource.repository.bundles.release
    </id>
    <name>SpringSource Enterprise Bundle Repository -
        SpringSource Bundle Releases</name>
    <url>http://repository.springsource.com/maven/bundles/release
    </url>
    <releases>
        <enabled>true</enabled>
        <updatePolicy>daily</updatePolicy>
        <checksumPolicy>warn</checksumPolicy>
    </releases>
</repository>
<repository>
    <id>com.springsource.repository.bundles.external
    </id>
    <name>SpringSource Enterprise Bundle Repository -
        External Bundle Releases</name>
    <url>http://repository.springsource.com/maven/bundles/external
    </url>
    <releases>
        <enabled>true</enabled>
        <updatePolicy>daily</updatePolicy>
        <checksumPolicy>warn</checksumPolicy>
    </releases>
</repository>
<repository>
    <id>com.springsource.repository.libraries.release
    </id>
    <name>SpringSource Enterprise Bundle Repository -
        SpringSource Library Releases</name>
    <url>http://repository.springsource.com/maven/libraries/release
    </url>
    <releases>
        <enabled>true</enabled>
        <updatePolicy>daily</updatePolicy>
        <checksumPolicy>warn</checksumPolicy>
    </releases>
</repository>
<repository>
    <id>com.springsource.repository.libraries.external
    </id>
    <name>SpringSource Enterprise Bundle Repository -
        External Library Releases</name>
    <url>http://repository.springsource.com/maven/libraries/external
    </url>
    <releases>
        <enabled>true</enabled>
        <updatePolicy>daily</updatePolicy>
        <checksumPolicy>warn</checksumPolicy>
    </releases>
</repository> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2010-10-15T14:23:19.690

只需关注这篇文章：[使用 Maven 获取 Spring 3 工件](http://blog.springsource.com/2009/12/02/obtaining-spring-3-artifacts-with-maven/ "使用 Maven 获取 Spring 3 工件")

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-02T23:05:43.470

[http://mirrors.ibiblio.org/pub/mirrors/maven2/org/springframework/spring-core/](http://mirrors.ibiblio.org/pub/mirrors/maven2/org/springframework/spring-core/)

看起来 spring 2.5.6 已经存在。

不过，如果您喜欢使用诸如休眠之类的东西，我建议您添加 Jboss 的存储库。以我的经验，那里的更新速度比主要的 Maven 存储库要快得多。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-05-22T01:10:43.453

试试这个： [https ://s3browse.springsource.com/browse/repository.springsource.com/maven](https://s3browse.springsource.com/browse/repository.springsource.com/maven)

另一个 url 不起作用，因为它实际上是人类不易阅读的 Amazon S3“存储桶”。不过对于软件来说非常容易:)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-31T13:53:39.983

大多数应该在中央，如果没有，那么可以在[http://repo.springsource.org](http://repo.springsource.org)找到带有专门存储库的 Spring 工件：

*   发布：[http ://repo.springsource.org/libs-release-s3](http://repo.springsource.org/libs-release-s3)
*   对于里程碑：[http ://repo.springsource.org/libs-milestone-s3](http://repo.springsource.org/libs-milestone-s3)
*   对于快照：[http ://repo.springsource.org/libs-snapshot-s3](http://repo.springsource.org/libs-snapshot-s3)

# ruby-on-rails - 如何在 Rails 中为客户端生成外部安全表单

> ID：815718
> 
> 赞同：1
> 
> 时间：2009-05-02T21:59:20.073
> 
> 标签：ruby-on-rails, ruby, forms

我正在使用 Ruby on Rails 制作一个应用程序，企业可以在其中创建帐户并添加有关其客户的信息。我希望能够生成一个表格，他们可以将其放在他们的网站上，以自动将客户的信息输入到他们的帐户中。我知道我可以做类似的事情：

```
<% form_tag my_site_url_with_action do %>
 ....put here the fields for client info 
```

但我想知道是否有办法通过确保它来自我客户的网站而不是来自一些垃圾邮件网站左右来确保它的安全。

有任何想法吗？

谢谢，

谭

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-02T22:21:54.077

也许使用[iframe](http://www.w3schools.com/TAGS/tag_iframe.asp)可以帮助您？我认为使用它是不受欢迎的，但使用完成工作的东西。:)

在您的客户网站上拥有 iframe，您仍然可以让他们登录并使用 Rails 中内置的所有 XSS 好东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-04T06:01:03.840

如果您的 rails 应用程序使用 RESTful 资源，您可以使用[ActiveResource](http://api.rubyonrails.org/classes/ActiveResource/Base.html)。

否则，快速而肮脏的解决方案：Rails 站点上的表单有一个真实性令牌作为隐藏输入。这可以确保提交的信息来自安全的来源，例如网站本身。您可以使用远程表单上的隐藏输入来让 Rails 接受它。您可能还想编写接收操作以在完成处理后重定向回它来自的站点（redirect_to :back）。

# php - 在 CakePHP 中添加“onmouseover”事件时，如何防止 $html-link() 删除单引号？

> ID：815721
> 
> 赞同：-1
> 
> 时间：2009-05-02T22:01:00.973
> 
> 标签：php, javascript, cakephp

尝试使用鼠标悬停事件

```
echo $html->link("Dashboard", 
     "/dashboard/index", 
     array("onmouseover" => "Tip('Test');") ); 
```

变成

```
<a href="/dashboard/index" onmouseover="Tip(&#039;Test&#039;);">Dashboard</a> 
```

如何防止链接功能删除单引号？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-10T20:49:40.400

使用 Cake 1.2，这绝对可以工作：

```
echo $html->link('Dashboard', '/dashboard/index',
array("onmouseover" => "Tip('Test');"), null, false); 
```

最后一个参数是转义选项。它默认为真。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-02T22:49:11.513

这应该有效：

```
echo $html->link("Dashboard", 
     "/dashboard/index", 
     array("onmouseover" => "Tip('Test');"),
     array('escape' => false)); 
```

# css - 如何让数据从一个 div 标签流入另一个标签并平衡两者之间的高度？

> ID：815722
> 
> 赞同：1
> 
> 时间：2009-05-02T22:01:39.397
> 
> 标签：css, html

我有多个浮动 div 标签，我想让它们从左到右堆叠在一起，这样它们看起来就像报纸上的文字。困难在于，如果我浮动 div，那么它们会从左到右移动，如果我不这样做，它们就会简单地堆叠在一起。有没有办法让它们从左到右均匀堆叠？

```
 <div>
        <br />
        <br />
        <style type="text/css">
            .mainpanel
            {
                display: block;
                border-left-width: 1px;
                border-left-color: Black;
                border-left-style: double;
                padding: 3px;
                float: left;
            }
        </style>
        <div style="" class="mainpanel">
            <div style="width: 245px; float: left; padding: 5px;">
                1
            </div>
            <div style="width: 245px; float: left; padding: 5px;">
                2
            </div>
            <div style="width: 245px; float: left; padding: 5px;">
                3
            </div>
            <div style="width: 245px; float: left; padding: 5px;">
                4
            </div>
            <div style="width: 245px; float: left; padding: 5px;">
                5
            </div>
            <div style="width: 245px; float: left; padding: 5px;">
                6
            </div>
            <div style="width: 245px; float: left; padding: 5px;">
                7
            </div>
            <div style="width: 245px; float: left; padding: 5px;">
                8
            </div>
            <div style="width: 245px; float: left; padding: 5px;">
                9
            </div>
        </div>
    </div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T17:23:02.473

虽然使用 CSS 3 会很好，但我意识到目前这并不实用，而且该标准还没有被使用。因此，为了解决我的问题，我已经开始测量后面代码中内容的大小，然后在表中添加一个标志，指示该列是否应该被破坏。这可以与 Div 标签或表格单元格一起使用。使用 Div 标签后，我切换到表格单元格，因为它们在显示属性以及它们在电子邮件消息中的呈现方式更加一致。在您的 aspx 页面中，在应呈现内容的第一个单元格或 div 标记内放置一个重复器或列表控件：

```
<table cellpadding="2" cellspacing="0">
<tr valign="top" >
<td  runat="server" id="TopTD">
       <asp:ListView ID="List" runat="server">
            <LayoutTemplate>
                <asp:PlaceHolder ID="itemPlaceHolder" runat="server"></asp:PlaceHolder>
            </LayoutTemplate>
            <ItemTemplate>
             <asp:literal runat="server" id="divdivide"
             visible='<%# eval("BreakFields") %>' Text='<%# eval("DivTag")%>'></asp:literal>
<%# eval("Content")%>
            </ItemTemplate>
            <ItemSeparatorTemplate>
        </asp:ListView>
   </td>
</tr>
    </table>
</div> 
```

在您背后的代码中，您需要四件事，一个测量您的内容的函数 一个用于填充您的内容的表格 一个具有列大小的属性 一个具有要显示的列数的属性

**测量功能：**

```
Function stringSize(ByVal strTarget As String, ByVal strFont As String, ByVal sngFontSize As Single) As SizeF
        strFont = "Arial, Sans-Serif"
        Dim bitImg As New Bitmap(1, 1)
        Dim g As Graphics = Graphics.FromImage(bitImg)
        Dim f As New Font(strFont, sngFontSize)
        Dim size As SizeF
        g.PageUnit = GraphicsUnit.Pixel
        size = g.MeasureString(strTarget, f)

        Dim I As Int32

        If Not String.IsNullOrEmpty(strTarget) Then
            Dim Re As New Regex(vbCrLf)
            I = Re.Matches(strTarget).Count
        End If
        If ColumnWidth > 0 Then
            size.Height = (size.Height * (Math.Ceiling(size.Width / ColumnWidth))) + (I * 20)
            size.Width = ColumnWidth
            Else
            size.Height = (size.Height * (Math.Ceiling(size.Width / DefaultSize))) + (I * 20)
            size.Width = DefaultSize
        End If
        g.Dispose()
        bitImg.Dispose()
        f.Dispose()

        Return size
    End Function
Public ColumnWidth() As Int32 
```

当您要显示数据时，您需要将其放入表格并进行测量。

```
Dim DT As New DataTable
DT.Columns.Add("Content", GetType(Int32))
DT.Columns.Add("Height", GetType(Int32))
DT.Columns.Add("BreakFields", GetType(Boolean))
Dim Row As DataRow
For Each itemtodisplay
Row = DT.NewRow
      Row("Content") = itemtodidisplay
      Row("Height") = 0
      Row("Height") += Fix(stringSize(itemtodisplay, "Arial", 10).Height)
      Row("Height") += 10
      HeightCounter += Row("Height")
      DT.Rows.Add(Row)
Next
BindItems(DT, Top, StartDate) 
```

使用它来实际创建表以绑定到列表控件

```
Private Sub BindItems(ByVal DT As DataTable)
        If ColumnCount <= 0 Then
            ColumnCount = 1
        End If

        Dim I As Int32
        Dim HeightBreak As Int32 = (HeightCounter / ColumnCount) + 40
        Dim CurrentCol As Int32 = 1
        Dim Curheight As Int32
        I = 0
        Dim width As Int32
        If ColumnWidth > 0 Then
            width = ColumnWidth
        else
            width = DefaultSize
        End If
        If ColumnWidth > 0 Then
        TopTD.Width = width + 6
        DT.Columns.Add("DivTag", GetType(String))
        DT.Columns.Add("DivStyle", GetType(String))
        For Each Row In DT.Rows
            Row("DivStyle") = "width:" & width & "px; text-align:left;padding-bottom:3px;"
            If (Row("Height") + Curheight) > HeightBreak + 50 _
            And I > 0 _
            And ColumnCount > 1 _
                And CurrentCol < ColumnCount Then
                Row("BreakFields") = True
                Row("DivTag") = "</td><td width=" & width + 6 & ">"
                CurrentCol += 1
                Curheight = 0
            Else
                Row("BreakFields") = False
            End If
            I += 1
            Curheight += Row("Height")
        Next

        StoryList.DataSource = DT
        StoryList.DataBind()
    End Sub 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-03T02:17:53.633

为了跨浏览器兼容性和纯 CSS？我不认为，而且我很想被证明是错误的，这是可能的。

如果您不介意呈现差异，则可以使用 -moz 和 -webkit 选项：

```
div#multicolumn1 {
        -moz-column-count: 3;
        -moz-column-gap: 10px;
        -webkit-column-count: 3;
        -webkit-column-gap: 10px;
        column-count: 3;
        column-gap: 10px;
} 
```

div#multicolumn1 { -moz-column-count: 3; -moz-column-gap：10px；-webkit 列数：3；-webkit-column-gap：10px；列数：3；列间距：10px；}

```
<div id=multicolumn1>
<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Maecenas iaculis nisl nec nunc. Nam id lacus et lectus molestie tristique. Nunc vel risus consequat nisi vehicula cursus. Proin metus augue, cursus vitae, feugiat quis, porttitor ac, elit. Nulla et dui in mi laoreet auctor. Ut imperdiet nisl ut sem. Maecenas sodales magna eu neque. Nulla sagittis. Donec nec eros quis ligula condimentum scelerisque. Ut venenatis orci non odio. Duis mauris velit, sagittis sit amet, fringilla vel, ornare id, ipsum. Aenean et purus. Curabitur in massa. Morbi egestas nibh sed libero. Cras volutpat. Cras vitae nulla id urna consequat bibendum. Nunc bibendum ultricies orci. Cras id lorem. Pellentesque vel nisi. Nulla ligula eros, aliquet sed, vestibulum non, ultrices id, odio. </p>
</div> 
```

Lorem ipsum dolor sit amet, consectetur adipiscing elit。Maecenas iaculis nisl nec nunc。Nam id lacus et lectus molestie tristique。Nunc vel risus consequat nisi vehicula cursus。Proin metus augue, cursus vitae, feugiat quis, porttitor ac, elit。Nulla et dui in mi laoreet auctor。Ut imperdiet nisl ut sem。Maecenas sodales magna eu neque。空矢状窦。Donec nec eros quis ligula condimentum scelerisque。Ut venenatis orci non odio。Duis mauris velit, sagittis sat amet, fringilla vel, ornare id, ipsum。Aenean et purus。马萨的Curabitur。Morbi gestas nibh sed libero。克拉斯 volutpat。Cras vitae nulla id urna consequat bibendum。Nunc bibendum ultricies orci。Cras id lorem。Pellentesque vel nisi。Nulla ligula eros，aliquet sed，前庭非，ultrices id，odio。

运气好的话，大概只有在 Webkit 或 Mozilla 浏览器中，这应该会呈现在屏幕上。对于任何使用 IE 的人，你可能会明白为什么它不兼容跨浏览器，很遗憾。

不过，有一个 CSS3 提案，所以希望：[http](http://www.w3.org/TR/css3-multicol/) ://www.w3.org/TR/css3-multicol/ 。

编辑：给彼得保罗科赫的道具，[http://www.quirksmode.org](http://www.quirksmode.org)上面的例子或多或少是从它的全部中提取出来的。源文章在这里：[http://www.quirksmode.org/css/multicolumn.html](http://www.quirksmode.org/css/multicolumn.html)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-02T22:36:30.797

也许您应该指定高度，例如最大限制并且没有惊喜

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-02T22:35:39.127

我认为这超出了 CSS 定义的职责范围。您可能必须动态生成它。`<div>`为列元素创建一个新元素。`<div>`分别在列内堆叠s。然后从左到右浮动列。

# javascript - html链接更改文本框的值

> ID：815724
> 
> 赞同：1
> 
> 时间：2009-05-02T22:03:18.363
> 
> 标签：javascript, html, textbox, onclick

我正在尝试在 html 中创建文本，一旦单击，位于它附近的文本框的值就会将其值更改为等于单击的文本的值。反正我能做到吗？

换句话说，我想要链接/文本的按钮（onClick 事件）的功能。例如：这有什么问题？

```
<td>
    <input type="submit" name="submit" value=<%=text.toString()%>  
        onClick="(<% TextBox1.Text=text.toString()%>)" 
        style="background:none;border:0;color:#ff0000">
</td> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-02T22:06:02.460

假设输入有一个值为“foo”的 id 属性：

```
onclick="document.getElementById('foo').value='bar';" 
```

像 JQuery 这样的框架可以使这稍微简单一些：

```
$('#foo').attr('value', 'bar'); 
```

例如，可以将此事件添加到 span 元素。最佳实践是使用脚本来设置这些事件和特殊样式以反映它们的行为方式，这样在没有脚本的情况下它们的不同（缺乏）行为仍然看起来很直观。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-02T22:11:20.933

你可以这样做：

```
<span onclick="document.getElementById('myTextbox').value=this.innerHTML;">text</span>
<input type="text" value="" id="myTextbox"> 
```

使用 jQuery ：

```
<span onclick="$('#myTextbox').val(this.innerHTML);">text</span>
<input type="text" value="" id="myTextbox"> 
```

# c# - 从文件共享运行 .NET 应用程序，无需代码签名

> ID：815740
> 
> 赞同：3
> 
> 时间：2009-05-02T22:12:21.757
> 
> 标签：c#, .net, vb.net, security, clr

每当从文件共享运行 .NET exe 时，.NET 安全模型都会引发安全错误。从本地驱动器运行时不会出现该错误。有谁知道无需对代码进行签名的解决方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-03T01:22:59.257

[使用 CasPol 完全信任共享](http://blogs.msdn.com/shawnfa/archive/2004/12/30/344554.aspx)

更多答案在这里：

[为什么我的 .NET 应用程序从网络驱动器运行时会崩溃？](https://stackoverflow.com/questions/148879/why-does-my-net-application-crash-when-run-from-a-network-drive)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-02T22:26:30.710

使用[caspol.exe](http://msdn.microsoft.com/en-us/library/cb6t8dtz(VS.80).aspx)为该文件共享分配足够的权限以运行您的程序。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-02T22:42:15.867

您可能能够针对 .net 3.5 sp1 构建应用程序，此版本删除了此安全设置。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-02T22:19:13.300

为了解决这个问题，我们最终将 .exe 包装在一个批处理文件中。批处理文件将 .exe 复制到本地驱动器并从那里运行它。我敢肯定有一种不那么老套的方法！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-02T23:21:20.140

确保在运行该软件的机器上安装了 .Net 3.5SP1。此版本消除了对从文件共享运行的应用程序的安全限制。与将它们置于受限环境中的先前模型相比，它允许它们以完全信任的方式运行。

这是 Vance 关于该主题的博客文章的链接

*   [http://blogs.msdn.com/vancem/archive/2008/08/13/net-framework-3-5-sp1-allows-managed-code-to-be-launched-from-a-network-share。 aspx](http://blogs.msdn.com/vancem/archive/2008/08/13/net-framework-3-5-sp1-allows-managed-code-to-be-launched-from-a-network-share.aspx)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-02T23:09:29.857

您可以使用 .Net 配置向导来放松特定程序集及其位置的安全性，这又可以通过组策略进行部署。您也可以使用前面提到的 caspol。

另一种选择是使用代码访问安全性。[这里](http://msdn.microsoft.com/en-us/library/930b76w0.aspx)有一篇精彩的 MSDN 文章解释它。

第三种选择是使用 clickonce 部署，但是这仍然会在执行时创建程序集的本地实例。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-02T23:23:08.843

您可以使用[Click Once 部署](http://msdn.microsoft.com/en-us/library/142dbbz4.aspx)从文件共享中部署您的应用程序。

# bash - Shell 变量在命令行中可用，但在脚本中不可用

> ID：815742
> 
> 赞同：16
> 
> 时间：2009-05-02T22:13:26.420
> 
> 标签：bash, unix

在 bash 命令行中，我设置了一个变量`myPath=/home/user/dir`. 我创建了一个脚本，`echo $myPath`但它似乎不起作用。它没有任何回应。如果我`echo $myPath`在命令行中编写，它可以工作，但不能在脚本中。

我可以做些什么来访问`myPath`脚本中的变量？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-05-02T22:18:48.683

你是如何分配变量的？它应该是：

```
$ export myPath="/home/user/dir" 
```

然后在一个shell程序中，如：

```
#!/usr/bin/env bash
echo $myPath 
```

你会得到想要的结果。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-05-02T22:18:06.190

导出变量：

```
export myPath=/home/user/dir 
```

这指示 shell 使变量在外部进程和脚本中可用。如果你没有`export`这个变量，它将被认为是当前 shell 的本地变量。

要查看当前导出的变量列表，请使用`env`. 这也可用于验证变量是否已正确定义和导出：

```
$ env | grep myPath
myPath=/home/user/dir 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-02T22:49:22.683

您也可以这样做来为 myscript 设置 myPath 变量

```
myPath="whatever" ./myscript 
```

有关环境变量公认的棘手语法的详细信息，请参见： [http ://www.pixelbeat.org/docs/env.html](http://www.pixelbeat.org/docs/env.html)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-03T01:22:39.320

您必须使用“export”声明变量赋值，如下所示：

```
export myPath="/home/user/dir" 
```

这将导致 shell 将变量包含在它启动的子进程的环境中。 **默认情况下，您声明的变量（没有“导出”）不会传递给 subprocess**。这就是为什么您最初没有得到预期结果的原因。

# azure - 通过 ADO.NET 数据服务客户端库访问 SQL 数据服务

> ID：815743
> 
> 赞同：1
> 
> 时间：2009-05-02T22:13:55.920
> 
> 标签：azure, wcf-data-services, sql-data-services

这可能吗？基本上我想使用 SQL 数据服务 REST 接口，让 ADO.NET 数据服务客户端库处理通信细节并生成我可以使用的实体。我查看了 2 月发布的 Azure 服务工具包中的示例，但其中的示例使用 HttpWebRequest 和 HttpWebResponse 以 RESTful 方式使用 SQL 数据服务。我希望使用 ADO.NET 数据服务客户端库来抽象低级细节。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-02T23:32:30.053

是的你可以！或者至少，他们正在努力……

自二月以来，他们已经改变了 SDS 的方向（他们现在将提供一个实际的关系数据库），但从那以后我没有机会深入研究这个主题，所以我不能 100% 确定哪些部分已经工作。

有关信息，请参阅此[SDS 团队博客文章](http://blogs.msdn.com/ssds/archive/2009/03/20/9492744.aspx)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-04-09T18:08:51.383

您现在可以轻松做到这一点（从 MIX10 开始）。在 SQL Azure 中创建数据库时，现在可以选择在该数据上公开 OData 端点（基于 REST 的端点）。完成此操作后，您可以将 WCF 数据服务（以前称为 ADO.NET 数据服务）客户端（VIA Add Service Reference in Visual Studio）指向端点，并为该 SQL Azure 端点获取生成的数据服务客户端。

# wix - 检索 MSI 文件的版本（使用 WiX 构建）

> ID：815744
> 
> 赞同：8
> 
> 时间：2009-05-02T22:13:57.043
> 
> 标签：wix, windows-installer, version

我用 WiX 创建了一个 MSI 文件。源 WiX 文件包含如下版本信息：

```
<Product Id="..." 
         Name="..." 
         Language="1033" 
         Version="1.0.0.1" 
         Manufacturer="..." 
         UpgradeCode="..."> 
```

MSI 文件似乎工作正常：它会安装、卸载、当我增加版本号时会升级等。

但是，当我尝试通过调用 MsiGetFileVersion() API 获取有关此文件的版本信息时，它返回错误 1006（ERROR_FILE_INVALID 文件不包含版本信息。）

因此我的问题是：如何（以编程方式，在 C++ 中）检索 MSI 文件的版本号？或者，换一种说法，版本信息应该放在 WiX 文件的哪个位置才能通过 MsiGetFileVersion() 检索？

更多信息：Windows XP 上的 MSI 3.0 和 Vista 上的 MSI 4.0 也会出现同样的错误。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-03T02:03:08.473

作为参考，这是我在构建过程中使用的一个 VBscript 示例，用于在创建 boostrapper 之前获取此类示例。

```
Dim installer, database, view, result

Set installer = CreateObject("WindowsInstaller.Installer")
Set database = installer.OpenDatabase ("my.msi", 0)

Dim sumInfo  : Set sumInfo = installer.SummaryInformation("my.msi", 0)
sPackageCode =  sumInfo.Property(9) ' PID_REVNUMBER = 9, contains the package code.

WScript.Echo getproperty("ProductVersion")
WScript.Echo getproperty("ProductVersion")
WScript.Echo sPackageCode
WScript.Echo getproperty("ProductName")

Function getproperty(property)

    Set view = database.OpenView ("SELECT Value FROM Property WHERE Property='" & property & "'")
    view.Execute
    Set result = view.Fetch
    getproperty = result.StringData(1)

End Function 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-03T17:19:40.597

出于完整性考虑， ::MsiGetFileVersion() 是一个从 PE 文件（.exe 或 .dll）读取版本资源信息的函数，与 Windows Installer 的方式*相同。*这对于使用构建工具（例如[WiX 工具集](http://wix.sf.net)）很重要，因此它们可以正确填充 File/@Version 信息。它不会让您从 MSI 中获取版本信息。正如@sascha 所示，您可以查询“ProductVersion”的属性表，或者您可以使用 ::MsiGetProductProperty() 来执行相同的操作。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-03T00:29:18.433

找到了解决方案：而不是调用 MsiGetFileVersion()，调用：

```
MSIHANDLE hProduct = NULL;
MsiOpenPackage( pszPath, &hProduct );

MsiGetProductProperty( hProduct, _T("ProductVersion"), pszVersion, &dwSizeVersion );

MsiCloseHandle( hProduct ); 
```

（省略错误处理）

# ruby-on-rails - 什么可能导致这个rails ioerror关闭流？

> ID：815757
> 
> 赞同：8
> 
> 时间：2009-05-02T22:20:20.490
> 
> 标签：ruby-on-rails, ruby, exception, ioerror

我有一个 Rails 应用程序，在开发模式下运行（使用 sqlite 数据库）。该应用程序的目的是允许用户通过 java 客户端上传文件。

如果用户想上传一个文件夹，里面的所有文件都会递归上传。如果用户要上传文件，文件将正常上传。

这是我收到的错误：

```
 IOError

    in UploadedFilesController#new

closed stream 
```

这是应用程序跟踪：

```
 /usr/lib/ruby/1.8/tempfile.rb:167:in `close'
/usr/lib/ruby/1.8/tempfile.rb:167:in `callback'
/var/lib/gems/1.8/gems/activesupport-2.0.2/lib/active_support/vendor/builder-2.1.2/blankslate.rb:85:in `call'
/var/lib/gems/1.8/gems/activesupport-2.0.2/lib/active_support/vendor/builder-2.1.2/blankslate.rb:85:in `method_added'
app/controllers/uploaded_files_controller.rb:114
/var/lib/gems/1.8/gems/activesupport-2.0.2/lib/active_support/dependencies.rb:203:in `load_without_new_constant_marking'
/var/lib/gems/1.8/gems/activesupport-2.0.2/lib/active_support/dependencies.rb:203:in `load_file'
/var/lib/gems/1.8/gems/activesupport-2.0.2/lib/active_support/dependencies.rb:342:in `new_constants_in'
/var/lib/gems/1.8/gems/activesupport-2.0.2/lib/active_support/dependencies.rb:202:in `load_file'
/var/lib/gems/1.8/gems/activesupport-2.0.2/lib/active_support/dependencies.rb:94:in `require_or_load'
/var/lib/gems/1.8/gems/activesupport-2.0.2/lib/active_support/dependencies.rb:248:in `load_missing_constant'
/var/lib/gems/1.8/gems/activesupport-2.0.2/lib/active_support/dependencies.rb:453:in `const_missing'
/var/lib/gems/1.8/gems/activesupport-2.0.2/lib/active_support/dependencies.rb:465:in `const_missing'
/var/lib/gems/1.8/gems/activesupport-2.0.2/lib/active_support/inflector.rb:257:in `constantize'
/var/lib/gems/1.8/gems/activesupport-2.0.2/lib/active_support/core_ext/string/inflections.rb:148:in `constantize'
/var/lib/gems/1.8/gems/actionpack-2.0.2/lib/action_controller/routing.rb:1426:in `recognize'
/var/lib/gems/1.8/gems/rails-2.0.2/lib/webrick_server.rb:78:in `service'
/var/lib/gems/1.8/gems/rails-2.0.2/lib/commands/servers/webrick.rb:66
/var/lib/gems/1.8/gems/activesupport-2.0.2/lib/active_support/dependencies.rb:496:in `require'
/var/lib/gems/1.8/gems/activesupport-2.0.2/lib/active_support/dependencies.rb:342:in `new_constants_in'
/var/lib/gems/1.8/gems/activesupport-2.0.2/lib/active_support/dependencies.rb:496:in `require'
/var/lib/gems/1.8/gems/rails-2.0.2/lib/commands/server.rb:39 
```

这是框架跟踪：

```
 /usr/lib/ruby/1.8/tempfile.rb:167:in `close'
/usr/lib/ruby/1.8/tempfile.rb:167:in `callback'
/var/lib/gems/1.8/gems/activesupport-2.0.2/lib/active_support/vendor/builder-2.1.2/blankslate.rb:85:in `call'
/var/lib/gems/1.8/gems/activesupport-2.0.2/lib/active_support/vendor/builder-2.1.2/blankslate.rb:85:in `method_added'
/var/lib/gems/1.8/gems/actionpack-2.0.2/lib/action_controller/dispatcher.rb:170:in `handle_request'
/var/lib/gems/1.8/gems/actionpack-2.0.2/lib/action_controller/dispatcher.rb:115:in `dispatch'
/var/lib/gems/1.8/gems/actionpack-2.0.2/lib/action_controller/dispatcher.rb:126:in `dispatch_cgi'
/var/lib/gems/1.8/gems/actionpack-2.0.2/lib/action_controller/dispatcher.rb:9:in `dispatch'
/var/lib/gems/1.8/gems/rails-2.0.2/lib/webrick_server.rb:112:in `handle_dispatch'
/usr/lib/ruby/1.8/webrick/httpserver.rb:104:in `service'
/usr/lib/ruby/1.8/webrick/httpserver.rb:65:in `run'
/usr/lib/ruby/1.8/webrick/server.rb:173:in `start_thread'
/usr/lib/ruby/1.8/webrick/server.rb:162:in `start'
/usr/lib/ruby/1.8/webrick/server.rb:162:in `start_thread'
/usr/lib/ruby/1.8/webrick/server.rb:95:in `start'
/usr/lib/ruby/1.8/webrick/server.rb:92:in `each'
/usr/lib/ruby/1.8/webrick/server.rb:92:in `start'
/usr/lib/ruby/1.8/webrick/server.rb:23:in `start'
/usr/lib/ruby/1.8/webrick/server.rb:82:in `start'
/var/lib/gems/1.8/gems/rails-2.0.2/lib/webrick_server.rb:62:in `dispatch'
/usr/lib/ruby/1.8/rubygems/custom_require.rb:31:in `gem_original_require'
/usr/lib/ruby/1.8/rubygems/custom_require.rb:31:in `require'
/usr/lib/ruby/1.8/rubygems/custom_require.rb:31:in `gem_original_require'
/usr/lib/ruby/1.8/rubygems/custom_require.rb:31:in `require'
script/server:3 
```

这是完整的跟踪：

```
 /usr/lib/ruby/1.8/tempfile.rb:167:in `close'
/usr/lib/ruby/1.8/tempfile.rb:167:in `callback'
/var/lib/gems/1.8/gems/activesupport-2.0.2/lib/active_support/vendor/builder-2.1.2/blankslate.rb:85:in `call'
/var/lib/gems/1.8/gems/activesupport-2.0.2/lib/active_support/vendor/builder-2.1.2/blankslate.rb:85:in `method_added'
app/controllers/uploaded_files_controller.rb:114
/var/lib/gems/1.8/gems/activesupport-2.0.2/lib/active_support/dependencies.rb:203:in `load_without_new_constant_marking'
/var/lib/gems/1.8/gems/activesupport-2.0.2/lib/active_support/dependencies.rb:203:in `load_file'
/var/lib/gems/1.8/gems/activesupport-2.0.2/lib/active_support/dependencies.rb:342:in `new_constants_in'
/var/lib/gems/1.8/gems/activesupport-2.0.2/lib/active_support/dependencies.rb:202:in `load_file'
/var/lib/gems/1.8/gems/activesupport-2.0.2/lib/active_support/dependencies.rb:94:in `require_or_load'
/var/lib/gems/1.8/gems/activesupport-2.0.2/lib/active_support/dependencies.rb:248:in `load_missing_constant'
/var/lib/gems/1.8/gems/activesupport-2.0.2/lib/active_support/dependencies.rb:453:in `const_missing'
/var/lib/gems/1.8/gems/activesupport-2.0.2/lib/active_support/dependencies.rb:465:in `const_missing'
/var/lib/gems/1.8/gems/activesupport-2.0.2/lib/active_support/inflector.rb:257:in `constantize'
/var/lib/gems/1.8/gems/activesupport-2.0.2/lib/active_support/core_ext/string/inflections.rb:148:in `constantize'
/var/lib/gems/1.8/gems/actionpack-2.0.2/lib/action_controller/routing.rb:1426:in `recognize'
/var/lib/gems/1.8/gems/actionpack-2.0.2/lib/action_controller/dispatcher.rb:170:in `handle_request'
/var/lib/gems/1.8/gems/actionpack-2.0.2/lib/action_controller/dispatcher.rb:115:in `dispatch'
/var/lib/gems/1.8/gems/actionpack-2.0.2/lib/action_controller/dispatcher.rb:126:in `dispatch_cgi'
/var/lib/gems/1.8/gems/actionpack-2.0.2/lib/action_controller/dispatcher.rb:9:in `dispatch'
/var/lib/gems/1.8/gems/rails-2.0.2/lib/webrick_server.rb:112:in `handle_dispatch'
/var/lib/gems/1.8/gems/rails-2.0.2/lib/webrick_server.rb:78:in `service'
/usr/lib/ruby/1.8/webrick/httpserver.rb:104:in `service'
/usr/lib/ruby/1.8/webrick/httpserver.rb:65:in `run'
/usr/lib/ruby/1.8/webrick/server.rb:173:in `start_thread'
/usr/lib/ruby/1.8/webrick/server.rb:162:in `start'
/usr/lib/ruby/1.8/webrick/server.rb:162:in `start_thread'
/usr/lib/ruby/1.8/webrick/server.rb:95:in `start'
/usr/lib/ruby/1.8/webrick/server.rb:92:in `each'
/usr/lib/ruby/1.8/webrick/server.rb:92:in `start'
/usr/lib/ruby/1.8/webrick/server.rb:23:in `start'
/usr/lib/ruby/1.8/webrick/server.rb:82:in `start'
/var/lib/gems/1.8/gems/rails-2.0.2/lib/webrick_server.rb:62:in `dispatch'
/var/lib/gems/1.8/gems/rails-2.0.2/lib/commands/servers/webrick.rb:66
/usr/lib/ruby/1.8/rubygems/custom_require.rb:31:in `gem_original_require'
/usr/lib/ruby/1.8/rubygems/custom_require.rb:31:in `require'
/var/lib/gems/1.8/gems/activesupport-2.0.2/lib/active_support/dependencies.rb:496:in `require'
/var/lib/gems/1.8/gems/activesupport-2.0.2/lib/active_support/dependencies.rb:342:in `new_constants_in'
/var/lib/gems/1.8/gems/activesupport-2.0.2/lib/active_support/dependencies.rb:496:in `require'
/var/lib/gems/1.8/gems/rails-2.0.2/lib/commands/server.rb:39
/usr/lib/ruby/1.8/rubygems/custom_require.rb:31:in `gem_original_require'
/usr/lib/ruby/1.8/rubygems/custom_require.rb:31:in `require'
script/server:3 
```

我不知道为什么会发生这种情况......在出现此错误之前，客户端可以上传大约 15-30 个文件（从文件夹中，通过 java 客户端）。我正在运行 Rails 2.0.2 。我使用 sqlite 作为数据库在开发模式下运行的事实会导致这种情况吗？任何帮助将不胜感激 ！

多谢你们 ！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-02T23:25:38.663

我想我已经想通了，至少我想我想通了（客户端现在继续上传，没有错误）。从您上传的文件中读取数据后，您还应该**关闭**它。谁曾想到？:P

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-02-04T20:28:45.610

我们在 Rails 应用程序中遇到了同样的问题，尽管简单地关闭文件对象对我们不起作用（我们使用 Paperclip，它确实关闭了文件）。我为已为我们修复它的 Tempfile 类开发了一个猴子补丁，我们将其用作 Rails 初始化程序。

您可以从[http://github.com/jwinky/ruby_tempfile_ioerror获取它](http://github.com/jwinky/ruby_tempfile_ioerror)

# embedded - 简单的串行点对点通信协议

> ID：815758
> 
> 赞同：64
> 
> 时间：2009-05-02T22:20:38.760
> 
> 标签：embedded, serial-port, protocols

我需要两个设备（PC 和微控制器）之间的简单通信协议。PC 必须向 micro 发送一些命令和参数。微型必须传输一个字节数组（来自传感器的数据）。

数据必须有[噪声保护](http://en.wikipedia.org/wiki/Error_detection_and_correction)（除了奇偶校验，我想我需要一些其他的数据校正方法）。

有没有标准的解决方案来做到这一点？（我只需要一个想法，而不是完整的解决方案）。

PS任何建议表示赞赏。*PPS 很抱歉有任何语法错误，希望你能理解。*

**编辑1.**我还没有决定是***主/从***协议还是双方都可以发起通信。PC 必须知道 micro 何时完成工作并可以发送数据。如果数据准备好，它可以连续轮询微，或者微可以在工作完成时发送数据。我不知道哪个更好更简单。

**编辑 2.** ***硬件和[物理层](http://en.wikipedia.org/wiki/Physical_Layer)协议。***由于PC 使用[RS-232](http://en.wikipedia.org/wiki/RS-232) C 串行标准，我将使用[异步通信](http://en.wikipedia.org/wiki/Asynchronous_serial_communication)。我将只使用 RxD、TxD 和 GND 信号。我不能使用额外的电线，因为微控制器 AFAIK 不支持它们。顺便说一句，我使用的是[AVR](http://en.wikipedia.org/wiki/Atmel_AVR) ATmega128 芯片。

所以我将使用固定波特率、8 位数据、2 个停止位而不进行奇偶校验（或使用？）。

***[数据链路协议](http://en.wikipedia.org/wiki/Data_Link_Layer)***。这就是我的问题主要关心的问题。感谢您推荐[HDLC](http://en.wikipedia.org/wiki/High-Level_Data_Link_Control)、[PPP](http://en.wikipedia.org/wiki/Point-to-Point_Protocol)和[Modbus](http://en.wikipedia.org/wiki/Modbus)协议。我会研究它。

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2009-05-02T22:45:56.887

我会使用[HDLC](http://en.wikipedia.org/wiki/HDLC)。过去我很幸运。我希望点对点串行只使用[异步框架](http://en.wikipedia.org/wiki/High-Level_Data_Link_Control#Asynchronous_framing)并忘记所有其他控制内容，因为它可能会过度杀伤。

除了使用 HDLC 来构建数据包。我像下面这样格式化我的数据包。这是使用 802.11 传递选项的方式

```
U8 cmd;
U8 len;
u8 payload[len]; 
```

每个命令包的总大小为 len +2

然后，您定义命令，例如

```
#define TRIGGER_SENSOR 0x01
#define SENSOR_RESPONSE 0x02 
```

另一个优点是您可以添加新命令，并且如果您正确设计解析器以忽略未定义的命令，那么您将具有一些向后兼容性。

因此，将它们放在一起，数据包将如下所示。

```
 // total packet length minus flags len+4
 U8 sflag;   //0x7e start of packet end of packet flag from HDLC
 U8 cmd;     //tells the other side what to do.
 U8 len;     // payload length
 U8 payload[len];  // could be zero len
 U16 crc;
 U8 eflag;   //end of frame flag 
```

然后系统将监视串行流的标志 0x7e，当它在那里时，您检查长度以查看它是否 pklen >= 4 和 pklen=len+4 以及 crc 是否有效。注意不要仅仅依赖于小数据包的 crc，你会得到很多误报，还会检查长度。如果长度或 crc 不匹配，只需重置长度和 crc 并开始解码新帧。如果匹配，则将数据包复制到新缓冲区并将其传递给您的命令处理函数。收到标志时始终重置长度和CRC。

对于您的命令处理功能，请获取 cmd 和 len，然后使用开关来处理每种类型的命令。我还要求某些事件发送响应，以便系统的行为类似于事件驱动的远程过程调用。

因此，例如，传感器设备可以具有计时器或响应命令以读取读数。然后它将格式化一个数据包并将其发送到 PC，PC 将响应它收到数据包。如果不是，则传感器设备可以在超时时重新发送。

此外，当您进行网络传输时，您应该将其设计为像[OSI 模型](http://en.wikipedia.org/wiki/OSI_model)一样的网络堆栈，因为[Foredecker](https://stackoverflow.com/users/18256/foredecker)指出不要忘记[物理层的东西](https://stackoverflow.com/questions/815758/simple-serial-point-to-point-communication-protocol/817750#817750)。我在 HDLC 上的帖子是[数据链路层](http://en.wikipedia.org/wiki/OSI_model#Layer_2:_Data_Link_Layer)，而[RPC 和命令处理是应用层](http://en.wikipedia.org/wiki/OSI_model#Layer_7:_Application_Layer)。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-05-03T19:08:46.917

RS232 protocols are tricky. The suggestion to use HDLC, is a good one, but its not the entire solution. There are other things you need to decide:

*   How will the baud rate between the two devices be determined? Autobuad? Predefined, or set explicate?
*   Will you do flow control in software or hardware or both? Note, if you use hardware flow control then you *must* make sure, that the cables are built correctly.
*   Speaking of cables, this is a huge pain with RS233\. Depending on the device, you may need to use a straight through cable, or a cross over cable, or a variant.
*   Using a software based flow control mechanism can be effective as it allows the most simple cable to be used - just three wired (TX, RX, and common).
*   Do you pick a 7 or 8 bit word?
*   HW parity or software error checking.

I suggest you go with 8 data bits, no hardware parity, 1 stop bit, and use software based flow control. You should use autobaud if your hardware supports it. If not, then autobaud is devilishly difficult to do in software.

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2015-02-18T16:51:00.517

几个月前我读了这个问题，遇到了完全相同的问题，并没有真正找到任何足够有效的东西来处理一个只有少量 RAM 的 8 位微型计算机。因此，受 CAN 和 LIN 的启发，我构建了一些东西来完成这项工作。我将其称为 MIN（微控制器互连网络），并已将其上传到 GitHub：

[https://github.com/min-protocol/min](https://github.com/min-protocol/min)

那里有两种实现：一种在嵌入式 C 中，另一种在 Python 中用于 PC。加上一个小小的“hello world”测试程序，PC 发送命令，固件点亮 LED。我在这里写了一篇关于如何在 Arduino 板上启动和运行的博客：

[https://kentindell.wordpress.com/2015/02/18/micrcontroller-interconnect-network-min-version-1-0/](https://kentindell.wordpress.com/2015/02/18/micrcontroller-interconnect-network-min-version-1-0/)

MIN 很简单。我修复了第 0 层表示（8 个数据位，1 个停止位，无奇偶校验），但波特率保持打开状态。每帧以三个 0xAA 字节开始，二进制为 1010101010，如果一端想要动态适应另一端，则可以很好地进行自动波特率检测。帧是 0-15 字节的有效载荷，带有 16 位 Fletcher 校验和以及一个控制字节和一个 8 位标识符（用于告诉应用程序有效载荷数据包含什么）。

该协议使用字符填充，因此 0xAA 0xAA 0xAA 始终表示帧开始。这意味着如果设备退出复位，它总是与下一帧的开始同步（MIN 的设计目标是永远不要传递不完整或不正确的帧）。这也意味着不需要有特定的字节间和帧间时序约束。该协议的完整细节在 GitHub repo wiki 中。

MIN 有未来改进的空间。我在其中留下了一些用于块消息传递（保留控制字节的 4 位）和更高级别的功能协商（保留标识符 0xFF）的钩子，因此有足够的空间来添加对常用功能的支持。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-06-21T04:29:49.467

这里有一些很好的答案，这里有一些有用的指针：

即使您的数据包不是时间分离的，同步字节也是减少您需要尝试构建数据包的位置数量的重要方法。您的设备通常必须处理一堆垃圾数据（即当它们打开时传输中的数据包结束，或硬件冲突的结果）。如果没有同步字节，您将不得不尝试从收到的每个字节中制作一个数据包。同步字节意味着只有 1/255 字节的随机噪声可能是数据包的第一个字节。当你想窥探你的协议时也很棒。

当您通过某种类型的[窥探工具](https://stackoverflow.com/questions/1023181/good-free-rs232-serial-snoop-tool-for-protocol-development-debugging)查看数据包时，在您的数据包上拥有一个地址，甚至只是说主/从或 pc / 设备非常有用。您可以通过为 PC 设置与 DEVICE 不同的同步字节来做到这一点。此外，这意味着设备不会响应自己的回声。

您可能想研究纠错（例如[Hamming](http://en.wikipedia.org/wiki/Hamming_code)）。您将 8 位数据打包成 12 位受保护字节。这 12 位中的任何一位都可以在途中翻转并检索原始的 8 位。适用于数据存储（用于 CD）或设备无法轻松重新发送的情况（卫星链接、单向射频）。

数据包编号使生活更轻松。发送的数据包带有一个数字，响应带有相同的数字和一个表示“响应”的标志。这意味着发送方很容易检测到从未到达的数据包（例如同步损坏），并且在具有慢速链路的全双工模式下，可以在收到第一个响应之前发送两个命令。这也使协议分析更容易（第三方可以在不了解底层协议的情况下了解接收到的数据包）

拥有一个主人是一个很棒的简化。也就是说，在全双工环境中，这并不重要。可以说你应该总是这样做，除非你试图节省电力或者你正在做一些在设备端驱动的事件（输入状态改变，样本准备好）。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-05-04T21:51:06.160

我的建议是modbus。它是一种高效且简单的标准协议，用于与具有传感器和参数的设备（例如 PLC）进行通信。[您可以在http://www.modbus.org](http://www.modbus.org)获得规格。它自 1979 年以来一直存在并且越来越受欢迎，您可以毫无问题地找到示例和库。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-05-03T14:02:34.220

这是一个替代协议：

```
u8  Sync          // A constant value which always marks the start of a packet
u16 Length        // Number of bytes in payload
u8  Data[Length]  // The payload
u16 Crc           // CRC 
```

使用 RS232/UART，因为 PC（串行端口）和处理器（UART）已经可以轻松处理（只需要[MAX232](http://www.maxim-ic.com/quick_view2.cfm/qv_pk/1798)芯片或类似芯片来进行电平转换）。

并且使用 RS232/UART，如果它不相关，您不必担心主/从。如有必要，可以使用流量控制。

建议的 PC 软件：可以自己编写，也可以使用[Docklight](http://www.fuh-edv.de/docklight/)进行简单的监控（评估版免费）。

对于更大的错误检查，最简单的是奇偶校验，或者如果你需要更强大的东西，也许是[卷积编码](http://en.wikipedia.org/wiki/Convolutional_code)。

无论如何，无论你做什么：**保持简单！**

**编辑：**在 PC 上使用 RS232 比以前更容易，因为您现在可以获得 USB 到 RS232/TTL 转换器。一端插入 PC 的 USB 插座，显示为普通串口；另一个输出 5 V 或 3.3 V 信号，可*直接*连接到您的处理器，无需电平转换。

我们使用了 FDTI Chip[的 TTL-232R-3V3](http://www.ftdichip.com/Products/EvaluationKits/TTL-232R-3V3.htm)，它非常适合这种应用。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-05-14T12:23:50.470

关于奇偶校验（因为它在这里出现了几次）：

他们大多没用。如果您担心单个位可能会错误地更改，那么很有可能第二个位也可能会更改，并且您会从奇偶校验中得到误报。

使用带有查找表的 CRC16 等轻量级的东西 - 它可以在接收到每个字节时计算出来，基本上只是一个 XOR。Steve Melnikoff 的建议非常适合小型微型企业。

我还建议传输人类可读的数据，而不是原始二进制文件（如果性能不是您的首要任务）。它将使调试和日志文件更加愉快。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-05-06T02:35:12.647

我唯一的建议是，如果您需要抗噪，您可能需要使用全双工 RS-422/485。您可以在 AVR 端使用与[此类](http://search.digikey.com/scripts/DkSearch/dksus.dll?Detail&name=ADM3488ARZ-ND)似的 IC ，然后在 PC 端使用 RS-232->RS-422 转换器，如此处[的 485PTBR](http://www.bb-elec.com/product_family.asp?FamilyId=17&TrailType=Sub&Trail=11)。如果您能找到或制作屏蔽电缆（两对屏蔽双绞线），那么您将获得更多保护。所有这些对于微型计算机和 PC 来说都是不可见的——无需更改软件。

无论您做什么，请确保您使用的是全双工系统，并确保 IC 上的读/写使能线已置位。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2016-02-10T08:07:26.693

您可以在 python 中查看[`Telemetry`](https://github.com/Overdrivr/Telemetry)及其相关的桌面实现[`Pytelemetry`](https://github.com/Overdrivr/pytelemetry)

## 主要特点

它是基于*PubSub 的协议*，但与 MQTT 不同的是，它是点对点协议，**没有代理**。

与任何 pubsub 协议一样，您可以从一端**发布**`topic`并在另一端收到有关该主题的通知。

在嵌入式方面，发布到主题非常简单：

```
publish("someTopic","someMessage") 
```

对于数字：

```
publish_f32("foo",1.23e-4)
publish_u32("bar",56789) 
```

这种发送变量的方式可能看起来有限，但下一个里程碑旨在通过执行以下操作为主题的解析增加额外的意义：

```
// Add an indexing meaning to the topic
publish("foo:1",45) // foo with index = 1
publish("foo:2",56) // foo with index = 2

// Add a grouping meaning to the topic
publish("bar/foo",67) // foo is under group 'bar'

// Combine
publish("bar/foo:45",54) 
```

如果您需要发送数组、复杂的数据结构等，这很好。

此外，PubSub 模式因其灵活性而非常出色。您可以构建主/从应用程序、设备到设备等。

## C 库[![GitHub版本](https://badge.fury.io/gh/Overdrivr%2Ftelemetry.svg)](https://badge.fury.io/gh/Overdrivr%2Ftelemetry)

只要您有一个像样的 UART 库，C 库就可以非常简单地添加到任何新设备上。

您只需实例化一个名为`TM_transport`（由 定义`Telemetry`）的数据结构，并分配 4 个函数指针`read` `readable` `write` `writeable`。

```
// your device's uart library function signatures (usually you already have them)
int32_t read(void * buf, uint32_t sizeToRead);
int32_t readable();
int32_t write(void * buf, uint32_t sizeToWrite);
int32_t writeable(); 
```

要使用遥测，您只需添加以下代码

```
// At the beginning of main function, this is the ONLY code you have to add to support a new device with telemetry
TM_transport transport;
transport.read = read;
transport.write = write;
transport.readable = readable;
transport.writeable = writeable;

// Init telemetry with the transport structure
init_telemetry(&transport);  

// and you're good to start publishing
publish_i32("foobar",... 
```

## Python 库[![PyPI 版本](https://badge.fury.io/py/pytelemetry.svg)](https://badge.fury.io/py/pytelemetry)

在桌面端，有`pytelemetry`实现协议的模块。

如果您知道 python，以下代码连接到串行端口，在 topic 上发布一次`foo`，在 3 秒内打印所有接收到的主题然后终止。

```
import runner
import pytelemetry.pytelemetry as tm
import pytelemetry.transports.serialtransport as transports
import time

transport = transports.SerialTransport()
telemetry = tm.pytelemetry(transport)
app = runner.Runner(transport,telemetry)

def printer(topic, data):
    print(topic," : ", data)

options = dict()
options['port'] = "COM20"
options['baudrate'] = 9600

app.connect(options)

telemetry.subscribe(None, printer)
telemetry.publish('bar',1354,'int32')
time.sleep(3)

app.terminate() 
```

如果你不懂python，可以使用命令行界面

## 遥测 CLI[![PyPI 版本](https://badge.fury.io/py/pytelemetrycli.svg)](https://badge.fury.io/py/pytelemetrycli)

命令行可以启动

```
pytlm 
```

然后你可以`connect`，`ls`（列出）接收到的主题，`print`在一个主题上接收到的数据，`pub`（发布）在一个主题上，或者`plot`在一个主题上打开一个来实时显示接收到的数据

[![在此处输入图像描述](https://i.stack.imgur.com/Exo7a.png)](https://i.stack.imgur.com/Exo7a.png)

[![在此处输入图像描述](https://i.stack.imgur.com/q3rvr.png)](https://i.stack.imgur.com/q3rvr.png)

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-05-07T13:25:48.143

也许这个问题可能完全是愚蠢的，但有没有人考虑过使用[X/Y/Z 调制解调器](http://en.wikipedia.org/wiki/XMODEM)协议之一？

使用上述协议之一的主要好处是在各种编程环境中都可以使用现成的实现。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-02T22:59:40.240

您没有具体说明微控制器的行为方式，但从微控制器传输的所有内容都会直接响应来自 PC 的命令吗？如果这样做，那么您似乎可以使用某种主/从协议（这通常是最简单的解决方案）。如果双方都能发起通信，则需要更通用的数据链路层协议。[HDLC](http://en.wikipedia.org/wiki/High-Level_Data_Link_Control)是一个经典的协议。尽管完整的协议可能对您的需求来说是多余的，但您至少可以使用相同的帧格式。你也可以看看[PPP](http://en.wikipedia.org/wiki/Point-to-Point_Protocol)看看是否有一些有用的部分。

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2009-12-01T03:46:52.763

SLIP 和 UDP。严重地。

所有 PC 和类似设备都使用它。

[TCP Lean](http://www.iosoft.co.uk/tcplean.php)有一本好书和例子

Jeremy Bentham 偷偷地得到了一个 PIC 正在工作的 TCP/IP。AVR 和 PIC 一样好，对吗？

我会推荐 UDP，它非常简单。

# text - 将单个 sed 命令转换为可重用的 Textmate 命令

> ID：815765
> 
> 赞同：5
> 
> 时间：2009-05-02T22:23:56.957
> 
> 标签：text, editor, sed, textmate

我有 7 行文字：

```
a
b
c
d
e
f
g 
```

现在我想在每一行的末尾添加字符，最终得到：

```
a,
b,
c,
d,
e,
f,
g, 
```

我发现我可以使用“sed”命令并使用 Textmate 中的“通过命令过滤”通过 sed 运行我的选择

```
sed 's/$/,/' 
```

现在，一个问题仍然存在：我如何将它变成一个 Textmate 命令，以某种方式接受输入（所以它知道要附加什么文本）？

（我这样做的尝试被证明是不成功的）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-09-10T10:06:50.403

将其弹出到文本包中的命令中，它将剪贴板中的任何内容附加到已选择的所有行的末尾：

```
#!/bin/bash
if [[ $(pbpaste|wc -l) -eq 0 ]]
    then r=`pbpaste`
    sed 's/$/'$r'/'
    else sed 's/$/,/'
fi 
```

它目前仅限于附加一行的文本，如果剪贴板包含多行，它将默认为所选行末尾的逗号。

**编辑：**

为了更进一步，这里有一个版本，它提供了一个对话框，提示输入将附加到选择中每一行的字符串：

```
#!/bin/bash
r=$(CocoaDialog inputbox --title "String to be appended to EOL" \
   --informative-text "Enter string:" \
   --button1 "Okay" --button2 "Cancel")

[[ $(head -n1 <<<"$r") == "2" ]] && exit_discard

r=$(tail -n1 <<<"$r")

sed "s/$/$r/" 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-03T20:06:47.760

在**文本**菜单中已经有一个命令“***编辑选择中的每一行***”正是这样做的。它会将光标放在第一行，并且您在每行重复输入的内容。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-11T21:30:52.973

在包编辑器中创建一个新命令

```
#!/bin/bash
sed 's/$/,/' 
```

在输入下拉列表中选择**Selected text**或**Nothing**
在输出中选择**Replace existing text**

我刚刚测试了它，它工作正常。
您还可以选择键盘快捷键以提高效率。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-12T20:27:20.090

如果您愿意避免使用命令路由并简单地使用“查找/替换”对话框，只需执行以下操作：

*   突出显示/选择要附加到的行
*   打开查找对话框
*   检查“正则表达式”
*   在“查找”字段中，添加`'$'`（以指示行尾）
*   在“替换”字段中，添加`','`（您想要附加的内容）
*   按住`Option`，这会将“全部替换”更改为“选择中”

这种技术可以以许多其他有用的方式应用。例如，更改`'$'`为`'^'`是否要为每行添加前缀。

# version-control - 可以将源代码控制软件用于您的技术文档吗？

> ID：815770
> 
> 赞同：2
> 
> 时间：2009-05-02T22:27:27.620
> 
> 标签：version-control

我知道您可以将源代码控制软件用于源代码，但您也可以将它用于您的技术文档吗？例如，您可以存储 Word 文档并保留更改历史记录（我知道它有跟踪更改，这只是示例）？谢谢你。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-02T22:38:17.157

如果您在 Windows 平台上，那么[TortoiseSVN](http://tortoisesvn.tigris.org/)有一些非常有用的功能可以让您区分（但不幸的是不能合并）Word 文档。它直接与已安装的 Word 交互，当您请求差异时，它会运行一个脚本，将两个文档加载到 Word 中进行比较，并使用 Word 的内置文档比较来比较它们。

有了这个特性，再加上 Subversion 的锁定（编辑者必须请求锁定文档以关闭只读标志），我发现使用 Subversion 管理 Word 文档非常容易。它不像纯文本那么方便，但是当您必须生成 Word 文档时，它肯​​定是可行的。

如上所述，一般来说，文档是软件开发过程的产物，*必须*以某种方式进行版本控制。否则，您的过程是不完整的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-02T22:56:26.737

版本控制系统虽然可以存储像 Word 文档这样的任意文件，但对用户作为源编辑的文本文档更有效，因为可以以面向行的方式对用户有意义地表示差异。

由于这个和[许多其他原因](http://www.catb.org/~esr/writings/taoup/html/ch05s01.html)，这些天我将所有文档都写在[reStructuredText](http://docutils.sourceforge.net/rst.html)源文件中，与其他源文件一起编辑并在版本控制中进行跟踪。HTML 和 PDF 版本在构建时与项目生成的其余文件一起呈现。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-02T22:30:54.473

是的。

但是，请注意，许多文档将存储为二进制文件。这将限制将它们存储在源代码管理中的实用性，从而更难看到细粒度的更改。

如果您有 LaTeX 文档或基于 XML 的文档，那么事情会更好。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-02T22:44:59.167

从理论上讲，您可以对任何东西进行源代码控制，我听说过设计师可以对他们的 Photoshop 文件进行源代码控制。如果你总是写清楚的提交信息，很容易回滚到以前的版本。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-02T22:30:22.993

MS Word 文档几乎被视为二进制文件，因此几乎不可能区分或合并 Word 文件的不同版本。

这并不意味着它不能或不应该置于版本控制之下，只是它对解决冲突没有多大帮助。

如果需要，您可能希望以纯文本格式（例如 .tex）存储文档

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-02-12T18:15:00.437

对技术文档使用源代码控制是一个好主意，但正如许多其他人所说，Word 并不是最好的文件格式。

Word 文件实际上是一个包含 XML 文件的文件夹（将 .docx 文件重命名为 filename.zip 并解压缩以查看该文件夹）。理论上，您可以为每个版本创建一个 zip 文件夹，将该文件夹存储在 Git 源代码管理中，然后查看版本差异。然而，这确实是不切实际的并且价值有限。

您还可以使用 Pandoc 将每个 .docx 文件版本转换为 Markdown 并将 Markdown 文件置于源代码控制之下。

Word 还具有内置的文件比较功能（审阅 > 比较）。这将标记任何两个 .docx 文件之间的差异。

我喜欢使用 Markdown 或 AsciiDoc 文本文件来编写技术文档以及使用 Git 进行版本控制。Git 相当容易学习，可以满足基本需求。这个系统让我可以完美地控制文档，并了解文档的历史，因为它会随着每个草稿、审阅者的评论等而随时间而变化。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-02T22:30:51.557

当然。我们在工作中这样做，确实有助于跟踪技术文档，这些文档有时会像源代码本身一样频繁地更改 :)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-02T22:31:34.583

是的你可以。您可以将文件上传到版本控制并为它们保留更改历史记录。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-03T04:49:53.520

正如其他人所说，您绝对可以将源代码控制用于您的技术文档。但是，我肯定会站在建议重组测试的海报一边。修订控制的重点是能够看到差异并在它们之间进行合并，在我的书中，您将需要使用文本文件来做到这一点。

除了 restructureText 之外的其他一些选项是[DocBook](http://www.docbook.org/)和[DITA](http://dita.xml.org/)。它们在技术出版界非常流行，并且都基于 XML，因此有一些不错的支持工具。对于 DocBook，您可以查看[XML Mind](http://www.xmlmind.com/xmleditor/)。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-03T19:18:36.770

事实上，MS 协作解决方案（即[Team System](http://msdn.microsoft.com/en-us/teamsystem/default.aspx)）正是使用 SharePoint 来实现这一点。我对 SharePoint 几乎一无所知，并且很容易使用它来保存一段时间的技术 word 文档版本。

如果你想直接在 word 中使用它，你可以试试 word add-in available [here](http://msdn.microsoft.com/en-us/magazine/cc163498.aspx)。

假设您使用 Visual Studio 作为团队系统服务的主要界面，请单击查看->团队资源管理器。如果您还没有，请设置您的存储库服务器并添加您的项目（其中大部分内容都有很好的在线[视频教程](http://msdn.microsoft.com/en-us/teamsystem/bb507749.aspx)）。

在您的项目树节点下，转到*Documents*，然后创建/添加您的文档。随意编辑、签入和签出（并让您的队友也这样做）。当您需要文档的版本历史记录时，请*从团队资源管理器窗口*中打开它。在将要启动的应用程序一词中，您应该（默认情况下）在右侧有一个“SharePoint”面板。（我在没有访问团队客户的情况下写这篇文章，但我很确定我没有犯任何不可恢复的错误..）。在其中，导航到*信息*选项卡，然后向下滚动到*“历史...”*（或者是*版本...*？明天的详细信息。）

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2019-03-18T15:13:20.853

我将我的简历作为 LibreOffice 文档保存在 Git 存储库中。它工作正常；版本控制不适用于二进制文件的想法是绝对错误的。

确实，二进制文件需要适当的差异和合并工具，但 Git 允许您指定这些工具。在我的情况下，我从来没有费心这样做，但是 LibreOffice/OpenOffice 文件的差异实用程序确实存在。

# java - 如何解决由 Java 泛型中的交集类型引起的模棱两可的方法？

> ID：815771
> 
> 赞同：9
> 
> 时间：2009-05-02T22:28:33.980
> 
> 标签：java, generics

我最近发现您可以在单个类型参数绑定中指定多种类型（参见示例）。像任何新工具一样，我一直在尝试探索如何使用（和滥用）它的可能性。我制作了这个例子来帮助说明。

在下面的示例中，编译器给了我一个错误

> *调度（新字母汤（））；*
> 
> **方法 dispatch(Demo.Soup) 对于 Demo 类型不明确**

我可以理解这一点，因为任一方法签名都匹配。我的问题是如何在不改变方法的情况下解决这个问题？如果我想强制调用 Soup 版本，我可以向下转换为 Soup：

> 调度（（汤）新字母汤（））

但我不确定你会如何强制调用另一个版本。可能吗？

```
public class Demo {

    interface HasA { public char getA(); }
    interface HasB { public char getB(); }
    interface HasC { public char getC(); }

    interface Soup { 
        public void eat();
    }

    class Alphabet implements HasA, HasB, HasC {
        public char getA() { return 'a'; }
        public char getB() { return 'b'; }
        public char getC() { return 'c'; }
    }

    class AlphabetSoup implements Soup,  HasA, HasB, HasC  { 
        public void eat() { System.out.println("Mmm Mmm Good!"); }
        public char getA() { return 'a'; }
        public char getB() { return 'b'; }
        public char getC() { return 'c'; }
    }

    public void dispatch(Soup soup) {
        System.out.println("Eating some soup...");
        soup.eat();
    }

    public <T extends HasA & HasB & HasC> void dispatch(T letters) {
        System.out.println("Reciting ABCs...");
        System.out.println(letters.getA());
        System.out.println(letters.getB());
        System.out.println(letters.getC());
    }

    public void test() {
        dispatch(new Alphabet());
        dispatch(new AlphabetSoup());
    }

    public static void main(String[] args) {
        new Demo().test();
    }
} 
```

-- 编辑：刚刚了解到“多个有界类型参数正式称为“交集类型”

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-02T23:48:46.020

请注意，该错误与泛型无关，如果您使用接口并且类型是交集，则会得到相同的结果：

```
public class AA {

    interface XX{};
    interface YY{};

    public void doSomething(XX x){}
    public void doSomething(YY x){}

    class XY implements XX,YY{

    }

    public void runner(){
        doSomething(new XY());
    }
} 
```

您在“doSomething”中遇到相同的错误，编译器无法解决歧义。你想解释为XX还是YY？您必须使用演员表指定它。但是如果你有一个层次结构，比如“YY扩展XX”和“XY实现YY”，编译器可以推断出正确的方法来调用。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-02T22:43:21.683

编译器是正确的，可以让你免于一团糟。

AlphaBetSoup 是汤的子类型，也是 HasA、HasB 和 HasC 的子类型

因此，它适合两个版本的 Dispatch

由于 Soup 不是 HasA、HasB 或 HasC 的子类型，因此也不能说一个版本比另一个版本更“具体”。

因此，您将正确地得到错误。

重载的方法不应该有歧义。如果您有一个混合了这两种类型的类型，并且每种类型都有一个重载，请更改您的层次结构或摆脱重载。子类型化和重载的错误使用。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-02-24T06:40:12.597

**让我用一个非常简单的程序来解释这一点：**

下面的代码说明了该方法对于类型编译器错误是模棱两可的。

```
public class AmbiguousMethodOwner {
            void ambiguousMethod(Comparable c){}
            void ambiguousMethod(Serializable c){}
            void test() {
                   ambiguousMethod("bar");
           }
     } 
```

现在的问题很明显：由于 String 同时实现了 Comparable 和 Serializable，编译器无法知道您打算调用哪个方法。

一个简单的演员将解决这个问题：

ambiguousMethod((Comparable)"bar");

[http://www.javaneverdie.com/java/the-method-is-ambiguous-for-the-type/](http://www.javaneverdie.com/java/the-method-is-ambiguous-for-the-type/)

在我们的案例中，方法调度正在产生问题。看

```
class AlphabetSoup implements Soup,  HasA, HasB, HasC 
```

和

```
public void dispatch(Soup soup)
 public <T extends HasA & HasB & HasC> void dispatch(T letters) { 
```

现在如果你调用`dispatch(new AlphabetSoup());`编译器会混淆应该调用哪个版本的调度？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-02T22:40:32.750

请注意，您没有真正的问题，因为由于动态绑定，您有兴趣调用的方法已经被调用。

运行`dispatch((Soup) new AlphabetSoup());`产量：

```
Reciting ABCs...
a
b
c
Eating some soup...
Mmm Mmm Good! 
```

因此，`AlphabetSoup`由于基本的多态行为，该方法已经被调用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-03T00:04:25.950

并不是说您应该保留重载`dispatch`方法（出于这个原因我赞成 Uri），但是您可以通过尝试强制调用泛型版本：

```
demo.<AlphabetSoup>dispatch(new AlphabetSoup()); 
```

或调用汤版本：

```
demo.dispatch((Soup) new AlphabetSoup()); 
```

但是，解决这个问题的更好方法是首先不使用重载`dispatch`方法。

```
void dispatchSoup(Soup soup);
<T extends HasA & HasB & HasC> void dispatchLetters(T letters); 
```

# objective-c - 如何使 NSSlider 的一部分在刻度线处停止？

> ID：815774
> 
> 赞同：2
> 
> 时间：2009-05-02T22:30:41.323
> 
> 标签：objective-c, cocoa

我想要一个不会捕捉到刻度点的 NSSlider，除了最后两个。这与系统偏好设置 -> 节能器 -> 计算机睡眠中的滑块的行为相同。关于如何做到这一点的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-03T03:25:08.153

我不知道一种简单的方法，但如果归根结底，您可以创建自己的 NSSliderCell 子类并覆盖这三个方法中的部分或全部：

```
- (BOOL)startTrackingAt:(NSPoint)startPoint inView:(NSView *)controlView;
- (BOOL)continueTracking:(NSPoint)lastPoint at:(NSPoint)currentPoint inView:(NSView *)controlView;
- (void)stopTracking:(NSPoint)lastPoint at:(NSPoint)stopPoint inView:(NSView *)controlView mouseIsUp:(BOOL)flag; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T22:37:55.463

我认为最好的方法是继承 NSSliderCell 并[覆盖](http://developer.apple.com/documentation/Cocoa/Reference/ApplicationKit/Classes/NSSliderCell_Class/Reference/Reference.html#//apple_ref/occ/instm/NSSliderCell)部分或全部刻度方法。

```
- (double)closestTickMarkValueToValue:(double)aValue 
```

我的猜测是该方法允许您选择停止的点，但如果这不起作用......

您可以使 NSSlider 连续。当用户移动滑块时，您的目标将收到您设置的操作。一旦它高于/低于阈值，您可以更改它是否仅在刻度线处停止。这可能是也可能不是您正在寻找的东西（因为它不能很好地与绑定等配合使用），但它可能是一种黑客攻击。

# sql-server - 为什么我在运行此查询时会收到 Timeout Expired 错误？

> ID：815781
> 
> 赞同：0
> 
> 时间：2009-05-02T22:32:09.107
> 
> 标签：sql-server, odbc

我正在使用 ODBC 在 SQL Server 2008 上运行此查询。如果我取出最后一部分（或 li.DATEGENERATED >= (...))），那么我不会收到错误消息......但我可以在 SSMS 中运行它就好了。

```
SELECT COUNT(*) FROM dbo.POITEMST li
 WHERE (? IS NULL OR li.DATEGENERATED >= ?)
   AND (? IS NULL OR (li.DATEGENERATED >= (
    SELECT MAX(t.DATEGENERATED) FROM dbo.POITEMST t WHERE t.PONUM = ?))) 
```

这是我设置参数的方式

```
DbParameter startDateParam = cmd.CreateParameter();
startDateParam.ParameterName = "StartDate";
startDateParam.Value = (StartDate.HasValue ? (object)StartDate.Value : (object)(new DateTime(1753, 2, 2)));
cmd.Parameters.Add(startDateParam);

startDateParam = cmd.CreateParameter();
startDateParam.ParameterName = "StartDate";
startDateParam.Value = (StartDate.HasValue ? (object)StartDate.Value : (object)(new DateTime(1753, 2, 2)));
cmd.Parameters.Add(startDateParam);

DbParameter startPoParam = cmd.CreateParameter();
startPoParam.ParameterName = "StartPO";
startPoParam.DbType = DbType.String;
startPoParam.Value = (string.IsNullOrEmpty(StartPurchaseOrder) ? (object)DBNull.Value : (object)StartPurchaseOrder);
cmd.Parameters.Add(startPoParam);

startPoParam = cmd.CreateParameter();
startPoParam.ParameterName = "StartPO";
startPoParam.DbType = DbType.String;
startPoParam.Value = (string.IsNullOrEmpty(StartPurchaseOrder) ? (object)DBNull.Value : (object)StartPurchaseOrder);
cmd.Parameters.Add(startPoParam); 
```

编辑：那些日期只是在那里，因为我试图弄清楚这一点......如果没有开始日期，它会在 DBNull 之前传递。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-19T12:35:20.847

分而治之。从带有硬编码值的 T-SQL 开始，包括 NULL 和非 null。从最简单的查询开始并构建，在每一步检查查询计划。你可能会发现你有索引问题等。解决这个问题然后返回代码。

如果没有更多模式信息（表布局、索引等）的查询，真的很难提供太多帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-09-07T12:00:21.090

请执行下列操作：

1.  重构查询
2.  把它变成一个存储过程
3.  在适当的列上创建索引

以我的经验，当遇到同一查询的 SSMS 和 ODBC 之间的性能差异时，索引会产生巨大的差异。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-02T23:25:18.773

在 ssms 中运行需要多长时间？如果您可以在启用执行计划的情况下运行查询（查询菜单、执行计划——而不是估计的）。如果存在索引问题，这应该在执行计划窗格中通知您。

您或您的 dba 可以运行 SQL 分析器吗？并捕获实际传递到 sql server 的内容，以确认它与您的期望相符。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-19T12:28:47.320

我认为您可以重构查询以提高性能：

```
SELECT COUNT(*) FROM dbo.POITEMST li
WHERE li.DATEGENERATED >= ISNULL(?,'1753-02-02')
AND li.DATEGENERATED >= ISNULL((SELECT MAX(t.DATEGENERATED) FROM dbo.POITEMST t WHERE t.PONUM = ?), '1753-02-02') 
```

将 null 与 OR 的比较结合起来似乎是问题的一部分。

希望这可以帮助，

账单

# c# - 有什么比逗号更独特的分隔符来分隔字符串？

> ID：815782
> 
> 赞同：31
> 
> 时间：2009-05-02T22:32:51.350
> 
> 标签：c#, csv

我有几个文本框，用户可以在其中输入信息。这可以包括逗号，所以我不能使用标准的逗号分隔字符串。

什么是一个好的分隔符来表示字符串应该根据用户在其作品中通常不使用的字符进行分隔？我将把这些字段组合成一个字符串并将它们传递给我的加密方法。在我解密它们之后，我需要能够可靠地分离它们。

如果重要，我正在使用 C#。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-05-02T22:34:01.863

| 将是我列表中的下一个，并且通常用作 CSV 的替代品。谷歌“管道分隔”，你会发现很多例子。

```
string[] items = new string[] {"Uno","Dos","Tres"};

string toEncrypt = String.Join("|", items);

items = toEncrypt.Split(new char[] {'|'}, StringSplitOptions.RemoveEmptyEntries);

foreach(string s in items)
  Console.WriteLine(s); 
```

由于每个人都喜欢批评编码而不是提供代码，这里有一种编码文本的方法，所以你的 | delim 不会碰撞。

```
string[] items = new string[] {"Uno","Dos","Tres"};

for (int i = 0; i < items.Length; i++)
    items[i] = Convert.ToBase64String(Encoding.UTF8.GetBytes(items[i]));

string toEncrypt = String.Join("|", items);

items = toEncrypt.Split(new char[] {'|'}, StringSplitOptions.RemoveEmptyEntries);

foreach (string s in items)
     Console.WriteLine(Encoding.UTF8.GetString(Convert.FromBase64String(s))); 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2009-05-02T23:15:02.950

我见过不常用的字符用作分隔符，甚至是不常用的字符组合，例如`-|::|-`，但即使它们不太可能出现，它们仍然可以。

如果要使其防水，基本上有两种选择：

1：使用无法输入的字符，例如 '\0' 字符：

加入：

```
string combined = string.Join("\0", inputArray); 
```

分裂：

```
string[] result = combined.Split('\0'); 
```

2：转义字符串并使用转义字符作为分隔符，如 url 编码值并使用 & 作为分隔符：

加入：

```
string combined = string.Join("&", inputArray.Select<string,string>(System.Web.HttpUtility.UrlEncode).ToArray()); 
```

分裂：

```
string[] result = combined.Split('&').Select<string,string>(System.Web.HttpUtility.UrlDecode).ToArray(); 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-05-03T00:03:00.557

自从我停止使用 C 以来，我认为我并没有心甘情愿地对字符串集合进行自定界。在“现代”语言中根本不需要它，而且 - 虽然微不足道 - 边缘情况的数量足以惹恼你至死。

将它们存储在 List<string> 或 string[] 中并序列化/反序列化它们。如果您想要人类可读性或互操作性，请使用 XML - 如果您不想要，请使用二进制序列化它们。无论哪种方式，您都可以轻松地加密输出，并且没有歧义或创建自己需要的转义例程。

在 C# 中，与此答案相比，它的 LOC 更少，编写时间也更少。没有借口推出自己的解决方案。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-05-02T22:41:17.303

最好的解决方案是坚持使用逗号并引入对字符转义的支持。您选择的任何字符最终都需要输入，因此您也可以为此提供支持。

想想双引号字符串中的反斜杠+双引号。

不要选择反引号之类的字符，因为有些用户可能不知道如何输入...

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-05-02T22:48:25.697

用户将在文本框中输入分隔字符串，还是将输入单独的字符串，然后您的代码将这些字符串构建为分隔字符串？

在第一种情况下，最好重新考虑您的 UI。例如，用户可以一次在文本框中输入一个字符串，然后在每个字符串之后单击“添加到列表”按钮。

在第二种情况下，使用什么分隔符并不重要。选择您喜欢的任何角色，只需确保您避开该角色的任何其他出现。

**编辑**

由于对其他答案的一些评论要求提供代码，因此这是一种创建逗号分隔字符串的方法，使用反斜杠作为转义字符：

```
public static string CreateDelimitedString(IEnumerable<string> items)
{
    StringBuilder sb = new StringBuilder();

    foreach (string item in items)
    {
        sb.Append(item.Replace("\\", "\\\\").Replace(",", "\\,"));
        sb.Append(",");
    }

    return (sb.Length > 0) ? sb.ToString(0, sb.Length - 1) : string.Empty;
} 
```

以下是将逗号分隔的字符串转换回单个字符串集合的方法：

```
public static IEnumerable<string> GetItemsFromDelimitedString(string s)
{
    bool escaped = false;
    StringBuilder sb = new StringBuilder();

    foreach (char c in s)
    {
        if ((c == '\\') && !escaped)
        {
            escaped = true;
        }
        else if ((c == ',') && !escaped)
        {
            yield return sb.ToString();
            sb.Remove(0, sb.Length);
        }
        else
        {
            sb.Append(c);
            escaped = false;
        }
    }

    yield return sb.ToString();
} 
```

这是一些示例用法：

```
string[] test =
    {
        "no commas or backslashes",
        "just one, comma",
        @"a comma, and a\ backslash",
        @"lots, of\ commas,\ and\, backslashes",
        @"even\\ more,, commas\\ and,, backslashes"
    };

    string delimited = CreateDelimitedString(test);
    Console.WriteLine(delimited);

    foreach (string item in GetItemsFromDelimitedString(delimited))
    {
        Console.WriteLine(item);
    } 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2019-10-10T09:01:40.613

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-05-02T22:47:18.647

任何非标准字符管道 |、反引号 `、波浪号 ~、bang ! 或分号；可能会工作。然而，如果你走这条路，你**真的是**在冒险远离可用性。要求他们用反斜杠或其他东西来逃避逗号是在乞求他们错过一个。

如果无法使用 CSV，那么您应该考虑更改您的 UI。（哎呀，对于用户输入，无论如何你都应该远离 CSV！）你说文本框，所以我假设你在 web 或某种赢表单或 WPF 中（绝对不是控制台）。所有这些都为您提供了比单个文本框更好的 UI 控制，并迫使用户遵循您困难的 UI 设计。

更多信息肯定有助于更好地指导答案。

但是，作为使用反斜杠转义逗号的示例。请注意，您不能在逗号前转义反斜杠。所以@"uno, dos, tr\\,es" 会以 {"uno", "dos", "tr\es"} 结尾。

```
string data = @"uno, dos, tr\,es";
string[] items = data.Split(','); // {"uno", " dos", @"tr\", "es"}
List<string> realitems = new List<string>();
for (int i=items.Length-1; i >= 0; i--)
{
    string item = items[i];
    if (item.Length == 0) { realitems.Insert(0, ""); continue; }

    if (realitems.Count == 0) { realitems.Insert(0, item); }
    else
    {
        if (item[item.Length - 1] == '\\') { realitems[0] = item + "," + realitems[0]; }
        else { realitems.Insert(0, item); }
    }
}

// Should end up with {"uno", " dos", "tr,es"} 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-05-02T22:48:10.080

我最终认为，每个角色都会被某人使用。用户总能找到破解我们的 HL7 解析器的方法。

而不是单个字符，也许尝试一个足够随机的字符串，以至于没有人会使用它。就像是 ”＃！@！＃”。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-02T23:38:49.430

如前所述，您选择的任何字符都有可能出现在输入中，因此您必须处理转义。XML 可能是一种很好的序列化格式，因为我相信 .NET 具有良好的 XML 创建和删除支持。这可能比尝试实现自己的字符转义要强大得多，并且将来也将更具可扩展性。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-05-02T23:45:24.373

没人说TAB？制表符分隔很棒，但在 GUI 中键入制表符并不容易（它往往会将您移动到下一个屏幕元素）。但是对于计算机生成的文件，TAB 是完美的，因为它真的不应该出现在用户生成的文本中。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-05-02T22:52:15.640

检测一个未使用的字符，然后使用它。您的最终组合字符串可以从用作分隔符的那个点开始。

例如：您的用户输入“裤子”“,;,;,;,;,;” 和“|~~|” 您遍历一组字符，直到找到一个未使用的字符。可能是，比如说，"$" 那么你的最终连接字符串是 "$pants$,;,;,;,;,;$|~~|" 初始字符告诉您的程序要使用哪个字符作为分隔符。这样，就没有禁止字符，句号。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-05-02T23:06:17.853

我从你所说的假设用户正在将数据输入到单独的字段中，然后你正在组合它。所以用户永远不需要知道或关心分隔符是什么。

不要只是尝试选择一个“没有人使用过”的字符，因为无论是出于偶然还是为了试图破坏您的代码，最终都会有一些用户使用它。

所以，我要么：

*   在用户输入中插入反斜杠以转义逗号和反斜杠，然后将字符串与逗号组合。要分开，您使用未转义的逗号（这是状态机的工作）进行拆分，然后对每个组件进行转义。

*   使用现成的方法来序列化字符串列表。可用的内容取决于您的环境，我不太了解 C#/.NET，无法提供建议。在 Java 中，您可以只序列化一个向量或其他任何东西。

*   使用控制字符（如 ASCII-BEL 或 ASCII-VT（或 ASCII-NUL，如果您的字符串从未被视为 nul 终止））分隔数据，并拒绝包含该字符的用户输入。

如果必须允许用户输入他们喜欢的任何字符值，则第一个选项很好。如果您不关心显着膨胀数据，则第二个选项很好。如果您不介意拒绝尝试插入有趣数据的 smart-alec 用户（或具有不寻常要求的用户），则第三个选项很好。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-05-02T23:52:02.597

你为什么不把每个输入都用引号括起来呢？

这样你最终得到这个：

```
"Aaron","Johnson","25","I like cats, and dogs" 
```

不要忘记在输入时转义引号......

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-05-03T00:16:53.363

Mark Brackett 有正确的答案。我只会补充一点，这个简单问题的答案数量非常多，应该让你永远不要使用分隔字符串。让这成为“智者的话”。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-05-02T22:35:23.763

反引号。没有人使用反引号。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-05-02T23:47:09.003

使用选项卡（或者可能是 \n） - 如果用户输入它会导致文本框退出。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-05-02T22:36:01.857

管道字符（|），也许？如果您的用户群对 IT 很敏感，那么这种方法（要求他们划定文本）可能不是最好的方法；您可以尝试其他方法，例如提供一些动态添加文本框的方法，该文本框接受另一个字符串等。

如果您提供有关您正在做什么以及为谁做的更多信息，那么有人可能会建议另一种方法。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-05-02T22:36:50.967

新队？（即使用多行文本框）

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2009-05-02T22:44:53.507

我建议使用“;”

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2009-05-02T22:46:19.227

如果可能，我更喜欢使用普通人不太可能输入的字符组合作为我的分隔符。例如，我使用了 ")^&^(" 并在我的代码中将其设置为 const "cDelimiter"；然后将我的所有字段与它连接起来。通过使用一个小的唯一字符串，我大大减少了可能的引擎盖用户不小心输入我的分隔符。用户输入 | 或 ~ 的可能性诚然不太可能，但这并不意味着它不会发生。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2009-05-03T00:16:06.623

我还支持选择 TAB (\t) 并在某种程度上支持 PIPE (|) 符号。

但在我的经验中，最常用的是分号 (;) 以及带引号的字段以及 \ 和 \" 的转义符，这非常完美。只需要一个解析器来保持状态。实际的分隔字符变得不重要。

如果您不使用转义，明智的做法是计算每行的“字段”并将它们与您的预期结果进行比较。由于此类文件的大多数应用程序都使用某种固定数量的字段，因此您可以在条目中捕获错误并获得如果它不触发，一切都很好。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2013-03-12T00:54:08.553

我知道这个回复已经很晚了，但我不久前就遇到了这个问题，并且很好地解决了这个问题（恕我直言）。希望将来，这将有助于其他人寻找类似问题的答案。

虽然我通常会将自己置于类似于 Mike Ottum、John Saunders 和 Mark Brackett 的阵营中，但简单的事实是，有时我们的开发人员必须做我们不愿意做的事情。我的特殊情况需要提供一个（主要是）人类可读的“id”，以在从对象的有机复合键派生的 RESTful URI 中使用。二进制或 XML 序列化并不是一个真正的选择。所以？我选择尽可能少地重新发明轮子。System.Text.RegularExpressions.Regex 类具有对那些疯狂的正则表达式模式进行操作的转义/取消转义方法。有一些可逃避的字符可供选择。我选择了管道（'|'）字符。

这是我的实现（分类为重用，但如果你喜欢滚动，你可以为 7 行“内联”解决方案开辟出好的部分）：

```
using System;
using System.Collections.Generic;
using System.Text.RegularExpressions;

namespace RPlus.DTO
{
    /// <summary>
    /// Provide safe string un/concatenating
    /// </summary>
    static class Glob
    {
        // a Regex Split param that basically says:
        // Split on the pipe char unless the preceeding char is a backslash
        private const string _splitterer = @"(?<!\\)\|";
        // no explanation needed (hopefully)
        private const char _delimiter = '|';

        /// <summary>
        /// Produce a properly escaped concatenation
        /// from some number of strings
        /// </summary>
        /// <param name="items">strings to escape/concate</param>
        /// <returns>an escaped concatenation of items</returns>
        public static string To(IEnumerable<string> items)
        {
            var escapedItems = new List<string>();
            foreach (var s in items) escapedItems.Add(Regex.Escape(s));
            return string.Join(_delimiter.ToString(), escapedItems);
        }

        /// <summary>
        /// Unconcatenate/unescape a string into its original strings
        /// </summary>
        /// <param name="globbedValue">
        /// A value returned from Glob.To()
        /// </param>
        /// <returns>
        /// The orignal strings used to construct the globbedValue
        /// </returns>
        public static List<string> From(string globbedValue)
        {
            return From(globbedValue, default(int?));
        }

        /// <summary>
        /// Unconcatenate/unescape a string into its original strings
        /// </summary>
        /// <param name="globbedValue">
        /// A value returned from Glob.To()
        /// </param>
        /// <param name="expectedTokens">
        /// The number of string tokens that 
        /// should be found in the concatenation
        /// </param>
        /// <returns>
        /// The orignal strings used to construct the globbedValue
        /// </returns>
        public static List<string> From(string value, int? expectedTokens)
        {
            var nugs = Regex.Split(value, _splitterer);
            if (expectedTokens.HasValue && nugs.Length != expectedTokens.Value)
                throw new ArgumentException("Unexpected number of tokens");
            var unescapedItems = new List<string>();
            foreach (var s in nugs) unescapedItems.Add(Regex.Unescape(s));
            return unescapedItems;
        }

    }
} 
```

这是一些示例用法：

```
var glob = Glob.To(new string[] { "Foo|Bar", "Bar|Baz", "Baz|Qux" });
var orig = Glob.From(glob); 
```

**警告：**请不要试图找到“用户永远不会输入的字符”作为连接字符串的分隔符。用户最终会输入它。那里已经有足够多的“神奇数字”代码等待爆炸。对于这个问题，有多种久经考验的解决方案。

* * *

## 回答 #23

> 赞同：-1
> 
> 时间：2019-08-05T22:25:39.537

为什么不使用 ASCII 代码 31（单位分隔符），它是专门为分隔字符串中的数据元素而保留的？

普通人不可能输入该字符，使用程序员工具的人很难意外输入它，因此您不必担心在极端情况下逃脱。

# iphone - 是否可以使用 Core Animation 淡出 UIBarButtonItem？

> ID：815784
> 
> 赞同：5
> 
> 时间：2009-05-02T22:34:42.297
> 
> 标签：iphone, objective-c, cocoa-touch, core-animation

我很好奇，是否有可能以某种方式交织核心动画以“淡出” UIBarButtonItem？我有一个 tableView，我用两个不同的数据源表示。一旦触发了特定的数据源，我想淡出当前的 UIToolBar 选项并淡入新的选项。

感谢您为我指明正确的方向。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-03T00:37:37.260

如果你真的在使用 UIToolbar（注意小写的“b”）而不是 UINavigationBar，有一种非常简单的方法可以更改按钮并让过渡自动淡出，而不会下降到核心动画。

如果您使用的是 Interface Builder，则需要在代码中引用工具栏。在 IB 中创建一个 IBOutlet 属性并将工具栏链接到它：

```
@property (nonatomic, retain) IBOutlet UIToolbar *toolbar; 
```

这将允许您将 UIToolbar 引用为 self.toolbar。然后，创建新按钮并将它们添加到 NSArray 并将其传递给 -[UIToolbar setItems:animated:] 方法，如下所示：

```
UIBarButtonItem *newItem = [[[UIBarButtonItem alloc] 
                                initWithBarButtonSystemItem:UIBarButtonSystemItemDone 
                                target:self 
                                action:@selector(handleTap:)] autorelease];
NSArray *newButtons = [NSArray arrayWithObjects:newItem, nil];
[self.toolbar setItems:newButtons animated:YES]; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-03T00:28:33.880

我不相信有一种方法可以控制 UIBarButtonItem 上的 alpha，但是 UIToolbar 类已经有一个方法来支持你正在尝试做的事情：-setItems:animated:。

# regex - 什么 Perl 正则表达式可以匹配 CamelCase 单词？

> ID：815787
> 
> 赞同：11
> 
> 时间：2009-05-02T22:35:40.080
> 
> 标签：regex, perl

我在 .todo 文件中搜索以下单词：

```
ZshTabCompletionBackward 
MacTerminalIterm 
```

我做了以下正则表达式

```
[A-Z]{1}[a-z]*[A-Z]{1}[a-z]* 
```

但是，这还不够，因为它只能找到以下类型的单词

```
ZshTab 
```

在伪代码中，我正在尝试制作以下正则表达式

```
([A-Z]{1}[a-z]*[A-Z]{1}[a-z]*){1-9} 
```

您如何在 Perl 中制作上述正则表达式？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-05-02T23:05:47.120

我想你想要这样的东西，用`/x`标志写来添加评论和无关紧要的空白：

```
/
   \b # 单词边界，所以你不会从单词中间开始

   ( # 打开分组
      [AZ] # 首字母大写
      [az]* # 任意数量的小写字母
   ) # 结束分组

   {2,} # 量词：至少 2 个实例，最大无界  

   \b # 单词边界
/X

```

如果你想要它没有花哨的格式，只需删除空格和注释：

```
/\b([AZ][az]*){2,}\b/

```

正如 j_random_hacker 指出的那样，这有点简单，因为它将匹配一个只是连续大写字母的单词。他的解决方案，我已经扩展`/x`以显示一些细节，确保至少有一个小写字母：

```
/
    \b # 从单词边界开始
    [AZ] # 以大写开头
    [a-zA-Z]* # 后跟任意 alpha

    (?: # 用于交替优先级的非捕获分组
       [az][a-zA-Z]*[AZ] # 下一位是低位，任意零或更多，以高位结束
          | ＃ 或者
       [AZ][a-zA-Z]*[az] # 下一位为高位，任意零或更多，以低位结束
    )

    [a-zA-Z]* # 剩下的任何东西
    \b # 以单词结尾
/X

```

如果你想要它没有花哨的格式，只需删除空格和注释：

```
/\b[AZ][a-zA-Z]*(?:[az][a-zA-Z]*[AZ]|[AZ][a-zA-Z]*[az])[a- zA-Z]*\b/

```

[我在Learning Perl](http://oreilly.com/catalog/9780596520106/)中解释了所有这些特性。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-03T01:21:29.167

假设您没有使用正则表达式进行提取，而只是匹配...

```
[A-Z][a-zA-Z]* 
```

唯一真正的要求不是全是字母并以大写字母开头吗？

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-03T08:36:55.703

[brian](https://stackoverflow.com/questions/815787/what-perl-regex-can-match-camelcase-words/815849#815849)和[sharth 的](https://stackoverflow.com/questions/815787/what-perl-regex-can-match-camelcase-words/816050#816050)回答**也会报告完全由大写字母组成的单词**（例如`FOO`）。这可能是也可能不是您想要的。如果您想限制为仅包含至少一个小写字母的驼峰式单词，请使用：

```
/\b[A-Z][a-zA-Z]*[a-z][a-zA-Z]*\b/ 
```

如果您还希望排除由单个大写字母后跟任意数量的小写字母（例如`Perl`）组成的单词，请使用：

```
/\b[A-Z][a-zA-Z]*(?:[a-z][a-zA-Z]*[A-Z]|[A-Z][a-zA-Z]*[a-z])[a-zA-Z]*\b/ 
```

（基本上，我们要求字符串以大写字母开头，并且至少包含一个额外的大写字母和一个小写字母；后两个可以按任意顺序出现。）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-15T20:29:48.040

使用这个：

```
/\b[A-Z]([a-z]+[A-Z]?)*\b/ 
```

# .net - 在 ASP.NET MVC 中，如何定义检查/应用我的自定义属性的顺序？

> ID：815795
> 
> 赞同：1
> 
> 时间：2009-05-02T22:39:17.980
> 
> 标签：.net, asp.net-mvc, attributes, action-filter

我目前正在研究使用从 ActionFilterAttribute 派生的自定义属性的可能性。我想用几个属性完成几件事。问题是我想确保其中一个属性首先发挥作用，而不是以任何随机顺序。

例子：

```
public class Feature1Attrubute : ActionFilterAttribute
{
    /* ... */
}

public class Feature2Attrubute : ActionFilterAttribute
{
    /* ... */
}

public class MyController : Controller
{
    [Feature1, Feature2]
    public ActionResult MyAction ()
    {
        /* ... */
    }
} 
```

属性是否按照它们在方法装饰中提到的顺序应用？

如果没有，有没有办法为一组 [自定义] 属性定义特定序列？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-02T22:48:16.010

基类`ActionFilterAttribute`有一个名为 的属性`Order`。这就是你要找的。

```
public class MyController : Controller
{
    [Feature1(Order = 1), Feature2(Order = 2)]
    public ActionResult MyAction ()
    {
        /* ... */
    }
} 
```

# wpf - 添加依赖属性来控制

> ID：815797
> 
> 赞同：8
> 
> 时间：2009-05-02T22:40:29.147
> 
> 标签：wpf, dependency-properties, infragistics

我正在使用 Infragistics XamDateTimeEditor 控件，我想向它添加一个依赖属性，以允许开发人员选择在控件获得焦点时选择所有文本。我创建了一种样式，用于设置我想要的行为，但我希望开发人员决定是否应该基于布尔依赖属性执行该行为。我不确定那是怎么做的。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-05-02T23:46:36.180

我假设您为此从 XamDateTimeEditor 继承。

如果您可以编写引用“标准”（clr）属性的代码，那么您就可以开始了：

1.  声明你的 DependencyProperty
2.  删除您的支持字段并替换标准属性的实现，以便它访问 DependencyProperty 而不是支持字段。

    ```
    public class MyXamDateTimeEditor : XamDateTimeEditor
    {
        public static readonly DependencyProperty IsSelectOnFocusEnabledProperty = 
          DependencyProperty.Register("IsSelectOnFocusEnabled", typeof(bool), 
        typeof(MyXamDateTimeEditor), new UIPropertyMetadata(false));

        public boolIsSelectOnFocusEnabled
        {
            get
            {
                return (bool)GetValue(IsSelectOnFocusEnabledProperty);
            }
            set
            {
                SetValue(IsSelectOnFocusEnabledProperty, value);
            }
        }
    } 
    ```

然后，当您在代码中访问 IsSelectOnFocusEnabled 时，它将返回依赖属性的当前值。

您也可以将其设置为在属性更改时接收通知，但我不明白您为什么会这样。

此技巧还有另一种选择，如果您愿意，它不使用继承和附加属性。

更新：

好的，因为它被要求，这里有一种方法可以为任何文本框实现它。它应该很容易转换为您用来在另一种类型的控件上执行该操作的任何事件。

```
 public class TextBoxBehaviors
    {
        public static bool GetIsSelectOnFocusEnabled(DependencyObject obj)
        {
            return (bool)obj.GetValue(IsSelectOnFocusEnabledProperty);
        }

        public static void SetIsSelectOnFocusEnabled(DependencyObject obj, bool value)
        {
            obj.SetValue(IsSelectOnFocusEnabledProperty, value);
        }

        public static readonly DependencyProperty IsSelectOnFocusEnabledProperty =
            DependencyProperty.RegisterAttached("IsSelectOnFocusEnabled", typeof(bool), 
            typeof(TextBoxBehaviors), 
            new UIPropertyMetadata(false, new PropertyChangedCallback(OnSelectOnFocusChange)));

        private static void OnSelectOnFocusChange(DependencyObject d, DependencyPropertyChangedEventArgs e)
        {
            if (d is TextBox)
            {
                var tb = d as TextBox;
                if ((bool)e.NewValue)
                {
                    tb.GotFocus += new RoutedEventHandler(tb_GotFocus);
                }
                else
                {
                    tb.GotFocus -= new RoutedEventHandler(tb_GotFocus);
                }
            }
        }

        static void tb_GotFocus(object sender, RoutedEventArgs e)
        {
            var tb = sender as TextBox;

            tb.SelectAll();
        }

    } 
```

你使用它的方式如下，例如：

```
<Window x:Class="WpfApplication2.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="clr-namespace:WpfApplication2"        
    Title="Window1" Height="300" Width="300">
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*" />
            <ColumnDefinition Width="Auto" />
        </Grid.ColumnDefinitions>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>
        <TextBox Text="No Select All" x:Name="TextBox1"/>
        <CheckBox Content="Auto Select"
                  Grid.Column="1"
                  IsChecked="{Binding Path=(local:TextBoxBehaviors.IsSelectOnFocusEnabled), ElementName=TextBox1, Mode=TwoWay}" />
        <TextBox Grid.Row="1" Text="djkhfskhfkdssdkj"
                 local:TextBoxBehaviors.IsSelectOnFocusEnabled="true" />
    </Grid>
</Window> 
```

这向您展示了如何设置属性以激活行为，以及如何在需要时将其绑定到其他东西。请注意，这个特定示例并不完美（如果您通过它工作，如果您在控件内部单击，则文本框具有实际上取消选择文本的内部逻辑，但这只是关于如何通过附加属性将行为附加到控件的示例） .

# c# - 从 Javascript 函数调用 AppSettings 中的全局变量

> ID：815800
> 
> 赞同：2
> 
> 时间：2009-05-02T22:41:22.360
> 
> 标签：c#, asp.net, javascript

在我的 javascript 函数中，我试图调用当前在我的 Asp.net 项目的 webconfig 文件中定义的全局变量。这个的语法是什么？我环顾四周，到目前为止似乎没有任何效果。我尝试了以下方法，但我没有从中得到任何东西：

网络配置：

```
<appSettings>
  <add key="var1" value="123456"/>
</appSettings> 
```

默认.aspx：

```
<script type="text/javascript">
  function doSomething() {"<%= System.Configuration.ConfigurationManager.AppSettings['var1'].ToString(); %>"
};
</script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-02T22:47:19.957

你期望从中得到什么？即使您设法获得了价值，代码也不会对它做任何事情。它只是声明一个字符串文字并将其丢弃......

您可以将值放入 Javascript 变量中，如下所示：

```
<script type="text/javascript">
var var1 = '<%=System.Configuration.ConfigurationManager.AppSettings["var1"].ToString();%>';
</script> 
```

现在您可以在 Javascript 代码中使用该变量。

# mapreduce - 映射器、减速器、过滤器

> ID：815806
> 
> 赞同：1
> 
> 时间：2009-05-02T22:44:51.557
> 
> 标签：mapreduce, filter, mappers, reducers

我知道 map/reduce 算法及其用途。它使用称为 Mappers 和 Reducers 的函数，但我也发现人们使用过滤器这个词。

过滤器与映射器相同还是有一些显着差异？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-02T22:48:03.483

过滤器就像一个映射，其传递的函数始终是“特征函数”，即对“这属于这里吗？”这个问题返回“是”或“否”的函数。

换句话说，考虑一个定义为 {x | x ∈ X 和*P(x)* }。过滤器采用基集，测试*P(x)*是否为真，并仅返回那些为真的成员。

所以 { *x* | *x*是自然数，odd( *x* ) } 是 {1,3,5,7...}。

*地图*应用任意函数，因此您可以将其视为像 { y | *x ∈ X*和*y = f(x)* }。

所以{ *y* | *x*是自然数，*y = x²* } 是 {1,4,9,16,...}。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-02T22:50:12.197

Filter 接受一个“列表”和一个函数，将该函数应用于列表的每个成员，并返回一个新列表，该列表仅包含函数应用返回 true 的成员。例如：

```
l = [1,2,3,4]
l = filter(lambda x: x < 3, l)
print l # [1,2] 
```

Map 做同样的事情，但返回一个包含函数应用结果的列表：

```
l = [1,2,3,4]
l = map(lambda x: x < 3, l)
print l # [True,True,False,False] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-02T22:50:22.760

过滤器确定是否应保留或删除项目。映射器只是将值转换为另一个值。结果：映射操作的输出集的大小始终与输入集相等。过滤器操作的输出小于输入集。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-02T23:21:16.507

通常，map 函数接受一个输入集和一个函数，并返回一个包含每个输入元素的函数输出的集合。过滤器接受一个输入集和一个布尔函数，并返回一个包含函数返回 true 的输入值的集合。

# javascript - 如何在 jQuery 中制作实时自定义事件

> ID：815809
> 
> 赞同：6
> 
> 时间：2009-05-02T22:45:14.080
> 
> 标签：javascript, jquery, event-handling, live

jQuery 有一个非常方便的名为 live() 的事件绑定器，它可以动态地将事件添加到 DOM 元素（即使是稍后将添加到 DOM 的元素）。问题是它只适用于特定事件（[在文档中列出](http://docs.jquery.com/Events/live)）。

我真的很想进行现场直播活动，以聚焦、模糊和改变现在直播不支持的活动。此外，如果我可以制作实时自定义事件，这将是我的应用程序的重大改变。我现在拥有的大部分代码都致力于将旧事件（更改、焦点和用于使项目可拖动或调整大小的自定义事件）重新绑定到通过 ajax 添加的新 dom 元素。

任何的想法？我想事件委托是要走的路，但我现在它会使代码更复杂。也许是一个处理事件委托的插件......不确定。帮我找到解决办法。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-02T22:51:43.567

如果它不在 jQuery 中，则很可能是有原因的。浏览器错误等使其不可靠。我会等到他们实现它或尝试使用已上线的原始插件[http://docs.jquery.com/Plugins/livequery](http://docs.jquery.com/Plugins/livequery)

编辑：

不错的反对意见。它不在 jQuery 中是有原因的，我非常怀疑这是因为它们*很懒*。我实际上已经花时间阅读源代码并寻找为什么只有某些事件在 live() 中实现，但我找不到原因。所以如果有人知道......请赐教。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2010-01-19T04:00:10.700

这个功能现在在 jQuery 1.4 中可用。`live()`现在支持所有 JavaScript 事件（包括自定义事件），并且`focusin`和`focusout`事件已作为 和 的冒泡版本`focus`引入`blur`。

来自[.live() 的 jQuery 1.4 文档](http://api.jquery.com/live/)：

> 从 jQuery 1.4 开始，.live() 方法支持自定义事件以及所有 JavaScript 事件。两个例外：因为 focus 和 blur 实际上并不是冒泡事件，所以我们需要使用 focusin 和 focusout 来代替。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-03T07:45:00.540

jQuery 的**`live()`**方法不起作用，因为焦点和模糊事件不像其他 DOM 事件那样传播（冒泡）。jQuery 团队最终会引入这个功能，但它必须是人工的（手动冒泡）。

如果我不使用 jQuery 并且仍然希望获得以下好处，**`live()`**我会在支持它的浏览器（大多数非 IE 浏览器）中使用事件捕获，而在 IE 中我会使用它们的**`onFocusIn`**/**`onFocusOut`**事件（这些事件与焦点/模糊不同，会冒泡）。

这是一个例子：

```
function onFocus(el, fn) {
    var outerFn = function(e) {
        e = e || window.event;
        if ((e.target || e.srcElement) === el) {
            fn.call(el);
        }
    };
    if (document.body.addEventListener) {
        // This is event capturing:
        document.body.addEventListener('focus', outerFn, true);
    } else {
        // This is event delegation:
        document.body.attachEvent('onfocusin', outerFn);
    }
    return outerFn;
} 
```

使用它：

```
onFocus(document.getElementById('myInputField'), function(){
    log('FOCUSED!!!');
}); 
```

类似的抽象可用于模糊和更改事件。

在此处阅读有关事件顺序（捕获/冒泡）的更多信息：**[http ://www.quirksmode.org/js/events_order.html](http://www.quirksmode.org/js/events_order.html)**

* * *

还可能值得注意的是，jQuery 插件 liveQuery 之所以有效，是因为它将事件重新绑定到新元素；它仅适用于 jQuery 的 DOM 操作方法，例如“append”、“insertBefore”等。因此，如果您要在不使用 jQuery 的情况下添加新元素，它将无法正常工作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-10-04T23:48:27.020

您可能想查看 Ariel Flesley 的 jQuery.Listen 插件。它类似于 live() 事件和 livequery() 插件，但它支持 focus() 和 blur() 事件。

[http://flesler.blogspot.com/2007/10/jquerylisten.html](http://flesler.blogspot.com/2007/10/jquerylisten.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-03T04:25:57.227

我已经成功地使用 livequery 插件作为 jQuery 中 .live() 函数的补充。它不仅可以绑定诸如焦点、模糊和更改之类的事件（从 1.3.2 开始，live() 还不支持），而且它还为您提供了一种将自定义事件动态绑定到 DOM 元素的机制。例如，我使用它将可拖动和可放置对象绑定到一些将通过 Ajax 添加的 DOM 元素。它使我的代码更易于阅读和维护。

# java - 关于java的实际问题

> ID：815825
> 
> 赞同：2
> 
> 时间：2009-05-02T22:50:36.660
> 
> 标签：java

我的老师最近在 Java 上进行了一次练习考试，我很想知道我在真假部分的表现如何。我对第一名最没有信心，所以那里的任何解释都会有很大帮助。

1.  在 Java 中，一个类可以扩展任意数量的抽象类。

    > 错误的。我不太明白为什么，仅仅是因为在继承类中父类可能会导致冲突吗？

2.  在 Java 中，传递类型为抽象类的参数是非法的。

    > 错误的，抽象类甚至没有构造函数......

3.  在 Java 中，一个抽象类可以有任意数量的子类。

    > 真的。我想不出任何可以限制这一点的东西。

4.  在 Java 中，一个类可以实现的接口数量没有限制。

    > 真的

5.  不可能将堆栈实现为双向链表，因为堆栈只需要访问列表的一端，而双向链表提供对列表两端的访问。

    > 真的。但这不会很有效。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-02T22:55:52.950

1）这是错误的，因为Java不支持多重继承。一个类只能扩展一个类，不管它是不是抽象的。它可以传递地扩展多个类（例如，它扩展了 B，它扩展了 C，因此间接地扩展了 C）。一个类可以实现多个接口。Java不支持多继承的原因有很多，但是它确实支持多接口，所以在很多方面都比较好。

2）首先，抽象类可以有构造函数。该声明是错误的，因为您可以将抽象类型作为参数传递。由于多态性，您将传递一个已经实例化的具体子类型。

3) 这是真的

4) 这在一定程度上是正确的（JVM 实现有一些限制，但在实践中你永远不会遇到它）

5）您可以轻松地将堆栈实现为双向链表，这是一个很好的练习。它甚至是高效的，因为你仍然在 O(1) 上做所有事情。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-02T22:57:23.677

1) 正确。Java（如 C#）拒绝实现的多重继承，我认为主要是出于复杂性的原因。

2）半正确：实际答案是正确的（错误；您当然*可以*声明抽象类的参数、变量等），但您的推理是错误的（我怀疑您的意思是“正确”，这完全是错误的）。抽象类可以具有由派生类调用的构造函数。除此之外，构造函数在某种程度上与参数的类型是否可以是抽象类无关。

3) 正确。

4) 正确。

5）好吧，你错了，因为这*是*可能的（而你声称这是*不可能*的）。*实现*可以访问列表两端的事实并不意味着它必须*公开*两端。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-02T22:56:02.463

1.  Java具有单继承；一个类可以从单个父类继承，无论是否抽象。当然，您可以拥有一个相互继承的多个类的链，例如`abstract A`--> `abstract B`-> `C`。
2.  错误，但构造函数问题与它无关。传递一个类型被限制为抽象类的参数保证了传入对象的接口，并且是多态性的基本原则。
3.  真的。抽象类倾向于定义接口的部分实现，因此只有一个实现通常是浪费时间。
4.  真的。
5.  假的，确定吗？您可以只推/弹出一端，忽略反向链接。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-02T23:03:53.023

1) 是错误的，因为在 Java 中“扩展”是一个特定的操作，它继承了所有数据结构和所有方法的实现。在 Java 中，一个类只能*扩展*一个超类。但是，在 Java 中，您可以*实现*任意数量的*接口*，这些接口只会“引入”您必须实现的函数的名称和签名。

这样做的原因是扩展的多个基类——称为“多重继承”——被认为是令人困惑的。这有点宗教战争的问题；C++ 进行多重继承，Java 和 Smalltalk 没有，而 Ruby 允许您混合模块以达到与多重继承大致相同的效果。

2）您可以将某些东西作为抽象类传递。例如，考虑一个抽象类 Shape，它具有具体的子类 Circle、Square 和 Triangle。它们都是“种类”的形状，因此您可以将 Shape 传递给任何应该适用于 hem all 的操作。

3）唯一的重构是你可以使一个类最终，这可以防止它需要子类化。将抽象类设为 final 是没有意义的；你永远无法使用它。

4) 是的，这就是您无需能够扩展多个类的方式；接口是您获得多重继承之类的方式。

5）当然*可以*将堆栈实现为双向链表。更重要的是，在某些情况下你会想要。例如，考虑一个您希望能够在不干扰它的情况下显示整个堆栈的东西。然后，使用非破坏性的“全部显示”操作扩展该堆栈可能会很有用。然后，在链表上实现的 Stack 中，您可以“遍历”整个列表，然后将其“遍历”回头部。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-02T22:54:45.977

1：这是错误的，因为**在 Java 中您根本无法扩展多个类。**

2：我认为你错了：**抽象类可以有构造函数！**

3：**没错，你是对的。**抽象类甚至不“知道”它是否有一个子类。

4：**没错，你是对的，**只有理论上的限制（计算机上没有什么是无限的）。

5：我认为你误解了这个问题：**如果你有一个 Double-Linked-List，你实际上可以把它拿来做一个 Stack**。在List中你可以得到第一个元素所以你可以采取这个方法来实现堆栈

# image - 我正在创建一个从真彩色图像生成调色板的程序，需要一些文件格式的帮助

> ID：815836
> 
> 赞同：1
> 
> 时间：2009-05-02T22:57:16.160
> 
> 标签：image, file-format

我正在创建一个从真彩色图像生成调色板的程序，我需要一些文件格式的帮助

它已经创建了一个 Photoshop cs3 调色板

我还没有找到有关如何制作 Paintshop pro 8 调色板或 gimp 调色板的任何信息

另外，我很乐意查找任何其他艺术程序调色板类型以提高与我的程序的兼容性

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-02T23:07:12.983

GIMP 调色板只是文本文件。假设您正在提取 RGB 值，您将生成一个如下所示的文本文件：

```
GIMP Palette
Name: custompalette
Columns: 4
#
  0   0   0     Index 3
 65  38  30     Index 4
103  62  49     Index 6
 79  73  72     Index 7
114 101  97     Index 8
208 127 100     Index 9 
151 144 142     Index 10
221 207 199     Index 11 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-02T22:59:50.583

对于 PSP 调色板：[.pal 文件扩展名](http://www.cryer.co.uk/filetypes/p/pal.htm)

根据[GIMP 的文档](http://docs.gimp.org/en/gimp-concepts-palettes.html)，`.gpl`文件格式为 ASCII，因此通过查看文件本身来创建转换器应该不难。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-02T23:05:16.530

Paint.NET 调色板很简单。这是一个 .txt，每行都是十六进制颜色 (AARRGGBB)。分号 (;) 是注释。例子：

```
;comment
FF000000
FFFFFFFF
00000000 
```

GIMP 使用扩展名为 .gpl 的 ASCII 明文格式。看看你最喜欢的记事本程序。

# php - 使用 sendmail.exe 的 php 邮件

> ID：815843
> 
> 赞同：0
> 
> 时间：2009-05-02T23:00:24.327
> 
> 标签：php, email, sendmail.exe

我`XAMPP`在 localhost windows `VISTA`m/c 上使用...使用 gmail 作为 smpt 服务器

我正在尝试使用简单的 PHP 脚本发送电子邮件

这是`sendmail.ini`（我`sendmail.exe`在该目录中有另外两个 dll）的配置详细信息

```
smtp_server=smtp.gmail.com
; smtp port (normally 25)

smtp_port=465

; the default domain for this server will be read from the registry
; this will be appended to email addresses when one isn't provided
; if you want to override the value in the registry, uncomment and modify

default_domain=localhost

; log smtp errors to error.log (defaults to same directory as sendmail.exe)
; uncomment to enable logging

error_logfile=error.log

; create debug log as debug.log (defaults to same directory as sendmail.exe)
; uncomment to enable debugging

debug_logfile=debug.log

; if your smtp server requires authentication, modify the following two lines

auth_username=xxxxxxx
auth_password=xxxxxx

hostname=localhost

and I have changed the php.ini

[mail function]
; For Win32 only.
;SMTP = localhost
;smtp_port = 25

; For Win32 only.
;sendmail_from = xxxxx

; For Unix only.  You may supply arguments as well (default: "sendmail -t -i").
sendmail_path = "C:\xampp\sendmail\sendmail.exe -t" 
```

一旦我调用脚本，它就会进入等待...等待本地主机...这里是 debug.log...

> 09/05/02 17:34:41 ** --- 消息开始 --- 09/05/02 17:34:41 ** 至：xxx@yahoo.com 09/05/02 17:34:41 * * 主题：表单提交结果 09/05/02 17:34:41 ** 来自：我的网站 09/05/02 17:34:41 ** 回复：xxx@gmail.com 09/05/02 17 :34:41 ** 09/05/02 17:34:41 ** 姓名：xxx 09/05/02 17:34:41 ** 电子邮件：xxx@yahoo.com 09/05/02 17:34 :41 ** 消息：嘿测试消息 09/05/02 17:34:41 ** 09/05/02 17:34:41 ** 09/05/02 17:34:41 ** --- 消息结束--- 09/05/02 17:34:41 ** 连接到 smtp.gmail.com:465 09/05/02 17:34:41 ** 已连接。

我是新手`PHP`，想知道是否有更好的方式来处理邮件...我现在不接受带有附件的 HTML/多部分邮件...此外，我应该能够在没有`SMTP`安装服务器的情况下在 localhost 中进行测试。我想`GMAIL`用于现在的测试。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-02T23:37:16.390

我强烈建议您使用一个库，例如[PHPMailer](http://phpmailer.codeworxtech.com/index.php)。这是他们的[gmail 示例](http://phpmailer.codeworxtech.com/index.php?pg=examplebgmail)。

另一个好的库（我没用过）是[SwiftMailer](http://swiftmailer.org/)。这是他们的[gmail 示例](http://swiftmailer.org/wikidocs/v3/connections/smtp)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-02T23:06:43.093

GMAIL 需要 SSL afaik。

[我知道Zend_Mail](http://framework.zend.com/manual/en/zend.mail.html)和[Swiftmailer](http://swiftmailer.org/)免费（可能是“好”）的 php 邮件库。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-02T23:24:34.940

您还应该咨询您的 ISP。他们中的许多人阻止端口 25 以防止垃圾邮件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-04-07T14:23:24.087

## **发送电子邮件 - GMAIL**

1) 停止服务器。

2）更改此行

**[XAMPP -> PHP -> php.ini]**

```
sendmail_path = "\"C:\xampp\sendmail\sendmail.exe\" -t" 
```

**[XAMPP -> SENDEMAIL ->sendmail.ini]**

```
smtp_port=587 
auth_username= xxxx@gmail.com 
auth_password= xxxx 
smtp_ssl=auto 
```

3) 运行服务器

4) 发送邮件测试

```
<?php $to      = 'youremail@xxxx.com'; $subject = 'Test Email
 Email'; $message = 'Hello'; $headers = 'From:
 test@test.com' . "\r\n" .
     'Reply-To: test@test.com' . "\r\n" .
     'X-Mailer: PHP/' . phpversion();

 echo print_r(mail($to, $subject, $message, $headers),true); ?> 
```

# asp.net-mvc - 如何在 ASP.NET MVC 控制器中将路由转换为 URL？

> ID：815845
> 
> 赞同：2
> 
> 时间：2009-05-02T23:03:41.807
> 
> 标签：asp.net-mvc, routes

在视图中，这样的代码将生成正确的 URL，以根据 global.asax.cs 文件中的路由 跳转到*控制器*的*操作方法。*

```
<%= Html.ActionLink("text", "action", "controller") %> 
```

我的问题是如何在视图（例如控制器）之外实现类似的路由到 URL 映射？控制器类上没有可调用 ActionLink 的 Html 成员。

一些控制器操作需要重定向浏览器，我想重定向到控制器和操作**而不**将 URL 硬连接到控制器中，如果我更改路由将这些 URL 映射到控制器和操作的方式会中断

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-02T23:06:17.713

在控制器上使用[RedirectToAction](http://msdn.microsoft.com/en-us/library/system.web.mvc.controller.redirecttoaction.aspx)方法：

```
return RedirectToAction( "action", "controller", new { id = redirectID } ) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-02T23:06:19.100

您正在寻找的是`RedirectToAction`.

如果您只需要 url，请使用`Url`控制器的属性 - 它是[UrlHelper](http://msdn.microsoft.com/en-us/library/system.web.mvc.urlhelper.aspx)。

# c# - NHibernate 可以自动从现有类创建表吗？

> ID：815854
> 
> 赞同：22
> 
> 时间：2009-05-02T23:07:05.200
> 
> 标签：c#, nhibernate

我对此很陌生，但我需要从现有类创建新表，而不是手动创建它们。这可以使用工具或命令行来完成吗？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-05-02T23:16:50.807

是的，使用 nhibernate，您可以自动生成和更新模式。

```
var cfg = new Configuration();  
cfg.Configure();  
cfg.AddAssembly(typeof (aClassFromYourProject).Assembly);  
new SchemaExport(cfg).Execute(false, true, false, false); 
```

更新： SchemaExport.Execute 的重载选项在 3.x 版本中已更改。不再需要最后一个参数。

```
new SchemaExport(cfg).Execute(true, true, false); 
```

# jquery - jQuery 点击函数 vs 内联 onclick

> ID：815856
> 
> 赞同：10
> 
> 时间：2009-05-02T23:07:33.093
> 
> 标签：jquery, onclick

我正在尝试重新组织我的代码并使其更加不引人注目。

主要是有一个执行动作的链接。如果单击链接，则通过 ajax 执行操作（此处代码中没有 ajax 代码），并且文本被其他文本替换，为用户提供撤消操作的能力。如果用户单击 Undo 链接，ajax 将恢复以前的情况，并且为用户提供的文本执行再次显示的操作。

我在一个 html 文件（下面的代码）中制作了我的问题的更简单版本。有两段。如果您单击使用内联 onclick 调用的第一段的链接，则代码将按预期工作。但是如果你点击第二段的链接，它使用了 jQuery onclick 功能，Undo 链接不起作用，我不知道为什么。

有什么帮助吗？非常感谢！

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8" />
    <title></title>
    <script src="http://code.jquery.com/jquery-latest.js"></script>
    <script>
        $(function() {      
            $(".add2").click(function(){
                var placeId = $(this).parents(".place").attr("id");
                $("#" + placeId + " .add2").remove();
                $("#" + placeId + " .actions").append("<span class=\"added\">Added!</span> <a class=\"undoadd2\" href=\"#\">Undo</a>");
                return false;
            })
            $(".undoadd2").click(function(){
                var placeId = $(this).parents(".place").attr("id");
                $("#" + placeId + " .actions").find("span.added, a.add2").remove();
                $("#" + placeId + " .actions").append("<a class='add2' onclick='copyPlace(\"" + placeId + "\"); return false;' href='#'>Add place</a>");
                return false;
            })
        });

        function addPlace(placeId){
            $("#" + placeId + " .add").remove();
            $("#" + placeId + " .actions").append("<span class=\"added\">Added!</span> <a class=\"undoadd\" href=\"#\" onclick=\"undoAddPlace('" + placeId + "'); return false;\">Undo</a>");
            return false;
        }

        function undoAddPlace(placeId){
            $("#" + placeId + " .actions").find("span.added, a.undoadd").remove();
            $("#" + placeId + " .actions").append("<a class='add' onclick='addPlace(\"" + placeId + "\"); return false;' href='#'>Add place</a>");
            return false;
        }
    </script>

</head>
<body id="home">
    <div class="place" id="3435910">
        <p class="actions"><a href="#" onclick="addPlace('3435910'); return false;" class="add">Add place</a></p>
    </div>

    <div class="place" id="3435912">
        <p class="actions"><a href="#" class="add2">Add place</a></p>
    </div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-02T23:12:16.560

> 由于您正在向 DOM 动态添加新项目，因此您必须在新项目上再次注册点击处理程序。

你可以用[`.live`](http://docs.jquery.com/Events/live)这个。

* * *

**更新**

从 jQuery 1.7 开始，该[`.on`](http://api.jquery.com/on/)方法是执行此操作的首选方法。

自 jQuery 1.9 以来，该[`.live`](http://jquery.com/upgrade-guide/1.9/#live-removed)方法已被删除。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-03T11:02:51.110

只是演示使用 .end() 以获得更流畅的解决方案：

```
$(function() {          
    $(".add2").click(function(){
            return $(this).parents(".place")
                .find(".add2")
                    .hide()
                .end()
                .find(".actions")
                    .append("<span class=\"added\">Added!</span> <a class=\"undoadd2\" href=\"#\">Undo</a>");
    });
    $('.undoadd2').live('click', function(){ 
            return $(this).parents(".place")
                .find(".actions")
                    .find("span.added, a.undoadd2")
                        .remove()
                    .end()
                .end()
                .find(".add2")
                    .show();
    });
}); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-02T23:34:32.513

哇！！感谢大家！

我已经阅读了现场活动，最终的工作代码是：

```
$(function() {      
            $(".add2").click(function(){
                var placeId = $(this).parents(".place").attr("id");
                $("#" + placeId + " .add2").hide();
                $("#" + placeId + " .actions").append("<span class=\"added\">Added!</span> <a class=\"undoadd2\" href=\"#\">Undo</a>");
                return false;
            })
            $('.undoadd2').live('click', function(){ 
                var placeId = $(this).parents(".place").attr("id");
                $("#" + placeId + " .actions").find("span.added, a.undoadd2").remove();
                $("#" + placeId + " .add2").show();
                return false;
            }); 
```

以前我使用 remove() 删除提供执行操作的文本。我已将其更改为隐藏/显示，因此我不必在第一个功能中也使用 live。

再次感谢！

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-02T23:11:14.550

由于您正在向 DOM 动态添加新项目，因此您必须`click`在新项目上再次注册处理程序。jQuery 在您调用`$('...').click(...)`.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-02T23:22:39.780

当您将元素附加到 DOM 时，不会拾取单击处理程序。尝试使用 jQuery 通过更改如下所示的行来注册单击处理程序：

```
$("#" + placeId + " .actions").append("<span class=\"added\">Added!</span> <a class=\"undoadd\" href=\"#\" onclick=\"undoAddPlace('" + placeId + "'); return false;\">Undo</a>") 
```

至

```
$("#" + placeId + " .actions").append("<span class=\"added\">Added!</span> <a class=\"undoadd\" href=\"#\" >Undo</a>");
$('#' + placeId + " .actions").find("span:last").find("a").click( function() {
    undoAddPlace( placeId );
    return false;
}); 
```

你也许可以更简单地做到这一点，但看起来你可以在段落中添加多个跨度，所以我保守了。您也可以链接附加，但我认为重新选择使这一点更清楚。

# ruby - 右箭头在此代码中的作用：“Ramaze.start :port => 80”

> ID：815866
> 
> 赞同：1
> 
> 时间：2009-05-02T23:16:35.037
> 
> 标签：ruby, syntax

```
Ramaze.start :port => 80 
```

如果我的理解是正确的，上面这行是 Ruby 中的一个方法调用，你也可以这样写：

```
Ramaze.start(:port => 80) 
```

但是在这两种情况下，将 => 字符放在符号 :port 和数字 80 之间意味着什么？

这是一种创建哈希的方式吗？

当 Ramaze.start 方法接收到方法参数时，参数的类型是什么？

它是作为单个参数键值对接收的吗？

或者它作为两个参数接收：:port 和 80？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-02T23:19:59.910

它创建一个哈希图，其中符号 :port 是键，值为 80。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-03T00:23:21.333

当你有一个方法，其中最后一个参数是一个哈希，大括号是可选的。

例子：

```
def foo options
  # ...
end 
```

那么这是允许的：

```
foo :bar => :baz 
```

但如果你有：

```
def foo options, say_hi
  # ...
  if say_hi
    puts 'Hi!'
  end
end 
```

那么你不能这样做：

```
foo :bar => :baz, true 
```

但是你必须这样称呼它：

```
foo({:bar => :baz}, true) 
```

不过，我无法弄清楚为什么在那种情况下需要括号，但它们似乎是。

* * *

## 回答 #3

> 赞同：-7
> 
> 时间：2009-05-02T23:40:46.833

它被称为 lambda。这是声明方法的一种简短方式。例如，我可以说 myBirthday => myBirthday.Where(some value)。请注意您如何将对象本身传递到缩短的函数中。在你的情况下，你传入一个端口，给它一个 80 的值，然后返回端口对象。

# iphone - 问题：我的设置标题可以与我的可执行文件/应用程序的标题不同吗？

> ID：815870
> 
> 赞同：0
> 
> 时间：2009-05-02T23:18:57.107
> 
> 标签：iphone, settings

我正在开发一个具有设置窗格的应用程序，遵循 Apple 的 AppPrefs 示例。如果我的应用程序名为 AppPrefs，这就是设置应用程序将提供的确切名称/提示/标题。无论如何要进行此更改吗？我的可执行文件可以以某种方式命名（例如）Application1 并且我的设置命名为“App1 的设置”吗？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-08-17T17:30:51.447

不幸的是，不，由于设置系统工作的原因。来自 Apple 的[iPhone 应用程序编程指南](http://developer.apple.com/iphone/library/documentation/iPhone/Conceptual/iPhoneOSProgrammingGuide/iPhoneAppProgrammingGuide.pdf)：

> 当设置应用程序启动时，它会检查每个自定义应用程序是否存在设置包。对于它找到的每个自定义包，它会加载该包并在“设置”主页中显示相应应用程序的名称和图标。当用户点击属于您的应用程序的行时，设置会为您的设置包加载 Root.plist 设置页面文件，并使用该文件显示您的应用程序的首选项主页。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-11-13T20:15:47.040

显然，它曾经可以通过在 Root.plist 中添加一个带有字符串的“Title”键来表示首选项的名称（例如在 Mark and LaMarche '09, p311 中）。但这似乎不再起作用。我认为这是一个问题，因为 Bundle 显示名称有时是您的应用程序的缩短版本，以适应弹簧板中的图标。

# multithreading - 分布式计算与线程

> ID：815883
> 
> 赞同：6
> 
> 时间：2009-05-02T23:25:32.410
> 
> 标签：multithreading, language-agnostic, networking, theory

分布式计算和线程有多相似？我发现有两篇论文得出了完全相反的结论：

“多线程比网络更容易。线程如何简单且类似于网络代码”

[http://software.intel.com/file/14723](http://software.intel.com/file/14723)

（这给我的印象是它们是如此相似，以至于封装后这两种方法可以用相同的代码完成——但也许我错了）

《关于分布式计算的说明》

[http://research.sun.com/techrep/1994/abstract-29.html](http://research.sun.com/techrep/1994/abstract-29.html)

（这有很大的区别）

我敢肯定，真相介于两者之间。什么是金句？是否有任何技术可以统一这两种范式？还是因为网络和并发之间的根本差异，这种尝试失败了？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-02T23:40:14.073

我从来没有发现它们非常相似。为了这篇文章的目的，让我将“节点”定义为在一台机器上运行的一个硬件线程。所以四核机器是四个节点，一个由四个单处理器盒组成的集群也是如此。

每个节点通常会运行一些处理，并且需要某种类型的跨节点通信。通常这种通信的第一个实例是告诉节点要做什么。对于这种通信，我可以使用共享内存、信号量、共享文件、命名管道、套接字、远程过程调用、分布式 COM 等。但是最容易使用的共享内存和信号量通常不能通过网络使用。共享文件可能可用，但性能通常很差。套接字往往是网络上最常见和最灵活的选择，而不是更复杂的机制。此时，您必须处理网络架构的细节，包括延迟、带宽、丢包、网络拓扑等。

如果从工作队列开始，同一台机器上的节点可以使用简单的共享内存来完成任务。你甚至可以把它写成无锁的，它会无缝地工作。对于网络上的节点，您将队列放在哪里？如果你集中它，那台机器可能会遭受非常高的带宽成本。尝试分发它，事情很快就会变得非常复杂。

我发现，一般来说，处理这种并行架构的人倾向于选择令人尴尬的并行问题来解决。想到了光线追踪。除了作业分配之外，不需要太多的跨节点通信。可以肯定的是，有很多这样的问题，但我觉得建议分布式计算本质上与线程相同有点不诚实。

现在，如果您要编写行为与分布式系统相同的线程，使用纯消息传递并且不假设任何线程是“主”线程等，那么是的，它们将非常相似。但是你所做的是假装你有一个分布式架构并在线程中实现它。问题是线程是一个比真正的分布式计算更简单的并行案例。您可以将两者抽象为一个问题，但要选择更难的版本并严格遵守它。当所有节点都位于机器本地时，结果将不会那么好。您没有利用特殊情况。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-02T23:30:26.610

分布式计算是在多个不同的独立机器上完成的，通常有时使用专门的操作系统。这更难，因为机器的互连性要低得多，因此需要对整个数据集进行大量快速、随机访问的问题很难解决。

一般来说，您需要专门的库来解决分布式计算问题，这些问题弄清楚如何将节点分配给问题并围绕数据进行推车。

我真的很想知道他们是否会得出不同的结论，因为他们试图解决每个平台上的错误问题。有些问题非常适合高度互连的机器，并且可以从真正强大的超级计算机中受益。其他问题可以在简单的分布式模型上处理。一般来说，超级计算机可以解决更广泛的问题，但专业性和成本要高得多。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-02T23:35:34.897

区别似乎回到线程共享状态，进程传递消息。

在选择一个之前，您需要决定如何在应用中维护状态。

共享状态很容易上手，所有的数据和变量都在那里。但是一旦进入死锁/竞争条件，就很难修改/扩展。

消息传递（例如Erlang）需要不同的设计方法，你必须从一开始就考虑并发的机会，但是每个分布式进程的状态都是隔离的，使得锁定/竞争问题更容易处理。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-02T23:36:12.023

我认为将进程与分布式计算方法进行比较比将线程与之进行比较要有用得多。线程存在于单个进程中，并且共享相同的数据和相同的内存。这在多台机器上是不可能的。另一方面，进程有自己的内存，尽管在某些情况下它包含与另一个进程完全相同的数据（例如，在 fork() 之后）。这可以通过网络实现。

给这个类比增加额外分量的是，许多用于进程间通信的工具是网络透明的。一个很好的例子是 unix 套接字，它使用与网络套接字相同的接口（连接代码除外）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-02T23:56:23.117

是的，在开发时，方法非常相似，但每种方法的使用都非常不同。我不太清楚您的想法，如果我错了，请告诉我：在谈论分布式计算时，我们假设在同一个应用程序中有不止一台计算机或服务器处理代码，但是当我们谈论多线程时，我们正在谈论在同一台计算机上同时处理应用程序的不同线程。您可以将其视为分布式计算的一个示例，在一个应用程序中访问位于 Internet 中的 Web 服务。有两台不同的计算机在同一个应用程序中工作。

如果你想要一个多线程的例子，想想一个试图找到一个大素数的应用程序。如果您在其中不使用多线程，则在计算下一个素数（可能是生命周期或更长时间）时，您将无法在应用程序中看到或执行任何其他操作，因为应用程序没有响应while 正在计算中。

您也可以混合使用它们：作为一个更复杂的示例，您始终可以使用多线程通过同一应用程序同时访问不同的 Web 服务，这是为了使您的应用程序即使在其中之一没有连接时也能响应服务器。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-03T00:07:43.230

我认为这两个文件不能轻易比较。英特尔的文档是对线程的一种介绍，他们试图通过寻找网络计算的类比来解释它，这对我来说有点奇怪和误导。我不确定他们为什么选择这样一种呈现线程的方式，也许他们针对的是熟悉网络的人，这可能比线程更知名或至少被认可。

另一方面，Sun 的文档是一篇严肃的文章，描述了与分布式编程相关的所有困难。我所能做的就是简单地确认他们在其中所说的话。

在我看来，试图隐藏对象是远程的事实的抽象是有害的，因为它通常会导致非常糟糕的性能。程序员必须意识到对象的远程性才能以有效的方式调用它。

# iphone - 问题：将设置分组在一起

> ID：815892
> 
> 赞同：1
> 
> 时间：2009-05-02T23:31:34.423
> 
> 标签：iphone, settings

根据 Apple 的 AppPrefs 示例，我正在开发许多具有设置窗格的应用程序。

在设置应用程序中，我的设置与其他应用程序出现在同一个“组”中。

任何人都知道执行以下操作之一的方法：

1.  将我的所有应用程序设置（例如 App1 和 App2）分组在一个提示下（例如“Rubale >”然后使用“App1 >”和“App2 >”打开一个新选项卡 - 例如“常规 >”导致“键盘 >”和“国际>”）
2.  将所有 myapplication 设置分组（例如 Settings 将 Apple 应用程序与我今天的应用程序分开分组）。

我知道这是可行的，因为在我的 iPhone 上，我看到“CyDelete 和锁定日历”单独分组，“iKeyEx”单独分组，“Skype”和我自己的应用程序在另一个组中......

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T09:33:57.593

不，没有官方的方法。您会注意到，唯一能够做到这一点的非 Apple 应用程序仅适用于越狱手机。

# c# - 返回 IList 与 C# 中的数组？

> ID：815895
> 
> 赞同：14
> 
> 时间：2009-05-02T23:32:51.220
> 
> 标签：c#, .net, arrays, list, mutability

我最近问某人为什么他更喜欢返回强类型数组而不是 IList。我一直认为，面对一个生命周期很长的项目时，针对接口编程是最灵活、最好的编程方式。所以当他回答时，我感到很奇怪：

> 我们通常更喜欢不可变类型而不是可变类型。数组是不可变的。IList 不是。

我不完全确定我理解这个说法。任何人都可以帮助澄清这一点吗？

感谢你们提供的任何帮助。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-02T23:47:02.233

无论“他”是谁，在这个话题上都是 100% 错误的。数组是一个非常可变的。这实际上是不返回数组的原因之一。没有办法阻止调用者将数组的元素更改为他们喜欢的任何内容。

数组不可变的唯一方法是它的长度。一旦分配了一个数组，它的长度就不能改变。即使是 Array.Resize 等 API 实际上也不会调整数组的大小，它们只是分配一个新数组，复制内容并返回新数组（在本例中通过引用）。

但是，我确实同意在许多情况下最好返回不可变数据。第一个是它允许您返回对类的内部集合的引用，而无需进行完整的复制，同时防止调用者弄乱您的内部状态。大多数可变集合不能做出这样的保证。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-05-03T11:33:19.803

我想他可能认为因为数组的长度属性是不可变的，那么数组在某种程度上比 IList*更*不可变，或者他使用了错误的词并将具体与不可变互换。谁知道，但这是一个奇怪的答案。

我认为返回 List 有一些暗示可以修改它，或者在返回数组时它可能会改变并不意味着那么多。

例如，如果您在存储库顶部有一个对象模型，并且有一个像 GetCars() 这样返回 List 的方法，而初级程序员看到了 cars.Add(Car c) ... 你会认为他的想法完全是疯狂的吗？ cars.Add(new Car()) 可能实际上将汽车添加到存储库中？数组本质上更明确。

我认为 List 的使用在属性中更合适，比如 Page.Controls.Add

出于几个原因，我更喜欢返回数组而不是 List。

*   习惯。1.0/1.1 中的集合 SUCKED

*   我更喜欢我的方法返回尽可能简单和最轻量级的对象。如果我需要将 Array 设为 List，这很简单。

*   它们可以在 .net 1.1 中使用，如果我需要支持旧版本的运行时，它可以减少重构的表面，我可以至少重用我的一些代码或应用相同的对象模型。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-05-03T11:39:09.727

我总是更喜欢[ReadOnlyCollection](http://msdn.microsoft.com/en-us/library/ms132474.aspx)。列表的所有优点，但只读。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-05-02T23:44:37.217

他可能的意思是 IList 包含 Insert、Remove 和 Add 方法，因此可以修改集合本身。另一方面，T[] 不能添加元素。

我应该补充一点，FxCop 建议改为返回 ReadOnlyCollection。索引器是只读的，因此不能更改元素，并且 Add 和其他此类方法都抛出 NotSupportedException。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-05-03T00:21:05.210

原则上他是对的，但他不知道如何正确练习......

> 我们通常更喜欢不可变类型而不是可变类型。

那是对的。不可变类型更易于使用

> 数组是不可变的。IList 不是。

这是不正确的。这些都不是一成不变的。

如果要返回不可变的集合，请返回 an`IEnumerable<T>`或 a `ReadOnlyCollection<T>`（使用`List<T>.AsReadOnly`方法）。如果它们本身不是不可变的，它们仍然不能保护对象。尽管您只能从集合中读取数据，但如果它们允许，您仍然可以更改每个对象中的数据。

此外，您应该考虑您要返回的集合的“所有权”。如果您创建数组的唯一目的是返回它，那么没有理由不完全控制它。另一方面，如果您要返回一个作为该类成员的集合，则您应该只允许尽可能少地访问它。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-02T23:38:51.643

我也不明白。数组是非常可变的，除了它们的大小。仍然可以修改单个元素。也许他的意思是数组是值类型而列表是引用类型。我不知道。

无论如何，您可能应该看看[Eric Lippert](http://blogs.msdn.com/ericlippert/archive/2008/09/22/arrays-considered-somewhat-harmful.aspx)对这个主题的看法。也可以为您提供一些弹药供讨论。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-02T23:36:26.360

也许这个人不知道他在说什么？

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-03T02:45:42.677

使用接口作为返回类型而不是实际类型本身的原因是对调用者隐藏内部实现。这允许实现更改实际类型，而不会重复应用程序的其余部分。

将内部使用的集合复制到数组中以供外部使用是没有任何意义的，除了可变或不可变之外没有其他原因。

单独的问题是： - 是否返回强类型数据列表。IList 或 IList。始终首选使用强类型数据。- 可变或不可变。ICollection、IList 或 IEnumerator 返回您希望允许的数据。对于只读列表，仅返回一个 IEnumerator。如果允许调用者修改集合，请使用 ICollection 或 IList。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-02T23:36:35.143

基本上他的意思是“我们更喜欢在运行时不容易更改的结构，因为我们相信它们不太容易出错。” 在这种情况下这是否正确是另一个问题。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-02T23:45:17.120

也许他的意思是数组的大小是“不可变的”？基本上，您声明一次大小，然后就被卡住了。对于列表，您始终可以使用“添加”。

我*想*如果*你**确定*列表的大小，也许数组会快一点？

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-02T23:46:08.723

好。IList 是可变的，因为您可以添加和删除项目，而不仅仅是更改已经存在的项目。数组可以让您处理单个项目，但特定索引永远不会变得完全无效。有很多理由更喜欢不变性——例如，它使意外数据损坏的表面积小得多。

# asp.net - 在 Asp.Net 上按顺序播放音频文件（一个接一个）

> ID：815897
> 
> 赞同：0
> 
> 时间：2009-05-02T23:35:28.907
> 
> 标签：asp.net, javascript, multimedia

我有一个要求，我需要在 ASP.Net 页面上播放多个音频歌曲。任何人都可以建议最好的方法来实现这个。

我有页面。在那里，我将在网格视图中显示歌曲列表。网格视图包含复选框和歌曲名称。用户应该能够选择多个复选框并单击播放。

当用户单击新弹出窗口上的播放按钮时，我必须一一播放用户选择的所有音频歌曲。

我会感谢你的帮助。

谢谢，文卡特。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-27T21:35:54.833

我很想使用[jPlayer](http://www.happyworm.com/jquery/jplayer/) - jQuery 音频播放器插件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T03:10:23.990

音频是什么格式的？

最好的方法是动态创建一个播放列表文件 (.asx|.m3u) 并将其提供给浏览器/媒体播放器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-16T12:14:55.733

在 javascript 中使用`mediaEnded`mediaplayer(silverlight) 的事件

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-02T23:43:40.307

ASP.NET 是服务器端的。要在访问者的计算机上播放声音，您需要使用在客户端运行的东西。JavaScript、Flash、Java 等。如果您在 ASP.NET 代码中播放声音，它将在服务器上播放。不是很实用……明白吗？“远程？” 哈哈！

# zsh - 在没有 tee 的情况下无法在 Zsh 中使用多个输出

> ID：815903
> 
> 赞同：0
> 
> 时间：2009-05-02T23:36:42.350
> 
> 标签：zsh, tee

我在 .zshrc 中有以下内容

```
setopt multios 
```

我正在尝试在 Zsh 中启用上述选项来执行以下操作

```
ls -1 | tee file.txt | less 
```

我运行以下命令失败

```
ls -1 | file.txt | less 
```

以及以下

```
ls -1, file.txt, less 
```

**如何在没有命令 tee 的情况下在 Zsh 中使用多个输出？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-02T23:55:40.510

第二个是错误的语法，应该是

```
ls -1 > file.txt | less 
```

# php - 您采取哪些步骤来解决 PHP cURL 的问题？

> ID：815910
> 
> 赞同：13
> 
> 时间：2009-05-02T23:39:13.140
> 
> 标签：php, debugging, http, curl

几乎所有工作的 PHP 程序员都不得不使用 CURL 来发送原始 HTTP 请求，无论是用于信用卡支付处理、恶意屏幕抓取还是介于两者之间的事情。

几乎所有 PHP 程序员聚集的论坛都有很多人[无法使用 cURL 函数来做他们想做的事](https://stackoverflow.com/tags/curl)。

当 cURL 对您不起作用时，您使用哪些故障排除技术来找出它为什么不起作用？你在 PHP 的 curl 实现中遇到了哪些奇怪的问题？如果有人在论坛上提出“HALP MY CURL IZ BROKEN”问题，您会采取哪些步骤来找出他们的请求不起作用的原因？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-03T08:01:14.730

我发现 CURLINFO_HEADER_OUT 选项非常有用。

```
<?php
$curl = curl_init('http://www.php.net');

curl_setopt($curl, CURLOPT_HEADERFUNCTION, 'dbg_curl_data');
curl_setopt($curl, CURLOPT_WRITEFUNCTION, 'dbg_curl_data');
curl_setopt($curl, CURLINFO_HEADER_OUT, true);

curl_exec($curl);

echo '<fieldset><legend>请求头</legend>
  <pre>', htmlspecialchars(curl_getinfo($curl, CURLINFO_HEADER_OUT)), '</pre>
</fieldset>';

echo '<fieldset><legend>响应</legend>
  <pre>', htmlspecialchars(dbg_curl_data(null)), '</pre>
</fieldset>';

函数 dbg_curl_data($curl, $data=null) {
  静态 $buffer = '';

  if ( is_null($curl) ) {
    $r = $缓冲区；
    $缓冲区 = '';
    返回 $r;
  }
  别的 {
    $缓冲区.= $数据；
    返回 strlen($data);
  }
}
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-02T23:44:52.440

实际上，我从不使用 CURL（在 php 中）。PHP 流 api 更简洁，也可以用于 POST 数据。[Wez Furlong](http://netevil.org/blog/2006/nov/http-post-from-php-without-curl)有一篇关于此的文章。

如果我要使用它？我将从打开所有消息开始（将错误报告设置为 E_ALL）。如果我发现 PHP 没有在错误消息中告诉我我需要什么，我可能会使用代理方法来查看实际发生的情况。将目标 url 更改为包含类似内容的本地 php 页面

```
<?php
var_dump($_POST);
var_dump($_GET);
var_dump($_SERVER); 
```

是一种方式。另一种方法是使用 netcat 之类的实用程序侦听端口 80 并将请求发送到那里：

```
netcat -l -p 80 
```

这不会向 curl 返回任何内容，但它可以让您准确查看发送到服务器的内容，这可能足以诊断问题。

您还可以使用[apache_request_headers()](http://se2.php.net/manual/en/function.apache-request-headers.php)函数从 PHP 中检索标头。不过，在大多数情况下，我更喜欢 netcat 方法，因为它保证我看到未经修改的事实，并且还显示原始帖子数据。

# design-patterns - 在应用程序中连接模块

> ID：815911
> 
> 赞同：1
> 
> 时间：2009-05-02T23:40:12.453
> 
> 标签：design-patterns, oop

在从事我的爱好项目时，我将代码拆分为后台操作和 gui 操作。所以我最终得到了执行实际工作的库对象和代表菜单、框架等的 gui 对象。每次困扰我的事情是我最终有很多必须了解其他对象的对象。例如工具栏对象需要了解主机，主菜单需要了解框架和工具栏，所以我最终通过构造函数传递了对许多对象的引用。虽然它有效，但我无法想象 Windows 或 darwin 代码会传递 100 个对其他组件的引用。

所以我的问题是在不传递一堆相互引用的情况下保留对象的首选方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-02T23:51:52.953

**[关注点分离](http://en.wikipedia.org/wiki/Separation_of_concerns)：使每个对象只有一个责任。**

这里的目标是确保每个对象都具有最小的功能并做好。然后用你的对象组成你的系统。这样，您就得到了一个包含小类的系统，这些小类是较大类的组合，这些类“管理”系统的各个部分并一起通信。这些类之间的依赖关系很简单。

我确定我在这里并不完全清楚，您应该尝试查看一些大型且复杂的面向对象库的组织方式（如果您对实时 3D 渲染感兴趣，例如[Ogre ）。](http://ogre3d.org)

# networking - 普通浏览器中的 UDP 协议支持

> ID：815914
> 
> 赞同：0
> 
> 时间：2009-05-02T23:41:40.577
> 
> 标签：networking, udp

在地址栏中输入“udp://host:666”效果不佳。使用普通 Web 浏览器向主机发送单个“空”数据报是否有任何解决方法？

响应没有问题，因为我考虑的用例是端口敲击（“ [http://host:666](http://host:666) ”效果不佳，因为如果没有响应，浏览器往往会重复请求，从而违反了指定的敲门序列）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-02T23:45:04.907

HTTP 是一种 TCP 协议。网络浏览器是错误的工具。

从一个快速的谷歌，[http://netcat.sourceforge.net/](http://netcat.sourceforge.net/)出现了。它可能能够为您发送该 UDP。

# binding - 无法在 Screen 的 CA Esc 模式下将 HJKL 绑定到 DLTH

> ID：815915
> 
> 赞同：2
> 
> 时间：2009-05-02T23:41:44.040
> 
> 标签：binding, zsh, gnu-screen, dvorak

我希望我的 Zsh 在 Screen 中对 Dvorak 友好。

我正在尝试在 Zsh 中进行以下绑定，以便我可以在 Ctl-a Esc 模式下使用它们来移动

```
h => d
j => l
k => t
l => n 
```

我还没有找到任何方法来做到这一点。

**如何在 Screen 中进行以下键绑定**，以便我可以在 CA Esc 模式下使用它们？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-03T00:27:28.517

Screen 有一个[`markkeys`](http://www.gnu.org/software/screen/manual/html_node/Copy-Mode-Keys.html#Copy-Mode-Keys)配置选项，可让您重新映射在回滚模式中使用的键。

以下代码使 .screenrc 中的 Screen Dvorak 友好

```
 markkeys h=d:j=h:k=t:l=n 
```

# c# - 一个方法如何知道它是否在 UI 线程上运行？

> ID：815929
> 
> 赞同：3
> 
> 时间：2009-05-02T23:48:08.080
> 
> 标签：c#, .net, multithreading

我有一个简单的问题，但我有 80% 的把握这个问题的答案会伴随着“你做错了”，所以我也要问这个不简单的问题。

一个简单的问题：我有一个公共类的公共方法。如果在 UI 线程上调用它，我希望它抛出异常。我怎样才能做到这一点？

一个不太简单的问题是：有没有更简单的方法来重构这个设计？

**背景：**

我开发了一个桌面程序，它通过其 API 与遗留应用程序进行互操作。API 不是远程线程安全的。我已经构建了一个类库，该类库封装了与 API 的互操作（涉及在巨大的 byte[] 缓冲区中编组和解组数据，然后调用从 DLL 加载的外部函数），以便隐藏遗留 API 的许多实现细节尽可能从我的代码中。因为我知道创建核心 API 对象的多个实例将是一场灾难，所以我将它实现为一个静态类。

我还构建了一组用于在我的应用程序后台运行任务的类。`TaskManager`维护一个`Task`对象队列并使用`BackgroundWorker`. 使用后台线程允许桌面应用程序的 UI 在与庞大的遗留应用程序进行互操作时保持响应；使用队列可确保在任何给定时间只有一个任务正在调用 API。

不幸的是，我从没想过在这个设计中加入某些保护措施。我最近在代码中发现了我直接在 UI 线程上调用 API 的地方。我相信我已经修复了所有这些问题，但我想保证我不会再这样做了。

如果我从一开始就正确地设计了这个，我会让 API 包装类成为非静态的，将其构造函数隐藏在除 之外的所有内容中`TaskManager`，然后`Task`在创建 API 类的实例时将其传递给每个类。任何与 API 对话的方法`Task`都需要传递给 API 对象。这将导致无法在前台线程上使用 API。

问题是，有*很多*代码与 API 对话。实施这种改变（我认为这最终是正确的做法）将触及所有这些。因此，与此同时，我想修改 API 的`Call`方法，以便在前台线程上调用它时抛出异常。

我知道我正在解决错误的问题。我能感觉到它在我的骨头里。但我现在也很投入其中，看不到正确的解决方案。

**编辑：**

我清楚地以错误的方式提出了这个问题，这就是为什么很难回答。我不应该问“这个方法怎么知道它是否在 UI 线程上运行？” 真正的问题是：“这个方法如何知道它是否在*错误*的线程上运行？” （理论上）可能有一千个线程在运行。正如 JaredPar 指出的那样，可能有不止一个 UI 线程。只有一个线程是正确的线程，它的线程 ID 很容易找到。

事实上，即使我重构了这段代码以使其设计得当（我今天大部分时间都这样做了），仍然值得在 API 中使用一种机制来检查以确保它在适当的线程上运行。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-02T23:56:21.197

确定您是否在 UI 线程上的部分问题在于可能有多个 UI 线程。在 WPF 和 WinForms 中，很可能创建多个线程来显示 UI。

但是，在这种情况下，听起来您的情况相当有限。最好的办法是在共享位置记录 UI 线程或后台线程的 Id，然后使用 Thread.CurrentThread.ManagedThreadId 确保您在正确的线程上。

```
public class ThreadUtil {
  public static int UIThreadId;

  public static void EnsureNotUIThread() {
    if ( Thread.CurrentThread.ManagedThreadId == UIThreadId ) {
      throw new InvalidOperationException("Bad thread");
    }
  }
} 
```

这种方法有几个注意事项。您必须以原子方式设置 UIThreadId 并且必须在任何后台代码运行之前这样做。最好的方法可能是将以下几行添加到您的程序启动中

```
Interlocked.Exchange(ref ThreadUtil.UIThreadID, Thread.CurrentThread.ManagedThreadId); 
```

另一个技巧是寻找一个 SynchronizationContext。WinForms 和 WPF 都将在其 UI 线程上设置 SynchronizationContext 以允许与后台线程通信。对于由您的程序创建和控制的背景（我真的想强调这一点），除非您实际安装 SynchronizationContext，否则不会安装 SynchronizationContext。所以下面的代码可以在非常有限的情况下使用

```
public static bool IsBackground() { 
  return null == SynchronizationContext.Current;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-03T00:14:05.430

我会反转 ISynchronizeInvoke 用例，如果`ISynchronizeinvoke.InvokeRequired == false`. 这让 WinForms 负责查找 UI 线程的血腥工作。性能会有点糟糕，但这是一个调试场景 - 所以它真的没关系。您甚至可以将检查隐藏在`#IF DEBUG`标志后面以仅检查调试版本。

您确实需要为您的 API 提供对 ISynchronizeInvoke 的引用 - 但您可以在启动时轻松执行此操作（只需传递您的主表单），或者让它使用静态 Form.ActiveForm 调用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-02T23:55:33.133

[Justin Rogers](http://weblogs.asp.net/justin_rogers/articles/126345.aspx)详细讨论了 Invoke/BeginInvoke 如何做到这一点，以及它在哪里变得丑陋。

基本上，它回退到在 UI 线程上查找某个窗口，然后调用[GetWindowThreadProcessId](http://msdn.microsoft.com/en-us/library/ms633522(VS.85).aspx)将当前线程 ID 与窗口的 ID 进行比较。（当然，当你只有一个 UI 线程时，你可以缓存线程 ID）。

# asp.net - 如何防止所有 Firefox 浏览器实例使用相同的身份验证 cookie？

> ID：815930
> 
> 赞同：0
> 
> 时间：2009-05-02T23:48:11.043
> 
> 标签：asp.net, authentication, forms-authentication

`Default.aspx`我通过创建名为的自定义登录页面来实现表单身份验证`login.aspx`。如果未经身份验证的用户浏览到`Default.aspx`，他们将被重定向到`login.aspx`，并且仅当找到与提供的凭据匹配时，用户才会被重定向到`default.aspx`。

*   但是在使用 Firefox 时，似乎所有浏览器实例都使用相同的身份验证 cookie 实例，因此如果浏览器 B1 中的用户以用户 U1 身份登录，那么访问该 Web 应用程序的所有浏览器实例都将以用户 U1 身份登录。因此，例如，如果浏览器实例 B1 第一次请求*Default.aspx*，它将立即被授予访问权限。

*   如果在我以用户 U1 身份登录后，我`login.aspx` 使用不同的用户名（比如用户 U2）浏览并登录，那么在回发时，所有浏览器（以前以用户 U1 身份登录）现在都将以用户 U2 身份登录。

如何防止这种行为，以便每个浏览器实例都会收到自己的身份验证 cookie？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-02T23:52:12.407

每个浏览器实例都有自己的一组 cookie。还有历史。和书签。因为每个正在运行的实例都需要附加到自己的配置文件中。

但是，任何给定的实例都可以打开多个选项卡和窗口。那些将共享cookies。如果这对您不起作用，请不要使用 cookie...

如果你只是想让测试变得更容易，为什么不设置一个单独的测试配置文件并启动一个单独的 Firefox 实例呢？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-03T00:10:25.030

一个快速的实验向我展示了 Shog9 的含义。启动火狐。然后启动 Firefox 的另一个“实例”。然后查看任务管理器，你会发现你只运行了一个 firefox.exe 进程。

我想他的意思是你实际上从未见过两个 Firefox 实例。您只看到同一个实例运行两个窗口。自然，它们共享相同的 cookie。

我认为这意味着为了实际拥有单独的实例，它们必须在单独的登录名或用户配置文件下运行，并且它们*将*具有单独的 cookie 集。

* * *

**编辑：**一些关于 FireFox 配置文件的资源：

*   [简介](http://support.mozilla.com/en-US/kb/Profiles)
*   [管理配置文件](http://support.mozilla.com/en-US/kb/Managing+Profiles)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-03T02:21:03.267

我认为你的问题措辞含糊。Firefox 允许您拥有任意数量的 cookie 集。每个集合都必须是 Firefox 配置文件的一部分。每个配置文件可以打开任意数量的窗口和进程（注意，为避免加入现有进程，您必须使用[no-remote](http://kb.mozillazine.org/Command_line_arguments)）。

我认为您一直在使用具有相同配置文件的多个窗口，这些窗口应该共享一个 cookie 集。

# bazaar - 撤消 bzr 还原

> ID：815933
> 
> 赞同：16
> 
> 时间：2009-05-02T23:49:37.437
> 
> 标签：bazaar

在提交之前，我不小心用 bzr revert 恢复了我的所有更改。我的所有更改都丢失了，还是我可以以某种方式撤消还原？

我没有丢失很多更改，但是我很想知道是否有针对此的安全网。谷歌不帮助“撤消 bzr 恢复”。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-05-02T23:55:33.163

好的，显然 bazaar 将附加“.~1~”的文件留给恢复的文件，因此为了恢复更改，只需将该文件的 cp 复制到恢复的文件中即可。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-29T19:18:20.667

它每次都会增加数字。

第一次还原文件时，它会将 ~1~ 添加到末尾。如果您进行更多更改并再次还原，它会添加 ~2~ 等。

# html - 未来 2-3 年，文档对象模型 (DOM) 将走向何方？关于DOM，我们应该了解哪些核心概念？

> ID：815938
> 
> 赞同：-2
> 
> 时间：2009-05-02T23:52:06.713
> 
> 标签：html

我应该知道哪些工具？

这是我的一个问题，即从社区快速收集并了解最新信息。

我知道基本定义是

“文档对象模型是 HTML 和 XML 文档的 API。它提供了文档的结构表示，使您能够修改其内容和视觉呈现。本质上，它将网页连接到脚本或编程语言。”

我更感兴趣的是找到它在未来几年的发展方向。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-02T23:53:59.097

[https://developer.mozilla.org/en/DOM](https://developer.mozilla.org/en/DOM)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-03T00:14:10.343

有不同的 DOM：XML DOM、DHTML DOM……等等。请更具体！无论如何，您必须在每种情况下都使用 Javascript 进行思考。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-03T02:40:09.460

您可以关注 XHTML 2.0 和 Javascript 2.0 的进展情况。如果您获得最新版本的 Firefox (3.1)，您将拥有 Javascript 1.8，这将帮助您了解正在发生的事情。

# macos - 无法将 Mac 的手册扩展为拥有 Ubuntu 的手册

> ID：815940
> 
> 赞同：-1
> 
> 时间：2009-05-02T23:52:54.107
> 
> 标签：macos, macports

例如，My Leopard 没有 Wget 和 compinit 手册。它在许多其他领域也缺乏，例如关于选项的示例和文档。

Ubuntu 通常有比 Mac 更好的手册：例如，它有两个命令的手册。

*该问题的解决方案*可能是为 MacPorts 创建一个端口，它将 Ubuntu 的手册安装到 Mac。但是，我不确定这是否是最佳解决方案。

也许，可以简单地更改人使用的 PATH，这样您就可以在 Mac 中保留 Ubuntu 手册的本地副本。但是，我不确定您如何做到这一点。

**如何将 Mac 的手册扩展为至少有 Ubuntu 的手册，**以便我可以使用以下命令

```
man wget
man compinit 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-02T23:58:42.360

**原始帖子：** 您可能希望首先在您的 Mac 上安装上述程序。安装可能包括手册页。

**更新以反映讨论：** MacPorts 将其手册页存储在`/opt/local/share/man`并将这些添加到 中`$MANPATH`，显然*仅*用于 bash。确保它也在您的 zsh 或您使用的任何其他 shell 的 man 路径上。

`compinit`似乎记录在`zshcompsys(1)`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-03T03:27:12.127

正如其他答案所暗示的那样，您确实应该了解 PATH 和 MANPATH 的工作原理。

OS X 的手册页经常缺少，但仅限于 Mac 特定的命令。对于标准的 *nix 命令，OS X 带有适当的手册页。例如，将 Ubuntu 的 chmod 手册页用作 OS X 的 /bin/chmod 的指南将是一个错误，因为那样你会错过关于在 OS X 中通过 chmod 设置 ACL 的讨论。

正如其他人所提到的，Macports 将其手册页存储在 /opt/local/share/man 中。MANPATH 环境变量应该包含这个值，但它应该预先或附加现有的 MANPATH，这取决于 Macports 可执行目录 (/opt/local/bin:/opt/local/sbin) 是否已预先或附加到 PATH .

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-03T03:07:49.253

**让 Wget 的手动工作的解决方案。**感谢 MacPorts IRC 的 blb！

运行以下

```
unset MANPATH 
```

不要在命令后导出旧的 MANPATH。

这使我成为 Wget 的手工工作。

# python - 可作为实例方法调用？

> ID：815947
> 
> 赞同：3
> 
> 时间：2009-05-02T23:58:32.643
> 
> 标签：python, methods, metaclass, python-descriptors

假设我们有一个元类`CallableWrappingMeta`，它遍历一个新类的主体，用一个类包装它的方法，`InstanceMethodWrapper`：

```
import types

class CallableWrappingMeta(type):
    def __new__(mcls, name, bases, cls_dict):
        for k, v in cls_dict.iteritems():
            if isinstance(v, types.FunctionType):
                cls_dict[k] = InstanceMethodWrapper(v)
        return type.__new__(mcls, name, bases, cls_dict)

class InstanceMethodWrapper(object):
    def __init__(self, method):
        self.method = method
    def __call__(self, *args, **kw):
        print "InstanceMethodWrapper.__call__( %s, *%r, **%r )" % (self, args, kw)
        return self.method(*args, **kw)

class Bar(object):
    __metaclass__ = CallableWrappingMeta
    def __init__(self):
        print 'bar!' 
```

我们的虚拟包装器只是在参数进入时打印它们。但是您会注意到一些明显的事情：该方法没有传递给实例对象接收器，因为即使`InstanceMethodWrapper`是可调用的，它也不会被视为函数在类创建期间转换为实例方法（在我们的元类完成之后）。

一个潜在的解决方案是使用装饰器而不是类来包装方法——该函数将成为实例方法。但在现实世界中，`InstanceMethodWrapper`情况要复杂得多：它提供 API 并发布方法调用事件。一个类更方便（并且性能更高，这并不重要）。

我也尝试了一些死胡同。子类化`types.MethodType`并`types.UnboundMethodType`没有去任何地方。稍加反省，似乎它们是从`type`. 所以我尝试将两者都用作元类，但也没有运气。可能是他们作为元类有特殊要求，但目前我们似乎处于无证领域。

有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-03T19:37:57.393

只需用 a 来丰富你`InstanceMethodWrapper`的类`__get__`（这可以很好地只是`return self`）——也就是说，使该类成为*描述符*类型，以便它的实例是描述符对象。有关背景和详细信息，请参见[http://users.rcn.com/python/download/Descriptor.htm](http://users.rcn.com/python/download/Descriptor.htm)。

顺便说一句，如果您使用的是 Python 2.6 或更高版本，请考虑使用类装饰器而不是那个元类——我们添加类装饰器正是因为有这么多元类仅用于此类装饰目的，而装饰器使用起来确实简单得多.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-03T00:26:02.747

**编辑**：我又撒谎了。函数的`__?attr__`属性是只读的，但显然在分配时并不总是抛出`AttributeException`异常？我不知道。回到原点！

**编辑**：这实际上并不能解决问题，因为包装函数不会将属性请求代理到`InstanceMethodWrapper`. 当然，我可以对装饰器中的属性进行猛击`__?attr__`——这就是我现在正在做的事情——但这很丑。更好的想法是非常受欢迎的。

* * *

当然，我立即意识到将一个简单的装饰器与我们的类结合起来就可以了：

```
def methodize(method, callable):
    "Circumvents the fact that callables are not converted to instance methods."
    @wraps(method)
    def wrapper(*args, **kw):
        return wrapper._callable(*args, **kw)
    wrapper._callable = callable
    return wrapper 
```

然后将装饰器添加到`InstanceMethodWrapper`元类中的调用中：

```
cls_dict[k] = methodize(v, InstanceMethodWrapper(v)) 
```

噗。有点倾斜，但它的工作原理。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-03T01:41:18.230

我猜您正在尝试创建一个元类，该元类使用自定义函数包装类中的每个方法。

这是我的版本，我认为它不那么倾斜。

```
import types

class CallableWrappingMeta(type):
    def __new__(mcls, name, bases, cls_dict):
        instance = type.__new__(mcls, name, bases, cls_dict)
        for k in dir(instance):
            v = getattr(instance, k)
            if isinstance(v, types.MethodType):
                setattr(instance, k, instanceMethodWrapper(v))

        return instance

def instanceMethodWrapper(function):
    def customfunc(*args, **kw):
        print "instanceMethodWrapper(*%r, **%r )" % (args, kw)
        return function(*args, **kw)
    return customfunc

class Bar(object):
    __metaclass__ = CallableWrappingMeta

    def method(self, a, b):
        print a,b

a = Bar()
a.method("foo","bar") 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-03T13:53:23.010

我认为您需要更具体地了解您的问题。最初的问题是关于包装函数，但您随后的答案似乎是在谈论保留函数属性，这似乎是一个新因素。如果您更清楚地说明您的设计目标，可能会更容易回答您的问题。

# design-patterns - OCaml 中的中介者设计模式

> ID：815949
> 
> 赞同：1
> 
> 时间：2009-05-02T23:59:50.033
> 
> 标签：design-patterns, ocaml, mediator

我正在尝试在 OCaml 中完成两个类之间的相互绑定（a la Mediator Pattern's），并且在编译时出现错误。

```
class virtual ['mediator] colleague mIn = object 
 val m = mIn
 method virtual getmediator : 'mediator
end;;

class concreteColleague mIn = object inherit colleague 
 method getmediator = m
end;;

(* Some other classes here *)

class mediator = object (self)
 val mutable myColleague = (None:colleague option)
 initializer 
  myColleague <- Some (new concreteColleague self)
end;; 
```

错误：类构造函数同事需要 1 个类型参数，但在这里应用于 0 个类型参数。

我不能说我对类定义中的 ['foo] 语法非常熟悉，但是在试图让调解员保留对所有同事和每个同事的引用时，我已经求助于它（无济于事）它各自的中介，同时也试图克服源代码中类定义的重要性。我该如何让同事保留对他们调解员的参考？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-03T02:14:59.617

我修复了所有编译问题。当你从同事那里继承时，你需要提供它的类型参数。因此，我认为具体同事也需要一个类型参数。此外，您忘记将构造函数参数 mIn 传递给继承的类。我使用对象的类型为 myColleague 的类型保护添加了一个类型参数。

```
class virtual ['mediator] colleague mIn = object 
 val m = mIn
 method virtual getmediator : 'mediator
end;;

class ['mediator] concreteColleague mIn =
 object inherit ['mediator] colleague mIn
 method getmediator = m
end;;

(* Some other classes here *)

class mediator = object (self : 'self)
 val mutable myColleague = (None:'self colleague option)
 initializer 
  myColleague <- Some (new concreteColleague self)
end;; 
```

但是，我不熟悉中介者模式，所以我不确定实现中介者模式的正确方法是什么。你确定你需要对象和虚拟类和东西吗？

# apache-flex - 如何使我的整个 flex 小部件具有圆角？

> ID：815950
> 
> 赞同：-1
> 
> 时间：2009-05-03T00:00:59.127
> 
> 标签：apache-flex, flash, actionscript-3, widget, rounded-corners

我正在创建一个 Flex 小部件，并希望使角变圆。换句话说，我不希望小部件内的某些组件被四舍五入，我希望实际的小部件被四舍五入。

我在很多地方都看到过这样做，所以这不会太难，但是我在互联网上找到的所有解决方案都不起作用。

人们说要设置cornerRadius 属性，然后将borderStyle 设置为“solid”，将borderThickness 设置为任何值。这对我不起作用。

有任何想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-03T14:10:00.863

如果您正在创建 AIR 应用程序，您可以设置自定义镶边，您的整个应用程序将具有您想要的形状。

[这](http://technoracle.blogspot.com/2007/07/making-custom-chrome-air-applications.html)是一篇方便的文章。

不确定您在谈论哪种小部件。

# testing - OpenID 提供者的合规性测试

> ID：815951
> 
> 赞同：17
> 
> 时间：2009-05-03T00:02:29.310
> 
> 标签：testing, openid, protocols, standards

OpenID 提供商有哪些**自动化标准一致性测试？**

我正在对[OpenID](http://openid.net/)提供程序的实现进行更改，以将其从标准的 1.1 版升级到 2.0 版。

在发布代码之前，我想确保它符合标准的规范。为了测试 Web 标准合规性，W3C 提供了验证器工具。有哪些工具可以让我**将自动化测试仪指向我的 OpenID 提供商**并获得符合标准的报告？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-11-15T20:50:05.090

You could look at [http://test-id.net/](http://test-id.net/) which has a set of tests written in .net.

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-20T19:46:53.713

1.1-only 有这个东西：http: [//openidenabled.com/resources/openid-test/diagnose-server/](http://openidenabled.com/resources/openid-test/diagnose-server/)

我们从未将其升级为 2.0。每年有一两次有人过来说“嘿，我们应该有更好的测试工具”，但据我（和其他人，从这里的回答来看）所知，这些努力都没有结果。

编辑添加：另一个相关项目位于[http://code.google.com/p/openid-test/](http://code.google.com/p/openid-test/)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-03T18:34:31.897

据我所知，没有一致性测试（至少官方批准）——即使是 1.1。当然，它的价值将非常高。oAuth 也是如此——它们都是复杂的协议，有时规范并不能涵盖所有内容。

可能您现在唯一能做的就是在本地进行全面的单元测试覆盖。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-03T19:10:30.050

OSIS have [interoperability tests](http://osis.idcommons.net/wiki/I3:Cross_Solution_OpenID_Identity_Provider_x_Relying_Party_Results), [feature tests for IPs](http://osis.idcommons.net/wiki/I5:OpenID_Identity_Provider_FeatureTest_Results) and [feature tests for RPs](http://osis.idcommons.net/wiki/I5:OpenID_Relying_Party_FeatureTest_Results)

However these aren't automated, everyone gets together at one of the RSA conferences and checks they all work with each other.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-04-04T21:50:08.320

万一有人偶然发现这个线程，OpenID Connect 现在有一个官方的一致性测试套件，它是认证过程的一部分：

[https://openid.net/certification/testing/](https://openid.net/certification/testing/)

享受！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-03T00:23:18.980

到目前为止，据我所知，没有工具可以报告符合标准的情况。如果你真的想确保你的代码符合 2.0，你应该聘请一些独立的顾问来审查你对 openID 2.0 的每个功能的单元测试。当然，他们也应该进行自己的测试。顾问必须具有一般审计经验，如 PCI DSS 等。他们有经验检查规范并测试您的应用程序库和数据库。

# c# - 有人有一些 TAP 或 SNPP 的例子吗？

> ID：815956
> 
> 赞同：1
> 
> 时间：2009-05-03T00:04:59.630
> 
> 标签：c#, c++, paging, tap

有谁知道一个很好的资源，其中包含一些在 C++ 或 C# 中使用远程定位器字母数字协议 (TAP) 和/或简单网络寻呼协议 (SNPP) 的示例？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-08-29T02:15:39.937

[轻敲](http://www.columbia.edu/kermit/pagers.html)

不是 C++，而是：

Perl [Net::SNPP 模块](http://www.xav.com/perl/site/lib/Net/SNPP.html)

# cocoa - 如何检测文件是否已使用 Cocoa 重命名？

> ID：815958
> 
> 赞同：5
> 
> 时间：2009-05-03T00:05:54.527
> 
> 标签：cocoa, macos

我正在为 Mac OSX 构建一个跨两个系统同步文件的实用程序应用程序。我需要检测文件何时被重命名但其他文件是同一个文件。我如何在 Cocoa 中做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-03T22:55:33.220

没有简单的答案；您需要为您的应用找出最佳策略。

简单来说，就是使用文件系统编号。您可以使用`NSFileSystemFileNumber`. 可能更好的工作是使用`FSRef`. 它是一个 C API，但相对简单，并且有一种与 FSRefs 比较是否相等的方法。

但是，有很多应用程序通过*替换*磁盘上的文件、更改文件编号来执行保存操作。这很可能会扰乱您的代码。所以考虑使用别名。这与 Finder 用于跟踪别名文件的目标的系统相同。使用 Alias Manager (C API) 或开源 Objective-C 包装器之一（例如 NDAlias 或 BDAlias）。别名将尽最大努力通过路径和文件号来维护对文件的引用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-03-06T23:17:52.693

我遇到的一些其他细节：

如果文件只是重命名，那么文件将保留相同的 inode (NSFileSystemFileNumber)。

但是，如果文件被修改，Mac OS X 通常会用新文件的副本替换旧文件，因此 inode 号不会相同。

如果您在 TextEdit 中编辑文本文件然后保存它，您可能会注意到该文件消失然后重新出现在 Finder 中。但是，如果您使用命令行编辑器（vi、pico、emacs 等）编辑此文件，它将直接保存到文件中。

我的猜测是 Cocoa 应用程序会先保存到临时文件，然后替换文件的原始版本，这就解释了为什么 inode 不同。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-03-16T05:22:21.957

我假设您的目标是文件的内容，而不是它们的属性。最简单的方法是计算和比较哈希。只需逐块读取这两个文件并比较哈希值，例如使用这些[MD5](https://stackoverflow.com/questions/2018550/how-do-i-create-an-md5-hash-of-a-string-in-cocoa)例程。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-03T00:15:08.547

您可以查看 inode 编号（NSFileManager 返回的属性中的 NSFileSystemFileNumber），这将涵盖简单的重命名情况。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-03-15T10:55:14.300

如果您在不同的平台/操作系统上有源和目标，上述所有内容都将失败。最好的方法是在源位置和目标位置获取新文件和缺失文件的列表，然后如果任何两个文件具有相同的大小？如果它们具有相同的大小，则比较校验和/CRC，如果相同，则其中一个已被重命名。

# concurrency - CCR 和 DSS 工具包模型与其他可扩展性和并发性方法相比如何？

> ID：815959
> 
> 赞同：2
> 
> 时间：2009-05-03T00:07:34.070
> 
> 标签：concurrency, scalability, ccr

我有兴趣比较各种可扩展性和并发性方法，包括 CCR 和 DSS 框架模型。我会对与 Hadoop 和 Erlang 风格的并发性进行比较特别感兴趣

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-06T12:02:19.507

我看过 CCR、DSS 和 Erlang，尽管其中我只将 CCR 交付到重要的生产代码中。我从来没有看过Hadoop。

Erlang 的并发性源自其对 Actor 模型的实现。每个“进程”都有一个邮箱并从中检索消息，一次一个。没有消息来处理的进程不会阻塞任何线程。相反，有工作要做的进程被安排在可用的 cpu 上，而没有暴露任何底层机器。此外，进程通过具有克隆/不变性的消息传递进行通信，确保 P1 和 P2 永远不会在逻辑上共享它们之间传递的消息。

我的感觉是，正是消息发送和接收的非阻塞特性赋予了 Erlang 在单台（可能是多核）机器上的可扩展性而享有盛誉。从本质上讲，有工作要做的进程在可用资源上被有效地调度，而静止进程只消耗内存。通过一次处理一条消息，每条消息都保证消息的稳定性，开发人员不再需要担心诸如“竞争条件”之类的事情。

CCR 是一组低级异步消息传递原语。其中一个更简单的是 Receive ，它可以接收 la Erlang。但是还有更复杂的原语，例如 Join（接收所有某些通道的消息）和 Choice（接收来自某些通道的消息），它们可以以有趣的方式嵌套和组合。这些原语也是非阻塞的。接收器将任务（处理消息）生成到 1..n 个任务队列中，这些任务队列由少量线程提供服务。

我的猜测是，忽略（重要！）平台差异，每个基本任务调度例程基本上都在同一个球场。但是，Erlang 是一种语言和平台，其中包含固定的（Actor）模型。CCR 既不是这些东西，它只是一个库，您可以更自由地使用/滥用它。

DSS*是*一种基于 CCR 的编程模型。它有服务（Erlang = 进程），它要求异步消息传递（默认为完全克隆）作为服务间通信的唯一形式，而外界对服务的唯一处理是它的 URI（Erlang = PID） . 与 Erlang 一样，调用本地服务和远程服务之间本质上没有区别，尽管在后一种情况下会发生（反）序列化。

DSS 还具有 RESTful 模型，这意味着服务通常会公开一组固定且通用的操作，并且服务的状态应被视为由这些操作操作的资源。将此与 Erlang 进行对比，Erlang 可以将任意消息发送到进程。DSS 服务可以使用全套 CCR 原语与其他服务通信，这对于分布式分散收集操作等非常有用。

归根结底，DSS 只是一个带有支持库的框架，而不是一种语言或 VM，因此与编写 Erlang 进程相比，即使是编写单个 DSS 服务也需要更多的“仪式”。

在并发方面，它们都提供了编写在多个执行线程下安全高效的代码所需的原语，而无需担心那些执行线程。我认为这是大多数开发人员想要的方向。

在可扩展性方面，这是一个更难回答的问题，因为它与系统设计和使用的工具一样多。您是指单个节点上的可扩展性，即添加核心还是添加节点？CCR 对后者无话可说。DSS 和 Erlang 都支持相当有效的用于有线传输的二进制格式。DSS 直接从 http 继承其面向资源的世界观，这应该会告诉您有关其*潜在*可伸缩性的一些信息，但它在编程模型的某些限制下这样做。

几个技术点。单个 DSS 服务比单个 erlang 进程（300-400 字节）消耗更多的内存（~2K）。此外，每个 DSS 服务都有自己的任务队列，并且 CCR 可以有效处理的任务队列数量有一个上限（~10000）。我没有关于 Erlang 的任何此类上限的数字，但怀疑它可能会高于此。

说了这么多，如果您在.NET 平台上，那么认真看看CCR 是对自己有利的。我发现它非常强大，尤其是对于反应式事件驱动程序。

# php - 如何确定压缩文件的内容长度？

> ID：815961
> 
> 赞同：14
> 
> 时间：2009-05-03T00:08:28.657
> 
> 标签：php, http-headers, gzip, header

现在，我正在尝试从不允许我启用`mod_gzip`或`mod_deflate`. 于是我写了一个PHP小脚本，用GZIP压缩并返回给用户。

示例代码：

```
$filename = "style.css";

if (!file_exists($filename) || !($info = stat($filename))) {
  header("HTTP/1.1 404 Not Found");
  die();
}

header("Date: ".gmdate("D, j M Y H:i:s e", time()));
header("Cache-Control: max-age=2592000");
header("Last-Modified: ".gmdate("D, j M Y H:i:s e", $info['mtime']));
header("Etag: ".sprintf("\"%x-%x-%x\"", $info['ino'], $info['size'], $info['mtime']));
header("Accept-Ranges: bytes");
header("Cache-Control: Expires ".gmdate("D, j M Y H:i:s e", $info['mtime']+2592000));
header("Content-Type: text/html");

ob_start("ob_gzhandler");
echo file_get_contents($filename);
ob_end_flush(); 
```

我现在有两个问题。首先是，我无法确定压缩文件的最终大小以通知浏览器内容长度。通常，我会包括这一行：

```
header("Content-Length: ".$info["size"]); 
```

但是，如果我这样做了，浏览器会在尝试等待更多数据时挂起。有没有办法计算总大小？或者我应该忽略这个头指令。

另一个问题是，每当我在 Firefox 中查看这个 PHP 文件时，它都会尝试让我下载结果。在 Chrome 中，它只是像我期望的那样显示它。有什么建议么？

**编辑：**感谢 SoapBox，我用以下代码替换了代码的结尾：

```
header("Content-Encoding: gzip");
$compressed = gzencode(file_get_contents($filename), 5);
header("Content-Length: ".strlen($compressed));
die($compressed); 
```

这对内容长度非常有用！但我仍然让 Firefox 下载文件而不是显示它。:(

**再次编辑：**这是修改后的代码结尾代码，由 Cletus 提供。

```
// Start buffered output
ob_start();
// Check for gzip capability
if (stripos($_SERVER['HTTP_ACCEPT_ENCODING'], "gzip") !== false) {
  ob_start("ob_gzhandler");
  echo file_get_contents($filename);
  ob_end_flush();
} else
  echo file_get_contents($filename);

// Write the content length
header('Content-Length: '.ob_get_length());
ob_end_flush(); 
```

我将开始一个新问题来弄清楚为什么 Firefox 一直尝试下载该文件。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-05-03T01:28:04.127

这里的问题是，要知道内容长度，您需要知道客户端是否支持 gzip 编码，并且您已经通过使用 ob_gzhandler 委派了该决定。从[HTTP 标头](http://www.edginet.org/techie/website/http.html)：

> ```
> ob_start();
> ob_start('ob_gzhandler');
> 
>   ... output the page content...
> 
> ob_end_flush();  // The ob_gzhandler one
> 
> header('Content-Length: '.ob_get_length());
> 
> ob_end_flush();  // The main one 
> ```

完整版：

```
$filename = "style.css";

if (!file_exists($filename) || !($info = stat($filename))) {
  header("HTTP/1.1 404 Not Found");
  die();
}

header("Date: ".gmdate("D, j M Y H:i:s e", time()));
header("Cache-Control: max-age=2592000");
header("Last-Modified: ".gmdate("D, j M Y H:i:s e", $info['mtime']));
header("ETag: ".sprintf("\"%x-%x-%x\"", $info['ino'], $info['size'], $info['mtime']));
header("Accept-Ranges: bytes");
header("Expires: ".gmdate("D, j M Y H:i:s e", $info['mtime']+2592000));
header("Content-Type: text/css"); // note: this was text/html for some reason?

ob_start();
ob_start("ob_gzhandler");
echo file_get_contents($filename);
ob_end_flush();
header('Content-Length: '.ob_get_length());
ob_end_flush(); 
```

这比自己处理 gzip 编码问题要好得多**。**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-03T00:12:24.963

您需要首先执行整个 gzip 并测量结果（将内容保存在内存中，或者在压缩时将它们写入磁盘，然后统计 gzip 压缩文件），然后写入 Content-Length 标头，然后发送文件内容。

或者使用[分块传输编码](http://en.wikipedia.org/wiki/Chunked_transfer_encoding)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-03T00:15:48.123

为了解决您的Firefox问题，我认为您需要包含`header( "Content-Encoding: gzip" );`以便浏览器知道解压缩内容。

至于内容长度，你可以试着把这个值去掉，或者想办法使用“Transfer-Encoding：chunked”（你不能只发送这个header，你需要专门为它格式化数据）。可以`ob_end_flush`自动启用分块。

我建议您获取 wireshark 并捕获您的 php 脚本正在发送的内容，并将其与行为正常的服务器进行比较，以查看缺少哪些标头等。

# ajax - 没有 Comet 的反向 Ajax？

> ID：815962
> 
> 赞同：7
> 
> 时间：2009-05-03T00:09:10.573
> 
> 标签：ajax, tcp, comet

是否可以让 Web 服务器在没有 Comet 的情况下向 Web 浏览器发送消息？

像 Facebook 和谷歌这样的主要网络公司都为此目的使用 Comet，如果为主要浏览器启用 tcp 连接，这似乎是一个等待消失的丑陋黑客。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-09-25T22:20:09.790

> 是否可以让 Web 服务器在没有 Comet 的情况下向 Web 浏览器发送消息？

是的，它可以通过 Silverlight、Flex、Flash 和 Java 小程序实现。

> 像 Facebook 和谷歌这样的主要网络公司都为此目的使用 Comet，如果为主要浏览器启用 tcp 连接，这似乎是一个等待消失的丑陋黑客。

HTML 5 Web Sockets 的 TCP 连接不能解决问题。您会看到很多人在工作场所、大学或学校使用 Google 和 Facebook，而防火墙通常会阻止非标准端口和非 HTTP 流量。因此，将消息发送到 Web 浏览器的解决方案必须通过 HTTP 工作，并且通常看起来像 HTTP。这就是为什么 Google 和 Facebook 使用 Comet 并将继续这样做，否则他们将无法接触到大部分用户。事实上，一些防火墙和反向代理会关闭长时间运行的 HTTP 连接，因此 Ajax 轮询连接通常用作后备。如果您正在寻找能够通过 Reverse Ajax 向浏览器发送消息的服务器，我可以建议类似[StreamHub Reverse Ajax。](http://www.stream-hub.com/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-03T00:28:29.170

如果有其他方法，你认为 Facebook 和 Google 为什么会这样做？

好吧，好吧，还有其他方法。您可以在页面中嵌入 Java 小程序。如果 Java 小程序已签名，并且用户授予它权限，它可以为服务器打开一个长时间运行的连接以向其发送事件。但这会让你得到更脆弱的东西，需要更多的用户交互，启动速度更慢，并且可以在比 Comet 更少的平台上工作。

已经有一些关于将[服务器发送的事件](http://dev.w3.org/html5/eventsource/)和[Web 套接字](http://dev.w3.org/html5/websockets/)添加到 HTML5 的讨论，但这是非常初步的，可能不会使其成为标准。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-03T00:31:10.987

由于“彗星”是任何使用现有 http 协议来模拟数据推送的人为术语，我担心您无能为力。

唯一的解决方案是对当前协议的“增强”或一些广泛使用的可能基于插件的解决方案......你可以使用 java。但这会引发其他问题，因为基本上您需要在该浏览器上提供传入连接。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-03T00:43:22.783

Comet 可以实现为一个长轮询 ajax 调用，所以它成为一个语义问题。 [例如，这里是一个 jquery 插件](http://plugins.jquery.com/project/Comet)，它在 jQuery 的 ajax 调用上使用 Bayeux 协议实现 Comet。

# python - Python，SimPy：如何从三角概率分布中生成一个值？

> ID：815969
> 
> 赞同：7
> 
> 时间：2009-05-03T00:14:53.663
> 
> 标签：python, distribution, probability, simpy

我想运行一个模拟，它使用从具有下限 A、模式 B 和上限 C 的三角概率分布生成的值作为参数。如何在 Python 中生成这个值？这个分布有没有像 expovariate(lambda) （随机）这样简单的东西，还是我必须编写这个东西？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-03T00:30:52.737

如果你下载 NumPy 包，它有一个函数 numpy.random.triangular(left, mode, right[, size]) 完全符合你的要求。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-03T02:55:44.790

因为，我从 Python 2.4 检查 random 的文档，所以我错过了这个：

***random.triangular(low, high, mode)****返回一个随机浮点数 N 使得 low <= N <= high 并且在这些边界之间具有指定的模式。下限和上限默认为零和一。mode 参数默认为边界之间的中点，给出对称分布。 **2.6 版中的新功能**。*

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-28T20:49:34.227

假设您的分发不是由 NumPy 或 Python 标准库处理的。

在性能不是很重要的情况下，拒绝抽样是一种有用的技巧，可以从你没有的分布中使用你有的分布中抽取。

对于您的三角形分布，您可以执行类似的操作

```
from random import random, uniform

def random_triangular(low, high, mode):
    while True:
        proposal = uniform(low, high)
        if proposal < mode:
            acceptance_prob = (proposal - low) / (mode - low)
        else:
            acceptance_prob = (high - proposal) / (high - mode)
        if random() < acceptance_prob: break
    return proposal 
```

您可以绘制一些样本

```
pylab.hist([random_triangular(1, 6, 5) for t in range(10000)]) 
```

确保一切正常。

# html - 如何在搜索结果中创建特殊链接？

> ID：815973
> 
> 赞同：13
> 
> 时间：2009-05-03T00:16:48.527
> 
> 标签：html, seo

您如何创建在搜索结果中的站点下显示的特殊链接？假设我在*Google*搜索*Stack Overflow*，我得到的结果接近： *![替代文字](https://i.stack.imgur.com/RE3nB.jpg)*

 *我要询问的链接在上图中用红色标出。您在页面中放置了什么以使它们显示在搜索结果中，或者它们是如何创建的？

谢谢，

布雷特

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-03T00:35:35.207

它们被称为附加链接。这就是谷歌自己对它们的评价：[谷歌如何编译一些搜索结果下方显示的链接列表？](http://www.google.com/support/webmasters/bin/answer.py?answer=47334)

还可以查看 Matt Cutts 关于[搜索结果结构的](http://googlewebmastercentral.blogspot.com/2007/11/anatomy-of-search-result.html)简短介绍。

[Vanessa Fox 提供了有关它们如何工作以及您可以做些什么来影响它们的最详细信息](http://www.ninebyblue.com/blog/google-webmaster-central-sitelinks-historical-query-stats-and-surprises/)。

### 主要来自 Vanessa Fox 的博文总结：

Google 会自动生成它们，主要基于易于抓取、相关的内部链接以及您网站主页上的短标题。它们只会出现在第一个搜索结果中，并且只有在 Google 认为它们有用时才会出现。最多可以有 8 个附加链接。

[正如谷歌支持页面所说，你可以在他们的网站管理员工具](http://www.google.com/webmasters/tools)中为你的网站查看它们，并阻止那些你不喜欢的。你不能自己添加任何东西。

[最近的网站管理员中心博客文章](http://googlewebmastercentral.blogspot.com/2009/04/one-line-sitelinks.html)补充说，单行最多 4 个附加链接可以出现在比现在第一个更多的结果上。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-11-11T04:35:41.323

这是谷歌在搜索结果中显示的对用户有帮助的特殊链接。当您的网站信息丰富且优化良好时，它由谷歌创建。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-03T22:56:55.900

无法选择您网站上的哪些页面用作网站链接。但是，您可以像其他人所说的那样注册 Google 的网站管理员工具，并阻止可能为您的网站显示的网站链接，直到它可以显示您想要的页面。我注意到 Google 似乎会显示较大网站的附加链接。

当您确实选择阻止 URL 显示为站点链接时，重要的是要知道它们不会永远被阻止。他们有一个区块到期日期，所以你需要监控它。

# c# - 如何通过 NHibernate 关联 2 个类？

> ID：815976
> 
> 赞同：2
> 
> 时间：2009-05-03T00:21:45.677
> 
> 标签：c#, nhibernate, nhibernate-mapping

假设我有一个类“用户”，它“有”一个“配置文件”类型的属性。如何配置我的映射以生成架构并在数据库中创建两个表？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-03T02:12:06.610

```
<many-to-one/> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-03T12:01:52.950

顺便说一句，如果您不是编写休眠映射脚本的忠实粉丝（我不是），那么您还有其他几个选择。

[Castle ActiveRecord](http://www.castleproject.org/activerecord/index.html)是一种替代方案 - 它是 NHibernate 之上的一个层，它（除其他外）允许您使用类和属性上的属性来声明您的关系。

[Fluent NHibernate](http://wiki.fluentnhibernate.org/show/GettingStarted%3A+Introduction)是另一个——它可以让你以编程方式设置你的类和关系。

与手动编写映射 xml 相比，两者都是一个很大的改进！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-03T00:40:15.927

如果您询问映射，可以使用如下所示的连接。注意：您显然必须添加一些额外的属性以适合您的应用程序。

```
 <?xml version="1.0" encoding="utf-8" ?>
   <hibernate-mapping xmlns="urn:nhibernate-mapping-2.2"    namespace="MyNamespace" assembly="MyAssembly"    default-lazy="true">  
   <class name="User" table="User">    
   <id name="Id" column="user_id" unsaved-value="0">      
   <generator class="native" />    
   </id>    
   <property name="Profile" column="profile" />  
   </class>
   </hibernate-mapping>

   <?xml version="1.0" encoding="utf-8" ?>
   <hibernate-mapping xmlns="urn:nhibernate-mapping-2.2"    namespace="MyNamespace" assembly="MyAssembly"    default-lazy="true">  
   <class name="Profile" table="Profile">    
   <id name="Id" column="profile_id" unsaved-value="0">      
   <generator class="native" />    
   </id>    
   <property name="Profile" column="profile" />    
   </class>
   </hibernate-mapping> 
```

# ruby - 如何在使用 each_char 时跟踪迭代次数？

> ID：815977
> 
> 赞同：1
> 
> 时间：2009-05-03T00:22:21.510
> 
> 标签：ruby, binary, decimal, iteration

我正在学习 Ruby，并想制作一个 Binary->Decimal 转换器。它获取一个二进制字符串并转换为等效的十进制。有没有办法跟踪 ruby​​ 中的当前迭代步骤，以便可以删除变量“x”？

```
def convert(binary_string)
    decimal_equivalent = 0
    x=0   
    binary_string.reverse.each_char do |binary|
      decimal_equivalent += binary.to_i * (2 ** x)
    x+=1
    end

   return decimal_equivalent
end 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-03T01:44:00.797

是的，通过使用非常强大的枚举器库：

```
require 'enumerator'
def convert(binary_string)
  decimal_equivalent = 0
  binary_string.reverse.enum_for(:each_char).each_with_index do |binary, i|
    decimal_equivalent += binary.to_i * (2 ** i)
  end
  return decimal_equivalent
end 
```

顺便说一句，您可能对`Array#pack`和感兴趣`String#unpack`。他们支持位串。此外，获得此结果的更简单方法是使用`#to_i`，例如`"101".to_i(2) #=> 5`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-03T00:37:50.503

```
binary_string.reverse.chars.each_with_index do |binary, i|
  decimal_equivalent += binary.to_i * (2 ** i)
end 
```

或者在早于 1.8.7 的版本上：

```
binary_string.reverse.split(//).each_with_index do |binary, i|
  decimal_equivalent += binary.to_i * (2 ** i)
end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-12-03T13:54:47.507

对于从谷歌找到这个答案的人（比如我），

这是在 ruby​​ 中转换二进制 -> 十进制的简单方法（然后再返回）：

```
# The String.to_i function can take an argument indicating
# the base of the number represented by the string.
decimal = '1011'.to_i(2)
# => 11

# Likewise, when converting a decimal number, 
# you can provide the base to the to_s function.
binary  = 25.to_s(2)
# => "11001"

# And you can pad the result using right-justify:
binary  = 25.to_s(2).rjust(8, '0')
# => "00011001" 
```

# ruby-on-rails - 使用 HTTP 动词在控制器内生成链接

> ID：815980
> 
> 赞同：0
> 
> 时间：2009-05-03T00:23:47.557
> 
> 标签：ruby-on-rails

使用 Rails 中的宁静资源，我希望能够在我的闪存哈希中插入一个链接，用户可以单击该链接来销毁相关对象。唯一的问题似乎是我无法让生成的链接与 RESTful 控制器一起使用！

首先我试过

```
link_to "Change your reservation", reservation_path(@existing_reservation), :method => :delete 
```

这不起作用，因为 link_to 是 ActionView 中的辅助方法，在控制器中不可用

下一个发现是 url_for

```
url_for :controller => 'reservations', :actions => 'destroy', :method => :delete 
```

这让我回到了表演动作。我已经尝试了我能找到的两者的每一种组合。. . 但我似乎无法在我的控制器中创建一个链接，该链接将滑入删除方法！我生成的每个操作都会生成一个普通链接 (GET)，它调用 show 方法。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-10T14:05:26.200

`ApplicationController.helpers.link_to`将允许您在控制器中使用辅助方法，尽管我不确定这是否严格遵循 MVC。虽然偶尔我发现了一个需要，即调用`number_to_currency`.

当您在该特定帮助程序中使用 :delete 选项时，会出现另一个问题。它会失败。快速浏览一下源代码后，我真的看不到立即修复。

首先，如果可能，我建议您将删除链接放在该页面的其他位置。如果你*真的*需要在 flash 中使用它，你可以在视图中修改 flash。

即在控制器中设置闪光灯：

```
flash[:notice] = "Flash message with a  DELETE LINK in it" 
```

然后在视图中修改该闪光灯，然后再显示它：

```
<%=  flash[:notice].gsub(/DELETE LINK/, link_to("delete", resource_path, :method => :delete)) %> 
```

你可能只想把它变成你自己的助手。如果您不喜欢像这样对文本进行 gsub-ing，我相信您可以找到另一种方法，那么将链接附加到 flash 怎么样？

希望有帮助:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-03T09:28:11.463

尝试仅传递对象本身，而不是使用路径，例如

```
link_to "Change your reservation", @existing_reservation, :method => :delete 
```

# asp.net - 加密会话对象

> ID：815985
> 
> 赞同：2
> 
> 时间：2009-05-03T00:27:09.267
> 
> 标签：asp.net, session, encryption

首先：我正在开发一个接受信用卡的电子商务网站。为了从“输入您的信息”页面到“确认您的信息”页面，我需要将信用卡信息存储在某个可以检索的位置，然后才能最终发送到支付网关。

我目前倾向于将其存储为会话变量。话虽如此，我的问题是：

1.  我是否通过将其存储在会话中来犯一些众所周知的安全失礼？
2.  会话对象是全局的吗？如果两个人同时提交他们的信息，一个人的会话是否可以为另一个人的交易返回？
3.  .NET 中是否有一种通用的方法来加密/解密会话对象以获得额外的安全性？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-03T00:34:23.383

从 ui/workflow 的角度来看，确实不需要存储信用卡信息或确认它。如果是错误的，将不会被批准。大多数电子商务网站在确认地址、电话等后的最后一步都会要求提供信用卡号。

至于会话，会话对于特定会话是全局的。它不被其他用户共享，一般来说，没有任何方法可以获取其他会话中的数据。因此，无需对其进行加密，因为它存储在服务器上。

如果您将敏感信息存储在 ViewState 中或通过 QueryString 传递，您肯定需要对其进行加密。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-05-03T00:44:01.597

申请信用卡是销售过程的最后一步。但如果要加密，请使用对称 AES (rinjdael) 加密。为了使用一个非常难以猜测的密钥，随机创建它并将其存储在会话中。如果您使用的是无 cookie 会话，除非您需要，否则两者都不会离开服务器。

几乎所有语言都有 AES 库版本。在 .NET 中有包含在 System.Security.Cryptography

```
using System.Security.Cryptography; 
```

# c# - Digg 风格的 Ajax 投票按钮

> ID：815988
> 
> 赞同：1
> 
> 时间：2009-05-03T00:28:33.083
> 
> 标签：c#, asp.net, ajax

想知道是否有人知道如何使用 ASP.NET AJAX 制作 digg 风格的 ajax 投票按钮。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-03T01:03:55.777

不知道你的知识水平很难回答你的问题。为了实现这种东西，你需要一些通用组件：

1.  您需要一个实现“投票”概念的“Web 服务”——您使用诸如 ASP.Net MVC、带有 WebForms 的 ASP.Net 或其他方法之类的框架来实现此 Web 服务。调用 Web 服务时，它将增加或减少投票计数
2.  您使用客户端 AJAX 库，例如 JQuery，或使用 ASP.Net 中对 Web 服务客户端代码的内置支持 - 此代码在浏览器中运行 - 您需要连接此代码，以便用户选择投票时按钮，客户端代码调用您的 Web 服务来增加或减少投票。

笼统地说，差不多就是这样。这种东西的写作并不太难，你必须知道所有的部分在哪里以及如何让所有的球保持在空中，它应该落到适当的位置。

# c++ - Visual Studio - 使用从现有源创建项目向导时使用新筛选器而不是新文件夹

> ID：815993
> 
> 赞同：15
> 
> 时间：2009-05-03T00:30:48.413
> 
> 标签：c++, visual-studio, visual-studio-2008

我使用了 Visual Studio 2008 的从现有代码向导创建项目，但显然以这种方式创建的项目不允许您创建虚拟解决方案文件夹，而只允许您创建实际的系统文件夹。我想要头文件、资源文件和源文件的标准项目设置，但我似乎无法创建所需的虚拟文件。有什么方法可以更改项目以允许创建虚拟文件夹？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-05-03T01:19:48.233

至少对于以这种方式创建的 C++ 项目（不确定其他语言），解决方案资源管理器中的“显示所有文件”按钮/选项已启用，它提供了您所看到的行为。

通过单击图标禁用该选项，您将获得您正在寻找的行为。

# vim - 无法在 Vim 中的文件之间快速移动

> ID：815997
> 
> 赞同：1
> 
> 时间：2009-05-03T00:31:32.093
> 
> 标签：vim, performance, editing

我的 .Zshrc 中有以下内容

```
. /Users/Masi/bin/Zsh/prompt 
```

我需要运行以下代码才能从 .zshrc 访问文件

```
 Ctrl-Z 
    vim ~/bin/Zsh/prompt 
```

我尝试通过首先在可视模式下突出显示路径并运行来做同样的事情，但没有成功

```
:'<,'>!vim 
```

**如何在 Vim 中的文件之间快速移动？**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-03T00:42:41.087

如果你打开了 vim，你可以使用`:e <filepath>`命令打开一个文件进行编辑。

如果你想在同一个 vim 会话中同时打开多个文件，你可以使用 windows。您可以使用 打开新窗口`Ctrl-W n`，然后使用`:e <filepath>`在新窗口中打开文件。对你来说，找到一个关于如何使用 windows 的教程可能比我在这里做一个糟糕的工作来解释如何更好。不过，它们并不太难使用。

另一种选择是为每个文件创建一个单独的 vim 会话，然后根据需要使用作业处理循环浏览它们。我不熟悉 zsh 语法，但是在 bash 中，您可以按`Ctrl-Z`暂停当前正在运行的作业并返回命令行，并恢复一个作业，`fg %n`其中 n 是您要恢复的作业编号。因此，您可以使用这些来使用 vim 打开文件 1、暂停 vim、使用新的 vim 会话打开文件 2、暂停它，并根据需要来回交替暂停和前景化。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-03T01:01:06.220

我想您可能正在寻找`gf`Vim 中的命令，该命令会打开以光标位置命名的文件。此命令在同一窗口中打开文件，替换您之前编辑的任何文件。如果要打开一个带有光标下文件的新窗口，请使用 ^Wf。

另请参阅问题[How do you return from 'gf in Vim](https://stackoverflow.com/questions/133626/how-do-you-return-from-gf-in-vim)以获取有关文件导航的更多信息。

# haskell - LLVM 与 C-- ；对于 Haskell，LLVM 从根本上怎么可能不比 C 更好——？

> ID：815998
> 
> 赞同：28
> 
> 时间：2009-05-03T00:32:52.543
> 
> 标签：haskell, llvm, clang, ghc, c-minus-minus

我一直对[LLVM](http://en.wikipedia.org/wiki/LLVM)低到可以对任何系统建模感到兴奋，并认为 Apple 正在采用它。但话又说回来，Apple 并没有特别支持[Haskell](http://en.wikipedia.org/wiki/Haskell_%28programming_language%29)；

而且，有些人认为 Haskell 使用[C--](https://en.wikipedia.org/wiki/C--)会更好：

> LLVM'ers 没有解决零开销垃圾收集的问题并不令人惊讶。在不知道数据模型的情况下解决这个问题是计算机科学中的一个悬而未决的问题。

-- [LHC 不会使用 LLVM。](http://lhc-compiler.blogspot.com/2009/01/why-llvm-probably-wont-replace-c.html)

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2011-04-17T08:30:45.060

在对操纵 C-- 的新代码生成后端进行了一些研究之后，我可以说 C-- 比 LLVM 更好的原因有很多，以及为什么它们根本不是一回事。

1.  C——在比 LLVM 更高的抽象层次上运行；例如，我们可以在 C 中生成代码——其中堆栈指针是完全隐式的，并且仅在编译过程的后期才显示出来。这使得应用某些类型的优化变得更加容易，因为更高级别的表示允许更多的代码运动和更少的不变量。

2.  虽然我们正在积极寻求解决这个问题，但 LLVM 遇到了与 via-C 后端相同的问题：它需要我们创建*proc 点。*什么是触发点？本质上，因为 Haskell 不使用经典的 call/ret 调用约定，所以每当我们进行子过程调用的道德等价物时，我们需要将延续压入堆栈然后跳转到子过程。这个延续通常是一个本地标签，但 LLVM 要求它是一个实际的过程，所以我们需要将函数分解成更小的部分（每个部分称为 proc 点）。这对于在过程级别起作用的优化来说是个坏消息。

3.  C-- 和 LLVM 采用不同的方法来优化数据流。LLVM 使用带有 phi 节点的传统 SSA 样式：C-- 使用一个名为 Hoopl 的酷框架，它不需要您维护 SSA 不变量。我可以确认：Hoopl 中的编程优化很有趣，尽管某些类型的优化（想到一次性使用的变量的内联）在这种数据流设置中并不是最自然的。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2009-05-03T00:54:57.093

嗯，UNSW 有一个项目将 GHC Core 翻译成 LLVM

请记住：10 年前还不清楚 LLVM 是否会构建 C 无法构建的所有基础架构。不幸的是，LLVM 具有可移植、优化代码的基础设施，但没有 C-ha(s)d 的良好高级语言支持的基础设施。

一个有趣的项目是从*C*中定位 LLVM ——...

* * *

*更新*，从 GHC 7 开始，[GHC 使用 LLVM 进行代码生成](http://www.haskell.org/pipermail/cvs-ghc/2010-February/052606.html)。使用`-fllvm`旗帜。这提高了一些低级程序的数值性能。否则，性能类似于旧的 GCC 后端。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2010-03-30T17:42:04.737

GHC 现在正式拥有一个 LLVM 后端，事实证明它可以[与 GCC 和 native-codegen 竞争，并且在某些情况下实际上更快](http://donsbot.wordpress.com/2010/02/21/smoking-fast-haskell-code-using-ghcs-new-llvm-codegen/)。并且 LLVM 项目[已经接受了 David Terei 在 LLVM 上为 Haskell 创建的新调用约定](http://osdir.com/ml/cvs-ghc@haskell.org/2010-03/msg00152.html)，令人惊讶的是，这两个项目现在实际上正在协同工作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-12-02T05:48:00.147

实践中的一个问题是 LLVM 更像是一个移动目标。

GHC 在尝试支持多个版本的 LLVM 时遇到了一些麻烦。ghc-dev 邮件列表上对此进行了积极[讨论。](https://www.haskell.org/pipermail/ghc-devs/2014-November/007469.html)

顺便说一句，目前 ghc 中的 llvm 后端是在将 Haskell 翻译成 cmm 语言之后（我相信这主要是 C——用 STG 语言的某些寄存器扩展），并且由于上述待解决的困难，正在进行冗余优化，这会减慢编译速度。

此外，从历史和目前的 AFAIK 来看，LLVM 项目并不优先考虑提供可移植平台，一些开发人员已经明确表示它[是编译器 IR，而不是可移植汇编语言的一种形式](http://lists.cs.uiuc.edu/pipermail/llvmdev/2011-October/043719.html)。

您为一个预期目标编写的 LLVM IR 对于不同的预期目标可能根本没有用。为了比较，C-- 网站实际上将其称为便携式程序集。“你会更喜欢一种可移植的汇编语言，它可能是……”是[他们网站上](http://www.cminusminus.org)的一句话。该网站还提到了一个运行时接口，以简化垃圾收集和异常处理的可移植*实现*。

因此，您可以将 C 视为所有前端的可移植公共基础，与 CIL 和 Java 字节码和 LLVM IR 有更多共同点，作为所有后端的表达性公共基础，有助于统一低多个目标共有的级优化。LLVM IR 还提供了额外的好处，即 LLVM 项目将实现许多低级优化。话虽如此，在某些方面 LLVM IR 实际上可以被认为比 C 更高级别——例如，LLVM IR 具有不同的类型，而在 C 中——一切都只是位向量。*****