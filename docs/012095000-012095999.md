# StackOverflow 问答 12095000-12095999

# django - mongo 引擎序列字段（如何获取下一个值）

> ID：12095001
> 
> 赞同：0
> 
> 时间：2012-08-23T15:21:23.977
> 
> 标签：django, mongoengine

我有一个使用 mongoengine + mongodb 作为后端的文档。我想获得下一个可用的柜台。

```
class Master(Document):
    mas_id = SequenceField(required=True, primary_key=True) 
```

在文件中有3条记录。有没有我能找到下一个计数器，即 4。这里不需要 count + 1。

有表 mongoengine.counters 但无法访问它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T16:19:03.950

您可以通过 pymongo 查询它，或者如果您没有删除任何内容，那么 max `mas_id`+ 1 是序列中的下一个，这是什么/如何要求以及您要做什么？

# php - 红宝石相当于 php snoopy

> ID：12095012
> 
> 赞同：1
> 
> 时间：2012-08-23T15:21:52.743
> 
> 标签：php, ruby, snoopy

[PHP Snoopy](http://sourceforge.net/projects/snoopy/)是否有 Ruby 等价物？Snoopy 是一个提供 Web 浏览器功能的 PHP 类。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T15:30:39.520

我是[机械化](http://mechanize.rubyforge.org/)的粉丝。[这里有一些例子](http://mechanize.rubyforge.org/EXAMPLES_rdoc.html)。

# php - yii 查询后分配动态属性

> ID：12095013
> 
> 赞同：1
> 
> 时间：2012-08-23T15:21:53.383
> 
> 标签：php, mysql, yii

我有一个 Yii 查询：

```
$criteria->select = 't.baniid,SUM(t.impression) AS impression, SUM(t.`unique`) AS `unique`, IFNULL((SELECT SUM(clicks) FROM _clicksdaily WHERE baniid=t.baniid GROUP BY baniid), "0") AS clicks';
$criteria->group = 't.baniid'; 
```

查询运行良好并取回所有参数。问题是印象模型没有`click`属性并且它没有显示为属性（所以我不能在小部件中使用它）......

知道如何从 SQL 查询中分配另一个属性吗？（我添加了公共 $clicks，但它不起作用）。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T17:39:16.543

`public $clicks`似乎对我有用。

在您的模型中：

```
public $clicks;
public function scopes() {
    return array(
        'clicks' => array(
            'select' => 't.baniid,SUM(t.impression) AS impression, SUM(t.`unique`) AS `unique`, IFNULL((SELECT SUM(clicks) FROM _clicksdaily WHERE baniid=t.baniid), 0) AS clicks',
            'group ' => 'baniid',
        ),
    );
} 
```

然后使用它：

```
$firstModel = MyModel::model()->clicks()->find();
echo $firstModel->clicks; 
```

# cuda - 对 GPU 内存带宽的概念理解

> ID：12095015
> 
> 赞同：2
> 
> 时间：2012-08-23T15:21:57.470
> 
> 标签：cuda

我对 GPU 的内存带宽的概念有点困惑。

根据**[TESLA M 2090](http://www.nvidia.com/docs/IO/105880/DS-Tesla-M-Class-Aug11.pdf)** GPU 规格，峰值带宽为 177.6 GB/s。

所以当人们提到带宽时，它是指

*   单向流量的速度，例如每秒可以从设备**读取的字节数**

*   双向流量的速度，例如每秒可以读取**和**写入设备内存的字节数。

无论我在哪里读到这个术语，我都没有看到这个澄清

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T15:49:45.240

带宽是在给定时间段内可以读取**或写入的数据量。**

相同的总线用于读取和写入。在给定的时钟周期内，总线可用于读取或写入。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T15:50:55.510

总线上只有一组导线，因此不能同时写入或读取数据。理论上带宽是一样的，总读+写==总读==总写。

但实际上，如果您将大量连续数据块写入设备，则传输效率更高，这是最常见的用法，也是系统优化的目标。

编辑。显卡的内存带宽（即显卡上各个组件之间的内存路径）远高于进出计算机的带宽。

它也更复杂，有不同类型的内存以不同的方式连接到不同的处理器，制造商会选择使它听起来最高的数字 - 这个数字真的没有意义，除了比较来自同一卡的不同型号的非常相似的卡GPU 家族。

# tomcat - 詹金斯在运行 maven 时出现权限被拒绝错误

> ID：12095016
> 
> 赞同：5
> 
> 时间：2012-08-23T15:21:57.447
> 
> 标签：tomcat, maven-2, jenkins, redhat, selenium-webdriver

我在 redhat linux 机器上运行 Jenkins。我的构建是一个包含 selenium 测试的 maven 2.2.1 项目。我在一个运行良好的 ubuntu 机器上进行了相同的设置，但是当我尝试在我的 redhat VM 上调用相同的顶级 maven 命令时，我收到以下错误。

```
org.apache.maven.surefire.booter.SurefireExecutionException: Unable to create file for report: /var/lib/jenkins/jobs/selenium/workspace/target/surefire-reports/com.MyComp.bio.PreferencesTest.txt (Permission denied); nested exception is java.io.FileNotFoundException: /var/lib/jenkins/jobs/selenium/workspace/target/surefire-reports/com.MyComp.bio.PreferencesTest.txt (Permission denied); nested exception is 
org.apache.maven.surefire.report.ReporterException: Unable to create file for report: /var/lib/jenkins/jobs/selenium/workspace/target/surefire-reports/com.MyComp.bio.PreferencesTest.txt (Permission denied); nested exception is java.io.FileNotFoundException: /var/lib/jenkins/jobs/selenium/workspace/target/surefire-reports/com.MyComp.bio.PreferencesTest.txt (Permission denied)
org.apache.maven.surefire.report.ReporterException: Unable to create file for report: /var/lib/jenkins/jobs/selenium/workspace/target/surefire-reports/com.MyComp.bio.PreferencesTest.txt (Permission denied); nested exception is        
java.io.FileNotFoundException: /var/lib/jenkins/jobs/selenium/workspace/target/surefire-reports/com.MyComp.bio.PreferencesTest.txt (Permission denied)
java.io.FileNotFoundException: /var/lib/jenkins/jobs/selenium/workspace/target/surefire-reports/com.MyComp.bio.PreferencesTest.txt (Permission denied)
at java.io.FileOutputStream.open(Native Method)
at java.io.FileOutputStream.<init>(FileOutputStream.java:212)
at java.io.FileOutputStream.<init>(FileOutputStream.java:165)
at java.io.FileWriter.<init>(FileWriter.java:90)
at org.apache.maven.surefire.report.AbstractFileReporter.testSetStarting(AbstractFileReporter.java:57)
at org.apache.maven.surefire.report.ReporterManager.testSetStarting(ReporterManager.java:219)
at org.apache.maven.surefire.suite.AbstractDirectoryTestSuite.executeTestSet(AbstractDirectoryTestSuite.java:138)
at org.apache.maven.surefire.suite.AbstractDirectoryTestSuite.execute(AbstractDirectoryTestSuite.java:127)
at org.apache.maven.surefire.Surefire.run(Surefire.java:177)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
at java.lang.reflect.Method.invoke(Method.java:601)
at org.apache.maven.surefire.booter.SurefireBooter.runSuitesInProcess(SurefireBooter.java:345)
at org.apache.maven.surefire.booter.SurefireBooter.main(SurefireBooter.java:1009)
[INFO] ------------------------------------------------------------------------
[ERROR] BUILD FAILURE
[INFO] ------------------------------------------------------------------------
[INFO] There are test failures. 
```

在尝试解决这个问题时，我重新启动了 Jenkins

```
sudo service jenkins restart 
```

但它仍然存在。有人遇到过这个吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-10T08:22:58.883

用于`ls -al`显示文件的权限。

有关更多信息，请参阅[此链接](http://www.tuxfiles.org/linuxhelp/filepermissions.html)。

阅读服务启动脚本以检查运行 Jenkins 的用户的名称。

`less /etc/init.d/jenkins`

您可能已经手动将 jenkins 安装到了 Java EE 容器，例如 tomcat6。如果是这种情况，您应该使用：

`less /etc/init.d/tomcat6`

# dotnetnuke - Media Queries in DotNetNuke, mobile enablement

> ID：12095019
> 
> 赞同：0
> 
> 时间：2012-08-23T15:22:11.410
> 
> 标签：dotnetnuke, media-queries

I am starting a new project which requires content managment and have decided to use dotnetnuke which I have never used before and a concern of mine is the use of media queries for mobile devices.

Can I use media queries in a dotnetnuke skin and does anyone have any examples / tutorials of this in use? I have looked everywhere and cant find any information of dotnetnuke utilizing media queries.

Thanks

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T16:23:47.447

There's a [free skin available on the DotNetNuke Store](http://store.dotnetnuke.com/home/product-details/51degreesmobi---free-mobile-skin) that demonstrates some mobile skinning concepts. But, ultimately, you should be able to include media queries in your skin's stylesheet without doing anything special. Is there something specific that you're running up against?

You'll probably want to include a `viewport` `<meta>` tag, which you can do like this:

```
<%@ Register TagPrefix="dnn" TagName="Meta" Src="~/Admin/Skins/Meta.ascx" %> 
<dnn:Meta runat="server" Name="viewport" Content="initial-scale=1.0,width=device-width" /> 
```

# javascript - jquery mobile web app在页面底部留下空白区域

> ID：12095020
> 
> 赞同：4
> 
> 时间：2012-08-23T15:22:11.390
> 
> 标签：javascript, css, jsp, web-applications, jquery-mobile

我有一个当前为 iphone 定制的网络应用程序（我使用了 JQM）。

所有元素都适合页面高度，但我在页面底部得到一个空白。

在 pc 浏览器上查看页面时一切正常，所以我猜这个问题与某些 CSS 文件上的 iphone 屏幕分辨率配置有关。

**请在 iPhone 上查看网页以查看空白（向下滚动）**： [http ://aspspider.org/elimiz/check4/MC_v1.0.htm](http://aspspider.org/elimiz/check4/MC_v1.0.htm)

帮我

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-10T21:31:26.547

我没有在我的 iPhone 上看到这个问题，但这听起来像是我在某个网站上遇到的问题。我通过将所有内容周围的包装器设置为溢出来修复它：隐藏。可能需要一些试验和错误才能找到将它放在哪个元素上，并且您可能需要在没有明确说明高度的元素上定义高度值。

# objective-c - 为什么我的 UIImageView 对象不是实时绘制的？

> ID：12095021
> 
> 赞同：0
> 
> 时间：2012-08-23T15:22:19.477
> 
> 标签：objective-c, ios, uiviewcontroller, uiimageview, drawing

只有在我退出该方法`UIImageView`后，才会在我的 ViewController 的窗口上绘制以下内容。
`-(void)playOn:(UIViewController*) currentViewController`这是为什么？我怎样才能做到这一点，以便我可以在该方法执行*时*从该方法*内部*绘制我的 ViewController ？

 *细胞画家.m

```
-(void)paintGoodCellonViewController:(UIViewController*)playingViewController
{
    int x = 32*(xAxis - 1);
    int y = 384 - (32* yAxis);

    UIImageView* myImageView = [[UIImageView alloc] initWithImage:goodCell];
    myImageView.frame = CGRectMake(x,y, 32, 32);
    [playingViewController.view addSubview:myImageView];
} 
```

游戏.m

```
-(void)playOn:(UIViewController*) currentViewController
{    
    [currentPainter paintGoodCellonViewController:currentViewController];

    while(!self.stopButtonPressed)
    {
        // code...
    }
} 
```

我的视图控制器.m

```
- (IBAction)enterButtonPressed:(UIButton *)sender
{
    [currentGame performSelectorInBackground:@selector(playOn:) withObject:self];
}

- (IBAction)giveUpButtonPressed:(UIButton *)sender
{
    currentGame.stopButtonPressed = YES;

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T15:37:47.153

使用此代码强制`UIView`重绘：

```
[myView setNeedsDisplay]; 
```*

# objective-c - 向 rightBarButtonItems 添加两个按钮不起作用

> ID：12095022
> 
> 赞同：2
> 
> 时间：2012-08-23T15:22:21.043
> 
> 标签：objective-c, ios, cocoa-touch

我不确定为什么以下代码不起作用：

```
UIBarButtonItem *newButton = [[UIBarButtonItem alloc] initWithTitle:@"New" style:UIBarButtonItemStyleBordered target:self action:@selector(newClicked:)];

UIBarButtonItem *shareButton = [[UIBarButtonItem alloc] initWithBarButtonSystemItem:UIBarButtonSystemItemAction target:self action:@selector(share:)];

self.navigationItem.rightBarButtonItems = [NSArray arrayWithObjects:newButton, shareButton, nil]; 
```

它只在导航栏上显示“newButton”UIBarButtonItem，而不是“shareButton”按钮。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-10T07:34:00.000

我发现了一个涉及这种行为的不同问题。

如果您设置了自定义`titleView`( `navigationItem.titleView = ...`)，则导航项有时可以隐藏您的按钮，但第一个按钮除外（如果它没有空间）。

因此，请确保您限制`width`您的自定义`titleView`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-23T15:28:48.367

**rightBarButtonItems**在 ios 5 中。我认为问题出在对象名称`new`上，请将其更改为任何其他名称`newButton`或类似名称。因为 new 是用于`memory` `allocation`in的关键字`C++`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-23T15:28:54.257

看起来问题与受质疑代码之后的代码有关：

```
UILabel *label = [[UILabel alloc] initWithFrame:CGRectMake(0, 0, 400, 44)];
label.backgroundColor = [UIColor clearColor];
label.font = [UIFont fontWithName:@"Marker Felt" size:26.0];
label.shadowColor = [UIColor colorWithWhite:0.0 alpha:0.5];
label.textAlignment = UITextAlignmentCenter;
label.textColor =[UIColor whiteColor];
label.text=self.title;
self.navigationItem.titleView = label;
[label release]; 
```

现在发布这个以防其他人遇到这个问题！

# xml - SOAP XML 信封

> ID：12095025
> 
> 赞同：0
> 
> 时间：2012-08-23T15:22:34.100
> 
> 标签：xml, soap, wsdl

在示例肥皂 XML 请求消息中，我注意到有肥皂信封标记为

```
<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:soapenc="http://schemas.xmlsoap.org/soap/encoding/" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
<Header>
... 
```

可以删除这些标签吗？例如，将肥皂消息更改为，

```
<soapenv:Envelope>
<Header>
... 
```

这是所有肥皂信息都必须具备的标准吗？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T15:28:43.477

需要soap消息，接收端可以使用命名空间来确定soap消息的版本。据我了解，您使用的命名空间表示此消息遵循`Soap 1.1`标准。如果您尝试使用`Soap 1.2`该消息中的功能，服务器很可能会感到困惑。

**肥皂 1.1 标准的第 4.1.2 节**

> SOAP 没有定义基于主要和次要版本号的传统版本控制模型。SOAP 消息必须有一个与“http://schemas.xmlsoap.org/soap/envelope/”命名空间相关联的 Envelope 元素。如果 SOAP 应用程序接收到一条消息，其中 SOAP Envelope 元素与不同的命名空间相关联，则应用程序必须将此视为版本错误并丢弃该消息。如果消息是通过请求/响应协议（例如 HTTP）接收的，应用程序必须使用 SOAP“http://schemas.xmlsoap.org/soap/envelope/”命名空间以 SOAP VersionMismatch 错误代码消息（参见第 4.4 节）进行响应.

[1.1 中的](http://www.w3.org/TR/2000/NOTE-SOAP-20000508/#_Toc478383494)
[肥皂信封 1.2中的肥皂信封](http://www.w3.org/TR/soap12-part1/#soapenv)

# php - PHP，PDO 依靠 mysql

> ID：12095028
> 
> 赞同：0
> 
> 时间：2012-08-23T15:22:46.230
> 
> 标签：php, mysql, count, pdo

我正在尝试使用 PDO（在 MySql 表上）计算项目数。我在某处读到 rowCount 在 MySql 上不起作用。这个对吗？

到目前为止，我肯定无法让它工作，因为我不断得到 count=0。

谁能给我一个想法，这样我就可以避免每次都回到数据库？我有多个与此类似的查询：

```
 $items = $con -> prepare("SELECT * FROM item_descr ORDER BY $sortBy DESC");
    $count = $items -> rowCount();
    $items -> execute();
while($info = $items->fetch(PDO::FETCH_ASSOC)) { ... } 
```

我想尽量避免额外的查询`SELECT COUNT (*)`

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-23T15:24:57.693

您需要*先* `execute`查询。只有这样数据库才能完成它的工作，只有这样你才能获得找到的结果的计数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-23T15:27:50.460

正如@deceze 所指出的，

```
$items = $con -> prepare("SELECT * FROM item_descr ORDER BY $sortBy DESC");
$items -> execute();
$count = $items -> rowCount();
while($info = $items->fetch(PDO::FETCH_ASSOC)) { ... } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-30T20:30:05.350

仅此而已，请参阅 PHP 文档：

> [http://www.php.net/manual/en/pdostatement.rowcount.php](http://www.php.net/manual/en/pdostatement.rowcount.php)

特别：

> 对于大多数数据库，PDOStatement::rowCount() 不返回受 SELECT 语句影响的行数。相反，使用 PDO::query() 发出 SELECT COUNT(*) 语句，其谓词与预期的 SELECT 语句相同，然后使用 PDOStatement::fetchColumn() 检索将返回的行数。然后，您的应用程序可以执行正确的操作。

以及来自所述页面的示例：

```
<?php
$sql = "SELECT COUNT(*) FROM fruit WHERE calories > 100";
if ($res = $conn->query($sql)) {

    /* Check the number of rows that match the SELECT statement */
  if ($res->fetchColumn() > 0) {

        /* Issue the real SELECT statement and work with the results */
         $sql = "SELECT name FROM fruit WHERE calories > 100";
       foreach ($conn->query($sql) as $row) {
           print "Name: " .  $row['NAME'] . "\n";
         }
    }
    /* No rows matched -- do something else */
  else {
      print "No rows matched the query.";
    }
}

$res = null;
$conn = null;
?> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-23T15:25:26.040

`rowCount`仅在`execute`. `rowCount`我在 MySQL中从来没有遇到过问题。

使用`rowCount`很好，但如果您要遍历结果，也可以使用自己的计数器变量。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-23T15:32:26.987

You can simplify your code so much if you are using PDO, such as:

```
$items = $conn->query("SELECT * FROM item_descr ORDER BY $sortBy DESC")->fetchAll(PDO::FETCH_ASSOC);

if(count($items))
{
    // You can count the array to see how many records you got and you can iterate trough it using foreach / for loops 
}
else 
{
    // 0 records returned
} 
```

There is no need for prepared statements in this particular case or checking whether you got any rows back using `rowCount`. It is true that `rowCount` CAN fail even with MySQL, it all depends whether you are using unbuffered queries or not.

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2014-01-31T07:44:15.220

这对我有用：

```
$my_query = $db->query('SELECT COUNT(*) AS Count FROM the_table');
$c = $my_query->fetch(PDO::FETCH_OBJ);

return $c->Count; 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2014-06-16T07:18:09.560

PDOStatement::rowCount() 返回仅受 DELETE、INSERT 或 UPDATE 语句影响的行数。

对于大多数数据库，PDOStatement::rowCount() 不返回受 SELECT 语句影响的行数。相反，使用 PDO::query() 发出 SELECT COUNT(*) 语句，其谓词与预期的 SELECT 语句相同，然后使用 PDOStatement::fetchColumn() 检索将返回的行数。然后，您的应用程序可以执行正确的操作。

# android - 未找到可选项目背景

> ID：12095034
> 
> 赞同：2
> 
> 时间：2012-08-23T15:23:00.197
> 
> 标签：android, button, background

我正在尝试为按钮设置无边框背景（按下时必须突出显示）。为此，我尝试设置：

```
android:background="?android:attr/selectableItemBackground" 
```

（如此[处](https://stackoverflow.com/questions/8855791/how-to-create-standard-borderless-buttons-like-in-the-design-guidline-mentioned)所述）

但得到错误：

```
error: Error: No resource found that matches the given name (at 'background' with value '?android:attr/selectableItemBackground'). 
```

API 级别 1.6，也尝试过 API 2.2

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-10T03:30:53.183

这仅适用于 API 级别 11，即 Android 3.0

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T15:36:06.760

听起来`?android:attr/selectableItemBackground`不是资源而是属性。您必须在属性上指定资源`android:background`。

# r - ggplot 到每个月堆叠条形图前 5 个

> ID：12095038
> 
> 赞同：5
> 
> 时间：2012-08-23T15:23:04.297
> 
> 标签：r, ggplot2

我有一个很好的。我现在考虑这个问题很久了。我有这个数据集，这个数据集可能很大。我想根据每个月的前 5 个最高计数绘制一个 ggplot 堆栈栏。例如，对于 2012 年 1 月 1 日，最高计数将是 I、G、F、D 和 E。

df

```
Date    Desc    count
1/1/2012    A   10
1/1/2012    B   5
1/1/2012    C   7
1/1/2012    D   25
1/1/2012    E   19
1/1/2012    F   30
1/1/2012    G   50
1/1/2012    H   10
1/1/2012    I   100
2/1/2012    A   10
2/1/2012    B   5
2/1/2012    C   7
2/1/2012    D   25
2/1/2012    E   19
2/1/2012    F   30
2/1/2012    G   50
2/1/2012    H   10
2/1/2012    I   100
3/1/2012    A   1
3/1/2012    B   4
3/1/2012    C   5
3/1/2012    D   6
3/1/2012    E   6
3/1/2012    F   7
3/1/2012    G   8
3/1/2012    H   5
3/1/2012    I   10 
```

我有这样的东西，但这绘制了所有值：

```
 ggplot(df, aes(Date, count))+ geom_bar(aes(fill=Desc), stat="identity", position="stack") + theme_bw() 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T16:29:32.500

您必须先对数据进行子集化：

```
library(plyr)
library(ggplot2)
df_top <- ddply(df, .(Date), 
                function(x) head(x[order(x$count, decreasing = TRUE),], 5))
ggplot(df_top, aes(Date, count))+ 
  geom_bar(aes(fill=Desc), stat="identity", position="stack") + 
  theme_bw() 
```

![在此处输入图像描述](../Images/787e1064248786c3a0fdfbf9a51c8b44.png)

# linux - 调整大小时的 SDL 鼠标范围

> ID：12095039
> 
> 赞同：1
> 
> 时间：2012-08-23T15:23:07.863
> 
> 标签：linux, sdl

我正在 Ubuntu 上开发 SDL OpenGL 应用程序，并注意到设置新窗口大小时鼠标范围存在问题。我的应用程序的初始大小是 600x400，鼠标范围 (x,y) 反映了这一点。但是，当用户将屏幕更改为任何其他尺寸（使用给定的预定义尺寸）时，鼠标范围仍然只反映 600x400 的屏幕尺寸，并导致鼠标定位功能出现问题。

为了设置新的分辨率，我调用： `SDL_SetVideoMode(Width, Height, 32, SDL_OPENGL);`据我了解，它应该处理鼠标范围调整大小，但在 Linux 中似乎没有这样做。谁能给我一个解决这个问题的方法？

注意：可能的 hack 似乎是退出 SDL 并使用重新初始化`SDL_Init(SDL_INIT_EVERYTHING);`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T12:07:20.487

经过一番挖掘，我发现问题是我`SDL_GetMouseState(0,0)`后来在尺寸更改后调用，这显然干扰了鼠标范围的重新计算。但是，我已经浏览了 SDL 源代码，但我无法确定这将如何影响它。似乎有一些鼠标状态切换可能导致它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T15:40:22.877

每当我调整窗口大小时，我都会执行以下操作来刷新我的视口：

```
m_ParentWindow = SDL_SetVideoMode( m_width, m_height, m_depth, m_SDL_Vid_Flags );

glViewport(0,0,m_width,m_height);

Clear(); 
```

清除呼叫的地方：

```
glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);
glLoadIdentity(); 
```

# android - 如何为 Arduino ADK 编译 hello world 程序？

> ID：12095041
> 
> 赞同：3
> 
> 时间：2012-08-23T15:23:10.907
> 
> 标签：android, arduino, adk

我要做的就是将 Arduino 编译为 Android 'hello world' 程序，来自“Beginning Android ADK with Arduino”一书。

这是代码

```
#include <Max3421e.h>
#include <Usb.h>
#include <AndroidAccessory.h>

#define ARRAY_SIZE 12

AndroidAccessory acc("Manufacturer", "Model", "Description",
                     "Version", "URI", "Serial");

char hello[ARRAY_SIZE] = {'h','e','l','l','o',' ',
                          'w','o','r','l','d','!'};

void setup() {
  Serial.begin(115200);
  acc.powerOn();
}

void loop() {
  if (acc.isConnected()) {
    for(int x = 0; x < ARRAY_SIZE; x++) {
      Serial.print(hello[x]);
      delay(250);
    }
    Serial.println();
    delay(250);
  }
} 
```

我的错误

```
C:\Users\efossum\arduino-1.0.1\libraries\UsbHost/AndroidAccessory.h: In function 'void setup()':
C:\Users\efossum\arduino-1.0.1\libraries\UsbHost/AndroidAccessory.h:68: error: 'void AndroidAccessory::powerOn()' is private
sketch_aug23a:14: error: within this context 
```

我查看了 AndroidAccessory.h 并确定它是私有的，但是我应该改变什么才能使它工作？我认为使函数 pulic 不是答案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-08T15:50:15.013

它似乎：

```
 acc.powerOn() 
```

可以替换为：

```
 acc.begin(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T03:01:06.247

尝试使用 Arduino 0.22 或 0.23 IDE

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-22T14:43:22.993

答案也可能是在编译期间选择了错误的板。如果您选择了错误的电路板，Arduino 软件将无法确定您拥有的芯片或引脚。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-13T14:56:56.293

我做到了！我只是在标头中公开了`read()`函数的可见性并使用而不是像 Mickaël 说的那样，现在代码编译成功。`<AndroidAccessory.h>``begin()``powerOn()`

# android - Android - 从文件选择器/浏览屏幕返回菜单

> ID：12095045
> 
> 赞同：0
> 
> 时间：2012-08-23T15:23:34.920
> 
> 标签：android, android-intent, filepicker

我在网上找到了这个文件选择器，开发人员说人们可以根据需要使用它。因为我认为代码很容易理解 - 我决定使用它并为我的应用程序稍微改变它。所有功劳归于原始开发人员（[https://github.com/mburman/Android-File-Explore](https://github.com/mburman/Android-File-Explore)）

```
 loadFileList();

    showDialog(DIALOG_LOAD_FILE);
    Log.d(TAG, path.getAbsolutePath());

}

private void loadFileList() {
    try {
        path.mkdirs();
    } catch (SecurityException e) {
        Log.e(TAG, "unable to write on the sd card ");
    }

    // Checks whether path exists
    if (path.exists()) {
        FilenameFilter filter = new FilenameFilter() {
            public boolean accept(File dir, String filename) {
                File sel = new File(dir, filename);
                // Filters based on whether the file is hidden or not
                return (sel.isFile() || sel.isDirectory())
                        && !sel.isHidden();

            }
        };

        String[] fList = path.list(filter);
        fileList = new Item[fList.length];
        for (int i = 0; i < fList.length; i++) {
            fileList[i] = new Item(fList[i], R.drawable.file_icon);

            // Convert into file path
            File sel = new File(path, fList[i]);

            // Set drawables
            if (sel.isDirectory()) {
                fileList[i].icon = R.drawable.directory_icon;
                Log.d("DIRECTORY", fileList[i].file);
            } else {
                Log.d("FILE", fileList[i].file);
            }
        }

        if (!firstLvl) {
            Item temp[] = new Item[fileList.length + 1];
            for (int i = 0; i < fileList.length; i++) {
                temp[i + 1] = fileList[i];
            }
            temp[0] = new Item("Up", R.drawable.directory_up);
            fileList = temp;
        }
    } else {
        Log.e(TAG, "path does not exist");
    }

    adapter = new ArrayAdapter<Item>(this,
            android.R.layout.select_dialog_item, android.R.id.text1,
            fileList) {
        @Override
        public View getView(int position, View convertView, ViewGroup parent) {
            // creates view
            View view = super.getView(position, convertView, parent);
            TextView textView = (TextView) view
                    .findViewById(android.R.id.text1);

            // put the image on the text view
            textView.setCompoundDrawablesWithIntrinsicBounds(
                    fileList[position].icon, 0, 0, 0);

            // add margin between image and text (support various screen
            // densities)
            int dp5 = (int) (5 * getResources().getDisplayMetrics().density + 0.5f);
            textView.setCompoundDrawablePadding(dp5);

            return view;
        }
    };

}

private class Item {
    public String file;
    public int icon;

    public Item(String file, Integer icon) {
        this.file = file;
        this.icon = icon;
    }

    @Override
    public String toString() {
        return file;
    }
}

@Override
protected Dialog onCreateDialog(int id) {
    Dialog dialog = null;
    AlertDialog.Builder builder = new Builder(this);

    if (fileList == null) {
        Log.e(TAG, "No files loaded");
        dialog = builder.create();
        return dialog;
    }

    switch (id) {
    case DIALOG_LOAD_FILE:
        builder.setTitle("Choose your file");
        builder.setAdapter(adapter, new DialogInterface.OnClickListener() {
            public void onClick(DialogInterface dialog, int which) {
                chosenFile = fileList[which].file;
                File sel = new File(path + "/" + chosenFile);
                if (sel.isDirectory()) {
                    firstLvl = false;

                    // Adds chosen directory to list
                    str.add(chosenFile);
                    fileList = null;
                    path = new File(sel + "");

                    loadFileList();

                    removeDialog(DIALOG_LOAD_FILE);
                    showDialog(DIALOG_LOAD_FILE);
                    Log.d(TAG, path.getAbsolutePath());

                }

                // Checks if 'up' was clicked
                else if (chosenFile.equalsIgnoreCase("up") && !sel.exists()) {

                    // present directory removed from list
                    String s = str.remove(str.size() - 1);

                    // path modified to exclude present directory
                    path = new File(path.toString().substring(0,
                            path.toString().lastIndexOf(s)));
                    fileList = null;

                    // if there are no more directories in the list, then
                    // its the first level
                    if (str.isEmpty()) {
                        firstLvl = true;
                    }
                    loadFileList();

                    removeDialog(DIALOG_LOAD_FILE);
                    showDialog(DIALOG_LOAD_FILE);
                    Log.d(TAG, path.getAbsolutePath());

                }

                // File picked
                else {
                    chosenFile = fileList[which].file;
                    File test = new File(path + "/" + chosenFile);

                    sendback(test);

                }
            }
        });
        break;
    }
    dialog = builder.show();
    return dialog;
} 
```

对不起，如果它有点太长了。但这就是 onCreate() 中的整个文件选择器。我使用以下代码打开它：

```
Bundle b = new Bundle();
            b.putInt("tallet", 1);
            Intent i = new Intent(getApplicationContext(), FileExplore.class);
            i.putExtras(b);
            startActivityForResult(i, 0); 
```

该代码完美运行。但是当我按“返回”（onBackPressed）时，如果我说完成（），它会给我空白（黑色）屏幕；. 现在我正在使用这段代码：

```
@Override
public void onBackPressed() {
    // TODO Auto-generated method stub
    super.onBackPressed();

    Intent backIntent = new Intent(FileExplore.this, AndroidTabLayoutActivity.class);
     startActivity(backIntent); 
} 
```

**这实际上有效，但是如果我按一次后退**，然后再按一次菜单，当我再次按后退按钮时，它会给我黑屏。**编辑：**它在第二次后按时进入 onBackPressed 代码，而不是第一次。

这是我在 PhotosActivity 中的 onActivityResult 代码（它是一个选项卡布局 - photosactivity 只是其中一个屏幕）：

```
 @Override
    protected void onActivityResult(int requestCode, int resultCode, Intent data) {
        // TODO Auto-generated method stub
        super.onActivityResult(requestCode, resultCode, data);

        //  Bundle b = getIntent().getExtras();

        if (resultCode == -1) 
        {
         Bundle b =  data.getBundleExtra("FiletoPhoto");

                int knappen = b.getInt("number");
            String titlen = b.getString("title");
                        {
                            Listofsounds los = new Listofsounds();
                        String shortname    = los.puttextonit(titlen, knappen);

                    putnameinit(shortname,knappen);
                        }
        }
        else if (resultCode == 0)
        {
            //If I press "back" i've made the resultCode to be 0 in the onBackPressed. What should I do here then?
        }

    } 
```

我应该怎么做才能按一次它并返回菜单？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T16:21:55.283

问题是当您使用此代码时：

```
 Intent backIntent = new Intent(FileExplore.this, AndroidTabLayoutActivity.class);
 startActivity(backIntent); 
```

您基本上是在创建并启动一个已经存在的 AndroidTabLayoutActivity 的新活动，因此现在将同时运行此活动的两个副本。但是，原始活动将期待您调用 startActivityForResult() 的结果。我认为解决您的问题的方法可能是检查您作为 onActivityResult 返回的 resultCode 是否为 RESULT_OK 或您在 FileExplore 的 setResult(...) 中设置的任何成功的 resultCode。

这真的很奇怪，因为在我的所有应用程序中我都没有覆盖 onBackPressed，但是，我能够完成活动而不会造成任何奇怪的副作用。

# oracle - Jackrabbit 配置的类 org.apache.jackrabbit.core.persistence.pool.OraclePersistenceManager 不包含名为 tableSpace 的属性

> ID：12095046
> 
> 赞同：3
> 
> 时间：2012-08-23T15:23:40.123
> 
> 标签：oracle, oracle11g, jackrabbit, jcr

我尝试使用带有 Oracle DB 的 Jackrabbit 作为持久层。因此，我在 Tomcat 6 服务器（本地）上安装了 Jackrabbit。数据库在虚拟机中运行。从 Jackrabbits 项目页面安装 war 文件后，我使用了默认安装机制。之后我更改了配置（repository.xml）并删除了所有文件夹（工作区和存储库）。所以我的 Jackrabbit 文件夹只包含 repositry.xml 和 bootstrap.properties。

这是我的repository.xml

```
<Repository>
    <FileSystem class="org.apache.jackrabbit.core.fs.db.OracleFileSystem">
        <param name="driver" value="oracle.jdbc.driver.OracleDriver"/>
        <param name="url" value="jdbc:oracle:thin:@localhost:1521:XE"/>
        <param name="user" value="JCR" />
        <param name="password" value="test"/>
        <param name="schema" value="oracle"/>
    </FileSystem>
    <DataStore class="org.apache.jackrabbit.core.data.db.DbDataStore">
        <param name="driver" value="oracle.jdbc.driver.OracleDriver"/>
        <param name="url" value="jdbc:oracle:thin:@localhost:1521:XE"/>
        <param name="user" value="JCR" />
        <param name="password" value="test"/>
    </DataStore>
    <Security appName="Jackrabbit">
        <SecurityManager class="org.apache.jackrabbit.core.DefaultSecurityManager" workspaceName="security">
        </SecurityManager>
        <AccessManager class="org.apache.jackrabbit.core.security.DefaultAccessManager">
        </AccessManager>

        <LoginModule class="org.apache.jackrabbit.core.security.authentication.DefaultLoginModule">
           <param name="anonymousId" value="anonymous"/>
           <param name="adminId" value="admin"/>
        </LoginModule>
    </Security>

    <Workspaces rootPath="${rep.home}/workspaces" defaultWorkspace="default"/>
    <Workspace name="${wsp.name}">
        <FileSystem class="org.apache.jackrabbit.core.fs.db.OracleFileSystem">
            <param name="driver" value="oracle.jdbc.driver.OracleDriver"/>
            <param name="url" value="jdbc:oracle:thin:@localhost:1521:XE"/>
            <param name="user" value="JCR" />
            <param name="password" value="test"/>
            <param name="schemaObjectPrefix" value="${wsp.home}_"/>
        </FileSystem>
        <PersistenceManager class="org.apache.jackrabbit.core.persistence.pool.OraclePersistenceManager">
            <param name="url" value="jdbc:oracle:thin:@localhost:1521:XE"/>
            <param name="user" value="JCR" />
            <param name="password" value="test"/>
            <param name="tableSpace" value=""/>
            <param name="externalBLOBs" value="false"/>
            <param name="schemaObjectPrefix" value="${wsp.home}_"/>  
        </PersistenceManager>
        <SearchIndex class="org.apache.jackrabbit.core.query.lucene.SearchIndex">
            <param name="path" value="${wsp.home}/index"/>
            <param name="supportHighlighting" value="true"/>
        </SearchIndex>
    </Workspace>

    <Versioning rootPath="${rep.home}/version">
        <FileSystem class="org.apache.jackrabbit.core.fs.db.OracleFileSystem">
            <param name="driver" value="oracle.jdbc.driver.OracleDriver"/>
            <param name="url" value="jdbc:oracle:thin:@localhost:1521:XE"/>
            <param name="user" value="JCR" />
            <param name="password" value="test"/>
        </FileSystem>
        <PersistenceManager class="org.apache.jackrabbit.core.persistence.pool.OraclePersistenceManager">
            <param name="url" value="jdbc:oracle:thin:@localhost:1521:XE"/>
            <param name="user" value="JCR" />
            <param name="password" value="test"/>
            <param name="tableSpace" value=""/>
            <param name="externalBLOBs" value="false"/>
            <param name="schemaObjectPrefix" value="version_"/>
        </PersistenceManager>
    </Versioning>

    <SearchIndex class="org.apache.jackrabbit.core.query.lucene.SearchIndex">
        <param name="path" value="${rep.home}/repository/index"/>
        <param name="supportHighlighting" value="true"/>
    </SearchIndex>
</Repository> 
```

使用此配置，我在启动 tomcat 时遇到以下异常：

```
javax.jcr.RepositoryException: Cannot instantiate persistence manager org.apache.jackrabbit.core.persistence.pool.OraclePersistenceManager
    at org.apache.jackrabbit.core.RepositoryImpl.createPersistenceManager(RepositoryImpl.java:1353) [jackrabbit-core-2.4.2.jar:2.4.2]
    at org.apache.jackrabbit.core.RepositoryImpl.createVersionManager(RepositoryImpl.java:486) [jackrabbit-core-2.4.2.jar:2.4.2]
    at org.apache.jackrabbit.core.RepositoryImpl.<init>(RepositoryImpl.java:311) [jackrabbit-core-2.4.2.jar:2.4.2]
    at org.apache.jackrabbit.core.RepositoryImpl.create(RepositoryImpl.java:589) [jackrabbit-core-2.4.2.jar:2.4.2]
    at org.apache.jackrabbit.j2ee.RepositoryStartupServlet.createRepository(RepositoryStartupServlet.java:445) [RepositoryStartupServlet.class:na]
    at org.apache.jackrabbit.j2ee.RepositoryStartupServlet.initRepository(RepositoryStartupServlet.java:413) [RepositoryStartupServlet.class:na]
    at org.apache.jackrabbit.j2ee.RepositoryStartupServlet.startup(RepositoryStartupServlet.java:242) [RepositoryStartupServlet.class:na]
    at org.apache.jackrabbit.j2ee.RepositoryStartupServlet.init(RepositoryStartupServlet.java:215) [RepositoryStartupServlet.class:na]
    at javax.servlet.GenericServlet.init(GenericServlet.java:241) [servlet-api-2.5.jar:2.5]
    at org.apache.catalina.core.StandardWrapper.loadServlet(StandardWrapper.java:1206) [catalina.jar:6.0.35]
    at org.apache.catalina.core.StandardWrapper.load(StandardWrapper.java:1026) [catalina.jar:6.0.35]
    at org.apache.catalina.core.StandardContext.loadOnStartup(StandardContext.java:4421) [catalina.jar:6.0.35]
    at org.apache.catalina.core.StandardContext.start(StandardContext.java:4734) [catalina.jar:6.0.35]
    at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:799) [catalina.jar:6.0.35]
    at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:779) [catalina.jar:6.0.35]
    at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:601) [catalina.jar:6.0.35]
    at org.apache.catalina.startup.HostConfig.deployWAR(HostConfig.java:943) [catalina.jar:6.0.35]
    at org.apache.catalina.startup.HostConfig.deployWARs(HostConfig.java:778) [catalina.jar:6.0.35]
    at org.apache.catalina.startup.HostConfig.deployApps(HostConfig.java:504) [catalina.jar:6.0.35]
    at org.apache.catalina.startup.HostConfig.start(HostConfig.java:1317) [catalina.jar:6.0.35]
    at org.apache.catalina.startup.HostConfig.lifecycleEvent(HostConfig.java:324) [catalina.jar:6.0.35]
    at org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:142) [catalina.jar:6.0.35]
    at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1065) [catalina.jar:6.0.35]
    at org.apache.catalina.core.StandardHost.start(StandardHost.java:840) [catalina.jar:6.0.35]
    at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1057) [catalina.jar:6.0.35]
    at org.apache.catalina.core.StandardEngine.start(StandardEngine.java:463) [catalina.jar:6.0.35]
    at org.apache.catalina.core.StandardService.start(StandardService.java:525) [catalina.jar:6.0.35]
    at org.apache.catalina.core.StandardServer.start(StandardServer.java:754) [catalina.jar:6.0.35]
    at org.apache.catalina.startup.Catalina.start(Catalina.java:595) [catalina.jar:6.0.35]
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:1.6.0_33]
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39) ~[na:1.6.0_33]
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25) ~[na:1.6.0_33]
    at java.lang.reflect.Method.invoke(Method.java:597) ~[na:1.6.0_33]
    at org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:289) [bootstrap.jar:6.0.35]
    at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:414) [bootstrap.jar:6.0.35]
Caused by: org.apache.jackrabbit.core.config.ConfigurationException: Configured class org.apache.jackrabbit.core.persistence.pool.OraclePersistenceManager does not contain a property named tableSpace
    at org.apache.jackrabbit.core.config.BeanConfig.newInstance(BeanConfig.java:206) ~[jackrabbit-core-2.4.2.jar:2.4.2]
    at org.apache.jackrabbit.core.RepositoryImpl.createPersistenceManager(RepositoryImpl.java:1340) [jackrabbit-core-2.4.2.jar:2.4.2]
    ... 34 common frames omitted
2012-08-23 16:14:41.657 INFO  [main] RepositoryImpl.java:1060          Shutting down repository...
2012-08-23 16:14:41.662 INFO  [main] RepositoryImpl.java:1165          Repository has been shutdown
2012-08-23 16:14:41.663 ERROR [main] RepositoryStartupServlet.java:250 RepositoryStartupServlet initializing failed: org.apache.jackrabbit.j2ee.ServletExceptionWithCause: Error while creating repository
org.apache.jackrabbit.j2ee.ServletExceptionWithCause: Error while creating repository
    at org.apache.jackrabbit.j2ee.RepositoryStartupServlet.initRepository(RepositoryStartupServlet.java:415) [RepositoryStartupServlet.class:na]
    at org.apache.jackrabbit.j2ee.RepositoryStartupServlet.startup(RepositoryStartupServlet.java:242) [RepositoryStartupServlet.class:na]
    at org.apache.jackrabbit.j2ee.RepositoryStartupServlet.init(RepositoryStartupServlet.java:215) [RepositoryStartupServlet.class:na]
    at javax.servlet.GenericServlet.init(GenericServlet.java:241) [servlet-api-2.5.jar:2.5]
    at org.apache.catalina.core.StandardWrapper.loadServlet(StandardWrapper.java:1206) [catalina.jar:6.0.35]
    at org.apache.catalina.core.StandardWrapper.load(StandardWrapper.java:1026) [catalina.jar:6.0.35]
    at org.apache.catalina.core.StandardContext.loadOnStartup(StandardContext.java:4421) [catalina.jar:6.0.35]
    at org.apache.catalina.core.StandardContext.start(StandardContext.java:4734) [catalina.jar:6.0.35]
    at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:799) [catalina.jar:6.0.35]
    at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:779) [catalina.jar:6.0.35]
    at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:601) [catalina.jar:6.0.35]
    at org.apache.catalina.startup.HostConfig.deployWAR(HostConfig.java:943) [catalina.jar:6.0.35]
    at org.apache.catalina.startup.HostConfig.deployWARs(HostConfig.java:778) [catalina.jar:6.0.35]
    at org.apache.catalina.startup.HostConfig.deployApps(HostConfig.java:504) [catalina.jar:6.0.35]
    at org.apache.catalina.startup.HostConfig.start(HostConfig.java:1317) [catalina.jar:6.0.35]
    at org.apache.catalina.startup.HostConfig.lifecycleEvent(HostConfig.java:324) [catalina.jar:6.0.35]
    at org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:142) [catalina.jar:6.0.35]
    at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1065) [catalina.jar:6.0.35]
    at org.apache.catalina.core.StandardHost.start(StandardHost.java:840) [catalina.jar:6.0.35]
    at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1057) [catalina.jar:6.0.35]
    at org.apache.catalina.core.StandardEngine.start(StandardEngine.java:463) [catalina.jar:6.0.35]
    at org.apache.catalina.core.StandardService.start(StandardService.java:525) [catalina.jar:6.0.35]
    at org.apache.catalina.core.StandardServer.start(StandardServer.java:754) [catalina.jar:6.0.35]
    at org.apache.catalina.startup.Catalina.start(Catalina.java:595) [catalina.jar:6.0.35]
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:1.6.0_33]
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39) ~[na:1.6.0_33]
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25) ~[na:1.6.0_33]
    at java.lang.reflect.Method.invoke(Method.java:597) ~[na:1.6.0_33]
    at org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:289) [bootstrap.jar:6.0.35]
    at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:414) [bootstrap.jar:6.0.35]
Caused by: javax.jcr.RepositoryException: Cannot instantiate persistence manager org.apache.jackrabbit.core.persistence.pool.OraclePersistenceManager
    at org.apache.jackrabbit.core.RepositoryImpl.createPersistenceManager(RepositoryImpl.java:1353) ~[jackrabbit-core-2.4.2.jar:2.4.2]
    at org.apache.jackrabbit.core.RepositoryImpl.createVersionManager(RepositoryImpl.java:486) ~[jackrabbit-core-2.4.2.jar:2.4.2]
    at org.apache.jackrabbit.core.RepositoryImpl.<init>(RepositoryImpl.java:311) ~[jackrabbit-core-2.4.2.jar:2.4.2]
    at org.apache.jackrabbit.core.RepositoryImpl.create(RepositoryImpl.java:589) ~[jackrabbit-core-2.4.2.jar:2.4.2]
    at org.apache.jackrabbit.j2ee.RepositoryStartupServlet.createRepository(RepositoryStartupServlet.java:445) [RepositoryStartupServlet.class:na]
    at org.apache.jackrabbit.j2ee.RepositoryStartupServlet.initRepository(RepositoryStartupServlet.java:413) [RepositoryStartupServlet.class:na]
    ... 29 common frames omitted
Caused by: org.apache.jackrabbit.core.config.ConfigurationException: Configured class org.apache.jackrabbit.core.persistence.pool.OraclePersistenceManager does not contain a property named tableSpace
    at org.apache.jackrabbit.core.config.BeanConfig.newInstance(BeanConfig.java:206) ~[jackrabbit-core-2.4.2.jar:2.4.2]
    at org.apache.jackrabbit.core.RepositoryImpl.createPersistenceManager(RepositoryImpl.java:1340) ~[jackrabbit-core-2.4.2.jar:2.4.2]
    ... 34 common frames omitted 
```

谁能帮我解决这个问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-23T20:30:11.340

In Jackrabbit 2.4.2 the parameter is called 'tablespace'. So it should be in lowercase. That's why you get the error message.

See also:

[http://svn.apache.org/repos/asf/jackrabbit/tags/2.4.2/jackrabbit-core/src/main/java/org/apache/jackrabbit/core/persistence/pool/OraclePersistenceManager.java](http://svn.apache.org/repos/asf/jackrabbit/tags/2.4.2/jackrabbit-core/src/main/java/org/apache/jackrabbit/core/persistence/pool/OraclePersistenceManager.java)

# c++ - 什么构成 C++11 中“移出”对象的有效状态？

> ID：12095048
> 
> 赞同：26
> 
> 时间：2012-08-23T15:23:50.457
> 
> 标签：c++, c++11, move-semantics, pimpl-idiom, invariants

我一直在努力思考 C++11 中的移动语义应该如何工作，并且在理解移动对象需要满足哪些条件时遇到了很多麻烦。在[这里查看答案并不能真正解决我的问题，因为尽管](https://stackoverflow.com/questions/7027523/what-can-i-do-with-a-moved-from-object)[移动语义的论点非常适合 pimpls](http://herbsutter.com/gotw/_100/)，但看不到如何以合理的方式将其应用于 pimpl 对象。

我的问题的最简单说明涉及 pimpl 成语，如下所示：

```
class Foo {
    std::unique_ptr<FooImpl> impl_;
public:
    // Inlining FooImpl's constructors for brevity's sake; otherwise it 
    // defeats the point.
    Foo() : impl_(new FooImpl()) {}

    Foo(const Foo & rhs) : impl_(new FooImpl(*rhs.impl_)) {}

    Foo(Foo && rhs) : impl_(std::move(rhs.impl_)) {}

    Foo & operator=(Foo rhs) 
    {
        std::swap(impl_, rhs.impl_);

        return *this;
    }

    void do_stuff () 
    {
        impl_->do_stuff;
    }
}; 
```

现在，一旦我从`Foo`. 我可以安全地销毁被移动的对象，我可以分配给它，这两者都是绝对关键的。但是，如果我尝试`do_stuff`使用我的`Foo`，它会爆炸。在我为我的定义添加移动语义之前`Foo`，每个都`Foo`满足它可以的不变量，现在`do_stuff`情况不再如此。似乎也没有很多很好的选择，因为（例如）放置移动源`Foo`将涉及新的动态分配，这部分违背了移动语义的目的。我可以检查是否`impl_`进入`do_stuff`并将其初始化为默认值`FooImpl`如果是这样，但这会增加一个（通常是虚假的）检查，如果我有很多方法，那就意味着要记住对每个方法都进行检查。

我应该放弃能够`do_stuff`是一个合理的不变量的想法吗？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-08-23T15:46:17.487

您为您的类型定义和记录什么是“有效”状态以及可以对您的类型的移出对象执行哪些操作。

移动标准库类型的对象会将对象置于未指定状态，可以正常查询以确定有效操作。

> **17.6.5.15 库类型的移动状态 [lib.types.movedfrom]**
> 
> C++ 标准库中定义的类型的对象可以从 (12.8) 中移出。移动操作可以显式指定或隐式生成。除非另有说明，否则此类移出的对象应置于有效但未指定的状态。

处于“有效”状态的对象意味着标准为该类型指定的所有要求仍然适用。这意味着您可以对前提条件成立的移出标准库类型使用任何操作。

通常，对象的状态是已知的，因此您不必检查它是否满足您要执行的每个操作的先决条件。与移动对象的唯一区别是您不知道状态，因此您必须检查。例如，在查询字符串的状态以确定是否满足 pop_back() 的先决条件之前，不应对已移出的字符串执行 pop_back()。

```
std::string s = "foo";
std::string t(std::move(s));
if (!s.empty()) // empty has no preconditions, so it's safe to call on moved-from objects
    s.pop_back(); // after verifying that the preconditions are met, pop_back is safe to call on moved-from objects 
```

状态可能是未指定的，因为为标准库的所有不同实现创建一组有用的需求会很繁重。

* * *

由于您不仅负责规范，还负责类型的实现，因此您可以简单地指定状态并避免查询的需要。例如，指定从您的 pimpl 类型对象移动会导致 do_stuff 成为具有未定义行为的无效操作（通过取消引用空指针）是完全合理的。该语言的设计使得移动仅发生在无法对移动对象执行任何操作时，或者当用户非常明显且非常明确地指示移动操作时，因此用户永远不应该对移动的对象感到惊讶-从对象。

* * *

另请注意，标准库定义的“概念”没有考虑到移动对象。这意味着为了满足标准库定义的任何概念的要求，您的类型的移出对象仍必须满足概念要求。这意味着如果您的类型的对象没有保持有效状态（由相关概念定义），那么您不能将它与标准库一起使用（或者结果是未定义的行为）。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-08-23T15:38:18.333

> 但是，如果我尝试用我的 Foo 做 do_stuff，它会爆炸。

是的。这也会：

```
vector<int> first = {3, 5, 6};
vector<int> second = std::move(first);
first.size();  //Value returned is undefined. May be 0, may not 
```

标准使用的规则是让对象处于*有效*（意味着对象工作）但未*指定*的状态。这意味着您可以调用的*唯一*函数是那些对对象的当前状态没有条件的函数。对于`vector`，您可以使用它的复制/移动赋值运算符，以及`clear`and`empty`和其他几个操作。所以你可以这样做：

```
vector<int> first = {3, 5, 6};
vector<int> second = std::move(first);
first.clear();  //Cause the vector to become empty.
first.size(); //Now the value is guaranteed to be 0. 
```

对于您的情况，复制/移动分配（从任一侧）应该仍然有效，析构函数也应该有效。但是你的所有其他功能都有一个前提条件是基于没有被移出的状态。

所以我看不到你的问题。

如果您想确保 Pimpl'd 类的任何实例都不能为空，那么您将实现正确的复制语义并禁止移动。运动*需要*物体处于空状态的可能性。

# .net - 部署/运行具有强命名程序集的应用程序

> ID：12095052
> 
> 赞同：0
> 
> 时间：2012-08-23T15:24:05.303
> 
> 标签：.net

在我们的开发环境中，我们使用 1 个 snk 文件，该文件用于在项目中使用 vs 签名选项卡签名的程序集。我们也跑`sn -Vr *, someKey`。但是，当我尝试运行使用这些程序集的 exe 时，我得到了

> 异常详细信息：System.IO.FileLoadException：无法加载文件或程序集“AjaxControlToolkit”或其依赖项之一。无法验证强名称签名。该程序集可能已被篡改，或者它被延迟签名但未使用正确的私钥完全签名。（来自 HRESULT 的异常：0x80131045）

我是否必须使用 sn 实用程序在 GAC 中注册它们？

顺便说一句，我们还选中了仅延迟符号复选框。

# excel - 使用动态范围和 customOrder excel 排序宏

> ID：12095053
> 
> 赞同：1
> 
> 时间：2012-08-23T15:24:09.880
> 
> 标签：excel, vba

我正在尝试制作多级排序宏，而行数是动态的。我一直在处理一些测试数据以尝试使其正常工作，但是我不断从 Excel 中收到 1004 个运行时错误。希望第二双眼睛能帮助解决这个问题。

这是测试数据

```
A       B        C      D
Num Status  Junk    Junk
1   Open    1       1
2   Open    2       2
3   Closed  3       3
3   Open    3       3
4   Open    4       4
6   Open    6       6
8   Open    8       8
8   Open    8       8
34  Open    34      34
456 Open    456     456
5   Closed  5       5
853 Open    853     853
2345Closed  2345    2345
234 Open    234     234
23  Closed  23      23
4   Open    4       4
76  Closed  76      76
345 Open    345     345
623 Closed  623     623
523 Open    523     523
4525Closed  4525    4525
6   Open    6       6 
```

这是我的宏

```
Range("A1:D1").Select
ActiveWorkbook.Worksheets("Sheet1").Sort.SortFields.Clear
ActiveWorkbook.Worksheets("Sheet1").Sort.SortFields.Add _
    Key:=Range("B1:B10"), SortOn:=xlSortOnValues, Order:=xlAscending, CustomOrder:= _
    "Open,Closed", DataOption:=xlSortNormal
ActiveWorkbook.Worksheets("Sheet1").Sort.SortFields.Add _
    Key:=Range("A1:A10"), SortOn:=xlSortOnValues, Order:=xlAscending,            DataOption:=xlSortNormal
With ActiveWorkbook.Worksheets("Sheet1").Sort
    .Header = xlYes
    .MatchCase = False
    .Orientation = xlTopToBottom
    .SortMethod = xlPinYin
    .Apply
End With 
```

另请参阅我有 Range("A1:A10") 的行，希望 A10 成为最后一行。所以我不确定该放什么。

谢谢大家，

吉姆

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T15:50:38.160

将您的最后一行放入一个变量中，然后在您的范围名称中使用该变量，就像我在下面所做的那样。我还对您的代码进行了一些清理，以使其更易于阅读和提高效率。您收到运行时错误，因为您缺少该`SetRange`方法：

```
Sub mySort()

Dim lngLast As Long
lngLast = Range("A" & Rows.Count).End(xlUp).Row

On Error Go to Whoa! 'in honor of Siddhart Rout (I like that :))
With Worksheets("Sheet1").Sort
    .SortFields.Clear
    .SortFields.Add Key:=Range("B1:B" & lngLast), SortOn:=xlSortOnValues, Order:=xlAscending, CustomOrder:= _
        "Open,Closed", DataOption:=xlSortNormal
    .SortFields.Add Key:=Range("A1:A1" & lngLast), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal
    .SetRange Range("A1:D" & lngLast)
    .Header = xlYes
    .MatchCase = False
    .Orientation = xlTopToBottom
    .SortMethod = xlPinYin
    .Apply
End With

On Error Go To 0
Exit Sub

Whoa!:
    Msgbox "Error " & Err.Number & " " & Err.Description, vbOkOnly

End Sub 
```

# java - 有人知道如何为 google-api-java-client 找到最新的 javadocs

> ID：12095054
> 
> 赞同：1
> 
> 时间：2012-08-23T15:24:10.440
> 
> 标签：java, google-api-java-client

谷歌主机的那些似乎已经坏了。例如，

[http://javadoc.google-api-java-client.googlecode.com/hg/1.4.1-beta/com/google/api/client/googleapis/xml/atom/package-summary.html](http://javadoc.google-api-java-client.googlecode.com/hg/1.4.1-beta/com/google/api/client/googleapis/xml/atom/package-summary.html)

显示了使用不推荐使用的类 (AtomParser) 的示例，并且正在调用不存在的方法，例如对 HttpTransport 实例的 addParser 方法调用（我猜这应该是对 HttpRequest 实例的 setParser 方法调用）。

所以，基本上，我在哪里可以找到更多关于这个的最新信息？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T11:26:58.227

请访问我们的[主页](https://code.google.com/p/google-api-java-client/)并单击“JavaDoc”。JavaDoc 的最新版本链接自：

[http://javadoc.google-api-java-client.googlecode.com/hg/index.html](http://javadoc.google-api-java-client.googlecode.com/hg/index.html)

免责声明：我是 google-api-java-client 库的所有者。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T15:44:06.893

它在 Maven 中心：

[http://central.maven.org/maven2/com/google/api/client/google-api-client/](http://central.maven.org/maven2/com/google/api/client/google-api-client/)

获取 javadoc jar 或源 jar。或者更好的是，使用 IDE 的 Maven 集成，它会自动下载源代码。

# azure - 如何创建具有 16GB 内存的 Windows 虚拟机

> ID：12095055
> 
> 赞同：4
> 
> 时间：2012-08-23T15:24:13.150
> 
> 标签：azure, azure-virtual-machine, azure-configuration

我对云服务完全陌生，使用 Windows Azure，我需要一个 Web 服务器和一个数据库服务器，每个服务器都有 16GB 的 RAM。但是，超大的 Windows 虚拟机只有 14GB 的 RAM。我将如何为这些服务器中的每一个添加 2gb 的 RAM，或者我是否需要做其他事情，例如合并 SQL 数据库？我不需要知道安装的细节，我现在只需要知道需要支付的费用，因为我只是想弄清楚所有东西的价格。谢谢你。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-23T16:34:59.183

超大 (XL) VM 大小提供 14GB 可用 RAM。这适用于虚拟机 (IaaS) 和 Web/工作者角色 (PaaS)。没有其他 VM 大小可以提供比这更多的 RAM。您无法额外增加 2 GB。

**2013 年 4 月 16 日更新**：现在有两种新尺寸：28GB/4 核和 56GB-8 核，可用于虚拟机~~（不适用于云服务，例如 web 和工作角色）~~。公告[在这里](http://weblogs.asp.net/scottgu/archive/2013/04/16/windows-azure-general-availability-of-infrastructure-as-a-service-iaas.aspx)。虚拟机映像库中还有一个新的 SharePoint 模板（因为您提到过使用 SharePoint）以及一个 SQL Server 模板。

**2013 年 4 月 30 日更新**：新的 28GB/56GB 大小现在可用于云服务，与适用于 .NET 的 Azure SDK 2.0 的发布同步。详情[在这里](http://weblogs.asp.net/scottgu/archive/2013/04/30/announcing-the-release-of-windows-azure-sdk-2-0-for-net.aspx)。

再补充一点，关于 Web 服务器：与本地服务器不同，在本地服务器中购买最大的机器通常是经济的，在 Windows Azure 中最好使用更小的 VM 并拥有更多的 VM。因此，对于 Web 服务器，请使用仍可运行您的软件的*最小VM 大小。*然后，为了处理额外的流量，扩展到更多的 Web 实例。随着流量的减少，减少实例数。负载将分布在所有 Web 服务器（它们是无状态的 - 对特定实例没有用户亲和性）。

# mongodb - Mongo 分片而不关闭现有的 mongo 实例

> ID：12095058
> 
> 赞同：2
> 
> 时间：2012-08-23T15:24:23.750
> 
> 标签：mongodb, replication, sharding

我需要在**不关闭或重新启动端口****27017**中现有的 mongo 实例的情况下进行分片。

我尝试了以下方法，（在默认端口正在运行和 mongo 实例时）

```
mongod --shardsvr --dbpath /var/lib/mongodb/dba --port 10001 > /var/log/mongodb/shardlog/sharda.log &
mongod --shardsvr --dbpath /var/lib/mongodb/dbb --port 10002 > /var/log/mongodb/shardlog/shardb.log &

mongod --configsvr --dbpath /var/lib/mongodb/config --port 20000 > /var/log/mongodb/shardlog/configdb.log &
mongos --configdb localhost:20000 > /var/log/mongodb/shardlog/mongos.log & 
```

然后 mongos 日志给出错误，

> ```
> Thu Aug 23 14:44:36 [mongosMain] ERROR: listen(): bind() failed errno:98 Address already in use for socket: 0.0.0.0:27017
> Thu Aug 23 14:44:36 [mongosMain] ERROR:   addr already in use 
> ```

mongos 在端口 20000 上运行，但为什么它试图连接默认的**27017**端口？

我可以在不干扰端口 27017 上现有的 mongo 实例的情况下使用多个分片启动 mongos 吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-23T15:41:20.037

从您给出的命令列表中，您似乎没有告诉在`mongos`与默认端口不同的端口上启动。

您需要提供`--port`参数 for`mongos`才能在不同的端口上启动。

尝试：`mongos --configdb localhost:20000 --port 10003`

注意：`mongos`如您上面所说，它没有在端口 20000 上运行。您在该端口上运行了配置服务器

# java - 如何改进我在计算机科学系门户网站上的项目？

> ID：12095059
> 
> 赞同：-5
> 
> 时间：2012-08-23T15:24:25.833
> 
> 标签：java, jakarta-ee

我在netbeans上使用java在计算机科学系门户网站上做了一个项目。它包含一个登录页面，以便其用户可以登录。有三个用户 Student，Admin，Faculty。每个用户都有其不同的功能，如电子书上传、下载、教师详细信息等。它还具有数据库连接性。请告诉我如何改进它

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T15:43:39.670

以下是一些关于您可以添加哪些功能以及如何改进现有功能的提示：

关于您的帐户管理系统和安全功能：

-你有登记表吗？在将它们发送到服务器之前是否检查了这些字段？服务器是否也验证此字段（特别是：它们是否被转义以避免 SQL 注入）？

- 你有密码恢复系统吗？

-您有电子邮件验证系统吗？

-你有联系表格吗？

- 你有验证码来保护所有这些功能吗？

- 管理员用户是否有阻止/限制或删除帐户的功能？有密码保护吗？

- 用户是否有一个公开的个人资料，他们可以选择与谁（公众、其他用户、管理员用户......）共享哪些个人资料数据？

- 您是否在所有登录和密码请求表单上实施安全登录（SSL 协议（HTTPS），当然您需要授权来签署您的证书以进行身份​​验证，但即使使用自签名，您至少可以提供加密，这样数据就不会传播在不安全的网络（如开放 WiFi 网络）上未加密）

-**非常重要**：存储的帐户密码是否经过哈希处理？

- 您的网站是否受到 XSS 保护？（意思是：任何用户/外部输入在显示之前是否被正确转义，您是否使用 httponly cookie？）

关于数据库访问功能：

-您可以执行基本搜索并显示结果吗？

- 你能过滤这个搜索结果吗？

- 您能否执行受不同参数及其组合值范围限制的搜索？

- 结果显示顺序如何？

对于您让用户/管理员向/从数据库中添加/删除的任何项目，加上或多或少与帐户注册/管理相同...

目前我能想到的就这些了，但是你可以通过查看任何流行网页实现的功能来获得更多灵感。

此外，这 2 个站点可以帮助您验证站点的 HTML 输出和 CSS 代码：

[http://validator.w3.org/](http://validator.w3.org/)

[http://jigsaw.w3.org/css-validator/](http://jigsaw.w3.org/css-validator/)

# syntax - Mule 选择表达式 - 基于 Outbound 属性的路由

> ID：12095062
> 
> 赞同：0
> 
> 时间：2012-08-23T15:24:30.763
> 
> 标签：syntax, expression, eval, esb, mule

我有一个从消息的有效负载中提取并设置为出站属性的属性（以使其更易于访问）。我想简单地检查这个属性的大小，但我所有最好的猜测都给了我例外。

我尝试使用 #[header:OUTBOUND:count] 语法，将 evaluator="header" 属性添加到 <when> 标记，但似乎没有任何效果。我也尝试过其他评估器，但我找不到任何带有语法示例的 Mule 文档，所以我只是猜测应该如何形成表达式。

```
<choice doc:name="Choice">
        <when expression="message.outboundProperties['count']==0">
            <processor-chain>
                ... something here ...
            </processor-chain>
        </when>
        <otherwise>
            <processor-chain>
                ... alternate option ...
            </processor-chain>
        </otherwise>
    </choice> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T20:23:38.450

在这种情况下，我通常使用 Groovy。试试这个

```
<when expression="message.getProperty('count',org.mule.api.transport.PropertyScope.OUTBOUND)==0"
evaluator="groovy"/> 
```

高温高压

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T15:23:56.773

假设您正在运行 Mule 3.3.0 并且它`count`是数字的，那么您的语法是正确的并且应该可以正常工作。

为了使其规范，`#[]`请在表达式周围添加：

```
<when expression="#[message.outboundProperties['count'] == 0]"> 
```

因为它的名称与 MVEL 属性命名兼容，您甚至可以`count`直接访问该条目：

```
<when expression="#[message.outboundProperties.count == 0]"> 
```

# asp.net-mvc - C# MVC 创建表单

> ID：12095066
> 
> 赞同：0
> 
> 时间：2012-08-23T15:24:52.770
> 
> 标签：asp.net-mvc

我正在使用 C# MVC。我之前创建了一个表单，所需的所有数据都在一个表单上。一旦用户填写完毕，它就会进入控制器，控制器将数据插入到数据库表中。

我将如何处理字段位于 3 个不同页面上的情况。在第 3 页，我喜欢提交。数据如何保存？

会话变量也可以用于与许多页面共享的数据吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T15:26:45.610

如果您执行向导风格的工作流程，您可以只`ViewModel`为每个页面设置一个，并且随着用户进入每个页面，将每个页面存储`ViewModel`在一个`Session`变量中。然后在完成后，您可以从中获取所有模型，`Session`然后将值聚合到您完成的表单状态中。

另一种方法是，对于`POST`将页面数据保存到数据存储中以便用户浏览每个页面的每个调用服务，实体通过某些服务填充并存储在您的数据库中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T15:27:52.947

您可以使用不同的视图，或者使用一个带有选项卡式 UI 的视图，并使用三个部分视图作为每个选项卡的内容作为替代方案。

您可以使用会话，但您必须确保他们能够在 20 分钟的时间限制内完成内容；只要发生回发，就会重置该限制。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T21:31:53.303

可以只使用一个局部视图来吐出一个具有所有 3 个页面的属性的 ViewModel，然后使用 jQuery 向导插件（或者您可能正在编写自己的插件）来简单地操作 DOM 以将每个页面显示/隐藏为 NEXT /PREVIOUS 按钮被单击。它仍将是一个单一表格的一部分。然后点击提交将回发到您的控制器方法，例如使用带有序列化 JSON 的 $.ajax() POST。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-09-15T10:08:33.760

如果您在向导中的所有 3 个页面之间共享视图模型，则可以在页面上部署 HiddenFor 字段以保留在向导的该页面上不可见的信息。

这将在整个向导中保留在其他表单上输入的数据字段，并且不依赖 Session 来存储信息。

# php - WP-MVC：如何使用分页方法执行连接？

> ID：12095067
> 
> 赞同：0
> 
> 时间：2012-08-23T15:24:55.293
> 
> 标签：php, wordpress

我正在将 WP MVC 用于 wordpress，并且遇到以下问题。这是一个示例场景。我想允许用户在事件 index.php 页面上搜索功能。例如，我希望他们能够按场地或演讲者找到所有活动，并有场地和演讲者的下拉菜单。这怎么可能使用 events_controller.php 中的分页函数？

这是当前代码： public function index() {

```
$this->params['page'] = empty($this->params['page']) ? 1 : $this->params['page'];

    $this->params['conditions'] = array('is_public' => true);

    $collection = $this->model->paginate($this->params);

    $this->set('objects', $collection['objects']);
    $this->set_pagination($collection);

} 
```

在这种情况下，您如何告诉 paginate 您将加入或更好的是在哪里以及如何加入？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T16:28:13.270

您需要先搜索场地和演讲者。

```
//Paginating by venue id
$this->params['conditions']['venue_id'] = $venue_id; //example
$collection = $this->model->paginate($this->params);

//paginating by speaker id
$this->params['conditions']['Speaker.id'] = $speaker_id; //example
$collection = $this->model->paginate($this->params); 
```

# django - Django 注册：激活新用户时出错

> ID：12095075
> 
> 赞同：0
> 
> 时间：2012-08-23T15:25:17.627
> 
> 标签：django, url-routing

我在开发服务器上的项目中使用 Django 注册。当我注册一个新用户时，我使用 EMAIL_BACKEND = 'django.core.mail.backends.filebased.EmailBackend' 来获取激活链接。当我尝试将激活链接放入网络浏览器时，出现错误，并且该帐户未激活。

据说 ：![未找到错误](../Images/f6106b6a71687ca9b19f9e049cb36688.png)

谢谢你。该函数用于生成密钥。

```
def create_profile(self, user):
    """
    Create a ``RegistrationProfile`` for a given
    ``User``, and return the ``RegistrationProfile``.

    The activation key for the ``RegistrationProfile`` will be a
    SHA1 hash, generated from a combination of the ``User``'s
    username and a random salt.

    """
    salt = hashlib.sha1(str(random.random())).hexdigest()[:5]
    username = user.username
    if isinstance(username, unicode):
        username = username.encode('utf-8')
    activation_key = hashlib.sha1(salt+username).hexdigest()
    return self.create(user=user,
                       activation_key=activation_key) 
```

我收到了那封邮件。但我使用 EMAIL_BACKEND'django.core.mail.backends.filebased.EmailBackend'。

我认为问题来自这里。但我无法在生产服务器中进行测试。

![收到的邮件](../Images/c75f791c36dc98245c9602fd224c4d23.png)

我实际上解决了这个问题这是因为我生成了要在文件中发送的电子邮件，这要归功于 django 为开发目的提供的文件电子邮件后端。在这个文件中，当有回车时，它会添加一个 = 字符。激活帐户的链接就是这种情况。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T15:34:01.007

字符 '=' 不在 \w+ 的范围内。使用 [\w=]+ 代替 \w+。

将**?P<activation_key>\w+**替换为**?P<activation_key>[\w=]+**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T16:03:40.200

您的激活密钥中不应包含`=`字符。

尽管`sergzach`' 的答案会起作用，但我更感兴趣的是首先找出为什么`=`会出现这种情况。

`django-registration` [通常按如下方式生成密钥](https://code.google.com/p/django-registration/source/browse/trunk/registration/models.py)：

```
 salt = sha.new(str(random.random())).hexdigest()[:5]
        activation_key = sha.new(salt+user.username).hexdigest() 
```

你在哪里生成你的？

# android - Android - 为什么 IMarketBillingService 文件是 iadl 文件而不是 .java

> ID：12095081
> 
> 赞同：1
> 
> 时间：2012-08-23T15:25:28.930
> 
> 标签：android

我只是好奇，但是对于 Android 计费，Android 提供了这个类：

```
import android.os.Bundle;

interface IMarketBillingService {
    /** Given the arguments in bundle form, returns a bundle for results. */
    Bundle sendBillingRequest(in Bundle bundle);
} 
```

但它的扩展名不是 .java 而是 .iadl ...这是为什么呢？:)

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T15:41:25.110

这就像服务和您的应用程序之间的合同，允许它们之间进行通信。

您可以在此处获取更多详细信息：http: [//developer.android.com/guide/components/aidl.html](http://developer.android.com/guide/components/aidl.html)

# java - Oracle 到 H2/hsqldb 等适配器

> ID：12095082
> 
> 赞同：5
> 
> 时间：2012-08-23T15:25:33.643
> 
> 标签：java, sql, oracle, maven, h2

我不能是唯一有这个问题的人，所以我正在寻找建议。

我们在 Oracle 上运行我们的应用程序，但我们的集成测试使用 h2 进行快速内存测试，该数据库在测试开始时由 DDL 脚本构建。

问题是 Oracle 和 h2/hsqldb 之间某些 DDL 命令的使用/语法不同。例如，今天我花了一些时间才意识到“grant select on ...”适用于 Oracle 中的序列，但仅适用于 h2 中的表。

在之前的项目中，我们有一个适配器来删除/翻译此类错误命令，这意味着我们的测试数据库运行的代码与我们在 prod 中实现的代码完全不同。虽然一切都经过了非常彻底的验收测试，但这意味着某些问题可能要到开发周期的后期才会被发现。

在我的最新项目中，我感觉我正在走同样的路——所以肯定其他人也已经踏上了这条路。

有什么建议么？我们正在使用 java/maven，所以欢迎使用合适的解决方案！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T20:04:28.813

据我所知，没有这样的适配器。

无论如何，我会说你不会用这样的适配器实现你的目标。一方面，Oracle 的特性集在任何其他解决方案中都不容易找到（这并不一定是 Oracle 的优势）。

# c++ - C++-Build：在项目中编辑文件后，构建过程需要很长时间。如何找出负责的文件/类？

> ID：12095083
> 
> 赞同：0
> 
> 时间：2012-08-23T15:25:38.977
> 
> 标签：c++, time, build, compilation

我有一个非常大的 VC++ 项目，在我编辑文件后需要很长时间才能重建。也许它是一个中心类，所以下面的类也必须重建。我正在使用类定义并在 cpp 文件中包含标题，而不是在 .h 文件中包含 .h 文件；-)

有没有办法找出哪个类/文件是负责的？是否有一些有用的工具可以可视化图表/依赖图中的包含？你怎么得到它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T15:51:19.277

任何直接或间接（通过另一个包含）#include 包含您更改的文件的文件都必须重建。此外，如果您有自定义规则（例如，您正在编辑的文件是生成新源文件的自定义规则的一部分），那么任何被此规则更改的文件及其依赖项也必须重新构建。

用于可视化依赖关系图的 MSDN Doc：http: [//msdn.microsoft.com/en-us/library/ff657798.aspx](http://msdn.microsoft.com/en-us/library/ff657798.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T17:18:00.930

[ElectricAccelerator](http://www.electric-cloud.com/eade)可以通过为您提供带 XML 注释的构建日志来帮助您回答这个问题，其中包含有关在每个对象的编译期间访问哪些文件以及每个对象的构建时间的信息。它有一个 Visual Studio 插件，因此它可以直接集成到您当前的环境中。

*免责声明：我是 ElectricAccelerator 的架构师*

# javascript - 禁用工具提示文本表单链接

> ID：12095087
> 
> 赞同：1
> 
> 时间：2012-08-23T15:26:04.890
> 
> 标签：javascript, jquery, tooltip

我正在创建一个简单的工具提示插件，它将“标题”属性内容显示为工具提示文本。所以我想禁用显示工具提示的默认浏览器行为，因为我在`div`. 所以我使用了下面的代码，但这不起作用，我可以同时看到默认工具提示和我的工具提示，默认工具提示与我的工具提示重叠。

```
$("a").hover(function(e){
  e.preventDefault();   
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T15:27:14.397

为什么不只是确保标签中没有`alt`和`title`属性。`<a>`

```
<a href="http://google.com" alt="Google!" title="Google!" />Goto Google</a> 
```

更改为 -

```
<a href="http://google.com" alt="Google!"  />Goto Google</a> 
```

所以你所要做的就是在`<a>`你想要删除默认工具提示行为的所有标签上运行这个 jQuery 代码 -

```
$(".desiredElements").removeProp('alt').removeProp('title'); 
```

* * *

如果您想维护这些工具提示以供以后使用，您应该将它们保存在`$.data`对象中，并在第二个悬停函数“悬停”回调中返回值。

```
$('.desiredElements').hover(function() {
    $thisCached = $(this);
    $.data(this, 'title', $thisCached.attr('title'));
    $thisCached.removeAttr('title').removeAttr('alt');
},function(){
    $thisCached = $(this);
    $thisCached.attr('title',$.data(this, 'title');
    $thisCached.attr('alt',$.data(this, 'title');
}); 
```

# sql - 使用ant脚本执行文件夹中的所有sql文件（应用任务）

> ID：12095089
> 
> 赞同：0
> 
> 时间：2012-08-23T15:26:05.490
> 
> 标签：sql, ant, command-line, sqlplus

我在使用 sqlplus 命令执行文件夹中的所有 SQL 文件时遇到问题

我可以使用此代码运行一个文件或第一个文件

```
<apply executable="sqlplus" dir="." parallel="false">
    <!-- <arg value="-S" /> -->
    <arg line="${db.user}/${db.pwd}@'${db.sid}'" />
    <arg value="@${db.run.build.script}" />  this is working, which is for executing one file
    <!-- <arg value="--e source" /> -->
    <srcfile/>
    <fileset dir="..\..\Documents\test\Database\SQL\common\test"
        casesensitive="no" description="take all sql files">
        <patternset>
            <include name="**/*.sql" />
        </patternset> 
     </fileset> 
</apply> 
```

; 但无法进一步处理其他文件

我已经尝试了应用任务的各种选项；但仍然没有成功；我认为导致问题的第二个文件开头没有“@”。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T16:32:23.890

好的，首先：我从未使用过 sqlplus :-)

但根据我在这里看到的帖子：[http](http://www.zorbathegeek.com/161/run-multiple-sqlplus-queries-via-dos-batch-file.html) ://www.zorbathegeek.com/161/run-multiple-sqlplus-queries-via-dos-batch-file.html我明白这是必须提供`@`的应考虑的所有文件的路径前缀。

我看到有多个选项，基于限制：

*   首先检查您是否可以在命令行中提供多个文件，如下所示：

`sqlplus [login details] @C:/<your_path>/<file1>.sql @C:/<your_path>/<file1>.sql`

*   取决于是否可能，您稍后应该决定是否需要创建 1 个文件，其中包含所有前缀为`@`（如引用站点中提供的示例）的文件名

现在怎么做前置？我认为应该很简单，只要尝试使用 Ant 的 parhconvert 描述：[http ://ant.apache.org/manual/Tasks/pathconvert.html](http://ant.apache.org/manual/Tasks/pathconvert.html)

```
<fileset dir="..\..\Documents\test\Database\SQL\common\test" id="sql.files">
      <include name="**/*.sql"/>
    </fileset>

<pathconvert pathsep=" " property="prefixed.sql.files" refid="sql.files">
      <map from="c:/" to="@c:/"/>
    </pathconvert> 
```

（你应该用`c:/`你的文件路径开头的字符串替换。此外，如果你将转储到文件，`pathsep=" "`可能应该替换`pathsep="\n"`为，因为可能需要每行有一个文件，但这需要测试）

然后根据一个文件中的所有选项或 cmd 行上的所有文件的选项，您：

*   要么需要将其转储到 tmp 文件并使用此 tmp 文件名运行 [http://ant.apache.org/manual/Tasks/echo.html](http://ant.apache.org/manual/Tasks/echo.html)
    在这种情况下，该文件应稍后删除

*   直接在您的应用参数值中使用属性 prefixed.sql.files，例如：
    `<arg value="${prefixed.sql.files}" />`

# android - 无法对非静态方法进行静态引用

> ID：12095091
> 
> 赞同：0
> 
> 时间：2012-08-23T15:26:13.213
> 
> 标签：android, sqlite, cursor, static-methods, onclicklistener

我在允许类访问我的数据库的方法上收到错误消息。错误发生在 .getReadableDatabase()。收到的错误如下。不知道如何解决这个错误。

```
 Cannot make a static reference to the non-static method getReadableDatabase() from the type SQLiteOpenHelper 
```

方法：

```
 public static boolean vaidateUser(String username, String password) {
        Cursor c = getReadableDatabase().rawQuery(
                "SELECT * FROM " + TABLE_NAME_CREDENTIALS + " WHERE "
                        + COLUMN_NAME_USERNAME + "='" + username +"'AND "+COLUMN_NAME_PASSWORD+"='"+password+"'" ,  null);
       if (c.getCount()>0)
          return true;
          return false; 
```

用于调用此方法：

```
 lsLogin.setOnClickListener (new OnClickListener() {

                @Override
                public void onClick(View v) {
                    //check login
                    String username = lsUsername.getText().toString();
                    String password = lsPassword.getText().toString();
                    try{
                        if(LoginDB.vaidateUser(username,password)) {
                            Intent goToNextActivity = new Intent(getApplicationContext(), menu.class);
                            startActivity(goToNextActivity);

                                Toast.makeText(LoginScrExample.this,"Login Sucessful",Toast.LENGTH_LONG).show();
                            }else{
                                Toast.makeText(LoginScrExample.this,"Invalid Username/Password",Toast.LENGTH_LONG).show();
                            }

                            } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T15:28:32.043

这意味着您需要一个对象的实例来调用此方法，因为它不是`static`

执行以下操作：`Cursor c = new YourObject().getReadableDatabase()...`

或者也使被调用的方法`static`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-23T15:29:08.173

由于您正在调用非静态方法，因此引发了错误：

```
getReadableDatabase(); 
```

您在静态方法中调用的任何方法也必须是静态的。

要修复它，要么从静态方法中删除静态，要么将静态添加到所有使用的方法中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T15:31:09.343

它是一种方法[`SQLiteOpenHelper`](http://developer.android.com/reference/android/database/sqlite/SQLiteOpenHelper.html#getReadableDatabase%28%29)。

所以改为这样做：

```
Cursor c = new SQLiteOpenHelper().getReadableDatabase().. 
```

或者

```
SQLiteOpenHelper soh = new SQLiteOpenHelper();
Cursor c = soh().getReadableDatabase().. 
```

# web-services - ServiceStack 网络服务安全

> ID：12095094
> 
> 赞同：8
> 
> 时间：2012-08-23T15:26:26.247
> 
> 标签：web-services, security, servicestack

嗨，我是使用 Servicestack 的新手，并且已经下载了他们非常全面的 bootstrapapi 示例并正在使用它，但仍然遇到一些问题。问题在于安全性，正在发生的事情是我在尝试访问受保护的服务时遇到 405 错误。使用身份验证服务似乎我正在正确地进行身份验证。请帮忙解释一下。这是代码：

```
public class Hello
{
    public string Name { get; set; }
}

public class AuthHello
{
    public string Name { get; set; }
}

public class RoleHello
{
    public string Name { get; set; }
}
public class HelloResponse
{
    public string Result { get; set; }
} 
```

服务：

```
public class HelloService : ServiceBase<Hello> 
{
    //Get's called by all HTTP Verbs (GET,POST,PUT,DELETE,etc) and endpoints JSON,XMl,JSV,etc
    protected override object Run(Hello request)
    {
        return new HelloResponse { Result = "Hello, Olle är en ÖL ål " + request.Name };
    }
}

[Authenticate()]
public class AuthHelloService : RestServiceBase<AuthHello>
{
    public object Execute(Hello request)
    {
        return new HelloResponse { Result = "Hello, " + request.Name };
    }
}

[RequiredRole("Test")]
public class RoleHelloService : RestServiceBase<RoleHello>
{
    public object Execute(Hello request)
    {
        return new HelloResponse { Result = "Hello, " + request.Name };
    }
} 
```

这是应用主机：

```
public class HelloAppHost : AppHostBase
    {
        //Tell Service Stack the name of your application and where to find your web services

        public HelloAppHost() : base("Hello Web Services", typeof(HelloService).Assembly) { }

        public override void Configure(Container container)
        {

            //Register all Authentication methods you want to enable for this web app.
        Plugins.Add(new AuthFeature(() => new AuthUserSession(), new IAuthProvider[] {new CustomCredentialsAuthProvider(), //HTML Form post of UserName/Password credentials
            }));
        container.Register<ICacheClient>(new MemoryCacheClient() { FlushOnDispose = false });

            //register user-defined REST-ful urls
            Routes
              .Add<Hello>("/hello")
              .Add<Hello>("/hello/{Name}")
              .Add<AuthHello>("/AuthHello")
              .Add<RoleHello>("/RoleHello");
        }
    } 
```

**更新**

如果您将 : RestServiceBase 替换为 : ISevice ，一切都会按预期工作，所以现在问题是为什么。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-08-23T17:10:00.173

### 首先查看 wiki 文档

我将首先浏览 ServiceStack 的[Authentication Wiki](https://github.com/ServiceStack/ServiceStack/wiki/Authentication-and-authorization)中的文档，以更好地了解 ServiceStack 的 Authentication 是如何工作的。wiki 中有很多文档，所以如果您不确定某些内容，您应该首先参考。这是一个社区 wiki，所以如果您认为它可以帮助其他人，请随时扩展那里的内容。

### 如果行为不清楚，请参考源代码中的实现

如果您不确定是什么，您应该[参考RequiredRole 源代码](https://github.com/ServiceStack/ServiceStack/blob/master/src/ServiceStack/RequiredRoleAttribute.cs)作为主要权威来了解它是如何工作的。`RequiredRole`只是一个[请求过滤器属性](https://github.com/ServiceStack/ServiceStack/wiki/Filter-attributes)，它在每个具有该属性的服务之前运行。

RequiredRole 属性只是调用您的`session.HasRole()`方法，如下[所示](https://github.com/ServiceStack/ServiceStack/blob/master/src/ServiceStack.ServiceInterface/RequiredRoleAttribute.cs#L58-63)：

```
public bool HasAllRoles(IAuthSession session)
{
    return this.RequiredRoles
        .All(requiredRole => session != null
            && session.HasRole(requiredRole));
} 
```

`session.HasRole()`因为它只是调用您的会话，所以如果您有自定义会话，您可以覆盖的实现。

### 注册和实现 CustomUserSession

Social BootstrapApi 项目确实实现了它自己的[CustomSession](https://github.com/ServiceStack/SocialBootstrapApi/blob/master/src/SocialBootstrapApi/Models/CustomUserSession.cs)，它[在此处注册](https://github.com/ServiceStack/SocialBootstrapApi/blob/master/src/SocialBootstrapApi/AppHost.cs#L195-196)但没有覆盖实现，因此它使用基本[AuthUserSession.HasRole()](https://github.com/ServiceStack/ServiceStack/blob/master/src/ServiceStack.ServiceInterface/Auth/AuthUserSession.cs#L71)`HasRole()`中的内置实现，它看起来像 Roles 集合，以查看用户是否具有指定的在他们的 Session POCO 中的作用：

```
public virtual bool HasRole(string role)
{
    return this.Roles != null && this.Roles.Contains(role);
} 
```

### 由 AuthUserRepository 填充的会话属性

**Roles**属性（以及用户会话上的大多数其他属性）由您指定的 AuthUserRepository 填充，例如，如果您使用OrmLiteAuthRepository[就像](https://github.com/ServiceStack/ServiceStack/blob/master/src/ServiceStack.ServiceInterface/Auth/OrmLiteAuthRepository.cs)SocialBootstrapApi[在这里](https://github.com/ServiceStack/SocialBootstrapApi/blob/master/src/SocialBootstrapApi/AppHost.cs#L195-196)所做的那样，那么 Roles 属性将保留在[UserAuth RDBMS的](https://github.com/ServiceStack/ServiceStack/blob/master/src/ServiceStack.ServiceInterface/Auth/UserAuth.cs#L28)**Roles**列中[表](https://github.com/ServiceStack/ServiceStack/blob/master/src/ServiceStack.ServiceInterface/Auth/UserAuth.cs#L28)。根据 AuthUserRepository，您使用 UserAuth / UserOAuthProvider POCO 在 OrmLite 中存储为 RDBMS 表或在 Redis 中存储为文本 blob 等。

### 使用 AssignRoles / UnAssignRoles 服务管理角色和权限

因此，要让用户拥有所需的角色（以及通过的授权），它应该将此角色添加到其 UserAuth 数据库行条目中。ServiceStack 的[AuthFeature](https://github.com/ServiceStack/ServiceStack/blob/master/src/ServiceStack.ServiceInterface/AuthFeature.cs)包括 2 个用于管理用户权限和角色的服务：

*   [/assignroles](https://github.com/ServiceStack/ServiceStack/blob/v4-sync/src/ServiceStack/Auth/AssignRolesService.cs)
*   [/unassignroles](https://github.com/ServiceStack/ServiceStack/blob/v4-sync/src/ServiceStack/Auth/UnAssignRolesService.cs)

### 如何最初赋予某人管理员角色

这些服务确实要求[具有管理员角色的用户](https://github.com/ServiceStack/ServiceStack/blob/master/src/ServiceStack.ServiceInterface/Auth/AssignRolesService.cs#L39)已经过身份验证。您可以通过手动更改特定用户的**UserAuth.Role**列以包含值“Admin”来执行此操作。相反，Social Bootstrap API 项目通过处理`OnAuthenticated()`其[CustomUserSession](https://github.com/ServiceStack/SocialBootstrapApi/blob/master/src/SocialBootstrapApi/Models/CustomUserSession.cs#L47-55)上的事件来执行此操作，该事件只是检查是否在 Web.Config 中声明了经过身份验证的用户名，如果是，则调用 AssignRoles 服务，为该经过身份验证的用户提供**管理员**角色：

```
if (AppHost.Config.AdminUserNames.Contains(session.UserAuthName)
    && !session.HasRole(RoleNames.Admin))
{
    var assignRoles = authService.ResolveService<AssignRolesService>();
    assignRoles.Execute(new AssignRoles {
        UserName = session.UserAuthName,
        Roles = { RoleNames.Admin }
    });
} 
```

# php - Amazon Cloudfront 私有分发 - 指向 CSS 中的图像的链接

> ID：12095100
> 
> 赞同：13
> 
> 时间：2012-08-23T15:26:45.307
> 
> 标签：php, amazon-s3, amazon-web-services, amazon-cloudfront

我在 Cloudfront 中创建了一个私有发行版以防止盗链。我设法用签名的 URL 创建了指向我的对象的链接，现在工作正常。

我唯一担心的是，我的 css 样式表中的图像链接不起作用，因为它们没有签名。因此，如果我有，例如：

```
background-image: url('../img/bg.png'); 
```

背景图像不会显示，因为样式表不包含签名的 url，因此 Cloudfront 拒绝提供内容。

我能做些什么来防止这种情况发生吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-05T08:20:57.143

让我退后一步，问一个基本问题：你*真的*担心别人盗用你的图片吗？*真的吗？*如果有人这样做，它将对您产生什么现实影响？*真的吗？*

如果您有正当理由阻止人们进行热链接，那么我不确定**任何**CDN 服务（在本例中为 CloudFront）是否适合您。

嘿，我只是说实话……</p>

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-27T14:39:02.253

有几种方法，每种方法都有缺点。

您可以通过模板（或其他一些将资源映射到 CloudFront 位置的智能方式）生成它，而不是静态 CSS 文件。您可以通过使用 Last-Modified 和 max-age Cache 标头在此处使用某种程度的缓存。最困难的解决方案，但可以说是最好的保护。

为所有 CSS 资源设置重定向路径，基本上是一个重写 CF 路径的小脚本（注意只重写 CSS 资源，别无其他）。这允许您保留当前的静态 CSS，但会打开重定向脚本的潜在热链接。

介于两者之间的东西可能是一个 cron 脚本，它生成带有在 1.5d 中过期的链接的静态 CSS 文件，以减少服务器负载。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-06T15:23:41.943

为您的 css 文件使用私有分发通常是一个非常糟糕的主意，因为向 css url 添加（可能是不断变化的）到期时间和签名会阻止浏览器缓存它们，因此首先大大降低了使用 Cloudfront 的有用性。

即使您使用较长的过期时间，那么拼命想要热链接您的 css 背景图像的人也会简单地设置一个脚本来抓取您的 css 文件并从那里提取图像 url。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-01T21:06:33.473

您可以每隔一两天轮换整个 CDN 主机名，然后您不必更改 css 中的任何内容（假设 css 位于示例中的 CDN 上）

[http://www.explainthatstuff.com/blocking-cloudfront-hotlinks.html](http://www.explainthatstuff.com/blocking-cloudfront-hotlinks.html)

这样你的 CSS 就不需要签名的 URL，你仍然可以有效地阻止盗链。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-10T14:58:20.223

我最近才听说将 base64 编码为 html/css。有利有弊，但这可能正是您要寻找的： [将背景图像数据嵌入 CSS 作为 Base64 的好做法还是坏做法？](https://stackoverflow.com/questions/1124149/is-embedding-background-image-data-into-css-as-base64-good-or-bad-practice)

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-09-17T21:55:49.210

`<base>`在你的 html 中使用标签怎么样？虽然没有尝试，但可能会有所帮助。

另一种选择是使用 php 生成样式表。例如，您获取所有图像的签名 url，然后将它们作为变量推送到样式元素。

# visual-studio - 智能感知/自动完成在 VS2008 上停止工作

> ID：12095102
> 
> 赞同：0
> 
> 时间：2012-08-23T15:26:51.983
> 
> 标签：visual-studio, visual-studio-2008

我正在使用安装了 TFS 客户端的 VS.NET 2008。我的解决方案很大，里面有近 116 个项目。它一直运行良好，只是从一周左右开始，在我编写代码时它停止显示自动完成/智能感知的行为很奇怪。

我首先尝试关闭并重新打开解决方案，但它并没有解决这个问题。将SP重新安装到VS2008，它修复了一段时间，然后问题又来了。我删除了所有的 VS2008 和 TFS 客户端之类的东西，然后重新安装了所有东西。工作了一段时间，但在同一天停止工作。

我想知道我必须做什么才能让它现在工作。这应该是永久性的。

我想知道是否有 VS.NET 的缓存（对于您正在处理的每个解决方案/项目），也许清除该缓存可能会起作用。我不确定。

请注意，如果我打开一个新项目或处理任何其他项目，它工作正常。只是使用一种自动完成功能不起作用的解决方案。

我还尝试清理解决方案、重建以及您能想到的任何其他事情。不知道为什么只在这个项目上。

谢谢您的帮助。萨默斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T17:38:59.233

好的，已经有一段时间了，它似乎正在工作。我在互联网上的某个地方读到，有人建议您应该尝试更改代码的位置。我这样做了，从现有驱动器移动到另一个驱动器。从那天起，它似乎工作正常。

它确实会停止工作一段时间，但我只是重新启动 VS.NET 并再次工作。

我知道这不是一个永久的解决方案，但是是的，它对我有用。

希望它对其他人也有帮助。当你习惯每天喝 10 次茶，突然他们说，“你再也不能喝茶了”时，这太令人沮丧了 :)

萨默斯

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-12-24T21:35:20.057

您是否尝试过（VS 2010）：

```
Tools 
➔ Options 
➔ Text Editor 
➔ C/C++ 
➔ Advanced 
➔ Browsing/Navigation 
➔ Recreate Database 
➔ True 
```

然后重新启动 Visual Studio。

# javascript - jquery一一显示div

> ID：12095104
> 
> 赞同：0
> 
> 时间：2012-08-23T15:26:55.770
> 
> 标签：javascript, jquery

嗨，我有 4 个具有相同类 2 的 div（第一个和第二个是显示），另一个是使用 $('.smt:gt(1)').hide(); 隐藏的。

```
<div class="smt"><p>1</p></div>
<div class="smt"><p>2</p></div>
<div class="smt"><p>3</p></div>
<div class="smt"><p>4</p></div>
<div id="more"><p>+</p></div> 
```

如何通过单击更多 div 一个一个地显示另一个 div？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T15:28:53.750

尝试这个

```
$('#more').click(function(){ // <-- bind click event to more
    $('.smt:hidden').eq(0).show(); // <-- show first hidden div with class .smt
    // or $('.smt:hidden').first().show();
    // or $('.smt:hidden:first').show();
    // or $('.smt:hidden:eq(0)').show();
}); 
```

# asp.net - 单击按钮事件后组合框刷新

> ID：12095107
> 
> 赞同：0
> 
> 时间：2012-08-23T15:27:09.623
> 
> 标签：asp.net

我有一个绑定到存储过程的组合框

点击事件按钮删除选择的任何一年，因为我可以确认该记录实际上已在数据库的后端删除。但删除后组合框不会刷新，仍然显示旧记录。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T15:29:32.173

您需要再次查询数据并`combo.DataBind()`自己调用或删除该项目。

# mysql - 从没有连接的多个表中选择？

> ID：12095109
> 
> 赞同：81
> 
> 时间：2012-08-23T15:27:25.643
> 
> 标签：mysql

从两个表中选择数据而不是将它们连接起来，让它们显示为单独的行的最简单方法是什么。两个表都有相似或匹配的字段，我想对它们运行一些聚合函数，例如从两个表中对同一个月发生的所有行进行平均。

例如，我有两个表，一个显示来自一个系统的事务，另一个显示来自不同系统的事务。有没有办法从两个表中获取所有事务作为单独的行？如果表 1 有 20 条记录，而表 2 有 30 条记录，我希望返回时有 50 行。

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2012-08-23T15:29:40.673

你可以尝试这样的事情：

```
SELECT ...
FROM (
    SELECT f1,f2,f3 FROM table1
    UNION
    SELECT f1,f2,f3 FROM table2
)
WHERE ... 
```

* * *

## 回答 #2

> 赞同：44
> 
> 时间：2012-08-23T17:53:17.260

`UNION ALL`运算符可能是您正在寻找的。

使用此运算符，您可以将多个查询的结果集连接在一起，保留每个查询的所有行。请注意，`UNION`运算符（没有`ALL`关键字）将消除结果集中存在的任何“重复”行。该`UNION ALL`运算符保留每个查询中的所有行（并且可能会执行得更好，因为它没有执行重复检查和删除操作的开销）。

在每个查询中，每列的列数和数据类型必须匹配。如果其中一个查询的列比另一个多，我们有时会在另一个查询中包含虚拟表达式以使列和数据类型“匹配”。通常，在返回文字的每个查询的 SELECT 列表中包含一个表达式（一个额外的列）会很有帮助，以显示哪些查询是该行的“源”。

```
SELECT 'q1' AS source, a, b, c, d FROM t1 WHERE ...
UNION ALL
SELECT 'q2', t2.fee, t2.fi, t2.fo, 'fum' FROM t2 JOIN t3 ON ...
UNION ALL
SELECT 'q3', '1', '2', buckle, my_shoe FROM t4 
```

您可以将这样的查询包装在一组括号中，并将其用作内联视图（或 MySQL 术语中的“派生表”），以便您可以对所有行执行聚合操作。

```
SELECT t.a
     , SUM(t.b)
     , AVG(t.c)
  FROM (
         SELECT 'q1' AS source, a, b, c, d FROM t1
          UNION ALL
         SELECT 'q2', t2.fee, t2.fi, t2.fo, 'fum' FROM t2
       ) t
 GROUP BY t.a
 ORDER BY t.a 
```

* * *

## 回答 #3

> 赞同：42
> 
> 时间：2012-08-23T15:31:42.937

你可以试试这个符号：

```
SELECT * from table1,table2 
```

更复杂的一个：

```
SELECT table1.field1,table1.field2, table2.field3,table2.field8 from table1,table2 where table1.field2 = something and table2.field3 = somethingelse 
```

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2015-12-15T04:32:52.520

如果您的问题是这样的 - 选择 ename, dname FROM emp, dept 而不使用连接..

然后，我会这样做...

```
SELECT ename, (SELECT dname 
FROM dept
WHERE dept.deptno=emp.deptno)dname
FROM EMP 
```

输出：

```
ENAME      DNAME
---------- --------------
SMITH      RESEARCH
ALLEN      SALES
WARD       SALES
JONES      RESEARCH
MARTIN     SALES
BLAKE      SALES
CLARK      ACCOUNTING
SCOTT      RESEARCH
KING       ACCOUNTING
TURNER     SALES
ADAMS      RESEARCH

ENAME      DNAME
---------- --------------
JAMES      SALES
FORD       RESEARCH
MILLER     ACCOUNTING

14 rows selected. 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2019-05-17T06:04:38.377

你应该试试这个

```
 SELECT t1.*,t2.* FROM t1,t2 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2021-08-10T17:33:25.060

SELECT * from table1 UNION SELECT * FROM table2

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2019-12-15T09:07:03.063

联合将按行而不是按列获取数据，因此，如果您像我一样正在寻找从两个没有关系且没有连接的不同表中获取列数据。
就我而言，我通过 id 获取州名和国家名。您可以这样做，而不是编写两个查询。

```
select 
   (
   select s.state_name from state s where s.state_id=3
   ) statename,
   (
   select c.description from country c where c.id=5
   ) countryname
   from dual; 
```

其中 dual 是一个带有单列的虚拟表——任何东西都只需要 table 来查看

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-10-02T16:50:50.817

select 'test', (select name from employee where id=1) as name, (select name from address where id=2) as address ;

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2013-08-07T13:12:46.140

在这种情况下，我们假设我们有两个表： `SMPPMsgLog`和`SMSService`common 列`serviceid`：

```
SELECT sp.SMS,ss.CMD 
FROM vas.SMPPMsgLog AS sp,vas.SMSService AS ss 
WHERE sp.serviceid=5431 
AND ss.ServiceID = 5431 
AND Receiver ="232700000" 
AND date(TimeStamp) <='2013-08-07' 
AND date(TimeStamp) >='2013-08-06' \G; 
```

# r - R knitr：可以以编程方式修改块标签吗？

> ID：12095113
> 
> 赞同：50
> 
> 时间：2012-08-23T15:27:37.567
> 
> 标签：r, knitr

我正在尝试使用 knitr 生成一个报告，该报告对数据集的不同子集执行相同的分析集。该项目包含两个 Rmd 文件：第一个文件是设置工作空间和文档的主文档，第二个文件仅包含执行分析和生成相关图形的块。

我想做的是编织主文件，然后它将为每个数据子集调用第二个文件并将结果包含在单个文档中。下面是一个简单的例子。

主文件：

```
# My report

```{r}
library(iterators)
data(mtcars)
```

```{r create-iterator}
cyl.i <- iter(unique(mtcars$cyl))
```

## Generate report for each level of cylinder variable
```{r cyl4-report, child='analysis-template.Rmd'}
```

```{r cyl6-report, child='analysis-template.Rmd'}
```

```{r cyl8-report, child='analysis-template.Rmd'}
``` 
```

分析模板.Rmd：

```
```{r, results='asis'}
cur.cyl <- nextElem(cyl.i)
cat("###", cur.cyl)
```

```{r mpg-histogram}
hist(mtcars$mpg[mtcars$cyl == cur.cyl], main = paste(cur.cyl, "cylinders"))
```

```{r weight-histogam}
hist(mtcars$wt[mtcars$cyl == cur.cyl], main = paste(cur.cyl, "cylinders"))
``` 
```

问题是 knitr 不允许使用非唯一的块标签，因此`analysis-template.Rmd`第二次调用时编织失败。这个问题可以通过不命名块来避免，因为随后会自动生成唯一的标签。然而，这并不理想，因为我想使用块标签为导出的图创建信息文件名。

* * *

一个潜在的解决方案是使用一个简单的函数，将当前柱面附加到块标签：

```
```r{paste('cur-label', cyl, sep = "-")}
``` 
```

但似乎 knitr 不会评估块标签位置中的表达式。

* * *

我还尝试使用修改当前块标签的自定义[块挂钩](http://yihui.name/knitr/hooks#chunk_hooks)：

```
knit_hooks$set(cyl.suffix = function(before, options, envir) {
    if (before) options$label <- "new-label"
}) 
```

但是更改块标签不会影响生成图的文件名，所以我认为 knitr 没有使用新标签。

* * *

关于如何更改块标签以便可以多次调用同一个子文档的任何想法？或者也许是实现这一目标的替代策略？

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2013-01-16T21:26:59.563

对于看到这篇文章的其他人，我想指出@Yihui在 knitr 1.0 中通过引入该功能为这个问题提供了[正式的解决方案。](https://github.com/yihui/knitr/blob/master/vignettes/knit_expand.Rmd)`knit_expand()`它工作得很好，确实简化了我的工作流程。

例如，以下将为每个级别处理下面的模板脚本，每次将(在模板中) 的`mtcars$cyl`所有实例替换为其当前值：`{{ncyl}}`

```
# My report

```{r}
data(mtcars)
cyl.levels <- unique(mtcars$cyl)
```

## Generate report for each level of cylinder variable
```{r, include=FALSE}
src <- lapply(cyl.levels, function(ncyl) knit_expand(file = "template.Rmd"))
```

`r knit(text = unlist(src))` 
```

模板：

```
```{r, results='asis'}
cat("### {{ncyl}} cylinders")
```

```{r mpg-histogram-{{ncyl}}cyl}
hist(mtcars$mpg[mtcars$cyl == {{ncyl}}], 
  main = paste({{ncyl}}, "cylinders"))
```

```{r weight-histogam-{{ncyl}}cyl}
hist(mtcars$wt[mtcars$cyl == {{ncyl}}], 
  main = paste({{ncyl}}, "cylinders"))
``` 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-08-23T18:27:41.713

如果您将 ** 中的所有块都设为无名，即````{r}`它可以工作。当然，这不是很优雅，但是有两个问题阻止您更改当前块的标签：

1.  在执行代码块之前解析文件。在执行任何代码或调用自定义挂钩之前，解析器已经检测到重复的标签。
2.  块选项（包括标签）在调用钩子之前处理（逻辑：这是一个触发钩子的选项），因此钩子不能再更改标签。

未命名块起作用的事实是它们在内部获得标签`unnamed-chunk-`+块编号。

块不能有重复的名称，因为内部 knitr 通过标签引用它们。一个修复方法是让 knitr 将块编号添加到具有重复名称的所有块中。或者通过块编号而不是标签来引用它们，但这在我看来是一个更大的变化。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-04-09T00:58:27.920

[这里](https://github.com/rstudio/flexdashboard/issues/80)提出了一个类似的问题，我能够使用 knit_expand(text=) 和`r paste(knitr::knit(text = paste(out, collapse = '\n')))`方法根据输入图的任意列表以编程方式创建 r 块并编织输出以在 flexdashboard 中使用（非常有用） 。

# javascript - html标签改变但表单没有改变

> ID：12095115
> 
> 赞同：0
> 
> 时间：2012-08-23T15:27:41.340
> 
> 标签：javascript, html, tapestry

我正在使用以下代码更改表单上标签的属性

标签

```
<input jwcid="licensingApprovalDate@CustomDatePicker" disabled="ognl:disabled || isLicensingApprovalDateDisabled()"
            value="ognl:company.licensingApprovalDate" displayName="message:company.licensingApprovalDate"/> 
```

将新属性添加到上述标签的代码

```
function checkForChange(field) {
    var approvalStatus = document.getElementById('licensingStatus').value;
    if(approvalStatus == "Pass"){
        document.getElementById('licensingApprovalDate').setAttribute("validators", "validators:maxDateToday,required");
    } else {
        document.getElementById('licensingApprovalDate').setAttribute("validators", "validators:maxDateToday");
    }   
} 
```

当 licenseStatus 发生更改时，此函数被调用，它正在工作，当我在 licenseStatus 更改时检查元素时，标签已正确更改，但这应该在 licenseApprovalDate 输入框旁边添加一个 * 但它没有

有没有办法在标签/许可状态更改后发生更改？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T15:24:23.697

验证器是一个参数，而不是一个属性。它作为一个属性出现在模板中，因为，嘿，它有点像 XML。

Tapestry 3 并不是为这种级别的动态行为而设计的（尽管它在 2003 年是最前沿的！）。鉴于它是 2012 年，请考虑升级到 Tapestry 5！

# database-design - 我应该将“无”放入我的查找表吗？

> ID：12095117
> 
> 赞同：2
> 
> 时间：2012-08-23T15:27:46.507
> 
> 标签：database-design, lookup-tables

我意识到在很多情况下，输入“无”似乎并不那么糟糕。但是，我想在另一个表中使用这个特定查找表（几千行）中的值，该表包含几个与来自查找表的数据直接相关的不可为空的字段。

**真实场景：**

查找表是通用药物名称的列表，并包含用于加入与我们的应用程序分开的其他数据库的代码。

我们有一个处方表，其中存储 DrugId、OrderId (FK)、频率、剂量等，所有这些目前都是不可为空的。

在某些情况下，订单的处方信息是必需的，因此仅通过没有记录（并且没有其他跟踪方式）来解决问题是不够的——我们需要能够知道为什么没有输入处方并且能够在以后查看数据时重新填充正确的原因。

一个想法是添加“无”作为药物查找表的一部分，这构成了这个问题的基础。我担心采用这种方法有几个原因：

*   似乎在每种情况下，当我们想要使用数据时，我们都记得要考虑到这一点（有几个小例外，因为作为 3rd 方数据库的内部连接。）
*   对于任何加入该项目的人来说，这似乎都非常不明显（更不用说屁股痛了），并且必须进行独特的测试。也许单独使用“None”并没有那么糟糕，但是我们想在组合中添加“Declined”或“Don't Know”呢？现在，我们的查找表中有 3 个不明显的异常，每次访问数据时都必须考虑这些异常。
*   我们要么使当前所需的字段为空，要么在其中插入虚假数据。

解决这种情况的其他想法是：

*   在订单中添加一个新列，其中包含“有处方”、“拒绝”、“无处方”等选项。这是不希望的，因为数以万计的行将是“空的”，但在其他方面似乎并不算太​​糟糕。

*   创建一个新表以仅记录“异常”情况，例如“无”或“不知道”何时需要该字段。目前，这是最吸引我的一个，因为它产生了非常明显的例外情况，必须加以说明。当然，缺点是列数很少的新表（零关系）。这似乎是用于重新填充 UI 的最简单的数据形式。

SO社区的想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T00:19:17.927

你不应该简单地做这样的事情吗？

![在此处输入图像描述](../Images/8b02e6d13e7b06f66e3b9f835c829d14.png)

（可能带有确保失败订单不能有处方的触发器。）

或者，您实际上需要为每个处方提供单独的失败原因？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T16:57:07.890

您可以添加两个字段来订购

```
LookupValueID NULL FK,
PrescriptionType tinyint 
```

和`PrescriptionType = (Present = 1, Null = 2, Declined = 3, DontKnow = 4, ...)`

并添加一个 CHECK 约束：

```
(PrescriptionType = 1 AND LookupValueID IS NOT NULL)
OR (PrescriptionType <> 1 AND LookupValueID IS NULL) 
```

这样，您将恒定数量的常见特殊情况内联到主表中（`Orders`我认为）并使用约束来强制数据正确性。

# asp.net-mvc-3 - 为什么我的 MVCContrib Grid 排序代码不起作用？

> ID：12095125
> 
> 赞同：1
> 
> 时间：2012-08-23T15:28:04.820
> 
> 标签：asp.net-mvc-3, razor, mvccontrib-grid

出于某种原因，我无法让我的 MVCContrib Grid 排序工作。

**为什么以下代码会生成网格但没有可排序的列？**

我正在使用 MVC3 和 Razor 语法。

```
@model List<InboundShipmentItem>

@using MvcContrib.UI.Grid
@Html.Grid(Model).Sort((GridSortOptions)ViewBag.SortOptions).Columns(column =>
    {
        column.For(item => !item.Verified ? Ajax.ActionLink("Receive", "ReceiveItem", new {id = @item.Id},
                                                            new AjaxOptions
                                                                {
                                                                    HttpMethod = "GET",
                                                                    InsertionMode = InsertionMode.Replace,
                                                                    UpdateTargetId = "grid",
                                                                    OnSuccess = "InboundShipmentVerification.ReceiveItemSucceeded",
                                                                    OnFailure = "InboundShipmentVerification.ReceiveItemFailed"
                                                                }).ToString() : "Received").Named("Received?").Encode(false);
        column.For(item => item.PONumber).Named("PO#").Sortable(true);
        column.For(item => item.ShipQty).Named("Qty Sent").Sortable(true).SortColumnName("Qty");
        column.For(item => item.ReceivedQty).Named("Qty Recd");
        column.For(item => item.ISBN).Named("ISBN");
        column.For(item => item.Title).Named("Title");
        column.For(item => item.Author).Named("Author");
        column.For(item => item.InboundShipment.Status).Named("Shipment Status");
        column.For(item => item.InboundShipment.ShipmentId).Named("Shipment #");
    }) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-19T09:54:26.403

```
@Html.Grid(Model).Columns(column =>
{
////
}).Sort((GridSortOptions)ViewData["sort"]) 
```

您必须在控制器中填写该 ViewData。

像那样

```
public ActionResult Index(GridSortOptions sort, int? page)
{
   ///
   ///FILL YOUR MODEL 
   ///IEnumerable<YourModel> list = YourData.ToList() as IEnumerable<YourModel>;

    if (sort.Column == null)
    {
        sort.Column = "DefaultSortColumnName";
        sort.Direction = MvcContrib.Sorting.SortDirection.Ascending;
    }

    ViewData["sort"] = sort;

    return View(list);
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-23T15:28:04.820

问题是**ViewBag.SortOptions 是 NULL**。因此，如果 GridSortOptions 对象为 null，则网格不会为标题列呈现任何排序链接。对我来说，这是愚蠢的行为。

# php - 如何在另一个库中加载库？

> ID：12095127
> 
> 赞同：1
> 
> 时间：2012-08-23T15:28:10.950
> 
> 标签：php, codeigniter

几年前有一个类似的问题，但我不太明白答案（[链接到问题](https://stackoverflow.com/questions/4281575/code-igniter-load-library-from-within-library)）

我的问题如下：我创建了一个从控制器调用的库，并且在该库中我使用了 CodeIgniter 提供的图像处理功能。但这显然是一个图书馆。从控制器来说没有问题：`$this->load->library('image_lib', $config);`$config 变量当然具有创建图像的参数。问题是：如何从另一个库中调用该库（并传递 $config 数组）？

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T15:30:51.870

在这里，您如何在助手和其他库中执行此操作：

```
$ci =& get_instance();

$config = array(
    //...
);
$ci->load->library('image_lib', $config);

$ci->image_lib->whatever(); 
```

您在这里所做的是获取 CodeIgniter 单例对象的实例并使用它，因为库无法使用，`$this`因为库中`$this`的 used 指向它们自己。简单地做所有你平常的事情，但使用`$ci->`而不是`$this->`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T15:35:07.407

您的**$this** var 将丢失它的 CodeIgniter 资源，要使用 CodeIgniter 资源，您必须创建它的另一个实例 get_instance();

```
$CI =& get_instance(); 
```

现在您可以像使用 $this 一样使用 $CI

您可以在“在您的库中使用 CodeIgniter 资源”下阅读更多相关信息[http://codeigniter.com/user_guide/general/creating_libraries.html](http://codeigniter.com/user_guide/general/creating_libraries.html)

# java - JButton 不执行任何操作

> ID：12095134
> 
> 赞同：1
> 
> 时间：2012-08-23T15:28:36.097
> 
> 标签：java, swing, jtable, jbutton, actionlistener

嗨，我有一个`JButton`定义：

```
private JButton btnExp;

private JPanel jpShow = new JPanel();
jpShow.setLayout(null);

btnExp = new JButton("Export");
btnExp.setBounds(100, 250, 120, 25);

jpShow.add(jspTable);
jpShow.add(btnExp);
//Adding Panel to Window.
getContentPane().add(jpShow);

public void actionPerformed(ActionEvent ae) {
    try{
        Object obj = ae.getSource();
        if (obj == btnExp) {
            FileWriter excel = new FileWriter("File.TSV");

            for(int i = 0; i < dtmCustomer.getColumnCount(); i++){
                excel.write(dtmCustomer.getColumnName(i) + "\t");
            }
            excel.write("\n");

            for(int i=0; i< dtmCustomer.getRowCount(); i++) {
                for(int j=0; j < dtmCustomer.getColumnCount(); j++) {
                    excel.write(dtmCustomer.getValueAt(i,j).toString()+"\t");
                }
                excel.write("\n");
            }
            excel.close();
            JOptionPane.showMessageDialog(this, "File Written","Success", JOptionPane.PLAIN_MESSAGE);
        }
    }catch(Exception e){
        System.out.println(e);
    }
} 
```

我试图`JTable`在用户单击按钮后将其导出，但没有任何反应，也没有引发异常。我做错了吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T15:32:03.130

您没有正确地将 ActionListener 添加到您的按钮。正确的方法是：

```
btnExp.addActionListener(new ActionListener() {
  public void actionPerformed(ActionEvent e) {
    // add here the contents in your actionPerformed method
  }
}) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-23T15:44:01.760

1.  您发布的代码甚至不会编译
2.  您应该将@Dan添加`ActionListener`到您的答案中`JButton`
3.  您应该确保`FileWriter`在一个`finally`块中关闭。现在，当发生异常时，它不会被关闭
4.  *如果您在Event Dispatch Thread*上导出表，您最终会得到一个无响应的 UI 。考虑使用`SwingWorker`. 有关更多信息，请参阅[Swing 中的并发](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/index.html)教程
5.  Avoid the use of `setLayout( null )` and `setBounds`. Use a decent `LayoutManager` instead

# c - 未初始化的值是否会带来安全风险？

> ID：12095135
> 
> 赞同：13
> 
> 时间：2012-08-23T15:28:36.463
> 
> 标签：c, security

在学习 C 时，我犯了一些错误并打印了未初始化的字符数组的元素。

如果我将数组的大小扩大到相当大，比如 100 万个元素，然后打印内容，结果并不总是用户不可读，但似乎包含一些运行时信息。

考虑以下代码：

```
#include <stdio.h>
main() {

        char s[1000000];
        int c, i;

        printf("Enter input string:\n");
        for (i = 0; ( c = getchar()) != '\n'; i++) {
                s[i] = c;
        }   

        printf("Contents of input string:\n");
        for (i = 0; i < 999999; i++) {
                putchar(s[i]);
        }   
        printf("\n");

        return 0;
} 
```

只需滚动浏览输出，我就会发现以下内容：

> ?? *?l??* ?????? _ dyldVersionNumber_dyldVersionString_dyld_all_image_infos_dyld_fatal_error_dyld_shared_cache_ranges_error_string__mh_dylinker_header_stub_binding_helper_dyld_func_lookup_offset_to_dyld_all_image_infos__dyld_start__ZN13dyldbootstrapL30randomizeExecutableLoadAddressEPK12macho_headerPPKcPm__ZN13dyldbootstrap5startEPK12macho_headeriPPKcl__ZN4dyldL17setNewProgramVarsERK11ProgramVars__ZN4dyld17getExecutablePathEv__ZN4dyld22mainExecutablePreboundEv__ZN4dyld14mainExecutableEv__ZN4dyld21findImageByMachHeaderEPK11mach_header__ZN4dyld26findImageContainingAddressEPKv

并且，

> Apple Inc.1&0$U ?0?*?H??ot CA0?"0ple Certification Authority10U ?䑩 ??GP??^y?-?6?WLU??Kl??"0?>?P ? A?????f?$kУ????z ?G?[?73??M?i??r?]?_???d5#KY?????P??XPg? ?ˬ, op??0??C??=?+I(??ε??^??=?:??? ?b??q?GSU?/A????p??LE~ LkP?A??tb
> ?!.t?< ?A?3???0X?Z2?h???es?g^e?I?v?3e?w??-??z0?v0U?0U ?0?0U+?iG?v ??k?.@??GM^0U#0?+?iG?v ??k?.@??GM^0?U 0?0 *??H??cd0? ?0+ [https:](https://www.apple.com/appleca/0?+0????Reliance) //www.apple.com/appleca/0?+0????任何一方对本证书的依赖假定接受当时适用的标准使用条款和条件，证书 poli?\6?Lx ?팛??w??v?w0O????=G7?@?,Ա?ؾ?s???d?yO4آ>?x?k??}9??S ?8ı??O 01* ? H??[d?c3w?:,V??!�sO??6?U٧??2B???q?~?R??B$*??M?^c?K?P???? ????7?uu!0?0??0

我相信有一次我的`$PATH`环境变量甚至被打印出来了。

未初始化变量的内容会带来安全风险吗？

**更新 1**

![激励者](../Images/541d8ffa240f12ea0d2186f8db978905.png)

**更新 2**

因此，从答案中可以清楚地看出这确实存在安全风险。这让我很惊讶。

程序是否无法声明其内存内容受保护以允许操作系统限制对它的任何访问，而不是初始化该内存的程序？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-23T15:41:05.780

大多数`C`程序用于`malloc`分配内存。一个常见的误解是将`malloc`返回的内存归零。它实际上没有。
结果，由于内存块被“回收”，因此很有可能获得具有“价值”信息的内存块。
此漏洞的一个示例是`tar`Solaris 上的程序，该程序发出`/etc/passwd`. 根本原因是分配给`tar`从磁盘读取块的内存未初始化，并且在获取此内存块之前，`tar`实用程序进行了 OS 系统调用 read `/etc/passwd`。`tar`由于内存回收和没有初始化块碎片的事实`/etc/passwd`被打印到日志中。这是通过替换解决`malloc`的`calloc`.
如果您没有明确且正确地初始化内存，这是一个安全隐患的实际示例。
所以是的，请正确初始化您的内存。

**更新：**

> 程序是否无法声明其内存内容受保护以允许操作系统限制对它的任何访问，而不是初始化该内存的程序？

答案是肯定的（见最后）和否定的。
我认为您在这里以错误的方式看待它。更合适的问题是，例如，为什么不`malloc`根据请求初始化内存或在释放时清除内存而是回收它？
答案是 API 的设计者明确决定不初始化（或清除内存），因为这样做对大块内存 1）会影响性能，并且 2）并不*总是*必要的（例如，您可能不会在您的应用程序中处理或您的应用程序中的几个部分，如果它们被暴露，您实际上关心的数据）。所以设计师决定不这样做，因为它会无意中影响性能，并将球交给程序员来决定。
所以也把这个带到操作系统，为什么清除页面应该是操作系统的责任呢？您希望您的操作系统及时将内存交给您，但安全性取决于程序员。

话虽如此，提供了一些机制，您可以使用它来确保敏感数据不会在 Linux中使用[mlock存储在交换中。](http://linux.die.net/man/2/mlock)

> mlock() 和 mlockall() 分别将调用进程的部分或全部虚拟地址空间锁定到 RAM 中，防止该内存被分页到交换区域。munlock() 和 munlockall() 执行相反的操作，分别解锁调用进程的部分或全部虚拟地址空间，以便在内核内存管理器需要时可以再次换出指定虚拟地址范围内的页面。内存锁定和解锁以整页为单位进行。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-08-23T15:32:19.263

是的，至少在数据可能传输给外部用户的系统上是这样。

对网络服务器（甚至 iPod）进行了一系列攻击，您可以通过这些攻击从其他进程中转储内存内容 - 从而获取操作系统类型和版本、其他应用程序中的数据甚至事物的详细信息像密码表

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-08-23T15:34:53.410

很有可能在内存区域执行一些敏感工作，而不清除该缓冲区。

然后，未来的调用可以通过调用`malloc()`或检查堆（通过统一的缓冲区/数组声明）来检索未清除的工作。它可以（恶意地）检查它或无意中复制它。如果您正在做任何敏感的事情，那么在分箱（或类似）之前清除该内存是有意义的`memset()`，也许在使用/复制它之前。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-23T15:45:39.510

来自 C 标准：

> 6.7.8 初始化
> 
> “如果具有自动存储持续时间的对象未明确初始化，则其值是不确定的。”

不确定值定义为：

```
 either an unspeciﬁed value or a trap representation. 
```

陷阱表示定义为：

> 某些对象表示不需要表示对象类型的值。如果对象的存储值具有这样的表示形式并且被不具有字符类型的左值表达式读取，则该行为是未定义的。如果这种表示是由一个副作用产生的，该副作用通过不具有字符类型的左值表达式修改对象的全部或任何部分，则行为是未定义的。41) 这种表示称为陷阱表示。

访问这样的值会导致未定义的行为，并可能构成安全威胁。

本文[对未初始化变量的攻击](http://www.blackhat.com/presentations/bh-europe-06/bh-eu-06-Flake.pdf)可以提供一些关于它们可用于利用系统的见解。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-23T15:38:32.757

如果您担心安全性，最安全的方法是始终初始化您将要使用的每个变量。它甚至可以帮助您找到一些错误。不初始化内存可能有一些很好的理由，但在大多数情况下，初始化每个变量/内存将是一件好事。

# javascript - 如何使用 match 从字符串中返回字符？

> ID：12095139
> 
> 赞同：0
> 
> 时间：2012-08-23T15:28:39.887
> 
> 标签：javascript, regex

我有以下文本，它位于一个名为 content 的长字符串中。

```
data-seq="0123abcd" 
```

以前我使用以下来匹配字符，但我不确定这样做是否正确，并且它不适用于不是八个字符的数量。

```
var a = content.match(/data-seq="(.{8}).*/)[1] 
```

我需要的是在 data-seq 之后`a`设置引号之间的**所有**字符，而不仅仅是上面的八个字符。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T15:37:53.923

这就是我将如何实现它：

```
var a = content.match(/data-seq="([^"]+)"/)[1] 
```

这将捕获双引号之间的所有内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T15:40:18.867

```
var a = content.match(/data-seq="([^"][a-zA-Z\-0-9]{3,4,8})"/)[1] 
```

仅匹配数字或字母（在引号之间），精确为 3,4 或 8 个字符。

# asp.net-mvc - mvc 没有从 url 中获取我的参数值

> ID：12095142
> 
> 赞同：0
> 
> 时间：2012-08-23T15:28:48.033
> 
> 标签：asp.net-mvc, asp.net-mvc-routing

```
context.Routes.Add(new DomainRoute(domain.DomainExpression, "{language}/{action}/{*urlPath}", new
{
    controller = "Routing",
    action = "Index",
    language = domain.WebsiteDefaultLanguageCulture,
    defaultLanguageName = domain.WebsiteDefaultLanguageCulture,
    sitenumber = domain.WebiteUniqueRefNumber
})); 
```

不管我在路由中定义的 {action} 参数如何，总是调用控制器 RoutingController.Index() 发生了什么。更糟糕的是，不能从 RouteData.Values 中选择 {language} 和 {*urlPath} - 只有在 RouteData.Values 中定义了默认值

任何人都可以帮助解释这一点吗？谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T15:45:21.057

麻烦解决了。- 这是因为我创建了“DomainRoute”的自定义路由，我在那里“主动”更新了默认值。

现在排序。

干杯。

# php - 电子邮件保护器：此代码今天仍然安全吗？

> ID：12095143
> 
> 赞同：1
> 
> 时间：2012-08-23T15:28:50.047
> 
> 标签：php, javascript

我从 css-tricks.com 找到了这个不错的电子邮件保护脚本[（链接）](http://css-tricks.com/snippets/php/email-protector/)

这是代码：

```
<?php
    function php_split_js_make_email($phpemail)
    {
        $pieces = explode("@", $phpemail);

        echo '
            <script type="text/javascript">
                var a = "<a href=\'mailto:";
                var b = "' . $pieces[0] . '";
                var c = "' . $pieces[1] .'";
                var d = "\' class=\'email\'>";
                var e = "</a>";
                document.write(a+b+"@"+c+d+b+"@"+c+e);
            </script>
            <noscript>Please enable JavaScript to view emails</noscript>
        ';
    }
?> 
```

用法

```
<?php php_split_js_make_email("youremail@here.com"); ?> 
```

现在我想知道这段代码今天有多安全，因为这篇文章已经有一年多了......

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T15:32:56.463

只有在嗅探您的页面以查找电子邮件地址的机器人不执行 JavaScript 时，该脚本才是安全的。

在[我的个人网站上](http://jumpingfishes.com)，我将我的电子邮件地址作为图像嵌入，并使用在线表单而不是 mailto 链接来发送邮件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T15:33:27.710

我猜你想防止机器人收集电子邮件地址？那么可能不会。越来越多的爬虫能够执行 javascript 代码，像[phantomjs](http://code.google.com/p/phantomjs/)这样的工具可以很容易地爬取 javascript 网站的内容。

一般来说，您应该尽量不要公开公开此类数据。有多少访问您页面的人对该地址感兴趣？

考虑为这些人添加某种身份验证检查，例如验证码或登录过程。或者反过来说：不要向**每个人**展示您不想抓取的敏感数据。请记住，没有 100% 的保护免受刮刀。哦，当使用验证码时，请使用一些合理的东西！我**敢打赌**，大多数机器人可以比我更好地解决重新验证码服务......在许多情况下，你可以解决一组非常基本的“常识”问题。

# sql - 立即索引定义

> ID：12095147
> 
> 赞同：1
> 
> 时间：2012-08-23T15:28:58.813
> 
> 标签：sql, postgresql, indexing, constraints

索引“立即”意味着什么？

我指的是 SQL 标准中的“索引”，但根据这个[PostgreSQL 文档](http://www.postgresql.org/docs/current/interactive/catalog-pg-index.html)可能更具体。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T15:43:11.033

这指示何时应用约束检查。从有关约束的文档中：

*SET CONSTRAINTS 设置当前事务中约束检查的行为。在每个语句的末尾检查 IMMEDIATE 约束。在事务提交之前不会检查 DEFERRED 约束。每个约束都有自己的 IMMEDIATE 或 DEFERRED 模式。*

UNIQUE 索引也是一个约束，所以这适用。

# .net - Visual Studio - 包管理器控制台 - 以编程方式运行命令

> ID：12095149
> 
> 赞同：2
> 
> 时间：2012-08-23T15:28:59.680
> 
> 标签：.net, visual-studio-2010, powershell, package-managers

每次更新生产网站时，我都需要运行 5 个命令，它们只是名称不同。

我想将其自动化（例如，将来我可能必须运行这些命令 100 次）。

我要做的是：

```
Update-Database -ConfigurationTypeName "SlaveConfiguration" -StartupProjectName "FacturatieMVCv2.Data" -Verbose -ConnectionString "Server=PC-1\SQLEXPRESS;Persist Security Info=True;Initial Catalog=Database1;uid=prog;password=ndp103@50;" -ConnectionProviderName "System.Data.SqlClient" 
Update-Database -ConfigurationTypeName "SlaveConfiguration" -StartupProjectName "FacturatieMVCv2.Data" -Verbose -ConnectionString "Server=PC-1\SQLEXPRESS;Persist Security Info=True;Initial Catalog=Database2;uid=prog;password=ndp103@50;" -ConnectionProviderName "System.Data.SqlClient" 
Update-Database -ConfigurationTypeName "SlaveConfiguration" -StartupProjectName "FacturatieMVCv2.Data" -Verbose -ConnectionString "Server=PC-1\SQLEXPRESS;Persist Security Info=True;Initial Catalog=Database3;uid=prog;password=ndp103@50;" -ConnectionProviderName "System.Data.SqlClient" 
Update-Database -ConfigurationTypeName "SlaveConfiguration" -StartupProjectName "FacturatieMVCv2.Data" -Verbose -ConnectionString "Server=PC-1\SQLEXPRESS;Persist Security Info=True;Initial Catalog=Database4;uid=prog;password=ndp103@50;" -ConnectionProviderName "System.Data.SqlClient" 
Update-Database -ConfigurationTypeName "SlaveConfiguration" -StartupProjectName "FacturatieMVCv2.Data" -Verbose -ConnectionString "Server=PC-1\SQLEXPRESS;Persist Security Info=True;Initial Catalog=Database5;uid=prog;password=ndp103@50;" -ConnectionProviderName "System.Data.SqlClient" 
```

我如何编写 i 脚本，以便在我输入控制台管理器时：

```
Update-Database -type Production -version latest 
```

它运行上面的所有命令，没有任何干扰。（所有连接字符串都位于一个 .XML 文件中，例如：

```
 <databases>
    <type>Production
        <database>Database1</database>
        <database>Database2</database>
        <database>Database3</database>
        <database>Database4</database>
        <database>Database5</database>
    </type>
 </databases> 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-23T16:48:14.127

如果我正确理解您的问题，您只是在询问如何从包管理器控制台中编写和执行 powershell 脚本。

1）用记事本在当前目录新建脚本：

```
notepad newScript.ps1 
```

2）将您的命令粘贴到记事本中

```
Update-Database...
Update-Datebase...
Update-Database... 
```

3) 保存记事本文件

4）通过在包管理器控制台中键入以下内容来执行记事本文件：

```
.\newScript.ps1 
```

请注意，powershell 函数和参数的使用超出了此答案的范围。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-23T17:26:45.613

我对包管理器控制台本身一无所知，但如果目标是从 XML 中读取一堆数据库名称，将它们弹出到连接字符串中，然后将它们传递给 cmdlet，那么下面应该可以帮助你：

```
$config = [xml](gc c:\path\to\config.xml)
$dbNames= $config.Databases.Type.Database

$dbNames|%{
  $connStr = "Server=PC-1\SQLEXPRESS;Persist Security Info=True;Initial Catalog=$_;uid=prog;password=ndp103@50;"
  Update-Database -ConfigurationTypeName "SlaveConfiguration" -StartupProjectName "FacturatieMVCv2.Data" -Verbose -ConnectionString $connStr -ConnectionProviderName "System.Data.SqlClient"
} 
```

# css - 将 Ext JS Panel 的背景样式更改为 Buttongroup 的背景样式

> ID：12095158
> 
> 赞同：2
> 
> 时间：2012-08-23T15:29:13.813
> 
> 标签：css, extjs, styles, panel, buttongroup

在 Ext JS 4.1.1 中，如何更改**面板 xtype**的背景？我想要实现的是面板的背景应该看起来像**buttongroup**的背景。

![在此处输入图像描述](../Images/766dded763ee7d3f80038c8d1fceaa5f.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T16:31:55.810

您可以简单地覆盖 CSS 或更改源代码，随心所欲。

例如，如果您想覆盖样式并保留源代码，您可以创建自己的自定义样式表并在 ext.js CSS 之后应用它

```
<link rel="stylesheet" type="text/css" media="screen" href="ext-all.css" />
<link rel="stylesheet" type="text/css" media="screen" href="custom.css" /> 
```

来自 ext-all.css

```
.x-panel-header-default {
    font-size: 11px;
    line-height: 15px;
    border-color: #99BBE8;
    border-width: 1px;
    border-style: solid;
    background-image: none;
    background-color: #CBDDF3;
    background-image: -webkit-gradient(linear,50% 0,50% 100%,color-stop(0%,#DAE7F6),color-stop(45%,#CDDEF3),color-stop(46%,#ABC7EC),color-stop(50%,#ABC7EC),color-stop(51%,#B8CFEE),color-stop(100%,#CBDDF3));
    background-image: -moz-linear-gradient(top,#DAE7F6,#CDDEF3 45%,#ABC7EC 46%,#ABC7EC 50%,#B8CFEE 51%,#CBDDF3);
    background-image: linear-gradient(top,#DAE7F6,#CDDEF3 45%,#ABC7EC 46%,#ABC7EC 50%,#B8CFEE 51%,#CBDDF3);
    -moz-box-shadow: #f4f8fd 0 1px 0 0 inset;
    -webkit-box-shadow: #F4F8FD 0 1px 0 0 inset;
    -o-box-shadow: #f4f8fd 0 1px 0 0 inset;
    box-shadow: #F4F8FD 0 1px 0 0 inset;
}

.x-toolbar-default {
    border-color: #99BBE8;
    background-image: none;
    background-color: #D3E1F1;
    background-image: -webkit-gradient(linear,50% 0,50% 100%,color-stop(0%,#DFE9F5),color-stop(100%,#D3E1F1));
    background-image: -moz-linear-gradient(top,#DFE9F5,#D3E1F1);
    background-image: linear-gradient(top,#DFE9F5,#D3E1F1);
} 
```

自定义.css

```
.x-panel-header-default {
    background-image: none;
    background-color: #D3E1F1;
    background-image: -webkit-gradient(linear,50% 0,50% 100%,color-stop(0%,#DFE9F5),color-stop(100%,#D3E1F1));
    background-image: -moz-linear-gradient(top,#DFE9F5,#D3E1F1);
    background-image: linear-gradient(top,#DFE9F5,#D3E1F1);
    -moz-box-shadow: none;
    -webkit-box-shadow: none;
    -o-box-shadow: none;
    box-shadow: none;
} 
```

您可以保留或覆盖您想要的任何内容，混合和匹配样式。

# c++ - DebugView 使我的应用程序崩溃

> ID：12095161
> 
> 赞同：0
> 
> 时间：2012-08-23T15:29:24.420
> 
> 标签：c++, visual-studio-2010, debugview

我有一个使用 Visual Studio 2010 在 C++ 中完成的应用程序，它使用 OutputDebugStringW 触发了很多调试信息（每秒大约 50 个，这显然很多）。

如果我打开关闭 DebugView 3 或 4 次，那么我的应用程序会变得不稳定并且崩溃或行为不正常。我已经尝试过使用另一个应用程序触发相同数量的调试打印（也在使用 VS 2010 完成的 C++ 中）并且我遇到了相同的行为，如果我在另一台计算机上尝试同样的事情。两台计算机都运行 Windows 7 32 位。

这些打印的长度被控制为不超过 512 个字符，所以我认为没有缓冲区溢出（OutputDebugStringW 似乎限制为 4kb 字符串）。

我试过用 Hoo Win Tail（这是一个类似于 DebugView 的软件），问题没有出现。

有人已经遇到过这个问题吗？

此致，

喷射

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T10:06:04.383

我假设您的应用程序中有一个（微妙的）竞争条件，只有当您的程序以不同的“速度”运行时才会暴露自己。

DebugView[将使您的应用程序运行速度变慢](http://blogs.msdn.com/b/darrenj/archive/2007/04/03/watch-out-debugview-outputdebugstring-performance.aspx)，因此会引入不同的时间。其他也捕获调试输出的工具在您的应用程序中没有表现出这种行为，这可能与它们引入了某种不同（更快/更慢）的时序有关。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-01T22:54:12.633

您可以尝试 DebugView++ ( [https://github.com/djeedjay/DebugViewPP/](https://github.com/djeedjay/DebugViewPP/) )，它几乎不会延迟跟踪的应用程序。

# c# - 如何穿过 MethodSymbol 的主体？

> ID：12095168
> 
> 赞同：2
> 
> 时间：2012-08-23T15:29:50.210
> 
> 标签：c#, roslyn

从全局命名空间，可以遍历所有命名空间：

```
foreach (NamespaceSymbol @namespace in globalNamespace.GetNamespaceMembers()) 
```

从每个命名空间，可以遍历它们的类：

```
foreach (NamedTypeSymbol @class in @namespace.GetTypeMembers()) 
```

类和方法或字段也是如此：

```
foreach (Symbol member in @class.GetMembers()) 
```

然而，我找不到任何方法来迭代方法的语句。我怎样才能继续遍历语义树？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T22:32:50.630

您需要找到用于声明符号的 SyntaxNode： [How to find the SyntaxNode for a method Symbol in a CompilationUnit?](https://stackoverflow.com/questions/11428662/how-to-find-the-syntaxnode-for-a-method-symbol-in-a-compilationunit)

然后，一旦有了 SyntaxNode（例如 MethodDeclarationSyntax），您就可以使用 DescendantNodes() 或 ChildNodesAndTokens 来遍历它。

# c# - 如何从 c# 代码中获取 asp 控件 ID？

> ID：12095170
> 
> 赞同：0
> 
> 时间：2012-08-23T15:30:02.313
> 
> 标签：c#, javascript, asp.net

我有一个 asp 控制按钮，当我在 IE 9 开发人员工具中查看它时，我看到它的 id 是 `ctl00_m_g_0e632166_55b3_4470_971c_bd562d4904c8_ctl00_Button2`.

有没有办法可以在 c# 代码中访问这个 id？像`Button2.getID`什么？

目前我正在插入需要找到这个控件来做各种事情的javascript代码，而我使用的方法并不好，它基本上是检查所有输入id的后缀是否为`Button2`. 我想找到更好的方法...

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T15:31:31.897

`Button2.ClientID`我想这就是你要找的东西。

文档：http: [//msdn.microsoft.com/en-us/library/system.web.ui.control.clientid.aspx](http://msdn.microsoft.com/en-us/library/system.web.ui.control.clientid.aspx)

您还可以通过设置[`ClientIDMode`](http://msdn.microsoft.com/en-us/library/system.web.ui.control.clientidmode.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-23T15:33:04.270

[Control.ClientID](http://msdn.microsoft.com/en-us/library/system.web.ui.control.clientid.aspx#Y0)应该为您提供 DOM 元素 ID。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-23T15:36:25.540

如果您的控件不在 repater 或网格中，并且它是页面独有的，您可以设置`ClientIDMode="Static"`它，它将是您给它的任何 ID。否则，您将不得不`ClientID`像其他人指出的那样使用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-23T15:50:56.880

alert($("#<%= Button2.ClientID %>").click());

# android - IntentService 使用 ThreadPoolExecutor... 推荐与否？

> ID：12095171
> 
> 赞同：2
> 
> 时间：2012-08-23T15:30:21.463
> 
> 标签：android, broadcastreceiver, intentservice, executors

我正在设计一个 android 应用程序，它将收听传入的 SMS 并以特定方式处理它们。我有一个接收消息并将其发送到意图服务的广播接收器：

```
Intent serviceIntent = new Intent(context, SMSIntentService.class);
serviceIntent.putExtras(intent.getExtras());
context.startService(serviceIntent); 
```

意图服务的目的是将 SMS 保存到我自己的数据库，然后通过 HTTP POST 将该消息发送到服务器，评估结果并更新应用程序的数据库并最终回复发送者。到目前为止一切都很好，但是由于有可能同时有很多 SMS 到达，我想将与服务器的通信解耦，将其放在另一个线程中。

所以到目前为止我正在做的是：

```
SmsDto sms = smsDataSource.saveSms(new SmsDto(originator, body, timestamp));

SMSProcessingTask task = new SMSProcessingTask(this.getApplicationContext(), sms);
Thread t = new Thread(task);
t.start(); 
```

到目前为止一切都很好，但我不相信这个有大量消息的实现。

所以，我的问题是：

在意图服务中，是否建议使用 ThreadPoolExecutor？我最终会得到这样的结果：

```
//in IntentService's onCreate
this.executor = Executors.newCachedThreadPool();

//in onHandleIntent()
executor.execute(task); 
```

如果一段时间内没有收到消息并且 IntentService 停止，会发生什么情况。它创建的线程会继续运行吗？

我不知道这种方法是否是处理我想要完成的事情的最佳方式。

谢谢

更新：

*   此应用程序中根本没有 UI 活动。
*   由于与服务器的通信可能需要相当长的时间，我想尽量减少消息的处理时间，因此队列中的下一条短信被快速提取并开始处理。

你

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T15:40:37.823

不，你不应该使用一个。主要原因是 SQlite 访问不是线程安全的，因此您不希望多个线程同时写入数据库。此外，如果您的任务碰巧更新了 UI，它就不会那样工作。

我真的不明白您为什么要执行这些任务： IntentService 已经从 UI 线程处理了它的消息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-05-27T13:09:30.567

您可以做的是使用 submit(Callable) 方法而不是 execute 方法。

这样你就可以得到一个带有你想在数据库中写入的数据的未来对象，并且没有线程会真正接触它，因为它不像 Phillippe 所说的那样安全

当我需要发送多个 httprquests 时，我以类似的方式使用它。我使用 SQL DB 管理它们，因此只在 onHandleIntent 上进行写入。

```
while(helper.requestsExists()){
        ArrayList<String> requestArr = helper.getRequestsToExcute(3);
        //checks if the DB requests exists
        if(!requestArr.isEmpty()){
            //execute them and delete the DB entry
            for(int i=0;i<requestArr.size();i++){
                file = new File(requestArr.get(i));
                Log.e("file",file.toString());
                Future<String> future = executor.submit(new MyThread(file,getApplicationContext()));

                Log.e("future object", future.toString());
                try {
                    long idToDelete = Long.parseLong(future.get());
                    Log.e("THREAD ANSWER", future.get() + "");
                    helper.deleteRequest(idToDelete);
                } catch (InterruptedException e) {
                    Log.e("future try", "");
                } catch (ExecutionException e) {
                    e.printStackTrace();
                }
            }
        }
    }
    executor.shutdown(); 
```

其次，在 onHandleIntent 完成之前，intentService 不会停止，即使这样，线程也会继续运行，直到完成工作

# ruby-on-rails - 巫术用户工厂无效

> ID：12095172
> 
> 赞同：0
> 
> 时间：2012-08-23T15:30:31.273
> 
> 标签：ruby-on-rails, rspec, factory-bot, sorcery

我正在尝试与 rspec 和 factory girl 一起编写更好的测试。我正在尝试测试我的用户模型，但我的第一个测试一直失败。我将 Sorcery 用于我的身份验证系统，但我找不到太多关于如何编写工厂的示例。我从巫术 github repo 上的一个问题中得到了线索，但测试仍然失败。

这是我的用户工厂：

```
# spec/factories/users.rb

FactoryGirl.define do
  salt = "asdasdastr4325234324sdfds"
  factory :user do
     sequence(:username)   { |n| "testuser#{n}" }
     slug              :username
     email                 { "#{username}@example.com" }
     password              "secret"
     password_confirmation "secret"
     salt                  salt
     crypted_password      Sorcery::CryptoProviders::BCrypt.encrypt("secret", salt)
     admin                 false
   end
 end 
```

这是模型测试：

```
# spec/models/user_spec.rb
require 'spec_helper'

describe User do
   it "has a valid factory" do
     FactoryGirl.create(:user).should be_valid
   end
end 
```

这是用户模型：

```
class User < ActiveRecord::Base
  authenticates_with_sorcery!

  # Use FriendlyId for better URLs
  extend FriendlyId
  friendly_id :username, :use => :slugged
  attr_accessible :username, :email, :password, :password_confirmation, :weburl, :time_zone, :bio

  validates_confirmation_of :password
  validates_presence_of :password, :on =>:create
  validates_presence_of :username
  validates_presence_of :email
  validates_uniqueness_of :username
  validates_uniqueness_of :email
end 
```

这是我得到的错误：

```
1) User has a valid factory
 Failure/Error: FactoryGirl.create(:user).should be_valid
  expected valid? to return true, got false
 # ./spec/models/user_spec.rb:6:in `block (2 levels) in <top (required)>' 
```

user_spec.rb 的第 6 行是`FactoryGirl.create(:user).should be_valid`

我确定我错过了一些东西。谁能指出我正确的方向？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T22:09:07.203

工厂说用户无效。要找出原因，请检查错误。

```
user = Factory.build(:user)
user.valid? # => false
user.errors.should be_empty # => fails, and prints the error hash 
```

# java - 优化批量插入，SQLite

> ID：12095176
> 
> 赞同：6
> 
> 时间：2012-08-23T15:30:35.113
> 
> 标签：java, sqlite

我正在尝试将不同的缓冲区大小插入本地 SQLite DB，并发现当缓冲区大小为 10,000 时，插入 10,000,000 行数据需要将近 8 分钟。换句话说，存储所有内容需要 1,000 次写入。

8 分钟存储 10,000,000 似乎有点太长（或者是吗？）

可以优化以下任何一项以提高速度吗？请注意，插入的数据是字符的随机集合。

```
public int flush() throws SQLException {
    String sql = "insert into datastore values(?,?,?,?);";

    PreparedStatement prep = con.prepareStatement(sql);

    for (DatastoreElement e : content) { // content is 10,000 elements long
        _KVPair kvp = e.getKvp();

        prep.setInt(1, e.getMetaHash());
        prep.setInt(2, kvp.hashCode());
        prep.setString(3, kvp.getKey());
        prep.setString(4, kvp.getValue());

        prep.addBatch();
    }

    int[] updateCounts = prep.executeBatch();

    con.commit();

    return errorsWhileInserting(updateCounts);
} 
```

创建表时，它是通过

```
 statement.executeUpdate("create table datastore 
               (meta_hash INTEGER," + 
               "kv_hash   INTEGER," + 
               "key TEXT," +
               "value TEXT);"); 
```

请问以上任何一个可以进一步优化吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-23T15:36:10.990

我对 Java API 有点模糊，但我认为你应该先启动一个事务，否则调用`commit()`是没有意义的。用`conn.setAutoCommit(false)`. 否则 SQLite 将为每个单独的插入/更新记录日志。这需要同步文件，这将导致速度变慢。

编辑：发问者更新说这已经设置为真。在这种情况下：

那是很多数据。这么长的时间听起来并不在这个世界之外。您可以做的最好的事情是使用不同的缓冲区大小进行测试。在缓冲区抖动太小和虚拟内存因大尺寸而启动之间存在平衡。出于这个原因，您不应该尝试一次将其全部放入一个缓冲区。将插入物分成您自己的批次。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-23T16:05:14.997

You are only executing `executeBatch`once, which means that all 10 million statements are send to the database in the `executeBatch` call. This is way too much to handle for a database. You should additionally execute `int[] updateCounts = prep.executeBatch();` in your loop let's say all 1000 rows. Just make an if statement which tests on `counter % 1000 == 0`. Then the database can asynchronously already work on the data you sent.

# tfs - TFS 2010 项目集合未在 VS 2012 中列出

> ID：12095181
> 
> 赞同：3
> 
> 时间：2012-08-23T15:30:52.260
> 
> 标签：tfs, visual-studio-2012

我最近安装了 Visual Studio 2012 (RTM)，但“连接到 Team Foundation Server”模式窗口的团队项目集合列表中缺少一个项目集合。项目集合在 VS 2008 和 VS 2010 中列出。TFS 管理控制台中的集合状态显示为在线。这不是最近创建的集合，它已有 2 多年的历史，有许多项目。Share Point、Web Access 和 Reporting Services 站点都可以正常工作。我运行了 Best Practices Analyzer 并没有看到任何突出的内容，尽管它包含很多信息并且我可能忽略了一些东西。我们正在运行从 TFS 2008 升级的 TFS 2010。

任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-22T06:13:05.287

我遇到了类似的问题，其中列出了项目集合，但是当我尝试连接到它时，团队资源管理器面板显示了 404 错误消息。

我通过清除我的用户配置文件本地应用程序数据文件夹下的 TFS 缓存文件夹解决了这个问题。

在 Windows 资源管理器中，转到 %LocalAppData%\Microsoft\Team Foundation。对于我的个人资料，有 3 个文件夹：2.0、3.0 和 4.0（大概对应于 TFS 2008、2010 和 2012），每个文件夹下都有一个 Cache 文件夹。我清除了所有 3 个缓存文件夹，然后能够成功连接。

# android - 我的 Android 智能手机无法从我的 Apache 服务器下载 apk，这是 Mime 类型的问题吗？

> ID：12095187
> 
> 赞同：1
> 
> 时间：2012-08-23T15:31:15.737
> 
> 标签：android, apache, tomcat, mime-types, apk

我在我的 Tomcat Apache 服务器上`MyApplication.apk`的一个目录`downloads`中，我在网页中创建了指向该文件的链接，以便我的 Android 智能手机能够下载和安装它。但是，它不能下载它，而我的 PC 网络浏览器可以。

我对 Stackoverflow（[例如这个主题](https://stackoverflow.com/questions/3569313/cant-install-apk-hosted-my-own-apache-server)）和网络进行了一些研究，发现我必须在我的服务器中添加 apk 文件的 mime 类型（`Server`在 Eclipse 中命名的项目中的文件 web.xml 中）。我这样做了。

我还看到我必须创建一个`.htaccess`，将它放在我调用的上下文中，然后写一行来添加 apk mime-type。我也这样做了。

但我仍然无法在我的智能手机网络浏览器中下载我的 apk！有人有想法吗？

注意：我使用 Eclipse 来运行我的 Apache Tomcat。我的应用程序已签名，其重量为 1.5MB。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2019-06-27T09:42:00.280

应该放`mime-type:application/vnd.android.package-archive`

# c# - 使用 System.Web.Script.Serialization 或 System.Web.* 库使用多语言文本解析 JSON

> ID：12095188
> 
> 赞同：0
> 
> 时间：2012-08-23T15:31:17.617
> 
> 标签：c#, asp.net, .net, json, rest

我以前[问过这个问题](https://stackoverflow.com/questions/11862004/implementing-google-transliterate-api-using-rest-and-c-facing-unicode-and-pars)。使用 Newtonsoft 的解决方案效果很好，直到我将网站部署在网络托管服务器上，它[让我做噩梦](https://stackoverflow.com/questions/12091141/missing-a-using-directive-or-an-assembly-reference-issue-after-deploying-an-asp/12091763#comment16159030_12091763)。因此，我打算使用一些`System.Web`库，这样我就不必处理 *.dll 等，我可以轻松地部署我的网站。

有人可以帮助我使用or any[解析相同的 json 输出](https://stackoverflow.com/questions/11862004/implementing-google-transliterate-api-using-rest-and-c-facing-unicode-and-pars)吗？非常感谢。`System.Web.Script.Serialization``System library`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T16:38:19.123

我希望您真正的 json 字符串是有效的，因为您发布的字符串已损坏，但 Json.Net 可以容忍它。

唯一的技巧是反序列化为这种有趣的类型`List<Dictionary<string,object>>`

这是一个带有更正 json 的示例（删除了尾随`,`s）

```
string json = @"[ { ""ew"" : ""bharat"", ""hws"" : [ ""\u092D\u093E\u0930\u0924"",""\u092D\u0930\u0924"",""\u092D\u0930\u093E\u0924"",""\u092D\u093E\u0930\u093E\u0924"",""\u092C\u0939\u0930\u0924"" ] }, { ""ew"" : ""india"", ""hws"" : [ ""\u0907\u0902\u0921\u093F\u092F\u093E"",""\u0907\u0928\u094D\u0921\u093F\u092F\u093E"",""\u0907\u0923\u094D\u0921\u093F\u092F\u093E"",""\u0908\u0928\u094D\u0921\u093F\u092F\u093E"",""\u0907\u0928\u0921\u093F\u092F\u093E"" ] } ]";
var list = new JavaScriptSerializer().Deserialize<List<Dictionary<string,object>>>(json);

foreach (var dict in list)
{
    var ew  = (string)dict["ew"];
    var firstValOfHws = ((ArrayList)dict["hws"])[0];
} 
```

**- 编辑 -**

好的，这应该可以

```
var serializer = new DataContractJsonSerializer(typeof(List<Result>));
var result = (List<Result>)serializer.ReadObject(new MemoryStream(Encoding.UTF8.GetBytes(json)));

public class Result
{
    public string ew;
    public List<string> hws;
} 
```

# eclipse - Eclipse 在设备（黑莓）上调试期间崩溃，并出现错误“手持设备正在重置：错误：myClass：已删除类。”

> ID：12095191
> 
> 赞同：3
> 
> 时间：2012-08-23T15:31:24.327
> 
> 标签：eclipse, blackberry, blackberry-jde, handheld

有时，当我运行我的黑莓项目时，我从 Eclipse 中收到此错误：“手持设备正在重置：错误：myClass：已删除类。

或者这个：

“手持设备正在重置：错误：无法打开端口。

之后，设备会自行重置，有时甚至 eclipse 也会崩溃。

情况不一致。也许有人可以提供帮助，甚至只是告诉我为什么或何时发生？

![在此处输入图像描述](../Images/ec1c7f774eef4ef996810d8f1cc563a6.png) ![在此处输入图像描述](../Images/8763842e8d12438f9700a261fade6dad.png)

# apache - Apache，远程服务器上的 2 个网站

> ID：12095192
> 
> 赞同：0
> 
> 时间：2012-08-23T15:31:24.507
> 
> 标签：apache, ubuntu

我需要在我的远程 Web 服务器上托管两个网站。它必须看起来像`ip.ip.ip.ip/site1`和`ip.ip.ip.ip/site2`。

如何在 Apache 和 Ubuntu 上做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T15:35:03.327

使用*alias*为目录起别名。

所以只需在 apache 配置文件的末尾添加如下内容：

```
alias /site1 /home/something/application1
alias /site2 /home/something/application2 
```

# sencha-touch - 煎茶触摸中的“大师”观

> ID：12095193
> 
> 赞同：0
> 
> 时间：2012-08-23T15:31:28.887
> 
> 标签：sencha-touch, extjs, sencha-touch-2

我想为我的 SenchaTouch2 应用程序创建 Master/Base 视图。它应该有页眉、页脚和内容区域。页眉和页脚是静态的，但内容应在具体视图中声明。我在 sencha docs 中找不到我的问题的解决方案。也许这是一个错误的方式？任何指向煎茶指南的链接都会有所帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T06:53:21.120

对于这种类型的功能，您可以使用导航视图或使用卡片布局创建任何一个视图，并放置两个您想要修复的顶部和底部停靠的项目，并根据需要更改第三个项目。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T10:24:55.723

您应该创建一个从 Container 或 Panel 扩展的视图，其中包含 3 个项目。您决定哪个 xtype（面板、容器、工具栏等）是您的页眉和页脚，您应该使用卡片布局并停靠在顶部或按钮：停靠：'top' 然后您可以使用第三个元素并更新视图根据您的需要并根据需要使用模型和控制器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-24T10:54:41.323

使用页眉和页脚容器定义一个新的 Ext.Container 类。然后创建它的新实例并插入内容视图。像这样的东西：

```
Ext.define('App.view.BaseView', {
    extend : 'Ext.Container',
    xtype : 'masterview',
    config : {
         items : [{
         xtype : 'container',
         height : 100,
         html : 'This is header',
         styleHtmlContent : true,
         // docked : 'top'      //if needed
       }, {
         xtype : 'container',
         height : 100,
         html : 'This is footer',
         styleHtmlContent : true,
         // docked : 'bottom'      //if needed
       }]
    }
}); 
```

并像这样使用它：

```
var panel = Ext.create('App.view.BaseView');
panel.insert(1, {
    xtype : 'container',
    html : 'This is concrete view'
}); 
```

这是最基本的例子。你可以按照你想要的方式调整它。

# facebook - 在 Coldfusion 应用程序中使用 Facebook、Google、Yahoo 和 hotmail 登录

> ID：12095195
> 
> 赞同：2
> 
> 时间：2012-08-23T15:31:39.200
> 
> 标签：facebook, login, coldfusion

我对冷融合很陌生。有人可以指导我如何使用 Facebook、Google、Yahoo 和 hotmail 创建登录。如果有人可以指出任何在线可用的教程。那很好啊。提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T16:12:09.510

我会为 Facebook 试一试：

[http://facebooksdk.riaforge.org/](http://facebooksdk.riaforge.org/)

而且我会说，一旦你开始工作，你就会对身份验证服务了解更多，并且可能能够自行开发其他服务。

这是谷歌的一个：

[http://cfgoogle.riaforge.org/](http://cfgoogle.riaforge.org/)

我不知道对 yahoo 或 hotmail 有什么好处。

# javascript - 仅下降到可见的元素

> ID：12095196
> 
> 赞同：7
> 
> 时间：2012-08-23T15:31:40.933
> 
> 标签：javascript, jquery, jquery-ui, drag-and-drop

我有以下内容：

我正在尝试对其进行设置，以便当您*拖动*项目时，它只会被拖放到您可以看到的 div 元素中，并且**不会**被覆盖。

所以我使用了这个js：

```
$(".draggable").draggable({
    helper: "clone"
})
$("#bottom, .draggable").droppable({
    drop: function(event, ui) {
        var $this = $(this),
            $dragged = $(ui.draggable);
        $this.append($dragged.clone());
    },
    hoverClass: "dragHover"
})​ 
```

但是，即使只有一个放置区**不**可见，它也会在**两个地方放置元素！**

 **我该如何解决它，以免**发生**这种情况？

小提琴：http: [//jsfiddle.net/maniator/Wp4LU/](http://jsfiddle.net/maniator/Wp4LU/)

* * *

***无需**小提琴即可重新创建页面的额外信息：*

HTML：

```
 <div id="top">
    <div class="draggable">
      Lorem ipsum dolor sit amet
    </div>

    <div class="draggable">
      Lorem ipsum dolor sit amet
    </div>

    <div class="draggable">
      Lorem ipsum dolor sit amet
    </div>

    <div class="draggable">
      Lorem ipsum dolor sit amet
    </div>

    <div class="draggable">
      Lorem ipsum dolor sit amet
    </div>

    <div class="draggable">
      Lorem ipsum dolor sit amet
    </div>

    <div class="draggable">
      Lorem ipsum dolor sit amet
    </div>

    <div class="draggable">
      Lorem ipsum dolor sit amet
    </div>

    <div class="draggable">
      Lorem ipsum dolor sit amet
    </div>

    <div class="draggable">
      Lorem ipsum dolor sit amet
    </div>

    <div class="draggable">
      Lorem ipsum dolor sit amet
    </div>

    <div class="draggable">
      Lorem ipsum dolor sit amet
    </div>

    <div class="draggable">
      Lorem ipsum dolor sit amet
    </div>

    <div class="draggable">
      Lorem ipsum dolor sit amet
    </div>

    <div class="draggable">
      Lorem ipsum dolor sit amet
    </div>

    <div class="draggable">
      Lorem ipsum dolor sit amet
    </div>

    <div class="draggable">
      Lorem ipsum dolor sit amet
    </div>

    <div class="draggable">
      Lorem ipsum dolor sit amet
    </div>

    <div class="draggable">
      Lorem ipsum dolor sit amet
    </div>

    <div class="draggable">
      Lorem ipsum dolor sit amet
    </div>

    <div class="draggable">
      Lorem ipsum dolor sit amet
    </div>

    <div class="draggable">
      Lorem ipsum dolor sit amet
    </div>

    <div class="draggable">
      Lorem ipsum dolor sit amet
    </div>

    <div class="draggable">
      Lorem ipsum dolor sit amet
    </div>

    <div class="draggable">
      Lorem ipsum dolor sit amet
    </div>

    <div class="draggable">
      Lorem ipsum dolor sit amet
    </div>
  </div>

  <div id="bottom"></div> 
```

CSS：

```
.draggable {
    border: 1px solid green;
    background: white;
    padding: 5px;
}

.dragHover{
    background: blue;
}

#top {
    height: 500px;
    overflow-y: scroll;
}
#bottom {
    height: 150px;
    overflow-y: scroll;
    border: red solid 4px;
} 
```

​</p>

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-26T11:18:52.897

如果我猜对了 - 这个应该可以解决你的问题 - [http://jsfiddle.net/Wp4LU/60/](http://jsfiddle.net/Wp4LU/60/) 你也可以编写自定义接受函数 - [http://jqueryui.com/demos/droppable/#option-accept](http://jqueryui.com/demos/droppable/#option-accept)

代码：

```
var draggableList = $('#top');

$(".draggable").draggable({
    helper: "clone"
});
$("#bottom, .draggable").droppable({
    drop: function(event, ui) {
        var $this = $(this),
            $dragged = $(ui.draggable);

        if ($this.hasClass("draggable")) {
            if ($this.position().top >= draggableList.height() || 
                $this.position().top + $this.outerHeight() >= 
                draggableList.height()) 
                return;
        }

        $this.append($dragged.clone());
    },
    hoverClass: "dragHover"
})​;​ 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-30T07:24:37.363

尝试设置`accept`功能。 ***[工作演示。](http://jsfiddle.net/Wp4LU/62/)***

```
$("#bottom, .draggable").droppable({
    drop: function(event, ui) {
        var $this = $(this),
            $dragged = $(ui.draggable);
        $this.append($dragged.clone());
    },
    accept: function () {
        var $this = $(this), divTop= $("#top");
        if ($this.is(".draggable")) {
          return $this.offset().top < divTop.offset().top + divTop.height() ;
        }
        return true;
    },
    hoverClass: "dragHover"
})​;​ 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-30T06:42:03.310

根据消息来源 (jquery.ui.droppable.js)，drop 操作将搜索每个符合条件的 droppable 并将 drop 函数应用于与其相交的每个：

```
drop: function(draggable, event) {

    var dropped = false;
    $.each($.ui.ddmanager.droppables[draggable.options.scope] || [], function() {

        if(!this.options) return;
        if (!this.options.disabled && this.visible && $.ui.intersect(draggable, this, this.options.tolerance))
            dropped = this._drop.call(this, event) || dropped; 
```

（旧版本的最后一个“OR”条件被颠倒了，所以它只适用于一个可放置的对象。使用 jQuery 1.5.2 / jQuery UI 1.8.9 试试你的小提琴，并看到它只下降到一个元素，尽管“错了”一个……）

并且当前在函数中实现的每个公差模式`$.ui.intersect`只考虑 (x,y) 坐标：

```
switch (toleranceMode) {
    case 'fit':
        return (l <= x1 && x2 <= r
            && t <= y1 && y2 <= b);
        break;
    case 'intersect':
        return (l < x1 + (draggable.helperProportions.width / 2) // Right Half
            && x2 - (draggable.helperProportions.width / 2) < r // Left Half
            && t < y1 + (draggable.helperProportions.height / 2) // Bottom Half
            && y2 - (draggable.helperProportions.height / 2) < b ); // Top Half
        break;
    ... 
```

因此，除非有人添加了 z-index 感知容差模式，否则您唯一的选择是以某种方式解决该问题。我建议首先将每个可放置的候选者添加到一个集合中，当该放置时，只选择离屏幕“最近”的那个：

```
$("#bottom, .draggable").droppable({
    over: function(event, ui) {
        if ( !ui.draggable.data("drop-candidates") )
            ui.draggable.data("drop-candidates",[]);
        ui.draggable.data("drop-candidates").push(this);
    },
    out: function(event, ui) {
        var that = this,
            candidates = ui.draggable.data("drop-candidates") || [];
        ui.draggable.data("drop-candidates", $.grep(candidates, function(e) {
            return e != that;
        });
    },
    drop: function(event, ui) {
        var $this = $(this),
            $dragged = $(ui.draggable);
        var candidates = $.data("drop-candidates").sort(closestToScreen);
        if ( candidates[0] == this )
            $this.append($dragged.clone());
    },
    hoverClass: "dragHover"
})​ 
```

现在，实现`closestToScreen`比较器是棘手的部分。[W3C CSS 规范](http://www.w3.org/TR/CSS2/visuren.html#layers)描述了渲染引擎应该如何对要绘制的元素进行排序，但到目前为止我还没有找到一种简单的方法来访问这些信息。我也在SO这里[问过这个问题](https://stackoverflow.com/q/12190338/520779)，也许有人会找到一个好方法。

* * *

PS 如果修改 jQuery UI 源**是**一个选项，您可以尝试使用实现 z-index 感知容差模式[`document.getElementFromPoint`](https://developer.mozilla.org/en-US/docs/DOM/document.elementFromPoint)，因为对上述问题的[回答](https://stackoverflow.com/a/12190361/520779)建议：

```
var x1 = (draggable.positionAbs || draggable.position.absolute).left, x2 = x1 + draggable.helperProportions.width,
    y1 = (draggable.positionAbs || draggable.position.absolute).top, y2 = y1 + draggable.helperProportions.height;
switch (toleranceMode) {
    ...
    case 'z-index-aware':
        return document.elementFromPoint(x1,y1) == droppable;
        break; 
```

（这将确保**只有**可拖动的左上角正下方的元素将被视为“足够好”作为放置目标 - 不理想，但比我们目前所拥有的更好；可以调整类似的解决方案以使用而是鼠标指针坐标）

而且，不，您不能将此方法与之前提出的解决方法一起使用：在拖放发生的那一刻，*拖动助手*是最靠近屏幕的元素......（*编辑：* d'oh！如果出于同样的原因，也可以作为容差模式实现......）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-30T07:33:01.430

如果您只想放在元素上，您可以看到您可以更改选择器：

```
$(".draggable:visible").draggable({
    helper: "clone"
});
$("#bottom, .draggable:visible").droppable({
    drop: function(event, ui) {
        var $this = $(this),
            $dragged = $(ui.draggable);
        $this.append($dragged.clone());
    },
    hoverClass: "dragHover"
})​; 
```

或者当你隐藏一个元素时，用别的东西改变它的可拖动类。**

# objective-c - NSJSONSerialization 只获取根密钥

> ID：12095200
> 
> 赞同：2
> 
> 时间：2012-08-23T15:31:59.623
> 
> 标签：objective-c, ios, json, parsing, nsjsonserialization

我在使用 NSJSONSerialization 从 PHP 服务器解析 JSON 时遇到问题。JSLint 说我的 JSON 是有效的，但似乎只能进入一两个级别。

这本质上是我的 JSON 结构：

```
{
    "products":
    [{
        "product-name":
        {
            "product-sets":
            [{
                "set-3":
                {
                    "test1":"test2",
                    "test3":"test4"
                },
                "set-4":
                {
                    "test5":"test6",
                    "test7":"test8"
                }
            }]
        },
        "product-name-2":
        {
            "product-sets":
            [{

            }]
        }
    }]
} 
```

这是我解析它的代码：

```
NSDictionary *json = [NSJSONSerialization JSONObjectWithData:responseData options:kNilOptions error:&error];
if (json) {
    NSArray *products = [json objectForKey:@"products"];              // works
    for (NSDictionary *pItem in products) {                           // works
        NSLog(@"Product: %@", pItem);                                 // works, prints the entire structure under "product-name"
        NSArray *productSets = [pItem objectForKey:@"product-sets"];  // gets nil
        for (NSDictionary *psItem in productSets) {
            // never happens
        }
    }
} 
```

我已经为此旋转了几个小时，但在我搜索的任何地方都找不到类似的东西。是否有任何我不知道的限制，或者我只是没有看到明显的东西？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T16:45:54.953

你错过了一个嵌套对象

```
NSArray *productSets = [[pItem objectForKey:@"product-name"] objectForKey:@"product-sets"]; 
```

我用这个 CLI 程序测试了它

```
#import <Foundation/Foundation.h>

int main(int argc, const char * argv[])
{

    @autoreleasepool {

        NSString *jsonString = @"{\"products\":[{\"product-name\": {\"product-sets\": {\"set-3\":{\"test1\":\"test2\", \"test3\":\"test4\"}, \"set-4\":{\"test5\":\"test6\", \"test7\":\"test8\"} }}}, {\"product-name-2\": \"2\"}]}";
        // insert code here...
        NSLog(@"%@", jsonString);
        NSError *error;
        NSDictionary *json = [NSJSONSerialization JSONObjectWithData:[jsonString dataUsingEncoding:NSUTF8StringEncoding] options:kNilOptions error:&error];

        if (json) {
            NSArray *products = [json objectForKey:@"products"];              // works
            for (NSDictionary *pItem in products) {                           // works
                NSLog(@"Product: %@", pItem);                                 // works, prints the entire structure under "product-name"
                NSArray *productSets = [[pItem objectForKey:@"product-name"] objectForKey:@"product-sets"];  // gets nil
                for (NSDictionary *psItem in productSets) {
                    NSLog(@"%@", psItem);
                }
            }
        }

    }
    return 0;
} 
```

* * *

请注意，您的 json 中的某些内容很奇怪：

对于每个展平的对象，键应该是相同的。包含数字或对象的键没有多大意义。如果您需要跟踪单个对象，请包含具有适当值的 id 键。

# c++ - VS 2010：2 个重载有类似的转换

> ID：12095205
> 
> 赞同：3
> 
> 时间：2012-08-23T15:32:10.090
> 
> 标签：c++, overloading

我不明白这里发生了什么

```
class A{};
class B : A {};

void func(A&, bool){}
void func(B&, double){}

int main(void)
{
    B b;
    A a;
    bool bo;
    double d;

    func(b, bo);
} 
```

编译时，Visual 2010 在线给我这个错误`func(b, bo);`

```
2 overloads have similar conversions
could be 'void func(B &,double)'
or       'void func(A &,bool)'
while trying to match the argument list '(B, bool)' 
```

我不明白为什么 bool 参数不足以解决过载问题。我已经看到[了这个问题](https://stackoverflow.com/questions/3723112/2-overloads-have-similar-conversions)，并且正如接受的答案所指出的那样， bool 应该更喜欢 bool 重载。就我而言，我看到第一个参数不足以选择好的功能，但为什么第二个参数不能解决歧义？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-23T15:42:05.687

重载规则比你想象的要复杂一些。您分别查看每个参数并**为该参数**选择最佳匹配。然后，如果恰好有一个重载为每个参数提供了最佳匹配，那就是被调用的那个。在示例中，第一个参数的最佳匹配是 的第二个版本`func`，因为它只需要转换`B`为`B&`; 另一个版本`func`需要先转换`B`为. 对于第二个参数，第一个版本`B&``B&``A&``func`是最佳匹配，因为它不需要转换。第一个版本有第二个参数的最佳匹配，但它没有第一个参数的最佳匹配，所以不考虑它。同样，第二个版本对第一个参数有最佳匹配，但对第二个参数没有最佳匹配，因此不考虑。现在没有`func`left 的版本，调用失败。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-23T15:54:46.627

Overload resolution rules are even more complicated than Pete Becker wrote. For each overload of `f`, the compiler counts not only the number of parameters for which conversion is required, but the rank of conversion.

**Rank 1**

> No conversions required
> 
> Lvalue-to-rvalue conversion
> 
> Array-to-pointer conversion
> 
> Function-to-pointer conversion
> 
> Qualification conversion

**Rank 2**

> Integral promotions
> 
> Floating point promotions

**Rank 3**

> Integral conversions
> 
> Floating point conversions
> 
> Floating-integral conversions
> 
> Pointer conversions
> 
> Pointer to member conversions
> 
> Boolean conversions

Assuming that all candidates are non-template functions, a function wins if and only if it has a parameter which rank is better than the rank of the same parameter in other candidates and the ranks for the other parameters are not worse.

Now let's have a look at the OP case.

*   `func(A&, bool)`: conversion B&->A& (rank 3) for the 1st parameter, exact match (rank 1) for the 2nd parameter.
*   `func(B&, double)`: exact match (rank 1) for the 1st parameter, conversion `bool->double` (rank 3) for the 2nd parameter.

Conclusion: noone wins.

# string - 如何在数据网格中正确地向用户显示 int 类型的空值作为字符串，例如“未指定”？

> ID：12095207
> 
> 赞同：1
> 
> 时间：2012-08-23T15:32:20.620
> 
> 标签：string, silverlight, int, nullable, silverlight-5.0

我有一个 RadGridView (Telerik)，其中有几列代表可为空的整数。我试过使用

`TargetNullValue='Not specified'`（在 XAML 中）

和

`[DisplayFormat(NullDisplayText = "Not specified")]`（关于元数据类）

但这些都没有奏效。我相信这很可能是因为我混淆了字符串和 int 数据类型，而 GridView 拒绝了它。我的用户要求，如果为月份指定了一个条目（表示为 GridView 中的行），但他们希望以某种方式调用它的 int 字段没有值。我知道我可以使用控件的条件颜色格式，但这实际上是用于其他用途，所以它不是一个选项。当然，显示的任何内容都不应绑定到实际的实体值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T15:31:17.077

对于这种情况，通常的答案是：编写一个自定义的[ValueConverter](http://msdn.microsoft.com/fr-fr/library/system.windows.data.ivalueconverter%28v=VS.95%29.aspx)来做到这一点。

```
public object Convert(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
{
    int? num = value as int?;
    if (num != null)
    {
        return num;
    }
    else
    {
        return "Not specified";
    }
}

public object ConvertBack(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
{
    int num;
    if (int.TryParse(value.ToString(), out num))
    {
        return num;
    }
    else
    {
        return null;
    }
} 
```

# javascript - 如何在ajax请求中将多组数据作为单个变量发布？

> ID：12095216
> 
> 赞同：1
> 
> 时间：2012-08-23T15:32:58.013
> 
> 标签：javascript, jquery, ajax

我目前有一个 jQuery ajax 函数，它向我的服务器发布一个多维数组。

```
$.ajax({
  type: "POST",
  url: "Default.aspx/SaveQuoteProcesses",
  data: "{'items':" + JSON.stringify(jaggedArray) + "}",
  contentType: "application/json; charset=utf-8",
  dataType: "json",
  success: function (msg){
    console.log('Success');
  },
  error: function (){
    console.log('Fail');
  }
}); 
```

这是我当前发布到服务器的数据集示例：

```
[
    {"QpcOpsID":"22","QpcQitID":"63"},
    {"QpcOpsID":"20","QpcQitID":"63"},
    {"QpcOpsID":"26","QpcQitID":"63"},
    {"QpcOpsID":26,"QpcQitID":"63","QpcPprID":6,"PprQuestion":"How many colors?","AnswerValue":"4"}
] 
```

我现在需要在同一个 AJAX 请求中向服务器发送一个常规数组。

```
["22", "20", "26"] 
```

如何在现有的 javascript 对象中包含这个新数组？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T15:35:47.357

```
var data = {
  items: jaggedArray,
  newArray: ["22", "20", "26"]
}; 
```

然后只是`JSON.stringify(data)`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T15:34:43.957

您可以将数组添加为发送的 JSON 的另一个属性 -

```
data: "{'items':" + JSON.stringify(jaggedArray) + ",'additionalArray':"+JSON.stringify(YOUR_ARRAY)+"}", 
```

# properties - 为什么在 D 中使用@property？

> ID：12095225
> 
> 赞同：7
> 
> 时间：2012-08-23T15:33:29.900
> 
> 标签：properties, d

我通过尝试发现

```
struct PropertyTest
{
    @property int x() { return val; }
    @property void x( int newVal ) { val = newVal; }

    void test()
    {
        int j;
        j = x;
        x = 5;
    }

private:
    int val;
} 
```

当我离开时完全一样`@property`。一切都编译得很好。那么将函数声明为有什么意义`@property`呢？

顺便说一句，我正在使用 dmd2 编译器。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-23T16:05:29.267

他们没有工作的原因`@property`是因为`@property`在他们允许属性方法语法之后添加。添加`-property`到 DMD 命令行会强制使用`@property`注释。出于向后兼容性的原因，它不是默认设置。总有一天它将成为默认值（或者他们这么说），因此最好使用它进行编译`-property`以确保您正确注释。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T15:37:15.247

它允许您使用不带括号的无参数方法（如读取变量），并允许您调用不带括号的单参数方法，就像您分配给变量的方式一样。

```
@property int foo() { ... }
@property void bar(int x) { ... }

void main()
{
    bar = foo;
} 
```

您应该指定`-property`编译器的命令行选项。

# iphone - iPhone UIwebview 移动网络应用程序的持久 cookie

> ID：12095228
> 
> 赞同：0
> 
> 时间：2012-08-23T15:33:51.033
> 
> 标签：iphone, asp.net-mvc, session-cookies, mobile-website

我正在使用 MVC4 表单身份验证。我的移动网络应用程序在 iphone 上以全屏 UIwebview 运行。我的移动网络应用程序有一个主屏幕图标。该应用程序需要启动外部链接。那些在 Safari 中启动，效果很好。但是，通过再次单击主屏幕图标返回移动 Web 应用程序，似乎已将用户注销。理想情况下，我希望用户在 Safari 中查看外部链接后保持登录到 Web 应用程序。也许cookie被删除了？我可以保留 cookie 吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T15:24:18.077

```
FormsAuthentication.SetAuthCookie(username, createPersistentCookie: true); 
```

这解决了注销问题

# asp.net - Disable Gridview Row

> ID：12095232
> 
> 赞同：0
> 
> 时间：2012-08-23T15:34:01.127
> 
> 标签：asp.net, gridview, row

The problem I am having is in a gridview I have multiple buttons and some dropdowns. Anytime the buttons or dropdowns are acted upon, I need either the entire row to be disabled until the postback completes, or all the items in the row to be disabled until the postback is complete. The reason for this is that anytime there are multiple clicks or, essentially, multiple postbacks trying to occur, my page freezes up and requires a refresh. I'm really not even sure where to start so any help would be greatly appreciated. Thanks!

The application we are using is kinda old and we dont have jQuery. I talked to my team lead about it and he says we can try it but it would have to get approved from the higher ups and that may take a while. Any other ideas?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T15:44:06.217

您可以使用[`jQuery`](http://jquery.com/)禁用提交按钮：

```
$('form').submit(function(){  
      $(':submit', this).click(function() {  
         return false;  
     });  
 }); 
```

您还可以使用`jQuery`插件[BlockUI](http://malsup.com/jquery/block/#demos)来阻止您点击任何内容。

# c# - Disable groupbox and keeping context menu enabled

> ID：12095233
> 
> 赞同：0
> 
> 时间：2012-08-23T15:34:04.380
> 
> 标签：c#, winforms, contextmenu, groupbox

I'm in the process of porting a legacy VB application to C#/Winforms. While the vast majority of the user interface is complete, I have a problem that I've not been able to solve after some digging. My form contains a bunch of group boxes, all identical (except for some identifier, e.g. group box name), each of which contains several controls. I have a context menu that pops up which allows me to open child forms which allow me to change some settings, etc. Each of these group boxes represents a physical object, which can be disabled. When I disable the group box, all the children of the box are then disabled or made invisible. When the group box is disabled, the context strip menu also changes so that some of the menu items on the context menu are disabled, and then the "Enabled" menu selection toggles between checked and unchecked, showing the current state. The problem is, when I disable one of the group boxes, the box is disabled, but the context menu no longer opens when I click on the group box. This isn't terribly surprising, but I'm trying to figure out how to disable the group box while keeping the context menu enabled all the time. I need to be able to disable one or more of these group boxes; the way things are, once I disable a group box I have no way of enabling it again, since the context menu no longer fires.

The old VB code manages to do this, but it's not terribly clear how and the code is more or less a mess I'd rather not spend time reverse engineering.

Thanks for any suggestions on how I can accomplish this. I suppose a work around might be to just make all the controls within the group box invisible, and then change the color of the group box to "appear" disabled.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T16:29:51.653

我通过简单地隐藏所有控件并更改框的颜色使其显示为禁用来解决了这个问题。

# jquery - Can't add datepicker option?

> ID：12095235
> 
> 赞同：2
> 
> 时间：2012-08-23T15:34:16.040
> 
> 标签：jquery, datepicker

I have a form wich dynamically creates a new row with a couple of form inputs. One of the inputs has a datepicker attached to it. I just managed with the help from here, to make this work. Except there is one problem left, as soon when i want to add options to the datepicker, it stops working...

Working fiddle: [http://jsfiddle.net/HermesTrismegistus/Bt9eU/](http://jsfiddle.net/HermesTrismegistus/Bt9eU/)

And a not working fiddle: [http://jsfiddle.net/HermesTrismegistus/TTNEP/](http://jsfiddle.net/HermesTrismegistus/TTNEP/)

Its about this line:

```
$(".datepick").datepicker(); 
```

When i add the options to it.. It seems to stop functioning.

```
$(".datepick").datepicker("option", "dateFormat", "dd-mm-yy"); 
```

Does someone knows the solution to this?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T15:39:31.343

将您的两个日期选择器实例更改为：

```
$(".datepick").datepicker({ dateFormat: "dd-mm-yy" }); 
```

实例化日期选择器后，您使用的代码可用于更改选项。上面的代码在您实例化它时设置选项。

**[jsFiddle 示例](http://jsfiddle.net/j08691/TTNEP/2/)**

# javascript - possible to hide fakepath only for non-FF browsers?

> ID：12095237
> 
> 赞同：1
> 
> 时间：2012-08-23T15:34:22.847
> 
> 标签：javascript, input, filenames

I'm working mostly in FF, and this code works perfectly for displaying the uploaded item's filename (without path). On all the other browsers I've tested (Chrome, Safari, Opera), you see fakepath. But when I tried various suggested methods to get rid of 'fakepath', FF stops working entirely. And sometimes even what seems to be a Chrome-friendly approach shows up with the odd filename of "Object object", even as it breaks in FF. The whole 'fakepath' thing is bound to confuse the intended audience of less-savvy users, so I'd like to strip it out if I could. But since FF behaves as I want from the get-go, is there a way to only strip the fakepath part if the browser != FF? And if so, what will get me actual stripped-filename (as opposed to Object object)?

This is the version that works in FF:

```
$('input[name="file"]').change(function(){
    var filename = $(this).val();
    $('<span class="fileshow">'+ filename +'</span>').insertAfter($(this));
}); 
```

And this gets me Object object in Chrome, so something's wrong but I'm not sure what.

```
$('input[name="file"]').change(function(){
    var filename = $(this).val(this.files && this.files.length ?
    this.files[0].name : this.value.replace(/^C:\\fakepath\\/i, ''));
    $('<span class="fileshow">'+ filename +'</span>').insertAfter($(this));
}); 
```

Thanks in advance for the help.

# javascript - javascript replace() in string

> ID：12095238
> 
> 赞同：0
> 
> 时间：2012-08-23T15:34:23.503
> 
> 标签：javascript, string, replace

I'm using the Hype api which generates a javascript file. In that javascript file is the following variable.

I need to change all instances of "#A0A0A0" to a different colour. lets say: "#FF0000". I also need to replace all instances of "#2B2B2B" top a different colour. Lets say "#CCCCCC".

```
var scenes = [{onSceneLoadAction:{type:4,javascriptOid:"6504DC50-C2B8-42D6-9556-7604B01CCCE4-11054-00001758C12D4A4D"},timelines:{kTimelineDefaultIdentifier:{framesPerSecond:30,animations:[],identifier:"kTimelineDefaultIdentifier",name:"Main Timeline",duration:0}},sceneIndex:0,perspective:"600px",oid:"0C38683C-FB04-48C9-B2AA-C359BF30816A-11054-00001051897508E1",initialValues:{"54968410-F25B-4F59-93A6-DBA7A054AEE6-11054-000016DDAE33BD35":{b:86,z:"4",K:"Solid",c:608,bC:-1,L:"Solid",d:15,aS:6,M:1,bD:"none",bB:-1,N:1,aT:6,O:1,g:"#F0F0F0",aU:6,P:1,aV:6,i:"but3",j:"absolute",k:"div",l:"0deg",m:"#2B2B2B",n:"#7B7C7C",aZ:0,A:"#A0A0A0",B:"#A0A0A0",Z:"break-word",r:"inline",C:"#A0A0A0",D:"#A0A0A0",t:13,F:"left",G:"#F2F2F2",aP:"pointer",w:"Button",bA:"#484949",x:"visible",I:"Solid",a:73,y:"preserve",J:"Solid"},"A7459097-CAF4-4E5F-8996-3A8FB91E0AC5-11054-0000186AE9EA70BB":{b:206,z:"9",K:"Solid",c:608,bC:-1,L:"Solid",d:15,aS:6,M:1,bD:"none",bB:-1,N:1,aT:6,O:1,g:"#F0F0F0",aU:6,P:1,aV:6,i:"but7",j:"absolute",k:"div",l:"0deg",m:"#2B2B2B",n:"#7B7C7C",aZ:0,A:"#A0A0A0",B:"#A0A0A0",Z:"break-word",r:"inline",C:"#A0A0A0",D:"#A0A0A0",t:13,F:"left",G:"#F2F2F2",aP:"pointer",w:"Button",bA:"#484949",x:"visible",I:"Solid",a:73,y:"preserve",J:"Solid"},"2D67FF4C-B0ED-42A3-896E-E0B3C105014C-11054-000068248215A681":{G:"#000000",aU:8,c:606,aV:8,r:"inline",d:385,t:14,g:"#F6F6F6",Z:"break-word",i:"text_txt",w:"New Text",j:"absolute",x:"visible",k:"div",y:"preserve",z:"1",aS:8,aT:8,a:73,b:55},"71B60371-D4CF-49BF-91BD-CC44BD204691-11054-00001868C7E4F78F":{b:146,z:"7",K:"Solid",c:608,bC:-1,L:"Solid",d:15,aS:6,M:1,bD:"none",bB:-1,N:1,aT:6,O:1,g:"#F0F0F0",aU:6,P:1,aV:6,i:"but5",j:"absolute",k:"div",l:"0deg",m:"#2B2B2B",n:"#7B7C7C",aZ:0,A:"#A0A0A0",B:"#A0A0A0",Z:"break-word",r:"inline",C:"#A0A0A0",D:"#A0A0A0",t:13,F:"left",G:"#F2F2F2",aP:"pointer",w:"Button",bA:"#484949",x:"visible",I:"Solid",a:73,y:"preserve",J:"Solid"},"9D98FA63-EDF2-48EC-A221-65DCAD6618DA-11054-00001867C6EC1CB4":{b:116,z:"6",K:"Solid",c:608,bC:-1,L:"Solid",d:15,aS:6,M:1,bD:"none",bB:-1,N:1,aT:6,O:1,g:"#F0F0F0",aU:6,P:1,aV:6,i:"but4",j:"absolute",k:"div",l:"0deg",m:"#2B2B2B",n:"#7B7C7C",aZ:0,A:"#A0A0A0",B:"#A0A0A0",Z:"break-word",r:"inline",C:"#A0A0A0",D:"#A0A0A0",t:13,F:"left",G:"#F2F2F2",aP:"pointer",w:"Button",bA:"#484949",x:"visible",I:"Solid",a:73,y:"preserve",J:"Solid"},"8CD4A5EE-2A4D-4D3B-A0A2-198CC4B8A67D-11054-000016DC367A6443":{b:56,z:"3",K:"Solid",c:608,bC:-1,L:"Solid",d:15,aS:6,M:1,bD:"none",bB:-1,N:1,aT:6,O:1,g:"#F0F0F0",aU:6,P:1,aV:6,i:"but2",j:"absolute",k:"div",l:"0deg",m:"#2B2B2B",n:"#7B7C7C",aZ:0,A:"#A0A0A0",B:"#A0A0A0",Z:"break-word",r:"inline",C:"#A0A0A0",D:"#A0A0A0",t:13,F:"left",G:"#F2F2F2",aP:"pointer",w:"Button",bA:"#484949",x:"visible",I:"Solid",a:73,y:"preserve",J:"Solid"},"42F7484E-2372-40FD-AE98-DF55B5D519EE-11054-000016D491A38B6A":{b:26,z:"2",K:"Solid",c:608,bC:-1,L:"Solid",d:15,aS:6,M:1,bD:"none",bB:-1,aT:6,N:1,O:1,g:"#F0F0F0",aU:6,P:1,aV:6,i:"but1",j:"absolute",k:"div",l:"0deg",m:"#2B2B2B",n:"#7B7C7C",aK:8,aZ:0,aL:8,A:"#A0A0A0",B:"#A0A0A0",Z:"break-word",r:"inline",C:"#A0A0A0",D:"#A0A0A0",t:13,F:"left",G:"#F2F2F2",aP:"pointer",w:"Button",bA:"#484949",x:"visible",I:"Solid",a:73,y:"preserve",J:"Solid"},"6B77001D-C8F6-43DB-A2B9-EBEC671B2D2A-11054-0000186EF778B5DC":{b:266,z:"11",K:"Solid",c:608,bC:-1,L:"Solid",d:15,aS:6,M:1,bD:"none",bB:-1,N:1,aT:6,O:1,g:"#F0F0F0",aU:6,P:1,aV:6,i:"but9",j:"absolute",k:"div",l:"0deg",m:"#2B2B2B",n:"#7B7C7C",aZ:0,A:"#A0A0A0",B:"#A0A0A0",Z:"break-word",r:"inline",C:"#A0A0A0",D:"#A0A0A0",t:13,F:"left",G:"#F2F2F2",aP:"pointer",w:"Button",bA:"#484949",x:"visible",I:"Solid",a:73,y:"preserve",J:"Solid"},"FC21729B-56D0-49E5-927E-868875530D85-11054-000018698DD2C13E":{b:176,z:"8",K:"Solid",c:608,bC:-1,L:"Solid",d:15,aS:6,M:1,bD:"none",bB:-1,N:1,aT:6,O:1,g:"#F0F0F0",aU:6,P:1,aV:6,i:"but6",j:"absolute",k:"div",l:"0deg",m:"#2B2B2B",n:"#7B7C7C",aZ:0,A:"#A0A0A0",B:"#A0A0A0",Z:"break-word",r:"inline",C:"#A0A0A0",D:"#A0A0A0",t:13,F:"left",G:"#F2F2F2",aP:"pointer",w:"Button",bA:"#484949",x:"visible",I:"Solid",a:73,y:"preserve",J:"Solid"},"5B8F0D85-511F-4BF9-BF3C-98A889772CAD-11054-0000186D0537B9F2":{b:236,z:"10",K:"Solid",c:608,bC:-1,L:"Solid",d:15,aS:6,M:1,bD:"none",bB:-1,N:1,aT:6,O:1,g:"#F0F0F0",aU:6,P:1,aV:6,i:"but8",j:"absolute",k:"div",l:"0deg",m:"#2B2B2B",n:"#7B7C7C",aZ:0,A:"#A0A0A0",B:"#A0A0A0",Z:"break-word",r:"inline",C:"#A0A0A0",D:"#A0A0A0",t:13,F:"left",G:"#F2F2F2",aP:"pointer",w:"Button",bA:"#484949",x:"visible",I:"Solid",a:73,y:"preserve",J:"Solid"},"AAB01577-35D9-41B7-8988-748C2A907D1B-11054-000016DED468B453":{b:296,z:"5",K:"Solid",c:608,bC:-1,L:"Solid",d:15,aS:6,M:1,bD:"none",bB:-1,aT:6,N:1,O:1,g:"#F0F0F0",aU:6,P:1,aV:6,i:"but10",j:"absolute",aI:8,k:"div",l:"0deg",aJ:8,m:"#2B2B2B",n:"#7B7C7C",aZ:0,A:"#A0A0A0",B:"#A0A0A0",Z:"break-word",r:"inline",C:"#A0A0A0",D:"#A0A0A0",t:13,F:"left",G:"#F2F2F2",aP:"pointer",w:"Button",bA:"#484949",x:"visible",I:"Solid",a:73,y:"preserve",J:"Solid"}},backgroundColor:"#FFFFFF",name:"Untitled Scene"}]; 
```

I tried:

```
scenes = scenes.replace("#A0A0A0", "#FF0000"); 
```

but I get an **Object [object object] has no method 'replace'** error message in chrome inspector

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T15:57:22.513

您不能将 .replace 函数与数组/对象一起使用：首先您必须使用对象属性，然后将该值替换为另一个值：

```
for(var val in scenes[0].initialValues){
    for(var newVal in scenes[0].initialValues[val]){
        if(scenes[0].initialValues[val][newVal] == "#A0A0A0"){
            scenes[0].initialValues[val][newVal] = "#FF0000";
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T15:35:36.590

`scenes`是一个数组，所以没有这个方法。

一个（不是很优雅的）解决方案可能是将您的数组编码为 json，替换，然后对其进行解码。

另一种解决方案可能是进行深度克隆以更改值。

这是一个功能：

```
// returns a copy of the source structure/array
//  but replaces all instances of oldValue by newValue
function getCloneWithReplacement(source, oldValue, newValue) {
    if (source===oldValue) {
        return newValue;
    } else if ($.isArray(source)) {
        var clone = [];
        for (var i=0; i<source.length; i++) {
            if (source[i]) clone[i] = getCloneWithReplacement(source[i], oldValue, newValue);
        }
        return clone;
    } else if (typeof(source)=="object") {
        var clone = {};
        for (var prop in source) {
            if (source[prop]) {
                clone[prop] = getCloneWithReplacement(source[prop], oldValue, newValue);
            }
        }
        return clone;
    } else {
        return source;
    }
} 
```

如果您在数组的对象上定义了方法，这两种解决方案都可能会破坏很多事情......只有当它是刚收到的数组时才这样做。

第三种解决方案是使用此（未经测试的）功能进行就地替换：

```
// replaces all instances of oldValue by newValue
function replace(source, oldValue, newValue) {
    if ($.isArray(source)) {
        for (var i=0; i<source.length; i++) {
            replace(source[i], oldValue, newValue);
        }
    } else if (typeof(source)=="object") {
        for (var prop in source) {
            if (source[prop]==oldValue) {
                source[prop]==newValue;
            } else {
                replace(source[prop], oldValue, newValue);
            }
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T15:36:49.540

对象确实没有这样的方法。弦有。

# certificate - Can BouncyCastle convert a P12 to PEM

> ID：12095239
> 
> 赞同：1
> 
> 时间：2012-08-23T15:34:26.713
> 
> 标签：certificate, x509certificate, bouncycastle

A CA gives me a P12 which I want to convert to PEM inside a jvm.

Yes using openssl command works:

```
openssl pkcs12 -in jack.p12 -out jack.pem -nodes -clcerts 
```

But then it gets ugly getting key and keystore passwords into the openssl program from java not to mention unsecure.

so BouncyCastle seems to be best crypto API for java... How could it be done (convert P12 to PEM) using bouncy...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T17:51:24.883

这是一个例子：

```
 private File createPem(final Certificate certP12, final String name) {
    File file = new File(getFileName(name, "pem"));
    FileWriter fileWriter;
    try {
        fileWriter = new FileWriter(file);

        PEMWriter pemWriter = new PEMWriter(fileWriter);
        pemWriter.writeObject(certP12);
        pemWriter.flush();

        pemWriter.close();
        fileWriter.close();
    } catch (IOException e) {
        log.error("", e);
    }

    return file;
  } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-04-25T06:19:23.243

1.  将证书加载为 Org.BouncyCastle.X509.X509Certificate
2.  转换为 pem。

```
public static Org.BouncyCastle.X509.X509Certificate ImportCertFromPfx(string path, string password)
        {
            Pkcs12Store store = new Pkcs12StoreBuilder().Build();
            store.Load(File.OpenRead(path), password.ToCharArray());
            string alias = null;
            foreach (string str in store.Aliases)
            {
                if (store.IsKeyEntry(str))
                    alias = str;
            }
            if (alias == null)
            {
                Console.WriteLine("alias is null");
            }
            else
                Console.WriteLine(alias);

            X509CertificateEntry certEntry = store.GetCertificate(alias);
            Org.BouncyCastle.X509.X509Certificate x509cert = certEntry.Certificate;
            return x509cert;
        } 
```

```
Org.BouncyCastle.X509.X509Certificate x509cert = ImportCertFromPfx(p12path, p12password);

StringBuilder CertPem = new StringBuilder();
PemWriter CSRPemWriter = new PemWriter(new StringWriter(CertPem));
CSRPemWriter.WriteObject(x509cert);
CSRPemWriter.Writer.Flush();

//get Cert text
var CertPemText = CertPem.ToString();
Console.WriteLine(CertPemText); 
```

# c - When would you use mmap

> ID：12095241
> 
> 赞同：30
> 
> 时间：2012-08-23T15:34:36.477
> 
> 标签：c, mmap

So, I understand that if you need some dynamically allocated memory, you can use malloc(). For example, your program reads a variable length file into a char[]. You don't know in advance how big to make your array, so you allocate the memory in runtime.

I'm trying to understand when you would use mmap(). I have read the man page and to be honest, I don't understand what the use case is.

Can somebody explain a use case to me in simple terms? Thanks in advance.

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2012-08-23T15:45:29.727

`mmap`可以用于一些事情。首先，文件支持的映射。不是使用文件分配内存`malloc`并读取文件，而是将整个文件映射到内存而不显式读取它。现在，当您读取（或写入）该内存区域时，操作会透明地作用于文件。你为什么想做这个？它使您可以使用操作系统提供的分页机制轻松处理大于可用内存的文件。即使对于较小的文件，映射也会减少内存副本的数量。

`mmap`也可以用于匿名映射。这种映射没有文件支持，基本上是对一块内存的请求。如果这听起来与 相似`malloc`，那么您是对的。事实上，大多数实现`malloc`会在内部使用匿名`mmap`来提供大的内存区域。

另一个常见的用例是让多个进程将同一个文件映射为共享映射以获得共享内存区域。该文件不必实际写入磁盘。 `shm_open`是实现这一目标的便捷方式。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-08-23T15:44:39.670

每当您需要读取/写入固定大小的数据块时，使用 mmap 将磁盘上的数据文件简单地映射到内存并直接访问它比分配内存、读取文件、访问数据要简单得多（也更快），可能将数据写回磁盘，并释放内存。

# asp.net - Active Directory in ASP.NET Web Forms Application

> ID：12095242
> 
> 赞同：0
> 
> 时间：2012-08-23T15:34:37.183
> 
> 标签：asp.net, windows-authentication, directoryservices, activedirectorymembership

I notice there are several different namespaces/classes for accessing Active Directory. What are the differences between using the following ?

*   System.DirectoryServices.AccountManagement
*   System.DirectoryServices.ActiveDirectory
*   System.Web.Security.ActiveDirectoryMembershipProvider

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T21:15:48.540

下面的项目`AccountManagement`处理使用各种 LDAP 类型的数据存储。不仅是 Active Directory，还有 NDS 和 WinNT。如果您知道您的后备存储与 LDAP 兼容，或者可以在各种 LDAP 存储之间切换，那么这可能是最好的选择。

`ActiveDirectory`命名空间专门用于 AD 。通常，如果您要严格地呆在 AD 环境中，您只关心使用它。

的`ActiveDirectoryMembershipProvider`重点略有不同。这通常被 Web 应用程序用作成员资格提供者之一。其他成员资格提供者包括`SqlMembershipProvider`您可能创建的甚至自定义的提供者。这在您的后备存储可能是 AD 时使用，但将来也可以更改为使用 SQL 服务器或其他一些随机存储。

* * *

总而言之，这一切都归结为您的应用程序当前的功能以及未来的发展方式。如果您有桌面应用程序，请使用`System.DirectoryServices`命名空间。如果您有可能部署到未知环境中的 Web 应用程序，请使用成员资格提供程序。

请注意，我在某些应用程序中同时使用了 SqlMembershipProvider 和 System.DirectoryServices 空间的组合。特别是在授权保留在我的应用程序中时，对 LDAP 存储 (AD/NDS) 进行身份验证。

# javascript - autocomplete parser

> ID：12095243
> 
> 赞同：0
> 
> 时间：2012-08-23T15:34:41.130
> 
> 标签：javascript, jquery, json, web-services

I am currently using Jquery and a webservice to retrieve values for an autocomplete textbox. After the values are returned from the web service, I get an alert with "parser error" as the warning. Why is this?

```
Jquery

$(document).ready(function() {

    $.ajax({
        type: "POST",
        url: "/Service/WSDataService.asmx/GetStates",
        dataType: "json",
        data: "{}",
        contentType: "application/json; charset=utf-8",
        success: function(data) {
            var datafromServer = data.d.split(":");
            $("[id$='txtautofromDB']").autocomplete({
                source: datafromServer
            });
        },
        error: function(XMLHttpRequest, textStatus, errorThrown) {
           alert(textStatus);
        }
    });
}

web service
        [WebMethod]
        public string GetStates()
        {
            StringBuilder sbStates = new StringBuilder();
            List<string> stringlist = new List<String>();
            stringlist.Add("alabama");
            stringlist.Add("boston");
            stringlist.Add("abernathy");
            /*XmlDocument doc = new XmlDocument();
            doc.Load(Server.MapPath("~/Data/States.xml"));*/
            try
            {
                foreach (string xnl in stringlist)
                {

                    sbStates.AppendFormat("{0}:", xnl);
                }

                sbStates = sbStates.Remove(sbStates.Length - 1, 1); //Removes the extra ":"
            }
            catch (Exception ex)
            {
                string exp = ex.ToString();     //Setup a breakpoint here 
                //to verify any exceptions raised.
            }
            return sbStates.ToString();
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T15:55:48.357

那是最可能的，因为您的响应字符串不是 json 可解析的。将 dataType 参数更改为：

```
dataType : text 
```

但是你为什么要使用 POST 来获取一些数据呢？您应该将其更改为 GET

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T15:45:16.047

你现在如何拥有它，没有理由期待一个 JSon 对象。只请求一个基于通用字符串的响应，它应该可以正常工作。

如果您想坚持使用 JSon 对象方法，请尝试返回一个字符串列表，然后当它被反序列化为 JavaScript 时，您将得到一个字符串列表。

更新（如何通过ajax获取字符串）：

```
$.ajax({
        url: "/Service/WSDataService.asmx/GetStates",        
        success: function(data) {
            var datafromServer = data.split(":");
            $("[id$='txtautofromDB']").autocomplete({
                source: datafromServer
            });
        },
        error: function(XMLHttpRequest, textStatus, errorThrown) {
           alert(textStatus);
        }
    }); 
```

# python - Why does this python script crash my IDE?

> ID：12095248
> 
> 赞同：0
> 
> 时间：2012-08-23T15:34:51.987
> 
> 标签：python, python-idle

This script is crashing my Python IDE:

```
def flashCard(word,definition):
    print word + "\n" + definition
    return word + definition

def buildCard():
    word = input("Front?")
    definition = input("Back?")
    flashCard(word,definition)

buildCard() 
```

I am using IDLE for Mac on OSX 10.7.4

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T15:39:40.813

可能是因为您正在使用 input()，请尝试用 raw_input() 替换对 input() 的调用。（只是在这里猜测，但这可能取决于您正在运行的 Python 版本。）在 Python 2.x 中，输入是：

```
input([prompt]) 
Equivalent to eval(raw_input(prompt)). 
```

> 此函数不会捕获用户错误。如果输入在语法上无效，则会引发 SyntaxError。如果评估期间出现错误，可能会引发其他异常。
> 
> 如果 readline 模块已加载，则 input() 将使用它来提供精细的行编辑和历史功能。
> 
> 考虑将 raw_input() 函数用于用户的一般输入。

# batch-file - 为什么选择在 For 循环中不起作用

> ID：12095252
> 
> 赞同：3
> 
> 时间：2012-08-23T15:34:54.063
> 
> 标签：batch-file

```
FOR /L %%i IN (1,1,100) DO (
    choice
    echo %ErrorLevel%
    ) 
```

`%ErrorLevel%`永远`0`不管你输入什么选择。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-29T17:43:19.257

您以错误的方式检查错误级别。

像这样的括号对内的变量和命令......

```
(
  command1
  command2
  command3
) 
```

...就像他们在一条线上运行一样，就像这样`command1 & command2 & command3`。

在命令行试试这个。

```
choice & echo %errorlevel% 
```

如果你多次执行上面的命令，你会看到**之前**的errorlevel 被回显，**而不是当前的**。

或者在命令行上试试这个：

```
set x=yes
( echo %x%
  set x=no
  echo %x%
) 
```

您的输出将是：

```
yes
yes 
```

就像你进入了`echo %x% & set x=no& echo %x%`

我喜欢将其视为系统没有时间更新变量。（尽管更准确的说法是变量仅在整行执行后才更新。）对于所有变量都是如此，而不仅仅是错误级别。

要使`for`循环中的变量正常工作，您需要`call`像这样在批处理文件（或外部批处理文件）中添加一个内部标签。

```
@echo off
  FOR /L %%i IN (1,1,100) DO call :dostuff %%i
goto :eof

:dostuff
  choice /m "Question #%1"
  echo %ErrorLevel% 
```

=====================================**解决下面的问题**

或者，微软创建了一种访问括号对内变量当前值的方法，他们称之为“延迟扩展”，因为代码行被解释了两次。

要激活此模式，您可以使用`setlocal`带有开关的命令`enableDelayedExpansion`，并使用 ! 访问变量。像这样的性格。仅供参考`endlocal`关闭效果。

```
@echo off
setlocal enableDelayedExpansion
for /L %%i in (1,1,100) do (
  choice /m "Question #%%i"
  echo !ErrorLevel!
)
endlocal 
```

如您所见，我的第一个示例更易于编码，但我的第二个示例更易于阅读。无论您使用哪种方法，都将取决于您的需求和可重用性。

该`setlocal`命令还具有创建在命令后死亡的**临时变量**`endlocal`的效果。这意味着您无需在批处理文件结束时删除它们，并将您在执行期间更改的任何变量恢复为其原始值。这很好，因为您不必担心“踩到”任何预先存在的变量。

# ios - Got a lot of "* is unavailable" errors when compiling for iPhone

> ID：12095253
> 
> 赞同：0
> 
> 时间：2012-08-23T15:34:55.480
> 
> 标签：ios

basically it happens at the line like #import and every other ios header, like UIAccelerometer is unavailable and even UIView is unavailable, the compile stopped at the line #import. what could cause that?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-15T07:30:28.463

I just had this issue trying to build for iOS 5.1 in XCode 4.5 after manually installing the iOS 5.1 SDK out of XCode 4.4.

After some initial frustration, this solved the issue: [Xcode 4.5 and iOS 4.2.1 incompatibility](https://stackoverflow.com/questions/12463195/xcode-4-5-and-ios-4-2-1-incompatibility)

Find your .xcodeproj, do "Show Package Contents" to expose your .pbproj and open it in a plaintext editor ( or Komodo Edit, maybe TextEdit if you have it setup to use plain text by default). Find every instance "IPHONEOS_DEPLOYMENT_TARGET" and make sure it says "IPHONEOS_DEPLOYMENT_TARGET = 4.0;"

Having the SDK 5.1 installed alone isn't enough, as I have discovered. Nor is changing the Deployment Target field under "Info". I had to manually edit the .pbxproj

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T17:15:48.430

Either you are building for MacOSX by accident, or you need to add the frameworks you are importing form iOS into your project.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-15T21:04:26.570

faced similar compiling issues with xcode 5 using base sdk 6.3 - turned out to be several xib had a value of "opens in Default(5.0)". Setting the value to "opens in XCode 4.6" fixed it![enter image description here](../Images/30103eedeaca3ddd9a5fbb68889fae89.png)

# c++ - 带有 boost::asio 的 ThreadPool 不退出？

> ID：12095258
> 
> 赞同：0
> 
> 时间：2012-08-23T15:35:10.100
> 
> 标签：c++, boost, boost-asio, threadpool

我有以下使用 boost::asio 制作的线程池的最小示例。

```
#include <queue>
#include <map>

#include <boost/shared_ptr.hpp>
#include <boost/asio/io_service.hpp>
#include <boost/thread/thread.hpp>
#include <boost/asio.hpp>
#include <boost/date_time/posix_time/posix_time.hpp> // remove me (only for io)

class ThreadPool
{
public:
    void work_as_mainthread(void) { m_io_service.run(); }

    ThreadPool(int poolSize = 4) : timer(m_io_service)
    {
        timer.expires_from_now(boost::posix_time::seconds(1)); // this line does not affect the problem
        m_pWork.reset( new boost::asio::io_service::work(m_io_service) );

        for ( int i = 0; i < poolSize; ++i)
            m_threadGroup.create_thread( boost::bind(&boost::asio::io_service::run, &m_io_service) );
    }

    ~ThreadPool()
    {
        m_pWork.reset();
        m_threadGroup.join_all();
    }

private:
    boost::asio::io_service m_io_service;
    boost::asio::deadline_timer timer;
    boost::shared_ptr<boost::asio::io_service::work> m_pWork;
    boost::thread_group m_threadGroup;
};

int main()
{
    int n_threads = 2;
    ThreadPool pool(n_threads);
    pool.work_as_mainthread();
    // this line is never reached...
    return 0;
} 
```

如果你喜欢，你可以像这样编译它：

```
g++ -Wall -g -lboost_thread -lboost_date_time -lboost_system main.cpp -o main 
```

让我感到奇怪的是，程序并没有停止。我所做的是调用 io_service::run，但没有任何“工作”。正如 boost::asio 文档中所说，没有工作的 io_services 会自行退出。现在，为什么我的程序永远不会退出？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T15:39:02.630

当您创建一个`boost::asio::io_service::work`对象时，这会阻止`io_service`完成。

```
// This line keeps the io_service running
m_pWork.reset( new boost::asio::io_service::work(m_io_service) ); 
```

如果您希望它停止，则需要销毁该工作对象，如下所示：

```
// stop the worker(s)
m_pWork.reset(); 
```

您可以自行决定找到合适的时间/地点来执行此操作。我建议调用`timer.async_wait()`，然后在处理程序中您可以重置您的工作对象以查看这一切应该如何协同工作。

请参阅文档的[这一](http://www.boost.org/doc/libs/1_42_0/doc/html/boost_asio/reference/io_service__work.html)部分。

# python - NDB 在长时间请求期间未清除内存

> ID：12095259
> 
> 赞同：7
> 
> 时间：2012-08-23T15:35:16.777
> 
> 标签：python, google-app-engine, memory-leaks, task-queue, app-engine-ndb

我目前正在将长时间运行的作业卸载到 TaskQueue 以计算数据存储区中 NDB 实体之间的连接。

基本上，这个队列处理几个实体键列表，这些实体键将通过节点中`query`的`node_in_connected_nodes`函数与另一个相关联：`GetConnectedNodes`

```
class GetConnectedNodes(object):
"""Class for getting the connected nodes from a list of nodes in a paged way"""
def __init__(self, list, query):
    # super(GetConnectedNodes, self).__init__()
    self.nodes = [ndb.model.Key('Node','%s' % x) for x in list]
    self.cursor = 0
    self.MAX_QUERY = 100
    # logging.info('Max query - %d' % self.MAX_QUERY)
    self.max_connections = len(list)
    self.connections = deque()
    self.query=query

def node_in_connected_nodes(self):
    """Checks if a node exists in the connected nodes of the next node in the 
       node list.
       Will return False if it doesn't, or the list of evidences for the connection
       if it does.
       """
    while self.cursor < self.max_connections:
        if len(self.connections) == 0:
            end = self.MAX_QUERY
            if self.max_connections - self.cursor < self.MAX_QUERY:
                end = self.max_connections - self.cursor
            self.connections.clear()
            self.connections = deque(ndb.model.get_multi_async(self.nodes[self.cursor:self.cursor+end]))

        connection = self.connections.popleft()
        connection_nodes = connection.get_result().connections

        if self.query in connection_nodes:
            connection_sources = connection.get_result().sources
            # yields (current node index in the list, sources)
            yield (self.cursor, connection_sources[connection_nodes.index(self.query)])
        self.cursor += 1 
```

这里 a`Node`有一个重复的属性`connections`，其中包含一个具有其他键 ID 的数组，以及一个与给定连接`Node`匹配的数组。`sources`

产生的结果存储在 blobstore 中。

现在我遇到的问题是，在连接函数的迭代之后，内存没有以某种方式被清除。以下日志显示了 AppEngine 在创建新`GetConnectedNodes`实例之前使用的内存：

```
I 2012-08-23 16:58:01.643 Prioritizing HGNC:4839 - mem 32
I 2012-08-23 16:59:21.819 Prioritizing HGNC:3003 - mem 380
I 2012-08-23 17:00:00.918 Prioritizing HGNC:8932 - mem 468
I 2012-08-23 17:00:01.424 Prioritizing HGNC:24771 - mem 435
I 2012-08-23 17:00:20.334 Prioritizing HGNC:9300 - mem 417
I 2012-08-23 17:00:48.476 Prioritizing HGNC:10545 - mem 447
I 2012-08-23 17:01:01.489 Prioritizing HGNC:12775 - mem 485
I 2012-08-23 17:01:46.084 Prioritizing HGNC:2001 - mem 564
C 2012-08-23 17:02:18.028 Exceeded soft private memory limit with 628.609 MB after servicing 1 requests total 
```

除了一些波动之外，即使没有访问以前的值，内存也会不断增加。我发现很难调试这个或弄清楚我是否在某个地方有内存泄漏，但我似乎已经将它追溯到那个类。将不胜感激任何帮助。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-24T11:50:09.217

我们有类似的问题（长时间运行的请求）。我们通过关闭默认的 ndb 缓存解决了这些问题。[你可以在这里](https://developers.google.com/appengine/docs/python/ndb/cache)阅读更多关于它的信息

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-09-27T13:40:49.773

在我们的案例中，这是由启用 AppEngine [Appstats](https://developers.google.com/appengine/docs/python/tools/appstats)引起的。

禁用后，内存消耗恢复正常。

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2012-08-23T21:44:24.793

您可以在每个请求开始时调用 gc.collect() 。

# wolfram-mathematica - NMinimize 与包含随机变量的函数

> ID：12095260
> 
> 赞同：0
> 
> 时间：2012-08-23T15:35:18.107
> 
> 标签：wolfram-mathematica, mathematica-8

我想知道是否可以将数学中的 NMinimize 与包含随机变量的目标函数一起使用？例如，我有一个函数，其参数遵循分布（正态和截断正态）。我想将其直方图拟合到我拥有的数据并构建一个目标函数，现在我需要最小化它（因此，目标函数取决于参数的 mus 和 sigmas 并且需要确定）。如果我运行我的代码，则会出现一条错误消息：它声称 NormalDistribution 的参数需要为正（如果我手动插入目标函数的 mus 和 sigmas 的数字，我不会收到错误消息）。所以，我想知道 NMinimize 是否不可能处理非分析函数。谢谢！这里，

* * *

listS 和 listT 都是事件时间列表。我想将我的统计模型的曲线拟合到我拥有的数据中（这里是一个非常简单的模型，它由截断的正态分布组成）。为此，我比较了生存曲线并需要最小化最小二乘之和。我的问题是函数 NMinimize 似乎不起作用。（请注意，原始目标函数由一个更复杂的函数组成，其参数是随机变量）

(* 两个列表都应该是时间列表 *)

```
SurvivalS[listeS_, x_] := Module[{res, survivald},
survivald = SurvivalDistribution[listeS];
res = SurvivalFunction[survivald, x];
res]
Residuum[listeT_, listeS_] := 
Table[(SurvivalS[listeT, listeT[[i]]] - SurvivalS[listeS, listeT[[i]]]), {i,
 1, dataN}];
LeastSquare[listeT_, listeS_] := 
Total[Function[x, x^2] /@ 
Residuum[listeT, 
 listeS]];(* objective function, here ist is the sum of least square *)

objectiveF[mu_, sigma_] := 
Piecewise[{{LeastSquare[listeT, listeS[mu, sigma]], mu > 0 && sigma > 0}}, 
20 (1 + (sigma + mu)^2)];

pool = 100; (* No. points from MonteCarlo *)

listeS[mu_, sigma_] := RandomVariate[TruncatedDistribution[{0, 1}, NormalDistribution[mu, sigma]],pool];(* simulated data *)
listeT = Sort[RandomVariate[TruncatedDistribution[{0, 1}, NormalDistribution[.5, .9]],60]]; (* list of "measured" data *)
dataN = Length[listeT];
NMinimize[objectiveF[mu, .9], {{mu, .4}}] 
```

错误消息是：“RandomVariate::realprm: NormalDistribution[mu,0.9] 中位置 1 的参数 mu 应为实数。>>”

# iphone - 重新加载 UIAlertView 中的 UIPickerView

> ID：12095265
> 
> 赞同：0
> 
> 时间：2012-08-23T15:35:35.703
> 
> 标签：iphone, ios, ipad, uipickerview

我使用以下代码在 UIAlertView 中创建了一个 UIPickerView：

```
alert1 = [[UIAlertView alloc] initWithFrame:CGRectMake(0, 0, 300, 200)];
alert1.title = @"All Notes";
alert1.message = @"\n\n\n\n\n\n\n";
alert1.delegate = self;
[alert1 addButtonWithTitle:@"Cancel"];

 myPickerView = [[UIPickerView alloc] initWithFrame:CGRectZero];
 myPickerView.tag = TAG_PICKER0;
 myPickerView.delegate = self;
 myPickerView.showsSelectionIndicator = YES;
 myPickerView.autoresizingMask = UIAlertViewStyleDefault;
 myPickerView.frame = CGRectMake(10, 40, 265, 150);

 [alert1 addSubview:myPickerView];
 [alert1 show]; 
```

我想在按下按钮时重新加载这个pickerView，在按钮操作中我向出现在选择器中的数组添加了一个新元素，我还添加了这一行

```
[self.myPickerView reloadAllComponents];
self.myPickerView.delegate=self; 
```

但是此时新元素没有出现在选择器中，它在我重新打开应用程序时出现

如何解决此问题以使新元素在添加时出现在 pickerView 中？

# ajax - 有人可以发个帖子到 register.php 并注册 10 亿个帐户吗？

> ID：12095269
> 
> 赞同：2
> 
> 时间：2012-08-23T15:35:37.727
> 
> 标签：ajax, security, post

是否可以创建一个在服务器外部执行的脚本，或者使用浏览器插件，例如它自动填写表单值，然后提交所有准备好由服务器解析的表单？通过这种方式，十亿个假帐户可以在三分钟内轻松注册，想象一下不使用任何人类验证码可见的 facebook，这是一个执行表单提交并将从本地数据库检索到的 vals 插入新电子邮件的浏览器插件关联起来，因为那是一张支票——没有重复的电子邮件，是否可以每天在全球范围内创建成千上万个假账户？

防止虚假帐户的最佳方法是什么？甚至想象一个旋转的 ips 中心的场景，人类注册只是为了阻塞数据库，在一年内实现 30-5000 万个帐户。谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T15:40:42.317

这在 Security.Stackexchange.com 网站上可能更好，但是......

根据[OWASP Guide to Authentication](https://www.owasp.org/index.php/Guide_to_Authentication)，验证码实际上是一件坏事。它们不仅不起作用，还会引起额外的头痛，而且在某些情况下（根据 OWASP）它们是非法的。

> **验证码**
> 
> CAPTCHA（完全自动化的图灵测试以区分人类和计算机）在任何禁止歧视残疾公民的司法管辖区都是非法的。这基本上就是整个世界。尽管 CAPTCHA 看起来很有用，但实际上使用以下任何一种方法都可以轻松破解：
> 
> • 光学字符识别。大多数常见的验证码都可以使用专业的验证码破解 OCR 软件来解决。
> 
> • 打破测试，免费访问 foo，> 其中 foo 是理想的资源
> 
> • 花钱请人解决验证码。
> 
> 撰写本文时的当前费率为每 500 次测试 12 美元。因此，在您的软件中实施 CAPTCHA 很可能至少在一些国家是非法的，更糟糕​​的是 - 完全无效。

其他方法是常用的。

*   最常见的可能是电子邮件验证过程。您注册后，他们会向您发送一封电子邮件，并且只有当您确认该帐户已激活并可访问时。
*   CAPTCHA还有几个[有趣的替代方案](http://www.getelastic.com/6-captcha-alternatives-to-improve-conversion/)，它们执行相同的功能，但以一种（可以说，在某些情况下）不那么困难的方式。
*   更困难的可能是跟踪来自单个 IP 地址的表单提交，并阻止明显的攻击。 *但这可以被欺骗和绕过*。
*   另一种使用 JavaScript 来计算用户在提交之前在网页上花费的时间的技术。大多数机器人几乎会立即提交内容（如果它们甚至运行 JavaScript），因此检查自页面呈现后是否经过一两秒可以检测机器人。*但是机器人也可以用来愚弄这一点*
*   蜜罐技术还可以帮助检测此类表单提交。[这里](http://community.developer.authorize.net/t5/The-Authorize-Net-Developer-Blog/Handling-Online-Payments-Part-7-Preventing-Automated-Form/ba-p/11778)有一个很好的实现示例。
    *   此页面还讨论了表单令牌方法。在这种情况下，直到现在我才听说过表单令牌。它在概念上看起来类似于反 csrf 令牌。

总而言之，与任何与安全相关的事情一样，您最好的防御是一种分层方法，使用多个防御。这个想法是让它比平均水平更难，这样你的攻击者就会放弃广告尝试不同的网站。这不会阻止持续攻击者，但会减少偷渡式攻击。

要回答您最初的问题，这完全取决于网站开发人员采取了哪些预防措施来防止人们自动创建帐户。

任何有能力的开发人员都会在需求收集阶段解决这个问题，并为此制定计划。但是有很多网站是由不称职的开发人员/团队编写的，即使在应该更了解的大牌公司中也是如此。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T15:38:31.147

是的。自动化表单提交非常容易，例如使用[wget](http://www.gnu.org/software/wget/)或[curl](http://curl.haxx.se/)。这正是 CAPTCHA 存在的原因，这使得表单提交难以自动化。

验证电子邮件也很有帮助，尽管自动打开它们并单击验证链接相当简单。如果您对阻止垃圾邮件域（例如 hotmail.com）保持警惕，它们确实可以提供保护。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T15:46:35.630

这可以使用简单的脚本来实现，这些脚本可能使用也可能不使用浏览器扩展（例如用 Perl 编写的脚本或使用 wget/curl 的 shell 脚本）。

大多数网站都依赖于在启用 CAPTCHA 之前跟踪从特定浏览器/IP 收到的请求数量。

可以在服务器端以有限的到期时间跟踪此信息，或者在客户端使用多个 IP 的情况下（例如使用 DHCP 连接的用户），可以使用 cookie 跟踪此信息。

# nhibernate - 通过代码进行双向 NHibernate 映射

> ID：12095274
> 
> 赞同：1
> 
> 时间：2012-08-23T15:35:52.097
> 
> 标签：nhibernate, nhibernate-mapping, mapping-by-code

需要明确的是 - 这个问题与 Fluent NHibernate 无关。

我有一个`Parent`和`Child`类，它们之间是一对多的关系。

为了便于阅读，代码被缩短了。

```
public class Child
{
    int Id;
    string Name;
}

public class Parent
{
    int Id;
    string Name;
    Iesi.Collections.Generic.ISet<Child> Children;
}

public ChildMapping()
{
    Table("Children");

    Id(p => p.Id, m => {
        m.Column("Id");
        m.Generator(Generators.Identity);
    });

    Property(p => p.Name, m => {
        m.Column("Name");
        m.NotNullable(true);
    });
}

public ParentMapping()
{
    Table("Parents");

    Id(p => p.Id, m => {
        m.Column("Id");
        m.Generator(Generators.Identity);
    });

    Property(p => p.Name, m => {
        m.Column("Name");
        m.NotNullable(true);
    });

    Set(p => p.Children, m => {
        m.Cascade(Cascade.All | Cascade.DeleteOrphans);
        m.Key(k => {
            k.Column("ParentId");
            k.NotNullable(true);
        });
    }, a => a.OneToMany());
} 
```

该类`Child`需要一个`Parent`属性。控制关系的`Parent`需要（我不能在' 结束时设置`Inverse`to ）。`true``Parent`

`Parent`和映射应该是`Child`什么样子的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-14T13:35:15.580

我添加了以下项目：

子类：一个字段_parent，一个构造函数
父类：AddChild方法
子映射：用于父属性的manytoone
父映射：inverse(true)，使子的父处理程序

完整代码：

```
public class Child
{
    int Id;
    string Name;
    Parent _parent;

    public Child(Parent parent)
   {
     _parent = parent;
   }
}

public class Parent
{
    int Id;
    string Name;
    Iesi.Collections.Generic.ISet<Child> Children;

    public virtual Child AddChild()
    {
       Child newChild = new Child(this); //link parent to child via constructor
       Children.Add(newChild); //add child to parent's collection
       return newChild; //return child for direct usage
    }
}

public ChildMapping()
{
    Table("Children");

    Id(p => p.Id, m => {
        m.Column("Id");
        m.Generator(Generators.Identity);
    });

    Property(p => p.Name, m => {
        m.Column("Name");
        m.NotNullable(true);
    });

    ManyToOne(x => x.Parent, map => {
         map.Column("Id"); /* id of the parent table */
         map.Access(Accessor.Field);
         map.NotNullable(true);
         map.Class(typeof(Parent));
        });    
}

public ParentMapping()
{
    Table("Parents");

    Id(p => p.Id, m => {
        m.Column("Id");
        m.Generator(Generators.Identity);
    });

    Property(p => p.Name, m => {
        m.Column("Name");
        m.NotNullable(true);
    });

    Set(p => p.Children, m => {
        m.Cascade(Cascade.All | Cascade.DeleteOrphans);
        m.Key(k => {
            k.Column("Id"); /* id of the child table */
            k.NotNullable(true);
            k.Inverse(true); /* makes the parent handle it's childlist */
        });
    }, a => a.OneToMany());
} 
```

那应该工作。

# ios - 如何以编程方式检查外观代理？

> ID：12095275
> 
> 赞同：0
> 
> 时间：2012-08-23T15:35:52.537
> 
> 标签：ios

我添加了以下代码以在较新版本的操作系统上使用外观，而对旧版本不做任何事情：

```
if ([UINavigationBar respondsToSelector:@selector(appearance)])
{
    [[UIBarButtonItem appearance] setTintColor:[UIColor blackColor]]; 
```

它编译正常，并且似乎正在工作。

然后我打开了一堆在 Xcode 中默认禁用的构建警告，并开始收到错误“未实现的选择器'外观'”。

那么在运行时检查外观是否存在的正确方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T15:55:18.157

做这个：

```
if ([UIBarButtonItem conformsToProtocol:@protocol(UIAppearance)])
{
 [[UIBarButtonItem appearance] setTintColor:[UIColor blackColor]];  
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T15:47:44.467

我不认为你可以。UIView 标头声称符合 UIAppearance 协议，因此您必须事先知道自己在做什么。检查外观选择器是不可靠的。此外，您必须知道哪些属性支持 UIAppearance，因为并非所有明显的属性都支持。

但是，如果您想知道哪些类和属性支持 UIAppearance，那就有希望了。我已经为 iOS 5 获取了 UIKit 标头，如果你对潜在的变化感到好奇，我相信你可以为 iOS 6 做同样的事情。我的符合 UIAppearance 的 UIView 子类列表[位于我的博客，这里](http://blog.mosheberman.com/list-of-classes-that-support-uiappearance-in-ios-5/)。

**编辑：**

我忘记了`conformsToProtocol:`CSmith 在他的回答中提到的方法。无论如何，我将保留此答案，因为该链接仍然相关。

# html - 使用 HTML5 Navigation Timing API 时，navigationStart 时间设置为 0

> ID：12095276
> 
> 赞同：4
> 
> 时间：2012-08-23T15:35:52.867
> 
> 标签：html, navigation-timing-api

我正在使用 HTML5 Navigation Timing API 来测量用户在我的网站上感知的页面加载时间。

我正在使用以下代码来测量页面加载时间。

```
function recordLoadTime () {
/* Process load time using "Navigation Timing" */
if (typeof(window.performance) !== "undefined" && typeof(window.performance.timing) !== "undefined") {
    if (window.performance.timing.loadEventEnd > 0) {
        var time = window.performance.timing.loadEventEnd - window.performance.timing.navigationStart;
    } else {
        setTimeout(recordLoadTime, 1000);
    }
}
} 
```

该`time`变量还被添加到 cookie 中，并在用户的后续请求中记录在服务器上。

我面临的问题是记录的时间非常接近当前纪元时间，即`navigationStart`设置为 0 但`loadEventEnd`具有非零值（即当前纪元时间）

我在 Chrome/11.0、Chrome/12.0、MSIE 7.0、MSIE 8.0 和 MSIE 9.0 上看到了这种行为

我通过修改上面的代码暂时解决了这个问题，只在`navigationStart`大于 0 时记录加载时间。但我希望记录所有服务页面的加载时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-12T13:39:15.803

```
window.onload = function()
{
  setTimeout(function(){
  var t = performance.timing;

}, 0); 
```

# linux - 在 squid-std.conf 文件中打开端口的脚本

> ID：12095278
> 
> 赞同：0
> 
> 时间：2012-08-23T15:36:00.400
> 
> 标签：linux, bash, shell, unix

我正在尝试创建一个可以将端口配置行添加到 squid-std.conf 文件的脚本。我的脚本需要两个参数，第一个`$1`是 http 或 https，然后第二个参数`$2`是端口号。到目前为止，我在伪代码中的逻辑：

1.  确保有两个参数。
2.  确保`$1`是 http 或 https。
3.  确保`$2`是一个有效的号码。
4.  确保`$2`是一个有效值 0-65535
5.  现在检查端口是否已经打开。
    这是我坚持的部分。

该`squid-std.conf`文件包含许多配置行，但如果调用脚本，`http 80`我需要检查是否有类似于以下的行：

```
acl Safe_ports port 80 #custom port change 2012/08/02 15:00 
```

现在因为可以通过`#`在行的前面添加 a 来注释行，所以我想确保行`#`的前面不存在。然后，如果某处右侧有一个`#`，则删除该右侧的所有内容。

现在检查以确保这些词存在`acl`,`Safe_ports`和`80`。并且`80`需要不匹配的东西`280`，必须只是`80`。这是区分大小写的，因此无需检查大写或小写。

如果一切匹配，则在屏幕上打印此端口已打开。如果找不到，那么我需要编写一些代码来在文件中添加该行，这可以稍后完成。我希望这是足够的细节。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T16:48:50.407

```
#!/bin/bash                                                                                                                         

SCHEME=http
PORT=80
SQUID_CONF=/path/to/squid-std.conf

if egrep -q "^ *acl +Safe_ports +port +$PORT " $SQUID_CONF
then
    echo "this port is already open."
fi 
```

# vim - 如何摆脱vim中拆分窗口之间的栏？

> ID：12095281
> 
> 赞同：3
> 
> 时间：2012-08-23T15:36:12.553
> 
> 标签：vim, color-scheme

当我使用`:vs`在 vim 中分割屏幕时，两个窗口之间有一个栏，它分散了我的注意力并占用了一些屏幕空间。我在屏幕截图中看到它可以删除，但是如何删除呢？

理想情况下，它看起来像这样：

![例子](../Images/f8a08de8911b4c056220c4ca26877553.png)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-23T15:56:01.527

```
:set fillchars-=vert:\| 
```

这将摆脱字符，但总会有一个字符边框，例如分隔水平窗口拆分的状态行。虽然可以在 GVIM 中绘制像素细线，但 Vim 试图在其所有化身中保持统一。

您可以通过以下方式更改颜色：

```
:highlight VertSplit gui=reverse guifg=Red 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-23T15:44:07.640

你不能完全摆脱它。仅以这种颜色突出显示它，使其适合背景/前景，而您不会注意到它。但它仍然会在那里。

# php - PHP PDO mySQL 查询如果不存在则创建表

> ID：12095285
> 
> 赞同：3
> 
> 时间：2012-08-23T15:36:22.693
> 
> 标签：php, mysql, pdo, create-table

使用 PHP PDO 查询来执行一个 mySQL 查询。查询由从 foreach() 输入的大量信息组成；所以我已经回显了 sql 查询。问题出在这里，但我看不到它。

这是的输出`$sql`

```
CREATE TABLE IF NOT EXISTS `page` (
  `page_ID` INT AUTO_INCREMENT NOT NULL,
  `url` varchar(200) NOT NULL,
  `title` varchar(200),
  `subtitle` TEXT,
  `content` TEXT,
  `parent` varchar(10),
  `privacy` varchar(1),
  `status` varchar(1),
  `creation` varchar(30)
) CHARACTER SET utf8 COLLATE utf8_general_ci; 
```

仅供参考，查询是这样执行的：

```
function createdbtable($table,$fields){
    global $fsdbh;
    $sql = "CREATE TABLE IF NOT EXISTS `$table` (";
    foreach($fields as $field => $type){ $sql.= "`$field` $type,"; }
    $sql = rtrim($sql,',');
    $sql .= ") CHARACTER SET utf8 COLLATE utf8_general_ci"; return $sql;
    if($fsdbh->exec($sql) !== false) { return 1; }
} 
```

这是错误：

> #1075 - 表定义不正确；只能有一个自动列，并且必须将其定义为键

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-23T15:42:07.153

您忘记了主键：

```
CREATE TABLE IF NOT EXISTS `page` (
`page_ID` INT AUTO_INCREMENT NOT NULL,
`url` varchar(200) NOT NULL,
`title` varchar(200),
`subtitle` TEXT,
`content` TEXT,
`parent` varchar(10),
`privacy` varchar(1),
`status` varchar(1),
`creation` varchar(30),
PRIMARY KEY (`page_ID`)) 
CHARACTER SET utf8 COLLATE utf8_general_ci 
```

错误非常明确：

> 架构创建失败：表定义不正确；只能有一个自动列，并且必须将其定义为键

您必须将自动增量键指定为键。

**编辑：**

对于 PHP 代码，我将使用以下代码：

```
function createdbtable($table,$fields)
{
    global $fsdbh;

    $sql = "CREATE TABLE IF NOT EXISTS `$table` (";
    $pk  = '';

    foreach($fields as $field => $type)
    {
      $sql.= "`$field` $type,";

      if (preg_match('/AUTO_INCREMENT/i', $type))
      {
        $pk = $field;
      }
    }

    $sql = rtrim($sql,',') . ', PRIMARY KEY (`'.$pk.'`)';

    $sql .= ") CHARACTER SET utf8 COLLATE utf8_general_ci";
    if($fsdbh->exec($sql) !== false) { return 1; }
} 
```

# asp.net-mvc - 创建虚拟目录后使用 IIS 7.5 托管 ASP.NET MVC 4 应用程序的问题 - 脚本文件不起作用

> ID：12095292
> 
> 赞同：0
> 
> 时间：2012-08-23T15:36:53.437
> 
> 标签：asp.net-mvc, asp.net-mvc-3, iis, hosting, iis-7.5

我有一个试图在 IIS 7.5 中托管的 ASP.NET MVC 4 应用程序。我尝试使用项目属性中的“使用本地 IIS Web 服务器”选项创建一个虚拟目录，并在 IIS 中设置了匿名身份验证和 Windows 身份验证。

当我运行应用程序时，它会在浏览器中打开，URL 为“http://localhost\ApplicationName”，我只能查看我创建的选项卡名称。当我右键单击并查看页面源时，我列出了我的脚本并使用 div 和表定义了正文。当我单击选项卡名称时，没有任何反应。

在查看页面源代码中，当我单击任何脚本时，它会引发错误，

```
HTTP Error 404.0 - Not Found
The resource you are looking for has been removed, had its name changed, or is temporarily unavailable.

Detailed Error Information
Module  IIS Web Core
Notification    MapRequestHandler
Handler StaticFile
Error Code  0x80070002
Requested URL   http://localhost:80/Scripts/Script.js
Physical Path   C:\inetpub\wwwroot\Scripts\Script.js
Logon Method    Anonymous
Logon User  Anonymous 
```

在 IIS 中，我启用了匿名、ASP.NET 模拟和 Windows 身份验证。

另外，当我查看目录的高级设置时，它在 C\Users........ 中显示物理路径，但在详细说明中，它显示物理路径为“C:\inetpub\wwwroot\脚本\Script.js”。

我给的路径错了吗？还是应该将项目文件放在“C:\inetpub\wwwroot\Scripts\Script.js”中？

请帮忙。我已经为此苦苦挣扎了一段时间，这让我发疯了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T21:27:27.987

您是在使用 URL Bundles 还是在前端代码中手动硬编码 .JS 路径？当您在 Visual Studio 中以调试模式运行站点时，您是否看到良好/预期的行为？我会尝试收集一些关于这些考虑的提示，也许会提供更多信息......

# c++ - 使用 Pleora Libs 的 Qt 配置并包含

> ID：12095293
> 
> 赞同：0
> 
> 时间：2012-08-23T15:37:00.150
> 
> 标签：c++, qt, gige-sdk

我在设置使用 pleora SDK 开发简单应用程序的环境时遇到了麻烦，我已经成功地在 .pro 文件中包含了 libs 和 .h 文件，但是当我只包含一个 .h 文件时，例如：

```
//main.c
#include <PvBuffer.h> 
```

我只是在编译窗口中得到错误。编译只是我为验证单个包含语句的执行情况所做的测试。

还有其他我没有看到的步骤吗？任何提示或指南都会受到好评！PD：.pro 文件是这样的：

```
QT       += core

QT       -= gui

TARGET = pleora
CONFIG   += console
CONFIG   -= app_bundle

TEMPLATE = app

SOURCES += main.cpp
INCLUDEPATH += "C:/Program Files (x86)/Pleora Technologies Inc/eBUS SDK/Includes"
LIBS += "C:/Program Files (x86)/Pleora Technologies Inc/eBUS SDK/Libraries/*.lib" 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T00:20:37.353

嗨，我试图在 Eclipse CDT 下使用 MingGw 设置 lib 和包含文件，感觉它不支持这种编译器，回到 MSVS c++ 2008 并设置自动，工作正常流畅。Pleora 不支持 Gcc 编译器。

# c# - 为什么“ORDER BY”会破坏我的查询？

> ID：12095296
> 
> 赞同：2
> 
> 时间：2012-08-23T15:37:13.783
> 
> 标签：c#, sql, sql-server, visual-studio-2010

我正在使用下面的代码从我的数据库中获取公司列表并将它们加载到列表视图中。它工作得很好。

```
conn.Open();
string pricesqry = "SELECT company, url FROM companies";
SqlCommand pricescmd = new SqlCommand(pricesqry, conn);
SqlDataReader pricesreader = pricescmd.ExecuteReader();

while (pricesreader.Read())
{
    ListViewItem company = new ListViewItem(pricesreader["company"].ToString());
    company.SubItems.Add(pricesreader["url"].ToString());
    company.SubItems.Add("Blank for now..");

    pricesList.Items.Add(company);
}
conn.Close(); 
```

但是，如果我想按公司名称的字母顺序排列我的列表，请将我的选择查询更改为：

```
string pricesqry = "SELECT company, url FROM companies ORDER BY company"; 
```

没有数据加载到列表视图中。按部分删除顺序，数据再次出现。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T15:46:12.423

如果您可能`NULL`在数据库中有 's，最好从 reader 获取值，如下所示：

假设公司和网址是一个字符串。

```
ListViewItem company = new ListViewItem(Convert.IsDBNull(pricesreader.GetOrdinal("company")) ? null : pricesreader.GetString(pricesreader.GetOrdinal("company")));

company.SubItems.Add(Convert.IsDBNull(pricesreader.GetOrdinal("url")) ? null : pricesreader.GetString(pricesreader.GetOrdinal("url"))); 
```

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T15:47:36.523

归功于 Minitech。

我的“公司”列类型设置为文本。更改为 varchar ，它现在按我的预期工作。

# c++ - C++ 中的向量和结构体

> ID：12095305
> 
> 赞同：2
> 
> 时间：2012-08-23T15:38:08.530
> 
> 标签：c++, arrays, vector, struct

我正在尝试制作一个包含多种数据类型和向量的数据树。到目前为止我所拥有的如下所示：

```
struct VertStruct{
    double X, Y, Z;
};
struct FaceStruct{
    int F1, F2, F3, F4;
};
struct FaceNormalStruct{
    double X, Y, Z;
};
struct LODStruct{
    std::vector<VertStruct> Verts;
    std::vector<FaceStruct> Faces;
    std::vector<FaceNormalStruct> FaceNormals;
};
struct ChunkStruct{
    std::vector<LODStruct> LOD;
};

int main(){

    std::vector<ChunkStruct> Chunk;
    Chunk.resize(100);

    for(int i = 0; i < 100; i++)
    {
        Chunk[i].LOD.resize(5);

        for(int j = 0; j < 5; j++)
        {
            Chunk[i].LOD[j].Verts.resize(36);
            Chunk[i].LOD[j].Faces.resize(25);
            Chunk[i].LOD[j].FaceNormals.resize(25);
        }
    }
return 1;
} 
```

现在这编译得很好，这正是我想要的，但是，如果我尝试将一个值设置为：

```
int Number = 42;
Chunk[5].LOD[4].Verts[3] = Number; 
```

然后我收到以下错误：

```
 main.cpp|126|error: no match for 'operator=' in 'Chunk.std::vector<_Tp, _Alloc>::operator[] [with _Tp = ChunkStruct, _Alloc = std::allocator<ChunkStruct>](5u)->ChunkStruct::LOD.std::vector<_Tp, _Alloc>::operator[] [with _Tp = LODStruct, _Alloc = std::allocator<LODStruct>](4u)->LODStruct::Verts.std::vector<_Tp, _Alloc>::operator[] [with _Tp = VertStruct, _Alloc = std::allocator<VertStruct>](3u) = Number'| 
```

那么我是否遗漏了什么，或者我试图做的事情是不可能的？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-23T15:41:39.793

`Verts[3]`是类型`VertStruct`并且`Number`是一个`int`所以分配是不可能的（使用发布的代码）。您可以指定成员之一`VertStruct`作为分配的目标：

```
Chunk[5].LOD[4].Verts[3].X = Number; 
```

如果您希望能够将 an 分配`int`给`VertStruct`您提供的 a `operator=(int)`（如 Luchian 已经提到的），但在我*看来*`int`，在调用站点上将值分配给哪些成员会非常模棱两可：

```
struct VertStruct
{
    double X, Y, Z;
    VertStruct& operator=(int d)
    {
        X = d; // Or 'Y' or 'Z' or all.
        return *this;
    }
}; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-23T15:41:21.847

这

```
Chunk[5].LOD[4].Verts[3] 
```

是 a `VertStruct`，你不能给它分配一个整数。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-23T15:42:54.147

你错过了一些东西，这并非不可能（如果你能想象，一切皆有可能。这就是成为科学家的全部意义）:)

`Chunk[5]`返回一个`ChunkStruct`。

`Chunk[5].LOD`返回一个`std::vector<LODStruct>`。

`Chunk[5].LOD[4]`返回一个`LODStruct`。

`Chunk[5].LOD[4].Verts`返回一个`std::vector<VertStruct>`。

最后，`Chunk[5].LOD[4].Verts[3]`返回一个`VertStruct`. 然后您尝试为其分配一个`int`。显然，不会使用您的代码。

为了让它工作（这个确切的语法），你应该重载`operator = (int x)`. 否则，将 分配给`int`您想要的任何成员。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-23T15:44:00.367

您正在分配一个数字，它是一个`int`into `VertStruct`，它是一个`struct`并且有 3 个字段（X、Y、Z）。如果要设置 X 坐标，请执行以下操作：

```
Chunk[5].LOD[5].Verts[3].X = Number; 
```

# paypal - Paypal 说我的 CancelURL 无效？

> ID：12095308
> 
> 赞同：0
> 
> 时间：2012-08-23T15:38:13.647
> 
> 标签：paypal

我正在创建一个网站，只是添加付款。
我正在使用[Paypal SDK](https://github.com/paypalx/SDKs/tree/master/Merchant/merchant-php-sdk)并设置了我的`SetExpressCheckout()`.

这是回应，

```
object(SetExpressCheckoutResponseType)[72]
  public 'Token' => null
  public 'Timestamp' => string '2012-08-23T15:21:15Z' (length=20)
  public 'Ack' => string 'Failure' (length=7)
  public 'CorrelationID' => string 'e0278e8e18b4f' (length=13)
  public 'Errors' => 
    object(ErrorType)[78]
      public 'ShortMessage' => string 'Transaction refused because of an invalid argument. See additional error messages for details.' (length=94)
      public 'LongMessage' => string 'CancelURL is invalid.' (length=21)
      public 'ErrorCode' => string '10472' (length=5)
      public 'SeverityCode' => string 'Error' (length=5)
      public 'ErrorParameters' => null
  public 'Version' => string '93.0' (length=4)
  public 'Build' => string '3556406' (length=7) 
```

我不确定发生了什么。我的`CancelURL`样子，`urlencode('https://www.example.com/users/account/');`. 我已经包含了尾部斜杠，有些人认为这会导致它无效。

我唯一能想到的是，因为我的网站在任何地方都不在线，所以 Paypal 无法访问该页面。我创建了一个虚拟页面并将其上传到`/users/account/`服务器上，因此它可以访问但仍然没有。我还有一个条目可以将流量`etc/hosts`路由`example.com`到我的本地主机，这对于我的 Facebook Auth 位来说效果很好。

任何人都知道 CancelURL 的限制是什么以及为什么 Paypal 会拒绝我的请求？

* * *

**请求生成**

```
$int = new PayPalAPIInterfaceServiceService();

$amount = new BasicAmountType();
$amount->currencyID = CakeSession::read('Locale.currency');
$amount->value = Configure::read('Subscription.price.'.CakeSession::read('Locale.shortname'));

$req_details_type = new SetExpressCheckoutRequestDetailsType();

$req_details_type->OrderTotal = $amount;
$req_details_type->ReturnURL = urlencode('https://www.example.com/paypal/getExpressCheckoutDetails');
$req_details_type->CancelURL = urlencode('https://www.example.com/users/account/');
$req_details_type->MaxAmount = $amount;
$req_details_type->OrderDescription = "Monthly subscription to Example.com Pro";
$req_details_type->ReqConfirmShipping = 0;
$req_details_type->NoShipping = 1;
$req_details_type->LocaleCode = CakeSession::read('Locale.shortname') == 'usa'? 'US' : 'GB';
$req_details_type->PaymentAction = 'Authorization';
$req_details_type->BuyerEmail = AuthComponent::user('email');
$req_details_type->BrandName = urlencode("Example.com");

$req_type = new SetExpressCheckoutRequestType();
$req_type->SetExpressCheckoutRequestDetails = $req_details_type;

$req = new SetExpressCheckoutReq();
$req->SetExpressCheckoutRequest = $req_type;

$response = $int->SetExpressCheckout($req);

var_dump($response); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T16:17:35.887

你必须改变：

```
$req_details_type->ReturnURL = urlencode('https://www.example.com/paypal/getExpressCheckoutDetails');
$req_details_type->CancelURL = urlencode('https://www.example.com/users/account/'); 
```

经过 ：

```
$req_details_type->ReturnURL = 'https://www.example.com/paypal/getExpressCheckoutDetails';
$req_details_type->CancelURL = 'https://www.example.com/users/account/'; 
```

urlcode(); 这里不需要它将您的网址转换为字符串

# android - 增强现实 + 子弹物理 - rayTest/Ray Picking 的麻烦

> ID：12095309
> 
> 赞同：0
> 
> 时间：2012-08-23T15:38:15.777
> 
> 标签：android, android-ndk, augmented-reality, bulletphysics, raycasting

我试图在子弹物理世界中挑选物体，但我似乎只能挑选地板/地平面！！！我正在使用 Vuforia SDK 并更改了 ImageTargets 演示代码。我使用以下代码将我的触摸屏点投影到 3d 世界：

```
void projectTouchPointsForBullet(QCAR::Vec2F point, QCAR::Vec3F &lineStart, QCAR::Vec3F &lineEnd, QCAR::Matrix44F &modelViewMatrix)
{

QCAR::Vec4F normalisedVector((2 * point.data[0] / screenWidth - 1),
        (2 * (screenHeight-point.data[1]) / screenHeight - 1),
        -1,
        1);
QCAR::Matrix44F modelViewProjection;
SampleUtils::multiplyMatrix(&projectionMatrix.data[0],  &modelViewMatrix.data[0] , &modelViewProjection.data[0]);
QCAR::Matrix44F inversedMatrix = SampleMath::Matrix44FInverse(modelViewProjection);

QCAR::Vec4F near_point = SampleMath::Vec4FTransform( normalisedVector,inversedMatrix);

near_point.data[3] = 1.0/near_point.data[3];
near_point = QCAR::Vec4F(near_point.data[0]*near_point.data[3], near_point.data[1]*near_point.data[3], near_point.data[2]*near_point.data[3], 1);

normalisedVector.data[2] = 1.0;//z coordinate now 1
QCAR::Vec4F far_point = SampleMath::Vec4FTransform( normalisedVector, inversedMatrix);

far_point.data[3] = 1.0/far_point.data[3];
far_point = QCAR::Vec4F(far_point.data[0]*far_point.data[3], far_point.data[1]*far_point.data[3], far_point.data[2]*far_point.data[3], 1);

lineStart = QCAR::Vec3F(near_point.data[0],near_point.data[1],near_point.data[2]);
lineEnd = QCAR::Vec3F(far_point.data[0],far_point.data[1],far_point.data[2]);
} 
```

当我在我的物理世界中尝试进行射线测试时，我似乎只是击中了地平面！这是射线测试调用的代码：

```
 QCAR::Vec3F intersection, lineStart;
   projectTouchPointsForBullet(QCAR::Vec2F(touch1.tapX, touch1.tapY), lineStart, lineEnd,inverseProjMatrix, modelViewMatrix);
    btVector3 btRayFrom = btVector3(lineEnd.data[0], lineEnd.data[1], lineEnd.data[2]);
    btVector3 btRayTo = btVector3(lineStart.data[0], lineStart.data[1], lineStart.data[2]);

    btCollisionWorld::ClosestRayResultCallback rayCallback(btRayFrom,btRayTo);
    dynamicsWorld->rayTest(btRayFrom, btRayTo, rayCallback);
    if(rayCallback.hasHit())
    {
        char* pPhysicsData = reinterpret_cast<char*>(rayCallback.m_collisionObject->getUserPointer());//my bodies have char* messages attached to them to determine what has been touched
        btRigidBody* pBody = btRigidBody::upcast(rayCallback.m_collisionObject);
        if (pBody && pPhysicsData)
        {
            LOG("handleTouches:: notifyOnTouchEvent from physics world!!!");
            notifyOnTouchEvent(env, obj,0,0, pPhysicsData);
        }

    } 
```

我知道我主要是从上往下看，所以我一定会撞到地面，我至少知道我的触摸被正确地投射到世界上，但是我有物体躺在地面上，我似乎不能能够触摸到它们！任何指针将不胜感激:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T15:58:02.943

我发现了为什么我无法触摸对象 - 我在绘制对象时将它们放大，因此在将触摸点投影到 3d 世界之前，我必须将视图矩阵缩放相同的值（编辑 I还颠倒了 btRayFrom 和 btRayTo 输入坐标，现在已修复）：

```
//top of code
int kObjectScale = 100.0f
....
...
//inside touch handler method
SampleUtils::scalePoseMatrix(kObjectScale, kObjectScale, kObjectScale,&modelViewMatrix.data[0]);
    projectTouchPointsForBullet(QCAR::Vec2F(touch1.tapX, touch1.tapY), lineStart, lineEnd,inverseProjMatrix, modelViewMatrix);
    btVector3 btRayFrom = btVector3(lineStart.data[0], lineStart.data[1], lineStart.data[2]);
    btVector3 btRayTo = btVector3(lineEnd.data[0], lineEnd.data[1], lineEnd.data[2]); 
```

我的触摸现在可以正确投影了:)

# crystal-reports - 当某些字段为空时，公式不会显示

> ID：12095314
> 
> 赞同：0
> 
> 时间：2012-08-23T15:38:24.453
> 
> 标签：crystal-reports, crystal-reports-xi, crystal-reports-2010

类似于我的第一个问题。我想在包含以下字段的文本框中显示我的地址

```
{Company}
{AddLine1}
{AddLine2}
{ZIP}{State}{City} 
{Country} 
```

我（希望你们中的一些人）关注的线路是{ZIP} {City} {State}。我想要生成的是一致的寻址格式，这样即使数据库中的 ZIP、City 或 State 字段留空，也不会出现空格或缩进。该行仍应与其余行对齐并且不缩进。我还希望在相关的 zip、州、城市之间插入逗号，而在不相关的地方将它们排除在外。为此，我写了一个公式。以下：

```
If isnull({BILL_TO.ZIP}) or trim({BILL_TO.ZIP})= "" Then "" else {BILL_TO.ZIP}
+
(If isnull({BILL_TO.State}) or trim({BILL_TO.State})= "" Then ""
    else(If not isnull({BILL_TO.ZIP}) and length(trim({BILL_TO.ZIP})) <> 0 Then ", "        else "") + {BILL_TO.State})
+
(If isnull({BILL_TO.CITY}) or length(trim({BILL_TO.CITY})) = 0 Then ""
    else(

            If (not isnull({BILL_TO.State}) and length(trim({BILL_TO.State})) <> 0) 
                or
                (not isnull({BILL_TO.Zip}) and length(trim({BILL_TO.Zip})) <> 0)

            Then ", " else "")+ {BILL_TO.CITY})) 
```

问题是当只有一个城市（没有输入州或邮政编码）时，公式本身不会显示。但是，当其他人在场时，它会显示。

任何人都可以看到此代码中的错误？？？这太痛苦了

谢谢您的帮助。

期待你们的回音！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T16:03:00.810

该公式中有很多 if-then-elses，所以很难说，但如果它没有显示任何内容，则可能意味着您在某处使用字段而没有首先处理其 null 条件。更简单的东西可能是你最好的选择：

```
local stringvar output;
if not(isnull({Customer.Postal Code})) then output:=trim({Customer.Postal Code}) + ', ';
if not(isnull({Customer.Region})) then output:=output + trim({Customer.Region}) + ', ';
if not(isnull({Customer.City})) then output:=output + trim({Customer.City}) + ', ';

left(output,length(output)-2) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T16:18:33.620

为每个数据库字段创建一个公式字段。例如：

```
// {@CITY}
If Isnull({BILL_TO.CITY}) Then
  ""
Else 
  Trim({BILL_TO.CITY})

// {@STATE}
If Isnull({BILL_TO.STATE}) Then
  Space(2)
Else
  Trim({BILL_TO.STATE})

// {@ZIP}
If Isnull({BILL_TO.ZIP}) Then
  Space(5)  //adjust to meet your needs
Else
  Trim({BILL_TO.ZIP}) 
```

将每个公式字段嵌入文本对象中。

格式化文本对象及其字段以满足您的需要。

** 编辑 **

如果您有数据质量问题，请在 STATE 和 ZIP 公式中解决它们（因为它们的长度是恒定的）。我会添加逗号并间隔文本对象。

# objective-c - 有没有像“跳转到”或“去”这样的东西？

> ID：12095322
> 
> 赞同：-4
> 
> 时间：2012-08-23T15:38:57.320
> 
> 标签：objective-c, c

这是我的场景：

```
if(something){
    if(something2){
        JUMP TO ELSE DIRECTLY WITHOUT EXECUTING ANYMORE CODE
    }
    [self doSomething];
}else{

} 
```

Objective-C中有这样的东西吗？谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T15:40:33.073

由于 Objective-C 是 C 的严格超集，您可以使用 C 的[`goto`](http://tigcc.ticalc.org/doc/keywords.html#goto)关键字，但您[可能不想使用](http://www.google.com/?q=goto+considered+harmful).

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-23T18:10:35.913

复合条件可以让你直接进入 else 语句。

```
if(something && !something2)
{
    [self doSomething];
}else{

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T15:41:17.760

是的，但很多人会不赞成使用它：

```
if(something){

if(something2){
    goto label;
}else{
    [self doSomething];
}

label: 
```

# zend-framework - 在 OS X 10.7 Lion 上设置 Zend Framework CLI 工具

> ID：12095325
> 
> 赞同：0
> 
> 时间：2012-08-23T15:39:07.387
> 
> 标签：zend-framework, php, include-path

多年来，我一直在努力在 OS X 上设置 Zend Framework 的 CLI 工具。我已按照[手册](http://framework.zend.com/manual/en/zend.tool.framework.clitool.html#zend.tool.framework.clitool.setup-starnix)进行操作，但无法正常工作。

> *nix 环境中最常见的设置是将 zf.sh 和 zf.php 复制到与 PHP 二进制文件相同的目录中。
> 
> [...]
> 
> 要找出 PHP 二进制文件的位置，您可以在命令行上执行“which php”。这将返回您将用于在此环境中运行 PHP 脚本的 PHP 二进制文件的位置。

当我这样做时，它说`/usr/bin/php`。所以，我把`zf.sh`和`zf.php`放入`/usr/bin`.

现在，下一步是我真正感到困惑的地方。

> 下一个任务是确保在系统 PHP include_path 中正确设置 Zend Framework 库。要找出您的 include_path 所在的位置，您可以执行 php -i 并查找 include_path 变量，或者更简洁地执行 php -i | grep 包含路径。一旦你找到了你的 include_path 所在的位置（这通常是 /usr/lib/php、/usr/share/php、/usr/local/lib/php 或类似的东西），确保 / library/ 目录放在你的 include_path 指定目录中。

运行`php -i | grep include_path`返回`include_path => .: => .:`，我不太确定这意味着什么（我是 *nix 的新手）。我试图将`library`文件夹的内容复制到`/usr/share/php/`，但没有运气。

所以我想我的问题是弄清楚我的包含路径在哪里，这样我就可以把库文件夹的内容放在那里。我想我会找到我的 php.ini。当我`phpinfo()`从脚本运行时，它说我的 php.ini 位于`/etc`，但该文件夹中没有 php.ini 。此外，执行`php -i`显示以下内容：

```
Configuration File (php.ini) Path => /etc
Loaded Configuration File => (none) 
```

我猜我的 PHP 正在使用默认设置运行，因为没有加载配置文件。我正在从终端测试`zf show version`并获取`-bash: zf: command not found`.

我真的，真的很困惑！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T16:38:08.553

我曾经遇到过类似的问题。如果我没记错的话，我使用的是 WAMP，它有多个 php.ini 文件（我认为是 3 个），我必须找到正确的一个。

我遵循了本教程，它对我 [有用 http://akrabat.com/wp-content/uploads/Getting-Started-with-Zend-Framework.pdf](http://akrabat.com/wp-content/uploads/Getting-Started-with-Zend-Framework.pdf)

希望能帮助到你

# scala - Akka 中异步 io 的延迟回复

> ID：12095328
> 
> 赞同：5
> 
> 时间：2012-08-23T15:39:21.880
> 
> 标签：scala, akka

我使用akka有一段时间了。我开始在我的代码中看到一些模式来解决异步 io 的延迟回复。这个实现好吗？还有另一种方法可以在没有阻塞的情况下进行延迟回复？

```
class ApplicationApi(asyncIo : ActorRef) extends Actor {
    // store senders to late reply
    val waiting = Map[request, ActorRef]()

    def receive = {
        // an actore request for a user, store it to late reply and ask for asyncIo actor to do the real job
        case request : GetUser => 
            waiting += (sender -> request)
            asyncIo ! AsyncGet("http://app/user/" + request.userId)
        // asyncio response, parse and reply
        case response : AsyncResponse =>
            val user = parseUser(response.body)
            waiting.remove(response.request) match {
                case Some(actor) => actor ! GetUserResponse(user)
            }
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-23T16:20:00.930

在等待回复时避免阻塞的一种方法是使用返回 a 的`ask`方法（也称为`?`运算符）发送`Future`（与`!`返回不同`()`）。

使用`onSuccess`or`foreach`方法，您可以指定如果/当未来通过回复完成时要执行的操作。要使用它，您需要混合[`AskSupport`](http://doc.akka.io/api/akka/2.0.3/#akka.pattern.AskSupport)特征：

```
class ApplicationApi(asyncIo : ActorRef) extends Actor with AskSupport {

  def receive = {
    case request: GetUser =>
      val replyTo = sender
      asyncIo ? AsyncGet("http://app/user/" + request.userId) onSuccess {
        case response: AsyncResponse =>
          val user = parseUser(response.body)
          replyTo ! GetUserResponse(user)
      }

} 
```

避免使用这种技术来执行任何修改`ApplicationApi`actor状态的副作用，因为该效果将与接收循环不同步。不过，将消息转发给其他参与者应该是安全的。

* * *

顺便说一句，这里有一个技巧，可以将当前捕获`sender`作为模式匹配的一部分，避免稍后将其分配给变量。

```
trait FromSupport { this: Actor =>
  case object from {
    def unapply(msg: Any) = Some(msg, sender)
  }
}

class MyActor extends Actor with FromSupport {
  def receive = {
    case (request: GetUser) from sender =>
      // sender is now a variable (shadowing the method) that is safe to use in a closure
  }
} 
```

# drupal-6 - drupal中主菜单链接和二级菜单链接是什么关系？

> ID：12095332
> 
> 赞同：0
> 
> 时间：2012-08-23T15:39:33.507
> 
> 标签：drupal-6

我尝试了另一个 CMS，它是 Drupal，当我对`Drupal 6`. 我已经尝试过创建两者，我想知道它们的关系或联系是什么。任何人都可以尽可能简明扼要地告诉我吗？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T15:49:33.313

尽可能简短：您有 2 个选择：

1.  主链接和辅助链接是完全不同的菜单，没有任何关系
2.  您还可以在菜单设置中将辅助链接源设置为“主要链接”。这将具有这样的效果，即在主链接菜单中设置的主链接的子项将显示在此辅助菜单中。

例如，如果您有：

*   一种
    *   A.1
    *   A2
*   乙
    *   B.1

在第一个“选择”中，您的主链接菜单将包含所有这些链接。但是在第二个选项中，您的主链接菜单将包含 A 和 B，而辅助链接菜单将包含 A.1 和 A.2 或 B.1，具体取决于主链接选择（A 或 B）。

这段 10 分钟的视频涵盖了这两个选项：[http ://www.lullabot.com/videos/using-secondary-menus](http://www.lullabot.com/videos/using-secondary-menus)

# r - do.call 与 cbind 和变量的滞后

> ID：12095336
> 
> 赞同：1
> 
> 时间：2012-08-23T15:39:40.100
> 
> 标签：r

我想创建一个函数，该函数生成一个包含多个变量滞后的矩阵。一个有效的简单示例是

```
a <- ts(1:10)
cbind(a, lag(a, -1)) 
```

要为多个滞后做到这一点，我有

```
lagger <- function(var, lags) {

  ### Create list of lags
  lagged <- lapply(1:lags, function(x){
    lag(var, -x)
  })

  ### Join lags together
  do.call(cbind, list(var, lagged))
} 
```

使用上面的例子会产生意想不到的结果；

```
lagger(a, 1) 
```

给出一个长度为 20 的列表，其中原始时间序列分解为单独的列表槽，最后 10 个是滞后序列的复制。

有什么建议可以让这个工作吗？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T15:57:49.940

这给出了 0 和 1 的滞后。

```
library(zoo)
a <- ts(11:13)
lags <- -(0:1)

a.lag <- as.ts(lag(as.zoo(a), lags)) 
```

现在`a.lag`是这样的：

```
> a.lag
Time Series:
Start = 1 
End = 4 
Frequency = 1 
  lag0 lag-1
1   11    NA
2   12    11
3   13    12
4   NA    13 
```

如果您不想要这些`NA`条目，请使用：`as.ts(na.omit(lag(as.zoo(a), lags)))`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-23T15:57:31.093

基于@Joshua Ulrich 的回答。

我认为 embed 是正确的答案，但是您以相反的方式获得向量。我的意思是使用`embed`你会得到不正确顺序的滞后系列，请参阅以下内容

```
lagged <- embed(a,4)
colnames(lagged) <- paste('t', 3:0, sep='-')
lagged 
    t-3 t-2 t-1 t-0
[1,]   4   3   2   1
[2,]   5   4   3   2
[3,]   6   5   4   3
[4,]   7   6   5   4
[5,]   8   7   6   5
[6,]   9   8   7   6
[7,]  10   9   8   7 
```

这会为您提供正确的答案，但顺序不正确，因为滞后是按降序排列的。

但是你重新排序就像这样：

```
lagged_OK <- lagged[,ncol(lagged):1]
colnames(lagged_OK) <- paste('t', 0:3, sep='-')
lagged_OK  
    lag.0 lag.1 lag.2 lag.3
[1,]     1     2     3     4
[2,]     2     3     4     5
[3,]     3     4     5     6
[4,]     4     5     6     7
[5,]     5     6     7     8
[6,]     6     7     8     9
[7,]     7     8     9    10 
```

然后，你得到正确的滞后矩阵。

我添加`colnames`仅用于解释目的，您可以这样做：

```
embed(a,4)[ ,4:1] 
```

如果你真的想要一个`lagger`功能，试试这个

```
lagger <- function(x, lag=1){
      lag <- lag+1
      Lagged <- embed(x,lag)[ ,lag:1]
      colnames(Lagged) <- paste('lag', 0:(lag-1), sep='.')
      return(Lagged)
        }

lagger(a, 4)
     lag.0 lag.1 lag.2 lag.3 lag.4
[1,]     1     2     3     4     5
[2,]     2     3     4     5     6
[3,]     3     4     5     6     7
[4,]     4     5     6     7     8
[5,]     5     6     7     8     9
[6,]     6     7     8     9    10

lagger(a, 1)
      lag.0 lag.1
 [1,]     1     2
 [2,]     2     3
 [3,]     3     4
 [4,]     4     5
 [5,]     5     6
 [6,]     6     7
 [7,]     7     8
 [8,]     8     9
 [9,]     9    10 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-23T15:43:24.383

我不确定您的功能有什么问题，但您可以`embed`改用它。

```
> embed(a,4)
     [,1] [,2] [,3] [,4]
[1,]    4    3    2    1
[2,]    5    4    3    2
[3,]    6    5    4    3
[4,]    7    6    5    4
[5,]    8    7    6    5
[6,]    9    8    7    6
[7,]   10    9    8    7 
```

# visual-studio-2012 - Visual Studio 2012 不转换 vs2010 解决方案？

> ID：12095339
> 
> 赞同：68
> 
> 时间：2012-08-23T15:39:50.663
> 
> 标签：visual-studio-2012, projects-and-solutions, solution

我用 vs2012 打开了我的 vs2010 解决方案，但它没有进行任何转换，因为从 2008 年到 2010 年正在发生。所以我的解决方案仍然与上面的 10 标签相同。当我制作一个新的解决方案时，它当然有 11 个标签。我这样运行没有任何问题，但我很好奇。有什么区别吗？如果是，如何转换成 vs2012 解决方案？

* * *

## 回答 #1

> 赞同：106
> 
> 时间：2012-09-13T13:02:38.940

我设法“转换”解决方案文件，将 .SLN 文件中包含“#Visual Studio 2010”的行更改为“#Visual Studio 2012”。

* * *

## 回答 #2

> 赞同：90
> 
> 时间：2013-04-02T23:23:59.000

不需要或建议手动编辑解决方案文件。只需在 VS2012 中打开 VS2010 解决方案，左键单击解决方案（在解决方案资源管理器的最顶部），然后使用*File* | *另存为*以覆盖原始文件。这将有效地将 VS2010 解决方案文件转换为 VS2012 解决方案文件。

* * *

## 回答 #3

> 赞同：32
> 
> 时间：2012-08-23T15:48:46.620

[有一些例外](http://msdn.microsoft.com/en-us/library/hh266747(VS.110).aspx)，但大多数情况下您将能够在 VS2012 和 VS2010 SP1 中打开相同的项目和解决方案文件文件。

VS2012*可能会*在您首次打开项目时对其进行转换，但这些更改（除非在链接的文档中注明）向后兼容 VS2010（即在需要时使用条件仅在加载时适用于任一版本）尽管大多数项目类型将完全保持不变.

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-08-23T15:44:06.003

这是关于 Visual Studio 2012 兼容性的

如果您在带有 Service Pack 1 (SP1) 的 Visual Studio 2010 中创建资产，其中许多将在 Visual Studio 2012 中加载和运行，而无需您进行任何进一步的操作。

许多资产也将在带有 SP1 的 Visual Studio 2010 中再次打开而不会出现任何问题，即使您在 Visual Studio 2012 中打开这些资产也是如此

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2013-05-22T23:02:50.463

对于 C++ 项目，它有所不同，因为 2012 编译器 (VC11) 将仅用于明确为 2012 的项目，而不是在 VS 2012 中打开的 2010 项目。[一些 C++11 改进可用于 VC11 编译器，但不能用于VC10](http://msdn.microsoft.com/en-us/library/vstudio/hh567368.aspx)（有关摘要，请参阅此[SO 答案](https://stackoverflow.com/a/7422058/135114)），包括：

*   基于范围的for循环
*   新的标准库头文件（原子、互斥体、线程......）
*   更小的标准库容器尺寸
*   （[当 2012 年 11 月的 CTP](http://blogs.msdn.com/b/vcblog/archive/2012/11/02/visual-c-c-11-and-the-future-of-c.aspx)交付到 VS 2012 时，还有更多内容）

为了从 VS 2010 项目转换为 VS2012 **，无需手动编辑解决方案文件或在现有项目上“另存为”**。反而：

> 如果您在第一次出现提示时拒绝更新，您可以稍后通过打开**项目**菜单并选择**更新 VC++ 项目来更新项目...** [在菜单选项的顶部]

从 MSDN 的“[如何：将 Visual C++ 项目升级到 Visual Studio 2012](http://msdn.microsoft.com/en-us/library/vstudio/hh690665.aspx) ”
*（此页面链接自 @Joachim 的[MSDN 链接](http://msdn.microsoft.com/en-us/library/hh266747%28VS.110%29.aspx)，但我想在 SO 上获得答案，因为许多其他答案建议手动解决方法而不是这个 VS 2012特征）*

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-12-02T13:59:36.673

就我而言，我有一些 Visual Source Safe 的东西（我的项目是用 Visual Studio 2003/2005 创建的，是的，很旧！）

一旦我手动删除了 VSS 的东西，转换就成功了。PS：我知道这是关于 VS2010，但也许这对其他人有帮助。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-04-23T17:25:33.970

您可以通过执行以下操作将项目从 VS2010 转换为 VS2012：

1.  通过在解决方案资源管理器中右键单击您的解决方案并选择添加 --> 现有项目...，将 2010 项目添加到您的 VS2012 解决方案中。

2.  该项目将出现在解决方案中，并将 (Visual Studio 2010) 附加到其名称。

3.  右键单击添加的项目并选择属性。

4.  在 Configuration Properties --> General 窗格中，将 Platform Toolset 字段中的设置更改为 Visual Studio 2012 (v110)

5.  对每个配置类型重复，例如发布和调试。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2014-06-06T16:24:55.293

我在谷歌搜索特定问题的解决方案时遇到了这个问题：当从命令行（特别是通过 TeamCity）调用时，MSBuild 未能针对 VS2012 解决方案执行 Publish 目标，该解决方案在 VS2010 中开始运行：

```
error MSB4019: The imported project "C:\Program Files (x86)\MSBuild\Microsoft\VisualStudio\v10.0\Windows Azure Tools\2.3\Microsoft.WindowsAzure.targets" was not found. Confirm that the path in the <Import> declaration is correct, and that the file exists on disk. 
```

MSBuild 在 VS10 位置（C:\Program Files (x86)\MSBuild\Microsoft\VisualStudio\v10.0\Windows Azure Tools\2.3\Microsoft.WindowsAzure.targets）中寻找 Azure SDK 2.3 目标。Sayed Ibrahim Hashimi 在[博客文章](http://sedodream.com/2012/08/19/VisualStudioProjectCompatabilityAndVisualStudioVersion.aspx)中解释了原因，据我了解，归结为他们在启用解决方案文件的跨版本兼容性时做出的一些决定。解决方案很简单：将 VisualStudioVersion 属性添加到 MSBuild 调用中，如下所示：

```
msbuild.exe MyAwesomeWeb.sln /p:VisualStudioVersion=11.0 
```

实际上，这会覆盖每个 csproj 文件中的以下内容：

```
<VisualStudioVersion Condition="'$(VisualStudioVersion)' == ''">10.0</VisualStudioVersion> 
```

据推测，您可以通过手动编辑所有这些以将 10.0 替换为 11.0 来获得相同的结果，但这可能会破坏向后兼容性——我还没有尝试过。我也没有尝试更新 VS2013 来查看问题是否仍然存在。

因此，通过回答问题来结束这一点：是的，在您“转换”之前存在一些差异（使用其他回答者提供的任何方法），之后仍然存在一些差异。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-11-09T00:29:58.067

这略有不同，但遵循相同的思路，以防万一它对任何人有帮助：

我正在加载一个看起来正在加载的项目，然后一直将所有项目显示为不可用。迁移报告上没有错误。我尝试使用各种方法（包括此处的建议）多次重新加载解决方案和项目。

最后，在解决方案资源管理器中右键单击解决方案时，我发现了一个“解决错误”选项。VS 再次经历了一个加载过程，它工作了；没问题。

我不知道那次它做了什么不同，但显然它有所作为。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-11-14T12:03:41.130

很简单，只需编辑 .sol 文件，将版本更改为 11

像这样

Microsoft Visual Studio 解决方案文件，格式版本 12.00

视觉工作室 2012

# php - 类 Symfony\Component\Form\Form 不是有效的实体或映射的超类

> ID：12095341
> 
> 赞同：1
> 
> 时间：2012-08-23T15:39:53.750
> 
> 标签：php, symfony

提交表单时出现此错误：

> 类 Symfony\Component\Form\Form 不是有效的实体或映射的超类。

问题出在我试图将数据保存到控制器中的数据库中。当我隐藏那部分代码时，提交表单没有问题。我正在使用 Symfony 2.0.16

这是实体

```
<?php

namespace Acme\FormsBundle\Entity;

use Doctrine\ORM\Mapping as ORM;

/**
 * Acme\FormsBundle\Entity\UserAccount
 */
class UserAccount {
/**
 * @var integer $id
 */
private $id;

/**
 * @var string $user_id
 */
private $user_id;

/**
 * @var string $mail
 */
private $mail;

/**
 * @var string $password
 */
private $password;

/**
 * @var string $role
 */
private $role;

/**
 * @var string $pseudo
 */
private $pseudo;

/**
 * @var string $nom
 */
private $nom;

/**
 * @var string $prenom
 */
private $prenom;

/**
 * @var string $sexe
 */
private $sexe;

/**
 * @var text $freetext
 */
private $freetext;

/**
 * @var boolean $status
 */
private $status;

/**
 * Get id
 *
 * @return integer
 */
public function getId() {
    return $this -> id;
}

/**
 * Set user_id
 *
 * @param string $userId
 */
public function setUser_id($user_id) {
    $this -> user_id = $user_id;
}

/**
 * Get user_id
 *
 * @return string
 */
public function getUser_id() {
    return $this -> user_id;
}

/**
 * Set mail
 *
 * @param string $mail
 */
public function setMail($mail) {
    $this -> mail = $mail;
}

/**
 * Get mail
 *
 * @return string
 */
public function getMail() {
    return $this -> mail;
}

/**
 * Set password
 *
 * @param string $password
 */
public function setPassword($password) {
    $this -> password = $password;
}

/**
 * Get password
 *
 * @return string
 */
public function getPassword() {
    return $this -> password;
}

/**
 * Set role
 *
 * @param string $role
 */
public function setRole($role) {
    $this -> role = $role;
}

/**
 * Get role
 *
 * @return string
 */
public function getRole() {
    return $this -> role;
}

/**
 * Set pseudo
 *
 * @param string $pseudo
 */
public function setPseudo($pseudo) {
    $this -> pseudo = $pseudo;
}

/**
 * Get pseudo
 *
 * @return string
 */
public function getPseudo() {
    return $this -> pseudo;
}

/**
 * Set nom
 *
 * @param string $nom
 */
public function setNom($nom) {
    $this -> nom = $nom;
}

/**
 * Get nom
 *
 * @return string
 */
public function getNom() {
    return $this -> nom;
}

/**
 * Set prenom
 *
 * @param string $prenom
 */
public function setPrenom($prenom) {
    $this -> prenom = $prenom;
}

/**
 * Get prenom
 *
 * @return string
 */
public function getPrenom() {
    return $this -> prenom;
}

/**
 * Set sexe
 *
 * @param string $sexe
 */
public function setSexe($sexe) {
    $this -> sexe = $sexe;
}

/**
 * Get sexe
 *
 * @return string
 */
public function getSexe() {
    return $this -> sexe;
}

/**
 * Set freetext
 *
 * @param text $freetext
 */
public function setFreetext($freetext) {
    $this -> freetext = $freetext;
}

/**
 * Get freetext
 *
 * @return text
 */
public function getFreetext() {
    return $this -> freetext;
}

/**
 * Set status
 *
 * @param boolean $status
 */
public function setStatus($status) {
    $this -> status = $status;
}

/**
 * Get status
 *
 * @return boolean
 */
public function getStatus() {
    return $this -> status;
}

} 
```

这是控制器

```
namespace Acme\FormsBundle\Controller;
use Symfony\Bundle\FrameworkBundle\Controller\Controller;
use Symfony\Component\HttpFoundation\Request;
use Symfony\Component\HttpFoundation\Response;
use Acme\FormsBundle\Entity\UserAccount;

class DefaultController extends Controller {

public function newUserAction(Request $request) {
    $newUser = new UserAccount();
    $newUser -> setUser_id('');
    $newUser -> setRole('');
    $newUser -> setNom('');
    $newUser -> setPrenom('');
    $newUser -> setSexe('');
    $newUser -> setFreetext('');
    $newUser -> setStatus('');

    $newUserForm = $this -> createFormBuilder($newUser)
                -> add('pseudo', 'text')
                -> add('mail', 'email')
                -> add('password', 'password')
                -> getForm();

    //if the form has been submitted
    if ($request->getMethod() == 'POST') {
        $newUserForm->bindRequest($request);

        if ($newUserForm->isValid()) {
            //Perform some actions
            $em = $this->getDoctrine()->getEntityManager();
            $em->persist($newUserForm);
            $em->flush();

            //Prepare confirmation message
            $this->get('session')->setFlash('notice','Account successfully created');

            //redirect user
            return $this->redirect($this->generateUrl('AcmeWelcomeBundle_homepage'));
        }
    }

    return $this -> render('AcmeFormsBundle:Default:newUser.html.twig', array('form' => $newUserForm -> createView(), ));
}
} 
```

我想不通。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T15:41:14.593

您应该坚持您的`$newUser`对象，而不是表单本身。

# oracle - 如何创建临时表或仅从循环中的列中选择不同的值

> ID：12095342
> 
> 赞同：0
> 
> 时间：2012-08-23T15:40:06.857
> 
> 标签：oracle, temp-tables, distinct-values

我有一个有 2 列的表，第一列有重复值，现在在一个 while 循环中我想一次选择每个不同的值，我在 sql 中创建了一个临时表，但是在 oracle sql developer 中我如何编写代码？

```
CREATE TABLE look_up_table
(row_id INT NOT NULL,
 attribute VARCHAR(500),
 VARCHAR(700)
)
/* now manually populating this table */
INSERT INTO look_up_table
VALUES
(1, grmacolor_frame_access, black);
(2, grmacolor_frame_access, blue);
(3, grmacolor_frame_access, red);
(4, grmamaterial_frame_access, acetate);
(5, grmamaterial_frame_access, metal);
(6, grmamaterial_frame_access, nylon);
(7, grmamaterial_frame_access, plastic);

DECLARE @temp_col_val NVARCHAR (700),  @counter1 INT,
SET @counter1 = 0;
SET @column_count = (SELECT COUNT (DISTINCT attribute) FROM look_up_table);

CREATE TABLE #temp1 AS
SELECT DISTINCT attribute AS attrib,
ROW_NUMBER() OVER (ORDER BY attribute) AS seqno1,
FROM look_up_table;

WHILE (@counter1 < @column_count)
BEGIN;

SET @temp_col_val = (SELECT attrib FROM #temp1 WHERE seqno1 = @counter1; 
```

请帮忙

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T16:24:25.253

**以下代码将遍历每个属性并打印它：**

```
declare 
    curField varchar2(100);
    resultCnt number ; 
begin    
    select count(distinct attribute) into resultCnt from look_up_table;
    for ind in 1..resultCnt loop
        select attribute into curField from (
            select attribute, rownum rwn
            from 
            (
               select distinct attribute
               from look_up_table
            )
        ) where rwn = ind;

        dbms_output.put_line (curField);
    end loop;
end;
/ 
```

# sql-server - 获取插入的表标识值并更新另一个表

> ID：12095355
> 
> 赞同：-1
> 
> 时间：2012-08-23T15:40:43.590
> 
> 标签：sql-server, tsql

我在 TablesAs KeyA 列的 TableB 上有两个具有外键约束的表。到目前为止，我一直在进行手动插入，因为它们只需要添加几行。现在我需要进行批量插入，所以我的问题是，如果我在 TableA 中插入多行，我如何获取所有这些标识值并将它们与其他列值一起插入到 TableB 中。请参阅下面的脚本。

```
INSERT INTO Tablea
       ([KeyA]
       ,[Value] )
    SELECT 4 ,'StateA'
UNION ALL
SELECT 5 ,'StateB'
UNION ALL
SELECT 6 ,'StateC'

INSERT INTO Tableb
       ([KeyB]
       ,[fKeyA] //Get value from the inserted row from TableA
       ,[Desc])
SELECT 1 ,4,'Value1'
UNION ALL
SELECT 2 ,5,'Value2'
UNION ALL
SELECT 3 ,6, 'Value3' 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T15:48:33.327

您可以使用 INSERT 的 OUTPUT 子句来执行此操作。这是一个例子：

```
CREATE TABLE #temp (id [int] IDENTITY (1, 1) PRIMARY KEY CLUSTERED, Val int)

CREATE TABLE #new (id [int], val int)

INSERT INTO #temp (val) OUTPUT inserted.id, inserted.val INTO #new VALUES (5), (6), (7) 

SELECT id, val FROM #new

DROP TABLE #new
DROP TABLE #temp 
```

返回的结果集包括插入的 IDENTITY 值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T15:46:10.917

[范围标识有时会返回不正确的值](https://connect.microsoft.com/SQLServer/feedback/details/328811/scope-identity-sometimes-returns-incorrect-value)。请参阅`OUTPUT`解决方法部分中的使用。

# facebook - 非常简单的应用程序选项卡 iframe - 不会加载

> ID：12095358
> 
> 赞同：0
> 
> 时间：2012-08-23T15:40:54.633
> 
> 标签：facebook, tabs, facebook-iframe, iframe-app

我创建了有史以来最简单的应用程序 - 我基本上只是想 iframe 我的网站paleoitforward.com。

[>> 这是我的应用设置的截图](http://heathercash.com/facebook/fb-ss1.png)

但是，我在页面上收到一条错误消息。你可以在这里看到它的作用：http: [//facebook.com/heathercashart/app_337591392998654](http://facebook.com/heathercashart/app_337591392998654)

在 Chrome 中，我收到消息“此网页不可用” 在 Firefox 中，我收到消息“Firefox 无法在本地主机上建立与服务器的连接”。

本地主机...有多奇怪？

我不知道为什么它不会加载，我不知道如何解决它：-/

该站点通过 HTTPS 加载正常，因此 HTTPS 不是问题。

另外-仅供参考-我是这个Facebook应用程序的n00b ... :)

谢谢，希瑟

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T15:15:33.180

好的，我不确定是什么解决了这个问题，但我基本上只是在更改`URL`'s（添加 http，删除 http，添加斜杠，删除它......），突然之间它起作用了！

以下是我使用的 URL，以防万一将来有人遇到此问题（请确保密切注意 http/https 和尾部斜杠！）：

应用程序域：`paleoitforward.com`

```
Website with Facebook Login
  Site URL: http://paleoitforward.com

Page Tab
  Page Tab URL: https://paleoitforward.com
  Secure Page Tab URL: https://paleoitfoward.com/
  Page Tab Edit URL: https://paleoitfoward.com/ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-27T15:13:28.467

在您的应用设置（屏幕截图显示）中，您`paleoitfoward.com`在页面选项卡设置中编写了 -在*forRRRRRRRRRRward中缺少***R** ...</p>

**如果一个人可以阅读，生活会更容易，相信我:-)**

# php - 在多线程之前在长时间运行的后台 shell 脚本中传递数组

> ID：12095360
> 
> 赞同：0
> 
> 时间：2012-08-23T15:40:58.993
> 
> 标签：php, linux, multithreading, shell

在 crontab 中，我添加了一个 php 脚本名称，从 CLI SAPI 模式运行此脚本，因此没有 max_execution_time 问题。

我可以使用空格传递几个参数。

```
system('/path/of/your/script.php param1 param2 > scriptlog.txt &') 
```

但是我需要传递一个数组作为参数是shell脚本并分解数组。

例如，

```
system('/path/of/your/script.php array > scriptlog.txt &') 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T15:48:24.577

当你[`system`](http://php.net/system)在你的应用程序中进行投射时，你必须[`implode`](http://php.net/implode)将你的参数
传递给像

```
system('/path/of/your/script.php param[0] param[1] > scriptlog.txt &') 
```

这看起来像

```
system('/path/of/your/script.php '.implode(" ",$params).' > scriptlog.txt &') 
```

如果你有引号，你可以看看[escapeshellarg](http://php.net/escapeshellarg)

```
system('/path/of/your/script.php '.implode(" ",array_map("escapeshellarg",$params)).' > scriptlog.txt &') 
```

然后在你的`script.php`，捕捉参数

```
$args = $argv;
array_shift($args); //Because $args[0] is 'script.php' 
```

如果你正在赶上`> scriptlog.txt &`你的`script.php`，请改用它：

```
$args = $argv;
if (false !== ($pos = array_search(">",$args))) {
    $args = array_slice($args,1,$pos-1);
} else {
    array_shift($args);
} 
```

请注意，这仅适用于您的数组是非关联的。
您需要编写另一个函数来检索关联参数

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T15:54:53.727

您不能直接将数组传递出去。理想情况下，您想要做的是将数组的每个成员作为单独的参数传递，然后将它们读回以在您的脚本中使用。您还可以将要读取的参数数量传递给脚本。IE。

```
$out = sizeof($array);
foreach ($array as $arg){
    $out = $out . ' ' . $arg;
} 
```

这应该为您的输出对象提供一个类似“4 param1 param2 param3 param4”的列表

然后，您只需在 bash 脚本中使用 ARGV 读取这些变量。

或者，您也可以使用字段分隔列表，将其作为一个参数读取，然后使用字段分隔符上的拆分拆分每个数组元素。

# sorting - jqGrid 特殊排序

> ID：12095362
> 
> 赞同：1
> 
> 时间：2012-08-23T15:41:13.270
> 
> 标签：sorting, jqgrid

我在带有 jqGrid 表的视图中显示了这些数据。它具有在服务器端完成的复杂行排序顺序。

现在我需要能够对视图中的行进行一些“免费”排序。

免费我的意思是客户端需要能够将一行向上或向下移动到他们想要的任何地方，跳过在服务器上完成的所有其他排序规则。

当然，这需要稍后保存到数据库中。

我想也许可以添加一个带有向上和向下箭头的列，当点击它时，它会将行移动到它需要的位置。

我在 JavaScript 方面不是最好的，而且我似乎在任何地方都找不到与此类似的任何示例。

关于我如何做到这一点的任何提示？还是有更好的选择？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T18:07:11.673

jqGrid 中内置了[Sortable Rows功能。](http://www.trirand.com/jqgridwiki/doku.php?id=wiki%3ajquery_ui_methods#sortable_rows)

您可以使用以下 API 调用对其进行设置：

```
jQuery("#yourgridid").jqGrid('sortableRows', options); 
```

它为此使用 jquery-ui 可排序小部件，因此可选选项参数可用于小部件的任何可用选项，您可以在[此处](http://jqueryui.com/demos/sortable/)找到。

例如：

```
jQuery("#yourgridid").jqGrid('sortableRows', { cursor: 'crosshair' }); 
```

[您可以在演示](http://www.trirand.com/blog/jqgrid/jqgrid.html)页面上看到一个示例。（版本 3.6 中的新功能 -> 可排序行）

# perl - 有没有办法打印两次但在每次打印调用之间休眠但都在同一行打印？

> ID：12095364
> 
> 赞同：2
> 
> 时间：2012-08-23T15:41:15.477
> 
> 标签：perl

我真的不知道如何表达这个问题，所以我将举例说明我正在尝试做的事情。

我有一个脚本，我需要在其中使用睡眠功能几秒钟。但在我去“睡觉”之前，我需要有一条消息说，例如“睡觉……”。但是在它完成睡眠后，我需要打印“完成”。所以终端窗口看起来会是这样的：`Sleeping... done`，这是我的代码：

```
#!/usr/bin/perl

print "Sleeping... ";
sleep(1);
print "done"; 
```

但发生的情况是，脚本休眠，然后`Sleeping... done`一次全部输出。

是否可以打印“Sleeping...”，然后实际进入“sleep”，最后打印“done”，但所有内容都在一行上？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-23T15:45:21.737

`$|`您可以通过设置为非零值来启用文件句柄上的自动刷新，例如：

```
local $| = 1; 
```

所以你的完整脚本将是：

```
#!/usr/bin/perl

use strict;
use warnings;

local $| = 1;

print "Sleeping... ";
sleep(1);
print "done"; 
```

`$|`您可以通过设置为将其关闭，`0`如果这只是较大脚本的一小部分，您应该这样做。默认情况下输出缓冲是有原因的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T15:47:55.117

采用

```
$| = 1 
```

禁用缓冲输出。然后您的脚本按预期工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T18:27:07.877

备择方案：

```
select()->autoflush();   # Same as:  $| = 1;
print "Sleeping... ";
sleep(1);
print "done\n";

print "Sleeping... ";
select()->flush();       # Same as:  my $saved = $|; $| = 1; $| = $saved;
sleep(1);
print "done\n"; 
```

（如果您不使用，则可以替换`select()`为。）`STDOUT``select()`

# c# - 如何将通用字典转换为其已知类型？

> ID：12095365
> 
> 赞同：2
> 
> 时间：2012-08-23T15:41:14.797
> 
> 标签：c#, reflection, casting

使用反射，我试图抓住一个类字段并填充它们。目前我让它检测一个实例`Dictionary<,>`并创建一个`Dictionary<object,object>`来填充。之后它尝试更改类型，但这不起作用并且无法转换：

```
// Looping through properties. Info is this isntance.
// Check is a dictionary field.
Dictionary<object, object> newDictionary = new Dictionary<object, object>();

// Populating the dictionary here from file.
Type[] args = info.PropertyType.GetGenericArguments();
info.GetSetMethod().Invoke(data, new object[]
    {
        newDictionary.ToDictionary(k => Convert.ChangeType(k.Key, args[0]),
                                   k => Convert.ChangeType(k.Value, args[1]))
    }); 
```

有任何想法吗？谢谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-23T15:46:22.377

您应该手动创建您找到的类型的字典。

```
Type dictionary = typeof(Dictionary<,>);
Type[] typeArgs = info.PropertyType.GetGenericArguments();

// Construct the type Dictionary<T1, T2>.
Type constructed = dictionary.MakeGenericType(typeArgs);
IDictionary newDictionary = (IDictionary)Activator.CreateInstance(constructed);

// Populating the dictionary here from file. insert only typed values below
newDictionary.Add(new object(), new object());

info.SetValue(data, newDictionary, null); 
```

反对者的证明。

```
 static void Main(string[] args)
    {
        IDictionary<int, string> test = new Dictionary<int, string>();
        var castedDictionary = (IDictionary)test;
        castedDictionary.Add(1, "hello");
        Console.Write(test.FirstOrDefault().Key);
        Console.Write(test.FirstOrDefault().Value);
        Console.ReadLine();
    } 
```

`Dictionary<TKey, TValue>`实现`IDictionary`，在我的示例中，我正在创建`Dictionary<TKey, TValue>` ( `Type dictionary = typeof(Dictionary<,>);`) 的实例。

```
public class Dictionary<TKey, TValue> : IDictionary<TKey, TValue>, 
    ICollection<KeyValuePair<TKey, TValue>>, IDictionary, ICollection, 
    IReadOnlyDictionary<TKey, TValue>, IReadOnlyCollection<KeyValuePair<TKey, TValue>>, 
    IEnumerable<KeyValuePair<TKey, TValue>>, IEnumerable, ISerializable, 
    IDeserializationCallback 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-01-14T01:28:03.837

可能已经晚了，但我确实遇到了这个问题。user854301 是绝对正确的。我需要它在运行时传递一个通用字典，我已经弄清楚了大部分，只是缺少 IDictionary。第一次没有用，因为我犯了和 Fyodor Soikin 一样的错误；寻找`IDictionary<T,U>`。然而，魔法在`System.Collections.IDictionary`而不是`System.Collections.Generic.IDictionary<>`

```
Type[] types = prop.PropertyType.GetGenericArguments();
Type dictType = typeof(Dictionary<,>).MakeGenericType(types);
IDictionary dict = (IDictionary)Activator.CreateInstance(dictType);
types.Dump();
dictType.GetGenericArguments().Dump();
dict.GetType().GetGenericArguments().Dump();
array.Split(';').ForEach(a =>
{
    dict.Add(MyFunctions.ChangeType(a.Split(',')[0], types[0]), MyFunctions.ChangeType(a.Split(',')[1], types[1]));
}); // List Items
dict.GetType().GetGenericArguments().Dump();
prop.SetValue(newT, dict); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-23T15:54:55.597

创建一个辅助泛型类，它可以执行您需要执行的任何操作并生成正确键入的结果。然后根据运行时已知的类型动态实例化该类。

```
interface IHelper
{
    object CreateDictionary ();
}

class Helper<TKey, TValue> : IHelper
{
    public object CreateDictionary ()
    {
        return (whatever).ToDictionary<TKey, TValue>( blah );
    } 
}

var h = Activator.CreateInstance( typeof( Helper<,> ).MakeGenericType( yourKnownKeyType, yourKnownValueType ) ) as IHelper;
info.SetValue( h.CreateDictionary() ); 
```

如果这种情况经常发生，您还应该缓存帮助程序实例以避免每次动态实例化的影响。

# c# - 如何设置 .NET win 应用程序控件大小属性以在不同系统上具有相同外观？

> ID：12095367
> 
> 赞同：1
> 
> 时间：2012-08-23T15:41:17.047
> 
> 标签：c#, .net, winforms, windows-applications

嗨，我开发了一个 Windows 窗体应用程序，我部署了它，并将它安装在另一个具有不同屏幕分辨率的系统上，并且我的一些控件看起来不像在我自己​​的系统上那样，例如我在 groupbox 和目标机器他们已经超出了分组框的边界！我想知道我应该如何准确地设置不同控件的不同尺寸属性，以便在具有不同分辨率和不同屏幕英寸的不同系统上具有相同的外观？！

提前感谢您的回复

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T12:38:02.040

我假设您使用的是 Windows Presentation Foundation (WPF)；如果是这样，您将需要在 GroupBox 控件内设置一个 Grid 。如果您习惯于 HTML，您可以将 Grid 视为类似于表格的东西。然后在网格中排列您的标签或其他控件。下面是一个示例，请务必注意边距标签。它们是控件在网格中的位置。

```
<GroupBox Header="groupBox1" Height="135" HorizontalAlignment="Left" Margin="12,78,0,0" Name="groupBox1" VerticalAlignment="Top" Width="287">
    <Grid>
        <Label Content="Label" Height="28" HorizontalAlignment="Left" Margin="45,28,0,0" Name="label1" VerticalAlignment="Top" />
    </Grid>
</GroupBox> 
```

要在 Windows 窗体中执行相同操作，您需要手动将控件添加到 GroupBox。

```
gbCtrl = new GroupBox();
gbCtrl.Left   = 20; // <- These are relative to the main form.
gbCtrl.Top    = 20;
gbCtrl.Width  = 120;
gbCtrl.Height = 60;
gbCtrl.Text = "Sample GroupBox";

Button btnSample = new Button();
btnSample .Left = 22; // <- These are relative to the groupbox
btnSample .Top  = 24; // 
gbCtrl.Controls.Add(btnSample); // <- Add the button to the groupbox

Controls.Add(gbCtrl); // <- Add the groupbox to the main form. 
```

# c# - 根据角色重定向用户？

> ID：12095372
> 
> 赞同：0
> 
> 时间：2012-08-23T15:41:28.707
> 
> 标签：c#, asp.net, web-config

嗨，我在为 Web 应用程序设置管理模块时遇到问题

1.  我的系统管理员和技术人员有两个角色

2.  如果转到管理员模块，系统将查看他是否是管理员

3.  如果用户不是管理员，则将他重定向到页面

    > 抱歉，您无权访问此页面！

我使用 Web.config 来限制对子目录 Admin 的访问

```
<?xml version="1.0"?>
<configuration>
    <system.web>
      <authorization>
        <allow roles="admin" />
        <deny users="*"/>
      </authorization>
    </system.web>
</configuration> 
```

我也有 C# 代码来检查登录用户是管理员还是其他

```
protected void Page_Load(object sender, EventArgs e)
    {
        if (HttpContext.Current.User.Identity.IsAuthenticated)
        {
            if (Page.User.IsInRole("admin"))
            {
                if (!Page.IsPostBack)
                {
                    DisplayRolesInGrid();
                }
            }
            if(!Page.User.IsInRole("admin"))
            {
                Response.Redirect("/accessPage.aspx");
            }

        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T15:53:08.247

不要将这两种类型的角色管理相互混淆。它们相互排斥。一个在 web.config 中，另一个在 C# 代码中。只需删除 web.config 访问部分并使用 codein Page_Load 功能，就像您已经完成的那样。

```
protected void Page_Load(object sender, EventArgs e)
{

        if (Page.User.IsInRole("admin"))
        {
            // all is good, do not do anything
            // if you want to initialized something, do it here
        }
        else
        {
            // opps you do not have access here, take him somewhere else
            Response.Redirect("/accessPage.aspx");
        }

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T15:46:17.183

不知道你的问题是什么，但我至少可以看到一个问题： `<deny users="*"/>`意味着拒绝所有人。应该将`<deny users="?" />`未经身份验证的人拒之门外，然后`<deny roles="Tech" />`确保不允许您的技术用户使用。

# java - e.printStackTrace 和 System.out.println(e) 的区别

> ID：12095378
> 
> 赞同：33
> 
> 时间：2012-08-23T15:41:41.467
> 
> 标签：java, exception, exception-handling

大概是个新手问题，不过好像大家都用过，但是我在异常处理的时候`e.printStackTrace()`一直用。`System.out.println(e)`有什么区别，为什么更`e.printStackTrace()`可取？

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2012-08-23T15:45:18.953

使用的输出流与@Brian 指出的不同，但详细程度也不相同 - 您可以尝试下面的简单测试。输出：

With `println`: 你只知道抛出了什么异常

> java.lang.UnsupportedOperationException：尚未实现

With `printStackTrace`: 你也知道是什么原因造成的*（行号 + 调用堆栈）*

> java.lang.UnsupportedOperationException：尚未
> 在 javaapplication27.Test1.test(Test1.java:27)
> 在 javaapplication27.Test1.main(Test1.java:19) 实现

```
public static void main(String[] args){
    try {
        test();
    } catch (UnsupportedOperationException e) {
        System.out.println(e);
        e.printStackTrace();
    }
}

private static void test() {
    throw new UnsupportedOperationException("Not yet implemented");
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-08-23T15:42:39.687

如果您使用`System.out.println`，那么您将错误转储到`stdout`，而不是`stderr`.

将错误转储为标准错误是传统的做法，因此您可以从错误输出中过滤正常的成功输出。这是命令行实用程序的常见做法，因此是一个好主意。

例如

```
myCommand 2> /tmp/errors > /tmp/results 
```

会将错误写入一个日志，并将结果写入另一个日志。根据您的 shell/调用过程等，您可以组合此信息、丢弃错误、如果抛出任何错误等做出反应等。有关更多信息，请参见[此处](http://en.wikipedia.org/wiki/Standard_streams)。

使用`printStackTrace()`是一个好主意，因为您正在倾倒发生异常的位置。这对于跟踪意外错误通常是无价的，因为它会为您提供一个直接（如果详细）指针，指向您遇到错误的确切位置。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-08-23T15:51:01.513

`System.out.println(e)`相当于`System.out.println(e.toString())`：`System.out`是一个PrintStream，`PrintStream.println(Object o)`调用`PrintStream.println(o.toString())`.

`e.toString()`返回类的名称和异常的 getLocalizedMessage()。

`e.printStackTrace()`将该信息写入 System.err（不是 System.out）以及*堆栈*跟踪，即导致异常的方法链。这是有用的信息。

我经常认为，如果有一种方法可以返回包含由`e.printStackTrace()`. 由于您不必使用`e.getStackTrace()`和编写自己的例程来输出 StackTraceElements 的结果数组。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2018-01-16T12:56:19.577

由于`e.printStackTrace();`is的输出`System.err`并且通常我将我的应用程序日志输出到文件中，因此我建议您同时使用`System.err`并`System.out`输出错误。

```
public static void log(Exception e) {
    e.printStackTrace(); // This goes to System.err
    e.printStackTrace(System.out);
} 
```

通过这种方式，您可以在日志文件（如果有的话）和控制台中看到错误。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-23T15:47:32.117

`System.out.println(e)`不会给你你的堆栈跟踪，只是错误消息和异常类型，以及打印到标准输出而不是错误输出。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-07-25T07:31:49.947

> **波纹管程序显示差异细节**
> 
> **System.out.println(e); :-** 只显示异常。egjava.lang.ArithmeticException: / 为零 **e.printStackTrace(); :-** 显示异常的详细信息以及在程序中导致异常的位置，例如 java.lang.ArithmeticException: / 在 test.Test.main(Test.java:7) 处为零

```
package test;

public class Test {

    public static void main(String args[]) {
        try {
            System.out.println(12 / 0);

        } catch (Exception e) {
            System.out.println(e);
            e.printStackTrace();
        }

    }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-09-04T13:31:12.160

`System.out.println(e)`你只需要知道抛出了什么异常，但你会得到关于`e.printStackTrace()`抛出什么异常以及导致它的原因的信息。

# c# - 外部表不是仅在某些情况下抛出的预期格式

> ID：12095379
> 
> 赞同：0
> 
> 时间：2012-08-23T15:41:42.313
> 
> 标签：c#

我正在尝试打开一个 xlsx 文件，但只有当我从应用程序的某个区域打开时，我才得到外部表不是预期的格式。因此，如果我从 1 个区域调用它，它工作得很好，但是我从应用程序的不同部分执行相同的操作，调用相同的代码块，它会引发该异常。相同的代码块。同一个excel文件。

```
string connectionString = "Provider="+ GetProvider(fileName) +"; data source=" + fileName + "; " + GetExtendedProperties(fileName);

                using (var connection = new OleDbConnection(connectionString))
                {
                    connection.Open();

                    using (DataTable schemaTable = connection.GetOleDbSchemaTable(OleDbSchemaGuid.Tables,
                                                                                  new object[] { null, null, null, "TABLE" }))
                    {
                        if (schemaTable != null && schemaTable.Rows != null)
                        {
                            List<string> validTables = schemaTable.Rows.OfType<DataRow>().Select(row => (string)row["TABLE_NAME"]).ToList();

                            validTables.ForEach(table =>
                            {
                                if (table.Contains('$'))
                                {
                                    results.WorkSheets.Add(table.Trim('\'', '$'));
                                }
                                else
                                {
                                    results.NamedRanges.Add(table);
                                }
                            });
                        }
                    }
                } 
```

我的连接字符串：

提供者=Microsoft.ACE.OLEDB.12.0；数据源=C:\moses\BLANKTest\Table.xlsx；扩展属性="Excel 12.0 Xml";

还尝试了在末尾取出“Xml”的连接字符串。没运气。

不知道这里发生了什么。

# php - 我的 php 文件中包含的 jquery 文件在服务器上不起作用

> ID：12095385
> 
> 赞同：-4
> 
> 时间：2012-08-23T15:42:07.143
> 
> 标签：php, javascript, jquery, html

我已经包括在内`jquery.js`，`jscript.js`它在本地工作正常
但是当我上传时`jscript.js`没有运行
jscript.js 只有一行是

```
$().ready(function(){
 alert (9);
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T15:49:08.370

首先将 $().ready 更改为 $(document).ready 然后接下来要检查的是：

1.  您是否在加载 jscript.js 之前包含了 jquery 库？
2.  您是否在 HTML 页面中包含 jscript.js？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T17:46:12.390

问题通过更换解决

```
<script src="folderOnMyPc/local/jquery.js"> 
```

和

```
<script src="http://code.jquery.com/jquery-latest.min.js"> 
```

# mysql - 在rails 3中查找相对于mysql数据库中字段的数据库条目的顺序或等级

> ID：12095391
> 
> 赞同：0
> 
> 时间：2012-08-23T15:42:30.350
> 
> 标签：mysql, ruby-on-rails

我有一个表格，可以将我的用户与他们已支付的款项和他们的价值观联系起来。

我需要能够找到用户付款的排名。这就是说：

```
Find Users payment -> Order Payments by value descending -> Return row position of users payment. 
```

或者：

```
User pays $10

There are three people who have paid more than $10

Return 4 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T15:52:49.277

我不确定是否有办法通过 Arel 界面实现这一点，但你可以做这样的事情（假设你的用户被加载到`@user`）

```
idx = nil
Payment.order("value desc").each_with_index do |payment, index|
  if payment.user_id == @user.id
    idx = index
    break
  end
end 
```

虽然您可以查询少于支付金额的所有支付记录`@user`以获得一个数字，但它不会考虑支付相同金额的记录，因为您不知道支付相同金额的用户哪个先出现。

# javascript - 记住在 Kendo-UI 中刷新时扩展的细节网格

> ID：12095392
> 
> 赞同：2
> 
> 时间：2012-08-23T15:42:33.250
> 
> 标签：javascript, jquery, kendo-ui

我有一个使用 detailInit 方法实现的网格内网格场景。在这里，当用户进行编辑时，我会进行一些计算，这些计算会更改父子节点中的数据。然后刷新数据，我将调用 datasource.read 来呈现数据。这有效并且显示了数据，但是任何展开的细节网格都会被折叠，有什么办法可以防止这种情况发生。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-02-19T17:57:28.307

要回答这个问题和另一个问题：

“我想出了如何从子节点设置主数据，但是，当更新任何内容时，整个表都会折叠子网格，这是一个非常烦人的行为，无论如何我可以只更新主表中的字段而无需它折叠了所有子元素？（基本上，更新列，没有更新表）“

在另一个线程中：[telerik](http://www.telerik.com/forums/hierarchy-grids-have-the-change-function-in-the-detailed%28sub%29-grid-update-a-column-on-the-main-table- "泰利里克")

这是 Kendo Grid 极其烦人的行为，也是一个重大错误。从什么时候开始有人希望子网格消失并隐藏刚刚进行的更改！但这不是唯一的问题。change 函数被调用斐波那契数次，这将在大量点击后冻结浏览器。话虽如此，这是我提出的解决方案：

在主网格中

```
 $('#' + grid_id).kendoGrid({
     width: 800, 
     ...
     detailExpand: function (e) {
         var grid = $('#' + grid_id).data("kendoGrid");
         var selItem = grid.select();
         var eid = $(selItem).closest("tr.k-master-row").attr('data-uid')
         if (contains(expandedItemIDs, eid) == false)
              expandedItemIDs.push(eid);
 },
 detailCollapse: function (e) {
    var grid = $('#' + grid_id).data("kendoGrid");
    var selItem = grid.select();
    var eid = $(selItem).closest("tr.k-master-row").attr('data-uid')
    for (var i = 0; i < expandedItemIDs.length; i++)
        if (expandedItemIDs[i] == eid) 
            gridDataMap.expandedItemIDs.splice(i, 1);
}, 
```

不幸的是，在全球范围内，我们有：

```
function subgridChange() {
      var grid = $('#' + grid_id).data("kendoGrid");
      for (var i = 0; i < expandedItemIDs.length; i++)
       grid.expandRow("tr[data-uid='" + expandedItemIDs[i] + "']");
}
function contains(a, obj) {
   for (var i = 0; i < a.length; i++) 
       if (a[i] === obj)  return true;
   return false;
}
expandedItemIDs = []; 
```

现在每次对子网格进行更改时都需要调用“subgridChange()”函数。

问题是子网格中的更改函数被调用的次数在每次更改调用时呈指数增长。Kendo 网格应该能够调用停止传播函数来防止这种情况发生，或者至少让程序员可以访问事件对象，以便程序员可以防止传播。在完全恼火之后，我们要做的就是将 'subgridChange()' 函数放在子网格 'datasource' 中，如下所示：

```
dataSource: function (e) {
    var ds = new kendo.data.DataSource({
        ...
        create: false,
        schema: {
            model: {
                ...
            }
        },

        change: function (e) {
            subgridChange();
        }
    });
    return ds;
} 
```

我还必须使用类似这样的东西将“subgridChange()”函数放在“添加”按钮函数中

```
$('<div id="' + gridID + '" data-bind="source: prodRegs" />').appendTo(e.detailCell).kendoGrid({
      selectable: true,
      ...
      toolbar: [{ template: "<a class='k-button addBtn' href='javascript://'><span class='k-icon  k-add' ></span> Add Product and Region</a>" }]
});

$('.addBtn').click(function (event) {
    ...
    subgridChange();
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-28T02:10:38.477

当用户选择一行时，记录所选行的索引。然后在您的数据刷新后，使用以下代码展开一行

```
// get a reference to the grid widget
var grid = $("#grid").data("kendoGrid");
// expands first master row
grid.expandRow(grid.tbody.find(">tr.k-master-row:nth-child(1)")); 
```

要展开不同的行，只需将`nth-child()`选择器中的数字更改为要展开的行的索引。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-19T19:08:27.457

实际上，所需要的只是主网格“dataBound”函数中的“subgridChange()”函数：

```
 $('#' + grid_id).kendoGrid({
      ...
      dataBound: function (e) {
          gridDataMap.subgridChange();
      }
  }); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-12-05T12:19:07.730

我用于相同问题的不同但相似的解决方案：

```
 expandedItemIDs = [];

            function onDataBound() {
        //expand rows
                    for (var i = 0; i < expandedItemIDs.length; i++) {
                        var row = $(this.tbody).find("tr.k-master-row:eq(" + expandedItemIDs[i] + ")");
                        this.expandRow(row);
                    }
                }

        function onDetailExpand(e) {
            //refresh the child grid when click expand
            var grid = e.detailRow.find("[data-role=grid]").data("kendoGrid");
            grid.dataSource.read();
            //get index of expanded row       
            $(e.detailCell).text("inner content");
            var row = $(e.masterRow).index(".k-master-row");
            if (contains(expandedItemIDs, row) == false)
                expandedItemIDs.push(row);
        }

        function onDetailCollapse(e) {
    //on collapse minus this row from array
            $(e.detailCell).text("inner content");
            var row = $(e.masterRow).index(".k-master-row");
            for (var i = 0; i < expandedItemIDs.length; i++)
                if (expandedItemIDs[i] == row)
                    expandedItemIDs.splice(i, 1);
        }

        function contains(a, obj) {
            for (var i = 0; i < a.length; i++)
                if (a[i] === obj) return true;
            return false;
        } 
```

# linq - 如何更有效地重写它（linq with split）？

> ID：12095396
> 
> 赞同：1
> 
> 时间：2012-08-23T15:42:49.577
> 
> 标签：linq, simplify

问题是：我有一个专栏，主题格式为：“波士顿 | 纽约 | 芝加哥”。记录中的名称可以不同，主题的数量也可以不同。我需要想出的是用这些名字的数量来收集相同的名字。

这就是我所做的：

```
 var splitted = queryResult.Select(x => x.TopicData);
 List<string> lstOfTopics = new List<string>();
 foreach (var element in splitted)
 {
   string[] splitedTopics = element.Split('|');
   lstOfTopics.AddRange(splitedTopics);
 }
var groupedTopics = lstOfTopics.GroupBy(x => x).Select(group => new {key = group.Key, count = group.Count()}).AsEnumerable(); 
```

一个简单的任务似乎有很多代码。任何想法如何简化这个？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T15:45:40.820

`SelectMany`您可以使用and构造列表`ToList`：

```
List<string> lstOfTopics = splitted.SelectMany(x => x.Split('|')).ToList(); 
```

您也可以完全省略列表的构建：

```
var groupedTopics = queryResult
    .SelectMany(x => x.TopicData.Split('|'))
    .GroupBy(x => x)
    .Select(group => new { group.Key, Count = group.Count()}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T15:47:07.450

```
var groups = queryResult
  .SelectMany(t => t.TopicData.Split('|')
  .GroupBy(n => n)
  .Select(g => new { Key = g.Key, Count = g.Count() }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-24T22:12:49.740

查询语法可以很好且紧凑：

```
var topics =
    from qr in queryResult
    from topic in qr.TopicData.Split('|')
    group topic by topic into g
    select new { Topic = g.Key, Count = g.Count() }; 
```

如果您只想要独特的主题，而不是它们的数量......

```
List<string> topicList = topics.Select(item => item.Topic); 
```

# checkout - 结帐时的产品选项

> ID：12095398
> 
> 赞同：0
> 
> 时间：2012-08-23T15:42:51.463
> 
> 标签：checkout, options, prestashop

本质上，我正在寻找一个模块，该模块允许我为结帐期间显示的某些产品添加选项，并且可以在需要时进行选择。

例如，如果我们正在与一个卖鞋的网站打交道，并且客户在他们的购物车中添加了一双靴子和一些高跟鞋，当查看他们的购物车摘要时，靴子下应该有一个“靴子弄脏”服务的选项，它可以为该产品增加额外费用。

如果有 3 只靴子和 2 双鞋跟，则 3 只靴子各自都有自己的“靴子弄脏”复选框，因此如果需要，客户可以让 2 双干净的和弄脏的。每个选项都应该增加相同的费用，所以如果一个靴子是 5 英镑，那么三个靴子都是 15 英镑。

由于这是一项服务，因此应与库存无关，并且仅适用于选定类别中的产品。

有谁知道允许这样做的模块，或者开发一个模块会有多困难？

如果这并不容易，有没有办法在产品中添加一个复选框以在产品页面（而不是结帐）上允许此功能。我已经研究过使用组合，但是因为我将它用于具有备用库存水平（并且可能有单独价格）的尺寸，所以这不起作用，因为它是一项服务并且没有库存水平。

也许这可以使用包系统？- 如果包可以由用户定制。

任何信息都将受到高度赞赏，因为我是 Prestashop 的新手，找不到任何符合要求的东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T17:24:18.083

看看[这里](http://www.presto-changeo.com/en/attribute-modules/34-attribute-wizard-pro.html)，希望对你有帮助！

> 为每个产品创建无限数量的属性，并将它们显示为单选按钮、复选框、下拉菜单、文本框、文本区域和文件上传。

# matlab - MATLAB GUI 指南错误与地图

> ID：12095402
> 
> 赞同：0
> 
> 时间：2012-08-23T15:43:05.483
> 
> 标签：matlab, user-interface, matlab-guide

我正在尝试将地图插入 MATLAB 的 GUI GUIDE，但出现错误：

> 评估 uicontrol 回调时出错

当我在命令窗口中独立运行地图时，地图确实可以工作，但是当我在 GUIDE 中按下按钮时，它会出现然后被扭曲，然后我得到一个错误。

这是我的代码：

```
function temp_button_Callback(hObject,eventdata,handles)
lat = [80 45 52; 45 46 34]
long = [123 132 123; 120 122 119]
temp = [67 68 69; 71 72 73]

axesm('mercator','MapLatLimit',[-50 90],'MapLonLimit',[0 250])
framem on; gridm on;
load coast;
mlabel on;
plabel on;
plotm(lat,long,'k')

contourfm(long,lat,temp) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T15:47:45.593

你以前做`clear lat long;`对了`contourfm(long,lat,temp)`。显然你仍然需要这些变量，所以不要清除它们。

# perl - 仅当使用 perl 的文件中存在另一个字符串时才搜索字符串

> ID：12095405
> 
> 赞同：0
> 
> 时间：2012-08-23T15:43:11.007
> 
> 标签：perl, file, search

## 背景：

我有一个名为 Component 的 Java 类，其中有一个名为 getProperty 的方法。在我的源代码管理中，还有许多其他 Java 类实例化了这个 Component 类并在该对象上调用 getProperty 方法。我想对此 getProperty 方法进行修改，因此想分析谁都受到了影响。

## 要求：

我想搜索所有 *.java 文件（根据包名分布在多个目录中）。问题是 getProperty 方法不仅在 Component 类上可用，而且在许多其他类上可用，例如 System.getProperty 或 Event.getProperty。因此，我使用 grep 的搜索结果返回了混合结果。现在我必须扫描每个搜索结果以查找其中哪些与我相关（即它们是 Component.getProperty 方法的调用者）。

一件事是肯定的，如果有人要调用 Component.getProperty 方法，他们会确保他们显式地导入 Component 类。IE。导入 com.abc.xyz.alpha.Component；

所以我的搜索算法的方向是，如果文件有一个字符串“import com.abc.xyz.alpha.Component;” 然后只在该文件中查找 getProperty 字符串。如果该文件没有 import 语句，则跳过该文件并继续下一个文件。

我需要帮助用 perl 编写这个搜索。有人可以帮忙吗？

感谢您阅读这篇长文。谢谢你的时间。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T16:15:15.710

粗略地说，

```
fgrep -l 'import com.abc.xyz.alpha.Component;' *.java |
xargs fgrep getProperty 
```

或者在 Perl 中，

```
perl -0777ne 'print map { "$ARGV:$_\n" } grep { m/getProperty/ } split ("\n")
    if m/import com\.abc\.xyz\.alpha\.Component;/' *.java 
```

# c# - c++方法从c#dllimport调用返回0

> ID：12095406
> 
> 赞同：0
> 
> 时间：2012-08-23T15:43:20.250
> 
> 标签：c#, c++, reference, return-value, dllimport

我正在调用函数，我得到的只是 0，这是已使用多年的第 3 方软件，所以我知道它是正确的。这是C++头文件：

```
#ifdef __cplusplus
extern "C" {
#endif
int __stdcall initialise();
int __stdcall closedown();
int __stdcall WGS84ToLocal(double * lat, double * longt, int d);
int __stdcall LocalToWGS84(double * lat, double * longt, int d);
int __stdcall OSGB36ToOSGBGrid(double lat, double longt, double * east, double * north);
int __stdcall OSGBGridToOSGB36(double east, double north, double * lat, double * longt); 
```

这是我的代码

```
 class Program
{
    public static double lon = 50.82011492;
    public static double lat = 0.117981131;
    public static double north = 50.82011492;
    public static double east = 0.117981131;
    public static Int32 OGB_M = 150;
    public static int iErr = 0;

    [DllImport("TTDatum3.Dll", EntryPoint = "WGS84ToLocal", CallingConvention = CallingConvention.StdCall, SetLastError = true)]
    public static extern Int32 WGS84ToLocal([In, Out]ref double lat, [In, Out] ref double lon, Int32 datum);

    [DllImport("TTDatum3.Dll", EntryPoint="LocalToWGS84", CallingConvention = CallingConvention.StdCall, SetLastError = true)]
    public static extern Int32 LocalToWGS84([In,Out]ref double lat,[In,Out] ref double lon, Int32 datum);

    [DllImport("TTDatum3.Dll", EntryPoint = "OSGB36ToOSGBGrid", CallingConvention = CallingConvention.StdCall, SetLastError = true)]
    public static extern Int32 OSGB36ToOSGBGrid( double lat, double lon, [In,Out] ref double east, [In,Out] ref double north);

    [DllImport("TTDatum3.Dll", EntryPoint = "OSGBGridToOSGB36", CallingConvention = CallingConvention.StdCall, SetLastError = true)]
    public static extern Int32 OSGBGridToOSGB36(double east, double north, [In,Out] ref double lat,[In,Out]  ref double lon);

    public static void Main(string[] args)
    {

       iErr = OSGBGridToOSGB36(east, north, ref lon, ref lat);
       Console.WriteLine(iErr);
       iErr = LocalToWGS84(ref lon, ref lat, OGB_M);
       Console.WriteLine(iErr);

    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T15:49:15.603

您的 Main 与上述方法的 lat 和 lon 的顺序相反。不知道这是否是您的问题的原因，但它是 1 个输入。

您期望 iErr 会返回什么？请修复该部分，然后提供更新。

# javascript - 改变 在 textarea 更新时阻止内容

> ID：12095409
> 
> 赞同：1
> 
> 时间：2012-08-23T15:43:28.480
> 
> 标签：javascript, html

我正在尝试获取`<pre>...</pre>`要由 JavaScript 呈现的标签之间的内容，其中内容是动态的。我希望做的是在文本区域中输入一个输入来更新`<pre>`标签中的显示。

我不确定如何指定`<pre>`标签中的内容以在每次 textarea 更新时从 textarea 获取值。

非常感谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-23T15:50:41.970

查看您正在使用的代码会有很大帮助，但如果我阅读正确，这应该会有所帮助。假设 HTML 是这样的：

```
<textarea id="type"></textarea>
<pre id="output"></pre> 
```

此选项使用纯 javascript：

```
var textarea = document.getElementById('type'),
    pre = document.getElementById('output');

if(textarea.addEventListener) {
    textarea.addEventListener('keyup',function(){
        pre.textContent = this.value;
    });
} else {
    textarea.attachEvent('onkeyup',function(){
        pre.textContent = this.value;
    });
} 
```

为简洁起见，此代码块使用 jQuery 库：

```
$('#type').on('keyup',function(){
    $('#output').text($(this).val());
}); 
```

请注意，在这两种情况下，我都在设置 的*文本*，而`<pre>`不是 HTML。这允许您在 textarea 中输入 HTML 字符，并让它们在您的元素`<`中正确转义。`<pre>`

[**纯 JavaScript 演示**](http://jsfiddle.net/jackwanders/UmM5Q/)

[**jQuery 演示**](http://jsfiddle.net/jackwanders/nepwd/)

如果您不想`<pre>`在离开 之前`<textarea>`更改 ，那么只需分别更改`'keyup'`和`'onkeyup'`至`'change'`和`'onchange'`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T15:48:03.190

[`onchange`](http://www.w3schools.com/jsref/event_onchange.asp)将事件绑定到`input`，然后简单地将其值复制到`pre`：

```
<pre id="pre">Type something</pre>
<textarea id="text" rows="20" cols="20" />
​
<script type="text/javascript">
document.getElementById("text").onchange = function () {
  document.getElementById("pre").innerHTML = this.value;  
};
</script> 
```

**[演示](http://jsfiddle.net/mMQEe/1/)**。​</p>

# mysql - 如何从mysql中的字符串中捕获文本？

> ID：12095411
> 
> 赞同：0
> 
> 时间：2012-08-23T15:43:38.680
> 
> 标签：mysql, sql, count

在这里，我试图在**Comment 列**中获取字符串的中间值（ **log in** ），然后获取每个用户的计数。但我认为这不是正确的做法。你们还有什么办法吗……！

 **```
user#   user ID Comments
101     user 1  ***log in*** : shera
101     user 1  ***log in*** : Mark
102     user 2  ***log out***
105     user 5  ***log in*** : Mark
104     user 4  ***ideal***
103     user 3  ***ideal***
101     user 1  ***ideal***
102     user 2  ***log out*** : since 5 mnt
105     user 5  ***log in*** : Mark
104     user 4  ***ideal***
103     user 3  ***log out*** 
```

查询需要设计用于：

```
 log in ideal   log out
user 1    2       0        3
user 2    0       2        5
user 5    0       2        1
          ------------------
Total      2      4        9 
```

谢谢考虑。周杰伦

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T15:52:12.663

不确定这是最优化的方式，但如果您的表名是`comments`（或根据需要在下面调整）：

```
SELECT user, IFNULL(login,0) as login, IFNULL(ideal,0) as ideal,
       IFNULL(logout,0) as logout
FROM (
 SELECT userid, user
 FROM comments
 GROUP BY userid
) c
LEFT JOIN (
 SELECT userid, count(userid) AS login
 FROM comments
 WHERE comment LIKE '%log in%'
 GROUP BY userid
) c1 ON c.userid=c1.userid
LEFT JOIN (
 SELECT userid, count(userid) AS logout
 FROM comments
 WHERE comment LIKE '%log out%'
 GROUP BY userid
) c2 ON c.userid=c2.userid
LEFT JOIN (
 SELECT userid, count(userid) AS ideal
 FROM comments
 WHERE comment LIKE '%ideal%'
 GROUP BY userid
) c3 ON c.userid=c3.userid 
```**

# c# - 如何将数据绑定到嵌套的 DevExpress GridView 控件？

> ID：12095420
> 
> 赞同：0
> 
> 时间：2012-08-23T15:44:02.827
> 
> 标签：c#, asp.net, devexpress, aspxgridview

我是 DevExpress 控件的新手，并且遇到了主从网格视图的问题。

我正在使用 DXperience-11.2。

通过执行以下操作，我可以轻松地将对象绑定到父 GridView：

```
var myObject = myObject.Retrieve(id);

parentGridView.DataSource = myObject;
parentGridView.DataBind(); 
```

我很难绑定到嵌套的子 GridView。我正在使用以下代码（正如我之前多次使用嵌套 asp:Repeaters 一样），但生成的 var childGrid 对象始终为空。

```
var childGrid = (ASPxGridView)parentGridView.FindControl("childGridView");

var myObject2 = myObject2.Retrieve(id);

childGrid.DataSource = myObject2;
childGrid .DataBind(); 
```

任何帮助将不胜感激。

问候克里斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T16:29:33.550

好的，感谢您提出的建议，但我设法提出了解决方案。

我将以下事件添加到父gridview ...

```
OnBeforePerformDataSelect="detailGrid_DataSelect" 
```

当您单击父网格视图中的一行时会触发此事件。父 gridview 行展开并且事件触发。

然后在我后面的代码中我做了以下代码......

```
 protected void detailGrid_DataSelect(object sender, EventArgs e)
    {
        var myObject2 = myObject2.Retrieve(id);

        ASPxGridView grid = (sender as ASPxGridView);
        grid.DataSource = myObject2;
    } 
```

首先，我检索了我想绑定到嵌套/子 GridView 的对象。然后将对象发送者转换为 ASPxGridView 对象并绑定我检索到的数据对象。

我出错了，因为我试图在此事件中使用 .FindControl 方法查找嵌套的 GridView 控件，而对象发送者实际上是嵌套的 GridView 对象。

希望这对和我一样泡菜的人有所帮助！

克里斯

# java - Java swt canvas 绘制监听器是如何工作的？

> ID：12095428
> 
> 赞同：2
> 
> 时间：2012-08-23T15:44:22.453
> 
> 标签：java, canvas, swt, 2d

我刚刚开始使用 swt 的画布。我的印象是，来自图形控制器 (gc) 的绘制命令可以在任何连接到画布的侦听器中执行。不过我想，我的问题是什么触发了绘画侦听器方法`paintControl`？

这是否`canvas.redraw()`也会导致它运行？

感谢任何可以为我指明正确方向的人。如果有关于此事的教程或书籍我可以阅读（一般也可以在 swt 中进行二维绘图），我很想听听它们。

**编辑：** 这是代码，我遇到了一个问题，即 graphCanvas 没有填充多余的垂直空间？当我让它填充多余的水平空间时它也不起作用。但是当我将这些属性应用于复合材料时，它似乎起作用了。任何的想法？

```
Color black = Display.getCurrent().getSystemColor(SWT.COLOR_BLACK);
    chartComposite = new Composite(parent, SWT.NONE);
    GridLayout chartGridLayout = new GridLayout(1,false);
    GridData chartGridData = new GridData();
    chartGridData.grabExcessHorizontalSpace = true;
    chartGridData.grabExcessVerticalSpace = true;

    chartComposite.setLayout(chartGridLayout);
    chartComposite.setLayoutData(chartGridData);

    chartInnerComposite = new Composite(chartComposite, SWT.NONE);
    GridLayout chartInnerGridLayout = new GridLayout(2,false);
    GridData chartInnerGridData = new GridData();
    chartInnerGridData.grabExcessHorizontalSpace = true;
    chartInnerGridData.grabExcessVerticalSpace = true;
    chartInnerComposite.setLayout(chartInnerGridLayout);
    chartInnerComposite.setLayoutData(chartInnerGridData);
    /**
     * Create the four canvases
     */

    Canvas yCanvas = new Canvas(chartInnerComposite, SWT.None);
    graphCanvas = new Canvas(chartInnerComposite, SWT.None);
    GridLayout graphGridLayout = new GridLayout(1, false);
    graphGridLayout.makeColumnsEqualWidth = false;
    GridData graphGridData = new GridData(SWT.FILL);
    graphGridData.widthHint = 400;
    graphGridData.grabExcessVerticalSpace = true;
    graphCanvas.setLayout(graphGridLayout);
    graphCanvas.setLayoutData(graphGridData);
    graphCanvas.addPaintListener(new PaintListener() {

        @Override
        public void paintControl(PaintEvent e) {
            e.gc.drawLine(20, 20, 500, 500);
            e.gc.drawRectangle(0, 0, graphCanvas.getSize().x -1, graphCanvas.getSize().y -1);

            e.gc.drawLine(0, 40, 500, 500);
            e.gc.drawLine(0, 0, 0, 1200);
            e.gc.drawLine(0, 0, 1200, 0);               
        }
    });
    /*graphCanvas.setSize(400, 400);
    graphCanvas.redraw();
    graphCanvas.update();*/

    Canvas filler = new Canvas(chartInnerComposite, SWT.NONE);
    Canvas xCanvas = new Canvas(chartInnerComposite, SWT.None); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T15:50:33.310

您的代码绝对可以手动调用 canvas.redraw()，然后触发一个paintControl 事件。SWT 本身也会根据需要触发重绘，例如调整窗口大小以及当画布被其他窗口遮挡/不遮挡时。

# php - 对对象使用 PHP SESSION

> ID：12095430
> 
> 赞同：2
> 
> 时间：2012-08-23T15:44:24.953
> 
> 标签：php, codeigniter, session, logic

我可以选择在我的 Web 项目上创建新合同。

创建新合同由以下文件组成（注意法语）：

*   Coordonnees 客户
*   Fiche Découverte
*   合同
*   分类客户端
*   捕食者
*   就地计划
*   CCI
*   Enquête financière

    **保存按钮**

所以我有一个主创建页面，用户可以在其中单击这些文档之一，填写所有字段并返回此屏幕。我目前的解决方案是在 PHP 会话中存储一个大对象（存储所有文档数据），并将用户所做的每次修改附加到它上面。

例如，如果用户转到第一个文档，写一些东西然后返回到主面板，则数据将保存在会话中。当他单击时`SAVE BUTTON`，会话中的所有内容都存储在一个复杂的数据库模式中。

如果在合约不完整时点击保存（它至少缺少一个文档，大对象存储在 MongoDB 中，稍后恢复。

1.  我所做的一切都被认为是好的做法吗？
2.  我不应该在 SESSION 上休息吗？（目前我没有任何问题。对象大小约为 5kb）
3.  我还应该使用 Mongo 来存储中间数据吗？

Ps：这是一个内部项目，所以安全永远不会成为问题。问题将是数据的一致性和质量。

另请注意，自定义对象无需强制转换即可从会话中保存和恢复。至于 mongo，我必须转换每个组件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T07:53:47.710

在我看来，我在使用非关系数据库方面几乎是个菜鸟。我找到的解决方案很简单：

我没有像下面那样插入 MongoDB，然后在从数据库中选择时使用复杂的强制转换，而是序列化了对象

前：

```
 //convert big object to array to store in MongoDB
    $this->mongo_db->insert('contrats', (array)$contrat); 
```

后：

```
 $data=Array();
   $data['identifier']='123' //set an id so I can query by
   $data['contract']=serialize($contract);
   $this->mongo_db->insert('contrats',$data); 
```

并且数据恢复非常容易——`unserialize($row->contract)`返回我需要的对象。

这样在 Mongo 中存储临时数据变得很容易，我只需要设置一个标识符来查找合约并序列化大对象。

# android - 景观布局有困难

> ID：12095431
> 
> 赞同：1
> 
> 时间：2012-08-23T15:44:26.047
> 
> 标签：android, orientation

虽然我创建了一个`layout-land`文件夹，但当方向更改为横向时，我的应用程序仍显示纵向布局。

我的问题在于我最初`Activity`的问题，其他活动似乎在横向模式下运行良好。

我的清单如下：

```
<uses-sdk android:minSdkVersion="7" android:targetSdkVersion="14" />
<uses-permission android:name="android.permission.ACCESS_FINE_LOCATION" />
<uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION" />
<uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />
<uses-permission android:name="android.permission.INTERNET" />
<supports-screens
    android:anyDensity="true"
    android:largeScreens="true"
    android:normalScreens="true"
    android:smallScreens="true" />

<application
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name"
    android:theme="@android:style/Theme.Black.NoTitleBar"> 

    <activity
        android:configChanges="keyboardHidden|orientation"
        android:label="@string/app_name" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>

     <activity 
         android:configChanges="keyboardHidden|orientation"></activity>
     <activity
         android:configChanges="keyboardHidden|orientation"></activity>
     <activity 
         android:configChanges="keyboardHidden|orientation"></activity>
    <activity 
         android:configChanges="keyboardHidden|orientation"></activity>      
         <activity 
         android:configChanges="keyboardHidden|orientation"></activity> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T15:54:32.340

You'll need to remove the attribute `android:configChanges` from your manifest for the activities that you want to respond to the layout files in your `layout-land` folder.

When you specify `android:configChanges="orientation"` (along with the keyboard events), you're telling Android that you the developer are going to handle the orientation changes, and the system should **not** destroy and recreate the Activity.

This behavior is contrary to the default, which is to destroy an Activity, and recreate it with proper resources according to the current orientation.

# jquery - JQuery Slider 忽略滑动/更改事件

> ID：12095434
> 
> 赞同：0
> 
> 时间：2012-08-23T15:44:34.960
> 
> 标签：jquery, jquery-slider

我有一个函数，它在滑块的滑动/更改事件上被调用。当我的滑块逐渐更改时，一切正常，但是当滑块的句柄急剧移动时，处理函数不会被执行，但句柄仍然会移动。我知道同步处理会杀死，有没有办法改善这种行为？

请不要索要样品，你要么知道我在说什么，要么不知道。谢谢。

更新 1

Just to add some more details - In my slider change function I'm updating canvas, not the lightest call exactly. The only thing I can think of is to use timer and check if the actual handle position matches the last call, which is a big mess.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T15:48:25.673

那么，以优雅的方式禁止急剧移动怎么样？真的有必要采取猛烈的行动吗？

# java - 如何在不必维护每个文件的两个版本的情况下将通用 JavaScript 和图像部署到两个不同的 EAR

> ID：12095435
> 
> 赞同：1
> 
> 时间：2012-08-23T15:44:35.920
> 
> 标签：java, javascript, deployment, ear

我有一个 Struts Web 应用程序部署到一个 EAR 上，它有一些相当广泛的 JavaScript。我现在需要创建一个将部署到新 EAR 的新 Web 应用程序，但可能需要共享大部分（如果不是全部）JavaScript 和来自第一个应用程序的一些图像。避免代码重复的最佳方法是什么，这样我就不必在我的开发环境中的每个 EAR 中放置每个 JavaScript 文件的副本？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-23T15:49:13.897

您可以在单独的 .jar 库中维护 Javascript，并将其作为资源而不是静态文件提供。这样，JS 内容将成为您项目设置中的常规依赖项。不幸的是，没有一种简单的通用方法可以做到这一点，因为您至少需要一个 servlet 来从 .jar 发送文件。（根据您的 Web 框架，您可能已经拥有此功能。）

这也有一些性能影响，但对于业务线应用程序，您可能不需要大量优化内部 Javascript 的加载时间。

另一种选择是在源代码控制级别执行此操作，使用[Git submodules](http://git-scm.com/book/en/Git-Tools-Submodules)之类的东西。

# entity-framework - 将 EF Code First 映射到现有数据库

> ID：12095436
> 
> 赞同：0
> 
> 时间：2012-08-23T15:44:38.417
> 
> 标签：entity-framework, ef-code-first

首先让我为冗长的帖子道歉。我认为提供更多详细信息将有助于您了解情况。

我正在尝试使用 EF 5 Code First 开发我的应用程序的数据层，并将所有内容映射到现有数据库。我想使用 DbContext、POCO、流利的表映射等，但我们现有的数据库（表）不是直截了当的。所以，我在一些事情上遇到了麻烦。我将尝试简要描述一下现在的情况，然后再问几个问题。

表

```
AlarmDefinition
AlarmDefinitionID int (primary key) (is identity)
...

Alarm
AlarmID int (primary key) (is identity)
AlarmDefinitionID int (sort of a foreign key) (is nullable)
SampleTagID int (is nullable)
SampleTime DateTime (is nullable)
...

ReasonAction
Time DateTime (primary key)
TagID int (primary key)
ReasonActionID int (primary key)

ReasonActionDefinition
ReasonActionID int (primary key) (is identity)
... 
```

因此，一个 AlarmDefinition 可以有多个 Alarms。而且，一个 ReasonActionDefinition 可以有多个 ReasonAction。Alarm 和 ReasonAction 之间存在隐式关系（即，一个 Alarm 可以有多个 ReasonAction）。这是我最麻烦的地方。

POCO

```
AlarmDefinition
public class AlarmDefinition
{
    public int AlarmDefinitionID { get; set; }
    ...
    public virtual ICollection<Alarm> Alarms { get; set; }
}

Alarm
public class Alarm
{
    public int AlarmID { get; set; }
    public Nullable<int> SampleTagID { get; set; }
    public Nullable<System.DateTime> SampleTime { get; set; }
    ...
    public Nullable<int> AlarmDefinitionID { get; set; }
    public virtual AlarmDefinition AlarmDefinition { get; set; }
    // I don’t know if this is set up correctly
    public virtual ICollection<ReasonAction> ReasonActions { get; set; }
}

ReasonAction
public class ReasonAction
{
    public System.DateTime Time { get; set; }
    public int TagID { get; set; }
    public virtual Alarm Alarm { get; set; }
    public int ReasonActionID { get; set; }  // Primary key
    public virtual ReasonActionDefinition ReasonActionDefinition { get; set; }
}

ReasonActionDefinition
public class ReasonActionDefinition
{
    public int ReasonActionID { get; set; }
    ...
    public virtual ICollection<ReasonAction> ReasonActions { get; set; }
} 
```

数据库上下文

```
public class AppDbContext : DbContext
{
    public DbSet<Alarm> Alarms { get; set; }
    public DbSet<AlarmDefinition> AlarmDefinitions { get; set; }
    public DbSet<ReasonAction> ReasonActions { get; set; }
    public DbSet<ReasonActionDefinition> ReasonActionDefinitions { get; set; }

    protected override void OnModelCreating(DbModelBuilder modelBuilder)
    {
        modelBuilder.Configurations.Add(new AlarmMap());
        modelBuilder.Configurations.Add(new AlarmDefinitionMap());
        modelBuilder.Configurations.Add(new ReasonActionMap());
        modelBuilder.Configurations.Add(new ReasonActionDefinitionMap());
    }
} 
```

流利的映射

```
AlarmDefinitionMap
public class AlarmDefinitionMap : EntityTypeConfiguration<AlarmDefinition>
{
    public AlarmDefinitionMap()
    {
        this.HasKey(t => t.AlarmDefinitionID);
        ...
        this.ToTable("AlarmDefinition");
        this.Property(t => t.AlarmDefinitionID).HasColumnName("AlarmDefinitionID");
        ...
    }
}

AlarmMap
public class AlarmMap : EntityTypeConfiguration<Alarm>
{
    public AlarmMap()
    {
        this.HasKey(t => t.AlarmID);
        ...
        this.ToTable("Alarm");
        this.Property(t => t.AlarmID).HasColumnName("AlarmID");
        this.Property(t => t.AlarmDefinitionID).HasColumnName("AlarmDefinitionID");
        this.Property(t => t.SampleTagID).HasColumnName("SampleTagID");
        this.Property(t => t.SampleTime).HasColumnName("SampleTime");
        ...
        this.HasOptional(t => t.AlarmDefinition)
            .WithMany(d => d.Alarms)
            .HasForeignKey(t => t.AlarmDefinitionID);
    }
}

ReasonActionMap
public class ReasonActionMap : EntityTypeConfiguration<ReasonAction>
{
    public ReasonActionMap()
    {
        this.HasKey(t => new { t.Time, t.TagID, t.ReasonActionID });
        this.Property(t => t.TagID).HasDatabaseGeneratedOption(DatabaseGeneratedOption.None);
        this.Property(t => t.ReasonActionID).HasDatabaseGeneratedOption(DatabaseGeneratedOption.None);
        this.ToTable("ReasonAction");
        this.Property(t => t.Time).HasColumnName("Time");
        this.Property(t => t.TagID).HasColumnName("TagID");
        this.Property(t => t.ReasonActionID).HasColumnName("ReasonActionID");
        // Relationships
        // Not sure if this is correct since the related column names in the Alarm table are SampleTagId, not TagID and SampleTime, not Time.  And SampleTagID and SampleTime in the Alarm table are not a primary keys.
        // There's an implicit one-to-many relationship between the Alarm and ReasonAction entities.
        this.HasRequired(t => t.Alarm)
            .WithMany(d => d.ReasonActions)
            .HasForeignKey(t => new { t.TagID, t.Time });
        this.HasRequired(t => t.ReasonActionDefinition)
            .WithMany(d => d.ReasonActions)
            .HasForeignKey(t => t.ReasonActionID);
    }
}

ReasonActionDefinitionMap
public class ReasonActionDefinitionMap : EntityTypeConfiguration<ReasonActionDefinition>
{
    public ReasonActionDefinitionMap()
    {
        this.HasKey(t => t.ReasonActionID);
        ...
        this.ToTable("ReasonActionDefinition");
        this.Property(t => t.ReasonActionID).HasColumnName("ReasonActionID");
        ...
    }
} 
```

哇！那是很多东西。无论如何，这里有一些我们的数据库和映射到 EF 的问题： 1\. 没有声明性引用完整性——所有都在触发器或遗留应用程序代码中处理，2\. 在 Alarm 表中，SampleTagID 和 SampleTime 不是主键，但是这两列是与 ReasonAction 表的隐式一对多关系的一侧， 3\. Alarms 和 ReasonAction 表之间的列名不匹配（Alarm 表的 SampleTagID 和 SampleTime 以及 ReasonAction 表的 Time 和 TagID）。

所以，我的问题是：A. 鉴于上述情况，我可以让 EF 代码首先使用我现有的数据库和表吗？ B. 我需要如何更改我的代码以使一对多关系在警报和 ReasonAction 表（这样当我查询警报时，ReasonActions 导航属性会填充所有相关记录）？，C. 还有其他建议吗？

谢谢！！！

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-10-03T17:35:32.177

我们最终放弃了 EF 并编写了我们自己的自定义 ADO.NET 代码。

# android - android webservice响应“解析xml到pojo异常”

> ID：12095437
> 
> 赞同：3
> 
> 时间：2012-08-23T15:44:38.873
> 
> 标签：android, web-services, xml-parsing

我正在尝试访问 android 中的肥皂网络服务。

```
 AndroidHttpTransport httpTransport = new AndroidHttpTransport(URL);
        ...
        ...
        String result = (String) httpTransport.responseDump; 
```

我得到了下面给出的 xml 格式的响应**结果**字符串，

```
<?xml version="1.0" encoding="UTF-8"?>
    <soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
        <soapenv:Body>
            <sampleResponse xmlns="http://impl.test.com">
                <sampleReturn>
                    <clientNameList>
                        <clientNameList>
                            <clientID>1</clientID>
                        </clientNameList>
                        <clientNameList>
                            <clientID>2</clientID>
                        </clientNameList>
                    </clientNameList>
                    <message>SUCCESS</message>
                </sampleReturn>
            </sampleResponse>
        </soapenv:Body>
    </soapenv:Envelope> 
```

使用简单 XML 序列化 (simple-xml-2.6.6.jar) 将此 xml 解析为 Pojo。**参考：** [这里](http://simple.sourceforge.net/download/stream/doc/examples/examples.php)

```
 Persister persister = new Persister();
        UserResponse userResponse = persister.read(UserResponse.class, result); 
```

现在我得到了例外

```
Element 'Body' does not have a match in class com.test.UserResponse at line 1 
```

[在此处](https://stackoverflow.com/questions/12066666/android-ksoap2-complex-typerequest-and-response)获取更多代码信息

我怎样才能解决这个问题？

UserResponse.java（POJO 类）

```
public class UserResponse {

private String message = null;

private Client[] clientNameList = null;

public String getMessage() {
        return message;
    }

    public void setMessage(String message) {
        this.message = message;
    }

public void setClientNameList(Client[] clientNameList) {
        this.clientNameList = clientNameList;
    }

    public Client[] getClientNameList() {
        return clientNameList;
    }
} 
```

和 Client.java

```
public class Client {

private int clientID;

public void setClientID(int clientID) {
        this.clientID = clientID;
    }

    public int getClientID() {
        return clientID;
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T04:43:26.560

你的回复有问题。您一个接一个地得到`<clientNameList>`两次，这可能会导致您在解析 XML 时出现问题。所以，最好相应地改变你的反应。

# oracle - 请求地理编码时如何配置 Oracle 钱包以避免 ORA-29273？

> ID：12095438
> 
> 赞同：0
> 
> 时间：2012-08-23T15:44:38.040
> 
> 标签：oracle, google-maps, oracle11g

当我使用政府许可的 Google API 密钥时，我在从 Google 获取地理编码时遇到了问题。这个项目是为政府开发的，所以我们应该可以使用这个 API 密钥。政府代理人告诉我，只要我使用此 API 密钥并将我们公司的域添加到他们的列表中，我们应该能够在不受 Google 免费限制的情况下进行地理编码。我正在使用 Oracle 11gR2、Apex 4.1。谷歌确实返回了一些结果（1600个地理编码），过了一会儿我的程序出现了异常。但是，我遇到了以下问题：

```
ORA-29273: HTTP request failed
ORA-06512: at "SYS.UTL_HTTP", line 1722
ORA-29259: end-of-input reached
ORA-06512: at "SORS.SOR_TEST_SERVICE", line 24
ORA-06512: at "SORS.SOR_TEST_SERVICE", line 187
ORA-06512: at line 6
29273\. 00000 - "HTTP request failed"
*Cause: The UTL_HTTP package failed to execute the HTTP request.
*Action: Use get_detailed_sqlerrm to check the detailed error message.
Fix the error and retry the HTTP request. 
```

我在网上搜索并在OTN上找到了以下线程：

[https://forums.oracle.com/forums/thread.jspa?threadID=2253491](https://forums.oracle.com/forums/thread.jspa?threadID=2253491)

看来我需要获得 Google API 证书并将其安装在 Oracle 钱包上。我对此没有任何经验。谁能给我一张关于它的路线图？例如，如何获得 Google 证书？我应该与 Google 联系，还是使用许可 API 密钥发送请求？还是 API 密钥是证书？一个例子会很有帮助！

这是我的代码

```
 procedure Get_Geocoding(P_s_Address in varchar2, P_s_Geocoding out varchar2, P_n_accuracy out    number, P_b_success out boolean) is

  l_address varchar2(4000);
  l_url varchar2(32000);
  l_response varchar2(3200);
  n_first_comma number;
  n_second_comma number;
  n_level_length number;

 BEGIN
    /* TODO implementation required */

    l_address:=APEX_UTIL.URL_ENCODE(P_s_Address);
    l_address := replace(l_address,' ','+');

    l_url := 'http://maps.google.com/maps/geo?q='||l_address||'&'||'output=csv'||'&'||'key=my API key';
    l_response := utl_http.request(l_url, APEX_APPLICATION.G_PROXY_SERVER);

    n_first_comma:=instr(l_response,',',1,1);
    n_second_comma:=instr(l_response,',',1,2);
    n_level_length:=n_second_comma-n_first_comma-1;

    P_n_accuracy:=to_number(substr(l_response,n_first_comma+1, n_level_length));

    l_response:=substr(l_response,instr(l_response,',',1,2)+1);

   P_s_Geocoding:=l_response;
     if (P_s_Geocoding<>'0,0') then
       P_b_success:=true;
     else
      P_b_success:=false;
     end if;

 END; 
```

}

非常感谢！

山姆

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-06-14T17:53:57.807

如果您的数据库版本是 11.2.0.3 或以下，请检查数据库版本，可能会出现此错误。您需要安装补丁来升级基于 tls 的安全性。最低版本是 11.2.0.4.0。Oracle 提供了补丁(19651773) 供windows 升级版本。

# sql - SQL 多内连接

> ID：12095441
> 
> 赞同：0
> 
> 时间：2012-08-23T15:44:40.090
> 
> 标签：sql

您好，在我的系统中，我有一个学生的搜索页面，管理员将能够查看学生的历史记录我在显示他/她的顾问的姓氏 lname_A 时遇到问题。这是我目前使用的代码，到目前为止一切正常，除了我无法获得 lname_a。

```
 $qry_display = "SELECT
        a.student_id, a.section_id, a.level, a.photo, a.address, a.father_occupation, a.father_phone, a.father_company, a.mother_occupation, a.mother_phone, a.mother_company,a.gpa,
        b.fname, b.sex, b.lname, b.mname, b.birth_date, b.birth_place, b.address, b.father, b.father_degree, b.mother, b.mother_degree,
        c.section_name, d.adviser_id , d.lname_a
        FROM tbl_er AS a
        LEFT OUTER JOIN tbl_enroll AS b ON a.student_id = b.student_id
        LEFT OUTER JOIN tbl_section AS c ON a.section_id = c.section_id
        LEFT OUTER JOIN tbl_adviser AS d ON a.section_id = d.adviser_id
        WHERE a.student_id=".$id." AND a.level='Grade 2'"; 
```

很乐意为您提供任何帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T15:53:00.923

您确定要加入两个表或正确的列吗？a.section_id = d.adviser_id

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T15:52:44.650

如果每个学生都有顾问，那么您应该使用内连接而不是左外连接。

当您使用左外连接时，当学生没有顾问时，lname_a 可能为空。

# python - python：搜索重复的用户输入并打印结果

> ID：12095443
> 
> 赞同：0
> 
> 时间：2012-08-23T15:44:51.823
> 
> 标签：python, duplicates

嗨，我正在尝试使此代码正常工作，我认为我正在尝试做的事情是不言自明的。

```
def f():
 ri = raw_input('enter a number 1-100')
 a = range(1, 100, 2)
 if ri in a: print 'duplicate'
 if ri not in a: print 'not duplicate' 
```

请你帮我让它工作！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T15:46:51.377

您正在检查一个字符串而不是一个范围（这是一个列表`ints`）。尝试：

```
if int(ri) in a 
```

您也可以将您的第二个更改`if`为`else`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T16:03:44.647

问题是这实际上并没有检查“重复”是否有任何有价值的重复解释。

关于您的代码“不起作用”的原因，上述答案是正确的-这将“起作用”：

```
def f():
 ri = raw_input('enter a number 1-100')
 a = range(1, 100, 2)
 print 'duplicate' if int(ri) in a else 'not duplicate' 
```

你说的重复到底是什么意思？

# c# - 在读取条形码后触发事件并将焦点设置在文本框上

> ID：12095444
> 
> 赞同：2
> 
> 时间：2012-08-23T15:44:54.077
> 
> 标签：c#, asp.net, visual-studio-2010, textbox, barcode

我正在使用一个基本的 Barcode Web App。我有两个文本框，所以我需要扫描一个，然后触发一个事件以将焦点设置到另一个（两个文本框的长度不相等）。如果两个条形码都与数据库搜索匹配，则显示一些带有数据库信息的标签。

概括：

扫描一个条码，自动设置焦点到另一个文本框，然后扫描第二个条码，最后显示数据库查找的结果。

多谢你们！

附言。我正在使用 VS 2010、asp.net 和 C# 作为代码隐藏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T16:16:11.863

使用 jQuery（只允许数字条码）：

```
$('#<%=yourFirstTextBox.ClientID %>').keydown(function(e) {
    var code = (e.keyCode ? e.keyCode : e.which);
    if (code == 13) { //Enter keycode
        $('#<%=yourSecondTextBox.ClientID %>').focus()
    }
    else if ((code >= 48 && code <= 57) || (code >= 96 && code <= 105) || (code == 8) || (code >= 37 && code <= 40) || (code == 46))
        return true;
    else
        return false;
}); 
```

# html - 非画布响应式设计

> ID：12095447
> 
> 赞同：0
> 
> 时间：2012-08-23T15:45:08.807
> 
> 标签：html, css, responsive-design

我正在寻找[画布外响应式设计](http://jasonweaver.name/lab/offcanvas/technical/)的一个很好的工作示例。只是尝试复制Google+ android应用程序的界面，并在右侧添加面板。

像[这个例子](http://www.vinceallen.com/offcanvas/)。但是这个例子有很多问题：

*   在触摸屏上无法正常工作（Galaxy Nexus 上的 Chrome）；
*   菜单应该在内容 div 下，而不是滑动；
*   “菜单”按钮不会随着内容 div 向右滑动。

你能告诉我建造这样的东西更好吗？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T21:27:47.357

Zurb Foundation 框架包括画布外响应式设计以及一些很酷的示例和说明

[http://www.zurb.com/playground/off-canvas-layouts](http://www.zurb.com/playground/off-canvas-layouts)

# python - 从变量中删除值的最佳方法？创建一个数组，还是使用正则表达式？还是使用 Xpath？

> ID：12095449
> 
> 赞同：1
> 
> 时间：2012-08-23T15:45:12.913
> 
> 标签：python, regex, arrays, xpath

我尝试使用以下代码从该问题末尾的输出中提取一些字段：

```
doc = LH.fromstring(html2)
tds = (td.text_content() for td in doc.xpath("//td[not(*)]"))

for a,b,c in zip(*[tds]*3):
    print (a,b,c) 
```

我期望的是只提取字段notificationNodeName，notificationNodeName，packageName，notificationEnabled

主要问题是因为我想将结果放入数据库。我需要，而不是收到：

实际代码返回：

```
('JDBCAdapter', 'JDBCAdapter', 'Package:Notif')
('Package', 'yes', 'Package_2:Notif')
('Package_2', 'yes') 
```

我需要的：

```
('Package:Notif','Package', 'yes')
('Package_2:Notif','Package_2', 'yes') 
```

我发现的一个不合理的解决方案是：

```
doc = LH.fromstring(html2)
tds = (td.text_content() for td in doc.xpath("//td"))

for td, val in zip(*[tds]*2):
    if td == 'notificationNodeName':
        notificationNodeName = val
    elif td == 'packageName':
        packageName = val
    elif td == 'notificationEnabled':
        notificationEnabled = val
        print (notificationNodeName,packageName,notificationEnabled) 
```

它有效，但不适合我，我相信这可能是一种更好的方法。

原始 HTML 输出：

```
<tbody><tr>
<td valign="top"><b>adapterTypeName</b></td>
<td>JDBCAdapter</td>
</tr>
<tr>
<td valign="top"><b>adapterTypeNameList</b></td>
<td>
<table>
<tbody><tr>
<td>JDBCAdapter</td>
</tr>
</tbody></table>
</td>
</tr>
<tr>
<td valign="top"><b>notificationDataList</b></td>
<td>
<table>
<tbody><tr>
<td><table bgcolor="#dddddd" border="1">
<tbody><tr>
<td valign="top"><b>notificationNodeName</b></td>
<td>package:Notif</td>
</tr>
<tr>
<td valign="top"><b>packageName</b></td>
<td>Package</td>
</tr>
<tr>
<td valign="top"><b>notificationEnabled</b></td>
<td>unsched</td>
</tr>
</tbody></table>
</td>
</tr>
<tr>
<td><table bgcolor="#dddddd" border="1">
<tbody><tr>
<td valign="top"><b>notificationNodeName</b></td>
<td>Package_2:notif</td>
</tr>
<tr>
<td valign="top"><b>packageName</b></td>
<td>package_2</td>
</tr>
<tr>
<td valign="top"><b>notificationEnabled</b></td>
<td>yes</td>
</tr>

and continues to more ... non relevant repetitive data. 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T16:23:14.503

我建议使用优秀的 lxml 和它的 cssselect 功能，基本上大多数 HTML 解析。

然后，您可以选择您感兴趣的每个字段：

```
from lxml import html
root = html.parse(open('your/file.html')).getroot()

sibling_content = lambda x: [b.getparent().getnext().text_content() for b in
                             root.cssselect("td b:contains('{0}')".format(x))]

fields = ['notificationNodeName', 'packageName', 'notificationEnabled']

for item in zip(*[sibling_content(field) for field in fields]):
    print item 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T16:42:10.573

我还推荐 lxml - 它是使用 Python 解析 XML 或 HTML 的事实标准。

作为 David 方法的替代方案，这里有一个使用 xpaths 的解决方案：

```
from lxml import html
from lxml import etree

html_file = open('test.html', 'r')
root = html.parse(html_file).getroot()

# Strip those annoying <b> tags for easier xpaths
etree.strip_tags(root,'b')

data_list = root.xpath("//td[text()='notificationDataList']/following-sibling::*")[0]

node_names = data_list.xpath("//td[text()='notificationNodeName']/following-sibling::*/text()")
package_names = data_list.xpath("//td[text()='packageName']/following-sibling::*/text()")
enableds = data_list.xpath("//td[text()='notificationEnabled']/following-sibling::*/text()")

print zip(node_names, package_names, enableds) 
```

输出：

```
[('package:Notif', 'Package', 'unsched'),
 ('Package_2:notif', 'package_2', 'yes')] 
```

# mysql - 如何将多值属性放在查询的一列中？

> ID：12095450
> 
> 赞同：2
> 
> 时间：2012-08-23T15:45:14.750
> 
> 标签：mysql, sql, database

例如，在我的数据库中，我有 3 个表，

*   用于存储书籍数据的 Books 表
*   用于存储标签数据的标签表
*   以及用于存储关于具有多个标签的书的信息的链接表（Book_Tags 表）。

如下图所示...（箭头上方的“M”表示关系的多方面）

```
 BOOKS                    BOOK_TAGS                      TAGS
    +----+---------+         +---------+----------+         +----+---------------+
    |ID  |  Title  |         |Book_Id  |  Tags_Id |         |ID  |  Tag_Name     |
    +----+---------+         +---------+----------+         +----+---------------+ 
    |1   |  Book_1 | 1    M  |1        | 1        | M     1 |1   |  Tag_Name_1   |
    |1   |  Book_1 |<--------|1        | 2        |-------->|2   |  Tag_Name_2   |
    +----+---------+         |1        | 3        |         |3   |  Tag_Name_3   |
                             |2        | 1        |         +----+---------------+ 
                             |2        | 3        |         
                             +---------+----------+ 
```

我的问题是，我如何查询我的数据库，以便得到类似的结果

```
 +---------------------------------------------------------+
    |ID  |  Book_Title  |   Tags                              |
    +---------------------------------------------------------+
    |1   |  Book_1      |   Tag_Name_1, Tag_Name_2, Tag_Name_3|
    |2   |  Book_2      |   Tag_Name_1, Tag_Name_3            |
    +---------------------------------------------------------+ 
```

而不是像

```
 +----------------------------------+
    |ID  |  Book_Title  |   Tags       |
    +----------------------------------+
    |1   |  Book_1      |   Tag_Name_1 |
    |2   |  Book_1      |   Tag_Name_2 |
    |3   |  Book_1      |   Tag_Name_3 |
    |4   |  Book_2      |   Tag_Name_1 |
    |5   |  Book_2      |   Tag_Name_3 |
    +----------------------------------+ 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T15:51:59.410

您可以使用 GROUP BY 子句来聚合结果并进行字符串追加。所以像：

```
SELECT bk.Book_Title, GROUP_CONCAT(bt.Book_Id SEPARATOR ', ') FROM BOOK_TAGS bt
JOIN BOOKS bk ON bk.ID = bt.Book_Id
JOIN TAGS t ON t.ID = bt.Tags_Id
GROUP BY bt.Book_Id 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T15:53:02.530

```
 SELECT b.book_title, tmp.tag_name from books b
    INNER JOIN (
SELECT bt.book_id as book_id , group_concat(t.tag_name) as tag_name FROM book_tags bt 
    INNER JOIN tags t ON t.tag_id =  bt.tags_id
) tmp
    ON tmp.book_id = b.id 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-10-24T10:34:26.217

下面是带有自动增量 ID 的 sql 查询。

> SELECT @temp:=@temp+1 AS ID, Book_Title, Tags FROM (SELECT title as Book_Title, GROUP_CONCAT(tag_name) AS Tags FROM (SELECT BOOKS.title, TAGS.tag_name FROM ( `book_tags`JOIN BOOKS ON BOOKS.id = BOOK_TAGS.book_id ) 在 TAGS.id=BOOK_TAGS.tag_id 上加入标签) tbl GROUP BY 标题) 作为 tbl 交叉连接 (SELECT @temp:=0) 作为虚拟

# django - Django：即使发出其他请求，视图中的功能也可以连续运行吗？

> ID：12095458
> 
> 赞同：2
> 
> 时间：2012-08-23T15:45:27.237
> 
> 标签：django

我正在尝试创建一个函数，该函数在调用时将以不规则（和未定义）的时间间隔从外部源中提取信息。然后，这些数据将被放置在数据库中以供以后检索。即使发出其他页面请求，我也希望它在后台运行。这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T16:10:15.813

在请求/响应周期之外运行 Django 函数的最佳方法是将其实现为[自定义管理命令](https://docs.djangoproject.com/en/1.4/howto/custom-management-commands/)，然后您可以使用`cron`.

如果你已经在使用它，它[`celery`支持使用周期性任务`celerybeat`](http://celery.github.com/celery/tutorials/clickcounter.html)，但这需要[配置和运行`celerybeat`守护进程](http://docs.celeryproject.org/en/latest/userguide/periodic-tasks.html)，这可能会让人头疼。如您的问题标题中所述，Celery 还支持长时间运行的任务（事情在视图中开始，但在自己的时间完成）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T18:38:50.470

由于您似乎需要在加载页面时调用该函数，因此您可以将其放在您的视图中

```
def my_view(request):
    #Call the long running function
    long_running_function()
    #Do view logic and return
    return HttpResponse(...) 
```

为了处理`long_running_function`你可以使用`celery`并创建一个`tasks.py`实现你的外部数据源逻辑的。创建任务、加入队列和配置`celery`总结[在这里](http://mathematism.com/2010/02/16/message-queues-django-and-celery-quick-start/)

如果您只需要一个更简单的解决方案来尝试它，请查看[subprocess](http://docs.python.org/library/subprocess.html)模块。

一个非常相似的答案在这里[Django: start a process in a background thread?](https://stackoverflow.com/questions/2381164/django-start-a-process-in-a-background-thread)

# c# - 可能是内存泄漏或？

> ID：12095461
> 
> 赞同：6
> 
> 时间：2012-08-23T15:45:36.640
> 
> 标签：c#, asp.net, .net, memory-leaks

将不胜感激这里的任何帮助。

关于场景的简要说明 -

服务器上运行着一个 COM+（用 C# 编写）。该 COM 的任务是获取多页 tiff 文件的文件名、页码以及将其转换为 gif 文件图像的分辨率。使用代理从 Web 应用程序调用此 COM。网站获取转换后的图像并以请求的分辨率显示。对于打印 - 它发出 2 个请求 - 第一个用于显示分辨率，第二个用于全分辨率（使用 window.print() 打印）。

问题 -

一段时间后，服务器内存不足，图像没有显示在网站上。服务器需要定期重启。

错误

```
EventType clr20r3, P1 imageCOM.exe, P2 1.0.0.0, P3 4fd65854, P4 prod.web.imaging, P5 1.0.0.0, P6 4fd65853, P7 1a, P8 21, P9 system.outofmemoryexception, P10 NIL.

Here is the error(s) on the web server (these continuously appear every minute) ….

System.Net.WebException: Unable to connect to the remote server ---> System.Net.Sockets.SocketException: No connection could be made because the target machine actively refused it
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.InternalConnect(EndPoint remoteEP)
   at System.Net.ServicePoint.ConnectSocketInternal(Boolean connectFailure, Socket s4, Socket s6, Socket& socket, IPAddress& address, ConnectSocketState state, IAsyncResult asyncResult, Int32 timeout, Exception& exception)
   --- End of inner exception stack trace --- 
```

我无权访问生产服务器，但系统管理员发送的错误指出 OutOfMemory。

因此，假设内存泄漏并专注于它 - 我的发现到目前为止处理这种情况的经验有限 -

*   Perfmon - 我看到进程/私有字节正在增加，.Net CLR 内存/堆中的字节数也在增加。因此，我认为它是托管内存泄漏。不过我不确定。
*   CPU 使用率 - 从 8% 开始，仅在开始时上升到 80%。它回落并保持在 3% - 12% 之间，但有几次回落到 75%-85%。不知道这里发生了什么。
*   我开始调试服务器 COM 以查看堆、gcroot 等。

    1.  随着每个请求的提出，堆中有 2 个对象的计数正在增加。1 个对象是保存图像数据的对象。第二个对象是事件处理程序，用于在对象 1（图像）在一定时间后过期时从缓存中删除它。
    2.  查看方法调用 - 两个对象都导致相同的方法。
    3.  代码实现明智 - 请求的图像被缓存（最多一定数量） - 我可以理解这是为了更好的性能。可能这就是为什么对对象的引用在堆中增加，如项目符号 1 中所述。

我知道我给出了非常模糊的描述，但我需要某种线索来检测服务器上的真正问题。

编辑：图像对象已被处理为

```
Bitmap retVal;

      using (MemoryStream buffer = new MemoryStream(doc.FileData, 0, doc.DocumentSize, false, false))
      {
        using (Bitmap original = new Bitmap(buffer))
        {
        //select the page to convert and
        //perform scaling - full resolution or the requested resolution.  
        }
      }

      using (MemoryStream buffer = new MemoryStream())
      {
        retVal.Save(buffer, ImageFormat.Gif);
        retVal.Dispose();
        return buffer.GetBuffer();
      } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T15:57:51.360

确保在使用完`Image`对象（例如`Bitmap`）后对其进行处理。我猜您正在将 tiff 图像作为位图打开并重新缩放，然后再次将其保存为 gif。如果您不处理位图，它将泄漏内存（通常每次几 MB，具体取决于图像的大小）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T15:52:30.093

我认为您的第一点可能是问题的原因。您可以尝试减少缓存过期时间并检查再次出现内存不足错误所花费的时间，您可能必须更改算法以避免这种情况。你的第二个不应该是错误的原因。

# javascript - Android：通过 loadUrl 运行 javascript 时，webview 中的视频冻结

> ID：12095477
> 
> 赞同：0
> 
> 时间：2012-08-23T15:46:25.407
> 
> 标签：javascript, android, video, webview, keypress

我有一个应用程序可以在 web 视图中播放自适应流媒体视频。问题是在尝试注入 javascript 时，视频会冻结。

HTML：

```
<video src="http://devimages.apple.com/iphone/samples/bipbop/gear1/prog_index.m3u8" autoplay="autoplay" controls="controls" height="720" width="1280" /> 
```

安卓：

```
webView.loadUrl("javascript:alert('Hello World!');"); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T16:17:51.907

因此，当我尝试在 webview 中播放视频时，这段小代码对我有用：

```
 String videoPoP = "http://www.youtube.com/v/A6kCkkLo6Rw?";
      webview.getSettings().setJavaScriptEnabled(true);
      String widthAndHeight = "width=\"" + widthdp + "\" height=\"" + height_new + "\"";            

            String temp = "<object "
                + widthAndHeight
                + ">"
                + "<body style='margin:0;padding:0;'>"
                + "<param name='allowFullScreen' value='false'>"
                + "</param><param name='allowscriptaccess' value='always'>"
                + "</param><embed src='"
                + videoPoP
                + "'"
                + " type='application/x-shockwave-flash' allowscriptaccess='always' allowfullscreen='true'"
                + widthAndHeight + "></embed></object>";

        webview.loadData(temp, "text/html", "utf-8"); 
```

您可以为字符串中的宽度和高度赋予任何值

# php - 将数组从php传回javascript并循环它

> ID：12095479
> 
> 赞同：0
> 
> 时间：2012-08-23T15:46:28.740
> 
> 标签：php, ajax, json

您好我正在将一个数组从 php 传回给 javascript。`response[0]`我在网上了解到，在将数组传回时我应该在数组上使用 json_encode 但现在我将它放在 ajax 中`[`，我不确定如何循环它，因为虽然在将整个内容写到使用innerHTML的文档我可以看到它看起来像一个数组，但是使用for循环给了我上面所说的每个字母，等于[而不是第一个条目。我究竟做错了什么？任何帮助是极大的赞赏！`response[1]``"``response[0]`

**PHP**

```
<?PHP
    $link = mysql_connect('localhost', 'root', 'root');
    mysql_select_db("Colleges");
    $result = mysql_query("SELECT * FROM `Colleges` ORDER BY School");
    $schools = array();
    while ($row = mysql_fetch_array($result)) {
        array_push($schools, $row['School']);
    }
    mysql_close();
    die(json_encode($schools));
?> 
```

**阿贾克斯**

```
<script type="text/javascript">
    function schools(){
        $.ajax({
            url: "Schools.php",
                type: "POST",
            success: function (response) {
                //Loop over response
            }
        });
    }
</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T15:48:36.840

您应该解码您的 JSON 响应（实际上是一个字符串），以便能够像使用对象一样使用它：

```
var respObj = JSON.parse(response); 
```

另一种方法是注意到 jQuery 将由服务器提供 JSON（使用`dataType: 'json'`ajax 参数或`Content-Type: application/json`响应标头）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T15:50:26.537

Javascript

```
for ( variable in response ) {
    alert(results[variable]);
} 
```

* * *

jQuery

```
$.each(response, function(ind, val){
   alert("index:" + ind + ". value:" + val);
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T15:52:02.937

在传递给`ajax`方法的对象中，您应该尝试添加`dataType: 'json'`以指定结果为 json，或者您可以在调用`header('Content-type: application/json');`之前在php 脚本调用中指定它`die();`

这样做将导致您`response`成为您期望的对象而不是字符串。

最后，您可以保持原样，并调用您的成功回调`response = $.parseJSON(response);`，它将获取响应字符串并将其转换为对象，请参阅[http://api.jquery.com/jQuery.parseJSON/](http://api.jquery.com/jQuery.parseJSON/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-23T15:52:20.640

```
Use Following if it helps

 res=jQuery.parseJSON(response);

for(i=0;i<res.length;i++)
{
  alert(res[i].propertyname);

} 
```

这里的属性名称暗示 json 上的键。在您的情况下，它可以是“学校”或只是一个数字 i 或值也可以只是 res[i]

# oracle - Oracle 中用于计算密集型函数的最快语言

> ID：12095484
> 
> 赞同：2
> 
> 时间：2012-08-23T15:46:49.587
> 
> 标签：oracle

目前我们有相当多的函数（正常 CDF、逆 CDF、Vasicek 和各种派生类）用 PL/SQL 编码，但它们非常慢。

我可以通过在工作站上流式传输数据来获得更好的性能，在该工作站上我用 C# 编码了一些东西，然后将结果批量插入回来。然而，这种方法使网络成为瓶颈，如果我可以通过在 Oracle DB 中拥有更快的功能来“将工厂放在木材所在的地方”，那就更好了。

我想看看如何通过在 c(++) 或 Java（或您可能拥有的任何其他替代方案）中对其进行编码来加快速度。这里有人有这方面的经验吗？希望你们中的一个人已经尝试了所有方法，并且可以解释哪种方法总体上效果最好。

这里额外的复杂性是 IT 很忙，所以如果我想放弃使用数据库上的某些功能，我需要做一个可靠的案例。我不能在那个盒子上玩太多，否则我会那样做。

我们正在使用 Oracle Database 11g Enterprise Edition Release 11.2.0.2.0 - 64bit Production

提前致谢，

格特-扬

**编辑**

这是一个函数的示例，它是[Cody 的 Normal CDF](http://home.online.no/~pjacklam/notes/invnorm/#The_distribution_function)。

this 和 the 之间的区别在于`cume_dist`找到`cume_dist`一组行内的分布。我只需要将概率转换为标准偏差并返回（很多次），就像Excel 中的`NORMDIST`and函数一样。`NORMINV`

```
 function stdnormal_cdf(u number) return number is
  z number;
  y Number;
  begin
    y:=abs(u);
    if y <= 0.6629126073623883041257915894732959743297 then
      z:=y * y;
      y:=u * ((((1.161110663653770e-002 * z + 3.951404679838207e-001) * z + 2.846603853776254e + 001) * z + 1.887426188426510e + 002) * z + 3.209377589138469e + 003)/((((1.767766952966369e-001 * z + 8.344316438579620) * z + 1.725514762600375e + 002) * z + 1.813893686502485e + 003) * z + .044716608901563e + 003);
      return 0.5  +  y ;
    else
      z:=exp(-y * y/2)/2;
      if y <= 5.65685424949238019520675489683879231428 then
        y:=y/1.41421356237309504880168872420969807857;
        y:=((((((((2.15311535474403846e-8 * y + 5.64188496988670089e-1) * y + 8.88314979438837594) * y + 6.61191906371416295e01) * y + 2.98635138197400131e02) * y + 8.81952221241769090e02) * y + 1.71204761263407058e03) * y + 2.05107837782607147e03) * y + 1.23033935479799725e03)/((((((((1.00000000000000000e00 * y + 1.57449261107098347e01) * y + 1.17693950891312499e02) * y + 5.37181101862009858e02) * y + 1.62138957456669019e03) * y + 3.29079923573345963e03) * y + 4.36261909014324716e03) * y + 3.43936767414372164e03) *  + 1.23033935480374942e03);
        y:=z * y;
      else
        z:=z * 1.41421356237309504880168872420969807857/y;
        y:=2/(y * y);
        y:=y * (((((1.63153871373020978e-2 * y + 3.05326634961232344e-1) * y + 3.60344899949804439e-1) * y + 1.25781726111229246e-1) * y + 1.60837851487422766e-2) * y + 6.58749161529837803e-4)/(((((y + 2.56852019228982242) * y + 1.87295284992346047) * y + 5.27905102951428412e-1) * y + 6.05183413124413191e-2) * y + 2.33520497626869185e-3);
        y:=z * (1/1.77245385102123321827450760252310431421-y);
      end if;

      if u < 0 then 
        return y;
      else 
        return 1-y;
      end if;    
    end if;  
  end; 
```

**编辑 2**

好的，这里是基准。具有 100k 行的测试表。Oracle 和 F# 之间的函数是彼此非常直接的翻译，并给出相同的结果。

查询：

```
select 
    sum(get_rwa(approach, exposure_class_code, pd_r, lgd_r, ead_r, maturity_r, net_sale, rwf_r)) 
from functest 
```

*   口译：12.8 秒
*   原生：13.2 秒
*   .Net (F#)：0.04 秒。

这将使 .Net 函数比 Oracle 实现快 320 倍（！），我真的不明白这种差异可能来自哪里。任何高达 3-10 倍的东西似乎都是合理的。我真的觉得我在这里遗漏了一些东西。任何人？

在 F# 中，我首先将 100k 行加载到列表中。（看起来很公平，只是总结 Oracle 中的任何其他列花费 0.06 秒，因此在这两种情况下排除数据访问时间似乎很公平。将数据加载到列表中大约需要 3 秒，所以即使我包括时间它需要打开连接，通过网络执行和流式传输等，然后它仍然快 4 倍。）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-23T15:58:03.300

Oracle 支持[定义和调用外部过程](http://docs.oracle.com/cd/B10500_01/appdev.920/a96590/adg11rtn.htm)的能力。假设您可以将 C/C++/C# 应用程序编译成 DLL/.so 并将该库移动到数据库服务器，那么您可以将 DLL 的函数公开为外部过程，然后从数据库中调用 DLL 的函数。由于一切都将在同一台机器上运行，因此网络不会成为瓶颈。当然，这意味着您的 C/C++/C# 代码将使用服务器的处理资源——这可能不是一件好事，这取决于服务器的 CPU 与工作站的 CPU 相比有多强大以及服务器是什么正在做。

根据您在 PL/SQL 中编写逻辑的确切方式，您可能还想研究利用 Oracle 的内置分析函数（如[cume_dist）](http://docs.oracle.com/cd/B19306_01/server.102/b14200/functions035.htm)进行累积分布（我假设这就是您所说的“普通 CDF”）或编写自己的分析函数。由于您的代码是计算密集型的，因此您也很有可能从[本机编译](http://www.oracle-base.com/articles/11g/plsql-new-features-and-enhancements-11gr1.php#native_compilation)中受益。当然，这假设您已经对代码进行了概要分析，并且没有明显的地方/方法来调整 PL/SQL。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-24T17:44:52.010

格特-扬，

很可能，时间差异是由于 SQL 引擎和 PL/SQL 引擎之间的上下文切换造成的。functest 中的 100,000 行中的每一行都通过 PL/SQL 例程 get_rwa（和/或 stdnormal_cdf）。上下文切换涉及保存状态和恢复状态，一旦完成，您可能不会注意到。但是这样做 100,000 次加起来。

因此，我建议在包含 100,000 行的嵌套表中加载 100,000 行，并将该嵌套表仅传递一次给执行简单“for i in 1 .. [nested_table_variable].count loop .. . end loop;"，同时总结各个结果。

另一种选择是在 SQL 中完成所有操作，而不使用 PL/SQL。

问候，
罗布。

# c# - 使用 MVVM 时出现 WPF 绑定问题

> ID：12095486
> 
> 赞同：2
> 
> 时间：2012-08-23T15:47:02.577
> 
> 标签：c#, .net, data-binding, mvvm, command

我的第一个问题的时间:)

我有以下内容：

```
public class BuilderViewModel : INotifyPropertyChanged
{
    #region Implementation of INotifyPropertyChanged

    public event PropertyChangedEventHandler PropertyChanged;

    #endregion

    private double _contentScale = 1.0;

    public double ContentScale
    {
        get { return _contentScale; }
        set
        {
            _contentScale = value;
            NotifyPropertyChanged("ContentScale");
        }
    }

    public void NotifyPropertyChanged(string propertyName)
    {
        if (PropertyChanged != null)
        {
            PropertyChanged(this, new PropertyChangedEventArgs(propertyName));
        }
    } 

    #region Commands

    bool CanZoomIn() { return true; }
    void ZoomInExecute()
    {
        ContentScale += 1.0;
    }

    public ICommand ZoomIn { get { return new RelayCommand(ZoomInExecute, CanZoomIn); } }

    #endregion
} 
```

以及相应的视图：

```
<UserControl x:Class="PS_IDE.FormBuilder.View.Builder"
         xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
         xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
         xmlns:local="clr-namespace:PS_IDE.FormBuilder.ViewModel">
    <UserControl.DataContext>
        <local:BuilderViewModel />
    </UserControl.DataContext>

    <TextBox Text="{Binding ContentScale}" Width="100" />

</UserControl> 
```

我试图让 BuilderViewModel 中的 ZoomIn 命令更新其视图中的文本框值。该命令是从另一个用户控件 UIBuilder 触发的，其中包括 Builder。如果我从 UIBuilder 调试并触发命令，我可以看到它正确更新 ContentScale。

但是，我的文本框值没有得到更新（它只显示“1”，这是 ContentScale 的初始值）。

我知道我错过了一些东西，希望有人能指出我正确的方向。

**编辑：添加了触发命令的控件**

```
<UserControl x:Class="PS_IDE.FormBuilder.UIBuilder"
         xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
         xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
         xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
         xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
         xmlns:local="clr-namespace:PS_IDE.FormBuilder"
         xmlns:ViewModel="clr-namespace:PS_IDE.FormBuilder.ViewModel"
         xmlns:View="clr-namespace:PS_IDE.FormBuilder.View" mc:Ignorable="d">  
    <UserControl.DataContext>
        <ViewModel:BuilderViewModel />
    </UserControl.DataContext>
    <DockPanel LastChildFill="True">

        ....

        <ToolBarTray DockPanel.Dock="Bottom" HorizontalAlignment="Right">
            <ToolBar>
                <Button Height="24" Width="24" ToolTip="Zoom In" Command="{Binding ZoomIn}">
                    <Image Source="Images/ZoomIn.png" Height="16"/>
                </Button>

                ....

            </ToolBar>
       </ToolBarTray>
       <View:Builder x:Name="builder" />
    </DockPanel>
</UserControl> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T17:07:03.033

使用**两个视图中**的设置：

```
<UserControl.DataContext>
    <local:BuilderViewModel />
</UserControl.DataContext> 
```

您基本上是在**创建两个视图模型**，每个视图一个。因此，当您的命令更新属性时，它会在其中一个视图模型上执行此操作，但您的文本框绑定到不同的视图模型。

要解决它，**请**`DataContext`从`Builder.xaml`

此外，您需要将您的控件传递`DataContext`给您的`Builder`控件（这两个视图将共享相同的视图模型）。

所以修改你的 UIBuilder.xaml：

```
<View:Builder x:Name="builder" DataContext="{Binding}" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T15:48:54.780

在绑定中使用 Mode TwoWay

```
 Text ="{Binding ElementName=BuilderViewModel,
         Path=ContentScale,
         Mode=TwoWay,
         UpdateSourceTrigger=PropertyChanged}" 
```

注意：使用可观察集合来发送通知

# php - php preg_match_all not specific number

> ID：12095489
> 
> 赞同：0
> 
> 时间：2012-08-23T15:47:12.313
> 
> 标签：php, regex, preg-match-all

I want to exclude a specific number like 4800 from a string of numbers like 569048004801. I'm using php for this and the method preg_match_all some pattern's examples I have tried :

```
/([^4])([^8])([^0])([^0])/i
/([^4800])/i 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T15:56:03.020

如果只想查看一个字符串是否包含 4800，则不需要正则表达式：

```
<?php

$string = '569048004801';

if(strpos($string,'4800') === false){
  echo '4800 was not found in the string';
}
else{
  echo '4800 was found in the string'; 
} 
```

[此处文档](http://www.php.net/manual/en/function.strpos.php)中有关 strpos 的更多信息

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-23T15:50:02.373

如果你的意思是你只是想`4800`从一个字符串中删除，这更容易使用`str_replace`：

```
$str = '569048004801';
$str = str_replace('4800', '', $str); 
```

另一方面，如果你的意思是你想知道一个特定的数字字符串是否包含`4800`，这将为你测试：

```
$str = '569048004801';

if (preg_match_all('/4800/', $str) > 0) {
    echo 'String contains 4800.';
} else {
    echo 'String does not contain 4800.';
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-23T15:53:15.040

```
/([^4])([^8])([^0])([^0])/i 
```

这实际上是说，*不是 "4800" 的四个字符序列*。关。

```
/([^4800])/i 
```

这实际上是说，*不是 '4'、'8' 或 '0' 的单个字符*。

假设你的意思是捕获一个不包含“4800”的数字，我想你可能想要

```
/(?!\d*4800)\d+/i 
```

这就是说，*首先检查我们没有在某处查看带有“4800”的数字字符串，如果是这种情况，请捕获数字字符串*。它被称为“负前瞻断言”。

# jquery - jQuery on click remove input value

> ID：12095490
> 
> 赞同：0
> 
> 时间：2012-08-23T15:47:19.037
> 
> 标签：jquery, jquery-ui

one more question.

This is the website: http: //www.revewit.com/

Check out input field on the left, it 's the work of jQueryUI autocomplete. What I want to do is place a placeholder, text which will disappear after I click the input field, and I can't find a way to do it. This is the code I have for now:

```
< script type = "text/javascript" > (function(jQuery) {
jQuery.widget("ui.combobox", {
    _create: function() {
        var input, self = this,
            select = this.element.hide(),
            selected = select.children(":selected"),
            value = selected.val() ? selected.text() : "ppp",
            wrapper = this.wrapper = jQuery("<span>").addClass("ui-combobox").insertAfter(select);

        input = jQuery("<input>").appendTo(wrapper).val(value).addClass("ui-state-default ui-combobox-input").autocomplete({
            delay: 0,
            minLength: 0,
            source: function(request, response) {
                var matcher = new RegExp(jQuery.ui.autocomplete.escapeRegex(request.term), "i");
                response(select.children("option").map(function() {
                    var text = jQuery(this).text();
                    if (this.value && (!request.term || matcher.test(text))) return {
                        label: text.replace(
                        new RegExp("(?![^&;]+;)(?!<[^<>]*)(" + jQuery.ui.autocomplete.escapeRegex(request.term) + ")(?![^<>]*>)(?![^&;]+;)", "gi"), "<strong>$1</strong>"),
                        value: text,
                        option: this
                    };

                }));
            },
            select: function(event, ui) {
                document.location.href = ui.item.option.value;
                ui.item.option.selected = true;
                self._trigger("selected", event, {
                    item: ui.item.option
                });
            },
            change: function(event, ui) {
                if (!ui.item) {
                    var matcher = new RegExp("^" + jQuery.ui.autocomplete.escapeRegex(jQuery(this).val()) + "$", "i"),
                        valid = false;
                    select.children("option").each(function() {
                        if (jQuery(this).text().match(matcher)) {
                            this.selected = valid = true;
                            return false;
                        }
                    });
                    if (!valid) {
                        // remove invalid value, as it didn't match anything
                        jQuery(this).val("");
                        select.val("");
                        input.data("autocomplete").term = "";
                        return false;
                    }
                }
            }
        }).addClass("ui-widget ui-widget-content ui-corner-left");

        input.data("autocomplete")._renderItem = function(ul, item) {
            return jQuery("<li></li>").data("item.autocomplete", item).append("<a>" + item.label + "</a>").appendTo(ul);

        };

        jQuery("<a>").attr("tabIndex", -1).attr("title", "Show All Items").appendTo(wrapper).button({
            icons: {
                primary: "ui-icon-triangle-1-s"
            },
            text: false
        }).removeClass("ui-corner-all").addClass("ui-corner-right ui-combobox-toggle").click(function() {
            // close if already visible
            if (input.autocomplete("widget").is(":visible")) {
                input.autocomplete("close");
                return;
            }

            // work around a bug (likely same cause as #5265)
            jQuery(this).blur();

            // pass empty string as value to search for, displaying all results
            input.autocomplete("search", "");
            input.focus();
        });
    },

    destroy: function() {
        this.wrapper.remove();
        this.element.show();
        jQuery.Widget.prototype.destroy.call(this);
    }
 });
})(jQuery);

jQuery(function() {
jQuery("#combobox").combobox();
jQuery("#toggle").click(function() {
    jQuery("#combobox").toggle();
});
});

< /script>​​ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T15:56:23.900

现代浏览器可以开箱即用地做到这一点：

```
<input type="text" placeholder="foo"/> 
```

对于较旧的浏览器，您可以使用此[polyfill](https://github.com/ginader/HTML5-placeholder-polyfill)

**编辑**

当然你可以在 jQuery 中做到这一点，看[这个小提琴](http://jsfiddle.net/timbuethe/qcYNE/)：

```
$('<input/>').attr('placeholder', 'test').appendTo('body') 
```

# internet-explorer - 如何为不受信任的调用者实现 IObjectSafety

> ID：12095492
> 
> 赞同：0
> 
> 时间：2012-08-23T15:47:21.820
> 
> 标签：internet-explorer, com, activex, atl

我有一个使用 ATL 用 C++ 编写的 ActiveX 控件，它有几个不安全的方法（读取和写入文件。）

我查看了[IObjectSafety](http://msdn.microsoft.com/en-us/library/aa768224%28v=vs.85%29)接口，但不清楚是否可以保护单个方法。由于控件主要通过`IDispatch`接口使用，我不希望将整个接口标记为不安全。

是否有关于界面的好教程以及 InternetExplorer 如何使用它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T20:48:41.787

`IObjectSafety`标记接口，而不是单个方法。如果您查看它的语法，您会发现参数不提供标记单个方法的灵活性。

```
HRESULT SetInterfaceSafetyOptions(
    REFIID riid,
    DWORD dwOptionSetMask,
    DWORD dwEnabledOptions
); 
```

另请参阅：[如何 IObjectSafety 将 ATL 控件标记为安全以进行初始化](http://support.microsoft.com/kb/168371)。

# php - 使用 jquery post 发送 jquery 对象

> ID：12095494
> 
> 赞同：-1
> 
> 时间：2012-08-23T15:47:26.557
> 
> 标签：php, javascript, jquery, json, post

我想使用 post 将 jquery 对象发送到 php 函数我的对象进来然后我将它字符串化并获得以下输出

```
[
  {
    "id": "701",
    "user_id": "2",
    "playlist": "ukg%20garage",
    "tracks": "5",
    "thumbnail": "Coldplay.jpeg",
    "createdon": "2012-08-23 16:06:46"
  }
] 
```

所以我然后通过下面的帖子通过这个

```
var sendData = JSON.stringify(data, null, 2);
console.log(sendData);
$.post('<?php echo base_url(); ?>account_media/updateplaylistpicture', sendData, function(response) {

            console.log(response);

          }); 
```

和我的 php 我正在做一个 print_r($_POST) 但它什么也没返回

```
Array
(
) 
```

我哪里错了谢谢

我设法用下面的更新来解决它

```
var sendData = JSON.stringify(data, null, 2);
var sendData = sendData.replace(/[\[\]']+/g,'');
$.post('<?php echo base_url(); ?>account_media/updateplaylistpicture', jQuery.parseJSON(sendData), function(response) {
    console.log(response);
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T15:54:30.063

这很可能是因为 POST 不包含任何“密钥”。尝试这个：

```
print_r(file_get_contents('php://input')); 
```

另一种方法是：

```
$.post('<?php echo base_url(); ?>account_media/updateplaylistpicture', 'my_stuff=' + sendData, function(response) {

            console.log(response);

          }); 
```

# .net - Ionic Zip .NET：字节数组<->字符串

> ID：12095502
> 
> 赞同：0
> 
> 时间：2012-08-23T15:47:47.737
> 
> 标签：.net, string, zip

我在我的 .NET 应用程序中将字符串压缩到字节数组并将字节数组解压缩到字符串。

是否可以检查字节数组是否包含压缩字符串？即我想避免对已经压缩的字符串进行双重压缩或尝试解压缩纯文本。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T16:03:20.503

我可能是错的，但如果我没记错的话，zip 文件/流的前两个字节有一个签名。他们应该永远是`PK`。
您可以轻松检查字节数组的前两个字节，看看它们是否包含 ASCII 值 80 (P) 和 75 (K)

所以假设你的字节数组被称为`data`

```
if(data[0] != 80 && data[1] != 75)
    // Is not already zipped 
```

# python - 在亚马逊上为聊天应用运行 XMPP

> ID：12095507
> 
> 赞同：0
> 
> 时间：2012-08-23T15:48:07.497
> 
> 标签：python, ruby, amazon-ec2, amazon-web-services, xmpp

我正在构建一个 Android IM 聊天应用程序来娱乐。我可以很好地开发 Android 的东西，但我在网络方面不太好，所以我正在考虑在 AWS 服务器上使用 XMPP 来运行实际的 IM 端。我看过我可以使用的 OpenFire 和 ejabberd。有没有人有他们的经验或知道更好的？我主要是在寻找在朋友之间发送直接即时消息以及与朋友一起发送群组即时消息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T16:01:54.013

尝试探索更多有关 Amazon SQS（简单排队服务）的信息。它可能会满足您的要求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T15:56:01.630

作为 ejabberd 的制造商 ProcessOne 的一名员工，我可以告诉你，我们在 AWS 上运行了很多服务，包括移动聊天应用程序。我们已经将我们的程序工业化。

# notepad++ - Notepad ++中将大小写更改为单词边界

> ID：12095519
> 
> 赞同：1
> 
> 时间：2012-08-23T15:48:46.930
> 
> 标签：notepad++

> **可能重复：**
> [Notepad++ 中驼峰大小写单词之间移动的键盘快捷键](https://stackoverflow.com/questions/6862511/keyboard-shortcut-for-moving-between-words-in-camel-case-in-notepad)

是否可以在 Notepad++ 中使用大小写更改作为单词边界？例如，如果光标位于“myVariableFoo”的开头，则将`<CTRL-Right>`光标移动到“Variable”前面，然后移动到“Foo”前面。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T00:55:48.743

您可以通过以下方式设置您喜欢的任何组合键：

`Settings > Shortcut Mapper > Scintilla commands > SCI_WORDPARTLEFT/SCI_WORDPARTRIGHT.`

默认值为`ctrl + \`和`ctrl + /`

# powershell - Powershell 归档脚本

> ID：12095523
> 
> 赞同：0
> 
> 时间：2012-08-23T15:49:11.243
> 
> 标签：powershell

我刚刚开始使用 PowerShell，并借助一本书和大量 Google 搜索的帮助，我想出了这个脚本。我遇到的问题是它没有保留文件夹结构。它正在检查一个网络位置以查找超过 5 天的文件。如果超过 5 天，它会将其移动到不同的网络位置。在第二个位置，它会检查超过 30 天的文件并删除这些文件。

```
$movepath = "C:\test"
$archpath = "C:\test2"
$deletepath = "C:\files"
$movedays = "5"
$deletedays = "30"
$datetime = get-date
$deletelog = "c:\logs\deletelog.txt"
$movelog = "c:\logs\movelog.txt"
$errorlog = "c:\logs\errorlog.txt"

write-progress -activity "Archiving Data" -status "Progress:"

Get-Childitem -Path $movepath -Recurse | Where-Object {$_.LastWriteTime -lt (get-date).AddDays(-$movedays)} |
 ForEach {
$filename = $_.fullname
try
{
Move-Item $_.FullName -destination $archpath -force -ErrorAction:SilentlyContinue
"Moved $filename to $archpath at $datetime successfully" | add-content $movelog
}
catch
{
"Error moving $filename: $_ " | add-content $errorlog
}
}
Get-Childitem -Path $deletepath | Where-Object {$_.LastWriteTime -lt (get-date).AddDays(-$deletedays)} |
ForEach {
$filename = $_.fullname
try
{
Remove-Item $_.FullName -force -ErrorAction:SilentlyContinue
"Removed $filename at $datetime successfully" | add-content $deletelog
}
catch
{
 "Error moving $filename: $_ " | add-content $errorlog
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T16:46:57.387

您需要添加逻辑来维护文件夹结构。

```
$FileName = $_.FullName.Replace($MovePath, $ArchPath); 
```

# perl - 使用 CPAN Perl 安装软件包

> ID：12095528
> 
> 赞同：1
> 
> 时间：2012-08-23T15:49:26.040
> 
> 标签：perl, xampp

我正在尝试使用`Perl`从命令行安装一些库：

```
perl -MCPAN -e "install XML::Tidy" 
```

但是，我无法：

```
Warning (usually harmless): 'YAML' not installed, will not store persistent state
Running Build test
t\00pod.t ..... ok
t\00podc.t .... Can't locate Test/Pod/Coverage.pm in @INC (@INC contains: C:\xam
pp\perl\bin\.cpan\build\XML-Tidy-1.12.B55J2qn-y5sVpz\blib\lib C:\xampp\perl\bin\
.cpan\build\XML-Tidy-1.12.B55J2qn-y5sVpz\blib\arch C:/xampp/perl/lib C:/xampp/pe
rl/site/lib .) at t\00podc.t line 1.
BEGIN failed--compilation aborted at t\00podc.t line 1.
t\00podc.t .... Dubious, test returned 2 (wstat 512, 0x200)
No subtests run
t\00small.t ... Base class package "XML::XPath" is empty.
    (Perhaps you need to 'use' the module which defines that package first,
    or make that module available in @INC (@INC contains: C:\xampp\perl\bin\.cpa
n\build\XML-Tidy-1.12.B55J2qn-y5sVpz\blib\lib C:\xampp\perl\bin\.cpan\build\XML-
Tidy-1.12.B55J2qn-y5sVpz\blib\arch C:/xampp/perl/lib C:/xampp/perl/site/lib .).
 at C:\xampp\perl\bin\.cpan\build\XML-Tidy-1.12.B55J2qn-y5sVpz\blib\lib/XML/Tidy
.pm line 5
BEGIN failed--compilation aborted at C:\xampp\perl\bin\.cpan\build\XML-Tidy-1.12
.B55J2qn-y5sVpz\blib\lib/XML/Tidy.pm line 5.
Compilation failed in require at t\00small.t line 3.
BEGIN failed--compilation aborted at t\00small.t line 3.
t\00small.t ... Dubious, test returned 2 (wstat 512, 0x200)
Failed 15/15 subtests
t\01medium.t .. Base class package "XML::XPath" is empty.
    (Perhaps you need to 'use' the module which defines that package first,
    or make that module available in @INC (@INC contains: C:\xampp\perl\bin\.cpa
n\build\XML-Tidy-1.12.B55J2qn-y5sVpz\blib\lib C:\xampp\perl\bin\.cpan\build\XML-
Tidy-1.12.B55J2qn-y5sVpz\blib\arch C:/xampp/perl/lib C:/xampp/perl/site/lib .).
 at C:\xampp\perl\bin\.cpan\build\XML-Tidy-1.12.B55J2qn-y5sVpz\blib\lib/XML/Tidy
.pm line 5
BEGIN failed--compilation aborted at C:\xampp\perl\bin\.cpan\build\XML-Tidy-1.12
.B55J2qn-y5sVpz\blib\lib/XML/Tidy.pm line 5.
Compilation failed in require at t\01medium.t line 3.
BEGIN failed--compilation aborted at t\01medium.t line 3.
t\01medium.t .. Dubious, test returned 2 (wstat 512, 0x200)
Failed 15/15 subtests
t\02large.t ... Base class package "XML::XPath" is empty.
    (Perhaps you need to 'use' the module which defines that package first,
    or make that module available in @INC (@INC contains: C:\xampp\perl\bin\.cpa
n\build\XML-Tidy-1.12.B55J2qn-y5sVpz\blib\lib C:\xampp\perl\bin\.cpan\build\XML-
Tidy-1.12.B55J2qn-y5sVpz\blib\arch C:/xampp/perl/lib C:/xampp/perl/site/lib .).
 at C:\xampp\perl\bin\.cpan\build\XML-Tidy-1.12.B55J2qn-y5sVpz\blib\lib/XML/Tidy
.pm line 5
BEGIN failed--compilation aborted at C:\xampp\perl\bin\.cpan\build\XML-Tidy-1.12
.B55J2qn-y5sVpz\blib\lib/XML/Tidy.pm line 5.
Compilation failed in require at t\02large.t line 3.
BEGIN failed--compilation aborted at t\02large.t line 3.
t\02large.t ... Dubious, test returned 2 (wstat 512, 0x200)
Failed 15/15 subtests
t\03prune.t ... Base class package "XML::XPath" is empty.
    (Perhaps you need to 'use' the module which defines that package first,
    or make that module available in @INC (@INC contains: C:\xampp\perl\bin\.cpa
n\build\XML-Tidy-1.12.B55J2qn-y5sVpz\blib\lib C:\xampp\perl\bin\.cpan\build\XML-
Tidy-1.12.B55J2qn-y5sVpz\blib\arch C:/xampp/perl/lib C:/xampp/perl/site/lib .).
 at C:\xampp\perl\bin\.cpan\build\XML-Tidy-1.12.B55J2qn-y5sVpz\blib\lib/XML/Tidy
.pm line 5
BEGIN failed--compilation aborted at C:\xampp\perl\bin\.cpan\build\XML-Tidy-1.12
.B55J2qn-y5sVpz\blib\lib/XML/Tidy.pm line 5.
Compilation failed in require at t\03prune.t line 3.
BEGIN failed--compilation aborted at t\03prune.t line 3.
t\03prune.t ... Dubious, test returned 2 (wstat 512, 0x200)
Failed 15/15 subtests

Test Summary Report
-------------------
t\00podc.t  (Wstat: 512 Tests: 0 Failed: 0)
  Non-zero exit status: 2
  Parse errors: No plan found in TAP output
t\00small.t (Wstat: 512 Tests: 0 Failed: 0)
  Non-zero exit status: 2
  Parse errors: Bad plan.  You planned 15 tests but ran 0.
t\01medium.t (Wstat: 512 Tests: 0 Failed: 0)
  Non-zero exit status: 2
  Parse errors: Bad plan.  You planned 15 tests but ran 0.
t\02large.t (Wstat: 512 Tests: 0 Failed: 0)
  Non-zero exit status: 2
  Parse errors: Bad plan.  You planned 15 tests but ran 0.
t\03prune.t (Wstat: 512 Tests: 0 Failed: 0)
  Non-zero exit status: 2
  Parse errors: Bad plan.  You planned 15 tests but ran 0.
Files=6, Tests=2,  0 wallclock secs ( 0.05 usr +  0.05 sys =  0.09 CPU)
Result: FAIL
Failed 5/6 test programs. 0/2 subtests failed.
  PIP/XML-Tidy-1.12.B55J2qn.tgz
  C:\xampp\perl\bin\perl.exe ./Build test -- NOT OK
//hint// to see the cpan-testers results for installing this module, try:
  reports PIP/XML-Tidy-1.12.B55J2qn.tgz
Warning (usually harmless): 'YAML' not installed, will not store persistent stat
e
Running Build install
  make test had returned bad status, won't install without force 
```

事实上，我一直无法安装任何库（`YAML`例如）。我也尝试了某人的建议：

```
perl -MCPAN -e "CPAN::Shell->force(qw(XML::Tidy));" 
```

但是我有同样的结果。有人可以帮我弄清楚如何安装这些软件包吗？我`Perl`在一`Windows 7`台机器上运行。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-23T15:52:01.483

首先修复早期的错误！对和[`XML::Tidy`](https://metacpan.org/module/XML%3a%3aTidy)有明确的依赖关系。您没有安装它们，因此在安装过程的早期一定发生了错误。[`Test::Pod::Coverage`](https://metacpan.org/module/Test%3a%3aPod%3a%3aCoverage)[`XML::XPath`](https://metacpan.org/module/XML%3a%3aXPath)

# ruby-on-rails-3 - 在 Rails 3 ActiveRecord 中按日期汇总记录

> ID：12095531
> 
> 赞同：0
> 
> 时间：2012-08-23T15:49:36.393
> 
> 标签：ruby-on-rails-3, activerecord

我有一个大表，其中有许多共享时间戳的记录。我想得到一个结果集，其中有一列按时间戳求和。我知道您如何可以简单地使用“总和”方法来获取列总数。但是，我需要按日期列分组。这远不那么明显。我知道我可以使用“find_by_sql”，但是编写代码会很糟糕，因为我必须为超过 20 列执行此操作。我认为 AR 必须有一些魔法才能做到这一点，这让我无法理解？

日期设置示例：

表/模型：游戏/游戏

```
player_name, points_scored, game_date
john, 20, 08-20-2012
sue, 30, 08-20-2012
john, 12, 08-21-2012
sue, 10, 08-21-2012 
```

我想在我的结果中看到的是：

```
game_date, total_points
08-20-2012, 50
08-21-2012, 22 
```

以下是 SQL 查询的粗略示例：

```
SELECT game_date, SUM(points_scored)
FROM games
GROUP BY game_date 
```

请注意，我实际上有 20 个“分数”列来按时间戳求和。

我怎样才能简单地使用 AR 来做到这一点？提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T15:14:19.907

行。它需要一些挖掘和玩耍，但我想通了。我希望找到比“find_by_sql”更好的东西，我做到了，但这并没有好多少。同样，知道我需要按时间戳对 20+ 列求和，这是上面示例上下文中的解决方案。

```
results = Game.select( 'game_date, SUM(points_scored) as "points_scored"').group( 'game_date' ) 
```

现在，这看起来还不错，但我必须在“选择”方法中输入 20+ SUM()。不会从“find_by_sql”中节省大量工作，但它可以工作。

# apache - 在 Apache Htaccess 中正确使用 KeepAlive

> ID：12095533
> 
> 赞同：18
> 
> 时间：2012-08-23T15:49:48.597
> 
> 标签：apache, .htaccess, header, keep-alive

有什么区别：

`Header set Connection keep-alive`

和

`KeepAlive on`

在 Apache htaccess 中？

我们必须在 php 文件的标题中放入哪些代码和选项？htaccess 文件中有什么？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2012-08-23T18:12:00.673

如果你只是设置标题`Connection: keep-alive`是不够的。客户端会认为这是一个保持活动连接，但服务器可能会决定关闭连接。此外，客户端不知道通过保活连接可以处理多少个请求。还有一个额外的标头用于跟踪通过保持活动连接发送的请求，如下所示：

```
Keep-Alive: timeout=15, max=100 
```

它告诉客户端它可以在当前保持活动连接上发送多达 100 个请求（并且它会随着您继续使用所述保持活动连接而倒计时），并且客户端有 15 秒的时间在连接关闭。

仅使用标头不足以建立保持活动连接，因为服务器需要对其进行协商。两端都需要知道keep-alive，并且两端都需要做适当的核算。您需要告诉 apache 在其结束时处理 keep-alive，而简单地发送标头不会这样做。您需要使用第二个指令打开 keep-alive：

```
KeepAlive on 
```

此外，您可以使用以下指令调整保活机制：

```
KeepAliveTimeout 15
MaxKeepAliveRequests 100 
```

# wpf - Caliburn.Micro 消息冒泡跳过控件

> ID：12095534
> 
> 赞同：3
> 
> 时间：2012-08-23T15:49:53.633
> 
> 标签：wpf, datacontext, caliburn.micro, event-bubbling, visual-tree

我有一个分层集合，由于它的大小，我延迟加载最低级别。

我试图激活的操作是在 CollectionHolderManager 上，但似乎冒泡由于某种原因跳过了该可视层。

```
<ItemsControl DataContext="{Binding Path=CollectionHolderManager}"
                      ItemsSource="{Binding Path=CollectionTopLevel}">
    <ItemsControl.ItemTemplate>
        <DataTemplate>
            <telerik:RadToolBar cal:Bind.Model="{Binding}">

                <TextBlock x:Name="Name" />

                <ItemsControl ItemsSource="{Binding Path=CollectionMiddleLevel}">
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>

                            <telerik:RadDropDownButton cal:Bind.Model="{Binding}"
                                                               Content="{Binding Path=Name}"
                                                               cal:Message.Attach="[Event DropDownOpened] = [Action GetLowestLevel($dataContext)]">
                                <telerik:RadDropDownButton.DropDownContent>
                                    <telerik:RadListBox SelectionMode="Multiple"
                                                                ItemsSource="{Binding Path=CollectionLowestLevel}">
                                        <telerik:RadListBox.ItemTemplate>
                                            <DataTemplate>

                                                <!-- some template -->

                                            </DataTemplate>
                                        </telerik:RadListBox.ItemTemplate>

                                    </telerik:RadListBox>
                                </telerik:RadDropDownButton.DropDownContent>
                            </telerik:RadDropDownButton>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>
            </telerik:RadToolBar>
        </DataTemplate>
    </ItemsControl.ItemTemplate>
</ItemsControl> 
```

因此，如果我对 TopLevelCollection 执行操作，则会调用它。

如果我在拥有 CollectionHolderManager 的 ViewModel 上有它，它会被调用，但在 CollectionHodlerManager 本身上时不会。为什么要跳过它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-24T10:53:26.417

这么简单的事情，我不敢相信我错过了。

```
<ItemsControl cal:Bind.Model="{Binding Path=CollectionHolderManager}"
              ItemsSource="{Binding Path=CollectionTopLevel}"> 
```

Bind.Model 而不是 DataContext。

# liferay - Liferay：DLFileEntryLocalServiceUtil 和 DLAppLocalServiceUtil 之间的区别？

> ID：12095536
> 
> 赞同：7
> 
> 时间：2012-08-23T15:49:59.573
> 
> 标签：liferay, document, storage, datapersistance

这些服务有什么区别？

```
DLFileEntryLocalServiceUtil 
```

和

```
DLAppLocalServiceUtil 
```

我们什么时候应该使用一个，什么时候使用另一个？DLAppLocal 是 Liferay 6.1 中的一个新接口，它不鼓励旧的 DLFileEntry 用于应用程序级代码吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-08-24T07:09:39.990

> `DLFileEntryLocalServiceUtil`这些服务和有什么区别`DLAppLocalServiceUtil`？

`DLFileEntry`services 和`DLFolderEntry`services 专门用于在 liferay 的数据库中存储文件和文件夹条目，完全不知道6.1 中引入的新[存储库概念。](http://www.liferay.com/web/alexander.chow/blog/-/blogs/7670631)[用户指南](http://www.liferay.com/documentation/liferay-portal/6.1/user-guide/-/ai/lp-6-1-ugen04-repositories-0)和本wiki[解释](http://www.liferay.com/community/wiki/-/wiki/Main/CMIS+Repository)了如何添加新存储库。
如果`DLApp`( `DLAppService`& `DLAppLocalService`) 服务考虑到这些事情，也就是说他们负责在 Liferay 数据库和其他存储库之间同步文档，而不仅仅是在 Liferay 数据库中存储条目。

该类的[文档](http://docs.liferay.com/portal/6.1/javadocs-all/com/liferay/portlet/documentlibrary/service/impl/DLAppLocalServiceImpl.html)[`DLAppServiceImpl`](https://github.com/liferay/liferay-portal/blob/6.1.x/portal-impl/src/com/liferay/portlet/documentlibrary/service/impl/DLAppServiceImpl.java#L61)解释了这一切（这几乎相同[`DLAppLocalServiceImpl`](https://github.com/liferay/liferay-portal/blob/6.1.x/portal-impl/src/com/liferay/portlet/documentlibrary/service/impl/DLAppLocalServiceImpl.java#L47)），以下是文档的摘录：

> 文档库本地服务。所有 portlet 都应通过此类或通过 DLAppServiceImpl 与文档库交互，而不是通过单独的文档库服务类。
> 
> 此类为所有 Liferay 和第三方存储库提供统一的接口。虽然方法签名对所有存储库都是通用的。可以在 serviceContext 中指定其他特定于实现的参数。
> 
> `repositoryId`大多数方法使用的参数是特定存储库的主键。如果存储库是默认 Liferay 存储库，`repositoryId`则为`groupId`或`scopeGroupId`. 否则，repositoryId 将对应于从[`RepositoryLocalServiceUtil`](https://github.com/liferay/liferay-portal/blob/6.1.x/portal-service/src/com/liferay/portal/service/RepositoryLocalServiceUtil.java).

* * *

> DLAppLocal 是 Liferay 6.1 中的新接口吗？

是的

> 这不鼓励旧的 DLFileEntry 用于应用程序级代码？

在某种意义上是的，参考上面的解释。`DlAppLocalServices`使用起来要好得多，因为它的范围比单个文档服务要大得多。尽管如此，如果您想使用这些接口来存储来自您的自定义插件 portlet 的文档和媒体，您可以继续使用这些，我认为应该没有问题，因为即使`DlAppLocalServices`在内部也使用单独的文档服务来存储在 liferay 中存储库。

希望这能为您的问题提供一些相关信息。

# javascript - jQuery 异常，可能与自动完成字段的 AJAX 相关

> ID：12095538
> 
> 赞同：1
> 
> 时间：2012-08-23T15:50:03.067
> 
> 标签：javascript, jquery, ajax, jquery-ui, internet-explorer

我有一个使用 jquery-1.5.2.min.js 运行的应用程序。它在 IE9、8、7、FF 和 Chrome 中运行良好。

但是有这个问题。我在自定义 .js 文件中有一个 JavaScript 函数，它使用 jQuery 来规则隐藏字段的行为。每当单击按钮时，隐藏字段都会变成一个 jQuery Autocomplete 控件，并通过 Ajax 调用加载 Autocomplete 信息。函数是这样的：

```
$.ajax({
        type: "POST",
        url: action,
        dataType: "json",
        data: "{type: '" + control + "', param:" + params + "}",
        contentType: "application/json; charset=utf-8",
        success: function (data) {
            var dataTable = data;
            $(selector).autocomplete({
                minLength: 2,
                source: dataTable,
                open: function (e, ui) {
                    var options = $(this).data('autocomplete');

                    options.menu.element.find('a').each(function () {
                        var this_ = $(this);
                        var regex = new RegExp(options.term, "gi");
                        this_.html(this_.text().replace(regex, function (matched) {
                            return autocompleteTemplate.replace('%s', matched);
                        }));
                    });
                },
                focus: function (event, ui) {
                    $(selector).val(ui.item.label);
                    return false;
                },
                change: function (event, ui) {
                    if (!ui.item) {
                        var options = $(this).data('autocomplete');
                        var matcher = new RegExp("^" + $.ui.autocomplete.escapeRegex($(this).val()) + "$", "i"),
                            valid = false;
                        options.menu.element.find('a').each(function () {
                            if ($(this).text().match(matcher)) {
                                valid = true;
                                return false;
                            }
                        });
                        if (!valid) {
                            if (control == "ProjectType") {
                                $('#selector').val("...");
                                $('#selector').attr('disabled', 'disabled');
                                $('#another.selector').val("");
                            }
                            // Remueve los valores inválidos.
                            $(this).val("");
                            $(selector).val("");
                            $(selector).data("autocomplete").term = "";
                            return false;
                        }
                    }

                    if (control == "ProjectType") {
                        $('#selector').val("");
                    }
                },
                select: function (event, ui) {
                    $(selector).val(ui.item.label);

                    $(hidden).val(ui.item.value);

                    if (control == "ProjectType") {
                        Autocomplete("ProjectSubType", action, ui.item.value);
                        // This is a function that changes the CSS for another HTML control
                        ProjectSubType(false);
                    }
                    return false;
                }
            });
        }
    }); 
```

因此，每当我将浏览器类型从 IE8 更改为 IE7 或 IE9，或从 IE7 更改为 IE8 或 IE9 时，激活此字段后，jquery-1.5.2.min.js 会抛出以下异常

> 来自 Microsoft JScript 的运行时错误：无法获取属性“类型”的值：对象为空或未定义

供参考：

*   AJAX 调用工作。自动完成功能可以正常工作，并在完成时触发必须触发的事件，按照它们必须被触发的顺序。
*   还有另一个控件触发另一个 AJAX 事件（填充 jqGrid），不会产生错误。
*   您在代码中看到的条件子句“if (control == "ProjectType")”意味着如果正在使用的该控件已填写自动完成选项，则允许另一个控件变为自动完成。否则，它被禁用，如您所见（我将其名称更改为“#selector”）。这也可以正常工作：如果您在该自动完成中填写一个值，则另一个控件将填充所需的选项。

谢谢

**UDP**

调用AJAX函数的函数如下：

```
function SetSearchMenu(url, local) {
    $('#advancedSearch').hide();
    $('#advSearch').click(function () {
        if ($('#advancedSearch').css("display") == "none") {
            $('#advancedSearch').show();
            $('#generalSearch').val("...");
            $('#generalSearch').attr('disabled', 'disabled');
            ProjectSubType(true);
        }
        else {
            $('#dAdvancedSearch').hide();
            $('#General').val("");
            $('#General').removeAttr('disabled');
        }

        if (alreadyOpen == false) {
            Autocomplete("SelectorOne", url, null);
            Autocomplete("ProjectType", url, null);
            Autocomplete("Selector", url, local);
            alreadyOpen = true;
        }
    });
} 
```

参数 url 和 local 是从 $(document).ready() 函数发送的，并用字符串格式的 @Url.Action() 和硬编码为一个的另一个变量填充。

# bash - 使用 cUrl 和 Bash 在 URL 上模拟 Java BufferedReader.readLine()

> ID：12095544
> 
> 赞同：1
> 
> 时间：2012-08-23T15:50:32.990
> 
> 标签：bash, curl

我正在处理一个需要向连接发送“\r”以获取下一行进行解析的遗留系统。

使用 Java 很容易：

```
URL url = new URL("http://some.url");
BufferedReader reader = new BufferedReader(new InputStreamReader(url.openStream()));

String line = null;
while ((line = reader.readLine()) != null) {
    System.out.println(line);
} 
```

但是，我的 unix 技能不是很好，所以我什至不知道如何用谷歌搜索这个答案。

很明显，连接保持打开状态，并且期望发送“\r”（这是 BufferedReader.readLine() 方法的来源），但我不知道如何在 bash 中执行此操作（在脚本或提示）。此外，每次搜索都包含 99% 的基于 PHP 的结果。我没有可用的脚本语言，只有 bash。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T16:03:45.307

您可以在 bash 中读取和写入任意 TCP 端口：

```
while read line; do
    ...
done < /dev/tcp/some.url/80

echo $'\r' > /dev/tcp/some.url/80 
```

无论如何，这给了你一些开始；我不声称以上是您问题的完整解决方案。

# php - PHP将单个数组元素合并为唯一数组

> ID：12095545
> 
> 赞同：0
> 
> 时间：2012-08-23T15:50:34.080
> 
> 标签：php, arrays, recursion

我不确定如何处理这个问题的标题，如果有点混乱，很抱歉。

我有一个数组；

```
 Array
  (
      [username] => Array
          (
              [0] => 'a'
              [1] => 'b'
              [2] => 'c'
              [3] => 'd'
              [4] => 'e'
              [5] => 'f'
          )

      [email] => Array
          (
              [0] => 
              [1] => 
              [2] => 
              [3] => 
              [4] => 
              [5] => 
          )

      [level] => Array
          (
              [0] => 1
              [1] => 1
              [2] => 1
              [3] => 1
              [4] => 1
              [5] => 1
          )

      [role] => Array
          (
              [0] => 2
              [1] => 1
              [2] => 1
              [3] => 1
              [4] => 2
              [5] => 1
          )

      [password] => Array
          (
              [0] => 
              [1] => 
              [2] => 
              [3] => 
              [4] => 
              [5] => 
          )

      [id] => Array
          (
              [0] => 1
              [1] => 2
              [2] => 3
              [3] => 4
              [4] => 5
              [5] => 6
          )

  ) 
```

但我想要这种格式：

```
 Array
  (
      [0] => Array
          (
              [username] => 'a'
              [id] => 'a'
              [email] => 'a'
          )
      [1] => Array
          (
              [username] => 'a'
              [id] => 'a'
              [email] => 'a'
          )
      [2] => Array
          (
              [username] => 'a'
              [id] => 'a'
              [email] => 'a'
          )
      [3] => Array
          (
              [username] => 'a'
              [id] => 'a'
              [email] => 'a'
          )
      [4] => Array
          (
              [username] => 'a'
              [id] => 'a'
              [email] => 'a'
          )
      [5] => Array
          (
              [username] => 'a'
              [id] => 'a'
              [email] => 'a'
          ) 
```

我似乎无法弄清楚，数组结束得太快，或者索引太多等等。想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T15:58:17.880

我会遍历数组并像这样重建它：

```
$index_count = count($array['username']); // in your case, this is 6

$new_array = array();
for ($i = 0; $i < $index_count; $i++) {
    $new_array[] = array(
        'username' => $array['username'][$i],
        'email' => $array['email'][$i],
        'id' => $array['id'][$i]
    );
} 
```

**更新**如果您希望这考虑到*任何和所有可能的键*，请尝试以下操作：

```
$keys = array_keys($array);
if (count($keys)) {
    $index_count = count($array[$keys[0]]);

    $myArray = array();
    for ($i = 0; $i < $index_count; $i++) {
        $temp = array();
        foreach($keys as $key) {
            $temp[$key] = $array[$key][$i];
        }
        $myArray[] = $temp;
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T16:40:51.657

一个不同的看法，但这是我要做的 - 一步一步：

首先，让我们拿到钥匙——我们会非常需要它们：

```
$result = array();//<-- this is the result array
$keys = array_keys($array); 
```

然后，我会得到一个空的*模板*数组（有点像模型对象）

```
$base = array_fill_keys($keys,array());
//array('username'=>array,'id'=>array(),... 
```

然后，使用它来构建结果数组：

```
$result = array_fill(0,count($array['username']),$base);
//In one-liner format, it looks like this:
$result = array_fill(0,count($array['username']),array_fill_keys(array_keys($array),array()));
//Works, but is messy as f*** 
```

然后只需填写很多，这就是该`$keys`变量得到回报的地方：

```
$length = count($result);
while ($key = array_shift($keys))
{
    for ($i=0;$i<$length;$i++)
    {
        $result[$i][$key] = $array[$key][$i];
    }
} 
```

请注意，我更喜欢使用 while 循环，因为它更干净并且（略微）更快。更清洁，因为`$keys`随着您的前进，该阵列正在被清空。如果您正在处理大量数据，它有时会产生影响。如果数据集*真的*很大，并且代码已经过彻底测试，您甚至可能需要`shifting`从源数组中考虑（因为它包含所有数据，它比只包含键的数组大得多）：

```
while ($vals = array_shift($array))
{
    $key = array_shift($keys);//<-- keep track of what array has been shifted
    for ($i=0;$i<$length;$i++)
    {
        $result[$i][$key] = $vals[$i];
    }
} 
```

这巧妙地清理了源数组和键。我已经在我的服务器 writecodeonline 和 codepad 上测试了最后一种方法，结果完全相同：

```
$foo = array('bar'=>array_fill(0,2,'ás'),'quar'=>range('a','z'));
$keys = array_keys($foo);
while($vals = array_shift($foo))
{
    $key = array_shift($keys);
    echo $key.' contains: => '.implode(', ',$vals).'<br/>';
} 
```

> 栏包含：=> ás, ás
> 
> quar 包含：=> a、b、c、d、e、f、g、h、i、j、k、l、m、n、o、p、q、r、s、t、u、v、w , x, y, z

# c++ - 用于累积逗号分隔字符串的 C++ 预处理器宏

> ID：12095550
> 
> 赞同：2
> 
> 时间：2012-08-23T15:50:44.290
> 
> 标签：c++, c-preprocessor

我需要执行以下操作：

```
const char* my_var = "Something";
REGISTER(my_var);
const char* my_var2 = "Selse";
REGISTER(my_var2);
...
concst char* all[] = { OUTPUT_REGISTERED }; // inserts: "my_var1, my_var2, ..." 
```

REGISTER 和 OUTPUT_REGISTERED 是预处理器宏。这对于大量字符串（例如〜100）来说非常有用。有可能做到这一点吗？

**PS。**该代码属于 0 级“块”——即它不在任何函数内部。AFAIK，我不能在那里调用常规函数。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T16:01:07.860

```
#include <iostream>
#include <vector>
using namespace std;

vector<const char*>& all()
{
    static vector<const char*> v;
    return v;
}

struct string_register
{
    string_register(const char* s)
    {
        all().push_back(s);
    }
};

#define REGISTER3(x,y,sr) string_register sr ## y(x)
#define REGISTER2(x,y) REGISTER3(x,y,sr)
#define REGISTER(x) REGISTER2(x, __COUNTER__)

REGISTER("foo");
REGISTER("bar");

int main()
{
} 
```

# php - PHP/MySQL INSERT 功能逻辑错误

> ID：12095553
> 
> 赞同：0
> 
> 时间：2012-08-23T15:50:53.847
> 
> 标签：php, postgresql

我最近问了一个关于写入多个表的问题：[PHP/MySQL insert into multiple data tables on submit](https://stackoverflow.com/questions/11672011/php-mysql-insert-into-multiple-data-tables-on-submit/11672152#comment15493725_11672152)

我现在已经尝试了这段代码，实际代码中没有产生错误，但我得到的结果很奇怪。当用户点击注册时，这个“insert.php”页面被调用，代码可以在下面找到。

```
<?php

$username = $_POST["username"];
$password = $_POST["password"]; 
$institution = $_POST["institution"];

$conn = pg_connect("database connection information"); //in reality this has been filled
$result = pg_query($conn, "INSERT INTO institutions (i_id, name) VALUES (null, '$institution') RETURNING i_id");
$insert_row = pg_fetch_row($result);
$insti_id = $insert_row[0];

// INSTITUTION SAVED AND HAS ITS OWN ID BUT NO MEMBER OF STAFF ID

$resultTwo = pg_query($conn, "INSERT INTO staff VALUES (NULL, '$username', '$password', '$insti_id'");
$insert_rowTwo = pg_fetch_row($resultTwo);
$user_id = $insert_rowTwo[0];
// USER SAVED WITH OWN ID AND COMPANY ID
// ASSIGN AN INSTITUTION TO A STAFF MEMBER IF THE STAFF'S $company_id MATCHES THAT OF THE
// INSTITUION IN QUESTION
$update = pg_query($conn, "UPDATE institutions SET u_id = '$user_id' WHERE i_id = '$insti_id'");  

pg_close($conn);

?> 
```

这样做的结果只是浏览器等待服务器响应，但它只是不断地等待。几乎就像我假设的无限循环。没有产生当前错误，所以我认为这可能是逻辑错误。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T17:14:49.470

错误：

*   `RETURNING`第二个语句中缺少子句`INSERT`。

*   `INSERT`也为您的第二个语句提供一个明确的列列表。

*   如果您希望列默认值（串行列？）启动，请不要`NULL`在[`INSERT`语句](http://www.postgresql.org/docs/current/interactive/sql-insert.html)`DEFAULT`中提供。使用关键字或根本不提及该列。

更好的解决方案：

使用自 PostgreSQL 9.1 起可用[的数据修改 CTE](http://www.postgresql.org/docs/current/interactive/queries-with.html#QUERIES-WITH-MODIFYING)可以在一条语句中完成所有操作，并节省到服务器的开销和往返行程。（MySQL 对此一无所知，甚至连普通的 CTE 也不知道）。

`UPDATE`另外，通过重新建模逻辑来跳过。用 检索一个 id [`nextval()`](http://www.postgresql.org/docs/current/interactive/functions-sequence.html)，只用两个`INSERT`语句就可以了。

假设这个数据模型（你应该在你的问题中提供它）：

```
CREATE TABLE institutions(i_id serial, name text, u_id int);
CREATE TABLE staff(user_id serial, username text, password text, i_id int); 
```

这个查询完成了所有工作*：*

```
WITH x AS (
    INSERT INTO staff(username, password, i_id) -- provide column list
    VALUES ('$username', '$password', nextval('institutions_i_id_seq'))
    RETURNING user_id, i_id
    )
INSERT INTO institutions (i_id, u_id, name)
SELECT x.i_id, x.user_id, '$institution'
FROM   x
RETURNING u_id, i_id; -- if you need the values back, else you are done 
```

* * *

### 数据模型

您可能会考虑将数据模型更改为经典的 n:m 关系。将包括这些表和主键：

```
staff (u_id serial PRIMARY KEY, ...)
institution (i_id serial PRIMARY KEY, ...)
institution_staff (i_id, u_id, ...,  PRIMARY KEY(i_id, u_id)) -- implements n:m 
```

您可以随时定义`institution_staff.i_id UNIQUE`，如果一个用户只能属于一个`institution`。

# javascript - 更改控制组活动按钮主题

> ID：12095559
> 
> 赞同：2
> 
> 时间：2012-08-23T15:51:04.493
> 
> 标签：javascript, jquery, mobile, jquery-mobile

我有一个`controlgroup`并且我正在动态添加和删除`ui-btn-active`类来切换活动按钮。按钮切换得很好，但我似乎找不到更改活动按钮主题的方法。

> 我希望非活动按钮使用`**d**`主题，活动按钮使用`**a**`主题。
> 
> 有谁知道我该怎么做？

![在此处输入图像描述](../Images/8f530b6fb3a4f9b7ccdfb633fd256237.png)

**HTML：**

```
<div data-role="controlgroup" data-type="horizontal">
    <a href="#" data-role="button" data-inline="true" data-mini="true" id="myApptBtn">My Appointments</a>
    <a href="#" data-role="button" data-inline="true" data-mini="true" id="allApptBtn">All Appointments</a>
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T19:34:11.547

好的，这就是我最终要做的。

**jQuery：**

```
$('[data-role="page"]').live('pageshow', function () {
    $('#myApptBtn').addClass('ui-btn-active');

    $('#myApptBtn').click(function () {
        $('#allApptBtn').removeClass('ui-btn-active');
        $('#myApptBtn').addClass('ui-btn-active');
    });

    $('#allApptBtn').click(function () {
        $('#myApptBtn').removeClass('ui-btn-active');
        $('#allApptBtn').addClass('ui-btn-active');
    });
}); 
```

**HTML：**

```
<li data-theme="d" class="li-state-small" style="text-align: center;">
    <div data-role="controlgroup" data-type="horizontal" class="btnFontSize12">
        <a href="#" data-role="button" data-inline="true" data-mini="true" id="myApptBtn">My Appointments</a>
        <a href="#" data-role="button" data-inline="true" data-mini="true" id="allApptBtn">All Appointments</a>
    </div>
</li> 
```

**回答问题：**

事实证明，您不能通过标记覆盖主题。

[**全局“活动”状态**](http://jquerymobile.com/test/docs/api/themes.html)

> jQuery Mobile 框架使用一个名为“活动”的样本（默认主题中为亮蓝色）来一致地指示选定状态，而不管给定小部件的各个样本。每当需要指示当前选择的内容时，我们将其应用于导航和表单控件。因为这个主题样本是为清晰、一致的用户反馈而设计的，所以它不能被标记覆盖；它在主题中设置一次，并在需要选择或活动状态时由框架应用。此状态的样式位于 ui-btn-active 样式规则下的主题样式表中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T16:45:37.927

您可以使用jQuery 的`.addClass`和`.removeClass`函数来执行此操作。只需在 jQuery 的帮助下设置活动和非活动类并在点击时更改它们。

这是示例。我不是 jQuery 专业人士，但这工作正常：[**示例**](http://jsfiddle.net/TwPzG/)

# c - OpenMP 和 C 并行 for 循环：为什么我的代码在使用 OpenMP 时会变慢？

> ID：12095564
> 
> 赞同：9
> 
> 时间：2012-08-23T15:51:43.073
> 
> 标签：c, gcc, openmp

我是这里的新手，也是 C 语言的初级程序员。我在使用 openmp 加速 for 循环时遇到了一些问题。下面是一个简单的例子：

```
#include <stdlib.h>
#include <stdio.h>
#include <gsl/gsl_rng.h>
#include <omp.h>

gsl_rng *rng;

main()
{
int i, M=100000000;
double tmp;

/* initialize RNG */
gsl_rng_env_setup();
rng = gsl_rng_alloc (gsl_rng_taus);
gsl_rng_set (rng,(unsigned long int)791526599);

// option 1: parallel        
  #pragma omp parallel for default(shared) private( i, tmp ) schedule(dynamic)
  for(i=0;i<=M-1;i++){
     tmp=gsl_ran_gamma_mt(rng, 4, 1./3 );
  }

// option 2: sequential       
  for(i=0;i<=M-1;i++){
     tmp=gsl_ran_gamma_mt(rng, 4, 1./3 );
  }
} 
```

该代码从 Gamma 随机分布中提取 M 次迭代。事实证明，使用 openmp 的并行方法（选项 1）大约需要 1 分钟，而顺序方法（选项 2）只需 20 秒。使用 openmp 运行时，我可以看到 CPU 使用率为 800%（我使用的服务器有 8 个 CPU）。系统是带有GCC 4.1.3的linux。我正在使用的编译命令是 gcc -fopenmp -lgsl -lgslcblas -lm （我正在使用 GSL ）

难道我做错了什么？请帮我！谢谢！

PS 正如一些用户所指出的，它可能是由 rng 引起的。但即使我更换

```
tmp=gsl_ran_gamma_mt(rng, 4, 1./3 ); 
```

说

```
tmp=1000*10000; 
```

问题仍然存在...

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-23T15:58:54.697

`gsl_ran_gamma_mt`可能会锁定`rng`以防止并发问题（如果没有，您的并行代码可能包含竞争条件，因此会产生错误的结果）。然后解决方案是`rng`为每个线程设置一个单独的实例，从而避免锁定。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-23T15:58:57.407

您的`rng`变量是共享的，因此线程正在花费所有时间等待能够使用随机数生成器。给每个线程一个单独的 RNG 实例。这可能意味着使 RNG 初始化代码也并行运行。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-23T18:23:25.413

再次感谢大家的帮助。我刚刚发现如果我摆脱

```
schedule(dynamic) 
```

在代码中，问题消失了。但这是为什么呢？

# c++ - 如何添加 2 个四位 Hexa 以生成 ASCII 字符字节

> ID：12095565
> 
> 赞同：0
> 
> 时间：2012-08-23T15:51:48.897
> 
> 标签：c++

我有一个来自源的二进制文件，我必须从中检索数据，以便以人类可读的形式读取它。我已经检索了数据并将其保存在 4 位十六进制中。例如，文件大小为 256 字节，我以六进制检索它并获得 512 个 4 位六进制值。现在，为了使其成为人类可读的 ASCII 字符，我必须添加两个 4 位十六进制来生成一个字节。我以十六进制格式检索数据的方式是

```
byte = read_buffer[i];

// Convert the Most Significant nibble for first byte
write_buffer_hex[(i + 1) * 2 + 0] = hex_chars[(byte >> 4)];

// Convert the Least Significant nibble for the first byte
write_buffer_hex[(i + 1) * 2 + 1] = hex_chars[byte & 0x0f]; 
```

现在，我的问题是我应该如何添加这两个十六进制值以获得 ASCII 值。我现在正在做的就是添加这两个，但它是正确的方法吗？？。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T16:03:47.237

我同意约翰的观点，直接以十六进制输出可能更容易，如下所示：

```
printf("%x", byte); 
```

或使用 C++ 的 IOstream 库：

```
cout << hex << byte; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T16:03:16.213

使用查找表：

```
static char const alphabet[] = "0123456789ABCDEF";

// Loop:

output[cursor++] = alphabet[byte % 16];
output[cursor++] = alphabet[byte / 16]; 
```

您也可以直接索引到字符串中：

```
output[cursor++] = "0123456789ABCDEF"[byte % 16]; 
```

# php - 如何使用 PHP 获取直到午夜的小时数

> ID：12095566
> 
> 赞同：5
> 
> 时间：2012-08-23T15:51:49.853
> 
> 标签：php, math, datetime, timestamp, equation

**场景：**一条记录​​被输入到数据库中。

**我试图找出以下等式：**

1.  如何获取自添加记录以来的小时数。
2.  如何获取自添加记录以来距离午夜还有多少小时。

**鉴于这些时间：**

*   日期/时间：2012-08-22 20:11:20
*   时间戳：1345684280
*   今晚午夜：2012-08-23 00:00:00
*   午夜时间戳：1345698000

我觉得我在正确的轨道上。只需要一些适当的数学来进行计算吗？我的数学很糟糕。任何帮助或指导将不胜感激。我不是在找人来帮我完成这个。只是寻找关于我做错了什么的建议，或者我如何能做得更好。也许解释实现我的目标所必需的数学公式。

**这是我到目前为止所拥有的：**

```
class tools{

    public function __construct(){
    }

    public function check_time($time, $request){
        $time = strtotime($time);
        if($request == 'since'){
            $theTime = time() - $time;
            $prefix = 'Since:';
        } elseif($request == 'until'){
            $midnight = mktime(0, 0, 0, date('n'), date('j'), date('Y'));
            $theTime = $midnight - $time;
            $prefix = 'Until:'; 
        }

        $tokens = array (
            31536000 => 'year',
            2592000 => 'month',
            604800 => 'week',
            86400 => 'day',
            3600 => 'hour',
            60 => 'minute',
            1 => 'second'
        );

        foreach($tokens as $unit => $text){
            if($theTime < $unit) continue;
            $duration = floor($theTime / $unit);
            return $prefix.' '.$duration.' '.$text.(($duration>1)?'s':'');
        }
    }
}// EoF tools class

$tools = new tools();

print_r($tools->check_time('2012-08-22 20:11:20', 'since'));
print_r($tools->check_time('2012-08-22 20:11:20', 'until')); 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-24T00:47:52.630

这里的解决方案非常简单。有一个小错误会导致您的所有问题。

在您的代码中，您可以使用它来计算午夜。

```
$midnight = mktime(0, 0, 0, date('n'), date('j'), date('Y')); 
```

这是不正确的，因为它使用的是今天的午夜（这本来是今天的 00:00，但从现在开始的几个小时前。你想要明天的午夜，因为它被认为是 24 小时时间的 00:00 并且是明天。正确方法是这样的：

```
$midnight = strtotime("tomorrow 00:00:00"); 
```

请记住，strtotime() 的所有内容都基于 GMT，因此请确保在文件/应用程序中设置默认时区。

我希望我的回答很清楚，并解释了为什么您发布的代码是错误的以及如何修复它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-23T16:01:18.097

也许是这样的？我不得不承认没有完全理解你想要的输出是什么：

```
$d1 = new DateTime('2012-08-22 20:11:20');                                                                                          
$d2 = new DateTime('2012-08-23 00:00:00');

$interval = $d1->diff($d2);

echo $interval->format('%h hours %i minutes and %s seconds'); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-10-16T13:01:59.780

好，易于：

```
$timeLeft = 86400 - (time() - strtotime("today"));
echo date("H:i:s", $timeLeft); 
```

`86400`是一天的初始时间。
`time()`是当前时间。
`strtotime("today")`是这一天的开始时间。

`date("H:i:s", $timeLeft)`用于以小时、分钟和秒为单位的格式。

更短的方式：

```
date("H:i:s", strtotime("tomorrow") - time()) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-23T16:07:42.680

午夜不超过第二天没有指定时间最好的方法必须是：

```
<?php
$datetime1 = new DateTime(date('Y-m-d H:i:s'));//current datetime object
$datetime2 = new DateTime(date('Y-m-').date(d));//next day at midnight
$interval = $datetime1->diff($datetime2);//diference
echo $interval->format('H');printing only hours (same as date format)
?> 
```

如果您想了解更多信息：[php date_diff](http://www.php.net/manual/fr/datetime.diff.php)

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-08-23T15:58:17.613

你可以试试这个：

```
$now = strtotime('2012-08-22 20:11:20');
$midnight = strtotime('2012-08-23 00:00:00');
$difference = $midnight - $now;

echo date("H:i:s", $difference); 
```

# easymock - 使用 PowerMock + EasyMock 模拟最终方法

> ID：12095568
> 
> 赞同：6
> 
> 时间：2012-08-23T15:51:56.427
> 
> 标签：easymock, powermock

我试图模拟对 final 方法的调用`ResourceBundle.getString()`。使用 PowerMock 1.4.12 和 EasyMock 3.1，调用不会被模拟；而是调用“真实”方法。

我的测试课：

```
@RunWith(PowerMockRunner.class)
@PrepareForTest(ResourceBundle.class) 
public class TestSuite {
    @Before
    public void setUp() throws Exception {
        ResourceBundle resourceBundleMock = PowerMock.createNiceMock(ResourceBundle.class);
        expect(resourceBundleMock.getString(BundleConstants.QUEUE)).andReturn("Queue");
        PowerMock.replay(resourceBundleMock);

        beanBeingTested.setMessages(resourceBundleMock);
    }
    ...
} 
```

BeanBeingTested 中的代码：

```
private ResourceBundle messages;
...
String label = messages.getString(BundleConstants.QUEUE); 
```

错误信息：

```
java.util.MissingResourceException: Can't find resource for bundle $java.util.ResourceBundle$$EnhancerByCGLIB$$e4a02557, key Queue
at java.util.ResourceBundle.getObject(ResourceBundle.java:384)
at java.util.ResourceBundle.getString(ResourceBundle.java:344)
at com.yoyodyne.BeanBeingTested.setUpMenus(BeanBeingTested.java:87) 
```

当我逐步完成测试用例时，调试器将类型显示`beanBeingTested.messages`为“EasyMock for class java.util.ResourceBundle”，因此模拟被正确注入。（此外，在设置过程中调用`getString()`内部调用没有错误）。`expect()`

使用普通模拟而不是漂亮模拟，我收到以下错误：

```
java.lang.AssertionError: 
  Unexpected method call handleGetObject("Queue"): 
    getString("Queue"): expected: 1, actual: 0 
```

知道我做错了什么吗？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-29T14:04:23.140

您正在 使用 EasyMock创建一个*实例。*相反，在使用静态方法时，您必须模拟*类*（使用 PowerMock）。

它应该是这样工作的（不过用 EasyMock 3.0 和 PowerMock 1.5 测试过）：

```
@RunWith(PowerMockRunner.class)
@PrepareForTest(ResourceBundle.class) 
public class TestSuite {
    @Before
    public void setUp() throws Exception {
        // mock the class for one method only
        PowerMock.mockStaticNice(ResourceBundle.class, "getString");

        // define mock-behaviour on the class, when calling the static method
        expect(ResourceBundle.getString(BundleConstants.QUEUE)).andReturn("Queue");

        // start the engine
        PowerMock.replayAll();
    }
} 
```

（我知道这个问题已经存在几个月了，但它可能对其他人有所帮助）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T01:18:41.740

尝试使用：

```
@PrepareForTest({ResourceBundle.class, BeanBeingTested.class}) 
```

只有在 PrepareForTest 中使用 ResourceBundle，当直接从您的单元测试方法调用时，模拟将起作用，但是当从 BeanBeingTested 调用时，您会得到正在使用的真实方法。

这方面缺乏 Powermock 文档。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T17:27:18.547

为什么还要嘲笑对资源包的调用？通常，我尽量避免嘲笑 java 的具体细节，例如 ArrayList、Date 等。资源包（和 MessageFormat.format()）对我来说或多或少属于同一类别。他们通常在基本的字符串上操作，如果这些东西被破坏或改变它们的行为足以破坏测试，那绝对是我想知道的:)

让他们抓住字符串（大概是在 UI 中设置，可能在 之后。不要费心断言返回的值，因为您不希望对包的编辑破坏您的测试。如果字符串被设置在模拟 UI 组件上，这是 anyObject(String.class) 的好地方，它正确地表达了您（可能）实际上并不关心显示的特定字符串的事实。

当测试由于缺少消息密钥而失败时，我也认为这是一个好处。我想知道的。

# ios - 不同的崩溃报告但同样的崩溃？

> ID：12095578
> 
> 赞同：0
> 
> 时间：2012-08-23T15:52:33.113
> 
> 标签：ios, crash, crash-reports, debug-symbols, symbolicatecrash

我在理解我从 Apple 获得的这两个崩溃报告的一些事情时遇到了问题：

```
Exception Type:  EXC_BAD_ACCESS (SIGSEGV)
Exception Codes: KERN_INVALID_ADDRESS at 0x617401fa
Crashed Thread:  0
0   app                     0x0017c0ca Json::parse(int, JSON_value_struct const*) + 378
1   app                     0x0017bf46 Json::parse(void*, int, JSON_value_struct const*) + 2
2   app                     0x001302d2 JSON_parser_char + 2070
3   app                     0x0017bb58 Json::parse(std::string const&) + 356
4   app                     0x0008e682 NotificationData::ProcessNotifications(std::vector<UserEvent, std::allocator<UserEvent> >&) + 1062
5   app                     0x00106aea SMS::CheckNotifications() + 106
6   app                     0x001073dc SMS::update(Rex::TimeData const&) + 936
7   app                     0x00192c7e SceneManager::updateTick(TimeData const&) + 314
8   app                     0x001685ae Core::onRender(TimeData const&) + 522 
```

和

```
Exception Type:  EXC_BAD_ACCESS (SIGSEGV)
Exception Codes: KERN_INVALID_ADDRESS at 0xffff0202
Crashed Thread:  0
0   app                     0x0017c0ca 0x1000 + 1552586
1   app                     0x0017bf46 0x1000 + 1552198
2   app                     0x001302d2 0x1000 + 1241810
3   app                     0x0017bb58 0x1000 + 1551192
4   app                     0x0008e682 0x1000 + 579202
5   app                     0x00106aea 0x1000 + 1071850
6   app                     0x001073dc 0x1000 + 1074140
7   app                     0x00192c7e 0x1000 + 1645694
8   app                     0x001685ae 0x1000 + 1471918 
```

首先是一些事实：据说第一次发生的几率为 40%，第二次发生率为 35%。如果这是真的，那对我来说是一件好事。

根据我读到的关于这些东西的内容，我的推理是它们是相同的，因为函数的内存地址完全相同，只是 0x617401fa 处的**KERN_INVALID_ADDRESS**和 0xffff0202 处的**KERN_INVALID_ADDRESS**不同，这是可以预期的，因为函数正在写入磁盘上的一些损坏文件

我的**第一个**问题是为什么崩溃报告有时是象征性的（或部分象征性的）而其他时候不是？（我刚刚开始分析它们，我们的构建系统没有保存为每个构建生成的 dSYM 文件，所以我不能做太多关于符号化第二个的事情）

第二**个**问题是崩溃报告怎么可能来自用户的符号化？当我查看项目时，已发布版本的设置如下：对于ALL_BUILDS， **GCC_GENERATE_DEBUGGING_SYMBOLS**设置为**NO**，并且目标应用程序级别 debug_information 设置为 dSYM 文件相形见绌，生成调试符号设置为 No。（侧面问题：使用这些设置构建时，不会生成 dSYM，但如果我从 cMake(...) 神奇地将 GCC_GENERATE_DEBUGGING_SYMBOLS 设置为 true，则会生成 dSYM。当我阅读目标级别设置时，会覆盖构建级别设置）

对不起，很长的帖子，这是我的第一个。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T18:02:27.030

关于事实：这是 40% 的 iTunes 崩溃！到目前为止，并非您的应用程序都有所有崩溃。iTunes Connect 仅显示来自设备的崩溃，用户在设置设备时确实同意发送匿名使用数据（因为稍后可以在设置应用程序中深入更改 iOS 5）。只有一小部分用户启用了这一点，因为他们不想被跟踪。在 iOS5 之前的系统上，只有在设备与 iTunes 同步后才会发送崩溃报告。

简而言之：iTunes Connect 上的崩溃报告不会让您真正了解崩溃报告。以下是来自 Camera+ 开发人员的关于这一事实的示例博客文章：http: [//taptaptap.com/blog/cameraplus-2-3-1-available-attack-of-the-crashinator/](http://taptaptap.com/blog/cameraplus-2-3-1-available-attack-of-the-crashinator/)

这两个崩溃报告是相同的，你是对的。

**问题 1：**设备上的所有崩溃报告均未符号化地发送给 Apple。符号发生在 Apple 的服务器上。而且由于他们仍然会收到大量的崩溃报告（即使只是真正发生的一小部分），他们只象征着每组 1 个报告以减少服务器上的负载。

第二个的符号将显示与第一个相同的结果，因为内存地址是相同的。

**问题 2：** Apple 使用应用程序二进制文件中的符号，如果它们没有被剥离的话。他们不使用 dSYM，也没有或不想要它。这种方式的缺点：您不会获得行号，并且二进制可执行文件要大 30-50%。相关的构建设置是`COPY_PHASE_STRIP`. 我假设`NO`在你的情况下设置为。

关于设置级别：在 Xcode 中选择项目，然后选择目标，查看构建设置不是作为，`Combined`而是作为`Levels`. 最左边的值（已解决的列）是正在使用的值。如果您在 .xcconfig 文件中使用构建设置，它们通常是在项目级别的构建配置中设置的，如果设置不同，目标会覆盖这些设置。

# javascript - Twitter Bootstrap scrollspy 总是选择最后一个元素

> ID：12095579
> 
> 赞同：32
> 
> 时间：2012-08-23T15:52:34.347
> 
> 标签：javascript, jquery-plugins, twitter-bootstrap

我在这个小提琴中重新创建了 scrollspy 的问题：http: [//jsfiddle.net/jNXvG/3/](http://jsfiddle.net/jNXvG/3/)

从演示中可以看出，无论滚动位置如何，ScrollSpy 插件始终保持最后一个菜单项被选中。我已经阅读了其他问题和答案，并尝试了`offset`等的不同组合，但没有一个有帮助。我不知道出了什么问题。

我不想编辑我的模板以包含丑陋的 html“数据”标签，所以我`scrollspy()`通过 JavaScript 调用来激活插件。

下一步是删除固定的内容高度并在侧边栏上使用[“附加”](http://twitter.github.com/bootstrap/javascript.html#affix)。

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2013-04-08T23:43:41.400

我遇到了完全相同的问题，对我来说，**添加** `height: 100%`到 body 元素是解决方法。

（严格来说，似乎没有其他东西可以使它起作用）

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2012-08-25T20:11:15.927

您需要将 ScrollSpy 附加到将触发滚动事件的元素，而不是将反映滚动位置的菜单：

```
$('#content').scrollspy();​ 
```

### [JSFiddle](http://jsfiddle.net/mmfansler/9Lgx4/embedded/result/)

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2012-11-20T22:13:02.263

仅供参考：为了获得我想要的效果（与 Twitter Bootstrap 文档页面上的效果相同），我需要将“body”设置为我的目标元素......我无法通过使用我的元素的直接父元素来让滚动监视工作想以间谍为目标。

（它总是自动选择我的最后一个元素）

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2012-12-05T17:17:18.643

就我而言，Firefox 总是选择最后一个元素，而不是

```
height:100%; 
```

在导致问题的身体上（因为我没有类似的东西）。

那是个

```
position:absolute; 
```

在容器 div 上。

希望它可以帮助那里的人...

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2015-03-05T14:47:23.923

我使用身高 100% 修复了它，但它在 Firefox 上不起作用。在浪费了这么多时间之后，在 github 页面上找到了答案。将高度 100% 应用于 HTML 标记修复了 Chrome 和 Firefox 的问题。

[https://github.com/twbs/bootstrap/issues/5007](https://github.com/twbs/bootstrap/issues/5007)

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2013-09-10T16:43:17.780

在调用 scrollspy 方法时，您通常会指定 body 标记和 nav 元素。

```
<script>
        $(function() {
            $('body').scrollspy({ target: '#faq_sidebar' });
        });
</script> 
```

上面的 JavaScript 等价于：

```
<body data-spy="scroll" data-target="#faq_sidebar"> 
```

唯一不指定 body 标记的情况是，如果您想使用[上面的 JSFiddle](http://jsfiddle.net/mmfansler/9Lgx4/)中的嵌套滚动条跟踪元素。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2016-11-07T22:59:49.020

如果上述建议没有解决其他人的问题，请尝试添加`<!DOCTYPE html>`到页面的第一行。这是一个简单的步骤，为我解决了问题。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2012-11-15T07:40:46.323

我有同样的问题；`height: 100%`从`<body>`元素中删除 为我解决了这个问题。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2013-04-09T19:24:58.620

I had a similar issue where scroll spy would not work on anything but a body tag so I actually went into the bootstrap js found the Scroll spy (SCROLLSPY CLASS DEFINITION) section and changed this line:

> , $element = $(element).is('body') ? $(window) : $(element)

to this:

> , $element = $(element).is('body') ? $(window) : $(window) //$(element)

(note that the element after the // is a comment so I don't forget I changed it)

And that fixed it for me.

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2014-04-23T14:49:59.120

ScrollSpy 非常无情，至少可以说文档很少……根据您的实现，对此有不同且相互冲突的修复……

嵌套内容是我的问题。这为我修复了它：

(1) 确保您的导航中的所有 href 与您监视的目标容器中的相应 ID 匹配。

（2）如果您监视的内容容器中的项目是嵌套的，那么它将不起作用......

**这个：**

```
<ul class="nav" id="sidebar">
  <li>
     <a href="#navItem1" />
  </li>
  <li>
     <a href="#navItem2" />
  </li>
</ul>
<div id="spiedContent"> <!-- nested content -->
   <div id="navItem1">
      <div id="navItem2"></div>
   </div>    

</div> 
```

**对此：**

```
<ul class="nav" id="sidebar">
  <li>
     <a href="#navItem1" />
  </li>
  <li>
     <a href="#navItem2" />
  </li>
</ul>
<div id="spiedContent"> <!-- flat content -->
   <div id="navItem1"></div>    
   <div id="navItem2"></div>
</div> 
```

都好！

我的猜测是，如果您查看 scrollspy 代码，它不会越过间谍容器的第一个孩子的 id。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-06-10T09:08:04.923

我认为这可能是 ScrollSpy 中的一个错误。

我也遇到了同样的问题，当我单步执行代码时，我可以看到所有目标的偏移量都是相同的（-95px）。我检查了这些设置的位置，它正在使用 position() 函数。这将返回元素相对于父元素偏移量的位置。

我将其更改为使用 offset() 函数。此函数返回元素相对于页面偏移量的位置。一旦我这样做了，它就会完美地工作。不知道为什么这不是默认行为。

position() 函数在我的情况下不起作用的原因是因为我必须有一个空的 div，它实际上绝对位于其容器顶部上方 95px 处。我需要这个作为我的目标，这样标题就不会隐藏在固定在页面顶部的标题后面。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2013-01-09T19:23:07.493

确保您没有混合实现。`$('#content).scrollspy()`如果您`data-spy="scroll" data-target=".bs-docs-sidebar"`的身体标签上有，则不需要。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2021-02-23T09:24:45.270

您不必调用方法 scrollspy()。你也不需要在任何地方设置高度：100%。

所有你需要的是：

1.  **位置：相对；**身体用
2.  将 data-bs-spy="scroll" 添加到您的内容或正文
3.  添加带有导航栏 ID 的 data-bs-target

[https://i.imgur.com/M5jib0t.png](https://i.imgur.com/M5jib0t.png)

它帮助到我。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2016-12-14T21:46:53.267

当我试图弄清楚这个问题时，我使用了 Mehdi Benadda 所说的一些内容并将其添加`position: relative;`到`body`. 我将此添加到样式表中：

```
body {
  position: relative;
  height: 100%;
} 
```

希望这对将来的某人有所帮助。

# c++ - 使用 TerminateProcess 终止“mstsc.exe”进程时出现错误代码 (5) 访问被拒绝

> ID：12095581
> 
> 赞同：5
> 
> 时间：2012-08-23T15:52:36.033
> 
> 标签：c++, windows, winapi

我使用该`CreateProcess()`功能使用“mstsc.exe”启动 rdp 客户端应用程序。之后，我想终止它，所以我使用`TerminateProcess()`函数，但它失败，错误代码为 5。如果我用“notepad.exe”替换“mstsc.exe”，终止函数可以工作。代码如下：

```
TCHAR szCommandLine[] = TEXT("mstsc.exe");
STARTUPINFO si = {sizeof(si)};
PROCESS_INFORMATION pi;
BOOL bResult = CreateProcess(NULL, szCommandLine, NULL, NULL,
    FALSE, NORMAL_PRIORITY_CLASS, NULL, NULL, &si, &pi);
::Sleep(3000);
if (TerminateProcess(pi.hProcess, 0) == 0) {
printf("failed: %d", GetLastError());
} 
```

任何人都可以帮助解释并解决它吗？我观察到的是`pi`返回的 pid 与在 taksmanager 或“进程资源管理器”中观察到的进程“mstsc.exe”的 id 不同。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T16:02:40.563

在终止另一个进程之前，您必须获得该特权。

尝试这个：

```
void UpdatePrivilege(void)
{
    HANDLE hToken;
    TOKEN_PRIVILEGES tp;
    LUID luid;

    if(OpenProcessToken(GetCurrentProcess(), TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY,&hToken))
    {
       LookupPrivilegeValue(NULL,SE_DEBUG_NAME, &luid);

       tp.PrivilegeCount = 1;
       tp.Privileges[0].Luid = luid;
       tp.Privileges[0].Attributes = SE_PRIVILEGE_ENABLED; 

       AdjustTokenPrivileges(hToken, FALSE, &tp, sizeof(TOKEN_PRIVILEGES), NULL, NULL);
    }
} 
```

在调用 TerminateProcess 之前调用此函数。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-23T15:56:26.273

您的主机进程是 32 位的并且您在 64 位窗口上运行吗？

如果是这样，您正在调用 32 位 mstsc 并且它正在生成 64 位版本，因此 PID 不同。看看[这个线程](http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/22c10140-a502-4aa1-98d3-3607b8b573e8/)

# ajax - 检测网站是否通过 iframe 访问？将小部件嵌入购物车

> ID：12095586
> 
> 赞同：6
> 
> 时间：2012-08-23T15:52:48.840
> 
> 标签：ajax, iframe, e-commerce

我有一个购物车，我想在其他用户网站上嵌入一个小部件/iframe，我看到了三种方法，每种方法都有缺点。以下是从估计最多到最少工作的选项。

1.  在 javascript 小部件中重新创建交互式购物车 UI，然后使用 AJAX 将值传递给服务器脚本，变量被传递到主站点，当用户单击“结帐”时，用户将被重定向到主购物车站点，其中的变量由输入的内容填充小部件。

    *   **优点：**完整的经验
    *   **缺点：**完成创建 UI 和 AJAX 请求的大部分工作。

2.  以某种方式检测用户是否通过 iframe 进入购物车，如果是这种情况，当用户单击“结帐”时，备用代码会打开新窗口，将用户重定向到安全页面并通过 AJAX 从购物车中获取变量以填充最终结帐。

    *   **优点：**工作量中等，必须执行 AJAX 请求才能从购物车中获取变量以填充最终结帐
    *   **缺点：**我们是否可以轻松检测是否正在从另一个站点的 iframe 中的用户访问站点？

3.  在 iframe/widget 中完成整个结帐过程。

    *   **优点：**工作量最少，只需将购物车嵌入 iframe
    *   **缺点：**不会在浏览器中显示 https 用户可能不愿意购买

什么是最好的选择？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-27T09:48:36.817

如果您可以提供更多信息，也许我可以为您提供更好的选择。首先，你用什么（语言/框架）构建了这个应用程序？另外，您是否会说您的应用程序的功能与 Shopify 的功能相似，因为您允许用户通过您的服务托管电子商务网站？如果没有，请告诉我们更多关于您的申请的信息。

这是对您提供的选项的快速回复。

**选项1：**我认为唯一真正的选择。无论您是将购物车嵌入特定的 iframe 中，还是将其作为模板的一部分呈现到用户页面上，您都应该将*客户*导航到您的主站点以完成结帐过程。或者至少给他们很多屏幕空间来使用（例如一个相当大的模式）。

**选项2：**很乱。您可以通过附加 url 参数来判断请求是否来自远程表单（如 iframe）。但是采用您建议的方法并没有太大意义。

**选项 3：**太重了，除非您采用我在回应选项 1 时提到的模态方法。

话虽如此，如果您正在构建像 Shopify 这样的应用程序，您应该能够为每个用户的网站构建一个模板，该模板有一个部分专门用于显示与当前客户会话相关的购物车。这种方法不需要 iframe 或小部件。但同样，这一切都取决于您的应用程序的用例。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-02T22:22:47.147

如果您对选项 2 的唯一关注是检测您的内容是否在 iframe 中加载，您可以使用 JavaScript 执行此操作，方法是使用“top.frames.length”或[“top === self”。](https://stackoverflow.com/questions/326069/how-to-identify-if-a-webpage-is-being-loaded-inside-an-iframe-or-directly-into-t)

例如，您可以使用以下命令显示或隐藏不同的条件表单内容或不同的提交按钮：

```
if (top.frames.length == 0) {
    // Show content if not embedded in an iframe.
    document.getElementById('embedded-content').style.display = "none";
    document.getElementById('unembedded-content').style.display = "block";
}
else {
    // Show content if embedded in an iframe.
    document.getElementById('embedded-content').style.display = "block";
    document.getElementById('unembedded-content').style.display = "none";
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-03T06:43:33.397

正如您所说，第一个选项在用户体验方面是最好的，并且最有可能实现最高的转化率。与下一个最佳解决方案相比，转化率有多好无法客观衡量，因为它涉及经常性客户、您自己的品牌名称、产品种类等。由于转化率将直接影响您（和您的公司），因此明智的做法是先进行估算，看看您所付出的努力在短期和长期内是否值得。

第二种选择是甜蜜的中间地带；您仍然可以获得品牌认可，客户将获得一些安全保证（通过地址栏）；(i) 帧检测很容易通过一个简单的 JavaScript 比较来完成：`top === window`. 但是，您正在失去连续性，因此可能会失去一些转换。如果这种风险是可控的，我会在短期内选择这个选项。

无法通过绿色锁直接查看安全证书，这使得第三个选项最不可取。然而，并非一切都丢失了。通过巧妙地使用图像，您仍然可以获得最终用户的一些信任，[如此图像](http://media.smashingmagazine.com/wp-content/uploads/2011/03/visually-secured-checkout-design-full.png)中所述，这是Smashing Magazine的一篇精彩[文章的一部分。](http://uxdesign.smashingmagazine.com/2011/04/06/fundamental-guidelines-of-e-commerce-checkout-design/)

您的决定应基于：

1.  短期内可以做什么
2.  长期应该做什么
3.  安全的视觉提示对我的潜在客户有多重要
4.  花费在任一解决方案上的时间/金钱与收入（盈亏平衡分析）

# add-in - 适用于 Office 的 Microsoft 数据挖掘插件

> ID：12095593
> 
> 赞同：1
> 
> 时间：2012-08-23T15:53:22.933
> 
> 标签：add-in, data-mining

如果我安装了 SQL Server 2008 和 Office 2010，我应该选择哪个数据挖掘插件？我发现

适用于 Microsoft Office 2007 的 Microsoft SQL Server 2008 数据挖掘插件

和

适用于 Microsoft® Office® 2010 的 Microsoft® SQL Server® 2012 数据挖掘插件

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T02:34:17.110

Office 2010 加载项应该可以与 2008 一起使用。我使用 2008 安装它并且没有遇到任何问题。但是，我强烈建议将您的 SQL Server 升级到 2012，因为 2012 具有额外的商业智能优势。

# c# - 使用枚举更新对象的字符串属性

> ID：12095594
> 
> 赞同：2
> 
> 时间：2012-08-23T15:53:25.470
> 
> 标签：c#, asp.net, .net, ienumerable, enumeration

我在一个 aspx 页面上有大量文本框，其 ID 以“txt”为前缀，其余的 ID 在某个对象中具有相应的同名属性。我希望能够枚举这些字符串属性并在找到同名文本框（已删除前缀）的位置更新它们。有任何想法吗？我知道通过使用`Dictionary`我可以解决问题，但这并不理想。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T15:57:35.067

您可以使用反射来做到这一点：

```
MyObject data = new MyObject();
foreach (var pi in typeof(MyObject).GetProperties().Where(i =>
                                      i.PropertyType.Equals(typeof(string)))
{
   var control = FindControl("txt" + pi.Name) as ITextControl;
   if (control != null)
       pi.SetValue(data, control.Text, null);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T16:06:45.960

您可以使用以下控件：

```
foreach (Control control in divXYZ.Controls)
    if (control is TextBox)
        ((TextBox)control).Text = "whatever"; 
```

FindControl 是您可以在解决方案中使用的另一种方法：

```
Control myControl = FindControl("txtYourID"); 
```

[http://msdn.microsoft.com/en-us/library/486wc64h.aspx](http://msdn.microsoft.com/en-us/library/486wc64h.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T15:59:56.990

只需找到页面上的所有文本框控件，然后使用反射填充相应的属性。

# ios - 将触摸事件发送到另一个视图

> ID：12095596
> 
> 赞同：2
> 
> 时间：2012-08-23T15:53:36.373
> 
> 标签：ios, uiview

我在地图视图上有一个 UIView。目前 UIView 正在处理 touchesBegan、touchesMoved 和 touchesEnded。我需要这样做，以便 UIView 能够将触摸事件发送到 mapView。我一直在看手势识别器，但到目前为止还没有运气。以前这样做过吗？如果是这样，我该怎么做？

我在故事板中的视图层次结构

看法

*   地图视图
*   界面视图

再澄清一点。我的 UIView 用于从触摸输入中绘制。我有一个启用和禁用绘图的按钮，但触摸事件仍在 UIView 中处理。我想这样做，以便当我通过按下按钮禁用绘图时。用户与地图视图而不是 UIView 交互。我尝试在 UIView 中设置 userInteractionEnabled = NO，但是当再次按下绘图按钮时，我无法重新获得该视图中的控制权。

# ruby - Ruby：为了方便而定义一个类时“初始化”？

> ID：12095597
> 
> 赞同：1
> 
> 时间：2012-08-23T15:53:36.850
> 
> 标签：ruby

我是编程新手，并试图弄清楚创建类时“初始化”的目的。

这是一个例子：

```
class Person
  def initialize(name)
    @name = name
    @pet = nil
    @home = 'NYC'
  end
end 
```

所以初始化就是创建一堆属性，我可以直接用`Person.name`and`Person.pet`和and来提取，`Person.home`对吧？“初始化”只是为了将一堆变量压缩到一个地方吗？我会做同样的事情吗：

```
class Person     
  pet = nil    
  home = 'NYC'    
  #not so sure how to replicate the @name here.    
end 
```

我不能像在第一个代码中那样访问这些值`Person.pet`吗`Person.home`？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T16:18:28.237

这在 Ruby（与 Java 相对）中有点棘手，因为类和类的实例都是运行时的实际对象。因此，一个类有自己的一组变量，并且该类的每个实例也有自己的一组变量（与类的变量不同）。

当你说

```
class Person
  pet = nil
end 
```

您正在设置一个变量 pet，它仅对名为 的类对象是本地的`Person`。

操作类*实例*变量的方法是在*方法*中使用变量：

```
class Person
  def initialize
    pet = nil
  end
end 
```

在这里，pet 指的是给定*实例*的局部变量`Person`。当然，这个 pet 变量在定义时是非常无用的，因为它只是一个在`initialize`函数完成后会消失的局部变量。使该变量在实例的生命周期内保持不变的方法是将其设为*实例变量*，您可以通过在其前面加上`@`. 因此我们到达了您的第一个初始化：

```
class Person
  def initialize
    @pet = nil
    # And so on
  end
end 
```

所以，至于你为什么需要`initialize`. 由于设置实例的实例变量的唯一方法`Person`是在 的方法中`Person`，因此这种初始化需要在*某些*方法中。 `initialize`只是第一次创建实例时自动调用的方法的方便名称。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-23T16:02:45.893

Initialize 是一种通常称为对象构造函数的方法。它在您调用时使用`Person.new("Bob")`，它将为您提供该`Person`对象的实例。您在初始化中的变量之前看到的 @ 符号使变量成为实例变量，这意味着只有在您拥有该对象的实例后才能访问该变量，并且它将在该实例的整个生命周期内一直存在。

例如

```
person = Person.new("Bob")
person.name #Will output Bob
person.home #Will output NYC 
```

类是对象，这样做：

```
class Person
  pet = nil
  home = 'NYC'
end 
```

只是创建局部变量 pet 和 home 并且将超出类的范围。这意味着打电话`Person.pet`，`Person.home`只会给你一个错误。我建议对面向对象编程（OOP）做一点阅读，如果您还有任何问题，请将它们扔到 stackoverflow 中：D

# asp.net - 将 Facebook auth 实现为 ASP.NET Forms auth 自定义成员资格提供程序是否有意义？

> ID：12095598
> 
> 赞同：2
> 
> 时间：2012-08-23T15:53:40.827
> 
> 标签：asp.net, .net, asp.net-mvc, facebook, forms-authentication

我目前正在开发一个将 Facebook 用作身份验证服务的 Web 应用程序。将其实现为 ASP.NET 表单身份验证自定义成员资格提供程序是否有意义？在我进行研究时，我没有发现使用表单身份验证的任何具体显着优势。然而，我本能地认为这是一件好事，因为除了使用 Facebook 创建一个完全自定义的身份验证实现之外，我没有在 ASP.NET 中找到任何可以插入 Facebook 身份验证行为的扩展点。

然后你能告诉我表单身份验证是否是一个好主意吗？如果没有，除了完全自定义代码之外还有其他方法吗（我想避免手动管理会话 cookie、加载当前用户等）。

我正在使用 ASP.NET MVC 3，Entity Framework，我想避免使用 Facebook C# SDK（动态类型的广泛使用对我来说有点令人讨厌:-)）。

感谢您的任何建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T16:11:31.850

一个简单的答案是使用 .NET 4.5 oAuth 模板，它们非常容易将 Facebook 链接到表单身份验证。

[http://www.asp.net/vnext/overview/videos/oauth-in-the-default-aspnet-45-templates](http://www.asp.net/vnext/overview/videos/oauth-in-the-default-aspnet-45-templates)

但是，如果您打算立即发布，您可能很难找到合适的服务器。几个月后，大量服务器将支持 .NET 4.5。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T18:52:23.233

OAuth 模板适用于 v4.0 和 v4.5，因此您现在可以将它们发布到服务器上 :)

# jstree - jsTree 节点展开/折叠

> ID：12095601
> 
> 赞同：7
> 
> 时间：2012-08-23T15:54:04.550
> 
> 标签：jstree

今天早上我遇到了优秀的 jstree jQuery UI 插件。一句话—​​—太棒了！它易于使用，易于设计，并且可以按照包装盒上的说明进行操作。我还没有弄清楚的一件事是 - 在我的应用程序中，我想确保在任何给定时间只扩展一个节点。即当用户单击+ 按钮并展开一个节点时，任何先前展开的节点都应该被静默折叠。我需要这样做的部分原因是为了防止容器 div 的一个相当长的树视图在溢出时创建一个丑陋的滚动条，同时也为了避免用户的“选择过载”。

我想有一些方法可以做到这一点，但是好的但相当简洁的 jstree 文档并没有帮助我确定正确的方法来做到这一点。我将不胜感激任何帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-28T12:33:09.187

jsTree 很棒，但它的文档相当密集。我最终想通了，所以这里是任何遇到这个线程的人的解决方案。

首先，您需要将 open_node 事件绑定到相关树。类似的东西

```
$("tree").jstree({"themes":objTheme,"plugins":arrPlugins,"core":objCore}).
bind("open_node.jstree",function(event,data){closeOld(data)}); 
```

即您配置treeview 实例，然后绑定open_node 事件。在这里，我调用 closeOld 函数来完成我需要的工作 - 关闭任何其他可能打开的节点。功能是这样的

```
function closeOld(data)
{
    var nn = data.rslt.obj;
    var thisLvl = nn;
    var levels = new Array();
    var iex = 0;
    while (-1 != thisLvl)
    {
        levels.push(thisLvl);
        thisLvl = data.inst._get_parent(thisLvl);
        iex++;
    }

    if (0 < ignoreExp)
    {
        ignoreExp--;
        return;
    }

    $("#divElements").jstree("close_all");
    ignoreExp = iex;
    var len = levels.length - 1;
    for (var i=len;i >=0;i--) $('#divElements').jstree('open_node',levels[i]);
} 
```

这将正确处理所有其他节点的折叠，而与刚刚展开的节点的嵌套级别无关。

所涉及步骤的简要说明

*   首先，我们后退树视图，直到我们到达顶级节点（jstree 中的 -1），确保我们在数组**级别中记录进程中遇到的每个祖先节点**
*   接下来我们折叠树视图中的所有节点
*   我们现在将重新展开**级别**数组中的所有节点。在这样做的同时，我们不希望这段代码再次执行。为了阻止这种情况发生，我们将全局**ignoreEx变量设置为****级别**中的节点数
***   最后，我们逐步遍历**关卡**中的节点并展开每个节点**

 *** * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-04-03T12:28:09.593

上面的答案将一次又一次地构建树。下面的代码将打开已经打开的节点并折叠，它不会再次构造树。

```
.bind("open_node.jstree",function(event,data){
        closeOld(data);
        }); 
```

并且 closeOld 函数包含：

```
function closeOld(data)
{
    if($.inArray(data.node.id, myArray)==-1){
            myArray.push(data.node.id);
            if(myArray.length!=1){
                var arr =data.node.id+","+data.node.parents;
                var res = arr.split(",");
                var parentArray = new Array();
                var len = myArray.length-1;
                for (i = 0; i < res.length; i++) {
                    parentArray.push(res[i]);
                }
                for (var i=len;i >=0;i--){
                    var index = $.inArray(myArray[i], parentArray);
                if(index==-1){
                    if(data.node.id!=myArray[i]){
                    $('#jstree').jstree('close_node',myArray[i]);
                        delete myArray[i];
                    }
                }
                }
        }
    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-02-28T19:52:16.623

我通过使用事件“before_open”并关闭所有节点来实现这一点，我的树只有一层，不确定这是否是你需要的。

```
$('#dtree').on('before_open.jstree', function(e, data){
    $("#dtree").jstree("close_all");
}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-10-20T03:02:44.430

jstree 3.3.2 的另一个例子。它使用[下划线](http://underscorejs.org/)库，可以随意调整解决方案以适应 jquery 或 vanillla js。

```
$(function () {
    var tree = $('#tree');
    tree.on('before_open.jstree', function (e, data) {
        var remained_ids = _.union(data.node.id, data.node.parents);
        var $tree = $(this);
        _.each(
                $tree
                    .jstree()
                    .get_json($tree, {flat: true}),
                function (n) {
                    if (
                        n.state.opened &&
                        _.indexOf(remained_ids, n.id) == -1
                    ) {
                        grid.jstree('close_node', n.id);
                    }
                }
        );
    });
    tree.jstree();
}); 
```**

# perl - perl 函数忽略 undef 参数

> ID：12095603
> 
> 赞同：2
> 
> 时间：2012-08-23T15:54:25.330
> 
> 标签：perl

我正在将一些参数传递给一个函数，其中一个可能是未定义的。

```
$a = ($config->function(param('a'),'int')); 
```

我的模块包含一个如下所示的函数：

```
sub function{                    
        my $self = $_[0];           
        my $t = $_[1];              
        my $type = $_[2];           
        print "$self,$t,$type<br/>";
} 
```

我试过用`shift`而不是`@_`语法，但没有改变。问题是如果`$config->function`用未定义的方式调用`param('a')`它，它会打印如下：

`MY_FUNC=HASH(0x206e9e0),name,` 似乎`$t`被设置为`$type`应该是的值`undef`并且被完全忽略。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T16:03:16.057

`undef`在参数列表中完全有效。我怀疑这里的问题是该`param`函数返回一个空列表，而不是`undef`.

```
sub function {
    no warnings 'uninitialized';
    print join "/", @_;
}

function(undef,"foo");      #   outputs "/foo"
function((), "foo");        #   outputs "foo" 
```

在 to 的参数列表中`function`， `param`函数在列表上下文中进行评估。

```
sub param1 {
    return;     # undef in scalar context, but empty list in list context
}

sub param2 {
    return undef;    # scalar ctx: undef, list ctx: list with one undef elem
}

function(param1(), "foo");    #   param1() -> () ... outputs "foo"
function(param2(), "foo");    #   param2() -> (undef) ... outputs "/foo" 
```

一种解决方法是确保`param`在标量上下文中评估您的函数。

```
function(scalar param1(), "foo");    # now outputs "/foo" 
```

请注意，实际上`return undef`在您的 Perl 子例程中说的内容[被某些人认为是代码异味](https://stackoverflow.com/a/1604654/168657)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-23T16:55:57.423

在发生错误的情况下， CGI`param`方法正确地返回一个空列表。这是 Perl 子例程和方法的标准行为，它们在发生错误时返回*错误*值。

正如@mob 所说，显式`return undef`是错误的，因为它在列表上下文中返回一个单元素列表。这是一个*真正*的价值，意味着成功，如果改变它会破坏很多代码

您需要做的就是更改代码以单独提取参数

```
my $param = param('a');
$config->function($param, 'int')); 
```

或者如果你*真的*很想把调用放在参数列表中，那么你可以写

```
$config->function(scalar param('a'), 'int')); 
```

或者

```
$config->function(param('a') // undef, 'int')); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-24T08:36:06.290

[我开始这是作为评论，但它太长了]。

在参数列表中，参数在列表上下文中进行评估。两个答案已经注意到了这一点，但我认为你错过了他们谈论的所有其他事情。

除此之外，`param`必须处理至少三种情况，林肯选择的界面虽然有时很烦人，但足以处理它们。

查询参数`a`根本没有出现：

```
b=1 
```

查询参数`a`出现，但没有值：

```
a=&b=1 
```

查询参数`a`出现一个值：

```
a=1&b=1 
```

# google-app-engine - 哪个页面导致我的 JSP 出现 500 错误？

> ID：12095608
> 
> 赞同：1
> 
> 时间：2012-08-23T15:54:32.823
> 
> 标签：google-app-engine, jsp

有没有一种简单的方法可以让我从 JSP 500 页面中识别出哪个页面导致了 500 错误？我在 Java 中的 Google AppEngine 上。我的 /500 页面由 jsp 提供。我已经尝试过 request.GetRequestURI() 和 request.GetRequestURL()，但它似乎只是告诉我我在 mysite.com/500 上，这是有道理的，但没有帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T16:05:07.910

登录到 App Engine 管理页面并查看日志以查找 500 错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T16:09:15.367

此信息使用 key 存储在请求范围中`javax.servlet.error.request_uri`。

所以，这应该这样做：

```
<p>Request URI: ${requestScope['javax.servlet.error.request_uri']}</p> 
```

# c# - Can't update a custom object in Appcelerator Cloud Service, got an error: (401) Unauthorized

> ID：12095610
> 
> 赞同：0
> 
> 时间：2012-08-23T15:54:43.660
> 
> 标签：c#, rest, post, appcelerator

I'm working on a C# application that connects to the Appcelerator Cloud Service, so far I can make queries and login, but when I tried to update a `Custom Object` I got the following error: `The remote server returned an error: (401) Unauthorized`. This is my code for my POST request:

```
 url = "https://api.cloud.appcelerator.com/v1/objects/Reservacion/update.json?key=appkey&id=" + idReservacion + "&noDisponibles=" + noDisponibles;
            wrGetUrl = (HttpWebRequest)WebRequest.Create(url);
            wrGetUrl.Method = "POST";
            wrGetUrl.ContentType = "application/json";
            objStream = wrGetUrl.GetResponse().GetResponseStream(); // this is the line where the error is thrown
            reader = new StreamReader(objStream); 
```

I have a theory and it involves the login, at the beginning of my application I make a login which return an ok status, but I think I need to somehow let know ACS I logged in already by sending the session id or something like that when I try to update the `Custom Object`.

**Edit** That is why I tried to add the cookie in the header like this:

```
 url = "https://api.cloud.appcelerator.com/v1/objects/Reservacion/update.json?key=appkey&id=" + idReservacion + "&noDisponibles=" + noDisponibles;
                wrGetUrl = (HttpWebRequest)WebRequest.Create(url);
                wrGetUrl.Method = "POST";
                wrGetUrl.ContentType = "application/json";
                wrGetUrl.Headers.Add("Set-Cookie", "_session_id=" + session + "; path=/; HttpOnly");
                objStream = wrGetUrl.GetResponse().GetResponseStream(); // this is the line where the error is thrown
                reader = new StreamReader(objStream); 
```

Where `session` is the session id I got from my successful login. But even though I added this to the headers in my request the error `The remote server returned an error: (401) Unauthorized`.

**Edit:** I tried something else:

```
 url = "https://api.cloud.appcelerator.com/v1/objects/Reservacion/update.json?key=appkey&id=" + idReservacion + "&noDisponibles=" + noDisponibles;
                wrGetUrl = (HttpWebRequest)WebRequest.Create(url);
                wrGetUrl.Method = "POST";
                wrGetUrl.ContentType = "application/json";
                wrGetUrl.Headers.Add("Cookie", session); //changed the header but it didn't work
                objStream = wrGetUrl.GetResponse().GetResponseStream(); // still throws the same error
                reader = new StreamReader(objStream); 
```

How can I solve this problem? Thanks for any help in advance.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T23:15:03.533

我解决了这样的问题：

```
 String fields = "fields={\"noDisponibles\":" + noDisponibles +"}";

                String url = "https://api.cloud.appcelerator.com/v1/objects/Reservacion/update.json?key=appkey&id=" + idReservacion + "&_session_id="+session; 
                HttpWebRequest wrGetUrl = (HttpWebRequest)WebRequest.Create(url);

                wrGetUrl.Method = "PUT";
                wrGetUrl.ContentLength = fields.Length;
                wrGetUrl.ContentType = "application/x-www-form-urlencoded";

                Stream dataStream = wrGetUrl.GetRequestStream();
                byte[] byteArray = Encoding.ASCII.GetBytes(fields);
                dataStream.Write(byteArray, 0, byteArray.Length);
                dataStream.Close();

                Stream objStream = wrGetUrl.GetResponse().GetResponseStream();
                StreamReader reader = new StreamReader(objStream); 
```

我必须在 HttpWebRequest 的 DataStream 中写入以发送我想要更新的字段。希望这可以帮助将来的人们。

# wcf - WCF: Getting (400) Bad Request when sending small amount of data

> ID：12095615
> 
> 赞同：0
> 
> 时间：2012-08-23T15:55:08.923
> 
> 标签：wcf

I am getting "The remote server returned an unexpected response: (400) Bad Request" when I try to send more than 100 audit entries. I am using Fiddler to help debug and do see the request being sent to the server. The client and server both use the same interface.

```
[ServiceContract]
public interface ISyncDataContract
{
    #region Audit Log

    /// <summary>
    /// Creates a collection of new audit entries items in the database.
    /// </summary>
    /// <param name="items">The audit entry items to be created.</param>
    /// <returns><c>True</c> if created successfully; otherwise, <c>false</c>.</returns>
    [OperationContract]
    [WebInvoke(UriTemplate = "AuditEntries", Method = "PUT")]
    bool CreateAuditEntryItems(AuditEntryItemCollection items);

    /// <summary>
    /// Gets all the audit entry items available.
    /// </summary>
    /// <returns>An <see cref="AuditEntryItemCollection"/> object containing all the
    /// available audit entry items.</returns>
    [OperationContract]
    [WebGet(UriTemplate = "AuditEntries")]
    Message GetAuditEntryItems();

    #endregion
} 
```

AuditEntryItem.cs

```
[DataContract]
public class AuditEntryItem
{
    #region Constructor/Deconstructor

    /// <summary>
    /// Initializes a new instance of the <see cref="AuditEntryItem"/> class.
    /// </summary>
    public AuditEntryItem()
    {
    }

    /// <summary>
    /// Initializes a new instance of the <see cref="AuditEntryItem"/> class.
    /// </summary>
    /// <param name="auditEntry">The audit entry.</param>
    public AuditEntryItem(AuditEntry auditEntry)
    {
        if (auditEntry == null)
        {
            throw new ArgumentNullException("auditEntry");
        }

        this.Audit_Type = auditEntry.Audit_type;
        this.ComputerName = Environment.MachineName;
        this.Message = auditEntry.Message;
        this.Sequence_Number = auditEntry.Sequence_number;
        this.Session_ID = auditEntry.Session_ID;
        this.SyncDate = DateTime.Now;
        this.Time_Stamp = auditEntry.Time_stamp;
        this.User_ID = auditEntry.User_ID;
    }

    #endregion Constructor/Deconstructor

    #region Properties

    /// <summary>
    /// Gets or sets the session ID.
    /// </summary>
    /// <value>
    /// The session ID.
    /// </value>
    [DataMember]
    [XmlElement(ElementName = @"Session_ID")]
    public string Session_ID { get; set; }

    /// <summary>
    /// Gets or sets the user ID.
    /// </summary>
    /// <value>
    /// The user ID.
    /// </value>
    [DataMember]
    [XmlElement(ElementName = @"User_ID")]
    public string User_ID { get; set; }

    /// <summary>
    /// Gets or sets the time stamp.
    /// </summary>
    /// <value>
    /// The time stamp.
    /// </value>
    [DataMember]
    [XmlElement(ElementName = @"Time_Stamp")]
    public string Time_Stamp { get; set; }

    /// <summary>
    /// Gets or sets the sequence number.
    /// </summary>
    /// <value>
    /// The sequence number.
    /// </value>
    [DataMember]
    [XmlElement(ElementName = @"Sequence_number")]
    public int Sequence_Number { get; set; }

    /// <summary>
    /// Gets or sets the message.
    /// </summary>
    /// <value>
    /// The message.
    /// </value>
    [DataMember]
    [XmlElement(ElementName = @"Message")]
    public string Message { get; set; }

    /// <summary>
    /// Gets or sets the type of the audit.
    /// </summary>
    /// <value>
    /// The type of the audit.
    /// </value>
    [DataMember]
    [XmlElement(ElementName = @"Audit_type")]
    public string Audit_Type { get; set; }

    /// <summary>
    /// Gets or sets the name of the computer.
    /// </summary>
    /// <value>
    /// The name of the computer.
    /// </value>
    [DataMember]
    [XmlElement(ElementName = @"ComputerName")]
    public string ComputerName { get; set; }

    /// <summary>
    /// Gets or sets the sync date.
    /// </summary>
    /// <value>
    /// The sync date.
    /// </value>
    [DataMember]
    [XmlElement(ElementName = @"SyncDate")]
    public DateTime? SyncDate { get; set; }

    /// <summary>
    /// Gets the time stamp value in a date time format.
    /// </summary>
    [XmlIgnore]
    public DateTime DisplayTimeStamp
    {
        get { return this.TimeStampDateTime(); }
    }

    #endregion Properties

    #region Overrides

    public override bool Equals(object obj)
    {
        return obj is AuditEntryItem ? this.Equals((AuditEntryItem)obj) : false;
    }

    public bool Equals(AuditEntryItem other)
    {
        if (ReferenceEquals(this, other))
        {
            return true;
        }

        return string.Equals(this.Audit_Type, other.Audit_Type) &&
               string.Equals(this.ComputerName, other.ComputerName) &&
               string.Equals(this.Message, other.Message) &&
               this.Sequence_Number == other.Sequence_Number &&
               string.Equals(this.Session_ID, other.Session_ID) &&
               this.SyncDate == other.SyncDate &&
               string.Equals(this.Time_Stamp, other.Time_Stamp) &&
               string.Equals(this.User_ID, other.User_ID);
    }

    public override int GetHashCode()
    {
        unchecked
        {
            var result = (this.Audit_Type != null ? this.Audit_Type.GetHashCode() : 0);
            result = (result * 397) ^ (this.ComputerName != null ? this.ComputerName.GetHashCode() : 0);
            result = (result * 397) ^ (this.Message != null ? this.Message.GetHashCode() : 0);
            result = (result * 397) ^ this.Sequence_Number.GetHashCode();

            result = (result * 397) ^ (this.Session_ID != null ? this.Session_ID.GetHashCode() : 0);
            result = (result * 397) ^ (this.SyncDate != null ? this.SyncDate.GetHashCode() : 0);
            result = (result * 397) ^ (this.Time_Stamp != null ? this.Time_Stamp.GetHashCode() : 0);
            result = (result * 397) ^ (this.User_ID != null ? this.User_ID.GetHashCode() : 0);
            return result;
        }
    }

    #endregion Overrides

    /// <summary>
    /// Converts the Java time stamp value into a readable format.
    /// </summary>
    /// <returns>A readable date time format.</returns>
    private DateTime TimeStampDateTime()
    {
        if (this.Time_Stamp.IsNullOrEmpty())
        {
            return new DateTime(1970, 01, 01);
        }

        long value;
        if (!long.TryParse(this.Time_Stamp, out value))
        {
            return new DateTime(1970, 01, 01);
        }

        value = value / 1000;
        return new DateTime(1970, 01, 01).AddSeconds(value);
    }
} 
```

AuditEntryItemCollection.cs

```
[DataContract]
[XmlRoot(ElementName = "AuditLog")]
public class AuditEntryItemCollection
{
    #region Declarations

    #endregion Declarations

    #region Constructor/Deconstructor

    /// <summary>
    /// Initializes a new instance of the <see cref="AuditEntryItemCollection"/> class.
    /// </summary>
    public AuditEntryItemCollection()
    {
        this.AuditEntryItems = new List<AuditEntryItem>();
    }

    #endregion Constructor/Deconstructor

    #region Properties

    /// <summary>
    /// Gets or sets the collection of <see cref="AuditEntryItem"/>
    /// objects.
    /// </summary>
    /// <value>
    /// The collection of <see cref="AuditEntryItem"/> objects.
    /// </value>
    [XmlElement(ElementName = @"AuditEntry")]
    [DataMember]
    public List<AuditEntryItem> AuditEntryItems { get; set; }

    #endregion Properties
} 
```

App.config

```
<?xml version="1.0" encoding="utf-8" ?> 
```

```
<behaviors>
  <endpointBehaviors>
    <behavior name="restXmlBehavior">
      <webHttp helpEnabled="true" defaultOutgoingResponseFormat="Xml" />
      <dataContractSerializer maxItemsInObjectGraph="2147483647"/>
    </behavior>
    <behavior name="rssAtomBehavior">
      <webHttp/>
    </behavior>
  </endpointBehaviors>

  <serviceBehaviors>
    <behavior name="metadataBehavior" >
      <serviceMetadata httpGetEnabled="true" />
      <serviceDebug includeExceptionDetailInFaults="true" />
      <dataContractSerializer maxItemsInObjectGraph="2147483647"/>
    </behavior>
  </serviceBehaviors>
</behaviors>

<bindings>
  <webHttpBinding>
    <binding name="StreamedHttp"
             maxReceivedMessageSize="2147483647"
             transferMode="Streamed" >
      <readerQuotas maxDepth="32" maxStringContentLength="8192" maxArrayLength="6000000" />
    </binding>
  </webHttpBinding>
</bindings> 
```

UPDATE:

The error I am now getting is "The maximum message size quota for incoming messages (65536) has been exceeded. To increase the quota, use the MaxReceivedMessageSize property on the appropriate binding element." As far as I can tell, I have already done this. Is there some other setting I need to set?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T13:46:14.300

您可以确保还为大型请求配置了 httpRuntime：

（从我用来上传文件的服务中获取的示例：）

```
<httpRuntime executionTimeout="3600" maxRequestLength="50000000" maxQueryStringLength="2097151" requestValidationMode="2.0" /> 
```

还可以查看绑定上的缓冲池大小（同样，这些值只是示例）：

```
 <binding name="WHB" maxReceivedMessageSize="50000000" maxBufferPoolSize="50000000" crossDomainScriptAccessEnabled="true">
          <readerQuotas maxArrayLength="50000000" maxStringContentLength="50000000" /> 
```

# objective-c - 带空格的 OSX 目录

> ID：12095620
> 
> 赞同：3
> 
> 时间：2012-08-23T15:55:23.990
> 
> 标签：objective-c, macos, file-io, directory

我在打开包含空格的目录时遇到问题。我的代码如下所示：

```
NSOpenPanel* openDlg = [NSOpenPanel openPanel];

[openDlg setCanChooseDirectories:YES];
if ( [openDlg runModal] == NSOKButton )
{

    NSArray* files = [openDlg URLs];

        NSString* directoryName = [[files objectAtIndex:0] absoluteString];
    directoryURL = [files objectAtIndex:0];
        NSLog(@"Directory Name: %@", directoryName);

        NSArray *directoryArray = [directoryName componentsSeparatedByString:@"/"];

    NSString* currentDirectory = [directoryArray objectAtIndex:(directoryArray.count- 2)];

    [directoryBox setTitle:currentDirectory];
} 
```

当我选择带有空格的目录名称时，文件不会显示在表格中，并且 NSLog 中的输出如下所示：

目录名称：

```
file://localhost/Users/Rich/Software%20Bisque/ 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T16:25:19.693

的[`-URLs`](https://developer.apple.com/library/mac/documentation/Cocoa/Reference/ApplicationKit/Classes/NSOpenPanel_Class/Reference/Reference.html#//apple_ref/occ/instm/NSOpenPanel/URLs)方法`NSOpenPanel`返回 的实例`NSURL`，而不是文件系统路径。虽然`NSURL`s 已成为引用文件的首选方式，但您可以使用`NSURL`'[`-path`](https://developer.apple.com/library/mac/documentation/Cocoa/Reference/Foundation/Classes/NSURL_Class/Reference/Reference.html#//apple_ref/occ/instm/NSURL/path)方法轻松更改为文件系统路径。

请注意，有许多特定于处理文件系统路径的方法，这些路径添加`NSString`到`NSPathUtilities.h`. 你可能会重写你的代码来合并这些（仔细检查我的目标目录是否正确）：

```
NSArray* files = [openDlg URLs];

NSString* directoryName = [[files objectAtIndex:0] path];
directoryURL = [files objectAtIndex:0];
NSLog(@"Directory Name: %@", directoryName);

// NSArray *directoryArray = [directoryName pathComponents];

// NSString* currentDirectory = [directoryArray objectAtIndex:(directoryArray.count- 2)];

NSString *currentDirectory = [[directoryName stringByDeletingLastPathComponent]
                                    lastPathComponent];

[directoryBox setTitle:currentDirectory]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T16:00:27.423

您可以尝试删除字符串中的百分比转义`directoryName`- 我认为系统不需要它们。就像是：

```
directoryName = [directoryName stringByReplacingPercentEscapesUsingEncoding:NSUTF8StringEncoding]; 
```

# wcf - 使用 .Net 3.5 客户端使用 Json WCF 服务

> ID：12095621
> 
> 赞同：0
> 
> 时间：2012-08-23T15:55:27.160
> 
> 标签：wcf, .net-3.5

我在访问返回 Json 的 WCF Web 服务时遇到了一些问题。使用 WCF 测试客户端，我想出了要使用的配置，但此配置适用于 .Net 4.0，而我的客户端应用程序位于 .Net 3.5 中（目前无法升级）。这是我在 .Net 4.0 中的行为配置：

```
<behaviors>
   <endpointBehaviors>
       <behavior name="web">
          <webHttp defaultBodyStyle="Wrapped" defaultOutgoingResponseFormat="Xml" />
       </behavior>
   </endpointBehaviors>
</behaviors> 
```

不幸的是，这两个属性在 .Net 3.5 中不存在。我可以做些什么来为我的客户（代码或其他配置）指定这个？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T08:45:27.763

在 3.5 中，您无法在 config 中设置这些值，但您可以在代码中设置，请参阅：http: [//msdn.microsoft.com/en-us/library/system.servicemodel.description.webhttpbehavior.defaultoutgoingresponseformat(v=vs. 90).aspx](http://msdn.microsoft.com/en-us/library/system.servicemodel.description.webhttpbehavior.defaultoutgoingresponseformat(v=vs.90).aspx)

默认值为 XML，您发布的配置示例也是 XML，但在您的问题文本中说服务返回 JSON。

# ajax - 仅当它是 ajax 调用中的唯一参数时，才将序列化形式发送到控制器

> ID：12095623
> 
> 赞同：1
> 
> 时间：2012-08-23T15:55:33.790
> 
> 标签：ajax, asp.net-mvc-3

我有以下 Ajax 调用。我有2个参数。一种是序列化形式，另一种是字符串。当我只将表单传回时，所有值都存在于控制器对象中。但是，当我同时传递序列化表单和字符串时，会在表单对象为空时填充字符串...

不知道为什么会这样。任何帮助将不胜感激。

**jQuery**

```
 function SubmitQuoteForm() {
       var selectedServices = MapServiceForm();
       var addressForm = $("#ShipmentForm").serialize();

       $.ajax({
        data: { addressModel: addressForm, serviceListing: selectedServices },
        type: "POST",
        url: "Home/PrepareRateRequest",
        success: function (response) {
            //omitted for brevity
        }
    });

    function MapServiceForm() {
        var selectedServices = $("#ShipmentForm  input[type='checkbox']:checked").map(function () {
           return this.id;
        }).get().join('|');

        return selectedServices;
    }
} 
```

**控制器**

```
 [AcceptVerbs(HttpVerbs.Post)]
    public ActionResult PrepareRateRequest(Models.ShipmentModel addressModel, string serviceListing)
    {
        //omitted for brevity

        return Json("");
    } 
```

# c# - c# - 动态返回一个通用接口

> ID：12095633
> 
> 赞同：2
> 
> 时间：2012-08-23T15:56:10.780
> 
> 标签：c#, generics, interface

我正在尝试基于标志返回两个存储库实例之一。我的存储库接口和实现如下所示：

```
public interface IRepository<T>
{
    T Insert(T entity);
    void Delete(T entity);
    IEnumerable<T> SearchFor(Expression<Func<T, bool>> predicate);
    IEnumerable<T> GetAll();
    T SearchForFirst(Expression<Func<T, bool>> predicate);
    bool Has(Expression<Func<T, bool>> predicate);
}

class Repository<T> : IRepository<T> where T : class    { ... implementation here ...} 
```

返回存储库的两个实例之一的方法应该类似于：

```
 public IRepository<T> GenerateRepository(bool flag)
    {
        if ( flag ) {
           return new Repository<MyFirstType>();
        } else {
           return new Repository<MySecondType>();
        }
    } 
```

谁能指出我应该如何写的正确方向？

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-23T15:58:05.587

只有当这两种类型共享一个共同的基本类型或接口时，这才有效，并且只有接口是协变的（你的不是）：

```
public IRepository<CommonAncestor> GenerateRepository(bool flag)
{
    if (flag) {
       return new Repository<MyFirstType>();
    } else {
       return new Repository<MySecondType>();
    }
} 
```

返回`IRepository`未指定类型的 an 是没有意义的；通用成员将无法使用。

# wpf - 代码隐藏中的圆角按钮

> ID：12095641
> 
> 赞同：-4
> 
> 时间：2012-08-23T15:56:48.190
> 
> 标签：wpf, button, code-behind

我需要帮助在 WPF 中创建带圆角的按钮。我想在上面使用渐变背景！

我需要在后面的代码中设置它而不是 XAML。它将在运行时设置，我不知道我会创建多少个按钮。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T15:58:21.667

> 因为它将在运行时创建，所以我不知道要创建的按钮数量。

这不是 WPF 中的正当理由，有一种叫做[数据模板](http://msdn.microsoft.com/en-us/library/ms742521.aspx)的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T18:32:06.853

您只需要为您的按钮创建一个默认样式（在您的情况下为四舍五入）。例如，如果要修改 Button 控件

在您的主题中 (Generic.xaml)

```
<Style TargetType="{x:Type Button}">
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="{x:Type Button}">
                 // Your button style
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style> 
```

然后，每次您添加一个新按钮时，它都会使用这个主题。

# knowledge-management - 是否有代码完成测验/测试？

> ID：12095642
> 
> 赞同：0
> 
> 时间：2012-08-23T15:56:48.783
> 
> 标签：knowledge-management, code-complete

所以，我的老板有充分的理由喜欢 Steve McConnell 的书 Code Complete。我想知道是否有人曾经遇到过一种方法来测试是否有人读过这本书。我发誓必须在某个地方进行测验/测试。唉，我找一个人的努力是徒劳的。我们正在启动开发人员资历的游戏化过程。我们提供了可以带来奖金和福利的代码成就列表。其中一项成就是阅读 Code Complete。我个人的成就之一是找到一种确定的方法来测试是否有人读过它。

这似乎模棱两可，但有一个明确的答案。

TLDR：有人知道关于 Code Complete 的测验或测试吗？如果你不这样做，你会问别人哪个问题来确定他们是否阅读了 Code Complete？

我的一些问题：（“我喜欢这些，但我正在寻找一个明确的问题”）

```
What is Cohesion, why is it important?
When should code go in to it's own method? 
When should a collection of methods become a class? 
How much should you plan a project out before doing it? 
What is Code Construction? 
Give an example of a variable name for an investment amount. 
```

为了澄清，我不是在寻找总结甚至答案。我只是想要一个预制的测验或一个问题来问某人。非常感谢你们。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T16:08:52.663

编码实践应该随着时间的推移而展开，但如果你正在寻找一个快速的“你读过这个吗？” 然后我会选择 McConnell 在那里发表的一些有趣的评论，比如：

> 在什么情况下你会是一个自大的骗子？
> 
> 哪位作曲家死在评论里？

等等。如果您像阅读小说一样阅读这本书（我认为可以做到——我喜欢它！），而不是仅仅浏览标题，这些很可能会突出。

# php - 如何在上一个和下一个始终存在的情况下比较三个日期

> ID：12095644
> 
> 赞同：0
> 
> 时间：2012-08-23T15:56:58.343
> 
> 标签：php, javascript, jquery, fullcalendar

我有一个日历，其中 URL 的参数包含上一个和下一个的 UNIX 日期，例如

```
http://loc/event/getEventsJSON?start=1343536200&end=1347165000&_=1345737237933 
```

我有一个查询，其中传递月份作为参数允许我从数据库中获取相关数据。对于第一个视图，我没有问题，因为我使用 date('m') 但是当我移动到下一个或上一个时，如何比较日期以传递正确的日期？换句话说，现在是 8 月 (8) 如果我移到下一个，那么将是 Septmeber(9) 如果移到上一个将是 7 月 (7) 如何将正确的值传递给 getEventsJSON() 函数？我正在使用 FullCalendar！

提前致谢

# blackberry - 奇怪的黑莓包装/签名问题

> ID：12095646
> 
> 赞同：1
> 
> 时间：2012-08-23T15:57:16.237
> 
> 标签：blackberry, code-signing

我一整天（2012 年 8 月 23 日）都收到这个奇怪的包装/签名错误。不过，这似乎更像是签名问题，因为它在不需要签名时可以很好地打包。进度上升到 99%，并且永远保持在那里。

当需要 RRT 时，它将是 RRT 等待响应。当不需要 RRT 时，下一行（在本例中为 RBB）等待响应。发回确认签名的电子邮件，但包装未完成，无法使用。

我试过： 1.重新安装代码签名密钥。2\. 重新安装整个Eclipse & BlackBerry Plug-in。3\. 请求并重新安装一个全新的签名密钥。4\. 询问 BlackBerry 支持论坛（墓地实际上更热闹）。

顺便说一句，它们都不起作用。哦，我应该补充一点，没有任何修改，昨天的签名过程运行良好。

所以我想我应该在这里碰碰运气。请帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T20:00:17.500

您使用的是哪个版本的 BlackBerry Java Plug-in for Eclipse 和 BlackBerry Java SDK？一些旧版本与 JDK 7.0 有冲突，这会导致 SignatureTool 在接收来自 RIM 签名服务器的签名时挂起。你可以在这里读更多关于它的内容：

[SignatureTool 在签名时停止响应](http://supportforums.blackberry.com/t5/Testing-and-Deployment/SignatureTool-Stops-Responding-While-Signing/ta-p/1286833 "SignatureTool 在签名时停止响应")

# c# - 我如何处理 .FirstOrDefault 方法？

> ID：12095649
> 
> 赞同：4
> 
> 时间：2012-08-23T15:57:28.143
> 
> 标签：c#, .net, entity-framework, ef-code-first

当我用`.FirstOrDefault`方法查询数据库时，我如何处理它给我的结果？我特别关心空值，目前我有类似的东西：

```
if (result == default(TypeOfResult))
{
    handleIt();
} 
```

但我不完全知道这个“默认”是什么，所以我想知道这样做是否更好：

```
if (result == null)
{
    handleIt();
} 
```

哪一个会起作用？这个“默认”到底是什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-23T16:01:37.003

`FirstOrDefault`将返回序列中的第一个元素，或者字面上是相关类型的默认值。

因此，根据您查询的内容，默认值可能会发生变化。例如，集合`int`的`default`值将为 0。因此，检查是否`null`不起作用。

考虑：

```
List<int> s = new List<int>();
var x = s.FirstOrDefault(); 
```

这里`x`等于`0`

引用类型怎么样？

```
List<MyCustomClass> s = new List<MyCustomClass>();
var x = s.FirstOrDefault(); 
```

这里`x`将是`null`

这可能是两种方法中更好的一种：

```
if (result == default(TypeOfResult))
{
   handleIt();
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-23T16:01:01.110

如果`TypeOfResult`是引用类型，那么

`result == default(TypeOfResult)`和`result == null` **意思一样**。

因为引用类型的默认值在`null`.

[默认关键字](http://msdn.microsoft.com/en-us/library/xwth0h0d%28v=vs.80%29.aspx)只返回给定类型的“默认值”，如果是`null`. 对于值类型，它取决于类型，例如 0 表示`int`等。

顾名思义`FirstOrDefault`，如果集合为空，将返回集合的第一个元素或给定类型的默认值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-24T10:28:15.377

如果您想确保您的代码可以使用 default(T) 进行故障保存，其中 T 是一个值类型，您可以将您的项目装箱在 Nullable 对象中。

例如：

```
var ints = new List<int>(){1,2,3,4,6};
int result = ints.Where(i => i == 0).FirstOrDefault(); 
```

即使列表中没有 0，结果也是 0！

```
var ints = new List<int>(){1,2,3,4,6};
var nullable = ints.Select(i => new Nullable<int>(i));
var result = nullable.Where(i => i == 0).FirstOrDefault() 
```

结果为null，列表中没有0！

这当然更慢并且需要更多内存，但也适用于非值类型。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-23T16:01:26.263

您应该检查 Null。如果找不到任何结果，FirstOrDefault 将返回 NULL。

看到这个[帖子](https://stackoverflow.com/questions/1024559/when-to-use-first-and-when-to-use-firstordefault-with-linq "邮政")

# asp.net - 使用反射从 ASP.NET 模板代码隐藏类中获取命名空间？

> ID：12095650
> 
> 赞同：0
> 
> 时间：2012-08-23T15:57:28.373
> 
> 标签：asp.net, reflection, namespaces, code-behind

我正在尝试从 ASP.NET 模板 (.aspx) 代码隐藏类中获取命名空间。代码隐藏文件包含以下内容：

```
namespace MyTopNamespace.SubNamespace
{
    public partial class PageClass : System.Web.UI.Page
    {
        // ...
    }
} 
```

我将这个实例传递`PageClass`给以下方法。

```
private static string GetNamespace(Page page)
{
    const string desiredPart = "MyTopNamespace";
    if (page == null)
    {
        throw new ArgumentNullException("page");
    }
    string pageNamespace = page.GetType().FullName;

    // For debugging
    string pageAssembly = page.GetType().Assembly.FullName;
    string pageAsmQualified = page.GetType().AssemblyQualifiedName;

    if (!pageNamespace.Contains(desiredPart) && 
        !pageAssembly.Contains(desiredPart) &&
        !pageAsmQualified.Contains(desiredPart))
    {
        throw new ApplicationException(string.Format(
            "Unexpected namespace or assembly: \n\n'{0}'\n'{1}'\n'{2}'", 
             pageNamespace, pageAssembly, pageAsmQualified)); 
    }
    // Remaining implementation ...
} 
```

异常输出：

> **意外的命名空间或程序集：**
> 
> 'ASP.pageclass_aspx'
> 
> 'App_Web_pageclass.aspx.cdcab7d2.v4dudq3x，版本 = 0.0.0.0，文化 = 中性，PublicKeyToken = null'
> 
> 'ASP.pageclass_aspx，App_Web_pageclass.aspx.cdcab7d2.v4dudq3x，版本=0.0.0.0，文化=中性，PublicKeyToken=null'

发生了什么`MyTopNamespace`，可以使用反射从类型中获得吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T16:01:09.077

这是因为页面是在运行时编译的，然后给它一个临时程序集、命名空间，有时还有一个临时类名（在这个例子中似乎没有）。无法从已通过运行时编译实例化的页面实例中检索先前的命名空间。

# javascript - 运行初始 prettyphoto.open 函数后的 .bind/.unbind 事件

> ID：12095655
> 
> 赞同：0
> 
> 时间：2012-08-23T15:57:40.257
> 
> 标签：javascript, jquery, prettyphoto

我正在使用 .appened 将一些 HTML 添加到标记中的 div 中，当漂亮照片灯箱克隆打开时正在输出的标记中。

我试图弄清楚如何只将附加的 HTML 加载到灯箱一次，而不是每次使用后退/下一步按钮查看图库中的新图像时。

根据我的发现，这可以通过使用 .bind/.unbind 来完成，但编写这个函数似乎不起作用。

我在 prettyphoto open 函数中使用以下偶数处理程序

```
$.prettyPhoto.open=function(event){

$(".pbdog-gAd").append('<p style="text-align: center;"><a href="' + prettyLink + '" target="_blank"><img src="' + prettyAd + '" width="468" height="60" alt="" /></a></p>'); 
```

这会产生所需的输出......

![](../Images/08fc6d9d4ba449578de1dde488093c01.png)

我的问题是，每次单击下一个/上一个按钮时，它都会再次运行脚本并在当前图像下方添加一个额外的广告图像，如下所示。它一直这样做，直到 prettyphoto 最终崩溃

![](../Images/8eea9e53932fa02037256cc200b17cc2.png)

据我所知，我需要编写一个函数来第一次调用这个事件，但不是每次点击下一个/上一个按钮时

我试过以下没有运气

```
$(".pbdog-gAd").bind("click", function( event ) {
$(".pbdog-gAd").append('<p style="text-align: center;"><a href="' + prettyLink + '" target="_blank"><img src="' + prettyAd + '" width="468" height="60" alt="" /></a></p>');
$(this).unbind( event );
}); 
```

执行上述操作似乎使 prettyphoto 完全忽略了此功能。执行以下操作似乎破坏了 prettyphoto

```
$.prettyPhoto.bind("click", function( event ) {
$(".pbdog-gAd").append('<p style="text-align: center;"><a href="' + prettyLink + '" target="_blank"><img src="' + prettyAd + '" width="468" height="60" alt="" /></a></p>');
$(this).unbind( event );
}); 
```

我显然不明白我在这里做什么，所以任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T15:24:34.443

我发现的解决方案是在 .append 运行后使用 .removeClass 。这会阻止图像第二次加载，并且还删除了该类，因此如果在 .append 过程中未加载任何值，则不会将格式应用于空间。

```
$(".pbdog-gAd").append('<p style="text-align: center;"><a href="' + JprettyLink + '" target="_blank"><img src="' + JprettyAd + '" width="468" height="60" alt="" /></a></p>');
$(".pbdog-gAd").removeClass("pbdog-gAd"); 
```

# php - Mod_Rewrite 规则删除本地主机上的 .php 文件扩展名

> ID：12095656
> 
> 赞同：2
> 
> 时间：2012-08-23T15:57:42.693
> 
> 标签：php, apache, mod-rewrite, clean-urls

我目前正在我的本地机器（Wamp）上的一个网站上工作，我一直在尝试用 htaccess 清理我的网址，但我看不到让它工作..我知道的不多（真的) 关于 Apache。

重要的？：

*   我正在使用 WAMP 服务器
*   我已经打开了 Mod_rewrite
*   我的网站网址：**localhost/myapp1/** ......我的网站在这个目录中

你能帮我用正确的代码来完成这个吗？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T20:58:02.580

在您的**myapp1**目录中，将这些规则添加到 htaccess 文件中

```
 RewriteEngine On
    RewriteBase /myapp1/
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteCond %{REQUEST_URI} ^(.*?)/?$
    RewriteCond %{DOCUMENT_ROOT}/%1.php -f
    RewriteRule ^(.*?)/?$ $1.php 
```

# java - 如何在布局 xml 中查看滚动视图上的项目

> ID：12095657
> 
> 赞同：-1
> 
> 时间：2012-08-23T15:57:43.523
> 
> 标签：java, android

我已经制作了一个滚动视图，但我无法看到整个布局我想看到最后一个按钮和布局 xml 上的单选按钮而不在设备/模拟器上运行它是他们查看滚动上所有项目的一种方式查看布局 xml。

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:orientation="vertical" >

<ScrollView
    android:id="@+id/scrollView1"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent" >

<LinearLayout
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >

    <TextView
        android:id="@+id/textView1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="text1"
        android:textAppearance="?android:attr/textAppearanceLarge" />

    <EditText
        android:id="@+id/editText1"
        android:layout_width="147dp"
        android:layout_height="wrap_content"
        android:ems="10" />

    <Button
        android:id="@+id/Button01"
        android:layout_width="200dp"
        android:layout_height="100dp"
        android:text="button one" />

    <EditText
        android:id="@+id/EditText01"
        android:layout_width="fill_parent"
        android:layout_height="100dp"
        android:ems="10" />

    <Button
        android:id="@+id/button2"
        android:layout_width="wrap_content"
        android:layout_height="75dp"
        android:text="buttontwo" />

    <EditText
        android:id="@+id/editText3"
        android:layout_width="fill_parent"
        android:layout_height="80dp"
        android:ems="10"
        android:inputType="textPostalAddress" />

    <TextView
        android:id="@+id/textView2"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="text two"
        android:textAppearance="?android:attr/textAppearanceLarge" />

    <EditText
        android:id="@+id/editText2"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:ems="10"
        android:inputType="textPassword" />

    <Button
        android:id="@+id/button3"
        android:layout_width="wrap_content"
        android:layout_height="100dp"
        android:text="Buttonthree" />

    <TextView
        android:id="@+id/textView3"
        android:layout_width="100sp"
        android:layout_height="50sp"
        android:text="textfour"
        android:textAppearance="?android:attr/textAppearanceLarge" />

    <Button
        android:id="@+id/button1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="Button" />

    <RadioButton
        android:id="@+id/radioButton1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="RadioButton" />
</LinearLayout>
</ScrollView>
</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T16:03:22.183

最简洁的答案是不。

长答案是否定的，您实际上不能在 Eclipse 的 xml 预览屏幕中的滚动视图中“滚动”。原因是，代码并没有真正编译，预览屏幕只是为了给你一个想法。

如果您真的想查看底部的内容，只需将其上方的某些项目注释掉或将可见性设置为消失，以便您的底部项目出现。

# javascript - JQuery - 自动刷新（复制表单）

> ID：12095658
> 
> 赞同：0
> 
> 时间：2012-08-23T15:57:46.300
> 
> 标签：javascript, jquery

我正在使用这个脚本每隔 x 秒更新一次我的 div。

```
<script type="text/javascript" src="jquery.js"></script>
<script>
    var auto_refresh = setInterval(
    function ()
    {
    $('chatbox').load('chat.php').fadein('slow')
    }, 1000); // refresh every 1000 milliseconds
</script> 
```

我用它来更新聊天的 div，但是，当我查看我的页面时，它复制了我的整个页面并显示在页面末尾，没有任何工作，提交表单和 div 重复，计算机使用率达到 99% .

这有什么不对吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T16:01:57.580

如果 "form" 是一个 div id，它必须`$('#form')`不是`$('form')`。后者会将 chat.php 加载到页面上的每个表单元素中。

此外，请确保 chat.php 仅打印您需要的表单元素，而不是整个页面。jQuery 提供了解析您需要的内容的功能，`$('#form').load('form.php #form');`.

请记住，服务器仍在将整个页面发送给客户端，这是低效的。如果这是您的问题，请考虑修改您的 php 以仅发送 JSON（或类似）数据，并根据需要在客户端对其进行格式化。

# crystal-reports - 使用多个数据库加速 Crystal Reports

> ID：12095662
> 
> 赞同：0
> 
> 时间：2012-08-23T15:57:54.453
> 
> 标签：crystal-reports

我正在编写一系列报告，这些报告链接了多个数据库中的各种表。返回给 Crystal 的结果记录集可能是数百万条记录，因此生成单个报告可能需要一个小时或更长时间。从加快数据检索的选项来看，SQL 表达式似乎是理想的，这样数据库服务器可以进行过滤并返回 Crystal 需要的内容，而不是所有内容。但是，当涉及多个数据库时，Crystal 似乎不会执行 SQL 表达式。

我能想到的唯一解决方案是为每个报告创建一个视图。没有用于过滤的参数，但每个报告在其记录选择中是唯一的。在进行此操作之前，我想看看在这种情况下是否有任何其他选项可以加快报告生成速度。

带有 SQL Server 2008 后端的 Crystal Reports 2010。

# c# - 比较两个字符串数组而不使用 linq

> ID：12095668
> 
> 赞同：-2
> 
> 时间：2012-08-23T15:58:05.883
> 
> 标签：c#, .net-2.0, arrays

> **可能重复：**
> [比较 C# 中的数组](https://stackoverflow.com/questions/713341/comparing-arrays-in-c-sharp)

我有两个字符串数组：

```
string[] a;
string[] b; 
```

我如何确定有多少（以及哪些）项目`a`不存在`b`？因为我使用的是 .NET 2.0，所以我不能使用 linq。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T16:02:06.393

```
List<string> result = new List<string>();
foreach (string sa in a)
{
   if (Array.IndexOf(b, sa) < 0)
      result.Add(sa);
}

int count = result.Count; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T16:05:01.893

将它们都转换为 List 并执行以下操作：

```
List<string> difference = new List<string>();
foreach(string word in a)
{
    if(!b.Contains(word))
        difference.Add(word);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-23T16:08:22.773

我建议将您的字符串数组转换为[`HashSet<T>`](http://msdn.microsoft.com/en-us/library/bb341004(v=vs.90).aspx)s.
请参阅[此处](https://stackoverflow.com/questions/687034/using-hashset-in-c-sharp-2-0-compatible-with-3-5)了解如何`HashSet<T>`在 .NET 2.0中使用

然后

> 如何确定 b 中不存在 a 的多少（以及哪些）项目？

--> [IntersectWith](http://msdn.microsoft.com/en-us/library/bb293080%28v=vs.90%29.aspx)正是这样做的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-23T16:10:41.850

试试这个：

```
string[] a = ...;
string[] b = ...;

List<string> bList = new List<string>(b);
List<string> valuesInAButNotInB = new List<string>();
foreach (string value in a)
{
    if (!bList.Contains(value))
        valuesInAButNotInB.Add(value);
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-23T16:14:35.467

您需要做的是将一个列表中的项目存储在一个集合中，然后从该集合中删除所有项目（如果它们在另一个集合中）。对于较大的数据集，这将比两个嵌套循环或在其中一个数组上执行大量线性搜索要快得多。

由于`HashSet`在 2.0 中不存在，我只使用 a`Dictionary`并忽略这些值。这是一个黑客，但不是一个可怕的。

```
string[] a = null;
string[] b = null;
Dictionary<string, string> values = new Dictionary<string, string>();
foreach (string s in a)
{
    values.Add(s, s);
}

foreach (string s in b)
{
    values.Remove(s);
}

foreach (string s in values.Keys)
{
    Console.WriteLine(s);//This string is in 'a' and not in 'b'
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-23T16:04:34.073

只需枚举 和 中的项目`a`，`b`就像过去一样：

```
private static void Main(string[] args)
{
    string[] a = new string[] { "a", "b", "c", "d" };
    string[] b = new string[] { "c", "d" };

    foreach (string tmp in a)
    {
        bool existsInB = false;
        foreach (string tmp2 in b)
        {
            if (tmp == tmp2)
            {
                existsInB = true;
                break;
            }
        }

        if (!existsInB)
        {
            Console.WriteLine(string.Format("{0} is not in b", tmp));
        }
    }

    Console.ReadLine();
} 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2012-08-23T16:03:38.133

```
private List<string> CompareArray(string[]  arr1, string[] arr2)
{
        List<string> compareList = new List<string>();
        //iterate throught it
        foreach( string str in arr1 )
        {
            if(!arr2.Contains( str ))
            {
                compareList.Add(str);
            }
        }
            return compareList;
 } 
```

# javascript - 为什么这会造成无限循环并使我的浏览器崩溃？

> ID：12095670
> 
> 赞同：0
> 
> 时间：2012-08-23T15:58:12.600
> 
> 标签：javascript, jquery, loops, while-loop

尝试创建一种方法来计算开始和结束元素之间匹配元素的数量。没有什么太狂野了。原来这两个console.log在我中间识别`next_item`并`end_elem`在无限循环中使我的浏览器崩溃。理想情况下，我试图在 while 循环调用中使用它，这样我就可以防止它通过`end_elem`do 捕获它`next_item.index() < end_elem.index()`，但这显然每次都会破坏我的浏览器。我不知道为什么。

```
 find_the_count_of_elements_between_two_elements: function(class_to_count, start_elem, end_elem) {
    var number_of_times = 0;
    var start = 0;
    var end = 1;
    next_item = start_elem.nextAll().slice(start, end);

    while ( start < 6 ) {

      // console.log(next_item.index() < end_elem.index() );
      console.log("next_item : " + next_item.index() );
      console.log("end_elem : " + end_elem.index());

      if ( next_item.hasClass(class_to_count) ) {
        number_of_times++;
      };

      start++;
      end++;
      next_item = start_elem.nextAll().slice(start, end);
      console.log(next_item);
    };
    return number_of_times;
  }, 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T16:37:24.177

将 JQuery 对象声明为全局（即没有`var`）似乎会使某些浏览器感到困惑，因此将它们声明为本地函数总是一个好主意。

注意：我很高兴这些信息有所帮助，但如果有人能真正解释**为什么**会发生这种情况，他们应该得到解决方案标记，而不是我。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-24T08:45:58.563

看来您的函数 find_the_count_of_elements_between_two_elements 仅适用于兄弟姐妹。那是因为您使用 ..index() 来确定元素在 DOM 中的位置 - 相对于其兄弟元素。

在这种情况下，您可以更便宜地实现相同的目标。我将使用 filter 而不是 class_to_count 因为它更通用。

```
function count_matching_elements_between(filter, start_elem, end_elem) {
    return $(start_elem).nextAll(filter).filter($(end_elem).prevAll()).length;
} 
```

要查找具有特定类的元素，您可以使用：

```
count_matching_elements_between('.myClass', '#myStart', '#myEnd'); 
```

或提供显式 DOM 节点或 jQuery 选择作为开始和结束。

顺便说一句：您是否编辑了您的代码示例？我在那里看不到任何“if (next_item.index() < end_elem.index())”。

# php - 在 CakePHP 和 MySQL 中返回很多行

> ID：12095677
> 
> 赞同：1
> 
> 时间：2012-08-23T15:58:27.237
> 
> 标签：php, mysql, cakephp, cakephp-1.3

也许我在这里遗漏了一些简单的东西......或者我只是在这方面编码了很长时间我看不到我的问题，但是使用 CakePHP (1.3) 和做一个选择 (MySQL) 应该能够返回即使有 2,000 条记录的结果......对吗？

```
$options = array(
    'conditions' => array(
        'Lead.campaign_id' => $campaign['Campaign']['id']
    ),
    'recursive' => -1,
    'order' => 'Lead.goal DESC',
    'contain' => false,
);

$leads = $this->Lead->find('all',$options); 
```

然而，这个查询给了我一个白屏死机（带`define('LOG_ERROR', 2);`设置）。

如果我`'limit' => 300,`在数组中添加一个（或类似的数字......不必正好是 300），`$options`那么它将提取结果，所以我知道查询本身不是问题。

此外，我尝试通过使用数组中的`'fields'`参数来限制返回的列`$options`......甚至告诉它只返回 1 个字段，但这也不起作用。

我还回显了它使用的 SQL 语句 via

```
$log = $this->Lead->getDataSource()->getLog(false, false);
debug($log); 
```

当然，我必须`'limit'`输入它才能显示（否则我只会得到白屏死机）。然后我将该查询（无限制）复制/粘贴到 phpMyAdmin 中，它会很好地返回记录（即使打开“显示 1,000 行”）。这样做让我相信系统*可以*处理查询和输出，但也许我在做一个我不应该做的假设。

我试图获取所有行而不对记录进行分页的原因是因为我需要将它们输出到 csv 文件以供用户下载（这部分已经在工作......*当*查询工作时）。

有人向我建议这可能是一个超时问题，我应该提出这个问题，但这对我来说似乎是一个黑客，必须有一个更好的解决方案。

由于我正在下载 csv 文件，也许有一种方法可以将查询流式传输到然后下载的文件？或者也许有更好的解决方案？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T14:10:18.627

您可能内存不足（检查您的 Web 服务器错误日志） - Cake 会将所有 2000 行加载到一个数组中，这可能会超出您的脚本内存限制。

您可以提高脚本内存限制，但还有其他选择：

你真的需要取回所有 2000 行吗？向用户显示这么多数据对于用户来说将是不可理解的。分页在这里会更好吗？

如果您打算根据所有数据进行计算，也许您可​​以重新编写查询以在查询中进行计算？

如果您必须使用 PHP 来处理数据，请将其分块取回（例如一次 100 条记录）。如果该过程可能需要很长时间，您可能需要将脚本超时设置为较高的值...

# database - 为两因素身份验证存储“备份代码”的最佳方式？

> ID：12095681
> 
> 赞同：2
> 
> 时间：2012-08-23T15:58:40.450
> 
> 标签：database, security, web-applications, two-factor-authentication

我正在为我的一个副项目实施一个双因素身份验证系统，并希望建立一些“一次性代码”，就像谷歌的双因素身份验证一样。

我的问题是，将这些代码存储在服务器上的最安全方法是什么？他们需要在数据库中加密吗？我会使用像 bcrypt 这样的东西来让它们像我散列密码一样吗？考虑到攻击者知道每个散列代表一个 6 位数字，这将使暴力破解时间几乎为零，我认为这可能是矫枉过正。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-24T07:54:27.440

将您的一次性代码 (OTC) 视为密码。现在使用安全最佳实践来管理密码。

此外，您不应使用 6 位数字作为 OTC。就像我说的，这些是（相当于）密码，你不希望这些密码太弱。

有关如何安全存储密码的更多信息，请参阅[密码存储备忘单。](https://www.owasp.org/index.php/Password_Storage_Cheat_Sheet)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T18:01:26.880

问题有点模糊，但这里有一些指针：

1.  将身份验证的至少一部分存储在单独的机器上可以降低这两个部分一起被破坏的风险。
2.  **给你的哈希加盐！**salt 可能对您的站点是唯一的，也可能对用户是唯一的，只要您在想要验证时可以重新创建它。
    *   为什么盐？字符串的 md5hash`123456`是`e10adc3949ba59abbe56e057f20f883e`- 正如你所说，很容易被暴力破解。但是如果我添加用户的 id 呢？您可以将其添加到散列并重新散列或将其添加到原始文本中： md5hash of `123456aneroid`is `74821b76b332b28532136eb58e1b7f40`。
    *   也可以使用其他额外的盐，请参阅此 SO 帖子：[https ://stackoverflow.com/a/5482545/1431750](https://stackoverflow.com/a/5482545/1431750)
3.  数据库应该存储这些[加盐哈希](http://www.google.com/search?q=salt+hash)。
4.  您的一种盐可以来自第二个凭证。
5.  您可以多次重新散列哈希。

# ios - 移动和修复手机 iOS 上录制的视频的 moov atom

> ID：12095682
> 
> 赞同：1
> 
> 时间：2012-08-23T15:58:47.770
> 
> 标签：ios, video-streaming

问题是您如何找到并移动记录在 iOS 设备上的 .mov 文件的 moov 原子，以便您可以通过 http 流式传输它。有一种方法可以做到这一点，但这需要将其导出到文件中，理论上这会使您复制整个文件，然后您就可以流式传输它。

有没有其他方法可以做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2016-09-19T06:50:10.923

*   使用 iOS AV Foundation 框架和几行 Objective-C（您也可以从 MOV 转换为 MP4，因为 Android 无法读取 MOV）：

    因此，使用没有缓冲区的此代码可以从 Live URL 播放流畅的视频，但在将视频上传到您的服务器之前，请使用此代码并转换您的视频并在上传之后。所以视频是在没有任何负载的情况下播放视频，如 snapchat。

    不要忘记将以下框架添加到您的项目中。

> ```
> #import <AVFoundation/AVAsset.h>
> #import <AVFoundation/AVAssetExportSession.h>
> #import <AVFoundation/AVMediaFormat.h> 
> ```

```
+ (void) convertVideoToMP4AndFixMooV: (NSString*)filename toPath:(NSString*)outputPath {

    NSURL *url = [NSURL fileURLWithPath:filename];
    AVAsset *avAsset = [AVURLAsset URLAssetWithURL:url options:nil];
    AVAssetExportSession *exportSession = [AVAssetExportSession
                                           exportSessionWithAsset:avAsset
                                           presetName:AVAssetExportPresetPassthrough];

    exportSession.outputURL = [NSURL fileURLWithPath:outputPath];
    exportSession.outputFileType = AVFileTypeAppleM4V;

    // This should move the moov atom before the mdat atom,
    // hence allow playback before the entire file is downloaded
    exportSession.shouldOptimizeForNetworkUse = YES;

    [exportSession exportAsynchronouslyWithCompletionHandler:
     ^{

         if (AVAssetExportSessionStatusCompleted == exportSession.status) {}
         else if (AVAssetExportSessionStatusFailed == exportSession.status) {
             NSLog(@"AVAssetExportSessionStatusFailed");
         }
         else
         {
             NSLog(@"Export Session Status: %d", exportSession.status);
         }
     }];
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-23T15:58:47.770

这是我编辑和编写的方法的代码，用于与 iOS 一起查找然后将 moov atom 写入特定位置，因此在您拥有视频文件的这两个部分之后，您只需要访问视频文件的字节FTYP 原子从哪里结束（查看标记为 start_offset 和 last_offset 的变量），然后将发生流式传输。

```
- (NSString *)fixForFastPlayback:(char*)dest:(ALAsset*)selected
{
    FILE *infile  = NULL;
    FILE *outfile = NULL;
    uint32_t atom_type = 0;
    uint64_t atom_size = 0;
    uint64_t atom_offset = 0;
    uint64_t last_offset;
    uint64_t moov_atom_size;
    uint64_t ftyp_atom_size = 0;
    uint64_t i, j;
    uint32_t offset_count;
    uint64_t current_offset;
    uint64_t start_offset = 0;

    ALAssetRepresentation * rep = [[selected defaultRepresentation] retain];

    int bufferSize = 8192; // or use 8192 size as read from other posts

    int read = 0;
    NSError * err = nil;

    uint8_t * buffer = calloc(bufferSize, sizeof(*buffer));
    uint8_t * ftyp_atom;
    /* traverse through the atoms in the file to make sure that 'moov' is
     * at the end */
    int asset_offset = 0;
    while (asset_offset < [rep size])
    {

        read = [rep getBytes:buffer
                  fromOffset:asset_offset
                      length:ATOM_PREAMBLE_SIZE
                       error:&err];

        asset_offset += read;

        if (err != nil)
        {
            NSLog(@"Error: %@ %@", err, [err userInfo]);
        }

        atom_size = (uint32_t)BE_32(&buffer[0]);
        atom_type = BE_32(&buffer[4]);

        /* keep ftyp atom */
        if (atom_type == FTYP_ATOM) //no idea what an atom is, maybe a header or some sort of meta data or a file marker
        {

            ftyp_atom_size = atom_size;
            ftyp_atom = calloc(ftyp_atom_size, sizeof(*buffer));

            if (!ftyp_atom)
            {
                printf ("could not allocate %"PRIu64" byte for ftyp atom\n",
                        atom_size);

            }

            asset_offset -= ATOM_PREAMBLE_SIZE;

            read = [rep getBytes:ftyp_atom
                      fromOffset:asset_offset
                          length:ftyp_atom_size
                           error:&err];

            asset_offset += read;

            start_offset = asset_offset;

        }
        else
        {

            asset_offset += (atom_size - ATOM_PREAMBLE_SIZE);

        }

        printf("%c%c%c%c %10"PRIu64" %"PRIu64"\n",
               (atom_type >> 24) & 255,
               (atom_type >> 16) & 255,
               (atom_type >>  8) & 255,
               (atom_type >>  0) & 255,
               atom_offset,
               atom_size);
        if ((atom_type != FREE_ATOM) &&
            (atom_type != JUNK_ATOM) &&
            (atom_type != MDAT_ATOM) &&
            (atom_type != MOOV_ATOM) &&
            (atom_type != PNOT_ATOM) &&
            (atom_type != SKIP_ATOM) &&
            (atom_type != WIDE_ATOM) &&
            (atom_type != PICT_ATOM) &&
            (atom_type != UUID_ATOM) &&
            (atom_type != FTYP_ATOM))
        {
            printf ("encountered non-QT top-level atom (is this a Quicktime file?)\n");
            break;
        }
        atom_offset += atom_size;

        /* The atom header is 8 (or 16 bytes), if the atom size (which
         * includes these 8 or 16 bytes) is less than that, we won't be
         * able to continue scanning sensibly after this atom, so break. */
        if (atom_size < 8)
            break;
    }

    if (atom_type != MOOV_ATOM)
    {
        printf ("last atom in file was not a moov atom\n");
        free(ftyp_atom);
        fclose(infile);
        return 0;
    }

    asset_offset = [rep size];
    asset_offset -= atom_size;
    last_offset = asset_offset;

    moov_atom_size = atom_size;
    uint8_t * moov_atom = calloc(moov_atom_size, sizeof(*buffer));

    if (!moov_atom)
    {
        printf ("could not allocate %"PRIu64" byte for moov atom\n",
                atom_size);

    }
    read = [rep getBytes:moov_atom
              fromOffset:asset_offset
                  length:moov_atom_size
                   error:&err];

    asset_offset += read;

    /* this utility does not support compressed atoms yet, so disqualify
     * files with compressed QT atoms */
    if (BE_32(&moov_atom[12]) == CMOV_ATOM)
    {
        printf ("this utility does not support compressed moov atoms yet\n");

    }

    /* crawl through the moov chunk in search of stco or co64 atoms */
    for (i = 4; i < moov_atom_size - 4; i++)
    {
        atom_type = BE_32(&moov_atom[i]);

        if (atom_type == STCO_ATOM)
        {
            printf (" patching stco atom...\n");
            atom_size = BE_32(&moov_atom[i - 4]);
            if (i + atom_size - 4 > moov_atom_size)
            {
                printf (" bad atom size\n");

            }
            offset_count = BE_32(&moov_atom[i + 8]);
            for (j = 0; j < offset_count; j++)
            {
                current_offset = BE_32(&moov_atom[i + 12 + j * 4]);
                current_offset += moov_atom_size;
                moov_atom[i + 12 + j * 4 + 0] = (current_offset >> 24) & 0xFF;
                moov_atom[i + 12 + j * 4 + 1] = (current_offset >> 16) & 0xFF;
                moov_atom[i + 12 + j * 4 + 2] = (current_offset >>  8) & 0xFF;
                moov_atom[i + 12 + j * 4 + 3] = (current_offset >>  0) & 0xFF;
            }
            i += atom_size - 4;
        }
        else if (atom_type == CO64_ATOM)
        {

            printf (" patching co64 atom...\n");
            atom_size = BE_32(&moov_atom[i - 4]);
            if (i + atom_size - 4 > moov_atom_size)
            {
                printf (" bad atom size\n");

            }
            offset_count = BE_32(&moov_atom[i + 8]);
            for (j = 0; j < offset_count; j++)
            {
                current_offset = BE_64(&moov_atom[i + 12 + j * 8]);
                current_offset += moov_atom_size;
                moov_atom[i + 12 + j * 8 + 0] = (current_offset >> 56) & 0xFF;
                moov_atom[i + 12 + j * 8 + 1] = (current_offset >> 48) & 0xFF;
                moov_atom[i + 12 + j * 8 + 2] = (current_offset >> 40) & 0xFF;
                moov_atom[i + 12 + j * 8 + 3] = (current_offset >> 32) & 0xFF;
                moov_atom[i + 12 + j * 8 + 4] = (current_offset >> 24) & 0xFF;
                moov_atom[i + 12 + j * 8 + 5] = (current_offset >> 16) & 0xFF;
                moov_atom[i + 12 + j * 8 + 6] = (current_offset >>  8) & 0xFF;
                moov_atom[i + 12 + j * 8 + 7] = (current_offset >>  0) & 0xFF;
            }
            i += atom_size - 4;
        }
    }

    outfile = fopen(dest, "wb");
    NSLog(@"%llu",last_offset);

    //global variables to be used when returning the actual data
    start_offset_not_c = start_offset;
    last_offset_not_c = last_offset;

    if (ftyp_atom_size > 0)
    {
        printf ("writing ftyp atom...\n");
        if (fwrite(ftyp_atom, ftyp_atom_size, 1, outfile) != 1)
        {
            perror(dest);
        }
    }

    printf ("writing moov atom...\n");
    if (fwrite(moov_atom, moov_atom_size, 1, outfile) != 1)
    {
        perror(dest);
    }

    fclose(outfile);
    free(ftyp_atom);
    free(moov_atom);
    ftyp_atom = NULL;
    moov_atom = NULL;

    return [NSString stringWithCString:dest encoding:NSStringEncodingConversionAllowLossy];
} 
```

享受！

# jquery - 将多个复选框作为数组返回

> ID：12095684
> 
> 赞同：0
> 
> 时间：2012-08-23T15:58:50.313
> 
> 标签：jquery, html, forms, serialization, checkbox

我确定我在做一些愚蠢的事情，但我无法让我的表单以我想要的方式序列化多个复选框。

我在[这里创建了一个 jsfiddle](http://jsfiddle.net/pYrCL/3)

如果你运行，点击填充表单，勾选几个框，然后点击你得到的序列化

的警报`multi%5B%5D=1&multi%5B%5D=2`

当我正在寻找的东西更像`multi=1,2`

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T16:43:13.503

好吧，我是愚蠢的。以为序列化从复选框值创建了一个数组，但事实证明，当复选框在名称属性中包含 [] 时，php 在服务器端执行此操作。

# c++ - 用于 iOS 的许可声音文件解析库

> ID：12095689
> 
> 赞同：1
> 
> 时间：2012-08-23T15:59:00.930
> 
> 标签：c++, objective-c, ios, core-audio, libsndfile

有谁知道任何带有许可许可证的声音文件解析库，以便在 iOS 上使用，作为 libsndfile 的替代品？理想情况下，我正在寻找 C/C++ 代码，但我也会考虑 ObjC 代码。

只要图书馆没有陷入 l/gpl 中，我就可以接受功能不那么全面的图书馆

到目前为止搜索什么都没有，有人知道任何宝石吗？

# php - 选择多对多的参数

> ID：12095691
> 
> 赞同：1
> 
> 时间：2012-08-23T15:59:01.930
> 
> 标签：php, doctrine-orm

我是学说的初学者，我不知道如何进行查询。

我在 Symfony2 中，我有两个实体：`Equipment`和`Domain`.
它们通过双向多对多关联。

在我的`DomainRepository`我想要一个相关`Domains`的`Equipment`。

我已经尝试过了，但它没有返回任何东西：

```
public function getDomainsRelatedToEquipment($id)
{   
    $qb = $this->createQueryBuilder('d');
    $qb->addSelect('e');
    $qb->leftJoin('d.equipements','e');
    $qb->where('e.id = :id')->setParameter('id', $id);

    return $qb->getQuery()->getArrayResult();
} 
```

你能帮我制作一个构建器，让我每个都`Domain`包含`Equipment`带有 id的内容`$id`吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T07:27:35.177

我试过了，但它不起作用。我已经采取了测试行动：

```
public function testAction() {
$em = $this->getDoctrine()->getEntityManager();
    $qb = $em->getRepository('myBundle:Equipement')->createQueryBuilder('e');
    $qb->where($qb->expr()->in('e.domaines', array('?1')));
    $q = $qb->getQuery();
    $q->setParameter(1, 1);

    var_dump($q->getArrayResult());

} 
```

但我有一个语义错误

```
[Semantical Error] line 0, col 61 near 'domaines IN(': Error: Invalid PathExpression.     
StateFieldPathExpression or SingleValuedAssociationField expected. 
```

我的班级设备有一个领域域。

```
class Equipement
{
[...]

/**
 * @ORM\ManyToMany(targetEntity="Domaine", inversedBy="equipements")
 */
private $domaines; 
```

我通过构建这样的数组避免了这个问题：

```
 $domaines = array();
    $em = $this->getDoctrine()->getEntityManager();
    $equipement = $em->getRepository('iMDEODISAASBundle:Equipement')->find($equipementId);
    $repoDomaine = $em->getRepository('iMDEODISAASBundle:Domaine');
    $idx = 0;
    foreach ($equipement->getDomaines() as $domaine) {
        $d= $repoDomaine->get($domaine->getId());
        $domaines[$idx]=$d[0];
        $idx++;
    }
    return $domaines; 
```

但我想这不是最好的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T16:15:14.870

你必须使用`Expr::in()`.

```
/**
 * @param int $id Equipment ID
 * @return array
 */
public function getDomainsRelatedToEquipment($id)
{
    $qb = $this->createQueryBuilder('d');
    $qb->where($qb->expr()->in('e.domains', array('?1'));

    $q = $qb->getQuery();
    $q->setParameter(1, $id);

    return $q->execute();
} 
```

**免责声明：**我没有测试我的代码！

# linq - 简化 Linq 语句

> ID：12095695
> 
> 赞同：1
> 
> 时间：2012-08-23T15:59:18.050
> 
> 标签：linq, c#-4.0, linq-to-objects

我已经编写了以下 linq 语句，但我不禁觉得它可以以某种方式简化。目的是获取一个`List<IEnumberable<Counterparty>>`（查询中的counterpartyStatic）对象并找到ClientId 等于Counterparty.CounterpartyId 的订单。然后这些订单应该更新字段 ClientDesc 以匹配 Counterparty.DescriptionField。完成此操作后，我需要引发一个事件，传递所有已更新的订单。

OrderCache 是一个字典，以防不明显。

这是现有的代码：

```
var updates = new List<Order>();
        lock (CacheLock)
        {
            counterpartyStatic.ToList().ForEach(cachedList =>
                cachedList.ToList().ForEach(
                    counterparty =>
                    {
                        var orders = OrderCache.Where(kvp => kvp.Value.Client == counterparty.CounterpartyId);
                        orders.ToList().ForEach(kvp =>
                        {
                            kvp.Value.ClientDesc = counterparty.Description;
                            updates.Add(kvp.Value);
                        });
                    }));
        }

        RaiseEvent(updates); 
```

谢谢你的帮助

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T16:10:12.707

鉴于您的“查询”确实是为了引起副作用（即：您在深层嵌套循环中更改值的 ClientDesc），我建议使用循环而不是尝试使用 LINQ 来编写它。这有几个优点 - 你不只是为了使用而制作列表`List<T>.ForEach`，而且意图更加明确：

```
var updates = new List<Order>();

lock (CacheLock)
{
    foreach(var cachedList in counterpartyStatic)
    {
        foreach(var counterparty in cachedList)
        {
             var orders = OrderCache.Where(kvp => kvp.Value.Client == counterparty.CounterpartyId);
             foreach(var kvp in orders)
             {
                  kvp.Value.ClientDesc = counterparty.Description;
                  updates.Add(kvp.Value);
             }
         }
    }

    RaiseEvent(updates);
} 
```

这和你原来的一样短，但就正在发生的事情而言要清楚得多。

有关为什么避免`List<T>.ForEach`可能是有益的论点，请参阅[Eric Lippert 的 "foreach" 与 "ForEach"](http://blogs.msdn.com/b/ericlippert/archive/2009/05/18/foreach-vs-foreach.aspx)。 `List<T>.ForEach`考虑到围绕它的问题，甚至已将新的 Windows 应用商店应用程序删除。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-23T16:29:17.007

（我为此写了一个很长的答案，但后来我的笔记本电脑崩溃了。Grrr。）

我会编写一个 LINQ 查询来查找您感兴趣的所有值，然后分别执行突变。所以：

```
var query = from cachedList in counterpartyStatic
            from counterparty in cachedList
            join order in OrderCache.Values // Your query never uses the key
              on counterparty.CounterpartyId equals order.Client
            select new { Order = order, counterparty.Description };

var list = query.ToList(); // Avoid joining more than once

// Now do the update
foreach (var entry in list)
{
    entry.Order.ClientDesc = entry.Description;
}

// Now raise the events
RaiseEvents(list => list.Select(entry => entry.Order)); // Add ToList if needed 
```

# string - 将字符串变量转换为整数的最有效 VBA 代码

> ID：12095696
> 
> 赞同：1
> 
> 时间：2012-08-23T15:59:24.823
> 
> 标签：string, excel, vba, optimization

我有以下代码将以下格式的字符串转换为
`"G##"`整数`##`

```
Dim str As String
Dim int As Integer
str = "G14"
int = CInt(Right(str, Len(str) - 1)) 
```

但这将定期在大型数据库上运行。

我想知道是否有任何可能更有效的替代方案（尤其是关于最后一行）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T16:21:22.383

我针对 int = CInt(Mid$(str, 2)) 尝试了您的代码 100,000,000 次迭代，并且 Mid$ 语句稍快（在我的机器上为 6 秒），但这是很多迭代。但是，当我将**$**添加到您的 Right 函数时，它们以相同的速度运行。与变体版本相比，使用字符串函数`Right$`对字符串进行了更好的优化`Right`。所以唯一的建议是我必须使用字符串优化版本 Right$。

```
Dim str As String
Dim int As Integer
str = "G14"
int = CInt(Right$(str, Len(str) - 1)) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-24T00:14:14.553

在我的测试中使用

```
 Mid$(strTest, 1, 1) = "0"
 lngTest = CLng(strTest) 
```

比使用快 30-40%

```
CLng(Right$(strTest, Len(strTest) - 1)) 
```

这反过来又比

```
CLng(Right(strTest, Len(strTest) - 1)) 
```

*我使用`Long`它，因为它在速度方面非常出色`Integer`*

对于多个替换，一个`RegExp`可能会成为它自己的。开销太高，无法证明此示例的合理性

**测试代码**

```
Sub Test()
Dim dbTime As Double
Dim strTest As String
Dim lngTest As Long
Dim lngCnt As Long

strTest = "G14"

dbTime = Timer
For lngCnt = 1 To 1000000
lngTest = CLng(Right$(strTest, Len(strTest) - 1))
Next lngCnt
Debug.Print Timer - dbTime

dbTime = Timer
For lngCnt = 1 To 1000000
lngTest = CLng(Right(strTest, Len(strTest) - 1))
Next lngCnt
Debug.Print Timer - dbTimer

dbTime = Timer
For lngCnt = 1 To 1000000
Mid$(strTest, 1, 1) = "0"
lngTest = CLng(strTest)
Next lngCnt
Debug.Print Timer - dbTime
End Sub 
```

# android - 画布上的 Android 像素艺术渲染

> ID：12095698
> 
> 赞同：0
> 
> 时间：2012-08-23T15:59:32.247
> 
> 标签：android, canvas, bitmap, pixel

我正在制作一个模仿经典游戏的应用程序。因此我需要渲染一些像素艺术。

我有一个 100x100 位图作为缓冲区，我在缓冲区上绘制所有内容没有任何困难。

当我尝试在 480x480 画布上渲染它时，问题就来了。

Bitmap.createScaledBitmap 会给我一个模糊的位图，所以我使用下面的代码在“块（放大的像素）”之间进行清晰的划分。

```
float scale = getWidth() / 100f;
for(int y = 0 ; y < getHeight() ; y++){
    for(int x = 0 ; x < getWidth() ; x++){
        buffer2.setPixel(x, y, buffer.getPixel((int)(x / scale), (int)(y / scale)));
    }
} 
```

该代码运行良好，并且完全符合我的要求。但是性能很差（需要 300+ 毫秒）。所以我写信询问是否有更好的出路。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T16:04:17.690

我会做几件事：

1.  将你的`getHeight()`and`getWidth()`分解成局部变量，这样就不会在循环的每次迭代中调用它。（例如`int height = getHeight(); for(int y = 0; y < height; y++);`）

2.  使用中间数组来存储像素，然后当循环完成时，使用`setPixels()`方法而不是`setPixel()`一次设置所有像素——这比一次设置一个像素要有效得多。

# c# - Membership.ValidateUser() 的目的是什么

> ID：12095700
> 
> 赞同：7
> 
> 时间：2012-08-23T15:59:38.200
> 
> 标签：c#, asp.net, forms-authentication, membership

我一直在学习这`MembershipProvider`门课，我认为该`Membership.ValidateUser()`方法应该用于登录用户。

但是，我刚刚得知有一个`FormsAuthentication.Authenticate()`.

`ValidateUser()`内的目的是`Membership`什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-23T16:01:18.583

简而言之，有时您可能想要简单地验证用户是否就是他们所说的那个人，而无需将身份验证 cookie 保留任何时间长度。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T16:03:53.227

如果传递的用户名和密码存在于数据库中并且匹配并返回 true [Check MSDN](http://msdn.microsoft.com/en-us/library/system.web.security.membership.validateuser.aspx) ，它只会检查您的数据源（数据库） 。如果它们不匹配，则返回 false

```
public static bool ValidateUser(string username, string password) 
```

# node.js - Sequelize.js 中的前缀支持

> ID：12095701
> 
> 赞同：7
> 
> 时间：2012-08-23T15:59:41.263
> 
> 标签：node.js, prefix, sequelize.js

使用 Sequelize.js 时有什么方法可以支持带前缀的表名吗？

想象一下，我想建立一个博客平台，以便每个注册用户都可以获得自己的博客和 URL（子域）。现在，如果一个人打开`userxxx.mydomain.com`，他应该从命名的表中获取内容，`userxxx_TABLENAME`而打开时`difuser.mydomain.com`将从`difuser_TABLENAME`等中获取数据。

我尝试为模型名称添加前缀，例如：`sequelize.define('userxxx_Post' ...)`这可以工作，但在涉及多对多关系时会造成混乱（表名变为`userxxx_Postuserxxx_Comment`）。

有没有更好的办法？

（我并没有完全在 node.js 上构建博客平台，但这个问题的解决方案是一样的）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-07-14T15:20:18.853

可能你需要`tableName`选项？

[来自文档](http://sequelizejs.com/docs/1.7.8/models#block-14-line-19)

# php - 如何卸载 codeigniter 视图

> ID：12095704
> 
> 赞同：0
> 
> 时间：2012-08-23T16:00:10.053
> 
> 标签：php, codeigniter

在我想保持相同功能的相对繁重的功能中。

基本上在一个`$_POST`函数之前我已经加载了视图。在功能之后我有不同的看法。

然而，与以前相同的视图也显示出来了，只是被推到了新视图的下方，尽管我只是简单地调用了一个视图。

有没有类似的东西`$this->unload->view`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T16:09:21.523

CodeIgniter中没有`unload`方法。

您应该考虑重写您的代码，因为如果您想要该功能，它在任何方面都不正确。加载的视图几乎立即传递到输出。您唯一能做的就是将视图返回到某个变量以供以后使用：

```
$stored_view = $this->load->view('my_view', $data, true); 
```

那么你可以在条件句中使用它。

无论如何，我完全确定您在这里做错了什么。发布更多关于您要实现的目标和相关代码的描述，以便社区可以帮助您。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T06:03:13.683

不需要：很简单

```
if($_POST)
    $this->load->view('view1');
else
    $this->load->view('view2'); 
```

就是这样......或者你希望给出相同的视图但不同的参数然后你相对保留发布数据......你可以

```
$data['general'] = 'Main';
if($_POST)
    $data['for post'] = 'something';
$this->load->view('comman_view',$data); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-03-06T07:10:30.760

将需要检查的 $_POST 变量存储到变量中并将其传递给视图。然后，您可以在查看视图上传递的变量的值后呈现视图后，使用 jQuery 从 DOM 中删除加载的视图。使用它的缺点是渲染视图并再次删除它的冗余过程。

```
$("#the-id-of-the-added-view").remove(); 
```

但是正如@sergey-telshevsky 所建议的那样，您应该能够更改逻辑以不首先进行卸载。

# php - 修改 PayPal IPN 监听器以在支付完成时处理多个查询

> ID：12095716
> 
> 赞同：0
> 
> 时间：2012-08-23T16:00:58.957
> 
> 标签：php, mysql, sql, paypal, paypal-ipn

由于缺乏 PHP 知识，我无法修改我的 PayPal IPN 侦听器。

付款完成后，我的 IPN 侦听器将交易的详细信息插入到表“付款”中，但是我现在需要脚本来更新另一个名为“成员”的表，以便我可以轻松地判断谁已付款。

这是我想出的SQL：

```
"UPDATE `Members` SET paid='TRUE' WHERE id='".$data['custom']."' 
```

我正在使用 IPN 变量“自定义”从原始付款表单发送用户 ID。

我尝试在脚本中实现 mysqli_multi_query 但没有成功。我真的坚持这一点，如果有人能指出我正确的方向，那就太棒了。

这是我的PHP：

```
function check_txnid($tnxid){
    global $link;
    return true;
    $valid_txnid = true;
    //get result set
    $sql = mysql_query("SELECT * FROM `payments` WHERE txnid = '$tnxid'", $link);       
    if($row = mysql_fetch_array($sql)) {
        $valid_txnid = false;
    }
    return $valid_txnid;
}

function check_price($price, $id){
    $valid_price = false;
    //you could use the below to check whether the correct price has been paid for the product

    /* 
    $sql = mysql_query("SELECT amount FROM `products` WHERE id = '$id'");       
    if (mysql_numrows($sql) != 0) {
        while ($row = mysql_fetch_array($sql)) {
            $num = (float)$row['amount'];
            if($num == $price){
                $valid_price = true;
            }
        }
    }
    return $valid_price;
    */
    return true;
}

function updatePayments($data){ 
    global $link;
    if(is_array($data)){                
        $sql = mysql_query("INSERT INTO `payments` (txnid, payment_amount, payment_status, itemid, createdtime) VALUES (
                '".$data['txn_id']."' ,
                '".$data['payment_amount']."' ,
                '".$data['payment_status']."' ,
                '".$data['item_number']."' ,
                '".date("Y-m-d H:i:s")."' 
                )", $link);

    return mysql_insert_id($link);
    }
}

//Database Connection
$link = mysql_connect($host, $user, $pass);
mysql_select_db($db_name);

// Check if paypal request or response
if (!isset($_POST["txn_id"]) && !isset($_POST["txn_type"])){

    // Firstly Append paypal account to querystring
    $querystring .= "?business=".urlencode($paypal_email)."&";  

    // Append amount& currency (£) to quersytring so it cannot be edited in html

    //The item name and amount can be brought in dynamically by querying the $_POST['item_number'] variable.
    $querystring .= "item_name=".urlencode($item_name)."&";
    $querystring .= "amount=".urlencode($item_amount)."&";

    //loop for posted values and append to querystring
    foreach($_POST as $key => $value){
        $value = urlencode(stripslashes($value));
        $querystring .= "$key=$value&";
    }

    // Append paypal return addresses
    $querystring .= "return=".urlencode(stripslashes($return_url))."&";
    $querystring .= "cancel_return=".urlencode(stripslashes($cancel_url))."&";
    $querystring .= "notify_url=".urlencode($notify_url);

    // Append querystring with custom field
    //$querystring .= "&custom=".USERID;

    // Redirect to paypal IPN
    header('location:https://www.paypal.com/cgi-bin/webscr'.$querystring);
    exit();

}else{

    // Response from Paypal

    // read the post from PayPal system and add 'cmd'
    $req = 'cmd=_notify-validate';
    foreach ($_POST as $key => $value) {
        $value = urlencode(stripslashes($value));
        $value = preg_replace('/(.*[^%^0^D])(%0A)(.*)/i','${1}%0D%0A${3}',$value);// IPN fix
        $req .= "&$key=$value";
}

    // assign posted variables to local variables
    $data['item_name']          = mysql_real_escape_string($_POST['item_name']);
    $data['item_number']        = mysql_real_escape_string($_POST['item_number']);
    $data['payment_status']     = mysql_real_escape_string($_POST['payment_status']);
    $data['payment_amount']     = mysql_real_escape_string($_POST['mc_gross']);
    $data['payment_currency']   = mysql_real_escape_string($_POST['mc_currency']);
    $data['txn_id']             = mysql_real_escape_string($_POST['txn_id']);
    $data['receiver_email']     = mysql_real_escape_string($_POST['receiver_email']);
    $data['payer_email']        = mysql_real_escape_string($_POST['payer_email']);
    $data['custom']             = mysql_real_escape_string($_POST['custom']);

    // post back to PayPal system to validate
    $header = "POST /cgi-bin/webscr HTTP/1.0\r\n";
    $header .= "Content-Type: application/x-www-form-urlencoded\r\n";
    $header .= "Content-Length: " . strlen($req) . "\r\n\r\n";

    $fp = fsockopen ('ssl://www.paypal.com', 443, $errno, $errstr, 30); 

    if (!$fp) {
        // HTTP ERROR
    } else {    

        fputs ($fp, $header . $req);
        while (!feof($fp)) {
            $res = fgets ($fp, 1024);
            if (strcmp($res, "VERIFIED") == 0) {

                // Used for debugging
                //@mail("you@youremail.com", "PAYPAL DEBUGGING", "Verified Response<br />data = <pre>".print_r($post, true)."</pre>");

                // Validate payment (Check unique txnid & correct price)
                $valid_txnid = check_txnid($data['txn_id']);
                $valid_price = check_price($data['payment_amount'], $data['item_number']);
                // PAYMENT VALIDATED & VERIFIED!
                if($valid_txnid && $valid_price){               
                    $orderid = updatePayments($data);       
                    if($orderid){                   
                        // Payment has been made & successfully inserted into the Database                              
                    }else{                              
                    // Error inserting into DB
                    // E-mail admin or alert user
                    }
                }else{                  
                    // Payment made but data has been changed
                    // E-mail admin or alert user
                }                       

            }else if (strcmp ($res, "INVALID") == 0) {

                // PAYMENT INVALID & INVESTIGATE MANUALY! 
                // E-mail admin or alert user

                // Used for debugging
                //@mail("you@youremail.com", "PAYPAL DEBUGGING", "Invalid Response<br />data = <pre>".print_r($post, true)."</pre>");
            }       
        }       
    fclose ($fp);
    }   
}
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T16:46:08.957

只需进行两次查询

```
function updatePayments($data){ 
    global $link;
    if(is_array($data)){                
        $sql = mysql_query("INSERT INTO `payments` (txnid, payment_amount, payment_status, itemid, createdtime) VALUES (
                '".$data['txn_id']."' ,
                '".$data['payment_amount']."' ,
                '".$data['payment_status']."' ,
                '".$data['item_number']."' ,
                '".date("Y-m-d H:i:s")."' 
                )", $link);
         mysql_query("UPDATE `Members` SET paid='TRUE' WHERE id='".$data['custom'], $link);
    return mysql_insert_id($link);
    }
} 
```

# android - 是否可以强制 Phonegap 视频播放器插件横向打开？

> ID：12095717
> 
> 赞同：2
> 
> 时间：2012-08-23T16:00:59.960
> 
> 标签：android, video, plugins, cordova

我有一个需要强制横向或纵向的应用程序，我希望将其扩展到我用来打开其他应用程序的意图。

所以我的意图是Simon MacDonald 为 PhoneGap 提供的出色[插件。](http://simonmacdonald.blogspot.de/2011/11/video-player-plugin-for-phonegap.html)由于我想播放的视频是横向拍摄的，所以让视频播放器也可以横向拍摄会很好。（是的，特定的视频，不是随机的）。由于 html5 视频标签被破坏，我被卡住了。

据我所知，屏幕方向的更改可以在 android manifest 中使用Phonegap的[插件（无法获取打开的应用程序）或使用 setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_LANDSCAPE) 以编程方式完成；](https://github.com/champierre/pg-plugin-screen-orientation)我已经尝试过所有这些版本，但由于我对 Java 很垃圾，我可能修补了错误的部分和位。因此，我没有要排除故障的代码，因为我所做的任何事情都没有任何效果或导致任何错误消息。

亲爱的互联网，把你的智慧洒在我身上。

# visual-studio - Visual Studio 构建速度非常慢

> ID：12095718
> 
> 赞同：79
> 
> 时间：2012-08-23T16:01:00.017
> 
> 标签：visual-studio, performance, build

这适用于 2008 和 2010 版本（也可能是更早的版本）。也适用于 C++ 和 C# 项目。

初始构建（重新启动后）以正常速度运行并具有相当好的 CPU 利用率。在“一段时间”之后（即使用计算机处理“东西”），后续构建可能会运行得非常、非常缓慢，并且CPU 使用率非常*低。*我发现的唯一修复似乎是重新启动，然后循环重新开始。WPF 和非 WPF 项目都会发生这种情况，但 WPF 的情况会差 10 倍。

这发生在不同的机器上，甚至为不同的组织工作，所以我认为这是 Visual Studio 的事情，而不是环境的事情。我已经尝试过通常的方法（谷歌，关闭 AV、Intellisense、Resharper 等，目前期待获得我订购的 SSD）。

我目前的机器规格是 2.7gig 四核、4GB RAM、XP（还没有 Win7 工作）、250Gb 硬盘等

任何人都知道这可能是什么以及如何解决它？

提前致谢！

* * *

## 回答 #1

> 赞同：121
> 
> 时间：2013-03-11T04:01:40.987

试试这个，因为它对我有用：

按`Windows`+`R`或从“开始”打开运行。

现在输入`%temp%`并从那里删除所有内容......

现在再次打开运行并`prefetch`从那里键入并删除所有内容。

现在打开 VS 看看性能。

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2013-02-01T07:17:29.637

尝试这个：

Devenv.exe /resetsettings

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2013-05-20T14:44:00.660

I had the same problem.

I had McAfee security center installed, by disabling the "Real time scan"

Building times did go from 40 seconds for a small project to 1 second.

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2016-02-05T12:16:09.170

检查 Windows 中的省电设置。将其设置为“高性能”（即使在桌面上）。这对我有帮助。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2014-07-04T10:12:21.657

尝试使用 ProcessMonitor ( [http://technet.microsoft.com/en-us/sysinternals/bb896645](http://technet.microsoft.com/en-us/sysinternals/bb896645) ) 来查找 Visual Studio 在构建过程中所做的事情。添加过滤器“ProcessName is devenv.exe then Include”并进行一些研究。这对我很有用。

我有一个类似的问题 - 构建和调试过程非常缓慢 - 我可以使用 Process Monitor 解决它。我运行 Process Monitor 并看到 Visual Studio 进程多次读写一些 HTL 文件。它是程序集绑定日志 ( [http://msdn.microsoft.com/en-us/library/vstudio/e74a18c4(v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/vstudio/e74a18c4%28v=vs.100%29.aspx) ) - 存储有关库绑定信息的实用程序。一旦我启用了这个日志，这个实用程序会在我的硬盘上创建大约 8 Gb HTM 日志）它非常慢。然后我禁用日志记录，我的项目的构建时间从 10 分钟减少到 10 秒！

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2017-03-13T03:28:34.767

我在 Windows 10 上使用 VS2015 并且遇到了同样的问题。我清除了不起作用的 %temp% 和预取目录。然后我将省电设置从平衡更改为高性能并且它起作用了。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2018-05-24T10:56:20.003

我没有看到这种类型的答案，所以我认为我的答案可能对某人有帮助。我对 VS 构建时间的问题是一个愚蠢的问题：**我在另一台计算机上有源代码。**每次我尝试构建它时，都必须与那台计算机建立连接，这导致 VS 冻结时间很长一段时间。在尝试了这里和其他地方的大多数解决方案后，我发现了这个问题。（我的头撞在桌子上的表情）

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2017-05-05T10:10:59.767

我遇到过同样的问题。删除解决方案目录中的隐藏`.vs`文件夹解决了问题。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2014-12-23T06:34:00.410

如果单个解决方案中有多个项目，请尝试仅构建已更改的项目，而不是构建整个解决方案。即，Alt+B+U 而不是 Alt+B+B。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2013-03-03T07:15:05.547

我对非常缓慢的 Visual Studio（构建任何东西大约需要 1.5-2 分钟）的解决方法是关闭无线网络。

除了有线网络之外，我还启用了无线网络。似乎我的计算机试图使用无线连接连接到无线网络不可用的本地服务器，这导致了长时间的延迟。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2018-06-23T23:41:08.807

原因之一是 Visual Studio 不断重建相同的依赖项目，尽管没有任何改变。想象一下，一个解决方案有大量的项目，这些项目无缘无故地不断构建。这会浪费大量时间...

对此的主要解决方案是修改设置为“**始终”的每个“****复制到输出目录**”。将其更改为“**如果更新则复制**”。

 ****查看详细的构建日志可能会有所帮助。打开**工具**>**选项**>“**项目和解决方案**”>“**构建和运行**”。现在将“MSBuild 项目构建输出详细程度”设置为“**诊断**”

有关更多信息，[此线程](https://stackoverflow.com/questions/14916729/visual-studio-rebuilds-unmodified-projects)讨论了这一点

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2021-02-17T07:50:35.453

转到**工具 > 选项 > “项目和解决方案” > “构建和运行”**。现在将“MSBuild project build output verbosity”设置为“Normal”或“Minimal”，其他设置“MSBuild project build log file verbosity”相同。

我之前将其设置为“诊断”，这导致构建持续时间较长。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2015-07-27T04:10:34.460

如果它是 ASP.NET MVC 项目，请检查 .csproj 以查看是否`<MvcBuildViews>true</MvcBuildViews>`已设置。这可能会导致构建缓慢。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2012-08-23T16:08:09.330

“Some time”大约有多长？（例如，小时？天？）

它可能就像您用完 RAM 一样简单。Ctrl-Shift-Esc 将加载进程监视器，您可以在其中查看内存利用率并杀死猪。一旦它运行不足，您的链接器将减慢尝试将内存交换到磁盘的速度（并且 Windows 通常不会报告交换开销，除非您打开系统利用率）。根据项目的大小，链接可以使用大量的内存制作表。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2014-03-04T13:10:44.463

备份文件并删除此文件夹中文件夹中的所有内容。

> **C:\Users\{用户名}\AppData\Local\Microsoft\WebsiteCache**

重新启动 Visual Studio 并检查性能。

希望这可以帮助！谢谢

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2014-09-05T14:06:35.033

检查您的 Internet 属性选项（连接）并确保`Automatically detect settings`已选中。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2013-07-11T11:35:31.200

在某个时候，我有一个程序在几周后需要花费相当多的时间来编译。出于沮丧，我删除了解决方案和项目的调试文件夹。Visual Studio 所做的是首先重建整个解决方案（这确实需要一些时间），但在那之后，构建过程又恢复了原来的速度。不确定它是否也适合您。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2018-10-30T12:28:31.290

作为快速检查，运行扫描以确保您当前没有任何东西感染您的系统，然后转到 Windows Defender 安全中心-> 病毒和威胁防护-> 禁用实时保护：

实时保护

在 Visual Studio 中重建您的解决方案，注意它所花费的总时间并在任务管理器中观察以查看反恶意软件服务可执行文件是否似乎正在消耗大量处理器时间。假设您的构建速度更快且 CPU 不那么繁忙，那么恭喜您，您已经确定了导致性能问题的原因之一。下一步是负责任地告诉 Windows Defender，不要完全关闭 Visual Studio，不要将其完全关闭。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2019-11-13T11:13:12.930

由于我是通过 Google 搜索来到这里的，因此我将发布我找到的内容作为我特定问题的解决方案。

我已从 .NET Core 1.1 升级到 .NET Core 2.1。这导致 RazorGenerate 和 RazorTagHelper 调用各需要 20 秒。根据 Daniel Crabtree 的说法，这是由 .NET Core 2.1 中的更改引起的，该更改默认启用预编译 Razor 视图。

解决方法是将以下内容添加到您的 .csproj 中：

```
<PropertyGroup>
  <UseRazorBuildServer>false</UseRazorBuildServer>
</PropertyGroup> 
```

来源：[https ://www.danielcrabtree.com/blog/444/speed-up-compilation-of-asp-net-core-2-1-projects](https://www.danielcrabtree.com/blog/444/speed-up-compilation-of-asp-net-core-2-1-projects)

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2021-10-07T11:48:40.447

我已经更新了所有的 NuGet 包并且它工作了！

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2019-08-01T20:05:15.177

就我而言，我使用项目目录中的“wwwroot”目录来存储几 GB 的数据。将“wwwroot”移到解决方案目录之外解决了我的构建时间。对于我的 .NET Core Web 应用程序，我编辑了 launchSettings.json 并添加了新的环境变量`ASPNETCORE_WEBROOT`：

```
...
"profiles": {
    "Development": {
      "commandName": "Project",
      "environmentVariables": {
        "ASPNETCORE_ENVIRONMENT": "Development",
        "ASPNETCORE_WEBROOT": "../../wwwroot"
      },
      "applicationUrl": "https://localhost:5001;http://localhost:5000"
    },
... 
```

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2020-12-24T04:05:55.503

在 YourProject.csproj 中，在**项目**标签的最后一行添加**目标标签**

 **```
<Project>
.
.
<Target Name="PlatformVerificationTask" Condition="'$(SkipPlatformVerification)' 
    != 'true'" />  
</Project> 
```

* * *

## 回答 #23

> 赞同：-1
> 
> 时间：2019-07-20T17:16:39.540

我在 VS 上运行的任何命令或函数都存在同样的问题。禁用防病毒实时保护后，运行时间从 10 秒减少到 0.5 秒甚至更少。顺便说一句，有趣的是杀毒软件的行为正在减慢 C# 的运行时间，但 C++ 完全没问题。******

# javascript - Jasmine spy 哪个函数调用了一个方法

> ID：12095719
> 
> 赞同：0
> 
> 时间：2012-08-23T16:01:00.693
> 
> 标签：javascript, unit-testing, jasmine

我知道我可以查看是否调用了函数方法以及使用了哪些参数。但是是否有可能查看哪些函数调用了它？所以实际上我想找出在我的代码中调用函数的位置。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T18:27:50.910

不知道为什么你需要测试这个，但你可以模拟你想调用的函数并[`arguments.callee.caller`](https://stackoverflow.com/questions/280389/how-do-you-find-out-the-caller-function-in-javascript)在模拟函数中使用来获取调用你的函数的函数。

# c++ - 列表的迭代器类型

> ID：12095725
> 
> 赞同：-3
> 
> 时间：2012-08-23T16:01:11.640
> 
> 标签：c++

我知道`vector<double>::iterator`返回**随机访问迭代**器类型。返回的迭代器类型是`list<double>::iterator`什么。它是**双向迭代器**吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-23T16:03:11.363

是的`bidirectional iterator`。

n3337 23.3.5.1/1

**列表是支持双向迭代器的序列容器**

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-23T16:01:54.460

它是双向的，因为您仍然可以在其上使用 ++ 和 -- 。如果你只能做 ++ 它是一个前向迭代器（见 std::forward_list ）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-25T20:41:47.230

好的，我的大部分问题本身都是错误的。经过长时间的 C++ 参考研究，我明白了。由于我的问题没有多大意义，我会自己回答。`vector<double>::iterator`返回一些东西是没有意义的。它是一个**类型**.C++ 标准库，在类中大量使用 typedef 来给其他类型起别名。

类型也是如此`vector<double>:iterator`。更准确地说，它是一个别名（使用 typedef）。在 的情况下，别名是类型。在 的情况下，`vector<double>::iterator`是类型迭代器的别名。`random-access Iterator``list<double>::iterator``iterator``bi-directional`

这也类似于`vector<double>::size_type`where `size_type`is a type ，它是 type 的`size_t`别名

即`typedef size_t size_type`在`vector<double>`课堂上。

如果您发现任何误解或错误。请澄清。

# visual-studio-2012 - Visual Studio 2012 中的 Visio 绘图控制失败

> ID：12095726
> 
> 赞同：1
> 
> 时间：2012-08-23T16:01:12.503
> 
> 标签：visual-studio-2012, visio

我在 Visual Studio 2012 中使用 Visio 14.0 绘图控件 (Visio 2010) 时遇到问题。使用此控件的 VS2012 中似乎存在错误。您可以通过启动一个新的 win 表单应用程序来轻松重现这一点，然后从工具箱中选择 Microsoft Office 14.0 Visio 绘图控件并将其拖放到表单上。一旦你放下它，你会得到这个错误：

“错误 hresult e_fail 已从对 com 组件的调用中返回”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T14:13:55.700

以防万一其他人有同样的问题，这是一个 Visual Studio 2012 错误（MS 正在处理它）。一种解决方法是将 Office 安装目录（通常是“C:\Program Files (x86)\Microsoft Office\Office14”）附加到 PATH 环境变量中。

# javascript - 'use strict' vs jlint & 其他工具

> ID：12095729
> 
> 赞同：1
> 
> 时间：2012-08-23T16:01:16.277
> 
> 标签：javascript

我一直在寻找一段时间来了解使用“use strict”有多好，但是在 IE10 出现之前它仍在争论中，但抛开这一点，我真的很想了解浏览器如何解释“use strict”stmt。我说解释的原因是想了解运行时意志是否缓慢。

如果它被用作提早捕获机制来提高代码和性能，为什么我们需要在 js 文件中声明它。为什么不使用 jlint 和其他外部工具来帮助修复代码、错误和提高性能。就像我们在 Eclipse 中使用 findbugs 和其他工具来修复 java 相关的为什么不用于 JS 一样。更大的问题是浏览器会在看到严格的词时变得过于谨慎，然后最好继续使用 jslint 等外部工具。我确实参考了下面的链接，其中在“sunspider”站点中给出了示例，但不确定它是否异常，或者浏览器执行在看到严格的单词时确实没有改变，因此它的性能不会降低。

[严格模式是否更高效？](https://stackoverflow.com/questions/3145966/is-strict-mode-more-performant)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T16:07:27.970

你没有理由不能`"use strict"`和**jsLint** / **jsHint**一起使用来检查你的代码质量。不同之处在于，**严格模式**使用社区已经同意的已建立的 JavaScript / **ECMAScript 5 标准**，而 jsLint 等代码质量工具则更加固执己见（咳咳，Douglas Crockford）。这是 John Resig 描述严格模式的帖子：

[John Resig 谈严格模式](http://ejohn.org/blog/ecmascript-5-strict-mode-json-and-more/)

如果您对性能感兴趣，我创建了一个[jsPerf 测试](http://jsperf.com/strict-mode-v-non-strict-mode)来测试我的 jQuery 插件 Tocify，使用和不使用严格模式。表现完全一样。

# android - 如何从堆栈中删除活动

> ID：12095732
> 
> 赞同：0
> 
> 时间：2012-08-23T16:01:21.967
> 
> 标签：android

我正在制作一个应用程序，我想确保只有一个活动的一个实例应该保留在堆栈中。请告诉我如何实现这一点。这是我正在尝试但没有得到预期结果的编码。

```
ArrayList<String> runningactivities = new ArrayList<String>();

    ActivityManager activityManager = (ActivityManager)getBaseContext().getSystemService (Context.ACTIVITY_SERVICE); 

    List<RunningTaskInfo> services = activityManager.getRunningTasks(Integer.MAX_VALUE); 

        for (int i1 = 0; i1 < services.size(); i1++) { 
            runningactivities.add(0,services.get(i1).topActivity.toString());  
        } 

        if(runningactivities.contains("ComponentInfo{com.velosys.interview_preparation/com.velosys.interview_preparation.activities.MCQ}")==true){
             Toast.makeText(getBaseContext(),"Activity is in foreground, active",1000).show(); 
            //MCQ.
        } 
```

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T16:34:41.253

**这是Activity Launch Mode**的典型案例。

官方的 Android 文档非常精确且连贯，恕我直言。

查看段落[android:launchMode](http://developer.android.com/guide/topics/manifest/activity-element.html)。singleTask模式可能*是*您正在寻找的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T16:34:02.447

在活动的 onStop() 或 onPause() 方法中放入“finish()”命令。所以每次退出这个activity都会从activity stack中移除，所以不会有重复。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T17:12:44.730

您可以在启动活动时设置意图标志。在你的情况`FLAG_ACTIVITY_SINGLE_TOP`和`FLAG_ACTIVITY_CLEAR_TOP`

# amazon-web-services - 可以在 ELB 后面创建私有节点吗？

> ID：12095735
> 
> 赞同：0
> 
> 时间：2012-08-23T16:01:31.217
> 
> 标签：amazon-web-services, load-balancing

我想知道这是否可能。我有一个 AWS 弹性负载均衡器，目前它后面有三台服务器。这三台服务器位于 VPC 内部。我想知道的是，我是否可以在 VPC 内部或外部创建第四个服务器，并将其放在 ELB 后面以利用多个服务器 CPU，然后使该新服务器成为只能访问某个 IP 的私有节点范围。我想抛出另一台服务器，我可以对其进行性能和速度调整，利用 ELB 来平衡 CPU 使用率，这样我就可以进行测试，如果它坏了，它不会影响任何人。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T23:02:12.870

你可能会对此偷偷摸摸。没有什么说你不能用多个 ELB 注册实例，所以你可以做的是：

1.  设置一个全新的 ELB。
2.  将其安全组限制在您狭窄的 IP 范围内。
3.  使用新的 ELB 注册您的前三台服务器。他们现在注册了两个不同的 ELB。
4.  使用新的 ELB 注册您的第四台服务器，而不是旧的。
5.  在您使用的任何端口（大概是 80）上启用来自新 ELB 安全组的流量到所有四个实例。

新的、秘密的、IP 限制的 ELB 将在所有四个实例之间分配流量，但应该为第四个实例提供一个相当公平的测试平台。如果第四个实例倒下，可以断定它在 0.0.0.0/0 流量中的表现会更糟。

不幸的是，我无法在 ELB 中说“将这些端口上的流量从这些 IP 转发到仅此实例”。这完全违背了它的目的，即使它在性能测试中真的很有用。

# sql - 尝试使用带有 HSQLDB 2.2.8 的 SQL 工具创建存储过程时出现未终止的输入错误

> ID：12095739
> 
> 赞同：1
> 
> 时间：2012-08-23T16:01:49.623
> 
> 标签：sql, stored-procedures, hsqldb

我有一个非常简单的 HSQLDB CREATE PROCEDURE 语句：

```
CREATE PROCEDURE test_procedure()
CONTAINS SQL
BEGIN
DECLARE test_variable INTEGER;
SET test_variable = 0;
END 
```

当我尝试使用 SQLTool 执行此 SQL 时，它失败并出现“未终止的输入”错误。我正在使用的命令是：

```
java -jar -cp $HSQLDB_HOME/lib/sqltool.jar:$HSQLDB_HOME/lib/hsqldb.jar $HSQLDB_HOME/lib/sqltool.jar db script.sql 
```

我得到的确切错误是：

```
SEVERE  Error at 'script.sql' line 7:
"? CREATE PROCEDURE test_procedure()
CONTAINS SQL
BEGIN ATOMIC
DECLARE test_variable INTEGER;
SET test_variable = 0;
END"
Unterminated input:  "CREATE PROCEDURE test_procedure()
CONTAINS SQL
BEGIN ATOMIC
DECLARE test_variable INTEGER;
SET test_variable = 0;
END"
org.hsqldb.cmdline.SqlTool$SqlToolException 
```

到目前为止，我已经弄清楚了这么多：

1.  如果我使用 HSQLDB 提供的 GUI 工具之一（如 DatabaseManagerSwing）运行此 SQL，它可以正常工作。
2.  我可以使用完全相同的命令（选择、插入、删除等）执行其他 SQL 语句，但不能执行 CREATE PROCEDURE
3.  我的 script.sql 文件只包含 6 行，但错误提到了第 7 行，这对我来说毫无意义
4.  在文件中的 SQL 末尾添加分号没有区别
5.  我在 Windows 和 Linux 上都试过了，结果完全相同
6.  我试图通过标准输入将文件传递给 SQL 工具，并使用具有完全相同结果的内联 SQL
7.  我尝试将存储过程主体更改为其他内容，但没有任何区别

在这一点上，我没有想法。有没有人遇到过这个错误？有什么可以做的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T17:48:03.597

您可以按照指南中的示例并将示例文件用作模板：

[http://hsqldb.org/doc/2.0/util-guide/sqltool-chapt.html#sqltool_embedded-langs-sect](http://hsqldb.org/doc/2.0/util-guide/sqltool-chapt.html#sqltool_embedded-langs-sect)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-11-17T15:18:07.687

在使用包含 SQL 转义单引号的 HSQLDB 执行 SQL 语句时，我偶然发现了这个错误，如下所示：

```
INSERT INTO my_table ('Joe\'s string value'); 
```

* * *

上面的语法似乎不正确（至少对于 MySQL，例如，请参见[此处](https://stackoverflow.com/a/9596819/321797)）并且不应该遇到它。作为参考，正确的转义语法是：

```
INSERT INTO my_table ('Joe''s string value'); 
```

所以用`''`而不是`\'`. 然而，传递给我的一些 SQL 转储确实包含这种转义语法，我不得不处理它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-03-31T15:41:16.753

我也在把头发拉出来。这些示例实际上并没有解决问题，但稍加修修补补让我到了那里。要处理嵌入的分号，您需要在“原始模式”中“分块”输入。进入原始模式输入命令 `\.`（是的，斜线点）然后你的代码，**在新的一行**

```
.; 
```

如果你只是把`.;`END 之后，它不会被看到（`.;`我猜它本身就是一个命令）。

# php - call_user_func_array 调用自制扩展函数时的参考问题

> ID：12095742
> 
> 赞同：0
> 
> 时间：2012-08-23T16:01:53.157
> 
> 标签：php, reference

我的php版本是5.2.17，我做了一个php函数

```
PHP_FUNCTION(GetProductFamily)
{
zval *productFamily;
int ret;

if(zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, "z",&productFamily) == FAILURE)
{
return;
}

productFamily->value.lval = 1;
RETURN_LONG(WS_OK);
} 
```

一个 $productFamily 被传递给这个函数，它的值将被改变。

然后在php中，如果我只调用这个函数就可以了：

```
<?php
$productFamily=0;
GetProductFamily(&$productFamily);
echo $productFamily;
?>
return 1;

or without &

<?php
$productFamily=0;
GetProductFamily($productFamily);
echo $productFamily;
?>
still return 1. 
```

但是当我使用 call_user_func_array 调用这个函数时事情变得很奇怪

```
<?php
  $productFamily = 0;
call_user_func_array('GetProductFamily', array(&$productFamily));
echo $productFamily; //return 0, should be 1 !
?> 
```

然而

```
<?php
  $productFamily = 0;
call_user_func_array('GetProductFamily', array($productFamily));
echo $productFamily; //return 1 this time...
?> 
```

因为 GetProductFamily 可以更改 $productFamily，所以我想我们必须在这里通过引用，但是正如您所见，& 不起作用....我很困惑，因为当谈到 PHP 提供的一些基本功能时, & 是必需的！

```
<?php
$array = array("ab","cd");
call_user_func_array("array_shift", array(&$array));
var_dump($array); //return array("cd");
?>
means
<?php
$array = array("ab","cd");
call_user_func_array("array_shift", array($array));
var_dump($array); //return array("ab","cd");
?> 
```

为什么？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T06:57:01.650

只有在内部函数中，在扩展时才需要“&”，似乎 zval 已经为你做了一切

# php - 如何将友好的网址转换为原始网址

> ID：12095745
> 
> 赞同：0
> 
> 时间：2012-08-23T16:01:54.937
> 
> 标签：php, .htaccess, seo, friendly-url

我有一个已使用 .htaccess 转换为 SEO 友好 url 的 URL。但现在我需要找到原始 url，以便我可以编辑文件并在 Web 服务器上找到它。转换后的友好 url 是

是否可以取回原始网址，以便它可以位于服务器上。谢谢您的建议。

.htaccess 文件视图。

```
# 1.To use URL Alias you need to be running apache with mod_rewrite enabled. 

# 2\. In your opencart directory rename htaccess.txt to .htaccess.

# For any support issues please visit: http://www.opencart.com

Options +FollowSymlinks

# Prevent Directoy listing 
Options -Indexes

# Prevent Direct Access to files
<FilesMatch "\.(tpl|ini|log)">
 Order deny,allow
 Deny from all
</FilesMatch>

# SEO URL Settings
RewriteEngine On
# If your opencart installation does not run on the main web folder make sure you folder it does run in ie. / becomes /shop/ 

RewriteBase /
RewriteRule ^sitemap.xml$ index.php?route=feed/google_sitemap [L]
RewriteRule ^googlebase.xml$ index.php?route=feed/google_base [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_URI} !.*\.(ico|gif|jpg|jpeg|png|js|css)
RewriteRule ^([^?]*) index.php?_route_=$1 [L,QSA]

### Additional Settings that may need to be enabled for some servers 
### Uncomment the commands by removing the # sign in front of it.
### If you get an "Internal Server Error 500" after enabling any of the following settings, restore the # as this means your host doesn't allow that.

# 1\. If your cart only allows you to add one item at a time, it is possible register_globals is on. This may work to disable it:
# php_flag register_globals off

# 2\. If your cart has magic quotes enabled, This may work to disable it:
# php_flag magic_quotes_gpc Off

# 3\. Set max upload file size. Most hosts will limit this and not allow it to be overridden but you can try
# php_value upload_max_filesize 999M

# 4\. set max post size. uncomment this line if you have a lot of product options or are getting errors where forms are not saving all fields
# php_value post_max_size 999M

# 5\. set max time script can take. uncomment this line if you have a lot of product options or are getting errors where forms are not saving all fields
# php_value max_execution_time 200

# 6\. set max time for input to be recieved. Uncomment this line if you have a lot of product options or are getting errors where forms are not saving all fields
# php_value max_input_time 200 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T16:09:36.897

看来网址是

```
http://www.mycorporateservices.com/index.php?_route_=Corporate-Services 
```

Opencart 使用动作和控制器来解析参数并显示页面。你应该寻找一个`<web_app>/controller/module`or`<web_app>/catalog/controller/module`文件夹，那里可能`Corporate-Services.php`

# opencl - clGetEventProfilingInfo() 时间戳是否同步？

> ID：12095748
> 
> 赞同：1
> 
> 时间：2012-08-23T16:01:58.657
> 
> 标签：opencl, performance-testing, multi-gpu

我正在尝试在多 GPU 环境中分析代码，`clGetEventProfilingInfo()`但在我看来，我无法关联来自不同 GPU 的时间戳。一个简单的[代码示例](https://github.com/matze/mgpu)使用两个 GPU 的速度是使用一个 GPU 的两倍，但时间戳表明一个 GPU 在另一个 GPU 开始之前执行了大部分工作。

[规范] [http://www.khronos.org/registry/cl/sdk/1.1/docs/man/xhtml/clGetEventProfilingInfo.html](http://www.khronos.org/registry/cl/sdk/1.1/docs/man/xhtml/clGetEventProfilingInfo.html)）只是说，这样的时间戳是*“描述当前设备时间计数器以纳秒为单位 [...]"*。

我是否必须假设这些不必同步？

* * *

供参考：

*   我正在使用两个带有 NVIDIA 驱动程序版本 295.40、Linux 内核 2.6.35 的 NVIDIA GTX 580
*   [我已经在Khronos 论坛上](http://www.khronos.org/message_boards/viewtopic.php?f=28&t=5250)问过这个问题，但还没有收到回复。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T16:31:08.073

该规范还说*“OpenCL 设备需要正确跟踪设备频率和电源状态变化的时间。”* 这意味着返回的时间在两个设备之间以及每个设备与“真实”挂钟时间之间仅相差一个常数。

# java - Apache HTTPClient SSLPeerUnverifiedException

> ID：12095758
> 
> 赞同：14
> 
> 时间：2012-08-23T16:02:44.927
> 
> 标签：java, ssl, apache-httpclient-4.x

使用 Apache HttpClient 4.2.1。使用从基于表单的登录示例中复制的代码

[http://hc.apache.org/httpcomponents-client-ga/examples.html](http://hc.apache.org/httpcomponents-client-ga/examples.html)

访问受 SSL 保护的登录表单时出现异常：

```
Getting library items from https://appserver.gtportalbase.com/agileBase/AppController.servlet?return=blank
javax.net.ssl.SSLPeerUnverifiedException: peer not authenticated
Closing http connection
at sun.security.ssl.SSLSessionImpl.getPeerCertificates(SSLSessionImpl.java:397)
at org.apache.http.conn.ssl.AbstractVerifier.verify(AbstractVerifier.java:128)
at org.apache.http.conn.ssl.SSLSocketFactory.connectSocket(SSLSocketFactory.java:572)
at org.apache.http.impl.conn.DefaultClientConnectionOperator.openConnection(DefaultClientConnectionOperator.java:180)
at org.apache.http.impl.conn.ManagedClientConnectionImpl.open(ManagedClientConnectionImpl.java:294)
at org.apache.http.impl.client.DefaultRequestDirector.tryConnect(DefaultRequestDirector.java:640)
at org.apache.http.impl.client.DefaultRequestDirector.execute(DefaultRequestDirector.java:479)
at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:906)
at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:805)
at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:784) 
```

据我所知，证书很好（请参阅堆栈跟踪之前的 URL），没有过期 - 浏览器不会抱怨。

我尝试将证书导入我的密钥库

[如何使用 Apache HttpClient 处理无效的 SSL 证书？](https://stackoverflow.com/questions/1828775/how-to-handle-invalid-ssl-certificates-with-apache-httpclient)

没有变化。我相信您可以创建一个自定义 SSLContext 来强制 Java 忽略该错误，但我宁愿修复根本原因，因为我不想打开任何安全漏洞。

有任何想法吗？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-08-23T16:40:52.317

**编辑**我意识到这个答案很久以前就被接受了，并且也被投票了 3 次，但它（至少部分）不正确，所以这里有更多关于这个例外的信息。造成的不便，深表歉意。

> javax.net.ssl.SSLPeerUnverifiedException：对等体未通过身份验证

这*通常*是远程服务器根本没有发送证书时抛出的异常。但是，有一个边缘情况，在使用 Apache HTTP Client 时会遇到，因为它在这个版本中的实现方式，也因为`sun.security. ssl.SSLSocketImpl.getSession()`实现方式。

使用 Apache HTTP Client 时，远程证书不受信任时也会抛出此异常，通常会抛出“ `sun.security.validator.ValidatorException: PKIX path building failed`”。

`SSLSession`发生这种情况的原因是因为 Apache HTTP 客户端在执行任何其他操作之前尝试获取和对等证书。

提醒一下，有[3 种使用 启动握手的方法`SSLSocket`](http://docs.oracle.com/javase/7/docs/api/javax/net/ssl/SSLSocket.html)：

> *   调用显式开始握手的 startHandshake，或
> *   任何在此套接字上读取或写入应用程序数据的尝试都会导致隐式握手，或者
> *   如果当前没有有效会话，则调用 getSession 会尝试建立会话，并完成隐式握手。

以下是 3 个示例，均针对具有不受信任证书的主机（使用`javax.net.ssl.SSLSocketFactory`，而不是 Apache 的）。

示例 1：

```
 SSLSocketFactory ssf = (SSLSocketFactory) sslContext.getSocketFactory();
    SSLSocket sslSocket = (SSLSocket) ssf.createSocket("untrusted.host.example",
            443);
    sslSocket.startHandshake(); 
```

这会抛出“ `javax.net.ssl.SSLHandshakeException: sun.security.validator.ValidatorException: PKIX path building failed`”（如预期的那样）。

示例 2：

```
 SSLSocketFactory ssf = (SSLSocketFactory) sslContext.getSocketFactory();
    SSLSocket sslSocket = (SSLSocket) ssf.createSocket("untrusted.host.example",
            443);
    sslSocket.getInputStream().read(); 
```

这也会抛出“ `javax.net.ssl.SSLHandshakeException: sun.security.validator.ValidatorException: PKIX path building failed`”（如预期的那样）。

示例 3：

```
 SSLSocketFactory ssf = (SSLSocketFactory) sslContext.getSocketFactory();
    SSLSocket sslSocket = (SSLSocket) ssf.createSocket("untrusted.host.example",
            443);
    SSLSession sslSession = sslSocket.getSession();
    sslSession.getPeerCertificates(); 
```

但是，这会抛出`javax.net.ssl.SSLPeerUnverifiedException: peer not authenticated`.

[这是Apache HTTP 客户端`AbstractVerifier`](https://github.com/apache/httpclient/blob/4.2.1/httpclient/src/main/java/org/apache/http/conn/ssl/AbstractVerifier.java#L116)[`org.apache.http.conn.ssl.SSLSocketFactory`](https://github.com/apache/httpclient/blob/4.2.1/httpclient/src/main/java/org/apache/http/conn/ssl/SSLSocketFactory.java#L570)在 4.2.1 版本中使用的逻辑。更高版本根据[问题 HTTPCLIENT-1346](https://issues.apache.org/jira/browse/HTTPCLIENT-1346)中的报告对[进行显式调用`startHandshake()`](https://github.com/apache/httpclient/blob/4.2.x/httpclient/src/main/java/org/apache/http/conn/ssl/SSLSocketFactory.java#L436)。

这最终似乎来自 的实现[`sun.security. ssl.SSLSocketImpl.getSession()`](https://github.com/openjdk-mirror/jdk7u-jdk/blob/master/src/share/classes/sun/security/ssl/SSLSocketImpl.java#L2182)，它捕获`IOException`了调用`startHandshake(false)`（内部方法）时抛出的潜在 s，而不是进一步抛出它。这可能是一个错误，尽管这不会产生巨大的安全影响，因为`SSLSocket`无论如何它仍然会被关闭。

示例 4：

```
 SSLSocketFactory ssf = (SSLSocketFactory) sslContext.getSocketFactory();
    SSLSocket sslSocket = (SSLSocket) ssf.createSocket("untrusted.host.example",
            443);
    SSLSession sslSession = sslSocket.getSession();
    // sslSession.getPeerCertificates();
    sslSocket.getInputStream().read(); 
```

`javax.net.ssl.SSLHandshakeException: sun.security.validator.ValidatorException: PKIX path building failed`值得庆幸的是，每当您实际尝试使用它时，它仍然会抛出“ ” `SSLSocket`（通过获取会话而不获取对等证书没有漏洞）。

* * *

*如何解决这个问题*

与不受信任的证书的任何其他问题一样，问题在于确保您使用的信任存储包含必要的信任锚（即颁发您要验证的链的 CA 证书，或者可能是实际的服务器特殊情况的证明）。

要解决此问题，您应该将 CA 证书（或者可能是服务器证书本身）导入您的信任库。你可以这样做：

*   在您的 JRE 信任存储中，通常是`cacerts`文件（这不一定是最好的，因为这会影响使用该 JRE 的所有应用程序），
*   在您的信任库的本地副本中（您可以使用`-Djavax.net.ssl.trustStore=...`选项进行配置），
*   通过为该连接创建一个特定`SSLContext`的（如[本答案](https://stackoverflow.com/a/10406233/372643)中所述）。（有些人建议使用什么都不做的信任管理器，但这会使您的连接容易受到 MITM 攻击。）

* * *

*初步答案*

> javax.net.ssl.SSLPeerUnverifiedException：对等体未通过身份验证

这与信任证书或您必须创建自定义无关`SSLContext`：这是因为服务器根本没有发送任何证书。

此服务器明显未配置为正确支持 TLS。这失败了（您不会获得远程证书）：

> ```
> openssl s_client -tls1 -showcerts -connect appserver.gtportalbase.com:443 
> ```

但是，SSLv3 似乎可以工作：

> ```
> openssl s_client -ssl3 -showcerts -connect appserver.gtportalbase.com:443 
> ```

如果您知道谁在运行此服务器，则值得与他们联系以解决此问题。服务器至少现在应该真正支持 TLSv1。

同时，解决此问题的一种方法是创建自己的`org.apache.http.conn.ssl.SSLSocketFactory`并将其用于与 Apache Http 客户端的连接。

这个工厂需要`SSLSocket`像往常一样创建一个，`sslSocket.setEnabledProtocols(new String[] {"SSLv3"});`在返回该套接字之前使用，以禁用 TLS，否则默认情况下会启用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T16:27:50.843

创建自定义上下文，以便您可以记录证书无效的原因。或者只是调试它。

# android - 用安卓模拟电话

> ID：12095760
> 
> 赞同：0
> 
> 时间：2012-08-23T16:02:51.900
> 
> 标签：android

是否可以在我的应用程序可以拦截并取消实际拨号的 Android 中拨打某个电话号码？我希望播放一条消息 (TTS)，而不是拨打一个号码。

我的手机始终连接到我的内置车载套件，但它只支持拨号。所以我想从车载套件中“拨打”一个号码并听到交通信息，而不必拨打实际号码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T16:38:09.633

如果我正确理解你想要什么，有一篇关于拦截传出呼叫和取消它们（通过处理[ACTION_NEW_OUTGOING_CALL](http://developer.android.com/reference/android/content/Intent.html#ACTION_NEW_OUTGOING_CALL)广播）的详细信息[的 Android 开发者博客文章。](http://android-developers.blogspot.com/2011/01/processing-ordered-broadcasts.html)

# javascript - 禁用复选框的Javascript函数

> ID：12095765
> 
> 赞同：0
> 
> 时间：2012-08-23T16:03:14.340
> 
> 标签：javascript, salesforce

我有一个带有 3 个复选框字段 C1、C2、C3 的 VF 页面。如果选择了一个复选框字段，则应禁用其他 2 个。为此，我编写了一个 javascript 函数。这工作正常。

但我也想检查账户的城市字段，即如果账户城市有一个分词值“AB”，那么复选框字段C2应该被禁用。有人可以告诉我我该怎么做。

```
<script>
function confirmDisbaled(ifchecked,id1,id2,id3) {  
document.getElementById(id1).disabled = ifchecked;
document.getElementById(id2).disabled = ifchecked;
document.getElementById(id3).disabled = ifchecked;
}
</script> 
```

页：

```
<apex:inputCheckbox label="C1" id="c1" value="{!c1}" selected="true" onchange="return confirmDisbaled(this.checked, '{!$Component.c2}','{!$Component.c3}');"/>
        <apex:inputCheckbox label="C2" id="c2" value="{!c2}" onchange="return confirmDisbaled(this.checked, '{!$Component.c1}','{!$Component.c3}');"/>
        <apex:inputCheckbox label="C3" id="c3" value="{!c3}" onchange="return confirmDisbaledcl(this.checked, '{!$Component.c2}','{!$Component.c1}');"/> 
```

Vf 页面具有标准控制器帐户。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T16:41:07.100

```
document.getElementById(id2).disabled = ifchecked || document.getElementById('city').value == 'AB' 
```

# paypal - Paypal 订阅/定期付款通过 API 更改资金来源

> ID：12095769
> 
> 赞同：0
> 
> 时间：2012-08-23T16:03:20.940
> 
> 标签：paypal, recurring-billing

使用 Paypal 订阅/定期付款时，您是否可以允许用户从您的网站（即非贝宝）更新或添加新的信用卡/银行信息并将其设置为订阅的资金来源？

例如：在许多情况下，我们的用户订阅付款失败，原因可能是重新发行了新的信用卡或关闭了银行账户。发生这种情况时，我们会告诉他们登录到 Paypal 并使用新号码/日期等更新他们的信用卡信息，或者添加新的抄送或银行帐户并将其设置为主要资金来源。我们的大多数用户都不精通技术，所以第一个问题是：我的贝宝登录信息是什么？（我们不知道）如果他们能够登录，他们必须点击几个屏幕才能进入相应的资金来源屏幕。这对他们来说都是非常困难的。因此，我们正在寻找一种简化流程的方法，以便如果他们在我们的网站上并查看他们的帐户详细信息，他们可以轻松更改资金来源信息。

那可能吗？关于如何实施的任何建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T23:22:13.627

这取决于。如果您为“直接定期付款”产品付款，那么可以，您可以直接在您的网站上获取卡数据，并通过 UpdateRecurringPaymentsProfile API 使用此新信息更新定期付款资料。

但是，如果您只是将 Express Checkout 与定期付款（或付款标准订阅，就此而言）一起使用，那么不，这是不可能的。完全没有。
最好的办法是使用 IPN 或 GetTransactionDetails 找出买家的主要电子邮件地址，并用它来提醒他们“您在我们这里注册的 PayPal 帐户电子邮件地址是.......”。

# c# - 在C#中将字符串分成多个项目

> ID：12095772
> 
> 赞同：0
> 
> 时间：2012-08-23T16:03:29.013
> 
> 标签：c#, .net, visual-studio-2010

我有以下代码

```
 string tString;
  int flNum;
  string flLeg;

  tString = "25664-A"; 
```

我需要将 tString 放入两个变量 flNum 和 flLeg。我想要的结果是 - flNum = 25664 flLeg = A

我的尝试是——

```
 flNum = Convert.ToInt32(tString.Substring(tString.IndexOf("-") - 1));
 flLeg = tString.Substring(tString.IndexOf("-") + 1, 1); 
```

但这对我来说是错误的。关于如何更改此代码以获得我想要的结果的任何建议？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T16:05:53.390

您可以简单地使用 string.Split() 方法。

```
string[] result = tString.Split('-')
int flNum = Convert.ToInt32(result[0]);
string flLeg = result[1]; 
```

在您的代码中，您会收到一个错误，因为对于第一个子字符串，您需要传递一个起点和一个长度

```
flNum = Convert.ToInt32(tString.Substring(0, tString.IndexOf("-"))); 
```

您正确找到了破折号的位置，但是该位置作为起点传递给子字符串，但是从传递的 pos 开始没有数字，因此转换失败。

（并删除 - 1 的长度，因为这是....*长度* 不是位置）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T16:05:53.310

```
string[] parts = tString.Split('-');

flNum = int.Parse(parts[0]);
flLeg = parts[1]; 
```

根据`tString`调用的内容，`Int32.Parse`可能会抛出一个`FormatException`，因此`Int32.TryParse`可能是一个更好的选择。我只是`Parse`为了简洁起见。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T16:08:00.960

```
string[] parts = tString.Split('-'); 

if (parts.Length == 2)
{
    flLeg = parts[1]; 
    if (int.TryParse(parts[0], out flNum )
    {
        //All good
    }
    else
    {
        //Handle problem
    }
}
else
{
   //Handle problem
} 
```

# c++ - UTF-8 字符串迭代器

> ID：12095776
> 
> 赞同：6
> 
> 时间：2012-08-23T16:03:37.517
> 
> 标签：c++, string, unicode, utf-8, iterator

我正在尝试编写一个支持 Unicode 的跨平台应用程序。我正在使用库 UTF8-C++ ( [http://utfcpp.sourceforge.net/](http://utfcpp.sourceforge.net/) )，但在遍历字符串时遇到问题：

```
string s1 = "Добрый день";
utf8::iterator<string::iterator> iter(s1.begin(), s1.begin(), s1.end());

for(int i = 0; i < utf8::distance(s1.begin(), s1.end()); i++, ++iter)
{
    cout << (*iter);
} 
```

上面的代码在重定向到 UTF-8 格式的文本文件时，会产生以下输出：

```
6 3 6 3 6 3 6 3 6 3 6 3 3 2 6 3 6 3 6 3 6 3 
```

如何让 的内容`s1`正确出现在文件中？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-23T17:19:04.340

您需要确保使用正确的数据初始化字符串，然后迭代器生成正确的值。

您使用的是 VS2010，所以字符串文字有点问题。C++ 实现有一个“执行字符集”，它们将来自“源字符集”的字符和字符串文字转换为该字符集。Visual Studio 不支持 UTF-8 作为执行字符集，因此不会有意生成 UTF-8 编码的字符串文字。

您可以通过欺骗编译器或使用十六进制转义来获得一个。此外，您可以获取包含正确数据的宽字符串，然后在运行时将其转换为 UTF-8，而不是获取 UTF-8 字符串文字。

* * *

**编辑：Visual Studio 的最新版本现在确实有获取 UTF-8 字符串文字的方法。Visual Studio 2015 现在支持 C++11 的 UTF-8 字符串文字。在 Visual Studio 2015 Update 2 中，您还可以使用编译器标志[/execution-charset:utf-8 或 /utf-8。](https://msdn.microsoft.com/en-us/library/mt708818.aspx)**

* * *

### 欺骗编译器

如果您将源代码保存为“不带签名的 UTF-8”，那么编译器会认为源编码是系统区域设置编码。VS 总是使用系统语言环境编码作为执行编码。因此，当它认为源编码和执行编码相同时，它不会执行任何转换，并且您的源字节（实际上是 UTF-8）将直接用于字符串文字，从而生成 UTF-8 编码的字符串文字。（请注意，这会破坏对宽字符和字符串文字所做的转换。）

### 十六进制转义

十六进制转义码允许您手动将任何值的代码单元（在本例中为字节）插入到字符串文字中。您可以手动确定所需的 UTF-8 编码，然后将这些值插入到字符串文字中。

```
std::string s1 = "\xd0\x94\xd0\xbe\xd0\xb1\xd1\x80\xd1\x8b\xd0\xb9 \xd0\xb4\xd0\xb5\xd0\xbd\xd1\x8c"; 
```

### UTF-8 字符串文字前缀

C++11 指定了一个前缀，该前缀创建一个 UTF-8 字符串文字，而不管执行编码如何，但 Visual Studio 尚未实现这一点。这看起来像：

```
string s1 = u8"Добрый день"; 
```

它要求编译器知道并使用正确的源编码（因此源编码支持所需的字符串）。然后编译器将源编码转换为 UTF-8，而不是执行编码。当 Visual Studio 支持此功能时，您可能希望将源代码保存为“带签名的 UTF-8”。（同样，VS 依赖于签名来识别 UTF-8 源。）

* * *

在你有一个 UTF-8 字符串之后，假设 UTF-8 迭代器工作，你的示例代码应该产生正确的 11 个代码点，我认为输出文本应该如下所示：

```
104410861073108810991081321076107710851100 
```

插入一些空格使其可读，您可以验证您是否获得了正确的值：

```
1044 1086 1073 1088 1099 1081 32 1076 1077 1085 1100 
```

或者将其设为十六进制并添加 Unicode 前缀：

```
U+0414 U+043e U+0431 U+0440 U+044b U+0439 U+0020 U+0434 U+0435 U+043d U+044c 
```

如果你真的想生成一个 UTF-8 编码的输出文件，那么无论如何你都不应该使用 utf-8 迭代器。

```
string s1 = "Добрый день";
std::cout << s1; 
```

当输出重定向到文件时，该文件将包含 UTF-8 编码数据：

```
Добрый день 
```

* * *

我不明白为什么您的实际输出当前包含一堆额外的空格，但看起来正在访问的实际数字是：

```
63 63 63 63 63 63 32 63 63 63 63 
```

63 是 '?' 的 ASCII 码 32是空格的ASCII码；`?????? ????`. 因此，您显然正在遭受 VC++ 将字符串文字转换为系统区域设置编码的痛苦。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-23T16:14:46.233

答案已更新。使用 wstring（我认为最好使用 VS2010）来存储 UTF16 字符串，转换为 UTF8，然后输出。

当我在 UTF8 兼容的编辑器 (Scite) 中查看时，这对我有用。

```
 std::wstring s1 = L"Добрый день";
    std::vector<unsigned char> UTF8;

    utf8::utf16to8( s1.begin(), s1.end(), std::back_inserter( UTF8 ) );

    for( auto It = UTF8.begin() ; It < UTF8.end() ; ++It )
    {
        std::cout << (*It);
    } 
```

我认为 VS2010 中没有办法拥有 UTF8 文字或字符串对象，我认为 UTF16 (wstring) 在内部是你最好的选择，然后在导出到文件/网络等时使用 UTF8 库与 UTF8 进行转换.

# javascript - jQuery 突出显示表中的差异

> ID：12095778
> 
> 赞同：0
> 
> 时间：2012-08-23T16:03:38.193
> 
> 标签：javascript, jquery, html-table, compare

我正在尝试比较两个类似于此处在概念上所做的 HTML 表： [逐行比较两个 html 表数据并使用 jquery 突出显示](https://stackoverflow.com/questions/11548431/compare-two-html-tables-data-line-by-line-and-highlight-using-jquery)

除了我只需要知道两者中是否有任何数据都没有出现。

到目前为止，我的解决方案是遍历第一个表，如果我在第二个表中找到匹配项，请突出显示它。如果没有匹配项，请在第一个表中突出显示它。（使用找到和未找到的类）。

这是我的代码。选择器正在工作，但类似乎没有坚持。

```
$(document).ready(function(){
    $("#oldScript tr").each(function(){
        $('#newScript tr:contains('+ "" + this.innerHTML + "" + ')').addClass("found");
        if($('#newScript tr:contains('+ "" + this.innerHTML + "" + ')').length == 0){
            $(this).addClass("notFound");
            alert("Row not found \n" + $(this).innerHTML);
        }
    });
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T04:51:10.960

使用`each`时最好使用[jQuery Docs](http://api.jquery.com/jQuery.each/)中定义的回调函数中的参数。有一个小提琴会很有帮助，但尝试这样的事情而不是`this`在循环内使用（现在注意回调函数的参数）。

```
$(document).ready(function(){
    $("#oldScript tr").each(function(index, item) {
        $('#newScript tr:contains('+ "" + item.innerHTML + "" + ')').addClass("found");
        if($('#newScript tr:contains('+ "" + item.innerHTML + "" + ')').length == 0){
            $(item).addClass("notFound");
            alert("Row not found \n" + item.innerHTML);
        }
    });
}); 
```

# objective-c - 完成块返回结果

> ID：12095784
> 
> 赞同：4
> 
> 时间：2012-08-23T16:03:50.277
> 
> 标签：objective-c, ios, twitter, objective-c-blocks

所以我试图在一个项目的 Twitter API（以及其他）之上构建一个层，我需要找到一种方法将 Twitter 操作的结果返回到抽象层。

现在我的设置是这样的，例如：

```
-(NSDictionary *)sendTweet:(Tweet *)tweet {
        __block NSMutableDictionary *responseDictionary;

    NSLog(@"Sending tweet");

    NSMutableDictionary *twitterRequestDictionary = [[NSMutableDictionary alloc] init];
    [twitterRequestDictionary setObject:tweet.tweetBody forKey:@"status"];

    TWRequest *request = [[TWRequest alloc] initWithURL:[NSURL URLWithString:@"https://api.twitter.com/1/statuses/update.json"]
                                             parameters:twitterRequestDictionary
                                          requestMethod:TWRequestMethodPOST];
    [request setAccount:self.userAccount];

    [request performRequestWithHandler:^(NSData *responseData, NSHTTPURLResponse *urlResponse, NSError *error) {
        responseDictionary  = [NSJSONSerialization JSONObjectWithData:responseData options:NSJSONReadingMutableContainers error:nil];
        NSLog(@"Response dictionary: %@", responseDictionary);
        return responseDictionary;
    }]; 
```

}

但是因为 'performRequestWithHandler:' 方法返回 'void' 我最后一行会导致错误。

在发现这篇文章后，我还尝试将'return'语句放在块之外并锁定代码块部分的执行：http: [//omegadelta.net/2011/05/10/how-to-wait- for-ios-methods-with-completion-blocks-to-finish](http://omegadelta.net/2011/05/10/how-to-wait-for-ios-methods-with-completion-blocks-to-finish)

仍然没有运气。

我希望有人可以对这种方式有所了解（或者可能建议一种更好的方法来返回数据）。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-23T16:17:14.963

为什么不也使用块来返回响应？就像是：

```
-(void)sendTweet:(Tweet *)tweet withResponseCallback:(void (^)(NSMutableDictionary *responseDictionary))callback {

    NSLog(@"Sending tweet");

    NSMutableDictionary *twitterRequestDictionary = [[NSMutableDictionary alloc] init];
    [twitterRequestDictionary setObject:tweet.tweetBody forKey:@"status"];

    TWRequest *request = [[TWRequest alloc] initWithURL:[NSURL URLWithString:@"https://api.twitter.com/1/statuses/update.json"]
                                             parameters:twitterRequestDictionary
                                          requestMethod:TWRequestMethodPOST];
    [request setAccount:self.userAccount];

    [request performRequestWithHandler:^(NSData *responseData, NSHTTPURLResponse *urlResponse, NSError *error) {
        NSMutableDictionary *responseDictionary  = [NSJSONSerialization JSONObjectWithData:responseData options:NSJSONReadingMutableContainers error:nil];
        NSLog(@"Response dictionary: %@", responseDictionary);
        callback(responseDictionary);
    }];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T18:49:57.150

由于您使用的是异步方法，因此很难说您的方法何时返回数据。因此，您可以考虑其他选项来返回结果。例如，发布通知、发送消息、设置某些属性甚至显示警报视图可能很有用。

至于文章的代码示例，我会尝试以下内容

```
dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^{
    NSData *data = [self loadDataWithConditionLock];
    dispatch_async(dispatch_get_main_queue(), ^{
        [self updateUIWithData:data];
    });
}); 
```

# javascript - asp.net gridview 内的面板 - 我如何在 jquery 中找到它？

> ID：12095785
> 
> 赞同：1
> 
> 时间：2012-08-23T16:03:50.590
> 
> 标签：javascript, jquery, asp.net

我在gridview中有一个面板。当我单击网格视图中的单选按钮时，我调用`click`单选按钮的 jquery 事件。那部分工作正常......现在我需要引用我的gridview内的面板，但我不能使用`$this`，因为它指的是我的单选按钮列表（我认为它确实如此）。

我怎样才能得到这个面板的参考。

```
 $("#MainContent_gvLineItems input[id*='rbAnswer']").click(function () {
                var p = $(this).find('[id$=MainContent_gvLineItems_pnlAnswer]'); // find the panel but this wont work so what can I do here?
            }); 
```

我不知道我的语法是否适合`id$=MainContent_gvLineItems_pnlAnswer`网格视图中每一行的面板 ID 更改...

# 编辑

这是一些网格视图：

```
<asp:TemplateField HeaderText="Answer">
                            <ItemTemplate>
                               <div id="dMainAnswer">
                                <asp:RadioButtonList ToolTip="Please provide an answer to the method." RepeatDirection="Horizontal" ID="rbAnswer" runat="server" SelectedValue='<%# DataBinder.Eval(Container, "DataItem.AnswerID")%>'>
                                    <asp:ListItem Text="Yes" Value="Yes" style="color:green;"></asp:ListItem>
                                    <asp:ListItem Text="No" Value="No" style="color:red;"></asp:ListItem>
                                    <asp:ListItem Text="N/A" Value="N/A" style="color:gray;"></asp:ListItem>
                                    <asp:ListItem Value="" Text="" style="display: none" />
                                </asp:RadioButtonList>
                                   <asp:Panel ID="pnlAnswer" runat="server" Visible="False">
                                       <div id="dMainAnswerResponsibleType">
                                            <asp:RadioButtonList ID="rbRespType" ToolTip="Select responsible contact type." runat="server" RepeatDirection="Horizontal" AutoPostBack="true" SelectedValue='<%# DataBinder.Eval(Container, "DataItem.ResponsiblePartyType")%>' OnSelectedIndexChanged="rbRespType_SelectedIndexChanged">
                                                <asp:ListItem Selected="True" Text="TKSE" Value="TKSE">TKSE</asp:ListItem>
                                                <asp:ListItem Text="Other" Value="Other">Other</asp:ListItem>
                                                <asp:ListItem Value="" Text="" style="display: none" />
                                            </asp:RadioButtonList>
                                        </div>
                                        <div id="dMainAnswerResponsible"><a href="#" onclick="return false;" class="info">Res:<span>Select who is responsible in resolving this issue.</span></a>
                                             <asp:DropDownList ID="ddlEmployees" runat="server" 
                                                DataSource="<%# GetEmployees() %>" SelectedValue='<%# Eval("TKSEContact") %>' DataTextField="FullName" Width="75px"
                                                DataValueField="FullName" 
                                                ToolTip="Select the TKSE responsible party.">
                                            </asp:DropDownList>
                                            <asp:TextBox ID="txtContact" Text='<%# Eval("ResponsiblePartyContact") %>' Width="75px" MaxLength="50" runat="server" ToolTip="Enter the responsible contact name." Visible="false"></asp:TextBox>
                                        </div>
                                        <div id="dDueDate"><a href="#" onclick="return false;" class="info">Due:<span>Select the due date when you expect this issue to be resolved.</span></a>
                                            <asp:TextBox ID="txtDueDate" Text='<%# Eval("DueDate") %>' Width="59px" runat="server" ToolTip="Select the due date." CssClass="datePickerDueDate"></asp:TextBox>
                                        </div>
                                        <div id="cSendToSugar">
                                            <asp:CheckBox ID="chkSendToSugar" ToolTip="Send/Update issue to Sugar?" BackColor="Gold" Text="Send To Sugar?" Checked="true" runat="server" />
                                        </div>
                                   </asp:Panel>
                               </div>
                            </ItemTemplate>
                                <FooterStyle HorizontalAlign="Center" />
                                <HeaderStyle HorizontalAlign="Center" />
                                <ItemStyle HorizontalAlign="Center" />
                            </asp:TemplateField> 
```

注意面板`pnlAnswer`，它最初设置为不可见`Visible=False`。它也不是单选按钮列表的兄弟……至少我不认为它是……

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T16:17:43.613

使用 .parents 查找元素的父级；如果你给它一个 CSS 类，你可以这样做：

```
$(this).parents(".class:first") 
```

找到它。我假设面板是单选按钮列表的父级。否则，您会想使用另一种 Jquery 方法。只要面板可见或使用以下命令隐藏，这将起作用：

```
<asp:Panel .. style="display:none" /> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T16:19:13.197

我建议给你的面板一个 css 类，然后使用 jQuery 选择器。如果单选按钮是面板的[兄弟：](http://api.jquery.com/siblings/)

```
var panel = $(this).siblings(".answer"); 
```

这取决于面板在生成的标记中的位置，也许可以使用 next 或 prev 代​​替。如果您发布生成的标记，我可以更新此答案。

* * *

现在我们可以看到标记（谢谢）您需要父级，然后是兄弟级，如下所示：

```
 <someOtherElement> <!-- the grid view container -->
    <div class="answer"></div> <!-- sibling of parent (maybe <div runat="server"> is better than panel?)  -->
    <div> <!-- parent -->
        <input type="radio">  <!-- this -->
    </div>
 </someOtherElement> 
```

# asp.net-mvc-3 - EditorFor 动作 MVC3 中的参数

> ID：12095787
> 
> 赞同：0
> 
> 时间：2012-08-23T16:03:55.463
> 
> 标签：asp.net-mvc-3

想出点东西有点麻烦。

我有一个动作：

```
public ActionResult FareTypeSelector(SearchTypes searchType, SearchSource searchSource)
        {
            IFareTypeOptionsRepository fareTypeOptionRespoitory = new FareTypeOptionsRepository();

            FareTypeOptions fareTypeOptions = fareTypeOptionRespoitory.GetFareTypeOptions(searchSource, searchType, _authentication.UserLoggedIn.CallCentreUser, _authentication.UserLoggedIn.AgencyProfile.BranchCode);
            return View();
        } 
```

我创建了一个*'Editor'*，即*EditorTemplates*中名为*FareTypeSelector.cshtml*的文件。

我想将我的编辑器绑定到包含编辑器的页面模型的属性。但我也想将一些参数传递到我的操作中，即`(SearchTypes searchType, SearchSource searchSource)`. 这个想法是编辑器中显示的数据是基于传入的这些信息。现在我不太清楚是否：

1.  这可能吗？
2.  主视图中需要什么标记来渲染它、传递参数并将结果选定的值绑定到主模型中？

提前Ta

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T16:07:20.030

EditorTemplates 用于模型中的数据项，而不是 Action 方法。他们仅在您的视图中使用来渲染特定模型（或模型成员）

# php - 如何在任何页面上显示 OpenCart 上的 SubTotal？

> ID：12095789
> 
> 赞同：3
> 
> 时间：2012-08-23T16:03:57.080
> 
> 标签：php, str-replace, opencart, substr

目前我知道的唯一全局 PHP 命令是：

```
<?=$text_items?> 
```

这吐了：

```
1 item(s) - £318.75 
```

我想获得`318.75`价值，所以目前我正在尝试替换，但它工作并不顺利：

```
$short = $text_items;
$short = str_replace("£", "", $short);
$short = str_replace("&pound;", "", $short);
$short = str_replace("-", "", $short);
$short = str_replace("&ndash;", "", $short);
$short = str_replace(" ", "", $short);
$short = str_replace("-", "", $short);
$short = str_replace("ITEMS", "", $short);
$short = str_replace("(", "", $short);
$short = str_replace(")", "", $short);
$short = str_replace("item(s)", "", $short);
$short = str_replace("ITEM", "", $short); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T16:26:23.927

```
$total = @floatval(end(explode('£', html_entity_decode($text_items)))); 
```

*   `html_entity_decode` changes `&pound;` to `£`
*   `end(explode('£'` is giving you string after '`£`' character
*   finally `floatval` is valuating string to float.
*   @ is bypassing `E_STRICT` error which occurs to passing constant in `end()` function.

[Working example](http://codepad.viper-7.com/anfiTK)

* * *

Second solution is Regexp:

```
preg_match_all('!\d+(?:\.\d+)?!', $text_items, $result);
echo $result[1]; 
```

[Working example](http://codepad.viper-7.com/xciqPQ)

# c# - 用于 c Sharp 的和引擎

> ID：12095795
> 
> 赞同：0
> 
> 时间：2012-08-23T16:04:16.527
> 
> 标签：c#, java, android

我遇到了一些关于 C# 和 Java 的讨论，似乎 StackOverflow 中的很多程序员都喜欢 C# 而不是 java。[看这里](https://stackoverflow.com/questions/575513/why-is-c-sharp-suddenly-so-popular)

我只是好奇我是否可以使用单声道在 C# 中使用 andegine 库？或者准确地说，我可以在创建 android 应用程序时在 C# 中使用 java 库吗？

使用 C# 代替 Java 是否有缺点，如果可以在 C# 中使用 Java 库，你能给我举个例子吗？我很困惑。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T16:06:37.940

如果你想使用 Java 库，你应该使用 Java。

无法直接使用 C# 中的 Java 库，但如果您想使用 C#，您可以：

*   查找为 .NET 编写的类似库。
*   Andengine 是开源的。您可以选择将其移植到 C#，但这需要很长时间。

# php - 删除一个我只知道 PHP 中名称的第一部分的文件

> ID：12095797
> 
> 赞同：1
> 
> 时间：2012-08-23T16:04:21.807
> 
> 标签：php, delete-file, unlink

我想删除一个我只知道名称的第一部分的文件。

```
 unlink('./upload/nav_thumbs/project-'  .the rest); 
```

'其余的' = 可以是任何东西。我唯一得到的是它有一个 .jpg 扩展名

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-23T16:08:25.613

```
$possibleFiles = glob('./upload/nav_thumbs/project-*.jpg');
foreach ($possibleFiles as $file) {
    if (thisIsTheFileYouAreLookingFor($file)) {
        unlink($file);
    }
} 
```

[http://php.net/glob](http://php.net/glob)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T18:41:02.600

您也可以尝试 OOP 版本：

```
 $directoryIterator = new DirectoryIterator('./upload/nav_thumbs');
 foreach($directoryIterator as $fileInfo)
     if(i_want_to_delete($fileInfo->getFilename()) unlink($fileInfo->getFilename()); 
```

# javascript - jQuery - 在 jQuery.ajax().done() 中更新点击的图像

> ID：12095798
> 
> 赞同：1
> 
> 时间：2012-08-23T16:04:33.273
> 
> 标签：javascript, jquery

我有几张图片，比如

```
<img src="unstarred.png" class="unstarred-button" id="unstarred-1" />
<img src="unstarred.png" class="unstarred-button" id="unstarred-2" />
<img src="unstarred.png" class="unstarred-button" id="unstarred-3" />
<img src="unstarred.png" class="unstarred-button" id="unstarred-4" /> 
```

然后我绑定这个函数：

```
$('.unstarred-button').click(function() {
    id = $(this).attr('id').replace(/^unstarred-/, '');
    url = '/star.php?id=' + id;

    $.ajax({
        type: 'GET',
        url:  url
    }).done(function() {
        // What should be put here?
    });
}); 
```

现在我不知道如何前进。我想`src`在调用中更改单击图像的属性`done()`，但 $(this) 不会返回确定单击的图像`$(this).attr('id')`，`undefined`根据`alert()`.

有人可以帮我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T16:07:57.220

```
$('.unstarred-button').click(function() {
    var that = this;
    var id = this.id.replace(/^unstarred-/, '');
    var url = '/star.php?id=' + id;

    $.ajax({
        type: 'GET',
        url:  url
    }).done(function() {
        that.src = 'some/new/src.jpg';
    });
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T16:08:06.690

那是因为在不指代`this`的上下文中。您需要将上下文保存在事件处理程序中：`done``img``click`

```
$('.unstarred-button').click(function() {
    var self = $(this);
    id = self.attr('id').replace(/^unstarred-/, '');
    url = '/star.php?id=' + id;

    $.ajax({
        type: 'GET',
        url:  url
    }).done(function() {
        self.attr('src', 'something.jpg');
    });
}); 
```

另外，你不需要 jQuery 来改变 DOM 元素的`src`or `id`，你可以直接改变属性，即`this.src = 'something.jpg`or `this.id = 'new_id'`。

# html - 哪些元素“有效”放置在标签内？

> ID：12095803
> 
> 赞同：20
> 
> 时间：2012-08-23T16:04:40.730
> 
> 标签：html, semantic-markup

我知道放在`div`里面不是一个好主意`td`，但是还有`span`其他元素呢？哪些元素可以放在里面`td`，哪些不可以，为什么？

编辑：问题是我有一个旧的`table`布局，我需要在那里进行修改。为此，我需要在里面添加元素`td`，那么插入什么元素最不邪恶`<td>`？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-08-23T16:05:57.920

[HTML 规范](http://www.w3.org/TR/html51/single-page.html)指定哪些元素可以是其他元素的直接后代。

该[`<td>`元素](http://www.w3.org/TR/html51/single-page.html#the-td-element)有一个[`flow content`](http://www.w3.org/TR/html51/single-page.html#flow-content)内容模型，这意味着它可以包含：

> a abbr 地址区域（如果它是地图元素的后代） 文章旁边 音频 b bdi bdo blockquote br 按钮画布引用代码 命令 datalist del details dfn dialog div dl em embed fieldset figure footer form h1 h2 h3 h4 h5 h6 header hgroup hr i iframe img input ins kbd keygen label map mark math menu Meter nav noscript object ol output p pre progress q ruby​​ s samp script section select small span strong style (if the scoped attribute is present) sub sup svg table textarea time u ul var video wbr 文本

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-23T16:11:40.470

*您不应该*将 a`div`放在 a中的想法`table`更多的是使用带有 CSS 的语义标记来设置布局样式。

话虽如此，`<table>`它的相关元素应该用于以表格格式显示数据。如果表格中的一个单元格包含更复杂的标记是有意义的，那就这样吧。

过去`<table>`使用它是因为它可以轻松地为网站提供网格布局，但现在应该使用 CSS 来完成，以使您的网站更易于访问。

# javascript - Safari Array indexOf 找不到任何东西

> ID：12095804
> 
> 赞同：2
> 
> 时间：2012-08-23T16:04:43.977
> 
> 标签：javascript, safari

当我在 Safari 6.0 中评估以下 javascript 时：

```
Array.indexOf([1,2,3],3) 
```

它返回 -1，本质上说 3 不在数组中！

但在 Firefox 中，它正确返回 2。

我知道 Array.indexOf 是一个相对较新的函数，所以我有代码来测试它是否存在，如果不存在则定义它。然而，这个功能似乎是内置于 Safari 中的。

这是一个错误，还是我做错了什么？

编辑：这实际上是问题的简化版本。我实际上在做的是试图在 TR 中定位 TD 单元的索引：

```
var tr = td.parentNode
var col = Array.indexOf(tr.cells,td) 
```

`tr.cells`没有`indexOf`. 但是，使用`Array.indexOf`我可以这样对待它，至少在 Firefox 中是这样。在 Safari 中，这不起作用。

我想在这种情况下我实际上可以使用 cellindex，但如果没有定义，我将如何获取索引？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-23T16:06:39.267

我想知道你为什么不按预期使用它：

```
[1,2,3].indexOf( 3 ); 
```

除非是学术问题。在这种情况下，它实际上是一个~~bug~~特殊的 Firefox 实现。如果你想`Array.prototype`直接使用这个版本，你应该去喜欢

```
Array.prototype.indexOf.call([1,2,3], 3); 
```

# sqlite - sqlite 删除索引非常慢

> ID：12095809
> 
> 赞同：5
> 
> 时间：2012-08-23T16:05:07.847
> 
> 标签：sqlite, indexing, sql-drop

我有一个大约 75 GB 的 sqlite 数据库。在数据库上创建索引需要将近 4 个小时。索引后，文件大小约为 100 GB。

通常，我必须修改（插入/删除/更新）大块（几 GB）数据。截至目前，我在修改表之前删除了索引。修改完成后，将重新创建索引。

删除索引需要大量时间（它与创建索引的顺序相同）。

在一些非常特殊的情况下（当需要重新生成整个数据时），我可以写入一个新的数据库文件并将其替换为原始文件。这种策略不需要我删除索引。

如果我不能只切换数据库文件，我该怎么做才能加快索引删除？欢迎任何建议/想法。

这是我认为单文件数据库的局限之一。如果表/索引存储在单独的文件中，则可以简单地将这些文件标记为已删除。

# spring - 这是一个基于弹簧的应用程序。我在 JSP 中的表单定义如下， <form:form modelattribute="article" enctype="multipart/form-data" method="POST" action="${sendE
问问题
问问题 2012-08-23T16:05:19.737
1422 次
This question shows research effort; it is useful and clear
0
This question does not show any research effort; it is unclear or not useful
Bookmark this question.
Show activity on this post.
这是一个基于弹簧的应用程序。我在 JSP 中的表单定义如下，
<form:form modelAttribute=" article"="" name="postAd" id="postAd">我想在我的表单上显示来自 'article' bean 的一些数据，所以我定义了modelAttribute='article'. 到这里为止一切都很好。但是在提交表单时，我想收集与文章不同的 bean 中的数据。由于我只能在表单中定义一次 modelAttribute，有人可以告诉我如何在 JSP 中使用两个 bean 吗？ PS如果我不清楚，让我提供更多细节。提交表单时，用户输入的数据将被收集到 bean 'X' 中，并使用 java 电子邮件发送电子邮件。但是 bean 'Y'（本例中的文章）持有一些需要在表单上显示的值。 希望我清楚。 我们可以在 flashdevelop 中使用 Haxe 创建 Air Mobile 应用程序吗？ 我想知道是否可以在 flashdevelop 4.0.4 RTM 中使用 haxe 2.10 创建移动空中应用程序？ 注意：不使用 NME 谢谢 springjspjstl 4 1 回答 1 This answer is useful 2 您可以创建一个FormBean包含您所说的两个 bean 的类。在您的表单中使用这个新类modelAttribute，您将能够访问这两个对象的属性。 public class FormBean { public Article article; public YourOtherObject yourOtherObject; } 于 2012-08-24T10:11:33.357 回答 Related 2 php - php - 将 2012-06-25 19:00:00 转换为另一种格式 1 image - 显示彩色图像的子数组 13 java - 无法在 32 位 JVM 上加载 64 位 SWT 库（替换 SWT 文件） 3 ruby-on-rails - 在 Rails 视图中创建公式？ 1 objective-c - 设置 MPMediaItem 的图稿 4 java - 哪个效率更高？for循环中使用的缓存方法调用结果 2 jquery - jQuery - 在页面上键入时进行搜索，就像 cpanel 搜索一样 3 extjs - 在启用自动同步的同步后存储执行某些操作 1 webgl - ray 没有到达 JSON 1 c++ - FFMpeg 未定义对 get_buffer 的引用 Reference php × 1429865 c/c++ × 756500 nginx × 49975 mongodb × 159057 mybatis × 3233 anaconda × 13410 pycharm × 14671 python × 1902243 vscode × 56040 docker × 110988 github × 49000 flask × 49129 ffmpeg × 24037 jmeter × 16910 matplotlib × 63493 bootstrap × 54641</form:form>

> ID：12095812
> 
> 赞同：0
> 
> 时间：
> 
> 标签：spring, jsp, jstl

这是一个基于弹簧的应用程序。我在 JSP 中的表单定义如下，

```
<form:form modelAttribute="article" enctype="multipart/form-data" method="POST"
           action="${sendEmailUrl}" name="postAd" id="postAd"> 
```

我想在我的表单上显示来自 'article' bean 的一些数据，所以我定义了`modelAttribute='article'`. 到这里为止一切都很好。但是在提交表单时，我想收集与文章不同的 bean 中的数据。由于我只能在表单中定义一次 modelAttribute，有人可以告诉我如何在 JSP 中使用两个 bean 吗？

PS如果我不清楚，让我提供更多细节。提交表单时，用户输入的数据将被收集到 bean 'X' 中，并使用 java 电子邮件发送电子邮件。但是 bean 'Y'（本例中的文章）持有一些需要在表单上显示的值。

希望我清楚。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T10:11:33.357

您可以创建一个`FormBean`包含您所说的两个 bean 的类。在您的表单中使用这个新类`modelAttribute`，您将能够访问这两个对象的属性。

```
public class FormBean {

    public Article article;

    public YourOtherObject yourOtherObject;

} 
```

# air - 我们可以在 flashdevelop 中使用 Haxe 创建 Air Mobile 应用程序吗？

> ID：12095813
> 
> 赞同：3
> 
> 时间：2012-08-23T16:05:21.287
> 
> 标签：air, flashdevelop, haxe

我想知道是否可以在 flashdevelop 4.0.4 RTM 中使用 haxe 2.10 创建**移动空中应用程序？**

注意：不使用 NME

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T07:03:17.767

我已经从 Haxe 创建了 AIR Mobile 应用程序，但只是间接的。

我编译为 .SWF 并使用 Adob​​e 的免费 AIR 编译器将 SWF 转换为 AIR 应用程序。我成功地部署了它，而不会对 iOS、Android 和 Blackberry 感到头疼。

# javascript - jQuery：使用实时事件添加 tabindex 属性

> ID：12095818
> 
> 赞同：0
> 
> 时间：2012-08-23T16:05:31.463
> 
> 标签：javascript, jquery

希望所有具有类`.link`的新元素都有一个 tabindex。

代表/现场似乎不起作用：

```
$('body').delegate('.link', 'load', function(event){
   $(this).attr('tabindex',0);
}); 
```

试图将此应用于 AJAX 加载的元素。并使用我在[这个答案](https://stackoverflow.com/a/4889538/183181)中找到的内容，这表明“加载”事件*可能*是可能的。

我想避免使用触发器或修改 AJAX 回调。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T19:01:11.233

这里的问题是**当新元素插入 DOM** ¹时不会触发任何事件。“解决方案”（不幸的是，不是您要寻找的解决方案）是`tabindex`从`complete`您的 ajax 操作的回调中设置。您可以使用[`.ajaxComplete()`](http://api.jquery.com/ajaxComplete/)设置全局/默认回调，但这可能会引入新问题（例如必须处理触发的订单事件）。

[好吧，这不是 100% 准确的。有[Mutation Events](https://developer.mozilla.org/en-US/docs/DOM/Mutation_events)，它们在不同的浏览器中没有一致地实现，应该被[Mutation Observers](https://developer.mozilla.org/en-US/docs/DOM/DOM_Mutation_Observers)取代。]

# asp.net-mvc-3 - EXTJS 方法在以冒号开头的字符串上出错

> ID：12095820
> 
> 赞同：1
> 
> 时间：2012-08-23T16:05:36.463
> 
> 标签：asp.net-mvc-3, extjs

我在 ASP.NET MVC 应用程序之上继承了一些 EXTJS 代码，并且我试图跟踪当 Ext.msg.prompt 框前面有一个带有“：”字符的字符串时发生的错误。这是似乎发生错误的方法：

```
 var casePrompt = function() {
    Ext.Msg.prompt("Numb", "", function(btn, text) {
        if (btn == "ok") {
            numbID = text.trim().toUpperCase();
            Ext.Ajax.request({
                url: "/location/method/" + numbID,
                method: "GET",
                callback: function(options, success, response) {
                    var reply = Ext.decode(response.responseText);
                    if (success) {
                        listOpen(reply.Data);
                    } else {
                        errorMsg(reply, function(button, text) { numbID = ""; });
                    }
                }
            });
        }
    });
}; 
```

如果一个数字按预期进入盒子，一切正常。但是，如果有人输入了相同的数字或任何有效数字，并且前面带有“：”，则该方法甚至在返回控制器之前就会出错。该错误仅显示“Microsoft JScript 编译错误：语法错误”并突出显示 ext-all-debug.js 中的以下代码：

```
doDecode = function(json){
     return eval("(" + json + ;)');
} 
```

有没有人以前见过这个并且知道捕捉这个错误的方法？我已经尝试在 VS2010 中逐步完成，但没有任何运气。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T21:45:10.097

我最终只是在文本字符串上使用正则表达式进行验证，以捕获与有效字符不匹配的任何内容。这处理了冒号和任何其他字符，因此 misaecko 是正确的，它需要客户端验证。这似乎解决了这个问题。谢谢您的意见！

# eclipse - 在构建/部署时从 Eclipse 工作区中的第二个项目自动更新 WAR 依赖库中的 JAR

> ID：12095823
> 
> 赞同：0
> 
> 时间：2012-08-23T16:05:47.750
> 
> 标签：eclipse, jar, dependencies, export, build-automation

我正在与使用 SVN 的团队一起开发 Web 服务。

该应用程序（当前）在 Eclipse 中分为 2 个项目，项目 A 具有控制器和视图，项目 B 具有框架支持和数据模型。

就目前而言，项目 B 被导出到一个 JAR 并放置在项目 A 的 webapp/WEB-INF/lib 中。这就是它在 SVN 中的存在方式，我被禁止更改它。

我知道 Eclipse 的部署程序集配置，但由于该文件必须预先生成并放置在 lib 文件夹中，因此我无法使用该方法。（这是我想做的，但不允许）

此外，虽然我知道这可以通过 ANT 完成，但我无法控制构建管理，所以这也不是一个选择。

有没有办法自动将项目 B 作为 JAR 导出到项目 A 中，将其插入工作区，覆盖任何以前的导出，无论何时构建项目 B 都会自动？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T17:48:59.027

它不会是自动的，但是既然 Project B 必须构建 JAR，为什么不将 Project B JAR 文件放入 Project A Subversion 目录中。

当项目 B 提交到 Subversion 时，提交过程的一部分是提交项目 B JAR。参与项目 A 的每个人都会进行 Subversion 更新以获取最新的项目 B JAR。

# javascript - contenteditable 无法正常工作

> ID：12095831
> 
> 赞同：1
> 
> 时间：2012-08-23T16:06:04.343
> 
> 标签：javascript, jquery, contenteditable

我的页面中有一个元素，一旦双击其父级，它就可以编辑。所以像：

```
<div id="parent"><p class="editable"> enter text here </p></div> 
```

当我将属性更改`#parent`为true时。`dblclicked``contenteditable`

现在的问题是，一旦 contenteditable 开启，有两件事会阻止用户编辑文本：1）父级绑定了很多事件和其他东西（包括可拖动和可调整大小）。如果我这样做`unbind()`，这部分会得到解决（但我不想那样做！） 2）我还使用此代码来禁用页面中的文本选择：

```
function disableSelection(target){
    if (typeof target.onselectstart!="undefined") //IE route
        target.onselectstart=function(){return false}
    else if (typeof target.style.MozUserSelect!="undefined") //Firefox route
        target.style.MozUserSelect="none"
    else //All other route (ie: Opera)
        target.onmousedown=function(){return false}
    target.style.cursor = "default"
} 
```

我尝试使用以下方法排除可编辑元素：

```
disableSelection($(":not(.editable)").get(0)); 
```

但它似乎禁用了页面中的所有内容。当我摆脱它时，它解决了问题的另一半。所以如果我想启用编辑，我必须从父级取消绑定所有事件，并且还要摆脱 disableSelection，这对我来说是不可能的。

有谁知道如何解决这个问题？解决方案一定比我想的要容易，但我想我现在只是让自己感到困惑！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T16:13:27.393

jQuery UI .draggable() 和 .resizable() 有一个取消属性，包含的元素不应该触发拖动

[http://jqueryui.com/demos/draggable/#option-cancel](http://jqueryui.com/demos/draggable/#option-cancel)

只是这两个你需要忽略吗？

# visual-c++ - 限制从服务调用 CreateProcess

> ID：12095832
> 
> 赞同：0
> 
> 时间：2012-08-23T16:06:06.020
> 
> 标签：visual-c++, service, createprocess

我有一个用 Visual C++ 编写的程序，它用 Visual Studio 2005 编译，在 Windows 2003 上运行。

在程序中，它反复调用 CreateProcess 来启动一个程序，该程序只是反复休眠并在屏幕上显示一条消息，参数如下：

```
CreateProcess(app_pathname, (char*) full_app_name.chars(), 
                       NULL, NULL, FALSE, CREATE_NEW_CONSOLE, 0, 0, &si, &pi) 
```

并且提供的 si 有：

```
memset( &si, 0, sizeof(STARTUPINFO));
    si.cb = sizeof(STARTUPINFO);
    si.dwFlags |= STARTF_USESHOWWINDOW;
    si.wShowWindow = SW_SHOWDEFAULT;
    si.lpTitle = (char*) cmdLine; 
```

我观察到，如果我从服务运行该程序，则不会启动超过 124 的新进程，并且 CreateProcess() API 调用不会返回任何错误。

但是，如果程序是从 Visual Studio 或命令行运行的，那么我没有这个限制。

我尝试更改“登录”选项卡以使用从命令行运行的相同用户帐户，并更改了“允许服务与桌面交互”，但没有发现行为有任何差异。通过查看 CreateProcess API 以及在互联网上进行研究，我无法找到答案。服务产生的进程数量是否有任何限制？

# jsf - JasperReports PdfServlet 以 PDF 格式保存报告 - 如何设置浏览器的文件名以提示用户？

> ID：12095833
> 
> 赞同：0
> 
> 时间：2012-08-23T16:06:12.677
> 
> 标签：jsf, jasper-reports

堆栈：**JBoss AS**上的**JSF** + **PrimeFaces**和**JasperReports**

 ****我一直在使用 JasperReports 以 PDF 格式导出模式，过程分为三个步骤：

**[1] 从战争**中的一条路径获取已编译的Jasper报告

 **[2] 将**JasperPrint**对象放在会话上

[3] 重定向到**PdfServlet的 URL**

因此，当来自 GUI 的用户单击**p:commandButton**时，将调用经过 [1]、[2] 和 [3] 的支持 bean 的方法，如以下示例代码所示：

**xhtml 文件：**

```
<p:commandButton ajax="false" action="#{indexController.exportPDF}" value="Export PDF"/> 
```

**支持 bean 代码：**

```
private void putPrintObjectInSession() throws JRException {
    ExternalContext externalContext = FacesContext.getCurrentInstance().getExternalContext();
    ServletContext context = (ServletContext) externalContext.getContext();
    String reportFileName = context.getRealPath("/reports/PrimeNumbersReport.jasper");
    File reportFile = new File(reportFileName);
    if (!reportFile.exists())
        throw new JRRuntimeException(".jasper file not found in the war.");
    Map parameters = new HashMap();
    parameters.put("ReportTitle", "2nd Prime Numbers Report");
    parameters.put("BaseDir", reportFile.getParentFile());
    JasperPrint jasperPrint = 
            JasperFillManager.fillReport(
                      reportFileName, 
                      parameters, 
                      getSQLConnection()
                    );
    ((HttpSession) externalContext.getSession(false)).setAttribute(BaseHttpServlet.DEFAULT_JASPER_PRINT_SESSION_ATTRIBUTE, jasperPrint);
}

public String exportPDF() throws IOException, JRException {
    putPrintObjectInSession();
    FacesContext facesContext = FacesContext.getCurrentInstance();  
    ExternalContext externalContext = facesContext.getExternalContext();  
    externalContext.redirect("servlets/pdf");
    return null;
} 
```

I have two questions:

[i] do you see any obvious code smells or limitations with this approach?

[ii] with the example code above both Chrome and Conkeror can save the report but the default filename they present to the user for saving the file is simply "pdf". How can I configure that to a meaningful name (e.g. "report-2012-08-23c.pdf") ?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T11:23:16.383

As to your concrete problem with the "Save as" filename, it defaults to the last path in the request URL (which is in case of `/servlets/pdf` indeed just `pdf`), unless otherwise specified in `Content-Disposition` header.

The problem is not directly caused by your JSF code (although it is at its own kind of odd, but that's a different problem/question), but more in the servlet which is been mapped on `/servlets/pdf`. To set the desired "Save as" filename, you need to add the following line before writing any byte to the response:

```
response.setHeader("Content-Disposition", "attachment;filename=\"" + filename + "\""); 
```

You can if necessary replace `attachment` by `inline` if you want to display it by default inline.

The Internet Explorer browser, however, ignores this value and sticks to using the last path in the request URL. So to cover that browser as well, you'd need to include the desired filename in the request URL yourself and change the servlet mapping.

E.g.

```
String filename = "report-2012-08-23c.pdf";
externalContext.redirect("servlets/pdf/" + filename); 
```

with

```
@WebServlet("/servlets/pdf/*") // instead of @WebServlet("/servlets/pdf") 
```

With this URL pattern, the filename is inside the servlet available by

```
String filename = request.getPathInfo().substring(1); 
```******

# php - 使用 PHP 扩展 IPv6 地址的快速方法

> ID：12095835
> 
> 赞同：6
> 
> 时间：2012-08-23T16:06:15.643
> 
> 标签：php, tcp, ipv6

我正在做一个需要扩展 IPv6 地址的项目。其他用户创建的功能并不多，而且存在的功能很丑陋。其中一些包括多个`foreach`' 和`gmp_init`，这增加了很多开销并且更难维护代码。我需要一个简单的、免税的脚本来扩展 IPv6。

为社区发布此信息。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-08-23T16:06:15.643

下面是一个两行，其中`$ip`是一个压缩的 IPv6 地址。返回扩展`$ip`。

**示例**：

```
$ip = "fe80:01::af0";
echo expand($ip); // fe80:0001:0000:0000:0000:0000:0000:0af0 
```

**功能**：

```
function expand($ip){
    $hex = unpack("H*hex", inet_pton($ip));         
    $ip = substr(preg_replace("/([A-f0-9]{4})/", "$1:", $hex['hex']), 0, -1);

    return $ip;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2019-10-27T09:02:44.617

在 Mike Mackintosh 和 Yann Milin 的帮助下，我想出了这个函数：

```
function expandIPv6($ip) {
    $hex = bin2hex(inet_pton($ip));
    return implode(':', str_split($hex, 4));
} 
```

下面还有一个更通用的函数，女巫也将从 IPv4 映射的 IPv6 地址中提取 IPv4：

```
function expandIPv6($ip) {
    if (filter_var($ip, FILTER_VALIDATE_IP, FILTER_FLAG_IPV4))
        return $ip;
    elseif (filter_var($ip, FILTER_VALIDATE_IP, FILTER_FLAG_IPV6)) {
        $hex = bin2hex(inet_pton($ip));
        if (substr($hex, 0, 24) == '00000000000000000000ffff') // IPv4-mapped IPv6 addresses
            return long2ip(hexdec(substr($hex, -8)));
        return implode(':', str_split($hex, 4));
    }
    return false;
} 
```

# css - 如何使用 1 个输入字段 + 提交按钮布局表单，以便 和 背景不发光？

> ID：12095838
> 
> 赞同：1
> 
> 时间：2012-08-23T16:06:24.260
> 
> 标签：css, forms, layout, xhtml, css-tables

我正在尝试用几个“选项卡”制作一个非常简单的 XHTML/CSS 水平工具栏，其中一个是一个非常简单的搜索表单。

我有以下 XHTML 代码：

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
<link rel="stylesheet" type="text/css" href="main.css"/>
<title>Form test</title>
</head>

<body>

<div id="toolbar">
<div id="toolbar-content-wrapper">
<div id="toolbar-content">
<div class="toolbar-tab"><div>Language: EN</div></div>
<div class="toolbar-tab"><div id="search-box"><form action="search.php" method="get"><fieldset><input name="q" type="text"/><input value="Search!" type="submit"/></fieldset></form></div></div>
<div class="toolbar-tab"><div>hello-how-are-you?</div></div>
</div>
</div>
</div>

</body>

</html> 
```

和以下CSS：

```
* {
    margin: 0;
    padding: 0;
}

#toolbar {
    background-color: lightgray;
    width: 100%;

    /* A trick to make div expand vertically to embrace floats. */
    overflow: hidden;
}
#toolbar-content-wrapper {
    display: table;
    float: right;
}
#toolbar-content {
    display: table-row;
}
#toolbar-content > div.toolbar-tab {
    background-color: black;
    display: table-cell;
    padding: 0 2em;
    vertical-align: bottom;
}
#toolbar-content > div.toolbar-tab > div {
    background-color: yellow;
    color: black;
    border: thin solid black;
}

#search-box form, #search-box fieldset, #search-box input {
    border-style: none;
}
#search-box form {
    display: table;
    background-color: red;
}
#search-box fieldset {
    display: table-row;
    background-color: orange;
}
#search-box input {
    display: table-cell;
}
#search-box input[type=text] {
    background-color: white;
}
#search-box input[type=submit] {
    background-color: blue;
    color: white;
} 
```

这在 Epiphany 2.30.6 中渲染得很好，但在 Iceweasel 3.5.16 中非常糟糕。请参阅此处的屏幕截图：http: [//people.eisenbits.com/~stf/load/2012-08-23-form-test/](http://people.eisenbits.com/~stf/load/2012-08-23-form-test/)。在 Iceweasel 3.5.16 中，红色背景`<form>`和橙色背景`<fieldset>`是可见的！为什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T18:55:29.847

您所要做的就是添加`line-height: 0;`这些元素。

在 webkit 中效果很好，但由于“搜索”按钮的高度，在 FireFox 中留下了小条。

# c# - 在代码分析器中运行 C# 应用程序与在外部代码分析器中运行有何不同？

> ID：12095840
> 
> 赞同：5
> 
> 时间：2012-08-23T16:06:28.390
> 
> 标签：c#, .net, profiler

我试图了解代码分析器（在本例中为[Drone Profiler](http://www.droneprofiler.com/index.aspx)）如何运行 .NET 应用程序与直接运行它不同。我需要知道这一点的原因是因为我的开发计算机的 .NET 安装存在一个非常奇怪的问题/损坏，它在分析器之外表现出来，但非常奇怪的是不在内部，如果我能理解为什么我可以修复我的计算机的问题。

这个问题似乎只影响对 System.Net.NetworkInformation 方法的调用（并且仅在 .NET 3.5 到 2.0 中，如果我针对 4 构建一些东西，一切都很好）。我构建了一个小测试应用程序，它只做一件事，它调用 System.Net.NetworkInformation.IsNetworkAvailable()。在探查器之外，我在 System.dll 中出现“致命的执行引擎错误”，这就是它提供的所有信息。据我了解，错误通常是由本机方法调用引起的，这可能发生在 System.dll 让某些本机 DLL 执行 IsNetworkAvailable() 逻辑时。

*   [我尝试使用Process Monitor](http://technet.microsoft.com/en-us/sysinternals/bb896645.aspx)找出探查器的内部和外部差异，记录两种情况的事件并进行比较。在调用 iphlpapi.dll 和 winnsi.dll 之后以及在名为 dnsapi.dll 的分析器运行代码和非分析器代码开始加载崩溃报告相关内容之前，这两个日志都是相同的。在那一刻，当它似乎出错时，探查器运行代码创建了 4-6 个新线程，而非探查器（崩溃）代码只创建了 1 或 2 个。我不知道这意味着什么，如果有的话。

* * *

可以说是不必要的背景

我的 Windows 7 包括 .NET 安装（3.5 到 2.0）一直运行良好，直到我的硬盘驱动器出现一些损坏并且 checkdisk 开始发现坏集群。我将驱动器映像到了一个新的驱动器上，除了 .NET 的这个问题外，一切正常。

我需要重新安装 Windows 或恢复到映像备份来解决此问题。

以下是我调查过的一些事情：

*   我对磁盘故障前后似乎最相关的文件/目录（Windows 和程序文件下的 .NET 内容）进行了比较，并且没有看到我没有预料到的任何变化（没有明显的文件损坏）。
*   我已经区分了软件和系统注册表配置单元前后的磁盘故障，并且没有看到任何似乎相关的变化。
*   我创建了一个新用户帐户并清理了所有环境变量，以防环境相关。没变。
*   我做了“sfc /scannow”，它没有发现完整性问题。
*   我尝试“ngen update”来重新生成预编译代码，以防我错过了可能被损坏的东西并且没有任何改变。
*   我删除了我的病毒扫描程序，看看它是否有干扰，没有区别。
*   我尝试在安全模式下运行测试代码，同样的崩溃问题。

我假设我需要修复我的 .NET 安装，但由于 Windows 7 包含 .NET 3.5 - 2.0，您不能只重新运行 .NET 安装程序来重做它。我无权访问 Windows 磁盘来尝试自行重新安装 Windows（计算机有恢复分区，但无法使用）；该驱动器还使用全盘加密解决方案，重新安装会很困难。

我绝对不想在这里从头开始安装新的 Windows，重新安装数十个软件包，尝试记住数十个与开发相关的自定义/等等。

鉴于这一切......有人有任何有用的建议吗？作为一名开发人员，我需要 .NET 3.5 - 2.0 工作，并且需要针对它进行构建和测试。

谢谢！

昆西

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T02:37:12.457

简短的回答是我的 System.ni.dll 文件已损坏，我更换了它，一切都很好。

长答案可能会通过其解决方案的方法来帮助其他人......

我的问题与 .Net 相关的损坏方式导致应用程序无法运行，除非通过探查器。我下载了[SlimTune 开源分析器](http://code.google.com/p/slimtune/)的源代码，在本地构建它，并在调用 Process.Start() 之前设置了一个断点。然后，我比较了通过分析器与手动成功启动应用程序所涉及的所有参数。我发现的唯一有意义的区别是在环境变量中添加了 .NET 配置文件参数：

*   cor_enable_profiling=1
*   cor_profiler={38A7EA35-B221-425a-AD07-D058C581611D}

然后我尝试在我自己的用户环境中设置这些，瞧！现在我手动运行的任何应用程序都可以工作。（我实际上在几个小时前尝试过做同样的事情，但我使用了一个包含在示例中的 GUID，它没有指向真正的分析器，显然 .NET 知道我给了它一个虚假的 GUID，并且没有在分析模式下运行。）

我现在回去开始阅读有关 CLR 如何执行 PE 文件的内容，希望弄清楚为什么我的应用程序在启用分析的情况下运行很重要。我学到了很多东西，但似乎没有什么适用的。

然而，我确实记得我应该重新检查 chkdsk 日志，我一直在列出因驱动器故障而损坏的文件。失败后，我将所有列出的文件 id 转换为文件路径/名称，并且我已经替换了所有 100 多个文件，我可以从备份中找到，但当我现在回去查看时，我发现了一个注释，虽然我已经替换了 4 个或5 .NET 相关文件成功有一个这样的文件我无法替换，因为它正在“使用中”。那个文件？System.ni.dll！！！我现在能够从备份中替换这个文件，瞧我的 .NET 安装恢复正常，无论是否配置文件，应用程序都能正常工作。

令人沮丧的是，当这个事件第一次发生时，我完全认为问题与损坏的文件有关，特别是与一个名为 System.dll 的文件有关，该文件包含失败的方法。所以我对所有名为 System.dll 的文件进行了比较和重新比较。但当时我没有意识到 System.ni.dll 是 System.dll（或类似的）的本地编译表现。而且因为我已经对 .NET 相关目录进行了比较和重新比较，但没有注意到这一点（不知道我是怎么错过的），所以我放弃了这种方法。

无论如何...长话短说，这是一个损坏的 System.ni.dll 导致了我的问题，其中一个或多个集群的内容被替换为 0x0 并且它恰好表现为我观察到的奇怪问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T22:22:04.197

这听起来像是一个时间问题，分析器通过让它变慢一点来“修复”它。

许多分析器使用检测（[更多信息在这里](http://support.smartbear.com/articles/aqtime/profiling/)），这会稍微减慢应用程序的速度。显然，它减慢了一个线程的速度，以至于另一个线程可以做更多的工作，从而防止了崩溃。此类错误通常不会直接在开发人员的机器上表现出来，而是一旦在具有更多内核或超线程的处理器上运行时就会出现。有时它们只出现在发布版本中（反之亦然在调试版本中）。时序问题可能很难追踪，因为相同的代码在不同的条件下（在分析器或调试器中）可能会给出不同的结果。

根据您的描述，我将尝试对如何修复它进行疯狂猜测：

尝试在启动新线程的源中查找。然后在它们生成后添加`System.Threading.Thread.Sleep(500);`一行来暂停主线程并给新线程一些时间来启动。

如果没有源代码和一些崩溃的堆栈跟踪，这是相当多的猜测。

# c# - 审计 EF no T4

> ID：12095845
> 
> 赞同：1
> 
> 时间：2012-08-23T16:06:40.220
> 
> 标签：c#, asp.net-mvc, entity-framework, audit

我正在使用 EF 在 MVC3 应用程序中构建某种审计行为，并且我尝试了几种方法，试图避免对代码的高影响，当然，尽量避免额外的代码，因为申请已经完成了 35%。

`Audit`对象看起来像这样：

*   审计 ID
*   用户身份
*   操作 ID
*   模块 ID
*   时间戳
*   有效载荷
*   < 模块 >
*   < 操作 >
*   <用户>

思路如下：

我创建了一个部分类来隐藏`SaveChanges()`和覆盖`SaveChanges(SaveOptions)`。

然后我创建了两个相同方法的重载来接收我的实体作为参数和/或不是`SaveOptions`枚举参数。

除了明显之外，新`SaveChanges()`的设置了我的实体的属性`Audit`，但问题发生在这里：我需要 a`User`和`Module`an `Operation`。

我目前解决这个问题的解决方案如下：

*   我已经`Audit`在构造函数类级别声明了一个对象。
*   在控制器的构造函数中，我将 设置`User`为我的`Audit`对象。
*   在每种方法中，我都`Operation`根据需要设置。
*   在保存更改中，我处理来自`ObjectStateManager`.

`I'm very skeptic about this approach, it seems to be a little intrusive to my code. I've read lots of posts here in SO, but none of them helped me to improve this approach nor decide to change it. So please avoid linking things I've probably already read.`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T16:54:05.940

另一种选择是使用自定义属性装饰您希望审核的数据库实体。在 SaveChanges 期间检查属性。对于模块和操作字段，您可以捕获当时的堆栈跟踪 - 从中​​找到调用控制器和操作。这将有助于保持控制器清洁。

我在列级别进行审计，而不是对象。通常我只关心几列，而不是全部。作为参考，这是我的基础[DbContext](https://gist.github.com/76f5ea2195adad162d56)。我订阅了 ObjectContext.SavingChanges 事件，检查标记为已修改的所有内容，然后检查具有自定义 [Audit] 属性的任何属性。这可以很容易地扩展为也检查删除。

# python - 合并的迭代器产生模糊的结果

> ID：12095846
> 
> 赞同：2
> 
> 时间：2012-08-23T16:06:41.243
> 
> 标签：python, algorithm, primes, itertools, sieve-of-eratosthenes

我正在尝试使用[Sieve of Eratosthenes](http://en.wikipedia.org/wiki/Sieve_of_Eratosthenes)算法实现素数生成器。我这样做只是为了尝试使用递归[迭代器合并](https://stackoverflow.com/a/465043/862380)来实现 sifter。

我要做的是：

```
from itertools import count,islice,groupby
from heapq import merge

def primes3():
    p = 2
    yield p
    sifter = (i*p for i in count(p))
    s = next(sifter)
    for p in count(p+1):
        if p==s: # this p is sieved out
            print('s: {}'.format(s))
            s = next(sifter)
        else:
            yield p # this is prime
            print('p: {}'.format(p))
            sifter = (k for k, g in groupby(merge(sifter,(i*p for i in count(p))))) #add this serie to the sifter: p*p, p*(p+1), p*(p+2), ...

print(list(islice(primes3(),10))) 
```

输出是：

```
p: 3
s: 4
p: 5
p: 6
p: 7
p: 8
p: 9
p: 10
p: 11
s: 12
[2, 3, 5, 6, 7, 8, 9, 10, 11, 13] 
```

第一个被筛选出来的数字是`4`。但接下来是`12`，不是`6`应该的。这是为什么？我用以下代码检查了它：

```
>>> sifter = (i*2 for i in count(2))
>>> next(sifter)
4
>>> sifter = (k for k, g in groupby(merge(sifter,(i*3 for i in count(3)))))
>>> print(list(islice(sifter,20)))
[6, 8, 9, 10, 12, 14, 15, 16, 18, 20, 21, 22, 24, 26, 27, 28, 30, 32, 33, 34] 
```

因此，正如我们所见，在测试条件下， sifter 会产生正确的结果。

我在哪里犯错？我认为这一定是我看不到的微不足道的事情。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T16:49:04.633

我不得不同意，这些东西有时会让人很困惑（但这是一个很好的谜题！）。

事实证明，`sifter`当值更改时，您的迭代器会`p`更改（顺便说一下，我使用 python 2.6.5 来测试它，而不是 python 3，所以打印语法有点不同）：

```
>> p = 2
>> sifter = (i*p for i in count(p))
>> for x in range(3):
>>    print next(sifter)
4
6
8
>>> # now lets see what happens when we change p
>>> p = 3
>>> for x in range(3):
>>>     print next(sifter)
15
18
21 
```

因此，一旦 p 更新`i*p`，迭代器的部分就用 p 的**新值进行评估。**p 确实在您的主循环中更新，这就是您没有得到预期结果的原因。

有一个简单的方法可以解决这个问题：创建一个函数来生成 sifter 迭代器，使得迭代器不受 p 的限制：

```
def gensifter(x):
    return (i*x for i in count(x)) 
```

并将其放入您的代码中（同样，我将其转换为 python 2.6.5）：

```
def primes3():
    p = 2
    yield p
    sifter = gensifter(p) # <-- changed!
    s = next(sifter)
    for p in count(p+1):
        #print '(testing p = %d\ts = %d)' % (p, s)
        if p==s: # this p is sieved out
            print 's:', s
            s = next(sifter)
        else:
            yield p # this is prime
            print 'p:', p
            sifter = (k for k, g in groupby(merge(sifter,gensifter(p)))) # <-- changed! 
```

现在让我们看看结果：

```
>>> print list(islice(primes3(), 10))
p: 3
s: 4
p: 5
s: 6
p: 7
s: 8
s: 9
s: 10
p: 11
s: 12
p: 13
s: 14
s: 15
s: 16
p: 17
s: 18
p: 19
s: 20
s: 21
s: 22
p: 23
s: 24
s: 25
s: 26
s: 27
s: 28
[2, 3, 5, 7, 11, 13, 17, 19, 23, 29] 
```

大量的质数！

# tumblr - 允许对 tumblr 的新 /image/ 页面进行更改的变量是什么？

> ID：12095849
> 
> 赞同：3
> 
> 时间：2012-08-23T16:06:46.010
> 
> 标签：tumblr

我似乎找不到任何关于如何对[tumblr 指南](http://www.tumblr.com/docs/en/custom_themes)上看似新的“.../image/...”页面进行更改的说明（在“基本变量”下）

例如，在更改“.../post/...”页面时，我可以使用“{block:PermalinkPage} {/block:PermalinkPage}”

有谁知道允许对“.../image/...”页面进行更改的变量？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-21T11:12:32.877

不能对此进行更改；该页面的目的似乎是提供一个更好看的版本，仅链接到图像本身，当然，这本身也不是可定制的。

`/image/`您可以通过使用`<a href="{Permalink}">`or`<a href="{PhotoURL-HighRes}">`代替`{LinkOpenTag}`和`</a>`代替来防止链接到页面`{LinkCloseTag}`。但这有一个副作用，即取消对点击链接的支持。

# git - Git 在 Samba 共享上的提交速度非常慢。我该怎么做才能加快速度？

> ID：12095852
> 
> 赞同：12
> 
> 时间：2012-08-23T16:07:10.450
> 
> 标签：git, windows-7, samba

我正在远程服务器上运行 git 存储库。我让它在远程服务器上设置了一个 samba 共享，这样我就可以将我的代码保存在那里而不是我的本地 Windows 7 机器上。我们正在尝试使用 git，因为 svn 非常缓慢且不可靠。我们在使用 git 时遇到的问题是，对 samba 共享执行任何提交/克隆/拉取操作都非常慢。如果我在 Windows 7 机器上对本地目录执行提交/克隆/拉取操作，效果很好，但我们需要将代码放在远程服务器上。有任何想法吗？我真的可以使用它。

编辑：

我还应该提到我已经运行了 git gc --aggressive 并且它没有加快速度。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T16:09:27.757

Git 不适合在此配置中使用。这就像获得一级方程式赛车并让它在土路上比赛。

Git 是一个 DVCS，即分布式版本控制。换句话说，每个开发人员都会得到一个克隆。

您需要做的是在该 samba 机器上设置一个 git 服务器存储库并通过 http 或 ssh 访问该存储库

您可以使用[GitBlit 之](https://github.com/gitblit/gitblit)类的项目 ，甚至可以使用[Github上的帐户](http://www.github.com)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-07-11T15:47:24.570

我对 Git 在 SMB 共享上的性能也有同样的问题。不幸的是，我无法在本地机器上运行开发代码，因此我使用 SMB 挂载远程目录并在本地机器上使用适当的文本编辑器编辑源文件。

因为在提交到存储库时我想要一些舒适，所以我更喜欢在我的本地机器上运行的 GUI 客户端。但是，对于提到的性能问题，这有点棘手，并且需要很多时间。

然而：我找到了一个时髦的小解决方法。在向存储库提交任何内容之前，我使用 将远程源的副本拉到本地硬盘驱动器`rsync`，如下所示：

```
rsync -az --progress --exclude ".git" dev@my.devserver.com:/home/myapp/sourcecode /Devel/portal-mirror 
```

这样，在进行差异和提交之前，只需不到一秒的时间就可以对远程状态进行完整的一对一同步（将其绑定到我的 Git 应用程序中的键盘快捷键）。奇迹般有效。`git reset --hard`在提交并推送到存储库后，我只是`git pull`在开发服务器上同步更改。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-01-22T09:32:51.410

我们使用 git 和 samba 结合 php-storm 运行相同的配置。它运行得很好。只有当我尝试在我们的大型项目中使用“SourceTree”时，它需要很长时间才能刷新，因为（我认为）git 会扫描每个文件来这样做。

我尝试过的一件事是稍微调整一下 samba 服务器，并从中获得了一些性能改进：

配置文件：

```
socket options = TCP_NODELAY IPTOS_LOWDELAY SO_RCVBUF=65536 SO_SNDBUF=65536 
```

在寻找 samba 加速时找到了那条线。

另一种解决方案可能是一个恒定的 1 对 1 同步，它一直在后台运行，以取代 samba。也许可以对 rsync 进行一些修改来这样做。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-09-26T16:22:12.570

您可能会考虑稍微颠倒一下范式，让 Web 服务器在开发人员的机器上挂载共享。这样，所有的克隆/提交/编码都在本地完成，但每个开发人员的站点都只是托管在共享中。

现在我假设您的网络服务器将每个网站的根目录公开为 samba 共享。然后，开发人员在他或她的本地计算机上安装该共享，克隆一些存储库，然后使用该共享工作。在这种情况下，性能充其量只会很差，而且您可能还会遇到字节范围锁定请求 (BRL) 等问题。

相反，一个选项是直接克隆到每个开发人员计算机上的目录，并共享该目录。然后，Web 服务器安装该共享。

当然，理想情况下，每个开发人员都将运行他或她自己的 Web 服务器实例，但如果我正确地阅读了这些问题，那么在这种情况下，这可能不是一个选择。

# ruby-on-rails-3 - Google 任务 API 身份验证问题 ruby

> ID：12095854
> 
> 赞同：1
> 
> 时间：2012-08-23T16:07:18.380
> 
> 标签：ruby-on-rails-3, google-api, oauth-2.0, google-tasks-api

我在为谷歌任务验证用户身份时遇到问题。

首先，它对用户进行身份验证并完美地做事。但是在第二次旅行中它会引发错误。

```
Signet::AuthorizationError - Authorization failed.  Server message:
{
  "error" : "invalid_grant"
}: 
```

以下是代码：

```
def api_client code=""
  @client ||= (begin
      client = Google::APIClient.new
      client.authorization.client_id = settings.credentials["client_id"]
      client.authorization.client_secret = settings.credentials["client_secret"]
      client.authorization.scope = settings.credentials["scope"]
      client.authorization.access_token = "" #settings.credentials["access_token"]
      client.authorization.redirect_uri = to('/callbackfunction')
      client.authorization.code = code
      client
    end)
end

get '/callbackfunction' do
  code = params[:code]
  c = api_client code
  c.authorization.fetch_access_token!
  result = c.execute("tasks.tasklists.list",{"UserId"=>"me"})
  unless result.response.status == 401
    p "#{JSON.parse(result.body)}"
  else
    redirect ("/oauth2authorize")
  end
end

get '/oauth2authorize' do
  redirect api_client.authorization.authorization_uri.to_s, 303
end 
```

执行第二个请求有什么问题？

更新：这是用户同意的链接和参数。

```
https://accounts.google.com/o/oauth2/auth?
access_type=offline&
approval_prompt=force&
client_id=somevalue&
redirect_uri=http://localhost:4567/oauth2callback&
response_type=code&
scope=https://www.googleapis.com/auth/tasks 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-24T08:02:32.937

问题已解决。

解决方案：

在**回调函数中，通过用户同意提供的****代码**接收到的令牌存储在数据库中。

然后在其他函数中，只需从数据库中检索这些令牌并用于处理您想要针对 google 任务 API 的任何内容。

```
get '/callbackfunction' do
  code = params[:code]
  c = api_client code
  c.authorization.fetch_access_token!
  # store the tokens in the database.
end

get '/tasklists' do
  # Retrieve the codes from the database and create a client
  result = client.execute("tasks.tasklists.list",{"UserId"=>"me"})
  unless result.response.status == 401
    p "#{JSON.parse(result.body)}"
  else
    redirect "/oauth2authorize"
  end
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-31T12:56:22.053

我正在使用rails，并且我只将令牌存储在数据库中。然后使用脚本我在调用执行之前设置新客户端，以下是代码。

```
client = Google::APIClient.new(:application_name => 'my-app', :application_version => '1.0')
client.authorization.scope = 'https://www.googleapis.com/auth/analytics.readonly'
client.authorization.client_id = Settings.ga.app_key
client.authorization.client_secret = Settings.ga.app_secret
client.authorization.access_token = auth.token
client.authorization.refresh_token = true
client.authorization.update_token!({access_token: auth.token})

client.authorization.fetch_access_token!

if client.authorization.refresh_token && client.authorization.expired?
    client.authorization.fetch_access_token!
end

puts "Getting accounts list..."

result = client.execute(:api_method => analytics.management.accounts.list)
puts " ===========> #{result.inspect}"
items = JSON.parse(result.response.body)['items'] 
```

但是，它给出了你面临的同样的错误，

```
 /signet-0.4.5/lib/signet/oauth_2/client.rb:875:in `fetch_access_token': Authorization  failed.  Server message: (Signet::AuthorizationError)
{
  "error" : "invalid_grant"
}
    from /signet-0.4.5/lib/signet/oauth_2/client.rb:888:in `fetch_access_token!' 
```

请提出为什么它不能使用给定的令牌？我用过oauth2，所以用户已经被授权了。现在我想访问 api 并获取数据...

===================**更新**===================

好的，有两个问题，

1.  权限要添加到devise.rb，

    ```
    config.omniauth :google_oauth2, Settings.ga.app_key,Settings.ga.app_secret,{ 
      access_type: "offline", 
      approval_prompt: "" ,
      :scope => "userinfo.email, userinfo.profile, plus.me, analytics.readonly" 
    ```

    }

2.  refresh_token 必须传递给 API 调用，否则无法授权。

我希望这对面临类似问题的人有所帮助。

# android - 在 Android 中调整位图大小

> ID：12095856
> 
> 赞同：3
> 
> 时间：2012-08-23T16:07:21.567
> 
> 标签：android, bitmap

我想简单地调整我从以下名为 Image Loader 的类（使用 Lazy Loadng 方案）中获得的位图的大小。我想简单地将我的图像尺寸缩短为 60*60 尺寸。但是当我使用 -

```
bitmap = Bitmap.createScaledBitmap(bitmap, 20, 25, false);
imageView.setImageBitmap(bitmap); 
```

它和我想要的一样，但是出来的位图非常模糊。有没有其他方法来实现相同的。

这是我在 BITMAP dDISPLAYER(iNNER cLASS) 中的图像加载器类，我通过上面显示的代码设置图像。

```
package com.irant.LazyLoading;

import java.io.ByteArrayOutputStream;
import java.io.File;
import java.io.FileInputStream;
import java.io.FileNotFoundException;
import java.io.FileOutputStream;
import java.io.InputStream;
import java.io.OutputStream;
import java.net.HttpURLConnection;
import java.net.URL;
import java.util.Map;
import java.util.Stack;
import java.util.concurrent.ConcurrentHashMap;

import com.irant.a1techno.R;

import android.app.Activity;
import android.content.Context;
import android.graphics.Bitmap;
import android.graphics.BitmapFactory;
import android.graphics.Color;
import android.graphics.Matrix;
import android.widget.ImageView;

public class ImageLoader {

    MemoryCache memoryCache=new MemoryCache();
    FileCache fileCache;
    private Map<ImageView, String> imageViews = new ConcurrentHashMap<ImageView, String>();

    public ImageLoader(Context context){
        //Make the background thead low priority. This way it will not affect the UI performance
        photoLoaderThread.setPriority(Thread.NORM_PRIORITY-1);

        fileCache=new FileCache(context);
    }

    final int stub_id=R.drawable.ic_launcher;
    public void displayImage(String url, Activity activity, ImageView imageView)
    {
        imageViews.put(imageView, url);
        Bitmap bitmap=memoryCache.get(url);
        if(bitmap!=null)
        {
            //bitmap = Bitmap.createScaledBitmap(bitmap, 25, 25, true);
            imageView.setImageBitmap(bitmap);

        }
        else
        {

            queuePhoto(url, activity, imageView);
            imageView.setImageResource(stub_id);
        }    
    }

    private void queuePhoto(String url, Activity activity, ImageView imageView)
    {
        //This ImageView may be used for other images before. So there may be some old tasks in the queue. We need to discard them. 
        photosQueue.Clean(imageView);
        PhotoToLoad p=new PhotoToLoad(url, imageView);
        synchronized(photosQueue.photosToLoad){
            photosQueue.photosToLoad.push(p);
            photosQueue.photosToLoad.notifyAll();
        }

        //start thread if it's not started yet
        if(photoLoaderThread.getState()==Thread.State.NEW)
            photoLoaderThread.start();
    }

    private Bitmap getBitmap(String url) 
    {
        File f=fileCache.getFile(url);
        InputStream is;
        //from SD cache
        Bitmap bitmap=null;
        Bitmap b = decodeFile(f);
        if(b!=null)
            return b;

        //from web
        try {

            System.out.println("---------------------IMAGE URL: "+url);

            URL imageUrl = new URL(url);
            HttpURLConnection conn = (HttpURLConnection)imageUrl.openConnection();
            conn.setConnectTimeout(30000);
            conn.setReadTimeout(30000);
            is=conn.getInputStream();
            OutputStream os = new FileOutputStream(f);
            Utils.CopyStream(is, os);
            os.close();
            bitmap = ShrinkBitmap(url, 60, 60);
            bitmap = decodeFile(f);
            ByteArrayOutputStream baos = new ByteArrayOutputStream();
            bitmap.compress(Bitmap.CompressFormat.JPEG, 40, baos);
            return bitmap;
        } catch (Exception ex){
            System.out.println("---------------------IMAGE URL: "+url);
            ex.printStackTrace();
            //stopThread();
            return null;

        }
        finally{
            bitmap = null;
            is=null;
        }
    }

    Bitmap ShrinkBitmap(String file, int width, int height){

        BitmapFactory.Options bmpFactoryOptions = new BitmapFactory.Options();
        bmpFactoryOptions.inJustDecodeBounds = true;
        Bitmap bitmap = BitmapFactory.decodeFile(file, bmpFactoryOptions);

        int heightRatio = (int)Math.ceil(bmpFactoryOptions.outHeight/(float)height);
        int widthRatio = (int)Math.ceil(bmpFactoryOptions.outWidth/(float)width);

        if (heightRatio > 1 || widthRatio > 1)
        {
            if (heightRatio > widthRatio)
            {
                bmpFactoryOptions.inSampleSize = heightRatio;
            } else {
                bmpFactoryOptions.inSampleSize = widthRatio; 
            }
        }

        bmpFactoryOptions.inJustDecodeBounds = false;
        bitmap = BitmapFactory.decodeFile(file, bmpFactoryOptions);
        return bitmap;
    }

    //decodes image and scales it to reduce memory consumption
    private Bitmap decodeFile(File f){
        try {
            //decode image size
            BitmapFactory.Options o = new BitmapFactory.Options();

            o.inJustDecodeBounds = true;
            BitmapFactory.decodeStream(new FileInputStream(f),null,o);

            //Find the correct scale value. It should be the power of 2.
            final int REQUIRED_SIZE=70;
            int width_tmp=o.outWidth, height_tmp=o.outHeight;
            int scale=1;
            while(true){
                if(width_tmp/2<REQUIRED_SIZE || height_tmp/2<REQUIRED_SIZE)
                    break;
                width_tmp/=2;
                height_tmp/=2;
                scale*=2;
            }

            //decode with inSampleSize
            BitmapFactory.Options o2 = new BitmapFactory.Options();
            o2.inSampleSize=scale;
            return BitmapFactory.decodeStream(new FileInputStream(f), null, o2);
        } 
        catch(OutOfMemoryError e)
        {
            e.printStackTrace();
        }catch (FileNotFoundException e) {}
        return null;
    }

    //Task for the queue
    private class PhotoToLoad
    {
        public String url;
        public ImageView imageView;
        public PhotoToLoad(String u, ImageView i){
            url=u; 
            imageView=i;
        }
    }

    PhotosQueue photosQueue=new PhotosQueue();

    public void stopThread()
    {
        photoLoaderThread.interrupt();
    }

    //stores list of photos to download
    class PhotosQueue
    {
        private Stack<PhotoToLoad> photosToLoad=new Stack<PhotoToLoad>();

        //removes all instances of this ImageView
        public void Clean(ImageView image)
        {
            for(int j=0 ;j<photosToLoad.size();){
                if(photosToLoad.get(j).imageView==image)
                    photosToLoad.remove(j);
                else
                    ++j;
            }
        }
    }

    public class PhotosLoader extends Thread {
        public void run() {
            try {
                while(true)
                {
                    //thread waits until there are any images to load in the queue
                    if(photosQueue.photosToLoad.size()==0)
                        synchronized(photosQueue.photosToLoad){
                            photosQueue.photosToLoad.wait();
                        }
                    if(photosQueue.photosToLoad.size()!=0)
                    {
                        PhotoToLoad photoToLoad;
                        synchronized(photosQueue.photosToLoad){
                            photoToLoad=photosQueue.photosToLoad.pop();
                        }
                        Bitmap bmp=getBitmap(photoToLoad.url);
                        memoryCache.put(photoToLoad.url, bmp);
                        String tag=imageViews.get(photoToLoad.imageView);
                        if(tag!=null && tag.equals(photoToLoad.url)){
                            BitmapDisplayer bd=new BitmapDisplayer(bmp, photoToLoad.imageView);
                            Activity a=(Activity)photoToLoad.imageView.getContext();
                            a.runOnUiThread(bd);
                        }
                    }
                    if(Thread.interrupted())
                        break;
                }
            } catch (InterruptedException e) {
                //allow thread to exit
                System.out.println("This is the Exit Point............");
            }
        }
    }

    PhotosLoader photoLoaderThread=new PhotosLoader();

    //Used to display bitmap in the UI thread
    class BitmapDisplayer implements Runnable
    {
        Bitmap bitmap;
        ImageView imageView;
        public BitmapDisplayer(Bitmap b, ImageView i){bitmap=b;imageView=i;}
        public void run()
        {
            if(bitmap!=null)
            {
                bitmap = Bitmap.createScaledBitmap(bitmap, 20, 25, false);
                imageView.setImageBitmap(bitmap);
            }
            else
                imageView.setImageResource(stub_id);
        }
    }

    public void clearCache() {
        memoryCache.clear();
        fileCache.clear();
    }

} 
```

请回复我。提前致谢

如果您不理解，请不要投反对票。如果有人可以，请帮助我。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T17:31:23.700

`scaleType`an的默认值`ImageView`是`FIT_CENTER`，这意味着您提供给的任何图像都`ImageView`将被缩放，以便轴之一（在您的情况下）为 110dp。因此，传递一个已缩小到 10*10 的位图将拉伸该位图以填充 110*110 的空间，而拉伸到那么大的 10*10 确实会非常模糊。尝试使用其他`scaleType`s 之一，特别`CENTER`是查看图像的未模糊、正常大小的版本：

```
imageView.setScaleType(ImageView.ScaleType.CENTER); 
```

如果这不是您想要的效果，请知道无论您做什么，缩小图像然后再次将其拉回总是会使它的质量低于您开始时的质量。您似乎在上面的代码示例中尝试做的很多事情都是由`ImageView`课程本身为您完成的 - 我鼓励您仔细查看`ScaleType`s 以及它们可以为您做什么

# c# - 从字符串末尾删除空格的最佳方法

> ID：12095857
> 
> 赞同：2
> 
> 时间：2012-08-23T16:07:24.913
> 
> 标签：c#, string

> **可能重复：**
> [如何自动删除字符串开头或结尾的所有空格](https://stackoverflow.com/questions/3381952/how-automatically-remove-all-white-spaces-start-or-end-in-a-string)

我有许多字符串需要从中修剪空格，但是我只需要从末尾删除它们。它们用于公司和个人名称，因此字符串中间可以有空格。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-08-23T16:08:55.003

你可以只使用`Trim()`，或者如果你只想申请到最后`TrimEnd()`

```
string s = "test                      ";

s = s.Trim();
s = s.TrimEnd(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-23T16:09:46.890

只从最后？

```
String.TrimEnd() 
```

[http://msdn.microsoft.com/en-us/library/system.string.trimend.aspx](http://msdn.microsoft.com/en-us/library/system.string.trimend.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-23T16:09:54.800

[`String.TrimEnd`](http://msdn.microsoft.com/en-us/library/system.string.trimend.aspx)答案是——仅从字符串末尾修剪选定的字符。

**注意：**您应该注意 MSDN 中的文档：此方法的行为发生了**重大更改**，因此实际行为取决于您所针对的 .NET Framework 版本：

> **调用者注意事项**
> .NET Framework 3.5 SP1 及更早版本维护一个空白字符的内部列表，如果*trimChars*是`null`或空数组，此方法将修剪这些空白字符。从 .NET Framework 4 开始，如果*trimChars*为 null 或空数组，则该方法会修剪所有 Unicode 空白字符（即，`true` 在传递给该方法时产生返回值的字符`Char.IsWhiteSpace`）。由于此更改，`Trim()`.NET Framework 3.5 SP1 及更早版本中的方法删除了两个字符，零宽度空格 (U+200B) 和零宽度无间隔空格 (U+FEFF)，即`Trim()`.NET Framework 4 及更高版本中的方法不会删除。此外，.NET Framework 3.5 SP1 及更早版本中的 Trim() 方法不会修剪三个 Unicode 空白字符：蒙古元音分隔符 (U+180E)、NARROW NO-BREAK SPACE (U+202F) 和 MEDIUM数学空间（U+205F）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-23T16:10:08.450

你可以只使用`s.TrimEnd(' ');`.

如果您省略该参数，它将删除*所有*Unicode 空白字符（这可能是也可能不是您想要实现的）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-23T16:10:14.363

```
Strings.RTrim("string") 
```

[文档](http://msdn.microsoft.com/en-us/library/microsoft.visualbasic.strings.rtrim.aspx)

```
"string".TrimEnd() 
```

[文档](http://msdn.microsoft.com/en-us/library/system.string.trimend.aspx)

# c++ - 虚假的“函数调用中缺少哨兵”

> ID：12095865
> 
> 赞同：5
> 
> 时间：2012-08-23T16:08:08.527
> 
> 标签：c++, unix, gcc, g++, exec

这个简单的片段使用 g++ 4.7.0 生成“函数调用中缺少哨兵”警告，如果编译为 Cand C++ 源代码。我相信这是编译器的错误，因为最终`NULL`值在那里。

```
#include <unistd.h>

int main() {
    execlp("mkdir", "mkdir", "-p", "test", NULL);
    return 0;
} 
```

我对吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-23T16:14:29.927

不你错了。

在 C++ 中，NULL 类似于`0`or`0L`并且在 C 中可能相同。如果该常量的类型小于指针，则将其传递给可变参数函数是不安全的，因为高位将被垃圾填充。

在 Linux 上，`execlp(1)`手册页说：

> 参数列表**必须**由 NULL 指针终止，并且由于这些是可变参数函数，因此必须强制转换此指针`(char *) NULL`。

即便携地提供你需要做的哨兵：

```
 execlp("mkdir", "mkdir", "-p", "test", (char*)NULL); 
```

这就是 GCC 向您发出的警告。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T16:15:19.360

从我的[文档](http://linux.die.net/man/3/execlp)：

```
since  these  are variadic functions, this pointer must be cast `(char *) NULL`. 
```

尝试：

```
execlp("mkdir", "mkdir", "-p", "test", (char*)NULL); 
```

# c++ - 二元运算符+重载的返回值是否应该是 const 并且会干扰优化？

> ID：12095874
> 
> 赞同：0
> 
> 时间：2012-08-23T16:08:37.877
> 
> 标签：c++, operator-overloading, constants, c++03, copy-elision

给定示例代码：

```
class Integer
{
    int i_;
public:
    Integer(int i) : i_(i) {}
    const Integer operator+(const Integer &arg) const { return Integer(i_ + arg.i_); }
}; 
```

我开始怀疑 operator+() 是否应该实际返回一个 const Integer。Bruce Eckel 在“Thinking in C++”中为类似情况提供了运算符重载的示例，并且似乎支持返回类型上的 const 修饰符。应该使用它，为什么？

另一方面，让我们尝试使用这个类：

```
int main()
{
    Integer a(1), b(2);
    Integer c = a + b;
} 
```

当将*c*创建为*a*和*b的总和时，编译器很可能会执行复制省略，并且 Integer::operator+() 将直接在**c*占用的位置创建其结果（请参阅“[想要速度？按值传递](http://cpp-next.com/archive/2009/08/want-speed-pass-by-value/)”）。但是当 Integer::operator+() 的返回类型声明为 const 时，由于目标是非常量的，这不会强制编译器执行复制吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T16:18:49.333

返回 an`Integer const`可以防止以下情况：

```
(a + b) = c; 
```

我从来没有发现这是一个太大的问题，但是禁止它确实使该类型的行为更像内置类型。它不应该对返回值优化产生任何影响。

如果该类的复制成本非常高，并且可以有效地支持右值引用，那么您可能希望避免`const` 这样做，但实际上，我怀疑这样的类非常罕见，以至于您可以忽略它们。

# javascript - 简单的 HTML 输入 onkeypress 事件不起作用

> ID：12095875
> 
> 赞同：0
> 
> 时间：2012-08-23T16:08:38.800
> 
> 标签：javascript, function, textbox, event-handling

我是新来的（一般是 Web 开发），我一直在试图理解为什么我的函数没有在指定的事件上执行。

我找到了这篇文章，它看起来和我想要的完全一样，但即使这样也没有用：

[html <input type="text" /> onchange 事件不起作用](https://stackoverflow.com/questions/6290442/html-input-type-text-onchange-event-not-working)

任何帮助，将不胜感激。我的确切代码如下。我有一些文本输入字段（实际上是搜索框），最终我想让它在用户将数据输入文本字段时选中一个复选框，但它甚至似乎都没有调用该函数。

在阅读上述帖子时，我尝试了一些变体。以下是我尝试过的一些输入字段属性：

```
<input type="date" name="dt" size="10" value="2012-07-21" onChange="SetCheckBox('d')" />
<input type="search" size="10" name="sl" value="" onChange="SetCheckBox('n')" />
<input type="search" size="10" name="sf" value="" onkeypress="SetCheckBox('n')" />
<input type="search" size="20" name="st" value="" onkeypress="SetCheckBox(this);" /> 
```

这是我的javascript：

```
<script language="javascript" type="text/javascript">
    Function SetCheckBox(id) {
        alert (id.value);
        document.write('test');
    }
</script> 
```

我试过不传递任何参数而只做一个document.write，但它似乎没有调用该函数。是的，javascript 已启用，并且可以在页面上的其他地方正常工作！脚本在正文中，就在表单的下方。

（缺乏）行为在多个浏览器中是相同的。感谢您提供任何帮助。射线

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T16:11:34.720

对于 javascript，`function`关键字是小写的。

```
Function SetCheckBox(id) 
```

需要是：

```
function SetCheckBox(id) 
```

另外，您没有传递对象来获取 id，所以...

```
function SetCheckBox(id) {
        var ele = document.getElemenyById(id);
        alert (ele.value);
        document.write('test');
 } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T16:18:04.683

除了已经提到的Function中的大写F之外的几个问题

1.  您的函数传递了一个名为 id 的变量，但需要一个字段
2.  您传递的字符串不是 ID 且未引用字段
3.  只有使用 (this) 的最后一个版本才有效，但没有值得提醒的地方
4.  document.write 将在页面加载后调用它时擦除页面及其上的所有脚本（例如，非内联）

所以代码应该是

```
function SetCheckBox(id) {
    var val = document.getElementById(id).value
    alert (val);
    document.getElementById('someContainer').innerHTML=val;
} 
```

或者

```
function SetCheckBox(fld) {
    var val = fld.value
    alert (val);
    document.getElementById('someContainer').innerHTML=val;
} 
```

* * *

根据您的描述，我猜您想这样做：[DEMO](http://jsfiddle.net/mplungjan/8FuXh/)

```
<input type="date" id="dt" name="dt" size="10" value="2012-07-21"
onkeypress="SetCheckBox(this)" />
<input type="checkbox" id="dtChk" /> 
```

使用这个脚本

```
function SetCheckBox(fld) {
    var checkbox = document.getElementById(fld.id+"Chk");
    // check if something is entered, uncheck if not
    checkbox.checked=fld.value.length>0; 
} 
```

甚至可能加上这个

```
window.onload=function() {
  document.getElementById("dt").onkeypress();
} 
```

如果该字段在（重新）加载时不为空，它将选中该框

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T16:14:04.103

在 javascript 中，函数关键字是用小写字母写的，在这里你用大写字母写了 F。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-23T16:20:16.760

onkeypress 和 onchange 事件应该可以工作

```
<body>
<script type="text/javascript">

function SetCheckBox() {
    alert("1");
}

</script>

<input id = "test" value="" onkeypress="SetCheckBox();" />

<input id = "test1" value="" onchange="SetCheckBox()" />

</body> 
```

# c# - 身份扩展

> ID：12095876
> 
> 赞同：2
> 
> 时间：2012-08-23T16:08:50.467
> 
> 标签：c#, asp.net-mvc, extension-methods, membership-provider, iidentity

我正在尝试对 IIdentity 使用 exention 方法

这是我的课：

```
public static class MyIdentity 
{
    public static string FullName(this IIdentity identity)
    {
        return "John Doe";
    }
} 
```

我正在尝试像这样在我的视图中使用它：

```
@Context.User.Identity.FullName() 
```

但我收到以下错误：

> “System.Security.Principal.IIdentity”不包含“FullName”的定义，并且找不到接受“System.Security.Principal.IIdentity”类型的第一个参数的扩展方法“FullName”

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-23T16:10:40.493

确保您已将定义此扩展方法的命名空间带入视图中的范围：

```
@using NameSpaceInWhichTheMyIdentityStaticClassIsDefined
@User.Identity.FullName() 
```

或者，如果您想在许多视图中使用它以避免在每个视图中添加此命名空间，您也可以将其添加到（不要与 混淆）的`<namespaces>`部分：`~/views/web.config``~/web.config`

```
<add namespace="NameSpaceInWhichTheMyIdentityStaticClassIsDefined" /> 
```

# python - 编程错误 1064

> ID：12095879
> 
> 赞同：0
> 
> 时间：2012-08-23T16:08:58.537
> 
> 标签：python, mysql, mysql-error-1064, tornado

当我尝试使用以下 SQL 从 MySQL 数据库中获取一些结果时，

```
entries = db.query("SELECT * FROM users ORDER BY created_at DESC LIMIT %s", count) 
```

我收到了这个错误：

> 文件“/Library/Python/2.7/site-packages/MySQLdb/connections.py”，第 36 行，在 defaulterrorhandler raise errorclass, errorvalue ProgrammingError: (1064, "You have an error in your SQL syntax; check the manual that对应您的 MySQL 服务器版本，以便在第 1 行的 ''20'' 附近使用正确的语法")

我真的不知道我的 SQL 脚本有什么问题。实际上，它在我以前的 PHP 版本的服务器中运行良好。为什么它在我的 Python 版本中不起作用？有什么与 Tornado 数据库包装器相关的特定内容吗？

我试图搜索整个互联网，没有运气。:(

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T16:12:19.523

~~您正在使用 '%s' 占位符，因此`count`值（显然是 20）被引用（这使您的查询以 结尾`LIMIT '20'`）。尝试`'%d'`改用。~~

好吧，正如 Cole Maclean 所说，你不能在这里使用非'%s' 占位符；至少可以说，这使我的解决方案有点错误。

然而原因还是一样的：LIMIT 参数应该是一个数字，而不是“数字字符串”。但是引号以某种方式到达了最终查询： MySQL 错误消息显然是关于 LIMIT '20' 行。

反过来，这可能是由 MySQLdb 库中的错误引起的，或者 - 也许 - 赋予`count`变量的错误值：字符串`'20'`（带有引号作为它的一部分）而不是数字 20。我承认，这两种情况对我来说似乎都不太可能.

你能用硬编码的文字代替 来测试这个查询`count`吗？喜欢...

```
db.query("SELECT * FROM users ORDER BY created_at DESC LIMIT %s", 20) 
```

# c# - yield IEnumerable 上的迭代器问题

> ID：12095884
> 
> 赞同：1
> 
> 时间：2012-08-23T16:09:18.517
> 
> 标签：c#, ienumerable, yield-return

我编写了一个程序，旨在从给定的起点创建一个随机数字列表。这是一个快速的脏东西，但我在玩它时发现了一个我不太理解的有趣效果。

```
void Main()
{
    List<int> foo = new List<int>(){1,2,3};
    IEnumerable<int> bar = GetNumbers(foo);
    for (int i = 1; i < 3; i++)
    {
        foo = new List<int>(){1,2,3};
        var wibble = GetNumbers(foo);
        bar = bar.Concat(wibble);
    }
    Iterate(bar);
    Iterate(bar);
}

public void Iterate(IEnumerable<int> numbers)
{
    Console.WriteLine("iterating");
    foreach(int number in numbers)
    {
        Console.WriteLine(number);
    }
}

public IEnumerable<int> GetNumbers(List<int> input)
{
    //This function originally did more but this is a cutdown version for testing.
    while (input.Count>0)
    {
        int returnvalue = input[0];
        input.Remove(input[0]);
        yield return returnvalue;
    }
} 
```

运行它的输出是：

```
iterating
1
2
3
1
2
3
1
2
3
iterating 
```

也就是说我第二次`bar`在它为空后立即迭代。

我认为这与我第一次迭代它清空用于生成列表的列表并随后使用这些相同的列表现在为空的列表进行迭代的事实有关。

我的困惑是为什么会这样？为什么我的 IEnumerable 每次枚举时都不会从默认状态开始？有人可以解释一下我到底在做什么吗？

并且要清楚，我知道我可以通过`.ToList()`在我的调用中添加一个来解决这个问题，`GetNumbers()`这会强制立即评估和存储结果。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-23T16:12:49.050

您的迭代器确实从其初始状态开始。但是，它会修改它正在读取的列表，并且一旦列表被清除，您的迭代器就没有任何事情要做了。基本上，考虑

```
var list = new List<int> { 1, 2, 3 };
var enumerable = list.Where(i => i != 2);
foreach (var item in enumerable)
    Console.WriteLine(item);
list.Clear();
foreach (var item in enumerable)
    Console.WriteLine(item); 
```

`enumerable`不会改变`list.Clear();`，但它给出的结果可以。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-23T16:16:08.843

您的观察可以用这个主要方法的较短版本来重现：

```
void Main() 
{ 
    List<int> foo = new List<int>(){1,2,3}; 
    IEnumerable<int> bar = GetNumbers(foo); 
    Console.WriteLine(foo.Count); // prints 3
    Iterate(bar); 
    Console.WriteLine(foo.Count); // prints 0
    Iterate(bar); 
} 
```

会发生以下情况：

当你打电话`GetNumbers`时，它并没有真正被执行。它只会在您迭代结果时执行。`Console.WriteLine(foo.Count);`您可以通过调用`GetNumbers`和来验证这一点`Iterate`。
在第一次调用时`Iterate`，`GetNumbers`执行并清空 foo。在第二次调用`Iterate`,`GetNumbers`时再次执行，但现在 foo 是空的，所以没有任何东西可以返回。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-23T16:16:42.673

好吧，懒惰的评估是打击你的。您会看到，当您创建`yield return`-style 方法时，它不会在调用时立即执行。但是，一旦您遍历序列，它将立即执行。

因此，这意味着该列表不会在 期间被清除`GetNumbers`，而只会在 期间被清除`Iterate`。事实上，整个函数体`GetNumbers`只会在`Iterate`.

你的问题是你让你`IEnumersble`的 s 不仅依赖于*内部*状态，还依赖于*外部*状态。该外部状态是`foo`列表的内容。

`Iterate`因此，在您第一次之前，所有列表都已填满。（`IEnumerable`created by`GetNumbers`持有对它们的引用，因此您覆盖的事实`foo`并不重要。）在第一个期间，所有三个都被清空`Iterate`。接下来，下一次迭代以相同的内部状态开始，但改变了外部状态，给出不同的结果。

I'd like to notice, that mutation and depending on outer state is generally frowned upon in functional programming style. The LINQ is actually a step toward functional programming, so it's a good idea to follow the FP's rules. So you could do better with just not removing the items from `input` in `GetNumbers`.

# ruby-on-rails-3 - 无法使用 ZSH 创建 Rails 资源

> ID：12095888
> 
> 赞同：0
> 
> 时间：2012-08-23T16:09:37.060
> 
> 标签：ruby-on-rails-3, zsh

我正在尝试在 Rails 应用程序中创建以下资源

```
resources :sessions, only: [:new, :create, :destroy] 
```

但是，当我运行此命令时，出现以下错误

```
zsh: bad pattern: [:new, 
```

什么可能导致此错误？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T16:14:24.213

那不是命令，那是`routes.rb`文件中的条目。

编辑文件而不是尝试从命令行运行它；没有更多的命令行错误。

# avr-gcc - 无法在 avr-gcc 中使用自身更改变量？

> ID：12095890
> 
> 赞同：1
> 
> 时间：2012-08-23T16:09:44.330
> 
> 标签：avr-gcc, winavr

我对微控制器的一些 C 代码有疑问。这似乎是语言或编译器问题，但程序编译得很好。然而，当在微控制器上运行时，问题就显现出来了。

（这是针对 Atmel AVR AtTiny26 的。）

我正在从模数转换器读取一个值并将其乘以 10：

```
int SD;
SD = ADCH * 10; 
```

这不能正常工作。我认为在计算中尝试从 ADC 读取是问题所在，所以我尝试了：

```
int SD;
SD = ADCH;
SD = SD * 10; 
```

这也不起作用，导致微观不稳定。（只要模拟值低，它就可以工作，但是一旦达到某个值，就永远不会再次从 ADC 获得值，直到复位。）

这似乎有效：

```
int SD;
int TEMP;
TEMP = ADCH;
SD = TEMP * 10; 
```

引入另一个变量可以解决问题，但似乎令人困惑。这是怎么回事？

关于 EE 的相关问题：[https ://electronics.stackexchange.com/q/38404/2028](https://electronics.stackexchange.com/q/38404/2028)

**编辑：**

这可能与编译优化有关。当我在编译时在命令行上指定 -Os 与 -O2 或 -O3 时，会得到不同的结果。优化能否改变这种变量分配的工作方式？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-23T22:44:18.450

您必须声明`SD`为`volatile`：

```
volatile int SD; 
```

这意味着寄存器的值可能会被硬件改变（不受编译器控制）。在您的情况下， 的值`ADCH`可能会被硬件更改，因此，通过设置`SD`as `volatile`，您将强制编译器在使用它之前再次读取（更新）它。

# ios5 - 使用 weinre 调试一个 Cordova iOS 应用程序

> ID：12095896
> 
> 赞同：1
> 
> 时间：2012-08-23T16:09:59.663
> 
> 标签：ios5, cordova-2.0.0, weinre

我正在寻找一种方法来调试在 iOS 上运行的科尔多瓦应用程序。weinre 是否可以使用已编译的应用程序？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T16:37:11.120

温热会工作。我个人不太喜欢它。它一直在做 ajax 调用，使性能变差。这个想法本身很棒。

Xcode 4.3 - 使用 iWebInspector：[http](http://www.iwebinspector.com/) ://www.iwebinspector.com/ - 你需要安装其他铬版本。

或者获取 Xcode 4.5 - 它有一个集成的远程调试器。警告 - 您不能使用 Xcode 4.5 编译应用商店。

# python - ImportError：无法导入设置“wequest.settings”（它在 sys.path 上吗？）：没有名为 wequest.settings 的模块

> ID：12095897
> 
> 赞同：0
> 
> 时间：2012-08-23T16:10:03.620
> 
> 标签：python, django

我是 python/django 的新手。我正在按照教程制作一个测试 virtualenv 来测试 tinymce 设置。我错误地更改了 DJANGO_SETTINGS_MODULE 设置。我检查了 sys.path，确保设置了 DJANGO_SETTINGS_MODULE 的路径。但是，这个“wequest”的设置项目名称并不是当前项目的名称。我将所有文件复制到一个名为 wequest1 的新虚拟环境中。在我研究的所有地方，我确保将 DJANGO_SETTINGS_MODULE 设置为 mysite.settings。

```
>>> import sys
>>> import os
>>> os.environ['DJANGO_SETTINGS_MODULE']
'mysite.settings'
>>> 
```

给出我的“wequest”而不是“wequest1”的 mysite 变量集在哪里。任何其他帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T17:34:27.840

1.  **删除所有 .pyc 文件**：`find /path/to/project -name '*pyc' -delete`

2.  **搜索仍然引用 wequest 的文件**：`grep -r wequest /path/to/project`

3.  **修复这些文件**B)

# python - Python - 识别/处理图像

> ID：12095898
> 
> 赞同：0
> 
> 时间：2012-08-23T16:10:07.250
> 
> 标签：python, image-processing, detection, image

我正在研究如何使用 Python 处理和处理图像。我正在尝试在图像内部搜索特定图片。例如，这张图片中有两张相同的图片；

![在此处输入图像描述](../Images/29b16a953918df890fce69b4a5db7be8.png)

在 Python 中，我将如何检测哪两个图像是相同的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T16:20:52.140

如果您想自己实现简单（或复杂）算法，我建议您查看[OpenCV](http://opencv.willowgarage.com/wiki/)和[PIL 。](http://www.pythonware.com/products/pil/)此外，您可以将 OpenCV 与 PIL 以及[numpy](http://numpy.scipy.org/)集成，这使其成为此类工作的真正强大工具。

# c# - 如何在自定义用户控件（.Net 4，Winforms）上使用项目集合编辑器？

> ID：12095899
> 
> 赞同：3
> 
> 时间：2012-08-23T16:10:07.093
> 
> 标签：c#, .net, vb.net, winforms, visual-studio-2010

我创建了一个`UserControl`包含自定义的`ToolStrip Control`. 在`UserControl`整个应用程序中使用时，`ToolStrip`不能直接访问该控件，因为它在逻辑上嵌入在`UserControl`.

因此，为了访问我在返回 ToolStrip 的项目的类中`ToolStrip`定义了一个`readonly`属性。`UserControl`

现在，`ToolStrip`可以通过使用该`UserControl.Items`属性以编程方式编辑项目，但在设计模式下我不能这样做。

`UserControl`就像有人从表单拖到`ToolBox`表单，转到`propertyGrid`，选择项目的属性并相应地操作根深蒂固的项目`ToolStrip`；就像我们`ToolStrip`在 Items 的帮助下处理任何标准控件的项目集合一样`Collection Editor`。

这里，虽然显示的`Items`属性`UserControl`在 中`propertyGrid`，但不能使用，每次点击都会显示错误信息

> 值不能为空。参数名称：值

我确定这是因为该属性被声明为只读，并且我需要更多地增加，以便当在 propertyGrid 中单击它时，项目会`Collection Editor`弹出`ToolStrip`并因此可以处理的项目。

那么我应该怎么做呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T16:15:12.653

您可以通过暴露`ToolStrip`自身来做到这一点，但这不是一个好主意。A`UserControl`不应公开其内部控制。

如果您的用户控件只有一个`ToolStrip`，您应该考虑使用一个`CustomControl`继承的类，`ToolStrip`并且您可以免费获得它的所有功能，包括设计功能。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-15T15:49:20.460

我一直在研究这个问题，我得到的两个最广泛持有的想法是：1）将 ToolStrip 作为属性公开。2) 为 UserControl 使用 ControlDesigner 并为 ToolStrip 设置 EnableDesignMode。

但不知何故，它们都没有真正达到我的目的，因为暴露 ToolStrip 会让用户完全控制它，这不是我的目标。第二个选项甚至会让用户删除 ToolStrip。因此，我不得不想出一种不同的方法。那是我绊倒 CollectionBase 类的时候。

正如它所说，CollectionBase 类是强类型集合的抽象基类。那么如何通过它来维护 ToolStrip 项集合呢？我创建了一个CollectionBase类的实例，并通过它来规范ToolStrip项的添加、修改、获取和删除。集合中的每个项目都来自从 ToolStripButton 类继承的类。这样，单个项目可以作为任何标准 ToolStripButton 处理，您可以相应地向用户隐藏或显示属性。最后，有问题的 ToolStrip 被设置为 CollectionBase 的父级，最终也成为每个 ToolStripItem 的父级。这是概念：

```
Imports System.ComponentModel
Imports System.Windows.Forms
Imports Office2003
Imports System.Drawing
Imports System.Windows.Forms.Design

Public Class MyUserControl
    Private _Buttons As MyUserControlButtons
    Public Event MyUserControlButtonClicked(ByVal Sender As MyUserControlButton)

    Public Sub New()
        MyBase.New()

        'This call is required by the Component Designer.
        InitializeComponent()

        _Buttons = New MyUserControlButtons(MyToolStrip)
    End Sub

    <DesignerSerializationVisibility(DesignerSerializationVisibility.Content)> _
    Public ReadOnly Property Buttons As MyUserControlButtons
        Get
            Return _Buttons
        End Get
    End Property

    Private Sub MyToolStrip_ItemClicked(ByVal sender As System.Object, ByVal e As System.Windows.Forms.ToolStripItemClickedEventArgs) Handles MyToolStrip.ItemClicked
     'Check if the ToolStrip item clicked is a ToolStripButton...
        If TypeOf e.ClickedItem Is ToolStripButton Then
            'Insert your code here...

         'Raise the custom event.
            RaiseEvent MyUserControlButtonClicked(Item)
        End If
    End Sub
End Class

#Region "Manager classes for MyUserControl buttons."

Public Class MyUserControlButtons
    Inherits CollectionBase
    Private _Parent As ToolStrip

    ''' <summary>
    ''' Initializes a new instance of the MyUserControlButtons class.
    ''' </summary>
    ''' <param name="Holder">The ToolStrip that contains the items of the MyUserControlButtons class.</param>
    Public Sub New(ByVal Holder As ToolStrip)
        MyBase.New()
        _Parent = Holder
    End Sub

    ''' <summary>
    ''' The ToolStrip that contains this item.
    ''' </summary>
    Public ReadOnly Property Parent() As ToolStrip
        Get
            Return _Parent
        End Get
    End Property

    ''' <summary>
    ''' Gets the element at the specified index.
    ''' </summary>
    ''' <param name="Index">The zero-based index of the element to get.</param>
    Default Public ReadOnly Property Item(ByVal Index As Integer) As MyUserControlButton
        Get
            Return CType(List(Index), MyUserControlButton)
        End Get
    End Property

    ''' <summary>
    ''' Adds an item to the collection.
    ''' </summary>
    Public Function Add() As MyUserControlButton
        Return Me.Add
    End Function

    ''' <summary>
    ''' Adds an item to the collection.
    ''' </summary>
    ''' <param name="Value">The object to add to the collection.</param>
    Public Sub Add(ByVal Value As MyUserControlButton)
        List.Add(Value)
        Value.Parent = Me.Parent
    End Sub

    ''' <summary>
    ''' Adds an item to the collection.
    ''' </summary>
    ''' <param name="Name">The name of the object to add to the collection.</param>
    ''' <param name="Image">The image of the object to add to the collection.</param>
    Public Function Add(ByVal Name As String, ByVal Image As Image) As MyUserControlButton
        Dim b As MyUserControlButton = New MyUserControlButton(Me.Parent)
        b.Name = Name
        b.Text = Name
        b.Image = Image
        Me.Add(b)
        Return b
    End Function

    ''' <summary>
    ''' Adds an item to the collection.
    ''' </summary>
    ''' <param name="Name">The name of the object to add to the collection.</param>
    ''' <param name="Text">The text of the object to add to the collection.</param>
    ''' <param name="Image">The image of the object to add to the collection.</param>
    Public Function Add(ByVal Name As String, ByVal Text As String, ByVal Image As Image) As MyUserControlButton
        Dim b As MyUserControlButton = New MyUserControlButton(Me.Parent)
        b.Name = Name
        b.Text = Text
        b.Image = Image
        Me.Add(b)
        Return b
    End Function

    ''' <summary>
    ''' Removes the first occurence of a specific object from the collection.
    ''' </summary>
    ''' <param name="Value">The object to be removed.</param>
    Public Sub Remove(ByVal Value As MyUserControlButton)
        List.Remove(Value)
    End Sub

    ''' <summary>
    ''' Determines the index of a specific item in the collection.
    ''' </summary>
    ''' <param name="Value">The object to locate in the collection.</param>
    Public Function IndexOf(ByVal Value As Object) As Integer
        Return List.IndexOf(Value)
    End Function

    ''' <summary>
    ''' Determines whether the collection contains a specific value.
    ''' </summary>
    ''' <param name="Value">The object to locate in the collection.</param>
    Public Function Contains(ByVal Value As MyUserControlButton) As Boolean
        Return List.Contains(Value)
    End Function

    Protected Overrides Sub OnInsertComplete(ByVal index As Integer, ByVal value As Object)
        Dim b As MyUserControlButton = CType(value, MyUserControlButton)
        b.Parent = Me.Parent
        Me.Parent.Items.Insert(index, CType(value, ToolStripButton))
        MyBase.OnInsertComplete(index, value)
    End Sub

    Protected Overrides Sub OnSetComplete(ByVal index As Integer, ByVal oldValue As Object, ByVal newValue As Object)
        Dim b As MyUserControlButton = CType(newValue, MyUserControlButton)
        b.Parent = Me.Parent
        MyBase.OnSetComplete(index, oldValue, newValue)
    End Sub

    Protected Overrides Sub OnClearComplete()
        MyBase.OnClearComplete()
    End Sub
End Class

Public Class MyUserControlButton
    Inherits ToolStripButton

    ''' <summary>
    ''' Initializes a new instance of the MyUserControlButton class.
    ''' </summary>
    Sub New()
        MyBase.New()
        Init()
    End Sub

    ''' <summary>
    ''' Initializes a new instance of the MyUserControlButton class.
    ''' </summary>
    ''' <param name="Holder">The ToolStrip that contains the StackView button.</param>
    Sub New(ByVal Holder As ToolStrip)
        MyBase.New()
        Init()
        Me.Parent = Holder
    End Sub

    Private Sub Init()
        Me.AutoToolTip = False
        Me.DisplayStyle = ToolStripItemDisplayStyle.ImageAndText
        Me.ImageAlign = ContentAlignment.MiddleLeft
        Me.ImageIndex = -1
        Me.ImageKey = ""
        Me.ImageTransparentColor = Color.Magenta
        Me.TextAlign = ContentAlignment.MiddleLeft
        Me.TextDirection = ToolStripTextDirection.Horizontal
    End Sub

    ''' <remarks>
    ''' Hide this property from the user in both design and code editor.
    ''' </remarks>
    <Browsable(False),
    EditorBrowsable(False)> _
    Public Shadows Property AccessibleDefaultActionDescription As String
        Get
            Return MyBase.AccessibleDefaultActionDescription
        End Get
        Set(ByVal value As String)
            MyBase.AccessibleDefaultActionDescription = value
        End Set
    End Property

    ''' <remarks>
    ''' Hide this property from the user in both design and code editor.
    ''' </remarks>
    <Browsable(False),
    EditorBrowsable(False)> _
    Public Shadows Property AccessibleDescription As String
        Get
            Return MyBase.AccessibleDescription
        End Get
        Set(ByVal value As String)
            MyBase.AccessibleDescription = value
        End Set
    End Property

    ''' <remarks>
    ''' Hide this property from the user in both design and code editor.
    ''' </remarks>
    <Browsable(False),
    EditorBrowsable(False)> _
    Public Shadows Property AccessibleName As String
        Get
            Return MyBase.AccessibleName
        End Get
        Set(ByVal value As String)
            MyBase.AccessibleName = value
        End Set
    End Property

    ' Keep on hiding the irrelevant properties...

    ''' <summary>
    ''' Gets or sets a value indicating whether default or custom ToolTip text is displayed on the ToolStripButton.
    ''' </summary>
    <DefaultValue(False)> _
    Public Shadows Property AutoToolTip As Boolean
        Get
            Return MyBase.AutoToolTip
        End Get
        Set(ByVal value As Boolean)
            MyBase.AutoToolTip = value
        End Set
    End Property

    ''' <summary>
    ''' Specifies whether the image and text are rendered.
    ''' </summary>
    <DefaultValue(GetType(ToolStripItemDisplayStyle), "ImageAndText")> _
    Public Overrides Property DisplayStyle As System.Windows.Forms.ToolStripItemDisplayStyle
        Get
            Return MyBase.DisplayStyle
        End Get
        Set(ByVal value As System.Windows.Forms.ToolStripItemDisplayStyle)
            MyBase.DisplayStyle = value
        End Set
    End Property

    ''' <summary>
    ''' The image that will be displayed on the control.
    ''' </summary>
    Public Overrides Property Image() As Image
        Get
            Return MyBase.Image
        End Get
        Set(ByVal value As Image)
            MyBase.Image = value
        End Set
    End Property

    ''' <summary>
    ''' Gets or sets the alignment of the image on a ToolStripItem.
    ''' </summary>
    <DefaultValue(GetType(ContentAlignment), "MiddleLeft")> _
    Public Shadows Property ImageAlign As ContentAlignment
        Get
            Return MyBase.ImageAlign
        End Get
        Set(ByVal value As ContentAlignment)
            MyBase.ImageAlign = value
        End Set
    End Property

    <EditorBrowsable(False),
    DefaultValue(-1)> _
    Public Shadows Property ImageIndex As Integer
        Get
            Return MyBase.ImageIndex
        End Get
        Set(ByVal value As Integer)
            MyBase.ImageIndex = value
        End Set
    End Property

    <EditorBrowsable(False),
    DefaultValue("")> _
    Public Shadows Property ImageKey As String
        Get
            Return MyBase.ImageKey
        End Get
        Set(ByVal value As String)
            MyBase.ImageKey = value
        End Set
    End Property

    ''' <summary>
    ''' Gets or sets the color to treat as transparent in a ToolStripItem image.
    ''' </summary>
    Public Shadows Property ImageTransparentColor As Color
        Get
            Return MyBase.ImageTransparentColor
        End Get
        Set(ByVal value As Color)
            MyBase.ImageTransparentColor = value
        End Set
    End Property

    ''' <summary>
    ''' Specifies the name used to identify the object.
    ''' </summary>
    Public Shadows Property Name() As String
        Get
            Return MyBase.Name
        End Get
        Set(ByVal value As String)
            MyBase.Name = value
        End Set
    End Property

    ''' <summary>
    ''' The ToolStrip that contains this item.
    ''' </summary>
    <Browsable(False)> _
    Public Shadows Property Parent As ToolStrip
        Get
            Return MyBase.Parent
        End Get
        Set(ByVal value As ToolStrip)
            MyBase.Parent = value
        End Set
    End Property

    ''' <summary>
    ''' The text that will be displayed on the control.
    ''' </summary>
    Public Overrides Property Text() As String
        Get
            Return MyBase.Text
        End Get
        Set(ByVal value As String)
            MyBase.Text = value
        End Set
    End Property

    ''' <summary>
    ''' Gets or sets the alignment of the text on a ToolStripLabel.
    ''' </summary>
    <DefaultValue(GetType(ContentAlignment), "MiddleLeft")> _
    Public Overrides Property TextAlign As ContentAlignment
        Get
            Return MyBase.TextAlign
        End Get
        Set(ByVal value As ContentAlignment)
            MyBase.TextAlign = value
        End Set
    End Property

    <Browsable(False),
    EditorBrowsable(False),
    DefaultValue(GetType(ToolStripTextDirection), "Horizontal")> _
    Public Overrides Property TextDirection As ToolStripTextDirection
        Get
            Return MyBase.TextDirection
        End Get
        Set(ByVal value As ToolStripTextDirection)
            MyBase.TextDirection = value
        End Set
    End Property

    ' Define other properties accordingly...
End Class

#End Region 
```

MyUserControl 是包含名为 MyToolStrip 的 ToolStrip 的自定义用户控件。MyUserControlButtons 是继承自 CollectionBase 的类，而 MyUserControlButtons 的每一项都是继承自 ToolStripButton 的 MyUserControlButton 类的对象。

在 MyUserControl 的构造函数中，MyUserControlButtons 以 MyToolStrip 作为其父对象进行实例化。通过从 MyUserControlButton 创建新对象，将项目添加到 MyUserControlButtons。要隐藏或显示的项目的属性在 MyUserControlButton 中进行管理。MyUserControl 通过只读属性“Buttons”返回按钮列表。请注意“Buttons”属性的 DesignerSerializationVisibility 属性。它指定在设计时序列化组件上的属性时要使用的持久性类型。“内容”枚举成员告诉代码生成器为对象的内容生成代码，而不是为对象本身生成代码。

这种方法的缺点是在 UserControl 上执行复制粘贴时无法保留 ToolStrip 的项目。它仅在用户明确处理项目而不是在复制粘贴期间对内容进行序列化。任何关于如何处理它的想法都受到高度赞赏。

感谢所有的海报。尽管我应用了自己的概念，但您的想法为我铺平了道路。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-01-24T09:53:54.407

我有一个解决方案，但对于 c#

```
 [Editor("System.ComponentModel.Design.CollectionEditor, System.Design", typeof(UITypeEditor))]
    [MergableProperty(false)]
    [Category("Data")]
    [DescriptionAttribute("ToolStripItems")]
    public virtual ToolStripItemCollection ToolstripItems
    {
        get => toolStrip.Items;
    } 
```

# xcode - 使用 sed 查找和替换搜索 xCode 中的所有文件

> ID：12095904
> 
> 赞同：1
> 
> 时间：2012-08-23T16:10:13.677
> 
> 标签：xcode, bash, replace, sed, find

我有一些我经常放入 Xcode 的文件，这些文件是在另一个程序中制作的，我需要在其中替换一个字符串。我只是希望它作为脚本成为构建阶段的一部分。我尝试将 find 与 sed 一起使用

```
find . -type f -exec sed -i 's/onclick="js(setPanoName(/onloaded="js(setPanoName(/g' {} \; 
```

没有效果。我知道它真的很近。怎么了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T17:09:46.393

我将命令更改为

```
sed -i '' 's/onclick="js(setPanoName(/onloaded="js(setPanoName(/g' *.xml; 
```

它现在有效。

# wpf - WinForms MDI 中托管的 TextBox 上的 WPF TwoWay 数据绑定问题

> ID：12095906
> 
> 赞同：0
> 
> 时间：2012-08-23T16:10:30.553
> 
> 标签：wpf, winforms, data-binding, focus, mdi

我最近刚刚发现了一个问题的根源，该问题发生在我一直在处理的应用程序中，该应用程序使用传统的 WinForms MDI 和每个表单的 ElementHosts 中托管的 WPF UserControls。问题是，如果用户更改了 TextBox 中的文本，该 TextBox 被 TwoWay 绑定到 ViewModel 属性，则在单击工具栏中的“保存”按钮时，该属性上的设置器未设置。此行为的结果是未保存最后设置的文本设置。

我正在使用 LostFocus 的默认 UpdateSourceTrigger 值，所以我相信当我单击工具栏中的基于 WinForms 的保存按钮时，WPF TextBox 元素没有失去焦点。所以现在我理解了这个问题，我很好奇解决这个问题的正确或最佳方法是什么。

我能想到的两个主要选项要么需要手动提示更新设置器而不会导致控件失去焦点，要么只是让 TextBox 失去焦点，以便进行正常的源更新。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T21:51:22.330

您可以将 UpdateSourceTrigger 更改为 PropertyChanged，然后“保存”按钮将很好地工作。

我认为你的推理是正确的。WPF 和 Winforms 都有单独的“Focusmanagers”，所以如果你从 WPF TextBox 转到 winforms 按钮，那么焦点无处可去。

# windows - Windows 上的持久、预分叉（阻塞）Perl Web 服务

> ID：12095910
> 
> 赞同：2
> 
> 时间：2012-08-23T16:10:49.400
> 
> 标签：windows, perl, fastcgi, psgi

我想以合理的速度/容量在 Windows（假设 2008 R2 x64）上运行 Perl Web 应用程序。

目前我的应用程序基于 Mojolicious，使用 Strawberry Perl 并通过 Apache 2.2-win32 作为 CGI 运行。大约 20000 行代码，perl 进程的创建需要很多时间，几乎一两秒，而实际处理只是一眨眼的时间。如果应用程序配置为快速 CGI 或持久样式，我会想象它运行得更快并且能够提供更多请求/秒。

如果我在 Linux 上，我可能会坚持使用 PSGI/Plack/Starman 和 Nginx 反向代理。不幸的是，Starman/Starlet 不支持 Win32。

Morbo/Twiggy 不能满足我的需要，因为 webapp 确实会阻塞（数据库调用），并且对于某些请求，它确实需要一段时间才能完成。

所以我现在正在寻找快速 CGI 解决方案。不幸的是 Apache 和 mod_fcgid 不适用于 Perl ( [Stackoverflow](https://stackoverflow.com/questions/4382661/perl-script-are-not-running-on-apache-2-2-15-with-mod-fcgid-win32) )。而且我还能够找到或制定与 mod_fastcgi 与 2.4 兼容的二进制文件。我还没有尝试过的是 mod_fastcgi + Apache 2.2，但我希望我可以继续使用 Apache 2.4。

我也在考虑是否可以运行我自己的 FCGI 进程管理器（管理预分叉的东西），连同 Mojo::Server::FastCGI，并使用 mod_proxy_fcgi 来代替做反向代理。Perl 模块 FCGI::ProcManager 也不支持 Win32。可能有任何其他流程管理器，可能在 C# 中？（最好在 C# 中进行进一步的黑客攻击）

让我总结一下这个问题 -

*   在 Windows 上以比 CGI 快得多的速度运行 Perl Web 应用程序的最佳方式是什么，但不是以非阻塞方式。
*   并且可能会导致一个问题 - 如何使 mod_fcgid 与 Perl 一起工作？或者那里有任何 fcgi 进程管理器吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T17:46:24.260

你可以使用 Mojolicious + mod_psgi + apache。

这里有预编译的二进制文件，但对于 Apache 2.2：

[http://strawberryperl.com/package/kmx/mod_psgi/](http://strawberryperl.com/package/kmx/mod_psgi/)

——迈克

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-16T13:39:21.343

您可以使用线程化的 Plack 服务器[Thrall](http://blogs.perl.org/users/piotr_roszatycki/2013/07/plack-server-with-threads-1.html)。

# asp.net-mvc - 将剔除对象数组传递给 mvc 控制器操作

> ID：12095914
> 
> 赞同：2
> 
> 时间：2012-08-23T16:11:08.343
> 
> 标签：asp.net-mvc, knockout.js, viewmodel

伙计们，谁能帮助我或指导我看一个淘汰视图模型的示例，其中包含传递给 asp.net mvc 动作的对象数组？我见过的唯一示例显示了正在传递的简单字符串数组。谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T16:18:11.377

[这是来自官方淘汰赛网站的示例](http://knockoutjs.com/examples/contactsEditor.html)。这是一个使用嵌套数组构建的联系人编辑器。[[jsFiddle]](http://jsfiddle.net/rniemeyer/gZC5k/)。

一个合适的 ASP.NET MVC Action 可能看起来像

```
public ActionResult SaveContacts(IEnumerable<Contact> contacts) 
```

其中 Contact 被定义为类：

```
public class Contact
{
    public string firstName { get; set; }
    public string lastName { get; set; }
    public IEnumerable<Number> phones { get; set; }
} 
```

其中 Number 被定义为类：

```
public class Number
{
    public string type { get; set; }
    public string number { get; set; }
} 
```

给定[示例](http://knockoutjs.com/examples/contactsEditor.html)中的 JavaScript Knockout 视图模型。你的`save`方法可能看起来像这样

```
self.save = function() {
    var jsonString = ko.mapping.toJSON(this.searchParams);
    $.ajax({
        url: "/MyController/SaveContacts",
        data: jsonString,
        type: 'POST',
        contentType: 'application/json',
        dataType: 'json'
    });
}; 
```

# javascript - 在nodejs中需要

> ID：12095915
> 
> 赞同：6
> 
> 时间：2012-08-23T16:11:11.480
> 
> 标签：javascript, node.js

`require(...)`node.js 中的参数是文件名。如果我**在字符串中有一个模块源代码** `code`，我可以以某种方式从该字符串调用`require(code)`和加载函数吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-13T11:16:10.650

我把它放到一个函数中以供重用。它基于随机哈希在 os temp 目录中创建一个文件，需要它，然后将其删除。

```
var fs     = require('fs'),
    os     = require('os'),
    crypto = require('crypto');

function requireString(moduleString) {
  var token           = crypto.randomBytes(20).toString('hex'),
      filename        = os.tmpdir() + '/' + token + '.js',
      requiredModule  = false;

  // write, require, delete
  fs.writeFileSync(filename, moduleString);
  requiredModule = require(filename);
  fs.unlinkSync(filename);

  return requiredModule;
} 
```

然后你可以这样做：

```
var carString = "exports.start = function(){ console.log('start'); };",
    car       = requireString(carString);

console.log("Car:", car); 
```

我认为这仍然是一种解决方法，但使用起来更方便。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T16:21:36.057

解决方法可能是将模块源代码写入临时文件`./tmp-file.js`，`require('./tmp-file')`然后删除该文件。

这可能不是最优的，因为您要么必须同步阻塞和写入文件，要么将需要该模块的所有内容放在异步写入的回调中。

异步文件写入的工作示例（[要点 - 还包括同步文件写入](https://gist.github.com/3438596)）：

```
var http = require('http');
var fs = require('fs');

var helloModuleString = "exports.world = function() { return 'Hello World\\n'; }";
fs.writeFile('./hello.js', helloModuleString, function (err) {
  if (err) return console.log(err);
  var hello = require('./hello');

  http.createServer(function (req, res) {
    res.writeHead(200, {'Content-Type': 'text/plain'});
    res.end(hello.world());
  }).listen(1337, '127.0.0.1');

  console.log('Server running at http://127.0.0.1:1337/');
}); 
```

结果是：

```
$ curl 127.0.0.1:1337
> Hello World 
```

# perforce - Perforce 变更列表 - 它是强制性的吗？

> ID：12095917
> 
> 赞同：1
> 
> 时间：2012-08-23T16:11:20.730
> 
> 标签：perforce

我试图了解在签出文件时是否必须使用更改列表？

我正在考虑使用 Perforce（还没有尝试过）。我的问题是指它的方法论。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-23T16:29:23.810

如果您没有专门为它选择另一个更改列表，则会有一个默认的更改列表，但它有一些限制，例如无法搁置文件。如果您在更改上花费大量时间，那么立即创建带有最终提交消息的编号更改列表通常非常有用。将您不打算提交的临时更改放入他们自己的更改列表中也很方便。这与人们在 DVCS 中使用多个本地分支的方式类似。

# google-chrome - 是否可以注入一个覆盖 DOM 中存在的 JavaScript 代码？（例如默认警报功能）

> ID：12095924
> 
> 赞同：7
> 
> 时间：2012-08-23T16:11:40.733
> 
> 标签：google-chrome, google-chrome-extension

好的，所以我想要的是覆盖选项卡中已经存在的方法，我要使用的是默认警报功能。在 JS 函数中覆盖它会很容易。只需添加

```
window.alert = function(){ 
   //Do Something
} 
```

但问题是当我尝试使用`chrome.tabs.executeScript("window.alert = function() { };");`它时它不起作用。我尝试通过在我想要覆盖该功能的选项卡中使用 Chrome 中的控制台手动执行此操作，我在日志中键入了该覆盖功能并按 Enter，然后完成，警报功能被覆盖，但我做不到这通过 Chrome 扩展程序。

当您添加 executeScript 时，它似乎创建了一个与选项卡 DOM 中的 JavaScript 不同的 Javascript，因为我可以使用选项卡 DOM 中已经存在的函数的名称创建函数。

有没有办法让 executeScript 在选项卡 DOM 中编写脚本，所以它实际上可以覆盖由页面生成的 .js 文件编写的任何函数？

谢谢！

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-08-23T16:22:40.073

函数不作为 DOM 的一部分存在；相反，它们存在于包含 DOM的*执行环境中。*内容脚本（包括使用 运行的脚本[`executeScript`](http://developer.chrome.com/extensions/tabs.html#method-executeScript)）和实际网页共享相同的 DOM，但具有[不同的执行环境](https://developer.chrome.com/docs/extensions/mv3/content_scripts/#host-page-communication)。所以调用`window.alert = function() {}`只在内容脚本的执行环境中重写`window.alert`，而不是在实际页面的执行环境中。

到达实际页面的执行环境的典型方法是将`<script>`标签注入 DOM。这可以通过[多种方式](https://stackoverflow.com/a/9517879)完成。一种方法是将 中的脚本列入白名单[`web_accessible_resource`](http://developer.chrome.com/extensions/manifest.html#web_accessible_resources)，并在文档中插入`<script>`引用该脚本的元素。所需的绝对 URL 可以通过[`chrome.extension.getURL`](http://developer.chrome.com/extensions/extension.html#method-getURL).

```
var s = document.createElement("script");
s.src = chrome.extension.getURL("script_in_extension.js");
(document.head||document.documentElement).appendChild(s); 
```

确保将脚本配置为[`"run_at": "document_start"`](http://developer.chrome.com/extensions/content_scripts.html)，以便在加载任何页面功能之前进行覆盖。

注意：您的操作可以通过页面轻松撤消：

```
window.alert = function(){ /*...*/ }; // Your overwrite
delete window.alert;                  // Run from the page/console/...
window.alert('Test?');                // Displays alert box. 
```

如果无法删除被覆盖的函数至关重要，请使用[`Object.defineProperty`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Object/defineProperty)定义不可变方法。有关更多详细信息，请参阅[使用 Chrome 扩展程序停止执行函数](https://stackoverflow.com/questions/9347733/stop-a-function-from-execute-with-chrome-extension/9348685#9348685)。

# html - 如何使 HTML 文件编辑服务器上的文件？

> ID：12095927
> 
> 赞同：1
> 
> 时间：2012-08-23T16:11:51.670
> 
> 标签：html, edit

我想制作一个文件来监控我的网页的页面视图，为此我需要让我的网页能够编辑这个文件。我不太擅长 JavaScript 或 PHP，所以如果可能的话，我不确定如何做到这一点。谢谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T16:18:29.190

好吧，解决您的问题的最简单方法是使用[Google Analytics](http://www.google.com/analytics/)。如果您不想这样做，那么第二个最简单的方法是使用 PHP。

就像是：

```
 <?php 
 $file = "vistors.txt"; 

 $handle = fopen($file, 'r+') ; 

 $data = fread($handle, 512) ; 

 $count = $data + 1;
 print "You are visitor ".$count; 
 ?> 
```

就在你的 php 文件的顶部就可以完成这项工作。这不是很好，尽管它会导致每次页面加载时都进行读写，即使对于 Googlebot 或其他类似的东西也是如此。

页面的其余部分也必须等待这种情况发生，所以如果需要一段时间，页面就会变慢。

我编写了自己的分析，它使用 AJAX（因为它是异步的）将数据插入 MYSQL 数据库。这有更多的功能。

大多数人只是使用谷歌分析，因为它提供了大量的功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T16:19:37.117

HTML文件不能修改任何东西，期间，因为它们不是可执行文件或脚本，它们不能做任何事情，事情是对它们完成的。要执行类似的操作，您需要一个脚本或程序，可以想到 PHP、JavaScript 和 ASP.NET。从理论上讲，您可以为您的 HTTP 服务器编写一个 mod 来跟踪页面请求，但这太复杂了。根据您需要统计信息的目的，您可以使用[访问计数器或](https://www.google.ru/search?rls=en&q=page%20visit%20counter)[Google Analytics](http://www.google.com/analytics/)等网络分析工具。

# c# - FormView ItemUpdating with Checkbox

> ID：12095931
> 
> 赞同：0
> 
> 时间：2012-08-23T16:12:10.507
> 
> 标签：c#, asp.net, .net

我在 ItemUpdating 事件上绑定了 Checkbox 和 FormView，并带有 Update 按钮。我还有其他字段可以保存，只有复选框不会将 True 或 False 保存到数据库中。我怎样才能让它保存呢？

# azure - 如何在 RegisterServices 方法中读取 Azure 网站应用程序设置

> ID：12095932
> 
> 赞同：0
> 
> 时间：2012-08-23T16:12:13.993
> 
> 标签：azure, ninject, ninject.web.mvc, azure-web-app-service

我正在尝试使用Windows Azure 预览门户上的 应用*程序设置部分为我的 Azure Web 应用程序配置一些键/值对。*![在此处输入图像描述](../Images/326133e620afc9a35c0bdee75cafb266.png)

根据[文档](https://www.windowsazure.com/en-us/manage/services/web-sites/how-to-configure-websites)，Azure 应该在运行时将配置的键/值对注入到 .Net 配置 AppSettings 中。

有谁知道，如何`RegisterServices`在类的方法中读取这些值`NinjectWebCommon`？我尝试了一种常见的方式

```
ConfigurationManager.AppSettings["MyWebApp.DbConnectionString"]; 
```

但它返回空值或空值。稍后在我的 Web 应用程序中读取应用程序设置工作正常。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T05:57:03.860

I do not know how exactly this works but the `RegisterServices` method is probably called earlier than Azure injects app settings into configuration. Fortunately, there is an alternative way to install Ninject for MVC3 that works (see [Using Binaries from Github](https://github.com/ninject/ninject.web.mvc/wiki/Setting-up-an-MVC3-application)).

# visual-studio-2010 - 如何在 VS2010 SL5 上进入调试模式时避免出现“无可用源”窗口

> ID：12095934
> 
> 赞同：11
> 
> 时间：2012-08-23T16:12:18.610
> 
> 标签：visual-studio-2010, debugging

如何在 VS2010 SL5 上进入调试模式时避免出现“无可用源”窗口 ![在此处输入图像描述](../Images/fdc7adf1daea3e450d8b10aa189e989a.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T16:16:22.697

在工具、选项、调试、常规页面中。检查是否启用了“启用 .NET Framework 源步进”，如果启用，请禁用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-12-07T19:58:58.973

我尝试了所有建议的修复；没有什么对我有用。经过几个小时的反复试验，我终于找到了解决方案。

事实证明，“无可用源”错误是由于 VS 调试器环境中的堆栈溢出造成的。

应该被单步执行的 C/C++ 代码函数（由 VS 调试器）正在使用一个变量，该变量已初始化为大小为几 MB 的堆栈数组。当我用堆分配替换它时，VS 成功地进入了代码。

这对我有用。

请注意，在我的情况下，实际代码（带有堆栈分配）在调试器中运行时没有堆栈溢出错误（如果我跳过 No source available 错误）。只是由于内部堆栈溢出，VS 的调试器无法进入另一个 C/CPP 文件中的特定函数。

希望这可以帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-23T16:58:47.203

你可以点击`Shift+F11`退出，它会完成它所在的任何不可用的功能并在下一行停止（它也可能不可用，但继续使用`Step Out`直到你得到你想要检查的代码。）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-06-27T14:35:46.403

关于 VS2019，MSDocs 中提供了对该问题的[描述](https://docs.microsoft.com/en-us/visualstudio/debugger/no-source-available?view=vs-2019)。
对于必需的*vcruntime*和*ucrt*源文件，从已卸载的先前 VS 版本导入后可能会出现问题。
要防止 VS 使用旧目录，请找到解决方案属性页并导航到“*调试源文件”*对话框。单击勾选按钮以检查可以删除任何无效条目的条目。vcruntime和*ucrt**源代码应始终存在于目录中，并且“***浏览以查找源代码**”对话框顶部的路径应始终显示正确的路径。
就我而言，由于一个古老的[驱动器错误](https://community.bitsum.com/forum/index.php?topic=8800.0)，它提示输入“D”驱动器而不是“C”驱动器。此外，无法粘贴提供的路径以刷新视图，因此，如果不明智，则必须使用对话框从桌面或等效位置一直导航到所需位置。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-01-28T20:53:42.863

这里有这个问题的扩展：

[http://erwinmayer.com/labs/visual-studio-2010-extension-disable-no-source-available-tab/](http://erwinmayer.com/labs/visual-studio-2010-extension-disable-no-source-available-tab/)

但是根据我自己在找到这篇文章之前的经验（我在页面中但我试图自己修复它而不阅读文章）我已经解决了这个问题，只是通过接受一条确认消息说“选定的源文件与编译的程序集不同。您确定要使用此文件进行调试吗？”。但我不记得我究竟做了什么来得到这个消息。我认为有一个链接标签，我单击“无可用来源”窗口，然后出现确认消息，确认问题消失后。

# c# - wcf回调中的悬空线程

> ID：12095940
> 
> 赞同：1
> 
> 时间：2012-08-23T16:12:50.390
> 
> 标签：c#, .net, multithreading, wcf, callback

我有 wcf 服务，可以在完成某些工作后回调客户端。
我有几个简单的问题。
如果我的客户端崩溃或我在服务完成之前关闭客户端应用程序，那么从客户端传递给它的服务端线程和回调对象会发生什么情况？
在这种情况下，我是否需要有一些安全网才能使服务在这种情况发生后正确处理未来的客户请求？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T16:34:46.923

当您尝试使用客户端创建通道时，您可能会收到 CommunicationException，因为您的客户端的端点不再监听。

只需添加一些异常处理并执行适当的操作。例如，如果您遇到异常，您可以终止线程，尝试再次建立连接等。

# facebook-like - FB.XFBML.parse 循环并给出数千个 javascript 错误

> ID：12095943
> 
> 赞同：10
> 
> 时间：2012-08-23T16:12:59.033
> 
> 标签：facebook-like, xfbml

我在网站 (http://www.thepropaganda.com) 上有许多动态生成的按钮，所以我使用 FB.XFBML.parse 来生成它们。出于某种原因，解析器总是进入循环并根据[FB.SO Question 3577947](http://facebook.stackoverflow.com/questions/3577947/facebook-gives-unsafe-javascript-attempt-to-access-frame-with-url-error-in-chr)反复生成“域和协议必须匹配”错误。所有 facebook 社交插件均已正确创建。

我知道错误是什么，它们并不是真正的问题，除了有成千上万个错误。有趣的是，这在隐身模式中根本不会发生。

我真的很想知道这里发生了什么，因为它是付费客户的实时站点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-29T12:44:05.880

不知道为什么会发生这种情况，但如果它没有以隐身方式发生，我假设它与 cookie/会话变量有关。我会将此添加为评论，但我需要 50 个代表才能做到这一点:(

# semantic-web - 了解使用什么 RDFA 词汇

> ID：12095945
> 
> 赞同：5
> 
> 时间：2012-08-23T16:13:11.397
> 
> 标签：semantic-web, semantic-markup, rdfa

我们如何知道使用 RDFa 来描述数据的词汇表/命名空间？

我看过很多使用 FOAF 词汇的示例，`xmlns:dcterms="http://purl.org/dc/terms/"`或者`xmlns:sioc="http://rdfs.org/sioc/ns#"`有[这个视频](http://www.youtube.com/watch?v=ldl0m-5zLz4)使用 FOAF 词汇。

这一切都非常令人困惑，我不确定这些词汇表是什么意思，或者什么最适合我所描述的数据。我缺少什么技巧吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-08-23T19:44:36.270

有*很多*词汇。当然，您也可以创建自己的（但在检查可能的替代方案之前，您可能不应该这样做）。

例如，您必须寻找满足您特定需求的词汇表

*   通过浏览和搜索[http://lov.okfn.org/dataset/lov/](http://lov.okfn.org/dataset/lov/)（他们收集和索引开放词汇），

*   在 W3C 的[RDFa 核心初始上下文](http://www.w3.org/2011/rdfa-context/rdfa-1.1)（它列出了具有用于 RDFa 的预定义前缀的词汇表），或

*   通过浏览[http://prefix.cc/](http://prefix.cc/)（这是对通常使用的命名空间的查找，但您可能会从中获得概述）。

一段时间后，您会了解大/广泛的：[Schema.org](http://schema.org/)、[Dublin Core](http://en.wikipedia.org/wiki/Dublin_Core)、[FOAF](http://www.foaf-project.org/)、[RSS](http://web.resource.org/rss/1.0/)、[SKOS](http://www.w3.org/2004/02/skos/)、[SIOC](http://en.wikipedia.org/wiki/Semantically-Interlinked_Online_Communities)、[vCard](http://www.w3.org/TR/vcard-rdf/)、[DOAP](http://en.wikipedia.org/wiki/DOAP)、[Open Graph](http://ogp.me/)、[Ontology for Media Resources](http://www.w3.org/TR/mediaont-10/)、[GoodRelations](http://goodrelations-vocabulary.org/)、[DBpedia Ontology](http://wiki.dbpedia.org/Ontology) ……。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-08-23T20:33:05.097

最简单的事情是检查[schema.org](http://schema.org/)是否满足您的需求。Schema.org 得到谷歌和其他主要搜索引擎的支持，而且通常非常棒。

如果它不适合您的需要，则在词汇搜索引擎中输入一些您需要的术语。我的建议是[LOV](http://lov.okfn.org/dataset/lov/search/)。

另一种选择是向社区询问您需要代表的特定领域的最佳词汇表。一个好地方是[answers.semanticweb.com](http://answers.semanticweb.com/)，它类似于 StackOverflow，但有更多的 RDF 专家闲逛。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-08-23T23:28:50.710

自从该视频发布以来，情况发生了很大变化。首先，就像 Richard 所说，您应该检查 schema.org 是否符合您的需求。就我个人而言，当我需要描述 schema.org 未涵盖的内容时，我也会检查 LOV。当且仅当我在 LOV 中找不到任何东西时，我才会考虑创建一个新类型或属性。一个快速的方法是使用[http://open.vocab.org/](http://open.vocab.org/)

自该视频发布以来，发布了更新版本的 RDFa：RDFa 1.1 和 RDFa Lite。如果您只想使用 schema.org，我建议您查看[http://www.w3.org/TR/rdfa-lite/](http://www.w3.org/TR/rdfa-lite/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-21T09:04:48.043

词汇表通常是特定领域的。xmlns 行已弃用。[http://www.w3.org/profile/rdfa-1.1](http://www.w3.org/profile/rdfa-1.1)上的 RDFa 概要 列出了作为初始上下文的一部分可用的词汇表。有时，词汇表可能会在您的数据上下文中重叠。类似于通过代数或几何或其他技术解决数学 prb，混合词汇是可以的。可以使用[http://sameas.org/](http://sameas.org/)找到相同的术语。为了解决您的消费者群在词汇识别中的偏爱，可以使用 skos:closeMatch 和 skos:exactMatch，例如。“gr:Brand skos:closeMatch owl:Thing”可以随意使用任何条款。除了初始上下文所涵盖的词汇表之外，前缀属性还可以与词汇表一起使用，例如：prefix="fb: [http://ogp.me/ns/fb#](http://ogp.me/ns/fb#)vocab2: path2 ..." 对于跨不同领域词汇的跨领域关注，例如使用 schema.org 指南自定义搜索结果微数据中的表示应该是有益的。但是，由于这与任何特定领域的专业化无关，前缀是在这种语法中不可用。RDFa 词汇在这样的特定领域上下文中很有帮助，以至于内容似乎更能吸引参与的观众，而微数据则针对那些迷失方向的人。对于过于简单而无法获得成熟词汇的任务，但有语义含义，请尝试[http://microformats.org/](http://microformats.org/)在 3 种语法中互换使用 REST 配置文件 URI 来表示词汇是有效的，但由于缺乏负担得起的人力来实现对 Web 规模词汇的替代支持，因此没有用。谷歌员工 Ian Hickson aka Hixie 讨论了 schema.org 词汇如何以及为什么值得拥有自己的单独微数据语法 - WHATWG HTML5 草案的编辑[http://logbot.glob.com.au/?c=freenode%23whatwg&s= 28+Nov+2012&e=28+Nov+2012#c747855](http://logbot.glob.com.au/?c=freenode%23whatwg&s=28+Nov+2012&e=28+Nov+2012#c747855)或[http://krijnhoetmer.nl/irc-logs/whatwg/20121128#l-1122](http://krijnhoetmer.nl/irc-logs/whatwg/20121128#l-1122)如果只有 Google 有足够聪明的员工来为 WG 包括其自己的员工的 1 种语法实现解析器，那么 RDFa 中的 RDFa Lite 将是另一门课程，如 Java 中的 Core Java，并且不需要名为 mocking rip-off 的单独微数据，但是唉——我们的世界是不完美的！

# .net - WebClient 子类在事件处理过程中被释放，结果是 ObjectDisposedException

> ID：12095948
> 
> 赞同：0
> 
> 时间：2012-08-23T16:13:20.903
> 
> 标签：.net

我将 WebClient 子类化以更好地控制它的功能（更改超时，并提供一个事件处理程序，每 1MB 进度触发一次）。它连续运行（一次/分钟）从 XML 源轮询数据，并且*大部分时间都*可以正常工作。但是，有时我会收到一个我不理解的 ObjectDisposedException。我将首先发布我认为是相关部分的评论，然后发布整个源代码以供参考。

**DownloadProgressChanged 事件处理程序和处置**

ObjectDisposedException 发生在此处理程序的最后一行。变量处于注释中指示的状态。

```
void MyWebClient_DownloadProgressChanged(object sender, DownloadProgressChangedEventArgs e)
{
    // cancelDueToError is false, isDisposed is true
    // isDisposed must have been false when this event handler fired
    if (cancelDueToError || isDisposed) return; 

    long additionalBytesReceived = e.BytesReceived - PreviousBytesReceived;
    PreviousBytesReceived = e.BytesReceived;
    BytesNotNotified += additionalBytesReceived;

    if (BytesNotNotified > ONE_MB)
    {
        OnNotifyMegabyteIncrement(e.BytesReceived);
        BytesNotNotified = 0;    // This is 0 at the point of the Exception, so this handler fired. 
    }
    firstByteReceived = true;

            //
            // !!!!! EXCEPTION HERE
            //
    // ObjectDisposedException here.  Clearly the class has been disposed already (isDisposed is true).  
    // But why is the DownloadProgressChanged event firing after MyWebClient is disposed?
    abortTimer.Change(TimeBetweenProgressChanges, System.Threading.Timeout.Infinite); 
}

// Somehow IDisposable.Dispose() is being called in the middle of the
// MyWebClient_DownloadProgressChanged event handler.  isDisposed is false
// at the beginning of the event handler (else it would have returned immediately)
// but true when I get the ObjectDisposedException
void IDisposable.Dispose()
{
    isDisposed = true;

    if (asyncWait != null) asyncWait.Dispose();
    if (abortTimer != null) abortTimer.Dispose();

    base.Dispose();
} 
```

**用法**

```
using (MyWebClient webClient = new MyWebClient())
{
    webClient.NotifyMegabyteIncrement += new MyWebClient.PerMbHandler(webClient_NotifyMegabyteIncrement);
    bool downloadOK = webClient.DownloadFileWithEvents(url, outputPath);
    // Do stuff with downloaded file if downloadOK
} 
```

显然，有时，MyWebClient 被放置在 MyWebClient_DownloadProgressChanged 事件处理程序的*中间*。但是，在下载完成之前不应释放该对象。这怎么可能发生？

**完整的源代码**

```
public class MyWebClient : WebClient, IDisposable
{
    public int Timeout { get; set; }
    public int TimeUntilFirstByte { get; set; }
    public int TimeBetweenProgressChanges { get; set; }

    public long PreviousBytesReceived { get; private set; }
    public long BytesNotNotified { get; private set; }

    public string Error { get; private set; }
    public bool HasError { get { return Error != null; } }

    private bool firstByteReceived = false;
    private bool success = true;
    private bool cancelDueToError = false;

    private EventWaitHandle asyncWait = new ManualResetEvent(false);
    private Timer abortTimer = null;
    private bool isDisposed = false;

    const long ONE_MB = 1024 * 1024;

    public delegate void PerMbHandler(long totalMb);

    public event PerMbHandler NotifyMegabyteIncrement;

    public MyWebClient(int timeout = 60000, int timeUntilFirstByte = 30000, int timeBetweenProgressChanges = 15000)
    {
        this.Timeout = timeout;
        this.TimeUntilFirstByte = timeUntilFirstByte;
        this.TimeBetweenProgressChanges = timeBetweenProgressChanges;

        this.DownloadFileCompleted += new System.ComponentModel.AsyncCompletedEventHandler(MyWebClient_DownloadFileCompleted);
        this.DownloadProgressChanged += new DownloadProgressChangedEventHandler(MyWebClient_DownloadProgressChanged);

        abortTimer = new Timer(AbortDownload, null, TimeUntilFirstByte, System.Threading.Timeout.Infinite);
    }

    protected void OnNotifyMegabyteIncrement(long totalMb)
    {
        if (NotifyMegabyteIncrement != null) NotifyMegabyteIncrement(totalMb);
    }

    void AbortDownload(object state)
    {
        cancelDueToError = true;
        this.CancelAsync();
        success = false;
        Error = firstByteReceived ? "Download aborted due to >" + TimeBetweenProgressChanges + "ms between progress change updates." : "No data was received in " + TimeUntilFirstByte + "ms";
        asyncWait.Set();
    }

    void MyWebClient_DownloadProgressChanged(object sender, DownloadProgressChangedEventArgs e)
    {
        if (cancelDueToError || isDisposed) return;

        long additionalBytesReceived = e.BytesReceived - PreviousBytesReceived;
        PreviousBytesReceived = e.BytesReceived;
        BytesNotNotified += additionalBytesReceived;

        if (BytesNotNotified > ONE_MB)
        {
            OnNotifyMegabyteIncrement(e.BytesReceived);
            BytesNotNotified = 0;
        }
        firstByteReceived = true;
        abortTimer.Change(TimeBetweenProgressChanges, System.Threading.Timeout.Infinite);
    }

    public bool DownloadFileWithEvents(string url, string outputPath)
    {
        asyncWait.Reset();
        Uri uri = new Uri(url);
        this.DownloadFileAsync(uri, outputPath);
        asyncWait.WaitOne();

        return success;
    }

    void MyWebClient_DownloadFileCompleted(object sender, System.ComponentModel.AsyncCompletedEventArgs e)
    {
        if (cancelDueToError || isDisposed) return;
        asyncWait.Set();
    }

    protected override WebRequest GetWebRequest(Uri address)
    {            
        var result = base.GetWebRequest(address);
        result.Timeout = this.Timeout;
        return result;
    }

    void IDisposable.Dispose()
    {
        isDisposed = true;

        if (asyncWait != null) asyncWait.Dispose();
        if (abortTimer != null) abortTimer.Dispose();

        base.Dispose();
    }
} 
```

# hyperlink - Facebook Like 按钮变成红色：你是垃圾邮件

> ID：12095949
> 
> 赞同：2
> 
> 时间：2012-08-23T16:13:21.390
> 
> 标签：hyperlink, facebook-like, spam, blocked

我的页面上有一些喜欢的按钮，我正在用它们运行一些测试（嗯..很多测试）。现在它显示得很好，但是当我点击它们时，它们会变成红色，显示“错误”并出现一个弹出窗口：

**您尝试共享的内容包含一个因垃圾邮件或不安全而被阻止的链接：错误/警告消息的正文。标题是：您无法发布此内容，因为它有一个被阻止的链接。有关更多信息，请访问帮助中心。如果您认为自己看错了，请告诉我们。**

我试图通过其他 URL 更改 data-href，但问题是一样的。它是否链接到我的 Facebook 帐户？我的IP？我的应用程序 ？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T15:43:48.520

我用这个来修复我的。我认为这个没有错误，因为它没有像小按钮那样显示错误。

[http://developers.facebook.com/docs/reference/plugins/like-box/](http://developers.facebook.com/docs/reference/plugins/like-box/)

# api - Google 自定义搜索 API：将其用作刮板？

> ID：12095953
> 
> 赞同：0
> 
> 时间：2012-08-23T16:14:04.603
> 
> 标签：api

此 API 是否仅用于搜索您的网站，还是可以将任何标准的 google 搜索（甚至是高级搜索功能）提交给它？我知道每天有 100 个限制，我只是好奇它是否可以从你自己的机器上调用，因为代码示例和介绍表明它的预期用途是在你的网站上显示结果。我想在给定域之外搜索并为任何给定搜索抓取标准谷歌结果。这将不是一个 ajax 调用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T13:32:29.347

我目前的理解：

*   仅当您不付款时，您每天只能使用 100 次。
*   您确实必须指定域，但有些 tld 很好（例如：.uk）
*   任何给定搜索查询的搜索结果限制为 100 个（十页，最多十个响应）
*   它可以从您自己的机器上调用。

# python - 在 Python 中从 sys.stdin 重建 URL 字符串

> ID：12095955
> 
> 赞同：0
> 
> 时间：2012-08-23T16:14:07.573
> 
> 标签：python

我有一个从大型日志文件中获取输入的脚本。此文件具有编码的 URL。我正在使用标准输入从文件中获取这些 URL。我希望分别处理每个 URL。

问题是当我得到一个单独的 URL 时，它被拆分为 URL 中的每个字符。我在处理后得到字符时会执行 ''.join(something) 。

例如

```
for line in sys.stdin:
    line = line.strip()
    line1 = ''.join(line) 
```

我还尝试收集 URL 中的所有字符，然后加入。结果还是一样。

取样我得到：

文件输入：“www.cnn.com” sys.std 处理后输出：['w','w','w','.','c','n','n','。 ','c','o','m']

列表出现是因为我做到了。否则我会从 sys.stdin 获得 www.cnn.com。但底层结构与输出相同。

我想要的是：来自文件的输入：“www.cnn.com”输出：“www.cnn.com”（这应该是一个字符串。不是单个字符的字符串）

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T16:24:13.583

我认为您的标准输入可能是乱码。考虑这个脚本：

```
#stdin.py
import sys
for line in sys.stdin:
    print line.strip() 
```

然后管道输入按预期工作：

```
$ echo -e "www.cnn.com\nwww.test.com" | python stdin.py 
www.cnn.com
www.test.com 
```

如果您调用`list()`一个字符串，它会按字符将其拆分：

```
>>> list("test")
['t', 'e', 's', 't'] 
```

我猜您可能想要做的是读取整个输入，然后按行拆分，如下所示：

```
import sys
lines = sys.stdin.read().split()
print lines 
```

运行它，我得到：

```
$ echo -e "www.cnn.com\nwww.test.com" | python stdin.py 
['www.cnn.com', 'www.test.com'] 
```

# html - 图片没有出现在网页上

> ID：12095961
> 
> 赞同：0
> 
> 时间：2012-08-23T16:14:32.620
> 
> 标签：html, asp.net-mvc-3

我正在尝试在我的主页上显示图像。我的 Index.cshtml 代码如下所示：

```
@{
ViewBag.Title = "Home Page";
}

<h2>@ViewBag.Message</h2>

<h4>View results by:</h4>
<ul id="friend">
<li>@Html.ActionLink("Countries", "Countries", "Home")</li>
<li>@Html.ActionLink("Events", "Events", "Home")</li>
</ul>
<div>
<img id="banner" src="oly1.jpg"/>
</div> 
```

但是，由于某种原因，该图像未显示在我的页面上。我将图像保存到我的桌面，当我为另一个项目做同样的事情（使用保存到桌面的图像）时，它使用相同的语法。不过，我使用的是纯 html。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T16:18:08.620

试试这个：

```
@{
ViewBag.Title = "Home Page";
}

<h2>@ViewBag.Message</h2>

<h4>View results by:</h4>
<ul id="friend">
<li>@Html.ActionLink("Countries", "Countries", "Home")</li>
<li>@Html.ActionLink("Events", "Events", "Home")</li>
</ul>
<div>
    <img id="banner" src="@Url.Content("~/oly1.jpg")"/>
</div> 
```

`~`指您网站的根目录。如果您的图像文件位于根目录，请使用上述路径。如果您的图像在内部`Content/images`，请使用`~/Content/images/oly1.jpg`.

例子：

![屏幕主持人](../Images/82e6356cc165ce12144ef8af81883efb.png)

# c# - Mongodb：如何检查一个点是否包含在多边形中？

> ID：12095965
> 
> 赞同：3
> 
> 时间：2012-08-23T16:14:45.130
> 
> 标签：c#, mongodb, geolocation, geometry

我有一个点数组（纬度，经度）中一个区域的点列表。我已经对这些数组进行了索引，现在我想知道一个点是否在该多边形内。

MongoDB可以吗？我已经尝试过使用这些命令，但没有运气：

```
 > polygonA = [ [ 48.780809,2.307129],[ 48.781809,2.300129],[ 48.770809,2.317129]]
 > db.contours.find({ "rings.ring" : { "$within" : { "$polygon" : polygonA } } }) 
```

和

```
 > db.runCommand( { geoNear : "contours" , within : [2.307129,48.780809,], num : 10 } ); 
```

我的数据结构是：

```
 > db.contours.findOne({},{'rings':0})
 {
         "_id" : ObjectId("50364617d591ac166000c196"),
         "foundfieldname" : "Name",
         "geometrytype" : "geometryPolygon",
         "attributes" : {
                 "Shape" : "Polygon",
                 "Name" : "France",
                 "Type" : "Country",
                 "Country" : "France",
                 "Area" : "1162358716567.45"
         },
         "country" : "France",
 "rings":{
      "ring":[[12.32,43.54],...],
           ...
 } 
```

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T17:25:34.640

这要求 ring.ring 是一个点，并且它上面定义了一个地理索引，是这种情况吗？

您的问题意味着这实际上是一个带有标准索引（多键索引）的多个点的列表，这是行不通的。

[http://www.mongodb.org/display/DOCS/Geospatial+Indexing/#GeospatialIndexing-BoundsQueries](http://www.mongodb.org/display/DOCS/Geospatial+Indexing/#GeospatialIndexing-BoundsQueries)

如您所见，当您搜索“loc”作为多边形内的一个点时，“loc”字段是这样的（有关其他有效示例，请参见上面的链接）：

```
{ loc : [ 50 , 30 ] } 
```

使用这样的索引：

db.places.ensureIndex({ loc : "2d" }

也就是说，一个表示单个点并在其上定义了地理索引的字段。如果您使用这样的字段 - 您的测试是否有效？

# java - Android：OnClick 按钮不会将值附加/删除到文本视图

> ID：12095973
> 
> 赞同：0
> 
> 时间：2012-08-23T16:15:14.813
> 
> 标签：java, android, mobile, android-intent, android-activity

我根本无法让 Android`onClick`事件正常工作。我在activity_main.xml 中渲染了一个TextView 和一些按钮。在 MainActivity.java 中，我尝试将`onClick`事件附加到所有将其值附加到输入字段的按钮。但是，我很难找到一些关于使拨号器工作的教程、书籍等。我有三本书，没有一本谈论使用呼叫功能或制作拨号器。我在网上找到的教程都是关于向用户展示如何 root 和主题他们的拨号器的人，而不是如何编程。所以我的问题：

1）在我的文本视图中附加一个值我哪里出错了？2) 如何使用 del onClick 事件删除最后一个值？3）当用户点击它时，如何阻止文本视图拉起键盘？即如何使其禁用/只读（也许）所以只有按钮可以更新它？

谢谢你的帮助。在下面的代码中，我将按钮缩减为一个。我所做的只是复制所有按钮并更改 ID、文本等。所以所有方法都是相同的，但我不能只让一个按钮工作。同样，请不要对下面的代码太嘲笑我。

活动主.xml：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/mainlayout"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >

<TextView
    android:id="@+id/textView1"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:gravity="center"
    android:text="@string/title_two"
    android:textAppearance="?android:attr/textAppearanceLarge" />

<EditText
    android:id="@+id/editText1"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:ems="10"
    android:maxLength="15" >
    <requestFocus />
</EditText>

<LinearLayout
    android:orientation="horizontal"
    android:layout_height="wrap_content"
    android:layout_width="fill_parent" >
    <Button
        android:id="@+id/one"
        android:layout_width="93dp"
        android:layout_height="wrap_content"
        android:text="1" />
    <Button
        android:id="@+id/two"
        android:layout_width="93dp"
        android:layout_height="wrap_content"
        android:text="2" />
    <Button
        android:id="@+id/three"
        android:layout_width="93dp"
        android:layout_height="wrap_content"
        android:text="3" />
</LinearLayout>
<LinearLayout
    android:orientation="horizontal"
    android:layout_height="wrap_content"
    android:layout_width="fill_parent" >
    <Button
        android:id="@+id/four"
        android:layout_width="93dp"
        android:layout_height="wrap_content"
        android:text="4" />
    <Button
        android:id="@+id/five"
        android:layout_width="93dp"
        android:layout_height="wrap_content"
        android:text="5" />
    <Button
        android:id="@+id/six"
        android:layout_width="93dp"
        android:layout_height="wrap_content"
        android:text="6" />
</LinearLayout>
<LinearLayout
    android:orientation="horizontal"
    android:layout_height="wrap_content"
    android:layout_width="fill_parent" >
    <Button
        android:id="@+id/seven"
        android:layout_width="93dp"
        android:layout_height="wrap_content"
        android:text="7" />
    <Button
        android:id="@+id/eight"
        android:layout_width="93dp"
        android:layout_height="wrap_content"
        android:text="8" />
    <Button
        android:id="@+id/nine"
        android:layout_width="93dp"
        android:layout_height="wrap_content"
        android:text="9" />
</LinearLayout>
<LinearLayout
    android:orientation="horizontal"
    android:layout_height="wrap_content"
    android:layout_width="fill_parent" >
    <Button
        android:id="@+id/star"
        android:layout_width="93dp"
        android:layout_height="wrap_content"
        android:text="*" />
    <Button
        android:id="@+id/zero"
        android:layout_width="93dp"
        android:layout_height="wrap_content"
        android:text="0" />
    <Button
        android:id="@+id/pound"
        android:layout_width="93dp"
        android:layout_height="wrap_content"
        android:text="#" />
</LinearLayout>
<LinearLayout
    android:orientation="horizontal"
    android:layout_height="wrap_content"
    android:layout_width="fill_parent" >
    <Button
        android:id="@+id/callButton"
        android:layout_width="93dp"
        android:layout_height="wrap_content"
        android:text="Call" />
    <Button
        android:id="@+id/contacts"
        android:layout_width="93dp"
        android:layout_height="wrap_content"
        android:text="Con" />
    <Button
        android:id="@+id/del"
        android:layout_width="93dp"
        android:layout_height="wrap_content"
            android:text="Del" />
    </LinearLayout>

</LinearLayout> 
```

和 MainActivity.java：

```
package com.example.dialertest

import android.app.Activity;
import android.content.Intent;
import android.content.ActivityNotFoundException;
import android.net.Uri;
import android.os.Bundle;
import android.util.Log;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.EditText;
import android.widget.Toast;

public class MainActivity extends Activity {
Button oneBtn;
Button twoBtn;
Button threeBtn;
Button fourBtn;
Button fiveBtn;
Button sixBtn;
Button sevenBtn;
Button eightBtn;
Button nineBtn;
Button starBtn;
Button zeroBtn;
Button poundBtn;
Button callBtn;
Button conBtn;
Button delBtn;
EditText numTxt;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    oneBtn = (Button) findViewById(R.id.one);
    twoBtn = (Button) findViewById(R.id.two);
    threeBtn = (Button) findViewById(R.id.three);
    fourBtn = (Button) findViewById(R.id.four);
    fiveBtn = (Button) findViewById(R.id.five);
    sixBtn = (Button) findViewById(R.id.six);
    sevenBtn = (Button) findViewById(R.id.seven);
    eightBtn = (Button) findViewById(R.id.eight);
    nineBtn = (Button) findViewById(R.id.nine);
    starBtn = (Button) findViewById(R.id.star);
    zeroBtn = (Button) findViewById(R.id.zero);
    poundBtn = (Button) findViewById(R.id.pound);
    callBtn = (Button) findViewById(R.id.callButton);
    conBtn = (Button) findViewById(R.id.contacts);
    delBtn = (Button) findViewById(R.id.del);

    numTxt = (EditText) findViewById(R.id.editText1);

    oneBtn.setOnClickListener(new View.OnClickListener() {
        public void onClick(View v) {
            oneBtn.setText("1");
            numTxt.setText(numTxt.getText() + " " + oneBtn.getText());
            //numTxt.append("1");
        }
    });
/**private void performDial(String numberString) {
    if (!numberString.equals("")) {
        Uri number = Uri.parse("tel:" + numberString);
        Intent dial = new Intent(Intent.ACTION_CALL, number);
        startActivity(dial);
    }
}*/

/*private void call() {
    try {
        Intent callIntent = new Intent(Intent.ACTION_CALL);
        callIntent.setData(Uri.parse("tel: 8880000000"));
        startActivity(callIntent);
    } catch(ActivityNotFoundException e) {
        Log.e("Dialed Number","Call Failed", e);
    }
}
}*/
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T16:33:54.110

将您的 onClicklistener 更改为：

```
oneBtn.setOnClickListener(new View.OnClickListener() {
    @Override
    public void onClick(View v) {
        // no need to use onBtn here cuz the param v is the clicked View
        Button clickedButton = (Button) v;
        clickedButton.setText("1");
        numTxt.setText(numTxt.getText().toString() + " " + clickedButton.getText());
        //numTxt.append("1");
    }
}); 
```

Edittext 的 getText() 方法返回一个可编辑对象，请参阅：

[http://developer.android.com/reference/android/widget/EditText.html#getText](http://developer.android.com/reference/android/widget/EditText.html#getText) () [http://developer.android.com/reference/android/text/Editable.html](http://developer.android.com/reference/android/text/Editable.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T16:43:40.750

为了得到你的文字，`edittext`你必须打电话`toString()`后`getText()`

```
numTxt.setText(numTxt.getText().toString() + " " + clickedButton.getText()); 
```

# php - PHP以多种形式将数据保存在sql中

> ID：12095975
> 
> 赞同：0
> 
> 时间：2012-08-23T16:15:15.343
> 
> 标签：php, sql

我正在使用[这里](http://ivanvillareal.com/development/dynamic-multi-form-on-same-page-with-jquery-and-php/)给出的多格式 PHP 脚本。它基本上是一种在同一页面上多步骤完成的表单。我只是 PHP 的初学者，所以我从这个脚本中获得灵感。我不明白的是：“如何将用户输入的数据存储在SQL表中？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T16:17:22.300

在`save`函数中，不要将数据保存到`$_SESSION`（此处：）中，而是`$_SESSION[$step][$key] = $val;`将其保存到您的 SQL 数据库中。

但小心点。您必须更新脚本以从数据库中检索信息，而不是从`$_SESSION`您在每个输入标签中设置值时检索信息。

**编辑：**

该`save`函数用于存储用户输入的每个数据。代替 ：

```
function save($step, $data) {
    //$_SESSION[$step] = $data;
    $fields = explode('&',$data);
    foreach ($fields as $field) {
        $keyVal = explode('=', $field);
        $key = urldecode($keyVal[0]);
        $val = urldecode($keyVal[1]);
        $_SESSION[$step][$key] = $val;
    }
} 
```

你应该有类似的东西（**sql查询不好，这只是一个例子**）：

```
function save($step, $data)
{
  //$_SESSION[$step] = $data;
  $fields = explode('&',$data);
  $sql    = "INSERT INTO `ma_table` (`step`, `key`, `val`) VALUES ";

  foreach ($fields as $field)
  {
    $keyVal = explode('=', $field);
    $key = mysql_real_escape_string($keyVal[0]);
    $val = mysql_real_escape_string($keyVal[1]);

    $sql .= "('" . $step . "', '" . $key . "', '" . $val . "')";
  }

  mysql_query($sql);
} 
```

# javascript - 用我的函数 jquery 提供数据/参数

> ID：12095979
> 
> 赞同：0
> 
> 时间：2012-08-23T16:15:29.847
> 
> 标签：javascript, jquery, function

```
 var regfbnaam = $('#regfbnaam');
 $('#regnaam').focusin({param1: regfbnaam},removeClass);

function removeClass(e)
{
    param1.removeClass('hidden');
} 
```

console.log 中的错误：未定义 param1。意味着他没有得到我的 param1 的值。我在这里做错了什么？

（试图为我的函数获取一个带有 onclick 事件的变量）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T16:18:35.637

尝试：

```
function removeClass(e)
{
    $(e.data.param1).removeClass('hidden');
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T16:21:05.540

不完全确定您尝试使用该语法做什么。我会建议一种不同的方法：

```
var $el = $(el);
$el.on('focusin', function(){
    removeClass(e, {param1: regfbnaam});
});

function removeClass(e, params)
{
    params.param1.removeClass('hidden');
} 
```

未经测试，但我认为它应该工作。基本上这个想法是你将一个函数绑定到元素，然后为它提供它需要的任何参数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T16:39:16.390

试试这个（测试）

```
function removeClass(e) {  
    var param1 = e.data.param1;
    param1.removeClass('hidden');
}
jQuery(document).ready(function($) {
    var regfbnaam = $('#regfbnaam');
    $('#regnaam').focusin({param1: regfbnaam},removeClass); 
}); 
```

**参考：**

[事件数据](http://api.jquery.com/event.data/)

[。专注于（）](http://api.jquery.com/focusin/)

# javascript - 试图创建一个选择选项

> ID：12095980
> 
> 赞同：0
> 
> 时间：2012-08-23T16:15:30.500
> 
> 标签：javascript, jquery

我不确定该站点是否仅使用 asp，但我正在尝试创建一个表单，根据您是否选择其中一个来禁用或启用子字段。我可以使用复选框来做到这一点，但我希望它与下拉选择值一起使用。这是下面的链接和脚本：

[http://www.rfdesignstudio.com/newsite/paypal.html](http://www.rfdesignstudio.com/newsite/paypal.html)

这是选择脚本：

```
<select name="type" class="input" id="type" onchange="type()">
      <option value="General">General</option>
      <option value="Walk-a-thon">Walk-a-thon</option>
</select> 
```

这是函数脚本：

```
function type(){

if (document.getElementById('type').value=='Walk-a-thon') { 
   document.getElementById('child').disabled = false; 
   document.getElementById('teacher').disabled = false; 
   document.getElementById('room').disabled = false; 
   } 
else { 
  document.getElementById('child').disabled = true; 
  document.getElementById('teacher').disabled = true; 
  document.getElementById('room').disabled = true; 
  document.getElementById('child').value = ""; 
  document.getElementById('teacher').value=""; 
  document.getElementById('room').value="";}
  } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T16:20:48.543

您应该能够将其减少到这个（未经测试）：

```
function type(){
  if ($('#type').val() == 'Walk-a-thon') { 
    $('#child, #teacher, #room').removeAttr('disabled');
  } 
  else { 
   $('#child, #teacher, #room').attr('disabled', 'disabled').val('');
  } 
} 
```

您可能还想在文档加载时通过在该`head`部分的某处添加此片段来触发此功能：

```
<script type="text/javascript">
  $(function(){ type(); });
</script> 
```

# xml - 如何在 TSQL 中从此 XML 中获取数据

> ID：12095981
> 
> 赞同：1
> 
> 时间：2012-08-23T16:15:35.650
> 
> 标签：xml, tsql, xpath, xml-parsing

在一个 sql 查询中，我运行这些命令，无论我尝试什么，我都会得到 NUll。

```
DECLARE @x AS XML

SET @x = ' <Data> <Preference>Mail</Preference>   <Comment>Changed Contact Communication Preference due to customer unsubscribed</Comment>  </Data> '

SELECT @x.value('(//Data/@Preference)[0]','varchar(20)') AS Preference 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T16:19:38.593

请改用此 XPath：

```
SELECT @x.value('(//Data/Preference)[1]','varchar(20)') AS Preference 
```

所有 XPath 数组都是从**1**开始的——不是从 0 开始的——因此你`[0]`不会返回任何东西。

其次，`<Preference>`是一个 XML 元素——而不是一个属性。`@Preference`您正在尝试选择XML**属性**

# objective-c - 在超类中调用可选方法（Objective-C）

> ID：12095984
> 
> 赞同：3
> 
> 时间：2012-08-23T16:15:59.850
> 
> 标签：objective-c, inheritance, macros, nscoding, overriding

我正在尝试为 NSCoding 协议创建一个通用实现。代码将被包裹在一个宏中，该宏将实现 NSCoding。为了实现协议，我们需要两个函数：

```
-(void)encodeWithCoder:(NSCoder*)coder;
-(id)initWithCoder:(NSCoder*)coder; 
```

initWithCoder 函数的通用实现是：

```
-(id)initWithCoder:(NSCoder*)coder { 
    if ([super conformsToProtocol:@protocol(NSCoding)]) 
        self = [super initWithCoder:coder];
    else {
        self = [super init];
    }
    if (!self) return self;
    self = [MyGenericCoder initWithCoder:coder forObject:self withClass:[__clazz class]]; 
    return self; 
} 
```

有问题的行是`self = [super initWithCoder:coder];`它不会编译，因为`initWithCoder:`当我们在一个它的 super 没有实现 NSCoding 的类中使用时 super 没有响应。将 super 转换为`NSObject<NSCoding>*`不适用于 LLVM 编译器。

`[super performSelector:(initWithCoder:) withObject:coder]`由于 super == self 也不起作用，这将导致无限循环。

如何`[super initWithCoder:coder]`以触发超类中的函数并且不会生成编译警告/错误的方式调用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T21:42:46.083

您可以使用`+instancesRespondToSelector:`来确定您的超类是否响应选择器，然后`objc_msgSendSuper()`直接实际调用它。

```
#import <objc/message.h>

- (id)initWithCoder:(NSCoder *)coder {
    // Note: use [__clazz superclass] directly because we need the
    // compile-time superclass instead of the runtime superclass.
    if ([[__clazz superclass] instancesRespondToSelector:_cmd]) {
        struct objc_super sup = {self, [__clazz superclass]};
        ((id(*)(struct objc_super *, SEL, NSCoder*))objc_msgSendSuper)(&sup, _cmd, coder);
    } else {
        [super init];
    }
    if (!self) return self;
    self = [MyGenericCoder initWithCoder:coder forObject:self withClass:[__clazz class]];
    return self;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T21:36:02.010

```
#import <objc/runtime.h>
-(id)initWithCoder:(NSCoder*)coder {
    Class superclass = class_getSuperclass([__clazz class]);
    SEL constructor = @selector(initWithCoder:);
    if (class_conformsToProtocol(superclass,@protocol(NSCoding))) {
        self = class_getMethodImplementation(superclass,constructor)(self,constructor,coder);
    }
    else {
        self = [super init];
    }
    if (!self) return self;
    self = [MyGenericCoder initWithCoder:coder forObject:self withClass:[__clazz class]];
    return self;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-24T21:53:06.847

> 如何以触发超类中的函数并且不会生成编译警告/错误的方式调用 [super initWithCoder:coder]？

只需创建宏的两种变体——一种用于超类采用的类型`NSCoding`，另一种用于不采用的类型。

要么这样，要么从你自己抽象细节并从中间类型派生出来，这些类型从你的基础中抽象出条件并采用`NSCopying`——然后你可以调用`initWithCoder:`任何这样的类型。

# php - 以编程方式在drupal中显示隐藏按钮

> ID：12095991
> 
> 赞同：0
> 
> 时间：2012-08-23T16:16:18.657
> 
> 标签：php, drupal, drupal-7

我有一个带有用于注册的锚按钮的注册页面，但是当用户登录时，表单被隐藏，但内容应该仍然可见，只是隐藏立即加入按钮，我试图基于显示按钮vistor id，所以基本上我只想将它展示给未经身份验证的匿名用户

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T16:16:18.657

```
 <?php
global $user;
  if ($user->uid)

return;

else
{
print '<div id="landing-left-button">
    <a class="button" href="#join-anchor">Click Here To Join</a></div>';
}
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T16:37:48.523

更好的方法是这样做：

```
if (! user_is_logged_in()) {
  print <<<EOT
    <div id="landing-left-button">
      <a class="button" href="#join-anchor">Click Here To Join</a>
    </div>
EOT;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T16:38:10.627

我不太确定你的用例是什么......但在这种情况下，你将不得不使用全局变量。这就是我们通常检查/获取用户数据的方式。

```
<?php
 if (user_is_logged_in()){
  // do something for logged in users.
 }
 else{
  //do something for anoynmous users. 
 }
?> 
```

[如果用户已登录， user_is_logged_in()](http://api.drupal.org/api/drupal/modules!user!user.module/function/user_is_logged_in/7)函数将返回 TRUE（呵呵！）。

# java - 在 Spring MVC 控制器中使用 jquery 传递对象数组

> ID：12095998
> 
> 赞同：0
> 
> 时间：2012-08-23T16:16:40.913
> 
> 标签：java, jquery, ajax, spring-mvc

我正在尝试将文件对象数组传递给 spring MVC 控制器。但我收到 400 Bad request 错误。

在我的 jsp 中，我编写了一个 jquery 方法来获取文件数组。

```
function getFilelist() {
      var files = $('body').data('filelist');
      return files;
} 
```

并使用 post Json 方法上传这些所有文件。

- -更新 - -

我正在添加整个 init() 方法：

```
function init() {
    $('input:button').button();
    $('#submit').button();

    $('#uploadForm').submit(function(event) {
        event.preventDefault();   

        alert("uploading..");

        $.postJSON('fileSave.htm', {
            filename: getFilelist()    
        },
                   function(result) {
                       if (result.success == true) {
                           dialog('Success', 'Files have been uploaded!');
                       } else {
                           dialog('Failure', 'Unable to upload files!');
                       }
                   });
    });

    $('#reset').click(function() {
        clearForm();
        dialog('Success', 'Fields have been cleared!');
    });

    $('#upload').fileupload({
        dataType: 'json',
        done: function (e, data) {
            $.each(data.result, function (index, file) {
                $('body').data('filelist').push(file);
                $('#filename').append(formatFileDisplay(file));
                $('#attach').empty().append('Add another file');
            });
        }
    });

    $("#attach").click(function () {
        $("#upload").trigger('click');
    });

    $('body').data('filelist', new Array());
} 
```

这里 getFilelist() 是文件对象的数组。在我的控制器中，我写道：

```
@RequestMapping(value="fileSave", method=RequestMethod.POST)
public @ResponseBody StatusResponse message(
    @RequestParam("filesAttachedList") FilesAttachedList filesAttachedList) {
  // some code here
} 
```

我的`FilesAttachedList`班级：

```
public class FilesAttachedList implements Serializable {
    private static final long serialVersionUID = 5944305104394883501L;
    private List<FileAttachment> filesList;

    public List<FileAttachment> getFilesList() {
        return filesList;
    }

    public void setFilesList(List<FileAttachment> filesList) {
        this.filesList = filesList;
    }

    @Override
    public String toString() {
        return "FilesAttachedList [filesList=" + filesList + "]";
    }
} 
```

那么如何将对象数组从 jquery 传递给控制器​​呢？

**- 更新 -**

当我检查浏览器 getFileList 返回

```
 Object
 attachableId: null
 attachableType: null
 attachmentContentType: null
 attachmentFileName: "http://localhost:8080/myproject/resources/images.jpg"
 attachmentFileSize: 6994
 attachmentUpdatedAt: null
 createdAt: null
 creatorId: null
 id: null
 name: "images.jpg"
 updatedAt: null
 updaterId: null
 __proto__: Object
 length: 1
 __proto__: Array[0] 
```

这就是如果我添加两个图像对象

```
 Array[2]
 0: Object
 1: Object
 length: 2
 __proto__: Array[0] 
```

**----更新3 ---**

当我从`@RequestParam("filesAttachedList") FilesAttachedList filesAttachedList`to更改`@RequestBody final String filesAttachedList`并添加两个图像时，它给了我以下字符串对象。我能读懂这个字符串吗？

```
{
  "filename": [
    {
      "id": null,
      "createdAt": null,
      "updatedAt": null,
      "name": "images.jpg",
      "attachableId": null,
      "attachableType": null,
      "attachmentFileName": "http:\/\/localhost:8080\/myproject\/resources\/images.jpg",
      "attachmentContentType": null,
      "attachmentFileSize": 6994,
      "attachmentUpdatedAt": null,
      "creatorId": null,
      "updaterId": null
    },
    {
      "id": null,
      "createdAt": null,
      "updatedAt": null,
      "name": "lion.jpg",
      "attachableId": null,
      "attachableType": null,
      "attachmentFileName": "http:\/\/localhost:8080\/myproject\/resources\/lion.jpg",
      "attachmentContentType": null,
      "attachmentFileSize": 36670,
      "attachmentUpdatedAt": null,
      "creatorId": null,
      "updaterId": null
    }
  ]
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T16:46:25.393

您没有打印在这里很重要的 、 和 字符，但我认为它只是一个对象，而您的控制器需要`{`一个对象`}`列表。`[``]``FileAttachment`

要么在带有数组的 JS 中添加环绕文件，`return [ files ];`要么，如果它总是只在`FileAttachment`将控制器更改为`@RequestParam("fileAttachment") FileAttachment fileAttachment`.

编辑：

可以改成`@RequestParam("fileAttachment")`吗`@RequestParam("filename")`？我看到你同时编辑了你的问题。