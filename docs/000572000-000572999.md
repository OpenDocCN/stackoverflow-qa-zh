# StackOverflow 问答 000572000-000572999

# objective-c - 具有校准值的 NSColor 与常规颜色的工作方式不同？

> ID：572000
> 
> 赞同：1
> 
> 时间：2009-02-21T02:41:54.120
> 
> 标签：objective-c, cocoa

我在我的视图中使用一种方法来设置颜色，在 awakeFromNib 中我使用 [NSColor colorWithCalibratedRed: green: blue: alpha:] 将颜色传递给它

应用程序不断崩溃，并出现“[NSCFNumber set] unrecognized selector”错误。插入断点后，我发现它正在将我的变量定义为“NSCalibratedRGBColor”。当我使用一种方便的方法（blueColor、whiteColor 等）定义颜色时，该应用程序工作。我认为这些只是设置 RGB 值的捷径。我不知道为什么我以前没有遇到过这个问题，我经常使用这样的颜色。为什么它会以不同的方式处理这个问题，我可以让它解释为常规颜色吗？

编辑：代码是： [self setLineColor:[NSColor colorWithCalibratedRed:green:blue:alpha]; 在我的 awakeFromNib 中。我还发现它是一个非 1 的 alpha 值，导致颜色被定义为“NSCalibratedRGBColor”。Alpha 值 1 与便捷方法一样，会导致在调试中将颜色定义为“NSCachedRGBColor”，这完全可以正常工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-21T03:17:57.983

> 应用程序不断崩溃，并出现“[NSCFNumber set] unrecognized selector”错误。

这意味着您过度释放了颜色，然后另一个对象（在本例中为 NSNumber）被分配给同一个指针。然后您将`set`消息发送到您认为是您的颜色的对象，但它现在实际上是一个 NSNumber 对象。结果：那个错误。它与您使用校准与未校准的色彩空间无关。

所有颜色都支持相同的 NSColor 接口。您看到的 NS[snip]Color 类是 NSColor 的私有子类；它们都支持所有 NSColor 的方法。就您而言，它们都只是 NSColors。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-21T03:27:13.623

像 +[NSColor blueColor] 这样的命名颜色是单例对象。但是 +[NSColor colorWithCalibratedRed:...] 不是。听起来您没有正确保留颜色。

请务必阅读保留/释放的内存管理文档。或者只是切换到垃圾收集。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-21T02:47:49.163

导致问题的代码行是什么？

NSCalibratedRGBColor 与非校准颜色的工作方式不同，因为当你“设置”它时，颜色将校准到上下文的颜色空间，而不是使用原始的未校准颜色。

但是，我从来没有在 NSColor 方法的这种特殊用法上看到过这个错误，而且没有更多信息，我只能摸不着头脑。

# java - 在 Java 中检测和操作键盘方向键

> ID：572001
> 
> 赞同：10
> 
> 时间：2009-02-21T02:42:19.550
> 
> 标签：java, keyboard, key, direction

万事如意，

我有一个控制台项目，旨在让用户按下键盘方向键（非数字键盘）来移动头像。我很难编码来检查这些键的按下情况。在 Pascal 中，使用“readkey”和代码很容易，例如，#80 用于向下按键。但是，我很难理解如何在 Java 中实现相同的功能，尽管我认为我了解 System.in 和 BufferedInputStream 的使用。

谁能帮帮我？非常感谢您的想法或提示。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-21T18:38:22.683

如果 java.io.console 对您不起作用（我没有尝试过），请尝试[JLine](https://jline.github.io/)。我用它来解决一个[类似的问题](https://stackoverflow.com/questions/414237/)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-21T02:50:22.463

Java 中的控制台支持问题是众所周知的，我不确定这是否可行。

这在 System.in 最初是不可能的，因为它曾经是基于行的。

Sun 最终添加了一个 java.io.Console 类。

这里是它的 JavaDocs：http: [//java.sun.com/javase/6/docs/api/java/io/Console.html](http://java.sun.com/javase/6/docs/api/java/io/Console.html)

一旦你得到控制台（我认为来自 System.console），你可以得到一个阅读器，也许从中读取字符，但我不确定它是否包含键。

一般来说，如果你想访问键盘，你应该使用 Swing 或 AWT，这很愚蠢。

截至 2007 年，有一个关于它的功能请求：[这里](http://bugs.sun.com/view_bug.do?bug_id=6552816)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-21T02:57:39.590

不幸的是，这是不可能的便携方式：

[http://forums.sun.com/thread.jspa?threadID=5351637&messageID=10526512](http://forums.sun.com/thread.jspa?threadID=5351637&messageID=10526512)

在 Windows 上，从 System.in 读取将阻止直到`enter`被按下，即使您不使用`BufferedReader`. 箭头将在命令历史记录中循环。自己试试：

```
import java.io.*;
public class KeyTest {
  public static void main(String[] argv) {
    try {
      InputStreamReader unbuffered = new InputStreamReader(System.in);
      for (int i = 0; i < 10; ++i) {
        int x = unbuffered.read();
        System.out.println(String.format("%08x", x));
      }
    } catch (Exception e) {
      System.err.println(e);
    }
  }
} 
```

使用该类的相同问题`Console`（Windows 下缓冲的输入，Windows 解释的箭头键）：

```
import java.io.*;
public class KeyTest2 {
  public static void main(String[] argv) {
    try {
      Console cons = System.console();
      if (cons != null) {
        Reader unbuffered = cons.reader();
        for (int i = 0; i < 10; ++i ) {
          int x = unbuffered.read();
          System.out.println(String.format("%08x", x));
        }
      }
    } catch (Exception e) {
      System.err.println(e);
    }
  }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-07-24T01:53:53.037

不使用内置 Java 代码。如果您想继续，请查看上面提到的 java curses 库或 JLine。

# python - Django 和 Sqlite 并发问题

> ID：572009
> 
> 赞同：4
> 
> 时间：2009-02-21T02:48:27.897
> 
> 标签：python, django, sqlite, concurrency

我已经阅读了一些与 sqlite 的并发问题相关的内容，但我看不出它们如何应用于 Django，因为它本质上是单线程的。我也没有使用任何多进程模块。我也完全没有并发编程的经验，所以如果有人能确定为什么以下代码会导致 OperationalError: 'database is locked'，我将不胜感激。

视图.py

```
def screening(request, ovramt=None):
errors = []
if request.method == "POST":
    form = ScreeningForm(request.POST)
    if form.is_valid():
       print "Woo valid!!"
    return HttpResponse()

else: # GET            
    if ovramt is None:
        o = Ovramt.objects.select_related(depth=1).latest("date_completed")
        print "found?"
        print o.id
    else:
        try:
            o = Ovramt.objects.select_related(depth=1).get(id=ovramt)
        except:
            errors.append("OVRAMT NOT FOUND") 

    if o.residents.count() <= 0:
        o.add_active_residents()
    residents = list(o.residents) 
```

模型.py

```
def add_active_residents(self):
    ssa_res = SSA_Resident.objects.select_related(depth=1).filter(ssa=self.ssa, active=True)
    for r in ssa_res:
        self.residents.add(r.resident) # Fails Here
    self.save() 
```

add_active_residents 方法工作正常，直到从视图模块调用它。视图中是否存在与打开的数据库的开放连接，这会阻止从模型中写入？有人解释为什么这段代码会出错？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-21T03:16:22.290

在下面的方法函数中

```
def add_active_residents(self):
    ssa_res = SSA_Resident.objects.select_related(depth=1).filter(ssa=self.ssa, active=True)
    for r in ssa_res:
        self.residents.add(r.resident) # Fails Here
    self.save() 
```

为什么会有一个 select_related ？你只需要 FK 的`ssa_res`物品。为什么要对相关项目进行额外查询？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-21T04:33:57.720

您使用的是 Python 2.6 吗？

如果是这样，这（显然）是一个已知问题，可以通过添加以下内容来缓解：

```
DATABASE_OPTIONS = {'timeout': 30} 
```

到你的 settings.py

见[http://code.djangoproject.com/ticket/9409](http://code.djangoproject.com/ticket/9409)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-22T15:53:42.103

我的理解是，只有写操作才会导致数据库锁定。 [http://www.sqlite.org/lockingv3.html](http://www.sqlite.org/lockingv3.html)

如果不知道 django 如何在内部处理 sqlite，很难说问题出在哪里。

谈到使用带有标准 cgi 的 sqlite 时，我注意到在某些情况下，释放锁可能需要“很长时间”。您可能想要增加 Matthew Christensen 提到的超时值。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-21T03:48:31.293

听起来你实际上是在运行一个多线程应用程序，尽管你说了什么。我对 Django 有点一无所知，但我认为即使它可能是单线程的，无论您在其中运行应用程序的调试服务器或生产服务器都不会是“固有的单线程”。

# matlab - 有人可以解释这个在 MATLAB 中从矩阵中删除元素的示例吗？

> ID：572021
> 
> 赞同：1
> 
> 时间：2009-02-21T02:55:38.333
> 
> 标签：matlab, matrix, matrix-indexing

以下示例出现在 MATLAB 教程中：

```
X = [16  2 13;
     5  11  8;
     9   7 12;
     4  14  1] 
```

使用单个下标删除单个元素或元素序列，并将剩余元素重新整形为行向量。所以：

```
X(2:2:10) = [] 
```

结果是：

```
X = [16 9 2 7 13 12 1] 
```

神秘的是，整个第2行和第4行的前两个元素都被删除了，但是我看不到被删除元素的位置和索引向量的对应关系`2:2:10`。有人可以解释一下吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-21T02:58:30.323

您给出的示例显示了[线性索引](https://www.mathworks.com/help/matlab/math/matrix-indexing.html#f1-85511)。当你有一个多维数组并给它一个标量或向量时，它会从上到下和从左到右沿每列索引。下面是索引到每个维度的示例：

```
mat = [1 4 7; ...
       2 5 8; ...
       3 6 9];
submat = mat(1:2, 1:2); 
```

`submat`将包含矩阵的左上角：`[1 4; 2 5]`. 这是因为`1:2`子索引中的第一个访问第一个维度（行），第二个`1:2`访问第二个维度（列），提取一个 2×2 正方形。如果您不为每个维度提供索引，用逗号分隔，而是只提供一个索引，MATLAB 将索引到矩阵中，就好像它是一个大列向量：

```
submat = mat(3, 3);     % "Normal" indexing: extracts element "9"
submat = mat(9);        % Linear indexing: also extracts element "9"
submat = mat([1 5 6]);  % Extracts elements "1", "5", and "6" 
```

有关更多详细信息，请参阅[MATLAB 文档](https://www.mathworks.com/help/matlab/math/matrix-indexing.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-12-17T09:05:00.880

这很简单。

它基本上从本示例中的第二个元素开始，以 2 为步长到第十个元素（按列）并删除相应的元素。其余元素产生一个行向量。

# django - Django admin 中的小 MCE 弹出窗口为空白

> ID：572025
> 
> 赞同：16
> 
> 时间：2009-02-21T02:58:03.223
> 
> 标签：django, django-admin, tinymce

我有 tinyMCE 在 django 管理员中工作，但所有弹出窗口都是空白的（例如，编辑 HTML，添加图像）

弹出 html 页面的路径都存在于正确的位置

```
http://thatch.media/js/tiny_mce/themes/advanced/source_editor.htm?mce_rdomain=thatch 
```

整个js文件夹的权限设置为777

这是我的模特

```
class Page(models.Model):
    title = models.CharField(max_length=200)
    ...

    class Admin:
        js = ('js/tiny_mce/tiny_mce.js', 'js/textareas.js') 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2011-09-13T21:36:19.960

我也遇到了这个问题，使用 Amazon S3 存储桶来存储包括 TinyMCE javascript 在内的静态媒体。

更明确地说，您的静态媒体必须位于主站点的子域中。因此，如果您的网站在 foo.bar.com 上运行——您的静态媒体必须在 static.foo.bar.com 之类的东西上——请注意 static.bar.com 和 static-foo.bar.com 不会好的。（如果您的网站在 bar.com 上，那么 static.bar.com 就可以了。）

因此，一旦您从子域中提供静态媒体（对于 S3，请参阅[Amazon S3：静态网站：自定义域或子域](https://stackoverflow.com/questions/5043616/amazon-s3-static-web-sites-custom-domain-or-subdomain)，这对我有帮助），然后您需要在 javascript 中的两个位置设置 document.domain：

1) 在 tiny_mce_popup.js

2) 在 tiny_mce.js 之前的任何其他内容，或者，在 tiny_mce.init() 调用发生之前的某个脚本标记中的主页渲染 HTML 中。（我发现破解 tiny_mce.js 并将其重新上传到 S3 比使用 django-tinymce 的小部件渲染更方便。）

您需要在两个地方都将 document.domain 设置为 MAIN SITE 的域：因此，对于 foo.bar.com 的站点，静态媒体位于 static.foo.bar.com，您需要设置 document.domain = " foo.bar.com"

这应该可以防止浏览器中出现任何安全异常，并且现在一切正常。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-04-13T23:19:11.800

我在 Heroku 上运行我的 django 应用程序并使用 Rackspace CDN 时遇到了这个问题。我的静态文件设置都设置为使用 rackspace CDN 共享文件

*   解决方案是使用普通静态文件服务于特定的 tinymce 文件：

    ```
    class Media:
    js = [
        '/static/grappelli/tinymce/jscripts/tiny_mce/tiny_mce.js',
        '/static/grappelli/tinymce_setup/tinymce_setup.js',
    ] 
    ```

在我的网址配置中：

```
urlpatterns += patterns('',
    url(r'^static/(?P<path>.*)$', 'django.views.static.serve', {
        'document_root': settings.STATIC_ROOT,
    }), 
```

)

static.serve 函数允许您在标准静态设置之外提供静态文件。您可以将 url conf 中的静态更改为您想要的任何内容。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-07-21T11:25:19.693

如果这是 TinyMCE 的 JQuery 版本，并且您正在从另一台服务器向运行 Django 的服务器提供媒体（包括 TinyMCE .js 文件），这可能适用：您的浏览器将阻止 TinyMCE 脚本访问 Django 管理员来自提供 TinyMCE 的域的 URL。Safari 的错误控制台是最明确的，例如：

```
Unsafe JavaScript attempt to access frame with URL http://127.0.0.1/~whatever/django-templates/javascript/tiny_mce/jscripts/more stuffhere/anchor.htm
from frame with URL http://127.0.0.1:8000/admin/flatpages/flatpage/1/.
Domains, protocols and ports must match. 
```

文件中有一个设置`tiny_mce_popup.js`说明：

```
// Uncomment and change this document.domain value if you are loading the script cross subdomains
// document.domain = 'moxiecode.com'; 
```

但这对我不起作用。您可以尝试打破规则并从 Django 服务器提供 TinyMCE 脚本，或者将脚本添加到修改后的管理模板的 HTML 中……但我确信有更好的解决方案。我没有耐心尝试，虽然我确定它已经完成，但我找不到让 TinyMCE 跨域工作的解决方案。

然而，由于用户可以使用可视化编辑器生成可怕的 HTML/内联 CSS 修改，其他解决方案可能会更好：[Textile](http://swik.net/Textile?popular)（Ruby 的 Redcloth 提供[可视化反馈](http://redcloth.org/)- 也许有基于[PyTextile](http://wiki.python.org/moin/PyTextile)或[Python-Textile](http://loopcore.com/python-textile/)的类似 Python 实现？？），或者[标记！](http://markitup.jaysalvat.com/examples/textile/)（JQuery，所以可能会出现同样的问题）它有一个很好的可视化编辑工具栏。

如果您怀疑这种[远离“类似文字”的编辑器的](http://redcloth.org/articles/wysi-dangerous-why-wysiwyg-editors-are-bad-for-your-website/)做法，<- 该链接是关于该问题的好文章。

[后记：在WMD](http://wmd-editor.com/demo)中有一个很好的 Markdown Javascript 实现，它提供了一个类似于 TinyMCE 的工具栏、语义标记样式（*所见即所得*- '所见即所得'）编辑器快捷方式。[GitHub 使用了相关的解决方案](http://github.github.com/github-flavored-markdown/preview.html)。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-02-10T15:27:56.623

我发现最好的解决方案是通过设置从项目根目录或媒体目录提供 tiny_mce 媒体：

```
TINYMCE_JS_URL = '%stiny_mce/tiny_mce.js' % MEDIA_URL 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-10T05:28:55.000

检查设置文件中的 MEDIA_URL。如果设置为非相对路径，即Django 推荐的[http://site.com/media_url，tiny_mce将弹出空白页面。](http://site.com/media_url)将此设置为相对路径，它应该可以工作。

有关详细信息，请参阅[http://pageworthy.com/blog/2009/mar/09/tiny_mce-blank-popups/ 。](http://pageworthy.com/blog/2009/mar/09/tiny_mce-blank-popups/)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2011-07-05T15:26:11.530

我遇到了空白弹出问题。就我而言，问题在于将它们放在另一个子域中。不确定是不是你的情况。

我通过编辑 tiny_mce_popup.js 并添加解决了

```
document.domain = window.location.hostname.replace('static.',''); 
```

当然用您的子域替换静态以获得“domain.com”字符串

然后在将 .tinymce(...) 附加到您的元素之前再次定义 document.domain。根据您所在的位置，您可以使用服务器端脚本或上面的相同代码。从这里的网站查看 wiki [http://tinymce.moxiecode.com/wiki.php/How-to_load_TinyMCE_crossdomain](http://tinymce.moxiecode.com/wiki.php/How-to_load_TinyMCE_crossdomain)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-21T03:58:13.423

我将媒体从[http://thatch.media](http://thatch.media)更改为[http://thatch/media](http://thatch/media) ，现在它可以工作了

也许与处于不同领域有关？

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-07-17T04:26:59.143

有同样的问题，我对所有 js / css 等都使用 Amazon S3，所以相对 url 不是一个选项。

为了使它工作，我不得不编辑 - tiny_mce_popup.js 和 tiny_mce.js，在顶部添加以下行：

```
document.domain = 'moxie.org'; 
```

希望这可以帮助 ...

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2015-08-14T18:17:09.170

我输入了您的答案，因为我遇到了同样的问题。第一个答案帮助我理解了问题，但没有解决它。

所以...您将代码上传到heroku，从那里尝试打开使用TinyMCE弹出窗口的.js，但是静态文件（因此弹出窗口使用的.js）被上传到另一个主机（在我的情况下S3)。

所以我调查了一下，发现了这个解决方案： [https](https://devcenter.heroku.com/articles/django-assets) ://devcenter.heroku.com/articles/django-assets 顺便说一句，它就像一个魅力，我的项目已经开始工作了！

所以，基本上，你所做的就是将你的静态文件和你的代码一起上传到同一个地方，这样你就不会违反同源策略。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-10-22T18:50:48.720

您还必须在配置文件中更改 tiny_mce_popups.js 中的 document.domain。此处描述了这些程序：

[http://wiki.moxiecode.com/index.php/TinyMCE:Cross_domain_loading](http://wiki.moxiecode.com/index.php/TinyMCE:Cross_domain_loading)

希望这有帮助。

# svn - SVN合并问题

> ID：572031
> 
> 赞同：6
> 
> 时间：2009-02-21T03:00:58.100
> 
> 标签：svn

我有一个受颠覆控制的目录。我创建了一个分支只是为了测试合并的东西。我拿了一个文件，将主干中的 X 行修改为“abc”，并在其分支中将同一行 X 修改为“def”。

然后，从分支工作目录我做了：

```
svn merge branchURL trunkURL . 
```

它在该行号将文件更新为内容为“abc”，即`svn update`如果我在同一个工作目录中完成它并且有人提交了“ def”在存储库中。

那么`svn merge`合并时只是替换内容而不带来任何冲突吗？

如果是这样，当一个人无法以某种方式合并以保持主干和分支中的更改时，从主干分支分支出项目目录的真正原因将毫无用处。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-21T15:43:01.887

你确实意识到了什么

```
svn merge branchUrl trunkUrl branchWorkingCopy 
```

实际上有，是吗？

这是一个翻译：

找出使 branchUrl 的内容与 trunkUrl 的内容相同所需的*一**组*更改。*现在在branchWorkingCopy*上执行这些更改。

 **您不会以这种方式合并任何冲突。但是，当您签入*branchWorkingCopy*时，您的分支将与您的主干相同，这几乎肯定不是您想要的。

如果您只想将选定的更改从*trunk*复制到*branch*，您需要告诉 Subversion您要复制*哪些更改并使用不同形式的合并命令：*

```
svn merge -r100:103 trunkUrl branchWorkingCopy 
```

这意味着：确定在中继上从 r100 到 r103 所需的更改集。在（分支的）工作副本上执行这些更改。请注意，此“更改集”将不包括 r100 所做的更改，因为这些更改被从**r99**到 r100 所需的更改集捕获。Subversion 中的修订范围是*半开*的。

另外，如果您还没有阅读[精美的手册，请考虑阅读。](http://svnbook.red-bean.com/en/1.5/svn.branchmerge.basicmerging.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-21T03:22:00.530

> 那么svn合并只是在合并时替换内容而不带来任何冲突吗？

嗯，不。我真的不能指出你做错了什么，但合并标志冲突与更新相同。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-21T03:25:40.850

我可能遗漏了一些东西，但是当我使用 svn merge 时，如果我希望它正常工作，我总是必须正确获取修订号。

因此，如果您在修订版 100 处分支（或最后合并），则主干当前位于 200，并且您希望将主干中的更改合并到您的分支中，然后在分支工作目录中执行以下操作：

```
svn merge -r 100:200 trunkURL 
```

然后我想你会看到一个冲突，你解决并签入。你在主干工作目录中做类似的事情，从你的分支合并回主干。

svn merge without -r 区分您指定的两个位置并将该差异应用于工作目录。所以我推测发生的事情是没有冲突，因为你的工作目录与分支的头部匹配。所以分支头和主干头之间的差异可以毫无问题地应用到您的工作目录中。这不是您想要做的：它所做的只是更改您的工作目录以匹配主干。尝试在分支上进行另一项更改，签入并重复该过程。如果合并撤消了该更改（因为它不在主干上），那么我对这种形式的 svn 合并是正确的，但正如我所说我没有使用它。

[编辑：在 svn 版本 1.5 之前...]

工作目录和分支在 SVN 中不是一回事，虽然很烦人，但您必须考虑差异。SVN 需要更多信息来执行您想要的分支合并，而不是进行更新或签入，因为 afaik 它不会自动考虑分支发生的位置，就像它始终考虑工作目录的签出位置一样。我确信这是有原因的，我只是不确定它是什么：可能是因为 svn copy 不仅仅用于分支。

[编辑...但是根据 Joshua McKinnon 对此答案的评论，从 1.5 开始，svn 支持正确的分支合并，它会自动执行您想要的操作。指定要合并的 URL，然后在要合并到的任何工作目录中运行命令。所以在这种情况下，试试

```
svn merge trunkURL 
```

你应该看到冲突。您可能必须先恢复工作目录。]

# objective-c - 在 Obj-c 中将秒转换为天、分钟和小时

> ID：572049
> 
> 赞同：26
> 
> 时间：2009-02-21T03:14:16.757
> 
> 标签：objective-c, time

在objective-c中，如何将整数（表示秒）转换为天、分钟、小时？

谢谢！

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2009-02-21T03:57:25.983

在这种情况下，您只需要划分。

```
days = num_seconds / (60 * 60 * 24);
num_seconds -= days * (60 * 60 * 24);
hours = num_seconds / (60 * 60);
num_seconds -= hours * (60 * 60);
minutes = num_seconds / 60; 
```

对于更复杂的日期计算，例如 1983 年 1 月 19 日下午 3 点之后的一千万秒内的天数，您可以使用 NSCalendar 类和 NSDateComponents。Apple 的日期和时间编程指南在这里为您提供帮助。

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2010-11-05T19:58:44.350

试试这个，

```
int forHours = seconds / 3600, 
remainder = seconds % 3600, 
forMinutes = remainder / 60, 
forSeconds = remainder % 60; 
```

并且您可以按照相同的程序使用它来获取更多详细信息，例如天、周、月和年

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2015-02-06T07:39:14.160

我知道这是一个旧帖子，但我还是想分享。以下代码是我使用的。

```
int seconds = (totalSeconds % 60);
int minutes = (totalSeconds % 3600) / 60;
int hours = (totalSeconds % 86400) / 3600;
int days = (totalSeconds % (86400 * 30)) / 86400; 
```

第一行 - 我们得到的秒数除以一分钟的秒数。

第二行 - 除以一小时内的秒数后，我们得到剩余的秒数。然后我们在一分钟内除以秒。

第三行 - 我们得到除以一天中的秒数后的剩余秒数。然后我们将其除以一小时的秒数。

第四行 - 我们得到秒除以一个月的秒数后的余数。然后我们将其除以一天中的秒数。我们可以只使用以下几天......

```
int days = totalSeconds / 86400; 
```

但是，如果我们使用上面的行并希望继续获得几个月，我们最终会得到 1 个月和 30 天，而我们只想获得 1 个月。

在 Xcode 中打开一个 Playground 并尝试一下。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2012-04-22T18:15:27.170

正如 Apple 在他们的文档中推荐的那样，objective-c 中最首选的方式可能是这种方式。

```
 NSDate *startDate = [NSDate date];
    NSDate *endDate = [NSDate dateWithTimeInterval:(365*24*60*60*3+24*60*60*129) sinceDate:startDate];

    NSCalendar *gregorian = [[NSCalendar alloc]
                             initWithCalendarIdentifier:NSGregorianCalendar];

    NSUInteger unitFlags = NSYearCalendarUnit | NSMonthCalendarUnit | NSDayCalendarUnit;
    NSDateComponents *components = [gregorian components:unitFlags
                                                fromDate:startDate
                                                  toDate:endDate options:0];
    NSInteger years = [components year];
    NSInteger months = [components month];
    NSInteger days = [components day]; 
    NSLog(@"years = %ld months = %ld days = %ld",years,months,days); 
```

确保不要检索未使用 unitFlags 定义的组件，整数将是“未定义”。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-03-16T06:37:03.350

使用内置函数 strftime()：

```
static char timestr[80];
char * HHMMSS ( time_t secs )
{
    struct tm ts;
    ts = *localtime(&secs);
    strftime(timestr, sizeof(timestr), "%a %b %d %H:%M:%S %Y %Z", &ts); // "Mon May 1, 2012 hh:mm:ss zzz"
    return timestr;
} 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2015-02-06T08:20:44.440

只需稍作修改即可兼容 32 位和 64 位。使用`NSInteger`系统会根据 32/64 位自动转换为 int 或 long。

```
NSInteger seconds = 10000;
NSInteger remainder = seconds % 3600;
NSInteger hours = seconds / 3600;
NSInteger minutes = remainder / 60;
NSInteger forSeconds = remainder % 60; 
```

通过同样的方式，您可以转换为天、周、月、年

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-10-18T11:29:10.183

这是我将秒数转换为秒数、分钟数和小时数的算法（仅使用总秒数和它们之间的关系）：

```
int S = totalSeconds % BaseSMH

int M = ((totalSeconds - totalSeconds % BaseSMH) % BaseSMH ^ 2) / BaseSMH

int H = (totalSeconds - totalSeconds % BaseSMH - ((totalSeconds - totalSeconds % BaseSMH) % BaseSMH ^ 2)) / BaseSMH ^ 2 
```

以下是我对它的解释：

测试时间转换为秒：HH:MM:SS = 02:20:10 => totalSeconds = 2 * 3600 + 20 * 60 + 10 = 7200 + 1200 + 10 = 8410

秒 -> 分钟和分钟 -> 小时之间的基数是 60（从秒 -> 小时是 60 ^ 2 = 3600）。

```
int totalSeconds = 8410
const int BaseSMH = 60 
```

每个单位（这里由一个变量表示）可以通过从总秒数中删除前一个单位（以秒表示）并将其除以秒与我们试图计算的单位之间的关系来计算。这是使用此算法的每个计算的样子：

```
int S = totalSeconds % BaseSMH

int M = ((totalSeconds - S) % BaseSMH ^ 2) / BaseSMH

int H = (totalSeconds - S - M * BaseSMH) / BaseSMH ^ 2 
```

与所有数学一样，我们现在可以将分钟和小时计算中的每个单位替换为我们计算前一个单位的方式，然后每个计算将如下所示（请记住，在 M 计算中除以 BaseSMH 并在 H 计算中乘以 BaseSMH 取消互相出局）：

```
int S = totalSeconds % BaseSMH

int M = ((totalSeconds - totalSeconds % BaseSMH) % BaseSMH ^ 2) / BaseSMH

int H = (totalSeconds - totalSeconds % BaseSMH - ((totalSeconds - totalSeconds % BaseSMH) % BaseSMH ^ 2)) / BaseSMH ^ 2 
```

使用上面的“totalSeconds”和“BaseSMH”进行测试将如下所示：

```
int S = 8410 % 60

int M = ((8410 - 8410 % 60) % 60 ^ 2) / 60

int H = (8410 - 8410 % 60 - ((8410 - 8410 % 60) % 60 ^ 2)) / 60 ^ 2 
```

计算 S：

```
int S = 8410 % 60 = 10 
```

计算 M：

```
int M = ((8410 - 8410 % 60) % 60 ^ 2) / 60 
= ((8410 - 10) % 3600) / 60 
= (8400 % 3600) / 60 
= 1200 / 60 
= 20 
```

计算 H：

```
int H = (8410 - 8410 % 60 - ((8410 - 8410 % 60) % 60 ^ 2)) / 60 ^ 2 
= (8410 - 10 - ((8410 - 10) % 3600)) / 3600
= (8400 - (8400 % 3600)) / 3600
= (8400 - 1200) / 3600
= 7200 / 3600
= 2 
```

有了这个，你可以添加你想要的任何单位，你只需要计算秒和你想要的单位之间的关系。希望你能理解我对每一步的解释。如果没有，请询​​问，我可以进一步解释。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2018-07-08T13:19:50.270

最初我制定了一个类似于鱼的答案的解决方案：

```
const secondsToString = s => {
  const secondsOfYear = 60 * 60 * 24 * 365;
  const secondsOfDay = 60 * 60 * 24;
  const secondsOfHour = 60 * 60;
  const secondsOfMinute = 60;

  let y = ~~(s / secondsOfYear);    s %= secondsOfYear;
  let d = ~~(s / secondsOfDay);     s %= secondsOfDay;
  let h = ~~(s / secondsOfHour);    s %= secondsOfHour;
  let m = ~~(s / secondsOfMinute);  s %= secondsOfMinute;

  y = (y > 0 ? (y + 'y ') : '');
  d = (d > 0 ? (d + 'd ') : '');
  h = (h > 0 ? (h + 'h ') : '');
  m = (m > 0 ? (m + 'm ') : '');
  s = (s > 0 ? (s + 's ') : '');

  return y + d + h + m + s;
}
```

我注意到它可以用数组`map()`和`reduce()`函数来概括，因为它包括一些迭代和递归。

```
const intervalToLevels = (interval, levels) => {
  const cbFun = (d, c) => {
    let bb = d[1] % c[0],
      aa = (d[1] - bb) / c[0];
    aa = aa > 0 ? aa + c[1] : '';

    return [d[0] + aa, bb];
  };

  let rslt = levels.scale.map((d, i, a) => a.slice(i).reduce((d, c) => d * c))
    .map((d, i) => ([d, levels.units[i]]))
    .reduce(cbFun, ['', interval]);
  return rslt[0];
};

const TimeLevels = {
  scale: [365, 24, 60, 60, 1],
  units: ['y ', 'd ', 'h ', 'm ', 's ']
};
const secondsToString = interval => intervalToLevels(interval, TimeLevels);
```

您可以轻松地将功能扩展`intervalToLevels()`到其他测量级别，例如液体质量、长度等。

```
const LengthLevels = {
  scale: [1760, 3, 12, 1],
  units: ['mi ', 'yd ', 'ft ', 'in ']
};
const inchesToString = interval => intervalToLevels(interval, LengthLevels);

const LiquidsLevels = {
  scale: [4, 2, 2, 8, 1],
  units: ['gal ', 'qt ', 'pt ', 'cup ', 'fl_oz ']
};
const ouncesToString = interval => intervalToLevels(interval, LiquidsLevels);
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-02-06T07:48:33.023

```
 SimpleDateFormat sdf = new SimpleDateFormat("MM/dd/yyyy HH:mm:ss");
    Date dateObj1=null;
    Date dateObj2=null;
    try {
        // String format = "MM/dd/yyyy hh:mm:ss";
        dateObj1 = sdf.parse(Appconstant.One_One_time);
        dateObj2 = sdf.parse(Appconstant.One_Two_time);
        Log.e(TAG, "dateObj12" + dateObj1.toString() + "---" + dateObj2.toString());
        DecimalFormat crunchifyFormatter = new DecimalFormat("###,###");
        long diff = dateObj2.getTime() - dateObj1.getTime();
        /*int diffDays = (int) (diff / (24 * 60 * 60 * 1000));
        System.out.println("difference between days: " + diffDays);
        int diffhours = (int) (diff / (60 * 60 * 1000));
        System.out.println("difference between hours: "
                + crunchifyFormatter.format(diffhours));
        int diffmin = (int) (diff / (60 * 1000));
        System.out.println("difference between minutes: "
                + crunchifyFormatter.format(diffmin));*/
        int diffsec = (int) (diff / (1000));
        System.out.println("difference between seconds:"
                + crunchifyFormatter.format(diffsec)); 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-10-05T06:55:29.563

您将从总秒数（self.secondsLeft）中获得天、小时、分钟和秒

```
days = self.secondsLeft/86400;
hours = (self.secondsLeft %86400)/3600;
minutes = (self.secondsLeft % 3600) / 60;
seconds = (self.secondsLeft %3600) % 60; 
```

代码 ......

```
 [NSTimer scheduledTimerWithTimeInterval: 1.0 target:self selector:@selector(updateCountdown) userInfo:nil repeats: YES];

-(void) updateCountdown {

    int days,hours,minutes,seconds;
    self.secondsLeft--;

    days = self.secondsLeft/86400;
    hours = (self.secondsLeft %86400)/3600;
    minutes = (self.secondsLeft % 3600) / 60;
    seconds = (self.secondsLeft %3600) % 60;

    NSLog(@"Time Remaining =%@",[NSString stringWithFormat:@"%02d:%02d:%02d:%02d",days, hours, minutes,seconds]);
} 
```

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2016-02-02T21:21:02.733

尝试执行以下操作：

```
 x=int(input("enter a positive integer: "))
    sec = int(x % 60);
    minu =int((x % 3600) / 60);
    ho =int((x % 86400) / 3600);
    days =int(x / (60 * 60 * 24));
    print(int(days),"days", ho,"hours", minu , "minutes" , sec ,"seconds" ) 
```

# android - ListView 中的焦点控件

> ID：572053
> 
> 赞同：3
> 
> 时间：2009-02-21T03:16:46.190
> 
> 标签：android, listview, focus

上下文：我想要一个不会获得焦点的 ListView（例如，当用户触摸它时不会突出显示行）。然而，每个行小部件都有自己的 OnClickListener。这是我在布局 xml 中指定的内容：

```
android:choiceMode="none" 
android:focusableInTouchMode="false"
android:focusable="false" 
```

ListView 的行为仍然完全相同。有人可以解释一下吗

1.  三者之间的相互关系
2.  创建没有获得焦点的 ListView 的正确方法是什么？

TIA。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-21T04:18:36.667

尽管您在 xml 中指定，但您也可以尝试在代码中指定。尽管我不确定您是否可以将列表设置为不可聚焦，但仍然可以使列表可滚动且可单击。

在你的 setContentView...

```
myListView.setFocusableInTouchMode(false); 
```

您也可以尝试从视图继承，然后在中间添加一些调试代码，以帮助您找到列表何时真正具有焦点。

```
 myListView.setOnFocusChangeListener(new OnFocusChangeListener(){

        public void onFocusChange(View v, boolean hasFocus)
        {
            v.setBackgroundColor(hasFocus ? Color.GRAY : Color.BLACK);
        }
    });

    myListView.setClickable(true); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-21T04:13:09.410

接收焦点的列表与未突出显示的选定行不同。只要用户在列表中，列表就会获得焦点。ListView 可以做的最好的事情是报告`int`用户选择的任何内容。我不确定每个行小部件如何拥有自己的 ClickListener。没有我知道的行小部件。`onListItemClick`属于ListView 。

我还没有弄明白，但是在调整 alpha 通道之间`android:listSelector`，`android:background`我想有一种方法可以使选择看起来就像一个未选择的行。

`android:listSelector="#8fff"`使它成为选择时的前景变化。

似乎android自己选择了未选择的前景，这使得这很难。我希望这有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-09T11:18:54.630

当用户触摸列表上的行时，您不能使用选择的 RadioButton 吗？

以下是我自己的代码的摘录。

```
// Create an adapter with a simple list item with single choice.
adapter = new ArrayAdapter<String>(this, android.R.layout.simple_list_item_single_choice, categories);

// Set the adapter to your list
listView.setAdapter(adapter); 
```

干杯!

# php - 在另一个应用程序中销毁会话变量

> ID：572070
> 
> 赞同：0
> 
> 时间：2009-02-21T03:24:15.173
> 
> 标签：php, session

我有两个应用程序，一个是前端应用程序，另一个是后端应用程序。

每个应用程序都有自己的相同用户数据库副本。当用户登录前端应用程序时，我也会同时使用后端应用程序提供的 Web 服务登录后端应用程序。

现在的问题是我是否可以从前端应用程序中销毁后端会话？后端使用 $_Session 超级全局数组来存储所有会话信息。如果是，如何？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-22T09:27:39.067

是的。

我假设您在正面和背面使用相同的会话 ID 名称。我认为默认是 PHP_SESSID。如果是这种情况，那么所有会话详细信息都将存储在一个位置。

我还假设前端和后端的域是相同的.. 如果它不同，那么它将无法工作，因为 Web 浏览器不会在不同域之间共享会话信息。

如果您对前端和后端使用不同的会话 ID 名称，那么您将不得不变得棘手。（两者的会话 ID 都将在请求数据中，您只需加载两个会话并销毁它们。）

采用：

```
session_destroy(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-21T03:34:42.153

您需要从数据库或文件中删除会话记录（取决于您的系统配置）。

系统可能默认使用基于文件的会话，您可以使用[session_save_path](http://us3.php.net/session_save_path)确定目录。几乎可以肯定，使用存储在数据库中而不是文件系统中的会话要容易得多。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-21T03:57:43.893

如果您可以使用后端应用程序公开的 Web 服务来登录用户，为什么不能也使用它来登录用户呢？这样一个应用程序就不必知道另一个应用程序是如何实现会话的（或者有特权可以在那里乱搞）。

如果这不可能，您将不得不按照 acrosman 的建议进行操作，并深入研究会话文件或数据库。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-21T04:51:17.803

您如何将前端会话与后端会话相关联？如果保留前后端会话的会话名称（用作会话 ID 的唯一值）的映射，则可以轻松找到后端会话（可以保存在文件或数据库中），然后删除会话记录。使用这一行来找出正在使用什么处理程序来存储会话文件：

```
$handler = init_get('session.save_handler'); 
```

您可以使用这一行来找出会话文件的存储位置：

```
 $path = ini_get('session.save_path'); 
```

然后您可以删除会话文件或数据库记录。

您还可以创建一个 Web 服务方法来销毁后端会话，然后从前端调用它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-22T08:08:41.317

如果这两个应用程序位于同一域的不同子域中，您可以保存一个 cookie，指示管理应用程序用户已注销。然后让管理应用程序本身删除会话和“注销”cookie。

# .net - 是否有 .Net 属性来防止调试器中的属性评估？

> ID：572082
> 
> 赞同：5
> 
> 时间：2009-02-21T03:30:07.890
> 
> 标签：.net, ide, frameworks, attributes

我已经在框架中看到了几个具有这种行为的类（监视窗口中的刷新符号和警告）。这是由属性控制的吗？如果是这样，我如何在我的库中模拟它？

**编辑：**感谢您的信息！为了澄清，我正在开发一个具有必须从单个线程访问数据的属性的框架。不幸的是，由于监视窗口等原因，当我在调试器中时，我遇到了一些奇怪的行为。我对 Debugger Browsable 属性有经验；但是，我更愿意在主线程访问/设置它们之后显示属性。我已经看到，尤其是在 IEnumerables 中，调试器不会在没有用户输入的情况下进行评估。...有没有办法将这些属性标记为需要“隐式评估”，或者我可以不吃蛋糕吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-21T03:47:31.467

这不受属性控制。这是调试器的固有特性。

此功能的根本原因是防止用户进行不需要的功能评估。Func Eval 是调试器中的一项危险操作，可能会导致显着减速或损坏程序状态。调试器非常注意确保它不会无意中执行可能会降低您的调试体验的额外函数评估。

如果 watch/locals/auto 窗口中的某个项目可能导致 func eval 并且调试器不认为应该发生 func eval，则该值将变灰，并且值列中将出现一个刷新按钮。单击该按钮告诉调试器，“不，我真的想评估那个表达式”。

在调试器中发生这种情况的原因有很多。以下2个是最有可能的。

**隐式属性评估被禁用**

工具 -> 调试器 -> 选项 -> 启用隐式属性评估

如果未选中此值，您是在告诉调试器请不要自动评估属性。引擎盖下的属性只是函数调用。它们通常比普通函数调用更安全，但并非总是如此。

但是您仍然可以通过直接在监视窗口中键入属性来强制评估属性。如果连续键入 2，第一个值将变为“陈旧”。这是因为在监视窗口中键入第二个表达式将导致所有其他表达式被重新计算。为什么？因为评估任何表达式的行为都可能改变其他表达式的结果。

因为隐式 func eval 已关闭，所以第一个属性不会自动评估，您必须强制它。

**功能评估和步骤**

如果将表达式添加到执行函数评估的监视窗口，然后执行单步操作，则该值将在监视窗口中“过时”。

这样做的原因有很多，但最有影响力的原因之一是提高性能。用户在监视窗口中键入许多表达式是很常见的，并且进行函数评估肯定并不罕见。一次一个，这些都不是很慢。但想象一下，您正试图快速浏览一些代码，并且在监视窗口中有 10 个 func eval。这会迅速增加并显着降低您的踏步体验。所以 func evals 不会自动重新评估。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-21T04:12:53.293

虽然这不会生成您所指的刷新图标，但一个非常有用的属性是 System.Diagnostics.DebuggerBrowsableAttribute，它允许您隐藏字段以防止在 Watch 窗口中显示。当字段和属性访问器重复并且它们不需要显示两次，或者如果属性执行一些实质性操作（如您的建议）并且您需要始终抑制它以便调试器不显示时，这很有用评估它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-22T04:28:40.753

这并不完全是您要查找的内容，但是如果您将该`[DebuggerStepThrough]`属性应用于属性的 getter/setter，它将阻止调试器中断该属性，除非在该行上明确设置断点。如果您想在知道可以安全评估后等待并设置断点，这可能很有用。`[DebuggerHidden]`如果你想把它从调试中隐藏起来，你也可以使用它。

# javascript - 需要帮助使用 java 脚本进行登录验证

> ID：572107
> 
> 赞同：1
> 
> 时间：2009-02-21T03:36:16.923
> 
> 标签：javascript

我在使用 javascript 进行登录验证时遇到问题。当用户没有提供任何用户名或密码时，弹出消息显示请输入用户名和密码。我希望当用户不提供用户名时弹出消息会出现请输入用户名，然后如果我按 OK 按钮光标应该进入 txtusername 文本框。如果密码也应该发生同样的事情，光标应该进入 txtpassword 文本框。但是在我的编程中，弹出消息来了，但是在按下 ok 按钮后光标没有放在预期的位置，请有人修改我的代码。这是我的代码。

```
<script type="text/javascript">
    //Function to check valid login
    function validLogin() {
        if (document.getElementById("TxtName").value == "") {
         alert("Please enter your UserName");
         return false;             
        }
        if (document.getElementById("Txtpassword").value == "") {
           alert("Please enter your Password");
         return false;
        }
        return true;
    } 
```

```
<asp:Button ID="BtnLogin" runat="server" Text="Login" onclick="BtnLogin_Click" OnClientClick="validLogin()"/> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-21T03:45:49.850

试试这个（假设你的意思是 TxtName，就像你的代码一样，而不是 TxtUsername，就像你的问题一样。

```
<script type="text/javascript">
    //Function to check valid login
    function validLogin() {
        var name = document.getElementById("TxtName");
        if (name.value == "") {
           alert("Please enter your UserName");
           name.focus();
           return false;             
        }
        var password = document.getElementById("Txtpassword");
        if (password.value == "") {
           alert("Please enter your Password");
           password.focus();
           return false;
        }
        return true;
    }
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-21T03:46:53.483

在您发出警报后使用 element.focus() 。IE

```
alert("please enter your UserName");
document.getElementById("UserName").focus(); 
```

# windows - 多行正则表达式并输出到 Windows 中的文件

> ID：572110
> 
> 赞同：0
> 
> 时间：2009-02-21T03:37:26.173
> 
> 标签：windows, regex, utilities

我有一个需要从中提取特定模式的日志文件。我需要找到它们，然后将它们处理成一个新文件。Linux 上的 grep 通常可以解决问题，但正则表达式跨越多行，我知道 grep 不会这样做。

这是我的日志/调试文件中的一个示例：

* * *

```
Da:
1.328   0.5045  

Db:
0.6415  0.1192  

Lambda:
0.4429  -0.35   
-0.0461 -0.02421    

seps:
0.714272 
```

* * *

我正在寻找`/Lambda:\n([-\d\.]+)\s+([\-\d\.]+)\s+\n([\-\d\.]+)\s+([\-\d\.]+)/` 然后我想将这些行输出到一个新文件中删除 lambda 并将数字重新排列到同一行以便输出`\1\s\2\s\3\s\4\n`

所以我实际上有两个问题：

1.  在任何系统上是否有一个简单的实用程序可以实现这一点？
2.  有没有办法专门在 Windows 上执行此操作？

我希望有一个简单的解决方案可以解决这个问题。我宁愿呆在 Windows 中，但如果我必须使用 Linux，我会完成这项工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-21T04:19:25.370

这是`awk`,`perl`和类似*状态解析*的一个很好的候选者（这些将在 Windows 中运行`CMD.EXE`，前提是你有`perl`和/或`awk/sed`在你的`PATH`，当然，在 Linux 和其他 unices 上）：

`awk "/^Lambda/ { in_lambda=1 ; next } in_lambda && /^ *$/ { in_lambda=0 ; printf \"\n\" ; next } in_lambda { printf \"%s \", $0 }" input_file >output_file`

*或者*

`perl -ne "chomp; if (/^Lambda/) { $in_lambda = 1 } elsif ($in_lambda && /^ *$/) { $in_lambda=0 ; printf \"\n\" } elsif ($in_lambda) { printf \"%s \", $_ }" input_file >output_file`

* * *

如果需要，您可以执行第二遍以规范化空白（并在行尾修剪空白）。

`awk "/^Lambda/ { in_lambda=1 ; next } in_lambda && /^ *$/ { in_lambda=0 ; printf \"\n\" ; next } in_lambda { printf \"%s \", $0 }" input_file`**`| sed -e "s: *: :g" -e "s: *$::" >output_file`**

*或者*

`perl -ne "chomp; if (/^Lambda/) { $in_lambda = 1 } elsif ($in_lambda && /^ *$/) { $in_lambda=0 ; printf \"\n\" } elsif ($in_lambda) { printf \"%s \", $_ }" input_file`**`| perl -ne "s/ +/ /g; s/ +$//g; print" >output_file`**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-21T04:07:45.460

您可以安装 Perl 或 Python 或 Ruby 或 PHP 并相当容易地编写脚本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-02T16:52:38.697

感谢所有的答案。我喜欢你给我的关于 perl 和 awk 的答案。我是那些不知道 perl 的奇怪程序员之一，所以我选择了 ruby​​ 路线。这是我的解决方案

```
x=ARGV[0]
f=File.new(ARGV[1])
g=File.new(ARGV[2],"w")
f.read.gsub(/#{x}:\s*(([\d\.\-]*\t*)+\n)+/ ){|entry|
    puts entry
    g.puts entry.gsub(/#{x}:\n/,'').gsub(/\s+/,"\t").strip
} 
```

据我所知，我可以通过 NppExec 将它用作我的编辑器 Notepad++ 的实用程序，它不支持重定向和管道。这也允许我收集我需要通过程序诊断的任何输出。再次感谢大家。

# iphone - NSDate 和 NSDateFormatter 问题

> ID：572132
> 
> 赞同：4
> 
> 时间：2009-02-21T03:41:02.607
> 
> 标签：iphone, objective-c, cocoa, cocoa-touch

我很难理解为什么以下代码会导致我的应用程序崩溃：

```
NSDateFormatter *dateFormatter = [[NSDateFormatter alloc] init];
[dateFormatter setDateFormat:@"MMMM d, yyyy"];
NSDate *date = [dateFormatter dateFromString:cDate];
datePicker.date = date;
NSString *dateStr = [dateFormatter stringFromDate:date]; 
[dateLabel setText:dateStr];
[dateFormatter release]; 
```

如果我将上述内容注释掉，则应用程序很好。此外，如果我将日期格式更改为以下，则不会发生崩溃：

```
[dateFormatter setDateFormat:@"yyyy-MM-dd"]; 
```

在我的`UIDatePicker`代表中，我重复了如下所示的代码（并且效果很好）：

```
-(IBAction)datePickerValueChanged:(id)sender 
{
    NSDate *date = [datePicker date];       
    NSDateFormatter *dateFormatter = [[[NSDateFormatter alloc] init] autorelease];
    [dateFormatter setDateFormat:@"MMMM d, yyyy"];
    NSString *dateStr = [dateFormatter stringFromDate:date]; 
    [dateLabel setText:dateStr]; 
} 
```

我得到的错误如下：

```
*** Assertion failure in -[UIDatePickerView _updateBitsForDate:andReload:animateIfNeeded:], /SourceCache/UIKit/UIKit-747.38/UIDatePicker.m:892

*** Terminating app due to uncaught exception 'NSInternalInconsistencyException', reason: 'Invalid parameter not satisfying: date' 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-21T03:50:13.020

问题是输入日期是“yyyy-MM-dd”格式，但是您使用 dateFromString 的日期格式化程序的格式是“MMMM d, yyyy”。如果您希望两种格式都被接受，则需要尝试使用这两种格式进行解析。

例如：

```
[dateFormatter setDateFormat:@"MMMM d, yyyy"];
NSDate *date = [dateFormatter dateFromString:cDate];
if (date == nil) {
    [dateFormatter setDateFormat:@"yyyy-MM-dd"];
    date = [dateFormatter dateFromString:cDate];
    if (date == nil) {
        // Handle the situation where the date string could not be parsed
    }
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-02-21T17:28:52.710

如果你的电话

```
NSDate *date = [dateFormatter dateFromString:cDate]; 
```

失败，日期为 NULL。

这没有写在文档中。

# java - 如何从代码库中删除 System.out.println

> ID：572134
> 
> 赞同：10
> 
> 时间：2009-02-21T03:41:08.333
> 
> 标签：java, performance, scripting, code-cleanup

我们有一个巨大的（旧的遗留 Java）代码库，其中许多文件（大约 5k）都有 System.out.println。出于清理/性能原因，我们计划删除它们。我们如何编写一个脚本来替换它们而不在代码中引入任何问题？该脚本不能盲目地删除它们，因为以下情况可能是一个问题：

```
if ()
  some.code...
else
  System.out.println(...);
DB.close(); 
```

我正在考虑用';'替换它们。这将处理上述情况。你看到其他问题了吗？还有其他建议吗？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-02-21T03:58:18.900

您是否考虑过这种愚蠢的情况：

```
System.out.println(" Print " +  object.changeState() ); 
```

我不认为它会发生，但是 println 执行的方法很可能实际上正在执行系统所依赖的某些操作，并且可能会引入细微的错误（信不信由你，但我已经目睹了这一点）

可能替换为记录器并禁用记录器可能会这样做。

或者使用 NullObject 模式创建一个空对象：

```
public final class DevNull { 
    public final static PrintStream out = new PrintStream(new OutputStream() {
        public void close() {}
        public void flush() {}
        public void write(byte[] b) {}
        public void write(byte[] b, int off, int len) {}
        public void write(int b) {}

    } );
} 
```

并更换

```
 System.out.println(); 
```

和

```
 DevNull.out.println(); 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-02-21T04:12:35.980

Log4E 是一个具有“替换 System.out.println()”功能的 Eclipse 插件。它会愉快地将所有那些讨厌的 println 调用转换为 log4j 调用。它甚至会用日志级别检查来包装它们。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-02-21T10:09:17.603

扩展 Oscar 的概念，您可以做得更好恕我直言：

```
if(!DEBUG) {
    System.setOut(
        new PrintStream(new OutputStream() {
            public  void    close() {}
            public  void    flush() {}
            public  void    write(byte[] b) {}
            public  void    write(byte[] b, int off, int len) {}
            public  void    write(int b) {}

        } );
    }
} 
```

在这种情况下，如果您未处于调试模式或任何其他模式，默认系统输出将在内部替换为 devNull 实现，否则它会按预期工作。这样您就不必在代码中查找和替换任何内容。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-02-21T04:14:22.713

您可以通过调用 Systems.setOut 并传入您自己的 OutputStream 开始，它什么都不做。这将帮助您查看是否有性能提升。这比删除它们更安全（因为 Oscar 指出的原因 - 副作用编码）。如果性能提升可以忽略不计，那么您可能希望将精力集中在其他地方。

我的上述方法有两个问题：

1.  您想保留的任何 System.out.printlns 也会消失
2.  字符串连接仍然会发生（这可能会很昂贵，具体取决于有多少）

然而，这是一个很好的快速测试，看看您是否获得了您正在寻找的性能提升。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-02-21T04:09:47.110

您可以使用[条件编译](http://www.javapractices.com/topic/TopicAction.do?Id=64)来进行带有打印语句的调试构建和没有它们的发布构建。

基本上，这个想法是创建一个具有最终静态布尔值的最终静态类，您可以在编译时将其用作开关。

```
public final class Debug {
   //set to false to allow compiler to identify and eliminate
   //unreachable code
   public static final boolean ON = true;
} 
```

然后您可以将所有`System.out.println`语句替换为

```
if(Debug.ON)
{
    System.out.println...
} 
```

由于编译器将忽略任何无法访问的代码分支，因此您可以`ON = false`在进行发布构建时进行设置，打印语句将从您的字节码中排除。

**注意：**这不涉及[Oscar](https://stackoverflow.com/questions/572134/how-to-remove-system-out-printlns-from-codebase/572222#572222)指出的情况，即 print 语句可能会更改某些对象的状态。正如他所建议的，您可以在发布模式下使用条件编译打印到空对象，而不是完全删除打印件。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-21T03:45:40.020

我个人会`{}`改用，但我认为它的工作原理是一样的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-21T08:41:26.097

我在 perl 中编写了一个正则表达式，将字符串“System.out.println”替换为“;//System.out.println”。我相信很少有这种情况会破坏构建。它只会变成一个“else ;”，它被编译成零字节码指令。

看起来这就是你所提议的。它对我有用——除非你在同一行有其他语句。然而，这是一种糟糕的风格（我知道我没有那样做）。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-21T13:37:53.890

您是否考虑过编辑这些源文件以删除这些行？

您可能会发现开发人员只需几天时间就可以摆脱其中的大部分。我们遇到了类似的问题，我刚刚起得很早，检查了我们所有的文件以清除垃圾。

我使用 Eclipse 和清理保存功能同时清理导入和内容。

这是一件非常有治疗作用的事情！

# asp.net - 美化 ASP.NET 标记

> ID：572138
> 
> 赞同：2
> 
> 时间：2009-02-21T03:41:29.970
> 
> 标签：asp.net, webforms

因此，我的个人网站在我编写的自定义博客引擎上运行，我对此非常满意。但是，它使用母版页，这意味着 ASP.NET 将（无缘无故）“ct100”添加到所有 id ......例如：

```
<div id='menu'>
   <ul>
    <li id="ctl00_homeTab" class="active"><a href="/">Home</a></li>
    <li id="ctl00_codeTab"><a href="/code/">Code / Projects</a></li>
    <li id="ctl00_aboutTab"><a href="/about/">About Me</a></li>
    <li id="ctl00_contactTab"><a href="/contact/">Contact</a></li>
  </ul>
</div> 
```

我想稍微美化一下标记，然后去掉它们，或者至少将它们重命名为更有意义的东西。由于 Webforms 是相当可插拔的，我想有一种方法可以做到这一点。我知道内容占位符充当命名容器，但在我的情况下，我只想有一个像样的 id，'master' 而不是 'ct100' 将是一个开始。

虽然我很愚蠢和肛门，但我想做的另一件事是在使用 UserControls 时修复标记的缩进。如果您查看[我的网站](http://gfilter.net)，您会发现用户控件没有缩进并中断了源代码的流动。如果不通过漂亮的打印机运行页面输出，这可能无法解决……那将是浪费时间。

**不要告诉我切换到 MVC。我已经对其进行了评估，并将坚持使用 Webforms。**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-21T03:49:40.060

老实说，我看不到为最少的标记美化而进行大量工作的好处……尽管我以某种奇怪的方式钦佩您的愿望。

您的网站看起来不错 - 将精力放在浏览器中实际呈现的内容和最终用户的功能上。:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-21T15:15:51.843

尽管此时 proberly 对您没有多大用处，但 ASP .NET 的下一个版本将允许您对控件的输出 ID 进行更多控制。

在这篇博文中有一些很好的信息......

[http://www.mostlylucid.net/archive/2008/11/03/way-too-much-information-on-control-ids-and-asp.net-4.0.aspx](http://www.mostlylucid.net/archive/2008/11/03/way-too-much-information-on-control-ids-and-asp.net-4.0.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-21T04:06:13.560

这些控件前缀是 ASP.NET 在页面上查找控件的方式，因为......如果我没记错的话...... viewstate / postback。我也讨厌这些前缀，但是 ASP.NET 生成的 JavaScript 需要它们。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-21T19:32:11.650

是的，您可以通过使用 ASP .NET 2.0 控制适配器来做到这一点。控件适配器允许您修改现有服务器控件输出其代码的方式，而无需更改 ASPX 文件中的任何代码。你可以在这里看到它是如何完成的：

[http://weblogs.asp.net/scottgu/archive/2006/11/29/tip-trick-use-the-asp-net-2-0-css-control-adapters-for-css-friendly-html-输出.aspx](http://weblogs.asp.net/scottgu/archive/2006/11/29/tip-trick-use-the-asp-net-2-0-css-control-adapters-for-css-friendly-html-output.aspx)

适配器的设计初衷是允许通过 .NET 控件轻松使用 CSS 来重新渲染表格，但它也可以用于您的目的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-21T04:23:10.150

我想你可以连接一个[ResponseFilter](http://www.google.com/search?rlz=1C1GGLS_en-USUS295US303&sourceid=chrome&ie=UTF-8&q=Response.Filter)来美化......祝你好运。;)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-21T18:30:48.367

[CSS 友好的控制适配器](http://www.asp.net/CssAdapters/)？我在多个项目中使用它们并且对它们非常满意。他们甚至可以很好地转换为 3.0、3.5。

[菜单适配器](http://www.asp.net/CSSAdapters/Menu.aspx)完全符合您的要求。

# regex - Perl 正则表达式：如何抓取相同的部分

> ID：572160
> 
> 赞同：2
> 
> 时间：2009-02-21T03:45:36.200
> 
> 标签：regex, perl, pcre

我正在为一些游戏创建天梯系统，但遇到了关于氏族基础系统的问题。你看，每个加入的玩家都会被解析并放入玩家表中。像这样：

```
chelsea | gordon 
chelsea | jim
chelsea | brad 
```

或者...

```
CLANTAG|> jenna
CLANTAG|> jackson
CLANTAG|> irene 
```

所以，我想要的是：我想抓住 CLANTAG，它在同一个地方，并且在那个团队中的每个球员的名字都相同。但是，分隔符可以是从空白到无的任何内容（clan player1、clan player2 或 clanplayer1、clanplayer2）。

关于如何做到这一点的任何想法？

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-21T05:37:57.537

这是一个镜头：

```
use strict;
use warnings;

my($strip) = shift || 0;

print FindTeamName("TEAMJimBob", "TEAMJoeBob", "TEAMBillyBob"), "\n";
print FindTeamName("TEAM|JimBob", "TEAM|JoeBob", "TEAM|BillyBob"), "\n";
print FindTeamName("TEAM | JimBob", "TEAM | JoeBob", "TEAM | BillyBob"), "\n";
print FindTeamName("TEAMJimBob", "TEAM|JoeBob", "TEAM - BillyBob"), "\n";

sub FindTeamName
{
    my(@players) = @_;

    my($team) = shift;
    foreach my $player (@players) {
        $team = FindCommonString($team, $player);
    }

    $team =~ s{\W+$}{} if $strip;

    $team;
}

sub FindCommonString
{
    my($str1, $str2) = @_;

    my(@arr1) = split(//, $str1);
    my(@arr2) = split(//, $str2);

    my($common) = "";

    while (@arr1 && @arr2) {
        my($letter1) = shift(@arr1);
        my($letter2) = shift(@arr2);

        if ($letter1 eq $letter2) {
            $common .= $letter1;
        }
        else {
            last;
        }
    }

    $common;
} 
```

这给出了以下内容：

```
C:\temp>perl test.pl
TEAM
TEAM|
TEAM |
TEAM

C:\temp>perl test.pl 1
TEAM
TEAM
TEAM
TEAM

C:\temp> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-21T04:01:55.943

在这里乱砍一刀，这就是你想要的吗？

```
#! /usr/bin/perl

use strict;
use warnings;

while (<DATA>)
{
  if (/^(\w+) \| (\w+)$/     ||
      /^\[(\w+)\] \. (\w+)$/ ||
      /^(\w+)-(\w+)$/)
  {
    print "tag=$1, name=$2\n";
  }
}

exit 0;

__DATA__
team1 | foo
team1 | bar

[another] . user
[another] . player

more-james
more-brown 
```

因为它生成：

```
tag=team1, name=foo
tag=team1, name=bar
tag=another, name=user
tag=another, name=player
tag=more, name=james
tag=more, name=brown 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-21T04:42:28.497

编辑：重新阅读问题和评论..

这适用于示例，但可能不适用于带有空格或标点符号的名称，以及可能的其他情况：

```
while ( <DATA> )
{
    if ( /(\w+).*?(\w+)$/ )
    {
        print "$1, $2\n";
    }
}

__DATA__
team1 | foo
team1 | bar

[another] . user
[another] . player

more-james
more-brown 
```

给出：

```
team1, foo
team1, bar
another, user
another, player
more, james
more, brown 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-21T05:24:36.837

如果您一次只对一个玩家的名字运行正则表达式，我建议：

```
/(\w+)\W+(\w+)$/ 
```

在英语中，这意味着“至少一个单词字符，后跟至少一个非单词字符，后跟至少一个单词字符，然后是行尾”

“单词字符”是字母、数字和下划线。因此，如果人们在他们的标签/昵称中使用了这些字符以外的任何内容，则需要对其进行修改。例如，如果人们的昵称中可能还有连字符，您需要：

```
/(\w+)\W+([\w-]+)$/ 
```

据我所知，人们总是使用标点符号（和/或空格）来区分他们的氏族和他们的昵称，所以 \W+ 应该没问题。

至于你给出的没有分隔符的情况（clanplayer1，clanplayer2），如果不查看你知道在同一个氏族中的多个玩家的名字，并弄清楚他们的名字从什么时候开始不同，就没有办法解决这个问题，所以它不能单独使用正则表达式来解决。

# javascript - 从原型转换为 jquery

> ID：572161
> 
> 赞同：2
> 
> 时间：2009-02-21T03:45:37.587
> 
> 标签：javascript, jquery, ajax, prototypejs

我正在尝试从从 mysql 数据库获取数据的 php 文件中对 div 进行简单的 ajax 更新。一个函数填充 div，另一个函数将消息添加到数据库并在单击提交按钮时调用。我想知道是否有人可以在 jquery 中给我他们的等价物。以下是原型版本。

```
<script>
function getMessages(){
  new Ajax.Updater('chat','messages.php', {
    onSuccess:function(){
      window.setTimeout( getMessages, 3000 );
    }
  });
}
getMessages();
</script>

<script>
function addmessage(){
  new Ajax.Updater('chat','add.php',{
    method:'post',
    parameters: $('chatmessage').serialize(),
    onSuccess: function() {
      $('messagetext').value = '';
    }
  });
}
</script> 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-21T03:53:18.240

[jQuery .ajax()](http://docs.jquery.com/Ajax)调用完成了这一切。它具有带有较少参数的包装器，例如 .get()、.post() 和 .load()，您可以使用它们来减少冗长的语法。

您没有提及您返回的数据的格式。您需要在 .ajax() 调用中指定。大致：

```
function addMessage(message) {
  $.ajax({
    url: 'add.php',
    success: function() {
      $("#chatmessage").text('');
    },
    error: function() { ... },
    timeout: 3000,
    data: {
      message: message
    } 
  });
 }

function getMessages() {
  $.ajax({
    url: 'messages.php',
    dataType: 'html',
    timeout: 3000,
    error: function() { ... },
    success: function(data) {
      $("#messages").html(data);
    }
  });
} 
```

**注意：** dataType 参数只需要匹配脚本生成的任何内容。如果messages.php 生成了一个HTML 消息列表，那么将它的dataType 设置为“html”。如果是这种情况，您还可以将代码简化为：

```
function getMessages() {
  $("#messages").load("message.php");
} 
```

**注意：** load() 函数只是 .ajax() 的包装。如果您需要设置超时、错误处理等内容，请使用 .ajax()。例如：

```
<div id="messages"></div>
<input type="button" id="getmessages" value="Get Messages">
...
<script type="text/javascript">
$(function() {
  $("#getmessages").click(function() {
    $(this).attr("disabled", "true");
    $.ajax({
      url: 'message.php',
      dataType: "html",
      timeout: 5000,
      error: function() {
        alert("Error talking to server.");
        $(this).attr("disabled", "false");
      },
      success: function(data) {
        $("#messages").html(data);
        $(this).attr("disabled", "false");
      }
    });
  });
});
</script> 
```

以上是一个更完整的示例，应该让您了解可以使用额外参数的用途。如果您不需要它们，只需使用速记版本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-21T03:55:21.853

```
$.ajax({
    type: "GET",
    url: "messages.php",
    data: "name=John&location=Boston",
    success: function(){
        window.setTimeout(getMessages,3000);
    }
}); 
```

对于第二个添加消息

```
$.ajax({
    type: "POST",
    url: "add.php",
    data: $('#chatmessage').param(),
    success: function() {
        $('messagetext').value = '';
    }
}); 
```

有关更多详细信息，请查看[http://docs.jquery.com/Ajax](http://docs.jquery.com/Ajax)

# javascript - 将文本悬停在从 Firefox 工具栏插件创建的鼠标上

> ID：572203
> 
> 赞同：0
> 
> 时间：2009-02-21T03:53:06.400
> 
> 标签：javascript, firefox, firefox-addon, xul

我正在创建一个 firefox 插件，我遇到这样一种情况，如果有人单击我的工具栏按钮菜单弹出窗口中的特定项目，我想在鼠标旁边显示一些文本几秒钟。我不是指鼠标悬停文本，因为当他们单击该项目时，我会关闭菜单弹出窗口。我的意思是类似于此站点上显示的内容：

[http://www.kingsquare.nl/cursormessage](http://www.kingsquare.nl/cursormessage)

执行此操作的正常方法是使用 javascript 和一个包含我要显示的文本的 div。不幸的是，我发现工具栏按钮无法对主窗口产生影响，这是我需要放置要显示的 div 的地方。我试过让 Jquery 工作，但也没有成功。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-01T11:17:35.120

您可以将面板与 openPopup() 和 hidePopup() 一起使用。请记住在面板上将属性 noautohide 设置为 true。

有关面板的更多信息 - [https://developer.mozilla.org/en/XUL/panel](https://developer.mozilla.org/en/XUL/panel)

# bash - 如何检查 Bash 中是否存在某些文件？

> ID：572206
> 
> 赞同：7
> 
> 时间：2009-02-21T03:53:29.737
> 
> 标签：bash, shell, error-handling

在`bash`脚本中，我必须检查是否存在多个文件。

我知道一种尴尬的方法，如下所示，但这意味着我的主程序必须位于那个丑陋的嵌套结构中：

```
if [ -f $FILE1 ]
then
if [ -f $FILE2 ]
then
  echo OK
  # MAIN PROGRAM HERE
fi
fi 
```

以下版本不起作用：

```
([ -f $FILE1 ] && [ -f $FILE2 ]) ||  ( echo "NOT FOUND"; exit 1 )
echo OK 
```

它打印

```
NOT FOUND
OK 
```

有没有一种优雅的方法可以做到这一点？

**更新：**查看接受的答案。此外，就优雅而言，我喜欢[Jonathan Leffler 的回答](https://stackoverflow.com/questions/572206/bash-how-do-i-check-if-certain-files-exist/572546#572546)：

```
arg0=$(basename $0 .sh)
error()
{
    echo "$arg0: $@" 1>&2
    exit 1
}

[ -f $FILE2 ] || error "$FILE2 not found"
[ -f $FILE1 ] || error "$FILE1 not found" 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-21T03:59:02.877

怎么样

```
if [[ ! ( -f $FILE1 && -f $FILE2 ) ]]; then
    echo NOT FOUND
    exit 1
fi

# do stuff
echo OK 
```

参见`help [[`和`help test`可用于`[[`样式测试的选项。另请阅读[此常见问题解答条目](http://mywiki.wooledge.org/BashFAQ/031)。

您的版本不起作用，因为`(...)`生成了一个新的子 shell，在其中`exit`执行。因此它只影响该子shell，而不影响执行脚本。

下面的工作代替，`{...}`在当前 shell 中执行命令。

我还应该注意，您必须引用这两个变量以确保没有不必要的扩展或分词（它们必须作为一个参数传递给`[`）。

```
[ -f "$FILE1" ] && [ -f "$FILE2" ] || { echo "NOT FOUND"; exit 1; } 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-21T03:59:17.557

我想你正在寻找：

```
if [ -f $FILE1 -a -f $FILE2 ]; then
    echo OK
fi 
```

有关`man test`可以放入`[ ]`.

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-21T04:03:32.833

您可以列出文件并循环检查它们：

```
file_list='file1 file2 wild*'
for file in $file_list; do
    [ -f $file ] || exit
done

do_main_stuff 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-21T06:47:04.627

我通常在以下情况下使用变体：

```
arg0=$(basename $0 .sh)
error()
{
    echo "$arg0: $@" 1>&2
    exit 1
}

[ -f $FILE2 ] || error "$FILE2 not found"
[ -f $FILE1 ] || error "$FILE1 not found" 
```

使 shell 脚本只有一个退出点并没有什么特别的好处——也没有什么坏处，但是致命的错误也可能会终止脚本。

唯一的争论点是在退出之前是否诊断尽可能多的问题，或者是否只诊断第一个问题。平均而言，仅诊断第一个要容易得多。

# php - HTML 表单：如何添加多个传递不同值的按钮？

> ID：572229
> 
> 赞同：1
> 
> 时间：2009-02-21T03:59:45.917
> 
> 标签：php, html, forms

我有一个允许发布新闻的脚本。我希望能够在“发布”按钮旁边创建一个“另存为草稿”按钮。如何允许“另存为草稿”按钮将值传递到后端？

我只需要一个简单的 1 或 0，具体取决于按下哪个按钮，顺便说一下，我正在使用 php。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-21T04:03:23.067

```
<input type="submit" name="saveasdraft" value="Save as Draft">
<input type="submit" name="save" value="Save"> 
```

然后你可以通过他们的名字检测在后端按下了哪个按钮。按下的那个将出现在提交的表单字段中。其他人不会。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-21T04:02:06.003

您可以使用多个表单元素。

# version-control - 什么是最好的三向合并工具？

> ID：572237
> 
> 赞同：299
> 
> 时间：2009-02-21T04:03:42.053
> 
> 标签：version-control, merge, dvcs

Subversion、Git、Mercurial 和其他支持三向合并（结合我的、他们的和“基本”修订版）并支持图形工具来解决冲突。

你用什么工具？Windows、Mac OS X、Linux，免费或商业，应有尽有。

以下是我使用或听说过的一些，只是为了开始对话：

*   [KDiff3](http://kdiff3.sourceforge.net/)
*   [差异合并](http://www.diffmerge.net/)
*   [P4合并](https://www.perforce.com/products/helix-core-apps/merge-diff-tool-p4merge)
*   [融合](http://en.wikipedia.org/wiki/Meld_%28software%29)
*   超越比较专业版。

（我认识到这有点像[Best Diff Tool](https://stackoverflow.com/questions/12625/best-diff-tool "最佳差异工具")，但不同之处在于我明确关注三向合并工具；例如， [WinMerge](http://en.wikipedia.org/wiki/WinMerge)不在列表中。）

* * *

## 回答 #1

> 赞同：180
> 
> 时间：2009-10-20T08:08:59.550

[KDiff3](https://github.com/KDE/kdiff3) 开源，跨平台

Linux 和 Windows 界面相同，非常智能的冲突解决算法，自动解决冲突的正则表达式，与 ClearCase、SVN、Git、MS Visual Studio 集成，可编辑合并文件，比较目录

它的键盘导航很棒：ctrl-arrows 导航差异，ctrl-1、2、3 进行合并。

另请参阅[https://stackoverflow.com/a/2434482/42473](https://stackoverflow.com/a/2434482/42473)

![在此处输入图像描述](https://i.stack.imgur.com/tkQup.png)

* * *

## 回答 #2

> 赞同：110
> 
> 时间：2009-05-12T23:26:23.977

刚刚查看了**[P4merge](https://www.perforce.com/downloads/visual-merge-tool)**，因为我在另一篇博客文章中听说过它：

![在此处输入图像描述](https://i.stack.imgur.com/I3iJs.gif)

非常流畅的界面，而且免费！我一直是 Araxis Merge 的忠实用户，但考虑到这是免费且很棒的，我鼓励您检查一下。

* * *

## 回答 #3

> 赞同：100
> 
> 时间：2009-02-21T04:06:18.397

[Beyond Compare 3 Pro](http://www.scootersoftware.com/)支持[三向合并](http://en.wikipedia.org/wiki/Merge_%28revision_control%29#Three-way_merge)，是一款相当不错的合并工具。它是商业的（但值得，恕我直言），可在 Windows、Linux 和 Mac OS X 上使用。

正如评论中指出的那样，它也很便宜。

![在此处输入图像描述](https://i.stack.imgur.com/GtHxc.jpg)

注意：如果没有合并集，即目标文件中的合并标记，Beyond Compare 不提供三向文件比较/编辑。Beyond Compare[表示该功能在他们的列表中](http://www.scootersoftware.com/vbulletin/showthread.php?t=7834)。

注意：3 路合并是 Beyond Compare 3 专业版中的一项功能

* * *

## 回答 #4

> 赞同：83
> 
> 时间：2009-02-21T05:20:45.817

**[融合差异查看器](http://meld.sourceforge.net/)**

我只有与 Meld 合作的好经历。当我必须在分支之间进行杂乱的代码合并时，我会使用它。它使用简单，界面简洁。

*   开源
*   支持 Linux、Windows 和 MacOS
*   多文件差异
*   三向比较支持

在 Ubuntu 中，安装非常简单：`sudo apt-get install meld`

![在此处输入图像描述](https://i.stack.imgur.com/xOqZe.png)

* * *

## 回答 #5

> 赞同：51
> 
> 时间：2009-02-21T04:09:33.163

vimdiff。这很棒。你所需要的只是一个三英尺宽的窗户。

![在此处输入图像描述](https://i.stack.imgur.com/VzBKL.png)

* * *

## 回答 #6

> 赞同：37
> 
> 时间：2009-02-21T04:45:08.053

[源齿轮差异合并](http://www.sourcegear.com/diffmerge/)：

跨平台、真正的三向合并，完全免费用于商业或个人用途。

![在此处输入图像描述](https://i.stack.imgur.com/HiMyn.png)

* * *

## 回答 #7

> 赞同：33
> 
> 时间：2009-02-21T06:41:06.653

[Araxis 合并](http://www.araxis.com/)。它是商业的，但它非常值得……它适用于 Windows 和 Mac OS X。

![在此处输入图像描述](https://i.stack.imgur.com/5gphg.jpg)

* * *

## 回答 #8

> 赞同：32
> 
> 时间：2010-03-12T17:17:41.560

Kdiff3 冲突解决算法确实令人印象深刻。

即使颠覆表明存在冲突，Kdiff3 也会自动解决它。有相同界面的 Windows 和 Linux 版本。可以将它与 Tortoise 和你的 linux shell 集成。

它在我最喜欢的开源软件列表中。我在任何机器上安装的首批工具之一。

您可以将其配置为 Subversion、Git、Mercurial 和 ClearCase 中的默认差异工具。它还解决了几乎所有的 ClearCase 冲突。在 Windows 中，它与 Windows 资源管理器有很好的集成：选择两个文件并右键单击以比较它们，或者右键单击“保存到以后”一个文件，然后选择另一个进行比较。

合并后的文件是可编辑的。有流畅的键盘快捷键。

您还可以使用它比较和合并目录。看： ![Kdiff3 比较目录](https://i.stack.imgur.com/yaxlF.png)

一个高级功能是使用正则表达式来定义自动合并。

我唯一的烦恼是，如果你最喜欢的发行版存储库中没有它，编译起来会有点困难。

* * *

## 回答 #9

> 赞同：13
> 
> 时间：2009-02-21T04:06:26.337

[超比较](http://www.ultraedit.com/products/ultracompare.html)。真的很好，可以很好地处理大文件（超过 1 GB），适用于 Windows/Mac/Linux，而且它是商业的，但它是值得的。

![Windows 上 UltraCompare Professional 的屏幕截图](https://i.stack.imgur.com/sG8BW.png)

* * *

## 回答 #10

> 赞同：13
> 
> 时间：2009-02-21T05:51:22.090

我[爱埃迪夫](http://www.emacswiki.org/cgi-bin/wiki/EdiffMode)。它内置于[GNU Emacs](http://en.wikipedia.org/wiki/Emacs)中。

要进行三向比较，请使用`ediff-files3`（用于选择三个文件）或`ediff-buffer3`（用于选择三个已打开的缓冲区）。您将看到如下所示的屏幕：

[![emacs中的三向差异](https://i.stack.imgur.com/Ese8k.png)](https://i.stack.imgur.com/Ese8k.png)

*注意单词差异突出显示。*

您可以点击`n`或`p`转到下一个/上一个差异，同时`ab`将区域从缓冲区 a（最左边的一个）复制到缓冲区 b（中间的一个），对于 , , 的其他两个字母组合`a`也是`b`如此`c`；`rb`将恢复缓冲区 b 中的区域。点击`?`快速帮助菜单，或[阅读 Emacs 中 diff3 合并的精美手册](https://www.gnu.org/software/emacs/manual/html_node/ediff/Merging-and-diff3.html)。

* * *

## 回答 #11

> 赞同：12
> 
> 时间：2009-02-25T01:50:33.183

[Diffuse](http://diffuse.sourceforge.net/)是一个易于使用的三向合并工具。它支持您提到的所有平台和版本控制系统，并且可以同时比较三个以上的文件。

![在此处输入图像描述](https://i.stack.imgur.com/g2LH6.png)

* * *

## 回答 #12

> 赞同：6
> 
> 时间：2009-02-21T04:32:09.007

[xxdiff](http://furius.ca/xxdiff/)如果你在 Linux 领域。

![在此处输入图像描述](https://i.stack.imgur.com/02ywE.jpg)

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2011-04-22T01:18:58.097

总结是我发现 ECMerge 是一个很棒的商业产品。[http://www.elliecomputing.com/products/merge_overview.asp](http://www.elliecomputing.com/products/merge_overview.asp)

[![在此处输入图像描述](https://i.stack.imgur.com/Hm3IZ.png)](https://i.stack.imgur.com/Hm3IZ.png)

我也同意 MrTelly 的观点，即 Ultracompare 非常好。一个不错的功能是它会比较 RTF 和 Word 文档，当您最终与销售人员进行 Word 编程并且他们没有正确管理他们的文档时，这很方便。

# iphone - 在 iPhone 上播放频率

> ID：572246
> 
> 赞同：4
> 
> 时间：2009-02-21T04:08:56.470
> 
> 标签：iphone, audio

有人可以帮我使用`AudioQueue`iPhone 上的服务来播放特定频率（比如 440 Hz）吗？我已经查看了文档，但我似乎无法弄清楚如何去做。苹果的示例代码也对我没有太大帮助。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-22T06:23:16.407

`/Developer/Examples/CoreAudio/SimpleSDK/DefaultOutputUnit`有一个关于如何以给定频率和采样率播放音调的示例。

我基本上复制了代码（也使用了[这个博客条目](http://michael.tyson.id.au/2008/11/04/using-remoteio-audio-unit/)中的一点），它在 iPhone 上基本上没有任何变化。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-23T19:09:44.603

做到这一点一点都不难。查看 AudioQueue 示例。如果您查看播放音频文件的代码，您将只是这样做，除非没有实际读取文件。

您只需将采样率除以频率，计算正弦波，然后将这些值输入到播放回调函数中的音频队列中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-21T09:58:40.420

好吧，这有点蹩脚，但如果没有人想出真正的答案，你可以预先录制一个正弦波并循环它。如果剪得好，它应该玩得很好。当然，只有当您只有几个不同的频率可以播放时，这种响应才会起作用。

# c++ - 为什么我应该/不应该使用“new”运算符来实例化一个类，为什么？

> ID：572255
> 
> 赞同：10
> 
> 时间：2009-02-21T04:14:05.833
> 
> 标签：c++, class, instantiation

我知道这可能被解释为“您的偏好是什么”问题之一，但我真的很想知道为什么您会选择以下方法中的一种而不是另一种。

假设您有一个*超级复杂*的类，例如：

```
 class CDoSomthing {

    public:
        CDoSomthing::CDoSomthing(char *sUserName, char *sPassword)
        {
            //Do somthing...
        }

        CDoSomthing::~CDoSomthing()
        {
            //Do somthing...
        }
}; 
```

我应该如何在全局函数中声明本地实例？

```
 int main(void)
{
    CDoSomthing *pDoSomthing = new CDoSomthing("UserName", "Password");

    //Do somthing...

    delete pDoSomthing;
} 
```

- 或者 -

```
 int main(void)
{
    CDoSomthing DoSomthing("UserName", "Password");

    //Do somthing...

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-02-21T04:18:26.120

首选局部变量，除非您需要对象的生命周期超出当前块。（局部变量是第二种选择）。这比担心内存管理要容易得多。

PS如果你需要一个指针，因为你需要它传递给另一个函数，只需使用地址操作符：

```
SomeFunction(&DoSomthing); 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2009-02-21T04:32:38.800

当您在堆栈和堆中声明变量时，有两个主要考虑因素 - 生命周期控制和资源管理。

当您严格控制对象的生命周期时，在堆栈上进行分配非常有效。这意味着您不会将该对象的指针或引用传递给本地函数范围之外的代码。这意味着，没有输出参数，没有 COM 调用，没有新线程。相当多的限制，但是您可以在正常或异常退出当前范围时为您正确清理对象（尽管，您可能希望阅读使用虚拟析构函数的堆栈展开规则）。堆栈分配的最大缺点 - 堆栈通常被限制为 4K 或 8K，因此您可能要小心放在上面的内容。

另一方面，在堆上分配将需要您手动清理实例。这也意味着您有很大的自由来控制实例的生命周期。您需要在两种情况下执行此操作：a）您将要将该对象传递到范围之外；或者 b) 对象太大并且在堆栈上分配它可能会导致堆栈溢出。

顺便说一句，这两者之间的一个很好的折衷方案是在堆上分配对象并在堆栈上分配一个智能指针。这可确保您不会浪费宝贵的堆栈内存，同时仍会在范围退出时进行自动清理。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-02-21T04:23:23.300

第二种形式是所谓的 RAII（资源获取即初始化）模式。它比第一个有很多优点。

使用时`new`，必须`delete`自己使用，并保证即使抛出异常，也会一直被删除。你必须自己保证这一切。

如果使用第二种形式，当变量超出范围时，它总是会自动清理。如果抛出异常，堆栈会展开并且也会被清理。

因此，您应该更喜欢 RAII（第二个选项）。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-02-21T04:43:21.910

除了到目前为止所说的之外，还需要考虑其他性能注意事项，特别是在内存分配密集型应用程序中：

1.  使用`new`将从堆中分配内存。在密集（极其频繁）分配和释放的情况下，您将在以下方面付出高昂代价：
    *   锁定：堆是进程中所有线程共享的资源。堆上的操作可能需要锁定堆管理器（在运行时库中为您完成），这可能会显着减慢速度。
    *   碎片：堆碎片。您可能会看到 malloc/new 和 free/delete 返回所需的时间增加了 10 倍。这与上面的锁定问题更加复杂，因为管理碎片堆需要更多时间，并且更多线程排队等待修复锁。（在 Windows 上，您可以为堆管理器设置一个特殊标志，以便它试探性地尝试减少碎片。）
2.  使用 RAII 模式，只需将内存从堆栈中取出。堆栈是每个线程的资源，它不会分段，不涉及锁定，并且可能会在内存局部性（即 CPU 级别的内存缓存）方面发挥您的优势。

因此，当您在短时间内（或范围内）需要对象时，一定要使用第二种方法（局部变量，在堆栈上）。如果您需要在线程之间共享数据，请使用`new/malloc`（一方面你必须，在另一方面，这些对象的寿命通常足够长，因此您对堆管理器的成本基本上是 0。）

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-21T04:20:34.710

如果抛出异常，第二个版本将展开堆栈。第一个不会。否则我看不出有太大的不同。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-21T05:36:50.520

两者最大的区别在于new初始化了一个指向对象的指针。

通过创建没有new的对象，启动的对象存储在堆栈上。如果它是用 new 启动的，它会返回一个指向在堆上创建的新对象的指针。它实际上返回一个指向新对象的内存地址。发生这种情况时，您需要对变量进行内存管理。使用完变量后，您需要对其调用 delete 以避免内存泄漏。如果没有 new 运算符，当变量超出范围时，内存将被自动释放。

因此，如果您需要将变量传递到当前范围之外，使用 new 会更有效。但是，如果您需要创建一个临时变量，或者只是临时使用的东西，那么将对象放在堆栈上会更好，因为您不必担心内存管理。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-21T04:21:41.933

`new`Mark Ransom 是对的，如果要将变量作为参数传递给 CreateThread-esque 函数，则还需要实例化。

# javascript - jQuery 插件 Cross Slide 和 Internet Explorer

> ID：572262
> 
> 赞同：1
> 
> 时间：2009-02-21T04:18:04.000
> 
> 标签：javascript, jquery, internet-explorer-7, cross-browser

我正在使用 jQuery 插件[Cross Slide](http://www.gruppo4.com/~tobia/cross-slide.shtml)。我的页面在 Chrome 和 Firefox 中运行良好。但在 Internet Explorer 7 中，我得到：

> 在第 1 行按 Object 预期调试错误： $(document).ready(function() { $('#image').crossSlide({sleep:4,fade:1},[{src:'images/1.jpg '},{src:'images/2.jpg'}]); });

如何修复 Internet Explorer 8 和 Internet Explorer 7 的错误？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2010-01-12T15:45:46.280

我有同样的问题，你只需要删除你指向的最后一张图片后的逗号。这应该在 IE 中工作。

问候

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-23T14:56:59.003

尝试使用 partner.js。它会将您指向有问题的 JavaScript 行，而不是默认的第 1 行。此外，请尝试使用未打包的 JavaScript 代码，这样您就知道出了什么问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-23T10:12:35.020

您能否提供更多代码甚至更好的重现问题的工作页面？到目前为止，那一小段代码看起来还不错……

顺便说一句，“第 1 行”在 IE 中完全没有告诉你，不要相信它。

# python - 如何创建一个在复选框右侧显示复选框标签的 Django 表单？

> ID：572263
> 
> 赞同：37
> 
> 时间：2009-02-21T04:18:17.727
> 
> 标签：python, django, checkbox

当我定义一个类似于这样的 Django 表单类时：

```
def class MyForm(forms.Form):
    check = forms.BooleanField(required=True, label="Check this") 
```

它扩展为如下所示的 HTML：

```
<form action="." id="form" method=POST>
<p><label for="check">Check this:</label> <input type="checkbox" name="check" id="check" /></p>
<p><input type=submit value="Submit"></p>
</form> 
```

我希望复选框输入元素在复选框后面有一个标签，而不是相反。有没有办法说服 Django 这样做？

**[编辑]**

感谢 Jonas 的回答 - 虽然它解决了我询问的问题（复选框标签呈现在复选框的右侧），但它引入了一个新问题（所有小部件标签都呈现在其小部件的右侧......）

我想避免覆盖 _html_output() 因为它显然不是为它设计的。我想出的设计是在 Field 类中实现一个字段 html 输出方法，覆盖布尔字段的方法并在 _html_output() 中使用该方法。遗憾的是，Django 开发人员选择了不同的方式，我希望尽可能地在现有框架内工作。

CSS 听起来是一种不错的方法，只是我对 CSS 的了解不够多，无法解决这个问题，甚至无法决定我是否喜欢这种方法。此外，我更喜欢仍然类似于最终输出的标记，至少在渲染顺序上是这样。

此外，由于为任何特定标记拥有多个样式表是合理的，因此在 CSS 中执行此操作可能意味着必须为多种样式执行多次，这几乎使 CSS 成为错误答案。

**[编辑]**

好像我在下面回答我自己的问题。如果有人对如何做到这一点有更好的想法，请不要害羞。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2010-01-11T22:06:27.673

这是我提出的解决方案（Django v1.1）：

```
{% load myfilters %}

[...]

{% for field in form %}
    [...]
    {% if field.field.widget|is_checkbox %}
      {{ field }}{{ field.label_tag }}
    {% else %}
      {{ field.label_tag }}{{ field }}
    {% endif %}
    [...]
{% endfor %} 
```

您需要创建一个自定义模板标签（在本例中为“myfilters.py”文件），其中包含如下内容：

```
from django import template
from django.forms.fields import CheckboxInput

register = template.Library()

@register.filter(name='is_checkbox')
def is_checkbox(value):
    return isinstance(value, CheckboxInput) 
```

有关自定义模板标签的更多信息，请[点击此处](http://docs.djangoproject.com/en/dev/howto/custom-template-tags/)。

**编辑**：本着提问者自己的回答的精神：

好处：

1.  没有使用 CSS。
2.  标记最终看起来像它应该的样子。
3.  我没有破解 Django 内部。（但不得不看很多）
4.  该模板很好，紧凑且惯用。
5.  无论标签和输入字段名称的确切值如何，过滤器代码都能很好地发挥作用。

缺点：

1.  可能有什么地方可以做得更好更快。
2.  客户不太可能愿意为此付出所有时间，只是为了将标签向右移动……

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2010-02-22T03:52:58.357

我从 romkyns 那里得到了答案，让它更笼统一些

```
def field_type(field, ftype):
    try:
        t = field.field.widget.__class__.__name__
        return t.lower() == ftype
    except:
        pass
    return False 
```

这样您可以直接使用字符串检查小部件类型

```
{% if field|field_type:'checkboxinput' %}
    <label>{{ field }} {{ field.label }}</label>
{% else %}
    <label> {{ field.label }} </label> {{ field }}
{% endif %} 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2013-03-09T07:18:55.620

所有提出的解决方案都涉及模板修改，这在性能方面通常相当低效。这是一个可以完成这项工作的自定义小部件：

```
from django import forms
from django.forms.fields import BooleanField
from django.forms.util import flatatt
from django.utils.encoding import force_text
from django.utils.html import format_html
from django.utils.translation import ugettext as _

class PrettyCheckboxWidget(forms.widgets.CheckboxInput):
    def render(self, name, value, attrs=None):
        final_attrs = self.build_attrs(attrs, type='checkbox', name=name)
        if self.check_test(value):
            final_attrs['checked'] = 'checked'
        if not (value is True or value is False or value is None or value == ''):
            final_attrs['value'] = force_text(value)
        if 'prettycheckbox-label' in final_attrs:
            label = _(final_attrs.pop('prettycheckbox-label'))
        else:
            label = ''
        return format_html('<label for="{0}"><input{1} /> {2}</label>', attrs['id'], flatatt(final_attrs), label)

class PrettyCheckboxField(BooleanField):
    widget = PrettyCheckboxWidget
    def __init__(self, *args, **kwargs):
        if kwargs['label']:
            kwargs['widget'].attrs['prettycheckbox-label'] = kwargs['label']
            kwargs['label'] = ''
        super(PrettyCheckboxField, self).__init__(*args, **kwargs)

# usage in form
class MyForm(forms.Form):
    my_boolean = PrettyCheckboxField(label=_('Some label'), widget=PrettyCheckboxWidget()) 
```

我在一个额外的文件中有*PrettyCheckboxWidget*和*PrettyCheckboxField*，因此可以在需要的地方导入它们。如果您不需要翻译，您可以删除 ugettext 部分。此代码适用于**Django 1.5**，未针对较低版本进行测试。

**好处：**

*   高性能，无需模板修改
*   易于用作自定义小部件

**缺点：**

*   "as_table" 在第二列中呈现复选框 + 标签
*   模板内的 {{ field.label }} 为空。标签改为绑定到 {{ field }}
*   比我计划在星期六做的工作要多；-)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-07-23T11:27:15.230

我知道用户排除了 CSS，但考虑到最重要的答案需要大约半小时的工作来完成这么小的事情，但知道这些细节在网站上很重要，我会选择 CSS 解决方案。

复选框.css

```
input[type="checkbox"] {
    float: left;
    margin-right: 10px;
    margin-top: 4px;
} 
```

表格.py

```
class MyForm(forms.ModelForm):
    # ...
    class Media:
    css = {
        'all': 'checkbox.css',
    } 
```

模板.html

```
{{ form.media }}
{{ form.as_p }} 
```

好处：

*   快速地！
*   不使用模板标签（只是`form.as_p`）
*   没有新的该死的小部件
*   CSS 文件自动包含在每个表单中

缺点：

*   HTML 不反映演示文稿（但足够好！）
*   你的前端人员可能会抱怨

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-22T06:25:08.273

这就是我最终做的事情。我写了一个自定义模板字符串过滤器来切换标签。现在，我的模板代码如下所示：

```
{% load pretty_forms %}
<form action="." method="POST">
{{ form.as_p|pretty_checkbox }}
<p><input type="submit" value="Submit"></p>
</form> 
```

与普通 Django 模板的唯一区别是添加了 {% load %} 模板标签和**pretty_checkbox**过滤器。

**这是pretty_checkbox**的一个实用但丑陋的实现——这段代码没有任何错误处理，它假设 Django 生成的属性以非常特定的方式格式化，在你的代码中使用这样的东西是个坏主意：

```
from django import template
from django.template.defaultfilters import stringfilter
import logging

register=template.Library()

@register.filter(name='pretty_checkbox')
@stringfilter
def pretty_checkbox(value):
    # Iterate over the HTML fragment, extract <label> and <input> tags, and
    # switch the order of the pairs where the input type is "checkbox".
    scratch = value
    output = ''
    try:
        while True:
            ls = scratch.find('<label')
            if ls > -1:
                le = scratch.find('</label>')
                ins = scratch.find('<input')
                ine = scratch.find('/>', ins)
                # Check whether we're dealing with a checkbox:
                if scratch[ins:ine+2].find(' type="checkbox" ')>-1:
                    # Switch the tags
                    output += scratch[:ls]
                    output += scratch[ins:ine+2]
                    output += scratch[ls:le-1]+scratch[le:le+8]
                else:
                    output += scratch[:ine+2]
                scratch = scratch[ine+2:]
            else:
                output += scratch
                break
    except:
        logging.error("pretty_checkbox caught an exception")
    return output 
```

**pretty_checkbox**扫描它的字符串参数，找到成对的 <label> 和 <input> 标签，如果 <input> 标签的类型是“checkbox”，则切换它们。它还去除了标签的最后一个字符，恰好是 ':' 字符。

好处：

1.  没有使用 CSS。
2.  标记最终看起来像它应该的样子。
3.  我没有破解 Django 内部。
4.  该模板很好，紧凑且惯用。

缺点：

1.  过滤器代码需要测试标签和输入字段名称的令人兴奋的值。
2.  可能有什么地方可以做得更好更快。
3.  比我计划在星期六做的工作要多。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2015-02-15T19:11:24.823

在 Django admin 中更改复选框位置可能非常棘手，但幸运的是，有一个使用自定义小部件的简单解决方案：

```
from django.forms.widgets import Widget, CheckboxInput, boolean_check

class RightCheckbox(Widget):
    render = CheckboxInput().render

    def __init__(self, attrs=None, check_test=None):
        super(RightCheckbox, self).__init__(attrs)
        self.check_test = boolean_check if check_test is None else check_test 
```

Django 仅在小部件是`CheckboxInput`

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-21T06:52:58.230

输入和标签的顺序是通过表单的 normal_row 参数提供的，复选框没有不同的行模式。所以有两种方法可以做到这一点（在 0.96 版本中）：
1\. 覆盖表单的 _html_output
2\. 使用 CSS 更改标签和复选框的位置

# c# - 在 ASP.NET MVC 中将 ViewData 传递给 ViewPage

> ID：572268
> 
> 赞同：1
> 
> 时间：2009-02-21T04:21:37.207
> 
> 标签：c#, .net, asp.net-mvc

我正在尝试在 ASP.NET MVC 中构建自定义控件。我要避免在这些控件中混合视图 (html) 和代码 (C#)。

经过数小时的谷歌搜索和解决这个问题后，我终于想到了创建使用 ASP 视图引擎的辅助方法（认为 ViewPage 类）。

我可以创建该类的实例，甚至可以使用 LoadControl 和 LoadTemplate 方法加载 ascx 模板，但问题是当我将 ViewData 对象传递给 ViewPage 类的实例时，我在 ViewPage 中看不到 ViewData 并且我'我收到此错误：

> ViewUserControl '~/Components/Controls/EditableLabel/Views/EditableLabel.ascx' 找不到 IViewDataContainer。ViewUserControl 必须位于 ViewPage、ViewMasterPage 或另一个 ViewUserControl 中。

通常我想要达到的最终效果是加载带有一些参数的控件，这些参数在模板（ascx）中应该是可读的。

例子：

```
<% Html.EditableLabel(Writer, "memberName", "Name", "Antonio", "/identity/updateProperty", "memberName"); %> 
```

1.  有没有办法将 ViewData 传递给我创建的 ViewPage 实例？
2.  在 ASP.NET MVC 中创建自定义控件/小部件是否有更智能的方法？

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-21T05:13:03.570

1.  您可以通过“return View(...)”或“ViewData[name] = value”从控制器将 VD 传递给 VP。
2.  最好使用继承自 ViewUserControl 的 ascx 控件来创建自定义控件。通过这种方式，您可以轻松地将数据传递给它：

    ```
    <% Html.RenderPartial("FooControl", new FooViewData(){ Name="aa",  Type="awesome", Id = 2}); %>
    <% Html.RenderPartial("FooControl", new FooViewData(){ Name="aa", Type="awesome", Id = 2}, ViewData); %> 
    ```

以及您可以在 FooViewData 类中定义的所有必要参数。

如果你真的想为 HtmlHelper 编写一个扩展来加载一些 ascx 控件，你应该查看 MvcFutures 中的 Repeater 类（MVC 的来源在[这里](http://www.codeplex.com/aspnet/Release/ProjectReleases.aspx?ReleaseId=22467#ReleaseFiles)）。但我敢肯定，在一般情况下你不需要这个。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-21T13:46:55.863

我正在用 zihotki 跟踪这个。但是，对于＃2，我将添加一个警告。在使用绝育 ASPX 和 ASCX 作为视图的默认实现中，创建 MVC 控件（使用模板确保您的狗已绝育）是最佳选择。

现在警告一下。ASPX 和 ASCX 不必是视图。如果您查看 Phil Haack 的博客，您会看到提到的其他一些视图引擎，例如 Spark View Engine（[ASP.NET MVC Northwind Demo Using the Spark View Engine](http://haacked.com/archive/2008/12/08/asp.net-mvc-northwind-demo-using-the-spark-view-engine.aspx)）。事实上，Phil 在这篇文章中设置了一个使用替代视图引擎的示例：[使用多个 ViewEngines 渲染单个视图](http://haacked.com/archive/2008/11/16/composing-multiple-view-engines.aspx)。

我不是建议您转移到其他视图引擎，只是如果您找到一个更适合您的问题域的选项，则可以选择。有时最好坚持开箱即用的实现。在这种情况下，使用 ASCX 控件保持简单。

顺便说一句，如果您认真地将 MVC 作为您的 UI 故事，[您应该查看 MVC 的 codeplex 项目](http://www.codeplex.com/site/search?projectSearchText=ASP.NET%20MVC)。这里最重要的可能是 MVC.Contrib，但列表中还有一些其他的 gem。

# windows - 关于 DPI 问题

> ID：572270
> 
> 赞同：3
> 
> 时间：2009-02-21T04:21:47.203
> 
> 标签：windows, winapi, dpi

我有一个 WIN32 SW，它的 UI 设计为 96 DPI，所以当用户将 Windows DPI 从 96 更改为 120 或更大时，UI 会出错。我想知道是否有 API 可以强制我的 SW 以 96DPI 显示 UI。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-21T06:37:26.597

从 Windows Vista 开始，DPI 的缩放应该自动发生。我没有任何直接经验知道它的工作原理，但这里是解释如何关闭它的页面：

[http://msdn.microsoft.com/en-us/library/ms701681(VS.85).aspx](http://msdn.microsoft.com/en-us/library/ms701681(VS.85).aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-21T06:58:23.583

您还可以为您的应用程序添加一个 appcompat 密钥。这个在注册表中的位置是：

`HKEY_CURRENT_USER\Software\Microsoft\Windows NT\CurrentVersion\AppCompatFlags\Layers`

那是每个用户的设置，里面有相同的键`HKEY_LOCAL_MACHINE`，但当然这是一个系统设置，需要提升的权限才能写入。像这样添加一个键：

`"C:\path\to\app.exe"="HIGHDPIAWARE"`

将为您的程序启用该兼容性标志，这将关闭 DPI 缩放。这适用于 Vista+。

[根据文档， SetProcessDPIAware](http://msdn.microsoft.com/en-us/library/ms633543.aspx)也是一种选择，但请注意存在竞争条件的危险。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-21T04:42:49.260

没有 API 可以强制您的应用以 96DPI 显示。DPI 是一种设备设置，不能按应用程序进行控制。

如果您可以更改程序，则可以缩放 UI 以在高 DPI 上正常显示。你需要打电话[`GetDeviceCaps`](http://msdn.microsoft.com/en-us/library/dd144877(VS.85).aspx)；更具体地说，您需要使用 和 返回的数字来计算 X 和 Y`LOGPIXELSX`比例`LOGPIXELSY`。像这样的东西：

```
HDC hdc;
double m_dDPIScaleX = GetDeviceCaps(hdc, LOGPIXELSX) / 96.0;
double m_dDPIScaleY = GetDeviceCaps(hdc, LOGPIXELSY) / 96.0; 
```

# iphone - 我可以故意阻止循环以等待异步回调完成吗？

> ID：572274
> 
> 赞同：0
> 
> 时间：2009-02-21T04:23:42.300
> 
> 标签：iphone, objective-c, cocoa-touch

我正在尝试在我的 iPhone 应用程序中批量上传照片。我有一个循环遍历用户照片的脚本，然后对于每张照片，调用另一个脚本进行上传。

执行上传的脚本需要回调触发每张用户照片的脚本，以指示成功或失败。这有点奇怪，但就像我需要能够在循环内获得同步调用的阻塞功能，但同时上传脚本是异步的。

代码非常复杂，所以我将尝试使用伪代码：

**脚本一：**

```
foreach (photoNeedsUpload in users photos)

       upload the photo via Upload Script

callback hook: successOrFailureUploading (called back by the Upload Script) 
```

**上传脚本：**

```
 1\. Do the upload and then wait for NSURLRequest callbacks: 

    connectionDidFinishLoading, didFailWithError, etc., etc.

    2\. Upon getting called back, in turn:
call back Script One appropriately with success/failure signal 
```

我的问题是我想要异步回调，以便检查上传状态，但我真的需要阻止每张照片并等待它上传。

有没有一种简单的方法来做这样的事情？我应该让线程进入睡眠状态，还是应该让 http 调用同步？如果是这样，如何检查是否成功？

我承认我没有做我的设计作业，并且开始觉得我为自己创造了一个循环问题！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-21T04:36:48.917

嗯，是的，当然*可以*。只需向调用者添加一个标志，比如一个信号量；让它等待那个标志。

清除回调中的标志。砰，你来了。

问题是：*为什么？* 为什么要这么麻烦；相反，只需同步启动该过程。然后你不需要回调。

这两种情况的问题是，当您开始等待时，您的进程显然会挂起——没有 UI 事件，没有 raise-lower，所有这些东西。这让我觉得很可能是不受欢迎的。

你确定你不想让回调设置一个标志来告诉你工作已经完成，然后回到它身边吗？

您也可以查看异步完成令牌模式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-01T12:07:54.670

我需要做类似的事情。我想要一个同步下载，但需要一些异步下载的方法（特别是处理授权）。

我是这样做的

```
-(BOOL)getDataSynchronouslyFromAddress:(NSString*)address
{
    if (downloadRunning)
    {
        return NO;
    }

    downloadRunning=YES;
    downloadSucceeded=NO;

    NSURLConnection *connection=[self startConnectionWithAddress:address];
    if (!connection)
    {
        NSLog(@"no connection");
        downloadRunning=NO;
    }

    NSRunLoop *runLoop = [NSRunLoop currentRunLoop];
    while (downloadRunning && [runLoop runMode:NSDefaultRunLoopMode beforeDate:[NSDate distantFuture]]);

    return downloadSucceeded;
} 
```

下载完成后，我只是适当地设置了 downloadSucceeded，并将 downloadRunning 设置为 NO。

# linux - D-Bus 的底层传输是什么？

> ID：572283
> 
> 赞同：10
> 
> 时间：2009-02-21T04:36:55.703
> 
> 标签：linux, ipc, dbus

D-Bus 允许程序进行通信。这个IPC是如何实现的？Unix域套接字，共享内存+信号量，命名管道，还有什么？也许是一个组合？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-21T19:01:25.017

我认为它通常使用 UNIX 套接字。在 Linux 下，它可以使用“抽象命名空间”Unix 套接字，它们是相同的，只是它们在文件系统中不作为可见文件物理存在。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-21T06:42:44.853

[这与DBus query](https://stackoverflow.com/questions/328393/dbus-query)问题非常相似。谷歌搜索的答案是套接字——用于 TCP/IP 或 Unix 域。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-21T04:42:30.930

显然，IPC 或 TCP/IP：

[http](http://www.freedesktop.org/wiki/Software/dbus)
://www.freedesktop.org/wiki/Software/dbus 更新：
我的意思是，不同操作系统上的多种 IPC 方法，加上 TCP/IP。
[http://dbus.freedesktop.org/doc/dbus-daemon.1.html](http://dbus.freedesktop.org/doc/dbus-daemon.1.html)显示 unix 参考版同时使用 unix 域套接字和 tcp/ip。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-26T00:53:44.090

There [has been in the past some attempt to use netlink sockets](http://lists.freedesktop.org/archives/dbus/2004-July/001326.html) directly from the kernel. More recently (announced during last LPC), some people are working at getting rid of D-Bus user-space daemon and putting D-Bus in the kernel, it will probably also use sockets, but maybe revive the netlink or other approaches.

# c# - 处理键盘操作

> ID：572296
> 
> 赞同：0
> 
> 时间：2009-02-21T04:52:34.930
> 
> 标签：c#

我正在做一些客户端和服务器程序，因为我会将客户端屏幕带到我的服务器应用程序......它就像 VNC 一样......在这里我已经完成了所有移动以及鼠标点击操作，通过这里的远程概念键盘操作正在等待中，因为我可以将键盘值发送到相应的焦点控件...现在我想做一些快捷键操作，如 Ctrl+A、Ctrl+v 等......我想借助 KeyData 来完成此操作。 ...我该怎么做这个操作...在这里我可以向客户端机器发送一个密钥，如A，控制A，移位等......该操作应该在客户端机器中发生，这是我想要的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-21T05:19:32.213

您可以调用 Win32 api 来生成键和鼠标事件或使用 SendKeys API。.Net 中的每种语言都应该可以访问底层的 win32 api。

C# 没有直接的方法，但我在 msdn 找到[了这个](http://social.msdn.microsoft.com/forums/en-US/netfxcompact/thread/d5d6097e-f221-452e-8b65-5659e2c9faaa/)。它展示了如何使用 SendKeys 来自动化按键。您必须识别目标窗口，找到所需的键码并生成 keybd_event。

[VK_KEY 代码](http://msdn.microsoft.com/en-us/library/ms645540.aspx)- VK_CONTROL (0x11)
如何使用[keybd_event 函数](http://msdn.microsoft.com/en-us/library/ms646304(VS.85).aspx)

您是否按照正确的顺序完成了这些活动？

```
keybd_event(VK_CONTROL, 0, KEYEVENTF_KEYDOWN, 0);//press ctrl
keybd_event(0x41, 0, KEYEVENTF_KEYDOWN, 0);//hex 'A'
keybd_event(0x41, 0, KEYEVENTF_KEYUP, 0);//hex 'A'
keybd_event(VK_CONTROL, 0, KEYEVENTF_KEYUP, 0); //release ctrl 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-27T00:10:20.333

我实际上是在尝试实现相同的..我想知道你是否有可能给我一些关于如何在一个似乎模拟远程桌面的项目中实现键盘部分的指导......即使只是代码也会帮了大忙！！

# html - 如何阻止文本占用超过 1 行？

> ID：572298
> 
> 赞同：393
> 
> 时间：2009-02-21T04:58:20.487
> 
> 标签：html, css, text, word-wrap

是否有自动换行或任何其他属性阻止文本换行？我有一个高度，和`overflow:hidden`，文本仍然中断。

需要在 CSS3 之前的所有浏览器中工作。

* * *

## 回答 #1

> 赞同：727
> 
> 时间：2009-02-21T05:03:58.150

```
div {
  white-space: nowrap;
  overflow: hidden;
}
```

```
<div>testing quite a lot of text that just doesn't wrap because it is too long a run-on sentance with so many useless words for you to not read today despite every effort you make to do so including stretching your browser width to the maximum length unless however you utilized your browser's zooming out feature or manually modifying the CSS in which case you are definitely cheating and ruining this fun little game of me typing out as many words as can be fitted into one ridiculously long run-on sentence of the twenty-first century anno domini using my traditional keyboard and two monitors at 1080p while going through every effort to painstakingly ramble on and on but just not exactly repeating myself short of reusing a couple of words in multiple places throughout this HTML even though that would be about a thousand times easier than what I'm currently doing on this day to pointlessly avoid work regardless of its futility given that it'll only create consequences for myself in having to work harder to catch up later of course all of that notwithstanding moderation efforts to tone back my extensive efforts to make this somewhat enjoyable to read while making it as long as possible who may or may not revert this edit in spite of its usefulness since the previous edit only contained four words that could not possibly wrap even without the CSS changes due to their short nature which is invariably going to create more questions than it answers such as can be found in the comments section which is exactly why I created this effort in order to address one of those about the purpose of the overflow attribute which if you have modified you will now see lets you read the entirety of this text through the benefits of horizontal scrolling features but on the other hand if only overflow was used and text-wrap was left out then you will continue to see a vertical scrollbar unless you set a fixed height for this div in which case you certainly should see that vertical overflow is hidden though that would only happen if you did not put this example into fullscreen short of having your viewport set to a small enough height which can actually be further defined to a designated number of lines as opposed to one by using a height set to a multiple of the CSS property defined by line-height which could be a percentage of white-space and that would indeed hide the vertical overflow of this mountain of text which I'm really quite surprised that you managed to linger on here to read through its frivolous nature on the famed site known by programmers as Stack Overflow and for that I congratulate you for potentially wasting your time</div>
```

~~**注意：**这仅适用于块元素。如果您需要对表格单元格执行此操作（例如），您需要在表格单元格内放置一个 div，因为表格单元格具有显示表格单元格而不是阻塞。~~

从 CSS3 开始，表格单元格也支持此功能。

* * *

## 回答 #2

> 赞同：71
> 
> 时间：2009-02-21T05:04:10.363

您可以使用 CSS[`white-space`属性](https://developer.mozilla.org/en-US/docs/Web/CSS/white-space)来实现这一点。

```
white-space: nowrap; 
```

* * *

## 回答 #3

> 赞同：52
> 
> 时间：2017-04-07T10:54:12.870

使用`text-overflow: ellipsis`将在最后添加 ...。

```
div {
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
} 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-02-21T05:01:17.343

有时使用`&nbsp;`而不是空格会起作用。不过，显然它有缺点。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2019-01-26T10:22:14.857

为了清楚起见，这适用于段落和标题等。您只需要指定`display: block`.

例如：

```
<h5 style="display: block; text-overflow: ellipsis; white-space: nowrap; overflow: hidden">
  This is a really long title, but it won't exceed the parent width
</h5> 
```

（原谅内联样式）

# authentication - 窗户认证

> ID：572304
> 
> 赞同：0
> 
> 时间：2009-02-21T05:04:41.110
> 
> 标签：authentication, active-directory, ldap, jsp-tags

使用 JSP 页面我得到用户名和密码。如何在活动目录中检查它。请举一些代码的例子。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-22T02:33:40.310

这是一个[Java示例](http://blogs.artinsoft.net/mrojas/archive/2007/05/14/1429.aspx)......希望这会有所帮助。

# c# - 如何在 C# 中使用单独的 .cs 文件？

> ID：572314
> 
> 赞同：12
> 
> 时间：2009-02-21T05:17:18.117
> 
> 标签：c#

论坛; 我是一个新手，正在编写一些代码。我想知道使用包含其他类和函数的单独 .cs 文件的最佳方法。作为一个基本功能的例子，想要点击一个清除按钮并让它清除表单上的所有字段。代码分为三个 .cs 文件。Main.cs、MainForm.Designer.cs 和 btClear.cs。

MainForm.Designer.cs 包含设计师自动创建的代码，包括清除按钮和我想清除的文本框。

我想要清除 btClear.cs 中包含的文本框的代码。我知道将此代码简单地放在 MainForm.Designer.cs 中很容易，但是我想将其用作模板，以便将单独的 .cs 文件用作标准做法。

有人可以给我一个如何做到这一点的例子吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-21T09:54:00.667

大多数 .net 程序员的做法是：

*   将所有代码留在里面`MainForm.cs`，但声明一个新方法来分离执行清除的代码。

我总是留在事件处理程序方法（双击按钮时VS生成的那个）代码来更改鼠标光标（以防我调用的代码需要几秒钟或更长时间才能运行）并捕获所有未处理的异常，并将我的逻辑放在一个单独的私有方法中：

```
partial class MainForm : Form // this is MainForm.cs
{
    // This is the method VS generates when you double-click the button
    private void clearButton_Click(object sender, EventArgs e)
    {
        this.Cursor = Cursors.WaitCursor;
        try
        {
            ClearForm();
        }
        catch(Exception ex)
        {
            // ... have here code to log the exception to a file 
            // and/or showing a message box to the user
        }
        finally
        {
            this.Cursor = Cursors.Default;
        }
    }

    private void ClearForm()
    {
        // clear all your controls here
        myTextBox.Clear();
        myComboBox.SelectedIndex = 0;
        // etc...
    }
} 
```

在我看来，如果你想在 .net 中遵循传统的做事方式，你应该坚持第一个例子。

**当代码不属于表单逻辑**（例如数据访问代码或业务逻辑）时，建议将代码移出表单 .cs 文件。在这种情况下，我认为清除表单控件不符合业务逻辑。它只是表单代码的一部分，应该保留在`MainForm.cs`.

但是如果你真的想把`ClearForm`方法放在另一个 .cs 文件中，你可以创建一个新类并将`ClearForm`方法移到那里。您还需要将每个控件的 Modifiers 属性更改为 Public，以便您的新类可以从 MainForm 外部访问它们。像这样的东西：

```
public class FormCleaner // this is FormCleaner.cs
{
    public void ClearForm(MainForm form)
    {
        // clear all your controls here
        form.myTextBox.Clear();
        form.myComboBox.SelectedIndex = 0;
        // etc...
    }
} 
```

您必须将主表单代码更改为：

```
partial class MainForm : Form // this is MainForm.cs
{
    // This is the method VS generates when you double-click the button
    private void clearButton_Click(object sender, EventArgs e)
    {
        this.Cursor = Cursors.WaitCursor;
        try
        {
            FormCleaner cleaner = new FormCleaner();
            cleaner.ClearForm(this);
        }
        catch(Exception ex)
        {
            // ... have here code to log the exception to a file 
            // and/or showing a message box to the user
        }
        finally
        {
            this.Cursor = Cursors.Default;
        }
    }
} 
```

但是请注意，您的`FormCleaner`班级必须了解您的`MainForm`班级才能知道如何清除表单的每个控件，或者您需要提出一个通用算法，该算法能够遍历`Controls`任何表单的集合以清理它们：

```
public class FormCleaner // this is FormCleaner.cs
{
    // 'generic' form cleaner
    public void ClearForm(Form form)
    {
        foreach(Control control on form.Controls)
        {
            // this will probably not work ok, because also
            // static controls like Labels will have their text removed.
            control.Text = "";
        }
    }
} 
```

正如其他人所说，`MainForm.Designer.cs`它是机器生成的，你永远不应该把自己的代码放在那里。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-21T05:30:38.053

你可以[`partial`](http://msdn.microsoft.com/en-us/library/wa80x488.aspx)为你的班级使用一个班级`MainForm`，因为这已经在`MainForm.cs`and中完成了`MainForm.Designer.cs`。

`btnClear.cs`

```
public partial class MainForm
{
   private void clearForm(object sender, EventArgs e)
   {
     // ...
   }
} 
```

`MainForm.cs`并在或中注册活动`MainForm.Designer.cs`

```
this.btnClear.click += clearForm; 
```

编辑：

如果您想要一种通用的方法，您可以将[`Tag`](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.tag.aspx)控件的属性设置为默认值。使用扩展方法，您可以执行类似的操作`formGroup.Reset();`

```
using System.Windows.Forms;

public class ControlExtensions
{
  public void Reset(this Control control)
  {
    if (control.Tag != null)
    {
      if (control is TextBoxBase && control.Tag is string)
      {
        control.Text = control.Tag as string;
      }
      else if (control is CheckBox && control.Tag is bool)
      {
        control.Checked = control.Tag as bool;
      }
      // etc
    }

    foreach (Control child in control.Children)
      child.Reset();
  }
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-21T05:26:54.553

每个 .cs 文件一个类是一个很好的规则。

除非您打算封装到可重用的类中，否则我不会将特定于页面的功能分离到单独的 .cs 文件中。

**编辑：**

将清除函数放在按钮的 OnClick 事件中。没有理由将其分开。

**.aspx 文件：**

```
<%@ Page Language="C#" AutoEventWireup="true" CodeBehind="Default.aspx.cs" Inherits="SimpleWebTest._Default" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" >
<head runat="server">
    <title>Untitled Page</title>
</head>
<body>
    <form id="form1" runat="server">
    <div>
        <asp:Button ID="ClearButton" runat=server onclick="ClearButton_Click" Text="Button" />
    </div>
    </form>
</body>
</html> 
```

**.cs 文件**

```
using System;

namespace SimpleWebTest
{
    public partial class _Default : System.Web.UI.Page
    {
        protected void Page_Load(object sender, EventArgs e) { }

        protected void ClearButton_Click(object sender, EventArgs e)
        {
            using (ComplexOperationThingy cot = new ComplexOperationThingy())
            {
                cot.DoSomethingComplex();
            }
        }
    }
} 
```

**ComplexOperationThingy.cs：**

```
using System;

namespace SimpleWebTest
{
    public class ComplexOperationThingy
    {
        ComplexOperationThingy() { }

        public void DoSomethingComplex()
        {
            //Do your complex operation.
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-21T05:31:31.093

做起来相当简单。在您的 btClear.cs 文件中，只需生成一个类定义，如：

```
public class MyUtility
{
    public static void ClearContents(IEnumerable<Control> controls)
    {
        //TODO: Code that clears contents of controls passed
    }
} 
```

然后，您可以从通过以下方式引用生成的类所包含的命名空间的任何位置调用它：

```
MyUtility.ClearContents(SomeControlCollection); 
```

我希望我没有完全错过你的意图。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-21T05:37:29.440

一般来说，您不应该将代码放在 MainForm.designer.cs 文件中。Visual Studio 使用 *.designer.cs 文件来连接在表单上实际放置控件的所有繁琐管道。

您想用来与表单上的控件交互的任何代码都应该放在 MainForm.cs 文件中。因此，如果您想要一个函数来清除表单上的控件，那么您应该将代码放在那里。

如果您编写的代码清楚表单上的控件可在其他项目中重用，那么您应该将其放在另一个可以链接到其他项目的 .cs 文件中。

正如 Chris 所说，通常每个 .cs 文件放置一个类也是一个好主意。当你这样做时，文件应该有它包含的类的名称。因此，如果您有一个名为 MyButtonHelpers 的类，则源文件应命名为 MyButtonHelpers.cs。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-21T05:36:36.760

我发现最好不要直接编辑 .Designer.cs 文件，尤其是从源代码管理的角度来看。您可以使用部分类来包含相关代码；在这种情况下，您可以使用 MainForm.Designer.cs 作为如何完成部分类的示例（例如，部分类 MainForm{}）。

如果您通过 Windows 窗体设计器添加事件处理程序，它应该自动将它们放置在 MainForm.cs，而不是 MainForm.Designer.cs。如果您的项目增长到任何显着的规模，我经常发现创建多个部分类文件很有用，一个用于每个主要功能组。这使得查找特定功能（和相关功能）变得更加容易。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-21T07:08:50.673

C#（和许多其他语言）中的约定是每个类一个文件（通常每个文件一个类）。这条规则当然有例外，但是将一个类拆分到多个文件中应该很少见，而不是标准做法。

您在评论中提到，您预见到比您给出的示例更“复杂的操作”。你设想什么样的操作？只要您只是在谈论处理表单控件，逻辑就属于表单的 .cs 文件（在本例中是 MainForm.cs，而*不是*MainForm.designer.cs - 正如其他人所说，您应该永远不要修改 .designer 文件）。

[如果您的表单变得过于复杂，那么将其分解为单独的自定义控件](http://msdn.microsoft.com/en-us/library/6hws6h2t.aspx)可能是有意义的。这将允许您保持源文件更小，但是（因为每个 Control 映射到一个类）您将遵守一个类 <-> 一个文件约定。

# sharepoint - WSS 2.0 - 自定义文档库工具栏

> ID：572345
> 
> 赞同：0
> 
> 时间：2009-02-21T05:22:42.533
> 
> 标签：sharepoint, wss-2.0

我正在使用 Windows Sharepoint Services 2.0，并且正在寻找一种将新项目添加到“新文档”菜单项旁边的文档库工具栏的方法。我想为现有库以及将来创建的任何新库添加菜单项。这可能吗？我发现工具栏项是在 SCHEMA.xml 文件中定义的。但是改变它只会影响创建的新库对吗？编辑这个文件似乎也很复杂。

感谢任何帮助。

问候，贾格纳特

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-21T12:30:26.047

查看[MSDN 上的 WSS 2.0 参考](http://msdn.microsoft.com/en-us/library/aa151976.aspx)：[自定义列表](http://msdn.microsoft.com/en-us/library/ms868603.aspx)T的工具栏

使用 WSS 2.0 编辑 schema.xml 并不容易。但这是更新列表行为的“更好”方式。

当您为列表更新 schema.xml 时（无论是否自定义，但您最好创建一个自定义列表，[在此处进行说明](http://msdn.microsoft.com/en-us/library/ms868598.aspx)），有些内容会立即更新，其他内容会在 iisreset 之后更新，而其他一些内容仅在基于此架构创建新列表之后文件。不幸的是，我不记得所有的案例。

否则，您可以尝试 FrontPage 2003，但这取决于您必须更新多少列表，它会破坏“[页面重影](http://www.devx.com/dotnet/Article/27673)”。

# jquery-ui - 使用 jquery ui 选项卡更改哈希但不移动页面

> ID：572376
> 
> 赞同：3
> 
> 时间：2009-02-21T05:28:38.713
> 
> 标签：jquery-ui, hash

我添加了以下代码以将哈希更改为选项卡名称：

```
$("#tabs > ul").tabs({ 
select: function(event, ui){ 
window.location.hash = ui.tab.hash; 
} 
} ); 
```

这在 FF3 中运行良好，但在 IE7 中它会向下移动页面（取决于从页面顶部附近的某处一直到页面末尾的任何地方选择的选项卡）。

我尝试将其更改为：

```
$("#tabs > ul").tabs();
$("#tabs > ul").bind("tabsshow", function(event, ui) {
window.location = ui.tab.hash;
}) 
```

这导致 IE7 和 FF3 中的行为相同，将页面向下移动到所选选项卡的顶部。

我希望更改选项卡，更新哈希，但页面根本没有移动，这就是我的第一个示例在 FF3 中的工作方式，但在 IE7 中则不然。

谢谢。

注释：JQuery 1.3.1 / JQuery-UI 1.6rc6

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-12-13T06:30:47.767

如果页面上有一个元素与您设置哈希的 id 相同，例如您尝试将浏览器哈希设置为 #cars 并且页面上已经有一个 div#cars，浏览器将向下滚动到该 div 所在的位置。

据我所知，有 3 种可能的解决方法

1）将浏览器哈希更改为其他内容，例如#thecars。

2）以类似的方式更改现有标记。

3）在某些情况下，更改名称相似的标记的 id，然后更改浏览器哈希，然后将标记的名称重新更改回其原始值，理论上也应该有效。这显然是一个糟糕而缓慢的解决方法，只是想我会提到它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-12-14T13:52:24.717

克里斯的建议对我有用，甚至不知道 div 可以通过 # 链接。所以我的解决方案很简单，在节目中：事件处理程序，我执行以下操作，它并不完美，因为后退按钮不会出现在历史记录中，但这是 BBQ 历史记录插件的另一项工作。我所有的 div 都只有 id="tab-cars", id="tab-trucks"... 去掉 'tab-' 部分并将其放入 url 哈希中。

```
var name = ui.panel.id.substr(4);
location.hash = '#'+name; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-21T06:59:58.387

您可以尝试“return false”；设置窗口位置后，但我不能确定。

不幸的是，您的问题不会就此结束。在多个浏览器之间来回导航还有其他问题——什么都不会改变，页面可能会重新加载，页面状态可能会被破坏，javascript 可能会重新初始化等。

您可能想查看使用[History/Remote插件的](http://stilbuero.de/jquery/history/index.html)[Tabs v2](http://stilbuero.de/jquery/tabs/) ，尽管它[尚未](http://docs.jquery.com/UI/Tabs#Back_button_and_bookmarking)针对 jQuery 1.3+ 进行更新。

这个[演示](http://stilbuero.de/jquery/ui_history/)更容易理解。如果您查看 javascript[源代码](http://stilbuero.de/jquery/ui_history/ui.history.js)，您会注意到使用 iframe 来处理状态。

还有[History Event](http://plugins.jquery.com/project/historyevent)插件和[jHistory](http://plugins.jquery.com/project/jHistory)插件来实现你想要的。

想听听结果如何以及您采用了什么解决方案。

# google-maps - 我可以将用户限制在 Google 地图上的特定范围和缩放级别吗？

> ID：572404
> 
> 赞同：3
> 
> 时间：2009-02-21T05:33:12.760
> 
> 标签：google-maps, range, coordinates, limit

我正在网页上实现谷歌地图。出于这个项目的目的，我想限制用户可以拖动地图的距离，以便他们只能查看位于两个坐标内的某个区域（一个指定西北，另一个指定东南，如果你明白我的意思）。

使用 Google Maps API 实现此功能的最佳方法是什么？

有没有我可以调用的方法可以自动执行此操作？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-21T05:36:20.740

此方法可以满足您的要求：[http ://econym.org.uk/gmap/range.htm](http://econym.org.uk/gmap/range.htm)

# voting - 如何禁止或删除不守规矩或滥用的 SO cit

> ID：572407
> 
> 赞同：4
> 
> 时间：2009-02-21T05:34:02.523
> 
> 标签：voting

显然需要有一种我认为的方式？

编辑：重复 [https://stackoverflow.com/questions/572113/how-to-deal-with-repeated-abuse](https://stackoverflow.com/questions/572113/how-to-deal-with-repeated-abuse)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-21T05:35:09.180

我今天已经使用了我的 5 个攻击性标签和 12 个关闭投票

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-21T05:40:51.913

如果您将“i-am-mad”添加到您忽略的标签中，它会有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-21T05:37:02.063

查看评论中发布的 uservoice 链接，这些类型的帖子属于 uservoice，或者它们只是对非编程相关的帖子做出贡献。

请参阅：[https ://stackoverflow.com/questions/572113/how-to-deal-with-repeated-abuse](https://stackoverflow.com/questions/572113/how-to-deal-with-repeated-abuse)

# sql-server-2005 - 重置主键（int 作为身份）

> ID：572446
> 
> 赞同：1
> 
> 时间：2009-02-21T05:39:58.000
> 
> 标签：sql-server-2005, tsql

我有一个主键为 bigint 的表（身份属性是 Yes 并且从 1 到 1 开始）。该表正在生产中，并且每天都会更新：大量删除和插入。

问题是这个密钥现在变得太大了，有 8 个数字。我最终担心有一天会溢出。

幸运的是，此键不用作任何其他表的外键。它仅用于标识表中的一行。因此，我可以再次从 1 开始安全地重置键值，也许每年一次。

我可以创建一个空白表并在那里复制其他字段数据，然后删除原始表中的所有行，重置键/表，最后将数据复制回来。

不确定 Microsoft SQL 2005 中是否有内置的 sp_xxx 可以完成这项工作：只是从 1 开始按顺序重置主键而不影响其他列数据？或者任何其他简单的解决方案？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-21T05:43:38.880

bigint 的最大值是[9,223,372,036,854,775,807](http://msdn.microsoft.com/en-us/library/ms187745.aspx)。如果您一天达到 8 位数，您仍然需要 10 ^(11)天才能达到最大值。这就像2500万年。

假设您仍然想重置列，我的第一个问题是：行的顺序重要吗？意思是您是否依赖于第 1000 行在 1100 之前的事实，例如，按时间顺序或其他绝对顺序？如果没有，这很容易：删除列并再次添加。嘿，新的价值观。

如果您需要维护订单，则需要更加小心：

1.  锁表；
2.  更改类型，使其不再自动递增；
3.  创建一个新列。你最好暂时让它没有索引，因为更新索引会减慢插入速度；
4.  使用某种递增计数器（如 SQL Server rownum 技巧）的循环填充第二个中的值，以对插入进行排序以匹配原始顺序；
5.  用新柱替换旧柱；
6.  重置自动增量和主键状态。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-21T07:47:40.033

创建一个名称不同但列完全相同的新表。从 old_table 中插入到 new_table 中。然后删除旧表并重命名新表。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-21T05:47:57.607

如果您使用的是 BIGINT，那么您甚至还没有接近溢出它。如果一年后你只有 10,000,000，那么你可以坚持一百万年，仍然没问题。

# perl - 混合语言 Web 开发环境

> ID：572476
> 
> 赞同：6
> 
> 时间：2009-02-21T05:50:06.323
> 
> 标签：perl, programming-languages, development-environment

在我的工作中，我继承了一个广泛的、设计不当的网络投资组合。大多数页面都是用 Perl 编写的，因为网站上摄取、处理和显示的大多数数据都以平面文件的形式出现，然后必须在我们的 MySQL 和 Oracle 数据库中进行细致的正则表达式和数据库化。

作为该环境中第一个受过 IT 培训的经理，我自己负责清理网站并为开发过程制定一些结构。我得到的选择之一是选择是否继续使用 Perl。Java 有大量内部人才，PHP 很容易学习。我考虑过让开发人员放手，让他们选择他们想为他们的页面使用的任何语言，但是如果选择 PHP 的人被公共汽车撞到并且没有其他人可以修复它，这听起来可能会很麻烦。

随着岁月的流逝，雇用 Perl 程序员变得越来越困难，维护以前的开发人员的遗留 Perl 代码的复杂性可能只是让页面启动和运行，这变得非常耗费资源。另一位以前的（非 IT）经理更专注于快速周转和立即满足页面，而不是确保第一次就正确完成（此后他在我们的分支机构之外被提升）。

生产服务器是solaris。MySQL 拥有我们的大部分数据，但新项目已经开始越来越多地使用 Oracle（用于 GIS 数据）。Web 服务器普遍采用 Apache。我们生活在一个与常规互联网断开连接的内部网中。我们的开发以敏捷、迭代的方式进行。

无论选择何种语言推进，都有资源可以对现有的开发人员进行再培训。无论如何，进入我们环境的数据将不得不被正则表达式死掉，所以 perl 不会很快消失。我向社区提出的问题是，对于上述定义的 Web 开发环境，以下语言的优缺点是什么：Perl、PHP、Java、Python 和 -- 在此处插入您最喜欢的语言 --。如果让您重来一遍，您会选择哪种语言设置？

**编辑和澄清：** 让我澄清一下我原来的帖子。我不会把所有东西都扔掉。我有机会将船的航向调整到我认为更好的航向。即使我选择了一种新语言，perl 代码也会在未来一段时间内出现。

假设地说，如果我选择汇编作为我的新语言（哈哈），我可能不得不通过将老开发人员发送到一些基本的汇编类来让他们加快速度。新页面/项目将使用新语言，旧页面/项目必须与新页面/项目配合得很好。有些有一天可能会被重写成新的语言，有些可能永远不会改变。

Perl 中可能永远存在的将是我们多年前编写的用于从平面文件中筛选和数据库信息的解析脚本。但这没关系，因为它们不与网页交互，它们与数据库交互。

谢谢大家的意见，到目前为止它非常有帮助。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-21T07:25:03.130

与语言本身相比，您的问题似乎更多的是遗留代码和非正式的开发方法。因此，如果您已经拥有 Perl 开发人员，为什么不开始现代化您的方法和代码库，而不是切换到新语言并创建异构代码库。

[现代 Perl](http://www.modernperlbooks.com/)提供了很多好的实践和强大的工具：强调测试，使用[Test::*](http://search.cpan.org/search?query=Test::&mode=dist)模块和[WWW::Mechanize](http://search.cpan.org/dist/WWW-Mechanize/)，数据库交互可以通过普通的[DBI](http://search.cpan.org/perldoc/DBI)完成，也可以使用 ORM 模块，如优秀的[DBIx ::Class ，带有](http://search.cpan.org/perldoc/DBIx::Class)[Moose](http://www.iinteractive.com/moose)的OO现在与更现代的语言相提并论，[mod_perl](http://search.cpan.org/perldoc/mod_perl)使您可以访问 Apache 中的大量功能。Perl也有很多[MVC 框架](http://search.cpan.org/search?query=mvc&mode=all)。引起广泛关注的是[Catalyst](http://catalystframework.org)。

投资一些[Perl Best Practices](http://www.google.com/search?btnI=&q=Perl+Best+Practices+site:oreilly.com)的副本，为一些现代开发方法的课程带来合适的培训师，并开始改变您团队的文化。

如果你很难找到已经精通 Perl 的开发人员，你总是可以雇佣优秀的 PHP 人员并培训他们，这应该不会太难。至少他们愿意学习一门新语言将是他们灵活性和改进意愿的良好标志。

总是很想将代码的状态归咎于其编写的语言，但在你的情况下，我不确定情况是否如此。[许多大公司](http://www.google.com/search?btnI=&q=companies+using+perl)似乎在使用 Perl 管理庞大的代码库时没有问题，名单很长，但主要的 Web 公司都在那里，还有一些金融机构。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-21T18:01:24.753

我会请一个非常擅长的人`Perl`，至少看看当前的设计。他们将能够告诉您`Perl`代码到底有多糟糕，以及需要做些什么才能使其处于良好状态。

那时我会开始考虑我的选择。如果`Perl`代码是可以挽救的，那就是聘请精通`Perl`. 还要培训一些现有的员工来帮助现有的代码库。如果您没有精通代码的人`Perl`，`Perl`您的代码库可能会变得比现在更糟。

只有当它的形状很糟糕时，我才会考虑放弃它而改用另一种语言。那是什么语言，那是你必须自己考虑的事情。

*ps 我有点偏见，我更喜欢`Perl`*

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-21T06:34:59.770

如果正则表达式很重要，我会选择一种支持良好的语言。

如果您使用 java，您将无法从 perl 代码中复制粘贴您的正则表达式代码，因为斜杠必须被转义。所以我会投票反对java。

我对 php 的熟悉程度不足以了解其正则表达式功能，但鉴于您的选择，我会选择 python。您可以在 python 中创建更清晰的代码。

红宝石也是一种选择吗？它还具有良好的 perl（如 regex 支持）和 rails 支持开箱即用的敏捷 Web 开发。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-21T06:42:40.907

首先让我指出[MySQL 的空间扩展与 GIS 一起使用](http://dev.mysql.com/tech-resources/articles/4.1/gis-with-mysql.html)。

其次，如果你有一群 Perl 程序员需要在新站点上拖拽，那么你最好的选择是选择他们不会有太多理解困难的东西。显而易见的“东西”是PHP。当我学习 PHP 时，我在几年前就学过一些 Perl，并且很快就学会了 PHP。

切换到 Java 或 .Net（甚至 Ruby on Rails）之类的东西将是设计上的一个更加戏剧性的转变。

再加上 Apache 服务器，您已经设置好了环境，并且您可以相当容易地将任何开发作为 Perl 和 PHP 的组合进行。

至于你问题的最后一部分：如果你可以重来一次，你会做什么？对我来说，这是一个独立且基本上不相关的问题。事实是你没有倒带和重新开始，你只是......重新开始。因此，遗产支持、过渡、技能发展和所有其他问题远比任何假设的问题重要得多，即如果所有其他条件都相同，那么在完美世界中你会选择什么。

爱它或恨它，PHP 很受欢迎，而且很快就会无处可去。找到熟练的人来做这件事并不太难（好吧，困难在于将他们从自学的牛仔脚本骑手中过滤掉，他们认为自己可以编码但不会），而且与基于 Web 的 Perl 相差不远。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-21T19:04:56.363

如果您的开发人员表现出色，他们将能够处理向他们抛出的任何问题。决定使用什么语言是一个相当棘手的战略立场，但我建议您在介绍任何更多（即不要）之前仔细考虑。

当然，除非你用你所拥有的东西绝对不能做（或不能理智地做）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-21T06:20:13.847

我认为选择单一语言是关键，如果您的数据库主要是 MySQL，那么 PHP 似乎是显而易见的选择。它自然适用于您的数据库，它是开源的，并且有大量的文档、源代码，不需要编译等。

人们来来往往，任何网站都会随着时间的推移而发展。如果你有能力制定一些指导方针和规则，我会选择一些宽容、普遍和容易（呃）学习的东西。

我还建议把它写下来，这样将来的人们就不会重新发明轮子。

# servlets - 为什么带有空格的 cookie 值带有引号到达客户端？

> ID：572482
> 
> 赞同：29
> 
> 时间：2009-02-21T05:54:00.913
> 
> 标签：servlets, cookies, encoding

我是一名 .NET 开发人员，开始涉足 Java。

在 .NET 中，我可以将 cookie 的值设置为其中包含空格的字符串： `new HttpCookie("myCookieName", "my value")`- 当我在客户端（JavaScript）读取该值时，我得到了我期望的值（我的值）。

如果我在 Java servlet - 中做同样的事情`new Cookie("myCookieName", "my value")`，我会得到包含双引号的值（“我的值”）。

为什么有区别？我错过了什么吗？在 Java 世界中人们如何处理这个问题？您是否对值进行编码，然后在客户端进行解码？

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2011-08-29T18:06:30.263

当您使用中提到的以下值之一设置 cookie 值时[`Cookie#setValue()`](http://download.oracle.com/javaee/6/api/javax/servlet/http/Cookie.html#setValue%28java.lang.String%29)，

> 对于版本 0 cookie，值不应包含空格、方括号、圆括号、等号、逗号、双引号、斜杠、问号、at 符号、冒号和分号。空值在所有浏览器上的行为方式可能不同。

那么一般容器会隐式地将 cookie 设置为版本 1（[RFC 2109 规范](http://www.ietf.org/rfc/rfc2109.txt)）而不是默认版本 0（[Netscape 规范](http://curl.haxx.se/rfc/cookie_spec.html)）。该行为不是由 Servlet API 指定的，容器可以自由地实现它（例如它可能会抛出一些`IllegalArgumentException`）。据我所知，Tomcat、JBoss AS 和 Glassfish 在隐式更改 cookie 版本方面的行为都相同。至少对于 Tomcat 和 JBoss AS，这是修复[此安全问题](https://www.redhat.com/security/data/cve/CVE-2007-5333.html)的结果。

版本 1 cookie 如下所示：

```
name="带空格的值";Max-Age=3600;Path=/;Version=1
```

而版本 0 兼容的 cookie 看起来像这样：

```
name=value%20with%20spaces;Expires=Mon, 29-Aug-2011 14:30:00 GMT;Path=/
```

*（请注意，URL 编码的值对版本 0 有效）*

重要说明是 Microsoft Internet Explorer 不支持版本 1 cookie。甚至不是当前的 IE 11 版本。它会将引号解释为整个 cookie 值的一部分，并将相应地处理并返回它。它不支持该`Max-Age`属性，并且会完全忽略它，这会导致 cookie 的生命周期默认为浏览器会话。您显然是在使用 IE 来测试您的 webapp 的 cookie 处理。

为了也支持 MSIE，如果 cookie 值可能包含对版本 0 无效的字符，您确实需要自己对 cookie 值进行 URL 编码和 URL 解码。

```
Cookie cookie = new Cookie(name, URLEncoder.encode(value, "UTF-8"));
// ... 
```

和

```
String value = URLDecoder.decode(cookie.getValue(), "UTF-8"));
// ... 
```

为了支持全球受众的版本 1 cookie，您将真正等待 Microsoft 修复缺少 MSIE 支持的问题，并且带有修复程序的浏览器已成为主流。换句话说，这需要很*长时间*（更新：截至目前，5 年多之后，它似乎永远不会发生）。同时，您最好坚持使用版本 0 兼容的 cookie。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-21T11:21:41.953

据我所知，空格必须在 cookie 中编码。不同的浏览器对未编码的 cookie 的反应不同。您应该在设置 cookie 之前对其进行 URL 编码。

```
String cookieval = "my value";
String cookieenc = URLEncoder.encode(cookieval, "UTF-8");
res.addCookie(new Cookie("myCookieName", cookieenc)); 
```

ASP.NET 自动进行编码，在 Java 中您必须自己进行。我怀疑您看到的引号是由用户代理添加的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-21T06:30:10.017

它可能与 Java 对 cookie 的编码方式有关。我建议您尝试在新 cookie 上调用[setVersion(1)](http://java.sun.com/javaee/5/docs/api/javax/servlet/http/Cookie.html#setVersion(int))并查看它是否适合您。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-08-29T03:23:58.380

尝试使用 setVersion(0)。

```
HttpCookie cookie = new HttpCookie("name", "multi word value");
System.out.println(cookie.toString()); 
```

印刷：

name="几个字值"

但是设置后

```
cookie.setVersion(0);
System.out.println(cookie.toString()); 
```

印刷：

名称=几个字值

编码也是一个好主意，但值周围的引号看起来是一个独立的问题。

# version-control - 如何组织我的所有代码、数据、脚本、任务等？

> ID：572519
> 
> 赞同：14
> 
> 时间：2009-02-21T06:18:43.320
> 
> 标签：version-control, project-management, code-organization, project-organization

您会向“单人团队”推荐哪些工具或方法来保持井井有条？

我正在做涉及大量编码的研究，编写数百个一次性的 perl 脚本，在找到更好的方法之前使用的 C++ 二进制文件，以不同方式预处理的大量数据，其中一些新的预处理使旧方式已过时——直到我发现旧方式实际上更好，依此类推。我的工作本质上是一个移动的目标，因为我必须尝试很多事情，而且往往没有一个是完美的。

这不是一个完全混乱的情况，但也远非完美。在这种情况下，您会推荐一般方法吗？我确实使用`SVN`了我的代码，但不是用于不同版本的数据，因为它太大了。很难跟踪所有脚本和二进制文件，所以我总是评论它们，写下我是如何运行它们的等等。但我很好奇你是否还有其他想法。

（我在linux系统上工作。）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-21T06:55:54.197

我正在使用一个 wiki（在我的例子中是 TiddlyWiki，因为它可以在任何地方运行——它只需要一个带有 JavaScript 的浏览器）作为我的“工程师笔记本”。几乎所有内容都在其中 - 问题列表（以及稍后的答案）、程序（分步说明）、我放在哪里的注释（可能适用于您的“数据”）、电话号码（很容易找到完整的文本搜索），任何事情都会发生。

由于我的任务不是那么繁重的代码，我什至用它来存储代码片段（对我来说主要是 SQL 语句）。如果您想跟踪不同的版本，使用“真正的”版本控制系统会更好。除了“使用它”之外，我无法为该领域提供具体建议。

然而，在 GTD 时尚中对我来说很重要的是：对几乎所有事情都使用简单的系统。这样一来，寻找东西和决定把什么放在哪里的时间就被缩短了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-21T06:28:34.140

**将所有**代码保存在版本控制系统中，并为每个代码创建构建/运行脚本。您将不得不仔细归档您的数据（因为您不想将其放入 SVN 中）。

我要添加的另一件事是 wiki，因此您可以快速记录每个测试/脚本/应用程序。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-21T06:43:14.527

为什么不检查一些开源项目，看看他们如何组织他们的代码库？

即使你是一个人的团队。组织你的项目是很聪明的，这样很容易添加更多的程序员。

另外，如果您担心数据文件的文件大小，您可能需要检查 git。索引大小通常比 svn 小很多。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-21T08:24:56.560

**正如其他人所说，版本控制**是必须的。我认为在版本控制上保留里程碑的描述性标签非常有帮助。

正如 IronGoofy 所说，我将我的片段保存在我的**Personal Wiki** [TiddlyWiki](http://www.tiddlywiki.com/)中，我将其上传到我的网站，因此我可以随时随地访问它。

作为一个附加选项，您可能会认为**时间跟踪器**应用程序。有许多免费的时间跟踪器。我使用[ASP.NET 的 Time Tracker Starter Kit](http://www.asp.net/downloads/starter-kits/time-tracker/)。您可以保持软件、错误修复、里程碑的发展。

# c# - 如何使用 C# 将 pdf 文件插入和读取到 Sql Server 2005 数据库

> ID：572525
> 
> 赞同：5
> 
> 时间：2009-02-21T06:26:59.667
> 
> 标签：c#, sql-server, pdf

如何将pdf文件插入sqlserver 2005并从sqlserver读取pdf文件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-21T06:36:53.807

如果您对使用数据库进行文件存储感兴趣，请查看[这篇 4guysfromrolla 文章](http://aspnet.4guysfromrolla.com/articles/120606-1.aspx)。它是面向网络的，但找到你需要的东西应该没有问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-11T06:23:36.563

要将其放入数据库，您必须将其读入字节数组。从文件系统中读取它或使用 AspNetFileUploadWebControl.FileBytes 属性。创建一个插入存储过程并添加字节数组作为 DB 列的参数（该列必须是 SQL 数据类型“图像”）。

要将其从数据库中取出，请使用以下内容：

```
theRow = getDatarowFromDatabase();
aByteArrayOfTheFile = (byte[])theRow["theSqlImageColumnWithTheFileInIt"]; 
```

要允许用户查看或下载它，请使用我的方法 SendAsFileToBrowser()：

```
SendAsFileToBrowser(aByteArrayOfTheFile, "application/pdf", "downloaded.pdf"); 
```

该方法的源代码（带有重载）：

 `````
 // Stream a binary file to the user's web browser so they can open or save it.
    public static void SendAsFileToBrowser(byte[] File, string Type, string FileName)
    {
        string disp = "attachment";
        if (string.IsNullOrEmpty(FileName))
        {
            disp = "inline";
        }

        // set headers
        var r = HttpContext.Current.Response;
        r.ContentType = Type; // eg "image/Png"
        r.Clear();
        r.AddHeader("Content-Type", "binary/octet-stream");
        r.AddHeader("Content-Length", File.Length.ToString());
        r.AddHeader("Content-Disposition", disp + "; filename=" + FileName + "; size=" + File.Length.ToString());
        r.Flush();

        // write data to requesting browser
        r.BinaryWrite(File);
        r.Flush();
    }
    //overload
    public static void SendAsFileToBrowser(byte[] File, string Type)
    {
        SendAsFileToBrowser(File, Type, "");
    }
    // overload
    public static void SendAsFileToBrowser(System.IO.Stream File, string Type, string FileName)
    {
        byte[] buffer = new byte[File.Length];
        int length = (int)File.Length;
        File.Write(buffer, 0, length - 1);
        SendAsFileToBrowser(buffer, FileName, Type);
    } 
````  `* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-21T09:21:47.857

本质上，您只是在谈论 BLOB 存储和检索（`image`或`varbinary(max)`数据）。看到这个问题：[直接流式传输到数据库](https://stackoverflow.com/questions/252517/streaming-directly-to-a-database/252973)

# svn - 在 Subversion 中与团队成员进行高效的微合作？

> ID：572538
> 
> 赞同：2
> 
> 时间：2009-02-21T06:40:58.930
> 
> 标签：svn

有时我正在开发一个功能并遇到奇怪的崩溃或其他我无法立即解决的问题。然后我想把我当前的源代码提供给我旁边的人，这样他也可以尝试解决它。

好像我有 3 个不好的选择和 0 个好的选择？

*   将其提交到主干，以便他可以获取我的更改。**不！**代码未完成
*   创建一个工作分支并在那里提交。当我只是在做一个小功能时，不值得麻烦。
*   做一个`svn diff`，通过 ssh 向他发送补丁并让他应用它。仍然不值得麻烦

**在 Subversion 中处理这个问题的标准方法是什么？**

另外：像 git 这样的 DVCS 工具会比 Subversion 更好地处理这种看似简单的情况吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-21T06:44:27.720

我过去曾使用 send-a-patch 方法完成此操作。但是，以后很难协调这些更改。

我现在使用 Git，它对这种情况肯定有帮助，这是一件很自然的事情。我可以让牛人从我的存储库中提取特定的提交并帮助处理它们。我们每个人都可以提交，然后我可以从他们的存储库中提取提交，`git rebase -i`用于组织所有内容，然后从那里继续。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-21T07:45:33.220

subversion 的问题（我是作为它的日常用户这么说的）是它没有促进尽早和经常检查源代码控制的想法。由于集中分支，在代码“准备好”（空中报价）之前，通常没有人签入。以前在与小型团队合作时，我在 Subversion 中创建了每个用户的分支。所以你的回购可能会分解如下

```
/
`---> trunk/
`---> branches/
`---> users/
            `---> john/
                      `---> trunk/
                      `---> branches/
            `---> mary/
                      `---> trunk/
                      `---> branches/ 
```

颠覆可能会开始变得有点混乱，我不确定它对于大型团队的效果如何。SVNmerge 可以帮助解决一些问题，但它可能是您的一种可能的解决方案。git（通常是大多数 DCVS）可以消除这些问题中的大部分，这是它们受欢迎的原因之一。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-21T07:26:38.117

我通常会采取权宜之计，将违规代码通过电子邮件发送（或以其他方式传输）给我的同事，假设她/他在该单元（或那些单元）中没有无法暂时改组的更改。然后她/他将我的更改复制到适当的位置并开始工作。没有比这更多或更少的了。后来，当他们进行 diff 时，他们会在他们的 diff 中看到我的更改，从存储库更新以覆盖他们帮助过的我的代码，然后瞧。一切恢复正常。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-21T19:27:14.237

如果其他人真的坐在你旁边，我可以建议结对编程吗？他们可以来到你的电脑上，你可以一起工作。它可能非常有效，当您遇到麻烦时，您不必孤立地工作。

话虽如此，即使使用结对编程，有时您也必须将代码发送给尚未准备好进行中继的其他人。除了涉及的打字之外，在 subversion 中创建一个短暂的分支并不多，一些小脚本会为您自动化很多过程。

这里有两个对我有用的脚本。他们假设一个存储库结构，如：

```
project/trunk/
       /branches/some_branch
                /another_branch 
```

需要进行一些调整才能与其他结构一起使用。

```
# script 1: svn_wc2b (working copy to branch)
trunk_url=`svn info | grep URL | sed 's/URL: //'`
project_base=`svn info | grep URL | sed 's/URL: //;s/\/trunk.*//'`
branch_name=my_working_copy

svn cp $trunk_url $project_base/branches/$branch_name -m "Creating temporary branch for working copy."
svn switch $project_base/branches/$branch_name 
```

然后，当您想要共享主干的工作副本时，您可以键入：

```
svn_wc2b  # creates branch, switches to it    
svn commit # commit your in-progress work to the branch 
```

要获取您的代码，其他开发人员只需键入：

```
svn switch http://repository/project/branches/my_working_copy 
```

当其他开发人员完成并提交更改时，请使用如下脚本：

```
# script 2: svn_b2wc (branch to working copy)
branch_revision=`svn log -q --stop-on-copy | grep '^r[0-9]' | sed 's/^r//;s/ |.*//' | tail -n 1`

if [ -e $branch_revision ] && [ -e $1 ]
then
  echo "Couldn't get branch creation revision number. Check svn log --stop-on-copy and use svn_b2wc <revision_number>"
  exit
elif [ -e $branch_revision ]
then
  branch_revision=$1
fi

branch_url=`svn info | grep URL | sed 's/URL: //'`
project_base=`svn info | grep URL | sed 's/URL: //;s/\/branches.*//'`
branch_name=my_working_copy

svn switch $project_base/trunk
svn merge -r $branch_revision:HEAD $branch_url .
svn delete $branch_url -m "Deleting working copy branch." 
```

从已切换到分支的目录中，键入：

```
svn_b2wc # switch back to trunk, merge branch changes, delete branch 
```

分支中更改的代码现在回到了主干的工作副本中，您可以继续工作，直到准备好提交。仅仅共享一些代码似乎很多，但是如果您花一些时间使用脚本自动化您的流程，那么每次您需要使用它时只需要几秒钟。

# c - C中的“静态”是什么意思？

> ID：572547
> 
> 赞同：1298
> 
> 时间：2009-02-21T06:47:52.017
> 
> 标签：c, syntax, static

我`static`在 C 代码的不同地方看到过这个词；这是否像 C# 中的静态函数/类（实现在对象之间共享）？

* * *

## 回答 #1

> 赞同：1705
> 
> 时间：2009-02-21T06:51:55.270

1.  函数内的静态变量在调用之间保持其值。
2.  静态全局变量或函数仅在其声明的文件中“可见”

如果您是新手，（1）是比较陌生的话题，所以这里有一个例子：

```
#include <stdio.h>

void foo()
{
    int a = 10;
    static int sa = 10;

    a += 5;
    sa += 5;

    printf("a = %d, sa = %d\n", a, sa);
}

int main()
{
    int i;

    for (i = 0; i < 10; ++i)
        foo();
} 
```

这打印：

```
a = 15, sa = 15
a = 15, sa = 20
a = 15, sa = 25
a = 15, sa = 30
a = 15, sa = 35
a = 15, sa = 40
a = 15, sa = 45
a = 15, sa = 50
a = 15, sa = 55
a = 15, sa = 60 
```

这对于函数需要在调用之间保持某些状态并且您不想使用全局变量的情况很有用。但是请注意，应该非常谨慎地使用此功能 - 它会使您的代码不是线程安全的并且更难理解。

(2) 被广泛用作“访问控制”功能。如果您有一个实现某些功能的 .c 文件，它通常只向用户公开一些“公共”功能。它的其余功能应该被制作`static`，这样用户将无法访问它们。这是封装，一个很好的做法。

引用[维基百科](http://en.wikipedia.org/wiki/Static_variable)：

> 在 C 编程语言中，静态与全局变量和函数一起使用，以将其范围设置为包含文件。在局部变量中，static 用于将变量存储在静态分配的内存中，而不是自动分配的内存中。虽然语言没有规定这两种内存的实现方式，但静态分配的内存通常在编译时保留在程序的数据段中，而自动分配的内存通常实现为临时调用堆栈。

为了回答你的第二个问题，它不像在 C# 中。

然而，在 C++ 中，`static`也用于定义类属性（在同一类的所有对象之间共享）和方法。在 C 中没有类，所以这个特性是无关紧要的。

* * *

## 回答 #2

> 赞同：262
> 
> 时间：2013-05-01T07:13:16.000

这里没有介绍另外一种用途，即作为数组类型声明的一部分，作为函数的参数：

```
int someFunction(char arg[static 10])
{
    ...
} 
```

在此上下文中，这指定传递给此函数的参数必须是一个类型数组，`char`其中至少包含 10 个元素。有关更多信息，请参阅我的[问题](https://stackoverflow.com/questions/3430315/purpose-of-static-keyword-in-array-parameter-of-function)。

* * *

## 回答 #3

> 赞同：187
> 
> 时间：2009-02-21T06:56:59.610

简短的回答......**这取决于。**

1.  静态定义的局部变量在函数调用之间不会丢失它们的值。换句话说，它们是全局变量，但作用域仅限于定义它们的局部函数。

2.  静态全局变量在定义它们的 C 文件之外是不可见的。

3.  静态函数在定义它们的 C 文件之外是不可见的。

* * *

## 回答 #4

> 赞同：78
> 
> 时间：2013-01-15T13:41:26.803

**多文件变量范围示例**

在这里，我说明了 static 如何影响跨多​​个文件的函数定义的范围。

交流

```
#include <stdio.h>

/*
Undefined behavior: already defined in main.
Binutils 2.24 gives an error and refuses to link.
https://stackoverflow.com/questions/27667277/why-does-borland-compile-with-multiple-definitions-of-same-object-in-different-c
*/
/*int i = 0;*/

/* Works in GCC as an extension: https://stackoverflow.com/a/3692486/895245 */
/*int i;*/

/* OK: extern. Will use the one in main. */
extern int i;

/* OK: only visible to this file. */
static int si = 0;

void a() {
    i++;
    si++;
    puts("a()");
    printf("i = %d\n", i);
    printf("si = %d\n", si);
    puts("");
} 
```

主程序

```
#include <stdio.h>

int i = 0;
static int si = 0;

void a();    

void m() {
    i++;
    si++;
    puts("m()");
    printf("i = %d\n", i);
    printf("si = %d\n", si);
    puts("");
}

int main() {
    m();
    m();
    a();
    a();
    return 0;
} 
```

[GitHub 上游](https://github.com/cirosantilli/cpp-cheat/tree/b075d2d54c62c684cd03c17bb39fa1d6a8fd9bd6/static).

编译并运行：

```
gcc -c a.c -o a.o
gcc -c main.c -o main.o
gcc -o main main.o a.o 
```

输出：

```
m()
i = 1
si = 1

m()
i = 2
si = 2

a()
i = 3
si = 1

a()
i = 4
si = 2 
```

**解释**

*   有两个单独的变量`si`，每个文件一个
*   有一个共享变量`i`

像往常一样，范围越小越好，所以`static`如果可以的话，总是声明变量。

在 C 编程中，文件经常被用来表示“类”，而`static`变量表示类的私有静态成员。

**关于它的标准是什么**

[C99 N1256 草案](http://www.open-std.org/JTC1/SC22/WG14/www/docs/n1256.pdf)6.7.1“存储类说明符”说这`static`是一个“存储类说明符”。

6.2.2/3“标识符的链接”说`static`暗示`internal linkage`：

> 如果对象或函数的文件范围标识符的声明包含存储类说明符 static，则该标识符具有内部链接。

并且 6.2.2/2 表示其`internal linkage`行为类似于我们的示例：

> 在构成整个程序的一组翻译单元和库中，具有外部链接的特定标识符的每个声明都表示相同的对象或函数。在一个翻译单元中，具有内部链接的标识符的每个声明都表示相同的对象或函数。

其中“翻译单元是预处理后的源文件。

**GCC 如何为 ELF (Linux) 实现它？**

与`STB_LOCAL`绑定。

如果我们编译：

```
int i = 0;
static int si = 0; 
```

并使用以下命令反汇编符号表：

```
readelf -s main.o 
```

输出包含：

```
Num:    Value          Size Type    Bind   Vis      Ndx Name
  5: 0000000000000004     4 OBJECT  LOCAL  DEFAULT    4 si
 10: 0000000000000000     4 OBJECT  GLOBAL DEFAULT    4 i 
```

所以绑定是它们之间唯一的显着区别。`Value`只是它们在该`.bss`部分中的偏移量，因此我们希望它会有所不同。

`STB_LOCAL`记录在[http://www.sco.com/developers/gabi/2003-12-17/ch4.symtab.html](http://www.sco.com/developers/gabi/2003-12-17/ch4.symtab.html)的 ELF 规范中：

> STB_LOCAL 局部符号在包含其定义的目标文件之外不可见。同名的本地符号可以存在于多个文件中，互不干扰

这使它成为代表的完美选择`static`。

没有 static 的变量是`STB_GLOBAL`，并且规范说：

> 当链接编辑器组合几个可重定位的目标文件时，它不允许同名的 STB_GLOBAL 符号的多个定义。

这与多个非静态定义上的链接错误一致。

如果我们用 来加速优化`-O3`，该`si`符号将从符号表中完全删除：无论如何它不能从外部使用。TODO 为什么在没有优化的情况下将静态变量保留在符号表中？它们可以用于任何事情吗？也许是为了调试。

**也可以看看**

*   功能类似`static`：[https ://stackoverflow.com/a/30319812/895245](https://stackoverflow.com/a/30319812/895245)
*   `static`与“相反”比较`extern`：[如何使用 extern 在源文件之间共享变量？](https://stackoverflow.com/questions/1433204/how-do-i-use-extern-to-share-variables-between-source-files-in-c)

**C++ 匿名命名空间**

在 C++ 中，您可能希望使用匿名命名空间而不是静态，这可以达到类似的效果，但进一步隐藏了类型定义：[未命名/匿名命名空间与静态函数](https://stackoverflow.com/questions/154469/unnamed-anonymous-namespaces-vs-static-functions)

* * *

## 回答 #5

> 赞同：40
> 
> 时间：2009-02-21T06:57:16.050

这取决于：

```
int foo()
{
   static int x;
   return ++x;
} 
```

该函数将返回 1、2、3 等。 --- 变量不在堆栈上。

### 交流：

```
static int foo()
{
} 
```

这意味着此函数仅在此文件中具有作用域。所以 ac 和 bc 可以有不同`foo()`的 s，而 foo 不会暴露给共享对象。因此，如果您在 ac 中定义了 foo ，您将无法`b.c`从任何其他地方访问它。

在大多数 C 库中，所有“私有”函数都是静态的，而大多数“公共”函数不是。

* * *

## 回答 #6

> 赞同：26
> 
> 时间：2016-04-27T13:47:26.907

人们一直说 C 中的“静态”有两个含义。我提供了另一种查看方式，赋予它单一的含义：

*   将“静态”应用于项目会强制该项目具有两个属性： (a) 它在当前范围之外不可见；(b) 它是持久的。

它似乎有两种含义的原因是，在 C 中，可以应用“静态”的每个项目都*已经具有这两个属性之一*，因此该特定用法*似乎*只涉及另一个。

例如，考虑变量。在函数之外声明的变量已经具有持久性（在数据段中），因此应用“静态”只能使它们在当前范围（编译单元）之外不可见。相反，在函数内部声明的变量在当前范围（函数）之外已经不可见，因此应用“静态”只能使它们持久化。

将“静态”应用于函数就像将其应用于全局变量一样 - 代码必须是持久的（至少在语言内），因此只能更改可见性。

*注意：这些注释仅适用于 C。在 C++ 中，将“静态”应用于类方法确实赋予了关键字不同的含义。对于 C99 数组参数扩展也是如此。*

* * *

## 回答 #7

> 赞同：19
> 
> 时间：2009-02-21T06:55:20.050

`static`在不同的语境下有不同的意思。

1.  您可以在 C 函数中声明静态变量。此变量仅在函数中可见，但它的行为类似于全局变量，因为它只初始化一次并保留其值。在这个例子中，每次你调用`foo()`它都会打印一个递增的数字。静态变量只初始化一次。

    ```
    void foo ()
    {
    static int i = 0;
    printf("%d", i); i++
    } 
    ```

2.  静态的另一个用途是当您在 .c 文件中实现函数或全局变量但不希望其符号`.obj`在文件生成的外部可见时。例如

    ```
    static void foo() { ... } 
    ```

* * *

## 回答 #8

> 赞同：17
> 
> 时间：2009-02-21T06:52:18.013

来自维基百科：

> *在 C 编程语言中，**静态**与全局变量和函数一起使用，以将其范围设置为包含文件。在局部变量中，static 用于将变量存储在静态分配的内存中，而不是自动分配的内存中。虽然语言没有规定这两种内存的实现方式，但静态分配的内存通常在编译时保留在程序的数据段中，而自动分配的内存通常实现为临时调用堆栈。*

* * *

## 回答 #9

> 赞同：10
> 
> 时间：2016-03-30T23:49:49.770

我讨厌回答一个老问题，但我认为没有人在“C 编程语言”的 A4.1 节中提到 K&R 是如何解释它的。

简而言之，静态这个词有**两个**含义：

1.  静态是两个存储类之一（另一个是自动的）。静态对象在调用之间保持其值。在所有块之外声明的对象始终是静态的，不能自动设置。
2.  但是，当`static` **关键字**（特别强调它在代码中用作关键字）与声明一起使用时，它会为该对象提供内部链接，因此它只能在该翻译单元中使用。但是如果在函数中使用关键字，它会更改对象的存储类（无论如何，对象只会在该函数中可见）。static 的反面是`extern`关键字，它给出了一个对象外部链接。

Peter Van Der Linden 在《Expert C Programming》中给出了这两个含义：

*   在函数内部，在调用之间保留其值。
*   在函数级别，仅在此文件中可见。

* * *

## 回答 #10

> 赞同：8
> 
> 时间：2009-02-21T06:52:48.887

如果你在函数中声明了一个静态变量，它的值将不会存储在函数调用堆栈中，当你再次调用该函数时仍然可用。

如果你声明一个全局变量 static，它的范围将被限制在你声明它的文件中。这比可以在整个程序中读取和修改的常规全局稍微安全一些。

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2009-02-21T07:20:49.397

在 C 中，static 有两种含义，具体取决于其使用范围。在全局范围内，当在文件级别声明对象时，意味着该对象仅在该文件中可见。

在任何其他范围内，它声明一个对象，该对象将在进入特定范围的不同时间之间保留其值。例如，如果在一个过程中声明了一个 int：

```
void procedure(void)
{
   static int i = 0;

   i++;
} 
```

'i' 的值在第一次调用该过程时被初始化为零，并且每次调用该过程时都保留该值。如果打印了“i”，它将输出 0、1、2、3、...的序列

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2009-03-11T10:47:51.323

如果您在`mytest.c`文件中声明：

```
static int my_variable; 
```

那么这个变量只能从这个文件中看到。该变量不能导出到其他任何地方。

如果在函数内部声明变量的值将在每次调用函数时保持其值。

不能从文件外部导出静态函数。因此，在`*.c`文件中，如果将函数和变量声明为静态，则它们将被隐藏。

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2014-05-01T06:30:15.393

重要的是要注意函数中的静态变量在第一次进入该函数时被初始化，并且即使在它们的调用完成后仍然存在；**在递归函数的情况下，静态变量只被初始化一次，并且在所有递归调用中持续存在，甚至在函数调用完成之后也是如此。**

如果变量是在函数外部创建的，则意味着程序员只能使用源文件中已声明变量的变量。

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2015-03-21T17:08:54.380

C 中的静态变量具有程序的生命周期。

如果在函数中定义，它们具有本地范围，即只能在这些函数内部访问它们。静态变量的值在函数调用之间保留。

例如：

```
void function()
{
    static int var = 1;
    var++;
    printf("%d", var);
}

int main()
{
    function(); // Call 1
    function(); // Call 2
} 
```

在上面的程序中，`var`是存放在数据段中的。它的生命周期是整个 C 程序。

函数调用 1 后`var`变为 2。函数调用 2 后`var`变为 3。

的值`var`不会在函数调用之间被破坏。

如果`var`在非静态变量和局部变量之间存在，它将被存储在 C 程序的堆栈段中。由于函数的栈帧在函数返回后被销毁，所以 的值`var`也被销毁。

已初始化的静态变量存储在 C 程序的数据段中，而未初始化的静态变量存储在 BSS 段中。

关于静态的另一个信息：如果一个变量是全局和静态的，它具有 C 程序的生命周期，但它具有文件范围。它仅在该文件中可见。

试试这个：

### 文件1.c

```
static int x;

int main()
{
    printf("Accessing in same file%d", x):
} 
```

### 文件2.c

```
 extern int x;
    func()
    {
        printf("accessing in different file %d",x); // Not allowed, x has the file scope of file1.c
    }

run gcc -c file1.c

gcc -c file2.c 
```

现在尝试使用以下方法链接它们：

```
gcc -o output file1.o file2.o 
```

它会给出一个链接器错误，因为 x 具有 file1.c 的文件范围，并且链接器将无法解析对 file2.c 中使用的变量 x 的引用。

参考：

1.  [http://en.wikipedia.org/wiki/Translation_unit_（编程）](http://en.wikipedia.org/wiki/Translation_unit_(programming))
2.  [http://en.wikipedia.org/wiki/Call_stack](http://en.wikipedia.org/wiki/Call_stack)

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2014-12-21T21:59:42.817

静态变量是可以在函数中使用的特殊变量，它在调用之间保存数据，在调用之间不会删除它。例如：

```
void func(void) {
    static int count; // If you don't declare its value, it is initialized with zero
    printf("%d, ", count);
    ++count;
}

int main(void) {
    while(true) {
        func();
    }
    return 0;
} 
```

输出：

> 0, 1, 2, 3, 4, 5, ...

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2014-03-23T05:48:32.670

静态变量值在不同的函数调用之间保持不变，其范围仅限于本地块静态变量始终使用值 0 初始化

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2018-06-03T13:01:49.410

有2种情况：

(1) 声明的局部变量`static`：分配在数据段而不是堆栈中。当您再次调用该函数时，它的值将保留。

(2) 声明的全局变量或函数`static`：在编译单元外不可见（即链接时符号表中的局部符号）。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2020-02-12T12:03:14.363

静态变量具有即使超出其范围后**仍保留其值的属性！因此，静态变量在其先前范围内保留其先前值，并且不会在新范围内再次初始化。**

看看这个例子 - 当程序运行时，一个静态 int 变量保留在内存中。当声明变量的函数调用结束时，普通或自动变量将被销毁。

```
#include<stdio.h> 
int fun() 
{ 
  static int count = 0; 
  count++; 
  return count; 
} 

int main() 
{ 
  printf("%d ", fun()); 
  printf("%d ", fun()); 
  return 0; 
} 
```

这将输出：1 2

因为 1 保留在内存中，因为它被声明为静态

如果未显式初始化，静态变量（如全局变量）将初始化为 0。例如在下面的程序中，x 的值被打印为 0，而 y 的值是垃圾。有关更多详细信息，请参阅此内容。

```
#include <stdio.h> 
int main() 
{ 
    static int x; 
    int y; 
    printf("%d \n %d", x, y); 
} 
```

这将输出：0 [some_garbage_value]

这些是我发现上面没有为新手解释的主要内容！

* * *

## 回答 #19

> 赞同：-3
> 
> 时间：2019-02-13T06:11:13.283

在 C 编程中，`static`是一个保留关键字，它控制生命周期和可见性。如果我们在函数中将变量声明为静态变量，那么它只会在整个函数中可见。在这种用法中，这个静态变量的生命周期将在函数调用时开始，并在该函数执行后销毁。您可以看到以下示例：

```
#include<stdio.h> 
int counterFunction() 
{ 
  static int count = 0; 
  count++; 
  return count; 
} 

int main() 
{ 
  printf("First Counter Output = %d\n", counterFunction()); 
  printf("Second Counter Output = %d ", counterFunction()); 
  return 0; 
} 
```

上面的程序会给我们这个输出：

```
First Counter Output = 1 
Second Counter Output = 1 
```

因为一旦我们调用该函数，它将初始化`count = 0`. 当我们执行它时，`counterFunction`它会破坏 count 变量。

# git - “git add -A”和“git add”之间的区别。

> ID：572549
> 
> 赞同：3259
> 
> 时间：2009-02-21T06:51:06.767
> 
> 标签：git, git-add

该命令`git add [--all|-A]`似乎与 相同`git add .`。它是否正确？如果不是，它们有何不同？

* * *

## 回答 #1

> 赞同：4660
> 
> 时间：2009-02-21T09:00:04.930

*此答案仅适用于**Git 版本 1.x**。对于 Git 版本 2.x，请参阅其他答案。*

* * *

**概括：**

*   `git add -A`阶段**所有更改**

*   `git add .`暂存新文件和修改，**不删除**（在当前目录及其子目录上）。

*   `git add -u`阶段修改和删除，**没有新文件**

* * *

**细节：**

`git add -A`相当于 `git add .; git add -u`。

重要的一点`git add .`是，它查看工作树并将所有这些路径添加到暂存更改中，如果它们已更改或是新的且未被忽略，它不会暂存任何“rm”操作。

`git add -u`查看所有*已*跟踪的文件并暂存对这些文件的更改（如果它们不同或已被删除）。它不会添加任何新文件，它只会暂存对已跟踪文件的更改。

`git add -A`是做这两个的方便快捷方式。

您可以使用类似这样的方法测试差异（请注意，对于 Git 版本 2.x，您的输出`git add .` `git status` **会**有所不同）：

```
git init
echo Change me > change-me
echo Delete me > delete-me
git add change-me delete-me
git commit -m initial

echo OK >> change-me
rm delete-me
echo Add me > add-me

git status
# Changed but not updated:
#   modified:   change-me
#   deleted:    delete-me
# Untracked files:
#   add-me

git add .
git status

# Changes to be committed:
#   new file:   add-me
#   modified:   change-me
# Changed but not updated:
#   deleted:    delete-me

git reset

git add -u
git status

# Changes to be committed:
#   modified:   change-me
#   deleted:    delete-me
# Untracked files:
#   add-me

git reset

git add -A
git status

# Changes to be committed:
#   new file:   add-me
#   modified:   change-me
#   deleted:    delete-me 
```

* * *

## 回答 #2

> 赞同：1202
> 
> 时间：2014-09-25T12:45:05.223

### Git 版本 1.x

| 命令 | 新文件 | 修改文件 | 已删除的文件 | 描述 |
| --- | --- | --- | --- | --- |
| `git add -A` | ✔️ | ✔️ | ✔️ | 暂存所有（新的、修改的、删除的）文件 |
| `git add .` | ✔️ | ✔️ | ❌</td> | 仅在当前文件夹中暂存新文件和修改文件 |
| `git add -u` | ❌</td> | ✔️ | ✔️ | 仅暂存修改和删除的文件 |

### Git 版本 2.x

| 命令 | 新文件 | 修改文件 | 已删除的文件 | 描述 |
| --- | --- | --- | --- | --- |
| `git add -A` | ✔️ | ✔️ | ✔️ | 暂存所有（新的、修改的、删除的）文件 |
| `git add .` | ✔️ | ✔️ | ✔️ | 在当前文件夹中暂存所有（新的、修改的、删除的）文件 |
| `git add --ignore-removal .` | ✔️ | ✔️ | ❌</td> | 仅暂存新文件和修改后的文件 |
| `git add -u` | ❌</td> | ✔️ | ✔️ | 仅暂存修改和删除的文件 |

### 长格式标志：

*   `git add -A`相当于`git add --all`
*   `git add -u`相当于`git add --update`

### 进一步阅读：

*   [Git 初学者：权威实用指南](https://stackoverflow.com/q/315911/12860895)
*   [学习 Git 的资源](https://try.github.io)
*   [学习 Git 分支](https://learngitbranching.js.org)
*   [用 D3 解释 Git](https://onlywei.github.io/explain-git-with-d3)

* * *

## 回答 #3

> 赞同：199
> 
> 时间：2013-04-23T06:32:26.770

在[**Git 2.0 中，`git add -A`默认值是：`git add .`equals`git add -A .`**](https://github.com/git/git/blob/f99a38c0121456822f8a9dfb7928eefceaa98201/Documentation/RelNotes/2.0.0.txt#L32-L36)。

> `git add <path>`现在与“”相同`git add -A <path>`，因此“ `git add dir/`”会注意到您从目录中删除的路径并记录删除。
> 在旧版本的 Git 中，" `git add <path>`" 忽略删除。
> 
> 如果你真的想要，你可以说“ `git add --ignore-removal <path>`”来只添加添加或修改的路径。`<path>`

`git add -A`就像`git add :/`（[添加顶部 git repo 文件夹中的所有内容](https://stackoverflow.com/a/31951899/6309)）。
请注意，git 2.7（2015 年 11 月）将允许您添加一个名为“ `:`”的文件夹！
请参阅[Junio C Hamano ( ) 的](https://github.com/gitster)[提交 29abb33](https://github.com/git/git/commit/29abb33978f713cd0a5cc3687bf61077b0928840)（2015 年 10 月 25 日[）](https://github.com/gitster)。 [`gitster`](https://github.com/gitster)

* * *

请注意，[从 git 2.0 (Q1 or Q2 2014) 开始](https://github.com/git/git/blob/master/Documentation/RelNotes/1.8.3.txt#L19-L30)，在谈论**`git add .`**（工作树中的当前路径）时，您也必须`.`在其他`git add`命令中使用 ' '。

这意味着：

> “ `git add -A .`”等价于“ `git add .; git add -u .`”

（注意额外的 ' `.`'`git add -A`和`git add -u`）

因为`git add -A`or将在**整个工作树上**`git add -u`运行（仅启动 git 2.0），而不仅仅是在当前路径上。

 **> 这些命令将**在 Git 2.0 中对整个树进行操作，以与 " `git commit -a`" 和其他命令**保持一致。因为没有机制让“ `git add -u`”表现得像“ `git add -u .`”，所以对于那些习惯于“ `git add -u`”（没有路径规范）只为当前子目录中的路径更新索引的人来说，重要的是开始训练他们的手指明确地说“ `git add -u .`“当他们在 Git 2.0 到来之前的意思时。
> 
> **当这些命令在没有路径规范的情况下运行并且当您在当前目录之外进行本地更改时会发出警告**，因为在这种情况下 Git 2.0 中的行为将与今天的版本不同。

* * *

## 回答 #4

> 赞同：143
> 
> 时间：2010-06-01T09:27:35.080

根据[查尔斯的指示](https://stackoverflow.com/questions/572549/difference-between-git-add-a-and-git-add/572660#572660)，经过测试，我提出的理解如下：

```
# For the next commit
$ git add .   # Add only files created/modified to the index and not those deleted
$ git add -u  # Add only files deleted/modified to the index and not those created
$ git add -A  # Do both operations at once, add to all files to the index 
```

这篇博文也可能有助于了解在什么情况下可以应用这些命令：*[Removing Deleted Files from your Git Working Directory](http://www.geekgumbo.com/2010/05/16/removing-deleted-files-from-your-git-working-directory/)*。

* * *

## 回答 #5

> 赞同：46
> 
> 时间：2014-10-13T15:29:52.130

Git 2.0 ( [2014-05-28 )](https://en.wikipedia.org/wiki/Git#Releases[27][28])[改变了一切](https://git.kernel.org/cgit/git/git.git/tree/Documentation/RelNotes/2.0.0.txt)：

*   `-A`现在是默认的
*   旧行为现在可用于`--ignore-removal`.
*   `git add -u`并`git add -A`在命令行上没有路径的子目录中对整个树进行操作。

所以对于 Git 2，答案是：

*   `git add .`并`git add -A .`在当前目录中添加新的/修改的/删除的文件
*   `git add --ignore-removal .`在当前目录中添加新的/修改的文件
*   `git add -u .`在当前目录中添加修改/删除的文件
*   如果没有点，则添加项目中的所有文件，而不考虑当前目录。

* * *

## 回答 #6

> 赞同：42
> 
> 时间：2018-03-16T22:32:31.913

在**Git 2.x**中：

*   如果您直接位于*工作目录*，那么`git add -A`和`git add .`工作没有区别。

*   如果您在工作目录的任何子目录中*，*将`git add -A`添加整个*工作目录*中的所有文件，`git add .`并将添加*当前目录*中的文件。

就这样。

* * *

## 回答 #7

> 赞同：38
> 
> 时间：2014-04-06T12:56:26.167

一个更精炼的快速答案：

### 两者都在下面（与*git add --all*相同）

```
git add -A 
```

### 暂存新文件 + 修改文件

```
git add . 
```

### 阶段修改+删除文件

```
git add -u 
```

* * *

## 回答 #8

> 赞同：13
> 
> 时间：2016-06-03T19:12:18.643

`git add .`equals`git add -A .`仅从当前文件夹和子文件夹将文件添加到索引。

`git add -A`将文件添加到工作树中所有文件夹的索引。

PS：信息与[Git 2.0](https://en.wikipedia.org/wiki/Git#Releases[27][28]) (2014-05-28) 有关。

* * *

## 回答 #9

> 赞同：13
> 
> 时间：2019-02-27T21:40:06.210

两者都`git add .`将`git add -A`在较新版本的 Git 中暂存所有新的、修改的和删除的文件。

不同之处在于将`git add -A`文件暂存到属于您的工作 Git 存储库的“更高、当前和子目录”中。但是`git add .`只在当前目录和它之后的子目录中执行文件（*而不是*位于外部的文件，即更高的目录）。

这是一个例子：

```
/my-repo
  .git/
  subfolder/
    nested-file.txt
  rootfile.txt 
```

如果您当前的工作目录是`/my-repo`，并且您这样做了`rm rootfile.txt`，那么`cd subfolder`，后跟`git add .`，那么它将*不会*暂存已删除的文件。但是，`git add -A`无论您从哪里执行命令，都肯定会进行此更改。

* * *

## 回答 #10

> 赞同：12
> 
> 时间：2015-04-06T02:03:33.503

我希望这可以增加一些清晰度。

```
!The syntax is
git add <limiters> <pathspec>
! Aka
git add (nil/-u/-A) (nil/./pathspec) 
```

限制器可以是 -u 或 -A 或 nil。

Pathspec 可以是文件路径或点，'.' 表示当前目录。

关于 Git 如何“添加”的重要背景知识：

*   Git 永远不会自动识别那些以点为前缀的不可见文件（dotfiles）。它们甚至从未被列为“未跟踪”。
*   Git 从不添加空文件夹。它们甚至从未被列为“未跟踪”。（一种解决方法是在跟踪文件中添加一个可能不可见的空白文件。）
*   Git状态不会显示子文件夹信息，即未跟踪的文件，除非该子文件夹中至少有一个文件被跟踪。在此之前，Git 将整个文件夹视为超出范围，即“空”。它没有被跟踪的项目。
*   指定文件规范 = '.' （点）或当前目录不是递归的，除非`-A`还指定。点严格指当前目录 - 它省略了在上面和下面找到的路径。

现在，鉴于这些知识，我们可以应用上面的答案。

限制器如下。

*   `-u`= `--update`= 跟踪文件的子集 => 添加 = 否；改变 = 是；删除 = 是。=>*如果*项目被跟踪。
*   `-A`= `--all`（没有这样`-a`，这会给出语法错误）=所有未跟踪/跟踪文件的超集，除非在 2.0 之前的 Git 中，其中如果给出了点文件规范，则只考虑该特定文件夹。=>*如果*该项目被识别，`git add -A`将找到它并添加它。

路径规范如下。

*   在 Git 2.0 之前的版本中，对于两个限制器（update 和 all），新的默认是对整个工作树进行操作，而不是当前路径（Git 1.9 或更早版本），
*   但是在 v2.0 中，可以将操作限制在当前路径：只需添加显式点后缀即可（这在 Git 1.9 或更早版本中也有效）；

`git add -A .`

`git add -u .`

总之，我的政策是：

1.  确保要添加的任何块/文件都在`git status`.
2.  如果由于不可见的文件/文件夹而缺少任何项目，请单独添加它们。
3.  拥有一个好的`.gitignore`文件，以便通常只有感兴趣的文件未被跟踪和/或无法识别。
4.  从存储库的顶层，“git add -A”添加所有项目。这适用于所有版本的 Git。
5.  如果需要，从索引中删除任何所需的项目。
6.  如果有大错误，请执行“git reset”以完全清除索引。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2018-11-07T21:05:44.840

该`-A`选项添加、修改和删除索引条目以匹配工作树。

在 Git 2 中，该`-A`选项现在是默认选项。

[根据Git 文档](https://git-scm.com/docs/git-add#git-add--A)，当`.`添加限制更新范围到您当前所在的目录时

> 如果使用 -A 选项时给出 no `<pathspec>`，则更新整个工作树中的所有文件（旧版本的 Git 用于限制对当前目录及其子目录的更新）。

我要补充的一件事是，如果使用`--interactive`or`-p`模式，那么`git add`将表现得好像使用了 update ( `-u`) 标志而不添加新文件。

# java - 鼠标监听器问题

> ID：572572
> 
> 赞同：1
> 
> 时间：2009-02-21T07:09:45.070
> 
> 标签：java

我正在用 Java 开发屏幕捕获实用程序，当我单击该特定窗口时，我想捕获任何背景窗口。但我不知道如何将`mouseClicked`事件添加到背景窗口。有人能帮帮我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-21T07:21:58.333

我可能离基地很远，但如果另一个窗口不是 Java 窗口，那么它应该在 Java 沙箱之外。与之交互需要一个原生 API，这对 Java 来说是一种厌恶。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-21T09:16:41.350

很明显，您不能与其他应用程序窗口进行交互。我想它可以是你的任何随机窗口。因此，您的 mouselistener 方法不正确。

相反，尝试像获取屏幕上显示的像素信息一样接近它。有一个 awt 包 java.awt.Robot 或可以用于您的目的的东西。如果要实现活动窗口的捕获，请查看是否有 java API 与操作系统交互并获取当前活动窗口的信息及其像素坐标。然后可以将坐标提供给与 java.awt.Robot API 一起使用的矩形属性，以定义屏幕捕获区域。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-21T07:22:33.493

如果那个窗口不是你的应用程序的一部分，你就不能用它做很多事情。

否则，您只需将鼠标侦听器也添加到该窗口。

你的情况如何？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-21T13:02:15.567

java.awt.Robot 有一个方法 createScreenCapture(Rectangle screenRect) 来捕获屏幕截图。 [http://java.sun.com/j2se/1.5.0/docs/api/java/awt/Robot.html](http://java.sun.com/j2se/1.5.0/docs/api/java/awt/Robot.html)

但是，要获得当前活动窗口，您必须使用特定于操作系统的扩展（主要通过 JNI）

# project-management - 需要一种管理项目任务列表和信息的好方法

> ID：572574
> 
> 赞同：2
> 
> 时间：2009-02-21T07:13:53.717
> 
> 标签：project-management, information-management

我的旧系统涉及使用 Microsoft FrontPage 和框架页面。顶部框架包含我需要做的任务和子任务的（树）列表，而底部框架包含任何有用的项目信息、注释等。我总是需要记下来。我在页面中使用书签来标记主要任务，同时用粗体突出当前任务并用斜体标记完成的任务。我会使用第三个框架在书签之间导航。链接到它们的超链接的目录。这很笨拙，但效果很好。

显然，我现在想升级。关于如何建立一个可以做类似于我的旧系统的新系统的任何好主意（没有粗糙/笨拙）？也就是说，为此目的的正式软件？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-21T07:35:49.453

[ToDoList](http://www.abstractspoon.com/tdl_resources.html)很不错。缺点：仅限 Windows。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-21T07:48:32.433

我们使用[FogBugz](http://www.fogcreek.com/FogBugz/)，它对我们来说非常出色。远胜于JIRA，易于使用、友好、强大。强烈推荐它。

*   它有一个用于注释的内置 wiki。（真的很容易使用！）

*   它有一个首屈一指的错误跟踪系统。

*   您甚至可以让您的软件将其错误报告提交给 FogBugz，它会自动生成一个包含相关信息的案例。此功能称为 Scout。

*   您可以创建版本和所有文件案例、功能、错误，无论是版本、优先级等。功能就在那里。

*   最重要的是，您可以将其托管在您自己的服务器上，或者让他们为您托管。漂亮的系统。

*   适用于几乎任何操作系统和浏览器。

*   与大多数 Web 应用程序不同，它非常灵活！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-21T07:38:17.623

我们将[Jira](http://www.atlassian.com/software/jira/)用于任务列表、版本规划和时间管理。以及用于内部文档和相关内容的[Google 网站。](http://sites.google.com/)一般来说，大多数 Wiki 系统都适合文档和待办事项（例如[Confluence](http://www.atlassian.com/software/confluence/default2.jsp)）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-21T07:36:16.177

**[TFS](http://msdn.microsoft.com/en-us/teamsystem/default.aspx "TFS") : 团队基础系统**

完整的源代码控制和工作项跟踪都与 Visual Studio 集成。

如果您使用 Visual Studio，并在 Windows 环境中工作，我建议您这样做。如果您不使用 Visual Studio，我建议您使用 ;)

您还可以设置显示活动、报告和所有爵士乐的项目门户等。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-21T08:28:03.570

[37signals 的Basecamp](http://www.basecamphq.com)是跟踪您的任务和项目的绝佳工具。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-21T07:49:44.070

我用[fogbugz](http://www.fogcreek.com/FogBugz/) s&s版

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-21T07:52:31.723

我认为*问题跟踪系统*可能适合您的需求，从开源到商业有[很多替代方案......](http://en.wikipedia.org/wiki/Comparison_of_issue_tracking_systems)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-21T08:04:51.897

您可以设置和使用[ASP.NET Time Tracker Starter Kit](http://www.asp.net/downloads/starter-kits/time-tracker/)。它还允许您扩展它。

# c# - 检查 microsoft 组件是否存在

> ID：572581
> 
> 赞同：4
> 
> 时间：2009-02-21T07:22:03.403
> 
> 标签：c#

我想检查是否安装了某些微软组件，如 wmencoder、directx 或 wmplayer。如果安装了，我也可以得到它的版本号吗？

我怎样才能做到这一点？

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-22T04:56:11.607

我使用以下内容来确定是否安装了其他应用程序，但是您需要知道在注册表中安装该应用程序的“唯一”产品代码（来自 Visual Studio 中的安装项目）。

包括

```
using System.Diagnostics;
using Microsoft.Win32; 
```

用法：

```
// HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{0006F03A-0000-0000-C000-000000000046} << This is outlook 2003
String retval = "";

// Look to see if Outlook 2003 is installed and if it is...
if ((checkComServerExists("{0006F03A-0000-0000-C000-000000000046}", out retval)))
{
    // Update boolean flag if we get this far so we don't have to check again
    Console.WriteLine("Office CSLID exists - Version: " + retval);
} 
```

功能：

```
// Checks to see if the given CLSID is registerd and exists on the system
private static Boolean checkComServerExists(String CLSID, out String retval)
{
    RegistryKey myRegKey = Registry.LocalMachine;
    Object val;

    try
    {
        // get the pathname to the COM server DLL/EXE if the key exists
        myRegKey = myRegKey.OpenSubKey("SOFTWARE\\Classes\\CLSID\\" + CLSID + "\\LocalServer32");
        val = myRegKey.GetValue(null); // the null gets default
    }
    catch
    {
        retval = "CLSID not registered";
        return false;
    }

    FileVersionInfo myFileVersionInfo = null;
    try
    {
        // parse out the version number embedded in the resource
        // in the DLL
        myFileVersionInfo = FileVersionInfo.GetVersionInfo(val.ToString());
    }
    catch
    {
        retval = String.Format("DLL {0} not found", val.ToString());
        return false;
    }

    retval = myFileVersionInfo.FileVersion;
    return true;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-22T04:36:25.413

我使用 RegShot 来确定可用于检查是否安装了软件的注册表设置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-21T08:47:30.747

我的第一个想法是 WMI。Win32_SoftwareElement 类（在[MSDN](http://msdn.microsoft.com/en-us/library/aa394453(VS.85).aspx)上）

但可能需要一些工作才能获得正确的类和查询。从 WMI CIM Studio 的 WMI 工具开始。

使用 PowerShell，类似于：

```
gwmi win32_softwareelement -filter "name like '%play%'" | ft 
```

将允许找到正确的 ID。（警告：这*非常*慢。）

MS Installer (MSI) API 可能有更快的速度。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-28T05:21:27.477

[这里还有一个小代码片段](http://pastebin.com/PvzCFsaT)，它使用[`Type.GetTypeFromProgID`](http://msdn.microsoft.com/en-us/library/system.type.gettypefromprogid.aspx)注册表访问等。

# javascript - 从数据中呈现图形或图表的最佳 Javascript/Flash 框架是什么？

> ID：572593
> 
> 赞同：9
> 
> 时间：2009-02-21T07:38:45.843
> 
> 标签：javascript, flash, statistics, charts, visualization

理想情况下，我希望在服务器上做尽可能少的准备数据工作。我从数据库中准备数据以制作给定图表所需的工作越少，我就越开心，并且我可以在这段时间内获得更多的视图。

我想绘制一些图表，例如：

*   一系列响应时间的分布
*   每个类别的出现次数（基本条形图）

我敢肯定还有其他我还没有想到的。

任何可以帮助我从系列中获得的东西，例如：

[1, 2, 2, 2, 3, 4, 5, 5, 3, 1] 或更可能类似于 [1.2, 3.2, 3.1, 1.1, 4.3, 3.4] 这不仅仅是计算项目的频率

到实际分布会很棒。

谢谢。

**编辑：**为了澄清，我想我要求的不仅仅是图表 API，在 Yahoo 或 Stack Overflow 上的搜索已经找到了答案。我正在寻找可以帮助我以最少的努力将数据转化为可视化的东西。因此，对于上面的系列，可以将其直接映射到一些标准分布，例如高斯分布。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-21T14:46:30.137

我喜欢[谷歌图表 API](http://code.google.com/apis/chart/)。它使用起来非常简单。您在图像的 URL 中生成数据，Google 服务器会返回包含图表的 GIF。您不需要 JavaScript 或 Flash。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-21T08:42:37.547

我使用[JS Charts](http://www.jscharts.com/)，这是一个基于 Javascript 的图表，看起来简单易用。除了 js，他们甚至还支持 xml 数据。它是免费的，他们有一些[例子](http://www.jscharts.com/examples)。

在 IE 和 Chrome 上运行良好，因此理想情况下应该在 Firefox 上运行。也是。

在 Flash 方面，有[Open Flash Chart](http://teethgrinder.co.uk/open-flash-chart/)，他们有一些主要语言的帮助类。

**编辑：**根据有问题的其他信息，我猜 Google Visualization API ( [http://code.google.com/apis/visualization/](http://code.google.com/apis/visualization/) ) 可能适合您。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-28T20:12:02.150

[jQuery 迷你图](http://omnipotent.net/jquery.sparkline/)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-21T08:22:37.873

我使用 flot ( [http://code.google.com/p/flot/](http://code.google.com/p/flot/) ) 取得了一些不错的效果。它是纯 JavaScript，不需要 Flash。它使用 html 画布从 javascripts 中绘制图表。使用插件在 msie 上工作。一些例子： http: [//people.iola.dk/olau/flot/examples/](http://people.iola.dk/olau/flot/examples/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-21T14:16:41.300

看看[amCharts](http://www.amcharts.com)。这是一个基于 Flash 的库。您可以以 XML 或 CSV 格式将数据传递给它（或者如果您使用 ASP.NET，则有一个支持数据绑定的控件包装器）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-01T12:05:16.760

试试 Google 可视化 API。

[http://code.google.com/apis/visualization/](http://code.google.com/apis/visualization/)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-01-14T09:25:42.833

在[http://www.drasticdata.nl](http://www.drasticdata.nl)上有一些有趣的基于 flash 的图形和树形图实用程序。您的任务可能对分层条形图或动态树形图感兴趣。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-21T14:06:03.010

我以前使用过 flotr( [http://code.google.com/p/flotr/](http://code.google.com/p/flotr/) )，它深受上述 flot 的启发，但它使用原型而不是 jquery。它的工作方式与 flot 相同，因为它是纯 javascript。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-25T10:07:22.600

我还没有广泛使用它，但经过一些初步的摆弄之后，我对[Open Flash Chart](http://teethgrinder.co.uk/open-flash-chart/)印象深刻（我刚刚注意到上面 Dinesh 已经提到过）

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-28T18:40:25.647

我使用[Fusion Charts](http://www.fusioncharts.com/)完成的报告似乎总是给人留下深刻印象。相当容易使用和许多图表选项。Flash 是一项技术，因此对于 web 显示没有真正的平台问题。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-04-28T02:55:05.647

JS Charts 不支持面积图

# python - 使用转义 solr 保留关键字进行 Solr 搜索

> ID：572599
> 
> 赞同：4
> 
> 时间：2009-02-21T07:46:45.043
> 
> 标签：python, solr, pysolr

如何在 solr 中将包含 solr 保留关键字的字段查询为“：”？

例如，

```
q = 'uri:http://www.example.com' 
```

为包含保留字“:”的“ [http://www.example.com](http://www.example.com) ”引发错误

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-21T14:10:54.807

我刚刚对此进行了测试，似乎只是像“：”一样转义“：”就可以了：

```
q = 'uri:http\://www.example.com' 
```

对于我自己网站的索引，我倾向于简单地存储 URL 的路径，因为我自己知道域，所以这对我来说以前不是问题。但是，如果您将外部 URL 编入索引，那么您当然需要完整的 URL。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-21T10:07:15.440

在索引期间转义/替换 Lucene 保留字符并将原始值存储在单独的字段中（`stored="true" indexed="false"`在模式中）。如果您用空格替换保留字符，您将进入`http www.example.com`索引字段并`http://www.example.com`存储。根据索引字段的类型，您可以查询精确值（如果它是纯字符串）或标记（如果它有分析器）。

# javascript - 如何扩展 Array.prototype.push()？

> ID：572604
> 
> 赞同：33
> 
> 时间：2009-02-21T07:52:06.153
> 
> 标签：javascript, arrays, prototype, array-push

我正在尝试扩展该`Array.push`方法，以便使用 push 将触发回调方法，然后执行正常的数组函数。

我不太确定如何做到这一点，但这里有一些我一直没有成功的代码。

```
arr = [];
arr.push = function(data){

    //callback method goes here

    this = Array.push(data);
    return this.length;
}

arr.push('test'); 
```

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2009-02-21T08:24:50.117

由于*push*允许推送多个元素，因此我使用下面的*arguments*变量让真正的 push 方法具有所有参数。

此解决方案仅影响*arr*变量：

```
arr.push = function () {
    //Do what you want here...
    return Array.prototype.push.apply(this, arguments);
} 
```

此解决方案影响所有阵列。我不建议你这样做。

```
Array.prototype.push = (function() {
    var original = Array.prototype.push;
    return function() {
        //Do what you want here.
        return original.apply(this, arguments);
    };
})(); 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2016-10-10T19:20:40.110

首先你需要子类`Array`：

ES6（[https://kangax.github.io/compat-table/es6/](https://kangax.github.io/compat-table/es6/)）：

```
class SortedArray extends Array {
    constructor(...args) {
        super(...args);
    }
    push() {
        return super.push(arguments);
    }
} 
```

ES5（**proto**几乎被弃用，但它是目前唯一的解决方案）：

```
function SortedArray() {
    var arr = [];
    arr.push.apply(arr, arguments);
    arr.__proto__ = SortedArray.prototype;
    return arr;
}
SortedArray.prototype = Object.create(Array.prototype);

SortedArray.prototype.push = function() {
    this.arr.push(arguments);
}; 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-02-21T08:20:18.193

你可以这样做：

```
arr = []
arr.push = function(data) {
  alert(data); //callback

  return Array.prototype.push.call(this, data);
} 
```

如果您处于没有电话的情况，您也可以选择以下解决方案：

```
arr.push = function(data) {
  alert(data); //callback

  //While unlikely, someone may be using "psh" to store something important
  //So we save it.
  var saved = this.psh;
  this.psh = Array.prototype.push;
  var ret = this.psh(data);
  this.psh = saved;
  return ret;
} 
```

虽然我在告诉您如何操作，但您最好使用执行回调的不同方法，然后只在数组上调用*push*而不是覆盖*push*。您最终可能会遇到一些意想不到的副作用。例如，*push*似乎是可变的（采用可变数量的参数，如*printf*），使用上述内容会破坏它。

您需要弄乱 _Arguments() 和 _ArgumentsLength() 才能正确覆盖此函数。我强烈反对这条路线。

或者您可以使用“参数”，这也可以。我仍然建议不要走这条路。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-04-02T23:22:50.290

Array.prototype.push 是在 JavaScript 1.2 中引入的。这真的很简单：

```
Array.prototype.push = function() {
    for( var i = 0, l = arguments.length; i < l; i++ ) this[this.length] = arguments[i];
    return this.length;
}; 
```

你总是可以在前面添加一些东西。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-05-29T08:34:47.273

还有另一种更原生的方法来实现这一点：[`Proxy`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Proxy/Proxy/set)

```
const target = [];

const handler = {
  set: function(array, index, value) {
    // Call callback function here

    // The default behavior to store the value
    array[index] = value;

    // Indicate success
    return true;
  }
};

const proxyArray = new Proxy(target, handler); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-02-21T15:38:12.090

我想在对象被推送到数组**后调用一个函数，所以我做了以下事情：**

```
myArray.push = function() { 
    Array.prototype.push.apply(this, arguments);
    myFunction();
    return myArray.length;
};

function myFunction() {
    for (var i = 0; i < myArray.length; i++) {
        //doSomething;
    }
} 
```

# iphone - 在 iPhone 上获取当前系统音量

> ID：572606
> 
> 赞同：9
> 
> 时间：2009-02-21T07:53:04.933
> 
> 标签：iphone, audio, volume

有没有办法在 iPhone 上获取当前的系统音量级别？

我在想也许有一种方法可以制造`MPVolumeView`并从中获得价值。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2011-10-24T17:37:11.597

```
musicPlayer = [[MPMusicPlayerController iPodMusicPlayer];

currentVolume = musicPlayer.volume; 
```

从 iOS8.0 开始，现在已弃用，因此请尝试以下操作

```
#import <AVFoundation/AVAudioSession.h>

AVAudioSession *audioSession = [AVAudioSession sharedInstance];
CGFloat volume = audioSession.outputVolume; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-23T21:06:56.243

Celestial.framework 有一个`AVSystemController`类可以让您获取和设置当前音量。不幸的是，这是一个私人课程，因此 Apple 不会在 App Store 提交中接受它

如果有帮助，您可以稍微滥用一下公共`MPVolumeView`课程：http: [//www.stormyprods.com/blogger/2008/09/proper-usage-of-mpvolumeview-class.html](http://www.stormyprods.com/blogger/2008/09/proper-usage-of-mpvolumeview-class.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-30T09:51:05.397

将 MediaPlayer 框架添加到您的项目中

![在此处输入图像描述](https://i.stack.imgur.com/ZjlNR.png)

.h（头文件）

```
{

  MPMusicPlayerController *musicPlayer; 

} 
```

.m（实现文件）

```
- (void)viewDidLoad

{

//get device volume level

   musicPlayer = [MPMusicPlayerController iPodMusicPlayer];

   float deviceVolumeLevel = musicPlayer.volume;

   NSLog(@"Current device volume level : %f",deviceVolumeLevel);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-02-24T17:31:51.887

迅捷3.0

..

```
import AVKit
..
    // get current level:
    let  audioSession = AVAudioSession.sharedInstance()
    let volume : Float = audioSession.outputVolume 
```

# php - Internet Explorer 及其缺点（没有类似 Firebug 的调试工具）

> ID：572608
> 
> 赞同：9
> 
> 时间：2009-02-21T07:59:23.813
> 
> 标签：php, jquery, internet-explorer, google-chrome

我正在使用 PHP/jQuery 和 JavaScript。我正在使用[Firebug](http://en.wikipedia.org/wiki/Firebug_%28software%29)在 Firefox 中测试 JavaScript 代码。Internet Explorer 有类似的东西吗？

我正在努力让它在 Internet Explorer 7 和[Internet Explorer 8](http://en.wikipedia.org/wiki/Internet_Explorer_8)中看起来/工作相同。

有什么工具可以解决这个问题吗？或者我需要遵循的标准？另外，可以推荐什么调试器？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-21T08:11:40.163

看一下这个：

[Internet Explorer 开发人员工具栏](http://www.microsoft.com/en-us/download/details.aspx?id=18359)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-21T08:11:33.597

您可以强制 IE8 使用与 IE7 相同的渲染引擎。

[来自微软的 Chris Koenig 在一篇博](http://blogs.msdn.com/chkoenig/archive/2008/08/28/ie8-standards-mode-and-ie7-compatibility-mode.aspx)文中解释了它

在 IE 的调试器方面，我推荐[Visual Studio Express](http://www.microsoft.com/Express/)。它是迄今为止最好的 IE 调试器。虽然它不像 Firebug 那样紧密集成，但对于原始 JS 调试功能来说，它才是王道。您可以设置断点，单步执行代码，并执行您希望从调试器中执行的所有正常操作。它没有 Firebug 的 HTML 检查，但 IE 开发人员工具栏可以帮助您。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-21T08:31:30.880

@Paolo Bergantino 已经提到了**Internet Explorer Developer Toolbar 。**它和 Firebug 一样有用。但另一个解决方案可能是适用于 Internet Explorer、[Opera](http://en.wikipedia.org/wiki/Opera_%28web_browser%29)和[Safari的](http://en.wikipedia.org/wiki/Safari_%28web_browser%29)[**Firebug Lite**](http://getfirebug.com/lite.html)。

*[Firebug console for IE](http://www.phpied.com/firebug-console-for-ie/)*中描述了一种通过[书签](http://en.wikipedia.org/wiki/Bookmarklet)实现它的非常有创意的方法。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-21T09:43:24.547

Internet Explorer 8 有一个与 Firebug 非常相似的调试工具包。只需按 F12 即可将其调出。由于您可以强制 IE8 使用 IE7 渲染引擎，因此您可以使用它来调试它们。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-30T15:51:29.400

对于 Firebug 网络面板的等效项，您可以使用 MySpace 新发布的[MSFast](http://msfast.myspace.com/)。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-08-28T08:32:55.730

我多年来一直使用的一个很好的替代方法是[DebugBar](http://www.my-debugbar.com)。

这是：

*   比 MySpace 的[MSFast更稳定](http://msfast.myspace.com/)
*   在大多数事情上都比微软的[Internet Explorer 开发者工具栏更好](http://en.wikipedia.org/wiki/Internet_Explorer_Developer_Tools)
*   [比Firebug Lite](http://getfirebug.com/firebuglite)有用得多（实际上只是一个花哨的控制台）
*   比[Ext JS 的脚本快得多，并且在](http://en.wikipedia.org/wiki/Ext_JS)[jQuery](http://en.wikipedia.org/wiki/JQuery)测试中不会崩溃

有许多有用的小书签和[Greasemonkey](http://en.wikipedia.org/wiki/Greasemonkey)类型的脚本，主要是 [XRay](http://www.westciv.com/xray/)。

不幸的是，这些都没有接近萤火虫，但话又说回来，他们正试图驯服一只更加凶恶的野兽。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-21T08:42:38.513

我没有使用它，但 Firebug 开发人员已经创建了[Firebug Lite](http://getfirebug.com/lite.html)以在其他浏览器中使用。这是一个纯 JavaScript 解决方案，因此它不依赖于本地安装的任何内容。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-23T02:58:41.897

对于 Internet Explorer 版本，抛出“调试器”命令

```
function MakeInternet(obj)
{
    debugger

    internet = obj;
} 
```

在你的 JavaScript 代码中，它会让你选择你想如何调试它。

# project-management - 对于敏捷方法，您推荐什么项目管理软件？

> ID：572611
> 
> 赞同：2
> 
> 时间：2009-02-21T08:06:04.607
> 
> 标签：project-management, agile

在我工作的地方，我们正在转向更敏捷的项目管理方法。

对于项目管理的工具支持，我过去使用了 MS Project 和 Target Process。但我认为他们都有严重的弱点：

*   MS Project 不是很直观，因此很难使用，尤其是对于新手用户。它并不真正适合敏捷方法
*   目标进程似乎只完成了一半。例如，用户可以将自己的权限设置为管理员。用户故事的大小以小时为单位，而不是无单位的大小，我认为这确实是个坏主意。UI 感觉臃肿且过于复杂，并不真正支持仅通过键盘使用。

我们还使用 Jira 进行问题跟踪，我想可以对其进行修改并添加一些自定义字段/报告，使其成为一种敏捷的项目管理工具。

所以我的问题是：您使用哪些软件工具进行敏捷项目管理，您喜欢或不喜欢它的什么？

补充：我知道像白板或便利贴这样的物理工具在某种意义上是完美的工具**，但**如果你想了解整个公司的情况，从一个办公室跑到另一个办公室有点麻烦查看白板或强迫人们将其复制到不同类型的文档中。如果您在客户不在现场的环境中工作，则适用类似的论点。

我将尝试列出一些我认为有趣的功能：

*   管理层、客户、团队可能从不同的站点轻松访问。这几乎需要一个网络应用程序。
*   选择配置应用程序以适应团队或公司喜欢的敏捷风格
*   它应该允许多人并行访问它。例如，开发人员将任务/故事标记为已完成，不应阻止客户添加新任务。这几乎排除了 Excel。
*   仅用于键盘的良好可用性，至少对于更新大量故事或添加大量故事之类的事情
*   能够与 Jira 集成（那里的条目应该成为系统中的任务或其他东西，更改应该同步，或者如果它们不同步，至少是不可能的）和 SVN（带有故事 ID 的提交评论应该出现在工具中）
*   能够使用 Java API 与其他系统集成。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-21T09:03:24.673

大多数情况下，我们使用白板和便利贴。如果我们必须使用软件，我们通常使用 Trac 或简单的 wiki。

根据我们的经验，使用项目管理工具实际上会使您的项目变得不那么敏捷。该工具往往成为整个开发过程的焦点，其数据比实际软件更重要。

我真的可以推荐使用物理工具而不是软件工具。它让每个人都专注于同一个位置，并且比最简单的软件等价物更加公开和易于访问。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-24T03:56:27.863

当来到团队会议室不切实际时，使用工具提供对敏捷项目的可见性是有价值的。我不建议使用团队房间中的大可见图表以外的工具来代替大可见图表。当一个人不得不使用工具来提取信息而不是看到信息在团队房间中持续可见时，它就会失去其有效性。

我们使用的工具中我的评论如下

*   Mingle - 可编程和最可定制、最大的学习曲线，但您不会被困在角落里，开发人员可以快速掌握学习曲线
*   拉力赛 - 开箱即用，满足您的需求。实施敏捷实践并且学习曲线很小。报告很好。
*   版本一 - 敏捷工具的瑞士军刀。简单，功能齐全，用于提取项目数据的出色查询工具，需要确保托管服务提供您需要的性能
*   XPlanner - 免费，基本但不发展，易于团队使用，报告部门能力较弱
*   Excel - 效果很好，大多数人都从它开始，文件可以发布到任何人都可以下载和查看的 WIKI

考虑许可。许多工具可以在 HTLM 中发布结果，这些结果可以从 WIKI 作为仪表板报告读取。如果您需要控制对数据的访问，那么提供工具许可证或提供 WIKI 登录名应该可以满足您的需求。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-21T08:49:50.150

Redmine，它易于使用并且包含足够的功能。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-21T09:24:06.370

您当前的项目管理软件面临哪些想要解决的具体问题。您正在转向哪种特定的敏捷风格？第一个子弹有点不稳定......因为新手用户不应该真正进行项目管理。其他参数读作“MS Project 不应表现得像 MS Project”

如果您想要一个简化的产品积压工具，这似乎是您正在寻找的......使用电子表格，看看它是否有效。如果没有，请转到复杂的。

SO中有一个类似的线程......欺骗还是这个线程显着偏离？ [https://stackoverflow.com/questions/426458/recommendations-for-project-management-software-for-scrum](https://stackoverflow.com/questions/426458/recommendations-for-project-management-software-for-scrum)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-01T19:57:47.730

我实际上将 Atlassian 的[JIRA](http://www.atlassian.com/software/jira/ "JIRA")用于我所有的敏捷项目管理。随着他们最近对[GreenHopper](http://www.atlassian.com/greenhopper/ "SCRUM")的收购，他们也将 SCRUM 完全集成到了项目管理中。不过，这目前仅在 Beta 版中可用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-04T07:34:51.110

我的团队正在使用 Rally。几年前我也使用过 VersionOne，但我认为 Rally 更好。我不是所有功能的专家，但我认为它可以完成您需要的大部分事情。甚至不要尝试 MS 项目...

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-01T19:53:42.293

Axosoft 的准时

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-07-13T14:13:44.257

CounterSoft Gemini（至少免费获得他们的 5 个用户许可证）

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-12-04T00:26:09.817

有一个新工具 - Bright Green Projects。它允许您捕获需求并确定其优先级、构建估算、管理迭代、跟踪问题……等等。界面美观且非常易于使用：[http ://www.brightgreenprojects.com](http://www.brightgreenprojects.com)

# objective-c - 用于将大小转换为人类可读字符串的 ObjC/Cocoa 类？

> ID：572614
> 
> 赞同：28
> 
> 时间：2009-02-21T08:11:29.960
> 
> 标签：objective-c, cocoa

有没有一种简单的方法来做类似..

```
[NSMagicDataConverter humanStringWithBytes:20000000] 
```

..哪个会返回“19.1MB”？

* * *

## 回答 #1

> 赞同：104
> 
> 时间：2012-10-01T13:53:39.070

从 OS X 10.8 和 iOS 6 开始，您可以使用**[NSByteCountFormatter](https://developer.apple.com/documentation/foundation/nsbytecountformatter)**。

您的示例如下所示：

```
[NSByteCountFormatter stringFromByteCount:20000000 countStyle:NSByteCountFormatterCountStyleFile]; 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2011-01-17T18:31:41.913

我会把它混入一个 NSFormatter 子类中。

```
#import <Foundation/Foundation.h>

@interface SOFileSizeFormatter : NSNumberFormatter 
{
    @private
    BOOL useBaseTenUnits;
}

/** Flag signaling whether to calculate file size in binary units (1024) or base ten units (1000).  Default is binary units. */
@property (nonatomic, readwrite, assign, getter=isUsingBaseTenUnits) BOOL useBaseTenUnits;

@end

static const char sUnits[] = { '\0', 'K', 'M', 'G', 'T', 'P', 'E', 'Z', 'Y' };
static int sMaxUnits = sizeof sUnits - 1;

@implementation SOFileSizeFormatter

@synthesize useBaseTenUnits;

- (NSString *) stringFromNumber:(NSNumber *)number
{
    int multiplier = useBaseTenUnits ? 1000 : 1024;
    int exponent = 0;

    double bytes = [number doubleValue];

    while ((bytes >= multiplier) && (exponent < sMaxUnits)) {
        bytes /= multiplier;
        exponent++;
    }

    return [NSString stringWithFormat:@"%@ %cB", [super stringFromNumber: [NSNumber numberWithDouble: bytes]], sUnits[exponent]];
}

@end 
```

用法：

```
NSString *path = ...; // path to a file of 1,500,000 bytes
NSString *sizeString = nil;

NSNumber *sizeAttrib = [[[NSFileManager defaultManager] attributesOfItemAtPath:path error:NULL]objectForKey:NSFileSize];

SOFileSizeFormatter *sizeFormatter = [[[SOFileSizeFormatter alloc] init] autorelease];
[sizeFormatter setMaximumFractionDigits:2];

sizeString = [sizeFormatter stringFromNumber:sizeAttrib];
// sizeString ==> @"1.43 MB"

[sizeFormatter setUseBaseTenUnits:YES];
sizeString = [sizeFormatter stringFromNumber:sizeAttrib];
// sizeString ==> @"1.5 MB" 
```

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2010-06-04T15:40:32.527

这是我自己对这个问题的看法：

```
enum {
    kUnitStringBinaryUnits     = 1 << 0,
    kUnitStringOSNativeUnits   = 1 << 1,
    kUnitStringLocalizedFormat = 1 << 2
};

NSString* unitStringFromBytes(double bytes, uint8_t flags){

    static const char units[] = { '\0', 'k', 'M', 'G', 'T', 'P', 'E', 'Z', 'Y' };
    static int maxUnits = sizeof units - 1;

    int multiplier = (flags & kUnitStringOSNativeUnits && !leopardOrGreater() || flags & kUnitStringBinaryUnits) ? 1024 : 1000;
    int exponent = 0;

    while (bytes >= multiplier && exponent < maxUnits) {
        bytes /= multiplier;
        exponent++;
    }
    NSNumberFormatter* formatter = [[[NSNumberFormatter alloc] init] autorelease];
    [formatter setMaximumFractionDigits:2];
    if (flags & kUnitStringLocalizedFormat) {
        [formatter setNumberStyle: NSNumberFormatterDecimalStyle];
    }
    // Beware of reusing this format string. -[NSString stringWithFormat] ignores \0, *printf does not.
    return [NSString stringWithFormat:@"%@ %cB", [formatter stringFromNumber: [NSNumber numberWithDouble: bytes]], units[exponent]];
} 
```

默认情况下（如果`0`为 传递`flags`），它将输出 SI 单位（以十为底）。您可以设置`kUnitStringBinaryUnits`选择适合内存的二进制（以二为底）单位，或`kUnitStringOSNativeUnits`根据操作系统版本自动选择单位类型（Leopard 之前的以二为底，Leopard 之后的以十为底）。设置`kUnitStringLocalizedFormat`基于用户的当前语言环境格式化字符串。例如：

```
unitStringFromBytes(1073741824, 0); // → "1.07 GB"
unitStringFromBytes(1073741824, kUnitStringBinaryUnits); // → "1 GB"
unitStringFromBytes(1073741824, kUnitStringOSNativeUnits | kUnitStringLocalizedFormat); // → "1.07 GB" (In Mac OS 10.6)
unitStringFromBytes(12345678901234567890123456789, kUnitStringOSNativeUnits | kUnitStringLocalizedFormat); // → "12,345.68 YB" (In Mac OS 10.6, in the US)
unitStringFromBytes(12345678901234567890123456789, kUnitStringOSNativeUnits | kUnitStringLocalizedFormat); // → "12.345,68 YB" (In Mac OS 10.6, in Spain) 
```

* * *

这是操作系统原生单元所需的辅助函数：

```
BOOL leopardOrGreater(){
    static BOOL alreadyComputedOS = NO;
    static BOOL leopardOrGreater = NO;
    if (!alreadyComputedOS) {
        SInt32 majorVersion, minorVersion;
        Gestalt(gestaltSystemVersionMajor, &majorVersion);
        Gestalt(gestaltSystemVersionMinor, &minorVersion);
        leopardOrGreater = ((majorVersion == 10 && minorVersion >= 5) || majorVersion > 10);
        alreadyComputedOS = YES;
    }
    return leopardOrGreater;
} 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-02-21T08:18:52.563

```
NSString *stringFromFileSize(NSInteger theSize)
{
    /*
     From http://snippets.dzone.com/posts/show/3038 with slight modification
     */
    float floatSize = theSize;
    if (theSize<1023)
        return([NSString stringWithFormat:@"%i bytes",theSize]);
    floatSize = floatSize / 1024;
    if (floatSize<1023)
        return([NSString stringWithFormat:@"%1.1f KB",floatSize]);
    floatSize = floatSize / 1024;
    if (floatSize<1023)
        return([NSString stringWithFormat:@"%1.1f MB",floatSize]);
    floatSize = floatSize / 1024;

    return([NSString stringWithFormat:@"%1.1f GB",floatSize]);
} 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2011-12-31T19:21:17.367

这是一个更类似于 Objective C 的函数（使用 NSNumber、NSArray、NSStirng 等）来进行这种转换。

这是基于 Sidncious 的回答，非常感谢您在那里完成的初步工作。也基于维基百科的文章。

通常像这样使用它：`[HumanReadableDataSizeHelper humanReadableSizeFromBytes:[NSNumber numberWithDouble:doubleValue]]`.

但是，看起来您想要具有 1024 乘数的 SI 单位，因此您可以像这样使用它：`[HumanReadableDataSizeHelper humanReadableSizeFromBytes:[NSNumber numberWithDouble:doubleValue] useSiPrefixes:YES useSiMultiplier:NO]`

我默认使用二进制前缀 (ki, Mi) 的原因是因为它们似乎是最适合用于计算机上数据大小的单位前缀集。您要求的是 SI 单位前缀，但使用 1024 的乘数，技术上不正确。虽然我会注意到 1024 的倍数的 SI 前缀相当普遍，并且二进制前缀不被很好地接受（根据 Wikipedia）。

HumanReadableDataSizeHelper.h

```
@interface HumanReadableDataSizeHelper : NSObject

/**
    @brief  Produces a string containing the largest appropriate units and the new fractional value.
    @param  sizeInBytes  The value to convert in bytes.

    This function converts the bytes value to a value in the greatest units that produces a value >= 1 and returns the new value and units as a string.

    The magnitude multiplier used is 1024 and the prefixes used are the binary prefixes (ki, Mi, ...).
 */
+ (NSString *)humanReadableSizeFromBytes:(NSNumber *)sizeInBytes;

/**
    @brief  Produces a string containing the largest appropriate units and the new fractional value.
    @param  sizeInBytes  The value to convert in bytes.
    @param  useSiPrefixes  Controls what prefix-set is used.
    @param  useSiMultiplier  Controls what magnitude multiplier is used.

    This function converts the bytes value to a value in the greatest units that produces a value >= 1 and returns the new value and units as a string.

    When useSiPrefixes is true, the prefixes used are the SI unit prefixes (k, M, ...).
    When useSiPrefixes is false, the prefixes used are the binary prefixes (ki, Mi, ...).

    When useSiMultiplier is true, the magnitude multiplier used is 1000
    When useSiMultiplier is false, the magnitude multiplier used is 1024.
 */
+ (NSString *)humanReadableSizeFromBytes:(NSNumber *)sizeInBytes  useSiPrefixes:(BOOL)useSiPrefixes  useSiMultiplier:(BOOL)useSiMultiplier;

@end 
```

HumanReadableDataSizeHelper.m

```
@implementation HumanReadableDataSizeHelper

+ (NSString *)humanReadableSizeFromBytes:(NSNumber *)sizeInBytes
{
    return [self humanReadableSizeFromBytes:sizeInBytes  useSiPrefixes:NO  useSiMultiplier:NO];
}

+ (NSString *)humanReadableSizeFromBytes:(NSNumber *)sizeInBytes  useSiPrefixes:(BOOL)useSiPrefixes  useSiMultiplier:(BOOL)useSiMultiplier
{
    NSString *unitSymbol = @"B";
    NSInteger multiplier;
    NSArray *prefixes;

    if (useSiPrefixes)
    {
        /*  SI prefixes
         http://en.wikipedia.org/wiki/Kilo-
         kilobyte   (kB)    10^3    
         megabyte   (MB)    10^6    
         gigabyte   (GB)    10^9    
         terabyte   (TB)    10^12   
         petabyte   (PB)    10^15   
         exabyte    (EB)    10^18   
         zettabyte  (ZB)    10^21   
         yottabyte  (YB)    10^24   
         */

        prefixes = [NSArray arrayWithObjects: @"", @"k", @"M", @"G", @"T", @"P", @"E", @"Z", @"Y", nil];
    }
    else
    {
        /*  Binary prefixes
         http://en.wikipedia.org/wiki/Binary_prefix
         kibibyte   (KiB)   2^10 = 1.024 * 10^3
         mebibyte   (MiB)   2^20 ≈ 1.049 * 10^6
         gibibyte   (GiB)   2^30 ≈ 1.074 * 10^9
         tebibyte   (TiB)   2^40 ≈ 1.100 * 10^12
         pebibyte   (PiB)   2^50 ≈ 1.126 * 10^15
         exbibyte   (EiB)   2^60 ≈ 1.153 * 10^18
         zebibyte   (ZiB)   2^70 ≈ 1.181 * 10^21
         yobibyte   (YiB)   2^80 ≈ 1.209 * 10^24
         */

        prefixes = [NSArray arrayWithObjects: @"", @"ki", @"Mi", @"Gi", @"Ti", @"Pi", @"Ei", @"Zi", @"Yi", nil];
    }

    if (useSiMultiplier)
    {
        multiplier = 1000;
    }
    else
    {
        multiplier = 1024;
    }

    NSInteger exponent = 0;
    double size = [sizeInBytes doubleValue];

    while ( (size >= multiplier) && (exponent < [prefixes count]) )
    {
        size /= multiplier;
        exponent++;
    }

    NSNumberFormatter* formatter = [[[NSNumberFormatter alloc] init] autorelease];
    [formatter setMaximumFractionDigits:2];
    [formatter setNumberStyle:NSNumberFormatterDecimalStyle]; // Uses localized number formats.

    NSString *sizeInUnits = [formatter stringFromNumber:[NSNumber numberWithDouble:size]];

    return [NSString stringWithFormat:@"%@ %@%@", sizeInUnits, [prefixes objectAtIndex:exponent], unitSymbol];
}

@end 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-03-29T11:13:05.820

您可以使用**FormatterKit**及其`TTTUnitOfInformationFormatter`类：

[https://github.com/mattt/FormatterKit](https://github.com/mattt/FormatterKit)

它也可以通过 CocoaPods 获得：

```
pod 'FormatterKit', '~> 1.1.1' 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-08-12T16:46:01.883

```
- (id)transformedValue:(id)value
{

    double convertedValue = [value doubleValue];
    int multiplyFactor = 0;

    NSArray *tokens = @[@"bytes",@"KB",@"MB",@"GB",@"TB"];

    while (convertedValue > 1024) {
        convertedValue /= 1024;
        multiplyFactor++;
    }

    return [NSString stringWithFormat:@"%4.2f %@",convertedValue, tokens[multiplyFactor]];
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-10-27T08:28:38.527

我知道问题是针对 Obj C 的，但如果有人在寻找快速版本：

```
 public static func fileSizeDisplay(fromBytes:Int) -> String {
        let display = ["bytes","KB","MB","GB","TB","PB"]
        var value:Double = Double(fromBytes)
        var type = 0
        while (value > 1024){
            value /= 1024
            type = type + 1

        }
        return "\(String(format:"%g", value)) \(display[type])"

    } 
```

# memory - 是伟大的记忆是伟大的编程的要求

> ID：572620
> 
> 赞同：35
> 
> 时间：2009-02-21T08:15:11.387
> 
> 标签：memory

您认为成为一名出色的程序员需要拥有出色的记忆力吗？

我不认为自己是一个伟大的程序员，但我确实认为我很体面。但我的记忆力真的很差，所以我发现自己总是不得不提醒自己如何做事。我的意思是我“知道在哪里看”，但有时它让我觉得我只是一个蹩脚的程序员。更糟糕的是，我总是忘记源代码中的内容或在某些情况下使用的算法。

回想一下你在生活中遇到过的伟大的程序员，是不是每个人都有美好的回忆？

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2009-02-21T09:18:07.990

肯定是错误的，但这是[爱因斯坦的数字](http://weblogs.macromedia.com/jd/archives/2005/12/search_user_mut.html)：

> 一位记者采访了阿尔伯特·爱因斯坦。采访结束时，记者问他是否可以得到爱因斯坦的电话号码，以便他有其他问题可以打电话。
> 
> “当然”爱因斯坦回答。他拿起电话簿，查到自己的电话号码，然后写在一张纸条上，递给了记者。
> 
> 记者目瞪口呆地说：“你被认为是世界上最聪明的人，连自己的电话号码都不记得了？”</p>
> 
> 爱因斯坦回答说：“我知道在哪里可以找到它，为什么还要记住它？”</p>

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-02-21T09:57:08.990

我有一个同事写了非常糟糕的代码，而且非常难以维护。我得出的结论是他的问题是记忆力好。他只是能够记住他在哪里放置了哪些功能。因此，他不必编写不言自明的代码。他只记得那个废话。我们其他人很难弄清楚他的代码。

我敢肯定，良好的记忆力不仅仅是这些家伙的问题。但我敢肯定，如果他的记忆力变差，他的代码会改进。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2009-02-21T08:23:51.163

将您的短期记忆视为堆栈（不是静态的），不要期望更多。我回到了我一个月前写的代码，它几乎就像其他人写的一样.. 回到同一个区域只需要一段时间。

我经常被取笑，经常像面包屑一样为自己留下评论……但它确实有效。如果我完成某个函数并说“啊哈，这绝对是棒极了！”，我会立即评论我的复杂性，因为我肯定会忘记。

所以现在，用两个问题来回答一个问题：

1.  上周三你午餐吃了什么？
2.  hash_foo() 中“计数器”的目的是什么？

至少，使用#2，您可以快速返回并查看/记住。

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2009-02-21T08:30:47.793

只要您能记住 google 的拼写方式，就可以了。:)

但说真的，你确实需要一次在你的短期记忆中保留几件事。我认为长期记忆不太重要。只要您意识到某些东西的存在，您以前看过某些东西等等，那么当它变得相关时，您就会知道您可以挖掘它。

有经验的程序员通常可以重复 API、次要细节等，但根据我的经验，这**从来不是**坐下来死记硬背的情况。这是一次又一次地使用事物的自然结果。

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2009-02-21T09:28:35.703

我会说相反，拥有良好的记忆力可能会导致编写只有作者才能理解的代码，因为她记得其逻辑的细节。另一方面，我记性不好，记录我的代码并尽可能清楚地写出来。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2009-02-21T10:26:15.457

老实说，我发现记忆力差是一种资产，即使是短期记忆力也差。短时记忆力差真的会迫使你打破关注点的分离。最终的结果是非常干净、非常简单、封装得非常好的代码。实际上，我的短期记忆力非常好，但是在编写代码的一些经验之后，我学会了*非常*努力地不使用它，而我的注意力已经足够分散，以至于我无法一次真正记住很多东西。实际上，我很震惊地发现代码实际上比我过去开发的代码要干净得多。

长期记忆力差是一种资产，因为你最终会很好地训练自己如何找到和学习技术、API、算法等。它也倾向于鼓励你找到一小部分共同主题来指导你的工作.

总而言之，优秀程序员的标志不是复杂性（如果没有良好的内存，这真的很难实现），而是简单性（本质上不需要太多内存）。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2009-02-21T08:24:04.970

我可以用一个词准确地回答这个问题：不。拥有很好的记忆力来记住所有关于编程的知识并不是必须的。经验和繁琐的实践学习是最好的。

我也有过这种经历。如果您有足够的经验（或数年）来创建应用了最佳实践的软件，那么您就是真正掌握自己的工作或用于创建软件的编程语言的大师。如果你有不好的记忆，请不要难过，但努力学习和练习可以战胜你的记忆力弱点。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2009-02-21T09:43:10.647

对我来说，世界上有两种程序员。第一个生来就是这样做的，第二个学会了。在这两个群体中，他们的范围从令人难以置信的贫穷到令人难以置信的伟大。内存是否表示这些评级？不，绝对不是。虽然良好的记忆力可以帮助您学习，但没有什么比练习和理解更能帮助您了。毕竟，能够记住整本大英百科全书，没有理解就没有任何意义。我的服务器存储就是一个典型的例子。

编程是关于逻辑的，包括代码和解决问题的方式。如果您想要清晰、易于理解的代码，那么您很可能会将问题分解为易于管理的小块（即，它们整体上适合您的头脑）并处理每个块。然后，每个函数都浓缩为一个命令，用于下一阶段的复杂性。在下一个阶段结束时，如果还有另一个，您将再次拥有一组单一的命令来构建。逻辑命名、逻辑分区、逻辑组装......我想我的逻辑观点是正确的；）

我的记忆是骇人听闻的，我的意思是骇人听闻。我可以被介绍给 3 个人，当 #3 的名字被说出时，我已经忘记了 #1 是谁。我仍然可以写一些好的代码，而不是每次或每天；当你在这个区域里时，它是别的东西，那时它*就是*艺术。所以，把你的记忆放在一边，给自己一个真正安静的空间或一个粉红噪声发生器，然后潜入。唯一能让你成为更好的程序员的事情就是练习、练习、练习。唯一要记住的是，编程是一种技能，并且技能是经过实践的，并且最好在可以提供建设性批评和建议的朋友中实践……例如 Stack Overflow :)

为这个答案的大部头道歉，但我不记得我已经写了什么;）

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2009-02-21T13:18:38.490

在提到 Edsger Dijkstra 时，一个称职的程序员完全意识到他自己头骨的有限大小。你不把更多的细节塞进你的脑海里，你就能更好地解决手头的问题。

非常模块化你的代码，重构代码，将你漂亮的算法打包到对象中，然后使用这些对象，这样你就不必总是“微观地记住”你程序的每一个实现细节。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2009-02-21T08:45:26.213

拥有良好的记忆力非常有用，但肯定不是必需的。我想说，并不是伟大的程序员有很好的记忆力，而是他们花了很多时间研究即使是最小的问题，这也提高了他们的理解力并提高了回忆。如果您花 4 分钟解决问题（谷歌搜索或在 SO 中询问），那么当您在 4 个月后再次遇到该解决方案时，您可能不会记得该解决方案。它可能是一种进化特征，也可能只是一种糟糕的记忆=）

优秀的程序员也有深思熟虑的原则，这些原则使他们能够自动驾驶而不用怀疑自己。一套好的原则还可以通过强化实现一致性和可预测性（这是记忆的一种品质）。

这也延伸到其他领域。国际象棋大师们可以回忆起 40 年前的一整场比赛。那是因为他们记得模式（开局、变化、导致最终游戏的动作的根本原因和影响等）。这有助于将个人移动组合成单位。

在软件中，工具可以像自动完成或具有 KB/Wiki 和可搜索的签入历史等可以提供帮助。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2009-02-21T09:14:34.910

不，但也许它可以*让*你变得很棒......

编程的艺术（也许*是*艺术）是能够以一种你可以掌握所有问题的方式处理问题，尽管你有局限性（例如不完美的记忆）。这是因为*每个人*——包括我们当中最聪明的人——都有局限性。撞到你的局限并不是你有局限的标志，而是你正在走得更远的标志。

这种艺术（据我所知）包括分治法（使用各种模块，以匹配问题的形式）；使用标准技术来传达您的意图（成语，OO*设计模式*只是其中之一）；分离出问题的核心（这与代码无关：它与问题有关）；当然还有评论。

我曾经相信好的代码是自我记录的（甚至，那个*代码是真实的*），但最近我正在编写解析器，在评论中包含 CFG 是一个非常有用的参考，因为它是一个更简单的表示代码的意图。

*编码员必须知道他们的局限性*。期望几个月后对某件事有同样的把握是不现实的，就像你正处于困境中时一样。以上所有内容都涉及接受该问题并制定解决方案。它不仅让你的代码更容易被你以后掌握，它也让其他人更容易掌握......但最重要的是，我坚信更清晰、更简单的代码从根本上来说是*更好的代码*。

*称职的程序员完全清楚自己头骨的大小受到严格限制；因此，他非常谦虚地处理编程任务，除此之外，他还避免了像瘟疫这样的巧妙技巧。*- 迪杰斯特拉

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2009-02-21T08:27:09.470

不。从长远来看，忘记你所知道的并继续学习的能力至少同样重要。

好的笔记、书签和网络搜索有很长的路要走。

记住真正简单的事情是伟大的编程所必需的。像“坚持下去”这样简单的事情。

从监视器的另一端看一个有趣的视角：[参考位置](http://en.wikipedia.org/wiki/Locality_of_reference "参考地点")

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2009-02-21T18:56:43.920

与实用计算机相比，记忆力差的程序员就像[通用图灵机](http://en.wikipedia.org/wiki/Universal_Turing_machine)：从技术上讲，您可以通过参考您或其他人在某处记录的信息来完成相同的事情……只是可能需要更长的时间……

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2009-02-21T14:21:14.423

这一切都取决于你的美好记忆记得什么。

我在同一个项目上工作了 10 年左右，我不记得每一行，是谁写的，为什么写的。

但是......我几乎可以记住所有用户请求和用户问题。谁想要什么，什么时候。

我几乎可以记住我们遇到的所有支持问题。

查找旧代码很容易——我们有很好的工具。查找旧问题是一个更加抽象的过程：我们有 JIRA 和 Wiki，但有时它们不会删除它，因为它们无法提供语义含义。

所以。注意真正重要的事情并记住这一点。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2009-02-21T13:37:59.410

我见过的一些写得最好的代码是以这样一种方式编写的，即每个设计决策都是不可避免的，并且代码被解读为它自己的解释。恕我直言，这**比***需要*读者（或更糟糕的是，维护者）记住大量任意细节的代码要好得多。

*我自己的代码复杂性*指数是“要理解这一行，我需要记住多少内容？”

越多越糟糕。

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2009-02-22T22:49:08.737

我认为能够以不同程度的能力记住不同类型的事物是可能的。

例如，我有时会发现当涉及到随机的事实和数据以及我已经完成或将要做的事情时，我的记忆力很差——后者意味着我发现错误跟踪软件是一个非常宝贵的工具。

另一方面，我可以记住我编写的复杂软件的结构，以及在哪里可以找到其中的特定内容。

这可能与逻辑关联有关。设计良好的软件应该（理论上）具有逻辑结构，如果你的大脑以这种方式连接起来，它可能更容易存储在你的记忆中。

然而，随机信息可能没有这些关联，使它们更难记住。

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2009-02-22T23:13:03.390

我会说它是伟大和快速的必要条件。我对编程细节的记忆还可以（但我有谷歌）。但是，当我坐在主要编写的应用程序（约 30-40 k 行代码）面前时，我几乎可以将其结构完全加载到我的记忆中。我可以在几秒钟内找到我正在做某事的方式，并回想我为什么以我的方式实施它。那是无价的。到上午 11 点，我已经能够比其他人一整天做更多的工作。现在，这并不能让我成为一个伟大的程序员，但它确实让我成为了一个非常有生产力的高效程序员。这让我有时间重构、编写额外的代码、浏览 SO、吃一个小时的午餐等等。

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2009-02-21T08:32:19.553

我认为拥有良好的记忆力有助于*快速*学习新事物。

这并不意味着它是成为一名优秀程序员的必要条件。

事实上，它更多的是关于*智力*而不是*记忆*能力，但它是一个过于复杂的主题，无法识别某些品质并将它们与编程技能进行比较，并能够检索任何相关信息。

这就是大脑的奥秘。

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2009-02-21T10:52:17.267

我认为拥有良好记忆力的一个好处（谦虚一点：我有良好的记忆力）是能够在实际上不在电脑前时能够独立思考。

例如，当有人建议您的应用程序使用某种新功能时，您可能正在*开会。***可以做到吗？大概需要多长时间？**如果您几乎可以在脑海中走过 250k 位置，那么这些问题就更容易回答了。

也就是说，我在其他人的意见中发现了一些事实，即我自己的代码可能不太清楚，因为我可以更好地记住它。

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2009-02-21T12:08:14.993

奥卡姆剃刀建议一个更简单的理论更可能是正确的。

如果代码是一个理论，描述输入到输出，那么更短的代码，使用预期的习语和库，更有可能是“真实的”——也就是说，它更有可能抓住解决方案的本质，所以它会泛化输入你没想到的。

更短、不出所料的代码更容易记住。

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2009-10-23T23:32:09.807

只是一句简单的评论“重复是学习之母”，不管你的记忆力好坏。您在程序中使用得更多的功能您会记得最清楚。另外，在我的情况下，我有互联网，当我不记得我只是问的东西时，即使这是一个愚蠢或简单的问题，而且很多时候我在发布问题后记得答案，然后我很快发布答案。问题是你花多少时间去工作......

:)

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2009-02-21T12:56:59.790

拥有足够强大的记忆力来保存您今天需要使用的东西是重要的部分。如果你不断地寻找同一个问题的答案，你可能记忆力较弱。

最重要的是记住在哪里可以找到答案。有时我会在博客上写一些更复杂的主题，这样我就可以在需要时找到它们。但我不会试图永远持有它们，因为我可以搜索我自己的博客并在以后找到它们。我对其他人的博客也这样做，而且我知道针对某些类型的答案应该点击哪些博客。

当一切都失败时，谷歌它！

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2009-02-21T13:02:57.873

我曾经认为拥有良好的记忆力可以节省时间，因为您记住的越多，查找内容的时间就越少，但是现在工具和 IDE 变得如此出色，我曾经记住的许多东西，例如语法和各种代码片段只需几次击键即可快速使用。那个，以及该领域的信息量增长速度比任何普通程序员都可以跟上的事实，让我认为内存不再那么重要了。更重要的是，可以很好地访问和组织有用的信息。

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2009-02-21T08:45:48.317

我认为这取决于。内存对于程序员来说是非常非常重要的。短期和长期。但是，您使用该内存的目的是重要的。作为一名程序员，如果你用它来记住 API 的细微差别，那么我会说你是在浪费你的记忆力。

最终，我尝试用我的记忆来记住重要的事情以及以后无法轻易找到的任何事情。我通常会将 API 的东西放在短期记忆中，并使用 google 和 intellisense 来帮助我了解细节。另一方面，设计模式、方法论、从经验中吸取的教训通常是我试图长期记忆的东西，这样我将来就可以有效地使用它，而不必重新学习所有东西。

简而言之，是的，程序员需要良好的记忆力……无论是长期的还是短期的。但是他们需要明智地使用这些内存……我认为，这对一个伟大的程序员来说会有所不同。

# svn - 使用 git-svn 时避免冲突

> ID：572640
> 
> 赞同：10
> 
> 时间：2009-02-21T08:34:01.247
> 
> 标签：svn, git, version-control, git-svn

在以下情况下，从共享 git 存储库中提取时，我面临着重复的代码冲突：

1.  有一个通用的svn仓库

2.  有几个开发人员使用 git-svn 桥（通过 git svn rebase/dcommit）跟踪/同步这个常见的 svn 存储库与他们自己的本地 git 存储库

3.  这些使用 git 的开发人员有时需要在不影响 svn 存储库的情况下共享他们的更改。为此，他们设置了一个共享的 git 存储库并使用拉/推命令交换他们的工作

4.  事实证明，由于使用“git svn rebase”与主 svn 存储库同步，这些开发人员可能会面临冲突问题。发生这种情况是因为 rebase 操作会重写本地 git 分支的历史记录，并且无法推送到共享的 git 存储库中，并且从中拉出通常会导致冲突。

有人有同样的问题吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-21T19:16:46.680

[git-svn(1)](http://git-scm.com/docs/git-svn)说：

> 为简单起见和与能力较差的系统（SVN）互操作，建议所有 git-svn 用户直接从 SVN 服务器克隆、获取和 dcommit，并避免所有 git-clone/pull/merge/push 操作在 git 存储库和分支之间。在 git 分支和用户之间交换代码的推荐方法是 git-format-patch 和 git-am，或者只是“dcommit”到 SVN 存储库。

如果您的情况允许，您可以使用 SVN 存储库中的分支（即子目录）将您的工作与其他开发人员隔离开来。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-13T17:01:53.670

我发现将 git-svn 更改合并到各种 git 分支以及它们之间是完全可以的。git-svn 问题开始的地方是将这些更改合并回 svn（或者更确切地说，是您 dcommit 的 git 分支）。`git diff | patch`在我看来，如果您手动将更改合并回 svn（例如 by ），大多数这些问题都可以避免。这将从您合并的东西中删除历史记录，但是颠覆用户已经习惯了，这没什么大不了的。

# c# - 如何获得活动的订阅者？

> ID：572647
> 
> 赞同：30
> 
> 时间：2009-02-21T08:44:10.757
> 
> 标签：c#, events

我需要将一个事件的订阅者复制到另一个事件。我可以获取事件的订阅者（例如 MyEvent[0] 返回代表）吗？

如果这不可能，我会使用 add 访问器将代表添加到列表中。那会是最好的解决方案吗？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-02-21T09:10:48.040

C# 事件/委托是多播的，因此委托*本身就是*一个列表。在课堂上，要获得单独的来电者，您可以使用：

```
if (field != null) 
{ 
    // or the event-name for field-like events
    // or your own event-type in place of EventHandler
    foreach(EventHandler subscriber in field.GetInvocationList())
    {
        // etc
    }
} 
```

但是，要一次全部赋值，只需使用 += 或直接赋值：

```
SomeType other = ...
other.SomeEvent += localEvent; 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-02-21T08:56:31.740

如果该事件是由另一个班级发布的，那么您不能 - 至少，不可靠。虽然我们通常认为事件只是一个委托变量，但它实际上只是一对方法：添加和删除（或订阅和取消订阅）。

如果是您自己的代码发布事件，这很容易 - 您可以让添加/删除访问器做任何您喜欢的事情。

看看[我关于事件的文章](http://pobox.com/~skeet/csharp/events.html)，看看是否对你有帮助。如果没有，请提供有关您想要做什么的更多详细信息，指定您可以修改哪些代码位以及您不能修改哪些代码。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2017-11-03T13:57:30.653

如果您需要检查外部类事件的订阅者：

```
EventHandler e = typeof(ExternalClass)
    .GetField(nameof(ExternalClass.Event), BindingFlags.Instance | BindingFlags.NonPublic)
    .GetValue(instanceOfExternalClass) as EventHandler;
if (e != null)
{
    Delegate[] subscribers = e.GetInvocationList();
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-21T08:53:26.333

更新（感谢评论者）：委托不变性意味着克隆对分配没有任何作用。

当一个人写道：

```
myDelegate += AHandler 
```

一个全新的委托实例被创建并分配给`myDelegate`.

因此，如果没有 Clone 调用，下面的代码将完全一样地工作。

* * *

`MulticastDelegate`（底层类型）有一个`Clone`方法。

为了能够访问底层委托，您可能需要避免使用 event 关键字生成的常用助手，并直接管理事物（自定义添加和删除访问器）。

要显示这一点：

```
public class Program {
    public delegate void MyDelegate(string name);

    public event MyDelegate EventOne;

    public void HandlerOne(string name) => Console.WriteLine($"This is handler one: {name}");
    public void HandlerTwo(string name) => Console.WriteLine($"This is handler two: {name}");
    public void HandlerThree(string name) => Console.WriteLine($"This is handler three: {name}");

    public void Run() {
        EventOne += HandlerOne;
        EventOne += HandlerTwo;
        Console.WriteLine("Before clone");
        EventOne("EventOne");

        MyDelegate eventTwo = (MyDelegate)EventOne.Clone();
        MyDelegate eventTwo = EventOne;
        Console.WriteLine("After clone copy");
        EventOne("EventOne");
        eventTwo("eventTwo");

        Console.WriteLine("Change event one to show it is different");
        EventOne += HandlerThree;
        EventOne("EventOne");
        eventTwo("eventTwo");
    }
    private static void Main(string[] args) => (new Program()).Run();
} 
```

# c# - 用户已通过身份验证，但 Ticket.UserData 丢失

> ID：572656
> 
> 赞同：3
> 
> 时间：2009-02-21T08:53:48.407
> 
> 标签：c#, asp.net, forms-authentication

我有以下代码：

```
if (HttpContext.Current.Request.IsAuthenticated == false)
{
    // this isn't reached so i know user is Authenticated
    return;
}
FormsIdentity fIdentity = HttpContext.Current.User.Identity as FormsIdentity;
string[] delimitedUserData = fIdentity.Ticket.UserData.Split('|');
// but at this point delimitedUserData.Length is 0 
```

关于什么会导致身份验证票有效但 UserData 消失的任何想法？

我的程序通常工作得很好，所有的 UserData 都很容易访问。但是每隔一段时间，我就会进入 UserData 不存在的状态。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-22T18:06:45.433

票据存储在 cookie 中。当您在 cookie 过期后访问页面时，您的代码会发生什么？

另请注意，`User.Identity.IsAuthenticated`开箱即用返回 true，因此该属性可能不是最好的测试对象？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-22T18:15:34.540

FormsAuthentication 本身不会将任何内容放入您的 UserData。值得在您处理票证创建（以及创建用户数据）的位置附近放置一个断点并跟踪它所采用的路径。

由于您的错误是间歇性的，因此可能很难强制触发它。一个开始的地方可以是跟踪它如何处理 cookie 过期或 cookie 何时无效。

如果您使用的是 Firefox，我建议您使用“Add N Edit Cookies”插件：[https ://addons.mozilla.org/en-US/firefox/addon/573](https://addons.mozilla.org/en-US/firefox/addon/573)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-23T12:56:13.020

不确定这是否是最好的方法，因为我对 asp.net 还是很陌生，但是我在登录时这样做的方式是设置一个会话值，我可以在以后的页面中检查它——这样，如果 cookie丢失，我应该无法取回该值，因此我可以转移到登录页面。

所以，直接在登录后（在 _LoggedIn 事件中），我这样做：

```
 // write ClientID to the session
        Session.Add("ClientID", lClientID); 
```

然后在登录后面的每个页面的负载上，我这样做：

```
if (User.Identity.IsAuthenticated == false || Convert.ToInt32(Session["ClientID"]) == 0)
    {
        Server.Transfer("Login.aspx");
    } 
```

到目前为止，它对我来说效果很好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-18T05:39:35.347

我正在搜索相同的问题并发现我使用“FormsAuthentication.RedirectFromLoginPage”添加cookie的问题。我变成了“response.cookies.add”。及其工作。

# c++ - 如何使用VS2008 Pro自带的单元测试工具来测试一个C++项目？

> ID：572661
> 
> 赞同：2
> 
> 时间：2009-02-21T09:01:33.867
> 
> 标签：c++, visual-studio-2008, unit-testing

这是我所做的：我选择测试-> 创建新测试-> 向导然后它要求我输入项目名称。我做到了。然后它告诉我选择一个源项目进行测试，我选择了我的工作项目......但是......弹出一个警告对话框：“未知虚拟地址0”并拒绝继续。

我多次尝试重建我的源项目......没有运气

谁能帮我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-21T09:16:22.737

[在这里](http://blogs.microsoft.co.il/blogs/kolbis/archive/2007/07/08/Visual-C_2B002B00_-Unit-Testing-in-VS.aspx)，您将找到 C++ 中 VS 测试用法的完整描述。Citate - 如果您的生产代码是用 Visual C++ 编写的，那么只有当您的产品使用 /clr:safe 编译器选项时，您才能生成单元测试。

# iphone - 如何在 iPhone 上进行实时声音/信号处理？

> ID：572674
> 
> 赞同：4
> 
> 时间：2009-02-21T09:21:18.607
> 
> 标签：iphone, audio, signal-processing, near-real-time

我可能正在做一个基于 iPhone 的应用程序来进行近乎实时的声音处理（过滤等）。我想知道最好的开始方式。我想创建一个用于录制和处理声音的音频提示，如此处所述[吗](http://developer.apple.com/iphone/library/documentation/MusicAudio/Conceptual/AudioQueueProgrammingGuide/AQRecord/chapter_3_section_1.html#//apple_ref/doc/uid/TP40005343-CH4-SW1)？

## 编辑：

我应该清楚。一般来说，我不是在问如何进行信号处理。我知道其中一些，其余的将由我团队的专家处理。我问iphone上声音数据的“低级”接口是什么。

## 编辑2：

我的 iphone 开发被推迟了一两个星期，所以我现在无法使用开发工具包。一旦我可以访问该工具包，我将标记一个答案或另一个正确答案。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-21T20:29:28.330

声音处理是一个很大的课题。AudioQueue 将为您提供原始数据。Apple 提供了两个示例来帮助您开始使用 AudioQueue：SpeakHere 和 AurioTouch。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-09T00:51:38.950

我使用 SpeakHere 作为我想做的一些音频处理的起点。它相对容易理解，并且有所有的部分来做输入和输出。

# trac - 如何在 TRAC 中编辑项目组件

> ID：572677
> 
> 赞同：5
> 
> 时间：2009-02-21T09:24:13.810
> 
> 标签：trac

在 TRAC 中创建新工单时，它会在工单属性中显示组件的选择框。我只有两个虚拟选项：component1 和 component2。

如何编辑此列表？如何向项目添加更多组件？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-21T09:53:36.750

实现这一点的最简单方法是通过[WebAdmin 插件](http://trac.edgewall.org/wiki/WebAdmin)。您可以从那里轻松编辑组件、票证类型、严重性等。

正如 Oliver Giesen 在他的评论中告诉我们的那样：对于 trac 0.11 及更高版本，WebAdmin 插件已经是标准安装的一部分。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-21T09:33:22.527

```
trac-admin 组件列表
    -- 显示可用组件
trac-admin 组件添加  
    -- 添加一个新组件
trac-admin 组件重命名  
    -- 重命名组件
trac-admin 组件删除
    -- 删除/卸载组件
trac-admin 组件 chown  
    -- 更改组件所有权

```

# c++ - 类模板内数据成员的条件包含/排除

> ID：572684
> 
> 赞同：2
> 
> 时间：2009-02-21T09:31:36.727
> 
> 标签：c++, templates

我想使用 SIMD 指令和编译器内在函数优化我的 Vector 和 Matrix 类（确切地说是类模板）。我只想针对元素类型为“float”的情况进行优化。使用 SIMD 指令需要接触数据成员。由于我不想为维护两个单独的类而烦恼，我希望能够根据模板参数的类型启用/禁用某些数据成员。如果适用，这种方法的另一个优点是，我可以将一般情况下的相同代码用于我不想为其编写专门化的函数。因此，我想用伪代码实现的是：

```
template< typename T >
class Vector3 {
    if type( T ) == float:
        union {
            __m128 m128;
            struct {
                float x, y, z, pad;
            };
        };
   else
       T x, y, z;
   endif
}; 
```

我知道通过使用 Boost.enable_if 或类似工具可以有条件地包含成员函数。不过，我正在寻找的是有条件地包含数据成员。与往常一样，非常感谢您的帮助。也欢迎其他有效的建议。

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-21T10:36:21.970

一个浮现在脑海中的解决方案是部分专业化的模板，这是 Martin York 发布的，但有所不同。

我会推荐一个特殊的 content_type-struct 来提供布局类型，如下所示：

```
// content for non float types
template<typename T>
struct content_type {
   typedef typename T member_type;
   member_type x,y,z;
   member_type& X { return x; }
   // ...
   // if access to optional members is needed, better use CT_ASSERT or similar
   member_type& Pad { char assert_error_no_pad_here[0]; }
};

// content for float types
struct content_type<float> {
   typedef typename float member_type;
   member_type x, y, z, pad;
   member_type& X { return x; }
   // ...
   member_type& Pad { return pad; }
};

template<typename T>
class Vector3 {
    typedef typename content_type<T> layout_type;
    typedef typename content_type<T>::member_type member_type;

    layout_type _content;

  public:
    member_type& X { return _content.X(); }
    memmber_type& Pad { return _content.Pad(); }
};

// or maybe, if memory layout is not important, just inherit (watch for virtual members)
template<typename T>
class Vector3 : public content_type<T> {
    typedef typename content_type<T> layout_type;
    typedef typename content_type<T>::member_type member_type;
}; 
```

优点是您只需编写一次 Vector3 及其所有逻辑。

不过，您需要一个较新的编译器才能正确执行此操作（MSVC>7，gcc>3）

# c++ - 在什么情况下应该将成员函数声明为朋友？

> ID：572685
> 
> 赞同：5
> 
> 时间：2009-02-21T09:32:48.703
> 
> 标签：c++, function, friend

在什么样的场景中，我们会将成员函数声明为“朋友函数”？.. 违背 OOP 的“封装”中心概念之一的“朋友函数”的确切目的是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-21T09:51:56.880

出于与使用友元类相同的原因，您将使用友元函数，但基于成员函数（而不是整个类）。[这个线程](https://stackoverflow.com/questions/521754/when-to-use-friend-class-in-c)中有一些很好的解释。

虽然友元函数和类确实违反了封装，但它们在某些情况下可能很有用。例如，您可能希望允许测试工具访问类内部以允许您进行白盒测试。您可以打开一个特定的函数来访问测试工具所需的内部，而不是向测试工具开放整个类。虽然这仍然违反封装，但它比开放整个类的风险要小。

另请参阅[本文](http://www.cprogramming.com/tutorial/friends.html)以获取有关朋友类和函数的更多信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-21T19:44:47.313

当您尝试构建必须物理跨越多个 C++ 类或函数的抽象或接口时，友元函数和类不会违反封装！这就是朋友被发明的原因。

这些类型的情况并不经常出现，但有时您不得不使用不同的类和函数来实现抽象或接口。经典示例是实现某种类型的复数类。非成员运算符函数与主复数类有友谊。

我还记得在 C++ 中使用 CORBA 编程时这样做。CORBA 迫使我有单独的类来实现 CORBA 仆人。但是对于我们软件的特定部分，我需要将它们结合在一起作为一个界面。Friendship 允许这两个类一起工作，为我们软件的一部分提供无缝服务。

能够将另一个类上的特定成员函数标记为你的类的朋友可能看起来更奇怪，但这只是一种严格控制友谊的方式。您只允许其成员函数之一访问，而不是允许整个其他类作为您的朋友“加入”。同样，这并不常见，但在您需要时*非常有用。*

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-21T17:46:34.757

请参阅[C++ FAQ Lite：](http://www.parashift.com/c++-faq-lite/friends.html#faq-14.5)

> 有时朋友在语法上更好（例如，在 Fred 类中，朋友函数允许 Fred 参数位于第二位，而成员则要求它位于第一位）。友元函数的另一个很好的用途是二进制中缀算术运算符。例如，如果您还想允许 aFloat + aComplex ，则 aComplex + aComplex 应该定义为朋友而不是成员（成员函数不允许提升左侧参数，因为这会改变对象的类成员函数调用的接收者）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-21T10:08:12.223

有时公共/私人/受保护的保护级别对于现实世界的情况来说是不够的。因此，我们给出了一个小的退出子句，该子句无需公开可访问的方法即可提供帮助。

我个人使用它的方式与 Java 使用“包”保护级别的方式相同。
如果我在同一个包中有一个需要访问的类，我会考虑使用朋友。如果它是另一个包中的一个类，那么我会想知道为什么这个其他类需要访问并查看我的设计。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-21T19:51:50.657

我发现相关的一点：成员类可以访问包含类的私有部分。有时这可能是“朋友”的更好选择。

```
class A
{
private:
  int b;
public:
  class MemberNotFriend {
  public:
    static void test() {
      A a;
      a.b = 0;
    }
  };

};

void test()
{
  A::MemberNotFriend::test();
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-12-07T10:11:14.243

这是我如何使用朋友功能的一个简单而具体的示例：

我有一个游戏，其中每个精灵对象都将其信息（例如 X、Y 位置）存储为私有成员。但是，我希望将游戏对象与渲染分开：游戏对象不需要其渲染方式的确切细节。一个游戏对象只存储游戏状态，并且这个游戏状态可以以多种不同的方式呈现。

因此游戏对象类有一个友元函数：render()。render() 函数在游戏对象类之外实现，但它可以根据需要访问 X、Y 位置位置成员以渲染游戏对象。

# liferay - Liferay 门户主题问题

> ID：572697
> 
> 赞同：0
> 
> 时间：2009-02-21T09:43:51.113
> 
> 标签：liferay, themes

登录后点击登录页面时，偶尔会显示用户的个人空间，而不是默认的访客页面。这并不经常发生，但我的老板不希望它发生。我很难解释。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-21T10:01:50.087

这与编程无关[——liferay 论坛](http://www.liferay.com/web/guest/community/forums)会更好地解决这个问题。

除此之外，liferay 倾向于记住您上次访问的页面 - 当网站的一部分包含在 iframe portlet 中时，这不止一次让我感到痛苦 - iframe 内容是记住的“最后”访问页面，而不是包含 iframe 的页面。登录后，这就是目标。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-09-15T11:35:27.153

据我所知，如果未找到所需的登录页面（或上次访问的页面），则会在登录后显示个人页面。

`auth.forward.by.last.path=false`您可以通过在**portal-ext.properties**中设置来禁用登录后重定向到上次访问的页面

 **# asp.net-mvc - Asp.net MVC 路由问题

> ID：572698
> 
> 赞同：0
> 
> 时间：2009-02-21T09:44:19.817
> 
> 标签：asp.net-mvc, routing

使用 Asp.net MVC 在页面中添加样式表有多少种方法

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-21T13:38:18.490

无论您在哪里为详细信息页面指定 CSS，而不是相对路径，例如

```
<link href="../../Content/CSS/details.css" rel="stylesheet" type="text/css" /> 
```

尝试使用内容助手并指定虚拟路径

```
<link href="<%= Url.Content("~/Content/CSS/details.css") %>" rel="stylesheet" type="text/css" /> 
```

似乎该站点在加载基于相对链接的 CSS 文件时遇到问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-21T11:27:19.367

使用指向 css 的绝对链接而不是相对链接（例如`/Content/site.css"`，而不是`"../Content/site.css"`）。您也可以使用`Html.Stylesheet("~/Content/site.css")`扩展名（在 MvcContrib 库中）来指定样式表。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-21T10:23:08.943

问题是没有得到正确的 CSS 吗？如果是这样，那么我会检查您的 Details.aspx 文件并确保指向 CSS 的链接是正确的路径。最有可能的是，您的 Details.aspx 文件被移动到新的子目录或另一个目录中，从而使 aspx 文件和 CSS 文件之间的相对路径不同。

我会从浏览器检查页面源代码并查看 CSS 文件的路径是什么。我解决问题的方法是修改 aspx 文件以使用 css 文件的完全限定路径。确保它有效。然后尝试更改完整路径以使用相对路径。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-12-01T22:50:58.500

在处理 MVC 书中的示例时，我遇到了同样的问题，它提到了一些关于 '~' 字符的内容，因为`<head>`标签上有`runat="server"`属性。因此，我尝试将 runat 属性添加到链接标签本身，如下所示，它起作用了：

```
<link runat="server" href="~/Content/styles.css" rel="stylesheet" type="text/css" /> 
```

# datetimepicker - 如何从 datetimepicker 中当前选择的值中分别检索日期和时间？

> ID：572704
> 
> 赞同：0
> 
> 时间：2009-02-21T09:50:22.827
> 
> 标签：datetimepicker

我想知道如何从日期时间选择器控件中当前选择的值中提取日期和时间？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-21T09:52:11.140

[`DateTimePicker.Value`](http://msdn.microsoft.com/en-us/library/system.windows.forms.datetimepicker.value.aspx)返回 a [`DateTime`](http://msdn.microsoft.com/en-us/library/system.datetime.aspx)，因此您可以使用 DateTime 的[`Date`](http://msdn.microsoft.com/en-us/library/system.datetime.date.aspx)和[`TimeOfDay`](http://msdn.microsoft.com/en-us/library/system.datetime.timeofday.aspx)属性。

**重要的提示：**

如果要将值保存到数据库，请将日期值放入数据参数中，不要连接字符串来构建 SQL 查询；这将使您容易受到 SQL 注入攻击。这是一个简短的示例（未经测试的代码，只是为了给您一个想法）：

```
DateTime theDate = dtPicker.Value.Date;
IDbCommand command = GetDbCommand("insert into table_name (name, thedate) values (@name, @thedate)");
command.Parameters.Add(command.CreateParameter("@name", theName));
command.Parameters.Add(command.CreateParameter("@thedate", theDate));
command.ExecuteNonQuery(); 
```

有关避免 SQL 注入攻击（以及解决“无效月份”）问题的更多信息，请参见此处：

[http://blogs.msdn.com/raulga/archive/2007/01/04/dynamic-sql-sql-injection.aspx](http://blogs.msdn.com/raulga/archive/2007/01/04/dynamic-sql-sql-injection.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-21T10:07:02.100

如果您只是希望它们用于显示目的，您可以执行以下操作：

> DateTimePicker.Value.ToShortDateString() - 会给你一个日期字符串
> DateTimePicker.Value.ToShortTimeStstring() - 会给你时间字符串

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2014-08-22T11:56:34.913

日期时间选择器值

为我工作。它显示日期和时间。

# security - 阻止用户在网站上多次投票

> ID：572723
> 
> 赞同：28
> 
> 时间：2009-02-21T10:06:12.743
> 
> 标签：security, voting

我打算在我运行的网站上添加一些赞成/反对按钮。这似乎很容易，但我想阻止人们多次投票。一种解决方案是让他们在允许他们投票之前进行注册，但我不想强迫他们注册。

有没有一种相当简单的方法可以做到这一点？检查 IP 地址似乎不是一个好的解决方案，因为多个用户可能来自同一个 IP 地址。

cookie 可能是答案，但精明的用户可以删除 cookie。有更好的想法吗？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-02-21T10:25:46.377

对不起，我没有有用的答案，我只是想分享我的经验。

大约 8 年前，我在一个运行在线投票的网站工作。我们曾经被一些机器人对我们的一些问题进行投票，每分钟数百票。

我不得不实施一些紧急检查：IP 地址、cookies，我真的不记得还有什么了。

最终，我们决定取消投票。那些该死的机器人根本不在乎。IP 地址被欺骗，cookie 被删除等。

如果你真的需要民意调查是不可破解的，我看不出有任何其他方式需要注册和使用验证码来避免机器人注册新帐户。

可悲的是，这只是一个娱乐网站，上面有关于你最喜欢的颜色和类似内容的民意调查。

我们唯一没有尝试过的是使用验证码，因为它们当时不存在。这可能大大减少了非人类作弊。

不要把这当作任何关于此事的专家建议，因为那是我唯一一次与在线民意调查有任何关系，但我记得我的故事并想分享。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-21T10:16:56.353

我认为这真的取决于您网站的性质，以及您的结果需要有多准确。

使用 cookie 似乎是最好的选择，但这取决于您网站的目标受众。他们是否足够精通技术以尝试击败系统以允许他们多次投票？如果没有，风险应该相当低，这似乎是最好的方法。

正如您所说，检查 IP 地址可能过于严格。但是，如果所有选票都必须来自独特的个人，这可能是更好的方法，即使这意味着一些合法选民将无法投票。

我想到了另一种选择，但我不确定它是否可能或可行。如果您可以将 IP 地址方法与基于硬件的检查（例如 NIC 的 MAC 地址）结合起来，这将消除由于 LAN 内的 NAT 而导致的 IP 地址方法过于严格。但是，如果您在网吧里有一台计算机供不同的人使用，这将无济于事。

您还应该使用验证码（用于非注册帐户）来减少投票机器人的可能性。如果有人想恶意投多票，让他们更难通过机器人自动化投票过程将有助于减少此类行为的发生。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-02-21T10:28:24.577

因此，您希望每个独特的人对每个项目只有一票。当一个人试图投票之前已经投票时，您想检测到这一点。这意味着您必须识别此人。没有什么技巧可以解决这个问题。

现在，由于人们可以从任何计算机登录，因此识别*计算机*无济于事。这排除了 IP 检查和 cookie，以及基于用户硬件的任何其他内容。

如何识别一个人？你不能。您只能通过提供独特的凭据来强制他们识别自己的身份，例如社会安全号码（我认为这在韩国经常使用）、护照号码或类似的。当然，如果您不检查它，这将无济于事，因为任何人都可以组成一个 10 位数的数字，而碰撞的可能性很小。

*即使让用户注册本身*并没有真正的帮助——他们只能注册另一个帐户。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-21T13:32:40.330

我想知道你是否可以让它成为一个多步骤的过程，让 BOT 变得更加困难。

注册或一些类似的任务会给你 Cookie-A，然后当你投票时，你会得到 Cookie-B，但如果你有 Cookie-B，但没有合适的匹配 Cookie-A，你的投票就不算数。如果您尝试在您已经拥有 Cookie-A 可以检测到的同一台机器上重新注册。过快地完成这些步骤被视为 BOT。

我们进行了心理测试，有很多问题，用户必须做出深思熟虑的答案。不到 N 秒的答案是有人只需按下按钮即可通过它。我们从来没有告诉他们他们的回答太快了，我们只是将数据标记为“可疑”。

所以任何试图直接点击投票按钮的人都不会工作。他们必须按顺序执行步骤 A，然后是步骤 b，然后是步骤 C。

要重新投票，我必须清除 cookie，重新注册，阅读简介页面（无论如何），最后重新投票，所有这些都按正确的顺序进行，而且不要太快。

要求启用 JavaScript 可能会有所帮助，验证码系统也可能会有所帮助。验证码可能会有某种延迟——“请注意这两个词出现”，这样有两个词，一个接一个地显示，但是“真实的词”，这样它们就可以很容易地记住，然后输入。任何回应是“太快”是无效的。

在某些时候，人们会变得恼火，但不会打扰。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-14T00:46:09.063

显然，您需要识别用户，以便他只能投票一次。但是识别用户并不意味着你必须弹出一个登录屏幕。如上所述，您可以要求提供电子邮件地址，并将其用作标识符。

没有人提到 stackoverflow 的工作方式，如果用户在成为注册用户时有什么可赢的（这里是声誉），并且登录过程就像提供电子邮件地址一样简单，那么这就是用户的双赢局面很高兴登录和投票，你很高兴让他注册并投票（每个问题只有一次）。

Jeff Atwood 写[了一篇关于“登录障碍”的文章](http://www.codinghorror.com/blog/archives/000881.html)，这可能会给你一些线索。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-09-07T15:12:48.720

我曾经为一场比赛创建了一个投票系统。由于多个人将合法地从同一个 IP 投票，我被限制限制 IP 投票。因此，我采用了电子邮件确认方法，要求每个选民输入一个电子邮件地址，确认链接发送到该地址，一旦单击，将激活他们的投票并防止使用该地址进行额外投票。

它没有很好地工作。人们在各种免费网站上创建了数百个虚假电子邮件地址。

在决选投票中起作用的，有点令人惊讶的是，将电子邮件地址/投票对添加到数据库中，但没有立即发送确认电子邮件。相反，我有一个 cron 作业每 15 分钟左右发送一批。这为注册许多地址的人增加了额外的复杂性，因为他们必须要么让它们全部打开，要么在将来的某个时候记住每个地址的登录信息。

当然，对于有足够动力的人来说仍然很容易绕过，但在这种情况下它似乎运作良好。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-09-28T23:35:30.803

我从未使用过这样的系统，但尝试通过浏览器的指纹来识别用户。这个[jQuery 插件](https://github.com/carlo/jquery-browser-fingerprint)结合了屏幕大小、颜色深度、用户时区和已安装的插件来创建用户的唯一 ID。绝对不是万无一失的，但这是一种不同的方法。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-24T12:22:21.470

还有一种可能：

让用户投票并填写他的电子邮件地址。用户会收到一封确认电子邮件，其中包含他需要单击以确认其投票的链接。

但是这样一来，用户也有相当多的开销。

或与注册用户（不会被强制确认）结合使用

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-21T10:15:37.760

没有准确的方法可以避免来自同一用户的多次投票，即使他们不删除 cookie，他们也可以使用其他浏览器或另一台计算机。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-21T10:18:14.727

我认为您应该在用户投票之前注册用户。您可以从用户那里获得一些信息来注册，这样他就不会感到无聊或破坏他的注册。之后，如果他愿意，他可以更新他的帐户。恕我直言，这是最好的解决方案。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-21T10:34:05.343

如前所述，没有“完美”的解决方案。

作为一种不完美解决方案的尝试，如何存储 IP 地址和用户代理的哈希值。

这意味着来自给定 IP 的不同用户，拥有不同的浏览器用户代理，仍然可以投票。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-02-21T11:24:10.137

使用基于 cookie 的方法，它对于网络上的大多数娱乐级民意调查来说足够准确。远离 IP 限制。这意味着大公司中只有一个人可以投票，而一个家庭中只有一个人可以投票。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2015-10-14T22:23:19.927

我知道这是一个旧线程。无论如何，我建议使用 evercookie ( [http://samy.pl/evercookie/](http://samy.pl/evercookie/) ) 来跟踪已经投票的用户！

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2020-03-01T17:47:38.570

一个老问题，但要触及新方法 - 现在有许多民意调查服务机构不知疲倦地工作以实施许多措施以避免重复投票，并不断调整他们的系统以应对人们引入的新方法来规避等。自己做这件事本身就是一份工作。

他们甚至提供品牌。大公司使用它们，所以你的公司不会因为外包民意调查而看起来很糟糕。

* * *

如果你需要自己做。

如前所述，注册是唯一可靠的方法。如果避免重复投票真的很重要（即，它不仅仅是喜欢的颜色或琐碎/有趣的东西），那么您还可以将投票限制在您发送到他们注册时使用的电子邮件的链接。

虽然仍然不是万无一失的（什么都不是），但至少你强迫他们拥有一个他们可以访问的真实电子邮件地址。这对用户投票来说并没有太大的麻烦，但是却让许多欺骗投票变得繁琐——注册、等待电子邮件、使用链接等。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2016-01-06T16:56:11.190

这是一个人可以控制多少个身份的问题。您越难让一个人控制多个身份，您的民意调查就越安全。

对于结果无关紧要的娱乐级民意调查，单一 cookie 方法就足够了。如果用户打开 icognito 窗口，很容易绕过。

如果设置注册障碍可以获得更好的保护，您可以使用基于 OAuth 的登录进行无缝身份验证，切换帐户以获得更多投票需要一些努力。但这并不能阻止绝望的人多次投票。

如果您在 SMS 中发送确认码，那就更好了。尽管人们可能拥有多个电话号码，但拥有大量电话号码来执行欺诈的情况并不常见。但是这种方法对您来说是花钱的，并且可以被 DoSing 服务器滥用以耗尽所有 SMS。

如果你想要政府级别的民意调查，投票可以决定选举。然后你应该让选民出现在登记处申请投票，让他们从准备好的 PIN 信封中选择一个，其中包含一个长哈希，他们可以在投票时输入。因此，除非组织者进行欺诈，否则选民不能。这也确保了匿名性。

* * *

## 回答 #16

> 赞同：-2
> 
> 时间：2009-02-21T10:09:17.150

您已经命名了所有可用的解决方案。;) 现在由你来决定。

我建议结合 IP 和 cookie 检查。

# php - PHP：使用字符串参数时 SQL 语句中的问题

> ID：572731
> 
> 赞同：0
> 
> 时间：2009-02-21T10:11:35.303
> 
> 标签：php, mysql

```
$befal = mysql_query("SELECT * FROM users WHERE username = $_GET[username]");
$rad = mysql_fetch_assoc($befal); 
```

等于

```
警告：mysql_fetch_assoc()：提供的参数不是第 4 行 C:\profile.php 中的有效 MySQL 结果资源
```

我在用户名字段中有一个名为 Admin 的用户，但它仍然不起作用。profile.php?user=Admin...

如果我使用 ID，这可行：

```
$befal = mysql_query("SELECT * FROM users WHERE user_id = $_GET[id]");
$rad = mysql_fetch_assoc($befal); 
```

可能是什么问题？

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-21T10:20:27.297

呃……这是被黑的秘诀。我想向您介绍[SQL 注入](http://en.wikipedia.org/wiki/SQL_injection)，它的特点是这部[非常有趣但令人心酸的卡通片](https://stackoverflow.com/questions/84556/whats-your-favorite-programmer-cartoon/84629#84629)。

试试这个。

```
$username = mysql_escape_string($_GET['username']);
$query = mysql_query("SELECT * FROM users WHERE username = '$username'"); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-21T10:13:17.000

试试这样：

```
$befal = mysql_query("SELECT * FROM users WHERE username = '$_GET[username]'"); 
```

您必须将字符串参数封装在撇号中。

**[更新]**

就像[cletus](https://stackoverflow.com/questions/572731/php-problem-in-a-sql-statement-when-using-a-string-parameter/572744#572744)和[Olaf](https://stackoverflow.com/questions/572731/php-problem-in-a-sql-statement-when-using-a-string-parameter/572742#572742)指出的那样，使用上面的 sql 语句**很容易发生 SQL 注入**。查看他们发布的答案以了解我的意思。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-21T10:19:03.163

既然你已经得到了答案，请尝试输入

```
Something' OR '1' = '1 
```

作为用户名 - 您已经成功地生成了一个不错的[SQL 可注入](http://en.wikipedia.org/wiki/Sql_injection)应用程序。

# c++ - C++ 中的 Infile 句柄（Perl 中的 __DATA__ ）

> ID：572734
> 
> 赞同：2
> 
> 时间：2009-02-21T10:14:43.660
> 
> 标签：c++, filehandle

C++ 是否可以通过文件句柄访问 infile 数据？例如，Perl 中的典型习语是：

```
while (<DATA>) {
  chomp;
  # do sth with $_
}

__DATA__
Foo
Bar 
```

在 C++ 中这样做的方法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-21T10:38:56.767

你的意思是在程序中包含文件？

不，C++ 做不到。与 Perl 不同。有许多工具可以将二进制或文本文件打包为 C/C++ 源代码。它们最终成为一个全局数组。

我一直觉得有用的一件事是能够将随机内存作为文件句柄打开，这与您似乎要问的类似。在标准 C++ 中，这可以通过 istringstream 类来完成，它具有与 ifstream 相同的接口。

但是您的问题的上下文可能意味着有更好的方法来完成您在 C/C++ 中的想法。需要更多信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-21T10:46:15.673

C++ 没有惯用的方法来做到这一点。请改用单独的数据文件。

根据您的平台，您可能希望使用资源来实现类似的结果，但这超出了 C++ 的范围。特别是，要将资源存储在二进制文件中，您需要使用外部工具并在代码中读取这些资源，您需要调用平台 API。例如在 Windows 下，有[`LoadResource`](http://msdn.microsoft.com/en-us/library/ms648046(VS.85).aspx)函数（和相关的）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-21T11:20:40.707

我不会说它是惯用的，因为我从未在任何 C++ 代码中看到它，但您可以使用 C++ 字符串流和 C 预处理器字符串粘贴将多行字符串视为输入流：

```
#include <sstream>
#include <iostream>

using namespace std;

const string data = 
    "once upon a time, " \
    "a young lass called Goldilocks\n" \
    "went for a walk in the forest.\n";

int main ()
{
    istringstream in (data);

    for (string line; getline(in, line); ) 
        cout << line << endl;

    return 0;
} 
```

# ruby - 将空格放回具有不可靠空格信息的文本字符串中

> ID：572737
> 
> 赞同：1
> 
> 时间：2009-02-21T10:15:39.537
> 
> 标签：ruby, string, text, dictionary

我需要从 pdf 中解析一些文本，但 pdf 格式会导致间距极其不可靠。结果是我必须忽略空格并拥有连续的非空格字符流。

关于如何解析字符串并通过猜测将空格放回字符串的任何建议？

我正在使用红宝石。或者我应该说我在沉思红宝石？

编辑：我已经使用 pdf-reader 提取了文本。有些 pdf 文件的格式很好，有些则没有。文本与定位混合的示例：

`.7aspe-5.5cts-715.1o0.6f-708.5f-0.4aces-721.4that-716.3are-720.0i-1.8mportant-716.3in-713.9soc-5.5i-1.8alcommunica6.6tion6.3.-711.6Althoug6.3h-708.1m-1.9od6.3els-709.3o6.4f-702.8f5.4ace-707.9proc6.6essing-708.2haveproposed-611.2ways-615.5to-614.7deal-613.2with-613.0these-613.9diff10.4erent-613.7tasks,-611.9it-617.1remainsunclear-448.0how-450.7these-443.2mechanisms-451.7might-446.7be-447.7implemented-447.2in-450.3visualOne-418.9model-418.8of-417.3human-416.4face-421.9processing-417.5proposes-422.7that-419.8informa-tion-584.5is-578.0processed-586.1in-583.1specialised-584.7modules-577.0(Breen-584.4et-582.9al.,-582.32002;Bruce-382.1and-384.0Y92.0oung,-380.21986;-379.2Haxby-379.9et-380.5al.,-`

如果我只打印字符串数据（我在每行的末尾添加了返回，以防止它在这里弄乱布局：

'Distinctrepresentationsforfacialidentityandchangeableaspectsoffacesinthehumantemporal lobeTimothyJ.Andrews * andMichaelP.EwbankDepartmentofPsychology，WolfsonResearchInstitute，UniversityofDurham，UKReceived23December2003; revised26March2004; accepted27July2004Availab leonline14October2004Theneuralsystemunderlyingfaceperceptionmustrepresenttheunchanging featuresofafacethatspecifyidentity，aswellasthechangeableaspectsofafacethatfacilitates ocialcommunication.However，thewayinformationaboutfacesisrepresentedinthebrainremainsc ontroversial.Inthisstudy，weusedfMRadaptation（thereductioninfMRIactivitythatfollowsthe repeatedpresentationofidenticalimages）toaskhowdifferentface-andobject-selectiveregionsofvisualcortexcontributetospecificaspectsoffaceperception'

数据由回调吐出，所以如果我在返回每个字符串时打印它，它看起来像这样：

'这

-571.3

神经

-573.7

系统

-577.4

底层

13.9

ing

-577.2

脸

-573.0

聚氯乙烯

13.7

选项

-574.9

必须

-572.1

代表

20.8

发送

-577.0

这

不变

14.4

G

-538.5

特色

16.5

es

-529.5

的

-536.6

一种

-531.4

脸

'

经过检查，看起来真实空间是大的负数 < -300，而虚假空间是小得多的正数。多谢你们。刚到我要问这个问题的地步，就帮助我回答了这个问题！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-21T10:25:51.963

嗯...我不得不说猜测从来都不是一个好主意。查看问题的根本原因并解决问题就是答案，其他任何事情都是杂乱无章的。

如果间距从PDF不可靠，它怎么不可靠？PDF 查看器需要能够可靠地分隔文本，以便数据存在于某处，您只需要找到它。

编辑以下评论：使用字典解析文件的想法（除了随机插入空格并希望获得最好的结果之外，您实际上是唯一的选择）并在确定的单词边界处插入空格（处理标点符号时的一个真正问题，复数不'不改变基本词，即复数等），我相信，比一开始就正确解析 PDF 是一个更大的编程挑战。毕竟，PDF 的定义很明确，而英语则有些模糊。

为什么不看一下现有解决方案（如 linux 中的 ps2ascii）的路线，从您的 Ruby 中调用该函数并获取结果。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-21T10:37:24.540

PDF doesn't only store spaces as space characters, but also uses layout commands for spacing (so it doesn't print a space, but moves the "pen" to the right). Perhaps you should have a look at the [PDF reference](http://www.adobe.com/devnet/pdf/pdf_reference.html) (the big PDF on the bottom of the site), Chapter 9 "Text" should be what you're looking for.

EDIT: After reading your comment to Lazarus' answer, this doesn't seem to be what you're looking for. I think you should try to get a word list from somewhere and try to split your text using it. A good strategy would be to do that using recursion, because for example:

"meandyou"

第一个词可以是“me”或“mean”，但如果你尝试“mean”，“dyou”没有意义，所以它会是“me”，下一个词可能是“a”或“an”或“and”，只有“and”才有意义。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-21T18:06:49.313

如果是我，我会返回源 PDF 并尝试提取文本的不同方法，例如 iText（用于 Java）或某种 PDF 到 HTML 到文本转换软件的方法。

# svn - svn import 添加并提交一个目录，但是目录不能被浏览

> ID：572738
> 
> 赞同：0
> 
> 时间：2009-02-21T10:16:10.083
> 
> 标签：svn

我有一个项目 repos 已经在 LAN 上的机器上的 svn 控制下。当我浏览包含 repos 的机器时...我可以看到 repos 路径中物理存在的文件夹。

然后有时我将一个目录导入到 repos 路径..它添加并将其提交到 repos...但是在浏览时我无法在 repos 路径中看到该目录..

使用 svn list 显示导入的目录存在，我也可以很好地签出它...但是为什么我不能使用 repos 机器或 sshing repos 机器浏览它？它是隐藏的还是什么？

如果我没记错的话，一旦我不得不向存储库添加一个新目录...我用 -N 标志检查了主干，然后使用 svn add 添加了目录并将其提交回来...这样目录确实显示了浏览时...为什么要隐藏导入的目录？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-21T10:19:43.163

你为什么要直接浏览你的回购？据我所知，如果您不小心，您可能会**损坏它。**

检查代码并在本地使用它

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-23T21:00:10.050

你想用什么样的方法来浏览它，你用什么 URL 来检查你的项目？

仅当您使用 Apache 通过 http(s) 托管存储库时，使用 Web 浏览器进行浏览才有意义。

# sql - SQL：在大子表中搜索特定项目

> ID：572745
> 
> 赞同：0
> 
> 时间：2009-02-21T10:21:40.617
> 
> 标签：sql

考虑以下架构：

```
顾客：
上校 | 类型 |
-------------------|
编号 | 整数 |
姓名 | VARCHAR |

订单：
上校 | 类型 |
----------------------|
编号 | 整数 |
客户 ID | 整数 |
日期 | 日期 |

项目
上校 | 类型 |
----------------------|
编号 | 整数 |
order_id | 整数 |
姓名 | VARCHAR |
数量 | 整数 |

```

下面是模式的简要说明： 客户可以有很多订单，而一个订单可以有很多商品 注意：您可能会争辩说商品应该引用带有 product_id 的产品表，但让它像现在一样简单。

从我的数据库中，我想问以下问题：

对于给定的客户，列出所有以 La 开头的项目。

我的查询版本是这样的：

SELECT * FROM items WHERE name LIKE 'La%'

这将为所有客户返回所有以 La 开头的项目。我想要的是我得到一个特定客户的所有项目，比如 id 1。我该如何编写这样的查询？我的第二个版本是这样的：

SELECT * FROM items WHERE name LIKE 'La%' AND order_id in (SELECT id FROM orders WHERE customer_id=1);

但是他们是否有任何其他有效/优雅或更好的方式来做同样的事情？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-21T10:32:35.333

执行此操作的优雅方法称为连接。

```
SELECT
  c.id            customer_id,
  c.name          customer_name,
  i.id            item_id,
  i.name          item_name,
  COUNT(i.id)     order_count,
  SUM(i.quantity) items_ordered
FROM
  customers c
  INNER JOIN orders o ON c.id = o.customer_id
  INNER JOIN items  i ON i.id = o.order_id
WHERE
  i.name LIKE 'La%'
  AND c.id = 1
GROUP BY
  c.id,
  c.name,
  i.id,
  i.name 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-21T10:34:30.663

> 从客户中选择 i.name c
> join oders o
> on c.id = o.customer_id
> join Items i
> on o.id = i.order_id where c.id = WHATEVER_CUSTOMER_ID_YOU_WANT
> and i.name LIKE 'La%'

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-21T10:33:44.423

Sub-SELECT 是一种方法，另一种方法是加入表并查询。

像这样的东西，我的 SQL 很生锈，但我认为这应该可行。

```
SELECT c.Name, o.id, o.date, i.name, i.quantity FROM Customer AS c
LEFT OUTER JOIN Orders AS o ON c.id = o.customer_id
LEFT OUTER JOIN Items AS i on o.id = i.order_id
WHERE i.name LIKE 'La%' AND c.id = 1 
```

# html - 有问题

> ID：572755
> 
> 赞同：0
> 
> 时间：2009-02-21T10:31:02.217
> 
> 标签：html, html-select

我在我的网页上使用这个菜单

```
<select id="menu">
<option value="1"><h1>one</h1></option>
<option value="2"><h1>two</h1></option>
<option value="3"><h1>three</h1></option>
</select> 
```

我想知道为什么**`<h1>...</h1>`**不工作。

谢谢！！！提前。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-21T10:37:36.100

该[`option`元素](http://www.w3.org/TR/html401/interact/forms.html#edef-OPTION)只允许文本作为内容。这是元素定义：

```
<!ELEMENT OPTION - O (#PCDATA)         -- selectable choice --> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-21T10:39:51.257

我没有尝试过，所以这是猜测，但我怀疑将标题放在下拉菜单中是荒谬的。我会在选项本身上使用 CSS 类来更改选项的格式。

```
<select id="menu">
<option class="mybiggertext">Option 1</option>
etc... 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-21T10:40:06.763

因为您不能-据我所知-在选择选项标签中使用标签。如果要更改字体大小，请改用 CSS：

```
<html>
<head>
<style type="text/css">
select, option {font-size: 200%}
</style>
</head>
<body>
<select id="menu">
<option value="1">one</option>
<option value="2">two</option>
<option value="3">three</option>
</select>
</body>
</html> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-21T10:43:17.630

您不能在**选项**元素内插入 Html 标记。

但是您可以通过这种方式做到这一点（包括所有选项）：

```
<select style="font-weight:bold;font-size:14px;color:red;">
<option>item 1</option>
<option>item 2</option>
<option>item 3</option>
</select> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-21T10:45:16.253

如果您的目标是增加菜单选项中的字体大小，请尝试以下操作：

```
<select id="menu" style="font-size:20">
<option value="1">one</option>
<option value="2">two</option>
<option value="3">three</option>
</select> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-21T10:44:27.503

首先，[HTML 4.01](http://www.w3.org/TR/html4/interact/forms.html)和[XHTML 1.1](http://www.w3.org/TR/xhtml-modularization/abstract_modules.html#s_extformsmodule)的规范将“option”元素的最小内容模型指定为 CDATA——这意味着它只能包含文本（没有子元素）。大多数浏览器都尊重这一点，并且不会费心在“选项”中渲染任何元素。

其次，您似乎在使用“h1”元素来创建视觉区别，而不是将其正确用作标题来创建语义内容层次结构。我建议您使用以下内容：

```
<option value="1" class="big">one</option> 
```

根据需要造型“大”。

# autotools - Libtool 慢，双重构建？

> ID：572760
> 
> 赞同：3
> 
> 时间：2009-02-21T10:33:33.643
> 
> 标签：autotools, libtool

在我的项目中，为了整洁，模块被组织在子目录中。

**我的项目目录层次结构：**

```
$ ls -R
.:         configure.in Makefile.am  Makefile.cvs  src
./src:     log          Makefile.am  main.cpp
./src/log: log.cpp      Makefile.am 
```

**配置.in：**

```
AC_INIT(configure.in)
AM_CONFIG_HEADER(config.h)
AM_INIT_AUTOMAKE(myapp, 0.1)
AC_LANG_CPLUSPLUS
AC_PROG_CXX
AM_PROG_LIBTOOL
AC_OUTPUT(Makefile src/Makefile src/log/Makefile) 
```

**生成文件.am：**

```
AUTOMAKE_OPTIONS = foreign
SUBDIRS = src 
```

**生成文件.cvs：**

```
default:
    aclocal
    libtoolize --force --copy
    autoheader
    automake --add-missing --copy
    autoconf 
```

**src/Makefile.am**

```
bin_PROGRAMS = myapp
myapp_SOURCES = main.cpp
SUBDIRS = log
myapp_LDADD = $(top_builddir)/src/log/liblog.la 
```

**src/log/Makefile.am:**

```
INCLUDES = $(all_includes)
METASOURCES = AUTO
noinst_LTLIBRARIES = liblog.la
liblog_la_SOURCES = log.cpp 
```

**src/main.cpp：**包含`int main(){}`， **src/log/log.cpp**包含`void f(){}`。

调用`make`产生（为简洁而编辑）：

```
libtool --mode=compile g++     -MT log.lo -MD -MP -MF .deps/log.Tpo -c -o log.lo log.cpp
libtool: compile:  g++ -MT log.lo -MD -MP -MF .deps/log.Tpo -c log.cpp  -fPIC -DPIC -o .libs/log.o
libtool: compile:  g++ -MT log.lo -MD -MP -MF .deps/log.Tpo -c log.cpp -o log.o >/dev/null 2>&1
mv -f .deps/log.Tpo .deps/log.Plo
libtool --mode=link g++    -o liblog.la  log.lo  
libtool: link: ar cru .libs/liblog.a .libs/log.o 
libtool: link: ranlib .libs/liblog.a
libtool: link: ( cd ".libs" && rm -f "liblog.la" && ln -s "../liblog.la" "liblog.la" )
g++ -MT main.o -MD -MP -MF .deps/main.Tpo -c -o main.o main.cpp
mv -f .deps/main.Tpo .deps/main.Po
libtool --mode=link g++    -o myapp main.o ../src/log/liblog.la 
libtool: link: g++ -o myapp main.o  ../src/log/.libs/liblog.a 
```

问题出在前三行：**log.cpp 编译了两次！**

问题：**为什么不只编译一次——花费一半的时间？**

**注意：**我不知道我在做什么——autotools 对我来说是黑魔法，但我们必须在我们的位置使用它。这些文档对我来说是不可理解的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-21T10:41:06.433

默认情况下，Libtool 创建两种类型的库：静态库和共享库。（又名 libfoo.a 和 libfoo.so）

静态和分片需要不同的编译标志。动态库——共享对象使用具有以下 gcc 标志的位置无关代码：

```
-fPIC -DPIC 
```

静态的都没有。您可以通过指定强制仅构建一种类型

```
./configure --disable-shared 
```

或者

```
./configure --disable-static 
```

**基本原理**

通常，当为用户提供库时，它提供两种设置 - 静态用于开发，允许创建纯静态构建和动态以供使用该库的大多数程序使用。因此，通常当您在系统中安装库时，您只安装共享对象。（又名 libfoo_XYZ.deb）

当您添加开发版本（又名 libfoo-dev_XYZ.deb）时，您添加标头并静态构建库的版本，允许用户根据需要进行静态构建。

这是在 UNIX 中发布库的常见做法。因此 libtool 会自动为您执行此操作。

# html - 为 input type="file" 按钮设置样式

> ID：572768
> 
> 赞同：942
> 
> 时间：2009-02-21T10:36:49.020
> 
> 标签：html, css

您如何设置输入`type="file"`按钮的样式？

```
<input type="file" />
```

* * *

## 回答 #1

> 赞同：1371
> 
> 时间：2014-09-13T17:24:14.110

### 你不需要 JavaScript ！这是一个跨浏览器的解决方案：

[**看这个例子！**](http://jsfiddle.net/4cwpLvae/)- 它适用于 Chrome/FF/IE - (IE10/9/8/7)

最好的方法是让一个自定义标签元素具有`for`附加到**隐藏**文件输入元素的属性。（标签的`for`属性必须与文件元素的属性相匹配`id`才能使其工作）。

```
<label for="file-upload" class="custom-file-upload">
    Custom Upload
</label>
<input id="file-upload" type="file"/> 
```

作为替代方案，您也可以直接用标签包装文件输入元素：（[**示例）**](http://jsfiddle.net/1pc9pcev/)

```
<label class="custom-file-upload">
    <input type="file"/>
    Custom Upload
</label> 
```

在样式方面，只需使用[属性选择器隐藏](https://developer.mozilla.org/en-US/docs/Web/CSS/Attribute_selectors)¹输入元素。

```
input[type="file"] {
    display: none;
} 
```

然后您需要做的就是设置自定义`label`元素的样式。[**（示例）**](http://jsfiddle.net/4cwpLvae/)。

```
.custom-file-upload {
    border: 1px solid #ccc;
    display: inline-block;
    padding: 6px 12px;
    cursor: pointer;
} 
```

* * *

¹ - 值得注意的是，如果使用 隐藏元素`display: none`，它在 IE8 及以下版本中将不起作用。还要注意 jQuery validate默认情况下[不验证隐藏字段的事实。](https://stackoverflow.com/questions/8466643/jquery-validate-enable-validation-for-hidden-fields)如果其中任何一个对您来说是个问题，这里有两种不同的方法来隐藏在这些情况下工作的输入（ [**1**](http://jsfiddle.net/9Lzjzwr7/)、[**2 ）。**](http://jsfiddle.net/m8x2fobw/)

* * *

## 回答 #2

> 赞同：298
> 
> 时间：2009-04-03T16:11:44.500

样式文件输入是出了名的困难，因为大多数浏览器不会改变 CSS 或 javascript 的外观。

即使输入的大小也不会响应以下内容：

```
<input type="file" style="width:200px"> 
```

相反，您将需要使用 size 属性：

```
<input type="file" size="60" /> 
```

对于任何比这更复杂的样式（例如更改浏览按钮的外观），您将需要查看在本机文件输入顶部覆盖样式按钮和输入框的技巧。[rm 在www.quirksmode.org/dom/inputfile.html](http://www.quirksmode.org/dom/inputfile.html)上已经提到的文章是我见过的最好的文章。

**更新**

虽然很难`<input>`直接为标签设置样式，但在标签的帮助下很容易做到这一点`<label>`。请参阅@JoshCrozier 的以下答案：[https ://stackoverflow.com/a/25825731/10128619](https://stackoverflow.com/a/25825731/10128619)

* * *

## 回答 #3

> 赞同：211
> 
> 时间：2012-03-03T14:42:38.433

请按照以下步骤操作，然后您可以为文件上传表单创建自定义样式：

1.  这是简单的 HTML 表单（请阅读我在下面写的 HTML 注释）

    ```
    <form action="#type your action here" method="POST" enctype="multipart/form-data">
      <div id="yourBtn" style="height: 50px; width: 100px;border: 1px dashed #BBB; cursor:pointer;" onclick="getFile()">Click to upload!</div>
      <!-- this is your file input tag, so i hide it!-->
      <div style='height: 0px;width:0px; overflow:hidden;'><input id="upfile" type="file" value="upload"/></div>
      <!-- here you can have file submit button or you can write a simple script to upload the file automatically-->
      <input type="submit" value='submit' >
    </form> 
    ```

2.  然后使用这个简单的脚本将点击事件传递给文件输入标签。

    ```
    function getFile(){
         document.getElementById("upfile").click();
    } 
    ```

    现在您可以使用任何类型的样式，而不必担心如何更改默认样式。

我很清楚这一点，因为我已经尝试更改默认样式一个半月了。相信我，这很难，因为不同的浏览器有不同的上传输入标签。所以使用这个来构建您的自定义文件上传表单。这是完整的自动上传代码。

```
function getFile() {
  document.getElementById("upfile").click();
}

function sub(obj) {
  var file = obj.value;
  var fileName = file.split("\\");
  document.getElementById("yourBtn").innerHTML = fileName[fileName.length - 1];
  document.myForm.submit();
  event.preventDefault();
}
```

```
#yourBtn {
  position: relative;
  top: 150px;
  font-family: calibri;
  width: 150px;
  padding: 10px;
  -webkit-border-radius: 5px;
  -moz-border-radius: 5px;
  border: 1px dashed #BBB;
  text-align: center;
  background-color: #DDD;
  cursor: pointer;
}
```

```
<form action="#type your action here" method="POST" enctype="multipart/form-data" name="myForm">
  <div id="yourBtn" onclick="getFile()">click to upload a file</div>
  <!-- this is your file input tag, so i hide it!-->
  <!-- i used the onchange event to fire the form submission-->
  <div style='height: 0px;width: 0px; overflow:hidden;'><input id="upfile" type="file" value="upload" onchange="sub(this)" /></div>
  <!-- here you can have file submit button or you can write a simple script to upload the file automatically-->
  <!-- <input type="submit" value='submit' > -->
</form>
```

* * *

## 回答 #4

> 赞同：80
> 
> 时间：2013-05-01T07:37:26.880

所有渲染引擎都会在创建 an 时自动生成一个按钮`<input type="file">`。从历史上看，该按钮完全没有样式。但是，Trident 和 WebKit 通过伪元素添加了钩子。

**三叉戟**

从 IE10 开始，文件输入按钮可以使用`::-ms-browse`伪元素设置样式。基本上，您应用于常规按钮的任何 CSS 规则都可以应用于伪元素。例如：

```
::-ms-browse {
  background: black;
  color: red;
  padding: 1em;
}
```

```
<input type="file">
```

这在 Windows 8 上的 IE10 中显示如下：

![这在 Windows 8 上的 IE10 中显示如下：](https://i.stack.imgur.com/qxfNS.jpg)

**网络套件**

WebKit 为它的文件输入按钮提供了一个带有`::-webkit-file-upload-button`伪元素的钩子。同样，几乎可以应用任何 CSS 规则，因此 Trident 示例也可以在这里使用：

```
::-webkit-file-upload-button {
  background: black;
  color: red;
  padding: 1em;
}
```

```
<input type="file">
```

这在 OS X 上的 Chrome 26 中显示如下：

![这在 OS X 上的 Chrome 26 中显示如下：](https://i.stack.imgur.com/WH3YX.jpg)

* * *

## 回答 #5

> 赞同：77
> 
> 时间：2011-07-05T11:14:33.710

用 css 隐藏它并使用带有 $(selector).click() 的自定义按钮来激活浏览按钮。然后设置一个时间间隔来检查文件输入类型的值。间隔可以为用户显示值，以便用户可以看到上传的内容。提交表单时间隔将清除[编辑]对不起，我一直很忙是想更新这篇文章，这是一个例子

```
<form action="uploadScript.php" method="post" enctype="multipart/form-data">
<div>
    <!-- filename to display to the user -->
    <p id="file-name" class="margin-10 bold-10"></p>

    <!-- Hide this from the users view with css display:none; -->
    <input class="display-none" id="file-type" type="file" size="4" name="file"/>

    <!-- Style this button with type image or css whatever you wish -->
    <input id="browse-click" type="button" class="button" value="Browse for files"/>

    <!-- submit button -->
    <input type="submit" class="button" value="Change"/>
</div> 
```

```
$(window).load(function () {
    var intervalFunc = function () {
        $('#file-name').html($('#file-type').val());
    };
    $('#browse-click').on('click', function () { // use .live() for older versions of jQuery
        $('#file-type').click();
        setInterval(intervalFunc, 1);
        return false;
    });
}); 
```

* * *

## 回答 #6

> 赞同：69
> 
> 时间：2012-08-02T08:13:31.393

```
$('.new_Btn').click(function() {
  $('#html_btn').click();
});
```

```
.new_Btn {
  // your css propterties
}

#html_btn {
  display: none;
}
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<div class="new_Btn">SelectPicture</div><br>
<input id="html_btn" type='file' " /><br>
```

你也可以在没有 jQuery 的情况下使用普通的 JavaScript 来实现你的目标。

现在 newBtn 与 html_btn 链接，您可以根据需要设置新 btn 的样式：D

* * *

## 回答 #7

> 赞同：36
> 
> 时间：2015-08-05T16:49:35.390

如果您使用的是 Bootstrap 3，这对我有用：

见[https://www.abeautifulsite.net/posts/whipping-file-inputs-into-shape-with-bootstrap-3/](https://www.abeautifulsite.net/posts/whipping-file-inputs-into-shape-with-bootstrap-3/)

```
.btn-file {
  position: relative;
  overflow: hidden;
}
.btn-file input[type=file] {
  position: absolute;
  top: 0;
  right: 0;
  min-width: 100%;
  min-height: 100%;
  font-size: 100px;
  text-align: right;
  filter: alpha(opacity=0);
  opacity: 0;
  outline: none;
  background: white;
  cursor: inherit;
  display: block;
}
```

```
<link href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" />

<span class="btn btn-primary btn-file">
    Browse...<input type="file">
</span>
```

这会产生以下文件输入按钮：

[![示例按钮](https://i.stack.imgur.com/pkDUJ.png)](https://i.stack.imgur.com/pkDUJ.png)

说真的，请查看[https://www.abeautifulsite.net/posts/whipping-file-inputs-into-shape-with-bootstrap-3/](https://www.abeautifulsite.net/posts/whipping-file-inputs-into-shape-with-bootstrap-3/)

* * *

## 回答 #8

> 赞同：32
> 
> 时间：2017-05-31T07:01:15.330

### 此处具有本机拖放支持的工作示例：[https ://jsfiddle.net/j40xvkb3/](https://jsfiddle.net/j40xvkb3/)

在为文件输入设置样式时，**您不应破坏输入提供的任何本机交互**。

该`display: none`方法打破了原生拖放支持。

为了不破坏任何东西，您应该使用`opacity: 0`输入方法，并在包装​​器中使用相对/绝对模式定位它。

使用这种技术，您可以轻松地为用户设置点击/拖放区域的样式，并在 javascript 中添加自定义类`dragenter`以更新样式并为用户提供反馈，让他看到他可以拖放文件。

HTML：

```
<label for="test">
  <div>Click or drop something here</div>
  <input type="file" id="test">
</label> 
```

CSS：

```
input[type="file"] {
  position: absolute;
  left: 0;
  opacity: 0;
  top: 0;
  bottom: 0;
  width: 100%;
}

div {
  position: absolute;
  left: 0;
  top: 0;
  bottom: 0;
  width: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  background: #ccc;
  border: 3px dotted #bebebe;
  border-radius: 10px;
}

label {
  display: inline-block;
  position: relative;
  height: 100px;
  width: 400px;
} 
```

这是一个工作示例（带有额外的 JS 来处理`dragover`事件和删除的文件）。

[https://jsfiddle.net/j40xvkb3/](https://jsfiddle.net/j40xvkb3/)

希望这有帮助！

* * *

## 回答 #9

> 赞同：26
> 
> 时间：2016-06-03T13:00:08.623

**只有 CSS**

使用这个非常**简单**和**容易**

```
.choose::-webkit-file-upload-button {
  color: white;
  display: inline-block;
  background: #1CB6E0;
  border: none;
  padding: 7px 15px;
  font-weight: 700;
  border-radius: 3px;
  white-space: nowrap;
  cursor: pointer;
  font-size: 10pt;
}
```

```
<label>Attach your screenshort</label>
<input type="file" multiple class="choose">
```

* * *

## 回答 #10

> 赞同：24
> 
> 时间：2012-08-23T01:33:57.263

```
 <label>
    <input type="file" />
 </label> 
```

您可以将输入 type="file" 包装在输入标签内。随意设置标签的样式，并使用 display: none; 隐藏输入

* * *

## 回答 #11

> 赞同：24
> 
> 时间：2016-12-30T08:07:26.670

我可以使用下面的代码使用**纯 CSS来做到这一点。**我使用了引导程序和字体真棒。

```
<link href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css" rel="stylesheet" />

<label class="btn btn-default btn-sm center-block btn-file">
  <i class="fa fa-upload fa-2x" aria-hidden="true"></i>
  <input type="file" style="display: none;">
</label>
```

* * *

## 回答 #12

> 赞同：16
> 
> 时间：2020-05-08T07:45:51.850

**这种方法为您提供了整个灵活性！ES6/香草JS！**

html:

```
<input type="file" style="display:none;"></input>
<button>Upload file</button> 
```

javascript:

```
document.querySelector('button').addEventListener('click', () => {
  document.querySelector('input[type="file"]').click();
}); 
```

这隐藏了输入文件按钮，但在引擎盖下从另一个普通按钮单击它，您显然可以像任何其他按钮一样设置样式。除了无用的 DOM 节点之外，这是唯一没有缺点的解决方案。多亏了`display:none;`，输入按钮不会在 DOM 中保留任何可见空间。

（我不知道该给谁支持了。但我从 Stackoverflow 的某个地方得到了这个想法。）

* * *

## 回答 #13

> 赞同：14
> 
> 时间：2017-08-23T12:32:08.333

## 将上传文件按钮放在漂亮的按钮或元素上并将其隐藏。

非常简单，适用于任何浏览器

```
<div class="upload-wrap">
    <button type="button" class="nice-button">upload_file</button>
    <input type="file" name="file" class="upload-btn">
</div> 
```

风格

```
.upload-wrap {
    position: relative;
}

.upload-btn {
    position: absolute;
    left: 0;
    opacity: 0;
} 
```

* * *

## 回答 #14

> 赞同：13
> 
> 时间：2011-12-04T00:38:33.110

这对 jquery 来说很简单。给出一个稍微修改一下[Ryan](https://stackoverflow.com/users/782773/ryan)建议的代码示例。

基本的html：

```
<div id="image_icon"></div>
<div id="filename"></div>
<input id="the_real_file_input" name="foobar" type="file"> 
```

准备好后，请务必在输入上设置样式：`opacity: 0` 您无法设置`display: none`，因为它需要可点击。但是，如果您愿意，可以将其放在“新建”按钮下，或者使用 z-index 将其塞入其他东西下。

设置一些 jquery 以在单击图像时单击实际输入。

```
$('#image_icon').click(function() {
    $('#the_real_file_input').click();
}); 
```

现在您的按钮正在工作。更改时只需剪切并粘贴该值。

```
$('input[type=file]').bind('change', function() {
    var str = "";
    str = $(this).val();
    $("#filename").text(str);
}).change(); 
```

呸呸！您可能需要将 val() 解析为更有意义的内容，但您应该准备就绪。

* * *

## 回答 #15

> 赞同：13
> 
> 时间：2015-01-30T20:35:47.677

这是一个解决方案，它并没有真正为`<input type="file" />`元素设置样式，而是`<input type="file" />`在其他元素之上使用一个元素（可以设置样式）。因此，该`<input type="file" />`元素并不真正可见，整体错觉是一个样式精美的文件上传控件。

我最近遇到了这个问题，尽管 Stack Overflow 上有很多答案，但似乎没有一个真正符合要求。最后，我最终定制了这个，以获得一个简单而优雅的解决方案。

我还在 Firefox、IE（11、10 和 9）、Chrome 和 Opera、iPad 和一些安卓设备上测试过这个。

这是 JSFiddle 链接-> [http://jsfiddle.net/umhva747/](http://jsfiddle.net/umhva747/)

```
$('input[type=file]').change(function(e) {
    $in = $(this);
    $in.next().html($in.val());

});

$('.uploadButton').click(function() {
    var fileName = $("#fileUpload").val();
    if (fileName) {
        alert(fileName + " can be uploaded.");
    }
    else {
        alert("Please select a file to upload");
    }
});
```

```
body {
    background-color:Black;
}

div.upload {
    background-color:#fff;
    border: 1px solid #ddd;
    border-radius:5px;
    display:inline-block;
    height: 30px;
    padding:3px 40px 3px 3px;
    position:relative;
    width: auto;
}

div.upload:hover {
    opacity:0.95;
}

div.upload input[type="file"] {
    display: input-block;
    width: 100%;
    height: 30px;
    opacity: 0;
    cursor:pointer;
    position:absolute;
    left:0;
}
.uploadButton {
    background-color: #425F9C;
    border: none;
    border-radius: 3px;
    color: #FFF;
    cursor:pointer;
    display: inline-block;
    height: 30px;
    margin-right:15px;
    width: auto;
    padding:0 20px;
    box-sizing: content-box;
}

.fileName {
    font-family: Arial;
    font-size:14px;
}

.upload + .uploadButton {
    height:38px;
}
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<form action="" method="post" enctype="multipart/form-data">
    <div class="upload">
        <input type="button" class="uploadButton" value="Browse" />
        <input type="file" name="upload" accept="image/*" id="fileUpload" />
        <span class="fileName">Select file..</span>
    </div>
    <input type="button" class="uploadButton" value="Upload File" />
</form>
```

希望这可以帮助！！！

* * *

## 回答 #16

> 赞同：11
> 
> 时间：2021-01-23T23:55:48.077

**这是一个纯 CSS、无 Javascript、无引导、100% 跨浏览器的解决方案**！只需*剪切并粘贴*一组样式，然后测试您的文件上传控件。

此解决方案不会像此处的其他帖子那样尝试隐藏然后重新创建原始 HTML 元素。它`plain CSS`无需任何马戏团技巧或第三方工具即可为所有主要浏览器设置原始文件上传表单控件的样式。您甚至不需要更改 HTML 代码！

这是使用下面的 CSS 在 Firefox、Chrome 和 Edge 中文件上传控件的外观。这是一个非常简单干净的设计。您可以将其更改为您喜欢的任何方式：

[![在此处输入图像描述](https://i.stack.imgur.com/WikJF.png)](https://i.stack.imgur.com/WikJF.png)

Internet Explorer 为您提供了有限的设计控制，但至少您可以使用 CSS 来操作控件以更改一些内容，包括圆角边框和颜色：

[![在此处输入图像描述](https://i.stack.imgur.com/6rMwF.png)](https://i.stack.imgur.com/6rMwF.png)

```
<style>
/* Note: This CSS will style all instances of 
   <input type=file /> controls in your website. */
input[type="file"],
input[type="file"]:visited,
input[type="file"]:hover,
input[type="file"]:focus,
input[type="file"]:active {
    margin:0;
    padding: 0em 0em;
    padding: 0rem 0rem;
    overflow: hidden; /* long file names overflow so just hide the end */
    background: #ffffff;
    border-radius: .2em;
    border-radius: .2rem;
    outline: none;
    border: 2px solid #bbb;
    cursor: pointer;
    -webkit-appearance: textfield;
    -moz-appearance: textfield;
}

input[type="file"]:hover {
    background: #f9f9ff; /* I am using a light blue to indicate an interaction */
    border: 2px solid #999;
}

input[type="file"]:visited,
input[type="file"]:focus,
input[type="file"]:active {
    background: #fff; /* Default back to white when focused. */
    border: 2px solid #999;
}

/* Note: Firefox flags the file name box as a *readonly* input. So that attribute selector was added below. Note: These selectors blow up in IE so have to be separated from the same styles above. */
input[type="file"]:disabled,
input[type="file"]:read-only {
    margin: 0;
    padding: 0em 0em;
    padding: 0rem 0rem;
    overflow: hidden; /* long file names overflow so just hide the end */
    background: #ffffff;
    border-radius: .2em;
    border-radius: .2rem;
    outline: none;
    border: 2px solid #bbb;
    cursor: pointer;
    -webkit-appearance: textfield;
    -moz-appearance: textfield;
}

input[type="file"]:disabled:hover,
input[type="file"]:read-only:hover {
    background: #f9f9ff; /* I am using a light blue to indicate an interaction */
    border: 2px solid #999;
}

input[type="file"]:disabled:visited,
input[type="file"]:disabled:focus,
input[type="file"]:disabled:active,
input[type="file"]:read-only:visited,
input[type="file"]:read-only:focus,
input[type="file"]:read-only:active {
    background: #fff; /* Default back to white when focused. */
    border: 2px solid #999;
}

/* IE UPLOAD BUTTON STYLE: This attempts to alter the file upload button style in IE.  Keep in mind IE gives you limited design control but at least you can customize its upload button.*/
::-ms-browse { /* IE */
    display: inline-block;
    margin: 0;
    padding: .2em .5em;
    padding: .2rem .5rem;
    text-align: center;
    outline: none;
    border: none;
    background: #fff;
    white-space: nowrap;
    cursor: pointer;
}
/* FIREFOX UPLOAD BUTTON STYLE */
::file-selector-button {/* firefox */
    display: inline-block;
    margin: 0rem 1rem 0rem 0rem;
    padding: .18em .5em;
    padding: .18rem .5rem;
    -webkit-appearance: button;
    text-align: center;
    border-radius: .1rem 0rem 0rem .1rem;
    outline: none;
    border: none;
    border-right: 2px solid #bbb;
    background: #eee;
    white-space: nowrap;
    cursor: pointer;
}
/* CHROME AND EDGE UPLOAD BUTTON STYLE */
::-webkit-file-upload-button { /* chrome and edge */
    display: inline-block;
    margin: 0rem 1rem 0rem 0rem;
    padding: .19em .5em;
    padding: .19rem .5rem;
    -webkit-appearance: button;
    text-align: center;
    border-radius: .1rem 0rem 0rem .1rem;
    outline: none;
    border: none;
    border-right: 2px solid #bbb;
    background: #eee;
    white-space: nowrap;
    cursor: pointer;
}
</style> 
```

我的解决方案的优点是：

1.  您坚持使用简单的 CSS 来设置原始 HTML 输入控件的样式
2.  您可以在文件输入文本框中看到一个或多个文件名
3.  屏幕阅读器和支持 ARIA 的设备可以与您的文件上传控件正常交互
4.  您可以`tabindex`在 HTML 元素上进行设置，使其成为 Tab 键顺序的一部分
5.  因为您使用的是纯 HTML 和 CSS，所以您的**文件输入按钮在新旧浏览器中都能完美运行**
6.  零 JavaScript 要求！
7.  即使在最古老的浏览器中也能快速运行和加载
8.  因为您没有使用“display：none”来隐藏控件，所以它的文件块流数据永远不会被禁止在任何已知的旧或新浏览器版本中到达服务器

您不需要*愚蠢*的 JavaScript 技巧、Bootstrap 或尝试隐藏/重新创建文件输入控件。这只会破坏在线每个人的可用性。对原始 HTML 控件进行样式设置意味着您的文件上传控件保证在 25 年的新旧 Web 浏览器中都能正常工作。

这就是为什么您不能相信这里所有这些*脚本化的黑客攻击*，它们会擦除、重写或破坏 HTML，只是为了尝试重新创建一些视觉体验。这表明您不了解 HTML 是如何使用的，也不了解它为什么存在 30 年几乎没有变化。您永远不应该尝试重写 HTML 的原生表单控制功能。为什么？在网站中使用自然 HTML 不仅仅是为了一些强制的视觉体验而操纵标记。在这些被替换的 HTML 元素中有限的视觉设计的权衡是出于某种原因设计的。

我的建议：坚持使用简单的 HTML 和 CSS 解决方案，作为 Web 开发人员，您将遇到零问题。

* * *

## 回答 #17

> 赞同：8
> 
> 时间：2009-02-21T10:41:05.560

我能想到的唯一方法是在渲染后用javascript找到按钮并为其分配样式

你也可以看看[这篇文章](http://www.quirksmode.org/dom/inputfile.html)

* * *

## 回答 #18

> 赞同：8
> 
> 时间：2013-08-13T19:48:58.457

```
<input type="file" name="media" style="display-none" onchange="document.media.submit()"> 
```

我通常会使用简单的javascript来自定义文件输入标签。一个隐藏的输入字段，点击按钮，javascript调用隐藏字段，简单的解决方案没有任何css或一堆jquery。

```
<button id="file" onclick="$('#file').click()">Upload File</button> 
```

* * *

## 回答 #19

> 赞同：8
> 
> 时间：2016-06-24T23:33:40.670

# 可见性：隐藏的技巧

我通常会`visibility:hidden`耍花招

这是我的风格按钮

```
<div id="uploadbutton" class="btn btn-success btn-block">Upload</div> 
```

这是输入类型=文件按钮。注意`visibility:hidden`规则

```
<input type="file" id="upload" style="visibility:hidden;"> 
```

这是将它们粘合在一起的 JavaScript 位。有用

```
<script>
 $('#uploadbutton').click(function(){
    $('input[type=file]').click();
 });
 </script> 
```

* * *

## 回答 #20

> 赞同：8
> 
> 时间：2020-01-07T14:47:39.690

# 具有转换文件名的多文件解决方案

引导**[示例](http://jsfiddle.net/684mnzha/)**

## HTML：

```
<div>
  <label class="btn btn-primary search-file-btn">
    <input name="file1" type="file" style="display:None;"> <span>Choose file</span>
  </label>
  <span>No file selected</span>
</div>

<div>
  <label class="btn btn-primary search-file-btn">
    <input name="file2" type="file" style="display:None;"> <span>Choose file</span>
  </label>
  <span>No file selected</span>
</div> 
```

## 1\. 带有 jQ​​uery 的 JS：

```
$().ready(function($){
    $('.search-file-btn').children("input").bind('change', function() {
    var fileName = '';
    fileName = $(this).val().split("\\").slice(-1)[0];
    $(this).parent().next("span").html(fileName);
  })
}); 
```

## 2\. 没有 jQuery 的 JS

```
Array.prototype.forEach.call(document.getElementsByTagName('input'), function(item) {
  item.addEventListener("change", function() {
    var fileName = '';
    fileName = this.value.split("\\").slice(-1)[0];
    this.parentNode.nextElementSibling.innerHTML = fileName;
  });
}); 
```

* * *

## 回答 #21

> 赞同：6
> 
> 时间：2017-12-05T08:42:38.453

这里我们使用 span 来触发类型 file 的输入，**我们只是自定义了 span**，所以我们可以使用这种方式添加任何样式。

**请注意**，我们使用带有可见性的输入标签：隐藏选项并在跨度中触发它。

```
.attachFileSpan{
color:#2b6dad;
cursor:pointer;
}
.attachFileSpan:hover{
text-decoration: underline;
}
```

```
<h3> Customized input of type file </h3>
<input id="myInput" type="file" style="visibility:hidden"/>

        <span title="attach file" class="attachFileSpan" onclick="document.getElementById('myInput').click()">
        Attach file
        </span>
```

[参考](https://stackoverflow.com/questions/8595389/programmatically-trigger-select-file-dialog-box "堆栈溢出参考")

* * *

## 回答 #22

> 赞同：5
> 
> 时间：2014-10-15T12:15:17.623

这是一个解决方案，它还显示了选择的文件名：http: [//jsfiddle.net/raft9pg0/1/](http://jsfiddle.net/raft9pg0/1/)

HTML：

```
<label for="file-upload" class="custom-file-upload">Chose file</label>
<input id="file-upload" type="file"/>
File: <span id="file-upload-value">-</span> 
```

JS：

```
$(function() {
    $("input:file[id=file-upload]").change(function() {
        $("#file-upload-value").html( $(this).val() );
    });
}); 
```

CSS：

```
input[type="file"] {
    display: none;
}

.custom-file-upload {
      background: #ddd;
      border: 1px solid #aaa;
      border-top: 1px solid #ccc;
      border-left: 1px solid #ccc;
      -moz-border-radius: 3px;
      -webkit-border-radius: 3px;
      border-radius: 3px;
      color: #444;
      display: inline-block;
      font-size: 11px;
      font-weight: bold;
      text-decoration: none;
      text-shadow: 0 1px rgba(255, 255, 255, .75);
      cursor: pointer;
      margin-bottom: 20px;
      line-height: normal;
      padding: 8px 10px; } 
```

* * *

## 回答 #23

> 赞同：5
> 
> 时间：2017-11-13T23:09:13.790

这是上传材料/角度文件的好方法。您可以使用引导按钮执行相同的操作。

请注意，我使用`<a>`的不是`<button>`这个，而是允许点击事件冒泡。

```
<label>
    <input type="file" (change)="setFile($event)" style="display:none" />

    <a mat-raised-button color="primary">
      <mat-icon>file_upload</mat-icon>
      Upload Document
    </a>

  </label> 
```

* * *

## 回答 #24

> 赞同：5
> 
> 时间：2021-12-30T06:10:20.007

# `::file-selector-button`

[https://developer.mozilla.org/en-US/docs/Web/CSS/::file-selector-button](https://developer.mozilla.org/en-US/docs/Web/CSS/::file-selector-button)

这是一个新的选择器，可用于设置文件选择器按钮的样式。它完全支持最新的浏览器版本。

```
input[type=file]::file-selector-button {
  border: 2px solid #6c5ce7;
  padding: .2em .4em;
  border-radius: .2em;
  background-color: #a29bfe;
  transition: 1s;
}

input[type=file]::file-selector-button:hover {
  background-color: #81ecec;
  border: 2px solid #00cec9;
}
```

```
<form>
  <label for="fileUpload">Upload file</label>
  <input type="file" id="fileUpload">
</form>
```

我觉得这个答案是必要的，因为这里的大多数答案都已经过时了。

* * *

## 回答 #25

> 赞同：4
> 
> 时间：2013-12-24T19:32:58.527

**更新**没关系，这在 IE 或它的新兄弟 FF 中不起作用。按预期适用于所有其他类型的元素，但不适用于文件输入。一个更好的方法是创建一个文件输入和一个链接到它的标签。使文件输入显示无和繁荣，它在IE9+无缝工作。

### 警告：下面的一切都是废话！

通过使用针对其容器定位/调整大小的伪元素，我们可以只使用一个输入文件（不需要额外的标记），并像往常一样设置样式。

[演示](http://codepen.io/corysimmons/pen/DtqKp)

```
<input type="file" class="foo">
<style>
    .foo {
        display: block;
        position: relative;
        width: 300px;
        margin: auto;
        cursor: pointer;
        border: 0;
        height: 60px;
        border-radius: 5px;
        outline: 0;
    }
    .foo:hover:after {
        background: #5978f8;
    }
    .foo:after {
        transition: 200ms all ease;
        border-bottom: 3px solid rgba(0,0,0,.2);
        background: #3c5ff4;
        text-shadow: 0 2px 0 rgba(0,0,0,.2);
        color: #fff;
        font-size: 20px;
        text-align: center;
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        display: block;
        content: 'Upload Something';
        line-height: 60px;
        border-radius: 5px;
    }
</style> 
```

尽情享受吧！

**旧更新**

把它变成了一个手写笔混合。对于你们中的一个很酷的 SCSS 猫来说应该很容易转换它。

```
 file-button(button_width = 150px)
      display block
      position relative
      margin auto
      cursor pointer
      border 0
      height 0
      width 0
      outline none
      &:after
        position absolute
        top 0
        text-align center
        display block
        width button_width
        left -(button_width / 2) 
```

用法：

```
<input type="file">

input[type="file"]
    file-button(200px) 
```

* * *

## 回答 #26

> 赞同：4
> 
> 时间：2017-04-25T17:17:51.437

也许很多遮阳篷。但我喜欢这个带有 fa-buttons 的纯 CSS：

```
.divs {
    position: relative;
    display: inline-block;
    background-color: #fcc;
}

.inputs {
    position:absolute;
    left: 0px;
    height: 100%;
    width: 100%;
    opacity: 0;
    background: #00f;
    z-index:999;
}

.icons {
    position:relative;
}
```

```
<div class="divs">
<input type='file' id='image' class="inputs">
<i class="fa fa-image fa-2x icons"></i>
</div>

<div class="divs">
<input type='file' id='book' class="inputs">
<i class="fa fa-book fa-5x icons"></i>
</div>
<br><br><br>
<div class="divs">
<input type='file' id='data' class="inputs">
<i class="fa fa-id-card fa-3x icons"></i>
</div>

<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet"/>
```

小提琴：[https ://jsfiddle.net/zoutepopcorn/v2zkbpay/1/](https://jsfiddle.net/zoutepopcorn/v2zkbpay/1/)

* * *

## 回答 #27

> 赞同：4
> 
> 时间：2017-09-09T06:34:38.760

不要被“伟大的”纯 CSS 解决方案所愚弄，这些解决方案实际上是非常特定于浏览器的，或者将样式按钮覆盖在真实按钮之上，或者迫使您使用 a`<label>`而不是 a`<button>`或任何其他此类黑客. JavaScript 是让它为一般用途工作所必需的。如果您不相信我，请研究 gmail 和 DropZone 是如何做到的。

只需根据需要设置一个普通按钮的样式，然后调用一个简单的 JS 函数来创建一个隐藏的输入元素并将其链接到您的样式按钮。

```
<!DOCTYPE html>
<meta charset="utf-8">

<style>
    button {
        width            : 160px;
        height           : 30px;
        font-size        : 13px;
        border           : none;
        text-align       : center;
        background-color : #444;
        color            : #6f0;
    }
    button:active {
        background-color : #779;
    }
</style>

<button id="upload">Styled upload button!</button>

<script>

function Upload_On_Click(id, handler) {
    var hidden_input = null;
    document.getElementById(id).onclick = function() {hidden_input.click();}
    function setup_hidden_input() {
        hidden_input && hidden_input.parentNode.removeChild(hidden_input);
        hidden_input = document.createElement("input");
        hidden_input.setAttribute("type", "file");
        hidden_input.style.visibility = "hidden";
        document.querySelector("body").appendChild(hidden_input);
        hidden_input.onchange = function() {
            handler(hidden_input.files[0]);
            setup_hidden_input();
        };
    }
    setup_hidden_input();
}

Upload_On_Click("upload", function(file) {
    console.log("GOT FILE: " + file.name);
});

</script> 
```

请注意，每次用户选择文件后，上面的代码如何重新链接它。这很重要，因为只有在用户更改文件名时才会调用“onchange”。但是您可能希望每次用户提供该文件时都获取该文件。

* * *

## 回答 #28

> 赞同：3
> 
> 时间：2013-09-04T07:08:50.863

我找到了一种将文件按钮切换为图片的非常简单的方法。您只需标记一张图片并将其放在文件按钮的顶部。

```
<html>
<div id="File button">
    <div style="position:absolute;">
        <!--This is your labeled image-->
        <label for="fileButton"><img src="ImageURL"></label>
    </div>
    <div>
        <input type="file" id="fileButton"/>
    </div>
</div>
</html> 
```

单击标记的图像时，您选择文件按钮。

* * *

## 回答 #29

> 赞同：3
> 
> 时间：2015-01-08T00:53:54.833

最好的方法是使用伪元素 :after 或 :before 作为 de 输入的元素。然后根据需要设置该伪元素的样式。我建议您作为所有输入文件的一般样式，如下所示：

```
input {
  height: 0px;
  outline: none;
}

input[type="file"]:before {
  content: "Browse";
  background: #fff;
  width: 100%;
  height: 35px;
  display: block;
  text-align: left;
  position: relative;
  margin: 0;
  margin: 0 5px;
  left: -6px;
  border: 1px solid #e0e0e0;
  top: -1px;
  line-height: 35px;
  color: #b6b6b6;
  padding-left: 5px;
  display: block;
} 
```

* * *

## 回答 #30

> 赞同：3
> 
> 时间：2015-07-13T09:06:33.937

本周我还需要自定义按钮并在旁边显示选定的文件名，所以在阅读了上面的一些答案（谢谢顺便说一句）之后，我想出了以下实现：

HTML：

```
<div class="browse">
<label id="uploadBtn" class="custom-file-upload">Choose file
<input type="file" name="fileInput" id="fileInput" accept=".yaml" ngf-select ngf-change="onFileSelect($files)" />
</label>
<span>{{fileName}}</span>
</div> 
```

CSS

```
 input[type='file'] {
    color: #a1bbd5;
    display: none;

}

.custom-file-upload {
    border: 1px solid #a1bbd5;
    display: inline-block;
    padding: 2px 8px;
    cursor: pointer;
}

label{
    color: #a1bbd5;
    border-radius: 3px;
} 
```

Javascript（角度）

```
app.controller('MainCtrl', function($scope) {

        $scope.fileName = 'No file chosen';

          $scope.onFileSelect = function ($files) {
          $scope.selectedFile = $files;
          $scope.fileName = $files[0].name;
    };
}); 
```

基本上我正在使用 ng-file-upload lib，Angular-wise 我将文件名绑定到我的 $scope 并为其赋予“未选择文件”的初始值，我还将 onFileSelect() 函数绑定到我的范围，所以当一个文件被选中时，我使用 ng-upload API 获取文件名并将其分配给 $scope.filename。

* * *

## 回答 #31

> 赞同：3
> 
> 时间：2018-01-12T04:15:05.293

只需在单击样式时`<input>`使用该功能模拟单击。我从 a 创建了自己的按钮，然后在单击我的. 这使您可以根据需要创建按钮，因为它是一个并模拟对文件的单击。然后在你的.`trigger()``<div>``<div>``input``<div>``<div>``<input>``display: none``<input>`

```
// div styled as my load file button
<div id="simClick">Load from backup</div>

<input type="file" id="readFile" />

// Click function for input
$("#readFile").click(function() {
    readFile();
});

// Simulate click on the input when clicking div
$("#simClick").click(function() {
    $("#readFile").trigger("click");
}); 
```

* * *

## 回答 #32

> 赞同：3
> 
> 时间：2019-09-07T09:59:07.240

我发现的最好方法是将其`input type: file`设置为`display: none`. 给它一个`id`. 创建一个按钮或任何其他要打开文件输入的元素。

然后在其上添加一个事件侦听器（按钮），单击该事件侦听器会模拟对原始文件输入的点击。就像单击一个名为 hello 的按钮，但它会打开一个文件窗口。

示例代码

```
//i am using semantic ui

<button class="ui circular icon button purple send-button" id="send-btn">
      <i class="paper plane icon"></i>
    </button>
  <input type="file" id="file" class="input-file" /> 
```

javascript

```
var attachButton=document.querySelector('.attach-button');
    attachButton.addEventListener('click', e=>{
        $('#file').trigger("click")
    }) 
```

* * *

## 回答 #33

> 赞同：2
> 
> 时间：2012-06-20T21:16:48.467

css 在这里可以做很多事情......有点诡计......

```
<div id='wrapper'>
    <input type='file' id='browse'>
</div>
<style>
    #wrapper {
            width: 93px; /*play with this value */
            height: 28px; /*play with this value */
            background: url('browseBtn.png') 0 0 no-repeat;
            border:none;
            overflow:hidden;
    }

    #browse{
            margin-left:-145px; /*play with this value */
            opacity:0; /* set to .5 or something so you can better position it as an overlay then back to zero again after you're done */
            -ms-filter: "progid:DXImageTransform.Microsoft.Alpha(Opacity=0)";
            filter: progid:DXImageTransform.Microsoft.Alpha(Opacity=0);
    }
</style> 
```

*::参考:: [http://site-o-matic.net/?viewpost=19](http://site-o-matic.net/?viewpost=19)*

***-修道院***

* * *

## 回答 #34

> 赞同：2
> 
> 时间：2014-02-25T19:24:01.683

正如[JGuo](https://stackoverflow.com/users/627347/jguo)和[CorySimmons](https://stackoverflow.com/users/175825/corysimmons)提到的，您可以使用样式标签的可点击行为，隐藏不太灵活的文件输入元素。

```
<!DOCTYPE html>
<html>
<head>
<title>Custom file input</title>
<link rel="stylesheet" href="http://netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css">
</head>

<body>

<label for="upload-file" class="btn btn-info"> Choose file... </label>
<input id="upload-file" type="file" style="display: none"
onchange="this.nextElementSibling.textContent = this.previousElementSibling.title = this.files[0].name">
<div></div>

</body>
</html> 
```

* * *

## 回答 #35

> 赞同：1
> 
> 时间：2013-03-02T21:46:12.590

这是一个简单的纯 CSS 解决方案，它创建了一个一致的目标区域，并让您可以根据自己的喜好设置人造元素的样式。

基本思想是这样的：

1.  将两个“假”元素（文本输入/链接）作为真实文件输入的兄弟。绝对定位它们，使它们恰好位于目标区域的顶部。
2.  用 div 包装你的文件输入。将溢出设置为隐藏（因此文件输入不会溢出），并使其与您希望目标区域的大小完全一致。
3.  将文件输入的不透明度设置为 0，使其隐藏但仍可单击。给它一个大的字体大小，以便您可以单击目标区域的所有部分。

这是 jsfiddle：http: [//jsfiddle.net/gwwar/nFLKU/](http://jsfiddle.net/gwwar/nFLKU/)

```
<form>
    <input id="faux" type="text" placeholder="Upload a file from your computer" />
    <a href="#" id="browse">Browse </a>
    <div id="wrapper">
        <input id="input" size="100" type="file" />
    </div>
</form> 
```

* * *

## 回答 #36

> 赞同：1
> 
> 时间：2013-11-25T21:15:41.053

如果您正在寻找一个 javascript 库 - 开箱即用的解决方案，[jquery-fileinput](https://github.com/javanto/jquery-fileinput/)可以正常工作。

* * *

## 回答 #37

> 赞同：1
> 
> 时间：2017-04-04T22:16:56.417

这些答案很好，它们都适用于非常具体的用例。也就是说，他们是固执己见的。

因此，这是一个不假设任何内容的答案，但无论您如何修改它都会起作用。您可以使用 css 更改设计，添加 javascript 以在更改时显示文件名等。它仍然可以正常工作。

**代码：**

这是核心css

```
.file-input{
  pointer-events: none;
  position: relative;
  overflow: hidden;
}
.file-input > * {
  pointer-events: none;
}
.file-input > input[type="file"]{
  position: absolute;
  top: 0;
  right: 0;
  bottom: 0;
  left: 0;
  opacity: 0;
  pointer-events: all;
  cursor: pointer;
  height: 100%;
  width: 100%;
} 
```

和核心html：

```
<div class="file-input">
  <input type="file"/>
</div> 
```

如您所见，我们强制将发生在 .file-input 元素或其任何子元素上的任何指针事件（单击）代理到文件输入。这是因为文件输入是绝对定位的，并且总是会消耗容器的宽度/高度。因此，您可以根据需要进行定制。将包装器样式化为按钮，使用一些 js 在选择时显示文件名等。只要上面的核心代码保持不变，什么都不会破坏。

正如您将在演示中看到的那样，我添加了一个`span`带有文本“选择文件”的类和一个具有额外样式的类来设置`.file-input`div 的样式。对于任何打算创建自定义文件上传元素的人来说，这应该是规范的起点。

**演示：**[JSFIDDLE](https://jsfiddle.net/r3wt/uqrdbnh4/ "JSFIDDLE")

* * *

## 回答 #38

> 赞同：1
> 
> 时间：2021-10-15T08:21:35.683

一个图像上传应用程序的演示，适用于大多数具有漂亮动画功能的后端。

```
// common
function render_element(styles, el) {
    for (const [kk, vv] of Object.entries(styles)) {
        el.style[kk] = vv;
    }
}

function hoverOpacity(el) {
    el.addEventListener('mouseenter', function() {
        el.style.opacity = 0.75
    }.bind(el));
    el.addEventListener('mouseleave', function() {
        el.style.opacity = 1
    }.bind(el));
}

// return void event handler on setTimeout
function buffer(func, time){
    return e=>{
        if(func.still)return;
        // first runtime
        if(!func.pft){
            func(e);
            func.pft = true;
            func.still = false;
            return;
        }
        func.still = true;
        setTimeout(e=>{
            func(e);
            func.still = false;
        }, time);
    }
}
// end of common

const imageUploadButton = document.getElementById('image-upload-button');
imageUploadButton.addEventListener('click', e=>{
    // pulse animation total time
    const d1 = document.getElementById('image-form');
    let time = 600;

    if(d1.rendered){
        d1.ready();
    }else{
        d1.ready = function(){
            d1.style.display = 'flex';
            d1.style.background = '#c5edd0';
            this.d2.style.background = '#b4dbbf';
            this.d3.style.background = '#95dea9';
            this.d4.innerHTML = 'Drag and Drop or Click Above to Upload';
        }
        let dismiss_btn = document.createElement('div');
        render_element({
            position: 'absolute',
            height: '30px',
            width: '30px',
            top: '0', 
            right: '0',
            background: '#fff',
            borderRadius: '30px',
            cursor: 'pointer', 
            margin: '2px',
            zIndex: '10',
        }, dismiss_btn);
        dismiss_btn.addEventListener('mouseenter', function(){this.style.background = '#fc4f30'});
        dismiss_btn.addEventListener('mouseleave', function(){this.style.background = '#fff'});
        dismiss_btn.addEventListener('click', ()=>{d1.style.display = 'none'});
        d1.appendChild(dismiss_btn);
        const d3 = d1.querySelector('#image-input');
        const d5 = d1.querySelector('#image-submit');
        d5.style.visibility = 'hidden';
        d1.parentNode.removeChild(d1);
        document.body.appendChild(d1);
        d1.removeChild(d3);
        let [
            d2, 
            d4, 
        ] = Array.from({length: 3}, ()=>document.createElement('div'));
        let width = window.innerWidth;
        let d_styles = {
            display: 'flex',
            justifyContent: 'center', 
            alignItems: 'center',
        };
        render_element({
            position: 'fixed',
            left: ((width - 430) / 2).toString() + 'px', 
            width: '430px',
            top: '60px',
            height: '280px',
            zIndex: '10', 
        }, d1);
        render_element(d_styles, d1);

        render_element({
            width: '90%',
            height: '90%', 
        }, d2);
        render_element(d_styles, d2);

        render_element({
            width: '80%',
            height: '70%', 
            fontSize: '0',
            cursor: 'pointer',
        }, d3);
        hoverOpacity(d3);
        render_element(d_styles, d3);

        d1.appendChild(d2);
        d2.appendChild(d3);

        let tt = time / 3;
        let ht = tt / 2;
        d1.addEventListener('dragover', buffer(e=>{
            d1.style.background = '#ebf9f0';
            setTimeout(()=>{
                d1.style.background = '#95dea9';
            }, ht);
            setTimeout(()=>{
                d2.style.background = '#b6e3c2';
                setTimeout(()=>{
                    d2.style.background = '#c4eed2';
                }, ht);
            }, tt);
            setTimeout(()=>{
                d3.style.background = '#cae3d1';
                setTimeout(()=>{
                    d3.style.background = '#9ce2b4';
                }, ht);
            }, tt);
        }, time));

        d2.style.flexDirection = 'column';
        render_element({
            fontSize: '16px',
            textAlign: 'center',
            fontFamily: 'Verdana',
        }, d4);
        d2.appendChild(d4);

        d3.addEventListener('change', e=>{
            // backend
            // d5.click();
            // if backend succeed, run frontend
            setTimeout(()=>{
                d1.style.background = '#dbcea2';
                setTimeout(()=>{
                    d2.style.background = '#dbc169';
                    setTimeout(()=>{
                        d3.style.background = '#ebc034';
                    }, ht);
                }, tt);
            }, time);
            // display backend path here
            // now only display filename
            d4.innerHTML = d3.files[0].name;
        });
        d1.d2 = d2;
        d1.d3 = d3;
        d1.d4 = d4;
        d1.ready();
        d1.rendered = true;
    }
});
```

```
#image-upload-button{
    width: 200px;
    height: 40px;
    background: lightgrey;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
}

#image-form{
    display: none;
}

::-webkit-file-upload-button {
    visibility: hidden;
}
```

```
<div id="image-upload-button">Upload Image
    <form id="image-form" action="post">
        <input id="image-input" type="file" />
        <button id="image-submit" type="submit"></button>
    </form>
</div>
```

* * *

## 回答 #39

> 赞同：1
> 
> 时间：2021-11-25T15:53:04.937

你可以为一个`<button>`元素或任何其他元素制作一个很棒的（未完成的）文件上传器：

```
function selectFile() {
    document.getElementById("fileSelector").click();
}
```

```
input#fileSelector[type="file"] {
  display: none;
}

button[onclick*="()"] {
  cursor: pointer;
}
```

```
<input type="file" id="fileSelector">
<button onclick="selectFile()">Select file from computer...</button>
```

* * *

## 回答 #40

> 赞同：0
> 
> 时间：2013-01-09T05:44:47.870

用于自动检测输入[文件]和样式的 teshguru 脚本的 jquery 版本

```
<html>
<head>
<script type="text/javascript" src="http://code.jquery.com/jquery-1.7.2.min.js"></script>
<style>
#yourBtn{
   position: relative;
       top: 150px;
   font-family: calibri;
   width: 150px;
   padding: 10px;
   -webkit-border-radius: 5px;
   -moz-border-radius: 5px;
   border: 1px dashed #BBB; 
   text-align: center;
   background-color: #DDD;
   cursor:pointer;
  }
</style>
<script type="text/javascript">
$(document).ready(function()
{
    $('input[type=file]').each(function()
    {
        $(this).attr('onchange',"sub(this)");
        $('<div id="yourBtn" onclick="getFile()">click to upload a file</div>').insertBefore(this);
        $(this).wrapAll('<div style="height: 0px;width: 0px; overflow:hidden;"></div>');
    });
});
 function getFile(){
   $('input[type=file]').click();
 }
 function sub(obj){
    var file = obj.value;
    var fileName = file.split("\\");
    document.getElementById("yourBtn").innerHTML = fileName[fileName.length-1];
 }
</script>
</head>
<body>
<?php 
    var_dump($_FILES);
?>
<center>
<form action="" method="post" enctype="multipart/form-data" name="myForm">

<input id="upfile" name="file" type="file" value="upload"/>
<input type="submit" value='submit' >
</form>
</center>
</body>
</html> 
```

* * *

## 回答 #41

> 赞同：0
> 
> 时间：2013-02-03T11:12:35.730

我发现的插件解决方案太重了，所以我自己制作了一个名为 Drolex FileStyle 的 jQuery 插件。

此插件允许您根据需要设置文件输入字段的样式。实际上，您将 div 元素的样式设置为看起来像被欺骗的文件输入，并且实际的文件输入会自动覆盖 0% 的不透明度。不需要额外的 HTML。只需在您想要 Drolex FileStyle 的页面中包含 css 和 js 文件即可！根据自己的喜好编辑 css 文件。如果您的页面还没有 jQuery 库，请不要忘记它。如果客户端不运行 JavaScript，那么文件输入不会被 js 或 css 修改。

经测试可在 Chrome 24、Firefox 18、Internet Explorer 9 中运行。预计可在这些版本和其他版本的早期版本中运行。

下载：[http ://web.drolex.net/Drolex-FileStyle.zip](http://web.drolex.net/Drolex-FileStyle.zip)

* * *

## 回答 #42

> 赞同：0
> 
> 时间：2013-04-18T12:44:44.727

一个非常聪明的使用 jQuery 的解决方案，它适用于所有旧浏览器以及新浏览器，我在[这里](https://stackoverflow.com/a/9182787/1685196)找到了。它使用实际的文件浏览按钮处理所有样式和 click() 问题。我做了一个普通的javascript版本：[fiddle](http://jsfiddle.net/tyTLU/10/) 解决方案就像天才一样简单：使文件输入不可见，并使用一段代码将其放在鼠标光标下。

```
<div class="inp_field_12" onmousemove="file_ho(event,this,1)"><span>browse</span>
    <input id="file_1" name="file_1" type="file" value="" onchange="file_ch(1)">
</div>
<div id="result_1" class="result"></div>
<script>
    function file_ho(e, o, a) {
        e = window.event || e;
        var x = 0,
        y = 0;
        if (o.offsetParent) {
            do {
            x += o.offsetLeft;
            y += o.offsetTop;
            } while (o = o.offsetParent);
        }
    var x1 = e.clientX || window.event.clientX;
    var y1 = e.clientY || window.event.clientY;
    var le = 100 - (x1 - x);
    var to = 10 - (y1 - y);
    document.getElementById('file_' + a).style.marginRight = le + 'px';
    document.getElementById('file_' + a).style.marginTop = -to + 'px';
    }
</script>
<style>
    .inp_field_12 {
        position:relative;
        overflow:hidden;
        float: left;
        width: 130px;
        height: 30px;
        background: orange;
    }
    .inp_field_12 span {
        position: absolute;
        width: 130px;
        font-family:'Calibri', 'Trebuchet MS', sans-serif;
        font-size:17px;
        line-height:27px;
        text-align:center;
        color:#555;
    }
    .inp_field_12 input[type='file'] {
        cursor:pointer;
        cursor:hand;
        position: absolute;
        top: 0px;
        right: 0px;
        -moz-opacity:0;
        filter:alpha(opacity=0);
        opacity: 0;
        outline: none;
        outline-style:none;
        outline-width:0;
        ie-dummy: expression(this.hideFocus=true);
    }
    .inp_field_12:hover {
        background-position:-140px -35px;
    }
    .inp_field_12:hover span {
        color:#fff;
    }
</style> 
```

* * *

## 回答 #43

> 赞同：0
> 
> 时间：2014-12-04T02:46:42.083

[这是一种交叉兼容的方法，适用于 Chrome、Firefox、Safari 和 IE。](http://jsfiddle.net/davidcondrey/agea9cay/embedded/result/)

```
$(window).on('resize',function() {
	var eqw = $('input[type=text]').width();
	$('textarea').width(eqw - 32);
	$('.fileoutline').width(eqw);
}).trigger('resize');

$('.file+.file').hide();

$(".file").click(function() {
    var input = $(this).next().find('input');
    input.click();
});
$("input[id='file1']").change(function () {
	$('.file+.file').show();
	var filename = $(this).val();
	$('.filename1').html(filename);
	$('.file').find('span').html('CHANGE FILE');
});
$("input[id='file2']").change(function() {
	var filename = $(this).val();
	$('.filename2').html(filename);
	$('.file').find('span').html('CHANGE FILE');
}); 
```

```
form { width:55%;margin:0 auto;padding-left:3vw;text-align:left; }
fieldset{border:0;margin:0;padding:0;}
textarea{overflow: auto;height:25vh;resize:none;outline:none;width:93%;background:none;padding:8px 15px;display:block;text-align:left;border:1px solid #000;margin:0;color:#000;font:700 0.85em/2.2 'Futura Book',Arial,sans-serif;}
input:focus{outline:none;}
input[type=text]{font-weight:700;font-size:0.85em;line-height:2.2;background:none;text-align:left;letter-spacing:0.02em;height:33px;display:block;width:100%;border:none;border-bottom:1px solid #000;margin:0 0 28px;color:#000;}
input:focus{outline:0;}
.fileoutline { width:100%;margin:25px auto 0px;left:0;right:0;height:40px;border:1px solid #000;position:relative; }
input[type=file] { -webkit-appearance: none;-moz-appearance:none;appearance: none;opacity:0;position:relative;width:100%;height:35px;font-weight:700;font-size:0.5em;line-height:28px;letter-spacing:0.2em;position: absolute;left: 0;top: 0;height: 100%;z-index:10; }
.file,.filename1,.filename2,#submit { font-size:10px;letter-spacing:0.02em;text-transform:uppercase;color:#ffffff;text-align:center;width:35%;}
.file,.filename1,.filename2 { font-weight:200;line-height:28px;}
.filename1,.filename2 { width:375px;overflow:hidden;top:0;text-align:right;position:absolute;display:block;height:26px;color:#000;}
.file { position:absolute;width:100px;top:6px;left:10px;background:#000;border-radius:14px; }
::-webkit-file-upload-button,::-ms-browse { width: 100%;height:25px;opacity: 0;-webkit-appearance: none;appearance: none; }
#submit{border:none;height:32px;background: #000;box-shadow:0 0 0 0.5px #fff,0 0 0 5px #000;margin:35px 0;float:right;display:block;}
```

```
<form action="" method="post" enctype="multipart/form-data">
    <input type="text" name="email" id="email" placeholder="Email address" />
    <input type="text"  type="text" name="name" id="title" placeholder="Name" />
    <textarea rows="7" cols="40" name="description" id="description" placeholder="Description"></textarea>
    <div class="fileoutline"><div class="file"><span>CHOOSE FILE</span><input type="file" name="file[]" id="file1"><div class="filename1">NO CHOSEN FILE</div></div></div>
    <div class="fileoutline"><div class="file"><span>CHOOSE FILE</span><input type="file" name="file[]" id="file2"><div class="filename2">NO CHOSEN FILE</div></div></div>
    <input type="submit" name="submit" value="Submit" id="submit">
</form>
```

* * *

## 回答 #44

> 赞同：0
> 
> 时间：2015-10-05T16:20:38.347

如果有人仍然关心如何在没有 JavaScript 的情况下做到这一点，让我完成 Josh 的回答：

**如何显示文件名的文本：**

最简单的方法是将两个元素设置为一个位置：相对，给标签一个更高的 z-index 并给输入文件负边距，直到标签文本位于您想要的位置。不要在输入上使用 display:none ！

[示例](https://jsfiddle.net/4cwpLvae/278/)：

```
input[type="file"] {
  position:relative;
  z-index:1;
  margin-left:-90px;
}

.custom-file-upload {
  border: 1px solid #ccc;
  display: inline-block;
  padding: 6px 12px;
  cursor: pointer;
  position:relative;
  z-index:2;
  background:white;

} 
```

* * *

## 回答 #45

> 赞同：0
> 
> 时间：2016-05-12T09:40:51.430

我发现这种方法最简单、最轻便。

这是工作示例：[http ://codepen.io/c3zar22/pen/QNoYXN](http://codepen.io/c3zar22/pen/QNoYXN)

以下是解释：

*   这将是标记：

    ```
    <label for="attach-project-file">
        <span id="remove-project-file" class="close">x</span>
        <div class="filename" id="attached-project-file">Click to select a file</div>
    </label>
    <input id="attach-project-file" type="file"> 
    ```

*   像这样隐藏输入：

    ```
    #attach-project-file {
        width: 0.1px;
        height: 0.1px;
        opacity: 0;
        overflow: hidden;
        position: absolute;
        z-index: -1;
    } 
    ```

*   改为设置相应标签的样式

    ```
    [for="attach-project-file"] {
        /* your styles here */
    } 
    ```

*   样式“删除文件”按钮

    ```
    .close {
        font-size: 16px;
        padding: 10px;
        position: absolute;
        top: 0;
        right: 0;
        cursor: pointer;
        font-style: normal;
    } 
    ```

*   `.filename`元素将用于显示选定的文件

*   下面是使其工作所需的注释 JS 代码（使用 jQuery）：

    ```
    var $attach = $('#attach-project-file'),
        $remove = $('#remove-project-file'),
        $name = $('#attached-project-file');

    // initially hide the remove button
    $remove.hide();

    // do this when file input has changed
    // i.e.: a file has been selected
    $attach.on('change', function() {
        var val = $(this).val();
        if (val !== '') {
            // if value different than empty

            // show the file name as text
            // hide/text/fadeIn creates a nice effect when changing the text
            $name
                .hide()
                .text(val)
                .fadeIn();

            // show the remove button
            $remove.fadeIn();
        } else {
            // if value empty, means the file has been removed

            // show the default text
            $name
                .hide()
                .text('Click to select a file')
                .fadeIn();

            // hide remove button
            $remove.fadeOut();
        }
    });

    // remove selected file when clicking the remove button
    // prevent click bubbling to the parent label and triggering file selection
    $remove.on('click', function(e) {
        e.preventDefault();
        e.stopPropagation();

        $attach
            .val('')
            .change(); // trigger change event
    }); 
    ```

* * *

## 回答 #46

> 赞同：0
> 
> 时间：2017-05-29T18:13:34.817

一种快速而粗略的方法是将标签设置为按钮并将位置设置为绝对，以便它浮动在原始按钮上，您仍然可以看到文件名。不过，我正在考虑一个移动解决方案。

# python - CPython 内部结构

> ID：572780
> 
> 赞同：3
> 
> 时间：2009-02-21T10:41:40.770
> 
> 标签：python, google-app-engine, data-structures, internals, cpython

GAE 有各种限制，其中之一是最大可分配内存块的大小为 1Mb（现在增加了 10 倍，但这并没有改变问题）。限制意味着不能在 list() 中放置超过一定数量的项目，因为 CPython 会尝试为元素指针分配连续的内存块。拥有巨大的 list()s 可能被认为是不好的编程习惯，但即使程序本身没有创建巨大的结构，CPython 也会在幕后维护一些。

似乎 CPython 正在维护单个全局对象列表或其他东西。即具有许多小对象的应用程序倾向于分配越来越大的单个内存块。

第一个想法是 gc，禁用它会稍微改变应用程序的行为，但仍然保留了一些结构。

遇到此问题的最简单的简短应用程序是：

```
a = b = []
number_of_lists = 8000000
for i in xrange(number_of_lists):
    b.append([])
    b = b[0] 
```

谁能告诉我如何防止 CPython 在应用程序中有许多对象时分配巨大的内部结构？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-21T13:43:26.293

在 32 位系统上，您创建的 8000000 个列表中的每一个都将为列表对象本身分配 20 个字节，再加上 16 个字节用于列表元素的向量。因此，您尝试分配至少 (20+16) * 8000000 = 20168000000 字节，大约 20 GB。这是最好的情况，如果系统 malloc 只分配与请求一样多的内存。

我计算了列表对象的大小如下：

*   2`PyListObject`结构本身的指针（见[listobject.h](http://svn.python.org/view/python/branches/release26-maint/Include/listobject.h?view=markup)）
*   1 个指针和一个`Py_ssize_t`用于`PyObject_HEAD`列表对象的一部分（参见[object.h](http://svn.python.org/view/python/branches/release26-maint/Include/object.h?view=markup)）
*   一个`Py_ssize_t`用于`PyObject_VAR_HEAD`（也在 object.h 中）

列表元素的向量略微过度分配，以避免在每次追加时调整它的大小 - 请参阅[listobject.c](http://svn.python.org/view/python/branches/release26-maint/Objects/listobject.c?view=markup)中的 list_resize 。大小为 0、4、8、16、25、35、46、58、72、88，......因此，您的单元素列表将为 4 个元素分配空间。

你的数据结构是一个有点病态的例子，付出了可变大小的列表对象的代价而不使用它——你所有的列表只有一个元素。您可以通过使用元组而不是列表来避免 12 字节的过度分配，但为了进一步减少内存消耗，您将不得不使用使用更少对象的不同数据结构。很难更具体，因为我不知道您要完成什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-21T10:47:02.053

我对你在问什么感到有点困惑。在该代码示例中，不应该对任何内容进行垃圾收集，因为您实际上从未杀死任何引用。您在 a 中保存对顶级列表的引用，并且在其中添加嵌套列表（在每次迭代时保存在 b 中）。如果您删除“a =”，*那么*您将获得未引用的对象。

编辑：作为对第一部分的回应，是的，Python 拥有一个对象列表，因此它可以知道要剔除什么。这是整个问题吗？如果没有，请评论/编辑您的问题，我会尽力帮助填补空白。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-21T11:20:33.237

你想用

```
a = b = [] 
```

和

```
b = b[0] 
```

陈述？在 Python 中看到这样的语句当然很奇怪，因为它们不会做你可能天真的期望的事情：在那个例子中，`a`并且`b`是*同一个*列表的两个名称（想想 C 中的指针）。如果你正在做很多这样的操作，很容易混淆垃圾收集器（和你自己！），因为你有很多奇怪的引用漂浮在周围，没有被正确清除。

如果不知道为什么要执行它看起来正在做的事情，就很难诊断出该代码出了什么问题。当然，它暴露了一些解释器的怪异......但我猜你正在以一种奇怪的方式处理你的问题，而更 Pythonic 的方法可能会产生更好的结果。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-21T17:43:43.580

为了让您意识到这一点，Python 有自己的分配器。您可以在配置步骤中使用 --without-pyalloc 禁用它。

但是，最大的 arena 是 256KB，所以这不应该是问题。您还可以使用 --with-pydebug 在启用调试的情况下编译 Python。这将为您提供有关内存使用的更多信息。

我怀疑你的预感，并且确信 oefe 的诊断是正确的。列表使用连续内存，因此如果您的列表对于系统领域来说太大了，那么您就不走运了。如果您真的很喜欢冒险，您可以重新实现 PyList 以使用多个块，但这将是很多工作，因为 Python 的各个位都需要连续的数据。

# html - 如何将 div 缩放到另一个元素内的 100% 高度和宽度

> ID：572783
> 
> 赞同：5
> 
> 时间：2009-02-21T10:44:09.237
> 
> 标签：html, css, internet-explorer

如何将 div 缩放到另一个元素内的 100% 高度和宽度？在我的情况下，一个环绕的 td。由于我是一个插件，我无法控制页面上的其他 HTML。这是我的 HTML：

```
<body style="height:100%;">
  <table width="600px" height="400px" border="1">
    <tr>
      <td style="background-color:silver;">Cell 1</td>

      <td style="background-color:silver;">
    <div style="height:100%; background-color:yellow;">
      <div style="min-height:100%; height:100%; background-color:red;">
        Cell 2
      </div>
    </div>
      </td>
    </tr>
  </table>
</body> 
```

因此，应该最大化 Cell 2 div。有没有跨浏览器的方法来做到这一点？为什么这么复杂？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-21T10:49:57.317

也看看[这个堆栈溢出问题](https://stackoverflow.com/questions/25238/100-min-height-css-layout)......在查看[了该问题中评分最高的答案](https://stackoverflow.com/questions/25238/100-min-height-css-layout/25249#25249)之后，看起来您必须将容器的高度设置为 100% 并将子元素的“最小高度，高度”设置为 100 %。

转到[此网站](http://www.xs4all.nl/~peterned/examples/csslayout1.html)以获取更多信息 - 下面的 HTML 是该网站的精简版

```
<div style="height:100%;">
  <div style="min-height:100%; height:100%; background-color:red;">  
    put your content here 
  </div> 
</div> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-21T15:48:13.887

使用 javascript / jquery 您可以轻松获取父元素的高度并相应地调整 div 的大小。

但是，由于 div 位于表格单元格中，宽度不固定，因为单元格会根据表格中其他单元格的内容进行扩展和收缩。所以确实没有正确的宽度，单元格会根据所有单元格的内容进行自我调整。

顺便说一句，将其设置为 400 像素可以轻松解决您的高度问题，但我猜显示的表格结构只是一个示例（1 行，400 像素高度......）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-21T10:48:24.873

如果 div 将是高度和宽度的 100%，为什么还要在 div 中包含 div？没有其他方法可以将包含的 div 用于您的目的吗？

它可能不起作用，因为高度失败，除非包含元素应用了一定的高度。

# version-control - 如何在 Smalltalk 中从 Monticello 获取最新版本？

> ID：572785
> 
> 赞同：1
> 
> 时间：2009-02-21T10:44:47.673
> 
> 标签：version-control, smalltalk

我正在寻找蒙蒂塞洛版本控制系统的“svn 更新”。我使用浏览器搜索新的 mcz 包，但我希望能够使用脚本来完成。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-21T14:30:13.577

我认为，最简单的方法是使用安装程序。如果它未包含在您的图像中，请先执行以下操作：

HTTPSocket httpFileIn：'installer.pbwiki.com/f/LPF.st'。

这个脚本将安装一个所谓的 Level Playing Field（在这里阅读更多：http: [//installer.pbwiki.com/LevelPlayingField](http://installer.pbwiki.com/LevelPlayingField)）

下一步很简单：

安装程序 monticello http: ' [http://www.squeaksource.com](http://www.squeaksource.com) '; 项目：“海边”；安装：“海边核心”

您可以在此处查看使用示例：http: [//installer.pbwiki.com/Installer](http://installer.pbwiki.com/Installer)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-21T17:17:57.417

步骤：

安装程序 monticello http: ' [http://www.squeaksource.com](http://www.squeaksource.com) '; 项目：“海边”；安装：“海边核心”

可以简写为：

安装程序 ss 项目：“Seaside29”；安装：“海边核心”。

# c# - 评估数学表达式的最佳算法？

> ID：572796
> 
> 赞同：13
> 
> 时间：2009-02-21T10:54:40.613
> 
> 标签：c#, algorithm, delphi, math, parsing

评估数学表达式的最佳算法是什么？我希望能够对此进行一些优化，因为我可能有一个包含各种变量的公式，我可能需要使用不同的变量对其进行数百次评估。所以基本上，如果我最初可以解析公式以便以某种方式对其进行优化，然后我可以根据需要多次将变量传递给这个优化版本，每次它都会为我产生一个结果。

我将在 Delphi 或 C# 中编写此代码。我已经通过使用调车场算法编写了类似的东西，但是每次我需要计算相同的公式时，我都必须经过解析阶段。必须有更好的方法来做到这一点。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-21T11:53:47.757

如果你想用 Delphi 来做，你可以看看这个`JclExprEval`单元是如何工作的，它是[JEDI 代码库](http://sourceforge.net/projects/jcl/)的一部分。我几年前写的（有点过度设计）；它解析函数和变量，并可以将一个快速评估表达式的方法指针返回给您。通过引用传入变量，您可以直接更改它们，并据此计算重新计算的表达式。

无论如何，它的工作原理可能对您有所帮助。表达式的递归下降解析很容易，并且通过构建树，您可以多次评估而无需重新解析。JclExprEval 实际上是为一个简单的堆栈机器生成代码，因此它可以比树解释快一点；堆栈机器在很大程度上将它们的内存操作限制在数组中，并为操作码使用开关，而树解释遵循整个堆中的链接，并且通常对操作码使用虚拟分派（或双重分派），因此它们通常最终会变慢。

采用与解析相同但用 C# 编写的方法，并像 Marc 建议的那样`JclExprEval`构建一个. 是另一种完全有效的方法。`Expression`JIT 编译的表达式应该比解释的表达式程序或树快很多，它们本身比解析要快得多。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-21T10:59:16.627

在带有 .NET 3.5 的 C# 中，您可以使用`Expression`它；您可以构建参数化表达式，然后将其编译为委托。这正是我在语言学的数学方面[所做](http://marcgravell.blogspot.com/2009/01/above-surface.html)的。如果你想要的话，我仍然有我使用的解析代码......

我使用的主要技巧是为了保持委托类型已知，我使用数组作为输入类型 - 将不同的 args 视为 arr[0]、arr [1](http://marcgravell.blogspot.com/2009/01/above-surface.html)、arr[2] 等。这意味着我可以编译为（例如) a `Func<decimal[], decimal>`（接受一个 s 数组`decimal`，返回 a `decimal`）。

一旦你调用`Compile()`了 ，这就像你有代码可以直接执行它一样。

（编辑）

作为`Expression`以这种方式使用的简短示例（使用硬编码函数），请参见下文。我已经编写的解析器*目前*用作*谓词*检查器 ​​- 即检查“？+（2 *？-？）= 22 +？” - 但是更改它以返回结果并不难（并引入更多操作，例如`sin`/ `pow`/etc - 大概是通过将它们直接映射到辅助对象上的公共方法（通过`Expression.Call`））。

```
using System;
using System.Linq.Expressions;
static class Program
{
    static void Main()
    {
        var args = Expression.Parameter(typeof(float[]), "args");
        var x = Expression.ArrayIndex(args, Expression.Constant(0));
        var y = Expression.ArrayIndex(args, Expression.Constant(1));
        var add = Expression.Add(x, y);
        var lambda = Expression.Lambda<Func<float[], float>>(add, args);

        Func<float[], float> func = lambda.Compile();
        Console.WriteLine(func.Call(1, 2));
        Console.WriteLine(func.Call(3, 4));
        Console.WriteLine(func.Call(5, 6));
    }

    static T Call<T>(this Func<T[], T> func, params T[] args)
    { // just allows "params" usage...
        return func(args);
    } 
} 
```

# javascript - 寻找特定的警报框行为

> ID：572800
> 
> 赞同：1
> 
> 时间：2009-02-21T10:59:40.167
> 
> 标签：javascript, jquery, mootools

我对警报框感兴趣，例如，

[http://www.visual-blast.com/javascript/nice-alert-box-with-jquery-impromptu/](http://www.visual-blast.com/javascript/nice-alert-box-with-jquery-impromptu/)

和

[http://woork.blogspot.com/2008/08/design-stunning-alert-box-using.html](http://woork.blogspot.com/2008/08/design-stunning-alert-box-using.html)

但是使用不同的功能，即使存在警告框，用户也应该能够与页面交互，因此它需要是可移动的，并且不会遮挡底层页面，如本例所示，

[http://www.open-lab.com/mb.ideas/index.html](http://www.open-lab.com/mb.ideas/index.html)

警报框应在页面视图上自动生成，并且警报框的标题和消息应随着可扩展库中的每次页面刷新而更改。

外面有这样的吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-21T13:21:04.023

听起来 jQuery UI 对话框小部件可以满足您的需求？

[http://jqueryui.com/demos/dialog/](http://jqueryui.com/demos/dialog/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-25T12:01:27.347

moo.rd 中很少有自定义对话框。其中之一是 Custom.Alert： [http ://www.moord.it/examples/custom_alert](http://www.moord.it/examples/custom_alert)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-21T11:23:38.640

[这是一个](http://www.chrisesler.com/mootools/mootools-dragwindow.html)使用 mootools 的示例。您可以轻松地将页面上的任何元素扩展为可拖动。您可以[将此插件](http://www.coders.me/ejemplos/sexy-alert-box-1-2/)用作警报示例，您只需要删除一些功能并添加使其可拖动。

# asp.net - ASP.NET GridView 中的可拖动列

> ID：572803
> 
> 赞同：2
> 
> 时间：2009-02-21T11:02:34.777
> 
> 标签：asp.net, gridview

是否有任何扩展 ASP.NET GridView 的开源代码，它允许在呈现后更改列顺序，当 Column 被 Drag & Dopped 时引发服务器端事件？我自己应该能够做到这一点。我想知道是否已经有。

另外，我只是好奇你需要多长时间才能实现这个功能。只是想知道我的立场。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-21T11:14:57.820

.NET 3.0+ 中的 GridView 支持此功能，您是否绑定到早期版本？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-21T11:18:40.993

[Component Art 的网格](http://www.componentart.com/webui/grid.aspx)有这个功能，但不是开源的

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-21T11:37:57.140

尝试基于 jquery 的 flexigrid

# c# - 单用户数据库选项

> ID：572804
> 
> 赞同：5
> 
> 时间：2009-02-21T11:03:21.577
> 
> 标签：c#, .net, database, data-structures

我将使用 .NET 框架和 C# 编写一个 Windows 应用程序。应用程序将需要存储将被查询、连接和处理的关系数据。

以前我使用 SQL Server 完成了这项工作，但这对于我现在正在制作的应用程序来说完全是矫枉过正。

在我的应用程序中存储关系数据的最简单、最简单的方法是什么？如果我在 Mac 上，我会使用 SQLite。.NET 等价物是什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-21T11:06:03.147

SQL Server Express 是您想要的。它是免费的 IIRC，可在需要时轻松扩展到成熟的 SQL Server。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-21T11:32:04.567

如果您使用的是 VS 2008 和 .NET 3.5，则可以使用[SQL Server Compact Edition](http://en.wikipedia.org/wiki/SQL_Server_Compact)。它根本不是真正的服务器，它与您的应用程序一起运行并提供基本的 SQL 数据库。数据库本身是单个 .sdf 文件，并与您的应用程序一起部署。~~由于它是框架的一部分，这也意味着没有额外的安装。~~实际上，它实际上并不是框架的一部分，但它很容易重新分发。我正在将 SQL Server CE 用于我目前正在从事的个人项目，到目前为止效果很好。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-21T11:11:19.200

为什么不能使用 SQLite？它适用于窗户。 [SQLite 快速入门](http://www.sqlite.org/quickstart.html)。

另请参阅此处以使其与 .NET 一起使用[http://web.archive.org/web/20100208133236/http://www.mikeduncan.com/sqlite-on-dotnet-in-3-mins/](http://web.archive.org/web/20100208133236/http://www.mikeduncan.com/sqlite-on-dotnet-in-3-mins/)

因此，如果您愿意，您可以使用 SQLite，但也许正如其他人指出的那样，SQL Express 是一个更好的选择，因为如果您将来需要，您可以升级到完整的服务器。虽然从你写的我不知道这是否可能。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-21T11:13:40.677

Sqlite 绝对是应用存储嵌入式数据库的最佳选择。它是免费的，快速可靠。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-21T11:34:23.187

Sql Server 精简版（*.sdf 文件）。对于智能手机来说足够小，但也可以在整个平台上使用。.net 2 版本称为 Sql Server Mobile。

[这](http://www.microsoft.com/sqlserver/2008/en/us/compare-specialized.aspx)是 Compact 和 Express 之间的比较。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-12-31T13:31:16.020

我还没有使用它，但是如果我正在制作一个 Windows 应用程序并且需要与此类似的功能，我会使用已经在每一个 Windows 框上的内置 Windows 数据库。

[http://www.codeplex.com/ManagedEsent](http://www.codeplex.com/ManagedEsent)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-21T13:15:32.367

您可以将 SQL Lite 与 .NET 一起使用。事实上，如果你愿意保留你的代码以便它可以转换为包含大多数 2.0（3.5 即将推出）的单声道，你也可以在 Mac 上运行你的代码，如果你坚持使用 SQL Lite：

[http://mono-project.com/Main_Page](http://mono-project.com/Main_Page)

这真的取决于你需要多少爆炸。在这个线程中多次提到的 SQL Express 是 SQL Server。它对完整的 SQL Server 有一些限制，但它是完整的 SQL Server 引擎，因此它不是精简版，除非您认为将数据库限制为 4 GB 会使它变得轻巧。如果您需要更重的服务，例如一些报告、一些消息队列（服务代理），那么 SQL Express 2008 就是您的选择。

对于 MS 世界中的轻量级，您可以使用 SQL Compact。与 SQL Lite 一样，它的范围有限，但您声明您需要一个轻量级数据库。

如果您真的熟悉 SQL Lite，我认为没有理由不朝这个方向发展。在您的数据库访问之上添加一个工厂，以防万一您改变主意。这样您就不必撕毁整个应用程序来切换数据库。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-21T19:24:46.520

微软 JET 蓝色。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-21T11:13:30.693

如果不是 sqlserver express，您可能需要考虑 Microsoft SQL Server Desktop Engine（sqlserver 的缩小版），它在大多数情况下是免费的。或 MySQL，它也是免费的。我更喜欢mysql。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-21T13:46:11.153

SQLite

火鸟

MySQL 嵌入式

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2009-02-21T11:05:40.790

我会说Microsoft Access。不过你需要执照...

# python - 在 Python 中绘制具有比例 X 轴的图表

> ID：572808
> 
> 赞同：3
> 
> 时间：2009-02-21T11:06:21.630
> 
> 标签：python, charts

如果“日期”轴具有非等距值，是否有一种简单的方法可以在 Python 中绘制日期/值图表？
例如，给定这些：

2009-02-01：10
2009-02-02：13
2009-02-07：25
2009-03-01：80

我希望图表显示第二个和第三个值之间的差距比第一个和第二个值之间的差距更长。
我尝试了一些图表库，但它们似乎都假设 X 轴具有非标量值。
（旁注：图表应该可以导出为 PNG/GIF/其他格式）
感谢您的宝贵时间！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-21T17:04:36.467

你应该可以用[matplotlib](http://matplotlib.sourceforge.net/)条形图做到这一点。您可以使用 xticks 给出 x 轴日期值，并且“左”大小不必是同质的。有关参数的完整列表，请参阅条形图的[文档](http://matplotlib.sourceforge.net/api/pyplot_api.html#matplotlib.pyplot.bar)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-21T11:11:21.260

如果您使用图表获得 PNG 就足够了，您可以使用[Google Chart API](http://code.google.com/intl/de-DE/apis/chart/)，它会为您提供可以保存的 PNG 图像。您还可以使用您的数据使用 Python 解析 URL。

编辑：您的示例的[图像 URL](http://chart.apis.google.com/chart?chs=200x200&cht=s&chd=t:1,2,7|10,13,25&chds=0,10,0,30)（非常基本）。

# sql - 基于网络的查询设计器

> ID：572817
> 
> 赞同：0
> 
> 时间：2009-02-21T11:16:46.990
> 
> 标签：sql, widget, designer

我记得在网上看到了一个（sql？）查询设计器工具，它看起来像您在 MSFT 访问（和其他类似应用程序）中获得的“点击式 GUI”。

它允许用户通过切换复选框、将表格图标拖到视图中并通过画线连接连接来执行简单的连接和 where 子句和 select 子句。

此链接：[Google 图片搜索示例](http://images.google.com/images?hl=en&q=sql+designer&btnG=Search+Images&gbv=2)有示例。

输出是纯文本的 SQL。

如果有人知道可以像这样工作的基于 Web 的 GUI，可以插入 Web CMS，请在此处链接和讨论。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-06T14:12:07.567

也许[WWW SQL Designer](http://code.google.com/p/wwwsqldesigner/)会适合您。见[在线演示](http://ondras.zarovi.cz/sql/demo/?keyword=default)。

# c# - C# 缩放 UserControl 内容以匹配用户 Dpi/字体大小

> ID：572820
> 
> 赞同：10
> 
> 时间：2009-02-21T11:20:30.803
> 
> 标签：c#, .net, user-controls, scale, dpi

如何让我的 OwnerDrawn UserControl 尊重用户 dpi (96/120/xxx) 和/或字体大小（正常、大、特大）？

有些人建议在 Graphics 对象上使用 DpiX 和 DpiY 属性，但这似乎与我的控制无关（即，无论我选择哪种字体大小或 dpi，它们总是设置为 96）。

StackOverflow 上还有另一个类似的问题，它建议使用 AutoScale 属性，但建议的解决方案也没有真正做任何事情。

除了依赖 WPF 之外，在 .NET 中没有办法做到这一点吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-08-19T12:40:45.850

您需要将 UserControl 的 AutoScaleMode 属性设置为 AutoScaleMode.Dpi，而**不是**将 AutoScale 属性设置为 true。如果这样做，它会将 AutoScaleMode 重置为 None。AutoScale 属性已过时，仅用于向后兼容（请参阅此[MSDN 文章中的](http://msdn.microsoft.com/en-us/library/system.windows.forms.autoscalemode.aspx)*重要说明*）。

此外，在 Windows Vista/7 中，除非您明确指定您的应用程序支持 DPI，否则 Windows 将模拟默认 DPI 环境，以便您的应用程序以 96 DPI 呈现，然后将生成的位图缩放到适当的大小。为避免这种情况，您可以更改应用程序清单以通知 Windows 您实际上可以识别 DPI - 请参阅本文中的[使用](http://www.rw-designer.com/DPI-aware)*清单声明 DPI 感知*部分。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-08-04T08:06:23.770

我有同样的问题，我尝试使用 GetDC + GetDeviceCaps + ReleaseDC，除了使用图形工作，至少在 Vista32 上。我还没有使用 DPI 的经验，但是没有人回答这个问题，至少这可能对其他人有帮助。

查看[创建 DPI 感知应用程序](http://msdn.microsoft.com/en-us/library/ms701681(VS.85).aspx)。这提到了为什么无论实际 DPI 设置如何，它都可能总是返回 96。

从上面的链接引用：

> **Win32 应用程序中的 DPI 缩放**
> 
> 在 Win32 应用程序中，执行以下操作：
> 
> *   使用 SetProcessDPIAware 函数取消 dpi 缩放。
> *   在调整绘制的界面元素的大小时，请使用物理测量值，例如厘米。通过使用物理尺寸而不是像素，您可以确保所有类型显示器的尺寸一致。
> *   要获取系统 dpi 设置，请使用带有 LOGPIXELSX 标志的 CDC::GetDeviceCaps 函数。如果不取消 dpi 缩放，此调用将返回默认值 96 dpi。
> *   使用 GetSystemMetrics 函数获取用户界面元素的首选大小，例如窗口边框。禁用 dpi 缩放时，为界面元素返回的测量值将缩放到选定的 dpi 设置。如果 dpi 缩放处于活动状态，该函数将返回基于 96 dpi 的测量值，而不管系统 dpi 设置如何。

来自：[关于 D​​PI 问题](https://stackoverflow.com/questions/572270/about-dpi-issue/572537#572537)

*使用*-statement重写的示例代码（[原始来源](http://www.experts-exchange.com/Programming/Languages/.NET/Visual_CSharp/Q_22528381.html)）：

```
float dpiX = 96, dpiY = 96;
using(Graphics graphics = this.CreateGraphics())
{
    dpiX = graphics.DpiX;
    dpiY = graphics.DpiY;
} 
```

# java - 通过套接字传输空字符的问题

> ID：572831
> 
> 赞同：2
> 
> 时间：2009-02-21T11:29:07.583
> 
> 标签：java, c++, sockets, tcp, character-encoding

我正在用 C++ 编写一个小型 Java 服务器和一个匹配的客户端，它们通过[STOMP 协议](http://stomp.codehaus.org/Protocol)实现一个简单的 IM 服务。

该协议规定每一*帧***`'\0'`**（在服务器和客户端之间传递的消息，如果您愿意的话）必须以空字符结尾，在 Java 和 C++ 中，我在代码中将其称为。

但是，当我通过套接字通过 TCP 传输帧时，任何一方都不会显示空字符。我正在使用 UTF-8 编码，并尝试切换到 ASCII，但没有帮助。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-21T11:36:50.187

无论您是用 ASCII 还是 UTF-8 编码文本，都将“字母”转换为字节流（字节编码）。您需要在消息字符串的末尾添加一个零字节。

[猜测]您可能正在使用带有“WriteLine（String line）”之类的方法的高级库通过网络发送数据。该方法的文档描述了实际发送的字节，通常包括当前编码（ASCII、UTF-8 等）中的消息文本编码，后跟行终止序列，通常是字节 13、10m 或它们的组合（'\n'、'\r\n'）。

使用低级 Write() 方法或 WriteBytes() 方法（取决于您的库）。将文本转换为 ASCII 或 UTF-8，将零字节添加到末尾，然后准确发送您想要发送的内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-21T11:34:29.847

我建议下载[Wireshark](http://www.wireshark.org/)并监控传输，看看问题出在发送端还是接收端。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-21T11:36:01.060

您是在传输缓冲区还是字符串？如果您传输一个字符串，空字符将终止该字符串并且不会被传输。使用缓冲区，您可以指定要传输的字节数并包含空字符。

当然，问题可能出在传输方和接收方。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-21T11:41:17.617

您需要做的第一件事是按照 Spencer 的建议使用 Wireshark（或类似的东西）。

如果这是传输端问题，请通过在代码中添加适当的诊断跟踪来仔细检查您是否正确编码了消息。

如果是接收端问题，有没有办法在接收套接字上设置分隔符？可能有一个套接字选项说明是包含还是排除定界字符。也许它正在正确传输，但接收套接字正在剥离它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-21T11:48:08.723

你在 C++ 中？

一个新手的错误是将 NUL 放在字符串的末尾：`"Foo!\x00"`。

当然，写入字符串的 ting 会将第一个 NUL 视为字符串的结尾，并且不会传输它。您需要将 nul*字符* `'\x00'`显式地白化为一个字符（使用 putChar 或 c++ 执行它），而不是作为字符串的一部分。

# soap - Camel Caps SOAP 方法名称

> ID：572835
> 
> 赞同：4
> 
> 时间：2009-02-21T11:32:16.607
> 
> 标签：soap

我的一位同事正在为 php 应用程序开发 SOAP API，他想知道 CamelCaps 名称是否是 SOAP 方法的某种约定？

我们当前的 API 有 lower_caps_and_underscores，但与其他 SOAP API 的随机子集相比，这似乎有些奇怪，而且我们真的不想用我们错误的约定来惹恼 API 的消费者。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-21T12:08:47.083

在我所见的几乎所有标准 SOAP API 中，都有 CamelCaps。您可能希望查看标准的 SOAP API。即谷歌SOAP api

我认为 Underscore 可能会惹恼用户。您可以遵循其中任何一个，但更重要的是遵循任何单一的标准命名约定。

命名服务时要考虑的其他重要事项是，命名应该清楚地确定服务将在特定上下文中做什么的含义和上下文。

IE

GetCustomerHistoryById = 通过 id 获取单个客户历史记录
GetCustomersHistory = 获取所有客户历史记录

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-21T12:21:24.243

你用什么语言开发（没关系）？

根据我的经验，lower_with_underscores 似乎是 PHP 开发的首选风格，但 CamelCase 似乎更普遍使用。

只是一个想法

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-21T13:08:32.367

对于 SOAP，您可以看到 Pascal 套管或 Camel 套管。SOAP 名称空间是 Pascal Cased（soap:Envelope any）。我想你使用什么取决于你在哪里画线。

一般来说，我对方法和属性使用 Pascal 大小写。这两个要素体现了合同的框架。考虑到这一点，我可能会有对应于方法和属性 Pascal Cased 的 SOAP 元素。

至于参数和返回值，我不得不考虑打破 Pascal 大小写规则并在那里使用驼峰大小写。幸运的是，我现在没有构建 SOAP API，所以我有时间考虑一下。

但是，我不会使用 Pascal 或 Camel 外壳之外的东西，因为它是非标准的。并不是说我认为人们会说“我没有使用您的 API，因为它使用了非标准命名”，而是出于约定。但是，打破常规的人往往会想出下一个新的发展趋势。;-)

# php - 优化 SQL 查询

> ID：572836
> 
> 赞同：4
> 
> 时间：2009-02-21T11:33:09.523
> 
> 标签：php, sql, mysql

我有以下查询：

```
Select diary_id, 
   (select count(*) 
    from `comments` as c 
    where c.d_id = d.diary_id) as diary_comments 
From `diaries` as d 
```

这需要很长时间（在我的情况下接近 0.119415）。如何让它更快？

我只看到一种方法：对我的主查询中的每一行的评论编号进行附加查询。但这就像在循环中进行查询一样。就像是：

```
while ($r = mysql_fetch_array($res))
{
   $comments = mysql_query("select count(*) from `comments` where d_id = ".$r['diary_id']);
} 
```

我认为这是一个糟糕的策略。还有什么建议吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-21T11:49:38.487

```
SELECT d.diary_id, count(c.d_id) as diary_comments 
FROM diaries d
LEFT OUTER JOIN comments c ON (d.diary_id = c.d_id)
GROUP BY d.diary_id 
```

我似乎被否决了，因为您实际上可以从日记表中检索所需的所有数据。我假设这是一个简化的示例，实际上需要 diaries 表中的其他字段，而且此方法会返回没有评论的记录。如果您不需要这两件事中的任何一个，那么我会选择另一个答案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-21T14:34:21.257

看起来您在评论表中拥有所需的所有数据，所以我看不到加入或子查询的原因。

```
SELECT d_id AS diary_id, COUNT(*) AS diary_comments
FROM `comments`
GROUP BY d_id 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-21T21:20:47.597

[对于tomhaigh](https://stackoverflow.com/users/22224/tomhaigh)的解决方案，肯定是加一个，在这种情况下，group by 正是这种情况。

另一个永远值得记住的选择是你有两个选择。首先在每次读取时计算值，其次在每次写入时计算值并存储结果。在第二种情况下，您需要在日记中添加一个名为“comments_count”的附加字段，这需要在插入新评论时增加。显然，这可能不如计算每次读取的计数准确，并且会减慢您的写入速度。但是，如果读取性能受到损害并且写入明显不如读取常见，那么这可能是考虑问题的一种方便方法。

# php - 将文本存储在 BLOB 中？

> ID：572850
> 
> 赞同：6
> 
> 时间：2009-02-21T11:42:31.590
> 
> 标签：php, forum

我正在为我的部落网站制作一个小论坛。我想知道是否应该将线程文本存储在 TEXT 或 BLOB 中？有什么不同？我已经看到 phpBB 做到了。

到底什么是 BLOB？在谷歌上找不到太多关于它的信息。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-21T11:48:11.920

一个 blob 只是一堆字节。任意数量的字节，仅此而已。

如果要将文本存储为 blob，则必须担心编码（将文本转换为字节的过程）。但是，如果您将内容存储为文本，则无论您使用何种数据库传输方式，都将确保存储在数据库中的文本被正确编码和解码，以实现高效存储和易于使用。

如果您打算存储文本，则应存储文本。

phpBB 可以自己实现文本编码和解码，这可能是使用 blob 代替文本的原因之一。这不太可能，但有时文本数据类型具有最大长度，在这种特定情况下，blob 可能是 phpBB 的一种解决方法。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-21T11:48:33.107

重新“什么” - [BLOB](http://en.wikipedia.org/wiki/Binary_large_object)是二进制大对象；与[CLOB](http://en.wikipedia.org/wiki/Character_large_object)比较：字符大对象。但是，不同的数据库称它们为不同的东西 - 例如，在 SQL Server 上，您有`image`/`varbinary(max)`代表 BLOB，而`text`/`varchar(max)`代表 CLOB。

如果系统仅支持 BLOB，则一种选择是对字符串进行编码 - 例如使用 UTF8。这可能就是正在发生的事情。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-21T11:45:30.117

BLOB 用于二进制数据。我不知道 phpBB 3 以二进制形式存储所有内容的原因，但我自己已经注意到了。我的猜测是他们正在压缩/编码他们放入数据库的任何内容。您可以尝试查看 phpBB 源代码，看看是否有任何注释解释它。

# c# - 使用 XSD 架构的 XML 验证

> ID：572853
> 
> 赞同：11
> 
> 时间：2009-02-21T11:46:54.467
> 
> 标签：c#, validation, xsd

以下代码帮助我验证具有 XSD 架构的 XML 文件。

```
XmlReaderSettings settings = new XmlReaderSettings();
settings.Schemas.Add(null, xsdFilePath);
settings.ValidationType = ValidationType.Schema;
settings.ValidationEventHandler += new System.Xml.Schema.ValidationEventHandler(settings_ValidationEventHandler);
XmlDocument document = new XmlDocument();
document.Load(xmlFilePath);
XmlReader rdr = XmlReader.Create(new StringReader(document.InnerXml), settings);

while (rdr.Read())
{

}
isValid = true; 
```

ValidationEventHandler 还告诉我错误是什么，但没有告诉我它们位于“哪里”或“在哪条线上”。有什么方法可以获取无法验证 XML 的行号？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-02-21T12:02:52.230

这不是你所追求的吗？

> 创建一个`XmlReaderSettings`对象并通过该对象启用警告。
> 
> 不幸的是，似乎没有办法将您自己的`XmlReaderSettings`对象传递给`XmlDocument.Validate()`.
> 相反，您可以使用一个验证`XmlReader`和一个`XmlNodeReader`来验证一个现有的`XmlDocument`（使用一个`XmlNodeReader`而`StringReader`不是一个`XmlDocument`）

```
XmlDocument x = new XmlDocument();
x.LoadXml(XmlSource);

XmlReaderSettings settings = new XmlReaderSettings();
settings.CloseInput = true;     
settings.ValidationEventHandler += Handler;

settings.ValidationType = ValidationType.Schema;
settings.Schemas.Add(null, ExtendedTreeViewSchema);
settings.ValidationFlags =
     XmlSchemaValidationFlags.ReportValidationWarnings |
XmlSchemaValidationFlags.ProcessIdentityConstraints |
XmlSchemaValidationFlags.ProcessInlineSchema |
XmlSchemaValidationFlags.ProcessSchemaLocation ;

StringReader r = new StringReader(XmlSource);

using (XmlReader validatingReader = XmlReader.Create(r, settings)) {
        while (validatingReader.Read()) { /* just loop through document */ }
} 
```

和处理程序：

```
private static void Handler(object sender, ValidationEventArgs e)
{
        if (e.Severity == XmlSeverityType.Error || e.Severity == XmlSeverityType.Warning)
          System.Diagnostics.Trace.WriteLine(
            String.Format("Line: {0}, Position: {1} \"{2}\"",
                e.Exception.LineNumber, e.Exception.LinePosition, e.Exception.Message));
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-21T12:06:04.530

ValidationEventArgs.Message 在其文本中包含行/列。

ValidationEventArgs.Exception 具有行和列的字段。

# xml - 如何使用 XSLT 对 XML 的子元素进行排序

> ID：572854
> 
> 赞同：7
> 
> 时间：2009-02-21T11:47:38.320
> 
> 标签：xml, xslt, sorting

我有一个输入 XML 文件，我需要将其 1:1 复制到输出中，除了一个包含需要排序的子项的子元素。

```
<?xml version="1.0"?>
<top>
  <elementA />
  <elementB />
  <contents>
      <contentitem>
          <id>3</id>
          <moretags1 />
          <moretags2 />
      </contentitem>
      <contentitem>
          <id>2</id>
          <moretags1 />
          <moretags2 />
      </contentitem>
      <contentitem>
          <id>1</id>
          <moretags1 />
          <moretags2 />
      </contentitem>
  </contents>
</top> 
```

我想要一个 XSL 转换，它将“contentitem”元素按顺序排列，按它们的“id”元素排序。所有其他标签，包括嵌套标签，都必须逐字复制。我已经尝试过使用 xsl:copy，但是要么我得到了双重内容，要么结果丢失了一些东西。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-21T15:50:28.873

**Mark Gravell 的解决方案几乎是正确的**——有一个小问题，即创建了两个嵌套`<contents>`元素。**请注意所有提供答案的人：请测试您的解决方案**！

**这是一个正确的解决方案。这种转变**：

```
<xsl:stylesheet version="1.0" 
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
<!--                                                --> 
 <xsl:strip-space elements="*"/>
<!--                                                --> 
  <xsl:template match="node()|@*">
    <xsl:copy>
      <xsl:apply-templates select="node()|@*"/>
    </xsl:copy>
  </xsl:template>
<!--                                                --> 
  <xsl:template match="contents">
    <xsl:copy>
      <xsl:apply-templates select="@*"/>
      <xsl:apply-templates select="contentitem">
        <xsl:sort select="id" data-type="number"/>
      </xsl:apply-templates>
    </xsl:copy>
  </xsl:template>
</xsl:stylesheet> 
```

**当应用于最初提供的 XML 文档时**：

```
<top>
    <elementA />
    <elementB />
    <contents>
        <contentitem>
            <id>3</id>
            <moretags1 />
            <moretags2 />
        </contentitem>
        <contentitem>
            <id>2</id>
            <moretags1 />
            <moretags2 />
        </contentitem>
        <contentitem>
            <id>1</id>
            <moretags1 />
            <moretags2 />
        </contentitem>
    </contents>
</top> 
```

**产生想要的正确结果**：

```
<top>
   <elementA/>
   <elementB/>
   <contents>
      <contentitem>
         <id>1</id>
         <moretags1/>
         <moretags2/>
      </contentitem>
      <contentitem>
         <id>2</id>
         <moretags1/>
         <moretags2/>
      </contentitem>
      <contentitem>
         <id>3</id>
         <moretags1/>
         <moretags2/>
      </contentitem>
   </contents>
</top> 
```

**请注意以下几点**：

1.  **使用[身份规则](http://www.dpawson.co.uk/xsl/sect2/identity.html)**复制所有节点而不进行更改。

2.  **`contents`身份模板如何被与元素匹配的**特定模板覆盖****

***   **使用[`<xsl:sort>`](http://www.w3.org/TR/xslt#sorting)指令**来呈现以​​特定顺序应用模板的结果，可能与选择进行处理的节点的文档顺序不同。** 

 *** * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-21T11:56:41.137

怎么样：

```
<?xml version="1.0" encoding="utf-8"?>
<xsl:stylesheet version="1.0"
     xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
  <xsl:output method="xml" indent="yes"/>
  <xsl:template match="@* | node()">
    <xsl:copy>
      <xsl:apply-templates select="@* | node()"/>
    </xsl:copy>
  </xsl:template>
  <xsl:template match="/top/contents">
    <contents>
      <xsl:copy>
        <xsl:apply-templates select="@*"/>
        <xsl:apply-templates select="contentitem">
          <xsl:sort data-type="number" select="id"/>
        </xsl:apply-templates>
      </xsl:copy>
    </contents>
  </xsl:template>
</xsl:stylesheet> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-21T11:53:03.377

使用 xsl:sort 与 xsl:for-each 或 xsl:apply-templates

就像是

```
<xsl:template match='/top/contents'>
  <xsl:apply-templates select='contentitem'>
    <xsl:sort select='id' data-type='number'/>
  </xsl:apply-templates>
</xsl:template> 
```

多个 xsl:sort 元素可用于多个排序键。

# flash - 在规划多层闪存服务器时使用什么样的方法进行通信

> ID：572858
> 
> 赞同：-1
> 
> 时间：2009-02-21T11:49:20.687
> 
> 标签：flash, multithreading, http, multiplayer

我计划构建 Flash 多层服务器（在 C++ 或 Java 中）我不是来自 Flash 领域。但是从我读Flash的内容来看，它确实支持套接字，但这不是我的情况，我需要能够支持浏览器Flash游戏，所以它给我留下了带有http的80端口。但是我怎样才能用http实现良好的通信架构（休息？） flash播放器支持谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-21T12:04:18.480

Flash，即使在浏览器中，也支持 Socket 连接，使用`Socket`类（在 AS3 中）或`XMLSocket`类（AS2/AS3）。

但一切都取决于您计划对应用程序做什么，以及将如何使用网络。对于多人游戏，您可能需要一个推拉网络层（客户端和服务器都可以随时相互发送数据）。A`Socket`可以做到。

使用 HTTP 将需要您的客户端向您的服务器重复请求数据，这对于维护服务器端上下文都是一种负担（您无法判断客户端何时断开连接，并且存在很多与此相关的欺骗性安全问题技术）和表演，特别是如果您的游戏设计为实时播放。

Adobe 开发了一个用于使 AS3/Flex 应用程序与 Java 服务器通信的框架：[BlazeDS](http://opensource.adobe.com/wiki/display/blazeds/BlazeDS/)。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-25T13:05:44.020

如果您使用 Socket 或 XMLSocket 类，请确保您的服务器具有可用的安全策略文件。检查此 SO[问题/答案](https://stackoverflow.com/questions/1204061/flash-client-xmlsocket-not-connecting-to-server/1204326#1204326)以获取更多信息。

# css - 如何在浏览器窗口中间的顶层放置一个元素？

> ID：572865
> 
> 赞同：0
> 
> 时间：2009-02-21T11:57:44.223
> 
> 标签：css

编辑：我使用浏览器的窗口而不是页面或屏幕，这样如果浏览器处于“窗口”模式（而不是全屏），它无论如何都会居中。

* * *

我需要写一个倒计时，它会暂时使页面变得不透明，并在浏览器窗口中间写（可能是全窗口大小）“3”一秒暂停“2”一秒“1”一秒和应用程序应该开始。

问题是如何以那种方式把那个数字放在那里。所以这是一个 CSS 问题而不是 JavaScript，除非有一个 JS 框架可以轻松完成这件事：P

把它放在顶层这应该足够了：

```
position: absolute;
z-index: 1; 
```

假设我在 z >= 1 中没有任何其他元素。如何做其余部分？

我想我必须创建一个具有半透明背景的完整窗口大小的 div（关于如何做到这一点的任何提示？）然后在其中写下巨大的数字。它显然应该适用于任何分辨率。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-21T12:08:27.287

在整个*屏幕上*——我希望这是不可能的。我不希望浏览器中的任何内容能够对其他浏览器选项卡进行如此多的控制，更不用说屏幕的其余部分了。

在浏览器中它当然是可能的......插入超链接对话框可以做到。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-21T12:14:23.857

如果您想要所有自定义 javascript，请查看[http://blog.madskristensen.dk/post/Custom-LightBox-JavaScript.aspx](http://blog.madskristensen.dk/post/Custom-LightBox-JavaScript.aspx)

或者你可以使用[JQuery Thickbox](http://jquery.com/demo/thickbox/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-21T12:18:11.163

我会尝试 mathieu[推荐](https://stackoverflow.com/questions/572865/how-to-put-an-element-on-the-top-layer-in-the-middle-of-the-browsers-window/572883#572883)的灯箱/厚箱方法。如果你想尝试自己做 CSS ......我的头顶：

```
div#countdown{
  background: #000;
  color: #fff;
  font-size: 30px;
  height: 100%;
  line-height: 100%; <!-- not sure if this line would work -->
  opacity: .8;
  width: 100%;
} 
```

# sql - 如何管理 SQL 源代码？

> ID：572866
> 
> 赞同：4
> 
> 时间：2009-02-21T11:59:13.453
> 
> 标签：sql, version-control, stored-procedures, project-management

我负责一个数据库。它有大约 126 个存储过程，大约 20 个视图，一些 UDF。有一些表为我们的各种应用程序保存了固定的配置数据。

我一直在使用一个大文本文件，其中包含 IF EXIST ...DELETE GO CREATE PROCEDURE... 用于配置脚本的所有 sproc、udf、视图和所有插入/更新。

随着时间的推移，添加了新的存储过程，或者更改了现有的存储过程。

我在创建这个 BIG 单个文本文件时犯的最大错误（据我所知）是在文本文件的开头使用新/更改的 sproc 的代码。但是，我忘记排除新/更改的存储过程的先前代码。让我们来说明这一点：

假设我的 BIG 脚本（版本 1）包含创建 sprocs 的脚本

```
sp 1
sp 2
sp 3
view 1
view 2 
```

数据库的版本表使用版本 1 进行更新。

现在 sp 2 有一些变化。所以 BIG 脚本的版本 2 现在是：

```
sp2 --> (newly added)
sp1
sp2
sp3
view 1
view 2 
```

因此，显然运行 BIG 脚本版本 2 不会更新我的 sp 2。

我有点晚意识到这一点，有 100 多个 sprocs。

补救措施：

1.  我创建了一个文件夹结构。每个 sproc/view 一个子文件夹。

2.  我已经从 bgeinning 浏览了最新版本的 BIG 脚本，并将所有脚本的代码放入各自的文件夹中。有些脚本在 BIG 脚本中重复多次。如果创建特定存储过程的代码块不止一个，我会将早期版本放入该存储过程文件夹中另一个名为“old”的子文件夹中。幸运的是，我一直记录我对所有 sprocs/view 等所做的所有更改——我记下日期、版本号和所做更改的描述，作为 sproc 代码中的注释。当存储过程有多个代码块时，这有助于我找出存储过程的最新版本代码。

3.  我创建了一个 DOS 批处理来连接所有单独的脚本来创建我的 BIG 脚本。我尝试使用 .net 流读取器/写入器，它与编码和“£”符号混淆。所以我暂时坚持使用DOS批处理。

有什么办法可以改善整个过程吗？目前，我正在以某种方式记录 BIG 脚本的版本控制及其各个 sproc 版本。例如，我喜欢有一些方法来记录

```
Big Script (version 1) contains
sp 1 version 1
sp 2 version 1
sp 3 version 3
view 1 version 1
view version 1

Big script (version 2) has
sp 1 version 1
sp 2 version 2
sp 3 version 3
view 1 version 1
view 2 version 1 
```

欢迎任何反馈。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-21T12:10:09.263

我们这样做的方式是为表、存储过程、视图等提供单独的文件，并将它们也存储在它们自己的目录中。对于执行，我们只有一个执行所有文件的脚本。它绝对比拥有一个巨大的文件更容易阅读。

例如，要更新每个表，我们使用以下模板：

```
if not exists (select * from dbo.sysobjects where id = object_id(N'[dbo].[MyTable]') and OBJECTPROPERTY(id, N'IsUserTable') = 1)
begin

    CREATE TABLE [dbo].[MyTable](
        [ID] [int] NOT NULL ,
        [Name] [varchar](255) NULL 
    ) ON [PRIMARY]

end else begin

    -- MyTable.Name
    IF (SELECT COL_LENGTH('MyTable','Name')) IS NULL BEGIN
        ALTER TABLE MyTable ADD [Name] [varchar](255) NULL 
        PRINT 'MyTable.Name CREATED.'
    END

    --etc

end 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-21T12:10:58.573

你看过[Visual Studio Team System 数据库版](http://www.microsoft.com/visualstudio/en-us/products/teamsystem/default.mspx#development-edition)（现在合并到开发者版）了吗？

它将做的一件事是允许维护 SQL 以构建整个数据库，然后仅应用更改以将目标更新到新状态。我相信它还会在给定参考数据库的情况下创建一个脚本，以将与参考模式匹配的数据库带到当前模型（例如，在开发人员无权访问生产的情况下部署到生产）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-21T12:10:39.823

当我不得不处理一些 SQL 表、过程和触发器时，我做了以下事情：

*   版本控制下的所有文件（当时是 CVS，但请查看 SVN 或 Bazaar）
*   每个对象一个文件，以对象命名
*   一个makefile，说明文件之间的依赖关系

这是一个 oracle 项目，每次更改表时都必须重新完成其触发器。而且我的触发器使用了几个模块，因此在更新它们的依赖模块时也必须重新编译......

makefile 避免了“大文件”方法：您不必为每次更改都执行所有代码。

在windows下你可以下载“NMAKE.exe”来使用makefile

高温高压

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-02-21T13:15:22.210

请参阅我对类似问题的回答，这可能会有所帮助：

[数据库架构更新](https://stackoverflow.com/questions/550662/database-schema-updates/550792#550792)

一些额外的点：

当我们发布版本时，例如版本 2，我们将所有 Sproc 连接在一起，其中所有 Sproc 的修改日期都比之前的版本更新。

我们小心翼翼地在每个 Sproc 脚本的底部添加至少一个空白行，并以注释开始每个 Sproc 脚本 - 否则连接会产生“GOCREATE NextSproc” - 这很无聊！

当我们运行连接脚本时，有时我们会发现我们会遇到冲突——例如调用不存在的子 Sproc。我们在脚本底部复制了此类 Sproc 的代码——因此它们被重新创建了第二次——以确保 SQL Server 的依赖关系表是正确的。（即我们在发布的 QA 阶段解决这个问题）

此外，我们在每个 Sproc 脚本的底部放置了一个 GRANT 权限语句，这样当我们删除/创建一个 SProc 时，我们会重新授予权限。但是，如果您的权限分配给每个用户，或者在每个服务器上分配不同，那么使用 ALTER 而不是 CREATE 可能会更好 - 但如果 SProc 尚不存在，那就是一个问题，所以最好做：

```
IF NOT EXIST ...
    CREATE PROCEDURE MySproc AS SELECT 'STUB'
    GRANT EXECUTE Permissions 
```

然后该 Stub 立即被真正的 ALTER Sproc 语句替换。

# apache-flex - 如何将数据网格单元格的预编辑值检索到flex中的itemeditor

> ID：572870
> 
> 赞同：0
> 
> 时间：2009-02-21T12:05:03.473
> 
> 标签：apache-flex, datagrid, return, itemeditor

我为 flex 中的数据网格编写了一个自定义项目编辑器。我的问题是如何在项目编辑器初始化后以及在自定义项目编辑器代码中检索数据网格单元格的预编辑值。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-22T09:52:47.040

我认为一旦进入项目编辑器就不可能获得旧值。我会通过监听“itemEditBeginning”事件并用单元格的值保存一个变量来手动执行此操作。然后，您可以通过项目编辑器中的“parent”、“parentDocument”或“outerDocument”属性引用该值，具体取决于您使用的是内联项目编辑器还是单独的类。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-01-22T15:52:40.430

在“itemEditEnd”事件中，您可以访问旧值：

```
var oldValue:String = event.currentTarget.dataProvider[event.rowIndex].VALUE_FIELD; 
```

新值如下：

```
var txtControl:mx.controls.TextInput = event.currentTarget.itemEditorInstance as mx.controls.TextInput;
var newValue:String = txtControl.text; 
```

如果您使用的是自定义 itemRenderer，则需要为自定义 itemRenderer 更改“mx.controls.TextInput”。

# javascript - javascript指针函数

> ID：572880
> 
> 赞同：0
> 
> 时间：2009-02-21T12:11:36.157
> 
> 标签：javascript, function, pointers

如果我有：

```
function init(t,y,u) 
{
   alert(t + " " + y + " " + u);
}

// String.prototype.add = init(5, 6, 7);  // 1)   
// window.onload = init(5,6,7); // 2) 
```

在 1)`init`中将被执行，然后将其指针分配给但在 2) 中，该函数仅执行一次......但为什么在引发事件`String.prototype.add` 时也不执行两次？`onload`

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-21T12:14:02.607

> 在 1) init 将被执行，然后将它的指针分配给 String.prototype.add

不，不会的。该函数将被简单地执行并且其返回值 ( `undefined`) 将被分配给`String.prototype.add`. 不会分配函数指针。为此，您需要*返回*一个函数！

```
function init(t,y,u) {
    alert(t + " " + y + " " + u);
    return function () { alert('function call!'); };
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-21T12:23:09.763

你可能想要这样的东西：

```
String.prototype.add = function () { init(5, 6, 7); }; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-21T12:35:48.063

这是您的代码发生的情况：

*   定义一个名为 init 的函数，其中三个参数将在调用该函数时发出警报。
*   使用参数 5,6,7 调用函数 init（将弹出警报）并将结果（未定义）分配给 String.prototype.add
*   使用参数 5,6,7 调用函数 init（将弹出警报）并将结果（未定义）分配给 window.onload

如果上面的代码是在 window.onload 事件被触发之前执行的，那么当它被触发时什么都不会发生，因为它被设置为 undefined。

# svn - 使用 Git-Svn 克隆非标准 Svn 存储库

> ID：572893
> 
> 赞同：39
> 
> 时间：2009-02-21T12:28:39.220
> 
> 标签：svn, git, git-svn, clone

我对 Git 比较陌生，但我发现它在家里很容易使用，所以我想在我们的项目存储在 Svn 存储库中的工作中使用它。不幸的是，存储库有点不标准，我无法克隆它们。当然，它们都有trunk、branches/和tags/，但是branches/和tags/在进入*真正的*项目目录之前有子目录：

```
trunk/
branches/maintenance/release1
branches/maintenance/release2
...
branches/development/feature1
branches/development/feature2
...
tags/build/build1
tags/build/build2
...
tags/release/release1
tags/release/release2 
```

克隆后：

```
$ git svn clone -s --prefix=svn/ https://mydomain.com/svnproject
$ git branch -r
  development
  development@1340
  maintenance
  maintenance@1340
  tags/build
  tags/build@1340
  tags/release
  tags/release@1340
  trunk
  trunk@1340 
```

我没有得到任何实际的项目分支或标签。我实际上需要能够在主干、一个维护分支和一个开发分支上工作。除了修改配置的几个技巧之外，我还尝试了这种方法，但没有什么对我有用。

有什么方法可以将我的非标准 Svn 项目的关键组件放入本地 git 存储库，以便我可以轻松地在它们之间移动？

非常感谢。

**更新：我应该补充一点，我还不能批量切换到 Git。还有其他团队成员参与其中并具有国际影响力。过渡的后勤工作比我愿意承担的要多，直到我对 Git 更加熟悉为止；正如我所提到的，我还是很新。我几乎没有触及它功能的表面。**

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-02-21T19:40:00.150

李B是对的。#git 中的 doener 提供的答案是将 Git 升级到 1.6.x（我一直在使用 1.5.x）。1.6.x 提供深度克隆，因此可以通过以下`--branches`选项使用多个通配符：

```
$ git svn clone https://svn.myrepos.com/myproject web-self-serve \ 
          --trunk=trunk --branches=branches/*/* --prefix=svn/
$ git branch -r
  svn/development/sandbox1
  svn/development/feature1
  svn/development/sandbox2
  svn/development/sandbox3
  svn/development/model-associations
  svn/maintenance/version1.0.0
  svn/trunk 
```

正是我需要的。感谢您的洞察力，所有。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-02-21T12:31:48.947

您可以尝试[**nirvdrum 的 svn2git**](http://github.com/nirvdrum/svn2git)（似乎是最新的）以便将您的 svn 导入 git 存储库吗？
（2009 年初，[Paul](https://stackoverflow.com/users/23356/paul)提到了这个**[iteman 的 svn2git](http://github.com/iteman/svn2git/tree/master)**来代替[原来的 jcoglan 的 svn2git](http://github.com/jcoglan/svn2git)，正如他的作者所说：“一个快速的破解让我的代码脱离 Subversion”）

这比 `git svn clone`因为如果你在 svn 中有这段代码更好：

```
 trunk
    ...
  branches
    1.x
    2.x
  tags
    1.0.0
    1.0.1
    1.0.2
    1.1.0
    2.0.0 
```

**`git-svn`**将通过提交历史来构建一个新的 git repo。
它将**所有分支和标签导入为远程 svn 分支，而您真正想要的是 git-native 本地分支和 git tag objects**。
所以在导入这个项目后，你会得到：

```
 $ git branch
  * master
  $ git branch -a
  * master
    1.x
    2.x
    tags/1.0.0
    tags/1.0.1
    tags/1.0.2
    tags/1.1.0
    tags/2.0.0
    trunk
  $ git tag -l
  [ empty ] 
```

在 svn2git 完成你的项目后，你会得到这个：

```
 $ git branch
  * master
    1.x
    2.x
  $ git tag -l
    1.0.0
    1.0.1
    1.0.2
    1.1.0
    2.0.0 
```

* * *

当然，这个解决方案并不意味着单程旅行。

您可以随时返回您的 svn 存储库，使用... **[git2svn](http://repo.or.cz/w/git2svn.git)**（也[存在于那里](http://github.com/etgryphon/git2svn/tree/master)）

思路依旧：

*   SVN 作为中央存储库工作。

*   Git“其他地方”在多个 Git 私有分支中快速试验。

*   *仅将合并的 Git 分支导入到官方 SVN 分支中***。****

 ** * *

## 回答 #3

> 赞同：9
> 
> 时间：2011-05-23T23:58:40.480

对于普通通配符不提供的回购布局：（来自[我](https://stackoverflow.com/questions/1638478/git-svn-with-multiple-branch-locations/6104359#6104359)对[这个相关问题](https://stackoverflow.com/questions/1638478/git-svn-with-multiple-branch-locations/)的回答）

当前的[git-svn 手册页](http://git-scm.com/docs/git-svn)说：

> 也可以通过在大括号中使用逗号分隔的名称列表来获取分支或标签的子集。例如：

```
[svn-remote "huge-project"]
     url = http://server.org/svn
     fetch = trunk/src:refs/remotes/trunk
     branches = branches/{red,green}/src:refs/remotes/branches/*
     tags = tags/{1.0,2.0}/src:refs/remotes/tags/* 
```

# api - 如何在 Mac OS X 上访问有关已连接存储设备的信息？

> ID：572895
> 
> 赞同：1
> 
> 时间：2009-02-21T12:29:55.533
> 
> 标签：api, macos

我正在寻找一种方法来列出所有连接的存储设备，就像磁盘工具一样。这也意味着未安装的卷。

我正在寻找的第二件事是更详细的信息，设备连接到哪个端口，它的大小和它的块大小。

有没有 API 可以做到这一点？我更喜欢 Cocoa，但 unix API 也可以。

## 到目前为止我发现了什么

[diskutil](http://developer.apple.com/documentation/Darwin/Reference/ManPages/man8/diskutil.8.html)可以在命令行上使用。

[`getmntinfo`](http://developer.apple.com/documentation/Darwin/Reference/ManPages/man3/getmntinfo.3.html)并[`getfsstat`](http://developer.apple.com/documentation/Darwin/Reference/ManPages/man2/getfsstat.2.html)返回有关*已安装*设备的信息。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-21T19:18:46.847

您可以使用各种 IOKit API 来搜索所有块设备。您可以查看[文档](http://developer.apple.com/documentation/DeviceDrivers/Conceptual/AccessingHardware/AH_Finding_Devices/chapter_4_section_2.html#//apple_ref/doc/uid/TP30000379-TPXREF108)，特别是您要注意 IOServiceGetMatchingServices。有[示例代码](http://developer.apple.com/samplecode/CDROMSample/)可以在系统中查找所有可以轻松调整的 CD-Rom 媒体。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-21T12:59:57.007

命令：

```
diskutil info /Volumes/* 
```

可能对你有用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-21T15:05:38.950

还有`FSGetVolumeInfo()`. 我不确定它是否适用于未安装的卷。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-21T15:25:12.867

检查`df`在终端和`statfs`（掠夺`man 2 statfs`）。

这些都会告诉你大小，什么是免费和使用的，而 statfs（无论你使用什么语言）都会给你块大小等。

# javascript - JavaScript .prototype 是如何工作的？

> ID：572897
> 
> 赞同：2131
> 
> 时间：2009-02-21T12:31:18.370
> 
> 标签：javascript, dynamic-languages, prototype-oriented

我不是那么喜欢动态编程语言，但我已经编写了相当一部分的 JavaScript 代码。我从来没有真正理解过这种基于原型的编程，有人知道它是如何工作的吗？

```
var obj = new Object();
obj.prototype.test = function() { alert('Hello?'); };
var obj2 = new obj();
obj2.test(); 
```

我记得前段时间与人们进行了很多讨论（我不确定自己在做什么），但据我所知，没有类的概念。它只是一个对象，这些对象的实例是原始对象的克隆，对吗？

但是 JavaScript 中这个“.prototype”属性的确切用途是什么？它与实例化对象有什么关系？

### 更新：正确的方法

```
var obj = new Object(); // not a functional object
obj.prototype.test = function() { alert('Hello?'); }; // this is wrong!

function MyObject() {} // a first class functional object
MyObject.prototype.test = function() { alert('OK'); } // OK 
```

这些[幻灯片](http://ejohn.org/apps/learn/#64)也确实有很大帮助。

* * *

## 回答 #1

> 赞同：1815
> 
> 时间：2011-01-24T03:42:35.727

在 Java、C# 或 C++ 等实现经典继承的语言中，您首先创建一个类（对象的蓝图），然后您可以从该类创建新对象，或者您可以扩展该类，定义一个新类来增强原来的班级。

在 JavaScript 中，您首先创建一个对象（没有类的概念），然后您可以扩充自己的对象或从中创建新对象。对于习惯了经典方式的人来说，这并不难，但有点陌生且难以代谢。

例子：

```
//Define a functional object to hold persons in JavaScript
var Person = function(name) {
  this.name = name;
};

//Add dynamically to the already defined object a new getter
Person.prototype.getName = function() {
  return this.name;
};

//Create a new object of type Person
var john = new Person("John");

//Try the getter
alert(john.getName());

//If now I modify person, also John gets the updates
Person.prototype.sayMyName = function() {
  alert('Hello, my name is ' + this.getName());
};

//Call the new method on john
john.sayMyName();
```

到目前为止，我一直在扩展基础对象，现在我创建另一个对象，然后从 Person 继承。

```
//Create a new object of type Customer by defining its constructor. It's not 
//related to Person for now.
var Customer = function(name) {
    this.name = name;
};

//Now I link the objects and to do so, we link the prototype of Customer to 
//a new instance of Person. The prototype is the base that will be used to 
//construct all new instances and also, will modify dynamically all already 
//constructed objects because in JavaScript objects retain a pointer to the 
//prototype
Customer.prototype = new Person();     

//Now I can call the methods of Person on the Customer, let's try, first 
//I need to create a Customer.
var myCustomer = new Customer('Dream Inc.');
myCustomer.sayMyName();

//If I add new methods to Person, they will be added to Customer, but if I
//add new methods to Customer they won't be added to Person. Example:
Customer.prototype.setAmountDue = function(amountDue) {
    this.amountDue = amountDue;
};
Customer.prototype.getAmountDue = function() {
    return this.amountDue;
};

//Let's try:       
myCustomer.setAmountDue(2000);
alert(myCustomer.getAmountDue()); 
```

```
var Person = function (name) {
    this.name = name;
};
Person.prototype.getName = function () {
    return this.name;
};
var john = new Person("John");
alert(john.getName());
Person.prototype.sayMyName = function () {
    alert('Hello, my name is ' + this.getName());
};
john.sayMyName();
var Customer = function (name) {
    this.name = name;
};
Customer.prototype = new Person();

var myCustomer = new Customer('Dream Inc.');
myCustomer.sayMyName();
Customer.prototype.setAmountDue = function (amountDue) {
    this.amountDue = amountDue;
};
Customer.prototype.getAmountDue = function () {
    return this.amountDue;
};
myCustomer.setAmountDue(2000);
alert(myCustomer.getAmountDue());
```

虽然如前所述，我不能在 Person 上调用 setAmountDue()、getAmountDue()。

```
//The following statement generates an error.
john.setAmountDue(1000); 
```

* * *

## 回答 #2

> 赞同：1046
> 
> 时间：2009-02-21T13:33:54.193

每个 JavaScript 对象都有一个名为[的内部“槽”](https://www.ecma-international.org/ecma-262/10.0/index.html#sec-ordinary-object-internal-methods-and-internal-slots)`[[Prototype]]`，其值为`null`或`object`。您可以将插槽视为对象的属性，位于 JavaScript 引擎内部，对您编写的代码隐藏。方括号`[[Prototype]]`是经过深思熟虑的，是表示内部插槽的 ECMAScript 规范约定。

对象的 指向的值`[[Prototype]]`，俗称“该对象的原型”。

如果您通过点 ( `obj.propName`) 或方括号 ( `obj['propName']`) 表示法访问属性，并且对象没有直接具有这样的属性（即*自己的属性*，可通过 进行检查`obj.hasOwnProperty('propName')`），则运行时会在引用的对象上查找具有该名称的属性`[[Prototype]]`相反。如果`[[Prototype]]` *也*没有这样的属性，`[[Prototype]]`则依次检查它，依此类推。以这种方式，原始对象的*原型链*被遍历，直到找到匹配，或者到达它的末端。原型链的顶端是`null`价值。

`[[Prototype]]`现代 JavaScript 实现允许通过以下方式读取和/或写入访问权限：

1.  运算符（在`new`构造函数返回的默认对象上配置原型链），
2.  关键字（使用`extends`类语法时配置原型链），
3.  `Object.create`将提供的参数设置为`[[Prototype]]`结果对象的，
4.  `Object.getPrototypeOf`和`Object.setPrototypeOf`（获取/设置对象创建`[[Prototype]]` *后），以及*
5.  命名的标准化访问器（即 getter/setter）属性`__proto__`（类似于 4.）

`Object.getPrototypeOf`并且`Object.setPrototypeOf`优先于，部分原因是当对象具有 的原型时，`__proto__`的行为`o.__proto__` [是不寻常](https://stackoverflow.com/a/35458348/38522)`null`的。

对象的`[[Prototype]]`初始设置是在对象创建期间设置的。

如果您通过 创建新对象`new Func()`，则`[[Prototype]]`默认情况下，该对象将设置为 引用的对象`Func.prototype`。

因此，请注意，**所有可以与运算符一起使用的类和所有函数，除了它们自己的内部槽外`new`，还有一个名为的属性。`.prototype``[[Prototype]]`**“原型”这个词的双重使用是该语言新手无休止的困惑的根源。

使用`new`构造函数可以让我们模拟 JavaScript 中的经典继承；尽管 JavaScript 的继承系统——正如我们所见——是原型的，而不是基于类的。

在将类语法引入 JavaScript 之前，构造函数是模拟类的唯一方法。我们可以将构造函数的属性所引用的对象的`.prototype`属性视为共享成员；IE。每个实例都相同的成员。在基于类的系统中，每个实例的方法都以相同的方式实现，因此方法在概念上被添加到`.prototype`属性中；但是，对象的字段是特定于实例的，因此在构造过程中会添加到对象本身。

如果没有类语法，开发人员必须手动配置原型链以实现与经典继承类似的功能。这导致了实现这一目标的不同方法的优势。

这是一种方法：

```
function Child() {}
function Parent() {}
Parent.prototype.inheritedMethod = function () { return 'this is inherited' }

function inherit(child, parent) {
  child.prototype = Object.create(parent.prototype)
  child.prototype.constructor = child
  return child;
}

Child = inherit(Child, Parent)
const o = new Child
console.log(o.inheritedMethod()) // 'this is inherited' 
```

...这是另一种方式：

```
function Child() {}
function Parent() {}
Parent.prototype.inheritedMethod = function () { return 'this is inherited' }

function inherit(child, parent) {
    function tmp() {}
    tmp.prototype = parent.prototype
    const proto = new tmp()
    proto.constructor = child
    child.prototype = proto
    return child
}

Child = inherit(Child, Parent)
const o = new Child
console.log(o.inheritedMethod()) // 'this is inherited' 
```

ES2015 中引入的类语法通过提供`extends`“一种真正的方式”来配置原型链以模拟 JavaScript 中的经典继承，从而简化了事情。

因此，类似于上面的代码，如果您使用类语法创建一个新对象，如下所示：

```
class Parent { inheritedMethod() { return 'this is inherited' } }
class Child extends Parent {}

const o = new Child
console.log(o.inheritedMethod()) // 'this is inherited' 
```

...结果对象`[[Prototype]]`将被设置为 的实例`Parent`，其`[[Prototype]]`又是`Parent.prototype`。

最后，如果您通过 创建一个新对象`Object.create(foo)`，则生成的对象`[[Prototype]]`将设置为`foo`。

* * *

## 回答 #3

> 赞同：195
> 
> 时间：2014-02-13T19:32:12.300

这是一个非常简单的基于原型的对象模型，在解释过程中将被视为示例，尚无评论：

```
function Person(name){
    this.name = name;
}
Person.prototype.getName = function(){
    console.log(this.name);
}
var person = new Person("George"); 
```

* * *

在了解原型概念之前，我们必须考虑一些关键点。

# 1- JavaScript 函数的实际工作原理：

为了迈出第一步，我们必须弄清楚 JavaScript 函数实际上是如何工作的，作为一个使用**`this`**关键字的类之类的函数，或者只是作为一个带有参数的常规函数​​，它做什么以及它返回什么。

假设我们要创建一个`Person`对象模型。但在这一步中，我将尝试在不使用**and****关键字****的情况下做同样的事情`prototype``new`**。

所以在这一步**`functions`**中，**`objects`**和**`this`**关键字，是我们所拥有的。

第一个问题是在不使用关键字的情况下**如何`this`使用`new`关键字**。

因此，要回答这个问题，假设我们有一个空对象，以及两个函数，例如：

```
var person = {};
function Person(name){  this.name = name;  }

function getName(){
    console.log(this.name);
} 
```

现在**不使用`new`关键字**我们如何使用这些功能。所以 JavaScript 有 3 种不同的方法来做到这一点：

## 一种。第一种方法是将函数作为常规函数调用：

```
Person("George");
getName();//would print the "George" in the console 
```

在这种情况下，这将是当前上下文对象，通常是 浏览器`window`或`GLOBAL`. `Node.js`这意味着我们将拥有浏览器中的 window.name 或 Node.js 中的 GLOBAL.name，其值为“George”。

## 湾。我们可以**将**它们附加到一个对象上，作为它的属性

-**最简单的方法**是修改空`person`对象，例如：

```
person.Person = Person;
person.getName = getName; 
```

这样我们就可以这样称呼它们：

```
person.Person("George");
person.getName();// -->"George" 
```

现在`person`对象是这样的：

```
Object {Person: function, getName: function, name: "George"} 
```

* * *

-**将属性附加**到对象的另一种方法是使用该对象的`prototype`，该对象可以在任何 JavaScript 对象中找到，名称为`__proto__`，我试图在摘要部分解释一下。所以我们可以通过这样做得到类似的结果：

```
person.__proto__.Person = Person;
person.__proto__.getName = getName; 
```

**但是**这种方式我们实际上正在做的是修改`Object.prototype`，因为每当我们使用字面量 ( ) 创建一个 JavaScript 对象时`{ ... }`，它都是基于创建的，这意味着它`Object.prototype`作为一个名为**`__proto__`**，正如我们在之前的代码片段中所做的那样，所有的 JavaScript 对象都会被更改，这不是一个好的做法。那么现在更好的做法是什么：

```
person.__proto__ = {
    Person: Person,
    getName: getName
}; 
```

而现在其他的对象都安然无恙，但似乎还是不是一个好的做法。所以我们还有一个解决方案，但是要使用这个解决方案，我们应该回到`person`创建对象的那一行代码（`var person = {};`），然后将其更改为：

```
var propertiesObject = {
    Person: Person,
    getName: getName
};
var person = Object.create(propertiesObject); 
```

它所做的是创建一个新的 JavaScript`Object`并将 附加`propertiesObject`到`__proto__`属性。所以要确保你能做到：

```
console.log(person.__proto__===propertiesObject); //true 
```

但是这里的棘手点是您可以访问对象`__proto__`第一级中定义的所有属性`person`（阅读摘要部分以获取更多详细信息）。

* * *

正如您所看到的，使用这两种方式中的任何一种`this`都会准确地指向`person`对象。

## C。JavaScript 有另一种方式为函数提供`this`，即使用[call](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/call)或[apply](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/apply)来调用函数。

> apply() 方法使用给定的 this 值和作为数组（或类似数组的对象）提供的参数调用函数。

和

> call() 方法使用给定的 this 值和单独提供的参数调用函数。

这种我最喜欢的方式，我们可以轻松地调用我们的函数，例如：

```
Person.call(person, "George"); 
```

或者

```
//apply is more useful when params count is not fixed
Person.apply(person, ["George"]);

getName.call(person);   
getName.apply(person); 
```

这 3 种方法是找出 .prototype 功能的重要初始步骤。

* * *

# `new`2-关键字如何工作？

这是了解功能的第二步。这是`.prototype`我用来模拟该过程的：

```
function Person(name){  this.name = name;  }
my_person_prototype = { getName: function(){ console.log(this.name); } }; 
```

在这一部分中，我将尝试执行 JavaScript 所采取的所有步骤，而不使用`new`关键字 and `prototype`，当您使用`new`关键字时。因此，当我们这样做时`new Person("George")`，`Person`函数充当构造函数，这些是 JavaScript 所做的，一一对应：

## 一种。首先，它创建一个空对象，基本上是一个空哈希，例如：

```
var newObject = {}; 
```

## 湾。JavaScript 的下一步是**将**所有原型对象附加到新创建的对象

我们`my_person_prototype`这里有类似原型的对象。

```
for(var key in my_person_prototype){
    newObject[key] = my_person_prototype[key];
} 
```

这不是 JavaScript 实际附加原型中定义的属性的方式。实际方式与原型链概念有关。

* * *

## 一种。& b。而不是这两个步骤，您可以通过执行以下操作获得完全相同的结果：

```
var newObject = Object.create(my_person_prototype);
//here you can check out the __proto__ attribute
console.log(newObject.__proto__ === my_person_prototype); //true
//and also check if you have access to your desired properties
console.log(typeof newObject.getName);//"function" 
```

现在我们可以调用我们的`getName`函数`my_person_prototype`：

```
newObject.getName(); 
```

## C。然后它将该对象提供给构造函数，

我们可以用我们的样本来做到这一点，比如：

```
Person.call(newObject, "George"); 
```

或者

```
Person.apply(newObject, ["George"]); 
```

然后构造函数可以做它想做的任何事情，因为构造函数内部的**this**是刚刚创建的对象。

现在是模拟其他步骤之前的最终结果： Object {name: "George"}

* * *

## 概括：

基本上，当您在函数上使用**new**关键字时，您正在调用该函数并且该函数用作构造函数，所以当您说：

```
new FunctionName() 
```

JavaScript 在内部创建一个对象，一个空的哈希，然后将该对象提供给构造函数，然后构造函数可以为所欲为，因为**该**构造函数内部的 this 是刚刚创建的对象，然后它当然会为您提供该对象如果您没有在函数中使用 return 语句，或者如果您在`return undefined;`函数体的末尾放置了 a。

所以当 JavaScript 在一个对象上查找一个属性时，它做的第一件事就是在那个对象上查找它。然后有一个**`[[prototype]]`**我们通常拥有的秘密属性，**`__proto__`**该属性是 JavaScript 接下来要研究的。当它查看 时**`__proto__`**，只要它又是另一个 JavaScript 对象，它就有自己的**`__proto__`**属性，它会不断上升，直到到达下一个**`__proto__`**为空的点。要点是 JavaScript 中唯一一个**`__proto__`**属性为 null 的对象是`Object.prototype`object：

```
console.log(Object.prototype.__proto__===null);//true 
```

这就是 JavaScript 中继承的工作原理。

![原型链](https://i.stack.imgur.com/JnpBV.png)

换句话说，当你在一个函数上有一个原型属性并且你在它上面调用了一个 new 时，在 JavaScript 完成了对新创建的属性对象的查看之后，它会去查看函数的`.prototype`，并且这个对象也可能有它的自己的内部原型。等等。

* * *

## 回答 #4

> 赞同：80
> 
> 时间：2014-05-26T20:40:03.213

## 原型之七公案

西罗桑在冥思之后下到火狐山上，心神清明平静。

然而，他的手却是不动声色，自己抓起一把毛笔，记下了下面的笔记。

* * *

**0）**两种不同的东西可以称为“原型”：

*   原型属性，如`obj.prototype`

*   原型内部属性，`[[Prototype]]` [在 ES5](http://www.ecma-international.org/ecma-262/5.1/#sec-8.6.2)中表示。

    它可以通过 ES5 检索`Object.getPrototypeOf()`。

    Firefox 可以通过该`__proto__`属性作为扩展来访问它。[ES6 现在提到](http://www.ecma-international.org/ecma-262/6.0/#sec-additional-ecmascript-features-for-web-browsers)了`__proto__`.

* * *

**1）**这些概念的存在是为了回答这个问题：

> 当我这样做`obj.property`时，JS 在哪里寻找`.property`？

直观地说，经典继承应该会影响属性查找。

* * *

**2)**

*   `__proto__`用于点`.`属性查找，如`obj.property`.
*   `.prototype`不*直接*用于查找，仅用于间接查找，因为它`__proto__`在创建对象时使用`new`.

查找顺序为：

*   `obj``obj.p = ...`用or添加的属性`Object.defineProperty(obj, ...)`
*   的属性`obj.__proto__`
*   的属性`obj.__proto__.__proto__`，等等
*   如果有`__proto__`，请`null`返回`undefined`。

这就是所谓的*原型链*。

您可以避免使用and进行`.`查找`obj.hasOwnProperty('key')``Object.getOwnPropertyNames(f)`

* * *

**3）**有两种主要的设置方式`obj.__proto__`：

*   `new`：

    ```
    var F = function() {}
    var f = new F() 
    ```

    然后`new`设置：

    ```
    f.__proto__ === F.prototype 
    ```

    *这*是`.prototype`使用的地方。

*   `Object.create`：

    ```
     f = Object.create(proto) 
    ```

    套：

    ```
    f.__proto__ === proto 
    ```

* * *

**4）**代码：

```
var F = function(i) { this.i = i }
var f = new F(1) 
```

对应下图（有些`Number`东西省略了）：

```
(Function)       (  F  )                                      (f)----->(1)
 |  ^             | | ^                                        |   i    |
 |  |             | | |                                        |        |
 |  |             | | +-------------------------+              |        |
 |  |constructor  | |                           |              |        |
 |  |             | +--------------+            |              |        |
 |  |             |                |            |              |        |
 |  |             |                |            |              |        |
 |[[Prototype]]   |[[Prototype]]   |prototype   |constructor   |[[Prototype]]
 |  |             |                |            |              |        |
 |  |             |                |            |              |        |
 |  |             |                | +----------+              |        |
 |  |             |                | |                         |        |
 |  |             |                | | +-----------------------+        |
 |  |             |                | | |                                |
 v  |             v                v | v                                |
(Function.prototype)              (F.prototype)                         |
 |                                 |                                    |
 |                                 |                                    |
 |[[Prototype]]                    |[[Prototype]]          [[Prototype]]|
 |                                 |                                    |
 |                                 |                                    |
 | +-------------------------------+                                    |
 | |                                                                    |
 v v                                                                    v
(Object.prototype)                                       (Number.prototype)
 | | ^
 | | |
 | | +---------------------------+
 | |                             |
 | +--------------+              |
 |                |              |
 |                |              |
 |[[Prototype]]   |constructor   |prototype
 |                |              |
 |                |              |
 |                | -------------+
 |                | |
 v                v |
(null)           (Object) 
```

此图显示了许多语言预定义的对象节点：

*   `null`
*   `Object`
*   `Object.prototype`
*   `Function`
*   `Function.prototype`
*   `1`
*   `Number.prototype`（可以找到`(1).__proto__`，括号必须满足语法）

我们的 2 行代码只创建了以下新对象：

*   `f`
*   `F`
*   `F.prototype`

`i`现在是的属性，`f`因为当您这样做时：

```
var f = new F(1) 
```

它评估`F`为将返回`this`的值，`new`然后将其分配给`f`.

* * *

**5）** `.constructor`通常来自于`F.prototype`查找`.`：

```
f.constructor === F
!f.hasOwnProperty('constructor')
Object.getPrototypeOf(f) === F.prototype
F.prototype.hasOwnProperty('constructor')
F.prototype.constructor === f.constructor 
```

当我们编写`f.constructor`时，JavaScript 会进行如下`.`查找：

*   `f`不具有`.constructor`
*   `f.__proto__ === F.prototype`有`.constructor === F`，拿去吧

结果`f.constructor == F`直观上是正确的，因为`F`用于构造`f`，例如设置字段，就像在经典的 OOP 语言中一样。

* * *

**6）**经典的继承语法可以通过操作原型链来实现。

ES6 添加了`class`and`extends`关键字，它们主要是以前可能的原型操作疯狂的语法糖。

```
class C {
    constructor(i) {
        this.i = i
    }
    inc() {
        return this.i + 1
    }
}

class D extends C {
    constructor(i) {
        super(i)
    }
    inc2() {
        return this.i + 2
    }
} 
```

```
// Inheritance syntax works as expected.
c = new C(1)
c.inc() === 2
(new D(1)).inc() === 2
(new D(1)).inc2() === 3 
```

```
// "Classes" are just function objects.
C.constructor === Function
C.__proto__ === Function.prototype
D.constructor === Function
// D is a function "indirectly" through the chain.
D.__proto__ === C
D.__proto__.__proto__ === Function.prototype 
```

```
// "extends" sets up the prototype chain so that base class
// lookups will work as expected
var d = new D(1)
d.__proto__ === D.prototype
D.prototype.__proto__ === C.prototype
// This is what `d.inc` actually does.
d.__proto__.__proto__.inc === C.prototype.inc 
```

```
// Class variables
// No ES6 syntax sugar apparently:
// http://stackoverflow.com/questions/22528967/es6-class-variable-alternatives
C.c = 1
C.c === 1
// Because `D.__proto__ === C`.
D.c === 1
// Nothing makes this work.
d.c === undefined 
```

没有所有预定义对象的简化图：

```
(c)----->(1)
 |   i
 |
 |
 |[[Prototype]]
 |
 |
 v    __proto__
(C)<--------------(D)         (d)
| |                |           |
| |                |           |
| |prototype       |prototype  |[[Prototype]] 
| |                |           |
| |                |           |
| |                | +---------+
| |                | |
| |                | |
| |                v v
|[[Prototype]]    (D.prototype)--------> (inc2 function object)
| |                |             inc2
| |                |
| |                |[[Prototype]]
| |                |
| |                |
| | +--------------+
| | |
| | |
| v v
| (C.prototype)------->(inc function object)
|                inc
v
Function.prototype 
```

让我们花点时间研究一下以下是如何工作的：

```
c = new C(1)
c.inc() === 2 
```

第一行设置`c.i`为`1`如“4)”中所述。

在第二行，当我们这样做时：

```
c.inc() 
```

*   `.inc`通过`[[Prototype]]`链找到：`c`-> `C`-> `C.prototype`->`inc`
*   当我们在 Javascript 中调用函数 as时，JavaScript 会在函数调用内部`X.Y()`自动设置`this`为 equal ！`X``Y()`

完全相同的逻辑也解释了`d.inc`和`d.inc2`。

这篇文章[https://javascript.info/class#not-just-a-syntax-sugar](https://javascript.info/class#not-just-a-syntax-sugar)`class`提到了值得了解的进一步影响。`class`如果没有关键字（TODO check which），其中一些可能无法实现：

*   `[[FunctionKind]]:"classConstructor"`，这会强制使用 new 调用构造函数：[ES6 类构造函数不能作为普通函数调用的原因是什么？](https://stackoverflow.com/questions/44446650/what-is-the-reason-es6-class-constructors-cant-be-called-as-normal-functions)
*   类方法是不可枚举的。可以用`Object.defineProperty`.
*   总是上课`use strict`。可以`use strict`对每个函数都使用明确的方法来完成，这无疑是乏味的。

* * *

## 回答 #5

> 赞同：79
> 
> 时间：2009-02-21T12:37:10.837

`prototype`允许你上课。如果你不使用`prototype`，那么它就会变成一个静态的。

这是一个简短的例子。

```
var obj = new Object();
obj.test = function() { alert('Hello?'); }; 
```

在上述情况下，您有静态函数调用测试。此函数只能由 obj.test 访问，您可以将 obj 想象为一个类。

在下面的代码中

```
function obj()
{
}

obj.prototype.test = function() { alert('Hello?'); };
var obj2 = new obj();
obj2.test(); 
```

obj 已成为现在可以实例化的类。obj 可以存在多个实例，并且它们都具有该`test`功能。

以上是我的理解。我正在把它变成一个社区维基，所以如果我错了，人们可以纠正我。

* * *

## 回答 #6

> 赞同：67
> 
> 时间：2012-11-07T09:48:11.940

读完这个帖子后，我对 JavaScript Prototype Chain 感到困惑，然后我找到了这些图表

[http://iwiki.readthedocs.org/en/latest/javascript/js_core.html#inheritance](http://iwiki.readthedocs.org/en/latest/javascript/js_core.html#inheritance) ![*[[prototype]]* 和函数对象的 <code>prototype</code> 属性](https://i.stack.imgur.com/rcGmc.png)

*这是一个通过原型链显示 JavaScript 继承的清晰图表*

和

[http://www.javascriptbank.com/javascript/article/JavaScript_Classical_Inheritance/](http://www.javascriptbank.com/javascript/article/JavaScript_Classical_Inheritance/)

*这个包含一个带有代码的示例和几个漂亮的图表。*

> 原型链最终回退到 Object.prototype。
> 
> 原型链可以在技术上随心所欲地扩展，每次通过将子类的原型设置为父类的对象。

希望对你理解 JavaScript Prototype Chain 也有帮助。

* * *

## 回答 #7

> 赞同：41
> 
> 时间：2013-06-18T19:48:08.097

每个对象都有一个内部属性*[[Prototype]]*，将它链接到另一个对象：

```
object [[Prototype]] → anotherObject 
```

在传统的 javascript 中，链接对象是`prototype`函数的属性：

```
object [[Prototype]] → aFunction.prototype 
```

一些环境将*[[Prototype]]*公开为`__proto__`：

```
anObject.__proto__ === anotherObject 
```

在创建对象时创建*[[Prototype]]*链接。

```
// (1) Object.create:
var object = Object.create(anotherObject)
// object.__proto__ = anotherObject

// (2) ES6 object initializer:
var object = { __proto__: anotherObject };
// object.__proto__ = anotherObject

// (3) Traditional JavaScript:
var object = new aFunction;
// object.__proto__ = aFunction.prototype 
```

所以这些语句是等价的：

```
var object = Object.create(Object.prototype);
var object = { __proto__: Object.prototype }; // ES6 only
var object = new Object; 
```

您实际上无法在[新](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/new)语句中看到链接目标 ( `Object.prototype`) ；相反，目标是由构造函数 ( ) 隐含的。`Object`

记住：

*   每个对象都有一个链接*[[Prototype]]*，有时暴露为[__proto__](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/proto)。
*   每个函数都有一个`prototype`属性，最初持有一个空对象。
*   [使用new](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/new)创建的对象链接到`prototype`其构造函数的属性。
*   如果一个函数从不用作构造函数，它的`prototype`属性将不被使用。
*   如果您不需要构造函数，请使用[Object.create](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/create)而不是`new`.

* * *

## 回答 #8

> 赞同：30
> 
> 时间：2009-02-21T12:41:31.667

Javascript没有通常意义上的继承，但它有原型链。

## 原型链

如果在对象中找不到对象的成员，它会在原型链中查找它。链由其他对象组成。可以使用`__proto__`变量访问给定实例的原型。每个对象都有一个，因为 javascript 中的类和实例之间没有区别。

将函数/变量添加到原型的优点是它必须只在内存中一次，而不是每个实例。

它对于继承也很有用，因为原型链可以包含许多其他对象。

* * *

## 回答 #9

> 赞同：29
> 
> 时间：2015-11-04T14:08:57.437

这篇文章很长。但我相信它会清除您关于 JavaScript 继承的“原型”性质的大部分疑问。甚至更多。请阅读完整的文章。

JavaScript 基本上有两种数据类型

*   ***非对象***
*   ***对象***

***非对象***

以下***是非对象***数据类型

*   **细绳**
*   **数（包括 NaN 和 Infinity）**
*   **布尔值（真，假）**
*   **不明确的**

当您使用**typeof**运算符时，这些数据类型会返回以下内容

**typeof** *"字符串文字"* (或包含字符串文字的变量) === **'string'**

**typeof** *5*（或任何数字文字或包含数字文字或***NaN 或 Infynity***的变量）=== **'number'**

**typeof** *true*（或*false*或包含*true*或*false*的变量）=== **'boolean'**

**typeof** *undefined* (或未定义的变量或包含*undefined*的变量) === **'undefined'**

**字符串**、**数字**和**布尔**数据类型可以表示为**对象**和**非对象**。当它们表示为对象时，它们的 typeof 始终为 === 'object' 。一旦我们了解了对象数据类型，我们将回到这一点。

***对象***

对象数据类型可以进一步分为两种类型

1.  **函数类型对象**
2.  **非函数类型对象**

**Function 类型对象**是使用**typeof**运算符返回字符串**'function'**的对象。所有用户定义的函数和所有可以使用 new 运算符创建新对象的 JavaScript 内置对象都属于这一类。例如。

 ***   **目的**
*   **细绳**
*   **数字**
*   **布尔值**
*   **大批**
*   **类型化数组**
*   **正则表达式**
*   **功能**
*   所有其他可以使用 new 运算符创建新对象的内置对象
*   *function* **UserDefinedFunction** (){ /*用户定义代码 */ }

所以， **typeof(Object)** === **typeof(String)** === **typeof(Number)** === **typeof(Boolean)** === **typeof(Array)** === **typeof(RegExp)** === **typeof(Function)** == = **typeof(UserDefinedFunction)** === **'函数'**

所有的***Function 类型对象***实际上都是内置 JavaScript 对象**Function**的实例（包括**Function**对象，即它是递归定义的）。就好像这些对象已按以下方式定义

```
var Object= new Function ([native code for object Object])
var String= new Function ([native code for object String])
var Number= new Function ([native code for object Number])
var Boolean= new Function ([native code for object Boolean])
var Array= new Function ([native code for object Array])
var RegExp= new Function ([native code for object RegExp])
var Function= new Function ([native code  for object Function])
var UserDefinedFunction= new Function ("user defined code") 
```

如前所述，***Function 类型对象*****可以使用new 运算符**进一步创建新对象。例如，可以使用**Object**、**String**、**Number**、**Boolean**、**Array**、**RegExp** 或**UserDefinedFunction**类型的对象创建

```
var a=new Object() or var a=Object() or var a={} //Create object of type Object
var a=new String() //Create object of type String
var a=new Number() //Create object of type Number
var a=new Boolean() //Create object of type Boolean
var a=new Array() or var a=Array() or var a=[]  //Create object of type Array
var a=new RegExp() or var a=RegExp() //Create object of type RegExp
var a=new UserDefinedFunction() 
```

这样创建的对象都是***非函数类型的对象***，并返回它们的**typeof** === **'object'**。在所有这些情况下，对象“a”不能使用 operator new 进一步创建对象。所以以下是错误的

```
var b=new a() //error. a is not typeof==='function' 
```

内置对象**Math**是**typeof** === **'object'**。因此，新运算符不能创建 Math 类型的新对象。

```
var b=new Math() //error. Math is not typeof==='function' 
```

另请注意，**Object**、**Array**和**RegExp函数甚至无需使用****operator new**即可创建新对象。然而后面的没有。

```
var a=String() // Create a new Non Object string. returns a typeof==='string' 
var a=Number() // Create a new Non Object Number. returns a typeof==='number'
var a=Boolean() //Create a new Non Object Boolean. returns a typeof==='boolean' 
```

用户定义的函数是特殊情况。

```
var a=UserDefinedFunction() //may or may not create an object of type UserDefinedFunction() based on how it is defined. 
```

由于***Function 类型的对象***可以创建新对象，因此它们也称为***Constructors***。

每个**构造函数/函数**（无论是内置的还是用户定义的）在自动定义时都有一个名为**“原型”**的属性，其值默认设置为对象。该对象本身有一个名为**“constructor”**的属性，默认情况下它引用回**Constructor/Function**。

例如当我们定义一个函数时

```
function UserDefinedFunction()
{
} 
```

以下自动发生

```
UserDefinedFunction.prototype={constructor:UserDefinedFunction} 
```

此**“原型”属性**仅存在于**Function 类型对象** 中（而不存在于**Non Function 类型对象**中）。

这是因为**当一个新对象被创建（使用 new 操作符）时，它会从构造函数的当前原型对象继承所有属性和方法，即在新创建的对象中创建一个** ***内部引用*** **，该对象引用构造函数的当前原型对象所引用的对象。**

在对象中创建的用于引用继承属性的**“内部引用”**称为**对象的原型**（它引用了构造函数的**“原型”**属性所引用的对象，但与它不同）。对于任何对象（函数或非函数），可以使用**Object.getPrototypeOf()**方法检索。使用这种方法可以追踪对象的原型链。

此外，**创建的每个对象**（**函数类型**或非**函数类型**）都有一个**“构造函数”**属性，该属性继承自构造函数的原型属性引用的对象。默认情况下，此**“构造函数”**属性引用创建它的构造函数（如果**构造****函数的**默认“原型”未更改）。

对于所有***Function 类型对象***，构造函数始终是 ***function Function(){}***

对于***非函数类型对象***（例如 Javascript Built in Math 对象），构造函数是创建它的函数。对于**Math**对象，它是***function Object(){}***。

如果没有任何支持代码，上面解释的所有概念可能有点难以理解。请逐行阅读以下代码以了解该概念。尝试执行它以获得更好的理解。

```
function UserDefinedFunction()
{ 

} 

/* creating the above function automatically does the following as mentioned earlier

UserDefinedFunction.prototype={constructor:UserDefinedFunction}

*/

var newObj_1=new UserDefinedFunction()

alert(Object.getPrototypeOf(newObj_1)===UserDefinedFunction.prototype)  //Displays true

alert(newObj_1.constructor) //Displays function UserDefinedFunction

//Create a new property in UserDefinedFunction.prototype object

UserDefinedFunction.prototype.TestProperty="test"

alert(newObj_1.TestProperty) //Displays "test"

alert(Object.getPrototypeOf(newObj_1).TestProperty)// Displays "test"

//Create a new Object

var objA = {
        property1 : "Property1",
        constructor:Array

}

//assign a new object to UserDefinedFunction.prototype
UserDefinedFunction.prototype=objA

alert(Object.getPrototypeOf(newObj_1)===UserDefinedFunction.prototype)  //Displays false. The object referenced by UserDefinedFunction.prototype has changed

//The internal reference does not change
alert(newObj_1.constructor) // This shall still Display function UserDefinedFunction

alert(newObj_1.TestProperty) //This shall still Display "test" 

alert(Object.getPrototypeOf(newObj_1).TestProperty) //This shall still Display "test"

//Create another object of type UserDefinedFunction
var newObj_2= new UserDefinedFunction();

alert(Object.getPrototypeOf(newObj_2)===objA) //Displays true.

alert(newObj_2.constructor) //Displays function Array()

alert(newObj_2.property1) //Displays "Property1"

alert(Object.getPrototypeOf(newObj_2).property1) //Displays "Property1"

//Create a new property in objA
objA.property2="property2"

alert(objA.property2) //Displays "Property2"

alert(UserDefinedFunction.prototype.property2) //Displays "Property2"

alert(newObj_2.property2) // Displays Property2

alert(Object.getPrototypeOf(newObj_2).property2) //Displays  "Property2" 
```

每个对象的原型链最终都追溯到 Object.prototype（它本身没有任何原型对象）。以下代码可用于跟踪对象的原型链

```
var o=Starting object;

do {
    alert(o + "\n" + Object.getOwnPropertyNames(o))

}while(o=Object.getPrototypeOf(o)) 
```

各种对象的原型链如下所示。

*   每个 Function 对象（包括内置的 Function 对象）-> Function.prototype -> Object.prototype -> null
*   简单对象（由 new Object() 或 {} 创建，包括内置的 Math 对象）-> Object.prototype -> null
*   使用 new 或 Object.create 创建的对象 -> 一个或多个原型链 -> Object.prototype -> null

要创建没有任何原型的对象，请使用以下命令：

```
var o=Object.create(null)
alert(Object.getPrototypeOf(o)) //Displays null 
```

有人可能认为将 Constructor 的原型属性设置为 null 会创建一个具有 null 原型的对象。然而，在这种情况下，新创建的对象的原型设置为 Object.prototype，其构造函数设置为函数 Object。下面的代码证明了这一点

```
function UserDefinedFunction(){}
UserDefinedFunction.prototype=null// Can be set to any non object value (number,string,undefined etc.)

var o=new UserDefinedFunction()
alert(Object.getPrototypeOf(o)==Object.prototype)   //Displays true
alert(o.constructor)    //Displays Function Object 
```

以下是本文的摘要

*   对象有**函数类型**和**非函数类型两种**
*   只有**Function 类型的对象可以使用****操作符 new**创建一个新对象。这样创建的对象**是非函数类型**的对象。**Non Function 类型的对象**不能使用**operator new**进一步创建对象。

*   默认情况下，所有**函数类型对象**都有一个**“原型”**属性。这个**“原型”**属性引用了一个具有**“构造函数”**属性的对象，该属性默认引用了**函数类型对象**本身。

*   所有对象（**函数类型**和**非函数类型**）都有一个“构造函数”属性，默认情况下引用创建它的**函数类型对象**/**构造函数。**

*   在内部创建的每个对象都引用由 创建它的构造函数的**“原型”属性引用的对象。**这个对象被称为创建***对象的原型***（它不同于它所引用的函数类型对象的“原型”属性）。这样创建的对象可以直接访问构造函数的“原型”属性（在对象创建时）引用的对象中定义的方法和属性。

*   可以使用**Object.getPrototypeOf()** 方法检索**对象的原型**（以及继承的属性名称） 。事实上，这种方法可以用于导航对象的整个原型链。

***   每个对象的原型链最终都追溯到 Object.prototype（除非对象是使用 Object.create(null) 创建的，在这种情况下对象没有原型）。

    *   **typeof(new Array())==='object'**是语言设计的，而不是[Douglas Crockford指出的错误](http://javascript.crockford.com/survey.html)

    *   将构造函数的原型属性设置为 null（或 undefined,number,true,false,string）不应创建具有 null 原型的对象。在这种情况下，新创建的对象的原型设置为 Object.prototype，其构造函数设置为函数 Object。** 

 **希望这可以帮助。

* * *

## 回答 #10

> 赞同：25
> 
> 时间：2016-07-03T21:44:50.487

对于许多开发人员来说，继承的概念`prototypal`是最复杂的概念之一。让我们尝试了解问题的根源以便`prototypal inheritance`更好地理解。让我们从一个`plain`函数开始。

[![在此处输入图像描述](https://i.stack.imgur.com/BsHT0.png)](https://i.stack.imgur.com/BsHT0.png)

如果我们在 上使用`new`运算符`Tree function`，我们将其称为`constructor`函数。

[![在此处输入图像描述](https://i.stack.imgur.com/cU6Qh.png)](https://i.stack.imgur.com/cU6Qh.png)

每个`JavaScript`函数都有一个`prototype`. 当您登录时`Tree.prototype`，您会得到...

[![在此处输入图像描述](https://i.stack.imgur.com/Xop8c.png)](https://i.stack.imgur.com/Xop8c.png)

如果您查看上面的`console.log()`输出，您可以看到一个构造函数属性`Tree.prototype`和一个`__proto__`属性。`__proto__`表示这是基于的`prototype`，`function`因为这只是一个还`JavaScript function`没有`inheritance`设置的普通，它指的`Object prototype`是刚刚内置在JavaScript中的东西......

[https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/prototype](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/prototype)

这有诸如此类的东西`.toString, .toValue, .hasOwnProperty`...

`__proto__`我的 mozilla 已弃用，取而代之的是`Object.getPrototypeOf`获取`object's prototype`.

[![在此处输入图像描述](https://i.stack.imgur.com/GtcJO.png)](https://i.stack.imgur.com/GtcJO.png)

```
Object.getPrototypeOf(Tree.prototype); // Object {} 
```

让我们添加一个方法到我们的`Tree` `prototype`.

[![在此处输入图像描述](https://i.stack.imgur.com/BsHT0.png)](https://i.stack.imgur.com/BsHT0.png)

我们已经修改`Root`并添加了一个`function`分支。

[![在此处输入图像描述](https://i.stack.imgur.com/cU6Qh.png)](https://i.stack.imgur.com/cU6Qh.png)

这意味着当您创建`instance`of 时`Tree`，您可以调用它的`branch`方法。

[![在此处输入图像描述](https://i.stack.imgur.com/Xop8c.png)](https://i.stack.imgur.com/Xop8c.png)

我们也可以将`primitives`或添加`objects`到我们的`Prototype`.

[![在此处输入图像描述](https://i.stack.imgur.com/GtcJO.png)](https://i.stack.imgur.com/GtcJO.png)

让我们`child-tree`在我们的`Tree`.

[![在此处输入图像描述](https://i.stack.imgur.com/ggFON.png)](https://i.stack.imgur.com/ggFON.png)

这里`Child`继承`prototype`自 Tree，我们在这里所做的是使用`Object.create()`方法根据您传递的内容创建一个新对象，这里是`Tree.prototype`. 在这种情况下，我们所做的是将 Child 的原型设置为一个看起来与`Tree`原型相同的新对象。接下来我们设置`Child's constructor to Child`，如果我们不这样做，它将指向`Tree()`。

[![在此处输入图像描述](https://i.stack.imgur.com/yiZcY.png)](https://i.stack.imgur.com/yiZcY.png)

`Child`现在有它自己的`prototype`，它的`__proto__`分到`Tree`和`Tree's prototype`分到基地`Object`。

```
Child  
|
 \
  \
   Tree.prototype
   - branch
   |
   |
    \
     \
      Object.prototype
      -toString
      -valueOf
      -etc., etc. 
```

现在您创建一个`instance`of`Child`并调用`branch`它最初在`Tree`. 我们实际上还没有`branch`在`Child prototype`. 但是，在`Root prototype`其中 Child 继承自。

[![在此处输入图像描述](https://i.stack.imgur.com/k6BNb.png)](https://i.stack.imgur.com/k6BNb.png)

**在 JS 中，一切都不是对象，一切都可以像对象一样。**

`Javascript`有原语`strings, number, booleans, undefined, null.`他们不是`object(i.e reference types)`，但肯定可以像一个`object`. 让我们看一个例子。

[![在此处输入图像描述](https://i.stack.imgur.com/WVjiv.png)](https://i.stack.imgur.com/WVjiv.png)

在此清单的第一行中，`primitive`为 name 分配了一个字符串值。第二行将 name 视为 an并使用点表示法进行`object`调用。`charAt(0)`

这就是幕后发生的事情： //`JavaScript`引擎做了什么

[![在此处输入图像描述](https://i.stack.imgur.com/l6MHc.png)](https://i.stack.imgur.com/l6MHc.png)

`String object`仅在一个语句被销毁之前存在（一个称为 的过程）`autoboxing`。让我们再次回到我们的`prototypal` `inheritance`.

*   `Javascript`支持通过`delegation`基于 `prototypes`.
*   每个`Function`都有一个`prototype`属性，它引用另一个对象。
*   `properties/functions`如果不存在，则从`object`自身或通过 链查找`prototype`

`prototype`JS 中的A是`yields`您对另一个`object`. **[即..委派]** `Delegation`意味着如果你不能做某事，你会告诉别人为你做。

[![在此处输入图像描述](https://i.stack.imgur.com/W0NUA.png)](https://i.stack.imgur.com/W0NUA.png)

[https://jsfiddle.net/say0tzpL/1/](https://jsfiddle.net/say0tzpL/1/)

如果您查看上面的小提琴，dog 可以访问`toString`方法，但它在其中不可用，但可以通过委托给的原型链获得`Object.prototype`

[![在此处输入图像描述](https://i.stack.imgur.com/lWILf.png)](https://i.stack.imgur.com/lWILf.png)

如果您查看下面的内容，我们正在尝试访问`call`每个`function`.

[![在此处输入图像描述](https://i.stack.imgur.com/iF4RN.png)](https://i.stack.imgur.com/iF4RN.png)

[https://jsfiddle.net/rknffckc/](https://jsfiddle.net/rknffckc/)

如果您查看上面的小提琴，`Profile`Function 可以访问`call`方法，但它在其中不可用，但可以通过委托给的原型链获得`Function.prototype`

[![在此处输入图像描述](https://i.stack.imgur.com/Mijkj.png)](https://i.stack.imgur.com/Mijkj.png)

**注意：** `prototype`是函数构造函数的属性，而`__proto__`是从函数构造函数构造的对象的属性。每个函数都带有一个`prototype`值为空的属性`object`。当我们创建函数的实例时，我们会得到一个内部属性`[[Prototype]]`，或者`__proto__`它的引用是 Function 的原型`constructor`。

[![在此处输入图像描述](https://i.stack.imgur.com/HvzDP.png)](https://i.stack.imgur.com/HvzDP.png)

上图看起来有点复杂，但可以全面了解其`prototype chaining`工作原理。让我们慢慢来看看：

有两个实例`b1`and `b2`，其构造函数是`Bar`and parent 是 Foo 并且有来自原型链`identify`和`speak`via `Bar`and的两个方法`Foo`

[![在此处输入图像描述](https://i.stack.imgur.com/EllEL.png)](https://i.stack.imgur.com/EllEL.png)

[https://jsfiddle.net/kbp7jr7n/](https://jsfiddle.net/kbp7jr7n/)

如果您查看上面的代码，我们有`Foo`具有方法的构造函数`identify()`和`Bar`具有`speak`方法的构造函数。我们创建了两个`Bar`实例`b1`，`b2`其父类型为`Foo`. 现在在调用`speak`的方法时`Bar`，我们可以通过`prototype`链识别谁在调用说话。

[![在此处输入图像描述](https://i.stack.imgur.com/V7fH7.png)](https://i.stack.imgur.com/V7fH7.png)

`Bar`现在拥有`Foo`在其`prototype`. 让我们进一步深入了解它们之间的关系`Object.prototype`以及`Function.prototype`它们之间的关系。如果您查找 , 的构造函数`Foo`，`Bar`并且`Object`是`Function constructor`。

[![在此处输入图像描述](https://i.stack.imgur.com/wzzRu.png)](https://i.stack.imgur.com/wzzRu.png)

`prototype`of `Bar`is , of is`Foo`和如果你仔细观察 the of是相关的。`prototype``Foo``Object``prototype``Foo``Object.prototype`

[![在此处输入图像描述](https://i.stack.imgur.com/wEOxo.png)](https://i.stack.imgur.com/wEOxo.png)

在我们关闭它之前，让我们在这里用一小段代码来**总结上面的所有内容**。我们在`instanceof`这里使用运算符来检查链中是否`object`具有a 的属性，下面总结了整个大图。`prototype``prototype``constructor`

[![在此处输入图像描述](https://i.stack.imgur.com/n84uV.png)](https://i.stack.imgur.com/n84uV.png)

我希望这个添加的一些信息，我知道这可能很容易掌握......简而言之**，它只是链接到对象的对象！！！！**

* * *

## 回答 #11

> 赞同：25
> 
> 时间：2017-03-18T22:06:12.783

将原型链分为两类可能会有所帮助。

考虑构造函数：

```
 function Person() {} 
```

的值`Object.getPrototypeOf(Person)`是一个函数。事实上，它是`Function.prototype`。由于`Person`是作为函数创建的，因此它与所有函数共享相同的原型函数对象。它与 相同`Person.__proto__`，但不应使用该属性。无论如何，随着`Object.getPrototypeOf(Person)`你有效地走上所谓的原型链的阶梯。

向上的链条如下所示：

    `Person`→ `Function.prototype`→ `Object.prototype`（终点）

`Person`重要的是这个原型链与可以*构造*的对象关系不大。这些构造的对象有自己的原型链，并且这个链可能没有与上面提到的相同的近亲。

以这个对象为例：

```
var p = new Person(); 
```

*p*与*Person*没有直接的原型链关系。他们的关系是不同的。对象*p*有自己的原型链。使用`Object.getPrototypeOf`，您会发现链条如下：

    `p`→ `Person.prototype`→ `Object.prototype`（终点）

此链中没有函数对象（尽管可能如此）。

所以`Person`似乎与两种锁链有关，它们过着自己的生活。要从一条链“跳转”到另一条链，请使用：

1.  `.prototype`：从构造函数的链跳转到创建对象的链。因此，此属性仅针对函数对象定义（因为`new`只能在函数上使用）。

2.  `.constructor`：从创建对象的链跳转到构造函数的链。

这是所涉及的两个原型链的可视化演示，以列表示：

[![在此处输入图像描述](https://i.stack.imgur.com/FPPdI.png)](https://i.stack.imgur.com/FPPdI.png)

总结一下：

> 该`prototype`属性不提供*主体*原型链的信息，而是提供主体*创建*的对象的信息。

毫不奇怪，物业的名称`prototype`会导致混淆。`prototypeOfConstructedInstances`如果这个属性被命名或类似的东西，它可能会更清楚。

你可以在两个原型链之间来回跳转：

```
Person.prototype.constructor === Person 
```

这种对称性可以通过显式地为`prototype`属性分配不同的对象来打破（稍后会详细介绍）。

### 创建一个函数，获取两个对象

`Person.prototype`是在创建函数的`Person`同时创建的对象。它具有`Person`构造函数，即使该构造函数实际上还没有执行。所以同时创建了两个对象：

1.  函数`Person`本身
2.  当函数被作为构造函数调用时将作为原型的对象

两者都是对象，但它们有不同的作用：函数对象*构造*，而另一个对象代表函数将构造的任何对象的原型。原型对象将成为其原型链中构造对象的父对象。

由于函数也是一个对象，它在自己的原型链中也有自己的父级，但请记住，这两个链是关于不同事物的。

这里有一些可以帮助理解问题的等式——所有这些都打印出来`true`：

```
function Person() {};

// This is prototype chain info for the constructor (the function object):
console.log(Object.getPrototypeOf(Person) === Function.prototype);
// Step further up in the same hierarchy:
console.log(Object.getPrototypeOf(Function.prototype) === Object.prototype);
console.log(Object.getPrototypeOf(Object.prototype) === null);
console.log(Person.__proto__ === Function.prototype);
// Here we swap lanes, and look at the constructor of the constructor
console.log(Person.constructor === Function);
console.log(Person instanceof Function);

// Person.prototype was created by Person (at the time of its creation)
// Here we swap lanes back and forth:
console.log(Person.prototype.constructor === Person);
// Although it is not an instance of it:
console.log(!(Person.prototype instanceof Person));
// Instances are objects created by the constructor:
var p = new Person();
// Similarly to what was shown for the constructor, here we have
// the same for the object created by the constructor:
console.log(Object.getPrototypeOf(p) === Person.prototype);
console.log(p.__proto__ === Person.prototype);
// Here we swap lanes, and look at the constructor
console.log(p.constructor === Person);
console.log(p instanceof Person);
```

### 向原型链添加关卡

尽管在创建构造函数时会创建原型对象，但您可以忽略该对象，并分配另一个对象，该对象应用作该构造函数创建的任何后续实例的原型。

例如：

```
function Thief() { }
var p = new Person();
Thief.prototype = p; // this determines the prototype for any new Thief objects:
var t = new Thief(); 
```

现在*t的原型链比**p*的原型链长一步：

    `t`→ `p`→ `Person.prototype`→ `Object.prototype`（终点）

另一个原型链不再：`Thief`并且`Person`兄弟姐妹在其原型链中共享相同的父级：

    `Person`}
    `Thief`  } → `Function.prototype`→ `Object.prototype`（终点）

然后可以将先前呈现的图形扩展到此（`Thief.prototype`省略原始图形）：

[![在此处输入图像描述](https://i.stack.imgur.com/m5DXc.png)](https://i.stack.imgur.com/m5DXc.png)

蓝线代表原型链，其他彩色线代表其他关系：

*   对象与其构造函数之间
*   在构造函数和将用于构造对象的原型对象之间

* * *

## 回答 #12

> 赞同：22
> 
> 时间：2009-02-21T12:37:38.370

> 这个“.prototype”属性的确切目的是什么？

标准类的接口变得可扩展。例如，您正在使用`Array`该类，并且您还需要为所有数组对象添加自定义序列化程序。您会花时间编写子类，还是使用组合或......原型属性通过让用户控制类可用的成员/方法的确切集合来解决这个问题。

将原型视为一个额外的 vtable 指针。当原始类中缺少某些成员时，会在运行时查找原型。

* * *

## 回答 #13

> 赞同：20
> 
> 时间：2016-02-18T15:17:09.760

[The Definitive Guide to Object-Oriented JavaScript](https://www.youtube.com/watch?v=PMfcsYzj-9M) - 一个非常简洁明了的约 30 分钟视频解释了所提问题（原型继承主题从[5:45](https://youtu.be/PMfcsYzj-9M?t=344)开始，尽管我宁愿听整个视频）。该视频的作者还制作了 JavaScript 对象可视化网站[http://www.objectplayground.com/](http://www.objectplayground.com/)。[![在此处输入图像描述](https://i.stack.imgur.com/Vf4qR.jpg)](https://i.stack.imgur.com/Vf4qR.jpg) [![在此处输入图像描述](https://i.stack.imgur.com/xcRpT.jpg)](https://i.stack.imgur.com/xcRpT.jpg)

* * *

## 回答 #14

> 赞同：16
> 
> 时间：2013-10-20T22:46:17.100

`obj_n.prop_X`我发现在被引用时将“原型链”解释为递归约定很有帮助：

如果`obj_n.prop_X`不存在，请检查`obj_n+1.prop_X`在哪里`obj_n+1 = obj_n.[[prototype]]`

如果`prop_X`最终在第 k 个原型对象中找到

`obj_1.prop_X = obj_1.[[prototype]].[[prototype]]..(k-times)..[[prototype]].prop_X`

您可以在此处通过属性找到 Javascript 对象的关系图：

![js对象图](https://i.stack.imgur.com/2tGyY.jpg)

[http://jsobjects.org](http://jsobjects.org)

* * *

## 回答 #15

> 赞同：14
> 
> 时间：2010-02-05T18:42:10.047

当构造函数创建一个对象时，该对象隐式引用构造函数的“原型”属性以解析属性引用。构造函数的“原型”属性可以被程序表达式constructor.prototype引用，并且添加到对象原型的属性通过继承被共享原型的所有对象共享。

* * *

## 回答 #16

> 赞同：12
> 
> 时间：2017-12-13T10:10:21.180

这里有两个不同但相关的实体需要解释：

*   函数的`.prototype`属性。
*   所有对象^(^([2]))的`[[Prototype]]`^(^([1]))属性。

这是两个不同的东西。

## 物业`[[Prototype]]`：

这是一个存在于所有^(^([2]))对象上的属性。

这里存储的是另一个对象，作为一个对象本身，它有一个`[[Prototype]]`指向另一个对象的自己的对象。另一个对象有`[[Prototype]]`它自己的一个。这个故事一直持续到您到达提供可在所有对象上访问的方法的原型对象（如[`.toString`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/toString)）。

`[[Prototype]]`财产是构成`[[Prototype]]`链条的一部分。`[[Prototype]]`例如，当对对象执行操作`[[Get]]`或`[[Set]]`操作时，会检查此对象链：

```
var obj = {}
obj.a         // [[Get]] consults prototype chain
obj.b = 20    // [[Set]] consults prototype chain 
```

## 物业`.prototype`：

*这是一个仅在函数上才有的属性。*使用一个非常简单的函数：

```
function Bar(){}; 
```

该`.prototype`属性*包含一个对象*`b.[[Prototype]]`，当您执行此操作时将分配给该对象`var b = new Bar`。你可以很容易地检查这个：

```
// Both assign Bar.prototype to b1/b2[[Prototype]]
var b = new Bar;
// Object.getPrototypeOf grabs the objects [[Prototype]]
console.log(Object.getPrototypeOf(b) === Bar.prototype) // true 
```

最重要`.prototype`的 s[之一是`Object`function](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/prototype)。`[[Prototype]]`这个原型包含所有链包含的原型对象。在它上面，定义了新对象的所有可用方法：

```
// Get properties that are defined on this object
console.log(Object.getOwnPropertyDescriptors(Object.prototype)) 
```

现在，既然`.prototype`是一个对象，它就有一个`[[Prototype]]`属性。当您不对 进行任何分配时`Function.prototype`，`.prototype`'`[[Prototype]]`指向原型对象 ( `Object.prototype`)。每当您创建新函数时，都会自动执行此操作。

这样，每当您`new Bar;`为您设置原型链时，您都会得到定义的所有内容`Bar.prototype`和定义的所有内容`Object.prototype`：

```
var b = new Bar;
// Get all Bar.prototype properties
console.log(b.__proto__ === Bar.prototype)
// Get all Object.prototype properties
console.log(b.__proto__.__proto__ === Object.prototype) 
```

当您*对所做*的一切进行分配时，`Function.prototype`您所做的就是扩展原型链以包含另一个对象。这就像在单链表中的插入。

这基本上改变了`[[Prototype]]`链，允许在分配给的对象上定义的属性被`Function.prototype`函数创建的任何对象看到。

* * *

^([1：这不会让任何人感到困惑；在许多实现中通过[该`__proto__`属性可用。](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/proto))
^([2]：除[`null`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/null).)

* * *

## 回答 #17

> 赞同：10
> 
> 时间：2014-11-09T15:47:38.523

让我告诉你我对原型的理解。我不打算将这里的继承与其他语言进行比较。我希望人们停止比较语言，而只理解语言本身。了解原型和原型继承是如此简单，我将在下面向您展示。

原型就像一个模型，您可以根据它创建产品。要理解的关键点是，当您使用另一个对象作为原型创建对象时，原型和产品之间的联系是永恒的。例如：

```
var model = {x:2};
var product = Object.create(model);
model.y = 5;
product.y
=>5 
```

每个对象都包含一个称为 [[prototype]] 的内部属性，该属性可以被`Object.getPrototypeOf()`函数访问。`Object.create(model)`创建一个新对象并将其 [[prototype]] 属性设置为对象**模型**。因此，当您这样做时`Object.getPrototypeOf(product)`，您将获得对象**模型**。

**产品**中的属性按以下方式处理：

*   当访问一个属性以读取它的值时，它会在作用域链中查找。对变量的搜索从**产品**向上开始到它的原型。如果在搜索中找到这样的变量，则搜索将在此处停止，并返回该值。如果在作用域链中找不到这样的变量，则返回 undefined。
*   写入（更改）属性时，始终将属性写入**产品**对象。如果**产品**还没有这样的属性，它会被隐式创建和写入。

这种使用原型属性的对象链接称为原型继承。就这么简单，同意吗？

* * *

## 回答 #18

> 赞同：10
> 
> 时间：2015-10-24T21:21:40.537

另一种尝试用更好的图片来解释[JavaScript 基于原型的继承](https://github.com/rus0000/jsinheritance)

[![简单对象继承](https://i.stack.imgur.com/6gEKe.png)](https://github.com/rus0000/jsinheritance)

* * *

## 回答 #19

> 赞同：10
> 
> 时间：2016-03-11T19:24:36.867

考虑以下`keyValueStore`对象：

```
var keyValueStore = (function() {
    var count = 0;
    var kvs = function() {
        count++;
        this.data = {};
        this.get = function(key) { return this.data[key]; };
        this.set = function(key, value) { this.data[key] = value; };
        this.delete = function(key) { delete this.data[key]; };
        this.getLength = function() {
            var l = 0;
            for (p in this.data) l++;
            return l;
        }
    };

    return  { // Singleton public properties
        'create' : function() { return new kvs(); },
        'count' : function() { return count; }
    };
})(); 
```

我可以通过这样做来创建这个对象的一个​​新实例：

```
kvs = keyValueStore.create(); 
```

此对象的每个实例都将具有以下公共属性：

*   `data`
*   `get`
*   `set`
*   `delete`
*   `getLength`

现在，假设我们创建了这个`keyValueStore`对象的 100 个实例。尽管`get`, `set`, `delete`,`getLength`将对这 100 个实例中的每一个执行完全相同的操作，但每个实例都有自己的此函数副本。

现在，想象一下，如果您只有一个`get`、和副本`set`，并且每个实例都将引用相同的函数。这对性能会更好，并且需要更少的内存。`delete``getLength`

这就是原型的用武之地。原型是继承但不被实例复制的属性的“蓝图”。所以这意味着对于一个对象的所有实例，它在内存中只存在一次，并且由所有这些实例共享。

现在，`keyValueStore`再次考虑对象。我可以这样重写它：

```
var keyValueStore = (function() {
    var count = 0;
    var kvs = function() {
        count++;
        this.data = {};
    };

    kvs.prototype = {
        'get' : function(key) { return this.data[key]; },
        'set' : function(key, value) { this.data[key] = value; },
        'delete' : function(key) { delete this.data[key]; },
        'getLength' : function() {
            var l = 0;
            for (p in this.data) l++;
            return l;
        }
    };

    return  {
        'create' : function() { return new kvs(); },
        'count' : function() { return count; }
    };
})(); 
```

这与之前版本的`keyValueStore`对象完全相同，只是它的所有方法现在都放在原型中。这意味着，所有 100 个实例现在都共享这四种方法，而不是每个都有自己的副本。

* * *

## 回答 #20

> 赞同：9
> 
> 时间：2018-08-18T10:24:20.757

## 概括：

*   函数是 javascript 中的对象，因此可以具有属性
*   （构造函数）函数**始终**具有原型属性
*   当一个函数被用作带有`new`关键字的构造函数时，对象得到原型。可以`__proto__`在新创建的对象的属性上找到对此原型的引用。
*   该`__proto__`属性是指`prototype`构造函数的属性。

## 例子：

```
function Person (name) {
  this.name = name;
}

let me = new Person('willem');

console.log(Person.prototype) // Person has a prototype property

console.log(Person.prototype === me.__proto__) // the __proto__ property of the instance refers to prototype property of the function.
```

## 为什么这很有用：

Javascript 在查找对象的属性时有一种称为**“原型继承”的**机制，基本上是这样的：

*   首先检查属性是否位于对象本身上。如果是这样，则返回此属性。
*   如果该属性不在对象本身上，它将“爬上原型链”。它基本上着眼于由**proto**属性引用的对象。它在那里检查该属性是否在**proto引用的对象上可用**
*   如果属性不在**proto**对象上，它将沿着**proto**链一直向上爬到 Object 对象。
*   如果它在对象及其原型链上找不到属性，它将返回未定义。

**例如：**

```
function Person(name) {
  this.name = name;
}

let mySelf = new Person('Willem');

console.log(mySelf.__proto__ === Person.prototype);

console.log(mySelf.__proto__.__proto__ === Object.prototype);
```

**更新：**

该 `__proto__`属性已被弃用，尽管它在大多数现代浏览器中实现，但获取原型对象引用的更好方法是：

`Object.getPrototypeOf()`

* * *

## 回答 #21

> 赞同：7
> 
> 时间：2017-05-26T10:24:07.890

在理解这类东西时，我总是喜欢类比。在我看来，与 class bass 继承相比，“原型继承”相当令人困惑，尽管原型是更简单的范例。事实上，原型确实没有继承，所以这个名字本身就具有误导性，它更像是一种“委托”。

想象一下这个......

你在上高中，你在课堂上，有一个今天到期的测验，但你没有笔来填写你的答案。嗬！

你坐在你的朋友 Finnius 旁边，他可能有一支笔。你问，他没有成功地环顾他的办公桌，但他没有说“我没有笔”，而是和他的另一个朋友 Derp 一起检查他是否有笔。Derp 确实有一支备用笔并将其传回给 Finnius，后者将其传递给您以完成您的测验。Derp 将笔委托给 Finnius，Finnius 将笔委托给您使用。

这里重要的是 Derp 不会把笔给你，因为你和他没有直接的*关系*。

这是原型如何工作的简化示例，在其中搜索数据树以查找您要查找的内容。

* * *

## 回答 #22

> 赞同：3
> 
> 时间：2018-08-02T06:16:03.780

另一个显示**__proto__**、**原型**和**构造函数**关系的方案： [![在此处输入图像描述](https://i.stack.imgur.com/uy5ce.png)](https://i.stack.imgur.com/uy5ce.png)

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2018-02-01T09:33:06.533

只是你已经有了一个对象，`Object.new`但是在使用构造函数语法时你仍然没有一个对象。

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2019-01-21T08:45:21.703

> 重要的是要了解对象的原型（可通过`Object.getPrototypeOf(obj)`或通过已弃用`__proto__`的属性获得）和`prototype`构造函数的属性之间的区别。前者是每个实例的属性，后者是构造函数的属性。也就是说，`Object.getPrototypeOf(new Foobar())`指的是与 相同的对象`Foobar.prototype`。

参考：[https ://developer.mozilla.org/en-US/docs/Learn/JavaScript/Objects/Object_prototypes](https://developer.mozilla.org/en-US/docs/Learn/JavaScript/Objects/Object_prototypes)

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2018-12-25T07:24:12.527

**Prototype**通过克隆现有**对象**来创建**新**对象。所以当我们考虑原型时，我们真的可以考虑**克隆或**复制某些东西，而不是虚构它。

 ***** * *

## 回答 #26

> 赞同：0
> 
> 时间：2020-09-23T16:16:33.533

如果您想从基础知识中了解原型和基于原型的继承的概念，请查看官方[MDN](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Inheritance_and_the_prototype_chain)文档，他们对此进行了很好的解释。

[https://developer.mozilla.org/en-US/docs/Web/JavaScript/Inheritance_and_the_prototype_chain](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Inheritance_and_the_prototype_chain)

> 在继承方面，JavaScript 只有一种构造：对象。每个对象都有一个私有属性，该属性保存到另一个对象的链接，称为其原型。该原型对象有自己的原型，依此类推，直到到达一个对象，其原型为 null。根据定义，null 没有原型，是这个原型链中的最后一环。

此外，这是另一个很好的资源，它使用简单的示例进行解释 - [https://developer.mozilla.org/en-US/docs/Learn/JavaScript/Objects/Object_prototypes](https://developer.mozilla.org/en-US/docs/Learn/JavaScript/Objects/Object_prototypes)

# php - 在另一个应用程序中更改 _Session 的值

> ID：572910
> 
> 赞同：0
> 
> 时间：2009-02-21T12:40:15.197
> 
> 标签：php, session

是否可以在 PhP 中修改超级全局数组[_Session](http://www.php.net/session)中的值？假设 _Session 正在写入文件。

我问这个的原因是因为我有两个应用程序，前端和后端。后端使用 _Session 对象内部的一些变量，前端必须能够修改这些值，以便它可以与后端通信。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-21T13:39:20.233

如果两个应用程序共享一个 PHP 会话，那么每个应用程序都可以愉快地修改`$_SESSION`.

为此，您需要确保两个应用程序都将会话存储在同一位置，并且：

*   两者都在同一个域上，并且 cookie 路径没有改变，例如使用`session_set_cookie_params()`.

或者

*   `session_id('back-end SessionId here')`在调用之前 ，您知道“后端”应用程序和“前端”应用程序调用的 sessionid `session_start()`。这两个应用程序应该具有相同的会话。然后，前端应用程序将丢失它在其原始会话中到目前为止已经存储的所有数据。

无论哪种方式，通过共享会话数据进行通信的两个应用程序似乎都不是一个好的解决方案

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-21T12:42:23.523

$_SESSION 与 $_POST 和 $_GET 一样可修改，只要知道写入 $_SESSION 然后进行标头重定向是行不通的，因为没有写入会话值。

# java - 小程序为空，具有绝对布局

> ID：572917
> 
> 赞同：1
> 
> 时间：2009-02-21T12:43:49.493
> 
> 标签：java, browser, netbeans, applet

我想创建一个作为小程序的刽子手游戏，所以我有一些标签和按钮，这些标签和按钮将由 gui 设计器生成的代码初始化，但我也有一些我自己创建的标签，在知道我的话有多长之后。因此我为我的小程序使用绝对布局。

在netbeans中，当我运行它时，我的小程序可以正常工作，但是当我尝试在浏览器中运行它时（我尝试过Firefox和IE），显示屏上什么也没有，小程序是空的。

有人可以帮我吗？

如果有帮助，您可以在这里找到源代码 [http://root.xelluloid.de/Hedgeman/Hedgeman.java](http://root.xelluloid.de/Hedgeman/Hedgeman.java)

亲切的问候

塞巴斯蒂安

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-21T15:40:42.267

您是否查看过浏览器的 Java 控制台？它可能包含说明程序由于找不到 AbsoluteLayout 类而崩溃的内容。

这适用于旧版本的 NetBeans，但同样适用： http: [//forums.sun.com/thread.jspa?threadID=597783](http://forums.sun.com/thread.jspa?threadID=597783)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-01-23T09:51:20.233

`AbsoluteLayout`我刚刚在使用 applet和 netbeans 7.1时遇到了同样的问题。

一切正常，但是当小程序从浏览器运行时会引发错误。

我通过在表单设计器中从“自由设计”切换`AbsoluteLayout`到“自由设计”（这似乎默认`GroupLayout`在实际生成的代码中）解决了这个问题，但提供了类似的功能（小部件可以不受限制、无边界地放置，甚至可以放置在其他）。

您可能会将 AbsoluteLayout 类/jar 包含到您的项目中并继续使用此代码。但在我的情况下，代码不能超过 32KB，并且需要自包含（单个文件），因为它需要上传到小型[嵌入式设备](http://www.newark.com/advantech/adam-6060-be/i-o-module/dp/53M6172)。

# java - 为什么首先要使用 EventDispatchThread？

> ID：572921
> 
> 赞同：1
> 
> 时间：2009-02-21T12:45:51.160
> 
> 标签：java, swing, edt

这是我不明白的设计决定。

Android 和 JME 都遵循启动应用程序的线程是 UI 线程的策略，并且您注意将消耗资源的东西卸载到另一个线程。

另一方面，在 Swing 中，您`EventQueue.invokeLater(Runnable)`用于 UI 和`SwingWorker`后台处理。

现在，主线程是做什么用的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-21T13:02:59.887

正如[这篇关于线程的 Sun 文章](http://java.sun.com/products/jfc/tsc/articles/threads/threads1.html)中所提到的，您可以在主线程中做任何您想做的事情，包括构建 GUI，即使这样做是有风险的。

*   Swing 方法不是线程安全的，但只要没有实现任何组件（Swing 或其他）（这意味着组件的 paint() 方法已经或可能被调用），直到 2004 年都可以。
*   [自 2004 年以来，正如在这个SO 问题](https://stackoverflow.com/questions/491323)中所提醒的那样，[必须在 EDT中***创建***](http://netzwerg.ch/2007/06/threads-and-swing.html)GUI 。

回到问题：

Swing 尚未使用仅与 GUI 相关的主线程实现，因为这将强制采用纯多线程方法，并且：

*   **组件开发人员不必对线程编程有深入的了解**：所有组件都必须完全支持多线程访问的工具包可能难以扩展，特别是对于不擅长线程编程的开发人员而言。

*   **事件以可预测的顺序分派**：排队的可运行对象`invokeLater()`与鼠标和键盘事件、计时器事件和绘制请求从相同的事件队列分派。
    *在组件支持多线程访问的工具包中，组件更改与线程调度程序一时兴起的事件处理交错*。这使得全面测试变得困难或不可能。

*   **更少的开销**：试图仔细锁定关键部分的工具包可能会花费大量时间和空间来管理锁。
    每当工具包调用可能在客户端代码中实现的方法（例如，公共类中的任何公共或受保护方法）时，工具包必须保存其状态并释放所有锁，以便客户端代码可以在必要时获取锁。
    当控制从方法返回时，工具包必须重新获取它的锁并恢复它的状态。所有应用程序都承担此费用，即使大多数应用程序不需要同时访问 GUI。

因此主线程可用于***初始化***（数据和 GUI，只要它们不花费太多时间），而大多数***初始化后的 GUI 步骤***自然发生在事件调度线程中。
一旦 GUI 可见，大多数程序都是由事件驱动的，例如按钮操作或鼠标点击，这些事件总是在事件调度线程中处理。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-21T18:53:27.890

启动器`java`不是 Swing（或 AWT）特定的。`main`是一个通用的入口点。AWT 调用后会按需启动 Event Dispatch Thread `main`，所以不能使用主线程。它甚至可以退出 EDT 并开始一个新的。

奇怪的是，在 AWT EDT 上不调用 applet 生命周期方法。

主线程只是为执行`main`方法而创建的线程。

# jquery-plugins - 使用 jquery 重新排列 div 层次结构

> ID：572925
> 
> 赞同：0
> 
> 时间：2009-02-21T12:49:56.657
> 
> 标签：jquery-plugins, jquery

我正在使用 jQuery 的[表单插件](http://malsup.com/jquery/form/#getting-started)异步提交表单。服务器通过设置 ajaxForm 调用的目标将 HTML 发送回 div #boardcontainer。这工作正常。

```
...
    var options = { 
      target:        '#boardcontainer',    // target element(s) to be updated with server response 
      beforeSubmit:  showRequest,  // pre-submit callback 
      success:       showResponse  // post-submit callback 
      };
    $('#myForm').ajaxForm(options); 
... 
```

问题是，从服务器返回的 HTML 包含两个 div：

```
<div id="board">
...
</div>
<div id="status">
...
</div> 
```

“#board”是一个由服务器预渲染的巨大 HTML 表格。“#status”是一条短消息，理想情况下应该进入#boardcontainer 以外的div。

处理这种情况的最佳方法是什么？jquery可以更改div的父级吗？如果是这样，我可以在提交后回调中更改父级，但我似乎找不到方法来做到这一点。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-21T13:04:38.260

在您的成功回调中，您可以使用 appendTo 重新排列 div。或者，您可以返回 json 并在成功回调中构建 div。

```
 $('#status').appendTo('#realTarget'); 
```

**编辑**：检查后，appendTo 本身会执行您需要它执行的操作，而不会丢失事件处理程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-21T17:32:36.413

我最终用 json 构建了 div（不过，div 的 html 嵌入为字符串）

这是代码：

```
$(document).ready(function () {
    var options = {
        beforeSubmit: showRequest,  // pre-submit callback 
        success: showResponse,  // post-submit callback 
        dataType: 'json'
    };
    $('#myForm').ajaxForm(options);
});

function showResponse(data) {
    $('#statusTarget').html(data.status);
    $('#boardcontainer').html(data.board);
}; 
```

它可以工作，每次提交表单时，#statusTarget 和 #boardTarget 都会被新的 html 替换。

# jquery - 在 jQuery 中向上遍历 9 个级别

> ID：572926
> 
> 赞同：2
> 
> 时间：2009-02-21T12:52:54.683
> 
> 标签：jquery, traversal

在href标签上发生点击事件，我需要引用9级以上的a类，

所以：

```
<div class="blah" id="234">
 <div>
     <div>
        <div>
          <div>
            <div>
             <div><a href=""></a> 
```

我知道的唯一方法是调用 parent() 9 次，我还能做什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-21T13:01:20.497

您可以通过父母功能提供选择器

```
$(a).click(function() {
   var theIdIs = $(this).parents("div.blah").attr("id");
}); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-21T15:49:21.920

此外，如果您使用 jQuery 1.3+，您可以使用[最接近](http://docs.jquery.com/Traversing/closest)的方法

```
$('a').click(function() {
   if ($(this).closest("div.blah").hasClass("blah"))
   {
      // Do something with it
   }
}); 
```

# operating-system - 对于 Web 开发，您更喜欢哪种 O/S，为什么？

> ID：572936
> 
> 赞同：11
> 
> 时间：2009-02-21T13:00:45.710
> 
> 标签：operating-system, development-environment

在操作系统选择方面，我认为自己相当多才多艺。我一生都在使用 DOS/Windows PC，两年前将我的主要笔记本电脑换成了 Mac，并且在学习 Comp.Sci 时使用了多种 Unix/Linux/BSD。程度。

但是，当我试图改善我的开发环境时，我开始怀疑是否最好将 Macbook 报废为具有不同 O/S 风格的 PC（以支持不同的工具和 IDE 集） .

**对于（Web）开发，您更喜欢哪种 O/S，为什么？**（更喜欢在多个平台上具有实际编码经验的人的答案）

（*注意：我知道[这个](https://stackoverflow.com/questions/58463/preferred-operating-system-for-web-programmers-client-or-server)讨论客户端与服务器 O/S 的问题 - 我感兴趣的是整个开发环境，而不仅限于“Windows 人群”*）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-21T13:10:37.527

这实际上取决于您想要进行的 Web 开发类型。如果您正在使用 PHP（或 LAMP、Perl、Python、Ruby），那么 Linux 可能是最好的选择。如果您正在考虑进行 .Net 开发，那么 Windows 将是您的最佳选择。我认为如果您使用的是 Java，那么 Windows 或 Linux 会同样好。

对于 Linux 上的 LAMP 开发，您最好使用 Netbeans 或 Eclipse 作为您的 IDE。我个人更喜欢 Netbeans，但这取决于您更喜欢哪个。如果您想为 IDE 付费，Zend 是更好的选择之一。就发行版而言，任何流行的发行版都应该没问题。我听说 Ubuntu 很受欢迎，虽然我个人最喜欢的是 Mandriva。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-21T13:04:15.140

您无需报废您的 Macbook 即可使用不同的操作系统。许多开发人员在不放弃 Macbook 体验的情况下运行多个操作系统。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-21T13:51:20.813

我更喜欢我的 Macbook 并且鄙视我必须去工作并使用 Windows 环境的事实（我一直按 ALT 键寻找命令！）。Ruby 和 Rails 开发更容易，因为大多数开发人员都使用 OSX，因此您需要的任何帮助都是针对您的开发环境量身定制的，它在 Windows 上的运行速度不那么顺畅或那么快。

我在工作环境（Emacs、IntelliJ 等）中没有遇到任何我无法在 Mac 上获得的东西，它甚至看起来好多了。Ubuntu 甚至比我用过的任何 Windows 系统看起来都更好，而且更可靠。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-21T13:47:16.160

如果您被锁定在 .Net 世界中，那么 Windows 确实是唯一的选择。

否则，“大牌”Web 环境（Apache、Tomcat、Spring、Glassfish、Rails、JBoss、Grails、Weblogic 等）通常都部署在某种风格的 *nix 上。一台基于 Linux 的笔记本电脑可以让你获得最大的极客信誉；OSX 为您提供了一个成熟的 Unix 环境，具有非常精美的 UI 和较少的自己动手维护。

如果您正在使用 Java，那么 Eclipse、NetBeans 和 IntelliJ 将在上述所有系统（Windows、Linux、Max）上运行，因此您可以根据您希望在您的环境中拥有的其他内容进行选择。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-09-05T12:27:39.833

我有3个系统，

1.  Windows XP、Windows 7 RC、Ubuntu 9.04
2.  视窗
3.  Mac OS X

Mac OS X 将是我的选择，因为您可以获得良好的工作环境。我有 Adob​​e Create Suit 和 Textmate，它们不是免费的。免费的替代品 GIMP/Inkscape 和许多免费的文本编辑器可用于 mac。

LINUX 很好，但 Adob​​e 套装不能在上面工作，你必须使用 GIMP 和 Inkscape，显然它们与 Adob​​e Photoshop 和 Illustrator 相去甚远。虽然如果您对使用 Adob​​e CS 不感兴趣，您可以使用 Ubuntu 发行版，它比其他 LINUX 发行版更容易且安静流行，因此您在寻找解决方案时不会遇到任何问题。如果我使用 LINUX，Eclipse 将是我的文本编辑器。

Windows 是另一个不错的选择，如果您熟悉 Windows，但有丢失重要文件的风险，这需要您花费数小时来开发；-)，您知道它的主要问题是病毒和间谍软件。如果你能得到体面的反病毒软件（比如免费的 Avast 等），你就可以忍受它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-06-21T08:51:09.293

在我看来，“几乎”没有理由选择 Linux 而不是 OSX 进行 Web 开发。OSX 是 unix'ish，因此您几乎可以在 OSX 上运行几乎与在 Linux 上相同的任何服务器。

选择 OSX 的一大理由是可访问性和舒适性。我不知道有任何其他操作系统能像 OSX 那样愉快地使用。

不，我不是苹果迷。:)

# php - 如果用户在一段时间内不活动，则强制注销用户

> ID：572938
> 
> 赞同：8
> 
> 时间：2009-02-21T13:01:33.850
> 
> 标签：php, session

假设您正在做一个银行应用程序。如果用户登录到您的站点，如何检测他们的不活动状态并要求他们在一段时间内保持不活动状态时退出？此处不活动意味着他们要么切换到其他选项卡，要么不接触浏览器应用程序。

我想我可以通过在用户在我的应用程序的每个页面上进行操作时注册每个鼠标移动或键盘移动来做到这一点。但是代码会非常丑陋且难以维护。还有其他更优雅的方法吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-06-05T13:00:14.933

这是我使用的代码。它不是我的，但我确实将它修改为“完美”。

```
// Add the following into your HEAD section
var timer = 0;
function set_interval() {
  // the interval 'timer' is set as soon as the page loads
  timer = setInterval("auto_logout()", 10000);
  // the figure '10000' above indicates how many milliseconds the timer be set to.
  // Eg: to set it to 5 mins, calculate 5min = 5x60 = 300 sec = 300,000 millisec.
  // So set it to 300000
}

function reset_interval() {
  //resets the timer. The timer is reset on each of the below events:
  // 1\. mousemove   2\. mouseclick   3\. key press 4\. scroliing
  //first step: clear the existing timer

  if (timer != 0) {
    clearInterval(timer);
    timer = 0;
    // second step: implement the timer again
    timer = setInterval("auto_logout()", 10000);
    // completed the reset of the timer
  }
}

function auto_logout() {
  // this function will redirect the user to the logout script
  window.location = "your_logout_script.php";
}

// Add the following attributes into your BODY tag
onload="set_interval()"
onmousemove="reset_interval()"
onclick="reset_interval()"
onkeypress="reset_interval()"
onscroll="reset_interval()" 
```

祝你好运。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-21T13:21:42.477

如果用户定期从您的服务器请求新页面/数据，那么在 PHP 中调整会话超时应该可以解决此问题（假设您使用的是 PHP 会话）。

如果担心他们可能会在一个页面上停留很长时间而没有访问服务器（例如填写长表格），并且您想区分这和用户只是切换到另一个窗口，您可以做一些事情，比如使用 javascript 每五分钟左右使用 XMLHTTPRequest 请求一些数据，以保持会话处于活动状态。您可以使用 javascript 中的 window.focus 和 window.onblur 事件来停止和重新启动此机制（我认为 IE 存在一些差异，这里有一个很好的解释[）](http://www.thefutureoftheweb.com/blog/detect-browser-window-focus)。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-21T13:42:40.693

一种非常简单有效的方法是在 HTML HEAD 部分中放置类似的内容：

```
<META HTTP-EQUIV="refresh" CONTENT="1800;URL=logout.php?timeout"> 
```

将 logout.php?timeout 替换为适当的脚本。在上面的示例中，如果 ?timeout 在查询字符串中，我会向他们显示一个登录页面，其中包含指示他们由于不活动而被注销的信息。

将 1800 替换为您希望它们在自动注销之前保持非活动状态的时间（以秒为单位）。将此设置为与会话到期设置相同的时间。

编辑 - 另一个容易实现的机制是有一个名为 last_time 或 last_activity 的会话变量，或类似的东西，并在每次有活动时将其设置为时间戳。在我的大部分内容中，我都有一个通用的包含文件，我在其中执行此操作。在同一个文件中，您可以检查以确保它在您为活动会话设定的约束范围内。如果时间太长——只需执行 300 重定向到注销页面并在那里显示适当的不活动消息。

祝你好运！

伊恩

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2014-02-19T16:47:30.193

我们现在可以将代码改进为 jquery

* * *

```
idleTime = 0;
$(document).ready(function() {

    var idleInterval = setInterval("timerIncrement()", 60000); // 1 minute //60000
    $(this).mousemove(function(e) {
        idleTime = 0;
    });
    $(this).keypress(function(e) {
        idleTime = 0;
    });

});

function timerIncrement() {

    idleTime = idleTime + 1;

    if (idleTime >= 5) {
        window.location = $('#base_url').val() + 'home/logout_user';
    }
} 
```

* * *

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2014-06-25T22:14:25.470

[您可以使用下划线](http://underscorejs.org/#debounce)和[jquery](http://api.jquery.com/on/) javascript 库更优雅地完成它-

```
$('body').on("click mousemove keyup", _.debounce(function(){
    // logout user here
}, 1800000)) // 30 minutes inactivity 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-21T13:22:57.123

这首先取决于他们如何“登录”。服务器上的会话到期不会为您执行此操作吗？如果您真的想手动执行，那么您可以在 setTimeout 中使用一些 javascript，但这很难看

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-21T13:22:54.143

通常会话生存期用于确定用户是否登录。所以你可以在会话中设置一个代表这个状态的标志。如果它丢失（用户尚未登录或会话超时），则认为他未登录。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-22T05:15:11.593

您可以使用一些 JavaScript 每 x 分钟检查一次服务器，以查看用户上次活动的时间。不应该超过几行代码。如果用户禁用了 javascript，我还会添加元刷新。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-11-26T11:09:13.050

如果延迟小于 3000 秒或超过数十亿秒，我使用时间戳“现在”并检查每次点击，这意味着用户刚刚登录，如果不是，它将重定向到注销

```
 var time = 0;

$(document).on('click', function() {

    var now = Date.now() / 1000 | 0;

    if (now - time < 3000 || now - time > 1480000000) {
        time = now;
    } else {
        window.location.replace("http://url");
    }
}) 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2022-02-18T06:26:20.363

```
 put in header of your java  script page.. if you want to avoid the backend calls   

    Below is the snip-let under script tag : 
    <script>
          var idleTime = 0;
          function func(){
              console.log(idleTime);
                $(this).keypress(function(e) {
                    idleTime = 0;
                });
                $(this).click(function(e) {
                    idleTime = 0;
                });
                timerIncrement();
            }
          function timerIncrement() {
              console.log("timerIncrement");
              console.log(idleTime);
                idleTime = idleTime + 1;
                if (idleTime >= 1) {
                    console.log(window.location);
                    logoutcall(); //API call
                    window.location = window.location.origin+"/riskoffice_UI/Login";
                }
          }
            setInterval(func,1800000) //Runs the "func" function every second

    </script>

Update : localStorage can be use to keep idle time for the application with multiple tabs are opened. 

        // Check browser support
      if (typeof(Storage) !== "undefined") {
        // Store an item to localStorage
        localStorage.setItem("timeIdle", "0");
        console.log(localStorage.getItem("idleTime"));
        // Retrieve the added item
      } else {
        //display this message if browser does not support localStorage
        console.log("Sorry, your browser does not support Web Storage.");
      }
      function func(){
            $(this).keypress(function(e) {
                localStorage.setItem("timeIdle", "0");
            });
            $(this).click(function(e) {
                localStorage.setItem("timeIdle", "0");
            });
            timerIncrement();
        }
      function timerIncrement() {
            var timeIdle = localStorage.getItem("timeIdle");
            timeIdle = parseInt(timeIdle) + 1;
            if (timeIdle >= 1) {
                logoutCall();
                window.location = window.location.origin+"/riskoffice-ui/Login";
            }
            localStorage.setItem("timeIdle", timeIdle.toString());
      }
     setInterval(func,1800000); //Runs the "func" function every second 
```

# authentication - 从 OpenID 身份中提取用户名

> ID：572939
> 
> 赞同：3
> 
> 时间：2009-02-21T13:01:48.187
> 
> 标签：authentication, openid

我在我的网站上将 OpenID 身份验证与传统的注册/登录身份验证结合使用。当有人第一次使用 OpenID 登录时，我希望能够提取用户名以在网站上使用。

这对于一些 openid 标识符很容易 - 例如：

```
http://username.myopenid.com/
http://username.livejournal.com/
http://claimid.com/username 
```

然而，情况并非总是如此，因为任何 URL 本质上都可以用作 OpenID。

一种选择是维护上面的 URL 格式列表，我知道我可以在其中提取用户名 - 并在其他情况下自动分配用户名（可以在登录后更改）。有没有其他更灵活的方法来提取用户名？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-21T14:08:59.477

[本教程](http://cakebaker.42dh.com/2008/02/12/using-the-openid-simple-registration-extension/)似乎涵盖了您想要的内容和更多属性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-21T13:28:00.217

OpenID 有一个用于获取用户信息（如姓名、电子邮件等）的 API。如果用户允许您访问它，我只会使用该名称。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-21T13:29:07.263

由于 OpenID 是一种在 OpenID 身份验证站点之外无需用户名/密码但仅使用 URL 的身份验证，因此无法提取唯一的用户名。

我认为，从 url 猜测用户名或在无法猜测的情况下自动分配一个用户名（例如谷歌）是你能得到的最好的。对不起。

# c - “C 系统调用”和“C 库例程”有什么区别？

> ID：572942
> 
> 赞同：24
> 
> 时间：2009-02-21T13:02:20.900
> 
> 标签：c, unix, system, manpage

联机帮助页中有多个部分。其中两个是：

```
2 Unix 和 C 系统调用
3 C 程序的 C 库例程

```

例如，有[`getmntinfo(3)`](http://developer.apple.com/documentation/Darwin/Reference/ManPages/man3/getmntinfo.3.html)and [`getfsstat(2)`](http://developer.apple.com/documentation/Darwin/Reference/ManPages/man2/getfsstat.2.html)，两者看起来都在做同样的事情。什么时候应该使用 which 和有什么区别？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-02-21T13:08:07.517

系统调用是操作系统函数，就像在 UNIX 上一样，该[`malloc()`](http://linux.die.net/man/3/malloc)函数建立在系统调用之上[`sbrk()`](http://linux.die.net/man/2/sbrk)（用于调整进程内存空间的大小）。

库只是不属于操作系统的应用程序代码，通常可以在多个操作系统上使用。它们与您自己程序中的函数调用基本相同。

这条线可能有点模糊，但只是将系统调用视为内核级功能。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-11-01T05:43:11.893

常用函数库建立在系统调用接口之上，但应用程序可以免费使用两者。

系统调用就像可以访问使用内核资源的身份验证密钥。

![在此处输入图像描述](https://i.stack.imgur.com/hxNnJ.jpg)

上图来自高级 Linux 编程，有助于了解用户应用程序如何与内核交互。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-02-21T13:09:09.433

系统调用是用户级代码和内核之间的接口。C 库例程是库调用，就像任何其他库调用一样，它们只是碰巧真正普遍提供（几乎普遍）。许多标准库例程都是围绕系统调用的包装器（薄或其他），这确实会有点模糊界限。

至于使用哪一种，作为一般规则，使用最适合您需要的一种。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-02-21T14:00:25.287

手册第 2 节中描述的调用都是对系统服务的实际调用的相对较薄的包装器，这些调用会被内核捕获。手册第 3 节中描述的 C 标准库例程是客户端库函数，可能会或可能不会实际使用系统调用。

[这篇文章](https://stackoverflow.com/questions/556405/what-do-real-user-and-sys-mean-in-the-output-of-time1)描述了系统调用和内核捕获（在稍微不同的上下文中），并通过一些参考资料解释了系统调用背后的底层机制。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2013-03-24T04:45:43.310

作为一般规则，您应该始终使用 C 库版本。他们通常有包装器来处理深奥的事情，比如信号重启（如果你有要求的话）。如果您已经与库链接，则尤其如此。所有规则都有理由被打破。使用直接调用的原因，

1.  你想成为`libc`不可知论者；也许与安装程序。无论使用何种库，此类代码都可以在 Android ( [bionic](http://en.wikipedia.org/wiki/Bionic_%28software%29) )、[uClibc](http://en.wikipedia.org/wiki/Uclibc)和更传统的 glibc/eglibc 系统上运行。此外，使用包装器动态加载以创建运行时 glibc/bionic 层，从而允许双 Android/Linux 二进制文件。
2.  你需要极致的性能。尽管这可能很少见，而且很可能是被误导的。重新考虑问题可能会带来更好的性能优势，并且**不**调用系统通常是性能上的胜利，`libc`偶尔可以这样做。
3.  您正在编写一些没有库`initramfs`的`init`代码；创建更小的映像或更快地启动。
4.  您正在测试一个新的内核/平台，并且不想使用完整的文件系统使生活复杂化；非常相似`initramfs`。
5.  您希望在程序启动时快速执行某些操作，但最终希望使用`libc`例程。
6.  为了避免`libc`.
7.  该功能无法通过`libc`.

抱歉，大多数示例都是特定于 Linux 的，但原理应该适用于其他 Unix 变体。当新特性被引入内核时，最后一项是很常见的。例如，何时[`kqueue`](http://en.wikipedia.org/wiki/Kqueue)何地[`epoll`](http://en.wikipedia.org/wiki/Epoll)首次引入，没有`libc`人支持它们。如果系统具有较旧的库但较新的内核并且您希望使用此功能，也可能会发生这种情况。

如果您的进程没有使用`libc`，那么系统中的某些东西很可能会有。通过编写自己的变体，您可以通过提供两条通向同一最终目标的路径来否定缓存。此外，Unix 将在进程之间共享代码页。通常没有理由不使用该`libc`版本。

其他答案已经在`libc`系统调用和系统调用之间的区别上做了出色的工作。

# content-management-system - 协作式问答管理

> ID：572952
> 
> 赞同：0
> 
> 时间：2009-02-21T13:06:10.737
> 
> 标签：content-management-system, collaboration

如何创建像这样的协作问答管理系统？我想为我的学校制作一个学生可以提出问题并找到答案的地方。我尝试了论坛、pligg 等，但它们并没有多大吸引力。我想要与stackoverflow完全一样的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-21T13:12:36.540

有一个用 C# 编写的开源 Stack Overflow 克隆，最近在这里被多次提到，称为stacked，这个问题之前已经被问过。

相关链接：

*   [https://stackoverflow.com/questions/172516/a-stack-overflow-like-application-for-your-intranet](https://stackoverflow.com/questions/172516/a-stack-overflow-like-application-for-your-intranet)
*   [http://code.google.com/p/stacked/](http://code.google.com/p/stacked/)

# c++ - 读取 Matrix txt 文件并存储为数组

> ID：572962
> 
> 赞同：8
> 
> 时间：2009-02-21T13:12:53.137
> 
> 标签：c++, matrix, ifstream

我目前正在编写模拟退火代码来解决旅行推销员问题，并且在存储和使用我从 txt 文件中读取的数据时遇到了困难。文件中的每一行和每一列代表每个城市，两个不同城市之间的距离存储为一个 15 x 15 矩阵：

```
0.0 5.0 5.0 6.0 7.0 2.0 5.0 2.0 1.0 5.0 5.0 1.0 2.0 7.1 5.0
5.0 0.0 5.0 5.0 5.0 2.0 5.0 1.0 5.0 6.0 6.0 6.0 6.0 1.0 7.1
5.0 5.0 0.0 6.0 1.0 6.0 5.0 5.0 1.0 6.0 5.0 7.0 1.0 5.0 6.0
6.0 5.0 6.0 0.0 5.0 2.0 1.0 6.0 5.0 6.0 2.0 1.0 2.0 1.0 5.0
7.0 5.0 1.0 5.0 0.0 7.0 1.0 1.0 2.0 1.0 5.0 6.0 2.0 2.0 5.0
2.0 2.0 6.0 2.0 7.0 0.0 5.0 5.0 6.0 5.0 2.0 5.0 1.0 2.0 5.0
5.0 5.0 5.0 1.0 1.0 5.0 0.0 2.0 6.0 1.0 5.0 7.0 5.0 1.0 6.0
2.0 1.0 5.0 6.0 1.0 5.0 2.0 0.0 7.0 6.0 2.0 1.0 1.0 5.0 2.0
1.0 5.0 1.0 5.0 2.0 6.0 6.0 7.0 0.0 5.0 5.0 5.0 1.0 6.0 6.0
5.0 6.0 6.0 6.0 1.0 5.0 1.0 6.0 5.0 0.0 7.0 1.0 2.0 5.0 2.0
5.0 6.0 5.0 2.0 5.0 2.0 5.0 2.0 5.0 7.0 0.0 2.0 1.0 2.0 1.0
1.0 6.0 7.0 1.0 6.0 5.0 7.0 1.0 5.0 1.0 2.0 0.0 5.0 6.0 5.0
2.0 6.0 1.0 2.0 2.0 1.0 5.0 1.0 1.0 2.0 1.0 5.0 0.0 7.0 6.0
7.0 1.0 5.0 1.0 2.0 2.0 1.0 5.0 6.0 5.0 2.0 6.0 7.0 0.0 5.0
5.0 7.0 6.0 5.0 5.0 5.0 6.0 2.0 6.0 2.0 1.0 5.0 6.0 5.0 0.0 
```

要阅读这篇文章，我有一个 LoadCities() 函数，如下所示：

```
#include "iostream"
#include "fstream"      
#include "string"   
using namespace std;

double distances [15][15];  

void LoadCities()
{
    ifstream CityFile;

    if (!CityFile.is_open()) //check is file has been opened
    {
        CityFile.open ("Cities.txt", ios::in | ios::out);

        if (!CityFile)
        {
            cerr << "Failed to open " << CityFile << endl;
            exit(EXIT_FAILURE);  //abort program
        }
    }

    int length;
    char * buffer;
    string cities;

    CityFile.seekg(0, ios::end);
    length = CityFile.tellg();
    CityFile.seekg (0, ios::beg);

    buffer = new char [length];

    cities = CityFile.read (buffer,length); 

    string rows = strtok(cities, "\n");

    distances = new double[rows.length()][rows.length()];

            for (int i = 0; i < (string) rows.length(); i++)
            {
                string distance = strtok(rows[i], " ");

                for (int j = 0; j < distance.length(); j++)
                {
                    distances[i][j] = (double) Parse(distance[j]);
                }
            }

    CityFile.close();
} 
```

我尝试了另一种 istreambuf_iterator 方法来将读取的材料操作到数组中，但是我似乎总是遇到并发症：

```
ifstream CityFile("Cities.txt");
string theString((std::istreambuf_iterator<char>(CityFile)), std::istreambuf_iterator<char>()); 
```

任何帮助将不胜感激。一直在抨击我的头，但收效甚微！

################ 编辑/更新

@SoapBox - SA 代码、函数和 main() 的一些细节。这不干净、不高效、不整洁，也不适合现阶段，只需要暂时工作。这个版本（下）工作并设置为解决多项式（最简单的问题）。将其转换为旅行推销员问题需要做的是：

1.  编写 LoadCities() 函数来收集距离数据。（当前的）

2.  更改 Initialise() 以获得所涉及的距离的总和

3.  将 E() 更改为 TSP 函数（例如计算随机路线的距离）

后两个我知道我可以做到，但是我需要 LoadCities() 来做到这一点。在以下脚本中无需更改任何其他内容。

```
#include "math.h"
#include "iostream"
#include "fstream"
#include "time.h"   // Define time()
#include "stdio.h"  // Define printf()
#include "randomc.h"    // Define classes for random number generators
#include "mersenne.cpp" // Include code for the chosen random number generator

using namespace std; // For the use of text generation in application

double T;
double T_initial;

double S;
double S_initial;
double S_current;
double S_trial;

double E_current;

int N_step;        // Number of Iterations for State Search per Temperature
int N_max;         //Number of Iterations for Temperature
int Write;

const double EXP = 2.718281828;

//------------------------------------------------------------------------------
//Problem Function of Primary Variable (Debugged 17/02/09 - Works as intended)

double E(double x) //ORIGNINAL
{
    double y = x*x - 6*x + 2;

     return y;
}

//------------------------------------------------------------------------------
//Random Number Generation Function (Mod 19/02/09 - Generated integers only & fixed sequence)

double Random_Number_Generator(double nHigh, double nLow) 
{
    int seed = (int)time(0);            // Random seed

    CRandomMersenne RanGen(seed);       // Make instance of random number generator

    double fr;                          // Random floating point number

    fr = ((RanGen.Random() * (nHigh - nLow)) + nLow);   // Generatres Random Interger between nLow & nHigh

    return fr;
}

//------------------------------------------------------------------------------
//Initializing Function (Temp 17/02/09)

void Initialize() //E.g. Getting total Distance between Cities
{
    S_initial = Random_Number_Generator(10, -10);

    cout << "S_Initial: " << S_initial << endl;
}

//------------------------------------------------------------------------------
//Cooling Schedule Function (make variables) (Completed 16/02/09)

double Schedule(double Temp, int i) // Need to find cooling schedule
{
    double CoolingRate = 0.9999;

    return Temp *= CoolingRate; 
}

//------------------------------------------------------------------------------
//Next State Function (Mod 18/02/09)

double Next_State(double T_current, int i)
{
        S_trial = Random_Number_Generator(pow(3, 0.5), pow(3, 0.5)*-1); 

        S_trial += S_current;

        double E_t = E(S_trial);
        double E_c = E(S_current);

        double deltaE = E_t - E_c;                              //Defines gradient of movement

        if ( deltaE <= 0 )                                      //Downhill
        {    
            S_current = S_trial;
            E_current = E_t;
        }
        else                                                    //Uphill
        {
            double R = Random_Number_Generator(1,0);            //pseudo random number generated
            double Ratio = 1-(float)i/(float)N_max;             //Control Parameter Convergence to 0
            double ctrl_pram = pow(EXP, (-deltaE / T_current)); //Control Parameter

            if (R < ctrl_pram*Ratio)                            //Checking 
            {   
                S_current = S_trial;                            //Expresses probability of uphill acceptance
                E_current = E_t;                                
            }
            else 
                E_current = E_c;
        }

        return S_current;
}

//------------------------------------------------------------------------------
//Metropolis Function (Mod 18/02/09)

double Metropolis(double S_start, double T_current, int N_Steps, int N_temperatures)
{
     S_current = S_start;                                       //Initialised S_initial equated to S_current

     for ( int i=1; i <= N_step; i++ )                          //Iteration of neighbour states
        S_current = Next_State(T_current, N_temperatures);      //Determines acceptance of new states

     return S_current;
}

//------------------------------------------------------------------------------
//Write Results to Notepad (Completed 18/02/09)

void WriteResults(double i, double T, double x, double y)
{
//This function opens a results file (if not already opened)
//and stores results for one time step

    static ofstream OutputFile;
    const int MAXLENGTH = 80;

    if (!OutputFile.is_open()) //check is file has been opened
    {
        //no it hasn't. Get a file name and open it.
        char FileName[MAXLENGTH];

        //read file name
        cout << "Enter file name: ";
        do
        {
            cin.getline(FileName, MAXLENGTH);
        }
        while (strlen(FileName) <= 0); //try again if length of string is 0

        //open file
        OutputFile.open(FileName);

        // check if file was opened successfully
        if (!OutputFile)
        {
            cerr << "Failed to open " << FileName << endl;
            exit(EXIT_FAILURE);  //abort program
        }

        OutputFile << "Iterations" << '\t' << "Temperatures" << '\t' << "X-Value" << '\t' << "Y-Value" << endl; 
        OutputFile << endl;
    }

    //OutputFile.width(10);
    OutputFile << i << '\t' << T << '\t' << x << '\t' << y << endl; 

    if (i == N_max) 
    {   
        OutputFile << endl
               << "Settings: " << endl
               << "Initial Temperature: " << T_initial << endl
               << "Temperature Iterations: " << N_max << endl
               << "Step Iterations: " << N_step << endl
               << endl
               << "Results: " << endl
               << "Final Temperature: " << T << endl 
               << "Minimum: " << S << endl;

        OutputFile.close();
    }
}

//------------------------------------------------------------------------------
//Main SA Function (Mod 17/02/09)

void SA(int W)
{
    S = S_initial;
    T = T_initial;

    for ( int N_temperatures = 1 ; N_temperatures <= N_max ; N_temperatures++ )
    {
        S = Metropolis( S, T, N_step, N_temperatures);
        T = Schedule(T, N_temperatures);

        if (W == 1)
            WriteResults(N_temperatures, T, S, E_current);
    }

    cout << "Result" << endl
    << "Y-value> " << S << endl
    << "Temperature> " << T << endl;

}

//------------------------------------------------------------------------------
//Execution of Traveling Salesman Problem (Progress 18/02/09)

int main()
{
    cout << "Quadratic Function" << endl
         << "Solving method: Simulated Annealing" << endl;
    cout << "" << endl;

    cout << "Select desired Initial Temperature:" << endl
         << "> ";
    cin >> T_initial;

    cout << "Select desired number of Temperature Iterations:" << endl
         << "> ";
    cin >> N_max;

    cout << "Select desired number of step Iterations:" << endl
         << "> ";
    cin >> N_step;

    Initialize();

    cout << "Write to file: (1 / 0) " << endl
         << "> ";
    cin >> Write;

    SA(Write);

    system ("PAUSE");

    return 0;
} 
```

@strager - 我知道它的代码很糟糕，但不幸的是，由于我的项目所涉及的时间限制和随之而来的学习曲线，结果就是我们所需要的！:) 会在后期整理。

@ dirkgently - 这是这样做的最初原因，因此我的第一次尝试就是这样去做。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-21T13:51:48.300

这个怎么样？（[KISS](http://en.wikipedia.org/wiki/KISS_principle)解决方案）

```
void LoadCities() {
  int x, y;
  ifstream in("Cities.txt");

  if (!in) {
    cout << "Cannot open file.\n";
    return;
  }

  for (y = 0; y < 15; y++) {
    for (x = 0; x < 15; x++) {
      in >> distances[x][y];
    }
  }

  in.close();
} 
```

为我工作。可能没有那么复杂，也可能不是很高效，但只要您不读取 1000x1000 数组，您就不会看到任何差异。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-21T13:30:58.960

它甚至可以编译吗？我得到〜7个错误。一个样品：

> `strtok(cities, "\n");`

`strtok()`的第一个参数是 a`char *`而不是 std::string。

这有帮助吗？

```
void LoadCities()
{
  std::vector<double> f((std::istream_iterator<double>
       (std::ifstream("city.txt"))), /* replace filename with your own */
    (std::istream_iterator<double>()));
  if (!f.empty()) {
    std::cout << f.size() << "\n";
    /* print an arbitrary data point with 2 places of decimal */
    std::cout << std::setprecision(2) << f[ 0 ] << std::endl; 

  }
} 
```

使用矩阵并不意味着您需要一个多维数组。尤其是二维数组。当然它更容易阅读和写作；）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-21T13:51:50.580

你可能想要一些更简单的东西，像这样：

```
std::vector<std::vector<std::string> > LoadCities(const std::string &filename)
{
    using namespace std;

    ifstream file;
    file.open(filename, ios::in | ios::out);

    if(!file.is_open()) {
        // error
        return vector<vector<double> >();
    }

    vector<vector<double> > data;
    string line;

    while(!std::getline(file, line, '\n').eof()) {
        istringstream reader(line);

        vector<double> lineData;

        string::const_iterator i = line.begin();

        while(!reader.eof()) {
            double val;
            reader << val;

            if(reader.fail())
                break;

            lineData.push_back(val);
        }

        data.push_back(lineData);
    }

    return data;
} 
```

基本上，您使用流来输入数据。我可能做错了什么（我从未处理过 iostream；P），但这应该让您大致了解如何构建矩阵读取器。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-21T20:53:51.797

这是我将如何加载/保存它：

```
#include <iostream>
#include <fstream>
#include <string>

int width = 0;
int height = 0;
double **distances;

void WriteDouble( std::ofstream &stream, double toWrite )
{
    char buffer[8];
    memcpy( buffer, &toWrite, 8 );
    stream.write( buffer, 8 );
}

void WriteInt( std::ofstream &stream, int toWrite )
{
    char buffer[4];
    memcpy( buffer, &toWrite, 4 );
    stream.write( buffer, 4 );
}

double ReadDouble( std::ifstream &stream )
{
    double d = 0;
    stream.read( (char *)&d, 8 );
    return d;
}

int ReadInt( std::ifstream &stream )
{
    int i = 0;
    stream.read( (char *)&i, 4 );
    return i;
}

void Save()
{
    std::ofstream stream( "cities", std::ios::out | std::ios::binary );

    if( !stream.good() ) {
        throw std::exception( "Error opening stream" );
    }

    WriteInt( stream, width );
    WriteInt( stream, height );

    for( int x = 0; x < width; x++ ) {
        for( int y = 0; y < height; y++ ) {
            WriteDouble( stream, distances[x][y] );
        }
    }

    stream.close();
}

void Load()
{
    std::ifstream stream( "cities", std::ios::in | std::ios::binary );

    if( !stream.good() ) {
        throw std::exception( "Error opening stream" );
    }

    width = ReadInt( stream );
    height = ReadInt( stream );

    distances = new double *[width];

    for( int i = 0; i < width; i++ ) {
        distances[i] = new double[height];
    }

    for( int x = 0; x < width; x++ ) {
        for( int y = 0; y < height; y++ ) {
            distances[x][y] = ReadDouble( stream );
        }
    }

    stream.close();
}

void RunSaveTest()
{
    width = 15;
    height = 15;

    distances = new double *[width];

    for( int i = 0; i < width; i++ ) {
        distances[i] = new double[height];
    }

    for( int x = 0; x < width; x++ ) {
        for( int y = 0; y < height; y++ ) {
            distances[x][y] = (double)x / (double)( y + 1 );
            std::cout << distances[x][y] << std::endl;
        }
    }

    Save();
}

void RunLoadTest()
{
    Load();

    for( int x = 0; x < width; x++ ) {
        for( int y = 0; y < height; y++ ) {
            std::cout << distances[x][y] << std::endl;
        }
    }
}

int main()
{
    RunSaveTest();
    // RunLoadTest();

    return 0;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-09-27T16:34:28.793

来自我的博客的参考：[http ://www.topbug.ne​​t/blog/2013/01/10/load-a-matrix-from-an-ascii-format-file/](http://www.topbug.net/blog/2013/01/10/load-a-matrix-from-an-ascii-format-file/)

此代码片段具有更高的容错性，而不是假设所有内容都格式正确。

```
#include <istream>
#include <string>
#include <sstream>
#include <vector>

// load matrix from an ascii text file.
void load_matrix(std::istream* is,
        std::vector< std::vector<double> >* matrix,
        const std::string& delim = " \t")
{
    using namespace std;

    string      line;
    string      strnum;

    // clear first
    matrix->clear();

    // parse line by line
    while (getline(*is, line))
    {
        matrix->push_back(vector<double>());

        for (string::const_iterator i = line.begin(); i != line.end(); ++ i)
        {
            // If i is not a delim, then append it to strnum
            if (delim.find(*i) == string::npos)
            {
                strnum += *i;
                if (i + 1 != line.end()) // If it's the last char, do not continue
                    continue;
            }

            // if strnum is still empty, it means the previous char is also a
            // delim (several delims appear together). Ignore this char.
            if (strnum.empty())
                continue;

            // If we reach here, we got a number. Convert it to double.
            double       number;

            istringstream(strnum) >> number;
            matrix->back().push_back(number);

            strnum.clear();
        }
    }
}

// example
#include <fstream>
#include <iostream>

int main()
{
    using namespace std;

    // read the file
    std::ifstream is("input.txt");

    // load the matrix
    std::vector< std::vector<double> > matrix;
    load_matrix(&is, &matrix);

    // print out the matrix
    cout << "The matrix is:" << endl;
    for (std::vector< std::vector<double> >::const_iterator it = matrix.begin(); it != matrix.end(); ++ it)
    {
        for (std::vector<double>::const_iterator itit = it->begin(); itit != it->end(); ++ itit)
            cout << *itit << '\t';

        cout << endl;
    }

    return 0;
} 
```

# c# - 为什么我们不能有“char”枚举类型

> ID：572963
> 
> 赞同：42
> 
> 时间：2009-02-21T13:13:57.987
> 
> 标签：c#, enums, char

我想知道为什么我们不能将“char”作为底层枚举类型。因为我们有 byte,sbyte,int,uint,long,ulong,short,ushort 作为底层枚举类型。其次，枚举的默认基础类型是什么？

* * *

## 回答 #1

> 赞同：82
> 
> 时间：2012-04-18T05:42:51.373

我知道这是一个较老的问题，但这些信息对我很有帮助：

在 C# .NET 4.0（甚至可能是 3.5，但我还没有测试过）中，使用 char 作为枚举的值类型似乎没有问题。这是我所做的，它完全有效：

```
public enum PayCode {
    NotPaid = 'N',
    Paid = 'P'
} 
```

将枚举转换为字符：

```
PayCode enumPC = PayCode.NotPaid;
char charPC = (char)enumPC; // charPC == 'N' 
```

将 char 转换为枚举：

```
char charPC = 'P';
if (Enum.IsDefined(typeof(PayCode), (int)charPC)) { // check if charPC is a valid value
    PayCode enumPC = (PayCode)charPC; // enumPC == PayCode.Paid
} 
```

就像你对 char 类型所期望的那样，就像一个魅力一样！

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-02-21T13:19:17.537

默认类型是 int。更多信息参见 MSDN 上的 C#[参考](http://msdn.microsoft.com/en-us/library/sbbt4032.aspx)。您还可以在 MSDN 上找到指向[C# 语言规范的链接。](http://msdn.microsoft.com/en-us/vcsharp/aa336809.aspx)我认为限制的原因可能来自语言规范第 4.1.5 节中的这些陈述。

> char 类型被归类为整数类型，但它与其他整数类型有两个不同之处：
> 
> • 没有从其他类型到char 类型的隐式转换。特别是，即使 sbyte、byte 和 ushort 类型具有可以使用 char 类型完全表示的值范围，但不存在从 sbyte、byte 或 ushort 到 char 的隐式转换。
> 
> • char 类型的常量必须写为字符文字或整数文字与转换为char 类型的组合。例如，(char)10 与 '\x000A' 相同。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2010-05-10T09:42:06.170

这是我正在使用的解决方法

```
enum MyEnum
{
    AA = 'A',
    BB = 'B',
    CC = 'C'
};

static void Main(string[] args)
{
    MyEnum e = MyEnum.AA;
    char value = (char)e.GetHashCode(); //value = 'A'
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-21T14:21:26.857

从技术上讲，你不能这样做。但是，您可以将枚举转换为字节，然后将其转换为字符。如果您的目标是拥有这样的东西，这很有用（意识到这是不可能的：

```
public enum CharEnum
{
    one = '1'
} 
```

但是，您可以通过使用 ASCII 字节值然后转换：

```
public enum CharEnum
{
    one = 49,
    two = 50
} 
```

然后，您可以转换为 byte 和 char 以获取 char 值。它不是很漂亮，但它会起作用，如果得到一个字符是你的最终目标。如果您需要 ASCII 范围之外的字符，也可以使用 unicode 和 int 值。:-)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-05-12T15:57:44.850

[请参阅Ecma International](http://ecma-international.org)中的 ECMA 标准 335，通用语言基础结构 (CLI) 。CLI 允许底层类型为 char 或 bool，但 C# 和 VB.Net 不允许。对于它的价值，C++/CLI 确实允许 System::Char 作为底层类型。

我认为 C# 和 VB.Net 仅出于语法原因不允许 char 和 bool 作为基础类型。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-09-25T16:59:53.643

```
char charPC = 'P';
if (Enum.IsDefined(typeof(PayCode), (PayCode)charPC)) { 
        // check if charPC is a valid value
        PayCode enumPC = (PayCode)charPC; // enumPC == PayCode.Paid
} 
```

*   做了一个小改动，在所有情况下都不需要在 if 中将其转换为（**int**），这取决于枚举类型。但是如果你直接将它转换为枚举类型本身，它应该总是有效的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-11-10T17:48:56.403

针对 VB.NET 和 CLI 消费者，您可以像这样编译 char 枚举（最容易使用启用了 IL 支持（扩展）的 VB.NET 或 C# 项目）：

```
.class public auto ansi sealed Hafner.Testing.EdgeCase.CharEnum
       extends [mscorlib]System.Enum
{
    .field public specialname rtspecialname char value__
    .field public static literal valuetype Hafner.Testing.EdgeCase.CharEnum Min = char(0)
    .field public static literal valuetype Hafner.Testing.EdgeCase.CharEnum Zero = char(0)
    .field public static literal valuetype Hafner.Testing.EdgeCase.CharEnum Max = char(65535)
    .field public static literal valuetype Hafner.Testing.EdgeCase.CharEnum DuplicateSameValue = char(65) //A
    .field public static literal valuetype Hafner.Testing.EdgeCase.CharEnum duplicateSameValue = char(65) //A
    .field public static literal valuetype Hafner.Testing.EdgeCase.CharEnum DuplicateOtherValue = char(90) //Z
    .field public static literal valuetype Hafner.Testing.EdgeCase.CharEnum duplicateOtherValue = char(88) //X

} 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2012-10-26T22:48:43.893

几乎所有的事情都已经说过了。只是想说如果您使用大量“字符枚举”，您可以使用扩展：

```
public enum MyEnum
{
    MY_VALUE = 'm'
}

public static class MyExtensions
{
    public static char GetChar(this Enum value)
    {
        return (char)value.GetHashCode();
    }
}

class Program
{
    public static void Main(string[] args)
    {
        MyEnum me = MyEnum.MY_VALUE;
        Console.WriteLine(me + " = " + me.GetChar());
    }
} 
```

* * *

## 回答 #9

> 赞同：-5
> 
> 时间：2009-02-21T13:39:25.117

字符枚举只是字符串，不是吗？我不确定您会从字符枚举中获得什么其他好处？

正如其他人所说，枚举的默认类型是 int 。

# delphi - 如何使 delphi 的滚动条更宽/更大，（包括滚动条的箭头）

> ID：572969
> 
> 赞同：4
> 
> 时间：2009-02-21T13:16:30.023
> 
> 标签：delphi, accessibility

出于可访问性的目的，我需要使所有可滚动控件（列表、列表视图）的滚动条更宽，滚动条箭头更大。

1.  如何从可滚动控件（例如：TListView）中获取滚动条（句柄）？

2.  如何使滚动条和箭头更宽/更大？

任何提示和代码的 10 倍...

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-21T14:07:13.320

可访问性与单个应用程序无关，而是与整个系统有关。这就是为什么没有定义 API 来仅针对您的程序调整本机控件的边框宽度、滚动条大小和类似属性等内容。但是，您可以在 Windows 中全局调整这些设置，方法是使用辅助功能向导，或者在显示属性小程序中调整字体、颜色、边框大小和滚动条大小。

有关更多信息，您应该查看[Microsoft 辅助功能页面](http://www.microsoft.com/enable/)并点击各种链接。

**编辑：**为了您自己的程序的利益而更改全局设置（如公认的答案所示）是**极端粗鲁的**。请记住，这会干扰所有其他正在运行的程序。对于带有触摸屏的系统来说，这可能是可以原谅的，其中控件需要很大才能完全可用 - 但在这样的系统上，控件大小可能已经正确设置。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-21T13:59:01.497

我不确定您是否可以 - 您必须为整个 Windows 更改（并恢复）它。

[http://www.greatis.com/delphicb/tips/lib/system-captionfont.html](http://www.greatis.com/delphicb/tips/lib/system-captionfont.html)

设置和读取属性 TNonClientMetrics.iScrollWidth

* * *

**编辑：**我知道这个解决方案很粗鲁，但在通常情况下是你能做的最好的。如果您有专门的 TabletPC 应用程序，那么您通常一次只使用该应用程序，而不使用其他应用程序。但是 - 几乎所有的 Windows 应用程序都不是为使用这么大的滚动条而设计的。因此，当您需要使用操作系统对话框和其他应用程序时，您必须将其切换回来。

没有比“当我的触摸屏应用程序运行时设置窗口滚动条大，然后将其返回”更好的解决方案。我们在现实世界中**有**这个应用程序，所以我知道我在说什么。

当然，您可以编写自己的网格控件（如果您有这么多时间）或使用一些第三方控件（如果您有钱和时间），但这不是问题。

# c++ - 如何在 Unix/Linux 中创建软件包？

> ID：572979
> 
> 赞同：7
> 
> 时间：2009-02-21T13:22:35.877
> 
> 标签：c++, unix, boilerplate, software-packaging

我们如何创建一个软件包，以便在解压我们的软件 tar 球后，用户可以执行典型的步骤？

```
$ gunzip < mycode.tar.gz | tar xvf -
$ ./configure
$ make
$ make install 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-21T13:31:47.197

难以理解的 GNU/Autools 的替代方法是 CMake。

[http://www.cmake.org/cmake/help/examples.html](http://www.cmake.org/cmake/help/examples.html)

例如 KDE 正在使用它。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-21T13:28:26.143

查看 GNU autoconf/automake 工具链。[这是一个免费的教程/书。](http://sourceware.org/autobook/)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-21T14:08:41.520

在过去，这个过程是手工完成的。每个`Makefile`都是手工编写的（文件`make`用作一种脚本）。当涉及到可移植性时，这变得有问题，因此编写了`configure`脚本。`./configure`脚本也是为每个项目手工编写的。最终，这由 GNU 用他们的`autotools`包自动完成。这包括`autoconf`,`automake`和其他一些。虽然存在替代品，特别是对于`make`，`autotools`但使用最广泛。...至少在 GNU/Linux 系统上。替代方案包括已经提到的[CMake](http://www.cmake.org/ "`cmake`")、[Boost.Build](http://www.boost.org/doc/tools/build/index.html "Boost.Build")、[Boost.Jam](http://www.boost.org/doc/tools/jam/index.html "Boost.Jam")、[SCons](http://www.scons.org/ "缺点")等。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-21T13:25:50.737

使用 autotools 创建配置脚本（它将生成最后两个步骤所需的 Makefile），然后制作一个包含所有代码和内容的 tarball。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-21T13:40:17.173

rpmbuild 是构建 rpm 包的命令

[手册页](http://www.rpm.org/max-rpm-snapshot/rpmbuild.8.html)

[教程](http://linuxhacks.org/tutorials/jakes_rpm_build_tutorial.php)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-07-04T13:28:57.333

自动工具。

您需要编写一个 configure.ac 和一个 Makefile.am 脚本。

Configure.ac 非常简单，可以通过在源代码上运行“自动扫描”来自动生成。这将生成一个“configure.scan”文件，您需要对其进行调整以生成最终的 configure.ac 文件。

Automake.am 文件完全基于约定。你可能需要类似的东西：

```
AUTOMAKE_OPTIONS = foreign subdir-objects
AM_CXXFLAGS = -std=c++11 -static-libstdc++ -Wall -Werror \
    -Wfatal-errors -I blah
AM_LDFLAGS = blah

bin_PROGRAMS = mybinary
mybinary_SOURCES = \
    blah.h blah.cc 
```

一切都基于命名模式：

*   dist vs nodist = 是否应该建造
*   inst vs noinst = 是否应该安装
*   数据 = 数据文件
*   MANS = 手册页
*   来源 = 源代码

因此 dist_noinst_DATA 用于构建所需但未安装的数据文件。

一旦你拥有了这两个文件，你通常需要运行类似的东西：

aclocal && autoheader && automake --add-missing && autoconf

设置构建所需的 autotools 文件。这可以放在 shell 脚本中并在运行 ./configure 之前运行。

# jquery - jQuery.getJSON 不会触发回调

> ID：572991
> 
> 赞同：25
> 
> 时间：2009-02-21T13:31:15.557
> 
> 标签：jquery, django, getjson, simplejson

我有一个html代码：

```
<button>asd</button>
<script type = "text/javascript">
$('button').click(
    function() {
        $.getJSON('/schedule/test/', function(json) {
            alert('json: ' + json + ' ...');
        });
    }
);
</script> 
```

和相应的观点：

```
def test(request):
    if request.method == 'GET':
        json = simplejson.dumps('hello world!')
        return HttpResponse(json, mimetype = 'application/json') 
```

视图被执行（使用 测试`print`），`json`变量被初始化但没有出现警告。我做错什么了？我已经看过一些关于此的文档（[http://docs.jquery.com/Ajax/jQuery.getJSON#urldatacallback](http://docs.jquery.com/Ajax/jQuery.getJSON#urldatacallback)例如）但我没有找到答案。

编辑：问题是，它`HttpResponse`没有被导入......不幸的是，Django 没有给出任何错误。其他一切都是正确的。问候
克里斯

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2009-02-21T13:52:26.833

很可能是 json 格式不正确。有时，当我的代码（应该生成 json）生成错误时，我会发生这种情况。两种选择：

*   使用 firebug 查看 JSON 响应

*   使用 jQuery.ajaxSetup 选项在您的 jquery 代码中设置错误处理，例如：

    ```
     $.ajaxSetup({"error":function(XMLHttpRequest,textStatus, errorThrown) {   
          alert(textStatus);
          alert(errorThrown);
          alert(XMLHttpRequest.responseText);
      }}); 
    ```

使用错误处理进行调试非常棒，因为当您的响应出现问题时，您会立即知道。您可以查看 jQuery.ajax 的[jQuery 文档，](http://docs.jquery.com/Ajax/jQuery.ajax)其中包含 jQuery.ajaxSetup 的所有可用选项。

编辑：第三种选择是只打开应该生成 JSON 的 URL 并通过[JSON Lint](http://www.jsonlint.com/)运行输出以验证它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-21T13:38:42.983

您确定 JSON 有效吗？直接查看响应或使用 Firebug

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-08-24T19:27:08.117

我不久前遇到了这个问题，并为 jQuery 的 Ajax 重写了一个包装器，它允许您传递正常的 getJSON 和每个 get 的附加错误回调。

[http://www.nurelm.com/themanual/2010/08/09/self-indulgent-code-jquery-getjson-with-error-handling/](http://www.nurelm.com/themanual/2010/08/09/self-indulgent-code-jquery-getjson-with-error-handling/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-04-28T18:54:16.467

我认为您缺少 url 模式中的尾随 $ 。***************``**