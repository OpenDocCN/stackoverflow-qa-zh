# StackOverflow 问答 11833000-11833999

# php - 函数参数：函数的默认值返回？

> ID：11833004
> 
> 赞同：2
> 
> 时间：2012-08-06T17:24:58.110
> 
> 标签：php, function, arguments, optional-arguments

我有**很多带有可选参数的函数**，它们在省略的值上从指定的函数中获取其默认值，目前我的代码如下所示：

```
function get_user($user_id = FALSE) {

   // If no ID is passed, get from session
   if(!$user_id) { 
      $user_id = get_id_from_session();      
   }

   // ... do something with the ID
} 
```

它工作得很好，但是当有多个可选参数时它很容易变得非常**混乱。**相反，我更愿意执行以下操作：

```
function get_user($user_id = get_id_from_session()) {

   // ... do something with the ID

} 
```

我相信您会看到这样更方便。**有什么办法可以做到这一点，或者有人对另一种更清洁的方法有建议吗？**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-06T17:29:36.517

您可以“缩短”它的唯一方法是使用[三元运算符](http://php.net/ternary)：

```
$user_id = ( $user_id === false) ? get_id_from_session() : $user_id; 
```

这只是一个紧凑的写作版本：

```
if( $user_id === false) {
    $user_id = get_id_from_session();
} 
```

如果您想要真正花哨且可读性较差，可以省略中间部分（PHP > 5.3）：

```
$user_id = ( $user_id) ?: get_id_from_session(); 
```

现在，如果`( $user_id)`计算结果为 true，您将获得`$user_id` in的值`$user_id`，否则您将获得函数的返回值。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-06T17:32:58.947

默认函数参数只能采用常量值，而不是在运行时评估的表达式，因此您的第二个选项将不起作用。

我的一个想法是这样的。

```
function foo($user_id = null) {
    $data = get_defaults('user_id' => $user_id);

    extract($data);

    echo $user_id; // should be the value returned from get_defaults()
} 
```

该`get_defaults()`函数可能如下所示：

```
function get_defaults(array $params) {
    if (isset($params['user_id']) && is_null($params['user_id'])) {
        $params['user_id'] = get_id_from_session();
    }

    if (isset($params['something_else']) && !isValidSomething($params['something_else'])) {
        $params['something_else'] = get_something_else();
    }

    return $params;
} 
```

您只需`get_defaults()`根据特定被调用函数期望的参数将数组传递给函数。所以另一个例子是：

```
function bar($baz, $user_id = null, $user_name = null, $return = null) {
    $data = get_defaults(array('return' => $return,
                               'user_name' => $user_name,
                               'user_id'   => $user_id));

    extract($data);

    // normal function code below
} 
```

# javascript - jquery 对话框 - 外部链接的 javascript 不起作用

> ID：11833008
> 
> 赞同：0
> 
> 时间：2012-08-06T17:25:23.477
> 
> 标签：javascript, jquery, jquery-ui-dialog

我正在尝试制作一个对话框，该对话框加载一个外部 php 文件，其中包含一个表单，该表单要求提供信息，包括使用 jQuery datepicker 的日期和一个 javascript 代码来检查是否在提交之前填写了所有字段。我有正确弹出对话框，但是外部 php 文件中的 javascript 不起作用（日历没有弹出，表单验证检查不起作用）。我正在使用外部 php 文件，因为我将链接设置为传递一个变量来填写表单的一部分。我不确定这些信息是否有用，但在普通窗口链接中加载 php 文件工作得很好，只有当它在对话框中时，javascript 才不起作用。

这是我的对话框脚本：

```
<script type="text/javascript">
$(document).ready(function() {
    $('#order a').each(function() {
        var $link = $(this);
        var $dialog = $('<div></div>')
        .load($link.attr('href') + ' #content')
        .dialog({
            autoOpen: false,
            title: $link.attr('title'),
            width: 500,
            height: 400
        });

        $link.click(function(){
            $dialog.dialog('open');
            return false;
        });
    });
});
</script> 
```

这是我弹出对话框的代码：

```
<div id="order">
    <a href="package.php?code=NY1" title="Package Booking"><img src="images/order.png"></a>
</div> 
```

php文件中的javascript代码和表单：

```
<head>
<script type="text/javascript">
$(function(){
            // Datepicker
            $('#pdate').datepicker({
                inline: true,
                minDate: 0,
            });
</script>
<script type="text/javascript">
function packageValidator(){
    var pdate = document.getElementById('pdate');
                    if(notEmpty(pdate, "Please enter a departure date.")){
                        return true;
                    }

    return false;
}
function notEmpty(elem, helperMsg){
    if(elem.value.length == 0){
        alert(helperMsg);
        elem.focus();
        return false;
    }
    return true;
}
</script>
</head>
<body>
<div id="content">
<form action="send_package.php" method="post" onsubmit='return packageValidator()' >
        <table>
          //Form Information
            <tr>
                <td><input id="pdate" name="pdate" type="text"></td>
            </tr>
            <tr>
                <td colspan="2"><input type="submit" value="Submit" /></td>
            </tr>
        </table>
</form>
</div>
</body> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T17:35:48.210

我从未见过像这样的设置。不确定您是否可以发布到仅包含 javascript 的页面。在带有表单的页面上，您必须将 PHP 文件中的所有 javascript 放入外部 .js 文件并添加

```
<script src="myjavascript.js"></script> 
```

到带有表格的页面。

此外，当您将 javascript 放入外部文件时，请删除标签。然后，您可以在表单中运行验证，并调用在对话框中呈现链接的函数。

# actionscript-3 - AS3 BitmapData 内存泄漏

> ID：11833009
> 
> 赞同：2
> 
> 时间：2012-08-06T17:25:25.043
> 
> 标签：actionscript-3, flash, memory-leaks, bitmapdata

这是在 AS3 上进行 BitmapData 内存分配的简单测试。

```
private function memoryTest(): void
{
  trace("BitmapData memory test. Create bmps..."); // First breakpoint
  var bmps:Array = new Array (1000);

  for (var i:int=0; i<1000; i++)
  {
    bmps[i] = new BitmapData(451, 451, true, 0);
    trace(i+". bmp created");
  }

  trace("All bmps created."); // Second breakpoint

  for (i=0; i<1000; i++)
  {
    bmps[i].dispose();
    bmps[i] = null;
  }
  bmps.splice(0, bmps.length);
  bmps = null;

  freeMemoryGC();

  trace("All bmps deleted.");
  trace("Test complete."); // Last breakpoint
}

private function freeMemoryGC(): void
{
  // the GC will perform a full mark/sweep on the second call.
  try
  {
    new LocalConnection().connect('foo');
    new LocalConnection().connect('foo');
  }
  catch (e:*)
  {
  }

  System.gc();
  System.gc();
} 
```

此测试中有 3 个断点，在代码中进行了注释。断点会在一段时间内暂停程序。断点对应于此内存状态图上的水平线。

![内存使用图](../Images/5331733ef4b52c904791c2da84be07e8.png)

我的问题是：为什么在**dispose()**调用后不是所有的内存都是空闲的？这段代码有什么问题以及如何正确清除**BitmapData**对象？

**更新 1**：我不认为问题出在垃圾收集器上。**dispose()**在 GC 之外工作，它应该释放像素数据。此外，这个例子**理论上**应该分配 451*451*4*1000 字节。但是这个测试应用程序在**System.privateMemory中分配****了 25% 以上**的字节，而这 25% 永远不会被 GC 和**dispose()**释放。

 ******更新 2**：如果我创建 13 个图像 4059x4059 像素而不是 100 个图像 451x451 像素，那么内存分配完全等于理论大小，并且内存在调用 GC 后**正确释放！**我不知道为什么会这样。

**UPDATE3**：这是我的区间测试结果，由 Daniel MesSer 在他的回答中创建： ![间隔测试的内存使用图](../Images/f78125ea2765c77120e98cf88227f51f.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T17:37:48.107

尝试删除 free memorygc-function 中有关本地连接的内容。这能解决吗？

**编辑：**

```
package nyx_gaming_group.as3_tests {
import flash.display.BitmapData;
import flash.display.Sprite;
import flash.system.System;
import messer_entertainment.MesSerUtils;

/**
 * ...
 * @author Daniel Dahlkvist
 */
public class BitmapDataMemoryLeak extends Sprite {
    private var _bitmaps:Array;

    public function BitmapDataMemoryLeak() {
        run();
    }

    private function run():void {
        MesSerUtils.delayCall(createBitmaps, 150);
        MesSerUtils.delayCall(destroyBitmaps, 4500);
        MesSerUtils.delayCall(freeMemoryGC, 4700);
        MesSerUtils.delayCall(run, 8000);
    }

    private function createBitmaps():void {
        trace("BitmapData memory test. Create bmps..."); // First breakpoint
        _bitmaps = new Array(1000);

        for (var i:int = 0; i < 1000; i++) {
            _bitmaps[i] = new BitmapData(451, 451, true, 0);
        }

        trace("All bmps created."); // Second breakpoint            
    }

    private function destroyBitmaps():void {
        for (var i:int = 0; i < _bitmaps.length; i++) {
            _bitmaps[i].dispose();
            _bitmaps[i] = null;
        }
        _bitmaps = null;

        trace("All bmps deleted.");
        trace("Test complete."); // Last breakpoint
    }

    private function freeMemoryGC():void {
        System.gc();
    }
}
} 
```****

# php - 使用简单的标记语言 - 应用它

> ID：11833011
> 
> 赞同：2
> 
> 时间：2012-08-06T17:25:44.223
> 
> 标签：php, formatting, markup

我想允许我的用户添加内容。为了方便起见，我将使用 Textile 或 PHP Markdown。

我只想允许以下格式：

*   大胆或强烈
*   强调
*   项目符号列表
*   文字颜色

没有其他的。我可以使用 jquery 创建一个简单的编辑器来包围格式化标签。

所以我的问题：

*   如何使 Textile 或 Markdown 仅允许某些格式（仅我需要以上列出的格式）？
*   用纺织品好还是降价好？或者我应该使用像 tinyMCE 这样的免费编辑器？哪个是最好的免费编辑器（在我的页面中使用）并且只允许我设置的格式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T17:32:29.010

我认为您可以使用 ckeditor 它的免费编辑器，并且他的外观和填充非常好并且易​​于设置。

演示网址：-

[http://ckeditor.com/demo/ou](http://ckeditor.com/demo/ou)

并且您想要最小的编辑器工具，您可以在演示中看到自定义工具栏

下载：-

[http://ckeditor.com/download](http://ckeditor.com/download)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T18:04:53.870

至于降价或编辑，我会说这取决于您的访问者。如果他们不太精通技术，那么请使用 TinyMCE。从文档中，我看不到有关白名单或黑名单的任何信息。

### 清理 PHP：

采用：

[合法的](http://www.bioinformatics.org/phplabware/internal_utilities/htmLawed/)

或者

[Html 净化器](http://htmlpurifier.org/)

# c# - 对通用列表进行排序

> ID：11833012
> 
> 赞同：1
> 
> 时间：2012-08-06T17:25:53.717
> 
> 标签：c#, list

我正在阅读关于排序列表的教程，我遇到了这行代码

```
myGenericList.Sort((x, y) => String.Compare(x.name, y.name)); 
```

我试过调查这个，但我就是不明白这条线。谁能向我解释一下这条线到底发生了什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-06T17:29:05.747

你在`anonymous` `function`这里创建一个。

`function` `Sort`接受一个 Action 委托，其中提供了两个参数`x`和`y`。`function`下面的实现`=>`被读作“去”。然后，`String.Compare(x.name, y.name)`使用提供的参数执行。的返回值`String.Compare`是函数的结果，这也是用于确定排序顺序的函数`List`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-06T17:36:36.757

有一个重载`Sort`需要一个`Comparison<>`委托。lammbda 表达式可以转换为匹配的委托类型，这就是它起作用的原因。

有关详细信息，请参阅[比较<> 的 MSDN 文档](http://msdn.microsoft.com/en-us/library/tfakywbh.aspx)。

在即将推出的 .NET4.5 (Visual Studio 2012) 中，可以`IComparer<>`非常轻松地从`Comparison<>`. 这是通过一种新的静态“工厂”方法`Comparer<>.Create`。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-06T17:28:58.063

它基本上说：要对 myGenericList 中的 2 个元素（x 和 y）进行排序，请在 x 和 y 的属性“名称”上使用 String.Compare。

# wso2esb - WSO2 路由器中介端点必须在初始化

> ID：11833017
> 
> 赞同：0
> 
> 时间：2012-08-06T17:26:10.953
> 
> 标签：wso2esb

我正在为一个项目使用 WSO2-esb 4.0.3。我创建了几条定义了端点的路线。但是当我发送消息时，有时所有路由都可以正常工作。间歇性地得到“必须初始化端点”并且即使没有对配置进行任何更改也无法工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T18:31:37.120

我找到了一些解决方法，但我不知道它可以工作多长时间而没有错误。到目前为止，这几天，我的经验是“发送”调解员没有上述问题。所以我在路由器调解器中创建了一个发送调解器，而不是直接定义目标端点。到目前为止，路由扫描工作没有错误。但我不知道负载或可靠性的含义。

# php - Symfony 多个站点

> ID：11833021
> 
> 赞同：10
> 
> 时间：2012-08-06T17:26:38.073
> 
> 标签：php, symfony

我有一个 Symfony2 核心，用于域 A 和域 B。但是，如果我更新核心，我需要更新两次，因为我不知道如何只配置一个核心，多个域及其配置/数据库。

建议？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-08T18:16:50.097

将“web”目录复制到每个域上的“public_html”文件夹中（假设您在 Linux 上运行 Apache）

这个“web”目录包含您网站的前端控制器（app.php 和 app_dev.php），找到它们并在您最喜欢的文本编辑器上编辑它们。找到以下行：

```
require_once __DIR__.'/../app/bootstrap.php.cache';
require_once __DIR__.'/../app/AppKernel.php'; 
```

并将路由更改为您的核心所在的实际相对路径。它可能是这样的：

```
require_once __DIR__.'/../the_core_is_here/app/bootstrap.php.cache';
require_once __DIR__.'/../the_core_is_here/app/AppKernel.php'; 
```

这很灵活，可以随意组织，但要确保这两行有正确的路径

**请记住，您包含在 HTML 中的所有资产（JS、CSS、图像...）都是相对于前端控制器位置的，因此您需要使用它们所在或**复制的域名的完整 URL 来链接它们他们也到 B 域**或**使用资产

最后你会得到类似的东西：

```
/
.. home
.. .. DOMAINA
.. .. .. public_html
.. .. .. .. app.php
.. .. .. .. img
.. .. .. .. .. image.png
.. .. DOMAINB
.. .. .. public_html
.. .. .. .. app.php
.. .. .. .. img
.. .. .. .. .. image.png
.. .. the_core_is_here
.. .. .. app
.. .. .. src
.. .. .. bin
.. .. .. vendor 
```

现在您的应用程序应该有 2 个入口点。您甚至可以在每个上放置不同的 CSS 和图像，以赋予它们不同的方面。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-12T14:50:01.757

也许您可以尝试使用[Capifony](http://capifony.org/)`ruby` ，它是为应用程序编写的部署脚本`Symfony`。我没有像您想要实现的那样进行任何设置，但我使用它来部署登台和生产服务器。它可以设置为将应用程序的不同实例部署到一台服务器（例如：不同的目录）或多台服务器。

正确设置后，只需键入以下内容即可进行部署：

```
cap server1 deploy
cap server2 deploy 
```

每次运行命令时，`capifony`都会从存储库中提取最新代码（例如：git），并进行部署。作为奖励，如果您需要返回到以前的状态，旧版本的应用程序也会保存在服务器上。

这是示例 capifony 配置脚本，只是为了给您一个概述：

```
# deploy.rb
set   :application,   "My App"
set   :deploy_to,     "/var/www/my-app.com"
set   :domain,        "my-app.com"

set   :scm,           :git
set   :repository,    "ssh-gitrepo-domain.com:/path/to/repo.git"

role  :web,           domain
role  :app,           domain
role  :db,            domain, :primary => true

set   :use_sudo,      false
set   :keep_releases, 3 
```

并且您可以拥有不同的配置脚本，每个脚本用于不同的域[，](http://capifony.org/cookbook/using-the-multistage-extension.html)使用`capifony`.

# java - 无法通过 android 模拟器发送电子邮件

> ID：11833024
> 
> 赞同：1
> 
> 时间：2012-08-06T17:26:49.183
> 
> 标签：java, android, eclipse

我想使用我的应用程序从 android 模拟器发送电子邮件。但问题是我收到了 FORCE CLOSE 错误。我可以在模拟器上浏览互联网。我该怎么办 ？这是控制台窗口中显示的错误

" [2012-08-06 09:43:11 - 启动 logcat 时出现意外错误。尝试重新选择设备。] 找不到设备 com.android.ddmlib.AdbCommandRejectedException：在 com.android.ddmlib.AdbHelper.setDevice 找不到设备（ AdbHelper.java:752) 在 com.android.ddmlib.AdbHelper.executeRemoteCommand(AdbHelper.java:373) 在 com.android.ddmlib.Device.executeShellCommand(Device.java:462) 在 com.android.ddmuilib.logcat.LogCatReceiver $1.run(LogCatReceiver.java:109) 在 java.lang.Thread.run(Unknown Source) "

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T04:39:19.770

出于安全目的，Android 模拟器不包含任何电子邮件客户端，这就是为什么 android 应用程序无法通过模拟器发送邮件的原因，但它在 Android 真实设备中运行良好，尝试在真实设备中安装您的应用程序并检查它。不要忘记为您的清单文件授予“INTERNET”权限。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T17:43:45.217

您需要配置电子邮件客户端——查看[为什么模拟器不能在 android 中发送电子邮件以](https://stackoverflow.com/questions/5042487/why-cannot-an-emulator-send-email-in-android)获取更多信息。

# php - 非破坏性 spl_autoload_register

> ID：11833034
> 
> 赞同：3
> 
> 时间：2012-08-06T17:27:13.137
> 
> 标签：php, wordpress

我想在我正在开发的 wordpress 插件中通过 spl_autoload_register 使用类的动态加载，但问题是它不能干扰此功能的预先存在的实现。在我最初的尝试中：

```
// register an autoloader function for template classes
spl_autoload_register ( 'template_autoloader' );

function template_autoloader ( $class ) {
    include LG_FE_DIR . "/includes/chart_templates/class.{$class}.php";
} 
```

似乎可以加载我自己的类，但同时会导致其他插件出现大量错误，这些插件显然也在使用 spl_autoload_register 功能。

有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-06T21:47:06.703

我相信我现在有一个合理的解决方案，但对其他人的意见持开放态度。我的解决方案是先让模板加载器功能测试文件是否存在。我还选择继续挂钩到“init”挂钩，因此首先加载静态包含/要求（或至少其中大部分）。该函数现在看起来像这样：

```
add_action ( 'init' , 'class_loader' );

function class_loader () {
    // register an autoloader function for template classes
    spl_autoload_register ( 'template_autoloader' );
}

function template_autoloader ( $class ) {
if ( file_exists ( LG_FE_DIR . "/includes/chart_templates/class.{$class}.php" ) ) 
    include LG_FE_DIR . "/includes/chart_templates/class.{$class}.php";

} 
```

# android - 带有ascii的android getNodeValue数据

> ID：11833035
> 
> 赞同：0
> 
> 时间：2012-08-06T17:27:14.817
> 
> 标签：android, xml, parsing, ascii

我有这样的问题。我必须解析 xml 并使用 ascii 编码的字符获取值。我的 xml 的一部分

```
 <response>
    <object>
    <id>793675</id>
    <name>&#381;irm&#363;n&#371;</name>
... 
```

得到一个值`name`我使用函数

```
public String getValue(Element item, String str) {
        NodeList n = item.getElementsByTagName(str);
        return getElementValue(n.item(0));
    }

public final String getElementValue( Node elem ) {
             Node child;
             if( elem != null){
                 if (elem.hasChildNodes()){
                     for( child = elem.getFirstChild(); child != null; child = child.getNextSibling() ){
                         if( child.getNodeType() == Node.TEXT_NODE  || child.getNodeType() == Node.CDATA_SECTION_NODE || child.getNodeType() == Node.ELEMENT_NODE){
                             return child.getNodeValue();
                         }
                     }
                 }
             }
             return "";
      } 
```

这样的方式：

```
Document doc = XMLfromString(xml);
NodeList nodes = doc.getElementsByTagName("object");
Element e = (Element)nodes.item(0);
String restName = Html.fromHtml(getValue(e, "name")).toString(); 
```

但结果我只有值，它包含之前的字符，`#` 我只有`&`在`restName` ie 字符串被截断为`#` 为什么？xml中允许该字符`#`，不是吗？如何获得完整的字符串值？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T17:37:41.413

使用 Sax Parser 和覆盖方法，如下所示：

您可能想使用 sax 默认处理程序。看看它是否有效。如果不是，可能需要扩展默认处理程序并覆盖此方法的行为以正确存储值。其中 myURLString 是您在扩展类中定义的变量。然后可以在 endElement 方法中访问此变量，例如。您可以完全控制这里。

所以一种方法是扩展 org.xml.sax.helpers.DefaultHandler;

```
 protected String myValueString;

    @Override
    public void characters(char[] ch, int start, int length) throws SAXException
    {
       super.characters(ch, start, length);  // deal with escape values here.
        myValueString = ...

    } 
```

然后在 endElement(){

```
 check if matches your type and if so use myValueString; 
```

# html - 浮动两个文本并排并居中

> ID：11833039
> 
> 赞同：2
> 
> 时间：2012-08-06T17:27:39.680
> 
> 标签：html, css

我想通过CSS实现以下

我有两个文本需要彼此相邻。示例：要在“电话”右侧的两个电话号码

电话：301xxxx

301xxxx

我可以使用两个 div 并将一个向左浮动来做到这一点。但我也希望他们两个都居中。构建它的最佳方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T17:35:39.840

**html:**

```
<div class="blah">
  <div>
    Phone:
  </div>
  <div>
    301xxxxx<br>
    301xxxxx
  </div>
</div>​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​ 
```

**CSS：**

```
​.blah {
    text-align:center
}
.blah > div {
    vertical-align:top;
    display:inline-block;   
} 
```

[**演示**](http://jsfiddle.net/BvFnb/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T17:31:59.557

您是在谈论彼此相邻的 2 个 div，然后将它们居中放置在页面上吗？

可能

将宽度设置为两个 div 以及将文本居中对齐到里面的文本？

```
<div id="outter">
<div id="div1"> phone 1</div>
<div id="div2"> phone 2</div>
<div style="clear:both"></div>
</div>

css

#outter{
width: 400px;
padding: 0;
margin: 0 auto;
}
#div1, #div2{
width: 50%;
float: left;
text-align:center;} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-06T17:40:25.750

您可以使用表结构来做到这一点：

```
<tr>
    <td>phone</td>
    <td>301xxxx</td><br />
    <td>301xxxx</td>
</tr> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-06T17:32:06.467

然后将它们放入`div`居中的父级中。

为了使块元素居中`div`，我们必须设置它的`width:`和`margin-left: auto; margin-right: auto;`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-06T17:38:31.643

演示：http: [//jsfiddle.net/LRuZp/4/](http://jsfiddle.net/LRuZp/4/)

# c# - 从 C# 程序调用批处理文件的建议

> ID：11833044
> 
> 赞同：1
> 
> 时间：2012-08-06T17:28:05.597
> 
> 标签：c#, batch-file, path, command, prompt

我对使用 C# 非常陌生，目前仅将其用于工作目的。我目前正在编辑一个现有的应用程序，并试图添加一个函数来调用我编写的批处理文件。此批处理文件运行 CLI 程序并执行一些错误级别检查以确保程序正确执行并向命令提示符报告任何错误。我不想用 C# 重写这个函数，因为当我在没有主程序的情况下执行这个任务时，这个批处理文件对我很有用。但是，如果需要在 C# 中重写此批处理文件的函数，我将不知道该怎么做。

我在网上找到了这段代码来运行我的批处理文件，效果很好：

```
 System.Diagnostics.Process proc = new System.Diagnostics.Process();
        proc.EnableRaisingEvents = false;
        proc.StartInfo.FileName = "C:mypath\\mybatfile.bat";
        proc.Start(); 
```

我对这段代码的唯一问题是它需要我在部署应用程序之前设置这条路径。我将把这个应用程序分发到其他几台机器上，最终可能会分发到更多机器上。我真的很想找到一种方法以某种方式将此路径链接到程序的保存位置，并将此批处理文件包含在应用程序的资源中。

这一切都可能非常偏离基础，并且提供的任何方向将不胜感激。

我对 C# 和其他 PC 编程中使用的术语知之甚少，因为我的大部分经验都在 uControllers 中。

编辑：我的程序是一个 GUI .xaml 应用程序。我还决定我愿意用 C# 重写我的批处理文件，因为我的批处理文件中也有一些我忘记的路径。有什么方法可以运行命令提示符应用程序并传递命令行参数并轻松检查错误级别？

编辑2：我添加这个只是为了帮助将来出现这个线程的任何人。这就是我最终解决问题的方法，使用下面 Dantix 的建议：

```
 System.Diagnostics.Process proc = new System.Diagnostics.Process();
        proc.EnableRaisingEvents = false;
        string bat_path = System.Reflection.Assembly.GetExecutingAssembly().Location; 
        proc.StartInfo.FileName = bat_path.Replace("\\myAppName.exe, "") + "\\myBatchFile.bat";
        proc.Start(); 
```

感谢所有的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T17:40:51.330

您可以使用`Application.StartupPath`获取启动应用程序的可执行文件的路径，不包括可执行文件名称。

根据您的要求，可能是
`proc.StartInfo.FileName = Application.StartupPath +"\\mybatfile.bat";`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T17:37:10.130

也许您可以使用[应用程序设置](http://msdn.microsoft.com/en-us/library/a65txexh.aspx)，或者如果您的程序是控制台应用程序，您可以使用[命令行参数](http://msdn.microsoft.com/en-us/library/cb20e19t.aspx)

# css - Eclipse 4.2 朱诺 CSS

> ID：11833045
> 
> 赞同：9
> 
> 时间：2012-08-06T17:28:14.253
> 
> 标签：css, eclipse

我试图通过 CSS 样式表简单地更新 Eclipse Juno 4.2 的外观。我看过一些教程，还有一个 stackoverflow 问题：

*   [http://www.vogella.com/articles/Eclipse4CSS/article.html](http://www.vogella.com/articles/Eclipse4CSS/article.html)
*   [eclipse Juno 自定义工作台颜色](https://stackoverflow.com/questions/11289312/eclipse-juno-custom-workbench-colors)
*   [http://www.woodwardweb.com/java/eclipse_juno_th.html](http://www.woodwardweb.com/java/eclipse_juno_th.html)

我已经安装了[CSS 间谍工具](http://marketplace.eclipse.org/content/eclipse-4-tools-css-spy)，但这只能让我进行临时更改。叹。我已经进入了`org.eclipse.platform_4.2.0.v201206081400`插件文件夹，并使用了`plugin.xml`.，但是我在那里所做的任何更改都没有任何影响（即使在重新启动之后）。

如何创建一个新主题并将其应用而不创建、编译和安装整个 Eclipse 插件项目到我的本地环境？或者，更好的是，我可以只修改现有主题吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-08-10T20:29:01.537

这是我如何让它工作的。

## 使用插件

我已经下载了[此处](https://github.com/eclipse-color-theme/eclipse-ui-themes)描述的**Eclipse UI 主题**插件（[直接链接](https://github.com/downloads/eclipse-color-theme/eclipse-ui-themes/com.github.eclipsecolortheme.themes_1.0.0.201207121019.zip)到存档）。但是我没有将其解压缩到目录中，而是将其解压缩到. 我还更改了它的权限以允许每个人修改它的文件。`dropins``plugins`

此时你有：

```
插件/com.github.eclipsecolortheme.themes_1.0.0.201207121019/
├── com
│ └── github
│ └── eclipsecolortheme
│ └── 主题
│ └── Activator.class
├── META-INF
│ └── MANIFEST.MF
├── plugin.xml
└── 主题
    └── css
        └── juno.css

```

`juno.css`文件是你想要的。启动 Eclipse 后，该主题将在*Appearance -> Dark Juno*下可用。

## 没有插件

研究后`plugin.xml`，我知道如何在不使用任何插件的情况下创建新主题。

```
<?xml version="1.0" encoding="UTF-8"?>
<?eclipse version="3.4"?>
<plugin>
   <extension
         point="org.eclipse.e4.ui.css.swt.theme">
      <theme
            basestylesheeturi="themes/css/juno.css"
            id="com.github.eclipsecolortheme.themes.darkjuno"
            label="Dark Juno">
      </theme>
   </extension>
</plugin> 
```

可以将`org.eclipse.e4.ui.css.swt.theme`扩展点添加到现有插件，例如`org.eclipse.platform_4.2.0.v201206081400`. 而且，它`plugin.xml`已经有了这个扩展点，你唯一需要做的就是添加一个合适的`theme`. 请注意，它必须具有唯一的`id`.

```
 <theme
            basestylesheeturi="css/my_theme.css"
            id="org.eclipse.e4.ui.css.theme.my_theme"
            label="My Theme Name">
      </theme> 
```

可以将新的 CSS 文件放入该`css`目录中，该目录已包含默认主题集。

```
org.eclipse.platform_4.2.0.v201206081400/
├── ...
├── css
│ ├── e4_basestyle.css
│ ├── e4_classic_win7.css
│ ├── e4_classic_winxp.css
│ ├── e4_default.css
│ ├── e4_default_gtk.css
│ └── ...
├── 图片
│ ├── gtkGrey.png
│ ├── gtkHandleDark.png
│ ├── gtkHandle.png
│ ├── gtkTSFrameDark.png
│ ├── gtkTSFrame.png
│ └── ...
├── META-INF
│ ├── eclipse.inf
│ ├── ECLIPSE_.RSA
│ ├── ECLIPSE_.SF
│ └── MANIFEST.MF
├── 平台.jar
├── plugin.properties
├── plugin.xml
└── ...

```

使用选项重新启动 Eclipse 后，`-clean`您将在所有主题列表中看到一个新创建的项目： ![新注册的主题](../Images/f198e5862c07fce96c2d550cfab9f3ad.png)

# UPD。1

对于我的安装，似乎对 CSS 的更改适用于 Eclipse 重新启动（*File -> Restart*，或者只是退出并手动启动它）。

我注意到的唯一奇怪的行为是`~/.e4css`目录中的 CSS 文件（如果有的话）会覆盖插件目录中的 CSS 文件。我不确定它来自哪里，但我可以安全地从中删除任何文件。我也不知道这个目录是否存在于非 Linux 系统上，但如果存在，我猜它应该位于用户主目录中的某个位置，或者可能位于`Documents`.

# UPD。2

我刚刚尝试从头开始添加一个新主题，并注意到上面的 XML 中有一个小错误。为了获得正确注册的新主题，它必须具有唯一`id`属性。否则会报错：

```
java.lang.IllegalArgumentException: A theme with the id 'org.eclipse.e4.ui.css.theme.e4_default' is already registered
    at org.eclipse.e4.ui.css.swt.internal.theme.ThemeEngine.registerTheme(ThemeEngine.java:186)
    ... 
```

似乎我说只是重新启动 Eclipse 来注册一个新主题就足够了。但是，`eclipse -clean`确实有诀窍。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-10T10:38:56.763

Launch eclipse with -clean option from command line after you have made changes in css files. Changes are not reflected otherwise. (Alternatively have a look at [http://eclipsecolorthemes.org/](http://eclipsecolorthemes.org/))

# php - 确定数字在哪个范围内的最有效方法？

> ID：11833046
> 
> 赞同：4
> 
> 时间：2012-08-06T17:28:15.347
> 
> 标签：php

我的应用程序生成一个 0 到 1000 之间的随机整数。

我有 5 个范围：`0-50`, `51-250`, `251-500`, `501-700`, `701-1000`. （请注意，范围大小不相等。）

我将分别调用这些范围：“0”、“50”、“250”、“500”、“700”（将这些名称存储在我的数据库中）。

我知道我可以做到以下几点：

```
if ($number > 700 && $number <=1000)
       $num_range='700';

else if... 
```

... 等等。

但是有没有更有效的方法呢？

提前非常感谢。问候

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-06T17:32:11.773

有效利用[`elseif`](http://php.net/manual/en/control-structures.elseif.php)：

```
if($number <= 50)
    $num_range='0';
elseif($number <= 250)
    $num_range='50';
elseif($number <= 500)
    $num_range='250';
elseif($number <= 700)
    $num_range='500';
elseif($number <= 1000)
    $num_range='700';
... 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-06T17:38:38.933

```
$ranges = array(0,50,250,500,700,1000....);  
$number = ....;

foreach($ranges as $range){
 if ($number>$range)
     continue;
 else 
     return prev($ranges);
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-08-06T17:41:50.350

```
$startPoints = array(700, 500, 250, 50);

$num_range = 0;
foreach ($startPoints as $from) {
    if ($number >= $from) {
        $num_range = $from;
        break;
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-06T17:41:13.550

```
$range[0] = range(0, 49);
$range[50] = range(50, 249);
$range[250] = range(250, 499);
.... 
```

然后做：

```
foreach($range as $r => $vals){
    if(in_array($number, $vals)){
        echo "Number is in range: $r";
    } 
} 
```

# java - JTable 选择所有班次行

> ID：11833050
> 
> 赞同：1
> 
> 时间：2012-08-06T17:28:44.127
> 
> 标签：java, swing, jtable

我将以下代码添加为 JTableHeader 的侦听器：

```
 header.addMouseListener(new MouseAdapter() {
        @Override
        public void mouseClicked(MouseEvent e) {
            JTableHeader header = (JTableHeader) e.getSource();
            JTable table = header.getTable();
            TableColumnModel columnModel = table.getColumnModel();
            int vci = columnModel.getColumnIndexAtX(e.getX());
            int mci = table.convertColumnIndexToModel(vci);
            if (mci == targetColumnIndex) {
                TableColumn column = columnModel.getColumn(vci);
                Object v = column.getHeaderValue();
                boolean b = Status.DESELECTED.equals(v) ? true : false;
                TableModel m = table.getModel();
                for (int i = 0; i < m.getRowCount(); i++) m.setValueAt(b, i, mci);
                column.setHeaderValue(b ? Status.SELECTED : Status.DESELECTED);
                //header.repaint();
            }
        }
    }); 
```

如果我手动选择多个单元格之一，然后如果我单击 ckeckAll 标题，则执行此代码，然后行的视觉顺序发生变化，选择跳到底部/顶部。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T17:33:11.797

a 中的`TableHeader`s`JTable`已经有一个内置的侦听器，该侦听器根据存储在该列中`Comparator`的特定类型对值进行排序。`Object`

您正在向该表添加第二个侦听器，而不是覆盖内置的侦听器。所以你看到了这两个动作的效果。

**更新**

如果您不想要任何排序功能，您可以禁用您的行排序器，或者只实现您自己的。您也可以实现自己的 custom `TableColumn`。

# nginx - 为什么 nginx 从缓存中删除文件？

> ID：11833056
> 
> 赞同：1
> 
> 时间：2012-08-06T17:29:00.093
> 
> 标签：nginx

我设置了 max_size=2000m 和 inactive=1440h。

尽管如此，尽管缓存只有 120Mb，但 Nginx 仍不断从缓存中删除文件。

我的缓存文件夹下的所有文件都没有超过一周的时间。

知道为什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T08:39:14.030

请阅读有关缓存的[http://nginx.org/en/docs/http/ngx_http_proxy_module.html文档。](http://nginx.org/en/docs/http/ngx_http_proxy_module.html)

```
在指定的时间内未访问的缓存数据
不活动的参数会从缓存中删除，无论它们的新鲜度如何。
```

所以，我想，你的缓存存在超过 60 天。当时的一些文件从未被访问过，并被删除。

# java - 地图和列表中的 ModCount

> ID：11833058
> 
> 赞同：4
> 
> 时间：2012-08-06T17:29:07.047
> 
> 标签：java, list, collections, hashmap

在 eclispse 中调试集合时，我只是检查有一个叫做 modCount 的东西，例如，如果我们调试列表，我们会在调试时看到这个 modCount 代表什么..!!请告知

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-06T17:36:16.343

请参阅 javadoc

**此列表在结构上被修改的次数**。*结构修改是那些改变列表大小的修改，或者以其他方式扰乱它，使得正在进行的迭代可能产生不正确的结果。*

*该字段由 iterator 和 listIterator 方法返回的迭代器和列表迭代器实现使用。如果此字段的值意外更改，迭代器（或列表迭代器）将抛出 ConcurrentModificationException 以响应下一个、删除、上一个、设置或添加操作。这提供了快速失败的行为，而不是面对迭代期间的并发修改时的不确定行为。*

*子类对该字段的使用是可选的。如果一个子类希望提供快速失败的迭代器（和列表迭代器），那么它只需要在其 add(int, E) 和 remove(int) 方法（以及它覆盖的任何其他导致结构列表的修改）。对 add(int, E) 或 remove(int) 的单个调用必须向该字段添加不超过一个，否则迭代器（和列表迭代器）将抛出虚假的 ConcurrentModificationExceptions。如果实现不希望提供快速失败的迭代器，则可以忽略此字段。*

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-06T17:34:25.300

它是一个计数器，用于在迭代集合时检测对集合的修改：迭代器会快速失败，如果在迭代期间修改了集合，则会抛出异常。`modCount`用于跟踪修改。

仅供参考，标准类的源代码是 JDK 的一部分，您可以阅读它们以了解标准类的工作原理。

# java - 将 XML 字符串转换为 ArrayList

> ID：11833059
> 
> 赞同：2
> 
> 时间：2012-08-06T17:29:23.133
> 
> 标签：java, android, xml, arrays, string

似乎是一个基本问题，但我在任何地方都找不到。基本上我有一个 XML 链接列表，如下所示：（全部在一个字符串中）

我已经有了包含所有 XML 的“字符串”变量。只需提取 HTML 字符串。

```
<?xml version="1.0" encoding="UTF-8"?>
<fql_query_response xmlns="http://api.facebook.com/1.0/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" list="true">
<photo>
    <src_small>http://photos-a.ak.fbcdn.net/hphotos-ak-ash4/486603_10151153207000351_1200565882_t.jpg</src_small>
</photo>
<photo>
  <src_small>http://photos-c.ak.fbcdn.net/hphotos-ak-ash3/578919_10150988289678715_1110488833_t.jpg</src_small>
</photo> 
```

我想将它们转换成一个数组列表，所以像 URLArray[0] 这样的东西将是第一个地址作为字符串。

谁能告诉我该怎么做谢谢？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-06T17:42:06.187

```
 DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();
  DocumentBuilder builder = factory.newDocumentBuilder();
  InputSource is = new InputSource( new StringReader( xmlString) );
  Document doc = builder.parse( is );

  XPathFactory factory = XPathFactory.newInstance();
  XPath xpath = factory.newXPath();
  xpath.setNamespaceContext(new PersonalNamespaceContext());
  XPathExpression expr = xpath.compile("//src_small/text()");

  Object result = expr.evaluate(doc, XPathConstants.NODESET);
  NodeList nodes = (NodeList) result;
  List<String> urls = new ArrayList<String>();
  for (int i = 0; i < nodes.getLength(); i++) {
      urls.add (nodes.item(i).getNodeValue());
      System.out.println(nodes.item(i).getNodeValue()); 
  } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-06T17:32:37.637

你是对的，应该有一些其他资源可以帮助你。也许您的搜索只是没有使用正确的关键字。

你基本上有2个选择：

1.  使用 XML 处理库。SAX、DOM、XPATH 和 xmlreader 是一些可以用来查找的关键字。

2.  只需忽略您的字符串是 xml 的事实并对其执行正常的字符串操作。拆分，遍历它，正则表达式等...

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-08-06T17:34:13.717

是的，您必须执行[XML Parsing](http://www.java-samples.com/showtutorial.php?tutorialid=152)。

然后将其存储在 ArrayList 中。

前任：

```
ArrayList<String> aList = new ArrayList<String>();

aList.add("your string"); 
```

# security - CSRF 是否可以使用 PUT 或 DELETE 方法？

> ID：11833061
> 
> 赞同：57
> 
> 时间：2012-08-06T17:29:34.597
> 
> 标签：security, csrf

CSRF 是否可以使用 PUT 或 DELETE 方法？还是使用 PUT 或 DELETE 会阻止 CSRF？

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2012-08-15T15:26:48.410

好问题！

在一个完美的世界里，我想不出一种方法来执行 CSRF 攻击。

*   您不能使用 HTML 表单发出 PUT 或 DELETE 请求。
*   图片、脚本标签、CSS 链接等都向服务器发送 GET 请求。
*   XmlHttpRequest 和 Flash/Silverlight/Applets 等浏览器插件会阻止跨域请求。

因此，一般来说，对支持 PUT/DELETE 动词的资源进行 CSRF 攻击是不可能的。

也就是说，世界并不完美。可能有几种方法可以使这种攻击成为可能：

1.  Rails 等 Web 框架支持“伪方法”。如果您放置一个名为 的隐藏字段`_method`，将其值设置为 PUT 或 DELETE，然后提交 GET 或 POST 请求，它将覆盖 HTTP 动词。这是一种从浏览器表单支持 PUT 或 DELETE 的方法。如果您正在使用这样的框架，您将不得不使用标准技术保护自己免受 CSRF 的影响

2.  您可能会不小心在服务器上为 CORS 设置了宽松的响应标头。这将允许任意网站发出 PUT 和 DELETE 请求。

3.  在某个时候，HTML5 计划在 HTML 表单中包含对 PUT 和 DELETE 的支持。但后来，他们取消了这种支持。不能保证以后不会添加。有些浏览器实际上*可能*支持这些动词，这可能对你不利。

4.  某些浏览器插件中可能存在一个错误，可能允许攻击者发出 PUT/DELETE 请求。

简而言之，我建议保护您的资源，即使它们仅支持 PUT 和 DELETE 方法。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-08-06T17:46:02.977

不。依靠 HTTP 动词不是防止 CSRF 攻击的方法。这完全取决于您的网站是如何创建的。您可以将 PUT 用作 POST，将 DELETE 用作 GET - 这并不重要。

[要防止 CSRF，请采取此处](http://en.wikipedia.org/wiki/CSRF)列出的一些步骤：

> 网站有各种可用的 CSRF 对策：
> 
> *   在所有表单提交和副作用 URL 中要求一个秘密的、用户特定的令牌可以防止 CSRF；攻击者的站点无法
>     在其提交的内容中放入正确的令牌[1](http://en.wikipedia.org/wiki/CSRF)
> *   要求客户端在同一 HTTP 请求中提供身份验证数据，该请求用于执行任何具有安全隐患的操作（汇款等）
> *   限制会话 cookie 的生命周期检查 HTTP Referer 标头或（和）
> *   检查 HTTP Origin 标头[16]
> *   确保没有 clientaccesspolicy.xml 文件授予对 Silverlight 控件的意外访问权限[17]
> *   确保没有 crossdomain.xml 文件授予对 Flash 电影的意外访问权限[18]
> *   验证请求的标头是否包含 X-Requested-With。由 Ruby on Rails（v2.0 之前）和 Django（v1.2.5 之前）使用。在浏览器插件和重定向的组合下，这种保护已被证明是不安全的[19]，这可能允许攻击者在对任何网站的请求中提供自定义 HTTP 标头，从而允许伪造请求。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2015-05-27T16:08:38.657

是的，CSRF*可以*使用 PUT 和 DELETE 方法，但只能在使用非限制性策略启用 CORS 的情况下。

我不同意[Sripathi Krishnan 的回答](https://stackoverflow.com/a/11972282/413180)：

> XmlHttpRequest 和 Flash/Silverlight/Applets 等浏览器插件会阻止跨域请求

没有什么能阻止浏览器发出跨域请求。同源[策略](https://stackoverflow.com/a/27781597/413180)不会阻止[发出](https://stackoverflow.com/a/28762923/413180)[请求](https://security.stackexchange.com/a/13011/8340)- 它所做的只是阻止浏览器读取[请求](https://security.stackexchange.com/a/86770/8340)。

如果服务器未选择[CORS](http://en.wikipedia.org/wiki/Cross-origin_resource_sharing)，这将导致发出预检请求。这是阻止使用 PUT 或 DELETE 的机制，因为它不是一个简单的请求（方法需要是 HEAD、GET 或 POST）。当然，假设有一个正确锁定的 CORS 策略（或者根本没有，默认情况下是安全的）。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2012-08-15T15:05:35.040

理论上它应该是不可能的，因为没有办法发起跨域 PUT 或 DELETE 请求（CORS 除外，但这需要预检请求，因此需要目标站点的合作）。在实践中，我不会依赖这一点 - 许多系统已经被例如假设 CSRF 文件上传攻击是不可能的（它不应该，但某些浏览器错误使其成为可能）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-04-21T17:21:27.420

CSRF 确实可以使用 PUT 和 DELETE，具体取决于服务器的配置。

考虑 CSRF 的最简单方法是考虑在浏览器中打开两个选项卡，一个在您的用户经过身份验证的情况下向您的应用程序打开，另一个选项卡向恶意网站打开。

如果恶意网站向您的应用程序发出 javascript 请求，浏览器将随请求一起发送标准 cookie，从而允许恶意网站使用已经过身份验证的会话“伪造”请求。该网站可以执行任何类型的请求，包括 GET、PUT、POST、DELETE 等。

防御CSFR的标准方法是发送一些恶意网站无法知道的请求。这可以像其中一个 cookie 的内容一样简单。虽然来自恶意站点的请求将随其发送 cookie，但它实际上无法访问 cookie，因为它由不同的域提供服务，并且浏览器安全性阻止它访问另一个域的 cookie。

将 cookie 内容称为“令牌”。您可以将令牌与请求一起发送，并在服务器上确保已正确提供“令牌”，然后再继续请求。

下一个问题是如何通过所有不同的请求发送该值，删除特别困难，因为它不是为具有任何类型的有效负载而设计的。在我看来，最简洁的方法是使用令牌指定请求标头。像这样的东西 x-security-token = token. 这样，您可以查看传入请求的标头，并拒绝任何缺少令牌的请求。

过去，标准的 ajax 安全性限制了恶意服务器上可以通过 ajax 执行的操作，但是，现在，该漏洞取决于您如何设置服务器的访问控制配置。有些人打开他们的服务器是为了更容易进行跨域调用或让用户创建自己的 RESTful 客户端等，但这也使得恶意站点更容易利用，除非上面的 CSRF 预防方法是到位。

# c# - 将gridview字符串转换为varchar用于c#中的sql插入语句

> ID：11833064
> 
> 赞同：0
> 
> 时间：2012-08-06T17:29:39.433
> 
> 标签：c#, asp.net, sql

我想在语句中使用一个`datagrid`项目作为变量。`insert`我不知道如何将字符串值转换为`varchar`.

这是我想要做的。

```
 { 
     string ord = grdDisplayOrd.Rows[1].Cells[2].Text;
     cmd.Parameters.Add("@ord", SqlDbType.VarChar).Value = ord; 
 } 
```

我在这里想念什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T17:40:42.203

您没有提供任何错误消息，但可能是因为您没有指定 SqlParameter 长度。无论如何，尝试使用

`cmd.Parameters.AddWithValue("@ord", ord);`

它会自动识别您的类型。

# c++ - 什么时候需要使用 std::ref ？

> ID：11833070
> 
> 赞同：33
> 
> 时间：2012-08-06T17:30:29.793
> 
> 标签：c++, c++11, portability, correctness

考虑：

```
std::tuple<int , const A&> func (const A& a) 
{
  return std::make_tuple( 0 , std::ref(a) );
} 
```

是否`std::ref`需要编写正确且可移植的代码？（没有它编译很好）

背景：

如果我删除`std::ref`我的代码构建良好，没有任何警告（`g++-4.6 -Wall`），但不能正确运行。

如果感兴趣，定义`A`：

```
struct A {
  std::array<int,2> vec;
  typedef int type_t;

  template<typename... OPs,typename... VALs>
  A& operator=(const std::pair< std::tuple<VALs...> , std::tuple<OPs...> >& e) {
    for( int i = 0 ; i < vec.size() ; ++i ) {
      vec[i] = eval( extract(i,e.first) , e.second );
    }
  }
}; 
```

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2017-08-22T17:19:22.063

`std::ref`必要的示例之一：

```
void update(int &data)  //expects a reference to int
{
    data = 15;
}
int main()
{
    int data = 10;

    // This doesn't compile as the data value is copied when its reference is expected.
    //std::thread t1(update, data);         

    std::thread t1(update, std::ref(data));  // works

    t1.join();
    return 0;
} 
```

构造`std::thread`函数复制提供的值，而不转换为预期的参数类型（在本例中为*引用*`update()`类型，请参阅 参考资料）。所以我们需要将**真正需要引用的参数包装**在`std::ref`.

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2012-08-06T17:35:21.110

`std::ref`不做参考，所以在你的代码示例中它没有做你所期望的。`std::ref`创建一个行为类似于引用的对象。例如，当您想要实例化一个仿函数并将其类似引用的版本传递给标准库算法时，它可能很有用。由于算法按值获取函子，因此您可以使用`std::ref`来包装函子。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2012-08-06T17:32:34.637

*   `make_tuple(0, a)`做一个`tuple<int, A>`.
*   `make_tuple(0, ref(a))`做一个`tuple<int, reference_wrapper<A>>`.
*   你也可以说`tuple<int, A&> t(0, a);`你不能用`make_tuple`或使用的元组`std::tie`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-12-23T11:04:28.997

回答标题 ( `When is the use of std::ref necessary?`) 中的问题：另一种`std::ref`有用的情况是循环遍历对象引用列表并修改它们：

```
std::vector<int> v1, v2;

void test() {
  for (std::vector<int>& vv : 
    // Compiles
    { std::ref(v1), std::ref(v2) } 

    // Compiler rejects this with:
    //   binding reference of type 'vector<...>' to value of 
    //   type 'const vector<...>' drops 'const' qualifier 
    // { v1, v2} 
  ) {
      vv.push_back(3);
  }
} 
```

如果不在`std::ref`列表中使用，对象将被视为`const`并且不能修改（另请参见[https://godbolt.org/z/Ta6YM31KM](https://godbolt.org/z/Ta6YM31KM)）。

# jquery - 重绘 openlayers 矢量图层

> ID：11833071
> 
> 赞同：1
> 
> 时间：2012-08-06T17:30:36.813
> 
> 标签：jquery, openlayers

我想重绘一个 OpenLayers 向量。

我的html按钮：

```
<button id="refresh" type="button">Refresh</button> 
```

和我的 jquery 函数来重绘图层，刷新函数中的 parksLayer 记录为 false：

```
function refresh() {
    parksLayer.redraw(true);
}

function bind(){
    $("#refresh").bind("click", refresh);
} 
```

和我的地图，我想重绘 ParksLayer：

```
 map = new OpenLayers.Map({
            div: "map",
            layers: [
                new OpenLayers.Layer.OSM(),
                parksLayer
            ]
        }); 
```

**更新**

感谢您的帮助，我的矢量图层定义如下：

```
function changeme(avalue){
        parksLayer = new OpenLayers.Layer.Vector("Parks", {
            projection: new OpenLayers.Projection("EPSG:4326"),
            strategies: [new OpenLayers.Strategy.Fixed()],
            protocol: new OpenLayers.Protocol.Script({
                url: "http://my.cartodb.com/api/v2/sql",
                params: {
        q: "SELECT * FROM activities where type_code is not null"+" "+avalue,
        format: "geojson"
    },
                format: new OpenLayers.Format.GeoJSON({
                    ignoreExtraDims: true
                }),
                callbackKey: "callback"
            }),
        });  
    } 
```

我有一个`avalue`动态变化的表单，它会改变 GeoJSON 查询，所以如果我可以重绘 parksLayer，我会从图层中得到一个新的选择。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-10T08:25:55.267

我也有 redraw() 的问题并使用它。

```
VecLayer.redraw(true);
VecLayer.refresh({force: true}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-06T17:43:14.110

如果我阅读 Openlayers API，redraw 函数不使用任何参数...您应该尝试调用 redraw() 而不将“true”作为参数...

Openlayers API: redraw: function() 重绘图层。如果图层被重绘，则返回 true，否则返回 false。

问候

艾蒂安

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-29T14:17:19.493

这是一个 KML 格式，但正如您所见，它很容易适应

```
 var refresh = new OpenLayers.Strategy.Refresh({force: true, active: true});

   var protocol = new OpenLayers.Protocol.HTTP({
         url: "http://my_data.source.com",
            format: new OpenLayers.Format.KML({
                  extractStyles: false,
                  extractAttributes: true
               })
            });

   mylayer = new OpenLayers.Layer.Vector("MyLayerName", {
            strategies: [new OpenLayers.Strategy.Fixed(), refresh],
            protocol: protocol
   }); 
```

然后重绘/重新下载数据：

```
refresh.refresh(); 
```

# jquery - jQuery 和数据表：将数组传递给服务器端数据源

> ID：11833073
> 
> 赞同：0
> 
> 时间：2012-08-06T17:30:47.053
> 
> 标签：jquery, arrays, asp.net-mvc-3, datatables

我有一个数据表，它使用这样的服务器端数据源：

```
 $('.taskTable').dataTable({
       "bServerSide": true,
       "bProcessing": false,
       "fnServerData": function (sSource, aoData, fnCallback) {
          ...
          aoData.push({ "name": "groupIDs", "value": $("#groupIDs").val() });
          ...
          $.ajax({
             'dataType': 'json',
             'type': 'post',
             'url': "@Url.Action(MVC.Tasks.Tasks.DataTable())",
             'data': aoData
          });
      }
   }); 
```

问题是，`$("#groupIDs").val()`没有格式化这些值，因此它们与我的模型（.NET MVC3）绑定。.NET 希望看到类似的东西，`groupIDs[0]=23&groupIDs[1]=42&...`但它却将其发送为`groupIDs=[23,42,...]`. 如何让数据表以正确的格式发送？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T17:58:41.653

弄清楚了。我决定手动输入这些值作为单独的参数，而不是努力让数据表按照我想要的方式自动格式化。

```
"fnServerData": function (sSource, aoData, fnCallback) {
   var groupIDs = $("#groupIDs").val()
   if (groupIDs != null) {
      for (x = 0; x < groupIDs.length; x++) {
         aoData.push({ "name": "groupIDs[" + x + "]", "value": groupIDs[x] });
      }
   }
   ... // more code
} 
```

效果很好。希望这对其他人有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T17:37:58.287

groups 23, 42, .... 相当于一个数组，现在我对 .net 了解不多，但我确信就像 PHP 一样，它在你的后端有一个 for, while, foreach 等价物循环这个数组并按照你的意愿处理它。

在这种情况下，你`groupdIDs=[23,42]`在后端的例子你会做类似的事情

（注意这是 PHP，我很抱歉它不是 .net）

```
foreach($_POST['groupIDs'] as $groupid)
{
   echo $groupid."<br>";
} 
```

或者

```
for($i=0;$i < count($_POST['groupIDs']);$i++)
{
    echo $_POST['groupIDs'][$i]."<br>";
} 
```

或者

```
echo $_POST['groupIDs'][0]."<br>";
echo $_POST['groupIDs'][1]."<br>"; 
```

# indexing - 每月重建 sybase 聚集索引偶尔会失败

> ID：11833074
> 
> 赞同：0
> 
> 时间：2012-08-06T17:30:58.510
> 
> 标签：indexing, sap-ase, rebuild

我遇到了在某些 sybase 数据库上删除和重新创建唯一聚集索引的问题。我无法在我的测试环境中重现该问题。

并发问题出现时产生的错误如下：

无法删除或修改分区描述符数据库 'xxx' (43)、对象 xx、索引 xx (0)、分区 'xx'，因为它正在使用中。请稍后重试您的命令。总引用计数“4”。任务引用计数“2”。

我知道打开 tran 对表或行的排他锁不会导致这种情况，而且我认为最终用户可能做的任何事情都不会改变数据的排序顺序。

数据是集群循环，并且是单个分区表。

请指教。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T10:37:48.953

您可以改用“reorg”吗？那会产生相同的效果并且不应该受到这种影响吗？但我不确定，因为我喜欢你看不到这是怎么发生的——在 Sybase 获得表锁之前不应该开始构建新的聚集索引（它必须用于聚集，）所以为什么它看起来是别的东西访问？（DBCC，或者系统级别的系统目录上的锁定可能，所以虽然索引可以建立，但更新系统目录的一些事情会失败？）

在 15.0.3 之前 esd 4 REORG 会导致其他尝试访问正在重组的表的查询失败，而不是被阻塞，这可能很烦人。

# css - 在背景上使用多个图像

> ID：11833078
> 
> 赞同：1
> 
> 时间：2012-08-06T17:31:12.810
> 
> 标签：css, background-image

我在网页背景中使用多个图像时遇到问题。我为此使用了以下代码：

```
body{
background-image: url(images/img1.png), url(images/img2.png); } 
```

我使用的代码在背景上给了我两张图片，但我想将其中一张图片准确地放在中心。如何使用 CSS 做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T17:34:37.903

是的，你可以这样做

```
body {
    background-image: url(images/img1.png), url(images/img2.png);
    background-repeat: no-repeat, repeat-x;
    background-position: center, top left;
} 
```

在这里查看[演示](http://jsfiddle.net/Starx/JwFTv/)。

# vb.net - 数据源超出索引的datagridview

> ID：11833079
> 
> 赞同：2
> 
> 时间：2012-08-06T17:31:15.717
> 
> 标签：vb.net, datagridview, indexoutofboundsexception

我将一些字段绑定到 datagridview

```
myDataGridView.datasource = List(of MyCustomObject) 
```

而且我从不手动触摸索引，但我得到 -1 索引没有价值（所以，一个超出范围的错误）

当我选择网格中的任何行时，onRowEnter() 事件会出现错误。它甚至没有输入我的任何事件来处理我的 clic，它之前会出错......

在界面上，在点击之前，我可以看到网格 2 中没有行是（currentRow）。我猜这个错误来自那里，但我不知道如何手动设置 currentRow 或简单地避免这个错误......

有人见过这个吗？

编辑 - 我添加了一些代码来测试：

```
 dgvAssDet.CurrentCell = dgvAssDet.Rows(0).Cells(0) 
```

当这个分配运行时，currentCell = nothing，有> 5行和列......

而且我遇到了同样的错误，在更改旧的 currentCell 之前，它会尝试检索它，但在我的情况下，没有任何错误，而且它会出错......我不知道为什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T18:34:45.240

在 DGV 上使用 DataSource 时，应该使用 collection `System.ComponentModel.BindingList<T>`，而不是`System.Collections.Generic.List<T>`

```
public class MyObject
{
    public int Field1 { get; set; }
    public MyObject() { }
}

public partial class Form1 : Form
{
    public Form1()
    {
        InitializeComponent();
        DataGridViewTest();
    }

    public void DataGridViewTest() {
        BindingList<MyObject> objects = new BindingList<MyObject>();
        dataGridView1.AutoGenerateColumns = true;
        dataGridView1.DataSource = objects;
        dataGridView1.AllowUserToAddRows = true;
        objects.Add(new MyObject() {
            Field1 = 1
        });

    }
} 
```

如果您的对象列表是您的类型，`List<T>`您将获得索引超出范围错误。

# sencha-touch-2 - 标题中的图像不会显示

> ID：11833091
> 
> 赞同：0
> 
> 时间：2012-08-06T17:32:27.903
> 
> 标签：sencha-touch-2

我正在尝试构建一个具有顶部居中徽标的标题栏的界面。这是我正在使用的代码。图片不显示。在运行时检查元素时，元素显示的高度为“0”，而不是使用 100% 来匹配包含元素的高度。

```
Ext.define("RFN.view.Main", {
    extend: 'Ext.TabPanel',

    config: {
         tabBarPosition: 'bottom',
         items: [
            {
             title: 'Calculate',
             iconCls: 'home',
             //styleHtmlContent: true,
             //scrollable: true,
             layout: 'vbox',
             items:[
               {
                xtype: 'panel',
                style: 'background-color: #174a7c;text-align:center;',
                items:[
                  {
                   xtype: 'image',
                   src: 'resources/images/logo.png',
                   height: '100%'
                  }
                ],
                flex: 1
              },
              {
               xtype: 'panel',
               style: 'background-color: #999999;',
               flex:4
              }
             ]
            },
            {
             title: 'Compare',
             iconCls: 'chart2',
             //styleHtmlContent: true,
             //scrollable: true,
             layout: 'vbox',
             items:[
               {
                style: 'background-color: #174a7c;',
                flex: 1
               },
               {
                style: 'background-color: #999999;',
                flex:4
               }
             ]
            }
         ]
    }
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T22:24:59.640

只需在包含图像的面板上添加布局配置。然后，您可以删除图像上的高度配置，因为布局使内部项目自动适应整个高度和宽度：

```
...
xtype: 'panel',
style: 'background-color: #174a7c;text-align:center;',
items:[{
    xtype: 'image',
    src: 'resources/images/logo.png',
}],
flex: 1
... 
```

希望这可以帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T22:31:27.463

或者你可以做我所做的，并有一个 vbox 的布局，标题的 flex 为 0.3，我的 tabpanel 为 0.7。0.3 的项目是一个面板，在类配置（cls）中，我有我的 CSS 类名，例如 Header。在我的 CSS 类 .header 中，我设置了背景和徽标。希望这可以帮助...

# wcf - 关于 wcf soap 和 xml 的说明

> ID：11833095
> 
> 赞同：1
> 
> 时间：2012-08-06T17:32:38.983
> 
> 标签：wcf, web-services, soap

我目前正在为我的一个项目使用 wcf，在此之前我也使用过 Web 服务，但我有一些疑问需要澄清。

1）在Web服务通信中，我们使用soap进行跨平台通信，但我想知道为什么需要soap，因为XML本身是普遍接受的数据交换格式，而不是为什么需要soap内部使用xml标签进行数据交换

2）如果我在 wcf 中使用 gethttpenabled 而不是 mex 协议进行数据交换，它会生成简单的 Web 服务代理进行通信，因此想知道我的服务是否使用 nettcpbinding 而不是基本或 ws http 绑定，以便 wcf 和客户端是否可以通信或将创建一些问题。

3) 由于soap可以和tcp协议一起使用，所以tcp协议是否可以用于java中client和net中wcf的不同平台之间的通信

# python - ImportError：安装看门狗后没有名为观察者的模块

> ID：11833100
> 
> 赞同：12
> 
> 时间：2012-08-06T17:33:05.353
> 
> 标签：python, importerror, watchdog

在使用 pip:安装模块后，我尝试运行[官方看门狗简单示例](http://packages.python.org/watchdog/quickstart.html#a-simple-example)，但出现错误：`watchdog``pip install watchdog`

```
from watchdog.observers import Observer
ImportError: No module named observers 
```

有人可以帮帮我吗？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-08-07T06:40:13.227

我想出了 ImportError 问题的原因。我的模块名称与我尝试导入的模块名称相同。将我的模块重命名为看门狗或观察者以外的其他名称解决了这个问题。感谢你的帮助！

# regex - 参考第10个子赛

> ID：11833104
> 
> 赞同：4
> 
> 时间：2012-08-06T17:33:24.473
> 
> 标签：regex, sed

通常当你调用 sed 时，你可以调用`\1`引用第一个子匹配，即：

```
<something> | sed "s/<regex>\(<regex>\)<regex>/\1/" 
```

这将只采用中间正则表达式并删除外部正则表达式。

但是，如果您有超过 9 个匹配项，您会怎么做？简单地写`\10`是行不通的，因为它会被解释为`take submatch number one and add a zero behind it`.

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-06T17:56:05.513

这在 sed 中是不可能的。您将不得不使用不同的工具。

以下是关于 SO 的类似问题：

[绕过 sed 反向引用限制 \1 到 \9](https://stackoverflow.com/questions/4318114/circumvent-the-sed-backreference-limit-1-through-9)。

[如何在 sed 中获得第 10 个分组值？](https://stackoverflow.com/questions/10992650/how-to-get-10th-grouping-value-in-sed)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T17:42:48.163

我不确定 SED，但在许多具有允许子匹配（或有时称为反向引用）的正则表达式实现的语言（javascript、ruby）中，仅支持`\1`通过`\9`. `\10`根本不允许。

任何额外的反向引用都需要使用更复杂的解析器。

# c++ - sizeof(float) 在所有架构上总是等于 sizeof(int) 吗？

> ID：11833105
> 
> 赞同：5
> 
> 时间：2012-08-06T17:33:27.000
> 
> 标签：c++, c, memory, malloc, sizeof

我看到代码使用`sizeof(int)`.
我想知道在所有架构上 是否`sizeof(float)`总是等于？`sizeof(int)`

```
float *pointer2Float = (float *) USER_DEFINED_MALLOC (...,..., sizeof(int)) 
```

注意：`USER_DEFINED_MALLOC`我认为这是传统 malloc 的包装器。

谢谢

问候

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-08-06T17:35:14.253

不，有 16-bit`int`和 32-bit的实现（主要是嵌入式系统） `float`。

当然，根据标准，尺寸允许有很大的不同。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-08-06T17:36:38.903

ALL 类型（除了`char`,`signed char`和`unsigned char`¹）的大小是实现定义的。因此，**不能**保证在*所有*平台上都`sizeof(float)`等于。`sizeof(int)`

 *^(1\. 标准定义其大小`char`及其所有变体为 1 字节。但是， 1 字节中的*位数*是实现定义的！)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-08-06T17:42:49.150

不，`sizeof (int)`值`sizeof (float)`是实现定义的，不保证相同。

这是两个值不同的系统示例：

在 Cray MPP 系统上：

```
sizeof (int)  is 8

sizeof (float) is 4 
```

看这里：

> 《Cray C/C++ 参考手册》，表 3.《9.1.2.2 类型》中的 Cray Research 系统数据类型映射

[http://docs.cray.com/books/004-2179-003/004-2179-003-manual.pdf](http://docs.cray.com/books/004-2179-003/004-2179-003-manual.pdf)

此外，大多数 8 位嵌入式系统`int`的 16 位宽`sizeof (int)`为 2，而浮点遵循 IEEE-754，32`float`位宽`sizeof (float)`为 4。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-08-06T17:37:06.093

不会。在 C 和 C++ 中，数据类型是特定于平台的。一般来说，这将意味着：

> 但是对于其他系统，一般规范是 int 具有系统架构（一个“单词”）建议的自然大小，并且四种整数类型 char、short、int 和 long 必须至少与前面的一样大它，char 总是一个字节的大小。这同样适用于浮点类型 float、double 和 long double，其中每一个都必须提供至少与前一个一样多的精度。

（取自[数据类型](http://www.cplusplus.com/doc/tutorial/variables/)）

在许多平台上，float 和 int 通常都是 32 位的，但情况并非总是如此，也不是实际规范的一部分。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-08-06T17:37:44.093

绝对不能保证`sizeof (float)`等于`sizeof (int)`，我认为以上是编码错误。

它*应该*用于或。 `sizeof *ptrToFloat`_`sizeof (int)``sizeof (float)`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-06T20:05:18.847

如果您正在编写一个数据类型大小非常重要的多平台，您可以创建一个头文件，例如：

```
#define INT sizeof(int)
#define FLOAT sizeof(float)
.
.
. 
```

这是欺骗拱门的把戏。*

# css - 单页网站和仅在一个 div 中的垂直对齐

> ID：11833107
> 
> 赞同：0
> 
> 时间：2012-08-06T17:33:50.007
> 
> 标签：css, vertical-alignment

在我的网站[http://goo.gl/16XdA](http://goo.gl/16XdA)页面“联系我们”上，我希望联系人框在容器 div“联系我们”中垂直对齐。问题在于，使用当前代码，联系人框在“联系我们”div 的 1400 像素高度的中间对齐。无论屏幕分辨率是多少，有没有办法将联系人框对齐到屏幕中间？（或为contact-us div设置100％的高度，但这不起作用）

```
#contact-us {
    height: 1400px;
    background: #8aba56;
    padding-top: 250px;
    position: relative;
    background: url(../images/bg-water13.jpg) no-repeat center fixed;
    -webkit-background-size: cover;
    -moz-background-size: cover;
    background-size: cover;
}
#contact-box {
    text-align:center;
    font: 12px 'Open Sans', "Helvetica Neue", Helvetica, Arial, "Lucida Grande", sans-serif;
    font-weight: 400;
    width: 300px;
    Height:120px;
    padding:15px;
    /*margin-left: auto;
    margin-right: auto;*/
    -ms-filter: "progid:DXImageTransform.Microsoft.Alpha(Opacity=85)";
    filter: alpha(opacity=95);
    opacity: 0.85; /* For IE8 and earlier */
    border: 1px dotted #666;
    background: #fff;
    position: absolute;
    top: 50%;
    left: 50%;
    margin-top: -60px;
    margin-left: -150px;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T17:54:36.477

我在 chrome 上查看了您的网站，它位于#contact-us 的中心。但是，contact-us 的高度为 1650 像素，因为您添加了 250 像素的填充，因此 div 位于 1400 框的中心，但顶部位置添加了 250 像素。

您可以通过将 box-sizing 更改为 border-box 或增加 margin-top 来解决此问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T18:01:29.533

更改 to 及其父元素（html 和 body）的高度`#contact-us`，*并*`100%`删除其填充：

 *```
html, body, #contact-us {
    height: 100%;
}

#contact-us {
    padding: 0;
} 
```*

# bash - 一个命令 shell 脚本中同一字符串/行的不同“替换”

> ID：11833108
> 
> 赞同：2
> 
> 时间：2012-08-06T17:34:06.407
> 
> 标签：bash, shell

对不起，如果这听起来很愚蠢，请原谅这个新手。
这是我的代码

```
line="abcd<>efgh->higk<-1234"
v1=$(echo ${line//<>/;})
echo $v1                   --> outputs "abcd;efgh->hijk<-1234"
v2=$(echo ${v1//->/})  
echo $v2                   --> output "abcd;efghhijk<-1234"
echo ${$v2//<-/}           --> output "abcd;efghhijk1234" 
```

如果不将输出存储到中间变量，我可以知道如何实现这个输出 **abcd;efghhijk1234**

谢谢你的时间

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T17:45:55.690

您可以使用`sed`和管道`|`来分隔替换命令：

```
line="abcd<>efgh->highk<-1234"
v1=$(echo ${line} | sed 's|<>|;|g' | sed 's|->||g' | sed 's|<-||g')
echo $v1 
```

以上将输出请求的`abcd;efghhijk1234`.

或者，如果您不想使用多个`sed`命令，则可以将它们全部与`-e`选项结合使用：

```
v1=$(echo $line | sed -e 's/<>/;/g' -e 's/->\|<-//g'); 
```

注意：我在第二个命令中将`sed`-pattern 中使用的分隔符从 a`|`更改为 a 。`/`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T17:57:53.140

您不能使用 bash 参数扩展在一行中完成所有操作，但您可以利用 bash 的扩展模式匹配同时删除 <- 和 ->。

```
shopt -s extglob
line="abcd<>efgh->higk<-1234"
v1=${line//<>/;}
v2=${v1//@(->|<-)} 
```

由于这两个项目都被相同的替换文本（空字符串）替换，因此您可以匹配其中任何一个的所有出现。

# javascript - 如何在 Firefox 插件中覆盖 preventDefault/stopPropagation

> ID：11833110
> 
> 赞同：2
> 
> 时间：2012-08-06T17:34:16.230
> 
> 标签：javascript, firefox-addon, dom-events

我正在编写一个 Firefox 插件（在 Javascript 中），并且需要覆盖所有事件对象（键盘、鼠标、HTML ......）上的 preventDefault 和 stopPropagation。我打算调用原始函数，但希望在 Web 应用程序调用这些函数时得到通知。

关于我如何做到这一点的任何指示？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T16:59:32.510

从来没有想过如何拦截 Event 对象上的 stopPropagation 和 preventDefault，但是，我的意图是在我调度的事件（在我的 Firefox 插件中）上调用 preventDefault 时收到通知，我可以查看 dispatchEvent 的返回值查明是否调用了 preventDefault。这满足了我目前的要求。

# excel - Excel VBA 导入具有可变列宽的 TXT 文件

> ID：11833114
> 
> 赞同：0
> 
> 时间：2012-08-06T17:34:36.523
> 
> 标签：excel, import, fixed, fixed-width, vba

我在通过 VBA 将固定文件 (TXT) 导入 Excel 时遇到了挑战。问题并不是真正将数据导入 Excel（下面的代码），而是根据 TXT 文件的列内容更改列宽。

任何帮助都非常受欢迎！

例子：

txt文件的内容是：

```
 FirstC        SecondC           ThirdC
A             111122223333      444455556666
B             111122223333      444455556666
A             111122223333      444455556666
A             111122223333      444455556666
B             111122223333      444455556666 
```

根据第一列 (FirstC) 的内容，Excel 中的导入列宽应更改，即对于 A，第二列 (SecondC) 的列宽应为 8 位，如果是 B，则应为 10 位

**导入代码（不是专业人士，如果代码有点乱，请见谅）：**

```
 Sub Button1_Click()

Dim vPath As Variant

vPath = Application.GetOpenFilename("TextFiles (*.txt), *.txt", , "TEST TEXT IMPORTER:")
If vPath = False Then Exit Sub
Filename = vPath
Debug.Print vPath

Worksheets("IMPORT").UsedRange.ClearContents

With Sheets("IMPORT").QueryTables.Add(Connection:="TEXT;" & CStr(vPath), Destination:=Sheets("IMPORT").Range("A2"))
       .FieldNames = True
       .RowNumbers = False
       .FillAdjacentFormulas = False
       .PreserveFormatting = True
       .RefreshOnFileOpen = False
       .RefreshStyle = xlInsertDeleteCells
       .SavePassword = False
       .SaveData = True
       .AdjustColumnWidth = True
       .RefreshPeriod = 0
       .TextFilePromptOnRefresh = False
       .TextFilePlatform = xlWindows
       .TextFileStartRow = 1
       .TextFileParseType = xlFixedWidth
       .TextFileTextQualifier = xlTextQualifierDoubleQuote
       .TextFileConsecutiveDelimiter = False
       .TextFileTabDelimiter = False
       .TextFileSemicolonDelimiter = False
       .TextFileCommaDelimiter = False
       .TextFileSpaceDelimiter = False
       .TextFileColumnDataTypes = Array(2, 2, 2)
       .TextFileFixedColumnWidths = Array(14, 18, 12)  
       .TextFileFixedColumnWidths = Array(14, 18, 12)    '<-- That’s where  I need to be flexible
       .TextFileTrailingMinusNumbers = True
       .Refresh BackgroundQuery:=False

   End With

End Sub 
```

* * *

在我的代码下面进行了一些修改，除了第四列没有显示之外它可以工作。实际上将添加更多列，因此很高兴看到我必须在哪里调整代码以便灵活使用列。任何的想法？提前致谢

文本文件（只有 2 行，以后会更多）看起来像这样：

```
0000000002666980001F2002
0000000002666980002G1020709500430120101L05200000000000000000000 
```

* * *

编码：

```
Sub Button1_Click()

    Const fPath As String = "H:\MyDocs\xxxxx\TestFiles6.txt"
    Const fsoForReading = 1
    Const F1_LEN As Integer = 15    'Reference Number
    Const F2_LEN As Integer = 4     'Cosectuive Number
    Const F3_LEN As Integer = 1     'Record Type
    Const F4_Len As Integer = 4     'Company Number

    Dim objFSO As Object
    Dim objTextStream As Object
    Dim start As Integer
    Dim fLen As Integer
    Dim rw As Long

    Set objFSO = CreateObject("scripting.filesystemobject")
    Set objTextStream = objFSO.OpenTextFile(fPath, fsoForReading)
    rw = 2

    Do Until objTextStream.AtEndOfStream
        txt = objTextStream.Readline

        f1 = Trim(Left(txt, F1_LEN))
   '------------------------------------------------------------------------------------------------------------
        start = F1_LEN + 1
        f2 = Trim(Mid(txt, start, F2_LEN))
   '------------------------------------------------------------------------------------------------------------
        start = F1_LEN + F2_LEN + 1
        f3 = Trim(Mid(txt, start, F3_LEN))

        If f3 = "F" Then
            fLen = 4
        ElseIf f3 = "G" Then
            fLen = 50
        Else

        End If

        Debug.Print start
    '------------------------------------------------------------------------------------------------------------
        start = start + 1
        f4 = Trim(Mid(txt, start, fLen))
        Debug.Print f4
    '------------------------------------------------------------------------------------------------------------
        ThisWorkbook.Sheets("data").Cells(rw, 1).Resize(1, 3).Value = Array(f1, f2, f3, f4)
        rw = rw + 1
    Loop

    objTextStream.Close 
```

结束子

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T06:22:32.620

未经测试：

```
Sub Tester()

    Const fPath As String = "C:\SomeFile.txt"
    Const fsoForReading = 1
    Const F1_LEN As Integer = 14
    Const F2_LEN_A As Integer = 8
    Const F2_LEN_B As Integer = 10
    Const F3_LEN As Integer = 14

    Dim objFSO As Object, objTextStream As Object, txt, f1, f2, f3
    Dim start As Integer, fLen As Integer
    Dim rw As Long

    Set objFSO = CreateObject("scripting.filesystemobject")
    Set objTextStream = objFSO.OpenTextFile(fPath, fsoForReading)
    rw = 2

    Do Until objTextStream.AtEndOfStream
        txt = objTextStream.Readline

        f1 = Trim(Left(txt, F1_LEN))
        start = F1_LEN + 1

        If f1 = "A" Then
            fLen = 8
        ElseIf f1 = "B" Then
            fLen = 10
        Else
            'what if?
        End If

        f2 = Trim(Mid(txt, start, fLen))
        start = start + fLen + 1
        f3 = Trim(Mid(txt, start, F3_LEN))

        With ThisWorkbook.Sheets("data").Cells(rw, 1).Resize(1, 3)
            .NumberFormat = "@" 'format cells as text 
            .Value = Array(f1, f2, f3)
            'alternatively.....
            '.cells(1).Value = f1
            '.cells(3).Value = f3
        End With
        rw = rw + 1
    Loop

    objTextStream.Close
End Sub 
```

# android - 如何启动具有特定方向的外部活动/应用程序？

> ID：11833116
> 
> 赞同：1
> 
> 时间：2012-08-06T17:34:42.393
> 
> 标签：android

启动一个外部活动/应用程序非常容易。

```
Intent intentHandle = this.getPackageManager().getLaunchIntentForPackage("com.android.browser");

this.startActivity(intentHandle); 
```

但是有没有可能指定方向，强制使用外部Activity/Application？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T17:47:42.923

是的，您可以在清单中指定活动的方向。

[强制 Android 活动始终使用横向模式](https://stackoverflow.com/questions/2150287/force-an-android-activity-to-always-use-landscape-mode)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T17:50:04.630

这取决于应用程序的源代码。据我所知，这是不可能的。因为每个应用程序可以以不同的方式处理方向变化，或者根本不这样做。

# ruby-on-rails - Aptana Studio 3 ERB 文件语法高亮和源代码导航

> ID：11833118
> 
> 赞同：4
> 
> 时间：2012-08-06T17:34:48.400
> 
> 标签：ruby-on-rails, syntax-highlighting, erb, aptana3

我刚刚开始使用 Aptana Studio 3 来处理 Ruby-on-Rails 项目。在浏览源代码时，我发现缺少以下功能：

1.  在 ERB 文件中，没有块开始/结束或 if..end 开始/结束突出显示。我浏览了*Window/Preferences/Aptana Studio/Editors/ERB*下的设置。是否有任何设置可用于启用相同功能？

2.  在 ERB 文件中，如果包含部分，则要查看包含部分中的代码，我需要使用**Ctrl + T**搜索部分并输入部分的确切名称（以 UNDERSCORE 开头）以打开它。不是有什么快捷方式可以直接从ERB文件跳转到部分文件吗？

3.  在 ERB/H​​AML 文件中，在代码中对对象调用的方法上按 F3 会打开*转到定义 1*并*打开声明 2*，但没有任何反应。另一方面，对 .rb 文件中的任何方法执行相同操作会显示文件列表/打开包含所选方法的文件。在这里找到一个相关的问题，但没有回复：[Aptana ruby​​ code assistant features not working for erb files](https://stackoverflow.com/questions/11822803/aptana-ruby-code-assist-features-not-working-for-erb-files)

Aptana 团队中的任何人都可以对上述内容发表评论/指导吗？

谢谢。

# c# - Thread.BeginThreadAffinity

> ID：11833120
> 
> 赞同：2
> 
> 时间：2012-08-06T17:34:57.383
> 
> 标签：c#, .net

我一直试图从我的一个程序中挤出更多性能，并且正在阅读优先级和亲和力设置，我遇到了`Thread.BeginThreadAffinity`，它的文档说：

> 通知主机托管代码即将执行取决于当前物理操作系统线程标识的指令。

我在我的程序中对此进行了测试，性能提高了大约 3-4%。据我了解，如果您的代码被移动到不同的物理操作系统线程，它会失去亲和性设置，但`Thread.BeginAffinity`它会保持在同一个线程上，保持亲和性设置，因为我的代码被提升了，我会获得更高的性能。

这是它的工作原理，还是我误解了`Thread.BeginAffinity`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T18:02:35.567

As per [msdn](http://msdn.microsoft.com/en-us/library/system.threading.thread.beginthreadaffinity.aspx) you are correct

> Some hosts of the common language runtime, such as Microsoft SQL Server 2005, provide their own thread management. A host that provides its own thread management can move an executing task from one physical operating system thread to another at any time. Most tasks are not affected by this switching. However, some tasks have thread affinity - that is, they depend on the identity of a physical operating system thread. These tasks must inform the host when they execute code that should not be switched.
> 
> For example, if your application calls a system API to acquire an operating system lock that has thread affinity, such as a Win32 CRITICAL_SECTION, you must call BeginThreadAffinity before acquiring the lock, and EndThreadAffinity after releasing the lock.
> 
> Using this method in code that runs under SQL Server 2005 requires the code to be run at the highest host protection level.

# database - SQLSTATE [42000]：语法错误或访问冲突：1305

> ID：11833122
> 
> 赞同：1
> 
> 时间：2012-08-06T17:35:11.757
> 
> 标签：database, fuelphp

我一直在使用 FuelPHP 开发一个新的 Web 应用程序。今天，突然间，当我尝试向数据库添加信息时，开始出现错误。

我仍然可以从数据库中检索信息，因此登录信息必须正确。但是，当我尝试添加信息时，我收到以下错误消息：

> 错误 - 2012-08-06 15:48:37 --> 错误 - SQLSTATE [42000]：语法错误或访问冲突：1305 FUNCTION dan_monline.LOWER 不存在查询：“SELECT LOWER ( `name`) FROM `countries`WHERE `name`= 'costa rica '” 在 /home/danlucas/public_html/portfolio-dir/music-online/fuel/core/classes/database/pdo/connection.php 167 行

我不确定这是否是 FuelPHP 特定的错误，或者是否是导致问题的 MySQL。据我了解，它是说'LOWER'不存在？

有没有人见过这个错误或知道如何解决它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T09:39:23.817

再次尝试删除“LOWER”后的空格。

--
选择较低（...

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-27T14:17:33.247

通过更新mysql软件解决了这个问题。

# eclipse - eclipse中的常用工作区设置

> ID：11833126
> 
> 赞同：1
> 
> 时间：2012-08-06T17:35:20.447
> 
> 标签：eclipse, configuration, workspace

我想创建几个指向代码库不同分支的工作区。我面临的问题是每次我需要创建一个新的工作区时，我都必须为每个工作区进行相同的配置。

例子：

1.  设置 tomcat 配置及其相关的 java 选项，例如库和 java 代理设置。
2.  指向包含我的 jar 文件的特定文件夹的系统变量。
3.  另一个系统变量

问题：

1.  是否可以一次完成这些设置，以便不需要配置所有后续工作区？
2.  是否可以导出这些首选项并稍后导入我的机器或其他机器上的任何工作区？

系统信息：
Windows 7、Eclipse 3.5、Sysdeo tomcat 插件、Tomcat 6

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T17:51:27.403

虽然 eclipse 确实有一个导出首选项选项，但它不会导出所有内容，特别是它对于工作空间复制来说不够全面。

在过去，我仅仅克隆了物理工作区文件夹本身就取得了很大的成功。

例如，假设您已经设置了工作区，其中包含您想要的所有内容。要复制它，请转到 找到当前工作区文件夹的路径`File -> Switch workspace -> Other`。此处弹出的对话框中显示的路径是当前工作区路径（暂时不要按确定）

创建此文件夹的副本。现在要使用这个副本，只需在上面的对话中使用它，即转到`File -> Switch workspace -> Other`并放入副本的路径。按下`OK`，Eclipse 将使用新的工作区重新启动。现在您唯一需要做的就是将代码指向不同的分支。其余所有设置应该已经存在。

这在同一台机器上特别有效。如果您复制此工作区文件夹，它应该仍然可以工作，但您的里程可能会有所不同。

# ios - iOS 在应用程序内存不足警告上淡出音频

> ID：11833130
> 
> 赞同：0
> 
> 时间：2012-08-06T17:35:30.443
> 
> 标签：ios, ios5, audio, volume

我正在寻找一种`didReceiveMemoryWarning`在终止音频播放器之前利用淡出我的应用程序中播放的音乐的方法。我想在不影响系统音量的情况下淡出音乐并从内存中删除播放器（或者至少在完成后重置系统音量。）我只需要支持 iOS 5+。

我在这里问这个问题的原因是：

1.  我无法访问实际播放音乐的代码，它位于第 3 方框架中（所以我认为我唯一的解决方案是调整系统音量。）
2.  到目前为止，我发现的所有解决方案都相当陈旧、老套，和/或带有关于不被 App Store 接受的警告等。

有没有一种可以接受的方式来淡化 iPhone 的音频？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T18:16:42.277

如果您最终找到了至少访问播放器的方法，这里有几种方法可以做到这一点。

在一个运行`while-loop`

```
-(void)fadeOut
{
    while (data.volume > 0) {
        data.volume = data.volume - 0.1;
    }
    [data stop];
    data = nil;
} 
```

或者，使用计时器：

```
- (void)fadeOutWithTimer
{
    if (data.volume > 0.1) {
        data.volume = data.volume - 0.1;
        [self performSelector:@selector(fadeOutWithTimer) withObject:nil afterDelay:0.05];
    } else {
        [data stop];
        data = nil;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T17:41:43.140

在允许的 API 范围内，只有用户可以控制系统音量。您的应用无法对其进行调整。正如您所提到的，在应用商店中将不允许访问这些其他 API，并且可能需要越狱设备。

您使用的是哪个 3rd 方框架？您能否检查一下它是否在其中使用标准音频播放器，例如`AVAudioPlayer`？如果是这样，您可以通过这种方式对其进行修改。

**更新：**正如 Randy 在下面指出的那样，您实际上可以通过控制 iPod 的音量来做到这一点：

```
[[MPMusicPlayerController iPodMusicPlayer] setVolume:0.05]; 
```

# javascript - 在给定的四次（四阶，非二次）贝塞尔曲线上计算一个点

> ID：11833132
> 
> 赞同：1
> 
> 时间：2012-08-06T17:35:39.133
> 
> 标签：javascript, algorithm, math, bezier

我正在寻找一种算法，它返回四次贝塞尔曲线 (2D) 上的一个点，给定：
A. [0,1] 的参数 t
B. 构成四次贝塞尔曲线的 5 个点：

*   P0 - 起点
*   P1、P2、P3 - 控制点 1、2 和 3
*   P4 - 终点

在网上搜索我找不到任何算法，只有漂亮的可视化小程序，例如： [wikipedia](http://en.wikipedia.org/wiki/B%C3%A9zier_curve#Higher-order_curves)

如果它在某种程度上很重要，我将使用 javaScript 来实现。

感谢你的帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-06T17:39:48.040

De Casteljau 算法将在此处为您提供帮助[http://en.wikipedia.org/wiki/De_Casteljau%27s_algorithm](http://en.wikipedia.org/wiki/De_Casteljau%27s_algorithm)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-06T17:45:20.500

在您发现的维基百科文章中，有一章对任意度数 n 的贝塞尔曲线的*泛化*。在[显式定义](http://en.wikipedia.org/wiki/B%C3%A9zier_curve#Explicit_definition)部分甚至还有一个示例`n=5`：

![](../Images/c51aca28dd2a246d96fa8508a23be8bb.png)

# django - 第一次生成移动应用程序的密钥时，如何与服务器共享它？

> ID：11833135
> 
> 赞同：5
> 
> 时间：2012-08-06T17:35:47.623
> 
> 标签：django, api, rest, hmac

所以我现在正在开发一个移动应用程序，它将向使用 Django 构建的 REST API 发出请求。

为了保护 API，我计划使用私钥/公钥对身份验证系统。

我想到的工作流程是这样的：

1.  用户使用 Facebook 登录
2.  用户签名后，应用程序会生成私钥
3.  私钥在服务器和应用程序之间共享，以便服务器知道将该私钥映射到特定用户。
4.  每次移动应用发出请求时，应用都会使用请求参数和私钥生成 HMAC/签名。除了 HMAC 之外，应用程序还发送发送它的用户的 user_id（这将充当公钥）。
5.  当服务器收到请求时，它会生成自己的 HMAC。它接受 user_id 并在表中查找私钥。它使用私钥重新创建带有请求参数的 HMAC，并将其与移动应用程序发送的 HMAC 进行比较。如果服务器和移动设备具有匹配的 HMAC，那么它会执行请求。

现在我的问题在于步骤 3，其中必须以某种方式在移动应用程序和服务器之间共享私钥。如何安全地发送私钥？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-06T18:01:54.863

I would start by asking why the server part of your app needs to know the private key. If it only wants to authenticate a user, it only needs the public key and the user id, and the user id cannot iself be the public key (you need a way to find out which public key to use).

For instance, the process of sharing the key, your step three, could look something like this:

1.  The app generates a public-private key pair.
2.  The app sends the public key to the server, not caring who can intercept it.
3.  The server stores that public key, associating it with the id the user provided.

Maybe the integration into Facebook is the part that makes this impossible. I do not quite understand how Facebook comes into this whole process.

One thing that can make the transfer of a key slightly more secure is to use multiple channels to transfer it.

For instance, your application could send the private key that was generated using your REST API but encrypting it with a symmetric encryption scheme. The symmetric encryption key can be sent via some other medium, such as email, or through SMS since this is a mobile app, or maybe even an automated phone call placed to a number provided by the registering user. The key can be a random passphrase that generates the actual symmetric encryption key, to make sure it is something that can be typed in by the user. Then, to unlock the app, the user needs to type in this passphrase into a screen and the secret key is unlocked.

Again, this only improves the security of the transfer by a small margin, especially considering the fact that if you can intercept the transmission of the private key, you can probably intercept the email containing the passphrase. In my opinion, not sending the private key to the server would not only be optimal but required.

# plugins - tinymce 创建自己的插件

> ID：11833138
> 
> 赞同：1
> 
> 时间：2012-08-06T17:36:11.803
> 
> 标签：plugins, tinymce

我正在尝试在 TinyMCE 中创建一个插件。到目前为止，谷歌并没有多大帮助：很多教程都不起作用，并且给出了很多错误。

有没有人有一个很好的教程或者有人可以发布一些带有一些信息的示例代码？我使用的是 3.5.4 版。

就像我说的：我尝试在 Google 上搜索并搜索 StackOverflow .. 没什么用。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T07:32:42.247

通常，tinymce 开发人员文档是一个很好的起点：[http](http://www.tinymce.com/wiki.php/Tutorials:Creating_a_plugin) ://www.tinymce.com/wiki.php/Tutorials:Creating_a_plugin 。

# python - 即使出现语法错误，也保持 simpleserver 处于活动状态

> ID：11833144
> 
> 赞同：5
> 
> 时间：2012-08-06T17:36:30.643
> 
> 标签：python, flask, wsgi, werkzeug

有没有办法配置 Flask 使用的简单服务器**不**退出每个语法错误？

```
app = Flask(__name__)
app.run(host='0.0.0.0', debug=True, use_debugger=True, passthrough_errors=False); 
```

目前我正在将此设置用于简单服务器。将 passthrough_errors 设置为 False 意味着大多数错误实际上使进程保持活动状态，以便我可以使用交互式调试器，但语法错误仍然会退出程序。我尝试了不同的配置值，但没有找到任何可行的方法。谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-15T00:51:16.793

我刚刚发布了一个[Flask-Failsafe](http://pypi.python.org/pypi/Flask-Failsafe/)扩展来解决这个确切的问题。

我一直在打这个，并在早些时候看到你的帖子寻找解决方案。经过一番试验，我破解了一个装饰器，你可以用它来包装你的初始化代码，这样如果它失败，重新加载器将继续工作。检查一下，让我知道你的想法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-06T18:26:25.617

根据 Python 文档，有两种类型或错误：

1.  语法错误
2.  例外

语法错误是在**解析期间**产生的（此时您的代码**实际上并未**执行，因此您不可能捕获错误，因为解析时间不是运行时，当您的代码实际执行时）。

捕获语法错误的唯一方法是当它们发生在作为*exec*函数的参数给出的一段代码中时（执行 python 代码字符串）：

```
>>> try:
...     exec('x===6')
... except SyntaxError:
...     print('Hello!')
...
Hello! 
```

但是您必须记住，只有在您真正知道自己在做什么时才使用 exec()。完全不建议使用 exec() ，尤其是当它依赖于用户输入时。

# linux - epoll 对引用目录的文件描述符有什么作用？

> ID：11833147
> 
> 赞同：13
> 
> 时间：2012-08-06T17:36:39.510
> 
> 标签：linux, file-descriptor, epoll

就像标题说的那样，如果我用epoll注册了一个文件描述符，它是一个目录，它是做什么的？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-08-06T18:04:55.330

**什么**都没有——注册 fd 的调用（至少对于常见的 Linux 文件系统）将失败，并显示`EPERM`.

我使用以下演示程序对此进行了测试：

```
#include <sys/epoll.h>
#include <sys/types.h>
#include <sys/stat.h>
#include <fcntl.h>
#include <stdio.h>

int main(void) {
    int ep = epoll_create1(0);
    int fd = open("/tmp", O_RDONLY|O_DIRECTORY);
    struct epoll_event evt = {
        .events = EPOLLIN
    };

    if (ep < 0 || fd < 0) {
        printf("Error opening fds.\n");
        return -1;
    }

    if (epoll_ctl(ep, EPOLL_CTL_ADD, fd, &evt) < 0) {
        perror("epoll_ctl");
        return -1;
    }
    return 0;
} 
```

结果如下：

```
[nelhage@hectique:/tmp]$ make epoll
cc     epoll.c   -o epoll
[nelhage@hectique:/tmp]$ ./epoll
epoll_ctl: Operation not permitted 
```

为了弄清楚这里发生了什么，我去了源头。我[碰巧知道](http://www.quora.com/Network-Programming/How-is-epoll-implemented)大多数行为`epoll`是由目标文件对应的`->poll`函数决定的，这取决于所讨论的文件系统。`struct file_operations`我选择`ext4`了一个典型的例子，并查看了`fs/ext4/dir.c`，它的[定义](https://github.com/torvalds/linux/blob/master/fs/ext4/dir.c#L622) `ext4_dir_operations`如下：

```
const struct file_operations ext4_dir_operations = {
    .llseek     = ext4_dir_llseek,
    .read       = generic_read_dir,
    .readdir    = ext4_readdir,
    .unlocked_ioctl = ext4_ioctl,
#ifdef CONFIG_COMPAT
    .compat_ioctl   = ext4_compat_ioctl,
#endif
    .fsync      = ext4_sync_file,
    .release    = ext4_release_dir,
}; 
```

请注意缺少`.poll`定义，这意味着它将被初始化为`NULL`. 因此，回到定义在 中的 epoll，`fs/eventpoll.c`我们寻找是否为`poll`NULL 的检查，并且我们在系统调用定义的[早期找到了一个：](https://github.com/torvalds/linux/blob/v3.5/fs/eventpoll.c#L1709)`epoll_ctl`

```
/* The target file descriptor must support poll */
error = -EPERM;
if (!tfile->f_op || !tfile->f_op->poll)
    goto error_tgt_fput; 
```

正如我们的测试所表明的，如果目标文件不支持`poll`，则插入尝试将失败，并显示`EPERM`.

其他文件系统可能会在其目录文件对象上定义`.poll`方法，但我怀疑很多人会这样做。

# ios5 - NSXMLParser：foundCharacters 抛出“尝试使用 appendString 改变不可变对象：”

> ID：11833148
> 
> 赞同：-1
> 
> 时间：2012-08-06T17:36:40.287
> 
> 标签：ios5, nsstring, nsxmlparser, nsmutablestring

解析 XML 提要时出现问题。每个父节点大约有 15 个子节点。目前我正在使用 stringbytrimmingchartersinset 解析所有节点：然后是 NSCharacterset whitespaceandnewline 字符集。像这样：

```
- (void) parser:(NSXMLParser *)parser foundCharacters:(NSString *)string
{
        currentElementValue = (NSMutableString *) [string stringByTrimmingCharactersInSet:[NSCharacterSet whitespaceAndNewlineCharacterSet]];
} 
```

这适用于除一个节点之外的所有节点。对于这个节点，我希望文本按原样通过。我尝试设置一个 if 语句来区别对待这个特定的节点，所以我更新了以下内容。

```
- (void) parser:(NSXMLParser *)parser foundCharacters:(NSString *)string
{

   if ([testingString isEqualToString:@"AdoptionSummary"]) {
       [currentElementValue appendString:string]; //This keeps breaking
        }
    else {
         currentElementValue = (NSMutableString *) [string stringByTrimmingCharactersInSet:[NSCharacterSet whitespaceAndNewlineCharacterSet]];
    } 
```

但是我遇到了一个错误。

> *** 由于未捕获的异常“NSInvalidArgumentException”而终止应用程序，原因：“尝试使用 appendString 改变不可变对象：”

仅当我使用 stringbytrimmingchartersinset 和 appendString 的组合时才会发生错误。但是，如果我在其中使用 stringbytrimmingchartersinset 或 appendString ，它会毫无错误地解析。 `currentElementValue`是一个 NSMutableString 那么为什么会抛出这个错误呢？

我试过查看这个[NSMutableString appendString 生成 SIGABRT 错误](https://stackoverflow.com/questions/6414711/nsmutablestring-appendstring-generates-sigabrt-error)，并且这个[错误：'Attempt to mutate immutable object with appendString:' -](https://stackoverflow.com/questions/5233178/error-attempt-to-mutate-immutable-object-with-appendstring)但无济于事。

我只想“AdoptionSummary”附加“原样”，而其他 14 个被修剪。我做错了什么？有什么建议吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T17:40:00.470

因为`currentElementValue`被声明为`NSString`. 将其类型更改为`NSMutableString`.

如果你已经用 NSMutableString 声明了这个字符串，那么你也必须改变对象的创建。更改以下代码：

```
currentElementValue = (NSMutableString *) [string stringByTrimmingCharactersInSet:[NSCharacterSet whitespaceAndNewlineCharacterSet]]; 
```

使用此代码：

```
currentElementValue = [[NSMutableString alloc] initWithString:[string stringByTrimmingCharactersInSet:[NSCharacterSet whitespaceAndNewlineCharacterSet]]]; 
```

快速处理 alloc 以避免内存泄漏。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T17:45:16.720

```
currentElementValue = (NSMutableString *) [string stringByTrimmingCharactersInSet:[NSCharacterSet whitespaceAndNewlineCharacterSet]]; 
```

简单地将 NSString 转换为 NSMutableString 并不能使其成为一体。在修改它之前制作一个可变副本。

# android - Robolectric：使用 ormlite 进行测试

> ID：11833150
> 
> 赞同：3
> 
> 时间：2012-08-06T17:36:47.717
> 
> 标签：android, testing, dao, ormlite, robolectric

我正在尝试使用 robolectric 测试 ORMLite DAO，但数据库行为与在我的 android 应用程序中使用时不同。我的 DAO 在 android 应用程序上运行良好。

阅读 robolectric 阴影和调试代码时，我遇到了[ShadowSQLiteOpenHelper](http://pivotal.github.com/robolectric/javadoc/com/xtremelabs/robolectric/shadows/ShadowSQLiteOpenHelper.html)（[此处](http://grepcode.com/file/repo1.maven.org/maven2/com.pivotallabs/robolectric/1.1/com/xtremelabs/robolectric/shadows/ShadowSQLiteOpenHelper.java?av=f)为代码）。

*有谁知道这个Shadow是否足以测试ormlite daos？或者我必须创造自己的影子来实现这一目标？这里有任何线索/提示/建议/示例吗？*

提前致谢。

* * *

额外信息：

测试方法：

```
@Test
public void basicTest() throws SQLException {
    assertNotNull(randomStringResource); // Injection of an android resource: OK
    assertThat(randomStringResource, equalTo("Event")); // With correct value: OK
    assertNotNull(eventDao); // Dao injection: OK
    assertThat(eventDao.countOf(), equalTo(0L)); // Table empty: OK

    Event e1 = new Event("e1", new Date());
    eventDao.create(e1);

    assertNotNull(e1.getId()); // ID generated by OrmLite: OK
    assertThat(eventDao.countOf(), equalTo(1L)); // Table not empty: OK
    assertThat("e1", equalTo(eventDao.queryForId(e1.getId()).getName())); // Query for inserted event: Throws exception
} 
```

运行此测试时遇到的一些问题：

*   使用“camelCased”属性名称查询实体时出错：在测试的最后一行抛出错误（[相关问题](https://groups.google.com/d/topic/ormlite-android/QnOB8S5xQqo/discussion)）。运行 android 应用程序时从来没有遇到过这样的问题。
*   当我更改其中一个属性名称（例如，`isEnabled`更改为`enabled`）以避免出现 camelCase 问题时，之前的错误仍然存​​在……似乎内存数据库没有应用我对实体所做的更改。

使用的版本：

*   机器人电气 1.1
*   OrmLite 4.41

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-09-20T08:41:07.537

很抱歉复活你的话题，但我遇到了同样的问题。

我正在使用 OrmLite 4.45 和 Robolectric 2.1。

在[ShadowSQLiteCursor.java](https://github.com/robolectric/robolectric/blob/master/src/main/java/org/robolectric/shadows/ShadowSQLiteCursor.java)中，`cacheColumnNames`方法调用`toLowerCase`每个列名。所以我决定`ShadowSQLiteCursor`用我自己的（不调用`toLowerCase`）进行扩展：

```
/**
* Simulates an Android Cursor object, by wrapping a JDBC ResultSet.
*/
@Implements(value = SQLiteCursor.class, inheritImplementationMethods = true)
public class ShadowCaseSensitiveSQLiteCursor extends ShadowSQLiteCursor {

private ResultSet resultSet;

public void __constructor__(SQLiteCursorDriver driver, String editTable, SQLiteQuery query) {}

/**
 * Stores the column names so they are retrievable after the resultSet has closed
 */
private void cacheColumnNames(ResultSet rs) {
    try {
        ResultSetMetaData metaData = rs.getMetaData();
        int columnCount = metaData.getColumnCount();
        columnNameArray = new String[columnCount];
        for(int columnIndex = 1; columnIndex <= columnCount; columnIndex++) {
            String cName = metaData.getColumnName(columnIndex);
            this.columnNames.put(cName, columnIndex - 1);
            this.columnNameArray[columnIndex - 1] = cName;
        }
    } catch(SQLException e) {
        throw new RuntimeException("SQL exception in cacheColumnNames", e);
    }
}
} 
```

我的回答显然来得太晚了，但可能对其他人有所帮助！

# javascript - Google Charts API：数据系列的 Z 索引

> ID：11833162
> 
> 赞同：0
> 
> 时间：2012-08-06T17:38:01.157
> 
> 标签：javascript, google-visualization

我有[以下](http://ladariha.cz/tmp/template.html)组合堆叠条与 2 个数据系列：蓝色和红色一个。红色的是单点（线），默认为“不可见”（用蓝色数据覆盖），你可以将鼠标悬停在它上面，在问这个问题后，它的 Y 坐标每天大约为 54 +1 :)

现在的问题是，如何使红点可见？如果我选择它，它仍然在顶部，这正是我默认想要的。有任何想法吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T11:09:19.027

我要回答我的问题，但这只是解决方法（虽然有效）。图表准备好后，我正在听“就绪”事件并立即选择这样的单点

```
google.visualization.events.addListener(chart, 'ready', function() {
    ac.setSelection([{row:0, column:5}]); // use proper values
 }); 
```

# html - HTML5 中的 MathML：更改数学字体

> ID：11833164
> 
> 赞同：2
> 
> 时间：2012-08-06T17:38:16.063
> 
> 标签：html, user-interface, mathml

假设我有一个 HTML5 文档，其中包含一些 MathML。我设置了页面正文的字体，但它不会更改用于 MathML 字符的字体：

```
<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Example of MathML embedded in an HTML5 file</title>
    <meta charset="utf-8" />
  </head>
  <body style="font-family: courier;">
    Quadratic formula
    <math><mrow>
      <mi>x</mi>
      <mo>=</mo>
      <mfrac>
        <mrow>
          <mo form="prefix">−&lt;/mo>
          <mi>b</mi>
          <mo>&PlusMinus;</mo>
          <msqrt>
            <msup>
              <mi>b</mi>
              <mn>2</mn>
            </msup>
            <mo>−&lt;/mo>
            <mn>4</mn>
            <mo>&InvisibleTimes;</mo>
            <mi>a</mi>
            <mo>&InvisibleTimes;</mo>
            <mi>c</mi>
          </msqrt>
        </mrow>
        <mrow>
          <mn>2</mn>
          <mo>&InvisibleTimes;</mo>
          <mi>a</mi>
        </mrow>
      </mfrac>
    </mrow></math>
  </body>
</html> 
```

这将在 courier 中显示文本“二次公式”，但 MathML 保持默认页面字体。如何更改用于 MathML 的字体？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-06T23:19:25.150

您可能应该在 Mozilla Developer Network 上阅读[此文档。](https://developer.mozilla.org/en-US/docs/Mozilla_MathML_Project/Fonts)我猜以下段落适用于您的情况：

> 数学公式使用由特定 Unicode 字符表示的各种符号。如果安装了合适的 Unicode 字体，Mozilla 可以显示这些符号中的任何一个。此外，根据 W3C CSS2 关于字体的建议，作者可以指定他们喜欢的特定字体的有序列表（使用 CSS 的 font-family 属性），以确保 Mozilla 的字体引擎将在指定字体时寻找替代字体在特定用户的系统上找不到字体。

其中一位 Mozilla`MathML`开发人员似乎经常写博客。最近有两篇文章你会感兴趣：

1.  [安装数学字体](http://www.maths-informatique-jeux.com/blog/frederic/?post/2012/06/23/Mozilla-MathML-Project%3a-installation-of-mathematical-fonts)
2.  [关于数学字体](http://www.maths-informatique-jeux.com/blog/frederic/?post/2012/04/21/Mozilla-MathML-Project%3a-about-mathematical-fonts)

结果似乎是，为了保证良好的渲染`MathML`，您需要您的用户安装[MathJax](http://www.mathjax.org/)、[STIX](http://www.stixfonts.org/)或[Asana Math](http://fedoraproject.org/wiki/Asana_Math_fonts)字体。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T23:20:42.933

它在 jsfiddle 中呈现 courier：http: [//jsfiddle.net/jalbertbowdenii/8VKJg/](http://jsfiddle.net/jalbertbowdenii/8VKJg/) 你使用的是什么浏览器/操作系统？

在小提琴中包含 MathJax.js 可以正确呈现：

```
 <script src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML"
async>

</script> 
```

[正确渲染 MathJax.js 的 jsfiddle](http://jsfiddle.net/jalbertbowdenii/8VKJg/26/)

# google-chrome - 在 Chrome 开发者面板中，元素选择器是否有键盘快捷键？

> ID：11833165
> 
> 赞同：66
> 
> 时间：2012-08-06T17:38:20.813
> 
> 标签：google-chrome, google-chrome-devtools

在 Chrome 开发者面板中，这个工具...

![在此处输入图像描述](../Images/e84aaaa82a0ec2736764829b7cf9b9ae.png)

允许您选择元素并在 DOM 视图中直接转到它们，并查看它们的 CSS 属性。

Safari 也有同样的工具。

是否有激活该工具的键盘快捷键（打开面板后）？

* * *

## 回答 #1

> 赞同：127
> 
> 时间：2012-08-06T17:42:36.853

要从检查元素模式和浏览器窗口打开/切换，您可以执行以下操作：

*   在 Mac 上 -`⌘</kbd> + `Shift` + `C``

*   在 Windows / Linux 上 - `Ctrl`+ `Shift`+`C`或`F12`

如需更多有用的键盘快捷键，请参阅[开发者工具文档](https://developers.google.com/chrome-developer-tools/docs/shortcuts)。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-06T17:44:37.423

快捷方式是`Ctrl`++ ( [source](http://code.google.com/p/chromium/issues/detail?id=29532#c15)`Shift` ) 。`C`

您也可以右键单击网页中的任何元素并单击`Inspect element`。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-10-31T19:49:51.547

Ctrl + Shift + C 也适用于 Linux。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-10-25T12:28:55.427

在 Windows 和 Linux 上，打开底部的“检查元素”窗格：

*   您可以使用：`Ctrl`+ `Shift`+`C`

*   或者你可以使用：`F12`

虽然您通常可以右键单击网页中的元素并单击`Inspect element`，但了解这些键盘快捷键对于当页面具有 JavaScript 以禁用该页面中的右键单击时很有用。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-08-25T06:33:35.820

在 Mac 上，您可以使用`⌘</kbd> + `⌥</kbd> + `I```

这对我有用。

这是一个资源，您可以在其中找到所有这些快捷方式 [https://developers.google.com/web/tools/chrome-devtools/shortcuts](https://developers.google.com/web/tools/chrome-devtools/shortcuts)

# android - 如何在不丢失 Exif 和元数据的情况下旋转照片？

> ID：11833176
> 
> 赞同：2
> 
> 时间：2012-08-06T17:39:20.800
> 
> 标签：android, exif, image-rotation, android-2.2-froyo

在 Android 2.2 中，有没有办法在不丢失 Exif 和其他元数据的情况下旋转照片？我尝试使用 Matrix 类，但它删除了元数据。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T18:23:45.740

您可以读取 EXIF 数据，旋转图像，然后写入 EXIF 数据。 [ExifInterface](http://developer.android.com/reference/android/media/ExifInterface.html)从 API 5 开始可用。我在这里找到了一个编写 exif 的示例： [Android write EXIF GPS Latitude and Longitude to JPEG failed](https://stackoverflow.com/questions/11644873/android-write-exif-gsp-latitude-and-longitude-onto-jpeg-failed)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-28T02:02:25.783

根据我的研究（2012 年 11 月），如果您调整图像大小（或通过 Bitmap* 类处理它），则无法自动保留 exif 元数据。

您必须按名称专门检索和复制 exif 属性。这篇博文非常有帮助：

[http://vikaskanani.wordpress.com/2011/07/17/android-re-size-image-without-loosing-exif-information/](http://vikaskanani.wordpress.com/2011/07/17/android-re-size-image-without-loosing-exif-information/)

我在这里写下了我自己的经历：

[Android Image Resizing and Preserving EXIF data (Orientation, Rotation, etc)](https://stackoverflow.com/questions/13596500/android-image-resizing-and-preserving-exif-data-orientation-rotation-etc)

# c# - 如何以编程方式将 XML 数据导入 Excel 文件？

> ID：11833178
> 
> 赞同：2
> 
> 时间：2012-08-06T17:39:23.940
> 
> 标签：c#, .net, xml, excel

以下代码应该可以帮助我从 Excel 导出 XML 数据：

```
 Excel.Application application = new Excel.Application();
            application.Workbooks.Open(excelFilepath,
                                    Missing.Value,
                                    Missing.Value,
                                    Missing.Value,
                                    Missing.Value,
                                    Missing.Value,
                                    Missing.Value,
                                    Missing.Value,
                                    Missing.Value,
                                    Missing.Value,
                                    Missing.Value,
                                    Missing.Value,
                                    Missing.Value,
                                    Missing.Value,
                                    Missing.Value);

        string data = null;
        application.ActiveWorkbook.XmlMaps[1].XmlExport(out data); 
```

现在我正在寻找可以帮助我将 XML 数据导入 Excel 的代码*，*就像我通过单击“开发人员”选项卡然后单击“导入 XML”手动导入文件一样。

有人可以告诉我该怎么做吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-12-01T16:02:02.147

我也遇到了同样的问题：XmlMaps[1].Import() 不起作用，它只是崩溃了，我不知道如何定义所需的 XmlMaps。我找到了 XmlMaps.Add(string schema) 方法，但我没有要传递给它的 xml 架构。我手里只有一个xml文件。

这是我的情况：我有一个xml，我可以通过将xml文件拖到excel2007中来手动将xml导入excel2007。然后它会弹出一个对话框，问我如何打开xml。有 3 个选项：作为 xml、作为只读 excel 工作表、作为 xml 源。选择第一个选项，我的xml数据就自动导入excel了。

然后我尝试通过 c# 做同样的事情，但是我找到的每个方法都没有用。

我坚持了3个小时。

非常幸运的是，我终于找到了解决方案：您不需要使用 XmlMaps，只需使用 OpenXml() 即可。

这是将合法xml导入excel的c#方法。

1.  创建一个新的 C# 项目。并在您的项目上鼠标右键，单击“添加引用”，选择“.Net”选项卡，然后选择“Microsoft.Office.Interop.Excel”（如果没有找到它，请检查您的Visual Studio是否安装了Office开发实用程序），单击“确定”。这样就可以在c#中操作excel了。

2.  粘贴以下代码。注意“xApp.Workbooks.OpenXML()”方法，我们将“xlXmlLoadImportToList”选项传入其中，其作用与我将xml拖入excel并选择第一个选项操作相同。这是解释不同选项的链接 [http://msdn.microsoft.com/zh-cn/library/microsoft.office.interop.excel.workbooks.openxml(v=office.11 ​​).aspx](http://msdn.microsoft.com/zh-cn/library/microsoft.office.interop.excel.workbooks.openxml(v=office.11).aspx)

3.  将“xml”和“xlsx”变量替换为您自己的文件路径，如“d:\my.xml”“d:\my.xlsx”

然后你的 xml 被保存为 xlsx。祝你好运！

```
 using System;
    using System.Collections.Generic;
    using System.Linq;
    using System.Text;
    using System.Reflection;
    using Microsoft.Office.Interop.Excel;
    using Microsoft.Office.Interop;
    using System.IO;

    namespace SaveXmlAsExcel
    {
        class Program
        {
            static void Main(string[] args)
            {
                string xml  = args[0];
                string xlsx = args[1];

                if (false == File.Exists(xml))
                {
                    Console.WriteLine("{0} file not exist", xlsx);
                    return;
                }

                Microsoft.Office.Interop.Excel.Application xApp = new Microsoft.Office.Interop.Excel.Application();
                Microsoft.Office.Interop.Excel.Workbook excelWorkBook = xApp.Workbooks.OpenXML(xml, Type.Missing, Microsoft.Office.Interop.Excel.XlXmlLoadOption.xlXmlLoadImportToList);

                excelWorkBook.SaveAs(xlsx, Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing, Microsoft.Office.Interop.Excel.XlSaveAsAccessMode.xlNoChange);

                excelWorkBook.Close();
                xApp.Workbooks.Close();
            }
        }
    } 
```

这是我的xml：它必须具有excel可以成功解析的合法格式。

```
<AwardProps xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <AwardPropRecord>
    <g_AwardProps>
      <entry>
        <Id>0</Id>
        <IsElite>0</IsElite>
        <GoldCost>0</GoldCost>
        <Exp>0</Exp>
      </entry>
      <entry>
        <Id>255</Id>
        <IsElite>255</IsElite>
        <GoldCost>255</GoldCost>
        <Exp>255</Exp>
      </entry>
    </g_AwardProps>
  </AwardPropRecord>
</AwardProps> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T18:36:39.137

使用相同的系统，和 MSDN 网站。我花了很短的时间才找到以下链接：

[http://msdn.microsoft.com/en-us/library/microsoft.office.interop.excel.xmlmap.import%28v=office.14%29](http://msdn.microsoft.com/en-us/library/microsoft.office.interop.excel.xmlmap.import%28v=office.14%29)

Excel 互操作中与 XmlMap 相关的方法。该特定链接指向 XmlMap.Import 函数，该函数采用 url (filePath) 并导入 xml 数据。

该页面上还有一个指向`ImportXml()`函数的链接，它可以接受 xml 字符串作为函数的直接输入，而不是使用 URL。

对于这两种情况，代码假定 XmlMap 已经定义。我自己不知道如何通过接口以编程方式在 Excel 文档中定义 XmlMap。

# django - 更新相关/嵌套资源（用户/用户配置文件） - 在 PATCH 上看到重复键错误

> ID：11833179
> 
> 赞同：1
> 
> 时间：2012-08-06T17:39:30.253
> 
> 标签：django, tastypie

我有一个 UserProfile 类：

```
class UserProfile(models.Model):
    user = models.OneToOneField(User)
    bio = models.CharField(max_length=180, null=True) 
```

这与 User 类相关联。

```
AUTH_PROFILE_MODULE = 'plantvillage.userprofile' 
```

我想通过tastepie提供一个API，这样可以同时管理用户详细信息和用户配置文件详细信息。如果可能的话，我*不想*公开两个接口（一个用于用户，一个用于用户配置文件）。

我像这样设置我的资源：

```
class ProfileResource(ModelResource):
    class Meta:
        queryset = UserProfile.objects.all()
        resource_name = 'profile'
        authentication = ApiKeyAuthentication()
        authorization = DjangoAuthorization()
        allowed_methods = ['get', 'put', 'patch']

class UserResource(ModelResource):
    profile = fields.ToOneField(ProfileResource, 'userprofile', full=True)

    class Meta:
        queryset = User.objects.filter(is_staff=False)
        resource_name = 'usr'
        authentication = ApiKeyAuthentication()
        authorization = DjangoAuthorization()

        excludes = ['password', 'is_active', 'is_staff'] 
```

然而，更新

```
curl --dump-header - -H "Authorization: ApiKey abc6@abc.com:1432ece6a1f34fae24a77315b5c924f756f13807" -H "Content-Type: application/json" -X PATCH --data '{"profile":{"bio":"aquarium"}}' "http://127.0.0.1:8000/api/usr/25/" 
```

导致此错误：

```
"error_message": "duplicate key value violates unique constraint \"plantvillage_userprofile_user_id_key\"\n", "traceback": "Traceback (most recent call last):\n\n  File \"/usr/local/lib/python2.6/dist-packages/django_tastypie-0.9.12_alpha-py2.6.egg/tastypie/resources.py\", line 196, in wrapper\n 
```

我可以做哪些改变来完成这项工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T03:06:48.910

您可以完全摆脱并从要公开`UserResource`的模型中添加字段，如下所示：`User`

```
username = fields.CharField( attribute = 'user__username' ) 
```

这不仅会`User`在 GET 请求的情况下从模型发送正确的数据，而且还会处理更新。

# java - 当您需要更多 Java 堆空间时，您会怎么做？

> ID：11833181
> 
> 赞同：2
> 
> 时间：2012-08-06T17:39:41.743
> 
> 标签：java, linear-algebra

抱歉，之前是否有人问过这个问题（尽管我真的找不到解决方案）。

我不太擅长编程，但无论如何，我正在爬取一堆网站并将有关它们的信息存储在服务器上。我需要一个 java 程序来处理与每个文档相关联的矢量坐标（大约十亿个文档，总共有 500,000 个数字，正负，与每个文档相关联）。我需要计算整个矩阵的奇异值分解。

现在，据我所知，Java 显然无法处理这么大的矩阵。如果我尝试制作一个相对较小的数组（大约 4400 万大），那么我会得到一个堆错误。我使用 eclipse，因此我尝试将 -xmx 值更改为 1024m（即使我有一台具有 8gb 内存的计算机，由于某种原因它也不会更高）。

有什么解决办法呢？检索我需要的数据的另一种方法？以不同的方式计算 SVD？使用不同的编程语言来做到这一点？

编辑：就目前而言，假设有 10 亿个条目，每个条目关联 3 个单词。我正在正确设置 Xmx 和 Xms（来自 eclipse 中的运行配置 -> 这相当于在命令提示符下运行 java -XmsXXXX -XmxXXXX ......）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T17:44:36.563

Java 堆空间可以使用`-Xmx`（注意首字母大写`X`）选项进行设置，如果您使用的是 64 位 JVM 并且相应的物理内存可用，那么它肯定可以达到 1 GB 以上。您应该尝试以下方式：

```
java -Xmx6144m ... 
```

也就是说，您需要重新考虑您的设计。每个对象都有*很大*的空间成本，每个对象的典型*最小值*约为 12 到 16 个字节，具体取决于您的 JVM。例如， a`String`有大约 36-40 字节的开销......

即使每个文档只有一个对象而没有记账开销（不可能！），您也没有存储 10 亿 (1,000,000,000) 个文档的内存。即使对于`int`每个文档，您也需要大约 4 GB。

您应该重新设计您的应用程序以利用矩阵中的任何稀疏性，并尽可能利用基于磁盘的存储。将所有内容都保存在内存中很好，但并非总是可能...

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-06T17:47:33.270

您使用的是**32 位 JVM**吗？这些堆不能超过 2 GB，我从来没有设法分配超过 1.5 GB。相反，使用**64 位 JVM**，因为它们可以分配更多的堆。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-06T17:47:22.463

或者您可以对其应用一些数学运算并使用分而治之的策略。这意味着，将问题分解为小问题以获得相同的结果。

对 SVD 不太了解，但也许这个页面会有所帮助：

[http://www.netlib.org/lapack/lug/node32.html](http://www.netlib.org/lapack/lug/node32.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-06T17:48:13.807

-Xms 和 -Xmx 是不同的。包含 s 的那个是起始堆空间，而包含 x 的那个是最大堆空间。

所以

```
java -Xms512 -Xmx1024 
```

会给你512开始

正如其他人所说，尽管您可能需要分解问题才能使其正常工作。您使用的是 32 位还是 64 位 Java？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-06T17:49:36.657

对于这种大小的数据，您不应该计划将其全部存储在内存中。将此类数据外部化的最常见方案是将其全部存储在数据库中，并围绕数据库查询构建程序。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-06T18:13:03.300

> 就目前而言，假设有 10 亿个条目，每个条目关联 3 个单词。

如果您有 10 亿个条目，则需要每个条目大小的 10 亿倍。如果您的意思是 3 x`int`作为单词，那么至少仅用于数据就需要 12 GB。如果您将单词表示为字符串，您将枚举单词，因为英语中只有大约 100K 单词，并且占用相同的空间。

鉴于 16 GB 需要几百美元，我建议购买更多内存。

# ruby-on-rails - 将 Aptana 与 Git 连接

> ID：11833186
> 
> 赞同：1
> 
> 时间：2012-08-06T17:40:01.070
> 
> 标签：ruby-on-rails, git, github, aptana, aptana3

我是 Git 和 Aptana 的新手。我已经从以下位置下载了 Git：windows.github.com。它安装得很好。

我看到 Aptana 与 Git 的默认集成，但我不知道它指向哪个服务器位置？

我想在 GitHub 上托管我的代码，以便我可以让不同的机器保持同步。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T18:53:15.023

Git 和 Github 的应用程序是有区别的。一旦你安装了[Git](http://git-scm.com/)和[Github 的 Windows 应用程序](http://windows.github.com/)，你需要[在你的 PC中设置 Git](https://help.github.com/)*和* Github——详细的帮助可以在他们各自的网站上找到。

Github 的应用程序和 Aptana 在提交时都使用您 PC 中的 Git 配置文件中的设置，这些详细信息很简单，就是您的用户名和电子邮件（以及其他配置文件设置，如果有的话）。

如果你想使用 Aptana 连接到 Github，你可以这样做：`Wrench icon in the project sidebar > More > Add remote`这里你必须添加一个 Aptana 将使用的远程存储库。[有关 Git 遥控器的更多详细信息，请点击此处](https://help.github.com/articles/adding-a-remote)。为避免不必要的麻烦，Windows Github 应用程序使这种管理变得更容易。Aptana 提供了一个围绕 Git 的 GUI，这正是 Github 应用程序所做的，具有一些额外的功能和易用性。

希望我没有让你更加困惑。

# c# - Winform with Custom DialogForm with ComboBox feed from List<>

> ID：11833188
> 
> 赞同：0
> 
> 时间：2012-08-06T17:40:05.280
> 
> 标签：c#, winforms, list, class

我被卡住了，在网站上找不到任何可以帮助我的东西。

我有的：

我有一个 WinForms 应用程序，使用 Visual Studio 2010 用 C# 编写。我构建了一个包含大约 10 个数据字段和属性的自定义类。在我的主表单上，我为每个对象的外壳声明了一个 List<>。它在表单级别声明。我为数据输入创建了一个自定义表单（因为`MessageBox`/`Interaction.InputBox`不起作用），主要是文本框和`DateTime`元素。也有一个`ComboBox`。卡在`Customdialog_Load`事件处理程序 - 想要在表单加载时填写。

问题：

`ComboBox`当表单加载以输入数据时，我需要提供项目。它需要从`List<>`主窗体中的特定属性中获取，我们称之为`ClientName`. 如果在我的列表中有 50 个客户`List<>`，那么我希望他们的名称属性填充组合框`Collection[]`。

要求：

任何人都可以建议如何喂养`ComboBox`不在同一表格上的，最好不要复制 data/ `List<>`。其他大部分我都可以做，逻辑流程都是正确的。我确实知道如何在同一个表单上以正常方式将项目添加到集合中。

## 编辑：

如果必须，我可以在主窗体上为客户名称创建一个单独的数组。但它必须在主窗体上。所以组合框仍然需要从不同形式的数组中填充。

## 编辑2：

我还在大学一年级。我们还没有完成`DataBinding`，但我确实知道有更好的方法来完成我想要完成的事情，只是我还没有想到这些工具。我的工作远远领先于班级。谢谢大家的帮助，很快！会继续努力！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T17:52:56.037

当您创建第二个表单的实例时，在构造函数中传递对您的 List 的引用并将其存储在第二个表单内的表单级变量中。然后使用它在该表单加载事件中初始化您的组合框

在你的主要形式

```
List<Customer> myCustomerList;

.....
using(Customdialog f = new CustomDialog(myCustomerList))
{
    if(DialogResult.OK == f.ShowDialog())
    {
        ..... 
    }
} 
```

在您的 CustomDialog 类中

```
public class CustomDialog
{
    List<Customer> _customerList;

    public CustomDialog(List<Customer> customers)
    {
        InitializeComponent();
        _customerList = customers;
    }

    private void CustomDialog_Load(object sender, EventArgs e)
    {
         comboBox1.DataSource = _customerList; 
         comboBox1.ValueMember = "Id";  // Supposing the Customer object contains ID property
         comboBox1.DisplayMember = "ClientName";   // The property shown on the combobox items
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T17:54:17.347

```
class MyDialog : Form
{
    public IEnumerable<Whatever> Items
    {
        get { return _items; }
        set 
        { 
            _items = value; 
            someComboBox.Items = value; 
        }
    }

    public MyDialog(IEnumerable<Whatever> items) 
    { 
        InitializeComponent();
        Items = items;
    }
} 
```

现在您可以通过构造函数和/或稍后单独传递它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-06T17:54:45.287

如果您被迫走Winforms路线，那么:(但听起来您需要一些关于传递东西的建议（也许是数据绑定？）

理想情况下，您需要将数据传递到自定义表单（我假设您有一个主表单和一个弹出窗口/另一个打开的表单）。

一种方法是在第二个表单上创建一个属性，该属性是`List<>`类型并在打开表单之前分配它......例如

在 form2.cs

```
// an auto property will work well here
public List<YourClass> YourClassList { get; set;} 
```

然后在你的 form1.cs

```
// When the user opens the second form
Form2 frm2 = new Form2();
frm2.YourClassList = yourClassListFromThisForm;
frm2.ShowDialog(); // etc 
```

您是否也有填充框或使用数据绑定的问题？

老实说，如果您在这方面没有做太多工作，我会认真考虑迁移到 WPF - 它在各个方面都好得多

# html - 防止悬停时元素之间的空间增加

> ID：11833192
> 
> 赞同：0
> 
> 时间：2012-08-06T17:40:20.567
> 
> 标签：html, css

我有一个侧边栏，其中有某些`li`元素作为索引，并且在每个 li 元素悬停时，我有一个特定的图像出现在 li 元素上（例如`position:relative;top:-25px;`：）

假设我将鼠标悬停在第一个 li 元素上，并且翻转图像看起来很好。但是，当发生这种悬停时，第一个和第二个元素之间的空间会增加。我无法理解为什么会发生这种情况，我想阻止这种情况发生，即图像应该出现在`li`项目上而没有间距问题，而只是一个简单的翻转。

这是我正在谈论的问题的一个小提琴：http: [//jsfiddle.net/PF35v/3/](http://jsfiddle.net/PF35v/3/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T17:43:47.193

添加“位置：绝对；” 到 ul#nav a:hover#first_id+img 正在停止 LI 被向下推（在 Chrome 上尝试过）。你试过这个吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T18:16:43.717

在这种情况下，我会使用绝对定位，我通常在处理“粘合”到屏幕一侧的图像和顶部/侧面导航栏时使用。或者，在我打算使用`relative`vs.`absolute`我使用一点作弊的情况下……这是我在上面的小提琴中所做的更改

```
 ul#nav a:hover+img {
 display: block;
 position:relative;
 top:-35px;
 margin-bottom:-48px;
 } 
```

**更新的小提琴**

[http://jsfiddle.net/PF35v/9/](http://jsfiddle.net/PF35v/9/)

但是，如果您的图像大小不同，则需要单独设置`top`和`margin-bottom`定位。

# ajax - 使用 Dojo Dojo.io.script 读取 JSONP

> ID：11833197
> 
> 赞同：0
> 
> 时间：2012-08-06T17:40:50.663
> 
> 标签：ajax, dojo, jsonp

我想使用 DOJO 访问从以下 url 返回的 JSONP 数据：

[http://api.metro.net/agencies/lametro/routes/704/vehicles/callback=recover](http://api.metro.net/agencies/lametro/routes/704/vehicles/callback=recover)

这是我的简单 dojo.io.script.get 函数：

```
dojo.io.script.get({
url: "http://api.metro.net/agencies/lametro/routes/704/vehicles/",
content: {callback: "recover"},
callbackParamName: "callback",
load: function(data){
    console.log('OK', data);
},
error: function(error){
    console.log('Error', error);
}); 
```

我收到“语法错误：无效标签”；显然服务器正在发送 JSON 而不是 JSONP。

在这种情况下，dojo.io.script.get 的正确格式是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T05:01:24.417

这对我有用（假设 dojo 1.7/AMD）：

```
require(["dojo/io/script"], function (ioScript) {

                        ioScript.get({
                            url: "http://api.metro.net/agencies/lametro/routes/704/vehicles/callback=recover",
                            content: { callback: "recover" }
                            , callbackParamName: "callback"
                            , load: function (data) {
                                console.log('OK', data);
                            }
                            , error: function(error) {
                                console.log('Error', error);
                                }
                            });
                    }); 
```

基本上问题是如何将该回调参数发送到服务器。

享受，

# android - 如何在水平滚动的文本视图之间切换？

> ID：11833204
> 
> 赞同：0
> 
> 时间：2012-08-06T17:41:16.930
> 
> 标签：android, android-layout, textview

好的，我认为我在 Google 搜索中使用的字词不正确，因为我已经尝试了 40 多次，但没有得到任何结果。

我的问题：类似于 android 的多个屏幕，我的应用程序中可以有多个文本视图吗？还有一个文本视图指示器（指示当前正在查看哪个文本视图，就像 android 屏幕指示器指示正在显示的当前屏幕一样）。如果这是可能的，有人可以指出我正确的方向吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T17:49:02.330

这是您需要了解的内容。TextView 是一个视图。View 必须显示在 ViewGroup 中，例如 LinearLayout、RelativeLayout 等。所以你总是有一个封装的 View。问题是您如何知道当前正在查看哪个文本视图。如果它是 ViewGroup 中唯一可见的文本视图，那么您知道它是被查看的那个。但是，如果有多个文本视图，当然没有选择 TextView。所以除非你有视网膜追踪或类似的东西，否则没有办法知道。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T19:08:45.067

我得到了答案[http://android-developers.blogspot.in/2011/08/horizo​​ntal-view-swiping-with-viewpager.html](http://android-developers.blogspot.in/2011/08/horizontal-view-swiping-with-viewpager.html)

这就是我想要的。无论如何感谢代码机器人的帮助。

# php - 如何有效地修补在多台主机上运行的代码？

> ID：11833205
> 
> 赞同：3
> 
> 时间：2012-08-06T17:41:22.030
> 
> 标签：php, codeigniter, deployment, release-management

产品是不断开发的 CMS，并且总是会推出新功能补丁。该产品托管在多台服务器上，其中一些我只有 FTP 凭据和对 db 的访问权限，而另一些我有完全的 root 访问权限。现在，一旦新功能在测试后发布，我就必须手动 ftp 文件并在所有服务器上运行 SQL 查询。这是非常耗时、容易出错且效率低下的。我怎样才能使它更健壮、更简单或自动化它的一部分？CMS 基于 PHP、MySQL、JS、HTML 和 CSS。管理部分对所有人来说都是通用的。皮肤和一些自定义模块是为不同的客户开发的，我们唯一更新的部分是管理。

**更新**

为了管理我们使用 GIT 的代码，SQL 不是这个 GIT 结构的一部分，我将与产品经理/所有者交谈以使其处于版本控制之下。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T17:44:28.663

这是未打包代码的大问题之一。

就个人而言，我有一个 PHAR，它在执行时会将代码提取到特定文件夹并执行所需的查询。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T17:51:02.733

我已经在数十台服务器上运行 Web 部署，每月处理数亿访问者。

SQL 变更管理永远是一头野兽。您唯一的希望是在内部滚动自己（我所做的）或使用[EMS DB Comparer](http://www.sqlmanager.net/en/products/mysql/dbcomparer)之类的东西。

要处理文件同步，您将需要许多工具，所有工具都经过专业设计，可以协同工作，包括：

1.  源代码版本控制（bzr、svn等），即正确分支（需要stable分支、dev分支、testing分支），
2.  持续集成服务器，
3.  每台服务器都支持 SFTP，
4.  希望通过单元和综合测试来确定构建质量，
5.  每台服务器上的rsync，
6.  构建脚本（我在 Phing 中做这些），
7.  部署脚本（也在 Phing 中），
8.  知识。

一般过程大约需要 20 小时进行彻底研究，大约需要 40 小时进行设置。当我起草文档时，涉及到 40 多个不同的步骤。创建 SQL 更改管理实用程序又花了 20-30 个小时。再加上另外 10 小时的测试，您将看到一个 100 到 120 小时的项目，但它可以为您在未来的拙劣部署中节省大量时间，并将部署时间减少到单击按钮所需的时间。

这就是为什么我对设置整个过程进行咨询的原因，在客户的网络上设置通常需要大约 5 个小时。

# python - ValueError: int() 以 10 为底的无效文字：'da'

> ID：11833207
> 
> 赞同：0
> 
> 时间：2012-08-06T17:41:29.447
> 
> 标签：python, python-2.7

对于以下代码，我不断收到相同的 ValueError，我很难理解为什么会生成错误。据我了解，当将错误的值传递给函数时会生成此错误，但是，我真的不明白此错误告诉我什么。我花时间在网上和文档中搜索，但我无法理解我做错了什么。简单地说，为什么会产生这个错误？

我的代码：

```
import datetime
import ystockquote

def new_time(n):
    fmt = "%Y%m%d"
    end_date1 = datetime.datetime.strptime(n, fmt)
    sixty_day = datetime.timedelta(days=60)
    start_date  = end_date1 - sixty_day
    start_date1 = str(start_date)
    start_date2 = start_date1[:4] + start_date1[5:7] + start_date1[8:10]
    return start_date2

def average_atr():
    print "Enter your stock symbol: "
    symbol      = raw_input(" ")
    print "Enter the end date in (YYYYMMDD) format: "
    end_date    = raw_input(" ")
    start_date  = new_time(end_date)
    initial_list = ystockquote.get_historical_prices('symbol', 'start_date', 'end_date')

def start():
    average_atr()

start() 
```

这是 ystockquote 的相关代码：

```
def get_historical_prices(symbol, start_date, end_date):
    """
    Get historical prices for the given ticker symbol.
    Date format is 'YYYYMMDD'

    Returns a nested list.
    """
    url = 'http://ichart.yahoo.com/table.csv?s=%s&' % symbol + \
          'd=%s&' % str(int(end_date[4:6]) - 1) + \
          'e=%s&' % str(int(end_date[6:8])) + \
          'f=%s&' % str(int(end_date[0:4])) + \
          'g=d&' + \
          'a=%s&' % str(int(start_date[4:6]) - 1) + \
          'b=%s&' % str(int(start_date[6:8])) + \
          'c=%s&' % str(int(start_date[0:4])) + \
          'ignore=.csv'
    days = urllib.urlopen(url).readlines()
    data = [day[:-2].split(',') for day in days]
    return data 
```

请注意，上面的 ystockquote 代码不是完整的代码。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-06T17:44:35.387

在函数`average_atr()`中，更改以下行：

```
initial_list = ystockquote.get_historical_prices('symbol', 'start_date', 'end_date') 
```

到：

```
initial_list = ystockquote.get_historical_prices(symbol, start_date, end_date) 
```

在您当前的版本中，您不是将变量传递给 ，而是传递`ystockquote.get_historical_prices()`带有变量名称的文字字符串。这导致`str(int(end_date[4:6]) - 1)`变量`end_date`具有值`'end_date'`，并且`'end_date'[4:6]`是`'da'`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-06T17:46:40.657

您将字符串“start_date”和“end_date”发送到函数 get_historical_prices。似乎该函数期望传入实际的字符串日期值。只需删除此行中参数周围的引号即可：

```
initial_list = ystockquote.get_historical_prices('symbol', 'start_date', 'end_date') 
```

# java - 监控 Bone cp 连接池

> ID：11833215
> 
> 赞同：9
> 
> 时间：2012-08-06T17:41:53.873
> 
> 标签：java, hibernate, connection, connection-pooling, bonecp

我们正在尝试从 c3p0 移动到 bonecp 连接池。我们使用hibernate作为ORM工具。

现在，有什么方法可以监控 boncecp 中的连接，例如了解池中特定时间点的最大可用和繁忙连接，以及是否有任何未返回的连接到池等？

谢谢您的帮助

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-21T12:40:25.313

通过 BoneCP 连接池类 ( [BoneCP](http://jolbox.com/bonecp/downloads/site/apidocs/com/jolbox/bonecp/BoneCP.html) ) 可以访问大量监控信息。这已注册为托管 bean，因此如果您使用 jconsole 或其他一些监视工具，您应该获得此信息的详细视图，例如：

![BoneCP MBean 截图](../Images/349410a813f5a7ad1d80cc3c6efcb7ff.png)

如果需要，您可以从using获取`BoneCP`实例：`BoneCPDataSource``BoneCPDataSource#getPool()`

```
/**
 * Get a status information of the JDBC connections.
 * 
 * @return The status information of the JDBC connections.
 */
public String getConnectionStatus() {
    String status = "unknown";
    if (dataSource instanceof BoneCPDataSource) {

        BoneCPDataSource bcpDataSource = (BoneCPDataSource) dataSource;
        BoneCP bcp = bcpDataSource.getPool();
        status = "JDBC connections: " + bcp.getTotalLeased()
            + " in use / " + bcp.getTotalFree()
            + " in pool / total created "
            + bcp.getTotalCreatedConnections();

    }
    return status;
} 
```

# php - gmail拆分我的html代码

> ID：11833219
> 
> 赞同：1
> 
> 时间：2012-08-06T17:42:12.700
> 
> 标签：php, html, email, split, gmail

我用 PHP`mail()`函数发送这个 HTML：

```
 <div>hello<div><br></div><div>dsfs</div><div><b style="background-color:rgb(255,0,0)">dfs</b></div><div><b style="background-color:rgb(255,0,0)">df</b></div><div><b style="background-color:rgb(255,0,0)">sdf</b></div><div>sdf</div>
<div>sdfff</div></div> 
```

这是一封非常简单的 HTML 电子邮件，但 Gmail 显示如下：

```
hello
dfs
df
<= div style=3D"color:rgb(34,34,34);font-family:arial,sans-serif;font-size:13p= x;background-color:rgb(255,255,255)"> sdf
sdf
sdfff 
```

为什么 Gmail 会截断我的 HTML，我该如何解决？

我直接捕获从 gmail file_get_contents("php://stdin") 发送的 html 代码；并处理它以提取 html 代码（我只删除标题），因此 html 是完全正确的，我不必编辑它。那么，为什么如果 gmail 将 html 发送到另一个 gmail，这看起来不错，但如果我发送 html，这是 html 灾难？

**说真的，html 完全符合 gmail**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T17:48:30.500

这就是您的代码在正确格式下的样子。我已将您的内联样式移至 ，`<div>`因为我不能 100% 确定它在`<b>`标签中的有效性。

```
<div>hello 
    <div><br /></div>
    <div>dsfs</div>
    <div style="background-color:rgb(255,0,0)"><b>dfs</b></div>
    <div style="background-color:rgb(255,0,0)"><b>df</b></div>
    <div style="background-color:rgb(255,0,0)"><b>sdf</b></div>
    <div>sdf</div>
    <div>sdfff</div>
</div> 
```

没有任何内容被截断。除非设置了或样式，`<div>`否则标签始终显示在彼此下方。`float``display:inline`

# c++ - C++ boost::iostreams::tee_device 打印到 ostream 和 ofstream 的进度条问题

> ID：11833226
> 
> 赞同：0
> 
> 时间：2012-08-06T17:42:39.677
> 
> 标签：c++, boost, cout, ofstream, ostream

我正在使用 Boost Tee_device 类将 Text 输出到**cout**和 a **ofstream**。使用这个[例子](https://stackoverflow.com/a/670508/839501 "例子")。唯一的区别是我的 TeeDevice 的 typedef 看起来像这样。

```
typedef io::tee_device<ostream, ofstream> TeeDevice;
typedef io::stream< TeeDevice > TeeStream; 
```

那部分效果很好。

我的问题是在尝试使用流对象编写进度条时出现的。我`'\r'`用来将课程送回行首。

这是我使用的代码的样子，

```
//Some code that inits TeeStream* Tee_streamObj;

(*Tee_streamObj) << "Progress:"<< "\n" <<std::flush();

for(int x = 0; x <= 100; x++)
{
   (*Tee_streamObj) << '\r' << (x*100)/100<<"%"<<std::flush();
}

(*Tee_streamObj) << '\r' << "Complete!"<<std::flush(); 
```

在 cout 我得到 2 行，第二行不断被覆盖，最后看起来就像这样。

> 进度：
> 完成！//<-- 行不断根据需要被覆盖

但是从 ofstream 生成的文件看起来像这样，

> 进度：
> 0%
> 1%
> 2%
> 
> ...
> 
> 99%
> 100%
> 完成！

有没有办法覆盖在 boosts Tee_device 类中写入 ofstream 的最后一行？

我正在使用 1.40 版的 boost 库，应该注意我无法控制使用不同的版本。

想法？

提前谢谢。

编辑：我一直在尝试将 ofstream 变成 fstream。有没有办法使用 seekg 或 tellg 来完成这样的事情？

# jquery - 在 JQuery 中添加元素时如何执行“.each()”

> ID：11833230
> 
> 赞同：0
> 
> 时间：2012-08-06T17:42:48.853
> 
> 标签：jquery, element, add, each

`type input=text`当我添加一个名为的元素时`name="algumacoisa[number]"`。

每次添加额外的字段时，我都需要对这些值求和。
使用`.each()`显示不起作用，因为它看不到字段`$('[name="algumacoisa[]"]').each()`来计算那里有多少字段并将它们的值相加​​​。

任何的想法？

欢迎任何帮助。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T17:45:49.207

```
var sum = 0;
$(':input[name^="algumacoisa"]').each(function(){
   var value = $.trim( this.value );
   if( $.isNumeric( value ) ) {
      sum += parseInt( value, 10 );
   }
}); 
```

关于[$.isNumeric()](http://api.jquery.com/jQuery.isNumeric/)。

您还可以为此使用函数：

```
function getSum() {
    var sum = 0;
    $(':input[name^="algumacoisa"]').each(function() {
        var value = $.trim(this.value);
        if ($.isNumeric(value)) {
            sum += parseInt(value, 10);
        }
    });
    return sum;
} 
```

**[演示](http://jsfiddle.net/YErc7/6/)**

[根据评论新的演示](http://jsfiddle.net/YErc7/8/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T18:09:55.110

此函数将对所有字段值求和，只要该值可以解释为数字：

```
function sumFields() {
    var total = 0;
    $('input[type="text"][name^="algumacoisa"]').each(function(){
        var fieldVal = parseFloat($(this).val());
        if(!isNaN(fieldVal)) {
            total += fieldVal;
        }
    }
    return total;
} 
```

每次添加新字段时，运行`sumFields()`（*在*将新字段添加到 DOM 之后）这将返回您的总值

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-06T17:58:15.820

这样做：

```
var sum=0;
$('input[name^="algumacoisa["]').each(function(){
    sum += Number(this.value);            
});
alert(sum); 
```

参考**[现场演示](http://jsfiddle.net/SivaCharan/ceezt/)**

# python - 在 Heroku 上使用 Memcache 时，我应该配置 Beaker 的 `session.lock_dir` 吗？

> ID：11833245
> 
> 赞同：7
> 
> 时间：2012-08-06T17:44:17.133
> 
> 标签：python, heroku, memcached, pyramid, beaker

我正在将 Pyramid 应用程序的会话配置从 切换`cookie`到`ext:memcached`. 我的应用程序托管在 Heroku 上，我已经根据[他们的文档配置了他们的](https://devcenter.heroku.com/articles/memcache)[memcache 插件](https://addons.heroku.com/memcache)。

我从[Beaker 文档](http://beaker.readthedocs.org/en/latest/configuration.html#options-for-sessions-and-caching)中了解到，指定 a`session.lock_dir`对于防止[狗桩效应](http://beaker.readthedocs.org/en/latest/glossary.html#term-dog-pile-effect)至关重要。明确地说：我必须提供一个目录的文件路径。然后，Beaker 将其用作某种锁，以防止多个客户端同时尝试设置相同的值。

对我来说，这听起来像是糟糕的架构。memcache 的主要优点之一是它可以作为共享的外部服务。将我的应用程序进程绑定到磁盘绑定锁似乎是错误的方法。

同样，在 Heroku 上，每个“dyno”（我理解为每个进程）都有一个[临时文件系统。](https://devcenter.heroku.com/articles/dynos#ephemeral-filesystem)所以虽然我可以提供一个`lock_dir`目录路径，但如果每个进程使用不同的目录，那么这会保护我免受狗堆效应吗？

我不确定我是否应该：

*   指定一个 lock_dir 并且不用担心它
*   尝试分叉烧杯并以某种方式修补它

另外，我很想知道其他语言/框架在这里使用什么模式。这只是一个烧杯问题还是其他非文件绑定设置会受到狗堆效应的影响？

提前致谢，

詹姆士。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-01-20T08:17:23.480

不幸的是，根据我的经验，由于没有分布式锁，Beaker 在多主机基础架构上不能很好地工作。如果您在 2 个主机上运行的 Web 应用程序中使用烧杯，狗堆效应仍然会发生（但是可以通过将来自同一用户的所有请求粘贴到一台服务器来避免，但它不适用于所有平台）。

有时您可以忽略狗桩效应，有时则不能。例如，如果您缓存全局数据，狗桩效应是痛苦的。如果您缓存用户数据，有时可以忽略它。

在你的情况下，我会忽略它。Beakers 允许您在没有任何锁定目录的情况下使用 Memcache 扩展。在这种情况下，Beaker 锁仅使用线程锁为每个进程工作。

这是证据：

```
from beaker.middleware import SessionMiddleware
from werkzeug.wrappers import Response
from werkzeug.serving import run_simple

def simple_app(environ, start_response):
    # Get the session object from the environ
    session = environ['beaker.session']

    # Check to see if a value is in the session
    user = 'user_id' in session

    # Set some other session variable
    session['user_id'] = 10
    session.save()

    start_response('200 OK', [('Content-type', 'text/plain')])
    return ['User is logged in: %s' % user]

# Configure the SessionMiddleware
session_opts = {
    'session.type': 'ext:memcached',
    'session.url': '127.0.0.1:11211',
    'session.auto': True,
    'session.cookie_expires': True,
}
wsgi_app = SessionMiddleware(simple_app, session_opts)

if __name__ == '__main__':
    run_simple('127.0.0.1', 5000, wsgi_app, use_debugger=True, use_reloader=True) 
```

如果狗桩效应对您来说仍然是一个问题，我建议从 Beaker 迁移到其他东西。例如[dogpile.cache](http://dogpilecache.readthedocs.org/en/latest/)

# java - 修复 CaesarCipher

> ID：11833246
> 
> 赞同：-1
> 
> 时间：2012-08-06T17:44:19.803
> 
> 标签：java, encryption

**编辑：**我稍微更改了代码。我试着让它更整洁......

好的，我是 Java 的完整初学者。如果您必须将消息中的字母移动一定量，我必须制作一个 CaesaerCipher（例如：shift 1 = A 变为 B，B 变为 C，等等。 shift 2 = A->C，B->D， ETC。）

我已经尝试了很多方法，但我绝对无济于事。我不知道该尝试什么。帮助？

```
import java.util.*;
import java.io.*;

public class CaesarCipher {

  public static void main(String[] args)
    throws FileNotFoundException, IOException {

    System.out.println("Welcome to CaesarCipher");
    System.out.print("Enter 1 to encipher, or 2 to decipher (-1 to exit): " );
    Scanner console = new Scanner(System.in);
    int i = console.nextInt();
    if (i == -1) {
      System.out.print("DONE!");
    //repeat question encipher/decipher/quit until choose quit
    }

    if (i == 1) {
      System.out.println();
      System.out.print("What shift should I use? ");
      int j = console.nextInt();
      System.out.println();
      System.out.print("What is the input file name? ");
      caesarEncipher();
    if (i == 1) { //from answer to encipher, decipher, or exit
      System.out.println(strLine);
      //send to String caesarDecipher
      //?????????????
    }
//    if (i == 2) { //from answer to encipher, decipher, or exit
      //send to String caesarEncipher
      //?????????????
//    }

      System.out.print("What is the output file name? ");
      String fileName = new Scanner(System.in).nextLine();
      //File file = new File( fileName );
//      fstream = new FileInputStream("/Users/steph/Desktop/Programming/!6 Problem Set TUES/PartB/6/cipher.txt");
         //change (".txt") to -fileName- ???
      //File file = new File( fileName );
//      while ((strLine = br.readLine()) != null)   {
//      System.out.println (strLine);
    }
  }

public static String caesarEncipher (int k)
  throws FileNotFoundException, IOException {

      //input file name code...
      //String fileName = scanner.nextLine();

      FileInputStream fstream = new FileInputStream("/Users/steph/Desktop/Programming/!6 Problem Set TUES/PartB/6/cipher.txt");
      DataInputStream in = new DataInputStream(fstream);
      BufferedReader br = new BufferedReader(new InputStreamReader(in));
    String strLine;
    while ((strLine = br.readLine()) != null)   {
      System.out.println (strLine);
    }
    in.close();
      System.out.println();

    int shiftKey = Integer.parseInt(k[1]);
    shiftKey = shiftKey % 26;  

      String cipherText = ""; 

      for (k=0; k<strLine.length(); k++){ 

         int asciiValue = (int) strLine.charAt(k); 
         if (asciiValue < 65 || asciiValue > 90){ 
            cipherText += strLine.charAt(k); 
            continue; 
         } 

         int basicValue = asciiValue - 65; 
         int newAsciiValue = 65 + ((basicValue + shiftKey) % 26)  ; 
         cipherText += (char) newAsciiValue; 

       } 

       System.out.print(cipherText);              

    in.close();
      System.out.println();
}
}

    //ignore any character that is not an uppercase alphabetic!!!!!!!!!  

//  public static String caesarDecipher (String input, int shift) {
    //reverse process to decipher
    //go back to what shift (line 11-12): j
    //make it -inputted number
    //ignore any character that is not an uppercase alphabetic!!!!!!!!!  
//  }

//  public static String alphabet (?) {
//    Iterator<String> abc = new Abc<Integer>()??;
    //list [A, B, C, D, E, F, G, H, I, J, K, L, M, N, O, P, Q, R, S, T, U, V, W, Y, Z]
    //rotate(list, distance) 
```

**编辑：**问题出在我加星标的地方。它希望 k 成为一个数组。我不知道如何在不搞砸其余代码的情况下做到这一点 至于学习，您认为所有这些代码就足够了。我从只知道 BBCode（什么都不是）到这个。我是心理学专业的。我的大脑不是这样工作的。这很有趣，但我遇到了一堵砖墙。

**Edit2：**确切的错误是“需要数组，但找到了 int”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T18:06:48.653

使用 StringBuilder 尝试此实现。它是专门为多次修改的字符串而设计的类。
已编辑：此外，您最好将字符串转换为字符数组，因为无论如何您都在逐个字符地处理它。

```
StringBuilder cipherText = new StringBuilder(); 
char[] letters = strLine.toCharArray();

for (k=0; k < letters.length; k++){ 

     int asciiValue = (int) letters[k]; 
     if (asciiValue < 65 || asciiValue > 90){ 
        cipherText.append( letters[k] );
        continue; 
     } 

     int basicValue = asciiValue - 65; 
     int newAsciiValue = 65 + ((basicValue + shiftKey) % 26)  ; 
     cipherText.append( (char) newAsciiValue );

} 

System.out.print( cipherText.toString() ); 
```

# visual-studio-2010 - 在 VS 代码编辑器中仅选择几个字符

> ID：11833247
> 
> 赞同：0
> 
> 时间：2012-08-06T17:44:19.793
> 
> 标签：visual-studio-2010, select, text, windows-8, edit

我习惯了 Visual Studio 2008，你可以在代码编辑器中拖动文本就好了。

现在我在 VS 2010 上，当我尝试在代码中只选择两个字符时，编辑器根本不会选择任何东西，但是如果我将鼠标拖到第三个字符上，它会选择所有三个字符。

也许这是一个我不理解的功能，但它开始困扰我。

有没有办法让用鼠标选择字符以旧的方式工作，就像在 VS 2008 中一样？

我已尝试卸载该插件并重置无用的设置。

有它的视频[http://www.youtube.com/watch?v=8wNFQxpCAEQ](http://www.youtube.com/watch?v=8wNFQxpCAEQ)

PS：我正在运行 Windows 8 RP x64。

# drupal - Drupal7 中与内容（上下文）相关的块

> ID：11833251
> 
> 赞同：0
> 
> 时间：2012-08-06T17:44:35.580
> 
> 标签：drupal, drupal-blocks

案例如下：例如，我有一个带有“data_field”字段的自定义内容类型。我想在侧边栏上有一个块，可以正确处理和显示这个“data_field”字段的数据。如何使用 Drupal API 访问它？

PS 我知道这个问题可以通过 Views 以某种方式解决，它具有特定于内容的显示能力，但我对它通过 API 实现的方式很感兴趣。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T06:50:49.773

使用内容类型的默认 Drupal 设置呈现字段：

```
$n = node_load($nid_of_content);
$n = node_view($n);
print render($n['field_somevalue']); 
```

您也可以指定节点显示格式，例如

```
$n = node_view($n, 'teaser'); 
```

如果您想以不同的方式操作字段内容，请使用原始字段值：

```
$n = node_load($nid_of_content);
$value_you_want = $n->field_data_field_somevalue['und'][0]['value']; 
```

这假设您没有使用任何语言/翻译功能 - 'und' 代表“未定义”并声明没有为节点显式设置语言。

如果字段可以包含多个值，则遍历 ['und'][0]['value'] 到 ['und'][x]['value']

上面的代码显示了大多数字段类型的原始值。在开发过程中使用 print_r($n->field_somevalue) 找出哪些值可供您使用；这取决于字段类型。例如，文件类型为您提供“uri”（以及其他）而不是“值”，文本字段也具有应用了输入格式过滤的“安全值”，长文本字段将具有“摘要”和“安全摘要”等。

# erlang - 使用 odbc，是单独的 sql_query/2 调用，涉及 Select 保证的 ACID，然后是提交

> ID：11833254
> 
> 赞同：0
> 
> 时间：2012-08-06T17:44:46.063
> 
> 标签：erlang, odbc

我知道 ODBC 库有一个 commit/2 和 commit/3，但我不确定我是否正确解释了它的使用。

如果我执行以下操作

1.  使用 {auto_commit, off} 属性创建会话
2.  然后执行一系列单独的 sql_query/2 SELECT 语句（不是批处理语句，而是单独调用 sql_query/2）
3.  然后是 commit/2

选择是否在保证 ACID 属性的单个事务中完成？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-20T14:42:49.923

似乎 unixodbc-oracle 驱动程序有问题，即在创建连接期间它没有正确设置 auto_commit 属性。您可以应用[https://github.com/brb/otp/commit/111f3c091d5f1e9214d2e7cfbd73400b6602a0ed](https://github.com/brb/otp/commit/111f3c091d5f1e9214d2e7cfbd73400b6602a0ed)更改，让您在建立连接后更改 auto_commit 模式。

# sql - SQL 查询 - 显示计数和所有具有相同名称的 ID

> ID：11833255
> 
> 赞同：0
> 
> 时间：2012-08-06T17:45:00.067
> 
> 标签：sql, database-design, sqlite

我正在尝试显示具有相同名称的表条目的数量以及与每个条目关联的唯一 ID。

所以我有一张这样的桌子......

```
Table Names
------------------------------
ID    Name
0    John
1    Mike
2    John
3    Mike
4    Adam
5    Mike 
```

我希望输出类似于：

```
Name | Count | IDs
---------------------
Mike     3     1,3,5
John     2     0,2
Adam     1     4 
```

除了显示所有唯一 ID 之外，我有以下查询：

```
select name, count(*) as ct from names group by name order by ct desc; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T17:46:56.433

```
select name,
       count(id) as ct, 
       group_concat(id) as IDs
from names
group by name
order by ct desc; 
```

您可以为此使用[GROUP_CONCAT](http://dev.mysql.com/doc/refman/5.0/en/group-by-functions.html#function_group-concat)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T18:06:16.530

根据您使用的 MSSQL 版本（2005+），您可以使用该`FOR XML PATH`选项。

```
SELECT 
    Name, 
    COUNT(*) AS ct, 
    STUFF((SELECT ',' + CAST(ID AS varchar(MAX)) 
           FROM names i 
           WHERE i.Name = n.Name FOR XML PATH(''))
        , 1, 1, '') as IDs
FROM names n
GROUP BY Name
ORDER BY ct DESC 
```

`group_concat`除非您使用 SQLCLR 选项（我没有这样做的经验），否则最接近您的将是 MSSQL。该`STUFF`函数负责处理前导逗号。此外，您不想为内部命名，`SELECT`因为它会将您选择的元素包装在 XML 元素中（别名`TD`会导致每个元素返回为`<TD>value</TD>`）。

鉴于上面的输入，这是我得到的结果：

```
Name    ct  IDs
Mike    3   1,3,5
John    2   0,2
Adam    1   4 
```

## 编辑：免责声明

`&`对于可能包含特殊字符（如和号、小于`<`、大于`>`和任何数量的其他格式字符）的字符串字段，此技术将无法正常工作。**因此，这种技术对简单的整数值最有利，尽管如果您绝对**确定没有需要转义的特殊字符，仍然可以将其用于文本。因此，请阅读[此处](https://stackoverflow.com/a/5031297/65223)发布的解决方案，以确保正确转义这些字符。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-06T19:30:49.497

这是另一种使用递归 CTE 的 SQL Server 方法：

链接到[SQLFiddle](http://sqlfiddle.com/#!3/4fe79/1)

```
; with MyCTE(name,ids, name_id, seq)
as(
    select name, CAST( '' AS VARCHAR(8000) ), -1, 0
    from Data
    group by name
    union all
    select d.name,  
            CAST( ids + CASE WHEN seq = 0 THEN '' ELSE ', ' END + cast(id as varchar) AS VARCHAR(8000) ),
            CAST( id AS int),
            seq + 1
    from MyCTE cte 
    join Data d
        on cte.name = d.name
    where d.id > cte.name_id
)
SELECT name, ids
      FROM ( SELECT name, ids,
                    RANK() OVER ( PARTITION BY name ORDER BY seq DESC )
               FROM MyCTE ) D ( name, ids, rank )
     WHERE rank = 1 
```

# php - PHP 将 Class 和 id 编写为单引号而不是双引号。为什么？

> ID：11833256
> 
> 赞同：1
> 
> 时间：2012-08-06T17:45:04.443
> 
> 标签：php, html, joomla

我最近在 Joomla 项目中遇到了很多错误，并且发现了诸如（在类代码中）之类的东西......

```
return "<span class='... 
```

或者

```
echo "<h3 id='... 
```

代替

```
return "<span class=\"...
echo "<h3 id=\"... 
```

这包括多次引号中的变量，但它仍然可以通过单引号找到我的浏览器。在经历和改变这些之前，我想看看其他人要说什么。我的项目位于[http://dev.thediabetesnetwork.com](http://dev.thediabetesnetwork.com)。

我查了一下，发现很多相互矛盾的信息，所以我想我会重新讨论最新的 PHP/浏览器配置，看看我是否忽略了其他细节。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-06T17:48:57.337

浏览器接受两者，因此没有更深层次的理由先选择一个。从 PHP 的角度来看，单引号的可读性更高，因为您可以将字符串用双引号括起来并使用变量替换。比较自己

```
"<a href='$url'>Foo</a>"
"<a href=\"$url\">Foo</a>"
'<a href="' . $url . '">Foo</a>' 
```

另一种解决方案是手动替换内容，例如

```
sprintf('<a href="%s">Foo</a>', $url); 
```

或heredoc

```
echo <<<HTML
<a href="$url">Foo</a>
HTML; 
```

我会选择最适合当前上下文的那个（关于可读性）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-06T17:49:28.177

如果字符串中的所有双引号都没有用`\`.

如果需要在字符串表达式中输出变量，必须使用双引号。如果您在双引号内输出 HTML，您可以使用`'`或`\"`包含 HTML 属性。第一个是首选，因为它可以生成更简洁的 PHP 代码。

如果您不希望您的 HTML 使用单引号，那么您可以转义所有引号，使用[heredoc 语法](http://hu.php.net/manual/en/language.types.string.php#language.types.string.syntax.heredoc)，或将变量连接到字符串中，例如：

```
echo '<div class="test">' . $var . '</div>'; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-06T17:51:05.897

如果字符串不需要评估（例如，如果它包含变量等），则不需要使用双引号。事实上，由于双引号会导致对字符串求值，因此它们的效率低于使用单引号和连接。

此外，在 HTML 标记中使用双引号是惯例，所以我会这样做：

```
return '<span class="test">' . $var . '</span>'; 
```

在我看来，Joomla 的代码非常糟糕，您发布的内容只是另一个例子。

正如您在上面看到的，此方法的另一个优点是代码荧光笔和 IED 可以轻松区分“静态”字符串和变量。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-06T17:52:23.957

双引号和单引号在 php 中有不同的功能。

您可以将变量甚至数组放入带有双引号的字符串中，但不能使用单引号。

两者在 HTML 规范中都是可以接受的。事实上，如果没有空格，即使没有引号也是如此。大多数人更喜欢我知道 php 有双引号，这样您就可以使用变量而不会破坏代码和可读性，因为没有反斜杠。

```
return "<span class='foo'>$foo</span>";
return "<span class=\"foo\">$foo</span>";
return '<span class="foo">'.$foo.'</span>';
return '<span class=\'foo\'>'.$foo.'</span>'; 
```

对大多数人来说，除了第一个之外，所有的工作都是最容易阅读和输入的。

您可以在此处的 php 文档中阅读有关 php 字符串、双引号、单引号、heredoc 和 nowdoc 语法的所有信息：http: [//php.net/manual/en/language.types.string.php](http://php.net/manual/en/language.types.string.php)

```
echo <<<EOT
My name is "$name". I am printing some $foo->foo.
Now, I am printing some {$foo->bar[1]}.
This should print a capital 'A': \x41
EOT; 
```

是示例 Heredoc 语法，它允许您为长的多行字符串选择起始和结束分隔符。Nowdoc 与heredoc 相同，但与单引号一样，不能将变量放入字符串中。

# javascript - javascript天数计算

> ID：11833257
> 
> 赞同：1
> 
> 时间：2012-08-06T17:45:05.317
> 
> 标签：javascript, date

我有以下代码

```
// code set somewhere else on page
var ad = "2012-08-29";
var dd = "2012-09-03";

//my code
var a = new Date(ad+'T00:00:00');
var d = new Date(dd+'T00:00:00');
var nn = Math.ceil( parseInt(  ( d.getTime()-a.getTime() ) / (1000*60*60*24) ) ); 
```

`dd`应该总是比`ad`.

`nn`应该是 和 之间的夜数，所以*在*这个例子中，我应该有一个值 5 （当我测试它时它确实如此）。`ad``dd``nn`

`nn`正在被跟踪（放入一个 GA 变量和一个 Omniture 变量中），但大约 50% 的时间它没有得到一个值。我们进行了三次检查，并且 100% 排除了跟踪本身没有问题（我们已经检查以确保跟踪实施是正确的，并且 GA 和 Omniture 之间的（缺少）数字是一致的）。

我们正在调查以确保`ad`并且`dd`始终是预期的 yyyy-mm-dd 格式，并且这`dd`始终是比未来更远的日期`ad`，但假设这是闪亮的，**有人能想到这个计算失败的原因吗？**

编辑：澄清一下，我不认为这个计算失败了，但在排除它之前我想要第二个（或第三个！）意见。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T17:56:01.807

您在最后一行代码中缺少一个结束括号。包括最后的括号，代码运行良好`nn = 5`，我相信这是预期的结果。

```
var nn = Math.ceil( parseInt(  ( d.getTime()-a.getTime() ) / (1000*60*60*24) ) ); 
```

或者，您可以按照 Bergi 的建议删除 parseInt（它对代码没有影响）。只要确保括号匹配就可以了。

# python - 如何读取字符串的第一行？

> ID：11833266
> 
> 赞同：54
> 
> 时间：2012-08-06T17:45:20.953
> 
> 标签：python, string

```
my_string = """This is my first line,
this is my second line, and...

...this is my fourth line!""" 
```

如何将该 ( `This is my first line,`) 的第一行存储到单独的字符串中？我试图`.readline()`从另一个类似的问题中使用，但是我收到了这个错误：

`AttributeError: 'str' object has no attribute 'readline'`

* * *

## 回答 #1

> 赞同：134
> 
> 时间：2012-08-06T17:46:25.320

用于[`str.partition()`](http://docs.python.org/library/stdtypes.html#str.partition)在换行符上拆分字符串，并从结果中获取第一项：

```
my_string.partition('\n')[0] 
```

如果您只需要在单个位置拆分字符串，这是最有效的方法。你也可以使用[`str.split()`](http://docs.python.org/library/stdtypes.html#str.split)：

```
my_string.split('\n', 1)[0] 
```

然后你需要告诉该方法只在第一个换行符上拆分一次，因为我们丢弃了其余的。

或者您可以使用以下[`.splitlines()`方法](http://docs.python.org/library/stdtypes.html#str.splitlines)：

```
my_string.splitlines()[0] 
```

但这必须为输入字符串中的每个换行符创建单独的字符串，因此效率不高。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-06T17:53:40.453

readline 与流结合使用。如果您坚持使用 readline，则可以使用 StringIO：

```
from StringIO import StringIO

sio = StringIO(my_string)
for sline in sio.readlines():
    print sline 
```

我会做

```
 for line in my_string.split('\n'):
        print line 
```

或者做

```
import re
for line in re.split('\n', my_string):
    print line 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-06T17:47:47.670

您可以使用`split()`：

```
my_string = """This is my first line,
this is my second line, and...

...this is my fourth line!"""

lines = my_string.split('\n') 
```

# javascript - 使 scrollTop 始终检查

> ID：11833269
> 
> 赞同：2
> 
> 时间：2012-08-06T17:45:47.720
> 
> 标签：javascript, jquery

我正在做一个 scrollTop jQuery 函数，它工作得非常好，见下文：

```
$(function() {
    $(window).scroll(function() {
        var top = $(document).scrollTop();
        if (top >= 1225) {
            // Do something
        }
    });
}); 
```

但是，如果用户有他的`scrollTop`，在这种情况下，高于 1225，并且脚本没有完全加载，则该功能将不会发生，只要他再次滚动页面。有没有办法让`scrollTop`总是检查，而不仅仅是用户滚动页面？

非常感谢提前。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-06T17:49:38.473

是的，自己触发事件。

```
$(function() {
    $(window).scroll(function() {
        var top = $(document).scrollTop();
        if (top >= 1225) {
            // Do something
        }
    }).triggerHandler("scroll");
}); 
```

# javascript - Rally：有没有一种简单的方法可以获取投资组合项下的所有用户故事？

> ID：11833270
> 
> 赞同：0
> 
> 时间：2012-08-06T17:45:48.113
> 
> 标签：javascript, rally

我知道我可能能够递归地获取每个投资组合项的子项，然后继续查询先前获得的子项的子项。但是，我想知道是否有更简单的解决方案来获取投资组合项下的所有用户故事。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T17:32:04.240

您是否尝试在应用程序中执行此操作？还是使用 REST 工具包？无论哪种方式，我都不相信这是可能的。查看一些结果，看起来只有最顶层的父用户故事有对其关联的投资组合项的引用。否则，任何子用户故事中都会省略投资组合项，仅引用上一级的父用户故事。似乎唯一的向下钻取方法是首先检索所有顶级用户故事，然后递归检查子级并检索它们。

# iphone - 在presentmodalviewcontroller之前刷新

> ID：11833279
> 
> 赞同：1
> 
> 时间：2012-08-06T17:46:31.823
> 
> 标签：iphone, objective-c, ios, xcode4

按下按钮会调用我的代码中的视图：

```
buttonlabel.text = @"Wait";
[self presentModalViewController:controller animated:YES];
buttonlabel.text = @"Done"; 
```

单击按钮后，我想立即将标签更改为“等待”。当前发生的情况是，视图的呈现需要 1-2 秒，并且标签仅在 1-2 秒过去后且视图更改之前更改为“等待”。

将动画从 YES 更改为 NO 无济于事。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T17:56:43.027

您需要将视图控制器的呈现*排队*，以便系统有机会实际将按钮的文本更改为“等待”。如果你想了解更多信息，谷歌`runloop iOS`。

```
buttonlabel.text = @"Wait";
dispatch_async(dispatch_get_main_queue(), ^{
    [self presentModalViewController: controller animated: YES];
}); 
```

但是你真的应该调查一下为什么展示 VC 需要这么多时间，而是找到一种方法来优化你的代码。寻找合并并发的方法，不要阻塞主线程。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-06T17:57:04.120

```
buttonlabel.text = @"Wait";

dispatch_time_t popTime = dispatch_time(DISPATCH_TIME_NOW, 0.5 * NSEC_PER_SEC);
dispatch_after(popTime, dispatch_get_main_queue(), ^(void){
     [self presentModalViewController:controller animated:YES];
     buttonlabel.text = @"Done";

}); 
```

# c# - 如何获取 google oauth 的访问令牌？

> ID：11833281
> 
> 赞同：11
> 
> 时间：2012-08-06T17:46:41.453
> 
> 标签：c#, asp.net, google-api, oauth-2.0

我正在使用 C# (ASP.NET)。我想使用 Google OAuth 访问我的应用程序中的用户个人资料详细信息。我成功获得了授权码，但在获取访问令牌时遇到了问题。我更喜欢[谷歌教程](https://developers.google.com/accounts/docs/OAuth2WebServer)。在教程中，我读到我必须发送请求并从谷歌获得响应。为此，我使用`System.Net.HttpWebRequest/HttpWebResponse`（我是否以正确的方式进行）。我用过这段代码...

```
byte[] buffer = Encoding.ASCII.GetBytes("?code=" + code + "&client_id=xxx&client_secret=xxx&redirect_uri=xxxx&grant_type=authorization_code");
HttpWebRequest req = (HttpWebRequest)WebRequest.Create("http://accounts.google.com");
req.Method = "POST";
req.ContentType = "application/x-www-form-urlencoded";
req.ContentLength = buffer.Length;

Stream strm = req.GetRequestStream();
strm.Write(buffer, 0, buffer.Length);
strm.Close();

HttpWebResponse resp = (HttpWebResponse)req.GetResponse();
Response.Write(((HttpWebResponse)resp).StatusDescription); 
```

但是，我得到了错误：

> 远程服务器返回错误：(405) Method Not Allowed。

更新：这里的变量`code`是授权码。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-06T20:05:14.763

我认为您将 POST 请求发送到错误的端点，正确的是`https://accounts.google.com/o/oauth2/token`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-18T20:05:14.393

由于我在实现谷歌身份验证的过程中遇到了类似的问题，所以我将发布有效的代码。最后提到的问题：错误（400）错误请求可能是由前导'？'引起的 在上面的代码中..

```
 string codeClient = "code="+ t +"&client_id=number.apps.googleusercontent.com&";
 string secretUri = "client_secret=yoursecret&" + "redirect_uri=path&"
      + "grant_type=authorization_code";
 postString = codeClient + secretUri;

 string url = "https://accounts.google.com/o/oauth2/token";

 HttpWebRequest request = (HttpWebRequest) WebRequest.Create(url.ToString());
 request.Method = "POST";
 request.ContentType = "application/x-www-form-urlencoded";

 UTF8Encoding utfenc = new UTF8Encoding();
 byte[] bytes = utfenc.GetBytes(postString);
 Stream os = null;
 try
 {
      request.ContentLength = bytes.Length;
      os = request.GetRequestStream();
      os.Write(bytes, 0, bytes.Length);
 }
 catch
 { }

 try
 {
      HttpWebResponse webResponse = (HttpWebResponse) request.GetResponse();
      Stream responseStream = webResponse.GetResponseStream();
      StreamReader responseStreamReader = new StreamReader(responseStream);
      result = responseStreamReader.ReadToEnd();//parse token from result 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-21T08:08:08.137

我的代码正在运行，我在上面两行中犯了错误。应该是这样的

```
byte[] buffer = Encoding.ASCII.GetBytes("code=" + code + "&client_id=xxx&client_secret=xxx&redirect_uri=xxxx&grant_type=authorization_code");
HttpWebRequest req = (HttpWebRequest)WebRequest.Create("https://accounts.google.com/o/oauth2/token"); 
```

剩下的代码是正确的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-05T20:17:59.087

最初的请求似乎有些过时了。但我发现 Google 的代码示例包含许多“最佳实践”的管家代码，这些代码很难与基本操作分开。

我最近发布了一个将所有 REST 操作表示为 curl 命令的文档。很难精通每种语言，但 curl 似乎是通用的。大多数人都知道 - 否则，它很容易掌握。在我的 curl 示例中，*-d*标志表示 POST 操作。否则，参数将附加到 URL。

[http://www.tqis.com/eloquency/googlecalendar.htm](http://www.tqis.com/eloquency/googlecalendar.htm)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-07-04T18:44:48.763

```
public string ReceiveTokenGmail(string code, string GoogleWebAppClientID, string GoogleWebAppClientSecret, string RedirectUrl)
{
    string postString = "code=" + code + "&client_id=" + GoogleWebAppClientID + @"&client_secret=" + GoogleWebAppClientSecret  + "&redirect_uri=" + RedirectUrl;

    string url = "https://accounts.google.com/o/oauth2/token";

    HttpWebRequest request = (HttpWebRequest)WebRequest.Create(url.ToString());
    request.Method = "POST";
    request.ContentType = "application/x-www-form-urlencoded";

    UTF8Encoding utfenc = new UTF8Encoding();
    byte[] bytes = utfenc.GetBytes(postString);
    Stream os = null;
    try
    {
        request.ContentLength = bytes.Length;
        os = request.GetRequestStream();
        os.Write(bytes, 0, bytes.Length);
    }
    catch
    { }
    string result = "";

    HttpWebResponse webResponse = (HttpWebResponse)request.GetResponse();
    Stream responseStream = webResponse.GetResponseStream();
    StreamReader responseStreamReader = new StreamReader(responseStream);
    result = responseStreamReader.ReadToEnd();

    return result;
} 
```

# android - 在以下网站中的以下给定代码中发生错误

> ID：11833282
> 
> 赞同：-1
> 
> 时间：2012-08-06T17:46:45.307
> 
> 标签：android

[https://developers.facebook.com/docs/mobile/android/build/](https://developers.facebook.com/docs/mobile/android/build/)

在以下网站中的以下给定代码中发生错误

```
 package com.greatapp;

import android.app.Activity;
import android.content.Intent;
import android.os.Bundle;
 import com.facebook.android.*;
 import com.facebook.android.Facebook.*;

  public class MyGreatActivity extends Activity {

   Facebook facebook = new Facebook("YOUR_APP_ID");

   @Override
   public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
   <i> setContentView(R.layout.main);  < i>  I have gotten error here

    facebook.authorize(this, new DialogListener() {
        @Override
        public void onComplete(Bundle values) {}

        @Override
        public void onFacebookError(FacebookError error) {}

        @Override
        public void onError(DialogError e) {}

        @Override
        public void onCancel() {}
      });
   }

  @Override
   public void onActivityResult(int requestCode, int resultCode, Intent data) {
    super.onActivityResult(requestCode, resultCode, data);

    facebook.authorizeCallback(requestCode, resultCode, data);
   }
  } 
```

`setContentView(R.layout.main);``main`该错误告诉我们在 type 中创建一个字段`layout`。我试过了，但`R.java`文件不能手动修改。我该如何解决这个错误？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T18:21:00.877

它指的是您的 res 目录，资源。

res/layout/main.xml 是它希望您创建的文件。

# c++ - 如何在 Windows 上为 Visual Studio 2005 设置 wxwidgets

> ID：11833292
> 
> 赞同：3
> 
> 时间：2012-08-06T17:47:24.170
> 
> 标签：c++, user-interface, visual-studio-2005, installation, wxwidgets

我正在尝试做一些 GUI 的东西，我想在 Windows 7 上为 Visual Studio 2005 设置 wxWidget。我在过去几天阅读了可能的教程和帮助，但它们都显示了不同的方式。他们都不适合我。在包含 c:/wxWidgets-2.9.4/include 和 /lib 目录到 Visual Studio 但仍然显示 wx/setup.h 未找到。任何人都可以提供从头开始设置 wxWidget 的教程。（从下载所需的包到完整的工作示例）。因为我也很困惑我应该下载哪一个，所以他们提供了许多 zip forders。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-07T14:50:12.333

@tinman 的配方允许您构建任何东西，但这需要很长时间。

一个更简单的配方，它只构建必要的库：

*   使用安装包进行安装。

*   找到 microsoft visual studio build 文件夹。在我的安装中，这是 C:\wxWidgets-2.9.n\build\msw

*   找到适合您的 Visual Studio 版本的解决方案（例如 wx_vc8.sln）并打开它。

*   选择您在构建应用程序时要使用的配置。（例如 DLL 发布）

*   构建解决方案。

完毕。在任何相当强大的机器上，它应该需要大约五分钟。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-07T11:40:23.953

有许多 zip 存档的原因是，从 2.9 开始，它们为每个 MSVC 版本提供了预构建的二进制包。我从来没有使用过这些，所以我不能对它们发表评论，但它们可能会为你节省大量构建源代码的时间并为你提供一个官方库。

我使用了 MSW 安装包并从源代码构建。这就是我所做的，对我来说效果很好（除了我目前使用 wx292、VS2008 和 Windows 7）。

下载[wxWidgets 2.9.4 MSW 安装包](http://sourceforge.net/projects/wxwindows/files/2.9.4/wxMSW-2.9.4-Setup.exe/download)。

安装它。我假设它会在`c:\wxWidgets-2.9.4`.

创建一个`c:\wxwidgets-2.9.4\build.bat`包含以下内容的批处理文件。你应该`myvendor`用你的名字替换，这样很明显它不是一个官方的 wxWidgets 库构建（它将被放在文件名中，所以避免空格）。

```
@echo off
PUSHD build\msw
call :make

cd ..\..\samples
call :make

cd ..\demos
call :make

cd ..\utils
call :make

POPD
GOTO :EOF

@REM Perform builds with all desired configurations
:make
@REM x86 debug & release multiple DLLs Unicode
nmake -f makefile.vc MONOLITHIC=0 SHARED=1 UNICODE=1 BUILD=debug VENDOR=myvendor
nmake -f makefile.vc MONOLITHIC=0 SHARED=1 UNICODE=1 BUILD=release VENDOR=myvendor

@REM x86 debug & release multiple static libs Unicode
nmake -f makefile.vc MONOLITHIC=0 SHARED=0 UNICODE=1 BUILD=debug VENDOR=myvendor
nmake -f makefile.vc MONOLITHIC=0 SHARED=0 UNICODE=1 BUILD=release VENDOR=myvendor 
```

从“开始”菜单打开 Visual Studio 2005 命令提示符。这将正确设置编译器和库的路径。

将目录更改为 wxWidgets: `cd c:\wxWidgets-2.9.4`。

跑过`build.bat`

它应该在几个小时后完成，具体取决于您的计算机规格，或者您可以`REM`构建示例、实用程序和演示以减少时间（感谢@ravenspoint）。您还可以查看示例`c:\wxWidgets-2.9.4\samples`项目并从示例项目中获取 Visual Studio 项目设置以在您自己的项目中使用（例如`C:\wxWidgets-2.9.4\samples\dialogs\dialogs_vc8.vcproj`）。

在构建库之后，您最终会得到一些额外的目录，`C:\wxWidgets-2.9.4\lib`其中包含构建的库、dll 和该变体的任何构建特定标头。以下目录是从我的批处理脚本中的构建创建的，并使用工具集（在本例中为 Visual C 的 vc，但可能是特定于版本的，例如 vc80 或固定版本，具体取决于您的构建设置）和库类型. `msw`目录和文件名中的意思是 MicroSoft Windows。`u`在目录和文件名中表示 Unicode。`d`在目录和文件名的末尾表示调试。

*   `C:\wxWidgets-2.9.4\lib\vc_lib`: Visual C (vc) 静态库 (lib) 版本的 wxWidgets
    *   `C:\wxWidgets-2.9.4\lib\vc_lib\mwsu`: MicroSoft Windows Unicode 特定文件
    *   `C:\wxWidgets-2.9.4\lib\vc_lib\mwsud`: MicroSoft Windows Unicode Debug 特定文件
    *   还包含用于发布和调试的静态库的混合
*   `C:\wxWidgets-2.9.4\lib\vc_dll`: wxWidgets 的 Visual C (vc) DLL (dll) 版本
    *   `C:\wxWidgets-2.9.4\dll\vc_lib\mwsu`: MicroSoft Windows Unicode 特定文件
    *   `C:\wxWidgets-2.9.4\dll\vc_lib\mwsud`: MicroSoft Windows Unicode Debug 特定文件
    *   还包含用于发布和调试的 DLL 和导入库的混合

为了在您自己的项目中使用新构建的库，您可以按照以下步骤操作（我使用的是 VS2008，因此某些配置名称可能会略有不同）：

创建新项目时，您需要转到项目属性。

如果您正在使用 DLL，请在配置属性 -> 常规 -> 环境下添加以下内容（以便您的应用程序可以找到 DLL）：

```
PATH=C:\wxWidgets-2.9.4\lib\vc_dll 
```

在 C/C++ -> General -> Additional Include Directories 下，您需要按以下顺序添加 wxWidgets 包含：

1.  "C:\wxWidgets-2.9.4\include\msvc"
2.  "C:\wxWidgets-2.9.4\include"

首先包含目录 1 的原因是该`wx\setup.h`目录中有一个。当您包含它时，它会尝试确定什么编译器、库类型（静态或 DLL）、您是否使用 Unicode 以及它是调试还是发布，它会自动包含来自以下之一的正确的真实 wx/setup.h的子目录`C:\wxWidgets-2.9.4\lib`。

然后，您需要转到 C/C++ -> Preprocessor -> Preprocessor Definitions 并添加以下行：

```
__WXMSW__ 
```

如果要使用 wxWidgets 的 DLL 版本而不是静态库，则需要添加以下行：

```
WXUSINGDLL 
```

在 Linker -> General -> Additional Linker Directories 下，如果您使用静态库，则需要添加以下路径：

```
"C:\wxWidgets-2.9.4\lib\vc_lib" 
```

或者如果您使用的是 DLL，请使用以下路径：

```
"C:\wxWidgets-2.9.4\lib\vc_dll" 
```

在链接器 -> 输入 -> 附加依赖项中，您可能需要至少添加以下内容：

```
comctl32.lib rpcrt4.lib 
```

在 Resources -> General -> Additional Include Directories 下，您需要添加以下路径：

```
C:\wxWidgets-2.9.4\include 
```

# python - Python 可执行文件出现运行时错误。R6034

> ID：11833301
> 
> 赞同：0
> 
> 时间：2012-08-06T17:47:49.487
> 
> 标签：python, executable, runtime-error, pyinstaller

我最近将我的 wxpython 脚本转换为可执行文件并运行它们，但出现运行时错误。该错误与 C++ 运行时库有关。然而，这个错误似乎并没有影响任何东西。我可以点击它，我的程序运行得很好。任何人都知道如何摆脱这个错误？

编辑：从这个线程中查看更多内容后：[http](http://forums.devshed.com/python-programming-11/py2exe-manifests-and-vc-redist-dlls-600827.html) ://forums.devshed.com/python-programming-11/py2exe-manifests-and-vc-redist-dlls-600827.html ，这似乎是一个错误清单文件。我找到了文件 myProgram.exe.manifest。我到底应该把它放在哪里？另外作为记录，我使用 PyInstaller 创建可执行文件

编辑 2：这是错误的链接：http: [//i.imgur.com/8osT3.jpg](http://i.imgur.com/8osT3.jpg)

编辑 3：我厌倦了依赖 walker，发现两个文件丢失 GPSVC.DLL IESHIMS.DLL

我在哪里可以得到这些，我应该把它们放在哪里？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-13T03:16:06.213

如果您使用的是 3.3.0，请查看 C:\Python33 或您的 python 安装目录。您应该找到 msvcr100.dll。将其重命名为 msvcr90.dll 并结束。试试看！！然后尝试重新编译为exe！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T18:27:23.457

相似的：

*   [Py2exe：创建了 exe，但如果你运行它，你会得到一个运行时错误 R6034](https://stackoverflow.com/questions/9793742/py2exe-the-exe-is-created-but-if-you-run-it-you-get-a-runtime-error-r6034)
*   [https://groups.google.com/forum/?fromgroups#!topic/pyinstaller/AkU4pARcLUE](https://groups.google.com/forum/?fromgroups#!topic/pyinstaller/AkU4pARcLUE)

尝试在您的 exe 上使用[Dependency Walker](http://www.dependencywalker.com/)以查看它是否缺少任何 DLL 文件。

# django - Django：只显示用户自己的数据

> ID：11833305
> 
> 赞同：2
> 
> 时间：2012-08-06T17:48:25.260
> 
> 标签：django, authentication, model, private

我构建了一个应用程序，在其中列出人员和公司。个人和公司的每个条目都归一个用户所有。

```
owner = models.ForeignKey('auth.User', related_name='+', null=True, blank=True) 
```

我想知道如何在每个视图中只显示特定用户拥有的帖子。这样只显示用户添加的公司，而不是每个用户的每个条目。

我想 if request.user = people.owner 可能会起作用，但这真的是最好的方法吗？

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T17:57:54.913

当您在视图中找到相关模型时，按用户过滤：

```
 people = People.objects.filter(owner=request.user).filter(...) 
```

如果您想稍微考虑一下，可以使用带有相关方法的[自定义管理器](https://docs.djangoproject.com/en/1.3/topics/db/managers/#custom-managers)，看起来像

```
people = People.objects.for_current_user(request).filter(...) 
```

但是当然这并不能节省太多的输入，因为你仍然需要传入`request`对象——但是如果你想要更复杂的逻辑（例如超级用户可以查看所有人），那么这会很方便。

# android - GoogleMaps GeoPoint 取值范围

> ID：11833306
> 
> 赞同：0
> 
> 时间：2012-08-06T17:48:26.617
> 
> 标签：android, google-maps, google-api, geopoints

我试图`GeoPoints`在我的地图上添加一些，但我遇到了一些“特殊”点的问题。

纬度值的范围是 +90 到 -90，因此我想添加一个像这样的点......

```
int latitude: 85000000;
int longitude = 45000000;
GeoPoint point = new GeoPoint(latitude, longitude); 
```

...在此之后，我再次检查纬度值：

```
point.getLongitudeE6(); 
```

我总是得到 80000000 的最大值。有人可以解释为什么谷歌为 a 设置此限制`GeoPoint`以及此限制的原因是什么？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T17:59:38.720

您的问题与`getLatitudeE6()`. `GeoPoint`在两极附近不起作用。你可能走得太北或太南了。

此行为是设计使然。从[文档](https://developers.google.com/maps/documentation/android/reference/index?com/google/android/maps/GeoPoint.html)：

> [纬度] 将被限制在 -80 度和 +80 度之间（含），以保持墨卡托投影的准确性。

同样，经度限制在 -180 到 +180 之间。

# c - Eclipse CDT 未解决的包含

> ID：11833310
> 
> 赞同：2
> 
> 时间：2012-08-06T17:48:56.223
> 
> 标签：c, eclipse, eclipse-cdt

我已经使用 makefile 编译了代码。我正在尝试使用 Eclipse 4.2 对其进行编辑。我的问题是一些未解决的包含：

```
#include <kik/sip/sip_api.h> 
```

文件 sip_api.h 位于 kik/sip/kk/include 中。

我已将相关目录添加到项目包含中。

问题是什么？

# java - 将键和值从映射写入文件

> ID：11833318
> 
> 赞同：0
> 
> 时间：2012-08-06T17:49:20.353
> 
> 标签：java, iteration

使用下面的代码，我试图将男性和女性地图的键和值写入现有文件。

但它显示以下错误。

有人可以帮我吗。

```
 ERROR@      Map.Entry entry = (Map.Entry) entryIter.next();

   java.util.NoSuchElementException
   at java.util.LinkedHashMap$LinkedHashIterator.nextEntry(Unknown Source)
   at java.util.LinkedHashMap$EntryIterator.next(Unknown Source)
   at java.util.LinkedHashMap$EntryIterator.next(Unknown Source)
   at test.main(test.java:83) 
```

代码

```
public static void main(String[] args) {
    Map<String, List<String>> MaleMap = new LinkedHashMap<String, List<String>>();
    Map<String, List<String>> FemaleMap = new LinkedHashMap<String, List<String>>();
    try {
        Scanner scanner = new Scanner(new FileReader(".txt"));

        while (scanner.hasNextLine()) {
            String nextLine = scanner.nextLine();
            String[] column = nextLine.split(":");
            if (column[0].equals("Male") && (column.length == 4)) {
                MaleMap.put(column[1],
                        Arrays.asList(column[2], column[3]));
            } else if (column[0].equals("Female") && (column.length == 4)) {
                FemaleMap.put(column[1],
                        Arrays.asList(column[2], column[3]));
            }
        }
        Set<Entry<String, List<String>>> entries = MaleMap.entrySet();
        Iterator<Entry<String, List<String>>> entryIter = entries.iterator();
        while (entryIter.hasNext()) {
            Map.Entry entry = (Map.Entry) entryIter.next();
            Object key = entry.getKey(); // Get the key from the entry.

            List<String> value = (List<String>) entry.getValue();
            Object value1 = " ";
            Object value2 = " ";
            int counter = 0;
            for (Object listItem : (List) value) {
                Writer writer = null;
                Object maleName = key;
                Object maleAge = null;
                Object maleID = null;
                if (counter == 0) {// first pass assign value to value1
                    value1 = listItem;
                    counter++;// increment for next pass
                } else if (counter == 1) {// second pass assign value to value2
                    value2 = listItem;
                    counter++;// so we dont keep re-assigning listItem for further iterations
                }
            }
            System.out.println(key + ":" + value1 + "," + value2);
            scanner.close();
            Writer writer = null;
            Object maleName = key;
            Object maleAge = value1;
            Object maleID = value2;
            try {
                String filename = ".txt";
                FileWriter fw = new FileWriter(filename, true); // the true will append the new data
                fw.write(maleAge + "." + maleID + "@@;" + "\n"
                        + " :class :" + maleName);// appends the string to the file
                fw.close();
            } catch (Exception e) {
                e.printStackTrace();
            }

        }
        Set<Entry<String, List<String>>> Fentries = FemaleMap.entrySet();
        Iterator<Entry<String, List<String>>> FentryIter = Fentries.iterator();
        while (FentryIter.hasNext()) {
            Map.Entry entry = (Map.Entry) entryIter.next();
            Object Fkey = entry.getKey(); // Get the key from the entry.

            List<String> value = (List<String>) entry.getValue();
            Object value1 = " ";
            Object value2 = " ";
            int counter = 0;
            for (Object listItem : (List) value) {
                Writer writer = null;
                Object femaleName = Fkey;
                Object femaleAge = null;
                Object femaleID = null;
                if (counter == 0) {// first pass assign value to value1
                    value1 = listItem;
                    counter++;// increment for next pass
                } else if (counter == 1) {// second pass assign value to value2
                    value2 = listItem;
                    counter++;// so we dont keep re-assigning listItem for further iterations
                }
            }
            System.out.println(Fkey + ":" + value1 + "," + value2);
            scanner.close();
            Writer writer = null;
            Object femaleName = Fkey;
            Object femaleAge = value1;
            Object femaleID = value2;
            try {
                String filename = ".txt";
                FileWriter fw = new FileWriter(filename, true); // the true will append the new data
                fw.write("map:" + femaleName + " a :Bridge;" + "\n"
                        + ":property" + femaleAge + ";" + "\n"
                        + ":column" + " " + femaleID + " " + ";");// appends the string to the file
                fw.close();
            } catch (Exception e) {
                e.printStackTrace();

            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T17:52:40.983

`Map.Entry entry = (Map.Entry) entryIter.next();`在你的第二个循环是打破。

在遍历男性的第一个 while 循环之后，您的迭代器已到达集合的末尾，当您尝试调用时将中断`next()`。

你真正想做的是遍历你的女性。

更改行以使用您的迭代`FentryIter`：

```
while (FentryIter.hasNext()) {
   Map.Entry entry = (Map.Entry) FentryIter.next(); 
```

这很可能是复制粘贴代码的结果，您在执行此操作时需要小心。我建议重构您的代码，因为其中有很多是重复的。

# javascript - IE错误-2147024882

> ID：11833319
> 
> 赞同：9
> 
> 时间：2012-08-06T17:49:22.563
> 
> 标签：javascript, internet-explorer, google-maps

我正在服务器端开发一个带有 vb.net 的网页，并在 .aspx 页面上为谷歌地图开发一些 javascript。该网页是一个大型的 GIS 事物，它绘制出格鲁吉亚某些县内的所有街区组，因此它是 .js 文件中大约 15MB 的纯 [纬度，经度] 点。在 chrome/firefox 中，地图加载，然后加载脚本，触发回调以绘制它定义的多边形，并将多边形绘制到地图上。在 IE 中，地图被加载，当脚本被加载时，控制台有一个`SCRIPT14: error -2147024882`在线 1。除了地图上的多边形之外，一切都正确显示。.js 文件的结构是只有几个变量的声明。

```
var allPolys = [
    [
      //poly1 points
      [x1,y1],
      [x2,y2],
      ...
    ],
    [
      //next poly
      [x1,y1],
      ...
    ]
] 
```

^^ 是每个多边形在 .js 中的定义方式。这是一个大小问题，因为所有点都在一个数组中吗？

映射代码：

```
 function drawPolys() {
                for (var i = 0; i < allTracts.length; i++) {
                    var tract = "new google.maps.Polygon({ strokeWeight: 0.7, path: [";
                    for (var j = 0; j < allTracts[i].length; j++)
                        tract += " new google.maps.LatLng(" + allTracts[i][j][0] + "," + allTracts[i][j][1] + "),";
                    tract = tract.substring(0, tract.length - 1) + "], map: map });";
                    eval(tract);
                }

                //this is all for other 'multipolygons' that are in some maps
                var colors = ['red', 'blue', 'green', 'orange', 'yellow', 'white'];

                for (var i = 0; i < multiPolys.length; i++) {
                    for (var j = 0; j < multiPolys[i].length; j++) {
                        var subTract = "new google.maps.Polygon({ strokeWeight: 1.5, strokeColor: '" + colors[i % colors.length] + "', fillColor: '" + colors[i % colors.length] + "', path: [";
                        for (var k = 0; k < multiPolys[i][j].length; k++)
                            subTract += " new google.maps.LatLng(" + multiPolys[i][j][k][0] + "," + multiPolys[i][j][k][1] + "),";
                        subTract = subTract.substring(0, subTract.length - 1) + "], map: map });";
                        eval(subTract);
                    }
                }
            } 
```

在 Chrome 中，页面加载精美。

编辑：没有 eval() 的新映射函数

```
 function drawPolys() {
                for (var i = 0; i < allTracts.length; i++) {
                    var path = [];
                    for (var j = 0; j < allTracts[i].length; j++)
                        path.push(new google.maps.LatLng(allTracts[i][j][0],allTracts[i][j][1]));
                    new google.maps.Polygon({ strokeWeight: 0.7, path: path, map: map });
                }

                var colors = ['red', 'blue', 'green', 'orange', 'yellow', 'white'];

                for (var i = 0; i < multiPolys.length; i++) {
                    var path = [];
                    for (var j = 0; j < multiPolys[i].length; j++) {
                        path[j] = [];
                        for (var k = 0; k < multiPolys[i][j].length; k++)
                            path[j].push(new google.maps.LatLng(multiPolys[i][j][k][0],multiPolys[i][j][k][1]));
                    }
                    new google.maps.Polygon({ strokeWeight: 1.5, strokeColor: colors[i % colors.length], fillColor: colors[i % colors.length], paths: path, map: map });
                }
            } 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-10T21:32:04.267

我相信我已经找到了这个错误的确切原因。

**编辑：我相信这个错误是从 IE 10 开始修复的**

我的测试表明，IE 将拒绝执行其中包含超过 2 ^(16) -3 个数字的 Javascript 文件。所以，如果一个 .js 文件有**65533**个数字，IE 会执行它。但是如果它包含**65534**或更多的数字，你会得到 error `−2147024882`。

我在这里提出了一个测试用例来演示这个问题：

[http://ie-error-2147024882.s3.amazonaws.com/ie_error_-2147024882.html](http://ie-error-2147024882.s3.amazonaws.com/ie_error_-2147024882.html)

我正在开发的网站从托管在 S3 上的 Javascript 文件加载大量 JSON 数据。起初我认为这是由于 IE 中的一些 Javascript 源文件大小限制。`−2147024882`但是一些测试表明，IE 可以处理比引发这个神秘错误的文件大得多的 .js 文件。

就我而言，解决方法是在生成 .js 文件时将整数和浮点数编码为字符串，并使用 parseInt 和 parseFloat 来解释它们。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-06T18:46:06.743

就我的谷歌搜索而言，这似乎是一个“内存不足”问题：

“错误 -2147024882 没有足够的可用内存来执行操作。- MAPI_E_NOT_ENOUGH_MEMORY（Microsoft Exchange Server 信息存储）

检查你的循环长度（multiPolys 和 allTracts）

还要检查你的字符串长度和子长度，它们可能太长了

# css - CSS-hack - 在网站正文中添加 CSS

> ID：11833325
> 
> 赞同：30
> 
> 时间：2012-08-06T17:49:54.957
> 
> 标签：css

我陷入了只能访问网站正文而不是头部的情况。我必须使用新的样式表。现在我遇到的解决方案是在网站正文中添加 CSS 文件。当然，这是一个 hack，所以我想知道是否有更好的解决方案？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2012-08-06T18:21:46.720

我们有不同的方式来加载 CSS 文件。

1 - HTML - 在页面上加载外部 CSS 文件的常规方法是：

```
<head>
   <link rel="stylesheet" type="text/css" href="file.css" />
</head> 
```

`import`2 - CSS - 使用CSS 文件中的标签

```
@import  url("another_file.css"); 
```

3 - JavaScript - 仅使用 JavaScript 来执行此操作，您应该创建一个 Javascript 函数：

```
<script type="text/javascript">

   function loadCSS(filename){ 
      var file = document.createElement("link");
      file.setAttribute("rel", "stylesheet");
      file.setAttribute("type", "text/css");
      file.setAttribute("href", filename);
      document.head.appendChild(file);
   }

   //just call a function to load your CSS
   //this path should be relative your HTML location
   loadCSS("path_to_css/file.css");
</script> 
```

4 - JavaScript - 您可以添加动态定义，例如：

```
<script type="text/javascript">

   var sheet = (function() {
      var style = document.createElement("style");
      style.appendChild(document.createTextNode(""));
      document.head.appendChild(style);
      return style.sheet;
   })();

   sheet.insertRule("span { visibility: hidden }", 1);
</script> 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-07-03T16:42:54.573

关于什么：

```
$('head').append('<link rel="stylesheet" type="text/css" href="{yoururl}">'); 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2012-08-06T18:24:19.123

你的意思是再次定义 CSS 并覆盖以前的 CSS 吗？：

```
​&lt;html>
    <head>
        <style type='text/css'>
            * {color:red;}
            p {background-color:yellow;}
        </style>
    </head>
    <body>
        <style type='text/css'>
            * {color:green;}
            p {background-color:black;}
        </style>
        <p>"Neque porro quisquam est qui dolorem ipsum quia dolor sit amet, consectetur, adipisci velit..."    </p>
        "Neque porro quisquam est qui dolorem ipsum quia dolor sit amet, consectetur, adipisci velit..."
        <p>"Neque porro quisquam est qui dolorem ipsum quia dolor sit amet, consectetur, adipisci velit..."    </p> 
    </body>   
</html>​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​ 
```

您可以在那里复制整个样式表，当然也可以将其包含在 php 或 javascript 中。但是像这样，查看头部 CSS 样式表并覆盖出现在正文中的所有样式应该可以工作。不确定这是否干净。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-08-06T18:13:34.263

您可以使用该`@import url("your_styles.css");`方法。

如果您有权访问在文档头部调用的样式表，则可以将其添加到 CSS 文档的顶部。

您也可以尝试在您的文档中添加替代品`<head>`，我不建议这样做，但如果您必须这样做，您也可以这样做：

```
<style type="text/css">
  @import url("your_style.css");
</style> 
```

如果您不关心向后兼容性，那么`scoped`在这个问题中还提到了 HTML5 属性：[<STYLE> 必须在 HTML 文档的 <HEAD> 中吗？](https://stackoverflow.com/questions/1303416/does-style-have-to-be-in-the-head-of-an-html-document)

希望这可以帮助！

编辑：

找到关于@import 功能的两个链接。一个是来自 Mozilla 开发者中心的工作草案，最后更新于 2012 年 7 月 31 日：

[https://developer.mozilla.org/en-US/docs/CSS/@import](https://developer.mozilla.org/en-US/docs/CSS/@import)

还有一篇带有浏览器支持统计信息的 Sitepoint 参考文章：

[http://reference.sitepoint.com/css/at-import](http://reference.sitepoint.com/css/at-import)

我想这在必要时仍然是一个功能性的、可用的特性。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2014-12-29T08:44:46.010

显然，它似乎对我有用，如果它看起来像

```
<link href="/main.css"  rel="stylesheet" type="text/css"  /> 
```

但不是，如果它包含`/css`in rel。

```
<link href="/main.css"  rel="stylesheet/css" type="text/css"  /> 
```

刚刚自己测试了这个，想发布这个来强调这个陷阱。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-08-06T18:05:13.397

您可以`<head></head>`在正文部分放置标签。

# objective-c - 抑制 UIViewController 子类的 Xcode 不兼容指针类型

> ID：11833326
> 
> 赞同：2
> 
> 时间：2012-08-06T17:50:00.593
> 
> 标签：objective-c, ios, xcode, uiviewcontroller

我有一个 UIViewController 的子类，称为 SurveyQuestion。我为我的应用程序使用了这些数组。我用这条线得到了当前可见的控制器：

```
SurveyQuestion *currentQuestionController = [self.navigationController visibleViewController]; 
```

一切正常，但 Xcode 给了我一个警告

```
Incompatible pointer types initializing 'SurveyQuestion *__strong' with an expression of type 'UIViewController *' 
```

我知道这是因为 visibleViewController 返回一个 UIViewController，但它之所以有效，是因为 SurveyQuestion 是一个 UIViewController。有没有办法抑制这个错误？还是我应该以不同的方式来做？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-08-06T17:52:10.920

你可以使用 cast like

```
SurveyQuestion *currentQuestionController = (SurveyQuestion *)[self.navigationController visibleViewController]; 
```

# c# - 根据 N 个值中的哪个值最小返回不同的结果

> ID：11833327
> 
> 赞同：4
> 
> 时间：2012-08-06T17:50:02.590
> 
> 标签：c#

不知道如何使标题更具描述性，所以我将从一个示例开始。我正在使用下面的代码位，它从枚举中选择一个方向，具体取决于与给定方向相比，四个轴中的哪个轴形成的角度最小。

```
static Direction VectorToDirection(Vector2 direction)
{
    double upDiff = System.Math.Acos(Vector2.Dot(direction, -Vector2.UnitY));
    double downDiff = System.Math.Acos(Vector2.Dot(direction, Vector2.UnitY));
    double leftDiff = System.Math.Acos(Vector2.Dot(direction, -Vector2.UnitX));
    double rightDiff = System.Math.Acos(Vector2.Dot(direction, Vector2.UnitX));

    double smallest = System.Math.Min(System.Math.Min(upDiff, downDiff), System.Math.Min(leftDiff, rightDiff));

    // This is the part I'm unsure about i.e.
    // Comparing smallest with each value in turn
    // To find out which of the four was "selected"
    if (smallest == upDiff) return Direction.Up;
    if (smallest == downDiff) return Direction.Down;
    if (smallest == leftDiff) return Direction.Left;
    return Direction.Right;
} 
```

但是我最后收到了关于浮点相等的 Resharper 警告。我猜这应该不是由于实现的问题，但想知道除了与每个原始值**进行比较之外**`Min`，是否还有更好的习惯用法来解决此类问题。 **`smallest`**

 *** * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T18:02:18.797

此代码应该为您提供所需的结果。

```
 if ((Math.Abs(direction.x) >= Math.Abs(direction.y))
      return direction.x >= 0 ? Direction.Right : Direction.Left;
    return direction.y >= 0 ? Direction.Up : Direction.Down; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T17:59:55.087

您可以制作一个对字典进行`<double ,Direction>` **[排序的字典](https://stackoverflow.com/questions/289/how-do-you-sort-a-c-sharp-dictionary-by-value)**，并使用正确的枚举获取最小值以返回。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-06T18:03:02.747

您*可以*定义一个包含差异和与之关联的值的类。然后，您从这些对象中收集并按差异对它们进行排序。之后返回与第一个元素关联的值。

但是，在您的情况下，我不会去那里，代码很清楚。如果可能值的数量更大（或事先不知道），那么我才会寻求更通用的解决方案。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-06T18:05:31.197

你能写一些if语句吗？

```
if  (upDiff < leftDiff && upDiff < downDiff && upDiff < rightDiff) return Direction.Up;
if  (leftDiff < upDiff && leftDiff < downDiff && leftDiff < rightDiff) return Direction.Left;
if  (rightDiff < leftDiff && rightDiff < upDiff && rightDiff < downDiff) return Direction.Right;
return Direction.Down; 
```

也许它可以进一步清理，但这似乎是直截了当的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-06T18:09:27.213

我会将所有选择放在一个数组中并找到最小索引。对于 4 个选择，排序可能是矫枉过正。如果此代码的性能很重要 - 请确保测量不同变体的时间。

未编译代码如下：

```
static Direction VectorToDirection(Vector2 direction)
{
  var directions = new Direction[]{
    Direction.Up, Direction.Down, Direction.Right, Direction.Left };
  var unit = new Vector2[] {
   -Vector2.UnitY, Vector2.UnitY, Vector2.UnitX,-Vector2.UnitY};

  var minAngle = 10;
  var minIndex = -1;
  for(var index = 0; index < directions.length; index++)
  {
    double diff = System.Math.Acos(Vector2.Dot(direction, unit[index]));
    if (diff < minAngle)
    { 
      minAngle = diff;
      minIndex = index;
    }

  return directions[minIndex];
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-08-06T18:09:45.093

```
static Direction VectorToDirection(Vector2 direction)
{
    var mappings = new[]
    {
        new { Direction = Direction.Up, Axis = -Vector2.UnitY },
        new { Direction = Direction.Down, Axis = Vector2.UnitY },
        new { Direction = Direction.Left, Axis = -Vector2.UnitX },
        new { Direction = Direction.Right, Axis = Vector2.UnitX }
    };
    return mappings.OrderBy(m => Math.Acos(Vector2.Dot(direction, m.Axis))).Select(m => m.Direction).First();
} 
```

林克方式。这未经测试，但你应该得到它。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-08-06T17:56:27.133

设置不准确

```
if ((Math.Abs(smallest - upDiff) < 0.00001) return Direction.Up; 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-08-06T18:01:06.457

有了你这样做，我认为不会有任何错误。但是，如果您将来最终重构或更改代码，您可能会遇到一些问题。

为了安全起见，请按照 resharper 的建议进行操作。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-08-06T18:03:04.510

我通常使用`switch`而不是`if-else`（至少 3 个子句）——有点简洁和快速。

```
switch(smallest) {
  case upDiff: return Direction.Up;
  case downDiff: return Direction.Down;
  case leftDiff: return Direction.Left;
  default: return Direction.Right; 
} 
```**

# sql - PhoneGap jquerymobile SQL 动态链接

> ID：11833329
> 
> 赞同：1
> 
> 时间：2012-08-06T17:50:13.757
> 
> 标签：sql, jquery-mobile, cordova, load, dynamic-pages

我正在 jquery-mobile 框架的帮助下构建一个 PhoneGap iOS 应用程序。我有一个主要的 jquery-mobile 自动划分列表，由 SQL 数据库填充。这个自动划分的列表按预期工作。单击此动态列表的一个链接时，应该会启动一个动态页面，其中包含同一 SQL 数据库中包含的一些额外详细信息。但是，当数据库不加载页面详细信息时。

我通过一些脚本更改成功地在 jquerymobile 框架之外完成了这项工作。但我真的需要来自 jquerymobile 的 autodividers 功能。

首先我假设这个动态页面在 DOM 之外，但是在 mobileinit() 中添加以下函数并不能解决我的 SQL 加载问题：

```
$( 'fooddetails.html?id' ).live( 'pagebeforecreate',function(event, ui){
                                     alert( 'This page was just inserted into the dom!' );
                                     }); 
```

下面是我的数据库的完整脚本和触发额外详细信息页面的动态 URL：

```
var db;
var dbCreated = false;
document.addEventListener("deviceready", onDeviceReady, false);

function onDeviceReady() {
    db = window.openDatabase("FoodDirectoryDB", "1.0", "PhoneGap", 200000);
    if (dbCreated)
        db.transaction(getAlimentaries, transaction_error);
    else
        db.transaction(populateDB, transaction_error, populateDB_success);
}

function transaction_error(tx, error) {
    $('#busy').hide();
    alert("Database Error: " + error);
}

function populateDB_success() {
    dbCreated = true;
    db.transaction(getAlimentaries, transaction_error);
}

function getAlimentaries(tx) {
    var sql = "select e.id, e.foodName, e.groupfoodName, e.quantity, e.picture, count(r.id) reportCount " + 
                "from food e left join food r on r.managerId = e.id " +
                "group by e.id order by e.foodName ";
    tx.executeSql(sql, [], getAlimentaries_success);
}

function getAlimentaries_success(tx, results) {
    $('#busy').hide();
    $('#foodList li').remove();
    var len = results.rows.length;
    for (var i=0; i<len; i++) {
        var food = results.rows.item(i);
        console.log(food.foodName);

        $('#foodList').append('<li><a href="fooddetails.html?id=' + food.id + '">' +
                '<img src="pics/' + food.picture + '" class="arrow-r"/>' +
                '<p class="line1">' + food.foodName + '</p>' +
                '</a></li>');

        $( 'employeedetails.html?id' ).live( 'pageshow',function(event, ui){
                                            alert( 'This page was just inserted into the dom!' );
                                            });

    }
    $('#foodList').listview('refresh');
    db = null;
}

function populateDB(tx) {
    $('#busy').show();
    tx.executeSql('DROP TABLE IF EXISTS food');
    var sql = 
        "CREATE TABLE IF NOT EXISTS food ( "+
        "id INTEGER PRIMARY KEY AUTOINCREMENT, " +
        "foodName VARCHAR(50), " +
        "groupfoodName VARCHAR(50), " +
        "quantity VARCHAR(50), " +
        "portion VARCHAR(50), " + 
        "managerId INTEGER, " +
        "glucides VARCHAR(30), " + 
        "picture VARCHAR(200))";
    tx.executeSql(sql);

    tx.executeSql("INSERT INTO food (id,foodName,groupfoodName,managerId,quantity,portion,glucides,picture) VALUES (1,'Abricot','Fruits frais et fruits secs',1,'1 abricot','65g','5','fruits_legumes.png')");
    tx.executeSql("INSERT INTO food (id,foodName,groupfoodName,managerId,quantity,portion,glucides,picture) VALUES (2,'Abricots secs','Fruits frais et fruits secs',1,'4 abricots secs','80g','30','fruits_legumes.png')"); 
```

我还尝试将 data-ajax="false" rel"external" 添加到此动态链接，但不幸的是这并没有改变，我读到动态链接中的这些属性未经授权：

```
$('#foodList').append('<li><a href="fooddetails.html?id=' + food.id + '">' + 
```

以下是未正确加载的详情动态页面的脚本：

```
 var id = getUrlVars()["id"];
var db;

document.addEventListener("deviceready", onDeviceReady, false);

function onDeviceReady() {
    console.log("opening database");
    db = window.openDatabase("FoodDirectoryDB", "1.0", "PhoneGap", 200000);
    console.log("database opened");
    db.transaction(getAlimentary, transaction_error);

}

function transaction_error(tx, error) {
    $('#busy').hide();
    alert("Database Error: " + error);
}

function getAlimentary(tx) {
    $('#busy').show();
    var sql = "select e.id, e.foodName, e.groupfoodName, e.managerId, e.quantity, e.portion, e.glucides, " +
                "e.picture, m.foodName managerFirstName, m.groupfoodName managerLastName, count(r.id) reportCount " +
                "from food e left join food r on r.managerId = e.id left join food m on e.managerId = m.id " +
                "where e.id=:id group by e.groupfoodName order by e.groupfoodName, e.foodName";
    tx.executeSql(sql, [id], getAlimentary_success);
}

function getAlimentary_success(tx, results) {
    $('#busy').hide();
     $('#foodList li').remove();
    var food = results.rows.item(0);
    $('#foodPic').attr('src', 'pics/' + food.picture);
    $('#foodName').text(food.foodName);
    $('#foodgroupName').text(food.groupfoodName);
    $('#foodQuantity').text(food.quantity);
    $('#foodPortion').text(food.portion);

    console.log(food.glucides);
        if (food.glucides) {
        $('#actionList').append('<li><a href="tel:' + food.glucides + '"><p class="line1">Teneur en Glucides</p>' +
                '<p class="line2">' + food.glucides + '</p><img src="img/food.png" class="action-icon"/></a></li>');
    }
    $('#foodList').listview('refresh');
    db = null;
}

function getUrlVars() {
    var vars = [], hash;
    var hashes = window.location.href.slice(window.location.href.indexOf('?') + 1).split('&');
    for(var i = 0; i < hashes.length; i++)
    {
        hash = hashes[i].split('=');
        vars.push(hash[0]);
        vars[hash[0]] = hash[1];
    }
    return vars;
} 
```

# c# - 解决 signalR 的会话

> ID：11833336
> 
> 赞同：5
> 
> 时间：2012-08-06T17:51:07.283
> 
> 标签：c#, asp.net, session, signalr

我一直在网上寻找并且一直在阅读您不能`HttpContext.Current.Cache`在 signalR 集线器类中使用，那么如果我希望能够让每个用户都拥有一些可以在我的集线器方法中访问的缓存数据，那么解决方法是什么。

编辑：

这些数据只需要在我的集线器类中使用，我不需要在我的 asp.net 应用程序的其他地方访问它。不过，它肯定需要特定于用户。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-06T18:32:07.760

如果您只是在寻找内置 ASP.NET 缓存的等效功能，那么您可以简单地启动[`System.Runtime.Caching.MemoryCache`](http://msdn.microsoft.com/en-us/library/system.runtime.caching.memorycache.aspx)类的静态实例。然后只需在各种集线器方法中访问静态实例。

请记住，这是一个单一的服务器内存解决方案。对于更高级的、进程外的分布式缓存解决方案，我会使用 AppFabric（Azure 或本地）或 Memcached。

# ajax - 使用不同的 HTTP 方法时是否有任何性能差异？

> ID：11833337
> 
> 赞同：8
> 
> 时间：2012-08-06T17:51:11.030
> 
> 标签：ajax, jquery, http-method

我知道 HTTP 方法的工作原理以及它们的设计目的，但我很想知道某些方法在仅用于获取数据时是否比其他方法更快。
在我正在工作的团队中，我注意到很多 JQuery ajax 请求，如下所示：

```
$.ajax({url: "../dir/someFile.json", method: 'post', dataType: 'json',
    error: function(...){ ... },
    success: function(...){ ... }       
}); 
```

我显然会使用“get”方法，因为没有数据发送到这个请求。这可能发生在队友复制和粘贴代码时。这也很好用，**似乎**没有充分的理由将其更改为“获取”。

我认为在这种情况下使用'get'方法会更快，但我没有找到任何确认这一点的消息来源。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T18:31:44.380

有一些研究表明，一些浏览器会将一个 POST 请求分成多个数据包。这可能会对性能产生影响，您认为这会使请求变慢。但是，在测试中，POST 似乎有时会更快。我不确定这是为什么。

然而，在实践中，性能差异可以忽略不计，您应该按预期使用 POST 和 GET。

读：

*   [http://loadimpact.com/blog/ajax-get-or-post-which-is-best](http://loadimpact.com/blog/ajax-get-or-post-which-is-best)
*   [http://developer.yahoo.com/performance/rules.html#ajax_get](http://developer.yahoo.com/performance/rules.html#ajax_get)
*   [http://thinkvitamin.com/code/the-definitive-guide-to-get-vs-post/](http://thinkvitamin.com/code/the-definitive-guide-to-get-vs-post/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-06T18:25:04.007

至少在 IE 的历史版本中，存在 POST 传输额外数据包的问题。在这里对此进行一些讨论：

[http://josephscott.org/archives/2009/08/xmlhttprequest-xhr-uses-multiple-packets-for-http-post/](http://josephscott.org/archives/2009/08/xmlhttprequest-xhr-uses-multiple-packets-for-http-post/)

不过，我不知道这与当前的浏览器有多大关系。

以下是文章中描述的测试结果：

*   IE 6 – 2 个数据包
*   IE 7 – 2 个数据包
*   IE 8 – 2 个数据包
*   Firefox 3.0.13 – 1 个数据包
*   Firefox 3.5.2 – 1 个数据包
*   Opera 9.27 – 2 个数据包
*   Safari 4.0.3 – 2 个数据包
*   Chrome 2.0.172.43 – 2 个数据包

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-08-04T19:32:04.683

这似乎很明显，但是当使用 POST 与 GET 时，您在方法名称中使用了一个字节。

此外，如果您有（很少）数据要发送，使用 GET 将对数据进行 URL 编码（这意味着生成和发送的字节数将高于数据本身的大小），而 POST 将消耗更多字节（通常) 因为请求将另外包含一个`Content-Type: application/x-www-form-urlencoded`标头，可能是一个`Content-Length`标头加上与 GET*相同*的URL 编码数据。

如果你有一些二进制数据要发送，这个问题就不成立了，因为你不能用 GET 来做。

我们在这里谈论便士，但是如果您积累便士...

最后，GET 请求会更短，并且对于相同的网络链路带宽，它会比 POST 更快。

要发送二进制数据，PUT 将比 POST 更快（基于相同的逻辑，并且因为 POST 将使用`multipart/form-data`编码标头），但浏览器对 PUT 请求的支持更有限。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-06T18:24:34.287

在所有条件相同的情况下，GET、POST 或任何其他方法之间的网络性能没有差异。这完全取决于服务器如何处理 GET 与 POST 请求。例如，服务器可能会尝试在 POST 上更新资源，但仅在 GET 上搜索它。

此外，使用 GET，您可以发送数据。在 jQuery 中，它只是被序列化为查询字符串（`$.get("someplace", data: { foo: "bar" })`作为 发送`$.get("someplace?foo=bar")`）。

# android - Android 设备/屏幕支持

> ID：11833340
> 
> 赞同：-1
> 
> 时间：2012-08-06T17:51:19.420
> 
> 标签：android, android-resolution

众所周知，来自 LG、三星和 HTC 的最新设备有各种不同的屏幕尺寸。

当我在galaxy sII 上尝试我的应用程序时，旧的nexus one 并且它们看起来很好，直到我在galaxy 选项卡上尝试它并且所有布局都被拉伸了。我只有一套布局；和图形用于 ldpi/mdpi/hdpi 但不是 xhdpi

我想知道如何禁用对 Tab、Flyer 等平板设备的支持或安装，但支持 Galaxy note 和其他 4+" 设备？

提前谢谢你，因为我对屏幕尺寸和密度很困惑

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T17:55:04.973

您是否尝试过为选项卡设置布局？使用布局-xlarge？还是 layout-xlarge-land 文件夹？但如果您不想支持大屏幕（标签），您应该查看清单中的“support-screen”标签：

```
<supports-screens android:resizeable=["true"| "false"]
                  android:smallScreens=["true" | "false"]
                  android:normalScreens=["true" | "false"]
                  android:largeScreens=["true" | "false"]
                  android:xlargeScreens=["true" | "false"]
                  android:anyDensity=["true" | "false"]
                  android:requiresSmallestWidthDp="integer"
                  android:compatibleWidthLimitDp="integer"
                  android:largestWidthLimitDp="integer"/> 
```

你只需要设置这个：

```
android:xlargeScreens=["false"] 
```

它不会在标签上运行。

# android - WifiManager 将 SSID 设置为 Disabled 而不是 Connecting

> ID：11833341
> 
> 赞同：2
> 
> 时间：2012-08-06T17:51:22.480
> 
> 标签：android, android-wifi

我有一些代码应该通过意图中的额外传递的 SSID 并连接到它，**目前它只是将我传递给它的那些设置为 disabled**。所有试图通过的 SSID 之前都已连接。我不确定它的原因是否已经存在具有 SSID 的网络配置，但它可能与它有关...

```
package com.wt.checkin;

import android.content.BroadcastReceiver;
import android.content.Context;
import android.content.Intent;
import android.net.wifi.WifiConfiguration;
import android.net.wifi.WifiManager;
import android.os.Bundle;
import android.util.Log;

public class WifiSwitcher extends BroadcastReceiver {

    @SuppressWarnings("static-access")
    @Override
    public void onReceive(Context arg0, Intent arg1) {
        Bundle extras = arg1.getExtras();
        WifiManager wifiMan = (WifiManager) arg0
                .getSystemService(Context.WIFI_SERVICE);
        if (wifiMan.getWifiState() == 1) {
            wifiMan.setWifiEnabled(true);
            try {
                Thread.currentThread().sleep(2500);
            } catch (InterruptedException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
        }
        WifiConfiguration tmpConfig = new WifiConfiguration();
        tmpConfig.SSID = extras.getString("SSID");
        tmpConfig.status = WifiConfiguration.Status.ENABLED;
        int netId = wifiMan.addNetwork(tmpConfig);
        wifiMan.enableNetwork(netId, true);

    }

} 
```

![已禁用](../Images/be42ca05c8b07d92f4921454e01e6d5a.png) **这是工作代码：**

```
package com.wt.checkin;

import java.util.List;

import android.content.BroadcastReceiver;
import android.content.Context;
import android.content.Intent;
import android.net.wifi.WifiConfiguration;
import android.net.wifi.WifiInfo;
import android.net.wifi.WifiManager;
import android.os.Bundle;
import android.util.Log;

public class WifiSwitcher extends BroadcastReceiver {

    @SuppressWarnings("static-access")
    @Override
    public void onReceive(Context arg0, Intent arg1) {
        Bundle extras = arg1.getExtras();
        WifiManager wifiMan = (WifiManager) arg0
                .getSystemService(Context.WIFI_SERVICE);
        if (wifiMan.getWifiState() == 1) {
            wifiMan.setWifiEnabled(true);
            try {
                Thread.currentThread().sleep(2500);
            } catch (InterruptedException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
        }**
        WifiConfiguration Config = new WifiConfiguration();
        WifiInfo Info = wifiMan.getConnectionInfo();
        String SSID = extras.getString("SSID");
        Config.SSID = "\"" + SSID+"\"";
        wifiMan.addNetwork(Config);
        List<WifiConfiguration> list = wifiMan.getConfiguredNetworks();
        for( WifiConfiguration i : list ) {
            if(i.SSID != null && i.SSID.equals("\"" + SSID + "\"")) {
                 wifiMan.disconnect();
                 wifiMan.enableNetwork(i.networkId, true);
                 wifiMan.reconnect();                

                 break;
            }           
         }

    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T19:14:36.780

对于遇到类似问题的其他人，我想发布这个相关问题：[如何以编程方式连接到 Android 中的特定 Wi-Fi 网络？](https://stackoverflow.com/questions/8818290/how-to-connect-to-a-specific-wifi-network-in-android-programmatically)

OP 看起来正在做一些非常相似的事情，我注意到一个不同之处：

```
List<WifiConfiguration> list = wifiManager.getConfiguredNetworks();
for( WifiConfiguration i : list ) {
    if(i.SSID != null && i.SSID.equals("\"" + networkSSID + "\"")) {
         wm.disconnect(); //not in OP
         wm.enableNetwork(i.networkId, true);
         wm.reconnect(); //not in OP   

         break;
    }           
} 
```

我标记了我认为应该添加的行。看起来您还必须以非常具体的方式格式化 SSID，这在其他 SO 线程中进行了概述。

# mysql - RoR 使用 2 个不同的数据库和活动记录适配器？相同的表名

> ID：11833346
> 
> 赞同：4
> 
> 时间：2012-08-06T17:51:39.607
> 
> 标签：mysql, ruby-on-rails, database, salesforce, databasedotcom-gem

目前我正在开发一个 Rails 项目，将 salesforce.com 的数据库与我们的 SQL 服务器连接起来。Atm 我们对 sql 部分使用 gems 'mysql2'，对 salesforce 部分使用 'databasedotcom' + 'databasedotcom-rails'。

我们的问题是，我们在两个数据库中的表具有相同的名称。所以这两个适配器都试图将它们封装到 activerecord 类中，正如您所猜测的那样，这是一个大问题。不幸的是，我们在互联网上没有找到解决方案。那么如何防止命名空间冲突呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T18:32:08.997

我可能不理解这个问题，但我认为以下内容对您有用。

```
class Account < ActiveRecord::Base
  # table name is 'accounts' in mysql db
end

class SalesForceAccount < ActiveRecord::Base
  establish_connection "#{Rails.env}_salesforce"
  table_name = :accounts
end 
```

与`database.yml`一个

```
development:
  # your mysql credentials and adapter info
development_salesforce:
  # your salesforce credentials and adapter info 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T11:31:38.487

为了解决命名空间冲突的问题，我们将mysql的模块放在他自己的命名空间中。databasedotcom gem 在运行时创建模型，因此您只需为您的 mysql 数据库创建模型。

```
create modeles for sql
create folder named after your wished prefix in models folder (for us: Mad)
put your models in the namespacee-folder (for us: Mad)
wrap the model classes in module <namespace> 
```

像 account.rb：

```
module Mad
    class Account < ActiveRecord::Base
        attr_accessible :name, :website, :phone
    end
end 
```

现在您可以通过 Account 和 Mad::Account 的 mysql 访问 salesforce 的帐户

# ruby-on-rails - 如何在字段中保留搜索词

> ID：11833347
> 
> 赞同：5
> 
> 时间：2012-08-06T17:51:39.317
> 
> 标签：ruby-on-rails

我在 Rails 上使用 ruby​​ 并有一个搜索表单，例如：

```
 <%= form_tag '/findBlood' do %>
        Blood Group   <%= text_field_tag "bloodGroup" %>
        <%= submit_tag "Search", class: "btn btn-large btn-primary"%>
    <% end %> 
```

但是，这可以按预期工作，但在提交 bloodGroup 字段时会清除，因此可能会出现分页中断。如何保留这个字段？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T20:36:17.223

这应该为您解决问题

```
<%= text_field_tag 'bloodGroup', params[:bloodGroup] %> 
```

请参阅[text_field_tag的文档](http://apidock.com/rails/ActionView/Helpers/FormTagHelper/text_field_tag)

* * *

符号起作用而字符串（其他答案）不起作用的原因：

```
foo = {hello: 'world'}
puts foo[:hello];        # => 'world'
puts foo['hello']        # => nil
puts foo['hello'.to_sym] # => 'world' 
```

您可以在 Ruby 中轻松地在字符串和符号之间进行转换，但它们并不相等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T18:14:21.380

试试这个

```
<%= text_field_tag "bloodGroup", params["bloodGroup"] %> 
```

# performance - 非常慢的matlab夹克if语句

> ID：11833349
> 
> 赞同：0
> 
> 时间：2012-08-06T17:51:45.770
> 
> 标签：performance, matlab, if-statement, cuda, jacket

我在 matlab 中使用 cuda\jacket 遇到了一个非常缓慢的 if 语句响应。（对于找到局部最大值的相同代码，使用简单的 for 循环和 if 条件，5 秒对 0.02 秒）

作为 GPU 编程的新手，我去阅读，当我看到以前的[matlab if 语句与 CUDA](https://stackoverflow.com/questions/9054949/matlab-if-statements-with-cuda) SO 讨论时，我觉得缺少了一些东西。您无需使用 cuda 即可知道对代码进行矢量化会更好。但是，在某些情况下，无论如何您都需要使用 if 语句。例如，我想找出 2D 图像的像素（比如 m(a,b)）是否是其 8 个最近邻居的局部最大值。在 matlab 中，一种简单的方法是在 if 语句上使用 8 个逻辑条件：

如果 m(a,b)>m(a-1,b-1) & m(a,b)>(a,b-1) & m(a,b)>(a+1,b-1) & ... 等所有最近的邻居

如果您知道如何解决（或矢量化）这个问题，我将不胜感激......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T20:03:19.253

使用多个“if”语句（或任何其他条件语句）的问题在于，对于每个语句，结果都会从 gpu 复制到主机，这可能会很昂贵。

最简单的方法是按以下方式进行矢量化。

```
window = m(a-1:a+1, b-1:b+1);
if all(window(:) <= m(a,b))
% do something
end 
```

如果您可以显示 if / else 条件正在做什么，则可以进一步优化。即请发布 if/else 代码以查看是否有其他优化可用（即查看完全删除 if 条件的可能方法）。

**编辑**

有了新的信息，这里是可以做的。

```
for j = 1:length(y)
 a = x(j);
 b = y(j);
 window = d(a-1:a+1, b-1:b+1);
 condition = all(window(:) <= d(a,b));
 M(a, b) = condition + ~condition * M(a,b);
end 
```

您可以使用 gfor 循环使其更快。

```
gfor j = 1:length(y)
 a = x(j);
 b = y(j);
 window = d(a-1:a+1, b-1:b+1);
 condition = all(window(:) <= d(a,b));
 M(a, b) = condition + ~condition * M(a,b);
gend 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T18:11:48.807

**使用内置函数**

最简单的已经优化的方法可能是使用该`imregionalmax`功能，

```
maxinI = imregionalmax(I, CONN); 
```

`CONN`所需的连接性在哪里（在您的情况下为 8）。

但是请注意，这`imregionalmax`是图像处理工具箱的一部分。

**使用`max`功能**

如果你想看看是否只有一个像素是它的邻居的局部最大值，你可能会做类似的事情

```
if  m(a,b) == max(max(m( (a-1) : (a+1), (b-1) : (b+1)))) 
```

`max`或者，在某些情况下，重塑可能比采取两个更快，

```
if  m(a,b) == max(reshape (m( (a-1) : (a+1), (b-1) : (b+1)), 9,1)  ) 
```

**没有这个`max`功能**

最后，如果您想`max`完全避免使用比目前更矢量化的形式也可以实现的功能，即

```
if  all(reshape( m(a,b) >= m( (a-1) : (a+1), (b-1) : (b+1)), 9,1)) 
```

# jquery - is it possible to hover to tab and on click the div slides

> ID：11833350
> 
> 赞同：0
> 
> 时间：2012-08-06T17:51:55.883
> 
> 标签：jquery

Wanted the tab arrow to slide on hover but not move the content un till the tab is clicked, is this possible? please see jsfiddle for example

fiddle: [http://jsfiddle.net/cC4tU/1/](http://jsfiddle.net/cC4tU/1/)

Jquery

```
jQuery.extend(jQuery.easing, {
     easeInOutQuad: function (x, t, b, c, d) {
        if ((t/=d/2) < 1) return c/2*t*t + b;
        return -c/2 * ((--t)*(t-2) - 1) + b;
    }
});

//EXPAND PAGE DIV CONTENT
var TabbedContent = {
    init: function() {  
        $(".tab_item").mouseover(function() {

            var background = $(this).parent().find(".moving_bg");

            $(background).stop().animate({
                left: $(this).position()['left']
            }, {
                duration: 500 
            });

            TabbedContent.slideContent($(this));

        });
    },

    slideContent: function(obj) {

        var margin = $(obj).parent().parent().find(".slide_content").width();
        margin = margin * ($(obj).prevAll().size() - 1);
        margin = margin * -1;

        $(obj).parent().parent().find(".tabslider").stop().animate({
            marginLeft: margin + "px"
        }, {
            duration: 800
        });
    }
}

TabbedContent.init(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T17:59:08.093

Here's are your animations with easing added. The first animation:

```
$(background).stop().animate({
    left: $(this).position()['left']
}, {
    duration: 500 
    easing: 'swing' // the type of easing
}); 
```

And the second animation:

```
$(obj).parent().parent().find(".tabslider").stop().animate({
    marginLeft: margin + "px"
}, {
    duration: 800,
    easing: 'swing' // the type of easing
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T18:02:47.427

the tab arrow to slide on hover add

```
 $(".tab_item").hover(function(){
         var background = $(this).parent().find(".moving_bg");

        $(background).stop().animate({
            left: $(this).position()['left']
        }, {
            duration: 500
        });
    }); 
```

and change this line

```
 $(".tab_item").mouseover(function() { 
```

to this

```
 $(".tab_item").click(function() { 
```

# php - 对自定义 RecursiveIteratorIterator 中的“（子类）实例未正确初始化”进行故障排除

> ID：11833360
> 
> 赞同：2
> 
> 时间：2012-08-06T17:52:30.250
> 
> 标签：php, iterator, doctrine-1.2, spl

我创建了一个扩展的自定义迭代器，`RecursiveIteratorIterator`我用它来迭代`Doctrine_Collection`使用该`NestedSet`行为的表中的 a （例如，以便我将自定义排序应用于层次结构中每个级别的记录）。

我的项目中有几个模型利用了这个迭代器，所以我创建了一个如下所示的基类：

```
/** Base functionality for iterators designed to iterate over nested set
 *    structures.
 */
abstract class BaseHierarchyIterator
  extends RecursiveIteratorIterator
{
  /** Returns the component name that the iterator is designed to work with.
   *
   * @return string
   */
  abstract public function getComponentName(  );

  /** Inits the class instance.
   *
   * @param $objects  Doctrine_Collection Assumed to already be sorted by `lft`.
   *
   * @throws LogicException If $objects is a collection from the wrong table.
   */
  public function __construct( Doctrine_Collection $objects )
  {
    /** @kludge Initialization will fail horribly if we invoke a subclass method
     *    before we have initialized the inner iterator.
     */
    parent::__construct(new RecursiveArrayIterator(array()));

    /* Make sure we have the correct collection type. */
    $component = $this->getComponentName();
    if( $objects->getTable()->getComponentName() != $component )
    {
      throw new LogicException(sprintf(
        '%s can only iterate over %s collections.'
          , get_class($this)
          , $component
      ));
    }

    /* Build the array for the inner iterator. */
    $top = array();
    /** @var $object Doctrine_Record|Doctrine_Node_NestedSet */
    foreach( $objects as $object )
    {
      // ... magic happens here ...
    }

    parent::__construct(
        new RecursiveArrayIterator($top)
      , RecursiveIteratorIterator::SELF_FIRST
    );
  }

  ...
} 
```

子类可能看起来像这样：

```
/** Iterates hierarchically through a collection of User objects.
 */
class UserHierarchyIterator
  extends BaseHierarchyIterator
{
  /** Returns the component name that the iterator is designed to work with.
   *
   * @return string
   */
  public function getComponentName()
  {
    return UserTable::getInstance()->getComponentName();
  }

  ...
} 
```

请注意`@kludge`基类中构造函数顶部的 ：

```
/** @kludge Initialization will fail horribly if we invoke a subclass method
 *    before we have initialized the inner iterator.
 */
parent::__construct(new RecursiveArrayIterator(array())); 
```

只要我将额外的初始化行保留在基类构造函数的顶部，一切都会按预期工作。

但是，如果我删除/注释该行，一旦脚本执行到达，我就会收到以下错误`$component = $this->getComponentName()`：

> 致命错误：BaseHierarchyIterator::__construct(): UserHierarchyIterator 实例未在第 21 行的 /path/to/BaseHierarchyIterator.class.php 中正确初始化。

或者，如果我删除调用的代码`$this->getComponentName()`（以及随后的条件块），构造函数仍按预期运行（减去确保组件名称正确的检查）。

这个错误的根本原因是什么？这个问题有更好的解决方法吗？

PHP版本信息：

```
PHP 5.3.3 (cli)（构建：2012 年 7 月 3 日 16:40:30）
版权所有 (c) 1997-2010 PHP 集团
Zend Engine v2.3.0，版权所有 (c) 1998-2010 Zend Technologies
    与 Suhosin v0.9.29，版权所有 (c) 2007，SektionEins GmbH

```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-12T13:29:17.860

> 致命错误：BaseHierarchyIterator::__construct(): UserHierarchyIterator 实例未在第 21 行的 /path/to/BaseHierarchyIterator.class.php 中正确初始化。

## *这个错误的根本原因是什么？*

您的课程从`RecursiveIteratorIterator`. 要使这种类型的对象或其子类型正常工作，PHP 需要在调用任何其他方法或访问它的属性之前对其进行正确初始化。这里正确的意思是它的父构造函数已经被调用，然后初始化完成。

但是您在初始化之前调用了一个方法（`RecursiveIteratorIterator::__construct()`尚未调用）。您的方法调用是：

```
$this->getComponentName(); 
```

到目前为止，您也已经意识到这一点。如果您在该调用之前进行初始化，则不会出现此致命错误。在您的情况下，初始化是：

```
parent::__construct(new RecursiveArrayIterator(array())); 
```

PHP 的严格检查保留 PHP 执行一些特殊类型的递归迭代器，这些迭代器可以更好地委托给底层数据结构。递归遍历也稍微复杂一些，需要初始化堆栈等，这些都被 PHP 隐藏了。因此，出于安全原因也进行了检查。

如果将其与*IteratorIterator*进行比较，您会发现不存在这样的致命错误。

## *这个问题有更好的解决方法吗？*

我不会称之为工作区。您实际上实现了类似的类似 [`IteratorAggregate`](http://php.net/IteratorAggregate)功能。但是你一次做的太多了，看看你的构造函数，*它做的太多了*。这是一个[缺陷：构造函数做真正的工作](http://misko.hevery.com/code-reviewers-guide/flaw-constructor-does-real-work/)。

因此，这需要更清晰地分离关注点，实际上对迭代器有更基本的理解也会有所帮助。

解决方案相当简单：您在这里唯一需要做的就是将数据处理逻辑从构造函数移动到以下实现`IteratorAggregate`：

```
abstract class BaseHierarchyIterator implements IteratorAggregate
{
    private $objects;

    abstract public function getComponentName();

    public function __construct(Doctrine_Collection $objects) {
        $this->setObjects($objects);
    }

    public function getIterator() {

        /* Build the array for the inner iterator. */
        $top = array();
        /** @var $object Doctrine_Record|Doctrine_Node_NestedSet */
        foreach ($this->objects as $object) {
            // ... magic happens here ...
        }

        return new RecursiveArrayIterator($top);
    }

    private function setObjects($objects) {

        /* Make sure we have the correct collection type. */
        $component = $this->getComponentName();

        if ($objects->getTable()->getComponentName() != $component) {
            throw new LogicException(sprintf(
                '%s can only iterate over %s collections.'
                , get_class($this)
                , $component
            ));
        }

        $this->objects = $objects;
    }
} 
```

然后，您可以立即进行递归迭代：

```
$users = new UserHierarchyIterator($objects);
$it    = new RecursiveIteratorIterator(
                 $users, RecursiveIteratorIterator::SELF_FIRST
             ); 
```

如您所见，解决具体问题唯一需要做的就是将关注点分开一点。无论如何，这将对您有所帮助，因此您在第一次运行时应该没问题：

```
[Iterator]  ---- performs traversal --->  [Container] 
```

容器有一个迭代器现在可以工作的接口。顺便说一句，这正是迭代器对象。你实际上用错了。`IteratorAggregate`如果您*遵循*该路径并且与. 现在，您在创建迭代器对象*之前迭代了学说集合。*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T19:27:40.763

[http://www.php.net/manual/en/oop4.constructor.php](http://www.php.net/manual/en/oop4.constructor.php)

> PHP 不会从派生类的构造函数中自动调用基类的构造函数。您有责任在适当的情况下将调用传播到上游的构造函数。

也就是说，扩展类时必须显式调用构造函数，否则PHP不知道如何初始化基类。

PHP 可以尝试使用 NULL 参数调用基类构造函数，但这几乎肯定是错误的并且会导致意想不到的结果（在这种情况下 - 你可能会得到一堆 'param X expected an array, NULL given' 错误如果 PHP 决定尝试将 NULL 传递给基本构造函数而不是抛出错误）

# java - 我在使用嵌套的“if”语句时遇到问题

> ID：11833363
> 
> 赞同：0
> 
> 时间：2012-08-06T17:52:46.147
> 
> 标签：java, if-statement

我正在解析一个可能包含日期的文件。如果日期在那里，它的格式是两位数或四位数的年份，但总是带有斜线（例如，MM/DD/YY 或 MM/DD/YYYY）。

```
public class T2 {
    public static void main(String args[]) {
        inputLine = "foo foo foo foo foo 10/26/2013 bar bar bar bar bar";

        if(inputLine.indexOf("/")>0) {                       // if date exists
            taskDateSOF = (inputLine.indexOf("/")-2);        // then start of field is first instance of / minus two
            if (inputLine.lastIndexOf.isNumeric("/")+3); {         //    and if there's a number in the third position after the last /
                taskDateEOF = (inputLine.lastIndexOf("/") + 4);     //    the the end of date field is last instance of / +4
            else                                                  // <<< this "else" give an "else without if compiler error 
                taskDateEOF = (inputLine.lastIndexOf(("/" + 2)));      // else it's the last instance of / +2
                taskDate = inputLine.trim().substring(taskDateSOF,taskDateEOF).trim(); }  //
            }
        else                                            
             taskDate = "00/00/0000";
        }
            System.out.println(taskDate+" "+inputLine);
    }
} 
```

经过一番挣扎后，我意识到我以前从未嵌套过这样的 if 语句，而且我在破译错误时遇到了麻烦。第`else`9 行（第一个）`else without if`在编译期间给了我一个错误。我怀疑我在某个地方放错了花括号，尽管根据我引用的示例代码和教程，它似乎没问题。我无法发现问题，而且我的“试一试，看看会发生什么”的实验都没有成功。有人可以指出我没有看到的东西吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-06T17:57:12.420

这不会编译开始：

```
if (inputLine.lastIndexOf.isNumeric("/")+3); 
```

这在各种方面都是错误的——*我*什至不清楚你的意思。`lastIndexOf`是一个方法调用——你为什么把它当作一个字段来使用？您要添加 3 到什么？您希望条件何时评估为真？

那么你的 if/else 语法是错误的。您通常应该使用：

```
if (condition) {
    // Code
} else {
    // Code
} 
```

相反，你有：

```
if (condition); {
   // Code
else
   // Code
} 
```

注意你有多余的分号*和*糟糕的支撑。重点是要明确：

*   一个条件
*   条件为真时执行的代码块
*   否则要执行的代码块

*`{ }`除非它是单个语句，否则*每个*块都需要在其中。*

 *虽然在某些情况下您*可以*不使用牙套，但通常最好*始终*使用它们。这样，当您将单语句体更改为多语句体时，出错的空间就更小了。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-06T17:55:02.623

在 if 语句的条件之后有一个分号，它有效地终止了 if 语句的主体。

```
if (inputLine.lastIndexOf.isNumeric("/")+3)/*;*/ 
```

此外，inputLine 是什么类型的对象？它似乎没有用类型声明。我假设字符串，在这种情况下没有名为“lastIndexOf”的字段。

if-without-else 是您的代码存在的几个问题之一。我建议查看其他代码示例来学习 Java 语法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-06T18:22:13.743

正如@theglauber 所说，使用正则表达式解析这种输入看起来要容易得多。

```
String inputLine = "foo foo foo foo foo 10/26/2013 bar bar bar bar bar";
Pattern p = Pattern.compile(".*(\\d{2}\\/\\d{2}\\/\\d{4}).*");
Matcher m = p.matcher(inputLine);
if (m.matches()) {
    String taskDate = m.group(1);
    System.out.println(taskDate + " " + inputLine);
} 
```

此外，这个[if-then if-then-else](http://docs.oracle.com/javase/tutorial/java/nutsandbolts/if.html) Java 教程可能会对您有所帮助。如果您使用正则表达式，请阅读[此](http://docs.oracle.com/javase/tutorial/essential/regex/)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-06T18:37:26.350

好。除了额外的分号之外，您的代码中缺少花括号，您有这个：

```
if (inputLine.lastIndexOf.isNumeric("/")+3); {         //    and if there's a number in the third position after the last /
    taskDateEOF = (inputLine.lastIndexOf("/") + 4);     //    the the end of date field is last instance of / +4
else                                                  // <<< this "else" give an "else without if compiler error 
    taskDateEOF = (inputLine.lastIndexOf(("/" + 2)));      // else it's the last instance of / +2
    taskDate = inputLine.trim().substring(taskDateSOF,taskDateEOF).trim(); }  //
} 
```

当你应该有这个时：

```
if (inputLine.lastIndexOf.isNumeric("/")+3) {         //    and if there's a number in the third position after the last /
    taskDateEOF = (inputLine.lastIndexOf("/") + 4);     //    the the end of date field is last instance of / +4
} else {                                                  // <<< this "else" give an "else without if compiler error 
    taskDateEOF = (inputLine.lastIndexOf(("/" + 2)));      // else it's the last instance of / +2
    taskDate = inputLine.trim().substring(taskDateSOF,taskDateEOF).trim();  //
} 
```

了解您是否有未闭合的花括号或括号的一种方法是使用文本编辑器（如 Notepad++）或 IDE（如 Netbeans）来突出显示打开的花括号结束的位置。但老实说，您似乎缺乏对 Java 编程的基本了解，因此我建议您阅读有关该语言的书籍（例如 Deitel 的如何编程或类似书籍）以了解它的基础知识。*

# orm - ORM：通过可达性授权

> ID：11833364
> 
> 赞同：3
> 
> 时间：2012-08-06T17:52:46.547
> 
> 标签：orm, authorization

我们正在构建一个使用数据库的 web 应用程序。我们还使用对象关系映射器来访问数据库。Web 应用程序中授权的一个方面是*用户*可以访问由 URL 引用的对象。URL 包含数据库中特定记录的唯一 ID（例如主键）。考虑以下示例。

*   一个*用户*可能属于许多*组*，一个*组*可能有许多*用户*（多对多）。
*   *调查*属于一个组*（*多对一）。
*   一项*调查*可能有多个*问题*。（多对一）。

假设我们有以下 URL：[http://app.local/question/edit/10](http://app.local/question/edit/10)。这意味着我们要使用 PK 10 编辑*问题*。现在，我们要验证登录*用户*是否可以使用 PK 10 访问*问题*。这可以通过检索此*问题*来完成，然后是*调查*，然后是*组*，然后是所有*用户*。如果任何*用户与登录**用户*相同，则登录用户*可以*访问该*问题*。

 **概括一下；我们想检查一条记录是否可以通过已知的多对一或多对多关系从另一条记录*到达。*因此，如果存在多对一关系（例如*调查*和*问题*，那么我们应该检查是否可以通过*调查*然后通过*组从**问题*中访问*用户*。*组*具有多对多关系与*用户*，所以我们应该检查是否有任何（不是全部）*用户*与登录*用户*相同。

 ***如果一个表有多个多对一关系，比如说；我们可以将 CSS*模板*附加到*调查*中，并且该*模板*也属于一个*组*，然后我们必须检查是否可以从所有多对一关系（因此是*组*和*模板*）中访问*用户。*当然，这同样适用于多个多对多关系。

 **是否有支持这种行为的对象关系映射器？这种行为叫什么，也许是可达性？Propel (for PHP) 是否支持这种行为？我认为这种可达性可以通过以下两种方式中的任何一种来完成：

*   执行查询以获取每个“父级”，使用许多查询）
*   在一个查询中加入所有必要的表以查看是否存在记录（可访问的用户与登录的用户匹配）。

此外，ORM 的这种行为应该支持嵌套集，因此如果一个*组*包含嵌套集行为，它也应该尝试通过该*组*的父级访问用户。

我认为这种行为不应仅限于授权；对象应该只是能够查看它们是否可以到达另一个对象。

请注意，我并不是指可访问性的持久性：http: [//jpaobjects.sourceforge.net/m2-site/main/documentation/docbkx/html/user-guide/ch08s03.html](http://jpaobjects.sourceforge.net/m2-site/main/documentation/docbkx/html/user-guide/ch08s03.html)。

或者......我只是在看这个授权错误吗？ORM 是否有更好和不同的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T20:03:25.163

我过去使用 Ruby on Rails 中的嵌套资源（使用 Active Record ORM）处理过这个问题。而不是[http://app.local/question/10/edit](http://app.local/question/10/edit)，URI 将是[http://app.local/survey/5/questions/10/edit](http://app.local/survey/5/questions/10/edit)

在控制器中，您加载问题和调查。您通过将调查与经过身份验证的用户的组成员身份进行比较来检查授权。一种设计方法是将此逻辑嵌入到 User 类中。例如，在控制器中，您拥有`question`and `survey`（ORM 很好地理解了两者之间的关系，即`question.survey`）。然后，您可以将访问权限检查为`user.hasAccess?(question)`，这将是一种相对容易编写的方法。伪代码：

```
class User < ActiveRecord::Base

  def hasAccess?(question)
    return question.group.users.include?(self) 
```

是的，这将导致在后台执行多个查询，但 ORM 可以完成这项工作。我这样做是因为您留下了可靠的架构和易于阅读的代码。在您真正遇到性能问题之前不要进行优化。*******

# html - 延伸整个页面的垂直导航

> ID：11833369
> 
> 赞同：0
> 
> 时间：2012-08-06T17:53:28.687
> 
> 标签：html, css, navigation, frontend

我需要一个可以拉伸整个屏幕的垂直导航。我怎样才能做到这一点？

通常，我会设置导航：

```
position: absolute;
height: 100%;
overflow-y: hidden; 
```

但由于某种原因，我无法让它为我工作。无论如何，它都会显示一个滚动条，并且不会拉伸整个页面——仅拉伸一个视口的高度。您可以在此处查看一个工作示例：

[http://solstaging.net/vhosts/dealer-world-delivery/](http://solstaging.net/vhosts/dealer-world-delivery/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T17:58:53.180

添加`position: relative`到您的身体标签，#primary 将是全高。

# asp.net - 为什么我在重定向 URL 后收到“HTTP Error 403.14 - Forbidden”错误？

> ID：11833370
> 
> 赞同：3
> 
> 时间：2012-08-06T17:53:39.187
> 
> 标签：asp.net, iis-7, url-routing, url-redirection

![在此处输入图像描述](../Images/9b3927893b201f597b8f353d2e86af40.png)

这是我的解决方案结构。
当用户点击这个**[http://localhost/RouteUrl/](http://localhost/RouteUrl/)** URL 时，我想将他们重定向到**[http://localhost/RouteUrl/UI/MainForm.aspx](http://localhost/RouteUrl/UI/MainForm.aspx)**。

在 system.web 部分的 web.config 文件中，我写过：

```
<urlMappings enabled="true">
  <add url="~/RouteUrl" mappedUrl="~/UI/MainForm.aspx" />
</urlMappings> 
```

当我浏览*http://localhost/RouteUrl/* 时，它显示**HTTP 错误 403.14 - Forbidden。Web 服务器配置为不列出此目录的内容** 当我直接浏览*http://localhost/RouteUrl/UI/MainForm.aspx*时，它只是显示页面，不显示任何错误。

我不想启用目录浏览。我错过了什么？我应该如何正确重定向 URL？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-11T11:11:00.010

最后我发现了问题。它`~`本身指向根目录和`<add />`我写的标签`url="~/RouteUrl"`。

所以更正的`<add />`标签将是：
`<add url="~/" mappedUrl="~/UI/MainForm.aspx" />`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-11T01:43:04.950

我相信你的问题是尾随 /。您的路线是到 ~/RouteUrl，并且您正在输入 ~/RouteUrl/，它将充当目录的根目录，并且在关闭目录浏览的情况下，您会收到 403 错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-09T21:40:53.887

添加`<modules runAllManagedModulesForAllRequests="true" />` 到`<system.webServer>`web.config 中的部分对我有用。

# java - com.microsoft.sqlserver.jdbc.SQLServerException：用户“root”登录失败。客户端连接 ID

> ID：11833378
> 
> 赞同：2
> 
> 时间：2012-08-06T17:54:10.420
> 
> 标签：java, sql-server-2008, jdbc

我正在尝试通过 java 代码访问 SQL Server 2008，但出现以下错误：

`com.microsoft.sqlserver.jdbc.SQLServerException: Login failed for user 'root'.ClientConnectionId`

为什么会发生这种情况以及如何解决？

# python - Perl Inline::Python 模块，如何将代码放入字符串

> ID：11833382
> 
> 赞同：8
> 
> 时间：2012-08-06T17:54:24.743
> 
> 标签：python, perl, inline, cpan

我正在学习 perl Inline::Python 库。在 cpan 网站的例子中，我们有

```
 print "9 + 16 = ", add(9, 16), "\n";
   print "9 - 16 = ", subtract(9, 16), "\n";

   use Inline Python => <<'END_OF_PYTHON_CODE';
   def add(x,y): 
      return x + y

   def subtract(x,y):
      return x - y

   END_OF_PYTHON_CODE 
```

是否可以将 python 代码放入字符串中，以便我可以在运行时创建 python 代码？例如，类似：

```
my $python_code = "
def add(x,y):
   return x + y
";
print $python_code;
use Inline Python => "$python_code";
print "9 + 16 = ", add(9, 16), "\n"; 
```

我们有一个项目将在运行时动态创建 python 函数。我们想调用这些函数。py_eval() 是要走的路吗？提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-06T18:25:35.973

没有经验`Inline::Python`，但是`Inline::C` [您可以使用该`bind`函数在运行时设置代码](https://stackoverflow.com/questions/4188349/)，所以也许这会起作用：

```
my $python_code = "
def add(x,y):
   return x + y
";
print $python_code;
Inline->bind( Python => $python_code );
print "9 + 16 = ", add(9, 16), "\n"; 
```

# java - 使用 RandomAccessFile 编写学生数组时遇到问题

> ID：11833385
> 
> 赞同：3
> 
> 时间：2012-08-06T17:54:38.987
> 
> 标签：java, arrays, arraylist, random-access

我在打印一个学生商店时遇到了一些问题，我使用`ArrayList`. 然后我制作了一个静态数组来容纳这些不同的学生，现在我正在尝试找出我可以使用什么方法来编写它们。这是我的代码：

```
MainApp
import java.io.RandomAccessFile;

    public class MainApp
    {

        public static void main(String[] args) throws Exception 
        {
            new MainApp().start();

        }
        public void start()throws Exception 
        {
            StudentStore details = new StudentStore();
            Student a = new Student("Becky O'Brien", "DKIT26", "0876126944", "bexo@hotmail.com");
            Student b = new Student("Fabio Borini", "DKIT28", "0876136944", "fabioborini@gmail.com");
            Student c = new Student("Gaston Ramirez", "DKIT29", "0419834501", "gramirez@webmail.com");
            Student d = new Student("Luis Suarez", "DKIT7", "0868989878", "luissuarez@yahoo.com");
            Student e = new Student("Andy Carroll", "DKIT9", "0853456788", "carroll123@hotmail.com");
            details.add(a);
            details.add(b);
            details.add(c);
            details.add(d);
            details.add(e);
            //details.print();

            RandomAccessFile file = new RandomAccessFile("ContactDetails.txt","rw");

            Student[] students = {a,b,c,d,e};
            for (int i = 0;i < students.length;i++)
            {
                file.writeByte(students[i]);
            }
            file.close();

         }

     } 
```

该行`file.writeByte(students[i]);`不正确，我找不到适合此的方法。错误读取`writeByte(int)`类型`RandomAccessFile`中的方法不适用于参数（`Student`）。这显然是因为`writeBytes`方法不带学生类型。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T17:59:11.703

字符串有一种非常简单的方法可以将其转换为字节。他们有一种`getBytes()`行之有效的方法。`toString()`您可以通过重载该方法来获取学生的字符串表示形式。所以你的电话看起来很像

```
file.writeByte(students[i].toString().getBytes( "UTF-8" )); 
```

编辑：

Forgot getBytes() 返回一个字节数组。这应该有效：

```
byte[] bytes = students[i].toString().getBytes();
for(byte byteWrite : bytes){
    file.writeByte(byteWrite);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T18:01:31.250

`RandomAccessFile` is meant to be seek to points in the file and inject values, and I wouldn't recommend it for your purposes. If all you are trying to do is write these lines to a file I would use a `BufferedWriter`. It has everything you need.

BufferedWriter file= new BufferedWriter(new FileWriter(filename));

and then to write, just put:

file.write(students[i]);

I should warn you that each Student will look like garbage unless you have a custom `toString()` method.

If you just want to write the objects to file in non-readable format, check out [`BufferedOutputStream`](http://docs.oracle.com/javase/1.4.2/docs/api/java/io/BufferedOutputStream.html)

# jquery - 如何将 SVG 调整为不同的大小

> ID：11833388
> 
> 赞同：2
> 
> 时间：2012-08-06T17:54:49.000
> 
> 标签：jquery, jquery-plugins, svg, jquery-svg

我在我的项目中使用[Jquery SVG](http://keith-wood.name/svg.html)插件。我想将我的 svg 调整为不同的大小，我编写了以下代码以加载更小尺寸的 svg

```
 $('#svgbasics').svg({
            loadURL: 'lion.svg', // External document to load 
            onLoad: null, // Callback once loaded 
            settings: {width: '100px'}, // Additional settings for SVG element 
            initPath: ''
        }) 
```

但它总是以 100% 大小打开图像，请任何人帮助我如何显示不同大小的 SVG

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-09T05:43:47.007

在搜索了几天后，我发现了以下内容

> 如果您想调整 svg 的大小，那么我们必须调整 svg 的 viewbox 大小，设置宽度只会调整外部显示区域的大小

我们可以通过简单地在图像标签中显示它来调整 svg 的大小并根据要求调整它的大小，即

```
<img width="200px" src="lion.svg"></img> 
```

我在以下帖子中找到了答案

[如何缩放嵌入 <object> 标签的顽固 SVG？](https://stackoverflow.com/questions/644896/how-do-i-scale-a-stubborn-svg-embedded-with-the-object-tag)

# html - 如何缩放 iframe 的内容？

> ID：11833390
> 
> 赞同：0
> 
> 时间：2012-08-06T17:54:51.067
> 
> 标签：html, iframe, resize, transform, scale

我有一个 Adob​​e Edge JavaScript 和 CSS3 动画的 EdgePreload HTML 页面包含在另一个页面中，使用该`iframe`标签。它工作得很好，但是当我尝试使用时`-webkit-transform:scale(0.5,0.5)`，它`iframe`本身从 1600 x 900px 缩放到 800 x 450px，但内容保持相同大小。我会发布该文件的链接，但它目前处于脱机状态。如果您需要任何其他信息，请说出来。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T19:09:28.313

在转换时，IFrame 是否会重新加载？..如果不是，那就是不调整大小的问题..内容根据加载 iframe 大小对齐。请在转换后尝试重新加载 iframe..

如果重新加载是不可能的，则可能必须显式访问 Iframe DOM 并调整内容的大小，在这种情况下，跨域策略将发挥作用并且会很乏味..

# c# - Asp.Net 从 PlaceHolder 获取控制值

> ID：11833392
> 
> 赞同：1
> 
> 时间：2012-08-06T17:54:57.867
> 
> 标签：c#, foreach, placeholder

我已经像这样在我的页面中定义了一个占位符；

```
<asp:PlaceHolder ID="attrPlaceHolder" runat="server"></asp:PlaceHolder> 
```

我正在使用查询字符串 productId 从数据库表中填充这个占位符，如下所示；

```
 // obtain the attributes of the product
                DataTable attrTable = CatalogAccess.GetProductAttributes(productId);
                // temp variables
                string prevAttributeName = "";
                string attributeName, attributeValue, attributeValueId;
                // current DropDown for attribute values
                Label attributeNameLabel;
                DropDownList attributeValuesDropDown = new DropDownList();
                // read the list of attributes
                foreach (DataRow r in attrTable.Rows)
                {
                    // get attribute data
                    attributeName = r["AttributeName"].ToString();
                    attributeValue = r["AttributeValue"].ToString();
                    attributeValueId = r["AttributeValueID"].ToString();
                    // if starting a new attribute (e.g. Color, Size)
                    if (attributeName != prevAttributeName)
                    {
                        prevAttributeName = attributeName;
                        attributeNameLabel = new Label();
                        attributeNameLabel.Text = "<li class=\"txt\">" + attributeName + ":</li>";
                        attributeValuesDropDown = new DropDownList();
                        attrPlaceHolder.Controls.Add(attributeNameLabel);
                        attrPlaceHolder.Controls.Add(attributeValuesDropDown);
                    }
                    // add a new attribute value to the DropDownList
                    attributeValuesDropDown.Items.Add(new ListItem(attributeValue, attributeValueId));
                } 
```

但是，当在按钮单击事件中，当我使用 Visual Studio 调试循环遍历这个地方时，我看到 Visual Studio Studio 调试器首先在我的 foreach 循环中点击“ **attrPlaceHolder.Controls”**字，然后是“ **in”**关键字（在foreach循环中）但它没有击中前两个单词（即我的foreach循环中**的'Control cnt'**。它看起来;

```
protected void ButtonBuyNow_Click(object sender, EventArgs e)
{
    // Retrieve the selected product options
    string options = "";
    foreach (Control cnt in attrPlaceHolder.Controls)
    {
        if (cnt is Label)
        {
            Label attrLabel = (Label)cnt;
            options += attrLabel.Text;
        }

        if (cnt is DropDownList)
        {
            DropDownList attrDropDown = (DropDownList)cnt;
            options += attrDropDown.Items[attrDropDown.SelectedIndex] + "; ";
        }
    }

    // Add the product to the shopping cart
    ShoppingCartAccess.AddItem(productId, options);
} 
```

基本上我需要填充'options'变量，但它没有触及内部的foreach循环，因此我无法填充'options'变量。这是我的应用程序中的一个严重问题。请告诉我**为什么我无法进入 foreach 循环**。

**注意：** 请注意，这不是我整个页面的完整代码。我的其余代码正确执行。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-06T18:01:38.440

> 为什么我无法进入 foreach 循环

因为列表是空的。

> 为什么列表是空的？（将是下一个合乎逻辑的问题）

因为，在 ASP.Net 中，必须重新创建动态创建的控件`Page_Init`才能*存在*。当您在此阶段创建它们时，**页面生命周期**将绑定视图状态并准备好使用。如果您收到回发（例如来自按钮）并且不重新创建它们，它们根本不存在。

# sublimetext2 - 如何在 sublime-text 中隐藏和取消隐藏项目文件夹树

> ID：11833395
> 
> 赞同：36
> 
> 时间：2012-08-06T17:55:02.453
> 
> 标签：sublimetext2, hotkeys

我在界面左侧看不到项目文件夹导航树。

我怀疑我不小心撞到了一些捷径，让它消失了。

使项目文件夹导航树在 sublime 文本中隐藏和取消隐藏的快捷方式是什么？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2015-06-26T18:12:51.787

默认：

```
{ "keys": ["ctrl+k", "ctrl+b"], "command": "toggle_side_bar" }, 
```

您可以在主菜单中访问此设置：`Preferences -> Key Bindings - Default`。
并且您可以在主菜单中随意覆盖：`Preferences -> Key Bindings - User`.

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2015-09-06T16:12:49.090

默认情况下，如果您使用的是 mac os：

```
{ "keys": ["command+k", "command+b"], "command": "toggle_side_bar" } 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2016-07-15T04:50:55.327

在**命令面板**( `Ctrl+Shift+P`) 中输入（或查找）**视图：切换侧边栏**并点击`Enter`

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2019-01-13T20:06:08.490

我的键盘映射中有类似的东西。

```
{"keys": ["super+k", "super+b"], "command": "toggle_side_bar"}, 
```

在视图 -> 侧边栏 -> 显示/隐藏侧边栏`⌘K`，`⌘B`. 这意味着“***按住 cmd 然后单击按钮“b”和“k”，然后释放 cmd*** “。

我无法理解...我认为有两种方法可以切换项目树（`cmd`+ `B`OR `cmd`+ `K`），但它基本上是一个命令。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-03-09T21:56:54.813

**查看/侧边栏/显示侧边栏`⌘K`，`⌘B`**

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2020-04-09T13:07:21.160

要切换（隐藏或显示）侧栏
按 ctrl+K,ctrl+B (ctrl+K,B)

# jquery - 获取并插入 用jQuery

> ID：11833398
> 
> 赞同：1
> 
> 时间：2012-08-06T17:55:14.213
> 
> 标签：jquery, lightbox

我正在破解一个 Lightbox javascript 图像插件来显示页面上画廊中的缩略图。该页面有一系列`<img>`带有“gallery-image”类的。我正在收集它们并将它们放入名为“lb-thumbs”的灯箱叠加层中的一个 div 中。所以我把这段代码放到了一个灯箱函数中：

```
var $thumbs = ($(".gallery-image").get());
$lightbox.find('.lb-thumbs').append($thumbs); 
```

它可以工作，但是一旦灯箱打开，原始图像（在灯箱覆盖层后面）就会消失，所以当我关闭灯箱时，页面的原始 html 库已经消失。由于浏览器检查器工具，我知道当灯箱打开时会发生这种情况。所以我的代码中一定有一些东西使这些`<img>`项目消失了。可以是 jQuery`get()`还是`append()`? 我看不出这是在哪里发生的。你能？

谢谢！马特

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T18:11:04.393

我认为 append() 实际上是导致你的问题。当您进行追加时，您并没有创建新对象，只是将旧图像从 DOM 中拉出并将其重新插入到您的灯箱中。

您始终可以在插入之前克隆对象。

**[演示](http://jsfiddle.net/scispear/wcbqa/)**

```
$lightbox.find('.lb-thumbs').append($thumbs.clone()); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T18:12:38.510

似乎该`.get()`方法返回对原始数组的引用。`.get()`反正都是多余的。尝试这个：

```
var $thumbs = $(".gallery-image");
$lightbox.find('.lb-thumbs').append($thumbs); 
```

您可以在分配数组之前交替克隆数组：

```
var $thumbs = ($(".gallery-image").clone().get());
$lightbox.find('.lb-thumbs').append($thumbs); 
```

# cassandra - 创建 Cassandra 架构

> ID：11833399
> 
> 赞同：1
> 
> 时间：2012-08-06T17:55:21.987
> 
> 标签：cassandra

我为我的项目写了简短的架构。我是 Cassandra 的初学者。架构看起来像这样。

```
User = { uid: “”,
         media{ 
           media1:{
                     Rating:”” ,
                     Views:””,
                     Like:””
            },
        media2:{
        },
        media3:{
        },
        ……
         }
 }

Media={ mediaId:{
    user:{ 
        user1: {

                         rating:”” ,
                             views :””,
                             like:”” ,
                             comment:””
         },

        user2:{
                },
        user3:{
                },
        …..
        },

        category:””,
            views:””,
            rating:””,
            likes:””,
            attributes:{
             audio:{
                             albumimgurl:””
                                 track:””,
                                 artist:””,
                                 duration:””,
                                 url:””
            },
            image:{

                    smallurl:””,
                    largeurl:””,
                    title:””
           },
           video:{
                  coverimage:””,
                  url:””,
                  duration:””,
                  title:””
           },

           article:{
             title:””,
                             content:””
           },
       wallpaper:{
                     title:””,
                     smallurl:””,
                     midurl:””,
                     largeurl:””
        },
       },
  } 
```

首先，我不知道我的模式是否适合 Cassandra。请告诉我该架构适合 Cassandra。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T10:59:14.507

从 JSON 模型开始很好，因为它很容易阅读 - 不是你的情况，但一般来说;)

这是很好的格式化程序：http: [//jsonlint.com/](http://jsonlint.com/)

JSON 文档中的一个级别对应于 Column Family，两个级别表示已经是 Super Column Family，并且不推荐使用这些级别。更多级别是不可能的。当您需要更多级别时，请使用复合键。

要从 JSON 文档中删除一个级别：

```
attributes:{
             audio:{
                             albumimgurl:””
                                 track:””,
                                 artist:””,
                                 duration:””,
                                 url:”” 
```

将其更改为：

```
attributes:{
             audio:albumimgurl:””
             audio:track:””,
             audio:artist:””,
             audio:duration:””,
             audio:url:”” 
```

`audio:albumimgurl`列名在哪里- 这在 Cassandra 复合列中。

您可以使用任意数量的化合物，所以：`attributes:audio:albumimgurl`也可以

# iphone - 按钮进程的声明

> ID：11833400
> 
> 赞同：0
> 
> 时间：2012-08-06T17:55:23.493
> 
> 标签：iphone, objective-c

我想了解一个按钮的声明过程。

```
@interface MerdaViewController : UIViewController{    
    IBOutlet UIButton *button;
}

@property (retain, nonatomic) IBOutlet UIButton *button;

@end 
```

为什么我们需要这些步骤？

总是需要吗？

太感谢了。

亚历克斯。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T17:59:12.717

**要创建一个按钮插座，您只需要这条线。**

```
@property (retain, nonatomic) IBOutlet UIButton *button; 
```

**创建按钮动作**

```
-(IBAction)doSomething:(id)sender; 
```

**就像补充一点：**

出口通常应该是弱/分配的，除了那些从文件所有者到 nib 文件中的顶级对象（或者，在 iOS 中，故事板场景）应该是强/保留的

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T18:00:55.600

1.  至少在相对较新的 XCode 版本中，您不需要声明该实例变量。它会自动得到照顾。

2.  你需要，`@property`所以你可以打电话`self.button`并做任何你喜欢的事情。`IBOutlet`告诉 XCode 它是您的界面构建器中的一个元素，因此您可以将它与您添加到 IB 的可视按钮挂钩。

3.  很多时候，我发现自己实际上是在声明一个`-(IBAction)buttonAction:(id)sender;`而不是一个`IBOutlet`. 这样，当您点击该按钮时，该`IBAction`方法会自动触发。

# php - 带有 AJAX 的 jQuery UI 对话框第二次没有运行点击功能

> ID：11833401
> 
> 赞同：1
> 
> 时间：2012-08-06T17:55:23.653
> 
> 标签：php, javascript, jquery, ajax, jquery-ui

我对 jQuery UI 对话框和 AJAX 有一个奇怪的错误。

这是过程：

1.  单击链接 > 使用 AJAX 链接打开 div。
2.  在 AJAX div 中单击链接 > 使用另一个 AJAX 打开 jQuery UI 对话框。
3.  单击 jQuery UI AJAX 对话框中的链接 >`alert()`使用 JavaScript 发送消息。

现在我从一开始就执行相同的过程，直到`alert()`消息阶段一切正常。因此，如果我下次执行该过程，步骤 3 将不起作用，并且我的控制台中不会出现任何错误。

![在此处输入图像描述](../Images/9787b1fc9fb1a845ffd7645f06ccb6ee.png)

第 2 步的代码（使用 AJAX 打开 jQuery UI 对话框）：

```
function update_link(rel)
{
   $("#update_link").dialog({
            modal: false,
            height: 370,
            width: 900,
            title: 'im title',
            open: function () {
                $(this).load("<?= site_url()?>/links/show_update?id="+rel+"&rand="+rand());

            }
     });

} 
```

在步骤 3 中获取警报消息的代码（此代码在 jQuery UI 对话框页面中）：

```
$("#to_page_home").on("click", function (){
    alert("im not work if you open me in AJAX again!");
}); 
```

如果我这样做而不是代码，它也不起作用：

```
<a href="#" id="to_page_home" onclick="alert('im not work if you open me in AJAX again!');"> 
```

谢谢大家，对不起我的英语不好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T18:00:06.880

您是否随时切换#to_page_home？如果该 ID 消失/重新出现，您的 on() 在重新出现时不会重新注册

查看文档的[Direct 和 Delegated events](http://api.jquery.com/on/)部分。. . 你可能需要这样的东西：

```
$("#parentContainer").on("click", "#to_page_home', function (){
    alert("im not work if you open me in AJAX again!");
}); 
```

在这种情况下，ID 为 parentContainer 的元素必须包含带有 to_page_home 的元素，并且必须永久位于页面上。

# java - Java：单元测试后重新生成静态属性

> ID：11833402
> 
> 赞同：0
> 
> 时间：2012-08-06T17:55:36.743
> 
> 标签：java, static, junit, attributes

我正在编写一个修改静态属性的单元测试。不幸的是，这导致另一个单元测试在不应该失败的情况下失败。该属性也是最终的（该属性是一个保存值的对象，因此通过修改它，我的意思是添加/删除值）。

目前我在 tearDown() 方法中将对象（编辑：不是对象。正在测试的变量）设置为 null 并在 setUp() 方法中对其进行初始化，但这并没有重置属性。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T10:44:13.510

最好的选择是质疑为什么你有一个静态字段并找出如何摆脱它。查看 Dependency Inject 之类的东西，以消除对静态值的依赖。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T18:13:56.583

在您的 @After 方法中，考虑使用[ReflectionTestUtils重置静态字段](http://static.springsource.org/spring/docs/2.5.x/api/org/springframework/test/util/ReflectionTestUtils.html)

# javascript - jQuery 按名称获取窗口

> ID：11833403
> 
> 赞同：2
> 
> 时间：2012-08-06T17:55:38.843
> 
> 标签：javascript, jquery, window, jquery-events

> **可能重复：**
> [按窗口名称访问窗口](https://stackoverflow.com/questions/7243970/access-a-window-by-window-name)

假设我这样做：

```
window.open(url, 'somewindowname'); 
```

如何使用 jQuery 使用窗口名称 ('somewindowname') 获取对新打开的窗口的引用？

也许以某种形式`$('somewindowname')`或某种东西......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T18:01:00.933

Reference elements inside of the pop up window:

```
var imgsInPopUp = $("img", somewindowname.document.body); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T18:28:16.817

有一些未记录的行为可让您按名称获取对窗口的引用。我在这个答案中提到过[如何判断 Javascript 中是否存在窗口？](https://stackoverflow.com/questions/4785399/how-to-tell-if-a-window-exists-in-javascript/4785453#4785453)

```
// Opened a window without storing a handle, but gave it a name
window.open('/some/url', 'xxx');

// Now I need to get a reference to that window
// Calling open without setting a url gets you
// a reference and doesn't reload the window
var win = window.open('', 'xxx') 
```

这是一个[例子](http://jsfiddle.net/YyK7g/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-06T17:59:51.450

您可以像这样将窗口设置为变量

```
var foo;
foo = window.open(url, 'somewindowname'); 
```

然后你可以

利用

```
foo.close(); 
```

例如关闭窗口。请注意，这是一个 javascript 变量而不是 jquery 变量。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-06T18:00:27.457

它与 . 无关`JQuery`。

第一次打开窗口后，可以通过`window.open`再次使用函数并将返回的值分配给变量来获取对它的引用：

```
var existingWindow = window.open(url, "somewindowname"); 
```

**编辑**

这是一个[`JSFiddle`](http://jsfiddle.net/5WeVd/)演示。

# spring - Spring MVC 示例不起作用

> ID：11833404
> 
> 赞同：0
> 
> 时间：2012-08-06T17:55:40.473
> 
> 标签：spring, spring-mvc

我有麻烦了，希望得到你的帮助。我是 Spring MVC（和 Spring）的初学者。我遵循了[http://www.mkyong.com/spring3/spring-3-mvc-hello-world-example/](http://www.mkyong.com/spring3/spring-3-mvc-hello-world-example/)但它不起作用。我添加了一个欢迎文件**(index.jsp)**。当我输入**（http://localhost:8080/SpringMVC）**就可以了。但是当我添加控制器模式**(http://localhost:8080/SpringMVC/welcome)**时，它不起作用（HTTP 状态 404）。这是我的配置：

**web.xml**

```
<web-app id="WebApp_ID" version="2.4" xmlns="http://java.sun.com/xml/ns/j2ee" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="http://java.sun.com/xml/ns/j2ee 
http://java.sun.com/xml/ns/j2ee/web-app_2_4.xsd">
    <display-name>Spring Web MVC Application</display-name>
    <servlet>
        <servlet-name>mvc-dispatcher</servlet-name>
        <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
        <load-on-startup>1</load-on-startup>
    </servlet>
    <servlet-mapping>
        <servlet-name>mvc-dispatcher</servlet-name>
        <url-pattern>/</url-pattern>
    </servlet-mapping>
    <context-param>
        <param-name>contextConfigLocation</param-name>
        <param-value>/WEB-INF/mvc-dispatcher-servlet.xml</param-value>
    </context-param>
    <listener>
        <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
    </listener>
    <welcome-file-list>
        <welcome-file>/index.jsp</welcome-file>
    </welcome-file-list>
</web-app> 
```

**mvc-调度程序-servlet.xml**

```
<beans xmlns="http://www.springframework.org/schema/beans"
xmlns:context="http://www.springframework.org/schema/context"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="
    http://www.springframework.org/schema/beans     
    http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
    http://www.springframework.org/schema/context 
    http://www.springframework.org/schema/context/spring-context-3.0.xsd">
    <context:component-scan base-package="com.mkyong.common.controller" />
    <bean
    class="org.springframework.web.servlet.view.InternalResourceViewResolver">
        <property name="prefix">
            <value>/WEB-INF/pages/</value>
        </property>
        <property name="suffix">
            <value>.jsp</value>
        </property>
    </bean>
</beans> 
```

我的文件夹结构是：

```
-> src
   -> main
      -> java
         -> com
            -> mkyong
               -> common
                  -> controller
                     -> HelloController.java
      -> resources
      -> webapp
         -> index.jsp
         -> WEB-INF
            -> mvc-dispatcher-servlet.xml
            -> web.xml
            -> pages
               -> hello.jsp 
```

有人可以帮助我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T18:08:15.003

404 表示找不到请求的资源。确保您的控制器带有注释：

```
@Controller and @RequestMapping("/welcome") 
```

从链接：

```
@Controller
@RequestMapping("/welcome")
public class HelloController {

    @RequestMapping(method = RequestMethod.GET)
    public String printWelcome(ModelMap model) {

        model.addAttribute("message", "Spring 3 MVC Hello World");
        return "hello";

    }

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T20:00:03.380

您必须有一个映射到“/”的控制器。

```
@Controller
@RequestMapping("/")
public class StartController {

  @RequestMapping(method = RequestMethod.GET)
  public String printWelcome(ModelMap model) {

    model.addAttribute("message", "Spring 3 MVC Hello World");
    return "hello";

  }

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-06T18:16:59.673

您已将 servlet 映射到“/”，并且您要访问的控制器正在接受“/welcome”的请求

您需要发出的请求应该是（**http://localhost:8080/welcome**）。我不知道他为什么在他的例子中有额外的“SpringMVC”。

此外，添加`<mvc:annotation-driven/>`到您的`mvc-dispatcher-servlet.xml`以确保它在您的控制器上使用注释。并添加 mvc XML 命名空间。我的命名空间如下所示：

```
<beans xmlns="http://www.springframework.org/schema/beans"
xmlns:mvc="http://www.springframework.org/schema/mvc"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xmlns:context="http://www.springframework.org/schema/context"
xmlns:security="http://www.springframework.org/schema/security"
xsi:schemaLocation="http://www.springframework.org/schema/beans
    http://www.springframework.org/schema/beans/spring-beans-3.1.xsd
    http://www.springframework.org/schema/mvc
    http://www.springframework.org/schema/mvc/spring-mvc-3.1.xsd
    http://www.springframework.org/schema/context
    http://www.springframework.org/schema/context/spring-context-3.1.xsd
    http://www.springframework.org/schema/security
    http://www.springframework.org/schema/security/spring-security-3.1.xsd"> 
```

我建议删除该欢迎文件，直到您的控制器正常工作以保持简单

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-05-31T12:26:42.093

在您的视图中包含此库以启用`${}`

```
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %> 
```

这将解决您的问题。

# java - 如何避免在列表迭代中使用 get(0)

> ID：11833408
> 
> 赞同：2
> 
> 时间：2012-08-06T17:56:03.120
> 
> 标签：java, list, data-structures, iterator, iteration

有什么方法可以避免`get(0)`在列表迭代中使用？

`get(0)`在迭代列表时使用它总是有风险的。

我确信在这个列表中我只有一个对象。

（PS 我记得我的上一位经理总是对我说要避免`get(0)`在列表迭代中使用。）

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-06T18:00:47.800

不太清楚你所说的“有风险”是什么意思，但你可以考虑使用 Guava's [`Iterables.getOnlyElement`](https://google.github.io/guava/releases/snapshot-jre/api/docs/com/google/common/collect/Iterables.html#getOnlyElement-java.lang.Iterable-)：

```
List<String> foo = getListFromSomewhere();
String bar = Iterables.getOnlyElement(foo); 
```

这清楚地表明您希望只有一个元素。如果您认为可能没有元素，您可以使用允许您指定默认值的重载。

这样，当您要求元素时，您的期望就会被检查......但您还需要寻找什么并不明显。（你记得你的上一位经理警告过你这件事——但你记得他*为什么*警告你吗？）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-06T18:01:14.757

Edit: I misuderstood the question, not realizing there was only a single item in the List. While my options still work, they aren't really necessary. However, I question the danger of using `get(0)` if your precondition is that there is a list with a single element.

You have a few options:

First is simply let the loop get the object for you with a for-each loop

```
 for(Object thing : things) 
```

Second, is convert the list into another form and access it in the appropriate manner:

```
Object[] thingArray = things.toArray();
for(int i = 0; i < thingArray.length; i++) 
```

Third is to use the [ListIterator](http://docs.oracle.com/javase/6/docs/api/java/util/ListIterator.html)

```
ListIterator<Object> thingIterator = things.listIterator();
while(thingIterator.hasNext())
{
    Object thing = thingIterator.next(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-06T18:27:54.953

```
Object objOne = list.iterator().next(); 
```

# xcode - XCode MapKit，点

> ID：11833410
> 
> 赞同：0
> 
> 时间：2012-08-06T17:56:10.527
> 
> 标签：xcode, location, mapkit

我希望能够触摸地图上的一个点，它会返回一个 lat long，就这么简单。图书馆能满足这个要求吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T18:01:49.020

This should to the trick:

```
CLLocationCoordinate2D coords = [mapView convertPoint:aCgPoint toCoordinateFromView:mapView]; // or any other view 
```

See also [MKMapView Class Reference.](http://developer.apple.com/library/ios/ipad/#DOCUMENTATION/MapKit/Reference/MKMapView_Class/MKMapView/MKMapView.html)

# ajax - 在 AJAX 调用中收集身份

> ID：11833416
> 
> 赞同：0
> 
> 时间：2012-08-06T17:57:00.077
> 
> 标签：ajax, web-services, security

抱歉，如果这是一个愚蠢的问题，我最近在 SharePoint 上花费了太多时间，它为您处理身份 :)

如果我有一个想要围绕 AJAX 调用构建的投票系统，我如何获得用户身份？

我（据我所知）无法访问 Web 服务中的会话。我想让用户身份成为服务器自动分配的字段，以防止投票欺诈。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T18:05:30.007

使用 HttpContext.Current.Session 访问 Webservice 和 Webmethod 中的 session

# jquery-isotope - 同位素/砌体角印章

> ID：11833417
> 
> 赞同：1
> 
> 时间：2012-08-06T17:57:01.770
> 
> 标签：jquery-isotope

我正在尝试添加一个角图章，但是没有正确显示，我认为 js 代码有问题。

这是官方演示[Masonry Corner Stamp](http://isotope.metafizzy.co/custom-layout-modes/masonry-corner-stamp.html)

这是我将其添加到[网站的地方](http://latinunit.org)

这是 JS[文件](http://latinunit.org/wp-content/themes/videogrid-parent/js/isotope.js?ver=3.4.1)

我尝试在文件中的 JS 代码之上添加以下代码，但它仍然不起作用..

```
 $.Isotope.prototype._masonryResizeChanged = function() {
    return true;
  };

  $.Isotope.prototype._masonryReset = function() {
    // layout-specific props
    this.masonry = {};
    this._getSegments();
    var i = this.masonry.cols;
    this.masonry.colYs = [];
    while (i--) {
      this.masonry.colYs.push( 0 );
    }

    if ( this.options.masonry.cornerStampSelector ) {
      var $cornerStamp = this.element.find( this.options.masonry.cornerStampSelector ),
          stampWidth = $cornerStamp.outerWidth(true) - ( this.element.width() % this.masonry.columnWidth ),
          cornerCols = Math.ceil( stampWidth / this.masonry.columnWidth ),
          cornerStampHeight = $cornerStamp.outerHeight(true);
      for ( i = Math.max( this.masonry.cols - cornerCols, cornerCols ); i < this.masonry.cols; i++ ) {
        this.masonry.colYs[i] = cornerStampHeight;
      }
    }
  }; 
```

![截屏](../Images/553abca5eebcc5d56723484db6861b2d.png)

任何帮助表示赞赏

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T19:23:10.437

[作者在这里](http://jsfiddle.net/desandro/xaE7F/)提供的这个版本（过滤作为额外的好处）通常可以工作。

# c# - Windows Phone 7 取消硬件后退按钮不起作用

> ID：11833421
> 
> 赞同：0
> 
> 时间：2012-08-06T17:57:05.743
> 
> 标签：c#, windows-phone-7, cordova-2.0.0

我需要取消设备后退按钮事件。我已经尝试过在[Control press "back button" 中发布的解决方案，并使用确认对话框禁用关闭应用程序 - wp7](https://stackoverflow.com/questions/7741939/control-press-back-button-and-disable-close-the-application-using-a-dialog-for)，但它对我不起作用。难道我做错了什么？无论从对话框中选择“确定”还是“取消”，应用程序都会退出。

这是我的代码...

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Net;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Documents;
using System.Windows.Input;
using System.Windows.Media;
using System.Windows.Media.Animation;
using System.Windows.Shapes;
using Microsoft.Phone.Controls;
using System.IO;
using System.Windows.Media.Imaging;
using System.Windows.Resources;

namespace GodTools
{
    public partial class MainPage : PhoneApplicationPage
    {
        // Constructor
        public MainPage()
        {
            InitializeComponent();
            this.CordovaView.Loaded += CordovaView_Loaded;

            BackKeyPress += OnBackKeyPressed;

        }

        private void CordovaView_Loaded(object sender, RoutedEventArgs e)
        {
            this.CordovaView.Loaded -= CordovaView_Loaded;
            // first time load will have an animation
            Storyboard _storyBoard = new Storyboard();
            DoubleAnimation animation = new DoubleAnimation()
            {
                From = 0,
                Duration = TimeSpan.FromSeconds(0.6),
                To = 90
            };
            Storyboard.SetTarget(animation, SplashProjector);
            Storyboard.SetTargetProperty(animation, new PropertyPath("RotationY"));
            _storyBoard.Children.Add(animation);
            _storyBoard.Begin();
            _storyBoard.Completed += Splash_Completed;
        }

        void Splash_Completed(object sender, EventArgs e)
        {
            (sender as Storyboard).Completed -= Splash_Completed;
            LayoutRoot.Children.Remove(SplashImage);
        }

        void OnBackKeyPressed(object sender, System.ComponentModel.CancelEventArgs e)
        {
            var result = MessageBox.Show("Do you want to exit?", "Attention!",
                                          MessageBoxButton.OKCancel);

            if (result == MessageBoxResult.OK)
            {
                // Do not cancel navigation
                return;
            }
            e.Cancel = true;
        }
    }
} 
```

另请参阅，来自 Cordova 侧 [“后退按钮”事件的相同问题不会触发](https://stackoverflow.com/questions/11866952/backbutton-event-wont-fire)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T18:02:42.710

For your information: If you write an application (not an XNA game) you shoul avoid canceling back button. Otherwise your app will be canceled on passing Marketplace sertification.

Also you can override `OnBackKeyPress` method with the same code;

```
protected override void OnBackKeyPress(CancelEventArgs e)
        {
            var result = MessageBox.Show("Do you want to exit?", "Attention!",
                                          MessageBoxButton.OKCancel);

            if (result == MessageBoxResult.OK)
            {
                base.OnBackKeyPress(e);
                return;
            }
            e.Cancel = true;
        } 
```

**update**

I've just created a new 'Silverlight for windows phone" solution. Opened MainPage.xaml.cs file and added this code to it:

```
// Constructor
public MainPage()
{
    InitializeComponent();
    BackKeyPress += OnBackKeyPressed;
}

void OnBackKeyPressed(object sender, System.ComponentModel.CancelEventArgs e)
{
    var result = MessageBox.Show("Do you want to exit?", "Attention!",
                                  MessageBoxButton.OKCancel);

    if (result == MessageBoxResult.OK)
    {
        // Do not cancel navigation
        return;
    }
    e.Cancel = true;
} 
```

so there is only one page in this project. And it works. The target platform is `Windows Phone OS 7.1`, I've checked it on Mango device and on the standard emulator. I think the problem is somewhere else. Maybe some code crashes you application while you are trying to cancel back event?

Please, try to check it on new simple project.

# python - 如何在 Python 中创建假文本文件

> ID：11833428
> 
> 赞同：16
> 
> 时间：2012-08-06T17:57:50.967
> 
> 标签：python, python-2.7, readlines

如何在 Python 中创建包含文本的假文件对象？`readlines()`我正在尝试为接受文件对象并通过然后进行一些文本操作检索文本的方法编写单元测试。请注意，我无法在文件系统上创建实际文件。该解决方案必须与 Python 2.7.3 兼容。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-08-06T17:59:09.080

这正是[`StringIO`/`cStringIO`](https://docs.python.org/2/library/stringio.html)（[`io.StringIO`](https://docs.python.org/3/library/io.html#io.StringIO)在 Python 3 中重命名为）的用途。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-06T18:09:21.290

或者你可以很容易地自己实现它，特别是因为你需要的是`readlines()`：

```
class FileSpoof:
     def __init__(self,my_text):
         self.my_text = my_text
     def readlines(self):
         return self.my_text.splitlines() 
```

然后就这样称呼它：

```
somefake = FileSpoof("This is a bunch\nOf Text!")
print somefake.readlines() 
```

也就是说，另一个答案可能更正确。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2019-11-20T10:40:26.177

### 在 Python3 中

```
import io
fake_file = io.StringIO("your text goes here") # takes string as arg
fake_file.read() # you can use fake_file object to do whatever you want 
```

### 在 Python2 中

```
import io
fake_file = io.StringIO(u"your text goes here") # takes unicode as argument
fake_file.read()  # you can use fake_file object to do whatever you want 
```

有关更多信息，请[在此处查看文档](https://docs.python.org/3/library/io.html)

# c++ - 在 user32.dll 中挂钩 GetSysColor

> ID：11833431
> 
> 赞同：-1
> 
> 时间：2012-08-06T17:58:03.570
> 
> 标签：c++, winapi, mfc, hook

我在挂钩“user32.dll”的“GetSysColor”函数以进行修改时遇到问题

```
COLOR_ACTIVECAPTION
COLOR_CAPTIONTEXT
COLOR_INACTIVECAPTION
COLOR_INACTIVECAPTIONTEXT 
```

我的 windows 钩子类如下所示：

```
CHook(const TCHAR * module, const TCHAR * procname, const void * pNewProc)
{        
    HINSTANCE hMod = GetModuleHandle(module);
    m_pProc = (BYTE*)GetProcAddress(hMod, procname);

    if (m_pProc)
    {
        for (int i = 0; i < 5; i++)
        {
            m_Storage[i] = m_pProc[i];
        }

        DWORD dwOldProtect;
        VirtualProtect(m_pProc, 5, PAGE_EXECUTE_READWRITE, & dwOldProtect);
        m_pProc[0] = 0xE9;
        *(unsigned*)(m_pProc + 1) = (unsigned)pNewProc - (unsigned)(m_pProc + 5);
    }
}

~CHook()
{
    if (m_pProc && (m_pProc[0] == 0xE9))
    {
        for (int i = 0; i < 5; i++)
        {
            m_pProc[i] = m_Storage[i];
        }
    }
}

private:
    BYTE* m_pProc;
    BYTE  m_Storage[5]; 
```

我写了一个自定义的 getsyscolor 方法

```
static COLORREF WINAPI GetCustomSysColor(int nIndex)
{
    return RGB(0xFF, 0x00, 0x00);
} 
```

进行测试，如果每条消息都通过该功能进行路由（那么最后一切都应该是红色的）。我通过安装它

```
CHook theHook("user32.dll", "GetSysColor", GetCustomSysColor); 
```

不幸的是，并不是所有的东西都被涂成红色，只有一些东西，比如图标等。但开头提到的颜色是以前的系统设置——标题仍然是蓝色的，文字是白色的。我什至对其进行了调试，并且标题的颜色到达了 GetCustomSysColors 方法。

也许有人知道是否有另一个 winapi 调用正在为标题或我错过了任何重要的东西。非常感谢！

干杯，克里斯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T18:39:59.340

1）以为，你忘了[GetSysColorBrush](http://msdn.microsoft.com/en-us/library/windows/desktop/dd144927%28v=vs.85%29.aspx)

2）另一边，还有其他系统库，可能是gdi用到的，可以尝试使用调试器断点来识别

3）关于标题，它可以由`DrawCaption`，`GradientFill`，或具有主题功能（XP或更高版本）如`DrawThemeBackground`。

# java - 根据 android SQLite 数据库中前一行的相同值增加特定值

> ID：11833432
> 
> 赞同：0
> 
> 时间：2012-08-06T17:58:08.953
> 
> 标签：java, android, database, sqlite

我试图将存储在我的 SQLite 数据库中的值增加一个特定的值，例如每次创建一个新条目时增加 5。我将不得不检查是否有任何先前的条目，然后显示前一行的值 + 5，如果没有前一行，则插入标准值 20。我非常不知道该怎么做，因为这一切都取决于能够检查是否有任何先前的行，我只是不知道如何做到这一点。任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T18:36:57.770

`Cursor.get count()`返回满足条件的行数。用它来知道是否有任何行。光标是从 获得的`SQLiteDatabase.query()`。

我建议您阅读[http://developer.android.com/guide/topics/data/data-storage.html](http://developer.android.com/guide/topics/data/data-storage.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T19:31:12.663

您可以先在数据库上进行选择：

```
SELECT MAX(column) as cnt FROM table WHERE field = value 
```

如果找到记录，则您的价值最高。

现在您知道要做什么（插入/更新）以及应该保存什么值。

# android - SurfaceHolder.lockCanvas() 即使可用也返回 null

> ID：11833433
> 
> 赞同：5
> 
> 时间：2012-08-06T17:58:11.467
> 
> 标签：android, android-canvas

我在市场上有一款安卓游戏，我在尝试使用画布时收到了 NullPointers 的崩溃报告。我可以假设这是因为`SurfaceHolder.lockCanvas()`返回 null，但是它会在游戏中进行此操作，因为根据崩溃的位置，它`SurfaceHolder.lockCanvas()`至少返回了一次有效的画布。

这很难调试，因为我无法在自己的设备上重新创建它，这让我想知道它是否与特定设备有关。我唯一的提示是它发生的设备之一是 Nexus 7。

注意：这与我提出的同名问题不同。另一个问题是由于在画布可用之前尝试使用它，而在这里它*可用*。

以下是我的代码示例：

```
public class GameView extends SurfaceView implements SurfaceHolder.Callback
{
    class GameThread extends Thread
    {
        @Override
        public void run()
        {
            while (running)
            {
                Canvas c = null;
                try
                {
                    c = mSurfaceHolder.lockCanvas();

                    synchronized (mSurfaceHolder)
                    {
                        long start = System.currentTimeMillis();
                        doDraw(c);
                        long diff = System.currentTimeMillis() - start;

                        if (diff < frameRate)
                            Thread.sleep(frameRate - diff);
                    }
                } catch (InterruptedException e)
                {
                }
                finally
                {
                    if (c != null)
                    {
                        mSurfaceHolder.unlockCanvasAndPost(c);
                    }
                }
            }
        }
    }

    public void surfaceCreated(SurfaceHolder holder)
    {
        if (gThread.getState() == Thread.State.TERMINATED)
        {
            gThread = new GameThread(getHolder(), getContext(), getHandler());
            gThread.start();
        }
        else
        {
            gThread.start();
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-08-13T11:07:42.773

我也遇到过这个问题。当表面已经被破坏（并且`surfaceDestroyed`已经被调用）时，它偶尔会发生，但是looper线程已经在while循环中（并且在检查`running`变量之后）。然后`lockCanvas`返回 null（因为表面已被破坏）。例如，这可能发生在屏幕方向更改或活动更改时。这是一个“简单”的竞争条件线程问题。

一个简单的解决方法是在`if (canvas == null) continue;`之后添加`lockCanvas`（或只是打破循环）。然后`running`将再次检查并结束循环。

# ruby-on-rails - 在 Rails 中将本地时间转换为 UTC

> ID：11833435
> 
> 赞同：21
> 
> 时间：2012-08-06T17:58:22.963
> 
> 标签：ruby-on-rails, ruby, timezone

在我的 MySQL 数据库中，updated_at 字段存储为 UTC。上周在美国东部时间晚上 7 点输入了一条记录，它的 updated_at 值为“2012-08-01 23:00:00”。我正在尝试将 Web 客户端的本地时间转换为可以与数据库中的 updated_at 字段进行比较的 UTC。

例如，我想将 '08/01/2012 07:00 pm' 转换为 '2012-08-01 23:00:00' （考虑到我在 EDT）但我错过了时区转换方面。'7:00 pm' 是当地时间，可以来自任何时区。我当前的代码：

```
ruby-1.9.2-head :015 > from_date = DateTime.strptime('08/01/2012 07:00 pm', '%m/%d/%Y %H:%M %p')
=> Wed, 01 Aug 2012 19:00:00 +0000 
ruby-1.9.2-head :016 > from_date = Time.zone.parse(from_date.to_s).utc
=> 2012-08-01 19:00:00 UTC 
```

有什么想法吗？

编辑：另外，我可以在我的 strptime 调用中使用“%Z”，但这是假设我在值中有时区，而我目前没有。我想我可以使用 Javascript 将其与日期/时间值一起发送。

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2012-11-01T04:47:33.933

本地到 UTC

`created_at.utc`

UTC到本地

`created_at.localtime`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T18:06:33.150

首先，我会检查您的时区设置。

在您的 environment.rb (Rails 2) 或 application.rb (Rails 3) 文件中，您可以设置默认时区：`config.time_zone = 'Eastern Daylight Time (EDT)'`

其次，我会查看这篇文章以获取满足您需求的信息、指导和提示：http:
[//databasically.com/2010/10/22/what-time-is-it-or-handling-timezones-in-rails/](http://databasically.com/2010/10/22/what-time-is-it-or-handling-timezones-in-rails/)

# visual-c++ - 从 32 位到 64 位

> ID：11833436
> 
> 赞同：0
> 
> 时间：2012-08-06T17:58:29.677
> 
> 标签：visual-c++, windows-7, 32bit-64bit, visual-studio-2003, registrykey

规格：VC++ 7；程序在 XP 上运行，但在 Win7 上崩溃；使用 VS2003.NET 开发（老我知道，但这是我必须使用的，它工作得很好，非常感谢你）

我有一个在 XP（32 位）上运行良好的程序。但是，我最近用 Win7 对其进行了测试，各种杂乱无章。我强烈怀疑我的程序如何处理注册表项。

*注意：该程序不会创建或销毁密钥，只会查询密钥并返回有趣的值。（“有趣”如下所述）*

在最简单的形式中，程序从 SCSI 连接设备读取数据，并将数据保存到主机 PC 上的文件中。该程序查询 SCSI 适配器的注册表并返回程序用来访问设备的适配器 ID。

对我来说，注册表结构似乎没有从 XP 更改为 Win7，但不是 100% 确定。对此的任何见解都会很棒:)

[另外，我在： http](http://www.techsupportalert.com/content/how-windows7-vista64-support-32bit-applications.htm) ://www.techsupportalert.com/content/how-windows7-vista64-support-32bit-applications.htm读到Win7 做事的方式就像一种反射。这会改变我应该如何查询密钥吗？如果是这样，任何有关如何构造查询的信息都会很棒。

我想我需要知道的是：

*   是否像在 RegQueryValueEx 方法中更改 hKey（或 lpValueName）一样简单？
*   或者这是否意味着我需要更改 RegQueryValueEx 方法的其他方面？
*   还是完全不同的东西？

先感谢您！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T20:57:10.693

首先在您自己的机器上通过[Application Verifier](http://msdn.microsoft.com/en-us/library/windows/desktop/dd371695%28v=vs.85%29.aspx)运行您的应用程序是值得的。特别感兴趣的`LuaPriv`部分将突出显示您的应用程序执行在 Vista 或 Win-7 中无法正常运行的操作的实例。这应该可以捕捉到您可能正在咨询与 XP 不同的注册表位置的任何时间。

需要注意的一件事是，如果您正在读取由另一个应用程序创建的注册表项，那么它们可能位于不同的位置，例如在 32 位或 64 位视图中，或者虚拟化到每个用户的位置（如果一个进程运行时认为它可以在任何地方写入，但没有管理员权限，这通常会发生，因此 Windows 会将注册表写入沙箱到虚拟化区域）。

# sql - 如何根据运行日期查询 2 个不同的日期范围

> ID：11833448
> 
> 赞同：1
> 
> 时间：2012-08-06T17:59:35.990
> 
> 标签：sql, sql-server, vb.net

我正在制作一个使用 Windows 调度程序自动运行的程序。我想做的是将程序设置为在每个月的 1 日和 16 日运行。如果程序运行在 1 日。我想运行上个月的查询...例如，如果今天是 8 月 1 日，我希望它在 2012 年 7 月 1 日至 2012 年 7 月 31 日运行。如果我在 16 日运行程序，我希望它运行当月到 15 日的查询。例如，如果是 8/16，我希望程序运行 8/1/12 - 8/15/12 的查询。实现这一目标的最佳方法是什么？我是否使用 2 个单独的程序，将查询附加到正确的日期范围？一个计划在每个月的第一天运行，一个在 16 号运行？我将如何获取日期范围和年份，因为它将取决于它运行的月份/年份...我的查询是：

```
SELECT        Store_Number, Invoice_Number, Invoice_Date, Extended_Price, Warranty_Amount, Quantity_Sold, Invoice_Detail_Code
FROM            Invoice_Detail_Tb
WHERE        (Warranty_Amount > 0) AND (Invoice_Date BETWEEN CONVERT(DATETIME, '2012-08-01 00:00:00', 102) AND CONVERT(DATETIME, '2012-08-05 00:00:00', 102))
ORDER BY Store_Number, Invoice_Date 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T18:15:30.880

尝试`8/1/2012`和`8/16/2012`作为日期。它返回您想要查看的值：

```
declare @date datetime = '8/16/2012', @start datetime, @end datetime

if datepart(dd, @date) = 1
begin
  set @start = dateadd(mm, -1, @date)
  set @end = dateadd(dd, -1, @date)
end
else
begin
  set @start = dateadd(dd, -15, @date)
  set @end = dateadd(dd, -1, @date)
end

select @start, @end 
```

调整这一点相当容易，以便它可以根据任何输入日期动态计算正确的开始日期和结束日期——这样你就可以在一个月内的任何时候运行它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-06T18:15:42.767

这应该很简单，让我为您举一些例子。我真的认为这应该是一个预定任务，而不是多个。在一天结束时，更容易指出并查看一项计划任务（一个程序），然后去挖掘多个程序，看看可能有什么问题。

可以使用 SQL Server 代理（在作业部分下）安排任务。该作业可以指向一个存储过程。

在程序中你可以做一个简单的`if else if`逻辑。

`IF DAY(GetDate()) = 1` --代码在这里

`ELSE IF DAY(GETDATE()) = 16` --代码在这里

DAY(date_expression) 返回日期时间列中的日期。具有讽刺意味的是，如果您出于某种原因需要这些功能，则存在 MONTH 和 YEAR 功能。其余的很简单，如果您在该月的第一个日期，则从第一个日期到下个月的第一个日期执行每月查询 - 1，这将变为：

`SELECT DATEADD(s,-1,DATEADD(mm, DATEDIFF(m,0,GETDATE())+1,0))`

否则如果到了16号，你可以在第一天跑到半个月。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-06T18:31:24.973

如果您在视图中有查询，则可以使用：

```
where
    Invoice_Date between
    (
        case
            when datepart(dd, getdate()) = 1 then dateadd(mm, -1, getdate())
            else dateadd(dd, -15, getdate())
        end
    )
    and
    (
        case
            when datepart(dd, getdate()) = 1 then dateadd(dd, -1, getdate())
            else dateadd(dd, -1, getdate())
        end
    ) 
```

更新：忽略时间

（我知道它看起来很丑。）

```
where
    Invoice_Date between
    (
        case
            when datepart(dd, dateadd(dd, datediff(dd, 0, getdate()), 0)) = 1 then dateadd(mm, -1, dateadd(dd, datediff(dd, 0, getdate()), 0))
            else dateadd(dd, -15, dateadd(dd, datediff(dd, 0, getdate()), 0))
        end
    )
    and
    (
        case
            when datepart(dd, dateadd(dd, datediff(dd, 0, getdate()), 0)) = 1 then dateadd(dd, -1, dateadd(dd, datediff(dd, 0, getdate()), 0))
            else dateadd(dd, -1, dateadd(dd, datediff(dd, 0, getdate()), 0))
        end
    ) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-07T00:06:24.990

这就是我通常做这样的事情的方式。您的存储过程应如下所示：

```
declare
  @today  datetime ,
  @dtFrom datetime ,
  @dtThru datetime

------------------------------------------------------
-- get the current date, discarding the time component
------------------------------------------------------
set @today  = convert(datetime,convert(varchar,current_timestamp,112),112) -- get todays date, discarding the time component

---------------------------------------------------------------------------------------------------------------------------------------------------
-- determine the start/end dates of the query period.
--
-- if the query date (@today) is in the 1st half of the month (1st - 15th), the query range is the entire preceding month
-- if the query date (@today) is in the last half of the month (16 - 31st), the query range is the 1st of the current month up to the current date
---------------------------------------------------------------------------------------------------------------------------------------------------
if ( datepart(day) < 16 )
  begin
    set @dtThru = dateadd(day,   - datepart(day, @today  ) , @today  ) -- set the end   date to the last day of the previous  month
    set @dtFrom = dateadd(day, 1 - datepart(day, @dtThru ) , @dtThru ) -- set the start date to the first day of the previous month
  end
else
  begin
    set @dtfrom = dateadd(day, 1  - datepart(day, @today) , @today ) -- set the start date to the first day of the current month
    set @dtThru = @today
  end

----------------------------------------------------------------------------------------------------------------------
-- finally, adjust the start/end times to cover the entire gamut of date/time values for the month
--
-- We don't have to modify @dtFrom at all: we know its time component is 00:00:00.000 already. However, we want
-- @dtThru to have a time component of 23:59:59.997, due to SQL Server's broken way of counting time -- any time value
-- higher than that (e.g., '23:59.59.999') is 'rounded up' to start-of-day (00:00.00.000), the next day. Brilliant!
--   
----------------------------------------------------------------------------------------------------------------------
set @dtThru = dateadd(ms, -3 , dateadd(day,1,@dtThru) )

--------------------------------
-- return the data to the caller
--------------------------------
SELECT Store_Number        ,
       Invoice_Number      ,
       Invoice_Date        ,
       Extended_Price      ,
       Warranty_Amount     ,
       Quantity_Sold       ,
       Invoice_Detail_Code
FROM Invoice_Detail_Tb id
WHERE Warranty_Amount > 0
  AND Invoice_Date BETWEEN @dtFrom AND @dtThru
ORDER BY Store_Number ,
         Invoice_Date 
```

如果您不使用存储过程，则可以使用参数化查询来完成同样的事情。计算`DateTime`所需的两个值。在您的选择语句中放置占位符（“@dtFrom”和“@dtThru”）。执行查询时，将两个`DateTime`值作为名称与占位符匹配的 SqlParameter 对象传递。

# jquery - 淡出孩子然后为 div 的高度设置动画

> ID：11833450
> 
> 赞同：0
> 
> 时间：2012-08-06T17:59:44.557
> 
> 标签：jquery, jquery-animate, fadeout

我试图让 div 的孩子淡出然后为 div 本身的高度设置动画，我在 jsFiddle 中尝试过，但它不起作用，并且出现了一些奇怪的线条......任何人都可以帮助我吗？

[http://jsfiddle.net/kPq6J/7/](http://jsfiddle.net/kPq6J/7/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T20:09:57.870

我认为你想要做的是在这个小提琴中捕捉到：http: [//jsfiddle.net/f3Lpv/1/](http://jsfiddle.net/f3Lpv/1/)

```
$(document).ready(function() {
    $("#toggleid").click(function() {
        var child = $("#child");

        if(child.is(":visible")) {
            child.fadeTo(500, 0.0, function() {
                child.slideUp();
            });
            $("#toggleid").text("Show");
        } else {
            child.slideDown(function() {
                child.fadeTo(500, 1.0);                        
            });
            $("#toggleid").text("Hide");
        }
    });
});​ 
```

为了避免 chrome 中的伪影问题，您可能需要确保您的 css 将底部填充设置为 1px。不确定这是否总是必要的，或者只是在 jsFiddle 中：

```
body { 
    padding-bottom:1px;
} 
```

另请参阅此小提琴 (http://jsfiddle.net/f3Lpv/2/)，了解淡入淡出的稍微不同的动画技术。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T19:56:17.993

一种方法是：

```
$(function() {
    $("#toggleid").click(function(e) {
        var mh = $("#mother").height(),
            ch = $("#child").outerHeight();
        $("#mother").height(mh);
        if ($("#child").is(":visible")) {
            $("#child").fadeOut(500, function(e) {
                $("#mother").animate({ height: mh-ch });
                $("#toggleid").text("Show");
            });
        }
        else {
            $("#mother").animate({ height: mh+ch }, function(e) {
                $("#child").fadeIn(500);
                $("#toggleid").text("Hide");
            });
        };
    });
}); 
```

**然而！**如果你想让它更有活力，你可能会考虑更像：

```
$(function() {
    $(".toggleClass").live("click", function(e) {
        var $this = $(this),
            $mother = $this.parent(),
            $child = $this.siblings("div"), // maybe replace with Css Class ".child"
            mh = $mother.height(),
            ch = $child.outerHeight();
        $mother.height(mh);
        if ($child.is(":visible")) {
            $child.fadeOut(500, function(e) {
                $mother.animate({ height: mh-ch });
                $this.text("Show");
            });
        }
        else {
            $mother.animate({ height: mh+ch }, function(e) {
                $child.fadeIn(500);
                $this.text("Hide");
            });
        };
    });
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-09-24T20:17:14.987

Based on [Steve Campbell's great answer](https://stackoverflow.com/a/11835180/1092815), I updated the jsfiddle use jquery plugin instead.

usage: `child.smoothFadeIn();` and `child.smoothFadeOut();`

```
(function ($) {
    $.fn.smoothFadeOut = function () {
        var selector = this;
        selector.slideDown(function () {
            selector.fadeTo(500, 1.0);
        });
    };

    $.fn.smoothFadeIn = function () {
        var selector = this;
        selector.fadeTo(500, 0.0, function () {
            selector.slideUp();
        });
    };
}(jQuery)); 
```

[jsFiddle in action](http://jsfiddle.net/gableroux/f3Lpv/3/)

# database - 如何更新 MS Access 数据库 (vb.net)

> ID：11833453
> 
> 赞同：1
> 
> 时间：2012-08-06T17:59:53.463
> 
> 标签：database, vb.net, ms-access

我为实习项目创建了一个期刊计划，并且正在使用 MS-Access 数据库。我在**VB.net**编程。现在，我正在努力做到这一点，以便他们可以“更新”他们的日记，这意味着他们点击他们的日历日期，如果他们有那个日期的日记，它就会把他们带到那个日记。如果他们在该日期有一个，那么它会显示该日期的标题和日记文本条目。我想这样做，以便当他们单击更新按钮时，他们对日志所做的任何更改（编辑文本框字段）也会在数据库中更改。这是我到目前为止所拥有的

```
 Private Sub COE_JournalBtn_Click(sender As System.Object, e As System.EventArgs) Handles COE_JournalBtn.Click

    If DateTimePicker1.Value <> Nothing Then

        If TitleTxt.Text <> "" Then

            If JournalTextRtxt.Text <> "" Then

                myConnection.Open()

                Dim DatePicked As String = DateTimePicker1.Value
                Dim cmd As OleDbCommand
                Dim str As String

                Try

                    MyJournalTitle = TitleTxt.Text
                    MyJournalText = JournalTextRtxt.Text

                    str = "UPDATE Journals SET JournalTitle='" & MyJournalTitle & "', JournalText='" & MyJournalText & "' WHERE JournalDate=" & DatePicked

                    cmd = New OleDbCommand(str, myConnection)

                    cmd.ExecuteNonQuery()

                    myConnection.Close()

                Catch ex As Exception

                    MessageBox.Show("There was an error processing your request. Please try again." & vbCrLf & vbCrLf & _
                                    "Original Error:" & vbCrLf & vbCrLf & ex.ToString, "Error", MessageBoxButtons.OK, MessageBoxIcon.Error)

                    myConnection.Close()

                End Try

                myConnection.Close()

            End If

        End If

    End If

End Sub 
```

现在我的更新字符串本身是

```
"UPDATE Journals SET JournalTitle='" & MyJournalTitle & "', JournalText='" & MyJournalText & "' WHERE JournalDate=" & DatePicked 
```

现在，发生的事情，绝对没有什么。没有错误框出现。没有消息框出现。程序不会冻结。并且数据库保持不变。我究竟做错了什么？我的代码中是否有错误或缺少某些内容？请帮助我，因为我真的很想弄清楚这一点，我一直在到处寻找 VB.net 中的解决方案，但找不到适用于我的解决方案，因为我使用的是 MS-Access 而不是 SQL。

在此先感谢，理查德·保利切利

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-06T18:08:04.793

使用参数化查询来避免 Sql 注入攻击和引用问题

```
str = "Journals SET JournalTitle=?, JournalText=? WHERE JournalDate=?"
cmd = New OleDbCommand(str, myConnection) 
cmd.Parameters.AddWithValue("@jounalTitle", MyJournalTitle )
cmd.Parameters.AddWithValue("@journalText", MyJournalText)
cmd.Parameters.AddWithValue("@journalDate", DatePicked)
cmd.ExecuteNonQuery() 
```

使用参数将使您的代码免于继续引用，这会使您的代码很容易出现输入错误。[而且你对Sql Injection](http://xkcd.com/327/)没有任何问题

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-06T18:09:02.940

`UPDATE`您的这部分陈述可能有问题：

```
"' WHERE JournalDate=" & DatePicked 
```

如果日志字段`JournalDate`是日期/时间数据类型，则使用访问日期分隔符 ( `#`) 将日期字符串值括起来。

```
"' WHERE JournalDate=#" & DatePicked & "#" 
```

您还可以将日期字符串转换为 yyyy-mm-dd 格式，以避免误解基于本地的日期文字。

我同意为此使用参数查询的建议。我只是想帮助您了解为什么最初的尝试可能会失败。

# php - 维护搜索表单输入

> ID：11833455
> 
> 赞同：0
> 
> 时间：2012-08-06T17:59:54.880
> 
> 标签：php, post, state, search-form

我正在构建一个 CRUD 应用程序，需要实现两种形式的搜索：

基本搜索功能接受一个关键字并在数据库表的每一列中搜索该特定关键字。搜索关键字作为 URL 参数以 www.website.com/category?q=keyword 的形式发送。这里没什么特别的...

在高级搜索表单中，用户最多可以指定 5 个关键字，对于每个关键字，他们可以从数据库表中选择需要搜索该关键字的列。简而言之：高级搜索表单最多需要 5 个关键字列对。此表单通过 POST 提交（因为我想避免达到最大 URL 字符数的限制）。

结果需要分页，每页显示10条记录。我在网上搜索了分页类，但是它们都获取数据库表中的记录总量，然后返回需要为该页面显示的选择。因为我在这里处理大量数据，所以我不能这样做。

这导致我创建自己的分页类，它接受请求的页码（如果应用，来自搜索表单的 $_GET 和 $_POST 参数）。根据它计算结果的总数，计算总页数，决定是否有“上一页”和“下一页”......它还返回一个 SQL 语句（带有 LIMIT 和 OFFSET 值）以执行特定的模型（使用我自己的 MVC 架构（又名无框架））。这使我只能获取请求页面的结果。

问题：当用户浏览页面时（也就是单击“上一个”或“下一个”按钮），$_POST 数据丢失。但是，需要这些值才能获得另一个页面的结果。

这个特殊的问题让我想到了论坛上的搜索表单。我提交了关于其中一个的查询，并注意到 URL 附加了一个搜索 ID：example.com/forum/search.php?searchid=5672532

这意味着表单数据以某种方式保存在某个地方......我在想最好的选择可能是什么，从最合理到最不合理： - 每个搜索输入保存例如 30 分钟的数据库表 - 会话 - 文件（隐藏字段显然不是一个选项，因为它们需要按下表单提交按钮才能与请求一起发送）

我想在这里发表您对此的看法，你们中的一些人一定已经遇到过这个问题......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T18:18:40.317

将搜索参数保存在 JSON 或在数据库中编码的 URL 中一段时间​​（有一个`expiry`列）似乎是最好的解决方案。

请注意，以这种方式，您需要使用不同的`LIMIT`子句一遍又一遍地查询数据库。

# android - Android SurfaceView：添加回调时无法构建

> ID：11833460
> 
> 赞同：0
> 
> 时间：2012-08-06T18:00:12.700
> 
> 标签：android, android-layout, surfaceview

我已经实现了自定义 Android SurfaceView 并在为其添加回调时遇到错误。

这是我的课程代码`SurfaceView`：

```
public class AndroidSurface extends SurfaceView {

    public SurfaceHolder holder;

    public AndroidSurface(Context context, AttributeSet attrs) {
        super(context, attrs);

        holder = getHolder();
        holder.addCallback(new SurfaceHolder.Callback() {

            public void surfaceChanged(SurfaceHolder holder, int format,
                    int width, int height) {
                // TODO Auto-generated method stub

            }

            public void surfaceCreated(SurfaceHolder holder) {
                // TODO Auto-generated method stub

            }

            public void surfaceDestroyed(SurfaceHolder holder) {
                // TODO Auto-generated method stub

            }

        });
    }
} 
```

当我将此视图添加到`layout.xml`，例如：

```
<com.app.AndroidSurface
        android:id="@+id/surfaceView1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_above="@+id/rightBtn"
        android:layout_alignParentLeft="true"
        android:layout_alignParentRight="true"
        android:layout_below="@+id/textView1" /> 
```

显示时我会遇到错误`Graphical Layout`：未能实例化。（在插件：com.android.ide.eclipse.adt），当运行这个项目时，我会有异常。在 LogCat 中查看时，我看到了 Java Null Point Exception。

奇怪的是：如果我删除`holder.addCallback(new SurfaceHolder.Callback() {...`没有遇到错误。

这看起来也很奇怪，请告诉我如何解决这个问题。

@已编辑：问题是因为当我时`getHolder`，它不返回`surface holder`，所以持有人为空，我不知道为什么。

谢谢 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T18:20:40.857

你应该检查你的上下文，并确保你在你的生命周期中以正确的顺序做事。查看这篇文章[surfaceView.getHolder not return SurfaceHolder](https://stackoverflow.com/questions/4852740/surfaceview-getholder-not-returning-surfaceholder)

# php - 在 PHP SQL MAX 函数中显示数据

> ID：11833465
> 
> 赞同：0
> 
> 时间：2012-08-06T18:00:41.180
> 
> 标签：php, sql, max, die

我根本无法让这个 PHP 代码工作。

```
if(!$connecton) {
die("Connection Failed" . $mysql_error());
}

mysql_select_db("rewiredstate",$connection);

$max="SELECT MAX('Unique ID') as id FROM topics";
$maxquery= mysql_query($max) or die (mysql_error());
while($row = mysql_fetch_assoc($maxquery)) {
echo $row['id'];
}
?> 
```

它只是这样说：

注意：未定义常量的使用已死 - 在第 9 行的 C:\xampp\htdocs\Opinions\script.php 中假定“死”已死

我已经检查了 PHPMyAdmin 中的 SQL，这很好。任何帮助将不胜感激

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T18:11:11.083

我认为您混淆了别名和ID。试试这种方式：`$max="SELECT MAX('id') as UNIQUE_ID FROM topics";`

# javascript - How to assign a Javascript variable to PHP variable in symfony2?

> ID：11833468
> 
> 赞同：-1
> 
> 时间：2012-08-06T18:00:55.097
> 
> 标签：javascript, symfony, php-5.3

I am new to web development and I am using symfony2 for this project I am working on.

Have a template file called **view.html.php** and Inside this I have a JavaScript portion, inside which I want to assign JavaScript variable to PHP variable..I tried to do the following way but it did not work. Could some one please help me out with this.

```
<script>
  ....
  var temp=json;

   //error below
  <?php $jsonobj= = temp ?> 
  ...
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T13:01:00.337

**大行**

让您的 php 从通过 js 提供此变量的页面中获取您的值，然后将其分配给您的 php var

明白我的意思吗？

# java - How to get parent entity?

> ID：11833469
> 
> 赞同：0
> 
> 时间：2012-08-06T18:01:00.687
> 
> 标签：java, hibernate, jpa-2.0, java-ee-6

I use JPA 2 with Hibernate. There are two entity classes, `CardElement` and `IdentityDocumentKind`. The last one is an inherited entity of the first one. SINGLE_TABLE inheritance strategy is used. When I try to select an instance of the parent class by query `from CardElement where id = '123456'` the following error occures:

> Object with id: 123456 was not of the specified subclass: org.cp.cardsystem.CardElement (Discriminator: SDocClass)

I don't have a subclass for "SDocClass" discriminator value. Actually at the moment of developing `IdentityDocumentKind` class querying of `CardElement` was used widely across the application. So I can't create a subclass of `CardElement` for each discriminator value and replace `CardElement` with it in all existent queries. It would be cost too much efforts for me. Is there a way to instantiate parent entity class when SINGLE_TABLE inheritance strategy is used?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T04:05:37.630

我不确定我是否正确理解了您的问题。您正在使用单表策略来存储整个继承层次结构。但是，您只映射了一些鉴别器，而这一次，是未映射的鉴别器导致了问题（因为 Hibernate 不知道该子类的含义）。我是否正确理解您的问题？

考虑针对特殊的数据库视图而不是真实表工作。该视图仅公开具有您可以处理的鉴别器的记录。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T15:27:15.680

问题解决了。我`CardElement`以这种方式注释了继承层次结构的根实体类 ( )：`@DiscriminatorValue(value = "not null")`. 现在我可以选择此类的对象，而无需为每个鉴别器值创建子类。`not null`并且`null`似乎是 Hibernate 的特殊鉴别器值，它们在鉴别器列中匹配除 null 和 null 之外的任何内容。我在 Hibernate 的官方文档中没有找到关于这些值的任何信息。所以它可能是某种未记录的功能。

# java - DTO implementation of Serializable interface

> ID：11833473
> 
> 赞同：1
> 
> 时间：2012-08-06T18:01:05.163
> 
> 标签：java, serializable

Is it mandatory to implement Serialize for Java DTO/Model objects? If so why? If not whats the impact on performance etc?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T18:06:39.873

DTO 通常是一个数据传输对象。它不必使用 Java 序列化，但如果不需要，它需要遵循一些其他约定。

它不是性能问题，就像您使用 Java 序列化一样，它很可能必须是可序列化的（或仍然是可序列化的 Externalizable）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-06T18:15:17.450

如果您不将它们保存到文件或通过套接字发送它们，则不会。DTO 没有什么需要序列化的。是否需要序列化取决于您的计划使用情况。DTO 通常是从数据库查询返回的结果集中的一行创建的。然后将它们作为 DAO 调用的返回值传回。从那里，它们可以按原样装饰或使用，并以您的应用程序需要的任何方式使用。不需要它们是可序列化的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-02-20T05:48:52.350

DTO 通常是贫乏的，不包含任何业务逻辑。DTO 通常是 java.io.Serializable - 只有当您要跨 JVM 传输数据时才需要它。

# javascript - 奇怪的 intParse 行为

> ID：11833478
> 
> 赞同：0
> 
> 时间：2012-08-06T18:01:16.250
> 
> 标签：javascript

> **可能重复：**
> [JavaScript parseInt 八进制错误的解决方法](https://stackoverflow.com/questions/850341/workarounds-for-javascript-parseint-octal-bug)

鉴于此脚本：

```
<script type="text/javascript">
    var noproblem07 = parseInt("07") - 1;
    alert("No problem (07): " + noproblem07);
    var problem08 = parseInt("08") - 1;
    alert("Problem (08): " + problem08);
    var problem09 = parseInt("09") - 1;
    alert("Problem (09): " + problem09);
    var noproblem10 = parseInt("10") - 1;
    alert("No problem (10): " + noproblem10);
</script> 
```

为什么“08”和“09”解析为-1？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T18:03:25.270

因为`parseInt`将带有前导零的字符串解析为八进制。要解决此问题，请使用以下`radix`参数`parseInt`：

```
>>> parseInt("08")
0
>>> parseInt("08", 10)
8 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T18:02:21.680

因为您在其中运行的浏览器没有正确实现规范并尝试将它们解析为八进制，导致`0`

它在 IE9 和 safari 6 中运行良好。您可以传递第二个参数以使其在所有浏览器中正确：

```
parseInt(x, 10); 
```

# code-signing - 非 Apple 颁发的代码签名证书：它可以与 Mac OS 10.8 Gatekeeper 一起使用吗？

> ID：11833481
> 
> 赞同：27
> 
> 时间：2012-08-06T18:01:22.557
> 
> 标签：code-signing, osx-mountain-lion, osx-gatekeeper

我们公司为 Mac OS X 和 Windows 开发了我们的应用程序。我们从非 Apple 机构购买了现有的代码签名证书，用于识别我们的 Windows 安装程序。我们通过我们自己的公司网站分发我们的 DMG 和 MSI。

Mountain Lion 的新 Gatekeeper 功能的[代码签名指南](https://developer.apple.com/library/mac/#documentation/Security/Conceptual/CodeSigningGuide/Procedures/Procedures.html#//apple_ref/doc/uid/TP40005929-CH4-SW2)似乎暗示非 Apple 颁发的标准证书可以工作，尽管在这种情况下我可能会误解“第三方”的含义：

> **注意：** Apple 使用代码签名证书的行业标准形式和格式。因此，如果您的公司已经拥有用于在其他系统上签署代码的第三方签名身份，则可以将其与 OS X codesign 命令一起使用...

是否可以使用此非 Apple 证书，如果可以，如何使用命令行“codesign”命令将其合并？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-07-26T19:51:22.117

这不能归功于此，但直截了当的答案是：

不

我花了三天时间转换证书并在互联网上搜索以找到这些：

[http://successfulsoftware.net/2012/08/30/how-to-sign-your-mac-os-x-app-for-gatekeeper/](http://successfulsoftware.net/2012/08/30/how-to-sign-your-mac-os-x-app-for-gatekeeper/) [http://www.panic.com/blog/2012/02/关于网守/](http://www.panic.com/blog/2012/02/about-gatekeeper/) [http://arstechnica.com/apple/2012/02/developers-gatekeeper-a-concern-but-still-gives-power-users-control/](http://arstechnica.com/apple/2012/02/developers-gatekeeper-a-concern-but-still-gives-power-users-control/)

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2014-06-16T16:24:28.400

不可以。它不起作用的原因是：要通过 GateKeeper，您需要使用您的 Apple Developer ID 签名的代码签名证书。这**与**颁发给贵公司的常规代码签名证书不同。只有 Apple 会发布 Apple Developer ID。（或者至少，在撰写本文时。）

这非常令人困惑，因为：

*   我们购买代码签名证书的公司专门声称它适用于 MacOS。但他们的意思是，从技术上讲，我们可以签署 Apple 代码。但是通过 GateKeeper 是不同的。（至少可以说不清楚的营销。）

*   目前，关于使用 3rd 方证书签署代码的 Apple 文档尚不清楚。例如：[https](https://developer.apple.com/library/mac/documentation/security/conceptual/CodeSigningGuide/Procedures/Procedures.html)
    ://developer.apple.com/library/mac/documentation/security/conceptual/CodeSigningGuide/Procedures/Procedures.html 但是，虽然您可以签署代码，但它并没有通过 GateKeeper！同样，这可能是指内部公司应用程序的使用，也可能只是过时了。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2014-06-28T07:52:11.177

Gatekeeper 仅识别 Apple 数字证书。Windows 仅识别 Comodo、Verisign 和其他一些签名机构。因此，您需要为 Windows 购买 Comodo（或类似）证书，并为 Apple 开发人员计划支付 99 美元，这样您也可以获得 Apple 证书。至少可以说，这很烦人。

# ruby-on-rails - Rails 3.2 资产主机设置被忽略

> ID：11833488
> 
> 赞同：4
> 
> 时间：2012-08-06T18:01:35.073
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我的生产环境——

```
# Code is not reloaded between requests
  config.cache_classes = true
  config.assets.enabled = true

  # Full error reports are disabled and caching is turned on
  config.consider_all_requests_local       = false
  config.action_controller.perform_caching = true

  # Disable Rails's static asset server (Apache or nginx will already do this)
  config.serve_static_assets = true
  config.static_cache_control = "public, max-age=31536000"

  # Compress JavaScripts and CSS
  config.assets.compress = true
  config.assets.js_compressor  = :uglifier
  #config.assets.css_compressor = :yui

  # Don't fallback to assets pipeline if a precompiled asset is missed
  config.assets.compile = true

  # Generate digests for assets URLs
  config.assets.digest = true

  # See everything in the log (default is :info)
  config.log_level = :warn
  config.log_tags = [:remote_ip, lambda { |req| Time.now }]

  # Enable serving of images, stylesheets, and JavaScripts from an asset server
  ActionController::Base.asset_host = Proc.new { |source|
    unless source.starts_with?('/stylesheets' || '/javascripts')
      "//dddd.cloudfront.net/"
    end
   } 
```

但是，当我使用 image_tag 时，它仍然会返回我的 '/assets..' 相对 url，而不是资产主机的绝对 url。

```
irb(main):034:0> helper.image_tag('noimage.gif')
=> "<img alt=\"Noimage\" src=\"/assets/noimage.gif\" />"
irb(main):035:0> helper.image_path('noimage.gif') 
```

我似乎无法弄清楚可能缺少什么。我什至尝试过简单的 config.asset_host 设置，但它仍然无法识别该设置。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T18:07:14.093

您是否尝试过设置指定的配置？

```
config.action_controller.asset_host = 'https://abcd.cloudfront.net' 
```

不确定它是否适用于协议相关网址。我只是在我的应用程序中使用 https。

值得注意的是，action mailer 也有类似的设置：

```
config.action_mailer.asset_host = 'https://abcd.cloudfront.net' 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-26T11:25:34.713

Rails 配置中有一些奇怪的地方。根据文档`asset_host`应该只保留`host`部分（'yoursite.com'）。我用帮手解决了：

```
module EmailsHelper

  def email_image_tag(src) 
    protocol = ActionMailer::Base.default_url_options[:protocol] || 'http'
    image_tag asset_path(src, protocol: protocol)
  end

end 
```

在您的邮件中配置它：

```
class EmailNotificationsMailer < ActionMailer::Base

  add_template_helper(EmailsHelper)
  ...

end 
```

除了将 URL 传递给它之外，没有办法强制 image_tag 使用 URL。

# html - Simple ajax error driving me crazy

> ID：11833494
> 
> 赞同：0
> 
> 时间：2012-08-06T18:01:40.867
> 
> 标签：html, ajax

I am simply trying to read a html file inside a div, now it is not working therefore I tried to read just a a simple text file named a.txt, the text file contains 3 lines "asdasdas" something like that.

It just won't work, the function is being called after pressing a paragraph tag, here is the code:

```
functionNew()
{       
    var xmlhttp;
    if (window.XMLHttpRequest)
      {// code for IE7+, Firefox, Chrome, Opera, Safari
        xmlhttp=new XMLHttpRequest();
      }
    else
      {// code for IE6, IE5
        xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
      }

    xmlhttp.onreadystatechange=function()
      {
      if (xmlhttp.readyState==4 && xmlhttp.status==200)
        {
            document.getElementById("divfull").innerHTML = xmlhttp.responseText;
        }
      }
    xmlhttp.open("GET","a.txt",true);
    xmlhttp.send(null);

} 
```

any ideas why its not working?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T12:11:12.053

代码似乎是正确的，但尝试调用

```
xmlhttp.open("GET","a.txt",true); 
```

前

```
xmlhttp.onreadystatechange=function() 
```

尝试让我们知道它是否适合您

# c++ - 返回一个 CStringArray 给出错误

> ID：11833496
> 
> 赞同：7
> 
> 时间：2012-08-06T18:01:53.463
> 
> 标签：c++, visual-studio-2010, visual-c++, mfc

我试图返回一个 CStringArray：在我的“.h”中我定义了：

```
 Private:
    CStringArray array;

    public:
    CStringArray& GetArray(); 
```

在 。cpp 我有：

```
 CQueue::CQueue()
    {
    m_hApp = 0;
    m_default = NULL;
    }

    CQueue::~CQueue()
    {

     DeleteQueue();
    }

    CStringArray& CQueue::GetArray()
    {

     return array;   
    } 
```

从另一个文件中，我尝试通过以下方式调用它：

```
 CStringArray LastUsedDes = cqueue.GetArray(); 
```

我想这是因为上面的行，我得到了错误：

```
 error C2248: 'CObject::CObject' : cannot access private member declared in class 'CObject' 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-07T01:55:55.473

问题出在这条线上

```
CStringArray LastUsedDes = cqueue.GetArray(); 
```

即使您`CStringArray`在`GetArray()`函数中返回对 的引用，也会在上面的行中创建数组的副本。`CStringArray`它本身没有定义复制构造函数，它派生自`CObject`具有私有复制构造函数的 。

将行更改为

```
CStringArray& LastUsedDes = cqueue.GetArray(); 
```

但请注意，`LastUsedDes`现在指的是`CStringArray`包含在您的类实例中的相同内容，并且对其中一个所做的任何更改都将在另一个中可见。

如果您需要返回数组的本地副本，您可以使用`Append`成员函数来复制内容。

```
CStringArray LastUsedDes;                // default construct the array
LastUsedDes.Append( cqueue.GetArray() ); // this will copy the contents of the
                                         // returned array to the local array 
```

# php - 将数据库信息存储为数组

> ID：11833497
> 
> 赞同：1
> 
> 时间：2012-08-06T18:01:53.447
> 
> 标签：php, mysql, arrays, database

哪个是好习惯？将数据作为逗号分隔的列表存储在数据库中还是有多行？

我有一个用于帐户、课程和注册的表格。如果注册表有 3 个字段：ID、AccountID 和 ClassID，ClassID 最好是一个包含逗号分隔列表的 varchar，例如：“24,21,182,12”，或者它只是一个 int 并且有一个每次注册？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T18:08:25.843

tldr：**不要这样做**。也就是说，*不要在这里使用“打包数组”*。

使用具有“多行”的正确规范化设计。[这可能是多对多](http://sqlrelationship.com/many-to-many-relationship/)关系的良好候选者。考虑这个结构：

```
Classes 1:M Enrollments(Class,Student) M:1 Students 
```

遵循适当的标准化设计将减轻疼痛。此外，还有其他一些优点：

*   [参照完整性](http://en.wikipedia.org/wiki/Referential_integrity)（使用 InnoDB）
    *   用关系描述的一致模型
    *   类型强制（不能有`"foo,,"`）
*   *无需*自定义代码 即可加入和查询
    *   “A班的学生叫什么名字？”
    *   “谁上了一门以上的课？”
    *   列可用于索引（查询性能）
    *   通常比在代码中本地处理更快
*   更加灵活和一致
    *   可以将属性附加到注册，例如状态
    *   无需代码来处理访问站点的序列化
    *   更适应占位符和 ORM

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-06T18:16:03.640

永远不要通过将多个值与某种分隔符（如逗号或固定长度的子字符串）组合来将多个值填充到单个数据库字段中。在极少数情况下，这显然会在存储要求或性能方面带来好处……请参阅规则 #1：永远不会。曾经。

当您将多个值填充到单个字段中时，您会破坏数据库引擎中内置的所有巧妙功能，以帮助您检索和操作值。

就像假设你有这个——我猜它是某种学生数据库。

```
Plan A

student (student_id, account_id, class_id_mash)

Plan B

student (student_id, account_id)
student_class (student_id, class_id) 
```

好的，假设您想要一个所有参加第 27 课的学生的列表。使用 B 计划，您可以编写

```
select student_id
from student join student_class on student.student_id=student_class.student_id
where class_id=27 
```

简单的。

您将如何使用 A 计划？你可能认为

```
select student_id
from student
where class_id_mash like '%27%' 
```

但这不仅会找到 27 班的所有学生，还会找到 127 或 272 班的所有学生。

好的，怎么样：

```
select student_id
from student
where class_id_mash like '%,27,%' 
```

在那里，现在我们找不到 127 或 272！但是，哎呀，如果 27 恰好是列表中的第一个或最后一个，我们也不会找到它，因为两边都没有逗号。

好吧，也许我们可以通过更多关于分隔符的规则或更复杂的匹配表达式来解决这个问题。但这将是不必要的复杂和痛苦。

即使我们这样做了，每次对类 id 的搜索都必须是完全填充的顺序搜索。对于每个字段一个值和多个记录，您可以在 class_id 字段上创建一个索引，以便快速、高效地检索。（一些数据库引擎有办法索引到文本字段的中间，但是，当有一个简单的解决方案时，为什么还要进入复杂的解决方案呢？）

我们如何验证 class_id 的？使用单独的字段，我们可以说“class_id 引用类”，数据库引擎将确保我们不会输入非法值。有了 mash，没有这样的免费验证。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-06T18:05:13.270

我两者都做了，但是我没有将数据库中的信息以逗号分隔，而是使用另一个分隔符，例如`|`（这样我就不用担心插入数据库时​​的格式）。它更多地是关于你多久查询一次数据

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-06T18:04:39.467

如果您只需要完整列表，则可以将其存储为逗号分隔值。但是如果你需要查询列表，它们应该分开存储。

# php - PHP/Python - Multithreaded Sleep in Background

> ID：11833499
> 
> 赞同：1
> 
> 时间：2012-08-06T18:02:01.203
> 
> 标签：php, python, multithreading, exec, sleep

I have an issue where I am trying to have a thread in Python sleep in the background for a specified time. This needs to be done in the program though, not at the command-line level, as there is data being passed out of the Python program into PHP.

```
import os
from threading import Thread

class getPID(Thread):
    def run(self):
        print os.getpid()

class waitToKill(Thread):
    def run(self):
        time.sleep(25) #This is the sleep that needs to be done in the background
        os.system('pkill process')

getPID().start()
waitToKill().start() 
```

The concept is that PHP will repeatedly start the Python program, then take the PID and kill the process before it hits the `pkill` statement. When someone leaves the page, the Python program will have been started, but not killed, thusly reaching the `pkikll` statement and closing the process started by entering the page.

This is about as simple as I can conceive making a Dead Man's Switch in PHP/Python, but it requires background sleep, as the PHP `exec()` function does not run things in the background well while still receiving std output. (i.e. `exec(dms.py &)` will hang for 25s before returning the PID and displaying the rest of the page)

What is the best way to accomplish this? Should it be at the `time.sleep()` level or the thread level? Or can the PHP `exec()` function be modified to send output while still running in the background?

Thanks for any help you can provide!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T18:30:57.767

完全没有必要为此任务使用线程——在所有线程退出之前，进程不会被认为已完成，因此让主线程提前完成没有任何好处。

您必须执行以下操作之一：

*   以无需等待进程完成的方式从 PHP 执行脚本（请参阅：[php 执行后台进程](https://stackoverflow.com/questions/45953/php-execute-a-background-process)）
*   分叉python进程或以其他方式启动一个新的python进程，以便原始进程可以快速退出

# windows - Preventing cross-process SendMessage Calls

> ID：11833500
> 
> 赞同：2
> 
> 时间：2012-08-06T18:02:08.160
> 
> 标签：windows, winapi, sendmessage

Say I have a Windows GUI applications with a buttons on it. I am able to simulate a click on that button by using sendMessage winapi calls with `BM_CLICK` as the parameter to the call.

Now, from a security perspective, I do not want this to happen. i.e. my target process should ignore sendMessage calls from another process. Is there a provision to do this at all ? A way to authenticate the sendMessage calls ?

EDIT: In other words, how can I prevent applications such as Enabler, TurnitOn [http://www.raymond.cc/blog/how-to-enable-and-access-disabled-grayed-out-buttons-windows-and-checkboxes/](http://www.raymond.cc/blog/how-to-enable-and-access-disabled-grayed-out-buttons-windows-and-checkboxes/) from accessing functionality that is not meant to be accessed by the user ?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-09T02:26:27.213

如果应用程序在用户自己的上下文中运行，那么它只能做用户可以做的事情。经常被忽视的推论是，应用程序可以做的任何事情，用户都可以做。

因此，不必过多担心此类应用程序上的按钮是否“真正”禁用。用户总能找到另一种方法来完成按钮本来应该做的任何事情。（这可能是通过使用注册表编辑器，获取具有相同功能的另一个应用程序，或者，如果没有其他方便，他们可以在调试器中运行应用程序并强制它重新启用按钮。）

适当的解决方案取决于上下文：

*   在许多情况下，最合适的解决方案是停止担心它。你应该能够信任你的用户，如果你不能，那是人力资源问题，而不是技术问题。

*   如果应用程序为在更高环境中运行的东西提供接口，例如防病毒软件的前端，那么安全决策（是否允许用户这样做？）应该发生在后面结尾。也就是说，安全决策需要由不受用户控制的代码来决定。

*   如果您是一名系统管理员，试图锁定一台 kiosk 机器 - 一台将由不受信任的用户使用的机器，通常使用某种类型的单个访客帐户 - 那么您使用 AppLocker 或软件限制策略来定义哪些应用程序允许用户运行。由于 Enabler 和 TurnItOn 不会出现在您的列表中，因此用户将无法运行它们来绕过您的安全策略。

# android - Simple swipe gesture to activity tutorial?

> ID：11833504
> 
> 赞同：13
> 
> 时间：2012-08-06T18:02:24.413
> 
> 标签：android, eclipse, layout, swipe, swipe-gesture

im looking for a turoial with source code on swipe gesutes, I dont want a view pager, I want a swipe gesture tutorial. here is one example I found but doesnt work for me

[http://www.eridem.net/android-tip-010-left-and-right-swipe-gesture-events](http://www.eridem.net/android-tip-010-left-and-right-swipe-gesture-events)

I would like something like this, thanks Please no view pagers

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-06T18:11:33.190

```
 SimpleOnGestureListener mySimpleGestureListener = new SimpleOnGestureListener()
 {

    @Override
    public boolean onDoubleTap(MotionEvent e) { 
        Logout.debug("onDoubleTap");
        return super.onDoubleTap(e);
    }

    @Override
    public boolean onFling(MotionEvent e1, MotionEvent e2, float velocityX,float velocityY) 
    {
        String velocity="onFling: \n" + e1.toString() + "\n" + e2.toString() +"\n"
                + "velocityX= " + String.valueOf(velocityX) + "\n"
                + "velocityY= " + String.valueOf(velocityY) + "\n";
        Logout.debug("onFling velocity="+velocity);
                    return super.onFling(e1, e2, velocityX, velocityY);
    }

    @Override
    public void onLongPress(MotionEvent e) {
        Logout.debug("onLongPress: \n" + e.toString());
        super.onLongPress(e);
    }

    @Override
    public boolean onSingleTapConfirmed(MotionEvent e) {
        Logout.debug("onSingleTapConfirmed: \n" + e.toString());
        return super.onSingleTapConfirmed(e);
    }

    private boolean permissibleYVelocity(float velocityY)
    {
        if ((velocityY < -200) || (velocityY > 200))
        {
            return false;
        }
        else
        {
            return true;
        }

    }
};

GestureDetector myGestureDetector = new GestureDetector(mSimpleOnGestureListener);

View.OnTouchListener mOnListTouchListener = new  OnTouchListener()
{
    @Override
    public boolean onTouch(View view, MotionEvent event)
    {
        Logout.debug("list onTouch()");
         return myGestureDetector.onTouchEvent(event);
    }
}; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-06T18:08:02.503

我会先在谷歌上搜索“Android 基本滑动手势”之类的内容。这就是我所做的，我最终得到了这个主题的热门帖子：[在网格布局上进行手势检测](https://stackoverflow.com/questions/937313/android-basic-gesture-detection)

谷歌的第一个打击是：http: [//pcfandroid.wordpress.com/2011/07/17/swipe-with-android-android-tutorial/](http://pcfandroid.wordpress.com/2011/07/17/swipe-with-android-android-tutorial/)，也适用于你的问题

# c# - Autofac MVC4 动作过滤器注入导致无限循环

> ID：11833507
> 
> 赞同：0
> 
> 时间：2012-08-06T18:02:46.577
> 
> 标签：c#, asp.net-mvc, autofac, action-filter

我遇到了动作过滤器和 Autofac 的问题。我有一个动作过滤器，它使用依赖项来确定是否应该重定向请求。我仅将此过滤器显式应用于控制器操作的子集。重定向将指向未应用此过滤器的操作。但是，过滤器仍然会触发，我最终陷入了无限循环。

**请注意**，下面的代码是一些正在发生的逻辑的骨架。我只想捕捉我遇到的问题。

在我的情况下，具有此属性的控制器是内置控制器。即登录动作。我已经设置了自动过滤器以应用于 FitlerConfig.cs 中的所有操作：

```
public static void RegisterGlobalFilters(GlobalFilterCollection filters)
{
    filters.Add(new AuthorizeAttribute());
    filters.Add(new HandleErrorAttribute());
} 
```

我的过滤器看起来像这样：

```
public class CustomFilter : ActionFilterAttribute
{
    public SomeDependancy MyDependancy { get; set; }

    public override void OnActionExecuting(ActionExecutingContext filterContext)
    {
        if (MyDependancy.ShouldRedirect)
        {
            filterContext.Result = new RedirectToRouteResult("Default",
                new RouteValueDictionary
                {
                    { "controller", "Error" }, { "action", "CustomError" }
                }
            );
        } 

        base.OnActionExecuting(filterContext);
        return;
    }
} 
```

我的帐户控制器：

```
public class AccountController : Controller
{
    [AllowAnonymous]
    [CustomFilter]
    public ActionResult Login(string returnUrl)
    {
        ViewBag.ReturnUrl = returnUrl;
        return View();
    }
} 
```

错误控制器：

```
public class ErrorController : Controller
{
    [AllowAnonymous]
    public ActionResult CustomError()
    {
        return View("CustomError");
    }
} 
```

最后，我的 autofac 注册：

```
var builder = new ContainerBuilder();

builder.Register(con => new SomeDependancy()).AsSelf().InstancePerHttpRequest();

builder.RegisterType<CustomFilter>().As<IActionFilter>().PropertiesAutowired();

// property injection on filters
builder.RegisterFilterProvider();

// Needed to allow property injection in custom action filters.
builder.RegisterType<ExtensibleActionInvoker>().As<IActionInvoker>();

builder.RegisterControllers(typeof(MvcApplication).Assembly).InjectActionInvoker();

var container = builder.Build();
DependencyResolver.SetResolver(new AutofacDependencyResolver(container)); 
```

最终发生的情况是，如果我在 CustomFilter 中设置断点，当我进入登录页面时，断点命中并发生重定向，然后断点再次命中，一次又一次。令我困惑的是，这个动作过滤器并没有应用于那个控制器或动作。

如果我注释掉依赖项并简单地在过滤器中重定向，然后注释掉 autofac 注册，事情就会按预期工作。在点击登录屏幕时，过滤器会触发并重定向到错误页面。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T20:50:36.670

我发现了我的问题。

我查看了 Autofac 的 ExtensibleActionInvoker 的源代码。

[https://code.google.com/p/autofac/source/browse/src/Source/Autofac.Integration.Web.Mvc3/ExtensibleActionInvoker.cs?spec=svn94f70ab10f4d65991c600e2e80171ce4847589e6&r=94f70ab10f4d65991c600e2e80171ce484758](https://code.google.com/p/autofac/source/browse/src/Source/Autofac.Integration.Web.Mvc3/ExtensibleActionInvoker.cs?spec=svn94f70ab10f4d65991c600e2e80171ce4847589e6&r=94f70ab10f4d65991c600e2e80171ce4847589e6)

我在它的构造函数中读到了一条评论，上面写着：

```
/// The following types, if registered in the container, will be added to the
/// filters list:
/// <list>
/// <item><see cref="IActionFilter"/></item>
/// <item><see cref="IAuthorizationFilter"/></item>
/// <item><see cref="IExceptionFilter"/></item>
/// <item><see cref="IResultFilter"/></item>
/// </list> 
```

为了解决我的问题，我最终得到了：

```
var builder = new ContainerBuilder();

builder.Register(con => new SomeDependancy()).AsSelf().InstancePerHttpRequest();

// builder.RegisterType<CustomFilter>().As<IActionFilter>().PropertiesAutowired();

// property injection on filters
builder.RegisterFilterProvider();

// Needed to allow property injection in custom action filters.
builder.RegisterType<ExtensibleActionInvoker>().As<IActionInvoker>();

builder.RegisterControllers(typeof(MvcApplication).Assembly).InjectActionInvoker();

var container = builder.Build();
DependencyResolver.SetResolver(new AutofacDependencyResolver(container)); 
```

事实证明，我不需要注册我的 CustomFilter。这样做似乎会导致 ExtensibleActionInvoker 自动注册为全局过滤器。

# php - CakePHP : Explode POST request data

> ID：11833509
> 
> 赞同：1
> 
> 时间：2012-08-06T18:02:51.433
> 
> 标签：php, cakephp-2.1

I have a Javascript function that invoke a cakephp controller method:

```
$.ajax({   
     type: "POST",
     url: 'http://localhost/cakephp/officepersontasks/add',
     data: { 
         company_id: $("#company_id").val(), 
         person_id: $("#person_id").val(), 
         task_id: "11" 
     },
     success: function(data) {
         alert('Load was performed.'+data);
     }
}); 
```

On the cakeside, the object `$this->request->data` contain sended data, so `$this->OfficePersonTask->save($this->request->data)` will save data against `OfficePersonTask` model. The problem is that data sended got to be splitted, some data will be saved inside a DB table, the rest of data will be saved in a second table? What's the best solution to do this? How can I explode `$this->request->data` object?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T18:41:24.710

像往常一样使用蛋糕 FormHelper 创建您的表单。然后，您将在服务器端代码中执行 a`saveAll`而不是 a`save()`来保存关联的模型。

然后您的 javascript 应更改为：

```
data: $('#myForm').serializeArray(), 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T18:46:58.687

我假设通过拆分对象意味着将对象的部分数据放在一个数组/对象中，而将其他部分放在另一个数组/对象中。您可以创建一个新的数组/对象并用您需要的部分数据填充它。

对于数组，您可以这样做，

```
$new_data[] = $data->company_id;
$new_data[] = $data->person_id;
// now, $new_data has the values in an array. 
```

您也可以轻松地为对象执行此操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-06T18:49:38.970

用 . 命名您的输入字段`data[modelName][fieldNameInTable]`。当我说名称时，我指的是输入的名称字段。那么蛋糕应该直接保存！

# php - MySQL+PHP：优化排名查询和计数子查询

> ID：11833510
> 
> 赞同：4
> 
> 时间：2012-08-06T18:02:52.837
> 
> 标签：php, mysql, count, subquery, rank

这是原始数据，希望根据分数（count(tbl_1.id)）对它们进行排名。

```
[tbl_1]
===========
id | name  
===========
1  | peter
2  | jane
1  | peter
2  | jane
3  | harry
3  | harry
3  | harry
3  | harry
4  | ron 
```

所以制作临时表（tbl_2）来计算每个id的分数。

```
SELECT id, name, COUNT( id ) AS score
FROM tbl_1
GROUP BY id
ORDER BY score DESC;
LIMIT 0, 30; 
```

然后结果是；

```
[tbl_2]
===================
id | name  | score
===================
3  | harry | 4
1  | peter | 2
2  | jane  | 2
4  | ron   | 1 
```

然后查询这个；

```
SELECT v1.id, v1.name, v1.score, COUNT( v2.score ) AS rank
FROM votes v1
JOIN votes v2 ON v1.score < v2.score
OR (
v1.score = v2.score
AND v1.id = v2.id
)
GROUP BY v1.id, v1.score
ORDER BY v1.rank ASC, v1.id ASC
LIMIT 0, 30; 
```

然后结果是；

```
==========================
id | name  | score | rank
==========================
3  | harry | 4     |  1
1  | peter | 2     |  2
2  | jane  | 2     |  2
4  | ron   | 1     |  4 
```

是否可以在一个事务（查询）中很好地做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T18:49:50.740

是的，可以在单个查询中执行此操作。但这在 MySQL 中完全是一个毛球，因为 MySQL 没有简单的 ROWNUM 操作，并且您需要一个来进行排名计算。

这是您的投票查询，其中显示了排名。@ranka 变量用于对行进行编号。

```
SELECT @ranka:=@ranka+1 AS rank, id, name, score
  FROM
  (
     SELECT id, 
            name, 
            COUNT( id ) AS score
       FROM tbl_1
       GROUP BY id
       ORDER BY score DESC, id
   ) votes,
  (SELECT @ranka:=0) r 
```

正如您已经发现的那样，您需要自行加入这个东西以获得正确的排名（正确处理关系）。因此，如果您进行查询并将对`votes`表的两个引用替换为各自版本的此子查询，您将获得所需的内容。

```
SELECT v1.id,
       v1.name,
       v1.score,
       COUNT( v2.score ) AS rank
  FROM (
         SELECT @ranka:=@ranka+1 AS rank,
                id,
                name,
                score
           FROM
              (
                SELECT id,
                       name,
                       COUNT( id ) AS score
                  FROM tbl_1
                 GROUP BY id
                 ORDER BY score DESC, name
               ) votes,
         (SELECT @ranka:=0) r) v1
  JOIN (
         SELECT @rankb:=@rankb+1 AS rank, 
                id, 
                name, 
                score
           FROM
              (
                SELECT id,
                       name,
                       COUNT( id ) AS score
                  FROM tbl_1
                  GROUP BY id
                  ORDER BY score DESC, name
              ) votes,
        (SELECT @rankb:=0) r) v2 
    ON (v1.score < v2.score) OR 
       (v1.score = v2.score  AND v1.id = v2.id)
 GROUP BY v1.id, v1.score
 ORDER BY v1.rank ASC, v1.id ASC
 LIMIT 0, 30; 
```

告诉你这是一个毛球。请注意，您需要在两个版本的自联接子查询中使用不同的 @ranka 和 @rankb 变量，以使行编号正常工作：这些变量在 MySQL 中具有连接范围，而不是子查询范围。

[http://sqlfiddle.com/#!2/c5350/1/0](http://sqlfiddle.com/#!2/c5350/1/0)显示了这个工作。

**编辑：**使用 PostgreSQL 的 RANK() 函数更容易做到这一点。

```
SELECT name, votes, rank() over (ORDER BY votes)
  FROM (
        SELECT name, count(id) votes
          FROM tab
         GROUP BY name
       )x 
```

[http://sqlfiddle.com/#!1/94cca/18/0](http://sqlfiddle.com/#!1/94cca/18/0)

# git - git + 部署到生产环境

> ID：11833511
> 
> 赞同：3
> 
> 时间：2012-08-06T18:02:58.323
> 
> 标签：git

我对 git 还很陌生，想知道部署到生产环境时的最佳实践吗？我有一个 master 分支，它总是有最新版本的生产代码。当我开始生产时（现在我手动进行），我输入`git pull`并获取最新的。但它会尝试**合并**代码，有时会产生冲突等。有没有办法强制它按原样采用 master 分支中的任何内容？

我尝试阅读很多内容，包括：

[从 git 部署到生产的最佳解决方案？](https://stackoverflow.com/questions/3853194/best-solutions-to-deploy-from-git-to-production)

[http://posheika.net/?p=136](http://posheika.net/?p=136)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T18:09:15.933

尝试使用`git fetch origin`and`git reset --hard whatever_deployment_branch_you_use`而不是拉动。

这将使存储库不会尝试合并代码，因此您将避免服务器上的冲突。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T18:09:18.653

一种简单而可靠的方法是在`master`您的所有开发中建立一个分支。`development`如果您想更准确地反映分支的用途，可以选择将此分支重命名为。

然后，您将拥有另一个`production`始终反映生产环境中当前运行的内容的分支。每当您想部署到生产环境时，您都可以签出您的`production`分支并运行`git merge master`. 您还可以将标签应用到提交 SHA 中`master`，以便更轻松地查看您部署的时间点。

通过这样做，您可以修复开发箱上的所有合并冲突，并且您可以在生产箱上运行`git pull`，它会从`production`.

[这](http://nvie.com/posts/a-successful-git-branching-model/)是上述流程的一种更高级（可能更复杂）的替代方案。如果您有多个开发人员和/或需要更复杂的发布周期，请使用此选项。

# jquery - jQuery Datables 正则表达式搜索和侦听器

> ID：11833515
> 
> 赞同：2
> 
> 时间：2012-08-06T18:03:08.277
> 
> 标签：jquery, datatables, pipe, listeners

我正在使用 jQuery Datatables，我很好奇是否有人遇到过这个问题以及可能的本地解决方法。过滤时，通过搜索框并使用正则表达式搜索，我发现管道似乎破坏了搜索框上的侦听器。我目前有一个有几行的表。如果我输入以下内容：

add => 显示所有带有字符串 add 的条目（预期） build => 显示所有带有字符串 build 的条目（预期

听众通过寻找一个字符串来工作。如果我输入：

添加| => 侦听器似乎在管道上中断。如下所示：

add|b => 不采取任何行动。（意外）

它继续只显示添加的结果。但是，如果我在添加字符 b （或管道后的任何字符）后退格，则侦听器会重新打开。因此，如果我在 b 上使用“add|b”退格键，然后继续处理第二个字符串：

add|build => 它按预期工作。

我可以通过脚本添加|构建进行过滤，它也可以正常工作。IE：

```
$("#tblReport_filter").children("label").children("input").attr("value",searched); 
```

我读过了：

[http://datatables.net/development/filtering](http://datatables.net/development/filtering)

我知道我可以开发一个插件来处理这个问题。如果可能的话，我想避免这种情况。有没有人看到管道在数据表中破坏了一个（我假设是 keyup）监听器？有没有开箱即用的方法来解决它？

谢谢。

# maven-2 - 在 Maven 2 中重新编译依赖项

> ID：11833522
> 
> 赞同：0
> 
> 时间：2012-08-06T18:03:49.190
> 
> 标签：maven-2, maven-plugin

在 webapp 的 pom 中，我正在寻找一种方法来重新编译两个依赖项的本地源代码，然后将这些 jar 复制到 webapp 的 WEB-INF/lib 目录。是否有 Maven 2 插件可以让我这样做，或者使用 Maven 2 的更好方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T18:07:57.747

我不知道是否有一种简单的方法可以做到这一点。

一种解决方案是将所有三个项目放在一个反应​​器中（一个带有 的项目），当调用反应器项目时，它们将按正确的顺序构建。

# iphone - cocos2d v2上如何使用CCTextField或添加UITextField

> ID：11833524
> 
> 赞同：0
> 
> 时间：2012-08-06T18:03:51.757
> 
> 标签：iphone, ios, cocos2d-iphone, uitextfield

我目前正在尝试在 cocos2d v2 层上永久显示 TextField。

我正在使用这个 CCTextField，因为它看起来很容易使用：[https ://github.com/iNinja/CCTextField](https://github.com/iNinja/CCTextField)

该插件对于 cocos2d v2 来说有点旧，所以我更新了不推荐使用的方法，但我仍然无法显示任何文本字段......

我想如何用 cocos2d v2 显示一个文本字段（只要它足够清晰且易于使用，任何方法都可以）。

顺便说一句，我在 Google 上查看并在 stackoverflow 和论坛上找到了 2-3 个答案。但是，它们适用于 cocos2d v1（或更早版本），根本不起作用（或不够清楚）。

**编辑**

这就是我在班级的 onEnter 函数中所拥有的

```
 UITextField *tf = [[UITextField alloc] initWithFrame:CGRectMake(200, 200, 150, 50)];
tf.delegate = self;
tf.textAlignment = UITextAlignmentLeft;

[[[CCDirector sharedDirector] view] addSubview:tf]; 
```

这是.h

```
@interface AdventureLayer : CCLayer <UITextFieldDelegate> 
```

什么都没有出现在任何地方...

**编辑 2**

哈哈哈！实际上 TextField 是不可见的！因此占位符非常有用

```
 tf.placeholder = @"FOOBAR"; 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-06T22:08:16.047

Cocos2d 2.0 使得添加 UIKit 元素变得非常容易，因为 CCDirector 实际上是一个 UIViewController。

在代码中创建一个 UITextField ，然后执行以下操作

```
 UITextField *aTextField = ...
 [[CCDirector sharedDirector] view] addSubview:aTextField]; 
```

请记住，它的坐标系从左上角开始，而不是像 cocos2d 那样从左下角开始。

# perl - perl 的 while(<@array>) 效果

> ID：11833526
> 
> 赞同：8
> 
> 时间：2012-08-06T18:03:52.967
> 
> 标签：perl, while-loop

```
while(<@thisArray>) 
```

有谁知道这到底会做什么？我们只是在讨论它，因为它的代码通常是这样的：

```
while(<STDIN>) 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-06T18:14:39.067

它将遍历与`@thisArray`.

转换为的`perl -MO=Deparse -e '1 while(<@thisArray>)'`显示结果：`<>`[`glob`](http://perldoc.perl.org/functions/glob.html)

```
use File::Glob ();
'???' while defined($_ = glob(join($", @thisArray))); 
```

从[`glob`](http://perldoc.perl.org/functions/glob.html)手册：

> 在标量上下文中，glob 遍历此类文件名扩展，当列表用完时返回 undef。

默认值为`$"`空格，因此来自的多个模式`@thisArray`将被连接成单个字符串，然后在内部被空格拆分`glob`：

> 请注意，glob 在空格上拆分其参数并将每个段视为单独的模式。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-06T18:14:04.387

`<@thisArray>`作为`glob(@thisArray)`. 因此它给出了与数组成员匹配的所有文件的列表。

如果数组的元素与文件不匹配，则返回元素本身。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-08-06T18:19:11.177

见[perlop](http://p3rl.org/perlop#I/O-Operators)：

> 如果尖括号中的内容既不是文件句柄，也不是包含文件句柄名称、typeglob 或 typeglob 引用的简单标量变量，则将其解释为要通配的文件名模式

# r - 使用 glm 的条件预测概率

> ID：11833528
> 
> 赞同：0
> 
> 时间：2012-08-06T18:04:05.330
> 
> 标签：r

简单的问题我想不通。我正在尝试从包含交互的模型中生成条件预测概率。例如，我希望能够将 x2==1 和 x3==0 时的预测概率与 x2==0 和 x3==1 时的预测概率进行比较。

我正在尝试按以下方式执行此操作：

```
model <- glm(y~x1 + x2 * x3, family=binomial(link="logit"), data=data)
predprob1 <- predict(model, type="response", newdata=(x1=mean(x1) & x2==1 & x3==0))
predprob2 <- predict(model, type="response", newdata=(x1=mean(x1) & x2==0 & x3==1))
probdiff<-predprob1-predprob2 
```

之后，我需要计算概率差异的 95CI。我相信这对你们 R 天才来说很简单。谢谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T18:33:15.083

也许（在没有工作示例的情况下未经测试）：

```
model <- glm(y~x1 + x2 * x3, family=binomial(link="logit"), data=data)
predprob1 <- predict(model, type="response", 
                     newdata=with(data, data.frame(x1=mean(x1) & x2=1 & x3=0))
predprob2 <- predict(model, type="response", 
                     newdata=with(data, data.frame(x1=mean(x1) & x2=0 & x3=1))
probdiff <- predprob1-predprob2 
```

另一个 R 错误是使用 '==' 进行赋值。它用于逻辑测试。

# c++ - Xilinx Microblaze 结构填充/封装

> ID：11833534
> 
> 赞同：-1
> 
> 时间：2012-08-06T18:04:53.367
> 
> 标签：c++, c, gcc, xilinx, microblaze

我有两个结构：

```
Struct _size1 {
    union{
           short a;
           struct {
                    char b;
                    char c;
            }d;
            struct {
                     char x; 
                     char y;
            }z;
     };

     union{
            short a1;
            struct {
                    char b1;
                    char c1;
            }d1;
            struct {
                     char x1; 
                     char y1;
            }z1;
      };
}size1; 
```

和：

```
Struct _size2 {
    short num; //2 bytes
    short num2; //2 bytes
    short num3; //2 bytes
    size1 st_size; //4 bytes

}size2; 
```

sizeof(size1) = 4; sizeof(size2) = 12;

我试图获得的尺寸是 size2 的 10。

它在 num3 和 st_size 之间添加两个字节的填充。Microblaze 编译器不支持 Pragma Pack

我正在尝试使用**属性**((packed)) 但没有任何成功...

```
Struct _size2 {
    short num; //2 bytes
    short num2; //2 bytes
    short num3; //2 bytes
    size1 st_size; //4 bytes

}size2 __attribute__((packed)); 
```

我不确定出了什么问题，或者这是否有效。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T18:18:44.513

您`unsigned int`在 gcc / Microblaze 上使用的是 4 字节的位字段类型。

使用 gcc 实现定义的`unsigned short`位域类型，在 gcc / Microblaze 中具有 2 个字节的大小。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-08-10T14:04:31.043

我在我的一个头文件中成功地使用它来描述以太网头：

```
struct eth_hdr_st {
    unsigned char dst_addr[6];
    unsigned char src_addr[6];
    unsigned short datatype;
} __attribute__ ((__packed__)); 
```

然后我像这样使用它：

```
struct eth_hdr_st eht_header; 
```

请注意，第一部分是名为 的结构的结构定义`eth_hdr_st`；第二部分是一个名为`eth_header`, 类型的变量的声明`struct eth_hdr_st`

您的代码中的问题是您将这些部分混合在一起，并试图应用于`__attribute__((packed))`名为`size2`.

# python - 如何正确包含与 python 拟合的不确定性

> ID：11833538
> 
> 赞同：7
> 
> 时间：2012-08-06T18:04:59.853
> 
> 标签：python, curve-fitting

我正在尝试在 python 中拟合一些具有 y 不确定性的数据点。数据在 python 中标记为 x、y 和 yerr。我需要对 loglog 尺度的数据进行线性拟合。如果拟合结果正确，作为参考，我将 python 结果与 Scidavis 的结果进行比较

我试过curve_fit

```
def func(x, a, b):
    return np.exp(a* np.log(x)+np.log(b))

popt, pcov = curve_fit(func, x, y,sigma=yerr) 
```

以及 kmpfit 与

```
def funcL(p, x):
   a,b = p
   return ( np.exp(a*np.log(x)+np.log(b)) )

def residualsL(p, data):
   a,b=p
   x, y, errorfit = data
   return (y-funcL(p,x)) / errorfit

a0=1
b0=0.1
p0 = [a0,b0]
fitterL = kmpfit.Fitter(residuals=residualsL, data=(x,y,yerr))
fitterL.parinfo = [{}, {}]
fitterL.fit(params0=p0) 
```

当我尝试将数据与其中一个没有不确定性的数据（即设置 yerr=1）进行拟合时，一切正常，结果与 scidavis 的结果相同。但是，如果我将 yerr 设置为数据文件的不确定性，我会得到一些令人不安的结果。在 python 中，我得到 a=0.86，在 scidavis 中得到 a=0.14。我读到了一些关于错误包含在权重中的内容。为了正确计算适合度，我是否必须进行任何更改？或者我做错了什么？

编辑：这里是一个数据文件的例子 (x,y,yerr)

```
3.942387e-02    1.987800e+00    5.513165e-01
6.623142e-02    7.126161e+00    1.425232e+00
9.348280e-02    1.238530e+01    1.536208e+00
1.353088e-01    1.090471e+01    7.829126e-01
2.028446e-01    1.023087e+01    3.839575e-01
3.058446e-01    8.403626e+00    1.756866e-01
4.584524e-01    7.345275e+00    8.442288e-02
6.879677e-01    6.128521e+00    3.847194e-02
1.032592e+00    5.359025e+00    1.837428e-02
1.549152e+00    5.380514e+00    1.007010e-02
2.323985e+00    6.404229e+00    6.534108e-03
3.355974e+00    9.489101e+00    6.342546e-03
4.384128e+00    1.497998e+01    2.273233e-02 
```

结果：

```
in python: 
   without uncertainties: a=0.06216 +/- 0.00650 ; b=8.53594 +/- 1.13985
   with uncertainties: a=0.86051 +/- 0.01640 ; b=3.38081 +/- 0.22667 
in scidavis:
   without uncertainties: a  = 0.06216 +/- 0.08060; b  = 8.53594 +/- 1.06763
   with uncertainties: a  = 0.14154 +/- 0.005731; b  = 7.38213 +/- 2.13653 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T18:20:54.293

我一定是误会了什么。您发布的数据看起来不像

```
f(x,a,b) = np.exp(a*np.log(x)+np.log(b)) 
```

红线是 的结果`scipy.optimize.curve_fit`，绿线是 scidavis 的结果。

我的猜测是这两种算法都没有收敛到一个很好的拟合，所以结果不匹配也就不足为奇了。

* * *

我无法解释 scidavis 如何找到它的参数，但根据*我理解*的定义，`scipy`正在寻找最小二乘残差低于的参数`scidavis`：

```
import numpy as np
import matplotlib.pyplot as plt
import scipy.optimize as optimize

def func(x, a, b):
    return np.exp(a* np.log(x)+np.log(b))

def sum_square(residuals):
    return (residuals**2).sum()

def residuals(p, x, y, sigma):
    return 1.0/sigma*(y - func(x, *p))

data = np.loadtxt('test.dat').reshape((-1,3))
x, y, yerr = np.rollaxis(data, axis = 1)
sigma = yerr

popt, pcov = optimize.curve_fit(func, x, y, sigma = sigma, maxfev = 10000)
print('popt: {p}'.format(p = popt))
scidavis = (0.14154, 7.38213)
print('scidavis: {p}'.format(p = scidavis))

print('''\
sum of squares for scipy:    {sp}
sum of squares for scidavis: {d}
'''.format(
          sp = sum_square(residuals(popt, x = x, y = y, sigma = sigma)),
          d = sum_square(residuals(scidavis, x = x, y = y, sigma = sigma))
      ))

plt.plot(x, y, 'bo', x, func(x,*popt), 'r-', x, func(x, *scidavis), 'g-')
plt.errorbar(x, y, yerr)
plt.show() 
```

产量

```
popt: [ 0.86051258  3.38081125]
scidavis: (0.14154, 7.38213)
sum of squares for scipy:    53249.9915654
sum of squares for scidavis: 239654.84276 
```

![在此处输入图像描述](../Images/513f526e4ad425df4ff1c7a46d4a4825.png)

# python-2.7 - pyspeech 在 python 2.7 中不起作用

> ID：11833542
> 
> 赞同：0
> 
> 时间：2012-08-06T18:05:16.563
> 
> 标签：python-2.7

我想使用 python 制作和探索语音到文本。所以我在谷歌上搜索了关于 python Speech to text api 我一开始就发现了 pyspeech 并发现它很容易使用，但即使在安装它之后我也遇到了一些问题。

1）我已经在 c:>python27...scripts 使用命令提示符 easy_install 语音安装了 pyspeech，但我仍然无法运行 python 语音 API。

2) 我还安装了运行 ez_setup.py 的 pyspeech 所需的基本 PyPI。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T04:29:04.420

你得到什么导入错误？pyspeech 也需要 pywin32。那个包安装了吗？还要检查是否安装了 Microsoft 语音工具包。

如果一切正常，请在代码顶部添加 sys.path.append(site package path)。

# ruby - Ruby 不允许动态字符串作为参数

> ID：11833548
> 
> 赞同：1
> 
> 时间：2012-08-06T18:05:39.337
> 
> 标签：ruby, datamapper

我已经通过 DataMapper 映射出一个类并在数据库中，现在我正试图将我的第一个资源放入数据库中。

我有一个处理表单数据和文件内容的类。在那个类中，我正在创建第一个`@variables`从参数传入的资源。传递到此资源的所有其他参数都来自`@variables`具有表单值的参数。在这种情况下，`@url`所讨论的变量 被设置为仅在几行之前的值。现在当我输入网址时：

```
rec = Post.new(
      # more args
      :filename_ogg => @url
)
rec.save 
```

这就是杀手锏：这个文件中的每一行代码都可以`@url`通过一个全局变量 ( `$upload = Upload.new(file)`) 访问 ，除了这个资源创建者。在节省资源方面，它没有通过。但是，当我用`@url`“RANDOM URL”之类的静态字符串替换时，它工作得很好。为什么？

这已经在 Ubuntu 12.04 下的 MRI 1.9.3 和 JRuby 1.6.7.2（1.9 模式）下进行了测试：

```
# #{user} edited out
class Upload
    attr_accessor :file, :filename, :filename_ogg, :status, :title, :desc, :url

    def initialize(file)
        @file = file
        @filename = @file[:filename].gsub(" ", "")
        @filename_ogg = "#{@filename}.ogg"
        #@url = "http://s3.amazonaws.com/#{user}/#{@filename_ogg}"

    end

    def downandup
        # code
    end

    def convert(file, file_ogg)
        # code
    end

    def upload(file_ogg)
        # code
        @url = "http://s3.amazonaws.com/#{user}/#{file_ogg}"

        # title and desc are accessed through $upload.title/$upload.desc
        rec = Post.new(
            :title => @title,
            :description => @desc,
            :author_id => Random.rand(5),
            :time_uploaded => Time.now,
            :filename_ogg => @url,
            :comments_table => Random.rand(10),
        )
        rec.save
    end
end 
```

该文件运行良好，但是当DataMapper将其放入数据库时​​，它不会进入，但是当替换为静态字符串时，数据会被存储。

# asp.net-mvc - IIS 对 MVC 站点说“正在建设中”

> ID：11833549
> 
> 赞同：1
> 
> 时间：2012-08-06T18:05:47.953
> 
> 标签：asp.net-mvc, vb.net, asp.net-mvc-3, iis

[我已经按照http://www.asp.net/mvc/tutorials/older-versions/deployment/using-asp-net-mvc-with-different-versions-of-iis-vb](http://www.asp.net/mvc/tutorials/older-versions/deployment/using-asp-net-mvc-with-different-versions-of-iis-vb)中的描述创建了路由；但是，我的网站仍然没有出现。相反，它显示，“正在建设中您尝试查看的站点当前没有默认页面。它可能正在升级和配置过程中。请稍后再试此站点。如果仍然遇到问题，请尝试联系网站管理员。”

我该如何解决这个问题，以便我的 MVC 站点出现？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T18:30:18.097

尝试在 IIS 6 上运行 MVC 时可能会出现很多错误，但 Phil Haack 有 2 篇关于此的精彩博客文章，[一个通用版本](http://haacked.com/archive/2008/11/26/asp.net-mvc-on-iis-6-walkthrough.aspx)，[另一个如果您正在运行 .NET 4.0](http://haacked.com/archive/2010/12/22/asp-net-mvc-3-extensionless-urls-on-iis-6.aspx)

不过，我要开始做几件事，您是否取消选中下图所示的框？就像他在博客中提到的那样，很容易错过并且会阻止系统工作。

![在此处输入图像描述](../Images/942f789b8665fc1b2466f104c4607d4c.png)

# objective-c - 使用GCDASyncSocket时如何分隔数据包

> ID：11833551
> 
> 赞同：2
> 
> 时间：2012-08-06T18:06:05.260
> 
> 标签：objective-c, ios, tcp, gcdasyncsocket

谁能帮我？我使用 GCDAsyncSocket 通过 TCP 协议在两个设备之间集中交换数据。我发送这样的数据：

```
 NSMutableDictionary *packet = [[[NSMutableDictionary alloc] init] autorelease];
     [packet setObject:[NSNumber numberWithInt:MultiPlayerTypeInfoNextRoundConfirm] forKey:@"type_info"];
     [packet setObject:[NSNumber numberWithBool:YES] forKey:@"connection_confirmation"];
     NSMutableData *data = [[NSMutableData alloc] initWithData:[NSKeyedArchiver archivedDataWithRootObject:packet]]; //[NSKeyedArchiver archivedDataWithRootObject:packet];

     if (currentGameMode == GameModeServer)
        [(ServerMultiplayerManager *)multiplayerManager sendNetworkPacket:data withTag:MultiPlayerTypeInfoNextRoundConfirm];

- (void)sendNetworkPacket:(NSData *)data withTag:(long)tag
{
[asyncSocket writeData:data withTimeout:-1 tag:tag];
}

- (void)socket:(GCDAsyncSocket *)sock didWriteDataWithTag:(long)tag
{
   NSLog(@"DID WRITE DATA tag is %ld", tag);

   [sock readDataWithTimeout:-1 tag:0];
} 
```

我读到这样的数据：

```
- (void)socket:(GCDAsyncSocket *)sender didReadData:(NSData *)data withTag:(long)tag
{
 NSString *receivedInfo = [[[NSString alloc] initWithData:data encoding:NSUTF8StringEncoding] autorelease];

 [info_data setData:data];

NSLog(@"DID READ DATA WITH TAG %ld", tag);

if ([receivedInfo isEqualToString:ROOM_FILLED])
{
   isMaster = (tcpRequest.identifier == MASTER_CHAR);
    NSLog(@"IS MASTER SET %d", isMaster);

   [multiplayerDelegate setGameModeServer];
   [multiplayerDelegate startGame];
}
else
   [self dataProcessing:info_data];

[sender readDataWithTimeout:-1 tag:0];
}

- (void)dataProcessing:(NSData *)data
 { 
   NSDictionary        *dict       = [NSKeyedUnarchiver unarchiveObjectWithData:data];
  MultiPlayerTypeInfo  typeInfo   = [[dict objectForKey:@"type_info"] intValue];
} 
```

我的问题是这些数据包被弄乱了。假设一个标有标签 10 的数据包在接收器设备上被读取为标有标签 11 的数据包，该数据包是在数据包 10 之后立即发送的，并且在取消归档实际数据包 11 时`NSKeyedUnarchiver`会抛出异常`Incomprehensible archive`。

据我了解，我应该以某种方式分离数据包。我尝试将分隔符号附加到正在发送的数据中：

```
[data appendData:[@"\r\n" dataUsingEncoding:NSUTF8StringEncoding]]; 
```

并尝试像这样阅读它：

```
[socket readDataToData:[GCDAsyncSocket CRLFData] timeout:-1 tag:some_tag]; 
```

但这没有帮助。我做错了什么，我应该怎么做？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-07T06:19:26.750

我猜，你误解了标签的作用。`GCDAsyncSocket`是（顾名思义）一个**异步**套接字。该标签可帮助您将接收到的数据与接收顺序进行匹配，并将发送成功与发送顺序进行匹配。

例如，如果你想发送数据，你使用`writeData:messageA withTimeout:-1 tag: tagA`（或类似的东西）给你的套接字命令**在不久的将来某时**发送。现在不一定。并且您可以**立即**下一个命令以发送另一条消息，例如`messageB`使用 tag `tagB`。要知道，`messageA`确实已发送，您会通过 收到通知`socket:aSocket didWriteDataWithTag:aTag`。在这里，发送`aTag`了`tagA`if`messageA`的值，以及发送了`tagB`if的值`messageB`。标签**不**随消息一起发送；它只帮助您识别您的订单。

在接收方也是如此。您下订单接收（有时）一些数据并为该订单分配一个标签。收到数据后，通知（通过）会显示标签，让您知道哪个订单成功**。**`socket:didReadData:withTag:`

您可以将标签用于一些语义信息并将其放入您的消息中。但即便如此，通知中的标签是**接收订单**的标签，而不是**发送订单**的标签。如果您想在接收方使用您放入消息中的标签，您必须首先接收（至少部分）消息并解析它。

来到您问题的核心：您基本上有两种可能性知道，哪种数据正在到达：

1.  知道发送数据的顺序并以相同的顺序接收它。
2.  使用标识数据类型的消息头。仅接收头部并根据头部数据接收和解析消息的剩余部分。

**编辑**

这是第二种方法的示例。假设您可以发送多个 A、B 类等对象。您的标头可能包括数据的类型和大小：

```
 typedef struct {
            NSUInteger type_id;
            NSUInteger size;
      } header_t;

      #define typeIdA   1
      #define typeIdB   2
      // ... 
```

一旦你想`obj`用 objKey 发送一个对象：

```
 NSMutableData *data = [NSMutableData data];
     NSKeyedArchiver *archiver = [[NSKeyedArchiver alloc] initForWritingWithMutableData:data];
     [archiver encodeObject:obj forKey: objKey];

     header_t head;
     if ([obj class] == [A class]) {
        head.type_id = typeIdA;
     } else if ([obj class] == [B class]) {
        head.type_id = typeIdB;
     } else ...

     // ....

     header.size = data.lengh;
     NSData* headData = [NSData dataWithBytes: &header length: sizeof(header)];

     dataWithBytes:length:
     header = NSData.length;
     [asyncSocket writeData:headData withTimeout:-1 tag:headTag];
     [asyncSocket writeData:data withTimeout:-1 tag:dataTag]; 
```

如果需要，您可以收到有关成功发送或错误的通知，但我在这里跳过。在接收方，您首先需要一个标头：

```
 [receiveSocket readDataToLength:sizeof(header_t) withTimeout:-1 tag:rcvHdrTag];
    // rcvHdrTag must not match one of the typeIdX tags 
```

在你的`socket:didReadData:withTag:`你必须区分，如果你得到标题或遗体（接收遗体是从这里开始的！）

```
 - (void)socket:(GCDAsyncSocket *)aSocket didReadData:(NSData *)data withTag:(long)tag {
        header_t head;
        id obj;
        id key;

       switch (tag) {
           case rcvHdrTag:
               [data getBytes:&head length:sizeof(header)];
               // now you know what to receive
               [aSocket readDataToLength:header.size withTimeout:-1 tag:header.type];
               return;
               break; // I know, redundancy :-)
          case typeIdA:
               objKey = objKeyA;   // whatever it is...
               break;
          case typeIdB:
               objKey = objKeyB;   
               // ....
       }
       NSKeyedUnarchiver *unarchiver = [[NSKeyedUnarchiver alloc] initForReadingWithData:data];
       obj = [unarchiver decodeObjectForKey:objKey];

       // store your object ...
   } 
```

这不是最优雅的例子，它忽略了档案中的对象树和对象间的依赖关系，但你应该明白这一点。

# vb.net - msstdfmt.dll 1.0.0 丢失错误

> ID：11833553
> 
> 赞同：3
> 
> 时间：2012-08-06T18:06:09.813
> 
> 标签：vb.net, winforms, visual-studio-2010, windows-7, vb6

今天给了我一些需要转换的旧代码。我正在运行win7 64，我的机器上有VS10,11,12 Ultimate，刚刚下载并安装了VS2008 Express。当我尝试转换代码时，我得到了 MSSTDFMT.dll(microsoft Data Formating object libary 1.0.0) 丢失的错误。我怀疑那里有一个 Vb6 供我安装，有人知道如何转换它吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-08T15:21:12.127

我最近在我的一个 VB6 应用程序中遇到了类似的问题。

`MSSTDFMT.DLL`在 Windows Vista/7/8 上默认不安装。您将需要从另一个系统获取副本，将其放入本地 system32 文件夹并对其应用 regsvr。

请参阅[http://msdn.microsoft.com/en-us/vstudio/ms788708.aspx](http://msdn.microsoft.com/en-us/vstudio/ms788708.aspx)了解与 Vista/7/8 一起安装/未安装的 VB6 相关文件的 maxtrix。

# objective-c - 如何以编程方式检测 iOS 中是否开启背光？

> ID：11833557
> 
> 赞同：2
> 
> 时间：2012-08-06T18:06:37.297
> 
> 标签：objective-c, ios, backlight

我想要可以显示屏幕是否亮起的 iOS 代码，以便我的应用程序可以监控由于（耗电）背光活动而导致的电池电量消耗。此代码必须仅使用公共 API，因为我打算最终将应用程序提交到 App Store。

最初我认为这可能只是检查UIScreen的[亮度属性的问题，如下所示：](https://developer.apple.com/library/ios/#DOCUMENTATION/UIKit/Reference/UIScreen_Class/Reference/UIScreen.html#//apple_ref/occ/instp/UIScreen/brightness)

```
-(BOOL)isBackLightOn {
    float brightness = [UIScreen mainScreen].brightness;
    return brightness > 0;
} 
```

但这是**不正确**的，因为它`[UIScreen mainScreen].brightness`代表的是用户在 Settings->Brightness 屏幕中选择的滑块的值，而**不是**屏幕的当前光输出。

Apple 显然有办法确定这个值，因为它包含在可以在 Instruments 中查看的能源诊断中（例如，请参阅[Logging Energy Usage in an iOS Device](https://developer.apple.com/library/ios/#recipes/instruments_help-energy-measurement-help/Logging_Energy_Usage_in_an_iOS_Device/10_Logging_Energy_Usage_in_an_iOS_Device.html)），但也许这个测量没有通过公共 API 公开？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-04T07:14:45.280

首先，我尝试了@Flipper 的答案，但这对我没有多大帮助，然后我对此进行了研发，并且我找到了使用以下代码的解决方案

```
 NSLog(@"%f", [[[NSMutableDictionary dictionaryWithContentsOfFile:@"/var/mobile/Library/Preferences/com.apple.springboard.plist"] objectForKey:@"SBBacklightLevel2"] floatValue]); 
```

它给了我浮点值，设备的当前亮度级别

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T18:19:51.707

一个可能对您有所帮助的问题是：

[更改背光级别，iPhone](https://stackoverflow.com/questions/1777470/changing-backlight-level-iphone?rq=1)

似乎如果你包括这个：

```
#include "GraphicsServices.h" 
```

然后使用这样的东西：

```
NSNumber *bl = (NSNumber*) CFPreferencesCopyAppValue(CFSTR("SBBacklightLevel" ), CFSTR("com.apple.springboard"));
float previousBacklightLevel = [bl floatValue]; 
```

应该给你背光级别。请记住，屏幕总是会有某种形式的背光。

# sql - 有没有更好的方法来执行不使用游标的动态 SQL？

> ID：11833561
> 
> 赞同：1
> 
> 时间：2012-08-06T18:06:53.130
> 
> 标签：sql, sql-server-2005, cursor, execute, dynamic-sql

我将动态 SQL 存储在必须在某些条件下执行的 SQL 表中。目前，我们使用游标来为我们处理这个问题，但我总是被告知尽可能避免使用游标，因为它们不是最有效的做事方式。所以，我的问题是：我如何在没有它们的情况下执行动态 SQL（如果有办法的话）？整个系统是围绕这个动态的 SQL 混乱构建的，所以没有改变它。

为此，只需假设表有`Id AS IDENTITY`和`SQL AS VARCHAR`字段，其中 SQL 字段包含要执行的 SQL（显然）。

**编辑：** 基本上，我想遍历表并在 SQL 列中执行 SQL。

因此，表中的一行基本上如下所示：

```
ID   SQL
--   ----------------------
1    SELECT * FROM RECORD
2    SELECT * FROM PERSON
3    SELECT * FROM LOCATION 
```

我没有写任何代码，因为我写的是一个游标来遍历表并执行它。我只是不知道循环表并将该字符串作为 SQL 查询执行的任何其他方法，例如：

```
DECLARE @sql VARCHAR(MAX)

DECLARE _cursor CURSOR
FOR
    SELECT  [SQL]
    FROM    #tmp2

OPEN _cursor

FETCH NEXT FROM _cursor INTO @sql

WHILE @@FETCH_STATUS = 0 
    BEGIN
        PRINT ( @sql )
    END
CLOSE _cursor   
DEALLOCATE _cursor 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T19:03:14.100

您可以使用任意数量的连接技巧来制作一个大批量，而无需使用游标，我个人经常使用该`FOR XML`技巧。

这是一个概述：

[http://www.simple-talk.com/sql/t-sql-programming/concatenating-row-values-in-transact-sql/](http://www.simple-talk.com/sql/t-sql-programming/concatenating-row-values-in-transact-sql/)

但是，游标（虽然通常是代码味道）不会对它的非性能造成可怕的影响。并且您将有机会比单个批次更容易处理错误等。

此外，如果您在某些必须是批处理中的第一个语句的语句中有 DDL，那么您需要分批提交它们。EXEC 或 sp_executesql 没有像 SSMS 那样实现任何批处理拆分具有 GO 批处理分隔符。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-06T18:54:58.107

忽略整个架构中的根本缺陷......

```
declare @sql nvarchar(max) 
   select @sql = '' 
   select @sql = @sql + SQL + ';' from #tmp2  

   exec sp_executesql @sql 
```

至少我们现在已经摆脱了你的光标:)

编辑：对我有用的代码......

```
create table #tmp2 (sql nvarchar(100))
insert #tmp2 values ('select * from sysobjects')
insert #tmp2 values  ('Select * from sysColumns')    
declare @sql nvarchar(max) 
   select @sql = '' 
   select @sql = @sql + SQL + ';' from #tmp2       
   exec sp_executesql @sql        
drop table #tmp2 
```

# asp.net - .NET MVC 4 Membership.CreateUser() 安全异常表单身份验证

> ID：11833566
> 
> 赞同：0
> 
> 时间：2012-08-06T18:07:47.683
> 
> 标签：asp.net, asp.net-mvc, forms-authentication

我在这行代码中收到以下错误...

```
MembershipUser newuser = Membership.CreateUser(usersvm.username, usersvm.password,
                usersvm.email, null, null, true, null, out createStatus); 
```

> 应用程序试图执行安全策略不允许的操作。要授予此应用程序所需的权限，请联系您的系统管理员或在配置文件中更改应用程序的信任级别。
> 
> [SecurityException：找不到源，但无法搜索部分或全部事件日志。要创建源，您需要读取所有事件日志的权限，以确保新的源名称是唯一的。无法访问的日志：安全性。]

我在 web.config 文件中也有这个

```
 <system.web>
     <trust level="Full"/> 
```

这是一些堆栈跟踪

```
MySql.Web.Security.MySQLMembershipProvider.WriteToEventLog(Exception e, String action) +380
System.Web.Security.Membership.CreateUser(String username, String password, String email, String passwordQuestion, String passwordAnswer, Boolean isApproved, Object providerUserKey, MembershipCreateStatus& status) +207
System.Web.Security.Membership.CreateUser(String username, String password, String email, String passwordQuestion, String passwordAnswer, Boolean isApproved, MembershipCreateStatus& status) +26 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T18:46:35.060

我需要像这样在 web.config 中添加这个 writeExceptionsToEventLog = "false"

```
<membership defaultProvider="MySQLMembershipProvider">
   <providers>
      <remove name="MySQLMembershipProvider"/>
           <add autogenerateschema="true" writeExceptionsToEventLog="false" .... 
```

# jquery - jQuery toArray 函数以及如何使用它的元素

> ID：11833567
> 
> 赞同：1
> 
> 时间：2012-08-06T18:07:47.560
> 
> 标签：jquery

我写了这段代码，这是一个评级系统。我想要发生的是当你将鼠标悬停在一颗星星上时，它应该触发之前的星星。

每当我将鼠标悬停在一颗星星上时，图片就会发生变化，但它之前的星星不会改变。

```
 $('.star').hover(function(){

            $(this).children().attr('src','StarsRating/star_yellow.png'); 

            var count=$(this).attr('data-count');
            var starArray =$('.star').toArray();

            for(i=0; i<count; i++){
                //The problem is here. the attributes of the stars should change to star_yellow.png..but they dont 
```

控制台.log(starArray[i]); $(starArray[i]).attr('src','StarsRating/star_yellow.png'); }

```
 },function(){
            $(this).children().attr('src','StarsRating/star_grey.png'); 
         }); 
```

html:

```
 <div id="ratingStars">
        <div class="star" data-count="1">
            <img src="StarsRating/star_yellow.png"/>
        </div>
         <div class="star" data-count="2">
             <img src="StarsRating/star_grey.png"/>
        </div>
         <div class="star" data-count="3">
            <img src="StarsRating/star_grey.png"/>
        </div>
         <div class="star" data-count="4">
            <img src="StarsRating/star_grey.png"/>
        </div>
         <div class="star" data-count="5">
            <img src="StarsRating/star_grey.png"/>
        </div> 
```

当我将控制台放入循环中时，我得到的更新是：

```
 <div class=​"star" data-count=​"1" src=​"StarsRating/​star_yellow.png">​…​&lt;/div>​
newEmptyPHPWebPage.php:41
<div class=​"star" data-count=​"2" src=​"StarsRating/​star_yellow.png">​…​&lt;/div>​
newEmptyPHPWebPage.php:41
<div class=​"star" data-count=​"3" src=​"StarsRating/​star_yellow.png">​…​&lt;/div> 
```

但是为什么我可以看到它在控制台上打开了，但在文档上却没有？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T18:32:22.027

如果您想突出显示所有星星，包括悬停的星星，如果您使用该`.prevAll`函数，则不需要数组和循环。

尝试：

```
$('.star').hover(function() {
    var star = $(this);
    star.add(star.prevAll('.star')).find('img').attr('src','StarsRating/star_yellow.png');
},function() {
    $(this).parent().children('.star').find('img').attr('src','StarsRating/star_grey.png');
}); 
```

第一个函数找到悬停星的所有先前兄弟并将它们（以及悬停的星）变为黄色。第二个函数查找容器元素的所有子星并将它们再次变为灰色。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T18:15:18.803

你的逻辑有问题。在你的悬停函数中，你得到一个星对象的子对象，但你真正想要的是星对象的父对象的子对象:)

你有：

```
$(this).children().attr('src','StarsRating/star_yellow.png'); 
```

可能工作：

```
$(this).parent().children().attr('src', 'StarsRating/star_yellow.png'); 
```

感谢 jackwanders 的评论：.children() 查找在 DOM 中分层低于目标元素的元素，而不仅仅是在源代码中出现在它之后的那些元素。您悬停的星形元素没有子元素。但是，它确实有兄弟姐妹，所以 $(this).siblings('.star') 会起作用，就像 $(this).parent().children('.star')

这也必须改变：

```
 var starArray = $('.star').toArray(); 
```

到

```
$('.star').children().toArray(); 
```

还; 代替：

```
 for(i=0; i<count; i++){
            //The problem is here. the attributes of the stars should change to star_yellow.png..but they dont
            $(starArray[i]).attr('src','StarsRating/star_yellow.png');
        } 
```

试试 jquery .each 函数：[http ://api.jquery.com/each/](http://api.jquery.com/each/)

```
$("#ratingStars").each(function(index) {

    if( index >= count ) 
        return false; // break

    $(this).attr('src', 'StarsRating/star_yellow.png');

}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-06T18:35:35.550

这就是答案：

```
 <script type="text/javascript">
         $('.star').hover(function(){
            $(this).children().attr('src','StarsRating/star_yellow.png'); 
            var count=$(this).attr('data-count');
            **var starArray =$('.star').children().toArray();**

            for(i=0; i<count; i++){

                var current= $(starArray[i]);
               current.attr('src','StarsRating/star_yellow.png');
            }

         },function(){
             $('.star img').attr('src','StarsRating/star_grey.png');

         });
    </script> 
```

var starArray =$('.star').toArray(); <--我得到了 div

var starArray =$('.star').children().toArray();<-- 现在我得到了图像

# c++ - C++ 和 pin 工具——IF 语句非常奇怪的 DOUBLE 变量问题

> ID：11833571
> 
> 赞同：2
> 
> 时间：2012-08-06T18:08:11.023
> 
> 标签：c++

我正在使用模拟处理器的 pin 工具并遇到一个非常奇怪的问题。在下面的代码片段中，Router::Evaluate() 被多次重复调用。在它被调用数百万次后，会间歇性地发生奇怪的行为，其中“_cycles！= 0”在第一个 IF 语句中被评估为真，而在紧随其后的 IF 语句中被评估为假，落入 ELSE 块。

```
void Router::Evaluate( )
{     
  //---------debug print code---------
  if (_cycles != 0) {
    cout << "not a zero" << endl;

    if (_cycles != 0) cout << "---not a zero" << endl;
    else cout << "---zero" << endl;

  }        
  //----------------------------------

  _cycles += _speedup;
  while ( _cycles >= 1.0 ) {
    _Step();
    _cycles -= 1.0;
  }
}

//class definition
class Router : public TimedModule {
  Protected:
    double _speedup;  //initialized to 1.0
    double _cycles;  //initialized to 0.0
  ...
} 
```

下面是代码的输出，其中“not a zero”后跟“---zero”不时被打印出来，看似随机。

```
not a zero
---zero
(...some other output...)
not a zero
---zero
(...some other output...) 
```

这怎么可能发生？这不是一个多线程程序，所以同步不是问题。该程序使用 gcc4.2.4 编译并在 32 位 CentOS 上执行。有人有线索吗？谢谢。

- 添加 - -

我也应该提到这一点。我确实尝试每次打印_cycles的值，它总是0.0，这应该是不可能的......我还使用了以下g ++选项：“-MM -MG -march=i686 -g -ggdb -g1 -finline -功能 -O3 -fPIC"

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T18:45:18.370

除非你有一个可怕的编译器错误，否则我猜会发生这样的事情：

_cycles 在减法之后还剩下一小部分。只要编译器知道没有其他东西在改变它的内容，它就会把它的值保存在一个更高精度的浮点寄存器中。当它看到 I/O 操作时，不确定其他地方是否需要 _cycles 的值，因此它确保将其内容存储回双精度内存位置，四舍五入寄存器中的额外位。下一个检查悲观地假设该值可能在 I/O 操作期间发生了变化，并将其从内存中加载回来，现在没有在前一个测试中使其非零的额外位。

正如 Daniel Fischer 在评论中提到的，使用`-ffloat-store`禁止使用高精度寄存器。如果使用此选项时问题消失，那么我描述的情况很可能。检查汇编输出`Router::Evaluate`以确保。

# java - 最初重新连接到 JMS 服务器并在已经获得以前的连接之后

> ID：11833584
> 
> 赞同：6
> 
> 时间：2012-08-06T18:09:10.710
> 
> 标签：java, connection, jms, weblogic

我在使用 JMS 重新连接策略时遇到问题。我不确定我是否做得正确（很可能不是）。无论如何，我正在使用 WebLogic，这是一个消费者客户端。这是我获得连接的方法，并尝试添加自动重新连接。问题是它没有重新连接，并且没有任何异常记录什么。我通过启动 weblogic 来重新创建这种情况，启动获得初始连接的消费者客户端，我突然关闭 weblogic，然后我重新启动 weblogic，此时该消费者正在侦听的队列中的任何消息都保留在队列中而不被确认因为他们没有被接收。

```
public void setReceiver(MessageListener listener) {
        try {
            Properties parm = new Properties();
            parm.setProperty("java.naming.factory.initial",
                    "weblogic.jndi.WLInitialContextFactory");
            parm.setProperty("java.naming.provider.url", URL);
            parm.setProperty("java.naming.security.principal", username);
            parm.setProperty("java.naming.security.credentials", password);
            ctx = new InitialContext(parm);
            final QueueConnectionFactory connectionFactory = (QueueConnectionFactory) ctx
                    .lookup(conFactoryName);
            connection = connectionFactory.createQueueConnection();
            // TODO: 8/6/2012 Work on reconnection strategies for Consumer.
            ((WLConnection) connection)
                    .setReconnectPolicy(JMSConstants.RECONNECT_POLICY_ALL);
            ((WLConnection) connection).setReconnectBlockingMillis(30000L);
            ((WLConnection) connection).setTotalReconnectPeriodMillis(-1L);
            session = connection.createQueueSession(false,
                    Session.AUTO_ACKNOWLEDGE);

            queue = (Queue) ctx.lookup(queueName);
            // receiver = session.createReceiver(queue);
            // receiver.setMessageListener(listener);
            consumer = session.createConsumer(queue);
            consumer.setMessageListener(listener);

            connection.setExceptionListener(new ExceptionListener() {

                @Override
                public void onException(JMSException arg0) {
                    // Assume Disconnected.
                    FileHandler fh = null;
                    try {
                        fh = new FileHandler("./logs/ExceptionListener", true);
                    } catch (SecurityException e) {
                        e.printStackTrace();
                    } catch (IOException e) {
                        e.printStackTrace();
                    }
                    SimpleFormatter formatter = new SimpleFormatter();
                    fh.setFormatter(formatter);
                    Logger log2 = Logger.getLogger("ExceptionListener");
                    log2.addHandler(fh);
                    boolean connected = false;
                    do {
                        if (connection != null) {
                            try {
                                connection.close();
                            } catch (JMSException e) {
                                log.warning(e.toString());
                            }
                            try {
                                connection = connectionFactory.createQueueConnection();
                                connection.setExceptionListener(this);
                                connection.start();
                                connected = true;
                            } catch (JMSException e) {
                                log.severe(e.toString());
                            }
                        }
                    } while (!connected);

                }
            });
            connection.start();

        } catch (JMSException je) {
            log.severe(je.getMessage());
        } catch (Exception e) {
            log.severe(e.getMessage());
        }
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-08T15:20:28.717

所以我终于弄清楚了这个问题。未调用异常侦听器的主要问题是由于我的构建路径中有竞争的 jar。我的构建路径中有 wlfullclient.jar 和 wljmsclient.jar 和 wlsasclient.jar 删除 wljmsclient.jar 和 wlsasclient.jar 后，我开始收到允许我进一步调试的错误消息。这是我的最终解决方案，它将在初始连接时每 30 秒尝试连接一次，然后如果它已获得连接，它将尝试每 30 秒重新连接一次，但随后又失去了连接：

```
public boolean setReceiver(MessageListener listener) {
        try {
            Properties parm = new Properties();
            parm.setProperty("java.naming.factory.initial",
                    "weblogic.jndi.WLInitialContextFactory");
            parm.setProperty("java.naming.provider.url", URL);
            parm.setProperty("java.naming.security.principal", username);
            parm.setProperty("java.naming.security.credentials", password);
            ctx = new InitialContext(parm);
            final QueueConnectionFactory connectionFactory = (QueueConnectionFactory) ctx
                    .lookup(conFactoryName);
            connection = connectionFactory.createQueueConnection();
            ((WLConnection) connection)
                    .setReconnectPolicy(JMSConstants.RECONNECT_POLICY_ALL);
            ((WLConnection) connection).setReconnectBlockingMillis(30000L);
            ((WLConnection) connection).setTotalReconnectPeriodMillis(-1L);
            session = connection.createQueueSession(false,
                    Session.AUTO_ACKNOWLEDGE);
            queue = (Queue) ctx.lookup(queueName);
            consumer = session.createConsumer(queue);
            consumer.setMessageListener(listener);

            connection.setExceptionListener(new ExceptionListener() {
                @Override
                public void onException(JMSException arg0) {
                    // Assume Disconnected.
                    Logger log2 = new MyLogger().getLogger("BPEL Client");
                    if (arg0 instanceof LostServerException) {
                        log2.severe("Connection to the Server has been lost, will retry in 30 seconds. "
                                + arg0.toString());
                    } else {
                        log2.severe(arg0.toString());
                    }

                }
            });
            connection.start();
            log.info("Successfully connected to " + URL);
            return true;
        } catch (JMSException je) {
            log.severe("Could not connect to the WebLogic Server, will retry in 30 seconds. "
                    + je.getMessage());
            try {
                Thread.sleep(30000L);
            } catch (InterruptedException e) {
                log.warning(e.toString());
            }
            return setReceiver(listener);
        } catch (Exception e) {
            log.severe("Could not connect to the WebLogic Server, will retry in 30 seconds. "
                    + e.toString());
            try {
                Thread.sleep(30000L);
            } catch (InterruptedException ie) {
                log.warning(ie.toString());
            }
            return setReceiver(listener);

        }
    } 
```

# python - 在 Python 中，对文件使用 read() 后是否需要使用 close()？

> ID：11833585
> 
> 赞同：4
> 
> 时间：2012-08-06T18:09:13.393
> 
> 标签：python, django, memory, file-upload, file-io

我正在使用 Django 读取 ajax 上传的文件以将其存储在模型中。上传请求包含原始上传的图像数据。

```
def my_view(request):
    upload = request
    model_instance.image_field.save(uniquename, ContentFile(upload.read())) 
```

如果重要的话，我使用 AmazonS3 作为上传文件的存储后端。

在包含此代码的函数的某处，我有内存泄漏。

执行此操作后是否需要调用`upload.close()`以释放资源/内存？
还是我的内存问题来自此功能其他地方的其他问题？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-08-06T18:13:04.577

当不再引用文件时，python 垃圾收集器将关闭文件。

如果您的`upload`变量是函数中的局部变量，则它将在函数返回时被清除。因此，引用的文件`upload`将在正常的垃圾回收周期中自动关闭。

也就是说，最好关闭文件。您可以将该文件用作[上下文管理器](http://docs.python.org/library/stdtypes.html#file.close)，并且在退出上下文时它会自动关闭：

```
with open('yourfilepath.ext') as upload:
    model_instance.image_field.save(uniquename, ContentFile(upload.read())) 
```

如果`upload`是 Django 为您生成的东西，打开并准备好，您仍然可以使用[`contextlib.closing`装饰器](http://docs.python.org/library/contextlib.html#contextlib.closing)自动关闭它：

```
import contextlib
with contextlib.closing(upload):
     model_instance.image_field.save(uniquename, ContentFile(upload.read())) 
```

要回答您的其余问题：您的泄漏很可能在其他地方。

# javafx-2 - 在 JavaFX 中更新 lineChart

> ID：11833587
> 
> 赞同：2
> 
> 时间：2012-08-06T18:09:16.847
> 
> 标签：javafx-2

我是 Java 和 JavaFX 的新手，有一个问题。我在 JavaFX 中有一个具有单个阶段/场景的应用程序。它有多个选项卡。在其中一个选项卡中，我希望用户能够在文本字段中输入一些值，按下提交按钮，然后在同一场景中显示一个 lineChart。我没有运气让这个工作。
运行应用程序时会显示一个空折线图，但我无法弄清楚如何让一系列数据出现。

这是 Controller 类中的简单测试代码，用于在按下提交按钮时代码执行的方法：

```
@FXML
private void getEngDataPlot(ActionEvent event)  {

    lineChart.setTitle("Test charting");
    //defining a series
    XYChart.Series series = new XYChart.Series();
    series.setName("My Test Data");
    //populating the series with data
    series.getData().add(new XYChart.Data(1, 23));
    series.getData().add(new XYChart.Data(2, 14));
    series.getData().add(new XYChart.Data(3, 15));
    series.getData().add(new XYChart.Data(4, 24));
    series.getData().add(new XYChart.Data(5, 34));
    series.getData().add(new XYChart.Data(6, 36));
    series.getData().add(new XYChart.Data(7, 22));
    series.getData().add(new XYChart.Data(8, 45));
    series.getData().add(new XYChart.Data(9, 43));
    series.getData().add(new XYChart.Data(10, 17));
    series.getData().add(new XYChart.Data(11, 29));
    series.getData().add(new XYChart.Data(12, 25));

    lineChart.getData().add(series);

} 
```

我必须在这种方法中“做”其他事情来加载场景中的图表吗？我看到了 show.stage(); 在示例中，但是在我执行此方法时，我的应用程序正在运行并且我已经显示了“阶段”-不是吗？我显然错过了一些基本的东西应该如何挂在一起，但我不知道是什么。

谢谢，请原谅我的无知。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T10:26:22.657

很可能您的图表轴设置不正确，因此您看不到新数据。尝试添加下一行：

```
lineChart.getXAxis().setAutoRanging(true);
lineChart.getYAxis().setAutoRanging(true); 
```

或者看下一个例子：

```
public class ChartUpdate extends Application {
    @Override
    public void start(Stage primaryStage) {
        //random axis here
        final LineChart lineChart = new LineChart(new NumberAxis(1, 22, 0.5), new NumberAxis(1, 22, 0.5));
        lineChart.getXAxis().setAutoRanging(true);
        lineChart.getYAxis().setAutoRanging(true);
        Button btn = new Button();
        btn.setText("Say 'Hello World'");
        btn.setOnAction(new EventHandler<ActionEvent>() {
            @Override
            public void handle(ActionEvent event) {
                lineChart.setTitle("Test charting");
                //defining a series
                XYChart.Series series = new XYChart.Series();
                series.setName("My Test Data");
                //populating the series with data
                series.getData().add(new XYChart.Data(1, 23));
                series.getData().add(new XYChart.Data(2, 14));
                series.getData().add(new XYChart.Data(3, 15));
                series.getData().add(new XYChart.Data(4, 24));
                series.getData().add(new XYChart.Data(5, 34));
                series.getData().add(new XYChart.Data(6, 36));
                series.getData().add(new XYChart.Data(7, 22));
                series.getData().add(new XYChart.Data(8, 45));
                series.getData().add(new XYChart.Data(9, 43));
                series.getData().add(new XYChart.Data(10, 17));
                series.getData().add(new XYChart.Data(11, 29));
                series.getData().add(new XYChart.Data(12, 25));

                lineChart.getData().add(series);
            }
        });

        VBox root = new VBox();
        root.getChildren().addAll(btn, lineChart);

        Scene scene = new Scene(root, 300, 250);

        primaryStage.setTitle("Hello World!");
        primaryStage.setScene(scene);
        primaryStage.show();
    }

    public static void main(String[] args) { launch(); }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-26T15:15:52.660

也许您已经找到了问题的答案，但我相信这可能会在未来对其他人有所帮助。

在 Scene Builder 中创建 LineChart 时，请注意有两种类型的 LineChart：LineChart 和 LineChart (N x N)。第一个具有类别 x 轴（您只能在其中定义类别以显示为字符串）。第二个有一个数字 x 轴。

因此，如果您想显示数据与数据，就像在您展示的示例中一样，您应该使用 LineChart (N x N)。

希望能帮助到你。

# c# - 使用基类将对象添加到集合中

> ID：11833588
> 
> 赞同：0
> 
> 时间：2012-08-06T18:09:16.793
> 
> 标签：c#

我有两个自定义对象，可以说`Cat`和`Dog`. 我想创建一个`observable collection`可以容纳其中任何一个对象的对象，因为它们非常相似。我可以使用基类来做到这一点吗？

如果是这样，你介意提供一个简单的例子吗？

如果我确实使用了基类，这是否意味着如果我想使用公共字段，我应该将它们放入基类中？

编辑：我希望然后将 WPF 数据网格绑定到这些对象的属性。我不知道是否可以将 WPF 中的数据网格绑定到两种不同类型的对象...

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-06T18:28:40.463

是的，在这种情况下，您可以使用基类：

```
public class Pet
{
    public int Id { get; set; }
    public string Name { get; set; }

    public void Run() { }
}

public class Cat: Pet
{
    public string Meow()
    {
        return "Meow";
    }
}

public class Dog :Pet
{
    public string Bark()
    {
        return "Whow";
    }
} 
```

但是请注意，当您将两个类的实例放在一个集合中时，您只能访问**基****类**的成员。所以这段代码是有效的：

```
var collection = new ObservableCollection<Pet> {new Cat(), new Dog()};

foreach (var pet in collection)
{
   pet.Run();
} 
```

但是你不能使用 Meow() 和 Bark() 方法，除非你使用显式转换。

将太多成员移动到基类时要小心——在上面的示例中，Meow() 对 Dog 没有意义，而 Bark() 对 Cat 没有意义。如果您需要使用某些特定于派生类的方法，您可以检查类型：

```
pet.GetType() 
```

然后将对象转换为派生类型：

```
var cat = (Cat)pet;
cat.Meow(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T18:12:02.110

是的。您可以使用基类说动物。是的，如果他们有共同的字段，如名称、类型等。他们可以进入那里。

```
class Animal {
    public String name;
} 
```

然后扩展它。但您也可以扩展功能。

```
class Dog extends Animal {
    public void bark();
} 
```

现在任何要求动物类型的东西都可以接收狗。

```
public void addToCollection(Animal animal)
addToCollection(new Dog()); 
```

这实际上是 Java 的 Object 的支柱。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-06T18:19:06.260

是的属性，这是基类的重点。您在基类中表达共性，在派生类中表达特殊性。至于基类是否是可观察集合的最佳位置，这取决于。您需要更深入地了解需求和预期用途。不过这是可行的。

也可以查看[ObservableCollection<T>](http://msdn.microsoft.com/en-us/library/ms668604.aspx)。

# linq - 从 LINQ 查询中选择一个唯一实例

> ID：11833590
> 
> 赞同：0
> 
> 时间：2012-08-06T18:09:19.240
> 
> 标签：linq, linq-to-sql

我正在使用 LINQ to SQL 从一组数据库表中获取数据。数据库设计是这样的：给定一个表（表 A）的唯一 ID，一个且只有一个实例应该从关联的表（表 B）返回。

是否有更简洁的方法来编写此查询并确保在不使用如下`.Count()`扩展方法的情况下只返回一个项目：

```
var set = from itemFromA in this.dataContext.TableA
          where itemFromA.ID == inputID
          select itemFromA.ItemFromB;

if (set.Count() != 1)
{
    // Exception!
}

// Have to get individual instance using FirstOrDefault or Take(1) 
```

`FirstOrDefault`有点帮助，但我想确保返回的集合只包含一个实例而不是更多。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T18:11:59.593

听起来你想要[`Single`](http://msdn.microsoft.com/en-us/library/bb156472.aspx)：

```
var set = from itemFromA in this.dataContext.TableA
          where itemFromA.ID == inputID
          select itemFromA.ItemFromB;

var onlyValue = set.Single(); 
```

文档指出：

> 返回序列的唯一元素，如果序列中不完全有一个元素，则抛出异常。

当然，这意味着您无法自定义异常消息...如果您需要这样做，我会使用类似的东西：

```
// Make sure that even if something is hideously wrong, we only transfer data
// for two elements...
var list = set.Take(2).ToList();
if (list.Count != 1)
{
    // Throw an exception
}
var item = list[0]; 
```

与您当前的代码相比，这样做的好处是它将避免多次评估查询。

# css - Mediawiki 的图片库 CSS

> ID：11833596
> 
> 赞同：0
> 
> 时间：2012-08-06T18:09:29.400
> 
> 标签：css, gallery, mediawiki

有谁知道在哪里可以找到 Mediawiki 的图片库的 CSS？（它的画廊、缩略图、缩略图周围的边框等）我浏览了一个全新的安装并不断发现它的重复副本分布在不同的 CSS 文件中。当我尝试编辑它们中的每一个时，它根本不会改变页面。不知道我做错了什么。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T18:18:56.430

您可以在[/common/shared.css](https://gerrit.wikimedia.org/r/gitweb?p=mediawiki/core.git;a=blob;f=skins/common/shared.css;hb=HEAD#l754)和[/common/commonContent.css](https://gerrit.wikimedia.org/r/gitweb?p=mediawiki/core.git;a=blob;f=skins/common/commonContent.css;hb=HEAD)文件中找到它们。但是，我建议不要在那里编辑它们，而是从皮肤文件中覆盖它们。

# macos - 使用命令行向图像添加透明像素线

> ID：11833599
> 
> 赞同：4
> 
> 时间：2012-08-06T18:09:53.603
> 
> 标签：macos, image, bash, imagemagick

我有几个 15x15 PNG 需要转换为 18x18 PNG。

但是，我不想简单地放大整个图像。

我想要的基本上是保留确切的旧图像，但用不可见/透明像素线“填充”它。

所以假设原始图像看起来像这样（想象`X`s 是像素）：

```
XXXX
XXXX
XXXX
XXXX 
```

我想把它变成这样的东西（`X`原始图像的像素，`T`新的透明像素）：

```
XXXXT
XXXXT
XXXXT
XXXXT
TTTTT 
```

这是否可以使用命令行工具（以便可以自动化），也许使用 imagemagick 之类的工具？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-06T19:51:16.790

这将完成这项工作：

```
convert input_file -background transparent -extent '18x18' output_file 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-06T20:56:56.557

您可以使用 ImageMagick`-append`和`+append`运算符来做到这一点。`-append`垂直附加（底部），`+append`水平附加（右）：

```
convert \
  -background transparent \
   15x15.png \
   null: null: null: +append \
   null: null: null: -append \
   18x18.png 
```

`null:`图片是 ImageMagick 内置的：它代表 1 个透明像素。

但就像 IM 通常的情况一样：有上千种方法可以达到同一个目标。

如果您需要将透明部分添加到左侧和顶部（而不是右侧和底部），或者您是否只想将像素添加到一个、三个或四个（而不是只有两个边缘，它应该如何修改我的命令对你来说很明显。

也许您会发现 Theodros 的答案更直观（为此 +1！）。在这种情况下，如果您想更改添加像素的边框，可以将`-gravity`参数添加到他的命令中：

```
convert infile -background transparent -gravity southeast -extent '18x18' outfile 
```

除了`south`, 您还可以使用`north`, `northeast`, `east`, ... 和`northwest`. 不要忘记`center`...

# javascript - JQuery 测试元素是可见还是隐藏，然后添加删除类

> ID：11833603
> 
> 赞同：1
> 
> 时间：2012-08-06T18:10:08.310
> 
> 标签：javascript, jquery, toggle, visibility, hidden

我有一个在页面加载隐藏时开始的 div。当我切换“+”元素时，相对 div 切换为可见。我正在尝试使用 if - else 语句添加基于 is(":hidden") 或不基于的类。

我的 HTML 是：

```
<div class="views-row">
<div class="field-group-format-toggler-abstract">+</div>
<h2>Title 1</h2>
<div class="field-group-format-wrapper" style="display:none;">
Dolor minim neque pala ratis sit. Ideo odio praesent. Aliquam capto gravis quis. Antehabeo diam huic praemitto. Immitto pneum ratis vereor volutpat. Brevitas facilisis illum macto mos plaga ratis utrum. Jumentum rusticus secundum
</div>
</div> 
```

我的jQuery是：

```
$(".field-group-format-toggler-abstract").click(function() {
$(this).nextAll(".field-group-format-wrapper").toggle();
               });

if($(".field-group-format-wrapper").is(":hidden"))
// this seems to work, 'closed' gets added
$('.field-group-format-toggler-abstract').addClass("closed");

// but this part does not seem to work     
     else
$('.field-group-format-toggler-abstract').addClass("open").removeClass("closed"); 
```

​这第一部分有效，但添加和删除类不是。我已经尝试了各种方法来做到这一点，但似乎没有任何效果，课程仍然在`closed`。

这是一个**[小提琴](http://jsfiddle.net/LHguJ/19/)**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T18:53:24.883

尝试这个，

```
$(".field-group-format-toggler-abstract").click(function() {
    var $div = $(this).nextAll(".field-group-format-wrapper");  // <-- cache the selector
    $div.toggle();       
    $(this).toggleClass('open', $div.is(':visible')); // <-- if wrapper div is visible class open will be added // else it will be removed
    $(this).toggleClass('closed', $div.is(':hidden')); // <-- if wrapper div is hidden class open will be added // else it will be removed
});​ 
```

您可以将条件/切换作为[.toggleClass()中的第二个参数传递](http://api.jquery.com/toggleClass/)

[http://jsfiddle.net/LHguJ/25/](http://jsfiddle.net/LHguJ/25/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T18:14:28.603

尝试这个，

```
if($(".field-group-format-wrapper").is(":visible")){
  $('.field-group-format-toggler-abstract').addClass("close").removeClass("open");
}
else {
    $('.field-group-format-toggler-abstract').addClass("open").removeClass("closed");
} 
```

# c# - 在gridview中选择组样式

> ID：11833607
> 
> 赞同：5
> 
> 时间：2012-08-06T18:10:34.750
> 
> 标签：c#, windows-8, microsoft-metro, windows-runtime

我正在为 Windows 8 开发应用程序 Metro。我使用 GridApp (xaml) 项目，但我想在每个部分中使用不同的组样式。

我的代码是：

```
public class GroupTemplateSelector : GroupStyleSelector
{

    public GroupStyle NewsItemGroupStyle { get; set; }
    public GroupStyle NormalGroupStyle { get; set; }

    protected override GroupStyle SelectGroupStyleCore(object group, uint level)
    {
        // a method that tries to grab an enum off the bound data object

        if (level == 3)
        {
            return NewsItemGroupStyle;
        }
        else
        {
            return NormalGroupStyle;
        }

        throw new ArgumentException("Unexpected group type"); 

    }
} 
```

我使用这个类来选择组样式和 XAML

```
<!-- NewsItemGroupStyle -->
<GroupStyle x:Key="NewsItemGroupStyle">
    <GroupStyle.HeaderTemplate>
        <DataTemplate>
        </DataTemplate>
    </GroupStyle.HeaderTemplate>
    <GroupStyle.Panel>
        <ItemsPanelTemplate>
            <StackPanel Orientation="Vertical" Margin="0,0,80,0" VerticalAlignment="Bottom"/>
        </ItemsPanelTemplate>
    </GroupStyle.Panel>
</GroupStyle>

<!-- NormalItemGroupStyle -->
<GroupStyle x:Key="NormalGroupStyle">
    <GroupStyle.HeaderTemplate>
        <DataTemplate>
            <Grid Margin="1,0,0,6">
                <Button
                    AutomationProperties.Name="Group Title"
                    Content="{Binding Title}"
                    Background="Blue"
                    Click="Header_Click"
                    Style="{StaticResource TextButtonStyle}"
                    />
            </Grid>
        </DataTemplate>
    </GroupStyle.HeaderTemplate>
    <GroupStyle.Panel>
        <ItemsPanelTemplate>
            <VariableSizedWrapGrid Orientation="Vertical" Margin="0,0,80,0"/>
        </ItemsPanelTemplate>
    </GroupStyle.Panel>
</GroupStyle>

<!-- selector -->
<common:GroupTemplateSelector 
    x:Key="groupSelector"
    NewsItemGroupStyle="{StaticResource NewsItemGroupStyle}"
    NormalGroupStyle="{StaticResource NormalGroupStyle}" /> 
```

但是样式组会立即更改。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T20:59:20.947

正如 Lvsti 所指出的，GroupStyleSelector 只能在每个*级别*更改样式。例如，所有级别 0 组将具有相同的样式，但所有级别 1 组可能具有不同的样式。目前不可能在 0 级有两个不同风格的不同组。事实上，似乎为同一级别的任何组返回的最后一个样式应用于该级别的所有组。这是不幸的，但这是目前的设计。

开发支持、设计支持和更多的好处：http: [//bit.ly/winappsupport](http://bit.ly/winappsupport)

# javascript - 需要一些帮助来理解 nodejs 和 socket.io

> ID：11833609
> 
> 赞同：1
> 
> 时间：2012-08-06T18:10:36.530
> 
> 标签：javascript, node.js, webserver, websocket, socket.io

抱歉这个相当无知的问题，但我对这两种技术有点困惑。我用 C# 编写了一个使用 Fleck 的网络服务器，一切正常，但我意识到我可能找不到可以运行 .NET 应用程序的托管服务提供商。

我想使用 websockets，我发现 socket.io 非常受欢迎，但我不确定它到底是什么。如果我错了，请纠正我，但是，这是否就像用 javascript 编写服务器并使用`node.exe`应用程序运行 javascript 文件然后服务器正在运行？人们如何找到将提供此类服务的托管服务提供商？

最后，socket.io 只是 nodejs 的扩展吗？当你使用 socket.io 时，你必须用 javascript 编写你的服务器吗？再次，对于非常新手的问题，我很抱歉，但在我继续之前，我只是想了解一些基本的东西。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T19:03:17.727

有几家公司将托管您的节点应用程序。它与您向他们提供文件并为您提供文件的过渡网络主机不同。使用节点时，您正在编写实际的 Web 服务器。

下面是一些受欢迎的：

*   [https://devcenter.heroku.com/articles/nodejs](https://devcenter.heroku.com/articles/nodejs)
*   [http://nodejitsu.com/](http://nodejitsu.com/)
*   [http://nodester.com/](http://nodester.com/)

> @Roest：虚拟服务器听起来很有趣。这种方法的优缺点是什么？另外，考虑到 nodejs 的流行程度，它的网络服务器托管支持怎么会如此有限？人们如何使用它？

使用虚拟服务器时，您对在服务器上运行的内容充满了兴趣。

**Pros** Freedom，您可以选择要在您的机器上运行的所有软件。很多时候，在使用 nodejs 时，您会希望一些自定义软件与您的应用程序一起运行。大多数情况下，这是您选择的数据库层。

**缺点** 你必须维护它。就像@Roest 所说，这对大多数人来说并不是什么大问题，因为这直接关系到虚拟服务器为您提供的自由，但这是您需要考虑的事情。

我认为你看到对 nodejs 的支持有限的原因是它相对较新，而且很容易自己设置。

> 我想使用 websockets，我发现 socket.io 非常受欢迎，但我不确定它到底是什么。如果我错了，请纠正我，但是，这是否就像用 javascript 编写服务器并使用`node.exe`应用程序运行 javascript 文件然后服务器正在运行？

这几乎就是 nodejs 的本质，或者至少是你使用它的方式。Nodejs 本身是在您的服务器上运行的 Google 的 V8 javascript 引擎，以及大量的库和 C 绑定，允许您以 V8 引擎不允许的方式与您的服务器交互。

这是 nodejs 中的网络服务器示例（**非常**有限）

```
var http = require('http');
http.createServer(function (req, res) {
  res.writeHead(200, {'Content-Type': 'text/plain'});
  res.end('Hello World\n');
}).listen(1337, '127.0.0.1');
console.log('Server running at http://127.0.0.1:1337/'); 
```

它只是响应`Hello World`每个请求并始终返回 200 状态代码。

从这样的东西到一个简单的文件服务器是相当容易和快速的，但是一些人已经为你解决了这个问题。

[http://expressjs.com/](http://expressjs.com/) - 非常强大的网络服务器，但仍然给你很多自由。 [https://github.com/nodeapps/http-server](https://github.com/nodeapps/http-server) - 简单的 Web 服务器，我主要将它用作命令行工具，通过 http 即时服务器文件。

> 最后，socket.io 只是 nodejs 的扩展吗？当你使用 socket.io 时，你必须用 javascript 编写你的服务器吗？再次，对于非常新手的问题，我很抱歉，但在我继续之前，我只是想了解一些基本的东西。谢谢。

socket.io是[nodejs](https://npmjs.org/)的一个模块。根据您对扩展名的定义，它可能是错误的词。大多数情况下，使用 socket.io 时，您将使用现有的 http 服务器，然后使用 socket.io 扩展或包装您的服务器。我之前写了一篇[关于 nowjs 如何做到这一点的解释](https://stackoverflow.com/questions/11798627/now-js-hello-world-example-require-not-defined/11799794#11799794)。我的猜测是 socket.io 非常相似。

要回答这个问题的大部分：是的，您仍然会用 javascript 编写代码。您将只使用 socket.io API。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T22:46:32.080

@travis 已经涵盖了您需要了解的有关 node 和 socket.io 的所有内容

我只想说您不必购买`special`专用于节点的主机。

[我的游戏](http://rezoner.net)使用 Ubuntu 托管在 VPS 上

我发现它很容易部署和维护。有一个适用于 Ubuntu 的软件包，安装实际上需要四行复制/粘贴

[https://github.com/joyent/node/wiki/Installing-Node.js-via-package-manager](https://github.com/joyent/node/wiki/Installing-Node.js-via-package-manager)

ps：我没有使用 socket.io 而是使用[einaros/ws](https://github.com/einaros/ws/)库，我发现它没有被夸大得多。

# html - 如何将单词添加到全方位完成词典？

> ID：11833615
> 
> 赞同：2
> 
> 时间：2012-08-06T18:11:12.267
> 
> 标签：html, vim, omnicomplete

例如，如果我在一个 html 文件中，然后键入`<`tab，我将得到一个`!doctype`可以使用的 s 列表。但是`"<!DOCTYPE html>"`不包括在内，我想添加它。我该怎么做呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T19:12:31.570

看看[这个](https://github.com/othree/html5.vim)关于 html5 omnicompletion 的 repo。

或者，您可以复制`$VIMRUNTIME/autoload/htmlcomplete.vim`到您的`~/.vim/autoload`文件夹并在那里进行编辑。这将使用您的自定义文件覆盖它。

```
619a620
>               \ '!DOCTYPE html>',
653,657c654,655
<           if &filetype == 'html' && exists("uppercase_tag") && uppercase_tag == 1 && item !~ 'DOCTYPE'
<               let item = toupper(item)
<           endif
<           if item =~ 'DOCTYPE'
<               let abbr = 'DOCTYPE '.matchstr(item, 'DTD \zsX\?HTML .\{-}\ze\/\/')
---
>           if item == '!DOCTYPE html>'
>               let abbr = "DOCTYPE HTML 5"
659c657,664
<               let abbr = item
---
>               if &filetype == 'html' && exists("uppercase_tag") && uppercase_tag == 1 && item !~ 'DOCTYPE'
>                   let item = toupper(item)
>               endif
>               if item =~ 'DOCTYPE'
>                   let abbr = 'DOCTYPE '.matchstr(item, 'DTD \zsX\?HTML .\{-}\ze\/\/')
>               else
>                   let abbr = item
>               endif
727a733,736
>       elseif line=~ '<!DOCTYPE html>'
>           let b:html_omni_flavor = 'html5'
>           let b:html_doctype = 1
>           break 
```

# php - MySQL跨表只拉一行

> ID：11833616
> 
> 赞同：0
> 
> 时间：2012-08-06T18:11:27.653
> 
> 标签：php, mysql

我有两个表：一个存储博客，另一个存储博客的图像。图像表有列 id, blog_id, image_name

由于一个博客可以有多个图像分配给它，我怎样才能拉出 5 个最新的博客并有 5 个不重复的条目

我试过：从两个表中选择，但结果是这样的：

id 1 图像“a.jpg” - id 1 图像“b.jpg” - id 2 图像“c.jpg”

当我想要：

id 1 图像“a.jpg” - id 2 图像“c.jpg” - id 3 图像“d.jpg”

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T19:38:01.070

`GROUP BY id`您可以在查询末尾添加一个子句。由于您尚未发布完整的查询，我对此不是 100% 确定，但在简单的情况下它应该可以工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T18:14:22.780

如果您有日期列：

`SELECT DISTINCT (id) FROM table_name WHERE somecolumn=someans ORDER BY date ASC LIMIT 5`

否则（这可能对你有用）：

`SELECT DISTINCT (id) FROM table_name WHERE somecolumn=someans ORDER BY id ASC LIMIT 5`

# backbone.js - 应用程序启动和 Backbone.Marionette 模块的问题

> ID：11833617
> 
> 赞同：0
> 
> 时间：2012-08-06T18:11:30.270
> 
> 标签：backbone.js, marionette

不幸的是，我在理解 Backbone.Marionette 模块和子模块的启动时遇到了问题。初始化器被多次调用，而不是每次被调用一次。

我需要做什么才能使事情以可预见的方式工作？

```
PP = new Backbone.Marionette.Application();

PP.bind('start', function() {
    console.log('application start');

    PP.module('Routing').start();
    PP.module('Products').start();
});

PP.module('Routing', {
    startWithApp: false,
    define: function(Routing, PP, Backbone, Marionette, $, _) {
        Routing.addInitializer(function() {
            console.log('Routing.init');
        });                
    }
});

PP.module('Routing.ProductsRouting', {
    startWithApp: false,
    define: function(ProductsRouting, PP, Backbone, Marionette, $, _) {
        ProductsRouting.addInitializer(function() {
            console.log('ProductsRouting.init');
        });
    }
});

PP.module('Products', {
    startWithApp: false,
    define: function(Products, PP, Backbone, Marionette, $, _) {
        Products.addInitializer(function() {
            console.log('Products.init');
        });
    }
});

$(function() {
    PP.start();
}); 
```

（代码也可用作[JSFiddle](http://jsfiddle.net/xzeHb/110/)）

上面的代码在控制台中输出以下行：

*   应用程序启动
*   路由.init
*   ProductsRou​​ting.init
*   路由.init
*   ProductsRou​​ting.init
*   产品.init
*   产品.init

这就是我所期望的：

*   应用程序启动
*   路由.init
*   产品.init

如果您决定使用您的应用程序自动启动所有模块（所有模块中的 startWithApp: true 并且无需手动启动 Routing 和 Products 模块），则输出是这样的：

*   路由.init
*   ProductsRou​​ting.init
*   ProductsRou​​ting.init
*   产品.init
*   应用程序启动

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-08T01:24:44.067

这是用 v0.9.7 修复的[https://github.com/derickbailey/backbone.marionette/blob/master/changelog.md#v097-view-commit-logs](https://github.com/derickbailey/backbone.marionette/blob/master/changelog.md#v097-view-commit-logs)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-06T19:02:45.000

通过在 Backbone.Marionette 上实现这个[github pull request解决了这个问题。](https://github.com/derickbailey/backbone.marionette/pull/208)但也许 Derick Bailey（Backbone.Marionette 的创建者）对此有自己的看法？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-26T13:44:24.160

如果有人仍然遇到模块似乎以错误的顺序加载的问题 - 我的解决方案是`Backbone.history.start()`.

这是我的问题：

**引导程序.js**

```
App.start(); 
```

**应用程序.js**

```
App = new Backbone.Marionette.Application();

var _AppRouter = Backbone.AppRouter.extend({
  appRoutes: { 
    "" : "getStarted"
  },
  controller: App
});

App.getStarted = function() {
  console.log(App.MyModule.myMethod);  // undefined
  App.MyModule.myMethod();
}

App.addInitializer(function() {
  new _AppRouter();
  Backbone.history.start();
}); 
```

**应用程序.MyModule.js**

```
App.module("MyModule", function(MyModule, App) {
  MyModule.myMethod = function() {
    console.log("in myMethod");       // never gets called
  }
}); 
```

App.MyModule.myMethod 在此示例中未定义，因此应用程序启动时没有任何反应。

我发现问题出在我打电话的地方`Backbone.history.start()`。我将此调用移至我的 bootstrap.js 文件，这样我只在我的所有应用程序模块都已正确初始化*后才调用我的路由。*

**引导程序.js**

```
App.start();
Backbone.history.start(); 
```

轻松豌豆。

# android - 来自自定义列表视图的活动刷新命令

> ID：11833622
> 
> 赞同：0
> 
> 时间：2012-08-06T18:11:43.547
> 
> 标签：android, listview, android-activity, refresh

环境：安卓2.2+

我有一个活动。Activity 使用它的适配器创建一个自定义列表视图并填充它。当用户单击列表中的项目（ImageView 缩略图）时，会显示一个上下文菜单。选择的后果是需要刷新Activity的视图。

我的问题是：如何从自定义适配器的 onClick 向 Activity 发送命令，要求刷新自身？

**活动**

```
 ...
    ListView lv;
    lv = (ListView) findViewById(R.id.lvlist);
    lv.setAdapter(null);
    MyCustomAdapter lvAdapter = new MyCustomAdapter(...);
    lv.setAdapter(lvAdapter);
    lv.setOnItemClickListener(myClickListener);
    ... 
```

**MyCustomAdapter**（每个列表项中有一个缩略图 ImageView，称为 ivLogo）

```
 ...
    ivLogo.setOnClickListener(new OnClickListener() {

        @Override
        public void onClick(View v) {
            // Carry out some tasks

            // At this point inform Activity that it needs to refresh
        }
    }); 
```

必须注意的是，我没有在 myClickListener 中寻找任何东西。我想要来自缩略图的 onClickListener 的信号。

我搜索了互联网，但找不到任何对这个特定案例有帮助的东西。任何帮助/指针将不胜感激。

TIA

-sph

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T18:25:00.373

将此行添加到您的 onClick()

```
lvAdapter.notifyDataSetChanged(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T18:23:17.657

> 每当您需要刷新 adpater 时，您就编写他的代码……它起作用了

```
lvAdapter .notifyDataSetChanged(); 
```

# java - 如何将一个窗口附加到另一个窗口

> ID：11833626
> 
> 赞同：0
> 
> 时间：2012-08-06T18:11:59.317
> 
> 标签：java, swing, user-interface, jframe, jdialog

请看下面的代码

**主.Java**

```
import java.awt.event.*;
import java.awt.*;
import javax.swing.*;

public class Main extends JFrame
{
    private JButton ok;

    public Main()
    {
        ok = new JButton("OK");
        ok.addActionListener(new ButtonAction());

        JPanel panel = new JPanel();
        panel.setLayout(new FlowLayout());
        panel.add(ok);

        getContentPane().add(panel,"South");

        this.setVisible(true);
        this.setSize(new Dimension(200,200));
        this.validate();
        this.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

    }

    public static void main(String[]args)
    {
        try
        {
            UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
            new Main();
        }
        catch(Exception e)
        {

        }
    }

    private class ButtonAction implements ActionListener
    {
        public void actionPerformed(ActionEvent ae)
        {
            Dialog d = new Dialog();
            d.setVisible(true);
        }
    }

} 
```

**对话框.java**

```
import java.awt.Event;
import java.awt.*;
import javax.swing.*;

public class Dialog extends JDialog
{
    private JButton done;

    public Dialog()
    {
        done = new JButton("Done");

        this.add(done);

        this.setSize(new Dimension(400,200));
    }

} 
```

在这里，我想将 Dialog 表单“附加”到主表单。这意味着，当我单击 Main.Java 中的 OK 按钮时，对话框表单将附加到主表单的右侧。所以，当我移动主窗体时，对话框也会移动。但是，对话框表单应该是独立的，这意味着当我在对话框表单中单击“x”按钮时，只有那个表单存在，而不是主表单。

单击按钮时，如何将此对话框表单附加到主表单的右侧？请帮忙！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T18:21:31.527

答案不是 MouseListener，而是 ComponentListener。我设法使用该侦听器的“componentMoved()”方法来做到这一点。

主.java

```
import java.awt.event.*;
import java.awt.*;
import javax.swing.*;

public class Main extends JFrame implements ComponentListener, ActionListener
{
    private JButton ok;
    private Dialog dialog;

    public Main()
    {
        ok = new JButton("OK");
        ok.addActionListener(this);

        dialog = new Dialog();

        JPanel panel = new JPanel();
        panel.setLayout(new FlowLayout());
        panel.add(ok);

        getContentPane().add(panel,"South");

        this.addComponentListener(this);

        this.setVisible(true);
        this.setSize(new Dimension(200,200));
        this.validate();
        this.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    }

    public static void main(String[]args)
    {
        try
        {
            UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
            new Main();
        }
        catch(Exception e){}
    }

    public void actionPerformed(ActionEvent ae)
    {   
        dialog.setVisible(true);
    }

    @Override
    public void componentHidden(ComponentEvent arg0) {}

    @Override
    public void componentMoved(ComponentEvent arg0) 
    {
        int x = this.getX() + this.getWidth();
        int y = this.getY();

        dialog.setDialogLocation(x, y);
    }

    @Override
    public void componentResized(ComponentEvent arg0) {}

    @Override
    public void componentShown(ComponentEvent arg0) {}
} 
```

对话框.java

```
import java.awt.Dimension;

import javax.swing.JButton;
import javax.swing.JDialog;

public class Dialog extends JDialog
{
    private JButton done;

    public Dialog()
    {
        done = new JButton("Done");

        this.add(done);

        this.setSize(new Dimension(400,200));
    }

    public void setDialogLocation(int x, int y)
    {
        this.setLocation(x, y);
    }

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T18:23:56.347

我不知道您可以说“dialog.moveWithThisOtherWindow(otherWindow)”或类似的任何内置函数，它就发生了。您必须自己编写代码来执行此操作。

在父窗体上创建鼠标侦听器或鼠标适配器。在鼠标侦听器中的“鼠标移动”事件中，移动子窗体。当然，父母必须对孩子有所了解。根据您创建窗口的方式，您可能需要某种“注册”函数，孩子可以调用该函数来向父母表明自己的身份。

# jquery - 减慢动画jquery？

> ID：11833627
> 
> 赞同：0
> 
> 时间：2012-08-06T18:12:01.737
> 
> 标签：jquery

基本上，我有一个工作功能，我想稍微调整一下，但我不太明白。一旦按下，这将切换 div 的动画，虽然不仅仅是“停止”或清除计时器，我希望它慢慢旋转回 0 然后清除计时器......这可能吗？

```
var $elem = $('#optionBtn'),
    degree = 0,
    timer;

function rotate() {
    $elem.css({
        WebkitTransform: 'rotate(' + degree + 'deg)'
    });
    $elem.css({
        '-moz-transform': 'rotate(' + degree + 'deg)'
    });
    timer = setTimeout(function() {
        ++degree;
        rotate();
    }, 5);
}
$("#optionBtn").toggle(

function(e) {
    rotate();
},

function() {
    clearTimeout(timer);
}); 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T18:21:13.917

尝试使用这个 jQuery 路径。它会简化你的代码：

[http://www.zachstronaut.com/posts/2009/08/07/jquery-animate-css-rotate-scale.html](http://www.zachstronaut.com/posts/2009/08/07/jquery-animate-css-rotate-scale.html)

# c# - 使用 Xdocument 读取 XML

> ID：11833629
> 
> 赞同：2
> 
> 时间：2012-08-06T18:12:05.750
> 
> 标签：c#, xml, linq

我的课：

```
public class Device
{
     int ID;
     string Name;
     List<Function> Functions;
} 
```

和类功能：

```
public class Function
{
     int Number;
     string Name;
} 
```

我有这个结构的xml文件：

```
 <Devices>
   <Device Number="58" Name="Default Device" >
     <Functions>
         <Function Number="1" Name="Default func" />
         <Function Number="2" Name="Default func2" />
         <Function Number="..." Name="...." />
     </Functions>
   </Device>
 </Devices> 
```

这是代码，我正在尝试读取对象：

```
 var list = from tmp in document.Element("Devices").Elements("Device")
                       select new Device()
                       {
                           ID = Convert.ToInt32(tmp.Attribute("Number").Value),
                           Name = tmp.Attribute("Name").Value,
                           //??????
                       };
            DevicesList.AddRange(list); 
```

我如何阅读“功能”？？？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-06T18:15:32.043

再次做同样的事情，使用`Elements`and`Select`将一组元素投影到对象。

```
var list = document
     .Descendants("Device")
     .Select(x => new Device {
                     ID = (int) x.Attribute("Number"),
                     Name = (string) x.Attribute("Name"),
                     Functions = x.Element("Functions")
                                  .Elements("Function")
                                  .Select(f =>
                                      new Function {
                                      Number = (int) f.Attribute("Number"),
                                      Name = (string) f.Attribute("Name")
                                    }).ToList()
                  }); 
```

为了清楚起见，我实际上建议`FromXElement`在每个`Device`和中编写一个静态方法`Function`。然后每一位代码只能做一件事。例如，`Device.FromXElement`可能看起来像这样：

```
public static Device FromXElement(XElement element)
{
    return new Device
    {
        ID = (int) element.Attribute("Number"),
        Name = (string) element.Attribute("Name"),
        Functions = element.Element("Functions").Elements("Function")
                         .Select(Function.FromXElement)
                         .ToList();
    };
} 
```

这也允许您在类中将设置器设为私有，因此它们可以是公开的不可变的（在集合周围需要一些努力）。

# codeigniter - Codeigniter base_url() 无法正常工作

> ID：11833634
> 
> 赞同：0
> 
> 时间：2012-08-06T18:13:01.610
> 
> 标签：codeigniter, url, hyperlink, uri

我已经这样设置`base_url()`了

```
 $config['base_url'] = 'http://example.com/'; 
```

`www`现在的问题是，如果url 之前没有，所有链接都可以正常工作。但是，如果尝试`www`在 url 之前使用访问网站`http://www.example.com/`，`base_url()`则无法正常工作。如果我添加`www`比`base_url()`没有链接`www`不起作用。

我的 .htaccess 如下，

```
RewriteEngine on
RewriteCond $1 !^(index\.php|resources|robots\.txt)
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ index.php/$1 [L,QSA] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-17T13:36:36.310

你必须去 application/config/autoload.php 然后做这个改变

```
$autoload['helper'] = array('url'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-17T13:36:37.920

转到应用程序>>配置>> autoload.php

并添加

```
$autoload['helper'] = array('url'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-17T13:42:50.507

您也可以在控制器中执行此操作。

```
$this->load->helper('url'); 
```

# arrays - 重新分配/擦除 numpy 数组与循环中的新分配

> ID：11833637
> 
> 赞同：0
> 
> 时间：2012-08-06T18:13:02.677
> 
> 标签：arrays, memory-management, numpy

在我的程序中，我需要在一个循环超过 1000 次的函数中处理大约 500x500 到 1500x1500 的数组。在每次迭代中，我需要从一个具有相同形式的数组开始（其尺寸在所有迭代中都是固定的）。初始值将是：

```
[0 0 0 ... 1]
[0 0 0 ... 1]
.... 
```

但是，数组的内容将在循环内被修改。将数组“重置”为这种格式的最有效方法是什么，这样我每次都可以将相同的数组传递给函数，而不必每次都分配一组新的内存？（我知道被修改的行的范围）

我试过了：

```
a[first_row_modified:last_row_modified,:] = 0.
a[first_row_modified:last_row_modified,:-1] = 1. 
```

但这与每次使用以下命令创建一个新数组所花费的时间大致相同：

```
a = zeros((sizeArray, sizeArray))
a[:,-1] = 1. 
```

有没有更快的方法来有效地“擦除”数组并将最后一列更改为 1？我认为这类似于这个问题，[清除 numpy array 的元素](https://stackoverflow.com/questions/11514394/clearing-elements-of-numpy-array)，尽管我的数组没有改变大小，而且我没有看到对先前提出的问题的明确答案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T18:16:56.837

不; 我认为你这样做的方式是尽可能快的。

# php - 使用 php ftp_ssl_connect 列出文件

> ID：11833639
> 
> 赞同：0
> 
> 时间：2012-08-06T18:13:06.607
> 
> 标签：php, ftp

连接 ftp_ssl_connect 时，我无法在 PHP 中获得目录列表。在 filezilla 中运行良好。

```
<?
$conn_id = ftp_ssl_connect($host,$port,10);
$result = ftp_login($conn_id, $user, $pass);

echo ftp_pwd($conn_id)."\n"; 
var_dump( ftp_nlist($conn_id, '/') );
?> 
```

返回：

/

布尔（假）

我也尝试过使用 pasv 模式，但没有运气。

在 nlist 命令之后需要很长时间 - 就好像它正在超时一样。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-11T14:07:13.153

代码没问题，是防火墙问题。

# c# - 使用 rundll32.exe 启动单击一次部署 URL？

> ID：11833641
> 
> 赞同：3
> 
> 时间：2012-08-06T18:13:20.367
> 
> 标签：c#, windows, clickonce, web-deployment-project, rundll32

我在 Windows 的命令提示符下使用以下命令：

```
C:\Users\myusername>rundll32.exe dfshim.dll,LaunchApplication "http://ClickOnceDeplymentURL.application" NULL 0 
```

但什么也没发生？没有错误或什么都没有。我希望它能够启动部署更新......我在这里遗漏了什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-25T12:56:34.830

[此答案](https://stackoverflow.com/a/6028342/113116)提到`LaunchApplication`仅自 .NET Framework 2 SP 2 起可用。请尝试使用该`ShOpenVerbApplication`功能：

```
rundll32.exe dfshim.dll, ShOpenVerbApplication http://ClickOnceDeplymentURL.application 
```

# javascript - 需要重置功能我该怎么做

> ID：11833645
> 
> 赞同：0
> 
> 时间：2012-08-06T18:13:31.217
> 
> 标签：javascript, jquery

我想在两者之间重置这个闪存，这样我就不必等到最后重新启动闪存，我该如何重置这个？

```
function flash() {
var arrayId = 0,
    splitSet = $('#text_original').html().split(" "),
    splitSetLength = splitSet.length;

function flashWord() {
    $("#flash_word").html(splitSet[arrayId]);
    arrayId += 1;
    var t = setTimeout(remove, 1000);
}

function remove() {
    if (arrayId < splitSetLength) {
        $("#flash_word").html(" ");
        flashWord();
    } //else reset_flash();
}
flashWord(); } 
```

请参阅[http://jsfiddle.net/HcDfS/](http://jsfiddle.net/HcDfS/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T18:19:27.273

将计时器变量设为全局变量并取消其超时（使用`clearTimeout()`）。然后，隐藏`#flash_word`。

我冒昧地重新实现了你的小提琴：

```
var timer, words;

function startFlashing() {
    words = $("#source").text().split(" ");
    showNextWord(0);
}

function stopFlashing() {
    clearTimeout(timer);
    $("#banner").text("");
}

function showNextWord(index) {
    $("#banner").text(words[index]);
    index++;
    if (index < words.length) timer = setTimeout(function () {
        showNextWord(index);
    }, 1000);
    else $("#banner").text("");
} 
```

​ 使用 HTML：

```
<p id="source">This is the text to be flashed.</p>
<button onclick='startFlashing()'>Start Flashing!</button>
<button onclick='stopFlashing()'>Stop Flashing!</button>
<p id="banner"></p>​ 
```

它在这里：http: [//jsfiddle.net/CZnVc/6/](http://jsfiddle.net/CZnVc/6/)

# javascript - 在元素上绘制边框，但不捕获事件

> ID：11833647
> 
> 赞同：0
> 
> 时间：2012-08-06T18:13:47.433
> 
> 标签：javascript, css, internet-explorer

是否可以两者兼得：

*   在 HTML 中的其他元素上绘制一些东西
*   不捕获鼠标事件（单击、悬停）

在 IE8 中（实际上是 IE9@IE8 模式）？也许，VML 或一些棘手的行为。

在其他浏览器中我可以使用`box-shadow`, 但`DropShadow`和`Blur`过滤 IE 捕获事件。有什么选择吗？

`mouseover`我知道，我可以捕获事件并重新触发它们，但是/仍然存在问题`mouseout`。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T23:32:32.030

看到这个答案：[https ://stackoverflow.com/a/11115375/638544](https://stackoverflow.com/a/11115375/638544)

简短版本：在 IE 中，具有背景颜色`transparent`和渐变的元素不会接收鼠标事件。因此，将其添加到您的 CSS 中：

```
.ie #overlay {
    background: transparent;
-ms-filter: "progid:DXImageTransform.Microsoft.gradient(startColorstr=#000000,endColorstr=#000000)"; /* IE8 */
    filter: progid:DXImageTransform.Microsoft.gradient(startColorstr=#000000,endColorstr=#000000);   /* IE6 & 7 */
    zoom: 1;
} 
```

（当然，您可以使用另一种针对 IE 的`background`声明方法，您可以将颜色字符串更改为您喜欢的任何值。）

# c++ - 编码竞赛的 C 编码评估器

> ID：11833650
> 
> 赞同：-5
> 
> 时间：2012-08-06T18:13:57.867
> 
> 标签：c++, c

我计划在我的大学组织一次编码比赛。编码竞赛基于解决一些 C 程序。我需要通过应用程序评估他们的程序是否正确。是否有任何类型的应用程序或软件来评估他们的程序？提前致谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-06T18:16:22.327

[DOMjudge](http://domjudge.sourceforge.net/)就是为此而设计的。

它用于许多比赛，包括[ICPC](http://en.wikipedia.org/wiki/ACM_International_Collegiate_Programming_Contest)。

# ipython - 记录 IPython 输出？

> ID：11833654
> 
> 赞同：12
> 
> 时间：2012-08-06T18:14:14.517
> 
> 标签：ipython

有什么方法可以让 IPython 的日志记录功能包括输出和输入？

这是当前日志文件的样子：

```
#!/usr/bin/env python 
# 2012-08-06.py 
# IPython automatic logging file
# 12:02 
# =================================
print "test" 
```

我想再显示一条线：

```
#!/usr/bin/env python 
# 2012-08-06.py 
# IPython automatic logging file
# 12:02 
# =================================
print "test"
# test 
```

（这`#`是因为我认为这是防止破坏 IPython 的`logplay`功能所必需的）

我想这可以使用 IPython 笔记本，但在至少一台我需要它的机器上，我仅限于 ipython 0.10.2。

编辑：我想知道如何自动设置它，即在配置文件中。现在我的配置看起来像

```
from time import strftime
import os
logfilename = strftime('ipython_log_%Y-%m-%d')+".py" 
logfilepath = "%s/%s" % (os.getcwd(),logfilename) 

file_handle = open(logfilepath,'a') 
file_handle.write('########################################################\n') 
out_str = '# Started Logging At: '+ strftime('%Y-%m-%d %H:%M:%S\n') 
file_handle.write(out_str) 
file_handle.write('########################################################\n') 
file_handle.close() 

c.TerminalInteractiveShell.logappend = logfilepath
c.TerminalInteractiveShell.logstart = True 
```

但指定`c.TerminalInteractiveShell.log_output = True`似乎没有影响

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-06T19:05:24.570

有以下`-o`选项`%logstart`：

```
-o: log also IPython's output.  In this mode, all commands which
  generate an Out[NN] prompt are recorded to the logfile, right after
  their corresponding input line.  The output lines are always
  prepended with a '#[Out]# ' marker, so that the log remains valid
  Python code. 
```

附录：如果您处于已开始记录的交互式 ipython 会话中，则必须首先停止记录，然后重新启动：

```
In [1]: %logstop

In [2]: %logstart -o
Activating auto-logging. Current session state plus future input saved.
Filename       : ./ipython.py
Mode           : backup
Output logging : True
Raw input log  : False
Timestamping   : False
State          : active 
```

请注意，重新启动后，“输出日志记录”现在为“真”。

# ios - 通过电子邮件进行临时分发

> ID：11833663
> 
> 赞同：7
> 
> 时间：2012-08-06T18:14:55.070
> 
> 标签：ios, ios-provisioning

在[这个网站上](https://developer.apple.com/programs/ios/distribute.html)，我发现你可以通过电子邮件分发：

> **临时分发**
> 
> 通过 Ad Hoc 分发，您可以与多达 100 位其他 iPad、iPhone 或 iPod touch 用户共享您的应用程序。***通过电子邮件***或将其发布到服务器，用户可以下载并安装您的应用程序。

我找不到有关如何执行此操作的任何说明。由于它说“通过电子邮件**或**通过将其发布到服务器”，我希望能够在不使用服务器的情况下发送附有所需文件的电子邮件。这可能吗？

我尝试通过电子邮件向自己发送在 Xcode 中归档应用程序产生的 .ipa，但它说：

> 邮件无法打开此附件。

如果 Mail 应用程序不知道如何处理它，我如何通过电子邮件分发应用程序？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-06T18:17:21.190

您需要通过 iTunes 加载 IPA 文件。

只要您在创建 IPA 时拥有正确的设备证书，就应该能够将 IPA 拖放到 iTunes 中连接的设备上。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-06T18:27:55.410

有OTA（无线）选项。检查本[教程](http://www.google.it/url?sa=t&rct=j&q=ota%20ad%20hoc&source=web&cd=1&ved=0CFwQFjAA&url=http://mobiledevelopertips.com/xcode/distribute-ad-hoc-applications-over-the-air-ota.html&ei=SAwgUKT3June4QTq7YDgBA&usg=AFQjCNEKBhUA4-58pdjZeAbTRh5cqbQurQ&sig2=PRcewVvgbujxVSCWGaSPpg)

# ruby-on-rails - 在 ruby on rails 中从三种不同模型中订购数据

> ID：11833666
> 
> 赞同：3
> 
> 时间：2012-08-06T18:15:07.697
> 
> 标签：ruby-on-rails, activerecord, join

我有三个模型，即图像、数据文件和视频。我想从所有三个模型中获取用户的最新内容。

这样做非常糟糕的一个可能是：

```
 images = User.find(8).images
  videos = User.find(8).videos
  data_files = User.find(8).data_files 
```

所有内容：

```
 all_content = images + videos + data_files
 all_content.sort_by(&:created_at).reverse.paginate(:page => params[:page],:per_page=> per_page) 
```

如何仅在一个查询中执行此操作以使代码更好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T07:30:51.410

`Content`拥有一个将用户连接到他的内容的模型可能是一个好主意。像这样的东西：

```
class User < ActiveRecord::Base
  has_many :contents
end

class Content < ActiveRecord::Base
  belongs_to :user
  # Remember the contentable_type and contentable_id columns
  belongs_to :contentable, :polymorphic => true
end

# Similar relations for Image/File models
class Video < ActiveRecord::Base
  has_one :content, :as => :contentable
  belongs_to :user, :through => :content
end

# Then to fetch the last contents from the user
Content.where(:user_id => 8).order('created_at DESC')
       .paginate(:page => params[:page], :per_page=> per_page) 
```

这只是一个概念证明，如果您愿意，您甚至可以使用[单表继承](http://api.rubyonrails.org/classes/ActiveRecord/Base.html#label-Single+table+inheritance)，这取决于每个内容模型具有的属性，考虑到这些对象通常包含标题、正文、指向的链接，这可能是更好的选择内容，网址和类似的东西，几乎没有区别。

如果您使用 STI，您需要`Content`为每个内容模型（例如`Image`或`Video`）定义一个具有公共属性的基本模型（在这种情况下）和几个其他模型。这些模型继承自 Content 模型。请记住`contents`在您的数据库中有一个表，其中包含一个`type`列（其中将包含具有内容类型的字符串，例如“视频”）和子模型的所有列（是的，如果您使用这种方法，所有数据都将进入一张*桌子*）。

**更新**：单表继承方法有几个优点，例如，您在一个查询中获取所有内容的数据，以前的解决方案适合排序，但您仍然需要获取视频和其他特定数据与其他查询：

```
# The contents table has a type string column and
# all the specific models's columns
class Content < ActiveRecord::Base
end

# Video class inherit from Content (a Video is a Content!)
class Video < Content
end 
```

在这种情况下，如果您想要所有可以使用的用户内容`user.contents`，您将获得特定对象（视频、图像等）的数组，具体取决于它们的类型。您也可以使用类似的方式获取图像或视频`Video.all`

当然这些只是想法，真正的实现取决于你的问题和要求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T06:08:45.337

那么你可以在用户模型中做这样的事情：

```
def resources
  (images + videos + data_files).sort_by(&:created_at).reverse
end 
```

然后打电话

```
User.find(8).resources.paginate(:page => params[:page],:per_page=> per_page) 
```

# apache-pig - JOIN 后重命名字段需要时间吗？

> ID：11833669
> 
> 赞同：4
> 
> 时间：2012-08-06T18:15:24.257
> 
> 标签：apache-pig

在以下代码中，连接后重命名字段对脚本计算时间的影响有多大？是否在 Pig 中进行了优化？还是真的会遍历每条记录？

```
-- tables A: (f1, f2, id)  and B: (g1, g2, id) to be joined by id
C = JOIN A BY id, B by id;
C = FOREACH C GENERATE A::f1 AS f1, A::f2 AS f2, B::id AS id, B::g1 AS g1, B::g2 AS g2; 
```

`FOREACH`该命令是否遍历 C 的每条记录？如果是，有没有办法优化？

谢谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-07T16:05:23.530

不要担心优化这个，重命名字段可能会有一点开销，但它不会触发额外的 Map/Reduce 作业。场投影将在您的`JOIN`.

考虑下面给出的两段代码和 Map Reduce 计划[`explain`](http://pig.apache.org/docs/r0.10.0/test.html#explain)。

### 不重命名

```
A = load 'first' using PigStorage() as (f1, f2, id);
B = load 'second' using PigStorage() as (g1, g2, id);

C = join A by id, B by id;

store C into 'output';

#--------------------------------------------------
# Map Reduce Plan                                  
#--------------------------------------------------
MapReduce node scope-30
Map Plan
Union[tuple] - scope-31
|
|---C: Local Rearrange[tuple]{bytearray}(false) - scope-20
|   |   |
|   |   Project[bytearray][2] - scope-21
|   |
|   |---A: New For Each(false,false,false)[bag] - scope-7
|       |   |
|       |   Project[bytearray][0] - scope-1
|       |   |
|       |   Project[bytearray][1] - scope-3
|       |   |
|       |   Project[bytearray][2] - scope-5
|       |
|       |---A: Load(hdfs://location/first:PigStorage) - scope-0
|
|---C: Local Rearrange[tuple]{bytearray}(false) - scope-22
    |   |
    |   Project[bytearray][2] - scope-23
    |
    |---B: New For Each(false,false,false)[bag] - scope-15
        |   |
        |   Project[bytearray][0] - scope-9
        |   |
        |   Project[bytearray][1] - scope-11
        |   |
        |   Project[bytearray][2] - scope-13
        |
        |---B: Load(hdfs://location/second:PigStorage) - scope-8--------
Reduce Plan
C: Store(hdfs://location/output:org.apache.pig.builtin.PigStorage) - scope-27
|
|---POJoinPackage(true,true)[tuple] - scope-32--------
Global sort: false
---------------- 
```

### 重命名

```
A = load 'first' using PigStorage() as (f1, f2, id);
B = load 'second' using PigStorage() as (g1, g2, id);

C = join A by id, B by id;
C = foreach C generate A::f1 as f1,  -- This
                       A::f2 as f2,  -- section
                       B::id as id,  -- is
                       B::g1 as g1,  -- different
                       B::g2 as g2;  --

store C into 'output';

#--------------------------------------------------
# Map Reduce Plan                                  
#--------------------------------------------------
MapReduce node scope-41
Map Plan
Union[tuple] - scope-42
|
|---C: Local Rearrange[tuple]{bytearray}(false) - scope-20
|   |   |
|   |   Project[bytearray][2] - scope-21
|   |
|   |---A: New For Each(false,false,false)[bag] - scope-7
|       |   |
|       |   Project[bytearray][0] - scope-1
|       |   |
|       |   Project[bytearray][1] - scope-3
|       |   |
|       |   Project[bytearray][2] - scope-5
|       |
|       |---A: Load(hdfs://location/first:PigStorage) - scope-0
|
|---C: Local Rearrange[tuple]{bytearray}(false) - scope-22
    |   |
    |   Project[bytearray][2] - scope-23
    |
    |---B: New For Each(false,false,false)[bag] - scope-15
        |   |
        |   Project[bytearray][0] - scope-9
        |   |
        |   Project[bytearray][1] - scope-11
        |   |
        |   Project[bytearray][2] - scope-13
        |
        |---B: Load(hdfs://location/second:PigStorage) - scope-8--------
Reduce Plan
C: Store(hdfs://location/output:org.apache.pig.builtin.PigStorage) - scope-38
|
|---C: New For Each(false,false,false,false,false)[bag] - scope-37
    |   |
    |   Project[bytearray][0] - scope-27
    |   |
    |   Project[bytearray][1] - scope-29
    |   |
    |   Project[bytearray][5] - scope-31
    |   |
    |   Project[bytearray][3] - scope-33
    |   |
    |   Project[bytearray][4] - scope-35
    |
    |---POJoinPackage(true,true)[tuple] - scope-43--------
Global sort: false
---------------- 
```

不同之处在于减少计划。不重命名：

```
Reduce Plan
C: Store(hdfs://location/output:org.apache.pig.builtin.PigStorage) - scope-27
|
|---POJoinPackage(true,true)[tuple] - scope-32--------
Global sort: false 
```

与重命名相比：

```
Reduce Plan
C: Store(hdfs://location/output:org.apache.pig.builtin.PigStorage) - scope-38
|
|---C: New For Each(false,false,false,false,false)[bag] - scope-37
    |   |
    |   Project[bytearray][0] - scope-27
    |   |
    |   Project[bytearray][1] - scope-29
    |   |
    |   Project[bytearray][5] - scope-31
    |   |
    |   Project[bytearray][3] - scope-33
    |   |
    |   Project[bytearray][4] - scope-35
    |
    |---POJoinPackage(true,true)[tuple] - scope-43--------
Global sort: false 
```

In short, there will be other things you can optimize in your script before worrying about renaming. Since you'll be going through every record anyway because of the `join`, renaming will just be a cheap extra step.

# delphi - 带变量的 SQL 查询

> ID：11833675
> 
> 赞同：2
> 
> 时间：2012-08-06T18:15:54.107
> 
> 标签：delphi, delphi-7

我正在为学校做 PAT，我正在做以下如何纠正它。我想发送一个输入的**电子邮件地址**、**姓名**、**身份证号码**、**出生日期**、**性别**、**城镇**，所有这些都是字符串，我的声明是：

```
Adoquery1.sql.text := 'insert into besprekings 
                       values('email', 'name', 'Id', 'birth', 'gender', 'town')'; 
```

字段如下：

```
 Email(string), Name(string), ID(string), Birth(string), Gender(string), town(string) 
```

这不是真正的家庭作业，它是一个占我年数 25% 的项目。我已经完成了一切，但无法做到这一点。我们必须引入一些我们在学校没有学过的新东西，对我来说，打开邮件（windows 8）之类的程序并这样做我真的很感谢每个试图提供帮助的人。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-06T19:35:59.297

您需要使用参数化查询，以防止 SQL 注入。尽管现在在您的应用程序中可能不需要担心这件事，但最好首先养成正确执行此操作的习惯。我将展示一些代码，您可以自己弄清楚如何完成它。

首先，正确填充您的 SQL。指定要插入的列的名称，以及用于填充它们的参数名称（以 开头的部分`:`）：

```
ADOQuery1.SQL.Clear;
ADOQuery1.SQL.Add('INSERT INTO beskprekings (email, name, Id)');
ADOQuery1.SQL.Add('VALUES (:email, :name, :Id)'); 
```

现在将要插入的实际值放入参数中，使用您在`VALUES`列表中使用的相同名称：

```
ADOQuery1.Parameters.ParamByName('email').Value := email;
ADOQuery1.Parameters.ParamByName('name').Value := name;
ADOQuery1.Parameters.ParamByName('id').Value := Id; 
```

现在，执行查询。

使用参数化查询的额外好处是，一旦运行一次，您可以简单地重新填充参数并再次运行；数据库已经完成了`prepare`查询所需的工作（提示：我标记的词对 ADO 和其他数据库有意义——你应该研究一下），这样当你一次又一次地使用它时它会更快。

# r - 如何禁止打印表格的 0 行？

> ID：11833676
> 
> 赞同：0
> 
> 时间：2012-08-06T18:15:55.733
> 
> 标签：r

我有两个因子向量`v1`和`v2`，它们似乎密切相关（每个向量的熵非常接近它们的联合熵）。确实，当我这样做时`table(v1,v2)`，我会看到如下内容：

```
 v2
 v1  a2   b2   c2
 a1  0    100   0
 b1  0    0     0
 c1  0    0     0
     v2 
 v1  d2   e2   f2
 a1  0    0     0
 b1  0    0     0
 c1  0    0     0 
```

依此类推 - 每个因素都有几十个级别，所以我得到很多全为 0 的行。

如何打印一个表格，省略其中只有零的行？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-06T18:40:41.633

每个人似乎都使用`rowSums(d)==0`或等效，但这也会抑制任何具有相同数量的一和减一或任何其他零和组合的行。更安全的是使用：

```
d[ rowSums(d==0) != ncol(d) , ] 
```

我想在对象是'table'的结果的情况下，不会有负面条目的风险，但是当这个策略不恰当地应用于其他设置时，风险就会发生。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-06T18:24:52.383

我会接近这个`rowsums`以获得大于0的逻辑向量。然后使用带有索引的vextor，如下所示：

```
#make an example (please do this for yourself in the future)
d <- table(x=1:5, y=1:5)
d[1, 1] <- 0 #make one row have all 0s

d[rowSums(d) > 0, ] 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-06T18:31:21.727

使用您的示例：

```
v1 <- factor(rep("a1", 100), levels = paste0(letters[1:3], 1))
v2 <- factor(rep("b2", 100), levels = paste0(letters[1:6], 2))

R> table(v1, v2)
    v2
v1    a2  b2  c2  d2  e2  f2
  a1   0 100   0   0   0   0
  b1   0   0   0   0   0   0
  c1   0   0   0   0   0   0 
```

然后该`rowSums()`函数将计算行总和以供使用。这是有效的，因为表是变相的向量或矩阵。请注意，在下面显示中间步骤的序列中，我们如何通过询问行和是否超过 0 将其转换为逻辑向量。

```
R> rowSums(tab)
 a1  b1  c1 
100   0   0 
R> rowSums(tab) > 0
   a1    b1    c1 
 TRUE FALSE FALSE 
R> tab[rowSums(tab) > 0, ]
 a2  b2  c2  d2  e2  f2 
  0 100   0   0   0   0 
```

以上删除了空维度。如果您想保留表格格式，请添加`drop = FALSE`到调用中，但请注意其中的额外内容`,`，因为我们想要所有列，因此 之间的空参数`, ,`：

```
R> tab[rowSums(tab) > 0, , drop = FALSE]
    v2
v1   a2  b2 c2 d2 e2 f2
  a1  0 100  0  0  0  0 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-06T19:37:24.187

从@Gavin 的答案中借用示例数据

```
v1 <- factor(rep("a1", 100), levels = paste0(letters[1:3], 1))
v2 <- factor(rep("b2", 100), levels = paste0(letters[1:6], 2)) 
```

您可以`droplevels`用来消除那些没有出现在任何地方的值（相当于全为 0 的行，或全为 0 的列）

```
> table(droplevels(v1), droplevels(v2))

      b2
  a1 100 
```

如果您只想删除行：

```
> table(droplevels(v1), v2)
    v2
      a2  b2  c2  d2  e2  f2
  a1   0 100   0   0   0   0 
```

# javascript - 在 jQuery 中扩展 $fn 命名空间

> ID：11833678
> 
> 赞同：4
> 
> 时间：2012-08-06T18:16:06.917
> 
> 标签：javascript, jquery, prototype

这看起来很简单，但我不知道如何扩展 $fn 命名空间。

**JS：**

```
(function ($) {
    $.fn.myorg.level1.level2.myFunction = function (usettings, params) {  
        return this.each(function () {
            //do work...etc
        });
    };
} (jQuery));

$("bla").myorg.level1.level2.myFunction(...); 
```

如何定义命名空间链，以便我可以编写像上面这样的函数？

我给出的示例非常简单，命名空间不会很深，但是，我需要能够随意扩展和添加功能......等到我的命名空间树。我不想为我添加的每个附加功能/级别重新定义树。

我还没有看到任何好的例子。如果我保持在 $fn 级别，这很容易，但这并不能使我的代码像我需要的那样干净和可扩展。

如果我的要求是不可能的，那么正确的方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T18:26:15.743

Epascarello 暗示了这一点，但我猜前面的对象没有定义。

```
console.log($.fn.myorg); // undefined

$.fn.myorg.level1 = function(){}; // TypeError: Cannot set property 'level1' of undefined 
```

但如果我们先定义事物：

```
$.fn.myorg = $.fn.myorg || {}; // if this object doesn't exist, create an blank object
console.log($.fn.myorg); // object

$.fn.myorg.level1 = function(){};
console.log($.fn.myorg.level1); // function 
```

# excel - 循环内的案例语句

> ID：11833683
> 
> 赞同：2
> 
> 时间：2012-08-06T18:16:23.153
> 
> 标签：excel, vba

如何在 VBA 的循环中创建 case 语句（或多个 if 语句）？

在此示例中，我有一个包含 4 个名称的列表，它们对应于 4 个不同的组。这些名称位于电子表格的“C”列中，我想创建一个新列“D”列，其中列出了每个人的组名。

这是我目前正在使用的代码：

```
Sub AddGroupColumn()
   'Counts number of rows in sheet. Loops through rows.
   For i = 1 To Range("C1048576").End(xlUp).Row
       If Range("C2:C" & i).Value = "john.doe" Then
          Set Range("D2:D" & i).Value = "group 1"
       If Range("C2:C" & i).Value = "jane.doe" Then
          Range("D2:D" & i).Value = "group 2"
       If Range("C2:C" & i).Value = "james.doe" Then
          Range("D2:D" & i).Value = "group 3"
       If Range("C2:C" & i).Value = "jenn.doe" Then
          Range("D2:D" & i).Value = "group 4"
    Next i 
 End Sub 
```

请提供有关如何修复上述代码的建议。我知道语法已关闭，我不确定是否应该使用“If/Then/Else/Elseif”的“Case”语句。这是我目前收到的错误：

> 编译错误：Next 没有 For

另外，请告知是否有更有效的方法来解决此问题。在真实案例中，有 12 个名称、12 个组和 100,000 行名称。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T18:21:11.607

您`IF`所写的所有陈述都需要`ELSE IF`在第二个`IF`陈述上加上，然后是`END IF`在分组结束时的陈述。

你当然可以做一个`CASE`声明，如下：

```
Sub AddGroupColumn()
   'Counts number of rows in sheet. Loops through rows.
   For i = 1 To Range("C1048576").End(xlUp).Row
       Select Case Range("C2:C" & i).Value
           Case "john.doe"
                Range("D2:D" & i).Value = "group 1"
           Case "jane.doe"
                Range("D2:D" & i).Value = "group 2"
           ' The rest of your case statements go here ...
       End Select
    Next i 
End Sub 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-06T19:16:45.320

您可以将名称和组放入数组中。

```
Sub AddGroupColumn()

    Dim rCell As Range
    Dim rRng As Range
    Dim vaNames As Variant
    Dim vaGroups As Variant
    Dim lMatch As Long

    vaNames = Array("john.doe", "jane.doe", "james.doe", "jenn.doe")
    vaGroups = Array("group 1", "group 2", "group 3", "group 4")

    With Sheet1
        Set rRng = .Range("C1", .Cells(.Rows.Count, 3).End(xlUp))
    End With

    For Each rCell In rRng.Cells
        lMatch = Application.WorksheetFunction.Match(rCell.Value, vaNames, False)
        rCell.Offset(0, 1).Value = vaGroups(lMatch - 1)
    Next rCell

End Sub 
```

请注意，在您的示例中，您没有指定范围适用于哪个工作表。这些被称为不合格的范围引用，可能会导致一些意外行为。如果您的代码在标准模块中，则非限定范围指的是 ActiveSheet。如果您的代码在工作表类模块中，则不合格范围指的是该工作表。

如果 C 列中的某些名称没有组，则必须更改循环以解决此问题。像这样

```
For Each rCell In rRng.Cells
    On Error Resume Next
        lMatch = Application.WorksheetFunction.Match(rCell.Value, vaNames, False)
    On Error GoTo 0

    If lMatch - 1 > LBound(vaGroups) Then
        rCell.Offset(0, 1).Value = vaGroups(lMatch - 1)
    Else
        rCell.Offset(0, 1).Value = "No group"
    End If
Next rCell 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-06T18:58:25.523

您可以使用数组来完成所有这些操作，而不需要`If`or`Select Case`语句。这避免了必须一次将每个值写入工作表。

使用您的示例输入进行测试和工作（假设输入数据单列）：

```
Sub AddGroupColumn()

Dim inputRange As Excel.Range
Dim inputData As Variant
Dim outputData As Variant
Dim i As Long, j As Long
Dim nameslist As Variant
Dim groupslist As Variant

' **** EDIT THESE AS NEEDED, however they MUST correspond
Const NAMES_LIST As String = "john.doe,jane.doe,james.doe,jenn.doe"
Const GROUPS_LIST As String = "group 1,group 2,group 3,group 4"

' create arrays of names and groups
nameslist = Split(NAMES_LIST, ",")
groupslist = Split(GROUPS_LIST, ",")

' define input range
Set inputRange = Range("C2:C" & Range("C" & Rows.Count).End(xlUp).row)

' read column C values into array
inputData = inputRange.value
' resize output array to match input array
ReDim outputData(LBound(inputData) To UBound(inputData), 1 To 1)

' evaluate input array, output to another array
For i = LBound(inputData) To UBound(inputData)
  For j = LBound(nameslist) To UBound(nameslist)
    If inputData(i, 1) = nameslist(j) Then ' given input value is matched on the names list
      outputData(i, 1) = groupslist(j) ' output array is the corresponding group name
      Exit For ' exit loop since we found what we need in this loop
    End If
  Next j
Next i

  ' write output data to output range
  inputRange.Offset(, 1).value = outputData

End Sub 
```

当您将其应用于实际数据时，此过程将扩展。只需编辑这两个常量，**确保它们的值对应**。

通过使用 Rows.Count，无论 Excel 版本如何，它都将始终获取正确的范围。无论您拥有多少数据，数组都会自行调整大小。它所做的唯一假设是您的输入数据在一列中。

另请注意，我们只触摸工作表三次：一次定义输入范围，一次获取 C 列中的值，一次将计算值写回 D 列。

## 样本输入

![样本输入](../Images/cb1e770c10451b21a1d034616c509e35.png)

## 运行代码后

![样本输出](../Images/ba17bbcda0e29912837d310c791faee7.png)

# php - Foreach 键不递增

> ID：11833691
> 
> 赞同：0
> 
> 时间：2012-08-06T18:17:03.953
> 
> 标签：php, mysql

我正在创建一个班级书籍列表 - 有一个书籍的主列表，以及一个班级可以分配的书籍列表。我需要创建一个主列表数组，删除已经分配给班级的书籍，然后创建剩余书籍的选择列表。我有大部分工作，但我被困在一小部分。首先，我加载数组（book_id 是键，book_title 是值）：

```
while ($master_book = mysql_fetch_array($big_book_list)) {
$b_id = $master_book['master_book_list_id'];
$book_list[$b_id] = $master_book['book_title'];
} 
```

然后我删除了班级的主要书籍（已经设置好了）：

```
unset($book_list[$primary_book]); 
```

现在我加载已经分配的辅助书籍数组（主要和辅助书籍来自同一个列表）：

```
$secondary_query = "select * from class_books cb, master_book_list mbl where class_id ='$class_id' and cb.book_id = mbl.master_book_list_id;";
$secondary_list = mysql_query($secondary_query); 
```

现在我从主列表中删除 $secondary_list 中的书籍：

```
while ($secondary_book = mysql_fetch_array($secondary_list)) {
  $b_id = $secondary_book['book_id'];
  unset($book_list[$b_id]);
} 
```

此时， print_r 正确显示了我的数组。但是这段代码：

```
foreach ($book_list as $book2) {
  $the_key = key($book_list);
  echo $the_key . ' and book2 is '. $book2 . '<br/>';
} 
```

它将迭代预测的次数，但键保持相同的值（即“2”，数组中的第一个值。

谁能看到我做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T18:18:55.087

您可以从 foreach 循环中获取密钥：

```
foreach ($book_list as $the_key => $book2) {
    echo $the_key . ' and book2 is '. $book2 . '<br/>';
} 
```

# java - Java 应用程序与 Web 服务与 Web 应用程序

> ID：11833696
> 
> 赞同：0
> 
> 时间：2012-08-06T18:17:35.933
> 
> 标签：java, web-services

我正在开发一个多平台（Android、iPhone、Windows 和 Blacbberry）移动应用程序。该应用程序需要与我们的服务器进行通信以完成多项任务，例如检索好友列表等。服务器与存储在 MySQL 数据库中的数据进行交互。我打算用 Java 编写服务器元素，但是我对所有不同的类型感到困惑。到目前为止，我认为我已将其范围缩小到三个选项：

1) 我使用 Jetty 对应用程序进行编码以接受 http 帖子。我将 XML 发布到服务器，处理它，与数据库交互并返回一个 XML 响应。我会将应用程序保存为 jar 并让它在我的服务器上运行。

2）我开发了一个Java web 服务。REST/JSON/SOAP？

3）我开发了一个Java Web应用程序。

虽然已经有很多问题在询问差异是什么，但我正在努力寻找一个明确的解释，说明在哪种情况下最好的方法是什么。我以前使用过第一种方法，但假设第二种方法是更好的选择，我只是不确定优势是什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T18:21:59.937

我建议使用选项 2，因为它更轻量级并且可以直接在您的 Web 应用程序中解析。XML 需要更多开销并且必须进行翻译，而您可以直接从 Java 应用程序将对象序列化为 JSON，然后在前端用 javascript 解析它们

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T18:24:59.130

您的 1-3 个选项都是“Web 应用程序”的变体。

Jetty 是一个基于 Java 的 http server/servlet 容器。如果您想使用 http 在客户端和服务器之间进行通信，那么您正在使用 http 服务器（尽管不一定是 Jetty）。

Web 服务是 Web 应用程序的一部分，它符合关于客户端如何与服务器通信以及服务器如何向客户端提供信息的标准。

Web 应用程序是一种 Java 应用程序，可通过 http 提供服务。

因此，如果您想让您的客户端与服务器通信，并将信息存储在数据库中，那么您正在使用 Web 应用程序。

# security - 使用身份验证和客户端模板简单地处理无会话 Node.js

> ID：11833698
> 
> 赞同：1
> 
> 时间：2012-08-06T18:17:59.770
> 
> 标签：security, node.js, session, client-side, templating

我有一个问题——我在这里找到了一些答案。基本上，我希望有一个 node.js 服务器应用程序为请求提供 json 文档。所有模板都将在客户端发生一些请求需要身份验证，但大多数不需要。我想尽可能地消除对框架（快速）会话管理的需要（如链接所推荐的那样）以提高性能，所以我想到了几个身份验证解决方案。

1) 编写自定义身份验证，将会话保存为文档，并在向需要身份验证的 node.js 服务器发出请求时检查它。将所有用户信息保存在 html5 存储或 cookie 中，以便 dom 用于模板。+ 作品 - 必须编写自定义安全性以避免在 express/node 中进行会话管理。

2) 有 2 个 node.js 实例。一个服务于公共领域的一切。一种仅用于安全请求。仍然保留会话中的所有用户信息。+ 简单，因为我们可以将会话管理推送到需要身份验证的请求的框架上 - 有 2 个节点实例。可能有一些不好的 DRY。

第二种选择合理吗？还是我缺少另一个选择。选项 1 是我的后备方案，因为当它已经内置在 express 中时，我宁愿不执行所有自定义编码。

编辑：

在这里留下一种可能性，我想我可以在资源请求上使用多个回调来允许拦截器类型模式在会话中验证用户。这回答了第一个问题。

来自 express 文档：还可以传递几个回调，这对于重用加载资源、执行验证等的中间件很有用。 app.get('/user/:id', user.load, function(){ // 。 .. })

# performance - KSH：随时间平均分布命令

> ID：11833699
> 
> 赞同：2
> 
> 时间：2012-08-06T18:18:04.700
> 
> 标签：performance, shell, unix, ksh

我正在研究 ksh 性能脚本。它采用以下选项： - i（间隔时间） - p（每个间隔的消息） - t（总消息）

例如：“script -i 1 -p 2 -t 10”表示每秒 2 条消息，最多 10 条。

这是有效的，但脚本尚未在给定的时间间隔内平均分布消息。在这个例子中，脚本应该在 0.5 秒之后执行第二个命令，而不是之前。

可以轻松做到这一点吗？

简而言之，这就是我到目前为止所拥有的：

```
typeset -i i=0
typeset -i n=0

while [ $i -lt $TOTAAL ]; do
   while [ $n -lt $PERINT ]; do

      # execute this command

      n=$((n+1))
   done

   i=`expr $i + $PERINT`
   # Reset n
   n=0
   # Wait interval time
   sleep $INTERVAL
done 
```

-i：$INTERVAL 是一个整数 (0, 1, 2...)，不以任何方式计算。我已经完成了输入检查以防止脚本不期望的输入。

-t：$ 总计

-p：$PERINT

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T21:16:29.713

根据[serverfault question 340838](https://serverfault.com/questions/340838/what-version-of-ksh-ships-with-aix-5-3) Aix 5.3 在 /usr/bin/ksh93 中附带了一个单独的 ksh93 二进制文件。

这将具有亚秒`sleep`和浮点运算。在计算间隔时，请注意栅栏柱错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T15:46:31.547

感谢 Henk Langeveld，我发现 ksh93 是预装的。这是新脚本。它似乎工作正常。

```
typeset -i i=0
typeset -i n=0

while [ $i -lt $TOTAAL ]; do
   while [ $n -lt $PERINT ]; do

      # execute this command

      sleep $VERDELING
      n=$((n+1))
   done

   i=$((i+PERINT))
   # Reset n
   n=0
done 
```

这些是我使用的一些检查。我翻译了错误信息。

```
if [[ $PERINT -gt $TOTAAL ]]; then
  echo "[[31mFOUT[0m] Messages per interval cannot be greater then total amount"; exit
fi

VERGELIJK=`echo "scale=1; $TOTAAL / $PERINT" | bc`
if [[ $VERGELIJK = *.[1-9]* ]]; then
  echo "[[31mFOUT[0m] Messages per interval has to be a multiple of the total amount"; exit
fi

VERDELING=`echo "scale=2; $INTERVAL / $PERINT" | bc` 
```

# java - 如何替换字符串对象中的所有正则表达式字符串？

> ID：11833700
> 
> 赞同：0
> 
> 时间：2012-08-06T18:18:10.130
> 
> 标签：java, regex, str-replace

对于字符串`str_in = "instance (\\w+\\s+){0,8}deleted";`，如何使用 replaceAll 函数提取实例并删除？

我试过`str_in = str_in.replaceAll("(\\w+\\s+){0,8}", "");`了，但没有用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T18:25:25.697

如果您，正如您的问题所述，真的想使用`replaceAll()`而不是 (在我看来更合适) `replace()`，您可以使用`\Q`and`\E`标记从字面上匹配字符串：

```
String str_in = "instance (\\w+\\s+){0,8}deleted";
System.out.println(str_in.replaceAll("\\Q(\\w+\\s+){0,8}\\E", "")); 
```

印刷

```
instance deleted 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T18:20:46.630

您将需要转义单个字符，以使它们失去正则表达式的性质：

```
str_in.replaceAll("\\(\\\\w\\+\\\\s\\+\\)\\{0,8\\}", "") 
```

由于字符串文字，每个转义的反斜杠都需要自行转义。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-06T18:19:55.170

利用`str_in.replace("(\\w+\\s+){0,8}", "");`

[代替（）](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/String.html#replace%28char,%20char%29)

> 用指定的文字替换序列替换此字符串中与文字目标序列匹配的每个子字符串。替换从字符串的开头到结尾进行，例如，将字符串“aaa”中的“aa”替换为“b”将导致“ba”而不是“ab”

[全部替换（）](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/String.html#replaceAll%28java.lang.String,%20java.lang.String%29)

> 用给定的替换替换此字符串中与给定正则表达式匹配的每个子字符串

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-06T18:20:41.223

你的意思`(\\w+\\s+){0,8}`是字面上在字符串中，你想删除它吗？您将需要`\`在您的 replaceAll 中再次转义它们，以便按字面意思解释它们，而不是作为正则表达式的一部分，以及`(`and `{`。

# hadoop - 在 Hive 中获取 sysdate -1

> ID：11833701
> 
> 赞同：5
> 
> 时间：2012-08-06T18:18:12.033
> 
> 标签：hadoop, mapreduce, hive, hiveql

有什么方法可以始终获取`current date -1`in Hive 方法吗？`yesterdays date`并以这种格式`20120805`-？

我可以像这样运行我的查询来获取`yesterday's date`今天的数据`Aug 6th`-

```
select * from table1 where dt = '20120805'; 
```

但是，当我尝试以这种方式`date_sub function`获取昨天的日期时，因为下表在 date(dt) 列上进行了分区。

```
select * from table1 where dt = date_sub(TO_DATE(FROM_UNIXTIME(UNIX_TIMESTAMP(),
'yyyyMMdd')) , 1)     limit 10; 
```

它正在寻找所有分区中的数据？为什么？我在查询中做错了什么？

**如何在子查询中进行评估以避免扫描整个表？**

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-06T04:15:02.577

尝试类似：

```
select * from table1 
where dt >= from_unixtime(unix_timestamp()-1*60*60*24, 'yyyyMMdd'); 
```

如果您不介意 hive 扫描整个表，则此方法有效。`from_unixtime`不是确定性的，因此 Hive 中的查询计划程序不会为您优化。对于许多情况（例如日志文件），不指定确定性分区键可能会导致启动非常大的 hadoop 作业，因为它将扫描整个表，而不仅仅是具有给定分区键的行。

如果这对您很重要，您可以使用附加选项启动 hive

```
$ hive -hiveconf date_yesterday=20150331 
```

并在脚本或蜂巢终端使用

```
select * from table1
where dt >= ${hiveconf:date_yesterday}; 
```

变量的名称无关紧要，值也无关紧要，您可以在这种情况下设置它们以使用 unix 命令获取先前的日期。在 OP 的具体情况下

```
$ hive -hiveconf date_yesterday=$(date --date yesterday "+%Y%m%d") 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-07T01:38:00.857

在 mysql 中：

```
select DATE_FORMAT(curdate()-1,'%Y%m%d'); 
```

在 sqlserver 中：

```
SELECT convert(varchar,getDate()-1,112) 
```

使用此查询：

```
SELECT FROM_UNIXTIME(UNIX_TIMESTAMP()-1*24*60*60,'%Y%m%d'); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-01-22T00:01:20.330

它看起来像[`DATE_SUB`](https://cwiki.apache.org/confluence/display/Hive/LanguageManual+UDF#LanguageManualUDF-DateFunctions)假设 date 格式`yyyy-MM-dd`。因此，您可能需要进行更多格式操作才能获得您的格式。试试这个：

```
select * from table1 
where dt =  FROM_UNIXTIME(
                UNIX_TIMESTAMP(
                    DATE_SUB(
                        FROM_UNIXTIME(UNIX_TIMESTAMP(),'yyyy-MM-dd')
                    , 1)
                )
            , 'yyyyMMdd')     limit 10; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-01-04T08:33:20.147

用这个：

```
select * from table1 where dt = date_format(concat(year(date_sub(current_timestamp,1)),'-', month(date_sub(current_timestamp,1)), '-', day(date_sub(current_timestamp,1))), 'yyyyMMdd') limit 10; 
```

这将给出分区的确定性结果（字符串）。

我知道这非常冗长。

# vb.net - VB.net 时区问题

> ID：11833703
> 
> 赞同：1
> 
> 时间：2012-08-06T18:18:15.213
> 
> 标签：vb.net, timezone

我有一个遗留应用程序，它使用 Windows 时区信息来计算日期。例如，35 = 东海岸，20 = 中部，15 = 山区。这是当前的功能。它需要一个带有时区的日期并将其转换为传入的时区。这在 xp 上工作得很好，但它在 Windows 7 上崩溃。我猜它与它的 win32 部分有关，或者 Windows 7 处理时区的方式不同.

我不希望更改时区的格式，因为这可能会导致一些问题。代码是vb.net，我没有写。

```
Public Shared Function ConvertTime(ByVal time As Date, ByVal timeZone As Integer) As Date
        Dim UtcNow As Date = time.ToUniversalTime

        Dim selectedTimeZone As TimeZones.Win32.Win32TimeZone = TimeZones.Win32.TimeZones.GetTimeZone(timeZone)

        Return selectedTimeZone.ToLocalTime(UtcNow)
    End Function 
```

以前有人有这个问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T18:50:25.647

```
Dim selectedTimeZone As TimeZones.Win32.Win32TimeZone =
TimeZones.Win32.TimeZones.GetTimeZone(timeZone) 
```

在 VB.NET 中，您应该使用以下类来替换`Win32TimeZone`

[MSDN 时区类（系统）](http://msdn.microsoft.com/en-us/library/system.timezone.aspx#Y0)

请参阅我上面提供的链接以查看在 VB.NET 中使用 TimeZone 类的正确方法。

`TimZones.Win32.Win32TimeZone`由于不是.NET的有效类，它似乎不起作用

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T18:44:11.193

该时区库不在 .NET BCL 中。请联系您的时区库的作者寻求帮助。

# iphone - configureCall:atIndexPath:? 没有返回值

> ID：11833709
> 
> 赞同：0
> 
> 时间：2012-08-06T18:18:42.417
> 
> 标签：iphone, objective-c, cocoa-touch

我对传递给 configureCall:atIndexPath: 的单元格对象发生了什么感到有点困惑：我可以看到发生了什么，但奇怪的是 configureCall:atIndexPath: 没有返回 UITableViewCell 作为返回值。

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {
    static NSString *cellID = @"PLANETCELL_ID";
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:cellID];
    if(cell == nil) ...

    // POPULATE CELL NEW
    [self configureCell:cell atIndexPath:indexPath];
    return cell;
}

- (void)configureCell:(UITableViewCell *)cell atIndexPath:(NSIndexPath *)indexPath {
    Planet *managedPlanet = [[self fetchedResultsController] objectAtIndexPath:indexPath];
    [[cell textLabel] setText:[managedPlanet name]];
    [[cell detailTextLabel] setText:[managedPlanet type]];
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T18:23:41.600

它不需要返回对象，`cell`传入的对象正在原地修改。这样，该`configureCell`方法不需要以任何方式分配或管理对象，它只需要对调用者已经提供的传入单元做它需要做的事情

# .net - 在 2 个 com 对象之间切换的最佳 vb.net 设计模式

> ID：11833711
> 
> 赞同：1
> 
> 时间：2012-08-06T18:18:45.320
> 
> 标签：.net, vb.net, design-patterns

挑战在于提出最好的 vb.net 设计模式，该模式将允许在 2 个不同的大型机访问 com 对象之间进行切换。当然这一切都无需改变业务逻辑。

到目前为止，我想出的是一种工厂类型的方法（请参阅下面的精简伪代码）。我有 2 个基于枚举开关实例化的类，它们具有相同的方法和属性，但具有不同的底层对象特定方法。

我是在正确的轨道上还是应该采取另一种方法？谢谢你的帮助。

```
Public Class Form1
Private Sub Form1_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load
Private MFA as MFSession = New MFSession(Enums.mfaccesstype.type1)
Private Sub Form1_Load()
    MFA.GotoScreen("XYZ")
End Sub
End Class

Public Class MFSession
Private SystemAccess As Object
End Property
Sub New(ByVal AccessType As Enums.mfaccesstype)
    Select Case AccessType
        Case Enums.mfaccesstype.type1
            SystemAccess = New AccessType1()
        Case Enums.mfaccesstype.type2
            SystemAccess = New AccessType2()
    End Select
End Sub

Public Sub GotoScreen(ByVal ScreenName As String, Optional ByVal Window As String = "")
    SystemAccess.GoToScreen(ScreenName)
End Sub
End Class

Public Class AccessType1
Private Type1Object As Object = CreateObject("comobj.Type1Object")

Sub New()
    'new session housekeeping
End Sub

Public Sub GotoScreen(ByVal ScreenName As String)
    'specialize Type1 method for going to 'ScreenName' here
End Sub

End Class

Public Class AccessType2
Private Type2Object As Object = CreateObject("comobj.Type2Object")

Sub New()
    'new session housekeeping
End Sub

Public Sub GotoScreen(ByVal ScreenName As String)
    'specialized Type2 method for going to 'ScreenName' here
End Sub
End Class 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T02:41:09.263

你很亲密。

首先定义通用接口：

```
Public Interface ISession 'could be abstract class instead if there is common code you'd like to share between the subclasses

   Sub GotoScreen(ByVal ScreenName As String) 

End Interface 
```

其次，定义子类：

```
Public Class Type1Session Implements ISession

   Private innerComObj As SomeComObject

   Public Sub GotoScreen(ByVal ScreenName As String)
      'type1-specific code using innerComObj
   End Sub 

End Class

Public Class Type2Session Implements ISession

   Private anotherComObj As SomeOtherComObject

   Public Sub GotoScreen(ByVal ScreenName As String)
      'type2-specific code using anotherComObj
   End Sub 

End Class 
```

然后，您可以创建一个工厂，该工厂将采用枚举或其他参数并返回具体的 Type1Session 或 Type1Session。

这可以在专门的课程中完成：

```
Public Class SessionFactory

   Public CreateSession(criteria) As ISession 
      'select case against your enum or whatever to create and return the specific type
   End Sub

End Class 
```

如果您选择抽象（VB 中的 MustOverride）类而不是接口，则将工厂方法放在超类中也有先例。

最后，COM 是关于接口的，所以如果你控制了 COM 组件源，你可以让它们直接实现通用接口。

# c++ - MFC：PC上的字体太大，但笔记本电脑上还可以

> ID：11833712
> 
> 赞同：0
> 
> 时间：2012-08-06T18:18:49.953
> 
> 标签：c++, user-interface, mfc, fonts, scaling

我正在创建一个比平常更大的 CFont ：

```
font1.CreateFont(54, 0, 0, 0, FW_HEAVY, false, false, 0, ANSI_CHARSET, 
OUT_DEFAULT_PRECIS, CLIP_DEFAULT_PRECIS, DEFAULT_QUALITY, FIXED_PITCH|FF_MODERN,
_T("Courier New")); 
```

并设置一个 CEdit 控件来使用它：

```
m_cEditLimit.SetFont(&font1); 
```

当我编写应用程序时，这种字体在笔记本电脑上显示正常，但现在我在普通电脑上进行测试，它显示太大并且不适合：

![在此处输入图像描述](../Images/ed3816d3b80185dee8fc501399f0a652.png)

如何使字体在运行应用程序的每台电脑上看起来都不错？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-06T21:33:10.670

`54`尝试根据点计算大小，而不是使用硬编码的字体大小：

```
int points = 32;
pix = -MulDiv(points, GetDeviceCaps(hdc, LOGPIXELSY), 72); 
```

根据需要进行调整`points`，直到字体适合。现在它应该在系统之间保持一致。

# objective-c - NSNotificationCenter 没有发送通知

> ID：11833718
> 
> 赞同：1
> 
> 时间：2012-08-06T18:19:19.803
> 
> 标签：objective-c, ios, nsnotificationcenter

我正在开发一个系统来跟踪成就并为此使用`NSNotificationCenter`. 当应用程序中的对象解锁成就时，会发送通知`JMAchievementHandler`，将字符串设置为`YES`并将进度保存在`NSUserDefaults`. 我的问题是通知可能不起作用。这是我的代码`JMAchievementHandler`：

```
- (id)init {
    self = [super init];
    if (self) {

        //Set strings to NO
        achievementOne = @"NO";
        achievementTwo = @"NO";
        achievementThree = @"NO";
        achievementFour = @"NO";

        //Add observers
        [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(receiveNotificationWithName:) name:@"achievement1" object:nil];

        [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(receiveNotificationWithName) name:@"achievement2" object:nil];

        [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(receiveNotificationWithName) name:@"achievement3" object:nil];

        [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(receiveNotificationWithName) name:@"achievement4" object:nil];

        //Add observer to observe delegate methods
        [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(receiveNotificationFromDelegate:) name:@"notificationLaunch" object:nil];

        [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(receiveNotificationFromDelegate:) name:@"notificationEnterBackground" object:nil];

    }
    return self;
}

- (void)receiveNotificationWithName:(NSNotification *)notification {
    if ([[notification name] isEqualToString:@"achievement1"] || [achievementOne isEqualToString:@"NO"]) {

        //unlock achievement
        NSLog(@"%@ is unlocked", [notification name]);
        achievementOne = @"YES";
    }

    else if ([[notification name] isEqualToString:@"achievement2"] || [achievementTwo isEqualToString:@"NO"]) {

        //unlock achievement
        NSLog(@"%@ is unlocked", [notification name]);
        achievementTwo = @"YES";
    }

    else if ([[notification name] isEqualToString:@"achievement3"] || [achievementThree isEqualToString:@"NO"]) {

        //unlock achievement
        NSLog(@"%@ is unlocked", [notification name]);
        achievementThree = @"YES";
    }

    else if ([[notification name] isEqualToString:@"achievement4"] || [achievementFour isEqualToString:@"NO"]) {

        //unlock achievement
        NSLog(@"%@ is unlocked", [notification name]);
        achievementFour = @"YES";
    }
}

- (void)receiveNotificationFromDelegate:(NSNotification *)notificationDelegate
{
    if ([[notificationDelegate name] isEqualToString:@"notificationLaunch"]) {

        [self loadDataOnLaunch];
    }
    else if ([[notificationDelegate name] isEqualToString:@"notificationEnterBackground"]) {
        [self saveDataOnExit];
    }
}

- (void)loadDataOnLaunch
{
    NSLog(@"loadDataOnLaunch");
}

- (void)saveDataOnExit
{
    NSLog(@"saveDataOnExit");
} 
```

当我尝试发布通知时，不会调用 NSLog。我使用以下代码从我的`AppDelegate`和发送通知`ViewController`。

```
- (void)achievement1ButtonPressed:(id)sender {

    [[NSNotificationCenter defaultCenter] postNotificationName:@"achievement1" object:self userInfo:nil];
} 
```

我希望你们能帮助我。非常感谢

*   乔纳斯

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T19:13:18.580

你甚至有一个名为的方法`receiveNotificationWithName`吗？当您输入代码时，自动完成应该对此感到不满，`receiveNotificationWithName:`而是提供（除非您先编写它，没有`NSNotification*`，然后再添加它......

无论如何，两者之间有很大的不同。此外，您的处理程序有问题。您应该重新访问该代码。

有很多理由更喜欢块，这就是其中之一。您可以将您的代码正确地放入注册中，而不必担心提供错误的选择器。

```
[[NSNotificationCenter defaultCenter] addObserverForName:@"achievement1"
                                                  object:nil
                                                   queue:nil
                                              usingBlock:^{
    // Handle achievement1 right in this little block.
}]; 
```

这些看起来像一次性通知，因此如果您想在通知处理程序运行一次后取消注册，请执行此操作（注意`__block`）。

```
__block id achievement1 = [[NSNotificationCenter defaultCenter]
                              addObserverForName:@"achievement1 ":^{
                                          object:nil
                                           queue:nil
                                      usingBlock:^{
    // Handle achievement1 right in this little block.

    // Remove observer from notification center
    [[NSNotificationCenter defaultCenter] removeObserver:achievement1];
}]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T19:29:47.040

所有这些看起来都应该起作用（除了冒号，就像 Andrea 提到的那样）。是否有可能因为类似的原因没有调用您的按钮回调？我会`NSLog`在您的`achievement1ButtonPressed:`方法中添加一个以确保。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-06T18:38:34.927

我可以看到，您的`addObesrver`方法中只有一个使用“：”调用正确的选择器，因此是正确的方法签名。

# javascript - 调试 IFrame 内容

> ID：11833721
> 
> 赞同：0
> 
> 时间：2012-08-06T18:19:29.100
> 
> 标签：javascript, jquery, ajax, iframe, internet-explorer-9

我有一个页面本身可以正常工作的问题，但是当它嵌入到公司网页的 iFrame 中（我无法控制）时，它会在 IE9（但不是 IE8）中阻塞。

该页面使用 jQuery 进行 AJAX 调用，并使用 KnockoutJS 绑定内容以进行显示。该页面将 GET 请求中的参数传递给我的服务器，并使用 AJAX 进行响应，并且似乎在从服务器获取数据时阻塞。但是，当执行此代码时，数据正确且格式正确：

```
$.ajax({
    url: this.serviceURL + parameters,
    dataType: 'json',
    success: callback,
    timeout: 3000,
    error: function (jqXHR, status, errorThrown) {
        if (status == "timeout") {
            error("The connection to the server timed out.\nEither the server is down or the network is slow.\nPlease try again later.");
        }
        else {
            error("An error occurred while trying to communicate with the server.\n " + errorThrown);
        }
    }
}); 
```

在 IE9 中，我总是使用“SyntaxError: Invalid character”的 errorThrown 来点击“An error occurred...”分支，但它什么也没告诉我。

有人对如何调试此问题有任何建议吗？我使用 Fiddler 查看服务器发送和返回的内容，并且一切看起来都很好。

**更新**：在上面睡了一会儿之后，我今天开始焕然一新。我确定的是，由于某种原因，当我的页面是 iFramed 时，而不是获取 JSON 响应：

```
"{"Foo":true,"Bar":true}" 
```

我实际上得到（从强制错误处理程序中的错误，以便我可以检查 jqXHR.responseText 的状态）是：

```
" {"Foo":true,"Bar":true}" 
```

如果使用控制台尝试输入 JSON.parse，则会出现错误。所以问题是，这个领先的空间到底是从哪里来的？如果我在 Firefox 中运行它，我会看到来自服务器的正确响应（没有空格），如果我在 iFrame 之外运行它，我看不到前导空格。所以我*认为*它不会出现在服务器端。在父页面和我的页面上运行的 JS 混乱中的某个地方，它插入了一个前导空格。

**更新 2**：仔细检查发现 jqXHR.responseText.charCodeAt(0) 是 65279，所以它实际上不是一个空格（尽管它显示为一个）它是字节顺序标记。但是为什么它现在（而不是之前）在那里，为什么它会引起问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T20:28:49.923

我无法弄清楚这个问题的原因，所以我通过在我的 ajax 调用中添加一个自定义转换器来解决这个问题。所以我现在有这个：

```
 $.ajax({
            url: this.serviceURL + parameters,
            dataType: 'json',
            success: callback,
            timeout: 3000,
            converters: { "text json": HackyJSONConverter },
            error: function (jqXHR, status, errorThrown) {
                if (status == "timeout") {
                    //alert("Timed out");
                    error("The connection to the server timed out.\nEither the server is down or the network is slow.\nPlease try again later.");
                }
                else {
                    error("An error occurred while trying to communicate with the server.\n " + errorThrown);
                }
            }
        }); 
```

我的 hacky 转换器看起来像这样：

```
 function HackyJSONConverter(data) {
        if (data[0] = 65279) {
            // leading BOM - happens only with an iFrame in OT for some unknown reason
            data = data.substring(1);
        }
        return JSON.parse(data);
    } 
```

这非常愚蠢，如果有人有更好的方法，我会很高兴！

# ios - iOS Appirater 在启用调试而不是禁用时工作

> ID：11833724
> 
> 赞同：1
> 
> 时间：2012-08-06T18:19:49.923
> 
> 标签：ios, appirater

我设置

APPIRATER_DAYS_UNTIL_PROMPT 0
APPIRATER_USES_UNTIL_PROMPT 5

并有
[Appirater appLaunched:YES];
[Appirater appEnteredForeground:YES];

在我的代表课上。

但是，在开发设备上进行测试并重新打开应用程序 5 次后，我总是会收到对应用程序评分的提示。有人对我应该在哪里解决这个问题有任何指示吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T12:54:45.613

你能告诉我们你是如何在你的委托中设置 Appirater 脚本的吗？你的代码中还有这一行吗？

```
[Appirater setDebug:YES]; 
```

这会导致应用程序每次运行时都会打开评分，因此您可以检查它的外观。确保已删除该行。

# java-me - 如何识别 lwiit 表单屏幕中的列表项？

> ID：11833728
> 
> 赞同：2
> 
> 时间：2012-08-06T18:19:57.790
> 
> 标签：java-me, lwuit-form

我无法显示特定于在 form1 屏幕上单击的标题用户的详细表单信息，当我单击 form1 屏幕上的任何项目列表时，我只能显示第一项的详细信息（在我的代码中 int index=myNewsList. getSelectedIndex() 总是返回 0 作为值）

这是我的 Rss 应用程序的详细代码：

```
 //method called by the parsing thread
                      public void addNews(News newsItem) { 
                       newsVector.addElement(newsItem);//initialsed list with vector
                       myNewsList = new List(newsVector);                                    
                       myNewsList.setListCellRenderer(new NewsListCellRenderer());        
                       form1.addComponent(myNewsList);                  
                       form1.show();
                       myNewsList.addActionListener(new ActionListener() {
                         public void actionPerformed(ActionEvent ae) {
                        int selectedIndex = myNewsList.getSelectedIndex();
                        if(selectedIndex != -1){
                             newsItem1 = (News)news.elementAt(selectedIndex);
                             Label l=new Label();
                             l.setText(newsItem1.getPubDate());
                             Form detailedForm=new Form();
                             detailedForm.addCommand(m_backCommand);
                             detailedForm.addCommandListener(this);
                             detailedForm.addComponent(l);
                             detailedForm.show();                   
                       }                   

                       }
                    });                  
                    }

     Can you help? 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T05:55:22.263

将动作侦听器添加到列表中。仅当您单击列表中的任何项目时才会调用它。在该动作侦听器中，获取所选项目并将其转换为 News 类对象，因为您在列表中添加了 News 类对象。从该对象中，获取唯一属性，如新闻 id。将其传递到具有当前表单对象 (form1) 的另一个屏幕。

```
myNewsList = new List(news);
myNewsList.setListCellRenderer(new NewsListRenderer());

myNewsList.addActionListener(new ActionListener() {

     public void actionPerformed(ActionEvent ae) {
           News allNewsClassObjs = (News) myNewsList.getSelectedItem();
           int newsid = allNewsClassObjs.getNewsId(); 
           displayCompleteNewsScreen(form1,newsid);
     }
});
form1.addComponent(myNewsList); 
form1.addCommand(cmdDetails);
form1.setScrollable(true);
form1.setTransitionInAnimator(Transition3D.createRotation(250, true));
form1.show(); 
```

使用新闻 id，您可以在另一个屏幕上显示相关数据。向其添加返回命令。在后面的命令中，只显示 form1 对象。

```
public void displayCompleteNewsScreen(Form form1,int newsid){

// Get the related data and add it to another form object(form2).

form2.addCommand("Back");
form2.addCommandListener(new ActionListener() {

         public void actionPerformed(ActionEvent ae) {
               form1.show();
         }
    });
form2.show();
} 
```

而不是使用

```
int selectedIndex = myNewsList.getSelectedIndex();
if(selectedIndex != -1){
newsItem1 = (News)news.elementAt(selectedIndex);
} 
```

使用下面的代码

```
newsItem1 = (News)myNewsList.getSelectedItem(); 
```

# android - 更新 ImageResource 子项后无法捕获 ListView 项 MotionEvent 操作

> ID：11833730
> 
> 赞同：0
> 
> 时间：2012-08-06T18:20:17.113
> 
> 标签：android, android-layout, android-listview

我有一个自定义 ListView，我用 Adaptar 填充。在我的应用程序中，列表中的项目将根据它们的状态而变化，所以我正在更新我的 ImageViews，如下所示：

```
mStatusIcon = (ImageView) findViewById(R.id.imgStatusIcon);
mStatusIcon.setImageResource(R.drawable.icon_cancel); 
```

到目前为止，一切都很好。问题是我想要在我的布局的某个部分有某种焦点/悬停状态。`OnTouchListener()`我已经在`View mHitfield`我的布局 xml 中设置了一个。

我可以捕捉到所有相关的动作：`ACTION_MOVE`、`ACTION_DOWN`和。`ACTION_UP``ACTION_CANCEL`

问题是当我改变我`ImageView mStatusIcon`的下一个动作时，我捕捉到的总是`ACTION_CANCEL`.

```
View mHitfield = (View) findViewById(R.id.outerShape);

mHitfield.setOnTouchListener(new OnTouchListener() 
{

    @Override
    public boolean onTouch(View v, MotionEvent event) 
    {

        int currentAction = event.getAction();

        switch(currentAction)
        {
            case MotionEvent.ACTION_DOWN:   
            case MotionEvent.ACTION_MOVE:

                // if I comment out these lines I keep receiving all actions
                // if I don't, I only receive ACTION_DOWN followed by ACTION_CANCEL
                mStatusIcon.setImageResource(R.drawable.icon_download_normal);
                break;

            case MotionEvent.ACTION_UP:
            case MotionEvent.ACTION_CANCEL: 

                // if I comment out these lines I keep receiving all actions
                // if I don't, I only receive ACTION_DOWN followed by ACTION_CANCEL
                mStatusIcon.setImageResource(R.drawable.icon_download_hover);
                break;
        }

        return false;
    }
}); 
```

有人可以向我解释为什么会发生这种情况以及是否有办法解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T16:03:56.447

我仍然不确定它为什么会发生，但似乎 TouchEvent 被取消了，因为在创建的自定义视图中更新了布局。一旦我没有使用自定义视图而是创建了一个 XML 布局，问题就不复存在了。

# java - 如何禁用 JTree 上的默认键行为？

> ID：11833735
> 
> 赞同：1
> 
> 时间：2012-08-06T18:20:37.647
> 
> 标签：java, swing, jtree, look-and-feel, keylistener

我正在尝试制作一个在键入字母、数字、标点符号等字符时具有特定行为的 JTree，以应用过滤器、装饰器等。

一切似乎都运行良好，但是当我输入字母时，选择似乎会自动改变，并且与我的过滤器的行为方式不同。看起来这种行为是在中定义的`BasicTreeUI.Handler.keyTyped(KeyEvent e)`，我不知道如何以一种与外观无关的方式轻松地避免或覆盖这种行为。

有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T05:48:37.907

存在对这些按键做出反应的键绑定[。](http://docs.oracle.com/javase/tutorial/uiswing/misc/keybinding.html)`JTree`以下代码片段打印出其中一个输入映射中的可用绑定

```
import javax.swing.InputMap;
import javax.swing.JComponent;
import javax.swing.JTree;
import javax.swing.KeyStroke;
import java.awt.EventQueue;

public class TreeActionMap {
  public static void main( String[] args ) {
    EventQueue.invokeLater( new Runnable() {
      @Override
      public void run() {
        JTree tree = new JTree(  );
        InputMap inputMap = tree.getInputMap( JComponent.WHEN_ANCESTOR_OF_FOCUSED_COMPONENT );
        KeyStroke[] keyStrokes = inputMap.allKeys();
        for ( KeyStroke keyStroke : keyStrokes ) {
          Object actionCommand = inputMap.get( keyStroke );
          System.out.println( "keyStroke = " + keyStroke );
          System.out.println( "actionCommand = " + actionCommand );
        }
      }
    } );

  }
} 
```

因此，如果您遍历所有`InputMap`实例并调用所有实例`clear`，则`JTree`不应再对这些按键做出反应

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-01-16T21:10:50.850

这对我有用：

```
public class MyJTree extends JTree {

    public class MyBasicTreeUi extends BasicTreeUI{
        @Override
        protected KeyListener createKeyListener() {

        return null;
    }
...
    public MyJTree (){
    ...
    setUI(new MyBasicTreeUi());
    ...
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-08-27T16:21:15.580

为了以独立于外观的方式覆盖 的`BasicTreeUI.Handler.keyTyped(KeyEvent e)`行为，请尝试以下代码。`JTree`

```
JTree tree = new JTree();
for(KeyListener kl: tree.getListeners(KeyListener.class)) {
    tree.removeKeyListener(kl);
} 
```

显然，UI 是通过在构建过程中将 KeyListeners 安装到 JTree 中来完成它们的工作的，因此在构建 JTree 之后并在添加您自己的特定行为之前，只需删除已经安装的 KeyListeners。

# asp.net - 我们可以将会话名称作为查询字符串来存储会话吗？

> ID：11833744
> 
> 赞同：0
> 
> 时间：2012-08-06T18:20:57.293
> 
> 标签：asp.net, session

我正在尝试实现这样的目标：

```
DataTable dt=new DataTable();
if (Session[Request.QueryString["Id"].ToString()] == null)
{
    Session[Request.QueryString["Id"].ToString()] = adRepo.GetPostById(Convert.ToInt32(Request.QueryString["Id"]));
}
dt = (DataTable)Session[Request.QueryString["Id"].ToString()]; 
```

这是建议做的事情吗？我知道会话数会大大增加。但是有没有其他选择呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T18:23:48.550

您尝试缓存的对象仅对访问者可用。如果另一个访问者请求相同的对象怎么办？您将缓存 2 次。

最好使用内置的缓存功能，您可以使用缓存体验时间和时间滑动等功能。或者只是将其保存在 HttpApplication 中，这样该对象将是全局的。

但我会推荐缓存看：

[http://msdn.microsoft.com/en-us/library/system.web.caching.cache.aspx](http://msdn.microsoft.com/en-us/library/system.web.caching.cache.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T18:36:39.807

没有理由不能将查询字符串变量用作会话密钥，但正如 Simon 指出的那样，这可能是缓存的候选者。

你想用这个来完成什么？从您的示例看来，您正在传递某种帖子的 ID，然后通过帖子 ID 在会话中存储表示该帖子的数据表。你要清除会话变量吗？数据表中有多少数据？这是其他用户可能想要/需要访问的东西吗？用户将如何处理数据表中的信息？即使它不是缓存的候选者，如果用户正在访问多个帖子，如果你不小心的话，你很快就会有很多垃圾堵塞你的会话。查询量有多大？SQL 服务器缓存在这里是一个选项吗？

更多信息将大大有助于找到一个好的解决方案。

# jquery - jQuerys keyup + counter 的问题

> ID：11833746
> 
> 赞同：0
> 
> 时间：2012-08-06T18:21:06.217
> 
> 标签：jquery, keyup

我有一个 - 关于我的意见 - 非常疯狂的问题。逻辑似乎很简单：但它不起作用:)

我已经升级了脚本的一小部分：

[jquery onkeyup 事件](http://photographic-eye.de/html.html)

该片段用于即时搜索建议。

请模糊输入字段，打开控制台（萤火虫）并按箭头向上和向下箭头。

您将在控制台上看到一个变量，每次按向上/向下箭头键 1 点时都应添加或删除该变量。

但是，如果您“反转”方向（例如 arrowDown -arrowDown -arrowDown -arrowUp），计数器似乎无法正常工作。

```
var c = 0;
$('#h7_3').keypress(function(e) {

    console.log('--------');
    console.log('c = ' + c);
    console.log('Key: = ' + e.keyCode);
    console.log('--------');

    if(e.keyCode == 38 || e.which == 38){ //38 = arrowUp
        e.preventDefault();
    }
    if(e.keyCode == 40 || e.which == 40) { //40 = arrowDown
        e.preventDefault();
    }
});

$('#h7_3').keyup(function(e) {
    if(e.keyCode == 38 || e.which == 38){ //38 = arrowUp
        c--;
    } else if(e.keyCode == 40 || e.which == 40) { //40 = arrowDown
        c++;
    }
}); 
```

我真的很高兴一些提示:-)

问候，克里斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T18:32:34.880

您需要将您的代码包装在一个 ready() 函数中，并且由于您阻止默认，后一个函数不会被触发。此外，jQuery 规范化 e.which ：

```
$(function() {
    var c = 0;
    $('#h7_3').on('keyup', function(e) {
        if (e.which == 38 || e.which == 40) {
            c = e.which == 38 ? c-1 : c+1;
            console.log('--------');
            console.log('c = ' + c);
            console.log('Key: = ' + e.which);
            console.log('--------');
            e.preventDefault();
        }
    });
}); 
```

[**小提琴**](http://jsfiddle.net/vSRY2/1/)

# linux-kernel - native_apic_mem_write 和 native_apic_msr_write 之间的区别？

> ID：11833750
> 
> 赞同：0
> 
> 时间：2012-08-06T18:21:13.633
> 
> 标签：linux-kernel, kvm

我是linux内核的新手，对它了解不多。出于某种原因，我还必须跟踪 linux 主机内核和 kvm 来宾内核上的延迟问题。现在我只需要将**native_apic_msr_write**（用于**linux 主机内核**）与**naitve_apic_mem_write**（用于**kvm guset 内核**）进行比较。

基于我有限的知识，我尝试阅读这两个函数调用的源代码，并且我相信 native_apic_msr_write 用于将值写入 msr 寄存器（希望这是正确的）。我的问题是我不明白 native_apic_mem_write 做了什么，因为它调用了一些称为 ALTERNATIVE 的内联程序集，我也不熟悉。

我附上了下面的代码。有人可以解释里面发生了什么吗？它不必非常详细。任何信息都会有所帮助，谢谢。

```
#define ALTERNATIVE(oldinstr, newinstr, feature)                        \
80                                                                         \
81       "661:\n\t" oldinstr "\n662:\n"                                    \
82       ".section .altinstructions,\"a\"\n"                               \
83       "  .long 661b - .\n"                      /* label           */   \
84       "  .long 663f - .\n"                      /* new instruction */   \
85       "  .word " __stringify(feature) "\n"      /* feature bit     */   \
86       "  .byte 662b-661b\n"                     /* sourcelen       */   \
87       "  .byte 664f-663f\n"                     /* replacementlen  */   \
88       ".previous\n"                                                     \
89       ".section .discard,\"aw\",@progbits\n"                            \
90       "  .byte 0xff + (664f-663f) - (662b-661b)\n" /* rlen <= slen */   \
91       ".previous\n"                                                     \
92       ".section .altinstr_replacement, \"ax\"\n"                        \
93       "663:\n\t" newinstr "\n664:\n"            /* replacement     */   \
94       ".previous" 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T18:33:17.343

我相信这些是[SMP 替代方案](http://lwn.net/Articles/164121/)- 相同二进制内核在 SMP 和 UP 系统上运行不同指令的一种方式。

# perl - 为什么在取消引用左侧的 arrayref 时 smartmatch 不起作用？

> ID：11833756
> 
> 赞同：2
> 
> 时间：2012-08-06T18:21:24.123
> 
> 标签：perl, reference, smartmatch

我目前正在阅读O'Reilly 的[*Intermediate Perl*](http://oreilly.com/catalog/0636920012689)并尝试做其中的一个练习。我对 Perl 中的引用不熟悉，所以我希望我不会误解某些东西并错误地编写此练习。

但是，我尝试调试此代码，但无法得出智能匹配行每次都失败的结论。据我了解`@array ~~ $scalar`，如果在`@array`.

下面是我的代码：

```
#!/usr/bin/perl -w
use 5.010;

my @rick  = qw(shirt shotgun knife crossbow water);
my @shane = qw(ball jumprope thumbtacks crossbow water);
my @dale  = qw(notebook shotgun pistol pocketprotector);
my %all   = (
    Rick  => \@rick,
    Shane => \@shane,
    Dale  => \@dale,
);

check_items_for_all(\%all);

sub check_items_for_all {
    my $all = shift;
    foreach $person (keys %$all) {
        #print("$person\n");
        $items = $all->{$person};
        #print("@$items");
        check_required_items($person, $items);
    }
}

sub check_required_items {
    my $who      = shift;                #persons name
    my $items    = shift;                #reference to items array
    my @required = qw(water crossbow);
    print(
        "Analyzing $who who has the following items: @$items. Item being compared is $item \n"
    );
    foreach $item (@required) {
        unless (@$items ~~ $item) {
            print "Item $item not found on $who!\n";
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-06T18:32:35.970

如果您反转匹配，它将起作用：

```
$item ~~ @$items 
```

或者

```
$item ~~ $items  # Smart-matching works with references too. 
```

PS：习惯于添加`use strict;`到程序的开头。它会指出你的代码中的一些错误:)

# javascript - 在正文中使用 javascript 将样式表添加到 Head

> ID：11833759
> 
> 赞同：29
> 
> 时间：2012-08-06T18:21:48.897
> 
> 标签：javascript, css

我正在使用阻止我们编辑头部部分的 CMS。我需要在标签之后将 css 样式表添加到站点。有没有办法用 JS 来做到这一点，我可以在页面底部添加一个脚本（我可以在标签之前添加脚本），然后将样式表注入到 head 部分？

* * *

## 回答 #1

> 赞同：107
> 
> 时间：2012-08-06T18:23:35.757

**更新**：根据[规范](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/link)，`link`正文中不允许使用该元素。但是，大多数浏览器仍然会很好地呈现它。因此，要回答评论中的问题 - 确实必须添加`link`到`head`页面而不是`body`.

```
function addCss(fileName) {

  var head = document.head;
  var link = document.createElement("link");

  link.type = "text/css";
  link.rel = "stylesheet";
  link.href = fileName;

  head.appendChild(link);
}

addCss('{my-url}'); 
```

或者使用 jquery 更容易一些

```
function addCss(fileName) {
   var link = $("<link />",{
     rel: "stylesheet",
     type: "text/css",
     href: fileName
   })
   $('head').append(link);
}

addCss("{my-url}"); 
```

* * *

*原始答案*：

您不必将其添加到头部，只需将其添加到正文标记的末尾即可。

```
$('body').append('<link rel="stylesheet" type="text/css" href="{url}">') 
```

正如胡安门德斯所说，您可以将样式表插入头部

```
$('head').append('<link rel="stylesheet" type="text/css" href="{url}">') 
```

没有 jQuery 也一样（见上面的代码）

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2016-01-07T22:40:45.647

这将以一种智能的方式做你想做的事。也使用纯JS。

```
function loadStyle(href, callback){
    // avoid duplicates
    for(var i = 0; i < document.styleSheets.length; i++){
        if(document.styleSheets[i].href == href){
            return;
        }
    }
    var head  = document.getElementsByTagName('head')[0];
    var link  = document.createElement('link');
    link.rel  = 'stylesheet';
    link.type = 'text/css';
    link.href = href;
    if (callback) { link.onload = function() { callback() } }
    head.appendChild(link);
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2016-03-08T12:48:01.927

我修改了 Eddie 的函数来**移除**或打开或**关闭**样式表。它还将返回样式表的当前状态。这很有用，例如，如果您想在网站上为视力受损的用户设置一个切换按钮，并且需要将他们的偏好保存在 cookie 中。

```
function toggleStylesheet( href, onoff ){
    var existingNode=0 //get existing stylesheet node if it already exists:
    for(var i = 0; i < document.styleSheets.length; i++){
        if( document.styleSheets[i].href && document.styleSheets[i].href.indexOf(href)>-1 ) existingNode = document.styleSheets[i].ownerNode
    }
    if(onoff == undefined) onoff = !existingNode //toggle on or off if undefined
    if(onoff){ //TURN ON:
        if(existingNode) return onoff //already exists so cancel now
        var link  = document.createElement('link');
        link.rel  = 'stylesheet';
        link.type = 'text/css';
        link.href = href;
        document.getElementsByTagName('head')[0].appendChild(link);
    }else{ //TURN OFF:
        if(existingNode) existingNode.parentNode.removeChild(existingNode)
    }
    return onoff
} 
```

**示例用法：**

```
toggleStylesheet('myStyle.css') //toggle myStyle.css on or off

toggleStylesheet('myStyle.css',1) //add myStyle.css

toggleStylesheet('myStyle.css',0) //remove myStyle.css 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-07-02T08:20:48.070

您可以在现代浏览器中使用纯 javascript 并且仍然优雅。

```
const range = document.createRange()
const frag = range.createContextualFragment(`THE CONTENT IS THE SAME AS THE HTML.`)
document.querySelector("YOUR-NODE").append(frag) 
```

添加任何 HTML 代码非常容易。

## 文档

*   [创建范围](https://developer.mozilla.org/en-US/docs/Web/API/Document/createRange)
*   [创建上下文片段](https://developer.mozilla.org/en-US/docs/Web/API/Range/createContextualFragment)

### 示例 1

通过javascript在头部添加样式。

```
<head></head><body><button class="hover-danger">Hello World</button></body>
<script>
  const range = document.createRange()
  const frag = range.createContextualFragment(`
<style>
  .hover-danger:hover{
    background-color: red;
    font-weight: 900
  }
</style>
`
)
  document.querySelector("head").append(frag)  
</script>
```

### 示例 2

导入 CSS、JS，修改现有样式表。

```
<head></head>
<body><button class="btn btn-primary hover-danger">Hello world</button></body>

<script>
  const range = document.createRange()
  const frag = range.createContextualFragment(`
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"/>
`)
  document.querySelector("head").append(frag)

  window.onload = () => {
    //  If you don't want to import the new source, you can consider adding the data to exists source.
    const nodeLink = document.querySelector(`link[href^="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"]`) // ^: match begin with my input
    if (nodeLink)  { // !== null
      const stylesheet = nodeLink.sheet
      const myCSS = `
background-color:red;
font-weight: 900;
`
      stylesheet.insertRule(`.hover-danger:hover{ ${myCSS} }`, stylesheet.cssRules.length)
    }
  }
</script>
```

> 您必须有权直接修改 CSS
> 
> 如果您收到错误消息：
> 
> > 无法从“CSSStyleSheet”读取“cssRules”属性：无法访问规则，
> 
> 那么你可以参考：[https ://stackoverflow.com/a/49994161/9935654](https://stackoverflow.com/a/49994161/9935654)

# vba - 在 Excel VBA 中绕过 Microsoft Office 协议发现

> ID：11833760
> 
> 赞同：1
> 
> 时间：2012-08-06T18:21:51.577
> 
> 标签：vba, cookies, excel, hyperlink

我面临的问题是我有一个电子表格，它从 Intranet 站点提取数据，该站点将凭据存储在浏览器上的 cookie 中。我的宏确实通过 Internet Explorer 验证到该站点，但我添加到返回该站点的数据的超链接将在用户的默认浏览器中打开。有没有办法更改 Hyperlinks 方法将打开哪个浏览器，或者有没有办法将请求直接转发到用户的默认浏览器而不通过 Microsoft Office 协议发现？Outlook中的超链接直接打开到默认浏览器，excel没有原因吗？或者有没有办法以某种方式获取该 cookie 并将其与请求一起发送？任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T18:34:44.940

如果将链接更改为指向包含它们的单元格，则可以捕获 FollowHyperlink 事件（在工作表或工作簿级别）并使用它在 IE 中打开链接。假设您可以将完整链接作为“要显示的文本”。

```
Private Sub Worksheet_FollowHyperlink(ByVal Target As Hyperlink)
    Dim url As String
    url = Target.TextToDisplay
    'automate IE to open the link...
End Sub 
```

# java - 如何存储数组列表？

> ID：11833761
> 
> 赞同：1
> 
> 时间：2012-08-06T18:21:58.687
> 
> 标签：java, mysql, xml, arraylist

我正在尝试`ArrayList`在运行时之间存储我的。因此，当我将项目输入`ArrayList`然后关闭程序然后重新打开它并尝试搜索我放入的项目时，它仍然会在那里。

我已经尝试过 MySQL 和 XML，但我无法弄清楚。如果可以的话，请指导我寻找一种简单的存储方式，`ArrayList`那将是惊人的。

编辑：

我正在尝试序列化`ArrayList`：

```
static ArrayList<Product> Chart=new ArrayList<Product>(); 
```

使用这些对象：

```
double Total;
String name;
double quantity;
String unit;
double ProductPrice; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-06T18:23:01.007

查看对象序列化，听起来正是您想要的

[什么是对象序列化？](https://stackoverflow.com/questions/447898/what-is-object-serialization)

这允许您将 Java 对象写入文件并稍后将其读回。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T18:33:08.170

这是一个例子。它还会压缩文件，尽管您不必这样做。您还可以使用流写入 MYSQL blob 而不是文件。

```
public static <T> void writeToGZIP(String filename, T obj) {
    ObjectOutputStream os = null;

    try {
        os = new ObjectOutputStream(new GZIPOutputStream(new FileOutputStream(filename)));
        os.writeObject(obj);                    
        System.out.println("Object written to " + filename);
    } catch (Exception e) {         
        e.printStackTrace();            
    } finally {
        try {
            if (os != null) { os.flush(); os.close(); }
        } catch (IOException e) {           
            e.printStackTrace();
        }
    }       
}

@SuppressWarnings("unchecked")
public static <T> T readFromGZIP(String filename, T obj) {      
    ObjectInputStream ois = null;       

    try {
        ois = new ObjectInputStream(new GZIPInputStream(new FileInputStream(filename)));            
        obj = (T) ois.readObject();         
    } catch (Exception e) {         
        e.printStackTrace();            
    } finally { 
        try {
            if( ois != null ) ois.close();
        } catch (IOException e) {
            e.printStackTrace();
        }
    }

    return obj;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-06T18:23:48.213

对象输出流和对象输入流

# amazon-swf - 在 Amazon SWF 中使用不同的参数计划相同的活动

> ID：11833764
> 
> 赞同：0
> 
> 时间：2012-08-06T18:22:20.420
> 
> 标签：amazon-swf

我正在尝试在 Amazon SWF 中安排活动。最初，我曾经遍历一个列表并为列表的每个值安排活动。但这会并行调用我不想要的活动。所以，我修改了我的代码来做这样的事情：

```
Promise<Void> promiseArg = null;
for(Integer i : IntegerList){
   Promise<Void> nextArg = activityClient.activity1(i);
   promiseArg = nextArg;
} 
```

虽然代码正在运行，但我不确定这是否是正确的方法。任何评论都会有所帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T21:08:33.663

`promiseArg`如果不使用，使用有什么意义？

如果您希望它们依赖于 prev 方法调用，请创建一个`Asynchronous method`并使用`promise variable`.

```
//Main method of decider.
Promise<Integer> promiseArg = null;
Promise<Integer> nextArg = activityClient.activity1(i, 1);
for(Integer i : IntegerList){
    Promise<Integer> nextArg = fun(nextArg, Promise.asPromise(i));
}

@Asynchronous
public Promise<Integer> fun(Promise<int> nextArg, int i) {
    System.out.println("Testing with current value: " + Integer.toString(nextArg.get()));
    return activityClient.activity1(i, nextArg.get());
} 
```

我没有测试过它，但它应该可以工作。

除此之外，您还可以尝试在活动声明中将prev 传递`Promise variable`给活动本身。`@Wait annotation`

像这样的东西，

```
prevArgs = activityClient.activity1(i, prevArg)); 
```

像活动一样，

```
XYZ activity1(int i,@Wait Promise<int> prevArgs){
   //Please check if int should be used instead of Promise<int>
} 
```

# php - RecursiveIteratorIterator 中 next() 和 nextElement() 的区别

> ID：11833769
> 
> 赞同：4
> 
> 时间：2012-08-06T18:23:06.787
> 
> 标签：php, iterator, spl

`RecursiveIteratorIterator::next()`和 和有什么不一样`RecursiveIteratorIterator::nextElement()`？

该文档的帮助不大：

*   ### [RecursiveIteratorIterator::next()](http://php.net/recursiveiteratoriterator.next)：

    > RecursiveIteratorIterator::next — 前进到下一个元素

*   ### [RecursiveIteratorIterator::nextElement()](http://php.net/recursiveiteratoriterator.nextelement)：

    > RecursiveIteratorIterator::nextElement — 下一个元素
    > 
    > ...
    > 
    > 当下一个元素可用时调用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T18:36:33.677

从查看 PHP 源代码来看，它似乎`nextElement`是一个回调函数，可以在“下一个元素可用时”调用。

```
288  if (object->nextElement && (object->mode == RIT_SELF_FIRST || object->mode == RIT_CHILD_FIRST)) {
289      zend_call_method_with_0_params(&zthis, object->ce, &object->nextElement, "nextelement", NULL);
290  } 
```

[来源](http://lxr.php.net/xref/PHP_5_4/ext/spl/spl_iterators.c#288)。

[从查看spl_iterators.c:801](http://lxr.php.net/xref/PHP_5_4/ext/spl/spl_iterators.c#801)来看，迭代器类中的默认`nextElement`函数目前似乎没有做任何事情。

~~现在它看起来像一个空操作，因为没有办法为该函数注册你自己的回调，并且在 PHP 源代码中，它目前什么都不做。~~通过查看代码，如果已注册，则在迭代器向前移动到下一个元素时调用回调，然后再对项目进行操作（例如，foreach 循环中的用户空间代码）。

有关如何使用它的说明，请参阅@RamboCoder 的答案。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-15T00:27:01.940

*模板方法*设计模式出现在一些 spl 类中，这是一种情况。您应该扩展 RecursiveIteratorIterator 以提供可选挂钩的实现，然后超类 (RecursiveIteratorIterator) 将在适当的时间调用它们。

```
class A extends RecursiveIteratorIterator {
    function nextElement() {
        echo 'hi';
    }

}

$r = new A(new RecursiveArrayIterator([1,2]));
iterator_to_array($r);//hihi 
```

You could think of nextElement() as an event handler, except you need to extend the class to provide an implementation of a handler.

Some of the other methods you can hook into are beginChildren() beginIteration() callHasChildren() etc...

# javascript - 如何制作可以在 android、iphone、ipad 上运行的移动版网站？

> ID：11833770
> 
> 赞同：0
> 
> 时间：2012-08-06T18:23:12.303
> 
> 标签：javascript, html, css, mobile

我想为它的移动版本复制一个站点。该网站有滑块，简单的页眉、页脚和下拉菜单。

我们是否能够为移动设备制作精确的东西（在我的情况下，我说的是用 jQuery 制作的滑块和下拉菜单）。

我想要的是在移动设备上产生与普通网站相同的感觉。就像我在视频示例中看到的那样，人们为 ipad、iphone 显示（演示）点击菜单和页面向右滑动，并显示为新页面。我不想要这个。

我想在移动版中选择现有的主题和配色方案。

我怎么能做到。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-06T18:26:27.580

为此，我们有一种叫做响应式网页设计的东西：）

你可以看看这里：

[http://www.netmagazine.com/tutorials/build-responsive-site-week-designing-responsively-part-1](http://www.netmagazine.com/tutorials/build-responsive-site-week-designing-responsively-part-1)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-06T18:34:11.597

另一个开始的好地方：http: [//html5boilerplate.com/](http://html5boilerplate.com/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-06T18:35:52.913

这个主题比简单地添加几行代码要复杂得多，但这是我可以提供的：

如果您想要单独的移动设备和台式机（我建议不要这样做），您将不得不进行一些设备嗅探。最简单的方法可能是检查屏幕尺寸并重定向是否低于 320 像素或您决定的任何尺寸。

这将使您的页面加载速度稍慢，因为您将不得不等待页面解析屏幕尺寸检测脚本，检查它们的屏幕是否太小，然后重定向。这将在移动设备上花费很长时间，并且由于加载时间缓慢，您不会吸引任何粉丝。

响应式设计是最好的解决方案。我认为您应该退后一步，考虑一下为什么您希望您的站点分成两个不同的站点，以及您是否有能力不断维护这两个站点。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-06T18:32:27.597

您需要使用媒体查询[http://www.w3.org/TR/css3-mediaqueries/](http://www.w3.org/TR/css3-mediaqueries/)

通过媒体查询，您可以为其他设备设置样式并保存相互 html...

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-06T19:17:55.707

您可以使用 DDR 为特定的移动设备定制内容，而不是响应式设计： [http ://wurfl.sourceforge.net](http://wurfl.sourceforge.net)

# c# - 根据另一个集合过滤一个集合

> ID：11833774
> 
> 赞同：1
> 
> 时间：2012-08-06T18:23:28.383
> 
> 标签：c#, asp.net, algorithm

我有一个`List<businessobject>`对象集合和一个`List<string>`对象集合。我想过滤我的`List<businessobject>`，以便如果业务对象中的某个属性等于任何东西，`List<string>`它将被过滤掉。我可以考虑以这种方式编写代码，但有没有更快或更好的方法？

```
List<businessobject> bo = loadBusinessObjectList();
List<string> stringList = loadStringList();
foreach(businessobject busobj in bo){
   if(stringList.contains(busobj.myProperty))
      bo.remove(busobj)
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-06T18:27:09.133

您的原始代码实际上不起作用，因为您修改了您正在枚举的 List。

您可以执行以下操作：

```
List<businessobject> bo = loadBusinessObjectList();
List<string> stringList = loadStringList();

var matches = (from b in bo where stringList.Contains(b.SomeProperty) select b);
var bo = bo.Intersect(matches); 
```

如果你修改

```
List<string> stringList 
```

成为

```
HashSet<string> stringList 
```

性能会得到改善，特别是如果字符串的数量很大，因为测试列表成员资格是 O(n)，而测试哈希集成员资格接近 O(1)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-06T18:26:41.213

Linq 是你的朋友！

```
List<businessobject> boList = loadBusinessObjectList();
List<string> stringList = loadStringList();

var badObjects = from bo in boList
             where stringList.Contains(bo.myProperty)
             select bo;

boList.RemoveRange(badObjects); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-06T19:17:07.793

比迄今为止发布的其余代码要简单得多......

```
bo.Where(o => !stringList.Contains(o.MyProperty)); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-06T18:34:19.553

```
List<businessobject> bo = loadBusinessObjectList();
List<string> stringList = loadStringList();
List<businesssobject> bo2 = bo.FindAll(obj => !(stringList.contains(obj.myProperty))); 
```

不确定这是否更快。这不是删除对象，而是创建一个仅包含匹配对象的新对象。

# c# - LINQ to SQL - 调用内置聚合函数（即 STDEV）

> ID：11833781
> 
> 赞同：2
> 
> 时间：2012-08-06T18:23:45.287
> 
> 标签：c#, sql, linq, aggregate-functions, standard-deviation

有没有办法让 LINQ 将查询直接转换为 SQL 之类的函数`STDEV`？例如，LINQ

```
from t in table
group t by t.something into g
select new {
    avg = g.Average(o => o.number)
    stdev = g.?????
} 
```

变成了 SQL `AVG`。但是，LINQ 中不支持标准偏差。

这里建议了一种方法： [LINQ 中的标准偏差](https://stackoverflow.com/questions/2253874/linq-equivalent-for-standard-deviation)

但是，这很笨拙，并且还需要一些额外的工作来处理可能的空值，sql`STDEV`函数会自动为您忽略这些值。此外，它可以减少通过线路发送的数据，并且计算速度更快。

有什么办法可以做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T19:47:14.127

不，没有办法直接通过 LINQ 来完成。

您可以创建一个[CLR 聚合](http://msdn.microsoft.com/en-us/library/ms131057.aspx)，它实际上只是将[`STDEV`聚合](http://msdn.microsoft.com/en-us/library/ms190474.aspx)包装在 SQL Server 中，但这将是大量的过度工作（尽管这*是*可能的）。

但是，阻力最小的选项将是对于您想要标准偏差的每个查询，您将创建一个执行操作的存储过程，然后使用 LINQ-to-SQL 调用它。

或者，如果您想在 LINQ-to-SQL 中使用组合，您可以[在 SQL Server 中创建一个用户定义的表函数，然后在 LINQ-to-SQL 中访问它](http://msdn.microsoft.com/en-us/library/bb386954.aspx)并使用它来组合您的查询。

# graphviz - 如何在点语言中删除文本（graphviz）

> ID：11833786
> 
> 赞同：15
> 
> 时间：2012-08-06T18:24:01.933
> 
> 标签：graphviz, dot

我正在尝试找出如何在基于点的[graphviz图中](http://www.graphviz.org/)[删除](http://en.wikipedia.org/wiki/Strikethrough)节点中的某些文本？

我在此页面上查看，但无法弄清楚： [http ://www.graphviz.org/doc/info/attrs.html](http://www.graphviz.org/doc/info/attrs.html)

谷歌搜索也没有帮助。

考虑这个图表，这些基本上是来自 bugzilla 的错误编号。红色节点代表已关闭的错误，但我不想像这样对它们进行颜色编码。显然，带删除线的~~511272~~比红色节点 511272 更直观。

![在此处输入图像描述](../Images/8fb11cd26be682dcc32ef71827e24f9e.png)

如果有人知道如何在节点内删除文本，请分享。谢谢，

肖比特

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-08-19T18:44:29.323

Graphviz 没有自己的样式来执行此操作，但由于它是 Unicode，您可以使用该技术与[组合字符](http://en.wikipedia.org/wiki/Combining_character#Unicode_ranges)和[“组合长笔划覆盖”（U + 0336）](http://www.fileformat.info/info/unicode/char/336/index.htm)，维基百科关于[删除线](http://en.wikipedia.org/wiki/Strikethrough)的文章建议：

> 在无法使用标记的纯文本场景中，Unicode 提供了许多组合字符来实现类似的效果。“长笔划覆盖”（U+0336）导致整个文本的笔划不间断，
> 
> *   分离：`A̶B̶C̶D̶E̶F̶G̶H̶I̶`
> *   组合：A̶B̶C̶D̶E̶F̶G̶H̶I̶

这张图：

```
digraph G {
    a [label="1̶2̶3̶4̶5̶"]
    b [label="54321"]
    a->b
} 
```

使用 graphviz 2.23.6 渲染此 png 输出：

![带有 unicode 删除线的 graphviz 示例](../Images/18e6f4805d9d9fdaf64504742f22b843.png)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2020-06-19T10:40:23.520

另一种选择是使用[类似 HTML 的标签](https://www.graphviz.org/doc/info/shapes.html#html)：

```
digraph G {
    a [label=<<s>12345</s>>]
    b [label="54321"]
    a->b
} 
```

[![在此处输入图像描述](../Images/caf0a6372ca239d7fdedaa0847765b4b.png)](https://i.stack.imgur.com/aAqJq.png)

# c# - 有没有办法使用 LINQ 更改单选按钮列表中的“选中”单选按钮？

> ID：11833789
> 
> 赞同：0
> 
> 时间：2012-08-06T18:24:22.333
> 
> 标签：c#, asp.net

我有一个中继器控件，其中包含多个 RadioButtonLists，每个列表中都有各种 RadioButtons。当我的页面加载时，我有几个不同的值。为了清楚起见，假设我有值“1”、“2”和“3”。我希望在所有包含该值的单选按钮列表中预先选择任何单选按钮。我已经有了我想要的 RadioButtonLists，只是不知道如何进一步访问它。

有没有办法在 LINQ 中做到这一点？类似于在单选按钮列表中找到第一个或默认单选按钮并选中 = true？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T18:39:31.307

我实际上把它复杂化了。您需要做的就是将 list.SelectedValue 更改为您已有的任何值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T18:39:45.890

我不确定 linq 的来源，但您可以在文件后面的代码中以声明方式或在运行时设置 RadioButtonList.SelectedValue 属性。MSDN 上的此页面应该为您指明正确的方向：

[http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.listcontrol.selectedvalue.aspx](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.listcontrol.selectedvalue.aspx)

或者发布您的 ASPX 和 ASPX.CS 代码，我很乐意更具体一点。

# ruby-on-rails - 嵌套形式建模导轨

> ID：11833791
> 
> 赞同：0
> 
> 时间：2012-08-06T18:24:33.127
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, ruby-on-rails-3.1

我想知道我最好的方法来做我想要实现的目标。我已经在[http://railscasts.com/episodes/196-nested-model-form-revised](http://railscasts.com/episodes/196-nested-model-form-revised)完成了铁路广播，但对如何进行有点不确定

这是我的模型

```
Customer
Book
BookManager 
```

一个客户有_many book_manager，其中book_manager has_many book。我正在遵循 railcasts 提供的嵌套关系，但这里是我的模型

```
Customer       BookManager         Book
ID             Customer_ID         ID
First          Book_ID             Description
Last           isVisible
               isDeleted 
```

这个想法是客户创建一个新的 book_description 并设置它是否可见，如果客户删除该项目，那么我想隐藏它但还在数据库中设置与其关联的 book_manager 已删除，但根本没有删除在数据库中。

感谢您对如何进行的任何建议或想法表示赞赏

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T19:10:49.323

由于 Book 似乎与 BookManger 是一对一的关系，因此您可能需要考虑将两者结合起来。除非，我误解了这些关系。它可能会使事情变得更简单。

至于处理隐藏，这很容易在您的控制器/视图中通过访问您已经拥有的字段来完成：isVisible 和 isDeleted。您甚至可以在模型中创建范围，例如：

```
class BookManager
  scope :active, where(["isVisible = ? AND isDeleted = ?", true, false]) 
```

# wpf - 更改 WPF 项目的启动文件

> ID：11833796
> 
> 赞同：2
> 
> 时间：2012-08-06T18:24:56.493
> 
> 标签：wpf

我确信这是一个微不足道的问题，但这是我似乎无法解决的问题之一。

我将 App.xaml 中的启动文件从`StartupUri="MainWindow.xaml"`下面的代码更改为我需要做的所有事情。

```
<Application x:Class="MVVMPrototype.App"
         xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
         xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
         StartupUri="MVVMPrototype.View.MVVMPrototype.xaml">
<Application.Resources>

</Application.Resources> 
```

但是，然后我收到以下错误，指出我需要将构建属性设置为资源，如下所示。以前它设置为 Page，这与 MainWindow.xaml 的设置相同。

![资源](../Images/6e0b2cbbdb26c6d7782aefa8fdc23c34.png)

这样做之后，我会遇到一个编译器错误，指出`InitializeComponent();`当前上下文中不存在。我唯一知道会发生这种情况的是类/命名空间在 .cs 文件和 .xaml 文件之间不同步时，但事实并非如此。

我查看了[StartupUri 文档](http://msdn.microsoft.com/en-us/library/system.windows.application.startupuri.aspx)，但我发现它没有那么有用。我确信这是我忽略的一些愚蠢的事情。是的，我已经多次清理并构建了该项目，但都没有运气。有谁知道如何解决它？

**更新：** Seva Titov 已经解决了第一部分。但现在我有`TargetInvocationException`一个内部例外，`System.Security.SecurityException`如下图（如果太难阅读，请在新选项卡中打开图像）：

![安全异常](../Images/657315fd7402292323c025a0d6af3bc3.png)

有什么想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-06T18:37:32.457

StartupUri 指定相对文件位置，并且您似乎在文件夹 View 中有一个文件 MVVMPrototype.xaml，因此您的代码应如下所示：

```
<Application x:Class="MVVMPrototype.App" 
     xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" 
     xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" 
     StartupUri="View/MVVMPrototype.xaml"> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-07T11:24:45.033

好的，我现在已经弄清楚发生了什么。

正如 Seva Titov 在回答中指出的那样， StartupUri 的值应该是`"View/MVVMPrototype.xaml"`.

`InitializeComponent();`声明它未在当前上下文中定义的错误是因为对**MVVMPrototype.xaml 的属性的构建操作设置为 resource，而不是 page**。最初我认为添加一个新的 Window 控件可以解决这个问题，但事实证明这是一个红鲱鱼，因为构建操作被设置为新控件上的页面 - 我认为这是默认设置。

通过切换 Project Properties -> Security 下的“Enable ClickOnce security settings”来生成**app.manifest** ，我修复了最后一个错误`TargetInvocationException`和内部异常。`System.Security.SecurityException`

 **这给了我最后一个错误，它无法找到清单签名证书，所以我只是取消选中项目属性 -> 签名下的“签署 ClickOnce 清单”。

这解决了我的问题。希望它可以帮助别人。请注意，我对部署/发布知之甚少（如果有的话），我不确定最后两个将如何影响这一点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-04-03T19:02:02.703

在 App.xaml 中

StartupUri="/ProjectName;component/Folder or Path/File or Page.xaml">**

# php - XML文件保存，潜在的安全问题？

> ID：11833802
> 
> 赞同：0
> 
> 时间：2012-08-06T18:25:37.660
> 
> 标签：php, xml, security, magento, file-io

我正在创建一个 Magento 模块，它将用户输入数据保存到一个 xml 文件中（保存在服务器上供以后使用 - 想想名片订单）。我想知道我的流程有多安全，以及可能出现什么（如果有的话）安全问题。我会注意到，我正在与一家专门生产符合 pci 标准的服务器的公司托管这个站点，此外，它还运行在`CHROOT`.

我有一些旧的 Flash 文件可以输入（有很多，或者我只是重新创建它们）。这些是打印订单，因此它们需要接受各种特殊字符（因此，不会在验证方面做太多事情）。

从那里： $.ajax -> processor.php ->

```
 /* grab params */
    if (isset($_POST)) {
        foreach ($_POST as $key => $value) {
            $params[$key] = filter_var($value, FILTER_SANITIZE_STRING);
        }
    }

    /* build xml */
    $xml = new DOMDocument('1.0', 'UTF-8');
    $xml_root = $xml->createElement('Root');
    foreach ($params as $key => $value) {
        $xml_node = $xml->createElement( $key );
        if(!empty($value) && $value != 'undefined'){
            $xml_node->appendChild( $xml->createTextNode( $value ));
        }
        $xml_root->appendChild($xml_node);
    }
    $xml->appendChild($xml_root);

    /* create filename */
    $d = new DateTime('now');
    $date = str_replace(" ", ".",$d->format('Y-m-d G:i:s'));
    $keyvar = preg_replace('/[^a-zA-Z0-9-]/', '', $params['keyVar']);
    $filename = str_replace(" ", "", $params['template'].".".$date.".".$keyvar.".xml" );
    $file = $_SERVER['DOCUMENT_ROOT'].'/media/customer/orders/'.$filename;

    /* write it */
    $xml->save($file); 
```

然后我只是将文件的引用（但不是位置）传递回客户端以附加到订单。

所以：不包括；vars 被清理（仍然允许特殊字符）；唯一的文件名；文件保存到未知位置（通过前端）。

该系统将受到 IT 安全性的审查，我只想在审查之前抓住任何东西。

我错过了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T14:26:59.050

在可服务文件之外保存是一个好主意，并且易于实现。另外-在保存之前最终检查目录遍历...

```
$path = '/home/user/orders/printing/';
$file = $path.$filename;

if ( !preg_match("../", $file) ){
    /* write it */
    $xml->save($file);
} 
```

# spring - 在spring中覆盖bean配置

> ID：11833804
> 
> 赞同：10
> 
> 时间：2012-08-06T18:25:57.720
> 
> 标签：spring, inversion-of-control

假设我有两个模块。一个是核心，另一个是核心依赖的实现模块。Core 是该依赖实现模块战争的 jar 文件。

在核心中，我定义了一个 bean，例如

```
<bean id="x" class="com.pokuri.X">
 <property name="y" ref="y"/>
 <property name="z" ref="z"/>
</bean> 
```

该类有一个方法如下

```
public class X{

  public void doSomeJob(){
   .......
  }   

} 
```

这个方法是从一些核心类中调用的。现在我需要根据我的核心相关实现来更改 X 的 doSomeJob() 方法中的逻辑。所以，我创建了一个这样的类

```
public class ExtX extends X{

  @override
  public void doSomeJob(){
    // changed logic
  }

} 
```

并像这样在另一个应用程序上下文 xml 文件中定义了具有相同 id 的 bean。

```
<bean id="x" class="com.pokuri.ExtX">
     <property name="y" ref="y"/>
     <property name="z" ref="z"/>
</bean> 
```

我们正在使用`contextConfigLocation`上下文参数`web.xml`将值指定为来构建应用程序上下文`classpath:springfolder`。

但在核心逻辑中，我只得到核心 bean 实例（即`X`实例）而不是`ExtX`。我们如何覆盖该 bean 定义并让系统开始使用新的扩展 bean 定义？

而且我听说在不同的应用程序上下文文件中具有相同的 ID 将用稍后加载的 bean 定义覆盖第一次加载的 bean 定义。当找到具有相同 ID 的 bean 时，是否有任何`priority`关于 bean 定义的属性让 ApplicationContext 使用最高优先级的优先级来考虑低优先级的优先级。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-08-06T18:55:28.987

覆盖 bean 定义的一种方法是您所指示的 - 多次使用相同的 id 定义它，最后一个具有相同 id 的 bean 定义是生效的。因此，如果您确保这`ExtX`是最后一个加载的，它应该可以正常工作，并且为了确保这一点，您可以在您的 war 文件中执行此操作，而不是通过说加载`classpath:springfolder`，您可以在您的 war 的 Spring 配置文件中显式导入核心配置然后以这种方式覆盖bean：

```
<import resource="core-resource.xml"/>
<bean id="x" class="com.pokuri.ExtX">
     <property name="y" ref="y"/>
     <property name="z" ref="z"/>
</bean> 
```

这将确保您覆盖的 bean 是生效的。

但是，这里没有可以使用的优先级/顺序字段 - 如果您愿意，您可以通过提供`Map<String,X>`作为参数来加载类型的所有 bean 定义，并通过期望 order 属性对其进行排序并以这种方式使用它，但是还有很多工作要做。

这里描述了第二种方法：[Overriding the bean defined in parent context in a child context](https://stackoverflow.com/questions/4249978/overriding-the-bean-defined-in-parent-context-in-a-child-context)

# java - 在 Android 应用中添加许多保存的图像

> ID：11833806
> 
> 赞同：1
> 
> 时间：2012-08-06T18:26:02.320
> 
> 标签：java, android, android-imageview

我正在尝试构建的应用程序将显示大量图像（在 ImageViews 中），并且我不会从服务器/在线服务中获取它们，因为它需要离线使用。我知道我可以将它们转储到 res/drawable 目录中，但我想知道是否有任何方法可以优化它。有没有办法以某种方式压缩这些图像（除了使它们更小，它们已经像我需要的一样小）或使用其他类型的 android 工具来更好地将它们本地存储在设备上？

我可能只是忽略了一个使用良好的功能，如果是这样，如果有人能指出我，那就太好了。

编辑：如果我要以某种方式压缩图像，我需要在运行时解压缩或其他东西，这将需要另一个线程/加载时间。我也不知道该怎么做，所以我只是在集思广益，我想这里有人会在某个时候遇到这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T18:40:37.937

如果您还没有，这是一本很好的读物 - [http://developer.android.com/guide/practices/ui_guidelines/icon_design.html#design-tips](http://developer.android.com/guide/practices/ui_guidelines/icon_design.html#design-tips)

> **保存图像资产时，删除不必要的元数据**
> 
> 尽管 Android SDK 工具在将应用程序资源打包到应用程序二进制文件时会自动压缩 PNG，但最好的做法是从 PNG 资产中删除不必要的标头和元数据。OptiPNG 或 Pngcrush 等工具可以确保删除此元数据并优化您的图像资产文件大小。

在所有其他压缩逻辑之外，上面将是开始的地方。另外，当您说“优化”时-您的意思是优化应用程序中加载图像/可绘制对象的方式还是仅优化应用程序将消耗的空间量（在磁盘上）？

# c# - 如何在 C# 中检测套接字断开连接

> ID：11833808
> 
> 赞同：10
> 
> 时间：2012-08-06T18:26:14.520
> 
> 标签：c#, sockets, tcpclient, streamwriter

我正在处理客户端/服务器关系，该关系旨在在不确定的时间内来回推送数据。

我试图克服的问题是在客户端，因为我无法找到一种方法来检测断开连接。

我对其他人的解决方案进行了几次尝试，从捕获 IO 异常到在所有三个 SelectMode 上轮询套接字。我也尝试过使用轮询的组合，并检查套接字的“可用”字段。

```
// Something like this
Boolean IsConnected()
{
    try
    {
        bool part1 = this.Connection.Client.Poll(1000, SelectMode.SelectRead);
        bool part2 = (this.Connection.Client.Available == 0);

        if (part1 & part2)
        {
            // Never Occurs
            //connection is closed
            return false;
        }
        return true;
    }
    catch( IOException e )
    {
        // Never Occurs Either
    }
} 
```

在服务器端，尝试向客户端写入“空”字符 (\0) 会强制 IO 异常，并且服务器可以检测到客户端已断开连接（非常容易 gig）。

在客户端，同样的操作不会产生异常。

```
// Something like this
Boolean IsConnected( )
{
    try
    {

        this.WriteHandle.WriteLine("\0");
        this.WriteHandle.Flush();
        return true;
    }
    catch( IOException e )
    {
        // Never occurs
        this.OnClosed("Yo socket sux");
        return false;
    }
} 
```

我相信我在通过轮询检测断开连接时遇到的一个问题是，如果我的服务器自上次检查以来尚未将任何内容写回客户端，我很容易在 SelectRead 上遇到错误...确定要在这里做什么，我已经找到了每个选项来进行我能找到的检测，但对我来说没有任何事情是 100% 的，最终我的目标是检测服务器（或连接）故障，通知客户端，等待重新连接，等等。所以我相信你可以想象这是一个不可或缺的部分。

欣赏任何人的建议。提前谢谢。

**编辑：任何查看这个问题的人都应该注意下面的答案，以及我对它的最终评论。我已经详细说明了我是如何克服这个问题的，但还没有发表“问答”风格的帖子。**

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-06T18:47:16.727

一种选择是使用 TCP 保持活动数据包。您可以通过调用来打开它们`Socket.IOControl()`。唯一烦人的一点是它需要一个字节数组作为输入，因此您必须将数据转换为字节数组才能传入。这是一个使用 10000 毫秒保持活动并重试 1000 毫秒的示例：

```
Socket socket; //Make a good socket before calling the rest of the code.
int size = sizeof(UInt32);
UInt32 on = 1;
UInt32 keepAliveInterval = 10000; //Send a packet once every 10 seconds.
UInt32 retryInterval = 1000; //If no response, resend every second.
byte[] inArray = new byte[size * 3];
Array.Copy(BitConverter.GetBytes(on), 0, inArray, 0, size);
Array.Copy(BitConverter.GetBytes(keepAliveInterval), 0, inArray, size, size);
Array.Copy(BitConverter.GetBytes(retryInterval), 0, inArray, size * 2, size);
socket.IOControl(IOControlCode.KeepAliveValues, inArray, null); 
```

仅当您不发送其他数据时才发送保持活动数据包，因此每次发送数据时，都会重置 10000 毫秒计时器。

# c++ - double&（不通过引用传递）C++

> ID：11833814
> 
> 赞同：2
> 
> 时间：2012-08-06T18:26:33.243
> 
> 标签：c++, reference, double, declaration

```
typedef double real8;

typedef real8 Real_t;

Real_t& x(int y); 
```

什么是`Real_t&`？？我只看到一个数据类型后跟“&”表示通过引用传递。但这是在声明行中。这是什么意思 ？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-06T18:29:06.740

这意味着该函数返回对 a 的引用，该引用`Real_t`实际上是 a `double`。如果你解析了所有的类型定义，那么它就是一个`Real_t`。`real8``double`

**你应该在这里小心。如果通过引用传递的结果不是从存在于函数末尾的作用域中检索到的，那么您将有一个悬空引用。**

例如：

```
int& foo() {
    int x = 8;
    return x;
}

int main() {
    int y = foo();
} 
```

main 中的变量 ,`y`最终引用了一个变量，该变量在返回时超出范围而被销毁`foo()`，因此使用它是**未定义的行为**。如果`x`从单例或函数范围之外的东西中检索到`foo()`，那么它仍然存在，这很好。

人们有时会返回引用以在编译单元之间以确定性方式初始化静态全局变量，因此您可能会看到它与静态变量一起使用，例如：

```
MyClass& MyStaticVar() {
    static MyClass instance;
    return instance;
} 
```

这也可以，因为静态在初始化后会在程序的持续时间内存在。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-08-06T18:27:18.983

这意味着`x`是一个返回对 a 的引用的函数`Real_t`。

通过引用返回的一个例子是类中的数据访问。例如，[std::vector::at()](http://en.cppreference.com/w/cpp/container/vector/at)返回对向量元素的引用。

为了让自由函数安全地返回引用，函数内部必须发生一些不明显的事情，以确保不返回悬空引用。

# php - Joomla 2.5 hello world 模块开发

> ID：11833815
> 
> 赞同：1
> 
> 时间：2012-08-06T18:26:34.547
> 
> 标签：php, database, joomla, module, joomla2.5

我是 Joomla 2.5 模块开发的新手，所以我阅读了[本](http://www.minitek.gr/tutorials/joomla-16-tutorials/item/89-how-to-create-a-database-driven-joomla-module.html)教程并复制并粘贴了所有内容而没有更改，当我在服务器端安装一切正常但在前端显示此错误时：

1) 严格标准：非静态方法 modUserDataHelper::getData() 不应在第 16 行的 C:\xampp\htdocs\joomla\modules\mod_userdata\mod_userdata.php 中静态调用

2）严格的标准：只有变量应该通过引用在第 24 行的 C:\xampp\htdocs\joomla\modules\mod_userdata\helper.php 中分配

所以你能告诉我我的代码有什么问题吗？

文件：

```
mod_userdata.xml
mod_userdata.php
helper.php
index.html
tmpl/default.php
tmpl/index.html 
```

mod_userdata.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<extension type="module" version="1.7" client="site" method="upgrade">
 <name>User Data Module</name>
 <author>Minitek.gr</author>
 <creationDate>03/08/2011</creationDate>
 <copyright>Copyright (C) 2011\. All rights reserved.</copyright>
 <license>http://www.gnu.org/licenses/gpl-2.0.html GNU/GPL</license>
 <authorEmail>your_email</authorEmail>
 <authorUrl>www.minitek.gr</authorUrl>
 <version>1.7.1</version>
 <description>Users Data Module</description>
 <languages>
 </languages>
 <files>
  <filename module="mod_userdata">mod_userdata.php</filename>
  <filename>mod_userdata.xml</filename>
  <filename>helper.php</filename>
  <filename>index.html</filename>
  <folder>tmpl</folder>
 </files>
 <config>
  <fields name="params">
   <fieldset name="basic">
    <field name="moduleclass_sfx" type="text" default="" label="Module Class Suffix" description="Suffix for individual css styling" />
    <field name="limit" type="text" default="10" label="Limit Displayed Users" description="Limit Displayed Users" />
    <field name="user_id" type="radio" default="1" label="Display user ID" description="Display user ID">
     <option value="0">JNO</option>
     <option value="1">JYES</option>
    </field>
    <field name="user_name" type="radio" default="1" label="Display Name" description="Display Name">
     <option value="0">JNO</option>
     <option value="1">JYES</option>
    </field>
    <field name="user_username" type="radio" default="1" label="Display Username" description="Display Username">
     <option value="0">JNO</option>
     <option value="1">JYES</option>
    </field>
   </fieldset>
  </fields>
 </config>
</extension> 
```

mod_userdata.php

```
<?php
/**
 * @package Joomla.Site
 * @subpackage  mod_userdata
 * @copyright   Copyright (C) 2005 - 2011 Open Source Matters, Inc. All rights reserved.
 * @license GNU General Public License version 2 or later; see LICENSE.txt
 */

// no direct access
defined('_JEXEC') or die;

// Include the syndicate functions only once
require_once dirname(__FILE__).'/helper.php';

// Get the user data
$list   = modUserDataHelper::getData($params);  // <-- ERROR IS HERE!!!

// Get the layout
require JModuleHelper::getLayoutPath('mod_userdata', $params->get('layout', 'default')); 
```

助手.php

```
<?php
/**
 * @package     Joomla.Site
 * @subpackage  mod_userdata
 * @copyright   Copyright (C) 2005 - 2011 Open Source Matters, Inc. All rights reserved.
 * @license     GNU General Public License version 2 or later; see LICENSE.txt
 */

// no direct access
defined('_JEXEC') or die;

class modUserDataHelper
{
  function getData( &$params )
  {

   // Database query        
   $list = array();         
   $query = " SELECT id, name, username "               
   ." FROM #__users "
   ." WHERE block=0 "               
   ." ORDER BY id DESC "
   ." LIMIT " . $params->get( 'limit' );                
   $db =& JFactory::getDBO();   // <-- ERROR IS HERE!!!
   $db->setQuery( $query );     
   $rows = $db->loadObjectList();

   // Get list items
   if ($rows!=null)
   {
    $i=0;
    foreach ($rows as $row) 
    {               
     $list["users"][$i]["id"]=$row->id;
     $list["users"][$i]["name"]=$row->name;
     $list["users"][$i]["username"]=$row->username;
     $i++;      
    }
    return $list;
   }

  }
} 
```

tmpl/default.php

```
<?php
/**
 * @package     Joomla.Site
 * @subpackage  mod_userdata
 * @copyright   Copyright (C) 2005 - 2011 Open Source Matters, Inc. All rights reserved.
 * @license     GNU General Public License version 2 or later; see LICENSE.txt
 */

// no direct access
defined('_JEXEC') or die; ?>

<div class="moduletable<?php echo $params->get( 'moduleclass_sfx' ) ?>">

 <ul>
  <?php for ($i=0;$i< sizeof($list["users"]); $i++) { ?>    

     <li>
      <?php if ($params->get( 'user_id' )) { ?>
         <span><?php echo $list["users"][$i]["id"];?></span>
        <?php } ?>
        <?php if ($params->get( 'user_name' )) { ?>
         <span><?php echo $list["users"][$i]["name"];?></span>
        <?php } ?>
        <?php if ($params->get( 'user_username' )) { ?>
         <span><?php echo $list["users"][$i]["username"];?></span>
        <?php } ?>
     </li>

    <?php } ?>
 </ul>

</div> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T19:01:48.747

您打开了“严格标准”，这会引发一些错误，因为代码是为（可能）php 5.3 而不是 5.4 编写的。看起来一个对象正在被实例化或通过引用分配（`&new MyClass`而不是`new MyClass`）`modUserDataHelper::getData()`，并且没有定义为静态的对象被称为好像它是`static`。

您可以做两件事：关闭严格的标准（代码相当于在地毯下扫尘）或修复不良代码。在这种情况下，调用`modUserDataHelper::getData()`是不好的形式。它需要从实例化的对象中调用，而不是从静态上下文中调用。创建它的一个实例（`$tempObj`或类似的东西），然后从该对象（`$tempObj->getData();`）调用方法。

# ios - 为什么我不能将本地化添加到我的 iOS 应用程序？

> ID：11833821
> 
> 赞同：22
> 
> 时间：2012-08-06T18:26:57.590
> 
> 标签：ios, xcode, localization

我正在尝试添加本地化。我已经阅读了来自 Apple 和 raywenderlich.com 的所有本地化/国际化指南。我已经用 NSLocalizedString 宏标记了我的所有代码，我使用了 genstrings 来创建 Localizable.strings。但不知何故，我错过了一些重要的步骤。

当我尝试将本地化添加到我的 Localizable.strings 时，我不知何故仅限于英语。

当我尝试通过“编辑器”->“添加本地化”向项目添加本地化时，所有语言选项都被禁用。

有人对我为什么只限于英语有任何想法吗？我错过了什么？

我尝试将本地化添加到具有相同结果的其他项目中。:(

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2012-08-06T18:33:24.193

您需要首先将本地化添加到您的项目中。单击项目文件，确保在中间窗格中选择项目而不是目标，然后选择“信息”屏幕。有一个名为“本地化”的区域，您可以在其中添加语言。然后，您应该能够本地化您的资源。

![重要作品](../Images/11dbd1a69a853601540487c37ef2f5d1.png)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2016-08-04T15:07:11.030

另一个可能的问题是您没有正确选择项目，这导致*添加本地化*列表中的所有语言都被禁用。

默认情况下，可能会选择目标，请确保您选择了项目。然后就可以正常使用*添加本地化*了。

[![在此处输入图像描述](../Images/622079f88ded4ae88c4f2d1bdb0922ef.png)](https://i.stack.imgur.com/vubqL.png)

[![在此处输入图像描述](../Images/2ef47dde9f1c0f8bb0508eadc3643693.png)](https://i.stack.imgur.com/gZaEM.png)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-04-27T16:49:55.650

有些事情让我忙了太久。我在第一个列表中查看了我需要的语言（瑞典语），然后从“其他”列表中选择了一个。好吧，我的手机或模拟器根本没有变成瑞典语。但是当我从第一个列表中选择瑞典语时，它在更改语言设置时得到了很好的更新。

![在此处输入图像描述](../Images/6b992e14122e2c93a2a0f727ec63572b.png)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2014-09-26T15:42:43.420

使用 Xcode 6，您可以通过项目设置来完成。

# drupal - 在 drupal 菜单中传递整数作为参数

> ID：11833822
> 
> 赞同：0
> 
> 时间：2012-08-06T18:26:58.823
> 
> 标签：drupal, drupal-6, drupal-routes

我正在使用drupal 6

假设我有

```
 $items['path/yo'] = array(
    'page callback' => 'callback_function',
    'page arguments' => array(1),
    'type' => MENU_CALLBACK,
  ); 
```

相反，它会将位于第 1 个位置的路径部分（在这种情况下，它将传递 'yo'）传递给 callback_function 函数......

但是如果我实际上是在尝试将整数 1 传递给函数呢？如果不先将其转换为字符串然后重新转换为整数，我将如何做到这一点...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T18:41:49.313

php 类型转换做得很好，你必须小心类型转换，尤其是 0 和 1，因为它们可以是字符串、数字或布尔值。

您可以在条件句中使用类型检查（例如 === !==）。在您当前的示例中，它首先不是字符串，而是数字。它会将 1 传递给 callback_function。

```
function callback_function($args) {
print_r($args);
} 
```

会给你通过的论据。在这种情况下`$args[0]`将是数字 1。在 99% 的情况下，您不必担心它是数字还是字符串，因为如果您将其用作数字，php 会将其转换为数字，如果您将其用作string php 会将其视为字符串。请注意条件语句并确保阅读以下内容：http: [//php.net/manual/en/language.operators.comparison.php](http://php.net/manual/en/language.operators.comparison.php)

例如看它是否是数字 1：

```
if(1 === $args[0]) echo "Numbah one!"; 
```

只会打印“Numbah one！” 如果它是数字类型和数字 1。如果您愿意，可以使用

```
(int)$args[0];
(string)$args[0];
(boolean)$args[0]; 
```

分别。

你也可以看看这篇文章： [http ://drupal.org/node/1473458](http://drupal.org/node/1473458)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T20:44:22.917

```
 $items['path/yo'] = array(
    'page callback' => 'callback_function',
    'page arguments' => array("1"),
    'type' => MENU_CALLBACK,
  ); 
```

另见沃尔夫的回答。如果输入 (int) 1，它将是 arg(1)。输入要按原样传递给页面回调的字符串。

# c# - 在 C# 中，如何激活先前聚焦的窗口？

> ID：11833827
> 
> 赞同：1
> 
> 时间：2012-08-06T18:27:20.153
> 
> 标签：c#, winapi, window, focus

我工作例如。在 Firefox 中，我的 C#.NET 应用程序将其窗口置于最前面。没关系，但是当我使用 SendToBack() 隐藏表单时，它不会激活 Firefox 的窗口，所以尽管 Firefox 在前台，我必须单击窗口才能滚动，等等。如何激活C# 中先前聚焦的窗口？

我试过这些：

```
[DllImport("User32")]
private static extern int SetForegroundWindow(IntPtr hwnd);

[DllImport("user32.dll")]
static extern bool AllowSetForegroundWindow(int dwProcessId);

[DllImport("user32.dll")]
static extern IntPtr GetForegroundWindow();

[...]

AllowSetForegroundWindow(System.Diagnostics.Process.GetCurrentProcess().Id);
SendToBack();
SetForegroundWindow(GetForegroundWindow()); 
```

我希望在将我的窗口发回后，GetForegroundWindow 会返回上一个，但它不起作用。

其次，我尝试覆盖 WndProc，并处理 WM_ACTIVATE 消息以从 lParam 获取前一个窗口，但如果我使用 SetForegroundWindow() 和此句柄，它也不起作用。

```
protected override void WndProc(ref Message msg) {
        if (msg.Msg == 0x0006) {
            prevWindow = msg.LParam;
        }
        base.WndProc(ref msg);
}

[...]

SetForegroundWindow(prevWindow); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T18:31:14.860

您是否尝试过 SetActiveWindow 功能？它与 SetForgroundWindow 函数分开，尽管您可能需要同时使用它们。

[http://msdn.microsoft.com/en-us/library/windows/desktop/ms646311%28v=vs.85%29.aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/ms646311%28v=vs.85%29.aspx)

还有一个 SetFocus 功能听起来好像可以工作。

[http://msdn.microsoft.com/en-us/library/windows/desktop/ms646312%28v=vs.85%29.aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/ms646312%28v=vs.85%29.aspx)

**更新**

为了获得当前的活动窗口，我会在将应用程序移动到堆栈的前面之前触发 GetActiveWindow 函数，这样你就可以拥有之前活动的窗口的句柄。

[http://msdn.microsoft.com/en-us/library/windows/desktop/ms646292%28v=vs.85%29.aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/ms646292%28v=vs.85%29.aspx)

**另一个更新** 我在网站上做了更多的挖掘，并提出了以下三个链接，这可能会更好。键盘输入功能似乎取决于您尝试设置为调用线程消息队列的一部分的 Window，因为我们正在处理两个单独的应用程序线程，所以情况可能并非如此。

[获取GUIThreadInfo](http://msdn.microsoft.com/en-us/library/windows/desktop/ms633506%28v=vs.85%29.aspx) `Get the threads information, including active window`

[GUITHREADINFO](http://msdn.microsoft.com/en-us/library/windows/desktop/ms632604%28v=vs.85%29.aspx) `The GUITHREADINFO structure`

[切换到此窗口](http://msdn.microsoft.com/en-us/library/windows/desktop/ms633553%28v=vs.85%29.aspx) `Another method of window changing`

所有这些都与 SetForegroundWindow 方法位于同一方法堆栈中，这似乎使它们更有可能执行您正在尝试的操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T18:47:21.177

当您调用`SetFocus()`向前移动您的应用程序时，它会返回在您之前具有焦点的窗口的句柄。

# iphone - iPhone - Http Post：将值发送到 Web xml

> ID：11833831
> 
> 赞同：0
> 
> 时间：2012-08-06T18:27:41.623
> 
> 标签：iphone, objective-c, xcode, http-post

我知道对此有很多问题，但似乎没有一个适合我想做的事情。我想更改标签的值，所以假设我有这个文件：

```
</Courbe>
<tempset>140</tempset>
</Courbe> 
```

我希望我的 http post 请求更改此值。我该怎么做呢？

我已经尝试过这样的事情：

```
- (IBAction)changeTemp:(id)sender 
{
NSMutableURLRequest *request = [[NSMutableURLRequest alloc] initWithURL:[NSURL     URLWithString:@"http://207.134.145.16:50001/Courbe.xml"]];
[request setHTTPMethod:@"POST"];
[request setValue:@"text/xml" forHTTPHeaderField:@"Content-type"];

NSString *xmlString = @"<tempset>137</tempset>";

[[NSURLConnection alloc] initWithRequest:request delegate:self];
} 
```

是这样的吗？谢谢你的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T18:35:39.513

Url 对 xmlString 进行编码，然后：

```
NSData *postData = [xmlString dataUsingEncoding:NSASCIIStringEncoding allowLossyConversion:YES];
[request setHTTPBody:postData];
[request setValue:[NSString stringWithFormat:@"%d", [postData length]] forHTTPHeaderField:@"Content-Length"];
[request setValue:@"text/xml" forHTTPHeaderField:@"Content-Type"]; 
```

要发送，请使用以下内容：

```
[NSURLConnection sendAsynchronousRequest:request queue:[NSOperationQueue mainQueue] completionHandler:^(NSURLResponse *response, NSData *data, NSError *error) {}]; 
```

在 iOS5 之前，你可以这样异步发送：

```
// make the request and an NSURLConnection with a delegate
NSURLRequest *request = [NSURLRequest requestWithURL:[NSURL URLWithString:url]];
[[[NSURLConnection alloc] initWithRequest:request delegate:self] autorelease];

// create a property to hold the response data, then implement the delegate methods
- (void)connection:(NSURLConnection *)connection didReceiveResponse:(NSURLResponse *)response  {
    responseData = [[NSMutableData alloc] init];
}

- (void)connection:(NSURLConnection *)connection didReceiveData:(NSData *)data {
    [responseData appendData:data];
}

- (void)connection:(NSURLConnection *)connection didFailWithError:(NSError *)error {
    [responseData release];
    [textView setString:@"Unable to fetch data"];
}

- (void)connectionDidFinishLoading:(NSURLConnection *)connection {
    NSString *responseString = [[[NSString alloc] initWithData:responseData encoding: NSASCIIStringEncoding] autorelease];
} 
```

# iframe - 如何使谷歌索引仅页面的图像？

> ID：11833837
> 
> 赞同：0
> 
> 时间：2012-08-06T18:27:57.723
> 
> 标签：iframe, seo, google-image-search, noindex

我有一个包含很多图像的页面，但它是一个设计为在另一个页面内的 iframe 中的页面。我不希望这个页面被索引以防止访问者被困在这个 iframe 中，但我想索引 iframe 内的所有图片。

iframe 是一个在页面上打开的图片滑块，有上一个/下一个按钮和图片。我发现放入元机器人“NOINDEX，FOLLOW”并在图片上链接到原始图片是不好的......因为图片已经是全屏的。我的另一个选择是将链接放回父页面，但是因为 iframe 是在页面上打开的，所以在同一页面上打开页面会很糟糕。我该怎么办 ？

如果我不索引此页面，则只有我的缩略图会显示在谷歌图片中。你讨厌谷歌图片中的缩略图吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T21:21:09.527

我最终索引了该页面并使用 javascript 条件将链接放回源页面：如果该页面未在 iframe 中打开，则显示链接以返回上一个源页面。

# gcc - Mac OSX Mountain Lion 上的 GCC-4.2 错误，无法安装 mysql-python

> ID：11833838
> 
> 赞同：9
> 
> 时间：2012-08-06T18:28:00.937
> 
> 标签：gcc, mysql-python, osx-mountain-lion

我在 Mac OSX Mountain Lion 上构建 MySQLdb 时遇到问题。从 OSX Lion 升级到 OSX Mountain Lion 后，我还下载并安装了 Xcode 4.4。然后，我去了 Xcode 的 Preference > Downloads 并安装了命令行工具。

我已经下载了 MySQL-python 版本。1.2.3 来自[http://sourceforge.net/projects/mysql-python/](http://sourceforge.net/projects/mysql-python/)

当我跑

```
python setup.py build 
```

我收到以下消息：

```
running build
running build_py
copying MySQLdb/release.py -> build/lib.macosx-10.6-intel-2.7/MySQLdb
running build_ext
building '_mysql' extension
gcc-4.2 -fno-strict-aliasing -fno-common -dynamic -g -O2 -DNDEBUG -g -O3 -Dversion_info=(1,2,3,'final',0) -D__version__=1.2.3 -I/usr/local/mysql/include -I/Library/Frameworks/Python.framework/Versions/2.7/include/python2.7 -c _mysql.c -o build/temp.macosx-10.6-intel-2.7/_mysql.o -Os -g -fno-common -fno-strict-aliasing -arch x86_64
unable to execute gcc-4.2: No such file or directory
error: command 'gcc-4.2' failed with exit status 1 
```

但是，gcc 存在。当我跑

```
gcc 
```

我明白了

```
i686-apple-darwin11-llvm-gcc-4.2: no input files 
```

下面是我发现的一个类似问题，但它的解决方案，这正是我已经做过的，对我不起作用。

[如何在 Mountain Lion 上安装 MySQLdb](https://stackoverflow.com/questions/11787012/how-to-install-mysqldb-on-mountain-lion)

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-08-09T00:20:47.803

在使用 Ruby On Rails 3.2.7 时，我遇到了类似的问题。我也将系统升级到了 Mountain Lion，安装了 Xcode 4.4.1 并下载了命令行工具。

在命令行上，我收到一条错误消息，说无法找到该文件：（`/usr/bin/gcc-4.2`我现在无法粘贴精确的输出，对不起）。

我确实有一个`/usr/bin/gcc`，它的版本是`i686-apple-darwin11-llvm-gcc-4.2 (GCC) 4.2.1`

我通过符号链接同一目录中的文件并为其命名 Ruby 脚本正在寻找的名称解决了这个问题：

```
sudo ln -s /usr/bin/gcc /usr/bin/gcc-4.2 
```

之后，一切正常。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-24T10:08:02.767

Use the following command to make make (or similiar) use the correct gcc:

`export CC=/usr/bin/gcc`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-29T18:25:22.907

我遇到了这个。对我来说，这是因为我从[http://python.org](http://python.org)的 DMG 安装程序安装了 python 。这些是针对错误的 gcc 构建的。我通过使用 Homebrew 从源代码编译 python 来修复它：http: [//mxcl.github.com/homebrew/](http://mxcl.github.com/homebrew/)

```
brew install python 
```

链接到正确的 gcc

（在我的具体情况下，我使用的是较旧的 Python，这就是我使用 DMG 安装程序的原因。我发现自制软件也有旧版本的公式）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-06T19:00:38.783

我通过使用 ActivePython 绕过了这个问题。

[这里](http://code.activestate.com/pypm/mysql-python/)有 MySQLdb 的具体安装说明。

由于这是我第一次使用 ActivePython，我不确定这是否是解决此问题的可靠解决方案。因此，我将保留这个问题，直到我确保它有效。

# jquery - Asp.net MVC 3 JSON 模型绑定器

> ID：11833840
> 
> 赞同：0
> 
> 时间：2012-08-06T18:28:11.137
> 
> 标签：jquery, asp.net-mvc-3, modelbinders

所以我有这个 JSON

```
mrn:"0760433"
res:[{"registry":1,"episodeType":{"id":6,"dateAndTime":"08-06-2012 13:21"}}] 
```

我有这些视图模型

```
 public class patient
    {
        public string mrn { get; set; }

    }

    public class episodeType
    {
        public int id { get; set; }
        public string dateAndTime { get; set; }
    }

    public class registryEpisode 
    {
        public int registry { get; set; }
        public episodeType episodeType { get; set; }

       public registryEpisode()
       {
           registry = 0;
           episodeType = new episodeType();
       }
    } 
```

这个控制器签名：

```
public JsonResult StartSession(string mrn, List<registryEpisode> res) 
```

当我发布时， res 始终为空。有什么想法吗？我究竟做错了什么？是的，我在发帖，是的，我正在使用 jquery：

```
$.post('Action', data, function () {}); 
```

是的，我确实在我的控制器上执行了我的操作，但 res 为空。帮助！一如既往地提前感谢...！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T20:58:20.547

所以这是一个有趣的解决方案……我正在使用淘汰赛。Knockout 有一些特性，允许您将 viewModel 作为 pojo（普通的旧 JSON 对象）或 pojso（普通的旧 javascript 对象）提供。

所以这是一个糟糕的时刻...... asp.net 模型绑定器需要一个字符串化的 JSON 字符串进行转换。Knockout 的 toJSON 已经对 viewModel 进行了字符串化，因此当您将原始类型（如字符串）和集合作为操作的参数时，您必须获取原始类型的值，例如

`var m = self.model.property();`

然后将集合作为 pojso 获取，例如

`var c = ko.toJS(self.model.collection)`

然后将它们字符串化为一个完整的视图模型，例如

`var data = JSON.stringify({prop1: m, prop2: c});`.

最后，您将带有 jquery ajax 调用的模型服务器端发送到 Action 方法，例如

`public JsonResult StartSession(string prop1, IList<registryEpisode> prop2){}`

这显然可以解决问题。对我来说似乎是一个黑客，但它有效。希望这对其他人有帮助。

# java - 将 DynamicJasper 与 Struts 2.3.3 集成时找不到类

> ID：11833842
> 
> 赞同：1
> 
> 时间：2012-08-06T18:28:18.977
> 
> 标签：java, struts2, jasper-reports, dynamic-jasper

我正在使用*DynamicJasper 4并在与**Struts 2.3.3*集成时遇到问题。

我使用***DynamicJasperStruts2-1.jar***来显示生成的报告，但问题是这个 jar 导入***`TextUtils`***类需要***x-work 2.1***库。

但是对于*Struts 2.3.3*，我们需要不包含该类的***xwork-core 2.3.3******`TextUtils`*** jar 。

因此，在集成时出现错误`Class not found`，因此请更新***DynamicJasperStruts2-1.jar***以使其与*Struts 2.3.3*兼容。

我所有的项目都在*Struts 2.3*上，所以降级是个问题。

你有什么建议来解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T06:46:53.083

如果我`TextUtils`对常见的字符串操作是正确的实用程序，实际上这是从 opensymphony 项目之一移植的。

中包含的大多数方法都`TextUtils`被替换为 apache commons，并且类被删除，因为它不再需要。

*   [WW-3045](https://issues.apache.org/jira/browse/WW-3045)

我的建议是解决这个问题，`DynamicJasperStruts2-1`因为它使用了从 API 中删除的东西，以支持更灵活和更优雅的解决方案。

否则，您将别无选择，只能降级您的 S2 版本，这不是推荐的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-12T00:50:52.757

请下载解决问题的[最新版本：](http://archiva.fdvs.com.ar/repository/public1/ar/com/fdvs/DynamicJasper-Struts2/1.3/DynamicJasper-Struts2-1.3.jar)

或将您的 pom.xml 更新为

```
 <dependency>
      <groupId>ar.com.fdvs</groupId>
      <artifactId>DynamicJasper-Struts2</artifactId>
      <version>1.3</version>
    </dependency> 
```

# android - 我可以在我的 C 代码中调用“Log.*”吗？我想使用 LogCat 进行调试

> ID：11833848
> 
> 赞同：2
> 
> 时间：2012-08-06T18:29:04.767
> 
> 标签：android, android-ndk, java-native-interface, logcat

我被卡住了，在我的 C 代码中的某个地方出现错误，我不知道在哪里。我想使用简单的`Log.i( tag, msg )`或`Log.e( tag, msg )`命令。我在网上环顾四周，发现了另外两个关于 SO 的问题，但它们都没有完全解决我所说的问题。

[这种方法不是我要找的...](https://stackoverflow.com/questions/4846080/how-can-i-effectively-debug-c-code-thats-wrapped-with-jni-in-eclipse-android)

[这正是我正在寻找的，但在 C++ 中，而不是 C](https://stackoverflow.com/a/3902495/1435712)

如果 C++/C 中的语法相同，我很抱歉，但我对两者都没有什么经验。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T18:37:01.963

C中的语法是相同的

```
#include <android/log.h>

#define TAG "MYDEBUG"

#ifdef DEBUG
#  define  D(x...)  __android_log_print(ANDROID_LOG_INFO, TAG , x)
#else
#  define  D(x...) do {} while (0)
#endif

#  define  W(x...)  __android_log_print(ANDROID_LOG_WARN, TAG , x)
#  define  E(x...)  __android_log_print(ANDROID_LOG_ERROR, TAG , x) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T21:38:48.433

```
#include <cutils/log.h>
#define LOG_TAG "MYDEBUG"

...
ALOGD("Here we are!"); 
```

在旧版本中，宏是：

```
LOGD("Here we are!"); 
```

# ios - iOS 视图控制器

> ID：11833849
> 
> 赞同：0
> 
> 时间：2012-08-06T18:29:27.543
> 
> 标签：ios, uiviewcontroller

好的，这可能是一个非常基本的问题，如果是，我很抱歉，但它让我发疯，我真的需要更好地理解。

我有一个正在开发的应用程序，并为每个页面使用一个新的视图控制器和 xib 文件。

我使用以下代码调用每个页面：-

```
HelpVC = [[[HelpViewController alloc] initWithNibName:@"HelpViewController" bundle: [NSBundle mainBundle]]autorelease];
[self presentModalViewController:HelpVC animated:YES]; 
```

效果很好。

但是，如果我在一个文件中声明了它，然后我想在其他地方调用它，我就会到处出错。

有什么方法可以先在类文件中初始化所有 xib 文件，然后在需要时从该文件中调用它们？

谢谢

这是我回来的错误

错误：“UserInputViewController”之前的预期说明符限定符列表

上面的消息似乎导致我在 .h 文件中的所有声明都出错。

一些示例代码是： -

.h 文件

```
#import <UIKit/UIKit.h>
#import "CgePWViewController.h"
#import "LogBackInViewController.h"
#import "LoginViewController.h"

@interface SettingsViewController : UIViewController
{
    CgePWViewController *cPWVC;
    LogBackInViewController *LBIVC;
    LoginViewController *login;
}

@property(nonatomic, retain) CgePWViewController *cPWVC;
@property(nonatomic, retain) LogBackInViewController *LBIVC;
@property(nonatomic, retain) LoginViewController *login; 
```

所以基本上只要我在 LoginViewController 中添加它就会导致其他所有错误，如果我把它拿出来，那么应用程序就会完美运行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T18:41:40.137

您的 LoginViewController.h 是否也导入了 SettingsViewController？它似乎是一个“交叉引用”（我不知道这个词在英语中是否像在葡萄牙语中一样有意义）。

在你之前

```
@interface SettingsViewController : UIViewController 
```

放一个

```
@class LoginViewController; 
```

并检查它是否有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T18:45:14.017

不要初始化视图控制器以将它们放入属性中。相反，请在需要时立即创建它们。

假设您想在有人按下按钮时显示视图控制器。将此方法添加到您的视图控制器（假设它被命名`MyFirstViewController`）：

```
- (IBAction)someButtonDidPush: (UIButton *)sender {
    MySecondViewController *vc = [[MySecondViewController alloc] init];

    // Do stuff and then show it. One way may be like this:
    [self presentViewController: vc animated: YES completion: nil];
} 
```

只需使用上述方法连接按钮即可。不需要属性！你（可能）完成了。

# javascript - 带有函数数组的 jQuery Deferred

> ID：11833851
> 
> 赞同：11
> 
> 时间：2012-08-06T18:29:40.977
> 
> 标签：javascript, jquery, asynchronous, jquery-deferred, sequential

我有一个充满这样功能的对象：

```
var functions = {
    fun1 : function(){ ... }
    fun2 : function(){ ... }
    fun3 : function(){ ... }
}; 
```

对象键都在数组中引用，如下所示：

```
var funList = ['fun1','fun2','fun3']; 
```

我一直在使用数组来运行所有功能：

```
$.each(funList, function(i,v){
    functions[v].call(this, args);
}); 
```

我的问题是，我需要一些方法来推迟所有功能的运行，例如：

1.  在 $.each 循环中，函数串行运行
2.  一些方法可以将后续代码的运行推迟到数组/对象中的所有函数都完成之后。

我已经读过我应该为此使用 $.map 方法，但是我很难将注意力集中在它上面。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-09T18:01:59.003

哇……那是一个练习——$.Deferred() 有点难以让我的思绪全神贯注，但我让它按照我想要的方式工作！我不知道这是多么精简——也许其他人可以让它更有效率。

它的要点是使用 .pipe() 创建一个延迟链。

***编辑：我的代码（如下）在参考键列表中不容纳少于 2 个对象。我更新了 jsfiddle 以使用任何大小的键列表。***

* * *

## **您可以在这里看到所有在 JSFiddle 上的工作：http: [//jsfiddle.net/hBAsp/3/](http://jsfiddle.net/hBAsp/3/)**

* * *

这是我如何解决它的分步说明：

1.  从一个充满函数的对象和一组引用键开始（按照您希望它们处理的顺序）。这些函数应该期望收到一个延迟对象以在完成时解析：

    ```
    var obj = {
        one: function(dfd){
            /* do stuff */
            dfd.resolve();
        },
        two: function(dfd){...},
        three: function(dfd){...},
        etc...
    };
    var keys=['one','two','three', etc...];` 
    ```

2.  创建将承诺传递给初始化函数的主要延迟包装器。我们将在执行过程中将代码添加到函数中：

    ```
    var mainDeferred = $.Deferred(function(mainDFD){ 
    ```

3.  在该初始化函数中，创建一个延迟数组，手动创建第一个延迟对象：

    ```
    var dfds = [$.Deferred()]; 
    ```

4.  接下来，使用 for 循环遍历我们的键列表中的倒数第二个项目。我们将：

    1.  为我们逐步执行的每个项目创建一个延迟对象
    2.  设置一个匿名函数，它将从我们的 obj 运行与键相关的函数，传递给它以解析我们新创建的 Deferred 对象
    3.  将新创建的函数传递到先前创建的 Deferred 对象上（这就是我们必须手动创建第一个对象的原因）
    4.  您必须在 for 列表中使用封闭循环来解决 JavaScript 范围问题

        ```
        for (i=1; i<keys.length-1; i++){
            (function(n){
                dfds.push($.Deferred());
                dfds[i-1].pipe(function(){
                    obj[keys[n]].call(this,dfds[n]);
                });
            })(n);
        }; 
        ```

5.  手动创建最后一个匿名函数并将其通过管道传递到我们列表中的倒数第二个延迟对象。我们手动执行此操作，因为我们希望将主要的延迟对象传递给它以进行解析，以便在最后一个进程运行后整个 shebang 将立即触发：

    ```
    dfds[keys.length-2].pipe(function(){
        obj[keys[keys.length-1]].call(this,mainDFD);
    }); 
    ```

6.  现在我们的整个管道已经构建好了，我们所要做的就是触发第一个对象并将其分配为第一个延迟解析：

    ```
    obj[keys[0]].call(this,dfds[0]); 
    ```

7.  只需要关闭我们的主要延迟初始化函数（这将在创建延迟后立即触发：

    ```
    }); 
    ```

8.  现在我们还可以通过管道将一个函数传递给主对象，以便在我们之前的所有元素都运行后运行：

    ```
    mainDeferred.pipe(function(){
        /* do other stuff */    
    }); 
    ```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-07-06T09:07:18.807

我认为您可以使用[管道](https://api.jquery.com/deferred.pipe/)将回调函数作为数组传递。这是一个[例子](http://jsbin.com/barevedoyi/edit?js,console)。

```
var a = $.Deferred();

var b = $.Deferred();

var c = $.Deferred();

var checkA = function() {
  console.log('checkA');
  return a.resolve();
};

var checkB = function() {
  console.log('checkB');
  return b.resolve();
};

var checkC = function() {
  console.log('checkC');
  return c.reject();
};

checkAll = $.Deferred().resolve().promise();
checkAll = checkAll.pipe(checkA);
checkAll = checkAll.pipe(checkB);
checkAll = checkAll.pipe(checkC);

checkAll.done(function() {
  return console.log('checkAll done');
}).fail(function() {
  return console.log('checkAll fail');
}); 
```

输出将是

```
"checkA"
"checkB"
"checkC"
"checkAll fail" 
```

如果您想查看不同的结果，您可以在检查功能中将结果“解决”更改为“拒绝”。例如：如果您将 checkA 更改为拒绝。

```
var checkA = function() {
  console.log('checkA');
  return a.reject();
}; 
```

输出将是

```
"checkA"
"checkAll fail" 
```

它不会去 checkB 和 checkC 因为 checkA 被拒绝。这样您就可以使用数组调用该函数

```
funList = [checkA, checkB, checkC];
for(var i=0; i<funList.length; i++){
  checkAll = checkAll.pipe(funList[i]);
} 
```

笔记。**您必须确保回调始终返回 Deferred 对象。**

# php - 使用 PHP 填充 Javascript 饼图

> ID：11833852
> 
> 赞同：0
> 
> 时间：2012-08-06T18:29:48.837
> 
> 标签：php, javascript, mysql

我有一个很好的 JavaScript 饼图，其中填充了 set 变量：

```
 var chartData = [{
            company: "Company #1",
            value: 260
        }, {
            company: "Company #2",
            value: 201
        }, {
            company: "Company #3",
            value: 65
        }, {
            company: "Company #4",
            value: 39
        }, {
            company: "Company #5",
            value: 19
        }, {
            company: "Company #6",
            value: 190
        }, {
            company: "Company #7",
            value: 54
            }, {
            company: "Company #8",
            value: 74
            }, {
            company: "Company #9",
            value: 98
            }, {
            company: "Company #10",
            value: 138
        }]; 
```

我想要实现的是从我的 MySQL 数据库表 [companies] 中提取公司名称，并从具有行 [sales] 的同一个表中提取值。

我有超过 10 家与我有业务往来的公司，但只想列出前 10 名。

这可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T18:31:42.900

从您的数据库中选择前 10 家公司。

将它们放入一个数组中。

然后`echo json_encode($myArray);`

# html - CSS隐藏没有周围HTML的纯文本？

> ID：11833854
> 
> 赞同：2
> 
> 时间：2012-08-06T18:30:15.280
> 
> 标签：html, css

需要将文本隐藏在`<br>`..

这是 HTML 和 CSS 中的内容：[问题的 JsFiddle](http://jsfiddle.net/kamodev/42bNm/)

是的，`<br>`标签中没有任何内容，也不包含内容

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T19:11:03.950

您可以使用 jQuery 在运行时抓取节点并将其包装在隐藏的跨度中。 [http://jsfiddle.net/XrPuU/2](http://jsfiddle.net/XrPuU/2)

不是非常灵活或动态的，但是如果您无法控制输出以开始您的选择是非常有限的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T18:35:39.513

为什么不直接用 div 包装并创建一个具有可见性的类：隐藏属性？

```
.noshow { visibility: hidden;}

<div class="noshow">Some text to hide</div> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-06T18:37:31.480

尝试使用 :after 伪选择器[http://www.w3schools.com/cssref/sel_after.asp](http://www.w3schools.com/cssref/sel_after.asp)

# ruby - 直接使用 Rack TryStatic 提供文件？

> ID：11833866
> 
> 赞同：4
> 
> 时间：2012-08-06T18:31:37.463
> 
> 标签：ruby, heroku, rack, middleman

我正在使用 Middleman 创建一个静态站点。

Middleman 将静态 html 文件生成到`./build`目录中。

这是我目前使用的配置：

```
require 'rubygems'
require 'middleman'
require 'rack/contrib/try_static'

use Rack::TryStatic, :root => "build", :urls => %w[/], :try => ['.html']

run Middleman::Application.server 
```

所以 Middleman 现在正在提供静态文件。我怎样才能`Rack::TryStatic`直接处理请求？

我试着让它像

```
run Rack::TryStatic, :root => "build", :urls => %w[/], :try => ['.html'] 
```

但它不起作用运行只接受 1 个参数。并且`Rack::TryStatic`需要 2 个参数，`app`并`options`进行初始化，而我没有任何`app`.

我怎样才能做到这一点？

（如果重要的话，我正在部署到 Heroku）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-07T05:17:17.130

正如你所注意到的，一个 Rack 中间件组件`Rack::TryStatic`需要另一个应用程序来传递请求。您可以创建一个简单的来使用它，例如刚刚返回 404 响应，例如：

```
app = lambda {|env| [404, {'Content-type' => 'text/plain'}, ['Not found']
run Rack::TryStatic.new app, :root => "build", :urls => %w[/], :try => ['.html'] 
```

或等效地：

```
use Rack::TryStatic, :root => "build", :urls => %w[/], :try => ['.html']
run lambda {|env| [404, {'Content-type' => 'text/plain'}, ['Not found']]} 
```

如果您有自己的 404 文件，则可以使用 rack-contrib[`Rack::NotFound`](https://github.com/rack/rack-contrib/blob/1.1.0/lib/rack/contrib/not_found.rb)而不是您自己的自定义端点：

```
use Rack::TryStatic, :root => "build", :urls => %w[/], :try => ['.html']
run Rack::NotFound.new('path/to/your/404.html') 
```

如果您没有使用`:try`文件扩展名数组来尝试和服务，您可以[`Rack::File`](https://github.com/rack/rack/blob/1.4.1/lib/rack/file.rb)直接使用。在内部，`Rack::TryStatic`使用[`Rack::Static`](https://github.com/rack/rack/blob/1.4.1/lib/rack/static.rb)，而后者又使用`Rack::File`. 与`TryStatic`and不同`Static`，`Rack::File`它本身就是一个 Rack 应用程序，因此不需要单独的应用程序来传递请求。那么您`config.ru`将只是：

```
run Rack::File.new './build' 
```

尽管这不允许使用相应的`.html`文件来处理“裸”请求——所有请求都需要指定整个文件名。

# c# - 在 linq-sql 中插入具有唯一索引的多个记录表时出现 SqlException

> ID：11833868
> 
> 赞同：0
> 
> 时间：2012-08-06T18:31:42.350
> 
> 标签：c#, linq-to-sql, unique-index

我有一个带有 PK 列`ItemID`和列上的唯一索引的 sql 表`Value`。

```
CREATE TABLE [dbo].[Item](
    [ItemID] [int] IDENTITY(1,1) NOT NULL,
    [Value] [int] NULL
)

CREATE UNIQUE NONCLUSTERED INDEX [IDX_Item_Value_U_NC] ON [dbo].[Item] 
(
    [Value] ASC
) 
```

我正在使用 linq-sql 在表中插入多条记录（批量插入/更新）。在插入记录之前，我会进行“存在”检查。

```
void MultipleInserts(List<int> values)
{
    using (var db = new DBDataContext())
    {
        foreach (var value in values)
        {
            var dbItem = db.Items
                    .Where(x => x.Value == value)
                    .SingleOrDefault();

            if (dbItem == null)
            {
                var Item = new Item()
                {
                    Value = value
                };
                db.Items.InsertOnSubmit(Item);
            }
        }
        db.SubmitChanges();
    }
} 
```

如果列表具有相同的值，由于唯一索引，我得到以下异常。`Item`表没有记录。

```
var values = new List<int>();
values.Add(1);
values.Add(1);
MultipleInserts(values); 
```

异常消息：

> 无法在具有唯一索引“IDX_Item_Value_U_NC”的对象“dbo.Item”中插入重复的键行。
> 该语句已终止。

我该如何避免这种情况？

编辑：我不能做单次插入，所以我不能`db.SubmitChanges()`在 for 循环内移动调用。

EDIT2：到目前为止发布的答案涉及修复数据而不是 linq-sql 中的方法。我已经举了一个带有整数列表的简单示例。但实际上我有一个要插入的对象图列表，每个项目都会命中多个表以进行插入/更新。我找到了一种使用 linq （,等）的方法，我已将其发布为答案`DataContext`。`ChangeSet``DataContext.GetChangeSet().Deletes``DataContext.GetChangeSet().Inserts`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T18:36:31.243

这里的问题是您同时插入它们。在您实际调用之前，它们都不存在`db.SubmitChanges()`

尝试移动`db.SubmitChanges()`循环内部，这应该可以解决问题。

ETA：另一种可能性是改变你的循环：

```
foreach (var value in values) 
```

至

```
foreach (var value in values.Distinct()) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T17:34:58.733

我没有修复数据，而是找到了一种使用 DataContext 的 ChangeSet 在 linq-sql 中工作的方法。示例中的数据很简单，但它可能是一个对象图，它会命中多个表并且很难修复。

我首先查看`db.Items`然后检查 DataContext 的 ChangeSet ( `db.GetChangeSet().Inserts`) 以找到该项目，如果找不到则插入。

```
void MultipleInserts(List<int> values)
{
    using (var db = new DBDataContext())
    {
        foreach (var value in values)
        {
            // look in db first
            var dbItem = db.Items
                    .Where(x => x.Value == value)
                    .SingleOrDefault();

            if (dbItem == null)
            {
                // look in ChangeSet second
                var cachedItem = db.GetChangeSet().Inserts
                    .OfType<Item>()
                    .Where(x => x.Value == value)
                    .SingleOrDefault();

                if (cachedItem == null)
                {
                    var Item = new Item()
                    {
                        Value = value
                    };
                    db.Items.InsertOnSubmit(Item);
                }
            }
        }
        db.SubmitChanges();
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-06T18:48:07.253

我不确定这是否只是您问题中的一个错字，但您的 LINQ 语句中的 Where 子句是`.Where(x => x.Value = value)`. 我想你想要这里的比较运算符，而不是赋值。尝试将您的 LINQ 语句更改为以下内容：

```
var dbItem = db.Items 
    .Where(x => x.Value == value) 
    .SingleOrDefault(); 
```

此外，如果您使用的是 .NET 3.5 或更高版本，您可以将您`List<T>`的替换为[`HashSet<T>`](http://msdn.microsoft.com/en-us/library/bb353005.aspx)以保证您只有唯一的值。

# git - 远程存储库之间的 Git 合并/推送更改

> ID：11833870
> 
> 赞同：0
> 
> 时间：2012-08-06T18:31:57.700
> 
> 标签：git, github

用户将项目分叉`https://github.com/foo/project.git`到`https://github.com/bar/project.git`并开始处理`https://github.com/bar/project.git`.

他对分叉副本所做的更改可以毫无问题地推送。

1.  用户如何将更改推`https://github.com/bar/project.git`送到`https://github.com/foo/project.git`

2.  用户如何将更改`https://github.com/foo/project.git`从`https://github.com/bar/project.git`

感谢您是否可以提供确切的步骤。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T04:31:46.030

[https://help.github.com/articles/using-pull-requests/](https://help.github.com/articles/using-pull-requests/)

该过程是使用“拉请求”。根据上面的文档，去 github.com/bar/project.git，点击“Pull Request”并更新目的地指向 github.com/foo/project.git。

拉取请求发送后，所有者可以查看并自动合并原始 repo 上的拉取请求。

# wpf - 使用带有 MVVM 的 WPF 打开一个新对话框

> ID：11833874
> 
> 赞同：2
> 
> 时间：2012-08-06T18:32:11.273
> 
> 标签：wpf, mvvm, dialog, mvvm-light, showdialog

我目前正在使用 MVVM (Light) 使用 WPF 构建应用程序。但是，在某些情况下，当用户单击按钮时，我必须打开一个新对话框（也是 WPF）。然而，这是一场硬仗。

这是我的做法：

```
 private void _ShowItemDialog(Item item)
    {
        var itemVM = new ItemViewModel();
        itemVM.CurrentItem = item ?? new Item();
        itemVM.Load();

        var itemView = new View.ItemView() { DataContext = itemVM };
        if (itemView.ShowDialog() == true)
        {
            if (item == null)
            {
                itemList.Add(itemVM.CurrentItem);
            }
        }

        itemVM.Cleanup();
    } 
```

并且 itemView XAML 没有绑定到 DataContext，否则会创建两个不同的 ViewModel 实例。

在 Window 标签内。为了在 ShowDialog 获得结果，我使用 DialogCloser 代码：

```
 public static class DialogCloser
    {
        public static readonly DependencyProperty DialogResultProperty =
            DependencyProperty.RegisterAttached(
                "DialogResult",
                typeof(bool?),
                typeof(DialogCloser),
                new PropertyMetadata(DialogResultChanged));

        private static void DialogResultChanged(DependencyObject d, DependencyPropertyChangedEventArgs e)
        {
            var window = d as Window;
            if (window != null)
                window.DialogResult = e.NewValue as bool?;
        }

        public static void SetDialogResult(Window target, bool? value)
        {
            target.SetValue(DialogResultProperty, value);
        }
    } 
```

在 ItemView 中，这是在 Window 标记内声明的，如下所示：

```
my:DialogCloser.DialogResult="{Binding DialogResult}" 
```

并且当对话框关闭时，关闭事件将 DialogResult 设置为 true 或 false。

这在第一次打开屏幕时非常有效，但在关闭后无法再次打开对话框。

我想知道您是否对打开对话框有更好的想法，以及为什么此代码不起作用。

谢谢！

**编辑：** 我已经修复了代码。我需要做的是创建一个新的 ViewModel 并将其附加到 DataContext 每次打开对话框时。此外，我必须从 XAML 中删除 DataContext 绑定。请检查上面的代码更改。

通过这些更改，我发现无法使用 ViewModelLocator 中的 ViewModel，因为它是“单例”，而不是每个新窗口中的新实例。因此，DialogResult 保留了最后一个值，如果我尝试将其值更改回 null（就像初始化 ViewModel 时一样），则会引发异常。你对为什么会发生这种情况有任何线索吗？使用 ViewModelLocator 中的 ViewModel 对我来说非常好，因为它会在整个系统中保持相同的策略。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T19:18:14.487

我通过实现静态 XxxxInteraction 类来做到这一点，这些类具有调用例如 NewUser(); 的方法；该方法打开对话框并做一些工作。在我的 ViewModel 中，我通过命令调用 XxxxInteraction 类。

这种实现方式的努力在于，您可以轻松地修改静态交互类中的方法以使用单元测试。

```
 public static class UserInteractions
    {
        public static User NewUser()
        {
            var userDialog = new NewUserDialog();
            If(userDialog.ShowDialog() != true) return null;

            var user = new User();
            user.Name = userDialog.Name;
            user.Age = userDialog.Age;
            return user;
        }
    }

    public class MyViewModel
    {
        ...

        public void NewUserCommandExecute()
        {
            var newUser = UserInteractions.NewUser();
            if(newUser == null) return;

            //Do some with new created user
        }
    } 
```

NewUserDialog 也是一个绑定到 ViewModel 的普通窗口。

我认为这是为 mvvm 模式实现对话框的好方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T05:28:38.140

我前段时间做过，我使用对话服务并在我的视图模型中调用此服务。[看看](https://stackoverflow.com/questions/3801681/good-or-bad-practise-for-dialogs-in-wpf-with-mvvm)。

编辑：顺便说一句，这就是你在视图模型中要做的所有事情

```
var result = this.uiDialogService.ShowDialog("Dialogwindow title goes here", dialogwindowVM); 
```

# vb.net - 如何分配一个字符串值，然后用引号打印字符串

> ID：11833880
> 
> 赞同：-1
> 
> 时间：2012-08-06T18:32:45.910
> 
> 标签：vb.net

我正在尝试将字符串值分配给变量，然后我想用引号打印这个分配的值，但我无法找出正确的语法。我正在尝试做的一个例子如下：

```
Dim tU As String = String.Empty
    tU = "U"
    'How to print value of tU?>>>>should be "U"
    Console.WriteLine("""tU""") 
```

我不知道如何用引号打印值“U”？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T18:36:52.413

像这样使用引号两次`""` 。

所以如果你想打印`"HELLO"`

就写`"""HELLO"""`吧：）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T18:37:12.137

试试这个：

```
Console.Writeline("""U""") 
```

或打印变量的值：

```
Console.WriteLine("""" + tU + """") 
```

# c++ - C++，计算字符串中重复的单词并显示

> ID：11833882
> 
> 赞同：3
> 
> 时间：2012-08-06T18:32:53.057
> 
> 标签：c++, arrays, string

我有字符串说“walk talk, can't won't won't woN'T talk.” 我想计算重复的单词并显示。注意：它不区分大小写。

我用过分隔符

```
strtok(string, ",.;:\"!? -_\n\t*()@#=+"); 
```

并将其保存在

```
char *temp[100]; 
```

现在我如何检查单词的重复？并显示如下

```
3 won't
2 talk
1 can't
1 walk 
```

它应该从最高重复显示到最低。如果重复相同，则显示字母顺序。

对不起，我的英语不好。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T18:48:31.863

使用 std::string 来保存`strtok()`. 然后创建一个`std::map<string, int>`来保存字符串（键）发生的次数。

您可以使用以下内容填充地图：

```
std::map<string, int> myMap;
myMap[tokenizedWord]++; //Increase count of word. 
```

然后，您可以循环浏览地图内容并打印出整数值大于 2 的任何位置。

```
for (std::map<string, int>::iterator iter = myMap.begin(); iter != myMap.end(); ++iter)
{
    if (iter->second > 1)
        std::cout << "Duplicated word: " << iter->first << " count = " << iter->second;
} 
```

我会让你弄清楚如何按顺序遍历它。您可以将值放在向量或其他东西中，并`std::sort`在打印或其他任何您喜欢的东西之前使用。不幸的是，地图是关联容器，您无法对它们进行排序，因为它破坏了它们的内部排序。

**std::map 上的背景信息**

映射是一个关联数组，这意味着每个键都映射到一个特定的值，并且键是唯一的。您实际上可以创建一个键不唯一的多重映射，这就是为什么这很重要。

基本上，由于键是唯一的，因此您只需将键用作数组索引即可访问或创建元素。

**例如：**

```
//Create a map and insert a couple things into it - prices of meat?
std::map<string, float> myMap;
myMap["Chicken"] = 4.99;
myMap["Turkey"] = 6.99;

//Retrieve the price of something using the key.
std::cout << "Chicken costs " << myMap["Chicken"] << std::end; 
```

你也可以在地图上进行标准的插入和定位操作，但是关联数组的语法更简单，为什么还要麻烦呢？:)

**PS：**为了完全回答您的评论，以防万一，myMap[tokenizedWord]++ 末尾的 ++ 只是说将存储的该键的整数值的值增加 1。您也可以这样做 myMap [tokenizedWord] = myMap[tokenizedWord] + 1 或者你也可以做 myMap[tokenizedWord] += 1。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T21:00:53.277

您的问题的完整实现（如果您需要用于排序的示例代码，请告诉我）：

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <errno.h>

#define ARRAY_ELEMS_COUNT(A)    sizeof(A)/sizeof(*A)

typedef struct _word_t
{
        char    *word;
        int     occurr_count;
        struct _word_t  *next;
} word_t;

typedef struct _word_list_t
{
        struct  _word_t *head;
        struct  _word_t *tail;
        int     elems_count;
} word_list_t;

/* Creation of the words list */
word_list_t *make_list(void)
{
        word_list_t *w_list = (word_list_t *)malloc(sizeof (struct _word_list_t));
        if (w_list == NULL)
        {
                fprintf(stderr, "malloc faild --> %s\n", strerror(errno));

                return NULL;
        }
        w_list->head = w_list->tail = NULL;
        w_list->elems_count = 0;

        return w_list;
}

int list_word_lookup(word_list_t *w_list, char *word)
{
        word_t *temp_word = w_list->head;
        while(temp_word)
        {
                if (strcmp(temp_word->word, word) == 0)
                {
                        /* We got it before, increment the count */
                        temp_word->occurr_count++;

                        return 1;
                }
                else
                {
                        temp_word = temp_word->next;
                }
        }

        return 0;
}

/* Adding new words to the list of words if they are not present, otherwise increment their occurrence count */
/* TODO : Sort the list using Merge sort for performance */
int adding_to_list(word_list_t *w_list, char *word)
{
        int     return_status = 0;
        char    *tmp_word = (char *)malloc(sizeof(char)*(strlen(word) + 1));
        word_t  *new_word = (word_t *)malloc(sizeof(struct _word_t));
        /* Empty list */
        if (w_list->head == NULL)
        {
                strcpy(tmp_word, word);
                new_word->word = tmp_word;
                new_word->occurr_count = 1;
                w_list->head = w_list->tail = new_word;
                w_list->head->next = NULL;
                w_list->elems_count++;
        }
        else
        {
                /* The list is not empty */
                /* Checking if the word exist in the list */
                return_status = list_word_lookup(w_list, word);
                if (return_status == 1)
                {
                        fprintf(stdout, "WE got this word before --> increment count\n");
                }
                else
                {
                        strcpy(tmp_word, word);
                        new_word->word = tmp_word;
                        new_word->occurr_count = 1;
                        w_list->tail->next = new_word;
                        w_list->tail = new_word;
                        w_list->tail->next = NULL;
                }
        }

        return 0;
}

void words_list_dump(word_list_t *w_list)
{
        word_t *temp;

        for (temp = w_list->head; temp; temp = temp->next) {
                fprintf(stdout, "Word : %s -- Count = %d\n", temp->word, temp->occurr_count);
        }
}

/* Destroying all words */
void free_words(word_list_t *w_list)
{
        word_t *temp;

        for (temp = w_list->head; temp; temp = temp->next) {
                /* Freeing the word string */
                free(temp->word);
                /* Freeing the word */
                free(temp);
        }
        w_list->head = NULL;
        w_list->tail = NULL;
}

/* Destroying the words list */
void free_words_list(word_list_t *w_list)
{
        if (!w_list)
        {
                return;
        }
        free_words(w_list);
        free(w_list);
}

/* TODO : create a function that converts your input text to a char ** array, so you can pass it to adding_to_list */
/* For testing */
int main(int argc, char **argv)
{
        const char *string[] = {"Hello", "World", "Stackoverflow", "C", "Hello", "C", "WORDS", "words", "List", "list", "Hello", "World", "Count"};
        word_list_t *my_list = make_list();
        int i;

        for (i = 0; i < ARRAY_ELEMS_COUNT(string); i++)
                adding_to_list(my_list, string[i]);
        words_list_dump(my_list);
        free_words_list(my_list);

        return 0;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-08-11T13:44:01.207

这是使用`strtok`但不使用的答案`std::map`。在一次字符串中，每个单词都会与之前的单词进行检查并计算重复次数。

```
#include <iostream>
using std::cin;
using std::cout;
using std::endl;

#include <string>
using std::string;

#include <vector>
using std::vector;

#include <cstring>

using std::tolower;

int main()
{
    char *strin;
    string inputstr;
    vector<string> svec;
    vector<int> cvec;
    char *pch;
    int unique_word_count=0;
    while(getline(cin,inputstr))
    {
        //token-ize the string
        //First string
        strin = &inputstr[0];
        pch = std::strtok(strin," ,-");
        bool unique_word_found = true;
        //subsequent words
        while (pch != NULL)
        {
            string word(pch);
            for(string::size_type i=0; i < word.size(); i++)
                word[i]=tolower(word[i]);
            //first word
            //just add to svec and no comparisons
            if(unique_word_count==0)
            {
                svec.push_back(word);
                cvec.push_back(1);
                cvec[unique_word_count++]=1; //init count of first word
                //next word
                pch = std::strtok(NULL, " ,-");
                unique_word_found = true; //reset flag
                continue;
            }

            //start comparing with other words currently in string vector
            //do not do this if only 1 word present
            vector<string>::iterator iter=svec.begin();
            while(iter < svec.end())
            {
                if(word == *iter)
                {
                    //match found
                    cvec[iter-svec.begin()]++; //increment count of that word
                    unique_word_found = false;
                }
                iter++;
            }
            if(unique_word_found)
            {
                //add to unique word list and increment count
                svec.push_back(word);
                cvec.push_back(1);
                cvec[unique_word_count++]=1;
            }

            //next word
            pch = std::strtok(NULL, " ,-");
            unique_word_found = true; //reset flag
        }
    }

    cout << "Word" << " ---> " << "Occurences" << endl;
    for(vector<string>::size_type i=0; i < svec.size(); i++)
    {
        cout << svec[i] << "  --->  " << cvec[i] << endl;
    }
    return 0;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-08-11T14:12:45.650

一般策略可以如下：

*   清理输入（将所有字符转换为小写，删除不需要的标点符号等）
*   遍历输入
*   将每个字符添加到字符串中，在遇到空格时完成
*   将字符串添加到键值结构中。字符串是关键。如果这是一个尚未包含在结构中的新条目，则将值设置为 1。否则将其设置为当前值 + 1（以便计算到目前为止遇到的次数）。
*   对每个单词重复
*   遍历键值结构并打印每个条目。

# c++ - 编译器忽略 __stdcall

> ID：11833893
> 
> 赞同：3
> 
> 时间：2012-08-06T18:34:32.337
> 
> 标签：c++, visual-c++, calling-convention

在我看来，MSVS 忽略了我函数上的 __stdcall 指令。我正在手动清理堆栈，但编译器仍然`ADD ESP`在每个`CALL`.

这就是我声明函数的方式：

```
extern "C" void * __stdcall core_call(int addr, ...);
#define function(...) (DWORD WINAPI) core_call(12345, __VA_ARGS__)
return function("Hello", 789); 
```

这就是输出的样子：（ [来源：][[server4u.cz](http://vs712.server4u.cz/msvs.png)][）][![在此处输入图像描述](../Images/2b0137d88b0cec7d5b8caf726095b149.png)](https://i.stack.imgur.com/l5nX0.png)

我用箭头标记了冗余`ADD`指令，MSVS 在每次调用后自动附加，尽管事实上，清理堆栈是被调用者的责任（参考：[http](http://en.wikipedia.org/wiki/X86_calling_conventions#List_of_x86_calling_conventions) ://en.wikipedia.org/wiki/X86_calling_conventions#List_of_x86_calling_conventions ）和这个导致我的程序崩溃。如果我用 手动替换`ADD`说明`NOPs`，程序将按预期工作。所以，我的问题是......有没有办法强制编译器停止添加这些指令？

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-06T19:10:10.400

问题出在这里：`, ...)`。

具有可变数量参数的函数不能是`__stdcall`.

`__stdcall`函数必须在最后从堆栈中删除所有堆栈参数，但它们无法提前知道它们将接收多少作为参数的东西。

函数也是如此`__fastcall`。

对于具有可变数量参数的函数，唯一适用的调用约定是`__cdecl`，调用者必须在调用后删除堆栈参数。尽管您要求使用`__stdcall`.

# c++ - 将 Lua for Windows 安装程序嵌入 C++ 程序时遇到问题

> ID：11833898
> 
> 赞同：3
> 
> 时间：2012-08-06T18:34:54.413
> 
> 标签：c++, windows, lua

这是我发现自己无法深入使用正常的谷歌搜索/堆栈溢出/youtube 例程的第一个问题。

我正在尝试在 C++ 环境中编译一个最小的 Lua 程序，以确保我的环境已准备好进行开发。Lua 语言稍后将用于我的 C++ 游戏的用户界面编程。

# 首先是关于我的环境的一些基本信息：

Windows 7 64 位

视觉工作室 2010

Lua for Windows 5.1（我可以从谷歌代码下载的最新版本）

# 这是我要编译的代码：

```
// UserInt.cpp : Defines the entry point for the console application.
//
#pragma comment(lib,"lua5.1.dll")
#include "stdafx.h"
#ifndef __LUA_INC_H__
#define __LUA_INC_H__

extern "C"
{
   #include "lua.h"
   #include "lauxlib.h"
   #include "lualib.h"
}

int _tmain(int argc, _TCHAR* argv[])
{
    lua_State * ls = luaL_newstate();
    return 0;
}

#endif // __LUA_INC_H__ 
```

# 这是我得到的错误：

`1>UserInt.obj : error LNK2019: unresolved external symbol _luaL_newstate referenced in function _wmain 1>c:\users\deank\documents\visual studio 2010\Projects\UserInt\Debug\UserInt.exe : fatal error LNK1120: 1 unresolved externals`

# 我尝试过的事情：

我已经阅读了关于不再使用 lua_open()（和其他几个函数）的信息，所以我尝试了 newstate 函数。我犯了同样的错误。这更像是一次理智检查。我使用的是 5.1 而不是 5.2，所以我认为这并不重要。

我还阅读了此线程[无法链接最小的 Lua 程序](https://stackoverflow.com/questions/4150081/cannot-link-a-minimal-lua-program)，但它似乎对我没有帮助，因为我运行的环境与该 OP 不同。我在一个简单的 Windows 7 和 Visual Studio 环境中。

最上面的 pragma 注释行是我在另一个线程中看到的。无论有没有它，我都会遇到同样的错误。

我进入了我的 Visual Studio C++ 目录区域，并将 lua 包含添加到了包含中，并将 lua 库添加到了库中。

所以看起来我的程序正在看到 .h 并看到符号。但由于某种原因，它没有获得函数的 .cpp 实现。这就是为什么我希望直接包含该 .dll 有助于解决问题，但事实并非如此。

所以，我觉得我已经用尽了我自己解决这个问题的所有选择。我希望有人能够帮助我在这里前进。Lua 看起来像是一种很棒的脚本语言，我想让我的环境适应开发。

我希望这只是我的一些愚蠢的错误。我相信我已经提供了尽可能多的信息。如果您需要更多详细信息，我会在可以提供的情况下更新信息。

# 编辑1

尝试了这个[Can't build lua a project with lua in VS2010 中的解决方案，怀疑是库问题](https://stackoverflow.com/questions/6903698/cant-build-lua-a-project-with-lua-in-vs2010-library-issue-suspected?rq=1)

那也没有用。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-06T21:08:14.673

您需要拥有库 (.LIB) 文件并将其添加到 VS。使用 Project > Properties 并转到 Linker > Input 并将完整的 .lib 文件名添加到“Additional Dependencies”行。请注意，.LIB 与 .DLL 不同。

就个人而言，我更喜欢将源代码添加到我的项目中，而不是引用动态链接库。以下过程将让您这样做。

1.  下载源代码（[http://www.lua.org/ftp/](http://www.lua.org/ftp/)），解压。

2.  在 Visual Studio 中，选择文件 > 新建 > 项目，然后选择 Visual C++、Win32、“Win32 控制台应用程序”。

3.  在 Visual Studio 的项目中，添加除 luac.c 之外的所有源代码。还要从 VS 为您创建的文件中删除 main() 函数。这通常以您指定的项目名称命名，文件扩展名为 .cpp。您可以从项目中完全删除此文件。

4.  构建并运行。

这是 Lua 控制台

# winapi - 没有在偏移量 0 处映射 Win32 便携式可执行文件的可能原因是什么？

> ID：11833899
> 
> 赞同：3
> 
> 时间：2012-08-06T18:34:57.693
> 
> 标签：winapi, mapping, executable, portability, offset

我最近一直在研究 Window 的 PE 格式，我注意到在大多数示例中，人们倾向于将`ImageBase`偏移值设置`optional header`为不合理的高值，例如`0x400000`.

什么会使**不**将图像映射到 offset不利`0x0`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T19:44:29.633

首先，这不是 Windows 或 PE 文件格式的默认设置，它是链接器的 /BASE 选项在您使用它链接 EXE 时的默认设置。DLL 的默认值为 0x10000000。

选择 /BASE:0 将是一个糟糕的选择，没有程序可以在该基地址上运行。地址空间的前 64 KB 被保留，永远不能被映射。主要是为了捕获空指针取消引用错误。并扩展到 64KB 以捕获以 16 位开始并重新编译为 32 位的程序中的指针错误。

为什么 0x40000 而不是 0x10000 是默认值也是一个历史事故，至少可以追溯到 Windows 95。它为“16 位/MS-DOS 兼容性竞技场”保留了前 4 兆字节的地址空间。我不太记得了，Windows 9x 的 16 位 VM 实现与 NT 非常不同。您可以在这篇古老的[知识库文章](http://support.microsoft.com/kb/125691)中阅读更多相关信息。现在它肯定不再重要了，64 位操作系统很容易在 0x010000 和 0x400000 之间的空间中分配堆内存。

更改 EXE 的 /BASE 选项没有任何意义。但是，为 DLL 更改它有*很多意义。*如果它们不重叠，则它们会更有效，因此不必重新定位，它们不会占用页面文件中的任何空间并且可以在进程之间共享。甚至还有一个 SDK 工具，所以你可以在构建后更改它，rebase.exe

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-09T08:43:41.937

实际上，将 /BASE 设置为 0 的影响取决于图像的[地址空间布局随机化 (ASLR)](http://en.wikipedia.org/wiki/Address_space_layout_randomization)设置（也由链接器放置 - [/DYNAMICBASE:NO](http://msdn.microsoft.com/en-us/library/bb384887%28v=vs.90%29.aspx)）。

如果您的图像有 /BASE:0 并且 ASLR 处于打开状态 (/DYNAMICBASE:YES)，那么您的图像将启动并运行，因为加载程序会自动将其加载到“有效”地址。

如果您的图像具有 /BASE:0 并且 ASLR 已关闭 (/DYNAMICBASE:NO)，那么您的图像将不会启动，因为加载程序不会将其加载到所需的基地址（如上所述，这是无效/保留的）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-06T18:43:09.950

如果将其映射到地址 0，则这意味着代码期望从地址 0 开始运行。

对于操作系统，地址零是`NULL`，这是一个无效地址。
（不是“从根本上”，但对于现代操作系统来说，它是。）

此外，出于多种原因，一般而言，您不希望在较低的 16 MiB 内存（甚至是虚拟内存）中存在任何内容。

但是有什么选择呢？它必须被映射*到某个地方*，所以他们选择了`0x400000`......可能没有特别的理由来指定那个特定的地址。它可能只是方便。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-06T18:54:17.147

Microsoft 选择该地址作为链接器指定的默认起始地址，PE 文件将在该地址进行内存映射。链接器假定该地址，并且可以使用该假定优化可执行文件。当文件在该地址被内存映射时，代码可以在不需要修改任何内部偏移量的情况下运行。

如果由于某种原因无法将文件加载到该位置（另一个 exe/dll 已加载到该位置），则需要在可执行文件运行之前进行重定位，这将增加加载时间。

较低的内存地址通常被假定为包含低级系统例程，并且通常被单独保留。ImageBase 地址唯一真正的要求是它是 0x10000 的倍数。

推荐阅读：

*   [http://msdn.microsoft.com/en-us/library/ms809762.aspx](http://msdn.microsoft.com/en-us/library/ms809762.aspx)

# salesforce - 在 iOS 应用程序的 Salesforce 登录屏幕中硬编码用户名、密码

> ID：11833900
> 
> 赞同：0
> 
> 时间：2012-08-06T18:35:00.770
> 
> 标签：salesforce

如何在 Salesforce 登录屏幕中硬编码用户名和密码以在 iOS 应用程序中绕过它。我正在使用 salesforce 的 database.com 来存储一些数据，这些数据将由不同的用户使用他们的移动应用程序访问。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T02:33:32.903

这真是个坏主意，密码可能会定期更改一件事，并且每个用户也应该拥有不同的 Salesforce 凭据。

您最好的选择是使用 oAuth，用户仍然需要偶尔登录（包括他们第一次使用该应用程序时），但之后它将在后台进行登录。

# c++ - 如何处理 C++ 中的“无法实例化抽象类”错误？

> ID：11833905
> 
> 赞同：34
> 
> 时间：2012-08-06T18:35:43.247
> 
> 标签：c++, abstract-class

如何处理 C++ 中的“无法实例化抽象类”错误？我在这里查看了一些类似的错误，但它们似乎都不是我遇到的完全相同或问题。但是，话又说回来，我承认有几个要过去。这是编译错误：

![[IMG]http://i67.photobucket.com/albums/h292/Athono/cannotinstantiateabstractclass.png[/IMG]](../Images/10926b5894b688c05877e6b9a1da7f42.png)

这将我带到此页面： http: [//msdn.microsoft.com/query/dev10.query](http://msdn.microsoft.com/query/dev10.query?appId=Dev10IDEF1&l=EN-US&k=k(C2259);k(VS.ERRORLIST)&rd=true) ?appId=Dev10IDEF1&l=EN-US&k=k(C2259);k(VS.ERRORLIST)&rd=true 编译错误 C2259 来自一个 C++ 程序，但页面将抽象类称为“接口”：

> 每当您从接口派生并在派生类中以公共以外的访问权限实现接口方法时，您可能会收到 C2259。发生这种情况是因为编译器希望派生类中实现的接口方法具有公共访问权限。当您为具有更严格访问权限的接口实现成员函数时，编译器不会将它们视为接口中定义的接口方法的实现，从而使派生类成为抽象类。
> 
> 该问题有两种可能的解决方法：
> 
> 为实现的方法公开访问权限。
> 
> 对派生类中实现的接口方法使用范围解析运算符，以用接口名称限定实现的方法名称。

坏消息是我已经在类中公开了所有方法：

```
class AmbientOccluder: public Light {
    public:

        AmbientOccluder(void); 
```

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2012-08-06T18:36:43.553

该错误意味着该类的某些方法未实现。**您无法实例化这样的类，因此除了实现该类的所有**方法之外，您无能为力。

另一方面，一种常见的模式是实例化一个具体类并将其分配给抽象基类的指针：

```
class Abstract { /* stuff */ 4};
class Derived : virtual public Abstract { /* implement Abstract's methods */ };

Abstract* pAbs = new Derived; // OK 
```

顺便说一句，为避免上述行的内存管理问题，您可以考虑使用[智能指针](http://en.wikipedia.org/wiki/Smart_pointer)，例如`std::unique_ptr`：

```
std::unique_ptr<Abstract> pAbs(new Derived); 
```

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2013-06-26T02:14:52.860

Visual Studio 的*错误列表*窗格只显示错误的第一行。调用`View`>`Output`我敢打赌你会看到类似的东西：

```
c:\path\to\your\code.cpp(42): error C2259: 'AmbientOccluder' : cannot instantiate abstract class
          due to following members:
          'ULONG MysteryUnimplementedMethod(void)' : is abstract
          c:\path\to\some\include.h(8) : see declaration of 'MysteryUnimplementedMethod' 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2012-08-06T18:39:05.550

抽象类不能按定义实例化。为了使用这个类，你必须创建一个具体的子类来实现该类的所有虚函数。在这种情况下，您很可能没有实现`Light`. 这意味着`AmbientOccluder`默认为抽象类。为了让我们进一步帮助您，您应该包括`Light`课程的详细信息。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-08-06T18:39:28.640

为类拥有的任何纯虚函数提供实现。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-10-16T13:16:01.647

为什么我们不能创建抽象类的对象？当我们在抽象类中创建一个纯虚函数时，我们在 VTABLE 中为函数保留了一个槽（在上一个主题中研究过），但没有在该槽中放置任何地址。因此 VTABLE 将是不完整的。由于抽象类的 VTABLE 不完整，因此编译器不会允许为此类创建对象，并且在您尝试这样做时会显示错误消息。

纯虚拟定义

纯虚函数可以在抽象类中给出一个小的定义，您希望所有派生类都具有该定义。你仍然不能创建抽象类的对象。此外，纯虚函数必须在类定义之外定义。如果你在类定义中定义它，编译器会报错。内联纯虚定义是非法的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-01-07T06:40:09.797

我在这里回答了这个问题。[协变虚函数返回类型问题](https://stackoverflow.com/questions/5076226/covariant-virtual-functions-return-type-problem/27813060#27813060)

看看它是否对某人有帮助。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-11-28T23:59:31.910

如果有人从函数中收到此错误，请尝试在参数中使用对抽象类的引用。

```
void something(Abstract bruh){
} 
```

至

```
void something(Abstract& bruh){
} 
```

不能构造一个抽象类，即使是从一个子类。抽象类基本上是其他类的模板，它们本身没有构造函数。这是实现涉及继承的接口的另一种方式。

网上有很多关于多态的东西，而且都是愚蠢的。C++ 使您可以同时从多个类继承，因此抽象类和接口在那里是相同的。我认为抽象类存在的原因是因为某些语言，如 Java，只能从一个类继承/扩展。

抽象类实际上是一个抽象概念。他们是班级的家长，但仅限于我们的脑海中。它们是对没有正确答案的问题的答案。比如，“GTA 的前身是什么？” 你会说，“嗯，有 Race n'Chase”，但这甚至不是一个正确的答案，因为它们是同一个游戏，只是名称改变了。抽象类是“该类的父类是什么”的答案？就像你可以说“哦，字符串只是一个字符数组”和“一个字符数组只是几个迭代器”和“迭代器只是指针”。抽象类允许我们将这些愚蠢的答案形式化为继承。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-12-28T07:49:52.267

就我而言，我在 COM 控制`.idl`文件中声明了一个函数，例如

```
[id(1)] HRESULT MyMethod([in]INT param); 
```

但没有`.h`像这样在我的接口文件中声明

```
STDMETHOD(MyMethod)(INT param); 
```

通过将以上行添加到我的界面 .h 文件中解决了问题

这可能会帮助一些人。

# javascript - Javascript 中的 Youtube 机器人

> ID：11833906
> 
> 赞同：-3
> 
> 时间：2012-08-06T18:35:45.083
> 
> 标签：javascript

好的，所以我有一些 Javascript 代码，但问题是，我不知道它是否有效。Javascript代码应该：

*   从每个标题中删除“.mp4”扩展名
*   更改我的视频类别
*   在所有视频中添加相同的描述
*   在所有视频中放置相同的关键字

因此，该 Javascript 代码应该在 Youtube 上传页面上运行。您登录，选择要上传的视频，然后进入您的上传页面。那么，有人可以为我测试这个脚本吗（我不熟悉测试脚本）？

代码 ：

```
var i = prompt("How many videos have you got?", "");
function remove_mp4()
{
   titleElems=document.getElementsByName("title");
   for(i=0;i<titleElems.length;i++)
   {
       titleInner=titleElems[i].innerHTML;
       titleElems[i].innerHTML=titleInner.replace(titleInner.match(".mp4"), "");
   }
}
for (var x = 0; x < i; i++)
{
    document.getElementsByName("description")[x].value = "Visit me on my web-site :\
    \
                                                          http://www.sample.com/";
     document.getElementsByName("keywords")[x].value = prompt("Enter your keywords : ","");
    catChildNodes=document.getElementsByName("category")[x].childNodes;
    catChildNotes[x + 1].removeAttribute("selected");
    for(y=0;y<catChildNodes.length;y++)
    {
       if(catChildNodes[y].value="27") 
       {
          catChildNodes[y].setAttribute("selected",""); 
       }
   }
}
remove_mp4(); 
```

另外，我注意到一件事，那就是我来自“//”这些 //www.sample.com/ 的 URL 被视为注释（在 Notepad++ 中它是绿色的）。

那么，有人可以修复评论错误并测试脚本以查看它是否有效（在 Youtube 上传页面上）？

提前致谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-06T18:40:32.570

你的线

```
document.getElementsByName("description")[x].value = "Visit me on my web-site :

                                                          http://www.sample.com/"; 
```

不是 JavaScript 中的有效字符串。

# javascript - 带有 CellEditing 的 ExtJs 4 GridPanel：输入的数据在验证失败时丢失

> ID：11833909
> 
> 赞同：5
> 
> 时间：2012-08-06T18:36:20.900
> 
> 标签：javascript, validation, extjs4, editing, gridpanel

我正在使用带有 CellEditing 插件的 ExtJs Grid。它工作得很好，只是当我对其施加的验证失败时无效值会丢失。

例如，如果我在网格中有一个不允许超过 10 个字符的值的可编辑文本字段，并且用户输入“ *olympicssucks* ”，则验证将失败，并且文本字段周围会出现一个红色框。当用户点击字段外的值“ *olympicssucks* ”将丢失。

我希望网格*仍然保存*无效数据，并在其周围保留红色框。

另一个（可能更清楚）示例： [http](http://dev.sencha.com/deploy/ext-4.0.0/examples/grid/cell-editing.html) ://dev.sencha.com/deploy/ext-4.0.0/examples/grid/cell-editing.html 尝试编辑第一个单元格值：“ *Adder's-Tongue* ”并将其设为空. 注意红色框和验证消息。现在点击开箱即用。验证失败会将***单元格恢复为其原始值***Adder's *-Tongue*。

* * *

***tl;博士：***我的问题，重申，是***我想保留无效值，但仍然有验证显示它周围的红色框***。我确信它是可能的，但它是如何完成的？

我试过的：

1.  我研究了**Ext.Editor**，它看起来很有希望，因为它有一个名为**revertInvalid**的配置属性，它*完全*符合我的要求。不幸的是，似乎**CellEditing**插件似乎没有使用**Ext.Editor**。我尝试在网格列的**编辑器字段中提供****Ext.Editor**，但这会产生不可编辑的文本。
***   我已经尝试将**revertInvalid**放置在任何我能做的地方，但这总是很遥远。**

 *** * *

代码：

```
 var cellEditing = Ext.create('Ext.grid.plugin.CellEditing', {
        clicksToEdit: 1
    });

    var grid = {
            xtype: 'grid', store: dataStore, plugins: [cellEditing],
            columns: [
                {
                    text: 'Items', dataIndex: 'items', flex: 1, sortable : false,
                    editor: {
                        xtype: 'textfield',
                        validator: function(value) { //custom validator to return false when value is empty and other conditions}
                },
                //...
           ],
           tbar: [{
                xtype: 'button', text: 'Add ' + type,  
                handler: function() {
                    dataStore.insert(0, {items: 'New ' + type});
                    cellEditing.startEditByPosition({row: 0, column: 0});                           
                }
           }]
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-14T14:15:12.233

这对我有用（Extjs 4.2）：

```
Ext.override(Ext.Editor, { revertInvalid: false }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-04T12:06:07.187

见[http://www.sencha.com/forum/showthread.php?271318-Ext.Editor-revertInvalid-false-what-is-the-expected-behavior&p=994118#post994118](http://www.sencha.com/forum/showthread.php?271318-Ext.Editor-revertInvalid-false-what-is-the-expected-behavior&p=994118#post994118)

对我来说，这是 ExtJs 中的一个错误，您可以通过覆盖 Ext.editor 的 completeEdit 函数来修复它

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-28T13:06:04.050

很可能 Sencha 还没有完全开发***revertInvalid***字段，而且它的简单功能还不能工作。对于那些寻找解决方法的人，您可能不得不弄乱网格单元本身的 CSS 以将其自定义标记为无效。**

# linq - Sharepoint 2010 listitem 到 linq 2 sharepoint spmetal 类

> ID：11833910
> 
> 赞同：0
> 
> 时间：2012-08-06T18:36:23.387
> 
> 标签：linq, sharepoint-2010, splistitem

如何将 ListItem 包装/转换/转换为生成的 spmetal 类？（linq 2 共享点）

谢谢！

更新：

我正在寻找这些，因为事件接收器使用 splistitems，我想在访问数据时使用强类型版本并且没有 magiv 字符串

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T19:45:13.357

您是否有理由使用 ListItem 而不是使用 LINQ to SharePoint 来获取您的 spmetal 类？

据我所知，没有内置方法，但您可以使用 automapper 之类的工具来执行此操作。

```
Mapper.CreateMap<SPListItem, HandbookCodesHandbookCode>()
            .ForMember(dest => dest.Id, opt => opt.MapFrom(src => src.ID))
            .ForMember(dest => dest.CodeDescription, opt => opt.MapFrom(src => src["CodeDescription"]));
        SPWeb web = SPContext.Current.Site.RootWeb;
        SPList list = web.Lists["HandbookCodes"];

        SPListItem item = list.GetItemById(1);

        HandbookCodesHandbookCode hc = Mapper.Map<SPListItem, HandbookCodesHandbookCode>(item); 
```

另一种方法是使用 LINQ to SharePoint 并创建一个查询来获得类似

```
HandbookTeamSiteDataContext ctx = new HandbookTeamSiteDataContext(SPContext.Current.Site.RootWeb.Url);

        var hb = from h in ctx.HandbookCodes
                 where h.Id == 1
                 select h; 
```

除非给您一个 SPListItem（事件接收器和工作流），否则我会尝试使用它而不是获取一个 SPListItem（除非您有一个复杂的查询，然后性能不佳）

# google-maps-api-3 - 谷歌地图覆盖信息窗口 Div

> ID：11833911
> 
> 赞同：0
> 
> 时间：2012-08-06T18:36:28.250
> 
> 标签：google-maps-api-3

我希望有人能指出我正确的方向。我有一个带有融合表的谷歌地图 v3，我正在寻找一个自定义框，其中包含通常显示在信息窗口中的内容。

很像[http://www.instaearth.me](http://www.instaearth.me)或 [http://chrismcaleenan.com/map/?page_id=7](http://chrismcaleenan.com/map/?page_id=7)

因此，用户单击标记并将内容加载到未附加到标记本身的框/窗口/div 中。

有谁知道有人展示这样做的任何示例/教程。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T19:42:45.123

FusionTablesLayer 有一个[FusionTablesMouseEvent](https://developers.google.com/maps/documentation/javascript/reference#FusionTablesMouseEvent)，它在单击时返回（如果您将单击事件侦听器添加到 FusionTablesLayer）。该对象包含与该地理对象（图标、折线或多边形）关联的行中的数据，您可以使用它来填充页面上的 HTML div。

[工作示例](http://www.geocodezip.com/v3_GoogleEx_layer-kml_world_countries.html)，放大过去的缩放级别 2 以查看 FusionTable 代码的工作，在缩放 0、1 时它使用 KmlLayer

# haskell - 在 Haskell 中定义数据结构的建议

> ID：11833920
> 
> 赞同：17
> 
> 时间：2012-08-06T18:36:48.343
> 
> 标签：haskell

我无法在 Haskell 中建模数据结构。假设我正在经营一家动物研究机构，我想跟踪我的老鼠。我想跟踪老鼠被分配到笼子和实验中的情况。我还想记录我的老鼠的重量，我的笼子的体积，并记录我的实验。

在 SQL 中，我可能会这样做：

```
create table cages (id integer primary key, volume double);
create table experiments (id integer primary key, notes text)
create table rats (
    weight double,
    cage_id integer references cages (id),
    experiment_id integer references experiments (id)
); 
```

（我意识到这允许我将来自不同实验的两只老鼠分配到同一个笼子里。这是有意的。我实际上并没有经营动物研究机构。）

两个必须可能的操作：（1）给定一只老鼠，找出它笼子的体积；（2）给定一只老鼠，得到它所属实验的笔记。

在 SQL 中，那些将是

```
select cages.volume from rats
  inner join cages on cages.id = rats.cage_id
  where rats.id = ...; -- (1)
select experiments.notes from rats
  inner join experiments on experiments.id = rats.experiment_id
  where rats.id = ...; -- (2) 
```

我如何在 Haskell 中建模这个数据结构？

* * *

一种方法是

```
type Weight = Double
type Volume = Double

data Rat = Rat Cage Experiment Weight
data Cage = Cage Volume
data Experiment = Experiment String

data ResearchFacility = ResearchFacility [Rat]

ratCageVolume :: Rat -> Volume
ratCageVolume (Rat (Cage volume) _ _) = volume

ratExperimentNotes :: Rat -> String
ratExperimentNotes (Rat _ (Experiment notes) _) = notes 
```

但是这个结构不会引入一堆`Cage`s 和`Experiment`s 的副本吗？还是我不应该担心它并希望优化器能解决这个问题？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-08-06T20:20:39.073

这是我用于测试的一个短文件：

```
type Weight = Double
type Volume = Double

data Rat = Rat Cage Experiment Weight deriving (Eq, Ord, Show, Read)
data Cage = Cage Volume               deriving (Eq, Ord, Show, Read)
data Experiment = Experiment String   deriving (Eq, Ord, Show, Read)

volume     = 30
name       = "foo"
weight     = 15
cage       = Cage volume
experiment = Experiment name
rat        = Rat cage experiment weight 
```

然后我启动了 ghci 和 import `System.Vacuum.Cairo`，可以从令人愉快的[`vacuum-cairo`](http://hackage.haskell.org/package/vacuum-cairo)包中获得。

```
*Main System.Vacuum.Cairo> view (rat, Rat (Cage 30) (Experiment "foo") 15) 
```

![不共享](../Images/e00764edc5bcda0cd421a561f4d55b36.png)

```
*Main System.Vacuum.Cairo> view (rat, Rat (Cage 30) experiment 15) 
```

![共享实验](../Images/fb72216a9a6858dc7613312a7ae0b5c3.png)

（我不太确定为什么这个箭头是双箭头，但你可以忽略/折叠它们。）

```
*Main System.Vacuum.Cairo> view (rat, Rat cage experiment weight) 
```

![共享参数](../Images/10967e94f30509e58ea69cfe733e1f34.png)

```
*Main System.Vacuum.Cairo> view (rat, rat) 
```

![共享所有](../Images/b027336e621af265e2d07ce396c16c63.png)

```
*Main System.Vacuum.Cairo> view (rat, Rat cage experiment (weight+1)) 
```

![共享修改](../Images/68e90cb4d38282a291827432dd1f8611.png)

如上所示，经验法则是，当您调用构造函数时，会准确地创建新对象。否则，如果您只是命名一个已经创建的对象，则不会创建新对象。在 Haskell 中这样做是安全的，因为它是一种不可变的语言。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-06T18:59:02.263

模型的更自然的 Haskell 表示是让笼子包含实际的老鼠对象而不是它们的 id：

```
data Rat = Rat RatId Weight
data Cage = Cage [Rat] Volume
data Experiment = Experiment [Rat] String 
```

然后，您将`ResearchFacility`使用智能构造函数创建对象，以确保它们遵循规则。它看起来像：

```
research_facility :: [Rat] -> Map Rat Cage -> Map Rat Experiment -> ResearchFacility
research_facility rats cage_assign experiment_assign = ... 
```

其中`cage_assign`and是包含与 sql 中的和外键`experiment_assign`相同信息的映射。`cage_id``experiment_id`

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-08-06T23:59:38.087

第一个观察：你应该学会使用记录。Haskell 中的记录字段名称被视为函数，因此这些定义至少会让您输入更少：

```
data Rat = Rat { getCage       :: Cage
               , getExperiment :: Experiment
               , getWeight     :: Weight }

data Cage = Cage { getVolume :: Volume }

-- Now this function is so trivial to define that you might actually not bother:
ratCageVolume :: Rat -> Volume
ratCageVolume = getVolume . getCage 
```

至于数据表示，我可能会沿着这些路线走下去：

```
type Weight = Double
type Volume = Double

-- Rats and Cages have identity that goes beyond their properties;
-- two distinct rats of the same weight can be in the same cage, and
-- two cages can have same volume.
-- 
-- So should we give each Rat and Cage an additional field to
-- represent its key?  We could do that, or we could abstract that out
-- into this:

data Identity i a = Identity { getId  :: i
                             , getVal :: a }
            deriving Show

instance Eq i => Eq (Identity i a) where
    a == b = getId a == getId b

instance Ord i => Ord (Identity i a) where
    a `compare` b = getId a `compare` getId b

-- And to simplify a common case:
type Id a = Identity Int a

-- Rats' only real intrinsic property is their weight.  Cage and Experiment?
-- Situational, I say.
data Rat = Rat { getWeight :: Weight  }

data Cage = Cage { getVolume :: Volume }

data Experiment = Experiment { getNotes :: String }
                  deriving (Eq, Show)

-- The data that you're manipulating is really this:
type RatData = (Id Rat, Id Cage, Id Experiment)

type ResearchFacility = [RatData] 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-08-06T22:13:16.503

我在日常工作中大部分时间都使用 Haskell，我遇到了这个问题。我的经验是，创建多少数据结构的副本不是问题，更多的是涉及到的数据依赖关系。我们使用类似的数据结构来帮助与存储实际数据的关系数据库进行交互。这意味着我们有这样的查询。

```
getCageById       :: IdType -> IO (Maybe Cage)
getRatById        :: IdType -> IO (Maybe Rat)
getExperimentById :: IdType -> IO (Maybe Experiment) 
```

我们从像您一样构建的数据结构开始，其中包含链接的数据结构。事实证明这是一个巨大的错误。问题是，如果您对 Rat 使用以下定义...

```
data Rat = Rat Cage Experiment Weight 
```

...然后 getRatById 函数必须运行三个数据库查询才能返回结果。起初这似乎是一种很好的便捷方式，但它最终成为一个巨大的性能问题，特别是如果我们希望查询返回一堆结果。即使我们只想要老鼠表中的行，数据结构也会强制我们进行连接。额外的数据库查询是问题所在，而不是 RAM 中额外对象的可能性。

现在我们的策略是，当我们创建与数据库表相对应的数据结构时，我们总是像表一样对它们进行非规范化。所以你的例子会变成这样：

```
type IdType = Int
type Weight = Double
type Volume = Double

data Rat = Rat
    { ratId        :: IdType
    , cageId       :: IdType
    , experimentId :: IdType
    , weight       :: Weight
    }
data Cage = Cage IdType Volume
data Experiment = Experiment IdType String 
```

（您甚至可能想要使用 newtypes 来区分不同的 ID。）获取整个结构需要更多的工作，但它可以让您有效地获取结构的某些部分。当然，如果您永远不需要获取结构的各个部分，那么我的建议可能不合适。但我的经验是，部分查询很常见，我不想人为地让它们变慢。如果您想要一个为您执行连接的函数的便利，那么您当然可以编写一个。但不要使用将您锁定在这种使用模式中的数据模型。

# java - 处理 XML 时发生错误“无法从位置加载架构映射”

> ID：11833928
> 
> 赞同：2
> 
> 时间：2012-08-06T18:37:19.903
> 
> 标签：java, spring, maven

我从我的 repo 中获取了一个现有的 maven，然后当我用 eclipse 打开时，我收到了这个错误：

```
Error occured processing XML 'Unable to load schema mappings from location [META-INF/spring.schemas]'. 
See Error Log for more details  security-context.xml    /myapp/src/main/webapp/WEB-INF/spring/appServlet    Unknown Spring Beans Problem 
```

我需要手动将 spring.schemas 放入 META-INF 文件夹吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T14:48:29.917

尝试清理你的罐子，也许其中一个已损坏。

右键单击您的项目-> 运行方式-> Maven clean。
然后：
右键单击您的项目 -> 运行方式 -> Maven 构建。

您可以使用“mvn clean”和“mvn build”从命令行执行此操作

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-10-20T08:57:34.350

请检查你的 pom.xml 文件，它错过了匹配的版本

```
<dependency>
    <groupId>org.springframework</groupId>
    <artifactId>spring-context</artifactId>
    <version>3.1.0.RELEASE</version>
</dependency> 
```

# css - CSS背景图像未显示

> ID：11833933
> 
> 赞同：0
> 
> 时间：2012-08-06T18:37:33.223
> 
> 标签：css

我有一个背景图像，我想在一个浮动的 div 中显示。

这是CSS

```
<style>
.myclass {
background-image: url('images/myimage.png') no-repeat 0 0;
float:right;
background-size:80px 80px;
}
</style> 
```

然后我有一个清单：

```
<ul>
<li>
<div class="myclass">&nbsp;</div>
<p>Hello</p>
</li>
</ul> 
```

由于某种原因，图像根本没有显示。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-06T18:40:59.683

您正在使用`background-image`选择器，但使用它就像它是速记`background`规则一样。

采用：`background: url('images/myimage.png') no-repeat 0 0;`

您还需要为 div 指定宽度和高度，因为浮动会折叠它，并且`&nbsp;`只会给它一个边缘高度和宽度。

**[jsFiddle 示例](http://jsfiddle.net/j08691/FQCzu/)**

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-07T08:16:59.257

你也可以这样写

```
.myclass{
    background: url('images/myimage.png');
    background-repeat: no-repeat;
    height: 150px;
    width: 200px;
} 
```

你必须给它一些关于它的高度和宽度的属性，否则它不会显示。一个建议是，您检查文件夹中图像的尺寸并相应地定义高度和宽度的大小。祝你好运！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-06T18:40:44.957

而不是`background-image`用于`background`您的 CSS 属性。

[http://www.dustindiaz.com/css-shorthand/](http://www.dustindiaz.com/css-shorthand/)

您可能还需要在 url() 属性之前添加背景颜色。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-06T18:44:05.780

```
background:url('img_tree.png') right no-repeat; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-06T18:41:10.630

这可能是您的文件夹路径..您尝试过../images/吗？

# javascript - 扩展validation.js 并验证单个元素

> ID：11833935
> 
> 赞同：2
> 
> 时间：2012-08-06T18:37:41.213
> 
> 标签：javascript, magento, prototype

Magento 是否可以扩展validation.js 以添加验证单个元素而不是完整表单的能力。

如果不可能，自定义validation.js脚本的最不显眼的方式是什么

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-06T21:59:36.920

基于对 Francesco 的评论中提供的详细信息，而不是最初的问题 - 如果需要验证 onblur 单个表单元素的验证，那么您需要将 Validation 对象的 'immediate' 属性设置为 true ，就像这样......

```
Validation.defaultOptions.immediate = true; 
```

如果元素值已更改**并且**失去焦点，这将导致验证发生。

我认为这是一个站点范围内的更改 - 所以我通常会放置诸如我的主题 js 文件之类的代码，但或者您也可以通过将其包含在脚本标签中来将其放置在模板中（显然在您的表单对象被初始化之前）。

```
<script type="text/javascript">
    Validation.defaultOptions.immediate = true;
<script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-01T16:31:47.520

创建一个内容如下所示的 CMS 块，并添加一个设置结帐页面的小部件。

```
<script type="text/javascript">
    $$('.validate-michael-jackson').first().observe('blur', function(elem){
        if (elem.value == 'Michael Jackson') {
            alert('Come on baby! Are you really Michael Jackson?');
        }
    });
</script> 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-06T20:03:21.703

看看这个： [链接](http://inchoo.net/ecommerce/magento/programming-magento/validate-your-input-magento-style/?utm_source=feedburner&utm_medium=feed&utm_campaign=Feed%3A+Inchoo+%28Magento%2C+Wordpress%2C+Online+Marketing%2C+iPhone+development+%40+Inchoo%29)

据我所知，您可以通过扩展validation.js 类轻松地在.phtml 文件中添加新验证

# java - 暂停计时器并恢复

> ID：11833936
> 
> 赞同：-2
> 
> 时间：2012-08-06T18:38:00.820
> 
> 标签：java, android, andengine

这是我用来控制间隔的计时器类。欢迎大家使用它。

我遇到的问题是我的暂停和恢复。它正确暂停，但是当我尝试使用我的 resume() 时，它不会恢复时间。任何想法为什么？

```
 public class Timer implements IUpdateHandler {
        // ===========================================================
        // Constants
        // ===========================================================

        // ===========================================================
        // Fields
        // ===========================================================
        private final ITimerCallback    mCallback;
        private float                                   mInterval;

        private float                                   mSecondsElapsed;
        protected boolean                               mPause  = false;

        private float                                   pausedSecond;

        // ===========================================================
        // Constructors
        // ===========================================================
        public Timer(final float interval, final ITimerCallback pCallback) {
        this.mInterval = interval;
        this.mCallback = pCallback;

        }

        // ===========================================================
        // Getter & Setter
        // ===========================================================
        public void setInterval(final float pInterval) {
        this.mInterval = pInterval;
        }

        // ===========================================================
        // Methods for/from SuperClass/Interfaces
        // ===========================================================
        @Override
        public void onUpdate(float pSecondsElapsed) {

        this.mSecondsElapsed += pSecondsElapsed;
        if (this.mSecondsElapsed >= this.mInterval) {
        if (!this.mPause) {
        this.mSecondsElapsed -= this.mInterval;
        this.mCallback.onTick();
        }
        }
        }

        @Override
        public void reset() {
        this.mSecondsElapsed = 0;

        }

        // ===========================================================
        // Methods
        // ===========================================================

        // ===========================================================
        // Inner and Anonymous Classes
        // ===========================================================
        public interface ITimerCallback {
                public void onTick();
        }

        public void pause() {

        this.mPause = true;
        this.pausedSecond = this.mSecondsElapsed;
        }

        public void resume() {
        if (this.mPause) {
        this.mSecondsElapsed = this.pausedSecond;
        this.mPause = false;

        } else {
        // not paused
        }
        }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T18:47:51.243

什么场景说

```
 @Override
    public void onUpdate(float pSecondsElapsed) {

        this.mSecondsElapsed += pSecondsElapsed;
        if (this.mSecondsElapsed >= this.mInterval) {
            if (!this.mPause) {
                this.mSecondsElapsed -= this.mInterval;
            }
            this.mCallback.onTick();
        }
    } 
```

这应该够了吧; 如果没有暂停，只需将 onTick 移到外面

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T18:45:37.607

我将在这里冒险，因为我看不到驱动如何调用 Timer 的 onUpdate 函数的代码，而且我对您正在使用的 IUpdateHandler 接口了解不多。

如果计时器没有暂停，您似乎只是在调用 mCallback.onTick() 。

但是，如果 onTick 设置了对 Timer 的 onUpdate 函数的下一次调用，那么当您暂停它并且它“滴答”时，它不会调用 onTick 方法并设置对该函数的下一次调用。

# objective-c - 修复表视图控制器中标题视图的位置

> ID：11833942
> 
> 赞同：1
> 
> 时间：2012-08-06T18:38:18.030
> 
> 标签：objective-c, uitableview

作为我的应用程序设计的一部分，我在我`UITableView`的标题中放置了一个图像。

这个标题图像看起来很棒，直到滚动表格，移动标题相对于滚动到/从位置的位置。

我的问题是，我该如何阻止这种情况发生？我假设我必须以另一种方式来做，即把 a 放在`UIImageView`上面，`UITableView`所以它与滚动无关。但是，我不能`UIImageView`在`UITableViewController`.

我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T18:54:17.030

创建一个具有此视图层次结构的视图控制器：

```
view
 \---> header view //set the frame to be the top 200 pixels or whatever you want
 \---> table view // instead of being the top view, the table view is a subview with a frame starting below the header view 
```

设置 tableview 委托和数据源并正常使用它们

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-12T21:10:32.930

为了解决我的问题，我使用了一个组表视图，因为他们的部分标题随着内容滚动并且不“粘”在导航栏下，然后我将表视图拉伸到每边额外的 10 个，并将其向左推 10 个点, '摆脱' 边距。

然后我使用自定义表格视图单元格来设计我自己的自定义单元格。

# php - xmlrpc_encode_request 的替代方案

> ID：11833943
> 
> 赞同：1
> 
> 时间：2012-08-06T18:38:26.100
> 
> 标签：php, xml, xml-rpc

由于我无法在 localhost 上安装 XML-RPC，我想知道是否有任何 PHP 替代方案[`xmlrpc_encode_request()`](http://php.net/manual/en/function.xmlrpc-encode-request.php)可以帮助我完成任务。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T18:49:01.147

知道要输出的 XML 结构良好，您可以尝试使用[`XMLWriter`](http://www.php.net/manual/en/book.xmlwriter.php)PHP 的扩展来为您完成工作。

注意页面上的评论：

> 重要提示：`XMLWriter`需要您提供 UTF-8 数据。它可以输出各种编码的XML，但输入应该是严格的UTF-8！

示例使用代码（取自 的文档[`XMLWriter::openMemory`](http://www.php.net/manual/en/function.xmlwriter-open-memory.php)）：

```
header('Content-type: text/xml; charset=UTF-8');

$oXMLWriter = new XMLWriter;
$oXMLWriter->openMemory();
$oXMLWriter->startDocument('1.0', 'UTF-8');

$oXMLWriter->startElement('test');
$oXMLWriter->text('Hello, World!');
$oXMLWriter->endElement();

$oXMLWriter->endDocument();
echo $oXMLWriter->outputMemory(TRUE); 
```

另外，请注意，[`xmlrpc_encode_request()`](http://php.net/manual/en/function.xmlrpc-encode-request.php)由于该功能是实验性的，可能会发生变化，因此请自行负责。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T01:09:36.733

我结束了使用 PEAR XML_RPC [http://pear.php.net/package/XML_RPC](http://pear.php.net/package/XML_RPC) 我没有尝试 Whisperity 方法，因为当他回答时我已经在处理这个问题了。

为了使它工作，我刚刚安装了：

```
 /Applications/MAMP/bin/php/php5.4.4/bin/pear install XML_RPC 
```

然后我用：

```
$content = new XML_RPC_Value(array(
            'post_title'=> new XML_RPC_Value($title,'string'),
            'post_status'=> new XML_RPC_Value('publish','string'),
            'post_excerpt'=> new XML_RPC_Value($title,'string'),
            'post_content'=> new XML_RPC_Value($body,'string'),
            'mt_allow_comments'=> new XML_RPC_Value(0,'int'),
            'mt_allow_pings'=> new XML_RPC_Value(0,'int'),
            'post_type'=> new XML_RPC_Value('market','string')
        ),'struct' );    
$params = array(new XML_RPC_Value(0,'int'),new XML_RPC_Value($this->UserName,'string'),new XML_RPC_Value($this->PassWord,'string'),$content,new XML_RPC_Value(true,'boolean')); 
```

# java - EasyMock 期待私有方法调用

> ID：11833945
> 
> 赞同：5
> 
> 时间：2012-08-06T18:38:35.390
> 
> 标签：java, unit-testing, easymock

可以说我有一个看起来像这样的方法：

```
public static String[] parseFoo(Foo anObject){
    Foo anotherObject = parseFoo2(anObject);
...
}

private static Foo parseFoo2(Foo anObject){
...
} 
```

并且这两种方法都在同一个类中。parseFoo2 只是一个帮助 parseFoo 完成一些工作的辅助方法。我正在尝试测试方法 parseFoo。EasyMock 中是否有人可以为 parseFoo2 指定该私有方法调用的返回值，就像我可以为对象指定实例方法调用一样

```
EasyMock.createMock(...);
anObject.expect(...).andReturn(...); 
```

因为我想测试公共方法，但我不想进入私有方法并测试里面的实现。

谢谢

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-06T18:50:21.427

不要这样做。一个好的单元测试的基石之一是它应该尽可能少地依赖于实现细节。模拟一个*私有*方法就是这样。

为什么？因为这会使您的单元测试非常脆弱。考虑一下您在一周后返回此代码并确定您实际上并不需要方法 parseFoo2 并且您实际上想要内联其代码的情况。或者您想将此方法拆分为两个或多个较小的方法。所有非常有效的重构实践——*但它们会破坏单元测试！*

您不希望每次进行这样的简单重构时都进行单元测试。因此，模拟私有方法被认为是不好的做法。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-08-06T18:54:26.693

如果你发现你*必须*模拟一个私有方法，那么你可以使用[`PowerMock.expectPrivate()`](http://code.google.com/p/powermock/wiki/MockPrivate). EasyMock 不能模拟私有方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T11:17:46.153

如果您仍然想使用 EasyMock，因为更改它不取决于您（在企业中工作），您可以使用反射来更改您的方法返回的私有字段，或任何私有字段。

例如，您可以在帮助程序类中使用这些方法。并根据需要使用它们。

# msbuild - CruiseControl.NET：SVN获取的构建子项目

> ID：11833947
> 
> 赞同：0
> 
> 时间：2012-08-06T18:38:38.920
> 
> 标签：msbuild, cruisecontrol.net

我有这个项目结构：

```
    主要——main.csproj

    主/子项目 --- main.subproject1.csproj
    main/subproject1/view/ --- main.subproject1.view.csproj
    main/subproject1/business/ --- main.subproject1.business.csproj
    主/子项目1/元数据/ --- main.subproject1.metadata.csproj
    main/subproject1/fa​​cade/ --- main.subproject1.facade.csproj
    main/subproject1/data/ --- main.subproject1.data.csproj

    主/子项目2
    主/子项目2/视图/

```

...

因此，当对我的 SVN 存储库“主干”上的文件进行一些修改时，我只想构建/编译特定的 .csproj 项目。我正在尝试使用 MsBuild + ModificationReader 但我不确定如何修改阅读器（文档很差）

你们知道如何做到这一点吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T16:01:07.400

看看filteredSourceControlProvider 和inclusionFilters

[http://www.cruisecontrolnet.org/projects/ccnet/wiki/Filtered](http://www.cruisecontrolnet.org/projects/ccnet/wiki/Filtered)

如果每个 csproj 都有一个 ccnet 项目，那么每个 csproj 都可以触发自己的更改

# jquery - 使用 IE/Safari 将图像作为数据 URI 上传

> ID：11833949
> 
> 赞同：1
> 
> 时间：2012-08-06T18:38:56.907
> 
> 标签：jquery, filereader, data-uri

目前我有一个使用 jQuery 和 的拖放解决方案`FileReader`，它适用于 Chrome 和 Firefox。我使用`readAsDataURL`获取要上传的图像的数据 URI，然后将数据 POST 到 PHP 以作为文件写入服务器上。

我已经大大压缩了我的代码，但过程如下所示：

```
this.bind('drop', function(evt) {
    evt.preventDefault();
    evt.stopPropagation();

    var files = evt.originalEvent.dataTransfer.files;
    var file = files[0];
    var reader = new FileReader();

    reader.readAsDataURL(file);
}); 
```

然后我有一个单独的函数调用`$.ajax`POST 数据 URI。我还检查了可以支持的浏览器`FileReader`：

```
$.fn.initUpload = function() {
    return (window.FileReader) ? this.initDnD() : this.addClass('disabled');
} 
```

哪里`initDnD()`有前面的例子。

对于这`.disabled`门课，我正在`<input type="file" />`使用 Safari/IE。有什么方法可以获取用户选择的文件并立即将其转换为 Safari/IE 上的数据 URI？我之所以这么问，是因为我宁愿重用我的 PHP 脚本，它将数据 URI 保存为图像。

# ios - 这个 UIImage 数据读取器线程安全吗？

> ID：11833950
> 
> 赞同：0
> 
> 时间：2012-08-06T18:38:57.590
> 
> 标签：ios, opengl-es, uiimage, thread-safety

或者这段代码可以安全地在后台线程中执行？

```
 CGImageRef cgImage;
    CGContextRef context;
    CGColorSpaceRef colorSpace;

    // Sets the CoreGraphic Image to work on it.
    cgImage = [uiImage CGImage];

    // Sets the image's size.
    _width = CGImageGetWidth(cgImage);
    _height = CGImageGetHeight(cgImage);

    // Extracts the pixel informations and place it into the data.
    colorSpace = CGColorSpaceCreateDeviceRGB();
    _data = malloc(_width * _height * 4);
    context = CGBitmapContextCreate(_data, _width, _height, 8, 4 * _width, colorSpace,
                                    kCGImageAlphaPremultipliedLast | kCGBitmapByteOrder32Big);
    CGColorSpaceRelease(colorSpace);

    // Adjusts position and invert the image.
    // The OpenGL uses the image data upside-down compared commom image files.
    CGContextTranslateCTM(context, 0, _height);
    CGContextScaleCTM(context, 1.0, -1.0);

    // Clears and ReDraw the image into the context.
    CGContextClearRect(context, CGRectMake(0, 0, _width, _height));
    CGContextDrawImage(context, CGRectMake(0, 0, _width, _height), cgImage);

    // Releases the context.
    CGContextRelease(context); 
```

如果没有，如何获得相同的结果？

（我的问题是，如果它在后台运行，基于此方法的输出缓冲区，我看不到我的 OpenGL 纹理）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T08:47:18.377

我认为您可能无法像这样在与 GL 不同的线程上运行此代码。即使它会起作用，您也可能会遇到半绘制的图像/纹理。您可以通过创建双缓冲区来避免这种情况：您的“_data”应该只分配一次，并且应该保存 2 个原始图像数据缓冲区。然后只需创建 2 个定义为前台和后台缓冲区的指针（void *fg = _data[0], void *bg = _data[1] 开头）。现在，当您的方法从 CGImage 收集数据到 bg 时，只需交换指针（然后 void *fg = _data[1]、void *bg = _data[0] 或其他方式）现在您的 GL 线程应该用数据填充您的纹理fg（与绘图相同的线程）。

此外，您可能需要一些锁定机制：

1.  在将数据推送到纹理之前，您应该锁定“缓冲区交换”并在推送后将其解锁。

2.  您可能想知道缓冲区是否已被交换，并且在这种情况下仅将 fg 数据推送到纹理。

另请注意，如果您在超过 1 个线程上调用 GL 方法，在大多数情况下都会遇到问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T18:43:23.800

这对我来说看起来不错，假设`uiImage`,和同时没有被另一个线程操作。（假设您使用的是 iOS 4 及更高版本。）`_width``_height``_data`

您是否在后台线程上将纹理上传到 OpenGL？如果是这样，那可能就是问题所在（因为给定的 OpenGL 上下文一次只能从一个线程访问）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-06T18:48:43.377

只要您不（直接或间接）访问 UIKit（或类似框架）并且只要您不从多个线程访问代码中的变量，就可以了。

# mysql - SQL - 选择按日期排序的最后一行

> ID：11833957
> 
> 赞同：1
> 
> 时间：2012-08-06T18:39:30.710
> 
> 标签：mysql, sql

这是我的 SQL：

```
"SELECT users.username, users.id_user, friends.name, friends.meet_date 
 FROM users INNER JOIN friends ON (users.id_user = friends.id_user) 
 GROUP BY username ORDER BY username"; 
```

这是我网页上的输出：

```
Username    Friend's Name    Meeting Date
George      Nicolas          2010
Man         Anatol           2008 
```

目前，它只为每个用户从数据库中选择第一行。

每个表都有一个 auto_increment，第一个表的 id_user 和第二个表的 id_friend。

我希望它显示每个用户最后见面的那个朋友。

我尝试添加一个，`order by "meet_date DESC"`但它不起作用。

我怎样才能实现我的愿望？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-06T18:52:44.560

一个标准技巧是使用外部自连接：

```
 SELECT users.username, users.id_user, friends.name, friends.meet_date 
 FROM users 
 INNER JOIN friends ON (users.id_user = friends.id_user) 
 LEFT JOIN friends f2 ON friends.meet_date > f2.meet_date
 WHERE f2.(primary key) IS NULL
 GROUP BY username
 ORDER BY username 
```

它查找没有具有更大日期值的其他记录的日期。这避免了相关子查询和额外聚合的低效率；或者如果您想使用主键，记录总是按约会日期顺序添加的可疑假设。

*** 由其他用户编辑 ***

您应该将 (primary key) 替换为主键列表或仅由 f2 列：

```
SELECT users.username, users.id_user, friends.name, friends.meet_date 
 FROM users 
 left JOIN friends ON (users.id_user = friends.id_user) 
 LEFT JOIN friends f2 ON friends.meet_date > f2.meet_date
 WHERE f2.id_user IS NULL
 GROUP BY username
 ORDER BY username 
```

查询按规定运行：

```
| USERNAME | ID_USER |   NAME | MEET_DATE |
-------------------------------------------
|        a |       1 |      c |         0 |
|        b |       2 | (null) |    (null) | 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-06T18:47:29.900

简单的方法是子查询：

```
 SELECT 
   users.username, 
   users.id_user, 
   ( select friends.name  
     from friends 
     where (users.id_user = friends.id_user) 
     ORDER BY friends.meet_date desc
     LIMIT 1 ) as friend_name,       
   ( select friends.meet_date
     from friends 
     where (users.id_user = friends.id_user) 
     ORDER BY friends.meet_date desc
     LIMIT 1 ) as friend_meet_date
 FROM users 
 ; 
```

*** 测试 ***

```
create table users (username varchar(50), id_user int);
create table friends ( name varchar(50), id_user int, meet_date int);

insert into users values ( 'a', 1),('b',2);
insert into friends values ('c', 1, 0), ('d',1,1); 
```

结果：

```
| USERNAME | ID_USER | FRIEND_NAME | FRIEND_MEET_DATE |
-------------------------------------------------------
|        a |       1 |           d |                1 |
|        b |       2 |      (null) |           (null) | 
```

[在 sql fiddle 尝试一下](http://sqlfiddle.com/#!2/e9bcd/1/0)。

请注意，相关子查询不是一种优雅的方法，而是一种简单的方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-06T18:46:02.697

您没有 auto_increment 字段吗？这将允许您按此排序。另一种选择是将 meet_date 更改为日期字段，以便您可以正确排序。没有理由将 a 存储`DateTime`为`varchar`字段

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-06T18:46:16.583

假设你有`id`一个`primary key`with `auto_increment`in `users`table，这应该可以解决问题：

```
SELECT MAX(users.id), users.username, users.id_user, friends.name, friends.meet_date 
 FROM users INNER JOIN friends ON (users.id_user = friends.id_user) 
 GROUP BY username ORDER BY username 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-06T18:50:26.660

```
SELECT users.username, users.id_user, friends.name, friends.meet_date 
 FROM users INNER JOIN friends ON (users.id_user = friends.id_user) 
 GROUP BY username ORDER BY username
having max(friends.meet_date)=friends.meet_date 
```

# c# - AForge.Imaging.dll 上缺少新添加的类

> ID：11833962
> 
> 赞同：2
> 
> 时间：2012-08-06T18:40:10.917
> 
> 标签：c#, visual-studio-2010, class, dll, aforge

我试图向 AForge.Imaging.Filters 添加一个新的自适应阈值方法

我在下面添加了新的cs文件

> Sources\Imaging\Filters\自适应二值化

下面是阈值方法的代码

```
namespace AForge.Imaging.Filters
{
    using System;
    using System.Collections.Generic;
    using System.Drawing;
    using System.Drawing.Imaging;
    using AForge.Imaging;

    class SauvolaAdaptiveThresholding : BaseInPlacePartialFilter
    {
        private const float DEFAULT_WeightingFactor = 0.3f;
        private const short DEFAULT_WindowSize = 40;

        private float weightingFactor ;
        private short windowSize ;
        // private format translation dictionary
        private Dictionary<PixelFormat, PixelFormat> formatTranslations = new Dictionary<PixelFormat, PixelFormat>();

        /// <summary>
        /// Format translations dictionary.
        /// </summary>
        public override Dictionary<PixelFormat,PixelFormat>  FormatTranslations
        {
            get { return formatTranslations; }
        }
        public float WeightingFactor
        {
            get{return this.weightingFactor;}
            set{this.weightingFactor = value;}
        }
        public short WindowSize
        {
            get{return this.windowSize;}
            set{this.windowSize = value;}
        }
        public SauvolaAdaptiveThresholding() :
            this(DEFAULT_WeightingFactor,DEFAULT_WindowSize)   {  }

        public SauvolaAdaptiveThresholding(float _weightFact , short _wsize)
        {
            this.WeightingFactor = _weightFact;
            this.WindowSize =_wsize;
            // initialize format translation dictionary
            formatTranslations[PixelFormat.Format8bppIndexed] = PixelFormat.Format8bppIndexed;
            formatTranslations[PixelFormat.Format16bppGrayScale] = PixelFormat.Format16bppGrayScale;
        }
        protected override unsafe void ProcessFilter(UnmanagedImage image, Rectangle rect)
        {
            int whalf = windowSize >> 1; //half of windowsize
            whalf = windowSize >> 1;

            byte* ptr = (byte*)image.ImageData.ToPointer(); //input         

            // Calculate the integral image, and integral of the squared image
            ulong[,] integral_image = new ulong[image.Width , image.Height];
            ulong[,] rowsum_image = new ulong[image.Width , image.Height];
            ulong[,] integral_sqimg = new ulong[image.Width , image.Height];
            ulong[,] rowsum_sqimg = new ulong[image.Width , image.Height];

            int xmin, ymin, xmax, ymax, index;
            double diagsum, idiagsum, diff, sqdiagsum, sqidiagsum, sqdiff, area;
            double mean, std, threshold;

            for (int j = 0; j < image.Height; j++)
            {
                rowsum_image[0, j] = (ulong)*(ptr + j);
                rowsum_sqimg[0, j] = rowsum_image[0, j] * rowsum_image[0, j];
            }
            for (int i = 1; i < image.Width; i++)
            {
                for (int j = 0; j < image.Height; j++)
                {
                    index = j * image.Width + i;
                    rowsum_image[i, j] = rowsum_image[i - 1, j] + (ulong)*(ptr + index);
                    rowsum_sqimg[i, j] = rowsum_sqimg[i - 1, j] + (ulong)(*(ptr + index) * *(ptr + index));
                }
            }

            for (int i = 0; i < image.Width; i++)
            {
                integral_image[i, 0] = rowsum_image[i, 0];
                integral_sqimg[i, 0] = rowsum_sqimg[i, 0];
            }
            for (int i = 0; i < image.Width; i++)
            {
                for (int j = 1; j < image.Height; j++)
                {
                    integral_image[i, j] = integral_image[i, j - 1] + rowsum_image[i, j];
                    integral_sqimg[i, j] = integral_sqimg[i, j - 1] + rowsum_sqimg[i, j];
                }
            }
            //Calculate the mean and standard deviation using the integral image
            for (int i = 0; i < image.Width; i++)
            {
                for (int j = 0; j < image.Height; j++)
                {
                    xmin = Math.Max(0, i - whalf);//max(0, i - whalf);
                    ymin = Math.Max(0, j - whalf);
                    xmax = Math.Min(image.Width - 1, i + whalf);
                    ymax = Math.Min(image.Height - 1, j + whalf);
                    area = (xmax - xmin + 1) * (ymax - ymin + 1);

                    if (xmin == 0 && ymin == 0)
                    { // Point at origin
                        diff = integral_image[xmax, ymax];
                        sqdiff = integral_sqimg[xmax, ymax];
                    }
                    else if (xmin == 0 && ymin != 0)
                    { // first column
                        diff = integral_image[xmax, ymax] - integral_image[xmax, ymin - 1];
                        sqdiff = integral_sqimg[xmax, ymax] - integral_sqimg[xmax, ymin - 1];
                    }
                    else if (xmin != 0 && ymin == 0)
                    { // first row
                        diff = integral_image[xmax, ymax] - integral_image[xmin - 1, ymax];
                        sqdiff = integral_sqimg[xmax, ymax] - integral_sqimg[xmin - 1, ymax];
                    }
                    else
                    { // rest of the image
                        diagsum = integral_image[xmax, ymax] + integral_image[xmin - 1, ymin - 1];
                        idiagsum = integral_image[xmax, ymin - 1] + integral_image[xmin - 1, ymax];
                        diff = diagsum - idiagsum;
                        sqdiagsum = integral_sqimg[xmax, ymax] + integral_sqimg[xmin - 1, ymin - 1];
                        sqidiagsum = integral_sqimg[xmax, ymin - 1] + integral_sqimg[xmin - 1, ymax];
                        sqdiff = sqdiagsum - sqidiagsum;
                    }

                    mean = diff / area;
                    std = Math.Sqrt((sqdiff - diff * diff / area) / (area - 1));
                    threshold = mean * (1 + WeightingFactor * ((std / 128) - 1));
                    if ((double)*(ptr + (j * image.Width + i)) < threshold)//if (gray_image[i, j] < threshold)
                        *(ptr + (j * image.Width + i)) = 0;
                    else
                        *(ptr + (j * image.Width + i)) = 255;
                }
            }
          }
        }
} 
```

但是当我构建项目并使用 AForge.Imaging.dll 时，上面的类不可用。当我尝试使用对象浏览器时，我看到除了我新添加的类之外的所有其他类。

有人可以告诉我我做错了什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T19:16:42.083

它需要公开

```
public class SauvolaAdaptiveThresholding : BaseInPlacePartialFilter 
```

您可以在此处找到有关 C# 访问修饰符的更多信息：http: [//msdn.microsoft.com/en-us/library/ms173121.aspx](http://msdn.microsoft.com/en-us/library/ms173121.aspx)

# objective-c - Alpstein/Route-me 注释气球

> ID：11833963
> 
> 赞同：0
> 
> 时间：2012-08-06T18:40:11.433
> 
> 标签：objective-c, route-me, popup-balloons

我正在使用 Alpstein/Route-me 在我的 iPhone 应用程序中处理地图。当我点击地图上的标记时，我希望出现一个气球（我认为类似于 MKAnnotationView）。Alpstein Route-me 有什么办法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T08:28:45.467

您必须将子类定义为`RMMapLayer`. `RMMapLayer`s 用于在地图上呈现注释，就像 a`MKAnnotationView`是 a 的视觉表示`MKAnnotation`。一个好的起点可能是`RMMarker`类，它是一个子类，`RMMapLayer`用于在地图上显示标记。

根据气球应该出现的样式，您也可以简单地点击地图视图控制器中的标记。地图视图通过调用通知其代表有关点击的信息

```
- (void)tapOnAnnotation:(RMAnnotation *)annotation 
                  onMap:(RMMapView *)mapView 
```

当点击发生时，您可以用显示气球的注释替换注释。

# grails - remoteFunction 调用不工作 grails

> ID：11833968
> 
> 赞同：1
> 
> 时间：2012-08-06T18:40:49.853
> 
> 标签：grails, drop-down-menu, grails-controller

在下拉菜单中进行选择后，我试图调用一个函数。这是我的 list.gsp 中“代码”域类的下拉菜单的代码：

```
<td><g:select name="data" from="${codeInstance.datas.language}" 
          onchange="${remoteFunction(action: 'translationById')}"/> 
</td> 
```

这是我试图调用的函数。这是在我的代码控制器中：

```
def translationById = {
        println "Fine"
        //println params;
    } 
```

我只是想打印出“Fine”，所以我知道该函数已被调用，但“Fine”永远不会被打印出来。为什么函数没有被调用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T19:58:48.677

不要使用闭包，而是使用方法，例如：

```
def translationById() {
        println "Fine"
        //println params;
} 
```

此外，使用一些浏览器调试器（例如 firebug 或类似工具）来查看是否显示错误消息。

如果在 onchange 事件而不是 remoteFunction 中放置警报会发生什么？如果显示警报，那么我认为您的问题出在原型库上。将原型库添加到您的标题中。喜欢`<g:javascript library="prototype" />`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T18:52:25.340

语法对我来说看起来不错。尝试确保您的“codeInstance”和“datas”不为空。另外，尝试像这样传递控制器名称：

```
remoteFunction(action: 'translationById', controller: 'code') 
```

grails 中的新规范是使用方法而不是闭包：

```
def translationById(){
    println "fine"
} 
```

# objective-c - Objective-c CG填充路径不起作用

> ID：11833974
> 
> 赞同：1
> 
> 时间：2012-08-06T18:41:15.000
> 
> 标签：objective-c, cg

我有以下问题：

```
CGContextRef context = UIGraphicsGetCurrentContext();

CGContextSetLineCap(context,kCGLineCapRound);
CGContextSetLineJoin(context, kCGLineJoinRound);
CGContextSetRGBFillColor(context, 1, 0, 0, 1);

for (drawnCurve *line in completeLines) {
CGContextBeginPath(context);    
    for(int i=0;i<[line.points count]-1;i++) 
    { 
    drawnPoint*point=[line.points objectAtIndex:i];
    drawnPoint*point2=[line.points objectAtIndex:i+1];

   // CGContextSetLineWidth(context, point.r);
    [point.color set];
    CGContextMoveToPoint(context, point.x,point.y);
        CGContextAddLineToPoint(context, point2.x, point2.y);  
    // CGContextAddCurveToPoint(context, (point.x+point2.x)/2, point2.y, (point.x+point2.x)/2, point2.y, point2.x, point2.y);

        //CGContextEOFillPath(context);
    }
    CGContextClosePath(context);
    CGContextFillPath(context);
} 
```

但它只是消失了，没有显示任何填充曲线。有什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T19:02:31.367

调用`CGContextMoveToPoint`开始一个新的子路径。您应该在嵌套`for`循环之前调用它一次，然后仅`CGContextAddLineToPoint`用于保持线路连接：

```
drawnPoint*pointZero=[line.points objectAtIndex:0];
CGContextMoveToPoint(context, pointZero.x,pointZero.y);
for(int i=1;i<[line.points count];i++) 
{ 
    drawnPoint*point=[line.points objectAtIndex:i];
    CGContextAddLineToPoint(context, point.x, point.y);  
}
CGContextClosePath(context);
CGContextFillPath(context); 
```

# java - Asynctask：将两个或多个值从 doInBackground 传递给 onPostExecute

> ID：11833978
> 
> 赞同：24
> 
> 时间：2012-08-06T18:41:24.860
> 
> 标签：java, android, android-asynctask

我有一个 Asynctask 检索两个 int 值，我想将它们传递给 onPostExecute 以在视图上显示它们。
这是我的代码：

```
 public class QueryServer extends AsyncTask <String, Void, Integer> { 

    protected Integer doInBackground(String... serverAddress) {
        Log.d("QueryServer", ""+serverAddress[0]);
        MCQuery mcQuery = new MCQuery("" + serverAddress[0] ,25565);
        QueryResponse response = mcQuery.basicStat();

        int Onlineplayers = response.getOnlinePlayers(); //first vaule
        int Maxplayers = response.getMaxPlayers();  //second vaule

        Log.d("MCQuery", "" + Onlineplayers + " OnlinePlayers");
        return Onlineplayers;

    }

    protected void onPostExecute(Integer Onlineplayers){

        TextView onlinePlayersView = (TextView) findViewById(R.id.online_players);

        onlinePlayersView.setText(""+Onlineplayers+"/"+ Maxplayers); //i need to pass Maxplayers to use it here

    } 
```

先感谢您。

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2012-08-06T18:45:25.113

您可以定义一个包含两个整数的 Wrapper 类：

```
public class Wrapper
{
    public int onlinePlayers;
    public int maxPlayers;
} 
```

并使用它代替`Integer`：

```
public class QueryServer extends AsyncTask<String, Void, Wrapper> { 

    protected Wrapper doInBackground(String... serverAddress) {
        Log.d("QueryServer", ""+serverAddress[0]);
        MCQuery mcQuery = new MCQuery("" + serverAddress[0] ,25565);
        QueryResponse response = mcQuery.basicStat();

        int onlinePlayers = response.getOnlinePlayers(); //first vaule
        int maxPlayers = response.getMaxPlayers();  //second vaule

        Log.d("MCQuery", "" + onlinePlayers + " onlinePlayers");
        Wrapper w = new Wrapper();
        w.onlinePlayers = onlinePlayers;
        w.maxPlayers = maxPlayers;
        return w;

    }

    protected void onPostExecute(Wrapper w){

        TextView onlinePlayersView = (TextView) findViewById(R.id.online_players);

        onlinePlayersView.setText(""+w.onlinePlayers+"/"+ w.maxPlayers); //i need to pass Maxplayers to use it here

    } 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-06T18:45:59.077

```
public class QueryServer extends AsyncTask <String, Void, Integer>{...} 
```

将`Integer`通用参数替换为`ArrayList<Integer>`或`Integer[]`

这样，您`doInBackground()`将看起来像这样：

```
protected Integer[] doInBackground(String... serverAddress) 
{
    ...do what you need to do...
    //Then create an array, fill with data, and return.
    Integer[] arr = new Integer[10];
    for(int i=0; i<10; i++)
        arr[i] = i; //just an example
    return arr;
} 
```

而在你的`onPostExecute()`

```
protected void onPostExecute(Integer [] Onlineplayers)
{
    //Do whatever you want with your array
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-06T18:45:45.513

最直接的方法是简单地声明一个带有您要返回的字段的小容器对象，然后从 doInBackground 返回一个实例：

```
private class QueryResult {
    int onlinePlayers;
    int maxPlayers;

    public QueryResult( int onlinePlayers, int maxPlayers ) {
        this.onlinePlayers = onlinePlayers;
        this.maxPlayers = maxPlayers;
    }
}

protected QueryResult doInBackground(String... serverAddress) {
    // ...

    return new QueryResult( onlinePlayers, maxPlayers );
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-06T18:48:43.407

您是否尝试过使这两个 ints 成员成为`QueryServer`？

`onPostExecute()`在 after 完成之前不会运行`doInBackground()`，因此不应该有任何线程问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-07-09T10:39:12.253

一般来说，替换`Integer`为`ArrayList of Objects`。使用此数组，您可以传递任何类型的任何集合。但很明显，缺点是你应该选派成员，你应该知道所有的类型......

# c# - ASP.Net Active Directory 获取组在本地机器上工作，但不在 Web 服务器上

> ID：11833979
> 
> 赞同：0
> 
> 时间：2012-08-06T18:41:28.470
> 
> 标签：c#, asp.net, active-directory

我有代码可以为任何特定用户从 AD 返回组。在我的开发箱上本地工作得很好。当我尝试在 Web 服务器上运行它时，它不会完成代码但会引发错误然后返回。我虽然这可能与权限有关，所以当代码完成获取组时，我添加了一个模拟管理员帐户的部分，它撤消了模拟。该代码不会引发错误，但它也不会返回组列表。

```
public static List<GroupPrincipal> GetUserGroups(string userName)
{

    bool isImper = impersonateValidUser("user", "domain", "password");
    List<GroupPrincipal> result = new List<GroupPrincipal>();

    // establish domain context
    PrincipalContext yourDomain = new PrincipalContext(ContextType.Domain,"WYSD");

    // find your user
    UserPrincipal user = UserPrincipal.FindByIdentity(yourDomain, userName);

    // if found - grab its groups
    if (user != null)
    {
        PrincipalSearchResult<Principal> groups = user.GetAuthorizationGroups();

        // iterate over all groups
        foreach (Principal p in groups)
        {
            // make sure to add only group principals
            if (p is GroupPrincipal)
            {
                result.Add((GroupPrincipal)p);
            }
        }
    }
    undoImpersonation();
    try
    {
        return result;
    }
    catch (Exception ex)
    {
        Log.WriteLog("Error in retriving form data: " + ex.Message);
        Thread.Sleep(1000);
        return GetUserGroups(userName);
    }
} 
```

捕获中的`Thread.Sleep`用于解决目前 .NET 4.0 中的问题。如果我在本地使用模拟或不模拟的代码，它工作正常。模拟代码如下：

```
public static bool impersonateValidUser(String userName, String domain, String password)
{
    System.Security.Principal.WindowsIdentity tempWindowsIdentity;
    IntPtr token = IntPtr.Zero;
    IntPtr tokenDuplicate = IntPtr.Zero;
    if(userName.Contains("\\")){
        userName = userName.Substring(userName.LastIndexOf("\\") + 1);
    }
    if (LogonUser(userName, domain, password, LOGON32_LOGON_INTERACTIVE, LOGON32_PROVIDER_DEFAULT, ref token) != 0)
    {
        if (DuplicateToken(token, 2, ref tokenDuplicate) != 0)
        {
            tempWindowsIdentity = new System.Security.Principal.WindowsIdentity(tokenDuplicate);
            impersonationContext = tempWindowsIdentity.Impersonate();
            if (impersonationContext != null)
                return true;
            else
                return false;
        }
        else
            return false;
    }
    else
        return false;
}
public static void undoImpersonation()
{
    impersonationContext.Undo();
}

#region | Property |
// property getters/setters
public string DomainName { get; set; }
public string LoginPath { get; set; }
public string LoginUsername { get; set; }
public string LoginPassword { get; set; }
public System.DirectoryServices.AuthenticationTypes AuthenticationType { get; set; }
public System.DirectoryServices.DirectoryEntry Ad { get { return Ad; } set { Ad = value; } }
#endregion

#region | Impersonation via interop |
//need to import from COM via InteropServices to do the impersonation when saving the details
public const int LOGON32_LOGON_INTERACTIVE = 2;
public const int LOGON32_PROVIDER_DEFAULT = 0;
static System.Security.Principal.WindowsImpersonationContext impersonationContext;

[DllImport("advapi32.dll", CharSet = CharSet.Auto)]
public static extern int LogonUser(String lpszUserName, String lpszDomain, String lpszPassword, int dwLogonType, int dwLogonProvider, ref IntPtr phToken);
[DllImport("advapi32.dll", CharSet = System.Runtime.InteropServices.CharSet.Auto, SetLastError = true)]
public extern static int DuplicateToken(IntPtr hToken, int impersonationLevel, ref IntPtr hNewToken);
#endregion 
```

现在我想问题是，首先我是否需要模拟，如果不需要，为什么代码不起作用。其次，如果我需要模仿，为什么我不取回我的群组？

# c# - 线程不可能建议任何其他方式进行并行处理

> ID：11833982
> 
> 赞同：-4
> 
> 时间：2012-08-06T18:41:44.910
> 
> 标签：c#

我在 C# 中放入线程的代码不是线程安全的，因为它涉及大量数据库连接、存储过程执行。但我仍然想尽量减少执行所需的时间，任何人都可以向我建议一些并行或异步处理的东西......来自数据库端或.net端的任何东西......

我被线程卡住了..无法申请...

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T19:04:46.813

你应该更好地解释你在你的代码中做什么......

如果你做了很多循环，你应该试试 Parallel.For / Parallel.Foreach

[http://msdn.microsoft.com/en-us/library/system.threading.tasks.parallel.aspx](http://msdn.microsoft.com/en-us/library/system.threading.tasks.parallel.aspx)

在 Parallels 中，您还可以将任务排队以进行有序计算或将循环划分为可以提高整体性能的块...

我能说的最好的，只有这么少的信息。

希望能帮助到你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T18:53:17.633

出色地 。有几件事可以做。但是我不知道它真的适合你。

在数据库方面，您可以进行查询优化、索引和其他可能有助于增加查询运行时间的事情。使用分析器分析 . 查看查询计划以检查索引是否正确使用。

使用 NOLOCKS，但仅在您看到可以在您的选择中使用 NO LOCKS 的地方使用。（并不总是一个好的做法，但被使用）

实现可以处理多个请求的适当同步线程。.Net Side 没有其他方法。您必须正确审查您的设计。但是，您也可以使用分析器进行代码优化。您也可以使用任务库。

另一件事是您的服务器可能有问题。检查 CPU 和内存利用率。（这是我最不关心的问题）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-06T18:47:19.147

您的问题中几乎没有足够的信息来建议优化的解决方案。但是，如果您必须处理非线程安全的资源，一种策略是生成单独的进程来处理子任务。

但是请记住，单独的进程仍然必须处理整体解决方案中不相互影响的部分。

# android - 图片资源如何回收利用？

> ID：11833986
> 
> 赞同：1
> 
> 时间：2012-08-06T18:42:05.517
> 
> 标签：android, android-imageview, android-memory

通常我总是使用`Drawable`资源，`Imageviews`因为我没有手动释放它们。

但在某些情况下，我需要动态创建位图，然后我必须`recycle()`在`onDestroy()`. 这是我根据[其他 StackOverflow 问题](https://stackoverflow.com/questions/7009086/recycle-imageviews-bitmap)找到的最佳解决方案。

我想了解 Android 是如何管理`Drawable`资源的，以及为什么我没有手动回收它们。并且当了解后，看看是否可以将类似的逻辑应用于手动创建的位图。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T18:53:56.397

A`Drawable`比 a 广泛得多`Bitmap`。 `Drawable`旨在表示图形系统可以呈现给显示器的任何内容。有一些不包含s 的子类，`Drawable`例如 as`ShapeDrawable`或-，因此不需要任何类型的手动内存管理。`ColorDrawable``Bitmap`

A`BitmapDrawable`包装 a`Bitmap`并包含对 a 的引用`Bitmap`。这`Bitmap`很特别，因为 Android 将所有像素数据保存`Bitmaps`在一个单独的堆中，该堆与应用程序的其余部分分开管理。当 Android 垃圾收集器清理`Bitmap`对象时，它也会清理位图堆中的像素数据。`recycle()`但是您可以通过手动调用来强制它更快发生`Bitmap`，这会标记`Bitmap`无效并释放其像素数据。

`Bitmap`Android 为每个正在运行的应用程序分配一个固定大小的位图堆，您的应用程序可能会因为一次使用过多的 s 而耗尽其堆。这就是为什么如果您的应用程序广泛使用位图，一旦您知道不再需要位图，您可能会从回收位图中受益。

**更新：**如评论中所述，单独的位图堆适用于 Android 的 Honeycomb 之前的版本。从 Honeycomb 开始，位图堆与应用程序堆合并。这是一个[包含更多信息的 SO 帖子](https://stackoverflow.com/questions/7852943/what-does-bitmaprecycle-in-android-honeycomb-actually-do)。

# mysql - sql - 根据特定行更新几行

> ID：11833989
> 
> 赞同：-1
> 
> 时间：2012-08-06T18:42:25.630
> 
> 标签：mysql, sql, mysql-error-1064

我正在尝试从特定行的数据更新几行
这是一个单一的表， 我的尝试`ItemNum`是独一无二的：

```
UPDATE myTable t, (SELECT DISTINCT width, repeat
            FROM myTable
            WHERE ItemNum='80644') t1
SET t.width = t1.width
AND SET t.repeat = t1.repeat
WHERE ItemNum='80645'
AND WHERE ItemNum='80646' 
```

`#1064 - You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'FROM myTable WHERE ItemNum='80644') t1 SET t.width' at line 2`

当我为单行运行它时给我一个错误，
但多行的语法似乎是问题

```
UPDATE myTable t, (SELECT DISTINCT width
  FROM myTable
  WHERE ItemNum='80644') t1
SET t.width = t1.width
WHERE ItemNum='80645' 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T18:50:45.700

应该可以，但是如果 itemnum=80644 的行不止一行，它就不会给出可靠的结果

```
UPDATE myTable t
join
    (SELECT DISTINCT width, repeat
            FROM myTable
            WHERE ItemNum='80644') t1
    on t.ItemNum in ('80645','80646')
SET
    t.width = t1.width,
    t.repeat = t1.repeat 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-06T18:54:04.073

```
UPDATE t
SET t.width = t1.width
AND SET t.repeat = t1.repeat
FROM  myTable t INNER JOIN  (SELECT DISTINCT width, repeat
            FROM myTable
            WHERE ItemNum='80644') t1
ON ItemNum in ('80645' 
```

,'80646')

update 语句只能有一个表名，它必须更新的表

支持表可以在join中指定，方便更新语句

# php - 如何将额外的变量传递给可排序的 Jquery UI

> ID：11833992
> 
> 赞同：1
> 
> 时间：2012-08-06T18:42:45.533
> 
> 标签：php, jquery, jquery-ui, variables

我有一个包含多个 jquery 可排序列表的页面，每个列表都有一个 sp_id，我如何将它传递给我的脚本？

```
 <script type="text/javascript">

$(function() {
    $(".sortable").sortable({ opacity: 0.6, cursor: 'move', update: function() {
        var order = $(this).sortable("serialize", "placeholder") + '&action=updateRecordsListings&sp_id=' + ???;            
     $.post("updatedb.php", order, function(order) {
          alert(order);
        });
        }
    });
}); 
```

我猜我应该在每个可排序的 ul 中放置一个 sp_id 字段

```
 <ul class="sortable"
-- ?? Some field with the sp_id ?? -- 
 <li class="ui-state-default">Item 1</li>
<li class="ui-state-default">Item 2</li>
 </ul> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T18:55:16.943

```
var variable_to_pass = 45;
$('.sortable').attr('spid', variable_to_pass); 
```

将其放入准备好的文档中还是单击功能？或者，如果您渲染包含 .sortable 元素的 HTML，只需将其添加到 ul。猜猜这一切都取决于你如何使用什么，从什么目的开始。

```
<ul class="sortable" spid="<?php echo $myvariable; ?>"> 
```

获取通过 jQuery 发布的值..

```
var myVar = $('.sortable').attr('spid'); 
```

或者，您也可以在加载时获取每个索引并将它们附加到类似于 LI 的。

```
$('.sortable li').each(function(){
    $(this).attr('spid', $(this).index());
} 
```

然后，当您发布到您的 ajax 时，您在所有这些上运行类似的函数以获取所有 spid 值。如果你让它变得非常复杂希望它有所帮助

# c# - DataNavigateUrlFields 导航到子文件夹而不是正确的位置。

> ID：11833993
> 
> 赞同：0
> 
> 时间：2012-08-06T18:42:48.383
> 
> 标签：c#, asp.net, datagrid

我有一个数据网格，它需要一个字段来超链接到另一台服务器上的文档。路径是这种格式：`\\server\location\file.doc`，但是当我单击数据网格中的单元格时，它变成：`http://myASPServer/Subfolder/server/location.file.doc`。有什么办法可以强制它转到正确的位置吗？我知道您可以通过添加 ftp:// 或 http:// 来防止外部网站出现这种情况，但这似乎不适用于打开此服务器位置。有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T19:07:49.573

我相信您的答案可以在 asp.net 论坛[http://forums.asp.net/t/1140909.aspx/1](http://forums.asp.net/t/1140909.aspx/1)上找到- 为方便起见，请从下面接受答案。

```
<Columns>
<asp:TemplateField>
<ItemTemplate>
<asp:HyperLink Text="TextField" id="myHL" runat="server"
 NavigateUrl='<%# "file:///" + DataBinder.Eval(Container.DataItem, "Path").ToString() %>'></asp:HyperLink>
</ItemTemplate>
</asp:TemplateField>
</Columns> 
```

我相信你需要为你的链接加上前缀，`file:///`因为它会是`file:///\\server\location\file.doc`

# html - PNG图像在IE7中失真

> ID：11833995
> 
> 赞同：1
> 
> 时间：2012-08-06T18:42:58.747
> 
> 标签：html, css, internet-explorer-7, png

我正在建立一个几乎完整的网站。我遇到的问题是 IE7 和显示的图像看起来非常扭曲/泥泞。

首先它在我测试的所有其他浏览器中的外观，包括 IE8。

由于新帐户的链接限制而被删除

然后是来自 IE7 的泥泞的

[浑浊/扭曲的图像](http://www.freeimagehosting.net/mxygy)

在进行了一些谷歌搜索之后，它看起来与 IE7 上 PNG 图像中的像素透明度有关。

首先，我尝试在实际背景文件中设置纯色背景颜色。这不起作用，因为图像仍然非常泥泞和扭曲。

接下来，我尝试指定固定的宽度和高度，但结果仍然相同。不知道此时还可以尝试什么。

我愿意尝试的任何建议。

这是与元素有关的代码。

```
.feature {
    padding-top:10px;
    border-top:solid 1px #ccc;
    width:440px;
    margin:0 auto;
    padding-bottom:5px;
}
.featureimg {
    float:left;
    width:190px;
}
.featureimg img {
    max-height:90px;
    max-width:190px;
    vertical-align:middle;
}
.featuretext {
    float:right;
    text-align:left;
    width:250px;
}
<div class="feature">
    <div class="featureimg">
        <img src="images/certipur.png" alt="" />
    </div>
    <div class="featuretext">
        <div class="featurehead red">
            Sealed with comfort and confidence
        </div>
        <p>
            TEXT BLOCK
        </p>
    </div>
    <div class="clear">
    </div>
 </div> 
```

这是原始文件的链接[http://imgur.com/z2SoV](http://imgur.com/z2SoV)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-21T16:19:25.713

如果您仍然关心：http: [//imgur.com/9H9nFHe](http://imgur.com/9H9nFHe)

我尝试使用 BrowserStack.com 使用 IE7 检查图像，它看起来一点也不泥泞。我猜它是你的虚拟机显示设置，但我认为它显示得非常好。:)

# javascript - Javascript 函数范围概念

> ID：11833996
> 
> 赞同：2
> 
> 时间：2012-08-06T18:42:59.607
> 
> 标签：javascript

我正在阅读这本书“Javascript Ninja 的秘密”，其中大部分代码都使用自定义断言进行了演示。代码如下：

```
(function () {
    var queue = [],
        paused = false,
        results;

    this.test = function test(name, fn) {
        queue.push(function () {
            results = document.getElementById("results");
            results = assert(true, name).appendChild(
            document.createElement("ul"));
            fn();
        });
        runTest();
    };

    this.pause = function () {
        paused = true;
    };

    this.resume = function () {
        paused = false;
        setTimeout(runTest, 1);
    };

    function runTest() {
        if (!paused && queue.length) {
            queue.shift()();
            if (!paused) {
                resume();
            }
        }
    }

    this.assert = function assert(value, desc) {
        var li = document.createElement("li");
        li.className = value ? "pass" : "fail";
        li.appendChild(document.createTextNode(desc));

        if (results === undefined) results = document.getElementById("results");

        results.appendChild(li);

        if (!value) li.parentNode.parentNode.className = "fail";

        return li;
    };
})(); 
```

如您所见，这是一个自调用函数。

我一直在玩它，我无法理解的是为什么如果在相同的标签之间，我这样做：

```
<script type="text/javascript">

    ... previously shown code ...

    window.onload = function(){
       assert(true, "this works");
    };

</script> 
```

如果我只是这样断言：

```
<script type="text/javascript">

    ... previously shown code ...
    assert(true, "this does not work");

</script> 
```

当我尝试在不使用 window.onload 事件的情况下执行断言时，我在断言方法的“results.appendChild(li)”行上收到错误“Uncaught TypeError: Cannot call method 'appendChild' to null”。

非常感谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T18:46:12.177

因为您在呈现页面上的元素之前调用代码。因此，当代码查找时，`document.getElementById("results")`它什么也没找到并返回 null。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T18:46:34.590

元素标记（with `id="results"`）在代码运行时没有被解析，因此尝试使用 return 来获取它`getElementById`，`null`这反过来又会`.appendChild`导致失败。

当您将代码放入`window.onload`处理程序时，它（处理程序函数中的代码）保证仅在加载窗口后运行，此时文档标记也被完全解析并且元素可用。

或者，您可以简单地将脚本元素放在目标元素之后：

```
<ul id="results"></ul>
<script>
//your code
</script> 
```

因为脚本元素在目标元素之后，所以目标元素在脚本运行时保证存在。