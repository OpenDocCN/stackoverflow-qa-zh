# StackOverflow 问答 10081000-10081999

# javascript - 将 Knockout.js 与第三方控件库一起使用

> ID：10081000
> 
> 赞同：0
> 
> 时间：2012-04-09T23:06:29.330
> 
> 标签：javascript, knockout.js

我正在研究 Knockout.js，它的功能给我留下了深刻的印象。到目前为止，让我陷入困境的一件事是找到一个可以使用它的 JavaScript 控件库。Knockout 网站上的示例似乎只适用于简单的 HTML 控件。

我想使用更多功能丰富的控件，例如 jQuery UI、kendo、Wijmo 或 Telerik 中的控件。我在研究这个时发现了 KOGrid (https://github.com/ericmbarnard/KoGrid/wiki/Getting-Started)。虽然我当然对开发人员的努力表示赞赏，但我正在寻找功能丰富且更成熟的东西。

任何人都可以推荐任何与 Knockout.js 配合良好的第三方控制库（商业或其他）吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-09T23:29:20.853

您可以使它们全部工作，但您必须使用自定义绑定，jqueryUI 已经有一些绑定，对于 Kendo，这里是 kendo UI 绑定的链接[http://www.knockmeout.net/2012/03/knockoutjs -bindings-for-kendo-ui.html](http://www.knockmeout.net/2012/03/knockoutjs-bindings-for-kendo-ui.html)

# c++ - wxWidgets 不可预测的 Seg 错误

> ID：10081002
> 
> 赞同：0
> 
> 时间：2012-04-09T23:07:14.013
> 
> 标签：c++, wxwidgets

我正在编写一个 GUI，它基本上向用户显示图像的子部分并要求输入。但是，我遇到了一个奇怪的问题。当我运行程序时，大约有 40% 的时间会出现 seg 错误。其他 60% 的时间运行良好，输入完全相同。通过主要是打印语句，我设法将段错误缩小到这一行：

```
subImage = image.GetSubImage(wxRect(wxPoint(0, iheight - 800), wxPoint(800, iheight))); 
```

我尝试在 GetSubImage 调用之外声明 wxRect 和 wxPoint 值，但这也不起作用。

这是要显示的图像的子部分不在图像边缘时的特殊情况。这种特殊情况恰好是要显示的第一个此类子部分。Image 是从 wxImage 类型的文件加载的图像。subImage 也是我实际显示的 wxImage。

最让我困惑的是为什么它只在我使用完全相同的输入时才会发生。非常感谢您在哪里开始工作的任何帮助。提前致谢

我的构造函数的整个代码是：

```
wxImagePanel::wxImagePanel(wxPanel* parent, wxString file, wxBitmapType format, int xloc, int yloc, int index, wxImage temp) : wxPanel(parent)
{
image = temp;
x = xloc;
y = yloc;
dIndex = index;
int iheight = image.GetHeight();
int iwidth = image.GetWidth();

if(x - 400 < 0)
{
    if(y - 400 < 0)
    {
        subImage = image.GetSubImage(wxRect(wxPoint(0,0), wxPoint(800,800)));
    }
    else if(y + 400 > iheight)
    {
        //here's the random seg fault
        subImage = image.GetSubImage(wxRect(wxPoint(0, iheight - 800), wxPoint(800, iheight)));
    }
    else
    {

        subImage = image.GetSubImage(wxRect(wxPoint(0,y-400), wxPoint(800, y+400)));
    }
}
else if (y - 400 < 0)
{
    if(x + 400 > iwidth)
    {
        subImage = image.GetSubImage(wxRect(wxPoint(iwidth - 800, 0), wxPoint(iwidth, 800)));
    }
    else
    {
        subImage = image.GetSubImage(wxRect(wxPoint(x-400,0),wxPoint(x+400,800)));
    }
}
else if((x + 400 < iwidth) && (y + 400 < iheight))
{
    subImage = image.GetSubImage(wxRect(wxPoint(x-400,y-400),wxPoint(x+400,y+400)));
}
else if(x + 400 > iwidth)
{
    if(y + 400 > iheight)
    {
        subImage = image.GetSubImage(wxRect(wxPoint(iwidth - 800, iheight - 800), wxPoint(iwidth, iheight)));
    }
    else
    {
        subImage = image.GetSubImage(wxRect(wxPoint(iwidth - 800, y-400), wxPoint(iwidth,y + 400)));
    }
}
else
{
    subImage = image.GetSubImage(wxRect(wxPoint(x - 400, iheight - 800),wxPoint(x + 400,iheight)));
}
w = -1;
h = -1; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T09:51:16.880

据我了解，子图像跨越图像之外？我不能告诉你特定问题的解决方案，但是当你使用 wxWidgets 时，我可以给你两个一般性建议：

*   在 wx-users 邮件列表中提出您的问题，他们有很好的支持，核心开发人员很有可能会回答您的问题。
*   源代码是你的朋友。wxWidgets 的代码非常干净，结构良好，易于阅读。因此，您可以尝试使用 wxWidgets 的调试版本进行构建，并在调试器下运行您的应用程序以查看发生了什么。当您的应用程序在调试器中崩溃时，您将看到 wxWidgets 代码中崩溃的位置，并且您可以看到发生了什么。

# android - 带有许多小图像的游戏中的 OutOfMemoryError

> ID：10081008
> 
> 赞同：1
> 
> 时间：2012-04-09T23:08:05.117
> 
> 标签：android, memory, bitmap

我正在为安卓开发一款纸牌游戏。当我尝试加载一些图像时出现 OutOfMemoryError。我已经阅读了很多关于 android 中这个常见和常见问题的答案，但是当要加载的图像非常大时，它们都会处理。我自己管理屏幕旋转，所以我不会重新启动新的旋转活动。我已经读过这个问题：

[由于大位图大小导致内存不足异常](https://stackoverflow.com/questions/5321579/out-of-memory-exception-due-to-large-bitmap-size)

[Android：图库中的内存不足异常](https://stackoverflow.com/questions/3238388/android-out-of-memory-exception-in-gallery)

[Android处理图像处理内存不足异常](https://stackoverflow.com/questions/3724082/android-handling-out-of-memory-exception-on-image-processing)

我不明白的一件事是，如果我在 res 文件夹中的所有图像（png 文件）的大小总和约为 800 kb。但在 Logcat 中，我注意到创建游戏（加载卡图像）的大小迅速超过 20 mb。我使用：此代码加载图像

```
Resources r = this.getContext().getResources();
CardView.loadCardImages(CardView.EAlone.CARDS, 1027, 615, r.getDrawable(R.drawable.cards));
CardView.loadCardImages(CardView.EAlone.GREEN, mCardWidth, mCardHeight, r.getDrawable(R.drawable.green));
CardView.loadCardImages(CardView.EAlone.RED, mCardWidth, mCardHeight, r.getDrawable(R.drawable.red));
CardView.loadCardImages(CardView.EAlone.WHITE, mCardWidth, mCardHeight, r.getDrawable(R.drawable.white)); 
```

CardView.LoadCardImages：

```
public static void loadCardImages(EAlone mode, int widthPixels, int heightPixels, Drawable tile) {

    Canvas canvas;
    switch (mode)
    {
    case GREEN:
        mAloneGreen = Bitmap.createBitmap(widthPixels, heightPixels, Bitmap.Config.ARGB_8888);
        canvas = new Canvas(mAloneGreen);
        break;
    case RED:
        mAloneRed = Bitmap.createBitmap(widthPixels, heightPixels, Bitmap.Config.ARGB_8888);
        canvas = new Canvas(mAloneRed);
        break;
    case WHITE:
        mAloneWhite = Bitmap.createBitmap(widthPixels, heightPixels, Bitmap.Config.ARGB_8888);
        canvas = new Canvas(mAloneWhite);
        break;
    default:
        mcardImages = Bitmap.createBitmap(widthPixels, heightPixels, Bitmap.Config.ARGB_8888);
        canvas = new Canvas(mcardImages);
    }
    tile.setBounds(0, 0, widthPixels, heightPixels);
    tile.draw(canvas);
    tile.setCallback(null);
} 
```

mCardimages 包含所有卡片面。然后我使用此文件通过从文件中裁剪所需的卡片来创建单张卡片。加载后，我加载了一些在我的父视图中具有透明度的其他图像。

```
dealerSign = new ImageView(getContext());
dealerSign.setImageResource(R.drawable.dealer);
dealerSign.setAdjustViewBounds(true);
dealerSign.setLayoutParams(new Gallery.LayoutParams(
LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT)); 
```

我在 setImageResource 行收到错误。

```
04-09 22:04:37.226: E/AndroidRuntime(722): FATAL EXCEPTION: main
04-09 22:04:37.226: E/AndroidRuntime(722): java.lang.OutOfMemoryError
04-09 22:04:37.226: E/AndroidRuntime(722):  at    android.graphics.Bitmap.nativeCreate(Native Method)
04-09 22:04:37.226: E/AndroidRuntime(722):  at    android.graphics.Bitmap.createBitmap(Bitmap.java:605)
04-09 22:04:37.226: E/AndroidRuntime(722):  at android.graphics.Bitmap.createBitmap(Bitmap.java:551)
04-09 22:04:37.226: E/AndroidRuntime(722):  at android.graphics.Bitmap.createScaledBitmap(Bitmap.java:437)
04-09 22:04:37.226: E/AndroidRuntime(722):  at android.graphics.BitmapFactory.finishDecode(BitmapFactory.java:524)
04-09 22:04:37.226: E/AndroidRuntime(722):  at android.graphics.BitmapFactory.decodeStream(BitmapFactory.java:499)
04-09 22:04:37.226: E/AndroidRuntime(722):  at android.graphics.BitmapFactory.decodeResourceStream(BitmapFactory.java:351)
04-09 22:04:37.226: E/AndroidRuntime(722):  at android.graphics.drawable.Drawable.createFromResourceStream(Drawable.java:767)
04-09 22:04:37.226: E/AndroidRuntime(722):  at android.content.res.Resources.loadDrawable(Resources.java:1937)
04-09 22:04:37.226: E/AndroidRuntime(722):  at android.content.res.Resources.getDrawable(Resources.java:664)
04-09 22:04:37.226: E/AndroidRuntime(722):  at android.widget.ImageView.resolveUri(ImageView.java:537)
04-09 22:04:37.226: E/AndroidRuntime(722):  at android.widget.ImageView.setImageResource(ImageView.java:310)
04-09 22:04:37.226: E/AndroidRuntime(722):  at game.spathi.GameView.init(GameView.java:261)
04-09 22:04:37.226: E/AndroidRuntime(722):  at game.spathi.Game.onCreate(Game.java:92)
... 
```

我在这里做错了什么？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-10T09:26:16.127

尝试一下 -

```
Bitmap yourBitmap;      
ByteArrayOutputStream baos = new ByteArrayOutputStream();

offerImage.compress(Bitmap.CompressFormat.PNG, 0, baos);
byte[] img = shrinkBitmap(baos.toByteArray());

//convert this byte image to bitmap and load it...

private byte[] shrinkBitmap(byte[] data){
    BitmapFactory.Options options = new BitmapFactory.Options();
    options.inSampleSize = 2; //try to decrease decoded image
    options.inPurgeable = true; //purgeable to disk
    Bitmap bitmap = Bitmap.createScaledBitmap(BitmapFactory.decodeByteArray(data, 0, data.length, options), 100, 100, true);
    ByteArrayOutputStream buf = new ByteArrayOutputStream();
    bitmap.compress(CompressFormat.JPEG, 20, buf);

    return(buf.toByteArray());
} 
```

# c++ - SDL_BlitSurface() 无效

> ID：10081012
> 
> 赞同：0
> 
> 时间：2012-04-09T23:08:39.843
> 
> 标签：c++, sdl

我正在开发一款游戏，但我似乎根本无法在屏幕上画画。当我调用 SDL_BlitSurface 时，什么也没有发生。但是，它不会返回错误代码。我编写了一个类来处理图像精灵，当我使用调试器单步执行时，我看到它正在返回非空值，以使表面闪烁到主视频表面。然而，当我调用我的绘图函数时，它什么也没做。我已经确认表面的像素值根本没有改变。我究竟做错了什么？

这是我的 main.cpp：

```
//Standard libs
#include <SDL.h>

//Our gaming base
#include "game_base.h"

//SDL redefines main as winmain, but this is a console application so we don't want that
#undef main

const int MAX_FPS = 80;

int main ( int argc, char* argv[] ) {
    //Initialization
    System game( false, 640, 480, "Platformer", MAX_FPS ); //Create a game that is not fullscreen with a resolution of 640x480
    SDL_Surface *buffer = NULL;
    Input *input = NULL;
    buffer = game.get_buffer();
    Image_Sprite *player_sprite = NULL;
    player_sprite = new Image_Sprite( "data/player.bmp", 1, 4 );
    SDL_Rect hitbox;
    hitbox.w = 32;
    hitbox.h = 32;
    hitbox.x = 0;
    hitbox.y = 0;
    Player player( 100, 100, hitbox, 1.0, RIGHT, player_sprite );
    //Main game loop
    while( !game.check_is_done() ) {
        game.refresh_top();
        player.draw( buffer );
        game.refresh_bottom();
    }

    //Cleanup
    delete input;
    delete player_sprite;
} 
```

这是我正在使用的绘图功能：

```
void Character::draw( SDL_Surface *destination ) {
    SDL_Rect coordinates;
    SDL_Surface *sprite;
    sprite = my_sprite->get_frame( my_frame, my_direction );
    coordinates.x = (int)get_x();
    coordinates.y = (int)get_y();

    SDL_BlitSurface( sprite, NULL, destination, NULL );
} 
```

最后，这里是 ny get_frame() 函数：

```
SDL_Surface* Image_Sprite::get_frame( int x, int y ) {
    SDL_PixelFormat *format;
    format = my_sprite->format;
    SDL_Surface *frame = SDL_CreateRGBSurface( my_sprite->flags, my_frame_width, my_frame_height, format->BitsPerPixel,
                                                    format->Rmask, format->Gmask, format->Bmask, format->Amask );
    SDL_Rect *frame_crop = new SDL_Rect;
    frame_crop->x = my_frame_width * x;
    frame_crop->y = my_frame_height * y;
    frame_crop->w = my_frame_width;
    frame_crop->h = my_frame_height;

    SDL_Rect *coordinates = new SDL_Rect;
    coordinates->x = 0;
    coordinates->y = 0;

    SDL_BlitSurface( my_sprite, frame_crop, frame, coordinates );
    delete frame_crop;
    return frame;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T14:05:48.743

好吧，我想通了。我忘记初始化 my_direction，所以精灵正在裁剪一个无意义的位置。最后我得到了一个 32x32 黑色的图像，然后我将其粘贴到黑色表面上，使其不可见。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T23:27:41.447

您需要使用`SDL_Flip()`每帧功能来使对视频表面的更改可见。该函数的参数是指向窗口的 SDL_Surface 的指针。

# javascript - Javascript 需要正则表达式指导

> ID：10081013
> 
> 赞同：5
> 
> 时间：2012-04-09T23:08:41.877
> 
> 标签：javascript, regex

在以下输入字符串中：

```
{$foo}foo bar \\{$blah1}oh{$blah2} even more{$blah3} but not{$blarg}{$why_not_me} 
```

我正在尝试匹配所有`{$SOMETHING_HERE}`前面没有未转义反斜杠的实例。

**例子：**

我希望它匹配`{$SOMETHING}`但不匹配`\{$SOMETHING}`。

但我确实希望它匹配`\\{$SOMETHING}`

**尝试：**

到目前为止，我所有的尝试都将符合我想要的，除了标签彼此相邻，比如`{$SOMETHING}{$SOMETHING_ELSE}`

这是我目前拥有的：

```
var input = '{$foo}foo bar \\{$blah1}oh{$blah2} even more{$blah3} but not{$blarg}{$why_not_me}';
var results = input.match(/(?:[^\\]|^)\{\$[a-zA-Z_][a-zA-Z0-9_]*\}/g);
console.log(results); 
```

哪个输出：

```
["{$foo}", "h{$blah2}", "e{$blah3}", "t{$blarg}"] 
```

**目标**

我希望它是：

```
["{$foo}", "{$blah2}", "{$blah3}", "{$blarg}", "{$why_not_me}"] 
```

**问题**

谁能指出我正确的方向？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T23:28:20.513

这里的问题是你需要一个lookbehind，这是JavaScript Regexs不支持的

基本上你需要 "${whatever} 如果它前面有一个双斜杠而不是一个单斜杠"，这就是后向所做的。

您可以模仿后视的简单案例，但不确定它是否对本示例有所帮助。试一试：http: [//blog.stevenlevithan.com/archives/mimic-lookbehind-javascript](http://blog.stevenlevithan.com/archives/mimic-lookbehind-javascript)

**编辑** 顺便说一句，我认为您也不能以“愚蠢的方式”执行此操作，因为如果您有`[^\\]\{`，您将匹配大括号前不是反斜杠的任何字符。你真的需要向后看才能干净地做到这一点。

否则你可以做

```
(\\*{\$[a-zA-Z_][a-zA-Z0-9_]*\}) 
```

然后只需计算生成的标记中的反斜杠数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T01:32:01.000

当所有其他方法都失败时，拆分，加入/替换其中的废话。

注意：第一个拆分/连接实际上是清理部分。这会杀死 \{<*>}

另外，我没有考虑括号内的内容，因为已经有代码了。

```
var input = '{$foo}foo bar \\{$blah1}oh{$blah2} even more\\\\{$blah3} but not{$blarg}{$why_not_me}';

input.split(/(?:[^\\])\\\{[^\}]*\}/).join('').replace(/\}[^\{]*\{/g,'},{').split(/,/)); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-09T23:43:29.080

这似乎做我想要的：

```
var input = '{$foo}foo bar \\{$blah1}oh{$blah2} even more\\\\{$blah3} but not{$blarg}{$why_not_me}';

var results = [];
input.replace(/(\\*)\{\$[a-z_][a-z0-9_]*\}/g, function($0,$1){
    $0 = $0.replace(/^\\\\/g,'');
    var result = ($0.indexOf('\\') === 0 ? false : $0); 

    if(result) {
        results.push(result);
    }
})

console.log(results); 
```

这使：

```
["{$foo}", "{$blah2}", "{$blah3}", "{$blarg}", "{$why_not_me}"] 
```

# objective-c - MGTwitterEngine 发送转推不起作用

> ID：10081021
> 
> 赞同：1
> 
> 时间：2012-04-09T23:10:03.283
> 
> 标签：objective-c, mgtwitterengine

我正在使用 MGTwitterEngine。我发现[这篇](https://stackoverflow.com/questions/2528741/how-to-do-a-retweet-on-an-iphone-twitter-app-mgtwitterengine)文章显示了对当前版本的 MGTwitterEngine 的修改。

我已经应用了这个修改，当我执行该方法时返回：

```
2012-04-10 01:04:17.908 Otsuka On[27519:707] INFO -> retweet response: 07695198-2526-4FF4-BC46-8D39F7719836 
```

但在 Twitter 帐户的时间线中什么也没有发生。

添加到 TwitterEngine 的方法是：

```
- (NSString *)sendRetweet:(unsigned long)updateID
{
    if (updateID == 0){
        return nil;
    }
    NSString *path = [NSString stringWithFormat:@"statuses/retweet/%u.%@", updateID, API_FORMAT];

    NSMutableDictionary *params = [NSMutableDictionary dictionaryWithCapacity:0];
    [params setObject:[NSString stringWithFormat:@"%u", updateID] forKey:@"id"];
    NSString *body = [self _queryStringWithBase:nil parameters:params prefixed:NO];

    return [self _sendRequestWithMethod:HTTP_POST_METHOD path:path 

                        queryParameters:params body:body 
                            requestType:MGTwitterUpdateSendRequest
                           responseType:MGTwitterStatus];
} 
```

有人知道我在做什么错吗？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-10T08:31:40.490

我使用以下方法，它对我有用：

```
- (NSString *)sendRetweet:(MGTwitterEngineID)tweetID {    
    NSString *path = [NSString stringWithFormat:@"statuses/retweet/%llu.%@", tweetID,     API_FORMAT];

    return [self _sendRequestWithMethod:HTTP_POST_METHOD path:path 
                        queryParameters:nil body:nil 
                            requestType:MGTwitterRetweetSendRequest
                           responseType:MGTwitterStatus]; 
```

}

更新：是的，尝试使用这个分支：github.com/mattgemmell/MGTwitterEngine

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-16T11:36:13.953

最后，我使用 NSString 参数作为 updateID 解决了这个问题：

```
- (NSString *)sendRetweet:(NSString *)updateID
{

    NSString *path = [NSString stringWithFormat:@"statuses/retweet/%@.%@", updateID, API_FORMAT];

    NSMutableDictionary *params = [NSMutableDictionary dictionaryWithCapacity:0];
    [params setObject:[NSString stringWithFormat:@"%@", updateID] forKey:@"id"];
    NSString *body = [self _queryStringWithBase:nil parameters:params prefixed:NO];

    return [self _sendRequestWithMethod:HTTP_POST_METHOD path:path 

                        queryParameters:params body:body 
                            requestType:MGTwitterUpdateSendRequest
                           responseType:MGTwitterStatus];
} 
```

# excel - 如果两个电子邮件（列）值都匹配，则需要宏/函数/公式来替换一个 Excel 工作表的值

> ID：10081025
> 
> 赞同：0
> 
> 时间：2012-04-09T23:10:24.717
> 
> 标签：excel, excel-formula, excel-2007, vba

我有 2 个 Excel 2007 工作表。

Excel 工作表 1：（如下） 3 列在工作表 1 中很重要

```
userid   name   email

100      sam    sam@sam.com
200      pete   pete@pete.com
300      Bum    Bum@Bum.com 
400      Harry  Harry@Harry.com 
```

工作表 2：（如下）（user_id 列全部为空）

```
userid   name   email

         sam    sam@sam.com
         Harry  Harry@Harry.com 
         pete   pete@pete.com
         Bum    Bum@Bum.com 
```

我需要一个带有宏的函数/论坛，我可以在其中填充工作表 2 中的用户 ID 值，其中工作表 2 电子邮件 = 工作表 1 电子邮件

这将在工作表 2 中产生以下结果

```
userid   name   email

100      sam    sam@sam.com
400      Harry  Harry@Harry.com 
200      pete   pete@pete.com
300      Bum    Bum@Bum.com 
```

我知道 SQL，但查询在 MySQL DB 上需要很长时间才能得到结果......无论如何，下面是我在 DB 中使用的 SQL 查询。

```
UPDATE  `j_A` 
SET user_id =   ( SELECT j_B.id
FROM j_B
WHERE j_B.email =  j_A.email)
WHERE EXISTS
  ( SELECT j_B.id
    FROM j_B
    WHERE j_B.email =  j_A.email); 
```

如果两个电子邮件（列）值都匹配，需要宏/函数/公式来替换一个 Excel 工作表的值，如果有人 cud 帮助我创建宏/公式/函数等...因为没有太多的创建公式的知识Excel 宏..

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T00:39:03.343

根据您的示例，尝试：

```
Sub HTH
    With Sheet2.Range("A2:A" & Sheet2.Cells(Rows.Count, 2).End(xlUp).Row)
        .Formula = Replace("=LOOKUP(2,1/(Sheet1!C$2:C$x=C2)/(Sheet1!B$2:B$x=B2),Sheet1!A$2:A$x)", _
            "x", (Sheet1.UsedRange.Rows.Count - 1))
        .Value = .Value
    End With
End Sub 
```

更新 SQL 查询可能会更有效。

要打开 VBA 编辑器，请按 Alt-F11。

这是带有代码示例的VBA编辑器中的代码截图，点击绿色播放按钮运行代码：

![在此处输入图像描述](../Images/e7760018d4190f9c1149df663fcd6001.png)

根据您可能想尝试此替代过程的附加信息：

```
Sub HTH2()
    Dim vSource As Variant
    Dim vOutput As Variant
    Dim sKey As String

    vSource = Sheet1.UsedRange.Resize(, 3).Value
    vOutput = Sheet2.UsedRange.Resize(, 3).Value

    With CreateObject("Scripting.Dictionary")
        For lloop = 1 To UBound(vSource, 1)
            .Add vSource(lloop, 2) & ":" & vSource(lloop, 3), vSource(lloop, 1)
        Next lloop

        For lloop = 1 To UBound(vOutput, 1)
            sKey = vOutput(lloop, 2) & ":" & vOutput(lloop, 3)
            If .exists(sKey) Then
                vOutput(lloop, 1) = .Item(sKey)
            Else
                vOutput(lloop, 1) = ""
            End If
        Next lloop
    End With

    Sheet2.Range("A1").Resize(UBound(vOutput, 1), 1).Value = vOutput

End Sub 
```

# c++ - 继承基类有问题

> ID：10081027
> 
> 赞同：0
> 
> 时间：2012-04-09T23:10:45.373
> 
> 标签：c++, inheritance

当我继承基类时，它告诉我没有这样的类

这是增强的.h：

```
 class enhanced: public changeDispenser // <--------where error is occuring
    {
    public:
        void changeStatus();
        // Function: Lets the user know how much of each coin is in the machine
        enhanced(int);
        // Constructor
        // Sets the Dollar amount to what the User wants
        void changeLoad(int);
        // Function: Loads what change the user requests into the Coin Machine
        int dispenseChange(int);
        // Function: Takes the users amount of cents requests and dispenses it to the user

    private:
        int dollar;
    }; 
```

这是增强的.cpp：

```
#include "enhanced.h"
#include <iostream>
using namespace std;
enhanced::enhanced(int dol)
{
    dollar = dol;
}

void enhanced::changeStatus()
{
    cout << dollar << " dollars, ";
    changeDispenser::changeStatus();
}

void enhanced::changeLoad(int d)
{
    dollar = dollar + d;
    //changeDispenser::changeLoad;
} 
```

这是changeDispenser.h：

```
class changeDispenser
{
public:
    void changeStatus();
    // Function: Lets the user know how much of each coin is in the machine
    changeDispenser(int, int, int, int);
    // Constructor
    // Sets the Quarters, Dimes, Nickels, and Pennies to what the User wants
    void changeLoad(int, int, int, int);
    // Function: Loads what change the user requests into the Coin Machine
    int dispenseChange(int);
    // Function: Takes the users amount of cents requests and dispenses it to the user
private:
    int quarter;
    int dime;
    int nickel;
    int penny;
}; 
```

我没有包含驱动程序文件或 changeDispenser imp 文件，但在驱动程序中，这些已包含

```
#include "changeDispenser.h"
#include "enhanced.h" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T23:15:06.723

首先，您需要将类`changeDispenser`的头文件放在单独的头文件中，并将其包含在派生类头文件中。

该类`changeDispenser`没有默认的非参数构造函数，因此您需要在派生类中显式初始化它。类似的东西：

```
enhanced::enhanced(int dol) : changeDispenser(0, 0, 0, 0)
{
    dollar = dol;
} 
```

或者您可以为构造函数参数定义默认值，出于文体原因，这不太可取。

```
changeDispenser(int i=0, int j=0, int k=0, int l=0); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T23:15:26.350

如果您发布的源代码正确显示了组成这组类的三个文件（enhanced.h、enhanced.cpp (?)、changeDispencer.h），那么您应该添加

```
#include "changeDispenser.h" 
```

到“enhanced.h”的顶部，以始终确保`changeDispenser`当您的代码的某些部分包含`enhanced`（来自“enhanced.h”）的定义时，该定义是可用的。要子类化一个类，基类的完整定义必须始终可用。

# qt - Qt：在编辑 QTableView 项目数据时而不是在编辑完成后发出信号？

> ID：10081033
> 
> 赞同：1
> 
> 时间：2012-04-09T23:11:56.930
> 
> 标签：qt, qtableview, qabstracttablemodel

我有一个 QTableView，它的模型中有一些基于 QString 的项目。我在我的表模型中实现了 setData，所以编辑工作正常（我可以更改单元格中的数据，调用 setData 来更新模型，并且表已正确更新）。

当前 setData 仅在用户完成编辑时调用，例如在他们按 Enter 或单击文本输入框以完成文本输入之后。我想在用户在文本编辑控件中键入/编辑时更新表格的其他其他部分，而不是在他们完成并且编辑的内容最终确定之后。

我想要的一个简单示例是下一个表格单元格显示已在正在编辑的单元格中输入了多少字符的计数，但是要在用户键入/编辑单元格内容时执行此操作，而不仅仅是在之后编辑完成并调用 setData。

任何指向我应该寻找的东西？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T00:05:04.707

您可以`QStyledItemDelegate`在发生更改时对数据进行子类化和提交，然后使用`QAbstractItemView::setItemDelegate`.

```
class MyDelegate : public QStyledItemDelegate {
   QSignalMapper *mapper;
public:
   MyDelegate(QObject*parent = 0)
     : QStyledItemDelegate(parent)
     , mapper(new QSignalMapper(this))
   {
       connect(mapper, SIGNAL(mapped(QWidget*)), SIGNAL(commitData(QWidget*)));
   }
   QWidget * createEditor(QWidget * parent, const QStyleOptionViewItem & option,
             const QModelIndex & index ) const
   {
       QWidget *editor = QStyledItemDelegate::createEditor(parent, option, index);
       if(qobject_cast<QLineEdit*>(editor)) {
           connect(editor, SIGNAL(textChanged(QString)), mapper, SLOT(map()));
           mapper->setMapping(editor, editor);
       }
       return editor;
   }
}; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-03-11T14:06:09.460

当我需要一个由`QAbstractTableModel::setPersistentEditor(QModelIndex())`.

下面解决了这个问题：

```
class Delegate : public QStyledItemDelegate 
{
    Q_OBJECT
public: 

    // ... omitted for brevity

    QWidget *createEditor(QWidget *parent, const QStyleOptionViewItem &option,
                          const QModelIndex &index) const override 
    {
        auto *editor = static_cast<QLineEdit*>(
                            QStyledItemDelegate::createEditor(parent, option, index));
        if (editor) {
            connect(editor,
                    &QLineEdit::textChanged,
                    [=] (const QString &)
            {
                const_cast<Delegate*>(this)->commitData(editor);
            });
        }
        return editor;   
    }

    // ... omitted for brevity
}; 
```

我们只是简单地从 constness 中转换`this`并使其为编辑器提交数据。

请注意，在 lambda 中，我们`editor`按值捕获变量，否则，当函数超出范围时`[=]`，使用引用捕获会使 undefined 的值。`editor`

# php - PHP Magic Quotes 在模板文件中添加斜杠？

> ID：10081035
> 
> 赞同：0
> 
> 时间：2012-04-09T23:12:16.400
> 
> 标签：php, magic-quotes

我有一个用于我的网站的默认网站模板，如下所示：

```
<!-- Meta start -->
<title></title>
<meta name="description" content="" />
<meta name="keywords" content="" />
<!-- Meta end -->

<?php
    require_once($sidebar_inc);
?>

<?php
    // main.inc.php
    require_once($main_inc);
?>

<!-- CONTENT START -->
<?php
    // signup.tpl template location
    $tpl = 'inc/tpl/signup.tpl';
    // check if files exists and is readable
    if(file_exists($tpl) && is_readable($tpl)) {
        echo file_get_contents($tpl);
    } else {
        echo 'Template not found';
    }
?>

<!-- CONTENT FINISH -->

<?php
    // footer.inc.php
    require_once($footer_inc);
?> 
```

现在我的问题是，如果`signup.tpl`包含`file_get_contents`魔术引号，则它会添加`"\`到所有表单数据中。

这是`signup.tpl`模板

```
<h1>Sign up</h1>

<p>Welcome to SITE_NAME. To get started, you’ll need an account.</p>

<form action="signup.php" method="post">
    <div class="form_settings">
        <p><span>Name</span><input class="contact" type="text" name="your_name" value="" /></p>
        <p><span>Email Address</span><input class="contact" type="text" name="your_email" value="" /></p>
        <p><span>Message</span><textarea class="contact textarea" rows="8" cols="50" name="your_enquiry"></textarea></p>
        <p style="padding-top: 15px"><span>&nbsp;</span><input class="submit" type="submit" name="contact_submitted" value="submit" /></p>
    </div>
</form> 
```

基本上带有魔术引号时，它看起来像这样`signup.tpl`。

![在此处输入图像描述](../Images/8d21bcea3552921484f73c7ecbb19da3.png)

但是在关闭魔术引号的情况下，它不会添加斜杠，因此它看起来应该：

![在此处输入图像描述](../Images/e453394facfcd9d6b1be1aa2632afa7a.png)

现在我知道你不应该有魔术引号，但是如果魔术引号全部打开，我有一个功能可以去除斜线，`$_GET, $_POST, $_COOKIE, $_SESSION`所以即使魔术引号打开，我的脚本也可以工作。问题是我不知道如何解决我的问题，即如果使用魔术引号，它不会在`signup.tpl`. 我只是想确保我的脚本能够工作，例如，如果我将它移动到一个有魔术引号的服务器上。

我需要做些什么来阻止魔术引号向 signup.tpl 添加斜杠？我知道我可以关闭魔术引号，但就像我说的那样，以防我更改了启用了魔术引号并且不允许关闭魔术引号的服务器。

（忽略表格，它不是仅用作显示问题的示例的注册表单）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T23:16:18.420

有两个魔术引号设置。从手册：

```
; Magic quotes for incoming GET/POST/Cookie data.
magic_quotes_gpc = Off

; Magic quotes for runtime-generated data, e.g. data from SQL, from exec(), etc.
magic_quotes_runtime = Off 
```

Magic-quotes-runtiume 与magic GPC 引用不同——magic-quotes-runtime 发生在运行时的所有输入上，而不仅仅是 GET/POST/COOKIE 全局变量。您需要在脚本开始时禁用此设置：

```
set_magic_quotes_runtime(false); # pre 5.3
ini_set('magic_quotes_runtime', 0); # 5.3 onwards 
```

# php - 调用 SQL 存储过程的 PHP 不会从链接的 SQL Server 返回数据

> ID：10081039
> 
> 赞同：0
> 
> 时间：2012-04-09T23:12:55.993
> 
> 标签：php, sql-server-2005, stored-procedures

我有一个 PHP 网页，它在 server1 上调用 MS SQL 2005 存储过程。在存储过程尝试从不同的链接服务器获取信息之前，一切正常。然后页面停止，程序停止并且什么都没有返回……没有错误，什么都没有。存储过程可以像下面的 select 语句一样简单…… SELECT ITEMNAME FROM SERVER2.DBO.ITEMS 该过程在两台服务器上的 SQL 中正确运行，其凭据与我在 PHP 中使用的凭据相同。

在此先感谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T18:25:53.240

我在以下站点 [http://bomforcastprep/index.php](http://bomforcastprep/index.php)上找到了我的问题的答案 我必须在执行存储过程之前添加以下两行 PHP... $result = mssql_query("SET ANSI_NULLS ON" ) 或死(mssql_get_last_message()); $result = mssql_query("SET ANSI_WARNINGS ON") or die(mssql_get_last_message());

# c# - 多线程错误：已经有一个打开的 DataReader 与此 Connection 关联，必须先关闭

> ID：10081042
> 
> 赞同：6
> 
> 时间：2012-04-09T23:13:56.620
> 
> 标签：c#, mysql, multithreading

我有一个 Parallel.Foreach 循环

```
var options = new ParallelOptions();
options.MaxDegreeOfParallelism = 1;
Parallel.ForEach(urlTable.AsEnumerable(),drow =>
{
    using (var WCC = new MasterCrawlerClass())
    {
        WCC.MasterCrawlBegin(drow);
    }
 } 
```

此循环调用该类并循环遍历我的所有 DataRows，但是这些数据行中的每一个要么执行 DataTable 填充，要么执行对 MySQL DB 的更新命令。我对这两个的代码如下。

```
private static DataTable DTTable(string mysqlQuery, string queryName)
{
    DataTable DTTableTable = new DataTable();
    try
    {
        MySqlDataAdapter DataDTTables = new MySqlDataAdapter(mysqlQuery, MySQLProcessing.MySQLStatic.Connection);
        DataTable DataDTTablesDT = new DataTable();
        DataDTTables.SelectCommand.CommandTimeout = 240000;
        DataDTTables.Fill(DataDTTablesDT);
        DTTableTable = DataDTTablesDT;

    }
    catch (Exception ex)
    {

        GenericLogging("Failed MySQLquery: " + ex.Message.ToString(), "MySQLProcessor", "DTTable", "", "MysqlError", "", queryName, mysqlQuery);

    }
    return DTTableTable;
} 
```

```
private static void MySQLInsertUpdate(string MySQLCommand, string mysqlcommand_name)
{
    try
    {
        MySqlCommand MySQLCommandFunc = new MySqlCommand(MySQLCommand, MySQLProcessing.MySQLStatic.Connection);
        MySQLCommandFunc.CommandTimeout = 240000;
        MySQLCommandFunc.ExecuteNonQuery();
    }
    catch (Exception ex)
    {
        GenericLogging("Failed MySQLquery: " + ex.Message.ToString(), "MySQLProcessor", "DTTable", "", "MysqlError", "", mysqlcommand_name, MySQLCommand);
    }
} 
```

问题是 WCC 包含 10 个左右的空位，每个空位至少访问 MySQL 函数一次。因此，如果锁定是答案，是否可以为所有空隙创建 1 个锁定功能？如果有怎么办？如果有其他方法，请告诉我

谢谢！

好的，按照建议，我合并了问题

代码现已更新以反映锁定，请参见下文。

`static readonly object _object = new object();`

```
公共静态数据表DTTable（字符串mysqlQuery，字符串queryName）
        {
            锁定（_object）
            {
                数据表 DTTableTable = new DataTable();
                尝试
                {
                    使用 (MySqlDataAdapter DataDTTables = new MySqlDataAdapter(mysqlQuery, MySQLProcessing.MySQLStatic.Connection))
                    {
                        使用 (DataTable DataDTTablesDT = new DataTable())
                        {
                            DataDTTables.SelectCommand.CommandTimeout = 240000;
                            DataDTTables.Fill(DataDTTablesDT);
                            DTTableTable = 数据DTTablesDT；
                            数据DTTables.Dispose();
                        }
                    }

                }
                捕捉（例外前）
                {

                    GenericLogging("MySQLquery 失败：" + ex.Message.ToString(), "MySQLProcessor", "DTTable", "", "MysqlError", "", queryName, mysqlQuery);

                }
                返回 DTTableTable；
            }
        }
```

这是唯一调用DataReader的代码，如果有锁怎么会有两个打开的数据读取器？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T00:31:48.030

问题是 ADO.NET 数据提供程序通常不允许每个连接一次打开多个数据读取器。SQL Server 有[多个活动结果集 (MARS)](http://msdn.microsoft.com/en-us/library/h32h3abf%28v=vs.80%29.aspx)的概念，但据我所知 MySQL 还不支持它。

您可能需要指定一个不同的连接，而不是`MySQLProcessing.MySQLStatic.Connection`. 没有什么可以阻止您使用多个连接。这里的问题是连接是昂贵的资源，因此您应该谨慎使用它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T00:35:37.987

您同时使用相同的连接。

你有几个线程？因为似乎 2 个线程使用同一个连接同时进行调用。

# python - pysparse安装ubuntu

> ID：10081048
> 
> 赞同：1
> 
> 时间：2012-04-09T23:15:12.597
> 
> 标签：python, ubuntu, numpy, scientific-computing, sparse-matrix

我在 ubuntu 上安装 pysparse 时遇到问题。我安装了包 python-sparse，但是在运行文档中的示例代码时

```
from pysparse.sparse import spmatrix
from pysparse.direct import superlu
import numpy
n = 100
A = poisson2d_sym_blk(n)
b = numpy.ones(n*n)
x = numpy.empty(n*n)
LU = superlu.factorize(A.to_csr(), diag_pivot_thresh=0.0)
LU.solve(b, x) 
```

我收到错误消息

```
Traceback (most recent call last):
  File "sparse2.py", line 1, in <module>
    from pysparse.sparse import spmatrix
ImportError: No module named sparse 
```

我也试过跑步

```
$ pip install pysparse
Requirement already satisfied: pysparse in /usr/lib/python2.6/dist-packages
Installing collected packages: pysparse
Successfully installed pysparse 
```

为什么文档中的示例代码不起作用？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-21T18:44:09.600

我复制了您在 Ubuntu v11.10 上遇到的错误，您的代码看起来就像 pysparse 网站 ( [http://pysparse.sourceforge.net/fact.html](http://pysparse.sourceforge.net/fact.html) ) 中的示例代码。

可能的原因：

*   该示例很旧，并且自编写示例以来 pysparse 模块布局已更改（很可能）
*   pysparse Ubuntu 包的作者/维护者可能会更改模块布局，从而导致导入路径不同。

当我在模块上运行 dir() 以查看模块的命名空间时，我看不到“稀疏”或“直接”名称，但我确实直接看到了类。

`$> python`

 ``Python 2.7.2+ (default, Jul 20 2012, 22:12:53)`

 ``>>> import pysparse`

 ``>>> dir(pysparse)`

 ``['__builtins__', '__doc__', '__file__', '__name__', '__package__', '__path__', '__version__', 'itsolvers', 'jdsym', 'os', 'precon', 'sparray', 'spmatrix', 'superlu', 'umfpack']`

将您的导入语句更改为：

`from pysparse import spmatrix`

`from pysparse import superlu`

并且测试代码应该可以工作。````

# php - 如果 isset PHP 不工作？

> ID：10081051
> 
> 赞同：1
> 
> 时间：2012-04-09T23:15:32.590
> 
> 标签：php

好的，我正在尝试设置验证码，但是使用此代码，它会中断。

```
if(isset($_POST["captcha"]))
    if($_SESSION["captcha"]==$_POST["captcha"]) 
```

当我没有它时，页面可以工作，但是验证码让不正确的提交通过。

> 解析错误：语法错误，意外的 '"'，在第 71 行的 /hermes/waloraweb085/b2027/moo.lutarinet/jointest.php 中需要 T_STRING 或 T_VARIABLE 或 T_NUM_STRING

```
<?php

$pagetitle = "Home";

$checkrank = 0;

include ($_SERVER['DOCUMENT_ROOT'].'/header.inc.php');

ECHO <<<END

<br><br>

<b><center><i><u>DO NOT</u> USE YOUR NEOPETS PASSWORD OR PIN NUMBER!!!</b></i></center>
<p>
?>

<?php session_start() ?> 
<center><P><FORM ACTION="join.pro.php" enctype="multipart/form-data" METHOD=POST>
   <table width="393" height="188" border="0" cellpadding="0" cellspacing="0">
       <td width="150">Username</td>
       <td width="243"><input type=text name="name" value="" size=32 maxlength=15></td>
     </tr>
     <tr>
       <td>Password</td>
       <td><input type=password name="pass1" VALUE="" maxlength=15></td>
     </tr>
     <tr>
       <td>Confirm Password</td>
       <td><input type=password name="pass2" VALUE="" size=32 maxlength=15></td>
     </tr>
     <tr>
       <td>Security Code (4 Diget Number)</td>
       <td><input type=password name="security" VALUE="" size=32 maxlength=4></td>
     </tr>
     <tr>
       <td>Email Address</td>
       <td><INPUT TYPE=text NAME="email" VALUE="" SIZE=32 maxlength=100></td>
     </tr>
     <tr>
       <td height="41" colspan="2" valign="middle"><p><p><center>
         By registering an account here you agree to all

         of our <A HREF="$baseurl/tos.php">Terms and

       Conditions</A>. You can also view our <A HREF="$baseurl/privacy.php">Privacy

   Policy</A>. 
       </center></p></td>
     </tr>

<tr><td align="center">CAPTCHA:<br>
    (antispam code, 3 black symbols)<br>
    <table><tr><td><img src="captcha.php" alt="captcha image"></td><td><input type="text" name="captcha" size="3" maxlength="3"></td></tr></table>
</td></tr>
<td height="27" colspan="2" valign="middle">
         <center><input type=submit name=Submit value="Register"></center>
       </td>
</table>
</form>
<?php
if(isset($_POST["captcha"]))
if($_SESSION["captcha"]==$_POST["captcha"])
{
    //CAPTHCA is valid; proceed the message: save to database, send by e-mail ...
    echo 'CAPTHCA is valid; proceed the message';
}
else
{
    echo 'CAPTHCA is not valid; ignore submission';
}
?>

<?php

END;

include ($_SERVER['DOCUMENT_ROOT'].'/footer.inc.php');

?> 
```

验证码.php

```
<?php
session_start();
header("Expires: Mon, 26 Jul 1997 05:00:00 GMT"); 
header("Last-Modified: " . gmdate("D, d M Y H:i:s") . " GMT"); 
header("Cache-Control: no-store, no-cache, must-revalidate"); 
header("Cache-Control: post-check=0, pre-check=0", false);
header("Pragma: no-cache"); 

function _generateRandom($length=6)
{
    $_rand_src = array(
        array(48,57) //digits
        , array(97,122) //lowercase chars
//      , array(65,90) //uppercase chars
    );
    srand ((double) microtime() * 1000000);
    $random_string = "";
    for($i=0;$i<$length;$i++){
        $i1=rand(0,sizeof($_rand_src)-1);
        $random_string .= chr(rand($_rand_src[$i1][0],$_rand_src[$i1][1]));
    }
    return $random_string;
}

$im = @imagecreatefromjpeg("http://sketchedneo.com/images/sitedesigns/captcha.jpg"); 
$rand = _generateRandom(3);
$_SESSION['captcha'] = $rand;
ImageString($im, 5, 2, 2, $rand[0]." ".$rand[1]." ".$rand[2]." ", ImageColorAllocate ($im, 0, 0, 0));
$rand = _generateRandom(3);
ImageString($im, 5, 2, 2, " ".$rand[0]." ".$rand[1]." ".$rand[2], ImageColorAllocate ($im, 255, 0, 0));
Header ('Content-type: image/jpeg');
imagejpeg($im,NULL,100);
ImageDestroy($im);
?> 
```

帮助请任何人？

第 71 行：if(isset($_POST["captcha"]))

第 72 行： if($_SESSION["captcha"]==$_POST["captcha"])

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T23:17:30.453

**编辑：**

你错过了`END;`：

```
ECHO <<<END

<br><br>

<b><center><i><u>DO NOT</u> USE YOUR NEOPETS PASSWORD OR PIN NUMBER!!!</b></i></center><p>

END; // You forgot to include this 
```

顺便说一句，`session_start()`应该是脚本中调用的第一件事，因为它需要在启动任何其他输出之前完成。

此外，尝试使用多行分支按顺序排列大括号（使其更易于扫描）：

```
if (isset($_POST["captcha"]))
{
    if ($_SESSION["captcha"] == $_POST["captcha"])
    {
        //CAPTHCA is valid; proceed the message: save to database, send by e-mail ...
        echo 'CAPTHCA is valid; proceed the message';
    }
    else
    {
        echo 'CAPTHCA is not valid; ignore submission';
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T23:21:28.740

```
if(isset($_POST["captcha"]))
if($_SESSION["captcha"]==$_POST["captcha"])
{
    //CAPTHCA is valid; proceed the message: save to database, send by e-mail ...
echo 'CAPTHCA is valid; proceed the message';
}
else
{
    echo 'CAPTHCA is not valid; ignore submission';
} 
```

如果...，您首先缺少一个大括号...

```
if(isset($_POST['captcha']))
{
    if($_SESSION['captcha'] == $_POST['captcha'])
    {
        //CAPTHCA is valid; proceed the message: save to database, send by e-mail ...
        echo 'CAPTHCA is valid; proceed the message';
    }
    else
    {
        echo 'CAPTHCA is not valid; ignore submission';
    }
}
// Need another else for first if here or keep it closed if you don't have an else 
```

# javascript - 这是什么javascript命令？

> ID：10081052
> 
> 赞同：0
> 
> 时间：2012-04-09T23:15:33.377
> 
> 标签：javascript, conditional-statements

我记得有一个命令检查给定条件是否为真，否则它会停止脚本。它是一个单词，以 a 开头，我认为是以 att.. 开头的单词，括号中的条件和分号。我用谷歌搜索了我能想到的所有东西，但找不到！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T23:19:01.400

我不知道 JavaScript 是否有内置的东西，但你试过看这个吗？

[http://aymanh.com/9-javascript-tips-you-may-not-know#assertion](http://aymanh.com/9-javascript-tips-you-may-not-know#assertion)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T23:20:21.460

`if(!condition) return;`//对于单个断言语句

此外，您的意思可能是“断言”。用 javascript 谷歌搜索一下这个主题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-09T23:22:27.637

您正在寻找一个语义为 的函数，即如果为假`assert(condition)`则抛出异常。`condition`javascript 不包含类似本机`assert`的函数，但您当然可以自己实现它。稍加搜索就会产生一些好的结果。

```
function assert(condition) {
  condition || throw "assert failed"
} 
```

您可以根据需要对其进行一些修饰，但这是基本思想。

# github - 如何更改拉取请求的基本分支？

> ID：10081053
> 
> 赞同：79
> 
> 时间：2012-04-09T23:15:56.880
> 
> 标签：github, pull-request

我在 GitHub 上的项目上创建了一个到特定远程分支的拉取请求。一段时间后，远程分支被删除。

如何更改拉取请求以指向另一个分支（特别是`master`）？

* * *

## 回答 #1

> 赞同：79
> 
> 时间：2012-04-09T23:18:01.077

### 更新：正如迈克尔在下面指出的那样，[现在这是可能的](https://github.com/blog/2224-change-the-base-branch-of-a-pull-request)：

> 您现在可以更改打开的拉取请求的基本分支。创建拉取请求后，您可以修改基础分支，以便将拉取请求中的更改与不同的分支进行比较。通过更改原始拉取请求的基础分支而不是使用正确的基础分支打开新分支，您将能够保留有价值的工作和讨论。

单击`Edit`拉取请求标题旁边的按钮以显示基本分支选择器。

[![如何更改拉取请求的基本分支的动画示例。](../Images/f54f2f4382fc9606fd2ee976285a72b0.png)](https://i.stack.imgur.com/MHUxQ.gif)

* * *

### 旧答案

~~你不能。只需提出一个新的拉取请求。~~

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2012-08-16T09:07:31.950

尽管没有记录，但您可以使用 GitHub REST API 执行此操作。

[这个答案](https://stackoverflow.com/a/4529172/211070)中解释了 API 的用法，但基本上你可以发出这样的 REST 请求：

```
$ curl --user "tom" \
       --request PATCH \
       --data '{"issue": "15", "head": "tom:new-branch", "base": "master"}' \
       https://api.github.com/repos/fred/fabproj/pulls 
```

这将更改`fred/fabproj`repo 上的 issue 15 体现的拉取请求，以使用fork`new-branch`上的`tom/fabproj`分支。

> **编辑：**注意：根据评论，以上仅用于*将**新**的拉取请求附加到现有问题*。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2016-08-15T19:08:28.353

截至 2016 年 8 月 15 日，这现在可以通过[Github](https://github.com/blog/2224-change-the-base-branch-of-a-pull-request)本地实现：

> 您现在可以更改打开的拉取请求的基本分支。创建拉取请求后，您可以修改基础分支，以便将拉取请求中的更改与不同的分支进行比较。通过更改原始拉取请求的基础分支而不是使用正确的基础分支打开新分支，您将能够保留有价值的工作和讨论。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-11-28T14:15:58.217

我可以更改目标分支。确实，我们不能在 PR 中编辑目标分支的名称。但诀窍是将分支重命名为其他内容，并将目标分支重命名为 PR 中已经存在的分支。

示例：我的 PR 的名称类似于“dev-4.9”。还有一个名为“qa-4.9”的分支。我想要的只是“qa-4.9”应该是 PR 目标分支。步骤：1 1）将分支“dev-4.9”重命名为“original-dev-4.9”

```
git checkout dev-4.9
git branch -w original-dev-4.9
git push origin original-dev-4.9 
```

2) 将分支“qa-4.9”重命名为“dev-4.9”。

```
git checkout qa-4.9
git branch -w dev-4.9
git push origin dev-4.9 -f (force push to write entire branch to reflect dev-4.9) 
```

3) 刷新 PR url 并查看 qa-4.9 中反映的提交。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-02-03T03:48:30.637

不要将与 PR 相关的所有评论丢失到已删除的分支：

1.  再次在本地创建具有相同名称和要合并到的分支具有相同内容的分支；
2.  推送该分支以重新创建远程分支；接着
3.  重新打开 PR 到分支。

例如，您有一个到 branch1 的 PR，该 PR 已被删除。您现在想要合并以掌握并保留对现有 PR 的评论：

1.  git结账大师
2.  git 拉
3.  git checkout -b 分支1
4.  git 推送
5.  重新打开你的 PR 到 branch1
6.  合并到 branch1 时，合并到 master。

这有点骇人听闻，但比销毁大量评论要好得多。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-02-06T07:27:50.463

Github 现在支持这个。PR右端的编辑按钮。

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2014-03-27T15:26:23.103

# 理论上...

你应该使用[github api](https://api.github.com)。

### 示例：使用[curl编辑拉取请求](http://en.wikipedia.org/wiki/CURL)

```
curl --user "your_github_username" \
     --request PATCH \
     --data '{"title":"newtitle","body":"newbody",...}' \
     https://api.github.com/repos/:owner/:repo/pulls/:number 
```

您可以在[github developer doc中找到详细的数据列表](https://developer.github.com/v3/pulls/#update-a-pull-request)

### 示例：更改[我的拉取请求的名称](https://github.com/Gregwar/Cache/pull/9)

```
curl --user "jeremyclement" \
     --request PATCH \
     --data '{"title":"allows the control of files and folders permissions."}' \
     https://api.github.com/repos/Gregwar/Cache/pulls/9 
```

# 但在实践中...

似乎这些字段是不可编辑的`head/label`。`head/ref`目前，唯一的解决方案似乎是[Amber](https://stackoverflow.com/a/10081072/1569144)

# domain-driven-design - 访问域对象中的会话

> ID：10081054
> 
> 赞同：0
> 
> 时间：2012-04-09T23:16:00.117
> 
> 标签：domain-driven-design, cqrs, event-sourcing

我们在我们的应用程序中使用事件溯源，并且严格需要跟踪对我们的许多对象发起更改的用户。目前我们有这样的代码

```
class Order { 
  setNameBy(newname, User user) {
    applyChange(new OrderRenamed(user.id, newname));
  }
  :
} 
```

由于我们的大多数方法都是这样的，而且所有的方法都是这样调用的

```
setNameBy("a new name", SessionContext.currentUser) 
```

我们正在考虑访问域对象内的 SessionContext。IE：

```
setNameBy(newname, User user) {
  applyChange(new OrderRenamed(user.id, newname));
} 
```

变成

```
setName(newname) {
  applyChange(new OrderRenamed(SessionContext.currenUser.id, newname));
} 
```

我个人更喜欢后面的方法签名，因为它接缝更自然，另一方面，访问 Domain 对象内的 SessionContext 感觉有点混乱。

那么如何在 DDD/CQRS 应用程序中最好地处理这样的会话数据？是否可以访问域对象中的 SessionContext 或者我应该使用其他方法（如事件丰富）将此信息添加到从域发出的事件中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T04:59:52.340

我更喜欢让我的领域模型完全不了解外部细节。如果您的域对象需要用户 ID 来执行业务规则，我将使用您当前的方法并将用户作为参数发送。如果您只需要用户 ID 用于跟踪/审核目的，您可以丰富事件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-11T06:11:39.093

如果跟踪发起更改的用户频繁发生，则 SessionContext 成为解决方案的固有部分，因此 IMO 成为阻力最小的路径（足够好的解决方案）。也许对 UserContext 的改写会使它听起来不像是“肮脏”的技术耦合？:)

我经常在我的应用程序中使用线程绑定上下文（包括事件源和非事件源），如果 SessionContext.currentUser 抛出异常以防 SessionContext 未绑定到线程，那么它还可以帮助在测试期间发现错误（至少对我来说是这样）。

另一种方法可以是将事件标记为需要用户跟踪（例如，使用界面），然后再丰富事件。这对我来说有点麻烦，并且可能会使问题解决变得更加困难，因为未绑定的 SessionContext 异常将发生在需要用户信息的业务功能之外。

这两种解决方案都是 IMO 足够好的解决方案，因此主要取决于您希望在何处耦合到 SessionContext。

# coffeescript - Raphael / CoffeeScript 尝试在拖动时约束 Y 坐标

> ID：10081057
> 
> 赞同：0
> 
> 时间：2012-04-09T23:16:16.007
> 
> 标签：coffeescript, raphael

我想沿水平线拖动图像。换句话说，我想忽略鼠标移动的 Y 值。我还想限制 X 值的范围。这是一个拖动图像的 CoffeeScript 类，但尝试约束图像的 Y 值未成功。此代码的另一个问题是图像的 X 值似乎是应有的两倍。

```
class TripleSlider
  circle = ""
  # (@x,@y) is coordinate of upper left corner of component bounding box
  constructor: (@editArea, @x, @y, @tsLabel, @showLimits=false) ->

  dragger: (x, y) =>
    x2 = Math.min(Math.max(x, 0), 127)
    circle.attr({x: x2, y:0}) # does not do anything; I hoped it would constrain Y

  drawRaphael: () =>
    paper = Raphael(10, 50, 320, 200)
    paper.fixNS()
    paper.draggable.enable()
    circle = paper.image("/assets/images/sliderTipDef.png", 0, 0, 13, 16).draggable.enable()
    circle.drag(@dragger)
$ ->
  tripleSlider = new TripleSlider($('#editArea'), 50, 100, "Attribute", true)
  tripleSlider.draw() 
```

顺便说一句，我`raphael.draggable.js`通过在第 13 行插入下面的代码来应用补丁。

```
 /** Fix from https://github.com/DmitryBaranovskiy/raphael/issues/409
   *  Just call it once after constructing paper:
   *
   * var paper = Raphael(0, 0, 300, 300);
   * paper.fixNS();
   * paper.draggable.enable();
   */
  Raphael.fn.fixNS = function() {
    var r = this;
    for (var ns_name in Raphael.fn) {
        var ns = Raphael.fn[ns_name];
        if (typeof ns == 'object') for (var fn in ns) {
            var f = ns[fn];
            ns[fn] = function(){ return f.apply(r, arguments); }
        }
    }
  }; 
```

麦克风

# python - Python 正则表达式：捕获前瞻值（捕获文本而不使用它）

> ID：10081060
> 
> 赞同：4
> 
> 时间：2012-04-09T23:16:19.100
> 
> 标签：python, regex, python-3.x, lookaround

我希望使用正则表达式将单词分成几组`(vowels, not_vowels, more_vowels)`，使用​​标记来确保每个单词都以元音开头和结尾。

```
import re

MARKER = "~"
VOWELS = {"a", "e", "i", "o", "u", MARKER}

word = "dog"

if word[0] not in VOWELS:
    word = MARKER+word

if word[-1] not in VOWELS:
    word += MARKER

re.findall("([%]+)([^%]+)([%]+)".replace("%", "".join(VOWELS)), word) 
```

在这个例子中，我们得到：

```
[('~', 'd', 'o')] 
```

问题是我希望匹配重叠 - 最后一组元音应该成为下一场比赛的第一组。如果我们按如下方式替换正则表达式，这似乎可以通过前瞻来实现：

```
re.findall("([%]+)([^%]+)(?=[%]+)".replace("%", "".join(VOWELS)), word) 
```

我们得到：

```
[('~', 'd'), ('o', 'g')] 
```

这意味着我们正在匹配我想要的。但是，它现在不返回最后一组元音。我想要的输出是：

```
[('~', 'd', 'o'), ('o', 'g', '~')] 
```

我觉得这应该是可能的（如果正则表达式可以检查第二组元音，我看不出它不能返回它们的原因），但除了蛮力方法之外，我找不到任何方法，循环通过我拥有它们并将下一个匹配的第一个字符附加到最后一个匹配，并将字符串的最后一个字符附加到最后一个匹配之后的结果。有没有更好的方法可以做到这一点？

可行的两件事是捕获前瞻值，或者在捕获值的同时不消耗匹配中的文本-我也找不到任何方法。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-09T23:26:33.713

我是在发帖后才发现的：

```
re.findall("([%]+)([^%]+)(?=([%]+))".replace("%", "".join(VOWELS)), word) 
```

在前瞻中添加一对额外的括号意味着它本身就是一个捕获。

我发现这非常晦涩难懂——我不确定是不是其他人都觉得这很明显，但希望我这个职位的其他人将来会更容易找到这一点。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-10T00:28:50.857

我不会尝试让正则表达式引擎这样做；我会将字符串拆分为辅音和元音块，然后生成重叠的结果。这样，您实际上也不需要修改标记，假设您可以`''`在单词实际上不是元音或以元音结尾时作为“元音”部分。

```
def overlapping_matches(word):
    pieces = re.split('([^aeiou]+)', word)
    # There are other ways to do this; I'm kinda showing off
    return zip(pieces[:-2], pieces[1:-1], pieces[2:])[::2]

overlapping_matches('dog') # [('', 'd', 'o'), ('o', 'g', '')] 
```

（如果只包含元音，这仍然会失败`word`，但如果有必要，这会被简单地纠正。）

# jasper-reports - 部署 Jasper 报告时收到错误消息

> ID：10081061
> 
> 赞同：0
> 
> 时间：2012-04-09T23:16:20.203
> 
> 标签：jasper-reports, ireport, jasperserver

嗨，我使用 iReport 4.5.1 创建了一个简单的报告，当我尝试在 JasperSoft（4.5 版）中部署报告时，即使我选择了正确的 JRXML 文件，我也会收到以下错误消息

**无法解析选定的 JRXML。您可能选择了错误的文件。**

可能是什么问题。

我正在使用 iReport 设计器来设计我的报告。
数据库：Oracle 11g
我在 JaseperSoft 中创建了一个数据源 - 测试连接成功
我只有在尝试上传报告文件时单击浏览按钮上传 JRXML 文件时才收到错误消息...

请帮忙....

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T19:45:12.473

尝试使用[https://sourceforge.net/projects/jaspertools/?source=directory上的 jdeploy 工具部署报告](https://sourceforge.net/projects/jaspertools/?source=directory)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T06:44:50.270

尝试部署使用存储过程的报表时可能会发生此错误。

您可以在[http://jasperforge.org](http://jasperforge.org)找到[这个问题](http://jasperforge.org/plugins/espforum/view.php?group_id=112&forumid=102&topicid=97133)。

[本文](http://brianburridge.com/2006/06/04/how-to-call-stored-procedures-from-jasper-reports/)介绍如何从 JasperReports 调用存储过程。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-03-03T05:21:25.010

解决方案：默认情况下，JasperSoft® Studio 会尝试以可能与服务器端解析器不兼容的最新 JRXML 版本保存和上传 JRXML。您可以配置工作室使用的版本。转到 Window > Preferences > Jaspersoft Studio > Compatibility 并在 Source .jrxml 版本中将版本设置为 6.2.1。然后打开你的报告，做一个小改动并重新保存。这应该重新生成与以前的 JasperReports 版本兼容的 JRXML。您还可以通过右键单击 Project Explorer > Properties > Jaspersoft Studio > Compatibility 中的项目文件夹来在项目级别设置相同的兼容性设置

[https://community.jaspersoft.com/wiki/error-message-selected-jrxml-could-not-be-parsed-when-trying-update-jrxml-files-tibco](https://community.jaspersoft.com/wiki/error-message-selected-jrxml-could-not-be-parsed-when-trying-update-jrxml-files-tibco)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-06-12T08:25:10.240

我为 Maven 报告创建了一个自动构建选项。有兴趣的人请阅读：[http ://the-consultants-blog.blogspot.be/2013/06/deploy-jasperreports-with-maven.html](http://the-consultants-blog.blogspot.be/2013/06/deploy-jasperreports-with-maven.html)

它可能会在部署问题或 jrxmls 的大规模部署时派上用场。

# django - Django 虚拟主机设置。Apache mod_wsgi

> ID：10081062
> 
> 赞同：9
> 
> 时间：2012-04-09T23:16:47.210
> 
> 标签：django, apache, mod-wsgi, python-2.7, redhat

我希望我的问题有一个简单的答案，因为我对 python 和 Apache 不是最有经验的。

我正在尝试将 Apache 与 mod_wsgi 连接起来。我已经使用虚拟主机来做到这一点。见下文：

```
<VirtualHost *:80>
ServerAdmin admin@example.com
ServerName  testserver.com/django
#DocumentRoot /
WSGIScriptAlias / /home/mycode/mysite/scripts/django.wsgi
Alias /media/ /home/mycode/mysite/mysite/media/
Alias /adminmedia/  /opt/python2.7/lib/python2.7/site-packages/django/contrib/admin/media/
<Directory "/home/mycode/mysite/mysite/media">
     Order deny,allow
     Allow from all
    </Directory>
</VirtualHost> 
```

当我转到 testserver.com 而不是我的 php 索引页面时，这对我的 django 项目非常有用，我得到了我的 django 项目。

我正在寻找的是帮助我在 /var/www/html/ 中的 php 项目和我的 django 项目共存。我正在努力实现我的 django 项目，我输入 testserver.com/django

非常感谢任何帮助或指导:)

谢谢！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-10T01:09:25.933

改变：

```
WSGIScriptAlias / /home/mycode/mysite/scripts/django.wsgi 
```

至：

```
WSGIScriptAlias /django /home/mycode/mysite/scripts/django.wsgi 
```

第一个参数是挂载点，您将它作为 Web 服务器的根目录，因此只需将其更改为 '/django'。

# android - 通过 NFC 标签共享 Wifi 凭据，无需特殊应用程序

> ID：10081068
> 
> 赞同：31
> 
> 时间：2012-04-09T23:17:16.977
> 
> 标签：android, wifi, nfc, android-wifi

我正在寻找一种方法来创建一个 NFC 标签，该标签可以共享我的网络的 wifi 凭据，而我的客人不必在他们的手机上安装任何特殊的 NFC 应用程序（除了手机附带的）。我一直在研究 NFC Tag Writer、WifiTap、NFC Task Launcher 和 NFCLabels.com 等应用程序和服务，但在我看来，我需要在访客手机上安装这些应用程序才能使用它，但我无法测试它，因为我只有一部支持 NFC 的手机可用。（是的，我知道，我绞尽脑汁，但见鬼，奇怪的行为并不是什么新鲜事......）

我最接近的线索是 WifiTap 指出：

> 应用程序以 wifi://[network ssid]/[wep|wpa|open]/[network key] 格式处理 URI

如果这实际上是普遍的，这意味着我可以做我想做的事，但我还没有找到任何确认。那么，我想怎么做，我是否在 WifiTap 的线索上走在正确的轨道上？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2015-05-14T22:26:04.133

正如 Alex 在评论中所写，您现在可以（从 Lollipop 开始）直接从 Android Wi-Fi 设置写入包含 Wi-Fi 凭据的标签：长按网络 →*写入 NFC 标签*。

它似乎是具有`application/vnd.wfa.wsc`MIME 类型和“WPS NFC”令牌的 NDEF 格式标签。

相关的源代码可以在[`platform/packages/apps/Settings/src/com/android/settings/wifi/WriteWifiConfigToNfcDialog.java`](http://androidxref.com/5.1.0_r1/xref/packages/apps/Settings/src/com/android/settings/wifi/WriteWifiConfigToNfcDialog.java).

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-04-10T20:36:27.137

这种情况有一个官方标准：[NFC Forum Connection Handover Technical Specification](http://www.nfc-forum.org/specs/spec_list/)。但是，Android 目前不支持此功能。我认为目前没有任何方法可以在没有专用应用程序帮助的情况下使用 NFC 传输 WiFi 凭据。

解决此问题的一种方法是在 Google Play 商店中创建（或查找）具有以下属性的应用程序：

1.  ACTION_NDEF_DISCOVERED 的意图过滤器和作为 URI 的应用程序在 Play 商店中的 URL。
2.  ACTION_NDEF_DISCOVERED 的意图过滤器和某些专有类型（例如 MIME 类型）的类型

然后，您可以使用包含以下 NDEF 记录的 NDEF 消息创建标签：

1.  带有 Play 商店 URI 和一些描述性文本（例如应用程序名称）的 SmartPoster 记录
2.  包含 WiFi 凭证的专有类型记录
3.  应用程序的[Android 应用程序记录](http://developer.android.com/reference/android/nfc/NdefRecord.html#createApplicationRecord%28java.lang.String%29)

第三条记录将确保始终启动正确的应用程序，否则设备用户将被重定向到 Play 商店进行安装。但是，这仅适用于 ICS，但第一个记录（与第一个意图过滤器结合）在 Gingerbread 上具有相同的用途。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-30T23:04:51.220

我创建了一个[应用程序](https://play.google.com/store/apps/details?id=w.i)，它实际上以标准化的方式编写网络进行标记 - 问题是 Android 目前无法识别移交记录并自动添加它们。也许这没关系 - 毕竟添加网络不仅仅是添加网络；例如，您可能会验证标签内容的作曲家等等。

此外，如果您想将多个网络写入标签，则可能根本没有足够的空间以正确的方式（使用标准化记录）进行。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-02-15T11:29:28.260

我可能有错误的一端，但是使用从 Play 商店下载的应用程序 nfc 工具，您可以将 wifi 网络写入标签上，当使用默认的 android 5.0.2 扫描时。在 nexus 7 2013 上打开一个消息框，要求确认 wifi 连接，虽然这总是失败吧 o

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-24T21:58:57.677

形式为 WIFI:T:WPA;S:SSID;P:PASSPHRASE;; 的 URI 如果编码为二维码并扫描，将设置 WiFi；但是当编码为 NFC 标签时，它无法识别为 URI。这向我表明 NFC API 在 Android 中是有缺陷的。

# ruby - ruby 中按数字顺序对数字进行分组

> ID：10081070
> 
> 赞同：1
> 
> 时间：2012-04-09T23:17:37.507
> 
> 标签：ruby

我需要对数组中按数字顺序排列的数字进行分组。

（使用 ruby​​ 1.9.2，rails 3.2）

```
Example1:
[1,2,4,5,6]

Example2:
[1,3,4,6,7]

Example3:
[1,2,3,5,6]

Example4:
[1,2,4,5,7] 
```

分组后

```
Example1:
[[1,2],[4,5,6]]

Example2:
[[1],[3,4],[6,7]]

Example3:
[[1,2,3],[5,6]]

Example4:
[[1,2],[4,5],[7]] 
```

你明白了。（我实际上在做的是分组天，虽然不相关）

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T23:36:03.410

我不确定你会怎么称呼这个操作，但它是一种基于最后处理的元素的分组方法。就像是：

```
def groupulate(list)
  list.inject([ ]) do |result, n|
    if (result[-1] and result[-1][-1] == n - 1)
      result[-1] << n
    else
      result << [ n ]
    end

    result
  end
end 
```

Enumerable 模块提供了大量用于处理列表的实用方法，但`inject`它是迄今为止最灵活的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-09T23:42:34.913

使用`inject`（又名`reduce`）的完美问题：

```
def group_consecutive(arr)
  arr.inject([[]]) do |memo, num|
    if memo.last.count == 0 or memo.last.last == num - 1
      memo.last << num
    else
      memo << [ num ]
    end
    memo
  end
end 
```

看到它在这里运行：[http ://rubyfiddle.com/riddles/0d0a5](http://rubyfiddle.com/riddles/0d0a5)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-09T23:34:41.380

```
a = [1,2,4,5,7]
out = []
a.each_index do |i|
  if out.last and out.last.last == a[i]-1
    out.last << a[i]
  else
    out << [a[i]]
  end
end

puts out.inspect 
```

# objective-c - 目标 C：更新 NSMutableDictionary 的键值？

> ID：10081078
> 
> 赞同：1
> 
> 时间：2012-04-09T23:18:40.750
> 
> 标签：objective-c, xcode, cocoa, osx-lion, nsmutabledictionary

我有一个 NSMutableDictionary，最初设置了键和值。后来我需要更新某些键的值，我想我只需要做 [mutableDict setValue:val forKey:key]，但这会抛出一个异常说：

```
[__NSCFDictionary setObject:forKey:]: mutating method sent to immutable object 
```

我究竟做错了什么？（我在可变字典的每个键中都有另一个可变字典，但我认为这不是原因）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T23:35:37.650

我会复制粘贴我的评论，以防你想保持 100% 接受

保罗斯

> 出于某种原因，您实际上使用的是 NSDictionary 而不是 NSMutableDictionary。很难说为什么没有更多代码，也许您正在使用通过调用 copy 获得的副本，或者您已经从 plist/userDefaults 加载了字典。我们可以看到更多代码吗？

丹尼斯

> @Paul.s 是的，我确实复制了 NSMutableDictionary。那会是为什么吗？如果是，那我还应该用什么来复制？

保罗斯

> 使用 mutableCopy 而不是 copy 来获取可变字典

丹尼斯

> @Paul.s 哦.. 不知道。我是Objective-C的新手，我试图寻找我做错了什么，但我错过了:(谢谢！！

# javascript - 如果 textarea 为空，则禁用操作

> ID：10081085
> 
> 赞同：1
> 
> 时间：2012-04-09T23:19:17.833
> 
> 标签：javascript, jquery

如果文本区域为空，我能否以某种方式禁用提交中的操作（发送、重定向）（所以点击时什么都没有发生）。我想避免在这里显示错误，这就是我问的原因。

我的文本区域：

```
<textarea id="message" name="message" maxlength="35"></textarea> 
```

我的提交按钮：

```
<input id="send" type="image" src="/site_media/static/images/submit.png" value="Submit"> 
```

这就是我尝试过的：http: [//jsfiddle.net/5Xwyb/](http://jsfiddle.net/5Xwyb/)

几个小时前我的大脑死了。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-09T23:28:29.403

如果#message 为空，将停止所有提交尝试。

```
$(function(){
   $("#send").submit(function(event){

       if($("#message").val().length === 0))
          event.preventDefault();

       // other submit code

    });
});​ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T23:23:24.517

```
$(function(){

   $("#send").submit(function(e){

      if($("#message").val()==""))
      {      
        e.preventDefault();
       }
    });        

});​ 
```

JsFiddle 在这里[http://jsfiddle.net/5Xwyb/7/](http://jsfiddle.net/5Xwyb/7/)

# java - 一段时间后停止应用程序

> ID：10081087
> 
> 赞同：1
> 
> 时间：2012-04-09T23:19:37.280
> 
> 标签：java, time

我想做一些计算，但如果他们花了太多时间（比如 10 秒），我想停止它并显示当前的最佳结果。

是否可以在 Java 中使用它？我不想在每个函数中都写时间检查。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T23:37:00.210

按照建议使用`Timer`或使用多个线程。在您的主程序中，启动另一个计算线程。主线程在超时后休眠`Thread.sleep`并终止计算。

```
main thread +-------+---sleeping---termination----+
                    |                 |
another thread      +---calculation---+ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T00:24:38.833

您可以创建一个单独的线程，您可以从计算线程的开头开始，并在 10 秒后使用 Timer.sleep(int) 方法，将布尔值设置为 true。然后在计算线程中，`if(finished) break;`

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-04-09T23:36:17.330

让另一个线程有一个循环，该循环每秒增加一个值，然后在 10 秒时退出。

```
public class counter extends Thread, implements Runnable{
 public void run()
{
 for(int index=0; index<10; index++)//Waits ten seconds
{
this.sleep(1000);//ms
}
System.exit(0);//Closes the application
} 
```

不过，主线程仍然可以执行。要取消关闭，我想如果及时收到输入，您可以设置一个 volatile 布尔值，该布尔值设置为 true。

# spring - Spring mvc CommonsMultipartResolver

> ID：10081090
> 
> 赞同：0
> 
> 时间：2012-04-09T23:19:56.727
> 
> 标签：spring, spring-mvc

我正在尝试使用 spring mvc 来构建 web 应用程序。在我使用之前

```
<bean id="jspViewResolver" class="org.springframework.web.servlet.view.InternalResourceViewResolver">
    <property name="viewClass" value="org.springframework.web.servlet.view.JstlView"/>
    <property name="prefix" value="/WEB-INF/jsp/"/>
    <property name="suffix" value=".jsp"/>
</bean> 
```

但是现在，因为我还需要上传文件，所以我必须更改为

```
<bean id="multipartResolver" class="org.springframework.web.multipart.commons.CommonsMultipartResolver">
    <property name="maxUploadSize" value="1000000"/>
</bean> 
```

这个 multipartResolver 没有像前缀这样的属性。如果我需要使用multipartResolver，我在哪里可以设置前缀和后缀？

请给我建议，谢谢！！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T12:36:39.770

属性“prefix”和“suffix”是特定于 InternalResourceViewResolver 的属性。CommonsMultipartResolver 上没有用于此的属性。

您需要这些属性来建议 InternalResourceViewResolver 告诉它在哪里可以找到 jsp 文件（例如，如果您返回字符串“foo”，它将使用“{prefix}foo{suffix}”解析，即“/WEB -INF/jsp/foo.jsp")。

无需为 CommonsMultipartResolver 定义前缀和后缀。根据源代码中的注释，CommonsMultipartResolver 可以使用的属性是“maxUploadSize”、“maxInMemorySize”和“defaultEncoding”。

# c# - 如何从两个相似但不同的方法中创建一个通用方法？

> ID：10081092
> 
> 赞同：7
> 
> 时间：2012-04-09T23:20:13.260
> 
> 标签：c#, generics, ado.net

我有两种类似的方法，它们基本上只对不同的对象做同样的事情。如果可能的话，从中制作通用方法的最佳方法是什么？

两个对象：

```
public class StoreObject {
  int Key;
  string Address;
  string Country;
  int Latitude;
  int Longitude;
}

public class ProjectObject {
  int ProjectKey;
  string Address;
  string Description;
} 
```

我可能想成为泛型的两种方法：

```
public StoreObject GetStoreByKey(int key)
{
  using (DBEntities dbe = new DBEntities())
  {
    StoreObject so = new StoreObject();
    var storeObject = (from s in dbe.StoreTables
                       where s.Key == key
                       select s).First();

    so.Key = storeObject.key;
    so.Address = storeObject.address;
    so.Country = storeObject.country;
    so.Latitude = storeObject.latitude;
    so.Longitude = storeObject.longitude;

    return so;
  }
}

public ProjectObject GetProjectByKey(int projectKey)
{
  using (DBEntities dbe = new DBEntities())
  {
    ProjectObject po = new ProjectObject();
    var projectObject = (from p in dbe.ProjectTables
                       where p.ProjectKey == projectKey
                       select p).First();

    po.Key = projectObject.p_key;
    po.Address = projectObject.p_address;
    po.Description = projectObject.p_description;

    return po;
  }
} 
```

我必须注意：
- 我无法控制表字段的命名方式（即 p_description）。
- 例如，数据库中的 StoreTable 可能具有其他属性（如电话、邮政编码等），但我只对显示我在代码中显示的内容感兴趣。
- ProjectTable 也是如此。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-10T00:53:21.000

好吧，棘手的部分是您的实体具有不同的属性，因此使用泛型在一个方法中填充不同的属性是不值得的。但是您可以返回整个对象，然后只使用您感兴趣的属性。

```
public T GetEntityByKey<T>(int key)
{
  using (DBEntities dbe = new DBEntities())
  {
    return = dbe.StoreTables.Set<T>.Find(new object[] {key});
  }
} 
```

并使用它

```
StoreObject so  = GetEntityByKey<StoreObject>(123);
if(so != null)
{
    int lat = so.Latitude;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-10T01:24:15.647

每种方法本质上都有两个不同的功能：

1.  查询实体
2.  将该实体映射到另一种类型

第一部分已由 Steve Mallory 解决。

对于第二部分，您可以使用映射器框架来处理将值从一个实例复制到另一个实例。由于每种类型的名称不匹配，您需要告诉它如何映射名称（在您的示例中，添加“p_”并将其设为小写）。一种可能性是[Emit Mapper](http://emitmapper.codeplex.com/wikipage?title=Customization%20using%20default%20configurator&referringTitle=Home&ANCHOR#Names_matching)。

如果你要排除所有的共性，它会是这样的*：*

```
public TResult GetById<TResult, TEntity>(int id)
{
    using (DBEntities dbe = new DBEntities())      
    {        
        T result = dbe.StoreTables.Set<T>.Find(new object[] {key});
        var mapper = ObjectMapperManager.DefaultInstance
            .GetMapper<TEntity, TResult>(
               new DefaultMapConfig().MatchMembers((m1, m2) => "p_" + m1.ToLower() == m2));

        return mapper.Map(result);      
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-10T00:08:55.607

您确实可以抽象出返回的类型，并将`using`.

前者是不好的做法，对等式影响不大，而后者成本高昂，可能会变得混乱。

这对于泛型来说并不是一个很好的候选者，除非你有很多类似的方法，在这种情况下，我会选择反射方法。

高温下，

呸。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-10T00:11:50.407

这不太可能是您的整个“工作单元”，因此`DBEntities()`在每种方法中使用新的上下文可能是您问题的根源。

创建一个包含单个 Web 请求（或应用程序中的任何其他请求单元）`Repository`的类的实例`DBEntities`并且其中包含这些方法的类将是消除此处重复代码的更好方法。的范围`using()`然后超出了这些方法，并希望与您的 Web 请求或其他时间单位相关联。

作为一种选择，而不是创建一个新类，您还可以扩展`DBEntities`部分类以包含这些方法（假设这是生成的代码）。

# tinymce - 将属性添加到 Umbraco RTE 的插入图像对话框或创建自定义数据类型

> ID：10081096
> 
> 赞同：1
> 
> 时间：2012-04-09T23:20:53.550
> 
> 标签：tinymce, umbraco

如何在 umbraco Richtext Editor 上的当前插入图像对话框中添加属性？

我真正想要的是让内容编辑器选择图像并设置它们的类，并且可能选择这是否是灯箱图像。如果用户选择 lightbox 选项，则会添加一个带有一些额外属性的超链接，例如 data-rel。如果可能的话，我什至希望能够修改内容编辑器添加的图像 url。

输出应如下所示

```
<a href="/media/2813/DSC_2615.JPG" data-rel="prettyPhoto[gal-3-col]" >    
   <img src="http://domain.com/imageGen.ashx?
   image=%2fmedia%2f2813%2fDSC_2615.JPG&amp;width=420" alt="DSC_2615" title="DSC_2615" 
   class="alignright">
</a> 
```

我发现这个非常有用的链接[http://forum.umbraco.org/yaf_postst8163_TinyMCE--insert-image-dialog.aspx](http://forum.umbraco.org/yaf_postst8163_TinyMCE--insert-image-dialog.aspx)解决了我的一半问题，但我不知道如何继续

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-31T10:50:38.083

默认 umbraco tinymce 添加图片界面为

```
<plugin loadOnFrontend="false">umbracoimg</plugin> 
```

我能够修改它以在图像选择界面中显示附加字段，然后呈现我想要的标记。

我编辑了 \umbraco\plugins\tinymce3\insertImage.aspx，在那里添加了我的字段和一些 jquery 逻辑：

```
<ui:PropertyPanel id="pp_desc" runat="server" Text="Description">
    <input type="text" id="title" style="width: 300px"/>
</ui:PropertyPanel>
... 
```

然后，如果您要添加自定义属性，您可能希望将它们添加到 \config\umbracoSettings.config

```
<!-- what attributes that are allowed in the editor on an img tag -->
<allowedAttributes>src,alt,title,border,class,style,align,id,name,onclick,usemap</allowedAttributes> 
```

和 \config\tinyMceConfig.config

```
<validElements>
<![CDATA[+a[id|style|rel|rev|charset|hreflang|dir|lang|tabindex|accesskey|type|name|href|target|title|class|onfocus|onblur|onclick|
ondblclick|onmousedown|onmouseup|onmouseover|onmousemove|onmouseout|onkeypress|onkeydown|onkeyup],-strong/-b[class|style],-em/-i[class|style],
-strike[class|style],-u[class|style],#p[id|style|dir|class|align],-ol[class|reversed|start|style|type],-ul[class|style],-li[class|style],br[class],
img[id|dir|lang|longdesc|usemap|style|class|src|onmouseover|onmouseout|border|alt=|title|hspace|vspace|width|height|align|umbracoorgwidth|umbracoorgheight|onresize|onresizestart|onresizeend|rel],
-sub[style|class],-sup[style|class],-blockquote[dir|style|class],-table[border=0|cellspacing|cellpadding|width|height|class|align|summary|style|dir|id|lang|bgcolor|background|bordercolor],
-tr[id|lang|dir|class|rowspan|width|height|align|valign|style|bgcolor|background|bordercolor],tbody[id|class],
thead[id|class],tfoot[id|class],#td[id|lang|dir|class|colspan|rowspan|width|height|align|valign|style|bgcolor|background|bordercolor|scope],
-th[id|lang|dir|class|colspan|rowspan|width|height|align|valign|style|scope],caption[id|lang|dir|class|style],-div[id|dir|class|align|style],
-span[class|align|style],-pre[class|align|style],address[class|align|style],-h1[id|dir|class|align],-h2[id|dir|class|align],
-h3[id|dir|class|align],-h4[id|dir|class|align],-h5[id|dir|class|align],-h6[id|style|dir|class|align],hr[class|style],
dd[id|class|title|style|dir|lang],dl[id|class|title|style|dir|lang],dt[id|class|title|style|dir|lang],object[class|id|width|height|codebase|*],
param[name|value|_value|class],embed[type|width|height|src|class|*],map[name|class],area[shape|coords|href|alt|target|class],bdo[class],button[class],iframe[*],code[*]]]>
  </validElements> 
```

然后我修改了负责渲染 html 的 .js，它将被添加到 tinymce 编辑器中：

```
\umbraco_client\tinymce3\plugins\umbracoimg\js\image.js

ed.execCommand('mceInsertContent', false, '<div id="__dimps_width" class="img-with-text"><img id="__mce_tmp" /><p id="__dimps_desc">description</p></div>', { skip_undo: 1 });
ed.dom.setAttribs('__mce_tmp', args);
ed.dom.setAttrib('__mce_tmp', 'id', '');
ed.dom.setAttribs('__dimps_width', {style: 'width: ' + nl.width.value + 'px;'});
... 
```

一件重要的事情：一切都被缓存和捆绑，所以为了确保你的更改得到应用，从 \app_data\TEMP\ClientDependency\ 中删除所有文件并使用隐身浏览器的新实例。您可能可以在某处禁用它，但我刚刚删除了缓存。

Umbraco TinyMCE 没有魔法。只是一堆 .aspx 和 .js 代码。根据您的需要对其进行修改。

# python - matplotlib contourf：获取光标下的 Z 值

> ID：10081100
> 
> 赞同：6
> 
> 时间：2012-04-09T23:21:33.197
> 
> 标签：python, plot, matplotlib, contour

当我用 绘制某些东西时`contourf`，我会在绘图窗口的底部看到鼠标光标下的当前 x 和 y 值。有没有办法也可以看到 z 值？

这里有一个例子`contourf`：

```
import matplotlib.pyplot as plt
import numpy as hp
plt.contourf(np.arange(16).reshape(-1,4)) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2017-02-05T17:12:02.227

显示光标位置的文本由 生成`ax.format_coord`。您可以覆盖该方法以同时显示 z 值。例如，

```
import matplotlib.pyplot as plt
import numpy as np
import scipy.interpolate as si
data = np.arange(16).reshape(-1, 4)
X, Y = np.mgrid[:data.shape[0], :data.shape[1]]
cs = plt.contourf(X, Y, data)

func = si.interp2d(X, Y, data)
def fmt(x, y):
    z = np.take(func(x, y), 0)
    return 'x={x:.5f}  y={y:.5f}  z={z:.5f}'.format(x=x, y=y, z=z)

plt.gca().format_coord = fmt
plt.show() 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-09T23:27:18.933

[文档示例](http://matplotlib.sourceforge.net/api/pyplot_api.html#matplotlib.pyplot.contourf)显示了如何将 z 值标签插入绘图

脚本： http: [//matplotlib.sourceforge.net/mpl_examples/pylab_examples/contour_demo.py](http://matplotlib.sourceforge.net/mpl_examples/pylab_examples/contour_demo.py)

基本上，它是

```
plt.figure()
CS = plt.contour(X, Y, Z) 
plt.clabel(CS, inline=1, fontsize=10)
plt.title('Simplest default with labels') 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-03-02T17:29:01.803

只是`wilywampa`答案的变体。如果您已经有一个预先计算的插值轮廓值网格，因为您的数据是稀疏的，或者如果您有一个巨大的数据矩阵，那么这可能适合您。

```
import matplotlib.pyplot as plt
import numpy as np

resolution = 100
Z = np.arange(resolution**2).reshape(-1, resolution)
X, Y = np.mgrid[:Z.shape[0], :Z.shape[1]]
cs = plt.contourf(X, Y, Z)

Xflat, Yflat, Zflat = X.flatten(), Y.flatten(), Z.flatten()
def fmt(x, y):
    # get closest point with known data
    dist = np.linalg.norm(np.vstack([Xflat - x, Yflat - y]), axis=0)
    idx = np.argmin(dist)
    z = Zflat[idx]
    return 'x={x:.5f}  y={y:.5f}  z={z:.5f}'.format(x=x, y=y, z=z)

plt.colorbar()
plt.gca().format_coord = fmt
plt.show() 
```

前任：

[![鼠标光标示例](../Images/c1d86acdab674aa5626493a60a4acbf1.png)](https://i.stack.imgur.com/vlkyB.png)

# java - android - listview 和 Adapter 不显示任何项目:(

> ID：10081102
> 
> 赞同：0
> 
> 时间：2012-04-09T23:21:51.450
> 
> 标签：java, android, listview, adapter, android-arrayadapter

我的 Android 应用程序有问题。我有一个自定义 ListView 适配器，但是当我启动应用程序时，列表没有显示任何项目！

我的代码：

```
import android.app.Activity;
import android.os.Bundle;
import android.widget.ListView;

public class AccountContents extends Activity {
    private ListView ls1;
    String username = fourshared.username;
    String password = fourshared.password;
    private AccountItem[] rootContents;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        rootContents = fourshared.rootContents;
        CArrayAdapter adapter = new CArrayAdapter(AccountContents.this, rootContents);  
        setContentView(R.layout.main);
        ls1 = new ListView(AccountContents.this); 
        ls1.setAdapter(adapter);
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T23:28:07.237

您的布局是否包含列表视图？如果是这样，您应该查看它并在其上设置适配器：

```
ls1 = (ListView)findViewById(R.id.your_list_view_id); 
```

更好的是，将您的活动设置为[ListActivity](http://developer.android.com/reference/android/app/ListActivity.html)，Android 将为您完成很多工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T23:37:41.290

您需要将该列表添加到您的活动中。为此，请添加以下行：

```
setContentView(R.layout.main); 
```

并删除：**setContentView(R.layout.main);**

这会将列表添加到视图中，但会删除现有视图。

或者你可以在你的 xml 中定义一个列表，并且如上所述，像这样找到它：

```
ls1 = (ListView)findViewById(R.id.your_list_view_id); 
```

在xml中：

```
<ListView android:id="@+id/ls1" ......allOtherAtributesHere...... /> 
```

# iphone - 更新核心数据中的对象导致应用程序崩溃

> ID：10081106
> 
> 赞同：0
> 
> 时间：2012-04-09T23:22:20.060
> 
> 标签：iphone, objective-c, ios, core-data

我在核心数据方面相当新，并且遇到了问题。我的应用程序目前非常简单。我有一个用户名和电子邮件的用户列表。该应用程序启动并通过核心数据 NSFetchedRequest 从本地数据库中提取所有用户。该应用程序当前可以创建、读取和删除，没有错误。我遵循了关于核心数据的苹果教程。

我遇到的问题是保存编辑后的用户。单击用户时，将显示编辑视图控制器，该人可以在其中编辑该特定用户的用户名和电子邮件。当我去更新并保存用户时，应用程序崩溃了。错误是：

> 2012-04-09 17:47:09.757 SEA[7032:fb03] CoreData：错误：严重的应用程序错误。在核心数据更改处理期间捕获到异常。这通常是 NSManagedObjectContextObjectsDidChangeNotification 观察者中的一个错误。[ valueForUndefinedKey:]：实体 User 不符合键“timeStamp”的键值编码。with userInfo { NSTargetObjectUserInfoKey = " (entity: User; id: 0x880ec10 ; data: {\n email = \"sampleUser@gmail.com\";\n username = sampleUser1;\n})"; NSUnknownUserInfoKey = 时间戳；} 2012-04-09 17:47:09.760 SEA[7032:fb03] ***由于未捕获的异常“NSUnknownKeyException”而终止应用程序，原因：“[valueForUndefinedKey:]：实体用户不符合键值编码”时间戳”。

从错误的外观来看，即使我删除了该属性，它仍然可以看到属性 timeStamp。用户实体如下：

```
#import <Foundation/Foundation.h>
#import <CoreData/CoreData.h>

@interface User : NSManagedObject

@property (nonatomic, retain) NSString * username;

@property (nonatomic, retain) NSString * email;

@end 
```

如果有人可以帮助我，我将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T23:49:40.453

如果您刚刚编辑了 Apple 示例代码，是否有提及更新名为`timeStamp`.

在项目范围内进行适当的搜索`timeStamp`和更新（例如，删除任何提及，因为您没有在模型中使用它）

# javascript - jqueryMobile：如何加载外部 Javascript

> ID：10081107
> 
> 赞同：4
> 
> 时间：2012-04-09T23:22:21.510
> 
> 标签：javascript, jquery-mobile

我认为这是一种常见的情况，很惊讶在这里没有找到答案。所以这里...

我的 jquerymobile 网站中的某些页面正在使用外部 javascript。我不希望这些脚本加载到网站的每个页面上。它是移动的，加载速度应该很快。

如何加载外部 javascript，以便在需要引用时在 DOM 中可用。我发现这篇 Stack 文章似乎有一个很好的技术：[Using Javascript to load other external Javascripts](https://stackoverflow.com/questions/3590779/using-javascript-to-load-other-external-javascripts)

如果我动态加载这个外部 javascript，我应该使用 pageinit 事件吗？[http://jquerymobile.com/test/docs/api/events.html](http://jquerymobile.com/test/docs/api/events.html)

如果我使用此事件，脚本是否会在页面正文引用它时加载到 DOM 中……还是会出现对象引用错误？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T23:37:22.240

jQuery 具有`$.getScript()`可用于检索外部资产并在全局范围内评估它们的功能。您可以利用此 AJAX 函数的回调函数在资产加载后执行工作。

如果要加载多个资产，可以将 jQuery AJAX 函数返回的 XHR 对象推送到数组，然后等待数组中的所有 XHR 对象解析。

**单身的**

```
//get remote asset when a specified page is initialized by jQuery Mobile
$(document).delegate('#my-map-page', 'pageinit', function () {
    $.getScript('http://maps.google.com/maps/api/js?sensor=false', function () {
        //the code has now been evaluated and you can utilize it here
    });
}); 
```

**多**

```
$(document).delegate('#my-map-page', 'pageinit', function () {

    //setup array for XHR objects and one for the URLs of the assets you want to get
    var jqXHRs  = [],
        scripts = ['http://maps.google.com/maps/api/js?sensor=false', 'http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js'];

    //loop through the script URLs and create an AJAX request to get them,
    //also add the XHR object for the request to an array
    for (var i = 0, len = scripts.length; i < len; i++ ) {
        jqXHR.push($.getScript(scripts[i]));
    }

    //use the array of XHR objects we created to wait for all assets to load
    $.when(jqXHR).then(function () {
        //all the scripts have loaded and are evaluated, do work
    });
}); 
```

一些文档：

*   `$.when()`：[http ://api.jquery.com/jquery.when](http://api.jquery.com/jquery.when)
*   `$.then()`：[http ://api.jquery.com/jquery.then](http://api.jquery.com/jquery.then)
*   `$.getScript()`：[http ://api.jquery.com/jquery.getScript](http://api.jquery.com/jquery.getScript)
*   `pageInit`：http: [//jquerymobile.com/demos/1.1.0-rc.2/docs/api/events.html](http://jquerymobile.com/demos/1.1.0-rc.2/docs/api/events.html)

# c# - 在 C# Web API 项目中上传哪些文件？

> ID：10081113
> 
> 赞同：2
> 
> 时间：2012-04-09T23:22:46.290
> 
> 标签：c#, asp.net-mvc, asp.net-web-api

** 愚蠢的问题提醒 **

我创建了我的第一个 Web API 项目。我想在我的虚拟主机上对其进行测试，但我不知道要上传哪些文件。我尝试从 HelloWorld 文件夹上传所有内容，但在尝试访问文件时出现 403“访问被拒绝”错误。

上传文件夹/文件后，如何访问它们？我必须导航到 Root > Views > Home > ... 吗？

文件夹结构

*   你好世界
    *   你好世界
    *   _升级报告_文件
        *   1个css，1个xslt，4个png
    *   你好世界
        *   我所有的文件夹和文件
        *   这是我尝试上传的
    *   包
        *   很多 ASP 和 JQuery 文件夹

感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T23:31:02.647

我认为您在这里有两个不同的问题：知道要部署哪些文件并获得正确的权限以便您可以访问它们。

通常，您需要部署的文件是所有静态文件（图像、CSS、Javascript、HTML）、任何 .cshtml/.aspx/.ascx/.asax 文件和 Web.config。但是，了解要部署哪些文件的最简单（也是最好）的方法是使用 Visual Studio 的发布机制。转到 Build->Publish，然后发布到本地目录。打开该目录，您将看到需要部署的所有文件。

至于第二个问题，那就更复杂了。解决方案取决于 IIS 的版本，但基本结果是您需要为您的文件授予正确的用户访问权限。根据您的 IIS 版本及其混淆程度，它可能是 IUSR、IIS_IUSRS 或 NETWORK SERVICE。尝试谷歌搜索“文件权限 IIS”。

# spring - Weblogic - 访问spring taglib时出错

> ID：10081114
> 
> 赞同：2
> 
> 时间：2012-04-09T23:22:58.433
> 
> 标签：spring, tags, weblogic, weblogic12c

当我尝试使用 spring taglibs 访问页面时出现错误。在部署期间没有任何错误。

错误：

```
personAdd.jsp:2:5: No tag library could be found with this URI. 
Possible causes could be that the URI is incorrect, or that there 
were errors during parsing of the .tld file.
<%@ taglib uri="http://www.springframework.org/tags/form" prefix="form" %> 
```

网络逻辑：12c Sts：2.9.1

关于可能出现的问题、在哪里查找以及如何/修复什么的任何建议？

# php - Cakephp 2.1.1 auth APC 缓存错误

> ID：10081115
> 
> 赞同：1
> 
> 时间：2012-04-09T23:23:00.260
> 
> 标签：php, apache, cakephp, caching

尝试登录 Cakephp 应用程序时出现以下错误。

```
Warning (512): _cake_model_ cache was unable to write 'default_ticketing_tickets' to Apc cache [CORE/Cake/Cache/Cache.php, line 306] 
```

这发生在随机场合，我不知道为什么。

我已将 tmp 文件夹、文件和子文件夹启用为 777

由于它仍然无法正常工作，我还需要做些什么吗？

这是在 Cent OS 服务器上

**更新：** 以下是我收到的错误消息。

```
Cache::write() - CORE/Cake/Cache/Cache.php, line 306
DataSource::_cacheDescription() - CORE/Cake/Model/Datasource/DataSource.php, line 306
Mysql::describe() - CORE/Cake/Model/Datasource/Database/Mysql.php, line 334
Model::schema() - CORE/Cake/Model/Model.php, line 1281
FormHelper::_introspectModel() - /home/commstrat2_web/html/roadconference/lib/Cake/View/Helper/FormHelper.php, line 191
FormHelper::create() - /home/commstrat2_web/html/roadconference/lib/Cake/View/Helper/FormHelper.php, line 444
include - APP/View/Users/login.ctp, line 3
View::_evaluate() - /home/commstrat2_web/html/roadconference/lib/Cake/View/View.php, line 908
View::_render() - /home/commstrat2_web/html/roadconference/lib/Cake/View/View.php, line 872
View::render() - /home/commstrat2_web/html/roadconference/lib/Cake/View/View.php, line 463
Controller::render() - /home/commstrat2_web/html/roadconference/lib/Cake/Controller/Controller.php, line 962
Dispatcher::_invoke() - /home/commstrat2_web/html/roadconference/lib/Cake/Routing/Dispatcher.php, line 110
Dispatcher::dispatch() - /home/commstrat2_web/html/roadconference/lib/Cake/Routing/Dispatcher.php, line 85
[main] - APP/webroot/index.php, line 96 
```

# python - SQLAlchemy - 选择更新示例

> ID：10081121
> 
> 赞同：42
> 
> 时间：2012-04-09T23:23:36.940
> 
> 标签：python, sqlalchemy, select-for-update

我正在寻找一个在 SQLAlchemy 中使用 select 进行更新的完整示例，但没有找到一个谷歌搜索。我需要锁定一行并更新一列，以下代码不起作用（永远阻塞）：

```
s = table.select(table.c.user=="test",for_update=True)
# Do update or not depending on the row
u = table.update().where(table.c.user=="test")         
u.execute(email="foo") 
```

我需要提交吗？我怎么做？据我所知，您需要：开始事务选择...用于更新更新提交

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2017-03-04T22:32:35.633

如果您使用的是 ORM，请尝试使用[with_for_update](http://docs.sqlalchemy.org/en/latest/orm/query.html?highlight=update#sqlalchemy.orm.query.Query.with_for_update)函数：

```
foo = session.query(Foo).filter(Foo.id==1234).with_for_update().one()
# 该行现在被锁定

foo.name = '酒吧'
session.add(foo)

session.commit()
# 此行现在已解锁

```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2013-08-09T10:40:54.257

*迟到的答案，但也许有人会觉得它有用。*

首先，您不需要提交（至少不需要在查询之间，我假设您正在询问）。您的第二个查询无限期挂起，因为您正在有效地创建到数据库的两个并发连接。第一个是获取选定记录的锁定，然后第二个尝试修改锁定的记录。所以它不能正常工作。（顺便说一下，在给出的示例中，您根本没有调用第一个查询，所以我假设在您的真实测试中您在`s.execute()`某处做了类似的事情）。因此，工作实现应该看起来更像：

```
s = conn.execute(table.select(table.c.user=="test", for_update=True))
u = conn.execute(table.update().where(table.c.user=="test"), {"email": "foo"})
conn.commit() 
```

当然，在这种简单的情况下，没有理由进行任何锁定，但我想这只是示例，您计划在这两个调用之间添加一些额外的逻辑。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-10T07:26:46.690

是的，您确实需要提交，您可以在 上执行或明确`Engine`创建。`Transaction`修饰符也在`values(...)`方法中指定，而不是`execute`：

```
>>> conn.execute(users.update().
...              where(table.c.user=="test").
...              values(email="foo")
...              ) 
>>> my_engine.commit() 
```

# objective-c - 使用 Core Data 和 Grand Central Dispatch (GCD) 优雅终止 NSApplication

> ID：10081123
> 
> 赞同：7
> 
> 时间：2012-04-09T23:23:48.580
> 
> 标签：objective-c, macos, cocoa

我有一个通过 Grand Central Dispatch (GCD) 执行某些进程的 Cocoa 应用程序 (Mac OS X SDK 10.7)。这些进程正在以我认为是线程安全的方式操作一些核心数据 NSManagedObjects（非基于文档）（创建一个新的 managedObjectContext 以在该线程中使用）。

**我遇到的问题**是当调度队列仍在运行时用户尝试退出应用程序。

NSApplication 委托在实际退出之前被调用。

```
- (NSApplicationTerminateReply)applicationShouldTerminate:(NSApplication *)sender 
```

我收到错误“无法合并更改”。这在某种程度上是意料之中的，因为仍然有通过不同的 managedObjectContext 执行的操作。然后，我会看到使用核心数据应用程序生成的模板中的 NSAlert。

在[Threading Programming Guide](https://developer.apple.com/library/archive/documentation/Cocoa/Conceptual/Multithreading/AboutThreads/AboutThreads.html)中有一个名为“Be Aware of Thread Behaviors at Quit Time”的部分提到使用[replyToApplicationShouldTerminate:](https://developer.apple.com/documentation/appkit/nsapplication/1428594-replytoapplicationshouldterminat)方法。我在实现这一点时遇到了一些麻烦。

**我希望**我的应用程序完成对排队项目的处理，然后在不向用户显示错误消息的情况下终止。更新视图或使用工作表让用户知道应用程序正在执行某些操作并将在操作完成时终止也会很有帮助。

我将在哪里以及如何实现这种行为？

**解决方案**：所以我在这里遇到了一些不同的问题。

1.  我有块正在访问核心数据，以`dispatch_queue`防止我的应用程序正常终止。

2.  当我尝试向 dispatch_queue 添加新项目时，dispatch_queue 的新实例在新线程上启动。

我为解决这个问题所做的工作是`NSNotificationCenter`在我的`AppDelegate`（`(NSApplicationTerminateReply)applicationShouldTerminate:(NSApplication *)sender`被调用的地方）中使用。在 Core Data 生成的模板代码中添加以下内容：

```
// Customize this code block to include application-specific recovery steps.
if (error) {
    // Do something here to add queue item in AppController
    [[NSNotificationCenter defaultCenter] postNotificationName:@"TerminateApplicationFromQueue" object:self];
    return NSTerminateLater;
} 
```

然后`AppController`为通知添加一个观察者（我将其添加到`awakeFromNib`）：

```
- (void)awakeFromNib {
    NSNotificationCenter *center = [NSNotificationCenter defaultCenter];
    [center addObserver:self selector:@selector(terminateApplicationFromQueue:) name:@"TerminateApplicationFromQueue" object:nil];

    // Set initial state of struct that dispatch_queue checks to see if it should terminate the application.
    appTerminating.isAppTerminating = NO;
    appTerminating.isTerminatingNow = NO;
} 
```

我还创建了一个`struct`可以检查用户是否想要终止应用程序的方法。（我在上面设置了结构的初始状态`awakeFromNib`）。`struct`在您的`@synthesize`陈述之后放置：

```
struct {
    bool isAppTerminating;
    bool isTerminatingNow;
} appTerminating; 
```

`dispatch_queue`现在对于阻止应用程序正常终止的长期运行。当我最初创建这个`dispatch_queue`时，一个 for 循环用于添加需要更新的项目。执行此 for 循环后，我添加了另一个队列项，它将检查`struct`应用程序是否应该终止：

```
// Additional queue item block to check if app should terminate and then update struct to terminate if required.
dispatch_group_async(refreshGroup, trackingQueue, ^{ 
    NSLog(@"check if app should terminate");
    if (appTerminating.isAppTerminating) {
        NSLog(@"app is terminating");
        appTerminating.isTerminatingNow = YES;
    }
});
dispatch_release(refreshGroup); 
```

以及收到通知时要调用的方法：

```
- (void)terminateApplicationFromQueue:(NSNotification *)notification {
    // Struct to check against at end of dispatch_queue to see if it should shutdown.
    if (!appTerminating.isAppTerminating) {
        appTerminating.isAppTerminating = YES;
        dispatch_queue_t terminateQueue = dispatch_queue_create("com.example.appname.terminate", DISPATCH_QUEUE_SERIAL);  // or NULL
        dispatch_group_t terminateGroup = dispatch_group_create();

        dispatch_group_async(terminateGroup, terminateQueue, ^{ 
            NSLog(@"termination queued until after operation is complete");
            while (!appTerminating.isTerminatingNow) {
            //  add a little delay before checking termination status again
                [NSThread sleepForTimeInterval:0.5];
            }
            NSLog(@"terminate now");
            [NSApp replyToApplicationShouldTerminate:YES];
        });
        dispatch_release(terminateGroup);
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T23:55:35.743

我自己没有处理过这个问题，但从我阅读文档来看，看起来你应该做的是：

1.  从. `NSTerminateLater`_ `applicationShouldTerminate:`这让系统知道您的应用程序尚未准备好终止*，*但很快就会终止。
2.  在您的调度队列中排队一个“最终”块。（您需要确保其他块在此之后没有入队。在执行完所有其他工作后，该块将运行。注意队列必须是串行的——不是并发队列之一）才能正常工作.) “final”块应该做`[NSApp replyToApplicationShouldTerminate:YES];`，这将完成正常的终止过程。

没有任何直接的方法可以确定 GCD 队列是否仍在工作。你唯一能做的（据我所知）来处理这个问题是将所有块放入一个[调度组](http://developer.apple.com/library/mac/documentation/Performance/Reference/GCD_libdispatch_Ref/Reference/reference.html#//apple_ref/doc/uid/TP40008079-CH102-SW3)中，然后在组中等待`applicationShouldTerminate:`（使用[`dispatch_group_wait()`](http://developer.apple.com/library/mac/documentation/Performance/Reference/GCD_libdispatch_Ref/Reference/reference.html#//apple_ref/doc/uid/TP40008079-CH2-SW27).

# actionscript-3 - MOUSE_MOVE 和 MOUSE_OUT 应用于舞台的问题

> ID：10081124
> 
> 赞同：0
> 
> 时间：2012-04-09T23:24:16.233
> 
> 标签：actionscript-3

我在不应该调用 MOUSE_OUT 时遇到问题。我所做的很简单：当我在舞台上移动鼠标时会显示两个图像，当鼠标离开舞台时它们会被隐藏。

问题是，每当鼠标碰到舞台上任何影片剪辑的边框时，都会调用 MOUSE_OUT 函数，从而隐藏两个图像。这意味着每当我移动鼠标时

我的代码（仅显示相关部分）：

```
public class Slider extends MovieClip {
    var img1:Img1 = new Img1;
    var img2:Img2 = new Img2;
    var img1_hover:Img1_hover = new Img1_hover;
    var img2_hover:Img2_hover = new Img2_hover;

    public function Slider() {
        img1.alpha = 0;
        img2.alpha = 0;

        stage.addEventListener(MouseEvent.MOUSE_MOVE, showArrows);
    }
    function showArrows(e:MouseEvent) {
         img1.alpha = 1;
         img2.alpha = 1;

         stage.addEventListener(MouseEvent.MOUSE_OUT, hideArrows);
    }
    function hideArrows(e:MouseEvent) {
         img1.alpha = 0;
         img2.alpha = 0;
    }
 } 
```

Flash 不会引发错误。我正在使用一个单独的 .as 文件（只有一个），并且 .fla 的操作面板内没有代码。哪里有stage.addEventListener，我也试过这个。，root。没有什么可以代替舞台。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T00:09:15.210

您想改用 MOUSE_LEAVE 事件[http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/display/Stage.html#event:mouseLeave](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/display/Stage.html#event:mouseLeave)

或者，在 hideArrows 函数中，您可以检查事件的目标：

```
function hideArrows(e:MouseEvent) {
    If(e.target == stage){
         img1.alpha = 0;
         img2.alpha = 0;
    }
} 
```

# java - 解析文件目录 - 检查字符串

> ID：10081127
> 
> 赞同：1
> 
> 时间：2012-04-09T23:25:11.493
> 
> 标签：java, parsing, search, data-structures

这是我在这里的第一篇文章，所以请原谅我的任何错误。我仍在学习如何在 Stack Exchange 中寻找出路。

我正在尝试编写一个 Java 程序，该程序试图扫描一个充满 .txt、.rtf 或 .doc 文件（仅此而已）的目录。目的是搜索目录中的所有文件，并找出文件中是否存在特定字符串。如果是，则返回字符串和找到该字符串的文件名。

该程序的目的是，这是一个学校项目，其中该程序扫描呼叫中心员工的个人文件夹以检查他们是否存储了任何 CC/DC 号码，如果是，则报告文件夹名称 - 以减少 CC 欺诈。

当我单独指定文件名时，搜索功能非常简单。但是，搜索目录并将文件传递给搜索功能让我很难过。

到目前为止，我已经发布了我的代码，如果你们可以看一下并给我一些反馈/建议，我将非常感激。提前致谢

```
import java.io.*;
import java.util.*;

public class parse2{

void traverse(String directory) throws FileNotFoundException   
    {  
        File dir = new File(directory);  
            if (dir.isDirectory())  
        {  
                   String[] children = dir.list();  
                   for (int i=0; i<children.length; i++)   
                {  
            //System.out.println("\n" + children[i]);
                    reader(children[i]);  
                }  
            }  

     }

void reader(String loc) throws FileNotFoundException
{   //System.out.println("\nC:/Documents and Settings/h4d35/Desktop/javatest/chk/"+loc);
    String s = ("C:/Documents and Settings/h4d35/Desktop/javatest/chk/"+loc);
    //System.out.println("\n"+s);
            FileReader fr = new FileReader(loc);
    BufferedReader br = new BufferedReader(fr);
    Scanner sc = new Scanner(br);
    char[] chkArray;
    int chk=1;
    char ch;
    while(sc.hasNext())
    {
        String chkStr = sc.next();
        chkArray = chkStr.toCharArray();
        if ((chkArray[0]=='4')&&(chkStr.length()>13))
        {   for(int i=0;i<chkArray.length;i++)
            {   ch=chkArray[i];
                if((ch=='0')||(ch=='1')||(ch=='2')||(ch=='3')||(ch=='4')||(ch=='5')||(ch=='6')||(ch=='7')||(ch=='8')||(ch=='9'))
                {   chk=0;
                    continue;
                }
                else 
                {   chk=1;
                    break;
                }
            }
            if(chk==0)
                System.out.println("\n"+ chkStr);
        }
        else
        if((chkArray[0]=='5')&&(chkStr.length()>13))
        {   for(int i=0;i<chkArray.length;i++)
            {   ch=chkArray[i];
                if((ch=='0')||(ch=='1')||(ch=='2')||(ch=='3')||(ch=='4')||(ch=='5')||(ch=='6')||(ch=='7')||(ch=='8')||(ch=='9'))
                {   chk=0;
                    continue;
                }
                else 
                {   chk=1;
                    break;
                }
            }
            if(chk==0)
            System.out.println("\n"+ chkStr);
        }
        else
        if((chkArray[0]=='6')&&(chkStr.length()>13))
        {   for(int i=0;i<chkArray.length;i++)
            {   ch=chkArray[i];
                if((ch=='0')||(ch=='1')||(ch=='2')||(ch=='3')||(ch=='4')||(ch=='5')||(ch=='6')||(ch=='7')||(ch=='8')||(ch=='9'))
                {   chk=0;
                    continue;
                }
                else 
                {   chk=1;
                    break;
                }
            }
            if(chk==0)
            System.out.println("\n"+ chkStr);
        }
    }
}

public static void main(String args[]) throws FileNotFoundException
{   
    parse2 P = new parse2();
    P.traverse("C:/Documents and Settings/h4d35/Desktop/javatest/chk");
}

} 
```

**

*   编辑：变量“loc”只给出文件名 - 所以我在字符串变量“s”下添加了路径的其余部分。没有输出。当我取消注释 reader() 函数的第 3 行时，它会显示所有文件的绝对路径。我通过显式指定绝对路径自己尝试了 reader() 函数，它起作用了。下面的代码：

    导入java.io.*；

    导入 java.util.*；

公共类解析1{

```
void read() throws FileNotFoundException
{   FileReader fr = new FileReader("C:/Documents and Settings/h4d35/Desktop/javatest/chk/Call back customer.txt");
    BufferedReader br = new BufferedReader(fr);
    Scanner sc = new Scanner(br);
    char[] chkArray;
    int chk=1;
    char ch;
    while(sc.hasNext())
    {
        String chkStr = sc.next();
        chkArray = chkStr.toCharArray();
        if ((chkArray[0]=='4')&&(chkStr.length()>13))
        {   for(int i=0;i<chkArray.length;i++)
            {   ch=chkArray[i];
                if((ch=='0')||(ch=='1')||(ch=='2')||(ch=='3')||(ch=='4')||(ch=='5')||(ch=='6')||(ch=='7')||(ch=='8')||(ch=='9'))
                {   chk=0;
                    continue;
                }
                else 
                {   chk=1;
                    break;
                }
            }
            if(chk==0)
                System.out.println("\n"+ chkStr);
        }
        else
        if((chkArray[0]=='5')&&(chkStr.length()>13))
        {   for(int i=0;i<chkArray.length;i++)
            {   ch=chkArray[i];
                if((ch=='0')||(ch=='1')||(ch=='2')||(ch=='3')||(ch=='4')||(ch=='5')||(ch=='6')||(ch=='7')||(ch=='8')||(ch=='9'))
                {   chk=0;
                    continue;
                }
                else 
                {   chk=1;
                    break;
                }
            }
            if(chk==0)
            System.out.println("\n"+ chkStr);
        }
        else
        if((chkArray[0]=='6')&&(chkStr.length()>13))
        {   for(int i=0;i<chkArray.length;i++)
            {   ch=chkArray[i];
                if((ch=='0')||(ch=='1')||(ch=='2')||(ch=='3')||(ch=='4')||(ch=='5')||(ch=='6')||(ch=='7')||(ch=='8')||(ch=='9'))
                {   chk=0;
                    continue;
                }
                else 
                {   chk=1;
                    break;
                }
            }
            if(chk==0)
            System.out.println("\n"+ chkStr);
        }
    }
}

public static void main(String args[]) throws FileNotFoundException
{   
    parse1 P = new parse1();
    P.read();
} 
```

}

**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T00:28:51.590

我看到的最大问题是你应该递归地调用`traverse()`目录，并且应该只调用`reader()`文件。您还应该尝试在调试器中单步执行有问题的代码行。在 Eclipse 或任何其他 IDE 中设置断点和单步执行代码非常容易。

您可以使用内置 API 轻松按文件扩展名进行过滤。签出[`FilenameFilter`](http://docs.oracle.com/javase/1.4.2/docs/api/java/io/FilenameFilter.html)and [`File.list(FilenameFilter)`](http://docs.oracle.com/javase/1.4.2/docs/api/java/io/File.html#list%28java.io.FilenameFilter%29)or (preferably) `File.listFiles(FilenameFilter)`。只要有可能，您应该尽量避免将文件和目录路径存储为`Strings`-- 而是使用`File`对象。

您的`reader`方法可以通过使用来简化[`String.matches(...)`](http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/String.html#matches%28java.lang.String%29)or `String.regionMatches(...)`。这两种方法（以及类似的方法）都是[正则表达式](http://docs.oracle.com/javase/tutorial/essential/regex/)比较——特别是看看这个[`Pattern`](http://docs.oracle.com/javase/7/docs/api/java/util/regex/Pattern.html)类。由于您经常重复相同的比较，因此您可能希望创建一个或多个`Pattern`s 以一遍又一遍地重用，但这只是性能优化。

# wordpress - 为什么我不能通过我的子主题功能覆盖 WP 的“excerpt_more”过滤器？

> ID：10081129
> 
> 赞同：4
> 
> 时间：2012-04-09T23:25:16.143
> 
> 标签：wordpress, function

我似乎无法让我的函数用于更改`excerpt_more`21 父主题的过滤器。

我怀疑这实际上可能是`add_action( 'after_setup_theme', 'twentyeleven_setup' );`问题所在，但我什至试图`remove_filter( 'excerpt_more', 'twentyeleven_auto_excerpt_more' )`摆脱 211 的功能，但我的功能仍然没有改变任何东西......

你能帮我吗？

**这是functions.php的完整代码：**

[http://pastie.org/3758708](http://pastie.org/3758708)

**这是我添加到 /mychildtheme/functions.php 的函数**

```
function clientname_continue_reading_link() {
    return ' <a href="'. esc_url( get_permalink() ) . '">' . __( 'Read more... <span class="meta-nav">&rarr;</span>', 'clientname' ) . '</a>';
}
function clientname_auto_excerpt_more( $more ) {
    return ' &hellip;' . clientname_continue_reading_link();
}
add_filter( 'excerpt_more', 'clientname_auto_excerpt_more' ); 
```

谢谢，

大须

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-12T08:12:01.630

好吧，在经历了很多挫折之后，我找到了解决方案（我认为儿童主题是为了加快速度！？）。我相信这是可行的，因为一旦设置了父主题，就会运行“after_theme_setup”，这意味着您可以在那时删除/覆盖 211 的功能。

如果我理解正确，根据本文档，首先运行子主题，然后是父主题，然后是子主题的 functions.php 文件中的“after_theme_setup”代码：

[http://codex.wordpress.org/Child_Themes#Using_functions.php](http://codex.wordpress.org/Child_Themes#Using_functions.php)

和

[http://codex.wordpress.org/Plugin_API/Action_Reference/after_setup_theme](http://codex.wordpress.org/Plugin_API/Action_Reference/after_setup_theme)

这是我的子主题的 functions.php 文件中的内容，希望这对某人有所帮助：

```
// ------------------------------------------------------------------
//                      // !AFTER_SETUP_THEME
// ------------------------------------------------------------------

/* Set up actions */
add_action( 'after_setup_theme', 'osu_setup' );

if ( ! function_exists( 'osu_setup' ) ):

function osu_setup() {

    // OVERRIDE : SIDEBAR GENERATION FUNCTION - NO WIDGETS FOR THIS SITE
    remove_action( 'widgets_init', 'twentyeleven_widgets_init' ); /* Deregister sidebar in parent */

    // OVERRIDE : EXCERPT READ MORE LINK FUNCTION
    function osu_readon_link() {
        return '...<a href="'. get_permalink() . '" class="readmore">' . __( 'Read More...', 'clientname' ) . '</a>';
    }
    // Function to override
    function osu_clientname_custom_excerpt_more( $output ) {
        if ( has_excerpt() && ! is_attachment() ) {
            // $output = trim($output);
            $output .= osu_readon_link();
        }
        return $output;
    }
    remove_filter( 'get_the_excerpt', 'twentyeleven_custom_excerpt_more' );
    add_filter( 'get_the_excerpt', 'osu_clientname_custom_excerpt_more' );
    remove_filter( 'excerpt_more', 'twentyeleven_auto_excerpt_more' );
    add_filter( 'excerpt_more', 'osu_readon_link' );

    // OVERRIDE : EXCERPT LENGTH FUNCTION
    function osu_clientname_excerpt_length( $length ) {
        return 30;
    }
    remove_filter( 'excerpt_length', 'twentyeleven_excerpt_length' );
    add_filter( 'excerpt_length', 'osu_clientname_excerpt_length' );

}
endif; // osu_setup 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2016-11-24T11:57:27.537

您自己的答案使事情复杂化，实际上没有必要。我无法解释我的答案的原因，因为我在另一个答案中找到了它。但是在任何情况下，您总是可以在子主题中覆盖父主题中的功能，尽管有时您确实需要`remove_filter()`预先使用，或者，就像在这种情况下，您所要做的就是增加您添加的过滤器的优先级，在您的案子：

```
add_filter( 'excerpt_more', 'clientname_auto_excerpt_more', 11 ); 
```

这应该够了吧。如果没有，请增加数量。感谢[这个答案](https://wordpress.stackexchange.com/questions/7979/i-cant-modify-the-continue-reading-link-of-the-excerpt)：

# c++ - 队列 C++ 的运算符重载

> ID：10081130
> 
> 赞同：0
> 
> 时间：2012-04-09T23:25:21.690
> 
> 标签：c++, class, queue, operator-overloading

我试图使用重载运算符方法将一个队列的条目复制到另一个队列中，但我的函数出错了。我不知道如何以任何其他方式访问队列“原始”的值，而不是下面的方式：

```
struct Node
{
   int item;
   Node* next;
};

class Queue
{
public:
    // Extra code here
    void operator = (const Queue &original);
protected:
    Node *front, *end;
};

void Queue::operator=(const Queue &original)
{
    //THIS IS WHERE IM GOING WRONG
    while(original.front->next != NULL) {
        front->item = original.front->item;
        front->next = new Node;
        front = front->next;
        original.front = original.front->next;
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-10T00:21:27.547

你有一个功能复制构造函数吗？如果是这样，我会根据您的复制构造函数来实现您的赋值运算符，如下所示：

```
#include <algorithm>  // <utility> for C++11

void Queue::operator=(const Queue &other)
{
    // Assumes your only field is the "front" pointer.

    Queue tmp(other);   // May throw.
    std::swap(front, tmp.front);  // Will not throw.
} 
```

这个想法是您执行任何可以在临时对象中抛出异常（例如您的调用`operator new()`）的操作，该对象将清理资源，然后通过在非抛出操作中交换内容来“提交”您的更改，所以即使`Queue`在`tmp`. `std::swap()`指针分配保证不会抛出，这就是在这种情况下调用不会抛出的原因。离开赋值运算符的范围后，`tmp`析构函数应清理旧链接列表，因为它`front`已与旧链接列表交换`front`。

有关此“*复制到临时并交换*”习语的详细信息，以及它与强大的异常安全保证的关系，请参见[GotW #59 。](http://www.gotw.ca/gotw/059.htm)

 ** * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-09T23:29:23.850

```
void Queue::operator=(const Queue &original)
{
    Node* tmp = original.front;
    //THIS IS WHERE IM GOING WRONG
    while(tmp->next != NULL) {
        front->item = tmp->item;
        front->next = new Node;
        front = front->next;
        tmp = tmp->next;
    }
} 
```*

# ios - 使用分组数据本地化 plist

> ID：10081136
> 
> 赞同：0
> 
> 时间：2012-04-09T23:26:05.360
> 
> 标签：ios, cocoa, localization, plist

有没有办法本地化包含分层或分组数据的 plist？

例如，如果 plist 包含：

*   第一册（字典）
    *   键（字符串）
    *   名称（字符串）
    *   描述（可本地化的字符串）
*   第 2 册（字典）
    *   键（字符串）
    *   名称（字符串）
    *   描述（可本地化的字符串）
        （等等...）

出于示例的目的`Key`，`Name`不应翻译 and （并且最好不要在多个本地化属性列表中重复）**。**

是否有一种机制可以在`Description`不本地化整个属性列表的情况下为可本地化的字段提供本地化？我想到的唯一其他策略是将查找键存储在`description`字段中，然后使用它通过 NSLocalizedString(...) 检索本地化文本

plist 是静态的，现在与应用程序包一起分发。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T00:27:38.597

这是静态 plist 还是动态 plist？您希望从哪里获得本地化字符串？`NSLocalizedString()`从包中的 Localizable.strings 文件中获取它。`NSLocalizedString()`如果 plist 是静态的，并且您可以将所有本地化内容与您的应用一起发布，那么您可以使用描述作为键并使用它的变体之一来查找它。

如果 plist 是动态的，那么您可以将每个 Description 转换为`dict`从语言环境标识符到字符串的映射。您会使用`[NSBundle preferredLocalizationsFromArray:[theDict allKeys]]`. 这样做的缺点是，如果同一描述用于多本书，则必须重复其本地化。

要解决这个缺点，您可以将本地化放入 plist 的单独部分中。基本上，这将是一本字典。外部字典的键可以是语言环境标识符，内部字典的键可以是英文字符串，内部值可以是本地化字符串。（变体 1：使用查找键而不是英文字符串。变体 2：反转内部和外部字典，因此英文字符串是外部的，区域设置 ID 是内部的。）

# jquery - 通过 jQuery 添加一个类

> ID：10081137
> 
> 赞同：0
> 
> 时间：2012-04-09T23:26:23.517
> 
> 标签：jquery

我有一些由 Sigma 动态创建的代码，如下所示：

```
<div id="myGrid1_headDiv" class="gt-head-div">
<div class="gt-head-wrap">
<table id="myGrid1_headTable" class="gt-head-table">
<tbody>
<tr class="gt-hd-row">
<td class="gt-col-mygrid1-uid">
<div class="gt-inner gt-inner-left" unselectable="on" title="#">
<span>#</span>
<div class="gt-hd-tool"><span class="gt-hd-icon"></span>
<span class="gt-hd-button"></span>
<span class="gt-hd-split" style="cursor: col-resize; "></span></div></div></td>
<td class="gt-col-mygrid1-p_deldate">
<div class="gt-inner gt-inner-left" unselectable="on" title="Planned Delivery Date">
<span>Planned Delivery Date</span>
<div class="gt-hd-tool"><span class="gt-hd-icon"></span>
<span class="gt-hd-button"></span>
<span class="gt-hd-split" style="cursor: col-resize; "></span></div></div></td> 
```

我正在尝试针对未分类的跨度（# 和计划的交付日期），以便为它们设置样式：

```
 $("div.gt-inner:first-child span")
    {
          $(this).addClass("celltitle");
        }; 
```

但它没有效果。如您所见，它周围还有其他我不想触及的跨度。我究竟做错了什么？

===== 使用 Sigma Grid 的其他人的最终答案：

感谢@minitech 的指点，答案是添加到 Sigma Grid 的 gridOption 中：

```
onComplete:function(grid){ 
 $('div.gt-inner > span').addClass('celltitle'); //add cell title after grid load
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T23:28:42.813

您已在其中插入了任意代码块。你需要使用jQuery的`.each`函数并传递你的函数；jQuery 是一个库，而不是一种语言结构。

```
$("div.gt-inner:first-child span").each(function() {
    $(this).addClass("celltitle");
}); 
```

或者，更简洁地说，因为`addClass`（像许多 jQuery 函数一样）隐式地对整个集合进行操作：

```
$('div.gt-inner:first-child span').addClass('celltitle'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T23:28:43.567

像这样使用它

```
$("div.gt-inner:first-child span").addClass("celltitle"); 
```

[演示](http://jsfiddle.net/g34SW/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-09T23:30:45.847

我认为这应该有效：

```
$("div.gt-inner span").addClass("celltitle") 
```

查看[http://api.jquery.com/addClass/](http://api.jquery.com/addClass/)了解更多信息。

# java - 在调试与发布模式下更改 Java 中的常量

> ID：10081139
> 
> 赞同：1
> 
> 时间：2012-04-09T23:27:08.777
> 
> 标签：java, debugging, client-server, release, conditional-compilation

我正在开发客户端-服务器应用程序的客户端，在测试期间我希望应用程序从我的本地主机获取数据，但是当我发布应用程序时，我希望它连接到我们的生产服务器。

我正在使用 Eclipse 用 Ja​​va 开发一个 Android 应用程序。有没有好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T23:29:45.350

使用配置文件。当您在本地构建它时，复制该配置文件的 -developer 版本。当您发布它时，复制该配置文件的 -release 版本。此外，我不会仅仅依靠“localhost”作为测试方式。在将连接到您的真实系统的模拟器中进行一些生产级测试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T23:29:13.993

只需针对不同的环境使用不同的配置文件。

# javascript - jsTree拖放并不总是有效

> ID：10081146
> 
> 赞同：2
> 
> 时间：2012-04-09T23:27:46.503
> 
> 标签：javascript

将节点拖到新位置并不总是粘住。我的代码就像

```
 $("#product-category-tree").jstree({
        "plugins":["themes", "html_data", "dnd"], 
        "themes":{
            "icons": false,
            "dots": false
        }
    }).bind("move_node.jstree", function(e , data){
        data.rslt.o.each(
            function(i){
                $.ajax({
                    type: 'PUT',
                    url: '/product_categories/move',
                    data: {
                        "operation" : "move_node",
                        'drag_id' : $(this).data("id"),
                        'drop_id' : data.rslt.np.data("id"),
                        'index' : data.rslt.cp + i
                    },
                    success: function(r){
                        if (r != 'success'){
                            alert(r);
                            $.jstree.rollback(data.rlbk);
                        }
                    }
                });
            }
        )
    }) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-09T15:20:20.513

项目的 GitHub 页面上有一个未解决的问题 ( [#174 )。](https://github.com/vakata/jstree/issues/174)你可以在那里找到很多解决方法。

我用过这个，它是侵入性最小的，但仅限于现代浏览器：

```
#jstree-marker-line {
    pointer-events: none;
} 
```

# python - 从节点邻域返回最大节点

> ID：10081149
> 
> 赞同：1
> 
> 时间：2012-04-09T23:27:55.320
> 
> 标签：python, networkx

我希望通过由 n 个节点组成的图 G。并为每个第 n 个节点打开其邻居的字典。找出哪个邻居具有最大的数字属性。至少可以有 100 个邻居。并返回每个节点及其最大邻居的列表，即

```
[node,biggestneighbor]
[node,biggestneighbor]
[node,biggestneighbor] 
```

节点的属性数据如下所示：

```
G.node[0]

{'type': 'a', 'pos': [0.76, 0.11]} 
```

我感兴趣的属性是

```
G.node[0]['pos'][0]

0.76 
```

有谁知道这是否存在？或者，如果不是，起始逻辑看起来是否是一个好的起点？还是更聪明的人有更好的主意？

```
def thebiggestneighbor(G,attribute,nodes=None):

    if nodes is None:
        node_set = G
    else:
        node_set = G.subgraph(nodes)
    node=G.node
    for u,nbrsdict in G.adjacency_iter():
        if u not in node_set:
            continue
            for v,eattr in nbrsdict.items():
                vattr=node[v].get(attribute,None)
          #  then something like this but for many nodes. probably better subtraction 
          #  of all nodes from each other and which one yeilds the biggest numner
          #  
          #  if x.[vattra] > x.[vattrb]  then
          #      a
          #  elif x.[vattra] < x.[vattrb] then
          #      b 

            yield (u,b) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T00:03:56.387

我喜欢用正确的数据结构解决这样的问题：

```
#nodes = [ (att_n, [(att_n, n_idx).. ] ), ... ]  where each node is known by its index
#in the outer list. Each node is represented with a tuple: att_n the numeric attribute, 
#and a list of neighbors. Neighbors have their numeric attribute repeated
#eg. node 1 has neighbors 2, and 3\. node 2 has neighbor 1 and 4, etc..: 
nodes = [ (192, [ (102, 2), (555, 3)] ), 
          (102, [ (192, 1), (333, 4) ] ), 
          (555, [ (192, 1),] ), ... 
    ]  
#then to augment nodes so the big neighbor is visible:
nodesandbigneighbor=[ (att_n, neighbors, max(neighbors)) for att_n, neighbors in nodes] 
```

此外，如果您保持邻居列表的排序顺序从低数字属性到高，那么您可以执行以下操作：

```
nodesandbigneighbor=[ (att_n, neighbors, neighbors[-1]) for att_n, neighbors in nodes] 
```

这会更快（以节点插入时间为代价），但是您在插入时有效地解决了问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T23:48:50.200

我并没有真正看到问题，您可以通过迭代所有节点和 foreach 节点迭代其邻居来执行 O(n*m) [n=nodes, m=avg(neighbors)] 操作。最坏的情况是 O(n^2)。此外，您还有一个缩进问题，因为您的大部分代码都在“继续”语句之后，所以它不会被执行。

代码示例

```
node=G.node
output=[]
for u,nbrsdict in G.adjacency_iter():
    if u not in node_set:
        continue
    max={'value':0,'node':None}
    for v,eattr in nbrsdict.items():
        vattr=node[v].get(attribute,None)
        if vattr>max['value']:
            max={'value':vattr,'node':node}
    output.append((node,max['node']))
return output 
```

# javascript - 使用 Javascript 在单击时隐藏 ImageButton

> ID：10081159
> 
> 赞同：2
> 
> 时间：2012-04-09T23:29:06.887
> 
> 标签：javascript, asp.net, imagebutton

我的页面上有两个 ImageButton。单击一个后，我想隐藏它并显示另一个。我目前的代码是：

```
var button_mute = document.getElementsByID("ImageButtonMute");
var button_unmute = document.getElementsByID("ImageButtonUnmute");

    function mute() {
        vid_left.mute();
        vid_right.mute();

        button_mute.style.display = "block";
        button_unmute.style.display = "none";
    }

    function unmute() {
        vid_left.unMute();
        vid_right.unMute();

        button_mute.style.display = "none";
        button_unmute.style.display = "block";
    }

<asp:ImageButton ID="ImageButtonMute" runat="server" 
        ImageUrl="~/icons/volume_mute_small.png" OnClientClick="mute()" />
    <asp:ImageButton ID="ImageButtonUnmute" runat="server" 
        ImageUrl="~/icons/volume_unmute_small.png" OnClientClick="unmute()" /> 
```

我没有在后面的代码中引用任何一个，我不确定为什么这不起作用。任何帮助表示赞赏，谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T23:41:47.043

使用此选择：

```
var button_mute = document.getElementsByID('<%= ImageButtonMute.ClientID %>');
var button_unmute = document.getElementsByID('<%= ImageButtonUnmute.ClientID %>'); 
```

这应该工作！

# c# - 自动检测要连接的端点地址 - WCF C#

> ID：10081168
> 
> 赞同：0
> 
> 时间：2012-04-09T23:30:18.070
> 
> 标签：c#, wcf

简单的故事，我使用 WCF 制作了一个服务器，现在我想将服务器移动到不同的位置。当移动客户端应用程序需要重新配置他们正在侦听的服务，因为 ip 不一样。你能自动化这个吗，当服务器移动时，所有监听它的应用程序都会自动检测服务器的新位置和地址。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T00:32:49.623

您需要使用 WCF 4 和[自动发现功能](http://msdn.microsoft.com/en-us/library/dd456782.aspx)。这是一个很好的[链接](https://msmvps.com/blogs/theproblemsolver/archive/2010/11/24/getting-started-with-wcf-discovery.aspx)，可以为您提供第一步

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T06:16:57.207

使用 WCF 4 发现。 [http://msdn.microsoft.com/en-us/library/dd456782.aspx](http://msdn.microsoft.com/en-us/library/dd456782.aspx)

# php - 强制变量作为对象传递

> ID：10081175
> 
> 赞同：0
> 
> 时间：2012-04-09T23:31:27.730
> 
> 标签：php, oop, object

我需要将传递变量的类型定义为泛型对象，如何？

试过：

```
public function set($service = null, (object) $instance) {
    [..]
} 
```

可以`stdClass`帮忙吗？如何？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T23:35:59.150

不，在 php 中，所有类都不是从共同祖先派生的。

所以怀疑你可以使用当前 php 的实现来声明“任何类的对象”

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T23:37:54.437

不，对象必须是某个类。您可以将任何类名作为对象的类型

```
public function set($service = null, ClassName $instance) {
    //now the instance HAS to be the object of the class
} 
```

或者一个基本技巧是自己创建一个基本类

```
Class GenericObject {}
$myobj = new GenericObject();
$myobj -> myCustomVar = 'my custom var';

//Now send it
public function set($service = null, GenericObject $instance) {
   [...]
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-09T23:40:31.017

加布里埃尔，

如果你想做的是检查变量是否是一个对象，你可以这样做：

```
public function set($service = null, $instance) {
    if (!is_object($instance)) return null; //or whatever
    [..]
} 
```

你想阻止什么？通过您的声明，如果变量不是对象（它不会强制转换它），您将获得异常。

# ruby-on-rails - Backbone.js 视图中的回形针 image.url

> ID：10081182
> 
> 赞同：0
> 
> 时间：2012-04-09T23:32:54.720
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.1, backbone.js, paperclip

我正在使用回形针保存图像。一切正常，我可以使用@item.image.url 访问该项目的 url。

```
class Item
 has_attached_file :image, :styles => {
      :original => ['1920x1680>', :jpg],
      :small => ['100x100>', :jpg],
      :medium => ['250x250>', :jpg],
      :large => ['500x500>', :jpg]
    }
end 
```

这是控制台：

```
> Item.last.image.url(:small)
=> "/system/images/items/1/small/chanel.jpg?1334005208" 
```

如果我从服务器模板化 HAML 或 ERB 并像这样将页面提供给用户，这将非常简单明了。项目/show.html.haml：

```
.item
  .item-image
    = image_tag @item.image.url(:small) 
```

但是，使用backbone.js，我无法构造URL，因为我没有上下文中的回形针助手。本质上，我将图像的以下属性以 json 形式发送到页面。

```
#<Item:0x007fc97559b960> {
                    :id => 1,
    :image_content_type => "image/jpeg",
       :image_file_name => "chanel.jpg",
       :image_file_size => 28880,
      :image_updated_at => 2012-04-09 21:00:08 UTC
} 
```

将 image.url 作为属性包含在项目上的忍者方法是什么。如何解释样式 URL？最好有一个像“image_small_url”、“image_normal_url”等预先确定和可访问的属性。想法？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-09T23:43:57.137

我正在使用[Jbuilder](https://github.com/rails/jbuilder)为我正在处理的项目构建 JSON 视图，因此我的`index`视图例如如下所示：

```
json.array!(@things) do |json, thing|
  json.id thing.id
  json.name thing.name
  json.description thing.description
  json.image_url thing.image.url
  json.thumb_url thing.image.url(:thumb)
end 
```

这样，在我的 Backbone 模板中，我只能说`thing.get('image_url')`and `thing.get('thumb_url')`。

简而言之，您需要使用 Jbuilder 之类的东西，或者`as_json`在模型中手动覆盖。就个人而言，我喜欢在视图级别处理这个问题，这是 Jbuilder 允许您轻松完成的事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-19T19:34:22.593

虽然在控制器中生成 JSON 是可行的，但我*更喜欢在装饰器（例如*[Draper](https://github.com/drapergem/draper)）或为 RESTful 资源（例如[Roar](https://github.com/apotonick/roar)）设计的框架中封装这种功能。

这使模型与其外部表示之间的映射保持高度本地化，允许在 Web 应用程序框架之外直接测试表示，等等。

例如，clem 的答案将被隔离在一个类中，大致如下：

```
class ThingDecorator < Draper::Decorator
  delegate_all

  def image_url; object.image.url;         end
  def thumb_url; object.image.url(:thumb); end
end 
```

然后在控制器中，例如：

```
@things = Thing.some_scope.decorate # Or
@things = ThingDecorator.decorate_collection(Thing.all) 
```

（或者你需要的任何东西，什么工作取决于 Rails 版本，请参阅 Draper 文档。）

然后使用常规方法将集合公开为 JSON。IMO 这几乎总是更干净。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-26T21:47:08.410

另一个使用[jbuilder](https://github.com/rails/jbuilder)的简单示例：

```
# index.json.jbuilder
json.array!(@shared_snap_casts) do |shared_snap_cast|
  json.extract! shared_snap_cast, :id, :snap
end 
```

这`:snap`是回形针附件 - 此示例的输出为：

```
[{"id":1,"snap":"/system/shared_snap_casts/snaps/000/000/001/original/some_icon.png?1388093936"}] 
```

希望这可以帮助！

# android - 查看 getHeight() 和 getWidth() 返回值太大

> ID：10081183
> 
> 赞同：8
> 
> 时间：2012-04-09T23:33:07.017
> 
> 标签：android, view, viewlayout

我在方法的自定义视图中调用 getHeight 和 getWidth `onDraw()`。 `getHeight()`返回`1,073,742,549`和`getWidth()`返回`1,073,742,304`。但是，当我查看屏幕高度和宽度的显示指标时，我分别得到 800 和 480。getHeight 和 getWidth 返回什么？

我正在获取视图的尺寸，因此我可以选择将在视图中显示的位图的尺寸。

谢谢。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-09T23:42:06.933

没有明确解决你的问题，但奇怪的是：

```
Width:
1,073,742,304 == 0x400001E0
          480 == 0x000001E0

Height:
1,073,742,549 == 0x400002D5
          725 == 0x000002D5 
```

这个自定义视图有可能是大约 725 x 480 吗？我不知道额外的 0x40000000 是从哪里来的，但看起来除了 1 位之外它几乎是正确的 :)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-09T23:36:57.510

`getHeight()`并`getWidth()`返回像素大小见[http://developer.android.com/reference/android/view/View.html#getHeight%28%29](http://developer.android.com/reference/android/view/View.html#getHeight%28%29)

额外的大小可能来自`View.MeasureSpec`常量，`EXACTLY`请参阅[http://developer.android.com/reference/android/view/View.MeasureSpec.html#getSize%28int%29](http://developer.android.com/reference/android/view/View.MeasureSpec.html#getSize%28int%29)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-21T09:00:34.317

也许，您在自定义视图中做了类似的事情。

```
final int desiredHSpec = MeasureSpec.makeMeasureSpec(pixelHeight, MeasureSpec.MODE_CONSTANT);
final int desiredWSpec = MeasureSpec.makeMeasureSpec(pixelWidth, MeasureSpec.MODE_CONSTANT);
setMeasuredDimension(desiredWSpec, desiredHSpec); 
```

像这样[的Android：为什么在自定义视图中覆盖onMeasure（）后，视图的文本不能在RalativeLayout中显示？](https://stackoverflow.com/questions/8686084/androidwhy-after-override-onmeasure-in-a-custom-view-the-views-text-cant-s)

如果你把它改成

```
setMeasuredDimension(width, height); 
```

，您将在 onSizeChanged() 和 onLayout() 上获得简单的小宽度、高度。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-07-20T18:06:41.940

我也有这个问题。我解决它的方法是覆盖 onMeasure 方法。这样视图总是具有相同的大小。例如，如果您希望视图具有屏幕的大小和宽度，您应该执行以下操作：

```
 @Override 
    protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec)
    {
        super.onMeasure(widthMeasureSpec, heightMeasureSpec);
        WindowManager wm = (WindowManager)this.getContext().getSystemService(Context.WINDOW_SERVICE);
        Display display = wm.getDefaultDisplay();
//display.getWidth() and display.getHeight() return the screen dimensions
        this.setMeasuredDimension(display.getWidth(), display.getHeight());
    } 
```

# regex - 导致 JSON.parse 失败的隐藏字符是什么？

> ID：10081185
> 
> 赞同：1
> 
> 时间：2012-04-09T23:33:11.943
> 
> 标签：regex, json, character

我在 JavaScript 中使用 JSON.parse 来解析一些 JSON。如果我复制[此示例](http://www.jquery4u.com/json/iphone-menu-json-example/)中的文本，则会出现问题。我双击将文本复制到我的剪贴板。如果我使用正则表达式去除所有空格，它就可以工作。但我找不到冒犯性的角色。我试过了：

```
replace(/\t/g,'');
replace(/\n/g,'');
replace(/\r/g,'');
replace(/\0/g,'');
replace(/\x0B/g,''); 
```

......仍然是冒犯性的角色。我能做些什么来追踪它。如果我将文本粘贴到 Windows 中的记事本中，则会删除该字符并且 JSON.parse 有效。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T07:22:37.767

当我复制并粘贴它时，缩进由 NO-BREAK SPACE 字符组成，代码 0x80，它以 UTF-8 编码为序列 0xc2, 0xa0

当我用普通空格（0x20）替换所有 NO-BREAK SPACE 字符时，我可以将其解析为 JSON（使用 Perl 的`JSON::decode_json`）。

# c - 在 C 中将字符串转换为十六进制时遇到问题

> ID：10081187
> 
> 赞同：0
> 
> 时间：2012-04-09T23:33:38.570
> 
> 标签：c, pointers, hex, decimal

我在编写将十进制转换为十六进制的代码时遇到问题。

```
void decToHex (char *decString){
    char hexVal[100];
    sprintf(hexVal,"%x", *decString);
    *decString = hexVal;
    return;
} 
```

> 编译错误：警告：赋值从一个没有强制转换的整数创建一个指针（默认启用）；说到“*decString = hexVal;”这一行 我试图将我的指针值设置为新发现的十六进制值。

有谁知道我做错了什么？我已经阅读了一些其他帖子，这些帖子说这可能是编译器的问题，但是我们的班级需要使用内置于我们的 putty 服务器中的标准 c99 编译器。关于如何做到这一点的任何想法？我还尝试根据模数 16 的想法创建一个整数数组，但我有更多的问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T23:43:23.760

`*decString`是一个字符。`hexVal`(在此上下文中) 是指向 char 的指针，因此您尝试将地址存储在 char 中。因此错误。

即使你会这样做`decString=hexVal`，它也不会起作用，原因有两个：它`decString`只会在函数中改变，并且`hexVal`是一个局部变量，所以它在函数之外是无效的。

取而代之的是，将字符串从复制`hexVal`到`decString`: `strcpy(decString, hexVal);`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T23:38:23.280

您无法按照您尝试的方式分配 C 字符串。相反，你想要：

```
strcpy(decString, hexVal); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-09T23:43:58.707

线路`*decString = hexVal;`有问题。 `decString`是指向 a 的指针`char`，因此`*decString`表示 a `char`。但是，`hexVal`是 a `char*`（从技术上讲，它是`&hexVal[0]`）。您正在尝试将*指针*分配给*字符*。除非您在 8 位平台上，否则指针不适合字符。此外，指针是指向局部变量的指针，这意味着一旦函数返回，指针将无效。如果您尝试复制字符串，请`strncpy()`改用。

为了澄清您的任务，您是否尝试将十进制数的*字符串表示形式转换为十六进制**字符串表示形式*？如果是这样，如果将字符串转换为整数然后再转换回字符串而不是尝试直接转换字符串，您可能会更成功。`sscanf()`和`sprintf()`应该照顾它的组合。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-10T00:02:58.827

在这条线上：

```
*decString = hexVal; 
```

这`*decString`是 a `char`，因此您正在分配一个指向 a 的指针`char`，因此是警告。

您不能在 C 中分配字符串；一般来说，您必须复制它们。

但是，您还需要指定要转换的值，并确保为格式化的值提供足够的空间。目前，您正在获取第一个字符`decStr`并将其转换为十六进制，这作为接口有点不寻常（实际上可能是错误的）。

你通常会这样做：

```
void decToHex(int value, char *hexString)
{
    sprintf(hexString,"%x", value);
} 
```

注意更改的界面。这不允许函数检查它是否有足够的空间；可悲的是，将责任放在调用代码上是一个长期存在（但很麻烦）的 C 传统。更安全的方法是使用`snprintf()`C99：

```
int decToHex(int value, char *buffer, size_t buflen)
{
    return snprintf(buffer, buflen, "%x", value);
} 
```

这告诉您字符串有多长，或者如果没有空间容纳所有数据，缓冲区应该有多长（Windows 除外，当转换的字符串太长时它返回 -1）。字符串应该以 null 结尾（注意 MSVC），并且永远不应该溢出由`buffer`and指定的缓冲区`buflen`。原则上，设置`buffer`为 NULL 应该允许您找出需要多大的缓冲区（再次小心 MSVC）。

你通常会这样称呼它：

```
char buffer[20];

if (decToHex(314159265, buffer, sizeof(buffer)) >= sizeof(buffer))
    ...oops - conversion failed... 
```

或者，更懒惰：

```
 char buffer[32];  // Bigger margin for error

 decToHex(314159265, buffer, sizeof(buffer)); 
```

# windows-phone-7 - 将两个对象传递给 TimerCallback

> ID：10081189
> 
> 赞同：0
> 
> 时间：2012-04-09T23:33:46.160
> 
> 标签：windows-phone-7

我需要能够影响 TimerCallback 中的多个 Textblock 元素。目前，我有这个：

```
t = new Timer(tc, myLabel, 0, 1000); 
```

但是，在 tc 中，我想做以下事情：

```
myLabel.Text = "ABC";
myLabel2.Text = "DEF"; 
```

我还没有弄清楚如何将多个对象传递给我的 TimerCallback。每当我尝试在 TimerCallback 中设置 TextBlock 时，都会出现错误：

```
System.UnauthorizedAccessException 
```

我尝试在对象数组中编码，但没有奏效。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T23:49:50.827

你需要使用`DispatchTimer`. 你必须这样做，因为它是一个单独的线程。

```
 private void InitializeTimers()
            {
                DispatcherTimer tmr = new DispatcherTimer();
                tmr.Interval = TimeSpan.FromSeconds(1);
                tmr.Tick += OnTimerTick;
                tmr.Start();
            }

  private void OnTimerTick(object sender, EventArgs args)
        {
              //do whatever you want
        } 
```

# mongodb - Mongoid，通过部分 Id 搜索找到对象？

> ID：10081193
> 
> 赞同：1
> 
> 时间：2012-04-09T23:34:13.487
> 
> 标签：mongodb, mongoid

我希望能够通过搜索 id 的最后 4 个字符来搜索我的对象。我怎样才能做到这一点？

```
Book.where(_id: params[:q]) 
```

参数类似于 的地方`a3f4`，在这种情况下，我想要找到的对象的实际 id 将是：

```
bc313c1f5053b66121a8a3f4 
```

注意最后一个 for 字符是我们搜索的。如何仅搜索我的对象 ID 的“部分”？而不是让我的用户通过输入*整个*ID 手动搜索？

我在 MongoDB 的帮助文档中发现，我可以提供一个正则表达式：

```
db.x.find({someId : {$regex : "123\\[456\\]"}}) // use "\\" to escape 
```

有没有办法让我使用常规的 mongo ruby​​ 驱动程序而不是使用 Mongoid 进行搜索？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T10:12:59.087

通常，在 Mongoid 中，您可以使用正则表达式进行搜索，就像您通常在调用`where()`ie 时使用字符串一样：

```
Book.where(:title => /^Alice/) # returns all books with titles starting with 'Alice' 
```

但是，这在您的情况下不起作用，因为该`_id`字段不是作为字符串存储的，而是作为 ObjectID 存储的。但是，您可以在模型上添加（和索引）一个可以为您提供此功能的字段，您可以在`after_create`回调中填充该字段。

`<shameless_plug>`

或者，如果您只是在寻找默认 Mongoid ID 的较短解决方案，我可以建议使用类似[mongoid_token](https://github.com/thetron/mongoid_token)的方法，这样可以很容易地将较短的令牌/id 添加到您的 Mongoid 文档中。

`</shameless_plug>`

# c# - 我的窗口应该使用什么 WPF 控件？

> ID：10081199
> 
> 赞同：0
> 
> 时间：2012-04-09T23:35:23.847
> 
> 标签：c#, wpf, wpf-controls

所以我正在制作一个 WPF 项目，其中我的一个窗口必须让用户看到文本。选择此文本的一部分以放入字符串数组中，仅此而已。因此，他/她必须能够编辑文本中的任何内容，仅突出显示部分，然后单击按钮。什么 WPF 控件可以聪明地用于此目的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T23:37:38.760

我可能只是用`TextBox`set `IsReadOnly`。之后，您只需要各种选择属性。

# python - FIPS 县代码查询

> ID：10081203
> 
> 赞同：0
> 
> 时间：2012-04-09T23:35:51.070
> 
> 标签：python

我正在寻找一个库或 Python 中的某种方法来从[县代码](http://en.wikipedia.org/wiki/FIPS_county_code)（例如 48235 即德克萨斯州伊里恩县）返回县名。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T00:41:21.837

您正在寻找的基本上是县代码到县的映射。

获取一个很简单，只需找到一个县列表（Google 会在这方面为您提供帮助：）`www.schooldata.com/pdfs/US_FIPS_Codes.xls`，然后将其中的数据转换为适合您需要的数据结构（可能是字典，但您可以将其存储在数据库）。

使用模块读取此`.xls`文件中的数据应该很漂亮`xlrd`，但您也可以将其转换为`.csv`并使用`csv`模块。

真的，您所看到的内容是如此基础，以至于真的不需要图书馆。

# c - 'fgets' 在 'printf' 之后运行

> ID：10081209
> 
> 赞同：3
> 
> 时间：2012-04-09T23:36:15.720
> 
> 标签：c

我正在慢慢学习 C。我在这里阅读了有关处理字符串的输入和输出的页面：[http ://www.cprogramming.com/tutorial/c/lesson9.html](http://www.cprogramming.com/tutorial/c/lesson9.html)

在最后一个代码示例中，`fgets`用于获取输入变量并将其分配给 char 数组`name`。我尝试在自己的程序中实现类似的东西。

```
#include <stdio.h>
#include <stdbool.h>
#include <stdlib.h>
#include <string.h>

/* This is my very first C program! */

bool test=true;

/* Function Prototypes */

int mult(int x, int y);

/* Structures */

struct Person {
    int age;
    char name[256];
};

/* Complicated Array ;P */

struct Person *FirstPeriod[22];
char FakeString[100];

void PracticeStrings()
{
    int i;
    fgets(FirstPeriod[0]->name, 256, stdin);
    for (i=0;i<256;i++)
    {
            if (FirstPeriod[0]->name[i]=='\n')
                FirstPeriod[0]->name[i]='\0';
    }
    printf("\n\nHello Student 0: %s",FirstPeriod[0]->name);
}

int main()
{
    struct Person DadeLamkins;
    DadeLamkins.age=16;
    int numb;
    int x;
    int *numb_address=&numb;
    numb_address=malloc(sizeof(*numb_address));

    FirstPeriod[0]=&DadeLamkins;

    if (true)
        printf("-__- \n\n");

    printf("Please enter a number: ");
    scanf("%d", &numb);
    switch (numb) {
        case 0:
            printf("Dude, 0 is lame...\n");
            break;
        case 7:
            printf("Dude, 7 is my favorite number!\n");
            break;
        default:
            printf("You entered %d\n", numb);
            break;
    }
    for (x=0;x<numb+1;x++) {
        printf("\n::# %d",mult(x,2));
    }
    printf("\n\n%d",numb_address);
    free(numb_address);
    numb_address=0;
    PracticeStrings();
    getchar();
    return 0;
}

int mult (int x, int y)
{
    return x*y;
} 
```

第`PracticeStrings`26 行的函数是当前的问题。当我编译时，它会***`Hello Student 0:`*** 在接受输入（来自`fgets`）之前显示。我正在使用 Code::Blocks 进行编译。

任何帮助，将不胜感激！

# 编辑...

哈哈哈，是的，我明白我的程序效率低下，很傻。如您所知，它并没有真正完成太多。它主要是推动我目前正在学习的东西并尝试应用这些东西而不实际重写代码示例（如果我逐字复制我会学到什么？）。无论如何，感谢您的帮助！我想这确实有道理！太糟糕了，我的教程没有提到这一点，我相信这只是需要一点更高的理解。我敢肯定，教程作者没想到有人会像我那样混合这些功能。

非常感谢你们！希望我能习惯这一点。我用 .net 语言编写了大量脚本和大量内容，希望我可以添加`C`到此列表中：)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-10T00:06:50.273

这是因为当您阅读数字时：

```
scanf("%d", &numb); 
```

`stdin`仍然`\n`留在缓冲区中。因此，当您致电时`PracticeStrings()`，随后：

```
fgets(FirstPeriod[0]->name, 256, stdin); 
```

你阅读`\n`并最终得到

```
FirstPeriod[0]->name[i] == '\0'; 
```

* * *

此外，随着您的学习，学习验证:)

IE：

```
if ((foo = malloc(blah)) == NULL) {
    ... err ... 
```

更关键的是：

```
if (scanf(..) != number_of_items_i_want) {
    ... did not get a number, or what ever I wanted ... 
```

等等

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T00:17:50.647

我认为你的问题是由于你的控制台的行为和你的`scanf()`电话。

您的控制台的默认设置可能是行缓冲。这意味着在您按下回车键之前，您在终端上键入的任何内容都不会发送到标准输入。

但是，您对`scanf()`(in `main()`) 的调用只是获取您输入的整数 - 而不是尾随回车。在第 26 行调用之前，您的回车仍在 stdin 中处于未读状态`fgets()`。解决此问题的一种方法是让 scanf() 也使用尾随回车：

```
`scanf("%d%*c", &numb);` 
```

`它将整数从标准输入读入`&numb`，并读取（并丢弃）一个额外的字符。

这一切都凸显了使用 的一个大问题`scanf()`，即如何在您得到一个出乎意料的字符串的情况下使其应对。更安全的方法是使用`fgets()`和的组合`sscanf()`。前者将让您从文件中读取字符串（正如您所做的那样），后者将在其上运行格式化字符串。例如。

```
 char temp[20];
    fgets(temp, 20, stdin);
    sscanf(temp, "%d", &numb); 
````

# c# - 自定义 HtmlHelper（ActionLink 中的图像）

> ID：10081212
> 
> 赞同：2
> 
> 时间：2012-04-09T23:36:26.577
> 
> 标签：c#, html, css, asp.net-mvc-3

我已经看到这有几种不同的方式，但不是我正在寻找的具体方式。我目前有一个自定义 HtmlHelper，它将“class='currentPage'”添加到 ActionLink 以突出显示导航系统中的当前页面。

```
public static MvcHtmlString MenuItem(
            this HtmlHelper htmlHelper,
            string text,
            string action,
            string controller
        )
        {
            string value;
            var routeData = htmlHelper.ViewContext.RouteData;
            var currentAction = routeData.GetRequiredString("action");
            var currentController = routeData.GetRequiredString("controller");
            if (string.Equals(currentAction, action, StringComparison.OrdinalIgnoreCase) &&
                string.Equals(currentController, controller, StringComparison.OrdinalIgnoreCase))
            {
                value = htmlHelper.ActionLink(text, action, new { controller = controller }, new { @class = "currentPage" }).ToHtmlString();
                return MvcHtmlString.Create(value.ToString());
            }

            value = htmlHelper.ActionLink(text, action, controller).ToHtmlString();
            return MvcHtmlString.Create(value.ToString());
        } 
```

这很好用，但我有一个管理区域，其中还有一个与每个菜单项关联的图像。该图像位于链接中，如下所示：

```
<li><a href="/Admin/Blog"><img src="/Content/images/icons/page_edit.png" alt="" /> Blog</a></li> 
```

我想为“MenuItem”创建一个覆盖方法，在 ActionLink 中添加图像，但我有点难过。目前我有以下内容，将 img 标签放在外面......

```
public static MvcHtmlString MenuItem(
            this HtmlHelper htmlHelper,
            bool isAdmin,
            string text,
            string action,
            string controller
        )
        {
            string value;
            var routeData = htmlHelper.ViewContext.RouteData;
            var currentAction = routeData.GetRequiredString("action");
            var currentController = routeData.GetRequiredString("controller");

            value = "<img src='/Content/images/admin_icons/" + text + ".png' alt='' /> ";

            if (string.Equals(currentAction, action, StringComparison.OrdinalIgnoreCase) &&
                string.Equals(currentController, controller, StringComparison.OrdinalIgnoreCase))
            {
                value += htmlHelper.ActionLink(text, action, new { controller = controller }, new { @class = "currentPage" }).ToHtmlString();

            }
            else
            {
                value += htmlHelper.ActionLink(text, action, controller).ToHtmlString();
            }

            return MvcHtmlString.Create(value.ToString());
        } 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T00:19:51.683

我会使用 UrlHelper 生成 URL，然后格式化字符串。我的示例不涉及添加条件类，但这应该很容易包含。

```
 var urlHelper = new UrlHelper(htmlHelper.ViewContext.RequestContext);
        var url = urlHelper.Action(action, controller);
        var imgUrl = urlHelper.Content("~/Content/images/icons/page_edit.png");
        var html = string.Format("<li><a href=\"{0}\"><img src=\"{2}\" alt=\"\" />{1}</a></li>", url, text, imgUrl);
        return new MvcHtmlString(html); 
```

# python - Ubuntu 正在扼杀我的计算

> ID：10081217
> 
> 赞同：0
> 
> 时间：2012-04-09T23:37:08.360
> 
> 标签：python, ubuntu, scientific-computing

我正在尝试在我的 ubuntu 机器上执行繁重的科学计算。该代码是用 Python 编写的，并被标记为可执行文件。然而，大约一小时后，计算终止，除了“终止”之外没有错误消息，就像系统刚刚运行命令“killall python”一样。

为什么 ubuntu 会终止我的计算？没有无限循环并且解决方案很好地收敛（但是程序的一部分需要一些优化）。

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-10T12:54:01.663

仅根据您所说的问题，很难确定问题可能是什么。如果我是你，我会看看进程的内存占用。可能发生的情况是某种内存泄漏变得如此巨大以至于[最终操作系统不得不终止该进程](http://linux-mm.org/OOM_Killer)

# mkreversegeocoder - CLGeocoder 返回与 MKReverseGeocoder 不同的结果

> ID：10081218
> 
> 赞同：1
> 
> 时间：2012-04-09T23:37:09.007
> 
> 标签：mkreversegeocoder, clgeocoder

我正在尝试将我们的应用程序从用于运行 iOS 5 的设备修改`MKReverseGeocoder`为`CLGeocoder`，但我从这两个类中得到了不同的结果。具体来说，使用此坐标进行反向地理编码时：

```
(47.643126, -122.204037) 
```

我从`MKReverseGeocoder`：

```
10210 NE Points Dr
Kirkland, Washington 98033 
```

但我从`CLGeocoder`：

```
9601-10267 NE Points Dr
Kirkland, Washington 98033 
```

第二个值没有第一个值那么具体，因此用处不大。目前的解决方案是只使用`MKReverseGeocoder`，但在某些时候我们将被迫切换。

问：知道如何改进结果`CLGeocoder`吗？

谢谢，
***大卫***

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T23:39:57.577

更新他们的数据库。简而言之，他们的数据不太具体/不准确，因此除了接受他们不太准确的数据之外，您无能为力

# python - 将文件上传到 Blobstore 数据存储

> ID：10081221
> 
> 赞同：-1
> 
> 时间：2012-04-09T23:37:38.797
> 
> 标签：python, google-app-engine, file-upload, blobstore

我对 Google 应用引擎很陌生。所以请大家帮我解决这个问题。明确地说，我的代码是错误的，但我不知道它在哪里？这里代码：

```
import os
import urllib

from google.appengine.ext import blobstore
from google.appengine.ext.webapp import blobstore_handlers
from google.appengine.ext.webapp.util import run_wsgi_app
import datetime
import wsgiref.handlers
from google.appengine.api import mail
from google.appengine.ext import db
from google.appengine.ext import webapp
from google.appengine.ext.webapp import util
from google.appengine.ext.webapp \
    import template

class MyUsers(db.Model):
    firstname = db.StringProperty(
                    required=False)
    lastname = db.StringProperty(
                    required=False)
    email = db.StringProperty(
                    required=False)
    zipcode = db.StringProperty(
                    required=False)
    file = db.BlobProperty(
                    required=False)
    idea = db.TextProperty(
                    )
    ask = db.StringProperty(
                    required=False)
    contact_back = db.StringProperty(
                    required=False)
    phone = db.StringProperty(
                    required=False)
    regdate = db.DateTimeProperty(
                    auto_now_add=True)

class MainHandler(webapp.RequestHandler):
    def get(self):
        self.response.out.write(
            template.render('expert.html',[]))

class Register(webapp.RequestHandler):
    def get(self):
            upload_url = blobstore.create_upload_url('/upload')
            self.response.out.write(
            template.render('expert.html',[]))

    def post(self):
        user = MyUsers(
            firstname = self.request.get('firstname'),
            lastname = self.request.get('lastname'),
            email = self.request.get('email'),
            zipcode = self.request.get('zipcode'),
            ask = self.request.get('ask'),
            idea = self.request.get('idea'),
            file = self.request.get('file'),
            contact_back = self.request.get('contact_back'),
            phone = self.request.get('phone'),
            )
        phone = self.request.get('phone')
        firstname = self.request.get('firstname')
        email = self.request.get('email')
        lastname = self.request.get('lastname')
        user.put()

        emailto = self.request.get('email')
        body = """Dear """+firstname+""":

        Thank you for registering.

        Please let us know if you have any questions.

        As One Source.
        """
        mail.send_mail("daniyar.seisenov@gmail.com", emailto, "Confirmation Email", body)
        mail.send_mail(sender="Daniyar Seisenov <daniyar.seisenov@gmail.com>",
              to="Daniyar Seisenov <daniyar.seisenov@gmail.com>",
              subject="New User",
              body="""
        This applicant has just registered. Please review:

        Firstname: """+firstname+"""
        Lastname: """+lastname+"""
        Email: """+email+"""
        Phone: """+phone+"""

        """)
        self.redirect('/')

class UploadHandler(blobstore_handlers.BlobstoreUploadHandler):
    def post(self):
        upload_files = self.get_uploads('file')  # 'file' is file upload field in the form
        blob_info = upload_files[0]

class ServeHandler(blobstore_handlers.BlobstoreDownloadHandler):
    def get(self, resource):
        resource = str(urllib.unquote(resource))
        blob_info = blobstore.BlobInfo.get(resource)
        self.send_blob(blob_info)        
        self.redirect('/serve/%s' % blob_info.key())

class Users(webapp.RequestHandler):
    def get(self):
        myusers=db.GqlQuery(
            'SELECT * FROM MyUsers '
            'ORDER BY regdate DESC'
            )
        values = {
            'myusers':myusers,
            'totalmyusers' : myusers.count()
        }

        self.response.out.write(
            template.render('userscountandremove.html',
                            values))

def main():
    application = webapp.WSGIApplication([('/', MainHandler),
                                        ('/upload', UploadHandler),
                                        ('/serve/([^/]+)?', ServeHandler),
                                          ('/register',Register),
                                          ('/userscountandremove',Users)],
                                         debug=True)
    util.run_wsgi_app(application)

if __name__ == '__main__':
    main() 
```

当我从expert.html 按下提交时，“文件”不会进入数据存储中的blobstore。如果您知道什么是解决方案，请帮助我。谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-09T23:51:19.703

这有点令人困惑，但数据存储和 blobstore 是应用引擎中的两个独立存储机制。BlobProperty 将 blob 存储在数据存储中，而不是存储在 blobstore 中。

看起来您的代码会将文件放入 BlobStore，但您的 MyUsers.file 属性需要存储 BlobStore 密钥。

另一种选择是将 blob 实际存储在数据存储中，在这种情况下，您不会使用 BlobstoreUploadHandler，而是必须自己从 POST 数据中提取对象，并将其存储在 MyUsers.file 字段中。

# asp.net-mvc - asp.net mvc中的控制模板

> ID：10081226
> 
> 赞同：2
> 
> 时间：2012-04-09T23:38:10.793
> 
> 标签：asp.net-mvc, asp.net-mvc-3, webforms, partial-views

在 MVC 之前，当 webforms 是我们唯一的东西时，我曾经为我的控件定义一个容器（你可以调用一个 Box）并在其他控件中使用这个 web 控件（带有标题、正文和几个其他属性）。

因此，如果我想更改所有可视控件的外观，我只需在 Box 控件中进行一次更改。

这是我曾经做过的简化片段：

```
<%@ Control Language="C#" AutoEventWireup="true" CodeBehind="Box.ascx.cs" Inherits="WebApp.Controls.Box" %>
<span class="boxtitle">
    <asp:Literal ID="ltrTitle" runat="server"></asp:Literal>
</span>
<div class="boxContent" id="dvBox">
    <asp:PlaceHolder runat="server" ID="BoxBodyContainer"/>
</div> 
```

在代码隐藏中：

```
public Control BoxBody { get; set; }
public string Title
{
    get { return this.ltrTitle.Text; }
    set { this.ltrTitle.Text = value; }
}
protected void Page_Load(object sender, EventArgs e)
{
    this.BoxBodyContainer.Controls.Add(this.BoxBody);
} 
```

所以我可以在我的页面中将它与其他控件一起使用，如下所示：

```
<MyControls:Box ID="Box1" Title="Foo" runat="server">
    <boxbody>
        <MyControls:CustomControl ID="Bar" runat="server" >
         </MyControls:CustomControl>
    </boxbody>
</MyControls:Box> 
```

为了在 MVC 3 中有类似的东西，我认为我应该定义一个`Box`视图，并在我需要框的地方使用`Html.Partial`或`Html.Action`将我的所有数据（标题、框体等）传递给该视图并`@Html.Raw`在框视图中使用。
但我想知道是否有更好、更标准的方法来实现这一目标。在 MVC 3 (Razor) 中实现这一目标的正确方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-10T01:35:16.040

您可以创建一个 Html Helper 扩展方法来执行此操作。[我能找到的最好的教程是针对 MVC2 的](http://www.asp.net/mvc/tutorials/older-versions/views/creating-custom-html-helpers-cs)，但它为您提供了基础知识。

本教程没有涵盖的是`System.Web.MVC`命名空间中的类可以帮助您在代码中创建 html。

**注意：**以下代码未经测试。

```
using System;
using System.Web.Mvc;

public static class HtmlExtensions
{
    public static MvcHtmlString Box(this HtmlHelper helper, string title, MvcHtmlString body)
    {
        TagBuilder span = new TagBuilder("span");
        span.AddCssClass("boxtitle");
        span.SetInnerText(title.ToString());

        TagBuilder div = new TabBuilder("div");
        div.AddCssClass("boxContent");
        div.InnerHtml = body;

        return MvcHtmlString.Create(span.ToString() + div.ToString());
    }
} 
```

您可以从 razor 视图中调用此方法，如下所示：

```
@Html.Box("foo", Html.Partial("bar")) 
```

# android - Error when trying initialize a service ( which extends IntentService class)

> ID：10081227
> 
> 赞同：0
> 
> 时间：2012-04-09T23:38:14.520
> 
> 标签：android, service, intentservice

I try to play with Service in Android, my application contain an Activity with a button so that it can do action when I press it. The core component is the ExtractingURLService , which extends IntentService framework class. I have overrided the onHandleIntent() method, so that it can handle intent passed to it properly. Code:

```
public  class ExtractingURLService extends IntentService {

    private static final String TAG = "ExtractingURLService"; 

    public ExtractingURLService(String name) {
        super("ExtractingURLService");
    }

    @Override
    protected void onHandleIntent(Intent intent) {
        // do something here !
        }
    }

} 
```

The Android Manifest file is :

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
      package="example.service.urlextraction"
      android:versionCode="1"
      android:versionName="1.0">
    <uses-sdk android:minSdkVersion="10" />
    <uses-permission android:name="android.permission.INTERNET"/>

    <application android:icon="@drawable/icon" android:label="@string/app_name">
        <activity android:name=".ServiceExample02Activity"
                  android:label="@string/app_name">
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />
                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
        <service android:name=".ExtractingURLService" android:enabled="true"></service>

    </application>
</manifest> 
```

In my only Activity class, I call the service by using:

```
Intent startServiceIntent =  new Intent(this, ExtractingURLService.class);
startService(startServiceIntent); 
```

That's all my work, but when deploy, the runtime error I received was:

> 04-09 16:24:05.751: ERROR/AndroidRuntime(1078): Caused by: java.lang.InstantiationException: example.service.urlextraction.ExtractingURLService

What I should do with that ??

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T00:28:19.123

Add full path of Service

```
<service android:name="com.foo.services.ExtractingURLService" android:enabled="true"></service> 
```

Intent Service should look like this:

```
package com.foo.services;

import android.app.IntentService;
import android.content.Intent;

public class ExtractingURLService extends IntentService {

    private static final String TAG = "ExtractingURLService";

    public ExtractingURLService() {
        super("ExtractingURLService");
    }

    @Override
    protected void onHandleIntent(Intent intent) {
        // do something here !
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-09-19T10:55:19.483

> You can add try and catch block to avoid crash.Its work for me

```
try {
      Intent intent = new Intent(DashboardActivity.this, MyService.class);
      startService(intent);

     }catch (IllegalStateException e){

    }catch (Exception ee){

   }
```

# javascript - Javascript返回不起作用

> ID：10081230
> 
> 赞同：1
> 
> 时间：2012-04-09T23:38:32.037
> 
> 标签：javascript, jquery, return

我有这个代码：

```
function get_id_from_coords (x, y)
{
    x = parseInt(x);
    y = parseInt(y);

    if (x < 0)
    {
        x = (x + 6) * 60;
    }
    else
    {
        x = (x + 5) * 60;
    }
    if (y < 0)
    {
        y = (y + 6) * 60;
    }
    else
    {
        y = (y + 5) * 60;
    }

    $('#planets').children().each(function(){
        if ($(this).attr('x') == x) {
            if ($(this).attr('y') == y) {
                alert (parseInt($(this).attr('id')));
                return parseInt($(this).attr('id'));
            }
        }
    });
}
alert(get_id_from_coords(x, y)); 
```

但是，从这段代码中，我得到了两个弹出窗口：首先，从函数内部，我得到了正确的值（比如 63），但是当我提醒返回值时，我只是得到了未定义的值。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-09T23:44:30.537

你得到 undefined 因为你的函数没有返回 - 最后一个语句是对`each`函数的调用，它不是一个`return`语句。如果你把一个回报，例如

```
...
return $('#planets').children().each(function(){
    if ($(this).attr('x') == x) {
        if ($(this).attr('y') == y) {
            alert (parseInt($(this).attr('id')));
            return parseInt($(this).attr('id'));
        }
    }
}); 
```

它会返回一些东西 - 在这种情况下，基于文档：

*   [http://api.jquery.com/jQuery.each/](http://api.jquery.com/jQuery.each/)

    ```
    The method returns its first argument, the object that was iterated. 
    ```

它将返回`#planets`.

如果你想找到一些专门使用的价值`each`，那么你可以这样做：

```
...
val toRet;
$('#planets').children().each(function(){
    if ($(this).attr('x') == x) {
        if ($(this).attr('y') == y) {
            toRet = parseInt($(this).attr('id'));
        }
    }
});
return toRet; 
```

# c# - 为什么在 C# 中将结构与 NULL 进行比较是合法的？

> ID：10081231
> 
> 赞同：2
> 
> 时间：2012-04-09T23:38:39.203
> 
> 标签：c#, struct, null

> **可能重复：**
> [C# 可以将值类型与 null 进行比较](https://stackoverflow.com/questions/1972262/c-sharp-okay-with-comparing-value-types-to-null)

考虑以下带有 TimeSpan 的代码，它是一个结构：

```
// will not compile - illegal
TimeSpan ts = null; 
```

但是，以下代码确实可以编译并且是合法的，尽管表达式始终为假：

```
if (ts == null)
    Console.WriteLine("this line will never be hit"); 
```

有人能告诉我为什么将结构设置为 NULL 是无效的，但是可以将它与一个结构进行比较？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-09T23:43:31.637

它仍然是合法的，因为您可以重载 s 的`==`运算符`struct`。

```
struct AmNull {
    public static bool operator ==(AmNull a, object b) {
        return b == null;
    }

    public static bool operator !=(AmNull a, object b) {
        return b != null;
    }
}

...

Console.WriteLine(new AmNull() == null); // True 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-09T23:42:22.700

无法为我编译：

```
struct Foo { }

class Program
{       
    static void Main( string[] args )
    {
        var f = new Foo();
        if( f == null ) { }
    }
} 
```

> 错误 1 ​​运算符“==”不能应用于“ConsoleApplication3.Foo”和“null”类型的操作数

# sql - Sql - 从数据库中读取图像

> ID：10081232
> 
> 赞同：0
> 
> 时间：2012-04-09T23:38:40.653
> 
> 标签：sql, image, httphandler

从我的数据库中读取图像时，我不断收到错误图像图标。

这是 HttpHandler 代码：

```
public void ProcessRequest(HttpContext context) {
    ....
    //After we got the data table:
    byte[] image = (byte[])dt.Rows[0]["Picture"];
    context.Response.ContentType = dt.Rows[0]["PictureType"].ToString();
    context.Response.BinaryWrite(image);
} 
```

我确实检查并看到它`image`不是空的（只是一个非常大的数组，应该是），并且`PictureType`确实保存了以前保存在数据库中的图片类型。但是在调用处理程序时我仍然看到错误图像图标：

```
<img src='myhandler.ashx?imgid=someid'/> 
```

发生这种情况有什么原因吗？

# java - stack.peek() 方法 - Java

> ID：10081233
> 
> 赞同：0
> 
> 时间：2012-04-09T23:38:48.480
> 
> 标签：java, class, stack

```
public class Coordinate{

private Integer row;
private Integer column;

public Coordinate(Integer row, Integer column){
    this.row = row;
    this.column = column;
}

public void setRow(Integer row){
    this.row = row;
}

public void setColumn(Integer column){
    this.column = column;
}

public Integer getRow(){
    return row;
}

public Integer getColumn(){
    return column;
}

public String toString(){
    return "<" + row.toString() + "," + column.toString() + ">";
}
} 
```

好的，所以我有这个坐标类，并且我将其中一些推到了堆栈上。现在我想做的是在其中一个上 peek() 并能够在我偷看的那个上使用 getRow 和 getColumn 方法。我该怎么做呢？我遇到的问题是我正在创建一个新的 Coordinate 实例，然后将 stack.peek() 分配给它，然后使用它上面的方法，但这不起作用。使困惑

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T00:04:08.913

看起来您可能必须将 stack.peek() 的结果转换为您的 Coordinate 类。类似的东西`System.out.println(((Coordinate)mazeStack.peek()).getRow());`可能是您正在寻找的东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T23:43:42.637

```
Coordinate c = new Coordinate(1,2);
Stack<Coordinate> s = new Stack<Coordinate>();
s.push(c);
System.out.println(s.peek());

Coordinate c2 = (Coordinate)s.pop();
System.out.println(c2);
System.out.println(c2.getRow()); 
```

不过这里有一个提示，不要使用 java.util.Stack。它来自不是很好的原始收藏库。

*编辑*修改为代表演员，这听起来像你在这种情况下需要的。注意 c 和 c2 将指向同一个对象。

# c# - 在 Active Directory 中获取用户组

> ID：10081234
> 
> 赞同：6
> 
> 时间：2012-04-09T23:38:54.157
> 
> 标签：c#, asp.net, wpf, web-services, active-directory

我在将我的 ASP.NET Web 服务与 Active Directory 设置集成时遇到问题，并使用它来验证用户并检查他们所属的 AD 组以及他们是否有权使用我的自定义应用程序。

我的自定义应用程序有自己的权限，管理员配置允许使用自定义应用程序的 Active Directory 组。

我遇到的问题是，当来自不同受信任 AD 林的用户（具有完全双向信任）尝试登录时，我无法从我的 ASP.NET Web 服务与之通信的 AD 服务器获取他的组列表。ASP.NET Web 服务只能访问 AD 服务器 (AD Main)，而不是信任 AD 控制器 (AD Secondary)。

用户是（AD 辅助）域的成员，我可以针对（AD 主）域对该用户进行身份验证，但是当用户在（AD 辅助）域。

我试过这段代码。

```
StringCollection groupids = new StringCollection();
try
{
    DirectoryLibrary dirLib = new DirectoryLibrary();
    DirectoryEntry directoryEntry = new DirectoryEntry("LDAP://" + domain,username, password);   
    if (directoryEntry != null)
    {
        //Enum the properties so we can see what is in them
        foreach (string propname in directoryEntry.Properties.PropertyNames)
        {
            Debug.WriteLine(propname);
        }

        object obGroups = directoryEntry.Invoke("Groups");
        foreach (object ob in (IEnumerable)obGroups)
        {
        // Create object for each group.
            DirectoryEntry obGpEntry = new DirectoryEntry(ob);
            groupids.Add(obGpEntry.NativeGuid);
        }
    }
}
catch (DirectoryServicesCOMException ex) { throw ex; } 
```

我试图从 DirectoryEntry 对象移到类似这样的东西。

```
List<GroupPrincipal> result = new List<GroupPrincipal>();
StringCollection groupids = new StringCollection();

PrincipalContext yourDomain = new PrincipalContext(ContextType.Domain, domain, userName, password);

// find your user
UserPrincipal user = UserPrincipal.FindByIdentity(yourDomain, userName);

// if found - grab its groups
if (user != null)
{
    PrincipalSearchResult<Principal> groups = user.GetGroups();

    // iterate over all groups
    foreach (Principal p in groups)
    {
        // make sure to add only group principals
        if (p is GroupPrincipal)
        {
            groupids.Add(p.DisplayName);
        }
    }

} 
```

但是，我没有得到用户，也无法得到另一个域中该用户的组列表。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T15:06:42.660

这似乎是 AD 派生属性 memberOf 的一个很好的用例。使用该`DirectoryEntry directoryEntry`对象，您可以枚举用户所属的组。

```
foreach (object group in directoryEntry.Properties["memberOf"])
{
    DirectoryEntry obGpEntry = New DirectoryEntry("LDAP://" + (String)group);
    groupids.Add(obGpEntry.NativeGuid);
} 
```

如果您在 ob 前面加上“LDAP://”，您也可能会使用第一个代码段

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T17:05:08.140

I think you have to connect to the remote AD and get the data you want.

I wrote a replication once, where i replicate from many AD's

Some code out of it:

```
Public Function GetDirectoryEntry() As Object

    If InStr(1, m_sLdapPath, "DC=") > 0 Then
      Dim directory_service As New PrincipalContext(ContextType.Domain, m_sDomain, m_sLdapPath)
      Return directory_service
    Else
      Dim directory_service As New PrincipalContext(ContextType.Machine, m_sDomain, m_sLdapPath)
      Return directory_service
    End If

  End Function

  Public Function GetUserList() As PrincipalSearchResult(Of Principal)

    Dim directory_service As PrincipalContext = CType(GetDirectoryEntry(), PrincipalContext)
    Dim directory_user As New UserPrincipal(directory_service)

    Dim directory_userlist As New PrincipalSearcher(directory_user)
    directory_userlist.QueryFilter = directory_user
    Return directory_userlist.FindAll

  End Function

  Public Function GetGroupList() As PrincipalSearchResult(Of Principal)

    Dim directory_service As PrincipalContext = CType(GetDirectoryEntry(), PrincipalContext)
    Dim directory_group As New GroupPrincipal(directory_service)

    Dim directory_grouplist As New PrincipalSearcher(directory_group)
    directory_grouplist.QueryFilter = directory_group
    Return directory_grouplist.FindAll

  End Function 
```

I know this is not exactly what you need, but this shows how to connect and fetch data from any AD. In my case I get a userlist, grouplist or whatever and then work with those collections.

```
Dim l_oGroupList As Object = oDirectory.GetGroupList()
For Each l_oGroup In l_oGroupList
  If l_oGroup.Members.Count > 0 Then
  If l_oGroup.Members.Contains(directory_service, IdentityType.UserPrincipalName, Username) Then
    ' he is part of the group
  End If
  End If
Next 
```

I hope this helps a bit to solve the problem...

# jquery - jQuery 和 grails 不工作

> ID：10081237
> 
> 赞同：1
> 
> 时间：2012-04-09T23:39:09.990
> 
> 标签：jquery, jquery-ui, grails

我有一个非常简单的带有按钮的 gsp 页面。我正在尝试使用 JQuery（不是插件）以不显眼的方式附加到单击事件。但是，grails 并没有给我任何爱。有

我在 main.gsp 的最底部有这个（在 tag.gsp 之后）。

```
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.18/jquery-ui.min.js"></script> 
```

我在具有按钮的页面底部有以下代码：

```
<script type="text/javascript">

    //call out to the controller with the id of this listing and
    //get back a json list of the last several bid amounts
    //
    $(document).ready(function(){
        alert("got here");
        bindControls();
        //getLatestBids(${listingInstance.id});
    });

</script> 
```

最后，我在自己的 js 文件中有这段代码：

```
bindControls= function (){
    alert("clicked me");
    $('#newBidButton').live("click", function(){
        alert("clicked me!");
    });
} 
```

我可以打开chrome和firebug，看到所有的js文件都加载了。但是，当我单击按钮时，什么也没有发生。另外，我期待 $(document).ready 函数中的函数会触发，但它从未触发过。有任何想法的人吗？

谢谢！

* * *

**更新：**

将我的脚本标签更改为：

```
 <g:javascript>
        $(document).ready(function(){
            bindControls();
            getLatestBids(${listingInstance.id});
        });
    </g:javascript> 
```

并将我的 jquery 导入移动到 master 的 head 标签中就可以了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T00:50:29.093

如果您的页面上有任何冲突的 JavaScript 库，请尝试替换`$`为。`jQuery`如果这是解决问题的方法，您可以像这样包装您的 jQuery 代码：

```
function($) {
  $(document).ready(function(){
       console.log("got here");
  });
}(jQuery) 
```

# javascript - 对对象中的javascript数组进行排序，维护键

> ID：10081242
> 
> 赞同：5
> 
> 时间：2012-04-09T23:40:17.050
> 
> 标签：javascript, sorting

我有一个带有两个数组的 javascript 对象，如图所示，

```
var Object = {'name': [Matt, Tom, Mike...], 'rank': [34,1,17...]}; 
```

我正在尝试按排名 1、2、3.. 排序，但保持名称与排名相关联。

```
Object.name[0] // tom
Object.rank[0] // tom's rank of 1. 
```

我应该重新配置我的对象以使排序更容易吗？

我目前正在使用

```
 Object.rank.sort(function(a,b){return a-b}); 
```

排序排名，但名称并没有留下来。

所有帮助表示赞赏。谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-09T23:47:34.057

是的，重新配置。假设你有这个：

```
var people = [{name:"Matt", rank:34}, {name:"Tom", rank:1}, {name:"Mike", rank:17}]; 
```

然后你可以这样排序：

```
people.sort(function(a, b) {
  return a.rank - b.rank;
} 
```

**编辑**

由于您有并行列表，因此只需将它们压缩在一起：

```
var people = [];
for (var i = 0; i < Object.name.length; i++) {
  people.push({name:Object.name[i], rank:Object.rank[i]});
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-09T23:49:42.383

**真实世界对象：**

```
 o = {name: ['Matt', 'Tom', 'Mike'], rank: [34,1,17]}; 
```

**制作一个数组以获得更好的数据结构：**

```
var arr =[]; 
o.name.forEach(function(name, i){
      arr.push({name: name, rank: o.rank[i]})
}); 
```

**按等级排序：**

```
arr.sort(function(a,b){return a.rank - b.rank}); 
```

**按名称分类：**

```
arr.sort(function(a,b){return a.name- b.name}); 
```

**恢复到原始数据结构：**

```
o = {name:[], rank:[]}
arr.forEach(function(item){
   o.name.push(item.name);
   o.rank.push(item.rank);
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-09T23:46:57.257

好吧，是的，如果数组中的第 i 个对象`names`连接到数组中的第 i 个对象，则`rank`应该以这种方式表示它。这意味着，您应该使用`Person`具有两个属性的（或任何它是）对象：`name`和`rank`.

```
// person constructor
function Person(name, rank) {
    this.name = name;
    this.rank = rank;
}

// create the object with the array
var myObject = {
    myArray: new Array()
};

// populate the array
myObject.myArray.push(new Person('Matt', 34));
myObject.myArray.push(new Person('Tom', 1));
myObject.myArray.push(new Person('Mike', 17));

// sort the Person objects according to their ranks
myObject.myArray.sort(function(a, b) {
    return b.rank - a.rank;    
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-09T23:45:41.200

您必须编写自己的排序函数，对于每个排序操作，记住每次迭代在 ranks 数组中的哪个索引。在名称数组中从源索引到目标索引执行相同的移动。（编辑）我想到的一个算法是冒泡排序，查一下。

另一种选择是寻找某种“地图”集合实现。

# file - 使用 R 打印文件的内容（支持 r、tex、txt、rnw 等扩展名）？

> ID：10081244
> 
> 赞同：1
> 
> 时间：2012-04-09T23:40:31.147
> 
> 标签：file, r, printing

是否可以使用 R 打印文件的内容（支持 r、tex、txt、rnw 等扩展名）？

可复制文件：

```
sink('myFile')
cat('\nThis is some text')
cat('\n')
cat('\nEnd of file')
sink() 
```

现在我正在寻找 R 中的一个函数，它将 R 的内容打印为...

```
>PRINT_FILE_CONTENT('myFile')
This is some text
End of file
> 
```

我希望我很清楚。我将不胜感激任何帮助？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T23:50:04.387

这似乎有效：

```
cat(readLines("myFile"),sep="\n") 
```

虽然我确实得到了

```
Warning message:
In readLines("myFile") : incomplete final line found on 'myFile' 
```

最后......`suppressWarnings()`如果你愿意，你可以把它包起来。

# database - 数据库记忆？

> ID：10081247
> 
> 赞同：1
> 
> 时间：2012-04-09T23:40:50.587
> 
> 标签：database, performance, algorithm, memoization

数据库是用于记忆的合理数据结构吗？当需要缓存极其大量的数据时，一个普通的软件在内存中主动维护可能是不合理的。数据库可以轻松存储计算结果以供以后使用，这意味着可以随时停止和开始计算，而不会影响程序的进度。如果数据库是共享的，处理也可以分布在多个系统（计算机集群）之间。

我唯一的保留是查询数据库引起的延迟可能会影响算法性能，尤其是当算法非常快速地处理许多排列时。当然，只有当算法/应用程序的空间复杂度非常高（千兆字节）时，才需要数据库记忆。有什么想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-10T03:31:56.080

如果您担心要在单台机器上回答大数据，那么答案几乎肯定是**NO！** 而在现代硬件上，如果答案不是“否”，那么要么计算有模式，要么计算应该被裁定为不可行。但是有几种变化是有意义的。

记忆的胜利在于重新计算的成本不仅仅是获取你以前的答案。但是，如果您的答案适合 RAM，那么使用数据库不会有任何好处，因为将存储保存在内存中会更快。因此，数据库唯一有趣的情况是答案不适合 RAM。

让我们假设，为了论证，每个键/值对占用高达 640 字节。让我们假设您有 64 GB 的 RAM 可供您使用。因此，为了使其不适合 RAM，您需要超过 1 亿个事实，这些事实是随机创建/访问的。但是，让我们考虑实际的硬件。这些事实，当它们不适合 RAM 时，存储在硬盘驱动器中。硬盘以 6k RPM 或每秒 100 次的速度旋转。这使得获取/存储随机数据的时间平均为 1/200 秒（平均而言，您必须中途旋转才能找到数据）。因此，在您填充数据结构后，再次随机访问它需要 1 亿 * 0.005 秒 = 500,000 秒，即近 590 天。我们' 仅仅需要数年时间才能访问数据（更不用说创建数据了），而这些数据正危险地接近硬件故障之间的平均时间。（顺便说一句，我们可以在这里利用一些并行性，硬盘驱动器可以一次寻找他们正在寻找的几个磁盘扇区，但这是有限的，不会节省你的时间。）

道德是随机访问磁盘上的大型数据集是不可行的。即使你在它前面放了一个数据库。硬盘驱动器不是 RAM，因此不应这样认为。

但一切都没有丢失。

数据库有意义的一个场景是您对分布式计算的建议。如果您的计算步骤很昂贵，memoized 调用相对较少，并且数据可以放在内存中，那么数据库非常方便。对数据库的调用将很快（数据在内存中），您不能简单地将数据保存在本地硬盘上（您的数据分布在多台机器上以使用 CPU，因此没有共享硬盘），并且数据库可能很方便，因为它在那里。（我以前也这样用过数据库，很开心。）

但是在这种情况下，数据库只是一个键/值存储。虽然 SQL 数据库可以工作，但您可能需要考虑非 SQL 解决方案。而且，一旦您使用非 SQL 解决方案，您就可以选择数据存储，其中数据已被分片，以便所有数据都适合 RAM，无论您拥有多少数据。（是的，你也可以对关系数据库进行分片。eBay 是我知道的一家公司的一个很好的例子，但是一旦你这样做了，你往往会失去它的“关系”部分。是的，我知道有几家公司声称不这样做，他们的主张带有重要的警告。）

实际上，当您进行 Google 搜索时，您所运行的只是这种分片数据存储，其中包含对许多问题的基本记忆答案，这些问题包括哪些页面匹配哪些关键词，以及哪些页面最相关。没有记忆，他们永远做不到。但如果他们不得不去硬盘驱动器寻找答案，他们也永远无法真正做到这一点。（他们也没有使用 SQL ......）

# iphone - iOS：UIStepper：更改值更新的速度？

> ID：10081249
> 
> 赞同：1
> 
> 时间：2012-04-09T23:41:18.570
> 
> 标签：iphone, ios, sdk, uistepper

当用户将手指按住 + 或 - 时，是否有任何方法可以更改值更新的速度？我做了一些研究，但找不到任何东西！任何帮助表示赞赏！谢谢 ！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T23:47:19.487

第一个想法 - 您可以将 UITapRecognizer 和 UILongTapGesterRecognizer 分配给同一个视图。让敲击识别器的选择器增加一，长敲击识别器的选择器增加一个更大的数字。

第二个想法 - 您可以捕获 touchesBegan: 并启动一个计时器，然后开始递增设置为 1 的 iVar。每次计时器滴答声都会增加用于递增的 iVar。

# bash - 反引号不起作用

> ID：10081253
> 
> 赞同：0
> 
> 时间：2012-04-09T23:41:47.940
> 
> 标签：bash, backticks

我要重命名的目录结构中有大量文件。

文件名采用以下格式：
“aaaaaa-bbbbbb_cccccc-ddddd_eeeee-fffff-ggggg-hhhhh.psd”

我希望它们采用这种格式：
“Aaaaaa-Bbbbbb_Cccccc-Ddddd_Eeeee-Fffff-Ggggg-Hhhhh.psd

单个 find 和 sed 例程应该将它们转换为正确的格式：

```
find . -name "*psd" -exec sh -c "echo 'cp '{} `echo {} | sed 's/\([_-][a-z]\)\([A-Z]*\)/\2\U\1/g'`" \; 
```

但它不起作用：

输入：

辅助或自动/抽象渲染/辅助或自动_abstract-render_tiny-bubbles3.psd

输出：

cp ./Assisted-or-Auto/Abstract-Render/assisted-or-auto_abstract-render_tiny-bubbles3.psd ./Assisted-or-Auto/Abstract-Render/assisted-or-auto_abstract-render_tiny-bubbles3.psd

如果我删除反引号并插入分号，sed 例程就可以工作。

```
find . -name "*bubbles3.psd" -exec sh -c "echo 'cp '{} ; echo {} | sed 's/\([_-][a-z]\([A-Z]*\)/\2\U\1/g'" \;

cp ./Assisted-or-Auto/Abstract-Render/assisted-or-auto_abstract-render_tiny-bubbles3.psd
./Assisted-Or-Auto/Abstract-Render/assisted-Or-Auto_Abstract-Render_Tiny-Bubbles3.psd 
```

所以，由于某种原因，反引号没有做它应该做的事情。关于如何解决此问题的任何想法？仅供参考用“ $(cmd) ”符号替换反引号具有相同的效果

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T23:56:33.367

最有可能的是，shell 首先解释反引号内的命令（甚至在运行之前`find`）。但是，“ ”*在*运行`{}`之前不会有任何特殊含义。尝试为您的命令创建一个 shell 函数或 bash 脚本，而不是内联编写它。这应该可以让你做更复杂的事情，而不必担心 shell 转义问题。 *`find`*

 ** * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T23:55:03.007

尝试

```
sed 's/\([/_-][a-z]\)\([A-Z]*\)/\2\U\1/g' 
```

IE

```
echo $'./Assisted-or-Auto/Abstract-Render/assisted-or-auto_abstract-render_tiny-bubbles3.psd' \
| sed 's/\([/_-][a-z]\)\([A-Z]*\)/\2\U\1/g' 
```

**输出**

```
./Assisted-Or-Auto/Abstract-Render/Assisted-Or-Auto_Abstract-Render_Tiny-Bubbles3.psd 
```

我只添加了“/”来匹配最初的小写单词部分（我的 sed 说`mismatched \( .. \)`所以我在逻辑位置添加了 1。

我希望这有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-10T01:33:12.730

这可能对您有用：

```
find . -name "*bubbles3.psd" | 
sed 'h;s/\(^\|[/_-]\)./\U&/g;H;g;s/^/cp -v /;s/\n/ /' |
bash 
```

如果您想在`cp`执行之前查看命令，只需离开最后一个管道`| bash`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-10T01:11:17.400

避免使用反引号，因为这意味着您要求逃避问题。

正如已经指出的那样，反引号很可能在调用`find`.

Use `$()`，它可以嵌套而没有太多的逃避麻烦，然后逃避`$`in`$(command)`以便它能够在调用中幸存并被传递给`find`. 从那时起（假设`find`使用 shell - 例如`$SHELL`- 执行您的命令），一切都会正常工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-10T00:20:57.093

细微的变化

```
$ input=Assisted-or-Auto/Abstract-Render/assisted-or-auto_abstract-render_tiny-bubbles3.psd
$ sed 's!\(/\|-\|_\)[a-z]!\U&!g' <<< "$input"
Assisted-Or-Auto/Abstract-Render/Assisted-Or-Auto_Abstract-Render_Tiny-Bubbles3.psd 
```

可以使用 GNU sed 变得更干净一些

```
$ sed 's!(/|-|_)[a-z]!\U&!g' <<< "$input" 
```*

# android - Android SQLite 中的选择语句

> ID：10081254
> 
> 赞同：1
> 
> 时间：2012-04-09T23:41:56.557
> 
> 标签：android, sqlite, select

我有一个包含几列的数据库表。我想通过比较用户输入的字符串来选择某些行，并根据他们的输入选择记录。我有以下代码：

SearchbyIngredient.Java

```
 final Button searchbutton1 = (Button) findViewById(R.id.searchbutton1);
searchbutton1.setOnClickListener(new View.OnClickListener() {
    public void onClick(View v) {
Cursor temp = dbIngredientHelper.getDrinks(textView.getText().toString());
        String ingred = temp.getString(0);
        Context context = getApplicationContext();
        iadapter = new IngredientAdapter(temp);
        myListView.setAdapter(iadapter);
    }
});
} 
```

成分助手.Java

```
public Cursor getDrinks(String drinkName) throws SQLException{
    SQLiteQueryBuilder queryBuilder = new SQLiteQueryBuilder();
    queryBuilder.setTables(TABLE_NAME2);
    String selection = COLUMN_INGRED1 + "= ' " + drinkName + "'";
    String[] asColumnsToReturn = new String[] { COLUMN_ID2, COLUMN_DRINKNAME, COLUMN_INGRED1, COLUMN_AMT1, COLUMN_INGRED2, COLUMN_AMT2, COLUMN_INGRED3, COLUMN_AMT3, COLUMN_INGRED4, COLUMN_AMT4 };
    Cursor mCursor2 = queryBuilder.query(dbSqlite, asColumnsToReturn, selection, null, null, null, COLUMN_DRINKNAME);
    /*Cursor mCursor = dbSqlite.query(true, TABLE_NAME2, new String[]{
            COLUMN_DRINKNAME}, 
            COLUMN_INGRED1 + "= ' " + drinkName + "'", null, null, null, null, null);
    if (mCursor != null){
        mCursor.moveToFirst();
    }*/
    mCursor2.moveToFirst();
    return mCursor2;
} 
```

我的问题是关于

```
String selection = COLUMN_INGRED1 + "= ' " + drinkName + "'"; 
```

此代码当前有效，但是它仅在 COLUMN_INGRED1 中找到包含用户文本的条目（代码中只有一个列）。如何格式化语句或制作一系列语句，以便它还在 COLUMN_INGRED2、COLUMN_INGRED3 和 COLUMN_INGRED4 中查找用户的文本？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T00:05:06.683

适用标准 SQL，使用 OR：

```
 COLUMN_INGRED1 + "= ' " + drinkName + "' OR " COLUMN_INGRED2 + "= '" +drinkName + "'" ...; 
```

请注意，`=`将进行完全匹配，您可能需要查看[LIKE](http://www.w3schools.com/sql/sql_like.asp)运算符。

# javascript - 使用 JavaScript 处理网站状态

> ID：10081263
> 
> 赞同：-1
> 
> 时间：2012-04-09T23:42:18.057
> 
> 标签：javascript

我目前正在处理一个严重依赖 JavaScript 并使用 node.js 作为后端的聊天。我想在 JavaScript 中做尽可能多的事情（如果可能的话，甚至可能根本没有 PHP）。我遇到的问题之一是如何保持网站的状态。当用户单击联系人时，将从服务器获取通信内容。

您建议保存当前显示的联系人的 ID。锚？多变的？曲奇饼？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T00:25:54.800

Cookie 用于您的网站相对长期的使用，特别是当您希望保留一些为手边的用户定制的数据客户端（并且不会危及您的系统）时。因此，当他（或她）重新访问您的网站时，它将与他们离开时一样 - 无需您在数据库中存储不必要的每个用户数据。所以，从*定义上看*，这对 cookie 来说是不行的。

您的问题更多的是即时使用性质 - 您正在使用当前显示的联系人的 id，这可能最适合变量（来自提供的），甚至可能是 DOM - 正如 jfriend00 指出的那样。

而且，一条一般性建议是，一定要考虑标准的安全隐患和防御性代码。

快乐编码！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T23:47:00.017

如果您只在页面期间需要此状态，则没有理由使用 cookie。Plus cookie 的大小和数量都有些限制。

因此，是否要将数据保存在 javascript 变量中，或者只是将其放入 DOM 并在需要时直接在 DOM 中访问它，这完全取决于您。我倾向于在 javascript 变量中保留高级别的东西，以便快速执行未来的任务，但如果数据在 DOM 中，我看不出有任何理由通过存储在 DOM 和 JS 变量中来复制大量数据。

但是，归根结底，这取决于它是什么类型的数据、已经存储在 DOM 中的数据、未来对所需数据的访问类型以及对它采取的操作。我们需要更多地了解您正在做的事情的细节，以便为您的具体情况提供更具体的建议。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-09T23:48:26.693

在这 3 个选项之间，我建议**将其存储在 variable**中。原因如下：

*   使用纯 javascript 无法轻松访问 Cookie，至少在不添加一些自定义函数的情况下无法访问
*   将数据绑定到视图（即绑定`id`到`<a>`锚标记）虽然很常见，但会破坏干净的编码约定。正如我从经验中学到的那样，它会让你在路上头疼。

使用变量或其他持久性数据存储（即`localStorage`）是存储数据的更好方法。如果您正在寻找一种在 javascript 应用程序中组织数据和视图的好方法，请查看[Backbone.js](http://documentcloud.github.com/backbone/)框架。

# python - 在 Python 中根据关键字创建对象并调用其方法

> ID：10081269
> 
> 赞同：0
> 
> 时间：2012-04-09T23:42:54.633
> 
> 标签：python

我正在用 Python 编写一个非常简单的语言语法的解释器。我有一个超类`Statement`，它有几个子类。我在超类中有一个`CreateStatement`评估关键字的方法，并根据找到的关键字创建子类对象的实例。一些子类将需要调用此方法。

我的问题是我收到了这个错误：

```
AttributeError: 'Statement' object has no attribute 'Assignment' 
```

帮助！

```
import re
from TokenHandler import TokenHandler
from ParserException import ParserException

class Statement(object):

    tokens = []
    executedTokens = []

    def __init__(self, tokenlist):
        self.tokens = tokenlist

    def getCurrentToken(self):
        print self.tokens[0]
        return self.tokens[0]

    def createStatement(self):
        currenttoken = self.getCurrentToken()

        t = TokenHandler()

        if currenttoken == "print":
            p = Print(self.tokens)
            return p

        elif t.isVariable(currenttoken):
            a = Assignment(self.tokens)
            return a

        elif currenttoken == "if":
            i = IF(self.tokens)
            return i

        elif currenttoken == "while":
            w = While(self.tokens)
            return w

        elif currenttoken == "begin":
            s = self.CompoundStatement(self.tokens)
            return s

        else:
            raise ParserException('Reserved word \'end\' expected')

    #...other methods... 
```

* * *

```
from Statement import Statement
from TokenHandler import TokenHandler
import VariableException

class Assignment(Statement):

    def __init__(self, tokens = []):
        super(Assignment, self).__init__(tokens)

    #...other methods... 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T23:45:21.560

```
 a = self.Assignment(self.tokens) 
```

如果`Assignment`是在模块级别定义的子类而不是`Statement`类或`self`实例的属性，则错误。你的意思是

```
 a = Assignment(self.tokens) 
```

这一行可能同样是错误的：

```
 s = self.CompoundStatement(self.tokens) 
```

# ios - 如何判断我的报亭 Atom Feed 是否会被处理？

> ID：10081271
> 
> 赞同：3
> 
> 时间：2012-04-09T23:43:10.053
> 
> 标签：ios, atom-feed, newsstand-kit

编辑：2013-06-11：我的意思是，这是一种确认 Newsstand Atom 提要不会损坏现在正在填充 Newsstand 项目的方法。当我发布这个问题时，我想测试一个已经发布的应用程序的原子提要，但我担心 App Store 上显示的当前报亭项目（手动添加）可能会被删除。因此，我尝试在 iTunes Connect 上的另一个虚拟应用程序上测试相同的 atom 提要，但我不确定它是否可以，因为 atom 提要中的 Newsstand 项目未显示在 iTunes Connect 中...

我将 URL 设置为 Atom 提要并等待 24 小时（现在是 3 天），但来自 Atom 提要的问题似乎没有出现在 iTunes Connect 的“管理报亭”中。 **我已经针对未发布的应用程序对此进行了测试**。所以我不知道 Atom 提要中的这些问题会出现在 App Store 中。这是正确的行为吗？有人使用原子提要来更新问题吗？

仅供参考，我引用了有关“Atom 提要”设置的注释：

> Feed 信息每天处理一次。添加或更新您的提要后，您可能需要等待 24 小时，然后更改才会显示在 iTunes Connect 和/或 App Store 中。有关详细信息，请参阅 Newsstand Atom Feed 规范。

PS 我很抱歉与[https://devforums.apple.com/thread/147608](https://devforums.apple.com/thread/147608)交叉发布这个问题，但论坛上的主题似乎很荒凉......

更新：在我输入 URL 时验证了提要（我更正了一些错误）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-11T05:46:52.680

确保您已遵循[https://itunesconnect.apple.com/docs/NewsstandAtomFeedSpecification.pdf中指定的所有要求](https://itunesconnect.apple.com/docs/NewsstandAtomFeedSpecification.pdf)

特别是，xml 标签必须按规定组织。封面艺术图标未更新的原因之一是图像尺寸不正确。此图标的长边必须至少为 1024 像素。

# iphone - 从另一个视图中的一个视图访问变量值

> ID：10081272
> 
> 赞同：1
> 
> 时间：2012-04-09T23:43:15.903
> 
> 标签：iphone, objective-c, xcode, ipad, uiviewcontroller

我在理解变量值如何从一个视图传递到另一个视图时遇到了一些麻烦。我在用户输入数字的第一个视图中有一个 UITextField。当用户点击一个按钮时，该数字乘以 2，结果显示在第二个视图的 UILabel 上。这就是我迄今为止所拥有的

第一视图控制器.h

```
@interface FirstViewController : UIViewController{
UITextField *numberTextField;
NSNumber *aNumber;
}
@property (nonatomic, retain) IBOutlet UITextField *numberTextField;
@property (nonatomic) NSNumber *aNumber;
-(IBAction)calculate;
@end 
```

第一视图控制器.m

```
@implementation FirstViewController
@synthesize numberTextField,  aNumber;

-(double)doubleNumber{
double number = [numberTextField.text doubleValue] * 2;
return number;
}

-(IBAction)calculate{
self.aNumber = [NSNumber numberWithDouble:[self doubleNumber]];   
}

//more default code continues below 
```

SecondViewController.h

```
#import "FirstViewController.h"

@interface SecondViewController : FirstViewController{
UILabel *numberLabel;
}
@property (nonatomic, retain) IBOutlet UILabel *numberLabel;
@end 
```

第二视图控制器.m

```
@implementation SecondViewController
@synthesize numberLabel;

- (void)viewDidLoad
{
[super viewDidLoad];
numberLabel.text = [NSString stringWithFormat:@"%@",aNumber];
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-10T04:52:10.470

## 在全球范围内存储价值的最佳简便方法

用你的关键字设置你的对象

```
[[NSUserDefaults standardUserDefaults] setObject:@"Ajay" forKey:@"name"]; 
```

而不是在您项目的任何地方获取该对象

```
NSString *name = [[NSUserDefaults standardUserDefaults] objectForKey:@"name"]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T00:00:09.430

你应该通过使用 segue 来完成你想要的。在你的故事板中创建一个 segue，然后在你的 firstviewcontroller 中调用它`- (void)performSegueWithIdentifier:(NSString *)identifier sender:(id)sender`。然后要传递数据，请导入您的 secondviewcontroller.h 文件，其中包含您要传递的值的属性和 setup `- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender`。

在那种方法中，您可以使用`[segue.destinationViewController ###call the setter for the property in your secondViewController.h file###];`

如果不清楚，或者您需要更多帮助，请告诉我。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-10T00:11:19.990

我假设 FirstViewController 正在实例化 SecondViewController。如果是这样，那么您只需使用附加属性将 aNumber 传递给 SecondViewController：

```
// add an additional property to the SecondViewController
@property (nonatomic, retain) NSNumber *aNumber; 
```

当您在 FirstViewController 中实例化 SecondViewController 时，您只需将该值传递给 SecondViewController，然后再加载它：

```
// inside FirstViewController 
SecondViewController *secondViewController = [[SecondViewController alloc] initWithNibName:@"SecondViewController" bundle:nil];
secondViewController.aNumber = aNumber;

// inside SecondViewController
- (void)viewDidLoad 
{ 
    [super viewDidLoad]; 
    numberLabel.text = self.aNumber; 
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-10T00:29:19.633

嗯...注意不要混淆视图和视图控制器！！！

viewController 可以管理的不仅仅是一个视图。例如，在您的代码中，您有一个 UITextField、一个 UILabel 并且可能还有一个 UIButton。这些都是由两个viewsController（FirstViewController 和SecondViewController）管理的视图。

只要您可以使用的视图很少，您就可以只使用一个 viewController 并将您想要的值直接传递给您的 UILabel：

```
- (void)calculateAndPassValue
{
    aNumber = [NSNumber numberWithDouble:[self doubleNumber]];
    numberLabel.text = [NSString stringWithFormat:@"%@",aNumber];
} 
```

否则，如果您的目标是将变量值从一个视图控制器传递到另一个视图控制器。嗯......有很多方法可以获得它，例如：

1.  创建一个 ivar。
2.  使用单例。
3.  将您的数据保存在 NSUserDefault 中。
4.  在磁盘上创建数据库。

如果您需要在应用程序运行时管理数据，则第一种和第二种情况都很好。第三和第四，如果您想记住数据以供将来使用并在下次启动时检索它们。

尝试搜索 ivar、singleton、NSUserDefault 等键，您会发现许多讨论和示例代码行。

# c++ - 在 Windows C++ 程序中绘制骰子？

> ID：10081275
> 
> 赞同：0
> 
> 时间：2012-04-09T23:43:29.330
> 
> 标签：c++, windows, winapi, gdi

我们刚开始学习 C++ 中的 windows 编程。我们必须制作一个屏幕上有 4 个骰子的程序，当用户按下“空格键”时，骰子滚动或骰子上的点数随机变化。我们的教授已经给了我们很多信息，所以我只是在寻找一些方向。

现在，我在屏幕上绘制了 4 个正方形，由 Rectangle() 函数制成。

```
Rectangle(hDC,30,100,130,200);
Rectangle(hDC,180,100,280,200);
Rectangle(hDC,330,100,430,200); 
Rectangle(hDC,480,100,580,200); 
```

我的问题是 1）我将如何在这些“正方形”而不是“屏幕”上绘制点。因此，如果我向上移动骰子，点会随着正方形移动，而不仅仅是停留在屏幕上。2.）当按下空格键（模拟它们已经滚动）时，我将如何让这些点随机变化？只是寻找一些方向，谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T00:15:53.267

1)
您仍然需要在屏幕上绘制它们，但您可以构建您的程序以将点实现为正方形的一部分。

```
void moveSquare()
{
    //change square position
    //change dots positions the same as you changed the square
} 
```

* * *

2）
您可以使用`WM_KEYDOWN`和`WM_KEYUP`消息或`WM_CHAR`消息捕获窗口中的按键。只需开始一连串更改按下空格时应该出现在骰子上的点数（`SetTimer`可能很方便），然后让我们`WM_PAINT`完成绘制点的工作（或调用一些东西来计算点的位置，然后让`WM_PAINT`循环通过它需要绘制的每个点。

```
void OnSpacePressed()
{
    //start changing dots every so often, handled elsewhere
    //maybe check if finished rolling before doing so
}

void calculateDotPositions()
{
    switch (numberOfDots) {...} //hint: use the square as a reference point
}

void OnPaint()
{ 
    //paint each sqaure
    //paint each dot in the correct position, which should be updated with square
}

void OnChangeDots()
{
    //change number of dots
    //also start a new change to happen later if not done rolling
} 
```

要绘制点，请使用 Warren P 的参考链接。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T00:17:01.763

另一种方法是在内存中创建位图或图片。一个用于模具的 6 个面中的每一个。这里的目标是将位图复制到屏幕上，而不是每次都重新绘制它们。研究“位图”和“bitblt”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-10T00:12:38.633

您应该创建一个在原点绘制骰子的例程，并按给定坐标偏移。我不熟悉您正在使用的特定库，所以我不知道 hDC 是什么，但它应该类似于以下内容。

```
void drawDie(HDC hDC, int xCoord, int yCoord, int dieValue)
{
    Rectangle(hDC, -50 + xCoord, -50 + yCoord, 50 + xCoord, 50 + yCoord);

    // draw some number of circles specified by dieValue at appropriate coordinates
    // translated by xCoord and yCoord arguments
} 
```

然后，如果您希望它们更改，您可以在以前的骰子上重新绘制骰子。

# mysql - mysql - 如何从子查询中获得第一个结果？

> ID：10081287
> 
> 赞同：6
> 
> 时间：2012-04-09T23:44:53.873
> 
> 标签：mysql, sql

我有两张桌子。这是一个简化的细分：

```
Table #1 - Album:
Rows:
albumId | title | userId

Table #2 - Photo:
Rows:
photoId | src | albumId 
```

我想从每个相册中获取第一张照片的 src。这显然不是我想要的，但这是我所拥有的：

```
SELECT pa.id, pa.title, p.src
FROM Album pa
LEFT JOIN Photo p ON pa.Id = p.albumId
WHERE pa.userId = 1 
```

这将返回用户的所有照片。我想要这些结果中每张专辑的第一个结果。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T23:47:37.430

正如@zerkms 所说，我认为您可能想要添加一个cover_photo_id，但这可以解决问题（不知道使用子查询对于您的情况是否足够有效）

```
SELECT pa.albumId, pa.title, p.src
FROM Album pa
LEFT JOIN Photo p 
  ON p.photoId = (SELECT MIN(photoId) FROM Photo WHERE albumId = pa.albumId)
WHERE pa.userId = 1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T23:48:19.440

```
SELECT pa.id, pa.title, p.src
FROM Album pa
  LEFT JOIN Photo p ON pa.Id = p.albumId
WHERE pa.userId = 1 LIMIT 1; 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-04-09T23:49:34.760

您想使用 GROUP BY

```
SELECT pa.id, pa.title, p.src
FROM Album pa
LEFT JOIN Photo p ON pa.Id = p.albumId
WHERE pa.userId = 1
GROUP BY pa.id, pa.title 
```

如果您实际上想要相当于 FIRST，请参阅[此答案](https://stackoverflow.com/questions/1379565/mysql-first-and-last-record-of-a-grouped-record-aggregate-functions "这个答案")

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-04-10T00:01:37.870

```
SELECT pa.id, pa.title, p.src
FROM Album pa
LEFT JOIN Photo p ON pa.Id = p.albumId
WHERE pa.userId = 1
GROUP BY pa.albumId
ORDER BY p.photoID 
```

# node.js - 使用分发 nodejs 包将 NPM 安装到主目录（Ubuntu）

> ID：10081293
> 
> 赞同：102
> 
> 时间：2012-04-09T23:45:53.840
> 
> 标签：node.js, npm

我想使用分发 Node.js 包（或更新版本的[chris-lea ppa](https://launchpad.net/~chris-lea/+archive/node.js/)），但将 NPM 安装到我的主目录。

这可能看起来很挑剔，但对于使用 polyglot/github 的开发人员来说，这是一种非常惯用的方式来在 Linux 下设置语言运行时/库环境：运行时的发行包，每个用户环境中的 3rd-party 库（参见 virtualenv，RVM - RVM如果您愿意，还将为您构建 Ruby）。如有必要，我将在本地构建节点，但它是一个 PITA，因为 Node 正在成为许多项目的附带开发需求。

*   [将 node+npm 安装到主目录的说明](http://increaseyourgeek.wordpress.com/2010/08/18/install-node-js-without-using-sudo/)

* * *

## 回答 #1

> 赞同：214
> 
> 时间：2012-10-22T23:51:29.777

NPM 已经将本地包安装到您的项目中，但我仍然希望系统远离我的操作系统文件。以下是我建议划分 Nodejs 包的方法：

通过 chris-lea PPA 安装 Nodejs 和 NPM。然后我在我的 homedir 中设置了一个包根来保存节点“全局”包：

```
 $ NPM_PACKAGES="$HOME/.npm-packages"
 $ mkdir -p "$NPM_PACKAGES" 
```

设置 NPM 使用这个目录来安装它的全局包：

```
 $ echo "prefix = $NPM_PACKAGES" >> ~/.npmrc 
```

通过将以下内容添加到 .zshrc/.bashrc 中，配置 PATH 和 MANPATH 以查看 $NPM_PACKAGES 前缀中的命令：

```
# NPM packages in homedir
NPM_PACKAGES="$HOME/.npm-packages"

# Tell our environment about user-installed node tools
PATH="$NPM_PACKAGES/bin:$PATH"
# Unset manpath so we can inherit from /etc/manpath via the `manpath` command
unset MANPATH  # delete if you already modified MANPATH elsewhere in your configuration
MANPATH="$NPM_PACKAGES/share/man:$(manpath)"

# Tell Node about these packages
NODE_PATH="$NPM_PACKAGES/lib/node_modules:$NODE_PATH" 
```

现在，当您执行. 时，`npm install -g`NPM 会将库安装`~/.npm-packages/lib/node_modules`到.`~/.npm-packages/bin``PATH`

`npm install -g`像往常一样使用：

```
[justjake@marathon:~] $ npm install -g coffee-script
... (npm downloads stuff) ...
/home/justjake/.npm-packages/bin/coffee -> /home/justjake/.npm-packages/lib/node_modules/coffee-script/bin/coffee
/home/justjake/.npm-packages/bin/cake -> /home/justjake/.npm-packages/lib/node_modules/coffee-script/bin/cake
coffee-script@1.3.3 /home/justjake/.npm-packages/lib/node_modules/coffee-script

[justjake@marathon:~] $ which coffee
/home/justjake/.npm-packages/bin/coffee 
```

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2016-09-07T15:18:08.953

Jake 的答案发布于 2012 年，虽然有用，但它引用了 Chris Lea 的 Node.js PPA，这些 PPA 自 2015 年 3 月以来不再更新。

以下是我在主目录中安装 Node.js 和 npm 的步骤：

# [使用nvm](https://github.com/creationix/nvm#installation)安装 Node.js （`sudo`不需要）：

```
curl -o- https://raw.githubusercontent.com/creationix/nvm/v0.33.2/install.sh | bash
source ~/.bashrc
nvm install 7
npm install -g npm  # update npm 
```

现在你可以`install -g`没有`sudo`，一切都进入`~/.nvm/`

# 或者在没有 nvm 的情况下安装 Node.js（[官方说明](https://nodejs.org/en/download/package-manager/#debian-and-ubuntu-based-linux-distributions)）：

### 安装 Node.js

*   Node.js v6（截至 2017 年 5 月的当前 LTS）：

    ```
    curl -sL https://deb.nodesource.com/setup_4.x | sudo -E bash -
    sudo apt-get install -y nodejs 
    ```

*   Node.js v7：

    ```
    curl -sL https://deb.nodesource.com/setup_7.x | sudo -E bash -
    sudo apt-get install -y nodejs 
    ```

### 将 npm 的默认目录更改为本地目录：

```
mkdir ~/.npm-global
npm config set prefix '~/.npm-global'
export PATH="$HOME/.npm-global/bin:$PATH"  # ← put this line in .bashrc
source ~/.bashrc  # if you only updated .bashrc 
```

或者替换`.npm-global`为您选择的目录。

### 更新 npm 并检查它是否安装在您的`$HOME`目录中：

```
$ npm install npm -g
/home/<username>/.npm-global/bin/npm -> /home/<username>/.npm-global/lib/node_modules/npm/bin/npm-cli.js
/home/<username>/.npm-global/lib
└─┬ npm@3.10.6 
  ├─┬ glob@7.0.5 
  │ └── minimatch@3.0.2 
  ├── npm-user-validate@0.1.5 
  └── rimraf@2.5.3 
```

现在你可以`install -g`不用`sudo`和不用弄乱你的系统文件。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2014-06-26T13:16:51.223

Just Jake 发布的解决方案很棒。但是，由于 npm > 1.4.10 的错误，它可能无法按预期工作。（见[这个](https://github.com/npm/npm/issues/5459)和[这个](https://github.com/npm/npm/issues/5501)）

解决该错误后，您可以按照以下步骤降级到 npm 1.4.10：

1.  注释 $HOME/.npmrc 中的前缀行
2.  跑`sudo npm install -g npm@1.4.10`
3.  确保安装了正确版本的 npm ( `npm --version`)
4.  取消注释 $HOME/.npmrc 中的前缀行
5.  继续在您的主文件夹中安装您的全局包！。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2015-01-19T18:33:23.063

因为 python 已经做得很好了`virtualenv`，所以我使用[`nodeenv`](https://github.com/ekalinin/nodeenv). 与 相比`nvm`，您可以为相同的节点版本创建多个环境（例如，节点的两个环境`0.10`但具有不同的包集）。

```
ENVNAME=dev1

#  create an environment
python -m virtualenv ${ENVNAME}

# switch to the newly created env
source ${ENVNAME}/bin/activate

# install nodeenv
pip install nodeenv

# install system's node into virtualenv
nodeenv --node=system --python-virtualenv 
```

自述文件非常好： [https ://github.com/ekalinin/nodeenv](https://github.com/ekalinin/nodeenv)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2015-12-25T23:34:06.437

我使用@just-jake[解决方案](https://stackoverflow.com/a/13021677/391865)一段时间，发现[nvm](https://github.com/creationix/nvm)更容易设置。它也是非常强大的解决方案，允许安装和使用不同版本的`nodejs`.

在 Ubuntu 14.04 或 16.04 上：

1.  安装用于构建的必备软件包`nodejs`：

    ```
    sudo apt-get update
    sudo apt-get install build-essential libssl-dev 
    ```

2.  安装[nvm](https://github.com/creationix/nvm)：

    ```
    curl -o- https://raw.githubusercontent.com/creationix/nvm/v0.31.1/install.sh | bash 
    ```

    如果有更新版本的 nvm 可用，您可以在[nvm](https://github.com/creationix/nvm)站点上找到实际的安装命令。

3.  `nvm`安装程序会将引导脚本添加到`~/.bashrc`，因此您需要重新打开终端来运行它，或者执行以下操作：

    ```
    source ~/.bashrc 
    ```

4.  现在你可以安装任何`nodejs`你喜欢的版本，在它们之间切换等等。

    用于`nvm ls-remote`列出可用`nodejs`版本。

    例如，要安装`nodejs`v4.2.4，请执行以下操作：

    ```
    # install v4.2.4
    nvm install v4.2.4 
    # use nodejs v4.2.4 in the current terminal session
    nvm use v4.2.4
    # use v4.2.4 by default in new terminal session
    nvm alias default v4.2.4 
    ```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2020-07-22T02:56:06.683

其他答案已经过时的解决方案：2020 年的解决方案是使用`NPM_CONFIG_PREFIX`环境变量。（查看[详情](https://docs.npmjs.com/resolving-eacces-permissions-errors-when-installing-packages-globally)）

例如，

```
$ NPM_CONFIG_PREFIX="$HOME/.npm-packages" npm install -g ios-sim
/Users/<name>/.npm-packages/bin/ios-sim -> /Users/<name>/.npm-packages/lib/node_modules/ios-sim/bin/ios-sim
+ ios-sim@9.0.0
added 108 packages from 68 contributors in 3.094s 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2016-09-01T21:17:12.807

如前所述[here](https://stackoverflow.com/questions/10081293/install-npm-into-home-directory-with-distribution-nodejs-package-ubuntu#comment53332138_13021677)和[here](https://stackoverflow.com/questions/19352976/npm-modules-wont-install-globally-without-sudo/25151631#25151631)

```
npm config set prefix ~
echo export PATH=\$PATH:\~/bin >> ~/.bashrc
. ~/.bashrc 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2014-07-27T20:03:11.333

扩展 Just Jake 和 user1533401 提供的答案：我无法降级，因为我使用共享主机并且节点安装在系统目录中。这也是为什么我要更改 npm 安装全局脚本的目录的原因。对于那些在同一条船上的人，这是我发现的另一个临时修复方法：

`npm install -g --prefix=$(npm config get prefix) <package>`

错误是 npm 不会读取您的每用户配置文件，但每次安装全局脚本时都指定它来修复它。[在这里](https://github.com/npm/npm/issues/5459)找到。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2021-04-02T16:47:49.707

对于类似的问题，我有一个稍微不同的解决方案，这是由于我在`npm`全局安装，所以我可以在我的 macOS 系统的终端中使用它。我只是在我的存储库的根目录中使用以下命令在本地初始化它：

```
npm init --yes 
```

这使我能够使用“package.json”和“package-lock.json”文件将节点包安装在 /node_modules 的本地根目录中，而不是在用户的主目录中。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-08-27T13:29:40.023

至少在 Ubuntu 上，系统范围的默认配置`npm`是`npm install --global`尝试将软件包安装到`/usr/lib/node_modules`. 要为您自己的用户帐户设置不同的默认值，请运行以下一次：

```
mkdir -p ~/.npm/lib/bin
npm config set prefix "~/.npm/lib" 
```

此外，您还需要以下片段`.profile`：

```
# set PATH so it includes user's private .npm/lib/bin if it exists
if [ -d "$HOME/.npm/lib/bin" ] ; then
    PATH="$HOME/.npm/lib/bin:$PATH"
fi 
```

如果您现在安装一些东西，`npm install --global packagename`它将最终在正确的位置，并且可以在您的 PATH 中找到（您可能需要注销并重新登录才能使`.profile`更改生效）。

当然，您可以选择其他目录。例如`~/.config/npm`，可能对现代系统有意义。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2022-02-05T07:54:08.137

您可以使用[`npm-user`](https://github.com/alexdelorenzo/npm-user)自动设置`npm`将软件包安装到用户的目录而不是系统的目录中。不需要`root`特权。

[这是脚本的链接](https://github.com/alexdelorenzo/npm-user)，有关如何使用它的说明以及有关其选项的信息。它适用于 macOS、Linux、*BSD 和 Windows。

你可以像这样运行它：

```
$ curl -s "https://raw.githubusercontent.com/alexdelorenzo/npm-user/main/npm-user.sh" | bash 
```

运行后， using`npm install -g <package>`会将软件包安装到用户的目录中，而无需使用`sudo`.

如果您想将其复制并粘贴到控制台中，请使用以下代码：

```
#!/usr/bin/env bash
# Copyright 2022 Alex DeLorenzo <alexdelorenzo.dev>. Licensed under the GPLv3.
export ROOT="${1:-$HOME}"

export NPM_DIR=".npm-packages"
export NPM_ROOT="$ROOT/$NPM_DIR"
export NPM_BIN="$NPM_ROOT/bin"
export NPM_MAN="$NPM_ROOT/share/man"

export BASH_RC="$HOME/.bashrc"
export ZSH_RC="$HOME/.zshrc"
export DEFAULT_RC="$BASH_RC"

export RC_ERR=1
export INDENT=2

set -e

shopt -s expand_aliases

alias indent="paste /dev/null - | expand -$INDENT"

quiet() {
  "$@" &> /dev/null
}

expand-tilde() {
  local path="$1" 
  echo "${path/#\~/$HOME}"
}

create-paths() {
  local bin="${1:-$NPM_BIN}"
  local man="${2:-$NPM_MAN}"

  mkdir --parents --verbose "$bin" "$man"
}

set-prefix() {
  npm config set prefix "$NPM_ROOT"
}

get-vars() {
  local bin="${1:-$NPM_BIN}"
  local man="${2:-$NPM_MAN}"

  cat <<EOF
export PATH="\$PATH:$bin"
export MANPATH="\${MANPATH:-\$(manpath)}:$man"
export NPM_PACKAGES="$NPM_ROOT"
EOF
}

already-added() {
  local rc="${1:-$DEFAULT_RC}"
  local bin="${2:-$NPM_BIN}"
  local man="${2:-$NPM_MAN}"

  local vars="$(get-vars "$bin" "$man")"
  quiet grep "$vars" "$rc"
}

main() {
  local rc="$(expand-tilde "${1:-$DEFAULT_RC}")"
  local bin="$(expand-tilde "${2:-$NPM_BIN}")"
  local man="$(expand-tilde "${3:-$NPM_MAN}")"

  printf "Creating %s and %s\n" "$bin" "$man"
  create-paths "$bin" "$man" || {
    printf "Couldn't create paths: %s and %s.\n" "$bin" "$man" 
    return $RC_ERR
  }

  printf "Setting npm prefix.\n"
  set-prefix || {
    printf "Couldn't set prefix.\n"  
    return $RC_ERR
  }

  if ! already-added "$rc" "$bin" "$man"; then
    printf "Writing to %s.\n" "$rc"
    get-vars "$bin" "$man" >> "$rc"

  fi || {
    printf "Unable to write to %s.\n" "$rc"
    printf "Add the following to your shell's configuration file:\n\n"

    get-vars "$bin" "$man" | indent
    return $RC_ERR
  }

  printf "Done.\n\n"
  printf "To load the changes in this shell, run:\n"
  printf "\tsource %s\n" "$rc"
}

main "$2" "$3" "$4" 
```

# c++ - 只允许修改稀疏矩阵的非零元素

> ID：10081295
> 
> 赞同：2
> 
> 时间：2012-04-09T23:46:21.330
> 
> 标签：c++, operator-overloading, sparse-matrix

我正在实现一个三对角矩阵，我必须尽可能高效。显然我只会保存包含数据的元素。我重载了`operator()`以充当矩阵的索引器，但我希望此运算符返回一个引用，以便用户可以修改矩阵。但是，我不能只`return 0;`针对非三对角元素，因为零不是参考。如何让用户修改三对角上的数据，但是当`operator()`用于检查非三对角元素时，只返回 0 而不是对 0 的引用？

下面是相关的类定义

```
template <class T>
class tridiagonal
{
  public:
    tridiagonal();
    ~tridiagonal();
    T& operator()(int i, int j);
    const T& operator()(int i, int j) const; 

  private:
    //holds data of just the diagonals
    T * m_upper;
    T * m_main;
    T * m_lower;
}; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T01:16:42.147

您可以使用的一个技巧是让非常量 operator() (int, int) 方法返回一个小助手对象。帮助器用于区分分配到矩阵和仅提取一个值。这使您可以对这两个操作有不同的行为。特别是，如果有人试图分配一个必须为零的值，您可以抛出异常。

这段代码至少在 VC10 中为我编译，但显然没有链接。

```
template <class T>
class tridiagonal
{
  public:

    // Helper class that let's us tell when the user is
    // assigning into the matrix and when they are just
    // getting values.
    class helper
    {
        tridiagonal<T> &m_parent;

        int m_i, m_j;

    public:
        helper(tridiagonal<T> &parent, int i, int j)
            : m_parent(parent), m_i(i), m_j(j)
        {}

        // Converts the helper class to the underlying
        // matrix value. This doesn't allow assignment.
        operator const T & () const {
            // Just call the const operator() 
            const tridiagonal<T> &constParent = m_parent;

            return constParent(m_i, m_j);
        }

        // Assign a value into the matrix.
        // This is only called for assignment.
        const T & operator= (const T &newVal) {
            // If we are pointing off the diagonal, throw
            if (abs(m_i - m_j) > 1) {
                throw std::exception("Tried to assign to a const matrix element");
            }

            return m_parent.assign(m_i, m_j, newVal);
        }
    };

    tridiagonal();
    ~tridiagonal();

    helper operator()(int i, int j)
    {
        return helper(*this, i,j);
    }

    const T& operator()(int i, int j) const; 

    private:

    T& assign(int i, int j, const T &newVal);

    //holds data of just the diagonals
    T * m_upper;
    T * m_main;
    T * m_lower;
};

int main(int argc, const char * argv[])
{
    tridiagonal<double> mat;

std::cout << mat(0,0) << std::endl;

const tridiagonal<double> & constMat = mat;

std::cout << mat(2,3) << std::endl;

// Compiles and works
mat(2,3) = 10.0;

// Compiles, but throws at runtime
mat(1, 5) = 20.0;

// Doesn't compile
// constMat(3,3) = 12.0;

    return 0;
} 
```

自从我这样做以来已经有一段时间了，因此您可能会发现需要向帮助程序类添加更多内容，具体取决于您使用矩阵的方式。

实际上，通过这是一个很好的 C++ 练习。:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T23:52:42.387

通过引用返回要求您返回指定类型的有效对象。完成您想要的最简单的方法是保留一个`T`表示 0 的静态对象，然后将其返回。

或者，您可以返回一个指针。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-09T23:56:39.123

只需添加一个代表一些虚拟值的额外成员，并确保它始终读取为 0。

```
template<typename T>
class tridiagonal 
{
    // usual stuff...

    T& operator() (int j, int j)
    {
        // if not explicitly stored, reset to default before returning.
        return stored(i,j)? fetch(i,j) : (m_dummy=T());
    }
private:
    // dummy element used to "reference" elements outside the 3 diagonals.
    T m_dummy;

    // check if (i,j) is on 3 diagonals.
    bool stored (int i, int j) const;

    // access element on 3 diagonals. precondition: stored(i,j)==true.
    T& fetch (int i, int j);

    //holds data of just the diagonals
    T * m_upper;
    T * m_main;
    T * m_lower;
}; 
```

请注意，从技术上讲，有人可能会这样欺骗您：

```
tridiagonal<int> m(4,4);
T * dummy = &m(3,0); // *dummy == 0.
*dummy = 1;          // *dummy == 1.
std::cout << *dummy; // prints 1. 
```

但这不一定是个问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-10T01:10:47.217

您在这里遇到的问题是界面不合适。如果您对矩阵的定义是一个二维数字数组，这样矩阵的每个元素都可以单独设置，那么一个稀疏的三对角矩阵自相矛盾地*不是*矩阵（就像正方形不是*可修改*的矩形一样——一个经典的例子不符合 Liskov 替换原则的不适当继承）。

简而言之，你最好改变你的界面以适应稀疏的三对角矩阵，而不是试图破解它来使用你所拥有的界面。也就是说，如果你必须这样做，那么你最好做两件事：

*   修改您的`const`访问器以返回`T`而不是`const T&`（我假设我们在这里只处理数字矩阵）。然后你可以返回`0`对角线以外的元素。
*   修改您的非`const`访问器以返回对非对角线位置的虚拟元素的引用，然后交叉手指:) 或者，您可以在这种情况下将规范更改为`throw`，但这可能有点不友好。

另一种选择（没有正确修改接口）可能是返回代理对象而不是`T`s. `throw`当您尝试使用它设置值时，虚拟元素的代理就会出现。

# matlab - 线的霍夫变换

> ID：10081296
> 
> 赞同：4
> 
> 时间：2012-04-09T23:46:21.923
> 
> 标签：matlab, hough-transform

我试图让霍夫变换在 MATLAB 中工作，但我遇到了问题。我有一种非常糟糕的方法来检测需要修复的峰值，但在此之前我需要能够反转霍夫变换以再次正确创建线条。这是我现在得到的东西类型：

![在此处输入图像描述](../Images/1b4009858e9edcfdee80391dd65ab8b8.png)

看起来它旋转了 90 度，但我不知道为什么。我不确定是我的霍夫空间错了，还是我的方式是 dehough 和画线。还有人可以帮助改善我的峰值检测吗？

代码中使用的图像在[这里](https://imgur.com/a/dp7jN)

谢谢

```
%% load a sample image; convert to grayscale; convert to binary

%create 'x' image (works well)
a = eye(255);
b = flipud(eye(255));
x = a + b;
x(128,128) = 1;

%image = rgb2gray(imread('up.png')) < 255;
%image = rgb2gray(imread('hexagon.png')) < 255;
%image = rgb2gray(imread('traingle.png')) < 255;
%%% these work
%image = x;
%image = a;
image = b;

%% set up variables for hough transform
theta_sample_frequency = 0.01;                                             
[x, y] = size(image);
rho_limit = norm([x y]);                                                
rho = (-rho_limit:1:rho_limit);
theta = (0:theta_sample_frequency:pi);
num_thetas = numel(theta);
num_rhos = numel(rho);
hough_space = zeros(num_rhos, num_thetas);

%% perform hough transform
for xi = 1:x
    for yj = 1:y
        if image(xi, yj) == 1 
            for theta_index = 1:num_thetas
                th = theta(theta_index);
                r  = xi * cos(th) + yj * sin(th);
                rho_index = round(r + num_rhos/2);                      
                hough_space(rho_index, theta_index) = ...
                     hough_space(rho_index, theta_index) + 1;
            end
        end
    end
end

%% show hough transform
subplot(1,2,1);
imagesc(theta, rho, hough_space);
title('Hough Transform');
xlabel('Theta (radians)');
ylabel('Rho (pixels)');
colormap('gray');

%% detect peaks in hough transform
r = [];
c = [];
[max_in_col, row_number] = max(hough_space);
[rows, cols] = size(image);
difference = 25;
thresh = max(max(hough_space)) - difference;
for i = 1:size(max_in_col, 2)
   if max_in_col(i) > thresh
       c(end + 1) = i;
       r(end + 1) = row_number(i);
   end
end

%% plot all the detected peaks on hough transform image
hold on;
plot(theta(c), rho(r),'rx');
hold off;

%% plot the detected line superimposed on the original image
subplot(1,2,2)
imagesc(image);
colormap(gray);
hold on;

for i = 1:size(c,2)
    th = theta(c(i));
    rh = rho(r(i));
    m = -(cos(th)/sin(th));
    b = rh/sin(th);
    x = 1:cols;
    plot(x, m*x+b);
    hold on;
end 
```

> 交叉发布： [https ://dsp.stackexchange.com/questions/1958/help-understanding-hough-transform](https://dsp.stackexchange.com/questions/1958/help-understanding-hough-transform)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-12T17:10:31.020

如果您重新生成的图像看起来旋转了 90 度或以其他方式翻转，则可能是因为绘图没有按预期进行。您可以尝试`axis ij;`移动绘图的原点和/或您可以反转绘图命令：

```
plot(m*x+b, x); 
```

至于峰值检测，您可能需要查看`imregionalmax`.

# gradle - 创建一个依赖于另一个（外部）插件的 Gradle 插件

> ID：10081299
> 
> 赞同：18
> 
> 时间：2012-04-09T23:46:58.333
> 
> 标签：gradle

我想创建一个自动应用其他（外部插件）的插件。这需要在我调用“应用插件”之前为插件设置 buildscript 依赖项。但是，似乎我无法在插件中添加 buildscript 依赖项，或者我得到： **您无法更改未处于未解决状态的配置！**

有针对这个的解决方法吗 ？

我的示例（非工作）代码：

```
import org.gradle.api.Project
import org.gradle.api.Plugin
class SamplePlugin implements Plugin<Project>{
  void apply(Project project) {

    project.buildscript.dependencies.add("classpath","net.sourceforge.cobertura:cobertura:1.9.4.1");

    project.configure(project){         
      apply plugin: 'cobertura' 
    }
  }
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-10T19:38:07.943

解决这个问题的方法是发布 pom.xml 或 ivy.xml 以及描述插件依赖项的插件 Jar。或者，您可以编写一个脚本插件，在一个部分中声明其依赖项`buildscript {}`。脚本插件只是一个可重用的构建脚本，它与`apply from: ...`.

# php - 验证码不工作

> ID：10081303
> 
> 赞同：0
> 
> 时间：2012-04-09T23:47:21.687
> 
> 标签：php, captcha

我的网站上有一个验证码，[http://sketchedneo.com/jointest.php](http://sketchedneo.com/jointest.php)

但是它不起作用。

它只是让不正确的代码通过。

请有人帮忙解决这个问题

我不确定我需要为此显示哪一部分代码。（这是我的验证码.php）

```
<?php
session_start();
header("Expires: Mon, 26 Jul 1997 05:00:00 GMT"); 
header("Last-Modified: " . gmdate("D, d M Y H:i:s") . " GMT"); 
header("Cache-Control: no-store, no-cache, must-revalidate"); 
header("Cache-Control: post-check=0, pre-check=0", false);
header("Pragma: no-cache"); 

function _generateRandom($length=6)
{
    $_rand_src = array(
        array(48,57) //digits
        , array(97,122) //lowercase chars
//      , array(65,90) //uppercase chars
    );
    srand ((double) microtime() * 1000000);
    $random_string = "";
    for($i=0;$i<$length;$i++){
        $i1=rand(0,sizeof($_rand_src)-1);
        $random_string .= chr(rand($_rand_src[$i1][0],$_rand_src[$i1][1]));
    }
    return $random_string;
}

$im = @imagecreatefromjpeg("http://sketchedneo.com/images/sitedesigns/captcha.jpg"); 
$rand = _generateRandom(3);
$_SESSION['captcha'] = $rand;
ImageString($im, 5, 2, 2, $rand[0]." ".$rand[1]." ".$rand[2]." ", ImageColorAllocate ($im, 0, 0, 0));
$rand = _generateRandom(3);
ImageString($im, 5, 2, 2, " ".$rand[0]." ".$rand[1]." ".$rand[2], ImageColorAllocate ($im, 255, 0, 0));
Header ('Content-type: image/jpeg');
imagejpeg($im,NULL,100);
ImageDestroy($im);
?> 
```

代码检查：

```
<tr><td align="center">CAPTCHA:<br>
    (antispam code, 3 black symbols)<br>
    <table><tr><td><img src="captcha.php" alt="captcha image"></td><td><input type="text" name="captcha" size="3" maxlength="3"></td></tr></table>
</td></tr>
<td height="27" colspan="2" valign="middle">
         <center><input type=submit name=Submit value="Register"></center>
       </td>
</table>
</form>
<?php
if(isset($_POST['captcha'])) {
    if($_SESSION['captcha'] == $_POST['captcha']) {
        if(isset($_POST["captcha"]))

            //CAPTHCA is valid; proceed the message: save to database, send by e-mail ...
            echo 'CAPTHCA is valid; proceed the message';
        }
        else
        {
        echo 'CAPTHCA is not valid; ignore submission';
        }
    }
?> 
```

哪个代码在哪里？

```
<?php

include ($_SERVER['DOCUMENT_ROOT'].'/addon.php');

include ($_SERVER['DOCUMENT_ROOT'].'/dblink.php');

include ($_SERVER['DOCUMENT_ROOT'].'/security/stripusers.php');

$name = $_POST['name'];
$pass1 = $_POST['pass1'];
$pass2 = $_POST['pass2'];
$email = $_POST['email'];
$security = $_POST['security'];

$name = mysql_real_escape_string($name);
$name = stripslashes($name);
$name = stripusers($name);

$pass1 = mysql_real_escape_string($pass1);
$pass1 = stripslashes($pass1);
$pass1 = stripusers($pass1);

$pass2 = mysql_real_escape_string($pass2);
$pass2 = stripslashes($pass2);
$pass2 = stripusers($pass2);

$security = mysql_real_escape_string($security);
$security = stripslashes($security);
$security = stripusers($security);

$email = mysql_real_escape_string($email);
$email = stripslashes($email);
$email = stripusers($email);

if ((!$name) OR (!$pass1) OR (!$pass2) OR (!$email) OR (!$security))
{

 die(header("Location: $baseurl/join.php?error=Please+fill+out+all+of+the+information."));

}

$check = mysql_fetch_array(mysql_query("SELECT * FROM members WHERE username = '$name' "));

if ($check[username] == $name)

{

 die(header("Location: $baseurl/join.php?error=The+username+you+selected+already+exists"));

}

if ($pass1 != $pass2)

{

die( header("Location: $baseurl/join.php?error=Your+passwords+did+not+match"));

}

if((!is_numeric($security)) AND (!$security > 0000) AND (!$security < 9999))
    {
die(header("Location: $baseurl/join.php?error=Your+security+code+can+only+contain+numbers!"));
    }

if(strlen($security) <= 3)
    {
die(header("Location: $baseurl/join.php?error=Your+security+code+must+contain+four+numbers!"));
    }

if (preg_match('/^[a-zA-Z0-9_]*$/UD',$name))

{

$pword2 = md5($pass1);

$secure2 = md5($security);
$one = md5($name);

        mysql_query("INSERT INTO members (username,password,security,email,rank,name,age,gender,location,helpfaerie,profile,about,tasks,joined,icedmutereason,icedmutedetails,icedmuteby,icedmutedate,posts,signature,avatar,verify) VALUES ('$name','$pword2','$secure2','$email','3','$name','New Born','Unknown','Lost!','1','Welcome','Welcome','Hiding','$timestamp','None','None','None','0','0','None','http://images.neopets.com/neoboards/avatars/default.gif','0')") or die (mysql_error());

$message = "<p><p><center><table width=\"450\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\" style=\"border-top: 1pt solid black;border-left: 1pt solid black;border-right: 1pt solid black;;border-bottom: 1pt solid black;\">
  <tr>
    <td colspan=\"2\" style=\"background-color:#5eaed4;border-bottom: 1pt solid black;\"><center>Welcome to Lutari.net!</center></td>
    </tr>
  <tr>
    <td><img src=\"http://images.neopets.com/pets/happy/lutari_island_baby.gif\"></td>
    <td><p>Thank you for creating an account with us. To access the full featres of the site, please activate your account by clicking <a href=\"$baseurl/verify.php?user=$name&code=$one\">HERE</a></p>
      <p>Your Username: <b>$name</b><br>
 Your Activation Code: <b>$one</b>

      <p>If you did not make an account with us, please ignore this email.</p></td>
  </tr>
</table>
<p>&nbsp;</p>
</center>";

$subject = "Welcome to Lutari! - Activate your account.";

        mail($email,$subject,$message,"From: admin@lutari.net \nContent-Type: text/html; charset=iso-8859-1\r\nMime-Version: 1.0\nContent-Transfer-Encoding: 7bit");

}

else

{

 header("Location: $baseurl/join.php?error=Your+username+can+only+contain+letters+numbers+and+underscores.");

}

setcookie("lutari_user",$name, time()+3600*24);
setcookie("lutari_pass",$pword2, time()+3600*24);

 header("Location: $baseurl/joined.php");

?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T00:48:05.897

您可以将您的检查代码移动到`join.pro.php`（我假设这是您发布的最后一个代码部分），如下所示：

```
....
$email = stripslashes($email);
$email = stripusers($email);

session_start();

if (isset($_SESSION['captcha']) && isset($_POST['captcha'])){
     if($_SESSION['captcha'] != $_POST['captcha']) {
        header("Location: $baseurl/join.php?error=captcha+incorrect.");
        die();
     }

}else {
    header("Location: $baseurl/join.php?error=captcha+missing.");
    die();
}

if ((!$name) OR (!$pass1) OR (!$pass2) OR (!$email) OR (!$security))
... 
```

# php - 当用户点击显示更多按钮时显示更多帖子

> ID：10081306
> 
> 赞同：1
> 
> 时间：2012-04-09T23:47:40.223
> 
> 标签：php, mysql, function

当我网站上的用户访问他们的个人资料页面时，他们会看到他们发布的帖子列表。我目前默认显示 20 个帖子，但无法显示较旧的帖子。我想添加一个显示更多帖子按钮，该按钮会将其他/较旧的帖子加载到页面上。在用户单击“显示更多”按钮后，我应该怎么做才能向用户显示更多帖子？

**这是我的秀帖功能**

```
function show_posts1($userid){
$posts = array();
$sql = "SELECT p.body, p.stamp, p.id,u.username, u.imagelocation 
    FROM posts p 
    INNER JOIN users u 
    ON p.user_id=u.id 
    WHERE p.user_id='$userid' 
    ORDER BY p.stamp DESC";
$result = mysql_query($sql);
while($data = mysql_fetch_object($result)){
    $posts[] = array(   'stamp' => $data->stamp, 
                        'userid' => $userid, 
                        'body' => $data->body,
                        'username' => $data->username,
                        'imagelocation'=>$data->imagelocation,
                        'id'=>$data->id
                );
}
return $posts;
} 
```

**这是我在页面上显示帖子的方式**

```
<?php
$posts = show_posts1($_SESSION['user_id']);
if (count($posts)){
?>
    <table>
<?php
        foreach ($posts as $key => $list){
            echo "<tr>";
            echo "<td>".$list['body']."
                 </td>";
            echo "</tr>";
        }
?>
    </table>
<?php
}else{
?>
    <p><b>You haven't posted anything yet!</b></p>
<?php
}
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T00:02:24.627

您的查询应如下所示以对结果进行分页

```
$sql = "SELECT p.body, p.stamp, p.id,u.username, u.imagelocation 
    FROM posts p 
    INNER JOIN users u 
    ON p.user_id=u.id 
    WHERE p.user_id='$userid' 
    ORDER BY p.stamp DESC
    LIMIT <offset>,<max_rows>"; 
```

将当前偏移量存储在 Javascript 中，然后只需使用 AJAX 调用`show_posts1 ($userid[, $offset])`以再次运行查询并检索接下来的 20 个帖子。

# git - （又一个）修改 git 历史记录以添加第一个提交

> ID：10081308
> 
> 赞同：6
> 
> 时间：2012-04-09T23:47:45.077
> 
> 标签：git, git-rebase

我正在修改别人的（非 git）代码。我下载了原始版本，然后进行了修改，然后开枪将修改后的版本作为我的第一次提交。这是一个错误，我应该将原始下载的代码添加为我的第一次提交。

然后为了雪上加霜，我添加了原始代码作为我第一次编辑的一个分支。换句话说，现在是一团糟:(

简单来说，我所拥有的看起来像下面的蓝色图表。C5 是实际的原始代码，C1,C2-C6 是我逐渐修改的（C4 是多余的）。我宁愿让绿色成为我的历史。

![在此处输入图像描述](../Images/39c696e89ecd764c0d703ca93542f8ed.png)

任何想法如何修改历史来实现这一点？

非常感谢，

狡猾

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-11T08:43:20.380

我已经完全在命令行中完成了这项工作，但我将插入 SourceTree 的屏幕截图来说明正在发生的事情。

首先从 C5 提交中获取提交 id (50da9c3) 的前 7 或 8 位数字，然后放入剪贴板或 textedit 或其他东西 - 你稍后会需要它

为了确认，这是我们的起始状态：

![在此处输入图像描述](../Images/98312d7fca994ddc43d5c2047a9d31a8.png)

以下是到达您想要的位置的步骤：

创建一个新的无根分支以开始从命名基础构建提交

```
git symbolic-ref HEAD refs/heads/base 
```

现在从 git 中删除所有文件和目录

```
git rm --cached -r . 
```

现在所有文件都“未跟踪”，将它们从本地工作目录中删除

```
git clean -d --force 
```

现在创建一个没有任何内容的提交（这将是构建其他所有内容的提交）。

```
git commit --allow-empty -m'Initial Commit' 
```

你的树现在应该是这样的：

![在此处输入图像描述](../Images/3073df273c9fe76aaefd73b683d8cb97.png)

现在樱桃选择 c5 提交（您在剪贴板上的内容）

```
git cherry-pick 50da9c3 
```

![在此处输入图像描述](../Images/ca6df0397a678405938a06aa04f47745.png)

现在将主分支重新植根到基础分支

```
git rebase --onto base --root master 
```

![在此处输入图像描述](../Images/220575baec8b70916c6ca129aa385ccd.png)

现在您可以删除 base 和 c4-c5 分支

```
git branch -d base 
```

![在此处输入图像描述](../Images/e1ec5476c971c0b9993cbf544a0a00ec.png)

```
git branch -D c4-c5branch 
```

![在此处输入图像描述](../Images/65a4024183cedbddccfb8857f16e0e60.png)

请记住，“初始提交”是一个没有文件的空提交，所以不要上当。C5 提交实际上是第一个基于内容的提交。

# gtk - Gtk 树视图问题

> ID：10081309
> 
> 赞同：0
> 
> 时间：2012-04-09T23:48:01.080
> 
> 标签：gtk, gtk#, gtktreeview

我有一个简单的树视图（就像这个 - [http://www.mono-project.com/GtkSharp_TreeView_Tutorial](http://www.mono-project.com/GtkSharp_TreeView_Tutorial)），里面有 200 个项目并连接到滚动条。一切正常，但是当我选择一个项目并使用箭头键时，所选项目可能不在可见区域内。是否可以专注于它或设置滚动条的调整，即

```
void HandleTreeSelectionChanged (object sender, EventArgs e)
{
    vadjustment.Value=SELECTED-ITEM.DISTANCE-FROM-TOP-OF-TREEVIEW;
} 
```

还有一个问题：如何为表格绘制黑色边框（这个 tree.EnableGridLines = TreeViewGridLines.Both; 就在网格内部）。提前致谢。马泰

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T12:06:57.940

我同意[Johannes 的回答](https://stackoverflow.com/a/10087106/28169)，你似乎在做一些奇怪的事情，你真的应该只需要使用 GtkScrolledWindow。它也应该处理键盘导航（您似乎在对约翰内斯的回答的评论中描述的内容），这不是您应该手动执行的操作。

无论如何尝试回答您的问题，您可以使树视图滚动到任何给定的单元格使用`[gtk_tree_view_scroll_to_cell()](http://developer.gnome.org/gtk3/stable/GtkTreeView.html#gtk-tree-view-scroll-to-cell)`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T10:33:44.770

要将滚动条添加到树视图（或文本视图），只需将其添加到[GtkScrolledWindow](http://developer.gnome.org/gtk3/unstable/GtkScrolledWindow.html)；它会自动处理所有事情。我很确定它还在大多数主题中创建了一个边框。

**更新：**或者，您还可以通过将滚动条的调整设置为树视图的调整，将树视图的滚动行为“绑定”到任意滚动条：

`scrollbar = gtk.VScrollbar(treeview.props.vadjustment)`

（哦，这就是 PyGTK 语法；在 Gtk# 中可能是`treeview.VAdjustment`.）

# php - 带变量的 PHP 下载链接

> ID：10081313
> 
> 赞同：0
> 
> 时间：2012-04-09T23:48:23.547
> 
> 标签：php, variables, post, hyperlink, download

好的，所以我正在尝试在我的网站上创建一个下载链接生成器。我的意思是这样的：

1.  *   用户写入“列表 X”，站点列出给定目录中的每个文件
2.  *   每个文件都有一个数字（从 0 到 n）
3.  *   当用户键入：例如“下载 5”
4.  *   它将用户重定向到下载脚本
5.  *   该脚本使用户可以弹出一个下载“框”

我首先想到我可以用每个文件名创建一个数组，然后将该数组中的位置用于“下载 X”命令。

因此，当他将用户重定向到下载脚本时，具有用户想要下载的文件名称的变量被“POST”到下载脚本，并且标题随之改变。

所以这是我的两个问题：

1) - 你如何根据用户输入更改下载脚本？2) - 输入字段已用于“$_SERVER['PHP_SELF']”的其他目的，所以我不知道如何在没有表单的情况下“发布”变量？

这是我的简单下载脚本：

```
<?php
header('Content-disposition: attachment; filename=huge_document.pdf');
header('Content-type: application/pdf');
readfile('huge_document.pdf');
?> 
```

提前致谢 ！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T23:52:18.443

不要让他们输入任何内容。让每个下载都成为他们点击的链接。在链接的 URL 中，您将有一个带有下载唯一标识符的查询字符串。像这样的东西：

```
<a href="/path/to/downloadscript.php?id=5">Down file #6</a> 
```

`downloadscript.php`然后将从[`$_GET`超全局](http://us.php.net/manual/en/reserved.variables.get.php)获取 ID ，您可以从那里开始（使用示例中提到的数组）：

```
<?php
$download_id = (int) $_GET['id']; // 5
$files = array(
    file1.pdf,
    file2.pdf,
    file3.pdf,
    file4.pdf,
    file5.pdf,
    file6.pdf  // This is the file they'll get
);

$filename = $files[$download_id];

// get the file name from your array or database
header('Content-disposition: attachment; ' . filename=$filename);
header('Content-type: application/pdf');
readfile($filename);
?> 
```

# haskell - 在 Haskell 中解压 GZip

> ID：10081315
> 
> 赞同：6
> 
> 时间：2012-04-09T23:48:33.637
> 
> 标签：haskell

我很难弄清楚这一点。这是我正在尝试的：

```
ghci> :m +System.FileArchive.GZip  -- From the "MissingH" package
ghci> fmap decompress $ readFile "test.html.gz"
*** Exception: test.html.gz: hGetContents: invalid argument (invalid byte sequence) 
```

为什么我得到那个例外？

`Codec.Compression.GZip.decompress`我也从[zlib 包](http://hackage.haskell.org/package/zlib-0.5.3.3)中尝试过，但我无法得到要解决的类型，`String`而不是`ByteString`.

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-10T01:15:42.053

从`ByteString`to的转换`String`取决于压缩文件的字符编码，但假设它是 ASCII 或 Latin-1，这应该有效：

```
import Codec.Compression.GZip (decompress)
import qualified Data.ByteString.Lazy as LBS
import Data.ByteString.Lazy.Char8 (unpack)

readGZipFile :: FilePath -> IO String
readGZipFile path = fmap (unpack . decompress) $ LBS.readFile path 
```

如果您需要使用其他编码（如 UTF-8），请替换`unpack`为适当的解码函数，例如[`Data.ByteString.Lazy.UTF8.toString`](http://hackage.haskell.org/packages/archive/utf8-string/latest/doc/html/Data-ByteString-Lazy-UTF8.html#v%3atoString).

当然，如果你解压的文件不是文本文件，最好还是保存为`ByteString`.

# javascript - JSP 无法与 PrintWriter 一起正常工作

> ID：10081317
> 
> 赞同：0
> 
> 时间：2012-04-09T23:49:17.317
> 
> 标签：javascript, jsp, dom-events, jsp-tags

我目前有两个文件，register.html 和 register.jsp。HTML 文件要求用户提供一些信息，而 JSP 文件应该将信息写入文本文件。我不断收到文件错误，特别是在该`PrintWriter`部分中。任何帮助将非常感激。

这是我得到的错误：

```
An error occurred at line: 14 in the jsp file: /register.jsp
Duplicate local variable pw
11: 
12: try {   
13: 
14:     PrintWriter pw=null;
15:    pw = new PrintWriter(new FileWriter(new File(nameOfTextFile), true));  
16:    // PrintWriter pw = new PrintWriter(new FileOutputStream(nameOfTextFile));
17: 
```

注册.html：

```
<%@ page import="java.io.*, java.util.Date"  %>
<DOCTYPE! html>
<HTML>
<HEAD>
<TITLE>Registration</TITLE>
</HEAD>
<BODY>
<h1>Enter the following information to sign and create an account in the Book.</h1>
<form name=registrationForm action="register.jsp">
    <table border=0>
        <tr><td align=right>Username:</td>
        <td><input type=text name="Username" size=25></td>
    </tr>
    <tr><td align=right>Password:</td>
        <td><input type=text name="password" size=25></td>
    </tr>
    <tr><td align=right>Email address:</td>
        <td><input type=text name="email" size=25></td>
    </tr>
    <tr>
    <!--<td valign=middle align=right>Comments:</td>
    <td><TextArea rows=5 cols=35 name="comments">none</TextArea>
    </td>-->
    </tr>
</table>
<br>
<input type="submit" value="Register" name="button" onClick="validatingForm()">
<input type=reset value="Start Over">
</form>
</BODY>
</HTML> 
```

注册.jsp：

```
<%@ page import="java.io.* , java.util.Date"  %>
<HEAD>Thanks for registering!</TITLE></HEAD>
<BODY>
<%
String un =request.getParameter("Username");
String pw =request.getParameter("password");
String nameOfTextFile = "/xampp/tomcat/webapps/gb/userss.txt"; //directory path and name of file
try {   
PrintWriter pw=null;
   pw = new PrintWriter(new FileWriter(new File(nameOfTextFile), true));  
   // PrintWriter pw = new PrintWriter(new FileOutputStream(nameOfTextFile));
    pw.println(un);
    pw.println(pw);
    pw.close();
    } catch(IOException e) {
   out.println(e.getMessage());
}
%>
</BODY>
 </HTML> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T00:07:18.603

正如其他人所说，您应该将此代码移动到 java 类中。话虽如此，我相信您的问题是您定义了两个名为 pw 的变量。

```
String un =request.getParameter("Username");
String pw =request.getParameter("password"); //FIRST DECLARATION OF PW
String nameOfTextFile = "/xampp/tomcat/webapps/gb/userss.txt"; //directory path and name of file
try {   
PrintWriter pw=null; //SECOND DECLARATION OF PW causes error
   pw = new PrintWriter(new FileWriter(new File(nameOfTextFile), true));  
   // PrintWriter pw = new PrintWriter(new FileOutputStream(nameOfTextFile));
    pw.println(un);
    pw.println(pw);
    pw.close();
    } catch(IOException e) {
   out.println(e.getMessage());
} 
```

尝试：

```
String un =request.getParameter("Username");
String pw =request.getParameter("password");
String nameOfTextFile = "/xampp/tomcat/webapps/gb/userss.txt"; //directory path and name of file
try {   
PrintWriter printWriter=null;
   printWriter = new PrintWriter(new FileWriter(new File(nameOfTextFile), true));  
   // PrintWriter pw = new PrintWriter(new FileOutputStream(nameOfTextFile));
    printWriter.println(un);
    printWriter.println(pw);
    printWriter.close();
    } catch(IOException e) {
   out.println(e.getMessage());
} 
```

# python - 使用 Python 3 从 Twitter API 检索请求令牌

> ID：10081327
> 
> 赞同：2
> 
> 时间：2012-04-09T23:51:01.703
> 
> 标签：python, oauth, twitter, twitter-oauth

我正在尝试使用 Python 3 与 Twitter API 交互，以返回一个页面的链接，该链接为我提供了一个用于请求访问令牌的 pin 号。如此处详述：[https ://dev.twitter.com/docs/auth/pin-based-authorization](https://dev.twitter.com/docs/auth/pin-based-authorization)

Twitter 的 API 回复我，告诉我我没有通过返回 401 正确授权我的 POST 请求。我最好的猜测是为什么我没有正确编码 base64 中的 HMAC 签名。根据我查看的正确 POST 请求示例，我生成的 POST 请求的所有其他部分看起来都是正确的。

我花了几天的时间来做这件事，我希望有人能帮助我完成最后一部分。

以下是 Twitter API 文档中最相关的部分：[https ://dev.twitter.com/docs/api/1/post/oauth/request_token](https://dev.twitter.com/docs/api/1/post/oauth/request_token)

[https://dev.twitter.com/docs/auth/authorizing-request](https://dev.twitter.com/docs/auth/authorizing-request)

这是我正在使用的代码：

```
import urllib.parse, urllib.request, json
from hashlib import sha1
import hmac
import binascii
import time
import random
import sys

#Server Links
REQUEST_URL = "https://api.twitter.com/oauth/request_token";
ACCESS_URL = "https://api.twitter.com/oauth/access_token";
AUTHORIZE_URL = "https://api.twitter.com/oauth/authorize";

#Consumer keys
TOKEN = "Omitted"
TOKEN_SECRET = "Omitted"

#Access keys
ACCESS_TOKEN = ""
ACCESS_TOKEN_SECRET = ""

TWEET = ""

count = 1

while len(sys.argv) > count:
    TWEET += sys.argv[count] + " "
    count += 1

TWEET = TWEET[:-1] #Get rid of trailing space

print(TWEET + "\n")

#Build content header for POST to return request tokens

HEADER_TITLE = "Authorization:"

#Consumer key
HEADER = 'OAuth oauth_callback="oob" oauth_consumer_key="' + TOKEN + '", '

#Nonce
HEADER += 'oauth_nonce="'
NONCE = ""
for i in range(32):
    NONCE += chr(random.randint(97, 122))
HEADER += NONCE
HEADER += '", '

#Timestamp
TIMESTAMP = str(int(time.time()))

#Signature
HEADER += 'oauth_signature="'
PARAMETER_STRING = "include_entities=true&oauth_consumer_key=" + TOKEN + "&oauth_nonce=" + NONCE + "&oauth_signature_method=HMAC-SHA1&oauth_timestamp=" + TIMESTAMP + "&oauth_version=1.0"
BASE_STRING = 'POST&' + urllib.parse.quote(REQUEST_URL, '') + '&' + urllib.parse.quote(PARAMETER_STRING, '')
SIGNING_KEY = urllib.parse.quote(TOKEN_SECRET, '') + '&'
print("DEBUG : SIGNING KEY " + SIGNING_KEY + " BASE STRING " + BASE_STRING + "\n")
HEADER += str(binascii.b2a_base64(hmac.new(BASE_STRING.encode(), SIGNING_KEY.encode(), sha1).digest()[:-1]))#Note to self, we may not want to remove the last character...
HEADER += '", '

#Signature Method
HEADER += 'oauth_signature_method="HMAC-SHA1", '

#Timestamp
HEADER += 'oauth_timestamp="' + TIMESTAMP + '", '

#Version
HEADER += 'oauth_version="1.0"'

print(HEADER_TITLE + "\n" + HEADER)

print(urllib.request.urlopen(urllib.request.Request(REQUEST_URL, bytes(HEADER_TITLE+HEADER, 'utf-8'))).read()) 
```

最后，我想指出，我知道 Python OAuth 和 Twitter 模块的存在，这有助于开发。但是，作为学习经验，我选择不使用它们。

非常感谢您的时间和帮助。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-15T16:30:38.660

我所做更改的概述：

1.  我换`binascii.b2a_base64`了`base64.standard_b64encode`
2.  我使用该`bytes.decode('ascii')`方法将字节转换为字符串。str() 似乎将 b 附加到字符串中。
3.  我将参数的顺序固定为`hmac.new`- 它是`KEY, MESSAGE`，不是`MESSAGE, KEY`
4.  我删除了对`include_entities`in的引用`PARAMETER_STRING`- 如果您不在请求中使用 include_entities（并且我认为这对令牌请求没有意义），则它不能包含在 PARAMETER_STRING
5.  我`oauth_callback=oob`在开头添加了`PARAMETER_STRING`- 除了 oauth_signature 之外的所有 oauth 参数都必须包含在基本字符串中。
6.  我更改了发出请求的部分以预先创建 Request 对象，然后添加 Authorization 标头 - 您将 Authorization 标头作为 HTTP 正文发送。
7.  为了匹配此更改，我从`HEADER_TITLE`.
8.  我在 之后添加了缺少的分号`oauth_callback="oob"`。

享受！

这是您的代码的固定版本：

```
import urllib.parse, urllib.request, json
from hashlib import sha1
import hmac
import base64
import time
import random
import sys

#Server Links
REQUEST_URL = "https://api.twitter.com/oauth/request_token";
ACCESS_URL = "https://api.twitter.com/oauth/access_token";
AUTHORIZE_URL = "https://api.twitter.com/oauth/authorize";

#Consumer keys
TOKEN = "Omitted"
TOKEN_SECRET = "Omitted"

#Access keys
ACCESS_TOKEN = ""
ACCESS_TOKEN_SECRET = ""

TWEET = ""

count = 1

while len(sys.argv) > count:
TWEET += sys.argv[count] + " "
count += 1

TWEET = TWEET[:-1] #Get rid of trailing space

print(TWEET + "\n")

#Build content header for POST to return request tokens

HEADER_TITLE = "Authorization"

#Consumer key
HEADER = 'OAuth oauth_callback="oob", oauth_consumer_key="' + TOKEN + '", '

#Nonce
HEADER += 'oauth_nonce="'
NONCE = ""
for i in range(32):
NONCE += chr(random.randint(97, 122))
HEADER += NONCE
HEADER += '", '

#Timestamp
TIMESTAMP = str(int(time.time()))

#Signature
HEADER += 'oauth_signature="'
PARAMETER_STRING = "oauth_callback=oob&oauth_consumer_key=" + TOKEN + "&oauth_nonce=" + NONCE + "&oauth_signature_method=HMAC-SHA1&oauth_timestamp=" + TIMESTAMP + "&oauth_version=1.0"
BASE_STRING = 'POST&' + urllib.parse.quote(REQUEST_URL, '') + '&' + urllib.parse.quote(PARAMETER_STRING, '')
SIGNING_KEY = urllib.parse.quote(TOKEN_SECRET, '') + '&'
print("DEBUG : SIGNING KEY " + SIGNING_KEY + " BASE STRING " + BASE_STRING + "\n")
HEADER += urllib.parse.quote(base64.standard_b64encode(hmac.new(SIGNING_KEY.encode(), BASE_STRING.encode(), sha1).digest()).decode('ascii'))
HEADER += '", '

#Signature Method
HEADER += 'oauth_signature_method="HMAC-SHA1", '

#Timestamp
HEADER += 'oauth_timestamp="' + TIMESTAMP + '", '

#Version
HEADER += 'oauth_version="1.0"'

print(HEADER_TITLE + ":\n" + HEADER)

HTTP_REQUEST = urllib.request.Request(REQUEST_URL)
HTTP_REQUEST.add_header(HEADER_TITLE, HEADER)
print(urllib.request.urlopen(HTTP_REQUEST, bytes('', 'ascii')).read()) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T11:30:33.357

看起来您的签名基本字符串不正确。基本上，据我所知，您没有在基本字符串中包含任何参数。

[引用](https://dev.twitter.com/docs/auth/creating-signature)关于签名基础字符串主题的 twitter 文档：

> 1.  将 HTTP 方法转换为大写，并将输出字符串设置为该值。
> 2.  将“&”字符附加到输出字符串。
> 3.  百分比编码 URL 并将其附加到输出字符串。
> 4.  将“&”字符附加到输出字符串。
> 5.  百分比编码参数字符串并将其附加到输出字符串。

参数字符串依次是这样制作的：（我正在引用）：

> 1.  百分比编码每个将被签名的键和值。
> 2.  按编码键的字母顺序对参数列表进行排序。
> 3.  对于每个键/值对：
> 4.  将编码的密钥附加到输出字符串。
> 5.  将“=”字符附加到输出字符串。
> 6.  将编码值附加到输出字符串。
> 7.  如果还有更多的键/值对，则在输出字符串中附加一个 '&' 字符。

# javascript - 我如何从 codecademy 到实际编程？包含的具体示例

> ID：10081328
> 
> 赞同：2
> 
> 时间：2012-04-09T23:51:15.160
> 
> 标签：javascript

所以我最近花了很多时间在 codecademy 上，这太棒了。我觉得我开始真正掌握 JavaScript 和一般编程。但是，我想开始使用我的新技能的基础知识。我确信我不是唯一一个有这种愿望的人，虽然我收到了一些书（针对 jQuery、Ajax 和 Ruby），但我认为 Stack Overflow 可能是一个不错的起点。

例如，假设我想使用下面我刚刚编写的代码（或类似代码）来计算某人的 BMI 并为他们解释它。它提示他们输入他们的体重和身高，然后计算他们的 BMI。

该代码在 codecademy 便笺簿中工作，但我不知道如何将此代码用于现实世界。我感觉这与创建 HTML 表单并将输入名称作为变量有关，但我不确定。

如果这不是提问的正确地方，我很抱歉，这是我在 Stack Overflow 上的第一个问题！

```
var weight = prompt("How much do you weigh, in pounds?");
var height = prompt("How tall are you, in inches?");
var BMI = (weight*703)/(height*height);
console.log("You have a BMI of " + Math.floor(BMI));
if (BMI<=15){
    console.log("You are very severly underweight!");
}else if (BMI<16 && BMI>=15){
    console.log("You are severly underweight!");
}else if (BMI<19 && BMI>=16){
    console.log("You are underweight");
}else if (BMI<25 && BMI>=19){
    console.log("You are healthy!");
}else if(BMI<30 && BMI >=25){
    console.log("You are overweight" );
}else if(BMI<35 && BMI >=30){
console.log("You are moderately obese!");
}else{
    console.log("lose weight fatty!");
} 
```

# python - 在 Python 中导入/运行类会导致 NameError

> ID：10081335
> 
> 赞同：0
> 
> 时间：2012-04-09T23:52:22.247
> 
> 标签：python, class, import, nameerror

我有一个 python 程序，我正在尝试导入其他 python 类，我得到一个 NameError：

```
Traceback (most recent call last):
  File "run.py", line 3, in <module>
    f = wow('fgd')
NameError: name 'wow' is not defined 
```

这是在名为的文件中`new.py`：

```
class wow(object):
    def __init__(self, start):
        self.start = start

    def go(self):
        print "test test test"
        f = raw_input("> ") 
        if f == "test":
            print "!!"  
            return c.vov()  
        else:
            print "nope"    
            return f.go()

class joj(object):
    def __init__(self, start):
        self.start = start
    def vov(self):
       print " !!!!! " 
```

这是在文件中`run.py`：

```
from new import *

f = wow('fgd')
c = joj('fds')
f.go() 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T00:01:02.497

你不能这样做，就像`f`在不同的命名空间中一样。

您需要传递您的`wow`实例`joj`。为此，我们首先以相反的方式创建它们，因此存在 c 以传递给 f：

```
from new import *

c = joj('fds')
f = wow('fgd', c)
f.go() 
```

然后我们将参数添加`c`到`wow`，将引用存储为`self.c`并使用`self`而不是此命名空间中不存在的`f`as - 您引用的对象现在是 self：`f`

```
class wow(object):
    def __init__(self, start, c):
        self.start = start
        self.c = c

    def go(self):
        print "test test test"
        f = raw_input("> ") 
        if f == "test":
            print "!!"  
            return self.c.vov()  
        else:
            print "nope"    
            return self.go()

class joj(object):
    def __init__(self, start):
        self.start = start
    def vov(self):
       print " !!!!! " 
```

将每个类和函数视为一个新的开始，您在其他地方定义的变量都不属于它们。

# android - Android 访问活动之外的资源

> ID：10081339
> 
> 赞同：4
> 
> 时间：2012-04-09T23:52:55.660
> 
> 标签：android, android-activity, android-resources

我想知道 - 有没有办法在 Activity 之外访问 android 资源和/或资产文件（或任何其他文件夹中的文件）（*不传递上下文*）？

没有上下文无法访问：

```
getResources().getIdentifier("resource_name", "drawable", getPackageName());
getAssets().open("file_in_assets_folder_name"); 
```

如果不在活动中，则抛出异常：

```
try {
    Class class = R.drawable.class;
    Field field = class.getField("resource_name");
    Integer i = new Integer(field.getInt(null));
} catch (Exception e) {} 
```

还尝试了以下方法，但它抱怨文件不存在（这里做错了什么？）：

```
URL url = new URL("file:///android_asset/file_name.ext");
InputSource source = new InputSource(url.openStream());
//exception looks like so 04-10 00:40:43.382: W/System.err(5547): java.io.FileNotFoundException: /android_asset/InfoItems.xml (No such file or directory) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-10T00:25:38.737

如果文件夹包含在项目构建路径中，您可以在 android.content.Context 之外使用[ClassLoader](http://docs.oracle.com/javase/6/docs/api/java/lang/ClassLoader.html)访问它们下的文件，例如，从 POJO（如果您不想传递 android.content 的引用） 。语境）：

```
String file = "res/raw/test.txt";
InputStream in = this.getClass().getClassLoader().getResourceAsStream(file); 
```

*   到目前为止，所有 Android SDK 版本都默认将 res 文件夹包含在 Project Build Path 中。
*   在 Android SDK r14 之前，assets 文件夹默认包含在项目构建路径中。

要将文件夹添加到项目构建路径中，请右键单击您的项目 - 构建路径 - 配置构建路径，将您的文件夹（例如，如果使用更高版本的 SDK 版本的资产）添加为构建路径中的 Source 文件夹。

[在这里](https://stackoverflow.com/questions/9855197/is-it-possible-to-read-a-raw-text-file-without-context-reference-in-an-android-l/9855725#9855725)查看我之前回答的类似问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-09-03T18:41:42.063

Android 框架在编译您的应用程序时创建静态类调用：

```
your.namespace.project.R 
```

你可以像这样静态调用这个类：

```
your.namespace.project.R.string.my_prop

this.context.findViewById(your.namespace.project.R.id.my_id_prop); 
```

* * *

也许您可以通过这种方式访问​​动态资源：

```
Resources res = this.context.getResources();
int id = res.getIdentifier("bar"+Integer.toString(i+1), "id", this.context.getPackageName()); 
```

# ruby-on-rails - 非常卡在“无路由匹配错误”上

> ID：10081346
> 
> 赞同：2
> 
> 时间：2012-04-09T23:53:35.800
> 
> 标签：ruby-on-rails

我是 Ruby on Rails 的新手，不断收到以下错误消息：

```
ActionController::RoutingError in Users#index 

"No route matches {:action=>"following", :controller=>"users"}"

Showing /app/views/layouts/_navbar.html.erb......where line #19 raised:

Extracted source (around line #19):
16: </td>
17:                 </div>
18:        
19:                 <div id="secondlink"><td class="rite"><li><% if signed_in? %><%= link_to "Profile", current_user %></li><li><%= link_to "watching", following_user_path(@user)%></li><li><%= link_to "Users", users_path %></li><li><%= link_to "Sign out", signout_path, :method => :delete %>
20:       <% else %>
21: <%= link_to "Sign in", signin_path %></li><% end %>
22: 
```

当我单击链接（在我的导航栏中）以显示分页用户的完整列表时，会发生此路由错误”

我的 routes.rb 文件中包含以下内容：

```
 Mvp::Application.routes.draw do
   resources :users do
    member do
      get :following, :followers
    end
   end 
```

UsersController 中的“以下”操作：

```
def following
    @title = "Following"
    @user = User.find(params[:id])
    @users = @user.following.paginate(:page => params[:page])
    render 'show_follow'
end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T00:35:37.017

我不能肯定地说，但我的第一个猜测是在下面

```
<%= link_to "watching", following_user_path(@user)%> 
```

变量`@user`为零。我不知道为什么它是 nil，但如果它是 nil，这就是你会得到的错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T00:01:10.707

`rake routes`输出_

```
following_user GET    /users/:id/following(.:format) users#following
followers_user GET    /users/:id/followers(.:format) users#followers
         users GET    /users(.:format)               users#index
               POST   /users(.:format)               users#create
      new_user GET    /users/new(.:format)           users#new
     edit_user GET    /users/:id/edit(.:format)      users#edit
          user GET    /users/:id(.:format)           users#show
               PUT    /users/:id(.:format)           users#update
               DELETE /users/:id(.:format)           users#destroy 
```

所以你得到了你的路由 - 定义了控制器映射。

接下来要检查的事项：

*   你有你定义的`following`动作吗`UsersController`

*   `GET`您是否使用方法请求服务器响应

# java - 在 JBoss As 7 下更改 Web 应用程序的上下文根目录

> ID：10081347
> 
> 赞同：23
> 
> 时间：2012-04-09T23:53:50.073
> 
> 标签：java, web-applications, jboss

我想将上下文根从“/war_name”（默认）更改为“/”。

因此，我创建了一个 jboss-web.xml 文件，并将其推送到 WEB-INF 目录中。

该文件的内容是：

```
<?xml version="1.0" encoding="UTF-8"?>
<jboss-web>
    <context-root>/</context-root>
</jboss-web> 
```

不幸的是，这会在战争部署期间导致以下错误：

```
ERROR [org.jboss.msc.service.fail] (MSC service thread 1-4) MSC00001: Failed to start service jboss.web.deployment.default-host./: org.jboss.msc.service.StartException in service jboss.web.deployment.default-host./: Failed to start service
    at org.jboss.msc.service.ServiceControllerImpl$StartTask.run(ServiceControllerImpl.java:1780) [jboss-msc-1.0.1.GA.jar:1.0.1.GA]
    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110) [:1.7.0_01]
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603) [:1.7.0_01]
    at java.lang.Thread.run(Thread.java:722) [:1.7.0_01]
Caused by: java.lang.IllegalArgumentException: Child container with name  already exists
    at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:804)
    at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:792) 
```

但是，当我输入一些目录名称时，例如：/RoomManagement，我没有这个问题。但是如果我使用这个，我就无法访问不在/RoomManagement 中的JSP。

您是否有将上下文根配置为 "/" 的想法？

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2012-04-09T23:56:22.897

看起来有另一个应用程序在根上下文“/”处运行。

您可能必须先删除其他应用程序或将其移动到不同的上下文，然后才能将您的应用程序分配到根上下文。

如果冲突的应用程序是 JBoss AppServer 根本身，您可以使用以下命令禁用它（**enable-welcome-root="false"**）

```
<subsystem xmlns="urn:jboss:domain:web:1.0">
  <connector name="http" protocol="HTTP/1.1" socket-binding="http" scheme="http"/>
  <virtual-server name="localhost" enable-welcome-root="false">
    <alias name="example.com"/>
  </virtual-server>
</subsystem> 
```

# couchdb - 带有值数组的 CouchDB reduce 函数

> ID：10081353
> 
> 赞同：3
> 
> 时间：2012-04-09T23:55:46.347
> 
> 标签：couchdb, mapreduce

我有一个 map 函数，它以数组的形式返回一个值：

```
emit(doc.created_date, { calories : doc.calories, miles : doc.miles, minutes : doc.minutes, reps : doc.reps, steps : doc.steps, water : doc.water }) 
```

我想对所有返回值的卡路里、英里、分钟和步数进行总和。喜欢

```
return {"calories":t_cal,"miles":t_mil, "minutes":t_min,"steps":t_step}; 
```

我已经尝试了沙发维基和其他网站的几个示例，但我不知道如何访问值数组。

`reduce_overflow_error`当我尝试在运行 for 循环时将值或 null 相加时，我得到了：

```
for(var i in values) { t_mil = t_mil + values[i].miles } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-10T03:50:08.503

我经常做你正在做的事情，所以这是可能的。

要么您的对象*有点*超出 CouchDB 的限制，要么您的代码中存在错误。

您可以设置 CouchDB 配置，`query_server_config/reduce_limit = "false"`并查看它的外观。

但是，如果您仅累积四个项目，我认为这不是减少限制的问题。我总是遇到 JavaScript 问题。例如，将数字添加到字符串会生成（更长的）字符串。添加更多的数字会使字符串越来越长。

```
var old_value = "3" // This is a bad value, perhaps from a map function bug
var new_value = 5

new_value = new_value + old_value // I wanted 8, but I got "53"
new_value = new_value + 2012 // I wanted 2020 but I got "532012" 
```

数组和其他类型也会出现类似问题。

您有一个良好的开始，该`map`函数发出返回的相同内容`reduce`（一个对象）。也许您可以发布一些您正在使用的代码。我通常会这样做：

```
function(keys, vals, rereduce) {
  // reduce function
  var result = {'calories':0, 'miles':0, 'minutes':0, 'steps':0}

  for(var i = 0; i < vals.length; i++) {
    result.calories += vals[i].calories || 0
    result.miles    += vals[i].miles    || 0
    result.minutes  += vals[i].minutes  || 0
    result.steps    += vals[i].steps    || 0
  }

  return result
} 
```

请注意，reduce 输出与 map 输出完全相同，因此此代码适用于 reduce 和 re-reduce。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2017-10-19T16:19:10.477

您可以在没有 JS reduce 的情况下以一种优雅而快速的方式完成它。让你的 map 函数发出一个数组，比如`emit(doc.created_date, [doc.calories, doc.miles, doc.minutes, doc.reps, doc.steps, doc.water])`，然后使用内置的`_sum`reduce。

结果将是一个按列求和的数组。不为人所知，但 CouchDB 的非常有用的功能。

# jquery-mobile - 如何让 cordova/phonegap.js 将 jquery 移动 index.html 编译到本机智能手机应用程序中

> ID：10081356
> 
> 赞同：0
> 
> 时间：2012-04-09T23:56:18.860
> 
> 标签：jquery-mobile, cordova

我有点困惑，只是想确保我做的一切都是正确的。我开发了一个 index.html，它使用 jquery mobile 通过 AJAX 加载内容。因此，当我单击链接或提交表单时，jquery 会捕获事件并通过 AJAX 处理它们。但是，当我将其上传到 phonegap 网站时，等待几秒钟将其转换为应用程序，并将 android 应用程序加载到虚拟 android 模拟器中，它大部分工作正常，但有些东西仍然坏了。例如，所有表单提交都重新加载页面，而不是执行 AJAX（尽管公共链接工作正常）。我也没有设法让 navigator.notification.alert() 工作。

阅读手册后，我注意到 phonegap 指的是他们在 index.html 示例中包含的一些 phonegap/cordova.js 库，但是没有下载链接。这是什么库？这是无关紧要的，还是它实际上是消除 jquery mobile 之间差异的界面（修复诸如不工作的 AJAX 之类的问题）并提供额外的功能，如 navigator.notification.alert()？如果是的话，我该如何下载它？我想我需要下载一些 SDK，安装它，然后获取 js lib，但这听起来很可疑。我的意思是为什么我需要安装所有这些只是为了获得一个包含在 index.html 中的 JS 文件？最后，如果以上所有都是真的，当我得到那个 JS 库时，它是否会成为所有设备的单个库，并且 phonegap 本身会在为 iphone、android 构建时对其进行变形，

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T01:52:29.300

我建议你看看鼓掌。他们有一个很棒的 phonegap 和 JQM(jQuery Mobile) 模板/演示。它也是开始使用 phonegap/jqm 开发的一个非常有用的工具。我从中学到了很多。 [http://applaudcloud.com](http://applaudcloud.com)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T15:34:30.560

终于设法解决了这个问题。如果有人偶然发现这个线程：

*   JS lib 像这样包含在内

    ```
    <script type="text/javascript" src="cordova.js"></script> 
    ```

    phonegap 的在线构建工具将在其位置动态插入适当的文件并使用它进行构建。

*   AJAX 表单未提交是一个 jQuery Mobile 错误 [https://github.com/adrianpike/jquery-mobile/commit/88754ac1643a133686b72520d24e32524a737452](https://github.com/adrianpike/jquery-mobile/commit/88754ac1643a133686b72520d24e32524a737452)

# css - SVG 标签的 dur 属性没有动画

> ID：10081361
> 
> 赞同：1
> 
> 时间：2012-04-09T23:57:07.547
> 
> 标签：css, svg, w3c

我正在尝试使用 SVG`<set>`标签为翻转设置动画，但即使我指定了 dur="1s"，过渡也是瞬时的（在 Firefox、Safari、Opera 和 Chrome 中）。

```
<html>
<body>

<svg xmlns="http://www.w3.org/2000/svg" version="1.1">
    <circle cx="100" cy="50" r="40" stroke="black" stroke-width="2" fill="red">
        <set attributeType="CSS" attributeName="fill" to="green" begin="mouseover" end="mouseout" dur="1s" />
    </circle>
</svg> 

</body>
</html> 
```

我可以使用两个`<animate>`标签来实现我想要的效果，但我希望能够将过渡应用于可能具有不同初始颜色的多个元素，我希望保留这些元素（此方法要求我在第二个动画标签）。

```
<html>
<body>

<svg xmlns="http://www.w3.org/2000/svg" version="1.1">
    <circle cx="100" cy="50" r="40" stroke="black" stroke-width="2" fill="red">
        <animate attributeType="CSS" attributeName="fill" to="green" begin="mouseover" dur="1s" fill="freeze" />
        <animate attributeType="CSS" attributeName="fill" to="red" begin="mouseout" dur="1s" fill="freeze"/>
    </circle>
</svg> 

</body>
</html> 
```

第`<set>`一个代码段中的标记保留了初始颜色，但过渡没有动画。如果我对 w3 规范的理解是正确的，那应该是 - 这看起来像是特定于浏览器的错误，还是我误解了 w3 规范？有没有更好的方法来解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-10T04:05:40.083

如[SVG 1.1 规范](http://www.w3.org/TR/SVG/animate.html#SetElement)中所述：

> 'set' 元素提供了一种简单的方法，可以**在指定的 duration 内****设置**属性的值。 …<br> 指定**'set' 元素持续期间的**属性值。 **`to = "<value>"`**

 ****（强调我的。）

如您所见，`duration`元素`<set>`的 不是过渡时间，而是要应用效果的时间。如果删除该`end`属性，您将看到颜色从红色变为绿色 1 秒钟[，然后恢复](http://jsfiddle.net/4xx5p/1/)为原始值。

有关更多详细信息，请阅读[SMIL 规范](http://www.w3.org/TR/2001/REC-smil-animation-20010904/#setElement)`<set>`中的元素。

* * *

**编辑**`<animate>`：这是使用自定义数据注释 SVG 元素的示例，以及使用该数据根据元素填充创建所需元素的一次性脚本。[您可以在http://phrogz.net/svg/change-color-on-hover.svg](http://phrogz.net/svg/change-color-on-hover.svg)查看此示例

```
<svg xmlns="http://www.w3.org/2000/svg" xmlns:y="yasashiku" viewBox="0 0 240 150">
  <title>Change Color on Hover</title>
  <style>
    circle { stroke:black; stroke-width:2px }
    circle:not([fill]) { fill:purple }
  </style>
  <circle cx="50"  cy="50"  r="40" fill="red"    y:hoverAnimFillTo="blue"  y:hoverAnimDur="0.3s" />
  <circle cx="100" cy="100" r="40" fill="red"    y:hoverAnimFillTo="green" y:hoverAnimDur="1s" />
  <circle cx="150" cy="42"  r="40" fill="orange" y:hoverAnimFillTo="yellow" />
  <circle cx="200" cy="100" r="40"               y:hoverAnimFillTo="steelblue" />
  <script>
    var els = document.getElementsByTagName('*'),
        y   = 'yasashiku';
    for (var i=els.length;i--;){
      var fillColor = els[i].getAttributeNS(y,'hoverAnimFillTo');
      if (fillColor){
        var dur = els[i].getAttributeNS(y,'hoverAnimDur') || '0.1s';
        createOn(els[i],'animate',{
          begin:'mouseover',
          attributeType:'CSS', attributeName:'fill',
          to:fillColor,
          dur:dur, fill:'freeze'
        });
        createOn(els[i],'animate',{
          begin:'mouseout',
          attributeType:'CSS', attributeName:'fill',
          to:els[i].getAttribute('fill') || computedStyle(els[i],'fill'),
          dur:dur, fill:'freeze'
        });
      }
    }
    function createOn(el,name,attrs){
      var e = el.appendChild(document.createElementNS(el.namespaceURI,name));
      for (var name in attrs) e.setAttribute(name,attrs[name]);
      return e;
    }
    function computedStyle(el,name){
      return document.defaultView.getComputedStyle(el,null)[name];
    }
  </script>
</svg> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-11-12T09:35:01.430

使用“values”和“KeyTimes”属性？

```
<svg xmlns="http://www.w3.org/2000/svg" version="1.1">
  <circle cx="100" cy="50" r="40" stroke="black" stroke-width="2" fill="red">
    <animate attributeType="CSS" attributeName="fill" values="red;green;green;red" keyTimes="0;0.2;0.8;1" begin="mouseover" dur="2s" fill="freeze" />
    <animate attributeType="CSS" attributeName="fill" to="red" begin="mouseout" dur="1s" fill="freeze"/>
  </circle>
</svg> 
```****

# mysql - 连接两列值

> ID：10081365
> 
> 赞同：1
> 
> 时间：2012-04-09T23:57:57.290
> 
> 标签：mysql

我想在一个表上运行一个查询，我将一列的值与另一列连接起来。

类似于以下内容（javascripty 尝试）：

```
UPDATE table
SET items = items+","+item1
WHERE item1 != "No Data" || item1 != ""; 
```

这可以在数据库中执行还是我需要在中间件中执行？任何指针再次非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T00:01:16.500

看看[concat_ws](http://dev.mysql.com/doc/refman/5.5/en/string-functions.html#function_concat-ws)：

```
# Untested, but should work
UPDATE table
SET items = CONCAT_WS(',', items, item1)
WHERE item1 != "No Data" || item1 != ""; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T01:28:42.373

解决此问题的另一种方法：

```
UPDATE table
SET items = CONCAT(items,',',item1)
WHERE item1 != "No Data" OR item1 != ""; 
```

CONCAT() 和 CONCAT_WS() 函数（如上面 Mike 所述）之间的主要区别之一是它们对 NULL 值的处理。有关更多信息，请参阅 MySQL 参考手册的字符串函数部分：http: [//dev.mysql.com/doc/refman/5.6/en/string-functions.html](http://dev.mysql.com/doc/refman/5.6/en/string-functions.html)

使用“||”也可能存在一些问题 （管道）字符，如果 MySQL 服务器启用了 PIPES_AS_CONCAT 模式。以防万一，最好改成“OR”： [http ://dev.mysql.com/doc/refman/4.1/en/server-sql-mode.html#sqlmode_pipes_as_concat](http://dev.mysql.com/doc/refman/4.1/en/server-sql-mode.html#sqlmode_pipes_as_concat)

# java - 事务期间的选择查询导致未保存的瞬态异常

> ID：10081368
> 
> 赞同：0
> 
> 时间：2012-04-09T23:58:05.657
> 
> 标签：java, spring, hibernate, transactional

将 EJB3 JPA 与 Spring/Hibernate 和 Postgres 数据库一起使用。

我有一个循环，我在其中创建多个实体实例，并在一个（大）事务中使用 EntityManager 持久化这些实例。

我希望能够在此过程中执行 JPQL 选择查询，以查找要添加到这些实体的其他数据。但是，当我调用实例时，我得到`getResultList`了`Query`与我正在创建的实体相关的可怕的“未保存的瞬态”异常。

有什么方法可以让查询/休眠忽略未保存的瞬态而只进行选择查询？该查询与我正在创建的实体无关，所以我不知道它为什么抱怨。

执行查询的方法被标记`@Transactional(propagation=SUPPORTS, readOnly=true)`，因此查询应该在与创建实体相同的事务/会话中执行。

# javascript - 如何清除文件输入

> ID：10081369
> 
> 赞同：0
> 
> 时间：2012-04-09T23:58:16.623
> 
> 标签：javascript, jquery

如果您仔细查看此代码，它会为每个附加的行附加一个文件输入。现在，每个文件输入都有一个“清除文件”按钮，假设它可以删除文件输入中的任何内容。问题是它没有清除文件输入中的任何内容。为什么会这样，如何解决？

**JavaScript：**

```
var sourceImageForm; 

function insertQuestion(form) {   
    var $tbody = $('#qandatbl > tbody'); 
    var $tr = $("<tr class='optionAndAnswer' align='center'></tr>");
    var $image = $("<td class='image'></td>"); 

    var $fileImage = $("<form action='imageupload.php' method='post' enctype='multipart/form-data' target='upload_target' onsubmit='startImageUpload(this);' class='imageuploadform' >" + 
        "<p class='imagef1_upload_process' align='center'>Loading...<br/><img src='Images/loader.gif' /><br/></p><p class='imagef1_upload_form' align='center'><br/><label>" + 
        "Image File: <input name='fileImage' type='file' class='fileImage' /></label><br/><label class='imagelbl'>" + 
        "(jpg, jpeg, pjpeg, gif, png, tif)</label><br/><br/><label>" + 
        "<input type='submit' name='submitBtn' class='sbtn' value='Upload' /></label>" + 
        "<label><input type='button' name='imageClear' class='imageClear' value='Clear File'/></label>" +
        "</p> <iframe class='upload_target' name='upload_target' src='#' style='wclassth:0;height:0;border:0px;solclass #fff;'></iframe></form>");      

    $image.append($fileImage);
    $tr.append($image);  
    $tbody.append($tr); 

    $(".imageClear").click(function(event){
        event.preventDefault();
        $(this).parent().find(".fileImage").replaceWith("<input type='file' class='fileImage' name='fileImage' />");
    });

}

function startImageUpload(imageuploadform){
    $(imageuploadform).find('.imagef1_upload_process').css('visibility','visible');
    $(imageuploadform).find('.imagef1_upload_form').css('visibility','hidden');
    sourceImageForm = imageuploadform;
    return true;
}

function stopImageUpload(success){
    var result = '';
    if (success == 1) {
        result = '<span class="msg">The file was uploaded successfully!<\/span><br/><br/>';
    } else {
        result = '<span class="emsg">There was an error during file upload!<\/span><br/><br/>';
    }
    $(sourceImageForm).find('.imagef1_upload_process').css('visibility','hidden');
    $(sourceImageForm).find('.imagef1_upload_form').html(result + '<label>Image File: <input name="fileImage" type="file"/></label><br/><label>(jpg, jpeg, pjpeg, gif, png, tif)</label><br/><br/><label><input type="submit" name="submitBtn" class="sbtn" value="Upload" /></label><label><input type="button" name="imageClear" class="imageClear" value="Clear File"/></label>');
    $(sourceImageForm).find('.imagef1_upload_form').css('visibility','visible');     
    return true;   
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-07-07T11:07:43.140

我写了一个函数来清除文件输入。它适用于所有浏览器。

**演示：http:** [//jsbin.com/muhipoye/1/](http://jsbin.com/muhipoye/1/)

```
function clearInputFile(f){
    if(f.value){
        try{
            f.value = ''; //for IE11, latest Chrome/Firefox/Opera...
        }catch(err){
        }
        if(f.value){ //for IE5 ~ IE10
            var form = document.createElement('form'), ref = f.nextSibling;
            form.appendChild(f);
            form.reset();
            ref.parentNode.insertBefore(f,ref);
        }
    }
} 
```

对于您的代码，您应该修改如下：

```
 function clearInputFile(f){
        if(f.value){
            try{
                f.value = '';
            }catch(err){
            }
            if(f.value){
                var form = document.createElement('form'), ref = f.nextSibling;
                form.appendChild(f);
                form.reset();
                ref.parentNode.insertBefore(f,ref);
            }
        }
    }
    $(".imageClear").click(function(){
        clearInputFile($(this).closest('form').find('input[type="file"]')[0]);
    }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T00:31:29.017

您的一般策略似乎是合理的——通过用另一个输入元素替换文件类型的输入来“清除”它。我不知道为什么它不起作用，这是一个可以工作的简单 POJS 版本：

```
<form>
  <input type="file" name="fileName">
  <input type="button" onclick="clearFileName(this);" value="Clear file input">
</form>

<script type="text/javascript">

function clearFileName(el) {
  var input = el.form.fileName;
  input.parentNode.replaceChild(input.cloneNode(false), input);
}

</script> 
```

# c - C中的qsort段错误

> ID：10081370
> 
> 赞同：1
> 
> 时间：2012-04-09T23:58:17.477
> 
> 标签：c, segmentation-fault, qsort

我正在尝试根据手册页使用 qsort 但无论我尝试什么，我都会不断收到段错误

这是重要的代码部分

```
int compare_dirent(const void *a, const void *b)
{
    const struct dirent *first = (const struct dirent *) a;
    const struct dirent *second = (const struct dirent *) b;

    return first->d_ino - second->d_ino;
}

int process(FILE* output,const char *dirname, int flags)
{
    struct dirent *entries = NULL;
    struct dirent *table[256];
    int entry_num = 0;
    DIR *directory = NULL;
    char cwd[1024];

    getcwd(cwd,1024);
    bzero(table,256);

    directory = opendir(dirname);
    while((entries = readdir(directory))!=NULL)
    {
        if(entries->d_type == DT_REG)
        {
            fprintf(output,"%s\t\n",entries->d_name);
            table[entry_num] = entries;
            entry_num++;
        }
    }
    fprintf(stderr,"last entry: %s\n", table[entry_num-1]->d_name);

    /* RIGHT HERE */
    qsort(table, entry_num, sizeof(struct dirent), &compare_dirent);

    return entry_num;
} 
```

运行 gdb 时，我在 while 循环中看到目录中的文件列表，`fprintf`并看到最后一个条目。我在比较中放置了一个断点，该断点执行 N 次，其中 N 是文件数，然后我立即从 _qsort 获得一个 SEGFAULT。

在从 qsort 第 N 次调用 compare_dirent 时，它崩溃了。

这是gdb输出

```
Starting program: /Users/luke/Documents/Dev/code/cs647/prog2/bin/prog2 ./
Reading symbols for shared libraries +........................ done
.main.c.swp 
get_pdf.sh  
main.c  
main.o  
Makefile    
program2.pdf    
test.txt    
last entry: test.txt

Breakpoint 1, compare_dirent (a=0x7fff5fbff018, b=0x7fff5fbfec00) at main.c:88
88      const struct dirent *first = (const struct dirent *) a;
(gdb) n
89      const struct dirent *second = (const struct dirent *) b;
(gdb) n
91      return first->d_ino - second->d_ino;
(gdb) c
Continuing.

Breakpoint 1, compare_dirent (a=0x7fff5fbff430, b=0x7fff5fbfec00) at main.c:88
88      const struct dirent *first = (const struct dirent *) a;
(gdb) c
Continuing.

Breakpoint 1, compare_dirent (a=0x7fff5fbff848, b=0x7fff5fbfec00) at main.c:88
88      const struct dirent *first = (const struct dirent *) a;
(gdb) c
Continuing.

Breakpoint 1, compare_dirent (a=0x7fff5fbffc60, b=0x7fff5fbfec00) at main.c:88
88      const struct dirent *first = (const struct dirent *) a;
(gdb) c
Continuing.

Breakpoint 1, compare_dirent (a=0x7fff5fc00078, b=0x7fff5fbfec00) at main.c:88
88      const struct dirent *first = (const struct dirent *) a;
(gdb) c
Continuing.

Breakpoint 1, compare_dirent (a=0x7fff5fc00490, b=0x7fff5fbfec00) at main.c:88
88      const struct dirent *first = (const struct dirent *) a;
(gdb) c
Continuing.

Program received signal EXC_BAD_ACCESS, Could not access memory.
Reason: KERN_PROTECTION_FAILURE at address: 0x00007fff5fc00490
0x00007fff8e238540 in _qsort () 
```

解决方案（完整）是两个答案中的一小部分

```
int compare_dirent(const void *a, const void *b)
{
    const struct dirent *first = (const struct dirent *) a;
    const struct dirent *second = (const struct dirent *) b;

    return first->d_ino - second->d_ino;
}

int process(FILE* output,const char *dirname, int flags)
{
    struct dirent *entries = NULL;
    struct dirent table[256];
    int entry_num = 0;
    DIR *directory = NULL;
    char cwd[1024];

    getcwd(cwd,1024);
    bzero(table,256);

    directory = opendir(dirname);
    while((entries = readdir(directory))!=NULL)
    {
        if(entries->d_type == DT_REG)
        {
            fprintf(output,"%s\t\n",entries->d_name);
            memcpy(table+entry_num, entries, sizeof(struct dirent));
            entry_num++;
        }
    }
    fprintf(stderr,"size: %lu\n", sizeof(struct dirent));
    qsort(table, entry_num, sizeof(struct dirent) , compare_dirent);

    fprintf(output,"\n\n");
    for(int i=0;i<entry_num;i++)
    {
        fprintf(output,"%s\n", table[i].d_name);
    }

    return entry_num;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-10T00:03:55.077

您的问题之一是：

```
qsort(table, entry_num, sizeof(struct dirent), &compare_dirent); 
```

应该：

```
qsort(table, entry_num, sizeof(struct dirent *), &compare_dirent); 
```

第三个元素是`width`，每个对象的大小。由于`table`是 的数组`struct dirent *`，这就是您想要的大小。

您还滥用了 readdir 返回的值。从[文档](http://pubs.opengroup.org/onlinepubs/009695399/functions/readdir.html)：

> readdir() 返回的指针指向可能被同一目录流上的另一个 readdir() 调用覆盖的数据。

这意味着很可能表中的所有值都是相同的指针，具有相同的值。您可以使用`readdir_r`，或者只是分配`struct dirent`（每个 readdir 调用一个），然后将值存储在适当的位置。

另一种方法是将其更改为 的数组`struct dirent`，在这种情况下，您将使用原始`qsort`调用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-10T00:04:17.873

您的代码不保存`dirent`s! 您分配内存来保存指向它们的指针，但是您永远不会分配任何内存来保存实际条目。因此，当您进行排序时，您的指针指向不再存在的对象。

这行代码坏了：

```
table[entry_num] = entries; 
```

这将保存指向`dirent` **now**的指针。但是当它不再指向`dirent`. 您无法保存指针以供以后使用，您必须保存实际条目。

> readdir() 返回的数据可能会被后续对同一目录流的 readdir() 调用覆盖。

所以你需要类似的东西：

```
table[entry_name] = malloc(sizeof(struct dirent));
memcpy(table[entry_name], entries, sizeof(struct dirent)); 
```

完成后不要忘记释放它们。

Matthew Flaschen 的回答也是正确的。您将错误的尺寸传递给`qsort`.

# c++ - 比较套接字地址的问题

> ID：10081371
> 
> 赞同：3
> 
> 时间：2012-04-09T23:58:18.397
> 
> 标签：c++, sockets, networking, chat, winsock2

我目前正在开发一个 UDP 应用程序，该应用程序允许两个用户使用 winsock 库相互交谈。目前，当我的程序运行时，它首先将 sockaddress 保存到向量中，然后当用户发送消息时，它将地址与向量中的第一个地址进行比较。当我调试并比较正在比较的值时，它们完全相同，但我的 if 语句转到 else （它认为地址不相等）

这是我的代码：

```
#include <WinSock2.h>

sockaddr    clientAddress;

recvfrom( hSocket, msg, MAXLINE, 0, &clientAddress, &cbClientAddress );

myVector.pushback(clientAddress);

if (&clientAddresses[0] == &clientAddress)
{
//is the same address
}
else
{
//not the same address
} 
```

我还尝试在and`.sa_data`之后使用更具体`clientAddress[0]``&clientAddress.`

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T00:14:57.270

多个问题：

*   在调用 之前`recvfrom`，您需要将`cbClientAddress`（类型`socklen_t`）初始化为您准备接收的地址信息的字节数，如下所示：

    ```
     struct sockaddr clientAddress;
     socklen_t cbClientAddress;

     cbClientAddress = sizeof(clientAddress);
     recvfrom(hSocket, msg, MAXLINE, 0, &clientAddress, &cbClientAddress); 
    ```

*   调用后，`cbClientAddress`将被接收到的地址的实际长度覆盖。这将比 短`sizeof(struct sockaddr)`。实际上它将等于，`sizeof(struct sockaddr_in)`因为这是一个 UDP/IP 套接字。

*   您必须只比较结构中实际包含数据的部分，而不是整个结构。`struct sockaddr_in`结构的未使用部分（和之间的大小差异`struct sockaddr`）可能是垃圾。你不想比较它。这不仅需要在向量中记住结构本身的内容，而且还需要显着长度。

*   在将保存的地址与您刚刚收到的地址进行比较时，请使用这种伪代码。不要试图比较整个结构（包括尾随未使用的部分）。

    ```
    if (
        (saved_length == this_length) &&
        (memcmp(saved_sockaddr, this_sockaddr, this_length) == 0)
    ) {
        it's a match
    } 
    ```

*   您的代码`&clientAddresses[0] == &clientAddress`检查结构的地址是否相等。这意味着您正在测试它是否*是相同的结构*，而不是您想要的，即测试它是否是*具有相同内容的结构*。`memcmp`按照上面的伪代码使用来比较内容。

# android - AndEngine GLES1 和 Tiled 图形故障

> ID：10081374
> 
> 赞同：0
> 
> 时间：2012-04-09T23:58:52.433
> 
> 标签：android, andengine

我正在使用 AndEngine GLES1 和程序“Tiled”来创建用作关卡的 TMX 平铺贴图，无论我使用什么设置，我都会将输出图像偏移到错误的图像。我使用了几个教程以及 AndEngine TMX 教程，无论我做什么，我都会遇到这个问题。我多次复制并粘贴代码检查错误，所以我知道它不是代码。为 AndEngine GLES1 制作 TMX 文件时，您与“平铺”有什么特别的关系吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-11T15:22:13.813

我发现出了什么问题。您的图块集图像（您从中提取图块以放置在地图上的图块）的分辨率必须为 2 的幂（即 2、4、8、16、32、64、128、256、512、1024、等...等...）在两个方向（宽度和高度）。否则它将无法在 android 和 AndEngine 中正常工作......

# php - PHP 未定义的查询参数

> ID：10081378
> 
> 赞同：1
> 
> 时间：2012-04-09T23:59:54.920
> 
> 标签：php

我使用 ajax 通过帖子传递参数。几乎我的问题是，当我收到 PHP 中的参数时，如果我执行**isset($_POST['param'])**它会返回 true，如果我回显参数，它会显示**undefined**。未设置通过 ajax 的参数 im 在这种情况下是正确的。这个想法是当我检查参数是否设置为如果它未定义则返回false，但这并没有发生。关于这可能是什么原因的任何具体原因？

```
$param= $_POST['param'];

$concat = array();
if(!empty($param) && isset($param)){ $concat[] = "param= '" . mysql_real_escape_string($param) . "'"; } 
```

**以上是我在原始$_POST['param'];**上完成的实际代码 并在**$param** 上查看这是否是问题，但结果相同。我所做的回声是实际参数/变量以及这两个上 isset 的结果。

提前致谢！

**更新**

**阿贾克斯**

```
$.ajax({
        type: "POST",
        url: "ajax/update.php",
        dataType: "text",
        data: "param=" + param,
        async: false,
        success: function(response) {
            if(response)
            {
                alert(response);
            }
        }
    }); 
```

参数在上面定义，但在这种特定情况下，它没有被设置为任何它保持为空的东西，传递一个空的 var。

# symfony - symfony2 路由问题

> ID：10081380
> 
> 赞同：0
> 
> 时间：2012-04-10T00:00:27.260
> 
> 标签：symfony, routes

好的，所以我有一个正确创建 crud 的实体......它为我提供了实体的 .yml 路由文件......

在 yml 文件中，我指定了一条路线，例如：

```
manager_agentview:
    pattern: /manager/{id}/view
    defaults: { _controller: "EcsCrmBundle:Management:agentview" } 
```

这完美地工作......但是，这个页面的内容是一个列表......

我的功能是这样的：

```
public function agentviewAction($id, $start = null, $end = null) {
        $em = $this->getDoctrine()->getEntityManager();
        $request = $this->getRequest();
            $today = time();
            echo $end;
            if ($end == null) {
                if (date('l') == "Saturday") { $end = date("Y-m-d 23:59:59"); } else { $end = date("Y-m-d 23:59:59", strtotime('next saturday', $today)); }
            }
            if ($start == null) {
                if (date('l') == "Sunday") { $start = date('Y-m-d 00:00:00'); } else { $start = date('Y-m-d 00:00:00', strtotime('last sunday', $today)); }
            }
            $entities = $em->getRepository('EcsCrmBundle:TimeClock');
            $query = $entities->createQueryBuilder('t');
            $query = $query->select('t')
                  ->where('t.daydate BETWEEN :start AND :end')
                  ->andwhere("t.noteBy = :id")
                  ->orderBy("t.id", 'ASC')
                  ->setParameter('start', $start)
                  ->setParameter('end', $end)
                  ->setParameter('id', $id)
                  ->getQuery();
            $entities = $query->getArrayResult();
            $dateRangeForm = $this->createForm(new DateRangeType());

            $query = $em->getRepository('EcsAgentManagerBundle:User')->find($id);

            //return new Response('yep', 200);
            return $this->render('EcsCrmBundle:TimeClock:view.html.twig', array('entity' =>$entities, 'user' => $query, 'start' => $start, 'end' => $end, 'form' => $dateRangeForm -> createView(),));  
    } 
```

dateRangeForm，只需创建 2 个 jquery datepicker 框..

但是，当我添加`{start}/{end}`到我的路线时，它不断告诉我它找不到正确的路线......因为我希望 URL 保持不变（最终 - 没有日期在 URL 中） - 我'必须弄清楚如何将数据发布到相同的功能，而不会破坏仅通过以下方式查看数据的能力：site.dev/manager/12/view

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T11:56:11.597

如果我正确理解您的问题，您希望能够拥有一个控制器功能来处理

/manager/1/view/start_date/end_date

并且还处理

/经理/1/查看

正确的？

有两种解决方案。首先是创建一个可选的占位符，如下所述：http: [//symfony.com/doc/current/book/routing.html](http://symfony.com/doc/current/book/routing.html)。基本上，您可以将路线更新为如下所示：

```
manager_agentview:
pattern: /manager/{id}/view/{start}/{end}
defaults: { _controller: "EcsCrmBundle:Management:agentview", start: null, end: null} 
```

然后该路由仍将匹配 /manager/1/view 并将 start 和 end 设置为 NULL。

第二种解决方案是创建多个都指向同一个控制器的路由，一个版本带有开始和结束日期，一个版本没有它们。我能想到你可能想要这样做的唯一原因是，如果你不希望你的路由匹配一个包含开始但没有结束的 URL，因为在这种情况下上述解决方案仍然匹配。

# objective-c - NSDateFormatter 未格式化（返回零）

> ID：10081383
> 
> 赞同：0
> 
> 时间：2012-04-10T00:00:51.837
> 
> 标签：objective-c, ios, cocoa-touch, nsdateformatter

我有一个日期字符串，例如：

```
2012-04-09T23:57:44.070Z 
```

我的日期格式是：

```
[dateFormatter setDateFormat:@"yyyy'-'MM'-'dd'T'HH':'mm':'ss'Z'"]; 
```

但它返回零。我的日期格式有什么问题？谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-10T00:07:04.813

你不需要对逃避`-`和`:`. 此外，您的秒字符是错误的。你应该使用：

```
NSDateFormatter *f = [[NSDateFormatter alloc] init];
[f setTimeZone:[NSTimeZone timeZoneWithName:@"GMT"]];
[f setDateFormat:@"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'"];

NSLog(@"%@", [f dateFromString:@"2012-04-09T23:57:44.070Z"]); 
```

这记录：

```
2012-04-09 23:57:44 +0000 
```

如果您没有在日期格式化程序上设置时区，它将假定您指的是设备现在所在的时区，而*不是*GMT 时区（这`Z`是暗示的意思）。

# javascript - 关于 ASP.net 应用程序中的 cookie 和会话的问题

> ID：10081384
> 
> 赞同：0
> 
> 时间：2012-04-10T00:00:53.550
> 
> 标签：javascript, asp.net, session, cookies

我正在编写一个 ASP.Net 应用程序，它允许匿名的人发布祈祷和其他人评论/确认为这些对象祈祷。祷告存储在具有唯一标识符的 SQL Server 2008 数据库中。

它们使用转发器控件和隐藏字段来存储行的 ID 来显示。中继器中的每个项目都包含一个按钮，该按钮允许匿名人员祈祷，并且该按钮作为数据库内的计数器递增。

基本上，一旦用户确认他/她正在为这个项目祈祷，我想禁用该按钮并显示该行的总数。

据我了解，我可以将数据存储在 cookie/会话中，因此到目前为止我能想到的唯一解决方案是将行的 ID 存储到这些对象之一中，然后在我的转发器控件中使用自定义逻辑来检查看看有哪些。

谁能提供一些关于完成此类事情的最有效方法可能是什么的见解？如果除了 cookie 或 session 之外还有其他选项，我也很高兴听到。

编辑：我正在尝试使用以下逻辑来实现此解决方案。

代码隐藏：

```
protected bool IsPrayerInCookie(string prayerId)
    {
        if(Request.Cookies["prayers"][prayerId] != null)
        {
            return false;
        }
        else
        {
            return true;
        }
    } 
```

ASPX：

```
 <span class="confirmed_prayers"><span class="trans">
                            <asp:Label runat="server" ID="lblConfirmedPrayers" Text='<%# Eval("ConfirmedPrayers") %>' />
                            people have prayed for this.</span></span>
                            <% if(!IsPrayerInCookie(Eval("PrayerId").ToString())) 
                                {   
                            %>
                                <asp:LinkButton ID="btnPray" CssClass="but_styled" runat="server" TabIndex="8" CommandName="IncrementPrayer">
                                <span><span class="check">
                                    Pray for This</span></span></asp:LinkButton>
                            <%
                                }
                            %> 
```

然而，这不起作用。谁能帮我弄清楚如何使 if 语句在 aspx 文件中工作以正确调用具有正确 ID 的方法背后的代码？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T00:14:16.610

只要用户在网站上，会话就会持续。因此，如果他们关闭浏览器并返回，它就会消失。

Cookie 将是更好的选择，只有在他们清除 Cookie 后，这些数据才会消失。

如果您不需要用户登录，我想这就是您所能做的。

下面是关于 cookie 的 MSDN 页面：

[http://msdn.microsoft.com/en-us/library/ms178194.aspx](http://msdn.microsoft.com/en-us/library/ms178194.aspx)

对于实际的 cookie 存储，我会执行以下操作：

```
Response.Cookies["prayerlist"][CurrentPrayerItemID].Value = "something"; //All that matters is that they have the cookie with this ID.
Response.Cookies["prayerlist"].Expires = DateTime.MaxValue; 
```

因此，当有人点击添加该项目时，您首先要检查他们的 cookie 中是否已经有该 id，如下所示：

```
if(Response.Cookies["prayerlist"][CurrentPrayerItemID] != null)
{
    Response.Cookies["prayerlist"][CurrentPrayerItemID].value = "something";

    // Add prayer to Database
} 
```

同样，每当您绑定中继器时，您都会检查 cookie。如果他们有那个 cookie，您将禁用相应的祈祷按钮。

我不知道如何解决这个问题，因为我知道你的绑定方式，但它看起来像这样：

```
foreach(Item item in YourListOfItemsThatYouAreBindingToTheRepeater)
{
    if(Response.Cookies["prayerlist"][CurrentPrayerItemID] != null)
    {
        //Disable Button - Set "HasPrayed" = true
    }
} 
```

要真正禁用该按钮，我要做的是将列表中的一个值设置为 false，然后在 aspx 页面中，执行以下操作：

```
<asp:Button ID="button1" runat="server" Enabled='<%# !(bool)Eval("HasPrayed") %>' /> 
```

如果 HasPrayed 为真，则使用`!(bool)Eval("HasPrayed")`因为您想将启用设置为假。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T00:18:47.907

您可以使用会话来存储用户单击的祈祷项目，但是当他们返回您的站点时，它将忘记所有以前的项目，因为会话已经丢失。

在这种情况下，您可以使用 cookie 来存储用户单击“我会为此祈祷”按钮的所有祈祷项目 ID。如果您不想要求用户登录，我会走这条路。

对于您所描述的代码，我认为您可以使用[ASP.NET UpdatePanel](http://msdn.microsoft.com/en-us/library/bb399001.aspx)来更新/显示为该项目祈祷的人数并禁用该按钮。

# uml - 建模 uml 图 用例 -> 序列？

> ID：10081389
> 
> 赞同：0
> 
> 时间：2012-04-10T00:01:20.153
> 
> 标签：uml, use-case, sequence-diagram

在有了我的用例图之后，我找不到实现[时序图](http://www.agilemodeling.com/artifacts/sequenceDiagram.htm)的逻辑，我如何从分析什么来设计从演员和用例到一个具有许多刻板印象的时序图而不考虑类图（尊重顺序）。还是我必须实现其他图表才能从用例一传递到序列？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T00:35:38.040

我总是一起创建类图和序列图（至少，UML 建模器 Sparx Enterprise Architect 与这种观点兼容），但我从来没有受过`proper order`这种东西是否存在的教育。

# c++ - 无限制联合与 C 兼容吗？

> ID：10081391
> 
> 赞同：1
> 
> 时间：2012-04-10T00:02:12.550
> 
> 标签：c++, c++11

现在 C++11 允许您创建这样的联合

```
union U {
   int z;
   std::vector<char> data;
}; 
```

是否有可能以某种方式将此结构传递给接受常规 C 联合的 C 库？如何？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T00:37:33.813

你能通过*那个*工会吗？不会。`std::vector`（以及除 之外的所有其他标准容器`std::array`）不会生成*已知*布局的类型。它们可能是[标准布局类型](https://stackoverflow.com/a/7189821/734069)，但标准中没有呈现特定布局。因此，您不能将其传递给 C。

注意：通过“将其传递给 C”，我假设您的意思是“构建具有相同内存布局的等效 C 结构，以便 C 代码可以接触数据。”

但是你可以传递任何包含已知布局类型的联合，只要所有类型都是标准布局类型。它们不必是微不足道的，但它们必须是标准布局。

此外，如果您不介意特定于编译器，您可以查看您的特定`std::vector`实现（或使用特定实现，如`boost::vector`）并设计一个等效的 C 结构来存储基本相同的数据。当然，这是假设特定的实现确实是标准布局；C++ 标准并不要求它，并且分配器的存在可能会改变这一点。

# c - 将指针传递给函数

> ID：10081392
> 
> 赞同：2
> 
> 时间：2012-04-10T00:02:13.850
> 
> 标签：c, pointers, data-structures

```
//old and auqHdr are data structures of type gblAuqEntry and auQ respectively
//I traverse through the list 'auqHdr' and when I match the element 'old', I need to remove it

removeAUfromNodeAUQ(&old, &auqHdr);  

//Function implementation
static void removeAUfromNodeAUQ(gblAuqEntry *old, auQ *auqH)
{
    auQ *auqPtr, *prev;
int found =0;
for (auqPtr = auqH; auqPtr; auqPtr = auqPtr->nxt)
{
    if (something)
        prev = auqPtr;
    else
    {
        prev->nxt = old->nxt;
        found = 1;
        break;
    }
} 
```

我正在尝试删除列表“auqHdr”中的元素“旧”。

我得到的错误是“声明与以前的“removeAUfromNodeAUQ”不兼容”有人可以指出我在这里做错了什么吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T00:04:24.017

好吧，如果您的代码与您发布的完全一样，那么：

```
removeAUfromNodeAUQ(&old, &auqHdr); 
```

不是函数调用，是函数声明。然后定义它，但使用不同的签名。在这种情况下，您正在向前声明一个函数。C 为您假定返回类型为 int。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-10T00:06:06.840

如果您在*声明*函数之前调用该函数，则 C 表示返回类型为`int`，而不是`void`。

您应该在文件头或文件顶部添加此声明以解决问题：

```
static void removeAUfromNodeAUQ(gblAuqEntry *old, auQ *auqH); 
```

# r - 只显示正在使用的标签？

> ID：10081395
> 
> 赞同：4
> 
> 时间：2012-04-10T00:02:20.870
> 
> 标签：r, graph, ggplot2, data-mining

我正在使用以下内容绘制下面给出的图表：

```
data <- structure(list(Type1 = c("DB", "DB", "DB", "DB", "DB", "DB", 
"DB", "DB", "DB", "DB", "DB", "DB", "DB", "Manual", "Manual", 
"Manual", "Manual", "Manual", "Manual", "Manual", "Manual", "Manual", 
"Manual", "Manual", "Manual", "Manual", "Manual", "Manual"), 
    Type2 = c(1L, 1L, 1L, 1L, 1L, 2L, 2L, 2L, 2L, 3L, 3L, 3L, 
    3L, 1L, 1L, 1L, 1L, 1L, 2L, 2L, 2L, 2L, 2L, 3L, 3L, 3L, 3L, 
    3L), Category = c("A", "B", "C", "D", "E", "A", "B", "F", 
    "G", "A", "B", "C", "H", "I", "J", "K", "L", "M", "O", "J", 
    "P", "K", "Q", "M", "K", "P", "J", "P"), Percent = c("83.5106383", 
    "9.574468085", "5.85106383", "0.531914894", "1/188*100", 
    "85.24590164", "11.47540984", "1/61*100", "1.639344262", 
    "90", "3.333333333", "3.333333333", "3.333333333", "20.10582011", 
    "10.05291005", "6.349206349", "5.82010582", "4.761904762", 
    "31.14754098", "16.39344262", "6.557377049", "6.557377049", 
    "4.918032787", "30", "23.33333333", "16.66666667", "10", 
    "6.666666667")), .Names = c("Type1", "Type2", "Category", 
"Percent"), row.names = c(NA, -28L), class = "data.frame")

data$Percent <- as.numeric(data$Percent)

g= ggplot(data, aes(x=Category, y=Percent)) + 
          geom_bar(width=0.8, stat="identity", position=position_dodge()) + 
          facet_grid(Type1 ~ Type2, ) + 
          theme_bw() + 
          coord_flip() + 
          scale_y_continuous(limits=c(0,100))

print(g) 
```

![在此处输入图像描述](../Images/66e45f562cc4b855d1c9e0e67870e1e4.png)

有什么方法可以让每行只使用非零的标签吗？例如，采取`DB`行。它仅使用 6 个标签，但显示所有 16 个标签，因为其他 10 个标签正在被`Manual`部分数据使用。对于`Manual`行也是如此。我正在寻找的是这样的：

```
 1            2             3
H
G
D                                        DB
C
B
A

Q
P
O
G                                        MANUAL
M
L
K
J
I 
```

关于如何做到这一点的任何建议？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-10T03:36:22.750

它只会删除那些不在任何方面的元素。但是您可以在 facet_grid() 中使用 scales="free" 参数。

```
g + facet_grid(Type1 ~ Type2, scales="free") 
```

但我认为 facet_wrap 可能会为您提供更合适的可视化：

```
ggplot(data, aes(x=Category, y=Percent)) + 
  geom_bar(width=0.8, stat="identity", position=position_dodge()) + 
  facet_wrap(Type1 ~ Type2,scales="free") + 
  theme_bw() +
  scale_y_continuous(c(0,100)) + 
  coord_flip() + 
  opts() 
```

![在此处输入图像描述](../Images/7f2ecfd857c693d588b19a5fd7b55bfb.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-10T03:46:17.527

`facet_grid(scales="free")`组合和时似乎存在错误或意外行为`coord_flip()`。

以下是 2 种可能的解决方法：

```
library(ggplot2)

# Removed quotes from Percent values, so that Percent will be numeric.
dat <- structure(list(Type1 = c("DB", "DB", "DB", "DB", "DB", "DB", 
"DB", "DB", "DB", "DB", "DB", "DB", "DB", "Manual", "Manual", 
"Manual", "Manual", "Manual", "Manual", "Manual", "Manual", "Manual", 
"Manual", "Manual", "Manual", "Manual", "Manual", "Manual"), 
    Type2 = c(1L, 1L, 1L, 1L, 1L, 2L, 2L, 2L, 2L, 3L, 3L, 3L, 
    3L, 1L, 1L, 1L, 1L, 1L, 2L, 2L, 2L, 2L, 2L, 3L, 3L, 3L, 3L, 
    3L), Category = c("A", "B", "C", "D", "E", "A", "B", "F", 
    "G", "A", "B", "C", "H", "I", "J", "K", "L", "M", "O", "J", 
    "P", "K", "Q", "M", "K", "P", "J", "P"), Percent = c(83.5106383, 
    9.574468085, 5.85106383, 0.531914894, 1/188*100, 
    85.24590164, 11.47540984, 1/61*100, 1.639344262, 
    90, 3.333333333, 3.333333333, 3.333333333, 20.10582011, 
    10.05291005, 6.349206349, 5.82010582, 4.761904762, 
    31.14754098, 16.39344262, 6.557377049, 6.557377049, 
    4.918032787, 30, 23.33333333, 16.66666667, 10, 
    6.666666667)), .Names = c("Type1", "Type2", "Category", 
"Percent"), row.names = c(NA, -28L), class = "data.frame")

figure_1 = ggplot(dat, aes(x=Category, y=Percent)) + 
           geom_bar(width=0.8, stat="identity") + 
           facet_grid(Type2 ~ Type1, scales="free_x") + 
           theme_bw() + 
           scale_y_continuous(limits=c(0, 100)) +
           opts(title="Figure 1\. Success!\n(But Rotated 90 Degrees)")

figure_2 = ggplot(dat, aes(x=Percent, y=Category)) + 
           geom_point(size=3) + 
           facet_grid(Type1 ~ Type2, scales="free_y") + 
           theme_bw() + 
           scale_x_continuous(limits=c(0, 100)) +
           opts(title="Figure 2\. Success!\n(But Dotplot Instead Of Barplot)")

# Unexpected interaction between scales="free" and coord_flip()?
figure_3 = ggplot(dat, aes(x=Category, y=Percent)) + 
           geom_bar(width=0.8, stat="identity") + 
           facet_grid(Type1 ~ Type2, scales="free") + 
           theme_bw() + 
           scale_y_continuous(limits=c(0, 100)) +
           coord_flip() +
           opts(title="Figure 3\. Strange Y-axis Behavior.") 
```

![在此处输入图像描述](../Images/641135dba714aa3d0f3b8fbc22c3561a.png) ![在此处输入图像描述](../Images/e5e39a5c66a487bbd192a537656eb15d.png) ![在此处输入图像描述](../Images/1ee0c3a74c699cab791d97e3652fe911.png)

# zip - 将 Sql Server Compact 数据库存储在 zip 文件中。这可能吗？

> ID：10081403
> 
> 赞同：1
> 
> 时间：2012-04-10T00:03:56.073
> 
> 标签：zip, sql-server-ce

我可以将 sql server 紧凑型数据库放在 zip 文件中，然后将其用作普通的独立数据库文件吗？

我问的原因是我想保留许多文件，包括我拥有的应用程序的数据库，这样可以更容易地将单个 zip 文件移动到另一台电脑，而不是拥有一个文件目录。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T00:06:44.297

您必须先解压缩它，然后才能在应用程序中使用它。但是，您的 zip 中的其他文件也是如此。

# mongodb - 仅在 MongoDB 上创建集合

> ID：10081409
> 
> 赞同：0
> 
> 时间：2012-04-10T00:05:02.677
> 
> 标签：mongodb, schema-design

我只想创建集合结构。即说产品集合包含类别列表。

我想通过创建此依赖项来指定此容器结构，但我不想创建任何集合条目（例如，某处有一个加载程序可以批量上传数据）。

RDBMS 中的壁橱类比是：DBA 创建具有约束和依赖关系的模式设计；应用程序或 ETL 工具加载实际数据。

我看到的大多数示例只是创建一个示例集合，然后调用 db.insert(document) 或 db.save(document)

在 MongoDB 中甚至有可能吗？

如果问题不清楚，请告诉我。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-10T00:09:46.183

最简洁的答案是不。

您不能在 MongoDB 中创建模式。集合只是一组文档。此外，依赖关系很可能用嵌入的文档（与引用的文档相反）来表示。

如果您发布要表示的数据，我们可以更具体。

# sql - 在 tsql 中循环以找出表中的行数

> ID：10081410
> 
> 赞同：-1
> 
> 时间：2012-04-10T00:05:04.033
> 
> 标签：sql, sql-server, sql-server-2008, tsql

我有一个表 A 可以为 DES 和 ARR 列提供不同的值（不同的行数），例如

```
DES  ARR

D    B
C    E
U    M
R    D                  (values in 4 rows) 
```

或者

```
DES  ARR

E   M
G   H                  (values in only 2 rows) 
```

我写了这个查询写在下面

```
declare @A varchar(500),
declare @B varchar(500);
With B as (
Select DES as D, 
row number() partition over (Order by C) as RN
ARR as AR
from A)
Select  @A = D,
        @B = AR
from B
where RN = 1 
```

上面的查询为我提供了 DES 和 ARR 的值，如果我不断更改 RN 编号 (RN =1, 2,3)，但我不知道表中实际填充了多少行，所以我无法有效地使用 RN 来获取每行的 DES 和 ARR 值

如何使用 tSQL 查询找出表 A 中有多少行在 DES 和 ARR 列中有值？在找出其中包含 DES 和 ARR 值的行总数之后，如何从填充有 DES 和 ARR 值的每一行中找到 DES 和 ARR 的值？我可以更改上面的查询以产生我需要的结果吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T02:17:54.347

计数是重要的还是只处理每一行中的值？

您是否考虑过使用游标？

```
DECLARE @A varchar(500), @B varchar(500)
DECLARE db_cursor CURSOR FOR  
SELECT DES, ARR 
FROM A
ORDER BY C

OPEN db_cursor   
FETCH NEXT FROM db_cursor INTO @A, @B  

WHILE @@FETCH_STATUS = 0   
BEGIN   
       -- Do whatever you want with @A and @B Here 

       FETCH NEXT FROM db_cursor INTO @A, @B 
END   

CLOSE db_cursor   
DEALLOCATE db_cursor 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T01:38:59.877

您的问题令人困惑，但是您是否尝试过使用 count(1) 或 count(*) 来查找表中的行数。

如果要找出表中非空值的数量，请使用

```
select count(column_name)
  from table_name 
```

这应该给你正在寻找的东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-10T02:31:51.033

您的问题令人困惑，但我可以根据您所说的提出几个问题：

> 如何使用 tSQL 查询找出表 A 中有多少行在 DES 和 ARR 列中有值？

尝试这个：

```
SELECT COUNT(*) AS num_rows
FROM A
WHERE DES IS NOT NULL AND ARR IS NOT NULL 
```

然后你问：

> 在找出其中包含 DES 和 ARR 值的行总数之后，如何从填充有 DES 和 ARR 值的每一行中找到 DES 和 ARR 的值？

这是你要找的吗？

```
SELECT * FROM A
WHERE DES IS NOT NULL AND ARR IS NOT NULL 
```

# c++ - c++ mac OS 中的自动化单元测试

> ID：10081415
> 
> 赞同：0
> 
> 时间：2012-04-10T00:05:52.530
> 
> 标签：c++, unit-testing

我使用 eclipse 在 c++ 中开发了一个项目，我的操作系统是 mac。我需要进行自动化单元测试，任何人都可以建议一个简单且易于开发测试用例的框架。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T01:10:01.450

[Google Test](http://code.google.com/p/googletest/) - 我真正喜欢的是它有[易于理解的文档](http://code.google.com/p/googletest/wiki/V1_6_Primer)。

这就是我尝试过的并且效果很好。

你真的应该阅读[这个页面](https://stackoverflow.com/questions/242926/comparison-of-c-unit-test-frameworks)。

最后，还有测试框架之间的这种[比较。](http://gamesfromwithin.com/exploring-the-c-unit-testing-framework-jungle)虽然它没有谷歌测试。

经验法则：保持简单，不要推测。不要选择框架，因为它具有您认为需要的功能。选择一个适合你的框架，它正在积极开发中，并且也被许多其他人使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T01:00:19.083

最好的 C++ 单元测试系统是[http://sourceforge.net/apps/mediawiki/cppunit/index.php?title=Main_Page](http://sourceforge.net/apps/mediawiki/cppunit/index.php?title=Main_Page)

# ios - XCode - EXC_BAD_ACCESS。-[Not A Type 保留]

> ID：10081418
> 
> 赞同：2
> 
> 时间：2012-04-10T00:06:19.883
> 
> 标签：ios, xcode, compiler-errors, exc-bad-access

我正在尝试将[Stefanhafeneger 的这个条形码源代码包含](https://github.com/stefanhafeneger/Barcode)到我的项目中。我从一个简单的相机示例和条码引擎开始，对于第一次条码解码，一切正常。当我第二次尝试时，我收到 EXC_BAD_ACCESS。在应用程序崩溃之后，它只工作 1 次。

[这是应用程序崩溃的屏幕记录。](http://dl.dropbox.com/u/2305062/DataMatrix%20error.mov)

我正在我的应用程序中使用谷歌的这个[DataMatrix](http://www.ufodesign.ro/dm/datamatrix.gif)标签进行测试。

![UfoDesign 数据矩阵](../Images/fcfb9584ecd820d49ee3f18e4f915738.png)

几天来我一直在寻找解决方案，我尝试过 NSZombieEnabled，并使用 Instrument 进行调试，但我仍然没有运气。下图是来自 xcode 的错误。

```
*** -[Not A Type retain]: message sent to deallocated instance 0x7b21ed0 
```

![调试1](../Images/e916cea985fd0d74da9243d2019ed9f0.png) ![调试2](../Images/370fee0ca74cc229d1f441851939219b.png)

供您参考，这是一个启用 ARC 的项目。有人请帮忙，我还是几个月大的初学者。

这是我的这个项目的 xCode 文件[Barcode-Datamatrix Project](http://dl.dropbox.com/u/2305062/Barcode-Datamatrix.zip)

更新：我还尝试通过使用链接器标志 -fno-objC-arc 为与该库相关的每个文件禁用 ARC，但结果仍然相同。除了我尝试`imageView.image = [UIImage imageWithCGImage:image.CGImage];`或复制`imageView.image = [image copy];`应用程序仍然在同一个地方崩溃。

非常感谢健

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T04:35:02.597

BarCode Engine 可能未启用 ARC。

要禁用一些不是为 ARC 支持而设计的文件，我们可以向编译器显示通过此命令禁用 ARC

```
-fno-objc-arc 
```

将此命令放在所有编译源都存在的项目构建阶段（即项目名称中的所有类都将显示）

`ZBarSDK`这个条形码，二维码解码非常简单易用和更强大的API。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T01:37:08.567

`[Not A Type retain]`表示您将一个不是 UIImage 的对象传递给 UIImageView 的 image 属性，然后该方法尝试识别它的类型以在该`imagevVew.image = image`行发送保留。NSLog 它的类型`NSLog("%@", NSStringFromClass([image class]));`

编辑：我***不***建议您将这样一个旧项目转换为 ARC（我引用：“它与 ios 2.1 相关联”）。使用链接器标志 -fno-objC-arc 并为与该项目相关的每个文件禁用 ARC。然后，检查你的 imageView 是否时髦，尝试将你的图像设置为 nil，或者完全删除该行并运行。

# java - Java - 每 4 个空格分割一个输入流

> ID：10081421
> 
> 赞同：1
> 
> 时间：2012-04-10T00:06:45.653
> 
> 标签：java, split, inputstream, tokenize

我想用每 4 个空格标记一个输入流。因此，每当我调用类似 next() 的东西时，它都会从该行返回 4 个单词……如果输入流中没有 4 个单词，因为它已经到达末尾，则返回输入流中剩下的任何内容

## 已编辑

我正在寻找一个正则表达式...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T00:20:13.313

您应该能够使用 next() 将字节添加到字符串的末尾，为已经找到的单词数量创建一个计数变量，并检查该字节是否是空格 (' ')。然后在方法的末尾返回字符串。这样您就可以获取已发送的字节，并将它们从 next() 方法的流中删除。

# plugins - 是否可以让 DLL 中的导出函数返回导出类的静态成员？

> ID：10081427
> 
> 赞同：0
> 
> 时间：2012-04-10T00:07:40.553
> 
> 标签：plugins, dll, window

我正在研究某种插件协议。这个想法是有一个基类 PCOperatorBase 并且插件将继承这个基类以通过它们覆盖的“进程”虚拟方法提供特定的功能。子类还应该有一个包含典型插件信息的静态结构成员：插件名称、类型和子类型。另一个类（PCOperatorManager）使用此信息来了解正在处理的插件类型。而且我考虑让它成为一个静态成员，这样就不需要实例化一个插件来仅仅找出它的运算符类型。

我有以下课程：

**PCOperatorBase.h**派生所有其他插件的超类：

```
#ifdef PCOPERATORBASE_EXPORTS
#define PCOPERATORBASE_API __declspec(dllexport)
#else
#define PCOPERATORBASE_API __declspec(dllimport)
#endif

class PCOPERATORBASE_API PCOperatorBase
{
public:

    typedef struct OperatorInfo
    {
        wchar_t* name;
        wchar_t* type;
        wchar_t* subtype;
    } OperatorInfo;

    PCOperatorBase(void);
    virtual ~PCOperatorBase(void);
    virtual int process(int* inBuffer, int* outBuffer, int bufferSize);
}; 
```

然后，例如，一个子类： **BlackNWhite.h：**一个 RGB->black / white 运算符——是的，这些将是图形插件，并且忽略输入/输出缓冲区的类型。它们只是占位符这点。

```
#ifdef BLACKNWHITE_EXPORTS
#define BLACKNWHITE_API __declspec(dllexport)
#else
#define BLACKNWHITE_API __declspec(dllimport)
#endif

// This class is exported from the BlackNWhite.dll
class BLACKNWHITE_API CBlackNWhite : PCOperatorBase 
{
public:
    static PCOperatorBase::OperatorInfo* operatorInfo;

    CBlackNWhite(void);
    virtual ~CBlackNWhite(void);
    //virtual int process(int* inBuffer, int* outBuffer, int bufferSize);

};

BLACKNWHITE_API CBlackNWhite* getOperatorInstance();
BLACKNWHITE_API const PCOperatorBase::OperatorInfo* getOperatorInfo(); 
```

这里是实现文件： **BlackNWhite.cpp：**

```
#include "stdafx.h"
#include "BlackNWhite.h"

BLACKNWHITE_API CBlackNWhite* getOperatorInstance()
{
    return new CBlackNWhite();
}

BLACKNWHITE_API const PCOperatorBase::OperatorInfo* getOperatorInfo()
{
    return CBlackNWhite::operatorInfo;
}

CBlackNWhite::CBlackNWhite()
{
}

CBlackNWhite::~CBlackNWhite()
{
} 
```

现在，我尝试了几种方法，但由于静态成员，我无法编译 DLL。链接器抛出：

```
\BlackNWhite.lib and object c:\Projects\BlackNWhite\Debug\BlackNWhite.exp
1>BlackNWhite.obj : error LNK2001: unresolved external symbol "public: static struct PCOperatorBase::OperatorInfo * CBlackNWhite::operatorInfo" (?operatorInfo@CBlackNWhite@@2PAUOperatorInfo@PCOperatorBase@@A)
1>c:\Projects\BlackNWhite\Debug\BlackNWhite.dll : fatal error LNK1120: 1 unresolved externals 
```

我认为由于结构是在基类中定义的并且基类正在导出，因此结构也会导出。但我想我错了？

**那么我应该怎么做呢？**

**不管怎样，有没有比静态类成员更好的方法让插头的工厂导出它们的名称、类型和子类型而不需要实例化？**例如，资源文件？甚至另一个外部“C”函数可以返回此信息。但我只是觉得，因为它是 C++，所以将这些数据（这是关于作为工厂本身的类）封装在类中是最有意义的，无论是通过成员或方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T01:41:03.453

它与 DLL 没有任何关系，您声明了静态成员但您忘记*定义*它。将此行添加到 BlackNWhite.cpp：

```
PCOperatorBase::OperatorInfo* CBlackNWhite::operatorInfo = NULL; 
```

# c++ - 何时调用 C++ 析构函数？

> ID：10081429
> 
> 赞同：130
> 
> 时间：2012-04-10T00:08:05.703
> 
> 标签：c++, destructor

基本问题：程序何时在 C++ 中调用类的析构方法？有人告诉我，只要对象超出范围或受到`delete`

更具体的问题：

1）如果对象是通过指针创建的，并且该指针后来被删除或赋予新的指向地址，它所指向的对象是否调用其析构函数（假设没有其他东西指向它）？

2）跟进问题 1，什么定义了对象何时超出范围（与对象何时离开给定 {block} 无关）。那么，换句话说，什么时候在链表中的对象上调用析构函数？

3) 你想手动调用析构函数吗？

* * *

## 回答 #1

> 赞同：79
> 
> 时间：2012-04-10T00:15:14.560

> 1）如果对象是通过指针创建的，并且该指针后来被删除或赋予新的指向地址，它所指向的对象是否调用其析构函数（假设没有其他东西指向它）？

这取决于指针的类型。例如，智能指针通常会在删除对象时删除它们的对象。普通指针没有。当指针指向不同的对象时也是如此。一些智能指针会破坏旧对象，或者如果它没有更多的引用就会破坏它。普通指针没有这样的智能。它们只是保存一个地址，并允许您通过专门这样做来对它们指向的对象执行操作。

> 2）跟进问题 1，什么定义了对象何时超出范围（与对象何时离开给定 {block} 无关）。那么，换句话说，什么时候在链表中的对象上调用析构函数？

这取决于链表的实现。典型的集合在销毁时会销毁所有包含的对象。

因此，指针链表通常会破坏指针，但不会破坏它们指向的对象。（这可能是正确的。它们可能是其他指针的引用。）但是，专门设计为包含指针的链表可能会在自身销毁时删除对象。

智能指针的链表可以在指针被删除时自动删除对象，或者在它们没有更多引用时这样做。这完全取决于你来挑选你想要的作品。

> 3) 你想手动调用析构函数吗？

当然。一个例子是，如果您想用另一个相同类型的对象替换一个对象，但又不想释放内存只是为了再次分配它。您可以就地销毁旧对象并就地构建新对象。（但是，通常这是一个坏主意。）

```
// pointer is destroyed because it goes out of scope,
// but not the object it pointed to. memory leak
if (1) {
 Foo *myfoo = new Foo("foo");
}

// pointer is destroyed because it goes out of scope,
// object it points to is deleted. no memory leak
if(1) {
 Foo *myfoo = new Foo("foo");
 delete myfoo;
}

// no memory leak, object goes out of scope
if(1) {
 Foo myfoo("foo");
} 
```

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2012-04-10T02:20:31.837

其他人已经解决了其他问题，所以我只看一点：您是否想要手动删除对象。

答案是肯定的。@DavidSchwartz 举了一个例子，但这是一个*相当*不寻常的例子。我将举一个很多 C++ 程序员一直在使用的例子：（`std::vector`并且`std::deque`，虽然它的使用并不多）。

正如大多数人所知，`std::vector`当/如果您添加的项目超出其当前分配的容量时，将分配更大的内存块。但是，当它这样做时，它有一块内存能够容纳比向量中当前*更多的对象。*

为了管理它，`vector`幕后的工作是通过对象分配*原始*内存`Allocator`（除非您另外指定，否则意味着它使用`::operator new`）。然后，当您使用（例如）`push_back`向 中添加一个项目时`vector`，向量在内部使用 a`placement new`在其内存空间的（以前）未使用的部分中创建一个项目。

现在，当/如果你`erase`是向量中的一个项目时会发生什么？它不能只使用`delete`-- 那会释放它的整个内存块；它需要销毁该内存中的一个对象而不销毁任何其他对象，或释放它控制的任何内存块（例如，如果您`erase`从向量中取出 5 个项目，然后立即再`push_back`增加 5 个项目，则可以*保证*向量*不会*重新分配这样做时的记忆。

为此，向量通过显式调用析构函数直接销毁内存中的对象，*而不是*使用`delete`.

如果，也许，其他人要编写一个使用连续存储的容器，大致类似于 a `vector`（或它的某种变体，就像`std::deque`真的那样），你几乎肯定会想要使用相同的技术。

举个例子，让我们考虑一下如何为循环环形缓冲区编写代码。

```
#ifndef CBUFFER_H_INC
#define CBUFFER_H_INC

template <class T>
class circular_buffer {
    T *data;
    unsigned read_pos;
    unsigned write_pos;
    unsigned in_use;
    const unsigned capacity;
public:
    circular_buffer(unsigned size) :
        data((T *)operator new(size * sizeof(T))),
        read_pos(0),
        write_pos(0),
        in_use(0),
        capacity(size)
    {}

    void push(T const &t) {
        // ensure there's room in buffer:
        if (in_use == capacity) 
            pop();

        // construct copy of object in-place into buffer
        new(&data[write_pos++]) T(t);
        // keep pointer in bounds.
        write_pos %= capacity;
        ++in_use;
    }

    // return oldest object in queue:
    T front() {
        return data[read_pos];
    }

    // remove oldest object from queue:
    void pop() { 
        // destroy the object:
        data[read_pos++].~T();

        // keep pointer in bounds.
        read_pos %= capacity;
        --in_use;
    }

~circular_buffer() {
    // first destroy any content
    while (in_use != 0)
        pop();

    // then release the buffer.
    operator delete(data); 
}

};

#endif 
```

与标准容器不同，它直接使用`operator new`和`operator delete`。对于实际使用，您可能确实想使用分配器类，但目前它会分散注意力而不是贡献（无论如何，IMO）。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2012-04-10T00:14:33.737

1.  当你用 来创建一个对象时`new`，你负责调用`delete`. 当您使用 创建对象时`make_shared`，结果`shared_ptr`负责保持计数并`delete`在使用计数变为零时调用。
2.  超出范围确实意味着离开一个块。这是调用析构函数的时候，假设对象*没有*被分配`new`（即它是一个堆栈对象）。
3.  唯一需要显式调用析构函数的时候是在为对象分配[*位置`new`*](http://www.parashift.com/c++-faq-lite/dtors.html#faq-11.10)时。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-04-10T00:15:30.137

1) 对象不是“通过指针”创建的。有一个指针分配给您“新建”的任何对象。假设这就是你的意思，如果你在指针上调用'delete'，它实际上会删除（并调用析构函数）指针取消引用的对象。如果将指针分配给另一个对象，则会出现内存泄漏；C++ 中的任何内容都不会为您收集垃圾。

2）这是两个独立的问题。当声明它的堆栈帧从堆栈中弹出时，变量超出范围。通常这是你离开一个街区的时候。堆中的对象永远不会超出范围，尽管它们在堆栈上的指针可能。没有什么特别保证会调用链表中对象的析构函数。

3) 不是真的。可能有 Deep Magic 会提出其他建议，但通常您希望将您的“新”关键字与“删除”关键字匹配，并将所有必要的内容放入您的析构函数中，以确保它正确清理自己。如果您不这样做，请务必将析构函数注释为使用该类的任何人应如何手动清理该对象的资源的具体说明。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-04-10T00:14:05.277

1.  **指针**——常规指针不支持 RAII。没有明确的`delete`，就会有垃圾。幸运的是，C++ 有[自动指针](http://en.wikipedia.org/wiki/Auto_ptr)可以为您处理这个问题！

2.  **作用域**——想想当一个变量对你的程序变得*不可见时。*`{block}`正如您所指出的，通常这是在 的末尾。

3.  **手动销毁**——切勿尝试这样做。让范围和 RAII 为您创造奇迹。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-04-10T00:36:11.873

详细回答问题 3：是的，在某些情况下（很少见）您可能会显式调用析构函数，特别是作为放置 new 的对应项，正如 dasblinkenlight 所观察到的那样。

举一个具体的例子：

```
#include <iostream>
#include <new>

struct Foo
{
    Foo(int i_) : i(i_) {}
    int i;
};

int main()
{
    // Allocate a chunk of memory large enough to hold 5 Foo objects.
    int n = 5;
    char *chunk = static_cast<char*>(::operator new(sizeof(Foo) * n));

    // Use placement new to construct Foo instances at the right places in the chunk.
    for(int i=0; i<n; ++i)
    {
        new (chunk + i*sizeof(Foo)) Foo(i);
    }

    // Output the contents of each Foo instance and use an explicit destructor call to destroy it.
    for(int i=0; i<n; ++i)
    {
        Foo *foo = reinterpret_cast<Foo*>(chunk + i*sizeof(Foo));
        std::cout << foo->i << '\n';
        foo->~Foo();
    }

    // Deallocate the original chunk of memory.
    ::operator delete(chunk);

    return 0;
} 
```

这种事情的目的是将内存分配与对象构造解耦。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-04-10T00:17:42.570

每当你使用“new”，即把一个地址附加到一个指针上，或者说，你要求堆上的空间时，你需要“删除”它。
1.是的，当您删除某些内容时，会调用析构函数。
2.当链表的析构函数被调用时，它的对象的析构函数被调用。但如果它们是指针，则需要手动删除它们。3.当空间被“新”占用时。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2018-10-14T06:38:11.143

请记住，在为该对象分配内存之后立即调用对象的构造函数，而在释放该对象的内存之前调用析构函数。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-04-10T00:18:08.207

是的，当对象超出范围（如果它在堆栈上）或调用`delete`指向对象的指针时，会调用析构函数（又名 dtor）。

1.  如果指针被删除，`delete`则将调用 dtor。如果在没有`delete`先调用的情况下重新分配指针，则会出现内存泄漏，因为该对象仍然存在于内存中的某个位置。在后一种情况下，不调用 dtor。

2.  一个好的链表实现将在列表被销毁时调用列表中所有对象的 dtor（因为您要么调用了某种方法来销毁它，要么它本身超出了范围）。这取决于实现。

3.  我对此表示怀疑，但如果那里有一些奇怪的情况，我不会感到惊讶。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-04-10T00:33:38.607

如果对象不是通过指针创建的（例如，A a1 = A();），则在对象被破坏时调用析构函数，总是在对象所在的函数完成时调用。例如：

```
void func()
{
...
A a1 = A();
...
}//finish 
```

当代码执行到“完成”行时，将调用析构函数。

如果对象是通过指针创建的（例如，A * a2 = new A();），则在删除指针时调用析构函数（delete a2;）。如果该点不是由用户显式删除或给定的在删除新地址之前，会发生内存泄漏。那是一个错误。

在链表中，如果我们使用 std::list<>，我们不需要关心析构函数或内存泄漏，因为 std::list<> 已经为我们完成了所有这些。在自己写的链表中，我们应该写析构函数并显式删除指针。否则会导致内存泄漏。

我们很少手动调用析构函数。它是为系统提供的功能。

对不起我的英语不好！

# c++ - 在声明它的类之外定义模板函数。链接错误？

> ID：10081431
> 
> 赞同：0
> 
> 时间：2012-04-10T00:08:17.933
> 
> 标签：c++, visual-studio-2010, templates, visual-c++

> **可能重复：**
> [为什么模板只能在头文件中实现？](https://stackoverflow.com/questions/495021/why-can-templates-only-be-implemented-in-the-header-file)
> [模板类 - 未解析的外部符号](https://stackoverflow.com/questions/5776862/template-class-unresolved-external-symbols)

不知道为什么会产生链接错误。任何线索？

数据流.h

```
#ifndef DATASTREAM_H
#define DATASTREAM_H

#include <vector>
#include <iostream>

class idatastream
{

public:
    idatastream();

    template<class T>void write(T data);
    bool SetPosition(int position);

    void print();
private:
    int m_position;
    std::vector<char> m_buffer;
};

#endif DATASTREAM_H 
```

数据流.cpp

```
#include "datastream.h"

    idatastream::idatastream()
    {
        m_position = 0;
    }

    template<class T>
    void idatastream::write(T data)
    {
        char * getPtr = (char *)&data
        int index = 0;
        if(m_buffer.size() < m_position)
        {
            resize(m_position);
            for(int i = m_position; i < m_position + sizeof(T); i++)
            {
                m_buffer.push_back(getPtr[index]);
                index++;
                m_position++;
            }
        }
        else if(m_buffer.size() == m_position)
        {
            for(int i = m_position; i < m_position + sizeof(T); i++)
            {
                m_buffer.push_back(getPtr[index]);
                index++;
                m_position++;
            }
        }
        else
        {
            for(int i = m_position; i < m_position + sizeof(T); i++)
            {
                m_buffer[m_position] = getPtr[index];
                index++;
                m_position++;
            }
        }

        return;
    }

bool idatastream::SetPosition(int position)
{
    if (position >= 0)
    {
        m_position = position;
        return true;
    }
    else
    {
        return false;
    }
}

void idatastream::print()
{
    for(int i = 0; i < (int) m_buffer.size(); i++)
    {
        std::cout << m_buffer[i] << "   ";
    }
    std::cout << " \n";
} 
```

主文件

```
#include "datastream.h"

int main()
{
    idatastream test;
    int meh = 6;
    int peh = 23;
    int teh = 65;

    test.write<int>(meh);
    test.write<int>(peh);
    test.write<int>(teh);

        test.print();

    return 0;
} 
```

错误：

`error LNK2019: unresolved external symbol "public: void __thiscall idatastream::write<int>(int)" (??$write@H@idatastream@@QAEXH@Z) referenced in function _main`

我只是在定义这个模板函数时犯了一个愚蠢的错误，还是 msvc 只是给我带来了麻烦？另外，如果你想在这里批评我的代码，请继续，但如果它是这样的，“哇，这是有史以来最糟糕的代码，这里用我很棒的东西代替”，无论多么正确，它都可能被忽略你是。

# php - 通过复选框启用和禁用文本框数组

> ID：10081445
> 
> 赞同：0
> 
> 时间：2012-04-10T00:11:00.160
> 
> 标签：php, javascript, checkbox, textbox

我一直在研究这个代码！我做错了。

我想要的是选中相应复选框时要启用的文本框。但是当应用该功能时没有任何反应:(

在我的代码中，文本和复选框是使用 php 从数据库动态生成的。这是我的代码：

```
<div><div class="ac-container">

<div id="accordion">

<?php

$qry="SELECT * FROM catalog";
$result= mysql_query($qry);
if($result){
while($info = mysql_fetch_array($result))
{

print "<h3><a href=\"\#\"> cat:".$info['name']."</a></h3><div>";

$qryitem="SELECT * FROM item WHERE Id=". $info['Cid'];
$resultitem=mysql_query($qryitem);
if($resultitem){

?>

<form name="form1" id="form" method="post" action="manage_item_action.php"  >
<?php
while($info=mysql_fetch_array($resultitem))
{
?>
<input type="checkbox"  id="checkB" name="op[]" value="<?php echo $info['Id'];?>" />   <?php echo $info['name'];?>
<label> Quantity <input disabled="disabled" id="textB" type="text" 
name="Quantit[]" value="<?php echo $info['Quantity'];?>"/>
</label>
<script>

 checkBoxes=document.form1.elements['op[]'];
 textBoxes=document.form1.elements['Quantit[]'];
 for(var i=0 ; i<checkBoxes.length;i++){
 checkBoxes[i].onchange = function() {
 textBoxes[i].disabled =!(this.checked);};

 }

 </script>

<br/>

        <?php
        } 
    }

 else echo "There are no items.";

 print "</div>";

}
}

?>

</div>

<input type="submit" value="update" name="submit"/>
<input type=reset value="clear"></td></tr> </form> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T01:00:58.600

您遇到的问题是在您的事件处理程序内部`i`未定义变量。为了克服这个问题，您可以为每个复选框添加一个属性以保存它们所指的索引：

```
checkBoxes=document.form1.elements['op[]'];
textBoxes=document.form1.elements['Quantit[]'];
for(var i=0 ; i<checkBoxes.length;i++)
{
    checkBoxes[i].myIndex = i;
    checkBoxes[i].onchange = function() {
        textBoxes[this.myIndex].disabled =!(this.checked);
    };
} 
```

解决此问题的其他方法：http: [//www.howtocreate.co.uk/referencedvariables.html](http://www.howtocreate.co.uk/referencedvariables.html)

您的代码仍然很混乱。例如`<div/>`，您在第一个语句中生成了太多结束`print`标签。我建议您从问题中删除 PHP 代码，因为该问题仅与 html 和 javascript 有关。

我还建议使用库来操作[jQuery](http://jquery.com/)等 DOM 元素。

在编写和调试 javascript 时，您应该始终确保收到错误消息。“什么都没有发生”表明您只是忽略了错误。对于 Firefox 下载插件`Firebug`。Safari 也有可以在设置中激活的开发者工具。使用这些工具将使发现和解决此类问题变得非常容易。

# c# - 需要将 Linq to SQL 标识值写入同一张表中的另一个字段

> ID：10081448
> 
> 赞同：1
> 
> 时间：2012-04-10T00:11:52.783
> 
> 标签：c#, linq-to-sql

ASP.NET 4.0 C#，Linq to SQL：我有一个要求，一旦创建了新行，我需要将标识值写回同一行中的另一个字段。

我试过了，但没有用（未找到或更改行）：

```
//newRow created and fields populated here
dc.Table.InsertOnSubmit(newRow);
dc.SubmitChanges();
newRow.Field = newRow.PriKey;
dc.SubmitChanges(); 
```

我还尝试将该行读入一个新变量并更新但同样的错误：

```
//newRow created and fields populated here
dc.Table.InsertOnSubmit(newRow);
dc.SubmitChanges();
row2 = (from r in dc.Table where r.PriKey = newRow.PriKey select r).FirstOrDefault();
row2.Field = newRow.PriKey;
dc.SubmitChanges(); 
```

我想我可以通过创建和执行我自己的 SQL 命令轻松地做到这一点，但有没有更简单的方法来做到这一点？

编辑：这包含在交易中的事实是否有所作为？

```
using (CMSDataContext dc = new CMSDataContext(Config.ConnString))
{
    dc.Connection.Open();
    dc.Transaction = dc.Connection.BeginTransaction(System.Data.IsolationLevel.ReadUncommitted); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T00:42:43.967

这似乎不是 LINQ2SQL 的限制，在 LINQPad 中运行以下内容似乎可以正常工作。您是否尝试过在调试器中单步执行您的代码？或者您可以发布您的真实代码以检查其他问题吗？

```
create table data
(
    ID int not null identity primary key,
    Value varchar(16) not null,
    PKStore int null
)

var newRow = new Data{Value = "MyVal"};
Data.InsertOnSubmit(newRow);
SubmitChanges();

newRow.PKStore = newRow.ID;
SubmitChanges();

Data.Dump(); //LINQPad Method 
```

输出

![在此处输入图像描述](../Images/7b4399187a58491f750f6f4260ccdbbd.png)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-04-10T00:23:32.843

尝试排序并从列表中选择第一行

```
dc.Table.InsertOnSubmit(newRow);
dc.SubmitChanges();
row2 = (from r in dc.Table  order by r.PriKey desecnding select r).FirstOrDefault();
row2.Field = row2.PriKey;
dc.SubmitChanges(); 
```

# node.js - 如何使用 Mongoose 删除数据库？

> ID：10081452
> 
> 赞同：113
> 
> 时间：2012-04-10T00:12:34.370
> 
> 标签：node.js, mongodb, mongoose

我正在 Node.js 和 Mongoose 中准备一个数据库创建脚本。如何检查数据库是否已经存在，如果存在，使用 Mongoose 删除（删除）它？

我找不到用 Mongoose 丢弃它的方法。

* * *

## 回答 #1

> 赞同：177
> 
> 时间：2012-04-10T12:01:32.837

没有办法从 mongoose 中删除一个集合，你能做的最好的就是删除 one 的内容：

```
Model.remove({}, function(err) { 
   console.log('collection removed') 
}); 
```

但是有一种方法可以访问mongodb原生的javascript驱动，可以用来做这个

```
mongoose.connection.collections['collectionName'].drop( function(err) {
    console.log('collection dropped');
}); 
```

### 警告

在尝试之前进行备份，以防出现任何问题！

* * *

## 回答 #2

> 赞同：95
> 
> 时间：2012-04-29T02:25:06.163

如果连接中不存在数据库，Mongoose 将创建一个数据库，因此一旦建立连接，您就可以查询它以查看其中是否有任何内容。

您可以删除您连接到的任何数据库：

```
var mongoose = require('mongoose');
/* Connect to the DB */
mongoose.connect('mongodb://localhost/mydatabase',function(){
    /* Drop the DB */
    mongoose.connection.db.dropDatabase();
}); 
```

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2012-06-04T14:35:15.450

如果您像这样修改@hellslam 的解决方案，那么它将起作用

我在集成测试后使用这种技术删除数据库

```
//CoffeeScript
mongoose = require "mongoose"
conn = mongoose.connect("mongodb://localhost/mydb")

conn.connection.db.dropDatabase()

//JavaScript
var conn, mongoose;
mongoose = require("mongoose");
conn = mongoose.connect("mongodb://localhost/mydb");

conn.connection.db.dropDatabase(); 
```

HTH 至少对我有用，所以我决定分享 =)

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2015-07-12T21:27:37.850

尝试了@hellslam 和@silverfighter 的答案。我发现一个比赛条件阻碍了我的测试。在我的情况下，我正在运行 mocha 测试，并且在测试的前功能中我想擦除整个数据库。这对我有用。

```
var con = mongoose.connect('mongodb://localhost/mydatabase');
mongoose.connection.on('open', function(){
    con.connection.db.dropDatabase(function(err, result){
        done();
    });
}); 
```

你可以阅读更多[https://github.com/Automattic/mongoose/issues/1469](https://github.com/Automattic/mongoose/issues/1469)

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2017-12-12T18:46:10.120

如果您偏爱 Promise，则为 4.6.0+ 提供更新的答案（[请参阅文档](http://mongoosejs.com/docs/connections.html)）：

```
mongoose.connect('mongodb://localhost/mydb', { useMongoClient: true })
.then((connection) => {
   connection.db.dropDatabase();
   // alternatively:
   // mongoose.connection.db.dropDatabase();
}); 
```

我使用 mongoose 4.13.6 在自己的代码中测试了这段代码。另外，请注意该`useMongoClient`选项的使用（[请参阅文档](http://mongoosejs.com/docs/connections.html#use-mongo-client)）。文件表明：

> Mongoose 的默认连接逻辑自 4.11.0 起已弃用。请使用 useMongoClient 选项选择新的连接逻辑，但如果您要升级现有代码库，请确保首先测试您的连接！

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2013-03-27T19:26:29.037

我在使用其他解决方案时遇到的困难是，如果您想让索引再次工作，它们依赖于重新启动您的应用程序。

为了我的需要（即能够对所有集合进行单元测试，然后重新创建它们以及它们的索引），我最终实现了这个解决方案：

*这依赖[underscore.js](http://underscorejs.org/)和[async.js](https://github.com/caolan/async)库以并行方式组装索引，如果您反对该库，它可能会被取消，但我将其作为开发人员的练习器。*

```
mongoose.connection.db.executeDbCommand( {dropDatabase:1}, function(err, result) {
  var mongoPath = mongoose.connections[0].host + ':' + mongoose.connections[0].port + '/' + mongoose.connections[0].name
  //Kill the current connection, then re-establish it
  mongoose.connection.close()
  mongoose.connect('mongodb://' + mongoPath, function(err){
    var asyncFunctions = []

    //Loop through all the known schemas, and execute an ensureIndex to make sure we're clean
    _.each(mongoose.connections[0].base.modelSchemas, function(schema, key) {
      asyncFunctions.push(function(cb){
        mongoose.model(key, schema).ensureIndexes(function(){
          return cb()
        })
      })
    })

    async.parallel(asyncFunctions, function(err) {
      console.log('Done dumping all collections and recreating indexes')
    })
  })
}) 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2016-11-30T00:17:26.757

从 Mongoose 开始，这对我有用`v4.7.0`：

```
mongoose.connection.dropDatabase(); 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2013-07-03T12:48:51.540

**要清空数据库中的特定集合：**

```
model.remove(function(err, p){
    if(err){ 
        throw err;
    } else{
        console.log('No Of Documents deleted:' + p);
    }
}); 
```

笔记：

1.  选择一个引用特定模式的模型（您希望删除的集合模式）。
2.  此操作不会从数据库中删除集合名称。
3.  这将删除集合中的所有文档。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2017-03-17T14:33:34.130

在 Mongoose 中删除数据库的最佳方法取决于您使用的 Mongoose 版本。如果您使用的是 4.6.4 或更高版本的 Mongoose，那么在该版本中添加的此方法可能对您有效：

```
mongoose.connection.dropDatabase(); 
```

在旧版本中，此方法不存在。相反，您将使用直接的 MongoDB 调用：

```
mongoose.connection.db.dropDatabase(); 
```

但是，如果它是在创建数据库连接之后运行的，它可能会静默失败。这与连接实际上是异步的并且在命令发生时尚未建立有关。这对于其他 Mongoose 调用（例如 ）通常不是问题`.find()`，它会排队等待连接打开然后运行。

如果您查看`dropDatabase()`添加的快捷方式的源代码，您会发现它旨在解决这个确切的问题。它检查连接是否打开并准备好。如果是这样，它会立即触发命令。如果没有，它会在数据库连接打开时注册要运行的命令。

上面的一些建议建议*始终*将您的`dropDatabase`命令放在`open`处理程序中。但这仅适用于连接尚未打开的情况。

```
Connection.prototype.dropDatabase = function(callback) {
  var Promise = PromiseProvider.get();
  var _this = this;
  var promise = new Promise.ES6(function(resolve, reject) {
    if (_this.readyState !== STATES.connected) {
      _this.on('open', function() {
        _this.db.dropDatabase(function(error) {
          if (error) {
            reject(error);
          } else {
            resolve();
          }
        });
      });
    } else {
      _this.db.dropDatabase(function(error) {
        if (error) {
          reject(error);
        } else {
          resolve();
        }
      });
    }
  });
  if (callback) {
    promise.then(function() { callback(); }, callback);
  }
  return promise;
}; 
```

这是上述逻辑的一个简单版本，可以与早期的 Mongoose 版本一起使用：

```
// This shim is backported from Mongoose 4.6.4 to reliably drop a database
// http://stackoverflow.com/a/42860208/254318
// The first arg should be "mongoose.connection"
function dropDatabase (connection, callback) {
    // readyState 1 === 'connected'
    if (connection.readyState !== 1) {
      connection.on('open', function() {
        connection.db.dropDatabase(callback);
      });
    } else {
      connection.db.dropDatabase(callback);
    }
} 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2017-08-07T09:54:27.607

猫鼬 4.6.0+：

```
mongoose.connect('mongodb://localhost/mydb')
mongoose.connection.once('connected', () => {
    mongoose.connection.db.dropDatabase();
}); 
```

传递回调连接将不再起作用：

*TypeError：无法读取 null 的属性“commandsTakeWriteConcern”*

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2020-12-10T06:36:25.987

2020 年更新

制作一个新文件，将其命名为 drop.js，即放入其中

```
require('dotenv').config()
const url = process.env.ATLAS_URI;
mongoose.connect(url, {
  useNewUrlParser: true,
  useCreateIndex: true,
  useUnifiedTopology: true,
  useFindAndModify: false
});

const connection = mongoose.connection;
connection.once('open', () => {
  console.log("MongoDB database connection established successfully");
})

mongoose.connection.dropDatabase().then(
  async() => {

    try {
      mongoose.connection.close()

    }
    catch (err) {
      console.log(err)
    }

 }

); 
```

在你的 package.json

```
in your package.json 
 "scripts": {

    "drop": "node models/drop.js",

  } 
```

在您的控制台上运行它并

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2018-07-01T09:04:03.427

```
beforeEach((done) => {
      mongoose.connection.dropCollection('products',(error ,result) => {
      if (error) {
        console.log('Products Collection is not dropped')
      } else {
        console.log(result)
      }
    done()
    })
  }) 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2020-06-07T16:37:42.647

要删除集合中的所有文档：

```
await mongoose.connection.db.dropDatabase(); 
```

这个答案基于 mongoose index.d.ts 文件：

```
dropDatabase(): Promise<any>; 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2020-11-06T10:09:25.750

```
mongoose.connect(`mongodb://localhost/${dbname}`, {
        useNewUrlParser: true,
        useCreateIndex: true,
        useFindAndModify: true,
        useUnifiedTopology: true
    })
        .then((connection) => {
            mongoose.connection.db.dropDatabase();
        }); 
```

要删除一个完整的数据库，只需传递名称...这个在 4.4 版上运行良好

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2020-04-30T09:06:07.253

由于 mongoose 库中的 remove 方法已被弃用，我们可以使用不传递参数的 deleteMany 函数。

```
Model.deleteMany(); 
```

这将删除此特定模型的所有内容，您的收藏将是空的。

* * *

## 回答 #16

> 赞同：-2
> 
> 时间：2017-04-06T00:09:43.413

要删除集合中的所有文档：

```
myMongooseModel.collection.drop(); 
```

如[测试所示](https://github.com/Automattic/mongoose/blob/67c465aac5c864c3004d11d49934605037c8f520/test/shard.test.js#L297)

# ruby - 使用 Ruby 的数据驱动开发框架

> ID：10081453
> 
> 赞同：0
> 
> 时间：2012-04-10T00:12:35.497
> 
> 标签：ruby, testing, frameworks, tdd, bdd

有人知道 Ruby 的一个好的数据驱动开发框架/库/gem 吗？我对 Rails 了解很多，但我找不到 Ruby 本身的任何东西。我有一个独立的 Ruby 应用程序，我想生成测试数据并为不同的数据集编写测试用例。我不想使用固定装置。有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T03:49:54.920

你是说[机械师之](https://github.com/notahat/machinist)类的吗？自述文件提到它可以在没有 Rails 的情况下工作。

# android - 无缘无故我的 Android 应用程序停止运行。？

> ID：10081454
> 
> 赞同：0
> 
> 时间：2012-04-10T00:12:36.087
> 
> 标签：android, exception-handling

我的应用程序在我开发它的整个过程中一直运行良好，但它突然停止工作。它甚至在打开之前就在开始时崩溃。同样的事情发生在手机或模拟器上。我返回了一些过去也可以正常工作的版本，但它们无法正常工作。

这可能与android.jar有关吗？

这是LogCat：

```
04-09 23:59:00.065: I/Process(10872): Sending signal. PID: 10872 SIG: 9
04-10 00:01:29.875: D/AndroidRuntime(11072): Shutting down VM
04-10 00:01:29.875: W/dalvikvm(11072): threadid=1: thread exiting with uncaught exception (group=0x4001d560)
04-10 00:01:29.875: E/AndroidRuntime(11072): FATAL EXCEPTION: main
04-10 00:01:29.875: E/AndroidRuntime(11072): java.lang.RuntimeException: Unable to instantiate activity ComponentInfo{com.heatscore.pregame/com.heatscore.pregame.appMain}: java.lang.ClassNotFoundException: com.heatscore.pregame.appMain in loader dalvik.system.PathClassLoader[/data/app/com.heatscore.pregame-1.apk]
04-10 00:01:29.875: E/AndroidRuntime(11072):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1581)
04-10 00:01:29.875: E/AndroidRuntime(11072):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1675)
04-10 00:01:29.875: E/AndroidRuntime(11072):    at android.app.ActivityThread.access$1500(ActivityThread.java:121)
04-10 00:01:29.875: E/AndroidRuntime(11072):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:943)
04-10 00:01:29.875: E/AndroidRuntime(11072):    at android.os.Handler.dispatchMessage(Handler.java:99)
04-10 00:01:29.875: E/AndroidRuntime(11072):    at android.os.Looper.loop(Looper.java:123)
04-10 00:01:29.875: E/AndroidRuntime(11072):    at android.app.ActivityThread.main(ActivityThread.java:3701)
04-10 00:01:29.875: E/AndroidRuntime(11072):    at java.lang.reflect.Method.invokeNative(Native Method)
04-10 00:01:29.875: E/AndroidRuntime(11072):    at java.lang.reflect.Method.invoke(Method.java:507)
04-10 00:01:29.875: E/AndroidRuntime(11072):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:862)
04-10 00:01:29.875: E/AndroidRuntime(11072):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:620)
04-10 00:01:29.875: E/AndroidRuntime(11072):    at dalvik.system.NativeStart.main(Native Method)
04-10 00:01:29.875: E/AndroidRuntime(11072): Caused by: java.lang.ClassNotFoundException: com.heatscore.pregame.appMain in loader dalvik.system.PathClassLoader[/data/app/com.heatscore.pregame-1.apk]
04-10 00:01:29.875: E/AndroidRuntime(11072):    at dalvik.system.PathClassLoader.findClass(PathClassLoader.java:240)
04-10 00:01:29.875: E/AndroidRuntime(11072):    at java.lang.ClassLoader.loadClass(ClassLoader.java:551)
04-10 00:01:29.875: E/AndroidRuntime(11072):    at java.lang.ClassLoader.loadClass(ClassLoader.java:511)
04-10 00:01:29.875: E/AndroidRuntime(11072):    at android.app.Instrumentation.newActivity(Instrumentation.java:1021)
04-10 00:01:29.875: E/AndroidRuntime(11072):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1573)
04-10 00:01:29.875: E/AndroidRuntime(11072):    ... 11 more 
```

这是我的清单文件。

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.heatscore.pregame"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk android:minSdkVersion="8" />

    <application android:icon="@drawable/icon" android:theme="@style/app_theme" >
        <activity android:name=".appMain" android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />
                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>

        <activity android:name="Login"/>
        <activity android:name="MgtRecPredActivity"/>
        <activity android:name="Tabs"/>
        <activity android:name="ScheduleActivity"/>
        <activity android:name="PredictionsActivity"/>
        <activity android:name="ScoreboardActivity"/>
        <activity android:name="AlertsActivity"/>
        <activity android:name="SettingsActivity"/>
        <activity android:name="AboutActivity"/>
        <activity android:name="LogoutActivity"/> 
        <activity android:name="SetPrediction"/> 
        <activity android:name="FinalizePredictionActivity"/>   
        <activity android:name="RegisterAcitvity" android:windowSoftInputMode="stateHidden"/>     

    </application>

    <uses-permission android:name="android.permission.INTERNET"/>

</manifest> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T00:35:53.333

如果您使用的是 Eclipse，请尝试“清理项目”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T02:06:47.410

您的异常是 ClassNotFoundException。如果类在您的应用程序内部，则 Eclipse 不应该编译。也许一些外部参考损坏了？

# android - 在 Galaxy Tab 上禁用视频输出

> ID：10081457
> 
> 赞同：1
> 
> 时间：2012-04-10T00:12:57.020
> 
> 标签：android, galaxy-tab, samsung-mobile

我正在尝试以编程方式阻止 Galaxy 选项卡上的电视输出功能，并查看源代码我无法找到任何可用于执行此操作的内容。

# ruby-on-rails - Rails 嵌套模型/JSON 请求构造混乱

> ID：10081459
> 
> 赞同：2
> 
> 时间：2012-04-10T00:13:09.973
> 
> 标签：ruby-on-rails, json, nested-attributes, ruby-on-rails-3.2

我有两种类型的 Rails 对象帖子和评论。假设每个帖子`has_many`评论，每个评论`belongs_to`一个帖子。

当我构建我的评论 JSON 字符串时，我会这样做：

`{"id":0,"title":"something","body":"something","post_id":1}`

但我回来了

`{"id":0,"title":"something","body":"something","post_id":NULL}`

我将 POST json 请求发送到：`/comments.json`因为在这种情况下 Post 对象是一个单例。

这是我的路线：

```
 resources :posts
  resources :comments 
```

有人知道我可以在这里解决什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T02:34:54.180

我的猜测是你不能massasign了`post_id`。

`post_id`您可以通过将此行添加到您的模型来允许仅针对 的质量分配：

```
attr_accessible :post_id 
```

[在这里](http://guides.rubyonrails.org/security.html#mass-assignment)查看更多信息。

# ruby - 为什么 SQLite3 中的 LIKE 在此语句中有效但 = 无效？

> ID：10081461
> 
> 赞同：1
> 
> 时间：2012-04-10T00:13:50.657
> 
> 标签：ruby, sqlite, md5

我使用 SQLite3 并有一个名为 blobs 的表来存储*内容*和 *hash_value*。

这是架构：

```
CREATE TABLE "blobs" (
  "id" INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL,
  "content" blob,
  "hash_value" text,
  "created_at" datetime NOT NULL,
  "updated_at" datetime NOT NULL
); 
```

现在我插入了一些数据。看起来像这样：

```
1|--- foo
...
|34dc86f45b3dc92b352fd45f525192c0|2012-04-09 17:02:54.219504|2012-04-09 17:02:54.219504 
```

我尝试了以下两个查询：

*   `select * from blobs where hash_value = '34dc86f45b3dc92b352fd45f525192c0';`
*   `select * from blobs where hash_value LIKE '34dc86f45b3dc92b352fd45f525192c0';`

第一个不起作用，但第二个起作用。我不明白为什么`=`操作员不工作。

我试图将其分解为一个简单的示例，其中我的哈希只是`'abc'`并且 = 有效。我的意思是这个字符串几乎不会太长。

### 编辑

好的，我实际上将其范围缩小到：

*   我正在使用 Ruby 生成这样的哈希`Digest::MD5.hexdigest("foobar")`
*   这会生成一个这样的字符串：`'3858f62230ac3c915f300c664312c63f'`
*   我的测试看起来有点像这样：`b = Blob.new(...);b.save!;Blob.find_by_hash(b.hash)`
*   find_hash 是`Blob.find(:all, :conditions => ["hash_value = ?", hash_value])`
*   如果我将哈希手动设置为`'3858f62230ac3c915f300c664312c63f'`（硬编码字符串），它会起作用。
*   但是如果生成了这个字符串，我会收到以下错误：

    ```
    Failure/Error: Blob.find_by_hash(b.hash_value)[0].load.should == txt
     ArgumentError: wrong number of arguments (0 for 1) 
    ```

而且我无法如上所述查询 SQLite3。

**解决方案**

解决方案是：

*   而不是使用 Digest::MD5.hexdigest("foobar") 使用 Digest::MD5.base64digest("foobar")

我不知道为什么 sqlite3 与 hexdigest 有问题，但肯定有一些可疑之处。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T12:12:29.663

两者的区别在于编码：

```
Digest::MD5.hexdigest("foobar").encoding #=>  #<Encoding:ASCII-8BIT> 
Digest::MD5.base64digest("foobar").encoding #=> #<Encoding:US-ASCII> 
```

我不认为 hexdigest 具有 8 位编码的特殊原因（这实际上意味着“这是原始数据”，但 ruby​​ 似乎就是这样做的。当 ruby​​ sqlite3 驱动程序看到带有 ascii-8bit 编码的东西时，它会绑定查询的值作为 blob，而不是文本。这反过来会影响 sqlite3 进行比较的方式（尽管我不完全了解如何进行比较）。

另请参阅[此问题](https://stackoverflow.com/questions/6575334/rails-saving-plain-old-string-to-sqlite-as-blob-im-about-to-lose-my-mind)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T09:56:55.720

解决方案是：

而不是使用 Digest::MD5.hexdigest("foobar") 使用 Digest::MD5.base64digest("foobar")。我不知道为什么 sqlite3 与 hexdigest 有问题，但肯定有一些可疑之处。

# jquery - 是否可以将时间跨度分配给 DIV 的背景图像

> ID：10081462
> 
> 赞同：0
> 
> 时间：2012-04-10T00:13:53.237
> 
> 标签：jquery, css

是否可以将时间跨度分配给 DIV 的背景图像？

你们知道我是否可以用 jQuery 做到这一点吗？我希望第一张图片停留 20 秒，第二张图片停留 5 秒。所以他们应该互相改变。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T00:23:03.060

在您的文档中使用类似的东西准备好......

```
setTimeout("ChangeToBlue();", 20000); 
```

然后……函数……

```
function ChangeToBlue()
{
    $("#background").css("background-color", "blue");
} 
```

我将背景设置为一种颜色......但同样的想法。如果您希望它来回切换，请在函数中设置另一个超时。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T02:03:22.803

你可以像这样使用fadeToggle [http://jsfiddle.net/cwsUF/1/](http://jsfiddle.net/cwsUF/1/)

# java - Java 映射混合类型

> ID：10081463
> 
> 赞同：7
> 
> 时间：2012-04-10T00:13:53.827
> 
> 标签：java, hashmap

我正在寻找一种方法来创建映射到混合类型的 HashMap。

例如，以下将在 Python 中工作（注意 Python`dict`类似于 Java `HashMap`）：

```
d = dict()
d["str"] = "This is a string"
d["flt"] = 1.23
d["int"] = 5 
```

并且在访问时`d[x]`，将返回适当的类型（本例中为字符串、浮点数、整数）。

在 Java 中，我可以使用 a `HashMap<String, Object>`，但我真的没有办法立即判断每个 Object 是什么类型。

因此，相反，我目前正在尝试创建一个`MixedType`包含对象的类，以及它的原始类型信息，以便我以后可以向下转换它。例如：

```
public class MixedMap
    public static class MixedType
    {
        public Class<?> cls;
        public Object val;

        public MixedType(Class<?> c, Object v)
        {
            this.cls = c;
            this.val = v;
        }
    }

    public static void main(String args[])
    {   
        MixedType m1 = new MixedType(String.class, "This is a String");
        System.out.println((m1.cls)m1.val);
    }
} 
```

请注意，这是我正在*尝试*做的 :-) 因为它目前没有编译抱怨`m1 cannot be resolved to a type`。

所以我的问题是，我该如何解决这个问题？实现相同目标的其他方法将受到欢迎，但请不要回答告诉我这限制了编译器的类型检查能力——我知道并且可以接受。

提前致谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-10T00:17:07.617

正确的做法是`m1.cls.cast(m1.val)`，但与平原相比，您几乎肯定不会获得任何收益 `Map<String, Object>`。一种更简单的方法可以让您获得完全相同的类型安全性和完全相同的信息 - 也就是说，不多 - 只是在地图中的值`getClass()`上使用该方法。`Object`

这一切都无法实现你能够说的目标`String value = map.get("str")`——只有一个彻底的演员才能做到这一点。你可以做

```
Object value = map.get("str");
if (value instanceof String) {
  // do stringy things
} 
```

或类似的规定。

如果您在编译时知道值的使用点的类型，那么到目前为止最好的解决方案就是继续在使用点进行强制转换。像这样进行配置的“理想”方法通常不是使用 a `Map`，而是构建一个`Configuration`在编译时知道其字段及其类型的自定义类，但如果你想使用 a `Map`，那么直接进行强制转换是可能是你最好的选择。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-10T02:23:43.983

我之前已经实现了类似的东西。您可以使用泛型来提供帮助。你想要的是一个`MixedKey`，你可以用它作为一个键`MixedMap`。这些方面的东西：

```
public class MixedKey<T> {
    public final Class<T> cls;
    public final String key;

    public MixedKey(T cls, String key) {
        this.key = key;
        this.cls = cls;
    }

    // also implement equals and hashcode
} 
```

.

```
public class MixedMap extends HashMap<MixedKey<?>,Object> {
    public <T> T putMixed(MixedKey<T> key, T value) {
        return key.cls.cast(put(key, value));
    }

    public <T> T getMixed(MixedKey<T> key) {
        return key.cls.cast(get(key));
    }
} 
```

做这样的事情的好处是，如果你错误地使用了错误的类型，它会给你一个编译时错误，这是直接强制转换所没有的：

```
MixedKey<Integer> keyForIntProperty
    = new MixedKey<Integer>(Integer.class, "keyForIntProperty");

// ...

String str = mixedMap.getMixed(keyForIntProperty); // compile-time error 
```

对比

```
String str = (String)map.get("keyForIntProperty"); // run-time error only 
```

# php - 将网页转换为图像（缩略图）

> ID：10081470
> 
> 赞同：3
> 
> 时间：2012-04-10T00:14:56.770
> 
> 标签：php, ajax, image, web, gd

> **可能重复：**
> [如何使用 Highcharts 导出整个页面或 html 内容而不仅仅是图表？](https://stackoverflow.com/questions/10328457/how-to-export-the-whole-page-or-html-content-with-highcharts-not-just-the-chart)

我希望能够从给定的网址即时生成缩略图（并将其存储以备将来使用）。这需要在服务器（linux）上完成，而不需要使用太多资源。

或者，有没有办法在客户端上“隐形”执行此操作，然后通过 AJAX cal 或其他方式将屏幕截图上传到服务器？

谢谢。

# ruby-on-rails - Rails SMTPAuthenticationError 操作邮件程序

> ID：10081474
> 
> 赞同：1
> 
> 时间：2012-04-10T00:15:27.327
> 
> 标签：ruby-on-rails, ruby-on-rails-3, nginx, actionmailer

我已经开发了一个 Rails 3 应用程序，并且我最近添加了一个用户注册时的操作邮件。
在本地测试它并完美地发送一封电子邮件，但是当我将它移动到服务器以测试它以供新用户注册时，我收到以下错误。

我正在使用原始配置的服务器上运行 Nginx，本地机器和服务器都运行 ubuntu 11.10

用户控制器中的 Net::SMTPAuthenticationError#create
535-5.7.1 用户名和密码不被接受。
app/controllers/users_controller.rb:26:in 'create'

在 users_controller.rb - create - 第 26 行是`UserMailer.welcome_email(@user).deliver`

```
 def create
    @user = User.new(params[:user])
    if @user.save
      sign_in @user
      flash[:success] = "Welcome to University Sports!"
      redirect_to @user
      UserMailer.welcome_email(@user).deliver
    else
      @title = "Sign up"
      render 'new'
    end
  end 
```

在 development.rb 我有以下代码：

```
 config.action_mailer.delivery_method = :smtp
  config.action_mailer.smtp_settings = {
    :address              => 'smtp.gmail.com',
    :port                 => 587,
    :domain               => 'www.mydomain.co.uk',
    :user_name            => 'email@mydomain.co.uk',
    :password             => 'email_password',
    :authentication       => 'plain',
    :enable_starttls_auto => true  } 
```

user_mailer.rb

```
class UserMailer < ActionMailer::Base
  default :from => "univeristy.sports@louisgriffiths.co.uk"

  def welcome_email(user)
    @user = user
    @url  = "http://www.mydomain:3000"
    mail(:to => user.email, :subject => "Welcome to University Sports")
  end
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-29T08:45:54.920

我遇到了完全相同的错误，发现我的 application.yml 文件覆盖了它，所以我删除了它，现在它可以正常工作了！

# facebook - Facebook 评论整合

> ID：10081478
> 
> 赞同：0
> 
> 时间：2012-04-10T00:16:18.320
> 
> 标签：facebook, comments, facebook-fql

我正在建立一个显示几个 Facebook 相册的网站，我正在使用 FQL 检索这些相册。我还想为每张照片添加评论插件和所有现有的 Facebook 评论。

当我添加这个：

```
<div class="fb-comments" data-href="[some facebook photo url]" data-num-posts="4" data-width="300"></div> 
```

它不包括已经在 Facebook 上对这张照片发表的所有评论。同样，当我使用我网站的评论框发表评论时，它不会出现在 Facebook 中该照片的下方。

我猜评论插件没有那个功能：在使用 Facebook url 时将我的网站评论与 Facebook 评论同步？

谁能指出我正确的方向？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T00:29:07.423

默认情况下，照片不附带评论。您必须通过 graph.facebook.com/PHOTO_ID/comments 获取它们。

# r - 在 R 中求解函数的逆

> ID：10081479
> 
> 赞同：25
> 
> 时间：2012-04-10T00:16:19.073
> 
> 标签：r, inverse

有没有办法`R`解决给定单变量函数的逆？我的动机是稍后告诉我`R`使用值向量作为反函数的输入，以便它可以吐出反函数值。

例如，我有函数`y(x) = x^2`，反函数是`y = sqrt(x)`。有没有办法`R`解决反函数？

我查了一下`uniroot()`，但我没有解决函数的零。

任何的意见都将会有帮助。

谢谢！

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-04-10T00:30:18.900

你找到什么样的逆？如果您正在寻找符号逆（例如，与 sqrt(x) 相同的函数 y），您将不得不使用符号系统。查看[ryacas](http://code.google.com/p/ryacas/)的 R 库以连接可能计算逆的计算机代数系统，Yacas。

现在，如果您只需要计算逐点逆，您可以按照您所写的 uniroot 定义您的函数：

```
> inverse = function (f, lower = -100, upper = 100) {
   function (y) uniroot((function (x) f(x) - y), lower = lower, upper = upper)[1]
}

> square_inverse = inverse(function (x) x^2, 0.1, 100)

> square_inverse(4)
[1] 1.999976 
```

对于给定的`y`and `f(x)`，这将计算`x`出`f(x) = y`，也称为逆。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-08-13T09:46:19.413

我无法发表评论，因为我的声誉太低了。我是 R 的新手，我花了一段时间才理解 Mike 的代码，因为我不习惯在他的回答中定义函数的方式。下面是 Mike 的代码，代码较长，但（对我而言）更易读：

```
inverse <- function(f, lower, upper){
  function(y){
    uniroot(function(x){f(x) - y}, lower = lower, upper = upper, tol=1e-3)[1]
  }
}
square_inverse <- inverse(function(x){x^2}, 0.1, 100)
square_inverse(4) 
```

我希望它也可以帮助其他新手。

# mysql - 如果值大于当前值，则 MySQL 更新

> ID：10081481
> 
> 赞同：20
> 
> 时间：2012-04-10T00:16:52.717
> 
> 标签：mysql

我将继续发布我可怕的 MySQL 代码：

```
INSERT INTO monthlystats (id, server, time, uptime, players, rank) 
VALUES (09126, 6, 0912, 302, 0, 1) 
ON DUPLICATE KEY UPDATE uptime = if(302 > uptime, 302, uptime), if(0 > players, 0, players), if(1 > rank, 1, rank) 
```

好的，让我解释一下我正在尝试做什么。

1.  “id”具有唯一索引。如果该索引尚不存在，我想插入这些值。
2.  如果有重复的键，我想改为更新 3 个字段中的每一个，只有当新值大于表中当前的值时。

看起来我做错了什么，坦率地说，我不知道该怎么做。我试着让它变好，但结果却是一团糟。

我希望有人能引导我朝着正确的方向前进，并帮助我（以及任何其他试图学习的人）学习如何做这样的事情。谢谢你。

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-04-10T00:22:46.580

您的查询看起来不错，但为了清楚起见，您可以改进它：

```
INSERT INTO monthlystats (id, server, time, uptime, players, rank) 
  VALUES (09126, 6, 0912, 302, 0, 1) 
ON DUPLICATE KEY UPDATE 
  uptime = GREATEST(uptime, VALUES(uptime)), 
  players = GREATEST(players, VALUES(players)),
  rank = GREATEST(rank, VALUES(rank)) 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-10T00:21:46.430

[您可以使用VALUES](http://dev.mysql.com/doc/refman/5.5/en/miscellaneous-functions.html#function_values)函数避免一些重复。其他事情在您的查询中都很好

```
INSERT INTO monthlystats (id, server, time, uptime, players, rank) 
VALUES (09126, 6, 0912, 302, 0, 1) 
ON DUPLICATE KEY UPDATE uptime = if(VALUES(uptime) > uptime, VALUES(uptime), uptime) 
```

# java - Java 未命名对象

> ID：10081490
> 
> 赞同：0
> 
> 时间：2012-04-10T00:17:52.267
> 
> 标签：java, android, object, new-operator, anonymous-class

我已经学习编码两个月了。我在 Android 平台上使用 Java。我试图更好地理解未命名的对象。

参考本例的第 7 行，“this.button2.setOnClickListener(new OnClickListener(){...});”

a) OnClickListener 是一个对象吗？（我认为是，因为使用了“new”关键字）

b) 可以（并且应该）命名它吗？

c) 它将如何命名？

d) 将来人们会如何提及它？是否可以？如果需要，可以在运行时修改它吗？

e) 这行得通吗？：“this.button2.setOnClickListener(OnClickListener namedObject = new OnClickListener(){//methods go here});”

```
@Override
public void onCreate(Bundle savedInstanceState)
{
    super.onCreate(savedInstanceState); 
    setContentView(R.layout.main2);     
    this.button2 = (Button) this.findViewById(R.id.button2);    
    this.button2.setOnClickListener(new OnClickListener()   
    {
        public void onClick(View v) 
        {                       
            Intent i = new Intent(getApplicationContext(), Absolute.class);
            startActivity(i);
        }
    });
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-10T00:21:28.597

**a)**是的，它是一个对象。

**b)**是的，它可以被命名，但它不一定必须是（如果您将来不需要引用它，或者有其他引用它的方式）。

**c)**你可以这样做：

```
OnClickListener myOnClickListener = new OnClickListener() {
    // Contents of the OnClickListener go here...
}
this.button2.setOnClickListener(myOnClickListener); 
```

**d)**如果您已命名它（如上所示），则可以通过名称来引用它。如果您通过在对象上调用任何 mutator 方法来引用它，则可以在运行时引用它。

**e)**该语法无效。有关进行此调用的正确方法，请参见 (c)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T00:21:50.037

正如您所怀疑的，OnClickListener 是一个对象，被称为匿名类/对象。它不需要命名，因为它被用作对象 button2 的“回调”。这意味着您正在向 button2 传递一个对象，而 button2 将委托两个工作。在这种情况下，这项工作就是单击按钮时发生的一切。

因此，当单击按钮时，它将调用您在此处设置的对象。为了发挥作用，必须定义“onClick”方法，您可以在代码示例中执行此操作。因为该方法存在，所以 button2 能够调用它，并执行您提供的代码 - 在本例中创建一个 Intent 对象并启动一个活动。

因为它是在函数调用中声明的，所以一旦该函数调用完成，它就会超出范围并且您无法引用它。由于这个原因没有特别的理由来命名它（button2 将有一个您无权访问或关心的内部名称）。如果您在函数调用之外声明该类，您可以命名它并稍后引用它......但通常这不是必需的。

我认为它可以在运行时进行修改，但除非必要，否则应该避免这种复杂性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-10T00:24:50.293

这是java的匿名类。
不需要命名，当然可以命名，但是如果类只使用一次，为了方便可以使用匿名类。
新的 onclicklistener() 表示这个匿名类是从 onclicklistener 派生的。
您可能还想在匿名类中实现一些接口。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-10T00:30:14.383

一种。OnClickListener 是一个类型（抽象类/接口），恰好有一个方法需要实现。在这种情况下，您只需实现缺少的方法“内联”b。它可以被命名。但不应该有这样的事情。这是一个选择问题。如果你打算多次重复使用同一个对象，你可以命名它。

C。通过实施内联，如：

```
OnClickListener ocl = new OnClickListener() {
    public void onClick() {
       ...
    }
}

OR

public class MyOnClickListener extends OnClickListener {
    public void onClick() {
       ...
    }
}
OnClickListener ocl = new MyOnClickListener() 
```

我假设 OnClickListener 是一个抽象类。如果它是一个接口，您只需将单词extends 更改为implements。其余的保持不变。

d。如果将其分配给变量，则可以这样引用。如果内联实现，则无法引用实现。

e. 在参数中分配变量无效。

# regex - 分析字母数字字符串的格式

> ID：10081492
> 
> 赞同：2
> 
> 时间：2012-04-10T00:18:08.683
> 
> 标签：regex, vba

我正在尝试编写一个函数，该函数接受一个字符串，对其进行解析，然后返回另一个字符串，该字符串总结了原始字符串中连续字母或数字字符的数量。

例如，字符串`999aa45bbx`将返回`3N2A2N3A`，即

*   3个数字，
*   其次是 2 个阿尔法，
*   由2个数字，
*   3 阿尔法。

我正在使用该功能来分析保险单 ID 号的格式。到目前为止，我在网上找到了提取字母或数字字符的解决方案，但没有描述这些字符在原始字符串中存在的格式或顺序。

任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-10T02:50:42.017

像这样的正则表达式将完成这项工作

*   同时按[alt](/questions/tagged/alt "显示标记为“alt”的问题") [f11](/questions/tagged/f11 "显示标记为“f11”的问题")进入 VBE
*   插入模块
*   复制并粘贴下面的代码
*   同时按[alt](/questions/tagged/alt "显示标记为“alt”的问题") [f11](/questions/tagged/f11 "显示标记为“f11”的问题")返回 Excel

那么您可以在 Excel 中使用该函数（它也检测无效字符串），即在 B1 中
`=AlphaNumeric(A1)`

![在此处输入图像描述](../Images/e827c8577d90e364c7532184cb1a4af0.png)

```
Function AlphaNumeric(strIn As String) As String
    Dim objRegex As Object
    Dim objRegMC As Object
    Dim objRegM As Object
    Dim strOut As String
    Set objRegex = CreateObject("vbscript.regexp")
    With objRegex
        .Global = True
        .ignorecase = True
        .Pattern = "[^\w]"
        If .test(strIn) Then
            AlphaNumeric = "One or more characters is invalid"
        Else
            .Pattern = "(\d+|[a-z]+)"
            Set objRegMC = .Execute(strIn)
            For Each objRegM In objRegMC
                strOut = strOut & (objRegM.Length & IIf(IsNumeric(objRegM), "N", "A"))
            Next
            AlphaNumeric = strOut
        End If
    End With
End Function 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-10T09:15:45.040

老派，遍历字符串中的所有字符：

```
Function IdentifyCharacterSequences(s As String) As String
    Dim i As Long
    Dim charCounter As Long
    Dim currentCharType As String
    Dim sOut As String

    sOut = ""
    charCounter = 1
    currentCharType = CharType(Mid(s, 1, 1))

    For i = 2 To Len(s)
        If (Not CharType(Mid(s, i, 1)) = currentCharType) Or (i = Len(s)) Then
            sOut = sOut & charCounter & currentCharType
            currentCharType = CharType(Mid(s, i, 1))
            charCounter = 1
        Else
            charCounter = charCounter + 1
        End If
    Next i

    IdentifyCharacterSequences = sOut
End Function 
```

这使用以下辅助函数。请注意，非字母数字字符使用字母“X”标识。您可以轻松修改它以适合您的目的。

```
Function CharType(s As String) As String
    If s Like "[A-z]" Then
        CharType = "A"
    ElseIf s Like "[0-9]" Then
        CharType = "N"
    Else
        CharType = "X"
        'Or raise an error if non-alphanumerical chars are unacceptable.
    End If
End Function 
```

使用示例：

![在此处输入图像描述](../Images/7c1e09a123f44f55e0818c5eedcaac64.png)

# iphone - 使用 Core Data 插入/删除异常

> ID：10081493
> 
> 赞同：2
> 
> 时间：2012-04-10T00:18:10.893
> 
> 标签：iphone, objective-c, ios, uitableview, core-data

虽然这不是故障/错误，但它作为一个例外出现。当我尝试使用核心数据删除或插入对象时，第一次插入或删除显示以下错误：

> 2012-04-09 18:57:32.201 SEA[7437:fb03] *** -[UITableView _endCellAnimationsWithContext:] 中的断言失败，/SourceCache/UIKit_Sim/UIKit-1912.3/UITableView.m:1046 2012-04-09 18:57： 32.203 SEA[7437:fb03] CoreData：错误：严重的应用程序错误。在调用 -controllerDidChangeContent: 期间，从 NSFetchedResultsController 的委托中捕获了一个异常。无效更新：第 0 节中的行数无效。更新后现有节中包含的行数 (5) 必须等于更新前该节中包含的行数 (5)，加上或减去数字从该部分插入或删除的行数（1 插入，0 删除）加上或减去移入或移出该部分的行数（0 移入，0 移出）。与用户信息（空）

我有点不确定为什么会出现这种情况，因为实际的 tableView 显示了新行或删除的行。数据库还显示正确的值和所有内容。我正在使用的代码如下：

```
- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
    {
        return [[fetchedResultsController sections] count];
    }
- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
    {
        return [[[fetchedResultsController sections] objectAtIndex:section] numberOfObjects];
    } 
```

如果您需要查看更多代码，请告诉我。

在显示所有用户的 tableViewController 中。我有以下内容：

```
(void)controllerWillChangeContent:(NSFetchedResultsController *)controller
{
    [self.tableView beginUpdates];
}
(void)controllerDidChangeContent:(NSFetchedResultsController *)controller
{
    [self.tableView endUpdates];
} 
```

这是 commitEditingStyle 的代码

```
(void)tableView:(UITableView *)tableView commitEditingStyle: (UITableViewCellEditingStyle)editingStyle forRowAtIndexPath:(NSIndexPath *)indexPath
{
    if (editingStyle == UITableViewCellEditingStyleDelete) {
    // Delete the row from the data source

    // Get context and user to delete
    NSManagedObjectContext *context = [fetchedResultsController managedObjectContext];
    User *userToDelete = [fetchedResultsController objectAtIndexPath:indexPath];

    // Delete user from context
    [context deleteObject:userToDelete];

    // Save!
    NSError *error = nil;
    if(![context save:&error]){
        // Handle the error..
    }

}   
else if (editingStyle == UITableViewCellEditingStyleInsert) {
    // Create a new instance of the appropriate class, insert it into the array, and add a new row to the table view
  }   
} 
```

# javascript - 如何创建蜂窝 div 网格而不是标准网格？

> ID：10081497
> 
> 赞同：1
> 
> 时间：2012-04-10T00:18:50.697
> 
> 标签：javascript, jquery

这是一个粗略的正常网格结构：http: [//jsfiddle.net/CFxzH/1/](http://jsfiddle.net/CFxzH/1/)

我正在尝试创建我所谓的蜂窝网格而不是标准的 div 网格。这是一个粗略的说明。

普通网格

```
[] [] [] [] []
[] [] [] [] []
[] [] [] [] []
[] [] [] [] []
[] [] [] [] [] 
```

蜂窝网格

```
[] [] [] [] []
  [] [] [] []
[] [] [] [] []
  [] [] [] []
[] [] [] [] [] 
```

我还想要实现的是父框的动态 100% 宽度，随着窗口的宽度而扩展。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-13T20:14:53.670

您可以将 x 轴设置为 y 轴一半的值，然后将直径添加到存储桶。这也适用于六边形。这是一个关于快速网格搜索的问题：[Optimizing search through large list of lat/long coords to find match](https://stackoverflow.com/questions/18139602/optimizing-search-through-large-list-of-lat-long-coords-to-find-match/18145430#18145430)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-04-07T23:53:38.283

在这里回收@bfavretto 的答案。

[http://jsfiddle.net/CFxzH/2/](http://jsfiddle.net/CFxzH/2/)

这样的事情就完成了。

```
var boxes_per_even_line = Math.floor($('#boxes').width() / 110);
var boxes_per_odd_line = boxes_per_even_line-1;
var boxes_every_two_lines = boxes_per_even_line + boxes_per_odd_line;
console.log(boxes_per_even_line, boxes_per_odd_line, boxes_every_two_lines)
var boxes = $('.box');
var total = boxes.length;

for(var i=boxes_per_even_line; i<total; i+=boxes_every_two_lines) {
    $(boxes[i]).css('margin-left', 65);
    $(boxes[i+boxes_per_odd_line-1]).css('margin-right', 65);
} 
```

# mysql - MySQL char & varchar 字符集 & 存储大小

> ID：10081500
> 
> 赞同：11
> 
> 时间：2012-04-10T00:19:21.733
> 
> 标签：mysql, character-encoding, sqldatatypes

想知道这两种数据类型将占用多少实际存储空间，因为 MySQL 文档对此事有些不清楚。

> CHAR(M) M × w 字节，0 <= M <= 255，其中 w 是字符集中最大长度字符所需的字节数
> 
> VARCHAR(M), VARBINARY(M) 如果列值需要 0 – 255 个字节，则为 L + 1 个字节，如果值可能需要超过 255 个字节，则为 L + 2 个字节

这对我来说似乎意味着，给定一个 utf8 编码的数据库，一个 CHAR 将始终占用每个字符 32 位，而 VARCHAR 将占用 8 到 32 位，具体取决于所存储字符的实际字节长度。那是对的吗？或者 VARCHAR 是否意味着 8 位字符宽度，并且存储多字节 UTF8 字符实际上会消耗 VARCHAR 中的多个“字符”？或者 VARCHAR 是否也总是每个字符存储 32 位？这么多的可能性。

我以前不必担心这么多，但我开始达到内存临时表大小限制，我不一定要增加 MySQL 的可用池（第二次）。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-10T00:35:50.630

`CHAR`并且`VARCHAR`都计算字符。考虑到字符编码和长度，它们都计算了它们可能需要的最大存储空间。对于 ASCII，每个字符 1 个字节。对于 UTF-8，每个字符 3 个字节（不是您期望的 4 个字节，因为[MySQL 的 Unicode 支持](http://dev.mysql.com/doc/refman/5.0/en/charset-unicode-utf8.html)由于某种原因受到限制，并且它不支持在 UTF-8 中需要 4 个字节的任何 Unicode 字符）。到目前为止，`CHAR`和`VARCHAR`都是一样的。

现在，`CHAR`继续并保留此数量的存储空间。

`VARCHAR`而是分配 1 或 2 个字节，具体取决于此最大存储空间是 < 256 还是 ≥ 256。条目实际占用的空间量是这 1 或 2 个字节，加上字符串实际占用的空间量。

有趣的是，这使得 85 成为 UTF-8 的神奇数字`VARCHAR`：

*   `VARCHAR(85)`使用 1 个字节作为长度，因为 85 个 UTF-8 字符的最大可能长度为 3 × 85 = 255。
*   `VARCHAR(86)`使用 2 字节作为长度，因为 86 个 UTF-8 字符的最大可能长度为 3 × 86 = 258。

# drupal - 世界地理的 Drupal 分类体系结构设计

> ID：10081504
> 
> 赞同：0
> 
> 时间：2012-04-10T00:20:10.517
> 
> 标签：drupal, google-maps, architecture, drupal-7, drupal-taxonomy

我正在构建一个 Drupal 7 站点以使用 Google Maps API 和 GeoField 模块。我需要构建站点，以便节点（可能是使用地理字段的自定义内容类型）表示地图上的位置。

节点内容类型中的地理字段是否就足够了，还是我还应该创建一个代表世界层次结构的层次分类法？

```
Continents > Countries > Regions > Cities > Districts
North America > United States of America > California > San Francisco > Golden Gate 
```

地图上的每个光点都代表一个位置，可能是商业列表或事件。我认为创建分类法会重复一些事情。

# c# - C# 动态关键字和线程安全

> ID：10081508
> 
> 赞同：2
> 
> 时间：2012-04-10T00:20:35.270
> 
> 标签：c#, dynamic, thread-safety, zeromq

[如果人们想看看https://github.com/brandongrossutti/EventStore](https://github.com/brandongrossutti/EventStore) ，请编辑这里的 github 页面

我有一个非常奇怪的问题，无法确定根本原因。我在自己的线程上有一个 zeromq 订阅者。当它收到一条消息时，它调用一个委托，然后进入一个消息处理程序，最终得到这个动态调用

```
 private void OnEvent(IEvent @event, bool isNew)
    {
        string eventName = "On" + @event.GetType().Name.Replace("Event", "");
        dynamic inheritingClass = this;
        MethodInfo method = inheritingClass.GetType().GetMethod(eventName);
        method.Invoke(inheritingClass, new object[] { @event });
        if (isNew)_uncommitedEvents.Add(@event);
    } 
```

它在调用时死了，调用堆栈和异常没有显示任何东西。如果我慢慢地通过，它似乎工作得很好。很迷茫。

提前致谢

编辑：

这是启动订阅者的线程的糟糕编写代码

```
 private readonly IHandlerResolver _resolver;
    private readonly Thread _subscriberThread;

    public MessageSubscriber(OnTheWireBusConfiguration configuration, IHandlerResolver resolver)
    {
        _resolver = resolver;

        _subscriberThread = new Thread(RecieveMessages);
        _subscriberThread.Start(new object[] { configuration, resolver, new Action<Message>(ProcessMessage) });
    }

    private static void RecieveMessages(object o)
    {
        object[] obj = o as object[];
        OnTheWireBusConfiguration configuration = (OnTheWireBusConfiguration)obj[0];
        IHandlerResolver resolver = (IHandlerResolver)obj[1];
        Action<Message> handlerDelegate = (Action<Message>) obj[2];
        using (var context = new Context(configuration.MaxThreads))
        {
            using (Socket subscriber = context.Socket(SocketType.SUB))
            {
                subscriber.Subscribe("", Encoding.Unicode);
                subscriber.Connect("tcp://localhost:5565");

                while (true)
                {
                    byte[] buffer = subscriber.Recv();
                    Message message = (Message) configuration.Deserialize(buffer);
                    Console.WriteLine(message);
                    handlerDelegate(message);
                    //resolver.ExecuteHandler(message);
                }
            }
        }
    }

    public void ProcessMessage(Message message)
    {
       _resolver.ExecuteHandler(message);
    } 
```

EDIT#2 调用堆栈

> GHI.EventRepository.dll!GHI.EventRepository.AggregateRoot.OnEvent(GHI.EventRepository.IEvent event, bool isNew) 第 39 行 C# GHI.EventRepository.dll!GHI.EventRepository.AggregateRoot.OnEvent(GHI.EventRepository.IEvent event) 第 29 行+ 0x12 字节 C# GHI.TestDomain.dll!GHI.TestDomain.Model.TestAggregateRoot.TestAggregateRoot(System.Guid id) 第 15 行 + 0x59 字节 C# GHI.TestDomain.dll!GHI.TestDomain.Handlers.CreateNewTestAggregateRootCommandHandler.HandleMessage(GHI.TestDomain .Messages.CreateNewTestAggregateRootCommand 消息）第 20 行 + 0x62 字节 C# [本机到托管转换]
> GHI.Bus.dll!GHI.Bus.HandlerResolver.ExecuteHandler(GHI.Bus.Message message) 第 40 行 + 0x95 字节 C# GHI.Bus.ZeroMQ.dll!GHI.Bus.ZeroMQ.MessageSubscriber.ProcessMessage(GHI.Bus.Message message) 第 48 行 + 0x38 字节 C# GHI.Bus.ZeroMQ.dll!GHI.Bus.ZeroMQ.MessageSubscriber.RecieveMessages(object o) 第 39 行 + 0x13 字节 C# mscorlib.dll!System.Threading.ExecutionContext.runTryCode(object userData) + 0x173 字节
> [本机到托管转换]
> [托管到本机转换]
> mscorlib.dll!System.Threading.ExecutionContext.Run(System.Threading.ExecutionContext executionContext, System.Threading.ContextCallback 回调, 对象状态, bool preserveSyncCtx) + 0xeb 字节
> mscorlib.dll!System.Threading.ExecutionContext.Run(System.Threading.ExecutionContext executionContext, System.Threading.ContextCallback 回调，对象状态) + 0x3b 字节
> mscorlib.dll!System.Threading.ThreadHelper.ThreadStart(object obj) + 0x5d 字节[本机到托管转换]
> [Appdomain 转换]
> [本机到托管转换]

如果更容易的话，我可以把它放到 Github 上

编辑#4 感谢大家的帮助，很高兴我可以从那段代码中删除动态关键字。动态不是问题，这是我在堆栈中的锁定方式，再次感谢您，我已经对提到动态问题的人投了赞成票，并将接受下面的答案

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T01:25:06.613

我不熟悉zeromq，但看看你的`OnEvent`方法，我认为没有`dynamic`必要。当您不使用`dynamic`, 并用 this 替换方法时会发生什么？

```
private void OnEvent(IEvent @event, bool isNew)
{
    string eventName = "On" + @event.GetType().Name.Replace("Event", "");
    MethodInfo method = this.GetType().GetMethod(eventName);
    method.Invoke(this, new object[] { @event });
    if (isNew)_uncommitedEvents.Add(@event);
} 
```

如果行为没有改变，那么问题可能出在其他地方。

（可能想`if(method != null)`在 Invoke 周围添加一个，除非您绝对确定它会一直存在。）

# c# - C#“已经有一个打开的 DataReader 与此 Connection 关联，必须先关闭

> ID：10081513
> 
> 赞同：1
> 
> 时间：2012-04-10T00:21:36.543
> 
> 标签：c#, mysql, multithreading

> **可能重复：**
> [多线程错误：已经有一个打开的 DataReader 与此 Connection 关联，必须先关闭](https://stackoverflow.com/questions/10081042/multithreading-error-there-is-already-an-open-datareader-associated-with-this-c)

我不确定为什么我仍然遇到问题，这是我的以下代码，感谢您的帮助。

```
公共静态数据表DTTable（字符串mysqlQuery，字符串queryName）
        {
            锁定（_object）
            {
                数据表 DTTableTable = new DataTable();
                尝试
                {
                    使用 (MySqlDataAdapter DataDTTables = new MySqlDataAdapter(mysqlQuery, MySQLProcessing.MySQLStatic.Connection))
                    {
                        使用 (DataTable DataDTTablesDT = new DataTable())
                        {
                            DataDTTables.SelectCommand.CommandTimeout = 240000;
                            DataDTTables.Fill(DataDTTablesDT);
                            DTTableTable = 数据DTTablesDT；
                            数据DTTables.Dispose();
                        }
                    }

                }
                捕捉（例外前）
                {

                    GenericLogging("MySQLquery 失败：" + ex.Message.ToString(), "MySQLProcessor", "DTTable", "", "MysqlError", "", queryName, mysqlQuery);

                }
                返回 DTTableTable；
            }
        }
```

# javascript - Javascript 中的倒数计时器不会在 Internet Explorer 中运行

> ID：10081515
> 
> 赞同：0
> 
> 时间：2012-04-10T00:21:39.490
> 
> 标签：javascript, internet-explorer, timer, countdown

我写了这个倒数计时器，它适用于除 IE 之外的所有东西。我通过运行脚本获得了受限制的网站。但是当我单击它是 ok 时，脚本不会运行。

是否有适当的方法来设置 javascript 脚本以在用户暂停后运行？或者有没有办法编写它，所以它也适用于 IE。

我没有通过 innerHTML 发送任何内容作为代码只是数字所以我不认为这是问题，我使用 jQuery .html() 函数重写了它，结果相同......

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>JQuery Countdowwn Timer</title>
<style type="text/css">
span#days {   font-size:20px;
                color:#900;
                  font-weight:900;

}
span#hours {   font-size:20px;
                color:#903;
                font-weight:900;
}
span#min {   font-size:20px;
                color:#906;
                font-weight:900;
}
span#sec {   font-size:20px;
                color:#909;
                font-weight:900;
}
span#date {font-size:22px;
font-weight:900;
                color:#900;

}

span#mar {font-size:22px;
font-weight:900;
color:#03F;}

</style>
<script type="text/javascript">
function theTimer(){

var putday=document.getElementById("days");
var puthour=document.getElementById("hours");
var putmin =document.getElementById("min");
var putsec=document.getElementById("sec");

var marathon=new Date(2012,3,22,10,0,0,0);
var marathonCount=marathon.getTime();
var nowish=Date.now();
var dif=marathonCount-nowish;

var days=Math.floor(dif/(24*60*60*1000));
dif=dif-days*(24*60*60*1000);
var hours=Math.floor(dif/(60*60*1000)); 
dif=dif-hours*(60*60*1000);
var minutes=Math.floor(dif/(60*1000));
dif=dif-minutes*(60*1000);
var seconds=Math.floor(dif/1000);

putday.innerHTML="this stuffF"; 
putday.innerHTML=days;
puthour.innerHTML=hours;
putmin.innerHTML=minutes;
putsec.innerHTML=seconds;

var counter = setTimeout("theTimer()", 1000) };
</script>
</head>

<body onload="theTimer()">
<a href ="" style="text-decoration:none">
<center>
<p id="marathon">There are <span id="days"></span> days, <span id="hours"></span> hours, <span id="min"></span> minutes, and <span id="sec"></span> seconds left </p>
</center>
<center>
<p id="marathon">till the beginning of the Next <span id="mar">Marathon</span> on <span id="date">April 22, 2012.</span></p>
</center>
</a>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T22:01:40.007

感谢 Naren 对 IE9 工作的评论。

我追踪到使用`Date.now()`

这在 IE8（这是我使用的试用计算机浏览器之一）和可能更早的版本中不起作用。

如果我只是这样做

```
new Date().getTime(); 
```

IE8 处理这个问题。

# java - 快速 SVD 算法

> ID：10081516
> 
> 赞同：1
> 
> 时间：2012-04-10T00:21:43.140
> 
> 标签：java, algorithm, math, linear-algebra

我正在寻找一个**快速**的库来计算 Java 中的 SVD（奇异值分解）。我已经尝试了一些我找到的库并且我已经做了一些基准测试（这些值显示了我的基准测试运行的平均时间......）这不是一个真正有效的基准测试，但它已经在我需要处理的数据上进行了测试，对我来说足够了。。

1.  [贾马](http://math.nist.gov/javanumerics/jama/)- 152 102ms
2.  [ujmp](http://sourceforge.net/projects/ujmp/) - 156 603 毫秒
3.  [公共数学](http://commons.apache.org/math/)- 183 877 毫秒
4.  [柯尔特](http://acs.lbl.gov/software/colt/)- 203 866 毫秒
5.  [jblas](http://jblas.org/) - 慢得多...

我真的不希望找到比 Jama 更快的东西，但我可以试一试......你能推荐我其他图书馆吗？谢谢！

**编辑：** 我找到了一个带有线性代数库基准的[漂亮页面](http://code.google.com/p/java-matrix-benchmark/)，所以我想这可以结束这个问题...... [EJML](http://code.google.com/p/efficient-java-matrix-libraryb)看起来很有希望......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T01:31:29.627

你试过LAPACK吗？请参阅此处了解更多信息：[http ://en.wikipedia.org/wiki/LAPACK](http://en.wikipedia.org/wiki/LAPACK)

由于您想要本机 java 库，请尝试 netlib：[http](http://code.google.com/p/netlib-java/) ://code.google.com/p/netlib-java/ 。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-11T16:44:41.470

我发现[这个页面带有](http://code.google.com/p/java-matrix-benchmark/)线性代数库的基准，所以我想这可以结束这个问题...... EJML 看起来很有希望......我找到了一个带有线性代数库基准的漂亮页面，所以我想这可以结束这个问题.. . [EJML](http://code.google.com/p/efficient-java-matrix-libraryb)看起来非常好，它在我的数据上的运行速度几乎比 jama 快 2 倍......

# android - 如何在键盘之间切换（从表情符号到 qwerty，反之亦然）

> ID：10081517
> 
> 赞同：0
> 
> 时间：2012-04-10T00:21:43.163
> 
> 标签：android, android-softkeyboard

我试图让用户在键盘之间切换，例如从 Qwerty 切换到笑脸键盘。我无法理解用户如何通过使用 shift 或在 iPhone 上通过地球按钮从 Qwerty 切换到表情符号的概念。我对如何编写实际的“开关”感到困惑。我在软键盘 SDK 示例中找到了以下代码，我想知道这是否是切换发生的方式。

```
private void handleShift() {
        if (mInputView == null) {
            return;
        }

        Keyboard currentKeyboard = mInputView.getKeyboard();
        if (mQwertyKeyboard == currentKeyboard) {
            // Alphabet keyboard
            checkToggleCapsLock();
            mInputView.setShifted(mCapsLock || !mInputView.isShifted());
        } else if (currentKeyboard == mSymbolsKeyboard) {
            mSymbolsKeyboard.setShifted(true);
            mInputView.setKeyboard(mSymbolsShiftedKeyboard);
            mSymbolsShiftedKeyboard.setShifted(true);
        } else if (currentKeyboard == mSymbolsShiftedKeyboard) {
            mSymbolsShiftedKeyboard.setShifted(false);
            mInputView.setKeyboard(mSymbolsKeyboard);
            mSymbolsKeyboard.setShifted(false);
        }
    } 
```

我再次尝试初始化一个开关，允许用户按下 shift 按钮并切换到表情符号，一旦选择切换回 qwerty 发送......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T03:17:51.460

示例软键盘被编码为在按下 shift 键时从符号键盘更改为符号移位键盘。要将表情符号键盘布局添加到旋转中，请将发布的代码更改为以下内容：

```
private void handleShift() {
    if (mInputView == null) {
        return;
    }

    Keyboard currentKeyboard = mInputView.getKeyboard();
    if (mQwertyKeyboard == currentKeyboard) {
        // Alphabet keyboard
        checkToggleCapsLock();
        mInputView.setShifted(mCapsLock || !mInputView.isShifted());
    } else if (currentKeyboard == mSymbolsKeyboard) {
        mSymbolsKeyboard.setShifted(true);
        mInputView.setKeyboard(mSymbolsShiftedKeyboard);
        mSymbolsShiftedKeyboard.setShifted(true);
    } else if (currentKeyboard == mSymbolsShiftedKeyboard) {
        mSymbolsShiftedKeyboard.setShifted(false);
        mInputView.setKeyboard(mEmoticonKeyboard);
        mSymbolsKeyboard.setShifted(false);
    } else if (currentKeyboard == mEmoticonKeyboard) {
        mInputView.setKeyboard(mSymbolsKeyboard);
    }

} 
```

# ios - RestKit 初学者指南

> ID：10081520
> 
> 赞同：1
> 
> 时间：2012-04-10T00:21:50.380
> 
> 标签：ios, restkit

我正在尝试将 RestKit 合并到我的 iOS 应用程序中，但我无法找到该 API 的初学者指南。我尝试遵循 GitHub 示例，但它们对我不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T10:48:07.087

[对象映射是使用 RestKit 的主要原因之一，您可以在https://github.com/RestKit/RestKit/blob/master/Docs/Object%20Mapping.md](https://github.com/RestKit/RestKit/blob/master/Docs/Object%20Mapping.md)了解它

网络上的很多教程都参考了旧架构，本文档涵盖了最新的稳定版本。

# c# - 如何使用 DataTable.Select() 访问具有特殊字符的列？

> ID：10081523
> 
> 赞同：0
> 
> 时间：2012-04-10T00:22:13.183
> 
> 标签：c#, datatable, datacolumn

我有一个`DataTable`with 列，例如`# of Students`并且想按降序排序。这是我的代码：

```
...
dt.Columns.Add(new DataColumn("# of Students", typeof(string)));

// do some stuff... add records etc.

// A runtime error occurs here: "Cannot find column '# of Students'"
var rows = dt.Select("","'# of Students' desc");

// this is just fine.
rows = dt.Select("","# of Students"); 
```

如果名称中有特殊字符，如何访问此列？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-10T00:33:15.050

您可以同时使用 [] 或 `` 语法。以下两个片段都是正确的：

```
var rows = dt.Select("","`# of Students` desc");

var rows = dt.Select("","[# of Students] desc"); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-10T00:26:56.923

您应该使用 [] 括号，如下所示：

```
var rows = dt.Select("","[# of Students] desc"); 
```

# iphone - Settings.bundle - 删除它？

> ID：10081532
> 
> 赞同：1
> 
> 时间：2012-04-10T00:24:11.407
> 
> 标签：iphone, xcode4.2

将保持简短。在我的应用中添加了 settings.bundle。不需要它，并删除它。重置模拟器上的所有内容。强制退出 xCode。现在应用程序prefpane还在吗？！我不知道我做错了什么。有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T02:57:37.313

在 Xcode 中清理构建（Command + Shift + K）。再次重置模拟器。现在运行（Command + R）

# selenium - 使用 selenium webdriver 查找标签文本

> ID：10081536
> 
> 赞同：1
> 
> 时间：2012-04-10T00:24:39.890
> 
> 标签：selenium, selenium-webdriver

我很难使用 Selenium Web 驱动程序来查找以下场景的标签文本。

```
<tr id="row"> 
<td width="148" height="22" align="left"> 
<b> Label Text</b> 
</td> </tr> 
```

如何使用 webdriver 获取标签文本？

提前致谢。

* * *

谢谢回复。我想我应该更具体一些。我在 tr 标签中有一个 td 标签列表。例如：

```
<tr id="row"> 
<td width="148" height="22" align="left"> 
<b> Label Text 1</b> 
<td width="148" height="22" align="left"> 
<b> Label Text 2</b> 

<td width="148" height="22" align="left"> 
<b> Label Text 3</b> 
</td> </tr> 
```

driver.findElement(By.id("row")).getText() 将检索我所有这些标签值。我可以根据页面中的位置获取标签值吗？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T00:29:17.187

```
driver.findElement(By.id("row")).getText(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T06:38:37.560

您可以使用以下代码一一遍历所有必需的标签 -

```
List<WebElement> list = driver.findElements(By.xpath("//*[@id='row']/td/b"));

for(int i=0;i<list.size;i++){

   list.get(i).getText();

  } 
```

我希望这能回答你的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-11T07:05:50.333

要通过其位置获取值，您可以使用以下内容：

```
 ReadOnlyCollection<IWebElement> cells = driver.findElements(By.XPath("//tr[@id='row']//td"));
    foreach(IWebElement cell in cells)
    {
        if (cell.Location.X == targetX && cell.Location.Y == targetY)
        {
            cell.Text;
        } 
    } 
```

此外，FindElement 只会返回找到的第一个与条件匹配的元素，FindElements 必须用于存储所有匹配项。

# python - 如何在 Python 脚本中的段落之间留出空格？

> ID：10081538
> 
> 赞同：1
> 
> 时间：2012-04-10T00:25:02.383
> 
> 标签：python, paragraph

我正在用 Python 制作游戏（仅限文本），但是当人们玩它时会感到困惑，因为段落之间没有空格，所以它看起来像这样：

```
'You step outside and feel the wind on your face.'
'Which direction do you turn?' 
```

但我希望它看起来像这样：

```
'You step outside and feel the breeze on your face'

'What do you do next'? 
```

这是我的代码：

```
print 'You step outside and feel the cool breeze on your face.'
what = raw_input ('What do you do next ') 
```

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-10T00:26:53.853

打印换行符。

```
print("\n") 
```

或者：

```
print("An angry-looking dwarf throws an axe at you.\nYou die.\n") 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-10T00:28:03.513

你有几个解决方案：

更简单的方法是在你的行之间使用一个`print`语句，单独使用它会打印一个换行符。

或者，您可以使用字符结束正在打印的字符串`'\n'`，这将导致换行，或者您可以使用相同的字符开始输入。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-05-03T13:15:19.253

```
print('\v') 
```

垂直空间的垂直选项卡。

# php - 如何让 FullCalendar 显示来自我的 JSON 提要的信息？

> ID：10081546
> 
> 赞同：6
> 
> 时间：2012-04-10T00:27:19.937
> 
> 标签：php, mysql, html, json, fullcalendar

[我正在使用 FullCalendar ( http://arshaw.com/fullcalendar/](http://arshaw.com/fullcalendar/) )设置一个应用程序，该应用程序将允许用户查看客户端调度信息以及通过管理界面调度客户端。

我想使用 MySQL 数据库填充一个数组，然后将该数组以 JSON 提要的形式传递给 HTML 页面上的 FullCalendar。理想情况下，客户端信息将显示在 HTML 页面上。但是，即使传递了我的 JSON 提要，我的 FullCalendar 上也没有任何事件。

正在传递的示例 JSON 提要：

```
[{"title":"Watson","start":"1333976400","end":"1333980000","allDay":false}] 
```

我对这些语言相当陌生，如果这个错误变得简单，我不会感到惊讶。

对于让这些事件出现的任何帮助或见解，我将深表感谢。当我手动将数组输入 FullCalendar 时，它确实显示了事件，但到目前为止，我的 JSON 提要没有显示任何信息。

谢谢

供参考：HTML：

```
 $(document).ready(function() {      
        $('#calendar').fullCalendar({
            events: '/json-events.php'
        });     
}); 
```

PHP：

```
 while ($record = mysql_fetch_array($result)) {
        $event_array[] = array(
            'id' => $record['id'],
            'title' => $record['title'],
            'start' => $record['start_date'],
            'end' => $record['end_date'],
            'allDay' => false
        );
    }

echo json_encode($event_array); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-18T18:12:50.393

因此，对于那些追随我的搜索者来说，问题是我的 PHP 文件有 HTML 头部和正文标记。我是一个 PHP 菜鸟，所以我不知道这会导致它不起作用。为了让 FullCalendar 显示 JSON 提要，它必须只有 PHP 代码，没有 HTML。JSONLint.com 在解决这个问题方面非常宝贵。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-11T08:28:33.723

我建立了一个简单的例子，让它工作没有任何问题：

PHP：

```
<?php

$record[0]["title"]="Test 1";
$record[1]["title"]="Test 2";
$record[2]["title"]="Test 3";

$record[0]["start_date"]="1333976400";
$record[1]["start_date"]="1333976401";
$record[2]["start_date"]="1333976402";

$record[0]["end_date"]="1333980000";
$record[1]["end_date"]="1333980001";
$record[2]["end_date"]="1333980002";

$record[0]["id"]="1";
$record[1]["id"]="2";
$record[2]["id"]="3";

for ($i=0; $i<3; $i++) {

    $event_array[] = array(
            'id' => $record[$i]['id'],
            'title' => $record[$i]['title'],
            'start' => $record[$i]['start_date'],
            'end' => $record[$i]['end_date'],
            'allDay' => false
    );

}

echo json_encode($event_array);

exit;

?> 
```

HTML：

```
events: '/events.php' 
```

PHP 脚本的示例输出：

```
[{"id":"1","title":"Test 1","start":"1333976400","end":"1333980000","allDay":false},{"id":"2","title":"Test 2","start":"1333976401","end":"1333980001","allDay":false},{"id":"3","title":"Test 3","start":"1333976402","end":"1333980002","allDay":false}] 
```

因此，鉴于以上内容对我有用，并且与您上面的内容没有什么不同，您可能需要检查 PHP 脚本是否实际上被正确调用。检查 Mozilla Firefox 或 Google Chrome 中的 Javascript 控制台，查看 Fullcalendar 尝试加载事件时是否抛出任何错误。检查您的 Web 服务器访问/错误日志中是否提及 PHP 脚本。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-10T00:48:39.763

```
events: '/json-events.php' 
```

应该是

```
events: './json-events.php' 
```

或者

```
events: 'json-events.php' 
```

让我知道这是否有帮助...

**编辑**

我还注意到，在您收到的 Json 中，该行中没有 id。与您在数组中使用的名称相比，在数据库中命名您的 id 之间可能会发生一些事情。检查一下，看看是否发生了这种情况，因为这是传递事件所需的属性之一。

**编辑**

尝试从 $event_array[] 中删除 [] 看看会发生什么......如果这不起作用，我会被难住......对不起

# php - 当 PHP 执行窗帘函数时，一个 unix 用户似乎正在篡夺 www-data

> ID：10081553
> 
> 赞同：0
> 
> 时间：2012-04-10T00:28:31.680
> 
> 标签：php, apache, unix, permissions, linode

我在一个 linode 上运行一个 LAMP 堆栈。Ubuntu 版本是 Lucid。

当 PHP 脚本执行`mkdir()`or`move_uploaded_file`命令时，新创建的文件夹/文件最终归 unix 用户“Grusha”所有。我确实创建了这个用户，但它不应该拥有文件。Web 文件夹总体归 拥有`www-data`，新文件夹/文件在其中移动的包含文件夹（按扩展名）也是如此。

用户的 /etc/passwd 行是这样的：

```
grusha:x:1000:1003:,,,:/home/grusha:/bin/bash 
```

/etc/group 是这样的：

```
grusha:x:1003: 
```

Grusha 在创建 PHP 会话时也拥有它们，尽管没有别的。系统上也没有进程或文件作为 Grusha 运行。

我使用公钥登录，通过的用户不是 Grusha（也不是 root）。

当我删除 Grusha 时，我无法再重新启动 Apache。我明白`bad username`了，重启失败。我的 PHP 会话也不起作用。

所以最后我再次添加 Grusha，服务器将启动，一切正常，除了脚本生成 Grusha 拥有的文件，而不是`www-data`.

我一直在尽可能地四处寻找，但找不到任何信息。我`httpd.conf`的是空的。我的`apache2.conf`包含以下几行：

```
User ${APACHE_RUN_USER}
Group ${APACHE_RUN_GROUP} 
```

这些变量定义`www-data`为`/etc/apache2/envars`.

如果有人有任何建议，我将不胜感激。

非常感谢，埃利奥特

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T16:04:22.100

啊，这就解决了。道歉。
我在 /etc/apache2/sites-enabled/ 中有 mpm 指令，导致 apache 作为 grusha 运行。
不确定这是怎么发生的，但无论如何它都是固定的。感谢你们俩考虑我的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T00:46:25.680

suPHP 模块可能已启用。它的作用是让 PHP 代码在拥有脚本的用户的用户 ID 下执行，而不是`www-data`在共享服务器上非常不安全。`/etc/apache2/mods-enabled/suphp.load`尝试通过删除和关闭 suPHP `/etc/apache2/mods-enabled/suphp.conf`。

万一这不是问题，请检查该用户`grusha`实际上没有与`www-data`(in `/etc/passwd`) 相同的数字用户 ID。不过，这可能不太可能。

# java - 如何检查一个字符是否是撇号？

> ID：10081560
> 
> 赞同：7
> 
> 时间：2012-04-10T00:29:07.443
> 
> 标签：java, char

我需要检查一个字符是否是撇号。到目前为止，这是我的代码：

```
public boolean isWordCharacter(int c) {
if ((char) c == '\'')
    return true;
else return Character.isLetter(c);
} 
```

但是，它从未真正进入该`if ((char) c == '\'')`部分。我检查的方式有问题吗？谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-10T00:40:07.510

你可以简单地使用`if(c=='\'')`没有演员表。或者您可以使用 39 的撇号的 ascii 值。`if (c==39)`就可以了。

> 它实际上从未进入 'if ((char) c == '\'') 部分

这样做的唯一原因是您永远不会将撇号传递给 isWordCharacter()。您可以通过手动发送`39`或发送`'\''`到该功能来验证它。

# mysql - mysql索引是否会在更新时修改？

> ID：10081564
> 
> 赞同：2
> 
> 时间：2012-04-10T00:29:21.247
> 
> 标签：mysql, database, performance

假设我有一个 mysql 数据库表“文章”，其中包含以下字段：`id`, `title`, `url`,`views`

我有用索引`title`标记的字段和用索引标记`FULLTEXT`的字段。`url``UNIQUE`

我的问题是，如果我进行普通更新，例如：

```
UPDATE 'article' SET views = views + 1 WHERE id = {id} 
```

...这会导致 mysql 表索引的更新吗？

`views`将字段保留在表中是否安全（从速度的角度来看），`article`或者我应该创建一个单独的表，比如说，`article_stats`包含以下字段：`article_id`，`views`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T00:31:49.260

是的，`UPDATE`语句更新索引。MySQL 自动管理索引——您无需担心手动更新它们或触发更新。如果您询问该特定是否`UPDATE`会更改不包含该`views`列的索引 - 不，它不会。只有相关的索引才会更新。

保留一`views`列很好，除非您需要跟踪有关每个视图的额外信息（发生时间、创建视图的用户等）

但是，您的 SQL 确实包含语法错误。您不能引用表名，例如`'article'`. 如果您需要引用表名（例如，如果它包含 SQL 保留字），则使用这样的反引号：

```
UPDATE  `article` SET ... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T00:40:05.427

我同意 Cal，使用更新语句“如果您更新索引”更新索引。在您的具体示例中，索引或索引未更新，因为它们与视图字段无关，但更新视图仍会减慢，因为这是一个如此频繁的操作，您可以通过二进制程序以编程方式将视图更新保存在共享内存中树或哈希表，并在一段时间或大小点后将它们一起更新。为了获得最佳速度，您还可以使用内存表，这些表是易失性的，但您可以不时将数据传输到实际表中。通过这种方式，您将不必为每个“视图”更新处理硬盘写入器。

保持单独的表会导致同样的事情。您的应用程序会变慢，因为当有选择时会有更新 - 您正在更新的行将被锁定，直到您完成它并且其他读者将等待您的行级操作。即使在单独的表格中，您仍然可以选择显示该视图计数。

好吧，当你有这么多负载时，你可以拥有主服务器和从服务器来分离读写并不时同步。

# c - 可以用数组替换 sscanf 参数

> ID：10081566
> 
> 赞同：1
> 
> 时间：2012-04-10T00:29:51.620
> 
> 标签：c, split, scanf

我有一串长度不等的字符，类似于“ asdf + lghd + ewre + fdsf + ...”。由此，我还有一个用于 sscanf 函数的模板，类似于“%s + %s + %s + ...”。因为这两个都是不同的长度，是否可以用动态字符串数组替换 sscanf 中要存储值的那些附加参数？例如：

```
char *test = "adfe + asdf + fghe + jklo";
char *template = "%s + %s + %s + %s";
char destination[4][4];
sscanf(test, template, destination); 
```

乍一看这似乎行不通，那么有没有其他方法可以做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T00:38:38.833

你试图做的事情是不可能的`sscanf`。你将不得不循环它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T00:39:18.620

不，sscanf，就像“C”中的所有 xxxxxf 函数一样，通过在参数列表中具有可变数量的参数来工作。如果您要查找 4 个字符串 (4 %s)，则该函数需要 4 个作为字符数组的参数。在您的示例中，您提供了一个由 4 个字符数组组成的数组的单个参数。

一种可行的方法是让您使用您正在使用的任何分隔符解析输入。查看函数 substr 和 pos 以获取有关如何执行此操作的一些提示。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-10T00:41:36.273

`sscanf()`不支持这一点，但您可以编写自己的 scanf 版本。

我已经在 C# 中完成了这项工作，并在[此处](http://www.blackbeltcoder.com/Articles/strings/a-sscanf-replacement-for-net)发布了代码。也许我的代码会给你一些用 C 编写自定义版本的想法。

# php - 在 insert ... select 语句中插入增量值 mysql

> ID：10081568
> 
> 赞同：1
> 
> 时间：2012-04-10T00:29:55.453
> 
> 标签：php, mysql

我正在尝试选择表中的多行，反转一列中的值并将它们重新插入表中。这是我正在做的一个例子，假设我有以下数据：

```
+-------+--------+-------+
| ORDER |   X    |   Y   |
+-------+--------+-------+
|  0    |   12   |   5   |
|  1    |   16   |   3   |
|  2    |   19   |   2   |
+-------+--------+-------+ 
```

我想选择它并将其重新插入到同一个表中，并将 ORDER 反转为：

```
+--------+--------+-------+
| PORDER |   X    |   Y   |
+--------+--------+-------+
|  2     |   12   |   5   |
|  1     |   16   |   3   |
|  0     |   19   |   2   |
+--------+--------+-------+ 
```

我能够复制行并重新插入它们，使用插入没问题...选择这样的：

```
INSERT INTO myTable (porder, x, y) SELECT porder, x, y FROM myTable 
```

但我没有成功扭转订单。我试过了

```
INSERT INTO myTable (porder, x, y) SELECT (SELECT porder FROM myTable ORDER BY porder DESC), x, y FROM myTable but that throws an error 
```

可以简单地忽略 porder 列并插入从 0 到序列中最高数字的新值（在我上面的示例中为 2），但我不知道如何在 mysql 的多行插入语句中添加序列号.

我知道如何用 php 做到这一点，但我认为必须有一个更优雅的解决方案，只用 SQL

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T00:37:56.903

如果你知道 的最大值`order`，你可以简单地做（假设`max(order) = 2`）

```
UPDATE `myTable` SET `PORDER` = 2 - `PORDER` 
```

例子：

```
 +--------+------------+
   | PORDER | 2 - PORDER |
   +--------+------------+
   |  0     |  2-0 = 2   |
   |  1     |  2-1 = 1   |
   |  2     |  2-2 = 0   |
   +--------+------------+ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T06:03:15.830

试试这个

```
 INSERT INTO myTable(`porder`, x, y) SELECT (SELECT MAX(`porder`) FROM myTable) - `porder`, x, y FROM myTable 
```

# c# - Windows 8 Metro 等效于 System.Windows.Media.DrawingGroup 和 ImageDrawing？

> ID：10081572
> 
> 赞同：1
> 
> 时间：2012-04-10T00:30:32.527
> 
> 标签：c#, .net, wpf, windows-8, microsoft-metro

我有一个 WPF .NET 3.5 应用程序，它使用 ImageDrawing 和 DrawingGroup 在彼此之上绘制透明平铺层。

我正在尝试使用 Metro 将其转换为 Windows 8。

[Microsoft 在http://msdn.microsoft.com/en-us/library/windows/apps/hh465136.aspx](http://msdn.microsoft.com/en-us/library/windows/apps/hh465136.aspx)的移植概述建议将 System.Windows 命名空间引用更改为 Windows.UI.Xaml。这对大多数事情都有帮助，但我没有找到 ImageDrawing 和 DrawingGroup，也没有在 Windows.UI.Xaml 中找到它们的任何提及。

它们存在于 Metro 中吗？如果是这样，在哪里，或者如果不是，我可以用什么来完成等效的任务？

这是我正在使用的示例代码：

```
 Windows.UI.Xaml.Controls.Image img = mapGrid.Children.Cast<Windows.UI.Xaml.Controls.Image>().First(e => Grid.GetRow(e) == 2 && Grid.GetColumn(e) == 4);

    if (img != null)
    {
        Uri back = new Uri("tiles/green.png", UriKind.RelativeOrAbsolute);
        Windows.UI.Xaml.Media.ImageDrawing background = new Windows.UI.Xaml.Media.ImageDrawing(new Windows.UI.Xaml.Media.Imaging.BitmapImage(back), new Rect(0, 0, 32, 32));
        Windows.UI.Xaml.Media.DrawingGroup myDrawingGroup = new Windows.UI.Xaml.Media.DrawingGroup();
        myDrawingGroup.Children.Add(background);
        // Add one or more foreground tiles here, removed for brevity.
    } 
```

为了清楚起见，完全限定的名称空间（我希望如此）。

# c++ - 如何制作一个同步聊天程序来同步发送和接收消息？

> ID：10081573
> 
> 赞同：2
> 
> 时间：2012-04-10T00:30:34.823
> 
> 标签：c++, udp, client-server, chat, winsock

目前我正在用 C++ 创建一个客户端服务器控制台应用程序。通过使用`winsock2.h`库和 UDP 协议，我们使用`sendto`and`recvfrom`将消息作为字符串从客户端发送到服务器，然后服务器将消息发送到不同的客户端，现在如果客户端 1 向客户端 2 发送消息，客户端 2 将不会收到消息，直到他们尝试向 client1 发送消息。我希望让程序像即时通讯工具一样工作，这样当客户端 1 向客户端 2 发送消息时，客户端 2 几乎会立即收到它，而无需先发送消息。

此外，如果客户端 1 向客户端 2 发送消息，客户端 1 将无法发送另一条消息，除非客户端 2 已回复第一个消息。

如果您需要更多信息或查看一些代码，请询问。

发送代码：

```
while( getline( cin, line ) )
{
    // send a string to the server.
    sendto( hSocket, line.c_str(), line.size(), 0, 
        reinterpret_cast<sockaddr*>( &serverAddress ),
        sizeof( serverAddress ) );

    // recieve the response.
    int n = recvfrom( hSocket, recvLine, MAXLINE, 0, NULL, NULL );
    if( n == -1 )
    {
        cout << "no reply" << endl;
    }
    else
    {
        recvLine[n] = 0;
        string const terminateMsg = "server exit";
        string msg = recvLine;
        if( msg == terminateMsg )
        {
            cout << "Server terminated" << endl;
            break;
        }
        cout << n << ": " << recvLine << endl;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T01:35:52.353

> 现在，如果客户端 1 向客户端 2 发送消息，客户端 2 在尝试向客户端 1 发送消息之前不会收到该消息。

你已经这样编码了。

> 此外，如果客户端 1 向客户端 2 发送消息，客户端 1 将无法发送另一条消息，除非客户端 2 已回复第一个消息。

同样，您已经以这种方式对其进行了编码。您的代码假定 every`sendto()`后跟一个`recvfrom()`. 但你的问题表明这不是你想要的。我在下面的代码中添加了一些注释

```
while( getline( cin, line ) )
{
    // send a string to the server. <-- will never get here a 2nd time through the loop without recvfrom() returning
    sendto( hSocket, line.c_str(), line.size(), 0, 
        reinterpret_cast<sockaddr*>( &serverAddress ),
        sizeof( serverAddress ) );

    // recieve the response. <--- will never get here without getline() returning
    int n = recvfrom( hSocket, recvLine, MAXLINE, 0, NULL, NULL );
    if( n == -1 )
    {
        cout << "no reply" << endl;
    }
    else
    {
        recvLine[n] = 0;
        string const terminateMsg = "server exit";
        string msg = recvLine;
        if( msg == terminateMsg )
        {
            cout << "Server terminated" << endl;
            break;
        }
        cout << n << ": " << recvLine << endl;
    }
} 
```

> 我希望让程序像即时通讯工具一样工作，这样当客户端 1 向客户端 2 发送消息时，客户端 2 几乎会立即收到它，而无需先发送消息。

使用 Boost.Asio 和异步套接字，异步[chat_client](http://www.boost.org/doc/libs/release/doc/html/boost_asio/example/chat/chat_client.cpp) [示例](http://www.boost.org/doc/libs/release/doc/html/boost_asio/examples.html)使用 TCP 套接字完美地完成了这件事，修改 UDP 示例相当简单。异步[UDP 回显服务器](http://www.boost.org/doc/libs/1_49_0/doc/html/boost_asio/example/echo/async_udp_echo_server.cpp)示例也可能很有用。你会想要使用[`boost::asio::ip::udp::socket::async_recv_from()`](http://www.boost.org/doc/libs/release/doc/html/boost_asio/reference/basic_datagram_socket/async_receive_from.html)and [`boost::asio::ip::udp::socket::async_send_to()`](http://www.boost.org/doc/libs/release/doc/html/boost_asio/reference/basic_datagram_socket/async_send_to.html)。[其他 BSD 套接字接口具有文档](http://http://www.boost.org/doc/libs/release/doc/html/boost_asio/overview/networking/bsd_sockets.html)中描述的等效映射。

# jquery - 获取下一个相同类型的元素

> ID：10081574
> 
> 赞同：2
> 
> 时间：2012-04-10T00:30:45.393
> 
> 标签：jquery

假设我有一些结构，例如：

```
<ul>
  <li>
      <input .../>
  </li>
  <li>
      This item doesn't have an input
  </li>
  <li>
      <input .../>
  </li>
  <li>
      <input .../>
  </li>
</ul> 
```

给定对其中一个`input`元素的引用，如何获取`input`列表中的下一个或上一个？

* * *

编辑：有些`<li>`元素没有输入；我需要代码来处理这些情况。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-10T00:32:15.283

如果`this`是当前输入：

```
$(this).closest('li').next('li').find('input'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T01:09:44.143

我最终使用了受此[答案](https://stackoverflow.com/a/4265151/62024)启发的东西：

```
var inputs = $("input");
var currentIndex = inputs.index(this);
var next = inputs.filter(function (index) { return index == currentIndex + 1; }) 
```

# sql-server - 无法使用 SQL Server Management Studio 2008 添加 SQL Server CE 数据库

> ID：10081575
> 
> 赞同：0
> 
> 时间：2012-04-10T00:30:57.090
> 
> 标签：sql-server, sql-server-ce, ssms, northwind

我正在尝试将 Northwind SQL Server CE 3.5 版本添加`.sdf`到 SQL Server Management Studio 2008 R2，但出现以下错误：

> 未能为此请求检索数据。(Microsoft.SqlServer.Management.Sdk.Sfc)
> 
> 在 Microsoft.SqlServer.Management.Sdk.Sfc.Enumerator.Process(Object connectionInfo, Request request)
> 在 Microsoft.SqlServer.Management.SqlManagerUI.AttachDatabaseData 在 Microsoft.SqlServer.Management.SqlManagerUI.AttachDatabaseData.PrimaryFile.GetOriginalDatabaseName(String primaryFilePath)
> 。
> 位于 Microsoft.SqlServer.Management.SqlManagerUI.AttachDatabaseData.PrimaryFile..ctor(SqlManagementUserControl parent, CDataContainer dc, String fullPath, String databaseOwner, ServerConnection connectionInfo)的PrimaryFile.PopulatePrimaryFileData(String primaryFilePath)
> 在 Microsoft.SqlServer.Management.SqlManagerUI.AttachDatabase.IsSelectedFileValid （浏览文件夹 dlg）
> 
> 执行 Transact-SQL 语句或批处理时发生异常。(Microsoft.SqlServer.ConnectionInfo)
> 
> 在 Microsoft.SqlServer.Management.Common.ServerConnection.ExecuteReader(String sqlCommand, SqlCommand& command)
> 在 Microsoft.SqlServer.Management.Smo.ExecuteSql.GetDataReader(String query, SqlCommand& command)
> 在 Microsoft.SqlServer.Management.Smo.DataProvider.SetConnectionAndQuery (ExecuteSql execSql, String query)
> 在 Microsoft.SqlServer.Management.Smo.ExecuteSql.GetDataProvider(StringCollection query, Object con, StatementBuilder sb, RetriveMode rm)
> 在 Microsoft.SqlServer.Management.Smo.ExecuteSql.ExecuteWithResults(StringCollection query, Object con , StatementBuilder sb)
> 在 Microsoft.SqlServer.Management.Smo.SqlObjectBase.FillData(ResultType resultType, StringCollection sql, Object connectionInfo, StatementBuilder sb)
> 在 Microsoft.SqlServer.Management.Smo.SqlObjectBase.FillDataWithUseFailure(SqlEnumResult sqlresult, ResultType resultType)
> 在 Microsoft.SqlServer.Management.Smo.SqlObjectBase.BuildResult(EnumResult 结果)
> 在 Microsoft.SqlServer.Management.Smo.PrimaryFile.GetData(EnumResult erParent )
> 在 Microsoft.SqlServer.Management.Sdk.Sfc.Environment.GetData()
> 在 Microsoft.SqlServer.Management.Sdk.Sfc.Environment.GetData(Request req, Object ci)
> 在 Microsoft.SqlServer.Management.Sdk.Sfc.Enumerator .GetData（对象连接信息，请求请求）
> 在 Microsoft.SqlServer.Management.Sdk.Sfc.Enumerator.Process（对象连接信息，请求请求）
> 
> C:\Program Files (x86)\Microsoft SQL Server Compact Edition\v3.5\Samples\Northwind_ce.sdf 不是主数据库文件。（.Net SqlClient 数据提供者）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T05:17:50.423

SQL CE 数据库不能附加到 MS SQL Server。但是您可以使用第三方工具将您的数据库从 SQL CE 迁移到 MS SQL Server。例如，您可以使用[exportsqlce 实用程序](http://exportsqlce.codeplex.com/)。

# windows - 具有单个 repo 且没有根路径的 SVN 服务器

> ID：10081582
> 
> 赞同：0
> 
> 时间：2012-04-10T00:32:19.013
> 
> 标签：windows, svn, collabnet

我有一个奇怪的 SVN 服务器配置问题，我无法弄清楚。以前的员工在我们用于开发的 Windows 服务器上设置了 Collabnet svn 服务器（版本 1.6.9）。这是一个很棒的系统，喜欢使用它。

我们为存储库使用本地 LAN 路径以及我们所有的各种文件夹，就像这样......

“svn://server1”

它有一个名为“repo”的存储库。

我最近在另一台服务器上安装了第二个 SVN（相同版本，相同操作系统）

它有一个名为“main”的存储库。为了访问它，我必须使用...的 svn 路径

“svn://server2/main”

***所以问题是***...... **有谁知道我们是如何最终得到一台服务器需要在服务器名称之后使用“repo 名称”（没有它就无法工作）和一台服务器不需要“repo 名称”（并且不能使用它）？**

问的主要原因是我还需要在原始服务器上设置其他存储库并且不想影响当前配置。我认为这是某个级别或选项或配置或“默认回购”设置或其他东西，但我似乎无法找到它的设置位置和方式。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T11:14:31.883

检查 conf 文件中的条目。如果您的 svn 信息包含在位置标记中，则该位置是访问存储库的唯一方式。

# c# - 脸书连接慢

> ID：10081583
> 
> 赞同：1
> 
> 时间：2012-04-10T00:32:36.343
> 
> 标签：c#, facebook, connect

我使用 C# Facebook SDK 通过 Facebook connect 登录用户，并注意到我第一次登录需要 30 多秒。如果我清除 cookie 并重试，只需几秒钟。出于测试目的，我已将我的 Facebook 应用程序更改为 localhost，而且大多数情况下它非常快。我注意到这行代码是导致延迟的原因：

`var fb = new FacebookWebClient();`

`var me = (IDictionary<string, object>)fb.Get("me"); //stalls here for 30+ seconds first login`

这可能是什么原因造成的？这是我的按钮 HTML 代码：

`<fb:login-button id="facebook_button" scope="email,user_about_me,publish_stream" onlogin="document.location.href='Members/account.aspx'">Connect with Facebook</fb:login-button>`

# ruby - 这一切什么时候开始融合在一起？

> ID：10081586
> 
> 赞同：0
> 
> 时间：2012-04-10T00:33:05.097
> 
> 标签：ruby

我第一次学习如何编程（使用 Ruby），因为我想最终构建一个 Web 应用程序。我很好理解，并且正在完成 2 个不同的教程，但有一个主要问题......

我已经学到了很多关于对象、方法、字符串等的知识，但是到目前为止，我所经历的教程几乎没有提到实际上将它与网站的前端集成，或者在 HTML 中“嵌入”代码。所以我的问题是，这一切到底如何转化为与网站和用户命令的实际交互？我没有看到这里的大局，并且真的可以使用一些指导。

我是不是很想知道这里发生了什么？！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T00:43:12.700

它不会在 HTML 中调用它。HTML 不是一种语言。HTML 是一种为 Web 设计的输出格式。

就是这么简单。

在您的“简单”红宝石程序中，您的代码输出显示在`STDOUT`控制台、屏幕等上。

由 ruby​​ 解释器驱动的服务器会翻译您的 ruby​​ 代码并将其作为 HTML 呈现给客户端。您可以通过指定扩展名（在 rails 中）并用`code tags`.

### 例子

这是一个用纯 ruby​​ 编写的简单 webrick 示例

```
# in server.rb
#
require 'webrick'
server = WEBrick::HTTPServer.new(:Port=>8080)

trap 'INT' do server.shutdown end

class Dog
  attr_accessor :name
  def initialize(name)
    self.name = name
  end
  def bark
    "#{name} is barking!"
  end
end

dog = Dog.new("Fido")

server.mount_proc('/bark'){ |req, resp|
    resp['Content-Type'] = 'text/html'

    resp.body = "#{dog.bark}"
}

server.mount_proc('/run') do |req,resp|
    dog.instance_eval do
      def run_away
        "#{name} is running away..."
      end
    end

    resp['Content-Type'] = 'text/html'
    resp.body = "#{dog.run_away}"
end

server.start 
```

运行`ruby server.rb`并查看`localhost:8080/run`结果`localhost:8080/bark`。

### 编辑 - Sinatra 示例

如果您发现 webrick 示例难以理解，请查看[Sinatra](http://www.sinatrarb.com/)！

```
# in sinatra_example.rb
require 'sinatra'

class Dog
  attr_accessor :name
  def initialize(name)
    self.name = name
  end
  def bark
    "#{name} is barking!"
  end
end

fido = Dog.new("Fido")

get '/bark' do
  fido.bark
end

get '/run' do
  fido.instance_eval do
    def run_away
      "#{name} is running away!"
    end
  end

  fido.run_away

end 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-10T00:49:01.627

冒着吓跑你的风险，要学习如何（正确地）编写 Web 应用程序，你需要学习：

*   您将使用的语言（红宝石）
*   您的应用程序框架（rails？或 sinatra？）
*   HTML
*   CSS
*   javascript
*   HTTP 协议，它是浏览器和服务器之间通信的基础

但是，在深入学习下一个之前，您不需要学习所有这些。

我建议，在你学习 ruby​​ 的时候，至少可以玩一个更简单的框架，例如[Sinatra](http://www.sinatrarb.com/)。这样您就可以感觉自己实际上是在学习如何编写 Web 应用程序。

当然，你也可以玩 Rails，但至少在学习如何编写 Web 应用程序方面，它可能有点令人生畏。新手很难区分红宝石的特性和铁轨的特性。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-10T00:48:18.270

很高兴你开始学习 Ruby！但 Ruby 本身只是一种编程语言。我认为你不想检查 Rails！

[http://guides.rubyonrails.org/getting_started.html](http://guides.rubyonrails.org/getting_started.html)

Rails 是用 Ruby 编写的，您将编写的很多内容都是 Ruby，因此您可能会很快上手。

# android - 在android中，当youtube应用程序播放视频时，是否可以获得当前的http url？

> ID：10081587
> 
> 赞同：1
> 
> 时间：2012-04-10T00:33:07.737
> 
> 标签：android, http, url

我的目标是创建一个应用程序，它可以知道在 android 的 youtube 应用程序中播放的当前视频的名称。我发现这是不可能的（可能吗？）。所以也许有办法让我知道当前视频的网址（然后也许我可以从网址中获取视频 ID）。可能吗？我检查了 youtube 进程的 proc 文件夹，但没有找到此类信息。因为 youtube 应用程序不使用浏览器，我可以知道这些信息吗？谢谢：>

# qt - Qt：用 X11 监控全局光标点击事件？

> ID：10081588
> 
> 赞同：1
> 
> 时间：2012-04-10T00:33:09.030
> 
> 标签：qt, events, mouseevent, xorg, qt4.7

我现在想在 X11 中捕获全局鼠标点击事件

我试图安装一个 x11event 过滤器，但它不能在全局范围内工作。

```
class XApplication: public QApplication
{
  public:
    XApplication (int & argc, char **argv):
        QApplication (argc , argv)
    {
    }

protected:
    bool x11EventFilter (XEvent *e)
    {
        qDebug() << "X11 Event: " << e->type;
        return QApplication::x11EventFilter(e);
    }
}; 
```

**更新**

我的意思是在窗口之外，当我单击窗口时，上面的代码有效。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-12T14:53:58.347

您可以使用 QX11Info 类从 Qt 查询 X11 信息。请参阅其文档。然后您可以从中使用原始 Xlib。

您可以使用`XGrabPointer()`. 如果你使用它，其他应用程序在抓取指针时不会收到指针事件。`man XGrabPointer`会帮助你。

订阅事件的“正常”方式是`XSelectInput()`在窗口上使用，但问题是您必须在每个现有窗口上调用 XSelectInput。请参阅其手册页...

我知道 xxf86dga 扩展有一些与鼠标相关的调用，但我不确定它们是做什么的。

`XQueryPointer()`是另一种查询指针状态而不从其他窗口窃取事件的方法。

我能想到的唯一其他地方是 XInput 扩展，但我也不确定它是否会对您有所帮助。

`xev`有关处理 X11 事件的良好参考，请参阅源代码：http: [//cgit.freedesktop.org/xorg/app/xev](http://cgit.freedesktop.org/xorg/app/xev)

使用 XGrabPointer 的示例代码：

```
#include <stdio.h>
#include <assert.h>
#include <X11/Xlib.h>

int main(void)
{
        Display *d;
        Window root;

        d = XOpenDisplay(NULL);
        assert(d);

        root = DefaultRootWindow(d);

        XGrabPointer(d, root, False, ButtonPressMask | ButtonReleaseMask |
                     PointerMotionMask, GrabModeAsync, GrabModeAsync, None,
                     None, CurrentTime);

        XEvent ev;
        while (1) {                     
                XNextEvent(d, &ev);  
                switch (ev.type) { 
                case ButtonPress:
                        printf("Button press event!\n");
                        break;
                case ButtonRelease:
                        printf("Button release event!\n");
                        break;
                case MotionNotify:
                        printf("Motion notify event!\n");
                        break;
                default:
                        printf("Unknown event...\n");
                } 
        } 

        XCloseDisplay(d);
        return 0;
} 
```

编译使用：`gcc x11mouse.c -o x11mouse -lX11`

# c - 在 C 中处理 MacOSX 上的 BSTR

> ID：10081590
> 
> 赞同：1
> 
> 时间：2012-04-10T00:33:30.713
> 
> 标签：c, macos, vba, bstr

当从 MacOSX dylib 从 VBA 调用 C 代码时，我用 C 编写了一些代码来转换从 VBA 传递的字符串。我在[这里](https://stackoverflow.com/questions/9919066/return-string-to-vba-in-macosx)得到了一些很好的提示，因为我只关心 ASCII 字符串，所以我编写了以下函数来将其转换`BSTR`为简单的`char*`：

```
#include <stdlib.h>
#include <stdio.h>
#include <stdint.h>
#include "myheader.h"

size_t vbstrlen(BSTR *vbstr)
{
    size_t len = 0U;
    while(*(vbstr++)) ++len;
    len = len*2;
    return len;
}

void vbstochr(BSTR *vbstr, char** out)
{
    int len2 = vbstrlen(vbstr);
    char str[len+1];

    int i;

    for(i = 0; i < len; i++)
    {
        str[i] = (char) (((uint16_t*) vbstr)[i]);
    }

    str[i] = '\0';

    asprintf(out, str);
}

int test(BSTR *arg1)
{
    char* convarg;
    vbstochr(arg1, &convarg);

    return 1;
} 
```

myheader.h 看起来像这样：

```
typedef uint16_t OLECHAR;
typedef OLECHAR * BSTR; 
```

. 我使用`uint16_t`MacOSX C 编译器中的 4 字节（不是 2 字节）wchar_t。我在调用后添加了一个断点`vbstochar`来查看 的内容`convarg`，从 Excel 调用它似乎可以工作。

所以这行得通，但我不明白的一件事是为什么我必须将函数`len`中的我乘以`vbstrlen`2。我是 C 的新手，所以我不得不稍微阅读一下指针 - 我想自从我的 BSTR包含 2 个字节的字符，我应该得到正确的字符串长度而不必乘以 2？如果有人可以向我解释这一点，或者发布指向教程的链接，那就太好了？

此外，我的带有字符串参数的函数在 VBA 中调用时有效，但仅在第一次调用之后。因此，当我`BSTR*`第一次使用来自 dylib 的参数调用函数时（在我启动应用程序后，在本例中为 Excel），`BSTR*`指针只指向某个（随机？）地址，而不是字符串。当我第二次从 VBA 调用该函数时，一切正常 - 任何想法为什么会这样？！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T01:39:53.837

BSTR 具有嵌入长度，您无需手动计算长度。

至于需要将长度乘以2，那是因为BSTR使用2字节字符，但`char`只有1字节。您编写了 vbstrlen() 函数以返回 BSTR 中的字节数，而不是字符数。

由于您只对 ASCII 字符串感兴趣，因此可以将代码简化为以下内容：

```
#include <stdlib.h> 
#include <stdio.h> 
#include <stdint.h> 
#include "myheader.h" 

size_t vbstrlen(BSTR *vbstr) 
{ 
    if (vbstr)
      return *(((uint32_t*)vbstr)-1);
    return 0; 
} 

void vbstochr(BSTR *vbstr, char** out) 
{ 
    size_t len = vbstrlen(vbstr); 
    char str[len+1] = {0};

    for(size_t i = 0; i < len; ++i) 
        str[i] = (char) vbstr[i]; 

    asprintf(out, str); 
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T01:31:12.107

VB 字符串可能是 UTF-16 字符串，每个字符使用 2 个字节（BMP、基本多语言平面或 U+0000..U+FFFF 之外的字符除外，它们被编码为代理对）。因此，对于您的“ASCII”数据，您将交替使用 ASCII 字符和零字节。“乘以 2”是因为 UTF-16 使用两个字节来存储每个计数的字符。

当我们看到时，这几乎是确定的：

```
typedef uint16_t OLECHAR;
typedef OLECHAR * BSTR; 
```

# html - 嵌套列表中的 IE 7 bug div 破坏了布局

> ID：10081591
> 
> 赞同：0
> 
> 时间：2012-04-10T00:33:32.363
> 
> 标签：html, css, internet-explorer-7

我正在开发一个具有侧边栏嵌套列表的网站。父 li 有子 li 结构。在第一次显示时，显示 4 li（列表项），上面的 4 项应隐藏，并带有指向“全部显示”选项的链接。

html代码：

```
<div id="sideMenuBox">
<div class="header">
    <h2 class="cufon">KATEGORİLER</h2>
    <a class="moreLink" href="#" title="">Tümü</a>
</div>
<div class="body"> <!-- menubox body -->
    <ul id="sideMenu">
        <li>
            <span><img src="images/icon-1.png" alt="icon" width="32" height="19" /></span>
            <a href="#" title="">Alışveriş Merkezleri</a>
            <ul>
                <li><a href="#" title="">Online Alışveriş Siteleri</a></li>
                <li><a href="#" title="">Kuyumcular</a></li>
                <li><a href="#" title="">Hediyelik Eşya</a></li>
                <li><a href="#" title="">Çiçek Sektörü</a></li>
                <div class="sbSubMenu" style="border:black 1px solid">
                    <li><a href="#" title="">Kuyumcular</a></li>
                    <li><a href="#" title="">Kuyumcular</a></li>
                    <li><a href="#" title="">Kuyumcular</a></li>
                    <li><a href="#" title="">Kuyumcular</a></li>
                </div>  <!--// sidebar submenu -->
                <li><a class="showAll" href="javascript:" title="" onclick="javascript:showMenu(this);">show all</a></li>
            </ul>
            <br class="clearFix" />
        </li>
    </ul>
</div> <!-- // menubox body -->
<div class="bottom"></div>
</div> <!-- // sideMenuBox --> 
```

和 CSS 代码是：

```
#sideMenu { 
width:200px; height:auto;
margin:10px auto;
}
#sideMenu li{ 
list-style-type:none; 
min-height:25px;
line-height:18px;
height:auto;
border:blue 1px solid;
}
#sideMenu hr { width:100%; height:1px; color:#e69000; background:#e69000; margin:10px auto 5px; border:0;}
#sideMenu li span { width:40px; float:left;}
#sideMenu li a{ 
color:#003a69;
text-decoration:none;
font-size:16px;
font-weight:bold;
margin:0; padding:0;
}
#sideMenu li li { 
margin-left:50px; 
display:inline-block; 
line-height:20px; 
border:red 1px solid;
}
#sideMenu li li a { font-size:13px; height:1px;}
#sideMenu li li a.showAll,
#sideMenu li li a.showLess{ 
color:006aa6; 
text-decoration:underline; 
font-size:12px; 
font-weight:normal;
margin:10px 0;
padding-right:15px;
background:url(../images/arrow-down-blue.png) right center no-repeat;
}
#sideMenu li li a.showLess{ background:url(../images/arrow-up-blue.png) right center no-repeat;}
#sideMenu .sbSubMenu { 
width:100%; height:auto;
} 
```

这些代码在 Firefox、Chrome 和 IE8 中运行良好，但在 IE7 中包含在 li. 包含在其中的 lis 正在渲染出破坏布局的 div。如果我从代码中删除它，那么它的工作正常，但为了满足项目的要求，我必须在四个之后隐藏列表项，这就是为什么我将列表项包含在一个 div 中以默认隐藏。

我已经设置了一个在线演示页面来解决这个问题并获得专家的建议。你可以看到这个页面现场演示页面：[http ://tinyurl.com/7pqo5ob](http://tinyurl.com/7pqo5ob)

注意：我添加了一些边框来了解列表项和 div 在 IE 中是如何呈现的。它在其他浏览器中运行良好，但在 IE7 中效果不佳。我尝试了很多选择，但徒劳无功。

请指教。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-15T20:41:15.747

非常感谢您的关心。我尝试了很多技巧，最后我得到了它。实际问题出在嵌套的无序列表和列表项结构中。在“LI”的内部结构中，我放置了一个默认隐藏的“DIV”标签。这是 IE 7 开始破坏布局的地方。如果我删除“DIV”标签，那没关系，但在项目要求中，“DIV”应该在那里隐藏“LI”。

经过数小时的挫折后，我尝试将“DIV”更改为“LI”，并且它在 IE7 和其他浏览器中也能正常工作。

最终代码为：

```
<ul id="sideMenu">
  <li>
       <span><img src="images/icon-1.png" alt="icon" width="32" height="19" /></span>
       <a href="#" title="">Alışveriş Merkezleri</a>
       <ul>
           <li><a href="#" title="">Online Alışveriş Siteleri</a></li>
           <li><a href="#" title="">Kuyumcular</a></li>
           <li><a href="#" title="">Hediyelik Eşya</a></li>
           <li><a href="#" title="">Çiçek Sektörü</a></li>
           <li class="sbSubMenu"> <!-- hidden list items -->
              <ul>
                  <li class="innerList"><a href="#" title="">Kuyumcular</a></li>
                  <li class="innerList"><a href="#" title="">Kuyumcular</a></li>
                  <li class="innerList"><a href="#" title="">Kuyumcular</a></li>
                  <li class="innerList"><a href="#" title="">Kuyumcular</a></li>
              </ul>
           </li>  <!-- // sidebar submenu -->
           <li class="Link"><a class="showAll" href="javascript:" title="" onclick="javascript:showMenu(this);">show all</a></li>
       </ul>
     </li> <!-- // main List Item --->
   </ul> 
```

您可以使用 IE7 实时查看此页面。链接： http: [//www.designforce.us/demo/kktc/index.html](http://www.designforce.us/demo/kktc/index.html)

谢谢

# javascript - JavaScript 中命名函数是否优于匿名函数？

> ID：10081593
> 
> 赞同：64
> 
> 时间：2012-04-10T00:33:41.147
> 
> 标签：javascript

> **可能重复：**
> [JavaScript：var functionName = function() {} vs function functionName() {}](https://stackoverflow.com/questions/336859/javascript-var-functionname-function-vs-function-functionname)

在 Javascript 中提取函数有两种可能的方法：

```
var foo = function() { ... } 
```

这有点做作；另一个常见的模式是：

```
var foo = {
   baz: 43,
   doSomething: function() {
       // ...
   }
} 
```

相对

```
function foo() { 
  // ... 
} 
```

是否有明确的理由偏爱其中一个？

* * *

## 回答 #1

> 赞同：87
> 
> 时间：2012-04-10T00:57:49.613

这一切都取决于您声明函数的位置；吊装。

函数声明和变量声明总是被 JavaScript 解释器以不可见的方式移动（“提升”）到其包含范围的顶部。显然，函数参数和语言定义的名称已经存在。这意味着这样的代码：

```
function foo() {
    bar();
    var x = 1;
} 
```

实际上是这样解释的：

```
function foo() {
    var x;
    bar();
    x = 1;
} 
```

请注意，声明的赋值部分没有被提升。只有名字被吊起。这不是函数声明的情况，整个函数体也将被提升。

```
function test() {
    foo(); // TypeError "foo is not a function"
    bar(); // "this will run!"
    var foo = function () { // function expression assigned to local variable 'foo'
        alert("this won't run!");
    }
    function bar() { // function declaration, given the name 'bar'
        alert("this will run!");
    }
}
test(); 
```

在这种情况下，只有函数声明的主体被提升到顶部。名称 'foo' 被提升，但主体被留下，在执行期间被分配。

您可以为函数表达式中定义的函数命名，其语法类似于函数声明。这不会使其成为函数声明，并且名称不会被带入范围，主体也不会被提升。

```
foo(); // TypeError "foo is not a function"
bar(); // valid
baz(); // TypeError "baz is not a function"
bin(); // ReferenceError "bin is not defined"

var foo = function () {}; // anonymous function expression ('foo' gets hoisted)
function bar() {}; // function declaration ('bar' and the function body get hoisted)
var baz = function bin() {}; // named function expression (only 'baz' gets hoisted)

foo(); // valid
bar(); // valid
baz(); // valid
bin(); // ReferenceError "bin is not defined" 
```

因此，如果您希望将函数提升到顶部，请使用`function declaration`else use `expression`。我更喜欢后者，因为我通常使用 as 方法构建对象文字`function expressions`。

`function expressions`当抛出错误时，命名会很方便。控制台会告诉您函数是什么，而不是说明`anonymous`aka **stack trace**。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-04-10T01:25:01.213

您在这里遇到了一些不同的事情，但我会先尝试解决您的主要问题。

一般来说....

`function() { ... }`是一个*函数表达式*。`2`从语法上讲，这与or处于同一级别`[4,5]`。这代表一个**值**。因此`var foo=function(){ ... }`，每次都会按计划进行。

`function foo() { ... }` 是一个函数声明。这似乎与 做同样的事情`var foo=function(){...}`，但有一个小警告。作为一个声明，它的工作方式类似于 JS 中变量提升的概念（基本上，所有变量声明都是在计算任何表达式之前完成的）。

一个很好的例子来自[这里](http://www.adequatelygood.com/2010/2/JavaScript-Scoping-and-Hoisting)：

```
function test() {
    foo(); // TypeError "foo is not a function"
    bar(); // "this will run!"
    var foo = function () { // function expression assigned to local variable 'foo'
        alert("this won't run!");
    }
    function bar() { // function declaration, given the name 'bar'
        alert("this will run!");
    }
}
test(); 
```

基本上变量提升已将值提升到顶部，因此此代码（*理论上*）等效于：

```
function test() {
    var foo;//foo hoisted to top
    var bar=function(){//this as well
        alert("this will run!");
    }

    foo(); // TypeError "foo is not a function"
    bar(); // "this will run!"
    var foo = function () { // function expression assigned to local variable 'foo'
        alert("this won't run!");
    }
} 
```

* * *

注意：我想借此机会说 JS 解释器很难遵循理论，因此不建议在有些不确定的行为上相信他们。[在这里](http://kangax.github.com/nfe/#expr-vs-decl)，您会在一节的末尾找到一个很好的例子，理论和实践最终都不起作用（还有一些关于表达式与声明主题的更多细节）。

有趣的事实：`function foo() {...}`用括号括起来会将它从声明转换为表达式，这可能会导致一些看起来很奇怪的代码，例如

```
(function foo() { return 1; })();// 1
foo; //ReferenceError: foo is not defined 
```

如果没有理由，请不要这样做。

* * *

**摘要** `var foo=function(){ ... }`*sorta * 与 function 相同，`foo(){ ... }`只是前者在你认为它应该做的地方做你认为它应该做的事情，而后者做一些奇怪的事情，除非你将它包装在括号中，但这会弄乱范围，并且 JS 解释器允许你做一些在规范中被认为是语法错误的事情，所以你被引导相信错误的事情实际上是正确的，等等......

**请使用函数表达式**( `var f=function(){...}`)。没有真正的理由不这样做，尤其是考虑到当您使用点语法时您有些被迫这样做。

* * *

关于你触及的第二件事......

我真的不知道该说什么，这*有点*与其他关于此的事情完全不同。

```
var foo = {
    baz: 43,
    doSomething:function() {
        ...
    }
} 
```

这被称为对象字面量语法。基于这种语法的 JSON 是[一种非常简洁的数据格式化方式，](http://json.org/) JS 中的这种语法通常用于声明新对象，例如单例对象（避免声明函数和使用 new 的所有混乱） . 它也可以以与使用 XML 相同的方式使用，并且是所有酷孩子的首选...

无论如何，基本上对象字面量语法是这样工作的：

```
{ name1: val1, .... namek:valk } 
```

这个表达式是一个对象，上面初始化了某些值。这样做`var obj={ name1: val1, .... namek:valk }`意味着：

```
obj.name1==val1;
obj['name1']==val1;// x['y'] is the same thing as x.y 
...
obj.namek==valk; 
```

那么这与我们的例子有什么关系呢？基本上，您的表达式通常用于声明单例对象。但是它也可以用来声明一个对象原型，所以以后有人可以做 var newObj=Object.create(foo) ，newObj 就会有 foo 作为原型。

如果您想真正了解原型继承的用途，请仔细研究它。道格拉斯·克罗克福德（Douglas Crockford ）在他的众多演讲[之一中详细讨论了它）。](http://www.youtube.com/watch?v=hQVTIJBZook&feature=related)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-10T01:05:52.383

命名函数没有什么好处

*   元分析的名称。`functionInstance.name`会告诉你名字。
*   更重要的是，名称将打印在堆栈跟踪中。
*   名称还有助于编写自我记录或识字代码。

命名函数表达式有一个缺点

*   IE 存在 NFE 内存泄漏

除了较少的风格控制之外，函数声明没有任何缺点

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-10T01:10:34.390

您的问题实际上由两部分组成，因为如果将函数分配给变量或属性，您不一定必须将它们设为匿名。

**命名与匿名？**

@Raynos 清楚地强调了要点。命名函数最好的部分是它们将在堆栈跟踪中显示自己。即使在将函数分配给变量/属性的情况下，为函数命名以帮助调试也是一个好主意，但我不会说匿名函数根本是邪恶的。它们确实有很好的用途：

[匿名函数在 JavaScript 中是一种不好的做法吗？](https://stackoverflow.com/questions/3462255/are-anonymous-functions-a-bad-practice-in-javascript)

**函数声明与函数表达式？**

对于问题的那一部分，我建议您参考这个问题，因为它可能比我能更深入地涵盖该主题

[var functionName = function() {} vs function functionName() {}](https://stackoverflow.com/questions/336859/javascript-var-functionname-function-vs-function-functionname)

# mysql - 如何分析 WordPress 安装的慢查询日志？

> ID：10081594
> 
> 赞同：1
> 
> 时间：2012-04-10T00:33:43.487
> 
> 标签：mysql, performance, wordpress

我在安装 WordPress 时遇到了一些性能问题。我已经运行了多个慢查询测试，虽然我确实看到了它们之间的一些一致性，但我仍然无法查明问题所在。以下是我多次看到的一些查询：

```
SET timestamp=1333980631;
SELECT SQL_CALC_FOUND_ROWS wp_posts.* FROM wp_posts INNER JOIN wp_term_relationships ON (wp_posts.ID = wp_term_relationships.object_id) WHERE 1=1 AND ( wp_term_relationships.term_taxonomy_id IN (1442,4054) ) AND wp_posts.post_type = 'post' AND (wp_posts.post_status = 'publish' OR wp_posts.post_status = 'private') GROUP BY wp_posts.ID ORDER BY wp_posts.post_date DESC LIMIT 0, 2; 
```

和

```
### 1 Query 
### Total time: 3.015405, Average time: 3.015405
### Taking 3.015405 seconds to complete
### Rows analyzed 60
SET timestamp=XXX;
SELECT SQL_CALC_FOUND_ROWS wp_posts.* FROM wp_posts INNER JOIN wp_term_relationships ON (wp_posts.ID = wp_term_relationships.object_id) WHERE XXX=XXX AND ( wp_term_relationships.term_taxonomy_id IN (XXX) ) AND wp_posts.post_type = 'XXX' AND (wp_posts.post_status = 'XXX') GROUP BY wp_posts.ID ORDER BY wp_posts.post_date DESC LIMIT XXX, XXX;

SET timestamp=1334004964;
SELECT SQL_CALC_FOUND_ROWS wp_posts.* FROM wp_posts INNER JOIN wp_term_relationships ON (wp_posts.ID = wp_term_relationships.object_id) WHERE 1=1 AND ( wp_term_relationships.term_taxonomy_id IN (125) ) AND wp_posts.post_type = 'post' AND (wp_posts.post_status = 'publish') GROUP BY wp_posts.ID ORDER BY wp_posts.post_date DESC LIMIT 0, 8; 
```

和

```
### 1 Query 
### Total time: 1.593301, Average time: 1.593301
### Taking 1.593301 seconds to complete
### Rows analyzed 19755
SET timestamp=XXX;
SELECT /*!XXX SQL_NO_CACHE */ * FROM `wp_posts`;

SET timestamp=1333978522;
SELECT /*!40001 SQL_NO_CACHE */ * FROM `wp_posts`; 
```

我注意到这`wp_term_taxonomy`似乎与`wp_posts`以及其他一些一起出现。我的问题是，如何缩小这些结果并找到问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-10T13:34:13.730

你可以：

1.  使用[插件性能分析器](http://wordpress.org/extend/plugins/p3-profiler/)对有问题的插件进行基准测试和查明
2.  用[新遗物](http://newrelic.com/)找问题
3.  使用[调试对象](http://wordpress.org/extend/plugins/debug-objects/)转储查询数据等。

queries you showed looks like usual wp-admin queries, or pager query to define how many pages to show on listings.

you could also try simplest approach - to disable plugins one by one to determine which one is generating your problematic queries.

# java - Grails 错误别名导致错误 ORA-00904

> ID：10081601
> 
> 赞同：0
> 
> 时间：2012-04-10T00:35:07.120
> 
> 标签：java, oracle, grails, grails-orm, ora-00904

我有三个域类`User`，`Employee`和`UserEmployee`.

```
class User {
    String username
    //more atributes omitted 

    static hasMany = [ userEmployees : UserEmployee ]
    static mapping = {
      version false
      table 'myUserTable'
       id column: 'username', name: 'username' 
    }
}

class Employee {
    long employeeCode
    //more atributes omitted 
    static hasMany = [ userEmployees : UserEmployee ]
    static mapping = {
       id column: 'myColumn', name: 'employeeCode' 
       version false
       table 'myViewHere'
    }
}

class UserEmployee implements Serializable {
    User user
    Employee employee
    static belongsTo = [ user : User,  employee : Employee ]
    static mapping = {
      version false
      table 'myRelationTable'
      id composite: ['user','employee']
      user(column: "username")
      employee(column: "myColumn")
    }
} 
```

当我尝试查询某个用户可以访问的所有员工时，我收到 ORA-00904 错误：

```
println UserEmployee.withCriteria {
    projections {
       user {
           eq('username', 'SOMEUSER')
       }
    }
} 
```

休眠输出是这样的：

```
Hibernate: select * from ( select this_.username as usuario27_0_, from myUserTable this_ where this_.username=? ) where rownum <= ?

Hibernate: select this_.username as usuario24_0_, this_.code_employee as cod2_24_0_ from myRelationalTable this_ where (usu_alias1x1_.username=?) 
```

为什么要`usu_alias1x1_`创建别名？

PS：我更改了域类名称和字段以更好地理解。也许会在某个地方出现错字。

**编辑**

我正在映射一个已经存在且无法将 PK 更改为 Grails 默认值的数据库。所以我使用`id column`来声明密钥。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T06:05:14.030

您在员工和用户中使用“id cloumn:”。必须是“列”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T13:50:21.317

好吧，我将查询更改为：

```
Employee.createCriteria().list() {
  projections {
    userEmployees {
      eq('user', someUser)
    }
  }
} 
```

# c++ - 获取文件数据后刷新 cout 的问题

> ID：10081605
> 
> 赞同：1
> 
> 时间：2012-04-10T00:35:29.230
> 
> 标签：c++, file, segmentation-fault, buffer, ifstream

我正在尝试编写 rc4 的实现。我正在使用 ifstream 从文件中读取纯文本。我注意到它没有在文件末尾输出，所以我尝试了各种显式清除缓冲区的方法。无论采用哪种方式（使用 endl、附加 \n、调用 cout.flush()）我尝试刷新缓冲区，都会出现段错误。作为健全性检查，我用来自网络的示例替换了我的代码，我也单独对其进行了测试。如果我把它放在自己的文件中并编译它，它就可以工作（例如，它打印出文件的内容，没有段错误，并且不需要任何对 flush() 或 endl 的调用），但不是在我的代码中。

这是有问题的代码（在我的代码之外可以正常工作；它几乎是直接从 cplusplus.com 复制的）

```
 ifstream is;
 is.open("plain");
 char c;
 while (is.good())     // loop while extraction from file is possible
 {
     c = is.get();       // get character from file
     if (is.good())
         cout << c;
//       cout.flush();
 }
 is.close();           // close file*/ 
```

这是完整的代码：（警告，很多注释掉的代码）

```
#include <iostream>
#include <fstream>
#include <string.h>
#include <vector>

using namespace std;
static char s[256], k[256];
//static char *i, *j;
void swap(int m, int n, char t[256]){
        char tmp = t[m];
        t[m] = t[n];
        t[n] = tmp;
}

char getByte(){
        static char i(0), j(0);
        i = (i+1)%256;
        j = (j + s[i])%256;
        swap(i, j, s);
        return s[(s[i]+s[j]) % 256];
}

int main(int argc, char ** argv){
        /*string key = argv[1];*/
        if(argc < 4){
                cout << "Usage: \n rc4 keyfile plaintextfile outputfile" << endl;
                return -1;
        }
        string key;
        ifstream keyfile (argv[1]);
        keyfile >> k;
        cout << "Key = " << k << endl;
        keyfile.close();
        /*ifstream plaintextf;
        plaintextf.open(argv[2]);*/

        ofstream ciphertextf (argv[3]);

        for(int q = 0; q < 256; q++){
                s[q] = q;
        }
        int i, j;
        for(int m = 0; m < 256; m++){
                j = (j + s[m] + k[m % sizeof(k)])%256;
                swap(m, j, s);
        }
//      vector<char> bytes(plaintext.begin(), plaintext.end());
//      bytes.push_back('\0');
//      vector<char>::iterator it = bytes.begin();
/*      char pt;
        while(plaintextf.good()){
                pt = plaintextf.get();
                if(plaintextf.good()){
                        cout << pt;

                      ciphertextf <<(char) (pt ^ getByte());
                }

        } */
        ifstream is;
        is.open("plain");
        char c;
         while (is.good())     // loop while extraction from file is possible
         {
            c = is.get();       // get character from file
            if (is.good())
              cout << c;
//              cout.flush();
         }
  is.close();           // close file*/

/*//    plaintextf.close();
        ciphertextf.close();
        keyfile.close();
        */
        return 0;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T01:23:31.550

此外，我认为第二次调用 is.good() [ 如 if(is.good()) ] 会阻止文件的最后一个字符被复制。

# node.js - 猫鼬模式创建

> ID：10081611
> 
> 赞同：44
> 
> 时间：2012-04-10T00:35:38.253
> 
> 标签：node.js, mongodb, mongoose

我刚开始使用猫鼬。我有一个带有 mongoose 的创建脚本，它使用示例数据创建模式和数据库。

现在我编写实际的应用程序。每次我的应用程序运行时，我是否需要创建模式对象，或者它是否已经以某种方式可用？

换句话说，我是否需要在每个使用 mongoose 访问数据库的应用程序中运行此代码，或者只是第一次运行此代码：

```
var Comments = new Schema({
    title     : String
  , body      : String
  , date      : Date
}); 
```

如果我有设置器/验证器/等，答案将如何变化？

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2012-04-10T04:35:51.920

一个定义`Schema`以便应用程序了解如何将数据从 MongoDB 映射到 JavaScript 对象。`Schema`是应用程序的一部分。它与数据库**无关。**它仅将数据库映射到 JavaScript 对象。所以是的——如果你想有一个很好的映射，你需要在**每个**需要它的应用程序中运行这个代码。它也适用于 getter/setter/validations/etc。

但是请注意，这样做：

```
var mongoose = require('mongoose');
var Schema = mongoose.Schema; // <-- EDIT: missing in the original post
var Comments = new Schema({
    title     : String
  , body      : String
  , date      : Date
});
mongoose.model("Comments", Comments); 
```

将在全球范围内注册`Schema`。这意味着如果您正在运行的应用程序正在使用一些外部模块，那么在这个模块中您可以简单地使用

```
var mongoose = require('mongoose');
var Comments = mongoose.model("Comments");
Comments.find(function(err, comments) {
    // some code here
}); 
```

（注意，在使用此代码之前，您实际上需要注册`Schema`，否则会抛出异常）。

然而，所有这些都只在一个节点会话中起作用，所以如果您正在运行另一个需要访问的节点应用程序`Schema`，那么您需要调用注册码。因此，在单独的文件中定义所有 Schema 是一个好主意，例如`comments.js`可能看起来像这样

```
var mongoose = require('mongoose');
var Schema = mongoose.Schema; // <-- EDIT: missing in the original post

module.exports = function() {
    var Comments = new Schema({
        title     : String
      , body      : String
      , date      : Date
    });
    mongoose.model("Comments", Comments);
}; 
```

然后创建`models.js`可能看起来像这样的文件

```
var models = ['comments.js', 'someothermodel.js', ...];

exports.initialize = function() {
    var l = models.length;
    for (var i = 0; i < l; i++) {
        require(models[i])();
    }
}; 
```

现在调用`require('models.js').initialize();`将为给定节点会话初始化所有模式。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-18T00:26:15.897

每次运行应用程序时都需要运行此初始化代码，以便向 mongoose 注册应用程序的 Schema。

当您的应用程序结束时，猫鼬不会存储您的架构。因此，下次您运行使用 Schema 的应用程序时，您需要再次注册您的 Schema(s)。

但是，设置您的应用程序来执行此操作相当容易。

这里有两个代码链接，演示了如何在 mongoose 中初始化模式。第一个是 JavaScript，第二个是 CoffeeScript。

[https://github.com/fbeshears/register_models](https://github.com/fbeshears/register_models)

[https://github.com/fbeshears/register_coffee_models](https://github.com/fbeshears/register_coffee_models)

JavaScript 演示只是一个应用程序。

CoffeeScript 代码有两个独立的应用程序。第一个使用 MongoDB 存储文档，第二个查找并显示第一个应用程序存储的文档。

# libraries - 如何在 C++ 应用程序中包含 boost 库？

> ID：10081612
> 
> 赞同：2
> 
> 时间：2012-04-09T23:31:27.550
> 
> 标签：libraries, c++

我对Linux 和终端*非常*缺乏经验，但我正在努力学习。我以前也从未包含过外部库。现在我需要将 Boost.Asio 库包含在 Ubuntu 中使用 G++ 开发的程序中。

有人可以从一开始就非常友善且非常仔细地解释如何解决这个问题吗？

编辑：

扩展最初的问题：如果我需要将此代码发送给其他人，以便他们在完全独立的机器上但在相同的环境中运行它，我该如何考虑这一点？如果整个过程涉及将库文件与代码放在同一个文件夹中，我是否只需将这些库文件与 .cpp 一起发送给其他人？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T01:04:29.503

您已经提到您使用的是 Ubuntu，因此使用 boost 的最简单方法是首先安装`libboost-all-dev`包（来自 synaptic），它将为您安装所有内容，包括需要编译的内容。然后你只需要以`g++`通常的方式使用。

请注意版本是否是您想要的，如果不是，您可能需要自己安装。另一方面，boost 主要是仅标头库，因此您只需将文件（在 Ubuntu 中右键单击...）解压缩到一个文件夹并在编译时链接到它：

```
g++ hello_world.cpp -I boost_1_49_0/boost 
```

最后一个指定编译器查找boost头文件的路径（请使用绝对路径）。

如果你想把你的程序发给别人，不要只复制一些boost文件，因为依赖，它不起作用。要求他们安装与您相同的环境，这很容易（只需解压缩文件...）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T00:46:58.143

我不知道您的特定 IDE 或具体的 Boost.Asio，但总的来说：

每当您需要链接到某个库时，都会有一个名为 的文件`lib???.a`，您需要该文件。您需要将`-l???`标志传递给以`g++`链接到文件。

（我自己对细节不太熟悉，所以可能还有其他文件格式等等......）

* * *

关于编辑：

“正确”的方法是让他们自己下载库，然后传递`-l???`给他们的链接器。在你的源代码中包含 Boost 会使它变得*巨大*，而且没有充分的理由......毕竟，它不像你在代码中包含 STL。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-10T01:16:24.453

您不包含该库，而是声明对它的依赖。例如。考虑您使用[autoconf](http://www.gnu.org/software/autoconf/)和[automake](http://www.gnu.org/software/automake/) ，那么您将添加¹来要求 boost 和要求 ASIO 库。在您的文件中，您使用和宏并依靠 ./configure 正确设置它们。然后，无论谁使用您的代码，都必须运行众所周知的脚本，该脚本将分析环境中的 boost 位置并在构建环境中设置适当的值，以便成功。[`AX_BOOST_BASE`](http://www.gnu.org/software/autoconf-archive/ax_boost_base.html)^([`AX_BOOST_ASIO`](http://www.gnu.org/software/autoconf-archive/ax_boost_asio.html#ax_boost_asio)[`Makefile.am`](http://inti.sourceforge.net/tutorial/libinti/autotoolsproject.html)`BOOST_CPPFLAGS``BOOST_LDFLAGS``./configure``make`)

至少这是理论。在实践中，整个事情被称为[autohell](http://www.shlomifish.org/open-source/anti/autohell/)是有原因的。存在替代品，例如[CMake](http://www.cmake.org/)或 boost 自己的[bjam](http://www.boost.org/boost-build2/doc/html/index.html)。但是概要总是相同的：您在构建配置中声明依赖项，并且使用您的产品的目标位置必须满足要求（这意味着它必须下载/安装所需的 boost 版本，在您的情况下）。否则，您将进入分发二进制文件的业务，并且由于您的应用程序预计将部署在其中的平台/架构/发行版的丰富性，这会引起问题。

显然，如果您使用不同的构建系统，例如[ANT](http://ant.apache.org/manual/index.html)，那么您应该参考该构建系统文档，了解如何声明 boost 的要求。

[1：`ax_boost.m4`不是唯一的提升检测 m4 库，还有其他的，但它是 GNU autoconf 宏列表中记录的那个]

# linux - 在 UNIX 中一次退出目录中许多文件的隐藏属性

> ID：10081614
> 
> 赞同：0
> 
> 时间：2012-04-10T00:35:44.283
> 
> 标签：linux, unix, command, pipeline, hidden-files

大家好。

我想知道是否有一个命令集（可能是一个管道集）可用于更改存储在特定目录中的许多同名文件的隐藏属性。

IE。

```
ls -la inside torrents/music/david_guetta_greatest_hits shows the next files:

drwxrwxrwx  20 crsuarez  staff      680 Apr  9 19:25 .
drwxrwxrwx  20 crsuarez  staff      680 Apr  9 19:11 ..
-rw-r--r--   1 crsuarez  staff  6894561 Apr  9 19:16 .I'm Famous.wma
-rw-r--r--   1 crsuarez  staff  7543777 Apr  9 19:16 .Gettin Over.wma
-rw-r--r--   1 crsuarez  staff  6378465 Apr  9 19:16 .I Gotta Feeling.wma
-rw-r--r--   1 crsuarez  staff  7245793 Apr  9 19:16 .In love with myself.wma
-rw-r--r--   1 crsuarez  staff  7060449 Apr  9 19:16 .It's the Way You Love Me.wma
-rw-r--r--   1 crsuarez  staff  7737313 Apr  9 19:16 .Love Don't Let Me Go.wma
-rw-r--r--   1 crsuarez  staff  7737313 Apr  9 19:16 .Love is Gone.wma
-rw-r--r--   1 crsuarez  staff  6628321 Apr  9 19:16 .Memories.wma
-rw-r--r--   1 crsuarez  staff  7525345 Apr  9 19:16 .Money.wma
-rw-r--r--   1 crsuarez  staff  7806945 Apr  9 19:16 .One Love.wma
-rw-r--r--   1 crsuarez  staff  7192545 Apr  9 19:16 .Sexy Bitch.wma
-rw-r--r--   1 crsuarez  staff  6954977 Apr  9 19:16 .Stay.wma
-rw-r--r--   1 crsuarez  staff  8025057 Apr  9 19:16 .The World is Mine.wma
-rw-r--r--   1 crsuarez  staff  7769057 Apr  9 19:16 .TitaniuM.wma
-rw-r--r--   1 crsuarez  staff  6693857 Apr  9 19:16 .Turn ME ON.wma
-rw-r--r--   1 crsuarez  staff  7215073 Apr  9 19:16 .When Love Takes Over.wma
-rw-r--r--   1 crsuarez  staff  8182753 Apr  9 19:16 .Without YoU.wma 
```

我想用一组命令取消隐藏所有这些文件（我不在乎是否必须使用管道），而不是使用`mv .hidden_file_name not_hidden_file_name`.

解决方案必须是 OSX 投诉。;)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T01:03:24.050

像这样的东西

```
for origname in .[0-9A-Za-z]*
do   
    if [ -f "${origname}" ]; then
        # compute your newname how you want it
        mv "${origname}" "${newname}
    fi
done 
```

你必须决定你想要你的新名字是什么——你会去掉前导点`'.'`，但只做可能会与现有的同名 .wma 文件发生冲突的事情，所以也可以追加`.tmp`——比如：

```
.One Love.wma  --becomes-->  One Love.wma.tmp 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T00:39:11.437

使用`prename`(`rename`在 Debian 派生系统上)。

```
prename 's/^.//' .*.wma 
```

# c++ - OpenCV中的排序矩阵

> ID：10081615
> 
> 赞同：4
> 
> 时间：2012-04-10T00:35:46.547
> 
> 标签：c++, opencv

我在使用**OpenCV的****C++** API 中的`cv::sort`功能时遇到问题。

 ****我正在尝试使用**OpenCV**`cv::Mat`对内容进行排序

 **`cv::sort(InputArray src, OutputArray dst, int flags);`

以下代码给了我一个编译错误。我不确定这段代码有什么问题：

```
using namespace std;
using namespace cv;
int main(int argc, char** argv)
{
    Mat matrix(5,5,CV_32F,Scalar(0)),m;
    randn(matrix, 2.00, 1.00);
    cout<<"before sorting:\n"<<matrix<<endl;
    sort(matrix, m, CV_SORT_EVERY_ROW + CV_SORT_ASCENDING);
    cout<<"after sorting:\n"<<m<<endl;
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-10T01:03:02.150

你必须使用 cv::sort() 而不是 sort()，即使你正在使用命名空间 cv。这是因为 C++ 在命名空间 std 中有一个 sort() 的实现，简单地使用 sort() 会产生冲突。******

# php - PHP重定向到另一个页面并传递值？

> ID：10081619
> 
> 赞同：1
> 
> 时间：2012-04-10T00:35:54.227
> 
> 标签：php

我有一个问题，我需要重定向到另一个页面并传递一个值，这很容易而且我知道该怎么做，除了旧的标题问题：**无法修改标题信息 - 标题已经由 ... 第 17 行发送**

```
<?php include('m_a2_functions.php'); ?>
<?php global_header(LOGIN); ?>
<?php login(); ?>
<?php 
if(isset($_POST['submit']))
{
    connect();
    $username = $_POST['username'];
    $password = $_POST['password'];

    $query = "SELECT password from users where username = '$username'";
    $result = mysql_query($query) or die ("There was an error executing the query $query:<br/>".mysql_error());
    $row = mysql_fetch_array($result);
    $encrypted_pass = $row[0];

    if (crypt($password, $encrypted_pass) == $encrypted_pass) {
        $flag = "y";
        header('Location: m_a2_view.php?flag=y');
    }

}
?>
<?php validation(); ?>
<?php page_footer(); ?> 
```

这一切都很好，只是标题部分有问题。它不会重定向。

**FUNCTIONS.PHP 中的全局标题函数**

```
<?php function global_header($page_title){ ?>
<?php echo '<?xml version="1.0" encoding="UTF-8"?>'; ?> <- LINE 17
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
    <head>
        <title><?php echo "MARK - " . $page_title; ?></title>
        <link rel="stylesheet" href="style.css" />
    </head> 
    <body>
    <div id="container">
    <div id="logo"></div>
<?php } ?> 
```

**第 17 行**

```
<?php echo '<?xml version="1.0" encoding="UTF-8"?>'; ?> 
```

我知道这是造成它的原因。它在我的页面开头加载 global_header，然后无法重定向到另一个页面。当我点击提交时，我的页面应该重定向，但它不能！

即使我开始删除东西，它也行不通。在完全摆脱 global_header() 之后，它最终会起作用，这是我做不到的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T00:40:28.130

该错误是由于重定向之前已经有输出引起的。如果你真的想用这种编码风格保持事情的顺序，你可以做的是缓冲所说的输出：

```
<?php ob_start(); ?>
<?php include('m_a2_functions.php'); ?>
<?php global_header(LOGIN); ?>
<?php login(); ?>
<?php 
if(isset($_POST['submit']))
{
    connect();
    $username = $_POST['username'];
    $password = $_POST['password'];

    $query = "SELECT password from users where username = '$username'";
    $result = mysql_query($query) or die ("There was an error executing the query $query:<br/>".mysql_error());
    $row = mysql_fetch_array($result);
    $encrypted_pass = $row[0];

    if (crypt($password, $encrypted_pass) == $encrypted_pass) {
        $flag = "y";
        header('Location: m_a2_view.php?flag=y');
        ob_end_clean(); // Discard the buffer
    } else {
        ob_end_flush(); // Display the contents of the buffer
    }
}
?>
<?php validation(); ?>
<?php page_footer(); ?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T00:42:17.257

您遇到此问题的原因是因为您的脚本是多个打开和`<?php`关闭标签，`?>`它们之间有...`PHP``space``new line`

代替

```
<?php include('m_a2_functions.php'); ?>
<?php global_header(LOGIN); ?>
<?php login(); ?>
<?php 
```

和

```
<?php 
include('m_a2_functions.php');
//global_header(LOGIN);
//login(); 
```

你的脚本

```
 include ('m_a2_functions.php');
    if (isset ( $_POST ['submit'] )) {
        connect ();
        $username = $_POST ['username'];
        $password = $_POST ['password'];

        $query = "SELECT password from users where username = '$username'";
        $result = mysql_query ( $query ) or die ( "There was an error executing the query $query:<br/>" . mysql_error () );
        $row = mysql_fetch_array ( $result );
        $encrypted_pass = $row [0];

        if (crypt ( $password, $encrypted_pass ) == $encrypted_pass) {
            $flag = "y";
            header ( 'Location: m_a2_view.php?flag=y' );
        }

    } else {
        echo global_header ( "LOGIN" );
        login ();
    }

    validation ();
    page_footer ();

    function global_header($page_title) {
        $content = '<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
    <head>
        <title><?php echo "MARK - ' . $page_title . '</title>
        <link rel="stylesheet" href="style.css" />
    </head> 
    <body>
    <div id="container">
    <div id="logo"></div>';

        return $content;
    } 
```

# gcc - 如何从预编译器和链接器路径中消除 /usr/local？

> ID：10081620
> 
> 赞同：0
> 
> 时间：2012-04-10T00:36:11.637
> 
> 标签：gcc, linker

我正在尝试构建一个开源包，但遇到了与我安装的原型库发生冲突的麻烦`/usr/local`，其中“正确”版本位于`/usr`.

```
% (make distclean>/dev/null; ./configure > no_env_conf.log 2>& 1; make > no_env_make.log 2>&1 && echo Success || echo 'Build Error')
Build Error 
```

我想在没有`/usr/local`预编译或链接器路径的情况下进行配置和编译。我以为我可以通过指定适当的环境变量来做到这一点，但这并不完全奏效：

```
% (make distclean>/dev/null; CFLAGS=-I/usr/include LDFLAGS=-L/usr/lib ./configure > no_env_conf.log 2>& 1; make > no_env_make.log 2>&1 && echo Success || echo 'Build Error')
Build Error 
```

但是，如果我只是`/usr/local`从文件系统中删除，那么一切正常：

```
% (sudo mv /usr/local /usr/local_off; make distclean>/dev/null; ./configure > no_env_conf.log 2>& 1; make > no_env_make.log 2>&1 && echo Success || echo 'Compile Error'; sudo mv /usr/local_off /usr/local )
Success 
```

有没有办法`/usr/local`从预编译器和链接器使用的路径中消除？我特别想要可以由`configure`选项或环境变量处理的东西。

*具体上下文：我在`ccache`安装了 v1.2.6 of `zlib`in的 OSX Lion 上构建`/usr/local`，而所需的 in`/usr`恰好是 1.2.5。这个构建实际上是作为更广泛的脚本控制构建 MythTV 及其所有依赖项（包括`ccache`.*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T03:55:59.590

来自“人 gcc”：

```
-nostdinc
   Do not search the standard system directories for header files.
   Only the directories you have specified with -I options (and the
   directory of the current file, if appropriate) are searched. 
```

另请注意，虽然预编译器[确实存在](http://publib.boulder.ibm.com/infocenter/zos/basics/index.jsp?topic=/com.ibm.zos.zappldev/zappldev_111.htm)，但您并没有使用 - 您正在使用常规编译器，因此您应该停止将其称为“预编译器”。

# mysql - 在数据库mysql中保存ios笑脸

> ID：10081623
> 
> 赞同：3
> 
> 时间：2012-04-10T00:36:50.087
> 
> 标签：mysql, ios

我有一个小问题，实际上在我的一个应用程序中，用户可以添加评论，如果他激活笑脸键盘，他可以插入笑脸，但在数据库中它保存了类似“ŸŽðŸ¶ðŸ”的内容，并在 iphone 中看起来像这样，这是正常的:) 但是你有一个解决方案来在我的应用程序中检索这个笑脸（编码，解码..）吗？

谢谢你 。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-10T00:44:28.447

您在此处描述的字符来自 UTF-8 的Emoji[字符](https://en.wikipedia.org/wiki/UTF-8)[集](https://en.wikipedia.org/wiki/Emoji)。这是[您需要的文档，](https://dev.mysql.com/doc/refman/5.0/en/charset-unicode.html)以及相关编码问题的[教程](http://srinix.wordpress.com/2007/08/29/tutorial-how-to-store-utf8-indian-language-data-in-mysql/)。

# python - sqlalchemy 访问父类属性

> ID：10081626
> 
> 赞同：3
> 
> 时间：2012-04-10T00:37:40.017
> 
> 标签：python, oop, sqlalchemy

查看帖子的底部，您可以看到我有三个课程。这里的代码是动态编写的伪代码，未经测试，但它充分显示了我的问题。如果我们需要实际的课程，我可以在明天工作时更新这个问题。所以忽略语法问题和只代表一个想法的代码，而不是可以做我在那里描述的实际“代码”。

问题 1 如果您查看项目搜索类方法，您可以看到当用户进行搜索时，我在基类上调用搜索，然后根据该结果返回正确的类/对象。这有效，但看起来很笨拙。有一个更好的方法吗？

问题 2 如果您查看 KitItem 类，您会发现我正在覆盖标价。如果标志 calc_list 设置为 true，那么我将组件的标价相加，并将其作为套件的标价返回。如果它没有标记为真，我想返回“基本”标价。但是据我所知，没有办法访问父属性，因为在正常设置中它是没有意义的，但是使用 sqlalchemy 和共享表继承它可能很有用。

TIA

```
class Item(DeclarativeBase):
    __tablename__ = 'items'
    item_id = Column(Integer,primary_key=True,autoincrement=True)
    sku = Column(Unicode(50),nullable=False,unique=True)
    list_price = Column(Float)
    cost_price = Column(Float)
    item_type = Column(Unicode(1))
    __mapper_args__ = {'polymorphic_on': item_type}
    __
    def __init__(self,sku,list_price,cost_price):
        self.sku = sku
        self.list_price = list_price
        self.cost_price = cost_price

    @classmethod
    def search(cls):
        """
        " search based on sku, description, long description
        " return item as proper class
        """
        item = DBSession.query(cls).filter(...) #do search stuff here
        if item.item_type == 'K': #Better way to do this???
            return DBSession.query(KitItem).get(item.item_id)

class KitItem(Item):
    __mapper_args__ = {'polymorphic_identity': 'K'}
    calc_list = Column(Boolean,nullable=False,default=False)

    @property
    def list_price(self):
        if self.calc_list:
            list_price = 0.0
            for comp in self.components:
                list_price += comp.component.list_price * comp.qty
            return list_price
        else:
            #need help here
            item = DBSession.query(Item).get(self.item_id)
            return item.list_price

class KitComponent(DeclarativeBase):
    __tablename__ = "kit_components"
    kit_id = Column(Integer,ForeignKey('items.item_id'),primarykey=True)
    component_id = Column(Integer,ForeignKey('items.item_id'),primarykey=True)
    qty = Column(Integer,nullable=False, default=1)
    kit = relation(KitItem,backref=backref("components"))
    component = relation(Item) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T13:15:06.097

**答案 1：**实际上您不需要在这里做任何特别的事情：假设您正确配置了继承层次结构，您的查询将已经为每一行（`Item`或`KitItem`）返回正确的类。这是ORM部分的优势。您可以做的是将查询配置为立即加载属于子项的附加列`Item`（从您的代码中，这只是`calc_list`列），您可以通过指定`with_polymorphic('*')`：

```
@classmethod
def search(cls):
    item = DBSession.query(cls).with_polymorphic('*').filter(...) #do search stuff here
    return item 
```

[在查询哪些表的基本控制中](http://docs.sqlalchemy.org/en/latest/orm/inheritance.html#basic-control-of-which-tables-are-queried)阅读更多信息。
要查看差异，启用 SQL 日志记录，并比较您的测试脚本有无`with_polymorphic(...)`- 您很可能需要`SQL`执行更少的语句。

**答案 2：**我不会用一个纯粹计算的条目覆盖一个属性。相反，我将只创建另一个计算属性（让我们称之为`final_price`），对于两个类中的每一个，它看起来如下所示：

```
class Item(Base):
    ...
    @property
    def total_price(self):
        return self.list_price

class KitItem(Item):
    ...
    @property
    def total_price(self):
        if self.calc_list:
            _price = 0.0
            for comp in self.components:
                _price += comp.component.list_price * comp.qty
            return _price
        else:
            # @note: again, you do not need to perform any query here at all, as *self* is that you need
            return self.list_price 
```

同样在这种情况下，您可能会想到将关系配置`KitItem.components`为预加载，这样计算`total_price`就不会触发额外的 SQL。但是您必须自己决定这是否对您的用例有益（再次分析在您的场景中生成的 SQL）。

# ruby-on-rails - Heroku 应用程序不包含任何 jascript 文件，资产管道没有错误 css 编译正常

> ID：10081629
> 
> 赞同：0
> 
> 时间：2012-04-10T00:38:12.767
> 
> 标签：ruby-on-rails, ruby-on-rails-3, heroku

所以我部署到 heroku 并且我的 javascript 不存在。然而，css 编译得很好。

我的生产.rb

```
 # Disable Rails's static asset server (Apache or nginx will already do this)
 config.serve_static_assets = false

 # Compress JavaScripts and CSS
 config.assets.compress = true

 # Don't fallback to assets pipeline if a precompiled asset is missed
 config.assets.compile = true 
```

我的 application.js 文件

```
 // This is a manifest file that'll be compiled into including all the files listed   below.
// Add new JavaScript/Coffee code in separate files in this directory and they'll     automatically
// be included in the compiled file accessible from  http://example.com/assets/application.js
// It's not advisable to add code directly here, but if you do, it'll appear at the     bottom of the
// the compiled file.
//

//= require jquery
//= require jquery_ujs
//= require "bootstrap.js"
//= require "demo.js"
//= require "highcharts.js"
//= require_tree . 
```

由于另一个问题因此得到解决，因此尝试使用和不使用 .js 扩展名。

heroku 日志中没有任何内容，在 heroku slug 创建期间没有错误。

有任何想法吗？

# spring - Spring 3.5 安全性

> ID：10081630
> 
> 赞同：0
> 
> 时间：2012-04-10T00:38:22.417
> 
> 标签：spring, spring-security

基于 Spring 的应用程序的基于表单的身份验证我需要设计登录页面，这样登录用户和后续 Web 请求的身份验证将验证用户是否已登录，如果未登录则重定向到登录页面。这是经典的 Web 应用程序登录流程。身份验证需要通过自定义逻辑（特定于应用程序）完成。您能提供示例 Spring 配置 3.5 或工作示例应用程序吗？一种方法是通过 Web 过滤器进行登录检查并使用登录控制器。通过 Spring Security 模型有更好的方法吗？任何帮助将不胜感激。

谢谢， Bmis13

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T06:34:25.513

默认方法是使用弹簧安全过滤器链。

Spring Security 已经具备了基于表单的身份验证的所有功能，您唯一需要做的就是

*   配置它
*   编写一个jsp页面（用户名和密码两个输入框）

请参阅此创建文章： http: [//www.mularien.com/blog/2008/07/07/5-minute-guide-to-spring-security/](http://www.mularien.com/blog/2008/07/07/5-minute-guide-to-spring-security/) 它解释了第一步。

也看看这篇文章：[http](http://www.mkyong.com/spring-security/spring-security-form-login-example/) ://www.mkyong.com/spring-security/spring-security-form-login-example/ - 它设置了一些默认值（url），这使得过滤器如何变得更加清晰作品。

# android - android cursor.moveToNext()？

> ID：10081631
> 
> 赞同：10
> 
> 时间：2012-04-10T00:38:22.877
> 
> 标签：android, sql, database, android-cursor

我正在尝试将表中的所有列查询到一个长文本视图和/或字符串中。我知道这可能不是正确的做事方式，但我必须这样做。如果我错了，请纠正我，我的印象是下一步移动将获得该行的下一列：

```
Cursor c = db.get();
if(c.moveToFirst){
  do{
    string = c.getString(0);
  }while(c.moveToNext);
} 
```

我认为这将获得第一列并显示其所有内容，而不是获得第一列和第一行。我究竟做错了什么？在不使用 ListView 的情况下，有没有更好或更真实的方法来获取这些信息？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2013-04-24T07:57:08.573

简单的用法是：

```
Cursor cursor = db.query(...);
while (cursor.moveToNext()) {
    ...
} 
```

当您需要在到达某个位置后从 start 开始迭代时，使用 moveToFirst。

除非需要，否则避免使用 cursor.getCount()。并且永远不要在 getCount() 上使用循环。

getCount 很昂贵——它遍历许多记录来计算它们。它不返回存储的变量。第二次调用可能会有一些缓存，但第一次调用在计算之前不知道答案。

如果您的查询匹配 1000 行，则游标实际上只有第一行。每个 moveToNext 搜索并找到下一个匹配项。getCount 必须找到所有 1000。如果只需要 10，为什么要遍历所有？为什么要迭代两次？

此外，如果您的查询不使用索引，getCount 可能会更慢 - getCount 可能会超过 10000 条记录，即使查询仅匹配 100 条记录。为什么要循环 20000 而不是 10000？

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-10-04T13:29:16.687

为清楚起见，一个完整的示例如下所示，我相信这很有趣。正如代码注释所指出的，我们本质上是遍历数据库行和列，以根据数据库形成一个数据表。

```
 Cursor cursor = getActivity().getContentResolver().query(uri, projection, null, null,
            null);

    //if the cursor isnt null we will essentially iterate over rows and then columns
    //to form a table of data as per database.
    if (cursor != null) {

        //more to the first row
        cursor.moveToFirst();

        //iterate over rows
        for (int i = 0; i < cursor.getCount(); i++) {

            //iterate over the columns
            for(int j = 0; j < cursor.getColumnNames().length; j++){ 

                //append the column value to the string builder and delimit by a pipe symbol
                stringBuilder.append(cursor.getString(j) + "|"); 
            }
            //add a new line carriage return
            stringBuilder.append("\n");

            //move to the next row
            cursor.moveToNext();
        }
        //close the cursor
        cursor.close();
    } 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-10T01:52:56.123

我正在像这样在 cusror 上编写循环：

```
 cursor.moveToFirst();
    while(!cursor.isAfterLast()) {

            cursor.getString(cursor.getColumnIndex("column_name"));

        cursor.moveToNext();
    } 
```

这总是有效的。这将检索所有行的“column_name”列的值。您的错误是您循环遍历行而不是列。要遍历列：

```
cursor.moveToFirst();    
    for(int i = 0; i < cursor.getColumnNames().length; i++){
        cursor.getString(i);
    } 
```

这将遍历第一行的列并检索每个列的值。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-10T01:22:46.497

`cursor.moveToFirst()`将光标移动到第一行。如果您知道您有 6 列，并且想要一个包含所有列的字符串，请尝试以下操作。

```
c.moveToFirst();
StringBuilder stringBuilder = new StringBuilder();
for(int i = 0; i < 6; i++){
   stringBuilder.append(c.getString(i));
}

// to return the string, you would do stringBuilder.toString(); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-10T01:17:43.897

moveToNext 将光标移动到下一行。如果有第一列，c.getString(0) 将始终为您提供第一列。我认为你应该在你的循环中做类似的事情

```
int index = c.getColumnIndex("Column_Name");
string = c.getString(index); 
```

# python - 在文档字符串公式中使用 '\displaymath' 指令

> ID：10081633
> 
> 赞同：11
> 
> 时间：2012-04-10T00:38:45.233
> 
> 标签：python, latex, python-sphinx

我正在使用 Sphinx 文档包来记录我正在研究的一个小型 Python 工具包，我想通过在 Python 文档字符串中以 LaTeX 格式列出各种模块实现的数学公式来描述它们。

`:math:`使用 reStructuredText 的or指令很容易实现这一点`.. math::`，例如：

```
.. math::
   \\displaymath \\sum_{i=1}^{\\infty} x_{i} 
```

但是`\\displaymath`在 Python 文档字符串中，该指令仅以红色文本突出显示。当在`.rst`文件中使用时（例如`index.rst`），这将按预期工作，并且求和的子脚本和上脚本直接位于求和符号的下方和上方。

这只是文档字符串不支持，还是我做错了什么或没有做我需要做的事情？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-04-10T20:52:30.427

您不需要`\displaymath`在 Sphinx 中也不需要额外的转义反斜杠`\sum`和`\infty`.

以下示例函数在使用 调用时在 html 和 Latex 输出中都呈现良好`.. autofunction::`：

```
def test_func(x):
    """This function will try to calculate:

    .. math::
        \sum_{i=1}^{\\infty} x_{i}

    good luck!
    """
    pass 
```

您必须使用该`.. math::`指令，因为内联数学 ( `:math:`) 不起作用。

# php - 更新给定 SESSION 的信息

> ID：10081640
> 
> 赞同：1
> 
> 时间：2012-04-10T00:39:40.843
> 
> 标签：php, mysql

**为什么提交的所有输入都是空白的？**（见下文）。我相信这是由于我的 JS 文件中的错误。

正在提交的 HTML 表单：

```
 <form method="post" id="FanDetail">
                        <textarea id="bio" name="fan_bio" cols="27" rows="3"></textarea><br />
                        <input id="dob" name="fan_dob" value="(e.g. 01/05/1965)" onFocus="clearText(this)" /><br />
                        <div class="ui-widget">
                            <input id="zip" name="term" value="What is your Zipcode?" onFocus="clearText(this)" /><br />
                            <input id="actualZip" type="hidden" name="actualzipval" value="" />
                        </div><!--ui-widget :: zip -->
                        <div class="ui-widget">
                            <input id="occup" type="text"  name="term2" value="e.g. Computer Programmer, etc" onFocus="clearText(this)" /><br />
                            <input id="actualOccup" type="hidden" name="actualOccupval" value="" />
                        </div><!--ui-widget :: occup -->
                        <input id="fbkurl" type="text"  name="fan_fbk" value="e.g. SportsFan12" onFocus="clearText(this)" /><br />
                        <input id="twiturl" type="text"  name="fan_twit" value="e.g. AboutSports2012" onFocus="clearText(this)" /><br />
                        <input id="phoNum" type="text"  name="fan_pho" value="cell or home phone" onFocus="clearText(this)" /><br />
                <input style="background-image:url('../../img/save.png');" type="submit" name="saveAbout" value="" id="submit" />
                </form> 
```

*处理来自 html 表单的输入的 JS 文件：*

```
$(document).ready(function() {
        $("form#FanDetail").submit(function() {
        // store the values from the form input box, then send via ajax below
        var bio = $('#bio').val();
        var dob = $('#dob').val();
        var zip = $('#actualZip').val();
        var occup = $('#actualOccup').val();
        var fbkurl = $('#fbkurl').val();
        var twiturl = $('#twiturl').val();
        var phoNum = $('#phoNum').val();
        $.post(
                "../../src/php/registration/about/submitvalues_about_tab.php",
                $("form#FanDetail").serialize(),
                function(){
                    $('form#FanDetail').hide(function(){
                        $('div.success').fadeIn();
                });
              });
           return false;
        });
    }); 
```

我正在使用的 PHP 文件正在`$fan_sess_id()`正确获取变量值，但其他输入都没有工作。

```
try {
    $sth = null; #kill any possible previous connections
    ///////////////////////////////////////////////
    ######## Get  Input to Submit ############## //
    ///////////////////////////////////////////////
    $fanBio=$_POST['bio'];
    $fanDob=$_POST['dob'];
    $zipval=$_POST['zip'];
    $occupval=$_POST['occup'];
    $facebookurl=$_POST['fbkurl'];
    $twitterurl=$_POST['twiturl'];
    $phoneNum=$_POST['phoNum'];
    //$fanID=1;
    $fan_sess_id = session_id(); // assign $fan_sess_id to the current sessionID

    ### DB Connection already established above.
    $dbh->setAttribute( PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION );  
    $sth = $dbh->prepare("
    UPDATE Fan 
    SET fanBio='$fanBio',fanDob='$fanDob',fanDetLocID='$zipval',occupID='$occupval',
    fanFbk='$facebookurl',fanTwit='$twitterurl',fanPho='$phoneNum'
    WHERE fansessID='$fan_sess_id';
    ");
    $sth->execute();
} 
```

最后，这是我`$sth->debugDumpParams();`在上面的 php 脚本中运行时得到的输出：

```
SQL: [152] 
    UPDATE Fan 
    SET fanBio='',fanDob='',fanDetLocID='',occupID='',
    fanFbk='',fanTwit='',fanPho=''
    WHERE fansessID='90707e4c37762a38ffb50883ce64ee1b'; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-10T01:15:32.833

您需要将输入设置`name`为与访问`$_POST`.

例如：在`<textarea id="bio" name="fan_bio" cols="27" rows="3"></textarea>`更改属性`name`以`bio`获取它的值作为`$_POST["bio"]`.

当您提交 HTML 表单时，表单元素的`name`-attribute 用于引用值，而不是`id`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T01:44:31.433

您使用了错误的数组键来`$_POST`. 您需要使用这些属性，而不是 HTML 表单元素的 id`name`属性。

```
$fanBio=$_POST['fan_bio'];
$fanDob=$_POST['fan_dob'];
$zipval=$_POST['term'];
$occupval=$_POST['occup'];
$facebookurl=$_POST['fan_fbk'];
$twitterurl=$_POST['fan_twit'];
$phoneNum=$_POST['fan_pho']; 
```

你还有另一个非常重要的问题。尽管您使用的是 PDO，但您没有在准备好的语句中使用占位符，这让您自己对 SQL 注入敞开了大门。不要将变量直接传递到 SQL 中，而是用占位符替换它们。

```
 $sth = $dbh->prepare("
    UPDATE Fan 
    SET fanBio=:fanBio,fanDob=:fanDob,fanDetLocID=:zipval,occupID=:occupval,
    fanFbk=:facebookurl,fanTwit=:twitterurl,fanPho=:phoneNum
    WHERE fansessID=:fan_sess_id;
    ");
    $arr_params = array(
     ':fanBio'=>$fanBio, 
     ':fanDob'=>$fanDob,
     ':zipval'=>$zipval,
     ':occupval'=>$occupval,
     ':facebookurl'=>$facebookurl,
     ':twitterurl'=>$twitterurl,
     ':phoneNum'=>$phoneNum,
     ':fan_sess_id'=>$fan_sess_id
    );
    // Execute the statement with the parameters array
    $sth->execute($arr_params); 
```

# android - 在不泄漏内存的情况下更新 Android UI

> ID：10081646
> 
> 赞同：1
> 
> 时间：2012-04-10T00:40:19.007
> 
> 标签：android

我有一个非常简单的 Android Activity，它创建了一个视图和一个计时器。计时器任务通过调用“setTextColor”来更新 UI。执行时，我注意到由“java.util.concurrent.CopyOnWriteArrayList”分配的内存，这是由对“setTextColor”的调用引起的。有没有办法避免这种情况？我的目的是运行这个简单的计时器来监控内存而不修改消耗的内存。

活动如下：

```
public class AndroidTestActivity extends Activity
{
    Runnable updateUIRunnable;  // The Runnable object executed on the UI thread.
    long previousHeapFreeSize;  // Heap size last time the timer task executed.
    TextView text;              // Some text do display.

    // The timer task that executes the Runnable on the UI thread that updates the UI.
    class UpdateTimerTask extends TimerTask
    {
        @Override
        public void run()
        {
            runOnUiThread(updateUIRunnable);
        }       
    }

    @Override
    public void onCreate(Bundle savedInstanceState)
    {
        // Super.
        super.onCreate(savedInstanceState);

        // Create the Runnable that will run on and update the UI.
        updateUIRunnable = new Runnable()
        {
            @Override
            public void run()
            {
                // Set the text color depending on the change in the free memory.
                long heapFreeSize = Runtime.getRuntime().freeMemory();
                if (previousHeapFreeSize != heapFreeSize)
                {
                    text.setTextColor(0xFFFF0000);
                }
                else
                {
                    text.setTextColor(0xFF00FF00);                  
                }
                previousHeapFreeSize = heapFreeSize;
            }           
        };

        // Create a frame layout to hold a text view.
        FrameLayout frameLayout = new FrameLayout(this);
        FrameLayout.LayoutParams layoutParams = new FrameLayout.LayoutParams(LayoutParams.FILL_PARENT, LayoutParams.FILL_PARENT);
        frameLayout.setLayoutParams(layoutParams);

        // Create and add the text to the frame layout. 
        text = new TextView(this);
        text.setGravity(Gravity.TOP | Gravity.LEFT);
        text.setText("Text");           
        frameLayout.addView(text);

        // Set the content view to the frame layout.    
        setContentView(frameLayout);

        // Start the update timer.
        UpdateTimerTask timerTask = new UpdateTimerTask();
        Timer timer = new Timer();
        timer.scheduleAtFixedRate(timerTask, 500, 500);     
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T01:40:16.660

Romainguy 有一篇关于内存泄漏的好帖子：

[避免内存泄漏](http://android-developers.blogspot.com.ar/2009/01/avoiding-memory-leaks.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T20:12:19.443

我找到了解决我的问题的方法。更新显示的文本颜色会产生 24 字节的内存分配。通过对此进行调整，只有在更新文本颜色时，我才能观察到稳定的内存消耗量。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-10T00:45:24.730

[您可以在 Android http://developer.android.com/reference/android/widget/Chronometer.html](http://developer.android.com/reference/android/widget/Chronometer.html)中使用内置的 Chronometer 类

比自己编码容易得多

# triangulation - CGAL 网格优化

> ID：10081647
> 
> 赞同：1
> 
> 时间：2012-04-10T00:40:23.377
> 
> 标签：triangulation, cgal, delaunay

我一直在尝试“清理”我预先生成的三角测量。

本质上，我想在 CGAL 上输入我的点并从那里生成一个网格，然后使用fine_mesh_3 去除碎片并提高其质量。

有什么简单的技术可以做到这一点吗？

谢谢...

# objective-c - 只设置帧的CGPoint

> ID：10081649
> 
> 赞同：0
> 
> 时间：2012-04-10T00:40:34.307
> 
> 标签：objective-c, animation, rotation, frame, cgpoint

我有一个问题，希望有一个简单的解决方案。我正在尝试使用按钮、计时器、框架、cgaffinetransformrotations 和延迟来创建摆动效果。一切都会很棒，除了当按钮旋转并且我将按钮的框架设置为将 y 减少或增加 10 个左右像素时，旋转使按钮的框架比正常情况下更大。最终结果是一个不断增长的按钮，直到它吞没屏幕。

我尝试进行向上和向下的运动 cgaffinetranslations，但这使用了 transform 属性（与旋转使用的属性相同）。结果是一个非常跳跃和不现实的鲍勃。

我想要完成的只是设置框架的原点组件而不必指定宽度和高度，因为即使指定硬编码的宽度和高度仍然会使其在旋转时收缩并在接近平衡时增长再次。

有任何想法吗？

谢谢！

代码：

```
- (void)movePlay{
[self performSelector:@selector(moveDown:) withObject:play];
[self performSelector:@selector(rotateRight:) withObject:play afterDelay:0];
[self performSelector:@selector(moveUp:) withObject:play afterDelay:0.5];
[self performSelector:@selector(rotateLeft:) withObject:play afterDelay:1];

}

- (void)moveUp:(UIButton*)log{

[UIView beginAnimations:nil context:nil];
[UIView setAnimationDuration:.5];
log.transform = CGAffineTransformMakeTranslation(0, -20);
[UIView commitAnimations];

}

- (void)rotateRight:(UIButton*)log{

[UIView beginAnimations:nil context:nil];
[UIView setAnimationDuration:1];
log.transform = CGAffineTransformMakeRotation(0.0174532925*10);
[UIView commitAnimations];

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T01:15:38.413

这只是一个想法。尝试将所有单独的转换组合在一起。所以与其独立提交

```
log.transform = CGAffineTransfor..., 
```

首先将它们与

```
CGAffineTransformConcat(CGAffineTransform t1, CGAffineTransform t2);
CGAffineTransformRotate(CGAffineTransform t1, CGFloat angle);
etc. 
```

# c - 尝试打印 char* 内容时出现分段错误

> ID：10081650
> 
> 赞同：0
> 
> 时间：2012-04-10T00:40:49.627
> 
> 标签：c

我有以下代码：

```
 FILE *fpa;
    fpa = fopen(argv[2], "r");
    if (fpa == NULL) {
     printf("Error: could not open seqA file!\n");
     exit(0);
    }

    unsigned int N_a;
    fscanf(fpa, "%d\n", &N_a);
    char *seq_a = malloc((N_a+1) * sizeof(char *));
    strcpy(seq_a,"");
    fscanf(fpa, "%s\n", seq_a);
    fclose(fpa);

    for(i=0;i<N_a;i++)
      printf("%s", seq_a[i]); ---> SEG FAULT
    printf("\n"); 
```

我在 printf 语句中遇到分段错误。argv[2] 是一个文件，其内容为：
5
ABCBB

任何想法我可能会犯错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T00:45:40.923

char *seq_a = malloc((N_a+1) * sizeof(char *));

应该： `char *seq_a = malloc((N_a+1) * sizeof(char));`

如果要打印每个字符，请使用`%c`：

```
 printf("%c", seq_a[i]); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T00:45:42.063

由于您正在打印*字符*，因此您`printf`应该使用格式说明符`%c`.. 不是`%s`。`%s`需要一个指针，因此它将字符值视为内存中的一个位置。

# sockets - 通过 Node.js 套接字测量数据的平均传输率

> ID：10081655
> 
> 赞同：1
> 
> 时间：2012-04-10T00:42:16.407
> 
> 标签：sockets, node.js, data-transfer

[我在 Node.js 应用程序（使用标准net.Socket](http://nodejs.org/api/net.html#net_class_net_socket)）和其他一些应用程序 之间有一个常规的 TCP 套接字连接。

假设我发送一个 1MB 的缓冲区：

```
socket.write(new Buffer(1048576)); 
```

虽然这是以非阻塞方式完成的，但显然数据不是即时传输的。

**如何测量底层系统从我的 Node.js 应用程序发送内部流缓冲区的数据速率？**

最终，我只需要知道在过去几秒钟内发送到另一端客户端的数据的平均速度。这可能吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-10T01:12:02.593

尝试[在 write 中使用回调](http://nodejs.org/api/net.html#net_socket_write_data_encoding_callback)

```
var net = require('net');
var s = net.createConnection(8888);
s.on('connect', function() {
    function test() {
       var len = 512*1048576;
       var start = +new Date();
       var b = new Buffer(len);
       b.fill('x');
       s.write(b, function() {
           console.log(len + ' bytes written, ' + (1000*len/(+new Date() - start)).toString() + ' bytes/sec');
           test();
       });
    }
    test();
}); 
```

在`nc -l 8888 > /dev/null`另一端我得到大约 350M 字节/秒

# html - 大小不适用于 HTML5 输入标签

> ID：10081659
> 
> 赞同：4
> 
> 时间：2012-04-10T00:42:52.893
> 
> 标签：html

对于下面的代码，忽略大小值。任何帮助表示赞赏？

```
<p><input type="submit" name="login" id="login" value="Login" size="125"/> </p> 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-04-10T00:47:39.593

它用于[文本、密码或文件输入字段](http://reference.sitepoint.com/html/input/size)

> size 属性用于设置文本、密码或文件输入字段的宽度。这些字段的长度由应该可见的字符数决定
> 
> 对于所有其他输入类型，大小是指控件的宽度（以像素为单位）。**鉴于此属性的表示性质，通常最好避免使用它。**相反，使用 CSS 来使用更精确的测量来定义字段宽度，除了文件输入，其中 CSS 对输入外观的控制受到严格限制（出于非常有效的安全原因），并且 size 属性是您唯一真正的选择。

# ftp - 通过 VPN 连接到 FTP

> ID：10081660
> 
> 赞同：6
> 
> 时间：2012-04-10T00:43:04.453
> 
> 标签：ftp, vpn, filezilla, cyberduck

客户端有一个 Web 服务器，只能在其网络上访问。

例如，假设我的登录详细信息是：

服务器：example.com 用户：用户密码：密码

当我在他们公司的互联网上时。我使用 Cyber​​duck 或 FileZilla 连接到他们的网络服务器。

我宁愿能够远程连接，但我在设置它时遇到了很多麻烦。我已经连接到客户端的 vpn，比如说 vpn.example.com，并使用 Cisco AnyConnect 来完成此操作。

除此之外，我对VPN的了解有限。在 FTP 客户端中，我应该做些什么来确保它使用 VPN 连接到 example.com 而不是我的家庭连接？

谢谢。

-m

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-10T01:38:16.273

有两种方法可以解决这个问题。我假设您使用的是 Windows 或 Mac，因为 AnyConnect 客户端没有 Linux 风格。

打开 CMD/终端并输入“route print”或“netstat -r”，记下 example.com 指向的位置。默认路由很可能会捕获它。在这种情况下，您希望添加一条路由以使其通过 VPN 接口传输到 example.com 的任何流量（执行此操作后，一旦您与 VPN 断开连接，您将无法再连接到 example.com除非您连接到 VPN。）

另一种方法是在连接到 VPN 后使用 FTP 的本地 IP 连接到 FTP。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-01-11T06:26:59.940

由于没有 Linux 解决方案，我将发布我的解决方案。我对另一方（vpn 服务器端）了解不多，因此此解决方案可能不适合您的环境。我正在使用`vpnc`（可通过 Ubuntu 上的包管理器安装，其他系统也可以使用）。您可以使用 .conf 文件对其进行配置，我的值是

```
IPSec gateway <server address>
IPSec ID <gateway id>
IPSec secret <kind of group password>
Xauth username <your username>
Xauth password <you password> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-06-23T11:22:28.847

如果您使用的是 UBUNTU

从**Ubuntu 软件中心****为 Cisco AnyConnect VPN**安装Open 客户端，然后使用命令。**`openconnect`**

# php - RegEx：如何从模式中提取值/数字并将其替换为其他内容？

> ID：10081661
> 
> 赞同：0
> 
> 时间：2012-04-10T00:43:10.657
> 
> 标签：php, regex, preg-replace, replace, preg-replace-callback

例如我有这段数据：

```
array(
    1 => 'Metallica',
    2 => 'Megadeth',
    3 => 'Anthrax',
    4 => 'Slayer',
    5 => 'Black Sabbath',
); 
```

我有这段文字：

> 我最喜欢的乐队是：**#band{2}**，然后是：**#band1**。我的第一个金属乐队是：**#band{5}**，我有时喜欢在听：**#band3**或**#band{4}**的时候戴头。

所以在 RegEx 之后，它应该是这样的：

> 我最喜欢的乐队是：**Megadeth**，然后是：**Metallica**。我的第一支金属乐队是：**Black Sabbath**，有时我在听：**Anthrax**或**Slayer**时喜欢戴头巾。

所以，我需要一个模式/示例如何从这两种模式中提取数字：

> **#band{NUMERIC-ID}**或**#bandNUMERIC-ID**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T00:45:57.643

尝试这样的事情

```
$txt = 'your text with bands';
foreach($arr as $key=>$val){
    $txt = preg_replace('/#band'.$key.'([^0-9])/', $val.'$1', $txt);
    $txt = preg_replace('/#band{'.$key.'}/', $val.'$1', $txt);
}

//detect the error
if(preg_match('/#band[^0-9]+/', $txt) || preg_match('/#band{[^0-9]+}/', $txt){
  //error!!!
}

//replace the non found bands with a string
$txt = preg_replace('/#band[^0-9]+/', 'failsafe', $txt);
$txt = preg_replace('/#band{[^0-9]+}/', 'failsafe', $txt); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T00:49:13.090

不需要正则表达式，只需使用`str_replace()`：

```
$map = array();
foreach ($bands as $k => $v){
    $map["#band".$k] = $v;
    $map["#band{".$k."}"] = $v;
}

$out = str_replace(array_keys($map), $map, $text); 
```

演示：[http ://codepad.org/uPqGXGg6](http://codepad.org/uPqGXGg6)

如果要使用正则表达式：

```
$out = preg_replace_callback('!\#band((\d+)|(\{(\d+)\}))?!', 'replace_band', $text);

function replace_band($m){
    $band = $GLOBALS['bands'][$m[2].$m[4]];
    return $band ? $band : 'UNKNOWN BAND';
} 
```

演示：[http ://codepad.org/2hNEqiCk](http://codepad.org/2hNEqiCk)

[编辑] 更新了多种形式的令牌以替换

# image - 什么运算符可以返回接近像素的中位数？

> ID：10081664
> 
> 赞同：0
> 
> 时间：2012-04-10T00:43:31.910
> 
> 标签：image, image-processing

我有一个像以下矩阵的二值化图像：

```
1 1 0 0 1 1 0 0 1 1 0 0 0 0 1 1 1 1 0 0 1 1 0 0 1 1
1 1 0 0 1 1 0 0 1 1 0 0 0 0 1 1 1 1 0 0 1 1 0 0 1 1
1 1 0 0 1 1 0 0 1 1 0 0 0 0 1 1 1 1 0 0 1 1 0 0 1 1
1 1 0 0 1 1 0 0 1 1 0 0 0 0 1 1 1 1 0 0 1 1 0 0 1 1 
```

问题是图像以 101 结尾，所以我怎么能把它变成这个。

```
1 0 1 0 1 0 0 1 1 0 1 0 1
1 0 1 0 1 0 0 1 1 0 1 0 1
1 0 1 0 1 0 0 1 1 0 1 0 1
1 0 1 0 1 0 0 1 1 0 1 0 1 
```

我正在尝试解码图像二进制代码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T09:08:41.800

如果您使用 Matlab 或任何其他具有类似数组处理能力的语言（APL、Fortran 90、Mathematica、C++ +Boost，...），您可以使用类似于以下的语句将输入转换为所需的输出：

```
arr(:,1:2:end) 
```

如果您的像素数组`arr`当然被调用。

这不会返回接近像素的中值，但也不会返回问题中的建议输出。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T03:16:41.917

似乎使用最近邻法调整原始图像的大小（0.5,1）。

# c# - 如何在不占用资源的情况下连续引发大量事件

> ID：10081665
> 
> 赞同：0
> 
> 时间：2012-04-10T00:43:40.283
> 
> 标签：c#, events, messenger

我正在开发一个 Messenger 库。主类有一个 Login 方法。登录时，所有联系人列表数据都被下载并存储，直到登录完成，此时我为每个下载的用户引发一个*UserAdded事件。*

目前，我在 Login 方法的末尾一一提出事件。这可行，但这意味着如果我在 UserAdded 事件处理程序中执行冗长的操作，库使用者不会及时获取他们的事件。

我可以看到解决此问题的一种方法是异步引发每个事件，但这会破坏线程池。

我目前的做法是否正确？我是否应该在文档中简单地做一个注释，警告不要在事件处理程序中执行冗长的操作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T00:50:52.963

也许您可能希望将事件处理程序更改为简单地“入队”到线程安全队列工作项中。然后，您可以拥有一个线程来连续抽送队列以实际处理消息。这样，加薪发生得非常快，并且只有一个线程实际处理工作项队列。

但是，这样做意味着您现在必须处理一个事实，即引发事件并不意味着它已被立即处理，这可能会影响您在应用程序中的逻辑。

# c# - C# 枚举中定义的 value__ 是什么

> ID：10081668
> 
> 赞同：10
> 
> 时间：2012-04-10T00:44:12.850
> 
> 标签：c#, .net, enums

这里`value__`可能有什么？

```
value__
MSN
ICQ
YahooChat
GoogleTalk 
```

我运行的代码很简单：

```
namespace EnumReflection
{
    enum Messengers
    {
      MSN,
      ICQ,
      YahooChat,
      GoogleTalk
    }

  class Program
  {
    static void Main(string[] args)
    {
      FieldInfo[] fields = typeof(Messengers).GetFields();

      foreach (var field in fields)
      {
        Console.WriteLine(field.Name);
      }

      Console.ReadLine();
    }
  }
} 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-10T00:47:22.920

你可以在[这里](https://web.archive.org/web/20181119155348/http://www.distribucon.com/blog/GettingMembersOfAnEnumViaReflection.aspx)找到更多。海报甚至有示例代码可以帮助您解决问题……只需插入*BindingFlags.Public | BindingFlags.Static*在 GetFields() 的括号之间。

> 通过使用反射，我认为我会占据上风并控制我的枚举问题。不幸的是，对枚举类型调用 GetFields 会在返回的列表中添加一个名为 value__ 的额外条目。浏览了 Enum 的反编译后，发现 value__ 只是枚举用来保存选中成员的值的一个特殊的实例字段。我还注意到实际的枚举成员确实被标记为静态的。因此，要解决这个问题，您需要做的就是调用 GetFields 并将 BindingFlags 设置为仅检索公共的静态字段

# linux - 使用代码块在 linux 上编译混乱 gui：编译，但不加载图像等，相同的代码在 Visual Studio 上工作正常

> ID：10081670
> 
> 赞同：1
> 
> 时间：2012-04-10T00:44:44.540
> 
> 标签：linux, codeblocks, clutter

我已经使用 Visual Studio 在寡妇上使用 clutter 库编写了一个 gui。

我现在正在尝试使用代码块在 linux 虚拟机上编译它。它编译得很好，但程序启动时只有几个演员，几乎是一个空白窗口。

我做了一个快速测试程序，发现我可以加载纹理，做动画和效果，没有问题。

我无法弄清楚是什么导致了失败。

我尝试消除除了非常基本的起始页之外的所有内容，并且它起作用了。所以我回去开始注释掉某些部分，直到我发现什么不起作用，但在注释掉几千行代码后我放弃了。

我也是代码块和 linux 的新手，我想知道解决这个问题的最佳方法是什么？

而且，代码块在编译时会打印出一堆警告消息，但它们都会在大约 2 秒内消失，我无法阅读它们。

有小费吗。

# javascript - 您如何在 Knockout 中观察 JavaScript 哈希表？

> ID：10081671
> 
> 赞同：6
> 
> 时间：2012-04-10T00:44:46.210
> 
> 标签：javascript, knockout.js

在我的 Knockout 视图模型中，我有一些属性，我试图在其中使哈希可观察。因此，而不是我的预淘汰赛代码

```
self.MyHash = {}; 
```

我现在正在使用：

```
self.MyHash = ko.observable({}); 
```

在我的代码的其他部分，我正在使用如下语句操作哈希：

```
// add an entry
self.MyHash()["test"] = "My Value";

// remove an entry
delete self.MyHash()["test"]; 
```

该代码有效，因为条目被正确添加和删除。但是，观察哈希表的代码区域似乎没有检测到哈希表的更改。例如，当我更改哈希表时，这个计算的 observable 永远不会运行：

```
self.Querystring = ko.computed(function ()
{
    var f = [];
    $.each(self.MyHash(), function (k, v)
    {
        f.push(encodeURIComponent(k) + '=' + encodeURIComponent(v));
    });

    return (f.length > 0) ? f.join("&") : "";
}); 
```

我猜这是因为 Knockout observables 需要是简单的变量（或 observableArrays），并且它没有检测到我的哈希表的底层变化。

如果是这样，还有其他选择吗？为什么 Knockout 中没有 observableHash 类型？

对于它的价值，我的解决方法是拥有一个 observableArray 的键和一个常规的 JavaScript 哈希表来查找值。然后我改变了我的计算方法来观察键数组，而不是我之前拥有的其他哈希表变量。我只是想确保我不会错过在 Knockout 中执行此操作的“正确方法”。

```
self.MyHashKeys = ko.observableArray();
self.MyHash = {};

self.Querystring = ko.computed(function ()
{
    var f = [];
    $.each(self.MyHashKeys(), function (index, value)
    {
        f.push(encodeURIComponent(value) + '=' + encodeURIComponent(self.MyHash[value]));
    });

    return (f.length > 0) ? f.join("&") : "";
}); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-10T00:57:42.230

[请参阅可观察数组页面](http://knockoutjs.com/documentation/observableArrays.html)上的第二个示例。只需创建一个键/值对数组：

```
// This observable array initially contains three objects
var anotherObservableArray = ko.observableArray([
    { name: "Bungle", type: "Bear" },
    { name: "George", type: "Hippo" },
    { name: "Zippy", type: "Unknown" }
]); 
```

在您的示例中，您只是在迭代（删除除外），因此没有真正需要使用实际的字典。只需搜索密钥就很容易了。我认为 map 的使用在某种程度上是一种过早的优化。它也不完全符合查询字符串多次支持同一个键的能力。

**编辑：**如果您想观察此示例中的键或值的变化，您还必须使这些属性可观察：

```
var anotherObservableArray = ko.observableArray([
    { name: ko.observable("Bungle"), type: ko.observable("Bear") }
]); 
```

# c++ - C++ 中的点积实现

> ID：10081672
> 
> 赞同：-3
> 
> 时间：2012-04-10T00:44:48.130
> 
> 标签：c++, vector, matrix

我正在努力让我的方法发挥作用。我是 C++ 的初学者。我试图找到两个向量的点积。我在*for*循环中遇到了一些错误。我该如何修复它们？

```
float dot(Matrixf const& vec1, Matrixf const& vec2) {

    // error check
    if (!vec1.isVector() || !vec2.isVector()) {
        throw std::runtime_error("Unable to do dot product: not column vectors.");
    }
    if (vec1.nrows() != vec2.nrows()) {
        throw std::runtime_error("Unable to do dot product: vector lengths not equal.");
    }

    /** implementing dot product *************************************/

    float ret = 0;

    for(unsigned i = 0; i < vec1.ncols(); ++i){
        for(unsigned j =0; j< vec2.nrows(); ++j){
            ret += vec1[i] * vec2[j];
        }
    }
    return ret;
} 
```

Matrixf 类

```
#include "matrixf.h"

#include <iostream>

Matrixf::Matrixf(unsigned int rows, unsigned int cols) {
    rows_ = rows;
    cols_ = cols;
    data_ = new float[rows_ * cols_];

    // set all initial values to zero
    for (unsigned int r = 0; r < rows_; ++r) {
        for (unsigned int c = 0; c < cols_; ++c) {
            data_[r * cols_ + c] = 0;
        }
    }
}

Matrixf::~Matrixf() {
    delete data_;
}

Matrixf::Matrixf(Matrixf const& other) {
    rows_ = other.rows_;
    cols_ = other.cols_;
    data_ = new float[rows_ * cols_];
    for (unsigned int i = 0; i < rows_ * cols_; ++i) {
        data_[i] = other.data_[i];
    }
}

Matrixf& Matrixf::operator=(Matrixf const& other) {
    // handles self assignment
    if (this == &other) {
        return *this;
    }

    delete data_;
    rows_ = other.rows_;
    cols_ = other.cols_;
    data_ = new float[rows_ * cols_];
    for (unsigned int i = 0; i < rows_ * cols_; ++i) {
        data_[i] = other.data_[i];
    }
    return *this;
}

float Matrixf::get(unsigned int row, unsigned int col) const {
    #ifndef NDEBUG
        if (row >= rows_ || col >= cols_) {
            throw std::runtime_error("Matrix index out of bounds.");
        }
    #endif

    return data_[row * cols_ + col];
}

void Matrixf::set(unsigned int row, unsigned int col, float val) {
    #ifndef NDEBUG
        if (row >= rows_ || col >= cols_) {
            throw std::runtime_error("Matrix index out of bounds.");
        }
    #endif
    data_[row * cols_ + col] = val;
}

float& Matrixf::operator()(unsigned int row, unsigned int col) {
    return data_[row * cols_ + col];
}

float Matrixf::operator()(unsigned int row, unsigned int col) const {
    return data_[row * cols_ + col];
}

unsigned int Matrixf::nrows() const {
    return rows_;
}

unsigned int Matrixf::ncols() const {
    return cols_;
}

bool Matrixf::isVector() const {
    return (cols_ == 1);
}

Matrixf Matrixf::eye(unsigned int size) {
    Matrixf e(size, size);
    for (unsigned int i = 0; i < size; ++i) {
        e.set(i, i, 1);
    }

    return e;
}

std::ostream& operator << (std::ostream& os, Matrixf const& matrix) {
    for (unsigned int r = 0; r < matrix.nrows(); ++r) {
        for (unsigned int c = 0; c < matrix.ncols(); ++c) {
            os << matrix.data_[r * matrix.cols_ + c] << " ";
        }
        os << "\n";
    }
    return os;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T00:47:54.700

我想你只想要一个循环：

```
for(unsigned i = 0; i < vec1.ncols(); ++i){
  ret += vec1[i] * vec2[i];
} 
```

* * *

我也注意到你比较

```
vec1.nrows() != vec2.nrows() 
```

但你`ncols()`在循环中使用。你想要哪一个？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T06:00:36.500

我从你的另一个问题中看到你写了一个光线追踪器。

在光线追踪器中，向量和矩阵具有单独的数据结构是很常见的并且几乎总是如此，因为它们几乎总是以不同的方式使用，并且编程的专业化几乎总是会导致更快的代码。

如果您随后仅为向量定义点积，则点积代码将变得简单。

# spring - Spring Security 3.0.5 并发不起作用

> ID：10081674
> 
> 赞同：0
> 
> 时间：2012-04-10T00:45:12.357
> 
> 标签：spring, security, concurrency

您好我正在使用 Spring Security 3.0.5 和 Spring Framework 3.0.6。我已经按照文档配置了并发。它不工作。我从浏览器会话登录到应用程序，然后尝试从同一浏览器中的另一个选项卡再次登录 - 它让我登录而不是拒绝尝试。

这是我的安全配置文件：

```
<?xml version="1.0" encoding="UTF-8"?>
<beans:beans xmlns="http://www.springframework.org/schema/security"
  xmlns:beans="http://www.springframework.org/schema/beans"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://www.springframework.org/schema/beans
       http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
       http://www.springframework.org/schema/security
       http://www.springframework.org/schema/security/spring-security-3.0.xsd">

<http auto-config="false" use-expressions="true"
    access-denied-page="/jsp/accessDenied.jsp" 
    entry-point-ref="authenticationEntryPoint">
    <intercept-url pattern="/login.jsp" filters="none" />
        <intercept-url pattern="/**" access="hasRole('ROLE_USER')" />
    <logout invalidate-session="true" logout-url="/logout.htm"
            logout-success-url="/login.jsp?loggedout=true"/>
        <custom-filter ref="authenticationFilter" 
            position="FORM_LOGIN_FILTER"/>
        <custom-filter ref="concurrencyFilter" 
            position="CONCURRENT_SESSION_FILTER"/>
        <session-management session-authentication-strategy-ref="sas"/> 
</http>

<beans:bean id="authenticationFilter" 
    class="org.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter">
       <beans:property name="sessionAuthenticationStrategy" ref="sas"/>
        <beans:property name="authenticationManager" ref="authenticationManager"/>
        <beans:property name="authenticationFailureHandler" ref="customAuthenticationFailureHandler"/>
        <beans:property name="authenticationSuccessHandler" ref="customAuthenticationSuccessHandler"/> 
</beans:bean>
<beans:bean id="customAuthenticationFailureHandler"
    class="org.springframework.security.web.authentication.SimpleUrlAuthenticationFailureHandler">
    <beans:property name="defaultFailureUrl" value="/login.jsp?authfailed=true"/>
</beans:bean>    
<beans:bean id="customAuthenticationSuccessHandler"
    class="org.springframework.security.web.authentication.SimpleUrlAuthenticationSuccessHandler">
        <beans:property name="defaultTargetUrl" value="/index.jsp" />
</beans:bean>
<beans:bean id="authenticationEntryPoint"  
    class="org.springframework.security.web.authentication.LoginUrlAuthenticationEntryPoint">   
    <beans:property name="loginFormUrl" value="/login.jsp"/> 
</beans:bean>

<authentication-manager alias="authenticationManager">
<authentication-provider user-service-ref="userDetailsService">
        <password-encoder ref="passwordEncoder"/>
    </authentication-provider>
</authentication-manager>
<beans:bean class="org.springframework.security.authentication.encoding.Md5PasswordEncoder"
        id="passwordEncoder"/>
<user-service id="userDetailsService">
        <user name="username" password="ee11cbb19052e40b07aac0ca060c23ee"
            authorities="ROLE_USER, ROLE_ADMIN" />
        <user name="test" password="21232f297a57a5a743894a0e4a801fc3"
            authorities="ROLE_USER" />
</user-service>
<beans:bean id="concurrencyFilter" 
    class="org.springframework.security.web.session.ConcurrentSessionFilter">
    <beans:property name="sessionRegistry" ref="sessionRegistry"/>    
    <beans:property name="expiredUrl" value="/login.jsp?loggedout=true" />
</beans:bean>
<beans:bean id="sas" 
    class="org.springframework.security.web.authentication.session.ConcurrentSessionControlStrategy">
    <beans:property name="maximumSessions" value="1" />    
    <beans:constructor-arg name="sessionRegistry" ref="sessionRegistry" />
</beans:bean>
<beans:bean id="sessionRegistry" 
    class="org.springframework.security.core.session.SessionRegistryImpl" /> 
```

这是我的 web.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app version="3.0" xmlns="http://java.sun.com/xml/ns/javaee" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd">
<display-name>Spring security web application (series)</display-name>
<context-param>
    <param-name>contextConfigLocation</param-name>
    <param-value>/WEB-INF/applicationContext-security.xml
    </param-value>
</context-param>

<!--
    - Loads the root application context of this web app at startup. - The
    application context is then available via -
    WebApplicationContextUtils.getWebApplicationContext(servletContext).
-->
<listener>
    <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
</listener>
    <listener>
    <listener-class>
        org.springframework.security.web.session.HttpSessionEventPublisher</listener-class>
</listener>

<filter>
    <filter-name>springSecurityFilterChain</filter-name>
    <filter-class>org.springframework.web.filter.DelegatingFilterProxy</filter-class>
</filter>

<filter-mapping>
    <filter-name>springSecurityFilterChain</filter-name>
    <url-pattern>/*</url-pattern>
</filter-mapping>
<servlet>
     <servlet-name>springsecuritywebapp</servlet-name>
     <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
    <load-on-startup>1</load-on-startup>
</servlet>

<servlet-mapping>
    <servlet-name>springsecuritywebapp</servlet-name>
    <url-pattern>*.htm</url-pattern>
</servlet-mapping>

<welcome-file-list>
    <welcome-file>index.jsp</welcome-file>
</welcome-file-list>
</web-app> 
```

问候， 纳齐尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T03:15:45.147

添加`<beans:property name="exceptionIfMaximumExceeded" value="true" />`到`org.springframework.security.web.authentication.session.ConcurrentSessionControlStrategy`bean 定义。如果超出允许的会话，它将抛出异常。

这会产生副作用。假设用户登录浏览器并关闭清除会话数据的浏览器。然后用户必须等待服务器中的会话过期才能再次登录。除非您有明确的要求，否则我更喜欢您现有的配置。

# java - 实现接口可比较时出现编译错误

> ID：10081675
> 
> 赞同：0
> 
> 时间：2012-04-10T00:45:15.653
> 
> 标签：java, interface, compare

我正在尝试对通用节点类型 E 使用 compareTo 方法。

我已经将 E 绑定到 Comparable

```
public class LinkedList<E extends Comparable<E>> {

    //  ----------------------------------------------------------
    //  Implementing the doubly linked nodes (static nested class)
    //  ----------------------------------------------------------

    private static class Node<E extends Comparable<E>> { 
```

这个方法 isSorted 在 LinkedList 类中实现，Node 类在 Linkedlist 类中。

我不断收到编译错误“LinkedList.Node 类型的方法 compareTo(LinkedList.Node) 未定义”

我相信只有当 E 没有扩展 Comparable 时才会弹出，在我的情况下是这样。有什么帮助吗？

```
 public boolean isSorted( ){

        if(!isEmpty()){

        Node<E> temp = head;
        boolean local = true;
        int x=0;
        while (temp.next != null){
          x=temp.compareTo(temp.next);
          if(x<0){
            temp = temp.next;}
          else {return local;}

        }
        return local;}
        else{ throw new IllegalArgumentException();}
      } 
```

我已经检查了这个线程，[如何使用 Comparable 比较链表中的通用节点？](https://stackoverflow.com/questions/6356220/how-to-compare-generic-nodes-in-a-linked-list-using-comparable)

它没有帮助。

先感谢您

Mjall2

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T00:48:13.097

您正在尝试比较*节点*，当它只是节点内的值时`Comparable`。而不是`temp.compareTo(temp.next)`，你可能想要类似的东西`temp.value.compareTo(temp.next.value)`。

# git - git subtree 将更改推送回子树项目

> ID：10081681
> 
> 赞同：13
> 
> 时间：2012-04-10T00:45:45.510
> 
> 标签：git, subtree, git-subtree

以下内容的缩写：我想将提交消息推送到子树，但只有适用于该树的消息。我该怎么做呢？

* * *

我有两个项目，`Master`和`Slave`. `Slave`被检出为`Master`检出到`lib/slave`的子树，`git subtree merge --prefix=lib/slave --squash projects/slave`其中`projects/slave`一个分支`Slave`被检出：

分支机构：

主项目/从站 → 从站

现在我正在我的`master`分支上工作，对作为两个项目一部分的文件进行提交，一切都很顺利。现在我想将更改推回`Slave`：

*   git结帐奴隶
*   混帐？？？掌握

如果我进行正常的合并，无论是否修改了任何文件，我都会为每个提交给 master 提交提交`lib/slave`。或者我可以做一个`--squash`并且只得到一个提交，但是我丢失了日志消息。

那么如何获得适当的日志消息呢？例如，如果我的`master`日志历史是：

*   将图像添加到主控
*   仅从站中修改的文件
*   仅对 master 进行更多更改
*   master和slave中的修改文件

我希望将其添加到`Slave`：

*   仅从站中修改的文件
*   master和slave中的修改文件

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-13T00:24:12.623

对于您想要的行为，我认为您必须从 中推送`Master`，我不知道从 中提取子树更改的方法`Slave`。

推送更改：

```
(in Master)
$ git subtree split --prefix=lib/slave -b split-branch
$ git push <bare Slave repo> split-branch:master
$ git branch -d split-branch
$ cd /path/to/Slave/working/copy
$ git pull  # (now in Slave) 
```

第一个命令基于目录创建一个新的子树，然后将其推送到另一个项目。

理论上，您应该能够直接推送到工作副本，但实际上这对我不起作用。

# flash - 将 Flex Project 作为组件导入？

> ID：10081686
> 
> 赞同：1
> 
> 时间：2012-04-10T00:46:37.723
> 
> 标签：flash, apache-flex, flash-builder, mxml

我正在为媒体开发课程构建一个 Flex 应用程序，我们对这个 sprint 的要求之一是在界面中实现一个简单的 P2P 聊天。我从满足我需要的教程中创建了一个并对其进行了适当的更改，但它作为一个单独的 Flex 项目存在，而不是在主应用程序中。

我知道我可以将聊天导出为 fxp 项目文件，但我不确定如何在我的主应用程序中使用它。我试图创建一个自定义组件，但过程不是很清楚，而且 Adob​​e 关于该主题的帮助文件似乎与我特别想做的事情无关。我觉得我的目标有一个非常简单的解决方法，但希望有人能够指出我正确的方向，因为我已经在这个应用程序上工作了 6 个小时并且需要休息一下。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T02:59:12.310

您想创建一个库项目；不是 Flex 项目。

库项目的输出是 SWC；可以在其他项目中使用。Flex 项目的输出是一个 SWF，不能在其他项目中使用。

fxp 导出为项目导出；用于在 Flash Builder 的不同实例之间共享项目设置。

很可能您需要创建一个库项目，将适当的文件移到其中；然后将该库 SWC 添加到主项目的库路径中。

# javascript - HTML：非正文元素的加载

> ID：10081689
> 
> 赞同：6
> 
> 时间：2012-04-10T00:47:11.397
> 
> 标签：javascript, jquery, html

我通过 JQuery 对许多元素执行 javascript 转换的常规方式：

```
<div class="cow"></div>
<script> $(".cow").doStuff() </script> 
```

然而，这个操作是脆弱和脆弱的：它是在页面全部只加载一次的假设下工作的。一旦您开始使用 Ajax 并进行部分重新加载，这种全局转换就会完全失效。如果服务器想要基于某些服务器端数据对每个元素进行不同的转换，它也不起作用。

我知道非元素的实际`onload`事件`body`不起作用。一种解决方案是提供所有元素 ID/类并使用 JQuery 立即引用它们：

```
<div id="cow"></div>
<script> $("#cow").doStuff() </script> 
```

但是，这真的很混乱。我根本不喜欢它，部分原因是我给一个 ID 的每个元素都会污染全局 I 命名空间。我目前正在给元素一个有效的不可碰撞的 ID

```
<div id="id877gN0icYtxi"></div>
<script> $("#id877gN0icYtxi").doStuff() </script> 
```

基于随机的 base64 数字。然而，这一切看起来像是一个巨大的黑客：我可以非常简单地使用它们各自的属性给元素`onclick`s 和`onmousedown`s 等，然后调用一个函数来转换给定的`this`.

现在，我知道`onload`这行不通。但是，有没有办法模拟它的功能？具体来说，我希望能够运行引用特定标签的 javascript 代码，`this`而无需为标签分配 ID。

编辑：本质上我想要类似的东西

```
<input onclick="alert('moo')"/> 
```

但是对于oncreate；我目前的用例是用文本填充`input`或`textarea`，我目前正在做：

```
<input id="id877gN0icYtxi"/>
<script>$("#id877gN0icYtxi").val(...)</script> 
```

其中`...`每个输入框都不同，因此无法使用“全局”jquery 转换轻松完成。另一方面，我不能只在创建它时设置`value`or 属性`input`，因为它可能是 a `textarea`，我不知道。我想做类似的事情：

```
<input onload="$(this).val(...)"/> 
```

这不起作用，但我希望它起作用。同样，这`...`是由服务器设置的，并且对于页面上的每个`input`标签都不同。

编辑2：

我很清楚 JQuery 通常用于以相同方式对许多元素进行整个文档转换。问题在于，在这种情况下，每个元素都以特定于该元素的方式进行转换，由服务器决定。具体用例是每个字段的内容都用 预填充`$().val()`，自然每个字段都会填充不同的内容。给每个元素一个*唯一的*ID 并使用 JQuery 进行全局搜索以再次找到该元素似乎是一种非常迂回的做事方式，当您开始进出页面的 Ajaxing 部分时当然会中断。

编辑3：

简而言之，我希望能够写作

```
<div onload="javascriptFunction(this)"/> 
```

并`javascriptFunction()`在创建时运行`<div>`（无论是在初始页面上还是通过 ajax 插入）并`<div>`作为参数传递。就像单击 div时作为参数`onclick`运行一样，我希望发生同样的事情，但是当它被创建/插入到 DOM 中时。`javascriptFunction()``<div>``<div>`

`<head>`为了实现这一点，我愿意接受任何数量的设置脚本。由于上面提到的原因，我不愿意在,`<script>`之后添加任何标签`<div>`，`class`或者`id`在`<div>`. 鉴于这些限制，模拟`onload`非主体元素的属性最好的方法是什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-04T11:50:06.983

DOM 规范中没有这样的`onload`事件，但是 DOM Level 2 规范提供了[Mutation 事件类型](http://www.w3.org/TR/DOM-Level-2-Events/events.html#Events-eventgroupings-mutationevents)，以允许通知文档结构的任何更改，包括 attr 和文本修改，目前只有现代浏览器支持此类事件，并且它在 Internet 上是错误的探险者九号！

但是，您可以使用它`DOMNodeInserted event`来监视文档的任何更改：

```
$(document).live("DOMNodeInserted", function(e){
  $(e.target).val(...);
}); 
```

您应该小心使用 Mutation 事件，至少尝试更新！根据 W3C：

> 突变事件类型尚未在用户代理之间完全且可互操作地实现，新规范正在开发中，旨在解决突变事件解决的用例，但以更高性能的方式。

我想如果你用谷歌搜索此事，你可能会为此找到一些跨浏览器/jquery 插件，以防万一，这些链接可能会有所帮助：

[https://developer.mozilla.org/en/DOM/Mutation_events](https://developer.mozilla.org/en/DOM/Mutation_events)

[http://help.dottoro.com/ljfvvdnm.php#additionalEvents](http://help.dottoro.com/ljfvvdnm.php#additionalEvents)

[http://help.dottoro.com/ljmcxjla.php](http://help.dottoro.com/ljmcxjla.php)

[http://help.dottoro.com/ljimhdto.php](http://help.dottoro.com/ljimhdto.php)

[http://www.bennadel.com/blog/1623-Ask-Ben-Detecting-When-DOM-Elements-Have-Been-Removed-With-jQuery.htm](http://www.bennadel.com/blog/1623-Ask-Ben-Detecting-When-DOM-Elements-Have-Been-Removed-With-jQuery.htm)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T02:30:40.717

所有这些都取决于您要使用哪种标签。

要知道的一件事是，jQuery 允许您一次选择很多项目，因此当您执行类似 的操作时`$('p')`，该对象指的是所有*节点*`p`。

做类似`$('p').hide()`隐藏所有`p`节点的事情。

jQuery 选择器（至少）和 CSS 选择器一样强大，所以你可以在单行中做一些非常语义化的事情。

想象一下，如果您有类似评论部分的回复框列表之类的东西：

```
 -----------------------------------------
  Comment #1
   blah blah blah blah blah
    [ Text field  ] (Reply)
 -----------------------------------------
  Comment #2
   nyark nyark nyark nyark
    [ Text field  ] (Reply)
 -----------------------------------------
  Comment #3
   ubadabuba 
    [ Text field  ] (Reply)
 -----------------------------------------
  Comment #4
   eeeeeeeeeeeeeeeeeeeeeeeeee?
    [ Text field  ] (Reply) 
```

所以你的 DOM 布局可能看起来像

```
<div class="comment" >
    <h1> Comment #1 </h1>
   <p> blah blah blah blah blah </p>
    <input  /> <button >Reply </button>
</div>
<div class="comment" >
    <h1> Comment #2 </h1>
   <p> nyark nyark nyark nyark </p>
    <input  /> <button >Reply </button>
</div> 
```

因此，如果您想更新所有输入字段，输入默认文本，您只需要查看字段的 CSS 选择器是`.comment > input`.

之后JS自行出现

```
$(document).ready(function(){
    var inputs=$('.comment > input ');//references all the input fields defined by this selector
    inputs.attr('value','default text');//set the value of the text in the input
})​ 
```

[此处显示的示例](http://jsfiddle.net/X5HVx/2/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-10T01:06:14.807

给元素一个 ID 不会“污染全局命名空间”，它只是一种引用元素的机制。您只需要一个您打算通过 ID 引用的元素的 ID。为其他元素提供 ID 没有害处，只是没有必要。

您可以通过多种标准引用元素，包括类及其在 DOM 中的位置（CSS 选择器池中的任何方法以及 DOM 关系——父、子、兄弟等）。您选择的方法可能有优点和缺点，具体取决于您使用它的方式，没有固有的“好”或“最佳”方法，只是有些方法比其他方法更适合某些情况。

如果你想在替换 DOM 中的元素之后替换监听器，那么你的替换元素需要考虑到这一点。事件委托是一种策略，还有其他策略。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-05-07T22:42:59.603

怎么样`window.onload()`？

# c++ - 删除结构的指针也会删除结构内的指针吗？

> ID：10081692
> 
> 赞同：8
> 
> 时间：2012-04-10T00:47:23.550
> 
> 标签：c++, struct, destructor, delete-operator

假设我有一个结构，其中有两个指针，每个指针都指向一个已实现析构函数的对象。还假设 head 指向具有非 NULL 值 *student 和 *next 的 Listnode 结构：

```
struct Listnode {    
  Student *student;
  Listnode *next;
};
Listnode *head =  new Listnode; 
```

如果我`delete`在 Listnode 指针“head”上使用保留字，它将调用该结构 Student 类和 Listnode 类中的析构函数，分别指向“student”和“next”。换句话说，删除 *head 也会删除 *student 和 *next 提供的 head 是指向该 Listnode 的唯一指针

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-10T00:49:45.917

除非你的析构函数`~Listnode`调用`delete`指针。然而，调用`delete`将调用非指针成员的析构函数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T00:49:40.783

不！您应该先手动删除它们，但您也可以在析构函数中添加删除代码。

# google-chrome - Chrome 扩展程序 - 不要加载网页的某些部分

> ID：10081694
> 
> 赞同：1
> 
> 时间：2012-04-10T00:47:48.977
> 
> 标签：google-chrome, google-chrome-extension

现代网页设计的一个反复出现的问题可以概括为“到处都是 sh**”。这样做有两个问题：第一，它占用内存并且加载时间更长，第二，它在视觉上使网页混乱。

如果我只想解决第二个问题，我不需要帮助。JavaScript 可以删除 DOM 节点，而 CSS 可以隐藏它们，因此已经有一些可见的方法可以简单地隐藏网页的某些部分。我想要做的是解决第一个问题 - 通过不加载某些元素来更快地加载网页。

我很确定不可能有选择地下载 HTML 文件的某些部分。但是一旦下载了源代码，浏览器就不必真正解析和显示所有内容，不是吗？

当然，如果这是在它已经被解析和显示之后完成的，那将毫无意义。*所以我需要一种方法来告诉 Chrome在它开始解析 HTML 之前*要做什么。这可能吗，您认为它会显着减少加载时间/内存使用吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T10:01:39.040

是的，不幸的是，我从未见过在 Chrome 呈现之前更改 html 的方法。
但就阻止该页面显示的内容而言，Id 建议仅使用 AdBlock [https://chrome.google.com/webstore/detail/gighmmpiobklfepjocnamgkkbiglidom](https://chrome.google.com/webstore/detail/gighmmpiobklfepjocnamgkkbiglidom)
AdBlock 可用于停止资源（js、图像、css、xmlhttprequest）曾经被下载（它使用 webRequest api 在后台阻止它们）并且还可以使用 css 隐藏元素......它相当有效（只需记住在其选项页面中选择高级选项，然后当您单击 AdBlock 按钮时，您会得到“显示资源列表”）。此外，安装 Flashblock 可以帮助...或禁用 Chrome 设置中的插件，这样做会使它们无法加载，但仍会显示在页面上，然后您可以让它们加载。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T07:40:13.797

完全有可能！认识最新的 Chrome API：webRequest，在当前版本的 Chrome - 17 中完成。

webRequest 的文档：[http ://code.google.com/chrome/extensions/webRequest.html#event-onBeforeRequest](http://code.google.com/chrome/extensions/webRequest.html#event-onBeforeRequest)

我正在尝试一种可靠的方法来做到这一点......我的一个建议是使用“sub_frame”过滤器，并观察它是否是一个喜欢/推文/社交按钮的网址

您还可以阻止已知的分析内容......而且名单还在继续！玩得开心！当你启动时，你有我可以订阅的电子邮件列表吗？如果没有，请给我一个评论！

（从评论中可以看出，innerHTML hack 是如何工作的）

```
//This modLoop constantly peers into and modifies the innerHTML in attempt to modify the html before it's fully processed.
var modLoop = function modLoop(){
  var html = document.documentElement.innerHTML
  //modify the page html before it's processed!
  //like: html = html.replace('//google'sCDN.com/jquery/1.7.1/', chrome.extension.getURL('localjQuery.1.7.1.js'));
  //I just pulled that ^ out of nowhere, you'll want to put careful thought into it.
  //Then, mod the innerHTML:
  document.documentElement.innerHTML = html;
  setTimeout(modLoop, 1);
};
var starter = function starter(){
  if (document.documentElement.innerHTML && document.documentElement.innerHTML.lengh > 0) {
    modLoop();
  } else {
    setTimeout(starter, 1);
  }
};
starter(); 
```

# c++ - C++ 引用、地址、指针

> ID：10081701
> 
> 赞同：2
> 
> 时间：2012-04-10T00:49:00.643
> 
> 标签：c++, object, reference

我看到一个看起来像这样的函数定义

```
ClassName::Read(myObjectClass &temp) 
```

我试图这样称呼它：

```
myObjectClass *myObj;
ClassName::Read(&myObj); 
```

但这是不正确的。调用它的正确方法是什么？它必须是类型`myObjectClass&`

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-10T00:50:11.317

像这样：

```
ClassName::Read(*myObj); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-10T00:52:41.457

正如詹姆斯正确指出的那样，正确的语法是`*myObj`. 关键是它`&myObj`为您提供了 的地址`myObj`，它的类型为`myObjectClass**`。相反，您希望*取消引用* `myObj`以获取`myObjectClass`它指向的实例，因此您使用`*`.

顺便说一句，就目前而言， using`*myObj`会导致未定义的行为，因为`myObj`它本身尚未初始化。如果您不需要动态分配 a `myObjectClass`，则最好这样做：

```
myObjectClass myObj;
ClassName::Read(myObj); 
```

如果动态分配是必须的，那么你可以做例如

```
myObjectClass *myObj = new myObjectClass;
ClassName::Read(*myObj);
//...
delete myObj; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-12T21:36:27.487

这边走

```
myObjectClass myObj;
ClassName::Read(myObj); 
```

您不必到处使用指针和动态分配。C++ 不是 Java。

# c# - 无法加载文件或程序集 'JSNet，版本 = 1.0.0.0，文化 = 中性

> ID：10081709
> 
> 赞同：2
> 
> 时间：2012-04-10T00:50:26.903
> 
> 标签：c#

我在任何其他 PC 上运行时遇到此错误，我真的不知道绑定版本等，但我在这里迷路了。甚至不知道该放什么。

无法加载文件或程序集 'JSNet，Version=1.0.0.0，Culture=neutral，PublicKeyToken=null' 或其依赖项之一。该系统找不到指定的文件。

这是我当前的 app.config 文件：

```
<?xml version="1.0" encoding="utf-8" ?>
<configuration>
<configuration>
  <runtime>
    <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
      <dependentAssembly>
        <assemblyIdentity name="JSNet" publicKeyToken="89845dcd8080cc91" />
        <bindingRedirect oldVersion="1.0.0.0" newVersion="9.0.0.0"/>
      </dependentAssembly>
    </assemblyBinding>
  </runtime>
</configuration>
    <configSections>
        <sectionGroup name="userSettings" type="System.Configuration.UserSettingsGroup, System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" >
            <section name="pwn4g3.Properties.Settings" type="System.Configuration.ClientSettingsSection, System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" allowExeDefinition="MachineToLocalUser" requirePermission="false" />
        </sectionGroup>
    </configSections>
    <userSettings>
        <pwn4g3.Properties.Settings>
            <setting name="CustomerFeedbackOptIn" serializeAs="String">
                <value>True</value>
            </setting>
            <setting name="FirstRun" serializeAs="String">
                <value>True</value>
            </setting>
        </pwn4g3.Properties.Settings>
    </userSettings>
</configuration> 
```

任何帮助都会很棒，真的很想在今晚发布我的应用程序的新版本，在那个 dll 上工作了一天，发现它在将新应用程序的 beta 副本发送给某人然后亲自测试后无法运行带调试的虚拟机。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T01:09:35.407

您得到的错误是要求一个未签名 ( `PublicKeyToken=null`) 的 JSNet dll，因此这部分实际上是令人困惑的。但是，可能是您的 app.config 正在寻找 DLL 的 9.0.0.0 版本，`publicKeyToken="89845dcd8080cc91"`之后它很可能会恢复为寻找未签名的版本（因此您的错误）。您应该检查您的 GAC 是否有 JSNet dll。这很可能在 PC 上有效，但在其他 PC 上无效。如果不是 GAC，它需要在您的执行目录中（但我希望这会从 PC 转移到 PC）。希望这能给你一个开始？

您也可以尝试使用 FusionLogViewer（以管理员身份运行），并打开日志记录以查看加载程序集时正在搜索的路径。

[这是有关如何使用 FusionLogViewer 的 MSDN](http://msdn.microsoft.com/en-us/library/e74a18c4%28v=vs.80%29.aspx)

# internet-explorer - 检查 IE 的元素选项？

> ID：10081711
> 
> 赞同：25
> 
> 时间：2012-04-10T00:50:29.177
> 
> 标签：internet-explorer

在 Chrome 和 Firefox 中，您可以右键单击一个元素并选择“检查元素”以查看有关它的开发人员信息。

是否有插件或选项可以使用相同的右键菜单启动 IE 开发人员工具栏（或类似工具）？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-11-28T14:59:56.213

在 IE9（我没有在 IE8 上测试）上，您可以通过按 来获取开发者工具栏`F12`，然后`Ctrl+B`（或单击指针）来检查元素。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-07-02T00:38:02.763

在 IE8中使用`Inspect element`只需按下按钮`F12`

![在此处输入图像描述](../Images/16deda109c3b0d267ad8fedd41705980.png)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-11-17T20:56:33.463

我建议使用[Firebug Lite](https://getfirebug.com/firebuglite)。Firebug Lite 是用 javascript 编写的，因此您可以在任何浏览器中使用它。在页面顶部包含以下代码`<head>`：或使用[此处](https://getfirebug.com/firebuglite#Stable)
`<script type="text/javascript" src="https://getfirebug.com/firebug-lite.js"></script>`
提供的书签

# ruby - "a && not b" 给出语法错误？

> ID：10081712
> 
> 赞同：2
> 
> 时间：2012-04-10T00:50:29.623
> 
> 标签：ruby

这一行给了我一个语法错误：

`if @array.include?('cat') && not @array.include?('dog')`

有任何想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-10T00:54:28.757

做这个：

```
if @array.include?('cat') && ! @array.include?('dog') 
```

`!`并且`not`做大部分相同的事情，但不能完全互换使用。

对于好奇的人：实际上，ruby 解析器中存在某种怪癖，使其无法解释像这样的表达式，即使它们在理论上是可解析的并且是合理的。

这些可以解析：

```
not true && true
true && not(true) 
```

但这些不能：

```
true && not true
true && not (true) 
```

请注意，最后一个仅在前面的额外空间中有所不同`(`！

# jqgrid - jqGrid如何在使用格式化程序操作时将删除对话框居中

> ID：10081713
> 
> 赞同：0
> 
> 时间：2012-04-10T00:50:36.743
> 
> 标签：jqgrid, jqgrid-formatter

我正在使用带有长网格的 jqGrid 格式化程序操作，我试图将删除对话框定位在屏幕的中心，我已经这样做了，但是由于某种原因，窗口滚动到网格的顶部并且对话​​框变得不可见给用户

[单击此处查看该问题的截屏视频](http://screenr.com/16d8)

这是使用的代码：

```
 // define handler function for 'afterSubmit' event.
    var actionStatus = function(response,postdata){
    //alert($.parseJSON(response.responseText).USERDATA.MSG);
    aData = $.parseJSON(response.responseText).USERDATA;

    if (aData.STATUS){
        $.jgrid.info_dialog("Success", aData.MSG, $.jgrid.edit.bClose,{buttonalign:'right'});
        var thisId = aData.ID;
        $("#list").jqGrid('setGridParam',{loadComplete: function(){$(this).jqGrid('setRowData', thisId, false, 'mybold'); $("#" + thisId).effect("highlight", {color:"orange" }, 3000);}});
    }
    else {
        $(".topinfo").html(aData.MSG);
    }
    return [aData.STATUS, aData.MSG, aData.ID];
}

$(document).ready(function(){

    var grid = $("#list");
    var lastSel;
    var selICol; //iCol of selected cell
    var selIRow; //iRow of selected cell

    $("#list").jqGrid({
        url:'data.cfc?method=GetRecords', //CFC that will return the users
        datatype: 'json', //We specify that the datatype we will be using will be JSON
        //The JSON reader. This defines what the JSON data returned from the CFC should look like
        jsonReader: {
                      root: "DATA",
                      page: "CURPAGE",
                      total: "TOTALPAGES",
                      records: "TOTALROWS",
                      repeatitems: false,
                      id: ""
              },
        colNames: [ "YEAR", "SPC_CD", "SPC_CD", "BASE_COUNT", "BASE_MEDIAN", "START_COUNT", "START_MEDIAN", " "],
        /*
        If you want not display some columns which you need only to build the composite key you can use for this columns following options in the colModel
            hidden: true, editable: true, editrules: { edithidden: false }, hidedlg: true
        It will make columns invisible for user, but the data will be send to server at all edit operations.
        */
        colModel: [
            { name: "year", sortable: true, index:'year', editable: false, editoptions:{size:5, maxlength:4}, editrules:{required:true, integer:true}
            //, formoptions:{elmsuffix:" <img src='images/red_asterisk.gif' title='Required'>"} 
            },
            { name: "spc_cd", sortable: true, index:'spc_cd', editable: false, editoptions:{size:13, maxlength:10}, editrules:{required:true}
            //, formoptions:{ elmsuffix:" <img src='images/red_asterisk.gif' title='Required'>"} 
            },
            { name: "spc_cd", sortable: true, index:'spc_cd', editable: true, editoptions:{size:13, maxlength:10} },
            { name: "base_count", sortable: true, index:'base_count', editable: true, editoptions:{size:13, maxlength:10}, editrules:{integer:true} },
            { name: "base_median", sortable: true, index:'base_median', editable: true, editoptions:{size:13, maxlength:10}, editrules:{integer:true} },
            { name: "start_count", sortable: true, index:'start_count', editable: true, editoptions:{size:13, maxlength:10}, editrules:{integer:true} },
            { name: "start_median", sortable: true, index:'start_median', editable: true, editoptions:{size:13, maxlength:10}, editrules:{integer:true} 
                /*
                ,editOptions:{  dataEvents: [
                                    {
                                        type: 'keydown',
                                        fn: function (e) {
                                            var key = e.charCode || e.keyCode;
                                            if (key == 9)//tab
                                            {
                                                //Enter edit row for next row in grid
                                               // $('#list').jqGrid().editCell(" + selIRow + " + 1, " + selICol + ", true);
                                                $('#list').jqGrid("editCell", iRow+1, iCol, true)
                                            }
                                        }
                                    }
                                ]                                               
                }
                */
            },
            { name: 'myac', width:60, fixed:true, sortable:false, resize:false, formatter:'actions', 
                formatoptions:{ keys:true
                                , editformbutton:false, 
                                editbutton : false, 
                                // For multi-column keys, we need to pass additional data to the delete function
                                delOptions:{ url:"data.cfc?method=delRecord", reloadAfterSubmit:true, closeOnEscape:true, afterSubmit: actionStatus, 
                                                serializeDelData: function (postdata) {
                                                    var rowdata = $('#list').getRowData(postdata.id);
                                                    // append postdata with any information 
                                                    //return {id: postdata.id, oper: postdata.oper, year: rowdata.year, spc_cd: rowdata.spc_cd};
                                                    postdata.year = rowdata.year;
                                                    postdata.spc_cd = rowdata.spc_cd;
                                                    return postdata;
                                                }, 
                                                recreateForm: true,
                                                beforeShowForm: function ($form) {
                                                    //var sel_id = $("#list").jqGrid('getGridParam', 'selrow');
                                                    //$("td.delmsg", $form[0]).html("Delete record with <b>id=" + $("#list").jqGrid('getCell', sel_id, 'spc_cd') + "</b>?");

                                                    var idOfDeletedRow = $("#DelData>td:first").text();
                                                    $("td.delmsg", $form[0]).html( "Delete record with <br><b>year=" +
                                                            $("#list").jqGrid('getCell', idOfDeletedRow, 'year') + "</b> and <b>spc_cd=" +
                                                            $("#list").jqGrid('getCell', idOfDeletedRow, 'spc_cd') + "</b> ?" );

                                                    //$("#delmod" + grid[0].id).addClass("centered");
                                                    var delDiv = $("#delmod" + grid[0].id);
                                                    delDiv.center();

                                                    //var scrollPosition = $("#list").closest(".ui-jqgrid-bdiv").scrollTop();
                                  // alert(scrollPosition);
                                   //selRowCoordinates = $('#'+selRowId).offset();
                              // delDiv.scrollTop(scrollPosition);

                                                    //var gviewHeight = $("#gview_" + $.jgrid.jqID(this.id)).outerHeight();
                                                    //delDiv.css({top:'50%',left:'50%',margin:'-'+(delDiv.height() / 2)+'px 0 0 -'+(delDiv.width() / 2)+'px'});
                                                }
                                                /*
                                                ,
                                                afterShowForm: function($form) {
                                    var $dialog = $form.closest('div.ui-jqdialog'),
                                        idOfDeletedRow = $("#DelData>td:first").text(),
                                        selRowCoordinates = $('#'+idOfDeletedRow).offset();

                                    $form.find("td.delmsg:first")
                                        .html("Delete record with <b>code=" +
                                            $("#list").jqGrid('getCell', idOfDeletedRow, 'cd') + "</b>?");
                                    $dialog.offset(selRowCoordinates);

                                        }
                                        */
                                }
                               /*
                               , 
                                editOptions:{ url:"data.cfc?method=editRecord", reloadAfterSubmit:true, closeOnEscape:true, closeAfterEdit:true, afterSubmit: actionStatus
                                                , serializeEditData: function (postdata) {
                                                    var rowdata = $('#list').getRowData(postdata.id);
                                                    // append postdata with any information 
                                                    postdata.old_year = rowdata.year;
                                                    postdata.old_spc_cd = rowdata.spc_cd;
                                                    return postdata;
                                                }                                               
                                }
                                */ 
                } 
            }
        ],
        afterEditCell: function(rowid, cellname, value, iRow, iCol) {

            // Get a handle to the actual input field
            var inputControl = $('#' + (iRow) + '_' + cellname);

            // Listen for tab on col #7 START_MEDIAN, which is the last editable column in the row
            // as we need to move to the first editable cell in the next row
            if ( iCol == 7 ){
                inputControl.bind("keydown",function(e) {               
                    if (e.charCode || e.keyCode === 9) {  // Enter key:

                        var increment = 1;
                        // Do not go out of bounds
                        var lastRowInd = $("#list").jqGrid("getGridParam","reccount");
                        if ( iRow+increment == 0 || iRow+increment == lastRowInd+1)
                            return;   // we could re-edit current cell or wrap
                        else
                            $("#list").jqGrid("editCell", iRow+increment, 3, true); //move to the first editable cell (#3) in the next row
                    }
                });
            } // End keydown binding
        },
        beforeEditCell : function(rowid, cellname, value, iRow, iCol){
            selICol = iCol;
            selIRow = iRow;
        },
        /*
        onSelectRow: function(id) {
                    if (id && id !== lastSel) {
                        $("#list").jqGrid('restoreRow',lastSel);
                        lastSel = id;
                    }
                },
                ondblClickRow: function(id, ri, ci) {
                    $("#list").jqGrid('editRow',id,true);
                    return;
                },
        */
        cellEdit : true,
        cellsubmit : 'clientArray',
        onPaging : isDataChanged,
        hidegrid: false,
        shrinkToFit: true,
        altRows: true,
        toppager: true,
        gridview: true, //speed the reading process for large data sets
        ignoreCase: true, //when sorting
        pager: $('#pager'), //The div we have specified, tells jqGrid where to put the pager
        rowNum:100, //Number of records we want to show per page
        //rowList:[20,50], //Row List, to allow user to select how many rows they want to see per page
        rowTotal: 1000, // get this number of rows from the server
        //loadonce:true, //load all the needed data from server at once and then operate on it locally
        sortorder: "desc", //Default sort order
        sortname: "year,spc_cd", //Default sort column
        //viewsortcols: true, // view sortable columns
        viewrecords: true, //Shows the nice message on the pager
        //imgpath: '/Test/themes/basic/images', //Image path for prev/next etc images
        caption: 'Table: DATA_TEST', //Grid Name
        recordtext: "Record {0} - {1} of {2}",//Pager information to show
        rownumbers: true,//Show row numbers
        rownumWidth: "40",//Width of the row numbers column
        sortable: true,
        width: 'auto',
        height:'auto', //I like auto, so there is no blank space between. Using a fixed height can mean either a scrollbar or a blank space before the pager
        mtype:'POST',   
        //toolbar:[true,"top"], //Shows the toolbar at the top. We will use it to display user feedback
        //editurl:"data.cfc?method=editRecord" //The Add/Edit function call
        //editurl: 'clientArray',
        }

    );

    $("#list").jqGrid(
        'navGrid',
        '#list_toppager', //The id of the top pager is a combination of grid id and “_toppager”
        {addicon:"ui-icon-circle-plus", addtext:"Add New Record&nbsp;&nbsp;&nbsp;", addtitle:"", del:false, edit:false, search:false, closeOnEscape:true}, //options 
        {}, //edit options
        {url:"data.cfc?method=addRecord", reloadAfterSubmit:true, closeAfterAdd: true, afterSubmit: actionStatus, 
            // make the primary key columns editable in add mode
            beforeInitData: function(formid) {
                $("#list").jqGrid('setColProp','year',{editable:true});
                $("#list").jqGrid('setColProp','spc_cd',{editable:true});
            },
            // after the form is shown, revert the primary key columns to un-editable
            afterShowForm: function (formid) {
                $("#list").jqGrid('setColProp','year',{editable:false});
                $("#list").jqGrid('setColProp','spc_cd',{editable:false});
            }
        }, // add options 
        {}, // del options
        {}, // search options
        {closeOnEscape:true}
    ); //.navSeparatorAdd('#list_toppager');

    $("#list").jqGrid().navGrid().navButtonAdd('#list_toppager',
            {
                caption: "Save Changed Rows&nbsp;&nbsp;&nbsp;",
                buttonicon: "ui-icon-disk",
                onClickButton: function () {
                    $("#list").jqGrid("restoreCell", selIRow, selICol, true); //if there's an open cell, first restore it
                    var ret = $("#list").getChangedCells('all');
                    //console.dir(ret);
                    //console.info($('#1_base_count').val());
                    var ret2 = JSON.stringify(ret);
                    //console.info(ret2);
                    $.ajax({
                        type: "post",
                        url: "data.cfc?method=editRecord",
                        data: { jsonData: ret2 },
                        // contentType: "application/json",
                        //dataType: "json",
                        success: function(data) {
                            $.jgrid.info_dialog("Success", "Rows Updated Successfully", $.jgrid.edit.bClose,{buttonalign:'right'});
                            /*
                            $('<div></div>').html(data).dialog({
                                'title' : 'Message',
                                'modal' : true,
                                'width' : 400,
                                'height' : 400,
                                'buttons' : {
                                    'OK' : function() {
                                        $(this).dialog('close');
                                    }
                                }
                            });
                            */
                            $('#list').trigger('reloadGrid');
                        },
                        error: function(){
                            $.jgrid.info_dialog("Error", "Error Occurred while saving data", $.jgrid.edit.bClose,{buttonalign:'right'});
                        }
                    });
                },
                position: "first"
            }
            ); //.navSeparatorAdd('#list_toppager');

//Supresss jqGrid error dialog, called #info_dialog
            /*
            $("#delmodlist").live("focus", function () {

                var errorMessage = $("#delmsg").text();
                $("#delmodlist").center();
                $("#delmodlist").blur();

            });
            */
    //$("#list").jqGrid('filterToolbar',{stringResult: true,searchOnEnter : false});

    //$("#list_toppager_center").hide();    

});
// define handler function for 'afterSubmit' event.
var actionStatus = function(response,postdata){
aData = $.parseJSON(response.responseText).USERDATA;

    if (aData.STATUS){
        $.jgrid.info_dialog("Success", aData.MSG, $.jgrid.edit.bClose,{buttonalign:'right'});
    else {
        $(".topinfo").html(aData.MSG);
    }
    return [aData.STATUS, aData.MSG, aData.ID];
}

$(document).ready(function(){

    var grid = $("#list");
    var lastSel;
    var selICol; //iCol of selected cell
    var selIRow; //iRow of selected cell

    $("#list").jqGrid({
        url:'data.cfc?method=GetRecords', //CFC that will return the users
        datatype: 'json', //We specify that the datatype we will be using will be JSON
        //The JSON reader. This defines what the JSON data returned from the CFC should look like
        jsonReader: {
                      root: "DATA",
                      page: "CURPAGE",
                      total: "TOTALPAGES",
                      records: "TOTALROWS",
                      repeatitems: false,
                      id: ""
              },
        colNames: [ "YEAR", "CD", "SPC_CD", "BASE_COUNT", "BASE_MEDIAN", "START_COUNT", "START_MEDIAN", " "],
        /*
        If you want not display some columns which you need only to build the composite key you can use for this columns following options in the colModel
            hidden: true, editable: true, editrules: { edithidden: false }, hidedlg: true
        It will make columns invisible for user, but the data will be send to server at all edit operations.
        */
        colModel: [
            { name: "year", sortable: true, index:'year', editable: false, editoptions:{size:5, maxlength:4}, editrules:{required:true, integer:true}
            //, formoptions:{elmsuffix:" <img src='images/red_asterisk.gif' title='Required'>"} 
            },
            { name: "cd", sortable: true, index:'cd', editable: false, editoptions:{size:13, maxlength:10}, editrules:{required:true}
            //, formoptions:{ elmsuffix:" <img src='images/red_asterisk.gif' title='Required'>"} 
            },
            { name: "spc_cd", sortable: true, index:'spc_cd', editable: true, editoptions:{size:13, maxlength:10} },
            { name: "base_count", sortable: true, index:'base_count', editable: true, editoptions:{size:13, maxlength:10}, editrules:{integer:true} },
            { name: "base_median", sortable: true, index:'base_median', editable: true, editoptions:{size:13, maxlength:10}, editrules:{integer:true} },
            { name: "start_count", sortable: true, index:'start_count', editable: true, editoptions:{size:13, maxlength:10}, editrules:{integer:true} },
            { name: "start_median", sortable: true, index:'start_median', editable: true, editoptions:{size:13, maxlength:10}, editrules:{integer:true} 
                /*
                ,editOptions:{  dataEvents: [
                                    {
                                        type: 'keydown',
                                        fn: function (e) {
                                            var key = e.charCode || e.keyCode;
                                            if (key == 9)//tab
                                            {
                                                //Enter edit row for next row in grid
                                               // $('#list').jqGrid().editCell(" + selIRow + " + 1, " + selICol + ", true);
                                                $('#list').jqGrid("editCell", iRow+1, iCol, true)
                                            }
                                        }
                                    }
                                ]                                               
                }
                */
            },
            { name: 'myac', width:60, fixed:true, sortable:false, resize:false, formatter:'actions', 
                formatoptions:{ keys:true
                                , editformbutton:false, 
                                editbutton : false, 
                                // For multi-column keys, we need to pass additional data to the delete function
                                delOptions:{ url:"data.cfc?method=delRecord", reloadAfterSubmit:true, closeOnEscape:true, afterSubmit: actionStatus, 
                                                serializeDelData: function (postdata) {
                                                    var rowdata = $('#list').getRowData(postdata.id);
                                                    // append postdata with any information 
                                                    //return {id: postdata.id, oper: postdata.oper, year: rowdata.year, cd: rowdata.cd};
                                                    postdata.year = rowdata.year;
                                                    postdata.cd = rowdata.cd;
                                                    return postdata;
                                                }, 
                                                recreateForm: true,
                                                beforeShowForm: function ($form) {
                                                                        var idOfDeletedRow = $("#DelData>td:first").text();
                                                    $("td.delmsg", $form[0]).html( "Delete record with <br><b>year=" +
                                                            $("#list").jqGrid('getCell', idOfDeletedRow, 'year') + "</b> and <b>spc_cd=" +
                                                            $("#list").jqGrid('getCell', idOfDeletedRow, 'spc_cd') + "</b> ?" );

                                                    var delDiv = $("#delmod" + grid[0].id);
                                                    //delDiv.center();

                                                        }
                                                /*
                                                ,
                                                afterShowForm: function($form) {
                                    var $dialog = $form.closest('div.ui-jqdialog'),
                                        idOfDeletedRow = $("#DelData>td:first").text(),
                                        selRowCoordinates = $('#'+idOfDeletedRow).offset();

                                    $form.find("td.delmsg:first")
                                        .html("Delete record with <b>code=" +
                                            $("#list").jqGrid('getCell', idOfDeletedRow, 'cd') + "</b>?");
                                    $dialog.offset(selRowCoordinates);

                                        }
                                        */
                                }

                } 
            }
        ],
        afterEditCell: function(rowid, cellname, value, iRow, iCol) {

            // Get a handle to the actual input field
            var inputControl = $('#' + (iRow) + '_' + cellname);

            // Listen for tab on col #7 START_MEDIAN, which is the last editable column in the row
            // as we need to move to the first editable cell in the next row
            if ( iCol == 7 ){
                inputControl.bind("keydown",function(e) {               
                    if (e.charCode || e.keyCode === 9) {  // Enter key:

                        var increment = 1;
                        // Do not go out of bounds
                        var lastRowInd = $("#list").jqGrid("getGridParam","reccount");
                        if ( iRow+increment == 0 || iRow+increment == lastRowInd+1)
                            return;   // we could re-edit current cell or wrap
                        else
                            $("#list").jqGrid("editCell", iRow+increment, 3, true); //move to the first editable cell (#3) in the next row
                    }
                });
            } // End keydown binding
        },
        beforeEditCell : function(rowid, cellname, value, iRow, iCol){
            selICol = iCol;
            selIRow = iRow;
        },

        cellEdit : true,
        cellsubmit : 'clientArray',
        onPaging : isDataChanged,
        hidegrid: false,
        shrinkToFit: true,
        altRows: true,
        toppager: true,
        gridview: true, //speed the reading process for large data sets
        ignoreCase: true, //when sorting
        pager: $('#pager'), //The div we have specified, tells jqGrid where to put the pager
        rowNum:100, //Number of records we want to show per page
        rowTotal: 1000, // get this number of rows from the server
        sortorder: "desc", //Default sort order
        sortname: "year,spc_cd", //Default sort column
        viewrecords: true, //Shows the nice message on the pager

        caption: 'Table: DATA_TEST', //Grid Name
        recordtext: "Record {0} - {1} of {2}",//Pager information to show
        rownumbers: true,//Show row numbers
        rownumWidth: "40",//Width of the row numbers column
        sortable: true,
        width: 'auto',
        height:'auto', //I like auto, so there is no blank space between. Using a fixed height can mean either a scrollbar or a blank space before the pager
        mtype:'POST'
        }

    );

    $("#list").jqGrid(
        'navGrid',
        '#list_toppager', //The id of the top pager is a combination of grid id and “_toppager”
        {addicon:"ui-icon-circle-plus", addtext:"Add New Record&nbsp;&nbsp;&nbsp;", addtitle:"", del:false, edit:false, search:false, closeOnEscape:true}, //options 
        {}, //edit options
        {url:"data.cfc?method=addRecord", reloadAfterSubmit:true, closeAfterAdd: true, afterSubmit: actionStatus, 
            // make the primary key columns editable in add mode
            beforeInitData: function(formid) {
                $("#list").jqGrid('setColProp','year',{editable:true});
                $("#list").jqGrid('setColProp','cd',{editable:true});
            },
            // after the form is shown, revert the primary key columns to un-editable
            afterShowForm: function (formid) {
                $("#list").jqGrid('setColProp','year',{editable:false});
                $("#list").jqGrid('setColProp','cd',{editable:false});
            }
        }, // add options 
        {}, // del options
        {}, // search options
        {closeOnEscape:true}
    ); //.navSeparatorAdd('#list_toppager');

    $("#list").jqGrid().navGrid().navButtonAdd('#list_toppager',
            {
                caption: "Save Changed Rows&nbsp;&nbsp;&nbsp;",
                buttonicon: "ui-icon-disk",
                onClickButton: function () {
                    $("#list").jqGrid("restoreCell", selIRow, selICol, true); //if there's an open cell, first restore it
                    var ret = $("#list").getChangedCells('all');
                    //console.dir(ret);
                    //console.info($('#1_base_count').val());
                    var ret2 = JSON.stringify(ret);
                    //console.info(ret2);
                    $.ajax({
                        type: "post",
                        url: "data.cfc?method=editRecord",
                        data: { jsonData: ret2 },
                        // contentType: "application/json",
                        //dataType: "json",
                        success: function(data) {
                            $.jgrid.info_dialog("Success", "Rows Updated Successfully", $.jgrid.edit.bClose,{buttonalign:'right'});

                            $('#list').trigger('reloadGrid');
                        },
                        error: function(){
                            $.jgrid.info_dialog("Error", "Error Occurred while saving data", $.jgrid.edit.bClose,{buttonalign:'right'});
                        }
                    });
                },
                position: "first"
            }
            ); 

}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T23:20:40.957

您没有发布您使用的`center`方法代码或描述您使用的插件。无论如何，我认为您应该使用`delDiv.center();`inside of`afterShowForm`而不是 inside of `beforeShowForm`。

就像您[在演示](http://www.ok-soft-gmbh.com/jqGrid/ChangeDelDialogPosition1.htm)中看到的那样，滚动问题通常不应该存在。

# css - LESS css 类层次结构

> ID：10081714
> 
> 赞同：0
> 
> 时间：2012-04-10T00:50:43.673
> 
> 标签：css, less

我有一个聊天联系人列表，其中每个联系人都可以具有由类表示的不同状态：

*   。在线的
*   。离线
*   .online .selected
*   .offline .selected

这些是相关的样式（示例）：

```
.online {
   background-color: #fff;
   p { color: #000; }
}

.selected {
   background-color: #000;
   p { color: #fff; }  // This doesn't take effect
} 
```

Stylewise 我总是希望应用于 .selected 的样式占主导地位，但不幸的是，当我添加 .selected 类时，它只会更改背景颜色（从顶层开始）。

我错过了什么？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T15:33:35.200

当它被编译时，可能会发生一些最终改变顺序的事情（尽管它不应该）。首先，除了向我们展示您的 LESS 之外，您能否向我们展示您编译后的 CSS（[Procssor](http://procssor.com/)非常适合在编译后进行美化），这应该让我们更好地了解浏览器看到的内容，您还可以向我们展示 HTML 吗？你的元素。

说了这么多简单的解决方案，尤其是当您希望选择始终占主导地位时，使用`!important`

```
.online {
   background-color: #fff;
   p { color: #000; }
}

.selected {
   background-color: #000!important;
   p { color: #fff!important; }
} 
```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-04-10T02:29:58.603

如果您`<p>`使用 CSS 更改元素，则需要使 CSS 看起来像这样：

```
.selected p {
    background-color: #0000;
    color: #fff;
} 
```

.online 类也是如此

如果您需要 2 个不同的状态，则添加额外的 CSS：

```
.selected {
    // basic code
}

.selected p {
    // extended code to p element
} 
```

# python - 脚本多次返回相同的值

> ID：10081716
> 
> 赞同：3
> 
> 时间：2012-04-10T00:51:20.723
> 
> 标签：python, anagram

基本上我有一个 Python 脚本，它需要几个字母，获取它们的每个组合，然后检查它是否是一个实际的单词（以某种方式思考拼字游戏）但由于某种原因它多次返回相同的单词，而我没有想要它这样做，脚本看起来像：

```
with open("dictionary.txt") as word_file:
    english_words = set(word.strip().lower() for word in word_file)

def is_english_word(word):
    return word.lower() in english_words

print is_english_word("ham")
print is_english_word("zz")

a = raw_input("Please enter first letter: ")
b = raw_input("Please enter second letter: ")
c = raw_input("Please enter third letter: ")
d = raw_input("Please enter fourth letter: ")
e = raw_input("Please enter fifth letter: ")

check =[a,b,c,d,e]

def get_combos(list):
    import itertools
    count = len(list)
    got = []
    combos =[]
    while count > 0:
        for a in itertools.permutations(list,count):
            if a in got:
                got.append(a)
            else:
                got.append(a)
                combos.append(a)
        count = count - 1
    for a in combos:
        strip_combos(a)

def strip_combos(list):
    count = ''
    words = []
    for entry in list:
        count = count + entry
        words.append(count)
    check_combo(words)

def check_combo(list):
    words = []
    got = []
    for entry in list:
        if is_english_word(entry):
            if entry not in words:
                print entry
                words.append(entry)

get_combos(check) 
```

现在它也可以按我的意思工作，只打印字典中的单词，但它会多次打印同一个单词，例如，如果字母是：

a, c, e, s

它会在每次显示在列表中时返回，但据我所知，我通过 get 和 words 列表省略了在 check_combo 过程中多次出现的相同结果

我有一种感觉，这个问题可能源于某个地方的 while 循环中的 get_combos 过程，尽管我尝试修改几乎所有内容都无济于事，所以我转向那些比我更有知识的人寻求帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T01:22:47.353

```
 if a in got:
            got.append(a)
        else:
            got.append(a)
            combos.append(a) 
```

这几乎肯定不是你的意思:)

看来您想要做的是从排列中获得独特的结果。您使这变得太复杂了，同时速度也变慢了（因为您使用 a`list`作为查找的数据结构）。

具体来说，您需要一**组**结果，就像一组独特事物的数学概念一样。对你来说幸运的是，Python 有这个内置的。

但是，您确实使整个问题变得过于复杂，并且您的界面错误；您不应该`print`在最内层获取结果，而是在最外层（在`return`获取适当的数据之后）。尽管您的级别比您需要的要多，因为您在手动处理数据列表方面做的工作太多。只需描述您想要的数据：您可以从图块中制作的“单词”集与字典中实际单词的交集。前者是从多个迭代器获得的字母组合中的字母连接起来的结果集，`itertools.permutations`您可以将它们与`itertools.chain`.

```
def get_combos(letters):
    return set(
        ''.join(x)
        for x in itertools.chain(*(
            itertools.permutations(letters, count)
            for count in range(len(letters))
        ))
    ).intersection(english_words) 
```

完毕。

或者您可以随时过滤集合：

```
def get_combos(letters):
    return set(
        ''.join(x)
        for x in itertools.chain(*(
            itertools.permutations(letters, count)
            for count in range(len(letters))
        ))
        if is_english_word(''.join(x))
    ) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T01:05:59.277

这个小序列看起来不对：

```
 if a in got:
            got.append(a)
        else:
            got.append(a)
            # .... 
```

如果您真的想追`a`加到`got`无论选择哪个分支，请在`if`块之外进行。

# sql - 如何对简单 SQL 查询的结果进行排序

> ID：10081717
> 
> 赞同：-1
> 
> 时间：2012-04-10T00:51:39.017
> 
> 标签：sql, count, rows

我的 SQL

```
SELECT nce.id, nce.send, count( * ) AS total
FROM `newsletter_email` nce
WHERE 1
GROUP BY nce.id, nce.send 
```

产生结果：

```
id  send    total
4   0       6
4   1       1
5   0       2
6   1       7
7   1       4
8   0       2
8   1       4
9   1       1 
```

但我希望结果是：

```
id  send    no_send     total
4   6       1           7
5   0       2           2
6   7       0           7
7   4       0           4
8   4       2           6
9   1       0           1 
```

我尝试了几种方法，但没有给出预期的结果。你能帮我吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-10T00:58:30.690

假设 Send 的 send 值为 1，no_send 的值为 0，您可以简单地将 send 的值相加：

```
SELECT nce.id, 
   sum(nce.send) as Send, 
   sum(1 - nce.send) as NO_send, 
   count(nce.send) as Total
FROM `newsletter_email` nce
GROUP BY nce.id 
```

但是，一般模式是：

```
SELECT nce.id, 
   sum(case when nce.send = 1 then 1 end) as Send, 
   sum(case when nce.send = 0 then 1 end) as NO_send, 
   count(nce.send) as Total
FROM `newsletter_email` nce
GROUP BY nce.id 
```

# php - PHP MySQL表将来自单个表中的行的值合并

> ID：10081719
> 
> 赞同：0
> 
> 时间：2012-04-10T00:51:57.007
> 
> 标签：php, mysql

我想要做的是显示5个随机图像，其中包含一定数量的文本而不重复。图像和文本的链接将存储在数据库中。我遇到的问题是我需要将每个 ID 值放入单个 PHP 数组中，以便对 ID 进行洗牌并选择随机 5，但是如果我有 3 行，我一直无法将它们组合成一个数组最多3个数组。

这是一个包含 3 行 ID 为 1、2、4 的失败代码示例：

```
function getAll () {
$query = mysql_query("SELECT * FROM ads") or die(mysql_error());
$myarray = array();
    while ($numbers = mysql_fetch_array($query)){
    $arr = $numbers['ID'].",";
    print_r (explode(",", $arr));
    }
}; 
```

这是输出：

```
Array ( [0] => 1 [1] => ) Array ( [0] => 2 [1] => ) Array ( [0] => 4 [1] => ) 
```

这是所需的输出：

```
Array ( [0] => 1 [1] => 2 [2] => 4) 
```

猜猜这是一个菜鸟问题，但我已尽力寻找解决方案但失败了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T00:55:29.170

简单的解决方案：直接`ORDER BY RAND()`在 MySQL 查询中使用：

```
SELECT * FROM ads ORDER BY RAND() LIMIT 5 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T01:06:30.293

我认为您应该查看 Alp 的解决方案，但要直接回答您的问题 - 将其放入您的`while`循环中。

```
array_push($arr,$numbers['Id']); 
```

但首先在循环之前声明变量：

```
$arr = array(); 
```

# php - 带有提交表单和 php 的 Ajax

> ID：10081721
> 
> 赞同：1
> 
> 时间：2012-04-10T00:52:46.320
> 
> 标签：php, jquery, post

我不确定我做错了什么。我搜索了多个论坛，但没有得到解决方案。我为从表单提交值定义了以下 ajax。我有警报功能以确保正在调用此代码（确实如此），但没有执行 process.php。任何想法为什么？这是 ajax 代码（我的 dataString 包含所有变量的值，$_POST 变量似乎没有问题。

```
 // JavaScript Document
$(document).ready(function(){
$(".button").click(function() {
  // validate and process form here
  //alert("yayyy");

   var company = $("input#company").val();
   var jobfunc = $("input#jobfunc").val();
   var location = $("input#location").val();
   var overall = $("input#overall").val();
   var detail = $("textarea#detail").val();
   var pros = $("textarea#pros").val();
   var cons = $("textarea#cons").val();
   var sr_mgmt = $("textarea#sr_mgmt").val();
   var submitted_by = $("input#submitted_by").val();
   var classof = $("input#classof").val();
   var school = $("input#school").val();
   var anonymous = $("input#anonymous").val();
   if (anonymous == 'on')
   {
       var anonymous_tmp = 'Y';
   }
   else
   {
       var anonymous_tmp = 'N';
   }

    var dataString = 
    'company=' + company +
    '&jobfunc=' + jobfunc +
    '&location=' + location +
    '&overall=' + overall +
    '&detail=' + detail +
    '&pros=' + pros +
    '&cons=' + cons +
    '&sr_mgmt=' + sr_mgmt +
    '&submitted_by=' + submitted_by +
    '&classof=' + classof + 
    '&school=' + school +
    '&anonymous=' + anonymous_tmp;

  alert (dataString);
  $.ajax(
  {
    type:"POST",
    url:"process.php",
    data:dataString,
    success:function() 
    {
      $('#testimonials').html("<div id='message'></div>");
      $('#message').html("<h2>Your information has been submitted!</h2>")
      .append("<p>Thank you for your help and support.</p>")
      .hide()
      .fadeIn(1500, function() 
      {
        $('#message').append("<img id='checkmark' src='images/check.png'/>");
      });
    }
  });
  return false;
});
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T01:58:42.120

process.php 是否返回 500 错误，它是否位于 Web 应用程序的根目录中？您可以通过在浏览器中查看开发者控制台日志来查找，或者更改功能

```
success:function() 
```

至

```
success:function(res, textStatus, jqXHR) {
console.log(res);
console.log(textStatus);
console.log(jqXHR);
} 
```

并检查返回的内容。

此外，与其手动构造表单值，不如直接使用

```
$('id_of_form').serialize(); 
```

并将其传递给 $.post？

希望有帮助。

# c# - 为什么 HttpWebRequest 会抛出异常而不是返回 HttpStatusCode.NotFound？

> ID：10081726
> 
> 赞同：40
> 
> 时间：2012-04-10T00:53:54.670
> 
> 标签：c#, asp.net, httpwebrequest, http-status-code-404

我正在尝试使用 HttpWebRequest 验证 Url 的存在。我发现了一些基本上可以做到这一点的例子：

```
HttpWebRequest request = (HttpWebRequest)HttpWebRequest.Create(Url);
request.Method = "HEAD";
using (HttpWebResponse response = request.GetResponse() as HttpWebResponse)
{
    return response.StatusCode;
} 
```

但是，如果 url 确实被破坏了，它不会返回响应，而是抛出异常。

我将我的代码修改为：

```
try
{
    HttpWebRequest request = (HttpWebRequest)HttpWebRequest.Create(Url);
    request.Method = "HEAD";
    using (HttpWebResponse response = request.GetResponse() as HttpWebResponse)
    {
        return response.StatusCode;
    }
}
catch (System.Net.WebException ex)
{
    var response = ex.Response as HttpWebResponse;
    return response == null ? HttpStatusCode.InternalServerError : response.StatusCode;
} 
```

这似乎终于做了我想要的。

但我想知道，为什么请求会抛出异常而不是返回带有 NotFound 状态码的响应？

* * *

## 回答 #1

> 赞同：71
> 
> 时间：2012-04-10T04:26:20.513

是的，当网页大量使用状态代码并且并非所有状态代码都是错误时，这可能会很烦人。这会使处理身体相当痛苦。我个人使用此扩展方法来获取响应。

```
public static class HttpWebResponseExt
{
    public static HttpWebResponse GetResponseNoException(this HttpWebRequest req)
    {
        try
        {
            return (HttpWebResponse)req.GetResponse();
        }
        catch (WebException we)
        {
            var resp = we.Response as HttpWebResponse;
            if (resp == null)
                throw;
            return resp;
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T00:57:22.970

为什么不？它们都是有效的设计选项，而 HttpWebRequest 就是为了这种方式工作而设计的。

# jquery - 在主干上添加请求标头

> ID：10081728
> 
> 赞同：53
> 
> 时间：2012-04-10T00:54:02.713
> 
> 标签：jquery, backbone.js

我的服务器有手动授权。我需要将我的服务器的用户名/密码放到我的主干请求中才能通过。我该怎么做？有任何想法吗？谢谢

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2012-04-10T03:17:16.863

`fetch`Backbone 中的模型使用方法、`save`和来检索、更新和销毁数据`destroy`。这些方法将实际请求部分委托给 Backbone.sync。在后台，`Backbone.sync`所做的只是使用 jQuery 创建一个 ajax 请求。为了合并您的基本 HTTP 身份验证，您有几个选项。

`fetch`, `save`, 并且`destroy`都接受一个附加参数`[options]`。这些`[options]`只是一个包含在 jQuery ajax 调用中的 jQuery 请求选项字典。这意味着您可以轻松定义一个附加身份验证的简单方法：

```
sendAuthentication = function (xhr) {
  var user = "myusername";// your actual username
  var pass = "mypassword";// your actual password
  var token = user.concat(":", pass);
  xhr.setRequestHeader('Authorization', ("Basic ".concat(btoa(token))));
} 
```

并将其包含在每个`fetch`, `save`, 和`destroy`您拨打的电话中。像这样：

```
 fetch({
  beforeSend: sendAuthentication 
 }); 
```

这会造成相当多的重复。另一种选择可能是覆盖该`Backbone.sync`方法，复制原始代码并将该`beforeSend`选项包含在每个 jQuery ajax 请求中。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：43
> 
> 时间：2012-08-07T12:35:10.373

在 Backbone.js 中添加请求标头的最简单方法是将它们作为参数传递给 fetch 方法，例如

```
MyCollection.fetch( { headers: {'Authorization' :'Basic USERNAME:PASSWORD'} } ); 
```

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2013-12-17T11:49:37.583

一种选择可能是使用 jQuery ajaxSetup，所有 Backbone 请求最终都将使用底层的 jQuery ajax。这种方法的好处是您只需将其添加到一个位置。

```
$.ajaxSetup({
    headers: { 'Authorization' :'Basic USERNAME:PASSWORD' }
}); 
```

*编辑 2018 年 1 月 2 日* 对于复杂的 Web 应用程序，这可能不是最好的方法，请参阅下面的评论。在这里留下答案以供参考。

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2013-11-29T08:18:44.043

您可以覆盖主干同步方法。

```
#coffeescript
_sync = Backbone.sync
Backbone.sync = (method, model, options) ->
    options.beforeSend = (xhr) ->
        xhr.setRequestHeader('X-Auth-Token_or_other_header' , your_hash_key)
        #make sure your server accepts X-Auth-Token_or_other_header!!
    #calling the original sync function so we only overriding what we need
    _sync.call( this, method, model, options ) 
```

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2015-06-04T22:14:51.443

```
Backbone.$.ajaxSetup({
    headers: {'Authorization' :'Basic USERNAME:PASSWORD'}
}); 
```

此代码将标头设置为 Backbone ajax，因此它们将与每个 Backbone.sync 一起发送。您将能够在不使用`xhr.setRequestHeader`每个同步调用的情况下发送标头。

因此，您无需每次都执行以下操作：

```
MyCollection.fetch({ headers: {'Authorization' :'Basic USERNAME:PASSWORD'} } ); 
```

你可以做

```
MyCollection.fetch(); 
```

也许这是一种 hack，但它非常适合我的系统。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2015-08-11T20:54:03.843

我对此类事情的处理方法是覆盖同步方法，以便在执行请求之前添加标头。在示例中，您可以看到我正在创建一个`Backbone.AuthenticatedModel`，它从`Backbone.Model`.

这将影响所有方法（GET、POST、DELETE 等）

```
Backbone.AuthenticatedModel = Backbone.Model.extend({
    sync: function(method, collection, options){
        options = options || {};
        options.beforeSend = function (xhr) {
            var user = "myusername";// your actual username
            var pass = "mypassword";// your actual password
            var token = user.concat(":", pass);
            xhr.setRequestHeader('Authorization', ("Basic ".concat(btoa(token))));
        };
        return Backbone.Model.prototype.sync.apply(this, arguments);
    }

}); 
```

`Backbone.AuthenticatedModel`然后，您必须从您创建的模型中简单地扩展您需要进行身份验证的模型：

```
var Process = Backbone.AuthenticatedModel.extend({
    url: '/api/process',

}); 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2012-08-23T15:59:26.677

```
Object.save(
  {'used': true}
  {headers: {'Access-Token': 'access_token'}}
) 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2017-02-13T21:29:04.750

创建一个自定义同步方法，该方法拦截对 Backbone.sync 的调用并将您的授权标头塞入其中并传递其他所有内容：

```
 REPORTING_API_KEY = 'secretKeyHere';
    CustomSync = function(method, model, options) {
        options.headers = {
            'Authorization' : 'Bearer ' + REPORTING_API_KEY
        };
        return Backbone.sync(method, model, options);
    }; 
```

然后用那个覆盖你的模型的同步：

```
 MyModel = Backbone.Model.extend({
        urlRoot: '/api/',
        sync: CustomSync
    }); 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2019-03-21T13:58:58.853

尝试使用它。我们可以使用

```
beforeSend: function(xhr) {
    xhr.setRequestHeader('X-CSRFToken', csrf_token);
}, 
```

或者

```
headers: {
    "X-CSRFToken": csrf_token
}, 
```

但我会推荐第一个选项（**beforeSend**）。

这是我的工作代码片段。

```
var csrf_token = this.getCSRFToken();
self.collection.fetch(
{
    beforeSend: function(xhr) {
        xhr.setRequestHeader('X-CSRFToken', csrf_token);
    },
    // headers: {
    //     "X-CSRFToken": csrf_token
    // },
    data: {
        "mark_as": "read"
    },
    type: 'POST',
    success: function () {
        if (clickLink) {
            window.location.href = clickLink;
        } else {
            self.unreadNotificationsClicked(e);
            // fetch the latest notification count
            self.counter_icon_view.refresh();
        }
    },
    error: function(){
        alert('erorr');
    }
}); 
```

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2017-01-29T22:20:29.227

1.  在客户端，在任何服务器通信之前添加：

    ```
    $.ajaxSetup({
        xhrFields: {
            withCredentials: true
        },
        async: true
    }); 
    ```

2.  在服务器端添加这些标头（PHP）：

    ```
    header('Access-Control-Allow-Origin: http://your-client-app-domain');
    header("Access-Control-Allow-Methods: PUT, GET, POST, DELETE, OPTIONS");
    header("Access-Control-Allow-Headers: Content-Type, Authorization, X-Requested-With");
    header('Access-Control-Allow-Credentials: true'); 
    ```

# html - 仅当行数 >1 时，div 上的图像换行才有效

> ID：10081732
> 
> 赞同：0
> 
> 时间：2012-04-10T00:54:30.067
> 
> 标签：html, css

这是我知道的一个奇怪的问题，但我有时间解决它。我有一个带有`float: left;`属性的图像，但是这种样式只有在 div 有不止一行的情况下才有效。当 div 有 1 行时，它与图像重叠。可能是什么问题？

```
<div style="
    overflow: hidden;
    width: 600px;
    border: 1px solid black;
    padding: 5px;
    font-family: Helvetica Neue,Helvetica,Arial,sans-serif;
    font-size: 14px;
">
    <img src="images/monkey.jpg" style="
        margin-right: 7px;
        border: 1px solid #C0C0C0;
        padding: 5px;
        float: left;
        height: 62px;
        width: 80px;
    ">
    <div style="
        margin-top: -15px;
        margin-bottom: -15px;
        word-wrap: break-word;
    ">
        <p>
            What's your plan about short posts and such?
        </p>
    </div>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T01:20:42.167

以下是适用于 Firefox 11 和 Chrome 18 的内容：

```
<div style="overflow:hidden;width:600px;border:1px solid black;padding:5px;font-family:Helvetica Neue,Helvetica,Arial,sans-serif;font-size:14px;">
    <img src="images/monkey.jpg" style="float:left;margin-right:7px;border:1px solid #C0C0C0;padding:5px;height:62px;width:80px;">
    <div style="float:left;margin-bottom:-15px;word-wrap:break-word;">
        <p>What's your plan about short posts and such?</p>
    </div>
</div> 
```

这是在其他浏览器中使用的[小提琴。](http://jsfiddle.net/Buq2T/1/)

# vb.net - 多态地使用具有不同返回类型的子类

> ID：10081733
> 
> 赞同：1
> 
> 时间：2012-04-10T00:54:33.390
> 
> 标签：vb.net, polymorphism

我有两个从基类 BaseParser 继承的 Parser 类。我想将任一类用作另一个 Monitor 类中的参数。Parser 类 CS600 和 TCH600 都有两个属性 RawDataList 和 SummaryDataList。CS600 类的 RawDataList 返回一个 List(of CS600Data)；TCH600 RawDataList 返回一个列表（TCH600Data）。SummaryDataList 在每个 Parser 类中返回相似的类。CS600Data 和 TCH600Data 派生自基类 BaseData。BaseParser 也有 RawDataList (List(of BaseData)) 和 SummaryDataList (List(of BaseSummaryData))

Monitor 类有一个私有字段 _thisParser，它可以是上述两个具体解析器中的任何一个。我希望能够在 Monitor 类中调用和使用 _thisParser 的 RawDataList 和 SummaryDataList，但是当我构造具体的 Parser 类时，Visual Studio 注意到 CS600 的 RawDataList 属性不能覆盖 BaseParser 的 RawDataList 属性，因为它们的返回值不同类型。

我认为自从 CS600Data 派生自 BaseData（但也添加了它自己的一些新属性）以来，我可以在使用 BaseData 的任何地方使用 CS600Data。我有什么误解？如何正确构建这些类？

```
Public MustInherit Class BaseParser

    Protected _rawDataList As List(Of RawGasData.BaseData)
    Public MustOverride ReadOnly Property RawDataList() As List(Of RawGasData.BaseData)

    Protected _summaryDataList As List(Of SummaryGasData.BaseSummaryData)
    Public MustOverride ReadOnly Property SummaryDataList() As List(Of SummaryGasData.BaseSummaryData)

    Public Event GasDataCreated(ByVal sender As Object, ByVal e As EventArgs)

    Public Sub New()
    End Sub

    Public Sub New(ByVal dataFilePath As String, ByVal unit As String)
        Load(dataFilePath, unit)
    End Sub

    Public Sub Load(ByVal dataFilePath As String, ByVal unit As String)
        Dim contents = My.Computer.FileSystem.ReadAllText(dataFilePath)
        ParseRawData(contents)
        GenerateSummaryData(contents, unit)
        RaiseEvent GasDataCreated(Me, EventArgs.Empty)
    End Sub

    Protected MustOverride Sub ParseRawData(ByVal fileContents As String)

    Protected MustOverride Sub GenerateSummaryData(ByVal fileContents As String, ByVal unit As String)

End Class

Public Class CS600Parser
    Inherits BaseParser

    Shadows _rawDataList As List(Of RawGasData.CS600Data)
    'Cannot override base class' RawDataList - differ by their return types
    Public Overrides ReadOnly Property RawDataList() As List(Of RawGasData.CS600Data)
        Get
            Return _rawDataList
        End Get
    End Property

    Shadows _summaryDataList As List(Of SummaryGasData.CS600SummaryData)
    'Cannot override base class' SummaryDataList - differ by their return types
    Public Overrides ReadOnly Property SummaryDataList() As List(Of SummaryGasData.CS600SummaryData)
        Get
            Return _summaryDataList
        End Get
    End Property

    Protected Overrides Sub ParseRawData(ByVal fileContents As String)
        Dim data = From d In fileContents.Trim.Split(CChar(vbCrLf)) _
                   Let fields = d.Split(","c).Select(Function(s) s.Trim) _
                   Select New RawGasData.CS600Data With { _
                        .SampleNumber = fields(0), _
                        .UserID = fields(1), _
                        .CarbonValue = CDbl(fields(2)), _
                        .SulfurValue = CDbl(fields(3))}

        _rawDataList = data.ToList

    End Sub

    Protected Overrides Sub GenerateSummaryData(ByVal fileContents As String, ByVal unit As String)
        Dim groupedData = From d In _rawDataList _
                          Group By d.SampleNumber Into Group _
                          Select New SummaryGasData.CS600SummaryData With { _
                            .DataTimeStamp = Now, _
                            .SampleNumber = SampleNumber, _
                            .UserID = Group.First.UserID, _
                            .CarbonAverage = Group.Select(Function(s) s.CarbonValue).Average, _
                            .CarbonUnit = unit, _
                            .SulfurAverage = Group.Select(Function(s) s.SulfurValue).Average, _
                            .SulfurUnit = unit}

        _summaryDataList = groupedData.ToList

    End Sub

End Class

Public Class TCHParser
    Inherits BaseParser

    Shadows _rawDataList As List(Of RawGasData.TCH600Data)
    'Cannot override base class' RawDataList - differ by their return types
    Public Overrides ReadOnly Property RawDataList() As List(Of RawGasData.TCH600Data)
        Get
            Return _rawDataList
        End Get
    End Property

    Shadows _summaryDataList As List(Of SummaryGasData.TCH600SummaryData)
    'Cannot override base class' SummaryDataList - differ by their return types
    Public Overrides ReadOnly Property SummaryDataList() As List(Of SummaryGasData.TCH600SummaryData)
        Get
            Return _summaryDataList
        End Get
    End Property

    Protected Overrides Sub ParseRawData(ByVal fileContents As String)
        Dim data = From d In fileContents.Trim.Split(CChar(vbCrLf)) _
       Let fields = d.Split(","c).Select(Function(s) s.Trim) _
       Select New RawGasData.TCH600Data With { _
            .SampleNumber = fields(0), _
            .UserID = fields(1), _
            .OxygenValue = CDbl(fields(2)), _
            .NitrogenValue = CDbl(fields(3)), _
            .HydrogenValue = CDbl(fields(4)), _
            .MassUsed = CDbl(fields(5))}

        _rawDataList = data.ToList

    End Sub

    Protected Overrides Sub GenerateSummaryData(ByVal fileContents As String, ByVal unit As String)
        Dim groupedData = From d In _rawDataList _
                          Group By d.SampleNumber Into Group _
                          Select New SummaryGasData.TCH600SummaryData With { _
                            .DataTimeStamp = Now, _
                            .SampleNumber = SampleNumber, _
                            .UserID = Group.First.UserID, _
                            .OxygenAverage = Group.Select(Function(s) s.OxygenValue).Average, _
                            .OxygenUnit = unit, _
                            .NitrogenAverage = Group.Select(Function(s) s.NitrogenValue).Average, _
                            .NitrogenUnit = unit, _
                            .HydrogenAverage = Group.Select(Function(s) s.HydrogenValue).Average, _
                            .HydrogenUnit = unit}

        _summaryDataList = groupedData.ToList
    End Sub

End Class

 Public MustInherit Class BaseData
    Implements IGasData

    Private _massUsed As Double
    Public Property MassUsed() As Double Implements IGasData.MassUsed
        Get
            Return _massUsed
        End Get
        Set(ByVal value As Double)
            _massUsed = value
        End Set
    End Property

    Private _sampleNumber As String
    Public Property SampleNumber() As String Implements IGasData.SampleNumber
        Get
            Return _sampleNumber
        End Get
        Set(ByVal value As String)
            _sampleNumber = value
        End Set
    End Property

    Private _userID As String
    Public Property UserID() As String Implements IGasData.UserID
        Get
            Return _userID
        End Get
        Set(ByVal value As String)
            _userID = value
        End Set
    End Property
End Class

Public Class CS600Data
    Inherits BaseData

    Private _carbonValue As Double
    Public Property CarbonValue() As Double
        Get
            Return _carbonValue
        End Get
        Set(ByVal value As Double)
            _carbonValue = value
        End Set
    End Property

    Private _sulfurValue As Double
    Public Property SulfurValue() As Double
        Get
            Return _sulfurValue
        End Get
        Set(ByVal value As Double)
            _sulfurValue = value
        End Set
    End Property

End Class

Public Class TCH600Data
    Inherits BaseData

    Private _oxygenValue As Double
    Public Property OxygenValue() As Double
        Get
            Return _oxygenValue
        End Get
        Set(ByVal value As Double)
            _oxygenValue = value
        End Set
    End Property

    Private _nitrogenValue As Double
    Public Property NitrogenValue() As Double
        Get
            Return _nitrogenValue
        End Get
        Set(ByVal value As Double)
            _nitrogenValue = value
        End Set
    End Property

    Private _hydrogenValue As Double
    Public Property HydrogenValue() As Double
        Get
            Return _hydrogenValue
        End Get
        Set(ByVal value As Double)
            _hydrogenValue = value
        End Set
    End Property

End Class 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T02:10:05.317

您重写的列表属性，例如`RawDataList`，应该是抽象基类的类型（或者更好`IGasData`），而不是多态工作的派生类。如果您发现列出类型列表`BaseData`或`IGasData`导致问题，您可能需要检查您的设计是否符合[Liskov 替换原则](http://www.objectmentor.com/resources/articles/lsp.pdf)。

编译和运行良好的简化插图（VB.Net 2010）：

```
Sub Main    
    Dim parser As BaseParser = New TCHParser()
    Console.WriteLine(parser)   
End Sub

Public MustInherit Class BaseData    
    Public Property SampleNumber() As String
End Class

Public Class TCH600Data 
    Inherits BaseData

    Public Property OxygenValue() As Double
End Class

Public MustInherit Class BaseParser
    Public MustOverride ReadOnly Property RawDataList As List(of BaseData)
End Class 
```

`TCHParser`可以很好地覆盖该`RawDataList`属性。另外，我不确定为什么抽象基类有一个`Protected _rawDataList`字段。删除它，您不再需要担心在派生类型中隐藏该字段。

```
Public Class TCHParser 
    Inherits BaseParser

    ' Populate the list just so we can test easily.
    Public Sub New()
        Dim data As New List(Of BaseData)
        data.Add(New TCH600Data With {
            .SampleNumber = "1", _
            .OxygenValue = 1.5d })

        data.Add(New TCH600Data With {
            .SampleNumber = "2", _
            .OxygenValue = 2.5d })

        _rawDataList = data
    End Sub

    Private _rawDataList As List(of BaseData)  
    Public Overrides ReadOnly Property RawDataList As List(of BaseData)
        Get
            Return _rawDataList
        End Get
    End Property
End Class 
```

# java - 如何调用 Type 的 nullSafeSet（从哪里获取类型实例）

> ID：10081734
> 
> 赞同：0
> 
> 时间：2012-04-10T00:54:35.687
> 
> 标签：java, hibernate

我在 4.1.0.Final 中实现了一个 UserType 并且需要调用 BlobType.nullSafeSet 和 Get 方法。之前，调用 Hibernate.BLOB 来访问这些方法，现在从哪里获得 Types 的实例？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T01:18:58.020

答案是 BlobType 的 INSTANCE 静态属性包含 BlobType 的一个实例。

# .net - iTextSharp：重新生成 PDF 文件预告片

> ID：10081735
> 
> 赞同：2
> 
> 时间：2012-04-10T00:54:39.863
> 
> 标签：.net, pdf-generation, itextsharp

在 XX 场景中，我们优化并在一些源 pdf 文件中添加文本框和内容，然后将其保存以供我们的客户能够从我们的 asp.net 网站自动填写。

最近我在写作方面遇到了一个问题，如下所示，

尝试使用 itextsharp 打开和写入 pdf 文件时出现“未找到预告片”io 异常。经过进一步调查，我意识到 PDF 源文件本身在结尾附近没有任何预告片。

我的问题是，有没有办法重新生成拖车？还是一个免费的工具来修复重新创建预告片的 pdf？我尝试了一些在线工具，但没有帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-13T02:26:33.303

使用 pdftk 修复它。与 ghostscript 不同，它保留了表单字段并很好地重建了预告片。

pdftk.exe coorruptedfile.pdf 输出fixedfile.pdf

像魅力一样工作

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T11:46:50.037

如果您的文件可以通过 Acrobat Reader 或 Professional 打开，那么您可以使用这些工具来更正您的文件。

Adobe 工具重建损坏的文件并提供重新保存它们。

此外，一些 PDF 库也可以做到这一点。

# javascript - 将图像设置为 100% 宽度或高度，以先到者为准

> ID：10081736
> 
> 赞同：0
> 
> 时间：2012-04-10T00:54:53.257
> 
> 标签：javascript, css, image

我在 div 中有一个图像，我希望图像缩小到包含 div 的 100% 宽度或 100% 高度。正如[这里](https://stackoverflow.com/questions/3029422/image-auto-resize-to-fit-div-container)所建议的，我尝试将 max-height 和 max-width 都设置为 100%。这仍然会导致一些溢出（我不想用溢出裁剪图像：隐藏）。图像在 div 内浮动。

有可能做到这一点吗？我的代码如下。难道我做错了什么？

```
div#_content div#_thumbnails div {
  padding:2px;
  display:inline-block;
  min-width:10%;
  max-width:25%;
  min-height:80px;
  max-height:125px;
  text-align:center;
}
div#_content div#_thumbnails img {
  display:inline;
  padding:2px;
  float:left;
  max-height:100%;
  max-width:100%;
} 
```

在下面的 javascript 中，imgs 是 URL 的列表。thumbnails 是容器所在的母 div。

```
for (i in imgs) {
  if (imgs[i]) {
    var new_img = document.createElement('IMG'),
      container = document.createElement('DIV')
    new_img.setAttribute('alt', "image"+i.toString())
    new_img.setAttribute('src', imgs[i])
    container.appendChild(new_img)
    thumbnails.appendChild(container)
  }
} 
```

我希望这不是一个愚蠢的问题，但我已经搜索过，但我发现的任何建议都没有奏效。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T01:15:52.863

请试试：

```
<style type="text/css">
#thumbContainer {
    position:relative;
}
.thumb{
    position:relative;
    float:left;
    width: 100%;
    height: auto;
}
.thumb img {
    background-size: cover !important;
    width: 100%;
    height: auto;
}
</style>

<div id="thumbContainer">
    <div class="thumb"><img src="http://3.bp.blogspot.com/_ABFjy8u6h9s/TStw8-_4j1I/AAAAAAAACE0/cKm4ZiIFilk/s1600/NATUREZA+01.jpg" /></div>
    <div class="thumb"><img src="http://3.bp.blogspot.com/_ABFjy8u6h9s/TStw8-_4j1I/AAAAAAAACE0/cKm4ZiIFilk/s1600/NATUREZA+01.jpg" /></div>
    <div class="thumb"><img src="http://3.bp.blogspot.com/_ABFjy8u6h9s/TStw8-_4j1I/AAAAAAAACE0/cKm4ZiIFilk/s1600/NATUREZA+01.jpg" /></div>
</div> 
```

(http://jsfiddle.net/ahjjg/)

另外，我建议背景设置为`<img>`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T00:57:05.707

如果您使用的是 PHP，那么这是最适合您的解决方案

[http://www.welancers.com/perfect-solution-for-image-resizing-based-on-width-height/](http://www.welancers.com/perfect-solution-for-image-resizing-based-on-width-height/)

# python - 如何将'［'转换为'['使用python

> ID：10081738
> 
> 赞同：0
> 
> 时间：2012-04-10T00:55:24.763
> 
> 标签：python

我用这个：

```
 title=title.replace(u'【',u'[').replace(u'】',u'[') 
```

但错误：

```
UnicodeDecodeError: 'ascii' codec can't decode byte 0xe3 in position 0: ordinal not in range(128) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-10T00:58:36.560

那是因为`title`一开始就不是`unicode`。[使用前先解码。](http://farmdev.com/talks/unicode/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T01:01:17.550

您需要`title`成为 unicode 对象，而不是 str 对象

例如。

```
title = title.decode("utf-8")  # or whatever encoding title is using 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-10T04:05:57.817

*Ignacio 发布的链接很棒，请仔细阅读。*

大的“[”在 CJK 字符集中，这里的人可能没有安装正确的字体来渲染它。所以我用粗体**[**来表示它。

如果您不关心直接在 Python 中使用编码字符串，但这是非常不推荐的，只需 ".replace(' **[** ', '[')" 使用字符串而不是 unicode。

如果你想，实际上你应该使用 unicode 在 Python 中操作文本，你需要确保你使用的所有文本都是 unicode by `.decode(string_encoding)`. 此外，将您的全局默认编码设置为 'utf-8' in [`sitecustomize.py`](http://www.faqs.org/docs/diveintopython/kgp_unicode.html#d0e18775)，这将使系统`.decode('utf-8')`自动为您执行。

# jquery - 如何查询数据库以获取最后选择的单选按钮？

> ID：10081740
> 
> 赞同：0
> 
> 时间：2012-04-10T00:55:51.237
> 
> 标签：jquery, database, radio-button, selected

我需要知道如何在数据库中查询用户选择的最后一个单选按钮，这样当他们刷新页面或登录不同的会话时，他们会看到他们的选择。我将 jquery.min.js (1.7.1) 用于显示/隐藏功能。

**这是HTML：**

```
 <div class="wrap">
    <div class="box">
      <div align=center id="catNav">
<label> &nbsp; <input type="radio" name="group_name" id="list-one-button" value="01" checked="checked" /></label>
<label> &nbsp; <input type="radio" name="group_name" id="list-two-button" value="02" /></label>
<label> &nbsp; <input type="radio" name="group_name" id="list-three-button" value="03" /></label>
<label> &nbsp; <input type="radio" name="group_name" id="list-four-button" value="04" /></label>
<label> &nbsp; <input type="radio" name="group_name" id="list-five-button" value="05" /></label>
<label> &nbsp; <input type="radio" name="group_name" id="list-six-button" value="06" /></label>
<label> &nbsp; <input type="radio" name="group_name" id="list-seven-button" value="07" /></label>
      </div>

      <ul class="cat-list" id="list-one">
<li><a href="#"><img src="img1.jpg"></a></li>
      </ul>

      <ul class="cat-list" id="list-two">
<li><a href="#"><img src="img2.jpg"></a></li>
      </ul>

      <ul class="cat-list" id="list-three">
<li><a href="#"><img src="img3.jpg"></a></li>
      </ul>

      <ul class="cat-list" id="list-four">
<li><a href="#"><img src="img4.jpg"></a></li>
      </ul>

      <ul class="cat-list" id="list-five">
<li><a href="#"><img src="img5.jpg"></a></li>
      </ul>

      <ul class="cat-list" id="list-six">
<li><a href="#"><img src="img6.jpg"></a></li>
      </ul>

      <ul class="cat-list" id="list-seven">
<li><a href="#"><img src="img3.jpg"></a></li>
      </ul>         
    </div>
</div> 
```

**这是Javascript：**

```
$(function(){
$("#list-two").hide();  
$("#list-three").hide();    
$("#list-four").hide();
$("#list-five").hide();
$("#list-six").hide();
$("#list-seven").hide();

$("#list-one-button").click(function(){
    $(".cat-list").slideUp(600);
    $("#list-one").slideDown(600);
});

$("#list-two-button").click(function(){
    $(".cat-list").slideUp(600);
    $("#list-two").slideDown(600);
}); 

$("#list-three-button").click(function(){
    $(".cat-list").slideUp(600);
    $("#list-three").slideDown(600);
}); 

$("#list-four-button").click(function(){
    $(".cat-list").slideUp(600);
    $("#list-four").slideDown(600);
});

$("#list-five-button").click(function(){
    $(".cat-list").slideUp(600);
    $("#list-five").slideDown(600);
});

$("#list-six-button").click(function(){
    $(".cat-list").slideUp(600);
    $("#list-six").slideDown(600);
});

$("#list-seven-button").click(function(){
    $(".cat-list").slideUp(600);
    $("#list-seven").slideDown(600);
});

$("#catNav li a").click(function() {
    $("#catNav li").removeClass("activeCatButton");
    $(this).parent().addClass("activeCatButton");
});
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T10:11:36.357

您可以通过使用 AJAX 调用来达到预期的效果。

这是jQuery部分：

```
$('ul.cat-list').click(function() {
  var id = this.prop('id');
  $.ajax({
    type: "POST",
    url: "saveSelection.php",
    data: "id=" + id,
  }).done(function( msg ) {
    // this is just for debugging purposes
    // console.log("Data Saved: " + msg);
  });
}); 
```

在 PHP 中，您可以保存该值。这可能是文件`saveSelection.php`：

```
<?php
  // save in session
  $_SESSION['selection'] = $_POST['id'];
  // or save in database, for example by storing the user's ip address or login id
  ...
?> 
```

然后，如果用户再次请求该页面，请检查是否有预先保存的值，并将单选按钮呈现为选中状态。

顺便说一句，您错误地使用了列表。正确的是一个`ul`标签带有多个`li`标签：

```
<ul class="cat-list" id="list">
    <li id="item-one"><a href="#"><img src="img1.jpg"></a></li>
    <li id="item-two"><a href="#"><img src="img2.jpg"></a></li>
    ...
</ul> 
```

# javascript - 根据用户输入加载不同的表单

> ID：10081745
> 
> 赞同：1
> 
> 时间：2012-04-10T00:56:12.387
> 
> 标签：javascript, html, xhtml

我正在创建一个具有不同表单的网站页面，这取决于用户输入加载不同的表单。

加载页面时，会询问用户是否要注册客户或卖家。根据该选择，我会将变量设置为 True 或 False 加载相关表单，到目前为止，我设法完成了很多工作，但页面只加载了背景颜色，没有其他内容（当我开始介绍 JavaScript 时开始发生这种情况）

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"> 
```

```
 <title>Customer/Reseller</title>

    <link rel="stylesheet" type="text/css" href="styles.css" />

    <!--[if IE]>

    <style type="text/css">
    .clear {
      zoom: 1;
      display: block;
    }
    </style>
    <![endif]-->

</head>

<body>

    <div class="section" id="page"> <!-- Defining the #page section with the section tag -->

        <div class="header"> <!-- Defining the header section of the page with the appropriate tag -->

            <h2>G51 Villain Supply</h2>
            <h3>Delivering Technology  </h3>

            <div class="nav clear"> <!-- The nav link semantically marks your main site navigation -->
                <ul>
                    <li><a href="index.html"> Home </a></li>
                    <li><a href="about.html"> About </a></li>
                    <li><a href="products.html"> Products </a></li>
                    <li><a href="app.html"> Customer/Reseller </a></li>
                     <li><a href="private.html"> Private </a></li>
                </ul>
            </div>

        </div>

        <div class="section" id="articles"> <!-- A new section with the articles -->

            <!--start -->
            <div class="line"></div>  <!-- Dividing line -->
            <div class="article" > <!-- The new article tag. The id is supplied so it can be scrolled into view. -->
                <h2>Seller Section</h2>
                <div class="line"></div>
                <div class="articleBody clear">

        <form action="" method="seller">
            <fieldset>
                <legend>Seller Registration Form</legend>
                <br>Please complete </br>
                <br><label for="Fname">First Name:</label></br> <input type="text" name="name" id="name"/>
                <br><label for="Lname">Last Name:</label></br> <input type="text" name="name" id="name"/>
                <br><label for="Contact">Contact Number:</label></br> <input type="text" name="name" id="name"/>
                <br><label for="email">Email:</label></br> <input type="text" name="email" id="email" /> 
                <p></p><p></p>
                <p><label for="agree">&#160;</label> <input type="checkbox" name="agree" id="agree" /> The information I have provided above is accurate.</p>
                <p><label for="btnsubmit">&#160;</label><input type="submit" value="Register" name="btnsubmit" id="btnsubmit" /></p>
                <p></p>
            </fieldset>
        </form>                 
                </div>
            </div>

            <!-- end -->
        </div>

         <div class="section" id="articles"> <!-- A new section with the articles -->
            <!--start -->
            <div class="line"></div>  <!-- Dividing line -->

            <div class="article" > <!-- The new article tag. The id is supplied so it can be scrolled into view. -->
                <h2>Customers Section</h2>

                <div class="line"></div>
                <div class="articleBody clear">
        <form action="" method="cust">
            <fieldset>
                <legend>Customer Registration Form</legend>
                    <br>Please complete </br>
                    <br><label for="Fname">First Name:</label></br> <input type="text" name="name" id="name"/>
                    <br><label for="Lname">Last Name:</label></br> <input type="text" name="name" id="name"/>
                    <br><label for="FAdd">First Line Address:</label></br> <input type="text" name="1stAdd" id="name"/>
                    <br><label for="PstAdd">Postcode:</label></br> <input type="text" name="PstAdd" id="name"/>
                    <br><label for="Contact">Contact Number:</label></br> <input type="text" name="name" id="name"/>
                    <br><label for="email">Email:</label></br> <input type="text" name="email" id="email" /> 
                    <p></p><p></p>
                    <p><label for="agree">&#160;</label> <input type="checkbox" name="agree" id="agree" /> The information I have provided above is accurate.</p>
                    <p><label for="btnsubmit">&#160;</label><input type="submit" value="Register" name="btnsubmit" id="btnsubmit" /></p>
                    <p></p>
                </fieldset>
        </form>                 
                </div>
            </div>
            <!-- end -->
        </div>

  <div class="footer"> <!-- Marking the footer section -->
      <div class="line"></div>
       <p>Copyright 2012 - G51 Villain Supply </p> <!-- Change the copyright notice -->
       <a href="#" class="up">Go UP</a>
    </div>

</div> <!-- Closing the #page section -->

</body> 
```

JavaScript 的某些块未完成，因为我不知道如何。请帮忙，谢谢。

编辑：我用没有 JavaScript 的干净工作代码替换了上面的代码。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T01:30:13.093

这是错误的做法。您不应该尝试在脚本块内声明整个页面！！！。而是使用以下伪代码：

```
<html>
  <head>
     <!-- Head content goes here -->
     <script type="text/javascript">

     </script>
  </head>
  <body>
    <!-- body content -->
     <div id="chooser" class="chooserclass">
       <input type="checkbox" id="buyer" onclick="chooseBuyer()">Buyer</input>
       <input type="checkbox" id="seller" onclick="chooseSeller()">Seller</input>         
     </div>
     <div id="form1" class="form1css"> </div>
     <div id="form2" class="form2css"> </div>

  </body>
</html> 
```

现在在您的脚本中，您必须执行以下算法：

1.  两者`form1css`和`form2css`最初都应设置为“display:none”，如下所示： `document.getElementById("form1").style.display="none"`
    **构建一个这样做的 chooseBuyer() 函数：**

2.  正如您在 html 中看到的那样，我使用了两个复选框。当用户选择买方复选框时，
    （a）设置`document.getElementById("form1").style.display="block"`
    （b）将另一个复选框设置为未选中。
    `document.getElementById("seller").checked="false"`

类似地使用逆逻辑实现chooseSeller() 函数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T01:30:43.873

**试试这个，它正在工作（整理并修复）：**

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>
            Customer/Reseller
        </title>
        <link rel="stylesheet" type="text/css" href="styles.css" /><!--[if IE]>

    <style type="text/css">
    .clear {
      zoom: 1;
      display: block;
    }
    </style>
    <![endif]-->
    </head>
    <body>
        <div class="section" id="page">
            <!-- Defining the #page section with the section tag -->
            <div class="header">
                <!-- Defining the header section of the page with the appropriate tag -->
                <h2>
                    G51 Villain Supply
                </h2>
                <h3>
                    Delivering Technology
                </h3>
                <div class="nav clear">
                    <!-- The nav link semantically marks your main site navigation -->
                    <ul>
                        <li>
                            <a href="index.html">Home</a>
                        </li>
                        <li>
                            <a href="about.html">About</a>
                        </li>
                        <li>
                            <a href="products.html">Products</a>
                        </li>
                        <li>
                            <a href="app.html">Customer/Reseller</a>
                        </li>
                        <li>
                            <a href="private.html">Private</a>
                        </li>
                    </ul>
                </div>
            </div><input type="button" value="I'm a customer" onclick="document.getElementById('customerz').style.visibility='visible';document.getElementById('sellerz').style.display='none';" />
            <input type="button" value="I'm a seller" onclick="document.getElementById('sellerz').style.visibility='visible';document.getElementById('customerz').style.visibility='none';">
            <div id="sellerz" style='visibility:hidden;'>
                <div class="section" id="articles">
                    <!-- A new section with the articles -->
                    <!--start -->
                    <div class="line"></div><!-- Dividing line -->
                    <div class="article">
                        <!-- The new article tag. The id is supplied so it can be scrolled into view. -->
                        <h2>
                            Seller Section
                        </h2>
                        <div class="line"></div>
                        <div class="articleBody clear">
                            <form action="" method="seller">
                                <fieldset>
                                    <legend>Seller Registration Form</legend><br />
                                    Please complete<br />
                                    <br />
                                    <label for="Fname">First Name:</label><br />
                                    <input type="text" name="name" id="name" /><br />
                                    <label for="Lname">Last Name:</label><br />
                                    <input type="text" name="name" id="name" /><br />
                                    <label for="Contact">Contact Number:</label><br />
                                    <input type="text" name="name" id="name" /><br />
                                    <label for="email">Email:</label><br />
                                    <input type="text" name="email" id="email" />
                                    <p>
                                        <label for="agree">&nbsp;</label> <input type="checkbox" name="agree" id="agree" /> The information I have provided above is accurate.
                                    </p>
                                    <p>
                                        <label for="btnsubmit">&nbsp;</label><input type="submit" value="Register" name="btnsubmit" id="btnsubmit" />
                                    </p>
                                </fieldset>
                            </form>
                        </div>
                    </div><!-- end -->
                </div>
            </div>
            <div id="customerz" style='visibility:hidden;'>
                <div class="section" id="articles">
                    <!-- A new section with the articles -->
                    <!--start -->
                    <div class="line"></div><!-- Dividing line -->
                    <div class="article">
                        <!-- The new article tag. The id is supplied so it can be scrolled into view. -->
                        <h2>
                            Customers Section
                        </h2>
                        <div class="line"></div>
                        <div class="articleBody clear">
                            <form action="" method="cust">
                                <fieldset>
                                    <legend>Customer Registration Form</legend><br />
                                    Please complete<br />
                                    <br />
                                    <label for="Fname">First Name:</label><br />
                                    <input type="text" name="name" id="name" /><br />
                                    <label for="Lname">Last Name:</label><br />
                                    <input type="text" name="name" id="name" /><br />
                                    <label for="FAdd">First Line Address:</label><br />
                                    <input type="text" name="1stAdd" id="name" /><br />
                                    <label for="PstAdd">Postcode:</label><br />
                                    <input type="text" name="PstAdd" id="name" /><br />
                                    <label for="Contact">Contact Number:</label><br />
                                    <input type="text" name="name" id="name" /><br />
                                    <label for="email">Email:</label><br />
                                    <input type="text" name="email" id="email" />
                                    <p>
                                        <label for="agree">&nbsp;</label> <input type="checkbox" name="agree" id="agree" /> The information I have provided above is accurate.
                                    </p>
                                    <p>
                                        <label for="btnsubmit">&nbsp;</label><input type="submit" value="Register" name="btnsubmit" id="btnsubmit" />
                                    </p>
                                </fieldset>
                            </form>
                        </div>
                    </div><!-- end -->
                </div>
            </div>
                <div class="footer">
                    <!-- Marking the footer section -->
                    <div class="line"></div>
                    <p>
                        Copyright 2012 - G51 Villain Supply
                    </p><!-- Change the copyright notice -->
                    <a href="#" class="up">Go UP</a>
                </div>
            </div><!-- Closing the #page section -->
        </div>
    </body>
</html> 
```

**JavaScript 做的伎俩：**

```
<input type="button" value="I'm a customer" onclick="document.getElementById('customerz').style.visibility='visible';document.getElementById('sellerz').style.display='none';" />
<input type="button" value="I'm a seller" onclick="document.getElementById('sellerz').style.visibility='visible';document.getElementById('customerz').style.visibility='none';"> 
```

**还有什么...？**

好吧，我只是将每个部分包装在一个单独`div`的部分：客户部分`customerz`和卖家部分`sellerz`

* * *

玩得开心！;-)

# javascript - 正则表达式 - 不跟随 - 链接？

> ID：10081757
> 
> 赞同：0
> 
> 时间：2012-04-10T00:58:51.907
> 
> 标签：javascript, regex

“不跟随”运算符如下：（根据[http://regexpal.com/](http://regexpal.com/)上的快速参考）

```
?!exprssion 
```

我可以像这样将它们链接在一起吗？

```
?!(?!exprssion) 
```

我为什么要问你？

因为我需要拆分（）

```
| 
```

或者

```
| not follwed by |* 
```

但

```
| followed by |** is O.K. 
```

看看这有多复杂？

****失败的尝试****

 **```
.split( /\|\*\*|\|(?!\*)/ ); 
```

这不起作用，因为它会分裂

```
|** 
```

我需要分开

```
| 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-10T01:04:20.960

对此进行拆分：

```
\|(?!\*)|\|\*\* 
```

这表示：要么是一个管道后面跟着一个不是星星的东西（我们不会用它来分割），或者是一个管道后面跟着 2 个星星（使用整个东西来分割）。我不确定你的措辞是否是你要找的。如果您的意思是“在管道上拆分，除非它后面跟着一颗星，但在管道上拆分后跟 2 颗星”然后使用这个：

```
\|(?!\*[^*]) 
```

演示：[http ://codepad.org/Gt0xNQNO](http://codepad.org/Gt0xNQNO)**

# java - 我的模式有什么问题？

> ID：10081761
> 
> 赞同：1
> 
> 时间：2012-04-10T00:59:55.653
> 
> 标签：java, regex, pattern-matching

```
public class FileParser {

private String filename = "mydata.txt";
private Pattern pattern = Pattern.compile("\\D\\D\\d+");
private Scanner reader;

public FileParser() throws FileNotFoundException{
    reader = new Scanner(new File(filename));
}

public boolean hasMoreData(){
    return reader.hasNext(pattern);
}

public String[] getNextData(){

    return pattern.split(reader.next(pattern));
}

public void close(){
    reader.close();
}
} 
```

所以这是我的代码。我试图取出一个由 2 个字母和一个数字组成的模式。为什么我从 getNextData() 函数中什么也得不到/空数组？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T01:05:28.667

在表达式中：

```
 pattern.split(reader.next(pattern)); 
```

`reader.next(pattern)`正在返回该模式的下一次出现，例如“AB123”。

但`pattern.split`随后将围绕模式拆分该字符串，并在其两侧返回文本。自然，两边都*没有文本，因为分隔符“AB123”是整个字符串。*

你想只返回字符串 "AB123" 吗？`reader.next`在这种情况下，您可能只返回结果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T01:58:55.620

`Scanner.hasNext(pattern)`搜索在分隔符之间开始的模式。在您的情况下，分隔符是`|`. 但是 Scanner 的默认分隔符是空格。您必须手动将定界符更改为 a`|`或完全忽略定界符。这是一个使用 的示例`Scanner.findWithinHorizon`，它不关心分隔符：

```
public class FileParserExample {
    private Pattern pattern = Pattern.compile("([a-zA-Z]{2})(\\d+)");
    private Scanner reader;

    public FileParserExample(String filename) throws FileNotFoundException {
        reader = new Scanner(new File(filename));
    }

    public boolean hasMoreData() {
        String textFound = reader.findWithinHorizon(pattern, 0);
        return textFound != null;
    }

    public String[] getNextData() {
        MatchResult match = reader.match();
        String [] pieces = {match.group(1), // AB
                            match.group(2) }; // 123
        return pieces;
    }

    public void close() {
        reader.close();
    }

    public static void main(String[] args) throws FileNotFoundException {
        String filename = "mydata.txt";
        FileParserExample parser = new FileParserExample(filename);

        while (parser.hasMoreData()) {
            System.out.println(Arrays.toString(parser.getNextData()));
        }

        parser.close();

    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-10T01:20:53.863

我认为你的正则表达式有缺陷。我相信你想要

```
private Pattern pattern = Pattern.compile("\\w{2}\\d"); 
```

# javascript - javascript onblur 函数

> ID：10081764
> 
> 赞同：0
> 
> 时间：2012-04-10T01:00:57.897
> 
> 标签：javascript, jquery, html

好的，我有这个代码

```
<div name="search" id="searchbox">
    <div id="kk"><img src="Images/glss.png"/><input value="search item here..."    type="text" id="inputbox" onclick="clickclear(this, 'search item here...')"  onblur="clickrecall(this,'search item here...')"/></div><button id="submit" onclick="rr()"/> <!--onkeydown="checkForm(event);"-->
</div> 
```

我有这个用于 onclick 事件的 javascript 函数。

```
 // searchbox functions ( clear & unclear )
function clickclear(thisfield, defaulttext) {
    if (thisfield.value == defaulttext) {
        thisfield.value = "";
    }
}

function clickrecall(thisfield, defaulttext) {
    if ($q == "0"){

    if (thisfield.value == "") {
        thisfield.value = defaulttext;
    }}
    else
    {

    }
} 
```

onclick 事件没有问题，因为#inputbox 中的文本在单击时会被删除。

问题是 onblur 功能，#inputbox 上的默认文本在 onblur 事件中不召回或不恢复。

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T01:37:58.270

我只是将默认值存储在数据标签中，其余部分如下：http: [//jsfiddle.net/8DFJv/](http://jsfiddle.net/8DFJv/)

# python - python风格结构的BNF语法

> ID：10081767
> 
> 赞同：1
> 
> 时间：2012-04-10T01:01:33.907
> 
> 标签：python, antlr, context-free-grammar, bnf

我正在尝试使用一种简单的语法来解析类似 python 的结构，这就是我可以为列表/集合提出的

```
list : '[' atom ( ',' atom)* ']'
set : '(' atom ( ',' atom)* ']'

atom : 'a'..'z' | 'A'..'Z'
     | '[' list ']'
     | '(' set ')' 
```

请注意，这是在 antlr 中，我想知道它的正确性以及任何可以帮助我的资源

我确实查看了 python 的语法[http://docs.python.org/reference/grammar.html](http://docs.python.org/reference/grammar.html)但不太清楚它正在处理列表列表或列表集或集合列表等。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-10T01:47:24.003

> 不太清楚它正在处理列表列表或列表集或集合列表等。

它不区分列表和集合或其他：

```
atom: ('(' [yield_expr|testlist_comp] ')' |
       '[' [listmaker] ']' |
       '{' [dictorsetmaker] '}' |
       '`' testlist1 '`' |
       NAME | NUMBER | STRING+) 
```

他们处理您所描述的那种递归的方式是`listmaker`，`dictorsetmaker`等最终可能包含`atom`. 例如：

```
listmaker: test ( list_for | (',' test)* [','] )
test: or_test ['if' or_test 'else' test] | lambdef
or_test: and_test ('or' and_test)*
and_test: not_test ('and' not_test)*
not_test: 'not' not_test | comparison
comparison: expr (comp_op expr)*
expr: xor_expr ('|' xor_expr)*
xor_expr: and_expr ('^' and_expr)*
and_expr: shift_expr ('&' shift_expr)*
shift_expr: arith_expr (('<<'|'>>') arith_expr)*
arith_expr: term (('+'|'-') term)*
term: factor (('*'|'/'|'%'|'//') factor)*
factor: ('+'|'-'|'~') factor | power
power: atom trailer* ['**' factor] 
```

中间有很多；那是因为他们需要为一堆数学运算符建立优先级。然后在那里`list_for`，它允许为列表理解添加额外的东西。

一个更简化的示例可能如下所示：

```
atom: ('[' [list_or_set] ']' |
       '{' [list_or_set] '}' |
       NAME | NUMBER | STRING+)

list_or_set: atom (',' atom)* [','] 
```

或者，如果您希望在此级别上区分列表和集合：

```
atom: list | set | NAME | NUMBER | STRING+
list: '[' atom (',' atom)* [','] ']'
set: '{' atom (',' atom)* [','] '}' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T01:13:31.523

这可能更接近您所追求的：

```
list : '[' element ( ',' element )* ']';
set : '(' element ( ',' element )* ')';

element: list | set | atom;

alpha:  'a'..'z' | 'A'..'Z' | '_' ;
alphanum: alpha | '0'..'9';
atom : alpha alphanum*; 
```

注意：以前从未使用过 antlr，这可能不是正确的语法。

# jquery - 将内容放在数据元素的末尾 - 如何使用数据元素进行选择

> ID：10081776
> 
> 赞同：0
> 
> 时间：2012-04-10T01:03:33.260
> 
> 标签：jquery, css

我有以下标记，并希望在触发 ajax 回调时在此之后放置“这是我的信息”。我的标记：

```
<div data-item-header-id="17">
here is an item
</div>
<div data-item-header-id="17">
here is another item
</div>
<!-- put 'here is my info here' here -->
<div data-item-header-id="18">
here is another item
</div> 
```

已调用警报，但未将警报放置在正确的位置。鉴于上述标记，我将如何选择？

```
if(r.is_placed_at_end=='true'){
  alert('will place at end');
  $('data(item-header-id==17):last)').after("here is my info");
} 
```

我试着看看这个，但并没有让我一直到那里。[jquery 数据选择器](https://stackoverflow.com/questions/2891452/jquery-data-selector)

另外，这是对数据元素的正确使用吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T01:19:31.880

您想使用属性选择器。

```
$('div[data-item-header-id="17"]:last').after("here is my info"); 
```

演示：http: [//jsfiddle.net/CcA3D/](http://jsfiddle.net/CcA3D/)

参考：[http ://api.jquery.com/category/selectors/](http://api.jquery.com/category/selectors/)

# c++ - Windows 7 上的 C++ MoveFile 错误（2）

> ID：10081777
> 
> 赞同：-2
> 
> 时间：2012-04-10T01:03:36.530
> 
> 标签：c++, winapi, windows-7

我有一个尝试移动文件的小应用程序。

这是最小代码：

```
#include <windows.h>

int main()
{
    MoveFile("C:\\test.txt", "C:\\folder\\test.txt");
    // Here I use GetLastError() to get last error code witch is 2 and I can't find what mean;

    return 0;
} 
```

重要提示：此错误出现在 Windows 7 上，但在 win XP 上有效，文件被移动！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-10T01:06:48.510

[您可以在 MSDN](http://msdn.microsoft.com/en-us/library/windows/desktop/ms681381%28v=vs.85%29.aspx)或头文件中找到所有错误代码。

2`ERROR_FILE_NOT_FOUND`表示当您在 Windows 7 上尝试此操作时找不到您的源文件。确保其中有正确的相对/绝对路径。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T01:17:17.280

你的例子有一个错字。您的目标文件名缺少反斜杠。在这种情况下，Windows 通常会生成错误 2

# java - Jmeter：了解吞吐量和 KB/sec 之间的相关性

> ID：10081778
> 
> 赞同：3
> 
> 时间：2012-04-10T01:03:52.987
> 
> 标签：java, jmeter, performance-testing, throughput

我有 15 个线程的线程组，每个线程发送一个 32KB 的图像（HTTP POST）。在摘要报告下，我的吞吐量为 550/秒，平均响应时间：25 毫秒，KB/秒显示为 148KB/秒。我发现很难关联这些数字。如果我可以管理 550 个请求/秒并且每个请求是 32KB，那么 KB/秒不应该是 550 * 32 KB/秒吗？

**编辑：** 即使我只发送一个请求，KB/Sec 下的数字也没有意义。我能够关联所有其他数字。1 个请求的摘要报告：

```
Samples: 1
Average: 25
Min: 25
Max: 25
Std.Dev: 0
Error: 0%
Throughput: 40/sec
KB/Sec: 10.62
Avg. Bytes: 272. 
```

从上述结果中关联平均时间和吞吐量非常容易。我正在传输的图像大小为 32281 字节（由 linux OS 报告）。正如aroth在评论中指出的那样，我怀疑这是否与压缩有关。我尝试发送 1MB 图像，报告的 KB/Sec 为 12.3。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T19:44:24.553

1 个请求的示例中的数学对我来说看起来是正确的。

```
Samples: 1
Average: 25
Min: 25
Max: 25
Std.Dev: 0
Error: 0%
Throughput: 40/sec
KB/Sec: 10.62
Avg. Bytes: 272. 
```

根据上面的数据，每秒 40 个请求，平均每秒 272 字节 = (40*272) 10880 字节吞吐量（除以 1024 为 10.625）。

问题肯定是为什么 JMeter 认为平均请求大小为 272 字节，而您认为它是 32k - 您确定要附加图像吗？如果是这样，我会假设正在进行一些相当大的压缩。

# php - php / 样式 / 日期问题

> ID：10081779
> 
> 赞同：0
> 
> 时间：2012-04-10T01:03:53.900
> 
> 标签：php

我们只是在转换我们的博客以匹配我们的网站风格。

POST 的日期（对于博客文章是）

```
<?php echo date($OptionsVis["date_format"],strtotime($Post["publish_date"])); ?> 
```

这给出了：08 JAN

但我想这样表示日期：

```
 <div class="post-list-date">
            <h1>08</h1>
            <h2>JAN</h2>
        </div> 
```

你能想出一种方法来拆分我的 php 以获得我想要的东西。无需在我的整个博客系统中到处乱逛。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T01:07:07.853

只需对输出进行后处理：

```
<?php
    $date = date(... existing code...);
    list($d, $m) = explode(' ', $date);
?>
<div class="post-list-date">
    <h1><?php echo $d; ?></h1>
    <h2><?php echo $m; ?></h2>
</div> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T01:07:21.177

我会建议两个`$OptionsVis`值（`date_format_main`, `date_format_sub`）。然后，执行两个单独`date()`的调用，一个用于 in `<h1>`，另一个用于 in，`<h2>`如下所示：

```
$date_h1 = date($OptionsVis["date_format_main"], strtotime($Post["publish_date"]));
$date_h2 = date($OptionsVis["date_format_sub"], strtotime($Post["publish_date"])); 
```

如果这是不可能的，并且您知道日期格式将始终相同，您可以这样做：

```
$date = date($OptionsVis["date_format"], strtotime($Post["publish_date"]));
list($date_h1, $date_h2) = explode(" ", $date, 2); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-10T01:14:03.580

尽管您的 HTML 的语义有些不寻常（h 标签通常保留给与内容相关的文本标题），但我会尝试以下内容：

```
$date_array = explode(" ", date($OptionsVis["date_format"],strtotime($Post["publish_date"])));

$date_html = "<div class=\"post-list-date\"><h1>".$date_array[0]."</h1><h2>".$date_array[1]."</h2></div>";

echo $date_html; 
```

希望这会有所帮助，快乐的编码。

# c++ - c ++合并排序不会合并？

> ID：10081781
> 
> 赞同：0
> 
> 时间：2012-04-10T01:03:57.857
> 
> 标签：c++, sorting, vector, mergesort

我试图让这个合并排序函数对向量或单词节点进行排序（包含单词长度、出现次数和单词本身）似乎进入合并函数一次，然后程序失败，有什么想法吗？

```
bool Utility::mergeSort_occurences(vector<Word> &invector){
    if (invector.size() <= 1){
        return true;
    }
    vector<Word> left, right;
    int middle = (invector.size()/2);
    for(int i = 0 ; i < middle ; i++){
        left.push_back(invector[i]);
    }
    for(int i = middle ; i < invector.size() ; i++){
        right.push_back(invector[i]);
    }
    mergeSort_occurences(left);
    mergeSort_occurences(right);
    invector = mergeOccurences(left, right);
    return true;
}

vector<Word> Utility::mergeOccurences(vector<Word> &left, vector<Word> &right){
    vector<Word> mergelist;
    while(left.size() > 0 || right.size() > 0){
        if(left.size() > 0 && right.size() > 0){
            if(left[0].getOccurences() <= right[0].getOccurences()){
                mergelist.push_back(left[0]);
                left.erase(left.begin());
            }else{
                mergelist.push_back(right[0]);
                right.erase(right.erase(right.begin()));
            }
        }
        else if(left.size() > 0){
           mergelist.push_back(left[0]);
           left.erase(left.begin()); 
        }
        else if(right.size() > 0){
           mergelist.push_back(right[0]);
           right.erase(right.erase(right.begin()));            
        }
    }
    return mergelist;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T01:59:57.497

你的`right.erase(right.erase(right.begin()));`代码看起来很狡猾。该`erase`函数返回一个迭代器，指向被删除元素的后继元素，`end()`如果你删除了最后一个元素。

您正在保护这个代码 `right.size() > 0`，它只保证有一个项目。您有两个擦除操作。

你有没有研究过这样做的`erase`后果`right.end()`？

# c - 链表的问题

> ID：10081784
> 
> 赞同：1
> 
> 时间：2012-04-10T01:04:17.830
> 
> 标签：c, list, linked-list

我正在制作文件中出现的单词链接列表（不重复）以及它们首先出现的行。我完成了我认为最困难的部分（在跟踪行的同时解析文件），但我相信我现在在我的一种方法中遇到了问题，我无法弄清楚如何解决。我的代码在两个文件中，但我只在代码中包含有问题的方法以及驱动程序。（我尝试使用 GDB，但我认为我用错了，因为它一直说找不到文件并且无法运行。）

```
int main(int argc, char **argv){
file = fopen(argv[1],"r");
/*struct fileIndex *fIndex = NULL;*/ /*put this in header file??*/
fIndex = NULL;
delimiters = " .,;:!-";/*strtok chars to seperate*/
rewind(file);
int buffer = 65;
char str[buffer+1];/*where the lines are being stored*/
char *token, *cp;
int i;
int len;
while((fgets(str, buffer, file))!=NULL){/*inserting lines*/
for(i=0; i<buffer; i++){
    if(str[i]=='\n'){
    str[i]= '\0';
    break;
    }
}
len = strlen(str);
cp = xerox(str);
token = strtok(cp, delimiters);
/*if(token!=NULL)
printf("The word is %s\n", token);*/
    if(!present(fIndex, token)&&(token!=NULL)){
        insert(fIndex, i+1, token);
    }
    while(token!=NULL){
        token = strtok(NULL, delimiters);
        /*if(token!=NULL)
        printf("The word is %s\n", token);*/
        if(!present(fIndex, token)&&(token!=NULL)){
            insert(fIndex, i+1, token);
        }

    }
}
fclose(file);
struct fileIndex *root;
root = fIndex;

while(root != NULL){
printf("The string is %s and on line %d\n", root -> str, root -> lineNum);
root = root -> next;
}

free(fIndex);
free(cp);

return 0;
}

struct fileIndex *insert(struct fileIndex *head, int num, char *insert){
struct fileIndex* newnode = malloc(sizeof(struct fileIndex));
if(newnode==NULL)
exit(1);

newnode -> str = insert;
newnode -> lineNum = num;

newnode -> next = head;
return newnode;
} 
```

编辑：我也在考虑我检查单词是否已经存在的方法中的一个问题。我放置了一个打印语句，它应该只在要插入单词并且打印所有单词时才打印。最后打印列表的小循环没有打印，我认为它在第一次到达那里时达到 NULL 并且从不循环。

```
present(struct fileIndex* fIndex, char *findIt){/*finds if word is in structure*/
struct fileIndex* current = fIndex;
while(current!=NULL){
current = current -> next;
if(strcmpigncase(current -> str, findIt)==0){
    return current -> lineNum;
}
}
return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T01:12:53.363

插入函数返回新列表，但您没有在代码中使用返回值。

调用应如下所示：

```
fIndex = insert(fIndex, i+1, token); 
```

附录：

此外，在检查它是否为 NULL 之前，您正在使用令牌。它应该如下所示：

```
if((token!=NULL) && !present(fIndex, token)){
    fIndex = insert(fIndex, i+1, token);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-10T01:18:43.363

您应该始终检查 fopen() 是否成功。

```
if(file == NULL) {
printf("Error fopen");
exit(1);
} 
```

`fgets()`附加空终止符，所以你不需要自己做。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-10T01:20:10.540

```
file = fopen(argv[1],"r"); 
```

您忘记检查是否`fopen()`成功。每个`fopen(3)`后面都应该有类似于以下的代码：

```
if (!file) {
    fprintf(stderr, "unable to open %s\n", argv[1]);
    perror(argv[0]);
    exit(EXIT_FAILURE);
} 
```

如果您可以比退出更优雅地处理错误（回退到默认值？），那么您可能希望这样做。

```
for(i=0; i<buffer; i++){
    if(str[i]=='\n'){
    str[i]= '\0';
    break;
    } 
```

这很丑陋。您不需要自己终止，但是如果您想删除换行符，那么您还应该确保为您的行号计算换行符......

```
struct fileIndex *root;
root = fIndex;

while(root != NULL){
    printf("The string is %s and on line %d\n", root -> str, root -> lineNum);
    root = root -> next;
}

free(fIndex);
free(cp); 
```

我从来没有真正看到`fIndex`分配——它只是一个指针，你`NULL`在一开始就分配了它。整个代码部分看起来都是附加的，缺乏适当的缩进和周围的上下文使得它几乎无法理解。我不得不认为您应该将所有这些代码分离到它们自己的例程中，使用硬编码测试彻底测试它们，并确保它在尝试将其连接到更大的程序之前完美运行。（这实际上也适用于第一部分——看起来它会从一些孤立和定向的测试中受益。）

# java - 如何在 Java 中创建用于创建文本字段的 GUI 按钮？

> ID：10081789
> 
> 赞同：2
> 
> 时间：2012-04-10T01:04:50.693
> 
> 标签：java, swing, user-interface

我知道您可以通过键入来创建一个按钮

```
JButton x= new JButton("Something");
x.addActionListener(this); 
```

但是我如何制作一个动作监听器，以便按钮为用户创建一个文本字段以提供输入......以及如何从该文本框中读取文本？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-10T01:08:39.527

Swing 没有文本框这样的动物——你是说 JTextField 吗？如果是这样，...

*   您只需这样做就可以创建一个 JTextField ——`new JTextField()`
*   `add(...)`然后通过调用适当的容器（例如 JPanel）将其添加到您的 GUI 。
*   然后，您只需调用`getText()`它即可阅读文本， [JTextField 教程](http://docs.oracle.com/javase/tutorial/uiswing/components/textfield.html)将解释所有这些。
*   您还需要阅读有关布局管理器的教程，因为接受 JTextField 的容器必须具有可以容纳新组件的布局。
*   在添加或删除组件后，您还需要在容器上调用`revalidate()`和`repaint()`，以便容器布局管理器知道更新其布局并重新绘制自身。

这只是需要做的事情的一般要点。如果您需要更具体的建议，请告诉我们您的问题的详细信息、到目前为止您尝试过的方法以及有效或失​​败的方法。

**编辑**
你问：

> 但是我该怎么做才能使 textField 成为“弹出”而不是当前容器的添加。我有它，以便它添加到当前容器中......但这不是我需要的。

*   最简单的方法是显示 JOptionPane.showInputDialog(...)。

例如：

```
 // myGui is the currently displayed GUI
  String foo = JOptionPane.showInputDialog(myGui, "Message", "Title",
        JOptionPane.PLAIN_MESSAGE);
  System.out.println(foo); 
```

这看起来像这样：
![在此处输入图像描述](../Images/fda65bc9d8b4dfd15363f2f94359881d.png)

*   一种更复杂的方法是创建一个 GUI 并将其显示在 JOptionPane 中，并在 GUI 中查询其内容。

例如：

```
 JTextField fooField = new JTextField(15);
  JTextField barField = new JTextField(15);
  JPanel moreComplexPanel = new JPanel(new GridBagLayout());
  GridBagConstraints gbc = new GridBagConstraints();
  gbc.insets = new Insets(5, 5, 5, 5);
  gbc.weightx = 1.0;
  gbc.weighty = 1.0;
  gbc.anchor = GridBagConstraints.WEST;
  moreComplexPanel.add(new JLabel("Foo:"), gbc);
  gbc.gridx = 1;
  gbc.anchor = GridBagConstraints.EAST;
  moreComplexPanel.add(fooField, gbc);
  gbc.gridx = 0;
  gbc.gridy = 1;
  gbc.anchor = GridBagConstraints.WEST;
  moreComplexPanel.add(new JLabel("Bar:"), gbc);
  gbc.gridx = 1;
  gbc.anchor = GridBagConstraints.EAST;
  moreComplexPanel.add(barField, gbc);

  int result = JOptionPane.showConfirmDialog(myGui, moreComplexPanel, 
        "Foobars Forever", JOptionPane.OK_CANCEL_OPTION, 
        JOptionPane.PLAIN_MESSAGE);
  if (result == JOptionPane.OK_OPTION) {
     System.out.println("foo = " + fooField.getText());;
     System.out.println("bar = " + barField.getText());;
  } 
```

看起来像：
![在此处输入图像描述](../Images/f0ec05864d78db0fb50feaf00949fd24.png)

# visual-studio - Silverlight 业务应用程序中的空指针异常

> ID：10081790
> 
> 赞同：0
> 
> 时间：2012-04-10T01:05:01.740
> 
> 标签：visual-studio, silverlight, installation, null-pointer

我是银光新手。我刚刚在 Visual Studio 中创建了一个新的 Silverlight 业务应用程序。但是，我看不到设计器模式下的页面。当我选择设计器模式时，它会抛出空指针异常，而不是设计器。但是，我可以手动编写代码，当我运行时，页面会显示在浏览器中。

我清楚地理解，这可能是 vs/silverlight 插件的问题。我该如何解决这个问题。？任何帮助都深表感谢。

设置 Windows 7 Visual Studio 2010 Ultimate Silverlight 4 开发人员运行时 Silverlight 工具 April10

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T06:46:19.100

我想silverlight 的行为方式与WPF 相同。您的代码中可能存在错误，而 rutime 中不存在该错误。请参阅[WPF 设计器从不正确加载](https://stackoverflow.com/a/10043544/669527)。

# android - 为什么我会收到 nullpointerexception (Android)？

> ID：10081791
> 
> 赞同：0
> 
> 时间：2012-04-10T01:05:03.713
> 
> 标签：android, nullpointerexception

我完全不知道为什么我在这里得到一个空指针异常，因为几乎相同的代码在不同的程序中工作。我希望这很简单。

这是日志猫：

```
04-09 08:18:57.903: ERROR/AndroidRuntime(14378): java.lang.NullPointerException
04-09 08:18:57.903: ERROR/AndroidRuntime(14378):     at com.prattia.webs.cheaterphysics.Vectors.storeInfo(Vectors.java:216)
04-09 08:18:57.903: ERROR/AndroidRuntime(14378):     at com.prattia.webs.cheaterphysics.Vectors$2.onClick(Vectors.java:67)
04-09 08:18:57.903: ERROR/AndroidRuntime(14378):     at android.view.View.performClick(View.java:2465)
04-09 08:18:57.903: ERROR/AndroidRuntime(14378):     at android.view.View$PerformClick.run(View.java:8907)
04-09 08:18:57.903: ERROR/AndroidRuntime(14378):     at android.os.Handler.handleCallback(Handler.java:587)
04-09 08:18:57.903: ERROR/AndroidRuntime(14378):     at android.os.Handler.dispatchMessage(Handler.java:92)
04-09 08:18:57.903: ERROR/AndroidRuntime(14378):     at android.os.Looper.loop(Looper.java:123) 
```

Counter 初始化为 0 的 int，用于跟踪单击下一次的次数以存储 v 这里是代码的一部分，第 67 行和第 216 行标记为：

```
next.setOnClickListener(new View.OnClickListener() {    
            public void onClick(View v) {
                error.setText("");
                if(value.toString().length()==0||angle.toString().length()==0)
                    error.setText("Must enter both value and angle");
                else{
                    storeInfo(); //67
                    counter++;
                }
            }
        });

public void storeInfo(){
        Doublify(value);
        Doublify(angle);

    //216   info[counter].value = Double.parseDouble(value.getText().toString());
        info[counter].angle = Double.parseDouble(angle.getText().toString());
        info[counter].radian = rad.isChecked();
        if(q1.isChecked())
            info[counter].quad=1;
        if(q2.isChecked())
            info[counter].quad=2;
        if(q3.isChecked())
            info[counter].quad=3;
        if(q4.isChecked())
            info[counter].quad=4;
        angle.setText("");
        value.setText("");
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T01:14:06.000

在第 64 行，您`toString`在“值”对象上使用它可能会返回 TextView 的默认实现，`toString()`并且可能不是 0 长度

```
value.toString() 
```

但是在第 216 行，您使用正确的方法来获取文本值，并且由于您没有对其进行测试，因此可能为 null：

```
value.getText().toString() 
```

将第 64 行更改为如下内容：

```
if(value.getText() == null || value.getText().toString().length() == 0) 
```

（和类似的`angle`价值）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T01:20:26.363

如果 JScoobyCed 的答案不是空指针，那么它可能是数组。

```
info[counter].value // might be null because array's start at 0 not 1 
```

也许你想要：

```
info[counter - 1].value 
```

# javascript - 为什么我的代码无法检测 ctrl 键状态工作？

> ID：10081793
> 
> 赞同：0
> 
> 时间：2012-04-10T01:05:07.277
> 
> 标签：javascript, html, dom-events, internet-explorer-9, keypress

`shift`如果在用户单击时按下，我将尝试打开新窗口，如果在用户单击时打开`enter`新选项卡`ctrl`。部分有效，`shift`但`ctrl`部分不...

```
var ctrlPressed = false;
var shiftPressed = false;
var stb = null;
function onload() {
stb = document.getElementById("searchTextBox");
}
    function enter(e) {

        if (e.keyCode == 13) {
            if (!ctrlPressed && !shiftPressed) {
            window.location = "http://search.yahoo.com/search?p=" + encodeURI(stb.value) + "&fr2=sb-top&fr=404_web&pqstr=" + encodeURI(stb.value);
            }
            else if (ctrlPressed) {
            window.open("http://search.yahoo.com/search?p=" + encodeURI(stb.value) + "&fr2=sb-top&fr=404_web&pqstr=" + encodeURI(stb.value));
            }
            else if (shiftPressed) {
            window.open("http://search.yahoo.com/search?p=" + encodeURI(stb.value) + "&fr2=sb-top&fr=404_web&pqstr=" + encodeURI(stb.value), "_blank");
            }
        }
    }
    function searchdown(e) {
        if (e.keyCode == 17) {
            ctrlPressed = true;
        }
        else if (e.keyCode == 16) {
            shiftPressed = true;
        }
    }
    function searchup(e) {
        if (e.keyCode == 17) {
            ctrlPressed = false;
        }
        else if (e.keyCode == 16) {
            shiftPressed = false;
        }
    } 
```

我也不能使用jQuery...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T01:09:30.270

您是否知道[event.ctrlKey](https://developer.mozilla.org/en/DOM/event.ctrlKey)会告诉您控制键是否被按住？

# ios - iOS：NSObject 调用并检测哪个 UIVIewController 进行了调用

> ID：10081794
> 
> 赞同：0
> 
> 时间：2012-04-10T01:05:22.527
> 
> 标签：ios, uiviewcontroller, nsobject

希望这是一个简单的...

我有一个 NSObject，其方法在多个 UIViewControllers 中使用（NSObject 被导入到我的 .pch 文件中）。

UIViewControllers 然后像这样调用 NSObject；

`[ThisNSObject doSomething];`

这一切都在计划中，所以那里没有问题......但是，我希望方法*doSomething*能够检测到哪个 UIViewController 调用了该 NSObject。然后，基于该信息，我可以以任何给定的方式操作 UIViewController。

我需要这个的原因是因为如果我有一个 UITabBar，每个 Tab 加载一个不同的 UIViewController，但都调用全局 NSObject，我需要对那个特定的 UIViewController 进行进一步的操作。

我知道我可以访问*keyWindow*，但我不确定这正是我所追求的。

任何建议都会很棒，谢谢。

罗伊

**编辑：** 实际上，也许在 NSObject 中我可以检测到当前选择了哪个选项卡，然后获取堆栈中的顶部视图......并进行这样的引用？有没有人想过为什么这是一个坏主意？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T04:05:14.860

我有点同意@drekka 的回答，但它有一个问题......代码行：

```
- (void) viewController:(UIVIewController*)viewController doSomething; 
```

在语法上不正确。然而，他通过提出另一个正确的解决方案来弥补自己：

```
- (void) doSomethingWithViewController:(UIViewController*) viewController; 
```

另一种选择是，因为在您的情况下将 ViewController 作为参数传递似乎并不真正有意义，所以在您的自定义类上使用委托并将 viewController 订阅为委托。例如：

```
@protocol MyCustomNSObjectDelegate;

@interface MyCustomNSObject : NSObject

@property (nonatomic, assign) id<MyCustomNSObjectDelegate delegate;

- (void) doSomething;

@end

@protocol MyCustomNSObjectDelegate <NSObject>
@required
- (void) myCustomNSObject:(MyCustomNSObject*)myObject takeFurtherActionWithData:(NSString*)someData;
@end 
```

然后在你的 UIViewController

```
#import "MyCustomNSObject.h"

@interface MyUIViewController : UIViewController <MyCustomNSObjectDelegate>

... 
```

然后在调用 doSomething 之前将 MyCustomNSObject 的委托属性设置为 UIViewController。在 doSomething 方法中，在 if 完成“某事”之后，在方法的末尾添加：

```
[self.delegate myCustomNSObject:self takeFurtherActionWithData:@"change this to whatever type you need here"]; 
```

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T02:12:55.867

使用运行时代码，您可能可以追溯调用堆栈，但它是一个简单问题的相当复杂的解决方案。我建议您从 API 中寻找灵感并修改您的 doSomething 方法以采用如下控制器参数：

```
-(void) doSomethingWithViewController:(UIViewController *) viewController; 
```

这样，当您可以使用 doSomething 方法时，您可以像这样传递对 self 的引用：

```
[theObject doSomethingWithViewController:self]; 
```

你的问题就解决了——很简单。

PS如果你有其他参数，另一种签名样式可能是

```
-(void) viewController:(UIViewController *) viewController doSomethingWithX:(id) x; 
```

这一切都取决于什么对你最有意义。

# r - 搜索特定作者的包

> ID：10081796
> 
> 赞同：18
> 
> 时间：2012-04-10T01:05:37.347
> 
> 标签：r, r-package

有时我习惯了特定 R 包的设计，并想在 CRAN 中搜索该作者的所有包（例如，让我们使用 Hadley Wickham）。我怎样才能进行这样的搜索（我想使用 R，但这不一定是搜索模式）？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-04-10T03:05:28.443

Not exactly by author but perhaps access by maintainer would also be useful?

[http://cran.r-project.org/web/checks/check_summary_by_maintainer.html#summary_by_maintainer](http://cran.r-project.org/web/checks/check_summary_by_maintainer.html#summary_by_maintainer)

**EDIT by Tyler Rinker**

DWin's suggestion can be brought to fruition with these lines of code:

```
search.lib <- function(term, column = 1){
    require(XML)
    URL <- "http://cran.r-project.org/web/checks/check_summary_by_maintainer.html#summary_by_maintainer"
    dat <-readHTMLTable(doc=URL, which=1, header=T, as.is=FALSE)
    names(dat) <- trimws(names(dat))
    dat$Maintainer[dat$Maintainer == ""] <- NA
    dat$Maintainer = zoo::na.locf(dat$Maintainer)
    if (is.numeric(column)) {
        dat[agrep(term, dat[, column]), 1:3]
    } else {
        dat[agrep(term, dat[, agrep(column, colnames(dat))]), 1:3]
    }
}

search.lib("hadley")
search.lib("bolker")
search.lib("brewer", 2) 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-04-10T01:22:36.050

[Crantastic 可以按作者搜索](http://crantastic.org/authors)。你可以用 crantastic 做更多的事情，但你正在寻找的功能已经在那里提供了。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2012-04-10T01:57:19.290

改编自[available.packages 按发布日期](https://stackoverflow.com/questions/8722233/available-packages-by-publication-date)：

```
## restrict to first 100 packages (by alphabetical order)
pkgs <- unname(available.packages()[, 1])[1:100]
desc_urls <- paste(options("repos")$repos,"/web/packages/", pkgs, 
    "/DESCRIPTION", sep = "")
desc <- lapply(desc_urls, function(x) read.dcf(url(x)))
authors <- sapply(desc, function(x) x[, "Author"]) 
```

因为我是个自恋者（而 Hadley Wickham 在前 100 个中没有包裹 [**这在 2012 年是真的，但现在不可能是真的，在 2018 年！** ]）：

```
pkgs[grep("Bolker",authors)]
# [1] "ape" 
```

这个解决方案的主要问题是，真正做到这一点（而不仅仅是前 100 个包裹）意味着要为包裹信息打 CRAN 3000 多次......

**编辑**：更好的解决方案，基于 Jeroen Oom 在同一个地方的解决方案：

```
recent.packages.rds <- function(){
    mytemp <- tempfile()
    download.file(paste0(options("repos")$repos,"/web/packages/packages.rds"),
                  mytemp)
    mydata <- as.data.frame(readRDS(mytemp), row.names=NA)
    mydata$Published <- as.Date(mydata[["Published"]])
    mydata
}

mydata <- recent.packages.rds()
unname(as.character(mydata$Package[grep("Wickham",mydata$Author)]))
# [1] "classifly"    "clusterfly"   "devtools"     "evaluate"     "fda"         
# [6] "geozoo"       "ggmap"        "ggplot2"      "helpr"        "hints"       
# [11] "HistData"     "hof"          "itertools"    "lubridate"    "meifly"      
# [16] "memoise"      "munsell"      "mutatr"       "normwhn.test" "plotrix"     
# [21] "plumbr"       "plyr"         "productplots" "profr"        "Rd2roxygen"  
# [26] "reshape"      "reshape2"     "rggobi"       "roxygen"      "roxygen2"    
# [31] "scales"       "sinartra"     "stringr"      "testthat"     "tourr"       
# [36] "tourrGui" 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2022-01-28T08:08:50.597

[Bolker 的上述解决方案](https://stackoverflow.com/a/10082179/1169233)非常快并且仍然有效，但自 2018 年以来，有一个名为[pkgsearch](https://cran.r-project.org/package=pkgsearch)的包可以输出更完整的信息。下面是一个demo，延续了无耻自吹自擂的趋势：

```
r$> pkgsearch::advanced_search(Author = "Waldir", size = 100)                                                                                                                               
- "advanced search" --------------------------------------------------------------------- 11 packages in 0.001 seconds -
  #     package           version by                     @ title                                                                          
  1 100 matlab2r          1.0.0   Waldir Leoncio        1M Translation Layer from MATLAB to R                                             
  2 100 simExam           1.0.0   Waldir Leoncio        3y Generate Simulated Data for IRT-Enabled Exams                                  
  3  83 citation          0.6.2   Jan Philipp Dietrich  1M Software Citation Tools                                                        
  4  83 LOGAN             1.0.0   Denise Reis Costa     3y Log File Analysis in International Large-Scale Assessments                     
  5  82 TruncExpFam       1.0.0   Waldir Leoncio        7d Truncated Exponential Family                                                   
  6  61 contingencytables 1.0.0   Waldir Leoncio        1M Statistical Analysis of Contingency Tables                                     
  7  60 DIscBIO           1.2.0   Waldir Leoncio       10M A User-Friendly Pipeline for Biomarker Discovery in Single-Cell Transcriptomics
  8  51 BayesSUR          2.0.1   Zhi Zhao              3M Bayesian Seemingly Unrelated Regression                                        
  9  44 lsasim            2.1.2   Waldir Leoncio        4M Functions to Facilitate the Simulation of Large Scale Assessment Data          
 10  39 BayesMallows      1.1.0   Oystein Sorensen      3M Bayesian Preference Learning with the Mallows Rank Model                       
 11  11 xaringan          0.22    Yihui Xie             8M Presentation Ninja 
```

请注意，我必须`size`从默认值 10 增加，否则我不会得到所有的包。

为了与上述答案的输出进行比较：

```
r$> unname(as.character(mydata$Package[grep("Waldir",mydata$Author)]))                        
 [1] "BayesMallows"      "BayesSUR"          "citation"          "contingencytables" "DIscBIO"           "LOGAN"             "lsasim"            "matlab2r"          "simExam"          
[10] "TruncExpFam"       "xaringan" 
```

# java - 选择一种数据结构来存储句子中的单词及其起始位置

> ID：10081800
> 
> 赞同：1
> 
> 时间：2012-04-10T01:06:11.773
> 
> 标签：java, data-structures, hashmap, sentence

我正在准备面试，往往会出现的问题之一是：

呈现一个句子（例如，这首歌是最好的歌曲）分解成单词和单词第一个字母的索引，即“the” - 0、12；“歌曲” - 4,21；“是” - 9; “最佳” - 16；选择一个数据结构来存储这些信息，并使用该数据结构重构句子。

我最初的尝试涉及将单词存储在哈希图中，其中键是单词，值是位置数组。这是完全可行的，但是对于嵌套的 for 循环和边界索引处的烦人问题、在适当位置的空间中读取等会变得相当复杂。

我已经为它完成了代码，所以如果有人想看，我会发布（它很长，读起来很吸引人！！）

无论如何，对于我的问题：任何人都可以提出一种更有效的方式来表示和重建数据吗？我很想尝试另一种方式，但这就是我迄今为止想出的全部

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T01:15:32.600

作为一个面试不同技能水平的候选人的人，我希望被面试者在决定最终的数据结构之前问更多的问题。

*   数据会专门用于重建句子吗？如果是这样，最好有一个清单。
*   您需要能够查找单词位置吗？如果是这样，你的结构很好。
*   对于使用这些数据的句子，您还可能会问什么其他问题？

一种选择是为每个单独的单词创建一个`WordPosition`对象，该对象包含该单词、它的位置以及对下一个单词的引用。这些将形成一个链表，使重构句子成为简单的按顺序遍历。将这些存储在地图中，其中单词作为键，`WordPosition`每个单词都有一个 s 列表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T01:10:04.673

让键成为位置怎么样？那么你不需要使用数组。你可以使用树形图，然后积分器将按顺序返回令牌。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-10T01:25:16.953

我在这里避免使用地图，因为这似乎太简单了。

```
class Sentence {
  String[] words;//Every word in the sentence
  int[][] word_positions;//{index into the word array,start position of that word in the sentence}

  String getSentence(){
    //Find the last position of the last character of the last word
    int length = word_positions[word_positions.length][1] 
                 + word[word_positions[word_positions.length][0]].length();
    //Allocate an appropriate sized array
    char[] sentence = new char[length];

    //Iterate through every word in the sentence, putting it into the correct place.
    for (int w=0; w<word_positions.length; w++){
      //figure out where in the array this word will start
      int start = word_positions[w][1];
      //get the word
      char[] word = words[wordpositions[w][0].toCharArray();
      //copy it into the master array at the correct position
      for (int letter=0; letter<word.length; letter++ ) {
        sentence[start+letter] = word[letter];
      }
    }

    return sentence.toString();
  }
} 
```

如果这不涵盖问题的一部分，请发表评论。我不确定我是否了解所问内容的全部范围。

# asp.net - 如何在 .net 中创建类似向导的 ui

> ID：10081802
> 
> 赞同：0
> 
> 时间：2012-04-10T01:06:16.927
> 
> 标签：asp.net, .net, wizard

我必须构建类似向导的 ui，因为操作应该通过 3 个步骤完成。

并且在每一步用户都会输入一些字段，然后当他点击下一步时，我会检查当前输入，如果有效，我会进入下一个向导。

如果输入无效，他将留给当前向导。

也就是说，每次用户点击下一步按钮时，表单都会被提交到服务器。

并且当用户点击上一个按钮时，应该保留之前输入的内容。

对于这种方式，我没有很好的解决方案。

任何人都可以给我一些建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T04:56:08.790

你需要阅读一篇关于如何在 asp.net 中使用向导控件的好文章。请参考：[http ://asp-net-example.blogspot.in/2008/10/wizard-example-how-to-use-wizard.html](http://asp-net-example.blogspot.in/2008/10/wizard-example-how-to-use-wizard.html)

# javascript - Javascript 滚动事件

> ID：10081807
> 
> 赞同：0
> 
> 时间：2012-04-10T01:06:45.270
> 
> 标签：javascript, jquery, scroll

在某些博客上，当您滚动到页面底部时，它们会在页面右下角有一个滑入视图的 DIV。

很多时候，在一篇博客文章中，一旦您将页面下载到评论部分开始的位置，他们就会看到此 DIV 幻灯片。

我正在尝试复制这一点，我看到一个站点可以执行此操作，但它没有在评论附近执行此操作，而是使用下面的代码，您可以看到它在中途点附近。

`Document height - the Window height / 2`

所以它实际上是在页面的中间位置。当我到达页面的评论部分时，我将如何让它出现在我的视野中，假设我的评论被包装在一个带有 ID 的 DIV 中`comments`

```
$(document).scroll(function () {
    var curPos = $(document).scrollTop();
    var docHeight = $(document).height() - $(window).height();
    if (curPos > (docHeight / 2)) {
      MoneyBox.show();
    } else {
      MoneyBox.hide();
    }
}); 
```

![在此处输入图像描述](../Images/9e0c0a6d9624f0eefeaa3ecc69f61a83.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-10T01:14:05.660

尝试比较你的 div 的 scrollTop 和偏移量

```
$(document).scroll(function(){
    var curPos = $(document).scrollTop();

    var commentsPos = $('#comments').offset().top;

    if(curPos >= commentsPos) {
        MoneyBox.show();
    } else {
        MoneyBox.hide();
    }
}); 
```

# c# - C# 类定义的语法

> ID：10081809
> 
> 赞同：1
> 
> 时间：2012-04-10T01:06:49.087
> 
> 标签：c#, asp.net-mvc-3

我的班级显示编译错误：

```
namespace Zone.Models
{
    using System;
    using System.Collections.Generic;
    using System.ComponentModel.DataAnnotations;
    using System.Web;
    using System.Web.Mvc;
    using Zone.Models;

    public class MyViewModel
    {
       public MyInfo Info { get; set; }
       public PageNumberResults { get; set; }

    }
} 
```

得到的错误如下：

```
Error 1 Invalid token '{' in class, struct, or interface member declaration 
Error 2 Invalid token ';' in class, struct, or interface member declaration
Error 3 Invalid token ';' in class, struct, or interface member declaration 
Error 4 Type or namespace definition, or end-of-file expected 
```

我的控制器显示了游戏是如何通过界面输入到数据库中的：

```
using System;
using System.Collections.Generic;
using System.Data;
using System.Data.Entity;
using System.Linq;
using System.Web;
using PagedList;
using System.Web.Mvc;
using Zone.Models;

namespace Zone.Controllers
{ 
    public class GameController : Controller
    {
        private mydbEntities db = new mydbEntities();

        public ViewResult Index(string Ordering, int? CounterForPage)
        {

            var FullDatabaseItem = from b in db.tblGames
                                   select b;

            var Info = db.tblGames.Include(x => x.tblConsole).Where(UserInfo => UserInfo.UserName.Equals(User.Identity.Name)).ToList();

            switch (Ordering)
            {
                case "HeadlineName":
                    FullDatabaseItem = FullDatabaseItem.OrderBy(b => b.GameName);
                    break;
                case "DatePosted":
                    FullDatabaseItem = FullDatabaseItem.OrderBy(b => b.ReleaseYear);
                    break;
                case "DiscriptionDate":
                    FullDatabaseItem = FullDatabaseItem.OrderBy(b => b.ReleaseYear);
                    break;
                default:
                    FullDatabaseItem = FullDatabaseItem.OrderByDescending(b => b.ReleaseYear);
                    break;
            }

            int pageSize = 3;
            int pageNumber = (CounterForPage ?? 1);
            var PageNumberResults = FullDatabaseItem.ToPagedList(pageNumber, pageSize);

            if (PageNumberResults.Any())
            {

                return View(new MyViewModel()
                {
                    Info = info,
                    PageNumberResults = FullDatabaseItem.Count()
                });
            }

            return View("ErrorView");
        }
    }
} 
```

任何帮助，将不胜感激

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-10T01:11:33.300

您缺少第二个属性中的类型：

```
 public ??? PageNumberResults { get; set; } 
```

而且您不需要`using Zone.Models;`声明，因为您的类位于该名称空间中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T01:12:26.033

我认为这条线给你错误

```
public PageNumberResults { get; set; } 
```

你需要这种格式

可见性修饰符类型名称

前任 ：`public string Name { set;get;}`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-10T01:09:21.923

`using Zone.Models;`从您的代码中删除。通过声明，您已经在该名称空间中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-10T01:41:22.990

除了其他人引用的内容之外，不确定您是否只是没有完全复制控制器，但是您缺少`}`对类和命名空间的关闭。

# html - 奇怪的：带有 z-index 和 img 的悬停错误

> ID：10081810
> 
> 赞同：0
> 
> 时间：2012-04-10T01:07:00.950
> 
> 标签：html, css, image, hover, z-index

我遇到了一个非常奇怪的错误，试图突出显示带有叠加层（更高`z-index`）的图像的某些部分`:hover`。在 Safari / Firefox / Chrome 中，没问题。但是在 IE（8 或 9）中，我的简单 CSS 代码不起作用，因为`:hover`当覆盖层并不总是可见时（否`background-color`或`visibility:hidden`）似乎 IE 不会触发

这是一个带有 HTML 和 CSS 的 MWE：

```
<html>
<head>
  <style>
    .photo-notes {
      position: absolute;
      z-index: 998;
    }
    .photo-notes ul {
      position: relative;
    }
   .photo-notes li {
      list-style: none;
      position: absolute;
      background: #ccc;
      z-index: 999;
    }
    .photo-notes li:hover {
      background: red;
    }
    .photo-container {
      z-index: 1;
    }
  </style>
</head>
<body>
<div>
  <div class="photo-notes">
    <ul>
      <li style="left:  25px; top: 20px; width: 50px; height: 100px;"> </li>
    </ul>
  </div>
  <div class="photo-container">
    <img src="http://www.google.com/logos/2012/newyearsday-2012-hp.jpg"/>
  </div>
</div>
</body>
</html> 
```

上面的代码有效，但是如果您尝试从样式中删除`background: #ccc`或添加样式，它将在 IE 下停止工作（不再起作用）。`visibility:hidden``li``:hover`

另一个奇怪的事情是，如果行被删除，它确实可以工作（`:hover`被触发） 。因此，这不是一个在 IE 中不可见的元素上不可能的问题，正如人们所想的那样，我已经尝试在任何地方添加显式 es 但没有成功......`background``visibility:hidden``li``<img>``:hover``z-index`

知道发生了什么以及如何解决它吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T19:20:48.983

好吧，我自己解决了这个问题，方法是设置背景和（`opacity:0`对于`li`IE 意味着`filter: alpha(opacity:0))`。这样，`:hover`正确触发。

# xcode - 为什么 UIWebView 中的本地图像需要永远加载到 iPad 上？

> ID：10081811
> 
> 赞同：0
> 
> 时间：2012-04-10T01:07:01.117
> 
> 标签：xcode, cocoa-touch, uiwebview

我在导航控制器中有一个 UIWebView。它从 xml 文件中提取 html，然后显示 html。html 包含通过`<img src="image.png" />`. 在 iPhone 模拟器上，UIWebView 同时显示文本和图像。但是，在 iPad 上有一个很大的延迟：

![正在等待图片加载...](../Images/2a68ecb1a4ed6657a6d345a139509c2d.png)

几秒钟后，图像加载：

![终于加载了！](../Images/0911aecdf399440914d34a5fcadf26da.png)

我怎样才能摆脱这种讨厌的延迟？

代码：

```
NSString *html = [NSString stringWithFormat:@"Blah blah %@ <img src='image.png'> %@", [self.questionsAndAnswers objectAtIndex:0], [self.questionsAndAnswers objectAtIndex:1]];
[webView loadHTMLString:html baseURL:[NSURL fileURLWithPath:[[NSBundle mainBundle] bundlePath]]]; 
```

UIWebView 通过 Storyboard 连接。

编辑：尽管我发表了评论，但这实际上发生在任何图像上。我什至尝试将它加载到没有其他 html 的基本 UIWebView 中！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T03:47:29.023

有几件事要尝试：

*   预加载 html（如果您不必即时生成任何内容，则很有用）
*   预加载图像（为了缓存它）
*   确保缓存已关闭
*   确保没有进行大量图像处理（调整大小等）
*   确保您的图像不是太大（可能应该检查任何超过 100k 的图像
*   如果一切都失败了，尝试通过慢慢移除部分或通过重建视图来制作一个最小的例子

# css - IE 中 @fontface 显示之前默认字体的 Flash

> ID：10081814
> 
> 赞同：1
> 
> 时间：2012-04-10T01:07:24.003
> 
> 标签：css, ajax, fonts

在加载@font-face webfont 时停止 IE 显示默认字体的最佳方法是什么？页面用ajax加载，css文件加载到head中。可以在[http://www.peterharveyco.com.au/](http://www.peterharveyco.com.au/)查看此问题，然后单击其中一个滚动项目。根据我的阅读，我正在正确加载字体以避免此类问题。它只是加载我设置为备份字体的任何内容，直到它准备好。设置关闭备份字体的唯一解决方案是什么？如果可能的话，在准备好之前，我什么都没有……

任何帮助将不胜感激。

CSS 文件：

```
@font-face {
    font-family: 'TradeGothicLTStdBdCnNo.20';
    src: url('tradegothicltstd-bdcn20-webfont.eot');
    src: url('tradegothicltstd-bdcn20-webfont.eot?#iefix') format('embedded-opentype'),
         url('tradegothicltstd-bdcn20-webfont.woff') format('woff'),
         url('tradegothicltstd-bdcn20-webfont.ttf') format('truetype'),
         url('tradegothicltstd-bdcn20-webfont.svg#TradeGothicLTStdBdCnNo.20') format('svg');
    font-weight: normal;
    font-style: normal;

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T07:49:35.823

您可以使用 Google 的[WebFont 加载器](https://developers.google.com/webfonts/docs/webfont_loader)将您的 @font-face 字体指定为自定义字体。看起来您可以将@font-face 规则单独粘贴在样式表中，然后将加载器指向此样式表。然后，您可以使用`.wf-loading`该类将具有自定义 @font-face 字体的元素设置`visibility:hidden`为不显示默认字体。然后使用`.wf-active`类设置`visibility:visible`显示@font-face 字体

# jquery - 委托/悬停

> ID：10081817
> 
> 赞同：1
> 
> 时间：2012-04-10T01:07:59.363
> 
> 标签：jquery, delegates

> **可能重复：**
> [将委托（）与悬停（）一起使用？](https://stackoverflow.com/questions/3367769/using-delegate-with-hover)

我正在尝试这段代码，但显然我做错了什么。使用此代码，`hover`效果不起作用。

然而，类似的东西：`$('.group>span').hover (function() {`效果很好，但我需要委派`html()`内容。

```
<div class="group">
    <span></span>
</div>

$('.group>span').delegate("hover", "a", function() {
    $(this).html('<a href="#new_list">Some button</a>');
}, function() {
    $(this).empty();
});​ 
```

任何的想法？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T01:10:17.653

[`hover`](http://api.jquery.com/hover/)只是一个方便的包装`mouseenter`和`mouseleave`. 我认为您将不得不分别处理每个。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T01:10:45.907

您传递给 的参数数量`delegate`无效。你通过了**4**，而它应该只需要 3。

`.delegate( selector, eventType, handler(eventObject) )`是函数签名。
**而且你代码中参数的顺序是错误的！你交换了选择器和事件类型**

你写了这个：

```
$('.group>span').delegate ("hover", "a", function() { 
```

虽然它应该是这个顺序：

```
$('.group>span').delegate ("a", "hover", function() { 
```

无论如何，您可以使用`delegate`这种`hover`方式：

```
$('.group>span').delegate("a", "mouseenter", function() {
    $(this).html('<a href="#new_list">Some button</a>');
});

$('.group>span').delegate("a", "mouseleave", function() {
    $(this).empty();
}​); 
```

[**现场演示**](http://jsfiddle.net/NSYWG/1/)
您可以在这个问题中看到另一种方法：
[Using delegate() with hover()?](https://stackoverflow.com/questions/3367769/using-delegate-with-hover)

# mysql - MySQL GROUP BY YEARWEEK get first and last 不起作用

> ID：10081819
> 
> 赞同：1
> 
> 时间：2012-04-10T01:08:28.683
> 
> 标签：mysql, aggregate

我正在尝试从我拥有的 MySQL 表中获取每周（如周一至周日，由 YEARWEEK 的 mode=1 参数指定）的股票值，其中包含每日最低价、最高价、开盘价和收盘价。

例如，以下查询正确地为我提供了 2012 年 1 月 1 日至 2012 年 3 月 1 日之间这周的高点和低点：

```
SELECT date, MIN(low), MAX(high) 
FROM daily_stock_values WHERE stock_id = SOMESTOCK 
AND date BETWEEN '2012-01-01' AND '2012-03-01' GROUP BY YEARWEEK(date, 1) 
```

这正确输出：

```
+------------+-----------+-----------+
| date       | max(high) | min(low)  |
+-----------+-----------+-----------+
| 2012-01-01 | ......... | ......... |
| 2012-01-02 | ......... | ......... |
| 2012-01-09 | ......... | ......... |
| 2012-01-16 | ......... | ......... |
| 2012-01-23 | ......... | ......... |
| 2012-01-30 | ......... | ......... |
| 2012-02-06 | ......... | ......... |
| 2012-02-13 | ......... | ......... |
| 2012-02-20 | ......... | ......... |
| 2012-02-27 | ......... | ......... |
+------------+-----------+-----------+ 
```

如您所见，所有日期都正确指定（除了第一个是结果范围较低的日期）星期一，这是星期一至星期日的第一天。

但是，当我尝试介绍第一个和最后一个时（如此[处](https://stackoverflow.com/questions/1379565/mysql-first-and-last-record-of-a-grouped-record-aggregate-functions)所述）：

```
SELECT date, MIN(low), MAX(high),
SUBSTRING_INDEX(GROUP_CONCAT(CAST(open AS CHAR) ORDER BY date), ',', 1) AS open, 
SUBSTRING_INDEX(GROUP_CONCAT(CAST(close AS CHAR) ORDER BY date DESC), ',', 1) AS close
FROM daily_stock_values WHERE stock_id = SOMESTOCK 
AND date BETWEEN '2012-01-01' AND '2012-03-01' GROUP BY YEARWEEK(date, 1) 
```

不幸的是，这弄乱了我的 GROUP BY 并导致日期不再与星期一对齐：

```
+------------+-----------+-----------+-----------+-----------+
| date       | max(high) | min(low)  | open      | close     |
+------------+-----------+-----------+-----------+-----------+
| 2012-01-01 | ......... | ......... | ......... | ......... |
| 2012-01-08 | ......... | ......... | ......... | ......... |
| 2012-01-15 | ......... | ......... | ......... | ......... |
| 2012-01-22 | ......... | ......... | ......... | ......... |
| 2012-01-29 | ......... | ......... | ......... | ......... |
| 2012-02-05 | ......... | ......... | ......... | ......... |
| 2012-02-12 | ......... | ......... | ......... | ......... |
| 2012-02-19 | ......... | ......... | ......... | ......... |
| 2012-02-26 | ......... | ......... | ......... | ......... |
| 2012-02-27 | ......... | ......... | ......... | ......... |
+------------+-----------+-----------+-----------+-----------+ 
```

这里发生了什么？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-12T15:54:41.563

我能想出的最佳解决方案是：
`SELECT YEARWEEK(date, 1) AS ignore, MIN(date) as date`

这工作得很好！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T02:29:35.547

实际上，您的第一个查询已经“搞砸了”。您正在选择日期并按周分组。这样想：如果您在同一周有两个日期，您希望显示什么日期？

您的选项是 select and group by`YEARWEEK(date, 1)`或 select and group by `date`。

顺便说一句，您应该考虑提供有关它们包含的表和数据以及您的预期结果的更多信息。

# c# - 如何为金额设置正则表达式

> ID：10081825
> 
> 赞同：0
> 
> 时间：2012-04-10T01:09:19.677
> 
> 标签：c#, asp.net, validation

我有一个文本框，其中有一个值，例如`$8.00`我想验证此文本框以始终检查金额值，并且不接受字母或除`0.00`. 如何在 RegularExpressionValidator 中实现这一点？

感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T01:16:42.360

您正在寻找的正则表达式是`@"^\d+\.\d\d"` 它匹配在点之前有 1 个以上数字并且在点之后正好有两个数字的字符串

如果您希望它允许从 $ 开始一个字符串，则使用`@"^\$\d+\.\d\d"`or`@"^\$?\d+\.\d\d"`作为可选的 $。

如果您希望 $ 与带空格的数字分开，请使用`@"^\$?\s*\d+\.\d\d"`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T01:14:59.223

以下正则表达式 g 将允许以下格式的数字 (12345.67, 0, 0.1)

^\d{1,5}(.\d{1,2})?$

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-10T01:16:37.057

在我希望它有助于尝试之前，我使用了以下之一。

```
\d{1,3}(.)\d{1,2}
or
\d{1,3}.\d{2} 
```

# java - 在java中的arraylist中打印数组的元素

> ID：10081829
> 
> 赞同：0
> 
> 时间：2012-04-10T01:09:31.303
> 
> 标签：java

我确实有这段代码，我想打印出 Arraylist 的所有数组值。感谢您的帮助。

这是我的代码：

```
for (int i = 0; i <count; i++) {
        System.out.println("list #" + i);
        for (int j = 0; j < list[i].size(); j++) {
            list[i].get(j);

            System.out.println("elements of array in arraylist "+list[i].get(j));

        }
    } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-10T01:15:47.403

要打印存储在 arraylist 中的数组元素，您必须执行以下操作：

```
for each element of arraylist
 get array from arraylist
   for each array element in array
       print array element. 
```

您似乎正在迭代 List 类型的数组。

使用数据结构的更多详细信息编辑代码

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-10T01:14:47.637

看看这是否适合你。我认为它更简单：

```
int numLists = 10;   // Or whatever number you need it to be.
ArrayList [] arrayOfLists = new ArrayList[numLists];
// you realize, of course, that you have to create and add those lists to the array.  
for (ArrayList list : arrayOfLists) {
    System.out.println(list);
} 
```

我想知道为什么您不喜欢列表列表：

```
List<List<String>> listOfLists = new ArrayList<List<String>>();
// add some lists of Strings
for (List<String> list : listOfLists) {
    System.out.println(list);
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-04-10T01:17:07.710

```
for (Object[] array : list)
  for (Object o : array)
    System.out.println("item: " + o); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-07-11T05:15:49.667

下面的代码对我来说很好

```
public class Solution
{

    public static void main(String[] args) 
    {

        int T,N,i,j,k=0,Element_to_be_added_to_the_array;

        Scanner sn=new Scanner(System.in);
        T=sn.nextInt();
        ArrayList<Integer>[] arr=new ArrayList[T];
        for(i=0;i<T;i++)
        {
            arr[k]=new ArrayList<Integer>();
            N=sn.nextInt();
            for(j=0;j<N;j++)
            {
                Element_to_be_added_to_the_array=sn.nextInt();
                arr[k].add(Element_to_be_added_to_the_array);
            }
            k++;
        }

//Printing elements of all the arrays contained within an arraylist

    for(i=0;i<T;i++)
    {
        System.out.println("array["+i+"]");
        for(j=0;j<arr[i].size();j++)
        {
            System.out.println(arr[i].get(j));
        }   
    }
    }
} 
```

# ruby-on-rails - 如何在开发环境中预编译 Rails 中的资产？

> ID：10081832
> 
> 赞同：6
> 
> 时间：2012-04-10T01:09:37.923
> 
> 标签：ruby-on-rails, ruby-on-rails-3.1

我想从命令行手动预编译我的开发环境中的一些资产（以检查已编译的 js 和 css 文件的内容）。

我在跑步

`RAILS_ENV=development bundle exec rake assets:precompile`

但是我的 js 和 css 没有在 public/assets 文件夹中编译，只有图像。知道为什么会这样吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-10T02:46:18.273

尝试将此添加到您的`config/environments/production.rb`：

```
config.assets.precompile += %w( *.css *.js ) 
```

# matlab - 对数据进行分类

> ID：10081837
> 
> 赞同：0
> 
> 时间：2012-04-10T01:10:17.947
> 
> 标签：matlab

所以，我必须使用来自图像域和视频域的标签来构建这个 6 级的分类“树”，这样我才能更好地分类。问题是我不明白这是怎么回事，因为这不是我的知识领域。

我们将标签集合及其相关性表示为 N = {ni} 和 E = {ei,j |ni, nj ∈ N}，其中

e(i,j) = e(i,j . e(i,j)/e(i,j)+ e(i,j)

是概念 i 和 j 之间相关性的调和平均值，归一化使得 (sigma)(e(i,j))=(sigma)(e(i,j)YT)=1

我的问题是如何计算两个标签之间的相关性，到目前为止我看到的所有相关性示例都是针对数据集的？另外，我如何进行归一化以使总和等于 1？

任何帮助表示赞赏。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T07:07:34.660

[您可能会发现我对MATLAB Tree Construction](https://stackoverflow.com/questions/10082731/matlab-tree-construction)的回答很有用。要找到这种相关性，您可以创建一个长度为 N 的数组（此文件中的图像/视频的数量），如果该图像没有标签，则第 k 个值为 0，如果有，则为 1。像这样的两个数组之间的相关性可以通过

```
corr(tag1, tag2); 
```

标准化 - 你将有一个 M×M（其中 M 是标签的数量）矩阵`e`。标准化：

```
normalised_e = e ./ sum(e(:)); 
```

在哪里`sum(e(:))`给你所有东西的总和`e`。您可以检查矩阵是否已归一化，因为：

```
sum(e(:)) == 1 
```

# sonarqube - 无法安装声纳 2.14

> ID：10081838
> 
> 赞同：0
> 
> 时间：2012-04-10T01:10:22.663
> 
> 标签：sonarqube

这是我第一次在我的机器上安装声纳，但我收到以下错误消息：没有找到 org.apache.jasper.servlet.JspServlet。我在google上做了一些搜索，但是其他人的问题是由不兼容的声纳插件引起的，这与我的情况不同。任何回复将不胜感激。谢谢。

问候

# javascript - 位置问题：固定和哈希标签（正文中的详细信息）

> ID：10081841
> 
> 赞同：0
> 
> 时间：2012-04-10T01:10:42.830
> 
> 标签：javascript, html, css

我有一个`position:fixed;`导航栏。每当我转到 mypage.html#myid 时，导航栏都会与 .html 的一些内容重叠`myid`。如何将整个页面向下移动一点，以便导航栏不覆盖内容？

PS我试过`body{padding-top:50px;}`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T01:44:06.510

您不能在 myid div 上使用 margin-top 吗？你的主要内容应该在一个 div 里面，这个 div 应该在 body 里面，然后 myid div 可以从 body 下推，为固定导航栏留出足够的空间。

一些代码会有所帮助...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T13:58:43.290

需要一些 hacky 解决方案。

```
#myID:before { 
  display: block; 
  content: " "; 
  margin-top: -285px; /* navigation height */
  height: 285px; /* navigation height */
  visibility: hidden; 
} 
```

逻辑是在#myID 内容之前添加隐藏元素，以便浏览器为其提供隐藏空间。将负值作为 margin-top 将阻止它提供物理空间。

请在这里查看详细信息：[http ://css-tricks.com/hash-tag-links-padding/](http://css-tricks.com/hash-tag-links-padding/)

# fortran - 具有许多模块的静态库

> ID：10081846
> 
> 赞同：1
> 
> 时间：2012-04-10T01:11:29.723
> 
> 标签：fortran

如果使用 fortran 开发静态库：

该库由多个模块组成，例如“模块 a”、“模块 b”等。

每个模块都有公共变量、类型和过程。

现在，想在程序“test”中使用lib。

一种可能的方法是使用每个模块，并在链接期间提供 *.a lib 文件。例如：

```
program test
  use a
  use b
  ...
end program 
```

但是如果只需要使用/包含一个模块/*.h 会更好。例如：

```
program test
  use all
  ...
end program 
```

一种可能的解决方案是将过程的所有公共变量、类型和接口复制到“module all”中，并使用“module all”而不是单个模块。

但是如果修改了单个模块中的任何一个，“module all”也需要修改以适应变化。

是否有更合适的方法可以解决，或者是否有自动工具来生成“全部模块”？

非常感谢您的任何意见。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-10T05:00:48.107

我不会将各个模块中的代码复制到模块“all”中，因为正如您所说，这会在更改代码时导致额外的工作。以及出错的可能性。相反，在模块“all”中“使用”这些模块。然后，当您想要它们全部时，您“全部使用模块”。当你想要一个特定的模块时，你会使用那个模块。你必须注意的是循环模块引用，因为它是被禁止的：A 使用 B 使用 C 使用 A 是不允许的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-10T13:48:20.980

似乎最终的解决方案是使用`submodule`，不幸的是 gcc 不支持。

见： http: [//fortranwiki.org/fortran/show/Submodules](http://fortranwiki.org/fortran/show/Submodules)

# visual-c++ - 如何在 VC++ 中自动创建单选按钮和组框名称？

> ID：10081848
> 
> 赞同：0
> 
> 时间：2012-04-10T01:11:37.170
> 
> 标签：visual-c++, c++-cli

我想以任何方式查看天气以在 VC++ 中自动创建单选按钮和组框名称。我需要创建 150 个分组框，每个分组框包含 4 个单选按钮和一个文本标签。有没有办法自动为这些组件创建名称？谢谢

# visual-studio-2010 - 说真的，为 SQL 数据库项目部署覆盖 sqlcmdvars 中的 DefaultDataPath

> ID：10081850
> 
> 赞同：2
> 
> 时间：2012-04-10T01:12:05.957
> 
> 标签：visual-studio-2010, sql-server-2008, webdeploy

我在 Visual Studio 2010 中有一个 SQL 2008 数据库项目，该项目在开发阶段定期从模式比较中同步。同样的项目也在 TFS 源代码控制之下。我有两个环境，调试和生产。每个环境都是一台同时运行 IIS 和 SQL Server 的机器。然而，生产环境对于数据库 D:\Data\ 和 E:\Logs\ 与我在标准 c:\program files\sql....\data 上的开发服务器具有不同的数据和日志路径。

我想要做的是设置我处理从调试到生产环境的部署的方式。我已经安装了 WebDeploy 2.1，并通过网站项目上的右键单击上下文菜单在 Visual Studio 中构建了我的部署包。我想通过 RDP 手动将部署包复制到生产服务器，所以这里没有网络问题。部署包设置设置为包括在包/发布 SQL 选项卡中配置的所有数据库。在 Package/Publish SQL 选项卡中，我不会从现有数据库的数据/模式中提取数据，因为我想从 SQL 数据库项目中进行部署。所以我只是指向位于我的数据库项目的 /sql/release 文件夹中的预先生成的 .sql 脚本文件。最重要的是，我通过 VSDBCMD 在 SQL 项目的构建后事件中生成 .sql 脚本。

这很好，但我在这里有一个似乎无法克服的主要问题。它与从调试环境到生产环境不同的数据库数据和日志文件路径有关。我实际上在生产服务器上的 IIS 中的 WebDeploy 期间收到一个异常，它说它找不到 c:\programs files...\MyDatabase.mdf 文件。可怕的是，在这个异常之后，整个数据库都被删除了。我在进行部署之前创建的空数据库。两次都发生了，我试图弄乱它。我不确定我对此有何感受，但我希望我能找到一个可靠的解决方案。

我一直在狂热地寻找一种在部署期间更改路径的方法，并发现许多地方提到更改 Schema Objects\Database level objects\Storage\Files 下的 *.sqlfiles.sql 文件中的路径，因为它试图更改路径deploy to 是由于 Debug SQL server 数据库中的架构比较和写入而指定的路径。在此处更改路径将暂时起作用，直到我进行下一次架构比较并写入，然后 sqlfiles.sql 文件将再次被 Debug 数据库中的信息覆盖。而且我不想记住在模式比较期间永远不要更新这些文件，因为任何错误都有可能删除生产数据库。

我认为我的救赎在于我的 Release.sqlcmdvars 文件。这实际上是一个笑话，我可以看到一个我“可以”键入默认数据库路径的地方，但它似乎是一个只读字段，因为它提到“默认创建数据库文件的位置（在部署时设置）”。如果我可以在这里指定路径，那就太好了。有没有办法在此处指定变量中的路径来覆盖 *.sqlfiles.sql 文件中的路径？

在我工作的解决方案中，sqlcmdvar 中有两个名为 Path1 和 Path2 的自定义变量，我认为它们是执行此操作的保留名称。但是，这在我的解决方案中不起作用，两个解决方案之间的区别在于另一个解决方案是通过 TFS 构建控制器部署的。执行 TFS 构建控制器路由并不是一个真正的选择，因为我在使用第三方源代码控制服务时选择退出以节省资金。

对此的任何帮助都会很棒。我什至为调试和发布创建单独的 *.sqlfiles.sql 文件，并将 dbproj 文件配置为根据配置使用其中一个或另一个，但这似乎也不起作用。此外，使用 sqlfile.sql 文件中的自定义 PATH1 变量（如 FILENAME = '$(PATH1)\Cameleon_log.ldf'）也不起作用。我认真地认为这不应该这么难。我在这里错过了一些简单的东西吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T14:36:02.813

好吧，这是徒劳的练习。显然，在脚本生成期间没有与目标数据库同步，该脚本正是从头开始构建数据库所需要的。即使我可以覆盖文件路径，部署也会抱怨数据库对象已经存在。我需要在部署设置中指定目标数据库的连接字符串，以便在脚本生成期间进行比较，并且只将相关差异添加到脚本中。我真的很想避免将我的生产 SQL 服务器暴露给外界，但事实就是如此。不再需要覆盖路径，因为在此比较过程中看起来数据库文件路径被方便地忽略了！！

# java - 无法使用 4.x Android NFC API 推送 NdefMessage

> ID：10081852
> 
> 赞同：0
> 
> 时间：2012-04-10T01:12:11.447
> 
> 标签：java, android, nfc

我正在实现 CreateNdefMessageCallback 和 OnNdefPushCompleteCallback。由于某种原因，回调方法从未被触及，日志上也没有错误。

我确实听到了来自 API 的声音，我正在调试的手机是运行 4.0.4 版的 Nexus S。

这是我的活动：

```
public class TestActivity extends Activity implements CreateNdefMessageCallback, OnNdefPushCompleteCallback
{
  private static SoundHelper soundHelper;

  private PowerManager.WakeLock wakeLock;

  private NfcAdapter nfcAdapter;
  private PendingIntent pendingIntent = null;
  private IntentFilter[] intentFiltersArray;
  private String[][] techListsArray;

  private TextView onScreenLog;
  private List<String> uniqueTagsRead = new ArrayList<String>();

  /** handler stuff */
  private static final int MESSAGE_SENT = 1;
  private final Handler handler = new Handler()
  {
    @Override
    public void handleMessage(Message msg)
    {
      switch (msg.what)
      {
        case MESSAGE_SENT:
          if (soundHelper != null)
          {
            soundHelper.playSound(R.raw.smw_coin);
          }

          updateTagCount();
          break;
      }
    }
  };

  /** Called when the activity is first created. */
  @Override
  public void onCreate(Bundle savedInstanceState)
  {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.test);

    soundHelper = new SoundHelper(this);

    onScreenLog = (TextView) findViewById(R.id.log);

    // nfc adapter
    nfcAdapter = NfcAdapter.getDefaultAdapter(this);
    if (nfcAdapter != null)
    {
      // callbacks
      nfcAdapter.setNdefPushMessageCallback(this, this);
      nfcAdapter.setOnNdefPushCompleteCallback(this, this);

      // other stuff
      nfcAdapter = NfcAdapter.getDefaultAdapter(this);
      pendingIntent = PendingIntent.getActivity(this, 0, new Intent(this, getClass()).addFlags(Intent.FLAG_ACTIVITY_SINGLE_TOP), 0);
      IntentFilter ndef = new IntentFilter(NfcAdapter.ACTION_NDEF_DISCOVERED);
      try
      {
        ndef.addDataType("*/*");
      }
      catch (MalformedMimeTypeException e)
      {
        throw new RuntimeException("fail", e);
      }
      intentFiltersArray = new IntentFilter[] {ndef, };
      techListsArray = new String[][] {
          new String[] { IsoDep.class.getName() },
          new String[] { NfcA.class.getName() },
          new String[] { NfcB.class.getName() },
          new String[] { NfcF.class.getName() },
          new String[] { NfcV.class.getName() },
          new String[] { Ndef.class.getName() },
          new String[] { NdefFormatable.class.getName() },
          new String[] { MifareClassic.class.getName() },
          new String[] { MifareUltralight.class.getName() },
      };
    }
    else
    {
      onScreenLog.setText("NFC is not available on this device. :(");
    }
  }

  public void onPause()
  {
    super.onPause();

    // end wake lock
    wakeLock.release();

    nfcAdapter.disableForegroundDispatch(this);
  }

  public void onResume()
  {
    super.onResume();

    // start wake lock
    PowerManager powerManager = (PowerManager) getSystemService(Context.POWER_SERVICE);
    wakeLock = powerManager.newWakeLock(PowerManager.FULL_WAKE_LOCK, "DoNotDimScreen");
    wakeLock.acquire();

    nfcAdapter.enableForegroundDispatch(this, pendingIntent, intentFiltersArray, techListsArray);
  }

  private void updateTagCount()
  {
    String newCount = String.valueOf(uniqueTagsRead.size());
    String text = getString(R.string.format_count);
    text = getString(R.string.format_count).replace("0", newCount);

    onScreenLog.setText(text);
  }

  @Override
  public NdefMessage createNdefMessage(NfcEvent event)
  {
    String message = "This is NFC message";
    NdefRecord mimeRecord = createMimeRecord("application/param.android.sample.beam",
    message.getBytes());
    NdefRecord appRecord = NdefRecord.createApplicationRecord("param.android.sample.beam");
    NdefRecord[] ndefRecords = new NdefRecord[] {
    mimeRecord,
    appRecord
    };
    NdefMessage ndefMessage = new NdefMessage(ndefRecords);
    return ndefMessage;

    /*
    String mimeType = "text/plain"; // "text/plain";

    NdefRecord[] data = {createMimeRecord(mimeType, TEXT_TO_WRITE.getBytes())};
    // data[data.length - 1] = NdefRecord.createApplicationRecord(); // com.test.nfc.application.activities.

    return new NdefMessage(data);
    */
  }

  /**
   * Creates a custom MIME type encapsulated in an NDEF record
   *
   * @param mimeType
   */
  public NdefRecord createMimeRecord(String mimeType, byte[] payload)
  {
    byte[] mimeBytes = mimeType.getBytes(Charset.forName("US-ASCII"));
    NdefRecord mimeRecord = new NdefRecord(NdefRecord.TNF_MIME_MEDIA, mimeBytes, new byte[0], payload);

    return mimeRecord;
  }

  @Override
  public void onNdefPushComplete(NfcEvent event)
  {
    handler.obtainMessage(MESSAGE_SENT).sendToTarget();
  }
} 
```

显现：

```
 <uses-sdk android:minSdkVersion="14" />

    <supports-screens android:anyDensity="true" /> 

    <uses-permission android:name="android.permission.NFC"/>
    <uses-permission android:name="android.permission.INTERNET"/>
    <uses-permission android:name="android.permission.WAKE_LOCK" />

    <uses-feature android:name="android.hardware.nfc" />

    <application android:name="com.test.nfc.application.Application"
        android:icon="@drawable/icon_launcher_nfc_droid_hdpi"
        android:theme="@android:style/Theme.Light"
        android:label="@string/app_name">

        <activity
            android:label="@string/app_name"
            android:name=".application.activities.MainActivity"
            android:configChanges="orientation|keyboardHidden">
            <intent-filter >
                <action android:name="android.intent.action.MAIN" />
                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>

        <activity
            android:label="@string/test"
            android:name=".application.activities.TestActivity"
            android:configChanges="orientation|keyboardHidden"
            android:launchMode="singleTop">

            <intent-filter>
              <action android:name="android.nfc.action.TECH_DISCOVERED"/>
            </intent-filter>
            <meta-data android:name="android.nfc.action.TECH_DISCOVERED" android:resource="@xml/nfc_tech_list" />

        </activity>

    </application>

</manifest> 
```

技术专家

```
<?xml version="1.0" encoding="utf-8"?>
<resources xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
    <tech-list>
        <tech>android.nfc.tech.IsoDep</tech>
        <tech>android.nfc.tech.NfcA</tech>
        <tech>android.nfc.tech.NfcB</tech>
        <tech>android.nfc.tech.NfcF</tech>
        <tech>android.nfc.tech.NfcV</tech>
        <tech>android.nfc.tech.Ndef</tech>
        <tech>android.nfc.tech.NdefFormatable</tech>
        <tech>android.nfc.tech.MifareClassic</tech>
        <tech>android.nfc.tech.MifareUltralight</tech>
    </tech-list>
</resources> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T20:20:33.603

从您的问题和示例代码中，我并不完全清楚您是要接收 NDEF 消息、发送它们还是两者兼而有之。

使用 时`NfcAdapter.enableForegroundDispatch()`，您的 Activity 将通过调用 获得有关新 NFC 意图的通知`onNewIntent()`，因此您应该在 Activity 中覆盖该方法以*接收*意图。

`NfcAdapter.CreateNdefMessageCallback`并`NfcAdapter.OnNdefPushCompleteCallback`用于通过 Android Beam*将NDEF 数据发送到另一个 NFC 设备。*用户需要点击屏幕来激活发送 NDEF 消息，这将导致调用`createNdefMessage()`和`onNdefPushComplete()`。

还有一点要注意：如果您将`null`过滤器和 techLists 参数传递给`NfcAdapter.enableForegroundDispatch()`它将充当通配符（因此您不需要像现在一样声明完整的技术列表）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T16:32:36.400

看起来您获得了两次默认的 NFC 适配器？

nfcAdapter = NfcAdapter.getDefaultAdapter(this);

您在检查 nfcAdapter 上的 null 之前执行一次，然后在您的 if 语句中再次执行此操作。这可能会产生一些奇怪的影响。不过我不确定。此外，您似乎正在运行时声明意图过滤器。如果您仍然有问题，请在清单中执行此操作以进行调试。更容易确定某些东西以这种方式正确过滤了意图。

有关更多示例，请参阅此示例代码和 SDK 中的 Android Beam 示例：

[http://developer.android.com/guide/topics/nfc/nfc.html#p2p](http://developer.android.com/guide/topics/nfc/nfc.html#p2p)

# ruby-on-rails - 在 rails 3.1 的 routes.rb 中“get controller/action”有什么用？

> ID：10081853
> 
> 赞同：0
> 
> 时间：2012-04-10T01:12:15.093
> 
> 标签：ruby-on-rails, ruby-on-rails-3.1, routes

生成控制器时，rails 会自动将“get controller/action”放在 routes.rb 文件的顶部，用于每个资源丰富的操作（例如索引、新建、创建、编辑等）。这个'get'的目的是什么？由于在 routes.rb 中有相同模型的“资源”，我们可以摆脱这个“获取”吗？routes.rb 中的“放置”自定义操作是否需要“获取”？

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T01:20:44.307

您可以安全地删除该路线。

Rails 3.1 中基本资源路由的正确布局遵循以下格式：

```
resources :users do # Provides GET /users, /users/new, /users/:id, /users/:id/edit, POST /users, PUT /users/:id, DELETE /users/:id
  # Additional routes which return collections (not CRUD)
  collection do
    get :search # /users/search
  end

  # Additional routes which return single models (not CRUD)
  member do
    put :add_friend # /users/:id/add_friend
  end
end 
```

您可以在此处阅读完整的 Rails 路由指南：http: [//guides.rubyonrails.org/routing.html](http://guides.rubyonrails.org/routing.html)

# iphone - 强制 UIVIew 为当前设备方向布置自己

> ID：10081858
> 
> 赞同：0
> 
> 时间：2012-04-10T01:13:07.450
> 
> 标签：iphone, ios, cocoa-touch

我已经为此工作了好几天，但无法破解它。事件的顺序是：

*   在横向（假设正确）中，用户点击“编辑”按钮。
*   一个只有纵向的模态界面滑入。它的 shouldAutorotateToInterfaceOrientation 只为纵向返回 yes。
*   设备确信它处于纵向模式。
*   问题 1：如果用户在没有实际旋转到纵向模式的情况下关闭界面，则设备报告该界面处于横向右侧（确实如此），但界面布局为纵向。
*   问题2：如果用户旋转到纵向，界面不会重新布局。
*   问题 3：（这很奇怪）旋转回到按下编辑按钮的相同横向（右）会导致状态栏返回横向，但没有其他任何变化。我所有的东西都保持纵向模式。旋转到另一个（左）横向效果很好。

我需要一些方法来强制布局引擎为设备实际所处的方向重做布局。

UIView - layoutSubviews, - setNeedsLayout 和 -layoutIfNeeded 没有任何作用。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T01:29:27.820

执行 iBooks (2.x) 的操作并强制界面方向为纵向 `+ (void)attemptRotationToDeviceOrientation`。这样，您就可以在第一步中将问题扼杀在萌芽状态。

# javascript - 与特定 span 标签一起使用的 jQuery 和选择器

> ID：10081859
> 
> 赞同：-3
> 
> 时间：2012-04-10T01:13:22.647
> 
> 标签：javascript, jquery, html, selector, html-manipulation

## jQuery 选择器

### 选择特定的跨度标签

我在使用 jQuery 的选择器时遇到了这个问题。这是几个小时的问题。它无法选择我想要操作的特定跨度标签，这就是为什么我一直在用这个标签挠头。

我的目标是为每个具有不同样式值的 span 标签添加不同的类。因此我几乎成功了，我无法弄清楚如何为每个跨度标签添加不同的类，所以我最终一无所知。

我基本上希望字体大小为 180% 的跨度位于特定类中并不重要，这实际上是因为如果代码有效，我可以稍后更改它。另一个字体大小为 100% 的 span 标签也应该有一个类，另一个类。我希望你能更清楚我现在想要做什么，至少这是我所希望的。

代码存在于下面的链接中，请随时发布修复程序，并且可以选择但不需要解释为什么它不起作用！谢谢你。

jQuery提交：[JS Bin Post](http://jsbin.com/ipocos/2/edit "JS斌邮政")

这也是代码本身。

```
 var val1 = "font-size: 180%";
    var val2 = "font-size: 100%";
    var title = $("span").attr("style");

    $(function(){
    if ($("span:contains('font-size: 100%')")) {
      $('span').addClass("text_shadow2");
      if ($('span').has("text_shadow1")) {
         $('span').removeClass("text_shadow1");
      }
    }
        if ($("span:contains('font-size: 180%')")) {
           $('span').addClass("text_shadow1");
           if ($('span').has("text_shadow2")) {
               $('span').removeClass("text_shadow2");
           }
        }
        },function(){
        if ($("span:contains('font-size: 100%')")) {
        $('span').addClass("text_shadow2");
        if ($('span').has("text_shadow1")) {
              $('span').removeClass("text_shadow1");
           }
        }
        if ($("span:contains('font-size: 180%')")) {
        $('span').addClass("text_shadow1");
            if ($('span').has("text_shadow2")) {
               $('span').removeClass("text_shadow2");
               }
        }
    });

    if ($(val1==title)) {alert("1\. "+title);} 
    if ($(val2==title)) {alert("2\. "+title);} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T01:32:54.560

你可以做这样的事情来解析样式属性。浏览器不会将 font-size 属性设置为百分比，而是会进行计算

```
$('span').filter(function(){
    return $(this).attr('style').match('180%');
}).addClass('someClass'); 
```

演示：http: [//jsfiddle.net/AbZBD/](http://jsfiddle.net/AbZBD/)

# mysql - 如何根据 CASE 语句的值编写 WHERE 语句？

> ID：10081860
> 
> 赞同：3
> 
> 时间：2012-04-10T01:13:30.617
> 
> 标签：mysql

以下查询返回`new_name`表中所有的结果集`names`

```
SELECT
    CASE
        WHEN nickname = '' THEN fullname ELSE nickname END AS new_name,       
    FROM names 
```

我正在尝试`new_name`使用以下查询进行搜索

```
SELECT
    CASE
        WHEN nickname = '' THEN fullname ELSE nickname END AS new_name,       
    FROM names
    WHERE new_name LIKE '%Joh%' 
```

但是我得到了错误

**“where 子句”中的未知列“new_name”**

有没有办法让这个功能在不使用子查询的情况下工作？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-10T01:18:07.047

如果您`case`在`where`子句中重复，该语句将起作用：

```
SELECT
CASE
    WHEN nickname = '' THEN fullname ELSE nickname END AS new_name      
FROM names
WHERE (CASE WHEN nickname = '' THEN fullname ELSE nickname END) LIKE '%Joh%' 
```

它不会很快，因为它不会使用索引，但它应该可以工作。

一个更好的方法如下：

```
SELECT
CASE
    WHEN nickname = '' THEN fullname ELSE nickname END AS new_name      
FROM names
WHERE (nickname like '%Joh%') or (fullname LIKE '%Joh%') 
```

这将返回相同的结果，但它可以使用索引`nickname`，`fullname`如果您定义它们，**编辑**并将第二个操作数更改`LIKE`为不使用前导`%`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-10T01:18:36.990

```
SELECT
    CASE
        WHEN nickname = '' THEN fullname ELSE nickname END AS new_name,       
    FROM names
    WHERE 
       (CASE
        WHEN nickname = '' THEN fullname ELSE nickname END) LIKE '%Joh%'; 
```

用整个替换列名`case ... when ... then ... end`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-10T01:26:26.113

对我来说，使用合并功能更有意义，假设昵称要么是要么`NULL`填充......

```
SELECT COALESCE(nickname,filename)
FROM   table
WHERE COALESCE(nickname,filename) LIKE '%JOE%' 
```

# c++ - Flash 客户端 AS3 套接字、C++ 服务器

> ID：10081863
> 
> 赞同：1
> 
> 时间：2012-04-10T01:13:56.373
> 
> 标签：c++, flash

我一直在尝试在 AS3 中编程套接字，但我遇到了一些问题。

我正在使用 C++ 服务器和 Flash AS3 客户端。这是我在第一场比赛中的糟糕尝试，所以这里什么都没有。我的编程经验很少，所以请多多包涵。

这是我从服务器发送到客户端（十六进制）的内容：

**S** = Packet Size, **C** = Content, **H** = Header（基本上告诉客户端这个包做了什么）

```
S  H  C..
06 02 00 00 00 00
06 03 D1 13 01 07
02 04 
```

但是，当我的 flash 客户端收到信息时，它是这样接收的：

```
S  H  C..
06 02 00 00 00 00
06 03 D1 13 01 07
06 03 D1 13 01 07 -- weird duplicate?
02 04 
```

我不知道为什么其中一条消息是重复的！我在我的 C++ 服务器上的写入函数中放置了一个 trace()，看起来我肯定会发送一次，但我的 Flash 客户端读取它两次。

```
s.addEventListener(ProgressEvent.SOCKET_DATA, sData);
function sData(e:ProgressEvent):void
{
    while(true){
        try {

            GetByte(); //packet size, im ignoring it for now
            parsePacket();
        }
        catch (error:Error)
        {
            trace(error);
            break;
        }
    }
}
function parsePacket()
{
    var header:uint = GetByte();
    trace("New Packet: ", header);
    switch (header){
        case 0x01:
            //dostuffwithcontent
            break;

        case 0x02:
            //i use it 4 times so there is no "leftover"
            //i actually do stuff with the bytes in real code, but this is only to make it easier to read
            GetByte();GetByte();GetByte();GetByte();
            break;

        case 0x03:
            //this is called twice
            //Flash is reading the same info 2 times from the socket, even though it has only been sent once.
            GetByte();GetByte();GetByte();GetByte();
            break;

        case 0x04:
            trace("last packet received");
            break;

        default:
            break;

    } 
}

function GetByte():uint{return socket_.readUnsignedByte();} 
```

这是我用来发送信息的 C++ 函数，我在每个“数据包”之后调用它一次。

```
void outputMessage(NetworkMessage& msg)
{
    std::cout << msg.size() << std::endl; //never called more than required, and always shows correct size
    boost::asio::async_write(socket_,boost::asio::buffer(msg.getOutputBuffer(), msg.size()),boost::bind(&Session::handle_write, this,boost::asio::placeholders::error));
} 
```

我究竟做错了什么？我不明白为什么 Flash 从套接字读取它两次。

将不胜感激任何帮助，谢谢。

**更新：好的，我终于想出了如何在 Windows 上嗅探本地主机流量，事实证明，服务器发送了两次消息，这不是客户端的错 :D 每个数据包生成后，函数 outputMessage 只调用一次，但由于某种原因，同一个数据包仍然被设置了两次。我想这是一个与提升相关的问题，而不是 Flash。**

更新2：我修好了！！！这是一件非常非常愚蠢的事情，我什至不知道这是错误的。在服务器端，我有一些类似的东西：

```
NetworkMessage msg;
msg.AddByte(0x03);
outputMessage(msg);

NetworkMessage msg;
msg.AddByte(0x04);
outputMessage(msg); 
```

显然有一个错误，因为两个变量具有相同的名称，所以我尝试了这个，而不是仅仅更改该死的名称（这显然是错误的，因为程序有一些奇怪的副作用）：

```
{
    NetworkMessage msg;
    msg.AddByte(0x03);
    outputMessage(msg);
}
NetworkMessage msg;
msg.AddByte(0x04);
outputMessage(msg); 
```

我觉得好傻。真的很抱歉浪费了你的时间...

# c++ - C++ 编译错误 - 未知类型名称

> ID：10081869
> 
> 赞同：-1
> 
> 时间：2012-04-10T01:14:24.020
> 
> 标签：c++, data-structures, compiler-errors

对于我的 CS 任务，我们要实现一个二进制堆来替换她工作程序上的 STL 优先级队列，这是第一部分。对于第二部分，我们必须使用多态性重新实现它。我完成了第一部分，我所做的只是将所有类分成自己的头文件和源文件，我得到了大量的错误。在 xcode 上，它显示未知类型名称“事件”。

我尝试更改#ifndef 的东西（对不起，我不知道它叫什么），但没有运气。

任何帮助将不胜感激，谢谢。

大卫

* * *

我正在使用 xcode，但这是来自终端的错误消息：

```
In file included from ModemSimV2.h:5,
                 from Event.h:4,
                 from Event.cpp:1:
EventHeap.h:18: error: expected ‘,’ or ‘...’ before ‘&amp;’ token
EventHeap.h:18: error: ISO C++ forbids declaration of ‘Event’ with no type
EventHeap.h:19: error: ISO C++ forbids declaration of ‘Event’ with no type
EventHeap.h:19: error: expected ‘;’ before ‘*’ token
EventHeap.h:23: error: ISO C++ forbids declaration of ‘Event’ with no type
EventHeap.h:23: error: expected ‘;’ before ‘*’ token
In file included from Event.h:4,
                 from EventHeap.h:8,
                 from EventHeap.cpp:1:
ModemSimV2.h:11: error: ‘EventHeap’ has not been declared
ModemSimV2.h:23: error: ISO C++ forbids declaration of ‘EventHeap’ with no type
ModemSimV2.h:23: error: expected ‘;’ before ‘*’ token
EventHeap.cpp: In constructor ‘EventHeap::EventHeap()’:
EventHeap.cpp:6: error: call of overloaded ‘Event()’ is ambiguous
Event.h:10: note: candidates are: Event::Event(int, int)
Event.h:9: note:                 Event::Event()
EventHeap.cpp: In constructor ‘EventHeap::EventHeap(int)’:
EventHeap.cpp:12: error: call of overloaded ‘Event()’ is ambiguous
Event.h:10: note: candidates are: Event::Event(int, int)
Event.h:9: note:                 Event::Event()
EventHeap.cpp: In member function ‘void EventHeap::buildHeap(int)’:
EventHeap.cpp:40: error: call of overloaded ‘Event()’ is ambiguous
Event.h:10: note: candidates are: Event::Event(int, int)
Event.h:9: note:                 Event::Event() 
```

* * *

主.cpp：

```
#include <queue>
#include <vector>
#include <functional>  // for greater()
#include <climits>     // for INT_MAX
#include <iostream>
#include "random.h"
#include "ModemSimV2.h"
#include "Event.h"
#include "EventHeap.h"

using namespace std;

// Simple main to test ModemSim class.
int main( )
{
    int numModems;
    int totalTime;
    double avgConnectTime;
    int dialInFrequency;

    cout << "Enter number of modems, length of simulation,\n"
    << " average connect time, how often calls occur: ";

    cin >> numModems >> totalTime >>
    avgConnectTime >> dialInFrequency;

    EventHeap eHeap( numModems );
    ModemSimV2 s( numModems, avgConnectTime, dialInFrequency, eHeap );
    s.runSim( totalTime );

    return 0;
} 
```

事件.h：

```
#ifndef EVENT_P2_H
#define EVENT_P2_H

#include "ModemSimV2.h"

class Event{
    //enum { DIAL_IN = 1, HANGUP = 2 };
public:
    Event( );
    Event( int name = 0, int tm = 0 );

    bool operator > ( const Event & rhs ) const;
    bool operator < ( const Event & rhs ) const;
    bool operator <= ( const Event & rhs ) const;
    bool operator != ( const Event & rhs ) const;

    //void process( ModemSimV2 m );

    friend class ModemSimV2;

private:
    int who;        // the number of the user
    int time;       // when the event will occur
    int what;       // DIAL_IN or HANGUP
};

/*
class Dialin : public Event{

public:
    Dialin( );
    void process( ModemSimV2 m );
};*/
#endif 
```

* * *

事件.cpp：

```
#include "Event.h"

Event::Event( ) {

}

Event::Event( int name, int tm )
: time( tm ), who( name ) { 
    return;
}

bool Event::operator > ( const Event & rhs ) const { 
    return time > rhs.time; 
}

bool Event::operator < ( const Event & rhs ) const { 
    return time < rhs.time; 
}

bool Event::operator <= ( const Event & rhs ) const { 
    return time < rhs.time; 
}

bool Event::operator != ( const Event & rhs ) const { 
    return time != rhs.time; 
} 
```

* * *

事件堆.h：

```
#ifndef BINARY_HEAP_P2_H
#define BINARY_HEAP_P2_H

#include <iostream>
#include <cmath>
#include <vector>

#include "Event.h"

class EventHeap{
public:
    EventHeap( );
    EventHeap( int numIndex );

    bool empty( ) const;
    const int & findMin( ) const;

    void push( const Event & x );
    Event * pop();

private:
    int size;         // Number of elements in heap
    Event *array;            // The heap array

    void buildHeap( int index );
    void reIndex( int hole );
    int getLeft( int index ) const;
    int getRight( int index )const;
    int getParent( int index )const;
};

#endif 
```

* * *

事件堆.cpp：

```
#include "EventHeap.h"

//Constructor
EventHeap::EventHeap( ) {

    array = new Event[1];
    size = 0;
}

EventHeap::EventHeap( int numVals ) { 

    array = new Event[numVals];
    size = 0;
}

//insert
void EventHeap::push( const Event &e ) {

    array[size] = e;
    reIndex( size );
    size++;
}

//removes the min val   
Event* EventHeap::pop( ) {

    Event *e = &array[0];
    array[0] = array[size - 1];
    size--;
    if( !empty( ) )
        buildHeap(0);

    return e;
}

//re do
void EventHeap::buildHeap( int nodeIndex ) {

    int leftChildIndex, rightChildIndex, minIndex;
    Event tmp;

    leftChildIndex = getLeft(nodeIndex);

    rightChildIndex = getRight(nodeIndex);

    if (rightChildIndex >= size) {

        if (leftChildIndex >= size)

            return;

        else

            minIndex = leftChildIndex;

    } else {

        if (array[leftChildIndex] <= array[rightChildIndex])

            minIndex = leftChildIndex;

        else

            minIndex = rightChildIndex;

    }

    if (array[nodeIndex] > array[minIndex]) {

        tmp = array[minIndex];

        array[minIndex] = array[nodeIndex];

        array[nodeIndex] = tmp;

        buildHeap(minIndex);

    }
}

//re index
void EventHeap::reIndex( int hole ) {

    while( array[hole] != NULL && array[hole] <  array[getParent( hole )] ) {
        int pIndex = getParent( hole );
        Event temp( array[hole] );
        array[hole] = array[pIndex];
        array[pIndex] = temp;
        hole = pIndex;
    }
}

//is Empty
bool EventHeap::empty() const {
    return ( size == 0 );
}

int EventHeap::getLeft( int index ) const {
    return ( index * 2 ) + 1;
}

int EventHeap::getRight( int index ) const {
    return ( index * 2 ) + 2;
}

int EventHeap::getParent( int index ) const {
    return ( index - 1 ) / 2;
} 
```

* * *

ModemSimV2.h

```
#ifndef MODEM_SIM_V2_H
#define MODEM_SIM_V2_H

#include "Event.h"
#include "EventHeap.h"
#include "random.h"

class ModemSimV2{
public:
    ModemSimV2( int modems, double avgLen, int callIntrvl, EventHeap e );
    // Add a call to eventSet at the current time,
    // and schedule one for delta in the future.
    void nextCall( int delta );

    // Run the simulation
    void runSim( int stoppingTime );// = INT_MAX );

    // friend class Event;

private:
    Random r;                       // A random source
    EventHeap *eventSet;                    // Pending events

    // Basic parameters of the simulation
    int freeModems;                 // Number of modems unused
    const double avgCallLen;        // Length of a call
    const int freqOfCalls;          // Interval between calls
};

#endif 
```

* * *

ModemSimV2.cpp

```
#include "ModemSimV2.h"

// Constructor for ModemSim.
ModemSimV2::ModemSimV2( int modems, double avgLen, int callIntrvl, EventHeap e )
: freeModems( modems ), avgCallLen( avgLen ),
freqOfCalls( callIntrvl ), r( (int) time( 0 ) )
{
    eventSet = &e;
    nextCall( freqOfCalls );  // Schedule first call
}

// Place a new DIAL_IN event into the event queue.
// Then advance the time when next DIAL_IN event will occur.
// In practice, we would use a random number to set the time.
void ModemSimV2::nextCall( int delta ){
    static int nextCallTime = 0;
    static int userNum = 0;

    eventSet->push( Event( userNum++, nextCallTime ) );
    nextCallTime += delta;
}

// Run the simulation until stopping time occurs.
void ModemSimV2::runSim( int stoppingTime ){
    Event *e;

    while( !eventSet->empty( ) ){
        e = eventSet->pop();
        if ( e->time > stoppingTime )
            break;
        //e->process( this );
        nextCall( freqOfCalls );
    }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-10T01:20:27.443

`Event.h`包括`ModemSimV2.h`. `ModemSimV2.h`包括`Event.h`. 没有一点帮助是行不通的。

您应该阅读[前向声明](http://www-subatech.in2p3.fr/~photons/subatech/soft/carnac/CPP-INC-1.shtml)。有关更多信息，请参阅[此 StackOverflow 问题](https://stackoverflow.com/questions/553682/when-to-use-forward-declaration)。

# html - 浏览器中的灵活 HTML 地图

> ID：10081871
> 
> 赞同：0
> 
> 时间：2012-04-10T01:14:28.863
> 
> 标签：html, map, responsive-design

我正在尝试在一个新项目中构建响应式 HTML 设计。一切都很好，除了 HTML 地图。我发现了动态生成 HTML 地图以及背景 PNG 图像的方式，因此服务器端的灵活性不是问题。但是有没有办法获得客户端的灵活性（通过 CSS、HTML 或 JS）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T05:25:07.293

我再次回答我自己的问题）））也许我的解决方案对某人有用......

```
<script type="text/javascript">
    GLOBAL_ARRAYCOORDS= new Array();
    GLOBAL_WIDTH=1;
    GLOBAL_ARRAYAREAS= new Array();

    function getglobal(){ 
        GLOBAL_ARRAYAREAS = document.body.getElementsByTagName("AREA");
        GLOBAL_WIDTH= 600; //document.getElementById("mapimage").naturalWidth;
        for(var i = 0; i < GLOBAL_ARRAYAREAS.length; i++) {
            GLOBAL_ARRAYCOORDS[i]= GLOBAL_ARRAYAREAS[i].coords;
        }
    }

    function scaleArea() {   
        for(var i = 0; i < GLOBAL_ARRAYAREAS.length; i++) {
            ii=i+1;
            rescale= document.getElementById("mapimage").width/GLOBAL_WIDTH ;
            sarray=GLOBAL_ARRAYCOORDS[i].split(",");      
            var rarray =new Array();
            for(var j = 0; j < sarray.length; j++) {
                rarray[j]=parseInt(sarray[j])*rescale;  
                rarray[j]=Math.round(rarray[j]);
            }
            GLOBAL_ARRAYAREAS[i].coords=rarray.join(",");
        }
    }

    window.onresize = function() {
        scaleArea();
    };
</script>

<img src="/catalog/europe.png" id="mapimage" usemap="#sueurope" onload="getglobal(); scaleArea();" />
<map id="sueurope" name="sueurope">
    <area alt="ru" coords="296,1, 296,8, ..." href="/catalog/ru" shape="poly"/>
    <area ...
</map> 
```

**GLOBAL_WIDTH**是硬编码的，因为Opera 和 IE 不支持**naturalWidth 。**我也不能使用**宽度**，因为地图是按比例缩放的，我必须知道**europe.png**的绝对宽度。所以，现在地图是完全灵活的！感谢 John S. Urban[的研究](http://home.comcast.net/~urbanjost/IMG/resizeimg.html)。

# javascript - 为什么 jasmine-node 没有选择我的帮助脚本？

> ID：10081882
> 
> 赞同：10
> 
> 时间：2012-04-10T01:16:03.187
> 
> 标签：javascript, unit-testing, testing, node.js, jasmine

这个问题可能是基于我以前缺乏使用 node.js 的经验，但我希望 jasmine-node 能让我从命令行运行我的 jasmine 规范。

测试助手.js：

```
var helper_func = function() {
    console.log("IN HELPER FUNC");
}; 
```

my_test.spec.js：

```
describe ('Example Test', function() {
  it ('should use the helper function', function() {
    helper_func();
    expect(true).toBe(true);
  }); 
}); 
```

这些是目录中仅有的两个文件。然后，当我这样做时：

```
jasmine-node . 
```

我明白了

```
ReferenceError: helper_func is not defined 
```

我确信这个问题的答案很简单，但我没有在 github 上找到任何超级简单的介绍或任何明显的内容。任何建议或帮助将不胜感激！

谢谢！

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-04-10T02:41:52.607

在节点中，所有内容都被命名为它的 js 文件。要使其他文件可以调用该函数，请将 TestHelper.js 更改为如下所示：

```
var helper_func = function() {
    console.log("IN HELPER FUNC");
};
// exports is the "magic" variable that other files can read
exports.helper_func = helper_func; 
```

然后将您的 my_test.spec.js 更改为如下所示：

```
// include the helpers and get a reference to it's exports variable
var helpers = require('./TestHelpers');

describe ('Example Test', function() {
  it ('should use the helper function', function() {
    helpers.helper_func(); // note the change here too
    expect(true).toBe(true);
  }); 
}); 
```

最后，我相信`jasmine-node .`会按顺序运行目录中的每个文件 - 但您不需要运行帮助程序。相反，您可以将它们移动到不同的目录（并将`./`中的更改`require()`为正确的路径），或者您可以只运行`jasmine-node *.spec.js`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2017-03-02T04:44:40.057

如果您将 jasmine 配置为：

```
{
  "spec_dir": "spec",
  "spec_files": [
    "**/*[sS]pec.js"
  ],
  "helpers": [
    "helpers/**/*.js"
  ],
  "stopSpecOnExpectationFailure": false,
  "random": false
} 
```

helpers/ 文件夹中的所有内容都将在 Spec 文件之前运行。在帮助文件中有这样的东西来包含你的功能。

```
beforeAll(function(){
  this.helper_func = function() {
  console.log("IN HELPER FUNC");
  };
}); 
```

然后，您将能够在您的规范文件中引用它

# model-view-controller - Zend 框架嵌套控制器

> ID：10081886
> 
> 赞同：0
> 
> 时间：2012-04-10T01:16:35.430
> 
> 标签：model-view-controller, zend-framework, frameworks, controller, nested

Zend 框架嵌套控制器

我想知道是否可以使用嵌套控制器。

## 我有一个应用程序，它有一个带有左栏和右栏的页面。

* * *

```
 | --TAB----TAB----TAB--
   MyGroups   |
              | 
```

* * *

因此，我希望有一个控制器作为整个页面的包装器，然后将 myGroups 控制器用于左侧栏，对于右侧，有许多选项卡会根据某些选择显示。所以我想为每个选项卡设置一个控制器。

这是一个非常大的应用程序，每个选项卡都可以做很多其他事情。所以我想为每个选项卡以及左侧的 myGroups 设置单独的控制器/模型/视图/布局。

解决此问题的最佳方法是什么。如果您也给我一些代码结构，我将不胜感激。

非常感谢。亚历克斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T04:47:03.770

您可以在布局中为每个或您的左右栏使用[Action view-helper 。](http://framework.zend.com/manual/en/zend.view.helpers.html#zend.view.helpers.initial.action)但是这样做的缺点是您会引发三个完整的服务器调用（完整的引导和调度周期）来呈现单个页面。我认为这是一个非常重要的缺点，特别是如果每​​个栏都需要自己的数据库连接。

另一种方法是为您的左右栏使用[前端控制器插件。](http://framework.zend.com/manual/en/zend.view.helpers.html)在引导程序中注册它们，给它们一个`postDispatch()`钩子，该钩子可以访问/生成它们需要的任何数据，并将该数据放入布局/视图中。然后你的布局呈现内容，而不需要知道它是如何到达那里的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T05:01:05.933

如果您使用 David 建议的“action view-helper”，您总是可以将这些 ajax 放入以获得更好的用户体验 - 因此用户可以在等待页面的其余部分时阅读当前加载的内容。

# haskell - Reactive-Banana 中溢出函数的事件处理顺序是什么？

> ID：10081890
> 
> 赞同：6
> 
> 时间：2012-04-10T01:16:46.057
> 
> 标签：haskell, frp, reactive-banana

我对此进行了测试，似乎事件处理的顺序与源事件中列表的顺序相同。我不认为我可以依赖它，因为文档仅说明：

> 发出同时发生的事件。严格来说，我们有溢出。收集 = id

如何使用以下规范创建类似于溢出的函数：

> 发出连续的事件发生，并保证在第一个和最后一个之间不会触发其他事件

还是我应该尝试不同的方法？我正在尝试在 Reactive-Banana 中实现宏功能

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-10T07:28:27.750

（我是反应香蕉的作者。）

> 似乎事件处理的顺序与源事件中列表的顺序相同。

这是正确的，你可以依赖它。事实上，它或多或少是从等式得出的`spill . collect = id`。毕竟，要产生恒等映射，`spill`必须保持事件的顺序，就像`collect`将它们放在列表中一样。

此外，您可以检查模块的源代码`Reactive.Banana.Model`（`Reactive.Banana.Internal.Model`在 0.5 版中）和`Reactive.Banana.Combinators`. 综合起来，他们给出了一个权威的模型实现。您可以直接检查`spill`行为方式。（虽然这可能有点令人困惑，因为模型是由两部分组成的。）

尽管如此，我将在文档中添加几句话。

# c++ - 为 HalfEdge Mesh 加速 .obj 文件加载器的方法？

> ID：10081891
> 
> 赞同：1
> 
> 时间：2012-04-10T01:16:47.793
> 
> 标签：c++, opengl, wavefront

我正在开发一个 3D OpenGL (C++) 应用程序，其中我有自己的基于半边数据结构的网格结构。我想构建一种简单的方法来将 Wavefront obj 文件加载到我的网格结构中。当然，我可以逐行天真地这样做，但必须有一些更有效的方法（我知道专业应用程序不会天真地逐行加载文件，对于数百万个顶点来说太慢了）。

谁能指点我一个教程或一个非常快速的 OBJ 加载器的例子？如果它与半边数据结构有关，那将是更可取的。

编辑：

我希望解决两个基本问题

1) 避免从文件中读取浮点数的一般缓慢

2）我如何智能地动态确定每个边缘的“相邻”半边。我正在想象某种散列函数来确定正在创建的边的对称边或下一条边是否已经存在，如果存在，则使用该指针。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T01:33:47.833

读取和解码 ascii 文件很慢，尤其是当文件有一百万个浮点数要转换时。

我的想法：用你想要的任何语言编写一个程序，将 .obj 文件翻译成二进制格式，你的程序可以或多或少地直接读入内存。然后在您要加载的 .obj 文件上运行该程序，并让您的程序加载翻译后的文件。

对于额外的点，您可以让您的 opengl 程序即时执行此翻译并缓存结果，检查文件修改时间并根据需要更新缓存。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-13T02:56:22.507

不久前我在加载 OBJ 文件时遇到了类似的问题，尽管我正在搜索共享顶点而不是边。由于文件格式本身不包含连接信息，因此最好的方法是使用`std::set`. 每次您想向数据结构添加边时，您都可以搜索该集合以查看它是否已经存在。集合搜索在复杂性上是对数的，因此它可以很好地随着数据结构的大小而扩展。我能想到的避免这种情况的唯一方法是选择包含所需连接信息的文件格式，或者按照 Michael Slade 的建议创建自己的格式和转换工具。

# c# - 使用哪个 Windows IDE 编写、执行和调试单文件 C# 程序？

> ID：10081897
> 
> 赞同：3
> 
> 时间：2012-04-10T01:18:00.867
> 
> 标签：c#, windows, ide

我使用 Visual Studio 2010 进行 C# 开发。但是，白天有很多次我需要快速尝试一些 C# 代码来试验或学习新东西。我可以把它写成一个**功能齐全的 C# 程序在一个文件**中。现在，我可以使用 Visual Studio 编写/编辑这个 C# 文件，但它不支持执行或调试（断点、监视变量），除非我为它创建解决方案。

我希望能够**创建**、**编辑**、**执行**（并希望**调试**）单个 C# 文件，而不必在每次需要尝试时都经历创建 VS 解决方案的痛苦。**Windows 上是否有一个简单的 C# IDE，我可以在其中执行此操作？**

IDE 不应创建任何项目/解决方案文件。这样我就可以拥有一个包含 C# 文件的目录，每个文件都是一个完整的 C# 程序，并且我可以随时使用这个 IDE 打开每个文件进行读取、编辑和执行。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-10T01:21:11.307

**[LinqPad](http://www.linqpad.net/)**可以执行可能是单个文件大小的表达式、语句或小程序（另请参阅[此](http://www.linqpad.net/CodeSnippetIDE.aspx)页面）。它不会像您正在寻找的那样创建项目/解决方案文件。如果您愿意，只需打开、编码和保存即可。我使用免费版本来测试我在这个网站上发布的代码。

它支持 .Net 4.0 并具有其他一些不错的功能，例如不需要显式指定 using 语句。该程序足够聪明，可以知道您需要哪些程序。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-10T01:31:35.350

尝试[片段编译器](http://www.sliver.com/dotnet/SnippetCompiler/)

![在此处输入图像描述](../Images/8a3276910dd8928b0f284e2c0e594eda.png)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-10T03:07:52.420

在 C# 和 Visual Studio 的下一个版本中，其中一个新功能是[Project Roslyn](http://msdn.microsoft.com/en-us/roslyn)，它是一种编译器即服务实现。结果是，这可以使用 .csx 文件在 C# 中编写脚本。[Visual Studio 博客在此处](http://blogs.msdn.com/b/visualstudio/archive/2011/10/19/introducing-the-microsoft-roslyn-ctp.aspx)提供了有关 .csx 文件的更多信息。

我自己没有太多使用 .csx 文件，但它们看起来类似于用于编写 F# 脚本的 .fsx 文件，因为您将通常放置在方法（在 F# 中，一个函数）中的代码放在顶部-level，并且可以使用散列来引入编译器指令（例如，#r 来引用 DLL）。

# javascript - 如何调试谷歌浏览器后台脚本？

> ID：10081898
> 
> 赞同：71
> 
> 时间：2012-04-10T01:18:05.940
> 
> 标签：javascript, debugging, background, google-chrome-extension

我有非常简单的扩展：

清单.json

```
{
  "name": "historyCleaner",
  "version": "0.1.1",
  "manifest_version": 1,
  "description": "This is my first Chrome extension",
  "background": {
    "scripts": ["cleaner.js"]
  }, 
  "permissions": [
    "history"
  ]
} 
```

清洁器.js

```
chrome.history.onVisited.addListener(function(HistoryItem result) {

  console.log("it works!");
  alert("it works!");

}); 
```

我已经在谷歌浏览器中加载了它，它已打开并且......它不起作用。它不会在控制台中记录任何内容，也不会发出任何警报，更糟糕的是，我在开发人员工具的“脚本”选项卡中找不到它。我怎样才能找到它为什么不起作用？

//编辑

我已将 manifest.json 更改为这个：

```
{
  "name": "historyCleaner",
  "version": "0.1.5",
  "manifest_version": 1,
  "description": "This is my first Chrome extension",
  "background_page": "background.html",
  "permissions": [
    "history",
    "background"
  ]
} 
```

并在 background.html 中嵌入 JavaScript

* * *

## 回答 #1

> 赞同：109
> 
> 时间：2012-04-10T01:35:01.343

![在此处输入图像描述](../Images/202d248a110e6e61c7f0d1b9c87b4abe.png)

而且如果你`console.log("it works!");`没有出现，那意味着`chrome.history.onVisited`还没有被解雇。

ps：对于`function(HistoryItem result)`，您可能想将其更改为`function(result)`。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-07-04T00:15:08.350

此响应可能会迟到，但会帮助其他人。如果你的 background.html 有 javascript 错误，那么页面将不会加载（检查）。

要找出你的 background.html 有什么问题，请在 chrome://chrome/extensions/（即管理扩展）下单击 background.html 链接。这将加载开发人员工具，但没有 background.html。在窗口的右下角，您将看到一个红色的错误符号，单击它会提供需要修复的行号。

# c# - 在 C# 中，如何准备一个对 Windows 目录名称有效的字符串

> ID：10081907
> 
> 赞同：6
> 
> 时间：2012-04-10T01:19:20.053
> 
> 标签：c#

我正在编写一个 C# 程序，它从文件中读取某些标签，并根据标签值创建一个目录结构。

现在这些标签里可能有任何东西，

如果标签名称不适合目录名称，我必须通过用任何合适的字符替换这些字符来准备它以使其适合。这样目录创建就不会失败。我正在使用以下代码，但我意识到这还不够..

```
path = path.replace("/","-");
path = path.replace("\\","-"); 
```

请告知最好的方法是什么..

谢谢，

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-10T02:15:12.253

导入 System.IO 命名空间并用于路径使用

```
Path.GetInvalidPathChars 
```

并用于文件名

```
Path.GetInvalidFileNameChars 
```

例如

```
string filename = "salmnas dlajhdla kjha;dmas'lkasn";

foreach (char c in Path.GetInvalidFileNameChars())
    filename = filename.Replace(System.Char.ToString(c), "");

foreach (char c in Path.GetInvalidPathChars())
    filename = filename.Replace(System.Char.ToString(c), ""); 
```

然后你可以使用 Path.Combine 添加标签来创建路径

```
string mypath = Path.Combine(@"C:\", "First_Tag", "Second_Tag"); 

//return C:\First_Tag\Second_Tag 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-10T01:21:48.103

[您可以在此处使用无效字符](http://msdn.microsoft.com/en-us/library/windows/desktop/aa365247%28v=vs.85%29.aspx#file_and_directory_names)的完整列表来根据需要处理替换。这些可通过[Path.GetInvalidFileNameChars](http://msdn.microsoft.com/en-us/library/system.io.path.getinvalidfilenamechars.aspx)和[Path.GetInvalidPathChars](http://msdn.microsoft.com/en-us/library/system.io.path.getinvalidpathchars.aspx)方法直接获得。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-10T01:40:33.633

您现在必须使用的字符是：`? < > | : \ / * "`

```
 string PathFix(string path)
    {
        List<string> _forbiddenChars = new List<string>();
        _forbiddenChars.Add("?");
        _forbiddenChars.Add("<");
        _forbiddenChars.Add(">");
        _forbiddenChars.Add(":");
        _forbiddenChars.Add("|");
        _forbiddenChars.Add("\\");
        _forbiddenChars.Add("/");
        _forbiddenChars.Add("*");
        _forbiddenChars.Add("\"");

        for (int i = 0; i < _forbiddenChars.Count; i++)
        {
            path = path.Replace(_forbiddenChars[i], "");
        }

        return path;
    } 
```

**提示：**不能包含双引号 ( `"`)，但可以包含 2 个引号 ( `''`)。在这种情况下：

```
 string PathFix(string path)
    {
        List<string> _forbiddenChars = new List<string>();
        _forbiddenChars.Add("?");
        _forbiddenChars.Add("<");
        _forbiddenChars.Add(">");
        _forbiddenChars.Add(":");
        _forbiddenChars.Add("|");
        _forbiddenChars.Add("\\");
        _forbiddenChars.Add("/");
        _forbiddenChars.Add("*");
        //_forbiddenChars.Add("\""); Do not delete the double-quote character, so we could replace it with 2 quotes (before the return).

        for (int i = 0; i < _forbiddenChars.Count; i++)
        {
            path = path.Replace(_forbiddenChars[i], "");
        }

        path = path.Replace("\"", "''"); //Replacement here
        return path;
    } 
```

**您当然会只使用其中之一（或将它们组合成一个带有 bool 参数的函数来替换引号，如果需要）**

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-10-26T19:17:14.970

[Nikhil Agrawal](https://stackoverflow.com/a/10082286/107625)的正确答案有一些语法错误。

仅供参考，这里是一个编译版本：

```
public static string MakeValidFolderNameSimple(string folderName)
{
    if (string.IsNullOrEmpty(folderName)) return folderName;

    foreach (var c in System.IO.Path.GetInvalidFileNameChars())
        folderName = folderName.Replace(c.ToString(), string.Empty);

    foreach (var c in System.IO.Path.GetInvalidPathChars())
        folderName = folderName.Replace(c.ToString(), string.Empty);

    return folderName;
} 
```

# ios - iOS：如何将文本从 UITextBox 保存到文件

> ID：10081909
> 
> 赞同：0
> 
> 时间：2012-04-10T01:19:32.857
> 
> 标签：ios

当用户按下按钮时，我想从文件中保存文本字符串。这个文件可以是 .plist 吗？然后，稍后，我想要另一个函数从文件中读取文本并将其转换为变量。这怎么可能？

尖酸刻薄

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-10T02:15:54.353

保存：

```
 NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
    NSString *documentsDirectory = [paths objectAtIndex:0];
    NSString *path = [documentsDirectory stringByAppendingString:@"/myFile.plist"];
    //Create the file if it doesnt exists
    if (![[NSFileManager defaultManager] fileExistsAtPath:path]){
           NSDictionary *emptyDic = [NSDictionary dictionary];
           [emptyDic writeToFile:path atomically:YES];
        }
    //Save the text using setObject for key or something similar, you could even use a NSArray instead
    NSDictionary *dic  = [[NSDictionary alloc]init];
    [dic writeToFile:path atomically:YES]; 
```

加载：

```
NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
NSString *documentsDirectory = [paths objectAtIndex:0];
NSString *path = [NSString stringWithFormat:@"%@/myFile.plist", documentsDirectory];
NSString *contents = [NSString stringWithContentsOfFile:path encoding:NSUTF8StringEncoding error:nil]; 
```

我认为您不能直接使用 .txt 文件，但我从未尝试过。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T02:20:38.573

如果您只想保存一些用户默认设置以供将来参考，请查看`NSUserDefaults`. 如果您真的只是想保存一些设置，则比处理文件更容易。

如果您真的想从文件中读取字符串，请转到您的 Xcode 管理器，转到文档，单击搜索图标，然后输入“Reading Strings From”，顶部链接之一将是如何读取和写入文件。

# ruby - open-uri Ruby 错误

> ID：10081913
> 
> 赞同：1
> 
> 时间：2012-04-10T01:20:23.323
> 
> 标签：ruby

我有代码：

```
require 'open-uri'
print "Enter a URL: "
add = gets
added = add.sub!(/http:\/\//, "")
puts "Info from:  #{add}"
open("#{add}") do |f|
  img = f.read.scan(/<img/)
  img = img.length
  puts "\t#{img} images"
  f.close
end
open("#{add}") do |f|
  links = f.read.scan(/<a/)
  links = links.length
  puts "\t#{links} links"
  f.close
end
open("#{add}") do |f|
  div = f.read.scan(/<div/)
  div = div.le1ngth
  puts "\t#{div} div tags"
  f.close
end 
```

（是的，我知道这不是好的代码，请不要评论它）当我运行它时，对于 URL，我输入，说：

```
http://stackoverflow.com 
```

我收到以下错误：

```
/System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/open-uri.rb:32:in `initialize': No such file or directory - http (Errno::ENOENT)
    from /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/open-uri.rb:32:in `open_uri_original_open'
    from /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/open-uri.rb:32:in `open' 
```

为什么会出现此错误，我该如何解决？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T01:40:30.590

该`String.sub!`方法将字符串替换到位，因此除了设置之外还`add.sub!(/http:\/\//, "")`更改了 的值。`add``added`

要将`open(name)`方法与 URI 一起使用， 的值`name`必须以 URI 方案开头，例如`http://`.

如果要设置`added`，请这样做：

```
added = add.sub(/http:\/\//, "") 
```

# asp.net-mvc - System.ComponentModel.DataAnnotations.AssociatedMetadataTypeTypeDescriptionProvider:.ctor (System.Type) 中的 IL 代码无效：方法主体为空

> ID：10081925
> 
> 赞同：0
> 
> 时间：2012-04-10T01:21:58.673
> 
> 标签：asp.net-mvc, asp.net-mvc-3, mono

我正在将 MVC3 项目部署到 Mono linux 机器上。我的骨架工作得非常好，但是当我开始填充一些模型、视图和控制器时，我得到了你在上面看到的错误。

似乎没有太多关于此的文档；我所看到的很少表明它找不到我的`System.ComponentModel.DataAnnotations`文件，但我已将 dll 设置为复制本地并将其添加到`_bin_deployableAssemblies`文件夹中，但没有成功。

好像我错过了一些简单的东西。有没有人猜到是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T12:42:37.067

`System.ComponentModel.DataAnnotations.dll`如果我在发布时不包含该文件，问题似乎就消失了。

# java - Java 计算器堆栈

> ID：10081926
> 
> 赞同：2
> 
> 时间：2012-04-10T01:22:00.247
> 
> 标签：java, calculator, stack

所以我的任务是设计一个简单的 GUI 计算器，使用堆栈数据结构来执行加法、减法、乘法和除法。计算器窗口应至少有两个面板 - 一个用于显示，另一个用于按钮（0 - 9、. 、+、-、X、/、=、C）。输入表达式后，将显示其后缀或前缀，然后显示结果。

```
import java.awt.*;
import java.awt.event.*;
import javax.swing.*;
import java.util.*;
import java.util.Stack;

public class JCalculator implements ActionListener {
JFrame jfrm;
JFrame jfrm2;
JTextField txt;
JLabel results;
String str = "";
Stack operands = new Stack();
char[] a = new char[0];
int used = 0;

JCalculator(){
    jfrm = new JFrame("JCalc");
    jfrm.getContentPane().setLayout(new GridLayout(0,1));
    jfrm.setSize(210,210);

   results = new JLabel("",SwingConstants.RIGHT);
   jfrm.getContentPane().add(results);
   jfrm.setLocation(400,300);
   jfrm.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

   JButton[] calbut= new JButton[14];
   String []but = {"7","8","9","/","4","5","6","*","1","2","3","-","0","C"
   };
   JButton equal = new JButton("=");
   JButton add = new JButton("+");

   JPanel jbutton = new JPanel();
   jbutton.setLayout(new GridLayout(4,3));
   for(int i=0; i< but.length;i++){
       jbutton.add(calbut[i] = new JButton(but[i]));

       calbut[i].addActionListener(this);
   }
   jbutton.add(equal);
   jbutton.add(add);

   equal.addActionListener(this);
   add.addActionListener(this);

   jfrm.getContentPane().add(jbutton);

    jfrm.setVisible(true);
}
public void actionPerformed(ActionEvent ae){
    char[] a = new char[0];
    int used = 0;
    if(used == a.length){
        char[] newa= new char[a.length + 1];
        for(int i = 0; i <used; i++) newa[i]= a[i];
        a= newa;
    }

    if(ae.getActionCommand().equals("1")){
        str = results.getText();
        results.setText(str + "1");
        operands.push(1);
    }
    if(ae.getActionCommand().equals("2")){
        str = results.getText();
        results.setText(str + "2");
        operands.push(2);
    }
    if(ae.getActionCommand().equals("3")){
        str = results.getText();
        results.setText(str + "3");
        operands.push(3);
    }
    if(ae.getActionCommand().equals("4")){
        str = results.getText();
        results.setText(str + "4");
        operands.push(4);
    }
    if(ae.getActionCommand().equals("5")){
        str = results.getText();
        results.setText(str + "5");
        operands.push(5);
    }
    if(ae.getActionCommand().equals("6")){
        str = results.getText();
        results.setText(str + "6");
        operands.push(6);
    }
    if(ae.getActionCommand().equals("7")){
        str = results.getText();
        results.setText(str + "7");
        operands.push(7);
    }
    if(ae.getActionCommand().equals("8")){
        str = results.getText();
        results.setText(str + "8");
        operands.push(8);
    }
    if(ae.getActionCommand().equals("9")){
        str = results.getText();
        results.setText(str + "9");
        operands.push(9);
    }
    if (ae.getActionCommand().equals("0")) {
        str = results.getText();
        results.setText(str + "0");
        operands.push(0);
    }
    if(ae.getActionCommand().equals("+")){
        str = results.getText();
        double operand = Double.parseDouble(str);
        operands.push(operand);
        results.setText("");
        a[used]= '+';
        used++;

    }
    if(ae.getActionCommand().equals("-")){
        str = results.getText();
        double operand = Double.parseDouble(str);
        operands.push(operand);
        results.setText("");
        a[used]= '+';
        used++;
    }
    if(ae.getActionCommand().equals("/")){
        str = results.getText();
        double operand = Double.parseDouble(str);
        operands.push(operand);
        results.setText("");
        a[used]= '+';
        used++;
    }
    if(ae.getActionCommand().equals("*")){
        str = results.getText();
        double operand = Double.parseDouble(str);
        operands.push(operand);
        results.setText("");
        a[used]= '*';
        used++;
    }
    if(ae.getActionCommand().equals("=")){

        for(int i = 0; i< used; i++){
           performBinaryOp(a[i]);
        }

        str = String.valueOf(operands.pop());
        results.setText(str);
    }

}
 public void performBinaryOp(char nextOperation) {
     double leftOperand, rightOperand;
    Double result = new Double(0);
    rightOperand = (Double) operands.pop();
    leftOperand = (Double) operands.pop();
    switch (nextOperation) {
        case '+':
            result = new Double(leftOperand + rightOperand);
            break;
        case '-':
            result = new Double(leftOperand - rightOperand);
            break;
        case '*':
            result = new Double(leftOperand * rightOperand);
            break;
        case '/':
            result = new Double(leftOperand / rightOperand);
            break;
    }
    operands.push(result);
}

public static void main(String[] args)
{
    SwingUtilities.invokeLater(new Runnable() {
        public void run() {
            new JCalculator();                
        }            
    });        
}
} 
```

我遇到的错误是按下等号按钮时，例如按下 2+3= 它返回第一个值 2.0 然后我收到一条错误消息：

```
Exception in thread "AWT-EventQueue-0" java.util.EmptyStackException
at java.util.Stack.peek(Unknown Source)
at java.util.Stack.pop(Unknown Source)
at JCalculator.actionPerformed(JCalculator.java:152)
at javax.swing.AbstractButton.fireActionPerformed(Unknown Source)
at javax.swing.AbstractButton$Handler.actionPerformed(Unknown Source)
at javax.swing.DefaultButtonModel.fireActionPerformed(Unknown Source)
at javax.swing.DefaultButtonModel.setPressed(Unknown Source)
at javax.swing.plaf.basic.BasicButtonListener.mouseReleased(Unknown Source)
at java.awt.Component.processMouseEvent(Unknown Source)
at javax.swing.JComponent.processMouseEvent(Unknown Source)
at java.awt.Component.processEvent(Unknown Source)
at java.awt.Container.processEvent(Unknown Source)
at java.awt.Component.dispatchEventImpl(Unknown Source)
at java.awt.Container.dispatchEventImpl(Unknown Source)
at java.awt.Component.dispatchEvent(Unknown Source)
at java.awt.LightweightDispatcher.retargetMouseEvent(Unknown Source)
at java.awt.LightweightDispatcher.processMouseEvent(Unknown Source)
at java.awt.LightweightDispatcher.dispatchEvent(Unknown Source)
at java.awt.Container.dispatchEventImpl(Unknown Source)
at java.awt.Window.dispatchEventImpl(Unknown Source)
at java.awt.Component.dispatchEvent(Unknown Source)
at java.awt.EventQueue.dispatchEventImpl(Unknown Source)
at java.awt.EventQueue.access$000(Unknown Source)
at java.awt.EventQueue$1.run(Unknown Source)
at java.awt.EventQueue$1.run(Unknown Source)
at java.security.AccessController.doPrivileged(Native Method)
at java.security.AccessControlContext$1.doIntersectionPrivilege(Unknown Source)
at java.security.AccessControlContext$1.doIntersectionPrivilege(Unknown Source)
at java.awt.EventQueue$2.run(Unknown Source)
at java.awt.EventQueue$2.run(Unknown Source)
at java.security.AccessController.doPrivileged(Native Method)
at java.security.AccessControlContext$1.doIntersectionPrivilege(Unknown Source)
at java.awt.EventQueue.dispatchEvent(Unknown Source)
at java.awt.EventDispatchThread.pumpOneEventForFilters(Unknown Source)
at java.awt.EventDispatchThread.pumpEventsForFilter(Unknown Source)
at java.awt.EventDispatchThread.pumpEventsForHierarchy(Unknown Source)
at java.awt.EventDispatchThread.pumpEvents(Unknown Source)
at java.awt.EventDispatchThread.pumpEvents(Unknown Source)
at java.awt.EventDispatchThread.run(Unknown Source) 
```

我很确定我的问题是我有一个空堆栈，但我不确定代码哪里出错或如何修复它，所以任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-10T01:32:31.933

我建议您将 Swing 和 UI 放在一边，直到您的计算器正常工作。创建一个单独的 Calculator 类，它可以接收文本字符串并对其进行评估。一旦你有这个工作，然后添加一个用户界面。

是的，您遇到了堆栈问题，正如异常告诉您的那样：

```
at JCalculator.actionPerformed(JCalculator.java:152) 
```

在文本编辑器中打开您的 JCalculator，打开行号显示，然后转到第 152 行。这就是您的问题所在。

我不愿意通读您发布的代码，但我想说使用调试器快速旋转应该很快就能清除它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T01:37:43.773

您的`actionPerformed()`方法[隐藏](http://en.wikipedia.org/wiki/Variable_shadowing)了一些类变量；请注意，您已经重新声明了`char [] a`and `int used`，因此您的代码几乎肯定不会像您预期的那样运行。我还没有按照这个得出合乎逻辑的结论。

```
public class JCalculator implements ActionListener {
JFrame jfrm;
JFrame jfrm2;
JTextField txt;
JLabel results;
String str = "";
Stack operands = new Stack();
char[] a = new char[0];
int used = 0;
/* ... */
public void actionPerformed(ActionEvent ae){
    char[] a = new char[0];
    int used = 0;
    if(used == a.length){
        char[] newa= new char[a.length + 1];
        for(int i = 0; i <used; i++) newa[i]= a[i];
        a= newa;
    } 
```

这段代码让我觉得你不接受两位数：

```
if(ae.getActionCommand().equals("1")){
    str = results.getText();
    results.setText(str + "1");
    operands.push(1);
} 
```

`operands.push(1)`可能需要推送正在构建的数字*，*而不仅仅是最近的数字。（当然，如果您的意图是只支持一位数，这看起来没问题。）

我建议尝试`if`用一个函数替换这十个小语句。花时间在这里找出一个函数是非常值得的，它将大大简化将来对这段代码的维护，并且技能是*至关重要*的。（我想建议你`JButton`早点考虑一下你的整洁初始化——并尝试在你的替换函数中使用数组。这可能不是*最好*的，但应该没问题。）

```
if(ae.getActionCommand().equals("/")){
    str = results.getText();
    double operand = Double.parseDouble(str);
    operands.push(operand);
    results.setText("");
    a[used]= '+';
    used++;
} 
```

你会注意到你`a[used]`被分配了*错误的符号*。一旦您解决了变量阴影问题，*这*将是一个问题。尝试找出一种方法来`if`用另一个函数替换这四个块 - 同样，在向计算器添加新运算符时会更难犯这样的错误，并且会更容易修复运算符应用代码中的错误，因为您只需要修复一个位置的错误。

我不能过分强调将代码分解为“最小的合理”函数是多么有用。你可以比大函数更容易地测试小函数，而且你的代码将来会更容易阅读。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-04-10T01:36:57.830

以防万一您需要计算器方面的帮助，这是我在 Java 中的第一个项目之一

[https://github.com/orefalo/ExpressionEvaluator](https://github.com/orefalo/ExpressionEvaluator)

# php - 如何使用类外部的数组在 __construct 内定义静态变量？

> ID：10081928
> 
> 赞同：1
> 
> 时间：2012-04-10T01:22:14.540
> 
> 标签：php, class, static

我的大脑已经没电了，我的搜索技能也随之耗尽（我没有找到我正在寻找的 100% 的答案）。话虽这么说，我有一个类，里面是一个空的静态变量 $title，我需要在 __construct 中定义它，但它似乎无法通过全局获取它。让我们只显示一些代码，好吗？

```
$arg = array( my data is here );
class Article
{
    static $title;

    public function __construct()
    {
        global $arg;
        self::$title = $arg['title'];
    }

    public static function title()
    {
        return self::$title;
    }
} 
```

我的最终目标是简单地做

```
echo Article::title(); 
```

获取文章的标题。但正如我之前提到的，我没有这样的运气。感谢所有帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-10T01:32:02.347

尽管我同意@Amber 的评论，但您可以做您想做的事情，但是您不能为此使用构造函数，因为您不一定要实例化一个对象：

```
$arg = array( my data is here );
class Article
{
    static $title;

    static function set_static()
    {
        global $arg;
        self::$title = $arg['title'];
    }

    public static function title()
    {
        return self::$title;
    }
}
Article::set_static(); 
```

我也会将该值作为参数传递，但这不会改变它的工作方式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T01:29:22.943

利用`Singleton`

```
$arg = array("title"=>" my data is here ");
class Article
{
    static $title;
    static $instance = null ; 

    public function __construct()
    {
        self::$title = $GLOBALS['arg']['title'];
    }

    public static function getInstance()
    {
        if(self::$instance === null)
        {
            self::$instance =  new self();
        }

        return self::$instance;
    }
    public static function title()
    {
        self::getInstance();
        return self::$title;
    }
}

var_dump(Article::title()); //Returns string ' my data is here ' (length=17)
var_dump(Article::getInstance()->title()); // Returns string ' my data is here ' (length=17) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-14T05:05:17.553

我使用一个静态函数，对于低效的变量加载，我让它访问一个私有或受保护的成员，如下所示：

```
$arg = array('title' => 'My Title');
class Article
{
    static function title()
    {
        global $arg;
        return $arg['title'];
    }

    // or if the var load is inefficient ...
    protected static $title_md5;
    static function title_md5()
    {
        if (!isset(self::$title_md5))
            self::$title_md5 = md5(self::title());
        return self::$title_md5;
    }
}
echo(
    'title = ' . Article::title() . "\n" . 
    'title_md5 = ' . Article::title_md5() . "\n"
); 
```

输出：

```
title = My Title
title_md5 = 5badc643b79fdda9775c45b46540afc0 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-10T01:31:21.403

你应该首先初始化它。
Static $title = ...
当你新建一个实例时，会调用方法--construct。

# c# - 在 C# 中更改 StreamReader 文件扩展名

> ID：10081939
> 
> 赞同：1
> 
> 时间：2012-04-10T01:23:21.497
> 
> 标签：c#, streamreader, file-extension

我正在制作一个使用条形码来存储与该项目相关的信息的项目。对于每个条形码，都有一个包含其信息的文本文件。例如，条形码 0000000025 的所有信息都存储在名为 0000000025.txt 的文件中。我希望能够将条形码输入到文本框中，它会告诉 StreamReader 根据条形码读取哪个文件。而不是手动编码 300 if else 语句，如下所示：`StreamReader("C:\\ITRS_equipment_log\\0000000025.txt");`

有没有办法告诉它

```
StreamReader("C:\\ITRS_equipment_log\\"*pull the barcode from the first textbox and put it here*".txt"); 
```

谢谢

```
private void buttonSubmit_Click(object sender, EventArgs e)
{      
    if (!String.IsNullOrEmpty(textBox1.Text))
    {
         textBox1.SelectionStart = 0;
         textBox1.SelectionLength = textBox1.Text.Length;

         TextReader textReader = new StreamReader("C:\\ITRS_equipment_log\\0000000025.txt");

         //model textbox receives the model of equipment associated with barcode in the text file
         modelTextbox.Text = textReader.ReadLine();

         //serial textbox receives the serial number of equipment associated with barcode in the text file
         serialTextbox.Text = textReader.ReadLine();

         //history textbox receives the history of equipment associated with barcode in the text file
         historyTextbox.Text = textReader.ReadToEnd();
         textReader.Close();

    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T01:26:21.777

这应该为您将条形码文本插入到文件名中：

```
TextReader textReader
    = new StreamReader(String.Format(@"C:\ITRS_equipment_log\{0}.txt", textBox1.Text)); 
```

# python - Python：编写程序来模拟沿字符串的一维波动

> ID：10081942
> 
> 赞同：1
> 
> 时间：2012-04-10T01:23:36.847
> 
> 标签：python, string, simulation, waveform

我正在开发一个程序，该程序模拟沿一维弦的波动以最终模拟不同的波包。我在“Python Scripting for Computational Science”一书中找到了一个程序，该程序声称可以描述波动，但我不确定如何实现它（这本书在 Google Books 上，不会显示之前/之后的文本代码）。

例如，我知道“f”是 x 和 t 的函数，“I”是 x 的函数，但实际需要哪些函数来产生波？

```
I= 
f= 
c= 
L= 
n=
dt=
tstop=

x = linespace(0,L,n+1) #grid points in x dir
dx = L/float(n)
if dt <= 0: dt = dx/float(c) #max step time
C2 = (c*dt/dx)**2  #help variable in the scheme
dt2 = dt*dt

up = zeros(n+1) #NumPy solution array
u = up.copy()   #solution at t-dt
um = up.copy()    #solution at t-2*dt

t = 0.0
for i in iseq(0,n):
u[i] +0.5*C2*(u[i-1] - 2*u[i] +u[i+1]) + \
    dt2*f(x[i], t)
um[0] = 0;   um[n] = 0

while t<= tstop:
t_old = t; t+=dt
#update all inner points:
for i in iseq(start=1, stop= n-1):
up[i] = -um[i] +2*u[i] + \
    C2*(u[i-1] - 2*u[i] + u[i+1]) + \
    dt2*f(x[i], t_old)

#insert boundary conditions
up[0] = 0; up[n] = 0
#updata data structures for next step
um = u.copy(); u = up.copy() 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T00:50:46.557

下面的代码应该可以工作：

```
from math import sin, pi
from numpy import zeros, linspace
from scitools.numpyutils import iseq

def I(x):   
    return sin(2*x*pi/L)  

def f(x,t): 
    return 0

def solver0(I, f, c, L, n, dt, tstop):
    # f is a function of x and t, I is a function of x
    x = linspace(0, L, n+1) # grid points in x dir
    dx = L/float(n)
    if dt <= 0: dt = dx/float(c) # max time step
    C2 = (c*dt/dx)**2 # help variable in the scheme
    dt2 = dt*dt

    up = zeros(n+1) # NumPy solution array
    u = up.copy() # solution at t-dt
    um = up.copy() # solution at t-2*dt

    t = 0.0
    for i in iseq(0,n):
        u[i] = I(x[i])
    for i in iseq(1,n-1):
        um[i] = u[i] + 0.5*C2*(u[i-1] - 2*u[i] + u[i+1]) + \
                dt2*f(x[i], t)

    um[0] = 0; um[n] = 0

    while t <= tstop:
          t_old = t; t += dt
          # update all inner points:
          for i in iseq(start=1, stop=n-1):
              up[i] = - um[i] + 2*u[i] + \
                      C2*(u[i-1] - 2*u[i] + u[i+1]) + \
                      dt2*f(x[i], t_old)

          # insert boundary conditions:
          up[0] = 0; up[n] = 0
          # update data structures for next step
          um = u.copy(); u = up.copy()
    return u

if __name__ == '__main__':

# When choosing the parameters you should also check that the units are correct

   c = 5100
   L = 1
   n = 10
   dt = 0.1
   tstop = 1
   a = solver0(I, f, c, L, n, dt, tstop) 
```

它返回一个数组，其中包含时间 tstop 以及我们解决方案网格中所有点的波浪值。

在将其应用于实际情况之前，您应该阅读波动方程和有限元方法以了解代码的作用。它可用于求波动方程的数值解：

```
Utt + beta*Ut = c^2*Uxx + f(x,t) 
```

这是物理学中最重要的微分方程之一。此 PDE 或波的解由一个函数给出，该函数是空间和时间的函数`u(x,t)`。

为了形象化波浪的概念，考虑两个维度，空间和时间。如果你固定时间，例如 t1，你会得到一个 x 的函数：

```
U(x) = U(x,t=t1) 
```

然而，在空间的特定点 x1 处，波是时间的函数：

```
U(t) = U(x=x1, t) 
```

这应该可以帮助您了解波的传播方式。为了找到解决方案，您需要施加一些初始条件和边界条件，以将所有可能的波限制为您感兴趣的波。对于这种特殊情况：

*   `I = I(xi)`是我们将施加以使扰动/波前进的初始力。
*   该术语`f = f(x,t)`解释了任何产生波浪的外力。
*   `c`是波速；它是一个常数（假设介质是均匀的）。
*   `L`是我们要求解 PDE 的域的长度；也是一个常数。
*   `n`是空间中的网格点数。
*   `dt`是一个时间步长。
*   `tstop`是停止时间。

# asp.net - 显示今天和之前 6 个月之间的记录

> ID：10081943
> 
> 赞同：3
> 
> 时间：2012-04-10T01:23:41.777
> 
> 标签：asp.net, sql, sql-server, sql-server-2008, tsql

我的 SQL`SELECT`语句有问题。基本上我想返回交易日期在今天日期和今天日期减去 6 个月之间的所有记录。

到目前为止我尝试过的是：

```
SELECT * FROM loan_ledger
WHERE trandate <= DATEADD(month,-6,GETDATE()) 
```

但它没有得到确切的结果。结果是返回日期如 2009 年或 2007 年，但我想要的是，如果今天的日期是 2012 年 4 月 9 日，结果必须是从该日期（2012 年 4 月 9 日）到 2012 年 4 月 9 日减去 6 个月（10 月9,2011）。仅有的。

到底是结果显示了过去的交易，但仍然显示我不想要的 2009 年、2001 年的记录！

有人能帮我吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T01:34:54.263

另一个答案很接近，但如果您使用的是 BETWEEN，如果您想包括今天，您将需要在日期中添加一个

```
select * from loan_ledger
where trandate BETWEEN dateadd(month,-6,getdate()) AND getdate()+1 
```

当在 getdate 之间使用时，它不会包括今天，除非你在 1 中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T01:28:28.940

只需更改您的 where 子句

```
select * from loan_ledger
where trandate >= dateadd(month,-6,getdate()) AND trandate <= getdate() 
```

问候。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-10T01:29:28.947

您的所有 where 声明都是“在日期早于 6 个月前获取信息”，而不是“从 6 个月前到今天获取内容”

尝试类似的东西

```
select * from loan_ledger
where trandate BETWEEN dateadd(month,-6,getdate()) AND getdate() 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-10T01:31:37.640

您要查询 trandate <= 6 个月前的行。毫无疑问，2007 年的每一次交易都符合这一标准。

如果您只想[在](http://msdn.microsoft.com/en-us/library/ms187922.aspx)今天和 6 个月前之间进行转换，请尝试

```
trandate between dateadd(month, -6, getdate()) and getdate() 
```

# javascript - 如何仅使用 Backbone 的 get 请求中的某个 dict？

> ID：10081949
> 
> 赞同：0
> 
> 时间：2012-04-10T01:24:26.573
> 
> 标签：javascript, backbone.js

我向 Backbone 公开了一个 API，它返回具有以下结构的用户配置文件：{id: 1, following: {...}}。我只想在“以下”属性中使用字典。我该怎么做？现在，我有一个带有 API URL 的模型。我有一个使用这个模型的集合。我在集合上执行 fetch()，但我只想在“以下”中使用字典。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-10T02:03:27.850

您应该使用[`parse`](http://documentcloud.github.com/backbone/#Model-parse)从响应中提取您想要的内容：

> **解析** `model.parse(response)`
> 
> **每当服务器返回模型的数据时，都会调用**parse**`fetch` ， in和`save`。该函数传递原始`response`对象，并应返回要在模型上设置的属性哈希。**

 **所以你会在你的模型中想要这样的东西：

```
parse: function(response) {
    return response.following;
} 
```**

# c++ - 用 boost::spirit::qi 重新合成中间值

> ID：10081951
> 
> 赞同：2
> 
> 时间：2012-04-10T01:24:39.467
> 
> 标签：c++, boost, boost-spirit

给定一个合成用户定义类型的语法，我如何编写另一个语法：

1.  重用第一个语法。
2.  使用第一种类型的基础值合成第二种不同的类型？

在下面的示例中，我按照 Boost Spirit 文档创建了一个解析器，`foo_parser`它合成了一个 type 的值`foo_struct`。我想编写第二个解析器，`bar_parser`它重用`foo_parser`但合成一个不同（但显然相似）的 type 值`bar_struct`。注释掉的我的幼稚示例会导致壮观的 g++ 烟花。:)

```
#include <boost/spirit/include/qi.hpp>
#include <boost/fusion/include/adapt_struct.hpp>

namespace s  {
  using namespace boost::spirit;
  using namespace boost::spirit::qi;
  using namespace boost::spirit::ascii;
}

struct foo_struct {
  int i;
  char c;
};

BOOST_FUSION_ADAPT_STRUCT(
  foo_struct,
  (int, i)
  (char, c)
)

struct bar_struct {
  int i;
  char c;
  int j;
};

template <typename Iterator>
struct foo_parser : s::grammar<Iterator, foo_struct()>
{
  foo_parser() : foo_parser::base_type(start) {
    start %= s::int_ >> s::char_ ;
  }

  s::rule<Iterator, foo_struct()> start;
};

/*
BOOST_FUSION_ADAPT_STRUCT(
  bar_struct,
  (int, i)
  (char, c)
  (int, j)
)

template <typename Iterator>
struct bar_parser : s::grammar<Iterator, bar_struct()>
{
  bar_parser() : bar_parser::base_type(start) {
    // reuse a foo_parser
    start %= foo >> s::int_ ;
  }

  foo_parser<Iterator> foo;
  s::rule<Iterator, bar_struct()> start;
};

*/ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T08:09:03.857

我以前设计过这个 - 有点 - 解决问题的方法

```
struct mybase { int a,b; };
struct myderived : mybase 
 { 
    mybase& base;
    int c,d; 

     myderived() : base(*this) { }
};

BOOST_FUSION_ADAPT_STRUCT(mybase,    (int,a)(int,b));
BOOST_FUSION_ADAPT_STRUCT(myderived, (mybase,base)(int,c)(int,d)); 
```

我更喜欢基于 BOOST_FUSION_ADAPT_ADT 的解决方案，但我无法让它工作，另请参阅 [spirit-general] 邮件列表：

*   [http://boost.2283326.n4.nabble.com/struct-derived-struct-fusion-adapted-and-the-sequence-operator-td4259090.html](http://boost.2283326.n4.nabble.com/struct-derived-struct-fusion-adapted-and-the-sequence-operator-td4259090.html)
*   或[在列表中搜索`derived base`](http://boost.2283326.n4.nabble.com/template/NamlServlet.jtp?macro=search_page&node=2672582&query=derived+base)

这是一个完整的示例：

```
#include <boost/spirit/include/qi.hpp>
#include <boost/fusion/adapted.hpp>

struct mybase             { int a,b; };
struct myderived : mybase { 
    myderived() : base(*this) { }
    mybase& base;
    int c,d; 
};

BOOST_FUSION_ADAPT_STRUCT(mybase,    (int,a)(int,b));
BOOST_FUSION_ADAPT_STRUCT(myderived, (mybase,base)(int,c)(int,d));

int main()
{
    using namespace boost::spirit::qi;

    const char input[] = "1 2 3 4";
    const char *f(input), *l(f+strlen(input));

    rule<const char*, mybase()   , space_type> base_     = int_ >> int_;
    rule<const char*, myderived(), space_type> derived_  = base_ >> int_ >> int_;

    myderived data;
    bool ok = phrase_parse(f,l,derived_,space,data);

    if (ok) std::cout << "data: " << data.a << ", " << data.b << ", " << data.c << ", " << data.d << "\n";
    else    std::cerr << "whoops\n";

    if (f!=l)
        std::cerr << "left: '" << std::string(f,l) << std::endl;

    return 0;
} 
```

输出：

```
data: 1, 2, 3, 4 
```

# php - 你如何使用 mysql join 过滤掉整行？

> ID：10081954
> 
> 赞同：1
> 
> 时间：2012-04-10T01:24:58.343
> 
> 标签：php, mysql, sql, database

我想运行一个查询，从 2 个单独的表中选择用户尚未回答的最新问题。这就是我想出的：

```
SELECT Q.question_id, Q.question, S.user_id, S.question_id 
FROM questions Q inner join answers S on Q.question_id=S.question_id 
WHERE S.user_id != '$userID' 
```

这确实会过滤掉用户回答特定问题的行，但不幸的是，如果另一个用户回答相同的问题，它仍然会返回该问题。如果用户没有回答，我想消除一起返回的问题。

欢迎提出建议/想法，谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T01:58:45.593

您的问题太不清楚，并且缺乏信息。您需要包含表的架构、示例记录和所需的输出以使其更清晰。我认为您想选择尚未回答的问题：***我想运行一个查询来选择用户尚未回答的最新问题......***该语句将看起来像这样：

```
SELECT * FROM Questions WHERE CHAR_LENGTH(user_id) = 0; 
```

`CHAR_LENGTH`获取列中字符串的长度。`ZERO`当字段为空时返回。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-10T02:23:10.603

“选择所有未回答的问题`$userId`”：

```
SELECT Q.question_id, Q.question
FROM questions Q 
WHERE 
    Q.question_id NOT IN (
         /* Select all questions's ids, which have been answered by $userId */
         SELECT `question_id` 
         FROM `answer` 
         WHERE `answer`.`user_id` = '$userId'
    ) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-10T01:59:18.387

在这种情况下，左连接可能更合适：

```
SELECT Q.question_id, Q.question, S.user_id, S.question_id 
FROM questions Q 
LEFT JOIN answers S on Q.question_id=S.question_id AND S.user_id = '$userID'
WHERE s.user_id IS NULL 
```

这应该返回表 Q 中在表 S 中没有匹配记录的所有条目。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-10T01:37:17.397

也许是这样的？

```
SELECT Q.question_id, Q.question, S.user_id, S.question_id 
FROM questions Q
JOIN answers S ON Q.question_id=S.question_id 
WHERE 
    S.user_id NOT IN (
         SELECT user_id 
         FROM answers 
         WHERE question_id = Q.question_id
    )
    AND S.user_id = '$userID' 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-10T01:38:14.633

我认为您需要运行 2 个单独的查询，因为联接适用于具有独特属性的 2 个表。所以您无法将一堆答案与联接上的 1 个问题相匹配。

```
$query = mysql_query("select * from `answers` where `user_id` = '$bar'");

while ($rslt = mysql_fetch_assoc($query);) {
    $in_clause .= $rslt['question_id'].',';
}
$in_clause = substr($in_clause,0,-1);
$next_query = mysql_query("select * from `questions` where `question_id` !in(".$in_clause.")"); 
```

# android - Android：从消息对象中取回字符串矩阵

> ID：10081957
> 
> 赞同：0
> 
> 时间：2012-04-10T01:25:02.120
> 
> 标签：android, handler, message

这是问题所在：

```
private void doSomething() {
  String[][] data = new String[h][w];
  Message msg = null;
  Thread t = new Thread() {
     public void run() {
       for(int i=0; i<max; i++) {
          data = doLongCalculationOnBackground(i);

          msg = messageHandler.obtainMessage();
          msg.obj = data;
          messageHandler.sendMessage(msg);
       }
     }
  };
  t.start();
}

private Handler messageHandler = new Handler() {
    @Override
    public void handleMessage(Message msg) {
        doUpdateUI(msg.obj); // error right here!!!
    }

};

private doUpdateUI(String[][] data) {
   // do update UI work.
} 
```

Eclipse 警告 doUpdateUI(msg.obj) 不适用于参数 (Object)。

那么如何获取 Message 对象发送的字符串矩阵呢？请不要建议我使用异步任务。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T01:33:47.140

我很愚蠢，只需将参数 msg.obj 转换为 String[][]：

```
doUpdateUI((String[][]) msg.obj); 
```

# c++ - OpenCV：比较帧相似度的快速方法

> ID：10081960
> 
> 赞同：4
> 
> 时间：2012-04-10T01:25:17.183
> 
> 标签：c++, image, opencv, similarity

我正在寻找一种快速的方法来将帧与运行平均值进行比较，并确定它们之间的差异（如果它们非常相似则给出高值，如果它们不那么相似则给出较低值） . 我需要比较整个框架，而不仅仅是一个较小的区域。

我已经在图像上使用 Otsu 阈值来过滤背景（对背景不感兴趣，也不对前景的特征感兴趣 - 只需要形状）。有没有一种很好、快速的方法来做我想做的事？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-05T07:09:52.560

对此的*经典*方法是**归一化互相关**（尝试`cv::matchTemplate()`）。您需要设置一个阈值来确定图像是否匹配。您也可以使用输出（阈值）来比较多个图像。

在 OpenCV 中，matchTemplate 中的这个方法在[这里](http://opencv.itseez.com/doc/tutorials/imgproc/histograms/template_matching/template_matching.html#which-are-the-matching-methods-available-in-opencv)解释，以及你需要传递给函数的参数。

# jquery - jQuery 等待 if 语句完成

> ID：10081961
> 
> 赞同：0
> 
> 时间：2012-04-10T01:25:28.173
> 
> 标签：jquery, ajax

我在 javascript 中有两个 if 语句。我需要第二个 if 语句仅在执行第一个 if 语句之后运行（我不能将两个 if 语句放在彼此内部，因为第一个 if 语句有时会执行。否则，必须在第二个 if 语句运行之前检查第一个语句。 )

我该怎么做呢？

这是代码顺便说一句：

```
 if( $('#suggestion-'+change).html() == null )
    {       
        $.ajax({
            type: 'post',
            dataType: 'html',
            url: '/suggestion/ajax-change/',
            data: {type: change},
            success: function(result,status)
            {
                $('#profile_suggestion .content_wrapper').prepend(result);
            }
        });
    }

    if( active != change )
    {
        var panelShow = '#suggestion-' + change;
        var panelHide = '#suggestion-' + active;
        var dirShow = ''; var dirHide = '';

        switch( active )
        {
            case 'compatibility':
                dirHide = 'left';
                switch( change )
                {
                    case 'mutual':
                        dirShow = 'right';
                        break;
                }
            case 'mutual':
                switch( change )
                {
                    case 'compatibility':
                        dirHide = 'right';
                        dirShow = 'left';
                }
        }
        $(panelHide).hide("slide", { direction: dirHide }, 1000);
        $(panelShow).show("slide", { direction: dirShow }, 1000).removeClass('fader');
        $(panelHide).addClass('fader');
        active = change;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T01:29:57.350

添加`async: false`到 ajax 调用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T02:21:22.647

你对回调和异步代码有误解。

您需要将第二个 if 语句放入成功回调中。

```
$.ajax({
    type: 'post',
    dataType: 'html',
    url: '/suggestion/ajax-change/',
    data: {
        type: change
    },
    success: function(result, status) {
        $('#profile_suggestion .content_wrapper').prepend(result);
        if (active != change) {
            var panelShow = '#suggestion-' + change;
            var panelHide = '#suggestion-' + active;
            var dirShow = '';
            var dirHide = '';
            .....
        }
    }
});​ 
```

因为`xhr`（ajax）请求没有指定的响应时间，您无法准确猜测何时根据其响应运行另一个代码块。在这种情况下，您必须在完成的回调中执行代码`success`。

与其将第二个 if 语句的实际代码放入成功中，不如考虑放入另一个函数中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-10T01:28:33.140

嗯，你能把第二个变成一个函数并在成功时调用它吗？如果我误解了你的问题，我很抱歉..

或者你可以这样做

```
 $("something").bind('update', function() { do something you want to do });

   $.ajax({
        type: 'post',
        dataType: 'html',
        url: '/suggestion/ajax-change/',
        data: {type: change},
        success: function(result,status)
        {
            $('#profile_suggestion .content_wrapper').prepend(result);
        },
        complete: function() 
        {
            $("something").trigger('update');
         }
    }); 
```

# ajax - Jquery/Ajax 在 Safari 但不能在 Firefox 中工作

> ID：10081963
> 
> 赞同：0
> 
> 时间：2012-04-10T01:26:01.613
> 
> 标签：ajax, firefox

这是一个测试页面。有一个按钮，单击时应将整个外部页面 extern2.php 加载到内容 div 中。Extern2.php 可以在 Safari 和 Firefox 中使用，但是 index.php 只能在 Safari 中使用。

主页面：

```
<!doctype html>
<html>
<head>
<meta charset="utf-8" />
<title>jQuery Ajax Test</title>
<script type="text/javascript" src="jquery_1.6.1.js"></script>

<script type="text/javascript">
 function foo() {
         $('#content').load('extern2.php', function() {
  alert('Load was performed.');
});
  }
</script>

<meta name="robots" content="index, follow, noarchive" />
        <link rel="stylesheet" href="style.css" type="text/css" />

        <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3/jquery.min.js"></script>

</head>
<body>

<form action="<?php echo htmlentities($_SERVER['PHP_SELF']); ?>" method="post">
<input type="submit" name="formSubmit" value="Submit" />
</form>

        <?php
            if(isset($_POST['formSubmit'])) 
            {
       ?>

       <script type="text/javascript">
       $(document).ready(function() {
           $('#content').load('extern2.php');
       });
       </script>

        <?
            }
        ?>

<div id="content">Initial content in test.html</div>
</body>
</html> 
```

外部页面：

```
<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <title></title>
        <meta name="robots" content="index, follow, noarchive" />
        <link rel="stylesheet" href="style.css" type="text/css" />

        <!-- This includes the ImageFlow CSS and JavaScript -->
        <link rel="stylesheet" href="imageflow.packed.css" type="text/css" />
        <script type="text/javascript" src="imageflow.packed.js"></script>

        <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3/jquery.min.js"></script>

    </head>
    <body>

    <?php 
    // Connecting to database
    $con = mysql_connect('CONNECT INFO HERE');
    if (!$con)
      {
      die('Could not connect: ' . mysql_error());
      }

    mysql_select_db("CONNECT INFO HERE", $con);
    $userID=2;

    $getPage="SELECT * FROM pages,thumbnails WHERE thumbnails.thumbnailID=pages.thumbnailID AND pages.userID=".$userID." AND pages.projectID='8' LIMIT 3";
    $pageResult = mysql_query($getPage) or die(" ". mysql_error());
    ?>

    <!-- This is all the XHTML ImageFlow needs -->
    <div id="myImageFlow" class="imageflow">
        <? while($line = mysql_fetch_array($pageResult)) {
            $thumb = $line['fileName'];
            $title = $line['title'];
            $link = $line['url'];

            echo "<img src='../../thumbnails/small/".$thumb."' longdesc='".$link."' alt='".$title."' />";  
        }
        ?>

    </div>

    <?
    mysql_close($con);
    ?>

    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T01:49:47.040

错误控制台（CTRL-SHIFT-J）说什么？[Firebug](http://getfirebug.com/)也有帮助吗？

# android - 可见和不可见的布局

> ID：10081968
> 
> 赞同：0
> 
> 时间：2012-04-10T01:26:37.650
> 
> 标签：android, android-layout

我需要您对我的设计提出建议，如果您有更好的想法（或者您同意我的观点），那就太好了。出于某种原因，我觉得这是一种“石器时代的编程风格”，但让我们看看。

基本上我有我的 xml 相对布局。在中心（垂直和水平）。我想根据某些用户输入显示“任一”3 个按钮或 3 个文本。所以我做的是以下内容：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/mainLayout"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:clipChildren="false"
    android:clipToPadding="false" >

    <RelativeLayout android:id="@+id/Buttons"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:layout_centerHorizontal="true"
        android:layout_centerVertical="true" >
        <Button1 .../>
        <Button2 .../>
        <Button3 .../>
    </RelativeLayout>

    <RelativeLayout android:id="@+id/Texts"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:layout_centerHorizontal="true"
        android:layout_centerVertical="true" >
       <TextView1 .../>
       <TextView2.../>
       <TextView3.../>
    </RelativeLayout>

</RelativeLayout> 
```

根据代码中的用户输入，我将可见性设置为可见或不可见

这可以吗？如果不是，你有什么建议？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-10T01:38:04.837

您需要的是[View.GONE](http://developer.android.com/reference/android/view/View.html#GONE)和[View.VISIBLE](http://developer.android.com/reference/android/view/View.html#VISIBLE)。

使用 View.GONE - 布局不占用任何空间（几乎就像它根本不存在一样）。如果您使用 View.INVISIBLE，对用户来说，视图（按钮或文本）将不可见，但它们仍会出现在屏幕上，从而向上移动另一个视图（按钮或文本）或向下（视图不会处于死点）。

提示：您可以使用 'android:layout_centerInParent' 而不是 'android:layout_centerHorizo​​ntal' 和 'android:layout_centerVertical'。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-10T01:37:04.010

在我看来，您所做的可能很原始，但很简单，这很好:) 但是如果您仍然想要一些选择并使生活变得复杂，那么

1.  将每个块放在单独的 xml 中并使用`include`.
2.  制作 2 个视图，然后根据用户要求使用 ViewFlipper 翻转它们。

但是对于您的简单要求，我认为您做得很好。

include 选项会像这样工作，

布局_1.xml

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
        android:id="@+id/Buttons"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:layout_centerHorizontal="true"
        android:layout_centerVertical="true" >
        <Button1 .../>
        <Button2 .../>
        <Button3 .../>
</RelativeLayout> 
```

布局_2.xml

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
        android:id="@+id/Texts"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:layout_centerHorizontal="true"
        android:layout_centerVertical="true" >
       <TextView1 .../>
       <TextView2.../>
       <TextView3.../>
</RelativeLayout> 
```

你的 main_layout.xml

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/mainLayout"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:clipChildren="false"
    android:clipToPadding="false" >

    <include layout="@layout/layout_1" />
    <include layout="@layout/layout_2" />   

</RelativeLayout> 
```

这`include`可以帮助您制作可重用的布局，还有助于保持您的 xml 文件不成比例地增长，特别是当您有复杂的 UI 时。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-10T01:53:45.323

第一个选项是：

您可以在 Linearlayout 中添加所有三个按钮或文本视图，并使用`android:layout_centerInParent`.

第二种选择是：

您可以将所有三个按钮中的中间按钮居中，并分别调整其他两个按钮到中间按钮。同样，我们也应该对 textviews 重复此操作。在这个选项中，我们应该`View.GONE`明确地使所有三个视图可见。

# ruby-on-rails - 在 Rails 中更改单个控制器或操作的日志级别

> ID：10081971
> 
> 赞同：2
> 
> 时间：2012-04-10T01:27:24.440
> 
> 标签：ruby-on-rails, actioncontroller

我们正在 haproxy 后面运行一个 Rails 项目。每秒都会向应用程序发送一个保持活动状态。这会导致非常嘈杂的日志文件，这使得挖掘起来有点痛苦，并使它们变得不必要地大。

我的第一个想法是更改该操作的日志记录级别以进行调试，但其他人建议更改`around_filter`. 我对这个想法并不疯狂，但这可能就是我实现它的方式。我对不同的解决方案持开放态度，但一般要求是我可以让这些操作安静下来，但如果我出于任何原因需要查看它们，我可以更改日志记录级别。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-23T18:45:33.560

另一种解决方案是在进入 Rails ApplicationController 生命周期**之前**插入一些 Rack 中间件来处理保活检查。

步骤1：制作一些响应keep-alive检查的中间件。在我的示例中，keep-alive 请求是一个`GET /health-check`，所以它看起来像：

```
class HealthCheckMiddleware
  def initialize(app)
    @app = app
  end

  def call(env)
    if env['PATH_INFO'] == '/health-check'
      return [200, {}, ['healthy']]
    end
    @app.call(env)
  end
end 
```

当然，根据需要调整此运行状况检查。也许您需要检查其他请求/CGI 变量...

第 2 步：确保在**Rails::Rack::Logger**之前插入此中间件：

```
config.middleware.insert_before Rails::Rack::Logger, "HealthCheckMiddleware" 
```

现在您的中间件将处理健康检查，并且您的日志已被完全绕过。

# java - 用户注销后 JSessionID 未更改 - 这是安全问题吗？

> ID：10081973
> 
> 赞同：1
> 
> 时间：2012-04-10T01:27:39.903
> 
> 标签：java, security, servlets, weblogic

在我们的 WebLogic 应用程序的一些调试过程中，我注意到 JSESSIONID 在用户注销后并没有改变。

我试图了解这是否是我需要关注的事情。

此应用程序是在 WebLogic 实例中运行的两个应用程序之一，我注意到它们都共享相同的 JSESSIONID。

[这个问题](https://stackoverflow.com/a/598923/59015)参考了以下内容：

> SRV.7.3 会话范围
> 
> HttpSession 对象的范围必须在应用程序（或 servlet 上下文）级别。底层机制，例如用于建立会话的 cookie，对于不同的上下文可以是相同的，但引用的对象，包括该对象中的属性，决不能由容器在上下文之间共享。

这表明最终由 WegLogic 来选择如何管理这些 JSESSIONID 值，我不应该尝试从值的变化（或缺少值）中解释含义。

此外，我`HttpSessionListener`在应用程序上连接了一个，我看到该`sessionDestroyed`方法被调用。

鉴于这两个元素，对我来说 JSESSIONID 没有改变似乎是安全的。但是，这与我习惯的行为不同，因此想验证我的假设。

JSESSIONID 不变是安全问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-10T01:32:39.207

不，这不应该是一个巨大的安全问题，因为与该会话实际关联的所有数据都被丢弃了。这`JSESSIONID`只是那个（现在不存在的）数据的关键。

但是，如果您想`JSESSIONID`在每次注销/登录时更改，您可以实现您的注销功能，以便`JSESSIONID`在用户注销时显式删除 cookie。然后服务器将在他们的下一个请求中为他们分配一个全新的会话/ID。

当然，如文档中所述，如果您有多个上下文恰好都依赖于单个`JSESSIONID`cookie，那么从一个 cookie 中删除它实际上会将其从所有上下文中删除，从而有效地将用户从服务器上的每个上下文中注销。尽管在实践中，拥有多个面向用户的上下文并不常见，每个上下文都有自己的登录/会话状态。

# php - PHP Post变量不起作用

> ID：10081978
> 
> 赞同：-1
> 
> 时间：2012-04-10T01:28:49.567
> 
> 标签：php, android, mysql, post

我正在使用 android 应用程序将数据发送到 PHP 脚本。以下是 PHP 脚本。

telejoke.php：

```
<?php
  include 'JokeValidation.php';
  include 'DBConnect.php';

  $username = $_POST['username'];
  $joke = $_POST['joke'];
  $dbname = 'Telejoke';
  mysql_select_db($dbname);

  if (validate()){
    $query = "INSERT INTO jokes (username, joke) VALUES ('$username','$joke')";
    mysql_query($query) or die('Error, insert query failed');
  }
  mysql_close($conn);
?> 
```

笑话验证.php：

```
<?php
  include 'DBConnect.php';
  $dbname = 'telejoke';
  mysql_select_db($dbname);
  function validate(){
    if ($joke == null) return false;
    else if($username == null) return false;
   return true;
  }
?> 
```

出于某种原因，当我取出`if ($joke == null) return false;`和`else if($username == null) return false;`. 但是当我将这些语句放入 PHP 代码时，似乎 validate 返回 false。这很奇怪，因为当我取出这些语句时，$username 和 $joke 将进入我的数据库，这意味着它们不能为空！。

帮助表示赞赏。谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-10T01:35:47.837

您的验证函数需要访问 $joke 和 $username 对象。

```
function validate($joke, $validate) {
    if ($joke == null)
        return false;
    else if ($username == null)
        return false;
    return true;
} 
```

您还可以通过在 validate 方法中使用以下内容来访问这些变量：

```
global $joke, $username 
```

但是，最好声明您正在验证的内容，而不是依赖于在代码中其他地方声明和设置的那些变量。由于其他原因，使用 global 可能会静默失败。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-10T01:35:28.707

变量具有*函数作用域*。变量`$joke`和`$username`不存在于函数内部，因为您既没有声明也没有将它们传递给函数。使用函数参数：

```
function validate($joke, $username) {
   ...
}

if (validate($joke, $username)) {
   ...
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-10T01:36:08.160

`function validate($joke,$username)`

`postvars`另外，在将它们插入数据库之前过滤它们。

# php - 在没有正则表达式的情况下检测文本中一组单词的最有效方法

> ID：10081979
> 
> 赞同：1
> 
> 时间：2012-04-10T01:28:58.460
> 
> 标签：php

不幸的是，由于某些奇怪的原因，正则表达式方法不适用于 UTF-8 （[preg_replace + UTF-8 在一台服务器上不起作用，但在另一台服务器上起作用](https://stackoverflow.com/questions/10063874/preg-replace-utf-8-doesnt-work-on-one-server-but-works-on-another)）。

在不使用正则表达式的情况下实现我的目标的最有效方法是什么？

只是为了尽可能清楚，对于以下一组词：
猫，狗，天空

猫会返回假
天空是蓝色会返回真
天际会返回假

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T01:33:57.450

我最初的想法是在空格上爆炸文本，然后检查结果数组中是否存在您的单词。当然，您可能有一些标点符号泄漏到您的数组中，您也必须考虑这些。

另一个想法是检查`strpos`单词的。如果找到，请测试下一个字符是否为字母。如果是一封信，你就知道你找到了一个词的潜台词，并丢弃这个发现。

```
// Test online at http://writecodeonline.com/php/

$aWords = array( "I", "cat", "sky", "dog" );
$aFound = array();
$sSentence = "I have a cat. I don't have cats. I like the sky, but not skyrim.";

foreach ( $aWords as $word ) {
  $pos = strpos( $sSentence, $word );
  // If found, the position will be greater than or equal to 0
  if ( !($pos >= 0) ) continue;
    $nextChar = substr( $sSentence , ( $pos + strlen( $word ) ), 1 );
    // If found, ensure it is not a substring
    if ( ctype_alpha( $nextChar ) ) continue;
      $aFound[] = $word;
}

print_r( $aFound ); // Array ( [0] => I [1] => cat [2] => sky ) 
```

当然，更好的解决方案是确定为什么不能使用正则表达式，因为这些解决方案远没有模式搜索那么有效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T01:47:35.497

超级简短的例子，但这是我没有正则表达式的方式。

```
$haystack = "cats"; //"the sky is blue"; // "skyrim";
$needles = array("cat", "dog", "sky");

$found = false;
foreach($needles as $needle)
    if(strpos(" $haystack ", " $needle ") !== false) {
        $found = true;
        break;
    }

echo $found ? "A needle was found." : "A needle was not found."; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-04T01:15:35.353

如果您只是想查找一个单词是否在字符串中，您可以将字符串存储在变量中（如果打印字符串，则打印带有字符串的变量）并使用“in”。例子：

```
a = 'The sky is blue'
The in a
True 
```

# c - C：传递数组代替变量参数列表

> ID：10081980
> 
> 赞同：1
> 
> 时间：2012-04-10T01:29:00.957
> 
> 标签：c, exec, variadic-functions

我正在用 C 编写一个简单的 shell。它实际上与 i/o 重定向等配合得很好。我想添加的一件事是一种在 exec* 函数版本之间切换的方法。现在我坚持使用 execlp()、execvp() 和 execve()。

我有我想在一个名为 argv 的数组中传递的所有参数。它是一个空终止字符串的空终止数组，因此它可以与 execv* 一起正常工作，但我想不出如何让它与 execlp() 一起工作。

这就是我现在所拥有的：

```
if     (strcmp(exec_opt, "vp") == 0)
  error = execvp(argv[0], argv);          /* Execute vp */
else if(strcmp(exec_opt, "lp") == 0)
  error = execlp(argv[0], "", argv);      /* Execute lp */
else if(strcmp(exec_opt, "ve") == 0)
  error = execve(argv[0], argv, environ); /* Execute ve */
else
{
  // throw errors about exec_opt
}

if(error != 0)
{
  // do something about it
} 
```

在这种配置中，编译器不会对语法感到困惑，但它也不起作用。我也试过

```
 error = execlp(argv[0], (char*) argv);  /* As a single string */
 char* argv1 = argv[1];                  /* don't pass command itself */
 error = execlp(argv[0], argv1); 
```

它做了各种奇怪但最终不正确的事情。有没有办法让我把我的数组变成一个变量参数列表？直接传递它（这具有最大的类型意义，因为变量参数列表是`char* argv[]`）会产生关于强制转换不兼容指针的编译器错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T01:33:45.553

你不能真正使用`execlp()`数组。要使用`execlp()`，您必须写出：

```
execlp(array[0], array[0], (char *)0);
execlp(array[0], array[0], array[1], (char *)0);
execlp(array[0], array[0], array[1], array[2], (char *)0);
execlp(array[0], array[0], array[1], array[2], array[3], (char *)0);
... 
```

对于每个可选数量的参数。这就是为什么[`execvp()`](http://pubs.opengroup.org/onlinepubs/9699919799/functions/exec.html)被添加到曲目中的原因（它[在 1978 年不是第 7 版 UNIX™</a> 的一部分，而是](http://plan9.bell-labs.com/7thEdMan/index.html)在 1997 年成为[SUS v2的一部分）。](http://www.opengroup.org/onlinepubs/7990989775/)现在您只需要`execvpe()`AFAIK 不存在的 （我也不知道为什么不提供它）。

* * *

## ^第7版 UNIX 确实有`excevp()`

戴夫说：

> 第 7 版手册确实列出了`execvp`.

而且......它确实，部分。我认为我们需要报告一个勘误表，因为该手册实际上包含：

> ### 姓名
> 
> execl, execv, execle, execve, execlp, execvp, exec, exece, environ – 执行文件
> 
> ### 概要
> 
> ```
> execl(name, arg0, arg1, ..., argn, 0)
> char *name, *arg0, *arg1, ..., *argn;
> execv(name, argv)
> char *name, *argv[ ];
> execle(name, arg0, arg1, ..., argn, 0, envp)
> char *name, *arg0, *arg1, ..., *argn, *envp[ ];
> execve(name, argv, envp);
> char *name, *argv[ ], *envp[ ];
> extern char **environ; 
> ```
> 
> ### 描述

所以，`execvp()`在 NAME 部分中列出，但没有概要`execvp()`（这是我看到的，以得出它丢失的结论）。`execvp()`下一页有参考：

> *Execlp*和*execvp使用与**execl*和*execv*相同的参数调用，但重复了 shell 在目录列表中搜索可执行文件的操作。目录列表是从环境中获取的。

所以，我原谅自己，因为我浏览了概要并`execvp()`从概要中被省略了。但实际上，系统调用存在于第 7 版 Unix 中。我认为没有人会重新发布修复遗漏的手册。

我的打印副本（是的，我*确实*打印了手册的第 1 卷（ISBN 0-03-061742-1）和第 2 卷（ISBN 0-03-061743-X）的正确装订版本；我得到了他们大约在 1989 年）在 SYNOPSIS 部分有同样的遗漏。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T01:38:29.953

尝试使用[avcall](http://www.haible.de/bruno/documentation/ffcall/avcall/avcall.html)。我自己没用过，只是在这里发现了一个有趣的提法：[Passing parameters dynamic to variadic functions](https://stackoverflow.com/questions/1721655/passing-parameters-dynamically-to-variadic-functions)

# android - 如果颜色仍然可用，则随机生成下一个颜色

> ID：10081981
> 
> 赞同：0
> 
> 时间：2012-04-10T01:29:20.103
> 
> 标签：android, random

我正在开发一个适用于 android 的应用程序，但我在某些方面遇到了困难。其中一个是选择下一种颜色（四种颜色中的一种），但请记住，选择的颜色可能已经是空的，在这种情况下，应选择四种颜色中的下一种

我有两种方法，但其中一种是代码太多，另一种导致崩溃（我猜这是因为它可能会陷入无限循环）

提前致谢

```
public void nextColor(Canvas canvas) {
    Random rnd = new Random(System.currentTimeMillis());
    int theNextColor = rnd.nextInt(4);
    switch (theNextColor) {
    case 0:
        if (!blue.isEmpty()) {
            currentPaint = paintBlue;
        } else
            nextColor(canvas);

    case 1:
        if (!grey.isEmpty()) {
            currentPaint = paintGray;
        } else
            nextColor(canvas);
    case 2:
        if (!gold.isEmpty()) {
            currentPaint = paintGold;
        } else
            nextColor(canvas);
    case 3:
        if (!red.isEmpty()) {
            currentPaint = paintRed;
        } else
            nextColor(canvas);
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T03:02:07.790

What happens if all four colors are chosen?

Regardless, this doesn't seem to be a situation where a recursive call is required. Try something like the following:

```
public void nextColor(Canvas canvas) {
    Random rnd = new Random(System.currentTimeMillis());
    int theNextColor;
    boolean colorFound = false;

    while (!colorFound) {
       theNextColor = rnd.nextInt(4);
       if (theNextColor == 0) {
         currentPaint = paintBlue;
         colorFound = true;
       } else if (theNextColor == 1) {
         currentPaint = paintGray;
         colorFound = true;
       } else if (theNextColor == 2) {
         currentPaint = paintGold;
         colorFound = true;
       } else if (theNextColor == 3) {
         currentPaint = paintRed;
         colorFound = true;
       }
    } 
```

# c++ - NSURLConnection 在它自己的线程中没有旋转循环就不能工作

> ID：10081985
> 
> 赞同：0
> 
> 时间：2012-04-10T01:29:31.110
> 
> 标签：c++, objective-c, upload, nsurlconnection

我遇到了一个不会上传的 Objective-C 上传器类的问题（未调用失败/成功委托并且服务器显示没有传入请求），除非我有一个自旋循环。它与旋转循环完美配合。

我是 Objective-C 的新手，设置如下：主应用程序实例化一个 C++ 类 (cppClass)，该类在单独的 pThread 中运行一个静态函数 (cppFuncA)。

静态函数 (cppFuncA) 实例化一个 Objective-C 类/对象 (UploadFunc)，它获取一些数据并上传它。

```
CppClass {
    static void cppFuncA (...);
} 

cppFuncA(...) {
    UploadFunc* uploader = [[[UploadFunc alloc] retain] init];
    while (condition) {
        ...
        [uploader uploadData:(NSData*)data];
    }
    [uploader release]
} 
```

## 上传者.h

```
@interface UploadFunc : NSObject
{
    bool conditional;
}
- (void)connection:(NSURLConnection *)connection didFailWithError:(NSError *)error;
- (void)connectionDidFinishLoading:(NSURLConnection *)connection;
- (void)connection:(NSURLConnection *)connection didReceiveResponse:(NSURLResponse *)response;
- (void) uploadData:(NSData*)data;
@end 
```

## 上传者.mm

```
@implementation UploadFeedback
- (void)connection:(NSURLConnection *)connection didFailWithError:(NSError *)error
{
    conditional = false;
    [connection release];
    NSLog(@"Connection failed! Error - %@ %@",
          [error localizedDescription],
          [[error userInfo] objectForKey:NSURLErrorFailingURLStringErrorKey]);
}
- (void)connectionDidFinishLoading:(NSURLConnection *)connection
{
    conditional = false;
    NSLog(@"Succeeded! Received %d bytes of data",0);
    [connection release];
}
- (void)connection:(NSURLConnection *)connection didReceiveResponse:(NSURLResponse *)response
{
    NSLog(@"Response=%@", response);
}

-(void) uploadData:(NSData*)data
{
    …
    NSMutableURLRequest *theRequest=[NSMutableURLRequest requestWithURL:theURL];
    … construct request …

    NSURLConnection* theConnection = [[NSURLConnection alloc] initWithRequest:theRequest delegate:self];

    // Only works if I have this following spin loop
    conditional = true;
    while(conditional) {     
        [[NSRunLoop currentRunLoop] runMode:NSDefaultRunLoopMode beforeDate:[NSDate distantFuture]];
    }
    if (!theConnection) std::cerr << "Connection to feedback failed\n";
} 
```

最后一个函数“-(void) uploadData:(NSData*)data”是我遇到问题的地方。如果没有自旋循环，它将无法工作。关于发生了什么的任何想法？

我在 NSURLRequest 和 NSURLConnection 中添加了保留，所以我认为它不是一个没有复制请求的竞争条件。

编辑：我觉得这些可能是类似的问题： [NSURLConnection - 如何等待完成](https://stackoverflow.com/questions/825191/nsurlconnection-how-to-wait-for-completion) 和[从后台线程到服务器的异步请求](https://stackoverflow.com/questions/1728631/asynchronous-request-to-the-server-from-background-thread) 但是我的对象（UploadFunc）即使在函数完成并超出范围后仍然存在......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T02:18:27.797

不要在默认模式下运行你的运行循环。该框架可以将其他运行循环源置于默认模式，当您只想处理您的`NSURLConnection`. 诚然，框架在后台线程的运行循环上调度其他源应该是不常见的，但你不能确定。

运行运行循环不应该忙循环。除非数据传入的速度超出您的处理速度，否则您不应该提高 CPU 使用率。它似乎是忙循环的事实让我怀疑在默认模式下安排了另一个运行循环源。

在私有运行循环模式下调度`NSURLConnection`（只是您的应用程序独有的任意字符串），然后在该模式下运行运行循环。您可以使用 初始化 NSURLConnection `-initWithRequest:delegate:startImmediately:`，并传递`NO`最后一个参数以避免在默认模式下进行调度。然后使用`-scheduleInRunLoop:forMode:`以您的私人模式安排它。

# jquery - 是否可以将参数传递给 jQuery UI 滑块

> ID：10081986
> 
> 赞同：0
> 
> 时间：2012-04-10T01:29:40.130
> 
> 标签：jquery

我正在尝试构建一个使用 jQuery UI 滑块的项目。它涉及对人员进行调查，用户必须告诉他们对某事的确定程度，这就是滑块的作用。

```
 $(function() {
    $( "#slider-range-min1" ).slider({
        range: "min",
        value: 0,
        min: 0,
        max: 100,
        slide: function( event, ui ) {
            jQuery( "#amount1" ).val(ui.value + "%" );
        }
    });
$( "#amount1" ).val($( "#slider-range-min1" ).slider( "value" ) + "%" );
}); 
```

由于一个问题可能有 4-5 个答案，并且每个答案都有一个与之关联的滑块，因此对于 20 个问题的调查，将有太多单独的滑块功能。我可以动态填充它们，但必须有更好的方法来做到这一点。就像用一个函数控制所有滑块一样，只需将 div id 和输入 id 传递给它。

我尝试使用类而不是 ID，但是当我这样做时，滑块会消失，因为 jQuery Ui 似乎在运行时将一些自己的类附加到滑块上。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T12:02:57.213

那么 tjscience 的答案是正确的，但对你来说可能不完整。那这个呢：

```
<div class="container">
<input type="text" class="inputField"/>
<div id="answer-1" class="answer"></div>
</div>
<div class="container">
<input type="text" class="inputField"/>
<div id="answer-2" class="answer"></div>
</div>
<div class="container">
<input type="text" class="inputField"/>
<div id="answer-3" class="answer"></div>
</div>

$(".answer").slider({
    range: "min",
    value: 0,
    min: 0,
    max: 100,
    slide: function( event, ui ) {
        var container = $(ui.handle).parents(".container");
        $(container).find(".inputField").val(ui.value);
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T01:42:30.607

您是否想在一次通话中简单地制作所有答案 div 滑块？如果是这样，这应该工作：

```
<div id="answer-1" class="answer"></div>
<div id="answer-2" class="answer"></div>
<div id="answer-3" class="answer"></div>

$(".answer").slider({
        range: "min",
        value: 0,
        min: 0,
        max: 100,
        slide: function( event, ui ) {
            jQuery( "#amount1" ).val(ui.value + "%" );
        }
}); 
```

# linux - 是否可以在 3-6 分钟之间随机运行 cron 作业？

> ID：10081990
> 
> 赞同：0
> 
> 时间：2012-04-10T01:30:03.473
> 
> 标签：linux, cron, centos, crontab, variations

我为Ruby定义了一个定时任务。这为每 5 分钟运行一次 ruby​​ 脚本的用户创建了一个 cron 作业。用户不是root btw，也没有root权限。

我希望能够在 3-6 分钟之间随机运行这项工作。我在 CentOS 6.2 上运行这个工作

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T01:41:22.993

我认为您可以做的最好的事情是设置 cron 以每分钟运行一次脚本，并让脚本决定何时实际执行它的工作。您可以通过跟踪上次执行脚本的时间来获得随机效果

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T01:42:25.910

只需让脚本在动作之间随机延迟连续运行即可。将其作为@reboot 放入cron 中，当系统启动时它将重新启动。

# javascript - 只能在 jQuery 元素停止工作之前单击一次

> ID：10081994
> 
> 赞同：1
> 
> 时间：2012-04-10T01:30:36.087
> 
> 标签：javascript, html

我有以下代码：

```
$("#another").click(function() {
    $('#another').replaceWith('<a id="another" class="btn btn-primary btn-mini disabled"><i class="icon-refresh icon-white"></i>&nbsp;Loading...</a>');
    $.get('another.php', { 'cycle' : i }, function(data) {
        $('tbody').append(data);
        $("#another").replaceWith('<a id="another" class="btn btn-primary btn-mini"><i class="icon-plus icon-white"></i>&nbsp;Load another cycle</a>');
    });
    i++;
}); 
```

当我单击具有另一个 id 的元素时，它会加载一次。一按后就不能再用了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T01:45:03.687

您正在用没有事件侦听器的节​​点替换节点。

基本上在你点击之前

```
[#another]
    ^
    |
[clickListener] 
```

然后构建另一个按钮 ( `<a id="another" class="btn btn-primary btn-mini disabled"><i class="icon-refresh icon-white"></i>&nbsp;Loading...</a>`)

```
[#another]     [#another](2)
    ^
    |
[clickListener] 
```

然后我们在布局中用第二个替换第一个：

```
[#another]               [#another](2)
    ^
    |
[clickListener] 
```

*哦，等等*，我的模型没有任何变化。那是因为点击监听器链接到第一个对象（不再可见），而可见的对象仍然存在。

* * *

所以在代码方面，这是什么意思？它只是意味着您需要将事件侦听器重新附加到那里。这就是我的做法

```
var onClick=function(){
    $('#another').replaceWith('<a id="another" class="btn btn-primary btn-mini disabled"><i class="icon-refresh icon-white"></i>&nbsp;Loading...</a>')
    .click(onClick); // <--- this is the important line!

    $.get('another.php', { 'cycle' : i }, function(data) {
        $('tbody').append(data);
        $("#another").replaceWith('<a id="another" class="btn btn-primary btn-mini"><i class="icon-plus icon-white"></i>&nbsp;Load another cycle</a>');
    });
    i++;
}

$("#another").click(onClick); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T01:40:32.843

如果将元素替换为另一个元素，则所有侦听器都将被删除。为避免这种情况，您可以再次将侦听器添加到新元素

```
$('#another').bind('click', function() {
  //do something
}); 
```

或将代码移动到函数并`onclick`为元素添加属性。

```
onclick="my_function();" 
```

在你当前的 javascript 中它会是

```
$('#another').replaceWith('<a id="another" class="btn btn-primary btn-mini disabled" onclick="my_function();"><i class="icon-refresh icon-white"></i>&nbsp;Loading...</a>'); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-10T01:50:36.573

最好只保留相同的按钮，使用相同的事件处理程序。只需动态更改文本和增量`i`。试试这个：

```
// Execute in a closure to isolate all the local variables
// Optional, but I like doing this when counter variables are involved
(function() {
    var button = $("#another");
    var a = button.find("a");
    var i = 1;

    button.click(function() {
        // Replace the inner html, not the entire element
        a.html("<i class='icon-refresh icon-white'</i>&nbsp;Loading...");
        $.get("another.php", {
            cycle: i
        }, function(data) {
            $("tbody").append(data);
            a.html("<i class='icon-plus icon-white'></i>&nbsp;Load another cycle");            
            i++;
        });
    });
})(); 
```

这种方法的好处是减少了 DOM 操作，没有内联 JavaScript，也**没有全局函数或变量**。如果外部标记相同，确实没有理由每次都销毁按钮并重新创建它。

# android - Android AlertDialog 点击 Positive 和 Negative 只是关闭

> ID：10081996
> 
> 赞同：0
> 
> 时间：2012-04-10T01:31:08.083
> 
> 标签：android, onclick, android-alertdialog

尝试有一个共享首选项，单击它以恢复默认值，然后出现一个警报对话框询问您是否确定，但它没有做任何事情，只是关闭警报对话框。

```
public class SettingsActivity extends PreferenceActivity implements
    OnSharedPreferenceChangeListener {
/** Called when the activity is first created. */

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    c = this;
    addPreferencesFromResource(R.xml.settings);
    SharedPreferences sp = PreferenceManager
            .getDefaultSharedPreferences(this);
    sp.registerOnSharedPreferenceChangeListener(this);
    datasource = new PhoneNumberDataSource(this);
    Preference restore = (Preference) findPreference("RESTORE");
    restore.setOnPreferenceClickListener(new OnPreferenceClickListener() {
        @Override
        public boolean onPreferenceClick(Preference preference) {
            createDialog();
            return false;
        }
    });
}

void createDialog() {
    Log.v("createDialog", "");
    FrameLayout fl = new FrameLayout(c);
    AlertDialog.Builder b = new AlertDialog.Builder(c).setView(fl);
    b.setTitle("Restore Defaults?");
            b.setPositiveButton("Restore",
                    new DialogInterface.OnClickListener() {
                        @Override
                        public void onClick(DialogInterface d,
                                int which) {
                            Log.v("restore clicked:", "");
                        }
                    });
            b.setNegativeButton("Cancel",
                    new DialogInterface.OnClickListener() {
                        @Override
                        public void onClick(DialogInterface d,
                                int which) {
                            Log.v("cancel clicked:", "");
                            d.dismiss();
                        }
                    }).create();
            b.show();

} 
```

}

日志中既不显示“取消点击”也不显示“恢复点击”。我确实`"W/InputManagerService(64): Window already focused, ignoring focus gain of: com.android.internal.view.IInputMethodClient$Stub$Proxy@450317b8"`在日志中得到了一个奇怪的东西。