# StackOverflow 问答 10739000-10739999

# java - 从 java 客户端调用 Ilog Jrule 规则执行服务器

> ID：10739001
> 
> 赞同：0
> 
> 时间：2012-05-24T14:01:10.343
> 
> 标签：java, jakarta-ee, ilog, jrules

我正在尝试使用 java 客户端在 IBM Jrule Rules execution server 中执行规则。我有 Websphere community Edition V2.1 服务器，我可以使用部署在 samae 服务器中的 JSF 调用和执行规则。

我想使用 java 客户端调用和执行规则。我没有找到任何方法来做到这一点，

在 EJB 中。通过设置 Initial Context 环境属性，我们可以从 web 以及从 java 客户端调用 EJB。有没有与此类似的方法，调用规则执行服务器规则，使用 java 客户端，Web 部件已经在工作。

```
import ilog.rules.res.session.IlrPOJOSessionFactory;
import ilog.rules.res.session.IlrStatelessSession;
import ilog.rules.res.session.IlrSessionFactory;
import ilog.rules.res.session.IlrStatefulSession;
import ilog.rules.res.session.IlrSessionRequest;
import ilog.rules.res.session.IlrJ2SESessionFactory;
import ilog.rules.res.session.IlrSessionResponse;
import ilog.rules.res.model.IlrPath;
import ilog.rules.res.session.extension.IlrExtendedJ2SESessionFactory;
import miniloan.Borrower;
import miniloan.Loan;

public class POJOEx {

    public static void main(String... arg) {
        // create rule session factory
        //IlrSessionFactory sessionFactory = new IlrPOJOSessionFactory();
        //IlrExtendedJ2SESessionFactory sessionFactory = new IlrExtendedJ2SESessionFactory();
        //      j2se factory
        IlrSessionFactory sessionFactory = new IlrJ2SESessionFactory();

        try {
            // use stateless session for invocation
            IlrStatelessSession statelessSession = sessionFactory.createStatelessSession();
//input parameter
            Borrower borrower = new miniloan.Borrower("Joe", 600,
                    80000);
// in out parameter
            Loan loan = new miniloan.Loan(500000, 240, 0.05);

            IlrSessionRequest request = sessionFactory.createRequest();
//rule path
            request.setRulesetPath(IlrPath.parsePath("/miniloanruleapp/2.0/miniloanrules/1.0"));

request.setUserDat("miniloanruleapp.MiniloanrulesclientRunnerImpl.executeminiloanrules");

            request.setInputParameter("borrower", borrower);
            request.setInputParameter("loan", loan);
//executing 
            IlrSessionResponse response = statelessSession.execute(request);

            System.out.println("userdata = " + response.getOutputParameters().get("loan"));
            System.out.println("outputString = " + (String) response.getUserData());
            System.out.println("executionId  = " + response.getExecutionId());

        } catch (Exception ex) {
            ex.printStackTrace();
        }          

    }
} 
```

我得到以下错误。

```
ilog.rules.res.xu.ruleset.impl.archive.IlrRulesetArchiveInformationNotFoundException: Cannot get the information about the ruleset /miniloanruleapp/2.0/miniloanrules/1.0 
```

任何人都可以建议在哪里指定规则执行服务器 url、用户名和密码。就像我们在 EJB 中指定 InitialContext 值一样。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T09:51:13.013

让我澄清一下什么是RES，因为这里似乎有一个误解，可能是我。
RES 在 Ilog 术语中用于描述多种事物：
- 允许您管理规则应用程序的 Web 界面。
- 您在 WebSphere CE（或其他）上部署以执行规则的实际应用程序。
- 允许您在本地执行 ruleapp 的 .jar 文件。

您，AFAIK，无法使用本地 JAVA 应用程序连接 RES。
您编写的代码是调用 RES*.jar 文件中包含的规则引擎，以便在本地执行您的 ruleapp。
您无法像使用 EJB 应用程序那样使用 JAVA 应用程序。
您必须使用 web 服务，否则如果您将 ruleapp 名称作为 web 服务的参数，这是可行的。
您正在使用 miniloan，因此您可能知道使用 Web 界面的示例，您可以在其中知道要使用哪个版本的规则集。
如果您想以编程方式管理部署在 RES（应用程序服务器上的真实应用程序）上的规则应用程序，这将是相同的，您将需要使用 MDB。没有其他的。

这令人失望，我知道因为我经历过，但我（至少）不知道怎么做。这不是您必须遵循的行为。

为了使其工作，然后将您的规则应用程序放在类路径中（或 Eclipse 中您的 JAVA 应用程序的根目录）并运行它......然后您将执行您的规则。

RES 不提供与 RTS 相同的工具，您可以从任何 JAVA 应用程序访问 RTS 以操作您的规则项目。

您是 100% 正确的，无法告诉 J2SE 连接什么是服务器 URL，因此无法从服务器运行您的规则。
希望能帮助到你。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-11-17T16:36:03.623

您绝对可以从 J2EE 代码调用 Rule Execution Server，或者在您的情况下通过远程 J2SE 调用，并且提供了执行此操作的文档。但我确实想澄清一些关于第一反应的事情。

Rule Execution Server 是执行规则的运行时。它有一个持久层（文件或数据库）和一个管理控制台，用于管理它和任何其他连接的 Rule Execution Server。

当您使用以下设备时，您连接的就是此管理服务器：

*   服务器：端口/res URL

您无需连接到实际的 RES，因为您可以将多个 RES 连接到单个管理控制台。管理控制台包含有关持久层的详细信息以及提取您希望执行的规则集的方法。

对你的问题。您收到错误的原因是您尚未配置要从哪个远程规则执行服务器中提取规则集，这就是您收到错误的原因。

要配置远程连接，您可以使用名为“ra.xml”的文件并将设置更改为指向您的远程资源/控制台。

'/executionserver/bin' 目录中有一个默认的 ra.xml（默认为 ./IBM/ODM87/ODM/executionserver/bin）。

该文件中要考虑的主要方面是：

> ```
>  To enable management of Java SE XU instances that are running on different JVM or JMX MBean server, you must configure the  XU MBean plug-in with the TCPIP protocol:
>     <config-property>
>                <config-property-name>plugins</config-property-name>
>                <config-property-type>java.lang.String</config-property-type>
>                <config-property-value>{pluginClass=Management,xuName=default,protocol=tcpip,tcpip.port=TCPIP_PORT,tcpip.host=RES_CONSOLE_HOST,tcpip.retryInterval=INTERVAL}
>           </config-property-value>
>         </config-property>
>     where:
> RES_CONSOLE_HOST is the host on which the Rule Execution Server console is deployed.
> TCPIP_PORT is the TCP/IP port on which the Rule Execution Server console management server is listening.
> INTERVAL is the interval of time, in milliseconds, during which the console tries to reconnect to the management server if a connection fails. 
> ```

只要 ra.xml 在您正在运行的本地 J2SE 引擎的应用程序的类路径中，就应该调用远程 RES 控制台并请求提供 RuleSet 路径中指定的规则应用程序。

对于 J2EE，这类似，但您实际上是在远程 RES 中执行规则，而不是在本地拉取规则集。

如果您查看 ODM Samples，则有一个 J2EE 和 J2SE 示例演示了这两种技术。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-08-14T03:12:51.347

在 *.dsar 的同一文件夹中添加以下文件对我有用 creation_date.txt、display_name.txt、properties.txt

# php - PHP中的路径是如何计算的 - 为什么当前目录中的文件会被忽略？

> ID：10739002
> 
> 赞同：2
> 
> 时间：2012-05-24T14:01:15.823
> 
> 标签：php

更新：

index.php 文件在这里：

```
/public_html/d/index.php 
```

包括：

```
/public_html/d/core/source/class.File1.php 
```

这个 Class.File1.php 这里有这个包含这样写的：

```
include 'class.File2.php'; 
```

当然`class.File2.php`，如上所述，我将放在与 class.File1.php 相同的目录中。

```
/public_html/d/core/source/class.File2.php 
```

然而，

它实际上包括这个文件：（注意丢失`/d/`）

```
/public_html/core/source/class.File2.php 
```

不知道为什么它不使用当前目录中的文件。

但这里有一些可能性。

来自请求页面的用户的条目进入：（用户类型`www.host.com/d`）

```
/public_html/d/ 
```

这包括：（效果很好，我测试过）

```
/public_html/d/core/source/class.File1.php 
```

但是，如上所述，该文件中的包含是中断的地方：

```
include "class.File2.php" 
```

唯一有意义的事情......是包括使用某种内部常量，如

```
ROOT 
```

或者

```
$_SERVER['DOCUMENT_ROOT'] 
```

但我仍然无法弄清楚为什么它会忽略`/d/`但找出其余的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T14:06:24.577

您是否尝试过包含相对路径？

```
include './class.File2.php'; 
```

class.File1.php 本身是否包含在其他脚本中？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-24T14:11:14.473

您是否在应用程序的任何地方使用[set_include_path ？](http://php.net/manual/en/function.set-include-path.php)也许这可能是您的问题的原因。通过这样做，您指定了 require、include、fopen()、file()、readfile() 和 file_get_contents() 函数首先查找文件的目录列表。

作为替代方案，我建议您定义绝对路径以避免出现问题。把这个写在你的`/public_html/d/core/source/class.File1.php`

```
// This if you are using PHP >= 5.3
include(__DIR__ . '/class.File2.php');

// Or this if you dont have the magic constant __DIR__ available
include(dirname(__FILE__) . '/class.File2.php'); 
```

`__FILE__`并且`__DIR__`是魔法常数。`__FILE__`是一个具有该特定文件的绝对路径的常量。并且`__DIR__`是该文件所在目录的绝对路径。您甚至可以通过执行`echo __FILE__;`或`echo __DIR__;`

你可以在这里阅读更多关于它们的信息[http://php.net/manual/en/language.constants.predefined.php](http://php.net/manual/en/language.constants.predefined.php)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T18:09:18.640

*   `getcwd()`无论它位于什么文件中（在我的系统上），总是返回相同的路径。我认为的一个错误。

*   （在我的系统上）PHP 在包含列表或当前目录中未指定的路径中找到了另一个文件。在我看来，这是一个错误。

*   在我的系统上，如果您不想使用绝对路径……我发现使用相对路径的唯一方法是`dirname(__FILE__);`在您想去的地方添加前缀。

*   . 或 ./ 前置文件也不起作用....

# ios - 后台应用程序的响应者链是什么样的？

> ID：10739003
> 
> 赞同：2
> 
> 时间：2012-05-24T14:01:17.833
> 
> 标签：ios, background, uiresponder

如果音频应用程序配置为在后台播放音频，您可以将其设置为接收远程控制事件。Apple 的文档描述了什么是必要的以及如何设置它。其中一个关键方面是确保接收和响应远程控制事件的对象可以（并且将）成为第一响应者。

当应用程序在后台时，响应者链是什么样的。我熟悉响应者链及其运作方式，但我如何知道哪些对象是响应者链的一部分，以及当应用程序在后台时哪个对象成为第一响应者？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T22:55:24.213

由于应用程序在后台，因此键和主窗口为零，因此它们不包含在响应者链中。然后，响应者链仅包含应用程序实例及其委托。

这对我来说是个问题，因为我实际上希望窗口（文档）在后台处理与您尝试执行的操作非常相似的操作。我可以通过使用 NSResponder 的 tryToPerform:with: 来解决这个问题。

# entity-framework - 实体框架模型优先的复数表名

> ID：10739011
> 
> 赞同：2
> 
> 时间：2012-05-24T14:01:53.533
> 
> 标签：entity-framework, entity-framework-4.1

我先试试 EF 模型。我正在使用 EF 4.1

非常关注[这篇文章](http://msdn.microsoft.com/en-us/data/gg685494.aspx)

我在模型上将 PluraliseNewObjects 设置为 False，并且在 Options->Database Tools ->O/R Designer 中将名称的 Pluralization 设置为 false。

两者都没有任何效果 - 当我从模型生成新模式时，表名总是复数 - 是否可以禁用它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T14:44:33.950

好的 - 我找到了一种方法来实现我想要的 - 但这是一条非常愚蠢的路线。

1.  生成具有复数名称的数据库（有趣的是，它仅将映射到类型的表复数 - 而不是自动生成的多对多连接的链接表）。

2.  手动重命名数据库中的表

3.  从项目中删除模型并根据现有数据库模式（我刚刚重命名的模式）重新创建。

4.  模型现在正确映射到单独命名的表。

我会拭目以待，看看是否有人想出一个更明智的方法来实现这一目标......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-01T03:16:07.033

生成的 DDL 中的表名称似乎与“实体集名称”值匹配（不同于“实体名称”）。如果您对实体集名称进行单数化，则 DDL 中的表名也会单数化。

但是，这可能会产生在代码中单数化 EntitySet 属性名称的不良影响。代替：

```
myDatabase
.Products
.Where...
.Select... 
```

您的代码将如下所示：

```
myDatabase
.Product
.Where...
.Select... 
```

可能是也可能不是问题

# sql - SQL获取每行的最大列值

> ID：10739015
> 
> 赞同：2
> 
> 时间：2012-05-24T14:01:56.740
> 
> 标签：sql, ms-access-2007

示例表：MyTable1

```
Col1    |    Col2     |     Col3
   3           10            5
  10           9             40
   1           2             6 
```

输出必须是：

```
NewColumn
    10
    40
     6 
```

如您所见，我只需要从每一行中获取最高值..

是否可以仅使用 sql 选择查询？

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T14:09:51.923

您将需要使用 MS Access 功能`IIF()`

```
IIF(condition, valueiftrue, valueiffalse) 
```

> 条件是您要测试的值。
> 
> valueiftrue 是在条件评估为 TRUE 时返回的值。
> 
> valueiffalse 是条件评估为 FALSE 时返回的值。

所以你的查询是

```
SELECT IIf(C12 > Col3, C12, Col3) as newColumn
FROM
(
    select IIF(Col1 > Col2,  Col1,  Col2) as C12, Col3
    from mytable1
) x 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T09:12:58.507

我想知道这是否适用于 MS Access（恐怕无法验证自己）：

```
SELECT
  (
    SELECT MAX(Col)
    FROM (
      SELECT Col1 AS Col UNION ALL
      SELECT Col2        UNION ALL
      SELECT Col3
    ) s
  ) AS NewColumn
FROM yourtable 
```

这适用于同一供应商*的其他*数据库产品系列，所以我认为他们可能恰好也在 MS Access 中添加了对此的支持。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-10T14:50:00.470

有效的示例：

**表格1：**

```
Col - Text
Col1 - Number
Col2 - Number
Col3 - Number
Col4 - Number 
```

**数据：**

```
col; col1; col2; col3; col4;
a;      1;    4;    6;    7;
b;      3;   66;   23;  235;
c;     34;  634;   11;   23; 
```

**询问：**

```
SELECT Col, Max(colx) AS MaxOfColx
FROM 
(
SELECT Col, Col1 AS Colx From Table1 UNION ALL
SELECT Col, Col2 AS Colx From Table1 UNION ALL
SELECT Col, Col3 AS Colx From Table1 UNION ALL
SELECT Col, Col4 AS Colx From Table1
)
group by Col 
```

**结果：**

```
Col; MaxOfColx
 a;          7
 b;        235
 c;        634 
```

这将适用于您需要的尽可能多的列。

# php - 如何在PHP中删除双引号之间的逗号

> ID：10739016
> 
> 赞同：4
> 
> 时间：2012-05-24T14:01:57.973
> 
> 标签：php, regex, quotes, double-quotes

希望这是一个简单的过程。我有一个包含 CSV 文件输出的行的数组。我需要做的只是删除出现在双引号之间的任何逗号。

我在正则表达式中磕磕绊绊，遇到了麻烦。这是我看起来很悲伤的代码：

```
<?php    

$csv_input = '"herp","derp","hey, get rid of these commas, man",1234';

$pattern = '(?<=\")/\,/(?=\")'; //this doesn't work

$revised_input = preg_replace ( $pattern , '' , $csv_input);

echo $revised_input;

//would like revised input to echo: "herp","derp,"hey get rid of these commas man",1234

?> 
```

非常感谢大家。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-24T14:06:00.723

## 原始答案

您可以使用[`str_getcsv()`](http://php.net/manual/en/function.str-getcsv.php)它，因为它是专门为处理 CSV 字符串而设计的：

```
$out = array();
$array = str_getcsv($csv_input);
foreach($array as $item) {
    $out[] = str_replace(',', '', $item);
} 
```

`$out`现在是一个元素数组，其中没有任何逗号，然后您可以将其内爆，因为删除逗号后将不再需要引号：

```
$revised_input = implode(',', $out); 
```

## 更新评论

如果引号对您很重要，那么您可以像这样将它们重新添加：

```
$revised_input = '"' . implode('","', $out) . '"'; 
```

另一种选择是使用其中一个`str_putcsv()`（不是标准的 PHP 函数）实现在网络上浮动，例如[这个](http://www.php.net/manual/en/function.str-getcsv.php#91170)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-24T14:14:19.523

这是一种非常幼稚的方法，仅当“有效”逗号是引号之间的逗号时才有效，而引号之间可能只有空格。

```
<?php    

$csv_input = '"herp","derp","hey, get rid of these commas, man",1234';

$pattern = '/([^"])\,([^"])/'; //this doesn't work

$revised_input = preg_replace ( $pattern , "$1$2" , $csv_input);

echo $revised_input;

//ouput for this is: "herp","derp","hey get rid of these commas man",1234 
```

它应该进行更多测试，但它在这种情况下有效。

它可能不起作用的情况是字符串中没有引号。

一、二、三、四 -> onetwothreefour

编辑：更正了删除空格和相邻字母的问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-08-02T16:57:30.000

好吧，我并没有偷懒，而是编写了一个小函数来完全满足您的需求：

```
function clean_csv_commas($csv){
    $len = strlen($csv);
    $inside_block = FALSE;
    $out='';
    for($i=0;$i<$len;$i++){
        if($csv[$i]=='"'){
            if($inside_block){
                $inside_block=FALSE;
            }else{
                $inside_block=TRUE;
            }
        }

        if($csv[$i]==',' && $inside_block){
            // do nothing
        }else{
            $out.=$csv[$i];
        }

    }
    return $out;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-24T14:07:59.257

你可能是从错误的角度来的。

与其从文本中删除逗号（大概这样您就可以在逗号上拆分字符串以获得单独的元素），不如写一些对引号起作用的东西呢？

找到开头引号后，您可以检查字符串的其余部分；下一个引号之前的任何内容都是此元素的一部分。您也可以在此处添加一些检查以查找转义引号，例如：

```
"this is a \"quote\"" 
```

仍然会被正确阅读。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-08-02T16:30:59.863

不完全是您一直在寻找的答案 - 但我用它来清理 CSV 中数字中的逗号。

`$csv = preg_replace('%\"([^\"]*)(,)([^\"]*)\"%i','$1$3',$csv);`

"3,120", 123, 345, 567 ==> 3120, 123, 345, 567

# asp.net-mvc-3 - Assert.IsInstanceOfType 在 Mvc3 的 Moq 包中失败

> ID：10739017
> 
> 赞同：2
> 
> 时间：2012-05-24T14:02:01.357
> 
> 标签：asp.net-mvc-3, moq

我正在使用 Moq 包来测试控制器。家庭控制器.cs

```
public class HomeController : Controller
{  readonly IPermitRepository _repository;
    public HomeController(IPermitRepository rep)
    {            this._repository = rep;        }

    public ViewResult Index()
    {
        ViewBag.Message = "Hello World";
        PermitModel model = _repository.GetPermitDetails();
        return View(model);
    }
} 
```

在 HomeControllerTest.cs

```
 [TestClass]
 Public class HomeControllerTest
{
    [TestMethod]
    public void Index()
    {       
        var messagingService = new Mock<IPermitRepository>();
        var controller = new HomeController(messagingService.Object);

        var result = controller.Index() as ViewResult;
       Assert.IsInstanceOfType(result.Model, typeof(PermitModel));
    }
} 
```

但它给出的错误。 **Assert.IsInstanceOfType 失败。预期类型：。实际类型：<(null)>。**

有人可以提供解决方案以及有关 MVC3 中 Moq 包的一些信息吗？提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T14:48:19.557

Moq`null`默认为每个非 void 方法调用返回。

因此，当您在控制器中调用`_repository.GetPermitDetails();`它时`null`，这就是您的测试失败的原因。

你需要调用`Setup`你的方法来返回一些东西：

```
var messagingService = new Mock<IPermitRepository>();
messagingService.Setup(m => m.GetPermitDetails()).Returns(new PermitModel());
var controller = new HomeController(messagingService.Object); 
```

您可以在[Moq 快速入门](http://code.google.com/p/moq/wiki/QuickStart)中找到有关如何自定义模拟行为的更多信息。

# actionscript-3 - 在 itemRenderer 中处理进度条

> ID：10739023
> 
> 赞同：0
> 
> 时间：2012-05-24T14:02:21.263
> 
> 标签：actionscript-3, apache-flex

我有以下代码：

```
<mx:Script>
    //I WANT TO ADRESS THE FUNCTION INSIDE MY HBOX FROM HERE
</mx:Script>
    <mx:DataGrid id="dg_uploads" x="10" y="10" width="500" height="350" editable="false" variableRowHeight="true">
        <mx:columns>
            <mx:DataGridColumn headerText="progress" sortable="true" paddingLeft="10">
                <mx:itemRenderer>

                    <mx:Component>
                        <mx:HBox>
                            <mx:Script>
                                <![CDATA[
                                public function updateProgress(event:CustomEvent):void {
                                    trace(event);
                                    bar.setProgress( event.data.bytesLoaded, event.data.bytesTotal );
                               }
                               ]]>
                            </mx:Script>
                            <mx:VBox>
                                <mx:ProgressBar id="bar" labelPlacement="top" minimum="0" visible="true" maximum="100" verticalGap="0"
                                                color="0x323232" label="{data.name}" direction="right" mode="manual" fontWeight="bold" trackHeight="10" width="280" bottom="0"/>
                                <mx:ProgressBar id="subbar" mode="manual" direction="right" labelPlacement="bottom" minimum="0" visible="true" label="{data.status}"
                                                maximum="100" width="280" styleName="subBarStyle"/>
                            </mx:VBox>
                            <mx:Image source="images/Clear-Red-Button.png" useHandCursor="true" buttonMode="true" click="outerDocument.deleteItem(event)" />
                            <mx:Image source="images/Clear-Green-Button.png" useHandCursor="true" buttonMode="true" click="outerDocument.stopUploadProcess(event)" />
                        </mx:HBox>
                    </mx:Component>
                </mx:itemRenderer>          
            </mx:DataGridColumn>
        </mx:columns>   
    </mx:DataGrid> 
```

如何从 hbox 脚本外部寻址 hbox 脚本内部的函数？我想在文档开始时触发它

# php - 如何使用 JQuery 序列化多维输入？

> ID：10739031
> 
> 赞同：3
> 
> 时间：2012-05-24T14:02:36.787
> 
> 标签：php, jquery

我有以下html：

```
<form class="add_skill_form">
  <input type="hidden" name="skills[][skill_title]" value="Skill 1" />
  <input type="hidden" name="skills[][skill_level]" value="1" />

  <input type="hidden" name="skills[][skill_title]" value="Skill 2" />
  <input type="hidden" name="skills[][skill_level]" value="2" />
</form> 
```

如果可能的话，我想用 JQuery 序列化它，如下所示：

```
var loFormFields = $('.add_skill_form').serializeArray(); 
```

现在我没有得到我想要的参数，如下所示：

```
$_POST['skills'] = array
(
   0 => array('skill_title' => 'Skill 1', 'skill_level' => 1),
   1 => array('skill_title' => 'Skill 2', 'skill_level' => 2)
) 
```

任何人有任何线索？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T14:07:16.907

我会尝试交换你的数组索引 - 例如，`name="skills[skill_title][]"`

然后，如果您绝对必须交换索引，[请在 PHP 中转置数组](https://stackoverflow.com/questions/797251/transposing-multidimensional-arrays-in-php)。

# vba - Excel VBA 在范围末尾插入/删除行

> ID：10739035
> 
> 赞同：0
> 
> 时间：2012-05-24T14:02:48.773
> 
> 标签：vba, excel, insert, conditional-formatting

我需要根据变量的状态插入或删除一些行。

Sheet1 有一个数据列表。使用已格式化的 sheet2，我想复制该数据，因此 sheet2 只是一个模板，而 sheet1 就像一个用户表单。

在 for 循环之前，我的代码所做的是获取仅包含数据的工作表 1 中的行数以及包含数据的工作表 2 中的行数。

如果用户向 sheet1 添加更多数据，那么我需要在 sheet2 中的数据末尾插入更多行，如果用户删除 sheet1 中的一些行，则从 sheet2 中删除行。

我可以得到每个的行数，所以现在要插入或删除多少行，但这就是我遇到的问题。我将如何插入/删除正确数量的行。我也想在白色和灰色之间交替行颜色。

我确实认为删除 sheet2 上的所有行然后使用交替行颜色插入 sheet1 中相同数量的行可能是一个想法，但是我再次看到有关在条件格式中使用 mod 的一些信息。

有人可以帮忙吗？

```
Option Explicit

Private Sub Worksheet_Change(ByVal Target As Range)
    Dim listRows As Integer, ganttRows As Integer, listRange As Range, ganttRange As Range
    Dim i As Integer

    Set listRange = Columns("B:B")
    Set ganttRange = Worksheets("Sheet2").Columns("B:B")

    listRows = Application.WorksheetFunction.CountA(listRange)
    ganttRows = Application.WorksheetFunction.CountA(ganttRange)

    Worksheets("Sheet2").Range("A1") = ganttRows - listRows

    For i = 1 To ganttRows - listRows
        'LastRowColA = Range("A65536").End(xlUp).Row

    Next i

    If Target.Row Mod 2 = 0 Then
        Target.EntireRow.Interior.ColorIndex = 20
    End If

End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T14:25:13.273

我没有测试这个，因为我没有样本数据，但试试这个。您可能需要更改某些单元格引用以满足您的需要。

```
Private Sub Worksheet_Change(ByVal Target As Range)

    Dim listRows As Integer, ganttRows As Integer, listRange As Range, ganttRange As Range
    Dim wks1 As Worksheet, wks2 As Worksheet

    Set wks1 = Worksheets("Sheet2")
    Set wks2 = Worksheets("Sheet1")

    Set listRange = Intersect(wks1.UsedRange, wks1.columns("B:B").EntireColumn)
    Set ganttRange = Intersect(wks2.UsedRange, wks2.columns("B:B").EntireColumn)

    listRows = listRange.Rows.count
    ganttRows = ganttRange.Rows.count

    If listRows > ganttRows Then 'sheet 1 has more rows, need to insert
        wks1.Range(wks1.Cells(listRows - (listRows - ganttRows), 1), wks1.Cells(listRows, 1)).EntireRow.Copy 
       wks2.Cells(ganttRows, 1).offset(1).PasteSpecial xlPasteValues
    ElseIf ganttRows > listRows 'sheet 2 has more rows need to delete
        wks2.Range(wks2.Cells(ganttRows, 1), wks2.Cells(ganttRows - (ganttRows - listRows), 1)).EntireRow.Delete
    End If

    Dim cel As Range
    'reset range because of updates
    Set ganttRange = Intersect(wks2.UsedRange, wks2.columns("B:B").EntireColumn)

    For Each cel In ganttRange
        If cel.Row Mod 2 = 0 Then cel.EntireRow.Interior.ColorIndex = 20
    Next

End Sub 
```

**更新**

只需重新阅读这一行

```
If the user adds some more data to sheet1 then i need to insert some more rows at the end the data in sheet2 and if the user deletes some rows in sheet1 the rows are deleted from sheet2. 
```

我的解决方案基于用户是否在工作表底部插入/删除行。如果用户在中间插入/删除行，最好将整个范围从 sheet1 复制到已清除的 sheet2 上。

# php - 从php中的数组中提取特定变量

> ID：10739036
> 
> 赞同：0
> 
> 时间：2012-05-24T14:02:51.060
> 
> 标签：php, arrays, variables

这是用于产品退货的在线表格。用户从菜单中选择，Refund、Replacement、90DaysExpired 等...（选项如下所示）。这些选择中的每一个都有相应的消息（在变量内，如下所示）。我希望根据用户的选择将变量（$tbrefund、$tbreplace 等）的值传递给变量“$message”。

这是我到目前为止所拥有的，我收到以下错误：

**注意：未定义变量：消息**

```
$Rarray = array(
"Refund" => "$tbrefund",
"Replacement" => "$tbreplace",
"90DaysExpired" => "$expiredwarranty",
"ContactTech" => "$contacttech",
"RefundExpiredReplace" => "$outsiderefund",
"NoExRefund" => "$noexchange",
"ManuWarranty" => "$manuwarranty",
);

if (isset($Rarray[$Request]))
   $message =  $Rarray[$Request]; 
```

任何帮助是极大的赞赏。

编辑：这是产生错误的行，我已经知道它不相关......

```
$send_contact=mail($to,$subject,$message,$header); 
```

你为什么要对寻求帮助的人投反对票？它只会让新人不愿意问任何事情......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T14:23:26.813

该错误是因为 $Request 设置不正确。

```
if (isset($Rarray[$Request]))
{
   $message = $Rarray[$Request];
}
else
{
   $message = "Invalid";
} 
```

所以你的实际问题是*“为什么 $Request 不起作用”？*

答案是它取决于 $Request 来自哪里，因此您需要向我们展示一些 $Request 回显（或 var_dump() ）的示例 - 但我会冒险猜测您正在发送 $Request 小写字母（如果它是通过 URL 或其他东西） - 但你的数组是大写的。

编辑：我希望您不要期望您的消息不是“$ tbreplace”之类的。

我猜你打算做这样的事情？

```
$Rarray = array(
"Refund" => $tbrefund,
"Replacement" => $tbreplace,
"90DaysExpired" => $expiredwarranty,
"ContactTech" => $contacttech,
"RefundExpiredReplace" => $outsiderefund,
"NoExRefund" => $noexchange,
"ManuWarranty" => $manuwarranty
); 
```

# wpf - ControlTemplate 的设计时数据

> ID：10739037
> 
> 赞同：6
> 
> 时间：2012-05-24T14:02:53.683
> 
> 标签：wpf, styles, expression-blend, controltemplate, design-time

使用 为 DataContext 提供设计时数据很容易，但是使用或from`d:DataContext`引用的控件属性呢？`{TemplateBinding}``{RelativeSource TemplatedParent}``Style.Template`

~~`DesignerProperties.GetIsInDesignMode(this)`当返回 true时，我是否应该在构造函数/Loaded 事件中使用示例数据填充控件？~~ （不能这样做，因为它会破坏正常的设计体验）。

我无法修改的第三方控件呢？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-08T17:25:39.363

对于我自己的控件，我通常会执行以下操作：

```
<Style x:Key="FooStyle>
  <Setter Property="Template>
    <Setter.Value>
      <ControlTemplate TargetType="FooControl">
        <Grid d:DataContext="{d:DesignInstance FooDesignTimeData, IsDesignTimeCreatable=True}">
          ... guts of control template go here ...
        </Grid>
      </ControlTemplate>
    </Setter.Value>
  </Setter>
</Style> 
```

其中“FooDesignTimeData”是一个以适当形式提供设计时数据的类（从运行时视图模型实现接口是一个很好的做法）。

我不明白为什么这也不适用于第 3 方控制。您甚至可能不必重新模板化控件——您可以通过在样式中指定第 3 方控件并为其提供上面指定的设计时数据上下文来摆脱困境，但我还没有尝试过这种情况。我假设您会遇到所有这些麻烦，因为您被迫使用没有出色设计时体验的控件（例如通过提供 Vendor.Controls.Design.dll 或 Vendor.Controls.Expression.Design。 dll 文件）。

要使用 TemplateBindings，我没有很好的解决方案。通常我会创建一个测试页面来显示我的控件并允许我切换模板。在集成期间，您将有一个额外的视图（在您的应用程序中或作为一个单独的应用程序），允许您根据需要创建和操作控件的实例。Blend SDK 中的 GoToStateAction 目标触发操作在这里通常很有用。例如，为每个视觉状态创建一个按钮，然后使用 Click 甚至触发到特定状态的转换。因此，您可以在绑定到测试数据的同时轻松测试所有状态以及转换。哈克，不是真正的设计时数据，但它确实有效。

# c# - 如何优化此 FormatAccountNumber 方法？

> ID：10739038
> 
> 赞同：2
> 
> 时间：2012-05-24T14:02:57.387
> 
> 标签：c#

我已经编写了这种格式化帐号的方法：

```
public static  string FormatAccountNumber(string accountNumber)
{
    if (string.IsNullOrEmpty(accountNumber))
        return string.Empty;

    if (accountNumber.Length < 4)
        return "****";
    else
    {
        StringBuilder stringBuilder = new StringBuilder();
        int starLength = accountNumber.Length - 4;

        for (int index = 0; index < starLength; index++)
            stringBuilder.Append("*");

        stringBuilder.Append(accountNumber.Substring(accountNumber.Length - 4));

        return stringBuilder.ToString();
    }
} 
```

这可以优化还是已经通过使用优化`StringBuilder`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T14:21:35.990

下面的方法可以满足您的需要，易于阅读并且执行速度快几倍。不过，如果您不需要执行数千次，您希望查看执行时间差异。

```
 public static string FormatAccountNumber2(string accountNumber)
    {
        if (string.IsNullOrEmpty(accountNumber))
            return string.Empty;

        if (accountNumber.Length < 4)
            return "****";

        return new string('*', accountNumber.Length - 4) +
            accountNumber.Substring(accountNumber.Length - 4);
    } 
```

# mysql - 高频更新、上表插入、同时访问

> ID：10739045
> 
> 赞同：0
> 
> 时间：2012-05-24T14:03:20.453
> 
> 标签：mysql, memcached

我有一个表，一次可以被数千人访问。每个用户输入的数据可能会根据算法更新特定行或插入一行。我想将整个表存储在主内存中并在 0000 处写入 db hrs，因为这些记录以后没有用了。我已经阅读了有关 memcache 的信息。它会有帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T16:05:15.300

根据您所说的要求，听起来您想使用 MySQL 的[Memory Storage Engine](http://dev.mysql.com/doc/refman/5.5/en/memory-storage-engine.html)。内存表可以快速访问并且不会写入磁盘。它们用于临时信息，例如会话和缓存。

> 涉及瞬态、非关键数据的操作，例如会话管理或缓存。当 MySQL 服务器停止或重新启动时，MEMORY 表中的数据会丢失。

您可以获得完整的关系支持，包括更新、插入和选择，所有会话都可以访问。

可以使用 Memcached，但您必须在代码中实现缓存。如果您使用的是框架，它可能已经在基本模型中支持它，或者您可以在那里实现它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T17:22:15.783

只需添加 - 您可以向 INNODB Bufferpool 添加更多内存（如果您使用它）。INNDB 将使用此内存将信息存储在内存中并保存在磁盘中。Memcache 可用于存储计算列、预生成的 HTML 等...

# c# - 所有删除 Nhibernate 的孤儿

> ID：10739046
> 
> 赞同：4
> 
> 时间：2012-05-24T14:03:25.630
> 
> 标签：c#, asp.net, nhibernate

所以我有一个名为 order 的父对象和一个名为 orderLineItems 的子对象集合，其中 Cascade 在 nHibernate 中设置为 All-Delete-orphan。这是我的代码。

```
using( var session = _sessionManager.GetSession())
        using (var transaction = session.BeginTransaction())
        {

            var order = _repository.GetOrderEagerlyByOrderId(session, fromDb.Id);
            var now = DateTime.Now;
            const string user = "GNB\\Username";
            var future = now.AddYears(1);
            var taxType = new TaxType(0, "Code", "AlternateNameE", "AlternateNameF", "NameE", "NameF", "DescriptionE", "DescriptionF", 13, now, future, user, now, user, now);
            var _serviceCatRep = new ServiceCatalogueRepository();

            var serviceCatalogueItem = _serviceCatRep.GetServiceCatalogueItemByCode(session, "VR-PASS");
            var orderLineItem1 = new OrderLineItem(0, null, "DescriptionE", "DescriptionF", 1, 10, null, null, 5, false, serviceCatalogueItem, null, user, now, user, future);

            order.OrderLineItems.Clear();

            order.OrderLineItems = order.OrderLineItems == null ? new List<IOrderLineItem> { orderLineItem1 } : new List<IOrderLineItem>(order.OrderLineItems) { orderLineItem1 };

            _repository.SaveOrUpdate(session, order);
            transaction.Commit();
        } 
```

它失败`transaction.Commit();`并出现错误：

> NHibernate.HibernateException：拥有的实体实例不再引用具有 cascade="all-delete-orphan" 的集合

另外，举个例子，all 和 all-delete-orphan 有什么区别。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-24T14:25:28.717

你有：

```
order.OrderLineItems.Clear();

order.OrderLineItems = order.OrderLineItems == null 
    ? new List<IOrderLineItem> { orderLineItem1 } 
    : new List<IOrderLineItem>(order.OrderLineItems) { orderLineItem1 }; 
```

首先，如果 order.OrderLineItems 为 null，那么 order.OrderLineItems.Clear() 将抛出 NullReferenceException，其次，问题出现了，因为您正在为 order.OrderLineItems 分配一个新列表，因此 NHibernate 不知道要为什么级联删除. 要让它工作，只需将第二行更改为：

```
order.OrderLineItems.Add(orderLineItem1); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T14:18:26.787

在您的映射中 - 将集合标记为 inverse()

```
HasMany(x=>x.OrderLineItems)
   .Inverse(); 
```

# android - 根据布局大小调整文本大小

> ID：10739047
> 
> 赞同：0
> 
> 时间：2012-05-24T14:03:27.993
> 
> 标签：android, android-layout, layout, textview

我有 4 个 TextViews 水平放置，填充了屏幕的所有宽度，每个 TextView 具有相同的水平宽度。根据设备的屏幕，总宽度是不同的。我想更改文本大小以水平填充每个 TextView，但以适合文本的方式。有没有办法做到这一点？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T16:02:47.993

我认为此链接非常相​​似，因此可以极大地帮助您。您可能必须根据屏幕宽度将宽度设置为静态，然后继续调整字体大小，直到垂直方向适合每个文本视图。

[根据文本区域的宽度计算文本大小](https://stackoverflow.com/questions/4794484/calculate-text-size-according-to-width-of-text-area)

# iphone - MPMoviePlayerViewController 加载大视频文件时应用程序崩溃

> ID：10739050
> 
> 赞同：1
> 
> 时间：2012-05-24T14:03:35.293
> 
> 标签：iphone, xcode

我正在使用 MPMoviePlayerViewController 播放 MP4 文件。它对于小文件（例如 25-30 MB）运行完美，但在播放大文件（~150 MB）时它会导致应用程序崩溃。

下面是我正在使用的代码：

```
MPMoviePlayerViewController *playerViewController = [[MPMoviePlayerViewController   alloc]initWithContentURL:url];
playerViewController.modalTransitionStyle = UIModalTransitionStyleCoverVertical;
[self presentMoviePlayerViewControllerAnimated:playerViewController];

player = [playerViewController moviePlayer];

[player prepareToPlay];

[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(playerInterruptByUser:) name:MPMoviePlayerPlaybackStateDidChangeNotification object:playerViewController.moviePlayer];

[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(playerFinished:) name:MPMoviePlayerPlaybackDidFinishNotification object:playerViewController.moviePlayer];

[player play]; 
```

任何建议的家伙/女孩。

# javascript - 如何在 jQM 页面之间存储变量？

> ID：10739051
> 
> 赞同：2
> 
> 时间：2012-05-24T14:03:40.780
> 
> 标签：javascript, jquery, jquery-mobile

如何在两个 jQueryMobile 页面之间传递用户名之类的变量？

或者两个常规页面，将变量设置为全局不起作用，因为在下一次包含时，它会将变量设置回 null。

如何在两个 html 页面之间传递一个全局变量？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-24T15:40:57.147

我通常使用本地存储，您也可以存储对象。前任：

```
var userInfo = {
            "username": "Bob",
            "roleName": "Admin",
            "image": "img/userPic.jpg",
        };

        //Store the object in local storage
        localStorage.setItem('loggedUser', JSON.stringify(userInfo)); 
```

然后在另一页上，您可以简单地执行以下操作：

```
var userInfo = JSON.parse(localStorage.getItem("loggedUser"));
var userName = userInfo.username; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T14:08:06.080

只要在两个页面之间的超链接上禁用 ajax，就可以在查询字符串中传递它。

```
<a href="nextPage.php?username=joe" data-ajax="false">Next page</a> 
```

您错过了 jQuery 移动转换的有益功能，但至少您可以成功地在页面之间传递变量。

**更新：**

从[文档中](http://jquerymobile.com/demos/1.1.0/docs/pages/page-scripting.html)：

> **在页面之间传递参数**：
> 
> jQuery Mobile 不支持将查询参数传递给内部/嵌入式页面...

然后文档继续建议我没有尝试过的两个插件。[页面参数插件](https://github.com/jblas/jquery-mobile-plugins/tree/master/page-params)和[jquery 移动路由插件](https://github.com/azicchetti/jquerymobile-router)。

请务必查看上面链接的文档页面，以了解为什么传递参数不应该起作用的解释，但是如果您在没有散列的情况下加载页面（通过禁用 ajax 行为），那么您应该没问题 - 至少根据我的经验。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-24T14:08:08.117

您可以通过查询字符串或客户端路由使用 URL，可以使用 localStorage（假设它们在同一个域上），也可以使用 cookie。

如果您决定使用客户端路由，则有一个专门用于 JQM 的插件，它与不同的 JQM 页面事件相关联

[https://github.com/azicchetti/jquerymobile-router](https://github.com/azicchetti/jquerymobile-router)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-03-28T12:11:15.290

您可以像 JQM 存储自己的配置一样存储变量以供全局使用。只需在“mobileinit”的 $.mobile 下创建您自己的 javascript 对象，并将其用于您的全局变量：

```
 <!DOCTYPE html> 
    <html>
    <head>

        ...

        <script> // position before jquery.mobile.js is important for 'mobileinit' to fire
            $( document ).on( "mobileinit", function( event ) {

                //create global variable storage
                $.mobile.YourApplicationNameHere = {};

                //use it like this anywhere in your code:
                $.mobile.YourApplicationNameHere.globalVar1 = 1;
                $.mobile.YourApplicationNameHere.globalVar2 = 2;
                console.log("globalVar1 = " + $.mobile.YourApplicationNameHere.globalVar1);

            });
        </script>

        <script src="jquery/jquery.mobile-1.4.5.min.js"></script>

        ...

    </head>
        ...
    </html> 
```

您可以在任何地方初始化全局变量，但“mobileinit”是 JQM 最早的初始化点。

# android - Android 中的图库

> ID：10739053
> 
> 赞同：0
> 
> 时间：2012-05-24T14:03:52.860
> 
> 标签：android, gallery

我在我的应用程序中使用画廊。我正在使用[这里](https://stackoverflow.com/questions/4341158/android-align-first-item-in-gallery-to-the-left)给出的代码。问题是在单击画廊中的项目时，它会向左移动（因为默认画廊属性是将选定的项目移动到中心）。如何停止项目向左滚动。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T14:11:04.767

您需要调整 Gallery 元素的 Horizo​​ntal Scroll。

```
gallery.scrollTo(yourOffset,0); 
```

# c# - 从线程中的类访问动态控制

> ID：10739055
> 
> 赞同：2
> 
> 时间：2012-05-24T14:04:06.690
> 
> 标签：c#, forms, interface, controls, invoke

我正在研究一个处理轮询设备以检查 I/O 控制状态的小项目。我已经实现了一个处理特定设备的小项目，但我决定最终要实现不同的设备，因此已经转移到一个类：接口方法。然而，这引起了一些问题，因为我移动了很多代码。

在我移动代码等之前，我通过使用委托来访问动态表单控件；

```
 if (result != null)
            {
                this.Invoke((MethodInvoker)delegate
                {
                    txtOutput1.Text = (result[4] == 0x00 ? "HIGH" : "LOW"); // runs on UI thread

                    if (result[4] == 0x00)
                    {
                        this.Controls["btn" + buttonNumber].BackColor = Color.Green;
                    }
                    else
                    {
                        this.Controls["btn" + buttonNumber].BackColor = Color.Red;
                    }

                });

            } 
```

在我将某些方法移动到从接口继承的新类之前，这一直很好。我不想只将动态按钮设置为公开，我不确定我是否可以创建 get;set; 对于动态按钮，考虑到它们有很多并且是在启动时创建的。另一个问题是 this.invoke" 命令。我相信调用命令不起作用，除非它被放置在一个表单上......现在它已经被移动到一个类，所以我需要看看另一种方法来做到这一点。

有人对我应该去哪里有任何想法吗？

编辑1：

该程序被设计为处理输入/输出的硬件设备的监控系统。使用这些我可以检查是否触发了门警报等。该程序本身在形式/设计方面非常简单。目前我有一个表单，它根据数据库中的信息生成按钮，例如，如果配置了 10 个设备，则有 10 个按钮。每个都显示绿色/红色，具体取决于硬件状态。

我的主窗体为每个监视它的设备触发一个线程，但是因为我希望拥有多种类型的设备，所以我将它们移动到不同的类和一个处理所有常用方法的接口。目前我有一个设备类，它实现了一个接口。关于这个问题，我现在需要访问我正在更新的单个主表单的实例，而不是创建一个新实例，这样我就可以使用我在将所述逻辑移动到表单本身时创建的新方法.

编辑2：

```
 IdeviceInterface bfdeviceimp = new bf2300deviceimp();
   // some other declarations and initialize components

 private void btnConnect_Click(object sender, EventArgs e)
    {
        updateUI();
    }

    public void updateUI()
    {

        DBConnector mDBConnector = new DBConnector();
        int count = mDBConnector.Count() - 1;
        DataTable dataTable = mDBConnector.Select("SELECT * FROM devices");

        int x = 12;
        int y = 65;
        for (int i = 0; i <= count && i < 25; i++)
        {

            Button btnAdd = new Button();
            btnAdd.Text = dataTable.Rows[i]["deviceDescription"].ToString();
            btnAdd.Location = new Point(x, y);
            btnAdd.Tag = i;
            btnAdd.Name = "btn" + i.ToString();
            btnAdd.BackColor = Color.Green;
            var temp = i + 1;
            this.Controls.Add(btnAdd);

            this.Controls[btnAdd.Name].MouseClick += (sender, e) =>
            {
                int index = temp;
                generalMethods.generatePopup(sender, e, index);
            };

            string address = dataTable.Rows[i]["deviceIP"].ToString();
            int port = int.Parse(dataTable.Rows[i]["devicePort"].ToString());

            ThreadStart workerThread = delegate { start(address, port, i); };
            new Thread(workerThread).Start();

            x = (x + 75);
            if (i != 0 && (i % 5) == 0)
            {
                x = 12;
                y = y + 30;
            }
            if (i == 25)
            {
                Button btnPreviousPage = new Button();
                btnPreviousPage.Text = "<";
                btnPreviousPage.Location = new Point(150, 350);
                btnPreviousPage.Tag = "left";
                this.Controls.Add(btnPreviousPage);

                Button btnNextPage = new Button();
                btnNextPage.Text = ">";
                btnNextPage.Location = new Point(225, 350);
                btnNextPage.Tag = "right";
                this.Controls.Add(btnNextPage);
            }
        }
    }
    public void start(string address, int port, int i)
    {
        if (timer == null)
        {
            timer = new System.Timers.Timer(1000);

            timer.Elapsed += delegate(object sender, ElapsedEventArgs e) { timerElapsed(sender, e, address, port, i); };
        }
        timer.Enabled = true;
        // MessageBox.Show("Thread " + i + " Started.");
    }
    public void timerElapsed(object sender, ElapsedEventArgs e, string address, int port, int i)
    {
        bfdeviceimp.newconnect(address, port, i);
    } 
```

最后是我的设备类：

```
 class bf2300deviceimp : IdeviceInterface
{
   public void newconnect(string address, int port, int buttonNumber)
    {
        //send data
        byte[] bData = new byte[71];
        bData[0] = 240;
        bData[1] = 240;
        bData[2] = 0;
        bData[3] = 1;
        bData[68] = 240;
        bData[69] = 240;
        bData[70] = this.newCalculateCheckSum(bData);

        try
        {
            byte[] result = this.newSendCommandResult(address, port, bData, 72);

           //form1.setAlarmColour(result, buttonNumber);
        }
        catch (Exception ex)
        {
            MessageBox.Show(ex.ToString());
        }

    } 
```

你会建议我把 statechanged 处理程序放在哪里？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T14:15:58.020

您应该使用基于事件的方法来解决此问题，就像在表单之间传递信息时经常出现的情况一样。您的每个设备都应该有一个自定义事件，它们定义了当该设备的状态发生变化时会触发该事件。该事件可能应该只在与该设备交互的接口中定义。表单在创建各种设备类时应该订阅事件，并且在事件处理程序中它应该适当地更新按钮/文本框。

如果您不习惯这种编程风格，这可能是一个相当不错的选择。随时在评论中询问更多细节，我可以详细说明为什么我以我的方式做某事或它实际上做了什么。

```
public Form1()
{
    InitializeComponent();

    //not sure if this is on initialization or in a button click event handler or wherever.
    IDevice device = new SomeDevice();
    device.StatusChanged += GetHandlerForDevice(1);
    device.DoStuff();

    IDevice device2 = new SomeDevice(); //could be another class that implements IDevice
    device.StatusChanged += GetHandlerForDevice(2);
    device.DoStuff();
}

/// <summary>
/// The handlers for device status changed only vary based on the button number for each one.
/// This method takes a button number and returns an event handler that uses that button number.
/// </summary>
/// <param name="buttonNumber"></param>
/// <returns></returns>
private EventHandler<StatusChangedEventArgs> GetHandlerForDevice(int buttonNumber)
{
    //use currying so that the event handler which doesn't have an appropriate signature
    //can be attached to the status changed event.
    return (sender, args) => device_StatusChanged(sender, args, buttonNumber);
}

private void device_StatusChanged(object sender, StatusChangedEventArgs args, int buttonNumber)
{
    this.Invoke((MethodInvoker)delegate
    {
        txtOutput1.Text = (args.CurrentStatus == IDevice.Status.Green ? "HIGH" : "LOW"); // runs on UI thread

        if (args.CurrentStatus == IDevice.Status.Green)
        {
            this.Controls["btn" + buttonNumber].BackColor = Color.Green;
        }
        else
        {
            this.Controls["btn" + buttonNumber].BackColor = Color.Red;
        }

    });
}

public interface IDevice
{
    event EventHandler<StatusChangedEventArgs> StatusChanged;
    Status CurrentStatus { get; }

    public enum Status
    {
        Green,
        Red
    }

    void DoStuff();
    // rest of interface ...
}

public class StatusChangedEventArgs : EventArgs
{
    public IDevice.Status CurrentStatus { get; set; }
    //can add additional info to pass from an IDevice to a form if needed.
}

public class SomeDevice : IDevice
{
    public event EventHandler<StatusChangedEventArgs> StatusChanged;

    private IDevice.Status _currentStatus;
    /// <summary>
    /// Gets the current status of the device this object represents.
    /// When set (privately) it fires the StatusChanged event.
    /// </summary>
    public IDevice.Status CurrentStatus
    {
        get { return _currentStatus; }
        private set
        {
            _currentStatus = value;
            if (StatusChanged != null)
            {
                StatusChangedEventArgs args = new StatusChangedEventArgs();
                args.CurrentStatus = value;
                StatusChanged(this, args);
            }
        }
    }

    public void DoStuff()
    {
        //... do stuff
        CurrentStatus = IDevice.Status.Green; //will fire status changed event
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T14:19:05.453

移动表单中方法内的所有逻辑并在外部使用它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T14:23:45.613

在您的表单中创建一个属性

```
public SynchronizationContext SyncContext { get; set;} 
```

在表单构造函数中添加：

```
this.SyncContext = WindowsFormsSynchronizationContext.Current; 
```

制作界面：

```
public Interface IChangeClient 
{
    void Process(<some_type> result); // place your logic here
} 
```

（或类似的东西）并在您的表单中实现它以更改您的按钮和文本。

扩展您的原始界面以使用（可能作为参数）`SynchronizationContext`和`IBackgroundChangeClient`.

而且您的代码看起来像这样：

```
if (result != null)
{
    oSyncContext.Post(new System.Threading.SendOrPostCallback(
            delegate(object state)
            {
                IBackgroundChangeClient client = (state as object[])[0] as IBackgroundChangeClient
                //i dont konw the type of this
                var innerResult= (state as object[])[1];
                client.Process(innerResult);
            }), new object[] { oBackgroundChangeClient, result[4]});

} 
```

# android - 有没有一种简单的方法可以读取一个特定文件夹中的所有 *.png 文件？

> ID：10739056
> 
> 赞同：0
> 
> 时间：2012-05-24T14:04:13.493
> 
> 标签：android, file, listview, android-arrayadapter

我找到了很多方法来做到这一点，但它们都不简单（而且我无法实现更复杂的方法，所以我正在寻找更简单的解决方案）。我想用我用来从应用程序保存一些 png 的目录中的所有 png 文件的名称填充我的 ArrayAdapter。这个很棒：http://www.dreamincode.net/forums/topic/190013-creating-simple-file-chooser/ 但并不容易。我相信有一种更简单的方法，我只是找不到它（我真的做了功课，并且一直在寻找它）。我假设像 File.listFiles() 这样的东西可以工作，我只是不知道怎么做。

我的代码：

```
 public void onCreate(Bundle icicle) {
    super.onCreate(icicle);
    this.requestWindowFeature(Window.FEATURE_NO_TITLE);

    String[] values = new String[] ;

    ArrayAdapter<String> adapter = new ArrayAdapter<String>(this, android.R.layout.simple_list_item_1, values);
    setListAdapter(adapter);
    getListView().setBackgroundDrawable(getResources().getDrawable(R.drawable.diver));
}

@Override

protected void onListItemClick(ListView list, View v, int position, long id) {
    list.setBackgroundDrawable(getResources().getDrawable(R.drawable.diver));
    String item = (String) getListAdapter().getItem(position);

    setContentView(R.layout.table);
    myWebView = (WebView)findViewById(R.id.myWebView);
    myWebView.setInitialScale(50);
    myWebView.getSettings().setBuiltInZoomControls(true);
    myWebView.loadUrl(Environment.getExternalStorageDirectory()+ File.separator + "DivePlanner" + File.separator + item);

} 
```

我需要用目录 /sdcard/DivePlanner/ 中所有 png 文件的名称填充 values[]。如果有人知道任何简单的方法来做到这一点，非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T14:13:56.237

是的，您应该使用 File.listFiles() 方法从所需文件夹中获取所有文件。当您有一个文件数组时，您应该简单地遍历它，并从每个文件中检索其名称。

如果您只想要 .png 文件，请检查 java FileFilter 类及其用法

为了您的方便，请看这里：

[http://www.exampledepot.com/egs/java.io/GetFiles.html](http://www.exampledepot.com/egs/java.io/GetFiles.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T14:39:27.603

你可以使用这样的东西：

```
final File directory = new File(path);
if(!directory.exists() || !directory.isDirectory()){
    //do something
}
final Collection<String> pngFilenames = new HashSet<String>();
for(final String filename : directory.list()){
    if(filename.endsWith(".png")){
        pngFilenames.add(filename);
    }
}
final String[] values = (String[])pngFilenames.toArray(new String[pngFilenames.size()]); 
```

# c# - 有条件地合并来自两个列表的数据

> ID：10739059
> 
> 赞同：1
> 
> 时间：2012-05-24T14:04:21.030
> 
> 标签：c#, .net, linq, linq-to-entities

有条件地合并来自两个列表的数据

表结构如下

```
MobileID   ModelID   ManufacturerID    IsApproved 
```

其中 IsApproved 是布尔值，

当新的移动进入数据库时​​，它会提交给经理批准，直到它的IsApproved值为0，当它获得批准时IsApproved值将变为1。

我想做如下

我正在使用下面写的第一个查询获取所有批准的移动设备的列表

现在的问题是我必须根据 2 个条件显示所有手机

1) 如果存在具有相同模型ID 和制造商ID 的手机（意味着规范已更新），则其 IsApproved 字段将变为 0 --> 不在数据库中，但在列表中仅用于显示目的）

2) 如果 Mobile 是新的，则其 IsApproved 状态应为 0

我应该怎么做才能有条件地合并这两个列表？

我的 LINQ 查询如下

```
var listApproved = objMobile.MobileLists.where(mb => mb.IsApproved == true).toList();
var listUnApproved = objMobile.MobileLists.where(mb => mb.IsApproved == false).toList(); 
```

假设表数据如下

```
MobileID    ModelID     ManufacturerID     IsApproved
01            mod1             manu1               1
02            mod2             manu2               1
03            mod3             manu3               1
04            mod1             manu1               0
05            mod5             manu5               0
06            mod6             manu6               0
07            mod2             manu2               0 
```

我希望列表为

```
MobileID    ModelID     ManufacturerID     IsApproved
01            mod1            manu1            0
02            mod2            manu2            0
03            mod3            manu3            1
05            mod5            manu5            0
05            mod6            manu6            0 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T14:20:29.603

好吧，首先让我们将您的列表缓存在内存中以节省我们多次获取它的时间：

```
var listOfAllMobiles = objMobile.MobileLists.ToList(); 
```

现在让我们按照您的逻辑来获取所有手机：

```
var mobileList = listOfAllMobiles
    .Select(m => new Mobile
                 {
                     IsApproved = m.IsApproved == true && !listOfAllMobiles
                         .Any(l => l.ModelID == m.ModelID
                             && l.ManufacturerID == m.ManufacturerID
                             && l.MobileID != m.MobileID),
                     MobileID = m.MobileID,
                     ModelID = m.ModelID,
                     ManufacturerID = m.ManufacturerID
                 })
    .ToList(); 
```

**编辑：**上面的代码将设置正确的值，但它不会过滤掉带有重复`ManufacturerId`和的手机`ModelID`。您必须为此使用附加`foreach`功能，如下所示：

```
var displayMobileList = new List<Mobile>();

foreach(var mobile in mobileList
    .Where(m => !displayMobileList
        .Any(m2 => m2.ModelID == m.ModelID 
            && m2.ManufacturerID == m.ManufacturerID)))
{
    displayMobileList.Add(mobile);
} 
```

# c# - 收到readLine时如何调用函数

> ID：10739060
> 
> 赞同：2
> 
> 时间：2012-05-24T14:04:25.520
> 
> 标签：c#, serial-port, readline

我的程序需要通过串口接收字符串。问题是程序在没有输入时卡在 ReadLine 上。当 SP.ReadLine 读取一行时，有没有办法调用函数 startReading？

```
void GetInput()
{
        SerialPort SP = new SerialPort();
        SP.PortName = "COM3";
        SP.Open();
        string Line = string.Empty;
        While(Line == "")
         {
                    Line = SP.ReadLine();
                    Application.DoEvents();
         }
          StartReading();
}

void StartReading()
{
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T14:27:27.593

```
 private void GetInput()
    {
        SerialPort SP = new SerialPort();
        SP.PortName = "COM3";
        SP.DataReceived += new SerialDataReceivedEventHandler(SP_DataReceived);
        SP.Open();
    }

    private void SP_DataReceived(object sender, SerialDataReceivedEventArgs e)
    {
        SerialPort serialPort = (SerialPort)sender;
        string line = serialPort.ReadLine();
        StartReading();
    }

    private void StartReading()
    {
    } 
```

# c# - 使用 itextsharp.text.pdf 合并多个 itextsharp.text.pdf.PdfReader 对象后，文档看起来被剪切了

> ID：10739061
> 
> 赞同：2
> 
> 时间：2012-05-24T14:04:30.823
> 
> 标签：c#, pdf-generation, itextsharp, itext

我正在使用 iTextSharp 创建一个`List<PdfReader> _documents`包含多个 PDF 文档的文档。在此列表上使用合并创建单页文档并将其发送给客户端后，我看到 PDF 在 Adob​​e Reader 中看起来很剪裁。当我像这样突出显示图片时，我可以看到它在那里：

![在此处输入图像描述](../Images/d533598bef9a2832ac87b1622cbda348.png)

如果我保存它，它将是完整的。

如果我将`PdfReader`列表中的一个保存为单个 PDF 文档 - 没有合并 - 它看起来不错。

![在此处输入图像描述](../Images/deeecbabcf1f7d526f6a901ff301df9b.png)

合并函数是：

```
public void Merge(Stream outputStream)
{
    Document newDocument = null;

    try
    {
        newDocument = new Document();
        // Set margins and page size for the document 
        newDocument.SetMargins(50, 50, 50, 50);
        // There are a huge number of possible page sizes, including such sizes as 
        // EXECUTIVE, LEGAL, LETTER_LANDSCAPE, and NOTE 
        newDocument.SetPageSize(PageSize.A3 );

        PdfWriter pdfWriter = PdfWriter.GetInstance(newDocument, outputStream);

        newDocument.Open();
        PdfContentByte pdfContentByte = pdfWriter.DirectContent;

        if (EnablePagination)
        {
            _documents.ForEach(delegate(PdfReader doc)
            {
                _totalPages += doc.NumberOfPages;
            });
        }

        int currentPage = 1;
        foreach (PdfReader pdfReader in _documents)
        {
            for (int page = 1; page <= pdfReader.NumberOfPages; page++)
            {
                newDocument.NewPage();
                PdfImportedPage importedPage = pdfWriter.GetImportedPage(pdfReader, page);
                pdfContentByte.AddTemplate(importedPage, 0, 0);

                if (EnablePagination)
                {
                    pdfContentByte.BeginText();
                    pdfContentByte.SetFontAndSize(_baseFont, 9);
                    pdfContentByte.ShowTextAligned(PdfContentByte.ALIGN_CENTER,
                        string.Format("{0} of {1}", currentPage++, _totalPages), 520, 5, 0);
                    pdfContentByte.EndText();
                }
            }
        }
    }
    finally
    {
        outputStream.Flush();
        if (newDocument != null)
            newDocument.Close();
        outputStream.Close();
    }
} 
```

我怀疑这与它有关，`newDocument.SetPageSize(PageSize.A3);` 但我不确定，到目前为止我找不到解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T22:16:09.043

只是有几个想法可以尝试。该问题可能与缩放或调整大小有关。比较两个文档的水平缩放。此外，importedPage.PdfDocument.PageSize 需要与 pdfContentByte.PdfDocument.PageSize 进行比较，并且可能按比例缩小。

# c++ - 大型项目的 Emacs 教程

> ID：10739062
> 
> 赞同：11
> 
> 时间：2012-05-24T14:04:33.087
> 
> 标签：c++, c, emacs, emacs23

有人可以指导我使用 gdb 作为调试器的大型 C++ 项目的 emacs 教程，该项目确实包含 make 文件。

我确实搜索了 emacs 教程，但有些对初学者来说太高级了，有些只针对一个文件教程。我也确实阅读了以前的帖子，但没有找到适合大型项目的答案。另外我不习惯使用“git”，这是以前帖子中的答案之一。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-24T14:21:55.303

实际上，学习 Emacs 并非易事。您必须先学习基础知识，然后才能阅读“高级”教程。

您应该做的第一件事是完成内置教程（Ch t）。真的很棒。

然后，您应该尝试熟悉 Emacs 配置基础知识。许多用户建议的简单方法是获取一个现成的配置（例如[Emacs Starter Kit](https://github.com/eschulte/emacs24-starter-kit)）并尝试理解它，然后根据自己的需求和偏好进行定制。使用现成的配置工具包的优点是：

*   这是一个可用于学习 Elisp 基础知识的工作代码。这个学习路径比阅读 Elisp 手册和一次收集一小段配置代码要快得多。
*   它展示了许多有用的 Emacs 功能，否则可能需要您很长时间（有时是*几年*）才能发现。
*   它提供了一个框架，您可以基于该框架编写自己的配置。

毫无疑问，您仍然应该摆脱不需要的任何配置部分。

然后（或与上一步一起）阅读一些关于使用 Emacs 作为开发平台的教程。您可以通过向 Google 查询“用于 [c] 开发的 emacs”轻松找到很多教程。[这](http://web.physics.ucsb.edu/~taro/comp/tips/emacs/emacs-c-dev.html)是其中之一。

然后安装 Cedet（Alex Ott 写了一个很棒的[教程](http://alexott.net/en/writings/emacs-devenv/EmacsCedet.html)）并开始感受它的力量。

之后，您将知道下一步该做什么。

顺便说一句，Bozhidar Batsov 维护了大量[的 Emacs 资源。](http://batsov.com/articles/2011/11/30/the-ultimate-collection-of-emacs-resources/)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-24T16:52:52.523

从简单开始。*在没有任何*自定义的情况下启动 Emacs并开始编辑您的源文件。您需要进行基本编辑的唯一“教程”是通过点击`Control H`后跟`t`（`C-h t`在 Emacs 中引用）将获得的内置教程。

可以通过键入`M-x`( `Alt x`) compile 并按 Enter 来完成编译。它会提示您输入默认的编译命令`make`。将其更改为适合您的任何内容。

运行 gdb 是使用`M-x`gdb 并按 Enter 完成的。界面类似于`M-x`make。

不要使用像 Emacs starter kit 这样的东西，它会代表你做出假设。虽然作为新手的起点很有用，但它抑制了好奇心，这是学习 Emacs 的关键。以上内容应该足够你入手了。一旦你遇到问题，对做事的方式不满意，你可以搜索资源和东西。Emacs 不是一个“IDE”，因此您不会拥有许多自定义编辑器所具有的紧密集成。不要指望它。

# c# - 用户控件中的自定义工具提示

> ID：10739068
> 
> 赞同：1
> 
> 时间：2012-05-24T14:05:07.837
> 
> 标签：c#, tooltip, windows-8, windows-runtime, winrt-xaml

我正在使用在我的 App.xaml 中定义的自定义工具提示样式（没有 ax:key）

```
 <Style TargetType="ToolTip">
            <Setter Property="Foreground" Value="White" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ToolTip">
                        <Grid Background="#001f5b">
                            <VisualStateManager.VisualStateGroups>
                                <VisualStateGroup x:Name="OpenStates">
                                    <VisualState x:Name="Opened"/>
                                </VisualStateGroup>
                            </VisualStateManager.VisualStateGroups>
                            <ContentPresenter Margin="5"/>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style> 
```

但想在 UserControl 中使用另一种样式。

问题是，如果我在 UserControl 中定义样式，它不会覆盖 App.xaml 中的样式（例如，它适用于 ScrollBar），如果 App.xaml 中不存在样式，它也不起作用第一名。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T08:42:51.813

您是否尝试在 UserControl 中创建命名样式（带有键）并使用此键？

# joomla - Joomla 和 K2 - 使用数据库中的选项填充额外字段

> ID：10739069
> 
> 赞同：0
> 
> 时间：2012-05-24T14:05:08.010
> 
> 标签：joomla, joomla-k2

我们正在使用 Joomla！和 K2。是否可以“扩展”一个 K2 额外字段，以向管理员用户显示一个填充了数据库项目的下拉列表？所选项目的 ID 将针对额外字段存储。

这似乎应该很容易实现，但我还没有挖掘出很多关于扩展 K2 的信息。

谢谢，

托比

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T14:38:05.190

万一它对某人有帮助，我们通过覆盖 K2ModelItem（在 templates\our_template\code\com_k2\models 中）来实现这一点。我们将额外字段设置为列表类型，然后在我们自己的代码中添加以在 getItemExtraFields() 中预填充它。

托比

# linux - gcc：链接器输入文件未使用，因为链接未完成

> ID：10739072
> 
> 赞同：6
> 
> 时间：2012-05-24T14:05:17.167
> 
> 标签：linux, gcc

当我在 Linux 中运行 make 文件来编译 C 代码时，我收到以下错误：

```
gcc -Wall -fPIC -DSOLARIS -DXP_UNIX -DMCC_HTTPD -D_REENTRANT -I/opt/profile/OraAlert_test/code/include -I/usr/netscape/server4/plugins/include -I../../pwutils -I../../database/src  -I../../access/src -I/data/share/capscan/include -o getEnv.o -c ../src/
gcc: ../src/: linker input file unused because linking not done 
```

我曾尝试在 stackoverflow 中搜索相关问题并尝试了建议的解决方案。这仍然无法解决。有什么建议么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T14:36:28.317

您有一个没有源文件的编译命令。
它应该编译什么？

该错误确实具有误导性。它假定您想与 链接`../src/`，但`-c`表示不进行链接。

# objective-c - 替换字符串中的字母

> ID：10739076
> 
> 赞同：4
> 
> 时间：2012-05-24T14:05:40.047
> 
> 标签：objective-c, ios, nsstring, replace

您好，我有一个问题，我不知道如何解决。问题是我什至不知道如何用谷歌搜索它。我已经在互联网上花了几个小时寻找解决方案，但没有成功。情况是这样的：

我有字符串，可以说：

```
NSString *string = @"aąbcčdeęėfghiįjzž"; 
```

我的结果必须是这样的：

```
NSString *string = @"aabccdeeefghiujzz"; 
```

所以如果你明白我必须这样做：

将ą替换为

用 c 替换 č

用 e 替换 ė

用 e 替换 ę

等等..

也许有人可以帮助我？我有一个答案，但它不是很优化，我希望有一些更方便的解决方案。

提前致谢！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-24T20:17:13.797

让框架为您进行转换：

```
NSString *blah = @"aąbcčdeęėfghiįjzž";
NSData *data = [blah dataUsingEncoding:NSASCIIStringEncoding allowLossyConversion:YES];
NSString *newblah = [[NSString alloc] initWithData:data encoding:NSASCIIStringEncoding];
NSLog(@"new: %@", newblah); 
```

这记录：

```
new: aabccdeeefghiijzz 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-24T20:11:47.543

这将起作用：

```
NSString *str = @"aąbcčdeęėfghiįjzž";
NSLog(@"%@", str);
NSMutableString *s = [[str decomposedStringWithCompatibilityMapping] mutableCopy];
NSUInteger pos = 0;
while(pos < s.length) {
    NSRange r = [s rangeOfComposedCharacterSequenceAtIndex:pos];
    if (r.location == NSNotFound) break;
    pos = ++r.location;
    if (r.length == 1) continue;
    r.length--;
    [s deleteCharactersInRange:r];
}
NSLog(@"%@", s); 
```

这个想法是首先将每个带有变音标记的字符分解为其基本字符序列和一系列[Unicode 组合变音标记](http://www.fileformat.info/info/unicode/block/combining_diacritical_marks/index.htm)（由 完成`decomposedStringWithCompatibilityMapping`），然后遍历字符串，并逐个删除所有这些标记（这就是循环确实）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T14:10:00.840

我只能提供这个：

```
[string stringByReplacingOccurrencesOfString:@"ą" withString:@"a"]; 
```

等等...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-01-16T09:06:59.310

Dave DeLong 的回答会将“æ”替换为“ae”，将“ß”替换为“s”，但不会替换连字 –、ĳ、ff、fi、f、ﬃ、ﬄ、ﬅ、ﬆ、...

一个改进的解决方案是添加三行映射来处理一切正常：

```
blah = [blah stringByReplacingOccurrencesOfString:@"Œ" withString:@"OE"];
blah = [blah stringByReplacingOccurrencesOfString:@"œ" withString:@"oe"];
blah = [blah precomposedStringWithCompatibilityMapping];

NSData *data = [blah dataUsingEncoding:NSASCIIStringEncoding allowLossyConversion:YES];
NSString *newblah = [[NSString alloc] initWithData:data encoding:NSASCIIStringEncoding]; 
```

# c# - 如何在使用 TextBox 和 SIP 控件时摆脱 UnHandledException？

> ID：10739079
> 
> 赞同：1
> 
> 时间：2012-05-24T14:05:47.807
> 
> 标签：c#, windows-phone-7, textbox

就我而言，我有一个 TextBox 和两个按钮 Button1 和 Button2。这就是我正在做的事情..

```
private void Button1_click()
{
   TextBox.IsReadOnly = false;
}

private void Button2_click()
{
   TextBox.IsReadOnly = true;
   this.Focus()
} 
```

现在的流程，我在做什么......

1.  程序加载，我单击文本框，出现 SIP，然后单击屏幕上的某个位置，键盘消失。
2.  我按下 Button2，TextBox 变为只读，SIP 消失（如果显示）
3.  我点击文本框（当它仍处于只读模式时）
4.  我按下 Button1，然后单击 TextBox.. BOOOMM.. 程序因 UnHandledException 而崩溃。

...

我已经尝试过 TextBox 的 gotfocus() 和 LostFocus 但似乎没有任何帮助，就在崩溃之前，没有调用 TextBox 的 GotFocus。我点击文本框，突然它崩溃了。

真的想弄清楚过去 9 个小时会发生什么（哦，是的，我是愚蠢的程序员 :)

任何人都可以说明这个问题并告诉我任何可能的解决方案吗？

非常感谢 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-27T00:16:22.707

在这个问题上非常努力之后，我终于使用了两个单独的文本框，并在按钮点击时设置可见性真/假。

我删除了 TextBox 的所有事件，我尽可能地简化了代码（属性值和事件），但代码崩溃了。

不过我注意到一件事，

正如我的问题的第四点，我点击了 Button1，然后点击了 textBox，它崩溃了。但是当我像“按 Button1，**单击屏幕上的任意位置**，然后单击 TextBox 并没有崩溃）

奇怪的！

# structuremap - 使用带有 StructureMap 和 IDbConnection 的“按请求”方法 - 连接打开但在执行时关闭

> ID：10739084
> 
> 赞同：1
> 
> 时间：2012-05-24T14:06:00.363
> 
> 标签：structuremap, dapper

尝试使用 StructureMap 设置 Dapper 以利用“按请求”类型的场景。在我的 Global.asax 中，我有以下内容（修改自 Ayende 涉及 NHibernate 的旧帖子，我发现其中讨论了`BuildUp()`StructureMap 中的方法）：

```
protected static IDbConnection CreateConnection() { 
    var settings = ConfigurationManager.ConnectionStrings["MyConnectionString"];
    var connection = DbProviderFactories.GetFactory(settings.ProviderName).CreateConnection();
    if (connection == null) { 
        throw new ArgumentNullException("connection");
    }
    connection.ConnectionString = settings.ConnectionString;
    return connection;
}

public static IDbConnection CurrentConnection { 
    get { return (IDbConnection)HttpContext.Current.Items["current.connection"]; }
    set { HttpContext.Current.Items["current.connection"] = value; }
}

public Global() { 
    BeginRequest += (sender, args) => { 
        CurrentConnection = CreateConnection();
        CurrentConnection.Open(); 
    };

    EndRequest += (sender, args) => { 
        if (CurrentConnection == null) return;
        CurrentConnection.Close();
        CurrentConnection.Dispose();
    }
}

void Application_Start(object sender, EventArgs e) { 
    ObjectFactory.Initialize(x => { 
        x.For<IDbConnection>().Singleton().Use(CreateConnection());
        x.For<ICustomerRepository>().Use<CustomerRepository>();
        x.SetAllProperties(y => y.OfType<ICustomerRepository>());
    });
}

// BasePage.cs
public class BasePage : System.Web.UI.Page { 
    public IDbConnection CurrentConnection { get; set; }

    public BasePage() { 
        ObjectFactory.BuildUp(this);
    }
} 
```

每次我尝试调用它时，实际查询都会失败，并显示连接的当前状态已关闭，尽管 BeginRequest 处理程序上的断点显示正在连接上调用 Open()。

如果我在每个存储库方法内的 IDbConnection 上手动调用 Open 和 Close 似乎可行，但我试图尽可能避免这样做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T14:00:15.877

您正在将连接创建为单例。这意味着只有一个连接对象用于整个应用程序页面。页面永远不会使用您在 Application_Start 处理程序中新建的连接，因为它们将从容器中获取连接。

你最好使用这样的东西：

```
void Application_Start(object sender, EventArgs e) { 
    ObjectFactory.Initialize(x => { 
        x.For<IDbConnection>().HttpContextScoped().Use(() => CreateConnection());
        ...
    }
}

 public Global() { 
    EndRequest += (sender, args) => { 
        ObjectFactory.GetInstance<IDbConnection>.Dispose();
    }
 } 
```

# c# - 如何在 SSIS 中使用 foreach 循环容器来遍历多维数组？

> ID：10739087
> 
> 赞同：1
> 
> 时间：2012-05-24T14:06:04.467
> 
> 标签：c#, .net, sql, ssis, foreach

我有一个 SSIS 包，它使用脚本和一个 foreach 容器以及其他一些东西来更新几个表。我在 foreach 容器之前的脚本任务中使用`SqlConnection`并`SqlCommand`调用此查询：

`SELECT TOP 10 DirectoryID, DirectoryPath FROM ProjectDirectory ORDER BY LastAudit`

并使用`SqlDataReader`将它们添加到多维数组[10,2]。我将数组分配给一个对象变量`DirectoryList`，以便我可以在 foreach 循环容器中遍历它。它应该看起来像 { {"1", "C:\Folder1"}, {"2", "C:\Folder2"}, ...} 我相信。

问题是我几天前才开始使用这个软件，对 foreach 循环容器如何循环`DirectoryList`变量感到困惑。目前，在容器的集合选项卡中，我将 Enumerator 设置为 Foreach From Variable Enumerator，变量设置为`User::DirectoryList`. 我将变量`User::DirectoryID`设置为索引 0，并`User::DirectoryPath`设置为索引 1。我试图让它循环遍历数组的顶层，以便在每个循环中将 ID 和路径变量分配给“1”和“ C:\Folder1”，然后下次通过循环时，它们被分配给“2”和“C:\Folder2”等。我有一个脚本组件，它使用路径来查找一些信息，我使用id 更新 sql 表的正确行。

为了调试，我让它显示`MessageBox.Show(Variables.DirectoryID + ", " + Variables.DirectoryPath)`第一次迭代的 ID 和路径，它显示“8、8”。8 对应于应该首先显示的行的 id。下一次运行时，它给了我两次正确的路径，“C:\Folder1，C:\Folder1”。所以显然变量映射不起作用，它将两个变量映射到同一个索引。在任何情况下它都不起作用，所以我在想，变量枚举器的 Foreach 不是我应该选择的，或者我不能在 foreach 容器中使用多维数组。我已经搜索并没有发现任何东西，这一切可能很难理解，但是有什么建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T15:34:57.420

好的，你实际上不必那样做。由于您的源是 t-sql 查询，您可以使用“执行 sql 任务”运行它。不过没关系，也可以这样。我现在实际上正在研究一个包，它将结果集放入脚本任务的数据表中，并将其加载到对象变量中，就像您对 DirectoryList 所做的那样。

要读取值，只需像这样配置循环，其中变量是 Object 变量：

![在此处输入图像描述](../Images/6f71dbba287d0ab690b65cb53c7e6736.png)

并在映射选项卡上，如下所示： 其中变量是您希望将第一列（索引 0）的值放入其中的包变量。您可以拥有与结果集中的列一样多的索引。

![在此处输入图像描述](../Images/28a21dab91791ed5fc2edf3091e90777.png)

就是这样，在您的循环中，您将可以使用当前值访问您的变量

# java - 浮点的正则表达式

> ID：10739092
> 
> 赞同：1
> 
> 时间：2012-05-24T14:06:30.637
> 
> 标签：java, regex

我想要一个接受以下值的正则表达式：

*   01（无点）
*   01.0（点后一位数）
*   01.00（点后两位数）

并且不接受以下内容：

*   10.（点后无数字）
*   10.001（点后 3 位）

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T14:08:02.360

这将是这样的：`[0-9]*(\.[0-9]{1,2})?`

其中`{1,2}`代表点后的 1-2 位数字。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-24T14:10:51.463

一种可能的正则表达式是

```
\d*([.]\d{1,2})? 
```

这将匹配零个或多个数字，然后是一个包含一个点和一个或两个数字的可选组。

# jquery - Jquery：要在下拉列表中从一个页面切换到另一个页面，请单击

> ID：10739093
> 
> 赞同：2
> 
> 时间：2012-05-24T14:06:32.813
> 
> 标签：jquery, html

我的页面中有一个下拉列表，其中包含两个选项。我想要的是，当用户在下拉列表中选择第二个值时，应该加载另一个页面。这意味着如何在单击下拉框值时切换页面。寻求帮助，我将我的 html 代码放在下拉列表中。

```
 <select id = "viewList" class="fl width160">
            <option>Target</option>
            <option>Source</option>
        </select> 
```

所以现在当用户点击源选项时，应该打开另一个 js 页面。以及我应该如何在 .js 文件（Jquery）中编写代码。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T14:15:31.547

这是代码：

```
 <select id ="viewList" class="fl width160">
      <option value="" selected>Please select</option>
      <option value="http://www.google.com">Google</option>
      <option value="http://www.yahoo.com">Yahoo</option>
  </select>
<script type="text/javascript">
$(function(){$('#viewList').bind('change', function(){if($(this).val()) window.location=$(this).val();});});
</script>​ 
```

看到[这个 jsfiddle](http://jsfiddle.net/7DxJC/8/)。请注意，它可能在 JSfiddle 中不起作用，因为它在 iframe 中运行代码。你可以[在这里测试](http://fiddle.jshell.net/7DxJC/8/show/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-04T12:24:22.680

看你需要像这样改变你的html代码

```
 <select id = "viewList" class="fl width160">
        <option value ="Target">Target</option>
        <option value ="Source">Source</option>
    </select>

$("#viewList").change(function() {
        if( $("#viewList").val =='Target')
    {
        _loadTargetList();
    }
    else
    {
        _loadSourceList();
    }   
}); 
```

这里`_loadTargetList`和`_loadSourceList`两者都是提供加载其 html 文件或 js 文件的位置的函数。这是一个如何加载html或js文件的例子如果你想先调用js然后通过js调用html然后去这个

```
codeLoadingMgr.loadInclude( path + '/Target.js', function() {
codeLoadingMgr.getHTML(path + '/Target.html', function(html) {
});
});
Other wise you can direct load the html also. 
```

希望这可以帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T14:10:34.403

```
$("#viewList").change(function() {
   if ($(this).find(':selected').text() == 'Source')
      window.location = 'urltogoto';
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-24T14:20:08.150

@PenchoIlchev 的解决方案是有效的，但如果您不想使用绑定方法，您可以尝试：

```
 <select id = "viewList" class="fl width160" onchange="change();">
        <option>Target</option>
        <option>Source</option>
    </select>​

function change(){
    url = $("#viewList option:selected").html();
    location.href = url;
}​ 
```

[http://jsfiddle.net/FKjFC/](http://jsfiddle.net/FKjFC/)

# delphi - FMX Direct 2D 问题

> ID：10739096
> 
> 赞同：2
> 
> 时间：2012-05-24T14:06:44.123
> 
> 标签：delphi, delphi-xe2, firemonkey, direct2d

大家下午好！

我目前的一个项目遇到了一个相当烦人的问题。我正在我当前的一个项目中使用硬件库（Andreas Hausladen 的 NVAPI Pascal 标头翻译）。这个库允许我从 NVIDIA GPU 检索信息。我用它来检索温度，在 Firemonkey 的帮助下`TAnimateFloat`，我正在调整定制表盘上的角度以指示温度。

由于 FMX 在 Windows 上默认为 Direct 2D，因此我可以使用任何各种“游戏玩家”工具（MSI Afterburner、FRAPS 等）来监控 FPS。

我遇到的问题是，当我将系统置于睡眠模式（挂起到 RAM/S3），然后再次启动它时，我的应用程序上的界面被黑屏（部分或完全），并且 UI 上什么也没有明显令人耳目一新。我定期调用 NVAPI 库的初始化并通过计时器检查结果，但这并不能解决问题。我也在运行`ProcessMessages`并`repaint`在父表盘上，它是子控件（因为我似乎无法找到`repaint`表单或等效项）。

我尝试了各种版本的库，每个版本都存在相同的问题。下一段表明这实际上不是问题，它实际上是渲染器的错误。

我有一个解决方案，但我想知道是否有更...​​优雅、可用的东西。我的解决方案涉及在我的项目源代码中添加`FMX.Types.GlobalUseDirect2D := False;`之前。`Application.Initialize`但是，这会强制 FMX 使用 GDI+ 而不是 Direct2D。它当然可以，但是如果可以的话，我想将 D2D 作为一个选项保持打开状态。我可以`FindCmdLineSwitch`根据参数打开/关闭此功能，但这仍然需要我重新启动应用程序才能从 D2D 更改为 GDI+，反之亦然。

奇怪的是，FPS 计数器（在我的例子中来自 FRAPS）表明 UI 中仍在发生活动（因为值会按预期发生变化），但 UI 本身并没有明显令人耳目一新。

这是与 Direct2D 相关的问题，还是 Firemonkey 实现的错误？更重要的是，有没有比禁用 D2D 更好的修复方法？最后，同样相关的是，是否可以在不先终止应用程序的情况下“重新初始化”应用程序（所以也许我可以允许用户在 GDI+ 和 D2D 之间切换而无需重新启动应用程序）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T15:58:23.020

这可能是更新 4 修补程序之前的 FM 问题 - 26664/QC 104210 修复了用户解锁后 FireMonkey HD 表单无响应的问题 - 安装它*可能会*为您解决问题。

更新应该是您从 EDN 下载的注册用户的一部分（直接链接[http://cc.embarcadero.com/item/28881](http://cc.embarcadero.com/item/28881)）。

# python - 可以使用 REST 服务的开源搜索 UI 项目

> ID：10739098
> 
> 赞同：1
> 
> 时间：2012-05-24T14:06:47.307
> 
> 标签：python, api, search, search-engine, django-haystack

我正在尝试找到解决我当前问题的方法。让我解释一下：我需要找到一个可以使用我选择的 REST 服务并且高度可配置的搜索 UI。我在网上搜索并找到了 Solr 的 Blacklight Search UI（用 Ruby 编写）。我还查看了 Haystack (for django)，这似乎更有希望，因为在文档的某个地方我发现您可以将 Haystack 链接到您的自定义搜索引擎。开箱即用的 Haystack 支持 Solr、Xapian 和其他 2 个我现在不记得了。

我试图找到的是一个用 Java、PHP（最后的手段！）或 Python 编写的 UI，它允许我为我的 API 指定端点并使用一些配置（我不希望它用完框）它应该能够查询 API 并返回结果。

如果这是不可能的，那么有人可以建议我一些接近我描述的东西并允许我编写自己的后端代码来链接到 API 吗？一个干草堆的例子也可以......

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-24T11:55:35.997

我对这个话题也很感兴趣。我知道支持 FAST、Solr、Yahoo!、通用 XML 等的[SESAT](http://sesat.no/)框架，但它很旧且维护不善，而且还试图做的不仅仅是一个简单的前端。

您还有[AJAX-Solr](http://evolvingweb.github.com/ajax-solr/)，它显然只支持 Solr。

我已经在推特上转发了你的问题，希望其他人也能填写。

# arrays - Node JS：导入大数组，然后执行正则表达式

> ID：10739099
> 
> 赞同：0
> 
> 时间：2012-05-24T14:06:54.873
> 
> 标签：arrays, multithreading, node.js

我正在构建一个命令行工具，并希望在这种特殊情况下使用 Node JS。

我有一个 TXT 文件，我想在每行上执行正则表达式并在另一个函数中使用它们。

1) 我是否应该使用 readFileSync 或 readFile 将 TXT 文件导入转换为 ARRAY，然后遍历该数组的元素？

2) 我应该使用 readLines 吗？

该文件的大小可能高达 5 MB，但随着时间的推移它会变得越来越大（最多数百个）。

3) 我应该为此特定目的使用 Python、Ruby 或任何其他语言吗？任何其他语言会使其变得更好吗？（请回答前两个问题，因为我可能无法使用不使用节点和选择不同的东西）

最终，我希望所有这些数据都存储在内存中，以便在不同时间重复使用，所以任何其他解决方案，只要它会很快，我都可以考虑。

非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T14:44:18.317

3) 你应该使用异步的东西，比如 Node.js。好处是您可以读取文件的一部分并在现场处理它（但在这种情况发生时不会阻塞整个应用程序并且不会缓冲整个文件），然后移动到下一个块，依此类推。如果您愿意，您可以随时暂停直播。

2）我认为你应该逐行阅读（然后处理）文件。

1）你绝对应该选择一个readStream：[http ://nodejs.org/docs/v0.6.18/api/fs.html#fs_class_fs_readstream](http://nodejs.org/docs/v0.6.18/api/fs.html#fs_class_fs_readstream)

这样您就不必等待整个文件被读取（并保存在内存中）。这是关于如何使用 readStream 和运营商 (https://github.com/pgte/carrier) 实现这一目标的小片段：

var fs = 要求（'fs'），运营商 = 要求（'运营商'），文件 = 'test.txt'，流；

stream = fs.ReadStream(file, { encoding: 'UTF-8' }); 运营商.carry（流，函数（行）{extractWithRegex（行）；}）；

# c# - 同时用户在数据绑定 DataGridView 中进行更改的问题

> ID：10739102
> 
> 赞同：2
> 
> 时间：2012-05-24T14:07:06.700
> 
> 标签：c#, winforms, linq, entity-framework, datagridview

目前的情况是有一个数据绑定数据网格视图，许多人每天都需要同时对其进行更改。网格必须能够保存和更新，但它不能正常工作，因为它非常活跃。

这是场景：

1.  3人同时打开网格表格。
2.  他们对 3 行不同的数据进行更改。
3.  第 1 个人保存更改并成功。
4.  人员 2 保存更改并成功，但人员 1 的更改现在已消失，因为人员 2 的网格未与人员 1 刚刚提交的数据同步。
5.  第 3 个人保存更改并清除第 1 个人和第 2 个人所做的任何事情，因为第 3 个人的数据网格视图未与更新的数据同步。

我首先尝试了这种方法：

```
 private MySqlDataAdapter da;
    private MySqlConnection conn;
    BindingSource bs = new BindingSource();
    DataSet ds = null;
    string qry;
    string ConnString = System.Configuration.ConfigurationManager.AppSettings["ConnectionString"];

    // THE LOAD METHOD
    private void LoadDataToGrid(string srcTable, string query)
    {
        conn = new MySqlConnection(ConnString);
        // ADD ANY QUERY
        qry = query;
        da = new MySqlDataAdapter(qry, conn);
        conn.Open();
        ds = new DataSet();
        MySqlCommandBuilder cb = new MySqlCommandBuilder(da);

        // USE TABLE NAME
        da.Fill(ds, srcTable);
        //USE TABLE NAME
        bs.DataSource = ds.Tables[srcTable];
        dataGridView1.DataSource = bs;

        // CUSTOMIZE GRID
        txtRows.Text = dataGridView1.Rows.Count.ToString();
        dataGridView1.AutoResizeColumns();
        dataGridView1.AllowUserToDeleteRows = false;
    }

    // THE SAVE METHOD
    private void SaveDataFromGrid(string srcTable)
    {
        // USE TABLE NAME
        DataTable dt = ds.Tables[srcTable];
        this.dataGridView1.BindingContext[dt].EndCurrentEdit();
        this.da.Update(dt);

        txtRows.Text = dataGridView1.Rows.Count.ToString();
    } 
```

由于上述原因，这对我来说并不奏效。只是没有正确保存数据。

这是我的第二个想法，但仍然存在上述问题：

```
 // Load event
   dataGridView1.DataSource = context.TableName;

   // btnSave_click Event
   connection.open();

       // loop through cells in current row and apply changes by id

   context.tableName.Attach(DataFromGrid);
   context.ObjectStateManager.ChangeObjectState(DataFromGrid, System.Data.EntityState.Modified);
   context.savechanges(); 
```

基本上，我该如何解决这个断开连接的问题？以前有人遇到过这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T22:40:09.893

这个问题可能比一个代码片段要解决的更复杂。在开始实施之前，您似乎有几件事要先解决；

首先; 每个人的更改实际上是否必须提交整个网格？根据您的方案，每个人都会更改不同的数据行。修改您的代码以仅将更改提交到已修改的行将大大减少您的冲突场景。

其次，无论冲突是发生在一行还是多行，您都需要决定如何管理冲突（您没有注意到预期会发生什么 - 例如；数据库获胜，用户的选择等）。

EF 实现了乐观并发模式（无数据库锁），但是默认情况下，它只会在您提交本地更改时选择覆盖数据库更改。您需要修改 EF 配置以设置 ConcurrenyMode=Fixed 以便在提交行之前没有“获得最新”时它不会自动覆盖更改。

有关 EF 如何处理并发的更多信息，请参见此处：http: [//msdn.microsoft.com/en-us/library/bb738618.aspx](http://msdn.microsoft.com/en-us/library/bb738618.aspx)

修改 EF 配置后，当检测到冲突时，您将开始收到异常，您需要通过刷新数据库中的数据（使用本地更改）或刷新本地数据（使用数据库更改）来处理）。

# windows - Windows bat 文件相当于 bash 字符串操作

> ID：10739106
> 
> 赞同：2
> 
> 时间：2012-05-24T14:07:20.363
> 
> 标签：windows, bash, batch-file

我将如何实现这一目标：

```
for i in *.e; do mv $i ${i%-b*.e}.e; done 
```

在 Windows 批处理文件中？（它将包含“-b”的文件重命名为“-b”之前的部分。请注意，这不一定是字符串的结尾！例如“file-b-4.e”将变为“file.e”）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-24T15:44:14.007

如果您真的想批量执行此操作，则应该可以

```
@echo off
setlocal disableDelayedExpansion
for %%F in (*.e) do (
  set "var=%%~F"
  setlocal enableDelayedExpansion
  set "var=!var:-b=.e:!"
  for /f "eol=: delims=:" %%A in ("!var!") do (
    endlocal
    echo ren "%%F" "%%A"
  )
) 
```

***编辑***
panda-34 的评论暗示如果文件名以`-b`. 上面的代码是通过将扩展合并到替换字符串中来修复的。*（感谢 panda-34 提醒我这个问题）*

panda-34 还提供了一个替代解决方案，它使用带有搜索和替换的命令注入。注入的命令是 REM 语句。

只要文件名不包含`&`或`^`字符，panda-34 解决方案就可以工作，但如果包含，则会失败。

下面是命令注入技术的修改版本，它应该适用于所有有效的 Windows 文件名。有 2 个关键模块，1）确保文件名中的特殊字符始终被引用，2）不要将值作为 CALL 参数传递，否则`^`将加倍为`^^`.

```
@echo off
setlocal disableDelayedExpansion
for %%i in (*-b*.e) do (
  set old="%%~ni"
  call :ren_b
)
exit /b
:ren_b
set v=%old:-b=.e"&rem "%
echo ren "%old:~1,-1%.e" %v%
exit /b 
```

***最终编辑（我希望）：***
正如巴鲁克在他的评论中指出的那样，上面的解决方案从第一次出现开始删除，而原始 bash 命令从最后一次出现开始删除。

下面是一个与原始 bash 命令完全等效的版本。

```
@echo off
setlocal disableDelayedExpansion
set "search=-b"
for %%A in (*%search%*.e) do (
  set "old=%%A"
  setlocal enableDelayedExpansion
  set "new=\_!old:%search%=\_!"
  for %%B in ("!new!") do (
    endlocal
    set "new=%%~pB"
    setlocal enableDelayedExpansion
    set "new=!new:~2,-1!.e"
    echo ren "!old!" "!new:\_=%search%!"
    endlocal
  )
) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-24T18:01:00.940

简单，真的

```
for %%i in (*-b*.e) do call :ren_b %%~ni
goto :eof
:ren_b
set v=%*
set v="%v:-b=.e" ^& rem %
ren "%*.e" %v% 
```

这是一个将名称保留到最后一次出现的变`-b`体

```
setlocal enabledelayedexpansion
for %%i in (*-b*.e) do (
    set v=%%~ni
    set v=!v:-b=\!
    for %%j in ("\!v!") do (
        set v=%%~pj
        set v=!v:~1,-1!
        set v=!v:\=-b!
        ren "%%i" "!v!.e"
    )
) 
```

`!`对于包含并以 . 开头的名称，它将失败`-b`。

*PS，*没看到，dbenham 已经提供了等效的解决方案，可能对文件名的终端情况有更多的规定。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-24T14:18:15.720

算了，一些方便的事情在 NT 脚本中是做不到的。据我所知，你在这里问的是不可能的。而且我使用各种技巧编写和维护了大于 50 KiB 的复杂 NT 脚本。“Windows NT Shell Scripting”一书指出了其中的许多内容，同样的内容和更多内容请参见[Rob van der Woude 的脚本页面](http://www.robvanderwoude.com/)。

我认为您可以完成其中的一部分，但由于变量扩展在 NT 脚本中的工作方式，因此肯定不能单行。例如，您可以提取您期望的字符串部分`-b`并检查它是否为`-b`，然后提取其他部分并将原始名称重命名为仅由提取部分组成的名称。

但是你可能需要十到十五行来实现这一点。鉴于此，请考虑为此目的使用不同的脚本语言。特别是如果这是现代 Windows 版本。

我意识到这不是想要的答案（即这是可能的并且是一个示例），但`cmd.exe`与 Bash 相比非常有限，尽管远没有传统批处理脚本的一些反对者指出的那样有限。

# manifest - 更改清单文件中的支持页面后，我们是否需要在谷歌市场上重新发布应用程序？

> ID：10739108
> 
> 赞同：1
> 
> 时间：2012-05-24T14:07:37.453
> 
> 标签：manifest, google-apps-marketplace

我在 Google Marketplace 上发布了一个应用程序，它的清单文件中有一个支持页面 URL。更改支持页面 URL 后是否需要重新发布应用程序？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T14:04:58.327

如果您的应用程序在谷歌应用程序市场中获得批准，并且如果您对列表进行一些更改，只是保存它会使更改受到影响。

但如果您的应用尚未获得批准，则需要重新提交。这样 Google 市场团队就会意识到这些变化。

# javascript - 在Javascript错误中将字符串转换为浮点数

> ID：10739109
> 
> 赞同：1
> 
> 时间：2012-05-24T14:07:37.720
> 
> 标签：javascript, internet-explorer

请参阅下面的代码，我得到错误的值。

例如;

```
 var FirstValue=0.00;
 var secondvalue=parseFloat("22.88",10).toFixed(2);    
 var thirdvalue=(FirstValue) +   (secondvalue); 
```

我得到了像“22.8822.88”这样的价值

请帮我解决。它不会转换为数字。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-24T14:13:44.377

toFixed 将您的浮点值转换为字符串。因此，当您添加两个值时，您将获得的不是数字加法而是字符串连接：

```
2.0 + 2.0 = 4.0 // number
"2.0" + "2.0" = "2.02.0" // string 
```

转换后移除固定。比添加两个值而不是固定：

```
var FirstValue=0.00;
var secondvalue=parseFloat("22.88",10);    
var thirdvalue= ( (FirstValue) +   (secondvalue) ).toFixed(2); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T14:14:46.937

尝试这个：

```
 var FirstValue=0.00;
 var secondvalue=parseFloat("22.88");
 secondvalue = parseFloat(secondvalue.toFixed(2));   
 var thirdvalue=(FirstValue) +   (secondvalue); 
```

[`toFixed`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Number/toFixed)返回一个字符串，而不是数字，因此需要再次转换。

# c - 在c中实现堆栈

> ID：10739110
> 
> 赞同：4
> 
> 时间：2012-05-24T14:07:41.970
> 
> 标签：c, malloc

我想让堆栈与动态内存分配一起使用，但我需要知道哪个更有效：
例如，初始大小为 10，然后如果需要更多，我将其加倍。
或者我可以有一个初始大小 = 1 并为每个新输入添加一个位置。！？！

```
int *tmp = malloc(sizeof(int) * 2 * dm->capacity); \* dm->capacity = 10 *\
int *tmp = malloc(sizeof(int)); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-24T14:09:10.597

在需要时加倍效率更高。

如果您为每个 push 操作分配一个新数组，那么您所做的工作量与堆栈元素数量的*平方*成正比（当您 push element 时`N+1`，您必须将先前的`N`元素复制到新数组中）。

如果您在需要时将数组加倍，那么您所做的副本数与 N 的对数成正比，并且对于任何非平凡大小的堆栈，如您所知，这要小得多。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T14:15:37.130

这是一个破碎的问题。哪个“更有效”完全取决于您的域。如果你有很多长度为 3 和 4 的堆栈，那么预先分配 10 并随后休眠 5 年将比从 1 开始并加倍更快。如果你有很多长度为 1 的堆栈，那么分配 10 是一种浪费。

当然，当我说“浪费”时，我的意思是浪费了宝贵的几纳秒，你将永远无法回来。假设您使用的是“普通”计算机并且没有在 Conway 的生命游戏中实现 C 或任何不寻常的东西，在这种情况下，这些分配可能很重要。因此，对其进行分析并找出答案。

如果你想要一些简单且更有可能有效的东西，那么先分配 10 个，然后在需要时加倍。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-24T14:20:04.257

这取决于。通常加倍会更有效，但这种方法会浪费大量空间（多达一半的分配空间未使用）。您的逐一增加方法没有这个缺点。但是，每次添加时都必须复制整个数组确实效率低下。因此，如果空间效率是您最关心的问题，您最好将堆栈表示为链表。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-24T14:44:29.473

必要时将堆栈大小加倍的摊销成本比初始化为 1 低很多。所以是的，加倍更好。话虽如此，我也会推荐一个适当的删除方案。当当前堆栈的 1/4 正在使用时，类似于释放一半堆栈的东西。以这种方式，边缘加法和减法不会破坏效率。

# shell - 如何在脚本中的特定字符后插入新行

> ID：10739111
> 
> 赞同：5
> 
> 时间：2012-05-24T14:07:42.673
> 
> 标签：shell, unix, scripting

我有以下（example.txt）文件：

```
blue(4) red(8) green(5) yellow(19) brown(60) black(5) 
```

如何在 unix 中实现以下结果？

```
blue(4) 
red(8) 
green(5) 
yellow(19) 
brown(60) 
black(5) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-24T14:11:37.370

如果您需要在右括号后插入换行符，请尝试

```
sed 's/) \?/)\n/g' example.txt 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-24T14:10:21.707

以下内联 sed 脚本将用换行符替换空格，并且应该可以解决您的问题。

```
sed -i 's/ /\n/g' example.txt > example_out.txt 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-24T14:11:29.753

```
xargs -n 1 < example.txt 
```

通过传入`example.txt`xargs[一次](http://unixhelp.ed.ac.uk/CGI/man-cgi?xargs)接受一个参数`-n 1`，xargs 会将每个条目放在单独的行上。

例如，每行放置两个条目只需`-n 1`将`-n 2`

该选项在[手册页](http://unixhelp.ed.ac.uk/CGI/man-cgi?xargs)`-n`上也有提及。`max-args`

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-24T14:10:24.297

将您的数据传递给这个 sed 命令，如下所示：

```
sed 's/ /\n/g' example.txt 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-09-27T14:16:28.073

我需要实现这样的目标并使用`sed`命令。它可用于对流执行功能。

根据您的要求，您可以像这样使用它：

```
sed -i 's/ /\n/g' example.txt 
```

[您可以在sed 手册页](https://linux.die.net/man/1/sed)中阅读更多相关信息。

# html - 如何防止 Pinterest Pin It 书签链接以获取 Google 地图图像

> ID：10739114
> 
> 赞同：2
> 
> 时间：2012-05-24T14:07:45.143
> 
> 标签：html, bookmarklet, pinterest

在我的网站上使用谷歌地图，当我点击从他们的 pinterest.com/about/goodies/ 页面导入到书签栏的 Pin It 小书签时，它会选择谷歌地图图像。

如何指定不固定在包含谷歌地图小部件的 div 标签内找到的图像？

我不能单独将 nopin 属性添加到谷歌地图图像，因为这些标签是由谷歌地图库动态生成的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-06T20:02:00.110

这就是我在地图初始化方法中所做的。我正在使用在加载瓷砖后将标签添加到图像中`jQuery`。`nopin`

```
google.maps.event.addListener(map, 'tilesloaded', function() {
    $('#map_canvas').find('img').attr('nopin','nopin');
}); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2016-08-19T16:30:03.770

这是一个稍微简单一点的答案，它更健壮一些。我自己处理完这个问题后才找到你的答案。只是想把我学到的东西传递出去。

```
google.maps.event.addListener(map, 'tilesloaded', function(){
    $('div.gm-style img:not([nopin=nopin])').attr('nopin','nopin');
}); 
```

无论您的地图的 id 是什么，这都将起作用，删除不必要的`find()`，并且仅针对尚未使用 nopin 标记的图像运行。这样，无论页面上有多少张地图，它都不会受到负面影响。

# asp.net - Microsoft .Net 4.0 图表：与同一 x 轴上的点不一致

> ID：10739120
> 
> 赞同：0
> 
> 时间：2012-05-24T14:08:00.130
> 
> 标签：asp.net, .net, vb.net, data-visualization

我正在使用 .net 4.0 System.Web.UI.DataVisualisation 库创建一个图表，并注意到一个奇怪的行为。

首先，我创建了一个包含两个数据点的系列，每个数据点在 X 轴上具有相同的值，如下所示：

```
Dim series As New Series()
series.Points.Add(New DataPoint(0, 10))
series.Points.Add(New DataPoint(0, 15))
'.. add to chart and render 
```

当我在浏览器中渲染这个图表时，我在 X 轴上得到两个点，两个点都具有相同的标签。

但是，当我在 x 轴上的不同值上添加另一个数据点时，如下所示：

```
Dim series As New Series()
series.Points.Add(New DataPoint(0, 10))
series.Points.Add(New DataPoint(0, 15))
series.Points.Add(New DataPoint(1, 14))
'.. add to chart and render 
```

然后，图表仍然只在 X 轴上渲染两个点（0 和 1），并且前两个值（在 x 轴值 0 上）是垂直连接的！

任何人都知道为什么这种行为不同？任何一种行为都是可以接受的，但我希望能够选择其中一种......

谢谢！

山姆

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T15:06:04.297

如果您输入 0 作为数据点的 x 值，Series 将为您计算它。因此，如果您创建一个所有 x 值都为 0 的图表，该系列会将其解释为“x 值不重要，我会将所有项目呈现为 x 轴上的单独值”。但是，只要您添加了一个非 0 的 x 值，该系列就会开始使用您提供的 x 值。

[这在msdn](http://msdn.microsoft.com/query/dev10.query?appId=Dev10IDEF1&l=EN-US&k=k%28SYSTEM.WEB.UI.DATAVISUALIZATION.CHARTING.DATAPOINT%29;k%28TargetFrameworkMoniker-%22.NETFRAMEWORK,VERSION=V4.0%22%29;k%28DevLang-VB%29&rd=true)上被精彩地描述为：

```
The X-value can be zero, or you can set this explicitly. 
```

要解决您的问题，您必须将第一个系列定义为：

```
Dim series As New Series()
series.Points.Add(New DataPoint(1, 10))
series.Points.Add(New DataPoint(1, 15))
'.. add to chart and render 
```

这将正确呈现您的数据点。

# jquery - 单击按钮时显示选择选项

> ID：10739124
> 
> 赞同：0
> 
> 时间：2012-05-24T14:08:04.833
> 
> 标签：jquery

我有一个从我的数据库中填充的下拉列表。这个 ddl 将根据它将包含多少选项进行自我复制。例如，如果它包含 5 个选项，那么我将有 5 个具有相同选项的 ddl

```
<select id="select_1"><option>1</option><option>2</option></select>          
<select id="select_2"><option>1</option><option>2</option></select>
...and so on. 
```

这将用于链接查询。除了第一个选择选项之外的所有选项都将显示：无。我也有两个链接，一个说，另一个说或。我想要的是单击任一链接并删除为第二个 ddl 设置 display:none 的类，其标签对应于被单击的链接。例如，如果我单击 And 链接，我将在 ddl 旁边显示 And。我将如何使用 jquery 完成此操作，因为我很难弄清楚这一点。

```
<td id="study_select">
    <select id="study_select_1" name="studies_1">
    <option value="Study 1">Study 1</option>
    <option value="Study 2">Study 2</option>
    <option value="Study 3">Study 3</option>
    <option value="Study 4">Study 4</option>
    <option value="Study 5">Study 5</option>
    <option value="Study 6">Study 6</option>
</select>

<span id="and">
    <label id="andlab_2" class="invis_sel" for="study_select_2">And</label>
    <select id="study_select_2" class="invis_sel" name="studies_2">
        And<option value="And Study 1">Study 1</option>
        And<option value="And Study 2">Study 2</option>
        And<option value="And Study 3">Study 3</option>
        And<option value="And Study 4">Study 4</option>
        And<option value="And Study 5">Study 5</option>
        And<option value="And Study 6">Study 6</option>
    </select>
</span>
<span id="or">
    <label id="orlab" class="invis_sel" for="study_select2">Or</label>
    <select id="study_select_2" class="invis_sel" name="studies_2">
        <option value="Or Study 1">Study 1</option>
        <option value="Or Study 2">Study 2</option>
        <option value="Or Study 3">Study 3</option>
        <option value="Or Study 4">Study 4</option>
        <option value="Or Study 5">Study 5</option>
        <option value="Or Study 6">Study 6</option>
    </select>
</span>

<span id="and">
    <label id="andlab_3" class="invis_sel" for="study_select_3">And</label>
    <select id="study_select_3" class="invis_sel" name="studies_3">
        And<option value="And Study 1">Study 1</option>
        And<option value="And Study 2">Study 2</option>
        And<option value="And Study 3">Study 3</option>
        And<option value="And Study 4">Study 4</option>
        And<option value="And Study 5">Study 5</option>
        And<option value="And Study 6">Study 6</option>
    </select>
</span>

<span id="or">
    <label id="orlab" class="invis_sel" for="study_select3">Or</label>
    <select id="study_select_3" class="invis_sel" name="studies_3">
        <option value="Or Study 1">Study 1</option>
        <option value="Or Study 2">Study 2</option>
        <option value="Or Study 3">Study 3</option>
        <option value="Or Study 4">Study 4</option>
        <option value="Or Study 5">Study 5</option>
        <option value="Or Study 6">Study 6</option>
    </select>
</span>

<span id="and">
    <label id="andlab_4" class="invis_sel" for="study_select_4">And</label>
    <select id="study_select_4" class="invis_sel" name="studies_4">
        And<option value="And Study 1">Study 1</option>
        And<option value="And Study 2">Study 2</option>
        And<option value="And Study 3">Study 3</option>
        And<option value="And Study 4">Study 4</option>
        And<option value="And Study 5">Study 5</option>
        And<option value="And Study 6">Study 6</option>
    </select>
</span>

<span id="or">
    <label id="orlab" class="invis_sel" for="study_select4">Or</label>
    <select id="study_select_4" class="invis_sel" name="studies_4">
        <option value="Or Study 1">Study 1</option>
        <option value="Or Study 2">Study 2</option>
        <option value="Or Study 3">Study 3</option>
        <option value="Or Study 4">Study 4</option>
        <option value="Or Study 5">Study 5</option>
        <option value="Or Study 6">Study 6</option>
    </select>
</span>

<span id="and">
    <label id="andlab_5" class="invis_sel" for="study_select_5">And</label>
        <select id="study_select_5" class="invis_sel" name="studies_5">
        And<option value="And Study 1">Study 1</option>
        And<option value="And Study 2">Study 2</option>
        And<option value="And Study 3">Study 3</option>
        And<option value="And Study 4">Study 4</option>
        And<option value="And Study 5">Study 5</option>
        And<option value="And Study 6">Study 6</option>
    </select>
</span>

<span id="or">
    <label id="orlab" class="invis_sel" for="study_select5">Or</label>
        <select id="study_select_5" class="invis_sel" name="studies_5">
        <option value="Or Study 1">Study 1</option>
        <option value="Or Study 2">Study 2</option>
        <option value="Or Study 3">Study 3</option>
        <option value="Or Study 4">Study 4</option>
        <option value="Or Study 5">Study 5</option>
        <option value="Or Study 6">Study 6</option>
    </select>
</span>
<a id="chain_and">And</a> | <a id="chain_or">Or</a>  
</td> 
```

抱歉，它有点长而且丑陋，如果有帮助的话，这是我目前拥有的 jquery

```
$("#chain_and").click(function(){
    $("#study_select select").each(function (i) {
        //var i = i+i;
        if ($(this).attr('id') != 'study_select_1') {
            if ($(this).children('#and')) {
                var study='#study_select_'+i;
                if (!$(this).children(study).css('display') == 'none') {
                    return;                       
                }
                else{
                    $('#andlab_'+i).removeClass('invis_sel');
                    $(study).removeClass('invis_sel');
                    i++;
                }
            }    
        } 
        return;
   });    
}); 
```

# java - 是否可以保存 Java 类文件？

> ID：10739126
> 
> 赞同：4
> 
> 时间：2012-05-24T14:08:07.017
> 
> 标签：java, class, serialization

我环顾四周，但似乎没有什么能完全涵盖我想做的事情。是否可以在运行时保存`Class<?>`实例对象？如果是这样，我将如何去做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T14:10:17.990

您是否了解过使用 java**进行序列化的概念。**[此链接](http://www.tutorialspoint.com/java/java_serialization.htm)将帮助您解决问题。

简而言之， **Java.lang.Serializable**是您这样做的朋友。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-24T19:05:45.417

这是一组关于 Java 序列化的评论，而不是答案。只是其他答案中没有（尚未）的一些信息。

序列化不仅保存一个对象，它还保存它直接和间接引用的所有对象。这真的很酷，但是你可能会写一个小对象，然后发现你意外地创建了一个 10MB 的文件。

如果在您正在编写的对象中存在对不可序列化对象的引用，无论多么间接，则写入将引发异常。

如果您使用的是套接字，请定期重置 ObjectOutput 流。否则，除了第一次之外，每次写入对象时，发送的只是对原始数据的引用。发送具有连续值 1、2、3、4 和 5 的相同对象，读取的对象将具有 1、1、1、1 和 1 的值。此外，如果不重置，内存使用量将飙升，因为 ObjectOutput ObjectInput 会将发送的几乎所有内容保存在内存中。（虽然它只会保留每个不同对象的一份副本。）

如果类在写入和读取之间发生变化，则序列化不起作用。然而，巧妙地使用外部化可以解决这个问题。（如果您的 IDE 会让您忘记，请记住 serialVersionUID。）

外部化使您可以编写代码来序列化一个类。这可能非常有用。您可以输入版本号并检查它们，您可以省略不需要的数据，或者可以在读取期间重新创建数据。不过，它比自动序列化需要更多的工作。

在进行外部化读取时，请注意所有引用都可能引用数据尚未到达的对象；例如，您不能始终如一地从子对象列表中汇总金额。在 readObject 之后调用一个方法来设置需要计算的值可能是值得的。（发送冗余信息通常比重新计算要好。）

我以艰难的方式学到了这一切。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-24T14:16:48.970

我从[这个网站](http://www.javacoffeebreak.com/articles/serialization/index.html)了解了[序列化](http://docs.oracle.com/javase/1.4.2/docs/api/java/io/Serializable.html)。它很好地教授了这个概念。我建议从那里开始。

# java - 如何在给定文件夹名称的情况下创建多个目录

> ID：10739128
> 
> 赞同：2
> 
> 时间：2012-05-24T14:08:13.810
> 
> 标签：java, directory, organization

我有一个文件列表，这些文件的名称由一个类组和一个 id 组成`(eg. science_000000001.java)`

我能够获取所有文件的名称并将它们拆分，因此我将类组放入一个数组中，将 id 放入另一个数组中。我拥有它，因此数组不能有两个相同的值。

这就是问题所在，我想用这些类组和 id 创建一个目录，例如：

```
science_000000001.java    would be in    science/000000001/science_000000001.java
science_000000002.java    would be in    science/000000002/science_000000002.java
  maths_000000001.java    would be in      maths/000000001/maths_000000001.java 
```

但我想不出一种正确循环数组以创建适当目录的方法？

我也可以自己创建文件夹，只是获得正确的目录才是问题所在，有人有什么想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T14:13:38.817

鉴于：

```
String filename = "science_000000001.java"; 
```

然后

```
File fullPathFile = new File(filename.replaceAll("(\\w+)_(\\d+).*", "$1/$2/$0")); 
```

为您提供文件的完整路径，在这种情况下`science/000000001/science_000000001.java`

如果要创建目录，请使用以下命令：

```
fullPathFile.getParentFile().mkdirs(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T15:19:33.553

上面的答案非常适合使用该命名约定创建新文件。如果您想将现有文件分类到它们的相关类组和 Id 中，您可以使用以下代码：

```
public static void main(String[] args) {
    String dirPath = "D:\\temp\\";
    File dir = new File(dirPath);

    // Get Directory Listing
    File[] fileList = dir.listFiles();

    // Process each file
    for(int i=0; i < fileList.length; i++)
    {
        if(fileList[i].isFile()) {
            String fileName = fileList[i].getName();
            // Split at the file extension and the classgroup
            String[] fileParts = fileName.split("[_\\.]");
            System.out.println("One: " + fileParts[0] + ", Two: " + fileParts[1]);

            // Check directory exists
            File newDir = new File(dirPath + fileParts[0] + "\\" + fileParts[1]);
            if(!newDir.exists()) {
                // Create directory
                if(newDir.mkdirs()) {
                    System.out.println("Directory Created");
                }
            } 

            // Move file into directory
            if(fileList[i].renameTo(new File(dirPath + fileParts[0] + "\\" + fileParts[1] + "\\" + fileName))) {
                System.out.println("File Moved");
            }

        }
    }
} 
```

希望有帮助。

# php - 如何在 kohana 3.0 中从一种形式调用一个控制器的不同操作方法

> ID：10739129
> 
> 赞同：1
> 
> 时间：2012-05-24T14:08:14.480
> 
> 标签：php, kohana-3

我有一个带有两个按钮（add1，add2）的表单。因此，当我单击按钮*add1*时，我想调用`action_add1()`并单击按钮*add2*调用`action_add2()`。这两个函数都是`Controller_Welcome`.
我怎样才能做到这一点？

```
class Controller_Welcome extends Controller
{
    public function action_add1()
    {
       //some logic
    }
    public function action_add2()
    {
       //some logic
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T17:02:06.490

使用 JavaScript：

```
<input type="submit" name="add1" />
<input type="submit" name="add2" />

$('input:submit').click(function() {
  $('#myForm').setAttribute('action', 'add_' + this.name);
  $('#myForm').submit();
  return false;
}); 
```

我不确定确切的语法，但主要思想在这里。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T20:12:11.673

```
public function action_form() 
{
    $action = $this->request->query('action');
    if ($action && method_exists($this, 'action_'.$action))
    {
        $action = 'action_'.$action;
        return $this->$action();
    }
} 
```

不需要 Javascript，只需将表单数据发送到`welcome/form`参数`action`作为按钮名称。

# javascript - 查看 JavaScript 中是否存在对象的更好方法

> ID：10739130
> 
> 赞同：2
> 
> 时间：2012-05-24T14:08:15.620
> 
> 标签：javascript

是

```
if(!!object)
{
 // do something if object found
} 
```

一种更可靠的方式来查看是否存在任何对象？

```
if(object)
{

} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-24T14:10:28.350

检查某些内容是否已定义的最安全方法：

```
if (typeof thingy !== 'undefined') 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T14:14:43.800

```
if(typeof my_var == 'object'){

} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-24T14:21:05.263

有很多方法可以检查...

```
if ( object )
if ( !!object )
if ( object !== undefined )
if ( typeof object !== 'undefined' )
if ( object !== void 0 )
if ( {}.toString.apply( object ).subtr( 0, 7 ) === '[object' ) 
```

等等。

# objective-c - 如何通过编辑制作嵌套的 UITableView

> ID：10739134
> 
> 赞同：1
> 
> 时间：2012-05-24T14:08:36.937
> 
> 标签：objective-c, uitableview, tree, nested, collapse

# 目标

将此[代码](https://github.com/LaTtEX/MyTreeViewPrototype)用于嵌套的 UITableView，实现行的添加和重新排序。

# 我在哪里

将[其](https://github.com/shusta/ReorderingTableViewController)与前面的代码结合使用，我可以移动行，但我还没有弄清楚如何正确插入和删除行。

# 计划

最初的数据结构是这样的：

```
 treeNode = [[MyTreeNode alloc] initWithValue:@"Root"];
    MyTreeNode *node1 = [[MyTreeNode alloc] initWithValue:@"Node1"];
    [treeNode addChild:node1];

    MyTreeNode *node1a = [[MyTreeNode alloc] initWithValue:@"Node1a"];
    MyTreeNode *node1b = [[MyTreeNode alloc] initWithValue:@"Node1b"];
    [node1 addChild:node1a];
    [node1 addChild:node1b];

    MyTreeNode *node1a1 = [[MyTreeNode alloc] initWithValue:@"Node1a1"];
    [node1a addChild:node1a1];

    MyTreeNode *node1b1 = [[MyTreeNode alloc] initWithValue:@"Node1b1"];
    MyTreeNode *node1b2 = [[MyTreeNode alloc] initWithValue:@"Node1b2"];
    MyTreeNode *node1b3 = [[MyTreeNode alloc] initWithValue:@"Node1b3"];

    [node1b addChild:node1b1];
    [node1b addChild:node1b2];
    [node1b addChild:node1b3];
    node1b.inclusive = NO;

    MyTreeNode *node2 = [[MyTreeNode alloc] initWithValue:@"Node2"];
    [treeNode addChild:node2];

    MyTreeNode *node2a = [[MyTreeNode alloc] initWithValue:@"Node2a"];
    [node2 addChild:node2a];

    MyTreeNode *node2a1 = [[MyTreeNode alloc] initWithValue:@"Node2a1"];
    [node2a addChild:node2a1]; 
```

正如我所看到的，对于重新排序行，过程将是这样的：

1.  `MyTreeNode`使用 为移动的行创建一个新实例`fromIndexPath`。
2.  `MyTreeNode`使用为上面要插入移动行的行创建一个新实例`toIndexPath`。
3.  使用某种`addObject:object toParent:parent`类型的方法将上述两个实例相互添加。

对于只是添加行，我想这个过程应该非常相似。

# 问题

*   上述计划是解决问题的正确方法吗？如果是，制定该`addObject:object toParent:parent`方法的正确方法是什么？
*   重新排序时，如何防止将较高级别的部分插入较低级别的部分？例如：不允许在子标题下插入标题。

任何帮助将不胜感激！

# sql-server-2008 - 为每种类型选择一条记录

> ID：10739136
> 
> 赞同：-5
> 
> 时间：2012-05-24T14:08:41.330
> 
> 标签：sql-server-2008

对于以下场景，我只需要一个 sql server 查询：

![在此处输入图像描述](../Images/58b409337766c46823e9817a2d59afc1.png)

需要查询以获取每种车辆类型的单个记录。

我有一张车辆表。

乘用车，皮卡车，MPV是车辆类型。

有乘用车4条记录，皮卡2条记录和多用途车（MPV）记录。

所以我想要一个查询来获取每种类型的单个记录。

谢谢

我的愿望输出：

```
ID Model               VehicleType           Owner
1  LTD Crown Victoria  Passanger             XXXXXXXXXX
2  Tacoma              Pickup                YYYYYY
3  Explorer            Multipurpose Vehicle 
```

我想要的这种输出。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T14:11:40.193

尝试

```
SELECT DISTINCT [Vehicle Type] FROM your_table 
```

我看到你的编辑。此查询准确地为您提供了您的要求：

```
WITH t1 AS
(
  SELECT
    ID, Model, [Vehicle Type], Owner,
    RANK() OVER(PARTITION BY [Vehicle Type] order by ID) AS t2
  FROM your_table
)  
SELECT ID, Model, [Vehicle Type], Owner
FROM t1
WHERE t2 = 1 
```

[在这里](http://sqlfiddle.com/#!3/7c8aa/22)检查

# iphone - view.hidden = x 和 [view setHidden:x] 的区别

> ID：10739140
> 
> 赞同：2
> 
> 时间：2012-05-24T14:08:56.170
> 
> 标签：iphone, view, show-hide

我正在调试一个 iphone 应用程序，但我看到了一些我不完全理解的东西。

根据用户的选择，显示或隐藏 UIView。`[view setHidden:NO]`当前代码使用和显示或隐藏视图`[view setHidden:YES]`。这是行不通的：从视觉上看，就好像这些语句被简单地忽略了。但是，当我将它们分别更改为`view.hidden = NO`和时`view.hidden = YES`，一切都按预期工作。

我在想这两种语法是等价的，但显然不是。对于所有其他属性（`text`、`font`等），两者的工作方式相同，那么有什么特别之处`hidden`呢？

**编辑：**这是我的一些代码的复制/粘贴。我正在使用 iPhone 模拟器 5.0 在 XCode 4.3 中工作

这是我项目中的一个示例。

```
IBOutlet UIView *panel;    //Connected in interface builder

===========

- (void)makePanelVisible:(BOOL)visible
{
    [panel setHidden:!visible];    //this does not work
    panel.hidden = !visible;       //this does work correctly.
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T16:15:07.183

设置视图是否隐藏。

```
- (void)setHidden:(BOOL)flag 
```

返回接收者是否被标记为隐藏。

```
- (BOOL)isHidden 
```

隐藏=是；与 setHidden:YES 相同；不同之处在于，您立即将 hidden 变为 YES 而 sethidden 视图从其窗口中消失并且不接收输入事件，因为它被设置为隐藏。但是，它仍保留在其父视图的子视图列表中，并像往常一样参与自动调整大小。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T08:05:58.403

回想起来，我记得差不多 3 年前遇到过同样的问题，当时 iPhone 3（甚至不是 3G）风靡一时。我不确定为什么会发生这种情况，但确实如此 - 所以我只是通过使用“点”表示法设置属性来处理它。我想，这是“如果它没有坏就不要修复它”的事情之一（好吧，它有点坏了，但是有一个简单的方法可以解决它，所以我正在使用它）。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-05-24T14:46:20.010

hidden 是 UIView 的一个属性。当您编写 [panel setHidden:YES] 时，您尝试调用应该将属性设置为隐藏的方法 setHidden。它不起作用，因为 UIView 中不存在该方法：[https ://developer.apple.com/library/ios/#documentation/UIKit/Reference/UIView_Class/UIView/UIView.html#//apple_ref/doc /uid/TP40006816](https://developer.apple.com/library/ios/#documentation/UIKit/Reference/UIView_Class/UIView/UIView.html#//apple_ref/doc/uid/TP40006816)

我总是通过写“view.hidden = x”来设置属性。

我希望它会帮助你

# android - 如何打开和读取 src/my/package 文件夹中的文件？

> ID：10739142
> 
> 赞同：0
> 
> 时间：2012-05-24T14:09:01.407
> 
> 标签：android

我想在字符串中加载文本文件的内容。文本文件应`src/my/package`与`.java`.

但是，我找不到该文件的路径：我尝试过：

```
File f = new File("src/my/package/file.js"); 
File f = new File("file.js"); 
```

和许多其他人，但没有任何效果。

我的文件的正确路径是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-24T14:10:42.967

要打开位于类路径上的文件，请使用[`Class.getResource()`](http://docs.oracle.com/javase/6/docs/api/java/lang/Class.html#getResource%28java.lang.String%29)方法族。即使`jar`文件在您的类的文件中，它们也可以工作。所以像

```
InputStream is = getClass().getResourceAsStream("/my/package/file.js"); 
```

# xml - 使用带有命名空间的 ChildNodes 从 XML 中读取值

> ID：10739145
> 
> 赞同：4
> 
> 时间：2012-05-24T14:09:14.690
> 
> 标签：xml, delphi, dom, delphi-xe2

我有 2 个 XML 文件，第一个可以正常工作：

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<ns3:ConsultarSituacaoLoteRpsResposta xmlns:ns2="http://www.ginfes.com.br/tipos_v03.xsd" xmlns:ns3="http://www.ginfes.com.br/servico_consultar_situacao_lote_rps_resposta_v03.xsd">
  <ListaMensagemRetorno>
    <ns2:MensagemRetorno>
      <ns2:Codigo>E172</ns2:Codigo>
    </ns2:MensagemRetorno>
  </ListaMensagemRetorno>
</ns3:ConsultarSituacaoLoteRpsResposta> 
```

我用来阅读它的代码是这样的：

```
MyNode := Doc.DocumentElement.ChildNodes.First.ChildNodes.FindNode('MensagemRetorno');
MyValue := MyNode.ChildValues['Codigo']; 
```

问题是我有第二个 XML：

```
<?xml version="1.0" encoding="utf-8"?>
<ConsultarSituacaoLoteRpsResposta xmlns="http://www.issnetonline.com.br/webserviceabrasf/vsd/servico_consultar_situacao_lote_rps_resposta.xsd">
  <ListaMensagemRetorno>
    <MensagemRetorno>
        <Codigo xmlns="http://www.issnetonline.com.br/webserviceabrasf/vsd/tipos_complexos.xsd">E156</Codigo>
    </MensagemRetorno>
  </ListaMensagemRetorno>
</ConsultarSituacaoLoteRpsResposta> 
```

请注意，此 XML 在“Codigo”节点中有一个命名空间，因此我的代码找不到此节点。

我发现从第二个 XML 读取“Codigo”值的唯一方法是这样的：

```
for I := 0 to MyNode.ChildNodes.Count -1 do
begin
  ChildNode := RetornoNode.ChildNodes[I];
  if ChildNode.NodeName = 'Codigo' then
    Codigo := ChildNode.NodeValue;
end; 
```

但我认为应该有更好的方法来做到这一点，因为我仍然不明白为什么第一个代码不适用于第二个 XML。

任何人都可以为我澄清一下吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-24T14:44:13.857

这似乎是[`ChildValues`](http://docwiki.embarcadero.com/Libraries/en/Xml.XMLIntf.IXMLNode.ChildValues)财产的限制

您可以使用这些替代方法之一来返回值

```
 MyNode := Doc.DocumentElement.ChildNodes.First.ChildNodes.FindNode('MensagemRetorno');
 MyValue :=MyNode.ChildNodes.First.Text; 
```

[`FindNode`](http://docwiki.embarcadero.com/VCL/2010/en/XMLIntf.IXMLNodeList.FindNode)或使用方法的重载版本

```
 MyNode := Doc.DocumentElement.ChildNodes.First.ChildNodes.FindNode('MensagemRetorno');
 MyValue:= MyNode.ChildNodes.FindNode('Codigo','http://www.issnetonline.com.br/webserviceabrasf/vsd/tipos_complexos.xsd').Text; 
```

# iphone - 将 x 和 y 的值四舍五入

> ID：10739146
> 
> 赞同：0
> 
> 时间：2012-05-24T14:09:22.213
> 
> 标签：iphone, ios5, core-plot, xcode4.3

> **可能重复：**
> [核心图从轴标签中删除小数点](https://stackoverflow.com/questions/7519901/core-plot-remove-decimal-points-from-axis-labels)

我`Scatterplot`在 Core Plot 1.0 版本的帮助下构建了一个。图形 X 和 Y 值正在打印`15.0,18.0`等。而不是 15 18 等。我怎样才能四舍五入？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T14:11:33.997

您可以使用它`NSNumber`来转换您的浮点值。

```
float aFloatValue = 15.0;
NSNumber number = [[NSNumber alloc] initWithFloat:aFloatValue];
int aRoundedInt = [number intValue];
[number release]; 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-24T17:03:09.510

您可以将浮点值转换为 int。

`int newValue = (int)floatValue;`

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2012-05-24T14:13:53.730

我真的不明白你的问题是什么，但你可以尝试拆分你的字符串，使用[PHP](http://php.net/manual/en/function.split.php) 或[JavaScript](http://www.w3schools.com/jsref/jsref_split.asp) 两者都可以完成工作，一个是服务器端，一个是客户端，祝你有美好的一天。

# sql-server - 在日期范围之间打印当前值和先前值

> ID：10739147
> 
> 赞同：1
> 
> 时间：2012-05-24T14:09:25.177
> 
> 标签：sql-server, sql-server-2008, sql-server-2005

我有这样的样本数据

```
ID     DATE           TIME     STATUS 
---------------------------------------------
A      01-01-2000     0900     ACTIVE 
A      05-02-2000     1000     INACTIVE 
A      01-07-2000     1300     ACTIVE 
B      01-05-2005     1000     ACTIVE 
B      01-08-2007     1050     ACTIVE
C      01-01-2010     0900     ACTIVE 
C      01-07-2010     1900     INACTIVE 
```

从上面的数据集中，如果我们只关注`ID='A'`我们注意到它`A`最初是活跃的，然后变得不活跃，`05-02-2000`然后它一直不活跃直到`01-07-2000`。

这意味着`A`从`05-Feb-2000`到处于非活动状态`01-July-2000`。

我的问题是：

1.  如果我用它执行查询`(ID=A, Date=01-04-2000)`应该给我

    ```
    A      05-02-2000     1000     INACTIVE 
    ```

    因为由于该日期在该数据集中不可用，它应该搜索前一个并打印

2.  另外，如果我的条件是`(ID=A, Date=01-07-2000)`，它不仅应该打印表中存在的值，还应该打印以前的值

    ```
    A      05-02-2000     1000     INACTIVE 
    A      01-07-2000     1300     ACTIVE 
    ```

如果有人能帮助我解决这个问题，我将不胜感激。我正在尽力解决这个问题。

谢谢大家。

对此有何看法？

阿法克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T14:22:05.717

像下面这样的东西应该可以工作：

```
SELECT ID, Date, Time, Status
 from (select ID, Date, Time, Status, row_number() over (order by Date) Ranking
        from MyTable
        where ID = @SearchId
         and Date <= @SearchDate) xx
 where Ranking < 3
 order by Date, Time 
```

这将最多返回两行。不清楚您是使用日期和时间数据类型的列，还是实际上使用保留字作为列名，所以您必须对此大惊小怪。（我省略了时间，但您可以轻松地将其添加到各种排序和过滤中。）

* * *

鉴于修改后的标准，它变得有点棘手，因为包含或排除一行取决于在不同行中返回的值。这里，如果有两行或多行，则仅当“第一”行等于特定值时才包括“第二”行。执行此操作的标准方法是查询数据以获取最大值，然后在引用第一组结果的同时再次查询。

但是，您可以使用 row_number 做很多棘手的事情。解决这个问题：

```
SELECT ID, Date, Time, Status
 from (select
          ID, Date, Time, Status
         ,row_number() over (partition by case when Date = @SearchDate then 0 else 1 end
                             order by     case when Date = @SearchDate then 0 else 1 end
                                         ,Date) Ranking
        from MyTable
        where ID = @SearchId
         and Date <= @SearchDate) xx
 where Ranking = 1
 order by Date, Time 
```

您必须解决日期/时间问题，因为这仅适用于日期。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T06:21:14.627

基本上，如果对于指定的日期，您需要拉一行：

1) 最后一条记录，或

2) 最后一个*非活动*记录。

并且这两个条件可以匹配同一行以及两个不同的行。

下面是如何在 SQL Server 2005+ 中实现此逻辑：

```
WITH ranked AS (
  SELECT
    ID,
    Date,
    Time,
    Status,
    RankOverall  = ROW_NUMBER() OVER (                    ORDER BY Date DESC),
    RankByStatus = ROW_NUMBER() OVER (PARTITION BY Status ORDER BY Date DESC)
  FROM Activity
  WHERE ID = @ID
    AND Date <= @Date
)
SELECT
  ID,
  Date,
  Time,
  Status,
FROM ranked
WHERE RankOverall = 1
   OR Status = 'INACTIVE' AND RankByStatus = 1 
```

# javascript - 加载文档时为元素分配一个ID，以便在单击时执行不同的功能？

> ID：10739148
> 
> 赞同：2
> 
> 时间：2012-05-24T14:09:27.937
> 
> 标签：javascript, jquery

我正在尝试操纵一个`id`使用相同的按钮来执行超过 2 个操作。

它类似于：

```
var id;
if(something == 2){
   id = "id";
}else{
   id = "id2";
}

$(".myClass").attr("id", id); 
```

但是，它不好，因为如果我尝试使用`id`我设置的，将无法正常工作，可能是因为文档已经加载，`id`按钮中没有。

不认为这需要一个例子，[但我做到了](http://jsfiddle.net/SWZMd/15/)。

还有另一种方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T14:12:28.530

如果您需要将操作绑定到某个*未来*元素，通常最好使用委托，这意味着不是在元素本身上而是在其祖先之一上监听事件：

```
$("body").on("click", "#id2", function(){
    alert( "Clicked!" );
}); 
```

此时，您可以动态设置 ID：

```
$(".myClass").attr("id", function(){
    return something === 2
        ? "id" 
        : "id2" ;
}); 
```

当我在 body 上监听 click 事件时，通常最好使用更接近的父元素，这样事件在处理之前不必冒太多气泡。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T14:11:55.353

用这个：

```
$(document).on('click', '#alertMe', function(){
   alert('Working'); 
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T14:14:07.520

将第二次点击事件移动到第一次点击事件中，然后它将起作用。

```
$(".button1").click(function(){
   $(".button2").attr("id", "alertMe");
   $("#alertMe").click(function(){
   alert('Working'); 
   });
}); 
```

[http://jsfiddle.net/dcai/SWZMd/18/](http://jsfiddle.net/dcai/SWZMd/18/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-24T14:12:17.777

像这样试试

```
$("#alertMe").live("click",function(){
   alert('Working'); 
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-24T14:12:27.343

不要使用 'click()' 绑定处理程序，使用 live：

```
$("#alertMe").live('click', function(){
   alert('Working'); 
}); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-24T14:13:02.540

原因是该`click`方法是一次性的。它在运行时将点击事件添加到该 ID。要动态处理该 id 上的点击事件，请使用`on`如下：

```
$(".button1").click(function(){
    $(".button2").attr("id", "alertMe");
});

$(document).on('click',"#alertMe", function(){
   alert('Working');
}); 
```

现场示例：http: [//jsfiddle.net/SWZMd/17/](http://jsfiddle.net/SWZMd/17/)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-05-24T14:13:08.573

设置id后也可以设置点击：

```
$(".button1").click(function(){
    $(".button2").attr("id", "alertMe");
    $("#alertMe").click(function(){
      alert('Working'); 
    });

}); 
```

# json - Groovy：将数组转换为 JSON

> ID：10739152
> 
> 赞同：1
> 
> 时间：2012-05-24T14:09:33.033
> 
> 标签：json, grails, groovy

我是 Groovy 的新手，无法将数组转换为 JSON。计算的 JSON 应该包含我的数组列表中的所有值，但它只存储最后一个值。这是代码：

```
def arraylist = [["0",2],["1",8],["2",6],["3",8],["4",3]]

def arraysize = arraylist.size()

def builder = new groovy.json.JsonBuilder()
 builder ({
       cols([
                {
                    "id" "hours"
                    "label" "Hours"
                    "type" "string"
                },
                {
                    "id" "visitor"
                    "label" "Visitors"
                    "type" "number"
                }
           ])

         rows([
                {
                        for( i in 0..< arraysize )
                        {
                        c([
                             {
                                 "v" arraylist[i][0]
                             },
                             {
                                 "v" arraylist[i][1]
                             }
                         ])
                        }//for

                }
           ])
})

println builder.toPrettyString() 
```

可以尝试在这里运行代码：http: [//groovyconsole.appspot.com/](http://groovyconsole.appspot.com/)

预期输出在这里：

```
{
"cols": [
    {
        "id": "hours",
        "label": "Hours",
        "type": "string"
    },
    {
        "id": "visitor",
        "label": "Visitors",
        "type": "number"
    }
],
"rows": [
    {
        "c": [
            {
                "v": "0"
            },
            {
                "v": 2
            }
        ]
    },
    {
        "c": [
            {
                "v": "1"
            },
            {
                "v": 8
            }
        ]
    },
    {
        "c": [
            {
                "v": "2"
            },
            {
                "v": 6
            }
        ]
    },
    {
        "c": [
            {
                "v": "3"
            },
            {
                "v": 8
            }
        ]
    },
    {
        "c": [
            {
                "v": "4"
            },
            {
                "v": 3
            }
        ]
    }
]
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-24T14:33:11.293

像这样的东西似乎给出了你想要的结果：

```
def arraylist = [["0",2],["1",8],["2",6],["3",8],["4",3]]

def builder = new groovy.json.JsonBuilder()
builder {
  cols( [
    [ id: "hours",   label: "Hours",    type: "string" ],
    [ id: "visitor", label: "Visitors", type: "number" ] ] )

  rows( arraylist.collect { pair -> [ c: pair.collect { item -> [ v: item ] } ] } )
}

println builder.toPrettyString() 
```

# actionscript-3 - AS3 最大文本字段的宽度

> ID：10739154
> 
> 赞同：5
> 
> 时间：2012-05-24T14:09:43.530
> 
> 标签：actionscript-3, flash, textfield

如何设置文本字段的最大宽度？
我需要自动宽度直到它达到最大宽度，所以长文本会分成几行。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-24T14:19:28.947

```
var maxWidth:Number = 200;

textField.multiline = false;
textField.wordWrap = false;
textField.autoSize = TextFieldAutoSize.LEFT;

textField.text = "Lorem ipsum";

if (textField.width > maxWidth)
{
    textField.multiline = true;
    textField.wordWrap = true;
    textField.width = maxWidth;
} 
```

# mysql - 计算整个集合数据库中唯一元素的数量

> ID：10739156
> 
> 赞同：3
> 
> 时间：2012-05-24T14:09:51.100
> 
> 标签：mysql

我有以下用户数据库，每个用户都可以在不同级别上讲不同的语言。

```
id      langs
12      EN-21
36      EN-2,RU-3
41      EN-9
57      DE-35,EN-28
60      DE-9,RU-14 
```

我想创建 MySQL 查询来计算每种语言的出现次数，**而不管**其级别。所需的选项卡应如下所示：

```
lang    count
EN      4
DE      2
RU      2 
```

我已经尝试过不同的组合，但它远非完美。

```
SELECT 
    DISTINCT SUBSTRING_INDEX(langs, '-', 1) AS lang, 
--  COUNT(langs) as count
--  SUM(
--      (SELECT DISTINCT SUBSTRING_INDEX(langs, '-', 1) 
--      FROM people
--      WHERE langs != '')
--  )
FROM people
WHERE langs != ''
--  GROUP BY lang
ORDER BY lang 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T14:48:26.600

如果集合中的语言数量有最大限制，则可以将第一个元素、第二个元素、第三个元素等全部拉出，并合并在一起。这是一个示例，它从语言集中提取任何第一个或第二个元素并将它们组合起来：

```
select distinct substring_index(langs, '-', 1) as lang
from people where langs != ''
union
select distinct SUBSTRING_INDEX(SUBSTRING_INDEX(langs, '-', 2), ',', -1)
from people where LENGTH(langs) - LENGTH(REPLACE(langs,',','')) + 1 > 1 
```

演示：[http ://www.sqlfiddle.com/#!2/b86f2/1](http://www.sqlfiddle.com/#!2/b86f2/1)

* * *

从那里开始，将语言列表与人员列表结合起来并计算匹配的数量，`people.langs like '%EN%'`例如比较：

```
select
  lang,
  count(case when people.langs like concat('%',langs.lang,'%') then 1 end) as count
from people,
  (
    select distinct substring_index(langs, '-', 1) as lang
    from people where langs != ''
    union
    select distinct SUBSTRING_INDEX(SUBSTRING_INDEX(langs, '-', 2), ',', -1)
    from people where LENGTH(langs) - LENGTH(REPLACE(langs,',','')) + 1 > 1
  ) langs
group by langs.lang
order by langs.lang 
```

样本输出：

```
LANG    COUNT
====    ====
DE      2
EN      4
RU      2 
```

演示：[http ://www.sqlfiddle.com/#!2/b86f2/5](http://www.sqlfiddle.com/#!2/b86f2/5)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T14:31:06.527

```
SELECT SUBSTRING_INDEX(langs, '-', 1) AS lang, count(1) as count_lang
FROM people
WHERE langs!=''
GROUP BY lang
ORDER BY lang 
```

请试试这个，让我知道你得到了什么。

# c# - 无法加载位于同一文件夹中的托管程序集

> ID：10739175
> 
> 赞同：2
> 
> 时间：2012-05-24T14:10:39.577
> 
> 标签：c#, app-config, .net-assembly, probing

为了重新创建我的生产环境，我创建了以下文件夹结构：

c:\TEST\tested.dll c:\TEST\tested\tools.dll

使用以下 App.config 文件编译测试的.dll：

```
 <?xml version="1.0" encoding="utf-8" ?>
  <configuration>
    <runtime>
      <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
        <probing privatePath="tested"/>
      </assemblyBinding>
    </runtime>
  </configuration> 
```

据我所知，应用程序应该在子文件夹中查找它的工具文件。当我尝试启动工作站时，我仍然收到找不到文件的错误。

这里给出一些上下文是一个示例 test.dll 源：

```
 namespace ConsoleApplication1
    {
        public static class Testable
        {
            public static tools.IToolAble usefultool = null;

            public static void initialisation()
            {
                if (usefultool == null) usefultool = new UsefulTest()
            }
        }

        public class UsefulTest : tools.IToolAble
        {
        }
    } 
```

和一个示例 tools.dll 源：

```
 namespace tools
    {
        public interface IToolAble
        {
        }
    } 
```

崩溃的代码是我的测试代码，它的工作方式如下：

```
 private CustomMock controller = new CustomMock();
    public void TestFixtureSetUp()
    {
        controller.LoadFrom(@"c:\TEST\tested.dll");

        //The next line crashes because tools assembly is needet but not found
        controller.InvokeInitialisation();
    } 
```

我错过了什么？App.config 是否正确？

* * *

编辑：

下面的答案是正确的，只有在选择正确的 dll 后才能知道路径。所以其他团队必须`new ResolveEventHandler`在加载之前添加一个。这是它的简化版本：

```
 internal void AddResolveEventHandler(string assemblyname, string assemblylocation)
    {
        AppDomain.CurrentDomain.AssemblyResolve +=
        new ResolveEventHandler(
            (sender, args) =>
            {
                Assembly ret = null;
                if (
                    new AssemblyName(args.Name).Name == assemblyname && 
                    File.Exists(assemblylocation))
                {
                    ret = Assembly.LoadFrom(assemblylocation);
                }
                return ret;
            }
        );
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T17:17:43.000

> test.dll 使用以下 App.config 文件编译

它必须是 yourapp.exe.config 文件，而不是 DLL 的 .config 文件。CLR 只查找与主进程关联的 .config 文件。

并注意 app.vshost.exe.config，在启用托管进程的情况下进行调试时需要它。

使用单元测试运行器时要小心，另一个 .exe 文件

请考虑这是否真的值得麻烦。您的用户不会关心 DLL 的位置。

# c# - X文档。LINQ转XML。数据计数始终为零，在某些情况下返回错误结果

> ID：10739180
> 
> 赞同：2
> 
> 时间：2012-05-24T14:10:49.040
> 
> 标签：c#, .net, xml

> **可能重复：**
> [使用带有 Xml 命名空间的 Linq to Xml](https://stackoverflow.com/questions/2340411/use-linq-to-xml-with-xml-namespaces)

我有一个xml：

```
<?xml version="1.0" encoding="UTF-8"?>
<string xmlns="http://tempuri.org/">
<Global>
   <Items>
      <Item text="Main text" key="1">
         <Item text="Some text" key="1.1"/>
         <Item text="Other text" key="1.2"/>
         <Item text="Text" key="1.3"/>
      </Item>
      <Item text="Main text 2" key="2">
         <Item text="Some text" key="2.1"/>
         <Item text="Other text" key="2.2"/>
         <Item text="Text" key="2.3"/>
      </Item>
   </Items>
</Global>
</string> 
```

我需要在 Item 中获取项目（例如使用键 2.1、1.1 等）。

我有这个代码：

```
var xml = GetXmlFromWeb(service.ServiceLink, true);
                var stringXml = new StringReader(xml); // Load data from web)
                XmlReaderSettings settings = new XmlReaderSettings();
                settings.IgnoreWhitespace = true;
                var reader = XmlTextReader.Create(stringXml, settings);

                XDocument docWithDecode = XDocument.Load(reader);
                IEnumerable<XElement> elements = docWithDecode.Root.Descendants("Item"); 
```

结果我得到了Count = 0。

这很有趣，如果我写`IEnumerable<XElement> elements = docWithDecode.Root.Descendants();`了，我得到了元素，但是结构看起来很乱，数据被复制了，每个项目都有命名空间引用等。所以这里出了点问题。

有人可以帮我编写工作代码吗？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T14:26:33.513

```
XNamespace ns = "http://tempuri.org/";
IEnumerable<XElement> elements = docWithDecode.Root.Descendants(ns+"Item"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T14:34:41.747

正如我在评论中提到的和 LB 在他的回答中提到的那样，您的`.Count()`== 0 问题是由于缺少命名空间。请参阅我上面链接的[这个答案](https://stackoverflow.com/a/2340497/250725)以更详细地解释它，但实际上您的问题是您正在搜索一个名为“Item”的元素，但实际上您实际上想要找到的是命名空间 +“Item”。您只需要将命名空间添加到查询中。

重新阅读您的问题后，我注意到您的 XML 和查询存在问题。您有一个具有多个同名子节点的节点。如果您使用`Descendants()`，您将选择全部 8 个，而不是您在问题中指定的 6 个。

要仅选择子`<Item>`节点，您需要修改查询，因为`Descendants()`将选择任何匹配的内容。您实际上需要使用`.Elements()`扩展方法并具体选择每个级别。

```
XNamespace ns = "http://tempuri.org/";
IEnumerable<XElement> elements = docWithDecode.Root
                                              .Elements(ns + "Global")
                                              .Elements(ns + "Items")
                                              .Elements(ns + "Item")
                                              .Elements(ns + "Item"); 
```

您也可以使用`Descendants(ns + "Items")`而不是查询中的前 2 个`Elements()`，因为它不会在自身内部重复。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T14:41:36.160

首先，不要使用`Root.Descendants()`，这将返回`IEnumerable<XElement>`所有孩子中的一个，并且不会保留树结构。它对所有 XElement 子项一视同仁，无论它们在树中的位置如何。您应该始终尝试使用`Root.Elements(ns + "InnerElementName");`，这也将返回一个`IEnumerable<XElement>`，但仅适用于 Root 的孩子，（而不是孙辈:)）。

您收到 0 个元素 using`Descendants("Item")`的原因是缺少命名空间。确保添加命名空间，如果 XML 中有命名空间，根据我的经验，不添加元素名称将无法使用。

此代码将以您提供的结构遍历 XML 文件：

```
XNamespace ns = docWithDecode.Root.Name.Namespace;
XElement xGlobal = docWithDecode.Root.Element(ns + "Global");
forach (XElement xItems in xGlobal.Elements(ns + "Items")
{
   XAttribute outerItemText = xItems.Attribute("text");
   XAttribute outerItemKey = xItems.Attribute("key");

   foreach (XElement xItem in xItems.Elements(ns + "Item"))
   {
      XAttribute innerItemText = xItem.Attribute("text");
      XAttribute innerItemKey = xItem.Attribute("key");
   }
} 
```

我没有调试这个（我在这台计算机上没有 VS）所以告诉我它是否不起作用，但我想你会明白的。

# grails - Grails - 在哪里放置测试文件以及如何加载它们

> ID：10739182
> 
> 赞同：12
> 
> 时间：2012-05-24T14:10:52.290
> 
> 标签：grails, grails-2.0

我想问一下grails（即data.xml）中测试文件的最佳位置在哪里。它是 test/ 文件夹吗？

如何在集成测试中轻松加载测试文件？

谢谢，马特奥

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-24T15:53:26.787

在测试/集成/资源中

然后，即如果您使用 spock 进行测试，您可以执行以下操作：

```
def mediaBundlerService = Mock(MediaBundlerService)
mediaBundlerService.getPath(_) >> [path: new File('test/integration/resources/test-bundle/').absolutePath + "/"] 
```

# reflection - 无法在 PowerShell 中加载 .NET 类型

> ID：10739184
> 
> 赞同：6
> 
> 时间：2012-05-24T14:10:55.277
> 
> 标签：reflection, powershell, assemblies

这是一个奇怪的问题。我正在尝试加载`System.DirectoryServices`程序集，然后创建`System.DirectoryServices.DirectoryEntry`该类的实例。

这是我正在尝试做的事情：

```
PS C:> [System.Reflection.Assembly]::LoadWithPartialName("System.DirectoryServices")

GAC    Version        Location
---    -------        --------
True   v2.0.50727     C:\Windows\assembly\GAC_MSIL\System.DirectoryServices\2.0.0.0__b03f5f7f11d50a3a\System.Directo... 
```

它似乎已经很好地加载了程序集，但是现在当我尝试实例化一个新对象时它失败了：

```
PS C:\> $computer = new-object [System.DirectoryServices.DirectoryEntry]("WinNT://localhost,computer")
New-Object : Cannot find type [[System.DirectoryServices.DirectoryEntry]]: make sure the assembly containing this type
is loaded.
At line:1 char:23
+ $computer = new-object <<<<  [System.DirectoryServices.DirectoryEntry]("WinNT://localhost,computer")
    + CategoryInfo          : InvalidType: (:) [New-Object], PSArgumentException
    + FullyQualifiedErrorId : TypeNotFound,Microsoft.PowerShell.Commands.NewObjectCommand 
```

但是，如果我尝试以稍微迟钝的方式进行操作，它似乎可以工作。

```
$directoryServices = [System.Reflection.Assembly]::LoadWithPartialName("System.DirectoryServices")
$directoryEntryType = $directoryServices.GetType("System.DirectoryServices.DirectoryEntry")
$machine = New-Object $directoryEntryType("WinNT://localhost,computer")
$machine 
```

它表明我已经成功创建了对象：

```
distinguishedName :
Path              : WinNT://localhost,computer 
```

这样做的正确方法是什么？我究竟做错了什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-24T14:16:03.940

你的[`new-object`](http://technet.microsoft.com/en-us/library/dd347574.aspx)语法有点不对劲。试试这个：

```
[System.Reflection.Assembly]::LoadWithPartialName("System.DirectoryServices")
$machine = new-object -typeName System.DirectoryServices.DirectoryEntry -argumentList "WinNT://localhost,computer" 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-24T15:23:02.863

无需加载任何内容。使用 adsi 类型加速器：

```
[adsi]"WinNT://localhost,computer" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T14:25:36.293

我认为[New-Object](http://technet.microsoft.com/en-us/library/hh849885.aspx)的语法不正确。取自[关于新对象的一些文档]：[1](http://technet.microsoft.com/en-us/library/hh849885.aspx)

```
New-Object System.DirectoryServices.DirectoryEntry("WinNT://localhost,computer") 
```

# iphone - 在命令行中调试 ios 问题 - Xcode

> ID：10739185
> 
> 赞同：1
> 
> 时间：2012-05-24T14:10:58.007
> 
> 标签：iphone, ios, xcode, debugging, xcodebuild

我为 iPhone 构建了一个项目并在 Xcode 4.3.2 中调试它工作正常。但是，我想在命令行中调试它，所以我运行：

```
xcodebuild -target NAMEOFTARGET -sdk SDKPATH -configuration Release 
```

它应该与 Xcode 中的相同，但是我遇到了一些错误并且无法编译！也许有人可以帮助...

```
-Prefix-cfqwmqlvdeltqcceqguoaugscmoq/Igor2305-Prefix.pch.d
error: can't exec '/opt/local/bin/gcc-apple-4.2' (No such file or directory)
Command /opt/local/bin/gcc-apple-4.2 failed with exit code 71
 ** BUILD FAILED **
The following build commands failed:
ProcessPCH /var/folders/d7/sx0vvl0537l4x7md9b35m7br0000gn/C/com.apple.Xcode.501/SharedPrecompiledHeaders/Igor2305-Prefix-fwljjtsqayhghvfeivuxdyjuvt/Igor2305-Prefix.pch.pth Igor2305/Igor2305-Prefix.pch normal armv6 objective-c com.apple.compilers.llvm.clang.1_0.compiler
ProcessPCH /var/folders/d7/sx0vvl057l4x7md9b35m7br00gn/C/com.apple.Xcode.501/SharedPrecompiledHeaders/Igor2305-Prefi-cfqwmqlvdeltqceqguoaugscmoq/Igor2305-Prefix.pch.pth Igor2305/Igor2305-Prefix.pch normal armv7 objective-c com.apple.compilers.llvm.clang.1_0.compiler
(2 failures) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T14:17:38.610

它正在寻找 GCC`/opt/`而没有找到它。这不是与 Xcode 捆绑的 GCC 的标准安装位置。下面的命令会告诉你 Xcode 在哪里寻找它的开发者工具：

```
xcode-select -print-path 
```

要更改它，请运行：

```
sudo xcode-select -switch /Applications/Xcode.app/Contents/Developer 
```

该路径适用于通过 App Store 安装的标准 Xcode 安装位置。如果您已将其安装在其他地方，则必须相应地更改路径。

# javascript - amcharts：尝试将多个数据集动态添加到 javascript stockChart

> ID：10739191
> 
> 赞同：1
> 
> 时间：2012-05-24T14:11:30.497
> 
> 标签：javascript, jquery, arrays, json, amcharts

我正在使用 AmCharts 来显示一些图表，并且我正在尝试从使用 jquery 获取的一系列 JSON 数据集中动态添加数据`getJSON`

简而言之，我的问题是，如何循环使用各种数据集为图表创建数据集，例如：

```
$.getJSON("GET NUMBER OF DATA SETS REQUIRED", function (locdata) {

 $.each(locdata, function (i, item) {

     $.getJSON("GET DATA FOR THIS DATASET", function (data) {

         var dataSet = new AmCharts.DataSet();
         dataSet.title = locdata[i].name;
         dataSet.fieldMappings = [{
             fromField: "takings",
             toField: "takings"
         }, {
             fromField: "qty",
              toField: "qty"
         }];
         dataSet.dataProvider = data; ;
         dataSet.categoryField = "date";

         )};
    )};
)}; 
```

解释我在这里做什么：

1.  首先，从我的数据库中获取一些 JSON 输出以确定需要多少记录集
2.  循环遍历结果以创建记录集
3.  在每个循环期间，数据由第二个 jQuery`getJSON`调用获取，以根据此记录集所需的数据获取数据
4.  创建 AmCharts 数据集

我可以通过显式编码来手动执行此操作以单独创建每个数据集，然后执行

```
 chart.dataSets = [dataSet0, dataSet1, dataSet2, dataSet3, dataSet4]; 
```

所以我想我需要做的是把上面的整个代码变成某种函数，根据上面的行生成一个数据集数组？

我不知道如何用javascript做到这一点

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T08:36:52.693

您可以简单地将每个数据集推送到 chart.dataSets 数组：

chart.dataSets.push(dataSet);

# ios - 我的应用程序有什么方法可以知道用户添加了 Twitter 帐户吗？

> ID：10739201
> 
> 赞同：1
> 
> 时间：2012-05-24T14:12:00.117
> 
> 标签：ios, twitter

每当您尝试展示 TWTweetComposeViewController 并且用户没有将 Twitter 帐户添加到他们的设备时，系统会提示他们转到“设置”应用程序并添加一个。完成后，他们必须手动导航回应用程序。

我的应用程序有什么方法可以知道他们已经成功添加了一个帐户？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T17:27:40.340

实际上，有一种方法可以在您的应用程序运行时收到新帐户的通知。ACAccountStore 提供通知 ACAccountStoreDidChangeNotification，您可以使用 Key-Value Observing 观察更改。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T15:06:01.147

啊，在这种情况下，您可以跟踪他们首次启动应用程序时拥有的用户帐户数量，并将其保存到 NSUserDefaults。当您设置 TWTweetComposeViewController 时，请检查该数字是否与以前相同。

```
__block BOOL accountSizeChanged = NO;
ACAccountStore *accountStore = [[ACAccountStore alloc] init];
ACAccountType *accountType = [accountStore accountTypeWithAccountTypeIdentifier:ACAccountTypeIdentifierTwitter];
[accountStore requestAccessToAccountsWithType:accountType withCompletionHandler:^(BOOL granted, NSError *error) {
    if(granted)
    {
        int oldSize = [[NSUserDefaults standardUserDefaults] integerForKey:@"myKey"];
        int newSize = [accountStore accountsWithAccountType:accountType].count;
        if(oldSize != newSize)
            accountSizeChanged = YES;
        [[NSUserDefaults standardUserDefaults] setInteger:newSize forKey:@"myKey"];
    }
}]; 
```

# selenium - Selenium 与 Safari 4 及更高版本

> ID：10739203
> 
> 赞同：1
> 
> 时间：2012-05-24T14:12:07.417
> 
> 标签：selenium, safari, selenium-rc

我是 Safari 的新用户。我在不同的浏览器中运行自动化测试脚本。我能够使用 Safari 3.2.2 运行这些。我知道 selenium 仅在 safari 上支持 2 和 3 版本。有什么方法可以将这些扩展至**4.x**及更高版本的 safari。

我试过了，但只显示了 RC 日志，但浏览器没有实例化。

# vba - VBA Office 2010 Outlook 问题

> ID：10739206
> 
> 赞同：3
> 
> 时间：2012-05-24T14:12:12.320
> 
> 标签：vba, outlook, ms-office

我刚刚从我们的 IT 人员那里升级到我工作的 Office 2010，以便我可以检查我在办公室编写的 VBA 脚本的功能。到目前为止，我遇到的唯一一个是 Outlook 2010，如下所示。我在每一端都用 3 个 * 标记了那些不起作用的行。有人可以建议吗？我在网上找不到任何解决方案（地址中的....仅用于删除此处的文件路径）

```
Sub UpdatedQMISReply()

Location = InputBox("Please enter the UNC (http://) path for the new file", "UNC location")
Location2 = InputBox("Please enter the QMIS path for the new file", "UNC location")

'
' UpdatedQMISReply Macro
' Insert QMIS Document Updated text
'
    ActiveInspector.WordEditor.Application.Selection.TypeText Text:="Dear User,"
    ActiveInspector.WordEditor.Application.Selection.TypeParagraph
    ActiveInspector.WordEditor.Application.Selection.TypeParagraph
    ActiveInspector.WordEditor.Application.Selection.TypeText Text:="This email is to confirm that your recent file update request to QMIS has now been completed. I have uploaded all the requested files and have saved a copy into the archive folder "
ActiveInspector.WordEditor.Application.Selection.TypeText Text:="(if an old file existed)."
ActiveInspector.WordEditor.Application.Selection.TypeParagraph
ActiveInspector.WordEditor.Application.Selection.TypeParagraph
ActiveInspector.WordEditor.Application.Selection.TypeText Text:="The location on QMIS for the uploaded document is: "

***ActiveInspector.WordEditor.Application.Selection.Hyperlinks.Add Anchor:=Selection.Range, Address:=Location, SubAddress:="", ScreenTip:="", TextToDisplay:=Location2***

ActiveInspector.WordEditor.Application.Selection.TypeParagraph
ActiveInspector.WordEditor.Application.Selection.TypeParagraph
ActiveInspector.WordEditor.Application.Selection.TypeText Text:="If your update was concerning a Health & Safety Document such as a Risk Assessment, or Safe System of Work, then please note that the naming convention for these documents is changing, also the location of the document may change without prior warning as the QMIS infrastructure is modified."
ActiveInspector.WordEditor.Application.Selection.TypeParagraph
ActiveInspector.WordEditor.Application.Selection.TypeParagraph
ActiveInspector.WordEditor.Application.Selection.TypeText Text:="Should you have any further queries regarding this update then please do not hesitate to contact me"
ActiveInspector.WordEditor.Application.Selection.TypeParagraph
ActiveInspector.WordEditor.Application.Selection.TypeParagraph
ActiveInspector.WordEditor.Application.Selection.TypeText Text:="Regards"
End Sub
Sub DocumentRenewalNeeded()
'
' QMIS.DocumentRenewalNeeded Macro
' Macro created 26/10/2011 by stefan.wright
Dim myOlApp As Outlook.Application
Dim myItem As Outlook.MailItem
Set myOlApp = CreateObject("Outlook.Application")
Set myItem = myOlApp.CreateItem(olMailItem)
myItem.Subject = "QMIS Document Review Needed"

***myItem.Attachments.Add "\\.........\sites\..........\.........\DOCUMENT UPDATE TRACKER\.............xls"***

myItem.Display

Selection.TypeText Text:="Dear User,"
Selection.TypeParagraph
Selection.TypeParagraph
Selection.TypeText Text:="This email is to inform you that you have documents that are currently out of date on QMIS Document Library. These documents could either be on the Quality worksheet or the HS worksheet so please ensure you check both. Please could you view the QMIS Document Updater Spreadsheet to view the documents which you are responsible for, This can be done by clicking the small arrow in the box which says 'Responsible Person' and then selecting your name, if you then do the same in the 'Colour Code' box and select '2' or '3' you will find the documents which should have been reviewed. If you should find that you are listed on a document and this is incorrect then please let me know and if possible advise me of who should be responsible for that document."
Selection.TypeParagraph
Selection.TypeParagraph
Selection.TypeText Text:="The spreadsheet of QMIS updates is attached to this email."
Selection.TypeParagraph
Selection.TypeParagraph
Selection.TypeText Text:="Should you have any further queries regarding this update then please do not hesitate to contact me.    This email will be sent out monthly to those people who have outstanding updates to be completed."
Selection.TypeParagraph
Selection.TypeParagraph
Selection.TypeText Text:="Regards"
End Sub 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T14:58:42.453

**未经测试**

试试这个

```
Sub UpdatedQMISReply()
    Dim msg1 As String, msg2 As String
    Dim doc As Object, sel As Object
    Dim Location, Location2

    msg1 = "Please enter the UNC (http://) path for the new file"
    msg2 = "Please enter the QMIS path for the new file"

    Location = InputBox(msg1, "UNC location")
    Location2 = InputBox(msg2, "UNC location")

    Set doc = ActiveInspector.WordEditor
    Set sel = doc.Application.Selection

    With sel
        .TypeText Text:="Dear User,"
        .TypeParagraph
        .TypeParagraph
        .TypeText Text:="This email is to confirm that your recent " & _
                        "file update request to QMIS has now been " & _
                        "completed. I have uploaded all the requested " & _
                        "files and have saved a copy into the archive folder "
        .TypeText Text:="(if an old file existed)."
        .TypeParagraph
        .TypeParagraph
        .TypeText Text:="The location on QMIS for the uploaded document is: "

        .Hyperlinks.Add Anchor:=.Range, Address:=Location, SubAddress:="", ScreenTip:="", TextToDisplay:=Location2

        .TypeParagraph
        .TypeParagraph
        .TypeText Text:="If your update was concerning a Health & Safety " & _
                        "Document such as a Risk Assessment, or Safe System" & _
                        " of Work, then please note that the naming " & _
                        "convention for these documents is changing, also " & _
                        "the location of the document may change without " & _
                        "prior warning as the QMIS infrastructure is modified."
        .TypeParagraph
        .TypeParagraph
        .TypeText Text:="Should you have any further queries regarding " & _
                        "this update then please do not hesitate to contact me"
        .TypeParagraph
        .TypeParagraph
        .TypeText Text:="Regards"
    End With
End Sub 
```

或者在您的实际代码中，替换

`***ActiveInspector.WordEditor.Application.Selection.Hyperlinks.Add Anchor:=Selection.Range, Address:=Location, SubAddress:="", ScreenTip:="", TextToDisplay:=Location2***`

和

```
ActiveInspector.WordEditor.Application.Selection.Hyperlinks.Add _
Anchor:=ActiveInspector.WordEditor.Application.Selection.Range, _
Address:=Location, SubAddress:="", ScreenTip:="", TextToDisplay:=Location2 
```

# c++ - 了解VC++中存储在数组中的元素数量

> ID：10739211
> 
> 赞同：1
> 
> 时间：2012-05-24T14:12:18.903
> 
> 标签：c++, arrays, visual-studio-2008, visual-c++

有什么方法可以在不使用 for 循环的情况下在 VC++ 中查找数组中的元素数。

假设数组有 16 个元素；

```
int a[16];
a={1,2,3,4,5,6,7}; 
```

现在，如果我想让长度等于 7 而不是 16（我的意思是我想知道存储在这个数组中的元素数，而不是获取数组中的空格数）。有什么方法类似于`length()`我们在 C# 中的功能吗？我在 VS2008 上使用 VC++。

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-24T14:14:25.180

对于内置数组，唯一的方法是让您自己跟踪这个“长度”。没有自动的方法可以做到这一点。

但是，更好的方法是使用`std::vector<int>`. 它会自动跟踪当前的元素数量（“大小”）和无需重新分配数组即可容纳的元素数量（“容量”）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-24T14:13:43.463

不，这是不可能的，如果你不填充整个数组，剩余的元素将根据初始化的类型填充值。

请注意，C/C++ 不对数组进行边界检查，也不会跟踪数组元素的数量，该语言只是为您提供您要求的连续内存块，您负责如何以及是否使用它。以及存储在数组中的元素数量。

**[您只需使用std::vector](http://www.cplusplus.com/reference/stl/vector/)**就可以为自己节省很多问题和簿记。
它为您提供了普通数组所能提供的一切，但还提供了许多有用的成员函数，例如`size()`为您记录元素数量等。

# silverlight - Silverlight 5 中的导航

> ID：10739218
> 
> 赞同：2
> 
> 时间：2012-05-24T14:12:35.150
> 
> 标签：silverlight, navigation, silverlight-5.0

我想在 Next 按钮的单击事件上导航到新页面。假设我当前的页面是“FirstTestPage.xaml”，并且想要在点击 nextButton_Click 事件时进入页面“SecondTestPage.xaml”

```
private void RadButton_Click(object sender, RoutedEventArgs e)
{ 
    ///CODE HERE
} 
```

并且还想要将我转移到 FirstTestPage.xaml 的后退按钮。

谢谢你

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-24T15:29:31.497

请参阅我对问题的回答：[在 Silverlight + Xaml 中制作向导](https://stackoverflow.com/questions/10654599/making-a-wizard-in-silverlight-xaml/10656222#10656222)

引用它：“我建议查看 Silverlight 导航框架。它允许您使用“url”在“页面”（这是您的 XAML 用户控件）之间导航。它还允许用户使用来回按钮浏览器，这可能是您想要允许的，也可能不是。

当您选择新项目、Silverlight、“Silverlight 导航应用程序”时，有一个 VS 2010 模板可以帮助您入门。”

您还可以在 Xaml 中使用边框或面板并更改其内容。这是一个使用边框的示例。XAML

```
<Grid>
  <Border x:Name="contentBorder" />
</Grid> 
```

代码背后：

```
private void RadButton_Click(object sender, RoutedEventArgs e)
{ 
  this.contentBorder.Child = new SecondTestPage();
} 
```

如果您想花哨并拥有 Telerik 控件（我从您的 RadButton 示例中假设），请查看他们的过渡控件：[http ://demos.telerik.com/silverlight/#TransitionControl/FirstLook](http://demos.telerik.com/silverlight/#TransitionControl/FirstLook)

# android - 在 ORMLite 中将数据从一个数据库插入另一个数据库

> ID：10739224
> 
> 赞同：3
> 
> 时间：2012-05-24T14:13:06.470
> 
> 标签：android, database, ormlite

我在我的 Android 项目中使用 ORMLite。我想将相同的数据从一个数据库复制到另一个数据库。在 ORMLite 上可以吗？ORMLite 可以与多个数据库一起工作。任何想法？

# php - 定义良好的缓存方案

> ID：10739226
> 
> 赞同：3
> 
> 时间：2012-05-24T14:13:12.430
> 
> 标签：php, codeigniter, caching, apc

我需要知道是否可以改进从 CodeIgniter 应用程序内部缓存我的 api 调用的方式。我现在这样做的方式是这样的，采用 hmvc 模式：

*   控制器`HOME` **==** *调用* **=>** 模块`app/application/modules/apis/controllers/c_$api` **==** *加载库* **=>** `app/application/libraries/$api` ==> 库返回响应到模块的控制器_X，控制器使用它拥有的数据调用视图

*//注意：我的应用没有使用twitter api，而是其他的*

模块内部`apis`是所有 apc 缓存发生的地方，如下所示：

```
 // Load up drivers
    $this->load->library('driver');
    $this->load->driver('cache', array('adapter' => 'apc'));

    // Get Tweets from Cache
    $tweets = $this->cache->get('my_tweets');

    if ( ! $tweets)
    {
        // No tweets in the cache, so get new ones.
        $url = 'http://api.twitter.com/1/statuses/user_timeline.json?screen_name=gaker&count=5';

        $tweets = json_decode(file_get_contents($url));
        $this->cache->save('my_tweets',$tweets, 300);
    }

    return $tweets; 
```

如本文所述：http: [//www.gregaker.net/2011/feb/12/codeigniter-reactors-caching-drivers/](http://www.gregaker.net/2011/feb/12/codeigniter-reactors-caching-drivers/)

所以我想知道：

1.  有3个场景：home、query、result；在每个模块`apis`的控制器中，您认为在所有场景中为每个控制器实现缓存是一个好主意吗？例子：

    ```
    //for each api1, api2 ... apiX, apply this:

    //home
    $this->cache->save('api_home',$api_home, 300);

    //query
    $this->cache->save("api_$query", $api_{$query}, 300); // I don't know for sure if $api_{$query} works or not, so don't hang me because I haven't tried it.

    //result
    $this->cache->save("api_$queryId", $api_{$queryId}, 300); 
    ```

2.  即使我缓存了 api 调用，您是否认为我应该将结果缓存在调用 api 模块控制器的控制器中，并具有相同的 3 个场景（主页、查询和结果）？像这样：

    ```
    //modules/{home,fetch,article}/controllers/{home,fetch,article}.php

    //home
    $homeData['latest'][$api]   = modules::run("apis/c_$api/data", array('action'=>'topRated'));
    $this->cache->save('home_data', $home_data, 300);

    //query
    $searchResults[$api] = modules::run("apis/c_$api/data", $parameters);
    $this->cache->save("search_results_$query", $search_results_{$query}, 300);

    //article page
    $result = modules::run("apis/c_$api/data", $parameters);
    $this->cache->save("$api_article_$id", ${$api}_article_{$id}, 300); 
    ```

所以你怎么看？上面提到的这是一个好习惯，还是一个非常愚蠢的做法？

//注意，建议的缓存想法没有经过测试......所以，我不知道是否`${$api}_article_{$id}`可行（即使我认为它会）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T21:42:13.673

恕我直言，如果您不需要实时数据，缓存 api 结果是个好主意。如果您不在乎一小时内看不到新数据，那么请务必将其缓存一小时。因此，对于您的第一个问题，您只需要问自己：“我的应用程序需要多新鲜的内容？” 并相应地实现缓存。

对于第二个问题：如果仅以简单的方式对其进行操作，我认为缓存内容没有多大价值。那时，您正在使用缓存中的空间并且没有获得很多价值。但是，如果有数据库或其他使用该数据进行的 api 调用，那么是的，它们应该使用类似于上述的技术进行缓存。

如果您担心处理器负载（在操作后缓存内容的唯一原因），那么最好的办法是查看[Varnish](https://www.varnish-cache.org/)或[CloudFront](http://aws.amazon.com/cloudfront/)之类的东西。

# audio - Autotune/声码器背后的理论

> ID：10739229
> 
> 赞同：2
> 
> 时间：2012-05-24T14:13:18.297
> 
> 标签：audio, core-audio, audio-processing

我一直在网上寻找有关声码器或自动调谐的材料，但没有得到任何令人满意的答案。有人可以简单地解释一下如何使用载体声音文件自动调整给定的声音文件吗？（我熟悉 ffts、窗口化、重叠等，当我们拥有载体的 ffts 和必须调制的原始声音文件时，我只是不明白我们该怎么做）

编辑：再环顾四周后，我终于确切地知道我在寻找什么——一个通道声码器。它的工作方式是，它需要两个输入，一个是语音信号，另一个是频率丰富的音乐信号。音乐信号由语音信号的包络调制，输出的信号听起来像用乐音唱歌的声音。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T18:07:41.433

使用相位声码器调整音高基本上是音高估计加上频域中的插值。

相位声码器重建方法可能会以新的 FFT bin 间距重新采样频谱，以将所有频率向上或向下移动某个比率。相位声码器算法还使用相邻 FFT 帧之间共享的信息，以确保此插值结果可以创建跨帧边界的连续波形。例如，它调整插值结果的相位，以确保连续的正弦波重建是连续的，而不是在帧之间出现中断或不连续或相位抵消。

将频谱向上或向下移动多少取决于音高估计，并计算估计的源音高与目标音高之间的比率。同样，相位声码器使用有关 FFT 帧之间任何相位差的信息来帮助更好地估计音调。这可以通过使用比单个本地 FFT 帧更多的全局信息来实现。

当然，这种频率和相位变化会抹掉瞬态细节并导致各种其他失真，因此实际的相位声码器产品可能会另外使用各种定制（通常是专有的）特殊情况技巧来尝试解决其中的一些问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-24T22:55:07.827

第一步是音高检测。有许多音高检测算法，维基百科中简要介绍了：[http](http://en.wikipedia.org/wiki/Pitch_detection_algorithm) ://en.wikipedia.org/wiki/Pitch_detection_algorithm 音高检测可以在频域或时域中实现。两个域中的各种技术都存在各种属性（延迟、质量等）。在 F 域中，重要的是要意识到，由于时间/频率的权衡，简单的方法是非常有限的。你可以绕过这个限制，但这需要工作。

确定音高后，将其与所需音高进行比较，并确定实际需要多少音高变化。

最后一步是音高变换，与音高检测一样，可以在 T 或 F 域中完成。其他人提到的“相位声码器”方法是F域方法。T 域方法包括（按质量递增顺序）OLA、SOLA 和 PSOLA，您可以在此处阅读其中的一些内容：[http ://www.scribd.com/doc/67053489/60/Synchronous-Overlap-and-Add-索拉](http://www.scribd.com/doc/67053489/60/Synchronous-Overlap-and-Add-SOLA)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-24T17:04:26.537

基本上，您进行 FFT，然后在频域中将信号移动到最接近的完美半音音高。

# regex - 在 R 中，如何在 gsub 中使用正则表达式 [:punct:]？

> ID：10739230
> 
> 赞同：12
> 
> 时间：2012-05-24T14:13:19.223
> 
> 标签：regex, r

给定

```
test<-"Low-Decarie, Etienne" 
```

我希望用空格替换所有标点符号

```
gsub(pattern="[:punct:]", x=test, replacement=" ") 
```

但这会产生

```
"Low-De arie, E ie  e" 
```

其中没有标点符号被替换，并且显然随机字母被删除（尽管它们可能与标点符号相关联，例如 t 代表制表符，n 代表下一行）。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-05-24T14:42:58.473

MontReal 用户在这里。

几个选项，相同的结果。

在 R Base 中，只需将括号加倍

```
gsub(pattern="[[:punct:]]", test, replacement=" ")

[1] "Low Decarie  Etienne" 
```

包`stringr`具有执行此操作的功能`str_replace_all`。

```
library(stringr)
str_replace_all(test, "[[:punct:]]", " ") 
```

或者只保留字母

```
str_replace_all(test, "[^[:alnum:]]", " ") 
```

# jquery - 呈现元素后的 jQuery Mobile 运行脚本

> ID：10739231
> 
> 赞同：1
> 
> 时间：2012-05-24T14:13:22.843
> 
> 标签：jquery, jquery-mobile

我正在尝试在 jquery 移动页面上动态移动一些图标。该脚本有效，但在运行时，每个元素的位置为 1。我已阅读有关 pagecreate、pageshow 等的 jquery 文档，但我无法让它们中的任何一个运行元素在其位置呈现后的脚本。

我的页面是在 layout.cshtml 中创建的，如下所示：

```
<div id="mainPage" data-role="page">...</div> 
```

pagecreate/pageshow 的不同用途的脚本是：

```
 $("#mainPage").live("pageshow", function () {
       $(".folderIcon").each(function (i) {
            var parentTop = $(this).parent().parent().position().top;
        });
    }); 
```

我做错了什么？

# java - final Combo 和 SelectionListener

> ID：10739234
> 
> 赞同：3
> 
> 时间：2012-05-24T14:13:33.100
> 
> 标签：java, swt, drop-down-menu, final

嗨，强大的程序员，我再次作为 n00b 初学者寻求您的帮助......

问题如下，我有一个子窗口，包含一些标签、按钮和两个下拉菜单。我想在一个名为“name”的组合框中有一个 SelectionListener，以便从此下拉列表中选择的值将影响第二个 Combo - desc 中的选择值。

怎么做？

如果我取消注释

```
//desc.select(name.getSelectionIndex()); 
```

在

```
name.addSelectionListener(new SelectionAdapter()) 
```

eclipse 希望我将 Combo desc 和 Combo 名称更改为 final，这是不可能的，因为它需要在循环外初始化它们，破坏我的布局:(

这是代码：

```
public void tariffAddWindow(final Shell childWindow) {

    childWindow.setText("add dialog");

    labels = new Label[operatorTariffData.getColumnNames().length];
    inputTexts = new Text[operatorTariffData.getColumnNames().length];
    final Button buttons[] = new Button[operatorTariffData.getColumnNames().length];

    Combo name = null;
    Combo desc = null;

    for (int i =1; i< operatorTariffData.getColumnNames().length; i++) {

            labels[i] = new Label(childWindow, SWT.NONE);
            labels[i].setText(operatorTariffData.getColumnNames()[i].toString());
            labels[i].setBackground(blue);          

        if (i == 3) {
            name = new Combo(childWindow, SWT.READ_ONLY | SWT.BORDER);
            name.setLayoutData(tLayout);
            buttons[i] = new Button(childWindow, SWT.PUSH);
            buttons[i].setText("e");
        } else if (i == 4) {
            desc = new Combo(childWindow, SWT.READ_ONLY | SWT.BORDER);
            desc.setLayoutData(tLayout);
            buttons[i] = new Button(childWindow, SWT.PUSH);
            buttons[i].setText("e");
        } else {

            inputTexts[i] = new Text(childWindow, SWT.None);
            //texts[i].setText(data.getData()[i].toString());
            inputTexts[i].setLayoutData(tLayout);

            buttons[i] = new Button(childWindow, SWT.TOGGLE);
            buttons[i].setText("x");
            buttons[i].setSelection(false);
        }
    }

    for (int i = 1; i < contentProvider.getTariffNames().getQueryRowCount(); i++) {
        name.add(contentProvider.getTariffNames().getQueryData()[i][3].toString());
        desc.add(contentProvider.getTariffNames().getQueryData()[i][2].toString());
    }

    name.addSelectionListener(new SelectionAdapter() {
        public void widgetSelected(SelectionEvent e) {
            //desc.select(name.getSelectionIndex());
        }
    });
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T14:18:50.413

1.  您可以在类中创建`desc`和`name`字段：

    ```
    class Foo extends Composite
    {
        Combo name;
        Combo desc;

        public void tarriffAddWindow(final Shell childWindow)
        {
            // ...
            name.addSelectionListener(new SelectionAdapter() {
                public void widgetSelected(SelectionEvent e)
                    desc.select(name.getSelectionIndex());
                }
            });
        }
    } 
    ```

2.  您可以简单地将最终变量设置为`desc`and `name`：

    ```
    final Combo descRef = desc;
    final Combo nameRef = name;

    nameRef.addSelectionListener(new SelectionAdapter() {
        public void widgetSelected(SelectionEvent e)
            descRef.select(nameRef.getSelectionIndex());
        }
    }); 
    ```

# javascript - 在 wysiHTML5 编辑器中以编程方式插入 HTML

> ID：10739237
> 
> 赞同：9
> 
> 时间：2012-05-24T14:13:41.990
> 
> 标签：javascript, wysiwyg, wysihtml5

我找到了 javascript wysiwyg 编辑器[wysiHTML5](https://github.com/xing/wysihtml5)。

我正在尝试向`<a href=...>`编辑器添加元素，或者只是以编程方式打开粗体。

我的代码是：

```
var editor = new wysihtml5.Editor("textarea", {
    toolbar:      "toolbar",
    stylesheets:  "css/wysihtml5.css",
    parserRules:  wysihtml5ParserRules
});

editor.observe("load", function() {
    editor.composer.commands.exec("bold");
}); 
```

难道我做错了什么？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-05-27T01:08:04.977

实际上没有，但你必须确保你的 textarea (iframe) 是聚焦的。尝试使用`on`而不是`observe`. 这是一个使用 insertHTML 对我有用的示例代码。

```
editor.on("load", function() {
  editor.focus();
  editor.composer.commands.exec("insertHTML","<a href=....>text</a>");
}); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-12-13T21:16:35.463

mateusmaso 的解决方案给了我以下错误：

```
NS_ERROR_FAILURE：组件返回失败代码：0x80004005 (NS_ERROR_FAILURE) [nsIDOMHTMLDocument.execCommand]
[打破这个错误]   

Object.defineProperty（对象，属性，配置）；

```

因此，我进行了更多调查，并找到了以下解决方案，（IMO）似乎更合适：

```
 var value = 'whatever you want to set';
// The jQuery reference to the textarea
var $ta = $('textarea#your-selector');
// The reference to the wysihtml5 editor - everything is contained within it 
var w5ref = $ta.data('wysihtml5');
// Check if you have it
if(w5ref){
   // if yes it's really an enhanced / wysihtml5ed textarea 
   // and use its setter
   w5ref.editor.setValue(value);
} else {
   // otherwise just simply populate the textarea as you normally would
   $ta.html(value);
} 
```

[来源](https://github.com/jhollingworth/bootstrap-wysihtml5/issues/67)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-10-13T17:00:52.630

assuming you have instantiated the editor previously using `$('#textarea-id').wysihtml5()`

```
$('#textarea-id').data("wysihtml5").editor.setValue('new content'); 
```

[font](https://www.codementor.io/tips/0643978211/update-wysihtml5-editor-content-dynamically-using-jquery)

# c++ - 另一个没有任何意义的 g++ 编译错误

> ID：10739241
> 
> 赞同：0
> 
> 时间：2012-05-24T14:13:45.253
> 
> 标签：c++, g++

所以，我仍然在做这个大项目，让它在 Linux 上编译。所以，再次，我得到了一些不应该存在的错误。

这是我得到的一些错误：

```
(1) error: expected identifier before numeric constant
(2) error: "Value" doesn't name a type 
```

这是一段简化的示例代码，它向您展示了我在哪里得到这些错误：

```
class Test
{
public:
  enum Value
  {
    V1 = 0,  // error (1) is here
    V2 = 1,
    V3 = 2
  };

private:
  Value value; // error (2) is here

public:
  // constructor and other function
}; 
```

此外，那段代码在项目的某些部分是有效的。但它不是在其他部分。我做了所有事情，我重命名了一些东西以确保它没有歧义，不会改变任何东西。

卡在 GCC 4.1.2

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-24T14:27:38.623

该片段可以使用 g++ 4.4.3 编译，我希望它也可以使用 g++ 4.1.2 编译。

您遇到的原因是使用`#define`for 常量在 C++ 中是一件根本邪恶的事情。您包含的头文件之一包含如下行：

```
#define V1 42 
```

最快的解决方案是

```
#undef V1 
```

但是，如果有人足够恶意，`#define V1`那么我会为您的未来`V2`和`V3`您的未来感到类似的定义。根据我的个人经验`windows.h`，许多 X11 标头都广泛负责引入此类预处理器定义。

我想提供有关跟踪违规标头的建议，但我通常求助于 grep 和/或查看哪些标头在删除时使错误消失。

当我们遇到这个问题时，我们的一般做法是

*   尽量减少包含违规标头的位置数量 - 并且永远不要将其包含在标头文件中。
*   创建一个“安全”的包装标头，`#undef`其中包含所有有问题的常量，并在必要时用更合理的东西替换它们。

# java - 如何用布尔值有效地替换 Java HashMap

> ID：10739243
> 
> 赞同：6
> 
> 时间：2012-05-24T14:13:55.830
> 
> 标签：java, initialization, hashmap

我很感兴趣如何快速将布尔值更改为此哈希图：

```
HashMap<String, Boolean> selectedIds = new HashMap<>(); 
```

我想很快将布尔值全部替换为真的。我怎么能做到这一点？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-24T14:20:28.470

*最快*的方法是这样的：

```
for (Map.Entry<String, Boolean> entry : selectedIds.entrySet()) {
    entry.setValue(true);
} 
```

这段代码避免了任何查找，因为它遍历整个地图的条目并直接设置它们的值。

请注意，无论何时`HashMap.put()`调用，都会在内部进行密钥查找`Hashtable`。虽然代码经过高度优化，但仍需要计算和比较哈希码，然后使用算法最终找到条目（如果存在）。这都是“工作”，会消耗 CPU 周期。

* * *

### Java 8 更新：

Java 8[`replaceAll()`](https://docs.oracle.com/javase/8/docs/api/java/util/Map.html#replaceAll-java.util.function.BiFunction-)为此目的引入了一种新方法，使所需的代码更加简单：

```
selectedIds.replaceAll((k, v) -> true); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-24T14:16:04.860

这将遍历您的地图并将所有旧值替换为每个键的真实值。[HashMap put 方法](http://bit.ly/JZ3wnn)

```
for(String s : selectedIds.keySet()) {
    selectedIds.put(s, true);
 } 
```

# java - 在java中通过反射调用通用方法

> ID：10739248
> 
> 赞同：28
> 
> 时间：2012-05-24T14:14:19.917
> 
> 标签：java, generics, reflection

如何通过java中的反射调用自定义通用方法？

```
class Person
{
  public <T> void print(T t)
   {
      System.out.println(t.toString());
   }
} 
```

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-05-24T14:22:38.750

泛型在编译时被擦除，它们仅向编译器提供额外信息以确定错误。它们实际上并没有更改`.class`文件中方法的签名。

这意味着您在 Java 中通过反射调用泛型方法与在 Java 中调用非泛型方法的方式完全相同，除了指定类型 of 而不是指定`T`类型`Object`。

关于如何通过反射调用常规方法的教程太多了，我犹豫再添加一个；但是，如果您确实需要有关如何通过反射调用方法的指导，请在下面添加评论，我将添加必要的代码。

如果你发现事情没有按预期工作，你总是可以`javap`在编译的类文件上运行，以验证你在参数列表中使用了正确的对象。如果您指定`<T extends List>`类型泛型签名，则结果参数对象可能实际上是一个`List`对象。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-05-24T14:21:44.413

这对我有用。

```
Method method = Person.class.getMethod("print", Object.class);

method.invoke(new Person(), "this is a string");
method.invoke(new Person(), 273);
method.invoke(new Person(), new Object()); 
```

印刷

```
this is a string
273
java.lang.Object@addbf1 
```

当然，[@Edwin 的回答很好地解释了这背后的理论。](https://stackoverflow.com/a/10739387/343955)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2014-05-08T08:43:03.107

为了突出埃德温的回答中给出的观点，我们在泛型类型中使用扩展：如果你有一个像这样的类

```
GenericHibernateDao<T extends Serializable> 
```

, 和一个方法

```
public T save( T entity ) {}; 
```

要使用反射调用方法保存，您必须使用 Serializable 类，即，您需要使用：

```
Method method = GenericHibernateDao.class.getMethod(methodName, Serializable.class); 
```

而不是 Object.class 作为参数，因为我们正在使用

```
<T extends Serializable> 
```

# java - WAS 6 到 WAS 7 迁移问题

> ID：10739249
> 
> 赞同：1
> 
> 时间：2012-05-24T14:14:24.870
> 
> 标签：java, enums, rad

我在 WAS7(RAD7) 中打开了我的 WAS6 wrkspace。使用自动迁移工具后，我注意到枚举上有很多错误。

代码片段 -

```
protected static Enum getBaseEnum(Class enumClass, String name) {
    Enum enum = null;

    enum = getEnum(enumClass, name);

    if (enum == null) {
        String enumList = StringUtils.join(getEnumList(enumClass).iterator(), ",");
        log.error("INVALID ENUM TYPE: " + name + " FOR CLASS: " + enumClass.getName() + ", VALID TYPES: " + enumList);            
    }

    return enum;
} 
```

*如何删除这些错误* *无法解析枚举 AbstractEnum.java*

# android - Activity 加载内容的速度不够快

> ID：10739252
> 
> 赞同：1
> 
> 时间：2012-05-24T14:14:38.760
> 
> 标签：android, android-activity

我正在尝试为我的 Android 应用程序制作一个启动画面，登录页面只是启动 Splash 活动，然后所有登录处理都在那里完成。然后它返回一个布尔值是否登录成功。但登录处理在 XML 布局内容加载之前完成。如何解决这个问题？

这是我的启动画面活动：

```
@Override
public void onCreate(Bundle savedInstanceState) {

    super.onCreate(savedInstanceState);

    Bundle extras = getIntent().getExtras();
    if(extras !=null)
    {
        url = extras.getString("url");
    }

    setContentView(R.layout.splashscreen);
    url += "login/?userName=" + Login.loginName + "&password=" + Login.password;

    DomLoginParser parser = new DomLoginParser(url);
    if(parser.parse())
    {
        Login.loginSuccessful = true;
    }
    else
    {
        Login.loginSuccessful = false;
    }

    finish();
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T14:19:08.713

通过使用 AsyncTask 执行登录，将登录移出 onCreate 调用。您正在做的是在给它机会展示内容之前完成活动。只有在 onCreate 调用完成后，活动才会显示 contentView ...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T14:26:44.973

不知道 DomLoginParser 是做什么的，认为 Login 类是静态的，但是为什么要在 onCreate() 中调用 finish() 方法呢？

这就是问题所在，您立即终止活动！

删除 finish() 调用。

如果

```
DomLoginParser parser = new DomLoginParser(url);
if(parser.parse())
{
    Login.loginSuccessful = true;
}
else
{
    Login.loginSuccessful = false;
} 
```

这就是您对登录所做的所有事情，并且希望启动画面在一段时间内可见，调用 Thread.sleep() （但请注意，如果睡眠时间过长，它会产生 Application Not Responding），或者只是创建一个单独的进程（与另一个线程相关联的异步任务或线程处理程序，告诉您的启动屏幕完成）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T14:44:26.180

尝试这样的事情：

```
private class LoginChecker extends AsyncTask<Void, Void, Void> { 

         protected Void doInBackground(Void... args) { 
              DomLoginParser parser = new DomLoginParser(url);    
              if(parser.parse())    {   
                  Login.loginSuccessful = true;    
              }    else    {        
                  Login.loginSuccessful = false;    
              }    
             return null;     
         }     

         protected void onPostExecute(Long result) {         
           // finish the activity    
         } 

    } 
```

要调用它，请将您的 onCreate 方法更新为以下内容：

```
@Override        
public void onCreate(Bundle savedInstanceState) {                   
      super.onCreate(savedInstanceState);                    
      Bundle extras = getIntent().getExtras();            
      if(extras !=null) {                
         url = extras.getString("url");            
      }                    
      setContentView(R.layout.splashscreen);            
      url += "login/?userName=" + Login.loginName + "&password=" + Login.password;                    
      new LoginChecker.execute();
} 
```

# php - Windows 上 PHP 的常用安装路径

> ID：10739257
> 
> 赞同：3
> 
> 时间：2012-05-24T14:14:47.817
> 
> 标签：php

我正在构建一个需要知道 PHP (php-win.exe) 在 Windows 上安装位置的设置过程。它会询问用户位置，但理想情况下，它会首先测试一些明显的位置。

明显的安装路径包括：

*   C:/程序文件/PHP
*   C:/wamp/bin/php/版本/

有人有清单或更多建议吗？

[这是由命令行工具使用的，而不是安装程序，它可以很容易地选择文件夹]。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T14:40:39.470

我在 Windows 上看到的 PHP 最常见的路径是：

> C:\php

如果你正在检查`wamp`你也可以检查`xampp`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-26T00:31:26.007

安装前 4 或 5 个[WAMP](http://en.wikipedia.org/wiki/Comparison_of_WAMPs)以查看它们放置 PHP 的位置。

他们中的大多数人将其放在自己的文件夹中。

例如，Wamp-Developer 将 PHP 放入 C:\WampDeveloper\Components\Php

除了 PHP 的独立文件夹之外，它应该涵盖其中的 95%。

您的设置过程还可以运行 php.exe 的快速目录搜索。

# javascript - 阻止访问某些功能

> ID：10739258
> 
> 赞同：3
> 
> 时间：2012-05-24T14:14:49.770
> 
> 标签：javascript, jquery, resize

在我的页面上，我有两个按钮 -

```
<input type="button" value="Fit Window" onclick="FitWindow()">
<input type="button" value="Actual Size" onclick="ActualSize()">

function FitWindow()
{
   $("body").css("zoom",iZoomValue*100+"%"); 
}
function ActualSize()
{
   $("body").css("zoom","1"); 
} 
```

最初会发生一个大图像被放大（使用 CSS）以适应窗口。如果用户想查看实际尺寸，他可以点击实际尺寸按钮。我也捕捉到了 resize 事件，所以如果用户调整浏览器窗口的大小，图像将根据浏览器窗口的高度和宽度放大。

```
$(window).bind('resize', function () {
   FitWindow();
}); 
```

它在其他浏览器上运行良好，但是，在 IE 中，当用户单击按钮时，它以某种方式检测到调整大小事件并跳转到`FitWindow()`功能（我猜是由于 IE 在处理调整大小事件时的行为）。我正在寻找的是是否可以检测到按钮事件并避免调用调整大小函数？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T14:45:18.873

在调整大小事件中，查找`$("body").css("zoom") != 1`，例如：

```
$(window).bind('resize', function () {
   if ($("body").css("zoom") != 1)
      FitWindow();
}); 
```

# macos - ant 编译库似乎在缓存 swcs

> ID：10739263
> 
> 赞同：1
> 
> 时间：2012-05-24T14:15:18.253
> 
> 标签：macos, actionscript-3, flash, ant

我对这个非常恼火。这是场景：

1.  我有一个构建和输出一堆 swcs 的 ant 任务
2.  ant 任务删除“libs”文件夹中的所有项目，然后按照我的库输出的顺序进行编译，将它们输出到“libs”文件夹。
3.  我编译的其他模块依赖于这些库

问题：我遇到的问题是依赖于另一个 swc 的 swc 正在针对旧版本而不是刚刚在 ant 任务中构建的版本进行编译。

所以我们先编译common.swc，然后编译mydependantswc.swc。当我编译 mydependantswc.swc 时，是针对 common.swc 编译的——刚刚构建的那个。当我编译它像 common.swc 一样被缓存时，它会忽略一次刚刚构建并针对旧版本进行编译。

我知道当您在重新编译之前不删除旧的 swc 库时，会在闪存中发生这种情况。但是，我的 ant 任务会删除这些文件。我发现在mac上，如果我手动进入finder并删除那些库，然后编译，它工作正常。即使 ant 任务这样做，它也不起作用。

请问有什么想法吗？听起来这可能是一个普遍的问题？

这里有一些蚂蚁代码片段，我认为它很简单的蚂蚁。

```
<target name="install-libraries" description="standalone build libs">
        <delete includeEmptyDirs="true">
            <fileset dir="${bin.dir}/${managed.libs.dest}"/>
        </delete>
        <mkdir dir="${bin.dir}/${managed.libs.dest}"/>
        <antcall target="compile-libraries"/>
    </target> 
```

其次是标准的compc任务。

在推特上交谈后，我怀疑它与文件夹结构有关。您会看到一个库依赖于此文件夹 bin.dir 中的另一个编译库，这也是我要构建的文件夹。不知道为什么，我闻到一股香味！

# vb.net - 将文件转换为base64函数输出

> ID：10739264
> 
> 赞同：6
> 
> 时间：2012-05-24T14:15:28.723
> 
> 标签：vb.net, file, base64

```
Public Function ConvertFileToBase64(ByVal fileName As String) As String

    Dim ReturnValue As String = ""

    If My.Computer.FileSystem.FileExists(fileName) Then
        Using BinaryFile As FileStream = New FileStream(fileName, FileMode.Open)
            Dim BinRead As BinaryReader = New BinaryReader(BinaryFile)
            Dim BinBytes As Byte() = BinRead.ReadBytes(CInt(BinaryFile.Length))
            ReturnValue = Convert.ToBase64String(BinBytes)
            BinaryFile.Close()
        End Using
    End If
    Return ReturnValue
End Function 
```

我想问的问题：

1.  我想要将文本文件“C:\Users\user\Desktop\rats\test\test.txt”转换为base64的输出
2.  当我将“test.txt”转换为 base64 时，我无法获得任何输出
3.  我使用 filename="textbox1.text" 添加我的“test.txt”

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-09-27T06:20:21.740

```
 Public Function ConvertFileToBase64(ByVal fileName As String) As String
        Return Convert.ToBase64String(System.IO.File.ReadAllBytes(fileName))
    End Function 
```

# jquery - jQuery css“+=”不工作

> ID：10739267
> 
> 赞同：4
> 
> 时间：2012-05-24T14:15:34.807
> 
> 标签：jquery, css, operators

我有这个`<div>`：

```
<div class="ball" style="top: 1px;"></div> 
```

该`top`属性是使用 jQuery 函数设置的`.css`，如下所示：

```
$( ".ball" ).css( { top : var_top } ); 
```

但是，当我尝试使用这种语法增加它时，它不起作用：

```
$( ".ball" ).css( { top : "+=" + var_top } ); 
```

我什至在 Firebug 的控制台中尝试过这样的：

```
$( ".ball" ).css( { top : "+=7px" } );
$( ".ball" ).css( { top : "+=7" } ); 
```

但这些都不起作用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T14:16:51.960

你可以试试这个

```
$( ".ball" ).css({ top : "+=" + var_top + 'px'}); 
```

**注意：**如果`.ball`有`position:absolute`那么，它的父母需要有`position:relative`;

而且您的代码似乎也在**[工作](http://jsfiddle.net/nTrM7/1/)**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T14:21:58.517

我认为你必须检索旧值，增加它然后重新分配它：

```
var topPosition = $( ".ball" ).css('top');
topPosition += increment;
$( ".ball" ).css('top', topPosition); 
```

# python - 用python标记双层图像中的区域

> ID：10739268
> 
> 赞同：1
> 
> 时间：2012-05-24T14:15:36.733
> 
> 标签：python

我想从 python 中的二维二进制矩阵中标记相邻像素的簇。基本上，我正在尝试找到类似于 idl 函数 label_region 的东西 [http://star.pst.qub.ac.uk/idl/LABEL_REGION.html](http://star.pst.qub.ac.uk/idl/LABEL_REGION.html) 你有什么建议吗？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T09:54:39.407

答案在这里[http://pythonvision.org/basic-tutorial](http://pythonvision.org/basic-tutorial) 我使用了这个函数`ndimage.label`

# jquery - 用于更改背景颜色的基本 jQuery 插件

> ID：10739274
> 
> 赞同：2
> 
> 时间：2012-05-24T14:15:52.983
> 
> 标签：jquery, jquery-plugins

我是一个正在尝试 jQuery 插件开发的新手。我正在尝试从外部 js 文件（一个小插件）更改背景颜色控制台说“未捕获的类型错误：对象 # 没有方法 'css'”如果我完全偏离轨道，请原谅我。

HTML

```
<button id="clicker">change</button>
<div id='ra'>Box</div>​ 
```

CSS

```
#ra {
    height:100px;
    width:100px;
    background-color: #DDD;
}​ 
```

JS

```
var $ra = $('#ra');
$('#clicker').on('click',function(){
    $ra.change()
});    ​ 
```

这是我的插件。

```
function( $, window, document, undefined ) { 
    $.fn.change = function( options ) {
        return this.each (function() { 
            this.css('background-color','rgba(52,36,42,0.2)');
        });
    };
})( jQuery, window, document ); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T14:17:59.570

在`each`循环内部，`this`指的是本地 DOM 节点，而不是 jQuery 对象。您需要将其传递给 jQuery：

```
return this.each (function() { 
    $(this).css('background-color','rgba(52,36,42,0.2)');
}); 
```

另请注意，在您的问题中，插件代码缺少左括号。我猜这只是将代码复制并粘贴到您的问题中的错误。

这是一个[工作示例](http://jsfiddle.net/MBnyE/)。

# exception - 线程“主”java.lang.NoSuchMethodError Cassandra hector API 中的 NoException

> ID：10739277
> 
> 赞同：1
> 
> 时间：2012-05-24T14:16:01.757
> 
> 标签：exception, client, cassandra, nosuchmethoderror

我正在尝试安装和执行 cassandra API：hector。

在进程启动期间，抛出 1 个异常并出现此跟踪：

> 线程“主”java.lang.NoSuchMethodError 中的异常：org.apache.cassandra.thrift.Column.(Ljava/nio/ByteBuffer;Ljava/nio/ByteBuffer;J)V 在 me.prettyprint.cassandra.model.HColumnImpl.toThrift (HColumnImpl.java:112) 在 me.prettyprint.cassandra.model.MutatorImpl.addInsertion(MutatorImpl.java:98) 在 me.prettyprint.cassandra.model.MutatorImpl.insert(MutatorImpl.java:54) 在 com.featherlite。 example.dao.ObjectDAO.insert(ObjectDAO.java:87) at com.featherlite.example.ClientExample.testWR(ClientExample.java:148) at com.featherlite.example.ClientExample.main(ClientExample.java:225)

我只是从示例中启动一个项目。我没有写这个我只是尝试。

我已经看到当我加载 2 个不同的或旧的节俭 jar 库时会发生这种情况。在我的项目中，有 2 个 thrifts jar 文件：

*   libthrift-0.7.0.jar
*   apache-cassandra-thrift-1.1.0.jar

第一个是与此异常有关的 jar，因为当我删除他时，我有更多错误。

阿帕奇卡桑德拉：1.1.0

对不起，我的英语不好 ：/

各种问候，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T14:26:50.270

apache-cassandra-thrift-1.1.0.jar 包含 Cassandra 的 Thrift 相关类，而 libthrift-0.7.0.jar 是底层 Thrift 协议实现。听起来您的类路径中可能引用了一个旧 jar，可能以更高的优先级加载？

# mysql - MySQL 每小时平均发帖数？

> ID：10739280
> 
> 赞同：11
> 
> 时间：2012-05-24T14:16:10.930
> 
> 标签：mysql, sql, relational-database

我有一些帖子保存到 MySQL 上的 InnoDB 表中。该表具有列“id”、“date”、“user”、“content”。我想制作一些统计图表，所以我最终使用以下查询来获取昨天每小时的帖子数量：

```
SELECT HOUR(FROM_UNIXTIME(`date`)) AS `hour`, COUNT(date)  from fb_posts 
WHERE DATE(FROM_UNIXTIME(`date`)) = CURDATE() - INTERVAL 1 DAY GROUP BY hour 
```

这将输出以下数据：

![表数据](../Images/8b89d0e593399f838672edfb49fc3ce5.png)

我可以编辑此查询以获得我想要的任何一天。但是我现在想要的是每天每个小时的平均值，所以如果在第 1 天 00 小时我有 20 个帖子，而在第 2 天 00 小时我有 40 个帖子，我希望输出为“30”。如果可能的话，我也希望能够选择日期期间。

提前致谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-24T14:46:07.927

您可以使用子查询按天/小时对数据进行分组，然后在子查询中按小时取平均值。

下面是一个示例，为您提供过去 7 天的平均小时数：

```
select the_hour,avg(the_count)
from
(
  select date(from_unixtime(`date`)) as the_day,
    hour(from_unixtime(`date`)) as the_hour, 
    count(*) as the_count
  from fb_posts
  where `date` >= unix_timestamp(current_date() - interval 7 day)
  and created_on < unix_timestamp(current_date())
  group by the_day,the_hour
) s
group by the_hour 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T14:40:48.750

按日期和小时汇总信息，然后按小时取平均值：

```
select hour, avg(numposts)
from (SELECT date(`date`) as day, HOUR(FROM_UNIXTIME(`date`)) AS `hour`,
             count(*) as numposts
      from fb_posts
      WHERE DATE(FROM_UNIXTIME(`date`)) between <date1> and <date2>
      GROUP BY date(`date`), hour 
     ) d
group by hour
order by 1 
```

顺便说一句，我更喜欢包含显式排序依据，因为大多数数据库不会对分组的结果进行排序。Mysql 恰好是这样一个数据库。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T15:15:27.250

```
SELECT 
    HOUR(FROM_UNIXTIME(`date`)) AS `hour`
    , COUNT(`id`) \ COUNT(DISTINCT TO_DAYS(`date`)) AS avgHourlyPostCount
FROM fb_posts 
WHERE `date` > '2012-01-01' -- your optional date criteria 
GROUP BY hour 
```

这使您可以按小时计算所有帖子的数量，除以天数。

# c++ - GCC：在“预初始化”时间执行代码

> ID：10739283
> 
> 赞同：2
> 
> 时间：2012-05-24T14:16:32.990
> 
> 标签：c++, c, linux, gcc, glibc

因此，在 Linux 上，当使用 gcc 编译/链接的 C++ 程序加载其可执行文件时，会发生以下情况：

1.  执行*系统调用
2.  加载了 LD 动态库
3.  C++ 静态初始化
4.  主入口点

假设我有一些原型功能`void f()`，

是否有某种方式（通过源修改、属性、编译器/链接器选项等）将可执行文件与 f 链接，以便在第 1 步和第 2 步之间执行？

第 2 步和第 3 步之间呢？

（显然没有标准的方法可以做到这一点，我要求为最新版本的 gcc/linux/x86_64/glibc/binutils 提供平台特定、编译器特定的方式）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T16:56:37.217

是的，您可以在 (1) 和 (2) 之间或 (2) 和 (3) 之间执行此操作。第 2 步“加载了 ld 动态库”实际上是通过调用动态链接器来完成的，`ld.so`. 通常，这将是`/lib64/ld-linux-x86-64.so.2`或类似的；它是 glibc 的一部分。但是，路径实际上是在可执行文件中指定的，因此您可以使用任何您想要的路径。

```
$ readelf -l `which bash`
⋮
Program Headers:
⋮
  INTERP         0x0000000000000238 0x0000000000400238 0x0000000000400238
                 0x000000000000001c 0x000000000000001c  R      1
      [Requesting program interpreter: /lib64/ld-linux-x86-64.so.2]

⋮ 
```

这是除了做`LD_PRELOAD`/之类的事情之外`LD_AUDIT`。

对于 (2) 和 (3) 之间，听起来您只想更改入口点地址。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-24T16:51:37.657

基本上没有。系统调用将`execve()`擦除环境。您在地址空间中所做的任何事情都无法在新地址空间中继续存在。您可以将文件描述符（当然，标记为 CLOEXEC 的除外）发送到新进程中，并且您可以通过环境将参数传递给它。

...这给了你一些可能做你想做的事。您可以将 LD_PRELOAD 设置为“首先”加载共享库，然后从目标可执行文件运行任何代码，并且在共享链接器解析任何符号之前。从您的问题中不清楚这是否符合您的要求。

# postgresql - NSIS 运行 pg_restore 或 psql 命令 - 无法正确恢复数据库

> ID：10739284
> 
> 赞同：0
> 
> 时间：2012-05-24T14:16:34.127
> 
> 标签：postgresql, nsis

在 NSIS 安装程序中，我使用以下行从与安装程序一起打包的文件中恢复 PostgreSQL 数据库。

```
ExecWait '$pg_restore_path --host 127.0.0.1 --no-password --port 5432 --username "postgres" --dbname "myDatabase" --verbose $EXEDIR/myDatabase.backup' $0 
```

该命令有效，但 pg_restore 似乎错误地设置了某些 postgres 序列的当前值（当前值被重置为 1 或低于源值的数字）导致冲突。这似乎是 postgres 的原生错误，但真的不确定。

我也尝试过用 psql 替换 pg_restore，如下所示：

```
ExecWait '$psql_path -f "$EXEDIR/myDatabase.sql" myDatabase' 
```

哪个不起作用；终端弹出并关闭。或者像这样：

```
ExecWait '$psql_path myDatabase < $EXEDIR/myDatabase.sql' 
```

导致错误的原因`psql: warning: extra command-line argument "<" ignored`

当我`psql`从命令行手动运行命令时，它就像一个魅力，并且序列设置正确。所以我的问题是如何让`psql`命令在 NSIS 中工作并提供文件`<`并避免错误。如果做不到这一点，关于使用`pg_restore`不同的方法可以解决序列问题的任何见解？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T17:56:20.670

以下 NSIS 命令似乎已经解决了它。

```
ExecWait '$createdb_path -h "127.0.0.1" -p "5432" -U "postgres" -T "template1" --owner "user_owner" myDatabase'
ExecWait '$psql_path -f "$INSTDIR/myDatabase.sql" myDatabase user_owner' 
```

# actionscript-3 - 在不改变孩子尺寸的情况下改变容器的宽度和高度

> ID：10739291
> 
> 赞同：0
> 
> 时间：2012-05-24T14:16:56.280
> 
> 标签：actionscript-3, flash

我有一个需要更改其尺寸的影片剪辑容器。但是它包含一个需要保留的位图。因此，无论我如何更改其容器的尺寸，它都保持完好无损。我知道，一种方法是相应地更改“位图”的比例。比如说，容器的宽度是两倍，然后位图可以调整为 scale = 0.5（因此进行补偿）。

但是我怀疑这种方法是否对位图有明显的好处，以防尺寸变化是小数。像比例 = 1.2345 等

还有什么好办法吗？

五。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T14:29:37.153

您可以尝试覆盖容器的 scaleX/scaleY setter 和 getter，以便更改它们会导致更改容器内的所有内容，但位图**除外**。

这会起作用，但有点奇怪。您确定不能以不同的方式组织您的对象吗？

如果您的容器中有不受容器尺寸影响的物品，那么这些物品根本不属于那里。拆分结构可能是个好主意。

你可以有一个 Sprite 来保存你的位图，然后将你的“容器”作为蒙版应用到它上面，这样只有与“容器”一样大的部分是可见的，或者沿着这些线的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T23:44:41.017

将矩阵应用于 BitmapData，这将对其进行重新采样。

# jquery - 图像变得不确定

> ID：10739292
> 
> 赞同：1
> 
> 时间：2012-05-24T14:17:00.570
> 
> 标签：jquery, arrays, undefined, each

我正在开发一个可以创建相册的图像共享网站。每个相册并排呈现，默认包含四个占位符图像。我想要的是用相册中的前四张图片替换这些图片。

问题是一张专辑只能包含一个图像，在这些情况下，我希望其余的占位符图像保持原样。使用下面的代码替换所有占位符图像，但在相册仅包含一个（或两个或三个）图像的情况下，其余图像将替换为“../images/undefined”（其余的代码工作正常，专辑的第一张图片被正确渲染）。

我错过了什么？

**js代码：**

```
if ($('.hiddenAlbumNames').length > 0){

    $('.hiddenAlbumNames').each(function() {
        var i = 0;
        var value = $(this).val();
        var valueArray = value.split(',');

        $(this).parent().find('.albumThumbnail').each(function() {
            $(this).attr('src', '../images/' + valueArray[i]);
            i++;
        });
    });
}; 
```

**html 代码：（**此代码为每张专辑呈现一次）

```
<div class="blog">
    <div class="post">
        <input class="hiddenAlbumNames" type="hidden" value="album.imageName") <- "album.imageName" is a node.js variable
        <div class="albumThumbnailArea">
            <img class="albumThumbnail" src='../img/bg.png'>
            <img class="albumThumbnail" src='../img/bg.png'>
            <img class="albumThumbnail" src='../img/bg.png'>
            <img class="albumThumbnail" src='../img/bg.png'>
        </div>
    </div>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T14:29:11.333

尝试：

```
 $(this).parent().find('.albumThumbnail').each(function() {
        if (i<valueArray.length) {
            $(this).attr('src', '../images/' + valueArray[i]);
            i++;
        } // else { ... something else ... }
    }); 
```

# sharepoint - SharePoint 2010 Intranet 网站的 http 到 https 重定向

> ID：10739304
> 
> 赞同：0
> 
> 时间：2012-05-24T14:17:43.040
> 
> 标签：sharepoint, sharepoint-2010

我想在 SharePoint 2010 Intranet 站点上执行 http 到 https 重定向。我从搜索中得到的一种方法是 URL Re-write。

我正在尝试将 http 请求自动重定向到我的 sharepoint 2010 站点的 https 请求。

我正在使用 URL 重写模块来实现这一点，下面是我使用的规则：

```
<rule name="Redirect to HTTPS" stopProcessing="true"><match url="(.*)" /><conditions> 
```

我已取消选中此站点的 Require SSL 选项。但是当我点击 Http url 时，它仍然显示“错误 504”并且页面没有被重定向。如果您对此进行了研究，请指导我。

如果可以使用 URL Re-write 以外的任何更好的方法，请提出建议。

问候，

稻田

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-09T15:05:57.093

实际上有一个非常简单的方法可以做到这一点。

创建一个名为“redirect - [http://www.site-name.com](http://www.site-name.com) ”的新站点，将其映射到端口 80，并在其中放置一个包含以下信息的 webconfig。这将是唯一的文件。

* * *

```
<?xml version="1.0" encoding="UTF-8"?>
<configuration>
    <system.webServer>
        <httpRedirect enabled="true" destination="https://www.site-name.com" />
    </system.webServer>
</configuration> 
```

简单，像冠军一样工作

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T18:24:22.873

为什么不[使用备用访问映射](http://technet.microsoft.com/en-us/library/cc288173%28v=office.12%29.aspx)？据我所知，就是这样。

问候！

# sql - 在 SQL 函数/问题中设置变量

> ID：10739306
> 
> 赞同：0
> 
> 时间：2012-05-24T14:17:45.843
> 
> 标签：sql, sql-server

假设我有一个普通的 SQL 过程，它有几个参数。

在调试过程中，如果我可以为这些参数分配一些值，这样我就可以突出显示 proc 的主体并执行它（而不是手动将变量替换为值。

有没有办法做到这一点？我试过：

```
@Date1 datetime,
@Date2 datetime

SET @Date1 = '2012-03-23' 
```

但它不喜欢它？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T14:22:14.617

尝试 `DECLARE @Date1 datetime` `SET @Date1 = '2012-03-23'`

看起来你错过了声明声明。如果它不喜欢 '2012-03-23' 部分，您可能需要强制转换它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-24T14:32:24.063

如果你打算这样做，我建议你考虑在你的程序中添加一个@Debug 参数：

```
create procedure dbo.SomeProc @p1 int, @p2 int, @Debug bit = 0x0
as
set nocount on
begin

if @Debug = 0x1 -- set test values only if debugging
begin
print 'Start debugging'
set @p1 = 1
set @p2 = 2
end

/* your code continues here... */

end 
```

然后当你想测试你的代码时，只需执行程序`@Debug = 0x1`来执行调试代码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-24T14:21:47.627

在@Date1 前面加上“声明”字样

# ios - iOS：检测手指离开屏幕两侧？

> ID：10739307
> 
> 赞同：1
> 
> 时间：2012-05-24T14:17:54.320
> 
> 标签：ios, uiviewcontroller

是否有方法/类来检测手指在一侧滑出屏幕时是否离开屏幕？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T14:31:12.960

您可以尝试使用 touchesEnded 来检测触摸结束时手指的位置。如果是在屏幕边的边缘，则可以推断出用户已经离开了屏幕。

所以在 iPhone 上，如果它是左侧或右侧，它的 x 坐标为 0 或 320，如果它是顶部和底部，它的 y 坐标为 0 或 480。在 iPad 上它会分别为 0 和 768，以及 0 和 1024。

```
-(void) touchesEnded:(NSSet *)touches withEvent:(UIEvent *)event 
```

您可以从 touchesBegan 开始并检测它们来自哪个方向，以决定向哪个方向滑动屏幕。

```
-(void) touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event 
```

touchesBegan 和 touchesEnded 是 UIResponder 类的方法，因此它应该可以在任何地方免费使用。

# c++ - 替换或修改外部应用程序中的 API 调用（GetOpenFileName、GetSaveFileName）

> ID：10739312
> 
> 赞同：4
> 
> 时间：2012-05-24T14:18:10.407
> 
> 标签：c++, winapi, crash, hook, .net-assembly

我有一个调用 GetOpenFileNameA 和 GetSaveFileNameA 的旧应用程序。两个调用都是错误的。应用程序崩溃！我使用 OllyDbg 和 API Monitor 来读取存储在 OPENFILENAME 结构中的大小。结构的大小为 76 字节（使用 Windows 7 x64 进行测试）。调用 GetOpenFileNameA 或 GetSaveFileNameA 时出现访问冲突异常。我假设在运行时 Windows 尝试读取 88 字节而不是 76 字节。看看这个： [http](http://dotnetbutchering.blogspot.de/2007/10/vc-60-getting-0xc0000005-access.html) ://dotnetbutchering.blogspot.de/2007/10/vc-60-getting-0xc0000005-access.html 和这个 [http://www.asmcommunity.net/board/index.php?topic =5768.15](http://www.asmcommunity.net/board/index.php?topic=5768.15)

我进行了一些研究，在此过程中我检测到以下行为：运行 Microsoft Spy++ 时，应用程序不会崩溃！我逐步通过调试器，我看到访问冲突异常仍然发生，但不知何故该异常被吞没了。该应用程序运行良好！我可以加载和保存文件。

我有以下想法。你觉得他们怎么样？

1.  写。就像一个 Loader.exe，它和 Spy++ 一样。调用两个 API 时吞下访问冲突异常。

2.  使用 DLL 注入和 API 挂钩。我可以将 GetOpenFileName 和 GetSaveFileName 与自定义 DLL 中的自定义实现挂钩。我的实现将修复结构并将更正后的结构传递给原始 API 调用。

3.  使用 SetWindowsHook 挂钩窗口消息？！？！？！

4.  修补二进制文件。是否可以通过使用 HEX 编辑器进行修补来解决此结构大小问题？

哪一个会起作用？你知道我该如何解决这个问题吗？

我无法获得这个旧应用程序的源代码。我必须使用现有的二进制文件来修复它。我的解决方案必须至少在 Windows XP 和 Windows 7（x86、x64）上运行

工具 PEiD 向我显示了有关旧应用程序的以下信息：链接器信息：2.55 MS Visual C++ 4.0

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T16:03:56.063

> 结构的大小为 76 字节（使用 Windows 7 x64 进行测试）。调用 GetOpenFileNameA 或 GetSaveFileNameA 时出现访问冲突异常。我假设在运行时 Windows 尝试读取 88 字节而不是 76 字节。

如果你看一下`OPENFILENAME` `struct`你会注意到：

```
#if (_WIN32_WINNT >= 0x0500)
  void *        pvReserved;
  DWORD         dwReserved;
  DWORD         FlagsEx;
#endif // (_WIN32_WINNT >= 0x0500) 
```

这在 32 位程序（VC++ 4 不支持 64 位目标）中转换为正好 12 个字节的差异。只要`lStructSize`调用者正确设置，这根本不应该是一个问题。`procdump`从 Microsoft/Sysinternals 获取确切状态的小型转储（或附加调试器并进行调查）可能是值得的。您遇到的异常不一定是由于`struct`大小。如果是这样，微软更有可能在此功能的向后兼容性方面失手。显然`OPENFILENAME::lStructSize`有版本控制`struct`和确保你遇到的事情不会发生。但是，我们谈论的是使用 Windows 2000 之前的编译器/链接器构建的程序。

> 写。就像一个 Loader.exe，它和 Spy++ 一样。调用两个 API 时吞下访问冲突异常。这是一个公平的观点。如果您要在顶层插入异常处理，您可以做您想做的事情，但它可能会导致副作用，具体取决于导致异常的确切原因（即覆盖了确切的内存）。
> 
> 使用 DLL 注入和 API 挂钩。我可以将 GetOpenFileName 和 GetSaveFileName 与自定义 DLL 中的自定义实现挂钩。我的实现将修复结构并将更正后的结构传递给原始 API 调用。这和第一个有很大关系。我认为这将是最简单和最安全的，因为这样你就可以在没有太多干扰的情况下纠正行为。请进一步阅读下文。另外，请查看 NInjectLib。
> 
> 使用 SetWindowsHook 挂钩窗口消息？！？！？！除了促进 DLL 的注入（对于 1\. 和 2.）之外，我看不出这有什么帮助。
> 
> 修补二进制文件。是否可以通过使用 HEX 编辑器进行修补来解决此结构大小问题？这可能是最棘手的，取决于它`OPENFILENAME`是在二进制文件中（初始化数据）还是在堆栈中，或者它是否在堆上分配（那么容易）。

* * *

1\. 和 2\. 的一种可能的混合方法是：

1.  添加一个以`HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options`您正在执行的程序命名的子键（例如`foo.exe`）
2.  在新创建的子键中创建一个`REG_SZ`名为`Debugger`的值，并将该值设置为我现在将尝试简要描述的程序。

这有效地为您的这个旧应用程序设置了一个调试器，这意味着我们要编写的调试器将接收您应用程序的命令行作为参数。它很方便，因为它对最终用户是透明的，您可以根据自己的需要进行调整。

您需要编写一个调试器。这个任务并不像一开始看起来那样令人讨厌，因为您可以使用 Win32 提供的调试助手。要点在调试器循环中。通常，您使用`CreateProcess`传递适当的标志来自己创建目标进程以便能够对其进行调试。使用`WaitForDebugEvent`和`ContinueDebugEvent`控制执行。出于所有实际目的，您甚至可能根本不需要调试器循环，因为您可以创建挂起的目标应用程序的主线程（传递`CREATE_SUSPENDED`给`CreateProcess`），然后`CONTEXT`一开始就将主线程指向您自己的代码，然后调用`ResumeThread(pi.hThread)`. 这样，您将在主线程启动之前完成。但是，这可能会导致问题由于方式`kernel32.dll`的`CreateThread`工作（这涉及使用 Win32 子系统 aka 注册新线程`csrss.exe`）。因此，建议改为在内存中修补目标的 IAT 或类似的东西。毕竟你只对两个功能感兴趣。

查看[此处](http://www.codeproject.com/Articles/43682/Writing-a-basic-Windows-debugger)和[此处](http://www.codeproject.com/Articles/132742/Writing-Windows-Debugger-Part-2)的两篇文章，以更详细地了解该主题。

我更喜欢基于 PaiMei 编写我的调试器`PyDbg`，[但](https://github.com/OpenRCE/paimei)我承认我没有尝试在`Image File Execution Options`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T14:44:38.770

(1) 将是纯 hack，很难做到（Spy++ 行为的哪个方面？或者你想重新发明完整的 Syp++？），即使你这样做了，你怎么能确保应用程序能正常工作（对于所有输入）在“吞下异常”之后？程序的内部状态可能是未定义的，并在以后导致其他问题。

(2) 假设您没有资源，因此您无法以正常方式修复它，恕我直言，这似乎是解决该问题的最佳方法。

(3) 我看不出这对你有什么帮助。

(4) 可能，但可能需要做很多工作。假设堆栈上有一些数据，然后通过调整其中一个（`OPENFILENAMEA`结构）的大小，您可以移动其他数据的偏移量，因此您必须“修复”对这些数据的引用。

# java - 使用 Spring 在 Rest API 中返回实体

> ID：10739314
> 
> 赞同：5
> 
> 时间：2012-05-24T14:18:14.703
> 
> 标签：java, json, spring, rest

在 Spring 中为 web 应用程序创建一个 restful api 非常容易。假设我们有一个 Movie 实体，带有名称、年份、类型列表和演员列表。为了以 json 格式返回所有电影的列表，我们只需在某个控制器中创建一个方法，该方法将查询数据库并返回一个列表作为 ResponseEntity 的主体。Spring 会神奇地序列化它，一切都很好:)

但是，如果我，在某些情况下，希望电影中的演员列表被连载，而不是在其他的？在其他情况下，除了电影类的字段，我需要为列表中的每部电影添加一些其他属性，哪些值是动态生成的？

我目前的解决方案是在某些字段上使用 @JsonIgnore 或创建一个包含 Movie 类中的字段和所需的其他字段的 MovieResponse 类，并且每次都从 Movie 转换为 MovieResponse 类。

有一个更好的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T01:53:55.167

JSONIgnore 注释的重点是告诉 DispatcherServlet（或 Spring 中处理呈现响应的任何组件）如果这些字段为空或以其他方式省略，则忽略某些字段。

这可以为您在某些情况下向客户端公开哪些数据方面提供一些灵活性。

**JSONIgnore 的缺点：**

但是，我最近在自己的项目中遇到了使用此注释的一些缺点。这主要适用于 PUT 方法以及控制器将数据序列化到的对象与用于在数据库中存储该数据的对象相同的情况。

PUT 方法意味着您要么在服务器上创建一个新集合，要么将服务器上的一个集合*替换*为您正在更新的新集合。

**替换服务器上的集合的示例：**

想象一下，您正在向您的服务器发出 PUT 请求，并且 RequestBody 包含一个序列化的 Movie 实体，但该 Movie 实体不包含任何演员，因为您省略了它们！稍后，您实现了一项新功能，允许您的用户编辑和更正电影描述中的拼写错误，您使用 PUT 将电影实体发送回服务器，并更新数据库。

但是，让我们这么说——因为您已经很久没有向对象添加 JSONIgnore 了——您忘记了某些字段是可选的。在客户端，您忘记包含演员集合，现在您的用户不小心用演员 B、C 和 D 覆盖了电影 A，而电影 A 没有任何演员！

**为什么选择加入 JSONIgnore？**

按理说，强迫您选择不填写某些字段的意图正是为了避免这些类型的数据完整性问题。在您不使用 JSONIgnore 的世界中，您可以保证您的数据永远不会被部分数据替换，除非您自己*明确*设置该数据。使用 JSONIgnore，您可以删除这些保护措施。

话虽如此，JSONIgnore 非常有价值，我自己以完全相同的方式使用它来减少发送到客户端的有效负载的大小。但是，我开始重新考虑这种策略，而是选择在一个单独的层中使用 POJO 类来将数据发送到前端，而不是我用来与数据库交互的策略。

**可能更好的设置？：**

理想的设置——根据我处理这个特定问题的经验——是为你的实体对象使用构造函数注入而不是设置器。强迫自己在实例化时必须传入每个参数，这样您的实体就不会被部分填充。如果您尝试部分填充它们，编译器会阻止您做一些您可能会后悔的事情。

为了将数据发送到客户端，您可能希望省略某些数据，您可以使用单独的、断开连接的实体 POJO，或使用 org.json 中的 JSONObject。

当从客户端向服务器发送数据时，您的前端实体对象从模型数据库层接收部分或全部数据，因为您并不关心前端是否获取部分数据。但是，当在数据存储中存储数据时，您将首先从数据存储中获取已存储的对象，更新其属性，然后将其存储回数据存储中。换句话说，如果您缺少演员，那也没关系，因为您从数据存储更新的对象已经将演员分配给它的属性。**因此，您只需替换您明确打算替换的字段。**

虽然此设置会有更多的维护开销和复杂性，但您将获得一个强大的优势：Java 编译器将为*您提供支持！*它不会让您甚至倒霉的同事在代码中做任何可能危及数据存储中数据的事情。如果您尝试在模型层中动态创建实体，您将被迫使用构造函数，并被迫提供所有数据。如果您没有所有数据并且无法实例化对象，那么您需要传递空值（这应该向您发出危险信号）或首先从数据存储中获取该数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-03-18T13:18:19.327

我遇到了这个问题，真的很想继续使用@JsonIgnore，但也使用实体/POJO 在 JSON 调用中使用。

经过大量挖掘后，我想出了在每次调用对象映射器时自动从数据库中检索被忽略字段的解决方案。

当然，此解决方案需要一些要求。就像您必须使用存储库一样，但在我的情况下，这正是我需要的方式。

为此，您需要确保 MappingJackson2HttpMessageConverter 中的 ObjectMapper 被截获，并且标有 @JsonIgnore 的字段已填充。因此我们需要我们自己的 MappingJackson2HttpMessageConverter bean：

```
 ```
public class MvcConfig extends WebMvcConfigurerAdapter {
    @Override
    public void extendMessageConverters(List<HttpMessageConverter<?>> converters) {
        for (HttpMessageConverter converter : converters) {
            if (converter instanceof MappingJackson2HttpMessageConverter) {
                ((MappingJackson2HttpMessageConverter)converter).setObjectMapper(objectMapper());
            }
        }
    }

    @Bean
    public ObjectMapper objectMapper() {
        ObjectMapper objectMapper = new FillIgnoredFieldsObjectMapper();
        Jackson2ObjectMapperBuilder.json().configure(objectMapper);

        return objectMapper;
    }
} 
``` 每个 JSON 请求都由我们自己的 objectMapper 转换为一个对象，它通过从存储库中检索忽略的字段来填充它们：

```
 /**
     * Created by Sander Agricola on 18-3-2015.
     *
     * When fields or setters are marked as @JsonIgnore, the field is not read from the JSON and thus left empty in the object
     * When the object is a persisted entity it might get stored without these fields and overwriting the properties
     * which where set in previous calls.
     *
     * To overcome this property entities with ignored fields are detected. The same object is than retrieved from the
     * repository and all ignored fields are copied from the database object to the new object.
     */
    @Component
    public class FillIgnoredFieldsObjectMapper extends ObjectMapper {
        final static Logger logger = LoggerFactory.getLogger(FillIgnoredFieldsObjectMapper.class);

        @Autowired
        ListableBeanFactory listableBeanFactory;

        @Override
        protected Object _readValue(DeserializationConfig cfg, JsonParser jp, JavaType valueType) throws IOException, JsonParseException, JsonMappingException {
            Object result = super._readValue(cfg, jp, valueType);
            fillIgnoredFields(result);

            return result;
        }

        @Override
        protected Object _readMapAndClose(JsonParser jp, JavaType valueType) throws IOException, JsonParseException, JsonMappingException {
            Object result = super._readMapAndClose(jp, valueType);
            fillIgnoredFields(result);

            return result;
        }

        /**
         * Find all ignored fields in the object, and fill them with the value as it is in the database
         * @param resultObject Object as it was deserialized from the JSON values
         */
        public void fillIgnoredFields(Object resultObject) {
            Class c = resultObject.getClass();
            if (!objectIsPersistedEntity(c)) {
                return;
            }

            List ignoredFields = findIgnoredFields(c);
            if (ignoredFields.isEmpty()) {
                return;
            }

            Field idField = findIdField(c);
            if (idField == null || getValue(resultObject, idField) == null) {
                return;
            }

            CrudRepository repository = findRepositoryForClass(c);
            if (repository == null) {
                return;
            }

            //All lights are green: fill the ignored fields with the persisted values
            fillIgnoredFields(resultObject, ignoredFields, idField, repository);
        }

        /**
         * Fill the ignored fields with the persisted values
         *
         * @param object Object as it was deserialized from the JSON values
         * @param ignoredFields List with fields which are marked as JsonIgnore
         * @param idField The id field of the entity
         * @param repository The repository for the entity
         */
        private void fillIgnoredFields(Object object, List ignoredFields, Field idField, CrudRepository repository) {
            logger.debug("Object {} contains fields with @JsonIgnore annotations, retrieving their value from database", object.getClass().getName());

            try {
                Object storedObject = getStoredObject(getValue(object, idField), repository);
                if (storedObject == null) {
                    return;
                }

                for (Field field : ignoredFields) {
                    field.set(object, getValue(storedObject, field));
                }
            } catch (IllegalAccessException e) {
                logger.error("Unable to fill ignored fields", e);
            }
        }

        /**
         * Get the persisted object from database.
         *
         * @param id The id of the object (most of the time an int or string)
         * @param repository The The repository for the entity
         * @return The object as it is in the database
         * @throws IllegalAccessException
         */
        @SuppressWarnings("unchecked")
        private Object getStoredObject(Object id, CrudRepository repository) throws IllegalAccessException {
            return repository.findOne((Serializable)id);
        }

        /**
         * Get the value of a field for an object
         *
         * @param object Object with values
         * @param field The field we want to retrieve
         * @return The value of the field in the object
         */
        private Object getValue(Object object, Field field) {
            try {
                field.setAccessible(true);
                return field.get(object);
            } catch (IllegalAccessException e) {
                logger.error("Unable to access field value", e);
                return null;
            }
        }

        /**
         * Test if the object is a persisted entity
         * @param c The class of the object
         * @return true when it has an @Entity annotation
         */
        private boolean objectIsPersistedEntity(Class c) {
            return c.isAnnotationPresent(Entity.class);
        }

        /**
         * Find the right repository for the class. Needed to retrieve the persisted object from database
         *
         * @param c The class of the object
         * @return The (Crud)repository for the class.
         */
        private CrudRepository findRepositoryForClass(Class c) {
            return (CrudRepository)new Repositories(listableBeanFactory).getRepositoryFor(c);
        }

        /**
         * Find the Id field of the object, the Id field is the field with the @Id annotation
         *
         * @param c The class of the object
         * @return the id field
         */
        private Field findIdField(Class c) {
            for (Field field : c.getDeclaredFields()) {
                if (field.isAnnotationPresent(Id.class)) {
                    return field;
                }
            }

            return null;
        }

        /**
         * Find a list of all fields which are ignored by json.
         * In some cases the field itself is not ignored, but the setter is. In this case this field is also returned.
         *
         * @param c The class of the object
         * @return List with ignored fields
         */
        private List findIgnoredFields(Class c) {
            List ignoredFields = new ArrayList();
            for (Field field : c.getDeclaredFields()) {
                //Test if the field is ignored, or the setter is ignored.
                //When the field is ignored it might be overridden by the setter (by adding @JsonProperty to the setter)
                if (fieldIsIgnored(field) ? setterDoesNotOverrideIgnore(field) : setterIsIgnored(field)) {
                    ignoredFields.add(field);
                }
            }
            return ignoredFields;
        }

        /**
         * @param field The field we want to retrieve
         * @return True when the field is ignored by json
         */
        private boolean fieldIsIgnored(Field field) {
            return field.isAnnotationPresent(JsonIgnore.class);
        }

        /**
         * @param field The field we want to retrieve
         * @return true when the setter is ignored by json
         */
        private boolean setterIsIgnored(Field field) {
            return annotationPresentAtSetter(field, JsonIgnore.class);
        }

        /**
         * @param field The field we want to retrieve
         * @return true when the setter is NOT ignored by json, overriding the property of the field.
         */
        private boolean setterDoesNotOverrideIgnore(Field field) {
            return !annotationPresentAtSetter(field, JsonProperty.class);
        }

        /**
         * Test if an annotation is present at the setter of a field.
         *
         * @param field The field we want to retrieve
         * @param annotation The annotation looking for
         * @return true when the annotation is present
         */
        private boolean annotationPresentAtSetter(Field field, Class annotation) {
            try {
                Method setter = getSetterForField(field);
                return setter.isAnnotationPresent(annotation);
            } catch (NoSuchMethodException e) {
                return false;
            }
        }

        /**
         * Get the setter for the field. The setter is found based on the name with "set" in front of it.
         * The type of the field must be the only parameter for the method
         *
         * @param field The field we want to retrieve
         * @return Setter for the field
         * @throws NoSuchMethodException
         */
        @SuppressWarnings("unchecked")
        private Method getSetterForField(Field field) throws NoSuchMethodException {
            Class c = field.getDeclaringClass();
            return c.getDeclaredMethod(getSetterName(field.getName()), field.getType());
        }

        /**
         * Build the setter name for a fieldName.
         * The Setter name is the name of the field with "set" in front of it. The first character of the field
         * is set to uppercase;
         *
         * @param fieldName The name of the field
         * @return The name of the setter
         */
        private String getSetterName(String fieldName) {
            return String.format("set%C%s", fieldName.charAt(0), fieldName.substring(1));
        }
    } 
```

在所有情况下，也许不是最干净的解决方案，但在我的情况下，它可以按照我希望它工作的方式来解决问题。

```

# delphi - Delphi标签地址

> ID：10739318
> 
> 赞同：2
> 
> 时间：2012-05-24T14:18:32.213
> 
> 标签：delphi, delphi-2010

我正在使用 Delphi pascal 进行简单的 PIC18 MCPU 助记符模拟。是的，我打算使用 Delphi IDE。我可以模拟任何 asm 指令，但它停在标签处。在某些情况下，我需要知道 Delphi 标签的地址。是否有可能将标签转换为指针变量？

就像我的例子一样？

```
procedure addlw(const n:byte); //emulation of mcpu addlw instruction
begin
  Carry := (wreg + n) >= 256;
  wreg := wreg + n;
  Zero := wreg = 0;
  inc(CpuCycles);
end;

procedure bnc(p: pointer ); //emulation of mcpu bnc instruction
asm
  inc   CpuCycles
  cmp   byte ptr Carry, 0
  jnz   @exit
  pop   eax     //restore return addres from stack
  jmp   p
@exit:
end; 
```

//模拟MCPU ASM代码

```
procedure Test;
label
  Top;
var
  p: pointer;
begin
//
Top:
  addlw(5);  //emulated  mcpu addlw instruction
  bnc(Top);  //emulated  mcpu bnc branch if not carry instruction
//
end; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-24T19:06:27.770

不，您不能以这种方式与标签进行交互。由于您正在*模拟*其他所有内容，因此您也可以模拟汇编器标签，而不是试图强迫 Delphi 标签做它们不适合做的事情。

假设您可以使用这样的代码而不是您编写的“汇编程序”代码（现在不用担心如何实现它）：

```
procedure Test;
var
  Top: TAsmLabel;
begin
//
DefineLabel(Top);
  addlw(5);  //emulated  mcpu addlw instruction
  bnc(Top);  //emulated  mcpu bnc branch if not carry instruction
//
end; 
```

我认为语法看起来很相似。运行该代码后，您需要`Top`参考下一条指令，即调用`addlw`.

在假设的函数内部`DefineLabel`，该地址对应于*返回地址*，因此写入`DefineLabel`将其返回地址存储在给定参数中：

```
type
  TAsmLabel = Pointer;

procedure DefineLabel(out Result: TAsmLabel);
asm
  mov ecx, [esp]  // copy return address
  mov [eax], ecx  // store result
end; 
```

* * *

请注意，此代码会破坏堆栈。您的`bcn`函数将其返回地址留在堆栈上，因此当最终设置进位标志时，您在堆栈上留下了先前返回地址的痕迹。如果您没有首先获得堆栈溢出，那么当您到达包含函数的末尾时，您会遇到奇怪的结果。它会尝试返回，但不会去找调用者，而是会找到`bnc`' 的返回地址，然后跳回到你的代码中间。这一切都假设代码中没有任何其他堆栈相对引用。如果有，那么即使*调用* `bnc(Top)`也可能会出现问题，因为 的相对位置`Top`已经改变，你最终会从堆栈中读取错误的值。

# java - 使用 j_security_check 进行身份验证，但不使用授权（在 Websphere 中）

> ID：10739319
> 
> 赞同：1
> 
> 时间：2012-05-24T14:18:32.870
> 
> 标签：java, security, jakarta-ee, websphere

有没有办法强制我的 Java EE 应用程序使用 j_security_check 进行身份验证，而不是授权？我想通过独立 LDAP 存储库进行身份验证，但我想在我的应用程序中进行编程授权。

具体来说，我不想在 Websphere Application Server 管理控制台中围绕授权（用户角色映射到组）进行任何配置。

例如：

1.  用户使用正确的“user1”和密码“password1”登录
2.  Websphere 在 LDAP 中找到此人，知道他们就是他们所说的人（身份验证）
3.  我从文件系统上的文件中检查此用户是否被授权（授权）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T16:56:54.753

我建议为此使用 Spring Security。我们已经在 WebSphere 中实现了这种精确的模式。诀窍是使用 Spring Security 提供的预认证机制，然后在配置中只定义授权规则。

```
<http>
  <session-management session-fixation-protection="none"/>
  <custom-filter position="PRE_AUTH_FILTER" ref="preAuthenticationFilter"/>
  <intercept-url pattern="/j_security_check" filters="none"/>
  <intercept-url pattern="/ibm_security_logout" filters="none"/>
  <!-- put authorization intercept-url elements here... -->
</http> 
```

您还必须定义一些其他 bean，例如预身份验证过滤器和自定义入口点，但这在此处记录：http: [//static.springsource.org/spring-security/site/docs/3.0.x/参考/preauth.html](http://static.springsource.org/spring-security/site/docs/3.0.x/reference/preauth.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T16:22:49.607

看看 Spring 安全性。身份验证和授权的概念是分开的。

身份验证由一个`AuthenticationProvider`（[`LdapAuthenticationProvider`](http://static.springsource.org/spring-security/site/docs/3.0.x/apidocs/org/springframework/security/ldap/authentication/LdapAuthenticationProvider.html)实现是spring的一部分）处理。身份验证提供者委托获取用户的详细信息，其中包括`GrantedAuthority`可以代表用户权限的对象列表。

`LdapAuthenticationProvider`默认情况下会尝试从目录中获得授权，因此您需要提供自己的`LdapAuthoritiesPopulator`实现，该实现从文件系统加载。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-24T16:33:10.570

Java EE Security 也可以拆分。但是，这取决于您的容器的实现。既然你提到了 websphere ，[这个文档](http://www.ibm.com/developerworks/websphere/techjournal/0508_benantar/0508_benantar.html)可能会很有趣。

# drag-and-drop - 使用 Ember.js 拖放

> ID：10739322
> 
> 赞同：10
> 
> 时间：2012-05-24T14:18:48.783
> 
> 标签：drag-and-drop, ember.js

有没有关于如何使用 Ember.js 实现拖放的示例？我曾尝试使用 jQuery UI，但集成似乎有些复杂。

我已经看到了这个 jsFiddle： http: [//jsfiddle.net/oskbor/Wu2cu/1/](http://jsfiddle.net/oskbor/Wu2cu/1/)但无法在我自己的应用程序中成功实现它。

使用 Ember.js 的相当简单的拖放实现有哪些选项？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-05-24T16:18:47.423

我查看了 Remy Sharp 的[帖子](http://html5doctor.com/native-drag-and-drop/)并在 Ember.js 中实现了一个基本示例，请参阅[http://jsfiddle.net/pangratz666/DYnNH/](http://jsfiddle.net/pangratz666/DYnNH/)。

**车把**：

```
<script type="text/x-handlebars" >
    Drag and drop the green and red box onto the blue one ...

    {{view App.Box class="box green"}}
    {{view App.Box class="box red"}}

    {{view App.DropTarget class="box blue"}}
</script>​ 
```

**JavaScript**：

```
DragNDrop = Ember.Namespace.create();

DragNDrop.cancel = function(event) {
    event.preventDefault();
    return false;
};

DragNDrop.Dragable = Ember.Mixin.create({
    attributeBindings: 'draggable',
    draggable: 'true',
    dragStart: function(event) {
        var dataTransfer = event.originalEvent.dataTransfer;
        dataTransfer.setData('Text', this.get('elementId'));
    }
});

DragNDrop.Droppable = Ember.Mixin.create({
    dragEnter: DragNDrop.cancel,
    dragOver: DragNDrop.cancel,
    drop: function(event) {
        var viewId = event.originalEvent.dataTransfer.getData('Text');
        Ember.View.views[viewId].destroy();        
        event.preventDefault();
        return false;
    }
});

App.Box = Ember.View.extend(DragNDrop.Dragable);
App.DropTarget = Ember.View.extend(DragNDrop.Droppable);​ 
```

# c++ - Windows 中的动态库链接问题

> ID：10739323
> 
> 赞同：0
> 
> 时间：2012-05-24T14:18:49.993
> 
> 标签：c++, linker, qt4, dllexport

我对 Windows 动态库有疑问。我使用 Qt/C++ 在 Linux 中编写了一个共享的小部件库。一切正常，我可以将每个应用程序链接到我的库。但是在 Windows 中同样的代码可以编译，但是任何应用程序都不能使用它。我收到了很多类型的链接器错误，`undefined reference to ...`这些错误都在库中实现。

我发现在 Windows 中，默认情况下，代码的符号表不会导出为二进制。我必须指定我希望在最终 dll 中可见的函数。但我无法设法找到这样做的方法。

按照[此](http://qt-project.org/doc/qt-4.8/sharedlibrary.html)说明，我添加`Q_DECL_EXPORT`到所有类声明中。但这对我不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T14:20:03.743

您应该添加`MYSHAREDLIB_EXPORT`到您的类声明中，而不是`Q_DECL_EXPORT`. 同样来自您提供的链接，您可以相应地定义。

如果添加`Q_DECL_EXPORT`，则告诉编译器在包含标头的每个模块中为该类生成代码，而不是期望该类被导出到另一个库中。

# objective-c - MapKit：跟踪路线

> ID：10739325
> 
> 赞同：1
> 
> 时间：2012-05-24T14:18:54.070
> 
> 标签：objective-c, xcode, mapkit

我有一个带有当前位置的 MapKit 和一个 MkPointAnnotation。我需要追踪这些点之间的路线。

```
- (void)viewDidLoad
{
    [super viewDidLoad];

    //esconder navBar
    [[self navigationController] setNavigationBarHidden:YES animated:NO];

    mapView.showsUserLocation = YES;
    UIBarButtonItem *zoomButton = [[UIBarButtonItem alloc] 
                                   initWithTitle: @"Onde Estou?"
                                   style:UIBarButtonItemStylePlain
                                   target: self
                                   action:@selector(zoomIn:)];

    self.navigationItem.rightBarButtonItem = zoomButton;

    UIBarButtonItem *typeButton = [[UIBarButtonItem alloc] 
                                   initWithTitle: @"Tipo"
                                   style:UIBarButtonItemStylePlain
                                   target: self
                                   action:@selector(changeMapType:)];

    self.navigationItem.leftBarButtonItem = typeButton;

    double lat = -21.21258;
    double lng = -47.816802;

    CLLocationCoordinate2D Coordinate;

    Coordinate.latitude = lat;
    Coordinate.longitude = lng;

    MKPointAnnotation *annotationPoint = [[MKPointAnnotation alloc] init];
    annotationPoint.coordinate = Coordinate;
    annotationPoint.title = @"Ribeirão Shopping";
    annotationPoint.subtitle = @"Ribeirão Preto - SP";
    [self.mapView addAnnotation:annotationPoint]; 

    MKCoordinateRegion newRegion;
    newRegion.center.latitude = lat;
    newRegion.center.longitude = lng;
    [self.mapView setRegion:newRegion animated:YES];

    mapView.mapType = MKMapTypeStandard;

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-16T20:01:22.037

这对于本机 API 是不可能的，您可以使用 - 通过 JSON - [Google Directions提供的 HTTP 服务](https://developers.google.com/maps/documentation/directions/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-01-28T01:35:00.667

使用 MKDirectionReqeuest 和 MKDriectionResponse。MKDirectionResponse 有 MKRoute 可以帮助您绘制线。

可以在此处找到文档（[https://developer.apple.com/library/ios/documentation/MapKit/Reference/MKDirectionsRequest_class/](https://developer.apple.com/library/ios/documentation/MapKit/Reference/MKDirectionsRequest_class/)）

# java - 使用 Spring 依赖注入部署 CXF 服务端点

> ID：10739329
> 
> 赞同：0
> 
> 时间：2012-05-24T14:19:16.827
> 
> 标签：java, web-services, spring, soap, cxf

我正在尝试将 spring bean 注入使用 @WebService 和 @SOAPBinding 注释的类中。

```
@WebService(targetNamespace = JAXWSMessageHandler.MY_URL)
@SOAPBinding(parameterStyle = SOAPBinding.ParameterStyle.BARE)
public class JAXWSMessageHandler {

    private StorageManager bufferContainer;

    public void setBufferContainer(StorageManager storageManager){
        this.bufferContainer = storageManager;

    } 
```

我得到以下异常：

```
Service class soap.service.JAXWSMessageHandler method setBufferContainer part {http://myurl/myproject/v1}setBufferContainer cannot be mapped to schema. Check for use of a JAX-WS-specific type without the JAX-WS service factory bean. 
```

看来spring使用的操作应该是CXF在WSDL中定义的。我想我可以使用允许从 WebService 类到我的业务类的通信的单例中介类来破解它，但是，这对我来说听起来不太好，我想正确地做到这一点。任何提示如何做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T14:36:53.573

JAX-WS 将注释类上的方法签名解释为 Web 服务操作。我的猜测是，如果您使用构造函数注入（而不是 setter 注入），问题就会消失。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-22T14:57:50.887

我想我有一个更好的解决方案：

大概您正在使用@WebMethod 来注释要在 Web 服务上公开的方法？

好吧，您还可以向您的 setter 方法添加 @WebMethod 注释，并将属性“排除”设置为 true。这意味着该方法将不会在您的 wsdl 中定义。

```
@WebService(targetNamespace = JAXWSMessageHandler.MY_URL)
@SOAPBinding(parameterStyle = SOAPBinding.ParameterStyle.BARE)
public class JAXWSMessageHandler {

private StorageManager bufferContainer;

@WebMethod(exclude=true)
public void setBufferContainer(StorageManager storageManager){
    this.bufferContainer = storageManager;

} 
```

# c++ - 从核心转储中获取创建时间

> ID：10739334
> 
> 赞同：4
> 
> 时间：2012-05-24T14:19:30.170
> 
> 标签：c++, unix, solaris, core, coredump

我正在开发一个 C++ 应用程序。我从客户那里得到了一些他说现在生成的核心文件，但不愿意说它们是如何生成的以及他从生成它们中做了什么。

我怀疑他错了，可能是他给了我很久以前生成的转储。

有什么方法可以获取文件的实际创建时间？

我怀疑这些文件可能是在其他一些服务器上创建的，他已经转移了它们。任何人请帮忙。

如果它不在核心文件中，可能是 Unix 有办法知道文件在当前服务器或其他服务器中的实际创建时间。

请帮忙。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-25T12:44:54.200

核心文件的创建时间不会`core(4)`以 Solaris 中的格式显示。

但是，您可以通过查看`NOTES`核心部分来做一些事情（自由来救援？）。详情请参阅`core(4)`。

首先找到`NOTES`段名称（可能`note0`或（更有可能）`note1`，没有前导点）`objdump -x core`

### 进程开始时间

该`NT_PSINFO`条目包含一个`psinfo_t`(see `<sys/procfs.h>`) ，它有一个成员`pr_start`。这是该过程的开始时间。

### 区域名称

同样，生成核心的区域名称也在`NT_ZONENAME`条目中。

由于这是`char *`一种快速而肮脏的方法，无需解析段，只需转储'n'grep它：

```
objdump -s -j note1 core | grep ... 
```

（`elfdump -n...`听起来很有用，但我无法让它工作）。

# iphone - 确定选择了哪个 MKPinAnnotationView？

> ID：10739335
> 
> 赞同：0
> 
> 时间：2012-05-24T14:19:35.460
> 
> 标签：iphone, objective-c, mkmapview, mkannotation, mapkit

我在地图上放置了一些自定义的 MKPinAnnotationView，其中包含有关地标的不同信息（名称、描述、图像、附件按钮）。当用户单击并打开其中一个引脚，然后单击其中的附件按钮时，我想知道用户单击了哪些引脚，以便我可以加载具有更详细信息的视图控制器。

我找到了这些方法：

```
- (void)mapView:(MKMapView *)mapView annotationView:(MKAnnotationView *)view calloutAccessoryControlTapped:(UIControl *)control
{
}

- (void)mapView:(MKMapView *)mapView didSelectAnnotationView:(MKAnnotationView *)view   
{
} 
```

...但是我怎么知道选择了哪个引脚？我想做类似的事情：

```
 - (void)mapView:(MKMapView *)mapView didSelectAnnotationView:(MKAnnotationView *)view   
    {
        //Example
        if ([view.description isEqualToString: @"Golden Gate"])
        {
             //Load golden gate information in a new viewcontroller
        }
    } 
```

...但是 view.description 不会给我正确的信息。

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T14:33:05.963

如果您将名称/描述存储在您的`title`/中，则只需访问以下属性即可访问这些信息：`subtitle``MKAnnotationView`[`annotation`](http://developer.apple.com/library/ios/#documentation/MapKit/Reference/MKAnnotationView_Class/Reference/Reference.html#//apple_ref/occ/instp/MKAnnotationView/annotation)`MKAnnotationView`

```
if ([view.annotation.title isEqualToString: @"Golden Gate"])
   {
         //Load golden gate information in a new viewcontroller
   } 
```

# objective-c - 如何安装 XCode 4？

> ID：10739336
> 
> 赞同：1
> 
> 时间：2012-05-24T14:19:47.980
> 
> 标签：objective-c, macos, cocoa-touch, xcode4, osx-lion

> **可能重复：**
> [Xcode 4.1 GM 未在 Lion 上安装（必须退出 iTunes）？](https://stackoverflow.com/questions/6740197/xcode-4-1-gm-not-installing-must-quit-itunes-on-lion)

我已经从 App(le) 商店下载了 XCode 4 并开始安装。大约后。安装过程的 3/4，安装警报告诉关闭 iTunes。但是 iTunes 没有运行，并且在安装新的（！）OS X 10.7 之后我从未运行过。单击此警报中的缩放图标时，它会打开 iTunes。关闭它不会改变任何东西 - 安装不会继续。重新启动也无济于事。我还能尝试什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T14:22:47.627

打开一个终端。

成为根

```
su 
```

定位进程

```
ps ax | grep tunes 
```

用它的 id 杀死进程

```
kill -9 <id> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T14:23:37.883

这是（是？）一个已知问题。打开终端并尝试以下操作：

```
killall iTunesHelper 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-24T14:24:56.730

How are you closing iTunes? Are you just clicking the red X in the corner? This does not actually close the application on OS X, you have to go to the menu bar, click on iTunes, then click on Quit (or just hit Command-Q with iTunes in focus). Hope this helps.

# image - Joomla 在哪里存储文章图像？

> ID：10739337
> 
> 赞同：2
> 
> 时间：2012-05-24T14:19:58.797
> 
> 标签：image, joomla, directory, directory-structure

我可以在 Joomla 目录的哪个位置找到存储在文章中的图像？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T14:19:59.093

默认情况下，上传的图像存储在 %root%/images 目录中，但是，图像可能存储在 images 文件夹的子目录中。本机编辑器和 Joomla 内容编辑器（JCE，Joomla 的常用编辑器！）只允许您将图像文件夹和子文件夹中的图像插入到文章中。通过直接编辑`img`文章代码中的标签，可以在 %root% 文件夹中的其他位置插入图像，但这不是最佳做法。

*如果使用 FTP，%root% 可能是 /public_HTML/。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-12-01T08:57:05.497

在 joomla 站点中搜索所有文件后非常简单。我的客户在他的旧站点使用 k2 文章，我以前从未使用过 joomla。所以，所有图像都存储在 k2/items/cache/filename.jpg，这个文件名.jpg 是使用 md5("Image" . Post ID) 生成的。“_Extension.jpg”，其中 Post ID 是 int 1 例如，Extension 是图像大小（通用、XL、L、M 等）。对于 k2 文章，该库位于 components/mod_k2/helpers/item.php

# vbscript - 将纬度/经度转换为十进制度

> ID：10739339
> 
> 赞同：0
> 
> 时间：2012-05-24T14:20:00.233
> 
> 标签：vbscript, coordinate-systems, coordinate-transformation

我需要将一个带有纬度的大 txt 文件和一个带有经度的大 txt 文件转换为十进制度。

我拥有的数据是当前格式：

```
7d44'31.495"W for longitude 
```

和

```
41d3'40.313"N for latitude 
```

我需要将这两个文件都转换为十进制度（最好使用脚本）。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-25T21:56:13.270

对*itudes一无所知，我只能给你一个关于如何解决你的问题的大致思路：

**使用正则表达式从您的数据中删除数字并将它们提供给可信的公式**

为了让您对我的建议有信心，我向您展示了我将如何解决您任务的两个子问题。

**(1) 对输入字符串应用正则表达式并计算。**

基于本节

> 从 DMS 到十进制度的转换
> 
> 给定一个 DMS（度、分、秒）坐标，例如 W87°43'41"，使用以下方法将其转换为十进制度数：
> 
> ```
> Calculate the total number of seconds:
> 43'41" = (43*60 + 41) = 2621 seconds.
> The fractional part is total number of seconds divided by 3600:
> 2621 / 3600 = ~0.728056
> Add fractional degrees to whole degrees to produce the final result:
> 87 + 0.728056 = 87.728056
> Since it is a West longitude coordinate, negate the result.
> The final result is -87.728056. 
> ```

在[这里找到](http://en.wikipedia.org/wiki/Geographic_coordinate_conversion)

代码：

```
 Dim oFmt   : Set oFmt = New cFormat
  Dim oRE    : Set oRE  = New RegExp
  '                 0    1     2     3
  oRE.Pattern = "^([W])(\d+)°(\d+)'(\d+)""$"
  Dim aTests : aTests   = Array( _
      Array("W87°43'41""", -87.728056) _
  )
  Dim aTest
  For Each aTest In aTests
      Dim sInp : sInp     = aTest(0)
      Dim nExp : nExp     = aTest(1)
      Dim oMTS : Set oMTS = oRE.Execute(sInp)
      Dim sMsg
      If 1 <> oMTS.Count Then
         sMsg = oFmt.formatTwo("|{0}| didn't match /{1}/", sInp, oRE.Pattern)
      Else
         Dim sLoLa    : sLoLa    =      oMTS(0).SubMatches(0)
         Dim nDegrees : nDegrees = CDbl(oMTS(0).SubMatches(1))
         Dim nMinutes : nMinutes = CDbl(oMTS(0).SubMatches(2))
         Dim nSeconds : nSeconds = CDbl(oMTS(0).SubMatches(3))
         Dim nRes

'        Calculate the total number of seconds:
'        43'41" = (43*60 + 41) = 2621 seconds.
         nRes = nMinutes * 60 + nSeconds
'        WScript.Echo "***", nRes

'        The fractional part is total number of seconds divided by 3600:
'        2621 / 3600 = ~0.728056
         nRes = nRes / 3600
'        WScript.Echo "***", nRes

'        Add fractional degrees to whole degrees to produce the final result:
'        87 + 0.728056 = 87.728056
         nRes = nDegrees + nRes
'        WScript.Echo "***", nRes

'        Since it is a West longitude coordinate, negate the result.
'        The final result is -87.728056.
         Select Case sLoLa
           Case "W"
             nRes = -nRes
         End Select

         sMsg = oFmt.formatArray(_
              "{0,-12}: R: {1,12:N6} E: {2,12:N6} D: {3,12:N6}" _
            , Array(sInp, nRes, nExp, nRes - nExp) _
         )
      End If
      WScript.Echo sMsg
  Next 
```

输出：

```
Step00 - conversion a la wikipedia
================================================================
W87°43'41"  : R:   -87,728056 E:   -87,728056 D:     0,000000
================================================================
xpl.vbs: Erfolgreich beendet. (0) [0.08594 secs] 
```

从输入样本开始，我推导出（第一次尝试）正则表达式模式

```
 "   W   87  ° 43  ' 41  "" "
  '                 0    1     2     3
  oRE.Pattern = "^([W])(\d+)°(\d+)'(\d+)""$" 
```

对于您的数据，类似这样

```
 "   7  d 44  ' 31.495   ""  W    "
                "  41  d  3  ' 40.313   ""  N    "
  '                 0     1        2        3
  oRE.Pattern = "^(\d+)d(\d+)'(\d+\.\d+)""([WN])$" 
```

可能是合适的。

为了获取 RegExps 组 ()s 捕获的部分，我访问并转换匹配的子匹配

```
 Dim sLoLa    : sLoLa    =      oMTS(0).SubMatches(0)
 Dim nDegrees : nDegrees = CDbl(oMTS(0).SubMatches(1))
 Dim nMinutes : nMinutes = CDbl(oMTS(0).SubMatches(2))
 Dim nSeconds : nSeconds = CDbl(oMTS(0).SubMatches(3)) 
```

然后它只是根据从维基百科窃取的算法/公式进行计算（参见代码/评论）。

**(2) 从文件中获取数据**

如果文件不是很大，您可以将它们 .ReadAll() 放入内存并在多行模式下应用正则表达式：

```
 Dim oFmt : Set oFmt = New cFormat

  Dim oRE  : Set oRE  = New RegExp
  oRE.Global    = True
  oRE.Multiline = True
  '                 0     1        2        3
  oRE.Pattern = "^(\d+)d(\d+)'(\d+\.\d+)""([WN])$"

  Dim sAll : sAll = goFS.OpenTextFile("..\data\f00.txt").ReadAll()
  WScript.Echo sAll

  WScript.Echo oFmt.formatArray( _
      "|{0,-5}|{1,-11}|{2,-11}|{3,-15}|" _
    , Array("LoLa", "Degrees", "Minutes", "Seconds") _
  )

  Dim oMTS : Set oMTS = oRE.Execute(sAll)
  Dim oMT
  For Each oMT In oMTS
      Dim sLoLa    : sLoLa    =      oMT.SubMatches(3)
      Dim nDegrees : nDegrees = CDbl(oMT.SubMatches(0))
      Dim nMinutes : nMinutes = CDbl(oMT.SubMatches(1))
      Dim nSeconds : nSeconds = CDbl(oMT.SubMatches(2))

      WScript.Echo oFmt.formatArray( _
          "|{0,-5}|{1,11:N2}|{2,11:N2}|{3,15:N6}|" _
        , Array(sLoLa, nDegrees, nMinutes, nSeconds) _
      )
  Next 
```

输出：

```
======================================================
7d44'31.495"W
41d3'40.313"N

|LoLa |Degrees    |Minutes    |Seconds        |
|W    |       7,00|      44,00|      31,495000|
|N    |      41,00|       3,00|      40,313000|
====================================================== 
```

[从这里](https://stackoverflow.com/questions/10614633/dateadd-in-special-format/10616669#10616669)获取 cFormat 类

# objective-c - 在 UIToolBar 上添加按钮（通过代码）

> ID：10739345
> 
> 赞同：1
> 
> 时间：2012-05-24T14:20:19.603
> 
> 标签：objective-c, xcode4

如何通过按钮上的代码添加到我拥有该属性的工具栏？

```
@property (strong, nonatomic) IBOutlet UIToolbar *toolB; 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-24T14:37:00.093

```
UIBarButtonItem *buttonOne = [[UIBarButtonItem alloc] initWithTitle:@"Button One" style:UIBarButtonItemStyleBordered target:self action:@selector(action)];

UIBarButtonItem *buttonTwo = [[UIBarButtonItem alloc] initWithTitle:@"Button Two" style:UIBarButtonItemStyleBordered target:self action:@selector(action)];

NSArray *buttons = [NSArray arrayWithObjects: buttonOne, buttonTwo, nil];
[toolBar setItems: buttons animated:NO]; 
```

如果我正确理解你的要求，就会成功。`action`是您希望按钮调用的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T14:41:27.817

这可能会对您有所帮助，不要忘记释放按钮。

```
UIToolbar *actionToolbar = [[UIToolbar alloc] initWithFrame:CGRectMake(0, 416, 320, 44)];
UIBarButtonItem *actionButton =
    [[[UIBarButtonItem alloc]
        initWithTitle:@"No Action"
        style:UIBarButtonItemStyleBordered
        target:self
        action:@selector(noAction:)]
    autorelease];
[actionToolbar setItems:[NSArray arrayWithObject:actionButton]]; 
```

UIToolbar 没有侧边按钮，您可以使用 UINavigationBar 或点击此链接

[对齐 UIToolBar 项](https://stackoverflow.com/questions/602717/aligning-uitoolbar-items)

# javascript - 浏览器中如何实现squeezeback？

> ID：10739347
> 
> 赞同：0
> 
> 时间：2012-05-24T14:20:26.903
> 
> 标签：javascript, html, video

我有兴趣在我的网页中的视频中添加[挤压。](http://www.althos.com/tutorial/TV-advertising-tutorial-squeeze-back-squeezeback.html)

有没有一种简单的方法可以做到这一点，而无需在视频本身中实现它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T14:26:43.407

那将是重叠的绝对div：

```
<div id="container">
    <div id="background">contents here</div>
    <div id="videoWrapper">
        <video></video>
    </div>
</div>

#container{
    position:relative;
}

#container > *{
    position:absolute; /*to allow stacking*/
    top: 0;            /*stretch to container*/
    bottom:0;
    left: 0;
    right: 0
} 
```

然后，要缩放视频，请查看[这篇](http://scratchpaper.tk/blog/preserve-an-html-elements-aspect-ratio/)关于“缩放”元素并保留纵横比的帖子。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T14:25:35.627

将视频放在带有 id 的 div 中。使用 jquery 更改视频元素的大小（可能使用 %s）。在视频元素（.appendElement()）之后添加一个元素到 div 用另一个东西填充它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-24T14:26:14.107

`<video>`是一个 HTML 元素，就像任何其他元素一样，所以你可以使用 CSS 和 javascript 来调整它的大小，在它周围和上面放置其他元素，等等。

我可能会将视频放在相对定位的 div 中。在适当的时候，使用一些脚本相应地缩放视频，然后引入更多绝对位于其上方/下方/旁边的元素。世界是你的牡蛎，试一试，然后回来报告！

考虑一下，Mozilla 的[Popcorn.js](http://popcornjs.org/)可能会对这类事情有所帮助。

# google-apps-script - 每天需要脚本授权

> ID：10739350
> 
> 赞同：1
> 
> 时间：2012-05-24T14:20:30.510
> 
> 标签：google-apps-script

我有一个谷歌网站，上面有 16 个不同的脚本（每个页面一个）。每个脚本都会打印来自 Google Drive 的文件夹/文档列表。我在每个脚本上都有一个触发器，每天运行一次，但是我每天都会收到电子邮件，要求脚本运行需要授权，即使我每天都进入并批准每个单独的脚本。这种情况至少持续了一个月。

我尝试更改触发器触发的时间以及删除触发器然后重新添加它们。

我不知所措。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T14:37:01.863

我认为这是因为你有太多的脚本和触发器。

我不知道一个人可能拥有的确切数量，但假设它是 10。因此，当您授权第 11 个时，第一个授权被丢弃/忘记。

我搜索了[问题跟踪器](http://code.google.com/p/google-apps-script-issues/issues/list)并没有找到关于此的问题报告，也没有找到旧论坛中确定具体金额的任何人。但我记得讨论过这个问题并得出关于这种重新授权行为的结论。很抱歉没有提供更多帮助，我想您应该打开问题报告和/或尝试自己验证此行为。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-04T02:19:09.430

> 为每个脚本设置 20 个触发器的限制。此限制自 2012 年 5 月 21 日起生效。对于在该日期之前创建的脚本，已经有超过 20 个触发器，它们将保留现有触发器，但不能在不删除现有触发器的情况下添加新触发器。

[https://developers.google.com/apps-script/release_notes](https://developers.google.com/apps-script/release_notes)

# jsf-2 - Myfaces 战斧不工作

> ID：10739352
> 
> 赞同：1
> 
> 时间：2012-05-24T14:20:32.643
> 
> 标签：jsf-2, myfaces, tomahawk

我正在尝试使用 tomahawk 的 selectManyCheckbox 但它不起作用，我在我的 Web 应用程序中收到此消息：

> 警告：页面 /resources/components/tabs/abaEdicaoFuncoesFuncionario.xhtml 声明命名空间[http://myfaces.apache.org/tomahawk](http://myfaces.apache.org/tomahawk)并使用标签 t:selectManyCheckbox ，但没有与命名空间关联的 TagLibrary。

![战斧消息](../Images/9b07c0dce75fc262b81d4d852036dff2.png)

我在这里使用 selectManyCheckbox：

```
<html xmlns="http://www.w3.org/1999/xhtml"
xmlns:ui="http://java.sun.com/jsf/facelets"
xmlns:h="http://java.sun.com/jsf/html"
xmlns:f="http://java.sun.com/jsf/core"
xmlns:t="http://myfaces.apache.org/tomahawk">
<ui:component>
<h:panelGroup layout="block" styleClass="hrgi-div-form clearfix tamanho-aba-cadastro">
    <t:selectManyCheckbox id="selectFuncoes" value="#{funcionario.funcoes}" layoutWidth="2">
        <f:selectItems value="#{carregadorFuncoesFuncionario.itens}" />
    </t:selectManyCheckbox>
</h:panelGroup>
</ui:component>
</html> 
```

并以这种方式配置 web.xml：

```
<filter>
    <filter-name>MyFacesExtensionsFilter</filter-name>
    <filter-class>org.apache.myfaces.webapp.filter.ExtensionsFilter</filter-class>
    <init-param>
        <param-name>uploadMaxFileSize</param-name>
        <param-value>20m</param-value>
    </init-param>
</filter>

<filter-mapping>
    <filter-name>MyFacesExtensionsFilter</filter-name>
    <servlet-name>Faces Servlet</servlet-name>
</filter-mapping>

<filter-mapping>
    <filter-name>MyFacesExtensionsFilter</filter-name>
    <url-pattern>/faces/myFacesExtensionResource/*</url-pattern>
</filter-mapping> 
```

我正在使用 Tomahawk 1.1.11、myfaces 2.1.6 和 primefaces 2.1.1 我该如何解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T14:43:00.060

确保您使用的是[“用于 JSF 2.0 的 Tomahawk”](http://myfaces.apache.org/tomahawk/download.html)（而不是用于 JSF 1.2），并且所有 Tomahawk JAR 文件都放置在`/WEB-INF/lib`文件夹中，并且服务器日志中没有出现与此相关的错误/警告。

# php - 如何检测用户是否登录 symfony？

> ID：10739355
> 
> 赞同：2
> 
> 时间：2012-05-24T14:20:42.773
> 
> 标签：php, symfony1, symfony-1.4, sfdoctrineguard

我需要知道如果 symfony 中的特定用户登录了应用程序，我该如何获取，有没有办法获取当前登录用户的会话 ID？

当我有一个名为的字段`is_online`并在用户登录和注销应用程序时设置它时，我尝试过使用表，所以当用户关闭浏览器或会话结束时出现问题，因此该字段`is_online`保持真实。这就是如果用户登录应用程序，我需要另一种方法来获取的原因。

任何建议都会很有用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-24T14:49:23.250

您可以从用户发送 ajax 请求，并且只要有人不发送请求，例如 1 分钟将他的状态更改为离线。将状态存储在一些键值存储（即 MemCache）中是个好主意。看这里了解[详情](https://stackoverflow.com/questions/5053388/check-what-users-are-online)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T15:32:03.010

在 ajax 中创建一个数据库字段`lastonlinetstamp`和一个`ping`方法，每分钟调用一个具有相同会话的服务。然后让 ping 服务更新`lastonlinetstamp`. 如果此值早于 1 分钟，您就知道该用户处于离线状态。但是：这会增加对您服务器的请求数量。

# msdn - MSDN 已关闭....有没有办法搜索其内容的缓存？

> ID：10739361
> 
> 赞同：4
> 
> 时间：2012-05-24T14:21:09.293
> 
> 标签：msdn

我无法访问 msdn.com，在 Twitter 上快速搜索#msdn 显示其他人看到了中断。有没有办法搜索 MSDN 内容的缓存？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T14:23:25.987

当然，在 Google ( `site:msdn.microsoft.com foo`) 上进行搜索并使用他们的缓存。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T14:28:59.310

好的，我的一位同事找到了答案... 进行 Google 搜索，单击要获取预览的点击右侧的微弱向右箭头，然后单击缓存链接。

**编辑：**如果您希望能够关注缓存页面中的链接，请安装其中之一：[http ://userscripts.org/scripts/search?q=google+cache&submit=Search](http://userscripts.org/scripts/search?q=google+cache&submit=Search)

# android - SIGBUS 仅在三星 Galaxy S2 上崩溃

> ID：10739368
> 
> 赞同：1
> 
> 时间：2012-05-24T14:21:42.237
> 
> 标签：android, android-ndk, samsung-mobile

我遇到了一个非常奇怪的问题 - 我在所有设备上都运行良好，但偶尔会在三星 Galaxy S2 上崩溃。

该应用程序使用 ffmpeg 并且崩溃就在那里。但是，我看不出代码本身有任何问题（如果有，它也会在其他设备上崩溃）。

我尝试在关闭所有 asm 优化的情况下进行编译，但仍然没有帮助。

似乎崩溃只发生在 2.3.6 上并且不会在 ICS 上崩溃。

```
*** *** *** *** *** *** *** *** *** *** *** *** *** *** *** ***
I DEBUG   : Build fingerprint: '2.3.6/GINGERBREAD/LA2:user/release-keys'
I DEBUG   : pid: 28725, tid: 30055  >>> xxxxxxxxxxxxxx <<<
I DEBUG   : signal 7 (SIGBUS), code 128 (?), fault addr 00000000
I DEBUG   :  r0 8e25e9fe  r1 000000b1  r2 00877731  r3 00000000
I DEBUG   :  r4 5257fe78  r5 005a7300  r6 5257fec4  r7 00630340
I DEBUG   :  r8 00000000  r9 00000724  10 81de8c6c  fp 006ccfe8
I DEBUG   :  ip 81de44b4  sp 5257fe08  lr 819c3748  pc 818386a0  cpsr 28000010
I DEBUG   :  d0  fd794ba0fd619c90  d1  fd96d984fd94d4d0
I DEBUG   :  d2  fd9232c4fd8c7b34  d3  fdaf8694fda5c318
I DEBUG   :  d4  3f33c07d3f333e16  d5  3f34c43d3f34428b
I DEBUG   :  d6  40667a147ae147af  d7  bff0000000000000
I DEBUG   :  d8  3ee4f8b588e368f1  d9  4680000044a04000
I DEBUG   :  d10 43a18000446b8000  d11 0000000043a18000
I DEBUG   :  d12 0000000000000000  d13 0000000000000000
I DEBUG   :  d14 0000000000000000  d15 0000000000000000
I DEBUG   :  d16 0000000001e9a790  d17 fe4dfbc0fe7eccdc
I DEBUG   :  d18 fdd679ccfe11f78a  d19 fd6edbecfd9d4964
I DEBUG   :  d20 fe9afe9afea3fea3  d21 fe4dfe4dfe7efe7e
I DEBUG   :  d22 fdd6fdd6fe11fe11  d23 fd6efd6efd9dfd9d
I DEBUG   :  d24 fd79fd79fd61fd61  d25 fd96fd96fd94fd94
I DEBUG   :  d26 fd92fd92fd8cfd8c  d27 fdaffdaffda5fda5
I DEBUG   :  d28 3f3504f3bf3504f3  d29 bf3504f33f3504f3
I DEBUG   :  d30 4433681844aeb242  d31 3f3504f33f3504f3
I DEBUG   :  scr 2800009a
I DEBUG   : 
I DEBUG   :          #00  pc 000386a0  /data/data/xxxxxxx/lib/libffmpeg.so (av_packet_split_side_data)
I DEBUG   :          #01  lr 819c3748  /data/data/xxxxxxx/lib/libffmpeg.so
I DEBUG   : 
I DEBUG   : libc base address: afd00000
I DEBUG   : 
I DEBUG   : code around pc:
I DEBUG   : 81838680 0a000012 e5941014 e351000c da00000f 
I DEBUG   : 81838690 e2411008 e30e09fe e0822001 e3480e25 
I DEBUG   : 818386a0 e5928000 e5929004 e1a01008 e1a02009 
I DEBUG   : 818386b0 e6bf2f32 e1838002 e1a06003 e1580000 
I DEBUG   : 818386c0 e6bf1f31 e1a07001 e1a09001 0a000002 
I DEBUG   : 
I DEBUG   : code around lr:
I DEBUG   : 819c3728 e5933020 e3130020 1a000002 e5940014 
I DEBUG   : 819c3738 e3500000 0a00001c e1a00004 ebf9d3c4 
I DEBUG   : 819c3748 e595c078 e3a03000 e58d3004 e59c3020 
I DEBUG   : 819c3758 e3130901 1a000016 e58543a8 e1a00005 
I DEBUG   : 819c3768 e1a01007 e1a02006 e1a03004 e1a0e00f 
I DEBUG   : 
I DEBUG   : stack:
I DEBUG   :     5257fdc8  00000000  
I DEBUG   :     5257fdcc  00631ed8  
I DEBUG   :     5257fdd0  00001004  
I DEBUG   :     5257fdd4  00001000  
I DEBUG   :     5257fdd8  00000007  
I DEBUG   :     5257fddc  0080a788  
I DEBUG   :     5257fde0  000017bd  
I DEBUG   :     5257fde4  81f08477  /system/lib/libOpenSLES.so
I DEBUG   :     5257fde8  00632024  
I DEBUG   :     5257fdec  00000000  
I DEBUG   :     5257fdf0  05007ffc  
I DEBUG   :     5257fdf4  00000001  
I DEBUG   :     5257fdf8  00000018  
I DEBUG   :     5257fdfc  afd464ec  
I DEBUG   :     5257fe00  0026e7f1  
I DEBUG   :     5257fe04  00000000  
I DEBUG   : #00 5257fe08  0026f4f6  
I DEBUG   :     5257fe0c  afd13b69  /system/lib/libc.so
I DEBUG   :     5257fe10  5257fe78  
I DEBUG   :     5257fe14  005a7300  
I DEBUG   :     5257fe18  5257fec4  
I DEBUG   :     5257fe1c  00630340  
I DEBUG   :     5257fe20  00000000  
I DEBUG   :     5257fe24  00000724  
I DEBUG   :     5257fe28  81de8c6c  
I DEBUG   :     5257fe2c  819c3748  /data/data/xxxxxxxx/lib/libffmpeg.so
I DEBUG   :     5257fe30  0026f4f6  
I DEBUG   :     5257fe34  5257fe78  
I DEBUG   :     5257fe38  81de8c70  
I DEBUG   :     5257fe3c  5257fe78  
I DEBUG   :     5257fe40  81de8c70  
I DEBUG   :     5257fe44  81de4420  
I DEBUG   :     5257fe48  81de73c4  
I DEBUG   :     5257fe4c  00000000  
I DEBUG   : dumpstate /data/log/dumpstate_app_native.txt
I DEBUG   : debuggerd committing suicide to free the zombie!
I DEBUG   : debuggerd: Jan  5 2012 22:42:33 
```

有没有人看到这个设备或那个特定的 Android 版本有什么奇怪的地方？或者有什么建议在哪里寻找以及如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T12:33:40.887

我有非常相似的问题 - ffmpeg 在解码数百帧后通过信号 7（SIGBUS）导致我的应用程序崩溃。它不是非常特定于设备 - 在某些设备上应用程序崩溃的频率更高，而在其他设备上则更少。

这对我来说是非常难以理解的问题，因为它可能在视频编码/解码的任何时候发生，我找不到任何导致失败的条件。`-malign-double`但是我根据这篇有用的文章 重新编译了带有标志的ffmpeg ：http: [//software.intel.com/en-us/blogs/2011/08/18/understanding-x86-vs-arm-memory-alignment-on-android/](http://software.intel.com/en-us/blogs/2011/08/18/understanding-x86-vs-arm-memory-alignment-on-android/) . 它有帮助！所以我完整的“配置”行是（当然不是所有这些标志都对你有用）：

> ./configure --target-os=linux --cross-prefix=arm-linux-androideabi- --disable-asm --arch=arm --cpu=cortex-a9 --sysroot=${SYSROOT} --enable -neon --disable-avdevice --enable-decoder=mjpeg --enable-demuxer=mjpeg --enable-parser=mjpeg --enable-demuxer=image2 --enable-muxer=mp4 --prefix=build/armeabi- v7a --extra-cflags='-DANDROID -I${NDK_ROOT}/sources/cxx-stl/system/include -mtune=cortex-a9 -mfpu=neon -mfloat-abi=softfp' --extra-ldflags=' -Wl,--fix-cortex-a8 -malign-double -L../android-libs -Wl,-rpath-link,../android-libs' --extra-cxxflags='-Wno-multichar -malign -double -fno-exceptions -fno-rtti'

希望它会帮助你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T06:14:23.143

这实际上是一个 NULLPointerException 并且发生在您的库 ffmpeg 中。当您使用地址 (000386a0) 查找问题的确切行时，此行 (pc 000386a0 /data/data/xxxxxxx/lib/libffmpeg.so) 提供了更多信息。

您可以使用此命令行工具来查找给您带来问题的函数。

```
cd D:\ndk\toolchains\arm-linux-androideabi-4.4.3\prebuilt\windows\bin

arm-linux-androideabi-addr2line -C -f -e D:\work\ProjectDIR\libs\armeabi\libffmpeg.so 
```

# sql - SQL：从另一个数据库插入数据（如果它们尚不存在）

> ID：10739372
> 
> 赞同：2
> 
> 时间：2012-05-24T14:21:47.713
> 
> 标签：sql, database, sql-server-2008, data-migration

我有两个 SQL Server 数据库 A 和 B

它们都包含一个以`Users`列命名的表`name`, `Age`,`Salary`

我想编写一个脚本来将`Users`数据库 A 中的数据插入到数据库 B 中（如果它们不存在的话`Name`）

所以基本上我在 SQL 脚本中需要这个：

```
Foreach (UserA in DatabaseA.Users)
    If UserA.Name does not exist in DatabaseB.Users
        Insert UserA in DatabaseB.Users 
```

非常感谢您的帮助

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-24T14:24:48.977

一种方式，无需循环，您可以根据设置进行

```
insert DatabaseB.Users
select name, age,salary
from DatabaseA.Users a
where not exists (select 1 from DatabaseB.Users b where b.name = a.name) 
```

有更多方法可以通过使用 IN、OUTER JOIN、EXCEPT、此处的一些示例[从一个表中选择另一表中不存在的所有行](http://blogs.lessthandot.com/index.php/DataMgmt/DataDesign/the-ten-most-asked-sql-server-questions--1#4)

# mysql - MySQL 查询需要时间来运行

> ID：10739375
> 
> 赞同：0
> 
> 时间：2012-05-24T14:21:49.360
> 
> 标签：mysql, performance

我有一个 MySQL 查询需要很长时间才能运行。

这是我的查询：

```
SELECT DISTINCT *,ROUND((total_gross_profit- (payment_processor_holdout+payment_processor_fee)-(affiliate_commission_base+affiliate_commission_markup)),2) as net_profit FROM (SELECT  O.id as oid
,M.last_name
,M.first_name
,D.product_name
,D.dosage_name
,O.date
,O.delivery
,O.aff_id
,IFNULL(O.product_total,0) as product_price
,IFNULL(O.discount_amount,0) as purchase_discount 
,IFNULL((O.product_total - O.discount_amount),0) as net_sales
,IFNULL(ROUND((O.total - O.product_total),2),0) as shipping_fee
,IFNULL(ROUND(((O.product_total - O.discount_amount) - (O.total - O.product_total)),2),0)  as gross_sales
,IFNULL(P.unit_cost,0) as product_unit_cost
,IFNULL((P.unit_cost * D.dosage_name),0) as costofgoods
,aset.setting_value as shipping_cost
,IFNULL(ROUND(((O.product_total - O.discount_amount) - (O.total - O.product_total) - (P.unit_cost * D.dosage_name)),2),0)  as goods_gross_profit
,IFNULL(ROUND(((O.total - O.product_total) - aset.setting_value),2),0) as shipping_gross_profit
,(IFNULL(ROUND(((O.product_total - O.discount_amount) - (O.total - O.product_total) - (P.unit_cost * D.dosage_name)),2),0)+ IFNULL(ROUND(((O.total - O.product_total) - aset.setting_value),2),0)) as total_gross_profit
,IFNULL(ROUND(IF(E.category_id IN (95,96,97,98,99),E.price*.25,E.price*.40),2),0) AS affiliate_commission_base
,IFNULL(ROUND((F.price_markup*.50),2),0) AS affiliate_commission_markup
,IFNULL((SELECT ppf.value FROM `aff_settings` ap
LEFT JOIN `payment_processor_fee` ppf
ON ap.setting_value=ppf.payment_processor_type
WHERE ap.setting_name='payment_processor'),0) as payment_processor_fee
,IFNULL(ROUND(((SELECT pph.value FROM `aff_settings` ap
LEFT JOIN `payment_processor_holdout` pph
ON ap.setting_value=pph.payment_processor_type
WHERE ap.setting_name='payment_processor')* O.total),2),0) as payment_processor_holdout
    FROM  `order` as O 
    LEFT JOIN `order_detail` as D 
    ON O.id = D.order_id
    LEFT JOIN `members` as M
    ON M.id = O.buyer_id
    LEFT JOIN `products` as P
    ON P.generic_name = D.product_name
    LEFT JOIN `aff_settings` as aset
    ON aset.setting_name = O.delivery 
    LEFT JOIN `aff_order_details` as E
    ON D.id = E.order_detail_ref_id
    LEFT JOIN `aff_group_product_prices` as F
    ON F.aff_id = O.aff_id
    AND F.product_id =P.Id
    AND F.dosage_id=D.dosage_name
ORDER BY M.last_name) AS x 
```

我有很多连接的表。有什么方法可以让查询运行得更快吗？如果是这样，怎么做？

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T14:23:46.067

对该查询运行 EXPLAIN PLAN。您可能会看到 TABLE SCAN，这意味着您必须添加索引和/或重写查询。

# android - 如何在我的手机上执行和apk文件？

> ID：10739376
> 
> 赞同：2
> 
> 时间：2012-05-24T14:21:50.327
> 
> 标签：android, mono, xamarin.android

我有一个用于 android 的 .apk 应用程序，它已经编译并与“Mono for Android”一起打包，当我将它复制到我的 SD 并安装它时工作正常，但是当我执行它时它给了我一个错误

```
app_vercode:1
device_model:ace
build_version:1.12.23
condition:1
processName:MonoAndroidApplication1.MonoAndroidApplication1
pid:24897
uid:10070
tag:null
shortMsg:android.content.pm.PackageManager$NameNotFoundException
longMsg:android.content.pm.PackageManager$NameNotFoundException: Mono.Android.DebugRuntime
stackTrace:java.lang.RuntimeException: Unable to get provider mono.MonoRuntimeProvider: java.lang.RuntimeException: Unable to find application Mono.Android.DebugRuntime or Mono.Android.Platform.ApiLevel_10!
at android.app.ActivityThread.installProvider(ActivityThread.java:3577)
at android.app.ActivityThread.installContentProviders(ActivityThread.java:3329)
at android.app.ActivityThread.handleBindApplication(ActivityThread.java:3285)
at android.app.ActivityThread.access$2200(ActivityThread.java:117)
at android.app.ActivityThread$H.handleMessage(ActivityThread.java:969)
at android.os.Handler.dispatchMessage(Handler.java:99)
at android.os.Looper.loop(Looper.java:130)
at android.app.ActivityThread.main(ActivityThread.java:3703)
at java.lang.reflect.Method.invokeNative(Native Method)
at java.lang.reflect.Method.invoke(Method.java:507)
at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:841)
at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:599)
at dalvik.system.NativeStart.main(Native Method)
Caused by: java.lang.RuntimeException: Unable to find application Mono.Android.DebugRuntime or Mono.Android.Platform.ApiLevel_10!
at mono.MonoRuntimeProvider.attachInfo(MonoRuntimeProvider.java:30)
at android.app.ActivityThread.installProvider(ActivityThread.java:3574)
... 12 more 
```

在执行包含单声道的 apk 文件之前，我是否必须安装任何东西？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T14:26:50.957

为了促进快速更改和部署周期，您的 .apk 默认不包含在设备上运行所需的所有内容。IDE 将负责安装应用程序运行所需的一切。

如果您不想使用 IDE，最简单的方法是在完全自包含的 Release 模式下编译您的应用程序。

套餐详情：

[http://docs.xamarin.com/android/tutorials/Application_Package_Sizes](http://docs.xamarin.com/android/tutorials/Application_Package_Sizes)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-24T14:28:49.073

你可以在你的项目中创建一个发布配置，它将 Mono 运行时包含在你的 .apk 中，而不是使用共享运行时。请注意，在下面的屏幕截图中未选中使用共享 Mono 运行时。

![构建配置](../Images/57efc5b92943668035fa2ddec1f9ec7e.png)

# asp.net - MVP 模式和会话值

> ID：10739377
> 
> 赞同：4
> 
> 时间：2012-05-24T14:21:51.783
> 
> 标签：asp.net, mvp

我有一个关于 ASP.NET MVP 模式的问题。演示者可以知道会话值吗？如果我开始使用会话值，我不知道如何模拟或测试会话值，以及如果我对 Win 表单使用相同的演示者怎么办。这是一个正确的想法吗？如果是这样，我在处理会话值方面有什么选择。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T16:39:09.053

Presenter 不应该知道 Session 对象（或 System.Web 中的任何其他对象），但如果您通过视图公开会话数据，它可以知道这些值。

使用 MVP，您可以看到这样的视图：

```
public interface IViewCustomerView
{
    ShoppingCartModel ShoppingCart {get;set}
} 
```

在视图的 Web 表单实现中，ShoppingCart 来自会话。

```
public partial class ViewCustomers : Page, IViewCustomerView

ShoppingCartModel ShoppingCart 
{
    // add null/cast checks etc. here
    get { return (ShoppingCartModel) Session["Cart"]; } 
    set { Session["Cart"] = value; }
} 
```

在您的 Web 表单和模拟实现中，它可能来自其他地方。然后在演示者中，当您访问购物车时，它不知道它来自会话：

```
IViewCustomerView _view;

_view.ShoppingCart... 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-24T15:21:24.893

I'm not too sure about the MVP bit, but you could write an interface like `ISessionState` which would have the ability to set/get values from something. In your website this would read/write to the real `Session` object, but in testing you would make a mock object which pretends to use a session.

Once you have this dependency extracted, it should be easy to inject an `ISessionState` implementation into your presenters or whatever else requires it.

# c - C结构后增量增加了4个字节的结构？为什么是这样？

> ID：10739380
> 
> 赞同：1
> 
> 时间：2012-05-24T14:22:05.360
> 
> 标签：c

我有一个大小为 48 字节的结构，最近在其中添加了另一个大小为 20 字节的结构；所以结构的总大小变成了 68 字节。（所有成员都是无符号整数）

```
typedef struct{
           ...
           ...
           unsigned long long a1;
           struct s2
           }s1 ; 
```

S1结构是一个数组；如果 s1 使用 s1++ 递增，则观察到 s1 递增 72 个字节而不是 68 个字节。令人惊讶的是，如果结构 s2 从 s1 中删除，一切正常，即 s1 会增加 48 个字节。任何有关原因的指示都会有所帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T14:25:41.010

你没有说你正在使用什么编译器或平台，但很可能编译器正在添加对齐字节以使结构在 8 字节边界上对齐。这很常见。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T14:48:58.683

正在*发生*的是结构填充。

它由编译器完成，以确保元素位于对齐的内存地址。

[您可以在此处](http://en.wikipedia.org/wiki/Data_structure_alignment#Typical_alignment_of_C_structs_on_x86)阅读有关 x86/x86_64 中“对齐”的更多信息。

**现在，*为什么*它们应该位于对齐的地址？（以 4 字节 WORD 为例）：**机器以“字”的形式从内存中访问数据。对于一个 4 字节的 WORD，这意味着要从地址读取单个字节`b11001110`，您需要读取 4 个字节（地址中的最后 2 位基本上在读取时被忽略），然后选择您需要的字节一次WORD 在 CPU 中：

```
| b11001100 | b11001101 | b11001110 | b11001111 |    <- all four loaded at once
                        \           /
                        only one used 
```

当您开始读取更大的数据类型时，读取“未对齐”数据可能比读取对齐数据成本更高：

如果您想读取从 address 开始的 4 个字节（1 个字）`b01110`，而不是一个字节，那么您必须读取 2 个字：

```
 first load             second load
/                       \/                      \
|01100|01101|01110|01111|10000|10001|10010|10011|
            \                       /
               unaligned data read 
```

编译器“填充”结构以避免此类读取。因为它们的成本很高。正如 Woodrow Douglass 在[他们的回答](https://stackoverflow.com/a/10739463/274261)中所建议的那样，您可以强制编译器“打包”而不是“填充”。

还有一件事：有些架构甚至不可能进行未对齐的负载。在此类机器上，操作系统通常会捕获在未对齐加载期间引发的异常，然后以某种方式模拟加载（例如，通过执行多个对齐加载）。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-05-24T14:26:14.597

这是64位机器吗？72 字节是 64 位字边界。您的编译器正在调整您的结构。在 gcc 中，如果你用 声明你的结构`__attribute__((__packed__))`，你可以避免这种情况。

所以像这样声明你的typedef：

```
typedef struct {
    ...
    ...
    struct s2;
} __attribute__((__packed__)) s1; 
```

# visual-studio - Incredibuild 不工作

> ID：10739382
> 
> 赞同：0
> 
> 时间：2012-05-24T14:22:11.107
> 
> 标签：visual-studio, compilation, multiprocessing

我正在使用 Incredibuild 来构建 Visual Studio 项目，但它无法正常工作并显示警告消息，

> 警告： FORCE_NO_INCREDIBUILD 已设置。除非您将其删除，否则构建过程将非常耗时。

我用谷歌搜索了 FORCE_NO_INCREDIBUILD 但没有得到一个结果。

请让我摆脱它。

谢谢，阿米特。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T14:58:28.330

FORCE_NO_INCREDIBUILD 是一个自定义变量，与 Visual Studio 和 Incredibuild 完全无关。

我用它注释掉了批处理脚本。现在 incredibuild 正在工作.... :)

谢谢阿米特

# javascript - 带有 extjs 的组合框中的错误排序顺序

> ID：10739386
> 
> 赞同：1
> 
> 时间：2012-05-24T14:22:28.530
> 
> 标签：javascript, extjs, extjs4, sencha-architect

我在使用组合框时遇到了数据排序问题。

数据源为 JSON。数据在sql中排序。结果集（在 sql 中）和 JSON 结果看起来不错：

```
{"rows":[{"id":"TOT","txt":" Alle diagnosen"},{"id":"612","txt":"(acute) bloeding distale tract. digestivus*"},{"id":"042","txt":"(auto)-intoxicatie"},{"id":"402","txt":"(benigne) peptisch ulcus*"},{"id":"10","txt":"(bij)niertumor"},{"id":"652","txt":"(chorio)retinitis.. etc etc 
```

当我使用 firebug 检查商店时，结果数据看起来很好（=与 JSON 结果相同的排序顺序）：

[![在此处输入图像描述](../Images/e5fe9894f14a7efee51b40b41eae7673.png)](https://i.stack.imgur.com/FsU5v.jpg)

但是，生成的组合框有不同的（错误的）排序（前 2 个可以）：

[![在此处输入图像描述](../Images/b4376b0b8da915c094e60c9134c30502.png)](https://i.stack.imgur.com/ZU9oF.jpg)

它不按显示值排序，也不按 id 值排序。任何地方都没有添加分拣机。

组合：

```
{
    xtype: 'combobox',
    id: 'ComboDiag',
    itemId: 'ComboDiag',
    width: 280,
    fieldStyle: '',
    name: 'ComboDiag',
    fieldLabel: 'Diagnose',
    labelWidth: 90,
    displayField: 'txt',
    queryMode: 'local',
    store: 'ComboDiagStore',
    typeAhead: true,
    valueField: 'id',
    listeners: {
        render: {
            fn: me.onComboDiagRender,
            scope: me
        }
    }
} 
```

店铺：

```
Ext.define('AppPitDash.store.ComboDiagStore', {
    extend: 'Ext.data.Store',
    alias: 'store.ComboDiagStore',
    requires: [
        'AppPitDash.model.ComboDiagModel'
    ],

    constructor: function(cfg) {
        var me = this;
        cfg = cfg || {};
        me.callParent([Ext.apply({
            autoLoad: true,
            storeId: 'ComboDiagStore',
            model: 'AppPitDash.model.ComboDiagModel',
            proxy: {
                type: 'ajax',
                url: './php/get-data-diagCombo.php',
                reader: {
                    type: 'json',
                    root: 'rows'
                }
            }
        }, cfg)]);
    }
}); 
```

模型：

```
Ext.define('AppPitDash.model.ComboDiagModel', {
    extend: 'Ext.data.Model',

    fields: [
        {
            name: 'id'
        },
        {
            name: 'txt'
        }
    ]
}); 
```

我第一次使用 Sencha Architect 2。

这比令人讨厌的东西更令人烦恼，但仍将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T14:44:09.393

尝试在商店定义中添加方法`remoteSort: true`。`callParent`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T15:57:55.967

尝试使用：

```
remoteGroup: true,
remoteSort: true, 
sortInfo: { field: 'order', direction: 'DESC' }, 
```

# python - 如何以编程方式更改 Ubuntu 中的音量

> ID：10739390
> 
> 赞同：25
> 
> 时间：2012-05-24T14:22:43.877
> 
> 标签：python, audio, ubuntu, gnome, alsa

您如何通过命令行或 API（最好是 Python）以编程方式更改 Ubuntu 上 Gnome 中的音量？

我发现类似问题的唯一答案使用`amixer`，这似乎对 Ubuntu 12.04 没有影响。跑步：

```
amixer set Headphone 10- 
```

显示：

```
Simple mixer control 'Headphone',0
  Capabilities: pvolume pswitch penum
  Playback channels: Front Left - Front Right
  Limits: Playback 0 - 115
  Mono:
  Front Left: Playback 0 [57%] [-57.50dB] [on]
  Front Right: Playback 0 [57%] [-57.50dB] [on] 
```

每次我运行它时，x% 都会发生变化。不幸的是，它对实际音量没有影响。最终它显示为 0%，但音量仍处于最高水平。

另一个缺点是我必须指定确切的活动输出设备，我可能不知道是否有多个设备。例如，如果我有一个“Master”和“Headphone”，我如何确定哪一个是活动设备？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2012-05-24T14:42:31.203

Ubuntu 使用 pulseaudio 作为发声器。`pactl`可以使用和实用程序从命令行控制它`pacmd`，例如：

```
pactl set-sink-volume 0 20% 
```

会将水槽#0 的体积设置为 20%。

见：`man pactl`和`pacmd help`

* * *

编辑：

为避免`-xx`被解释为命令行选项，您必须为其添加前缀`--`. 从那时起停止选项解析：

```
pactl set-sink-volume 0 -- -20%    # or:
pactl -- set-sink-volume 0 -20%    # doesn't matter where the `--` goes 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-05-24T20:57:44.203

我用 ALSA 混音器来做。你可能需要下载 python-alsaaudio

```
sudo apt-get install python-alsaaudio 
```

然后控制音量，

```
import alsaaudio
m = alsaaudio.Mixer()   # defined alsaaudio.Mixer to change volume
m.setvolume(50) # set volume
vol = m.getvolume() # get volume float value 
```

阅读[http://pyalsaaudio.sourceforge.net/libalsaaudio.html](http://pyalsaaudio.sourceforge.net/libalsaaudio.html)以详细了解 alsaaudio 库。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2014-02-19T00:04:28.700

**amixer**命令在 Ubuntu 13.04 中工作，

*音量增加 5%*
`amixer -D pulse sset Master 5%+`

*减少 5% 的音量*
`amixer -D pulse sset Master 5%-`

**pactl**或**pacmd**在 Ubuntu 13.04 中对我不起作用。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-09-11T17:35:57.730

读取音量的脏片段（不要忘记音量在 ubuntu 上超过“100%”——此时返回 ~0.66）。

```
#!/usr/bin/python
import subprocess

vol = int(filter(lambda l: l.startswith('set-sink-volume'),
          subprocess.check_output(["pacmd","dump"])
          .split('\n'))[0]
          .split()[-1],16)/100000.

print vol 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-04-29T19:51:08.833

你也可以试试简单优雅的[小马](https://github.com/falconindy/ponymix)混合工具。它使增加/减少音量、切换（静音/取消静音）音频等变得非常容易。

首先获取可用音频源的列表`ponymix`

就我而言，我可以看到**sink 0**和**source 0**。我可以使用数字**0**或全名**Built-in Audio Digital Stereo (HDMI)**来控制音频。

*将卡 0 的音量增加 5%*：`ponymix -c 0 increase 5`

*将卡片 0 的音量减小 5%*：`ponymix -c 0 decrease 5`

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-02-17T18:51:51.377

我可以推荐这个控制pulseaudio的工具： [https ://github.com/graysky2/pulseaudio-ctl](https://github.com/graysky2/pulseaudio-ctl)

```
me@mypc ~ $ pulseaudio-ctl
pulseaudio-ctl v1.63

/usr/bin/pulseaudio-ctl {up,down,mute,mute-input,set,atmost,full-status} [n]

Where up and down adjust volume in ±5 % increments
Where up and down [n] adjust volume in ±n % increments
Where mute toggles the mute status on/off
Where mute-input toggles the input status on/off
Where set set the volume to [n] %
Where atmost only takes effect if current volume is higher than [n]
Where full-status prints volume level, sink and source mute state to stdout

Optionally, redefine an upper threshold in /home/me/.config/pulseaudio-ctl/config

Volume level     : 80 %
Is sink muted    : no
Is source muted  : no
Detected sink    : 1
Detected source  : 3
Pulse version    : 8.0
me@mypc ~ $ 
```

# java - 复制对象并共享对成员数据的引用

> ID：10739394
> 
> 赞同：2
> 
> 时间：2012-05-24T14:22:55.077
> 
> 标签：java, clone, deep-copy

我有一个 Java webapp，它提取员工的记录并将其存储在一个自制的数据持有者对象中，奇怪的是，它被称为“EmployeeRecordDataHolder”。

我想在更新过程开始时制作一份 EmployeeRecordDataHolder 的副本，以便我可以进行比较以报告数据的变化情况。

我遇到了对成员数据的原始和副本共享引用的一些问题，结果是原始数据没有保持未更新。

我最初通过 HashMap 从数据库中取回数据。如果我从 HashMap get() 填充两个对象（原始对象和副本），这两个对象是否仍会共享对数据的相同引用，从而导致更改一个对象中的数据也会更改副本中的数据？

如果我使用 HashMap 填充原始对象，然后通过在副本的所有 setter 中调用原始对象上的所有 getter 来制作副本怎么办？例子：

```
copyDataHolderObj.setSomePieceOfData(  originalDataHolderObj.getSomePieceOfData() ); 
```

这种方法会导致两个可以相互独立更改的对象吗？

非常感谢提前

史蒂夫

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T14:56:09.630

回答你的第一个问题：

是的，两者都将共享对同一对象的引用。`HashMap`存储引用，因此所做的任何更新都是在原始对象上完成的。[此](http://docs.oracle.com/javase/6/docs/api/java/util/Map.html#keySet%28%29)页面清楚地说明了更改已反映。

回答你的第二个问题：

你可以这样做。创建所有对象的副本。

# c# - 在c#中复制文件时如何填充0？

> ID：10739395
> 
> 赞同：0
> 
> 时间：2012-05-24T14:22:59.827
> 
> 标签：c#, .net, file, io

```
static void Main(string[] args)
{
    int a=0000001;
    for (int i=0; i <= 5; i++)
    {

        File.Copy(@"C:\SR\30758668.pdf", @"C:\SR\"+a+"_30758668.pdf",true);
        a++;
    }

    Console.WriteLine("\nSuccessful");
    Console.ReadLine();

} 
```

我已经编写了上面的程序以使用前导字符串复制 1 个文件 5 次。像这个文件一样，`30758668.pdf`应该创建为0000003_30758668.pdf` 一样明智。`0000001_30758668.pdf``0000002_30758668.pdf`,`

现在它创建文件，`1_30758668.pdf`我`2_30758668.pdf`不想要这种方式。

我没有在哪里转换为整数或字符串？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-24T14:25:11.027

并且`int`没有格式化；01 与 1 相同 与 00000001 相同 - 它们都只是 1。

利用：

```
 .... + a.ToString().PadLeft(7,'0') + ... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T14:27:15.953

使用字符串格式。IE：

```
File.Copy(@"C:\SR\30758668.pdf", "C:\SR\" + a.Tostring("000000") + "_30758668.pdf", true); 
```

或使用 String.Format 更好地构建字符串：

```
File.Copy(@"C:\SR\30758668.pdf", String.Format(@"C:\SR\{0}_30758668.pdf", a.ToString("000000")), true); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T14:27:22.863

显式填充的替代方法是仅使用 Dx 格式说明符 on`ToString()`或 in `string.Format()`：

例如：

```
File.Copy(@"C:\SR\30758668.pdf", @"C:\SR\" + a.ToString("D7") + "_30758668.pdf",true); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-24T14:30:50.217

您不能在数值数据类型上指定前导零。您需要将其转换为 String 并使用 PadLeft 用您想要的字符填充它。PadLeft 的第一个参数表示你想要的字符串的总宽度，第二个参数表示将使用哪个字符进行填充。

```
int a=1; 

for (int i=0; i <= 5; i++) 
 { 

            File.Copy(@"C:\SR\30758668.pdf", @"C:\SR\"+ a.ToString().PadLeft(7, "0")+ "_30758668.pdf",true); 

        } 

        Console.WriteLine("\nSuccessful"); 
        Console.ReadLine(); 

    } 
```

# java - 如何将 .java 文件导入 JSP 页面？

> ID：10739400
> 
> 赞同：3
> 
> 时间：2012-05-24T14:23:07.907
> 
> 标签：java, eclipse, jsp, tomcat

这是我第一次尝试将 java 用于后端 Web 系统。

我一直在阅读一些有关如何执行此操作的指南，到目前为止，我了解以下几点：

1.  我不允许导入 .java 文件，而是导入类文件。
2.  <%@ page language="java" import="somefile.*"%> 这就是我导入包的方式。
3.  导入包后，我需要创建该类的实例。

但是，我对一些事情感到困惑。

我现在有一个动态 Web 项目，在 Eclipse IDE 中开发并使用 TomCat7.0 apache。

我有一个目录 Java_Resources/src/somepackage/

以及上述目录中的一些 .java 文件。

问题1，在Eclipse中，当我运行这些文件时，它们会被自动编译。这些类文件去哪里了？

问题 2，当我运行以下代码时，我收到了一些错误。我究竟做错了什么？是因为我的类文件不在正确的目录中吗？

```
<%@ page language="java" import="twitter.*"%>

<%
    JavaFile jf = new Javafile();

    String result = jf.searchTweets("someString");
    System.out.println(result);
%> 
```

错误报告：

```
type Exception report

message

description The server encountered an internal error () that prevented it from fulfilling this request.

exception

org.apache.jasper.JasperException: An exception occurred processing JSP page /hello.jsp at line 10

7: <%@ page language="java" import="twitter.*"%>
8: 
9: <%
10:     Javafile jf = new JavaFile();
11:     
12:     String result = jf.searchTweets("someString");
13:     System.out.println(result); 
```

感谢您的时间和精力。

注意：我已阅读以下链接，但它们似乎没有提供有关如何编写您自己的 .java 文件并将这些类导入您的 jsp 文件的解决方案。

[http://www.jsptut.com/](http://www.jsptut.com/)

[如何在 JSP 中导入类？](https://stackoverflow.com/questions/239147/how-do-you-import-classes-in-jsp)

[http://www.coderanch.com/t/288534/JSP/java/importing-class-file-jsp](http://www.coderanch.com/t/288534/JSP/java/importing-class-file-jsp)

编辑：我找到了自己的答案。

这是我原来的目录

![在此处输入图像描述](../Images/66cfb4d40cfed3d67d76b878cad5b783.png)

如您所见，我的 WEB-INF/lib 是空的。

所需要做的就是将相关的 .jar 文件移动到该目录中。

注意：我已经将相关的 .jar 文件导入到 Eclipse 项目中，但是在将它们导入到项目中之前，我似乎需要将它们移动到 WEB-INF/lib 中。

感谢所有帮助回答我的问题的人。

这是我的最终目录图像![在此处输入图像描述](../Images/ccd9a83a7079cdfbad87819219a187fe.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T14:27:09.417

只有类可以导入到`.java`文件中，而 JSP 会“编译”到`.java`文件中，所以这个要求也适用于 JSP 文件。

快速浏览一下 API，您的导入格式似乎正确；但是，您正在导入错误的命名空间。[twitter4j API](http://twitter4j.org/ja/oldjavadocs/2.1.12/index.html)的javadoc表明您应该导入“twitter4j”命名空间，而不是“twitter”命名空间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T14:27:25.643

> > 问题1，在Eclipse中，当我运行这些文件时，它们会被自动编译。这些类文件去哪里了？

类文件进入`WEB-INF/classes`目录。

> > 问题 2，当我运行以下代码时，我收到了一些错误。我究竟做错了什么？是因为我的类文件不在正确的目录中吗？

也许您忘记了将`twitterXXX.jar`（或任何名称）放入`WEB-INF/lib`目录中。

# cakephp - CakePHP Auth 组件——可能有两个单独的登录名？

> ID：10739402
> 
> 赞同：1
> 
> 时间：2012-05-24T14:23:11.637
> 
> 标签：cakephp, authentication

我有一个 CakePHP 2.0 应用程序，它使用带有模型的 AuthComponent`User`成功登录以管理帖子和其他控制器和模型。我将其称为网站的“超级管理员”部分。

但是，我需要为广告商创建一个完全独立的网站部分。我已经创建了模型`Advertiser`和控制器`AdvertisersController`。我还创建了 table `advertisers`。我能够成功添加广告客户用户，但是当我尝试登录时，由于用户名或密码无效错误而失败。

我遵循了 Cookbook for [Authentication](http://book.cakephp.org/2.0/en/core-libraries/components/authentication.html)`beforeFilter`中的建议，并在我的以下选项中尝试了这两个选项`AdvertisersController`：

```
$this->Auth->authenticate = array(
    AuthComponent::ALL => array(
        'userModel' => 'Advertiser', 
        'fields' => array('username' => 'username', 'password' => 'password'),
            'Form',
            'Basic'
    ));

$this->Auth->authenticate = array(
    'Form' => array('userModel' => 'Advertiser'),
    'Basic' => array('userModel' => 'Advertiser')
); 
```

有任何想法吗？不能将 AuthComponent 与两个不同的模型/控制器一起使用吗？

**编辑：**我将我的 AdvertisersController 更新为：

```
public function beforeFilter() {

    parent::beforeFilter();

    $this->Auth->authenticate = array(
        AuthComponent::ALL => array('userModel' => 'Advertiser'),
        'Form',
        'Basic'
    );
    $this->Auth->allow('add', 'logout'); // Letting advertisers register themselves

} 
```

现在登录完全失败了——没有失败的密码错误。我什至尝试了伪造的用户名和密码。这是我的控制器中的登录方法：

```
public function login() {
        if ($this->request->is('post')) {
            if ($this->Auth->login()) {
                $this->redirect(array('controller' => 'advertisers', 'action' => 'admin'));
            } else {
                $this->Session->setFlash(__('Invalid username or password, try again'));
            }
        }
    } 
```

我`else print_r($this->data); exit;`在第一个 if 结束后添加了一条语句，得到了一个空数组。甚至无法进入登录页面。

此外，表单的输出是这样的—— POST 是方法。

```
<form action="/advertisers/login?url=advertisers%2Flogin" id="AdvertiserLoginForm" method="post" accept-charset="utf-8">
    <div style="display:none;"><input type="hidden" name="_method" value="POST"/></div>    
    <fieldset>
        <legend>Please enter your username and password</legend>
        <div class="input text required">
            <label for="AdvertiserUsername">Username</label>
            <input name="data[Advertiser][username]" maxlength="50" type="text" id="AdvertiserUsername"/>
        </div>
        <div class="input password required">
            <label for="AdvertiserPassword">Password</label>
            <input name="data[Advertiser][password]" type="password" id="AdvertiserPassword"/>
        </div>    
    </fieldset>
    <div class="submit">
        <input  type="submit" value="Login"/>
    </div>
</form> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T19:36:33.520

[我在这里](https://stackoverflow.com/questions/13167367/cakephp-2-x-auth-with-two-separate-logins)重新发布了这个问题并提供了更多信息。Joshua 在为这种情况下整理管理员前缀方面提供了很大帮助。如果您的应用程序看起来“太多” - 请在此处查看他的评论。它看起来比实际更复杂，它有助于使用户控件更加明确。

# prepared-statement - 为什么这个准备好的语句出现语法错误？

> ID：10739408
> 
> 赞同：1
> 
> 时间：2012-05-24T14:23:27.877
> 
> 标签：prepared-statement, derby

我正在尝试学习如何执行 PreparedStatement，如下所示：

```
createConnection();
conn.setAutoCommit(false);
String sql = "SELECT MAX(?) FROM ?";
PreparedStatement stmt = conn.prepareStatement(sql); 
```

但是，当我点击最后一行时，它会抛出一个 java.sql.SQLSyntaxErrorException，如下所示：

```
java.sql.SQLSyntaxErrorException: Syntax error: Encountered "?" at line 1, column 20. 
```

我到处搜索，但找不到任何失败的原因。我究竟做错了什么？稍后在我设置的代码中？参数表示完整的字符串值，但是当我调试时，我从来没有达到这一点。它碰到这个 conn.prepareStatement 行并抛出异常。谢谢您的帮助。我不知道它是否有所作为，但它在 derby 数据库中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T14:27:08.273

想你的？标记为 sql 变量。您不能对变量执行 select MAX，它在语法上不正确。

您不能执行以下操作：

```
declare @myvar int
select @myvar = 1

SELECT MAX(@myvar) from SomeTable 
```

# java - 来自 Java EE 应用程序服务器的数据流

> ID：10739410
> 
> 赞同：4
> 
> 时间：2012-05-24T14:23:35.160
> 
> 标签：java, jakarta-ee, jboss, streaming, ejb

我需要从应用程序服务器（JBoss）中检索一个大文件（千兆字节）并避免将其加载到内存中，我想通过 EJB 流式传输它。

是否可以将数据作为流从应用程序服务器中取出？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-24T14:26:04.283

创建一个[HttpServlet](http://docs.oracle.com/javaee/6/api/javax/servlet/http/HttpServlet.html)，流式传输文件。

**更新** 小心你的标题。您不能通过 设置 ContentLength-Header `setContentLength()`，因为它只接受`int`。

您必须设置它：`setHeader("Content-Length", (long)length)`

也许这会有所帮助：[Using ServletOutputStream to write very large files in a Java servlet without memory issues](https://stackoverflow.com/questions/685271/using-servletoutputstream-to-write-very-large-files-in-a-java-servlet-without-me)

有一个限制，但这取决于客户端。如果客户端将文件保存在内存中，它将无法工作。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-24T14:27:36.480

EJB是指远程*bean*吗？这些 bean 通常基于 RMI，而后者又使用 Java 序列化。您不能使用 RMI 流式传输数据。

然而，对于 servlet 和 HTTP，这将非常简单。只需打开`FileInputStream`您的大文件并将其逐字节复制到[servlet 输出](http://docs.oracle.com/javaee/6/api/javax/servlet/ServletResponse.html#getOutputStream%28%29)。

### 要记住：

*   使用输入文件缓冲
*   在最开始设置`Content-Length`标头，以便客户端知道还剩下多少数据

# android - 如果已经在运行android，如何防止服务再次运行

> ID：10739413
> 
> 赞同：42
> 
> 时间：2012-05-24T14:23:38.063
> 
> 标签：android, service, android-service

单击按钮时，我想使用方法启动服务，`startService(new Intent(currentActivity.this,MyService.class))`但是如果服务正在运行，我不想调用此方法以避免运行已经在运行的服务。这是怎么可能的。我同时使用Intent**服务**和**Service**项目并希望对两者应用相同的条件。

* * *

## 回答 #1

> 赞同：88
> 
> 时间：2012-05-24T14:28:48.667

一个服务只会运行一次，所以你可以调用`startService(Intent)`多次。

您将在服务中收到一个`onStartCommand()`。所以记住这一点。

来源：请注意，多次调用`Context.startService()`不嵌套（尽管它们确实会导致多次相应的调用`onStartCommand()`），因此无论启动多少次服务都将停止一次`Context.stopService()`或被`stopSelf()`调用；但是，服务可以使用它们的`stopSelf(int)`方法来确保在处理启动的意图之前不会停止服务。

在： http: [//developer.android.com/reference/android/app/Service.html](http://developer.android.com/reference/android/app/Service.html)主题：服务生命周期

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2013-07-03T15:09:25.170

使用`startService()`. 启动服务将调用`onStartCommand()`如果服务尚未启动，它将调用`onCreate()`。初始化您的变量和/或在`onCreate()`.

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-05-24T14:31:26.653

绑定你的服务；开始通话时：

```
Intent bindIntent = new Intent(this,ServiceTask.class);
    startService(bindIntent);
    bindService(bindIntent,mConnection,0); 
```

然后要检查您的服务是否正常工作，请使用以下方法：

```
 public static boolean isServiceRunning(String serviceClassName){ 
             final ActivityManager activityManager = (ActivityManager)Application.getContext().getSystemService(Context.ACTIVITY_SERVICE);     
             final List<RunningServiceInfo> services = activityManager.getRunningServices(Integer.MAX_VALUE);      
           for (RunningServiceInfo runningServiceInfo : services) {         
             if (runningServiceInfo.service.getClassName().equals(serviceClassName)){             
                return true;         
             }     
           }     
         return false; 
        } 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2017-11-15T06:07:15.013

每当我们从任何 Activity 启动任何服务时，Android 系统都会调用该服务的 onStartCommand() 方法，如果该服务尚未运行，则系统首先调用 onCreate()，然后再调用 onStartCommand()。

所以意思是说 android 服务在其生命周期中只启动一次并保持运行直到停止。如果任何其他客户端想要再次启动它，那么只有 onStartCommand() 方法将一直被调用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-12-29T15:35:53.747

因此，为了避免一次又一次地重新启动任务，您可以使用布尔值，即任务已经启动或正在进行。将方法放在 oncreate 和 onstartCommand 中，并使用布尔值进行检查：

```
 boolean isTimerTaskRunning = false;
private boolean isServiceKeepRunning(){
        SharedPreferences settings = PreferenceManager.getDefaultSharedPreferences(this);
        return settings.getBoolean("silentModeKeepRunning", true);
    }

@Override
    public void onCreate() {
        super.onCreate();
        Log.i(TAG, "onCreate: Called");
        Log.i(TAG, "onCreate: keepRunning "+isServiceKeepRunning());
        if(!isTimerTaskRunning) {
            startTimerTask();
            isTimerTaskRunning = true;
        }
        //startForeground(REQUEST_CODE /* ID of notification */, notificationbuilder().build());

    }

 @Override
    public int onStartCommand(Intent intent, int flags, int startId) {
        localData = new LocalData(this);
      //  return super.onStartCommand(intent, flags, startId);
        Log.i(TAG, "onStartCommand: Called");
        Log.i(TAG, "onStartCommand: keepRunning "+isServiceKeepRunning());

        Toast.makeText(this, "This is The Mode For Silent. ", Toast.LENGTH_LONG).show();

        if(!isTimerTaskRunning) {
            Log.i(TAG, "TimerTask was not Running - started from onStartCommand");
           startTimerTask();
           isTimerTaskRunning = true;

        }else {
            Log.i(TAG, "TimerTask was already Running - checked from onStartCommand");

        }
        //return START_REDELIVER_INTENT;
        startForeground(REQUEST_CODE /* ID of notification */, notificationbuilder().build());

        return  START_STICKY;
} 
```

# javascript - 将信息存储在对象中，稍后按key排序+搜索对象

> ID：10739417
> 
> 赞同：0
> 
> 时间：2012-05-24T14:23:58.373
> 
> 标签：javascript, sorting

我很难弄清楚这一点。

因此，我正在创建一个需要将元素的水平位置存储在以 ID 作为值的对象中的站点。然后我需要按键对对象进行排序。稍后我必须遍历对象并找到最接近的元素（之前和之后）。

我正在努力存储信息。我有它就像一个变量。

像这样存储它是否正确：

```
myObj.x = tempId; 
```

接下来，如何对键进行排序？它应该排序为数字，而不是文本，因为我在排序时遇到了问题`14, 1500, 800`。

最后，如何循环对象并保持对键和值的访问？如果我这样做，`for (var i in obj)`我会丢失键值。

# javascript - 为什么我的 UI/Draggable 'create' 事件被传递了一个空的 'ui' 对象？

> ID：10739418
> 
> 赞同：3
> 
> 时间：2012-05-24T14:24:03.453
> 
> 标签：javascript, jquery, jquery-ui

我在 div 中有一个图像。我希望该图像可以在 div 中拖动，并且我想存储图像的坐标。在 Draggable 上使用“停止”事件对此非常有效，并且完全符合我的要求。我还希望在“创建”事件上运行相同的代码。但是，当在“create”事件中使用相同的代码时，传入的“ui”对象似乎是空的：

```
$(document).ready(function() {
    $('#imageitem').draggable({
        containment: "parent",
        stop: function(event, ui) {
            console.log(ui);  // results in full object being printed 
        },
        create: function(event, ui) {
            console.log(ui);  // results in empty object being printed: Object { }
        },
    });
}); 
```

[UI/Draggable](http://docs.jquery.com/UI/Draggable#event-create)的文档显示创建回调应该接收“ui”对象：

```
$( ".selector" ).draggable({
   create: function(event, ui) { ... }
}); 
```

我正在尝试访问 ui.offset，由于对象为空，所以它不可用。如果我理解正确的话，'ui' 对象此时应该已经存在于 DOM 中，因为我只是附加了一个可拖动对象。我不应该能够在可拖动事件的“创建”期间访问 ui.offset 吗？

诚然，我是 jQuery 的新手，所以我可能会在这里遗漏一些东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T14:30:58.383

似乎您应该能够在`offset`创建可拖动项目时知道它。只需在页面加载后检查元素。如果您需要传递这些值，您不能只为它们创建默认值 - 还是对象将被随机定位？

其次，（避开该元素在创建时应该为您提供大量信息的事实`ui`）您应该能够通过找到该元素并调用`.offset()`它来访问页面上任何元素的偏移量。即，在您的 create 语句中，通过您要使用的任何选择器定位可拖动元素并以这种方式找出偏移量：

```
console.log($("#idOfDraggableElement").offset()); 
```

**编辑：**这是一个[jsfiddle，](http://jsfiddle.net/EXAY2/)显示如何在创建时访问属性。

# c# - 如何使用 c# 将二进制数组转换为 .wav？

> ID：10739421
> 
> 赞同：-1
> 
> 时间：2012-05-24T14:24:29.437
> 
> 标签：c#, .net

我正在用 C# 做一个项目，它需要我加密一个波形文件。那么，是否有一个直接的过程将波形文件转换为二进制文件并返回？我将对二进制数据应用加密算法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T14:27:31.663

当然，检查[`File.ReadAllBytes`](http://msdn.microsoft.com/en-us/library/system.io.file.readallbytes.aspx)和[`File.WriteAllBytes`](http://msdn.microsoft.com/en-us/library/system.io.file.writeallbytes.aspx)方法。或者，如果文件太大而无法放入内存，您可以使用[`FileStream`](http://msdn.microsoft.com/en-us/library/system.io.filestream.aspx).

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-24T14:27:53.190

您可以使用[FileStream](http://msdn.microsoft.com/en-us/library/system.io.filestream.aspx)读取二进制文件，例如 WAV 文件，然后将另一个`FileStream`加密版本写回。

您需要使用字节数组以块的形式读取和写入文件。

# java - 带有 JFreeChart 的热图

> ID：10739422
> 
> 赞同：4
> 
> 时间：2012-05-24T14:24:29.980
> 
> 标签：java, jfreechart, heatmap

我有一个点 (x,y) 数据集，我想创建这个数据集的热图。更具体地说，我想要一张图像，其中我的点集中度较高的区域颜色较浅，而点较少的区域颜色较暗。我正在使用 JFreeChart 库，并且找到了一些类，例如 DefaultHeatMapDataset，但我不确定如何以正确的方式使用它们。

有人知道怎么做吗？

提前致谢！乔瓦尼

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-24T20:23:31.447

将[`XYBlockRenderer`](http://www.jfree.org/jfreechart/api/javadoc/org/jfree/chart/renderer/xy/XYBlockRenderer.html)与 的适当实现[`XYZDataset`](http://www.jfree.org/jfreechart/api/javadoc/org/jfree/data/xy/XYZDataset.html)和 的相应实现一起使用[`PaintScale`](http://www.jfree.org/jfreechart/api/javadoc/org/jfree/chart/renderer/PaintScale.html)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-12-14T21:36:38.050

在 JFreeChart 中创建热图有点棘手，因为仍然（从版本 1.0.19/1.5.0 开始）没有图表类型。此用例的绘图。（正如[大卫吉尔伯特在论坛中所写的](http://www.jfree.org/forum/viewtopic.php?f=3&t=28006&p=78148#p78148)那样，available[`HeatMapDataset`](http://www.jfree.org/jfreechart/api/javadoc/org/jfree/data/general/HeatMapDataset.html)被编写为与一起使用。）`HeatMapUtilities`

因此，创建热图的最佳方法是使用 an[`XYPlot`](http://www.jfree.org/jfreechart/api/javadoc/org/jfree/chart/plot/XYPlot.html)和[`XYBlockRenderer`](http://www.jfree.org/jfreechart/api/javadoc/org/jfree/chart/renderer/xy/XYBlockRenderer.html)an [`XYZDataset`](http://www.jfree.org/jfreechart/api/javadoc/org/jfree/data/xy/XYZDataset.html)，正如*垃圾神*已经写的那样。

这是一个完整的、简约的示例，您可以运行该示例以获得如下所示的图表：

```
import org.jfree.chart.ChartPanel;
import org.jfree.chart.JFreeChart;
import org.jfree.chart.axis.*;
import org.jfree.chart.plot.XYPlot;
import org.jfree.chart.renderer.LookupPaintScale;
import org.jfree.chart.renderer.xy.XYBlockRenderer;
import org.jfree.chart.title.PaintScaleLegend;
import org.jfree.data.xy.DefaultXYZDataset;
import org.jfree.data.xy.XYZDataset;
import org.jfree.ui.ApplicationFrame;
import org.jfree.ui.RectangleEdge;

import java.awt.*;
import java.util.Random;

public class HeatMapDemo extends ApplicationFrame
{
    public HeatMapDemo()
    {
        super("JFreeChart Heatmap Demo");
        final JFreeChart chart = createChart(createDataset());
        setContentPane(new ChartPanel(chart));
    }

    private static JFreeChart createChart(XYZDataset dataset)
    {
        // x-axis for time
        DateAxis xAxis = new DateAxis("Time");
        xAxis.setStandardTickUnits(DateAxis.createStandardDateTickUnits());
        xAxis.setLowerMargin(0);
        xAxis.setUpperMargin(0);

        // visible y-axis with symbols
        String labels[] = new String[500];
        for (int i = 0; i < 500; i++)
            labels[i] = "ca. " + i + "nm";
        SymbolAxis yAxis = new SymbolAxis(null, labels);
        yAxis.setTickUnit(new NumberTickUnit(50));

        // another invisible y-axis for scaling
        // (this is not necessary if your y-values are suitable) 
        NumberAxis valueAxis1 = new NumberAxis("Marker");
        valueAxis1.setLowerMargin(0);
        valueAxis1.setUpperMargin(0);
        valueAxis1.setVisible(false);

        // create a paint-scale and a legend showing it
        LookupPaintScale paintScale = new LookupPaintScale(0, 300, Color.black);
        Color c = Color.green;
        paintScale.add(0.0, c);
        paintScale.add(33.0, c = c.darker());
        paintScale.add(66.0, c.darker());
        paintScale.add(100.0, c = Color.blue);
        paintScale.add(133.0, c = c.darker());
        paintScale.add(166.0, c.darker());
        paintScale.add(200.0, c = Color.red.darker().darker());
        paintScale.add(233.0, c = c.brighter());
        paintScale.add(266.0, c.brighter());

        PaintScaleLegend psl = new PaintScaleLegend(paintScale, new NumberAxis());
        psl.setPosition(RectangleEdge.RIGHT);
        psl.setAxisLocation(AxisLocation.TOP_OR_RIGHT);
        psl.setMargin(50.0, 20.0, 80.0, 0.0);

        // finally a renderer and a plot
        XYPlot plot = new XYPlot(dataset, xAxis, yAxis, new XYBlockRenderer());
        ((XYBlockRenderer)plot.getRenderer()).setPaintScale(paintScale);
        // 2 optional lines, depending on your y-values
        plot.setRangeAxis(1, valueAxis1);
        plot.mapDatasetToRangeAxis(0, 1);

        JFreeChart chart = new JFreeChart(null, null, plot, false);
        chart.addSubtitle(psl);
        return chart;
    }

    public XYZDataset createDataset()
    {
        double[] xvalues = new double[1000*100]; // date
        double[] yvalues = new double[1000*100]; // numeric (1-100)
        double[] zvalues = new double[1000*100]; // numeric (the actual data)

        // create some random data
        final Random rand = new Random();
        long l = System.currentTimeMillis();
        for (int i = 0; i < 1000; i++) {
            l -= 600000;
            for (int j = 0; j < 100; j++) {
                final int idx = i * 100 + j;
                xvalues[idx] = l;
                yvalues[idx] = j;
                double delta = rand.nextInt(15) * (rand.nextInt(4) == 0 ? -1 : 1);
                zvalues[idx] = Math.max(0, Math.min(300,
                    (idx < 1000 ? 0 : zvalues[idx - 1000]) + delta));
            }
        }

        DefaultXYZDataset dataset = new DefaultXYZDataset();
        dataset.addSeries("Just one Series", new double[][] { xvalues, yvalues, zvalues });
        return dataset;
    }

    public static void main(String args[])
    {
        final HeatMapDemo demo = new HeatMapDemo();
        demo.pack();
        demo.setVisible(true);
    }
} 
```

生成的热图如下所示：

[![热图](../Images/3749a0351d86f36ddea1ee54b8a734a5.png)](https://i.stack.imgur.com/WKM43.png)

如果你需要更线性的`PaintScale`，你可以看看[`SpectrumPaintScale implementation`这个答案](https://stackoverflow.com/questions/37154575/how-to-plot-color-map-in-java#37235165)。

# iphone - setStatusBarHidden 然后如何调整应用程序框架的大小？

> ID：10739423
> 
> 赞同：1
> 
> 时间：2012-05-24T14:24:32.687
> 
> 标签：iphone, objective-c, ios, xcode

如果我使用这种方法，是否有办法将屏幕设置为完整的 320x480 而不是隐藏状态栏之前的 320x460？

非常感谢，-代码

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T15:13:18.430

将此代码写入 AppDelegate.m 文件

```
[[UIApplication sharedApplication] setStatusBarHidden:YES]; 
```

此代码用于隐藏状态栏。所以你可以得到视图大小是 320 X 480 而不是 320 X 460。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T07:45:16.643

确保您的窗口设置为使用 [UIScreen mainScreen] bounds] 作为它的框架，并在您的第一个视图控制器上设置了 setWantsFullScreenLayout。

```
self.window = [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]];
UIViewController *viewController = [[UIViewController alloc] init];
[viewController setWantsFullScreenLayout:YES];
[self.window setRootViewController:viewController]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T14:39:03.140

我通常在应用程序委托中隐藏状态栏。然后每当我需要创建一个新的视图控制器时，我都会删除它附带的 UIView。我在屏幕上添加了一个新的 UIView 并将其大小设置为 320 x 480 并将其连接到文件所有者的“视图”插座。根据我的经验，如果 UIView 设置为 320 x 460 并且状态栏是隐藏的，那么在运行时视图会被拉伸 20 像素。这会对某些子视图造成模糊效果。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-24T14:31:23.980

如果您将 IB 用于情节提要或更传统的方式，请确保将状态栏的 UIViewController 设置设置为“无”。这将确保您创建并添加到其中的视图将是完整大小，而不是设置为更小的东西。

您还需要向 plist 添加一个条目，称为“状态栏最初隐藏”或 UIStatusBarHidden，并将其设置为“是”。这将阻止操作系统显示应用程序的状态栏。

通过做这两件事，您可以确保您拥有全屏。

# php - 操作 Zend_Paginator 数据

> ID：10739424
> 
> 赞同：1
> 
> 时间：2012-05-24T14:24:36.840
> 
> 标签：php, zend-framework, zend-db, zend-paginator

我想添加`product variations`到使用 Zend_Paginator 的产品视图表中。

有了这个代码，我得到了我的产品。

```
$select = $productModel->select() ... (so on) 
```

使用此代码，我创建了分页器

```
$adapter = new Zend_Paginator_Adapter_DbSelect($select);
$paginator = new Zend_Paginator($adapter); 
```

现在我正在尝试将其添加`product_variations`到产品数据中。我试图这样做：

```
foreach($paginator as $key => $product) {

    // get variations   
    $variations = $productModel->getProductVariants($product['ID']);
    // overwrite $product add variations
    $product['Variations'] = $variations;
    $paginator->$key = $product;

} 
```

但在我的视图控制器中，只会`product_data`显示。缺少数组 ( `Variations`)。

我该如何处理？

TIA FRGTV10

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T10:46:40.347

请参阅：[将项目添加到已创建的分页器](https://stackoverflow.com/questions/2206337/adding-items-to-a-zend-paginator-already-created)。

```
foreach($paginator as $key => &$product) {
    // get variations   
    $variations = $productModel->getProductVariants($product['ID']);
    // overwrite $product add variations
    $product['Variations'] = $variations;
}
unset($product); 
```

注意通过引用传入`&`。`foreach()`然后您更改引用的`$product`并且不需要将任何内容分配回`$paginator`.

# java - WebDriver + Internet Explorer，switchTo.window 问题

> ID：10739425
> 
> 赞同：1
> 
> 时间：2012-05-24T14:24:37.343
> 
> 标签：java, internet-explorer, webdriver, selenium-webdriver

我使用 Selenium 2 + Java 在 IE 9 上测试应用程序。单击链接后，弹出窗口打开。我使用 switchTo.window 方法进入弹出窗口。但是当我尝试返回时，我的测试在此操作上被延迟并且无法继续。

一些代码：

```
link.click(); //Open pop-up window    
Object[] windows = driverIE.getWindowHandles().toArray();    
driverIE.switchTo().defaultContent();    
driverIE.switchTo().window(windows[1].toString());  //Focus on pop-up window    
.....    
mainWindowHandle = driverIE.getWindowHandles().iterator().next();   //Handle of main window    
driverIE.switchTo().window(mainWindowHandle);   //Fail! 
```

请帮我解决问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T11:49:18.203

`getWindowHandles()`不保证返回的 Windows 句柄按任何顺序排列。换句话说，您不能依赖`windows[1]`上面的代码示例来包含已打开窗口的窗口句柄。相反，您需要的代码如下所示（**注意：**前面完全未经测试的代码！）：

```
String mainHandle = driver.getWindowHandle();

// Do whatever you need to do to open a new window,
// and properly wait for the new window to appear...

Set<String> allHandles = driver.getWindowHandles();
for(String currentHandle : allHandles) {
  // Note that this is cheating a bit. It will only
  // work with a total of two windows. If you have
  // more than two windows total, your logic here
  // will have to be a little more sophisticated.
  if (!currentHandle.equals(mainHandle)) {
    driver.switchTo().window(currentHandle);
    break;
  }
}

// Work with popup window...
// Close the popup window and switch context back
// to the main window.
driver.close();
driver.switchTo().window(mainHandle); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-02-25T10:49:33.040

正如 JimEvans 所说，driver.getWindowHandles() 有时会以错误的顺序放置窗口，因此 for 循环并不总是有效。

类似于上面对我有用（我只有两个窗口要处理）：

```
 String winHandleBefore = driver.getWindowHandle();

    driver.findElement(By.cssSelector("a")).click();

    Set<String> winHandle = driver.getWindowHandles();

    winHandle.remove(winHandleBefore);

    String winHandleNew = winHandle.toString();

    String winHandleFinal = winHandleNew.replaceAll("\\[", "").replaceAll("\\]","");

    driver.switchTo().window(winHandleFinal); 
```

# session - 在会话中存储表单字段值并根据需要在多个页面上获取它

> ID：10739427
> 
> 赞同：0
> 
> 时间：2012-05-24T14:24:41.473
> 
> 标签：session, jsf-2

我有一个 JSF 表单，其中有一个字段（文本字段），文本字段中的值说 `profileId`，我需要在许多页面中使用它，那么我们如何将它存储在会话中，以及我们如何根据需要检索它？

简而言之，在 JSF 会话中设置一个变量值并获取它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T14:40:17.597

将其绑定到会话范围的托管 bean。

```
@ManagedBean
@SessionScoped
public class Profile {

    private Long id;

    // ...
} 
```

和

```
<h:inputText value="#{profile.id}" /> 
```

您可以通过将其注入为其他 bean 来访问它`@ManagedProperty`。

```
@ManagedBean
@ViewScoped
public class OtherBean {

    @ManagedProperty("#{profile}")
    private Profile profile;

    public void submit() {
        System.out.println(profile.getId());
    }

    // ...
} 
```

# php - nginx + fastCGI for PHP error_page

> ID：10739436
> 
> 赞同：2
> 
> 时间：2012-05-24T14:25:00.183
> 
> 标签：php, nginx, fastcgi, custom-error-pages

我用 fastCGI for PHP 像这样在 nginx 中设置了自定义错误页面，它可以工作：

```
root <FOLDER>;
error_page 404 /error.php?404;
location = /error.php {
    include /etc/nginx/fastcgi.conf;
    fastcgi_pass  127.0.0.1:1234;
    root  <FOLDER>;
} 
```

但是由于我对每个 HTTP 错误代码都有一个 error.php，所以我想以通用形式进行设置。问题是我不知道nginx是否提供了要通过GET传递给error.php的错误代码

我正在寻找类似的东西：

```
root <FOLDER>;
error_page 500 501 502 401 402 403 404 /error.php?NGINX_ERROR_CODE;
location = /error.php {
    include /etc/nginx/fastcgi.conf;
    fastcgi_pass  127.0.0.1:1234;
    root  <FOLDER>;
} 
```

问题是`NGINX_ERROR_CODE`我不知道它是否提供这样的东西来设置一般的 error_page 处理程序。

有什么办法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T14:37:49.437

谷歌搜索，最初似乎没有 var 。

但是，您可以设置多个错误页面指令。

```
error_page 401 /error.php?e=401;
error_page 402 /error.php?e=402;
error_page 403 /error.php?e=403;
error_page 404 /error.php?e=404;
error_page 500 501 502 /error.php?e=50x; 
```

等等。

# c++ - std::upper_bound 中的 boost::transform_iterator 编译错误

> ID：10739442
> 
> 赞同：0
> 
> 时间：2012-05-24T14:25:15.183
> 
> 标签：c++, boost, iterator

我有一个按 z 顺序排序的节点列表（[http://en.wikipedia.org/wiki/Z-order_curve](http://en.wikipedia.org/wiki/Z-order_curve)）。我试图找到比 zPosition 更大的第一个节点。iterTransform 对象接受一个迭代器并返回一个二进制位置表示（与 zPosition 类型相同）。这种类型可以通过pathCmp进行比较

```
NodeIterT last = std::upper_bound(
    boost::make_transform_iterator(begin, iterTransform), // return PathType
    boost::make_transform_iterator(end, iterTransform),
    zPosition,
    pathCmp ); // takes two PathType arguments 
```

编译时我得到

错误 C2440：“正在初始化”：无法从“boost::transform_iterator < UnaryFunc,Iterator,Reference,Value >”转换为“std::_Vector_iterator<_Myvec>”

在这个最小化的示例中是否有任何错误，或者我需要提供更多代码吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T14:36:47.240

`std::upper_bound`返回一个`transform_iterator`。添加`.base()`以获取您包装的迭代器类型：

```
NodeIterT last = std::upper_bound(
boost::make_transform_iterator(begin, iterTransform), // return PathType
boost::make_transform_iterator(end, iterTransform),
zPosition,
pathCmp ).base(); 
```

应该工作假设`begin`并且`end`是`NodeIterT`类型。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-24T14:37:50.343

`std::upper_bound`返回一个与作为参数给出的相同类型的迭代器。在您的情况下，返回类型因此是`boost::transform_iterator<...>`而不是`std::vector<...>::iterator`。

如果要访问底层迭代器，可以使用[`base()`成员函数](http://www.boost.org/doc/libs/release/libs/iterator/doc/transform_iterator.html)：

```
NodeIterT last = std::upper_bound(
    boost::make_transform_iterator(begin, iterTransform), // return PathType
    boost::make_transform_iterator(end, iterTransform),
    zPosition,
    pathCmp ).base(); // note the call to base() 
```

# java - 用于字节数组操作的 Java 库？

> ID：10739448
> 
> 赞同：4
> 
> 时间：2012-05-24T14:25:38.513
> 
> 标签：java, bytearray

是否有可用的免费库包含操作字节数组的常用方法？

它至少应该能够执行以下操作 ob 字节数组，但其他数组类型也会很好：

*   搜索子数组
*   搜索和替换
*   在特定位置插入元素
*   删除某个位置的子数组

我知道所有这些功能都不是很神奇，但是完全实现它们并且包括相应的单元测试在内的傻瓜和错误证明需要一些时间。

因此，我正在寻找包含这些功能的（非 GPL）库。有人知道这样的图书馆吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T14:39:09.083

如果您使用原始类型的数组，[Guava 库](https://github.com/google/)可以提供帮助。[*在PrimitivesExplained - guava-libraries - Guava 的原语实用程序*](https://github.com/google/guava/wiki/PrimitivesExplained)中查看更多信息，解释。[*- Guava：适用于 Java 1.6+ 的 Google 核心库 - Google 项目托管*](https://github.com/google/guava/wiki/PrimitivesExplained)

有趣的课程是[`com.google.common.primitives.Bytes`](https://guava.dev/releases/snapshot-jre/api/docs/com/google/common/primitives/Bytes.html)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-24T14:30:54.940

我认为你的前三个问题可以通过**Java.util.Arrays**类来解决，你不需要 3rd 方库。

```
Arrays.binarySearch() method is for your first problem.
Arrays.fill() method for your second problem. 
```

对于最后一个问题，我可以建议一些我知道的 3rd 方实用程序包。

Google 的 Guava，Apache 的 commons API 可能会有所帮助。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-05-24T14:33:59.150

我想您可以通过将数组转换为`Collection`. 如果你不想使用`Collections`，而你只处理`byte[]`，你可以这样做：

```
public class A {

    public static byte[] deleteSubarray(byte[] array, byte[] subArray) {
        int p = searchFor(array, subArray);
        if (p == -1)
            return array;
        byte[] result = new byte[array.length - subArray.length + 1];
        for (int i = 0; i < p; i++)
            result[i] = array[i];
        for (int i = p + subArray.length - 1; i < array.length; i++) {
            result[p] = array[i];
            p++;
        }
        return result;
    }

    public static byte[] insertElementAt(byte[] array, byte element, int position) {
        byte[] result = new byte[array.length + 1];
        for (int i = 0; i <= position - 1; i++)
            result[i] = array[i];
        result[position] = element;
        for (int i = position + 1; i < array.length; i++) {
            result[i] = array[i];
        }
        return result;
    }

    public static byte[] searchAndReplace(byte[] array, byte[] search, byte[] replace) {
        if (search.length != replace.length)
            return array;
        int p = searchFor(array, search);
        if (p == -1)
            return array;
        byte[] result = Arrays.copyOf(array, array.length);
        for (int i = 0; i < replace.length; i++) {
            result[p] = replace[i];
            p++;
        }
        return result;
    }

    public static int searchFor(byte[] array, byte[] subArray) {
        if (subArray.length > array.length)
            return -1;
        int p = (new String(array)).indexOf(new String(subArray));
        for (int i = 1; i < subArray.length; i++) {
            if (array[p + i] != subArray[i])
                return -1;
        }
        return p;
    }

    public static void main(String[] args) {
        String a = "hello world!";
        String b = "lo w";
        System.out.println(searchFor(a.getBytes(), b.getBytes()));
        System.out.println(new String(searchAndReplace(a.getBytes(), b.getBytes(), "mn x".getBytes())));
        System.out.println(new String(insertElementAt(a.getBytes(), "-".getBytes()[0], 5)));
        System.out.println(new String(deleteSubarray(a.getBytes(), b.getBytes())));
    }

} 
```

输出：

> ```
> 3
> helmn xorld!
> hello-world!
> helworld! 
> ```

如果您还要处理其他类型的数组，那么`searchFor`它不起作用，但您可以轻松概括:)

# shell - 如果条件，ksh 中的算术语法错误

> ID：10739458
> 
> 赞同：1
> 
> 时间：2012-05-24T14:25:58.640
> 
> 标签：shell, unix, scripting, ksh

我的 KornShell (ksh) 脚本的一部分如下。

```
let "value=`awk NR==14 ${TEMP_DIR}/IR4723/count_part_UNVM.txt`"
let "var= value"
if [ $var -gt 0 ]
then
load_data ${count_part[$i]}
fi 
```

脚本上述部分的第一行引发以下错误：

```
arithmetic syntax error LOADTODB/ShellsAndSQLs/IR4723/load_gen_tmp_tab.ksh[84]: test: 8 
```

上面的脚本从文件 count_part_UNVM.txt 值 8 中读取第 14 行。我陷入了这个问题。请帮我解决问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T14:31:35.327

这是一个错字，还是你错过了价值前面的'$'，即（你的第二行）

```
let "var=$value" 
```

我认为应该是

```
let var="$value" 
```

通过打开shell调试功能，您可以在构建脚本时消除很多问题，即

```
 set -vx
 let "var= value"
 set +vx 
```

或者放在`set -vx`脚本顶部附近，看看如何处理所有脚本。

**EDIT3**或放在第一行`-vx`之后，即.`#!/bin/bash``#!/bin/bash -vx`

**EDIT2**我错过了你的第一条评论，是的，line1 看起来也有问题。尝试这个

```
let value="$(awk 'NR==14' ${TEMP_DIR}/IR4723/count_part_UNVM.txt)" 
```

请注意，在 1995 年的“新 Kornshell 语言”中，将反引号用于 cmd-substitution 已被声明为已弃用。`$( )`因为 cmd-substition 很容易嵌套，是您最好的选择。另外，请注意 awk 脚本（在 cmdline 上）应作为单个参数呈现，并用单引号或 dbl 引号括起来。（但我不确定您是否需要引号，因为您的“程序”中没有空格。）如果修订不起作用，`print --"value=XX${value}XX`请在分配后添加并编辑上面的问题以显示输出。

**编辑**根据您的评论/问题，周围有一些 shell 脚本调试器，但我从不使用它们。如果您真的想尝试，请搜索 Rosenberg ksh book debugger。

`set -vx`应该真正称为“执行跟踪” 。它在执行之前向您显示代码行或代码块，然后将任何变量扩展为它们的值。这是人们调试 ksh 脚本的典型方式。您还可以添加诸如`print -- "var=XX${var}XX"`查看变量的单个值之类的语句，但这会弄乱您的输出，并且可能需要您关闭这些语句，从而迫使您再次编辑脚本。

我希望这有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-11T23:16:20.540

你为什么`let`在ksh中使用？这是对您的代码的建议。

**例子.ksh**

```
#!/bin/ksh

#Initialize Varables
TEMP_DIR=tempDir/IR4723
var=""

initialize(){
    echo "Entering initialize"

    echo "Exiting initialize"
}
function1(){
    echo "Entering function1"
    echo ${PWD}
    file=${PWD}/${TEMP_DIR}/count_part_UNVM.txt
    readLine "${file}"
    echo "var: "${var}
    if [[ ${var} -gt 0 ]]; then
        load_data ${count_part[$i]}
    fi
    echo "Exiting function1"
}
createDir(){
    echo "Entering createDir"
    mkdir -p ${1}
    echo "Exiting createDir"
}
createFileWithRandomCount(){
    echo "Entering createFileWithRandomCount"
    orgDirectory=${PWD}
    cd ${1}
    > ${2}
    print ${RANDOM} >> ${2}
    cd ${orgDirectory}
    echo "Exiting createFileWithRandomCount"
}
readLine(){
    echo "Entering readLine"
    file=${1}
    while read line
    do
        # display line or do somthing on $line
        var="$line"
    done <"$file"
    echo "Exiting readLine"
}
load_data(){
    echo "Entering load_data"
    echo "Exiting load_data"
}

#-----------
#---Main----
#-----------
echo "Starting: "${0}" with Input Parameters: {1: "${1}" {2: "${2}" {3: "${3}
initialize #function call#
createDir ${TEMP_DIR} #function call#
createFileWithRandomCount ${TEMP_DIR} count_part_UNVM.txt #function call#
function1 #function call# 
```

**输出：**

```
$ ksh -i example.ksh
Starting: example.ksh with Input Parameters: {1:  {2:  {3:
Entering initialize
Exiting initialize
Entering createDir
Exiting createDir
Entering createFileWithRandomCount
Exiting createFileWithRandomCount
Entering function1
/tmp
Entering readLine
Exiting readLine
var: 11984
Entering load_data
Exiting load_data
Exiting function1 
```

# c# - 在 Windows Mobile 6 上连接 GPRS 时，为什么我的套接字无法通过 LAN 连接？

> ID：10739460
> 
> 赞同：0
> 
> 时间：2012-05-24T14:26:03.177
> 
> 标签：c#, sockets, windows-mobile, compact-framework, routes

我们有一个 Compact Framework 3.5 应用程序，它通过网络底座执行一天结束的下载工作。

该设备是带有 Windows Mobile 6.1 Professional 的 Motorola MC9500。

为了做到这一点，我们创建一个`Socket`类并调用`Connect()`

但它只有在没有连接 GPRS 的情况下才有效。

如果 GPRS 已连接，则该方法超时。

我们的解决方案是在将设备放入底座时以编程方式关闭手机，并在移除时再次开启。

但这是非常暴力的，我们不明白为什么它不起作用，什么时候应该！

这是连接（`sServerIPAddress == "192.168.27.107"`）的代码：

```
oEndPoint = new IPEndPoint(IPAddress.Parse(sServerIPAddress), i);
oSock = new Socket(oEndPoint.AddressFamily, SocketType.Stream, ProtocolType.Tcp);
oSock.Connect(oEndPoint); 
```

这是两个接口连接时的路由表：

```
Destination     Netmask         Gateway         Metric
0.0.0.0         0.0.0.0         192.168.27.1    20
0.0.0.0         0.0.0.0         10.212.14.71    50
10.0.0.0        255.0.0.0       10.212.14.71    50
10.212.14.71    255.255.255.255 127.0.0.1       50
10.255.255.255  255.255.255.255 10.212.14.71    50
127.0.0.0       255.0.0.0       127.0.0.1       1
* 192.168.27.0  255.255.255.0   192.168.27.52   20 *
192.168.27.52   255.255.255.255 127.0.0.1       20
192.168.27.255  255.255.255.255 192.168.27.52   20
224.0.0.0       240.0.0.0       192.168.27.52   20
224.0.0.0       240.0.0.0       10.212.14.71    50
255.255.255.255 255.255.255.255 10.212.14.71    1
255.255.255.255 255.255.255.255 192.168.27.52   1 
```

据我所知，应该选择 LAN 作为目标地址

我看不出 WinMo 连接管理器应该与此有什么关系，当然在 IP 级别只有路由表对连接很重要？

谁能告诉我为什么它只在 GPRS 关闭时才有效以及如何正确操作？

谢谢，

詹姆士。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T13:45:19.887

我最好的**猜测**是您的设备一次只能连接到一个端口 - GPRS 或 LAN。

在您尝试连接到您的 LAN 之前，您可以搜索一下是否有任何其他 Socket 是打开的吗？

如果是这样，你能关闭它吗？

如果关闭成功，您现在可以建立局域网连接了吗？

# javascript - 如何在Javascript中去除破折号分隔字符串的最后一个元素

> ID：10739465
> 
> 赞同：3
> 
> 时间：2012-05-24T14:26:21.243
> 
> 标签：javascript

我用破折号分隔字符串，例如：

```
x#-ls-foobar-takemeoff- 
```

如何`takemeoff-`使用 javascript删除`takemeoff-`以破折号结尾的任意数量的字符？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-24T14:29:51.680

```
var str = "x#-ls-foobar-takemeoff-";
var newStr = str.replace(/[^-]+-$/,""); 
```

基本正则表达式说

```
[^-]+  <-- Match any characters that is not a dash
-      <-- Match a dash character
$      <-- Match the end of a string 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T14:29:29.527

如果您有一个字符串`str`，您可以执行以下操作：

```
str = str.substr(0, str.lastIndexOf("-", str.length - 2)); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T14:36:13.103

使用`substr()`和`lastIndexOf()`：

```
var myStr = "x#-ls-foobar-takemeoff-";

myStr = myStr.substr(0, myStr.length-1); // remove the trailing -

var lastDash = myStr.lastIndexOf('-'); // find the last -
myStr = myStr.substr(0, lastDash);

alert(myStr); 
```

输出：

> x#-ls-foobar

[jsFiddle 在这里](http://jsfiddle.net/zDWyK/)。

# ruby - Rails/Ruby：检查数据库是否存在

> ID：10739467
> 
> 赞同：4
> 
> 时间：2012-05-24T14:26:26.267
> 
> 标签：ruby, ruby-on-rails-3

我有一个帐户模型，它为每个帐户创建一个数据库。在创建它之前，我需要验证是否没有另一个同名的数据库。

我怎么能做这样的验证？我在 ActiveRecord::Base.connection 中找不到任何方法。

谢谢。

# java - 从另一个类的一个类中的数组中获取值

> ID：10739472
> 
> 赞同：0
> 
> 时间：2012-05-24T14:26:36.017
> 
> 标签：java, arrays

我在一个类中有这个代码，并且希望理想地将`adjclose`数组列表中的值复制到另一个类以进行进一步处理，同时保留原始数据。

我可以看到在数组被填充 时，arraylist 在`println`语句之前填充了语句的值。`return`

然后该`main`方法遍历 arraylist 以再次显示 arraylist 中每个元素的值`adjclose`。

我怎样才能`adjclose`从另一个类访问数组列表以使我能够将它们复制到新的数组列表以进一步处理？

```
public ArrayList<Double> getadjClose(String symbol) {
    String baseUrl = "http://ichart.finance.yahoo.com/table.csv?ignore=.csv";
    baseUrl += "&s=" + symbol;
    baseUrl += "&a=" + startMonth;
    baseUrl += "&b=" + startDay;
    baseUrl += "&c=" + startYear;
    baseUrl += "&d=" + endMonth;
    baseUrl += "&e=" + endDay;
    baseUrl += "&f=" + endYear;
    baseUrl += "&g=" + freq;
    URL url;
    ArrayList<Double> adjclose = new ArrayList<Double>();
    System.out.print("Opening URL: ");
    System.out.print(baseUrl);
    System.out.println(" ");
    int counter = 0;
    try {
        url = new URL(baseUrl);
        BufferedReader in = new BufferedReader(new InputStreamReader(
                url.openStream()));
        in.readLine(); // Forward Header
        while (true) {
            String thisLine = in.readLine();
            if (thisLine == null) {
                break;
            }
            String[] separatedLine = thisLine.split("[,X]"); // split by commas
            adjclose.add(Double.parseDouble(separatedLine[6]));
            System.out.println(adjclose.get(counter) + " " + counter);
            counter = counter + 1;
        }
        return adjclose;
    } catch (IOException e) {
        return null;
    }
} 
```

我现在对第一个类中的代码进行了更改，如下所示。

```
package yahooapi;

/**
 *
 * @author RSLOMA
 */
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;
import java.net.URL;
import java.util.ArrayList;
import java.util.Calendar;

public class YahooAPI {

int startMonth;
int startDay;
int startYear;

int endMonth;
int endDay;
int endYear;
int TodayDate;

String freq;

public ArrayList<Double> data = new ArrayList<>();

public ArrayList<Double>  getAdjClose(String symbol) throws IOException {
String baseUrl = "http://ichart.finance.yahoo.com/table.csv?ignore=.csv";
baseUrl += "&s=" + symbol;
baseUrl += "&a=" + startMonth;
baseUrl += "&b=" + startDay;
baseUrl += "&c=" + startYear;
baseUrl += "&d=" + endMonth;
baseUrl += "&e=" + endDay;
baseUrl += "&f=" + endYear;
baseUrl += "&g=" + freq;

URL url;

// use a local variable

ArrayList<Double> adjclose = new ArrayList<>(); 

System.out.print("Opening URL: ");
System.out.print(baseUrl);
System.out.println(" ");

int counter = 0;

try {
url = new URL(baseUrl);
BufferedReader in = new BufferedReader(new InputStreamReader(url.openStream()));

in.readLine(); //Forward Header

while (true){
String thisLine = in.readLine();
if (thisLine == null){
break;
}
String[] separatedLine = thisLine.split("[,X]"); // split by commas

adjclose.add(Double.parseDouble(separatedLine[6]));
System.out.println(adjclose.get(counter) + " " + counter);

// update the data once the read is done

data = adjclose;
System.out.println(data.get(counter));

counter = counter + 1;

}

return adjclose;

} catch (IOException e) {
    return null;
}
}

public static void main(String args[]) throws IOException{
YahooAPI y = new YahooAPI();
Calendar cal = Calendar.getInstance();

y.startDay = 1;
y.startMonth = cal.get(Calendar.MONTH) - 1; //0 is jan, so 2 is march
y.startYear = cal.get(Calendar.YEAR) - 3;
System.out.println("Day: " + y.startMonth);
System.out.println("Day: " + y.startDay);
System.out.println("Day: " + y.startYear);

y.endDay = cal.get(Calendar.DATE) - (cal.get(Calendar.DATE) - 1);
y.endMonth = cal.get(Calendar.MONTH); //0 is jan, so 2 is march
y.endYear = cal.get(Calendar.YEAR);

y.freq = "m"; // d for daily frequency, w for weekly, m for monthly

ArrayList<Double> adjclose = y.getAdjClose("^GSPC");

//Iterator<Double> iter = adjclose.iterator();

//System.out.println("Returned Adjusted Close Values:");
//while (iter.hasNext()){
//System.out.println(iter.next());

int ArrayLngth = adjclose.size();

System.out.print("Array length = " + ArrayLngth + "    ");
}

    public ArrayList<Double> getAdjClose() {

        for (int counter = 0; counter<data.size(); counter++) {

            System.out.println(data.get(counter) + " " + counter);

    }

        return (ArrayList<Double>) data.clone();

    }

} 
```

我在另一个包中有另一个类，我想用于计算，将原始数据元素保留在原始数组中，并将新计算的数据保存在第二类的数组中。另一个类的开始代码如下。如何调用以获取在 data.clone() 中克隆的数据？

```
package PortfolioDesign;

/**
 *
 * @author RSLOMA
 */

public class MonthlyReturns {

        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T14:37:07.480

在你的第一个类中有一个方法，它将创建数组的克隆并返回克隆，然后从你的第二个类调用该方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T14:58:22.350

如果多次使用结果，我会将方法拆分为

*   一种数据收集方法
*   一种数据检索方法

然后数据收集器填充该类的一个成员：

```
private ArrayList<Double> data = new ArrayList<Double>();

public void  fillAdjClose(String symbol) throws IOException {
    String baseUrl = "http://ichart.finance.yahoo.com/table.csv?ignore=.csv";
    baseUrl += "&s=" + symbol;
    baseUrl += "&a=" + startMonth;
    baseUrl += "&b=" + startDay;
    baseUrl += "&c=" + startYear;
    baseUrl += "&d=" + endMonth;
    baseUrl += "&e=" + endDay;
    baseUrl += "&f=" + endYear;
    baseUrl += "&g=" + freq;
    URL url;

    // use a local variable
    ArrayList<Double> adjclose = new ArrayList<Double>();
    System.out.print("Opening URL: ");
    System.out.print(baseUrl);
    System.out.println(" ");
    int counter = 0;
    url = new URL(baseUrl);
    BufferedReader in = new BufferedReader(new InputStreamReader(
            url.openStream()));
    in.readLine(); // Forward Header
    while (true) {
        String thisLine = in.readLine();
        if (thisLine == null) {
            break;
        }
        String[] separatedLine = thisLine.split("[,X]"); // split by commas
        adjclose.add(Double.parseDouble(separatedLine[6]));
        System.out.println(adjclose.get(counter) + " " + counter);
        counter = counter + 1;
    }

    // update the date once the read is done
    data = adjclose;
}

public ArrayList<Double> getAdjClose() {
    return (ArrayList<Double>) data.clone();
} 
```

您可以随时调用 getAdjClose() 并始终获取上次读取数据的副本。

除非您还需要元素的副本，否则您始终可以将 clone() 用于 ArrayList。由于您使用的是不可变的 Double，因此无需复制元素。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T14:38:31.403

如果你想发布`adjclose`say from `Class A`to的值，`Class B`那么包含类`ClassA`应该有一个可以称为 my 的 getter 方法`ClassB`。

要保留原始数据，您应该发布一份副本，`adjClose`而不是原始列表本身。另外需要注意的是，你应该做一个深层克隆而不是浅层克隆。

```
import java.util.ArrayList;
import java.util.Collections;
import java.util.List;
public classA {
   private List<Double> adjclose = null;

   public List<Double> getAdjClose(){
     List<Double> returnValue = new ArrayList<Double>();
     if(adjclose != null) {
        returnValue.addAll(adjclose); // this will ensure that if caller makes any changes to adjClose, copy of classA remains intact.
        return returnValue;
     }
     return Collections.emptyList();
   }    
} 
```

然后调用者类 ClassB 将创建 ClassA 的实例并在其上调用 getAdjClose()。

```
import java.util.List;
public class ClassB {
   public static void main(String[] args){
      ClassA classA = new ClassA();
      List<Double> list = classA.getAdjClose();
      System.out.println(list);
      list.set(0, new Double(11));
      System.out.println(list);
      System.out.println(classA.getAdjClose());
   }
} 
```

# r - ggplot2-geom_linerange 与 stat_smooth

> ID：10739475
> 
> 赞同：0
> 
> 时间：2012-05-24T14:26:43.130
> 
> 标签：r, ggplot2

哦，聪明人：我有一个关于 geom_linerange() 使用的问题，附上我希望是一个可行的例子来说明我的问题。

```
b=c(100,110,90,100,120,130,170,150,150,120,140,150,120,90,90,100,40,50,40,40,20,60,30)
test<-data.frame(a=c(2,2,2,4,4,4,4,6,6,6,6,6,6,8,8,8,10,10,10,10,10,10,10),
                 b=b,c=c(b-15))

testMelt <- melt(
  test, 
  id       = c("a"), 
  measured = c("b", "c")
  )

p <- ggplot(
  aes(
    x    = factor(a), 
    y    = value,
    fill= variable
    ),      
   data  = testMelt) + 
    geom_boxplot() + 
          stat_smooth(aes(group=variable,x=factor(a),y=value,fill=factor(variable)),data=testMelt) 
```

我的实际数据集要大得多，箱线图有点压倒性。我想我想要的是使用 geom_linerange() 以某种方式在“a”的每个值处显示“b”和“c”处的数据范围。

我想出的最好的是：

```
p<- p+ geom_linerange(aes(as.factor(a),ymin=min(value),ymax=value,color=variable)) 
```

我可以假设“c”值总是等于或小于“b”，但如果范围更小，这会“覆盖它”。我可以以某种方式抖动线条吗？有更好的解决方案吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T17:32:42.903

在您的`geom_linerange`通话中，添加一个额外的参数`position=position_dodge(width=0.3)`。您可以调整绝对宽度以更改垂直线之间的间距。

![在此处输入图像描述](../Images/ae4d34e09cc4d7a49a006d10d757550c.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T23:34:47.093

我对这个问题的理解是，您希望 line range 反映组合的范围`a:b:c`。

`geom_linerange(aes(as.factor(a),ymin=min(value),ymax=value,color=variable))`将最小值设置为整个数据集的最小值（因此所有行都显示为相同的最小值。

几个解决方案。

自己计算最小值和最大值

```
test_range <- ddply(testMelt, .(a,variable), summarize, 
                    val_min = min(value), val_max = max(value)) 
```

然后运行

```
 ggplot(data  = testMelt) + 
    geom_boxplot(aes(x = factor(a), y = value, fill = variable)) + 
    stat_smooth(aes(group = variable, x = factor(a), y = value, 
                    fill = factor(variable))) +
     geom_linerange(data = test_range, aes(x = as.factor(a), ymin = val_min,
                    ymax = val_max, color = variable), 
                    position = position_dodge(width = 0.3)) 
```

或者，对于箱线图/线范围的替代方案，请使用小提琴图。

```
ggplot(data  = testMelt) + 
    geom_violin(aes(x = factor(a), y = value, fill = variable)) + 
    stat_smooth(aes(group = variable, x = factor(a), y = value, 
                    fill = factor(variable))) 
```

# facebook - 在我的网站中嵌入 Facebook 视频

> ID：10739496
> 
> 赞同：0
> 
> 时间：2012-05-24T14:27:20.783
> 
> 标签：facebook, video

我正在尝试将 Facebook 视频嵌入我的网站。我找到了可以让它工作的步骤，但问题是，如果我在 iPhone 或任何智能手机中打开网站，视频根本不会加载。

我在嵌入 Facebook 视频时收集到的信息是，我必须获取只能在浏览器中看到的视频的唯一 ID。这是我的示例代码：

```
 <object width="400" height="300" >
    <param name="allowfullscreen" value="true" />
    <param name="allowscriptaccess" value="always" />
    <param name="movie" value="http://www.facebook.com/v/UniqueVideoId" />
    <embed src="http://www.facebook.com/v/UniqueVideoId" type="application/x-shockwave-flash" allowscriptaccess="always" allowfullscreen="true" width="400" height="224">
   </embed>
</object> 
```

我还需要做什么才能使 facebook 视频在 iPhone 或任何智能手机上工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T10:31:23.727

您需要一个不基于 Flash 且适用于 iOS 或 android 的视频播放器。

然后，您可以从 API 检索原始视频 URL 并将其包含在您的应用中

`SELECT vid, owner, title, description, src, src_hq, thumbnail_link, embed_html, updated_time, created_time FROM video WHERE owner=me()`因为 FQL 查询将返回视频的详细信息，包括用于包含到您的应用程序中的原始视频源的 URL (`src`和`src_hq`)。

# jquery - 获取文本框文本的字符索引

> ID：10739502
> 
> 赞同：0
> 
> 时间：2012-05-24T14:27:30.387
> 
> 标签：jquery, asp.net, vb.net, autocomplete, mask

我试图为我的 jquery 自动完成控件创建一个自定义掩码。

我有一个文本框，其默认文本是这样的`"___-__.__._"`

例如，`a`当光标在“-”之后用户输入时，我想将文本更改为

`"___-a_.__._"`通过用用户按下的键替换“_”`a`

有任何想法吗？

# java - 如何将我单击的 JButton 的组件传输到我单击的第二个 JButton？

> ID：10739509
> 
> 赞同：0
> 
> 时间：2012-05-24T14:27:41.960
> 
> 标签：java, swing, mouseevent, jbutton, mouselistener

我正在制作一个游戏，其中有一个名为 move(int x1, int y1, int x2, int y2) 的方法，它从第一个按钮 (x1,y1) 移动棋子并将其放在第二个按钮 (x2,y2) 上

我如何在 GUI 中编写方法，当我按下第一个时，他等待第二个应用移动？ps（按钮的图标应该在动作完成后改变）

这是我到目前为止写的：

```
package eg.edu.guc.dvonn.gui;

import java.awt.BorderLayout;
import java.awt.Color;
import java.awt.Container;
import java.awt.Dimension;
import java.awt.FlowLayout;
import java.awt.GridLayout;
import java.awt.Image;
import java.awt.TextArea;
import java.awt.TextField;

import java.awt.Font;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.event.MouseEvent;
import java.awt.event.MouseListener;

import javax.swing.Icon;
import javax.swing.ImageIcon;
import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JPanel;

import eg.edu.guc.dvonn.engine.Board;

public class FirstWindow extends JFrame implements ActionListener, MouseListener {
    JButton Startbutton;
    JPanel welcomePanel;
    JPanel SecondPanel;
    JPanel StandardPanel;
    JPanel custPanel;
    JPanel  panelFill;
    JButton Standard;
    JButton fill;
    JButton put;
    JButton clear;
    JButton cust;
    JButton beginGame;
    JButton clickedButton = null;
    JLabel label;
    JLabel put2;
    TextField rows;
    TextField col;
    Board b;
    JButton[][] button;
    int r1;
    int cc;

    Icon red = new ImageIcon(getClass().getResource("index.jpg"));
    Icon Black=new ImageIcon(getClass().getResource("black.jpg"));
    Icon white= new ImageIcon(getClass().getResource("images.jpg"));

         public FirstWindow(){

             setSize(800,600);
             setVisible(true);
             setLayout(new BorderLayout());

             setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

              welcomePanel = new JPanel();
              welcomePanel.setLayout(new BorderLayout());
              label  = new JLabel("Welcome to Dvonn");
              welcomePanel.add(label, BorderLayout.NORTH);
              welcomePanel.setVisible(true);

             label.setForeground(Color.RED);
             label.setFont(new Font("Serif", Font.PLAIN, 40));

             Startbutton = new JButton ("Start");
             Startbutton.setBackground(Color.BLACK);
             Startbutton.setForeground(Color.RED);
             Startbutton.setFont(new Font("Times New Roman", Font.PLAIN, 40));
             Startbutton.setPreferredSize(new Dimension(120,40));

             welcomePanel.add(Startbutton, BorderLayout.CENTER);

             add(welcomePanel);

             Startbutton.addActionListener(this);

             SecondPanel = new JPanel();
             SecondPanel.setVisible(false);
             SecondPanel.setSize(400,400);
              rows = new TextField();
              col= new TextField();
              SecondPanel.add(rows);
              SecondPanel.add(col);

              fill = new JButton("Fill random");
              fill.addActionListener(this);
              fill.setBackground(Color.LIGHT_GRAY);
              fill.setForeground(Color.BLUE);

          /*    
              put = new JButton("Put");
              put.setBackground(Color.LIGHT_GRAY);
              put.setForeground(Color.BLUE);
            */  
              put2 = new JLabel("Place Pieaces Manually on the Board or Choose Fill Random");
              put2.setBackground(Color.LIGHT_GRAY);
              put2.setForeground(Color.BLUE);

              clear = new JButton("Clear Board");
              clear.addActionListener(this);
              clear.setBackground(Color.LIGHT_GRAY);
              clear.setForeground(Color.BLUE);

              beginGame = new JButton("Start The Game");
              beginGame.addActionListener(this);
              beginGame.setBackground(Color.LIGHT_GRAY);
              beginGame.setForeground(Color.BLUE);
              beginGame.setVisible(false);

              Standard = new JButton("Standardised board");
              Standard.setBackground(Color.LIGHT_GRAY);
              Standard.setForeground(Color.BLUE);
              Standard.addActionListener(this);
              Standard.addMouseListener(this);

              cust = new JButton("customized");
              cust.setBackground(Color.LIGHT_GRAY);
              cust.setForeground(Color.BLUE);
              cust.addActionListener(this);
              cust.addMouseListener(this);

              panelFill = new JPanel();

              panelFill.add(fill);
        //    panelFill.add(put2);
              panelFill.add(clear);
              panelFill.add(beginGame);
              SecondPanel.add(Standard);
              SecondPanel.add(cust);

                this.r1 =5;
                this.cc = 11;
                b = new Board(r1,cc);
                button = new JButton [r1][cc];
                StandardPanel = new JPanel();
                StandardPanel.setBackground(Color.WHITE);
                StandardPanel.setLayout(new GridLayout(r1, cc));
                for (int i = 0; i <= r1 - 1; i++) {
                    for (int j = 0; j <= cc - 1; j++) {
                        button[i][j] = new JButton("Place");
                        button[i][j].addActionListener(this);
                    }
                }
                for (int i = 0; i <= r1 - 1; i++) {
                    for (int j = 0; j <= cc - 1; j++) {

                        button[i][j].setLayout(new FlowLayout());
                        button[i][j].setBackground(Color.WHITE);

                        StandardPanel.add(button[i][j], i, j);

                    }
                }

         }  

         public FirstWindow(int row,int cols){

             setSize(800,600);
             setVisible(true);
             setLayout(new BorderLayout());

             setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

              fill = new JButton("fill random");
              fill.addActionListener(this);
              fill.setBackground(Color.LIGHT_GRAY);
              fill.setForeground(Color.BLUE);

           /*   
              put = new JButton("put");
              put.setBackground(Color.LIGHT_GRAY);
              put.setForeground(Color.BLUE);
             */ 
              put2 = new JLabel("Place Pieaces Manually on the Board or Choose Fill Random");
              put2.setBackground(Color.LIGHT_GRAY);
              put2.setForeground(Color.BLUE);

              clear = new JButton("Clear Board");
              clear.addActionListener(this);
              clear.setBackground(Color.LIGHT_GRAY);
              clear.setForeground(Color.BLUE);

              Standard = new JButton("Standardised board");
              Standard.setBackground(Color.LIGHT_GRAY);
              Standard.setForeground(Color.BLUE);
              Standard.addActionListener(this);
              Standard.addMouseListener(this);

              cust = new JButton("customized");
              cust.setBackground(Color.LIGHT_GRAY);
              cust.setForeground(Color.BLUE);
              cust.addActionListener(this);
              cust.addMouseListener(this);

              panelFill = new JPanel();
              panelFill.add(fill);
        //    panelFill.add(put2);
              panelFill.add(clear);

            this.r1 = row;
            this.cc = cols;

                 b = new Board(r1,cc);  

                button = new JButton [r1][cc];

                custPanel = new JPanel();
                custPanel.setBackground(Color.WHITE);
                custPanel.setLayout(new GridLayout(r1, cc));

                for (int i = 0; i <= r1 - 1; i++) {
                    for (int j = 0; j <= cc - 1; j++) {
                        button[i][j] = new JButton("Place");
                        button[i][j].addActionListener(this);
                    }
                }
                for (int i = 0; i <= r1 - 1; i++) {
                    for (int j = 0; j <= cc - 1; j++) {

                        button[i][j].setLayout(new FlowLayout());
                        button[i][j].setBackground(Color.WHITE);
                        custPanel.add(button[i][j], i, j);

                    }
                }
                add(custPanel);
                add(panelFill,BorderLayout.SOUTH);

         }
         public boolean checkBoard() { // checks if the board is full or not to start the game and the move process
        //   boolean fullBoard = false;
             for (int i = 0; i < this.r1; i++) {
                 for ( int j = 0; j < this.cc; j++) {
                     if(button[i][j].getIcon() == null) {
                         return true;
                     }
                 }

             }
             return false;
         }

         public static void main  (String [] args){
             FirstWindow window = new FirstWindow();

         }
        @Override
        public void actionPerformed(ActionEvent e) {

            if (e.getSource()==Startbutton){

                this.remove(welcomePanel);
                this.add(SecondPanel);
                SecondPanel.setVisible(true);
                //this.add(SecondPanel);

                JLabel label1 = new JLabel("dvonn");
                label1.setForeground(Color.RED);
                label1.setFont(new Font("Serif", Font.PLAIN, 25));
                SecondPanel.add(label1);

                }

                if(e.getSource()== cust){
                   String rowText = rows.getText();
                   String colText = col.getText();

                   r1 = Integer.parseInt(rowText);
                   cc = Integer.parseInt(colText);
                   this.setVisible(false);

                FirstWindow custom = new FirstWindow(r1, cc);

                 } 
                      if(e.getSource()==Standard){ //places the standard panel
                         SecondPanel.setVisible(false); // set the second panel invisible
                         this.add(StandardPanel); //to add the panel with the buttons
                         StandardPanel.setVisible(true);

                         add(put2, BorderLayout.NORTH);
                         add(panelFill,BorderLayout.SOUTH);
                         add(StandardPanel,BorderLayout.CENTER);

                     } 

                if (e.getSource() == fill) { //randomly fills the board
                         b.fillRandom();

                  for (int i = 0; i <=r1-1; i++) {
                    for (int j = 0; j <=cc-1; j++) {
                        if (b.getColor(i, j)==0){
                            button[i][j].setIcon(red);

                        } else if (b.getColor(i, j) == 1) {
                            button[i][j].setIcon(white);
                        } else if (b.getColor(i, j) == 2) {
                            button[i][j].setIcon(Black);
                        }   
                    }
                    }

                  beginGame.setVisible(true); 

                     }

                        if (e.getActionCommand().equals("Place")) {

                        // u press on the button to manually place a piece
                            for(int i=0; i< this.r1; i++){

                             for (int j = 0; j < cc; j++) {
                              if(e.getSource() == button[i][j]){
                               b.put(i, j);
                               if (b.getColor(i, j) == 0) {
                                   button[i][j].setText("");
                                   button[i][j].setIcon(red);
                                   if (checkBoard()) {
                                    beginGame.setVisible(true);   
                                   }
                                   break;
                               } else {
                               if (b.getColor(i, j) == 1) {
                                   button[i][j].setText("");
                                   button[i][j].setIcon(white);
                                   if (checkBoard()) {
                                        beginGame.setVisible(true);   
                                   }
                                   break;
                               } else {
                                   button[i][j].setText("");
                                  button[i][j].setIcon(Black);
                                  if (checkBoard()) {
                                        beginGame.setVisible(true);   
                                    }
                                  break;

                            }
                         }
                     }
                   }
                        }
                         }

                if (e.getSource() == clear) {

                    for (int i = 0; i <= r1 - 1; i++) {
                        for (int j = 0; j <= cc - 1; j++) {
                        button[i][j].setIcon(null); 
                        if (button[i][j].getText().equals("")) {
                            button[i][j].setText("Place");
                        }
                        }
                    }

                }

              if (e.getSource() == beginGame) {  //begins the move part
                  b.currentPhase = 2;
                  panelFill.setVisible(false);
                  remove(panelFill);

              }

            }

        public void mouseClicked(MouseEvent e) { //move mouselistener

            if (b.getCurrentPhase() == 2) {

             if (clickedButton == null) { 

                    clickedButton = button[e.getX()][e.getY()];
                }
                else {
                    // second button, so do the 'move'
                    int x1 = clickedButton.getX();
                    int y1 = clickedButton.getY();
                    int x2 = e.getX();
                    int y2 = e.getY();
                    b.move(x1, y1, x2, y2);
                    if (button[x1][y1].getIcon() == red) {
                        button[x2][y2].setIcon(red);
                        button[x1][y1].setIcon(null);
                    }
                    if (button[x1][y1].getIcon() == white) {
                        button[x2][y2].setIcon(white);
                        button[x1][y1].setIcon(null);
                    }if (button[x1][y1].getIcon() == Black) {
                        button[x2][y2].setIcon(Black);
                        button[x1][y1].setIcon(null);
                    }
                    // clear the clickedButton so that we know the next click is a first click
                    clickedButton = null;
                }
            }

        }

        @Override
        public void mouseEntered(MouseEvent e) {
            // TODO Auto-generated method stub

        }

        @Override
        public void mouseExited(MouseEvent e) {
            // TODO Auto-generated method stub

        }

        @Override
        public void mousePressed(MouseEvent e) {
            // TODO Auto-generated method stub

        }

        @Override
        public void mouseReleased(MouseEvent e) {
            // TODO Auto-generated method stub

        }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T14:35:40.017

您应该有一个全局变量来保存对单击的第一个按钮的引用，然后在单击第二个按钮时使用它。例如...

```
JButton clickedButton = null;

public void mouseClicked(MouseEvent e){
    if (clickedButton == null){
        // first button clicked - so remember the button
        clickedButton = (JButton)e.getSource();
    }
    else {
        // second button, so do the 'move'
        JButton secondButton = (JButton)e.getSource();
        doMove(clickedButton,secondButton);

        // clear the clickedButton so that we know the next click is a first click
        clickedButton = null;
    }
} 
```

在这段代码中，我们有一个`JButton`全局变量。当这个变量是`null`时，我们知道用户还没有点击任何东西。当变量有值时，我们就知道用户点击了第一个按钮，也就是这个变量的值。

所以，当`mouseClicked()`事件被触发，并且`clickedButton`变量有一个值时，我们知道刚刚被点击`move`的`clickedButton`按钮（第二个按钮）。

* * *

请注意，我们将 a 强制转换`e.getSource()`为 a`JButton`而没有首先检查它是否实际上是 a `JButton`。我没有在上面的代码中包含它，因为它会使它复杂化，但你应该在做这些演员之前先检查一下，就像这样......

```
Object sourceObject = e.getSource();
if (sourceObject instanceof JButton){
    JButton button = (JButton)sourceObject;
    // other processing code
} 
```

如果在不是`JButton`.

* * *

我希望这有点道理 - 如果您需要更好的解释，请告诉我。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T15:02:18.007

[在JButton](http://docs.oracle.com/javase/tutorial/uiswing/components/button.html#jbutton)里面添加[Swing Action](http://docs.oracle.com/javase/tutorial/uiswing/misc/action.html)或者[ActionListener](http://docs.oracle.com/javase/tutorial/uiswing/events/actionlistener.html)来调用`anotherButton.doClick()`

# google-drive-api - 无需在 Google Chrome 商店注册即可使用 Google Drive API

> ID：10739512
> 
> 赞同：0
> 
> 时间：2012-05-24T14:27:53.507
> 
> 标签：google-drive-api

我可以在不在 Google Chrome 商店中注册我的扩展程序的情况下使用 Google Drive API 吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-25T06:42:46.817

是的你可以。您的应用只需要在 API 控制台中注册。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T13:15:01.810

您需要在[API 控制台](https://code.google.com/apis/console)中为 Web 应用程序创建一个客户端 ID并定义回调 URL。基本上它首先要让 oAuth 工作......然后你就可以真正*使用*它了。

Drive API 必须在“服务”下启用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T18:45:46.627

更新：这同时发生了变化，Drive API v1 也是如此。

不可以。您可以为此目的使用 Documents List API。

# jquery - 更改主父元素内子 div 的顺序

> ID：10739513
> 
> 赞同：1
> 
> 时间：2012-05-24T14:27:58.280
> 
> 标签：jquery

我有一个`<ul>`看起来像这样的

```
<ul class="class_1 class_2">
    <li class="class1">
        <div class="submission_list_item">
            <div class="sub_list_item_content modal_link" href="url here">
                <div class="facebook_user" style="display:none;"></div>
                <div class="submission_response ">
                    <label></label>
                    <span class="MediaUploadResponse"><img alt="Sample_mpeg4" src="url here"></span> </div>
                <div class="submission_response name">
                    <label>NAME:</label>
                    <span class="Response"></span> </div>
                <div class="submission_response last_name">
                    <label>LAST NAME</label>
                    <span class="Response"></span> </div>
                <div class="submission_response description">
                    <label>DESCRIPTION:</label>
                    <span class="Response"> Test </span> </div>
                <div class="submission_response video_title">
                    <label>VIDEO TITLE:</label>
                    <span class="Response"> Video </span> </div>
            </div>
        </div>
    </li>
    <li class="class1">
        <div class="submission_list_item">
            <div class="sub_list_item_content modal_link" href="url here">
                <div class="facebook_user" style="display:none;"></div>
                <div class="submission_response ">
                    <label></label>
                    <span class="MediaUploadResponse"><img alt="Sample_mpeg4" src="url here"></span> </div>
                <div class="submission_response name">
                    <label>NAME:</label>
                    <span class="Response"></span> </div>
                <div class="submission_response last_name">
                    <label>LAST NAME</label>
                    <span class="Response"></span> </div>
                <div class="submission_response description">
                    <label>DESCRIPTION:</label>
                    <span class="Response"> Test </span> </div>
                <div class="submission_response video_title">
                    <label>VIDEO TITLE:</label>
                    <span class="Response"> Video </span> </div>
            </div>
        </div>
    </li>
</ul> 
```

我想要做的是交换 2 个 div 的顺序，名称和标题在我页面上的每个 <li> 项目中。在 <li> 上尝试了 .each 但没有运气。知道怎么做吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T14:46:47.850

我认为你需要这样的东西：

```
$('ul.class_1 li.class1').each(function() {
  var name = $(this).find('div.name');
  var video_title = $(this).find('div.video_title');
  name.insertAfter($('div.description', this));
  video_title.insertBefore($('div.last_name', this));
}); 
```

**[演示](http://jsfiddle.net/8a4au/2/)**

# crystal-reports - Crystal Reports 2011 中可能导致 Crystal XI 阅读器失败的功能

> ID：10739514
> 
> 赞同：0
> 
> 时间：2012-05-24T14:28:01.703
> 
> 标签：crystal-reports, version, crystal-reports-xi, forward-compatibility

我在 Crystal Reports 2011 (v14) 中开发了一个报表，我需要让它在基于 Crystal Reports XI (v11) 阅读器的应用程序中工作。我正在着手采购 XI，因此我可以在那里调整报告，但同时，如果我能让 2011 年开发的报告能够正常工作，那就太好了。由于[此答案](https://stackoverflow.com/a/8124939/179)中引用了前向兼容性说明，我希望这会起作用。

当我尝试在基于 XI 的应用程序中运行我的报告时，我得到

> 错误：-2147206429
> 
> TLV 记录无效。
> 
> 在模块中：Crystal Reports ActiveX 设计器

我怀疑我的报告在 2011 年使用了 XI 中不存在的某些功能，并且以某种方式阻碍了 XI 阅读器引擎。2011年我拿了一个在XI开发的报表打开保存，在XI打开没有问题。

2011 年有哪些功能而不是 XI 可能会让我在这里绊倒？我应该检查我的报告以使其最有可能在 XI 中运行？

更新：我尝试重建我的报告，一次一个功能，以查看错误何时出现在 XI 上。只要我将参数的提示组创建为查询存储过程或表的动态列表，即使我没有设置提示组的任何特殊特征，它也会这样做。鉴于动态参数提示组与 XI 一起出现，这不应该工作吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T15:41:54.417

没有多少——正如你所说——我一直发现它们是完全向后兼容的。

想到的主要事情是动态排序控制和创建可选参数的能力。

如果您想附上报告，我可以尝试打开/保存/检查。

# sql - 倒选TOP *

> ID：10739523
> 
> 赞同：4
> 
> 时间：2012-05-24T14:28:26.717
> 
> 标签：sql, sql-server, sql-server-2008, tsql, sql-server-2005

你知道什么时候你有那么大的日志表，你只需要查看最后 X 行就知道当时发生了什么？

通常你可以这样做：

```
select top 100 * 
from log_table
order by ID desc 
```

显示最新的 100 条记录，但它会以相反的顺序显示（当然，因为 DESC 的顺序），例如：

```
100010
100009
100008
and so on.. 
```

但为了简单起见，我想查看它们发生的顺序的记录。我可以通过运行以下查询来做到这一点：

```
select * 
from(
    select top 100 * from log_table order by ID desc
    ) a
order by a.id 
```

我通过 ID desc 获得前 100 个订单，然后反转结果集。它有效，但似乎没有必要运行 2 select 来产生这个结果。

我的问题是：有没有人对此有更好的想法？就像桌子末端的精选顶部一样？

编辑：两个查询的执行计划：看起来亚历克斯的想法很好，但大卫也是对的，只有一个选择和一个排序 ![在此处输入图像描述](../Images/880993a665b1bec3edbb2a7824d1871c.png)

EDIT2：设置统计IO ON：

```
(10 row(s) affected)
Table 'sysdtslog90'. Scan count 1, logical reads 3, physical reads 0, read-ahead reads 0, lob logical reads 12, lob physical reads 0, lob read-ahead reads 0.

(1 row(s) affected)

(10 row(s) affected)
Table 'sysdtslog90'. Scan count 2, logical reads 5, physical reads 0, read-ahead reads 0, lob logical reads 12, lob physical reads 0, lob read-ahead reads 0.

(1 row(s) affected) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-24T14:36:14.760

> 但似乎没有必要运行 2 select 来产生这个结果。

错误的。有必要。

更多详细信息：查看查询的估计执行计划。它可能看起来像 ClusteredIndexScan -> Top -> 只有一个排序。内部查询的 OrderBy 不执行排序，它只是指示执行从表的“背面”读取。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-24T14:52:06.770

如果`id`索引和顺序足够，最快的方法可能是；

```
select * from log_table where id > (select max(id) from log_table) - N 
```

但是，仍然需要明确的 order by 来保证订单。

# javascript - IE 错误触发点击 2 个按钮？

> ID：10739525
> 
> 赞同：8
> 
> 时间：2012-05-24T14:28:33.457
> 
> 标签：javascript, jquery, forms, internet-explorer, javascript-events

当用户按下回车键时，我试图触发提交按钮。适用于除 Internet Explorer 9 之外的所有浏览器。奇怪的是，IE 坚持还触发点击另一个我从未告诉过它的按钮。我做错了什么或如何解决这个问题？

下面是我的代码。在 IE 中按 enter 会按预期触发提交单击，但由于某种原因也会触发“某些按钮”单击（即使没有我的按键侦听器）：

```
$('input[type=submit]').click(function () {
    alert('Submit click');
});

//SIMULATE CLICK IF ENTER PRESSED IN SEARCH
$('input[type=text]').keypress(function (event) {
    var keycode = event.keyCode || event.which;
    if (keycode == 13) $('input[type=submit]').click();
});

//ROUTE CLEAR HANDLER
$('button').click(function () {
    alert('Button click');
}); 
```

你可以在这里看到这个错误：http: [//jsfiddle.net/h64xD/](http://jsfiddle.net/h64xD/)

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-05-24T14:42:49.503

这里有几点需要考虑：

IE9 默认计算`<button/>`元素`type="submit"`。因此，要使其不提交，您必须明确：

```
<button type="button">Some button</button> 
```

如果这样做，您会注意到模拟`click`事件现在不会触发`<button/>`但仍会触发 2 个事件。原因是，因为您没有明确定义`<form/>`元素，IE9 假定控件在表单中，因此按下`enter`文本框会触发 2 个事件：

*   你正在模仿的那个
*   默认表单提交按钮行为

所以再次解决这个问题，你必须明确：

```
<button type="button">Some button</button>
<form><input type="text" /></form>
<input type="submit" value="Submit" /> 
```

现在，这些就是您在 IE 中看到这种行为的原因。[@MrSlayer](https://stackoverflow.com/a/10739803/476786)的答案迎合了第二个问题，即`keypress`在您满意地处理事件后停止事件，使用`preventDefault()`

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-24T14:45:23.637

Enter 键具有提交的默认行为，因此您需要阻止执行默认行为。因为`button`标签默认`type="submit"`是在按下 Enter 键时执行该按钮。

```
//SIMULATE CLICK IF ENTER PRESSED IN SEARCH
$('input[type=text]').keypress(function (event) {
    var keycode = event.keyCode || event.which;
    if (keycode == 13)
    {
        event.preventDefault();
        $('input[type=submit]').click();
    }
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-24T14:32:10.210

如何触发表单的提交而不是单击按钮？

```
$('input[type=text]').keypress(function(e) {
     var keycode = event.keyCode || event.which,
         frm = $(this).closest('form');

     if (keycode == 13) {
          e.stopPropagation();
          frm.submit();
          return false;
     }
     return true;
}); 
```

- 编辑 -

稍微更新以停止事件传播。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-24T15:07:25.460

首先，当用户按下时，您不需要手动附加事件来提交表单`enter`- 浏览器已经处理了。

奇怪的是，这与元素的顺序、隐式表单关联以及 IE 将按钮作为提交元素处理这一事实有关。

尝试交换这些按钮的顺序以了解我的意思：

```
<input type="text" />
<input type="submit" value="Submit" />
<button>Some button</button> 
```

自然地，浏览器已经被指示监听以响应`Enter`文本输入。这会导致浏览器*单击*相关的提交按钮。此外，由于您没有`form`通过`form`属性明确提供 a 或相互关联的元素，因此浏览器正试图为您建立这种关系。

在您的代码中，该`<button>`元素被假定为文本输入的提交按钮（因为它是隐式表单中的第一个提交按钮）。因此，每当您按下`Enter`文本输入时，浏览器自然会引发相关按钮的单击事件。

如果您像我上面所说的那样重新排序元素，我们会看到相反的情况发生。IE 将另一个`<input>`元素与文本框相关联。按下`Enter`文本框会隐式引发提交输入的点击事件。

`.form`您可以通过比较各种元素的属性来确认此行为。例如，添加一些`id`值将使我们更容易访问这些值：

```
<button id="fiz">Some Button</button>
<input  id="foo" type="text" />
<input  id="bar" type="submit" value="Submit" /> 
```

然后运行一些快速比较：

```
var button = document.getElementById("fiz"); 
var text = document.getElementById("foo"); 
var submit = document.getElementById("bar"); 

button.form === text.form;   // true 
submit.form === text.form;   // true 
button.form === submit.form; // true 
```

`<button>`所以最后，您可以通过将元素声明为`type='button'`或将其放在预期的提交按钮之后来消除两个按钮之间的歧义。

# javascript - 文本区域中的粗体文本？

> ID：10739536
> 
> 赞同：-1
> 
> 时间：2012-05-24T14:29:02.810
> 
> 标签：javascript, jquery

> **可能重复：**
> [textarea 中的粗体文本](https://stackoverflow.com/questions/3322895/bold-text-in-textarea)

我的用户正在输入文本区域，使用 js，他们能够在该区域内创建 url 链接，有没有办法将文本区域中的文本加粗，以便用户可以看到他们在哪里创建了链接？

还是有更好的解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T14:31:24.627

您是否考虑过[所见即所得的编辑器](http://www.smashingmagazine.com/2008/05/06/25-wysiwyg-editors-reviewed/)？例如，您在此站点中输入问题的编辑器是[WMD](http://code.google.com/p/wmd/)，它允许将文本加粗。

# email - Magento：核心在客户被保存后发送欢迎邮件

> ID：10739538
> 
> 赞同：0
> 
> 时间：2012-05-24T14:29:20.097
> 
> 标签：email, magento, admin, backend

我注意到以下错误：

当我使用管理后端向客户添加地址时，或者如果我更改地址并保存客户，Magento Costumer AccountController 会向更新后的客户发送标准电子邮件。使用的电子邮件模板是“已确认”客户事件的模板。当我更新客户时，总是会发生这种情况。

有人有同样的问题或解决方案吗？我不明白为什么magento会为此事件发送电子邮件...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T09:18:41.560

类：`Mage_Adminhtml_CustomerController`扩展`Mage_Adminhtml_Controller_Action`

方法：`saveAction()`

解决方案：这是旧版本的核心错误。保存客户后发送邮件的条件使用`isset($sendPassToEmail)`. 但是，如果您注意到，`sendPassToEmail`变量总是被设置并且具有值 true 或 false。因为`isset()`条件始终为真，每次保存客户时都会发送一封电子邮件。

...

```
 $sendPassToEmail = false;
            // force new customer active
            if ($isNewCustomer) {
                $customer->setPassword($data['account']['password']);
                $customer->setForceConfirmed(true);
                if ($customer->getPassword() == 'auto') {
                    $sendPassToEmail = true;
                    $customer->setPassword($customer->generatePassword());
                }
            }

            Mage::dispatchEvent('adminhtml_customer_prepare_save', array(
                'customer'  => $customer,
                'request'   => $this->getRequest()
            ));

            $customer->save();

            // send welcome email
            if ($customer->getWebsiteId() && (!empty($data['account']['sendemail']) || isset($sendPassToEmail))) {
                $storeId = $customer->getSendemailStoreId();
                if ($isNewCustomer) {
                    $customer->sendNewAccountEmail('registered', '', $storeId);
                }
                // confirm not confirmed customer
                else if ((!$customer->getConfirmation())) {
                    $customer->sendNewAccountEmail('confirmed', '', $storeId);
                }
            } 
```

# sql - 动态更新语句

> ID：10739540
> 
> 赞同：-1
> 
> 时间：2012-05-24T14:29:26.383
> 
> 标签：sql, sql-update, inner-join

我想创建一个动态更新查询，我需要在列中设置某个值。但是需要从另一个表中选择列名。我已经有以下查询：

```
UPDATE core.TableRes
SET (
    SELECT Code FROM core.TableFields 
    INNER JOIN core.TableXTableFields ON TableXTableFields.FieldID = TableFields.FieldID 
    INNER JOIN core.TableResRefLinks ON TableResRefLinks.ExtraFieldID = TableXTableFields.ExtraFieldID 
    WHERE TableResRefLinks.TableResRefLinksID = RefLinks.TableResRefLinksID)
= (
    SELECT Value FROM core.TableResRefLinks WHERE TableResRefLinksID = RefLinks.TableResRefLinksID)
FROM core.TableRes
    INNER JOIN core.TableResRefLinks RefLinks ON RefLinks.ResourceID = TableRes.ResourceID
    INNER JOIN core.TableXTableFields ON TableXTableFields.ExtraFieldID = RefLinks.ExtraFieldID
    INNER JOIN core.TableFields ON TableFields.FieldID = TableXTableFields.FieldID
    WHERE (EndDate IS NULL OR EndDate > GETDATE()) AND
    (
        SELECT Code FROM core.TableFields 
        INNER JOIN core.TableXTableFields ON TableXTableFields.FieldID = TableFields.FieldID 
        INNER JOIN core.TableResRefLinks ON TableResRefLinks.ExtraFieldID = TableXTableFields.ExtraFieldID 
        WHERE TableResRefLinks.TableResRefLinksID = RefLinks.TableResRefLinksID) 
    <>
    (
        SELECT Value FROM core.TableResRefLinks 
        WHERE TableResRefLinksID = RefLinks.TableResRefLinksID) 
```

它给了我以下错误：

```
Msg 102, Level 15, State 1, Line 2
Incorrect syntax near '('.
Msg 102, Level 15, State 1, Line 3
Incorrect syntax near '='.
Msg 156, Level 15, State 1, Line 5
Incorrect syntax near the keyword 'FROM'.
Msg 102, Level 15, State 1, Line 14
Incorrect syntax near '<'. 
```

有没有办法解决这个问题？如果我更改完整的 UPDATE 和 SET 语句并用 SELECT * 替换它们，我会得到结果。

编辑
这里是数据类型TableFields.Code
=> nvarchar(100)
TableResRefLinks.Value => sql_variant
并且列名 TableFields.Code 的列的数据类型设置为 sql_variant

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T14:33:20.440

您无法使用纯 SQL 解决此问题。您需要某种脚本来构建您的语句。例如，postgresql 有一种称为“pgpsql”的脚本语言，它允许构建动态 SQL 语句。但这显然取决于底层的 RDBMS。

顺便说一句：这适用于 SELECT，因为您正在执行简单的子选择。

# java - 当路径指向 JAR 文件 [Jasper Reports 4.5] 时，将 SUBREPORT_DIR 传递给子报告

> ID：10739547
> 
> 赞同：2
> 
> 时间：2012-05-24T14:30:00.617
> 
> 标签：java, jasper-reports, ireport

我在将`SUBREPORT_DIR`路径传递给我的子报告时遇到问题。这些报告实际上在同一个文件夹中，但在一个 JAR 文件中。我试过这样的事情（可能不准确）：

```
parameterList = new HashMap<String, Object>();

URL mainReport = this.getClass().getResource("mainReport.jasper");
String mainReportPath = mainReport.getPath();
String subreportDir = mainReportPath.substring(0, mainReportPath.lastIndexOf("/")+1);

parameterList.put("SUBREPORT_DIR", subreportDir); 
```

此路径指向 JAR 文件内，但我`net.sf.jasperreports.engine.JRException: Resource not found at : ...`在生成报告时得到。我怎样才能使这项工作？

**编辑**：

我试图在没有 的情况下定义我的子报表`SUBREPORT_DIR`，但没有运气：

```
<subreport>
      <reportElement x="0" y="32" width="475" height="17"/>
      <dataSourceExpression><![CDATA[new net.sf.jasperreports.engine.data.JRBeanCollectionDataSource($F{current})]]></dataSourceExpression>
      <subreportExpression><![CDATA["mysubreport.jrxml"]]></subreportExpression>
</subreport> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-30T07:10:36.337

我的主要问题是，我使用的是 Jasper 不知道的自定义 JAR 加载器。好消息是也可以将子报告作为`java.net.URL`or传递`java.io.InputStream`：

Java代码：

```
InputStream subInputStream = this.getClass().getResourceAsStream("sub.jasper");
parameterList.put("SUBREPORT_INPUT_STREAM", subInputStream); 
```

JRXML：

```
<subreportExpression class="java.io.InputStream"><![CDATA[$P{SUBREPORT_INPUT_STREAM}]]></subreportExpression> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-25T00:11:03.940

完全删除它可能是最容易的`SUBREPORT_DIR`。iReport 默认添加它是为了方便跟踪您的子报表。但你不需要保留它。

在您的情况下，报告位于同一目录和 .jar 中，因此它们将位于类路径中。`$P{SUBREPORT_DIR} + "mysubreport.jasper"`将.jrxml 中的引用从 更改为 simple `"mysubreport.jasper"`。然后从报告中删除参数并摆脱试图找出要使用的目录的代码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-24T21:33:02.583

如果我没记错的话，您应该能够仅根据 jar 中已编译 jasper 文件的位置来引用子报告。例如，如果子报表位于以您应该能够传入`test.reports`的值命名的包中。`SUBREPORT_DIR``/test/reports/`

如果这不起作用，请尝试将编译的报告移动到默认包中，然后设置`SUBREPORT_DIR`为`/`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-09-10T14:51:32.700

在主文件中子报表对象的“KEY”属性中，尝试分配子报表文件中定义的子报表名称，这样子报表的值就会返回给主报表。

# javascript - 正则表达式 .test 总是返回 false

> ID：10739549
> 
> 赞同：4
> 
> 时间：2012-05-24T14:30:10.430
> 
> 标签：javascript, regex, escaping

```
var str = "1405199610";
var re = new RegExp("\d{10}");
var myArray = re.test(str); 
```

myArray 给出错误！

这怎么可能？我用在线正则表达式检查器对此进行了测试，结果正常。当我在控制台或 jsfiddler 中尝试时，它不起作用。我错过了什么吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-24T14:30:50.330

```
var re = new RegExp("\\d{10}"); 
```

您需要转义`\`何时由`RegExp()`对象创建正则表达式

请参阅[MDN 参考](https://developer.mozilla.org/en/JavaScript/Guide/Regular_Expressions)

> ...此外，在使用新的 RegExp("pattern") 表示法时不要忘记转义 \ 本身，因为 \ 也是字符串中的转义字符。

# iphone - 如何在分组样式表中设置单元格的高度？

> ID：10739555
> 
> 赞同：1
> 
> 时间：2012-05-24T14:30:41.600
> 
> 标签：iphone, uitableview

我使用界面生成器制作了一个包含两种类型的自定义单元格的表格：

![在此处输入图像描述](../Images/536422b6f72181f4f191e91479bdc525.png)

一切正常，除了下部单元格的高度与其上方的单元格相同。它有我放的一切 - UIImageView 等......

所以我在想，当表格样式被分组时，是否不能改变单元格高度？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T14:36:31.840

```
- (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath  *)indexPath{

   if (indexPath.row == 1) {

   return 100;
   }

   return 44;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-24T14:53:21.853

我们可以使用 UITableview 委托方法：

```
- (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath
{
   if (indexPath.row == 1)
      {
          return 60;
      }
   else
      {
          return 44;
      }
 } 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-25T07:46:07.627

你必须使用这个

```
- (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath 
```

{ 返回 75.0f;

}

它对我来说已经用完了。

# php - 如何在两列中显示查询数据？

> ID：10739556
> 
> 赞同：1
> 
> 时间：2012-05-24T14:30:42.170
> 
> 标签：php

```
$query = $this->db->get("table_name");
foreach ($query->result() $row)
{
    echo $row->data;
} 
```

它显示像 1 2 3 4 这样的数据，我需要像 12 34 这样的两个列

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T14:35:34.483

试试这个：

```
$nm = 0;
$str = '';

$query = $this->db->get("table_name");
foreach ($query->result() $row)
{
   $nm++;
   $str .= $row->data;
   if($nm%2==0){
    echo $str;
    $str = '';
   }
} 
```

# silverlight-5.0 - Silverlight 5 受信任的浏览器内应用程序是否支持 MDI 窗口？

> ID：10739557
> 
> 赞同：2
> 
> 时间：2012-05-24T14:30:42.913
> 
> 标签：silverlight-5.0

我知道 Silverlight OOB 应用程序支持它们，但是完全信任浏览器的情况是什么？

例如，您可以单击交易应用程序中的股票链接，我们会弹出窗口，向您显示有关股票价格的一些详细信息，例如实时更新图表等...

我们希望这是一个真正的窗口，而不是 SL 中的 Javascript 弹出窗口或 ChildWindow。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T07:47:03.190

从这个博客（链接自 silverlight.net）：http: [//10rem.net/blog/2011/04/13/silverlight-5-working-with-operating-system-windows](http://10rem.net/blog/2011/04/13/silverlight-5-working-with-operating-system-windows)和官方 Silverlight 博客：[http:// www.silverlightshow.net/items/10-Laps-around-Silverlight-5-Part-6-of-10.aspx](http://www.silverlightshow.net/items/10-Laps-around-Silverlight-5-Part-6-of-10.aspx)它似乎是 OOB 唯一的功能。

# python - 计算python中列表的平均值，不包括文字

> ID：10739558
> 
> 赞同：1
> 
> 时间：2012-05-24T14:30:43.103
> 
> 标签：python, list, average, literals, mean

在 Python 中，我有一个列表列表，如下所示：

```
[[1,2,3, 'L'], ['L'], [1]] 
```

我想为每个子列表计算所有数字元素的平均值。因此应排除值“L”。上述示例的结果应该是：

```
[2, [], 1] 
```

有什么快速的方法可以在一行中做到这一点吗？

谢谢。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-24T14:34:23.700

为了得到你要求的确切结果，我会这样做：

```
from __future__ import division
import numbers
def average_over_numeric_values(a):
    filtered = [x for x in a if isinstance(x, numbers.Number)]
    if filtered:
        return sum(filtered) / len(filtered)
    return []
print(map(average_over_numeric_values, list_of_lists)) 
```

这不完全是单行的，而是一种非常易读的方式。

`[]`就个人而言，如果列表中没有空值，我不会使用结果 -`None`似乎更合适。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-24T14:44:22.170

假设您已经导入了`numpy`和`numbers`. 没有数字元素的列表显示为`nan`结果列表。

```
[numpy.mean([x for x in sublist if isinstance(x, numbers.Number)]) for sublist in mainlist] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-24T14:53:37.647

鉴于：

```
x = [[1,2,3, 'L'], ['L'], [1]] 
```

如果您必须使用单线：

```
[sum(w)/float(len(w)) if w else w for w in [[z for z in y if isinstance(z, numbers.Number)] for y in x]] 
```

# c# - SPSite 类 - MSDN 文档

> ID：10739565
> 
> 赞同：-2
> 
> 时间：2012-05-24T14:31:03.287
> 
> 标签：c#, sharepoint, msdn

我意识到这是一个愚蠢的问题，但无法从我的网络访问 MSDN `"Server Error: 502 - Web server received an invalid response while acting as a gateway or proxy server."`，我不能只是坐在这里摆弄我的拇指。

我知道没有 MSDN 的替代品，而且我本地的 Visual Studio 帮助在这个类上没有任何东西。

请有人复制并粘贴`Microsoft.Sharepoint` `SPSite`类的条目，特别是构造函数，但整篇文章会很有用。我得到一个 FileNotFoundException 并且需要知道应该如何格式化 URL 属性。

以防你们中的任何人碰巧知道。

```
 public Dictionary<string, SPFolder> GetFolderCollection(string siteURL, string docLibraryName)
    {
        using (SPSite oSite = new SPSite(siteURL + ":23179"))
        {
            SPWeb oWeb = oSite.OpenWeb();
            SPList oList = oWeb.Lists[docLibraryName];

            SPFolderCollection oFolders = oList.RootFolder.SubFolders;

            foreach (SPFolder folder in oFolders)
            {
                foundFolders.Add(folder.Name, folder);
            }
            return foundFolders;
        }
    } 
```

编辑：干杯，谷歌缓存ftw。

作为记录，我指向的是 IIS 站点根目录，而不是 Sharepoint“站点”。混淆了 Sharepoint 术语。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T14:33:11.670

> 表示 Web 应用程序中的网站集合，包括顶级网站及其所有子网站。每个 SPSite 对象或网站集都在一个 SPSiteCollection 对象中表示，该对象由 Web 应用程序中所有网站集的集合组成。
> 
> 继承层次
> 
> System.Object
> Microsoft.SharePoint.SPSite
> 
> 命名空间：Microsoft.SharePoint
> 
> 程序集：Microsoft.SharePoint（在 Microsoft.SharePoint.dll 中）
> 
> 可用于沙盒解决方案：是
> 
> 在 SharePoint Online 中可用
> 
> [SubsetCallableTypeAttribute] [ClientCallableTypeAttribute(Name = "Site", ServerTypeId = "{E1BB82E8-0D1E-4e52-B90C-684802AB4EF6}")] 公共类 SPSite：IDisposable
> 
> 评论
> 
> 要为 ASP.NET 页面上的特定网站集或控制台应用程序中的特定网站集实例化 SPSite 对象，请使用 SPSite 构造函数，如下所示： C# VB
> 
> SPSite oSiteCollection = new SPSite("Absolute_URL");
> 
> 在 ASP.NET 应用程序中，您可以使用 SPContext 类的 Site 属性返回一个表示当前网站集的 SPSite 对象，如下所示： C#
> 
> SPSite oSiteCollection = SPContext.Current.Site;
> 
> 使用 SPWebApplication 类的 Sites 属性返回一个 SPSiteCollection 对象，该对象表示 SharePoint Web 应用程序中的网站集集合。使用索引器从集合中返回单个网站集。例如，如果将网站集的集合分配给名为 oSiteCollections 的变量，则在 C# 中使用 oSiteCollections[index]，在 Visual Basic 中使用 oSiteCollections(index)，其中 index 是网站集的显示名称或索引号集合。
> 
> 某些对象实现了 IDisposable 接口，您必须避免在不再需要这些对象后将它们保留在内存中。如果您创建自己的 SPSite 对象，则可以使用 Dispose 方法关闭该对象。您也可以改为实现 using 语句，以便 .NET Framework 公共语言运行时 (CLR) 自动释放用于存储网站集的内存，如下所示：C# VB
> 
> 使用 (SPSite oSiteCollection = new SPSite("Absolute_URL") { ... }
> 
> 但是，如果您有对共享资源的引用，例如当对象由 Web 部件中的 GetContextSite 方法提供时，请不要使用任何一种方法来关闭该对象。在共享资源上使用任一方法都会导致发生访问冲突错误。在您引用共享资源的情况下，请改为让 Microsoft SharePoint Foundation 或您的门户应用程序管理该对象。
> 
> 有关良好编码实践的更多信息，请参阅处置对象。
> 
> 重要的
> 
> 如果您安装适用于 Windows SharePoint Services 3.0 的基础结构更新 (KB951695)，如果自定义解决方案在模拟暂停时调用 SharePoint 对象模型，则可能会失败。如果您使用 Windows 身份验证并且您的代码从 Internet 信息服务 (IIS) 工作进程调用 SharePoint 对象模型，则请求必须模拟调用用户的身份。SharePoint Foundation 将 ASP.NET 配置为自动模拟调用用户，但如果您暂停模拟（例如，通过调用 Windows API 的 RevertToSelf 函数或通过调用 System.Security），您的代码可能会意外运行或失败。 Principal.WindowsIdentity.Impersonate 方法并将 IntPtr.Zero 作为用户令牌参数的值传递。即使您的代码没有明确恢复为自我，它可能会在它恢复为自身后被 ASP.NET 调用，例如在实现虚拟路径提供程序时发生；如果您的代码没有模拟调用用户，它可能无法正常运行。
> 
> 线程安全
> 
> 此类型的任何公共静态（在 Visual Basic 中为 Shared）成员都是线程安全的。不保证任何实例成员都是线程安全的。

构造函数：

```
 Name    Description
Public method   SPSite(Guid)    Initializes a new instance of the SPSite class based on the specified ID for a site collection.
Public method   SPSite(String)  Initializes a new instance of the SPSite class based on the specified URL.
Public method   SPSite(Guid, SPUrlZone)     Initializes a new instance of the SPSite class based on the specified site collection GUID and URL zone.
Public method   SPSite(Guid, SPUserToken)   Initializes a new instance of the SPSite class based on the specified site collection GUID and user token.
Public method   SPSite(String, SPUserToken)     Initializes a new instance of the SPSite class based on the specified absolute URL and user token.
Public method   SPSite(Guid, SPUrlZone, SPUserToken)    Initializes a new instance of the SPSite class based on the specified site collection GUID, URL zone, and user token. 
```

# google-app-engine - 视频游戏高分表的 Google App Engine 排序成本

> ID：10739567
> 
> 赞同：0
> 
> 时间：2012-05-24T14:31:07.760
> 
> 标签：google-app-engine, google-cloud-datastore

我正在考虑创建自己的 GAE 应用程序来跟踪玩家在我的电子游戏中的高分。我已经创建了一个简单的应用程序，它允许我发送和恢复前 10 名高分（也就是说，每场比赛只存储 10 个分数），但现在我正在考虑如果事情增长的成本。

假设一个游戏有成千上万的玩家（呵呵，不是我的）。我已经看到像 OpenFeint 这样的应用程序如何能够对您的分数进行排序，并在包含数千个条目的高分表中告诉您确切的排名。例如，您可能是#19623。

为了简单起见，我将创建前 100 名得分表。但是，如果我真的想存储所有分数并保持排序呢？在从数据库中查询分数时简单地对分数进行排序是否有意义？我不这么认为...

这些应用程序是如何实现的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T15:16:05.083

在 GAE 上，只要您为字段编制索引，就很容易返回排序查询。如果您的目标只是找到前 100 个分数，您可以按分数对 100 个实体进行有序查询 - 您将按顺序获得它们。

[https://developers.google.com/appengine/docs/python/datastore/queryclass#Query_order](https://developers.google.com/appengine/docs/python/datastore/queryclass#Query_order)

更难的部分是将数字分配给查询。对于前 100 个实体，您基本上会遍历返回的 100 个实体列表，并在每个实体旁边打印一个数字。

如果您需要查找特定排名的用户，您可以使用光标缩小搜索范围，说出排名#19623 的用户。

你将无法有效地做的是找出单个实体的等级。为了使用内置索引计算排名，您必须查询所有实体，并找到该单个实体在列表中的位置。

进行排名的最懒惰的方法是搜索前 100 名，如果用户在那里，显示他们的排名，如果没有，然后告诉他们他们 > 100。另一种可能性是偶尔进行大查询以获得分数范围，存储这些，然后给用户一个不太准确的（你在前 500 名，前 1000 名等），而没有确切的位置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T05:51:38.473

标准数据库索引——无论是在 App Engine 还是在其他地方——都没有提供一种有效的方法来查找行/实体的排名。一种选择是定期浏览数据库并更新当前排名。但是，如果您希望立即更新排名，基于树的解决方案会更好。[在app-engine-ranklist](http://code.google.com/p/google-app-engine-ranklist/)项目中为 App Engine 提供了一个。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-25T09:04:29.960

TyprX 打字比赛（GWT + App Engine）也有同样的问题。我们没有经过数百万行来存储高分的方式是这样的：

```
 class User {

    Integer day, month, year;
    Integer highscoreOfTheDay;
    Integer highscoreOfMonth;
    Integer highscoreOfTheYear;

  } 
```

这样做您可以通过查询获得每日、每月、每年高分的排序列表。关键是在用户完成游戏时，用他们自己在每个时期的最好成绩来更新他们的记录。

然后我们将结果保存到内存缓存中，瞧。

丹尼尔

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-25T16:08:54.370

我会考虑使用异常处理。每天/每小时的数千个结果中有多少会是前 100 名？保留一个最小/最大前 100 个范围实体（当然是 memcached）。如果在范围内，每个得分都是一个方向，否则另一个方向（任务队列？）如果不是。为什么不将 99% 的非相关工作分流到另一个流程，而无论您的最终设置可能用于更改排名，都只需要处理 100+1 个记录。

# c# - 如何从会话中保存变量并在会话为空时获取？

> ID：10739569
> 
> 赞同：0
> 
> 时间：2012-05-24T14:31:10.970
> 
> 标签：c#, asp.net, .net

我写入会话用户登录。当会话被删除时，我需要在服务器端页面上获取用户登录。我尝试：

```
 private string currentUserLogin;
 protected void Page_Load(object sender, EventArgs e)
 {   
      if (!IsPostBack)
      {
          if (HttpContext.Current.Session["curUserRole"] == null)
          {
               // try to get a "currentUserLogin" varialbe, but it null!
          }
          else
          {
               currentUserLogin = HttpContext.Current.Session["curUserLogin"].ToString();                   
          }
      }
 } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T14:34:48.877

将会话中的信息存储到 cookie 中（具有所需的到期时间）并在会话到期时从 cookie 中检索值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T14:53:33.523

在 Global.asax 中有一个 SessionEnd 事件。我用它来写入用户ID和注销日期/时间到日志文件。

# c# - 如何使一个事件处理程序适用于 C# 中的多个控件？

> ID：10739572
> 
> 赞同：7
> 
> 时间：2012-05-24T14:31:23.627
> 
> 标签：c#, controls

在 Visual Basic 中，我知道该怎么做，但我是 C# 新手，所以你们能告诉我如何使用鼠标悬停创建一个“私有 void”，将相同的事件应用于多个控件吗？有一个例子：

```
private void button1, button2, button3, button4_MouseHover(object sender, EventArgs e)
{
     btn.Image = pic
} 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-05-24T14:34:05.357

只需声明一个事件处理程序并将每个按钮指向它：

```
private void Common_MouseHover(object sender, EventArgs e)
{
     Button btn = sender as Button;
     if (btn != null)
         btn.Image = pic
} 
```

然后在代码或设计器中：

```
button1.MouseHover += Common_MouseHover;
button2.MouseHover += Common_MouseHover;
// .. etc 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-24T14:35:47.033

当您订阅按钮上的事件时，它只是一个标准事件处理程序：

```
button1.Click += myEventHandler; 
```

您可以使用相同的代码为每个按钮添加处理程序：

```
button1.Click += myEventHandler;
button2.Click += myEventHandler;
button3.Click += myEventHandler;
button4.Click += myEventHandler;
button5.Click += myEventHandler;
button6.Click += myEventHandler; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T14:34:29.223

```
button1.MouseOver += OnMouseOver(...)
button2.MouseOver += OnMouseOver(...)
button3.MouseOver += OnMouseOver(...)
button4.MouseOver += OnMouseOver(...) 
```

# xcode - 如何在 iphone 中创建自定义注释和标注

> ID：10739577
> 
> 赞同：0
> 
> 时间：2012-05-24T14:31:28.863
> 
> 标签：xcode, mkmapview, mkannotation, mkannotationview

我想在 MKMapView 上创建自定义注释和标注。我必须创建尺寸更大的注释，并且必须显示三四行文本（标签）。那么如何创建自定义注释和标注气泡。

提前致谢。

阿什什

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-11T14:09:44.497

您应该只重新实现 3 种方法：

自定义您的注释使用：

```
- (MKAnnotationView *)mapView:(MKMapView *)mapView viewForAnnotation:(id)annotation 
```

在这里只需添加您需要的子视图

```
- (void)mapView:(MKMapView *)mapView didSelectAnnotationView:(MKAnnotationView *)view 
```

在这里只需从 superView 中删除您的自定义 callOutView

```
- (void)mapView:(MKMapView *)mapView didDeselectAnnotationView:(MKAnnotationView *)view 
```

查看此[博客](http://www.codigator.com/tutorials/advanced-mapkit-tutorial-for-ios-custom-callout/)了解详细信息

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-08-27T08:36:56.860

你可以使用这个。

```
- (MKAnnotationView *)mapView:(MKMapView *)newMapView viewForAnnotation:(id )newAnnotation {
    MKAnnotationView *a = [ [ MKAnnotationView alloc ] initWithAnnotation:newAnnotation reuseIdentifier:@"PinView"];

    if ( a == nil )
        a = [ [ MKAnnotationView alloc ] initWithAnnotation:newAnnotation reuseIdentifier: @"PinView" ];

    a.image = [ UIImage imageNamed:@"Image.png" ];
    a.canShowCallout = YES;
    a.rightCalloutAccessoryView = [ UIButton buttonWithType:UIButtonTypeDetailDisclosure ];
    UIImageView *imgView = [ [ UIImageView alloc ] initWithImage:[ UIImage imageNamed:@"Image.png" ] ];
    a.leftCalloutAccessoryView = imgView;

    return a;
} 
```

# reportviewer - 为什么 ReportViewer 字段字段的此表达式不起作用？

> ID：10739584
> 
> 赞同：0
> 
> 时间：2012-05-24T14:31:52.443
> 
> 标签：reportviewer, vb.net-2010, report-viewer2010

我的一份报告中有一个计算字段：

```
=IIf(Fields!Log_Total.Value > 0, (Fields!Log_Cost.Value + Fields!Labor_Cost.Value + Fields!Part_Cost.Value + Fields!Other_Costs.Value) / Fields!Log_Total.Value, 0) 
```

就我所看到的一切而言，这是我想要完成的正确语法，基本上，检查零，如果不是零，添加这些并除以这个。当我运行报告时，该字段仅显示为#ERR。上面的所有字段都是数据集的一部分，我知道它工作正常。请帮忙

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T14:34:34.157

表达本身似乎很好。否则，您在启动报告时会立即收到错误消息。

总和中的一个或多个字段是否具有`null`数据源中的值？在这种情况下，总和可能不起作用。

您确定所有值实际上都具有数字类型吗？确保它们都没有作为 a`string`或某物从数据库中返回。

# mysql - 使用 MyISAM 存储引擎的高流量服务器，哪个查询在查询优化方面比较好？

> ID：10739585
> 
> 赞同：1
> 
> 时间：2012-05-24T14:31:54.237
> 
> 标签：mysql, query-optimization, myisam

以下是两个查询。从查询优化的角度来看，哪一个好。

```
//Query 1
UPDATE `table_name` SET `column` = '455' WHERE `row_id` = '433200';

//Query 2
UPDATE `table_name` SET `column` = `column`+1 WHERE `row_id` = '433200'; 
```

谢谢， 约格

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T14:51:37.783

我认为如果您不强制 MySQL 将字符串转换为整数，那么差异将可以忽略不计。如果类型是整数，请不要将值括在引号中：

```
UPDATE `table_name` SET `column` = 455 WHERE `row_id` = 433200; 
```

和

```
UPDATE `table_name` SET `column` = `column` + 1 WHERE `row_id` = 433200; 
```

但是，查询说明了两件不同的事情。第一个是您明确设置值的地方，它不是线程安全的。如果您有两个或多个会话，都试图增加值，无论最后运行的哪个都会设置该值，并且很可能其他值会丢失。例如，如果三个连接同时运行查询，则该值可能只增加一次。为避免这种情况，您必须在 SELECT 之前显式锁定表并在 UPDATE 之后释放它。

增加值的第二个查询是线程安全的。如果三个连接都同时运行查询，则该值将增加三倍。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T14:36:22.137

我建议`row_id`，`column`不是字符串而是整数。如果是这样，为什么您要求 mysql 为您转换类型。

我认为第一个查询更快

在第二个你有 2 额外的操作 - 获得价值和加法

# c# - 自定义 T4 预处理模板

> ID：10739586
> 
> 赞同：0
> 
> 时间：2012-05-24T14:31:55.457
> 
> 标签：c#, t4

# 我正在尝试做的事情

我正在尝试使用 T4 创建邮件消息模板。

我正在使用*预处理模板*，如果我理解正确，如果我想在运行时生成消息而不引入对`Microsoft.VisualStudio.TextTemplating`程序集的依赖，我必须这样做。

因为我想将一些数据传递给我的模板，所以我向它添加了参数：

```
<#@ template language="C#" #>
<#@ parameter name="Param1" type="System.String" #>
<#@ parameter name="Param2" type="System.    
Lorem <#= Param1 #> dolor <#= Param2 #> 
```

然后我可以生成这样的消息传递参数：

```
static void Main(string[] args) {
    var template = new LoremIpsum();
    template.Session = new Dictionary<string, object>() { 
        {"Param1", "ipsum"},
        {"Param2", "sit amet"},
    };
    template.Initialize();
    string text = template.TransformText();
} 
```

# 问题是什么

由于我需要生成其中的几个类，我希望它们都有一个通用的方法来发送邮件，如下所示：

```
public void SendMail(string to, IDictionary<string, object> parameters) 
```

或者，甚至更好：

```
public void SendMail(string to, string Param1, string Param2) 
```

由于生成的类是部分的，因此可以向它们添加方法，添加另一个部分类声明，但这意味着我必须为所有生成的类重复（或多或少）相同的代码。

# 到目前为止我尝试了什么

我尝试创建一个基类，但如果我尝试这样做：

```
<#@ template language="C#" inherits="MailTemplateBase" #> 
```

然后生成的代码中断，因为生成的类依赖于`LoremIpsumBase`定义一些帮助方法的基类（我真的认为让每个生成的类都继承自几乎相同但不同的基类没有意义）。

# 问题

1.  如何为我的模板创建一个基类？
2.  如何生成一个接受与模板中声明的参数相同的参数的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T16:58:47.920

我认为您需要创建一个空模板，复制创建的类并将其用作您的基类。然后，您可以使用所需的任何属性对其进行扩展。（复制代码后无需保留空模板）

对于它的价值，我认为您正在尝试做的事情在 VS 2010 RTM 中开箱即用，但是 VS2010 SP1 改变了行为，以便您可以自己子类化模板。查看此[连接问题](http://connect.microsoft.com/VisualStudio/feedback/details/643600/t4-code-generation-broken-when-using-pre-processed-templates-with-inherits-baseclass-directives-and-expresson-code-blocks)以获取更多信息。

编辑：

至于将电子邮件方法放在基础上，我可能不会那样做。您可能需要考虑公开某种模板服务，该服务具有您需要的各种方法，例如：

```
public class TemplatingService : ITemplatingService
{
    public string GenerateReminderMessage(string to, string name)
    {
        // Construct the template, passing in the parameters into the session as required
        ...
        // Return the results of the template transformation
    }
} 
```

这样，您就可以从实际的 T4 实现中抽象出来，因此如果某处确实发生了故障，您只需在一个类中修复它。

并公开一个使用模板服务生成邮件内容的邮件服务：

```
public class MailService : IMailService
{
    public void SendReminderEmail(string to, string name)
    {
        var message = this.TemplatingService.GenerateReminderMessage(to, name);
        this.MailerService.SendEmail(to, message);
    }
} 
```

请注意，MailerService 只是一个简单的 .NET 邮件代码包装器，但它允许您单独对 MailService 进行单元测试。

可能有更多方法可以将其抽象出来，但这只是一个开始。

希望有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T15:40:27.787

听起来您假设构造函数注入是将数据注入类的唯一方法。然而，我猜想在这种情况下，方法/属性注入是更好的选择。

我手头没有编译器，也无法确定验证它，但它似乎可以工作。

# asp.net - 在构建 Web 应用程序后使用 Visual Studio2010 web.config 转换

> ID：10739595
> 
> 赞同：4
> 
> 时间：2012-05-24T14:32:13.463
> 
> 标签：asp.net, visual-studio-2010, web-config

我在 Visual Studio 2010 中使用 web.config 转换。

我通过右键单击 web.config 文件并选择名为 Add Config Transforms 的选项添加了转换。通过这个，我在我的解决方案中添加了一些配置文件。通过 VS2010 发布我的项目后，我的 web.config 将使用选定的配置文件（如 web.dev.config）进行更新。

我的问题是：

**我可以在构建时（或构建后）使用选定的配置文件（如 web.dev.config）更新我的 web.config 文件吗？**

谢谢，马希

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T16:07:50.993

我同意 Pablo 的评论。你不应该覆盖 web.config。

如果需要，您可以在编译时转换所有文件。

这是如何做到的。编辑项目文件 (.csproj) 并添加以下代码。确保路径正确。

```
<Target Name="AfterBuild">
    <TransformXml Source="$(SolutionDir)WCFServices\Web.config" 
                  Transform="$(SolutionDir)WCFServices\Web.Release.config" 
                  Destination="$(OutDir)WebRelease.config" 
                  StackTrace="true" />
</Target> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T15:55:38.220

好吧，实际上配置转换的目的之一是原始 .config 保持不变（我将尝试找到提到这一点的 MS 文档）。

默认的 web.config 实际上应该是您的 DEV 配置，因为它可以在您的环境中以及在部署时工作。

对我来说，让配置文件保持不变实际上似乎更安全一些，因为如果不这样做，您在使用 TFS 或 SVN 等源代码控制时就会遇到问题。您可能希望远离会更改您每天签入的代码库的构建过程。

# c# - Serialize xml document with text and element in the same tag

> ID：10739596
> 
> 赞同：1
> 
> 时间：2012-05-24T14:32:13.643
> 
> 标签：c#, xml, serialization, xhtml, xml-serialization

Is it possible to serialize xml document in C# to produce such tags

```
...
<myTag attr="tag">
    this is text
    <a href="http://yaplex.com">link in the same element</a>
</myTag>
... 
```

The only one way I found is have content of myTag as string

```
myTag.Value = "text <a ...>link</a>"; 
```

but I want to have it as object in C#, so **a-tag** will be an object

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T14:52:25.623

```
public class myTag
{
    [XmlAttribute]
    public string attr;
    [XmlText]
    public string text;
    public Anchor a;
}

[XmlRoot("a")]
public class Anchor
{
    [XmlAttribute]
    public string href;
    [XmlText]
    public string text;
} 
```

-

```
var obj = new myTag() { 
    attr = "tag", 
    text = "this is text", 
    a = new Anchor() { 
        href = "http://yaplex.com",
        text="link in the same element" 
    } 
}; 

XmlSerializer ser = new XmlSerializer(typeof(myTag));
StringWriter wr = new StringWriter();
XmlWriter writer = XmlTextWriter.Create(wr, new XmlWriterSettings() { OmitXmlDeclaration = true });
var ns = new XmlSerializerNamespaces();
ns.Add("","");
ser.Serialize(writer,obj, ns);
string result = wr.ToString(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T14:57:15.473

If you don't actually want to serialize from class you can construct your xml like this:

```
XElement xmlTree = new XElement("Root", 
    new XElement("myTag", 
    new XAttribute("attr", "tag"), 
    new XText("this is text"), 
    new XElement("a", "link in the same element", 
    new XAttribute("href", "http://yaplex.com")))); 
```

# joomla - Joomla 组件：没有 html 的输出

> ID：10739611
> 
> 赞同：8
> 
> 时间：2012-05-24T14:33:22.230
> 
> 标签：joomla, joomla-extensions

我正在为 Joomla 2.5 开发一个 Joomla 组件。由于它应该输出 XML，我绝对不想显示周围的模板。

我尝试附加到网址：

*   ?tmpl=组件
*   ?格式=原​​始
*   ?tmpl=原始

但是第一个会在内容输出周围生成一些 HTML，第二个会给我一个 500 错误。第三个根本不产生任何输出。我假设它正在寻找一个名为“raw”的模板，因为我放在那里的任何其他乱码模板名称都会给我相同的结果。

如何在没有任何额外的 Joomla + 模板 HTML 的情况下从我的组件输出 XML？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-24T21:22:31.683

在 Joomla！1.5 你所要做的就是添加`?tmpl=component&format=raw`，但要实现原始显示

在 Joomla！2.5 您需要制作**view.raw.php**文件，该文件可以与您现有的文件相同`view.html.php`，但这取决于您的需要。而且在控制器中你必须手动实例化原始视图，因为默认类型是 html。

您可以在文件`administrator/components/com_banners/controllers/tracks.raw.php`中找到一个非常好的示例，该文件是 Joomla 附带的默认组件的一部分。

# if-statement - awk 如果其他问题

> ID：10739613
> 
> 赞同：29
> 
> 时间：2012-05-24T14:33:28.083
> 
> 标签：if-statement, awk, syntax

Bash 将箭头指向“else”并用挑衅的抱怨语气说“语法错误”。

```
awk '{if($3 != 0) a = ($3/$4) print $0, a; else if($3==0) print $0, "-" }' file > out 
```

为什么？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-05-24T14:40:34.810

您忘记了 if 块周围的大括号，以及块中语句之间的分号。

```
awk '{if($3 != 0) {a = ($3/$4); print $0, a;} else if($3==0) print $0, "-" }' file > out 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-18T06:57:11.903

试试代码

```
awk '{s=($3==0)?"-":$3/$4; print s}' 
```

# android - 如何在对话框和活动顶部创建幻灯片弹出弹出窗口？

> ID：10739616
> 
> 赞同：0
> 
> 时间：2012-05-24T14:33:40.177
> 
> 标签：android, android-layout, android-view, android-dialog

我想实现一个弹出窗口，该弹出窗口应该出现在活动顶部以及可能位于该活动顶部的任何对话框顶部。此外，当弹出窗口在屏幕上时，后台的活动和对话框应该仍然是交互式的（即它们应该对触摸做出反应并且所有按钮等应该仍然有效）。x 时间后，弹出窗口应滑出屏幕。

我提出了以下想法，但它们都有一些缺点：

1.**自定义吐司** 虽然吐司总是出现在活动和对话框的顶部，但我认为它不能滑入和滑出。

**2.自定义对话框** 对话框也将出现在活动和对话框之上，但这里的问题是，当我的自定义对话框在屏幕上时，活动和所有以前打开的对话框将不再是交互的（即它们不会接触）。

**3\. Activity 中的 ImageView** 这种方法的问题很明显：它总是出现在对话框后面。

任何帮助将不胜感激。谢谢 ！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T14:46:48.463

以下是您的选择：

1）和吐司一起去，牺牲你的动画进/出

2）继续对话并牺牲触摸事件

3）这是不可行的

我什至无法想到您将如何使用自定义视图来做到这一点，它太复杂了，而且在 Google UX 设计中不推荐使用。

也许对于您的问题的另一种解决方案的一些启发，请尝试这里：http: [//developer.android.com/design/index.html](http://developer.android.com/design/index.html)

要问的真正问题是，你为什么想要这个工具提示？你想达到什么目的？有了这些答案，您可以寻找更多 *Android-esq' 解决方案

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T16:41:58.770

你真的需要一个视图子类，而不是一个对话框。使用 addView() 添加您的视图，使用 removeView() 删除它。

通过布局/样式，您可以使它看起来像一个对话框。

您可以使用视图动画来实现滑入/滑出效果。

```
Animation slideIn = new TranslateAnimation (windowWidth, 0, 0, 0);
slideIn.setDuration (400);
slideIn.setInterpolator(new LinearInterpolator());
dialogView.startAnimation(slideIn);

Animation slideOut = new TranslateAnimation (0, windowWidth, 0, 0);
slideOut.setDuration (400);
slideOut.setInterpolator(new LinearInterpolator());
dialogView.startAnimation(slideOut); 
```

并在滑出后使用 AnimationListener() onAnimationEnd() 删除视图。

您需要调整 TranslateAnimation 的 x/y 参数以达到您想要的效果，假设您希望对话框以 x 和 y 轴为中心...

# c - 使用 GCC 的两个有符号 64 位乘法

> ID：10739618
> 
> 赞同：0
> 
> 时间：2012-05-24T14:33:42.840
> 
> 标签：c, gcc, 64-bit, arm

我正在尝试使用 GCC 将两个有符号的 64 位长数据相乘

```
long long int A;//(A0,A1)
long long int B;//(B0,B1) 
```

你能帮我做以下事情吗

1.  如何使用scanf输入64位数字
2.  如何打印
3.  将两个数相乘

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T14:36:15.227

1.  `scanf("%lld", &A);`
2.  `printf("%lld", A);`
3.  `A*B`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-17T09:48:52.010

试试这个，我也在检查并评论我的结果。

```
void mulul64(uint64 u, uint64 v, uint64 *whi, uint64 *wlo)
{
uint64 u0, u1, v0, v1, k, t;
uint64 w0, w1, w2;
u1 = u >> 32; u0 = u & 0xFFFFFFFF;
v1 = v >> 32; v0 = v & 0xFFFFFFFF;
t = u0*v0;
w0 = t & 0xFFFFFFFF;
k = t >> 32;
t = u1*v0 + k;
w1 = t & 0xFFFFFFFF;
w2 = t >> 32;
t = u0*v1 + w1;
k = t >> 32;
*wlo = (t << 32) + w0;
*whi = u1*v1 + w2 + k;
return;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-24T14:50:20.733

你不能确定它`long long int`是 64 位的。你应该尝试这样做：

```
#include <stdint.h>

int64_t A, B; 
```

# java - GWT 2.4 中带有 JSNI 覆盖类型的 ClassFormatException

> ID：10739619
> 
> 赞同：4
> 
> 时间：2012-05-24T14:33:48.173
> 
> 标签：java, gwt, mobile, jsni

我们正在尝试**使用 GWT 2.4 开发移动应用程序，**但现在看来我碰壁了，无法解决问题。

我们为从服务器接收到的*JSON数据编写了 4 种**覆盖类型*和 1种具有静态实用功能的*覆盖类型。*

 **根据我们使用这些实用功能的位置，我们会收到此错误：

```
java.lang.ClassFormatError: Illegal method name "<init>$" in class com/our/company/DataUtil
    at java.lang.ClassLoader.defineClass1(Native Method)
    at java.lang.ClassLoader.defineClass(ClassLoader.java:791)
    at java.lang.ClassLoader.defineClass(ClassLoader.java:634)
    at com.google.gwt.dev.shell.CompilingClassLoader.findClass(CompilingClassLoader.java:1085)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:423)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:356)
    ...
    ...
    ... 
```

## 我测试过的东西：

*   在通过延迟绑定加载的模块中从 DataUtil 调用各种方法

结果：无论调用哪个方法，在编译期间都会出现错误并显示附加消息：

```
[ERROR] [wwapp] Failed to create an instance of'com.our.company.mobileapp.client.model.data.GimmeData' via deferred binding 
```

*   在活动中从 DataUtil 调用方法：

结果：错误在运行时显示为警报弹出窗口。

请允许我快速说明所有相关的类：

DataUtil --> 覆盖类型

AData --> Overlay Type BData -->
Overlay Type CData --> Overlay Type
DData --> Overlay Type
A --
B --
C --
D --> 各自的数据类型作为“纯”Java类

* * *

这是 DataUtil 类的简化版本：

```
public final class DataUtil extends JavaScriptObject
{
  protected DataUtil()
  {

  }

  private final native static JsArray<AData> asArrayOfAData( String json ) /*-{
        return eval(json);
  }-*/;

  private final static native BData asBData( String json ) /*-{
        if (json.charAt(0) != "(")
            json = "(" + json + ")";

        return eval(json);
  }-*/;

  private final static native JsArray<CData> asArrayOfCData( String json ) /*-{
        return eval(json);
  }-*/;

  private final static native JsArray<DData> asArrayOfDData( String json ) /*-{
        return eval(json);
  }-*/;

  public final static List<A> getListOfAs( String json )
  {
    JsArray<AData> arr = asArrayOfAData( json );
    List<A> list = new ArrayList<A>();

    for ( int i = 0; i < arr.length(); ++i )
    {
      list.add( arr.get( i ).asA() );
    }

    return list;
  }

  public final static B getB( String json )
  {
    return asBData( json ).asB();
  }

  public final static List<C> getListOfC( String json )
  {
    JsArray<CData> arr = asArrayOfCData( json );
    List<C> list = new ArrayList<C>();

    for ( int i = 0; i < arr.length(); ++i )
    {
      list.add( arr.get( i ).asC() );
    }

    return list;
  }

  public final static List<D> getListOfD( String json)
  {
    JsArray<DData> arr = asArrayOfDData( json);
    List<D> list = new ArrayList<D>();

    for ( int i = 0; i < arr.length(); ++i )
    {
      list.add( arr.get( i ).asD() );
    }

    return list;
  }
} 
```

* * *

如果需要，我也会发布其他覆盖类型。我真的希望有人以前遇到过并解决了这个问题，如果是这样的话，请提前非常感谢；）。

* * *

根据要求，我将发布完整的课程。我只是剥离了评论、导入和包。

`JSData`（以前`DataUtil`）：

```
public final class JSData extends JavaScriptObject
{
  protected JSData()
  {
  }

  private final native static JsArray<POIData> asArrayOfPOIData( String json ) /*-{
        return eval(json);
  }-*/;

  private final static native UserData asUserData( String json ) /*-{
        if (json.charAt(0) != "(")
            json = "(" + json + ")";

        return eval(json);
  }-*/;

  private final static native JsArray<CategoryData> asArrayOfCategoryData( String json ) /*-{
        return eval(json);
  }-*/;

  private final static native JsArray<RouteData> asArrayOfRouteData( String json ) /*-{
    return eval(json);
  }-*/;

  public final static List<WWCategory> getListOfCategories( String json )
  {
    JsArray<CategoryData> arr = asArrayOfCategoryData( json );
    List<WWCategory> list = new ArrayList<WWCategory>();

    for ( int i = 0; i < arr.length(); ++i )
    {
      list.add( arr.get( i ).asWWCategory() );
    }

    return list;
  }

  public final static List<WWPOI> getListOfPOIs( String json )
  {
    JsArray<POIData> arr = asArrayOfPOIData( json );
    List<WWPOI> list = new ArrayList<WWPOI>();

    for ( int i = 0; i < arr.length(); ++i )
    {
      list.add( arr.get( i ).asWWPOI() );
    }

    return list;
  }

  public final static WWUser getUser( String json )
  {
    return asUserData( json ).asWWUser();
  }

  public final static List<WWRoute> getListOfRoutes( String routesJSON )
  {
    JsArray<RouteData> arr = asArrayOfRouteData( routesJSON );
    List<WWRoute> list = new ArrayList<WWRoute>();

    for ( int i = 0; i < arr.length(); ++i )
    {
      list.add( arr.get( i ).asWWRoute() );
    }

    return list;
  }
} 
```

`UserData`：

```
public final class UserData extends JavaScriptObject
{
  protected UserData()
  {

  }

  private static final Logger log = Logger.getLogger( "com.isp.wwapp.core.client.model.jsdata.UserData" );

  public final String getUserName()
  {
    String benutzername_js = getUserName_JS();
    String benutzername = Utils.unescape( benutzername_js );

    return benutzername;
  }
  private final native String getUserName_JS() /*-{
        return this.benutzername;
  }-*/;

  public final String getName()
  {
    String vorname_js = getName_JS();
    String vorname = Utils.unescape( vorname_js );
    log.info( vorname );
    return vorname;
  }
  private final native String getName_JS() /*-{
        return this.vorname;
  }-*/;

  public final String getSurname()
  {
    String nachname_js = getSurname_JS();
    String nachname = Utils.unescape( nachname_js );
    log.info( nachname );
    return nachname;
  }
  private final native String getSurname_JS()
  /*-{
        return this.nachname;
  }-*/;

  public final Boolean getGender()
  {
    String geschlecht_js = getGender_JS();
    Boolean geschlecht = null;

    geschlecht = geschlecht_js.equals( "w" );

    return geschlecht;
  }
  private final native String getGender_JS()
  /*-{
        return this.geschlecht;
  }-*/;

  public final String getNickname()
  {
    String nickname_js = getNickname_JS();
    String nickname = Utils.unescape( nickname_js );

    return nickname;
  }
  private final native String getNickname_JS()
  /*-{
        return this.nickname;
  }-*/;

  public final Date getBirthday()
  {
    String geburtstag_js = getBirthday_JS();
    Date geburtstag = null;

    try
    {
      geburtstag = DateTimeFormat.getFormat( "yyyy-MM-dd" ).parse( geburtstag_js );
    }
    catch ( IllegalArgumentException e )
    {
      log.log( Level.SEVERE, "Das Geburtsdatum konnte nicht richtig geparst werden.", e );
    }
    return geburtstag;
  }
  private final native String getBirthday_JS()
  /*-{
        return this.geburtstag;
  }-*/;

  public final String getPassword()
  {
    String passwort_crypt_js = getPassword_JS();
    String passwort_crypt = Utils.unescape( passwort_crypt_js );
    log.info( passwort_crypt );
    return passwort_crypt;
  }
  private final native String getPassword_JS()
  /*-{
        return this.passwort_crypt;
  }-*/;

  public final String getStreet()
  {
    String strasse_js = getStreet_JS();
    String strasse = Utils.unescape( strasse_js );

    return strasse;
  }
  private final native String getStreet_JS()
  /*-{
        return this.strasse;
  }-*/;

  public final String getStreetNumber()
  {
    String hausnr_js = getStreetNumber_JS();
    String hausnr = Utils.unescape( hausnr_js );

    return hausnr;
  }
  private final native String getStreetNumber_JS()
  /*-{
        return this.hausnr;
  }-*/;

  public final String getZIP()
  {
    String plz_js = getZIP_JS();
    String plz = Utils.unescape( plz_js );

    return plz;
  }
  private final native String getZIP_JS()
  /*-{
        return this.plz;
  }-*/;

  public final String getDistrict()
  {
    String ortsteil_js = getDistrict_JS();
    String ortsteil = Utils.unescape( ortsteil_js );

    return ortsteil;
  }
  private final native String getDistrict_JS()
  /*-{
        return this.ortsteil;
  }-*/;

  public final String getLocation()
  {
    String ort_js = getLocation_JS();
    String ort = Utils.unescape( ort_js );

    return ort;
  }
  private final native String getLocation_JS()
  /*-{
        return this.ort;
  }-*/;

  public final String getState()
  {
    String landesteil_js = getState_JS();
    String landesteil = Utils.unescape( landesteil_js );

    return landesteil;
  }
  private final native String getState_JS()
  /*-{
        return this.landesteil;
  }-*/;

  public final String getRegion()
  {
    String region_js = getRegion_JS();
    String region = Utils.unescape( region_js );

    return region;
  }
  private final native String getRegion_JS()
  /*-{
        return this.region;
  }-*/;

  public final String getCountry()
  {
    String landname_js = getCountry_JS();
    String landname = Utils.unescape( landname_js );

    return landname;
  }
  private final native String getCountry_JS()
  /*-{
        return this.landname;
  }-*/;

  public final String getImageURL()
  {
    String foto_js = getImageURL_JS();
    String foto = Utils.unescape( foto_js );

    return foto;
  }
  private final native String getImageURL_JS()
  /*-{
        return this.foto;
  }-*/;

  public final String getWebsite()
  {
    String webseite_js = getWebsite_JS();
    String webseite = Utils.unescape( webseite_js );

    return webseite;
  }
  private final native String getWebsite_JS()
  /*-{
        return this.webseite;
  }-*/;

  public final Integer getDbId()
  {
    String idBenutzer_js = getDbId_JS();
    Integer idBenutzer = null;

    idBenutzer = Integer.parseInt( idBenutzer_js );

    return idBenutzer;
  }
  private final native String getDbId_JS()
  /*-{
        return this.idBenutzer;
  }-*/;

  public final String getEmail()
  {
    String email_js = getEmail_JS();
    String email = Utils.unescape( email_js );

    return email;
  }
  private final native String getEmail_JS()
  /*-{
        return this.email;
  }-*/;

  public final String getTel()
  {
    String festnetz_js = getTel_JS();
    String festnetz = Utils.unescape( festnetz_js );

    return festnetz;
  }
  private final native String getTel_JS()
  /*-{
        return this.festnetz;
  }-*/;

  public final String getMobile()
  {
    String mobil_js = getMobile_JS();
    String mobil = Utils.unescape( mobil_js );

    return mobil;
  }
  private final native String getMobile_JS()
  /*-{
        return this.mobil;
  }-*/;

  public final String getIMEI()
  {
    String imei_js = getIMEI_JS();
    String imei = imei_js;
    log.info( imei );
    return imei;
  }
  private final native String getIMEI_JS()
  /*-{
        return this.imei;
  }-*/;

  public final String getFax()
  {
    String fax_js = getFax_JS();
    String fax = Utils.unescape( fax_js );

    return fax;
  }
  private final native String getFax_JS()
  /*-{
        return this.fax;
  }-*/;

  public final String getSkype()
  {
    String skype_js = getSkype_JS();
    String skype = Utils.unescape( skype_js );

    return skype;
  }
  private final native String getSkype_JS()
  /*-{
        return this.skype;
  }-*/;

  public final String getICQ()
  {
    String icq_js = getICQ_JS();
    String icq = Utils.unescape( icq_js );

    return icq;
  }
  private final native String getICQ_JS()
  /*-{
        return this.icq;
  }-*/;

  public final String getTwitter()
  {
    String twitter_js = getTwitter_JS();
    String twitter = Utils.unescape( twitter_js );

    return twitter;
  }
  private final native String getTwitter_JS()
  /*-{
        return this.twitter;
  }-*/;

  public final Integer getMyPoiDbID()
  {
    String persPoi_js = getMyPoi_JS();
    Integer persPoiId = null;

    try
    {
      persPoiId = Integer.parseInt( persPoi_js );

    }
    catch ( NumberFormatException e )
    {
      log.log( Level.SEVERE, "Fehler beim Parsen der POI Datenbank-Id.", e );
    }

    return persPoiId;
  }
  private final native String getMyPoi_JS()
  /*-{
        return this.persPoi;
  }-*/;

  public final WWUser asWWUser()
  {

    Contact con = new Contact( this.getEmail(), this.getTel(), this.getMobile() );

    //TODO restliche Kontaktattribute füllen .

    Address adr =
        new Address( this.getStreet(), this.getStreetNumber(), this.getLocation(), this.getZIP(),
            this.getCountry() );

    WWUser wwuser =
        new WWUser( this.getDbId(), this.getName(), this.getSurname(), con, adr, this.getUserName(),
            Utils.hexStringToByteArray( this.getPassword() ), this.getIMEI() );

    log.info( wwuser.toString() );

    return wwuser;

  }

} 
```

`POIData`：

```
public class POIData extends JavaScriptObject
{

  private final Logger log = Logger.getLogger( "com.isp.wwapp.core.client.model.jsdata.POIData" );

  protected POIData()
  {
  }

  public final Integer getDbId()
  {
    Integer dbid = null;
    String dbid_js = getDbId_JS();
    try
    {
      dbid = Integer.parseInt( dbid_js );
    }
    catch ( NumberFormatException nfe )
    {
      log.log( Level.INFO, "Die Datenbank-ID " + dbid_js + " konnte nicht in ein Integer geparst werden.",
          nfe );
    }

    return dbid;
  }
  private final native String getDbId_JS() /*-{
        return this.idPoi;
  }-*/;

  public final String getLabel()
  {
    return Utils.unescape( getLabel_JS() );
  }
  private final native String getLabel_JS() /*-{
        return this.poiBez;
  }-*/;

  public final String getDescription()
  {
    return Utils.unescape( getDescription_JS() );
  }
  private final native String getDescription_JS() /*-{
        return this.kurztext;
  }-*/;

  public final Double getLongitude()
  {
    Double lon = null;
    String lon_js = getLongitude_JS();
    try
    {
      lon = Double.parseDouble( lon_js );
    }
    catch ( NumberFormatException nfe )
    {
      log.log( Level.SEVERE, "Die Longitude " + lon_js + " konnte nicht in ein Double geparst werden.", nfe );
    }
    return lon;
  }
  private final native String getLongitude_JS() /*-{
        return this.laenge;
  }-*/;

  public final Double getLatitude()
  {
    Double lat = null;
    String lat_js = getLatitude_JS();
    try
    {
      lat = Double.parseDouble( lat_js );
    }
    catch ( NumberFormatException nfe )
    {
      log.log( Level.SEVERE, "Die Latitude " + lat_js + " konnte nicht in ein Double geparst werden.", nfe );
    }
    return lat;
  }
  private final native String getLatitude_JS() /*-{
        return this.breite;
  }-*/;

  public final String getStreet()
  {
    return Utils.unescape( getStreet_JS() );
  }
  private final native String getStreet_JS() /*-{
        return this.strasse;
  }-*/;

  public final String getStreetNumber()
  {
    return Utils.unescape( getStreetNumber_JS() );
  }
  private final native String getStreetNumber_JS() /*-{
        return this.hausnr;
  }-*/;

  public final String getZIP()
  {
    return Utils.unescape( getZIP_JS() );
  }
  private final native String getZIP_JS() /*-{
        return this.plz;
  }-*/;

  public final String getLocation()
  {
    return Utils.unescape( getLocation_JS() );
  }
  private final native String getLocation_JS() /*-{
        return this.ort;
  }-*/;

  public final String getCountry()
  {
    return Utils.unescape( getCountry_JS() );
  }
  private final native String getCountry_JS() /*-{
        return this.landName;
  }-*/;

  public final String getDistrict()
  {
    return Utils.unescape( getDistrict_JS() );
  }
  private final native String getDistrict_JS() /*-{
        return this.ortsteil;
  }-*/;

  public final String getState()
  {
    return Utils.unescape( getState_JS() );
  }
  private final native String getState_JS() /*-{
        return this.landesteil;
  }-*/;

  public final String getRegion()
  {
    return Utils.unescape( getRegion_JS() );
  }
  private final native String getRegion_JS() /*-{
        return this.region;
  }-*/;

  public final String getURL()
  {
    return Utils.unescape( getURL_JS() );
  }
  private final native String getURL_JS() /*-{
        return this.url;
  }-*/;

  public final String getContactEmail()
  {
    return Utils.unescape( getContactEmail_JS() );
  }
  private final native String getContactEmail_JS() /*-{
        return this.kontaktEmail;
  }-*/;

  public final String getContactTel()
  {
    return Utils.unescape( getContactTel_JS() );
  }
  private final native String getContactTel_JS() /*-{
        return this.kontaktTel;
  }-*/;

  public final String getContactMobile()
  {
    return Utils.unescape( getContactMobile_JS() );
  }
  private final native String getContactMobile_JS() /*-{
        return this.kontaktTel2;
  }-*/;

  public final String getContactFax()
  {
    return Utils.unescape( getContactFax_JS() );
  }
  private final native String getContactFax_JS() /*-{
        return this.kontaktFax;
  }-*/;

  @Deprecated
  public final List<String> getCategoryLabels()
  {
    JsArrayString labelsArray = getCategoryLabels_JS();
    List<String> labelsList = new ArrayList<String>();

    for ( Integer i = 0; i < labelsArray.length(); ++i )
    {
      labelsList.add( Utils.unescape( labelsArray.get( i ) ) );
    }
    return labelsList;
  }
  private final native JsArrayString getCategoryLabels_JS() /*-{
        var katLabels = new Array();
        for ( var i = 0; i < this.myKat.length; ++i) {
            katLabels.push(this.myKat[i].katBez);
        }
        return katLabels;
  }-*/;

  public final List<WWCategory> getCategories()
  {
    List<WWCategory> cats = new ArrayList<WWCategory>();
    JsArray<CategoryData> cats_js = getCategories_JS();

    for ( Integer i = 0; i < cats_js.length(); ++i )
    {
      cats.add( cats_js.get( i ).asWWCategory() );
    }
    return cats;
  }
  private final native JsArray<CategoryData> getCategories_JS() /*-{
        return eval(this.myKat);
  }-*/;

  public final Date getLastModified()
  {
    String geaendertAm_js = getLastModified_JS();
    Date geaendertAm = null;

    DateTimeFormat wwDTFormat = DateTimeFormat.getFormat( "yyyy-MM-dd HH:mm:ss" );
    try
    {
      geaendertAm = wwDTFormat.parse( geaendertAm_js );

    }
    catch ( IllegalArgumentException e )
    {
      log.log( Level.SEVERE, "Parsen des Datums " + geaendertAm_js + "ist fehlgeschlagen.", e );
    }

    return geaendertAm;
  }
  private final native String getLastModified_JS() /*-{
        return this.geaendertAm;
  }-*/;

  public final int getPosition()
  {
    String position_js = getPosition_JS();
    int position = 0;
    try
    {
      position = Integer.parseInt( position_js );
    }
    catch ( NumberFormatException e )
    {
      log.log( Level.SEVERE, "Fehler beim Parsen der Position des POIs.", e );
    }

    return position;
  }
  private final native String getPosition_JS()
  /*-{
        return this.position;
  }-*/;

  public final WWPOI asWWPOI()
  {
    WWPOI poi = new WWPOI( this.getDbId(), this.getLatitude(), this.getLongitude(), this.getLabel() );

    poi.setDescription( this.getDescription() );
    poi.setUrl( this.getURL() );
    poi.setPosition( this.getPosition() );

    Address adr = new Address();
    adr.setCountry( this.getCountry() );
    adr.setDistrict( this.getDistrict() );
    adr.setLocation( this.getLocation() );
    adr.setZip( this.getZIP() );
    adr.setState( this.getState() );
    adr.setStreet( this.getStreet() );
    adr.setStreetNumber( this.getStreetNumber() );

    poi.setAddress( adr );

    Contact con = new Contact();
    con.setEmail( this.getContactEmail() );
    con.setFax( this.getContactFax() );
    con.setTel( this.getContactTel() );
    con.setMobile( this.getContactMobile() );

    poi.setContactData( con );

    List<WWCategory> categories = GimmeThatSingleton.getInstance().getCategories();

    List<WWCategory> poiCats = this.getCategories();

    for ( WWCategory poiCat : poiCats )
    {

      for ( WWCategory cat : categories )
      {
        // wenn katergorie vorhanden, vorhandene hinzufügen zu poi

        if ( poiCat.equals( cat ) )
        {

          poi.addToCategory( cat );

        }
      }
    }

    if ( poi.getCategories() == null )
      return null; //TODO throw exception?

    return poi;
  }
} 
```

`RouteData`：

```
public final class RouteData extends JavaScriptObject
{
  protected RouteData()
  {
  }

  private final Logger log = Logger.getLogger( "com.isp.wwapp.core.client.model.jsdata.RouteData" );

  public final String getLabel()
  {
    return Utils.unescape( getLabel_JS() );
  }
  private final native String getLabel_JS() /*-{
        return this.routenBez;
  }-*/;

  public final Integer getDbId()
  {
    Integer dbid = null;
    String dbid_js = getDbId_JS();
    try
    {
      dbid = Integer.parseInt( dbid_js );
    }
    catch ( NumberFormatException nfe )
    {
      log.log( Level.SEVERE, "Die Datenbank-ID " + dbid_js + " konnte nicht in ein Integer geparst werden.",
          nfe );
    }

    return dbid;
  }
  private final native String getDbId_JS() /*-{
        return this.idRoute;
  }-*/;
  /**
   * @return
   */
  public final WWRoute asWWRoute()
  {
    WWRoute route = new WWRoute( getDbId(), null, getLabel(), null );
    return route;
  }
} 
```

`CategoryData`：

```
public final class CategoryData extends JavaScriptObject
{

  protected CategoryData()
  {
  }

  private final Logger log = Logger.getLogger( "com.isp.wwapp.core.client.model.jsdata.CategoryData" );

  public final String getLabel()
  {
    return Utils.unescape( getLabel_JS() );
  }
  private final native String getLabel_JS() /*-{
        return this.katBez;
  }-*/;

  public final String getDescription()
  {
    return Utils.unescape( getDescription_JS() );
  }
  private final native String getDescription_JS() /*-{
        return this.katBeschreibung;
  }-*/;

  public final Integer getDbId()
  {
    Integer dbid = null;
    String dbid_js = getDbId_JS();
    try
    {
      dbid = Integer.parseInt( dbid_js );
    }
    catch ( NumberFormatException nfe )
    {
      log.log( Level.SEVERE, "Die Datenbank-ID " + dbid_js + " konnte nicht in ein Integer geparst werden.",
          nfe );
    }

    return dbid;
  }
  private final native String getDbId_JS() /*-{
        return this.idKat;
  }-*/;

  public final native Boolean isSubcategory() /*-{
        return (this.unterKatVon != null);
  }-*/;
  public final native Boolean hasSubcategory() /*-{
        return (this.hatUnterKat == 'j');
  }-*/;

  public final Integer getParentDbId()
  {
    Integer parentdbid = null;
    String parentdbid_js = getParentDbId_JS();
    if ( parentdbid_js == null )
      return null;
    try
    {
      parentdbid = Integer.parseInt( parentdbid_js );
    }
    catch ( NumberFormatException nfe )
    {
      log.log( Level.SEVERE, "Die Datenbank-ID " + parentdbid_js
          + " konnte nicht in ein Integer geparst werden.", nfe );
      parentdbid = null;
    }
    return parentdbid;
  }
  private final native String getParentDbId_JS() /*-{
        return this.unterKatVon;
  }-*/;

  public final Date getlastModified()
  {
    String geaendertAm_js = getlastModified_JS();
    Date geaendertAm = null;

    /*
     * Serverformat eines Datum : "yyyy-mm-dd hh:mm:ss"
     */

    DateTimeFormat wwDTFormat = DateTimeFormat.getFormat( "yyyy-MM-dd HH:mm:ss" );
    try
    {
      geaendertAm = wwDTFormat.parse( geaendertAm_js );

    }
    catch ( IllegalArgumentException e )
    {
      log.log( Level.SEVERE, "Parsen des Datums " + geaendertAm_js + "ist fehlgeschlagen.", e );
    }

    return geaendertAm;
  }
  private final native String getlastModified_JS() /*-{
        return this.geaendertAm;
  }-*/;

  public final WWCategory asWWCategory()
  {

    WWCategory cat = new WWCategory( this.getParentDbId(), this.getDbId(), this.getLabel() );
    cat.setDescrition( this.getDescription() );

    return cat;
  }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T11:01:33.550

我认为问题出在您的`*Data`覆盖类型中，因为您声明了实例字段：

```
private final Logger log = Logger.getLogger( "com.isp.wwapp.core.client.model.jsdata.CategoryData" ); 
```

文档指出覆盖类型不能有任何实例字段。

将其移除或使其成为静态的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-22T06:45:38.470

试试这些步骤

1.  确保所有覆盖类型都有一个受保护的无参数构造函数。
2.  公开本机方法
3.  保持你的覆盖类型简单并将非本地方法移动到不同的类中

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-23T15:42:06.823

我可能已经复制了您的错误：

它归结为两个覆盖类型相互交叉引用的覆盖类，其中错误实际上在第二个覆盖类中。

主要的：

```
import com.google.gwt.core.client.EntryPoint;
import com.google.gwt.core.client.JavaScriptObject;
import com.google.gwt.core.client.JsonUtils;
import com.google.gwt.user.client.Window;
import com.google.gwt.user.client.ui.Label;
import com.google.gwt.user.client.ui.RootPanel;

public class _37_OverLayStackOverfflowQuestion implements EntryPoint {

    String jsonS = "{\"hello\":\"world\"}";

    public void onModuleLoad() {
        JavaScriptObject jso = JsonUtils.safeEval(jsonS);
        DataUtil overlayEr = jso.cast();
        OtherOverlay wellwell = jso.cast();

        overlayEr.test(wellwell);
        Window.alert("works");
    }
} 
```

第一次叠加：

```
import java.util.List;

import com.google.gwt.core.client.JavaScriptObject;
import com.google.gwt.core.client.JsArrayString;

public final class DataUtil extends JavaScriptObject {
    protected DataUtil() {

    }

    public final native void test(OtherOverlay json) /*-{
        return;
    }-*/;
} 
```

第二个叠加：

```
import com.google.gwt.core.client.JavaScriptObject;

public class OtherOverlay extends JavaScriptObject {
    protected OtherOverlay() {
    }

    public final native void someFkt()/*-{
        alert('hello');
    }-*/;

    int i = 0;
} 
```

错误出现在第二个 Overlay 类的最后一页中：`int i = 0;`。

**但是，错误消息出现在 DataUtil 中。**

```
java.lang.ClassFormatError: Illegal method name "<init>$" in class stefan/client/DataUtil
    at java.lang.ClassLoader.defineClass1(Native Method)
    at java.lang.ClassLoader.defineClassCond(Unknown Source)
    at java.lang.ClassLoader.defineClass(Unknown Source)
    at java.lang.ClassLoader.defineClass(Unknown Source)
    at com.google.gwt.dev.shell.CompilingClassLoader.findClass(CompilingClassLoader.java:1085) 
```

我猜您的错误出现在您的覆盖类之一中。检查每个是否单独工作！**

# initialization - NSWindow 的 IBOutlet 组件什么时候初始化？

> ID：10739621
> 
> 赞同：1
> 
> 时间：2012-05-24T14:33:48.677
> 
> 标签：initialization, nib, nswindow, iboutlet

我显示模态子类窗口：

```
NSWindowController* controller = [[NSWindowController alloc] initWithWindowNibName: @"MyWindow"];
[NSApp runModalForWindow: [controller window]]; 
```

我`initWithContentRect:(NSRect)contentRect styleMask:(NSUInteger)aStyle backing:(NSBackingStoreType)bufferingType defer:(BOOL)flag`在我的窗口子类中覆盖以设置链接到 nib 文件的子视图。但是这些孩子此时没有初始化（为零）。

在哪里放置我的初始化代码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T14:52:21.627

nib/xib 加载器创建对象（使用`init`家族中的一些构造函数）并以未定义的顺序设置它们的出口。在它们都存在并设置好所有出口之后，它`awakeFromNib`会从 nib/xib 文件（接受此消息）发送到所有对象，因此这是执行大部分初始化的正确位置。

# unix - Unix内核如何转换文件偏移量？

> ID：10739623
> 
> 赞同：4
> 
> 时间：2012-05-24T14:33:49.547
> 
> 标签：unix, filesystems, kernel, offset, ext2

正如标题所暗示的，我无法弄清楚 Unix 内核如何将逻辑文件偏移量转换为逻辑块号，然后从 i-node 检索它。

作为参考，我要求更详细地解释 Maurice J. Bach 在“UNIX 操作系统的设计”中首先描述的“bmap”算法。

谢谢..

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-25T10:35:53.660

不幸的是，我无法帮助您了解 UNIX 的原始实现。但是将高级目录层次结构映射到磁盘表示，以及将裸块设备上的范围分配给文件的工作通常落在一个或多个*文件系统上*。POSIX 规范对文件系统提出了一些高级别的要求，但实际上最终在磁盘上的内容完全特定于每个文件系统。

ext2 文件系统相对简单，但对它的详细解释仍然占据了一本书的一整章——其中一本书是Daniel P. Bovet 和 Marco Cesati所著的《 *Understanding the Linux Kernel 》。*

Linux 内核本身附带了更简短、更高级的介绍性文本，[也可以在此处找到](http://kernel.org/doc/Documentation/filesystems/ext2.txt)。该目录还包含[有关其他 Linux 文件系统](http://kernel.org/doc/Documentation/filesystems/)的文档以及“VFS”层，它处理所有或大多数文件系统共有的许多更高级别的方面。[Wikipedia 的 ext2 文章](http://en.wikipedia.org/wiki/Ext2)也对它进行了高水平的介绍。它还提供了一些指向更详细的在线描述的链接。

不幸的是，这不是一个适合 SO 答案的主题，但我希望上述指示有助于您入门。

# clickonce - 如何在无需重新下载每个文件的情况下更新已部署的 clickonce 应用程序？

> ID：10739627
> 
> 赞同：1
> 
> 时间：2012-05-24T14:34:01.737
> 
> 标签：clickonce

我有一个带有正在运行的数据库的应用程序。我添加了我需要的所有 dll、exe 和 db 文件。这些是不会被编译的内容。所以我将他们的构建操作设置为“内容”，将他们的复制到输出目录设置为“如果更新则复制”。有了这个，每次我发布更新版本的应用程序时，我只稍微更改一个文件，但仍然重新下载所有文件。我在这里环顾四周，显然所有文件都有一个哈希值。但他们似乎没有给我一个答案，告诉我如何发布应用程序的新版本，并让最终用户只下载已更改的文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T05:14:12.863

正如您所指出的，这些文件是散列的。安装更新时，ClickOnce 会根据本地版本检查服务器上的文件，如果它们相同，则不会再次下载它们，而是从本地目录复制它们。

我相信这实际上只适用于程序集。如果您查看 ClickOnce 缓存，您会发现部署中的每个程序集都被复制到其自己的文件夹中 - 这有点像 ClickOnce 使用的迷你缓存，这是它在进行比较时检查的内容。

*其他资源可能会*发生这种情况，但我不会打赌。正如 eoghank 所指出的，您可以使用 fiddler 来验证这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T08:21:49.310

您确定正在重新下载未更改的文件吗？使用提琴手检查，ClickOnce 下载对话框始终通过下载大小指示正在重新下载所有文件，但并非总是如此。

# sql - GROUP BY 表达式必须包含至少一列不是外部引用

> ID：10739629
> 
> 赞同：3
> 
> 时间：2012-05-24T14:34:09.893
> 
> 标签：sql, group-by

关于同一主题有几篇文章，我已经阅读了它们......但尽我所能，我无法将它们应用于我的问题。我确定这是我忽略的愚蠢的东西。

我要做的是向患者展示在特定日期和时间躺在床上的患者。每个病人都有一个入院和出院日期，所以我用这些来确定他们在那个特定的日期和时间是否在床上。如果我列出所有内容，它会很好用。现在我正在尝试做一个总结，所以它只显示这个位置的给定日期的 3 名住院病人和 1 名门诊病人，等等。但我在标题中收到错误消息。

```
SELECT DISTINCT TSM950_STATION.loc_ext_id AS STATION, 
convert(varchar(10),DATEADD(DAY,-7,GETDATE()),101) AS CENSUS_DATE,
                  TSM180_CAT.cod_dtl_ds,
                  COUNT(TPM300_PAT_VISIT.vst_ext_id)
FROM         TPM300_PAT_VISIT INNER JOIN
                  TSM040_PERSON_HDR ON TPM300_PAT_VISIT.psn_int_id = TSM040_PERSON_HDR.psn_int_id INNER JOIN
                  TSM950_LOCATION_REF AS TSM950_ROOM ON TPM300_PAT_VISIT.loc_lvl_4_id = TSM950_ROOM.loc_int_id INNER JOIN
                  TSM950_LOCATION_REF AS TSM950_BED ON TPM300_PAT_VISIT.loc_lvl_5_id = TSM950_BED.loc_int_id  INNER JOIN
                  TSM950_LOCATION_REF AS TSM950_STATION ON TPM300_PAT_VISIT.loc_lvl_3_id = TSM950_STATION.loc_int_id INNER JOIN
                  TSM180_MST_COD_DTL AS TSM180_CAT ON TPM300_PAT_VISIT.pat_cat_cd = TSM180_CAT.cod_dtl_int_id
WHERE     (TSM950_STATION.loc_ext_id IN ('MS', 'OB', 'SCU', 'NURS')) AND 
        (convert(datetime,convert(varchar(10),TPM300_PAT_VISIT.adm_ts,101) +' 00:00:00'))<=convert(datetime,convert(varchar(10),DATEADD(DAY,-7,GETDATE()),101) +' 23:58:00') AND
        (convert(datetime,convert(varchar(10),TPM300_PAT_VISIT.dschrg_ts,101) +' 00:00:00'))>=convert(datetime,convert(varchar(10),DATEADD(DAY,-7,GETDATE()),101) +' 23:59:00')
GROUP BY        TSM950_STATION.loc_ext_id, 
                 convert(varchar(10),DATEADD(DAY,-7,GETDATE()),101),
                  TSM180_CAT.cod_dtl_ds 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-24T14:46:56.060

问题是下面的表达式是一个常数：

```
convert(varchar(10),DATEADD(DAY,-7,GETDATE()),101), 
```

只需将其从您的组中删除，如下所示：

```
GROUP BY TSM950_STATION.loc_ext_id, TSM180_CAT.cod_dtl_ds 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-24T14:50:16.303

你不需要`DISTINCT`和`GROUP BY`同时。根据定义，记录将是不同的，因为所有相似的记录都在同一个组中......

另外，你不需要`GROUP BY`一个常数。

这给...

```
SELECT    TSM950_STATION.loc_ext_id AS STATION,
          convert(varchar(10),DATEADD(DAY,-7,GETDATE()),101) AS CENSUS_DATE,
          TSM180_CAT.cod_dtl_ds,
          COUNT(TPM300_PAT_VISIT.vst_ext_id)
FROM      TPM300_PAT_VISIT INNER JOIN
          TSM040_PERSON_HDR ON TPM300_PAT_VISIT.psn_int_id = TSM040_PERSON_HDR.psn_int_id INNER JOIN
          TSM950_LOCATION_REF AS TSM950_ROOM ON TPM300_PAT_VISIT.loc_lvl_4_id = TSM950_ROOM.loc_int_id INNER JOIN
          TSM950_LOCATION_REF AS TSM950_BED ON TPM300_PAT_VISIT.loc_lvl_5_id = TSM950_BED.loc_int_id  INNER JOIN
          TSM950_LOCATION_REF AS TSM950_STATION ON TPM300_PAT_VISIT.loc_lvl_3_id = TSM950_STATION.loc_int_id INNER JOIN
          TSM180_MST_COD_DTL AS TSM180_CAT ON TPM300_PAT_VISIT.pat_cat_cd = TSM180_CAT.cod_dtl_int_id
WHERE         (TSM950_STATION.loc_ext_id IN ('MS', 'OB', 'SCU', 'NURS'))
          AND (convert(datetime,convert(varchar(10),TPM300_PAT_VISIT.adm_ts,101) +' 00:00:00'))<=convert(datetime,convert(varchar(10),DATEADD(DAY,-7,GETDATE()),101) +' 23:58:00')
          AND (convert(datetime,convert(varchar(10),TPM300_PAT_VISIT.dschrg_ts,101) +' 00:00:00'))>=convert(datetime,convert(varchar(10),DATEADD(DAY,-7,GETDATE()),101) +' 23:59:00')
GROUP BY  TSM950_STATION.loc_ext_id, 
          TSM180_CAT.cod_dtl_ds 
```

# layout - 德沃夏克程序员-Qwerty ⌘

> ID：10739633
> 
> 赞同：3
> 
> 时间：2012-05-24T14:34:26.840
> 
> 标签：layout, keyboard, dvorak, qwerty

我一直在考虑将 QWERTY 切换到 DVORAK，并且喜欢 Mac 的 Dvorak-Qwerty ⌘ 键盘布局的概念，这将使我所有的苹果按钮快捷键保持不变。

但是，对于程序员 Dvorak 布局，是否有这样的版本？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-01-06T22:51:21.433

如果你在 emacs 中使用 Evil 模式。您可以仅为 evil-insert-state 打开 Dvorak 模式，并在所有其他模式以及所有 emacs 键绑定中保持 QWERTY。我已经使用它一段时间了，试图提高我的 Dvorak 打字速度，但同时又不想重新学习所有的 emacs 和 vim 键绑定。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-03T10:47:04.150

您不需要购买新的，只需按照以下说明进行操作： [http ://skeltoac.com/2007/10/22/apple-keyboard-aluminum-keycap-removal/](http://skeltoac.com/2007/10/22/apple-keyboard-aluminum-keycap-removal/)

阅读 Mac osX 的安装指南 [http://www.kaufmann.no/roland/dvorak/](http://www.kaufmann.no/roland/dvorak/) [http://www.kaufmann.no/roland/dvorak/macosx.html](http://www.kaufmann.no/roland/dvorak/macosx.html)

您可以使用 ukulele 制作自己的布局：http: [//scripts.sil.org/ukelele](http://scripts.sil.org/ukelele)

# java - Java - 二叉搜索树有一个 iterator() 方法，难以实现

> ID：10739638
> 
> 赞同：1
> 
> 时间：2012-05-24T14:34:49.143
> 
> 标签：java, data-structures, iterator, binary-search-tree

我正在尝试编写迭代器的实现，以便我可以在我的 BST 类中的 iterator() 方法下调用它。

我的解决方案（不确定它是否能正常工作）是使用堆栈或队列来存储 BST 的节点。麻烦的是，当我将“根”节点传递给它的构造函数时，我的迭代器实现类无法识别我的 BST 节点。

为了您的想象，这是我的 BST 实现，它适用于其他方法，包括添加、删除等。但我目前卡在该`iterator()`方法上。因为我不知道如何开始和做什么。

```
 public class DictionaryImp<E extends Comparable<E>> implements Dictionary<E> {

        public class DictNode {
           public DictNode left;
           public DictNode right;
           public String position;
           public E value;

           public DictNode(E value, DictNode left, DictNode right, String position) {
               this.left = left;
               this.right = right;
               this.position = position;
               this.value = value;
           }
        }

       public DictNode root;

       //... more code

       public Iterator<E> iterator() {
             // provides a fail fast iterator for the Dictionary
             // starting at the least element greater than or equal to start
             Iterable<E> itr = new DictionaryItr<E>(root);
             Iterator<E> it = itr.iterator();
             return it;
       }
} 
```

这是我为 Iterator 实现写的

```
public class DictionaryItr<E> implements Iterable<E> {
    public DictionaryItr(DictNode root) {
        first = null;
        this.inOrderTraversial(root);
    }

    public void inOrderTraversial(DictNode node) {
        if (node != null) {
            inOrderTraversial(node.left);
            first.push(node.value);
            inOrderTraversial(node.right);
        }
    }

    // more code: push, peek, pop

    public Iterator<E> iterator() {
        return new ListIterator();
    }
    private class ListIterator implements Iterator<E> {
        private Node current = first;
        public boolean hasNext()  { return current != null;                     }
        public void remove()      { throw new UnsupportedOperationException();  }

        public E next() {
            if (!hasNext()) throw new NoSuchElementException();
            E item = current.item;
            current = current.next; 
            return item;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T14:51:10.687

DictNode 类是一个内部类。当你在另一个类中使用它时，内部类名称必须是限定的（与外部类的名称一样）或导入。

# javascript - 序列化的 JSON 对象在控制器上显示为 Null

> ID：10739640
> 
> 赞同：1
> 
> 时间：2012-05-24T14:35:04.680
> 
> 标签：javascript, jquery, asp.net-mvc-3, asp.net-mvc-controller

我有一个字符串化的 JSON 对象，该对象正确显示在警报中，正确显示在浏览器调试器的 post 部分中，*但在控制器中显示为 null*。我不确定它是如何丢失信息的。

这是JS代码：

```
 var assessmentStatus = [];

            $("select.assessmentSelect").each(function () {
                assessmentStatus.push({
                    assessmentname: $(this).attr("id"),
                    assessmentstatus: $(this).val()
                });

            });
alert(JSON.stringify(assessmentStatus));

            $.ajax({
                url: '@Url.Action("testAS")',
                type: "POST",
                contentType: 'application/json',
                data: JSON.stringify({
                    AS: assessmentStatus,
                    AS2: assessmentStatus

                })

            }); 
```

这是警报中出现的内容：

```
[{"assessmentname":"testassessment","assessmentstatus":"Design"},{"assessmentname":"DepressionUpload","assessmentstatus":"Design"}] 
```

这是帖子中出现的内容：

```
[Object { assessmentname="testassessment", assessmentstatus="Design"}, Object { assessmentname="DepressionUpload", assessmentstatus="Design"}] 
```

我的控制器看起来像这样：

```
public ActionResult testAS (string[] AS, string AS2)

string[] AS returns [0]null  [1]null
string AS2 just returns null. 
```

为什么它在发送到控制器时没有被字符串化？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T15:00:34.143

您似乎正在尝试传递具有 2 个属性的复杂对象数组：

```
assessmentStatus.push({
    assessmentname: $(this).attr("id"),
    assessmentstatus: $(this).val()
}); 
```

到一个简单的字符串数组：`string[] as`. 这显然行不通。

所以从定义一个视图模型开始：

```
public class AssessmentViewModel
{
    public string Name { get; set; }
    public string Status { get; set; }
} 
```

然后调整您的控制器操作：

```
public ActionResult TestAS(AssessmentViewModel[] assessments)
{
    ...
} 
```

最后是你的javascript：

```
var assessments = [];
$('select.assessmentSelect').each(function () {
    assessments.push({
        name: $(this).attr("id"),
        status: $(this).val()
    });
});
$.ajax({
    url: '@Url.Action("testAS")',
    type: "POST",
    contentType: 'application/json',
    data: JSON.stringify({ assessments: assessments })
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T14:37:44.000

您不必自己对参数进行编码，因为看起来很简单。只需将带有您的属性的对象交给 jQuery，它就会为您编码。

```
 $.ajax({
            url: '@Url.Action("testAS")',
            type: "POST",
            contentType: 'application/json',
            data: {
                AS: assessmentStatus,
                AS2: assessmentStatus

            )

        }); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-24T14:54:25.653

我以前遇到过这个。你需要设置 jQuery 的 ajaxSettings.traditional = true。前段时间，他们改变了序列化数组的方式。它搞砸了asp.net mvc。

这个问题谈到了它：

[如何在没有表单的情况下将字符串数组发布到 ASP.NET MVC 控制器？](https://stackoverflow.com/questions/309115/how-can-i-post-an-array-of-string-to-asp-net-mvc-controller-without-a-form)

这样做：http: [//forum.jquery.com/topic/nested-param-serialization](http://forum.jquery.com/topic/nested-param-serialization)

所以只要放：

```
jQuery.ajaxSettings.traditional = true; 
```

然后像 Pointy 说的那样做，不要对你的数据进行字符串化。

# c# - 如何在 Windows 窗体中保存运行时创建的控件

> ID：10739641
> 
> 赞同：1
> 
> 时间：2012-05-24T14:35:06.123
> 
> 标签：c#, winforms

这是我的代码

```
private void make_Book(int x, int y, string name)
{
    #region Creating Book

    // this code is initializing the book(button)
    Button book1 = new Button();
    Image img = button1.Image;
    book1.Image = img;
    book1.Name = name;
    book1.Height = img.Height;
    book1.Width = img.Width;
    book1.Location = new Point(44 + x, 19 + y);            
    book1.Click += new EventHandler(myClickHandler);
    groupBox1.Controls.Add(book1);

    #endregion            
} 
```

每次单击按钮时，此代码都会创建一个按钮，现在我想保存创建的按钮及其属性，以便它们可以在每次应用程序启动时出现..

在 C# Visual Studio 2010 中编码...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T14:42:16.540

一种解决方案可能是使用`StringCollection` **用户设置**（*编辑：在您的评论中，您说关闭应用程序时不会保留此设置。这不是真的，因为这是使用用户设置的全部意义......*）。

在每一行中，您需要将控件的位置和名称保存为字符串，例如

```
120;140;MyName 
```

当用户添加一个新按钮时，`StringCollection`像这样创建一个项目：

```
private void make_BookButtonAndStore(int x, int y, string name)
{
    make_Book(x,y,name);

    Properties.Settings.Default.ButtonStringCollection.Add(String.Format("{0};{1};{2}", book1.Location.X, book1.Location.Y, book1.Name));
    Properties.Settings.Default.Save();
}

private void make_Book(int x, int y, string name)
{
    // this code is initializing the book(button)
    Button book1 = new Button();
    Image img = button1.Image;
    book1.Image = img;
    book1.Name = name;
    book1.Height = img.Height;
    book1.Width = img.Width;
    book1.Location = new Point(44 + x, 19 + y);            
    book1.Click += new EventHandler(myClickHandler);
    groupBox1.Controls.Add(book1);
} 
```

然后，您需要`StringCollection`通过读取每一行，提取位置和名称并`make_book`再次调用来从每个项目创建按钮的代码（*不是*我的新`make_BookButtonAndStore`方法，因为这会使按钮加倍）。

请注意，您可能需要在添加第一个按钮之前`StringCollection`使用关键字创建。`new`

**编辑**
解释如何创建这样的设置：转到您的项目属性到“设置”选项卡。创建一个名为的新设置`ButtonStringCollection`，选择类型`System.Collections.Specialized.StringCollection`和范围`User`。

在表单的构造函数中，添加以下行：

```
if (Properties.Settings.Default.ButtonStringCollection == null)
    Properties.Settings.Default.ButtonStringCollection = new StringCollection(); 
```

然后，添加我上面提供的代码来创建按钮。此外，在表单的`Load`事件处理程序中，添加如下内容：

```
foreach (string line in Properties.Settings.Default.ButtonStringCollection)
{
    if (!String.IsNullOrWhitespace(line))
    {
        // The line will be in format x;y;name
        string[] parts = line.Split(';');
        if (parts.Length >= 3)
        {
            int x = Convert.ToInt32(parts[0]);
            int y = Convert.ToInt32(parts[1]);

            make_Book(x, y, parts[2]);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T14:40:41.603

当您调用`make_Book`方法时，您可以将输入参数保存到数据库或您的应用程序当前使用的其他存储中。当应用程序启动时，您可以通过调用`make_Book` 保存在应用程序存储中的值的方法来加载所有按钮。

*   [使用 XML 保存和恢复 .NET 表单的设置](http://www.c-sharpcorner.com/UploadFile/dolson/SaveandRestoreSetingsofa.NETFormusingXML11252005230324PM/SaveandRestoreSetingsofa.NETFormusingXML.aspx)
*   [使用序列化将对象加载和保存到 XML](http://www.codeproject.com/Articles/4491/Load-and-save-objects-to-XML-using-serialization)
*   [C# 中的 Windows 窗体用户设置](http://www.codeproject.com/Articles/15013/Windows-Forms-User-Settings-in-C)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T14:58:22.453

这是如何保存加载 xml 的示例。

```
public static void Save(string x, string y, string name)
    {
        if (!Directory.Exists(Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData) + "\\appName"))
        {
            Directory.CreateDirectory(Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData) + "\\appName");
        }

        XmlDocument xmlDocument = new XmlDocument();

        string xml = string.Format(@"<?xml version='1.0' encoding='utf-8'?><button><x>{0}</x><y>{1}</y><name>{2}</name></button>", x, y, name);

        xmlDocument.LoadXml(xml);

        xmlDocument.Save(Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData) + "\\appName\\button.xml");
    }

    public static Dictionary<string,string> Load()
    {
        string address = "";

        if (!File.Exists(Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData) + "\\appName\\button.xml"))
        {
            return new Dictionary<string,string>(){{"x",""},{"y",""},{"name",""}};
        }

        XmlDocument xmlDocument = new XmlDocument();
        xmlDocument.Load(Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData) + "\\appName\\button.xml");

        XmlNode button = xmlDocument.GetElementsByTagName("button").Item(0);

        XmlNode nameNode = button.SelectSingleNode("name");
        XmlNode xNode = button.SelectSingleNode("x");
        XmlNode yNode = button.SelectSingleNode("y");

        return new Dictionary<string, string>() { { "name", nameNode.InnerText }, { "x", xNode.InnerText }, { "y", yNode.InnerText } };
    } 
```

# java - Akka actor 的沙盒和监控

> ID：10739643
> 
> 赞同：2
> 
> 时间：2012-05-24T14:35:09.047
> 
> 标签：java, scala, jvm, akka

我想在一个 Akka Actor 系统中运行几个简单的 REST 应用程序，以节省内存并以一种简单的方式扩展它们。我可以防止它们互相攻击并确保它们都不会使整个系统崩溃吗？我可以防止系统在我的任何应用程序逻辑中阻塞线程和无限的内存消耗吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-24T15:25:21.713

你所要求的在 JVM 上是不可能的。

# drupal - 在运行时更改块区域（Drupal 6）

> ID：10739645
> 
> 赞同：1
> 
> 时间：2012-05-24T14:35:11.833
> 
> 标签：drupal, drupal-6

我的侧边栏有一堆不会在移动主题中呈现的块。但我需要其中一些在移动主题的自定义区域中呈现。试过：

```
mytheme_preprocess_block(&$vars) {
  $vars['block']->region = 'my_region';
} 
```

由于某种原因，我的 page.tpl.php 中的 $my_region 变量为空。该块具有内容和区域已定义且有效。切换块位置的解决方案是什么？非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T18:47:43.943

真的需要像这样显示它们吗？

在 my_region 中使用自定义模块和 hook_block() 添加一个块。

根据模块本身的移动主题条件，使用内部的自定义 php 代码显示所有块内容。

如果块是视图类型，请使用下面的代码打印视图内容：

```

    $view = views_get_view('视图名称');
    $view->set_display('block_1'); //或视图中的块ID
    $view_block = $view->execute_display('block_1', array());
    //如果第二个参数中有任何参数，则传递任何参数
    打印 $view_block['content'];

```

如果它只是块类型，请使用：

```
    $block = module_invoke('module_name["block" for blocks created from web interface]', 'block', 'view', 'delta');

    打印 $block['content'];

```

让我知道这是否令人困惑。

# drag-and-drop - 拖放ui自动化

> ID：10739647
> 
> 赞同：0
> 
> 时间：2012-05-24T14:35:17.067
> 
> 标签：drag-and-drop, ui-automation

我创建了以下代码，它将鼠标按下自动化元素的可点击点，然后将鼠标放在另一个元素的可点击点上。这应该具有拖放的效果，但它不会那样做。它的行为方式很奇怪。似乎只是选择项目而不是拖动。

```
public static void Main(String[] args)
        {
             contactsGrid.getCell("Cell Data").drag();
             navTree.getNode("Tree Data").drop();
        }

public void drag()
        {
            element.SetFocus();
            ScreenClick.leftDown(element);
        }

public void drop()
        {
            element.SetFocus();
            ScreenClick.leftUp(element);
        }

public static void leftDown(AutomationElement element)
        {
            while (!element.Current.IsKeyboardFocusable)
                element = TreeWalker.RawViewWalker.GetFirstChild(element);

            Point p;
            element.TryGetClickablePoint(out p);

            leftDown((int)p.X, (int)p.Y);
        }

public static void leftUp(AutomationElement element)
        {
            while (!element.Current.IsKeyboardFocusable)
                element = TreeWalker.RawViewWalker.GetFirstChild(element);

            Point p;
            element.TryGetClickablePoint(out p);

            leftUp((int)p.X, (int)p.Y);

        }

public static void leftDown(int x, int y)
        {
            Cursor.Position = new System.Drawing.Point(x, y);
            mouse_event((int)(MouseEventFlags.LEFTDOWN), 0, 0, 0, 0);
        }

public static void leftUp(int x, int y)
        {
            Cursor.Position = new System.Drawing.Point(x, y);
            mouse_event((int)(MouseEventFlags.LEFTUP), 0, 0, 0, 0);
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T07:05:00.757

尝试使用 mouse_event (MOUSEEVENTF_MOVE|..._ABSOLUTE) 代替 Cursor.Position 进行移动。

（请注意，它所采用的坐标与普通屏幕坐标不同，因此您必须进行一些映射/缩放，将整个屏幕视为 0,0 到 65535,65535 的空间 -[更多详细信息，请参见 mouse_event 的备注部分](http://msdn.microsoft.com/en-us/library/windows/desktop/ms646260(v=vs.85).aspx)。 )

通常，应用程序通过等待 WM_LBUTTONDOWN 来实现拖动，并且通常还期望一些 WM_MOUSEMOVE 消息，否则它们只会将普通的 UP/DOWN 视为单击，而不是拖动。我的猜测是，通过使用 Cursor.Position（它基本上是 SetCursorPos 的包装器），您“在不*移动*光标的情况下更改光标的位置” - 不会生成输入消息，因此底层应用程序永远不会收到任何 WM_MOUSEMOVE 消息并且从来没有意识到它应该在做拖累。

# ruby-on-rails - 用于预订系统的 Rails Gem

> ID：10739651
> 
> 赞同：5
> 
> 时间：2012-05-24T14:35:36.163
> 
> 标签：ruby-on-rails, calendar, gem

我环顾了 The Ruby Toolbox 和网络，并很好奇是否有人知道 GEM for rails 可以帮助您构建/创建预订系统（或教程）？类似于 airbnb.com 或 expedia.com 等常见的预订网站。

跟踪**To**和**From**预订日期并显示可用性等的东西。我相信你明白了。

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T16:31:03.820

它需要一些扩展，但一个很好的起点可能是[Refinery](http://refinerycms.com/)，特别是它的[事件引擎](https://github.com/resolve/refinerycms-calendar)。

事件引擎页面在 1.2 的 TODO 中列出了添加的日期选择器/日历，因此您也许可以为该项目做出贡献。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-03-30T20:53:52.763

这是一个构建简单日程应用程序的好教程。 [https://web-crunch.com/posts/lets-build-ruby-on-rails-event-scheduling-app-payments](https://web-crunch.com/posts/lets-build-ruby-on-rails-event-scheduling-app-payments)

这是帮助管理不可用性的宝石。 [https://github.com/khiet/unavailability](https://github.com/khiet/unavailability)

# performance - SQL Server 2008 在具有相同数据的 2 台服务器上进行相同查询的性能差异

> ID：10739652
> 
> 赞同：0
> 
> 时间：2012-05-24T14:35:36.747
> 
> 标签：performance, sql-server-2008

我正在使用 SQL Server 2008 R2 并且有一个简单的查询，例如

```
Select COLA 
from tableA 
where not exists (select 1 
                  from tableB
                  where COLA = tableB.colb)
and tablea.colc = 2 
```

我有 2 台具有相同数据集的相同服务器（从备份中恢复）。在其中一个上，查询在 4 秒内返回另一个（生产服务器）我让它运行 5 分钟，然后将其杀死。两台服务器上的估计计划相同。我还能在哪里以及其他什么地方找到性能差异。我知道有更好的方法来编写查询，但它是我们不应该更改的购买产品中的查询。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T15:25:26.823

这可能很明显，但硬件差异是什么？此外，表的大小和它必须解析的数据集是否相同？

您在这些实例上使用哪种索引。生产实例是否在 VM 上运行？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T15:15:48.967

你试过了`SQL Profiler`吗？

使用 时`SQL Profiler`，不要忘记`Database Name`在`Trace`属性中选择 ，如下所示。

数据库名称 ![单击此处查看数据库名称设置](../Images/a47aa781de752e4559e12b705b9da02f.png)

数据库表 ![点击这里查看数据库表设置](../Images/2c8c1cf939eb602c00110f919cc2eab4.png)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T16:59:29.470

既然你说一个盒子是物理的，另一个是虚拟的，我敢打赌这就是问题所在。虚拟系统必须与盒子的另一（物理）侧共享资源。此外，由于它不在虚拟环境中运行，因此物理盒子可能会进行性能调整。

案例：Denali 具有“处理器关联屏蔽”，可以限制每个实例的处理器使用量。

无论哪种方式，我都愿意打赌这是由于虚拟环境而不是物理环境。

希望这可以帮助！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-24T14:49:02.607

由于更多的用户或更多的自动化作业正在运行，统计数据可能已过时或产品服务器上可能存在阻塞。

# .net - 您如何使用实体框架处理查找表/数据？

> ID：10739654
> 
> 赞同：0
> 
> 时间：2012-05-24T14:35:45.693
> 
> 标签：.net, entity-framework

今天我正在创建代理实体以从内存中加载查找数据。

我建议，实体框架应该足够聪明，不会生成与 Country / Places -table 的连接

```
DbContext.Users.Include(u => u.Country.Select(c => c.Place)) 
```

相反，EF 应该从内存中获取数据。

**您**如何使用实体框架处理查找数据？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T15:49:27.780

因此，您希望 EF 在访问之前将所有查找表急切加载到内存中吗？这听起来有点混乱和沉重。（如果查找有更新怎么办？您将如何同步？）如果您使用 Pks，则可以快速加入查找表。如果您需要将查找表加载到内存中，您仍然需要在您的 linq 查询中连接到保存表数据的代理对象。我没有硬数据，但我看不出这两种技术在性能上存在很大差异。如果有的话，Linq 示例可能会更慢。

我的经验法则是：如果两种技术在速度和回报方面相似，请使用不太复杂且更易于维护的一种（在您的情况下，使用 Include()）。

# ruby-on-rails - 注意确定为什么 JQuery Draggable 不起作用

> ID：10739658
> 
> 赞同：0
> 
> 时间：2012-05-24T14:35:59.407
> 
> 标签：ruby-on-rails, jquery-ui

有一组文档，我想通过 JQuery 使其可拖动，并最终可排序。 ![在此处输入图像描述](../Images/be8491e6e3dbab68e1a9136c135e8069.png) 这些框是纯 CSS 生成的，就像我说的那样，我想让它们保持相同但可拖动。因为现在是那些基于 mongoid db 的笔记，我当然可以使用 ajax 成功创建和销毁。但我还没有运气让任何类型的拖动工作。下面是相关代码。谷歌搜索我，至少希望，没有看到任何代码问题，所以也许我的 jquery 已损坏？如果我的代码是正确的，我可以采取哪些步骤来确保 query-ui 正确加载了可拖动功能...谢谢您对 application.js 的帮助

```
//= require jquery
//= require jquery-ui
//= require jquery_ujs
//= require bootstrap
//= require_tree . 
```

应用程序/视图/文档/_document

```
<li>
    <div id=<%= dom_id(document) %> class="document">
    <div class="note">
      <h2><%= document.title %></h2>
      <p></p>
      <%= link_to content_tag(:i, "", class: "icon-trash"), document, method: :delete, remote: true %>
    </div>
  </div>
  </li> 
```

应用程序/视图/用户/index.html.erb

```
<div class="container">
    <div class="content">
    <div class="notes">
      <ul>
        <%= link_to documents_path, method: :post, remote: true  do %>
        <li>
          <div class="note">
            <h2> </h2>
            <p>create</p>
          </div>
        </li>
        <% end %>
      </li>
      <div id="documents">
        <%= render @documents %>
      </div>
    </ul>
  </div>
</div>
</div> 
```

/app/assets/javascripts/document.js.coffee

```
JQuery ->
    $( ".note" ).draggable(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T15:20:44.253

发现了问题，我有“JQuery ->”而不是“jQuery ->” -</p>

# sql-server - Microsoft Access 交叉表查询 - 转换为 MSSQL 视图

> ID：10739660
> 
> 赞同：1
> 
> 时间：2012-05-24T14:36:02.293
> 
> 标签：sql-server, ms-access, transform, pivot, crosstab

我在访问中有下表（odbc 链接到实际的 mssql 表） ![桌子](../Images/f4fe4d68a4c3fbe5eb9bca9368638468.png)

我可以创建表的交叉表查询以将其转换为这种格式 ![交叉表](../Images/0ba576708f595cb8701f3b251929e2c6.png)

access中生成的sql如下：

```
TRANSFORM First(dbo_85137_PHY_Long_MP.[StatColumnValue]) AS FirstOfStatColumnValue
SELECT dbo_85137_PHY_Long_MP.[StatDate]
FROM dbo_85137_PHY_Long_MP
GROUP BY dbo_85137_PHY_Long_MP.[StatDate]
PIVOT dbo_85137_PHY_Long_MP.[StatColumnName]; 
```

我试图在 mssql 中创建相同的 sql 无济于事（试图创建一个视图）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-25T12:15:30.207

由于您使用的是 SQL Server，因此您将需要使用[PIVOT](http://msdn.microsoft.com/en-us/library/ms177410%28v=sql.105%29.aspx)运算符。您可以通过静态 PIVOT 或动态 PIVOT 两种方式执行此操作。

静态**PIVOT**意味着您将为需要旋转的每一列编码。因为看起来你有很多专栏，我怀疑你会想要这样做。但代码将与此类似：

```
create table t1
(
  statno int,
  statdate datetime,
  statcolumnname varchar(50),
  statcolumnvalue int
)

insert into t1 values (1, '4/1/2012 12:15:00', 'MPB-1MA.MP00-1MA', 17)
insert into t1 values (1, '4/1/2012 12:15:00', 'MPB-1MA.MP01-1MA', 18)
insert into t1 values (1, '4/1/2012 12:15:00', 'MPB-1MA.MP02-1MA', 18)
insert into t1 values (1, '4/1/2012 12:15:00', 'MPB-1MA.MP03-1MA', 18)
insert into t1 values (1, '4/1/2012 12:15:00', 'MPB-1ME.MP10-1ME', 26)
insert into t1 values (1, '4/1/2012 12:15:00', 'MPB-1ME.MP11-1ME', 2)
insert into t1 values (1, '4/1/2012 12:15:00', 'MPB-1ME.MP12-1ME', 2)
insert into t1 values (1, '4/1/2012 12:15:00', 'MPB-2MC.MP08-2MC', 2)
insert into t1 values (1, '4/1/2012 12:15:00', 'MPB-2MC.MP09-2MC', 22)
insert into t1 values (1, '4/1/2012 12:15:00', 'MPB-2MC.MP0A-2MC', 22)
insert into t1 values (1, '4/1/2012 12:15:00', 'MPB-2MC.MP0B-2MC', 22)

select *
from 
(
  select statdate, statcolumnname, statcolumnvalue
  from t1
) x
pivot
(
  min(statcolumnvalue)
  for statcolumnname in ([MPB-1MA.MP00-1MA], [MPB-1MA.MP01-1MA], [MPB-1MA.MP02-1MA])
) p 
```

这是一个带有工作示例的[SQL Fiddle 。](http://sqlfiddle.com/#!3/75c4b/1)

如果您有很多列，那将非常麻烦。因此，您还可以使用**Dynamic Pivot**，它会在您运行查询时生成要旋转的列列表。这是代码：

```
DECLARE @cols AS NVARCHAR(MAX),
    @query  AS NVARCHAR(MAX);

select @cols = STUFF((SELECT distinct ',' + QUOTENAME(c.statcolumnname) 
            FROM t1 c
            FOR XML PATH(''), TYPE
            ).value('.', 'NVARCHAR(MAX)') 
        ,1,1,'')

set @query = 'SELECT statdate, ' + @cols + ' from 
            (
                select statdate, statcolumnname, statcolumnvalue
                from t1
           ) x
            pivot 
            (
                 min(statcolumnvalue)
                for statcolumnname in (' + @cols + ')
            ) p '

execute(@query) 
```

他们都会给你同样的结果。

# android - 特定的双击

> ID：10739662
> 
> 赞同：1
> 
> 时间：2012-05-24T14:36:02.847
> 
> 标签：android

我有可缩放的图像，我正在使用`ScaleGestureDetector.SimpleOnScaleGestureListener`. 我需要实施以下项目：

1.  单击时会出现带有图片信息的 Toast。
2.  双击图像正在缩放。

我有一些问题。在双击之前始终是单击并且图片正在缩放，但出现 Toast。有什么办法可以避免单击吗？我没有足够的智慧来解决这个问题。

**PS**我**不能使用`OnDoubleTapListener`**，因为使用`ScaleGestureDetector.SimpleOnScaleGestureListener`.

**UPD**

```
case MotionEvent.ACTION_UP:
    firstTime = System.currentTimeMillis();
    if (Math.abs(firstTime-secondTime) < 300L) {
    // scale my matrix
    ---//---
    DONE = true; //this flag symbolize, that toast doesn't appear (false - appears)
    }
    else if (!DONE) {
         // making toast
    }
    secondTime = firstTime;
    break; 
```

当 DoubleTap 启用图像缩放但出现 toast 时

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-27T17:24:11.970

@matt5784，谢谢。我能够解决我的问题。

```
case MotionEvent.ACTION_UP:
    float xDiff =  Math.abs(curr.x - start.x);
    float yDiff =  Math.abs(curr.y - start.y);
    firstTime = System.currentTimeMillis();
    if (Math.abs(firstTime-secondTime) > 200L) {
        myHand.postDelayed(mRun, 200);
    }
    else if (!DONE) {
        //scale my matrix
        DONE = true; //this flag symbolize, that toast doesn't appear (false - appears)
    }
    secondTime = firstTime;
    break;

Handler myHand = new Handler();
private Runnable mRun = new Runnable() {
    @Override
    public void run() {
        if (!DONE) {
                     // make toast
        }
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T14:47:40.780

我建议实施延迟，其中信息不会在单击时立即弹出，但只有在合理的时间内没有遇到第二次点击时才会显示（可能是双击的阈值） . 即，如果设置为在 0.2 秒内将任何轻按注册为双击，则在您等待 0.2 秒并确定没有双击之前不要显示信息。

替代解决方案（可能不太有用） - 让双击/缩放功能调用使信息框消失的任何功能。但是，它可能仍会在很短的时间内弹出，这可能看起来很愚蠢/有问题。

# android - 从android中的处理程序获取应用程序实例

> ID：10739663
> 
> 赞同：0
> 
> 时间：2012-05-24T14:36:08.883
> 
> 标签：android, multithreading

我正在尝试解决以下问题：我正在编写一个具有多个共享数据模型的活动的应用程序。应用程序启动时从数据库中获取数据并保存为应用程序类扩展中的全局变量，如下所示：

```
class MyApp extends Application {

  private MyData myData;

  public MyData getData(){
    return myData;
  }
  public void setData(MyData d){
    myData = d;
    sendBroadcast(new Intent("DATA_UPDATED"););
  }
} 
```

AndroidManifest.xml 当然会更新，一切正常 - 每个活动都可以读取数据并更新它，其他活动可以使用 BroadcasrReceiver 获取数据更改的通知。当我有另一个应该更新主（GUI）线程的线程时，事情就会出现问题：我有一个服务，其中包含从数据库接收到新数据时的回调。回调在新线程上运行，因此更新我的应用程序数据模型必须在主线程上完成。为此，我使用了如下处理程序：

```
public void ServiceCallback(...newData) {           
    //Pass the message up to our handler to make the update on the main thread.
    Message receipt = Message.obtain(mHandler, 0, newData);
    receipt.sendToTarget();       
}

    //Handle incoming message from remote on the main thread (GUI thread)
    private Handler mHandler = new Handler() 
{
     @Override
     public void handleMessage(Message msg) 
     {
    //read new data from the message - from msg.obj field, no prob.             
    //but - how can i get to my application model instance????
     }
}; 
```

所以我虽然完全按照我在消息中传递 new_data 的方式传递它，但我[在这篇文章中看到了](https://stackoverflow.com/questions/4481928/android-getting-activity-instance-in-application-from-handler)

这可能会导致内存泄漏...？我不明白它是否属实以及为什么，也许我还有其他任何人都可以建议的解决方案？我真的很感激。是否可以在线程之间使用广播接收器？也许这是我的解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T14:43:20.127

有点不清楚你到底想做什么。需要注意的几件事：将应用程序对象用于共享/全局数据并不能真正为您买任何东西。您可以简单地使用单例。如果你想使用`Application`，你可以给它添加一个静态`getInstance()`方法，因为只有一个实例，根据定义它是一个单例，添加该方法只会让非活动类更容易访问。您不必`Application`在主线程的类中更新数据。当你处理 UI 时，你只需要在主线程上做一些事情。

此外，如果您只是想向另一个线程发送消息，a`Handler`就足够了。没有必要参与`BroadcastReceivers`。

# jquery - 用户在表单中输入信息，然后表单信息显示在同一页面中

> ID：10739664
> 
> 赞同：0
> 
> 时间：2012-05-24T14:36:10.997
> 
> 标签：jquery, html, css, ajax

我正在尝试制作一个表单，我的朋友可以输入信息并将其显示在同一页面上，因此他在文本字段中输入标题单击提交，它将进入标题框中，他也可以将信息放入字段中，例如高度和宽度，它将创建一个具有该高度和宽度的 div。这是我到目前为止得到的[http://www.nathanrobjohn.com/](http://www.nathanrobjohn.com/)建议使用最佳语言等会很有帮助，谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T14:55:22.907

你可以使用 [jquery表单插件](http://jquery.malsup.com/form/)

# javascript - 主干需要js注册

> ID：10739666
> 
> 赞同：0
> 
> 时间：2012-05-24T14:36:13.157
> 
> 标签：javascript, backbone.js, requirejs

如何在 Backbone js 中创建注册表单？并将 POST 发送到我的后端，我不明白在这种情况下收集的想法。

**到目前为止我得到了什么：**

```
define(['jQuery', 'Underscore', 'Backbone', 'text!templates/signup.html', 'models/UserRegistration'],
function($, _, Backbone, signUpTemplate, UserRegistration){

    var SignUpView = Backbone.View.extend({
        el: $('#screen'),

        events: {
            'submit #frm-signup': 'signup'
        },

        signup: function(){
            // Do something
        },

        render: function(){
            $(this.el).html(_.template(signUpTemplate, {}));
            return this;
        }
    });

    return new SignUpView;
}); 
```

**还有一个模型：**

```
define(['Underscore', 'Backbone'],
function(_, Backbone){

    var UserRegistration = Backbone.Model.extend({
        url: '/users/reg',
        paramRoot: 'user',
        defaults: {
            'fullname': '',
            'email': '',
            'password': ''
        }
    });

    return UserRegistration;
}); 
```

将其发布到我的 REST 后端服务器的下一步是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T15:03:24.580

`Backbone.Model``save`当你调用它的函数时，它会向服务器发送一个 POST 。因此，假设您在调用注册时已经从表单中填充了模型，那么这只是调用保存的情况：

```
signup: function(){
            this.model.save();
        }, 
```

或者，您可以将要保存的详细信息传递到保存函数中：

```
signup: function(){
            this.model.save({
                      fullname: $( '#fullname' ).val(),
                      email : $( '#email' ).val()
                      ...
                      });
        }, 
```

可能值得注意的是，您还需要在某个时候在视图上创建模型（您的代码目前似乎没有这样做）。

因此，当您创建视图时：

```
new SignUpView({ model: new UserRegistration }); 
```

# java - 用于 Java 的 C++ setw()

> ID：10739671
> 
> 赞同：1
> 
> 时间：2012-05-24T14:08:22.313
> 
> 标签：java, c++

Java 中是否有像`setw(int)`C++ 中的函数？
矩阵输出中需要它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T23:52:20.733

Java 的`java.util.Formatter`类不提供字段宽度的动态规范 la`setw()`或`printf`的动态宽度说明符`*`（如`%*s`，它从列表中读取参数以获取宽度）。

但是，您可以通过两次传递来完成同样的事情，一次通过插入宽度构建格式字符串，然后使用格式字符串写入输出。

# django - 在 Django 表单集中更改/删除图像

> ID：10739679
> 
> 赞同：0
> 
> 时间：2012-05-24T14:36:56.167
> 
> 标签：django, sorl-thumbnail, formset

我正在使用表单集上传图像并使用多对多关系将它们链接到模型。我在状态表单下方显示表单集，以便用户可以填写状态字段+添加图像，然后单击“保存”或“保存并添加另一个图像”。

在最后一种情况下，它应该显示预填充的状态表单，然后在表单集中一个包含处理上传文件的常用内容的块（一个指向图像的链接，一个删除复选框和一个文件输入以上传不同的图像）最后是一个空白文件输入以上传第二张图片。现在，我有 2 个空白文件输入。

表单集知道已经上传了 1 张图片，但它没有显示任何管理它的内容。这是 Formset 中 ImageField 的正常行为，还是我提供 formset 数据的方式有问题？

这是代码：

```
# Models
class Image(models.Model):
    image = ImageField(upload_to='uploads/status/images/',)

class Status(models.Model):
    author = models.ForeignKey(User,)
    images = models.ManyToManyField(Image, blank=True, null=True)
    body = models.TextField()

# Forms
class StatusForm(forms.ModelForm):
    class Meta:
        model = Status
        fields = ['body',]

class ImageForm(forms.ModelForm):
    class Meta:
        model = Image
        fields = ['image',]

# View
@csrf_protect
def form(request, id=None, template_name='status/form.html'):
    if id:
        status = get_object_or_404(Status, pk=id)
        images = status.images.all().values()
    else:
        status = Status(author=request.user)
        images = None

    if request.method == 'POST':
        form = StatusForm(request.POST, instance=status)
        formset = ImageFormSet(request.POST, request.FILES, initial=images)

        if form.is_valid():
            try:
                status = form.save()

                if formset.is_valid():
                    try:
                        for form in formset:
                            image = form.save()
                            status.images.add(image)
                            status.save()

                        if request.POST.get('_add_image', None):
                            return HttpResponseRedirect(reverse('status_edit', args=[status.id]))
                        else:
                            messages.success(request, 'Status saved')
                            return HttpResponseRedirect(request.POST.get('next', '/'))
                    except:
                        messages.error(request, 'Technical error')
            except:
                messages.error(request, 'Technical error')
    else:
        form = StatusForm(instance=status)
        formset = ImageFormSet(initial=images)

    return render_to_response(template_name, {
        'form': form,
        'formset': formset,
        'next': request.GET.get('next', '/'),
    }, context_instance=RequestContext(request)) 
```

模板：

```
<form action="" method="post" enctype="multipart/form-data">
    {% csrf_token %}
    {{ form.non_field_errors }}
    <input type="hidden" name="next" value="{{ next }}" />
    {{ form.body }}
    {{ form.body.errors }}
    <hr />
    {{ formset }}
    <hr />
    <div class="pull-right">
        <input name="_add_image" class="btn" type="submit" value="Add another image">
        <input name="_complete" class="btn btn-primary" type="submit" value="Save">
    </div>
</form> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T16:02:04.297

M2M 关系是“正常的”。按照目前的设计，内联表单集要求有一个外键返回到正在编辑的主对象。唯一存在的地方是 M2M 关系的连接表（Django 术语中的“通过”模型）。该模型本身通常只包含两个外键，关系的每一侧一个。

我玩弄了创建一个自定义表单的想法，该表单包括您要编辑的模型上的所有字段以及用于选择现有字段的普通选择字段，然后从表单中的字段创建一个新实例的逻辑并将其分配给唯一的真实字段，即外键。但是，要编写的代码*很多*，其中大部分代码都是独特的并且特定于每个使用场景，而且很脆弱（您必须意识到始终保持表单和模型同步）。我最终放弃了这个想法。也许，有一天，Django 会为此提供一些机制，但就目前而言，最好只是处理。

# identity - 测试我们的 SAML 身份提供程序软件？

> ID：10739681
> 
> 赞同：0
> 
> 时间：2012-05-24T14:37:00.950
> 
> 标签：identity, provider, saml

我们将 siteminder 作为 SSO 解决方案运行。我们将使用其 SAML 功能为第三方授权人员（我们将成为身份提供者）。是否有可以安装的开源软件允许我设置 SAML 并测试我们的身份提供程序设置？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-26T05:26:20.040

我肯定会建议使用 SimpleSAMLPHP (http://simplesamlphp.org/docs/1.9/simplesamlphp-sp)

您也可以将 Google Apps for Business 服务用作 SAML 服务提供商。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-25T18:35:28.593

也许你想看看[http://www.testshib.org](http://www.testshib.org)。

您可以在具有全球 DNS 的机器上托管您的 IdP 服务器，然后在 testhib.org 上配置您的 IdP。然后它将有一个 SP 连接到您。

# apache-flex - 为什么 FDT 5.5 找不到我的 Flex SDK？

> ID：10739690
> 
> 赞同：9
> 
> 时间：2012-05-24T14:37:29.443
> 
> 标签：apache-flex, sdk, installation, fdt

我从 Adob​​e 下载了最新的 Flex SDK；但是，当 FDT 要求我定位 SDK 时，它没有找到它们。

我也尝试在 FDT 的插件文件夹中搜索：

plugins/com.powerflasher.fdt.shippedFlexSDK4_4.5.0.20967_1000 plugins/com.powerflasher.fdt.shippedFlexSDK_3.6.0.16995_1000

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-24T14:37:29.693

FDT 需要两件事才能找到有效的 SDK：

1.  SDK 需要解压。
2.  需要有一个有效的“flex-sdk-description.xml”文件。

只有这样，FDT 才能找到 SDK。

FDT 的“plugins”文件夹中的文件夹已过时且不包含任何内容。它们将在 FDT 的未来版本中删除。

# asp.net-mvc - 如何为 ApiControllers 返回多个对象类型

> ID：10739695
> 
> 赞同：2
> 
> 时间：2012-05-24T14:37:38.297
> 
> 标签：asp.net-mvc, asp.net-mvc-3, asp.net-mvc-4, asp.net-web-api

我已将我的项目升级为使用 MVC3 中的 ASP.NET MVC4。现在我的控制器正在使用 ApiController 而不是控制器。以前我使用的功能是：

```
 public JsonResult GetPermissions(string portfolioId)
 {
     //DO THE DATA FETCH
     return Json(new { PermissionValues = permissionValues,       UserPermissions = userPermissions, OwnerValues = ownerList },JsonRequestBehavior.AllowGet);
 } 
```

我想使用 ApiControllers 做类似的操作。我不想创建一个单独的对象，该对象将具有 3 个属性 [因为我要返回 3 个列表]。我试图`HttpResponseMessage<Object>`用作函数的返回类型，但似乎不起作用。

```
 public HttpResponseMessage<Object> GetPermissions(string portfolioId)
    {
      //DO THE DATA FETCH
      HttpResponseMessage<Object> response = new HttpResponseMessage<Object>(new { Users = listedUsers, PermissionValues = permissionValues });
      return response;
    } 
```

有任何想法吗 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T15:47:46.837

您遇到的主要问题是 Beta 位中 json 响应的默认序列化程序无法序列化匿名类型。您需要使用可以的格式化程序，例如基于 Json.NET 的格式化程序（将在下一个 drop 中内置）。为了使这项工作与 Beta 版一起使用，您的代码将更改为如下所示：

```
public HttpResponseMessage Get()
{
    var content = new { Users = new List<string> { "John", "Mary" }, Permissions = new List<string> { "User", "Admin" } };
    return new HttpResponseMessage<object>(content, new[] { new JsonNetFormatter() });
} 
```

这会产生这样的响应：

```
{"Users":["John","Mary"],"Permissions":["User","Admin"]} 
```

一旦 RC 可用，您现有的代码应该可以正常工作。

更新：

为了编译此代码，您需要 JsonNetFormatter 的实现。[您可以在http://code.msdn.microsoft.com/Using-JSONNET-with-ASPNET-b2423706#content](http://code.msdn.microsoft.com/Using-JSONNET-with-ASPNET-b2423706#content)或在[https://github.com/WebApiContrib](https://github.com/WebApiContrib/WebAPIContrib/blob/master/src/WebApiContrib.Formatting.JsonNet/JsonNetFormatter.cs)的 WebApiContrib 项目中找到 Henrik (MSFT) 提供的实现[/WebAPIContrib/blob/master/src/WebApiContrib.Formatting.JsonNet/JsonNetFormatter.cs](https://github.com/WebApiContrib/WebAPIContrib/blob/master/src/WebApiContrib.Formatting.JsonNet/JsonNetFormatter.cs)。

请注意，它们都在 OnWriteToStreamAsync 方法中遇到相同的错误。这些实现关闭了底层流。您需要将 using 语句更改为如下所示：

```
using (var jsonTextWriter = new JsonTextWriter(new StreamWriter(stream, Encoding)) { CloseOutput = false }) 
```

Henrik 在他的博客中指出了这一点，但他的示例和 contrib 都没有更新，我只是没有时间将修复提交到 contrib 项目。;)

# android - 由于切换案例方法而强制关闭？

> ID：10739701
> 
> 赞同：0
> 
> 时间：2012-05-24T14:37:54.603
> 
> 标签：android

```
@Override
public void onClick(View v) {
    // TODO Auto-generated method stub
    switch (v.getId()){
    case R.id.upArrow:
        upSound.start();

        En_description.setText("\"Straight Ahead\"");
        break;

    case R.id.downArrow:
        downSound.start();

        En_description.setText("\"Down\"");
        break;

    case R.id.rightArrow:
        rightSound.start();

        En_description.setText("\"Right\"");
        break;

    case R.id.leftArrow:
        leftSound.start();

        En_description.setText("\"Left\"");
        break;
    default: 

    }
} 
```

代码很简单，当我按下箭头时，它会输入方向并播放声音，出于某种原因它有时会起作用，有时我会强制关闭帮助谢谢这是日志

```
05-24 17:52:20.384: W/dalvikvm(343): threadid=3: thread exiting with uncaught exception (group=0x4001b188)
05-24 17:52:20.394: E/AndroidRuntime(343): Uncaught handler: thread main exiting due to uncaught exception
05-24 17:52:20.404: E/AndroidRuntime(343): java.lang.NullPointerException
05-24 17:52:20.404: E/AndroidRuntime(343):  at com.aboutera.learnArabic.Directions.onClick(Directions.java:77)
05-24 17:52:20.404: E/AndroidRuntime(343):  at android.view.View.performClick(View.java:2364)
05-24 17:52:20.404: E/AndroidRuntime(343):  at android.view.View.onTouchEvent(View.java:4179)
05-24 17:52:20.404: E/AndroidRuntime(343):  at android.view.View.dispatchTouchEvent(View.java:3709)
05-24 17:52:20.404: E/AndroidRuntime(343):  at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:884)
05-24 17:52:20.404: E/AndroidRuntime(343):  at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:884)
05-24 17:52:20.404: E/AndroidRuntime(343):  at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:884)
05-24 17:52:20.404: E/AndroidRuntime(343):  at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:884)
05-24 17:52:20.404: E/AndroidRuntime(343):  at com.android.internal.policy.impl.PhoneWindow$DecorView.superDispatchTouchEvent(PhoneWindow.java:1659)
05-24 17:52:20.404: E/AndroidRuntime(343):  at com.android.internal.policy.impl.PhoneWindow.superDispatchTouchEvent(PhoneWindow.java:1107)
05-24 17:52:20.404: E/AndroidRuntime(343):  at android.app.Activity.dispatchTouchEvent(Activity.java:2061)
05-24 17:52:20.404: E/AndroidRuntime(343):  at com.android.internal.policy.impl.PhoneWindow$DecorView.dispatchTouchEvent(PhoneWindow.java:1643)
05-24 17:52:20.404: E/AndroidRuntime(343):  at android.view.ViewRoot.handleMessage(ViewRoot.java:1691)
05-24 17:52:20.404: E/AndroidRuntime(343):  at android.os.Handler.dispatchMessage(Handler.java:99)
05-24 17:52:20.404: E/AndroidRuntime(343):  at android.os.Looper.loop(Looper.java:123)
05-24 17:52:20.404: E/AndroidRuntime(343):  at android.app.ActivityThread.main(ActivityThread.java:4363)
05-24 17:52:20.404: E/AndroidRuntime(343):  at java.lang.reflect.Method.invokeNative(Native Method)
05-24 17:52:20.404: E/AndroidRuntime(343):  at java.lang.reflect.Method.invoke(Method.java:521)
05-24 17:52:20.404: E/AndroidRuntime(343):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:860)
05-24 17:52:20.404: E/AndroidRuntime(343):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:618)
05-24 17:52:20.404: E/AndroidRuntime(343):  at dalvik.system.NativeStart.main(Native Method)
05-24 17:52:20.414: I/dalvikvm(343): threadid=7: reacting to signal 3
05-24 17:52:20.414: E/dalvikvm(343): Unable to open stack trace file '/data/anr/traces.txt': Permission denied
05-24 17:52:22.534: I/Process(343): Sending signal. PID: 343 SIG: 9 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T14:44:04.303

不确定这是否是您的问题，但您可以在执行 v.getId() 之前尝试对 v 进行空检查。

```
if (v != null)
{
    // Do switch statement
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T15:02:26.310

在使用它们之前检查以验证 upSound、downSound、leftSound、rightSound 是否都已初始化（非 null）

```
if (upSound != null)
  upSound.start(); 
```

也为 downSound、leftSound、rightSound 做

您可以即时初始化声音，以确保声音是否为空，无论如何它都会播放..

```
 if (upSound == null)
     upSound = MediaPlayer.create(Directions.this, R.raw.up_sound);
  upSound.start(); 
```

此外，您的 textView`En_description`也可能为 null，这也可能导致此崩溃。确保无论您在哪里检索`En_description`（使用 findViewById）都成功完成

# database - CodeIgniter 分离数据库

> ID：10739706
> 
> 赞同：0
> 
> 时间：2012-05-24T14:38:18.673
> 
> 标签：database, codeigniter

我的问题是我正在使用 CodeIgniter 开发一个站点，而实际站点和管理员位于不同的文件夹中，并使用它们自己的控制器、视图和模型。

我想`database.php`两者都只使用一个，我真的不知道如何将管理数据库连接参数指向站点的`database.php`

有人可以给我一个提示吗？

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T08:24:25.923

只是在上面添加我的评论作为答案，以便帮助其他人了解解决问题的方法-

如果两个站点都在同一个服务器上 - 实现这一目标的最快方法之一是设置 database.php 中的所有值，而在另一个中删除所有内容并添加这一行 -

```
include(/full/path/application/config/database.php) ; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T15:02:55.353

您可以在控制器和视图中使用文件夹，而不是使用两个 CI 结构。例如：

```
application
  controllers
    admin
      login.php 
```

这将产生一个像这样的网址：`mysite.com/admin/login/`

只需确保不在控制器的根目录中创建 Admin 类。

有了这个，您将只有一个用于管理控制器和普通控制器的数据库配置。

# c# - ODP.Net 和 C# 的 System.Reflection.RuntimeModule.GetTypes() 错误

> ID：10739707
> 
> 赞同：5
> 
> 时间：2012-05-24T14:38:19.023
> 
> 标签：c#, ado.net, odp.net, odac

我编写了一个相当复杂的 C# 应用程序，它通过 ODP.Net 访问 oracle 数据库。我在安装了 ODAC（32 位）的 Windows XP 机器（32 位）上开发了该应用程序。该应用程序在我的开发 PC 上运行没有故障，但在服务器上引发异常（windows server 2003 x64 service pack 2）。

我在服务器上安装了 .Net framework 4.0 (dotNetFx40_Full_x86_x64.exe) 的运行时以及 ODAC——我首先尝试使用 Windows x64 的 Release 4 (11.2.0.3.0)，然后使用 ODAC 11.2 Release 4 (11.2\. 0.3.0) 与适用于 Visual Studio 的 Oracle 开发人员工具。

没有一个工作。32 位版本更进一步。第一次在数据库上调用 LINQ 语句时，我收到以下消息。

```
 at System.Reflection.RuntimeModule.GetTypes(RuntimeModule module)
   at System.Reflection.RuntimeModule.GetTypes()
   at System.Reflection.Assembly.GetTypes()
   at System.Data.Metadata.Edm.ObjectItemAttributeAssemblyLoader.LoadTypesFromAssembly()
   at System.Data.Metadata.Edm.ObjectItemAssemblyLoader.Load()
   at System.Data.Metadata.Edm.ObjectItemAttributeAssemblyLoader.Load()
   at System.Data.Metadata.Edm.AssemblyCache.LoadAssembly(Assembly assembly, Boolean loadReferencedAssemblies, ObjectItemLoadingSessionData loadingData)
   at System.Data.Metadata.Edm.AssemblyCache.LoadAssembly(Assembly assembly, Boolean loadReferencedAssemblies, KnownAssembliesSet knownAssemblies, EdmItemCollection edmItemCollection, Action`1 logLoadMessage, Object& loaderCookie, Dictionary`2& typesInLoading, List`1& errors)
   at System.Data.Metadata.Edm.ObjectItemCollection.LoadAssemblyFromCache(ObjectItemCollection objectItemCollection, Assembly assembly, Boolean loadReferencedAssemblies, EdmItemCollection edmItemCollection, Action`1 logLoadMessage)
   at System.Data.Metadata.Edm.ObjectItemCollection.ImplicitLoadAssemblyForType(Type type, EdmItemCollection edmItemCollection)
   at System.Data.Metadata.Edm.MetadataWorkspace.ImplicitLoadAssemblyForType(Type type, Assembly callingAssembly)
   at System.Data.Objects.ObjectContext.GetTypeUsage(Type entityCLRType)
   at System.Data.Objects.ObjectContext.GetEntitySetForNameAndType(String entitySetName, Type entityCLRType, String exceptionParameterName)
   at System.Data.Objects.ObjectContext.CreateObjectSet[TEntity](String entitySetName)
   at MyProgram.Data.DT.DTContext3.get_MYTABLE() 
```

64 位版本告诉我没有 Oracle.Access 支持，这与我第一次尝试在服务器上没有 ODAC 的情况下运行应用程序时收到的原始错误消息相同。

你们中的任何人都可以帮助我吗？我见过一些讨论类似问题的条目，我看到的唯一令人信服的答复是构建可执行文件，并将所有引用的 Copy Local 设置为 TRUE，但即使这样也失败了。我仍然收到相同的错误消息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T08:07:12.247

我自己找到了答案。这段代码是我在关于这个问题的讨论中发现的 bgripka 的一个条目，它给了我答案。有一个对丢失库的引用（根本不需要）。

```
 catch (ReflectionTypeLoadException ex)
    {
        StringBuilder sb = new StringBuilder();
        foreach (Exception exSub in ex.LoaderExceptions)
        {
            sb.AppendLine(exSub.Message);
            if (exSub is FileNotFoundException)
            {
                FileNotFoundException exFileNotFound = exSub as FileNotFoundException;
                if (!string.IsNullOrEmpty(exFileNotFound.FusionLog))
                {
                    sb.AppendLine("Fusion Log:");
                    sb.AppendLine(exFileNotFound.FusionLog);
                }
            }
            sb.AppendLine();
        }
        string errorMessage = sb.ToString();
        log.Fatal(errorMessage);
    } 
```

# cakephp - CakePhp ACL 检查在应用程序中失败，但在蛋糕控制台中失败

> ID：10739711
> 
> 赞同：0
> 
> 时间：2012-05-24T14:38:48.737
> 
> 标签：cakephp, acl

我正在构建一个需要使用 ACL 的应用程序。我正在尝试检查我的一个控制器中的操作中的权限。这是我的蛋糕控制台代码，它有效：

```
./cake acl check Group.83 controllers all
Group.83 is allowed. 
```

但是，在我的控制器中，当我使用此代码时，它应该返回 true：

$checkPerm = $this->Acl->check('Group.83', 'controllers', 'all');

我收到此错误：

```
Warning (512): DbAcl::check() - Failed ARO/ACO node lookup in permissions check.  Node references:
Aro: Group.83
Aco: controllers [CORE/cake/libs/controller/components/acl.php, line 273] 
```

我知道我的 ACL 设置正确，否则 cake 控制台命令会失败。我认为它在我的控制器中，但我不确定是什么导致了这个错误。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T14:45:40.970

shell 使用点语法，因为数组或正斜杠不起作用。然后，shell 提取并使其可由组件读取，该组件使用数组语法。将您的支票更改为：

```
$checkPerm = $this->Acl->check(array(
  'model' => 'Group',
  'foreign_key' => 83
), 'controllers', 'all'); 
```

那应该照顾它！

# nhibernate - 将联合子类与 NHibernate 一起使用时，是否必须为抽象和无表基类指定表？

> ID：10739714
> 
> 赞同：-1
> 
> 时间：2012-05-24T14:39:08.787
> 
> 标签：nhibernate, inheritance, nhibernate-mapping

我们有一个 BaseEntity，我们所有的其他域类都继承它。在这个 BaseEntity 上有一些基本属性。例如，这可能是类似`DateLastChange`的。

我们将 NHibernate 与`hbm`映射文件一起使用。我试图避免必须`DateLastChange`在每个映射文件中进行映射。

我发现了 Ayende 的[这篇文章](http://ayende.com/blog/3941/nhibernate-mapping-inheritance)`union-subclass`，这让我相信我可以用它来实现这一点（参见他的最后一种方法）。然而，他为他的抽象类包含了一个表名，这不在他的表模式中。

```
<class name="Party"
    abstract="true"
    table="Parties">
... 
```

该表是否必须存在，或者 NHibernate 是否会忽略此属性？然后我可以省略它吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T07:49:59.930

这不是必需的。根据[文档](http://docs.jboss.org/hibernate/orm/3.3/reference/en/html/inheritance.html#inheritance-tableperconcrete)（感谢 kalki）：

```
<class name="Payment">
    <id name="id" type="long" column="PAYMENT_ID">
        <generator class="sequence"/>
    </id>
    <property name="amount" column="AMOUNT"/>
    ...
    <union-subclass name="CreditCardPayment" table="CREDIT_PAYMENT">
        <property name="creditCardType" column="CCTYPE"/>
        ...
    </union-subclass>
    <union-subclass name="CashPayment" table="CASH_PAYMENT">
        ...
    </union-subclass>
    <union-subclass name="ChequePayment" table="CHEQUE_PAYMENT">
        ...
    </union-subclass>
</class> 
```

和：

> 如果你的超类是抽象的，用 abstract="true" 映射它。如果它不是抽象的，则需要一个附加表（在上面的示例中默认为 PAYMENT）来保存超类的实例。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-24T14:53:40.403

我在fluentnhibernate中有以下抽象类：

```
 public abstract class EntityMapping<TEntity> : ClassMap<TEntity> where TEntity : EntityBase
        {
            protected EntityMapping()
            {
                Id(x => x.Id, "Id")
                    .UnsavedValue("00000000-0000-0000-0000-000000000000")
                    .GeneratedBy.GuidComb()
                    .Index("IX_Lookup");
                OptimisticLock.Version();
                Version(x => x.Version);
Map(x=>x.DateLastChange); // your column
            }
        } 
```

所有其他映射都使用抽象类：

```
public SomeEntityMap:EntityMapping<SomeEntity>{
   public SomeEntityMap(){
      Map(x=>x.SomeProperty);
   }
} 
```

# java - HornetQ Embedded：我可以为动态地址设置分页选项吗？

> ID：10739717
> 
> 赞同：3
> 
> 时间：2012-05-24T14:39:28.523
> 
> 标签：java, hornetq

我在嵌入式配置中使用 HornetQ，配置对象本身以编程方式创建。该应用程序支持动态地址创建。

我希望能够在创建新地址时设置某些选项：页面文件使用、最大页面文件大小、分页的内存阈值。根据[HornetQ 文档](http://docs.jboss.org/hornetq/2.2.2.Final/user-manual/en/html/paging.html)，这需要按地址完成。

我尝试使用新地址的设置更新我的配置对象，但服务器（已经启动）不使用这些新设置。

有没有办法在服务器启动后告诉服务器每个地址的设置？

或者，我可以告诉服务器在我启动之前自动分页*所有*地址吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T14:55:26.783

发布后不久找到答案：您可以使用嵌入式服务器的分页管理器：

```
final AddressSettings addressSetting = new AddressSettings();
addressSetting.setMaxSizeBytes(10 * 1024 * 1024); // 10 MB
addressSetting.setPageSizeBytes(1024 * 1024);     // 1 MB

server.getPagingManager().getPageStore(new SimpleString(addressName))
                         .applySetting(addressSetting); 
```

或者，可以在配置对象上设置*所有*地址的设置（基于[此 SO answer](https://stackoverflow.com/questions/1941449)）：

```
final Configuration hornetConfig = new ConfigurationImpl();
// other configuration...

final AddressSettings addressSetting = new AddressSettings();
addressSetting.setMaxSizeBytes(10 * 1024 * 1024); // 10 MB
addressSetting.setPageSizeBytes(1024 * 1024);     // 1 MB

final Map<String, AddressSettings> addressing = new HashMap<String, AddressSettings>();
addressing.put("#", addressSetting); // the # pattern matches all addresses
hornetConfig.setAddressesSettings(addressing); 
```

# c# - 在 Windows Azure 中部署 Unity3D

> ID：10739720
> 
> 赞同：6
> 
> 时间：2012-05-24T14:39:31.340
> 
> 标签：c#, asp.net, windows, azure, unity3d

我有点坚持使用 Windows Azure 平台。目前，我有一个在 Azure 上运行的 ASP.NET MVC 3 Web 角色。但我想部署一个 Unity3D 网络播放器应用程序。我该如何执行此任务。如果我想在网页上部署一个flash应用程序，我认为这完全一样。我有一个 .unity3d 文件，而不是 .swf 文件。有人做了什么吗？

非常感谢 ！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-24T15:21:56.780

是的。你只需要做两件事：

1.  在您的 Azure VM 中安装 Unity Web Player 组件：为此，您只需要一个启动任务即可在没有 UI 的情况下静默下载和安装 UnityWebPlayer.exe。要了解有关启动任务的更多信息，请参见[此处](http://blogs.msdn.com/b/avkashchauhan/archive/2011/03/17/using-startup-task-in-windows-azure-detailed-summary.aspx)

2.  在 IIS 中设置 Unity3d Mime 类型：

    2.1 [http://blogs.iis.net/bills/archive/2008/03/25/how-to-add-mime-types-with-iis7-web-config.aspx](http://blogs.iis.net/bills/archive/2008/03/25/how-to-add-mime-types-with-iis7-web-config.aspx)

    2.2 [http://answers.unity3d.com/questions/28968/mime-settings-for-unity3d-file-type.html](http://answers.unity3d.com/questions/28968/mime-settings-for-unity3d-file-type.html)

这应该足够了。

# jquery - Wordpress AJAX 解析网址

> ID：10739721
> 
> 赞同：1
> 
> 时间：2012-05-24T14:39:32.937
> 
> 标签：jquery, ajax, wordpress

为了构建查询，有没有办法在 Wordpress 中解析 URL。例如，如果我想在侧边栏中有一个`wp_get_archives()`通过 AJAX 处理的档案列表（使用 显示），我如何让 Wordpress 构建 URL 并返回 JSON 数据。显然我可以自己解析一个 url 并找出默认查询，但如果我可以使用与 Wordpress 相同的方法，那就太好了。我查看了 $wp_query 对象，但不确定如何重用代码。

```
//jQuery:
$('#archives a').on('click', function(evt) {

     $.ajax({
        ....
        data: { url: '...' }
        success: function(result) {
            //parse JSON and append to HTML
        }
        ....
     });

});

//PHP:
function process_ajax() {

    //parse url
    //figure query
    //return JSON

} 
```

感谢您的任何意见。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T16:07:50.930

我扩展了 WP 类并覆盖了 parse_request() 方法以允许解析预定义的 URL。函数中的大部分逻辑都是完全相同的，这有点多余，但除非有人知道另一种方法，否则这是我想出的最好的方法。效果很好。

```
class AJAX_WP extends WP {

    /*
     *  Overwrite the parse_request function to allow for
     *  processing of urls defined in variables
    */

    function parse_request( $url ) {
        global $wp_rewrite;

        //validate url
        if(empty($url))
            return false;

        //sanitize
        $url = filter_var($url, FILTER_SANITIZE_URL);

        $this->query_vars = array();
        $post_type_query_vars = array();

        if ( is_array($extra_query_vars) )
            $this->extra_query_vars = & $extra_query_vars;
        else if (! empty($extra_query_vars))
            parse_str($extra_query_vars, $this->extra_query_vars);

        // Process PATH_INFO, REQUEST_URI, and 404 for permalinks.

        // Fetch the rewrite rules.
        $rewrite = $wp_rewrite->wp_rewrite_rules();

        if ( ! empty($rewrite) ) {
            // If we match a rewrite rule, this will be cleared.
            $error = '404';
            $this->did_permalink = true;

            //parse url
            $_url = parse_url($url);

            //set path info
            $pathinfo = $_url['path'];
            $pathinfo_array = explode('?', $pathinfo);
            $pathinfo = str_replace("%", "%25", $pathinfo_array[0]);

            //req_uri
            $req_uri = $_url['path'];
            $req_uri_array = explode('?', $req_uri);
            $req_uri = $req_uri_array[0];

            //self
            $self = $_url['path'];
            $home_path = parse_url(home_url());
            if ( isset($home_path['path']) )
                $home_path = $home_path['path'];
            else
                $home_path = '';
            $home_path = trim($home_path, '/');

            // Trim path info from the end and the leading home path from the
            // front.  For path info requests, this leaves us with the requesting
            // filename, if any.  For 404 requests, this leaves us with the
            // requested permalink.
            $req_uri = str_replace($pathinfo, '', $req_uri);
            $req_uri = trim($req_uri, '/');
            $req_uri = preg_replace("|^$home_path|", '', $req_uri);
            $req_uri = trim($req_uri, '/');
            $pathinfo = trim($pathinfo, '/');
            $pathinfo = preg_replace("|^$home_path|", '', $pathinfo);
            $pathinfo = trim($pathinfo, '/');
            $self = trim($self, '/');
            $self = preg_replace("|^$home_path|", '', $self);
            $self = trim($self, '/');

            // The requested permalink is in $pathinfo for path info requests and
            //  $req_uri for other requests.
            if ( ! empty($pathinfo) && !preg_match('|^.*' . $wp_rewrite->index . '$|', $pathinfo) ) {
                $request = $pathinfo;
            } else {
                // If the request uri is the index, blank it out so that we don't try to match it against a rule.
                if ( $req_uri == $wp_rewrite->index )
                    $req_uri = '';
                $request = $req_uri;
            }

            $this->request = $request;

            // Look for matches.
            $request_match = $request;
            if ( empty( $request_match ) ) {
                // An empty request could only match against ^$ regex
                if ( isset( $rewrite['$'] ) ) {
                    $this->matched_rule = '$';
                    $query = $rewrite['$'];
                    $matches = array('');
                }
            } else if ( $req_uri != 'wp-app.php' ) {
                foreach ( (array) $rewrite as $match => $query ) {
                    // If the requesting file is the anchor of the match, prepend it to the path info.
                    if ( ! empty($req_uri) && strpos($match, $req_uri) === 0 && $req_uri != $request )
                        $request_match = $req_uri . '/' . $request;

                    if ( preg_match("#^$match#", $request_match, $matches) ||
                        preg_match("#^$match#", urldecode($request_match), $matches) ) {

                        if ( $wp_rewrite->use_verbose_page_rules && preg_match( '/pagename=\$matches\[([0-9]+)\]/', $query, $varmatch ) ) {
                            // this is a verbose page match, lets check to be sure about it
                            if ( ! get_page_by_path( $matches[ $varmatch[1] ] ) )
                                continue;
                        }

                        // Got a match.
                        $this->matched_rule = $match;
                        break;
                    }
                }
            }

            if ( isset( $this->matched_rule ) ) {
                // Trim the query of everything up to the '?'.
                $query = preg_replace("!^.+\?!", '', $query);

                // Substitute the substring matches into the query.
                $query = addslashes(WP_MatchesMapRegex::apply($query, $matches));

                $this->matched_query = $query;

                // Parse the query.
                parse_str($query, $perma_query_vars);

                // If we're processing a 404 request, clear the error var
                // since we found something.
                unset( $_GET['error'] );
                unset( $error );
            }

            // If req_uri is empty or if it is a request for ourself, unset error.
            if ( empty($request) || $req_uri == $self || strpos($_url['path'], 'wp-admin/') !== false ) {
                unset( $_GET['error'] );
                unset( $error );

                if ( isset($perma_query_vars) && strpos($_url['path'], 'wp-admin/') !== false )
                    unset( $perma_query_vars );

                $this->did_permalink = false;
            }
        }

        $this->public_query_vars = apply_filters('query_vars', $this->public_query_vars);

        foreach ( $GLOBALS['wp_post_types'] as $post_type => $t )
            if ( $t->query_var )
                $post_type_query_vars[$t->query_var] = $post_type;

        foreach ( $this->public_query_vars as $wpvar ) {
            if ( isset( $this->extra_query_vars[$wpvar] ) )
                $this->query_vars[$wpvar] = $this->extra_query_vars[$wpvar];
            elseif ( isset( $_POST[$wpvar] ) )
                $this->query_vars[$wpvar] = $_POST[$wpvar];
            elseif ( isset( $_GET[$wpvar] ) )
                $this->query_vars[$wpvar] = $_GET[$wpvar];
            elseif ( isset( $perma_query_vars[$wpvar] ) )
                $this->query_vars[$wpvar] = $perma_query_vars[$wpvar];

            if ( !empty( $this->query_vars[$wpvar] ) ) {
                if ( ! is_array( $this->query_vars[$wpvar] ) ) {
                    $this->query_vars[$wpvar] = (string) $this->query_vars[$wpvar];
                } else {
                    foreach ( $this->query_vars[$wpvar] as $vkey => $v ) {
                        if ( !is_object( $v ) ) {
                            $this->query_vars[$wpvar][$vkey] = (string) $v;
                        }
                    }
                }

                if ( isset($post_type_query_vars[$wpvar] ) ) {
                    $this->query_vars['post_type'] = $post_type_query_vars[$wpvar];
                    $this->query_vars['name'] = $this->query_vars[$wpvar];
                }
            }
        }

        // Convert urldecoded spaces back into +
        foreach ( $GLOBALS['wp_taxonomies'] as $taxonomy => $t )
            if ( $t->query_var && isset( $this->query_vars[$t->query_var] ) )
                $this->query_vars[$t->query_var] = str_replace( ' ', '+', $this->query_vars[$t->query_var] );

        // Limit publicly queried post_types to those that are publicly_queryable
        if ( isset( $this->query_vars['post_type']) ) {
            $queryable_post_types = get_post_types( array('publicly_queryable' => true) );
            if ( ! is_array( $this->query_vars['post_type'] ) ) {
                if ( ! in_array( $this->query_vars['post_type'], $queryable_post_types ) )
                    unset( $this->query_vars['post_type'] );
            } else {
                $this->query_vars['post_type'] = array_intersect( $this->query_vars['post_type'], $queryable_post_types );
            }
        }

        foreach ( (array) $this->private_query_vars as $var) {
            if ( isset($this->extra_query_vars[$var]) )
                $this->query_vars[$var] = $this->extra_query_vars[$var];
        }

        if ( isset($error) )
            $this->query_vars['error'] = $error;

        $this->query_vars = apply_filters('request', $this->query_vars);

        do_action_ref_array('parse_request', array(&$this));

    }

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-06-02T23:22:21.063

这是我用来在 WordPress 4.2.2 上使用的最终代码，非常感谢 Chris：

```
/**
 * An extension of the global WP object class for URL parsing / query_var generating ability over AJAX
 *
 * Essentially, it lets you specify a url.
 *
 * Example of use:
 *
 *  global $wp;
 *  $wp = new AJAX_WP();
 *  $wp->main( $url );
 *
 * @since 2015-June-2
 */
class AJAX_WP extends WP {

    /**
     * Parse request to find correct WordPress query.
     *
     * Sets up the query variables based on the request. There are also many
     * filters and actions that can be used to further manipulate the result.
     *
     * @since 2.0.0
     *
     * @param array|string $extra_query_vars Set the extra query variables.
     */
    public function parse_request( $url ) {

        global $wp_rewrite;

        //validate url
        if(empty($url))
            return false;

        //sanitize
        $url = filter_var($url, FILTER_SANITIZE_URL);

        /**
         * Filter whether to parse the request.
         *
         * @since 3.5.0
         *
         * @param bool         $bool             Whether or not to parse the request. Default true.
         * @param WP           $this             Current WordPress environment instance.
         * @param array|string $extra_query_vars Extra passed query variables.
         */
        if ( ! apply_filters( 'do_parse_request', true, $this, $extra_query_vars ) )
            return;

        $this->query_vars = array();
        $post_type_query_vars = array();

        if ( is_array( $extra_query_vars ) ) {
            $this->extra_query_vars = & $extra_query_vars;
        } elseif ( ! empty( $extra_query_vars ) ) {
            parse_str( $extra_query_vars, $this->extra_query_vars );
        }
        // Process PATH_INFO, REQUEST_URI, and 404 for permalinks.

        // Fetch the rewrite rules.
        $rewrite = $wp_rewrite->wp_rewrite_rules();

        if ( ! empty($rewrite) ) {
            // If we match a rewrite rule, this will be cleared.
            $error = '404';
            $this->did_permalink = true;

            /*$pathinfo = isset( $_SERVER['PATH_INFO'] ) ? $_SERVER['PATH_INFO'] : '';
            list( $pathinfo ) = explode( '?', $pathinfo );
            $pathinfo = str_replace( "%", "%25", $pathinfo );

            list( $req_uri ) = explode( '?', $_SERVER['REQUEST_URI'] );
            $self = $_SERVER['PHP_SELF'];
            $home_path = trim( parse_url( home_url(), PHP_URL_PATH ), '/' );*/

            //parse url
            $_url = parse_url($url);

            //set path info
            $pathinfo = $_url['path'];
            $pathinfo_array = explode('?', $pathinfo);
            $pathinfo = str_replace("%", "%25", $pathinfo_array[0]);

            //req_uri
            $req_uri = $_url['path'];
            $req_uri_array = explode('?', $req_uri);
            $req_uri = $req_uri_array[0];

            //self
            $self = $_url['path'];
            $home_path = parse_url(home_url());
            if ( isset($home_path['path']) )
                $home_path = $home_path['path'];
            else
                $home_path = '';
            $home_path = trim($home_path, '/');

            // Trim path info from the end and the leading home path from the
            // front. For path info requests, this leaves us with the requesting
            // filename, if any. For 404 requests, this leaves us with the
            // requested permalink.
            $req_uri = str_replace($pathinfo, '', $req_uri);
            $req_uri = trim($req_uri, '/');
            $req_uri = preg_replace("|^$home_path|i", '', $req_uri);
            $req_uri = trim($req_uri, '/');
            $pathinfo = trim($pathinfo, '/');
            $pathinfo = preg_replace("|^$home_path|i", '', $pathinfo);
            $pathinfo = trim($pathinfo, '/');
            $self = trim($self, '/');
            $self = preg_replace("|^$home_path|i", '', $self);
            $self = trim($self, '/');

            // The requested permalink is in $pathinfo for path info requests and
            //  $req_uri for other requests.
            if ( ! empty($pathinfo) && !preg_match('|^.*' . $wp_rewrite->index . '$|', $pathinfo) ) {
                $request = $pathinfo;
            } else {
                // If the request uri is the index, blank it out so that we don't try to match it against a rule.
                if ( $req_uri == $wp_rewrite->index )
                    $req_uri = '';
                $request = $req_uri;
            }

            $this->request = $request;

            // Look for matches.
            $request_match = $request;
            if ( empty( $request_match ) ) {
                // An empty request could only match against ^$ regex
                if ( isset( $rewrite['$'] ) ) {
                    $this->matched_rule = '$';
                    $query = $rewrite['$'];
                    $matches = array('');
                }
            } else {
                foreach ( (array) $rewrite as $match => $query ) {
                    // If the requesting file is the anchor of the match, prepend it to the path info.
                    if ( ! empty($req_uri) && strpos($match, $req_uri) === 0 && $req_uri != $request )
                        $request_match = $req_uri . '/' . $request;

                    if ( preg_match("#^$match#", $request_match, $matches) ||
                        preg_match("#^$match#", urldecode($request_match), $matches) ) {

                        if ( $wp_rewrite->use_verbose_page_rules && preg_match( '/pagename=\$matches\[([0-9]+)\]/', $query, $varmatch ) ) {
                            // This is a verbose page match, let's check to be sure about it.
                            if ( ! get_page_by_path( $matches[ $varmatch[1] ] ) )
                                continue;
                        }

                        // Got a match.
                        $this->matched_rule = $match;
                        break;
                    }
                }
            }

            if ( isset( $this->matched_rule ) ) {
                // Trim the query of everything up to the '?'.
                $query = preg_replace("!^.+\?!", '', $query);

                // Substitute the substring matches into the query.
                $query = addslashes(WP_MatchesMapRegex::apply($query, $matches));

                $this->matched_query = $query;

                // Parse the query.
                parse_str($query, $perma_query_vars);

                // If we're processing a 404 request, clear the error var since we found something.
                if ( '404' == $error )
                    unset( $error, $_GET['error'] );
            }

            // If req_uri is empty or if it is a request for ourself, unset error.
            if ( empty($request) || $req_uri == $self ) {
                unset( $error, $_GET['error'] );

                /*
                Not doing this — it's AJAX and will always be true

                if ( isset($perma_query_vars) && strpos($_SERVER['PHP_SELF'], 'wp-admin/') !== false ) {
                    unset( $perma_query_vars );
                }*/

                $this->did_permalink = false;
            }
        }

        /**
         * Filter the query variables whitelist before processing.
         *
         * Allows (publicly allowed) query vars to be added, removed, or changed prior
         * to executing the query. Needed to allow custom rewrite rules using your own arguments
         * to work, or any other custom query variables you want to be publicly available.
         *
         * @since 1.5.0
         *
         * @param array $public_query_vars The array of whitelisted query variables.
         */
        $this->public_query_vars = apply_filters( 'query_vars', $this->public_query_vars );

        foreach ( get_post_types( array(), 'objects' ) as $post_type => $t )
            if ( $t->query_var )
                $post_type_query_vars[$t->query_var] = $post_type;

        foreach ( $this->public_query_vars as $wpvar ) {
            if ( isset( $this->extra_query_vars[$wpvar] ) )
                $this->query_vars[$wpvar] = $this->extra_query_vars[$wpvar];
            elseif ( isset( $_POST[$wpvar] ) )
                $this->query_vars[$wpvar] = $_POST[$wpvar];
            elseif ( isset( $_GET[$wpvar] ) )
                $this->query_vars[$wpvar] = $_GET[$wpvar];
            elseif ( isset( $perma_query_vars[$wpvar] ) ) {
                $this->query_vars[$wpvar] = $perma_query_vars[$wpvar];
                }

            if ( !empty( $this->query_vars[$wpvar] ) ) {
                if ( ! is_array( $this->query_vars[$wpvar] ) ) {
                    $this->query_vars[$wpvar] = (string) $this->query_vars[$wpvar];
                } else {
                    foreach ( $this->query_vars[$wpvar] as $vkey => $v ) {
                        if ( !is_object( $v ) ) {
                            $this->query_vars[$wpvar][$vkey] = (string) $v;
                        }
                    }
                }

                if ( isset($post_type_query_vars[$wpvar] ) ) {
                    $this->query_vars['post_type'] = $post_type_query_vars[$wpvar];
                    $this->query_vars['name'] = $this->query_vars[$wpvar];
                }
            }
        }

        // Convert urldecoded spaces back into +
        foreach ( get_taxonomies( array() , 'objects' ) as $taxonomy => $t )
            if ( $t->query_var && isset( $this->query_vars[$t->query_var] ) )
                $this->query_vars[$t->query_var] = str_replace( ' ', '+', $this->query_vars[$t->query_var] );

        // Limit publicly queried post_types to those that are publicly_queryable
        if ( isset( $this->query_vars['post_type']) ) {
            $queryable_post_types = get_post_types( array('publicly_queryable' => true) );
            if ( ! is_array( $this->query_vars['post_type'] ) ) {
                if ( ! in_array( $this->query_vars['post_type'], $queryable_post_types ) )
                    unset( $this->query_vars['post_type'] );
            } else {
                $this->query_vars['post_type'] = array_intersect( $this->query_vars['post_type'], $queryable_post_types );
            }
        }

        foreach ( (array) $this->private_query_vars as $var) {
            if ( isset($this->extra_query_vars[$var]) )
                $this->query_vars[$var] = $this->extra_query_vars[$var];
        }

        if ( isset($error) )
            $this->query_vars['error'] = $error;

        /**
         * Filter the array of parsed query variables.
         *
         * @since 2.1.0
         *
         * @param array $query_vars The array of requested query variables.
         */
        $this->query_vars = apply_filters( 'request', $this->query_vars );

        /**
         * Fires once all query variables for the current request have been parsed.
         *
         * @since 2.1.0
         *
         * @param WP &$this Current WordPress environment instance (passed by reference).
         */
        do_action_ref_array( 'parse_request', array( &$this ) );

    }

    /**
     * Sets up all of the variables required by the WordPress environment.
     *
     * The action 'wp' has one parameter that references the WP object. It
     * allows for accessing the properties and methods to further manipulate the
     * object.
     *
     * @since 2.0.0
     *
     * @param string|array $query_args Passed to {@link parse_request()}
     */
    public function main( $url ) {

        $this->init();
        $this->parse_request( $url );
        $this->send_headers();
        $this->query_posts();
        $this->handle_404();
        $this->register_globals();

        /**
         * Fires once the WordPress environment has been set up.
         *
         * @since 2.1.0
         *
         * @param WP &$this Current WordPress environment instance (passed by reference).
         */
        do_action_ref_array( 'wp', array( &$this ) );
    }

} 
```

此外，我必须添加此过滤器以使其全部正常工作：

```
/**
 * Make sure that all the post types are available as query variables
 *
 * This fixes a problem with AJAX_WP not returning custom post types.
 *
 * @since 2015-June-2
 * @param array $public_vars
 * @return array
 */
function ananda_ajax_public_query_post_types( $public_vars ) {

        return array_merge( get_post_types( array('publicly_queryable' => true) ), $public_vars );
} 
```

这是添加的实际过滤器：

```
add_filter( 'query_vars', 'ananda_ajax_public_query_post_types', 10, 1 ); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-08-09T10:51:23.413

我知道这是旧的，但你们真的帮助了我，所以我想我会向前支付。这是一个更简单的版本（我也希望它更安全一些）：

```
class PermalinkParser extends WP{

        function parse_permalink($url) {
            $path                 = parse_url($url, PHP_URL_PATH);
            $previous             = $_SERVER;
            $_SERVER['PATH_INFO'] = $_SERVER['REQUEST_URI'] = $path;
            $_SERVER['PHP_SELF']  = str_replace($_SERVER['DOCUMENT_ROOT'],'',  ABSPATH . 'index.php');

            $this->parse_request();
            $_SERVER = $previous;
            return $this->query_vars;
        }

        function main( $query_args = '' ) {
            // do not run this
        }
    } 
```

# iphone - iPhone 用户联系信息

> ID：10739724
> 
> 赞同：2
> 
> 时间：2012-05-24T14:39:45.320
> 
> 标签：iphone, ios

如果您在设置/邮件、联系人、日历下查看，则有一个用于指定您的个人信息的设置（“我的信息”设置）。它基本上允许您从联系人列表中选择一个条目以用作您的个人资料。

有谁知道如何以编程方式访问这些信息？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T15:02:55.220

不，很遗憾，您不能直接访问“我的信息”联系信息。您可以允许用户从通讯录中选择他的联系信息，您可以稍后通过保存记录 ID 自动查找。

以下是 Apple 提供的有关地址簿的信息： [https ://developer.apple.com/library/ios/#documentation/ContactData/Conceptual/AddressBookProgrammingGuideforiPhone/Introduction.html](https://developer.apple.com/library/ios/#documentation/ContactData/Conceptual/AddressBookProgrammingGuideforiPhone/Introduction.html)

# objective-c - 何时在 iOS 中使用惰性实例化？

> ID：10739726
> 
> 赞同：26
> 
> 时间：2012-05-24T14:40:02.027
> 
> 标签：objective-c, ios

我听说 iOS 中对象的惰性实例化很常见，但是我不确定什么时候应该使用它？有人可以简要解释一下我什么时候应该使用惰性实例化，什么时候应该在 init 方法中初始化我的属性？

我对延迟实例化的担忧是它需要大量代码（与仅在 init 方法中编写所有代码相比），特别是如果您有多个要初始化的属性。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-05-24T15:22:30.557

To elaborate on my comment. Sometimes this technique is good if you have an object that only needs to be configured once and has some configuration involved that you don't want to clutter your init method.

```
- (UIView *)myRoundedView;
{
    if (!_myRoundedView) {
        _myRoundedView = [[UIView alloc] initWithFrame:<#some frame#>];
        _myRoundedView.layer.cornerRadius = 10.f;
        _myRoundedView.backgroundColor    = [UIColor colorWithWhite:0.f alpha:0.6f];
        _myRoundedView.autoresizingMask   = UIViewAutoresizingFlexibleWidth | UIViewAutoresizingFlexibleHeight;
    }
    return _myRoundedView;
} 
```

It's a pretty contrived example but you can start to see the merit. Methods should be like classes and do one thing well. This method happens to return the roundedView I want. If I slapped this code into the init method then the init method would now have to know the nitty gritty details of how to instantiate and configure this view and any other objects that I slap in there.

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-05-24T14:48:27.677

这在您拥有可能占用大量内存的对象的情况下非常有用，因此您可以避免在容器类初始化时初始化所有这些昂贵的对象。延迟初始化可以在几种情况下保留内存消耗......

但是很明显，如果所有对象都需要在容器对象初始化之后或之后立即进行初始化，则延迟初始化没有任何意义，应该使用标准的构造函数初始化。

*应该使用延迟初始化，以防在所有类工作流程中永远无法初始化的类中有可选对象。*

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2012-05-24T14:47:36.673

与任何技术一样，没有一个单一的、千篇一律的规则来告诉您何时懒惰地实例化某些东西。我认为好的建议是对实例化昂贵的东西使用惰性实例化。如果某事需要进行大量的磁盘或网络访问，或者需要大量的 CPU 时间来设置，则最好将这项工作推迟到实际需要（或在后台进行）。特别是对于用户可能会或可能不会使用的功能，在（或类似的）设置上浪费大量时间是没有意义的`-init`，这样做会导致您的应用程序对用户感到迟钝。

话虽如此，您应该避免过早的优化。不要花很多时间编写复杂的代码来帮助提高性能，直到您以明显的方式完成事情，发现性能问题，并分析您的代码以彻底理解问题。完成后，您可以开始进行更改以改进事情。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-10-24T14:39:10.003

不仅是为了内存和性能，看看这个，这是另一个例子：

```
- (NSArray *)validElements{
    if (!_validElements) {
        _validElements = [[NSArray alloc] initWithObjects:
                          @"mystuff",@"generaldescription",@"title",@"autor",
                          @"version",@"date",@"context",@"operatingsystem",@"kindofdevice",
                          @"deviceversion",@"rule",@"daytime",@"time",@"location",@"deviceheading",
                          @"region",@"language",nil];
    }
    return _validElements;
} 
```

您可以使用惰性实例化来进行自定义初始化或特殊配置，是的，这也有利于内存和性能。

# ios - 检索从应用程序拍摄的图片

> ID：10739731
> 
> 赞同：1
> 
> 时间：2012-05-24T14:40:12.557
> 
> 标签：ios, uiimagepickercontroller, alassetslibrary

是否可以在相机胶卷中保存图片（使用 UIImagePickerController 拍摄），或者使用

```
writeImageToSavedPhotosAlbum:metadata:completionBlock 
```

或者

```
UIImageWriteToSavedPhotosAlbum(..) 
```

这让我知道，如果照片是由应用程序拍摄的，那么使用 ALAssetsLibrary 迭代相机胶卷？有没有办法在不让我保存 url 列表的情况下为图片存储“在应用程序中拍摄”的标志？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T14:47:09.783

您始终可以将此信息添加到元数据中，可能作为`userComment`或`make:model:software:`

这里有一个关于这个主题的很好的教程：[以简单的方式将元数据添加到 iOS 图像](http://blog.codecropper.com/2011/05/adding-metadata-to-ios-images-the-easy-way/)

对于读取元数据：[Getting metadata from images on iOS](http://blog.codecropper.com/2011/05/getting-metadata-from-images-on-ios)

# javascript - 从所有标签中删除 onmouseover 事件

> ID：10739734
> 
> 赞同：5
> 
> 时间：2012-05-24T14:40:27.207
> 
> 标签：javascript, jquery, html, asp.net-mvc-3

我这样做：

```
$.each($('img'), function () {
    this.unbind('onmouseover');
}); 
```

这不起作用。为什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-24T14:41:59.030

尝试如下，

```
$('img').unbind('mouseover'); 
```

不需要循环..也不`mouseover`应该`onmouseover`

**假设：**您正在使用`.bind`绑定`mouseover`处理程序

> 我没有使用绑定。有些图像有 onmouseover 属性，我想删除它们。我尝试了 $('img').removeAttr('onmouseover') 但它仍然不起作用

1.  使用内联事件处理程序不是标准。
2.  由于您使用的是 jQuery，因此您应该像下面这样绑定处理程序。

**代码：**

```
$('img').on('mouseover', function () {
     //Your code
}); 
```

稍后可以使用`.off`->取消绑定它们

```
$('img').off('mouseover'); 
```

解决您所拥有的（不是首选），（[参考](https://stackoverflow.com/questions/3846263/can-i-remove-inline-event-handlers-using-jquery)）

```
$.each($('img'), function () {
    $(this).removeAttr('onmouseover');
}); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-24T14:42:35.270

*   当[`$.each()`](http://api.jquery.com/jQuery.each/)jQuery 元素集合已经有一个内部的[`each()`](http://api.jquery.com/each/).

*   此外，您可以“菊花链”删除 jQuery 中的处理程序方法，因为每个函数都返回相同的集合。每个附加方法都有自己的删除方法对，因此请相应地使用。

    *   [`on()`](http://api.jquery.com/on/)=>[`off()`](http://api.jquery.com/off/)
    *   [`bind()`](http://api.jquery.com/bind/)=>[`unbind()`](http://api.jquery.com/unbind/)
    *   [`live()`](http://api.jquery.com/live/)=>[`die()`](http://api.jquery.com/die/)
*   最后，要移除 DOM 元素上的处理程序（内联事件处理程序），请将其替换为 null 或执行以下操作的函数`return false`；

这是概念代码：

```
$('img')
    .unbind('mouseover')               //remove events attached with bind
    .off('mouseover')                  //remove events attached with on
    .die('mouseover');                 //remove events attached with live
    .each(function(i,el){              //and for each element
        el.onmouseover = null          //replace the onmouseover event
    }); 
```

# wpf - WPF 按钮可见性问题

> ID：10739735
> 
> 赞同：1
> 
> 时间：2012-05-24T14:40:27.167
> 
> 标签：wpf, button, visibility

我对可见性有这个绑定

```
Visibility="{TemplateBinding ComputedVerticalScrollBarVisibility}" 
```

我想设置`Visibility = False`if`ComputedVerticalScrollBarVisibility = True`和`Visibility = True`if`ComputedVerticalScrollBarVisibility = false`

有没有这样的东西：

```
Visibility="!{TemplateBinding ComputedVerticalScrollBarVisibility}" 
```

谢谢赛

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T15:20:07.920

To Hasan's point, the converter here is pretty simple:

```
public class VisibilityInverterConverter : IValueConverter
{
    public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
    {
        if (value != null && value is Visibility)
        {
            var vis = (Visibility) value;

            if (vis == Visibility.Hidden || vis == Visibility.Collapsed)
            {
                return Visibility.Visible;
            }

            return Visibility.Collapsed;
        }

        return Visibility.Visible;
    }

    public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture)
    {
        throw new NotImplementedException();
    }
} 
```

# asp.net - 如何为他们的项目建立模型？

> ID：10739747
> 
> 赞同：0
> 
> 时间：2012-05-24T14:41:12.087
> 
> 标签：asp.net, architecture

我被要求为我的应用程序建模。我不清楚这意味着什么，也许与我的项目架构有关？这是否意味着让他们分班？或者诸如构建用例或类图之类的东西？或者也许是别的什么？

编辑：我不能问他们！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T15:00:06.573

我会选择 UML（统一建模语言）。它允许您以图形格式布置类、方法、继承等。

一个快速的谷歌搜索给出了这个 FOSS 选项：

[Umbrello UML 建模器](http://uml.sourceforge.net/)

编辑：刚刚意识到这是 linux-only，所以这里是[Wikipedia 页面](http://en.wikipedia.org/wiki/List_of_Unified_Modeling_Language_tools)，提供了一大堆其他选项。

# symfony1 - 如何在 Symfony Doctrine 中创建带有子查询的查询

> ID：10739748
> 
> 赞同：0
> 
> 时间：2012-05-24T14:41:15.450
> 
> 标签：symfony1, doctrine, symfony-1.4, subquery, union

我想在学说中进行这个 sql 查询：

```
SELECT * 
FROM (
  (SELECT *, e1.stop_date as sort_date FROM `event` e1 WHERE ...) 
  UNION 
  (SELECT *, e2.start_date as sort_date FROM `event` e2 WHERE ...)
) e3 
ORDER BY e3.sort_date 
```

我想将 symfony 模型的结果连接到事件表，比如使用：

```
Doctrine_Core::getTable('Event')->createQuery('e') 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-11T15:04:12.623

您可以尝试 Doctrine 的 DQL languaje 进行复杂查询：

```
$q = Doctrine_Query::create()
        ->select('u.id')
        ->from('User u')
        ->where('u.id NOT IN (SELECT u2.id FROM User u2 INNER JOIN u2.Groups g)');

echo $q->getSqlQuery(); 
```

[http://doctrine.readthedocs.org/en/latest/en/manual/dql-doctrine-query-language.html#subqueries](http://doctrine.readthedocs.org/en/latest/en/manual/dql-doctrine-query-language.html#subqueries)

或者，或者，您可以在数据库中创建一个视图并将其用作更简单的 Doctrine 查询的源表。

```
CREATE VIEW view_name AS
SELECT * 
FROM (
  (SELECT *, e1.stop_date as sort_date FROM `event` e1 WHERE ...) 
  UNION 
  (SELECT *, e2.start_date as sort_date FROM `event` e2 WHERE ...)
) e3 
ORDER BY e3.sort_date 
```

我在我的项目中使用了这两种方法并且效果很好，这取决于您访问数据的方式，是否需要更新，是否允许您创建视图等。

# ruby-on-rails - 如何自定义 Capistranos SSH 命令？

> ID：10739749
> 
> 赞同：3
> 
> 时间：2012-05-24T14:41:20.020
> 
> 标签：ruby-on-rails, deployment, capistrano, freebsd, jail

为了部署到 FreeBSD 监狱，我需要我的命令如下所示：

```
ssh user@example.org "jexec 'web_jail' $THE_COMMAND_HERE"
ssh user@example.org "jexec 'db_jail' $ANOTHER_COMMAND_HERE"
... 
```

*请注意，虽然技术上可行，但我想避免直接在监狱中激活 SSH！*

那么我怎样才能让 Capistrano 像这样运行呢？

（请注意，我主要是在参考修改默认上限任务时询问。）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T18:07:39.387

有电锯吗？

需要澄清的一部分是由谁来确定它是 web_jail 还是 db_jail？那是附加了 _jail 的角色吗？

我要入侵的地方是 Capistrano::Command.replace_placeholders。您可以使用 alias_method_chain 来挂钩。原始文件位于 lib/capistrano/command.rb 中。

你也许可以用“shell”变量做一些花哨的步法，但这似乎很难做到。

既然你有两个人在看，这可能是向 Capistrano 人提交的一个很好的补充。

# objective-c - createDirectoryAtPath 不起作用 - 目标 C

> ID：10739755
> 
> 赞同：0
> 
> 时间：2012-05-24T14:41:43.193
> 
> 标签：objective-c, ipad, xcode4

我正在尝试创建一个新目录，它应该比这更容易。我查看了许多教程，实际上是在复制和粘贴代码，但我每次都收到错误“使用未声明的标识符 createDirectoryAtPath”。这是我的代码：

```
NSFileManager *filemgr;
NSArray *dirPaths;
NSString *docsDir;
NSString *newDir;

filemgr =[NSFileManager defaultManager];

dirPaths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, 
    NSUserDomainMask, YES);

docsDir = [dirPaths objectAtIndex:0];
newDir = [docsDir stringByAppendingPathComponent:@"pdf"];

if ([createDirectoryAtPath:newDir withIntermediateDirectories:YES attributes:nil error: NULL] == NO)
{
        // Failed to create directory
}
[filemgr release]; 
```

任何帮助，将不胜感激。

编辑：我应该提到我在 .m 文件中有这个代码，在 -(void)viewDidLoad

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T14:44:38.507

您必须在文件管理器上调用 createDirectoryAtPath:

```
if ([filemgr createDirectoryAtPath:newDir withIntermediateDirectories:YES attributes:nil error: NULL] == NO) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T14:47:12.630

您忘记包含要向其发送消息的对象。正如 joern 所说，您需要将 createDirectoryAtPath:withIntermediateDirectories:attributes 消息发送到 NSFileManager 实例 filemgr。

# python - 如果是 JPG 图像，QLabel() 将不会加载像素图

> ID：10739758
> 
> 赞同：6
> 
> 时间：2012-05-24T14:41:57.820
> 
> 标签：python, qt, pyqt, pyside

我试图从一个文件中`QLabel()`显示一个`pixmap`JPG 图像（它不能在资源文件中，因为它是从网上下载的），但是我在加载它时遇到了问题。代码相当简单：

```
label = QLabel()
label.setPixmap(QPixmap("image.jpg")) 
```

它适用于`PNG`文件，但不适用于`JPG`文件。我用谷歌搜索了很多，发现我需要将`"imageformats"`文件夹放在我的脚本所在的同一个文件夹中。然而，即使在这样做之后（是的，`qjpeg4.dll`还有其他人在那里），它仍然不起作用。我也试过做

```
path = r"C:\Users\Deusdies\Documents\Work\myapp\imageformats"
app.addLibraryPath(path) 
```

但这也无济于事。

同样，它加载`PNGs`得很好，但它不会加载`JPGs`。我之前也注意到它也不会加载`ICO`，但我认为这是一个不相关的问题 - 但现在看起来不是这样。

值得注意的是，此时应用程序并未转换为`.exe`—— 它是通过`python.exe`解释器通过`PowerShell`.

我的开发环境是 Windows 7 x64，PySide 1.1.0

我怎么解决这个问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-24T20:03:42.127

我解决了这个问题。首先，路径应如下所示：

```
path = r"C:\Users\Deusdies\Documents\Work\myapp" 
```

（所以没有“图像格式”部分）

其次，我是个白痴。我在做之前创建了一个 QDialog() 类的实例`addLibraryPath()`

# wpf - WPF 样式 DataGridHyperlinkColumn

> ID：10739766
> 
> 赞同：2
> 
> 时间：2012-05-24T14:42:33.710
> 
> 标签：wpf, wpfdatagrid, wpf-4.0

我为超链接控件创建了一个样式：

```
<Style x:Key="MyHyperlink" TargetType="{x:Type Hyperlink}">
    <Setter Property="Foreground" Value="{StaticResource HyperlinkBrush}" />
    <Setter Property="IsEnabled" Value="{Binding IsEnabled,RelativeSource={RelativeSource AncestorType={x:Type FrameworkElement}}}" />
    <Style.Triggers>
        <Trigger Property="IsEnabled" Value="True">
            <Setter Property="Cursor" Value="Hand"/>
        </Trigger>
        <Trigger Property="IsEnabled" Value="False">
            <Setter Property="Foreground" Value="{StaticResource DisabledForegroundBrush}"/>
        </Trigger>
        <Trigger Property="IsMouseOver" Value="True" >
            <Setter Property="Foreground" Value="{StaticResource HyperlinkMouseOverBrush}"  />
        </Trigger>
    </Style.Triggers>
</Style> 
```

如何在 DataGridHyperlinkColumn 中使用这种样式？

这种列的 ElementStyle 要求 TextBlock 样式而不是 Hyperlink 样式...

```
<DataGridHyperlinkColumn EditingElementStyle="{StaticResource MyDataGridTextColumn}" ElementStyle="{StaticResource MyDataGridHyperlinkColumn}"
                            Header="WebSite" Binding="{Binding Site, NotifyOnValidationError=True,ValidatesOnDataErrors=True}" /> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T15:18:46.023

从您的样式中删除`x:Key`并将其放入，`DataGrid.Resources`然后它以 this 中的所有`Hyperlink`控件为目标`DataGrid`。

# maven - Selenium Maven 插件 - Selenese 目标缺少 firefox 配置文件参数

> ID：10739768
> 
> 赞同：1
> 
> 时间：2012-05-24T14:42:42.717
> 
> 标签：maven, selenium

是的，我已经使用 Selenium Maven 插件碰壁了——使用的 selenese 目标非常好——但是当在 firefox 中执行测试时，插件会启动一个新的 firefox 配置文件，该配置文件没有配置公司代理。

现在，如果我只是简单地使用 selenium 服务器 jar 直接执行我的 html 套件，我可以指定一个 firefox 配置文件 - 但是它似乎没有作为参数包含在这个插件的 selenese 目标中。疯狂！

start-server 目标有这样的参数，那么为什么没有 selenese？

有没有其他人遇到过这个问题？任何解决方法？

感谢所有明智的输入。

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T15:47:27.660

我想如果其他人遇到这个问题，我会发布我的解决方案......

只需要获取 selenium maven 插件源，并对其进行修补。这些常量在 selenium 服务器 RemoteControlConfiguration 类中可用，但是这个插件并没有在 SeleneseMojo 中使用它们。所以这是一个非常简单的修复：

设置我们想要在 seleneseMojo 启动 selenium 服务器时更改的属性。所以在这种情况下我想利用`firefoxProfileTemplate`所以我这样做了：

```
 def conf = new RemoteControlConfiguration()
 conf.port = port
 conf.singleWindow = !multiWindow
 conf.firefoxProfileTemplate = firefoxProfileTemplate

 def server = new SeleniumServer(slowResources, conf)
 server.start() 
```

现在我可以在我的 maven 项目执行配置中指定一个 firefoxProfileTemplate 值，因此在通过 maven 运行 selenium html 套件时指定一个 firefox 配置文件。

# objective-c - 自定义属性的getter和setter与objective-c中的c ++ struct数组

> ID：10739769
> 
> 赞同：1
> 
> 时间：2012-05-24T14:42:44.027
> 
> 标签：objective-c, ios, properties

我有一个 c-struct 数组，并且想要定义一个属性。这是相关代码..

```
struct Vertex {
    float x, y, z;
    float nx, ny, nz;
    float u, v;
};

@interface Mesh : NSObject{
    Vertex m_vertices[MaxVertices];
}
@property (nonatomic) Vertex m_vertices[MaxVertices];
@end

@implementation Mesh;
@synthesize m_vertices[MaxVertices];
@end 
```

我第一次这样写是有错误的。如何使用 c-struct 数组设置属性，或自定义 setter 和 getter？任何提示将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T14:53:14.293

利用

```
@property (nonatomic) Vertex *m_vertices; 
```

和

```
@synthesize m_vertices; 
```

反而。你不能使用这样的静态数组；malloc() 它在你的构造函数中使用类似这样的东西，在析构函数中使用 free() ：

```
- (id)init
{
    if ((self = [super init]))
    {
        m_vertices = malloc(sizeof(*m_vertices) * NUM_OF_VERTICES);
    }
    return self;
}

- (oneway void)dealloc
{
    free(m_vertices);
    [super dealloc];
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T14:53:35.297

您不能将数组用作属性。你可以做两件事：

1) 使用 NSArray 或 NSMutableArray 来保存对象而不是结构。

或者

2）将数组放入结构中：

```
typedef struct VertexArray
{
    struct Vertex m_vertices [MaxVertices];
};

@property (nonatomic, assign) VertexArray* m_vertices; 
```

或者

3) 将数组放入对象中

```
@interface VertexArray
{
    struct Vertex m_vertices [MaxVertices];
}

- (struct Vertex)getVertexofIndex:(NSUInteger)index;
- (void)setVertex:(struct Vertex)vertex atIndex:(NSUInteger)index;

@end 
```

对于 Mesh 中的属性：

```
@property (nonatomic, retain) VertexArray* m_vertices; 
```

或者你可以把VertexArray的内容直接放在Mesh里面（即成员变量和两个访问器方法）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-24T14:51:00.187

这是我所能得到的接近。

```
typedef struct _Vertex {
float x, y, z;
float nx, ny, nz;
float u, v;
} Vertex;

#define MaxVertices 5

@interface Mesh : NSObject{
    Vertex m_verticesX[MaxVertices];
    Vertex *m_vertices;
}
@property (nonatomic) Vertex *m_vertices;
@end

@implementation Mesh;
@synthesize m_vertices;
- (Vertex *)m_vertices
{
    if (!m_vertices)
        m_vertices = m_verticesX;
    return m_vertices;
}
@end 
```

希望能帮助到你。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-05-03T18:29:40.420

当您在 C 中返回（任何类型）数组时，您将返回该数组的第一个索引。

因此，如果我想返回下面在接口中声明的变量。

```
 Vertex m_vertices[MaxVertices]; 
```

我可以说...

```
- (Vertex *)m_vertices
{
    return m_vertices;
} 
```

这和上面说的一样...

```
- (Vertex *)m_vertices
   {
       return &m_vertices[0];
   } 
```

但是，如果您想返回整个数组，最好的方法可能是使用 memcpy 指令。

```
memcpy(<#void *#>, <#const void *#>, <#size_t#>) 
```

在此处参考：[http ://www.cplusplus.com/reference/cstring/memcpy/](http://www.cplusplus.com/reference/cstring/memcpy/)

像这样写函数...

```
- (Vertex *)m_vertices
{
   Vertex *localVertex;
   memcpy(localVertex,&m_vertices,sizeof(Vertex)* MaxVertices);
   return localVertex;
} 
```

这会复制文字字节并且非常快。它将返回整个数组。

更好的方法是尽可能地制作这样的功能。

```
- (Vertex *)m_vertices_nthIndex:(int)index
{
   return(&m_vertices[index]);
} 
```

这样你就可以得到你需要的任何项目的索引。

# wpf - WPF 如何禁用 DropShadowEffect

> ID：10739770
> 
> 赞同：7
> 
> 时间：2012-05-24T14:42:46.127
> 
> 标签：wpf

禁用 DropShadowEffect 的最佳方法是什么，例如，如果您知道自己正在远程会话中运行？

我可以考虑将颜色设置为透明，将模糊半径设置为 0，或者将不透明度设置为零，但不确定这些选择是否有任何差异，或者是否有更好的解决方案。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-24T20:04:24.730

[样式触发器 + RenderCapability Tiers](http://blogs.msdn.com/b/henryh/archive/2006/08/23/719568.aspx)是您所需要的。有一些更友好的方式返回渲染层功能，但总体思路就在那里。在使用终端服务时，或者没有硬件效果的渲染能力时，您可以使用样式触发器来移除效果。

```
<Style>
  <Style.Triggers>
    <Trigger Property="Perf:RenderCapabilityWrapper.Tier" Value="0">
      <Setter Property="Effect" Value="{x:Null}"/>
    </Trigger> 
    <Trigger Property="Perf:RenderCapabilityWrapper.Tier" Value="1">
      <Setter Property="Effect" Value="{StaticResource performanceShadow}"/>
    </Trigger> 
    <Trigger Property="Perf:RenderCapabilityWrapper.Tier" Value="2">
      <Setter Property="Effect" Value="{StaticResource qualityShadow}"/>
    </Trigger> 
  </Style.Triggers>
</Style> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T14:46:03.507

除了禁用 DropShadowEffect 之外，您还可以设置控件的样式，使其一开始甚至不使用效果。

# android - 这些是我可以用来从我的应用程序与我大学的 Moodle 通信的 API 类型吗？

> ID：10739775
> 
> 赞同：0
> 
> 时间：2012-05-24T14:43:02.007
> 
> 标签：android, moodle

如果是这样的话。如何？我不明白如何使用它们

[http://docs.moodle.org/dev/Data_manipulation_API](http://docs.moodle.org/dev/Data_manipulation_API)

[http://docs.moodle.org/dev/Authentication_plugins](http://docs.moodle.org/dev/Authentication_plugins)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-25T13:01:05.913

不，Web 服务 API 是您所需要的，也是官方 Moodle 应用程序的通信方式。

请参阅：[http ://docs.moodle.org/dev/Web_services](http://docs.moodle.org/dev/Web_services)

# actionscript-3 - 如何从 NativeWindow 对象访问 NativeWindow 的包装类 (mx:Window) 属性

> ID：10739776
> 
> 赞同：0
> 
> 时间：2012-05-24T14:43:02.640
> 
> 标签：actionscript-3, apache-flex, air, flex4.5, nativewindow

假设我有一个名为 myCustomWindow 的 Window 组件。然后我创建新窗口：

```
var newWindow:myCustomWindow = new myCustomWindow();
newWindow.open(); 
```

myCustomWindow 具有名为 myProperty 的公共属性。

如何从 NativeWindow 访问 myCustomWindow？例如，如何在此循环中执行此操作：

```
for (var i:int = 0; i < NativeApplication.nativeApplication.openedWindows.length; i++) 
{
    if( NativeApplication.nativeApplication.openedWindows[i].myProperty == 25)
    {
          NativeApplication.nativeApplication.openedWindows[i].close();
    } 
    //error, cause NativeWindow doesn't have myProperty
    //how to access myCustomWindow.myProperty of this NativeWindow ?
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T01:17:27.400

这是一种解决方案：

创建数组并 push() 所有窗口。

```
var myWindowsArray:Array = [];
...
myWindowsArray.push(myCustomWindow); 
```

访问我的属性：

```
for each (var k:myCustomWindow in myWindowsArray) 
{
    if( k.myProperty == 25)  k.close();
} 
```

# javascript - 如何在 bada 小部件中获取屏幕的实际宽度和高度？

> ID：10739779
> 
> 赞同：0
> 
> 时间：2012-05-24T14:43:12.680
> 
> 标签：javascript, bada, samsung-mobile

有谁知道如何在 bada (Samsung Wave) 小部件中获得屏幕的真实宽度和高度？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T18:18:48.987

**小部件.window.resizeWindow（宽度，高度）；**

我希望它对某人有帮助

# javascript - Slimscroll 在 IE7 中无法使用 height100%

> ID：10739782
> 
> 赞同：0
> 
> 时间：2012-05-24T14:43:25.690
> 
> 标签：javascript, jquery, css, html, scrollbar

我在我的网站中使用 slimscroll bar，但它在 IE7 中无法使用自动或 100% 高度。如果我给它一个固定的高度，那么它会起作用。但我需要 100% 高度的蚂蚁，它可以在除 IE7 之外的所有浏览器中运行。我用 HTML5 制作了这个页面。

如果我将 doctype 更改为 xhmtl，那么它适用于 height 100% 和 *height:1040px（针对 IE7 的 hack）。但问题是我无法更改文档类型，因为我正在使用 HTML5。

如果您有任何想法，请告诉我。 [http://daawatcatering.com/try/](http://daawatcaterings.com/try/) （鼠标悬停时检查正文部分的滚动条。）

我从这里得到滚动条代码 [http://rocha.la/jQuery-slimScroll](http://rocha.la/jQuery-slimScroll)

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T23:28:09.513

slimScroll 仅支持基于像素的值，因此 auto 或 % 值无效且不起作用。

# javascript - Ajax、asp.net mvc3 路由和相对 url

> ID：10739783
> 
> 赞同：3
> 
> 时间：2012-05-24T14:43:30.627
> 
> 标签：javascript, jquery, ajax, asp.net-mvc-3, relative-path

我有一个 ASP.NET MVC3 应用程序发布到这样的 url：

```
http://servername.com/Applications/ApplicationName/ 
```

在我的代码中，我使用这样的 jquery ajax 请求：

```
$.get(('a/b/c'), function (data) {}, "json"); 
```

当我在本地运行应用程序时，ajax 请求直接转到正确的页面（作为 mvc 路由），因为本地页面以“/”（`localhost/a/b/c`）结尾。

但是，当我发布到 时`http://servername.com/Applications/ApplicationName/`，尾随的“/”并不总是存在。url 可能是`http://servername.com/Applications/ApplicationName`，然后导致 ajax 请求尝试加载`http://servername.com/Applications/ApplicationNamea/b/c`，由于明显的原因而失败。

我已经研究过重写 url 以附加一个斜杠，但是 A）它没有用，并且 B）我觉得这是一个糟糕的解决问题的方法，最好配置 javascript url 来工作无论本地文件夹设置如何。

我确实尝试过“../a/b/c”和“/a/b/c”，但似乎都不起作用。

在此先感谢您的帮助！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-24T14:50:57.040

就我个人而言，我倾向于在我的视图中使用服务器相对 URL 的全局变量，例如：

```
var BASE_URL = '@Url.Content("~/")'; 
```

然后您可以执行以下操作：

```
$.get(BASE_URL + 'a/b/c'), function (data) {}, "json"); 
```

我想补充一点，如果您希望它完全是全球性的，您可以将其添加到您的 /Views/Shared/_Layout.cshtml 中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-24T14:49:22.170

我遇到了同样的问题，最终创建了两个 JavaScript 函数，它们反映了 MVC Url 辅助方法`Url.Action`和`Url.Content`. 这些函数在 _Layout.cshtml 文件中定义，因此在所有视图上都可用，并且无论应用程序是在 localhost 的根目录中还是在服务器的子文件夹中都可以工作。

```
<script type="text/javascript">
    function UrlAction(action, controller) {
        var url = ('@Url.Action("--Action--","--Controller--")').replace("--Action--", action).replace("--Controller--", controller);
        return url;
    }

    function UrlContent(url) {
        var path = "@Url.Content("~/--file--")";
        path = path.replace("--file--", url.replace('~/', ''));
        return path;
    }
</script> 
```

然后可以像这样调用它们：

```
var url = UrlAction('AvailableAssetClasses', 'Assessment');
var url2 = UrlContent('~/Images/calendar.gif'); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-24T14:49:54.523

在 ASP.NET MVC 应用程序中生成 url 时始终使用 Url 助手，并且永远不要对它们进行硬编码。因此，如果此脚本直接位于视图内：

```
<script type="text/javascript">
    var url = '@Url.Action("a", "b")';
    $.get(url, function (data) {}, "json");
</script> 
```

如果这个脚本在一个单独的 javascript 文件中（应该是这样），您无法访问服务器端帮助程序，您可以简单地将 url 放在一些相关的 DOM 元素中。例如使用 HTML5 data-* 属性：

```
<div data-url="@Url.Action("a", "b")" id="foo">Click me</div> 
```

然后在你的 javascript 文件中：

```
$('#foo').click(function() {
    var url = $(this).data('url');
    $.get(url, function (data) {}, "json"); 
}); 
```

如果您不显眼地对锚点或表单进行 AJAX 化，那么您已经有了 url：

```
$('a#someAnchor').click(function() {
    var url = this.href;
    $.get(url, function (data) {}, "json"); 
    return false;
}); 
```

# php - 来自 AJAX 的图像（图表）在页面上显示为一堆符号

> ID：10739784
> 
> 赞同：0
> 
> 时间：2012-05-24T14:44:00.510
> 
> 标签：php, ajax, jpgraph

我正在使用 jpgraph 为我的网站绘制一些统计图表，并且我想在不刷新页面的情况下执行此操作。所以我把 jpgraph 代码放在一个单独的文件中，命名为 plot_graphs.php 并通过 AJAX 向它发送请求。现在，如果我直接打开文件 plot_graphs.php，它会很好地打开图形。但是当我从 AJAX 打开它并指向它以在`<div>`页面上显示响应时，我得到的是：

`�PNG IHDR,��� IDATx���i@���' I;Ⱦ���&amp;*J]�ԥB�XEEK낈��Z۷�X�^�J�P�V��m�Ro]�V*R�Z��R�E�Av��S�Y&��ߧ0̜y�3'g&shb�BԡS]B��!�a��!�a��P}�ݻ7iҤ��`等等等等

有没有办法在不重新加载页面并将 plot_graphs.php 代码直接放入 div 的情况下使其工作？页面的字符集是 utf-8 以防万一。这些是 plot_graphs.php 的内容：

```
<?php

require_once ('../jpgraph/src/jpgraph.php');
require_once ('../jpgraph/src/jpgraph_line.php');

$type=$_GET['type'];
$unit=$_GET['unit'];
$term=$_GET['term'];

$datay1 = array(20,15,23,15);
$datay2 = array(12,9,42,8);
$datay3 = array(5,17,32,24);

// Setup the graph
$graph = new Graph(300,250);
$graph->SetScale("textlin");

$theme_class=new UniversalTheme;

$graph->SetTheme($theme_class);
$graph->img->SetAntiAliasing(false);
$graph->title->Set('Filled Y-grid');
$graph->SetBox(false);

$graph->img->SetAntiAliasing();

$graph->yaxis->HideZeroLabel();
$graph->yaxis->HideLine(false);
$graph->yaxis->HideTicks(false,false);

$graph->xgrid->Show();
$graph->xgrid->SetLineStyle("solid");
$graph->xaxis->SetTickLabels(array('A','B','C','D'));
$graph->xgrid->SetColor('#E3E3E3');
/* $graph->SetBackgroundImage("tiger_bkg.png",BGIMG_FILLPLOT); */

// Create the first line
$p1 = new LinePlot($datay1);
$graph->Add($p1);
$p1->SetColor("#6495ED");
$p1->SetLegend('Line 1');

// Create the second line
$p2 = new LinePlot($datay2);
$graph->Add($p2);
$p2->SetColor("#B22222");
$p2->SetLegend('Line 2');

// Create the third line
$p3 = new LinePlot($datay3);
$graph->Add($p3);
$p3->SetColor("#FF1493");
$p3->SetLegend('Line 3');

$graph->legend->SetFrameWeight(1);

// Output line
$graph->Stroke();

?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T15:02:59.883

看起来您正在尝试发送二进制数据而不指定该数据是什么。试试这个：

```
header("Content-type: image/png");
$graph->Stroke(); 
```

# c++ - ostringstream 用 void * 重载 const char *

> ID：10739798
> 
> 赞同：5
> 
> 时间：2012-05-24T14:44:47.740
> 
> 标签：c++

我的 ostream 有问题，我写了一个非常基本的宏，应该打印出它的参数。

请看下面的示例代码：

```
#define LOG Message(__FILE__, __LINE__,__func__)

class Message : public std::ostringstream 
{
    public:
        Message(const char *param1, int param2, const char *param3)
        {
            *this<<param3<<"("<<param1<<":"<<param2<<")";
        }
        ~Message()
        {
            *this<<endl;
            cout<< rdbuf()->str();
        }
};

int main()
{
    int integer = 1;
    string str = "XYZ";

    LOG<<integer<<"DEBUGLOG1: "<<str<<" "<<integer;
    return 0;
} 
```

问题是如果我使用：

```
LOG << "LOG1: " << str << " " << integer; 
```

输出打印 const char* "LOG1:" 的 Address* 而不是值。

但是，如果我使用：

```
LOG << integer << "DEBUGLOG1: " << str << " " << integer; 
```

输出完美，打印整数值和字符值。

它看起来而不是使用`ostream& operator<< (ostream& out, const char* s );`

它正在使用`ostream& operator<< (const void* val);`？

任何人都可以阐明可以做些什么来克服这种超载吗？

提前致谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-24T14:52:11.313

问题是那`Message(...)`是暂时的。临时不能绑定到 的非常量引用参数`operator<<`。

它只能与成员函数和运算符一起使用，例如`ostream::operator<<(int)`.

奇怪的是成员运算符返回一个引用，该引用又可以与非成员运算符一起使用。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-24T14:53:47.597

预编译并查看宏正在解开的内容。使用宏很困难（而且不建议......），这是一种非常重要的调试方法，您需要知道以避免继续使用 Google 或 SO。

相信你想要`g++ -E`。

# sql - 使用内部联接时 SQL 查询返回膨胀计数

> ID：10739811
> 
> 赞同：0
> 
> 时间：2012-05-24T14:45:59.807
> 
> 标签：sql, sql-server

我正在尝试计算 Encrypted 或 Denied 出现在某个列中的次数。下面的代码返回没有问题

```
use DEW
SELECT Count (distinct DeviceData.machinename) As [Number Of Devices], 
DeviceData.CurrentSite, DeviceData.Country
  ,sum(case buildstatus when 'encrypted' then 1 else 0 end) encrypted
  ,sum(case buildstatus when 'Denied' then 1 else 0 end) Denied
FROM dbo.DeviceData
where currentsite = 'REN'
group by DeviceData.Country, CurrentSite 
```

输出是这样的：

```
Number of Devices SiteCode Country Encrypted Denied
       3             REN    Greece    0         3 
```

但是，当我添加内部联接时

```
FROM dbo.DeviceData JOIN dbo.SiteList ON dbo.DeviceData.country = dbo.SiteList.Country 
```

拒绝更改的数量为 33。

知道为什么 SQL 会这样做吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T14:49:22.987

我想`SiteList`表中有 11 个希腊站点。因此，结果符合预期。

如果您执行了以下操作：

```
SELECT 
    DeviceData.machinename,
    SiteList.Country,
    SiteList.Site, -- Or whatever the column is called...
FROM dbo.DeviceData JOIN 
     dbo.SiteList ON 
         dbo.DeviceData.country = dbo.SiteList.Country 
```

您将看到 33 行被返回：

```
MACHINENAME    COUNTRY    SITE
Machine#1      Greece     Site1
Machine#1      Greece     Site2
Machine#1      Greece     Site3
Machine#1      Greece     Site4
Machine#1      Greece     Site5
Machine#1      Greece     Site6
Machine#1      Greece     Site7
Machine#1      Greece     Site8
Machine#1      Greece     Site9
Machine#1      Greece     Site10
Machine#1      Greece     Site11
Machine#2      Greece     Site1
Machine#2      Greece     Site2
Machine#2      Greece     Site3
Machine#2      Greece     Site4
etc... 
```

我认为您需要的解决方法是加入`Site`，而不是`Country`.

```
 FROM dbo.DeviceData JOIN 
      dbo.SiteList ON 
           dbo.DeviceData.CurrentSite = dbo.SiteList.Site 
```

# php - PHP找不到我的类？

> ID：10739813
> 
> 赞同：-1
> 
> 时间：2012-05-24T14:46:03.310
> 
> 标签：php

如何指定确切的绝对路径？

文件在这里。我这样指定：

```
include "/home/core/public_html/d/core/source/class.Control.php"; 
```

然而它告诉我它不是。

***致命错误：在线 /home/core/public_html/d/core/source/class.ControlEntry.php 中找不到类“控制”***

代码：

```
 <?php 
class ControlEntry
{
    private $control_object;

    function __construct( $control_object )
    {
        $this->control_object = $control_object;
    }
    public function actuate()  
    {   
        if( isset($_POST['ajax_type']) )
        {
            $this->control_object->ajax( $_POST['ajax_type'] );
        }
        else
        {
            $this->control_object->reload();
        }
    }
}
include "/home/core/public_html/d/core/source/class.Control.php"; // Can not find this f***ing file even though it is there.
$control_entry_object = new ControlEntry( new Control() );
$control_entry_object->actuate(); 
```

**故障排除列表**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T14:48:22.147

错误源自`class.ControlEntry.php`. 确保`class.Control.php`在加载 ControlEntry 之前加载。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T14:47:40.900

你包括`"/home/domain/public_html/d/core/source/class.Control.php";`但错误说`/home/domain/public_html/d/core/source/class.ControlEntry.php`。您确定要包含正确的文件或实例化正确的类吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-24T14:49:18.377

那是绝对路径。它看起来不像一个错误。实际上它说找不到该类。它并没有说找不到该文件。我猜在你的 class.ControlEntry.php 第 3 行对 Control 的引用。在使用它之前，您需要包含包含控件的文件。

# json - 最佳实践 - Json 解析中的字符串与 InputStream（使用 gson）

> ID：10739816
> 
> 赞同：4
> 
> 时间：2012-05-24T14:46:10.573
> 
> 标签：json, string, parsing, inputstream, performance

在阅读有关 Json/Gson 的教程时，我注意到大多数人更喜欢将文件作为字符串下载，然后通过 JSON 解析该字符串。但是，大多数 XML 教程更喜欢直接使用 InputStream 进行解析。

为什么两者有区别？最佳实践是什么/它甚至会有所作为吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-12-24T20:04:24.110

XML 用户学到的教训是内存中的大型对象树会占用大量内存。

JSON 解析树本质上并不比 XML 占用更少的内存，但它通常更简单。例如，与 GSON JsonObject 相比，XML DOM 非常有特色。GSON 可能（我不知道）使用仅加载所需内容的流式解析器（类似于 XML 的 SAX）。

但我想说的是，从那时起我们就学到了。JSON 通常作为字符串加载的原因包括：解析器更高效，在大多数情况下需要的功能比完整的 DOM 更少，硬件更强大，JSON 文件通常更短，程序员更懒惰。

也就是说，当我意识到我必须以复杂的方式处理 JSON 数据集，这些数据集太大而无法有效地存储在单个字符串中时，我发现了这篇文章。你不应该那样做，但我很感激 JsonParser.parse() 有一个也可以采用 InputStream 的实现。

# c# - 用于在 C# 上遍历对象属性树的库

> ID：10739819
> 
> 赞同：2
> 
> 时间：2012-05-24T14:46:16.833
> 
> 标签：c#

我想要一个可以通过属性名称遍历对象并获取属性值的方法。

更具体地说，作为输入，我有一个像“Model.Child.Name”这样的字符串，我希望这个方法获取一个对象并让我获得可以通过以下方式以编程方式找到的值：object.Model.Child.Name。

我知道这样做的唯一方法是使用反射，但我不想自己编写这段代码，因为我相信存在陷阱。此外，我认为这或多或少是通常的任务。

在 C# 上是否有像这样的算法的知名实现？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T15:08:17.747

[反思](http://msdn.microsoft.com/en-us/library/ms173183%28v=vs.80%29.aspx)是要走的路。

[在运行时访问属性的反射](http://www.techrepublic.com/article/applied-reflection-dynamically-accessing-properties-of-a-class-at-runtime/6099345)

您可以查看[ObjectDumper](http://objectdumper.codeplex.com/)并根据您的要求修改源代码。

ObjectDumper 获取一个 .NET 对象并将其转储到字符串、文件、textWriter 等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T17:16:40.850

写起来没那么难。是的，有一些陷阱，但很高兴知道这些陷阱。

该算法很简单，它遍历树结构。在每个节点上，您检查它的原始值（int、string、char 等），如果它不是这些时间之一，那么它是一个具有一个或多个原语并且需要遍历到它的原语的结构。

陷阱是处理空值、可空类型、值与引用类型等。每个开发人员都应该知道的直截了当的东西。

# php - PHP ImageMagick setColorspace 不起作用

> ID：10739822
> 
> 赞同：3
> 
> 时间：2012-05-24T14:46:29.207
> 
> 标签：php, imagemagick

我正在尝试通过使用以下代码更改色彩空间来将图像转换为黑白：

```
$im = new Imagick('image.png');
$im->setImageColorspace(Imagick::COLORSPACE_GRAY);
$im->writeImage('out.png'); 
```

但是，在此代码之后，图像没有可见的变化（out.png 和 image.png 看起来无法区分）。关于为什么会这样的任何想法？这是将图像转换为黑白的正确方法吗？还有其他方法吗？

我也试过 setColorspace(Imagick::COLORSPACE_GRAY); 结果相同。

这是我正在使用的软件：

```
ImageMagick 6.6.9-7
PHP 5.3.10-1ubuntu3.1
Server version: Apache/2.2.22 (Ubuntu) 
```

编辑：一些额外的信息

我也尝试过转换为其他色彩空间（特别是 CMY 和 CMYK），并没有注意到视觉上的差异。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T15:29:19.437

作为替代方案，您可以尝试`$im->modulateImage(100,0,100);`代替`setImageColorspace()`

希望这可以帮助！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-02-13T20:03:49.000

正确使用的函数是 Imagick::transformImageColorspace 。嗯，显然它目前没有记录。

在这里，它被用于转换图像，然后分析该图像的单个通道[http://www.phpimagick.com/Imagick/transformImageColorspace](http://www.phpimagick.com/Imagick/transformImageColorspace)

# ruby - 如何使用反引号运行“pushd”？

> ID：10739823
> 
> 赞同：2
> 
> 时间：2012-05-24T14:46:32.397
> 
> 标签：ruby

你如何运行`pushd`和`popd`使用反引号？

每当我`pushd /tmp`在反引号中运行时，我都会收到一个错误：

```
"No such file or directory - pushd /tmp" 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-05-24T14:58:43.670

Ruby shell-outs（反引号）每个都在一个新的子 shell 中运行，因此它可能无法按照您的想法工作：

```
a = `pwd`
`cd '/tmp'`
b = `pwd`
b == a         # => true
b == "/tmp"    # => false 
```

另外，你确定`pushd`在你的shell中工作吗？也许看看使用 ruby​​，`system`或者`popen3`如果你想要比反引号语法更有用的东西。

`Dir#chdir`接受一个块。[这是文档中](http://ruby-doc.org/core-1.9.3/Dir.html#method-c-chdir)的一个示例，如果您只需要在目录中运行一些命令然后改回：

```
Dir.chdir("/var/spool/mail")
puts Dir.pwd
Dir.chdir("/tmp") do
  puts Dir.pwd
  Dir.chdir("/usr") do
    puts Dir.pwd
  end
  puts Dir.pwd
end
puts Dir.pwd 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-24T18:20:37.087

你不能这样使用带有反引号的*pushd ；**pushd*是内置的 Bash，而不是可执行文件。[但是，您可以使用 Ruby Shell](http://www.ruby-doc.org/stdlib-1.9.3/libdoc/shell/rdoc/Shell.html)模块获得类似的功能。

```
require 'shell'
shell = Shell.new
shell.pushd '/tmp'
shell.popd 
```

# hibernate - Hibernate：如何让两个集合字段指向相同的对象

> ID：10739829
> 
> 赞同：0
> 
> 时间：2012-05-24T14:46:53.083
> 
> 标签：hibernate, hibernate-annotations

我正在尝试将两个有序集合一对多字段映射到相同的值。这些字段具有不同的过滤要求。因此，一个字段将包含从另一个字段中过滤掉的项目。

这是实体的相关部分。

```
public class OptionValueSet extends ConfigurationDomainObject {
    ...

    @OneToMany(cascade = CascadeType.ALL, fetch = FetchType.EAGER)
    @JoinColumn(name = OPTION_VALUE_SET_ID_COLUMN, nullable = false)
    @IndexColumn(name = "option_index", nullable = false)
    @Where(clause = OBSOLETE_FILTER)
    private final List<OptionValue> allOptions = new java.util.ArrayList<OptionValue>();

    @OneToMany(cascade = CascadeType.ALL, fetch = FetchType.EAGER)
    @JoinColumn(name = OPTION_VALUE_SET_ID_COLUMN, nullable = false, insertable = false, updatable = false)
    @IndexColumn(name = "option_index", nullable = false)
    @Where(clause = OBSOLETE_FILTER + " AND disabled = '0'")
    @Cache(usage = CacheConcurrencyStrategy.NONSTRICT_READ_WRITE)
    @Immutable
    private final List<OptionValue> options = new java.util.ArrayList<OptionValue>();

    ...
} 
```

和例外

```
原因：org.hibernate.MappingException：实体映射中的重复列：com.casenet.domain.configuration.screen.OptionValue 列：option_value_set_id（应使用 insert="false" update="false" 映射）
    在 org.hibernate.mapping.PersistentClass.checkColumnDuplication（PersistentClass.java:670）
    在 org.hibernate.mapping.PersistentClass.checkPropertyColumnDuplication（PersistentClass.java:692）
    在 org.hibernate.mapping.PersistentClass.checkColumnDuplication（PersistentClass.java:714）
    在 org.hibernate.mapping.PersistentClass.validate(PersistentClass.java:468)
    在 org.hibernate.mapping.RootClass.validate(RootClass.java:215)
    在 org.hibernate.cfg.Configuration.validate(Configuration.java:1135)
    在 org.hibernate.cfg.Configuration.buildSessionFactory(Configuration.java:1320)
    在 org.hibernate.cfg.AnnotationConfiguration.buildSessionFactory（AnnotationConfiguration.java:867）
    在 org.hibernate.ejb.Ejb3Configuration.buildEntityManagerFactory(Ejb3Configuration.java:669)
    ... 137 更多

```

出于好奇，我正在解开两个使用相同休眠字段的用例。目前，过滤器在一个中打开以隐藏禁用的选项值，在另一个中打开以编辑它们。但是，@Filter 注释会干扰缓存。我必须在不更改底层数据库架构的情况下解决这个问题。我们在发布周期中为时已晚，无法做任何更激进的事情。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T15:22:59.200

Since those collections are eagerly fetched anyway, why don't you simply add a getOptions() method that returns a filtered view (or copy) of `allOptions`?

```
public List<OptionValue> getOptions() {
    List<OptionValue> result = new ArrayList<OptionValue>(allOptions.size());
    for (OptionValue o : allOptions) {
        if (!o.isDisabled()) {
            result.add(o);
        }
    }
    return result;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T15:33:25.453

在休眠的想法中，您已经两次映射了相同的字段（在这种情况下是一个子列表；如果您两次映射一个简单的属性，您将收到相同的错误消息）。Hibernate 无法处理它，因为在更新或插入之后状态可能无效（如果两次映射的对象在 Java 代码中获得不同的更新值，hibernate 应该做什么？）。

如果两个字段之一仅用于读取，您可以映射一个字段两次。在简单属性的情况下，错误消息已经告诉您如何操作（`insert="false" update="false"`）。在您的子列表的情况下，您可能还必须设置`cascade`为`none`只读属性。

# ios - 我可以将 UILocalnotification 设置为每个月的最后一天重复吗？

> ID：10739834
> 
> 赞同：3
> 
> 时间：2012-05-24T14:47:14.093
> 
> 标签：ios, uilocalnotification

我想自己尝试一下，但我需要一个月的时间才能确定它是否有效。有人试过这个吗？

```
NSDate *fireDate = // Date I want to repeat, in this case 31 may 

localNotification.fireDate = fireDate;
localNotification.repeatInterval = NSMonthCalendarUnit;
[[UIApplication sharedApplication] scheduleLocalNotification:localNotification]; 
```

我预计它会在每个月的最后一天发出警报。这是一条路吗？而如果我把它安排在 30 天的月份，而第二天是 31 天的月份，比如 4 月 -> 5 月，我该怎么办，因为我只能设置为 4 月 30 日（也是 2 月 28 日和 29 日的问题）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-31T03:16:10.843

玩了`UILocalNotification`一段时间后我得到了一个答案，如果你想让它每个月的最后一天重复一次，只需将它设置为 1 月 31 日`repeatInterval` `NSMonthCalendarUnit`，它会在每个月的最后一天重复

# javascript - 移动设备网络浏览器在线程睡眠方面是否有任何标准？

> ID：10739835
> 
> 赞同：6
> 
> 时间：2012-05-24T14:47:16.973
> 
> 标签：javascript, android, ios, mobile, dom-events

给定以下 jsFiddle，这是一个简单的递增计数器

[http://jsfiddle.net/C93ms/6/](http://jsfiddle.net/C93ms/6/)

 `....如果我使用移动设备（为了争论而使用智能手机或平板电脑）访问上面的 url，如果有 JavaScript 支持，计数器会按照您的预期开始递增，然后看起来如果我按下“主页"按钮，或单击电源按钮一次关闭屏幕（但保持手机开机），然后脚本将停止运行并且计数器停止递增。我希望这会发生，并且我很欣赏保留电池寿命在移动设备上非常重要的原因，因此 UI 线程休眠或类似情况是有道理的。重新访问浏览器后，计数器会继续递增。在现实世界中，我假设使用 JavaScript 确定超时时间的网站不会超时，尽管处于非活动状态。

我还假设这会因设备、固件、甚至软件而异——我在这里*试图*确定的是移动开发框架中是否有**标准方法**或**默认行为**，以及在如何实现的任何形式的一致性。设备的行为。

我不完全确定我在这里问了一个*好问题*，但是我一直在努力从 SO 中找到 100% 的相关信息，或者我不太清楚在搜索时我需要问什么问题。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-24T15:27:09.057

没有任何 JavaScript 框架可以停止执行或改变底层 JS 引擎的行为。他们将无法影响`setTimeout`。

然而，该行为在当前的 HTML5 草案中已在[`WindowTimers`界面](http://www.w3.org/TR/html5/webappapis.html#timers)上标准化（这并不意味着它是这样实现的）。在那里你会找到注释：

> 此 API 不保证计时器将完全按计划运行。由于 CPU 负载、其他任务等导致的延迟是可以预料的。

而且，更明确：

> 9) 可选地，等待用户代理定义的时间长度。
> 
> > 注意：这旨在允许用户代理根据需要填充超时以优化设备的电源使用。例如，某些处理器具有低功耗模式，其中定时器的粒度会降低；在这样的平台上，用户代理可以减慢计时器以适应这个时间表，而不是要求处理器使用更精确的模式以及相关的更高的功耗。

你也可以在桌面浏览器上看到这样的行为，它实现了 4 毫秒的最小超时（阅读[MDN 上的解释](https://developer.mozilla.org/en/DOM/window.setTimeout#Minimum_delay_and_timeout_nesting)）。因此，每个设备/软件/固件只要认为有必要就停止此类执行是合法的。

您可能还想看看[`WindowAnimationTiming`草稿](http://www.w3.org/TR/animation-timing/)。

如果您确实在动画/时钟/等中使用`setInterval`/ ，请始终使用[对象](http://ecma-international.org/ecma-262/5.1/#sec-15.9)（例如 via ）测量实际经过的时间。`setTimeout`[`Date`](http://ecma-international.org/ecma-262/5.1/#sec-15.9)`Date.now()``

# web-services - Websphere 门户中的共享端点 URL

> ID：10739836
> 
> 赞同：2
> 
> 时间：2012-05-24T14:47:18.723
> 
> 标签：web-services, websphere, webservice-client, websphere-portal

在 websphere 中共享 web 服务的端点 url 的最佳方式是什么？我们将所有 Web 服务客户端都放在一个共享库中，以便所有战争和 portlet 都可以访问它们。我们目前混合了属性文件和 portlet 首选项设置以及 Web 服务的端点，但是我们想要一种方式，我们可以只更改一次端点并且所有应用程序都会看到更改。这可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T15:18:49.513

我不知道 Portal，只有 WAS，但你能参考[URL Resource Reference](http://pic.dhe.ibm.com/infocenter/wasinfo/v7r0/topic/com.ibm.websphere.nd.doc/info/ae/ae/tjtc_uovr.html)吗？

# c# - PerformanceCounter.NextValue() 抛出 InvalidOperationException

> ID：10739842
> 
> 赞同：7
> 
> 时间：2012-05-24T14:47:46.610
> 
> 标签：c#, iis-7.5, windows-server-2008-r2, performancecounter, invalidoperationexception

这是创建性能计数器的代码：

```
var ftpPerfCounter = new PerformanceCounter("FTP Service", "Current Connections", "_Total"); 
```

这是发生异常的地方：

```
int cnt = (int)Math.Round(ftpPerfCounter.NextValue()); 
```

这是`Exception`消息：

> “错误消息：指定类别的计数器布局无效，计数器类型：AverageCount64、AverageTimer32、CounterMultiTimer、CounterMultiTimerInverse、CounterMultiTimer100Ns、CounterMultiTimer100NsInverse、RawFraction 或 SampleFraction 必须紧跟任何基本计数器类型：AverageBase 、CounterMultiBase、RawBase 或 SampleBase。”

错误消息非常神秘。我不确定将来可以做些什么来避免异常。

*细节*

这发生在 Windows Server 2008 R2 64 位操作系统上。FTP 服务器是 IIS。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T18:59:19.037

至少在我的带有 IIS 7.5 的 Windows Server 2008 R2 上，性能计数器类别称为“Microsoft FTP 服务”而不是“FTP 服务”。不同的 OS/IIS 版本可能会有所不同，但很容易检查。

在您的目标服务器/机器上：

1.  运行“性能监视器”
2.  单击左侧导航窗格中的“性能监视器”
3.  单击加号图标以添加性能计数器
4.  向下滚动可用计数器列表。查找 FTP 或 Microsoft FTP 以查看它是否存在...请注意，如果您没有安装 Microsoft FTP 服务，您将看不到性能计数器。
5.  找到后，选择它，您将看到可以查询的特定计数器实例列表。其中一个实例是您感兴趣的“_Total”。

当然，这也证明了性能计数器的工作独立于您的代码。这是一件好事！

有关如何[在 C#/.NET 中使用性能计数器的具体最佳实践，请参阅此 stackoverflow 帖子](https://stackoverflow.com/a/8265208/1002041)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-02T18:14:15.657

我的 PC 上没有安装 IIS，但如果我安装了，我会尝试以下方法：

1.  尝试通过从服务器资源管理器拖放来使用 Visual Studio 的 WMI 代码生成器。检查生成的代码，看看是否与您的代码有任何差异。
2.  使用反射器查看抛出异常的位置，在 BCL 中设置自定义断点，然后重现。然后分析调用堆栈内容并寻找可疑的代码路径或意外状态。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-10T11:10:58.393

他们似乎在[这里](http://bytes.com/topic/net/answers/103803-performancecounters)解决了类似的问题。也许您必须设置一个基本计数器？

# python - 我应该如何在 python 评论中格式化长 url 并且仍然符合 PEP8

> ID：10739843
> 
> 赞同：98
> 
> 时间：2012-05-24T14:47:47.240
> 
> 标签：python, pep8

在块注释中，我想引用一个长度超过 80 个字符的 URL。

显示此 URL 的首选约定是什么？

我知道 bit.ly 是一个选项，但 URL 本身是描述性的。缩短它然后有一个描述缩短 URL 的嵌套注释似乎是一个糟糕的解决方案。

* * *

## 回答 #1

> 赞同：84
> 
> 时间：2012-05-24T14:56:20.537

不要破坏网址：

```
# A Foolish Consistency is the Hobgoblin of Little Minds [1]
# [1]: http://www.python.org/dev/peps/pep-0008/#a-foolish-consistency-is-the-hobgoblin-of-little-minds 
```

* * *

## 回答 #2

> 赞同：75
> 
> 时间：2012-05-24T14:55:13.387

来自[PEP8](http://www.python.org/dev/peps/pep-0008/#a-foolish-consistency-is-the-hobgoblin-of-little-minds)

> 但最重要的是：知道何时不一致——有时风格指南并不适用。如有疑问，请使用您的最佳判断。查看其他示例并决定什么看起来最好。不要犹豫，问！
> 
> 打破特定规则的两个充分理由：
> 
> *   应用规则会使代码的可读性降低，即使对于习惯于阅读遵循规则的代码的人也是如此。

就个人而言，我会使用该建议，而不是在您的评论中为人们留下完整的描述性 URL。

* * *

## 回答 #3

> 赞同：53
> 
> 时间：2014-07-30T10:43:30.777

您可以`# noqa`在行尾使用 来阻止 PEP8/Flake8 运行该检查。PEP8 通过以下方式允许这样做：

> 特殊情况不足以打破规则。

* * *

## 回答 #4

> 赞同：22
> 
> 时间：2012-05-24T14:55:25.980

我会说离开它...

[PEP20](http://www.python.org/dev/peps/pep-0020/)：

> 特殊情况不足以打破规则。
> 
> 虽然实用胜过纯洁。

能够快速复制/粘贴 url 然后在粘贴到浏览器时删除换行符更实用。

* * *

## 回答 #5

> 赞同：20
> 
> 时间：2016-09-29T10:41:51.010

如果您使用的是 flake8：

```
"""
long-url: http://stackoverflow.com/questions/10739843/how-should-i-format-a-long-url-in-a-python-comment-and-still-be-pep8-compliant
"""  # noqa 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2022-02-24T13:12:16.727

添加 '#noqa' 有效，但如果它在文档字符串中，则在使用 spinx 构建时，'#noqa' 会显示在文档中。在这种情况下，您可以构建自定义 autodoc 处理方法。看到[这个答案](https://stackoverflow.com/questions/26534184/can-sphinx-ignore-certain-tags-in-python-docstrings)。

这是我的改编版本，

```
from sphinx.application import Sphinx
import re

def setup(app):

    noqa_regex = re.compile('^(.*)\s\s#\snoqa.*$')

    def trim_noqa(app, what_, name, obj, options):
        for i, line in enumerate(lines):
            if noqa_regex.match(line):
                new_line = noqa_regex.sub(r'\1', line)
                lines[i] = new_line

    app.connect('autodoc-process-docstring', trim_noqa)
    return app 
```

* * *

## 回答 #7

> 赞同：-3
> 
> 时间：2013-04-08T06:42:13.663

你使用像谷歌这样的网址缩短器：

[http://www.python.org/dev/peps/pep-0008/#a-foolish-consistency-is-the-hobgoblin-of-little-minds](http://www.python.org/dev/peps/pep-0008/#a-foolish-consistency-is-the-hobgoblin-of-little-minds)

你得到：

[http://goo.gl/93ZLQ](http://goo.gl/93ZLQ)

* * *

## 回答 #8

> 赞同：-6
> 
> 时间：2012-05-24T22:54:08.223

我的选择是：

```
URL = ('http://stackoverflow.com/questions/10739843/'
       'how-should-i-format-a-long-url-in-a-python-'
       'comment-and-still-be-pep8-compliant') 
```

# javascript - JavaScript. 替换 HTML 标记外用美元符号 ($) 包裹的内容

> ID：10739844
> 
> 赞同：4
> 
> 时间：2012-05-24T14:47:50.780
> 
> 标签：javascript, regex

**注意：我不是在尝试用正则表达式解析 HTML**

我正在尝试替换字符串中包含在 $ 符号（$for example$）中的任何内容。我设法想出了`str.replace(/\$([^\$]*)\$/g), "hello $1!")`，但是我在确保在将此类字符串包装在 HTML 标记中时不替换它们时遇到了问题。

示例字符串：`$someone$, <a>$welcome$</a>, and $another$`

表达：`/[^>]\$([^\$]*)\$[^<]/g`

预期输出：`hello someone!, <a>$welcome</a>, and hello another!`

实际输出：`$someonhello , !elcomhello , and !nother$`

测试代码：`alert("$someone$, <a>$welcome$</a>, and $another$".replace(/[^>]\$([^\$]*)\$[^<]/g, "hello $1!"));`

小提琴：http: [//jsfiddle.net/WMWHZ/](http://jsfiddle.net/WMWHZ/)

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-24T15:01:59.957

请记住，您的测试用例中有 6 个“$”。这里的问题是，当您尝试检查前一个字符是否不是“>”时，正则表达式会向前移动并匹配**第 4 个**和第**5 个**美元符号之间的内容，`"</a>, and "`从而捕获并弄得一团糟。

试试这个：

```
$('div').text(test.replace(/(^|[^>])\$([^<][^\$]*)\$(?!<)/g, "$1hello $2!"))​ 
```

Javascript 不支持正则表达式中的lookbehinds，但它支持lookaheads（`(?!<)`部分）。为了模拟lookbehinds，您正确地尝试放在`[^>]`美元之前，但随后字符匹配，因此您必须抓住它并再次将其放入字符串中。

您只需要稍微改进它，因为如果 '$' 位于字符串的开头，则不会捕获该组。

此外，为避免上述问题，您应该检查第一美元*之后*是否没有“<” ，因此我`[^<]`在捕获组的开头放置了一个。这也意味着它不会捕获美元符号之间的空字符串（如'$$'），它们必须至少包含一个字符。

这样，您就有了预期的结果。

# sql-server-2008 - 如何部署 SQL Server Compact Edition 4.0？

> ID：10739845
> 
> 赞同：47
> 
> 时间：2012-05-24T14:47:55.493
> 
> 标签：sql-server-2008, deployment, sql-server-ce, ado, xcopy

如何部署[Microsoft SQL Server Compact 4.0](http://www.microsoft.com/en-us/download/details.aspx?id=17876)？

* * *

SQL Server Compact Edition（当前为 4.0 版）为：

> 一个免费的嵌入式数据库，软件开发人员可以使用它来构建 Windows 桌面应用程序。它占用空间小，并支持在应用程序文件夹中私有部署其二进制文件。

但是您如何实际部署它？

*   微软表示它**可以**[部署在应用程序文件夹中（](http://channel9.msdn.com/coding4fun/blog/SQL-Server-Compact-Edition-40-Toolkit-v2-Dont-leave-your-Visual-Studio-without-it)*很好[*）*](http://channel9.msdn.com/coding4fun/blog/SQL-Server-Compact-Edition-40-Toolkit-v2-Dont-leave-your-Visual-Studio-without-it)[并支持 xcopy 部署](http://channel9.msdn.com/coding4fun/blog/SQL-Server-Compact-Edition-40-Toolkit-v2-Dont-leave-your-Visual-Studio-without-it)。*
**   微软还表示**不能**[在应用程序文件夹内部署（](http://support.microsoft.com/kb/920700)*不好[*）*](http://support.microsoft.com/kb/920700)[，并且不支持 xcopy 部署](http://support.microsoft.com/kb/920700)。***   有些人有[使用简单 xcopy 部署的示例](http://robindotnet.wordpress.com/2010/02/28/how-to-deploy-the-sqlserver-compact-edition-software-locally/)，但他们没有详细介绍完成部署所需的细节**

 **问题是您不能使用 ADO OLEdb 提供程序，除非它已注册。必须以管理员身份注册 OLEDb 提供程序。这意味着 SQL Server Compact 版本会因非管理员用户而失败。

SQL Server Compact 4.0 附带一个`redist_enu.txt`文件：

> 列出的 .exe 文件每个都将其随附的组件安装到目标计算机上的特定位置。这有助于确保可维护性和技术支持。这些 .exe 文件中包含的 .dll 文件也可在此 redist.txt 中单独获得。但是，这些单独的 .dll 的分发可能会导致可用性问题。有关详细信息，请参阅[http://go.microsoft.com/fwlink/?LinkId=94589](http://go.microsoft.com/fwlink/?LinkId=94589)
> 
> 通过 BreadCrumb 进行私有部署检测：不支持仅本机堆栈的私有部署和通过 Assembly.LoadFrom()、.local 文件或使用 DLL/COM 重定向策略显式加载 SQL Server Compact 程序集，并且可能导致可服务性问题. 有关详细信息，请参阅[http://support.microsoft.com/kb/835322](http://support.microsoft.com/kb/835322)和[http://msdn2.microsoft.com/en-us/library/aa375142.aspx](http://msdn2.microsoft.com/en-us/library/aa375142.aspx)
> 
> ## 微软 SQL Server 紧凑型 4.0
> 
> SSCERuntime_x86-ENU.exe
> SSCERuntime_x86-DEU.exe
> SSCERuntime_x86-FRA.exe
> SSCERuntime_x86-
> JPN.exe SSCERuntime_x86-RUS.exe
> SSCERuntime_x86-ESN.exe
> SSCERuntime_x86-ITA.exe
> SSCERuntime_x86-KOR.exe
> SSCESSSS_x86
> -CHTCHS.exe
> SSCERuntime_x64-ENU.exe
> SSCERuntime_x64-DEU.exe
> SSCERuntime_x64-FRA.exe
> SSCERuntime_x64-
> JPN.exe SSCERuntime_x64-RUS.exe
> SSCERuntime_x64-ESN.exe
> SSCERuntime_x64-ITA.exe
> SSCERuntime_x64-KOR.exe
> SSCESSSS_x64
> -CHTCHS.exe
> sqlcese40.dll
> sqlceqp40.dll
> sqlceoledb40.dll
> sqlceca40.dll
> sqlceme40.dll
> sqlcecompact40.dll
> sqlceer40en.dll
> sqlceer40cn.dll/sqlceer40zh-CHS.dll
> sqlceer40de.dll
> sqlceer40es.dll
> sqlceer40fr.dll
> sqlceer40it.dll
> sqlceer40ja.dll
> sqlceer40ko.dll
> sqlceer40CHTtw.dll dll
> sqlceer40ru.dll
> System.Data.SqlServerCe.dll
> System.Data.SqlServerCe.Entity.dll

但它没有提供有关如何重新分发 SQL Server Compact 4.0 的任何信息。

在未记录的文件夹周围随机拼写`Program Files`我发现了 7 个 dll：

```
C:\Program Files\Microsoft SQL Server Compact Edition\v4.0\
      sqlceoledb40.dll
      sqlceqp40.dll
      sqlcese40.dll
      sqlceca40.dll
      sqlcecompact40.dll
      sqlceer40EN.dll
      sqlceme40.dll 
```

**注意：**还有一些包含更多 dll 的子文件夹

我尝试将这 7 个 dll 复制到一个文件夹中，并尝试使用[连接字符串打开一个](http://www.quickersite.com/r/default.asp?iID=HFJJLH&iPostID=MFLDKE)[ADO 连接](http://msdn.microsoft.com/en-us/library/windows/desktop/ms681519%28v=vs.85%29.aspx)：

```
Provider=Microsoft.SQLSERVER.CE.OLEDB.4.0;Data Source="store.sdf" 
```

但它失败了`0x80004005 Unspecified error`

[我尝试 frobbing 小部件，但它抓住了 frobber。](http://blogs.msdn.com/b/oldnewthing/archive/2011/01/20/10117963.aspx)

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2012-05-29T14:04:39.253

我已经创建了解决方案。

SQL Server Compact Edition 由 7 个 dll 组成：

*   `sqlceme40.dll`未记录的本机平面 API 库（.net`System.Data.SqlServerCe.dll`程序集是此 dll 的包装器）
*   `sqlceca40.dll`一个实现`Engine`,`Replication`和`Error`一些其他 COM 对象的 COM dll
*   `sqlceoledb40.dll`为 SSCE 实现 OLEdb 提供程序的 COM dll（允许使用 ADO）
*   `sqlcese40.dll` *未知*
*   `sqlceqp40.dll` *未知*
*   `sqlcecompact40.dll` *未知*
*   `sqlceer40en.dll` *未知*

试图简单地发送这些 dll 的问题是其中两个是**COM**对象。COM 对象 dll 需要*注册*，例如：

```
>regsvr32 sqlceca40.dll
>regsvr32 sqlceoledb40.dll 
```

问题是注册 COM 对象需要*管理*权限（[使用全局解决方案来解决本地问题](http://blogs.msdn.com/b/oldnewthing/archive/2008/12/11/9193695.aspx)）。这意味着您的用户将

*   必须*安装*您的应用程序（您不想这样做）
*   要求您的用户具有管理权限（您不想这样做）

幸运的是，从 2001 年的 Windows XP 开始，微软解决了这个常见的问题：[免注册 COM](http://msdn.microsoft.com/en-us/library/ms973913.aspx)。

首先，您将声明您的应用程序对 SQL Server Compact Edition 4.0具有***“依赖性” 。***您可以通过编写程序集清单来做到这一点：

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<assembly xmlns="urn:schemas-microsoft-com:asm.v1" manifestVersion="1.0"> 
    <assemblyIdentity 
        version="1.0.0.0"
        processorArchitecture="X86"
        name="client"
        type="win32"
    /> 

    <description>Hyperion Pro</description> 

    <!-- We have a dependancy on SQL Server CE 4.0 -->
    <dependency>
        <dependentAssembly>
            <assemblyIdentity
                type="win32"
                name="Microsoft.SQLSERVER.CE.4.0"
                version="4.0.0.0" processorArchitecture="x86"
            />
        </dependentAssembly>
    </dependency> 
```

```
 <!-- We are high-dpi aware on Windows Vista -->
    <asmv3:application xmlns:asmv3="urn:schemas-microsoft-com:asm.v3">
        <asmv3:windowsSettings
            xmlns="http://schemas.microsoft.com/SMI/2005/WindowsSettings">
            <dpiAware>true</dpiAware>
        </asmv3:windowsSettings>
    </asmv3:application>

    <!-- We were designed and tested on Windows 7 -->
    <compatibility xmlns="urn:schemas-microsoft-com:compatibility.v1">
        <application>
            <!--The ID below indicates application support for Windows 7 -->
            <supportedOS Id="{35138b9a-5d96-4fbd-8e2d-a2440225f93a}"/>
            <!--The ID below indicates application support for Windows Vista -->
            <!--supportedOS Id="{e2011457-1546-43c5-a5fe-008deee3d3f0}"/-->
        </application>
    </compatibility>

    <!-- Disable file and registry virtualization -->
    <trustInfo xmlns="urn:schemas-microsoft-com:asm.v2">
        <security>
            <requestedPrivileges>
                <requestedExecutionLevel level="asInvoker" uiAccess="false"/>
            </requestedPrivileges>
        </security>
    </trustInfo>
</assembly> 
```

您可以将此文件放在您的可执行文件（as ）*旁边*`Hyperion.exe.manifest`，或者您可以将它作为`RT_MANIFEST`资源构建到您的应用程序中。

请注意，我们依赖于名为 的程序集`Microsoft.SQLSERVER.CE.4.0`。我们首先通过创建一个名为的**目录**来创建此程序集：

> Microsoft.SQLSERVER.CE.4.0

当您部署您的应用程序时，您会将构成此*“程序集”*`Microsoft.SQLSERVER.CE.4.0`的所有 7 个 dll连同一个特殊文件一起放入此子文件夹`.manifest`：

```
C:\
╰──Users
   ╰──Ian
      ╰──AppData
         ╰──Local
            ╰──Hyperion Pro
               ├──Hyperion.exe
               ├──Hyperion.exe.manifest
               ╰──Microsoft.SQLSERVER.CE.4.0
                  ├──sqlceme40.dll
                  ├──sqlceca40.dll
                  ├──sqlceoledb40.dll
                  ├──sqlcese40.dll
                  ├──sqlceqp40.dll
                  ├──sqlcecompact40.dll
                  ├──sqlceer40en.dll
                  ╰──Microsoft.SQLSERVER.CE.4.0.manifest 
```

换句话说，应用程序文件夹包含您的应用程序和**Microsoft.SQLSERVER.CE.4.0**文件夹：

```
 Directory of C:\Users\Ian\AppData\Local\Hyperion Pro

05/29/2012  09:23 AM         1,899,008 Hyperion.exe
05/28/2012  01:46 PM             1,587 Hyperion.exe.manifest
05/29/2012  09:27 AM    <DIR>          Microsoft.SQLSERVER.CE.4.0
           2 File(s)      1,900,675 bytes
           1 Dir(s)  20,851,503,104 bytes free 
```

您任务的下一部分是定义`Microsoft.SQLSERVER.CE.4.0.manifest`文件。免注册 COM 允许清单文件声明所有 COM 对象及其 clsid。这需要大量的逆向工程。但是 SQL Server Compact Edition 4.0 的程序集清单是：

**Microsoft.SQLSERVER.CE.4.0.manifest**：

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<assembly xmlns="urn:schemas-microsoft-com:asm.v1" manifestVersion="1.0">

<assemblyIdentity 
       type="win32"
       name="Microsoft.SQLSERVER.CE.4.0"
       processorArchitecture="x86"
       version="4.0.0.0" />

<!-- OLEDB Provider -->
<file name = "sqlceoledb40.dll">
    <comClass
            description = "Microsoft SQL Server Compact OLE DB Provider for Windows"
            clsid="{2006C53A-C915-41EA-BAA9-9EAB3A1FBF97}"
            threadingModel = "Both"
            progid = "Microsoft.SQLSERVER.CE.OLEDB.4.0" />
</file>

<!-- Native flat engine library -->
<file name="sqlceme40.dll" />

<!-- Engine and Replication COM object -->
<file name="sqlceca40.dll">
    <comClass description="Active SSCE Engine Object"
            clsid="{68D45319-3702-4837-9F8E-DA6845D82482}"
            threadingModel="Both"
            progid="SSCE.Engine.4.0" />
    <comClass description="SSCE Error Object"
            clsid="{36228F21-B5C7-4054-8DC2-47D3E236E8B5}"
            threadingModel="Both"
            progid="SSCE.Error.4.0" />
    <comClass description="SSCE Param Object"
            clsid="{0B3A7B75-A9B0-4580-9AA5-1A7DA47AD1CB}"
            threadingModel="Both"
            progid="SSCE.Param.4.0" />
    <comClass description="Active SSCE Replication Object"
            clsid="{11D5B2D4-26A4-44F5-A48B-0FAC3A919ED8}"
            threadingModel="Both"
            progid="SSCE.Replication.4.0" />
    <comClass description="Active SSCE remote data access Object"
            clsid="{58BC9AD6-BF11-40B3-9AB1-E3F2ED784C08}"
            threadingModel="Both"
            progid="SSCE.RemoteDataAccess.4.0" />

    <typelib tlbid="{CE4AACFA-3CFD-4028-B2D9-F272314F07C8}"
            version="4.0" 
            helpdir=""/>
</file>

<comInterfaceExternalProxyStub 
    name="ISSCEEngine"
    iid="{10EC3E45-0870-4D7B-9A2D-F4F81B6B7FA2}"
    proxyStubClsid32="{00020424-0000-0000-C000-000000000046}"
    baseInterface="{00000000-0000-0000-C000-000000000046}"
    tlbid = "{CE4AACFA-3CFD-4028-B2D9-F272314F07C8}" />

<comInterfaceExternalProxyStub 
    name="ISSCEError"
    iid="{31155A3B-871D-407F-9F73-DEBFAC7EFBE3}"
    proxyStubClsid32="{00020424-0000-0000-C000-000000000046}"
    baseInterface="{00000000-0000-0000-C000-000000000046}"
    tlbid = "{CE4AACFA-3CFD-4028-B2D9-F272314F07C8}" />

<comInterfaceExternalProxyStub 
    name="ISSCERDA"
    iid="{4F04F79D-1FF1-4DCD-802B-3D51B9356C14}"
    proxyStubClsid32="{00020424-0000-0000-C000-000000000046}"
    baseInterface="{00000000-0000-0000-C000-000000000046}"
    tlbid = "{CE4AACFA-3CFD-4028-B2D9-F272314F07C8}" />

<comInterfaceExternalProxyStub 
    name="ISSCEParams"
    iid="{A78AFF90-049C-41EC-B1D8-665968AAC4A6}"
    proxyStubClsid32="{00020424-0000-0000-C000-000000000046}"
    baseInterface="{00000000-0000-0000-C000-000000000046}"
    tlbid = "{CE4AACFA-3CFD-4028-B2D9-F272314F07C8}" />

<comInterfaceExternalProxyStub 
    name="ISSCEParam"
    iid="{A9876C60-2667-44E5-89DB-E9A46ED392C0}"
    proxyStubClsid32="{00020424-0000-0000-C000-000000000046}"
    baseInterface="{00000000-0000-0000-C000-000000000046}"
    tlbid = "{CE4AACFA-3CFD-4028-B2D9-F272314F07C8}" />

<comInterfaceExternalProxyStub 
    name="ISSCEErrors"
    iid="{C40143CA-E9F9-4FF4-B8B4-CC02C064FC1B}"
    proxyStubClsid32="{00020424-0000-0000-C000-000000000046}"
    baseInterface="{00000000-0000-0000-C000-000000000046}"
    tlbid = "{CE4AACFA-3CFD-4028-B2D9-F272314F07C8}" />

<comInterfaceExternalProxyStub 
    name="ISSCEMerge"
    iid="{C6EB397F-D585-428D-A4F4-454A1842CB47}"
    proxyStubClsid32="{00020424-0000-0000-C000-000000000046}"
    baseInterface="{00000000-0000-0000-C000-000000000046}"
    tlbid = "{CE4AACFA-3CFD-4028-B2D9-F272314F07C8}" />

<file name="sqlceqp40.dll" />
<file name="sqlcese40.dll" />
<file name="sqlcecompact40.dll" />
<file name="sqlceer40EN.dll" />

</assembly> 
```

最后一个问题是，就像我们依赖于名为 的程序集一样`Microsoft.SQLSERVER.CE.4.0`，SQL Server Compact Edition 4.0 反过来又依赖于名为 的程序集`Microsoft.VC90.CRT`。幸运的是，您安装的 SQLCE 附带了此程序集的副本：

```
Microsoft.VC90.CRT
├──Microsoft.VC90.CRT.manifest 
╰──msvcr90.dll 
```

这意味着最终的目录结构是：

```
C:\
╰──Users
   ╰──Ian
      ╰──AppData
         ╰──Local
            ╰──Hyperion Pro
               ├──Hyperion.exe
               ├──Hyperion.exe.manifest
               ╰──Microsoft.SQLSERVER.CE.4.0
                  ├──Microsoft.SQLSERVER.CE.4.0.manifest
                  ├──sqlceme40.dll
                  ├──sqlceca40.dll
                  ├──sqlceoledb40.dll
                  ├──sqlcese40.dll
                  ├──sqlceqp40.dll
                  ├──sqlcecompact40.dll
                  ├──sqlceer40en.dll
                  ╰──Microsoft.VC90.CRT
                     ├──Microsoft.VC90.CRT.manifest
                     ╰──msvcr90.dll 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-04-06T23:06:00.180

对于 Sql Server Ce 4.0 SP1：

我没有处理所有棘手的部署问题，而是选择将设置文件本身作为 EmbeddedResource 包含到我的 exe 中，并做了这个小帮手：

```
 public static class RedistHelper
    {
        private static readonly ILog Log = LogManager.GetLogger(
                                              MethodBase.GetCurrentMethod().DeclaringType);

        private static readonly string SqlCeRedistName64 = "SSCERuntime_x64-ENU.exe";
        private static readonly string SqlCeRedistName32 = "SSCERuntime_x86-ENU.exe";
        private static readonly Dictionary<string, Assembly> Assemblies = 
                        new Dictionary<string, Assembly>(StringComparer.OrdinalIgnoreCase);

        private static string SqlCeRedistName
        {
            get 
            {
                return Environment.Is64BitOperatingSystem 
                                       ? SqlCeRedistName64 
                                       : SqlCeRedistName32;
            }
        }

        public static bool IsSqlCeInstalled()
        {
            RegistryKey localKey = RegistryKey.OpenBaseKey(RegistryHive.LocalMachine,
                                                           RegistryView.Registry64);
            RegistryKey ret = localKey.OpenSubKey(
                    @"SOFTWARE\Microsoft\Microsoft SQL Server Compact Edition\v4.0\ENU");
            return ret != null;
        }

        private static byte[] ReadFully(Stream input)
        {
            byte[] buffer = new byte[16 * 1024];
            using (MemoryStream ms = new MemoryStream())
            {
                int read;
                while ((read = input.Read(buffer, 0, buffer.Length)) > 0)
                    ms.Write(buffer, 0, read);
                return ms.ToArray();
            }
        }

        public static Assembly OnCurrentDomainOnAssemblyResolve(object sender,
                                                                ResolveEventArgs args)
        {
            Assembly dll;
            var name = new AssemblyName(args.Name).Name + ".dll";
            if (!Assemblies.TryGetValue(name, out dll))
            {
                Assembly res = typeof(RedistHelper).Assembly;
                using (Stream input =
                           res.GetManifestResourceStream(typeof(RedistHelper), name))
                {
                    if (input == null)
                    {
                        Log.WarnFormat("Assembly {0} does not contain {1}", res, name);
                        return null;
                    }
                    dll = Assembly.Load(ReadFully(input));
                    if (dll == null)
                    {
                        Log.WarnFormat("Assembly {0} failed to load.", name);
                        return null;
                    }
                    Log.InfoFormat("Loaded assembly {0}.", name);
                    Assemblies[name] = dll;
                    return dll;
                }
            }
            return dll;
        }

        public static void InstallSqlCe()
        {
            using (Stream stream =
                       typeof(RedistHelper).Assembly.GetManifestResourceStream(
                           typeof(RedistHelper), SqlCeRedistName))
            {
                Debug.Assert(stream != null);
                byte[] bytes = new byte[(int)stream.Length];
                stream.Read(bytes, 0, bytes.Length);
                string path = Path.Combine(Path.GetTempPath(), SqlCeRedistName);

                if (File.Exists(path))
                    File.Delete(path);

                File.WriteAllBytes(path, bytes);

                Process process = new Process
                                  {
                                      StartInfo = new ProcessStartInfo
                                                  {
                                                      FileName = path,
                                                      UseShellExecute = true
                                                  }
                                  };
                process.Start();
                process.WaitForExit();
            }
        }
    } 
```

唯一真正让我头疼的是引用 System.Data.SqlServerCe.dll - 它根本不会 IlMerge，所以我在我的主要内容中按需加载它：

```
AppDomain.CurrentDomain.AssemblyResolve += RedistHelper.OnCurrentDomainOnAssemblyResolve; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-06-20T18:59:13.267

不确定是否发生了变化。但是使用最新的 SQL Server CE nuget 包，不再需要应用程序清单。您将获得两组二进制文件：x86 和 amd64。只需将它们复制到 x86 和/或 amd64 子目录下的目标文件夹即可。

```
|--Your App Dir
   |--x86 (x86 sql ce binaries)
   |--amd64 (amd64 sql ce binaries) 
```

你可以走了。看起来 System.Data.SqlCe.dll 可以自动查找并加载本机二进制文件。如果您的应用程序仅针对一个平台，您也可以将它们部署在应用程序目录中。**

# entity-framework - 存在实体时“违反多重性约束”

> ID：10739846
> 
> 赞同：2
> 
> 时间：2012-05-24T14:48:03.980
> 
> 标签：entity-framework

给定两个实体 ProcessTemplateOperation 和 ProcessTemplateMetaInformation 的关系为 1 到 0..1

当我添加一个具有 ProcessTemplateMetaInformation 的 ProcessTemplateOperation 时，我在 Context.ApplyChanges 处收到以下错误（在 EF 中它位于 AddHelper.AddAllEntities: context.AddObject 中）

违反了多重性约束。关系“...FK_ProcessTemplateOperation_MetaInformation”的角色“ProcessTemplateOperation”具有多重性 1 或 0..1。

留在 EntityFramework 代码中的调试器说 Operation 有一个 Metainformation，所以它不会在途中丢失。

RelationShip 的定义是

```
 <AssociationSet Name="FK_ProcessTemplateOperation_MetaInformation" Association="FireStartDBModel.Store.FK_ProcessTemplateOperation_MetaInformation">
        <End Role="ProcessTemplateOperation" EntitySet="ProcessTemplateOperation" />
        <End Role="ProcessTemplateMetaInformation" EntitySet="ProcessTemplateMetaInformation" />
      </AssociationSet>

    <Association Name="FK_ProcessTemplateOperation_MetaInformation">
      <End Role="ProcessTemplateOperation" Type="FireStartDBModel.Store.ProcessTemplateOperation" Multiplicity="1">
        <OnDelete Action="Cascade" />
      </End>
      <End Role="ProcessTemplateMetaInformation" Type="FireStartDBModel.Store.ProcessTemplateMetaInformation" Multiplicity="0..1" />
      <ReferentialConstraint>
        <Principal Role="ProcessTemplateOperation">
          <PropertyRef Name="Id" />
        </Principal>
        <Dependent Role="ProcessTemplateMetaInformation">
          <PropertyRef Name="Id" />
        </Dependent>
      </ReferentialConstraint>
    </Association>

      <AssociationSet Name="FK_ProcessTemplateOperation_MetaInformation" Association="FireStartDBModel.FK_ProcessTemplateOperation_MetaInformation">
        <End Role="ProcessTemplateOperation" EntitySet="BaseOperation" />
        <End Role="ProcessTemplateMetaInformation" EntitySet="BaseMetaInformation" />
      </AssociationSet> 
```

ProcessTemplateOperation 有一个 NavigationProperty，但 ProcessTemplateMetaInformation 上没有 Navigation 属性。

我们正在使用 TPC 和 ProcessTemplateOperation 有一个基类 BaseOperation 和一个派生类 ProcessOperation ...

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T10:01:16.770

我们解决了这个问题。

我们有一些导航属性在一个圆圈中运行。

我们删除了它们，现在一切正常！

# php - 从 mysql 将字符串加载为 xml

> ID：10739848
> 
> 赞同：1
> 
> 时间：2012-05-24T14:48:14.977
> 
> 标签：php, mysql, xml, string, select

我试图从 mysql 数据库中获取字符串并像 xml 对象、导航等一样处理它。

我有一个带有“longtext”字段的 sql 表，它将我的 xml 文件存储为一个简单的字符串。我在数据库上进行选择，我得到了字符串，但只有信息，而不是标签等。

有什么方法可以从 mysql 数据库（xml 格式）中选择一个字符串，将其转换为 php 并将其作为 xml 文件使用？

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T14:54:16.697

从数据库中检索字符串，然后将其加载到[SimpleXML](http://www.php.net/manual/en/simplexmlelement.construct.php)中：

```
$xmlObj = new SimpleXMLElement($xmlstr); 
```

从那里您可以使用 SimpleXML 库操作 xml 对象。

如果您正在检索字符串并将其回显到浏览器，并且您只看到标签的内容（没有`<>`），那是因为浏览器将它们解释为 HTML 标签。如果您使用浏览器视图-> 源代码，您将看到纯 XML 作为字符串。

# java - 如何将 JMenuItem 链接到 JButton

> ID：10739849
> 
> 赞同：2
> 
> 时间：2012-05-24T14:48:17.617
> 
> 标签：java, swing, jbutton, exit, jmenuitem

假设我有一个带有“Exit”文本的 JMenuItem，还有一个带有“Exit”文本的 JButton，JButton 将使用的命令是 System.exit(0)，当然使用 Action Listener，我知道，我可以在单击 JMenuItem 时放置相同的代码，但没有办法，当我单击 JMenuItem 时，单击 JButton，然后执行以下命令（JButton 命令）？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-24T14:53:41.797

您可以做的是创建一个`Action`对象，并将其用于您的`JButton`和您的`JMenuItem`.

```
Action exit = new AbstractAction() {
        private static final long serialVersionUID = -2581717261367873054L;

        @Override
        public void actionPerformed(ActionEvent e) {
            System.exit(0);
        }
    };
exit.putValue(Action.NAME, "Exit");
exit.putValue(Action.MNEMONIC_KEY, KeyEvent.VK_X);

JButton exitButton = new JButton(exit);
JMenuItem exitItem = new JMenuItem(exit); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-24T14:53:30.763

一个很好的方法是`ActionListener`为两个组件设置相同的值。像这样：

```
JButton button = new JButton ("Exit");
JMenuItem item = new JMenuItem ("Exit");

ActionListener exitaction = new ActionListener ()
{
    public void actionPerformed (ActionEvent e)
    {
        System.exit (0);
    }
};

button.addActionListener (exitaction);
item.addActionListener (exitaction); 
```

但是，我建议不要使用`System.exit (0)`. 关闭程序的更好方法（我假设基本上是 a `JFrame`）是通过设置

`frame.setDefaultCloseOperation (JFrame.DISPOSE_ON_CLOSE)`

（`frame`程序的窗口在哪里）

并调用`frame.dispose ()`.`ActionListener`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T14:56:06.783

您可以尝试将按钮保存为类字段

```
private JButton button; 
```

并在菜单项的单击事件处理程序中插入代码

```
button.doClick(); 
```

但[SoboLAN](https://stackoverflow.com/a/10739951/611595)的解决方案更优雅。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-24T14:54:20.820

我认为最好的方法是在 JMenuItem 和 JButton 的事件侦听器中注册相同的 ActionListener 实例，这就像使用旧的 Command 设计模式一样。

我不建议尝试欺骗事件“引擎”，例如让 JMenuItem 触发与按下 JButton 相关的事件，因为这不是正在发生的事情，但您似乎想要将这两个动作重用于 2 个不同的事件。

# macos - OSX - 从命令行运行时安装程序失败

> ID：10739850
> 
> 赞同：0
> 
> 时间：2012-05-24T14:48:17.640
> 
> 标签：macos, installation

我正在尝试从命令行在 Mac 上安装我们的产品：

```
$ installer -package /Volumes/setup.pkg/setup.pkg -target /Volumes/MacOS -verbose
installer: Package name is Foo
installer: Upgrading at base path /
installer: Preparing for installation….....
installer: Preparing the disk….....
installer: Preparing Foo….....
installer: Waiting for other installations to complete….....
installer: Configuring the installation….....
installer:  
installer: Writing files….....
#
installer: Writing files….....
#
installer: Writing files….....
#
installer: Moving items into place….....
##
installer: The upgrade failed (The Installer encountered an error that caused the installation to fail. Contact the software manufacturer for assistance.) 
```

从 GUI 运行时一切正常。`sudo`没有帮助。我该如何调试？至少我需要一个信息更丰富的日志。将非常感激。

**自原始发布以来的附加信息：**当从 GUI 运行时，应用程序安装到运行它的用户的 ${HOME}/Library 中（如预期的那样）。从命令行运行时，它会尝试将其安装到 /Library 中（甚至复制那里的一些文件，但不是所有文件）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T17:33:06.130

在 GUI 中，您没有明确指定目标，因此所有内容都放在包想要放置的位置。但是在命令行上，您明确指定`-target /Volumes/MacOS`，它覆盖了包指定的内容，因此它试图将文件放入`/Library`其中，并且可能是其他地方，其中一些您无权访问。

显然`-target CurrentUserHomeDirectory`解决了问题。

要获得更多详细信息，您需要提取包（最简单的方法是`xar -xf setup.pkg`在一个空目录中）并查看文件 Distribution、*/PackageInfo 和可能的 */Bom，以查看安装程序具体指定的内容. 但如果你只是想让它工作，你已经知道如何做到这一点。

# php - PHP函数将值插入错误的位置

> ID：10739851
> 
> 赞同：-1
> 
> 时间：2012-05-24T14:48:18.387
> 
> 标签：php

下面的代码获取目录中所有 .csv 文件的列表。我创建了函数**csvcolumnsum**来从每个文件中提取一些信息（第 3 列中所有值的总和）并将其注入每个列表项中。

html 输出应如下所示：

```
<li>Filename (sum)</li> 
```

但结果是这样的：

```
sum<li>Filename ()</li> 
```

谁能指出为什么会这样？这是相关的代码。

```
require("csvcolumnsum.php");

echo "<ul class=\"users\">";
$handle=opendir("data");
while (($file = readdir($handle))!==false) {
    $file = preg_replace("/\\.[^.\\s]{3}$/","",$file);
    if (preg_match('/[^\.]/i', $file)) {
        $value = csvcolumnsum("data/".$file.".csv",3);
        echo "<li><a href=\"?form_name=$file\">$file(";
        echo $value;
        echo ")</a></li>";
    }
}
closedir($handle);
echo "</ul>"; 
```

**csvcolumnsum.php**

```
function csvcolumnsum($filename,$col) {
    $handle2 = fopen($filename, 'r');
    $data = fgetcsv($handle2);

    foreach ($data as $headercolumn) {}
    while ($data = fgetcsv($handle2)) {
        $sum += $data[$col];
    }

    echo "<span>$sum</span>";

    fclose($handle2);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T14:50:14.293

不是这样的`echo`。如果您希望您的函数将值传达回调用函数，则您的函数需要`return`该值，而不是`echo`它：

```
return "<span>$sum</span>"; 
```

Echo 直接写入标准输出，这意味着这一行：

```
$value = csvcolumnsum("data/".$file.".csv",3); 
```

在这些行之前打印：

```
echo "<li><a href=\"?form_name=$file\">$file(";
echo $value;
echo ")</a></li>"; 
```

返回会在当前函数中暂停执行，这意味着您`close`需要在您的`return`:

```
function csvcolumnsum($filename,$col) {
    $handle2 = fopen($filename, 'r');

    # ...

    fclose($handle2);

    return "<span>$sum</span>";
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T14:51:19.773

你回应你必须归还的总和，

```
function csvcolumnsum($filename,$col) {
    $handle2 = fopen($filename, 'r');
    $data = fgetcsv($handle2);

    foreach ($data as $headercolumn) {}
    while ($data = fgetcsv($handle2)) {
        $sum += $data[$col];
    }

    return "<span>$sum</span>";

    fclose($handle2);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-24T14:50:15.227

您不在`echo`函数`return`中`csvcolumnsum`。

# frontend - 为什么移动设备访问网页比 PC 慢？

> ID：10739854
> 
> 赞同：-1
> 
> 时间：2012-05-24T14:48:22.690
> 
> 标签：frontend, iphone-web-app

我有一个关于 iphone 和 PC 的问题，连接相同的 WiFi，打开相同的网页，PC 不到 1s 但 iphone 需要 3-5s。最近我开发了一个webapp，鉴于这种情况如何优化webapp。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T14:51:06.433

```
Slower network access (small bandwidth + hight latency).

+ Slower CPU

_____________

= slower web rendering 
```

解决方案？

1）最小化连接（页面的对象数）。

2）最小化总尺寸。

3）最小化客户端计算（除了复杂的网络应用程序之外很少需要）。

延迟问题很重要。考虑使用精灵重新组合图像。当然，当小图像足够时，不要使用大图像。

随着移动设备越来越多样化，最好不要试图专注于检测和特定优化，而是应用一般的网站优化（这里谷歌会是你的朋友）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T14:51:30.113

首先，可能是因为 iPhone 和 PC 的性能不同。

即使是同一个网页，渲染马达也不一样。

使用专注于移动设备的 CSS 优化您的网页是一个好的开始：

```
<link rel="stylesheet" href="assets/css/mobile.css" type="text/css" media="handheld" /> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T14:53:02.003

影响性能的因素可能有很多：

cpu 处理速度/功率：您的 PC 可能有更好的 cpu。这意味着它可以更快地执行更多指令。

Web 浏览器：特定的 Web 浏览器在呈现页面时可能会更慢/更快。浏览器可能使用不同的 javascript 引擎，这也会影响性能。

内存：两个系统之间的内存数量和速度会影响性能。

等等……

# javascript - 单选按钮键盘陷阱

> ID：10739863
> 
> 赞同：1
> 
> 时间：2012-05-24T14:48:58.683
> 
> 标签：javascript, html, css, accessibility

我正在创建一个多项选择题练习，并且遇到了键盘可访问性问题。基本上，用户无法通过键盘循环浏览单选按钮列表。当“焦点”光标位于单选按钮上并且用户按下箭头键移动到下一个单选按钮时，会发生键盘陷阱。不是简单地聚焦它，而是选择单选按钮，从而显示答案。使用键盘浏览单选按钮时，如何停止选择单选按钮？

**HTML**标记：

```
<div id="contentWrapper">
<p class="instructions">Click on the correct answer.</p>

<ol start="49">
    <!-- Start of multiple choice question -->
    <li class="multipleChoice gradedQuestion">
        <p class="question">If you receive a request for an extension from a trader, you should:</p>
        <input type="hidden" name="questionNumber" value="49">
        <ul>
            <li>
                <div class="answerOption"><label for="question49A">Refer to IP 13; if the original requirements are still being met, approve the extension.</label></div>
                <div class="inputAndIdContainer"><input type="radio" name="question49" value="0" id="question49A"> A.</div>
            </li>
            <li>
                <div class="answerOption"><label for="question49B">Refer to IP 20; if the original requirements are still being met, approve the extension.</label></div>

        <div class="inputAndIdContainer"><input type="radio" name="question49" value="0" id="question49B"> B.</div>
        </li>
        <li>
            <div class="answerOption"><label for="question49C">Refer to FW1; if the original requirements are still being met, approve the extension.</label></div>
            <div class="inputAndIdContainer"><input type="radio" name="question49" value="1" id="question49C"> C.</div>
        </li>
    </ul>
    <div class="feedback">
        <div class="answeredCorrectly">Correct</div>
        <div class="answeredIncorrectly">Incorrect</div>
        <div class="answer">
            <strong>Answer:</strong> C - Refer to FW1.
        </div>
    </div>
</li>
<!-- End of multiple choice question --> 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-24T15:29:07.970

简短的回答是你不能，这不是键盘陷阱。这就是收音机的本质。

如果它们被组合在一起（名称属性），您可以进入它；按空格键选择第一个项目，使用箭头键选择下一个项目。你应该写你的JS来观察焦点进入组然后离开。离开后，显示`<div id="feedback">`或制作一个按钮来显示它。

**编辑**关于您的另一篇文章，您可能需要添加一个类似于 .click() 的 .focus() 函数。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-24T15:27:45.490

这就是他们应该工作的方式，看看[这个](http://www.cs.tut.fi/~jkorpela/forms/kbd.html)文件！

基本上是这样的：

*在 IE 上，当通过 Tab 键到达单选按钮组时，最初选择的按钮将被聚焦，虚线矩形表示这一点。您可以使用箭头键在组内的按钮之间移动；“向下”和“向右”箭头在组内都向前移动，而“向上”和“向左”箭头都向后移动。并且在移动到一个按钮时，该按钮被选中（并且被选中的组中的按钮被取消选中）。*

*在 Netscape 上，情况有所不同。当通过 Tab 键到达一组单选按钮时，第一个按钮将获得焦点。您可以通过选项卡在组内向前移动。以这种方式移动到按钮不会更改设置。使用空格键或 Enter 键检查按钮。*

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-04-14T18:39:13.110

我通过在点击后模糊输入来解决这个问题。

至少通过这种方式，如果您使用制表符/空格/箭头键导航，它不会与用户混淆。如果他们点击它，他们不太可能使用箭头键来选择下一个选项。

查询：

```
$('.quiz input:radio').click(function(){ $(this).blur()}) 
```

# ruby-on-rails - Rails 嵌套表单多层次

> ID：10739865
> 
> 赞同：0
> 
> 时间：2012-05-24T14:48:59.283
> 
> 标签：ruby-on-rails, nested-forms

这些是模型：

```
class Question < ActiveRecord::Base
  attr_accessible :title, :description, :inquiries_attributes

  has_many :replies

  has_many :groups, :through => :question_groups
  has_many :question_groups

  has_many :inquiries
  accepts_nested_attributes_for :inquiries, :allow_destroy=>true,
                            :reject_if=>:all_blank

  belongs_to :user
  belongs_to :last_user, :class_name => "User", :foreign_key => "last_user_id"

  acts_as_by_user

  default_scope order("created_at DESC")

  acts_as_publicable

  checkboxes_for :groups

end

class Inquiry < ActiveRecord::Base

  attr_accessible :title, :question_id, :inquiry_type_id, :inquiry_options_attributes

  belongs_to :question
  belongs_to :inquiry_type
  has_many :inquiry_options
  accepts_nested_attributes_for :inquiry_options, :allow_destroy=>true,
                            :reject_if=>:all_blank
  has_many :inquiry_replies
end

class InquiryOption < ActiveRecord::Base

  attr_accessible :content, :inquiry_id

  belongs_to :inquiry

end 
```

这是视图：

```
<%= nested_form_for [:admin, @question] do |f| %>
  <%= f.error_messages %>
  <p>
    <%= f.label :title %><br />
    <%= f.text_field :title %>
  </p>
  <p>
    <%= f.label :description %><br />
    <%= f.text_area :description %>
  </p>
  <%= f.fields_for :inquiries do |inquiry_form| %>
    <p>
      <%= inquiry_form.label :title %><br />
      <%= inquiry_form.text_area :title, :size=>"40x5" %><br />
      <%= inquiry_form.label :inquiry_type %><br />
      <%= collection_select(inquiry_form, :inquiry_type_id, InquiryType.all, :id, :name, options ={:prompt => "Seleziona una tipologia"}) %><br />

      <%= inquiry_form.fields_for :inquiry_options do |inquiry_option_form| %>
      <p>
        <%= inquiry_option_form.label :content %><br />
         <%= inquiry_option_form.text_area :content, :size=>"40x5" %><br />
        <%= inquiry_option_form.link_to_remove "Rimuovi risposta" %>
      </p>
    <% end %>
    <p><%= inquiry_form.link_to_add "Aggiungi risposta", :inquiry_options %></p>

     <%= inquiry_form.link_to_remove "Rimuovi domanda" %>
    </p>
  <% end %>
  <p><%= f.link_to_add "Aggiungi domanda", :inquiries %></p>
  <p>
    <%= f.checkboxes_for :groups %>
  </p>
 <p><%= f.submit %></p>
<% end %> 
```

在第二层，如果我想添加多个inquiry_option，只保存第一个。我看到当我添加多个查询选项时，第二个查询选项与第一个查询选项具有相同的名称属性，因此在我提交表单时只保存第一个。我该如何解决？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T15:09:48.590

如果您想要多个值，则需要在控制器中“构建”它们。使用您的示例，您应该将以下内容添加到`new`questions_controller.rb 中的方法中

```
2.times do
  @question.inquiries.build
end 
```

这将为您建立 2 个查询

# c# - 如何将子控件停靠在父控件的右下角？

> ID：10739866
> 
> 赞同：3
> 
> 时间：2012-05-24T14:49:00.483
> 
> 标签：c#, winforms, devexpress, docking

与父控件相比，如何将子控件停靠在右下位置？

我可以看到dockstyle枚举具有None，Top，Bottom，Right，Left和Fill的值......

如何设置右下角？？？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-24T14:56:29.007

也许您不想将其停靠在右下角。停靠会改变控件的位置，但也会改变大小以适应表单的高度或宽度。

如果你想让它保持在右边和下边，锚定它。删除左右锚点并添加底部和右侧锚点。您的控制将保持在那里！

** 编辑 ** 根据 OP 评论，它必须在底部并占据所有宽度并具有固定高度。那么你必须采取以下步骤：

为了保持整洁，您至少需要 2 个控件：

*   它位于底部的那个：将其停靠在底部并设置其高度。
*   另一种使用对接样式的填充。这使得它占用了底部控件未占用的所有空间。

如果您在设置时遇到问题，请使用布局窗口（我希望这是英文名称。我的 VS 已本地化）移动它们直到它工作。有时停靠它有点讨厌，让它按照您喜欢的方式工作的唯一方法是使用此布局窗口更改控件的顺序和嵌套。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-24T14:56:39.163

使用锚样式：

```
yourComponent.Anchor = ((System.Windows.Forms.AnchorStyles)
                       ((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Right))); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T15:24:26.330

尝试将 Dock 设置为底部，根据您的控件，您可能必须关闭自动调整大小，例如标签

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-24T14:59:38.210

来自[MSDN](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.dock.aspx)`Control.Dock`文档：

> 控件可以停靠到其父容器的一个边缘，也可以停靠到所有边缘并填充父容器。

所以你不能停靠在两个边缘 - 我实际上不确定你的意思。

如果你想在屏幕的右下角保留一个控件，你可能会想到`Anchor` [属性](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.anchor.aspx)，它可以让你设置多个边缘来锚定控件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-12-26T22:11:51.960

要在右下角“停靠”，您需要

1.  将 ControlA 停靠在父控件 ControlB的*右侧*
2.  将ControlA的*顶部填充设置为*`ControlA.Padding = new Padding(0, ControlB.Height - nTopPadding, 0, 0);`

`nTopPadding`可以是你需要的任何东西。对于文本框、标签等，`ControlA.Font.Height`效果最好。

这也适用于`AutoSize = true`. 您只需要根据需要更新填充。

# sql - 这两个 sql 命令有什么区别？

> ID：10739867
> 
> 赞同：1
> 
> 时间：2012-05-24T14:49:01.803
> 
> 标签：sql

```
select * from StudySQL.dbo.id_name n
inner join StudySQL.dbo.id_sex s
on n.id=s.id
and s.sex='f'

select * from StudySQL.dbo.id_name n
inner join StudySQL.dbo.id_sex s
on n.id=s.id
where s.sex='f' 
```

结果是一样的。那么它们之间有什么区别吗？

## 添加

我做了几次更有趣的尝试。

```
select * from StudySQL.dbo.id_name n

1 | baby
3 | alice

select * from StudySQL.dbo.id_class c

1 | math      
3 | physics   
3 | english   
4 | chinese 

select * from StudySQL.dbo.id_name n
left join StudySQL.dbo.id_class c
on n.name='alice'

name  id    id  class
baby    1   NULL    NULL
alice   3   1           math      
alice   3   3           physics   
alice   3   3           english   
alice   3   4           chinese   

select * from StudySQL.dbo.id_name n
left join StudySQL.dbo.id_class c
on n.name='baby'

name    id  id  class
baby    1   1           math      
baby    1   3           physics   
baby    1   3           english   
baby    1   4           chinese   
alice   3   NULL    NULL

select * from StudySQL.dbo.id_name n
left join StudySQL.dbo.id_class c
on n.name<>''

name    id  id  class
baby   1    1           math      
baby   1    3           physics   
baby   1    3           english   
baby   1    4           chinese   
alice  3    1           math      
alice  3    3           physics   
alice  3    3           english   
alice  3    4           chinese 
```

所以我认为可以合理地说，on 子句决定**了哪些行应该被连接**。而 where 子句决定**应该返回哪些行**。

如果这是真的，**我认为最好在 on 子句中编写详细的限制，以便需要连接的行更少。**因为连接是一项昂贵的操作。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-24T14:50:05.950

虽然这是一个没有区别，`INNER JOIN`但如果你使用一个结果会非常不同`OUTER JOIN`。与`LEFT OUTER JOIN`第二个查询一起使用将隐式变为`INNER JOIN`.

通过使用`AND`谓词来确定何时应将 s 中的行连接到 n。在内部连接中，这里的否定结果将阻止 n 和 s 边都被省略。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-24T14:59:54.253

ON 子句用于指定表之间的关系，WHERE 子句用于指定过滤条件。在这种情况下，结果/性能问题可能更像是一个概念问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-24T15:10:10.223

在这里可以找到有关此主题的一些有趣的讨论：

[INNER JOIN ON vs WHERE 子句](https://stackoverflow.com/questions/1018822/inner-join-on-vs-where-clause)

它们应始终返回相同的结果，但可能会由于删除过滤行的时间而导致查询计划和性能略有不同。此行为将取决于您使用的服务器。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-24T15:49:58.710

就像 Marc Romero 说的，ON 子句是指定表之间的关系，WHERE 子句是指定过滤条件。在此特定查询中，您将看到相同的结果，但在其他查询中，如果您不了解差异，您可能会得到意想不到的结果。考虑下面的查询（使用 LEFT JOINS 而不是 INNER）：

```
SELECT *
FROM StudySQL.dbo.id_name n
LEFT JOIN StudySQL.dbo.id_sex s ON n.id=s.id AND s.sex='f'

SELECT *
FROM StudySQL.dbo.id_name n
LEFT JOIN StudySQL.dbo.id_sex s on n.id=s.id
WHERE s.sex='f' 
```

第一个将返回来自 StudySQL.dbo.id_name 的信息以及来自 StudySQL.dbo.id_sex 表中与任何具有性别“f”的记录相关联的信息。第二个将返回所有名称，但只有性别为“f”的名称才会填充来自 StudySQL.dbo.id_sex 的信息。

# json - 升级到 ExtJs4.1：网格行不显示

> ID：10739879
> 
> 赞同：0
> 
> 时间：2012-05-24T14:49:37.327
> 
> 标签：json, extjs4, extjs4.1

我正在尝试从 4.0.7 升级到 Extjs4.1 我的应用程序窗口现在似乎很好，但所有网格和树中都没有显示数据！尽管数据是从服务器端返回的，即使我用于菜单的静态文件（如布局浏览器示例中）也不起作用

这是我的 menu.json

```
{ 
text: '.',
children: [{

                    text:'Dashboard - <font size=1>Overview</font>',
                    id:'dash',
                    iconCls:'dashIcon',
                    leaf:true
                 },{
                    text:'Services - <font size=1>Analyze</font>',
                    id:'multiserv',
                    iconCls:'multiservIcon',
                    leaf:true
                 },{
                    text:'Reports - <font size=1>Results</font>',
                    id:'report',
                    iconCls:'reportingIcon',
                    leaf:true
                 },{
                    text:'Options - <font size=1>Settings</font>',
                    id:'options',
                    iconCls:'optionsIcon',
                    leaf:true

                }]

} 
```

这是服务器返回的数据示例

```
{"id":1,"result":"[\r\n  {\r\n    \"Item1\": \"demo\",\r\n    \"Item2\": 5,\r\n        \"Item3\": 15,\r\n    \"Item4\": \"4308,0\",\r\n    \"Item5\": \"oct. 14, 2012\",\r\n    \"Item6\": \"demo\",\r\n    \"Item7\": \"sept. 14, 2011\"\r\n  }\r\n]"} 
```

标题：

```
Accept:
*/*

Accept-Charset:
ISO-8859-1,utf-8;q=0.7,*;q=0.3

Accept-Encoding:
gzip,deflate,sdch

Accept-Language:
fr-FR,fr;q=0.8,en-US;q=0.6,en;q=0.4

Cache-Control:
no-cache

Content-Length:
  47

Content-Type:
application/json; charset=UTF-8 
```

这是我的网格之一：

```
Ext.define("Ext.app.LastAdresses", {
  extend: "Ext.form.Panel",

columnWidth: 0.55,
title: 'Overview',
padding: ' 5 5 5 5',
animCollapse: true,
draggable: true,
resizable: true,
width: 750,
height: 380,
layout: 'column',
autoScroll: true,
fieldDefaults: {
    labelAlign: 'left',
    msgTarget: 'side'
},
items: [{
    columnWidth: 0.57,
    xtype: 'grid',
    store: LStore,
    height: 345,
    width:400,
    layout:'fit',
    frame: false,
    padding: '5 5 5 5',
    viewConfig: { emptyText: ' <div class="noData"> No Available Data for Now </div>' },
    columns: [
        {
            text: 'Date',
            width: 85,
            renderer: Ext.util.Format.dateRenderer('d-M-Y'), 
            sortable: true,
            dataIndex: 'DateEnd'
        }
        , {
            text: 'Adress',
            width: 140,
            sortable: true,
            renderer: 'htmlEncode',
            dataIndex: 'Current'
        },
        {
            text: '# ',
            width: 60,
            sortable: true,
            renderer: 'htmlEncode',
            dataIndex: 'nbr'
        }
      , {
          text: 'ScoRISK',
          width: 55,
          sortable: true,
          renderer: change,
          dataIndex: 'Score'
      }, {
          text: 'Type ',
          width: 150,
          sortable: true,
          renderer: 'htmlEncode',
          dataIndex: 'Category'
      }
    ],

    listeners: {

        afterrender: function () {
            this.view.refresh()

        },
        selectionchange: function (sm, selectedRecord) {
            if (selectedRecord.length) {
                var detailPanel3 = Ext.getCmp('detailPanel3');
                assetsTpl.overwrite(detailPanel3.body, selectedRecord[0].data);
            }
        }
    }

}, {
    columnWidth: 0.43,
    margin: '0 5 0 5',
    border: false,
    layout: 'anchor',
    width:200,height:400,
    items: [{ xtype: 'fieldset',
        title: 'Findings Detail',
        items: [{
            id: 'detailPanel3',
            flex: 1,
            height: 160,
            width: 400,
            layout: 'fit',
            border: false,
            bodyPadding: 7,
            bodyStyle: "background: #ffffff;",
            html: '<br>Please Select an Item to See Additional Details.'
        }]

    }]
}

  ]

}); 
```

让我知道你是否需要别的东西

需要注意的是，我检查了商店的长度

```
var recs=store.getRange(); 
alert(recs.length); 
```

它给出了 48

# css - CSS 文本换行应将浮动元素视为列

> ID：10739888
> 
> 赞同：2
> 
> 时间：2012-05-24T14:50:15.297
> 
> 标签：css, css-float

**这是生成的布局**，文本在标签“日期”下换行。 ![问题](../Images/e8f52fbc185249c52cbd676fcf712799.png)

**这是期望的结果：** ![想要的结果](../Images/1055cfb3c3ea91311d491e6f8ec13694.png)

这是html布局：

```
<div class="alternate">
    <span class="label">Dates:</span>
    <span id="lblDates">
        Created: <u>May 31, 2011</u>, Quote: <u>Sep 1, 2011</u>, Completed: <u>May 23, 2012</u>, Invoice: <u>May 1, 2011</u>, Finalized: <u>May 31, 2011</u>
    </span>
    <br style="clear:both;">
</div> 
```

相关的CSS：

```
 fieldset .label {
        text-align: right;
        float: left;
        width: 150px;
        clear: left;
        margin-right: 15px;
        color: black;
        font-weight: bold;
} 
```

如果我在标签上设置了预定义的高度，那么它可以工作，但是我不想在标签上设置预定义的高度，因为有时我只有一行内容，我该如何实现呢？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-24T14:59:31.160

这应该有帮助

```
#lblDates {
    padding-left: 165px;
    display: block;
} 
```

这是[工作示例](http://jsfiddle.net/fvMFW/4/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T14:52:50.377

放`margin-left: 165px`（165px = 150px + 15px，你在标签上设置的宽度 + 边距）然后`display:block`打开`#lblDates`

# jquery - 使用 jquery.load() 未加载 Highcharts

> ID：10739891
> 
> 赞同：0
> 
> 时间：2012-05-24T14:50:17.100
> 
> 标签：jquery, highcharts

情况如下：

文件 1：index.php

```
...
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js" type="text/javascript"></script>
...
<div class="mycontainer"></div>
<script>
    $(function() {
        $(".mycontainer").load("grafs.php");
    });
</script> 
```

文件 2：grafs.php

```
 ...
 <script src="/js/highcharts.js"></script>
 <script type="text/javascript">
    var chart1; // globally available
    $(document).ready(function() {
    chart1 = new Highcharts.Chart({
        chart: {
        renderTo: 'mychart01',
        type: 'bar'
     },
     title: {
        text: 'Fruit Consumption'
         },
     xAxis: {
        categories: ['Apples', 'Bananas', 'Oranges']
         },
     yAxis: {
        title: {
           text: 'Fruit eaten'
        }
     },
     series: [{
        name: 'Jane',
        data: [1, 0, 4]
     }, {
        name: 'John',
        data: [5, 7, 3]
     }]
    });
});
</script>
<div id="mychart01" style="min-width: 400px; height: 400px; margin: 0 auto"></div> 
```

这会使 DIV (mychart01) 完全为空（空白）。在控制台没有错误。如果我直接在文件 1 中运行文件 2 中的那段代码，图表将正确呈现。谁能指出我在这里做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T14:53:28.780

尝试：

```
$.ajax({url: "grafs.php", function(data) {
    $(".mycontainer").html(data);
  }); 
```

或者

使用`getScript`而不是`load`：

[http://api.jquery.com/jQuery.getScript/](http://api.jquery.com/jQuery.getScript/)

# image - 用图片标题替换标题

> ID：10739901
> 
> 赞同：0
> 
> 时间：2012-05-24T14:50:56.310
> 
> 标签：image, wordpress, caption

我需要一些帮助。我为一家新闻机构创建了一个自定义网站，他们使用 wordpress cms 将新闻插入数据库。在每一篇文章中，我都有一些图片标题的问题。当我在 wordpress 图片标题上写东西时，帖子中会出现这样的结果：

```
[caption id="attachment_101068" align="alignleft" width="214" caption="thi is the caption"]
HERE IS THE IMAGE
[/caption] 
```

同样在 wordpress 中有一个设置图像标题和 alt 的选项，我想知道是否可以在图像底部显示图像标题或图像 alt LIKE A CAPTION。

# eclipse - 在 eclipse-possible 插件错误上运行 grails 应用程序

> ID：10739903
> 
> 赞同：1
> 
> 时间：2012-05-24T14:50:59.650
> 
> 标签：eclipse, grails, plugins

我正在努力在本地系统上设置 grails，并正在学习以下教程： [http ://www.youtube.com/watch?v=PXHxo43hn34&feature=relmfu](http://www.youtube.com/watch?v=PXHxo43hn34&feature=relmfu)

但是，所有控制器和域类文件都可以正确编译，但是每当我尝试执行应用程序时都会收到下面列出的错误

我在安装插件时遇到了困难，因为无法访问组件，并安装了我可以访问的所有必要插件，但不确定这些是否是问题的根源。

```
| Loading Grails 2.0.4
| Configuring classpath.
| Environment set to development.....
| Packaging Grails application.....
| Compiling 1 source files.....
| Running Grails application
| Error 2012-05-24 10:24:21,801 [pool-7-thread-1] ERROR context.GrailsContextLoader  -     Error executing bootstraps: Error creating bean with name   'transactionManagerPostProcessor': Initialization of bean failed; nested exception is     org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'transactionManager': Cannot resolve reference to bean 'sessionFactory' while setting bean property 'sessionFactory'; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'sessionFactory': Invocation of init method failed; nested exception is org.codehaus.groovy.runtime.InvokerInvocationException: groovy.lang.MissingMethodException: No signature of method: org.example.pomodoro.Task.details() is applicable for argument types: (java.util.LinkedHashMap) values: [[blank:false]]
Possible solutions: getAll(), getDetials(), getTags(), getId(), equals(java.lang.Object), setDetials(java.lang.String)
Message: Error creating bean with name 'transactionManagerPostProcessor': Initialization of bean failed; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'transactionManager': Cannot resolve reference to bean 'sessionFactory' while setting bean property 'sessionFactory'; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'sessionFactory': Invocation of init method failed; nested exception is org.codehaus.groovy.runtime.InvokerInvocationException: groovy.lang.MissingMethodException: No signature of method: org.example.pomodoro.Task.details() is applicable for argument types: (java.util.LinkedHashMap) values: [[blank:false]]
Possible solutions: getAll(), getDetials(), getTags(), getId(), equals(java.lang.Object), setDetials(java.lang.String)
Line | Method
->>  334 | innerRun  in java.util.concurrent.FutureTask$Sync
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
|    166 | run       in java.util.concurrent.FutureTask
|   1110 | runWorker in java.util.concurrent.ThreadPoolExecutor
|    603 | run       in java.util.concurrent.ThreadPoolExecutor$Worker
^    722 | run . . . in java.lang.Thread
Caused by BeanCreationException: Error creating bean with name 'transactionManager': Cannot resolve reference to bean 'sessionFactory' while setting bean property 'sessionFactory'; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'sessionFactory': Invocation of init method failed; nested exception is org.codehaus.groovy.runtime.InvokerInvocationException: groovy.lang.MissingMethodException: No signature of method: org.example.pomodoro.Task.details() is applicable for argument types: (java.util.LinkedHashMap) values: [[blank:false]]
Possible solutions: getAll(), getDetials(), getTags(), getId(), equals(java.lang.Object), setDetials(java.lang.String)
->>  334 | innerRun  in java.util.concurrent.FutureTask$Sync
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
|    166 | run       in java.util.concurrent.FutureTask
|   1110 | runWorker in java.util.concurrent.ThreadPoolExecutor
|    603 | run       in java.util.concurrent.ThreadPoolExecutor$Worker
^    722 | run . . . in java.lang.Thread
Caused by BeanCreationException: Error creating bean with name 'sessionFactory': Invocation of init method failed; nested exception is org.codehaus.groovy.runtime.InvokerInvocationException: groovy.lang.MissingMethodException: No signature of method: org.example.pomodoro.Task.details() is applicable for argument types: (java.util.LinkedHashMap) values: [[blank:false]]
Possible solutions: getAll(), getDetials(), getTags(), getId(), equals(java.lang.Object), setDetials(java.lang.String)
->>  334 | innerRun  in java.util.concurrent.FutureTask$Sync
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
|    166 | run       in java.util.concurrent.FutureTask
|   1110 | runWorker in java.util.concurrent.ThreadPoolExecutor
|    603 | run       in java.util.concurrent.ThreadPoolExecutor$Worker
^    722 | run . . . in java.lang.Thread
Caused by InvokerInvocationException: groovy.lang.MissingMethodException: No signature of method: org.example.pomodoro.Task.details() is applicable for argument types: (java.util.LinkedHashMap) values: [[blank:false]]
Possible solutions: getAll(), getDetials(), getTags(), getId(), equals(java.lang.Object), setDetials(java.lang.String)
->>  334 | innerRun  in java.util.concurrent.FutureTask$Sync
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
|    166 | run       in java.util.concurrent.FutureTask
|   1110 | runWorker in java.util.concurrent.ThreadPoolExecutor
|    603 | run       in java.util.concurrent.ThreadPoolExecutor$Worker
^    722 | run . . . in java.lang.Thread
Caused by MissingMethodException: No signature of method: org.example.pomodoro.Task.details() is applicable for argument types: (java.util.LinkedHashMap) values: [[blank:false]]
Possible solutions: getAll(), getDetials(), getTags(), getId(), equals(java.lang.Object), setDetials(java.lang.String)
->>   16 | doCall    in org.example.pomodoro.Task$__clinit__closure1
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
|    334 | innerRun  in java.util.concurrent.FutureTask$Sync
|    166 | run . . . in java.util.concurrent.FutureTask
|   1110 | runWorker in java.util.concurrent.ThreadPoolExecutor
|    603 | run . . . in java.util.concurrent.ThreadPoolExecutor$Worker
^    722 | run       in java.lang.Thread 
```

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T19:07:38.427

原始错误是`MissingMethodException`该字段`org.example.pomodoro.Task`的输入。`details`我假设它与设置约束有关，因为它抱怨设置`[blank:false]`。此根错误可以在跟踪中第一个长错误行的末尾看到。

因为下一行建议的解决方案是`getDetials()`and `setDetials()`，所以您的域类中是否有关于属性`details`->的拼写错误`detials`？

# mysql - MySQL 与 varchars 和文字的等价比较——自动修剪不区分大小写

> ID：10739907
> 
> 赞同：1
> 
> 时间：2012-05-24T14:51:03.290
> 
> 标签：mysql, string, collation

我正在做一些查询调试，发现在将 varchar 字段与文字进行比较时，我得到了意想不到的（虽然显然是正确的）TRUE。具体如下：

*   有问题的行只是一个自动增量 int 主键和一个 varchar(255)
*   设置添加单行：`insert into comp_test(test_string) values('TestString');`
*   `where test_string='tESTsTRING'`子句为真
*   `where test_string='TestString '`子句为真（最后用空格填充）

因此，在构建我的问题时，我可以在一篇类似[的帖子](https://stackoverflow.com/questions/5629111/mysql-case-sensitive-string-comparison)中描述原因以及如何强制区分大小写（使用 BINARY 和 COLLATE 等）。BINARY 和 COLLATE 解决方案是否也会导致空白填充使子句为假？

我现在有了部分解决方案，但谁能解释为什么等价比较如此草率？在上述情况下，如果 test_string 中的值是 8 个字符的字符串，则大约有 64,000 个文字会导致比较结果为真。那是什么样的等价物？这似乎是错误的，几乎所有其他语言都不会允许除 1 对 1 等价外的任何东西。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T16:10:22.717

尽管 C 和 FORTRAN 等旧语言的行为，以及 Oracle 等旧 DMBS 系统的行为，MySQL 的内置字符串排序系统允许最终用户指定特定于语言的排序规则。（顺便说一下，Java 和 DotNet 等系统中的字符串处理。）

这是一个非常酷的功能。它使您可以按许多不同语言的适当字母排序（===整理）规则进行排序。

您可以发出此搜索子句以获得所需的匹配类型。

```
WHERE BINARY test_string = 'TestString ' 
```

或者

```
WHERE test_string = 'TestString ' COLLATE utf8_bin 
```

或者

```
WHERE test_string = 'TestString ' COLLATE utf8_swedish_ci 
```

如果您的数据恰好是瑞典语并以 UTF8 字符集存储。

见[http://dev.mysql.com/doc/refman/5.5/en/charset-collat​​e.html](http://dev.mysql.com/doc/refman/5.5/en/charset-collate.html)

但是你需要小心这个。如果您在 WHERE 子句中要求的排序规则与表中的排序规则不匹配，则您的 SQL 可能运行效率低下。

最好使用正确的字符集和排序规则声明您的列。如果你这样做，那么你的表索引将被设置为快速获取你需要的数据。如果您的数据确实是二进制数据（只有您知道），您可以使用

```
 COLLATE BIN 
```

修饰符。

MySQL 的这一部分值得你努力去弄清楚。

# magento - 在 Magento 中禁用商店视图以提高性能

> ID：10739912
> 
> 赞同：1
> 
> 时间：2012-05-24T14:51:12.800
> 
> 标签：magento, magmi

我需要改进索引时间，特别是“产品价格”。

我想知道我是否需要实际删除存储视图以提高索引性能，或者是否足以禁用它。我说的是多站点 Magento 安装中不同网站的商店视图。

额外的商店浏览量对数以万计产品的性能影响有多大，每种产品的每次商店浏览价格都不同（其他属性相同）？

谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-04T08:17:43.680

Magento 不检查商店视图是否被禁用。如果您不索引此数据，则必须删除存储视图，创建自己的索引器或重写 magento 的索引行为。

# c# - INSERT 语句不向表中插入数据

> ID：10739913
> 
> 赞同：0
> 
> 时间：2012-05-24T14:51:14.437
> 
> 标签：c#, sql-server

`INSERT`我的陈述有问题。我从 gridviev 获取数据，它工作正常，但我无法将它们插入表中

```
private void button3_Click(object sender, EventArgs e)
{
    int amorplanid = 0;
    int idn = 0;
    DateTime datum;
    double interest = 0;
    double principal = 0;
    double payment = 0;
    double newprincipal = 0;

    string nizz = "";
    string[] niz= new string[7];
    for (int x = 0; x < dataGridView1.Rows.Count-1; x++)
    {
        for (int j = 0; j < dataGridView1.Rows[x].Cells.Count; j++)
        {
            nizz += dataGridView1.Rows[x].Cells[j].Value.ToString()+"."; 
        }
        niz = nizz.Split('.');

        amorplanid = System.Convert.ToInt32(niz[0]);
        idn = System.Convert.ToInt32(niz[1]);
        // datum = System.Convert.ToDateTime(niz[2]);
        datum = DateTime.Now;
        interest = System.Convert.ToDouble(niz[3]);
        principal = System.Convert.ToDouble(niz[4]);
        payment = System.Convert.ToDouble(niz[5]);
        newprincipal = System.Convert.ToDouble(niz[6]);

        String insert = @"INSERT INTO AmortPlanCoupT(ID, AmortPlanID, CoupDate, Interest, Principal, Payxment, NewPrincipal) VALUES (" + idn + "," + amorplanid + "," + datum + "," + (float)interest + "," + (float)principal + "," + (float)payment + "," + (float)newprincipal + ")";
        SqlConnection myconn = new SqlConnection(conn);
        // String MyString = @"INSERT INTO Employee(ID, FirstName, LastName) VALUES(2, 'G', 'M')";
        try
        {
            myconn.Open();
            SqlCommand cmd = new SqlCommand(insert, myconn);
            cmd.ExecuteNonQuery();
            myconn.Close();
        }
        catch (Exception ex)
        {
            MessageBox.Show(ex.ToString());
        }
    }

    label14.Text = niz[0];
} 
```

我创建了一个 Windows 控制台应用程序来测试：

我有`test`两列的表`id (int) , leto (float)`；

```
SqlConnection MyConnection = new SqlConnection(@"Data Source=.\SQLEXPRESS;AttachDbFilename=|DataDirectory|\App_Data\Database1.mdf;Integrated Security=True;User Instance=True");

try
{
    MyConnection.Open();

    String MyString = @"INSERT INTO test(id, leto) VALUES(2, 2)";
    SqlCommand MyCmd = new SqlCommand(MyString, MyConnection);

    MyCmd.ExecuteScalar();
    MyConnection.Close();
}
catch (Exception e)
{
    Console.WriteLine(e.ToString());
} 
```

我一直在尝试不同的东西将数据写入表，但无法将它们放在那里。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-24T14:57:19.897

正如我之前在这个网站上所说的那样——整个*User Instance 和 AttachDbFileName=*方法是有缺陷的——充其量是！Visual Studio 将在`.mdf`文件周围进行复制，并且**很可能**，您的`INSERT`工作正常 - 但您最终只是查看了**错误的 .mdf 文件**！

如果您想坚持使用这种方法，请尝试在`myConnection.Close()`调用上设置断点 - 然后`.mdf`使用 SQL Server Mgmt Studio Express 检查文件 - 我几乎可以肯定您的数据在那里。

**我认为真正的解决**方案是

1.  安装 SQL Server Express（反正你已经完成了）

2.  安装 SQL Server Management Studio Express

3.  **在SSMS Express**中创建您的数据库，给它一个逻辑名称（例如`Database1`）

4.  使用它的逻辑**数据库名称**（在服务器上创建它时给出）连接到它——不要乱用物理数据库文件和用户实例。在这种情况下，您的连接字符串将类似于：

    ```
    Data Source=.\SQLEXPRESS;Database=Database1;Integrated Security=True 
    ```

    其他一切都和以前**完全**一样......

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-05-24T14:56:16.073

在继续之前，您应该重写代码以使用参数，而不是字符串连接。

# model-view-controller - 3层架构和mvc有什么区别？

> ID：10739914
> 
> 赞同：63
> 
> 时间：2012-05-24T14:51:16.717
> 
> 标签：model-view-controller, architecture, three-tier

3层架构和mvc有什么区别？

他们是一样的吗？

两者都有 3 层，即模型、视图和控制器

* * *

## 回答 #1

> 赞同：81
> 
> 时间：2012-05-24T14:58:14.217

## 与 MVC 架构的比较

> 乍一看，这三层似乎类似于模型-视图-控制器（MVC）的概念。但是，在拓扑上它们是不同的。**三层架构中的一个基本规则是客户端层从不直接与数据层通信。在三层模型中，所有通信都必须通过中间层**。从概念上讲，三层架构是**线性**的。然而，[model-view-controller] MVC 架构是**三角形**的：视图向控制器发送更新，控制器更新模型，视图直接从模型中更新。

资料来源：[http ://en.wikipedia.org/wiki/Multitier_architecture#Three-tier_architecture](http://en.wikipedia.org/wiki/Multitier_architecture#Three-tier_architecture)

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2012-05-24T15:06:17.153

MVC 是一种用于使 UI 代码更易于维护和测试的模式。当使用 MVC 模式时，可以对大部分 UI 代码进行单元测试。

这是一篇很好的文章，它更详细地描述了 MVC 模式：[http ://martinfowler.com/eaaDev/uiArchs.html](http://martinfowler.com/eaaDev/uiArchs.html)

3 层架构是出于完全不同的原因而使用的模式。它将整个应用程序分成有意义的“组”：UI、业务逻辑、数据存储。

所以 3 层应用程序是指应用程序中的所有代码。MVC 模式是在 UI 层中使用的模式。

这是一篇关于 3 层架构的好文章：http: [//dotnetslackers.com/articles/net/IntroductionTo3TierArchitecture.aspx](http://dotnetslackers.com/articles/net/IntroductionTo3TierArchitecture.aspx)

有关更多信息，您可以搜索互联网并找到关于这两个主题的大量文章。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2013-09-12T12:51:21.240

**在 MVC**中：MVC 架构是三角形的：视图向控制器发送更新，控制器更新模型，视图直接从模型中更新

**在三层**中：三层架构是客户端层从不直接与数据层通信在三层模型中，所有通信都必须通过中间层

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2018-02-15T11:54:21.193

它们在某种程度上相似，例如：

*   3 层将整个应用分为：UI、逻辑和数据
*   MVC将UI部分分为：视图（UI的UI种类）、模型（数据）和控制器（逻辑）

但不同之处在于层级之间的通信方式：

*   3 层：任何东西都经过逻辑层（a->b、b->c 和 c->b、b->a）
*   MVC：它们以三角形方式 2 对 2 进行通信。(a->b, b->c, c->a)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-05-24T15:06:16.200

[http://en.wikipedia.org/wiki/Multitier_architecture](http://en.wikipedia.org/wiki/Multitier_architecture) 简而言之，在 3 层架构中，表示层从不直接与数据层通信。在 MVC 中，模型、视图和控制器之间的关系是三角形的。三个中的两个可以互相交流

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2016-11-19T04:55:16.670

在三层解决方案中，UI 与业务层分离，以确保关注外观和感觉的 UI 设计师不会与留给编程专业人士的繁重编程相混淆。

当大量人员参与生产大型应用程序时，这种架构*（三层）是必不可少的。*

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2020-06-01T11:16:36.083

MVC 架构风格是非分层的（三角形）：

*   View 子系统向 Controller 子系统发送更新
*   控制器子系统更新模型子系统
*   视图子系统直接从模型子系统更新

3 层架构风格是分层的（线性）：

*   表示层从不直接与数据层通信（不透明架构）

*   所有通信都必须经过中间件层

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-11-17T21:48:45.530

两者的主要区别在于：

三层架构是客户端层从不直接与数据层通信 在三层模型中，所有通信都必须通过中间层

MVC 架构是三角形的：视图向控制器发送更新，控制器更新模型，视图直接从模型中更新

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2018-01-12T06:42:29.563

两者的主要区别在于：在这种情况下，“层”也可以称为“层”。所涉及的三层或层包括： 以 HTML/JS/CSS 的形式向浏览器发送内容的表示层。这可能会利用 React、Angular、Ember、Aurora 等框架。一个使用应用程序服务器并处理应用程序业务逻辑的应用程序层。这可能是用 C#、Java、C++、Python、Ruby 等编写的。数据层是一个数据库管理系统，提供对应用程序数据的访问。这可能是 MSSQL、MySQL、Oracle 或 PostgreSQL、Mongo 等。

MVC 架构是三角形的：视图向控制器发送更新，控制器更新模型，视图直接从模型中更新

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2018-09-27T10:16:13.867

首先tier是用于物理部署的，你的意思可能是layers，而MVC是表示层的框架，仅此而已

# php - 从两个mysql表中选择所有数据

> ID：10739915
> 
> 赞同：0
> 
> 时间：2012-05-24T14:51:17.133
> 
> 标签：php, mysql, html-table

我用这个代码来连接我数据库中的两个表。尝试使用 while 循环回显它时没有显示任何错误消息，但也没有显示任何内容。任何人都可以帮助我吗？

```
$sql = "SELECT * FROM usr_details, paymnt_details WHERE usr_details.Trnsnubr = paymnt_details.Trnsnubr";

$sql = 
"SELECT *
FROM usr_details 
JOIN paymnt_details ON usr_details.Trnsnubr = paymnt_details.Trnsnubr"; 
```

这是我用于回显的 html 和 PHP 代码：

```
$rs_result = mysql_query ($sql) or die(mysql_error()); 
<table width="100%" height="109" border="1" cellpadding="2px" >
  <tr>
    <td colspan="5" class="mainheader">Registerd Persons</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td colspan="16"></td>
  </tr>
 <tr>
    <td class="tableheader" width="68">Payment</td>
    <td class="tableheader" width="64">Amount</td>
    <td class="tableheader" width="58">Date</td>
    <td class="tableheader" width="74">Trnsnubr</td>
    <td class="tableheader" width="97"> Paymenttyp </td>
    <td class="tableheader" width="59">Room Type</td>
    <td class="tableheader" width="96"> Packgname </td>
    <td class="tableheader" width="142">Full name</td>
    <td class="tableheader" width="1"> Email </td>
    <td class="tableheader" width="1">Mobile </td>
    <td class="tableheader" width="1">Address</td>
    <td class="tableheader" width="1">Country</td>
    <td class="tableheader" width="40">Mem_num</td>
    <td class="tableheader" width="40">Chptr</td>
    <td class="tableheader" width="40">Ral</td>
    <td class="tableheader" width="40">ex-mem-1-name</td>
    <td class="tableheader" width="40">ex-mem-2-name</td>
    <td class="tableheader" width="40">Faly-mem-1-name</td>
    <td class="tableheader" width="40">Faly-mem-2-name</td>
    </tr>
<?php 
while ($row = mysql_fetch_assoc($rs_result)) { 
$amount=$row["amount"];
$successness=$row["successness"];
$Timestamp=$row["Timestamp"];
$fname=$row["fname"];
$lname=$row["lname"];
$memnumbr=$row["memnumbr"];
$chptrpostion=$row["chptrpostion"];
$ralpositin=$row["ralpositin"];
$adrs1=$row["adrs1"];
$adrs2=$row["adrs2"];
$city=$row["city"];
$cntry=$row["cntry"];
$MTelNo=$row["MTelNo"];
$email=$row["email"];
$Trnsnubr=$row["Trnsnubr"];
$packgname=$row["packgname"];
$rtype=$row["rtype"];
$paymenttyp=$row["paymenttyp"];
$exmem1name=$row["exmem1name"];
$exmem2name=$row["exmem2name"];
$familymem1name=$row["familymem1name"];
$familymem2name=$row["familymem2name"];

        ?> 
<tr>
<td>  dfgdfgfdgdfgdg<?php echo $successness;?></td>
<td> <?php echo $amount;?></td>
<td> <?php echo $Timestamp;?></td>
<td> <?php echo $Trnsnubr;?></td>
<td> <?php echo $paymenttyp;?></td>
<td> <?php echo $rtype;?></td>
<td> <?php echo $packgname;?></td>
<td> <?php echo $fname." ".$lname;?></td>
<td> <?php echo $email;?></td>
<td> <?php echo $MTelNo;?></td>
<td> <?php echo $adrs1." ".$adrs2." ".$city;?></td>
<td> <?php echo $cntry;?></td>
<td> <?php echo $memnumbr;?></td>
<td> <?php echo $chptrpostion;?></td>
<td> <?php echo $ralpositin;?></td>
<td> <?php echo $exmem1name;?></td>
<td> <?php echo $exmem2name;?></td>
<td> <?php echo $familymem1name;?></td>
<td> <?php echo $familymem2name;?></td>
</tr>
<?php 
}; 
?> 
</table> 
```

这是我的整个编码文件：

```
<?php session_start();
$user_name = $_SESSION['username'];
$user_pass = $_SESSION['password'];
if ( $user_name == '' ) {
header('location:login.php');
exit();
 }
?>
<?php require_once('connection.php'); ?>
<?php require_once('function.php'); ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Untitled Document</title>
<link href="css/main.css" rel="stylesheet" type="text/css" media="all" />
<link href="css/users.css" rel="stylesheet" type="text/css" media="all" />
<link href="../dojo/dojo/resources/dojo.css" type="text/css" media="all" />
<link href="../dojo/dijit/themes/nihilo/nihilo.css" type="text/css" media="all" />
<script type="text/javascript" src="../dojo/dojo/dojo.js" ></script>
<script src="js/navigation.js" type="text/javascript"></script>
<script type="text/javascript">

</script>
<style type="text/css">
.tableheader {
    font-size: 18px;
    font-weight: bold;
    color: #96C;
}
.mainheader {
    font-size: 24px;
    font-weight: bolder;
    color: #09F;
}
</style></head>

<body class="nihilo">
<span class="tableheader"></span>
<div id="wrap">
<!-- Enable when Ajax is loading -->
<div id="loading_wrap"></div>
<div id="loading"><img src="images/loading.gif" width="32" height="32" alt="loading" /><br />Loading...</div>
<!-- End loading  -->
  <div id="head">
    <div id="subHead"></div>
  </div>
  <div id="main">
<?php 
if (isset($_GET["page"])) { $page  = $_GET["page"]; } else { $page=1; }; 
$limit= 5;
$start_from = ($page-1) * $limit; 
//$sql = "SELECT * FROM usr_details ORDER BY Trnsnubr ASC LIMIT $start_from, $limit "; 
//$sql = "SELECT * FROM usr_details, paymnt_details WHERE usr_details.Trnsnubr = paymnt_details.Trnsnubr";
/*$sql = 
"SELECT *
FROM usr_details 
JOIN paymnt_details ON usr_details.Trnsnubr = paymnt_details.Trnsnubr";*/
$sql = "SELECT usr_details.*, paymnt_details.amount, paymnt_details.successness
FROM usr_details 
JOIN paymnt_details ON usr_details.Trnsnubr = paymnt_details.Trnsnubr";
$rs_result = mysql_query ($sql) or die(mysql_error()); 
?> 
<table width="100%" height="109" border="1" cellpadding="2px" >
  <tr>
    <td colspan="5" class="mainheader">Registerd Persons</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td colspan="16"></td>
  </tr>
 <tr>
    <td class="tableheader" width="68">Payment</td>
    <td class="tableheader" width="64">Amount</td>
    <td class="tableheader" width="58">Date</td>
    <td class="tableheader" width="74">Trnsnubr</td>
    <td class="tableheader" width="97"> Paymenttyp </td>
    <td class="tableheader" width="59">Room Type</td>
    <td class="tableheader" width="96"> Packgname </td>
    <td class="tableheader" width="142">Full name</td>
    <td class="tableheader" width="1"> Email </td>
    <td class="tableheader" width="1">Mobile </td>
    <td class="tableheader" width="1">Address</td>
    <td class="tableheader" width="1">Country</td>
    <td class="tableheader" width="40">Mem_num</td>
    <td class="tableheader" width="40">Chptr</td>
    <td class="tableheader" width="40">Ral</td>
    <td class="tableheader" width="40">ex-mem-1-name</td>
    <td class="tableheader" width="40">ex-mem-2-name</td>
    <td class="tableheader" width="40">Faly-mem-1-name</td>
    <td class="tableheader" width="40">Faly-mem-2-name</td>
    </tr>
<?php 
while ($row = mysql_fetch_assoc($rs_result)) { 
$amount=$row["amount"];
$successness=$row["successness"];
$Timestamp=$row["Timestamp"];
$fname=$row["fname"];
$lname=$row["lname"];
$memnumbr=$row["memnumbr"];
$chptrpostion=$row["chptrpostion"];
$ralpositin=$row["ralpositin"];
$adrs1=$row["adrs1"];
$adrs2=$row["adrs2"];
$city=$row["city"];
$cntry=$row["cntry"];
$MTelNo=$row["MTelNo"];
$email=$row["email"];
$Trnsnubr=$row["Trnsnubr"];
$packgname=$row["packgname"];
$rtype=$row["rtype"];
$paymenttyp=$row["paymenttyp"];
$exmem1name=$row["exmem1name"];
$exmem2name=$row["exmem2name"];
$familymem1name=$row["familymem1name"];
$familymem2name=$row["familymem2name"];
?> 
<tr>
<td> <?php echo $successness;?></td>
<td> <?php echo $amount;?></td>
<td> <?php echo $Timestamp;?></td>
<td> <?php echo $Trnsnubr;?></td>
<td> <?php echo $paymenttyp;?></td>
<td> <?php echo $rtype;?></td>
<td> <?php echo $packgname;?></td>
<td> <?php echo $fname." ".$lname;?></td>
<td> <?php echo $email;?></td>
<td> <?php echo $MTelNo;?></td>
<td> <?php echo $adrs1." ".$adrs2." ".$city;?></td>
<td> <?php echo $cntry;?></td>
<td> <?php echo $memnumbr;?></td>
<td> <?php echo $chptrpostion;?></td>
<td> <?php echo $ralpositin;?></td>
<td> <?php echo $exmem1name;?></td>
<td> <?php echo $exmem2name;?></td>
<td> <?php echo $familymem1name;?></td>
<td> <?php echo $familymem2name;?></td>
</tr>
<?php 
}; 
?> 
</table>

</div>
 <div id="footer">
<?php include("footer.php"); ?>
 </div>
</div> 
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T15:08:49.910

如果这些表具有相同名称的列，则此请求将导致错误。发生这种情况是因为您尝试按列名获取所有值。尽量不要在困难的查询中使用 *。

尝试这样做：

```
SELECT usr_details.*, paymnt_details.field1, paymnt_details.field2
FROM usr_details 
JOIN paymnt_details ON usr_details.Trnsnubr = paymnt_details.Trnsnubr 
```

1

```
<?
$res = mysql_query("SELECT * FROM usr_details LIMIT 1");
var_dump(  mysql_fetch_assoc($res) );
$res = mysql_query("SELECT * FROM paymnt_details LIMIT 1");
var_dump(  mysql_fetch_assoc($res) );
$sql = "SELECT usr_details.* FROM usr_details LEFT JOIN paymnt_details ON usr_details.Trnsnubr = paymnt_details.Trnsnubr";
$res = mysql_query($sql);
var_dump($res);
while($row=mysql_fetch_assoc($res)) {
    var_dump($row);
}
var_dump( mysql_error() );
?> 
```

# c++ - 输出额外字符的字符数组

> ID：10739920
> 
> 赞同：2
> 
> 时间：2012-05-24T14:51:43.463
> 
> 标签：c++, arrays, char, compare

您好，这是我正在尝试实现 Morris-Pratt 算法的代码的一部分。当我比较我的变量时，如果发现它们不匹配，这是因为我的变量“Temp”之一正在将额外的字符添加到数组的末尾。这是我的代码...

```
 // Calculate the next talbe
        char test[searchLen];

        for(int i = 0; i < searchLen; i++)
        {   
            test[i] = fileContent[currPos+i];
        }

        cout << "SEARCHLEN: " << searchLen << endl;
        cout << "TEST: " << '\t' << '\t' << test << endl;
        cout << "SEARCH: " << '\t' << search << endl;
        cout << strcmp(test,search) << endl << endl;
        // Determine if a match is detected

        if(strcmp(test,search)==0)
        {
            cout << "----------------------> Match detected at: " << currPos << endl;
        }

        currPos ++;
    }

    return numberOfComparisons;
} 
```

输出看起来像这样......

```
SEARCHLEN: 8
TEST:       athsoutg5?h
SEARCH:     brilling
-1 
```

如您所见， 5?H 不应该在那里并且正在破坏我的代码。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-24T14:53:22.837

您需要添加一个空终止符。

```
 char test[searchLen + 1];
   test[searchLen] = '\0'; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T14:54:25.520

看起来你的字符串没有以 \0 结尾，也许你忘了复制它/把它放在那里？

# c# - 编辑列表问题 在c#中

> ID：10739921
> 
> 赞同：6
> 
> 时间：2012-05-24T14:51:47.060
> 
> 标签：c#, list

我将 double[] 类型的列表传递给类中的函数，使用 tempList 编辑函数中的值，然后返回编辑后的值。但是正在传递的 originalList 也正在被编辑，我不希望它们被编辑以匹配 tempList。

这是代码。

```
List<double[]> newList = new List<double[]();
newList = myClass.myFunction(value, originalList);

// myClass
...

// myFunction
public List<double[]> myFunction(int value, List<double[]> myList)
{
    List<double[]> tempList = new List<double[]>();
    for (int i = 0; i < myList).Count; i++)
    {
       tempList.Add(myList[i]);
    }

    // Do stuff to edit tempList

    return tempList;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-24T14:57:15.960

请记住，数组是*引用*类型。当您将数组添加到 时`tempList`，只会添加对该数组的引用，因此`myList`两者`tempList`都引用相同的`double[]`对象。

相反，您需要克隆数组：

```
for (int i = 0; i < myList.Count; i++)
{
   tempList.Add((double[])myList[i].Clone());
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T14:57:41.143

数组 ,`here double[]`是引用类型，所以行

```
tempList.Add(myList[i]); 
```

正在添加对原始数组的引用。然后，当您编辑 tempList 时，您正在编辑原始数组。制作这样的副本：

```
tempList.Add(myList[i].ToArray()); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-24T14:59:13.373

您将对数组的引用添加到新列表中，但不会复制每个数组的内容。您的副本应如下所示：

```
foreach (double[] item in myList)
{
    double[] copy = new double[item.Length];
    Array.Copy(item, copy);
    templist.Add(copy);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-24T14:57:23.030

您遇到的问题`double[]`是引用类型，而不是值类型，因此当您将它添加到您的 时`tempList`，您添加的是对原始对象的引用，而不是新对象。您实际上需要`double[]`在添加之前创建一个新对象，`tempList`这样您就不会处理原始对象。

假设您可以使用 LINQ，则不需要循环。您可以执行以下操作：

```
var tempList = myList.Select(x => x.ToArray()).ToList(); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-24T14:57:31.377

这是因为集合/引用类型是通过引用传递的。（实际上保持变量是按值传递的，但所有变量都指向同一个引用）。

有关详细说明，请阅读[此 SO Answer](https://stackoverflow.com/a/10687880/649524)

如果您希望我的 Function 中的修改不反映在原始集合中，则必须复制/克隆它，然后传递给`myFunction`.

例子

```
newList = myClass.myFunction(value, (List<double>)originalList.Clone()); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-24T14:57:47.813

```
tempList.Add(myList[i]); 
```

意味着您将对索引 i 上的 double[] 对象的引用添加到临时列表。因此，如果您编辑该对象的值，您将获得两个列表中的机会。

如果您想要一个不会相互影响的不同克隆列表，您将必须这样做：

```
List<double[]> tempList = new List<double[]>();
for (int i = 0; i < myList).Count; i++)
{
   double[] originalListItem = myList[i];

   // the most important step here!!! - clone the originalListItem to clonedListItem

   tempList.Add(clonedListItem);
}

// Do stuff to edit tempList

return tempList; 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-05-24T15:01:02.350

您正在将 double[] 引用复制到新列表，这是一个浅拷贝。您需要一个深拷贝并创建新的双精度数组来编辑临时数组而不更改原始数组。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-05-24T15:02:39.393

您在 tempList 中插入对数组的引用，而不是数组的副本。因此，如果您更改 tempList 中的值，您将更改原始数组。

此代码将更好地工作：

```
 for (int i = 0; i < myList.Count; i++)
    {
       var copy = new Double[myList[i].Length];
       Array.Copy(myList[i], copy, myList[i].Length);
       tempList.Add(copy);
    } 
```

# c++ - 野牛中的$$是什么？

> ID：10739923
> 
> 赞同：6
> 
> 时间：2012-05-24T14:52:05.640
> 
> 标签：c++, parsing, bison

[在rpcalc 的 2.1.2 语法规则](http://www.gnu.org/software/bison/manual/html_mono/bison.html#Rpcalc-Rules)部分的野牛手册中，写道：

> 在每个动作中，伪变量 $$ 代表规则将要构建的分组的语义值。为 $$ 赋值是大多数操作的主要工作

这是否意味着`$$`用于保存规则的结果？像：

```
exp exp '+'   { $$ = $1 + $2;      } 
```

`$$`after begin 分配给的典型用法是什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-24T14:59:11.803

是的，`$$`用于保存规则的结果。在被分配到之后，它通常会成为`$x`某个更高级别（或更低优先级）的规则。

考虑（例如）输入，如`2 * 3 + 4`. 假设您遵循正常的优先规则，您将执行类似以下操作：`{ $$ = $1 * $3; }`. 在这种情况下，这将用于该`2 * 3`部分，并且很明显，分配`6`给`$$`. 然后你就可以`{ $$ = $1 + $3; }`处理加法了。对于此操作，`$1`将获得您在乘法规则中`6`分配的值。`$$`

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-24T14:54:21.557

> 这是否意味着`$$`用于保存规则的结果？像：

是的。

> `$$`after begin 分配给的典型用法是什么？

通常，您将不再需要该值。Bison 在内部使用它来传播价值。在您的示例中，`$1`和`$2`是两个`exp`产生式的各自语义值，也就是说，它们的值是`exp`通过设置*其* `$$`变量在语义规则中的某处设置的。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2017-04-20T04:29:41.453

试试这个。创建一个 YACC 文件：

```
%token NUMBER
%%
exp:    exp '+' NUMBER  { $$ = $1 + $3; }
    |   exp '-' NUMBER  { $$ = $1 - $3; }
    |   NUMBER          { $$ = $1; }
    ; 
```

然后使用 Bison 或 YACC 处理它。我正在使用 Bison，但我认为 YACC 是相同的。然后只需找到“#line”指令。让我们找到“#line 3”指令；它和相关代码将如下所示：

```
#line 3 "DollarDollar.y"
    { (yyval) = (yyvsp[(1) - (3)]) + (yyvsp[(3) - (3)]); }
    break; 
```

然后我们可以很快看到“$$”扩展为“yyval”。其他的东西，比如“yyvsp”，并不那么明显，但至少“yyval”是。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-24T14:54:54.773

$$ 表示当前表达式求值的结果引用。也就是说，它的结果。因此，它赋值后没有特殊的用法。

再见 ！

# ajax - wordpress 冥王星主题中的 Ajax 永久链接

> ID：10739926
> 
> 赞同：0
> 
> 时间：2012-05-24T14:52:09.623
> 
> 标签：ajax, wordpress, permalinks

遇到 wp 主题和创建者的问题似乎无济于事。它是 Ajax 驱动的，不支持自定义永久链接...

因此，一旦该网站出现在 Google 上，所有引用的链接都会发送到一些似乎不在该网站的黑页：

Google 中出现的链接：www.thaiorchid.be/menus/（黑页） 与真实网页相比：www.thaiorchid.be/#menu-item-21

我开始有了解决方案的想法：[Wordpress 中的 AJAX 导航 - 永久链接](https://stackoverflow.com/questions/4865770/ajax-navigation-in-wordpress-trouble-with-permalinks-solved)问题并在联系页面 www.thaiorchid.be/contact 上尝试了它，它不再重定向到黑页，但与 www 相比它仍然不完美.thaiorchid.be/#menu-item-19...

任何想法都会非常受欢迎。非常感谢，乔纳森

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T09:18:26.177

您的网站没有为非 JS 浏览器提供适当的回退（例如，据我所知，大多数 Google 机器人）。这似乎是主题的（严重）缺点，而无需进一步了解。

如果构建得当，像这样的“AJAX 增强”站点应该允许通过基本的 HTML 请求访问**所有**内容。如果 Javascript 在客户端中可用，则最好使用 AJAX 请求加载相同的内容，例如，允许更快的页面加载和漂亮的转换。

另一个问题来自缺少子导航。由于您的子菜单（飞出）在没有 Javascript 的情况下不可用，因此您需要提供一种替代方法来访问更深和更深的两个级别的页面。

这是一个关于此页面如何/应该在没有 Javascript 的情况下工作的示例：

```
1\. Visit homepage
2\. Click “Menus” in navigation
3\. Opens “Menus” page, showing what the “black page” currently shows 
   + proper header/footer 
   + main navigation 
   + sub navigation for all elements in “Menus” fly–out (“Potages, Entrées, …”)
4\. Click “Potages”
5\. View “Potages” page, again with proper 
   header/footer 
   + main navigation 
   + sub navigation for all elements in “Menus” fly–out 
```

* * *

I know, you’re looking probably for a quick solution, maybe a snippet of code or a plugin to resolve your situation. Unfortunately — unless your theme provides you with some help — such a silver bullet doesn’t exist. The current implementation simply approaches the topic of an “AJAX site” in a fairly reckless way IMHO (you will be “happy” to know, that most screen readers won’t be able to access your content either) and until you re–build the theme or fix the structure you’re pretty much stuck with an unaccessible site.

# garbage-collection - JRuby - 如何启动垃圾收集器？

> ID：10739927
> 
> 赞同：6
> 
> 时间：2012-05-24T14:52:09.687
> 
> 标签：garbage-collection, jvm, jruby

我启动了我的 JRuby irb 控制台并输入：

```
irb(main):037:0* GC.enable
(irb):37 warning: GC.enable does nothing on JRuby
=> true
irb(main):038:0> GC.start
=> nil
irb(main):039:0> 
```

如何在程序期间手动启用或启动 JVM 垃圾？

我问是因为我有一个程序需要生成大约 500 MB 的测试数据并将其保存在 MySQL 中。该程序使用了大约 5 级嵌套循环，在生成大约 100 MB 的测试数据后，由于没有更多的堆内存，它崩溃并出现 JVM 内存堆异常。我想让垃圾收集器在每次运行外循环后运行，以便可以清理内循环中创建的所有孤立对象。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-24T15:57:55.460

您的问题的确切答案是：

```
require 'java'

java_import 'java.lang.System'

# ...

System.gc() 
```

不过，请记住，即使 JVM 通常*确实会*运行 GC，它也可能会或可能不会这样做 - 非常依赖于 JVM 的实现。它也可能对性能产生很大影响。

一个更好的答案显然是确保在嵌套循环结束时，您正在生成的测试数据上没有引用，以便稍后确实可以由 GC 回收它们。例子：

```
class Foo; end

sleep(5)

ary = []
100_000.times { 100_000.times{  ary << Foo.new }; puts 'Done'; ary = [] } 
```

如果你用 运行它`jruby -J-verbose:gc foo.rb`，你应该会看到 GC 定期声明对象；这在使用 JVisualVM 时也很清楚（`sleep`示例中是给一些时间来连接到 JVisualVM 中的 Jruby 进程）。

最后，您可以通过添加以下标志来增加堆内存`-J-Xmx256m`：有关更多详细信息，请参阅[JRuby wiki](https://github.com/jruby/jruby/wiki/PerformanceTuning)。

**编辑：**巧合的是，这是Mario Camou 最近在马德里 DevOps 上提出的[关于 GC 调整的思维导图，](https://www.evernote.com/shard/s167/sh/e994c854-2f8c-45fd-88bb-98e57f77a22e/61eb6b4e9b471d5ec44972f7b9ccf722/res/0847cb73-fb60-4e12-8ff0-4da62e02fc20/jvm-gc-tuning-20120525-093518.jpg.jpg)由 Nick Sieger 重新发布。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-25T05:57:52.230

这是不可能的，因为 Gc 将由 JVM 自动运行。确保仅在需要时创建对象。避免创建类级对象，并尝试找出哪些对象占用更多内存并仅在需要时创建它。

# php - 如何生成 HTML 文件取决于数组长度 php

> ID：10739930
> 
> 赞同：2
> 
> 时间：2012-05-24T14:52:12.160
> 
> 标签：php, html, xml

如何生成 HTML 文件取决于数组长度 php

我有一个 XML 文件。

```
<books>
  <book x="1" y="2">
     <name x="5" y="12">Java</name>
     <author x="8" y="16">Rao</author>
   </book>
   <book x="12" y="20">
     <name x="5" y="12">Php</name>
     <author x="5" y="12">Naidu</author>
   </book>
   <book x="19" y="29">
     <name x="25" y="22">Xml</name>
     <author x="25" y="12">Gowda</author>
   </book>
</books> 
```

我已使用 php 将其转换为数组。

我有标准的 html 文件，即模板。

```
<body>
  <div id="books" style="float:right; position:absolute; left: 199px; top: 245px;">
    <div id="book" style="float:right; position:absolute; left: 199px; top: 245px;">
    <div id="name" style="float:right; position:absolute; left: 199px; top: 245px;"></div>
    <div id="author" style="float:right; position:absolute; left: 199px; top: 245px;"></div>
     </div>
   </div>
</body> 
```

基于数组长度，我需要在 div 中生成许多具有动态值的 html 文件，这些文件存在于数组中。在这里我需要生成 3 个 html 文件（因为我有 3 个书本元素）。如何使用数组生成 html 文件。

数组看起来像这样：

```
Array
(
    [book] => Array
        (
            [0] => Array
                (
                    [name] => Java
                    [author] => Rao
                    [@attributes] => Array
                        (
                            [x] => 1
                            [y] => 2
                        )

                )

            [1] => Array
                (
                    [name] => Php
                    [author] => Naidu
                    [@attributes] => Array
                        (
                            [x] => 12
                            [y] => 20
                        )

                )

            [2] => Array
                (
                    [name] => Xml
                    [author] => Gowda
                    [@attributes] => Array
                        (
                            [x] => 19
                            [y] => 29
                        )

                )

        )

) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T14:58:30.667

我希望可以将 XML 解析为数组的人也能够做到这一点，但无论如何你都可以这样做：

```
<body>
    <div id="books" style="float:right; position:absolute; left: 199px; top: 245px;">
        <?php foreach($books as $book) : ?>
        <div id="book" style="float:right; position:absolute; left: <?php echo $book['@attributes']['x']; ?>px; top: <?php echo $book['@attributes']['y']; ?>px;">
            <div id="name" style="float:right; position:absolute; left: 199px; top: 245px;"><?php echo $book['name']; ?></div>
            <div id="author" style="float:right; position:absolute; left: 199px; top: 245px;"><?php echo $book['author']; ?></div>
        </div>
        <?php endforeach; ?>
    </div>
</body> 
```

ED|IT 我为这本书添加了 x/y 属性，我相信你可以自己做剩下的

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T15:07:12.560

在您的 html 模板中，使用诸如 real-template 之类的分隔符：

```
<body>
    <div id="books" style="float:right; position:absolute; left: 199px; top: 245px;">
        <div id="book" style="float:right; position:absolute; left: 199px; top: 245px;">
            <div id="name" style="float:right; position:absolute; left: 199px; top: 245px;">{name}</div>
            <div id="author" style="float:right; position:absolute; left: 199px; top: 245px;">{author}</div>
        </div>
    </div>
</body> 
```

在 PHP 端，使用正则表达式替换模板中的数据：

```
 $html_template = file_get_contents('/path/to/your/html/template');

        foreach($books['book'] as $i => $book) {
            $file_name = "html_page_for_book_{$i}";
            $html_file = fopen($file_name,'w');

            $html_data = preg_replace(array('/{author}/','/{name}/'),array($book['author'],$book['name']),$html_template);
            fwrite($html_file,$html_data);

            fclose($html_file);

        } 
```

# mysql - 没有数据时查询返回 1 行

> ID：10739936
> 
> 赞同：1
> 
> 时间：2012-05-24T14:52:32.080
> 
> 标签：mysql, null

我正在运行同一查询的多个实例。下面的版本不应该返回任何数据，但我在每一列中都得到 1 行“null”：

```
SELECT (CASE ScanName WHEN 'SYSTEM-HQ' THEN 'HQ
System' END) AS System, 
sum(CASE pspplMSSeverity WHEN 1 THEN 10 WHEN 2 THEN 9 WHEN 
3 THEN 6 WHEN 4 THEN 3 END) AS Score, 
(sum(CASE pspplMSSeverity WHEN 1 THEN 10 WHEN 2 THEN 9 
WHEN 3 THEN 6 WHEN 4 THEN 3 END)/COUNT(pspplMSSeverity)) AS 
Grade 
FROM missingpatches 
WHERE ScanName like '%SYSTEM-HQ%' 
ORDER BY LAST_UPDATE DESC LIMIT 1 
```

如何修改此查询以确保仅在存在有效值时才返回数据？

这可能是由于在导致返回 Null 数据的主 SQL 语句中使用了 Case 和 Sum？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T15:09:01.690

```
SELECT (CASE ScanName WHEN 'SYSTEM-HQ' THEN 'HQ
System' END) AS System, 
sum(CASE pspplMSSeverity WHEN 1 THEN 10 WHEN 2 THEN 9 WHEN 
3 THEN 6 WHEN 4 THEN 3 END) AS Score, 
(sum(CASE pspplMSSeverity WHEN 1 THEN 10 WHEN 2 THEN 9 
WHEN 3 THEN 6 WHEN 4 THEN 3 END)/COUNT(pspplMSSeverity)) AS 
Grade 
FROM missingpatches 
WHERE ScanName like '%SYSTEM-HQ%' 
HAVING System IS NOT NULL # Added
ORDER BY LAST_UPDATE DESC LIMIT 1 
```

尝试添加 HAVING。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T15:13:45.663

很可能该表`missingpatches`包含 1 行满足

```
WHERE ScanName like '%SYSTEM-HQ%' 
```

即 ScanName 包含“SYSTEM-HQ”但不完全等于“SYSTEM-HQ”的行，您在选择的第一列中等同于“SYSTEM-HQ”。

在 SQL 中，在连接表和评估 where 子句之后评估列。因此，您看到的行实际上符合 where 子句标准。

# ajax - ajax 表单验证后请求 facebook 权限/登录（在 ajax 响应中）

> ID：10739937
> 
> 赞同：0
> 
> 时间：2012-05-24T14:52:47.090
> 
> 标签：ajax, facebook

它现在正在工作，但我有一些用户反馈说 facebook 弹出窗口被浏览器阻止了

所以我现在在做什么：我有一个正在通过 ajax 验证的表单（调用 php 页面），然后如果响应成功，它会要求用户登录/权限。我假设弹出窗口有时会被阻止，因为浏览器认为 ajax 响应不是用户操作。

所以我的代码如下所示：

```
$("#submit").click(function (event) {
    event.preventDefault();
    $.ajax({
        url: url,
        type: type,
        data: form_data,
        success: function(result){
            if(result==""){
              FB.getLoginStatus(function(response) {
                if (response.status === 'connected') {
                   FB.api('/me/permissions', function (response) { ... });
                } else if (response.status === 'not_authorized') {
                   FB.login(function (response) { ... });
                }
              }
            }
        }
     }); 
```

除了将 facebook 调用放在表单验证之前还有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T15:04:41.313

您可以将 ajax 请求作为同步调用。虽然我不喜欢

顺便说一句，你正在做什么样的验证？

# jquery - droppable() 背景颜色

> ID：10739941
> 
> 赞同：0
> 
> 时间：2012-05-24T14:52:55.307
> 
> 标签：jquery, jquery-ui

使用 jquery-ui 的拖放，我希望将一个元素（div）的 bg 颜色更改为另一个元素（div）的 bg 颜色，当它被拖放到第一个元素的顶部时。背景颜色是从数据库中动态检索的，因此必须使用内联样式。我在 .droppable({ *** }) 中使用哪些选项/参数？

```
<?PHP echo  "<script type="text/javascript">
    $(function()
    {
        var " . $id . " = " . mysql row . "
        $('#first').draggable({revert:true});
        $('#second').draggable({revert:true});
        $('#third').draggable({revert:true});
        $('#fourth').draggable({revert:true});
        $('#fifth').draggable({revert:true});
        $('#target').droppable({
            drop: function( event, ui ) {
            $( this ).class('background-color', '" . $id . "');

        });
    });
    </script>"; ?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T15:46:28.000

这是一个将`background-color`a 的 a设置为放置在其上的 the`droppable`的示例。`background-color``draggable`

```
​$('​​​​​​​.draggable').draggable({
    revert: true
});
$('.droppable').droppable({
    accepts: '.draggable',
    drop: function(event, ui) {
        var bgColor = $(ui.draggable).css('backgroundColor');
        $(this).css('backgroundColor', bgColor);
        $(ui.draggable).remove();
    }
});​​​​​​​​​​​​​​​​​​​ 
```

**现场示例**：http: [//jsfiddle.net/EyKnr/](http://jsfiddle.net/EyKnr/)

如果您`background-color`从数据库中获取，您只需将`bgColor`我的示例中的变量替换为适当的值。

# ios - ios 3d动画问题

> ID：10739943
> 
> 赞同：1
> 
> 时间：2012-05-24T14:53:03.057
> 
> 标签：ios, core-animation, transform, layer

我正在尝试在 X 轴上对 UIImageView 进行 3D 动画处理，以便它进行 180 度旋转。在 90 度时，我想更改图像。（这就是为什么我在 2 中“破坏”了动画）。

动画效果很好，但问题是第二张图像是倒置的。任何想法我应该怎么做才能正常绘制图像？

这是我的代码

```
 i++;
[UIView animateWithDuration:2 animations:^{

    self.imageView.layer.transform = CATransform3DMakeRotation(-M_PI/2 , 1, 0,0);

} completion:^(BOOL finished){

    UIImage *bottomI = (UIImage *)[bottom objectAtIndex:i];
    self.second.image =bottomI;

    [UIView animateWithDuration:2 animations:^{

          imageView.layer.transform = CATransform3DMakeRotation(M_PI , 1, 0,0);

    } completion:^(BOOL finised){   

    }];

}]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T01:21:51.790

我所做的（使用分组的 CABasicAnimation 对象而不是视图动画，但同样的技巧应该起作用）是将视图/图层旋转前 90 度，然后在开始动画的后半部分之前将其旋转 180 度而不使用动画。这样，动画的后半部分实际上会导致视图/图层的正面旋转到视图中，就好像它是背面一样，而不是向后旋转。

当您切换其图像并将其旋转 180 度时，视图/图层与查看器相邻，因此用户无法看到这些更改。当它旋转剩余的 90 度时，新图像就位，它似乎正在显示视图/图层的背面。

它完美地工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T16:03:18.017

当您对视图进行 3d 旋转时，它类似于在现实生活中旋转对象。因此，一旦旋转超过 90 度，它就会反转对象。这就是为什么您的第二张图像是倒置的。最简单的做法是在添加之前将图像的仿射变换设置为将其旋转 180 度。

编辑：我的愚蠢....

我的本意是[这样](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIImage_Class/Reference/Reference.html)

```
bottomI.orientation = UIImageOrientationDown 
```

# ios - UITableView 复选标记图像视图设置在多个单元格上

> ID：10739946
> 
> 赞同：0
> 
> 时间：2012-05-24T14:53:22.170
> 
> 标签：ios, uitableview

我有一个列出货币的表格视图...我希望一次只能选择一个（如果用户单击已选择的单元格，它应该保持选中状态）...复选标记是一个 uiimageview...这里是代码：

```
 - (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{
    return 1;
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
    return [[self.currencyList fetchedObjects] count];
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"CurrencyCell";

    CurrencyCell *cell = (CurrencyCell *)[self.tableView dequeueReusableCellWithIdentifier:CellIdentifier];

    Currency *currency = [self.currencyList objectAtIndexPath:indexPath];

    cell.currencyName.text = currency.name;
    cell.curencyAbreviation.text = currency.abreviation;

    if ([currency.isDefault boolValue] == YES) {
        cell.selectedCurrency.image = [UIImage imageNamed:@"Checkmark.png"];
        checkedCell = indexPath;
        NSLog(@"The default currency cellfor row is :%@",currency);
        NSLog(@"the checkedcell index path is:%@",checkedCell);
    }

    return cell;

}

- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
    // [self.delegate theSelectedCurrencyIs:[self.currencyList objectAtIndexPath:indexPath]];

    if (![indexPath isEqual:checkedCell]) {
    CurrencyCell *cell = (CurrencyCell *)[self.tableView cellForRowAtIndexPath:indexPath];
    cell.selectedCurrency.image = [UIImage imageNamed:@"Checkmark.png"];
    selectedCurrency = [self.currencyList objectAtIndexPath:indexPath];
        NSLog(@"The selected currency is %@",selectedCurrency);
        NSLog(@"The indexpath of the new selected currency is %@",indexPath);
    CurrencyCell *previoslySelectedCell = (CurrencyCell *)[self.tableView cellForRowAtIndexPath:checkedCell];
        NSLog(@"name of the previously selected cell %@",previoslySelectedCell.currencyName);
    previoslySelectedCell.selectedCurrency.image = nil;
        //  [self.tableView reloadRowsAtIndexPaths:[NSArray arrayWithObjects:indexPath,checkedCell, nil] withRowAnimation:UITableViewRowAnimationNone];
        [self.tableView reloadData];
    checkedCell = indexPath;
    }
} 
```

问题是复选标记图像显示在多个选定的单元格中..选定的索引路径没问题...但是很多单元格看起来都已选中...似乎每个滚动屏幕上都有一些

这里会有什么问题？

# ios - NSUserDefaults 事务性

> ID：10739956
> 
> 赞同：2
> 
> 时间：2012-05-24T14:53:36.107
> 
> 标签：ios, cocoa, transactions, nsuserdefaults

有什么办法可以增加交易性`NSUserDefaults`吗？我需要类似数据库处理程序上众所周知的开始 - 提交 - 恢复功能，因此在某些情况下我可以恢复对用户默认值的修改。当然，此用户默认值的其他用户将在事务期间被阻止写入。

注1：`synchronize`上述类的方法*不会*做这件事，因为：

1.  根据文档，框架也会不时调用它
2.  没有“还原”

注意2：我看到了`dictionaryRepresentation`，`registerDefaults`我可以实现自己的事务机制（在内存中保存旧默认值的副本/甚至在事务期间保存到 plist 中）。但也许有一个现成的解决方案？

我的用例：

我有一个类似向导的屏幕流程，用户可以在每个屏幕上编辑一些设置。在当前实现中，当用户移动到向导的下一个屏幕时，这些设置会立即存储在默认值中。现在这个向导可以被其他一些事件打断（甚至用户可以在任何屏幕上选择退出/取消向导），在这种情况下我想回滚修改。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T15:43:50.113

一种可能的解决方案是将设置值推迟到向导结束。这可以很容易地完成，例如使用一个代理来记录发送给它的消息，然后在真实的`NSUserDefaults`. 记录消息应该非常简单：

```
- (void) forwardInvocation: (NSInvocation*) invocation
{
    [invocations addObject:invocation];
} 
```

`invocations`可变数组在哪里。重播消息也很简单：

```
- (void) replayOnTarget: (id) target
{
    for (NSInvocation *op in invocations)
        [op invokeWithTarget:target];
} 
```

这样，向导就不必知道有关事务的任何信息。它将获取录制代理而不是预期的`NSUserDefaults`实例并照常发送消息。在调用代码知道向导成功后，它可以在共享用户默认值上重播来自代理的消息。（我[在 GitHub 上添加了一些示例代码](https://github.com/zoul/MessageRecorder)。）

也许这有点矫枉过正，但由于录制代理是通用的并且可以在其他情况下使用，也许它还不错。同样的事情也可以使用块来完成：

```
[transaction addObject:[^{
    [defaults setObject:… forKey:…];
} copy]]; 
```

`transaction`再次，可变数组在哪里。当向导成功时，您只需遍历数组并执行存储的块。

# asp.net - 如何在函数中启动存储过程

> ID：10739960
> 
> 赞同：1
> 
> 时间：2012-05-24T14:53:46.713
> 
> 标签：asp.net, .net, sql, vb.net, stored-procedures

此代码自动更新会计年度...

```
 Dim yearVal As Double
 If Date.Now.Month = 10 OrElse Date.Now.Month = 11 OrElse Date.Now.Month = 12 Then
     yearVal = Date.Now.Year
 Else
     yearVal = Date.Now.Year - 1
 End If 
```

每年当这个变化到下一年时，我想自动执行这个sql存储过程......

```
ALTER PROCEDURE dbo.NewBudget
    @year int,
    @int nvarchar(3)

AS
BEGIN
SET NOCOUNT ON;

    INSERT [NAOLI].[dbo].[BudgetReal]
    ([F_Year],[O_OrgCode],[O_OrgDesc],[S_SubObject],[S_SubDescrip],[B_BudgetAmt],[B_Initials],[B_CIPrefNo],[B_OrgBudgetAmt]) 
    SELECT @year as [F_Year],[O_OrgCode],[O_OrgDesc],[S_SubObject],[S_SubDescrip], 0.00 as [B_BudgetAmt],@int as [B_Initials],[B_CIPrefNo],[B_OrgBudgetAmt]
    FROM [NAOLI].[dbo].[BudgetReal]
END 
```

去

我怎样才能做到这一点？

这成功了

```
Dim yearVal As Double
    If Date.Now.Month = 10 OrElse Date.Now.Month = 11 OrElse Date.Now.Month = 12 Then
        yearVal = Date.Now.Year
            If yearVal = Date.Now.Month = 10 OrElse Date.Now.Month = 11 OrElse Date.Now.Month = 12 Then
                dt = dal.ExecuteSelectStoredProc(dal.dbType.SqlServer, "NewBudget", "@year", DropDownList1.Text, "@int", )
            End If
    Else
        yearVal = Date.Now.Year - 1
    End If 
```

感谢大家的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T14:57:47.463

你需要用来`ADO.NET`连接到你的数据库。您将需要一个基于您的 RDBMS 的连接字符串。然后你可以把它放在一个类中并在你的条件`IF`语句块中调用它。

```
Dim sqlConnection1 As New SqlConnection("Your Connection String")
Dim cmd As New SqlCommand
Dim reader As SqlDataReader

cmd.CommandText = "dbo.NewBudget"
cmd.CommandType = CommandType.StoredProcedure
cmd.Parameters.Add("@year").Value = yearVal
cmd.Parameters.Add("@int").Value = intValue 'No idea why you have a Stored Procedure paramter called @int

cmd.Connection = sqlConnection1

sqlConnection1.Open()

reader = cmd.ExecuteNonQuery()
' Data is accessible through the DataReader object here.

sqlConnection1.Close() 
```

[http://msdn.microsoft.com/en-us/library/d7125bke(v=vs.80).aspx#Y1200](http://msdn.microsoft.com/en-us/library/d7125bke(v=vs.80).aspx#Y1200)

[http://www.connectionstrings.com](http://www.connectionstrings.com)

# objective-c - 可以将在主线程上调度的打开但不活动的 NSStream 移动到不同的线程吗？

> ID：10739966
> 
> 赞同：0
> 
> 时间：2012-05-24T14:53:57.117
> 
> 标签：objective-c, ios, nsthread, nsrunloop, nsstream

我正在使用（并且必须使用）我没有来源的第三方框架。第三方框架处理创建经过身份验证的客户端/服务器连接并返回一对打开的 NSStream。我面临的挑战是 NSStreams 被安排在主线程上（创建 UI 可能变得无响应的情况 - 我想避免这种情况）。

在从第三方框架传递流时，没有正在进行的网络流量。所以，我想知道我是否可以取消安排和重新安排 NSStreams。

有谁知道是否可以取消安排打开的 NSStream 并将其重新安排在不同线程上的不同运行循环上？这会导致问题吗？那里有任何代码示例吗？

提前致谢！

亚伦

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T17:10:05.393

如果我正确理解您的应用程序，这意味着您的应用程序接收到对特定流的引用，并且您负责阅读流中的所有内容。读取这些流应该是您通过 NSThread、NSOperation 或其他线程机制从应用程序强制进入后台的内容。

例子：

在您与此 NSInputStream 绑定的任何文件中：

```
@property (strong, nonatomic) NSInvocationOperation *parseOp; 

(id)startInputRead:(NSInputStream *)input {
    if([input hasBytesAvailable]) {
        self.parseOp = [[NSInvocationOperation alloc] initWithTarget:self selector:@selector(readAndStoreInput:) object:inputStream];

    } 
```

你的读者是这样的：

```
(void)readAndStoreInput:(NSInputSteam*) input{
     //process your input steam into your system in the background

} 
```

这是一个简短的示例，说明如何为输入端执行此操作。您也可以以类似的方式为输出蒸汽排队工作。这应该使所有内容同时运行，并且您的应用程序保持响应。

# python - Python 子进程在 .csv 上调用 bcp：'unexpected eof'

> ID：10739967
> 
> 赞同：1
> 
> 时间：2012-05-24T14:53:59.203
> 
> 标签：python, csv, sqlalchemy, eof, bcp

尝试 bcp 使用 Python 的 csv.writer 生成的 .csv 文件时遇到 EOF 问题。我已经做了很多谷歌搜索但没有运气，所以我求助于你们有帮助的人

这是错误消息（在 subprocess.call() 行上触发）：

```
Starting copy...
Unexpected EOF encountered in BCP data-file.
bcp copy in failed 
```

这是代码：

```
sel_str = 'select blahblahblah...'
result = engine.execute(sel_str)  #engine is a SQLAlchemy engine instance

# write to disk temporarily to be able to bcp the results to the db temp table
with open('tempscratch.csv','wb') as temp_bcp_file:
    csvw = csv.writer(temp_bcp_file)
    for r in result:
        csvw.writerow(r)
        temp_bcp_file.flush()

# upload the temp scratch file
bcp_string = 'bcp tempdb..collection in @INFILE -c -U username -P password -S DSN'
bcp_string = string.replace(bcp_string,'@INFILE','tempscratch.csv')
result_code = subprocess.call(bcp_string, shell=True) 
```

我在文本编辑器中查看了 tempscratch.csv 文件，没有看到任何奇怪的 EOF 或其他控制字符。此外，我查看了其他 .csv 文件进行比较，并且似乎没有 bcp 正在寻找的标准化 EOF。

此外，是的，这是 hacky，拉下结果集，将其写入磁盘，然后使用 bcp 将其重新上传到数据库。我必须这样做，因为 SQLAlchemy 不支持同一个 execute() 命令中的多行语句（又名 DDL 和 DML）。此外，此连接是与 Sybase db 的，它不支持 SQLAlchemy 的精彩 ORM :(（这就是我首先使用 execute() 的原因）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-24T15:42:32.517

据我所知，bcp 默认字段分隔符是制表符“\t”，而 Python 的 csv 编写器默认为逗号。试试这个...

```
# write to disk temporarily to be able to bcp the results to the db temp table
with open('tempscratch.csv','wb') as temp_bcp_file:
    csvw = csv.writer(temp_bcp_file, delimiter = '\t')
    for r in result:
        csvw.writerow(r)
    temp_bcp_file.flush() 
```

# c++ - C++，Boost：如何在地图容器中存储抽象类型的对象

> ID：10739970
> 
> 赞同：2
> 
> 时间：2012-05-24T14:54:02.307
> 
> 标签：c++, boost, polymorphism, containers, smart-pointers

我正在尝试使用地图容器来保存形状并将这些形状与 ID 号匹配。

到目前为止，我一直使用 STL 容器来保存和内存管理我的对象。所以我会使用这些类型的容器：

```
std::map<int, Square> squares;
std::map<int, Triangle> triangles;
std::map<int, Circle> circles; 
```

但我想要一个单独的地图来保存“形状”，这是一个方形、三角形和圆形的抽象基类。所以要实现这一点，我还是会把可实现的派生类对象存储在自己的映射中，然后再有另一个映射：

```
std::map<int, Shape*> shapes; 
```

存储指向存储在其他映射中的对象的指针。

不过，这似乎很混乱，我宁愿将所有对象存储在一个拥有并内存管理所包含对象的多态映射中。

在阅读了一些关于 Boost 的 ptr_map 之后，我预计这就是解决方案。但似乎基类需要在尝试使用时实现：

```
boost::ptr_map<int,Shape> shapes; 
```

我收到错误：“错误：无法分配抽象类型‘Shape’的对象”

我必须使基类可实现吗？这将是一个黑客，所以我宁愿正确地做到这一点，如果有这样的方式。

关于如何做到这一点，我的下一个最佳猜测是使用容器，例如：

```
std::map<int, boost::shared_ptr<Shape> > shapes; 
```

这似乎是一个简单的目标，但由于我遇到了这样的困难，我怀疑我正在尝试做一些我不应该做的事情。因此，非常感谢任何关于我可能出错的地方的建议。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T16:02:39.183

`ptr_map<int, Shape>`似乎是要走的路，甚至可以使用抽象基类型（参见[此处](http://ideone.com/rlZoJ)的示例）。我猜您获得的错误来自使用[`operator[]`](http://www.boost.org/doc/libs/1_36_0/libs/ptr_container/doc/ptr_map_adapter.html#lookup). 实际上，就像 in 一样，如果键不在地图中`std::map`，则返回默认构造的值。`operator[]`在这种情况下，它不能构造值，因为`Shape`它是抽象的，因此编译器错误。

因此，您可以使用`ptr_map`但不能使用索引运算符。插入时使用`insert`，查找键时使用`find`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T15:57:48.043

您的基类不需要是可实现的。请参阅此处的示例：http: [//www.boost.org/doc/libs/1_49_0/libs/ptr_container/doc/tutorial.html#associative-containers](http://www.boost.org/doc/libs/1_49_0/libs/ptr_container/doc/tutorial.html#associative-containers) 那里的动物确实具有抽象功能！事实上，这是 ptr 容器的主要用途之一。您的错误可能是在其他地方引起的，您需要发布更多代码。

还：

> 不过，这似乎很混乱，我宁愿将所有对象存储在一个拥有并内存管理所包含对象的多态映射中。

我不认为它是。永远不要“丢失”实际对象的类型实际上是有益的，以防您以后需要。例如，如果您想为所有三角形而不是所有其他形状做某事，这将派上用场。

缺点当然是您需要保持所有映射同步，但这很容易解决：将这 4 个映射（最好没有其他数据成员！）粘贴到类的私有部分并为不同的类型，并始终将它们插入到强类型的“拥有”映射中，并使用多态指针插入到映射中。我将很容易让它们在一个小类接口后面保持同步。只是不要尝试将其作为更大事物的非结构化部分来做，否则代码将开始看起来很混乱。

# python - 为什么 Numpy 对待 a+=b 和 a=a+b 的方式不同

> ID：10739978
> 
> 赞同：24
> 
> 时间：2012-05-24T14:54:27.260
> 
> 标签：python, numpy

以下 numpy 行为是故意的还是错误？

```
from numpy import *

a = arange(5)
a = a+2.3
print 'a = ', a
# Output: a = 2.3, 3.3, 4.3, 5.3, 6.3 

a = arange(5)
a += 2.3
print 'a = ', a
# Output: a = 2, 3, 4, 5, 6 
```

Python 版本：2.7.2，Numpy 版本：1.6.1

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2012-05-24T14:55:50.463

那是故意的。

运算符保留数组的`+=`类型。换句话说，整数数组仍然是整数数组。

这使 NumPy 能够`+=`使用现有的数组存储执行操作。另一方面，`a=a+b`为 sum 创建一个全新的数组，并重新绑定`a`以指向这个新数组；这会增加用于操作的存储量。

引用[文档](http://docs.scipy.org/doc/numpy/reference/arrays.ndarray.html)：

> **警告：**就地操作将使用由两个操作数的数据类型决定的精度来执行计算，但会默默地向下转换结果（如有必要），以便它可以放回数组中。因此，对于混合精度计算，`A {op}= B`可以不同于`A = A {op} B`. 例如，假设`a = ones((3,3))`. 然后，`a += 3j`不同于`a = a + 3j`: 虽然它们都执行相同的计算，`a += 3`但将结果强制转换为适合`a`，而`a = a + 3j`将名称重新绑定`a`到结果。

最后，如果您想知道为什么`a`首先是整数数组，请考虑以下问题：

```
In [3]: np.arange(5).dtype
Out[3]: dtype('int64')

In [4]: np.arange(5.0).dtype
Out[4]: dtype('float64') 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-05-24T16:53:37.773

@aix 是完全正确的。我只是想指出这不是 numpy 独有的。例如：

```
>>> a = []
>>> b = a
>>> a += [1]
>>> print a
[1]
>>> print b
[1]
>>> a = a + [2]
>>> print a
[1, 2]
>>> print b
[1] 
```

如您所见`+=`，修改列表并`+`创建一个新列表。这也适用于 numpy。`+`创建一个新数组，因此它可以是任何数据类型。`+=`就地修改数组，并且 numpy 在修改数组内容时更改数组的数据类型是不切实际的，并且 imo 可取。

# gps - Arduino mega + GPS 模块

> ID：10739981
> 
> 赞同：1
> 
> 时间：2012-05-24T14:54:39.873
> 
> 标签：gps, arduino

我正在使用带有 GPS 模块（PMB-648 GPS）的 Arduino Mega，我可以看到 GPS 发送给我的所有内容：

```
$GPGSA,A,1,,,,,,,,,,,,,,,*1E

$GPRMC,144547.705,V,5458.6542,N,00136.4148,W,,,240512,,,N*65

$GPGGA,144549.705,5458.6542,N,00136.4148,W,0,00,,20.6,M,47.8,M,,0000*51 
```

这没关系，但现在我需要隔离以“$GPRMC”开头的字符串并将其放入另一个变量中，当GPS改变位置时字符串会改变，只剩下“$GPRMC”。

这是我的代码：

```
String GPSstring ="";
boolean stringComplete = false;

void setup(){
  Serial.begin(9600);
  Serial2.begin(4800);
}

void loop(){
if (stringComplete){
  Serial.println(GPSstring);
  GPSstring = "";
  stringComplete = false;

  }

 }

void serialEvent2(){
  while(Serial2.available()){
  char inchar = (char)Serial2.read();
  GPSstring += inchar;

  if(inchar == '\n'){
    stringComplete = true;

    }
  }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T15:56:31.887

It pays to be lazy. Take a look at the [TinyGPS Library](http://arduiniana.org/libraries/tinygps) for ARduino to parse your NMEA strings easily.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T08:14:39.343

最简单的方法是创建一个[StringObject](http://arduino.cc/en/Reference/StringObject)并使用[startsWith()](http://arduino.cc/en/Reference/StringStartsWith)方法。

# ruby-on-rails - ActiveRecord 中的延迟保存

> ID：10739984
> 
> 赞同：0
> 
> 时间：2012-05-24T14:54:45.903
> 
> 标签：ruby-on-rails, activerecord, delayed-execution

**很快**：是否有标准的 Rails 功能来标记模型实例以进行延迟保存（例如`m.delay_save!`），然后通过单个调用（例如`DelaysManager.commit!`）保存所有标记的模型？

**详细地说**：

考虑用例：我需要用两种不同的方法更新模型 X 的实例：

```
def f1
  x = get_instance_of_x
  x.a = 'A'
  x.save!
end

def f2
  x = get_instance_of_x
  x.b = 'B'
  x.save!
end
...
def g
  f1
  f2
end 
```

这里的问题是 g 保存了 X 的实例两次。我想做一次。我可以将调用`save!`移至方法 g，但在更复杂的情况下，g 可能不知道需要保存哪些对象。所以我希望它看起来像这样：

```
def f1
  x = get_instance_of_x
  x.a = 'A'
  x.delay :save!
end

def f2
  x = get_instance_of_x
  x.b = 'B'
  x.delay :save!
end
...
def g
  f1
  f2
  DelaysManager.commit
end

class ActiveRecord::Base
  def delay(*args)
    DelaysManager.delay(self, *args)
  end
end

class DelaysManager
  @@delays = []
  def self.delay(*args)
    @@delays << args
  end

  def self.commit
    @@delays.each { |object, *args| object.public_send(*args) }
    @@delays.clear
  end
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T15:00:35.830

您可以通过将修改后的对象收集到一个数组中来解决此问题。然后你可以简单地对它们使用全部保存。当然，当您获取已修改对象的实例时，您必须检查它是否存在于数组中。

```
def f1
  x = get_instance_of_x(params)
  x.a = 'A'
end

def f2
  x = get_instance_of_x(params)
  x.b = 'B'
end
...
def g
  @array_of_x = []
  f1
  f2
  commit
end

def get_instance_of_x(params)
  x = @array_of_x.select{|a| a.id == params[:id]} || X.find(params)
  @array_of_x << x unless @array_of_x.include(x)
  x
end

def commit
  @array_of_x.each(&:save)
end 
```

当然，您需要自定义`x = @array_of_x.select{|a| a.id == params[:id]} || X.find(params)`行以满足您的需求。

# language-design - 语言所需变量名前缀的推理

> ID：10739986
> 
> 赞同：2
> 
> 时间：2012-05-24T14:54:50.980
> 
> 标签：language-design

用于研究数据管理的基于浏览器的软件[StudyTRAX](http://www.sciencetrax.com/studytrax) ( [http://wiki.studytrax.com ) 允许通过 JavaScript 进行自定义表格和表格变量管理。](http://wiki.studytrax.com)但是，必须使用 StudyTRAX“变量”（本质上是表单元素 [包括 HTML 属性] 及其相应参数的表示，以及一些数据类型等）引用`#<varname>`，而常规 JavaScript 变量将只是`<varname>`.

做这种事情是为了使解析更容易，还是只是为了区分两者，以便不那么倾向于技术的研究人员在弄清楚他们在做什么时不会遇到太多麻烦？鉴于 JavaScript 的性质，我认为 StudyTRAX 的“变量”只是常规的 JavaScript 对象，以使表单设计和定制更简单的方式定义，因此后者更有意义，但我错了吗？

另外，我知道还有其他编程语言确实需要特定的变量前缀（尽管我现在想不出一些）；在语言设计中选择该选择的通常原因是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-19T06:32:11.813

两部分答案，StudyTRAX 几乎可以肯定是在使用预处理器来做一些魔术。JavaScript 使这种相对性变得容易，但不像 Lisp 那样容易。您仍然需要解析代码。通过添加前缀，解析器可以忽略 JavaScript 的许多复杂语法并获得好的部分，而无需“完美”的编译器。实际上，很多模板系统都是这样做的。它是 Lisp 准引用的实现（[参见 Greenspun 的第十条规则](http://c2.com/cgi/wiki?GreenspunsTenthRuleOfProgramming)）。

至于一般的前缀，理解它们的最好方法是尝试为没有它们的语言编写解析器。对于像 Lisp 和 JavaScript 这样的非常动态和纯粹的语言，一切都是 List / 对象，这还不错。当你得到方法与对象不同的语言，或者函数不是一流的时，解析器开始不得不问自己“foo”指的是什么类型的东西？来自 Ruby 的一个恼人的例子：一个无前缀的标识符要么是一个局部变量，要么是一个隐含在`self`. 在 Rails 中有一些用`method_missing`. `Person.find_first_by_rank`工作正常，但是

```
Class Person < ActiveRecord::Base
  def promotion(name)
    p = find_first_by_rank
    [...]
  end
end 
```

给出一个错误，因为`find_first_by_rank`它看起来可能是一个局部变量，而 Ruby 害怕调用`method_missing`可能只是拼写错误的局部变量的东西。

现在想象一下试图区分实例变量（前缀-@）、类变量（前缀-@@）、全局变量（前缀-$）、常量（首字母Capitol）、方法名和局部变量（无前缀小写）仅根据上下文。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T16:58:08.333

（来自编译器和语言爱好者设计师）。

您的问题更具体到“StudyTRAX”软件。

在编程的早期，Basic 中的变量使用前缀作为 $（对于字符串，“a$”），以区别于数值。今天，一些编程语言（如 PHP）用“$”为变量添加前缀。COBNOL 使用以 A 到 I 开头的变量表示整数，然后使用后面的字母表示浮点数。

转换，然后执行一些代码，这是一项复杂的任务，这就是为什么许多程序员使用诸如在编程语言中添加前缀或后缀之类的快捷方式。

在许多学院或大学中，存在专门的课程/课程，用于将代码从编程语言转换为计算机可以执行的操作，例如“编译器”、“自动机”、“语言设计”，因为这不是一件容易的事。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T23:41:44.863

Perl 需要不同的变量前缀，具体取决于数据的类型：

```
$scalar = 4.2;
@array = (1, 4, 9, 16);
%map = ("foo" => 42, "bar" => 17, "baz" => 137); 
```

据我了解，这是为了让读者可以立即识别他们正在处理的对象类型。这与读者是否倾向于技术无关：如果您减少程序员的认知负担，他可以将他的脑力用于更重要的事情，而不是弄清楚复杂的句法细节。

Perl 的设计在这方面是否成功是另一个问题，但我相信这就是该功能背后的原因。

# c# - 我应该对带参数的 SQL 使用 const 字符串（.NET C#）吗？

> ID：10739991
> 
> 赞同：1
> 
> 时间：2012-05-24T14:55:15.633
> 
> 标签：c#, sql, string, resharper, constants

我想知道在使用这样的代码时是否应该使用 const 字符串：

```
 public DataTable GetSomeData(int id)
    {
        var con = new SqlConnection(ConnString);
        const string sql = "SELECT * FROM [data] WHERE [id]=@id";
        var cmd = new SqlCommand(sql, con);
        cmd.Parameters.AddWithValue("@id", id);

        var dt = new DataTable();
        con.Open();
        SqlDataReader dr = cmd.ExecuteReader();
        dt.Load(dr);
        con.Close();

        return dt;
    } 
```

ReSharper 建议我以这种方式解决它，但有人告诉我不应该这样做，因为它并不是真正恒定的。添加参数时它会发生变化。我认为这种方式是正确的，因为它在运行代码的服务器上是不变的，并且只有在到达数据库时才会改变。

那么，最好的方法是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-24T14:57:06.980

参数占位符的字符串应该是常量，声明为常量是对的，它是可变的命令对象，但**查询字符串是常量和不可变的**。

# c# - 搜索多个参数的 Lambda 或 Linq 方法

> ID：10739993
> 
> 赞同：2
> 
> 时间：2012-05-24T14:55:23.890
> 
> 标签：c#, linq, lambda

我有一个对象列表，并且 id 喜欢使用多个参数查询该列表，以减少搜索页面上的结果。

```
 int SecLink = (!string.IsNullOrEmpty(Request.QueryString["Sector"])) ? Convert.ToInt32(Request.QueryString["Sector"]) : 0;
        int LocLink = (!string.IsNullOrEmpty(Request.QueryString["Location"])) ? Convert.ToInt32(Request.QueryString["Location"]) : 0;
        int IndLink = (!string.IsNullOrEmpty(Request.QueryString["Industry"])) ? Convert.ToInt32(Request.QueryString["Industry"]) : 0;
        int VacLink = (!string.IsNullOrEmpty(Request.QueryString["Vacancy"])) ? Convert.ToInt32(Request.QueryString["Vacancy"]) : 0;

        string keyword = Request.QueryString["SearchTerm"];

        var dx = new DataX();
        var lstJobs = dx.GetAllJobs().Where(x => x.SectorLink.Equals(SecLink) && x.LocationLink.Equals(LocLink) && x.IndustryLink.Equals(IndLink) && x.VacancyTypeLink.Equals(VacLink) && x.JobName.Contains(keyword)).ToList();

        if (lstJobs.Count > 0)
        {
            uiRptSearchJobs.DataSource = lstJobs;
            uiRptSearchJobs.DataBind();

            uiLitSearchResults.Text = string.Format("<h4>Search result found {0} matches</h4>", lstJobs.Count);
        } 
```

搜索参数可能是“0”，因为没有从上一页中选择，所以结果应该反映他的。

这是我传递的查询字符串：

`Default.aspx?section=search&Sector=4&Location=0&Industry=0&Vacancy=0&SearchTerm=`

但正如您所看到的，它们的查询字符串会随着用户从上一页中选择的内容而改变。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-24T15:08:00.563

如果我理解正确，您不想过滤参数的值是否为0？如果是这样，两种解决方案：

1.  在您的条件下检查参数是否等于 0：

    ```
    var lstJobs = dx.GetAllJobs().Where(x => 
        (SecLink == 0 || x.SectorLink.Equals(SecLink))
        && (LocLink == 0 || x.LocationLink.Equals(LocLink))
        && (IndLink == 0 || x.IndustryLink.Equals(IndLink))
        && (VacLink == 0 || x.VacancyTypeLink.Equals(VacLink))
        && x.JobName.Contains(keyword)).ToList(); 
    ```

2.  Linq 天哪，动态构造您的查询：

    ```
     var query = dx.GetAllJobs().Where(x => x.JobName.Contains(keyword));

        if (SecLink != 0)
        {
            query = query.Where(x => x.SectorLink.Equals(SecLink));
        }

        if (LocLink != 0)
        {
            query = query.Where(x => x.LocationLink.Equals(LocLink));
        }

        if (IndLink != 0)
        {
            query = query.Where(x => x.IndustryLink.Equals(IndLink));
        }

        if (VacLink != 0)
        {
            query = query.Where(x => x.VacancyTypeLink.Equals(VacLink));
        }

        var lstJobs = query.ToList(); 
    ```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-24T15:06:44.873

一种选择是有条件地执行`Where`子句：

如果搜索词应该 AND 在一起：

```
var lstJobs = dx.GetAllJobs();

if (SecLink > 0)
    lstJobs = lstJobs.Where(x => x.SectorLink.Equals(SecLink))

if (LocLink > 0)
    lstJobs = lstJobs.Where(x => x.LocationLink.Equals(LocLink))

if (IndLink > 0)
    lstJobs = lstJobs.Where(x => x.IndustryLink.Equals(IndLink))

if (VacLink > 0)
    lstJobs = lstJobs.Where(x => x.VacationLink.Equals(VacLink))

// Performance does not suffer because the query will
// not get evaluated until it's required. For example, 
// here we call .ToList, which forces the query to be evaluated.
var result = lstJobs.ToList(); 
```

但是，您已经明确表示您需要将搜索词 ORed 在一起。在这种情况下：

```
var lstJobs = dx.GetAllJobs().Where(x => x.JobName.Contains(keyword));

if (SecLink > 0)
    lstJobs = lstJobs.Union(
        dx.GetAllJobs().Where(x => x.SectorLink.Equals(SecLink))

if (LocLink > 0)
    lstJobs = lstJobs.Union(
        dx.GetAllJobs().Where(x => x.LocationLink.Equals(LocLink))

etc... 
```

# actionmailer - 在 link_to 语句中使用 ActionMailer 方法 - Rails 3.2.3

> ID：10739998
> 
> 赞同：1
> 
> 时间：2012-05-24T14:55:40.583
> 
> 标签：actionmailer, ruby-on-rails-3.2

我想在单击时提供一个链接，它将向管理员发送一封电子邮件，通知他们删除记录。我已经搜索了几个小时，包括在这里但找不到任何示例。

这是我要修改的当前代码：

```
link_to "Delete your User Account?", @user, method: :delete, confirm: "You sure? This will permanently delete your account.  If you want to access our site in the future you will need to create a new account again.  Are you sure you want to delete your account?" %> 
```

我想用 ActionMailer 方法替换“method: :delete”。我在 api.rubyonrails.org 和其他地方的 Ruby 文档中查看了示例，但找不到任何内容。

这是我可以在不安装 gem 的情况下做的事情吗？

为什么很难找到带有示例的文档？叹.....

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T22:20:06.957

“方法：删除”是在您调用 url 时在标头中传递的 HTTP 方法，然后路由使用该方法来查找正确的控制器和操作。

您需要将方法调用放在 User#destroy 操作所在的控制器中的邮件程序中。

它会是这样的。

```
def destroy
  @user = User.find(params[:user])
  if @user.desotry
    # Tell the UserMailer to send a email after destroy
    UserMailer.delete_account_email(@user).deliver
    redirect_to(@user, :notice => 'Account was successfully closed.')
  end
end 
```