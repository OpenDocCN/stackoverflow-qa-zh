# StackOverflow 问答 11746000-11746999

# meteor - 使用 Meteor 渲染 MongoDB 文档

> ID：11746006
> 
> 赞同：0
> 
> 时间：2012-07-31T17:44:17.930
> 
> 标签：meteor

问题是：如何显示从MongoDB返回的复杂文档。

假设我的 Projects 集合中有两个项目，并且每个项目都有 2 个人，他们通过 People 集合中的 ID 嵌入。Project.find() 返回此 CURSOR，我将其呈现为 JSON 以提高可读性：

```
{ "_id" : "5ed5ade8-c140-46f7-8d9e-2344fc53df8e",  "name" : "Project1", "personnel" : [ "b4690c4b-d126-4737-8f40-921234567890", "977a6335-a1be-4af5-8b3f-4abcdefghijk" ] }
{ "_id" : "23f073c7-a713-4713-86a7-7d6600433146", "name" : "Project2", "personnel" : [ "b4690c4b-d126-4737-8f40-92b43072d7a1", "977a6335-a1be-4af5-8b3f-48cd5f8328db" ]} 
```

我在 .html 文件中的模板：

```
<template name="theProjects">
     {{#each theTitles}}
          Name: {{name}}
          Personnel: {{personnel}}
     {{/each}}
</template> 
```

在浏览器中呈现：

> 名称：项目1
> 
> > 人员：b4690c4b-d126-4737-8f40-921234567890,977a6335-a1be-4af5-8b3f-4abcdefghijk
> 
> 名称：项目2
> 
> > 人员：b4690c4b-d126-4737-8f40-92b43072d7a1,977a6335-a1be-4af5-8b3f-48cd5f8328db

问题：

1.  {{personnel}} 字段只是由 Projects 集合中的 person 数组的内容填充。我想在他们自己的行上单独列出这些。想不通。只是切片是不行的，因为...

2.  显然，更大的需求是能够操作和编辑人员数据，因此模板必须具有适当的 Meteor 反应性。

3.  现在最难的是：People 集合中的人员 ID 嵌入到项目文档中。我将如何使用 Meteor 将 ID 替换为来自 Personnel 集合的适当名称并仍然保持其数据反应性？

我知道有很多问题要问，但这些东西似乎是更大、更复杂网站的基础。

谢谢大家。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-31T21:57:33.527

[https://gist.github.com/3220991](https://gist.github.com/3220991)

这是我向您展示使用 Handlebars 助手的要点。这将保持反应性并且非常易于使用。我希望你可以使用它。

如果您需要更多帮助或评论，请提及我。

# android - 移动必需品的 Web 服务

> ID：11746012
> 
> 赞同：1
> 
> 时间：2012-07-31T17:44:41.877
> 
> 标签：android, web-services, codeigniter

我有一个网站，我需要在 android 和 iphone 上制作一个应用程序，该应用程序必须与服务器通信，类似于 facebook 应用程序。我需要像 SOAP 这样的网络服务吗？我阅读了他们的文档，但他们有多么必要和他们的主要目的是什么？我可以在不使用 Web 服务的情况下做同样的事情吗？我的网站在 codeigniter

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-31T17:50:48.233

如果您需要为您的应用程序实现 Web 服务，我建议您查看[CodeIgniter Rest Server](https://github.com/philsturgeon/codeigniter-restserver)。这为实现 REST Web 服务提供了一种简单的方法，与 SOAP 相比，这些服务更轻、更易于使用且更灵活。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-31T18:05:34.203

使用 Web 服务的好处：

1 - 可用性：您可以开发 Android 和 iOS 应用程序，它们都可以使用相同的 Web Service。其他智能手机平台也可以稍后开发并使用相同的 Web Service。

2 - 灵活性：例如，您需要有一种与数据库对话的机制。您可以在 Web 服务中实现数据库事务。（我有使用hibernate的经验）您不必在每个智能手机应用程序中创建数据库配置。如果您决定更改您的数据库，那么您只需要在 Web 服务中修改您的数据库配置 - 客户端没有任何变化。

3 - 安全性：从移动应用程序直接连接到数据库服务器不是一个好的机制。您需要有某种可以由 Web 服务提供的身份验证机制。

哪种 Web Service 更好？我同意@Justin 的观点，即 REST 是一种很好的方法，因为它更轻、更易于实现且更灵活。

当安全性是最重要的事情时，例如在某些企业场景中，SOAP 可能是一种更好的方法。[REST 与 SOAP](http://www.youtube.com/watch?v=v3OMEAU_4HI)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-31T21:06:44.733

是否需要网络服务？那么你的问题的正确答案是它取决于应用程序。大多数连接到服务器以获取某些信息的应用程序都使用 Web 服务。但是，不，您不需要编写自己的 Web 服务。越来越多的人使用像 agigee [http://apigee.com/about/products/usergrid/这样的平台](http://apigee.com/about/products/usergrid/)

因此，不，如果您使用 usergrid，则不需要编写自己的 api，但如果您想将数据全部保存在自己的基础架构中，则可能需要编写。

# eclipse - 编写 XSD 架构以验证任何 XML 文件是否有效

> ID：11746019
> 
> 赞同：2
> 
> 时间：2012-07-31T17:45:14.013
> 
> 标签：eclipse, xsd, logback

我经常在 Eclipse 中收到警告：

> 未检测到文档的语法约束（DTD 或 XML 模式）：logback.xml

由于 Logback 的配置文件“灵活性”，没有验证模式是可能的。

因此，作为一种完全解决问题的方法，互联网上是否有可用的 XSD 来验证任何结构上有效的 XML 文件是否有效，所以我可以欺骗 Eclipse 对这个问题保持沉默？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T17:52:04.780

您始终可以在 Eclipse 中禁用警告。转到首选项--> XML--> XML 文件--> 验证并选择“忽略”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-04-16T23:16:18.093

尝试添加

```
<!DOCTYPE configuration> 
```

在你的*logback.xml*的顶部（在 之后`<?xml...>`）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-31T19:44:40.560

严格来说，没有这样的 XSD，能够匹配任何 XML。您必须找到另一种方法，例如可能已经建议的方法（禁用验证）。

我可能不会这样做，只是因为在编辑要验证的其他 XML 文件时可能必须来回切换。

我会尝试定义一个虚拟 XSD，它将你的 logback 配置文件的根元素定义为任何东西。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-10-30T05:10:56.690

有一种更直接的方法来专门处理 Logback 配置：

*   打开首选项-> 验证。单击 XML Validator 旁边的 Settings 的“...”按钮
*   Eclipse 内部文件应该已经有一个排除组。单击“排除组”，然后单击“添加规则...”按钮。
*   选择“文件夹或文件名”。
*   输入`logback.xml`并完成。
*   `logback-test.xml`如果您使用单独的日志记录配置进行测试，请重复此操作。

这将使 Eclipse 不会对这些文件运行 XML 验证，但会保持对 XML 的其余部分的验证处于活动状态。

# sqlite - SQLiteMetro 组

> ID：11746022
> 
> 赞同：0
> 
> 时间：2012-07-31T17:45:30.327
> 
> 标签：sqlite, microsoft-metro, windows-runtime

这个库是否支持 Group by 子句？

我写了查询 Select SectionName, DepartmentName, SUM(SalesValue) FROM ( SELECT SectionName, Date, DepartmentName, SalesValue FROM StockDaily join Section on StockDaily.idSection=Section._id join Department on StockDaily.idDepartment = Department._id where idStore=1 and Date >=" + '"' + from + '"' + "and Date <=" + '"' + to + '"' + ")"+" 按 SectionName 分组

它在 sqlite manager 中工作，但在 lib 中的 cod 中没有：/ 你有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T21:07:41.350

是的，sqlite 支持`GROUP BY`聚合。这是[参考](http://www.sqlite.org/lang_select.html)。

# ios - 在 Mkannotationview 或标注气泡上添加自定义图像？

> ID：11746026
> 
> 赞同：1
> 
> 时间：2012-07-31T17:45:39.547
> 
> 标签：ios, mkannotation, mkannotationview, mapkit

我正在尝试重现应用程序“Stuck On Earth”的那种地图行为。这是一个屏幕截图： ![在此处输入图像描述](../Images/f5aef385cb8df4d8be01e29b0e43a8fd.png)

这是行为：

*   在地图上，你可以看到有别针
*   当您单击一个图钉时，它会显示附加到它的图片。非常重要：带有别针的图片固定在它后面
*   如果点击图片，就会调用一个新的控制器
*   如果你点击图钉，图片就会消失

我正在尝试做类似的事情。目前，据我所知，我有两个解决方案：

1.  使用标注：标注是地狱。我可以尝试使用错误的注释，但是 MapKit 处理元素的深度，并且图片总是在图钉前面
2.  使用自定义注释：我打算制作自定义注释视图，当点击 pin 时，我启动 CustomAnnotationView 的方法，添加（或删除）缩略图。

我认为方法 2 可以工作，但我不知道如何处理缩略图上的触摸。

对此有何建议或帮助？谢谢 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T00:35:33.280

**2016 年 9 月 2 日更新：**

我的同事设计了一种解决方法，将弹出视图作为包含地图视图的视图容器的子视图。可以根据不同参考系下的CGPoint变换计算位置。

**原答案：**

我也遇到了这种问题，按照教程“构建自定义地图注释标注 - 第 1 部分”后，交互变得困难。

您是否尝试过点击手势识别器？我将它添加到子视图中，它可以工作，尽管代码味道不好。

# javascript - 加载存储在视图文件夹中的数据

> ID：11746032
> 
> 赞同：1
> 
> 时间：2012-07-31T17:45:56.343
> 
> 标签：javascript, file, asp.net-mvc-4, loading

首先：我知道在视图文件夹中存储数据（例如图像和音乐文件）不是一个好习惯。“它应该始终放在内容文件夹中”。

但事情就是这样。我的观点是一个相当庞大的 JavaScript 系统。该系统尝试从一个相对文件夹中加载一些资源，该文件夹现在是我的“Home/data/*”视图文件夹。这不起作用。

有没有办法允许从这些文件夹加载文件？

# c# - 使用带参数的命令时临时表的“无效对象名称”

> ID：11746036
> 
> 赞同：15
> 
> 时间：2012-07-31T17:46:20.920
> 
> 标签：c#, sql-server, ado.net

我正在创建一个临时表并使用相同的命令和连接使用两个单独的语句填充它。但是，如果我使用在创建之前插入的参数创建表，我会得到一个“无效的对象名称”。如果我在创建后添加它，它工作正常。

临时表应该持续整个会话，所以当参数添加到命令对象时，我看不出有什么关系。

**失败：**

```
 using (SqlConnection conn = new SqlConnection("Data Source=.;Initial Catalog=TEST;Integrated Security=True;"))
        using (SqlCommand cmd = conn.CreateCommand())
        {
            conn.Open();

            cmd.Parameters.Add(new SqlParameter("@ID", 1234));

            cmd.CommandText = "CREATE TABLE #Test (ID INT NOT NULL PRIMARY KEY, I INT NOT NULL)";
            cmd.ExecuteNonQuery();

            cmd.CommandText = "INSERT INTO #Test VALUES (@ID, 1)";
            cmd.ExecuteNonQuery();

            ..... more code that uses the table

        } 
```

**作品：**

```
 using (SqlConnection conn = new SqlConnection("Data Source=.;Initial Catalog=TEST;Integrated Security=True;"))
        using (SqlCommand cmd = conn.CreateCommand())
        {
            conn.Open();

            cmd.CommandText = "CREATE TABLE #Test (ID INT NOT NULL PRIMARY KEY, I INT NOT NULL)";
            cmd.ExecuteNonQuery();

            cmd.Parameters.Add(new SqlParameter("@ID", 1234));

            cmd.CommandText = "INSERT INTO #Test VALUES (@ID, 1)";
            cmd.ExecuteNonQuery();

            ..... more code that uses the table

        } 
```

**编辑：**

SQL Profiler 对此进行了更多说明。

如果该命令有任何参数，则底层代码将发出“exec sp_executesql”。如果参数被清除，底层代码会发出更直接的“CREATE TABLE”。临时表在 sp_executesql 之后被清理，这解释了我在这里看到的内容。

对我来说，这将是 SqlCommand（或相关）代码中的错误，但因为我现在有了解释，我可以继续前进。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2014-04-23T07:47:56.337

问题实际上出在“exec sp_executesql”语句中。当 ADO 检测到 sqlCommand 中声明了参数时，默认使用“sp_executesql”而不是“exec”。但是在这种情况下，第一个命令是创建一个 TEMPORAL 表，众所周知，临时表仅在存储过程 (sp_executesql) 内有效，并在退出时被删除。因此，第二个 INSERT 语句在第一个示例代码中不再有效。第二种情况，时态表创建成功，insert语句正常执行。希望能帮助到你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T17:57:15.017

我怀疑第一次执行的状态会失败，因为它坚持必须使用每个参数。

# sql - 如何防止 Grails 在 dbCreate 期间生成默认的 Hibernate_sequence？

> ID：11746037
> 
> 赞同：4
> 
> 时间：2012-07-31T17:46:24.837
> 
> 标签：sql, oracle, hibernate, grails, groovy

在我的每个域中，我在静态映射闭包中定义了一个自定义序列：

```
static mapping = {
    version false
    id generator:'sequence', params:[sequence:'MY_SEQ']   
} 
```

当我创建数据库时，MY_SEQ 序列就在那里，但是 grails 仍然会创建一个默认的 hibernate_sequence。如何让 grails 不设为默认值，并确保它使用的是我的自定义序列？Grails 生成默认值是否很常见，即使它不会被使用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T19:19:55.373

它很常见，默认来自 Hibernate，它不是 grails 的东西。甚至还有一个为此开放的[JIRA](https://hibernate.onjira.com/browse/HHH-2637)，但仍未解决。

你可以尝试扩展方言！[您可以在本主题](https://stackoverflow.com/questions/4412716/override-default-sequence-name-in-grails?lq=1)中找到您想要的代码。

关于确定表是否使用指定的序列，它应该，给定你这样做的方式。

# c# - json 描述一个布尔值

> ID：11746038
> 
> 赞同：1
> 
> 时间：2012-07-31T17:46:31.693
> 
> 标签：c#, javascript, json

我在服务器端对象模型中有一个布尔字段。我正在编写一个自定义 json 转换器，我想知道如何最好地为 json 编码。我应该将其保留为布尔值还是应该转换`true`为`1`and 。`false``0`

最好的方法是什么？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T17:52:48.557

根据[RFC](http://www.ietf.org/rfc/rfc4627.txt)（第 2.1 节），布尔值是`true`或`false`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-31T17:48:03.940

我更喜欢在我的 JSON 中使用 true/false 关键字，但 1/0 仍然可以使用。你的问题是关于如何编写代码来创建这个 JSON 对象？这取决于您如何实现转换器。到目前为止你有什么？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-31T17:48:36.800

没有明确的最佳方式。这取决于你（谁使用它）。

我个人认为，如果您代表布尔值，请使用**`True`/`False`**，而不是 1 /0。这更具可读性（对于将要维护此代码的未来开发人员/当您在几个月后查看此代码时）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-31T17:48:44.773

我建议使用`true`and`false`因为它更清楚地表明这些值是布尔值。

# ember.js - ember.js 是否仅使用 Em.Object.Extends 支持 HasMany？

> ID：11746043
> 
> 赞同：0
> 
> 时间：2012-07-31T17:46:52.913
> 
> 标签：ember.js

目前我的基本 hello world ember 应用程序具有以下模型对象

```
ChatApp.User = Em.Object.extend({
    username: null,
    other: null
});

ChatApp.Message = Em.Object.extend({
    message: null
}); 
```

我想将其改进为 User HasMany Messages - 可以按原样完成吗？如果不是，今天 0.9.8 中的首选方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-01T10:24:56.030

我会使用 ember-data。

它会给出类似的东西：

```
ChatApp.User = DS.Model.extend({
  username: DS.attr('string'),
  messages: DS.hasMany('ChatApp.Message')
});

ChatApp.Message = DS.Model.extend({
  message: DS.attr('string')
  user: DS.belongsTo('ChatApp.User')
}); 
```

# java - 在 servlet 处理完成之前转发到视图

> ID：11746046
> 
> 赞同：2
> 
> 时间：2012-07-31T17:47:10.483
> 
> 标签：java, servlets, forward

我正在编写一个简单的网络应用程序，它将一些文件上传到服务器，运行一些代码，然后将生成的文件通过电子邮件发送给用户。但是，由于用户上传了一些文件后代码可能需要几个小时才能运行，我想将它们转发到通知页面。然后他们应该能够关闭浏览器，同时在服务器上继续处理并等待结果电子邮件。

上传文件后，我有以下代码：

```
request.setAttribute("notification", details);
RequestDispatcher view = request.getRequestDispatcher("views/notification.jsp");
view.forward(request, response); 
```

然后处理代码如下。问题是视图在所有处理完成之前不会被转发。让用户停留在表单页面上。如果用户关闭浏览器，处理仍会继续，但我想先将用户转发到通知。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T17:54:18.180

您需要异步处理上传的文件。Servlet 假定只有在您离开 Servlet 后才会处理请求并关闭连接。如果您在 servlet 中运行处理代码，用户可能永远无法取回视图。

对于异步处理，您有多种选择，从普通线程、线程池、JMS 开始......抓取文件，将其发送到后台运行的某个线程，以便处理非阻塞并立即返回视图。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T22:43:01.580

当您使用 eclipse 和 netbeans 创建一个新的 servlet 时，您会注意到响应对象。在线阅读它，您将使用响应对象找到所有答案。

# css - 如何在没有最小高度、粘性页脚或 javascript 的情况下将包含的页脚保留在短页面的底部

> ID：11746049
> 
> 赞同：8
> 
> 时间：2012-07-31T17:47:39.007
> 
> 标签：css

我有 60 页都有相同的页脚，包含在 php.ini 中。内容量从高度 300px 到 2000+ 不等。我认为这是不可能的，但是如果我可以让页脚位于浏览器窗口的底部，如果页面比窗口短，并且表现正常（推到底部），那将是很好的，否则，仅使用 CSS。谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-05-03T08:07:33.120

我知道这篇文章已经很老了，但我找到了一个很好的资源来解决这个问题。

[http://ryanfait.com/sticky-footer/](http://ryanfait.com/sticky-footer/)

这只是CSS：

```
* {
    margin: 0;
}
html, body {
    height: 100%;
}
.wrapper {
    min-height: 100%;
    height: auto !important;
    height: 100%;
    margin: 0 auto -155px; /* the bottom margin is the negative value of the footer's height */
}
.footer, .push {
    height: 155px; /* .push must be the same height as .footer */
}

/*

Sticky Footer by Ryan Fait
http://ryanfait.com/

*/ 
```

祝你好运。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-10-20T15:18:34.193

这太晚了，答案与 Barry P 的答案有点相似。

为您的包装器 css 类添加以下内容，

> 最小高度：计算（100vh - 155px）；

*注意：这在 IE8 或更低版本中不起作用。*

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-31T17:58:35.470

这是一篇针对即使IE7页脚在内容很少时停留在底部并在内容很多时向下拖动的文章

[http://snipplr.com/view/15334/](http://snipplr.com/view/15334/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-31T19:38:55.477

我会尝试给你的内容一个最小高度，比如 500px ......

```
#content {
   min-height: 500px;
} 
```

这样，即使您只有 300 像素的内容，500 像素（或必要时更长）也会确保页脚被推到足够低的位置以位于最底部。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2012-07-31T17:54:52.240

尝试将此添加到您的 CSS

```
#footer {position: fixed; bottom: 0;} 
```

# actionscript-3 - 使用网络摄像头和 Microfone 输入从浏览器录制视频

> ID：11746058
> 
> 赞同：0
> 
> 时间：2012-07-31T17:48:26.207
> 
> 标签：actionscript-3, flash, browser, client-side

我需要使用来自摄像头和麦克风的输入通过用户浏览器录制视频并发送到我的服务器。由于 html5 仍然无法实现这种魔力，因此我正在寻找 Flash 解决方案。

我真的需要一些闪存媒体服务器来做到这一点，或者我可以做一个 POST 请求吗？

我想获取两个输入（网络摄像头和麦克风），将它们放入 .flv 并发送到我的服务器。

我见过一些使用字节数组来记录和发送，音频和视频分离的实现。问题在于，当您尝试将它们组合到单个文件中时，它会产生一系列同步问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T18:29:05.290

If you're still looking for a solution check out:

[http://framebase.io](http://framebase.io)

They have an embed-able recording widget that can transcode the videos automatically. I'd check out the docs, but on success, you can run an API call to check the status of transcoding and download it to your server or you can just use your own S3 bucket.

# php - 性能和排序，mysql和php之间的独特性

> ID：11746062
> 
> 赞同：6
> 
> 时间：2012-07-31T17:48:40.577
> 
> 标签：php, mysql

在这种情况下，哪种方法或多种方法的执行速度最快？

```
$year = db_get_fields("select distinct year from car_cache order by year desc"); 
```

或者

```
$year = db_get_fields("select year from car_cache");
$year = array_unique($year);
sort($year); 
```

我听说 mysql 上的 distinct 对大型查询有很大的性能影响，并且该表可以有一百万行或更多行。我想知道哪种数据库类型组合（Innodb 或 MyISAM）也最有效。我知道许多优化都非常依赖查询。Year 是一个无符号数字，但其他字段是不同长度的 varchar，我知道这也可能会有所不同。如：

```
$line = db_get_fields("select distinct line from car_cache where year='$postyear' and make='$postmake' order by line desc"); 
```

我读到使用新的 innodb 多键方法可以非常快速地进行这样的查询。但是 distinct 和 order by 子句对我来说是危险信号。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-31T18:34:04.183

让 MySQL 做尽可能多的工作。如果它的工作效率不高，那么事情可能没有正确设置（无论是您尝试运行的查询的正确索引，还是带有排序缓冲区的设置）。

如果您在列上有索引`year`，那么使用`DISTINCT`应该是有效的。如果不这样做，则需要进行全表扫描才能获取不同的行。如果您尝试在 PHP 而不是 MySQL 中整理不同的行，那么您（可能）将更多数据从 MySQL 传输到 PHP，并且 PHP 在消除重复之前消耗更多内存来存储所有这些数据。

这是我拥有的开发数据库的一些示例输出。另请注意，此数据库位于网络上执行查询的不同服务器上。

```
SELECT COUNT(SerialNumber) FROM `readings`;
> 97698592

SELECT SQL_NO_CACHE DISTINCT `SerialNumber`
FROM `readings`
ORDER BY `SerialNumber` DESC
LIMIT 10000;
> Fetched 10000 records.  Duration: 0.801 sec, fetched in: 0.082 sec

> EXPLAIN *above_query*
+----+-------------+----------+-------+---------------+---------+---------+------+------+-----------------------------------------------------------+
| id | select_type | table    | type  | possible_keys | key     | key_len | ref  | rows | Extra                                                     |
+----+-------------+----------+-------+---------------+---------+---------+------+------+-----------------------------------------------------------+
|  1 | SIMPLE      | readings | range | NULL          | PRIMARY | 18      | NULL |   19 | Using index for group-by; Using temporary; Using filesort |
+----+-------------+----------+-------+---------------+---------+---------+------+------+-----------------------------------------------------------+ 
```

如果我尝试相同的查询，除了将`SerialNumber`列替换为非索引的列，那么它将永远运行，因为 MySQL 必须检查所有 9700 万行。

一些效率与您期望返回的数据量有关。如果我稍微修改上述查询以对`time`列进行操作（读取的时间戳），则需要 1 分 40 秒才能获得 273,505 次的不同列表，其中大部分开销是通过网络传输所有记录. 因此，请记住您返回的数据量的限制，您希望将尝试获取的数据保持在尽可能低的水平。

至于您的最终查询：

```
select distinct line from car_cache
where year='$postyear' and make='$postmake'
order by line desc 
```

这也应该没有问题，只要确保你有一个复合索引 on`year`并且`make`可能有一个索引 on `line`。

最后一点，我用于读数表的引擎是 InnoDB，我的服务器是：`5.5.23-55-log Percona Server (GPL), Release 25.3`这是 Percona Inc. 的 MySQL 版本。

希望有帮助。

# fortran - FORTRAN循环行和字符位置？

> ID：11746063
> 
> 赞同：0
> 
> 时间：2012-07-31T17:48:43.453
> 
> 标签：fortran, fortran77

我正在尝试使用 FORTRAN 77 遍历文档中的所有行，并将特定行位置与字符串进行比较，然后对其进行编辑。

例如：

```
|BXK   |00640.3A  |AWP |1.01|
|BUCKEYE MUNICIPAL AIRPORT                                             |08794| 
```

我想在第二行更改`08794`为。`0871994`

这是我到目前为止所拥有的：

```
 PROGRAM CONVERSION
    IMPLICIT NONE
    CHARACTER(LEN=120) :: ROW
    CHARACTER(LEN=2) :: DATE1='19', DATE2='20'
    INTEGER :: DATENUMBER
    INTEGER :: J

    OPEN(UNIT=1, FILE='BXK__96B.TXT', STATUS ='OLD')
    OPEN(UNIT=2, FILE='BXK__96B_MODIFIED.TXT', STATUS='UKNOWN')

    DO J=1,10000
    READ(1,'(A)') ROW
        IF (J==2) THEN
            DATENUMBER = ICHAR(ROW(76))
            IF ((DATENUMBER.LE.9) .AND. (DATENUMBER.GE.2)) THEN
                WRITE(2, '(A)' ROW(1:75), DATE1, ROW(76:120))
            ELSE 
                WRITE(2, '(A)' ROW(1:75), DATE2, ROW(76:120))
            ENDIF
        END IF
    END DO
    CONTINUE
    CLOSE(1)
    CLOSE(2)

    END 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-01T10:40:20.740

Ahh, so what you mean is, you want to convert the 2-digit representation of the year found at the right end of line 2 into its 4-digit representation. You seem already to have figured out how to find the position of the leading digit of the year, ie 76\. Rather easier than what you have written would be

```
integer :: year
.
.
.
read(line(76:77),'(i2)') year  ! this reads year from the characters in positions 76,77
if (20<=year.and.year<=90) then  ! not sure if this precisely your test
   year = year+1900
else
   year = year+2000
end if

write(line(76:79),'(i4)') year 
```

I haven't gone to the trouble of integrating this into the rest of your code, that should be straightforward, if not ask for more help.

Actually, I suppose you probably haven't figured out how to find the column at which you want to start reading the year from line 2\. Precisely how you do this depends on what the format of your file really is. The functions you need to familiarise yourself with are, as one of the comments tells you `INDEX` and `SCAN`.

If you are looking for the 4th character after the 2nd occurrence of `|` in line 2 you could do it this way:

```
integer :: posn_of_2nd_vertical_bar
.
.
.
posn_of_2nd_vertical_bar = scan(row(scan(row,'|')+1:),'|') 
```

and then replace your constant 76 with `posn_of_2nd_vertical_bar+4`

# java - 装饰器设计模式和 Java I/O

> ID：11746068
> 
> 赞同：1
> 
> 时间：2012-07-31T17:48:52.800
> 
> 标签：java, design-patterns

> **可能的重复：**
> [IO 的装饰器模式](https://stackoverflow.com/questions/6366385/decorator-pattern-for-io)

谁能解释一下java I/O中装饰器模式的概念和使用？谢谢你。

# ruby-on-rails - 如何在生产中访问此辅助功能？

> ID：11746070
> 
> 赞同：8
> 
> 时间：2012-07-31T17:48:57.187
> 
> 标签：ruby-on-rails, ruby-on-rails-3, helper

我正在使用[private_pub](https://github.com/ryanb/private_pub/)向我的用户推送订阅客户端的通知。在我的 application.html.haml 我有：

```
...
= javascript_include_tag 'application'
= subscribe_to "/#{@user.access_token}/notifications"
... 
```

subscribe_to 助手在开发中工作正常。部署到生产环境时，会记录以下错误：

```
ActionView::Template::Error (undefined method `subscribe_to' for #<#<Class:0x00000001f372e8>:0x00000001fded90>):
    5:     = stylesheet_link_tag 'application', :media => 'all'
    6:     = include_gon(:init => true)
    7:     = javascript_include_tag 'application'
    8:     = subscribe_to "/#{@user.access_token}/notifications"
    9:     = csrf_meta_tags
    10: 
    11:   %body
  app/views/layouts/application.html.haml:8:in `_app_views_layouts_application_html_haml__1867651381877570337_14592040' 
```

如何在我的生产环境中访问此辅助方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-10T17:53:52.713

这看起来像是加载 PrivatePub 引擎的错误。如果您查看[engine.rb](https://github.com/ryanb/private_pub/blob/master/lib/private_pub/engine.rb)，您会看到它正在将 PrivatePub 视图助手添加为 init 的一部分。如果它正在为开发而不是生产环境加载，则可能是一个错误。

尝试创建一个手动加载 PrivatePub 助手的配置/初始化程序：

```
require 'private_pub/view_helpers'
ActionView::Base.send :include, PrivatePub::ViewHelpers 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-05T05:53:30.327

你的部署脚本是否启动了 Faye 的 rackup 文件？rackup private_pub.ru -s thin -E production

# arrays - 如何将包含字符“\n”的多行字符串拆分为bash中的字符串数组？

> ID：11746071
> 
> 赞同：21
> 
> 时间：2012-07-31T17:48:59.417
> 
> 标签：arrays, string, bash, escaping

我有以下格式的*字符串：*

```
I'm\nNed\nNederlander
I'm\nLucky\nDay
I'm\nDusty\nBottoms 
```

我想将它逐行移动到一个字符串数组中，这样：

```
$ echo "${ARRAY[0]}"
I'm\nNed\nNederlander

$ echo "${ARRAY[1]}"
I'm\nLucky\nDay

$ echo "${ARRAY[2]}"
I'm\nDusty\nBottoms 
```

但是，我遇到了字符串本身中的“\n”字符的问题。它们在字符串中表示为两个单独的字符，反斜杠和“n”，但是当我尝试进行数组拆分时，它们被解释为换行符。因此，典型的字符串拆分 with`IFS`不起作用。

例如：

```
$ read -a ARRAY <<< "$STRING"
$ echo "${#ARRAY[@]}"   # print number of elements
2

$ echo "${ARRAY[0]}"
I'mnNednNederla

$ echo "${ARRAY[1]}"
der 
```

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-07-31T17:56:13.967

默认情况下，`read`内置允许 \ 转义字符。要关闭此行为，请使用该`-r`选项。您不会经常发现不想使用的情况`-r`。

```
string="I'm\nNed\nNederlander
I'm\nLucky\nDay
I'm\nDusty\nBottoms"

arr=()
while read -r line; do
   arr+=("$line")
done <<< "$string" 
```

为了在一行中执行此操作（就像您尝试使用`read -a`），实际上需要`mapfile`bash v4 或更高版本：

```
mapfile -t arr <<< "$string" 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-08-23T02:06:01.843

`mapfile` is more elegant, but it is possible to do this in one (ugly) line with `read` (useful if you're using a version of bash older than 4):

```
IFS=$'\n' read -d '' -r -a arr <<< "$string" 
```

# opencv - OpenCV 查找子图像

> ID：11746072
> 
> 赞同：1
> 
> 时间：2012-07-31T17:49:05.113
> 
> 标签：opencv, image-recognition

我有一台足够大的扫描仪，可以一次扫描多张照片。不幸的是，所有图片都存储在一个 jpg 文件中，仅由白色边框分隔。有没有办法自动找到子图像并将它们存储在单独的文件中？我正在考虑使用 OpenCV 来完成工作，但我找不到合适的功能。有人知道哪个 OpenCV 函数可以工作，或者是否有其他方法（使用 linux）？

谢谢，康斯坦丁

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-15T15:31:41.253

与我的图像一起使用的快速而肮脏的解决方案看起来像这样。我希望有类似问题的人可以以此为起点来学习如何使用 OpenCV。

```
// g++ `pkg-config --cflags --libs opencv` parse.cp

// include standard OpenCV headers, same as before
#include <cv.h>
#include <highgui.h>
#include <stdio.h>

// all the new API is put into "cv" namespace. Export its content
using namespace cv;
using namespace std;

int main( int argc, char** argv )
{
    string imagename = argc > 1 ? argv[1] : "lena.jpg";

    // the newer cvLoadImage alternative with MATLAB-style name
    Mat imgf = imread("original/"+imagename);

    if( !imgf.data ) // check if the image has been loaded properly
        return -1;

    int border = 1000;
    Mat img(imgf.rows+2*border,imgf.cols+2*border,CV_8UC3,Scalar(255,255,255));
    for (int i=0; i<imgf.cols; ++i) {
        for (int j=0; j<imgf.rows; ++j) {
            img.at<Vec3b>(j+border,i+border) = imgf.at<Vec3b>(j,i);
        }
    }

    cout << "created border\n";
    Mat mask;
    img.copyTo(mask);

    Scalar diff(2,2,2);
    floodFill(mask, Point(0,0), Scalar(0,0,255), NULL, diff, diff);

    cout << "flood filled\n";

    imwrite("flood.png",mask);

    for (int i=0; i<mask.cols; ++i) {
        for (int j=0; j<mask.rows; ++j) {
            if(mask.at<Vec3b>(j,i) != Vec3b(0,0,255)) {
                mask.at<Vec3b>(j,i) = Vec3b(0,0,0);
            } else {
                mask.at<Vec3b>(j,i) = Vec3b(255,255,255);
            }
        }
    }

    cvtColor( mask, mask, CV_RGB2GRAY );

    cout << "mask created\n";

    imwrite("binary.png",mask);

    Mat sobelX;
    Mat sobelY;
    Mat sobel;
    Sobel(mask,sobelX,CV_16S,1,0);
    Sobel(mask,sobelY,CV_16S,0,1);
    sobel = abs(sobelX)+abs(sobelY);

    for (int i=0; i<mask.cols; ++i) {
        for (int j=0; j<mask.rows; ++j) {
            mask.at<char>(j,i) = abs(sobelX.at<short>(j,i))+abs(sobelY.at<short>(j,i));
        }
    }

    threshold(mask, mask, 127, 255, THRESH_BINARY);

    cout << "sobel done\n";

    imwrite("sobel.png",mask);

    vector<vector<Point> > contours;
    vector<Vec4i> hierarchy;

    findContours(mask, contours, hierarchy,
        CV_RETR_CCOMP, CV_CHAIN_APPROX_SIMPLE );

    imwrite("contours.png",mask);

    cout << "contours done\n";

    // iterate through all the top-level contours
    int idx = 0;
    for( ; idx >= 0; idx = hierarchy[idx][0] )
    {
        RotatedRect box = minAreaRect(contours[idx]);
        if(box.size.width > 100 && box.size.height > 100) {
            Mat rot = getRotationMatrix2D(box.center,box.angle,1.0);
            Mat rotimg;
            warpAffine(img,rotimg,rot,Size(img.cols,img.rows));

            imwrite("rotimg.png",rotimg);
            Mat subimg(box.size.width,box.size.height,CV_8UC3);
            getRectSubPix(rotimg,box.size,box.center,subimg);

            stringstream name;
            name << "subimg_"<< imagename << "_" << idx << ".png";
            cout << name.str() << "\n"; 
            imwrite(name.str(),subimg);
        }
    }

    imwrite("img.png",img);
    imwrite("mask.png",mask);

    cout << "Done\n";

    return 0;
} 
```

# ios - 仪器的程序控制（或注释）？

> ID：11746073
> 
> 赞同：1
> 
> 时间：2012-07-31T17:49:06.667
> 
> 标签：ios, instruments

是否有调用可用于为特定代码部分打开仪器、对其进行注释或诸如此类？

我正在寻找分析特定的代码块。通常，我只是尝试将我的检查范围设置为尽可能接近该代码。但必须有更好的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-01T18:35:36.303

Instruments 版本 4 添加了 DTPerformanceSession 框架，可让您在代码中开始和停止分析。我没有使用它，我不确定它是否适用于 iOS，但有待调查。

如果您想将分析限制为单一方法，您可以创建自定义仪器。选择 Instrument > Build New Instrument 以创建自定义仪器。您可以告诉 Instruments 在您进入一个方法时开始跟踪，并在您退出该方法时停止跟踪。自定义仪器提供的控制较少，但您无需修改​​应用程序代码即可使用它。

# iphone - NSManagedObject 属性为空

> ID：11746075
> 
> 赞同：1
> 
> 时间：2012-07-31T17:49:24.990
> 
> 标签：iphone, core-data

我有一个 UIButton 子类，我在其中将属性设置`concert`为`NSManagedObject`. 当我设置这个属性时，我确定它`NSManagedObject`不为空，并且它的属性不为空。此外，对象的数据显示正确的数据。

`concert`当单击按钮并将其发送到方法时使用后者时`sender`，我会将`sender`转换为我的子类，`UIButton`并且现在的属性`concert`将返回 null，但其`concert`本身不为 null。此外，数据将是`fault`.

有谁知道为什么会发生这种情况以及我该如何解决？

在这里，我初始化我的按钮：

`NFConcertButton *button = [NFConcertButton buttonWithConcert:concert tileSize:self.tileSize];`

在`initWithButton:tileSize:`（由静态方法调用）中，我存储了 Concert 以供以后使用。

```
- (id)initWithConcert:(NFConcert *)concert tileSize:(CGSize)tileSize
{
    if (self = [super init])
    {
        // Store concert
        _concert = concert;

       /*
         <NFConcert: 0xde67eb0> (entity: Concert; id: 0xde63f60 <x-coredata://F027F762-2F30-4A43-898B-42ECC199DE97/Concert/p2> ; data: {
           band = "SomeBand";
         })
        */

        // concert is not null
        // concert.band is not null

        // .... //
    }

    return self;
} 
```

按下按钮时，将调用以下方法，`concert`并且现在的属性为空。

```
- (void)concertButtonPressed:(id)sender
{
    NFConcert *concert = ((NFConcertButton *) sender).concert;
    // <NFConcert: 0xde67eb0> (entity: Concert; id: 0xde63f60 <x-coredata://F027F762-2F30-4A43-898B-42ECC199DE97/Concert/p2> ; data: <fault>) => (null)
    // concert is not null.
    // concert.band is now null.
} 
```

**更新：**

如果我`NSManagedObject`再次使用获取`objectId`，我将获取数据并且属性不会返回 null。我不明白为什么这是必要的。谁能告诉我？

以下将起作用。

```
NFConcert *concert = ((NFConcertButton *) sender).concert;
concert = (NFConcert *) [managedObjectContext existingObjectWithID:concert.objectID error:nil]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-01T19:21:23.620

使用 Apple 的 Core Data 堆栈的默认实现，我不再有这个问题。我相信这个问题是由[`DataManager`](https://gist.github.com/922496)我过去使用 Core Data 堆栈引起的。

# cassandra - 如何使用 CLI 在 Cassandra 中查找对象的存储大小？

> ID：11746076
> 
> 赞同：1
> 
> 时间：2012-07-31T17:49:50.597
> 
> 标签：cassandra, storage, command-line-interface

如何找出我使用 CLI 插入列族的内容的存储大小？

我想将[Cassandra](https://en.wikipedia.org/wiki/Apache_Cassandra)中对象的大小与其实际大小进行比较。

# filter - tasklist.exe 中的过滤器不使用通配符？

> ID：11746079
> 
> 赞同：22
> 
> 时间：2012-07-31T17:49:58.213
> 
> 标签：filter, cmd, windows-7, windows-8, tasklist

操作系统：Windows XP、Windows 7 64 位。

我们有一些相当庞大的 cmd 脚本，用于一些日常构建过程。这些脚本产生了许多其他（窗口）进程。有一个控制 cmd 脚本，一个小的简单脚本，它启动主 cmd 脚本。小控制脚本的目的是在主脚本或其任何子脚本失败的情况下进行清理。这很容易完成：主脚本及其所有子脚本都有以唯一标识符开头的窗口标题。当控制脚本确定主脚本及其所有子脚本应该已经完成​​时，它使用任务列表来查找任何挂起进程的窗口，通过：

tasklist.exe /FI "WINDOWTITLE eq UniqueIdentifier*"

这一切都在 XP 中运行得非常好。现在进入Windows7 64位。在这里，如果主 .cmd 脚本或任何其他 .cmd shell 窗口尝试通过以下方式设置其窗口标题

```
title UniqueIdentifier Followed By Descriptive Text 
```

Windows7 64 位在标题前添加其他文本（特别是“管理员：”或类似名称）。不能依赖前面的文本。所以现在我们要使用

```
tasklist.exe /FI "WINDOWTITLE eq *UniqueIdentifier*" 
```

但这**会失败**，并显示错误消息“无法识别搜索过滤器”。使用我们的 UniqueIdentifier 作为后缀是行不通的：命令

```
tasklist.exe /FI "WINDOWTITLE eq *UniqueIdentifier" 
```

也会导致相同的错误消息。似乎微软在过滤器中的“通配符”概念并没有超出将“*”作为终端字符的范围。哎哟。

有人有任何解决方法吗？Pslist 似乎不允许使用窗口标题进行过滤。

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-07-31T18:55:09.363

您可以使用 /V 选项在输出中包含窗口标题，然后将结果通过管道传送到 FIND（或 FINDSTR）以过滤结果。

```
tasklist /v | find "UniqueIdentifier"
tasklist /v | findstr /c:"UniqueIdentifier" 
```

如果使用 FINDSTR，那么我建议使用 /C 选项，以便您可以在搜索字符串中包含空格。

`/I`如果您需要进行不区分大小写的搜索，您可能需要使用该选项。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2019-01-23T19:09:36.250

根据我的实验，taskkill 的通配符似乎只在字符串的末尾起作用，而不是在任何其他位置。我无法以一种或另一种方式从 Microsoft 找到任何关于此的文档。但是文档中的所有示例都遵循这种格式

```
Successful:  notepad*
Fails: notepad*.exe
Fails *notepad* 
```

正如另一个答案中提到的，最好解析 tasklist 的输出以获得您想要的，而不是依赖于 taskkill 相当破碎的行为。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2020-11-21T17:40:26.737

是的，如果 是在搜索的进程名称的末尾，它可以正常工作，正如**Fiver**`*`所指出的那样。 以下是有关如何运行命令的示例：

 **```
tasklist /FI "IMAGENAME eq no*" 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-01-03T23:01:36.193

我认为这适用于 Windows 10。这是我的片段

```
set PROCNAME="Foobar"
tasklist /FI "IMAGENAME eq %PROCNAME%*" 2>NUL | find /I /N %PROCNAME%>NUL
if "%ERRORLEVEL%"=="0" (
    echo it is running
) 
```

注意过滤器中的星号。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-03-23T03:04:56.730

使用电源外壳。获取进程。如果你能处理这种力量，那就更有用了。尝试

```
get-process | where MainWindowTitle -like "*UniqueIdentifier*" | select * 
```**

# jquery - 为什么我的 jquery 嵌入在我的 html 中？

> ID：11746080
> 
> 赞同：0
> 
> 时间：2012-07-31T17:50:01.260
> 
> 标签：jquery, google-chrome, embedding

我正在使用 jquery 进行一些 ajax 调用。我在 Chrome 中工作，当我包含我的 javascript 文件时，如下所示：

```
<script src="js/collectInfo.js" type="text/javascript"></script> 
```

代码显示在元素选项卡下的我的 php 文件中。它不会在我的脚本中显示为单独的文件。本质上，就好像它被嵌入到我的代码中一样。这使得调试变得非常困难。

知道为什么会这样做吗？

更多信息：仅当我将此函数添加到 js 文件底部时才会发生这种情况

```
function sendRequest(type){

    var first_name=$('#mce_FNAME').val();
    var last_name=$('#mce_LNAME').val();
    var email=$('#mce_EMAIL').val();
    var phone=$('#mce_PHONE').val();
    var advocateID=$('#mce_SPID').val();

    $.ajax({
        data:{
            first_name:first_name,
            last_name:last_name,
            email:email,
            phone:phone,
            advocateID:advocateID,
            mode:type
        },
        url:'ajax_fp_info.php',
        type: "POST",
        dataType: "text",
        success:function(data){
            data=$.parseJSON(data);
            if(data.error != undefined){
                if(data.error !== false){
                    showError(data.error);
                }
                else{
                    $('#mc-embedded-subscribe-form').submit();                    
                }
            }
        },
        complete:function(){
            stopProcessing();

        }

    });

} 
```

这就是我的元素选项卡最终在 chrome 中的样子：

```
<script src="js/default.js." type="text/javascript"></script>
<script type="text/javascript">//<![CDATA[
var validate=new Array();$(function(){});function textFocus(sup){if($(sup).is('.pale'))    {$(sup).removeClass('pale');$(sup).val('');$(sup).attr('onclick','');}
else{}}
function validateReque... 
```

正如您所看到的，我的一些 js 文件正确显示，即它们只显示脚本标签，但其余的则混乱了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T18:30:34.590

这很明显，ajax 填充您的页面并操作您的 DOM，而这正是 Chrome 中的元素选项卡显示的内容。你可以看到你的 DOM，它不像页面的视图源。

# c# - 如何计算字符串中的分隔符？

> ID：11746083
> 
> 赞同：-3
> 
> 时间：2012-07-31T17:50:23.220
> 
> 标签：c#

我有一个问题......有点基本，但我想我可以从你们那里得到一些帮助

我正在加密一个文件，我加密的信息是

```
LoginTxtBox.Text + "/" + PwdTxtBox.Text + "/" + InstNameTextBox.Text + "/" + DBNameTxtBox.Text; 
```

当我解密它时......我正在做：

```
StringBuilder sClearText = new StringBuilder();
encryptor.Decrypt(sPrivateKeyFile, sDataFile, sClearText);

//username/password
string s = sClearText.ToString();
string[] split = s.Split(new Char[] { '/' });
if (split.Length == 4)
{
    split0 = split[0];
    split1 = split[1];
    split2 = split[1];
    split3 = split[1]; 
```

现在我得到的要求是我需要以字符串的解密格式计算分隔符，如果有超过 2 个分隔符，那么它不是一个新的应用程序。如果只有一个分隔符，那么它是一个从未使用过的应用程序。我不知道如何计算解密字符串中的分隔符...帮助我plzz

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-31T17:51:58.180

尝试使用此代码

```
Regex.Matches( s,  "/" ).Count 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-31T17:53:33.140

还有一些方法：

```
int delimiters = input.Count(x => x == '/'); 
```

-或者-

```
int delimiters = input.split('/').Length - 1; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-31T17:54:27.603

你不能在字符分隔符上拆分字符串，结果数组应该比分隔符的数量多一个吗？

# php - 发生错误后保留用户输入

> ID：11746084
> 
> 赞同：0
> 
> 时间：2012-07-31T17:50:25.170
> 
> 标签：php, jquery, forms, drop-down-menu

这是问题：

我创建了一个显示安全问题的下拉菜单。选项之一是“其他”。如果选择“其他”，下拉菜单旁边会弹出一个文本框，提示用户输入自己的安全问题。

这一切都很好，但是当用户选择“其他”并发生错误时（在表单的另一部分），向下滚动菜单仍然显示“其他”，但它旁边的文本框消失了。如果 $_POST['question'] == other，有没有办法将文本框保留在那里？

这是我的代码的摘录，如果有用的话，我可以展示更多。

```
 <script type="text/javascript">
        $(function(){
            //initially hide the textbox
            $("#other_question").hide();
            $('#dd_question').change(function() {
              if($(this).find('option:selected').val() == "0"){
                $("#other_question").show();
              }else{
                $("#other_question").hide();
              }
            });
        });
    </script> 
```

这是下拉菜单的代码（在 php 中）

```
$option_list = array(
        "1" => "In what city did your parents meet?",
        "2" => "What is your mother's maiden name?",
        "3" => "What was the name of your first pet?",
        "4" => "What is your oldest sibling's middle name?",
        "0" => "Other",
    );
foreach ($option_list as $option_id => $option) {
        echo "<option value = \"{$option_id}\" ";
        if ($option_id == $_POST['dd_question']) {
            echo " selected=\"selected\"";
        }
    echo ">{$option}</option>";
} 
```

提前感谢所有建议！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T18:02:20.653

在页面加载时始终检查其他选项而不是

```
//initially hide the textbox
            $("#other_question").hide(); 
```

做

```
//initially check the default value in dd_question
if($('#dd_question').find('option:selected').val() == "0"){
                $("#other_question").show();
              }else{
                $("#other_question").hide();
              } 
```

# objective-c - 我的 cocos2d 项目停止编译！超过40个错误！该怎么办？

> ID：11746087
> 
> 赞同：-1
> 
> 时间：2012-07-31T17:50:28.100
> 
> 标签：objective-c, ios, cocos2d-iphone

我有多个快照，甚至恢复给他们这个东西只是不会编译。它给了我 40 多个错误！我能做些什么？我根本没有改变任何东西。正如我所说，即使恢复到旧快照也无济于事，而且我有多个。我有从 Steffen Itterheim 启用 arc 的 cocos2d 库。显然问题出在 cocos2d 库本身。我能做些什么来修复这个地狱？

编辑：将我所有的代码复制到另一个项目中没有帮助。我现在准备哭了。我花了很多时间在这上面。而且我 99% 肯定我的代码没有问题，因为我有多个快照并且它们都不起作用。

在这种情况下可以做些什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T20:02:40.117

我认为您重命名了错误的文件夹。如果您使用 ARC 项目，将有两个同名文件夹，一个是另一个的子文件夹：

![在此处输入图像描述](../Images/5daa4446544c40a832ae823365a73a30.png)

您可以重命名或复制第一个文件夹（在此之前关闭 Xcode）。但是您**不能重命名子文件夹**，即与 .xcodeproj 位于同一文件夹中的子文件夹。同样，您**不得重命名 .xcodeproj**。

如果您在 Xcode 中重命名项目，则 xcodeproj 文件会自动重命名，方法是选择 Project Navigator 中的第一个条目并重命名它，就像您在 Finder 中重命名文件/文件夹一样（通过延迟双击）。

如果这不是发生在您身上的事情，您需要更具体地说明“当我更改项目文件夹时”的含义。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T18:28:36.460

通过将我的文件复制到新项目中来解决所有问题。希望对某人有所帮助。实际上我设法重现了一个问题。当我更改项目的文件夹时，一切都停止工作。如何解决？即使重命名项目文件夹也会产生相同的结果。

# javascript - 使用 JavaScript 检测 iOS 移动设备而不是自动播放音频

> ID：11746088
> 
> 赞同：1
> 
> 时间：2012-07-31T17:50:38.820
> 
> 标签：javascript, ios, audio, mobile-safari, detect

我想使用 JavaScript 检测 iOS 移动设备或移动 Safari，而不是使用 JavaScript 自动播放音频。我已经尝试过这段代码的版本，但它只是没有播放，任何关于为什么它没有播放的想法。谢谢

```
function untitledFunction3 (hypeDocument element, event) {

if( isMobile.iOS() );
var audio = new Audio("http://polyflor.squarespace.com/storage/vo/low-res-mp3/PolyFlor_1_intro_timed_sized.mp3");
audio.play();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T18:23:54.547

移动 webkit 尚不支持 Audio html5 API。

[http://caniuse.com/audio-api](http://caniuse.com/audio-api)

尝试使用 soundplayer2 之类的东西，它适用于移动 safari，相当轻量级，并且有后备功能。

[http://www.schillmania.com/projects/soundmanager2/](http://www.schillmania.com/projects/soundmanager2/)

# mysql - 特定 mysql 查询的问题

> ID：11746094
> 
> 赞同：1
> 
> 时间：2012-07-31T17:51:03.610
> 
> 标签：mysql, where

这是游戏应用程序的查询，以获取敌人的目标列表，其中不包括敌人看不到的位置。这是针对我的特定问题的查询的简化版本。

```
SELECT * FROM `game_moblist` WHERE  (posx!=0 AND posy!=0) AND (posx!=1100 AND posy!=220) 
```

posx 是 x 坐标 posy 是 y 坐标

我正在编写一个循环来排除任何看不到的图块我看到的问题是它被视为括号不存在。所有 posx=1100 都被排除在外，而不是有序对 (1100,220) 我想要做什么的正确语法是什么？我想到的唯一解决方案是将这两个数字组合成一个唯一的数字，但我宁愿学习一些新东西。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-31T18:02:55.740

我想你的意思是：

```
WHERE NOT (posx=0 AND posy=0) 
  AND NOT (posx=1100 AND posy=220) 
```

也可以改写为：

```
WHERE (posx, posy) NOT IN ((0, 0), (1100, 200)) 
```

# .htaccess - joomla htaccess 如何识别特定别名的 get 方法是什么？

> ID：11746095
> 
> 赞同：3
> 
> 时间：2012-07-31T17:51:08.963
> 
> 标签：.htaccess, joomla, alias

我正在开发一个支持 SEF url 的网站。我使用 PHP 作为服务器端语言。我知道 htaccess 基本代码如何使用它。但问题是，如果我想重写一个 php get 链接，我必须像这样将每个链接都放在 htaccess 上。

```
RewriteRule ^sign-in$ index.php?view=signin
RewriteRule ^register$ index.php?view=register
RewriteRule ^jobs$ index.php?id=2 
```

是否有任何可能的方法可以使用 htaccess 和 url 特定别名来自动化 url，而不是手动添加重写规则？像joomla的东西？我试图了解 joomla htaccess 如何与特定别名连接。但我仍然无法理解它是如何工作的。我无法理解 joomla htaccess 如何与文章别名建立关系。请帮忙。提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-31T18:04:43.607

`id`如果 an 的外观与 a 的`view`外观（在您的示例中`register`是 a`view`和`jobs`is an ）相比没有任何区别`id=2`，那么您必须单独执行一个或另一个：

要“自动化”视图，您可以尝试这样做：

```
RewriteEngine On

# all id's here:
RewriteRule ^jobs$ index.php?id=2 [L] 
RewriteRule ^something-else$ index.php?id=3 [L]
RewriteRule ^another$ index.php?id=4 [L]

# this will do all views
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ index.php?view=$1 [L] 
```

* * *

编辑：如果您需要通过一组外部别名进行这些映射，您需要查看[`RewriteMap`指令](http://httpd.apache.org/docs/current/mod/mod_rewrite.html#rewritemap)。您需要访问服务器或虚拟主机配置才能设置地图，但您的规则可以保留在 htaccess 文件中。

假设您有一个名为“joomla_maps.txt”的文本文件，如下所示：

```
jobs id=2
another id=3
sign-in view=sign-in
register view=register 
```

ETC...

`RewriteMap`您可以通过在（在 vhost/server 配置中）设置它来使用该映射

```
RewriteMap joomla txt:/path/to/joomla_maps.txt 
```

稍后在您的 htaccess 中：

```
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ index.php?${joomla:$1} [L] 
```

查看`RewriteMap`文档以获取其他类型映射的一些示例，包括执行脚本或使用 dbm 哈希映射。

# mysql - Mysql大表多日期where子句查询性能

> ID：11746096
> 
> 赞同：1
> 
> 时间：2012-07-31T17:51:10.340
> 
> 标签：mysql, performance

我有下表，其中有 200 万行。

```
CREATE TABLE `gen_fmt_lookup` (
  `episode_id` varchar(30) DEFAULT NULL,
  `media_type` enum('Audio','Video') NOT NULL DEFAULT 'Video',
  `service_id` varchar(50) DEFAULT NULL,
  `genre_id` varchar(30) DEFAULT NULL,
  `format_id` varchar(30) DEFAULT NULL,
  `masterbrand_id` varchar(30) DEFAULT NULL,
  `signed` int(11) DEFAULT NULL,
  `actual_start` datetime DEFAULT NULL,
  `scheduled_start` datetime DEFAULT NULL,
  `scheduled_end` datetime DEFAULT NULL,
  `discoverable_end` datetime DEFAULT NULL,
  `created_at` datetime DEFAULT NULL,
  KEY `idx_discoverability_gn` (`media_type`,`service_id`,`genre_id`,`actual_start`,`scheduled_end`,`scheduled_start`,`episode_id`),
  KEY `idx_discoverability_fmt` (`media_type`,`service_id`,`format_id`,`actual_start`,`scheduled_end`,`scheduled_start`,`episode_id`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1 | 
```

下面是我在这张表上运行的解释查询

```
mysql> EXPLAIN select   episode_id,scheduled_start 
from gen_fmt_lookup  
where media_type='video' 
and service_id in ('mobile_streaming_100','mobile_streaming_200','iplayer_streaming_h264_flv_vlo','mobile_streaming_500','iplayer_stb_uk_stream_aac_concrete','captions','iplayer_uk_stream_aac_rtmp_concrete','iplayer_streaming_n95_3g','iplayer_uk_download_oma_wifi','iplayer_uk_stream_aac_3gp_concrete') 
and genre_id in ('100001','100002','100003','100004','100005','100006','100007','100008','100009','100010') 
and NOW() BETWEEN actual_start and scheduled_end 
group by episode_id order by min(scheduled_start) limit 1 offset 100\G
*************************** 1\. row ***************************
           id: 1
  select_type: SIMPLE
        table: nitro_episodes_gen_fmt_lookup
         type: range
possible_keys: idx_discoverability_gn,idx_discoverability_fmt
          key: idx_discoverability_gn
      key_len: 96
          ref: NULL
         rows: 31719
        Extra: Using where; Using index; Using temporary; Using filesort
1 row in set (0.16 sec) 
```

**所以我的问题是**

*   查询执行中使用的索引是否最好？如果没有，有人可以建议更好的索引吗？
*   mysql可以在where子句中使用带有2个日期的复合索引吗？与上面的查询一样，where 子句具有条件“and NOW() BETWEEN actual_start 和 schedule_end”，但 mysql 使用的索引 'idx_discoverability_gn' 的键长度仅为 96。这意味着它仅使用 index upto ( `media_type`, `service_id`, `genre_id`, `actual_start`) 。为什么不能使用 index upto ( `media_type`, `service_id`, `genre_id`, `actual_start`, `scheduled_end`) ？
*   我还能做些什么来提高性能？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T18:00:26.670

您有范围检查，因此 (scheduled_start, actual_start, scheduled_end) 上的聚集索引可能会有所帮助。您当前的索引不是很有用。您可以摆脱它们并构建一个主键（episode_id）和另一个索引（service_id，genre-id，episode_id）

# ios - iOS：归档 NSMutableArray

> ID：11746097
> 
> 赞同：1
> 
> 时间：2012-07-31T17:51:17.700
> 
> 标签：ios, nsmutablearray, archiving, nscoder

我已经用谷歌搜索并搜索了这个，但没有直接的结果。看来我对 Apple 文档中的以下内容存在根本性的误解：

> 存档可以存储任意复杂的对象图。存档保留了图中每个对象的身份以及它与图中所有其他对象的所有关系。未归档时，重建的对象图应该是原始对象图的精确副本，除了少数例外。

假设我有一个对象`NSMutableArray`集合`Person`。每个`Person`对象都实现`initWithCoder`和`encodeWithCoder`。此外，任何给定的对象`Person`都可能具有 的一个`NSMutableArray`（类似地兼容编码）`Task`。

我的理解是有一种归档方式，从而触发任意深度的级联序列化，具体取决于编码协议的实现。所以在我的视图控制器中，我有一个`willEnterBackground`：

```
data = [NSKeyedArchiver archivedDataWithRootObject:self.people];
// persist to NSUserDefaults 
```

我有一个`viewDidLoad`这样做的：

```
// read from NSUserDefaults
self.people = [NSKeyedUnarchiver unarchiveObjectWithData:data]; 
```

这一切都会发生，但有两件事：

1.  数组包含的对象中的`initWithCoder`and永远不会被调用。`encodeWithCoder``people`
2.  不出所料，结果是`self.people`一个大小为 0 的 NSMutableArray。令人惊讶的是，未归档的数据有 252 个字节长，看起来差不多。

建议？提示？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T18:52:41.727

即使您实现了这两种方法，您是否将您的 Person 类声明在协议中？

# c# - 对 MVC 控制器感到好奇？

> ID：11746098
> 
> 赞同：2
> 
> 时间：2012-07-31T17:51:18.810
> 
> 标签：c#, asp.net-mvc, model-view-controller

只是一个简单的问题，当您为新的 MVC ASP.Net 应用程序创建新控制器时，它如何知道要使用哪个控制器。更具体地说，假设您创建了一个新控制器并将其称为 SockController 以使用我将导航到的所述控制器`http://mywebapp/sock`。Web 应用程序是如何知道 /Sock/ 链接到 SockController 的？某处有映射吗？或者，如果在创建它时从名称中调用省略控制器时会发生什么，即调用它 SockCont。

注意：我不是网络开发人员，我只是好奇，所以请不要发布包含大量文本的页面链接，我正在寻找一个简短的简单答案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T17:54:19.150

ASP.NET 路由通过获取路由值然后在末尾附加“控制器”来从 URL 中提取控制器的名称。所以“/home/”返回“HomeController”。

然后，ASP.NET 使用反射遍历项目程序集（或引用的程序集）中的每个类，以找到一个继承自 System.Web.Mvc.Controller 并称为“HomeController”的类。然后它使用默认的无参数构造函数来创建它的实例。

然后它将 Route 操作与控制器的方法相匹配。

这个过程称为“Dispatch”，在 PHP、Ruby-on-Rails 等中可以看到类似的模式，除了像那些动态语言有不同的方式将类名解析为实际对象（CakePHP 使用类自动加载绑定来定位例如类定义）。

# asp.net - ASP.NET Repeater 需要更改显示

> ID：11746102
> 
> 赞同：0
> 
> 时间：2012-07-31T17:51:37.190
> 
> 标签：asp.net

我有以下中继器：

```
 <asp:Repeater ID="rpttsk" runat="server">
                    <HeaderTemplate>
                        <tr>
                            <td>
                                <b>ID</b>
                            </td>
                            <td>
                                <b>Date</b>
                            </td>

                        </tr>
                    </HeaderTemplate>
                    <ItemTemplate>
                        <tr>
                            <td>
                                <%#Eval("ID")%>
                            </td>

                            <td>
                                <%#Eval("PerfDate", "{0:MMM d, yyyy}")%>
                            </td>

                        </tr>
                    </ItemTemplate>
                </asp:Repeater> 
```

我将代码放在文件后面的代码中

```
 Protected Sub rpttsk_ItemDataBound(ByVal sender As Object, ByVal e As System.Web.UI.WebControls.RepeaterItemEventArgs) Handles rpttsk.ItemDataBound 
```

但甚至没有点击这个子程序

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T17:54:07.040

您可以在 ItemDataBound 的代码后面设置此逻辑

```
void rpttsk_ItemDataBound(Object Sender, RepeaterItemEventArgs e) 
{
     if (e.Item.ItemType == ListItemType.Item || e.Item.ItemType == ListItemType.AlternatingItem) 
     {

     }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-31T18:00:22.690

选择要显示的颜色是一个视图问题。一般来说，我会将视图关注逻辑放入视图而不是代码背后。它允许更多的视图灵活性。它可以使维护更容易，因为对应用程序的外观更新不需要那么多二进制更新。

从技术上讲，您可以说将日期与今天进行比较的逻辑可能是一个业务逻辑问题。所以这可能是背后的代码，例如像“IsDateGreaterThanToday”这样的吸气剂。

然后你的转发器视图可以这样修改：

```
<td <%# IsViewGreaterThanToday(Eval("PerfDate")) ? "class='greater-than-today'" : ""%>>
<%#Eval("PerfDate", "{0:MMM d, yyyy}")%>
</td> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-31T18:01:00.070

我会这样做：前端：

```
<asp:Repeater ID="rpttsk" runat="server" OnItemDataBound="rpttsk_ItemDataBound">
    <HeaderTemplate>
        <tr>
            <td>
                <b>ID</b>
            </td>
            <td>
                <b>Date</b>
            </td>

        </tr>
    </HeaderTemplate>
    <ItemTemplate>
        <tr>
            <td>
                <%#Eval("ID")%>
            </td>

            <td>
                <asp:Label ID="lbl" runat="server"/>
            </td>

        </tr>
    </ItemTemplate>
</asp:Repeater> 
```

后端：

```
protected void rpttsk_ItemDataBound(object sender, RepeaterItemEventArgs e)
{
    if (e.Item.ItemType == ListItemType.AlternatingItem || e.Item.ItemType == ListItemType.Item)
    {
        YourDataType item = e.Item.DataItem as YourDataType;
        Label lbl = e.Item.FindControl("lbl") as Label;
        lbl.Text = item;
        if (DateTime.Compare(item.YourDateHere, DateTime.Now()) > 0)
        {
            lbl.ForeColor = Color.Red;
        }
        else
        {
            lbl.ForeColor = Color.Blue;
        }
    }
} 
```

如果您希望为整行着色，则必须将所有内容都放在标签中。

# php - 如何停止在 UNIX 中运行的脚本？

> ID：11746104
> 
> 赞同：3
> 
> 时间：2012-07-31T17:51:51.707
> 
> 标签：php, unix, cron, terminal

我运行了一个 php 脚本，我们以“mytestscript.php”为例。

它将连续运行几个小时。如何从终端 (UNIX) 命令行停止它？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-31T17:53:59.320

假设它在后台运行，在您的用户 ID 下：用于`ps`查找命令的 PID。然后用`kill [PID]`它来阻止它。如果`kill`它本身不能胜任这项工作，那就做`kill -9 [PID]`.

如果它在前台运行，Ctrl-C (Control C) 应该停止它。

阅读有关`ps`命令的文档并熟悉其选项。这是一个非常有用的命令。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-31T17:54:31.770

您可以尝试使用`ps -e | grep php`查找名称中包含“php”的所有进程。之后，您可以使用 ps 命令给您的数字`kill <PID>`替换。`<PID>`

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-09T16:30:59.253

如果你想要一个自动化的解决方案试试这个 -

1.创建一个新的shell脚本 -`vi killer.sh`

2.添加以下内容

```
#!/bin/bash

while true
do
  sleep $1
  ps -ef | grep mytestscript.php | grep -v grep | awk '{print $2}' | xargs kill -9  
done 
```

3.授予可执行权限`chmod +x killer.sh`

4.执行你的脚本`nohup ./killer.sh <time to sleep before killing> &`

5.离开它去海滩吧！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-31T17:55:15.733

您始终可以找到正在运行的进程的进程 ID。“ps -ef | grep mytestscript.php”。查看输出并记下进程的 pid。使用 kill pid 杀死进程。

# excel - Excel VBA打印功能插入新行/ CR

> ID：11746108
> 
> 赞同：0
> 
> 时间：2012-07-31T17:52:06.347
> 
> 标签：excel, vba

我正在尝试使用以下语句打印到文件

```
Print #1, "String1"; Tab(20); "String2"; Tab(15); "String3" 
```

这样文件读取

```
String1                    String2               String3 
```

然后开始新的一行。但是执行上述语句的实际结果是：

```
String1                    String2
               String3 
```

由于我似乎无法弄清楚的原因，在 String2 之后插入了一个新行，但不是在 String1 之后。

如果有人知道如何解决这个问题，请告诉。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T18:35:35.400

`Tab(20);`不插入 20 个标签 - 它将位置设置为“第 20 个”标签（无论在哪里）。然后您不能在同一行将其设置回 15 ......

# arrays - str_replace 用文本文件和数组

> ID：11746110
> 
> 赞同：2
> 
> 时间：2012-07-31T17:52:13.500
> 
> 标签：arrays, fopen, str-replace, explode

我很难理解这一点。我在这里和其他地方读过许多其他帖子，但我就是不明白。我想可能是因为我很难想象别人的例子。有人可以给我一些关于我在这里做错了什么的见解。

```
1\. $data = file_get_contents("rawtext.txt");
2\.   
3\. $kList[0] = "uszips.txt";
4\. $kList[1] = "cities.txt";
5\. $kList[2] = "states.txt";
6\. 
7\. foreach($kList as $replacelist)
8\. {
9\. 
10\. 
11\. $fp = @fopen($kList, 'r'); 
12\. if ($fp) { 
13\.  $array = explode("\n", fread($fp, filesize($kList))); 
14\. } 
15\. 
16\.     $replacelist = str_replace($array,"", $data);   }
17\. 
18\. // remove stuff less than 2 characters, 
19\. $data = preg_replace("!\\b\\w{1,2}\\b!", "", $data);  
20\. // remove blank lines.
21\. $data = preg_replace("/(^[\r\n]*|[\r\n]+)[\s\t]*[\r\n]+/", "\n", $data);
22\. 
23\. //save it back:
24\. file_put_contents("stripped.txt",$data); 
25\. 
```

@DarkXphenomenon 我收到这些通知

*   注意：未定义的变量：第 16 行 C:\xampp\htdocs\tools\str_replace.php 中的数组
*   注意：未定义的变量：第 16 行 C:\xampp\htdocs\tools\str_replace.php 中的数组
*   注意：未定义的变量：第 16 行 C:\xampp\htdocs\tools\str_replace.php 中的数组

感谢@提示。我删除了它，现在我又得到了这个。

*   警告：fopen() 期望参数 1 是字符串，在 C:\xampp\htdocs\tools\str_replace.php 中给出的数组在线
*   警告：fopen() 期望参数 1 是字符串，在 C:\xampp\htdocs\tools\str_replace.php 中给出的数组在线

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T18:24:54.147

好吧，这只能意味着文件本身没有打开读取。如果它输入了以下内容，则 $array 将被设置。

```
if ($fp) { 
 $array = explode("\n", fread($fp, filesize($kList))); 
} 
```

所以你应该检查文件是否真的存在。在测试时，您应该删除错误抑制`@`，因为它会使调试更快。

**编辑：**在您的`for-each`循环中，您应该在内部使用 $replacelist 变量，而不是整个数组。它应该是

```
foreach($kList as $replacelist)
{
$fp = @fopen($replacelist, 'r');
... 

} 
```

# javascript - 需要帮助在 javascript 中获取包含的 jsp 页面的名称

> ID：11746112
> 
> 赞同：0
> 
> 时间：2012-07-31T17:52:29.277
> 
> 标签：javascript, jsp, iframe, jsp-fragments

我有一个 .jsp 页面的代码：

```
<f:view>
<div class="portletBody">
<h:form id="editSectionForm"  onsubmit="return numCheck(document.forms[0].elements['editSectionForm:sectionTable:0:maxEnrollmentInput'].id)">

    <sakai:flowState bean="#{editSectionBean}"/>

    <t:aliasBean alias="#{viewName}" value="editSection">
        <%@ include file="/inc/navMenu.jspf"%>
    </t:aliasBean>

    <h3><h:outputText value="#{msgs.edit_section_page_header}"/></h3>

    <%@ include file="/inc/globalMessages.jspf"%>

    <t:aliasBean alias="#{bean}" value="#{editSectionBean}">
        <%@ include file="/inc/sectionEditor.jspf"%>
    </t:aliasBean>

    <t:div styleClass="act">
        <h:commandButton
            action="#{editSectionBean.update}"
            value="#{msgs.update}"
            styleClass="active"
            onclick="reEnableLimits();" />

        <h:commandButton action="overview" value="#{msgs.cancel}" immediate="true" />
    </t:div>
</h:form>
</div>
</f:view> 
```

我有一些在 /inc/sectionEditor.jspf 文件中运行的 javascript 代码。在 sectionEdtior 文件中的某些代码中，我需要以某种方式获取此表单的 id。**编辑SectionForm**。我无法对其进行硬编码，因为 /inc/sectionEditor.jspf 代码在不止一页中运行。

非常多，我需要 /inc/sectionEditor.jspf 中的 javascript 代码才能获取它当前所在表单的 id。

IE：

如果我在 editSectionForm 页面中，它会告诉我我在那个页面中，如果我在 addSection Form 页面中，它会告诉我我在那个页面上。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T18:28:11.507

我看到你已经`document.forms[0]`在你的jsp页面中使用了，所以，假设只有一个表单，你也可以在你的“子页面”的脚本部分使用相同的结构，即使用`document.forms[0].id`会给你表单的ID。

```
<!DOCTYPE html>
<html>
    <body>
        <form id="editSectionForm">
            <div id="sectionEditor">
                <script type="text/javascript">
                    var formId = document.forms[0].id;
                    console.log(formId);
                </script>
            </div>
        </form>
    </body>
</html> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T18:07:17.737

我实际上为我的情况想出了另一种方法。对于曾经使用过 Sakai 的任何人来说，他们都知道它是什么野兽。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-31T18:02:18.130

我不确定我是否完全理解这个问题。您是否正在尝试获取您所在的当前页面，如 url 中的？

[http://css-tricks.com/snippets/javascript/get-url-and-url-parts-in-javascript/](http://css-tricks.com/snippets/javascript/get-url-and-url-parts-in-javascript/)

或者您在同一页面上有多个表单？

# paypal - 使用信用卡付款时，PayPal 付款页面挂起

> ID：11746113
> 
> 赞同：1
> 
> 时间：2012-07-31T17:52:29.693
> 
> 标签：paypal, checkout

我们与已经工作多年的 PayPal 进行了有效的集成。今天我们尝试通过 PayPal 结帐产品并使用信用卡付款，但在成功完成信用卡表单后，显示“加载”图标，但页面永远挂起。我检查了 PayPal 帐户，但没有进行交易。这是我在结帐过程中使用的测试产品：[http:](http://www.ajhockey.com/catalog/item/6945045/9451792.htm) //www.ajhockey.com/catalog/item/6945045/9451792.htm 还有其他人有这个问题吗？任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T03:31:36.187

如果您有一个激进的弹出窗口阻止程序，这可能是问题的原因。更好的 Chrome 弹出窗口阻止程序导致了我这个问题。

# jquery - ATM 样式小数位

> ID：11746114
> 
> 赞同：3
> 
> 时间：2012-07-31T17:52:30.277
> 
> 标签：jquery, textbox, numbers, decimal

从 2003 年开始，我正在努力让一段[旧代码](http://www.sitepoint.com/forums/showthread.php?126541-ATM-style-decimal)正常工作。我正在尝试复制一个 ATM 风格的十进制文本框。该代码声称已为某人工作，但我在实现它时遇到了麻烦。

也许有人有更好的方法来实现这一目标？也许在 jQuery 中？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-01T11:31:27.383

这就是我将如何解决它：http: [//jsfiddle.net/77bMx/86/](http://jsfiddle.net/77bMx/86/)

*   处理数字键盘输入以及标准数字键
*   与退格一起使用
*   如果您以某种方式设法产生非法输入（例如退格太多），将恢复为 0.00

基本思想是截取任何输入到框，确保其类型正确（数字或退格），然后将其添加到支持存储字符串 ( `var input`)，然后格式化该字符串以正确显示。用户从不*直接*在文本框中输入任何内容，因为我`return false`在事件处理程序的末尾使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-01T11:27:36.023

好吧，处理输入的代码可以很容易地写成这样：

```
$("#number").keyup(function(e){
    var number = $("#number").val();
    var newValue = (Math.round(parseFloat(number)*100)/100)/100;
}); 
```

在不发生冲突的情况下将其放回文本框可能是一个挑战，但是您可以通过执行以下操作来“伪造”它：

[http://jsfiddle.net/AnfCn/1/](http://jsfiddle.net/AnfCn/1/)

*免责声明：又快又脏*

# c# - "System.Collections.Generic.List`1" SerializationBinder BindToType

> ID：11746116
> 
> 赞同：1
> 
> 时间：2012-07-31T17:52:44.240
> 
> 标签：c#, serializationbinder

我有一个 Web 服务，它将以下内容作为字节数组序列化并返回给客户端：

```
[Serializable]
public class MyFile
{
  public byte[] Data;
  public string FileName;
} 
```

也就是说，我将**List(Of MyFile)**返回给客户端。

它由具有以下 TYPENAME 的客户端使用

```
System.Collections.Generic.List`1[[NorwayTaxService.Streaming+MyFile, NorwayTaxService, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]] 
```

程序集名称为：

```
mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089 
```

我正在使用以下两个类来绑定反序列化：

```
[Serializable]
public class MyFileLocal : ISerializable
{
  public byte[] Data;
  public string FileName;

  // The security attribute demands that code that calls 
  // this method have permission to perform serialization.
  [SecurityPermissionAttribute(SecurityAction.Demand, SerializationFormatter = true)]
  void ISerializable.GetObjectData(SerializationInfo info, StreamingContext context)
  {
    info.AddValue("Data", Data);
    info.AddValue("FileName", FileName);
  }

  // The security attribute demands that code that calls   
  // this method have permission to perform serialization.
  [SecurityPermissionAttribute(SecurityAction.Demand, SerializationFormatter = true)]
  private MyFileLocal(SerializationInfo info, StreamingContext context)
  {
    Data = (byte[])info.GetValue("Data", Data.GetType());
    FileName = info.GetString("FileName");
  }
}

sealed class MyFileWebToLocalVersionBinder : SerializationBinder
{
  public override Type BindToType(string assemblyName, string typeName)
  {
    Type typeToDeserialize = null;

    // For each assemblyName/typeName that you want to deserialize to 
    // a different type, set typeToDeserialize to the desired type.
    String assemVer1 = Assembly.GetExecutingAssembly().FullName;
    String typeVer1 = "NorwayTax.Streaming+MyFile";

    if (assemblyName == assemVer1 && typeName == typeVer1)
    {
      // To use a type from a different assembly version,  
      // change the version number. 
      // To do this, uncomment the following line of code. 
      // assemblyName = assemblyName.Replace("1.0.0.0", "2.0.0.0");

      // To use a different type from the same assembly,  
      // change the type name.
      typeName = "MyFileLocal";
    }

    typeToDeserialize = Type.GetType(String.Format("{0}, {1}", typeName, assemblyName));

    return typeToDeserialize;
  }
} 
```

但是对于我的一生，并尝试了 GETTYPE 语句的许多变体，我的 TYPE 始终为 NULL。

例如，根据 STACKOVERFLOW 上的帖子，我尝试过：

```
typeToDeserialize = Type.GetType(String.Format("{0}, {1}", "System.Collections.Generic.List`1[[NorwayTax.Streaming+MyFile, NorwayTax]]", assemblyName)); 
```

但它没有用:(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-01T17:41:41.723

我尝试反序列化的对象类型在客户端应用程序/程序集中不存在。我认为通过使用`SerializationBinder`我可以将其转换为类似的对象。

这是对象，它是一个序列化的列表/集合：

```
using System;

namespace NorwayTax
{
  public class NorwayTaxFiles
  {
    [Serializable]
    public class NorwayFile
    {
      public string FileName { set; get; }
      public byte[] Data { set; get; }
    }
  }
} 
```

也许可以将它放入一个类似的集合中，但是，对于我的一生，我无法做到这一点。

我最终所做的是将上述内容隔离到它自己的 DLL 中，我的 Web 服务和客户端都引用了它，它可以完美地工作并且不需要`SerializationBinder`.

最后，本练习的重点是使用框架工具一次性从 Web 服务传递多个文件。有趣的是，我传递的文件已经使用**7z**进行了压缩，但根据业务要求将其分解为一个存档集（.001、.002 等）。

我的解决方案的灵感来自这个答案：[你真的应该在其中定义一个类库并引用同一个程序集](https://stackoverflow.com/a/6776538/890266)。

# iphone - 根据 UITextView 框架大小调整文本

> ID：11746119
> 
> 赞同：0
> 
> 时间：2012-07-31T17:52:47.853
> 
> 标签：iphone, objective-c, ios, ipad, uitextview

我正在尝试调整 UITextView 中文本的大小以使其适合。我有以下代码：

```
NSString *storyTitle = [newsfeedToSubject.properties valueForKey:@"title"];

    int currentFontSize = 18;
    UIFont *currentFont = [UIFont fontWithName:kProximaNovaBold size:currentFontSize];
    CGSize storyTitleSize = [storyTitle sizeWithFont:currentFont constrainedToSize:self.newsfeedStoryTitle_.frameSize lineBreakMode:UILineBreakModeWordWrap];

    while (storyTitleSize.height >= self.newsfeedStoryTitle_.frameHeight){
        currentFontSize--;
        currentFont = [UIFont fontWithName:kProximaNovaBold size:currentFontSize];
        storyTitleSize = [storyTitle sizeWithFont:currentFont constrainedToSize:self.newsfeedStoryTitle_.frameSize lineBreakMode:UILineBreakModeWordWrap];
    }

    [self.newsfeedStoryTitle_ setFont:currentFont];
    [self.newsfeedStoryTitle_ setText:storyTitle];
    [self.newsfeedStoryTitle_ setBackgroundColor:[UIColor redColor]]; 
```

但是，这就是我得到的：

![在此处输入图像描述](../Images/30ba517e6e913e5e7362c6d9a4b8edfd.png)

我尝试了不同的换行模式并将自动调整大小设置为无，但它没有帮助。任何的想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T18:08:49.153

您的 while 循环不会执行您想要的操作，因为您使用 `storyTitleSize.height` 的是确定框架的大小，这不会考虑文本的环绕效果。一种建议是截断字符串并仅显示一定数量的标题字符。否则，您将需要根据框架的宽度和字符串的长度计算将有多少换行符，并使用

```
while(storyTitleSize.height * numLineBreaks >= self.newsFeedStoryTitle_.frameHeight)
{
    ...
} 
```

希望有帮助。

您还可以在此[线程中动态调整框架（UITextView）的大小](https://stackoverflow.com/questions/50467/how-do-i-size-a-uitextview-to-its-content)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T18:08:55.043

试试这些代码

```
while (self.textView.contentSize.height >= frameHeight){
    currentFontSize--;
    currentFont = [UIFont fontWithName:kProximaNovaBold size:currentFontSize];
    [self.textView setFont:currentFont];
    self.textView.text = @"your string";
} 
```

# javascript - Javascript：附加字符串中的事件，闭包中的变量评估

> ID：11746120
> 
> 赞同：1
> 
> 时间：2012-07-31T17:52:48.790
> 
> 标签：javascript, closures, variable-declaration

我很肯定我以错误的方式问了这个问题。我正在尝试将字符串传递`onClick="someFunc(arg1,arg2...)"`给 javascript 解析器。

解析器应该为带有 args (arg1, arg2 etc) 的 someFunc 创建一个 onClick 事件。

我的问题是，当文本通过解析器传递时，保存 someFunc 字符串名称的变量的范围正在被传递，以便附加事件都注册为最后声明的字符串。

在下面的代码中，attributes._onClick 可以是字符串 'onClick="someFunc(arg1,arg2);" 对于一个元素，后跟 'onClick="otherFunc(argA,argB);" 对于另一个元素，因为解析器在字符串中移动。

浏览器 (Firefox V14.01) 中的输出具有始终注册为 otherFunc 的事件函数。所以闭包中的 f_name 不是作为变量进行评估，而是只是注册为在整个块解析过程中声明的 f_name 的最后一个值。

我不熟悉范围到我需要弄清楚这一点的程度。有谁知道我可以以这种方式附加事件的方法（我试图避免超出解析器来添加事件）？

```
 temp = attributes._onClick ;
            var x = 0 ;
            var f_name,f_args ;
            while(temp[x] != '') {
                temp[x] = temp[x].replace(')','').split('(') ;//remove paranthesis and separate func name from args
                f_name = temp[x][0] ;
                f_args = temp[x][1].split(',') ;//turn string of args into array
                el.onclick = function() { window[f_name].apply(el,f_args) ; }
                x++ ;
            } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T18:00:39.890

您正在绊倒 JavaScript 中的一个陷阱，该陷阱在某些时候以各种不同的方式对几乎每个人造成相同的问题。

变量“f_name”在您创建的所有函数之间**共享。**也就是说，虽然循环的每次迭代都会创建一个新函数，但只有一个“f_name”。因此，所有函数都在其中看到相同的值，即上次迭代时的值。

有几个相关的解决方案。一种方法是将建立事件处理程序的语句包装在另一个匿名函数中，您可以立即调用该函数。这将允许您创建一个“f_name”的**副本**，供一个处理程序独占使用。

```
 el.onclick = function(name) {
                return function() { window[name].apply(el,f_args) ; };
               }(f_name); 
```

有趣的是，这个问题在 SO 上可能有数百种变体。

# shell - 使用 gawk 将系统主机名（不带换行符）添加到字符串中

> ID：11746123
> 
> 赞同：0
> 
> 时间：2012-07-31T17:52:59.793
> 
> 标签：shell, awk, gawk

我正在尝试使用 gawk 将系统主机名添加到字符串中。我不在，我可以做这样的事情：

```
interesting_command.sh|gawk 'print system("hostname") "\t" $0' 
```

但这最终会打印：

```
hostname.example.com
    Line 1 text
hostname.example.com
    Line 2 text 
```

等等

理想情况下，我正在寻找`hostname`任何换行符或空白字符的输出。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T18:05:28.273

这个怎么样

```
echo "1
2
3" |awk 'BEGIN{"hostname" | getline hstnm ; }; {print hstnm "\t" $0}'
myhost       1
myhost       2
myhost       3 
```

这里的计划是使用 将主机名的输出捕获到 var (hstnm) 中`getline`，然后使用该变量根据需要打印值。我有一半希望将 a`sub(/\n$/, "", hstnm)`作为 BEGIN 语句的一部分，但正如您所见，这不是必需的。

IHTH。

# c++ - 为引用返回访问器定义获取和设置行为

> ID：11746124
> 
> 赞同：1
> 
> 时间：2012-07-31T17:53:07.340
> 
> 标签：c++, interface, reference, operator-overloading

作为几个较大项目的一部分，我正在开发一个矩阵模板类，该类仅在块中元素的值从定义的初始值设定项值更改时动态分配块。这个类将用于一些相当复杂的数学，所以我试图让界面尽可能简单和直观。我希望能够使用 operator(row, col) 通过引用而不是使用 get(row, col) 和 set(element) 方法来访问矩阵元素。

然而，这变得有问题，因为由于分配行为，set 和 get 的操作需要不同，并且需要根据初始化程序值测试设置的值。这不能仅仅返回一个引用来完成，所以我创建了一个包含引用并且可以转换为正确的数据类型并返回它的帮助类。这是接口的结构：

```
template <class T>
class Container{

public:

    // Element class which contains a reference to a data element
    class Element{

    public:

        // Constructor -- Initialize the element reference
        Element(T & element) :  _element(element){}

        // Assignment operator -- SET
        Element & operator=(const T & that){
            _element = that;
            return *this;
        }

        // Element to element assignment -- GET that, SET this
        Element & operator=(const Element & that){
            this->_element = that._element;
            return *this;
        }

        // Implicit conversion operator -- GET
        operator T(){
            return _element;
        }

    private :

        T & _element; // Element reference

    };

    // Return an element class containing a reference to the element
    Element operator()(int index){
        return Element(_data[index]);;
    }

private:

    T _data[10];

}; 
```

它依赖于隐式转换才能使用返回的 Element 类，就好像它是类型 T不进行隐式转换，操作会导致编译器错误。而且我假设我会发现许多进一步的问题，试图将它与 T 一起用作类结构、指针等。

再加上依赖隐式转换来纠正类的功能似乎是非常糟糕的做法，这让我认为我需要想出另一种方法。有什么办法可以解决我目前的方法吗？我可能会采取其他一些方法吗？或者我应该放弃这一点，让 operator(row, col) 像往常一样分配 get 和 set 方法，只在必要时分配？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T20:23:03.583

你能为你做的魔法只有这么多。

我想首先向您指出[Blitz++](https://sourceforge.net/projects/blitz/)和[Thrust](http://thrust.github.com/)作为一些很好的教学示例。在第一种情况下，那些“魔术引用”被大量用于通过子数组访问数据区域等。第二种情况用于安全地访问来自其他内存空间（例如在 GPU 中）的数据，自动处理数据下载/上传。

我建议关注常见用法；您的容器是否主要用于保存标量值？然后只需提供常见的算术运算，例如 ++、+= 等，转发到实际实现。您会看到这是[2](http://thrust.github.com/)中使用的方法。缺点是访问内部数据的成员有点不方便 - 但如果这是一种不常见的情况，那将是一个很好的权衡。

# ruby-on-rails - 如何设置多个 Rails 应用程序进行开发？

> ID：11746126
> 
> 赞同：4
> 
> 时间：2012-07-31T17:53:24.037
> 
> 标签：ruby-on-rails, nginx, rvm, thin

对于我目前正在开发的网站，我们有 2 个 Rails 3.2 项目。一个项目基本上是一个 API，另一个是 Web 前端。为了在 Web 前端进行开发，我需要运行 API 项目。我尝试使用[工头](https://github.com/ddollar/foreman)和[分包商](https://github.com/pitluga/subcontractor)gem 来管理这个，但它似乎不起作用。这两个项目都运行瘦应用服务器并拥有自己的 RVM gemset。我们还在生产环境中运行 Nginx。

您将如何管理此设置以进行开发？我希望有 1 个命令来启动所有内容，类似于 Foreman 的工作方式。

要求：

*   RVM 支持
*   薄有利于发展
*   我可以从 API 应用程序运行一个命令来启动两个应用程序
*   无法使用 Pow（它似乎总是挂断并且速度非常慢）
*   安装程序应该适用于其他开发人员，只需最少的设置（易于编写脚本）
*   适用于 OSX

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-01T01:56:05.683

tmuxinator 允许您轻松配置 tmux 会话，该会话可以使用包含任意数量的窗口（选项卡）的单个命令启动，并在每个窗口中执行命令（如启动服务器）。只需将其配置为为适当的 rails 服务器加载适当的 gemset。

[https://github.com/aziz/tmuxinator](https://github.com/aziz/tmuxinator)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-27T20:19:14.660

您提到的工具的另一个非常酷的替代品是[Invoker](http://invoker.codemancers.com/ "调用者")。

值得一试，因为它允许一次运行多个进程（以及终止它们），就像它一样`foreman`，它提供`.dev`了模仿`pow`行为的域。

# routing - 在 spin.js 中更改路由分隔符

> ID：11746129
> 
> 赞同：1
> 
> 时间：2012-07-31T17:53:53.023
> 
> 标签：routing, spine.js

如何将 spin.js 中的路由分隔符从“#”更改为“#！”？有没有任何类型的设置？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T20:44:39.650

我可以使它工作的唯一方法是编辑 route.coffee 并更改

`hashStrip = /^#*/`

至

`hashStrip = /^#!*/`

# jasper-reports - 累计百分比

> ID：11746130
> 
> 赞同：0
> 
> 时间：2012-07-31T17:53:56.447
> 
> 标签：jasper-reports, ireport

```
 药物项目计数 总成本 成本/项目 % 总成本 累计 % 总成本
 优泌乐 10 250 $25.00 6.7% 6.7%
 Novolog 5 100 $20.00 2.7% 9.4%
 阿皮德拉 20 600 $30.00 16.1% 25.5%
 Velosulin 10 800 $80.00 21.5% 47.0%
 来得时 50 1200 $24.00 32.3% 79.3%
 勒维米尔 35 770 $22.00 20.7% 100.0%

```

我在 iReport 中有一个详细信息带，可以成功计算每件商品的成本和总成本的百分比——参见上面的模型。对于总成本的百分比，我取 $F{cost}/$V{sum_all_costs}。不过，我在总成本的累积百分比方面遇到了一些麻烦。我可以得到一个显示累积和的变量：

```
Name: RUNNING_SUM
Calculation: Sum
Reset type: Report
Increment type: None
Variable Expression: $F{cost}
Evaluation Time: Now <-- when the variable is used in the detail band 
```

关于如何获取这个累积总和并获得累积百分比的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T21:18:37.020

显示运行总数很简单（正如您在问题中所展示的那样）。运行百分比的问题是您需要先知道总数。正如您所指出的，从概念上讲，您需要稍后评估分母。但没有办法具体说明。

当我过去这样做时，我是这样做的：将您当前的整个报告视为子报告。报告中唯一需要的更改是添加一个名为 $P{GrandTotal} 的参数。然后创建一个重新使用相同查询的全新报表。它计算 GrandTotal 并将其传递给子报表。主报表根本不需要任何显示元素。现在子报表将总计作为参数，您可以将运行百分比设置为`$F{RUNNING_SUM} / $P{GrandTotal}`.

注意：主报表实际上并不需要运行完全相同的查询。使用修改后的查询来计算数据库中的总数可能是有意义的。只要它以某种方式计算总数，您就可以了。

# drupal-7 - 用于谷歌购物的 Ubercart XML 提要

> ID：11746134
> 
> 赞同：2
> 
> 时间：2012-07-31T17:54:16.480
> 
> 标签：drupal-7, drupal-views, google-shopping-api

我目前正在尝试从 Ubercart 创建一个产品提要，以便通过视图进行 Google 购物。我无法通过 Google 或其他堆栈溢出问题找到合适的答案。

有没有人这样做过？你是怎么做到的？你需要额外的模块吗？如果是，是哪些？

**使用的模块：** Drupal 7 Ubercart 7.x-3.1 视图 7.x-3.3

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-09T06:51:24.503

阅读这篇文章：

[ubercart-and-google-merchant 整合](http://www.buentec.com/knowledge/ubercart-and-google-merchant-integration)

# vb.net - 文件写入输出因机器而异

> ID：11746144
> 
> 赞同：0
> 
> 时间：2012-07-31T17:54:47.123
> 
> 标签：vb.net, compiler-construction, compilation, fixed-length-record

我整理了一个 vb.net 程序，它进行一些字符串解析并在最后创建一个固定宽度的文件。当我在两台机器上运行它时，它会创建一个格式正确的文件。当我的客户下载 msi 文件，安装并运行它时，他在文件的每条记录上获得了几个额外的空格，并且每个记录的空格数不一致。这是代码，虽然它在我这边运行良好，所以我认为它可能与编译器有关？

```
'For each T2 record,
    For i = 0 To frmMain.SquirrelDataSet.PayDataExceptions.Rows.Count - 1

        frmMain.ProgressBar1.PerformStep()

        'Join Fname and Lname into FullName.
        Dim FullName As String = frmMain.SquirrelDataSet.PayDataExceptions.Rows(i).Item("Lname") & "," & frmMain.SquirrelDataSet.PayDataExceptions.Rows(i).Item("Fname")

        If FullName = Nothing Then
            FullName = ""
        End If
        'FullName = FullName(FullName.PadLeft(25, " "))
        FullName = FullName.PadLeft(25, " ")

        objWriter.Write(frmMain.SquirrelDataSet.PayDataExceptions.Rows(i).Item(0) & _
                        FullName & _
                        frmMain.SquirrelDataSet.PayDataExceptions.Rows(i).Item(2) & _
                        frmMain.SquirrelDataSet.PayDataExceptions.Rows(i).Item(3) & _
                        frmMain.SquirrelDataSet.PayDataExceptions.Rows(i).Item(4) & _
                        frmMain.SquirrelDataSet.PayDataExceptions.Rows(i).Item(5) & _
                        frmMain.SquirrelDataSet.PayDataExceptions.Rows(i).Item(6) & _
                        frmMain.SquirrelDataSet.PayDataExceptions.Rows(i).Item(7) & _
                        frmMain.SquirrelDataSet.PayDataExceptions.Rows(i).Item(8) & _
                        frmMain.SquirrelDataSet.PayDataExceptions.Rows(i).Item(9) & _
                        frmMain.SquirrelDataSet.PayDataExceptions.Rows(i).Item(10) & _
                        frmMain.SquirrelDataSet.PayDataExceptions.Rows(i).Item(11) & _
                        frmMain.SquirrelDataSet.PayDataExceptions.Rows(i).Item(12) & _
                        frmMain.SquirrelDataSet.PayDataExceptions.Rows(i).Item(13) & _
                        frmMain.SquirrelDataSet.PayDataExceptions.Rows(i).Item(14) & _
                        frmMain.SquirrelDataSet.PayDataExceptions.Rows(i).Item(15) & _
                        frmMain.SquirrelDataSet.PayDataExceptions.Rows(i).Item(16) & _
                        frmMain.SquirrelDataSet.PayDataExceptions.Rows(i).Item(17) & _
                        frmMain.SquirrelDataSet.PayDataExceptions.Rows(i).Item(18) & _
                        frmMain.SquirrelDataSet.PayDataExceptions.Rows(i).Item(19) & _
                        frmMain.SquirrelDataSet.PayDataExceptions.Rows(i).Item(20) & _
                        frmMain.SquirrelDataSet.PayDataExceptions.Rows(i).Item(21) & _
                        frmMain.SquirrelDataSet.PayDataExceptions.Rows(i).Item(22) & vbCrLf)
    Next 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T18:00:21.893

您的客户很可能在他们的数据中有额外的空白，而这些空白不存在于您的数据中。

`.Trim()`您可以在写入数据之前尝试ing 数据。

# c++ - 如何将 Platform::String 转换为 char*？

> ID：11746146
> 
> 赞同：18
> 
> 时间：2012-07-31T17:54:48.960
> 
> 标签：c++, character-encoding, microsoft-metro, windows-runtime, c++-cx

如何转换 Platform::String 的内容以供需要基于 char* 字符串的函数使用？我假设 WinRT 为此提供了帮助函数，但我找不到它们。

谢谢！

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-04-12T20:36:20.503

这是在代码中执行此操作的一种非常简单的方法，无需担心缓冲区长度。**仅当您确定要处理 ASCII 时才使用此解决方案**：

```
Platform::String^ fooRT = "aoeu";
std::wstring fooW(fooRT->Begin());
std::string fooA(fooW.begin(), fooW.end());
const char* charStr = fooA.c_str(); 
```

请记住，在此示例中，`char*`位于堆栈中，一旦离开范围就会消失

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-07-31T18:01:27.507

`Platform::String::Data()`将返回一个`wchar_t const*`指向字符串内容的指针（类似于`std::wstring::c_str()`）。 `Platform::String`表示一个不可变的字符串，因此没有访问器来获取`wchar_t*`. 您需要复制其内容，例如复制到 中`std::wstring`，以进行更改。

因为使用宽字符（所有 Metro 风格的应用程序都是 Unicode 应用程序），所以没有*直接*的方法来获得 a`char*`或 a 。您可以使用.`char const*``Platform::String``WideCharToMultiByte`

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2015-09-11T04:03:22.580

您不应该将宽字符转换为字符，您将使用每个字符超过一个字节的语言来破坏语言，例如中文。这里是正确的方法。

```
#include <cvt/wstring>
#include <codecvt>

Platform::String^ fooRT = "foo";
stdext::cvt::wstring_convert<std::codecvt_utf8<wchar_t>> convert;
std::string stringUtf8 = convert.to_bytes(fooRT->Data());
const char* rawCstring = stringUtf8.c_str(); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-31T18:00:54.603

有`String::Data`方法返回`const char16*`，它是原始的 unicode 字符串。

从 unicode 到 ascii 或其他什么的转换，即`char16*`到`char*`，是另一回事。您可能不需要它，因为现在大多数方法都有自己的`wchar`版本。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-11-14T11:09:09.570

使用[wcstombs](http://www.cplusplus.com/reference/cstdlib/wcstombs/)的解决方案：

```
Platform::String^ platform_string = p_e->Uri->AbsoluteUri;
const wchar_t* wide_chars =  platform_string->Data();
char chars[512];
wcstombs(chars, wide_chars, 512); 
```

# jquery - 计算 prev() 的 jquery 高度并将其与当前相加或相减

> ID：11746150
> 
> 赞同：1
> 
> 时间：2012-07-31T17:54:58.850
> 
> 标签：jquery, dynamic, height, slide

我有一个名为 myDiv 的 CSS 类，当单击缩略图时它会向下滑动：

```
#myDiv
{
  height:800px;
  margin:0 auto;
  width:100%:
} 
```

当用户点击缩略图时，缩略图`myDiv`将显示为 800 像素高。因为有多个不同高度的缩略图图像，`myDiv`例如单击缩略图 1 将使`myDiv`700 像素高，而缩略图 2 将 200 像素高，有没有办法使用 jQuery 动态计算高度？

由于我不精通这种语言，我只能描述场景，所以这里......

jQuery： 1\. 点击 1：点击缩略图 1 时，获取类的高度`myDiv`= 700px 并向下滑动 2.点击 2：点击缩略图 2 时，获取上一个类（700px）和当前类（200px）的高度并减去彼此确定向上或向下滑动的值（700px - 200px = 500px）。

有没有办法计算之前和当前的高度，`myDiv`以便它向上或向下滑动到相应的高度？

非常感激您的帮忙。

编辑：CSS 和 jQuery

```
#box
{
max-width:1140px;
margin: 0 auto;
display: inline-block;

}

html[xmlns] #portfoliocontainer {
display: block;
}

* html #portfoliocontainer {
height: 1%;
}

#portfoliocontainer:after {
clear: both;
content: ".";
display: block;
height: 0;
line-height: 0;
visibility: hidden;
} 
```

jQuery是：

```
$('#box').hide();
$('#myDiv').hide();
$('.portfolio-area').click(function(){
$('#myDiv').hide();

$('#box').slideDown('slow');
$('#myDiv').fadeTo('slow',1);

}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T19:17:32.230

我认为你需要的是一个clearfix。您可以 clearfix #portfolio div conainer 并删除定义的高度，然后一切都很好

[http://www.webtoolkit.info/css-clearfix.html](http://www.webtoolkit.info/css-clearfix.html)

投资组合 div 内部的 li 是浮动的，因此 div 没有获得 clearfix 将修复的任何高度，那么高度将是动态的而不定义它。

对于一个简单的测试添加这个并删除添加高度部分

```
#portfoliocontainer:after {
    clear: both;
    content: ".";
    display: block;
    height: 0;
    line-height: 0;
    visibility: hidden;
} 
```

您应该创建 clearfix 类并将其添加到该 id

# wcf - WCF 和 HMACMD5 身份验证和 Uri 已更改

> ID：11746153
> 
> 赞同：0
> 
> 时间：2012-07-31T17:55:04.653
> 
> 标签：wcf, rest

我在 RESTFul wcf 服务上使用 HMACMD5 身份验证。部分签名基于请求的资源或客户端请求的完整 url。

然后我尝试验证服务中的签名。由于请求的 URL 是签名的一部分，我需要得到它。我正在尝试通过以下方式获取原始网址：

```
WebOperationContext.Current.IncomingRequest.UriTemplateMatch.ToString();
WebOperationContext.Current.IncomingRequest.UriTemplateMatch.RequestUri.OriginalString; 
```

这并不总是有效。我认为这可能是一个域问题，因为这只是在同一域上使用 SSL 的测试服务器上的测试阶段。

例如，当我发送过去

_https://www.mytestingserver.com/GetResource/xxx/xxx

我真的在写

_https://MYTESTSERVER-DMZ/xxx/xxx

登录我的服务。

我该如何测试这一点，更重要的是，如何确保我始终可以在重写后获得客户端在签名中使用的内容以及您拥有的内容，因为它不在：

```
incomingRequestContext.UriTemplateMatch.RequestUri.OriginalString; 
```

我已经开始记录几乎所有内容，`WebOperationContext`并`OperationContext`尝试在 Web 服务器上获取它。

任何帮助表示赞赏。谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T18:37:43.993

供参考

我可以浏览这篇文章：

[允许访问 WCF REST 服务中的 HttpContext](http://www.west-wind.com/weblog/posts/2011/Jan/10/Allowing-Access-to-HttpContext-in-WCF-REST-Services)

这行得通，但也许有更好的方法而不改变底层协议。

# sql - 何时为 null 显示自定义文本 其他情况下显示 id

> ID：11746154
> 
> 赞同：0
> 
> 时间：2012-07-31T17:55:04.793
> 
> 标签：sql, sql-server, sql-server-2008

我有一个查询，当没有匹配的项目 ID 时，我似乎无法让它显示“无项目”：

```
(select (case when prj.Proj_ID is null or prj.Proj_ID =  '' 
    then 'No Project' 
    ELSE prj.Proj_ID + ', ' + prj.[DESC] 
    END) 
from prj 
where prj.Proj_ID = other.Proj_ID)  as 'Project Description' 
```

任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-01T10:56:26.783

试试这样：

```
SELECT
  CASE WHEN (other.Proj_ID IS NULL OR other.Proj_ID = '') THEN 'No Project'
    ELSE other.Proj_ID + ', ' + prj.[DESC]
  END as 'Project Description'
FROM
  other
  LEFT JOIN prj on ISNULL(prj.Proj_ID,0) = ISNULL(other.Proj_ID,0) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T18:40:04.577

```
SELECT
  CASE WHEN (prj.Proj_ID IS NULL OR prj.Proj_ID = '') THEN 'No Project'
    ELSE prj.Proj_ID + ', ' + prj.[DESC]
  END as 'Project Description'
FROM
  other
  LEFT JOIN prj on prj.Proj_ID = other.Proj_ID 
```

如果您要从 OTHER 数据库加入 PRJ，则需要离开加入它。如果在 PRJ 表中找不到 Proj_ID，case 语句将返回“No Project”。括号将有助于解决 的条件语句`prj.Proj_ID`。

在您的原始查询中，您似乎没有指定要加入哪个表，而是通过 statement 指示加入`where prj.Proj_ID = other.Proj_ID) as 'Project Description'`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-01T11:23:07.750

您还应该检查项目描述是否为空，否则在与它连接时可能会返回空`prj.Proj_ID + ', '`：

```
SELECT CASE
         WHEN prj.Proj_ID IS NULL
               OR prj.Proj_ID = '' THEN 'No Project'
         ELSE prj.Proj_ID + COALESCE(', ' + prj.[DESC], '')
       END AS 'Project Description'
FROM   prj
       LEFT OUTER JOIN other
         ON prj.Proj_ID = other.Proj_ID 
```

（我也这样做了，所以如果描述为空，它也不会显示逗号）

# javascript - 动态 jQuery 变量名

> ID：11746155
> 
> 赞同：4
> 
> 时间：2012-07-31T17:55:06.230
> 
> 标签：javascript, jquery, arrays, variables

我想获取一个 li ID 属性的值（这将是一个用户 ID），并将其用作我最终将用作变量名的一部分的字符串的一部分。我将使用这个变量名来创建一个数组。

我了解基础知识，但似乎无法找到正确的 jQuery/javascript 组合来实现这一魔法。

```
jQuery('#user-list li').click(function() {
    var userID = jQuery(this).attr("id");

    // i want to add the word array to the end of userID
    var theVariableName = userID + "Array";

    // I want to use this variable to create an array
    var theVariableName = new Array();

    // I want to continue to use the name throughout my document
    theVariableName.push({startTime: 7, endTime: 10});

    alert(theVariableName[0].startTime);

}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T18:03:26.443

使用 Object 来保存各种用户数组：

```
window.userData = {};

$(...).click(function() {
    // ...
    window.userData[userID] = [];
    window.userData[userID].push({startTime:7, endTime:10});

    alert(window.userData[userID][0].startTime);
} 
```

不过，您可能不想将`userData`对象存储在全局命名空间中；为了防止意外的名称冲突，您至少应该将它放在您自己的命名空间中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-31T18:01:37.507

您可以将变量存储在全局`window`对象中：

```
jQuery('#user-list li').click(function() {
    var userID = jQuery(this).attr("id");

    // i want to add the word array to the end of userID
    var theVariableName = userID + "Array";

    // I want to use this variable to create an array
    window[theVariableName] = new Array();

    // I want to continue to use the name throughout my document
    window[theVariableName].push({startTime: 7, endTime: 10});

    alert(window[theVariableName][0].startTime);
}); 
```

事实上，每个未在闭包中声明的已`var x`声明变量都将驻留在全局对象中。`x`但是，我建议您使用另一个全局对象，例如`userStorageObject`或类似的东西：

```
var userStorageObject = {};
jQuery('#user-list li').click(function() {
    var userID = jQuery(this).attr("id");

    // i want to add the word array to the end of userID
    var theVariableName = userID + "Array";

    // I want to use this variable to create an array
    userStorageObject[theVariableName] = new Array();

    // I want to continue to use the name throughout my document
    userStorageObject[theVariableName].push({startTime: 7, endTime: 10});

    alert(userStorageObject[theVariableName][0].startTime);
}); 
```

它在这里工作：http: [//jsfiddle.net/bingjie2680/NnnRk/](http://jsfiddle.net/bingjie2680/NnnRk/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-31T18:02:13.160

你可以这样做..

```
var variable = "Array";
window[id+variable] = "value"; 
```

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-07-31T18:03:48.957

尝试`eval`：

```
var theVariableName = userID + "Array";
eval(theVariableName+"= new Array()"); 
```

# iphone - 设置计时器以更改 UIButton 属性

> ID：11746165
> 
> 赞同：0
> 
> 时间：2012-07-31T17:55:44.607
> 
> 标签：iphone, objective-c, xcode, timer, uibutton

如何制作一个计时器，将 UIButton 的属性从隐藏更改为显示，以及在 4 个按钮之间交替从显示更改为隐藏？

我正在使用 xCode 4.4

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T18:31:47.950

```
 NSTimer *aTimer = [NSTimer scheduledTimerWithTimeInterval: 2.0
                      target: self
                      selector:@selector(onTick:)
                      userInfo: nil repeats:YES]; 
```

而且，onTick 方法应该是这样的

```
-(void)onTick:(NSTimer *)timer {
   //This is where you need to set your button hidden property.
} 
```

看看这个[链接](https://stackoverflow.com/questions/1449035/how-do-i-use-nstimer)，很详细。

# asp.net - 我如何跟踪用户是否在一个月内访问了 10 次以上？

> ID：11746166
> 
> 赞同：1
> 
> 时间：2012-07-31T17:55:45.250
> 
> 标签：asp.net, google-analytics

如何跟踪用户在过去 30 天内是否访问了我的应用程序 10 次以上？我对谷歌分析相当陌生。我已经注册并设置了我的跟踪代码，并且注册了正常的页面跟踪，但是我如何获取此类数据？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T18:01:12.490

我不认为你可以在 GA 中做到这一点，尽管你可以获得返回流量与新流量的百分比。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-31T18:01:50.820

我认为 GA 无法提供您网站的注册用户访问它的次数。你可能需要自己做。

创建一个表来跟踪`UserVists`哪些存储了`UserId`, `LoginDate`, `IPAddress`。每当您的用户成功登录到您的站点时，请在此表中添加一个条目。现在您有了表格中的数据，您可以进行任何您想要的分析（30 天/1 周/1 年......）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-31T20:23:01.253

您可以使用“唯一访问者”指标（或您可能已分配给特定用户的自定义变量）和“访问次数”维度细分来制作自定义报告。然后过滤报告以仅包含大于 9 的访问次数。

我不认为这正是您要寻找的，但至少它应该告诉您在选定的时间范围内有多少访问者访问了 10 次以上。

# fonts - 将笔划样式应用于 TTF 字体

> ID：11746167
> 
> 赞同：0
> 
> 时间：2012-07-31T17:55:46.293
> 
> 标签：fonts, bitmap, photoshop

是否有一个程序可以让我获取现有的 TTF 文件并像在 Photoshop 中一样添加黑色轮廓笔触，然后将其再次导出为 TTF 或位图字体？

编辑：实际上，如果它可以转换为 TTF，因为我可以使用 AngelCodes 制作带有笔划的位图字体。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T05:47:11.000

无法为 ttf 文件添加笔画。您可以使用标签的阴影属性。对于位图字体，您可以在 png 文件上添加效果，而无需对字母位置进行任何修改。

# bada - Bada 清单错误：找不到 -lc-newlib

> ID：11746168
> 
> 赞同：0
> 
> 时间：2012-07-31T17:55:47.587
> 
> 标签：bada

当我们将 manifest.xml 从 2.0 更改为 1.2 或从“应用程序管理器”生成的 1.0 并尝试在 bada 的 2.0 IDE 中构建应用程序时。我得到以下错误

1.  找不到 -lc-newlib C/C++ 问题
2.  找不到 -lm-newlib C/C++ 问题
3.  make: *** [Test.exe] 错误 1 ​​C/C++ 问题

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-04T23:16:40.910

我建议您生成一个全新的项目，在创建时指定 bada 1.2，然后将所有源/头/资源文件复制到其中。操作系统版本比清单还多；显然，编译器/链接器设置也需要不同。

# python - 谷歌应用引擎返回空查询

> ID：11746172
> 
> 赞同：1
> 
> 时间：2012-07-31T17:55:58.397
> 
> 标签：python, google-app-engine, google-cloud-datastore

我正在尝试在 App Engine 上构建一个网络应用程序，在某个时刻，我需要一个函数来构建一个列表属性，其中包含来自不同组的一个成员。如果我使用 Sqlite 数据库和 web.py 数据库模块进行操作，我可以让它工作，我可以像这样实现我需要的东西：

```
db = web.database(dbn='sqlite',db=':memory:')
db.query("CREATE TABLE seq_list (seq TEXT, seq_pickle TEXT);")

# do some stuff to the database

def getUnique():
    uniq_entries = db.query("SELECT DISTINCT seq FROM seq_list;")
    if not uniq_sequences:
        for entry in uniq_entries:
            seq_query = db.query("SELECT * FROM seq_list WHERE seq='" + str(entry.seq) +"';")
            seq_obj = pickle.loads(seq_query[0].seq_pickle)
            self.uniq_sequences.append(seq_obj) 
```

不过，我无法让它在 App 引擎中工作。

```
class SeqObj(db.Model):
    seq = db.TextProperty(required = True)
    seq_pickle = db.TextProperty(required = True)

# do some stuff to the database

def getUnique():
    entries = db.GqlQuery("SELECT * FROM SeqObj")
    entries = list(entries)
    if not uniq_sequences:
        unique_entries = set([entry.seq for entry in entries])

        # this prints the unique entries correctly
        print unique_entries

        for entry in unique_entries:
            try:
                 q = "SELECT * FROM SeqObj WHERE seq='%s'"% entry
                 print q
                 seq_query = db.GqlQuery(q)

                 # these are the lines that break it
                 seq_obj = pickle.loads(seq_query[0].seq_pickle)
                 uniq_sequences.append(seq_obj)
                 print entry
            except:
                 pass 
```

try/except 用于显示打印语句。这会输出一些测试数据：

```
set([u'DXTMT', u'DIXTX', u'XSXDV', u'XI*MT'])
SELECT * FROM SeqObj WHERE seq='DXTMT'
SELECT * FROM SeqObj WHERE seq='DIXTX'
SELECT * FROM SeqObj WHERE seq='XSXDV'
SELECT * FROM SeqObj WHERE seq='XI*MT' 
```

当我没有把所有的东西都放在 try catch 块中时，我得到了

```
IndexError: The query returned fewer than 1 results 
```

我不知道出了什么问题，因为我返回了唯一的序列，查询看起来也像我期望的那样，并且我可以验证条目是否在数据存储中。任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-31T18:37:50.877

问题是您无法过滤未索引的属性（TextProperty 未索引）。有关详细信息，请参阅[https://developers.google.com/appengine/docs/python/datastore/queries#Filtering_on_Unindexed_Properties_Returns_No_Results](https://developers.google.com/appengine/docs/python/datastore/queries#Filtering_on_Unindexed_Properties_Returns_No_Results)。

`seq`如果已知您的字段少于 500 个字符，请尝试使用 StringProperty 。

同样在这些情况下，我总是建议首先在 DataStore 查看器中运行查询。它建议您需要哪些索引来运行所需的查询。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T18:39:41.550

这是在 dev_appserver 还是在真正的应用引擎服务器上失败？

如果它适用于 dev_appserver 但不适用于真实的东西，那么我猜你可能会丢失真实服务器上的一些索引。

# ant - 如何通过 Ant 显示 jUnit 错误

> ID：11746177
> 
> 赞同：3
> 
> 时间：2012-07-31T17:56:28.660
> 
> 标签：ant, junit

我正在尝试将 Ant 脚本添加到我公司的项目中以运行 jUnit 测试。这是我所拥有的：

```
<target name="unit-tests">
    <junit>
        <classpath>
            <pathelement location="${project.libext.dir}/junit-4.1.jar"/>
        </classpath>
        <batchtest>
            <fileset dir="${project.src-test.dir}/my/company/." />
        </batchtest>
    </junit>
</target> 
```

该脚本正确地抓取了我的 jUnit 测试，但它说有错误。但是所有的输出都会说是这样的：

```
[junit] Test package.MyTest FAILED 
```

我想知道为什么它失败了。我尝试将一堆属性添加到`junit`标签（`printsummary`、`showoutput`等），但似乎找不到正确的组合。我设法得到的最好的是：

```
[junit] Running package.MyTest
[junit] Tests run: 1, Failures: 0, Errors: 1, Time elapsed: 0 sec 
```

我真的需要完整的堆栈跟踪等，因为当我通过 Eclipse Run As > Junit Test 时测试运行良好。

有人知道如何打印堆栈跟踪吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-31T18:46:33.050

找到了答案。需要添加格式化程序。

```
<target name="unit-tests">
    <junit>
        <classpath>
            <pathelement location="${project.libext.dir}/junit-4.1.jar"/>
        </classpath>
        <formatter type="plain" usefile="false" />
        <batchtest>
            <fileset dir="${project.src-test.dir}/my/company/." />
        </batchtest>
    </junit>
</target> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T18:10:43.110

您无法从 Ant 输出 AFAIK 中的测试中打印完整的堆栈跟踪；它嵌入在 JUnit 报告文件中。您可以单独浏览它，或者如果您使用 Jenkins 或 CruiseControl 等持续集成服务器来运行您的构建，您可以设置一个链接到测试报告的插件。

# ruby-on-rails - Encoding::CompatibilityError（不兼容的字符编码：UTF-8 和 ASCII-8BIT） - 将文件上传到 Heroku 时

> ID：11746178
> 
> 赞同：2
> 
> 时间：2012-07-31T17:56:30.003
> 
> 标签：ruby-on-rails, ruby, file-upload, encoding, heroku

我已经看到很多关于这个错误的引用，但它们都与上传无关，所以我在这里看看其他人是否看到了这个。

我有一个应用程序在 Heroku 的`cedar`堆栈上运行，一切正常，直到我必须上传一个带有 UTF-8 字符的文件，它只是失败并出现以下错误，我不知道发生了什么或为什么会这样，因为表单正文**是**UTF-8（因为 Rails 在所有形式上都强制使用它）。

我有另一个应用程序几乎做同样的事情，但它没有在 Heroku 上运行，它在接收带有 UTF-8 字符的上传文件时工作文件。任何人都知道这可能是什么或我该如何解决？

```
2012-07-31T17:43:59+00:00 app[web.1]: Started POST "/attachments" for 177.82.145.36 at 2012-07-31 17:43:59 +0000
2012-07-31T17:43:59+00:00 app[web.1]: Processing by AttachmentsController#create as HTML
2012-07-31T17:43:59+00:00 app[web.1]:   Parameters: {"utf8"=>"✓", "authenticity_token"=>"qhQ8bO/j6WFdu/AGLli6+KrXZPAsFfynwKBN6MqQt9Y=", "attachment"=>{"name"=>"JINGLE CUITÉ", "category_id"=>"8", "city_id"=>"8", "link"=>"", "assets_attributes"=>{"1"=>{"file"=>#<ActionDispatch::Http::UploadedFile:0x0000000504d7d8 @original_filename="Tárcio 40.mp3", @content_type="audio/mpeg", @headers="Content-Disposition: form-data; name=\"attachment[assets_attributes][1][file]\"; filename=\"T\xC3\xA1rcio 40.mp3\"\r\nContent-Type: audio/mpeg\r\n", @tempfile=#<File:/tmp/RackMultipart20120731-2-1e58fuf>>}}, "description"=>""}, "commit"=>"Criar arquivo"}
2012-07-31T17:43:59+00:00 app[web.1]: [paperclip] Saving attachments.
2012-07-31T17:43:59+00:00 app[web.1]: [paperclip] saving attachments/2/original_Tárcio_40.mp3
2012-07-31T17:44:00+00:00 app[web.1]: Completed 500 Internal Server Error in 393ms
2012-07-31T17:44:00+00:00 app[web.1]: 
2012-07-31T17:44:00+00:00 app[web.1]:   app/controllers/crud_controller.rb:20:in `create'
2012-07-31T17:44:00+00:00 app[web.1]: Encoding::CompatibilityError (incompatible character encodings: UTF-8 and ASCII-8BIT): 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T18:05:59.843

听起来像是回形针的错误：[https](https://github.com/thoughtbot/paperclip/issues/301) ://github.com/thoughtbot/paperclip/issues/301 。

根据评论，升级到最新版本应该可以解决它

# c# - ASP.NET 图表控件 - 使用反转 y 轴布局 x 轴标签

> ID：11746180
> 
> 赞同：0
> 
> 时间：2012-07-31T17:56:43.067
> 
> 标签：c#, asp.net, layout, charts, asp.net-charts

我有一个具有不同系列的 asp.net 图表控件，并且我已经反转了 y 轴。正因为如此，我不得不将 Crossing AxisY 设置为 Maximum 以使 xaxis 位于底部。在没有将交叉值设置为最大值的情况下，我在顶部有 xaxis，但我希望它在底部。

问题是 x 轴标签仍在顶部而不是底部。任何人都知道如何反转 y 轴并在底部有正常的 x 轴标签？

```
 Chart1.ChartAreas[0].AxisY.IsReversed = true;
    Chart1.ChartAreas[0].AxisY.Crossing = Double.MaxValue; 
```

![图表](../Images/c8e7787415a6d715c898a4c6c447ce05.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-13T04:50:04.440

替代解决方案（我可能稍后会回来告诉您如何使用现有代码执行此操作） 注意：虽然我使用 winform 来演示这一点，但它应该在您的 asp.net 应用程序中工作。

在我的替代解决方案中，您可以跳过使用此语句

```
//Chart1.ChartAreas[0].AxisY.Crossing = Double.MaxValue; 
```

相反，您可以将数据系列设置为使用辅助 x 轴！

```
//chart1.ChartAreas[0].AxisY.Crossing = Double.MaxValue; // Disabled - from your example.
chart1.ChartAreas[0].AxisY.IsReversed = true;
chart1.Series[0].XAxisType = AxisType.Secondary;

// Example data for image below
chart1.Series[0].ChartType = SeriesChartType.Spline;
chart1.Series[0].Points.Add(new DataPoint(1, 0));
chart1.Series[0].Points.Add(new DataPoint(2, 40));
chart1.Series[0].Points.Add(new DataPoint(3, 20));
chart1.Series[0].Points.Add(new DataPoint(4, 90));
chart1.Series[0].Points.Add(new DataPoint(5, 20)); 
```

我的示例代码导致下图：

![例子](../Images/90dfedccecb7231c0bcdaf30fb3cf18a.png)

如果您觉得我的回答足够，请标记为已接受。谢谢！

# java - 在 JDOM 中创建多个同名元素

> ID：11746182
> 
> 赞同：0
> 
> 时间：2012-07-31T17:57:08.120
> 
> 标签：java, xml, jdom

我正在尝试使用 JDOM 创建多个具有相同名称的元素，XML 文件应输出如下：

```
 <data>
    <series name="Related">
      <point name="aaaa" y="1" />
      <point name="bbbb" y="0" />
      <point name="cccc" y="2" />
      <point name="dddd" y="3" />          
    </series>

    <series name="Not-Related" >
     <point name="CE901" y="1" />
      <point name="aaa" y="1" />
      <point name="bbb" y="1" />
      <point name="rrr" y="1" />
      <point name="rrr" y="1" />
     </series>
   </data> 
```

我试图将其编码为：

```
 for (int i = 0; i < 2; i++) {
  doc1.getRootElement().getChild("charts").getChild("chart").getChild("data").addContent(new Element("series").setAttribute("name", "Related"));             
            for (int j = 0; j < 4; j++) {
                doc1.getRootElement().getChild("charts").getChild("chart").getChild("data").getChild("series").addContent(new Element("point").setAttribute("name", "CE901").setAttribute("y","1"));              
            }
        } 
```

然而，上面的代码输出以下 XML，这是错误的：

```
<data>
<series name="Related">
<point name="CE901" y="1"/>
<point name="CE901" y="1"/>
<point name="CE901" y="1"/>
<point name="CE901" y="1"/>  
<point name="CE901" y="1"/>
<point name="CE901" y="1"/>
<point name="CE901" y="1"/>
<point name="CE901" y="1"/>
</series>
<series name="Related"/> 
```

你能帮我找到这样一种方法来精确地使用 JDOM 编写多个具有相同名称的元素吗？

谢谢..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T18:08:16.717

`getChild("data")`返回名为“data”的**第一个孩子。**如果您需要向名为“data”的第二个子元素添加一些内容，请使用`getChildren()`并从返回的列表中获取第二个元素。

请注意，如果您使用变量而不是每次都重复整个 getter 链，您的代码将更具可读性（和效率）：

```
Element chart = doc1.getRootElement().getChild("charts").getChild("chart");
for (int i = 0; i < 2; i++) {
    Element data = chart.getChildren("data").get(i);
    Element series = new Element("series").setAttribute("name", "Related");
    data.addContent(series);             
    for (int j = 0; j < 4; j++) {
        series.addContent(new Element("point").setAttribute("name", "CE901")
                                              .setAttribute("y","1"));              
    }
} 
```

# javascript - 如何引用 div 标签的 Javascript 函数来添加逗号？

> ID：11746184
> 
> 赞同：0
> 
> 时间：2012-07-31T17:57:12.877
> 
> 标签：javascript, jquery, html, comma

我是一个 Javascript 新手......我听说过 jQuery，但不知道如何使用它，所以请容忍我在这里完全缺乏知识...... :)

我正在将 Excel 数据库中的信息动态导入网站。它工作得很好，除了没有一个数字有逗号 - 这是一个我无法从源头更改的格式问题，所以我需要在网站代码中更改它。

相关的 HTML 代码如下所示：

```
<tr><td class="num">191025</td><td>Stuff</td><td class="num">$60</td></tr>
<tr><td class="num">184160</td><td>Other Stuff</td><td class="num">$15</td></tr> 
```

我想使用 Javascript（或 jQuery - 任何工作）将逗号添加到所有现有的“num”类（所以 191025 将显示为 191,025）。

我一直在浏览这个网站和其他网站，发现这个网站：[http](http://www.mredkj.com/javascript/nfbasic.html) ://www.mredkj.com/javascript/nfbasic.html ，它有这个公共域代码：

```
function addCommas(nStr)
{
    nStr += '';
    x = nStr.split('.');
    x1 = x[0];
    x2 = x.length > 1 ? '.' + x[1] : '';
    var rgx = /(\d+)(\d{3})/;
    while (rgx.test(x1)) {
        x1 = x1.replace(rgx, '$1' + ',' + '$2');
    }
    return x1 + x2;
} 
```

这看起来很棒，我将它添加到我在我的 html 页面中引用的现有外部 .js 页面中。

但是，现在的问题是如何使用代码？查看该页面上的示例，看来我必须执行以下操作：

```
<tr><td class="num">addCommas(191025)</td><td>Stuff</td><td class="num">$60</td></tr> 
```

这是不现实的——有数百个这样的数字，我无法单独更新每一个。

我确信Javascript（或jQuery？）可以自动将编码应用于现有的“num”类以插入逗号......但我不知道如何去做。所以，所有这些都让我想到了我的问题：**我如何有效地将这个（或其他更好的？）代码应用于 div 类以便添加逗号？**

我*非常*感谢任何帮助......但请记住我的新手，让我知道外部 .js 工作表中需要做什么以及 .html 页面上发生了什么。

谢谢！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T18:00:45.213

jQuery解决方案：

```
$('.num').each(function () {
    $(this).text(addCommas($(this).text()));
});​​​​​​​​​​ 
```

javascript 解决方案（在 IE 中不起作用，因为它不支持[getElementsByClassName](https://developer.mozilla.org/en/DOM/document.getElementsByClassName)）

```
var elements = document.getElementsByClassName('num');
var textPropertyToUse; // cross-browser support

for (var i = 0; i < elements.length; i++) {
    textPropertyToUse = 'textContent' in elements[i] ? 
        'textContent' : 
        'innerText';

    elements[i][textPropertyToUse] = addCommas(elements[i][textPropertyToUse]);
} 
```

工作示例：http: [//jsfiddle.net/XpbJV/](http://jsfiddle.net/XpbJV/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-31T18:01:36.667

在页面加载时执行此代码：

```
$(".num").each(function() {
   var self = $(this), text = self.text();
   self.text(addCommas(text));
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-31T18:11:00.190

一个非常简单的 jQuery 解决方案将是......

```
$(".num").text(addCommas); 
```

...只要您将`addCommas`函数签名更改为此...

```
function addCommas(i, nStr) 
```

* * *

这将起作用，因为您`addCommas`会将当前文本内容作为第二个参数，并返回更新的文本内容。这就是大多数 jQuery 的迭代器版本的方法的工作方式。

***演示：http:*** [//jsfiddle.net/gprf6/](http://jsfiddle.net/gprf6/)

# asp.net-mvc-3 - 在洋葱架构中管理 NHibernate 会话

> ID：11746188
> 
> 赞同：1
> 
> 时间：2012-07-31T17:57:19.380
> 
> 标签：asp.net-mvc-3, nhibernate, onion-architecture

我正在尝试设置 NHibernate 来处理每个 Web 请求的会话。我有一个项目在使用我的任何存储库时初始化我的会话。我想知道管理每个 Web 请求的会话的最佳方式。因为我的架构是解耦的，所以我想避免在我的 Web 项目中打开会话并关闭会话。有没有一种好方法来处理这个问题，而不需要 web 项目知道 NHibernate 的存在？

这是我的请求流程：

Web 请求 -> ASP.NET MVC 3 -> 控制器 -> 服务 -> 存储库（打开会话） -> NHibernate -> 数据库 -> 返回 MVC 并退出。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T18:36:49.250

看看 S#arp 架构。它是一个包装 NHibernate 并为您提供此功能的框架，以及一些其他功能。您也可以使用 Castle Windsor 或 Ninject 等依赖注入容器来执行此操作。（S#arp 使用温莎城堡）。

如果您想自己执行此操作，则需要`HttpModule`在每个 Web 请求的开始和结束时为您创建一个打开和关闭会话。在请求开始时，该模块将打开一个会话，并将其隐藏在 中`HttpContext.Items`，这是每个 Web 请求的存储。您的存储库将在处理请求时从此处获取会话。（对于干净的设计，创建`ISessionManager`存储库使用的接口，以及访问每个请求存储的实现。然后它是可单元测试的。）最后，模块将在请求结束时刷新并关闭会话。我曾经在一个 NHibernate 项目中这样做过，虽然它具有教育意义，但工作量很大。

S#arp 是一个大型框架，它决定了许多应用程序结构。如果您不想走那么远，请查看温莎城堡，为您清晰地抽象出来。您需要做的（或多或少）是配置容器以使用每个请求的 NHibernate 会话对象作为构造函数参数来实例化存储库。如果你真的想学习如何，构建自己的 HttpModule，但我建议在生产中使用框架。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-01T12:15:56.823

这是一篇很棒的文章，如何使用 IoC 容器（温莎城堡）实现每请求会话[http://blog.xelibrion.com/journal/2011/4/16/nhibernate-session-management-in-aspnet-mvc-application .html](http://blog.xelibrion.com/journal/2011/4/16/nhibernate-session-management-in-aspnet-mvc-application.html)

# php - PHP 简单 html dom 查找所有输入[type=text] 或者没有类型

> ID：11746189
> 
> 赞同：1
> 
> 时间：2012-07-31T17:57:20.133
> 
> 标签：php, simple-html-dom

我正在尝试提取所有表单输入，它们`type`是`text`.

我的问题是，至少在 Chrome 中，这是一个`input`标签，没有`type`指定属性，呈现为`text`.

如何找到所有`type`未指定的标签，或者它的值是简单`text`的**html dom**？

我的当前：

```
foreach ($form->find('input[type=text]') as $input) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-04T04:33:07.733

恐怕你可能不得不这样做：

```
foreach ($form->find('input') as $input){
  if($input->type==''||$input->type=='text'){
    //code
  }
} 
```

除非解析器可以使用这种类型的选择器：`input[type=''],input[type=text]`

在 JQuery 中，这将选择所有没有类型或类型等于文本的元素。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-31T18:12:52.467

读这个

[将隐藏的输入作为字符串抓取（使用 PHP 简单 HTML DOM 解析器）](https://stackoverflow.com/questions/6496220/grabbing-hidden-inputs-as-a-string-using-php-simple-html-dom-parser)

我不确定，但试试这个

```
$html->find('input[type=text]', 0); 
```

# java - weblogic 10.3.5 安装错误。无法识别的选项：-jrockit

> ID：11746192
> 
> 赞同：4
> 
> 时间：2012-07-31T17:57:36.590
> 
> 标签：java, weblogic, weblogic-10.x

我正在尝试在我的机器上安装 weblogic 10.3.5。我从这个站点下载了它：[http](http://www.oracle.com/technetwork/middleware/ias/downloads/wls-main-097127.html) ://www.oracle.com/technetwork/middleware/ias/downloads/wls-main-097127.html ，对于 64 位，我进行了通用下载。看起来 JDK 没有受到 jar 的攻击，所以我必须在安装过程中指定路径。我将它们指向 64 位 JDK 1.7.0_05。安装只用了 3-5 分钟，它说它是成功的，但是在 weblogic 启动期间我得到这个错误并且控制台没有打开。

```
Unrecognized option: -jrockit
Error: Could not create the Java Virtual Machine.
Error: A fatal exception has occurred. Program will exit. 
```

我尝试了几次，但仍然遇到同样的问题。有什么输入吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-22T15:17:12.893

甚至我对 Weblogic 11g 和 Oracle JDK 1.7 也有同样的问题。由于 JVM 是 HotSpot Client，我更改`JAVA_VM`了`:oracle`. 以下是该文件的摘录。

```
:oracle
if "%PRODUCTION_MODE%" == "true" goto oracle_prod_mode
set JAVA_VM=-client 
```

它现在工作正常:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T18:05:31.700

您可以尝试使用 JDK 1.6。WebLogic server 10 发布时还没有 JDK 1.7。也许 WebLogic 运行脚本无法识别您的环境并假设您有 jrockit 环境。使用 JDK 1.6 应该可以解决您的问题。

**UPD**如果您坚持使用 JDK 1.7，我建议您可以尝试在服务器运行/setEnv 脚本中找到问题所在并对其进行编辑以避免 jrockit 选项。

# c++ - 在编译时计算小整数的阶乘

> ID：11746193
> 
> 赞同：6
> 
> 时间：2012-07-31T17:57:42.517
> 
> 标签：c++, math, boost, template-meta-programming, constexpr

我刚刚（再次）实现了一个递归模板，用于在编译时计算整数的阶乘（谁会想到有一天我会真正需要它！）。尽管如此，我并没有自己动手，而是去[Boost](http://www.boost.org/)寻找答案。但是，特殊数学中的阶乘函数特别禁止它与整数类型一起使用，所以我只写了自己的。

不过，我应该使用 Boost 中的另一个功能吗？我应该将整数转换为`double`并使用该`boost::factorial`函数吗？计算是在编译时执行的吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-31T18:20:49.807

你不需要 Boost，如果你有 C++11，这只是 1-liner：

```
constexpr uint64_t factorial(uint64_t n) { 
    return n == 0 ? 1  :  n * factorial(n-1); 
} 
```

即使您的 arg 也不是编译时间常数，它也会起作用。uint64_t 适用于 n < 21。

如果您在编译时执行此操作并乘以浮点值 - 将没有转换开销（转换也将在编译时进行）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-31T20:43:15.853

由于可以容纳在整数中的阶乘数量有限，因此您可以简单地手动预先计算前 20 个值并将它们存储在全局或静态数组中。然后使用全局或静态函数在数组中查找阶乘：

```
#include <iostream>

const int factorials[] =
{
    1,
    1,
    2,
    6,
    24,
    // etc...
};

inline const int factorial(int n) {return factorials[n];}

int main()
{
    static const int fourFactorial = factorial(4);
    std::cout << "4! = " << fourFactorial << "\n";
} 
```

如果您使用文字作为 的参数`factorial`，则编译器应该简单地用结果替换函数调用（启用优化时）。我在 XCode 4.4（在 Mac 上）中尝试了上面的示例，我在程序集中看到它`fourFactorial`使用常量 24 进行初始化：

```
.loc    1 20 38  ## /Users/emile/Dev/sandbox/sandbox/main.cpp:20:38
movl    $24, __ZZ4mainE13fourFactorial(%rip) 
```

与使用递归编译时技巧相比，此方法可能会导致更快的编译。

# php - 通过 Ajax 在 PHP 文件中调用 MySQL 连接单例对象

> ID：11746202
> 
> 赞同：0
> 
> 时间：2012-07-31T17:58:00.633
> 
> 标签：php, javascript, mysql, ajax, singleton

嘿伙计们，我有以下示例。我有一个从 mySQL 数据库加载的导航，其中包含一个名为**getNavi.php**的 PHP 文件：

```
$query="SELECT * FROM projects WHERE category=\"$category\"";
$result=mysql_query($query);
$num=mysql_numrows($result);
mysql_close();

while ($row = mysql_fetch_object($result)) {
    $title=$row->title;
    $id=$row->id;
    echo "<div class=\"sublink\" data-subsite=\"$id\" data-category=\"$category\" data-title=\"$title\" ><a href=\"#\">$title<br />";
} 
```

这些链接已正确加载并通过 AJAX 处理：

```
$(document).ready(function(){
    $('.link').click(function(){
        var subsite = $(this).data('subsite');
        $('#naviLeftContent').load('php/getNavi.php?category='+subsite);
    });
    $(document).on("click", ".sublink", function(){
        var subsite = $(this).data('subsite');
        var category = $(this).data('category');
        var title = $(this).data('title');
        var info = category + "/" + title;
        var lower = info.toLowerCase();
        var nospaces = lower.split(' ').join('');
        $('#titleContent').text(title);
        $('#imageContent').load('php/getImages.php?info='+nospaces);
        $('#textContent').load('php/getText.php?id='+subsite);
        $('#infosContent').load('php/getInfos.php?id='+subsite);
    });
}); 
```

这部分是它开始出现问题的地方，因为我的 div 的内容有时只是部分加载或根本不加载。文本没有被剪切，但大部分标题和信息没有加载。有时会发生信息切换，而我一直重复单击**同一链接**。

问题是在我加载的所有 PHP 文件中，我打开和关闭了一个 SQL 连接。现在，作为一名 Java 程序员，我认为为我可以调用的成员函数的连接创建一个类会很好。当然我想到了一个单例对象，但是当我创建这样的 PHP 文件时，我不知道如何调用这些方法：

```
<?php
class DBConnection {

  private static $instance;

  private function __construct() {
    $user="root";
    $password="";
    $database="klb";
    mysql_connect("localhost",$user,$password);
    @mysql_select_db($database) or die( "Unable to select database");  
 }

  public function __destruct() {
      mysql_close();
 }

  public static function getInstance() {

    if(!self::$instance) {
      self::$instance = new self();
    }

    return self::$instance;
  }

  public function getNaviForCategory($category) {
    $query="SELECT * FROM projects WHERE category=\"$category\"";
    $result=mysql_query($query);
    $num=mysql_numrows($result);
    while ($row = mysql_fetch_object($result)) {
        $title=$row->title;
        $id=$row->id;
        echo "<div class=\"sublink\" data-subsite=\"$id\" data-category=\"$category\" data-title=\"$title\" ><a href=\"#\">$title<br />";
    }
  }

 public function getInfosForProject($id) {
    $query="SELECT * FROM projects WHERE id=\"$id\"";
    $result=mysql_query($query);
    $num=mysql_numrows($result);

    while ($row = mysql_fetch_object($result)) {
        $infos=$row->info;
        echo $infos;
    }
  } 

   private function createTableProjects(){
        $query="CREATE TABLE projects (id int(6) NOT NULL auto_increment,category varchar(30) NOT NULL,title varchar(30) NOT NULL,
        info varchar(200) NOT NULL,text varchar(8000) NOT NULL,PRIMARY KEY (id),UNIQUE id (id))";
        mysql_query($query);
   }
}

?> 
```

我现在需要对这行代码进行一些替换：

```
$('#infosContent').load('php/getInfos.php?id='+subsite); 
```

**编辑 ：**

我用以下代码解决了这个问题：

```
<?php
require_once( 'dbconnection.php');
$category = $_GET["category"];
DBConnection::getInstance()->getNaviForCategory($category);
?> 
```

但似乎我的子链接 div 的点击监听器（上面提到过）并不总是将正确的变量传递给 php 代码。

```
 $('#titleContent').text(title); 
```

例如，这行代码仅在我选择另一个类别时才有效。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T18:07:57.083

可能在 getNavi.php 而不是旧代码

```
$category = intval($_GET['category']);
DBConnection::getInstance()->getNaviForCategory($category); 
```

# web-services - 如何使用 apache cxf 将示例 xml 有效负载添加到 Web 服务文档？

> ID：11746203
> 
> 赞同：1
> 
> 时间：2012-07-31T17:58:19.870
> 
> 标签：web-services, cxf

我们正在尝试使用 Apache CXF 使用 @WSDLDocumentationCollection 和 @WSDLDocumentation 注释来记录我们的 Web 服务。作为 PORT_TYPE_OPERATION 文档的一部分，我们计划将示例 XML 有效负载添加到文档中。但是，当我们这样做时，“<”字符会被转义，而“>”字符则不会。此外，我们无法在文档中添加换行符。这是 CXF 的限制，还是有某种方法可以在生成的文档中包含 CDATA？

# php - 关于如何在记事本++中使用正则表达式查找和替换更改整行的任何建议？

> ID：11746204
> 
> 赞同：-1
> 
> 时间：2012-07-31T17:58:30.020
> 
> 标签：php, xml

我有一个包含结束时间的 XML 文档，我需要更改格式

```
end="00:00:09:02"> 
```

对此

```
end="00:09.02"> 
```

所以基本上前两个数字和冒号被删除了，最后一个冒号被一个句号代替。

我有数百个要更改，并试图弄清楚如何使用某种脚本来编辑它们，有人有什么建议吗？

这是原始行：

```
 <p start="00:00:13:23" EndTimecode="00:00:17:02" Title='Let’s start with RIM and
the High Velocity Sector.'/> 
```

这是我需要结束的内容：

```
 <p begin="00:13.23" end="00:17.02">Let’s start with RIM and
the High Velocity Sector.</p> 
```

由于发现查找和替换是最佳选择，因此我更新了我的问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T18:29:53.033

一种方法是正则表达式。

正则表达式：`/(?:EndTimecode="[0-9]{2}):([0-9]{2}):([0-9]{2}):([0-9]{2})(?:")/`

替换字符串：`end="$1:$2.$3"`

你会像这样使用它：

1.  读取 xml 文件并将其存储到 var 中（调用它`$contents`）
2.  `$contents = preg_replace('/(?:EndTimecode="[0-9]{2}):([0-9]{2}):([0-9]{2}):([0-9]{2})(?:")/', 'end="$1:$2.$3"', $contents);`
3.  使用中的新数据保存回文件`$contents`

***首先创建备份或将其写入新的 tmp 文件！***

编辑：见上文。唯一的变化是正则表达式。`(?:end`改为`(?:EndTimecode`

Edit2：我希望它们看起来都一样。试试这个

正则表达式：`/<p start="[0-9]{2}:([0-9]{2}):([0-9]{2}):([0-9]{2})" EndTimecode="[0-9]{2}:([0-9]{2}):([0-9]{2}):([0-9]{2})"\sTitle='(.+?)'/>/`

替换字符串：`<p begin="$1:$2.$3" end="$4:$5.$6">$7</p>`

# php - PHP PDO插入功能未知数量的变量

> ID：11746206
> 
> 赞同：0
> 
> 时间：2012-07-31T17:58:45.873
> 
> 标签：php, insert, pdo, explode

尝试构建一个可以插入到 SQL 数据库中的函数，而不管变量有多少或有多少。目前我的功能不起作用。

```
function insert($table, $columns, $results){
    global $dbh;
    $results = explode(',',$results); 
    $val= ''; 
    $ex = '';
    foreach($results as $result){ 
        $val .= ":" . $result . ","; 
        $ex = "':" . $result . "' => $result,"; 
    }
    $val = rtrim($val, ','); 
    $ex = rtrim($ex, ',');
    $sql = "INSERT INTO $table ($columns) VALUES ($val)";
    $q = $dbh->prepare($sql);
    $q->execute(array($ex));
} 
```

像这样调用： `insert('users','email,pwd,forename,surname,level,status',$vals);`

当我设法让它为我的 Select 功能工作时。

```
function check($table,$columns,$results){
    global $dbh;
    $columns = explode(',',$columns);
    $results = explode(',',$results); 
    $whr= ''; 
    $int = 0;
    foreach($columns as $column){ 
        $whr.= " AND " . $column . " = '{$results[$int]}'"; 
        $int += 1; 
    }
    $sql = "SELECT * FROM $table WHERE status != 'D' $whr";
    $return = 0;
    foreach($dbh->query($sql) as $check){ 
        $return = 1; 
    } 
    return $return;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T18:08:54.320

这是我使用的一种方法...

```
public function iInsert($table,$columns,$values)
    {

        # prepare the insert statement
        $col_str = "(" . implode(",",$columns) . ")";

        # is this a set of values or a select statement?
        if (is_array($values)){
            # this is an array of values
            foreach($values as $value){
                $cnv_val[] = $this->checkNULL($value);
            }
            $q = array_fill(0,count($columns),'?');
            $val_str = "VALUES (" . implode(",", $q)  . ")";

        }else{
            # assume this is a select statement for insert 
            $val_str = $values;
        }

        $syntax_str = "INSERT INTO $table $col_str \r\n$val_str";
        # execute the insert

        $sth = $this->iExec($syntax_str, $cnv_val, "inserted");

        # return the rows affected as a string
        return $sth;

    } 
```

此示例使用该方法实例化一个类，但为了帮助您了解...

```
*   INSERT - 
*       *** iInsert( string $table, array $columns, array [or string] $values ); ***
*       Returns: rows affected.
*
*       Example 1:
*
*       $result_array = $test_db->iInsert(  "BIDDING_BASIS_CODES", 
*                           array('BIDDING_BASIS_CODE', 'CODE_DESC',            'CODE_ACTIVE_FLAG', 'IBR_CODE', 'LAST_MOD_BY_USER_ID',  'LAST_MOD_DATE_TIME'),
*                           array('TEST',               'TEST CODE - DISREGARD','N',                'N',        'cd_boust',             '1/1/2011 09:00')       
*                           );
*       echo $result;
*
*       Example 2:
*
*       $result_array = $test_db->iInsert(  "BIDDING_BASIS_CODES", 
*                           array('BIDDING_BASIS_CODE', 'CODE_DESC',            'CODE_ACTIVE_FLAG', 'IBR_CODE', 'LAST_MOD_BY_USER_ID',  'LAST_MOD_DATE_TIME'),
*                           "SELECT 
*                               Row_1,
*                               Row_2,
*                               Row_3,
*                               Row_4,
*                               Row_5,
*                               Row_6
*                           FROM
*                               tablename"      
*                           );
*       echo $result; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T18:11:06.563

首先，我可能会将您的列和值作为关联数组传递给函数。这有助于强制函数调用者必须传递相同数量的两者。至少你应该有逻辑来比较传入的列和值元素的数量，以确保它们相等。您可以尝试这样的事情（注意我还将数据库连接作为参数传递，这是更好的编码实践）。

```
function insert($db, $table, $key_value_array) {
    $sql = 'INSERT INTO ' . $table . ' '; 
    $columns = '(';
    $values = '(';
    foreach ($key_value_array as $k => $v) {
        $columns .= '`' . $k . '`, ';
        $values .= "'" . $v . "', ";
    }
    $columns = rtrim($columns, ', ') . ')';
    $values = rtrim($values, ', ') . ')';
    $sql .= $columns . ' VALUES ' . $values;
    $q = $db->prepare($sql);
    $q->execute();
} 
```

# c# - 超出范围的二维数组

> ID：11746208
> 
> 赞同：0
> 
> 时间：2012-07-31T17:58:54.593
> 
> 标签：c#, arrays

技术人员——当我有一个单一的频道或当我有一个偶数分割时，这个代码就可以工作。当我有剩余时，它*几乎可以工作......因为它会创建下一个频道，它会拉入项目，但随后会超出范围。*这些行是问题的核心：

```
 items_per_batch = batchcount / (int)channels; //
    subsets = batch.Split(items_per_batch); 
```

items_per_batch 真正用于为拆分扩展提供一个关于拆分多少项目的通用数字的概念。如果它看到一个余数，它只是创建另一个子集数组。我真正需要做的是跟踪项目的长度。我试过：

```
 int idx2 = subset.GetLength(1) 
```

在某一时刻，但使用该值的 forloop 也超出了范围。有人有什么建议吗？

```
 static void channelassign()
    {
        int THRESHOLD = 2;
        string[] batch = new string[]
        { "item1", "item2", "item3", "item4","item5","item6","item7" };
        int batchcount = batch.Count();
        int items_per_batch;
        string[][] subsets;
        int idx1;
        int idx2;

        if (THRESHOLD != 0) //avoid accidental division by 0.
        {

            float channels = batchcount / THRESHOLD;
            if (channels < 1)
            {
                channels = 1; // only 1 channel is needed
                items_per_batch = batchcount; // process all items
                idx1 = 1; // fix value to a single channel
                idx2 = (batchcount - 1); // true start of array is 0
                subsets = batch.Split(batchcount); //splits correctly
            }
            else
            {
              // decide how many items will be included per batch
              channels =  (int)Math.Round(channels, 
                  MidpointRounding.ToEven); //determines channel number
              items_per_batch = batchcount / (int)channels; //
              subsets = batch.Split(items_per_batch); 
              idx1 = subsets.GetLength(0); // gets channel# assigned by split
              // idx2 = subsets.GetLength(1); // gets items back from splits

            }

            //distribute contents of batch amongst channels

            for (int channel = 0; channel < idx1; channel++)
            {
                for (int i = 0; i < items_per_batch; i++)
                {
                    Console.WriteLine(" Channel:" + channel.ToString() + " 
                       ItemName: {0} ", subsets[channel][i]);
                }
            }

        }
        else
        {
            Console.WriteLine("Threshold value set to zero. This 
               is an invalid value. Please set THRESHOLD.");
        } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T18:09:40.673

师

```
float channels = batchcount / THRESHOLD; 
```

在`int`s 上执行，所以你`float channels`总是有一个整数值，等于

```
floor(batchcount / THRESHOLD) 
```

但这不是你的问题的原因，那就是

```
for (int channel = 0; channel < idx1; channel++)
{
    for (int i = 0; i < items_per_batch; i++) 
```

如果`batchcount`不是 的倍数`channels`，则某些通道的项目数少于`items_per_batch`。因此，内部循环然后尝试访问`subsets[channel][i]`不存在的 a。

# c# - 列表中的列表

> ID：11746211
> 
> 赞同：0
> 
> 时间：2012-07-31T17:59:14.940
> 
> 标签：c#, wpf, xaml

我对联系人列表有以下用户控件

```
<UserControl.Content>
        <Border BorderBrush="LightBlue" BorderThickness="1,1,1,1" CornerRadius="8,8,8,8" HorizontalAlignment="Left" VerticalAlignment="Top" Width="250" Height="300" Margin="0,0,-1,0">
            <ItemsControl ItemsSource="{Binding Users}" x:Name="tStack" Grid.Column="0">
                <ItemsControl.ItemsPanel>
                    <ItemsPanelTemplate>
                        <StackPanel Orientation="Vertical" Height="Auto" Width="Auto" />
                    </ItemsPanelTemplate>
                </ItemsControl.ItemsPanel>
                <ItemsControl.ItemTemplate>
                    <DataTemplate>
                        <MenuItem MouseDoubleClick="MenuItem_MouseDoubleClick_1" Header="{Binding Username}">
                            <StackPanel HorizontalAlignment="Left" VerticalAlignment="Center" FlowDirection="LeftToRight" Orientation="Vertical">
                                <Image Width="20" Height="20" Source="C:\Users\JR-WORK\Documents\Visual Studio 2012\Projects\itControl Chat\itControl Chat\Images\green-bullet.png" />
                                <TextBlock Text="{Binding Username}" />
                            </StackPanel>
                        </MenuItem>
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>
        </Border>
    </UserControl.Content> 
```

这很好用，并且`user`在我`ObservableCollection`的`Users`. 现在我想添加另一个`ObservableCollection`用户组，比如朋友、组、收藏夹等等。如何在另一个绑定中分层以在列表中创建列表？我是否需要创建另一个`UserControl`包含这个作为数据模板的模板？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T18:04:19.170

如果列表中的列表是父列表（即用户）的项目的属性，那么您只需将另一个 ItemsControl 添加到用户的模板中。

# phpunit - 如何编写行为类似于内置断言的自定义 PHPUnit 断言？

> ID：11746212
> 
> 赞同：7
> 
> 时间：2012-07-31T17:59:17.887
> 
> 标签：phpunit, assertion

我如何编写一个自定义断言，例如`assertFoo($expected, $actual)`，它的行为类似于关于错误“堆栈跟踪”的内置断言？

我目前定义了以下方法（在扩展的类中`PHPUnit_Framework_TestCase`）：

```
public static function assertFoo($expected, $actual) {
    self::assertEquals($expected, $actual); 
} 
```

如果我从测试中调用它并且测试失败，我会在调用堆栈中获得两项：

```
1) PreferencesTest::testSignupTeacher
Failed asserting that 5 matches expected 3.

/vagrant/myproject/tests/integration/PreferencesTest.php:17
/vagrant/myproject/tests/integration/PreferencesTest.php:136 
```

第 17 行是`assertFoo()`调用内置函数`assertEquals()`并失败的地方；第 136 行`assertFoo()`被调用。

如果我将测试更改为`assertEquals()`直接调用，我只会得到一个：

```
1) PreferencesTest::testSignupTeacher
Failed asserting that 3 is true.

/vagrant/myproject/tests/integration/PreferencesTest.php:136 
```

手册中有一些[文档](http://www.phpunit.de/manual/current/en/extending-phpunit.html#extending-phpunit.custom-assertions)，但似乎没有涵盖这一点。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-02T01:28:23.300

我对这个问题的第一个猜测（你没有使用其中一个`PHPUnit_Framework_Constraint_*`对象和`self::assertThat`）结果证明是完全不相关的！实际的答案是 phpUnit 有助于从堆栈跟踪中过滤掉它自己的代码库中的任何内容，而只是将函数留在用户空间中！

执行此操作的代码可以在*/path/to/PHPUnit/Util/Filter.php*中找到（其中*/path/to/*在我的机器上是*/usr/share/php*），感兴趣的函数是`getFilteredStacktrace`和`isFiltered`。

如果您想控制这种行为，请将您的自定义断言放入派生自 的类中`PHPUnit_Framework_TestCase`，然后从该类派生您的测试。在您的自定义类文件中，在某处调用`addFileToFilter`，如下所示：

```
class My_Base_TestCase extends PHPUnit_Framework_TestCase{
  public static function assertFoo($expected, $actual) {
    self::assertEquals($expected, $actual); 
  }
}

PHPUnit_Util_Filter::addFileToFilter(__FILE__, 'DEFAULT'); 
```

然后在另一个文件中你有：

```
class CustomTest extends My_Base_TestCase{

  /** */
  public function testSomething2(){
    $this->assertFoo( 8,  5+4 );
  }
} 
```

它的行为就像内置的`assertEquals()`.

免责声明：这是使用无证行为！我将尝试找出这种机制是否会合理地面向未来。

# javascript - 粘性js脚本的问题

> ID：11746222
> 
> 赞同：0
> 
> 时间：2012-07-31T18:00:03.437
> 
> 标签：javascript, html, css

我在我的网站上使用这个插件/代码： [http ://labs.anthonygarand.com/sticky/：](http://labs.anthonygarand.com/sticky/) [http ://www.jkogden.net/ocdb/games/](http://www.jkogden.net/ocdb/games/)

如果您访问我的网站并向下滚动，您会注意到右侧边栏也会滚动 - 这部分效果很好。但是，当您位于屏幕顶部时，您无法点击任何链接，除非您向下滚动一些链接。

在他们的演示页面上，我没有认为这是一个问题。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T18:13:19.637

在声明中：

```
#container-content-right-side, #container-content-right-side-ocdb 
```

你有

```
z-index: -1; 
```

取下它，或者放上它，`z-index: 1;`它会起作用（我使用现场检查进行了检查）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T18:12:49.580

我不知道插件为什么会这样做，但是如果你把这个 css 规则放在它上面会很好：

```
#container-content-right-side-ocdb-sticky-wrapper { height: 1px !important; } 
```

不好的答案，但它的工作...

该插件用 div 包装您的内容并为其提供上述 id。显然它使用该 div 只是作为页面的锚点，但是它将 div 的高度设置为 430px，这就是问题所在。

# java - 我应该公开组合对象吗？

> ID：11746223
> 
> 赞同：1
> 
> 时间：2012-07-31T18:00:15.360
> 
> 标签：java, oop, design-patterns

这是这个设计的用途

我需要发布一些 API，以便外部世界可以配置用户及其服务。配置用户主要包括根据输入参数（如id、密码、级别等）创建新用户和创建新的连接对象。一旦创建了用户对象，就需要进行服务配置。这是一个两步过程 - 启用服务，修改服务细节。修改服务详细信息由一组操作组成。这些操作仅特定于该服务。对于其他服务，这些操作会有所不同。

这是我当前的实现

一个用户类由 service_manager、connection、group 类组成。service_manager 类管理一组服务（比如 ServiceA、ServiceB ... ServiceN）。每个服务都有一个单独的类。

用户类有一个公共函数assignService。此函数需要一个参数，用于标识服务类。它返回相应服务类的对象。这是相同的伪代码。

```
serviceObjectA = user.assignService ('A'); 
```

稍后，此服务对象可用于执行*特定*于该服务的操作。

```
serviceObjectA.performActionA1(...);
serviceObjectA.performActionA2(...);
serviceObjectA.performActionA10(...); 
```

这是问题，我面临着这个实现：

a) performAction 函数需要很少的用户类属性（如 id、密码、位置等）和连接对象。这些用户属性是准备请求所必需的。需要连接对象通过已创建的连接发送此请求。目前，我在服务类构造函数中对其进行管理，其中，我将这些用户属性和连接对象作为构造函数参数传递。它变得有点难以管理，因为各种服务类别需要不同的用户属性。

请提出一些替代方案。

b) 将服务对象暴露给外界真的是一种好习惯吗？

我对 OOP 世界还很陌生，如果我理解错误，请道歉。如果你能用一个伪例子来演示它，我会非常棒。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T18:30:18.630

解决您的一些问题的一种方法是遵循[构建器模式](https://stackoverflow.com/questions/328496/when-would-you-use-the-builder-pattern)

因此，您不会使用包含越来越多的参数和构造函数的约定来适应所有这些不同的选项。您不需要在构造函数中提供所有必要的选项，而是有一个“构建器”类，可以使用所有需要的选项进行设置，然后构建（返回一个实例）您的类设置正确。

这类似于没有公共构造函数但没有静态工厂方法的另一种选择。如果您的构造函数变得难以区分并且参数失控，这些将很有帮助。拥有静态工厂方法意味着您可以使用方法名称更具描述性，并避免歧义和复杂性。Effective Java 有几个与此相关的主题，对于更深入地讨论好的设计模式来说，这将是一本很好的读物。

不了解您的设计及其用途的更多信息，很难说什么应该公开，什么不应该公开。在我看来，最好让您班级的用户只与“用户”交互，从而隐藏操作由各种服务执行的事实。这使复杂性降低了一点，并允许以后根据需要更改实现。

# python - 用于解析自定义配置文件的 Python 模块

> ID：11746226
> 
> 赞同：3
> 
> 时间：2012-07-31T18:00:19.703
> 
> 标签：python

我有一个这样的配置文件：

asaasdfg fdhshs "kgk jjjd" jdyesgs
gdgdg urur "irit jhd *" djjdj
trteyuueu ueue "jyuoro" ooyoy

等等。我可以使用我自己的解析器模块（使用正则表达式）对其进行解析，但这假定文件具有严格的结构（例如，每行中的元素由单个空格分隔）。是否有用于解析此类文件的通用 python 模块，以便将元素分隔的空格数无关紧要。

我看过[这个](http://docs.python.org/dev/library/configparser.html#customizing-parser-behaviour)，但它假设的文件结构与我所拥有的不同。特别是，我没有部分或键：值对。

有什么建议么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-31T18:24:45.587

虽然并不完全清楚您需要什么，但该`shlex`模块会很乐意以通常有意义的方式解析带引号的字符串等内容。例如，给定您的示例输入，以下代码：

```
for line in sys.stdin:
    parts = shlex.split(line)
    print parts 
```

将产生：

```
['asaasdfg', 'fdhshs', 'kgk jjjd', 'jdyesgs']
['gdgdg', 'urur', 'irit jhd *', 'djjdj']
['trteyuueu', 'ueue', 'jyuoro', 'ooyoy'] 
```

# sql - Django LEFT JOIN，有效吗？

> ID：11746229
> 
> 赞同：1
> 
> 时间：2012-07-31T18:00:23.050
> 
> 标签：sql, django, left-join

假设我有这个模型：

```
class PhotoAlbum(models.Model):
    title = models.CharField(max_length=128)
    author = models.CharField(max_length=128)

class Photo(models.Model):
    album = models.ForeignKey('PhotoAlbum') 
```

我想做这个查询：“找到 10 个名字以'The'开头的相册，然后给我这些相册中的所有照片。”

在 SQL 中，我可以这样做：

```
SELECT * FROM
    (SELECT * FROM photoalbum WHERE title LIKE 'The%' LIMIT 10) AS selected_albums
LEFT JOIN photo ON photo.album_id = selected_albums.id 
```

我的问题是，我怎样才能在 Django 中做到这一点？***（不触发对每个专辑的查询！）***我认为这是一个相当普遍的要求，我不敢相信没有办法做到这一点。

如果没有 Django-ey 方式，我将满足于“如何使用原始 SQL 在 Django 中实现它？”。

以下是一些不起作用的事情：

*   `select_related()`; 那是*向前* `ForeignKey`的关系，这是向后的。
*   ~~`prefetch_related()`; 也适用于前向关系。~~编辑：实际上这*确实*有效！至少对于一个级别的`ForeignKey`s。
*   `PhotoAlbum.photo_set`; 触发对每个专辑的查询。
*   我得到的最接近的是：

    相册 = PhotoAlbum.objects.all()[:10] 照片 = Photo.objects.filter(album__in=albums)

但遗憾的是，它在 MySQL 上不起作用，我被告知使用`LEFT JOIN`'s 比使用`WHERE ... IN (SELECT ...)`它创建的类型查询更好。

# 编辑

我发现了一个[关于这个问题的 3 岁邮件列表帖子](https://groups.google.com/forum/?fromgroups#!topic/django-users/9R_FoydInh0)。其中没有解决方案。

一个[6 年前的错误报告说他们不会修复它](https://code.djangoproject.com/ticket/2238)。除了“这不是它的工作方式”之外，没有给出任何理由。显然，在 RoR 中是可能的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-31T18:07:53.383

在 Django 1.4+ 中，您可以使用[`prefetch_related`](https://docs.djangoproject.com/en/dev/ref/models/querysets/#prefetch-related)：

```
PhotoAlbum.objects.filter(title__startswith='The').prefetch_related('photo')[:10] 
```

在较小的版本中尝试[django-batch-select](https://github.com/lilspikey/django-batch-select/)。

**更新**

对不起。我主要还是在1.3上，所以我用`prefetch_related`的不多。在所有其他查询类型中，您不包括`_set`附录，但 Django 显然在这里打破了约定。如果你使用它会工作`prefetch_related('photo_set')`。

如果您需要获取多个内容，您可以像使用 一样列出字段`select_related`，即：

```
prefetch_related('something', 'something_else', 'foo') 
```

但是请密切注意文档中的这一部分：

> 还请记住，与 QuerySet 一样，任何暗示不同数据库查询的后续链接方法都将忽略先前缓存的结果，并使用新的数据库查询检索数据。因此，如果您编写以下内容：
> 
> ```
>  >>> pizzas = Pizza.objects.prefetch_related('toppings')
>    >>> [list(pizza.toppings.filter(spicy=True)) for pizza in pizzas] 
> ```
> 
> ...那么，pizza.toppings.all() 已经被预取的事实对你没有帮助——事实上它会损害性能，因为你已经完成了一个你没有使用过的数据库查询。所以请谨慎使用此功能！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-31T20:30:58.413

这将起作用，并且只执行两个查询。prefetch_related 适用于反向 FK，这实际上是它的创建目的：

```
for album in PhotoAlbum.objects.filter(title__startswith='The').prefetch_related('photo_set')[:10]:
    print album.photo_set.all() 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-31T20:06:43.137

您不想在所有 PhotoAlbums 上触发 photo_set，是吗？只是指定的？

```
for p in PhotoAlbum.objects.filter(title__startswith='The'):
    p.photo_set.all() 
```

# javascript - JQuery $.ajax + php - 不运行

> ID：11746232
> 
> 赞同：0
> 
> 时间：2012-07-31T18:00:28.003
> 
> 标签：javascript, jquery

我是 jQuery 新手，如果成功更改数据库，我喜欢做一个简单的任务来显示一条消息。

JavaScript

```
var dataString = 'textareaannoun='+ textareaannoun;
 $(function(){
$('#formboard').submit(function(){
    $.ajax({
        type : 'post',
        url : 'edit_announ.php',
        dataType: 'json',
        data: $(this).serialize(),
        success: function(data){
            if(data.error){
                $('#error').css('display','block');
            }else {
                $('#accept').show();
                $('#error').hide();
            }

        }
    });

    return false;
});
}); 
```

PHP + HTML

```
 <div id='accept' align='center'><h2><img id='checkmark' src='images/successM.png' /> Alterado com sucesso!</h2></div>
    <div id='error' align='center'><h2><img id='checkmark' src='images/errorM.png' /> Verifique os dados inseridos!</h2></div>

    <h4>Alterar código do anúnio:</h4>
    <form id="formboard" name="formboard" method='post' action="">
      <textarea name="textareaannoun" id="textareaannoun"><?php echo $announc[0][0]; ?> </textarea>
      <div class="submit-button">
        </br>
        <input type="submit" name="inserir" id="inserir" value="Alterar" /> &nbsp;
        <a href="main.php"><input type="button" name="voltar" value="Voltar" /></a>

      </div>
    </form>

    <?php
        if (!empty($_POST['inserir'])) {
            $textareaannoun = $_POST['textareaannoun'];
            if(!empty($textareaannoun))
            {
             echo json_encode(array(
                    'error' => false,
                ));
                //exit;
            $changes = $announc[0][1] + 1;
            editAnnounc($textareaannoun);

            }else{
                    echo json_encode(array(
                    'error' => true,
                    'msg'   => "You haven't completed all required fileds!"
                ));
                //exit;
            }
        } 
```

结果似乎是隐藏的 div。但结果是这样的：

[http://i.stack.imgur.com/icZUd.png](http://i.stack.imgur.com/icZUd.png)

有人可以帮我一点吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T18:19:36.847

不要将 HTML 和 PHP 放在同一个文件中。Ajax 发送到的 PHP 脚本中的任何 HTML 都将被输出回成功函数。

# php - 日期字符串替换

> ID：11746236
> 
> 赞同：-2
> 
> 时间：2012-07-31T18:00:37.357
> 
> 标签：php

我有一个日期字符串，其格式为`2012/04/19`. 我想用它替换`/`标志，`-`这样它就有了格式`2012-04-19`

我试过`str_replace`了，但它不起作用。

```
str_replace('2012/04/19','/'); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-31T18:02:44.963

您正在寻找

```
str_replace("/", "-", "2012/04/19"); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-31T18:03:05.410

你没有[`str_replace`](http://php.net/manual/en/function.str-replace.php)正确调用。

```
$date = str_replace('/', '-', '2012/04/19'); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-31T18:04:11.047

str_replace 的语法是`str_replace(find,replace,string,count)`.

所以你想使用

```
str_replace('/','-','2012/04/19'); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-31T18:06:02.770

根据[文档](http://php.net/manual/en/function.str-replace.php)，您需要的代码是

```
str_replace("/", "-", "2012/04/19"); 
```

# performance - Core2 和 i7 之间巨大的解释器性能差异

> ID：11746238
> 
> 赞同：0
> 
> 时间：2012-07-31T18:00:40.633
> 
> 标签：performance, cpu, interpreter

我正在实现一个解释器，经过一番干预，我终于设法获得了不错的性能——在我的工作 PC 上——一个核心 2 处理器，解释器性能仅比相同的本机代码低 7%，这对我来说非常好。

然后我回到家，在那里运行基准测试，解释代码和本机代码之间的差异已经上升到大约 60-70%。

我的问题是为什么会有这么大的差异？核心 2 处理器是否可能遭受内存瓶颈、本机代码匮乏和“均衡”性能更接近解释代码？还是i7处理器的处理效率更高？也许有一些方法可以利用额外的功能并最大限度地提高解释器性能并使其更接近 i7 的本机性能？

测试基于这里的代码：[VM /解释器的性能改进策略？](https://stackoverflow.com/questions/11720357/performance-improvement-strategies-for-vm-interpreter?rq=1)

工作 PC - core 2 duo @ 3GHz，4 GB DDR2 ram，windows 7，GCC

家用电脑 - ivy bridge i7 @ 4GHz，16 GB DDR3 内存，windows 7，GCC

使用 -O3 优化编译，即使你不同级别的优化几乎没有区别

此外，我确保基准适合内存以避免使用 HDD。

# asynchronous - CORBA 中的异步通信

> ID：11746244
> 
> 赞同：4
> 
> 时间：2012-07-31T18:00:51.017
> 
> 标签：asynchronous, corba

最近我开始评估 CORBA 中的异步通信方法（CORBA 中自然存在的方法）。但我找不到任何说明这一点的文件。谁能帮我找到甚至实施它们？提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-01T10:25:38.800

您可以尝试两种方法。

```
1) CORBA notification service
2) CORBA one way method calls 
```

[在此处](http://www.ibm.com/developerworks/library/co-cjct7/)阅读有关 CORBA 通知服务的快速介绍。如果您想编写代码并了解更多信息，请参阅 Gerald Brose、Andreas Vogel 和 Keith Duddy 编写的 Java Programming with CORBA，第 3 版（如果您选择的语言是 Java。否则，您也可以获得概念，但不能获得示例程序）

当涉及到单向调用时，您需要引用该方法，它遵循观察者模式。当您通过 idl 定义方法时，您必须将 onEvent 方法定义为单向方法。谷歌出来的信息。干杯。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-31T19:16:58.313

虽然您没有提及您正在寻找哪种语言实现，但您可以获得以下工作代码示例：

*   带有 ACE/TAO ORB 的 C++[在这里](http://www.dre.vanderbilt.edu/~schmidt/DOC_ROOT/TAO/docs/tutorials/Quoter/AMI/index.html "C++ 异步示例")
*   使用 JacORB [pdf 书](http://www.jacorb.org/releases/3.0/ProgrammingGuide.pdf "异步方法调用")的 Java 示例。浏览第 15 章。

异步通信的参考书是 Michi Henning 的 Advanced CORBA Programming with C++。第 20 章涵盖的主题。

# winapi - 用于 DirecShow 的 Microsoft Lync colospaces

> ID：11746247
> 
> 赞同：0
> 
> 时间：2012-07-31T18:00:58.457
> 
> 标签：winapi, directshow, lync, color-space, pixelformat

我正在开发一个 DirectShow 过滤器，它将充当我的网络摄像机和 Microsoft Lync 之间的适配器。

我不确定支持哪些色彩空间格式。

关于我在哪里可以找到此类信息的任何线索？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-07-31T18:15:05.957

您可以做的最好的事情是模仿网络摄像机，它们是 DirectShow 中的“真实”（典型的非虚拟）视频源。最好的色彩空间是 24 位 RGB 和[推荐的 8 位 YUV 格式](http://msdn.microsoft.com/en-us/library/windows/desktop/dd206750%28v=vs.85%29.aspx)...。但是，最重要的是您所针对的应用程序的首选项，即 Lync。它可能要求或偏好特定的色彩空间/像素格式。您应该通过调试看到这一点。

# c++ - 寻找元组替换算法

> ID：11746251
> 
> 赞同：1
> 
> 时间：2012-07-31T18:01:26.447
> 
> 标签：c++, python

我在一次采访中被问到这个问题。我知道这是一个组合问题，但我不知道如何递归地解决这个问题。我主要是在寻找解决这类问题的方法。

> 给定一个元组，例如。`(a, b, c)`
> 
> 输出 ：
> 
> ```
> (*, *, *), (*, *, c), (*, b, *), (*, b, c), (a, *, *), (a, *, c), (a, b, *), (a, b, c) 
> ```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-31T19:12:50.277

这是一个简单的单线使用[`itertools.product`](http://docs.python.org/dev/library/itertools.html#itertools.product)：

```
list(itertools.product(*(('*', x) for x in seq))) 
```

这给出了与请求相同的顺序：

```
>>> list(itertools.product(*(('*', x) for x in "abc")))
[('*', '*', '*'), ('*', '*', 'c'), ('*', 'b', '*'), ('*', 'b', 'c'), ('a', '*', '*'), ('a', '*', 'c'), ('a', 'b', '*'), ('a', 'b', 'c')] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-31T18:05:29.677

实现这个特定问题的一种简单方法：对于一个 n 元组，只需从 0 循环到 2^n - 1，对于中间的每个整数，如果第 k 个二进制数字是 1，那么第 k 个位置在元组中是元组中的原始元素；如果那个数字是0，那么第k个位置是*。

当然，这种方法容易溢出，而且不是递归的；但是，它可以很容易地重写为递归程序（只需递归地探索每个二进制数字）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-31T18:40:04.930

假设顺序无关紧要，那就去吧。我使用了一个内部字符串来使其更容易实现。该代码也适用于任何 n 元组数组，因为`n`它是一个正整数。

关于这个实现的一些解释：将基本情况设置为 1 元组（在我的实现中，长度为 1 的字符串）。在这种情况下，返回`*`和参数的内容。否则，通过将当前元素替换为当前元素`*`或当前元素的内容来推进递归中的一个元素。

如果可以按照上述算法绘制决策树，则更容易理解。

```
def _combination(s):
    if len(s) == 1:
        return ['*', s]
    else:
        rest = _combination(s[1:])
        output = []
        for r in rest:
            output.append('*' + r)
            output.append(s[0] + r)
        return output

def combination(t):
    s = ''.join(c for c in t)
    result = _combination(s)
    output = []
    for r in result:
        output.append(format_tuple(r))
    print ', '.join(output)

def format_tuple(s):
    return '(' + ', '.join(s) + ')'

if __name__ == '__main__':
    t = ('a', 'b', 'c')
    combination(t) 
```

程序的输出：

```
(*, *, *), (a, *, *), (*, b, *), (a, b, *), (*, *, c), (a, *, c), (*, b, c), (a, b, c) 
```

根据凯文的评论更新。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-31T18:54:31.520

类似于 clwen 的答案，但使用了非常适合组合问题的生成器函数：

```
def combinations(seq):
    if len(seq) == 1:
        yield ('*',)
        yield (seq[0],)
    else:
        for first in combinations([seq[0]]):
            for rest in combinations(seq[1:]):
                yield first + rest

print list(combinations("abc")) 
```

输出：

```
[('*', '*', '*'), ('*', '*', 'c'), ('*', 'b', '*'), ('*', 'b', 'c'), 
('a', '*', '*'), ('a', '*', 'c'), ('a', 'b', '*'), ('a', 'b', 'c')] 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-31T19:05:08.197

每个涉及二进制计数的解决方案（比组合的好得多恕我直言）

```
t_str = raw_input("Enter Tuple Values Separated By Spaces:")
t = t_str.split()
n = len(t)
bin_template = "{0:0"+str(n)+"b}"
for i in range(2**n):
    bval = bin_template.format(i)
    solution= "("+",".join(["*" if bval[i] == "0" else t[i] for i in range(n)])+")"
    print solution 
```

又好又短又快……它应该处理任意大小的元组，最大为 32（或者不管大整数是……而且可能更大，因为 python 使用任意大的整数）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-01T17:23:57.933

由于这是一个面试问题，面试官可能正在寻找对递归原理的理解，因为这通常是这类组合问题的起点。

这段代码怎么样，以表明您理解：

```
def generate(x, state, level):
    if level == len(x):
        print state
    else:
        state[level] = '*'
        generate(x, state, level+1)
        state[level] = x[level]
        generate(x, state, level+1)

if __name__ == '__main__':
    x = [ 'a','b','c']
    generate(x,['*','*','*'], 0) 
```

# c++ - C++ 中按位运算符的返回类型

> ID：11746257
> 
> 赞同：6
> 
> 时间：2012-07-31T18:01:37.850
> 
> 标签：c++, types, operators

当我为小型数学向量实现模板类时，我遇到了一个问题。对于算术运算，返回类型`T1 lhs + T2 rhs`是`std::common_type<T1, T2>::type.` 但是以下的返回类型是什么（例如 T1 有符号和 T2 无符号或相反，或 T1 char 和 T2 无符号 long long int 等......）：

```
T1 lhs & T2 rhs ?
T1 lhs | T2 rhs ?
T1 lhs ^ T2 rhs ?
T1 lhs << T2 rhs ?
T1 lhs >> T2 rhs ? 
```

非常感谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-31T18:06:15.900

我假设您将在向量上实现逐位运算。基本上按位运算是整数运算，我认为没有理由不将其结果设为`std::common_type<T1, T2>::type`.

移位的结果不依赖于右操作数。只需使用 T1 即可。

# objective-c - startMonitoringForRegion 未创建区域

> ID：11746262
> 
> 赞同：1
> 
> 时间：2012-07-31T18:01:47.880
> 
> 标签：objective-c, monitoring, region, geofencing

我正在尝试创建地理围栏并使用 CLLocationManager 和 startMonitoringForRegion: 对其进行监控。问题是，不仅我的代表没有接到任何电话（是的，我已经实现了所有方法），而且该区域没有存储在 [locationManager moniteredRegions] 集中。运行以下代码后的日志显示：

2012-07-31 13:46:54.208 GeofencingTest[2357:f803] 创建区域：

是的 - 我检查了 regionMonitoringEnabled 和 regionMonitoringAvailable。不——我没有在设备上试过这个，只有模拟器。是的 - 我可以通过执行 [locationManager startUpdatingLocation] 和 CLLocation *location = locationManager.location; 从 CLLocationManager 获取位置更新。

请帮忙！:)

**LocationDelegate.m**

```
- (void) createGeofence:(NSString *)identifier withCenter:(CLLocationCoordinate2D)center withRadius:(CLLocationDistance) radius{
   if ([CLLocationManager regionMonitoringEnabled] && [CLLocationManager regionMonitoringAvailable]){
       CLRegion *region = [[CLRegion alloc] initCircularRegionWithCenter:center radius:radius identifier:identifier];
       NSLog(@"should be succesful");
       [locationManager startMonitoringForRegion:region];
   }

   NSLog(@"Created regions:");
   for (CLRegion *my_region in [locationManager monitoredRegions]){
       NSLog(@"    Region: %@", my_region.identifier);
   }    
}
- (id) init{
   self = [super init];
   if (self){
      locationManager = [[CLLocationManager alloc] init];
      locationManager.delegate = self;
      locationManager.desiredAccuracy = kCLLocationAccuracyBest;
   }
   return self;
} 
```

**其他类.m**

```
- (IBAction)createGeofence:(UIButton *)sender{

   float latitude = [latitudeField.text floatValue];
   float longitude = [longitudeField.text floatValue];
   CLLocationDistance radius = [radiusField.text floatValue];

   CLLocationAccuracy desiredAccuracy = [self getAccuracyConvertedToMeters];

   [self.locationManagerObject createGeofence:identifierField.text
                                   withCenter:CLLocationCoordinate2DMake(latitude, longitude) 
                                   withRadius:radius
                                 withAccuracy:desiredAccuracy]; 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-18T10:14:08.100

可能是当您记录创建的区域时，该区域尚未被监控。我认为您应该尝试调用区域监控的委托方法并在那里查找受监控的区域。

```
- (void)locationManager:(CLLocationManager *)manager didStartMonitoringForRegion:(CLRegion *)region {
    NSLog(@"Start monitoring for region: %@", region.identifier);
    for (CLRegion *my_region in [manager monitoredRegions]){
        NSLog(@"Region: %@", my_region.identifier);
    }
}

- (void)locationManager:(CLLocationManager *)manager monitoringDidFailForRegion:(CLRegion *)region withError:(NSError *)error {
    NSLog(@"Error: %@", error);
} 
```

# javascript - EmberJS：从集合视图访问项目视图

> ID：11746263
> 
> 赞同：1
> 
> 时间：2012-07-31T18:01:49.847
> 
> 标签：javascript, ember.js

如何从集合中访问项目视图？基本上我有一个表（我的集合视图），它有行（作为 itemViewClasses）。我想将特定属性添加到单击的行中，然后从表的所有其他行中删除该属性。我想要一种从集合视图中引用我的项目视图的方法，以便我可以跟踪哪一行具有该属性并添加或删除该属性（更像是设置和重置该属性）（如单选按钮）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T12:40:04.733

您可以在初始化期间为每个元素添加一个布尔属性“isSelected”（最初设置为 false）。

每当您单击任何元素时，将所有元素的“isSelected”属性设置为“false”。

然后将当前“内容”（在 itemViewClass 中）的“isSelected”属性设置为 true。

现在，在车把中使用 {{bindAttr class="isSelected:active"}} 将相应的 CSS 应用于您的表格行。希望这可以帮助 ！

# html - 对齐 CSS 菜单文本左侧 besie 菜单图像

> ID：11746273
> 
> 赞同：0
> 
> 时间：2012-07-31T18:02:28.140
> 
> 标签：html, css, menu, css-float, menubar

我有一个简单的 csss 菜单，其中包含与左侧对齐的背景图像，并且我希望文本也漂浮在图像的左侧。html:

```
<div class='mmenu'><ul><li><a id="li6" class="menu-news" href= "viewNews.php" >News</a></li></ul></div> 
```

CSS：

```
.mmenu{
    height: fit-content;
    width: fit-content;
    float: left;
    position: fixed;
}
.mmenu ul
{
    margin-top: 20px;
    margin-left: 15px;
}
.mmenu li
{
    margin-bottom: 0px;
    width: 150px;
    color: white;
}
.mmenu a {
    font-size:14px;
    font-family: Arial, sans-serif;
    font-style: normal;
    font-weight:bold;
    display: block;
    padding-top:12px;
    padding-bottom: 7px;
    text-align:left;
    padding-right: 12px;
    padding-left: 15px;
    position: relative;
}
.menu-news{
    background-image:url('menu icons/css-sprite.png');
    background-repeat: no-repeat; background-position:5px 17px;
} 
```

**现在的问题是菜单文本漂浮在图像上方，那么如何在图像和文本之间留出空间**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T18:08:53.190

如果我理解正确，您可以在`menu-news`类中添加填充，以推动文本，使其不会位于背景中的图像之上。

```
.menu-news{
    background-image:url('menu icons/css-sprite.png');
    background-repeat: no-repeat; 
    background-position:5px 17px;
    padding-left: 50px; /* Or whatever padding is appropriate */
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-31T18:10:27.000

根据需要调整背景位置或填充文本。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-31T18:11:49.490

你曾经用过`background-position`你一次，否则`background-image`你可以改变形象，`position`

用于`Padding-left`您的班级`menu-news` **或**将填充应用于`.mmenu a{ }`

**例子：**

```
.mmenu a {
    font-size:14px;
    font-family: Arial, sans-serif;
    font-style: normal;
    font-weight:bold;
    display: block;
    padding-top:12px;
    padding-bottom: 7px;
    padding-left: xx px /* added now */
    text-align:left;
    padding-right: 12px;
    padding-left: 15px;
    position: relative;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-31T18:12:06.893

增加左边的填充
[http://tinkerbin.com/YdDw9q3E](http://tinkerbin.com/YdDw9q3E)

# html - 将传感器数据从 iPhone 返回到服务器的 HTML5 页面

> ID：11746275
> 
> 赞同：0
> 
> 时间：2012-07-31T18:02:37.760
> 
> 标签：html, accelerometer, sensors, gyroscope

在过去的几天里，我正在研究一个使用 iPhone 的陀螺仪在计算机屏幕上移动项目的项目，我使用了一个名为“Sensorlogger”的应用程序，它可以使用 UDP 将传感器数据流式传输到计算机；一个 Java 应用程序接收到该数据并将其转换为项目的位置（我将它用于一个名为 Minecraft 的游戏）；但现在我需要另一件事：我需要在 iPhone 上有一个按钮来选择屏幕上的项目，但 Sensorlogger 应用程序不允许这样做，而且我在 Apple 没有 99 美元的开发人员许可证，所以我可以用按钮制作我自己的应用程序；我想使用 HTML5 来检索传感器数据，但我也想在屏幕上添加一个按钮（只是一个灰色矩形，它不需要花哨，只是功能），

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T13:17:13.460

也许[Ratchet](https://github.com/maker/ratchet)（具有简单 HTML、CSS 和 JS 组件的原型移动应用程序）可以帮助您。

# php - json_decode 直观地添加数字数组键

> ID：11746276
> 
> 赞同：0
> 
> 时间：2012-07-31T18:02:41.983
> 
> 标签：php, json

json_decode 函数需要严格格式的 JSON，并且不会接受没有键的值，但是，我打算使用键的方式并不重要，并且重复手动指定数字键很乏味。

最明显的答案是编写我自己的“JSON”解码器，如果在被解码的字符串中省略了数字键，它将直观地分配数字键。我正在尝试确定是否有我没有看到的更明显的解决方案。

* * *

更具体地说，我希望能够解码如下字符串：

```
{"my", "array", "of", "values"} 
```

好像是这样写的

```
{"0":"my", "1":"array", "2":"of", "3":"values"} 
```

该指数的值没有实际意义。我将使用 foreach 并且顺序无关紧要，它只是额外输入以这种方式形成我的源 JSON，因此搜索快捷方式。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T18:05:17.910

您可以像这样使用 json 数组结构：

`[1,2,3,4,5]`

```
<?php
$json = '[1,2,3,4,5]';
print_r(json_decode($json));

/*
Array
(
    [0] => 1
    [1] => 2
    [2] => 3
    [3] => 4
    [4] => 5
)
*/
?> 
```

# c# - 正则表达式 数字范围或只是一个数字

> ID：11746279
> 
> 赞同：1
> 
> 时间：2012-07-31T18:02:54.943
> 
> 标签：c#, asp.net, regex

我要求一个文本框具有一系列值，我正在使用该模式`^(\d{1,3})\-(\d{1,3})$`并且这似乎有效。

另外现在他们想要：一个正**的**2 位数字，限制在`0 to 20` **OR** 一个正的 2 位范围内`(01-20 or 1-3 or 1-03 or 01-4 and so on)`

我正在使用`^\d{2}([\-]\d{2})?$`，但我不清楚如何施加 0 到 20 的限制

使用 C# ASP.Net RegularExpressionValidator。

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T19:20:35.930

pattern1`^(20|[10]?\d)$`可以匹配 0-20

pattern2`^(20|[10]?\d)(?:-(20|[10]?\d))?$`可以匹配 "0-20"、"1-20"、"2-20"..."20-20" 或 0 到 20

但坏消息是 pattern2 将匹配像 "5-1", "20-3" 这样的字符串

对于这个问题，灵丹妙药不存在，您需要编写一些代码来检查范围（从组 1 和组 2 中获取字符串，将它们转换为整数进行比较）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T18:05:24.653

对于 20 位的限制，您必须单独计算数字。确保它是 20 或第一个数字是 0-1，第二个是 0-9。

IE`20 | ([0-1]?[0-9])`

编辑：所以整个事情应该是`^\d{2}([-](20 | ([0-1]?[0-9])))?$`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-31T18:12:23.640

试试这个：([01]?\d|2\d)。

这可能会满足您的需求。

# powershell - 比较 Powershell 中的 Filehash

> ID：11746287
> 
> 赞同：11
> 
> 时间：2012-07-31T18:03:23.933
> 
> 标签：powershell, hash

我是一个powershell。下午的大部分时间，我一直盯着我的屏幕，试图弄清楚如何比较两个不同目录中多个文件的文件哈希。该脚本会将文件从 FTP 站点下载到目录 ($cDlPath) 并最终将它们复制到另一个目录 ($cDestPath)。我想比较文件中的文件哈希，以确保下载后没有任何变化。我正在使用 Get-Hash cmdlet 来获取文件哈希，但我不知道如何比较这两个哈希。如果文件不相等，我希望能够按名称识别更改的文件，以便检查文件。

我一直在摆弄下面的代码，但这似乎不是我所追求的。

```
Compare-Object `
-ReferenceObject $(Get-ChildItem $cDestPath -Recurse | Where-Object {!$_.psiscontainer } | Get-Hash -Algorithm $cHashAlg) `
-DifferenceObject $(Get-ChildItem  $cDlPath -Recurse | Where-Object {!$_.psiscontainer } | Get-Hash -Algorithm $cHashAlg) 
```

任何帮助将不胜感激。

* * *

我正在使用下面的代码，我似乎更接近一点。

```
Compare-Object $(Get-ChildItem $cDlPath -Recurse $_ | Where-Object { !$_.PsIsContainer } |  
  Select-Object Name, FullName, Length, @{Name=”SHA256 Hash”; Expression={ Get-Hash $_.FullName  
  -Algorithm "SHA256" }}, LastWriteTime) $( Get-ChildItem $cDestPath -Recurse $_ | Where-Object  
  { !$_.PsIsContainer } | Select-Object Name, FullName, Length, @{Name=”SHA256 Hash”; 
  Expression={ Get-Hash $_.FullName -Algorithm "SHA256" }}, LastWriteTime) -property @
  ("Name", “FullName”,”SHA256 Hash”, "Length", "LastWriteTime" ) | Add-Content -Path $cLogFile 
```

但它看起来仍然不完全正确，因为有些哈希值是相同的，并且日志文件的输出很丑陋。仅当文件具有相同的哈希值时，它们才应位于日志文件中。

```
@{Name=nothing.xlsx; FullName=C:\Test\nothing.xlsx; SHA256 Hash=E74424B6324DE014CB0C896DA29D67A2A729E31DF57119E840CA4BD9A9E41754; Length=8891; LastWriteTime=7/31/2012 1:33:11 PM; SideIndicator=<=}
@{Name=test.txt; FullName=C:\Test\test.txt; SHA256 Hash=FC43E73579DB001751A29C1F7A8E2E36E46A53662B63013F0AE500AA896DE056; Length=174; LastWriteTime=7/31/2012 4:52:52 PM; SideIndicator=<=}
@{Name=testfile.txt; FullName=C:\Test\testfile.txt; SHA256 Hash=2B2DB80CAF93224A49A7C94E8EA5BCB1B86D421EA2DB83285149ECAE6DEAA105; Length=415; LastWriteTime=7/27/2012 12:01:21 PM; SideIndicator=<=}
@{Name=nothing.xlsx; FullName=C:\Test\Old\nothing.xlsx; SHA256 Hash=22603417927343A485862CE93790203EE7C2DB092C2060C92D44B736A01FD37E; Length=8978; LastWriteTime=7/31/2012 4:40:43 PM; SideIndicator=<=}
@{Name=test.txt; FullName=C:\Test\Old\test.txt; SHA256 Hash=FC43E73579DB001751A29C1F7A8E2E36E46A53662B63013F0AE500AA896DE056; Length=174; LastWriteTime=7/31/2012 4:52:52 PM; SideIndicator=<=}
@{Name=testfile.txt; FullName=C:\Test\Old\testfile.txt; SHA256 Hash=0B35A9F7F500B46469E2C1759F92D222983C4FDF4AAE316C0F2861FC70D0FD2B; Length=447; LastWriteTime=7/31/2012 4:52:40 PM; SideIndicator=<=} 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2014-01-08T17:07:42.657

我意识到这是一个陈旧的线程（16 个月大），但它是谷歌的最高结果，这意味着它得到了很多观点。我认为这可能对其他人有益...

Mack 是对的，使用 Get-Hash 有一个更漂亮、更简单的解决方案。您可以通过比较哈希来简单地比较 IF 语句中的哈希。

```
# Get the file hashes
$hashSrc = Get-FileHash $file -Algorithm "SHA256"
$hashDest = Get-FileHash $file2 -Algorithm "SHA256"

# Compare the hashes & note this in the log
If ($hashSrc.Hash -ne $hashDest.Hash)
{
  Add-Content -Path $cLogFile -Value " Source File Hash: $hashSrc does not 
  equal Existing Destination File Hash: $hashDest the files are NOT EQUAL."
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T17:59:54.633

必须有一个更漂亮的解决方案，但这是我最终使用的。

```
# Get the file hashes
$hashsourcefile = Get-Hash $file -Algorithm "SHA256"
$hashdestfile = Get-Hash $file2 -Algorithm "SHA256"

# Compare the hashes
Compare-Object -Referenceobject $hashsourcefile -Differenceobject $hashdestfile | % { If ($_.Sideindicator -ne " ==") {$diff+=1} }                  

# The Hashes are different. Note this in the log
if ($diff -ne 0)
{
    Add-Content -Path $cLogFile -Value " Source File Hash: $hashsourcefile does not equal 
    Existing Destination File Hash: $hashdestfile the files are NOT EQUAL."
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-09-24T19:42:05.453

## 使用 MD5 散列的递归目录文件内容差异

我编写了这个纯 PowerShell v3+（无依赖项）递归目录差异，它通过 MD5 哈希比较内容。使用`-ExportSummary [summary/path]`参数，它将导出一组左右手目录的 csv 差异以及差异的摘要文件。否则将在标准输出上给出标准的比较对象差异结果。您可以将 rdiff.ps1 文件拖放到您的路径`Set-ExecutionPolicy RemoteSigned`中，也可以将内容直接复制到您的脚本中。

**`USAGE: rdiff path/to/left,path/to/right [-s path/to/summary/dir]`**

这是[要点](https://gist.github.com/cchamberlain/883959151aa1162e73f1)。推荐使用 gist 版本，因为它可能在下面的版本之上添加了额外的功能。

```
#########################################################################
### USAGE: rdiff path/to/left,path/to/right [-s path/to/summary/dir]  ###
### ADD LOCATION OF THIS SCRIPT TO PATH                               ###
#########################################################################
[CmdletBinding()]
param (
  [parameter(HelpMessage="Stores the execution working directory.")]
  [string]$ExecutionDirectory=$PWD,

  [parameter(Position=0,HelpMessage="Compare two directories recursively for differences.")]
  [alias("c")]
  [string[]]$Compare,

  [parameter(HelpMessage="Export a summary to path.")]
  [alias("s")]
  [string]$ExportSummary
)

### FUNCTION DEFINITIONS ###

# SETS WORKING DIRECTORY FOR .NET #
function SetWorkDir($PathName, $TestPath) {
  $AbsPath = NormalizePath $PathName $TestPath
  Set-Location $AbsPath
  [System.IO.Directory]::SetCurrentDirectory($AbsPath)
}

# RESTORES THE EXECUTION WORKING DIRECTORY AND EXITS #
function SafeExit() {
  SetWorkDir /path/to/execution/directory $ExecutionDirectory
  Exit
}

function Print {
  [CmdletBinding()]
  param (
    [parameter(Mandatory=$TRUE,Position=0,HelpMessage="Message to print.")]
    [string]$Message,

    [parameter(HelpMessage="Specifies a success.")]
    [alias("s")]
    [switch]$SuccessFlag,

    [parameter(HelpMessage="Specifies a warning.")]
    [alias("w")]
    [switch]$WarningFlag,

    [parameter(HelpMessage="Specifies an error.")]
    [alias("e")]
    [switch]$ErrorFlag,

    [parameter(HelpMessage="Specifies a fatal error.")]
    [alias("f")]
    [switch]$FatalFlag,

    [parameter(HelpMessage="Specifies a info message.")]
    [alias("i")]
    [switch]$InfoFlag = !$SuccessFlag -and !$WarningFlag -and !$ErrorFlag -and !$FatalFlag,

    [parameter(HelpMessage="Specifies blank lines to print before.")]
    [alias("b")]
    [int]$LinesBefore=0,

    [parameter(HelpMessage="Specifies blank lines to print after.")]
    [alias("a")]
    [int]$LinesAfter=0,

    [parameter(HelpMessage="Specifies if program should exit.")]
    [alias("x")]
    [switch]$ExitAfter
  )
  PROCESS {
    if($LinesBefore -ne 0) {
      foreach($i in 0..$LinesBefore) { Write-Host "" }
    }
    if($InfoFlag) { Write-Host "$Message" }
    if($SuccessFlag) { Write-Host "$Message" -ForegroundColor "Green" }
    if($WarningFlag) { Write-Host "$Message" -ForegroundColor "Orange" }
    if($ErrorFlag) { Write-Host "$Message" -ForegroundColor "Red" }
    if($FatalFlag) { Write-Host "$Message" -ForegroundColor "Red" -BackgroundColor "Black" }
    if($LinesAfter -ne 0) {
      foreach($i in 0..$LinesAfter) { Write-Host "" }
    }
    if($ExitAfter) { SafeExit }
  }
}

# VALIDATES STRING MIGHT BE A PATH #
function ValidatePath($PathName, $TestPath) {
  If([string]::IsNullOrWhiteSpace($TestPath)) {
    Print -x -f "$PathName is not a path"
  }
}

# NORMALIZES RELATIVE OR ABSOLUTE PATH TO ABSOLUTE PATH #
function NormalizePath($PathName, $TestPath) {
  ValidatePath "$PathName" "$TestPath"
  $TestPath = [System.IO.Path]::Combine((pwd).Path, $TestPath)
  $NormalizedPath = [System.IO.Path]::GetFullPath($TestPath)
  return $NormalizedPath
}

# VALIDATES STRING MIGHT BE A PATH AND RETURNS ABSOLUTE PATH #
function ResolvePath($PathName, $TestPath) {
  ValidatePath "$PathName" "$TestPath"
  $ResolvedPath = NormalizePath $PathName $TestPath
  return $ResolvedPath
}

# VALIDATES STRING RESOLVES TO A PATH AND RETURNS ABSOLUTE PATH #
function RequirePath($PathName, $TestPath, $PathType) {
  ValidatePath $PathName $TestPath
  If(!(Test-Path $TestPath -PathType $PathType)) {
    Print -x -f "$PathName ($TestPath) does not exist as a $PathType"
  }
  $ResolvedPath = Resolve-Path $TestPath
  return $ResolvedPath
}

# Like mkdir -p -> creates a directory recursively if it doesn't exist #
function MakeDirP {
  [CmdletBinding()]
  param (
    [parameter(Mandatory=$TRUE,Position=0,HelpMessage="Path create.")]
    [string]$Path
  )
  PROCESS {
    New-Item -path $Path -itemtype Directory -force | Out-Null
  }
}

# GETS ALL FILES IN A PATH RECURSIVELY #
function GetFiles {
  [CmdletBinding()]
  param (
    [parameter(Mandatory=$TRUE,Position=0,HelpMessage="Path to get files for.")]
    [string]$Path
  )
  PROCESS {
    ls $Path -r | where { !$_.PSIsContainer }
  }
}

# GETS ALL FILES WITH CALCULATED HASH PROPERTY RELATIVE TO A ROOT DIRECTORY RECURSIVELY #
# RETURNS LIST OF @{RelativePath, Hash, FullName}
function GetFilesWithHash {
  [CmdletBinding()]
  param (
    [parameter(Mandatory=$TRUE,Position=0,HelpMessage="Path to get directories for.")]
    [string]$Path,

    [parameter(HelpMessage="The hash algorithm to use.")]
    [string]$Algorithm="MD5"
  )
  PROCESS {
    $OriginalPath = $PWD
    SetWorkDir path/to/diff $Path
    GetFiles $Path | select @{N="RelativePath";E={$_.FullName | Resolve-Path -Relative}},
                            @{N="Hash";E={(Get-FileHash $_.FullName -Algorithm $Algorithm | select Hash).Hash}},
                            FullName
    SetWorkDir path/to/original $OriginalPath
  }
}

# COMPARE TWO DIRECTORIES RECURSIVELY #
# RETURNS LIST OF @{RelativePath, Hash, FullName}
function DiffDirectories {
  [CmdletBinding()]
  param (
    [parameter(Mandatory=$TRUE,Position=0,HelpMessage="Directory to compare left.")]
    [alias("l")]
    [string]$LeftPath,

    [parameter(Mandatory=$TRUE,Position=1,HelpMessage="Directory to compare right.")]
    [alias("r")]
    [string]$RightPath
  )
  PROCESS {
    $LeftHash = GetFilesWithHash $LeftPath
    $RightHash = GetFilesWithHash $RightPath
    diff -ReferenceObject $LeftHash -DifferenceObject $RightHash -Property RelativePath,Hash
  }
}

### END FUNCTION DEFINITIONS ###

### PROGRAM LOGIC ###

if($Compare.length -ne 2) {
  Print -x "Compare requires passing exactly 2 path parameters separated by comma, you passed $($Compare.length)." -f
}
Print "Comparing $($Compare[0]) to $($Compare[1])..." -a 1
$LeftPath   = RequirePath path/to/left $Compare[0] container
$RightPath  = RequirePath path/to/right $Compare[1] container
$Diff       = DiffDirectories $LeftPath $RightPath
$LeftDiff   = $Diff | where {$_.SideIndicator -eq "<="} | select RelativePath,Hash
$RightDiff   = $Diff | where {$_.SideIndicator -eq "=>"} | select RelativePath,Hash
if($ExportSummary) {
  $ExportSummary = ResolvePath path/to/summary/dir $ExportSummary
  MakeDirP $ExportSummary
  $SummaryPath = Join-Path $ExportSummary summary.txt
  $LeftCsvPath = Join-Path $ExportSummary left.csv
  $RightCsvPath = Join-Path $ExportSummary right.csv

  $LeftMeasure = $LeftDiff | measure
  $RightMeasure = $RightDiff | measure

  "== DIFF SUMMARY ==" > $SummaryPath
  "" >> $SummaryPath
  "-- DIRECTORIES --" >> $SummaryPath
  "`tLEFT -> $LeftPath" >> $SummaryPath
  "`tRIGHT -> $RightPath" >> $SummaryPath
  "" >> $SummaryPath
  "-- DIFF COUNT --" >> $SummaryPath
  "`tLEFT -> $($LeftMeasure.Count)" >> $SummaryPath
  "`tRIGHT -> $($RightMeasure.Count)" >> $SummaryPath
  "" >> $SummaryPath
  $Diff | Format-Table >> $SummaryPath

  $LeftDiff | Export-Csv $LeftCsvPath -f
  $RightDiff | Export-Csv $RightCsvPath -f
}
$Diff
SafeExit 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-31T21:09:02.497

所以这是一个未经测试的解决方案，至少应该让你朝着正确的方向前进：

```
#first make a hash table of the files in folder 1 where the keys are the file hashes and the values are the file objects
$folder1Files = @{}
foreach($file in $cDestPath){
    $hash = Get-Hash $file
    if($folder1Files.ContainsKey($hash)){
        # A hash collision isn't likely but not unheard of. You should probably just handle them manually
        'There was a hash collision for {0} and {1} in folder {2}' -f $file.Name, $folder1Files[$hash].Name, $cDestPath
    }else{
        $folder1Files[$hash] = $file
    }
}
# Now do the same thing for folder 2
$folder2Files = @{}
foreach($file in $cDlPath){
    $hash = Get-Hash $file
    if($folder2Files.ContainsKey($hash)){
        # A hash collision isn't likely but not unheard of. You should probably just handle them manually
        'There was a hash collision for {0} and {1} in folder {2}' -f $file.Name, $folder1Files[$hash].Name, $cDlPath
    }else{
        $folder2Files[$hash] = $file
    }
}
# Actually you should really take those two bits and generalize them to a function that you pass a folder to and it returns the hash table.

# Now that you have your two sets of file hashes, use Compare-Object to find the diffs
$comparison = Compare-Object $folder1Files.Keys $folder2Files.Keys
foreach($diff in $comparison){
    if($diff.SideIndicator -eq '<='){
        'File {0} in folder {1} is different from any file in the other folder' -f $folder1Files[$diff.InputObject], $cDestPath
    }else{
        'File {0} in folder {1} is different from any file in the other folder' -f $folder2Files[$diff.InputObject], $cDLPath
    }
} 
```

就像我说的，我现在没有时间测试和解决任何错误，但至少应该作为我如何解决这个问题的伪代码。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-31T22:21:57.393

这对我来说效果很好 - 比较两个源代码分支。计数为 1 的组在另一个分支中没有 MD5 哈希孪生，例如：

```
$paths = 'c:\proj\trunk\source','c:\proj\branches\release\1.0\source'
ls $paths -r *.cs | Where {$_.PSPath -notmatch '\\obj\\'} | 
    Get-Hash | Select Path,HashString | Group HashString | 
    Where {$_.Count -eq 1} | Sort Count -desc | Format-List 
```

# java - 在 Java 中，我想获取一个表示十六进制的字符串并将其转换为 int，同时保留“0x”前缀

> ID：11746288
> 
> 赞同：1
> 
> 时间：2012-07-31T18:03:25.743
> 
> 标签：java, hex, int

看看 int a 和 int b 如何在十六进制值之前添加前缀“0x”？我想从一个字符串中制作更多这些。我尝试使用 Integer 中的 parseInt，但我得到了 NumberFormatException。任何人都可以帮忙吗？

```
int a = 0xA;
int b = 0x4;
String f = "0xF";    
int d = Integer.parseInt(f, 16); 
```

我想要“int d = 0xF”

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-31T18:06:47.390

这个怎么样？

```
String f = "0xF";    
int d = Integer.parseInt(f.substring(2), 16);
System.out.println(d); 
```

**输出：**

```
15 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-31T18:09:57.167

尝试：

```
Integer.decode("0x64"); 
```

之前在 SO 中提出了类似的问题，这里有一个链接以获取更多信息：

[在 Java 中解析整数字符串](https://stackoverflow.com/questions/5599534/parsing-integer-strings-in-java)

# java - 如何解析Java中xml标签中引号中的值？

> ID：11746295
> 
> 赞同：0
> 
> 时间：2012-07-31T18:03:55.743
> 
> 标签：java, xml, dom

假设我有一个 xml 标签，例如：

```
<test val="val1 ">Test XML</test> 
```

每当文件中出现标记时，我想解析值“val1” `<test>`，以便我可以将其保存到数组中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T18:18:28.340

您可以从文件中加载 XML 并选择所有带有标签名称的元素`test`并从中提取属性值。

基本上：

`doc.getElementsByTagName("test")`为了选择所有`"test"`元素，并且对于找到的每个元素，您可以选择其名为`"val"`with的属性，`node.getAttributes().getNamedItem("val")`并且从该属性中选择，如果不为 null，则仅`getTextContent()`获取其文本内容。

* * *

示例代码可能类似于：

```
// temporary result list just to store the values found
ArrayList<String> result = new ArrayList<String>();

DocumentBuilderFactory documentBuilderFactory = DocumentBuilderFactory.newInstance();
DocumentBuilder documentBuilder = documentBuilderFactory.newDocumentBuilder();
Document doc = documentBuilder.parse(new ByteArrayInputStream("<document><test val=\"val1\">Test XML</test><test val=\"val2\">Test XML</test><test val=\"val3\">Test XML</test></document>".getBytes()));
// you could use something like: documentBuilder.parse(new FileInputStream("fileName.ext")); instead

// get test nodes and iterate over it checking test attribute
NodeList elements = doc.getElementsByTagName("test");
for (int i = 0; i < elements.getLength(); i++) {
    Node node = elements.item(i);
    Node attribute = node.getAttributes().getNamedItem("val");
    if (attribute != null) {
        result.add(attribute.getTextContent());
    }
}

// get result values in a string array (if collection is preferred use result instead)
String[] array = result.toArray(new String[] {});

// just print it in a readable format
System.out.println(Arrays.toString(array)); 
```

这将打印：

```
[val1, val2, val3] 
```

# c# - 将轻量级 Web 服务器嵌入到 .net 应用程序（node.js）中？

> ID：11746298
> 
> 赞同：21
> 
> 时间：2012-07-31T18:04:11.297
> 
> 标签：c#, .net, node.js, embeddedwebserver, awesomium

我有一个使用 .NET 内置的 Awesomium 构建的项目，它需要使用 Flash。Flash 在尝试访问本地内容（视频播放器）时会引发安全错误，并且 Awesomium 提供的解决方案尚未移植到 .NET 包装器。我想知道是否有一种相当直接的方法可以在应用程序中包含一个运行时 Web 服务器，我可以在其中选择一些任意端口并在应用程序运行时创建一个 localhost 服务器并将我的 Awesomium 浏览器指向那里。

有任何想法吗？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-07-31T18:24:26.210

[NHttp](https://github.com/pvginkel/NHttp)提供了一个带有请求解析的 HTTP 服务器，但你必须滚动你自己的响应。还有[Kayak](https://github.com/kayak/kayak)和框架自己的[HttpListener](http://msdn.microsoft.com/en-us/library/system.net.httplistener.aspx)。

[Nancy](http://nancyfx.org/)是一个完整的 MVC 框架，支持 ASP.NET Razor 语法，并且有很多配置和可扩展性选项。nuget 上有一个[自托管包。](http://nuget.org/packages/Nancy.Hosting.Self)

如果您只需要提供一个 SWF 文件和一些 JSON 数据，那么第一组可能更易于集成——如果您需要呈现完整的网页，我会推荐 Nancy。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2015-02-12T12:13:56.560

这是我去年写的另一种选择，并且对我很有帮助。

**嵌入IO**：[https ://github.com/unosquare/embedio](https://github.com/unosquare/embedio)

我主要使用它在 Raspberry Pi（软浮点）上创建 RESTful 服务。更新了 Mono 3.10 的代码，支持 WebSockets 和异步处理请求。

NuGet 包也可用。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-08-02T13:12:07.007

我猜这是Windows ..您不需要（或不应该）使用网络服务器。如果你创建一个 cfg 文件，不管它叫什么，在这个目录中：

%appdata%\Macromedia\Flash Player#Security\FlashPlayerTrust

并在其中添加一行包含您要信任的文件夹的路径，然后 Flash 将加载本地资源而不会出现安全问题。您可以在关机时再次删除该文件（这就是我们所做的）。

其他平台上的主体相同，只是该 FlashPlayerTrust 文件夹的位置不同。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-03-27T06:55:37.317

对于 ASP.Net MVC（和其他）自托管您可以使用[OWIN](http://owin.org/)实现：

> Open Web Interface for .NET (OWIN) 定义了 .NET Web 服务器和 Web 应用程序之间的抽象。OWIN 将 Web 应用程序与服务器分离，这使得 OWIN 非常适合在您自己的进程中（在 IIS 之外）自托管 Web 应用程序。

[在这里](http://www.asp.net/web-api/overview/hosting-aspnet-web-api/use-owin-to-self-host-web-api)，您可以找到一个使用 WebAPI 的简单示例。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-11-11T20:30:48.950

如果您在服务器端需要一点 ASP.NET，请使用 Mono.WebServer 和 Mono.WebServer.XSP。
这里：
[https ://github.com/mono/xsp/tree/master/src](https://github.com/mono/xsp/tree/master/src)

否则，您可以使用 uhttpsharp：
[https ://github.com/raistlinthewiz/uhttpsharp](https://github.com/raistlinthewiz/uhttpsharp)

或者您可以使用 codeplex 中的“webserver”：
[http ://webserver.codeplex.com/](http://webserver.codeplex.com/)

或者更重量级的卡西尼：
[https ://cassinidev.codeplex.com/](https://cassinidev.codeplex.com/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-31T18:23:24.850

只要内容设置为受信任，我似乎就可以播放本地 Flash 内容。

[本地内容的 Flash Player 安全性是什么？](http://www.adobe.com/security/flashplayer/articles/localcontent/)

> 可以将本地内容指定为受信任的，这样它就不会被此对话框打断，并且可以按设计运行。这种信任必须以两种方式之一明确指定。
> 
> *   通过运行软件安装程序，您安装的应用程序中的内容已经注册为受信任的。当您运行安装程序时，您明确允许在您的计算机上安装程序。因此，应用程序的发布者可以自动将内容注册到 Flash Player 为受信任的。
>     
>     
> *   通过 Flash Player 设置管理器中的全局安全设置面板将特定内容或目录添加到受信任文件列表中。在此面板中，您可以通过在 Flash Player 中手动注册位置来将特定内容甚至目录指定为受信任的。有关如何将内容指定为受信任的分步说明，请参阅技术说明：如何让本地 Flash 内容与 Internet 通信？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-02-22T22:05:06.637

如果您想利用 HTTP2 的能力来有效地流式传输内容，您还可以使用 GRPC 来嵌入 HTTP2 服务器。

看：

[https://grpc.io/docs/quickstart/csharp.html](https://grpc.io/docs/quickstart/csharp.html)

# javascript - 弹出窗口关闭时播放声音文件（谷歌扩展）

> ID：11746305
> 
> 赞同：0
> 
> 时间：2012-07-31T18:04:45.413
> 
> 标签：javascript, html, google-chrome, google-chrome-extension

我正在开发一个谷歌扩展来播放一组歌曲。该扩展程序有一个弹出窗口来进行音量控制。我使用 jPlayer 播放歌曲。

我面临两个问题：

1.  如果弹出窗口关闭，音乐停止（因为播放器的代码在弹出窗口中。我怎样才能继续在后台播放音乐？
2.  弹出窗口关闭时如何记住变量？例如，假设我有一个变量`status`，它指示播放器的当前状态（播放/停止）。问题是，由于变量在弹出窗口关闭时被销毁，我如何在弹出窗口之间记住它们

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T21:06:30.267

1.  不要在弹窗中嵌入播放器，放在[后台页面](http://code.google.com/chrome/extensions/background_pages.html)中。然后，也避免了问题 2。
2.  使用[`localStorage`](https://stackoverflow.com/tags/local-storage/info)（或[`chrome.storage`](http://code.google.com/chrome/extensions/storage.html)）保存数据。
    另一种选择是将消息传递到后台页面。这通常可以使用[消息传递](http://code.google.com/chrome/extensions/messaging.html)来完成。在弹出窗口中，使用起来*要容易得多*[`chrome.extension.getBackgroundPage()`](http://code.google.com/chrome/extensions/extension.html#method-getBackgroundPage)：

    ```
    // popup.js:
    var background = chrome.extension.getBackgroundPage();
    // On load?
    var data = background.saved_data;

    // ... Later, when data changes, update data:
    background.saved_data = data; 
    ```

以下是在 Chrome 扩展程序的后台页面中使用 chromeless Youtube 播放器播放视频的示例：[https](https://stackoverflow.com/a/9379277/938089) ://stackoverflow.com/a/9379277/938089 （包括所有文件）。

# python - 提取十六进制编码字符串的一部分

> ID：11746306
> 
> 赞同：1
> 
> 时间：2012-07-31T18:04:49.247
> 
> 标签：python, string, hex, pyserial

给定字符串: `aa0a051c1400`，我将如何提取 just`05`或`1c`? 我正在阅读串行响应，我需要检查十六进制数据的片段，以破译在这个初始数据包之后有多少数据从管道中传出。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T18:22:51.480

只需按索引解析字符串即可。如果要按字符索引解析：

```
from binascii import hexlify, unhexlify

def get_hex(stream, idx):
    return hexlify(unhexlify(stream)[idx])

get_hex('aa0a051c1400', 0)
'aa' 
```

# ajax - 带有 AJAX 加载页面的“发送”按钮不起作用

> ID：11746308
> 
> 赞同：1
> 
> 时间：2012-07-31T18:04:58.480
> 
> 标签：ajax, facebook, facebook-like, send

我对“发送”/“喜欢”按钮有一个典型的问题。我的页面包含使用 ajax 请求动态更新的内容。因此，更新后，我的“发送按钮”不起作用。按钮代码：

```
<div class="fb-send" data-href="${server}/book.html?currBookId=${book.id_book}"
                             style="margin-top: 5px;"></div> 
```

包含 all.js 文件的标准代码：

```
<script type="text/javascript">(function(d, s, id) {
if (d.getElementById(id)) return;
var js, fjs = d.getElementsByTagName(s)[0];
js = d.createElement(s);
js.id = id;
var lang = "${lang}";
js.src = "//connect.facebook.net/en_US/all.js'#xfbml=1&appId=${fb_id}";
fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script> 
```

我试图在这里找到答案并找到解决方案： [stackoverflow解决方案帖子](http://facebook.stackoverflow.com/questions/4219729/how-to-add-a-facebook-like-button-to-an-ajax-driven-page)

我应该添加这个：

```
 try{
            FB.XFBML.parse();
        } catch(ex) {} 
```

在 AJAX 调用之后。但！！它不工作！按钮现在在 Chrome 浏览器上绘制，但在控制台中我有很多错误，例如：

```
 Unsafe JavaScript attempt to access frame with URL http://localhost:8080/catalog.html
 from frame with URL http://www.facebook.com/plugins/send.php?api_key=API-
 KEY&channel=http%3A%2F%2Fstatic.ak.facebook.com%2Fconnect%2Fxd_arbiter.php%3Fversion
 %3D9%23cb%3Df847c7b0c%26origin%3Dhttp%253A%252F%252Flocalhost%253A8080%252Ff8c34834
 c%26domain%3Dlocalhost%26relation%3Dparent.parent&colorscheme=light&
 extended_social_context=false&href=http%3A%2F%2FMySite.com
 %2Fbook.html%3FcurrBookId%3D2668&locale=ru_RU&sdk=joey. 
 Domains, protocols and ports must match. 
```

并且按钮不起作用。在 FF 中，按钮不可见（这意味着解决方案在 FF 中不起作用）

你有什么想法我可以解决这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T10:59:51.893

我在异步使用 Like 按钮时也遇到了一些问题。

我使用不同的代码来包含 all.js 和使用 FB.init（由 完成`js.src = "//connect.facebook.net/en_US/all.js'#xfbml=1&appId=${fb_id}"`）。

这是我使用的：

```
/* Ajax stuff in order to generate like button in xfbml or html5 */

if (typeof(FB) != 'undefined' && FB != null ) {
    /* If FB.init has already been called, just parse like button */
    FB.XFBML.parse(document.getElementById('<YOUR-ID>'));
    /* You can also use FB.XFBML.parse() in order to parse the whole DOM, but I advise to integrate the Like / Send button into a div and parse it after */
}else{                       
    window.fbAsyncInit = function () {
            FB.init({ appId: <YOUR-APP-ID>, cookie: true, xfbml: true, oauth: true });
            /* FB stuff here, e.g. FB.event.suscribe */
    };      
    // Just load the script, no FB.init
    (function(d){
            var js, id = 'facebook-jssdk'; if (d.getElementById(id)) {return;}                                js = d.createElement('script'); js.id = id; js.async = true;
            js.src = "//connect.facebook.net/en_US/all.js";
            d.getElementsByTagName('head')[0].appendChild(js);
    }(document));
} 
```

它对我来说很完美。

关于错误（不安全的 Javascript ...），它应该出现在 Chrome 中，而不是 FireFox。它是特定于 Chrome 的，并且因为您正在集成来自另一个域（FaceBook）的 iFrame 而被触发。AFAIK，没有办法解决这个错误。希望这有帮助。

# hadoop - MapReduce阶段在哪里使用Sort，为什么？

> ID：11746311
> 
> 赞同：8
> 
> 时间：2012-07-31T18:05:14.300
> 
> 标签：hadoop, mapreduce

我是这里的hadoop新手。目前尚不清楚为什么我们需要能够在使用 hadoop mapreduce 时按键排序？在 map 阶段之后，我们需要将每个唯一键对应的数据分发到一定数量的 reducer。这可以在不需要排序的情况下完成吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-07-31T18:29:31.050

它就在那里，因为排序是对键进行分组的巧妙技巧。当然，如果您的工作或算法不需要任何密钥顺序，那么通过一些散列技巧进行分组会更快。

在 Hadoop 本身中，多年来已经有一个 JIRA 归档（[来源](https://issues.apache.org/jira/browse/MAPREDUCE-1639)）。Hadoop 之上的其他几个发行版已经具有这些功能，例如 Hanborq（他们称之为避免排序）。（[来源](http://www.slideshare.net/hanborq/hanborq-optimizations-on-hadoop-mapreduce-20120216a)）

对于您的实际问题（为什么），MapReduce 本质上是 Google 的一篇论文（[来源](http://static.googleusercontent.com/external_content/untrusted_dlcp/research.google.com/de//archive/mapreduce-osdi04.pdf)），其中陈述了以下内容：

> 我们保证在给定的分区内，中间键/值对以递增的键顺序处理。这种排序保证可以很容易地为每个分区生成一个排序的输出文件，**这在输出文件格式需要支持有效的 key 随机访问查找时很有用**，或者**输出的用户发现对数据进行排序很方便。**

因此，支持排序更多是一个方便的决定，而不是本质上只允许排序对键进行分组。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-31T18:29:46.203

**如果我们考虑到 hadoop DISTRIBUTES 通过将不同的密钥发送到不同的机器来为您处理这一事实，则最好理解“按密钥排序”。这个想法的基本（简化）版本是这样的：**

```
The reducer which a (k,v) pair is sent to = k.hashCode()%num_of_machines. 
```

因此，例如，如果我的密钥的哈希码是 10，并且我有 2 台机器，那么密钥将被发送到机器 #0。

因此，密钥将（首先）为我们提供了一种分配计算的简单方法。

除了简化计算分布之外，键还为我们提供了一种将来自不同数据文件的记录连接到单个集群中的方法。例如，这就是我们如何做 word_count 之类的事情。

事实上，如果你发现你不需要密钥——你可能也不需要 hadoop ！

**经典示例（字数）：**

在 hadoop “字数统计”示例中，我们发出带有值的键（一个键 = 一个词）（该词在一段文本中出现的 # 次）。这允许 SINGLE reduce 函数接收 SINGLE 单词，从而添加所有看到的时间，从而创建准确的单词计数。

因此，键的聚合允许“映射”阶段独立地分布在多台机器上。在没有将键聚合到同一个 reducer 的情况下，在字数统计示例中，我们可能会获得给定单词的多个字数，因为无法保证单个 reducer 会接收来自所有文件的所有字数。

**另一个例子：**

现在......假设我们有社会安全号码作为 id，我们想要输出个人数据的聚合。假设我们有 2 个大文件。

ssn->名称

ssn->shoe_size

在这种情况下，我们可以利用 key grouping 的力量，将个人姓名和鞋码都发送到 SAME reduce 函数。

reducer(2) 将在此处收到 2 条记录：

ssn->名称，shoe_size

这里的想法是，在编写 map/reduce 作业时，您必须对输出的“元组”进行编码，以便它们可以在 reduce 阶段以有意义的方式连接在一起。在某些时候，任何分布式计算环境都可能需要组合在不同节点中计算的记录。Keys 为我们提供了一种方便且可扩展的方法来执行此操作。

所以 - 我们保证 SAME 密钥进入 SAME reducer 功能的事实证实，该特定社会安全号码的每个 reducer 将接收与该号码关联的所有数据，允许我们加入和输出包括 ssn 的数据记录，名字，鞋码。

**结论**

如果不按密钥分发，以这种方式连接数据将需要涉及某种中间数据存储/缓存的复杂逻辑。Hadoop 使用熟悉的范式简单概括和抽象了从并行计算中“连接”数据结果的常见需求：键和值。

# objective-c - 使用 RKObjectManager 从 IOS POST 进行 INSERT

> ID：11746317
> 
> 赞同：0
> 
> 时间：2012-07-31T18:05:29.453
> 
> 标签：objective-c, ios, restkit

我正在使用 Restkit 的 RKObjectManager 和 RKObjectMapping 使用 GET 从 Web 服务中成功检索 JSON 数据。这是我的代码：

```
- (void)viewDidLoad
{
    [super viewDidLoad];

    RKURL *baseURL = [RKURL URLWithBaseURLString:@"http://192.168.1.12"];
    RKObjectManager *objectManager = [RKObjectManager objectManagerWithBaseURL:baseURL];
    objectManager.client.baseURL = baseURL;

    RKObjectMapping *markerMapping = [RKObjectMapping mappingForClass:[Marker class]];
    [markerMapping mapKeyPath:@"la" toAttribute:@"lat"];
    [markerMapping mapKeyPath:@"lo" toAttribute:@"lon"];
    [markerMapping mapKeyPath:@"des" toAttribute:@"description"];
    [objectManager.mappingProvider setMapping:markerMapping forKeyPath:@"markers"];
}

- (void)sendGet
{
    NSString *lat = @"53.334932";
    NSString *lon = @"-0.543749";
    NSString *dist = @"1000";

    NSDictionary *queryParams;
    queryParams = [NSDictionary dictionaryWithObjectsAndKeys:lat, @"la", lon, @"lo", dist, @"d", nil];
    RKObjectManager *objectManager = [RKObjectManager sharedManager];

    RKURL *URL = [RKURL URLWithBaseURL:[objectManager baseURL] resourcePath:@"/get_markers.php" queryParameters:queryParams];
    [objectManager loadObjectsAtResourcePath:[NSString stringWithFormat:@"%@?%@", [URL resourcePath], [URL query]] delegate:self];
} 
```

上面的代码正在运行，我很高兴使用返回的数据。但是，我无法发布要插入数据库的记录。我想我可以重用 sharedManager 甚至可能是映射。我不需要处理任何退货。

我尝试了以下片段的多种变体。无济于事。

第一个片段是尝试重用管理器和映射。忽略此伪代码中的映射范围，明显的缺陷是我无法弄清楚如何发布到正确的 URL 资源（baseURL & '/insert_marker.php'）。所以我实际上没有尝试过这个：

```
- (void)postInsert
{  
    Marker *mkr = [Marker alloc];
    mkr.lat = @"53.334933";
    mkr.lon = @"-0.543750";
    mkr.description = @"some words";

    RKObjectManager *objectManager = [RKObjectManager sharedManager];
    [objectManager.mappingProvider setSerializationMapping:[markerMapping inverseMapping] forClass:[Marker class]];
    [[RKObjectManager objectManager] postObject:mkr delegate:nil];
} 
```

第二个片段运行但应用程序崩溃。显然，这在字符串和 url 类型之间存在混淆，但对象管理器帖子不会使用 url 进行编译。我很迷茫！

```
- (void)postInsert
{  
    RKParams* params = [RKParams params];
    [params setValue:@"53.334933" forParam:@"la"];
    [params setValue:@"-0.543750" forParam:@"l0"];
    [params setValue:@"some words" forParam:@"des"];

    RKObjectManager *objectManager = [RKObjectManager sharedManager];
    NSString *URL = [RKURL URLWithBaseURL:[objectManager baseURL] resourcePath:@"/add_marker.php"];
    [objectManager.client post:URL params:params delegate:nil];
} 
```

那么，我如何使用参数发布（希望重用 sharedManager，也许是映射而不是处理返回）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T18:23:26.860

如评论中所述，尝试使用 NSStrings 而不是 RKURL，如下所示：

```
NSString *baseUrl = @"https://mysite.com"; 
[RKObjectManager objectManagerWithBaseURLString:baseUrl]; 
```

如果你想让一些东西更健壮，你也可以尝试使用 objectManager 而不是 objectManager 上的客户端来发帖，例如你可以使用块：

```
- (void) post: (id) myEntity onLoad:(RKObjectLoaderDidLoadObjectBlock) loadBlock onError:(RKRequestDidFailLoadWithErrorBlock)failBlock showingLoader:(BOOL)loaderWillShow{

    RKObjectMapping *mapping = [[RKObjectManager sharedManager].mappingProvider objectMappingForClass:[[myEntity class] class]];
    [[RKObjectManager sharedManager] postObject:myEntity usingBlock:^(RKObjectLoader *loader) {
        [self settingsForLoader:loader withMapping:mapping onLoad:loadBlock onError:failBlock showingLoader:loaderWillShow];
    }];

}

//Settings For Loader definition:

- (void) settingsForLoader: (RKObjectLoader *) loader withMapping: (RKObjectMapping *) mapping onLoad:(RKObjectLoaderDidLoadObjectBlock) loadBlock onError:(RKRequestDidFailLoadWithErrorBlock)failBlock showingLoader:(BOOL) loaderWillShow{

    loader.objectMapping = mapping;
    loader.delegate = self;
    loader.onDidLoadObject = loadBlock;

    loader.onDidFailWithError = ^(NSError * error){
       //NSLog(@"%@",error);
    };

    loader.onDidFailLoadWithError = failBlock;
    loader.onDidLoadResponse = ^(RKResponse *response) {
        [self fireErrorBlock:failBlock onErrorInResponse:response disablingLoader:loaderWillShow];
    };

} 
```

# java-me - 如何在j2me（java）中在一个屏幕中显示多个列表屏幕

> ID：11746320
> 
> 赞同：1
> 
> 时间：2012-07-31T18:05:41.340
> 
> 标签：java-me, lcdui, midp-2.0

我已经在 j2me (java) 中使用 KXML 和 LCDUI`List`和`Form`. 当我运行我的应用程序时，我能够在设备上显示 LCDUI 列表（“标题”、“图像”）屏幕。

但我有一个要求：
我有 3 个 rss 提要 xml 文件，当我运行我的应用程序时，应该读取 3 个 xml 文件并且输出应该只有一个屏幕：
在这个屏幕上我应该能够显示 3 个 rss 提要列表屏幕（即每个 LCDUI 列表屏幕包含来自 rss xml 文件的标题和图像列表）

如何在 j2me 中实现上述要求？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T21:31:10.300

将多个带有标题和图像的列表放在一个屏幕上的最直接方法是在 Form中使用[ChoiceGroup对象：](http://docs.oracle.com/javame/config/cldc/ref-impl/midp2.0/jsr118/javax/microedition/lcdui/ChoiceGroup.html "API 文档")

> A`ChoiceGroup`是一组用于放置在[Form](http://docs.oracle.com/javame/config/cldc/ref-impl/midp2.0/jsr118/javax/microedition/lcdui/Form.html)中的可选元素。可以使用需要做出单一选择或允许多个选择的模式来创建组。实现负责提供这些模式的图形表示，并且必须为不同的模式提供视觉上不同的图形。例如，它可能对单选模式使用“单选按钮”，对多选模式使用“复选框”......

如果您的列表属于`EXCLUSIVE`或`MULTIPLE`类型，则具有相同类型的选择组可能是您最接近的选项。对于`IMPLICIT`类型列表，您可能需要更有创意以保持用户体验不变。

从列表移至选择组时，请考虑可用于这些种类项目的特定 API。

例如， type`POPUP`旨在节省屏幕空间 - 您可能希望它在同一屏幕上适合三个列表。还有一些 API 类似`ItemStateListener`并`ItemCommandListener`扩展了处理用户输入的方式。

*   如果您发现 plain`ChoiceGroup`对您想要实现的目标过于限制，请考虑改用[CustomItem](http://docs.oracle.com/javame/config/cldc/ref-impl/midp2.0/jsr118/javax/microedition/lcdui/CustomItem.html "API 文档")，或者甚至可以使用[LWUIT](https://stackoverflow.com/tags/lwuit/info "这是什么？")或[J2ME Polish](https://stackoverflow.com/tags/j2mepolish/info "这是什么？")等 3rd 方 UI 库。

* * *

另一种选择（我个人更喜欢的选择）是保留`List`对象。真正的用户不太可能用“我需要一个 lcdui 表单对象”之类的术语来指定他们的要求。想想他们真正想要什么功能，以及如何使用列表来实现。从用户的角度来看，与正确设计的基于列表的屏幕集相比，具有三个选项组的表单可能会变得不太舒服。

# spring - 整合struts2+spring+Hibernate

> ID：11746323
> 
> 赞同：-1
> 
> 时间：2012-07-31T18:05:46.407
> 
> 标签：spring, hibernate, struts2

这些天我正在经历休眠，然后我试图开发一个集成struts2 + Hibernate + Spring的应用程序..我有两种方法来初始化hibernate会话工厂..一种是我们当时为struts2加载过滤器调度程序，我们应该加载休眠会话工厂，例如如下所示..

网页.xml...

```
<web-app version="2.5" 
    xmlns="http://java.sun.com/xml/ns/javaee" 
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
    xsi:schemaLocation="http://java.sun.com/xml/ns/javaee 
    http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd">
  <welcome-file-list>
    <welcome-file>index.jsp</welcome-file>
  </welcome-file-list>
  <listener>
   <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
   </listener>
  <filter>
    <filter-name>controller</filter-name>
    <filter-class>mypack.Struts2Dispatcher</filter-class>
  </filter>
  <filter-mapping>
    <filter-name>controller</filter-name>
    <url-pattern>/*</url-pattern>
  </filter-mapping></web-app> 
```

Struts2Dispatcher 文件..

```
import javax.servlet.*;
import org.apache.struts2.dispatcher.FilterDispatcher;
import org.hibernate.HibernateException;

public class Struts2Dispatcher extends FilterDispatcher
{
    @Override
    public void init(FilterConfig filterConfig) throws ServletException
    {
        super.init(filterConfig);
        try
        {
            HibernateUtil.createSessionFactory();
            System.out.print("-------application initializing successfully-----");
        }
        catch (HibernateException e)
        {
            throw new ServletException(e);
        }
    }
} 
```

和休眠实用程序..

```
package mypack;

import org.hibernate.SessionFactory;
import org.hibernate.cfg.Configuration;
import org.hibernate.Session;

public class HibernateUtil
{
    private static SessionFactory sessionFactory;
    public static void createSessionFactory()
    {
        sessionFactory = new Configuration().configure().buildSessionFactory();
    }
    public static Session getSession()
    {
        return sessionFactory.openSession();
    }
} 
```

配置文件..

```
<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE hibernate-configuration PUBLIC
          "-//Hibernate/Hibernate Configuration DTD 3.0//EN"
          "http://hibernate.sourceforge.net/hibernate-configuration-3.0.dtd">

<!-- Generated by MyEclipse Hibernate Tools.                   -->
<hibernate-configuration>

    <session-factory>
        <property name="connection.username">system</property>
        <property name="connection.url">jdbc:oracle:thin:@localhost:1521:xe</property>
        <property name="hibernate.dialect">org.hibernate.dialect.Oracle9Dialect</property>
        <property name="connection.password">manager</property>
        <property name="connection.driver_class">oracle.jdbc.driver.OracleDriver</property>
         <property name="show_sql">true</property>
         <mapping resource="Employee.hbm.xml"/> 
    </session-factory>

</hibernate-configuration> 
```

映射文件..

```
<!DOCTYPE hibernate-mapping PUBLIC
          "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
          "http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">
          <hibernate-mapping>
          <class name="mypack.Employee">
          <id name="eid" column="emp_id" type="int">
          <generator class="increment"/></id>
          <property name="name" column="emp_name"/>
          <property name="job"/>
          <property name="salary" type="int"/>
          </class>
          </hibernate-mapping> 
```

应用程序 context.xml 文件

```
<beans
    xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.0.xsd">
<bean id="MyIOCObject" class="mypack.LoginAction"/>

</beans> 
```

struts.xml 文件..

```
<struts>    
<package name="pack" extends="struts-default">
<action name="login" class="MyIOCObject" method="insert">
<result name="success">/welcome.jsp</result>
<result name="failure">/relogin.jsp</result>
</action>
</package>
</struts> 
```

登录Action java类

```
package mypack;

import org.hibernate.*;
import org.hibernate.cfg.Configuration;

public class LoginAction 
{
     private String name,job;
     private int salary;

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    public String insert()
    {
      try
      {
        Session ses=HibernateUtil.getSession();
        Employee emp=new Employee(name,job,salary);
        Transaction tx=ses.beginTransaction();
        ses.save(emp);
        tx.commit();
        ses.close();
        return "success";
      }catch(Exception e)
      {
          System.out.println(e);
          return "failure";
      }
    }

    public String getJob() {
        return job;
    }

    public void setJob(String job) {
        this.job = job;
    }

    public int getSalary() {
        return salary;
    }

    public void setSalary(int salary) {
        this.salary = salary;
    }

} 
```

主要员工 pojo

```
package mypack;

public class Employee
{
      private int eid,salary;
      private String name,job;

    public Employee() 
    {
        super();
    }

    public Employee(String name, String job,int salary)
    {
        super();
        this.salary = salary;
        this.name = name;
        this.job = job;
    }

    public int getEid() {
        return eid;
    }
    public void setEid(int eid) {
        this.eid = eid;
    }
    public int getSalary() {
        return salary;
    }
    public void setSalary(int salary) {
        this.salary = salary;
    }
    public String getName() {
        return name;
    }
    public void setName(String name) {
        this.name = name;
    }
    public String getJob() {
        return job;
    }
    public void setJob(String job) {
        this.job = job;
    }

} 
```

主要测试程序..

```
package mypack;

import java.util.Scanner;

import org.hibernate.SessionFactory;
import org.hibernate.cfg.Configuration;
import org.hibernate.classic.Session;

public class TestProgram
{

    public static void main(String[] args)
    {
          try
          {
              Configuration cfg=new Configuration();
              cfg.configure();
              SessionFactory sesfac=cfg.buildSessionFactory();
              Session ses=sesfac.openSession();
              System.out.println("Session created , fetching objects...");
              Scanner in=new Scanner(System.in);
              System.out.println("Enter Employee id :- ");
              int id=in.nextInt();
              Employee e=(Employee)ses.load(Employee.class,id);
              System.out.println("Following Object is fetched");
              System.out.println(e.getEid()+"\t"+e.getName()+"\t"+e.getSalary()+"\t"+e.getJob());
              ses.close();

          }catch (Exception e)
          {
              System.out.println(e);   
          }
    }

} 
```

我正在讨论的另一种方法是在链接上[另一种集成方法](http://www.mkyong.com/struts2/struts-2-spring-hibernate-integration-example/)现在请告诉我哪种方法最好，还有比这两种方法更好的方法吗？

请发布更新的代码，以便我可以掌握这个概念，请指教..!!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T18:29:11.033

这对我有用（使用 Struts2、JPA/Hibernate 和 Guice）：

*   创建和销毁你的`EntityManagerFactory`or ；不要子类化 Struts2 过滤器来执行此操作（另外，考虑使用较新的而不是较旧的，已弃用）`SessionFactory``ServletContextListener``StrutsPrepareAndExecuteFilter``FilterDispatcher`
*   在拦截器中创建和销毁`EntityManager`s 或`Session`s，以便每个请求都有自己的工作单元；这是最佳实践，因为这些工作单元不是线程安全的，不应跨请求共享
*   将拦截器放在堆栈的早期位置，以确保任何其他需要访问数据库的拦截器在它之后；这采用了*Open Session in View*模式，它确保在渲染视图时（在处理完操作之后）可以获取任何延迟加载的属性

最后，您可能想先更好地了解 Struts2、Hibernate 和 Spring，然后再尝试将它们全部堆起来。

# c++ - 复制构造器中的内存分配错误（c ++）

> ID：11746326
> 
> 赞同：0
> 
> 时间：2012-07-31T18:05:57.700
> 
> 标签：c++, memory, constructor, matrix, numeric

我有问题。

我已经用 C++ 编写了相当多的代码。我正在使用 MS Visual Studio 2010。

这是一个`matrix`几乎没有简单数值函数的类。

以下是实现：

```
//matrix.h
#pragma once
#define EPS pow(10., -12.)

#include <iostream>
#include <iomanip>
#include <cmath>

using namespace std;

class matrix
{
private:
    unsigned int n;     //number of columns
    unsigned int m;     //number of rows
    double* T;
public: 
    matrix ();
    matrix (unsigned int _n);
    matrix (unsigned int _n, unsigned int _m);
    ~matrix ();
    matrix (const matrix& A);
    matrix operator = (const matrix& A);

    unsigned int size_n () const;
    unsigned int size_m () const;

    void ones ();
    void zeros ();
    void identity ();

    void push (unsigned int i, unsigned int j, double v);

    void lu ();
    void gauss ();
    double det ();
    void transposition ();
    void inverse ();
    bool symmetric ();
    bool diag_strong_domination ();

    void swap_rows (unsigned int i, unsigned int j);

    matrix gauss_eq (matrix b);

    friend bool operator == (const matrix A, const matrix B);

    friend matrix operator + (const matrix A, const matrix B);

    friend matrix operator * (const matrix A, const matrix B);

    double operator () (unsigned int i, unsigned int j) const;

    friend ostream& operator << (ostream& out, const matrix& A);
};

matrix::matrix () : n(0), m(0)
{    
    this->T = NULL;
}

matrix::matrix (unsigned int _n) : n(_n), m(_n)
{    
    if (0==_n)
    {
        this->T = NULL;
        return;
    }

    this->T = new double [(this->n)*(this->m)];

    for (unsigned int i=0; i<this->n*this->m; i++)
        this->T[i] = (double)0;
}

matrix::matrix (unsigned int _n, unsigned int _m) : n(_n), m(_m)
{
    if (0==_m || 0==_n)
        throw "Error: Wrong matrix dimensios";

    this->T = new double [n*m];

    for (unsigned int i=0; i<n*m; i++)
        this->T[i] = (double)0;
}

matrix::~matrix ()
{
    delete this->T;
}

matrix::matrix (const matrix& A) : n(A.n), m(A.m)
{
    this->T = new double [n*m]; //(double*)malloc(A.m*A.n*sizeof(double));

    for (unsigned int i=0; i<n*m; i++)
        this->T[i] = A.T[i];
}

matrix matrix::operator= (const matrix& A)
{
    if (!(*this==A))
    {
        this->m = A.m;
        this->n = A.n;

        delete this->T;
        this->T = new double [A.n*A.m];

        for (unsigned int i=0; i<A.n*A.m; i++)
            this->T[i] = A.T[i];
    }

    return *this;
}

unsigned int matrix::size_n () const
{
    return this->n;
}

unsigned int matrix::size_m () const
{
    return this->m;
}

void matrix::ones ()
{
    for (unsigned int i=0; i<(this->m)*(this->m); i++)
        (*this).T[i] = double(1);

    return;
}

void matrix::zeros ()
{
    for (unsigned int i=0; i<(this->m)*(this->m); i++)
        (*this).T[i] = double(0);

    return;
}

void matrix::identity ()
{
    if (this->m!=this->n)
        throw "Error: Matrix have to be square (identity)";

    for (unsigned int i=0; i<(this->m)*(this->m); i++)
        (*this).T[i] = double(0);

    for (unsigned int k=1; k<=this->m; k++)
        (*this).push(k, k, (double)1);

    return;

}

void matrix::push (unsigned int i, unsigned int j, double v)
{
    if (i<=0 || i>this->m || j<=0 || j>this->n)
        throw "Error: Indeks out of range (push)";

    this->T[(i-1)*this->n + (j-1)] = v;
}

void matrix::lu ()
{
    if (this->m!=this->n)
        throw "Error: Matrix have to be square (lu)";

    if ((*this).diag_strong_domination())
    {
        //Doolittle decomposition
        matrix L(this->m);
        matrix U(this->m);

        for (unsigned int b=1; b<=this->m; b++)
            L.push(b, b, (double)1);

        for (unsigned int b=1; b<=this->m; b++)
            U.push(1, b, (*this)(1,b));

        for (unsigned int b=2; b<=this->m; b++)
        {
            for (unsigned int c=1; c<=this->m; c++)
            {
                for (unsigned int k=1; k<=b-1; k++)
                {
                    double s1 = 0;

                    if (1==k)
                        s1 = (double)0;

                    else
                        for (unsigned int p=1; p<=k-1; p++)
                            s1 += L(b,p) * U(p,k);

                    double v = ((*this)(b,k) - s1)/U(k,k);
                    L.push(b, k, v);
                }
                for (unsigned int k=b; k<=this->m; k++)
                {
                    double s2 = 0;

                    for (unsigned int p=1; p<=b-1; p++)
                        s2 += L(b,p) * U(p,k);

                    double v = (*this)(b,k) - s2;
                    U.push(b, k, v);
                }
            }
        }

        for (unsigned int p=1; p<=this->m; p++)
            L.push(p, p, (double)0);

        (*this) = L + U;

        for (unsigned int x=0; x<(*this).m*(*this).n; x++)
        {
            if (abs((*this).T[x])<EPS)
                (*this).T[x] = (double)0;
        }

        return;
    }

    (*this).gauss();

    return;
}

void matrix::gauss()
{
    //LU decomposition (gauss elimination with partal choice of main element)
    unsigned int n = (*this).m;
    matrix U(*this);
    matrix svr(1,n);
    for (unsigned int a=1; a<=n; a++)
        svr.push(a, 1, a);

    for (unsigned int k = 1; k<=(n-1); k++)
    {
        //main element choice - column
        unsigned int max = k;
        for (unsigned int q=k; q<=n; q++)
        {
            if (abs(U(q,k)) > abs(U(max,k)))
                max = q;
        }
        unsigned int p = max;
        svr.push(k, 1, p);

        if (abs(U(p,k)) < EPS)
            throw "Error: det = 0";

        //main element swap
        if (p!=k)
            U.swap_rows(p, k);

        //elimination
        for (unsigned int i=(k+1); i<=n; i++)
        {
            double tmp = U(i,k)/U(k,k);
            for (unsigned int j=(k+1); j<=n; j++)
            {
                double v = U(i,j) - tmp * U(k,j);
                U.push(i, j, v);
            }
        }
    }

    if (abs(U(n,n)) < EPS)
        throw "Error: det = 0";

    for (unsigned int s=2; s<=n; s++)
        for (unsigned int t=1; t<=(s-1); t++)
            U.push(s, t, (double)0);

    matrix T = (*this);
    matrix Uinv(U);
    Uinv.inverse();
    matrix L(n);

    for (unsigned int i=1; i<=n; i++)
        for (unsigned int j=1; j<=n; j++)
            for (unsigned int k=1; k<=n; k++)
            {
                double v = T(i,k) * Uinv(k,j);
                L.push(i, j, v);
            }

    //reversing rows swap
    for (unsigned int t=1; t<=n; t++)
    {
        if (t!=svr(t,1))
            L.swap_rows(t, svr(t,1));
    }

    (*this) = L + U;

    for (unsigned int k=1; k<=n; k++)
        (*this).push(k, k, (*this)(k,k) - (double)1);

    for (unsigned int x=0; x<(*this).m*(*this).n; x++)
    {
        if (abs((*this).T[x])<EPS)
            (*this).T[x] = (double)0;
    }

    return;
}

double matrix::det ()
{
    if (this->m!=this->n)
        throw "Error: Matrix have to be square (det)";

    double det = 1;
    matrix TMP = (*this);
TMP.lu();

for (unsigned int i=1; i<=this->m; i++)
        det *= (double)(TMP(i,i));

return det;
}

void matrix::transposition()
{
    matrix R(*this);

    for (unsigned int i=1; i<=(*this).m; i++)
        for (unsigned int j=1; j<=(*this).n; j++)
            (*this).push(j, i, R(i,j));

    return;
}

void matrix::inverse ()
{
    unsigned int n = (*this).m;

    matrix A(*this);
    matrix X(n);
    matrix b(1,n);

    for (unsigned int i=1; i<=n; i++)
    {
        b.zeros();
        b.push(i, 1, (double)1);

        X = A.gauss_eq(b); //error when using inverse in gauss function, used in lu

        for (unsigned int k=1; k<=n; k++)
            (*this).push(i, k, X(k,1));
        }

    for (unsigned int x=0; x<(*this).m*(*this).n; x++)
        if (abs((*this).T[x])<EPS)
            (*this).T[x] = (double)0;

    return; //error when calling inverse
}

bool matrix::diag_strong_domination()
{
    for (unsigned int i=1; i<=n; i++)
    {
        double s = (double)0;

        for (unsigned int j=1; j<=n; j++)
        {
            if (j!=i)
                s += abs((*this)(i,j));
        }

        if (s>=abs((*this)(i,i)))
            return false;
    }

    return true;
}

void matrix::swap_rows (unsigned int i, unsigned int j)
{
    if (i<=0 || i>this->m || j<=0 || j>this->n)
        throw "Error: Indeks out of range (swap_rows)";

    matrix R(*this);

    for (unsigned int p=1; p<=this->m; p++)
        for (unsigned int q=1; q<=this->n; q++)
        {
            if (p==i)
                (*this).push(p, q, R(j,q));
            if (p==j)
                (*this).push(p, q, R(i,q));
        }

    return;
}

matrix matrix::gauss_eq (matrix b)
{
    matrix A(*this);
    unsigned int n = this->m;

    for (unsigned int k=1; k<=n-1; k++)
    {
        unsigned int max = k;
        for (unsigned int q=k; q<=n; q++)
        {
            if (abs(A(q,k)) > abs(A(max,k)))
                max = q;
        }
        unsigned int p = max;

        if (abs(A(p,k)) < EPS)
            throw "Error: det = 0 (gauss_eq)";

        if (p!=k)
        {
            A.swap_rows(p,k);
            b.swap_rows(p,k);
        }

        for (unsigned int i=k+1; i<=n; i++)
        {
            double tmp = A(i,k) / A(k,k);
            for (unsigned int j=k+1; j<=n; j++)
                A.push(i, j, A(i,j) - tmp*A(k,j));
            b.push(i, 1, b(i,1) - tmp*b(k,1));
        }

        if (abs(A(n,n)) < EPS)
            throw "Error: det = 0 (gauss_eq)";
    }

    matrix X(1,n);

    double s = 0;

    for (unsigned int i=n; i>=1; i--)
    {
        for (unsigned int j=i+1; j<=n; j++)
            s = s + (A(i,j)*X(j,1));
        X.push(i, 1, (b(i,1)-s)/A(i,i));
        s = 0;
    }

    return X;
}

bool operator == (const matrix A, const matrix B)
{
    if (A.size_m()!=B.size_m() || A.size_n()!=B.size_n())
        return false;

    for (unsigned int i=1; i<=A.size_m(); i++)
        for (unsigned int j=1; j<=A.size_n(); j++)
            if (A(i,j)!=B(i,j))
                return false;

    return true;
}

matrix operator + (const matrix A, const matrix B)
{
    if (A.m!=B.m || A.n!=B.n)
        throw "Error: Wrong dimensions";

    matrix R(A.n, A.m);

    for (unsigned int i=0; i<A.m*A.n; i++)
        R.T[i] = A.T[i] + B.T[i];

    return R;
}

matrix operator * (const matrix A, const matrix B)
{
    if (A.n!=B.m)
        throw "Error: Wrong dimensions";

    matrix R(A.m,B.n);

    for (unsigned int i=1; i<=R.m; i++)
        for (unsigned int j=1; j<=R.n; j++)
            for (unsigned int k=1; k<=A.n; k++)
            {
                double v = R(i,j) + A(i,k) * B(k,j);
                R.push(i, j, v);
            }

    return R;
}

double matrix::operator () (unsigned int i, unsigned int j) const
{
    if (i<=0 || i>this->m || j<=0 || j>this->n)
        throw "Error: Indeks out of range (operator)";

    return this->T[(i-1)*this->n + (j-1)];
}

ostream& operator << (ostream& out, const matrix& A)
{
    if (0==A.size_m() || 0==A.size_n())
    {
        out<<endl<<" [  ]"<<endl;
        return out;
    }

    int s = 10;

    out<<endl<<" [ ";

    for (unsigned int i=1; i<=A.size_m(); i++)
    {
        for (unsigned int j=1; j<=A.size_n(); j++)
            out<<" "<<setw(s)<<left<<A(i,j)<<" ";

        if (i!=A.size_m())
            out<<endl<<"   ";
    }

    out<<" ] "<<endl;

    return out;
} 
```

问题是我有关于记忆的奇怪错误。

首先，当我这样调用函数时`inverse`：

```
//MatLab.cpp

#include <iostream>
#include <complex>
#include <typeinfo>
using namespace std;

#include "matrix.h"

int main()
{
    try
    {
        matrix S(4);

        for (unsigned int i=1; i<=S.size_m(); i++)
            for (unsigned int j=1; j<=S.size_n(); j++)
            S.push(i, j, (double)3);

        for (unsigned int i=1; i<=S.size_m(); i++)
            S.push(i, i, (double)0);

        cout<<"S:"<<S<<endl;

        S.inverse();                     //<--- here is the problem
        cout<<endl<<"S^(-1) = "<<S<<endl;
    }
    catch (char* xcp)
    {
        cout<<endl<<xcp<<endl<<endl;
    }

    system("pause");
    return 0;
} 
```

在函数中返回值时出现错误`inverse`。当我进入 destrutor 并在释放内存时出现错误。

然而，这还不是全部。

当我这样调用函数时，会出现另一种奇怪的情况`lu`：

```
//MatLab.cpp

#include <iostream>
#include <complex>
#include <typeinfo>
using namespace std;

#include "matrix.h"

int main()
{
    try
    {
        matrix S(4);

        for (unsigned int i=1; i<=S.size_m(); i++)
            for (unsigned int j=1; j<=S.size_n(); j++)
            S.push(i, j, (double)3);

        for (unsigned int i=1; i<=S.size_m(); i++)
            S.push(i, i, (double)0);

        cout<<"S:"<<S<<endl;

        S.lu();                                  //<--- here is the problem
        cout<<endl<<"LU decomposition"<<S<<endl;
    }
    catch (char* xcp)
    {
        cout<<endl<<xcp<<endl<<endl;
    }

    system("pause");
    return 0;
} 
```

`inverse`在这种情况下，函数中使用的函数也会发生错误`gauss`，但这次是在将函数的结果分配`gauss_eq`给之前定义的矩阵时。

当我遇到这个问题时，我会去复制构造函数（我不知道为什么），我既不能用 new 运算符也不能用`malloc`函数分配内存。

当调试要执行的 nex 语句`malloc.c`在此函数的文件中时：

```
__forceinline void * __cdecl _heap_alloc (size_t size)

{

    if (_crtheap == 0) {
        _FF_MSGBANNER();    /* write run-time error banner */
        _NMSG_WRITE(_RT_CRT_NOTINIT);  /* write message */
        __crtExitProcess(255);  /* normally _exit(255) */
    }

    return HeapAlloc(_crtheap, 0, size ? size : 1);
} 
```

参数大小等于 68。

我不知道有什么问题。

问题是在类矩阵中的构造函数或函数中，还是在我使用的 C 库中的函数中。

我希望有人花时间研究这个问题，尽管要查看很多代码。

感谢您的任何提示。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T18:12:49.513

您需要使用适当的管理类，而不是自己做。由于您已经进行了自己的 2D 索引，因此 a`std::vector<double>`将是一件好事。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-31T18:10:50.823

我还没有阅读您的所有代码，但这绝对是错误的：

```
matrix::~matrix ()
{
    delete this->T;
} 
```

你需要打电话给`delete[]`运营商，而不是普通的`delete`。 `new`必须始终与 匹配`delete`，并且`new[]`必须始终与 匹配`delete[]`。不这样做是未定义的行为，通常会导致某种内存损坏，从而使您的程序崩溃。

同样，您的实现也`operator =`应该调用`delete[]`.

也不需要在每个成员访问前加上`this->`or `(*this).`。它不是惯用的 C++，只应在存在局部变量遮蔽成员变量的情况下使用（这本身并不总是好的做法）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-31T18:11:04.397

首先，方式，*方式*太多的代码。但是，问题很简单；你调用`delete`你分配的数组`new []`。用 分配的任何东西`new[]`都必须用 解除分配`delete[]`。你有同样的问题`operator=`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-31T18:45:40.293

你的赋值运算符是错误的，你写的地方

```
matrix matrix::operator=(const matrix& A)
{
    if (!(*this==A)) 
```

你实际上是想写

```
matrix& matrix::operator=(const matrix& A)
{
    if (this != &A) 
```

您应该检查两个对象的地址是否不相等，而不是矩阵本身不相等（并且 operator= 应该返回一个引用）。

但无论如何，这种风格的赋值运算符是不好的。有一种更好的方法来编写赋值运算符，称为复制和交换习语。它不仅更正确，而且更容易编写。有关示例，请参见此处

[http://programmingexamples.net/wiki/CPP/C%2B%2B0x/TheBigFive](http://programmingexamples.net/wiki/CPP/C%2B%2B0x/TheBigFive)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-31T19:17:30.530

好的。我做了一些改变，现在我像这样释放内存：

```
matrix::~matrix ()
{
    delete [] this->T;
} 
```

和

```
matrix& matrix::operator= (const matrix& A)
{
    if (!(*this==A))
    {
        this->m = A.m;
        this->n = A.n;

        delete [] this->T;
        this->T = new double [A.n*A.m];

        for (unsigned int i=0; i<A.n*A.m; i++)
            this->T[i] = A.T[i];
    }

    return *this;
} 
```

但它改变了任何东西，无论`inverse`是在自称还是在`gauss`.

在调试时我停在

```
extern "C" _CRTIMP int __cdecl _CrtIsValidHeapPointer(
        const void * pUserData
        )
{
        if (!pUserData)
            return FALSE;

        if (!_CrtIsValidPointer(pHdr(pUserData), sizeof(_CrtMemBlockHeader), FALSE))
            return FALSE;

        return HeapValidate( _crtheap, 0, pHdr(pUserData) );  /<-- here I stopped
} 
```

在`dbgheap.c`.

# php - 在 PHP 中逐行扫描文本文件

> ID：11746329
> 
> 赞同：0
> 
> 时间：2012-07-31T18:06:03.553
> 
> 标签：php, string, file

所以我最近一直在用 php 编写一个问卷调查脚本，我编写了一个工具，它可以输出一个带有问题列表的 txt 文件，每个问题都在它自己的行上。该文件看起来像这样..

**1 “购物对我来说非常重要..” 2 3 4 5s 6** *//注意 5s*

**2 “我喜欢下雨天” 4 8s 12 16 32s**

第一个数字是问题 ID 号。双引号中的下一个是问题本身。

接下来的数字是与该问题相关的其他问题的 ID。

在“5s”的情况下，这是一个特殊的问题，我希望文件阅读器检测数字后面是否有 s。

```
$file = fopen("output.txt", "r");
$data = array();

while (!feof($file)) 
{
   $data[] = fgets(trim($file));
}

fclose($file);

// Now I have an Array of strings line by line
// Whats next now?? 
```

我的问题是如何编写将按此顺序读取文件的代码：

(1)..问题的ID号..

（“购买物品对我来说非常重要......”）......然后实际问题本身不考虑双引号

（2 3 4 5s 6）......然后是实际数字，同时意识到有些可能是“特殊的”。

有人可以帮帮我吗！！！谢谢！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-03T00:34:12.847

这是以您提供的格式处理文件的示例：

```
$file = fopen("output.txt", "r");
$data = array();

while (!feof($file)) {
   $line = trim(fgets($file, 2048));
   if (preg_match('/^(\d+)\s+"([^"]+)"\s*([\ds\s]+)?$/', $line, $matches)) {
        $data[] = array(
            'num' => $matches[1],
            'question' => $matches[2],
            'related' => $matches[3],
        );
   }
}
fclose($file);

print_r($data); 
```

您将从 print_r($data) 得到的结果是：

```
Array
(
    [0] => Array
        (
            [num] => 1
            [question] => Shopping for items is very important to me..
            [related] => 2 3 4 5s 6
        )

    [1] => Array
        (
            [num] => 2
            [question] => I love it when it is a rainy day
            [related] => 4 8s 12 16 32s
        )

) 
```

我不确定你想对相关问题做什么，所以它目前是一个字符串，但如果你需要，你可以将它进一步处理成一个数组。

# android - 我无法打开我想要的正确课程

> ID：11746332
> 
> 赞同：0
> 
> 时间：2012-07-31T18:06:15.980
> 
> 标签：android, listview, search, textwatcher

大家。所以，我的 TextWatcher 有问题。我的列表视图工作正常。当我单击此 ListView (lv_arr) 中的特定项目时，它会打开一个我想要的特定类，到目前为止一切都很好。但是，当我从字符串（列表视图）之一搜索项目（名称）而不是打开与名称对应的特定类时，我的文本观察器（我正在使用从列表视图中搜索项目的编辑文本 [布局]） item，它根据位置打开一个类。例如：我搜索“Fluke”，而不是打开 Fluke.Class，而是打开 BirdHand.class。那不是我想要的。我希望它打开 Fluke.class

这是我正在使用的代码。我是新手：

```
public class Searchsort extends Activity {

    private ListView lv1;
    private EditText ed;
    private String lv_arr[]={
        "a bird in the hand is worth two in the bush",
        "a bolt from/out of the blue",
        "a penny for your thoughts",
        "fluke",
        "have a face like thunder",
        };
   private ArrayList<String> arr_sort= new ArrayList<String>();
   int textlength=0;

/** Called when the activity is first created. */
@Override
public void onCreate(Bundle icicle) {
    super.onCreate(icicle);
    setContentView(R.layout.main);
    lv1 = (ListView)findViewById(R.id.list);
    ed = (EditText)findViewById(R.id.EditText01);

    lv1.setOnItemClickListener(new OnItemClickListener(){

        public void onItemClick(AdapterView<?> arg0, View arg1, int position,
        long arg3) {

               if ("a bolt from/out of the blue".equals(lv_arr[position])) {
                   Intent myIntent = new Intent(Searchsort.this, BoltBlue.class);
                   startActivity(myIntent);
               }

               if ("a bird in the hand is worth two in the bush".equals(lv_arr[position])) {
                   Intent myIntent = new Intent(Searchsort.this, BirdHand.class);
                   startActivity(myIntent);
               }

               if ("a penny for your thoughts".equals(lv_arr[position])) {
                   Intent myIntent = new Intent(Searchsort.this, PennyThoughts.class);
                   startActivity(myIntent);
               }
               if ("fluke".equals(lv_arr[position])) {
                   Intent myIntent = new Intent(Searchsort.this, Fluke.class);
                   startActivity(myIntent);
               }

               if ("have a face like thunder".equals(lv_arr[position])) {
                   Intent myIntent = new Intent(Searchsort.this, FaceThunder.class);
                   startActivity(myIntent);
               }

        }

                });

    // By using setAdpater method in listview we an add string array in list.

    lv1.setAdapter(new ArrayAdapter<String>(this,android.R.layout.simple_list_item_1 ,   lv_arr));

    ed.addTextChangedListener(new TextWatcher() {

        public void afterTextChanged(Editable s) {

        }

        public void beforeTextChanged(CharSequence s, int start, int count, int after) {

        }

        public void onTextChanged(CharSequence s, int start, int before, int count) {
            textlength=ed.getText().length();
            arr_sort.clear();
            for(int i=0;i<lv_arr.length;i++) {
                if(textlength<=lv_arr[i].length()) {
                    if(ed.getText().toString().equalsIgnoreCase((String) lv_arr[i].subSequence(0,  textlength))) {
                        arr_sort.add(lv_arr[i]);
                    }
                }
            }

            lv1.setAdapter(new ArrayAdapter<String>  (Searchsort.this,android.R.layout.simple_list_item_1 , arr_sort));

        }
    });
} 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T19:04:28.220

您正在修改 arr_sort 但与 lv_arr 进行比较。

例如，当用户搜索“fluke”并单击第一个位置时，该位置为 0，因此，应用程序比较 lv_arr 的位置 #0 并打开 BoltBlue.class 活动。

您应该与 arr_sort 进行比较，因为数组也必须更改。

希望你能理解我的解释。

# javascript - 当我尝试将 java 脚本加载到 Web 视图中时出现空白屏幕

> ID：11746333
> 
> 赞同：0
> 
> 时间：2012-07-31T18:06:19.603
> 
> 标签：javascript, html, objective-c, xcode, uiwebview

这是我的代码：

```
- (void)viewDidLoad
{
[super viewDidLoad];
NSString *path = [[NSBundle mainBundle] pathForResource:@"index" ofType:@"html"];
NSError *error;
NSURL *baseURL = [NSURL fileURLWithPath:path];
NSString *html = [NSString stringWithContentsOfFile:path encoding:NSUTF8StringEncoding error:&error];
NSLog(@"%@", html);
[webview loadHTMLString:html baseURL:baseURL];
NSLog(@"error: %@", error);
} 
```

这是html的内容：

```
<html>
<head>
<script src="jquerymin.js"></script>
<script src="highcharts.js"></script>
<script src="exporting.js"></script>
</head>
<body>
<div id="container" style="min-width: 400px; height: 400px; margin: 0 auto"></div>

<script src="script.js"></script>
Test

<input type="button" id="button" />
</body>

</html> 
```

脚本.js：

```
$(function () {
var chart;
$(document).ready(function() {
    chart = new Highcharts.Chart({
        chart: {
            renderTo: 'container',
            plotBackgroundColor: null,
            plotBorderWidth: null,
            plotShadow: false
        },
        title: {
            text: 'Therapist productivity by Region'
        },
        tooltip: {
            formatter: function() {
                return '<b>'+ this.point.name +'</b>: '+ this.percentage +' %';
            }
        },
        plotOptions: {
            pie: {
                allowPointSelect: true,
                cursor: 'pointer',
                dataLabels: {
                    enabled: true,
                    color: '#000000',
                    connectorColor: '#000000',
                    formatter: function() {
                        return '<b>'+ this.point.name +'</b>: '+ this.percentage +' %';
                    }
                }
            }
        },
        series: [{
            type: 'pie',
            name: 'Therapist Productivity',
            data: [
                ['South Carolina',   45.0],
                ['Michigan',       26.8],
                {
                    name: 'California',
                    y: 12.8,
                    sliced: true,
                    selected: true
                },
                ['Florida',    8.5],
                ['New York',     6.2],
                ['Maine',   0.7]
            ]
        }]
    });
});

});

$('#button').click(function() {
$(chart.container).hide();
chart.series[0].remove();
$(chart.container).show();
}); 
```

当我运行我的代码时，来自 HTML 和“测试”的按钮会显示在屏幕上，但不会显示正在加载的 .js 文件的内容。我这样做对吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T20:09:22.370

这可能应该是一个评论，但我没有足够的代表，所以你得到一个“答案”。

我不知道你的意思是你在源代码中看不到你的 js 代码，还是看不到它应该做的结果。如果您的意思是前者：使用 script 标签调用 script.js，不会将您的代码内联嵌入到您的 html 中。如果是后者：您的 js 代码应该使用 onload 属性或就绪侦听器调用。如果您提供您的 script.js，我可以提供更多帮助。

无论哪种方式，一个好的起点是验证您的 html 代码：http: [//validator.w3.org/](http://validator.w3.org/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-01T01:32:33.823

尝试转义 baseURL 中的反斜杠和空格。Joe D'Andrea[对类似（但不完全重复）的问题](https://stackoverflow.com/a/1396321/307881)有一个很好的答案。总结一下：

```
 NSString *resourcePath = [[[[NSBundle mainBundle] resourcePath]
     stringByReplacingOccurrencesOfString:@"/" withString:@"//"]
     stringByReplacingOccurrencesOfString:@" " withString:@"%20"];
 [webView loadHTMLString:markup baseURL:[NSURL URLWithString:
     [NSString stringWithFormat:@"file:/%@//", resourcePath]]]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-02T17:00:55.310

问题是我从未将 .js 文件带到 Build Phases 下的 Copy Bundle Resources。我把文件移过来了，效果很好

# javascript - 如何查看首先点击了哪个元素？

> ID：11746334
> 
> 赞同：1
> 
> 时间：2012-07-31T18:06:20.410
> 
> 标签：javascript, jquery

我有一个选择菜单，`toggleClass().`用于查看选择了哪些菜单选项：

```
$('.img1, .img2, .text1, .tex2').click(function() {
    $(this).toggleClass('selected');
}); 
```

我的选择菜单的工作方式是，如果两个元素都有类`selected`，那么就会发生一些事情。例如：

```
if ( $('.img1').hasClass('selected') && ('.text1').hasClass('selected') ) {
    // do something
} 
```

这一切都很完美，但是我想禁止用户选择两个`imgs`或两个`texts`。我想这样做的方法是从选定的类中删除第一个选定的元素，而第二个选定的元素保持选定状态。例如：

```
if ( $('.img1').hasClass('selected') && ('.img2').hasClass('selected') ) {
        // remove selected from the element that was first clicked and keep selected on the element that was clicked second
} 
```

实现这一目标的最佳方法是什么？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T18:24:18.313

尝试：

```
$('.img1, .img2').click(function() {
    $('.img1, .img2').removeClass('selected').filter(this).toggleClass('selected');
});
$('.text1, .text2').click(function() {
     $('.text1, .text2').removeClass('selected').filter(this).toggleClass('selected');
}); 
```

分离您的点击事件将确保只选择每种类型的项目之一。

另外，请确保您没有在做`$('this')`.

应该是`$(this)`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T18:13:14.163

这会将类名“first”添加到单击的第一个项目。剩下的就看你了。

```
$('.img1, .img2, .text1, .tex2').click(function() {
    $('this').toggleClass('selected');
    if($('.first').length==0) {
        $('this').addClass('first');
    }
}) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-31T18:15:30.917

也许如果您有一个跟踪单击项目的 id 的数组，您可以使用它：

```
var clickArr = new Array();
$('.img1, .img2, .text1, .tex2').click(function()
{
    $('this').toggleClass('selected');
    clickArr.push($(this).attr("id"));
}); 
```

然后，当您找到同时选择了两者的位置时：

```
if ( $('.img1').hasClass('selected') && ('.img2').hasClass('selected') )
{
    $("#"+clickArr[0]).removeClass("selected");
    clickArr.shift();
} 
```

这可能很棘手，因为每次“处理有效的选择”时都必须清空数组。但也许这可以让你开始。

# google-app-engine - 嵌入式实体是否高度一致？

> ID：11746335
> 
> 赞同：1
> 
> 时间：2012-07-31T18:06:22.273
> 
> 标签：google-app-engine, google-cloud-datastore, requestfactory, objectify

我正在使用带有 Objectify 和 RequestFactory 的 App Engine (Java)。

我的实体存储了一些字段和一个嵌入式实体 ArrayList。嵌入式实体有自己的几个字段。因此，示例实体可能如下所示：

```
name: Bob
email: bob@example.com
todo.description: ["Pick up food", "Wash car", "Exercise"]
todo.importance: [1, 5, 3] 
```

我有一个 DataGrid 可以拉出嵌入的实体列表并显示它。如果单击按钮，则将新项目添加到嵌入实体中，实体将保持不变并且数据网格会刷新。

问题是它不是高度一致的。大多数情况下，DataGrid 将成功刷新最新数据，但有时它只显示旧数据，您必须刷新页面才能显示新结果。

我了解 App Engine 仅在涉及不在同一实体组中的实体时才最终保持一致，但据我所知，嵌入式实体最终会成为包含它的实体上的更多字段，即只有一个涉及的实体，并且一切都应该高度一致。

我错了吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T18:58:22.230

[http://code.google.com/p/googleappengine/issues/detail?id=6326](http://code.google.com/p/googleappengine/issues/detail?id=6326)

这是我创建的问题的一个线程。首先，确保您打开了 STRONG 一致性（我相信最终是默认设置）。

第二 - 从那个线程，这里有一个重要的注意事项：

> 强一致性标志意味着对于 e get by key 或实体组查询，您将与这些约束具有强一致性，但“全局”（无实体根）查询仍将始终保持最终一致。当您将该标志设置为 EVENTUAL 一致性时， *所有*查询都将表现出最终一致的行为。

因此，如果您正在执行跨实体查询，它可能是 EVENTUAL 一致的，无论您是否将 STRONG 设置为默认值。因此，请尝试打开 STRONG 一致性，然后对呈现视图所需的所有实体执行单次获取键查询，而不是跨实体的单个查询。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-01T04:18:37.800

您还可以发出祖先查询，您的查询将是强一致的

# algorithm - OEIS A002845：2^2^...^2 采用的不同值的数量（以所有可能的方式插入 n 2 和括号）

> ID：11746338
> 
> 赞同：25
> 
> 时间：2012-07-31T18:06:38.330
> 
> 标签：algorithm, numbers, sequence, combinatorics, exponent

我正在寻找一种相当快的算法来计算 OEIS 序列[A002845](http://oeis.org/A002845)的项。让我在这里重申它的定义。

让 ^ 表示幂运算符。考虑 2^2^...^2 形式的表达式，其中有 n 2 个括号，括号以所有可能的方式插入（可能的括号数量由[Catalan numbers](http://oeis.org/A000108)给出）。其中一些表达式将具有相同的值，例如 (2^2)^2=2^(2^2)。我们对给定 n 的不同值的数量感兴趣。

通过直接计算这些表达式有一个明显的蛮力解决方案，但很明显，即使对于相对较小的 n，所需的时间和空间也会很快超过所有合理的限制。我对这个问题的多项式时间解决方案感兴趣。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-01T16:29:27.003

仅表示迭代基数 2 中的数字： a`Num`有一个（可能为空）`x1,...,xp`类型为 的不同子项的列表`Num`，因此`Num([x1,...,xp]) == 2^x1 + ... + 2^xp`.

这定义了一种写入非负整数的独特方法；请记住对指数进行排序，以便比较有意义。平等：

*   `2^x + 2^x == 2^(x+1) == Num([x+1])`
*   `2^x + 2^y == Num([x,y])`什么时候`x != y`
*   `(2^2^x)^2^y == 2^2^(x+y) == Num([Num([x+y])])`

与加法的结合性/交换性一起，您可以添加任意数字并计算`x^y`2^2^k 形式的数字；这类数字包含 2（k=0）并且是封闭的，`^`因此这保证了我们需要操作的每个数字都是这种形式。

此外，上面定义的等式永远不会增加树中节点的数量，所以所有的`Num`都是 size `O(n)`。

所以时间复杂度实际上`O(C * n^k)`是 C 中的准线性（C 是第 (n-1) 个加泰罗尼亚数）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-03T14:38:54.737

我认为这里最好的解决方案涉及动态编程，这是一个难以掌握的概念，但如果操作正确，将非常有效。这个想法是通过记住您已经完成的计算结果，然后使用这些知识将问题拆分为更简单问题的子集，从而最大限度地减少您必须进行特定计算的次数。

例如，在您的 2^(2^2) = (2^2)^2 示例中，我们现在可以将其记住为等于 16 的值的两件事。所以现在当我们看到这附加到 2^ (2^(2^2)) = 2^((2^2)^2) 我们可以很快将其中的每一个识别为 2 ^ 16，计算一次，我们现在有两个新方程要添加到我们永远不必再次计算的值列表。

这似乎没有多大帮助，但是，当您最终遇到很长的括号问题，甚至更长的等价集时，它将为您节省时间和复杂性，因为计算机要做的计算很长在非常大的数字上。下面是伪代码，对不起，这真的是很宽泛的伪代码，这个问题很粗糙，所以我不想写出一个完整的算法。只是更详细地概述了这个概念

```
 sortedEquivalencyVector;  //Sorted greatest first, so we are more likely to se longest matches

 function(expression)

    if(portion of expression exists)  //Remember, you can only do this from the end of the expression in toward the middle!
         replace value at end of expression that matches with its already computed value

    if(simplified version exists in vector) add original expression to vector
    else compute value and add it to the vector
 end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-03T20:07:23.270

一种比蛮力好得多的方法（但诚然仍然很昂贵）是在第一篇链接的论文中使用“标准形式”的概念。给定一个`n`，生成每个标准形式的 degree `n`，评估它，并将所有值保存在一个集合中。最后，检查集合的大小。

标准形式的语法是

```
S -> (2 ^ P)
P -> (S * P)
P -> S
S -> 2 
```

你从一个开始`S`，最后你应该有`n`终端（即`2`s）。

# ios - 应用内购买 - 产品加载问题（RW 教程）

> ID：11746339
> 
> 赞同：1
> 
> 时间：2012-07-31T18:06:43.540
> 
> 标签：ios, in-app-purchase

开发我的第一个应用程序，非常感谢这个社区的所有帮助。

我的问题与 Ray Wonderlich 的应用内购买教程特别相关：[http](http://www.raywenderlich.com/2797/introduction-to-in-app-purchases) ://www.raywenderlich.com/2797/introduction-to-in-app-purchases 。

我似乎没有其他人使用我的 SKproductsrequest 方法遇到的问题。在设备上运行并且我的 KProductsLoadedNotification 成功发布时，我为我的 response.counts 返回了正确数量的 5 个对象。

我相信问题出在我的 (void)productsloaded 方法中，如下所示：

```
- (void)productsLoaded:(NSNotification *)notification {
    NSLog(@"加载的产品调用");
    [NSObject cancelPreviousPerformRequestsWithTarget:self];
    [MBProgressHUD hideHUDForView:self.view 动画:YES];
    [self.ItemTable reloadData];

    NSLog(@"表重新加载");
}

```

据我所知，这个方法永远不会被调用。即使延迟很长，我的桌子也根本不会加载产品和超时。我不知道为什么，因为我已经根据教程检查了所有代码。当我运行教程示例项目时，很明显这个方法应该在 SKproductsrequest 之后运行，但它只是没有。

我最好的猜测是这个问题与我使用故事板而不是 Xib 的有关。productsloaded 在我原来的视图控制器 .m 文件中。这可能是问题吗？还有其他想法吗？

我在使用情节提要的 Xcode 4.2 中，项目编译没有错误。

非常感谢您提供的任何帮助。对此，我真的非常感激。

# security - WSO2 Carbon - 以编程方式应用安全性

> ID：11746342
> 
> 赞同：0
> 
> 时间：2012-07-31T18:06:58.373
> 
> 标签：security, wso2, wso2carbon

我正在尝试编写代码以编程方式保护 WSO2 Carbon 服务器上的服务。我已经充分解构了 JSP 安全代码，知道它使用 SecurityAdminService 来实际执行安全操作。我已成功向 SecurityAdminService 发送消息，但收到以下错误：

```
<soapenv:Fault xmlns:axis2ns1="http://schemas.xmlsoap.org/soap/envelope/">
    <faultcode>axis2ns1:50977</faultcode>
    <faultstring>Access Denied. Please login first.</faultstring>
    <detail/>
</soapenv:Fault> 
```

这并不出人意料，但我想不出任何方法可以在此请求中传递用户凭据。JSP 代码在这里没有提供太多帮助，因为它通过 cookie 进行登录和凭据处理。有没有办法在请求的同时处理授权？还是我只需要复制 JSP 页面的功能并 POST 到登录 URL 并将会话 cookie 复制到请求中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-01T03:33:43.303

在调用任何管理服务之前，您必须首先调用 AuthenticationAdmin 服务并让自己作为有效用户进行身份验证（针对 carbon 用户存储）。您可以轻松地使用 AuthenticationAdminStub 调用其登录方法，提供您的用户名、密码和后端服务器的主机名/IP 来完成此操作。然后，您将能够成功地继续您已经实施的内容。

问候， 普拉巴斯

# ios - 带有 NSPredicate "SELF IN %@" 的 NSFetchedResultsController 仅在应用重新启动后有效

> ID：11746344
> 
> 赞同：0
> 
> 时间：2012-07-31T18:07:08.887
> 
> 标签：ios, nspredicate, nsfetchedresultscontroller

我有一个 UITableViewController (TVC) 和 NSFetchResultsController (frc) 填充它。这是frc的初始化：

```
- (NSFetchedResultsController *)frc
{
    if (!_frc)
    {
        NSFetchRequest *request = [[NSFetchRequest alloc] initWithEntityName:e_product];
    NSSortDescriptor *sortDescriptor = [[NSSortDescriptor alloc] initWithKey:@"product_group.product_group_name" ascending:YES];
    request.sortDescriptors = [NSArray arrayWithObject:sortDescriptor];                
    _frc = [[NSFetchedResultsController alloc] initWithFetchRequest:request managedObjectContext:self.moc sectionNameKeyPath:@"product_group.product_group_name" cacheName:nil];
    _frc.delegate = self;
    NSError *error;
    if (![_frc performFetch:&error])
    {
        NSLog(@"Error: %@!", error.userInfo);
    }
    if (_frc.sections.count < 1)
    {
        // looks like the product list is empty!
        [self refreshProductCatalog];
    }
}
return _frc;
} 
```

它工作得很好：当显示 TVC 时，frc 第一次执行 fetch，发现没有“产品”实体并使用 refreshProductCatalog 请求它们。添加新实体后，frc “感觉”它并优雅地重新加载 TVC 项目（如果 TVC，self 是委托）。

当我将谓词添加到 FetchRequest 时出现问题：

```
request.predicate = [NSPredicate predicateWithFormat:@"SELF IN %@", someManagedObject.setOfProductsEntities]; 
```

我用适当的实体在 refreshProductCatalog 中填充 someManagedObject.setOfProductsEntities （我确信因为它在重新启动后工作正常）。问题是当谓词到位时，在我更改数据并且不重新加载 TVC 之后，frc 不会“感觉到”托管对象上下文的变化。如果我离开 TVC 并再次打开它（或重新启动应用程序）一切都很好，数据已经保存...

任何线索这里有什么问题？谢谢 ;）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T18:15:59.157

要全面跟踪更改，缓存名称不应为 nil。我过去做错的另一件事是分配了一个委托，但忘记实现一个委托方法。

# powershell - 在 W2K3 上使用 Powershell 获取组策略

> ID：11746345
> 
> 赞同：1
> 
> 时间：2012-07-31T18:07:12.343
> 
> 标签：powershell, scripting, group-policy, windows-2003-webserver

试图创建一个脚本来获取组策略。最初我认为这会很简单，在发现了几个组策略 cmdlet 之后，但是我注意到所有组策略 cmdlet 都适用于 W2K8 及更高版本。

我一直在四处寻找，到目前为止，还没有找到任何关于是否可以使用 Powershell 为 W2K3 服务器获取组策略的任何信息，所以如果这里有人可能对从哪里开始有任何建议，我就在徘徊。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-12T04:55:53.080

遗憾的是，我相信您在 W2k3 中遇到了 gpresult，因为您想要的 cmdlet 是 RSAT 的组策略管理工具的一部分。

我在那里看到了一些第三方项目，但它们似乎只是 RSAT 的包装器，因此它们很可能在 Server 2003 中不起作用。

# php - 如何在一页上选择产品数量并将值传递给 cart.php

> ID：11746351
> 
> 赞同：0
> 
> 时间：2012-07-31T18:07:30.493
> 
> 标签：php, cart, woocommerce

假设在首页您有一个促销部分，可让您增加/减少所需产品的数量，然后它会自动为您计算价格。我添加了一个带有 href 的按钮

```
 <?php echo get_home_url(); ?>/shop/?add-to-cart=9 
```

它将单个产品添加到您的购物车，并带您到 cart.php，您可以在其中增加或减少数量。

我可以做什么，或者我可以采取什么方向，将首页数量传递给 cart.php 数量？

例如，我的首页代码是这样的：

[http://jsfiddle.net/7BDwP/811/](http://jsfiddle.net/7BDwP/811/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T18:19:18.630

```
$(document).ready(function(){

    var base_url = <?php echo get_home_url(); ?>;

    $('#product').change(function(){
        $('#result').text($(this).val() * 25.99);
        // add this to change the href.  Should really use an ID selector but for your example this works
        $('a').attr('href', base_url+'/shop/?add-to-cart=9&qty='+$('#product').val());
    });    
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T19:33:44.223

它唯一的支持是：（通过 URL）

```
?add-to-cart=variation&product_id=1100 
```

所以你需要制作一个名为 Qty 的隐藏表单元素：

```
<input name="quantity" data-min="1" data-max="0" value="1" size="4" title="Qty" class="input-text qty text" maxlength="12"> 
```

但既然你有不止一个。你会做

```
<form action="/shop/?add-to-cart=variation&amp;product_id=1100" class="variations_form cart" method="post" enctype="multipart/form-data">

Size
<select>
<option value="">Choose an option…&lt;/option>
<option value="large">Large</option>
<option value="medium">Medium</option>
<option value="small" selected="selected">Small</option>
<option value="x-large">X-Large</option>
</select>

Colour
<select id="pa_colour" name="attribute_pa_colour" style="opacity:0">
<option value="">Choose an option…&lt;/option>
<option value="black" selected="selected">Black</option>
</select>

<input type="hidden" name="variation_id" value="1104">

<input name="quantity" data-min="1" data-max="0" value="1"
size="4" title="Qty" class="input-text qty text" maxlength="12">

<button type="submit" class="button alt">Add to cart</button>
<input type="hidden" name="product_id" value="1100"></div>

</form> 
```

只需确保您的`Ids`和`Names`是唯一的，创建一个更新该`Qty`值的 jQuery Ajax 字段。您只能通过表单方法提交，除非您编辑核心`PHP`值并允许`REQUEST`而不是`GET`.

# r - 如何将数据框拆分为R中的不同图？

> ID：11746352
> 
> 赞同：0
> 
> 时间：2012-07-31T18:07:37.373
> 
> 标签：r

我有一个格式的 csv

```
latency1, latency2, test-type
1.3233831,1.0406423,A
1.6799337,1.1520619,A
1.6301824,1.1536479,B
2.3465363,1,2346457,C
1.2452355,1.9987547,C
... 
```

我想绘制三个不同的图：A 类型的一个具有latency1 与latency2 的图，B 类型具有latency1 与latency2 的一个，C 类型具有latency1 与latency2 的一个。我知道如何在同一图表上绘制不同的数据集，但是不是如何像这样将一个数据框拆分为多个图。我是R新手，对不起。提前致谢。:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T18:15:59.563

**lattice**包中的绘图函数具有公式接口，其`|`运算符允许您指示用于将数据拆分为单独绘图的“格”或“格”的条件变量。

试试这个，例如：

```
## Read in your data
df <- read.table(text="latency1, latency2, testType
1.3233831,1.0406423,A
1.6799337,1.1520619,A
1.6301824,1.1536479,B
2.3465363,1.2346457,C
1.2452355,1.9987547,C", header=T, sep=",")

library(lattice)
xyplot(latency2 ~ latency1 | testType, data = df, type = "b") 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-31T18:26:17.893

## 分面图

![刻面图](../Images/ff7adfe94ad02ec00e6250eaca392b7e.png)

## 代码

如果您想这样做`ggplot2`：

```
library(ggplot2)

df = read.table(text='latency1,latency2,testtype
1.3233831,1.0406423,A
1.6799337,1.1520619,A
1.6301824,1.1536479,B
2.3465363,1.2346457,C
1.2452355,1.9987547,C', 
                header=TRUE, sep=',')

p = ggplot(data = df, 
           aes(x = latency1, y = latency2, colour = testtype)) +
    geom_point() +
    facet_grid( . ~ testtype )

p 
```

# asp.net - 为什么必须对 URL 中的大括号 ({, }) 进行转义？

> ID：11746357
> 
> 赞同：3
> 
> 时间：2012-07-31T18:08:05.250
> 
> 标签：asp.net

`{ braces }`输入网址的目的是什么？

你能举一个`{ braces }`输入网址的例子吗？

我进行了如下编码以使其在我的应用程序中工作，否则我不断收到错误消息

```
Script = Script.Replace("{", "%7B");
Script = Script.Replace("}", "%7D"); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-31T18:13:11.463

[RFC 1738 - Uniform Resource Locators (URL)](http://www.ietf.org/rfc/rfc1738.txt)有一些解释：

> 字符“{”、“}”、“|”、“\”、“^”、“~”、“[”、“]”和“`”是不安全的，因为已知网关和其他传输代理有时会修改这样的字符..
> 
> 所有不安全的字符必须始终在 URL 中进行编码..

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-31T18:13:22.837

如果我想在 Google 上搜索这个花括号字符怎么办？ [https://www.google.com/#hl=en&q=%7D](https://www.google.com/#hl=en&q=%7D)

我们需要这种[编码方案](http://en.wikipedia.org/wiki/Percent-encoding)来将这些类型的保留字符传递到 Web 应用程序中。

另外，我看到您一次手动替换这些字符。这不是一个好主意，在[Uri](http://msdn.microsoft.com/en-us/library/system.uri.escapeuristring)类中已经为此编写了一些内容。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-31T18:13:47.600

URL 中的大括号没有什么特别之处，它们就像任何其他字符一样。由于它不在有效字符范围内，因此需要对其进行编码

# iphone - 难道CGAffineTransform的文档有误？

> ID：11746362
> 
> 赞同：1
> 
> 时间：2012-07-31T18:08:17.247
> 
> 标签：iphone, rotation, cgaffinetransform

文件说：

旋转仿射变换的角度（以弧度为单位）。在 iOS 中，正值指定逆时针旋转，负值指定顺时针旋转。

但在我的实验中，我得出以下结论：

```
YourView.transform = CGAffineTransformMakeRotation( positive value ); 
```

将顺时针旋转视图，并且

```
YourView.transform = CGAffineTransformMakeRotation( Negative value ); 
```

将逆时针旋转视图，

这些是否相互矛盾？我的意思是，在翻转的坐标系中，像这样：

![在此处输入图像描述](../Images/7e8f5aaceec201a82a56d65310381034.png)

正角度表示顺时针旋转，但文档说“在 iOS 中，正值指定逆时针旋转”。所以我认为这是矛盾的。文件有错吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T20:05:38.183

我猜，由于您没有提供足够的代码，因此您正在`UIKit`视图中执行此操作。`UIKit`在调用之前翻转坐标系，`drawRect`给人以旋转方向错误的印象。

坐标系为第一`CoreGraphics`象限，即（0,0）为左下角，`UIKit`第四象限为左上角（0,0）。

如果您取消翻转坐标系，一切都会好起来的。

# android - 如何禁用 Android 应用程序的屏幕截图？

> ID：11746364
> 
> 赞同：11
> 
> 时间：2012-07-31T18:08:30.607
> 
> 标签：android

当我的应用在 Android 设备上运行时，如何禁用屏幕截图？有什么办法可以防止别人截屏吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-31T18:19:28.937

使用[Flag Secure](http://developer.android.com/reference/android/view/WindowManager.LayoutParams.html#FLAG_SECURE)作为布局参数标志。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-02-24T05:49:28.190

在`onCreate()` **方法**中，添加**标志**

```
getWindow().setFlags(WindowManager.LayoutParams.FLAG_SECURE,WindowManager.LayoutParams.FLAG_SECURE); 
```

前`setContentView();`

# doctrine-orm - Doctrine 2 CRUD 生成器和不称为“id”的标识符的问题

> ID：11746366
> 
> 赞同：1
> 
> 时间：2012-07-31T18:08:33.107
> 
> 标签：doctrine-orm, symfony-2.1

**情况是这样的：** 我是 Symfony2 的新手并且喜欢它，但我遇到了 Doctrine 的 CRUD 生成器的问题。我已经从 YAML 文件开始使用 Doctrine 生成实体，但无法使用doctrine:generate:crud 命令行生成它们的CRUD。

**问题：** 出于某种原因，我需要设置一个 'id' 字段和一个 getId() 方法，但这有点毁了我在类图和关系模式上所做的所有工作......</p>

**我的问题是：** 有没有办法让我的字段名称保持原样并让 Doctrine 仍然生成我的 CRUD？

一个 YAML 示例：

```
XXX\XXXBundle\Entity\Utilisateur:
 type: entity
 table: utilisateur
 id:
  pseudo:
   type: string
 fields:
  nom:
   type: string 
```

我被这个困住了......我试图改变它：

```
XXX\XXXBundle\Entity\Utilisateur:
 type: entity
 table: utilisateur
 fields:
  pseudo: # Le pseudo correspond au nom affiché pour identifier un utilisateur.
   type: string
   id: true 
```

但这并没有改变任何事情我总是最终得到这个：

```
[RuntimeException]                                                                                      
The CRUD generator expects the entity object has a primary key field named "id" with a getId() method. 
```

如果有人能提供帮助，我将不胜感激！在最坏的情况下，我将不得不修改我的所有实体以添加一个带有自动生成整数的愚蠢 ID 字段……</p>

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T18:17:11.190

不，这是不可能的。

已经有更改请求： [https ://github.com/sensio/SensioGeneratorBundle/issues/57](https://github.com/sensio/SensioGeneratorBundle/issues/57)

它在[DoctrineCrudGenerator.php](https://github.com/sensio/SensioGeneratorBundle/blob/master/Generator/DoctrineCrudGenerator.php#L69)中的第 69 - 71 行硬编码：

```
if (!in_array('id', $metadata->identifier)) {
    throw new \RuntimeException('The CRUD generator expects the entity object has a primary key field named "id" with a getId() method.');
} 
```

# ruby-on-rails-3 - Rails 3+ 将 XML 转换为哈希并删除“根”元素

> ID：11746374
> 
> 赞同：2
> 
> 时间：2012-07-31T18:08:58.380
> 
> 标签：ruby-on-rails-3, hash, xml-parsing

我有一些（不是“正确格式化”的）XML 存储为字符串：

```
xml_data_as_string = "<first_name>John</first_name><last_name>Smith</last_name>" 
```

我正在尝试将其转换为哈希，以便可以像这样引用它：

```
@hash[:first_name] # => John 
```

我可以这样做：

```
Hash.from_xml("<root>#{xml_data_as_string}</root>") 
```

from_xml 方法似乎要求 XML 有一个根元素。所以我目前必须将哈希引用为：

```
@hash[:root][:first_name] # => John 
```

这有点不方便，我想知道是否有一种简单的方法可以做到这一点。我查看了 from_xml 的 API，它非常稀疏……显示了 1 个示例，没有进一步解释。

这样做并不是世界末日，但我想要一个更清洁的解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T18:15:21.577

`@hash = Hash.from_xml("<root>#{xml_data_as_string}</root>")[:root]`

XML 数据需要正确格式化才能被解析，但这样您只需调用`[:root]`一次。确保数据是好的，否则你会得到一个错误要求`[:root]`。

# svn - 我可以进行 svn 转储并重新设置目录吗？

> ID：11746377
> 
> 赞同：3
> 
> 时间：2012-07-31T18:09:16.487
> 
> 标签：svn, dump, svnadmin

我正在移动 SVN 提供程序，并且这样做我所有的 repos 都开始了，`https://www.provider1.com/myrepo1`所以我在那个 repo 上做了一个 svn 转储，并且在 repo 中我的路径 start `trunk/src`，`trunk/lib`等等。但是，我的新提供者只给了我一个 URL让我把我的项目倾销到那些。所以我需要重命名转储中的所有目录，以便为每个路径添加一个新的父目录，使其看起来像`myrepo1/trunk/src`,`myrepo1/trunk/lib`等。我意识到我可以在每个 URL 存储库中创建一个新目录，并将文件夹移动到其中。但这并不能改变它的历史。那么有没有办法使用 svndumpfilter 直接将这个父级添加到转储文件中呢？如果不是我该怎么办？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-01T17:55:24.597

这是我为使其正常工作所做的工作。毕竟我没有使用 svndumpfilter。相反，我创建了一个新的存储库，`svnadmin`然后在新创建的 svn 存储库中创建了一个父目录。`svnadmin load`然后使用告诉它将该转储放在新的父目录下来加载转储。

首先拉下项目并创建该项目的转储：

```
svnadmin create project1
emacs repo/hooks/pre-revprop-change
chmod 755 project1/hooks/pre-revprop-change
svnsync init file://$(pwd)/project1 https://somehost.com/svn/project1
svnsync sync file://$(pwd)/project1
svnadmin dump project1 > some.dump 
```

接下来创建一个新的 svn 项目，我们会将转储加载到新的父目录中：

```
svnadmin create someDirectory
svn mkdir -m "Add root directory to project" file://$(pwd)/someDirectory/THE_PARENT_NAME
cat some.dump | svnadmin load --parent-dir THE_PARENT_NAME someDirectory 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-02T02:26:11.367

或者，您可以使用基于[SVNKit的](http://svnkit.com)[svnkitfilter](https://sourceforge.net/projects/svnkitfilter/)：

```
$ svnkitfilter OLD_ROOT_URL NEW_URL --prefix myrepo1 
```

# java - 如何在 maven 中使用最新的 AppleJavaExtensions？

> ID：11746378
> 
> 赞同：2
> 
> 时间：2012-07-31T18:09:19.153
> 
> 标签：java, macos, maven

我开发了一个 Java 应用程序，它使用一些[Apple Java 扩展](http://developer.apple.com/library/mac/#documentation/Java/Reference/JavaSE6_AppleExtensionsRef/api/index.html)来为 Mac 用户提供更好的体验。为了在 Windows 上编译应用程序，我之前只使用了 Eclipse，将 AppleJavaExtensions.jar 设置为引用库。

现在我正在寻找使用 maven 构建我遇到了问题。我在 pom.xml 中添加了以下内容：

```
<dependency>
  <groupId>com.apple</groupId>
  <artifactId>AppleJavaExtensions</artifactId>
  <version>1.4</version>
</dependency> 
```

但是下载的 AppleJavaExtensions.jar 已过期 - 它没有 AboutHandler 或 OpenFilesHandler 等。

是否有提供更新版本的 Maven 存储库？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-04T01:19:47.420

我自己没有尝试过，但是**OrangeExtensions**项目确实有`AboutHandler`并且`OpenFilesHandler`：http: [//ymasory.github.com/OrangeExtensions/](http://ymasory.github.com/OrangeExtensions/)

它在 Maven 中心：

```
<dependency>
  <groupId>com.yuvimasory</groupId>
  <artifactId>orange-extensions</artifactId>
  <version>1.0.0</version>
</dependency> 
```

# iphone - iOS本地通知打开特定选项卡？

> ID：11746380
> 
> 赞同：2
> 
> 时间：2012-07-31T18:09:21.900
> 
> 标签：iphone, ios, uitabbarcontroller, uilocalnotification

我正在构建一个应用程序，其中包含当天的报价作为选项卡控制器中的第三个选项卡。我希望本地通知选项让用户有时知道他们安排有新报价。我还希望在单击通知时将应用程序直接打开到第三个选项卡，但我不确定如何执行最后一部分。我已经[查看了当用户收到推送通知时打开特定的选项卡/视图，](https://stackoverflow.com/questions/6734338/open-a-specific-tab-view-when-user-receives-a-push-notification)但接受的答案确实没有任何关于如何操作的详细信息。本地通知已在代码中设置，只需要知道在代码中为通知或 appdelegate 本身添加什么内容即可将其打开到第三个选项卡。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T19:49:27.237

在`application:didFinishLaunchingWithOptions:`

```
UILocalNotification *localNotif = [launchOptions objectForKey:UIApplicationLaunchOptionsLocalNotificationKey];
if (localNotif) {
    tabBarController.selectedIndex = 2;
} 
```

# hyperthreading - 超线程配置

> ID：11746381
> 
> 赞同：0
> 
> 时间：2012-07-31T18:09:25.853
> 
> 标签：hyperthreading

假设我有一台机器，它有 2 个 Intel Xeon x5550 四核处理器（共 8 核）。超线程已启用。

我想在 4 个内核（4 个线程）上运行一个应用程序，每个内核有 2 个物理内核和 2 个线程（超线程），而不是使用实际的 4 个物理内核。

这有可能做到这一点吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T18:13:35.727

只需确保您的应用程序有足够的线程，以便它可以利用足够的内核。之后是操作系统为您的应用程序分配内核的问题

# drupal - 当前节点第一个菜单项的 Nid

> ID：11746384
> 
> 赞同：0
> 
> 时间：2012-07-31T18:09:44.013
> 
> 标签：drupal, menu

我的标题非常具体地说明了我正在寻找的东西。

1.  菜单项 A
2.  菜单项 B（节点）（活动节点）
    1.  菜单项 BA (Node) <- 需要这一项
    2.  菜单项 BB
3.  菜单项 C

如果想得到菜单项“BA”的nid。我对使用任何模块都不感兴趣。必须通过代码解决这个问题。

感谢帮助 ！莫吉奥

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T17:13:46.577

In your node you will have `book` element which represents menu link.

You can do this:

```
$book_link = $node->book;
$next_link = book_next($book_link); // next item in flattened tree
$first_child_node = menu_get_object('node', 1, $next_link['link_path']); 
```

# objective-c - Objective-C 将 Markdown 解析为 HTML 总是截断最后几个标签

> ID：11746385
> 
> 赞同：0
> 
> 时间：2012-07-31T18:09:47.317
> 
> 标签：objective-c, cocoa, xhtml, markdown

我尝试使用以下解决方案：

[Cocoa 应用程序最简单的 Markdown 实现是什么？](https://stackoverflow.com/questions/1435288/what-is-the-simplest-implementation-of-markdown-for-a-cocoa-application)

但两种解决方案都没有返回完全有效的 html，因为缺少最后一个标签（或两个？）。例如：

这个降价：

```
### Markdown Example - Lists

#### Unordered list
* Aenean 
* vel 
    * libero 
    * eget 
* ante

#### Ordered list
1\. Aenean 
2\. vel 
3\. libero 
4\. eget 
5\. ante 
```

输出以下 html：

```
<h3>Markdown Example - Lists</h3>

<h4>Unordered list</h4>

<ul>
    <li>Aenean </li>
    <li>vel 
        <ul>
            <li>libero </li>
            <li>eget </li>
        </ul>
    </li>
    <li>ante</li>
</ul>

<h4>Ordered list</h4>

<ol>
    <li>Aenean </li>
    <li>vel </li>
    <li>libero </li>
    <li>eget </li>
    <li>ante 
```

（为清楚起见添加了缩进）。

用于生成此代码的代码取自第二个答案（尽管我也尝试了第一个，结果相同）：

```
 NSString *markdownXHTML = @"";
    if([ext isEqualToString:@"markdown"] || [ext isEqualToString:@"md"]){
        NSString *rawMarkdown = [NSString stringWithContentsOfFile:path
                                                          encoding:NSUTF8StringEncoding
                                                             error:NULL];
        const char * prose = [rawMarkdown UTF8String];  
        struct buf *ib, *ob;       

        int length = [rawMarkdown lengthOfBytesUsingEncoding:NSUTF8StringEncoding] + 1;

        ib = bufnew(length);
        bufgrow(ib, length);
        memcpy(ib->data, prose, length);
        ib->size = length;

        ob = bufnew(64);

        struct sd_callbacks callbacks;
        struct html_renderopt options;
        struct sd_markdown *markdown;

        sdhtml_renderer(&callbacks, &options, 0);
        markdown = sd_markdown_new(0, 16, &callbacks, &options);

        sd_markdown_render(ob, ib->data, ib->size, markdown);
        sd_markdown_free(markdown);

        markdownXHTML = [NSString stringWithUTF8String: ob->data];

        bufrelease(ib);
        bufrelease(ob);
    } 
```

有人有什么想法吗？:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T18:42:53.663

[我认为您无意中从您引用的问题](https://stackoverflow.com/questions/1435288/what-is-the-simplest-implementation-of-markdown-for-a-cocoa-application)中复制了**下一个**答案的代码，尽管乍一看看起来很相似，但这是完全不同的。大概你使用了错误的函数来确定你的原始数据。`length`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-05T02:05:00.097

解决：

使用 MMMarkdown 库 [1] 我能够完全解析降价！

[1] [https://github.com/mdiep/MMMarkdown](https://github.com/mdiep/MMMarkdown)

# google-apps-script - 脚本失去了修改 ScriptDb 的权限

> ID：11746387
> 
> 赞同：0
> 
> 时间：2012-07-31T18:09:51.213
> 
> 标签：google-apps-script

嗨，大约一个小时前，在编辑一些脚本时，所有这些脚本都失去了从数据库中保存或删除的权限。我试图重新授权他们，虽然我尝试了很多事情，但我无法获得授权提示。我不断收到以下错误消息：

您无权调用删除。

您无权调用保存。

另外当时我注意到在脚本编辑器的右上角有另外 3 个查看者的通知（都显示我的用户名）。我只打开了一个浏览器和一个编辑器实例，但通知仍然存在。

有什么建议吗？

（PS 在所有其他脚本上都没有这些“问题”）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T19:13:05.950

我保存了我的 db 库的新版本，重新授权了 db 库（最终），更新了其他脚本上的库，重新授权了脚本，一切似乎都很顺利。有趣的是，在问题出现之前我根本没有碰过我的数据库库。

# android - elm327 安卓版

> ID：11746391
> 
> 赞同：2
> 
> 时间：2012-07-31T18:10:09.013
> 
> 标签：android, bluetooth, driver

我想为 elm327 开发一个 Android 应用程序来测试车辆 ECU。

如果我在安卓设备和ELM327设备之间使用蓝牙连接，**我需要在安卓应用程序上安装驱动程序吗？**还是仅使用 Google 在 Android 平台中提供的内置蓝牙类并根据 ELM327 规范使用 AT 命令就足够了？

请大家帮忙！！！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-01T18:28:11.453

这完全取决于您使用什么作为 ELM327 设备。

如果它是基于 USB 的并且您将其连接到蓝牙适配器，那么您很可能需要为 USB 设备安装驱动程序。

如果您正在构建自己的或购买物理上是 rs232 端口/蓝牙适配器，甚至是 ELM327 蓝牙模块（几乎都使用基于逻辑的 rs232，而不是基于硬件），只要您在android把它当成串口设备，那么你应该可以不用驱动直接连接它。

只要您只是进行诊断而不是尝试“调整”PCM，您就可以将波特率永久设置为 38400 并将其留在那里。

当您开始使用它进行调优时，使用蓝牙时还有其他问题/担忧，一个是在闪烁期间断开连接，这可能会“破坏”PCM，另一个是在初始握手期间强制每秒 5 位，用于访问的种子/密钥.

不过听起来是个不错的项目，祝你好运。

我无论如何都不是安卓程序员，但我在构建 ELM327/PC 接口方面确实有很多经验，所以如果你遇到 ELM327 的问题并与 PCM 通信，请告诉我，我应该能够回答为您服务，或者如果我不能，请为您指明正确的方向以获得答案。

# java - 一项编程作业，如果名称匹配，则将多个文件合并为一个。FileWriter/BufferedWriter

> ID：11746392
> 
> 赞同：0
> 
> 时间：2012-07-31T18:10:10.980
> 
> 标签：java

好吧，所以我应该做一个任务：

假设您有这样排序的聊天日志：

```
System-0/Server-#channel.log
System-0/Server-#channel1.log
System-0/Server-#channel2.log
System-1/Server-#channel.log
System-1/Server-#channel2.log
System-2/Server-#channel3.log 
```

System-0 是我的第一个系统，系统 1 和 2 是其他计算机。我将如何继续将 System-0/#channel 与 System-1/#channel 日志文件合并？我已经想出了如何获取它们，但是，BufferedWriter 随机停止写入（它忘记了文本）并且它只适用于 1 个文件（所以说在不同的目录中有 2 个重复的日志文件它只会处理第一个重复的日志文件在不同的目录中）。

对不起我的英语，我不是母语人士，但我希望你明白我的意思。到目前为止，这是我所拥有的：我也对任何改进持开放态度。

```
import java.io.*;
import java.nio.MappedByteBuffer;
import java.nio.channels.FileChannel;
import java.nio.charset.Charset;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.Map;
import java.util.logging.Logger;

public class MergeV2 {

private static final Logger log = Logger.getLogger(MergeV2.class.getName());
private static final File ROOT_FOLDER = new File(System.getProperty("user.home") + (System.getProperty("os.name").contains("Windows") ? "/AppData/Roaming/X-Chat 2/xchatlogs" : "/.xchat2/xchatlogs"));
private static final HashMap<String, File[]> files = new HashMap<String, File[]>();
private static final HashMap<File, File[]> filesToWrite = new HashMap<File, File[]>();

public static void main(String... args) {
    if (ROOT_FOLDER.exists()) {
        for (final File f : ROOT_FOLDER.listFiles()) {
            if (f.isDirectory() && f.getName().contains("System")) { //mandatory check
                for (final File sub : f.listFiles()) {
                    String channelName = sub.getName().split("#")[1].replaceAll(".log", "");
                    if (files.containsKey(channelName)) {
                        ArrayList<File> tempFiles = new ArrayList<File>();
                        for (File t : files.get(channelName)) {
                            tempFiles.add(t);
                        }
                        tempFiles.add(sub);
                        File[] array = new File[tempFiles.size()];
                        array = tempFiles.toArray(array);
                        files.put(channelName, array);
                    } else {
                        files.put(channelName, new File[]{sub});
                    }
                }
            }
        }
    } else {
        log.info("No log folder detected.");
    }
    String channel;
    File f, ftemp;
    for (Map.Entry<String, File[]> es : files.entrySet()) {
        channel = "#" + es.getKey();
        f = new File(ROOT_FOLDER.getAbsolutePath() + "/merged-" + channel + ".log");
        ftemp = new File(f.getAbsolutePath() + ".temp");
        if (f.exists()) {
            f.delete();
            ftemp.delete();
        }
        try {
            f.createNewFile();
            ftemp.createNewFile();
        } catch (IOException ioe) {
            ioe.printStackTrace();
        }
        filesToWrite.put(f, es.getValue());
    }
    try {
        FileWriter fw = null;
        BufferedWriter bw = null;
        BufferedReader in = null;
        for (Map.Entry<File, File[]> es : filesToWrite.entrySet()) {
            File temp = new File(es.getKey() + ".temp");
            bw = new BufferedWriter(new FileWriter(temp));
            for (File t : es.getValue()) {
                bw.write(readFile(t.getAbsolutePath()));
            }
            in = new BufferedReader(new FileReader(new File(es.getKey() + ".temp")));
            StringBuilder sb = new StringBuilder();
            String line;
            while ((line = in.readLine()) != null) {
                if (!line.contains("**** LOGGEN") && !line.contains("**** LOGGING")) {
                    sb.append(line);
                }
            }
            bw = new BufferedWriter(new FileWriter(es.getKey()));
            in.close();
            new File(es.getKey() + ".temp").delete();
            bw.write(sb.toString());
        }
    } catch (IOException e) {

    }
}

private static String readFile(String path) throws IOException {
    System.out.println("reading " + path);
    FileInputStream stream = new FileInputStream(new File(path));
    try {
        FileChannel chan = stream.getChannel();
        MappedByteBuffer mbb = chan.map(FileChannel.MapMode.READ_ONLY, 0, chan.size());
        return Charset.defaultCharset().decode(mbb).toString();
    } finally {
        stream.close();
    }
}
} 
```

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T18:20:23.577

您必须关闭缓冲写入器：

后 ..

```
 bw = new BufferedWriter(new FileWriter(es.getKey()));
 in.close();
 new File(es.getKey() + ".temp").delete();
 bw.write(sb.toString()); 
```

添加

```
 bw.close(); 
```

如果缓冲写入器未关闭，则不会保存更改，这解释了您提到的“（它忘记了文本）”。

# ios - 如何用 frank 编写 Cucumber 测试

> ID：11746397
> 
> 赞同：0
> 
> 时间：2012-07-31T18:10:37.920
> 
> 标签：ios, unit-testing, cucumber, frank

我是使用 cucumber/frank/ruby 的新手，并尝试按照此处的步骤进行操作[http://blog.thepete.net/blog/2012/06/24/writing-your-first-frank-test/](http://blog.thepete.net/blog/2012/06/24/writing-your-first-frank-test/) 我正在尝试创建一个步骤定义。在本教程中，他们为您提供了编写步骤定义的代码。这是他们的示例步骤定义代码：

```
Then /^I should be on the Home screen$/ do
  check_element_exists "view view:'UIImageView' marked:'Icon512x512.png'"
end
When /^I navigate to "(.*?)"$/ do |tab_name|
  touch "view:'UITabBarButton' marked:'#{tab_name}'"
end
Then /^I should be on the Events screen$/ do
  check_element_exists "view:'UIScrollView' view:'UIButton' marked:'archery'"
  check_element_exists "view:'UIScrollView' view:'UIButton' marked:'badminton'"
  check_element_exists "view:'UIScrollView' view:'UIButton' marked:'boxing'"
end 
```

我试着只写第一部分来应用我的应用程序，并这样写：

```
Then /^I should be on the Map screen$/ do
  check_element_exists "view view:'UIButtonLabel' marked:'Photo View'"
end 
```

它给了我错误然后我应该在地图屏幕上# features/step_definitions/navigation_steps.rb:1 frankly_map view view: 'UIButtonLabel' mapped:'Photo View' accessibilityLabel failed because: invalid selector *** -[__NSArrayM objectAtIndex:]:空数组的索引 0 越界 (RuntimeError) /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/timeout.rb:53:in `timeout' ./features/step_definitions/navigation_steps.rb:1:in`/^I 应该在地图屏幕上$ /' features/navigation.feature:5:in `那么我应该在地图屏幕上'

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T05:35:37.253

如果我理解正确，并且您访问的是默认按钮，您应该像这样：

```
Then /^I should be on the Map screen$/ do
  check_element_exists "view view:'UIButton' marked:'Photo View'"
end 
```

尝试发布您的共生体的屏幕截图，干杯。

# silverlight - PivotItem 控制 windows phone 7 设置禁用标题的颜色

> ID：11746411
> 
> 赞同：1
> 
> 时间：2012-07-31T18:11:55.667
> 
> 标签：silverlight, windows-phone-7.1, windows-phone, pivotitem

当 PivotItem 控件不是当前选定的控件时，有没有办法在 XAML 中设置标题颜色的状态。

这是我用于枢轴项目控制的标题代码

```
<controls:PivotItem.Header>
  <TextBlock Text="first" Foreground="{StaticResource PhoneAccentBrush}"/>
</controls:PivotItem.Header> 
```

在下面的示例中，我希望所有标题的颜色都是 PhoneAccentBrush，但是当它进入禁用状态时，我希望它是灰色的（但它变成了 PhoneAccentBrush 的暗色版本）。怎么做 ？我确信我可以在 C# 代码中执行此 hack，但我希望在 XAML 本身中完成此操作。请帮忙。

![在此处输入图像描述](../Images/eb8dcdf42ed8bf0b160a3167c2b74384.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-31T21:27:34.680

不幸的是，要实现这一点，需要进行很多样式设置。首先，您需要为 Pivot 创建一个样式。最好使用 Expression Blend 执行此操作。

```
<Style x:Key="PivotStyle1" TargetType="controls:Pivot">
    <Setter Property="Margin" Value="0"/>
    <Setter Property="Padding" Value="0"/>
    <Setter Property="Foreground" Value="{StaticResource PhoneForegroundBrush}"/>
    <Setter Property="Background" Value="Transparent"/>
    <Setter Property="ItemsPanel">
        <Setter.Value>
            <ItemsPanelTemplate>
                <Grid/>
            </ItemsPanelTemplate>
        </Setter.Value>
    </Setter>
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="controls:Pivot">
                <Grid HorizontalAlignment="{TemplateBinding HorizontalAlignment}" VerticalAlignment="{TemplateBinding VerticalAlignment}">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    <Grid Background="{TemplateBinding Background}" CacheMode="BitmapCache" Grid.RowSpan="3"/>
                    <ContentPresenter ContentTemplate="{TemplateBinding TitleTemplate}" Content="{TemplateBinding Title}" Margin="24,17,0,-7"/>
                    <controlsPrimitives:PivotHeadersControl x:Name="HeadersListElement" Grid.Row="1"/>
                    <ItemsPresenter x:Name="PivotItemPresenter" Margin="{TemplateBinding Padding}" Grid.Row="2"/>
                </Grid>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style> 
```

请注意，其中有一个样式`PivotHeadersControl`。此控件是一个 TemplatedItemsControl 类型`PivotHeaderItem`。这个 PivotHeaderItem 是我们需要设置的样式。您可以设置该`ItemContainerStyle`属性以根据标题的状态更改标题的外观。

```
<Style x:Key="PivotHeaderItemStyle1" TargetType="controlsPrimitives:PivotHeaderItem">
    <Setter Property="Background" Value="Transparent"/>
    <Setter Property="Padding" Value="21,0,1,0"/>
    <Setter Property="CacheMode" Value="BitmapCache"/>
    <Setter Property="Margin" Value="0"/>
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="controlsPrimitives:PivotHeaderItem">
                <Grid>
                    <VisualStateManager.VisualStateGroups>
                        <VisualStateGroup x:Name="SelectionStates">
                            <VisualState x:Name="Unselected">
                                <Storyboard>
                                    <ColorAnimation Duration="0" Storyboard.TargetName="contentPresenter" 
                                Storyboard.TargetProperty="(TextBlock.Foreground).(SolidColorBrush.Color)" To="Gray"/>
                                </Storyboard>
                            </VisualState>
                            <VisualState x:Name="Selected">
                                <Storyboard>
                                    <DoubleAnimation Duration="0" To="1" Storyboard.TargetProperty="(UIElement.Opacity)" Storyboard.TargetName="contentPresenter"/>
                                </Storyboard>
                            </VisualState>
                        </VisualStateGroup>
                    </VisualStateManager.VisualStateGroups>
                    <TextBlock x:Name="contentPresenter" 
                Text="{TemplateBinding Content}"
                HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" 
                Foreground="{StaticResource PhoneAccentBrush}"
                Margin="{TemplateBinding Padding}" Opacity=".4"/>
                </Grid>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style> 
```

我已将默认样式修改为使用 TextBlock 而不是 ContentPresenter。这允许您从 Unselected 状态情节提要中设置前景。

确保将 Pivot 的 Style 设置为 PivotStyle1，并且 PivotHeadersControl 的 ItemContainerStyle 设置为 PivotHeaderItemStyle1。您还需要对其进行一些修改，以按照您想要的方式调整大小。

# xml - InDesign CS5 脚本：导入 XML 时如何忽略 DTD？

> ID：11746415
> 
> 赞同：0
> 
> 时间：2012-07-31T18:12:27.820
> 
> 标签：xml, dtd, adobe-indesign, extendscript

我正在将 XML 导入 InDesign，并收到以下消息：

> 找不到外部实体“blahblah.dtd”。还是继续导入？

然后当我继续导入 XML 时，我收到以下错误消息：

> Javascript 错误！
> 
> 错误号：103237 错误字符串：DOM 转换错误：无效的命名空间。
> 
> 引擎：会话文件：C:\blahblah\blahblah.jsx 行：259 源：
> obj.doc.importXML(File(xmlDoc));

...问题是，我无法访问 DTD，而且无论如何我都不需要它来实现我的目的。

* * *

*   **那么，有没有一种 Extendscript 方法可以忽略 DTD？**
*   **如果没有，有没有办法用 XSLT 忽略 DTD？**

* * *

以下是相关代码：

```
function importXML(xmlDoc, xslt)
{
    with(obj.doc.xmlImportPreferences)
    {
        importStyle = XMLImportStyles.MERGE_IMPORT; // merges XML elements into the InDesign document, merging with whatever matching content
        createLinkToXML = true; // link elements to the XML source, instead of embedding the XML

        // defining the XSL transformation settings here
        allowTransform = true; // allows XSL transformation
        transformFilename = File(xslt); // applying the XSL here

        repeatTextElements = true; //  repeating text elements inherit the formatting applied to placeholder text, **only when import style is merge!
        ignoreWhitespace = true; // gets rid of whitespace-only  text-nodes, and NOT whitespace in Strings
        ignoreComments = true;
        ignoreUnmatchedIncoming = true; // ignores elements that do not match the existing structure, **only when import style is merge!
        importCALSTables = true; // imports CALS tables as InDesign tables
        importTextIntoTables = true; // imports text into tables if tags match placeholder tables and their cells, **only when import style is merge!
        importToSelected = false; // import the XML at the root element
        removeUnmatchedExisting = false;
    }

    obj.doc.importXML(File(xmlDoc) );
    obj.doc.mapXMLTagsToStyles(); // automatically match all tags to styles by name (after XSL transformation)

    alert("The XML file " + xmlDoc.name + " has been successfully imported!");

} // end of function importXML 
```

...这是基于 p。407（第 18 章）[使用 XML 和 Javascript 实现 InDesign CS5 自动化](http://books.google.com/books?id=1aj1FofthiwC&pg=PA407&lpg=PA407&dq=indesign%20%22transformfilename%22%20xsl&source=bl&ots=Oht9-Bx2BF&sig=0GKPZw5ORCB1dPYqut838IkHQZY&hl=en&sa=X&ei=ygEYUOrxHojq9ATqrIGIDw&ved=0CE0Q6AEwAA#v=onepage&q=indesign%20%22transformfilename%22%20xsl&f=false)，作者：Grant Gamble

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T19:41:22.227

我认为 zanegray 给了你主要的概念，尽管我认为你的东西过于复杂。为什么不只是获取 xml 文件内容，使用正则表达式删除 dtd 声明，然后输出将用于输入的新 XML 文件？

```
//Open and retrieve original xml file content
var originalXMLFile = File (Folder.desktop+"/foo.xml" );
originalXMLFile.open('r');
var content = originalXMLFile.read();
//Looks for a DOCTYPE declaration and remove it
content = content.replace ( /\n<!DOCTYPE[^\]]+\]>/g , "" );
originalXMLFile.close();
//Creates a new file without any DTD declaration
var outputFile = new File ( Folder.desktop+"/bar.xml" );
outputFile.open('w');
outputFile.write(content);
outputFile.close(); 
```

然后，您可以使用此过滤后的 xml 进行导入。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-31T20:08:07.580

这是一个将去除 DOCTYPE 声明的 XSLT：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:template match="/">
        <xsl:copy-of select="."/>
    </xsl:template>
</xsl:stylesheet> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-01T08:17:44.777

好的，甚至更简单。我们只需要阻止交互，然后删除任何附加的 dtds：

```
function silentXMLImport(file)
{
    var doc, oldInteractionPrefs = app.scriptPreferences.userInteractionLevel;

    if ( !(file instanceof File) || !file.exists )
    {
        alert("Problem with file : "+file );
    }

    if ( app.documents.length == 0 )
    { 
        alert("Open a document first");
        return; 
    }

    //Prevent interaction and warnings
    app.scriptPreferences.userInteractionLevel = UserInteractionLevels.NEVER_INTERACT;
    doc = app.activeDocument;
    doc.importXML ( file );

    //Remove any dtd attached to the document
    doc.dtds.everyItem().remove();

    app.scriptPreferences.userInteractionLevel = oldInteractionPrefs;
}

//Now import xml
silentXMLImport ( File ( Folder.desktop+"/foobar.xml" ) ); 
```

它在这里工作。

# javascript - 拖放后如何将图像上传到服务器

> ID：11746423
> 
> 赞同：0
> 
> 时间：2012-07-31T18:12:52.040
> 
> 标签：javascript, html, servlets, drag-and-drop

我已经完成了整个拖放操作，但是您如何将其上传到服务器？？？我可以得到一些base64编码的图像的dataURL。有没有办法将它上传到我的 servlet 以及 servlet 如何接受这个？ [本教程](http://www.thebuzzmedia.com/html5-drag-and-drop-and-file-api-tutorial/)很有帮助，但缺少上传部分。我还查看了其他 JQuery 插件，这些插件似乎是为我使用而定制的并且很重。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T18:37:42.920

一种选择是使用它：

[http://www.plupload.com/](http://www.plupload.com/)

虽然它带有 UI，但它还带有 JS 库，您可以通过编程方式将文件发送到服务器。UI 和编程部分是单独的 js 文件，因此您不必用不必要的 JS 使您的网站混乱......

我是不重新发明轮子的大力倡导者......:-)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-31T23:08:49.157

经过更多搜索，我发现使用 JavaScript 的`FormData`对象提交文件非常容易。`dataTransfer.files`从拖放API中获取图像文件后，下面的代码就能够成功地将图像文件发送到服务器。

```
// Create formdata object
var formData = new FormData;
// Append form item (key, value)
formData.append('file', imageFile);

// JQuery ajax call to submit the file using post request
$.ajax({
    url: 'url_of_server_script',
    data: formData,
    processData: false,
    contentType: false,
    type: 'POST',
    success: function(data){
        alert(data);
    }
}); 
```

# django - Grappelli 中的管理过滤器

> ID：11746429
> 
> 赞同：2
> 
> 时间：2012-07-31T18:13:14.027
> 
> 标签：django, django-admin

我有一个简单的模型，按客户显示产品页面：

```
class PostPage(models.Model):
    client = models.CharField(max_length=50, choices=CLIENT_CHOICES)
    job_number = models.CharField(max_length=30, unique=True, blank=False, null=False)
    job_name = models.CharField(max_length=64, unique=False, blank=False, null=False)
    page_type = models.CharField(max_length=50, default='POST')
    ... 
```

在管理员中，我希望能够按客户端对记录进行排序，因此我的 admin.py 有：

```
class PostPageAdmin(GuardedModelAdmin):
    list_filter = ('client',) 
```

这提供了我在 Django 的内置管理员中寻找的管理员更改列表过滤器，但是，当我切换到 grappelli 时，过滤器列表消失（并且操作下拉列表旁边的删除按钮也消失了，尽管这可能是一个单独的问题） . 这听起来像是不正确的 grappelli 实现，还是 grappelli 可能在 admin.py 中需要与默认管理员安装不同的过滤器代码？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T19:10:21.137

Grapelli 有自己的配置，您必须单独输入......AFAIK 自动生成的仪表板并不总是正确的。您必须创建自己的并使用过滤器和按钮等对其进行配置... [grapelli docs](http://django-grappelli.readthedocs.org/en/latest/dashboard_api.html)

# python - 有什么方法可以将模拟方法重置为其原始状态？- Python 模拟 - 模拟 1.0b1

> ID：11746431
> 
> 赞同：45
> 
> 时间：2012-07-31T18:13:19.970
> 
> 标签：python, mocking, python-mock

我有以下我正在模拟的简化类：

```
class myClass(object):
    @staticmethod
    def A():
        #...

    def check(self):
        #code...
        value = self.A()
        #more code... 
```

在我的第一个测试中，我只模拟了方法 A

```
from django.test import TestCase
from mock import MagicMock
import myClass

class FirstTest(TestCase):

def setUp(self):
    myClass.A = MagicMock(return_value = 'CPU')

def test(self):
    #some tests 
    myClassObj = myClass()
    myClassObj.check() 
```

而在我的第二个测试中，我模拟了整个检查方法：

```
from django.test import TestCase
from mock import MagicMock
import myClass

class SecondTest(TestCase):

def setUp(self):
    myClass.check = MagicMock(return_value = someObject)

def test(self):
    #some tests 
    myClassObj = myClass()
    myClassObj.check() 
```

现在我的第一个测试中的断言失败了，因为它不是在inside调用`check()`和模拟，而是从我的第二个测试中调用完全模拟的。`A()``check()``check()`

测试后有什么方法可以清除并将方法设置为“正常”？我`myClass.check.reset_mock()`已经尝试过了，但它似乎没有做任何事情。移动我的测试顺序也无济于事。

我正在使用来自[http://pypi.python.org/pypi/mock/的 python 模拟 1.0b1](http://pypi.python.org/pypi/mock/)

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2012-08-03T08:45:45.853

您可以`mock.patch`用作装饰器或上下文管理器：

```
from mock import patch, MagicMock

@patch('myClass.A', MagicMock(return_value='CPU'))
def test(self):
    pass 
```

或者：

```
def test(self):
    with patch('myClass.A', MagicMock(return_value='CPU')):
        pass 
```

如果您不提供模拟对象，`patch`那么它将提供一个您可以修改的自动指定模拟：

```
@patch('myClass.A')
def test(self, mock_A):
    mock_A.return_value = 'CPU'
    pass 
```

或者：

```
def test(self):
    with patch('myClass.A') as mock_A:
        mock_A.return_value = 'CPU'
        pass 
```

在所有情况下，当修饰的测试函数或上下文管理器完成时，原始值将被恢复。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2012-08-03T07:59:55.667

您可以将功能隐藏在 self 上，并在完成后将其放回。

```
import unittest

from mock import MagicMock
from MyClass import MyClass

class FirstTest(unittest.TestCase):

    def setUp(self):
        self.A = MyClass.A
        MyClass.A = MagicMock(name='mocked A', return_value='CPU')

    def tearDown(self):
        MyClass.A = self.A

    def test_mocked_static_method(self):
        print 'First Test'
        print MyClass.check
        print MyClass.A

class SecondTest(unittest.TestCase):

    def setUp(self):
        MyClass.check = MagicMock(name='mocked check', return_value=object)

    def test_check_mocked_check_method(self):
        print 'Second Test'
        print MyClass.check
        print MyClass.A

if __name__ == '__main__':
    unittest.main() 
```

运行此文件会给出以下输出：

```
First Test
<unbound method MyClass.check> 
<MagicMock name='mocked A' id='141382732'>
Second Test
<MagicMock name='mocked check' id='141382860'>
<unbound method MyClass.A> 
```

我发现自己现在使用的补丁装饰器比 setUp 和 tearDown 更多。在这种情况下，你可以做

```
from mock import patch

@patch('MyClass.A')
def test_mocked_static_method(self, mocked_A)
    mocked_A.return_value = 'CPU'
    # This mock will expire when the test method is finished 
```

# macos - 如何创建自定义 NSSharingService

> ID：11746433
> 
> 赞同：3
> 
> 时间：2012-07-31T18:13:23.700
> 
> 标签：macos, osx-lion

借助 Mountain Lion 的新共享服务，我可以使用它`NSSharingService`来创建自定义服务并使用现有的系统服务，例如 Twitter。

如何将我自己的服务添加到系统服务列表中，以便其他应用程序可以使用它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-21T08:30:17.333

简而言之，您无法创建`NSSharingService`可用于系统范围内其他应用程序的自定义。将您的服务集成到另一个应用程序的唯一方法是为其他开发人员提供一个库或框架。在这种情况下，他们应该明确地将其添加到他们的项目中。

# facebook - 如何获取应用请求以触发 Facebook 应用通知？

> ID：11746439
> 
> 赞同：1
> 
> 时间：2012-07-31T18:13:51.467
> 
> 标签：facebook, request

当用户发送 Facebook 应用程序请求时，我看到它作为来自 Facebook 应用程序的推送通知出现在我的 iPhone 上。有没有办法从开发人员方面触发这个？还是 100% 被 Facebook 控制？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T19:10:39.243

唯一可用的选项是应用请求。有关更多详细信息[https://developers.facebook.com/docs/reference/dialogs/requests/](https://developers.facebook.com/docs/reference/dialogs/requests/)

# linux - 用于检查文件是否为 Unix 可执行文件类型的 Shell 脚本

> ID：11746441
> 
> 赞同：1
> 
> 时间：2012-07-31T18:14:08.373
> 
> 标签：linux, shell

我正在编写一个 Shell 脚本，用户将在其中将 JAVA_HOME 的路径作为参数传递。我想检查 JAVA_HOME 路径是否有效。那么如何检查传递的输入路径是否为 exe 文件（Unix 可执行文件）？假设如果用户通过 /usr/bin/java - 这是有效的，如果用户通过 /usr/bin/test.txt （一些文本文件） - 这是无效的。那么如何检查文件是否为 Unix Executable File 类型？

我试过 -x ，猜那不是仪式检查，因为它也为 /usr/bin 返回 true ！！！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-31T18:18:00.030

最简单的方法是使用[文件](http://linux.die.net/man/1/file)命令。

```
$ file /usr/bin
/usr/bin: directory
$ file /usr/bin/java
/usr/bin/java: Mach-O universal binary with 2 architectures
/usr/bin/java (for architecture x86_64):    Mach-O 64-bit executable x86_64
/usr/bin/java (for architecture i386):  Mach-O executable i386
$ 
```

您可以只用 grep 的输出来`file`寻找合适的字符串，例如“可执行文件”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T18:18:52.797

Unix“可执行文件”是任何设置了执行属性的东西。例如，您不能依赖它，因为您可以在 pdf 文档上设置执行权限。

也许您应该使用[`file`](http://unixhelp.ed.ac.uk/CGI/man-cgi?file)命令来检测文件类型。例如，它将告诉您文件是二进制文件还是纯文本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-31T18:21:13.397

test 的手册页很清楚，只是`-x`不会这样做

> -x 文件 如果文件存在且可执行，则为真。True 仅表示执行标志打开。如果 file 是目录，则 true 表示可以搜索文件。

但是如果你把它`-f`和`-r`

> -f file 如果文件存在并且是常规文件，则为真。
> 
> -r 文件 如果文件存在且可读，则为真。

您将知道该文件是否具有成为可执行文件的必要**属性。**

* * *

用户仍有可能在不可执行文件上设置这些属性，但这显然是用户错误。

* * *

手册页摘录自 Mac OS 10.5 版本。在其他系统（尤其是 Linux）上，您可能看起来有些不同。

# java - Java：掩码格式化字符串

> ID：11746442
> 
> 赞同：-2
> 
> 时间：2012-07-31T18:14:21.517
> 
> 标签：java, string

我想知道如何在 Java 中将字符串格式化为指定的模式。例如：

```
the source string: 01021234
the desired ouput: 01/02/1234 
```

我已经关注了 MaskFormatter 兔子洞，但事实证明它是徒劳的。有人能告诉我我应该使用什么功能吗？任何帮助是极大的赞赏。

请参阅示例代码：

```
private static Date prepData(String date, String time) {
    try {
        if (date != null || !date.equals("")) {
            if (date.contains("/")) {
                return new Date(date + " " + time.substring(0, time.indexOf('.')));
            }else{
                MaskFormatter mk = new MaskFormatter("##/##/####");
                mk.setValidCharacters("1234567890");
                System.out.println(mk.valueToString(date));
            }
        } else {
            return null;
        }
    } catch (Exception ex) {
    }
    return null;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T18:18:27.970

去 String.format 它有几个选项

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T20:01:28.167

您可以尝试 SimpleDateFormat：

[http://javatechniques.com/blog/dateformat-and-simpledateformat-examples/](http://javatechniques.com/blog/dateformat-and-simpledateformat-examples/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-31T18:19:26.853

如果您尝试格式化日期，请在 Java 中使用 DateFormatter

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-01T18:12:30.413

这是我选择的方式，因为我发现 MaskFormatter 方式太难了：

```
private static Date prepData(String date, String time) {
    try {
        if (date != null || !date.equals("")) {
            if (date.contains("/")) {
                return new Date(date + " " + time.substring(0, time.indexOf('.')));
            }else{
                String d = String.format("%s/%s/%s", date.substring(0, 2),date.substring(2, 4),date.substring(4));
                String t = String.format("%s:%s %s", time.substring(0, 2),time.substring(2, 4),time.substring(4));
                return new Date(d + " " + t);
            }
        } else {
            return null;
        }
    } catch (Exception ex) {
    }
    return null;
} 
```

# python - 在没有逗号的python中打印二维列表

> ID：11746443
> 
> 赞同：3
> 
> 时间：2012-07-31T18:14:24.173
> 
> 标签：python, list

我想在 python 中打印一个没有逗号的二维列表。

而不是打印

```
[[0,0,0,0,0,1,1,1,1,1,1],[0,0,0,0,0,0,1,1,1,1,0,0,0,1,1,0,0,1,1,0,1],[1,1,1] ... ] 
```

我要打印

```
[[0 0 0 0 0 1 1 1 1 1 1 1] [0 0 0 0 0 0 1 1 1 1 0 0 0 1 1 0 0 1 1 0 1] [1 1 1] ... ] 
```

关于我应该如何做的任何见解？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-31T18:18:55.710

简单：用 . 转换为字符串后，只需用空格替换逗号即可`repr`。

```
def repr_with_spaces(lst):
    return repr(lst).replace(",", " ") 
```

（这适用于整数列表，但不一定适用于其他任何东西。）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-31T18:33:35.387

这是一个通用的解决方案。使用指定的分隔符和指定的左右括号字符将序列转换为字符串。

```
lst = [[0,0,0,0,0,1,1,1,1,1,1],[0,0,0,0,0,0,1,1,1,1,0,0,0,1,1,0,0,1,1,0,1],[1,1,1]]

import sys
if sys.version_info[0] >= 3:
    basestring = str

try:
    from collections.abc import Iterable
except ImportError:
    from collections import Iterable

def str_seq(seq, sep=' ', s_left='[', s_right=']'):
    if isinstance(seq, basestring):
        return seq
    if isinstance(seq, Iterable):
        s = sep.join(str_seq(x, sep, s_left, s_right) for x in seq) 
        return s_left + s + s_right
    else:
        return str(seq)

print(str_seq(lst)) 
```

为什么代码有那个`isinstance(seq, basestr)`检查？原因如下：

[如何检查对象是列表还是元组（但不是字符串）？](https://stackoverflow.com/questions/1835018/python-check-if-an-object-is-a-list-or-tuple-but-not-string/1835259#1835259)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-31T18:23:25.150

一个通用的、安全的和递归的解决方案，如果数据包含逗号则有效：

```
def my_repr(o):
    if isinstance(o, list):
        return '[' + ' '.join(my_repr(x) for x in o) + ']'
    else:
        return repr(o) 
```

CPython 的实现`list_repr`使用了这个算法（使用`_PyString_Join`）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-31T18:30:38.543

是

```
str([1,2],[3,4]).replace(","," ") 
```

你想要什么？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-31T18:21:08.627

有几种方法：

```
your_string.replace(',',' ') 

' '.join(your_string.split(',')) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-31T18:21:33.450

好吧，作为应用于变量“a”中的数组的单线：

```
print "[" + ' '.join(map(lambda row: "[" + ' '.join(map(str, row)) + "] ", a)) + "]" 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-07-31T18:23:33.027

您可以使用[`str.join()`](http://docs.python.org/library/stdtypes.html?highlight=str.join#str.join)：

```
lists = [[1, 2, 3], [4, 5, 6], [7, 8, 9]]

def format_list(items):
    list_contents = ' '.join(str(it) for it in items) # convert contents to string too
    return '[{}]'.format(list_contents) # wrap in brackets

formatted = format_list(format_list(l) for l in lists) 
```

ideone 示例：http: [//ideone.com/g1VdE](http://ideone.com/g1VdE)

# objective-c - 在 Objective-C 中在哪里编写 @property 指令？

> ID：11746449
> 
> 赞同：0
> 
> 时间：2012-07-31T18:14:42.713
> 
> 标签：objective-c, properties, compiler-directives

*代码1*

```
@interface Rectangle : NSObject   
{
    int width,height;
}
@property int width,height; 
```

*代码2*

```
@interface Rectangle : NSObject
@property int width,height;
{
    int width,height;
} 
```

谁能告诉我，他们之间有什么不同？在`@property`我已经提出`int`了`width`and `height`。为什么要在大括号中再次声明？</p>

更新：我使用的是 osx 10.8 64bit。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T18:21:39.343

您不必重新声明，只需使用：

```
@interface Rectangle : NSObject
@property int width,height;
@end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T18:20:28.063

大括号内的名称是实例变量，可能会也可能不会用作匹配属性的后备存储。这取决于你如何写你的`@synthesize`陈述。

我宁愿根本没有显式的实例变量。我在这种情况下使用它们的唯一原因是使调试更容易。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-31T18:23:43.713

它们之间的区别在于，第一个是对的，第二个是错的。即使第二个代码编译，这也不是您应该编写代码的方式。始终将所有属性声明放在​​ ivars 之后（大括号中的内容。@property 不声明变量（在大括号中完成）。@property 指令向编译器提供有关如何生成 getter 的说明和 setter 方法，当你使用 @synthesize 指令时，你应该在你的实现文件中这样做。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-31T18:30:07.903

在您的示例中，“code1”是正确的，但可能不需要，而“code2”不正确，不会编译。任何实例变量都需要在@interface 行之后直接在大括号中声明，这就是第二个示例错误的原因。

正如其他一些人提到的那样，您可能根本不需要`width`声明`height`。如果您使用的是现代运行时，编译器可以从`@property`语句中看出您打算为该属性创建一个底层实例变量，并将为您创建这些实例变量。另一方面，对于较旧的遗留运行时，实例变量喜欢`width`并且`height`必须显式声明。您没有指定您的平台，因此不清楚您的情况是否需要它。

现代运行时总是在 iOS 上使用，这就是为什么这里很多人会错误地告诉你实例变量在任何情况下都不需要声明。在 Mac OS X 上，现代运行时与 10.5 或更高版本中的 64 位代码一起使用。如果您使用的是 32 位代码或旧版本，则需要显式声明您的实例变量。

# c# - 在 C# 中知道类名的一部分时动态创建对象

> ID：11746450
> 
> 赞同：1
> 
> 时间：2012-07-31T18:14:44.013
> 
> 标签：c#, .net, reflection

我正在使用一个外部 DLL，它有一个抽象的基类 Packet 和 Packet 的子类。

子类以其代表的数字命名，一个名称可以是 P132_RandomString。我正在解析一个包含这些数字的文件，并为每个数字创建一个相应的对象。有数百个不同的子类，并且 DLL 没有工厂方法（至少不是我的输入）。

问题是我不知道“RandomString”部分，如果我知道我可以使用反射，但我认为没有办法使用反射，因为我只知道类名的开头？

我能想到的唯一解决方案是用数百个案例语句实现我自己的工厂方法，但这感觉有点麻烦......

我的问题是：有没有很好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T18:24:42.820

您可以使用 LINQ Where 子句来获取所需的类型。考虑以下程序：（假设您知道基类和前缀）

```
class Program {
    static void Main( string[] args ) {

        string prefix = "p22";
        IEnumerable<Type> types = Assembly.LoadFrom("c:\\Sample.Assembly.dll").GetTypes();    
        Type baseClass = typeof(foo);
        Type foundType = types.Where(
            t => t.Name.StartsWith( prefix ) &&
                t.IsSubclassOf( baseClass )
                ).SingleOrDefault();
        foo myClass = (foo)Activator.CreateInstance( foundType );
                //Do Stuff with myClass 
    }
}
abstract class foo { }
class p22_notMyClass { }
class p22_myclass : foo { }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T18:17:39.660

要从程序集中加载所有类型，请使用`Assembly.GetTypes`

```
 var objects = new List<Object>();
 Assembly SampleAssembly;
 SampleAssembly = Assembly.LoadFrom("c:\\Sample.Assembly.dll");
 // Obtain a reference to types known to exist in assembly.
 Type[] types = SampleAssembly.GetTypes();
 foreach(Type t in types)
    if(t.Name.StartsWith("P132")
       objects.Add(Activator.CreateInstance(t)); 
```

[这里](http://msdn.microsoft.com/en-us/library/d133hta4.aspx)描述的使用`Activator.CreateInstance`方法

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-31T18:21:50.070

在 . 上使用[`Assembly.GetTypes`](http://msdn.microsoft.com/en-us/library/system.reflection.assembly.gettypes.aspx)+ some `String.IndexOf`（或其他匹配）`Type.FullName + Activator.CreateInstance()`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-31T18:26:09.643

您可以使用`Assembly.GetTypes()`方法并迭代类型并找出哪个类的名称中有数字。然后你可以使用 Activator.CreateInstance 来获取一个实例。

# c# - 401 未经授权的响应缓存且无法清除

> ID：11746451
> 
> 赞同：0
> 
> 时间：2012-07-31T18:14:45.863
> 
> 标签：c#, .net, iis, web

我对本地 IIS Express 主机 (localhost:55717) 发出的任何 HttpWebRequest 缓存控制设置为 RequestCacheLevel。默认返回 401 而不联系 IIS - 服务器进程甚至没有运行。

响应来自缓存，IsFromCache 属性承认这一事实，但我已经一次又一次地清除了缓存！

这是回应：

```
X-SourceFiles: =?UTF-8?B?RDpcVHJ1bmtcU0cuQXNnYXJkLkRldmljZUVzdGF0ZS5SZXN0QXBpSG9zdFxTRy5Bc2dhcmQuRGV2aWNlRXN0YXRlLlJlc3RBcGlIb3N0?=
Cache-Control: private
Content-Type: text/html; charset=utf-8
Server: Microsoft-IIS/7.5
WWW-Authenticate: Negotiate,NTLM
X-Powered-By: ASP.NET
Date: Tue, 31 Jul 2012 18:00:22 GMT
Content-Length: 6154
Age: 240 
```

在撰写本文时，日期已经过了一个小时。需要明确的是，对 localhost:55717/blahblah-nonexistent 的任何请求都会产生相同的 401。

有人知道这个问题吗？

# java - 不能使用从另一个 JSP 页面带来的参数

> ID：11746452
> 
> 赞同：0
> 
> 时间：2012-07-31T18:14:47.463
> 
> 标签：java, jsp, url-parameters

这是我第一次尝试在 2 个 JSP 页面之间交换值，index.jsp 页面有一个登录表单，login.jsp 页面会验证这个登录，如果登录不成功，它会重定向到 index.jsp 以及一个名为valid的参数，值为0，如果成功，则值为1。

索引.jsp

```
<%@page import="javax.enterprise.inject.spi.Bean"%>
<%@page import="myDatabase.Login"%> //this is class that I created
<%@page import="myDatabase.JavaDB"%> //this is a class that I created
<%@page contentType="text/html" pageEncoding="UTF-8"%>
<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <link rel="stylesheet" type="text/css" href="indexCSS.css" />
        <title>Chat</title>

    </head>
    <body>
        <jsp:include page="login.jsp">
        <jsp:param name="valid" value="1"/>
        </jsp:include>  
        <% String valid = request.getParameter("valid");%>
        <div class="mainPage">
            <div id="header">
                <div id="pageTitle">
                    Chat
                </div>
            </div>
            <div id="loginBox">
                <form name="login" action="login.jsp" method="POST">

                    <div id="loginItems">
                        <div id="loginTitle">
                            Log in
                        </div>
                        <hr style="color:green;">
                        <div style="margin-top:17px; overflow:hidden;">
                            <label for="id">
                                ID
                            </label>
                            <span id="idError" class="error">
                                    <% if(valid.equals("0")) { %>is not valid<% } %>

                            </span>
                            <br>
                            <input class="inputText" type="text" name="id" value="" maxlength="10" autocomplete="off"/>
                        </div>
                        <div style="margin-top:17px; overflow:hidden;">
                            <label for="password">
                                Password
                            </label>
                            <span id="passwordError" class="error">

                            </span>
                            <br>
                            <input class="inputText" type="password" name="password" value="" maxlength="32" autocomplete="off"/>
                        </div>
                        <div style="margin-top:17px; overflow:hidden;">
                            <div>
                                Forgot your Password?
                            </div>
                        </div>
                        <div style="margin-top:17px; position:relative; overflow:hidden">
                            <input class="inputButton" type="submit" value="Log in" name="loginButton" />
                        </div>
                    </div>
                </form>
            </div>
        </div> 
    </body>
</html> 
```

这是 login.jsp

```
<head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <title>JSP Page</title>
    </head>
    <body>
        <jsp:useBean id="loginBean" scope="session" class="myDatabase.Login" />
        <jsp:setProperty name="loginBean" property="id" />
        <jsp:setProperty name="loginBean" property="password" />
        <%
            JavaDB myJavaDB=new JavaDB();
            myJavaDB.Connect("IULChat","iul","iul");
           if(myJavaDB.isConnected()==true){
                    //response.sendRedirect("index.jsp?a=2");
                    Login myLogin = new Login(loginBean.getId(),loginBean.getPassword());
                    myLogin.setConn(myJavaDB.getMyConnection());
                    myLogin.login(); loginBean.setId(0); loginBean.setPassword("");
                    if(myLogin.isValid()==true)
                                               {
                        response.sendRedirect("index.jsp?valid=1");
                    }
                    else
                                               {
                        response.sendRedirect("index.jsp?valid=0");
                    }
                                       }
            else
                out.println("no");
        %>

    </body>
</html> 
```

当我运行该项目时，我收到此错误。

```
type Exception report

message

descriptionThe server encountered an internal error () that prevented it from fulfilling this request.

exception

org.apache.jasper.JasperException: java.lang.NullPointerException

root cause

java.lang.NullPointerException

note The full stack traces of the exception and its root causes are available in the GlassFish Server Open Source Edition 3.1.2 logs. 
```

如果我删除本节中的 java 代码，此错误就会消失

```
 <span id="idError" class="error">
                            <% if(valid.equals("0")) { %>is not valid<% } %>
                    </span> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T18:26:56.923

`Redirect`将被视为全新的请求，因此您将使用以前的请求参数。如果您想保持请求参数可用于下一页，可能需要考虑使用`forward`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-31T18:33:19.617

该页面可能会抛出 NullPointerException，因为“有效”的值为 null。始终使用格式与文字进行字符串比较

```
<literal>.equals(<variable>) 
```

尝试使用以下更新的代码行：

```
<span id="idError" class="error">
    <% if("0".equals(valid)) { %>is not valid<% } %>
</span> 
```

# php - PHP Tidy 删除有效标签

> ID：11746455
> 
> 赞同：4
> 
> 时间：2012-07-31T18:15:05.167
> 
> 标签：php, html, tidy

我正在使用 php 扩展 tidy-html 来清理 php 输出。我知道 tidy 删除了无效的标签，甚至无法处理 HTML5 doctype，但我使用`<menu>`的是 HTML 规范中的标签。但是，`<ul>`无论如何它都会改变。

*奇怪的是，它以前*没有这样做。我改变了整洁的配置，它已经坏了。现在我已经关闭了所有与标签混淆的选项，但它没有帮助。

我的脚本非常冗长：

```
$tidy_config = array(
    'char-encoding' => 'utf8',
    'output-encoding' => 'utf8',
    'output-html' => true,
    'numeric-entities' => false,
    'ascii-chars' => false,
    'doctype' => 'loose',
    'clean' => false,
    'bare' => false,
    'fix-uri' => true,
    'indent' => true,
    'indent-spaces' => 2,
    'tab-size' => 2,
    'wrap-attributes' => true,
    'wrap' => 0,
    'indent-attributes' => true,
    'join-classes' => false,
    'join-styles' => false,
    'fix-bad-comments' => true,
    'fix-backslash' => true,
    'replace-color' => false,
    'wrap-asp' => false,
    'wrap-jste' => false,
    'wrap-php' => false,
    'wrap-sections' => false,
    'drop-proprietary-attributes' => false,
    'hide-comments' => false,
    'hide-endtags' => false,
    'drop-empty-paras' => true,
    'quote-ampersand' => true,
    'quote-marks' => true,
    'quote-nbsp' => true,
    'vertical-space' => true,
    'wrap-script-literals' => false,
    'tidy-mark' => true,
    'merge-divs' => false,
    'repeated-attributes' => 'keep-last',
    'break-before-br' => false
);

$tidy_config2 = array(
    'tidy-mark' => false,
    'vertical-space' => false,
    'hide-comments' => true,
    'indent-spaces' => 0,
    'tab-size' => 1,
    'wrap-attributes' => false,
    'numeric-entities' => true,
    'ascii-chars' => true,
    'hide-endtags' => true,
    'indent' => false
);
$tidy_config = array_merge($tidy_config, $tidy_config2);

$dtm = preg_match(self::doctypeMatch, $output, $dt);
$output = tidy_repair_string($output, $tidy_config, 'utf8');

// tidy screws up doctype --fixed
if($dtm)
    $output = preg_replace(self::doctypeMatch, $dt[0], $output);

$output = preg_replace('!>[\n\r]+<!', '><', $output);

unset($tidy_config);

return $output; 
```

请注意，它比这更复杂（因此有两个数组）。我刚刚切断了不必要的代码。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-31T18:36:40.747

## 免责声明：

我不认为我的回答很...整洁。将 HTMLTidy 与 HTML5 一起使用（目前不支持）更像是一种笨拙的方式。为了实现这一点，**我使用正则表达式来解析 HTML**，根据大多数人的说法，它是万恶之源或邪神之[道](http://www.codinghorror.com/blog/2009/11/parsing-html-the-cthulhu-way.html)。如果有人知道更好的方法，请赐教，因为我觉得使用正则表达式解析 html 不是很安全。我已经用很多例子对其进行了测试，但我很确定它不是防弹的。

## 介绍

菜单标签在 HTML4 和 XHTML1 中被弃用，被 ul（无序列表）取代。然而，它[在 HTML5 中被重新定义，因此是根据 HTML5 规范的有效标签。](http://dev.w3.org/html5/markup/menu.html#menu)由于 HTMLTidy 不支持 HTML5 并使用 XHTML 或 HTML 规范，正如 OP 所指出的那样，它会将当时已弃用的标签菜单替换为 ul （或添加 ul 标签），即使您明确告诉它不要这样做。

## 我的建议

此函数在用 tidy 解析之前将菜单标签替换为自定义标签。然后它再次用菜单替换自定义标签。

```
function tidyHTML5($buffer)
{
    $buffer = str_replace('<menu', '<mytag', $buffer);
    $buffer = str_replace('menu>', 'mytag>', $buffer);
    $tidy = new tidy();
    $options = array(
            'hide-comments'         => true,
            'tidy-mark'             => false,
            'indent'                => true,
            'indent-spaces'         => 4,
            'new-blocklevel-tags'   => 'menu,mytag,article,header,footer,section,nav',
            'new-inline-tags'       => 'video,audio,canvas,ruby,rt,rp',
            'doctype'               => '<!DOCTYPE HTML>',
            //'sort-attributes'     => 'alpha',
            'vertical-space'        => false,
            'output-xhtml'          => true,
            'wrap'                  => 180,
            'wrap-attributes'       => false,
            'break-before-br'       => false,
            'char-encoding'         => 'utf8',
            'input-encoding'        => 'utf8',
            'output-encoding'       => 'utf8'
    );

    $tidy->parseString($buffer, $options, 'utf8');
    $tidy->cleanRepair();

    $html = '<!DOCTYPE HTML>' . PHP_EOL . $tidy->html();
    $html = str_replace('<html lang="en" xmlns="http://www.w3.org/1999/xhtml">', '<html>', $html);
    $html = str_replace('<html xmlns="http://www.w3.org/1999/xhtml">', '<html>', $html);

    //Hackish stuff starts here
    //We use regex to parse html, which is usually a bad idea
    //But currently there is no alternative to it, since tidy is not MENU TAG friendly
    preg_match_all('/\<mytag(?:[^\>]*)\>\s*\<ul>/', $html, $matches);
    foreach($matches as $m) {
        $mo = $m;
        $m = str_replace('mytag', 'menu', $m);
        $m = str_replace('<ul>', '', $m);
        $html = str_replace($mo, $m, $html);
    }
    $html = str_replace('<mytag', '<menu', $html);
    $html = str_replace('</ul></mytag>', '</menu>', $html);
    $html = str_replace('mytag>', 'menu>', $html);
    return $html;
} 
```

**测试：**

```
header("Content-type: text/plain");
echo tidyHTML5('<menu><li>Lorem ipsum</li></menu><div></div><menu   ><a href="#">lala</a><form id="jj"><button>btn</button></form></menu><menu style="color: white" id="nhecos"><li>blabla</li><li>sdfsdfsdf</li></menu>'); 
```

**输出：**

```
<!DOCTYPE HTML>
<html>
    <head>
        <title></title>
    </head>
    <body>
        <menu>

            <li>Lorem ipsum
            </li>
        </menu><menu style="color: white" id="nhecos">

            <li>blabla
            </li>
            <li>sdfsdfsdf
            </li>
        </menu>
    </body>
</html> 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-05-16T15:47:12.663

根据[W3C tidy-html5 fork](https://github.com/w3c/tidy-html5/blob/master/src/tags.c)，新标签的正确配置应该是：

```
'new-blocklevel-tags' => 'article aside audio bdi canvas details dialog figcaption figure footer header hgroup main menu menuitem nav section source summary template track video',
'new-empty-tags' => 'command embed keygen source track wbr',
'new-inline-tags' => 'audio command datalist embed keygen mark menuitem meter output progress source time video wbr', 
```

您会注意到定义`new-blocklevel-tags`了一个奇怪的`temp`标签，它应该是*旧* `menu`标签的替代品，正如@tivie 在他的回答中提到的那样，您必须替换它。

此外，标签`audio`and`video`出现在`new-blocklevel-tags`and`new-inline-tags`中，这改变了 tidy 输出 HTML 的方式，如下所示：

```
<video src="movie.webm">
<track kind="subtitles" label="English" src="subtitles.vtt" srclang="en"></video> 
```

如果你`video`从`new-inline-tags`：

```
<video src="movie.webm">
  <track kind="subtitles" label="English" src="subtitles.vtt" srclang="en">
</video> 
```

收益率`video`下降`new-blocklevel-tags`：

```
<video src="movie.webm">
<track kind="subtitles" label="English" src="subtitles.vtt" srclang="en"></video> 
```

就个人而言，我更喜欢`audio`并且`video`表现得像块级标签，但这取决于你。

此外， the`tags.c`还定义`command`为 being`CM_HEAD`和`embed`as `CM_IMG`。不幸的是，我不知道这些代表什么，我认为不可能模仿它们。

另一件事：如果你不定义`new-empty-tags`，你会得到奇怪的输出：

```
<video src="movie.webm">
  <track kind="subtitles" label="English" src="subtitles.vtt" srclang="en">
  </track>
</video> 
```

* * *

## 附录

如果你也想支持[WHATWG 推荐](http://www.w3.org/TR/html5-diff/#new-elements)，你应该添加标签：

*   [`data`](http://www.whatwg.org/specs/web-apps/current-work/multipage/text-level-semantics.html#the-data-element)作为内联元素
*   [`dialog`](http://www.whatwg.org/specs/web-apps/current-work/multipage/commands.html#the-dialog-element)作为[块级](http://www.quackit.com/html_5/tags/html_dialog_tag.cfm)元素（？）

* * *

这是我的完整方法：

```
function Tidy5($string, $options = null, $encoding = 'utf8')
{
   if (extension_loaded('tidy') === true)
   {
      $default = array
      (
         'anchor-as-name' => false,
         'break-before-br' => true,
         'char-encoding' => $encoding,
         'decorate-inferred-ul' => false,
         'doctype' => 'omit',
         'drop-empty-paras' => false,
         'drop-font-tags' => true,
         'drop-proprietary-attributes' => false,
         'force-output' => false,
         'hide-comments' => false,
         'indent' => true,
         'indent-attributes' => false,
         'indent-spaces' => 2,
         'input-encoding' => $encoding,
         'join-styles' => false,
         'logical-emphasis' => false,
         'merge-divs' => false,
         'merge-spans' => false,
         'new-blocklevel-tags' => 'article aside audio bdi canvas details dialog figcaption figure footer header hgroup main menu menuitem nav section source summary template track video',
         'new-empty-tags' => 'command embed keygen source track wbr',
         'new-inline-tags' => 'audio command datalist embed keygen mark menuitem meter output progress source time video wbr',
         'newline' => 0,
         'numeric-entities' => false,
         'output-bom' => false,
         'output-encoding' => $encoding,
         'output-html' => true,
         'preserve-entities' => true,
         'quiet' => true,
         'quote-ampersand' => true,
         'quote-marks' => false,
         'repeated-attributes' => 1,
         'show-body-only' => true,
         'show-warnings' => false,
         'sort-attributes' => 1,
         'tab-size' => 4,
         'tidy-mark' => false,
         'vertical-space' => true,
         'wrap' => 0,
      );

      $doctype = $menu = null;

      if ((strncasecmp($string, '<!DOCTYPE', 9) === 0) || (strncasecmp($string, '<html', 5) === 0))
      {
         $doctype = '<!DOCTYPE html>'; $options['show-body-only'] = false;
      }

      $options = (is_array($options) === true) ? array_merge($default, $options) : $default;

      if (strpos($string, '<menu') !== false)
      {
         $menu = array
         (
            '<menu' => '<menutidy',
            '</menu' => '</menutidy',
         );
      }

      if (isset($menu) === true)
      {
         $string = str_replace(array_keys($menu), $menu, $string);
      }

      $string = tidy_repair_string($string, $options, $encoding);

      if (empty($string) !== true)
      {
         if (isset($menu) === true)
         {
            $string = str_replace($menu, array_keys($menu), $string);
         }

         if (isset($doctype) === true)
         {
            $string = $doctype . "\n" . $string;
         }

         return $string;
      }
   }

   return false;
} 
```

# oop - 如何在处理中单独控制以编程方式创建的对象的实例？

> ID：11746459
> 
> 赞同：1
> 
> 时间：2012-07-31T18:15:12.640
> 
> 标签：oop, object, processing

在处理中，我试图创建一个显示 x 数量形状的可视化。由于数量可能很大且不确定，我想以编程方式创建它们（使用循环）。这看起来像这样：

```
First firstDot1;
float offset;
float radius = 0;
float endRad = 100;
float speed = 0.1;
String[] lines,colors;

void setup(){
    size(800,600);
    smooth();
    background(255); 
    firstDot1 = new First(5);
}

void draw(){
    background(255);
    for(int z=0; z<36; z++){
        offset = z * 10;
        firstDot1.display();
        firstDot1.start(offset);
    }
}    

class First{
    float angle;
    int id;
    float eRad = 5;
    float xpos, ypos, rad, i;
    Boolean start = true;

    First(float tempAngle){
        angle = tempAngle;
    } 

    void display(){
        noStroke();
        fill(247,147,30); 
        ellipseMode(CENTER);
        ellipse(xpos, ypos, eRad, eRad);
    }

    void start(float offset){
        if(i<endRad){
            i = i+speed/2;
            xpos = width/2 + cos(radians(-angle+offset))*(radius+i);
            ypos = height/2 + sin(radians(-angle+offset))*(radius+i);
        }
        else{
            turn(offset);
        }
    }

    void turn(float offset){
        angle = angle-speed/50;
        xpos = width/2 + cos(radians(-angle+offset))*(endRad);
        ypos = height/2 + sin(radians(-angle+offset))*(endRad);  
    }
} 
```

这就像它应该通过显示 36 个椭圆一样工作。假设为了简单起见，我想通过单击来更改一个圆圈的颜色。

如何使用我当前的代码实现这一点？或者，我可以通过什么方式以编程方式创建这些对象（无需手动定义它们），以便我可以单独与它们交互？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-31T19:27:12.913

您将需要创建一个 First 对象数组：

```
First[] dots = new First[36];//declare and initialize an array of First object with size/length 36 
```

然后您将需要数组中的初始化对象：

```
for(int i = 0 ; i < dots.length; i++) dots[i] = new First(5); 
```

之后，您可以使用数组表示法（`[]`）按名称访问数组中的对象。请务必查看**示例 > 基础 > 数组 > ArrayObjects**。这正是您正在寻找的。

关于与对象的交互，您可以跟踪每个对象的鼠标位置和鼠标状态（无论它是否被按下）以基于此更新对象的状态。悬停的基本方法是检查鼠标到对象的距离是否小于对象的半径（这对您的对象很有效）。如果鼠标足够近并且被按下，那么您可以更新对象的状态以显示按下。

这里有一些代码可以尝试：

```
First[] dots;
float offset;
float radius = 0;
float endRad = 100;
float speed = 0.1;
String[] lines,colors;

void setup(){
    size(800,600);
    smooth();
    background(255); 
    dots = new First[36];
    for(int i = 0 ; i < dots.length; i++) dots[i] = new First(5);
}

void draw(){
    background(255);
    for(int z=0; z<36; z++){
        offset = z * 10;
        dots[z].update(mouseX,mouseY,mousePressed);
        dots[z].display();
        dots[z].start(offset);
    }
}    

class First{
    float angle;
    int id;
    float eRad = 5;
    float xpos, ypos, rad, i;
    Boolean start = true;

    color up = color(247,147,30);
    color over = color(0);
    color down = color(217,117,0);
    boolean isOver,isDown;

    First(float tempAngle){
        angle = tempAngle;
    } 
    void update(int mx,int my,boolean pressed){
      isOver = (dist(mx,my,xpos,ypos) < eRad);
      isDown = pressed;
    }

    void display(){
        noStroke();
        fill(up);//default
        if(isOver) fill(over);
        if(isOver && isDown) fill(down);
        ellipseMode(CENTER);
        ellipse(xpos, ypos, eRad, eRad);
    }

    void start(float offset){
        if(i<endRad){
            i = i+speed/2;
            xpos = width/2 + cos(radians(-angle+offset))*(radius+i);
            ypos = height/2 + sin(radians(-angle+offset))*(radius+i);
        }
        else{
            turn(offset);
        }
    }

    void turn(float offset){
        angle = angle-speed/50;
        xpos = width/2 + cos(radians(-angle+offset))*(endRad);
        ypos = height/2 + sin(radians(-angle+offset))*(endRad);  
    }
} 
```

另外，请查看**示例 > 主题 > GUI > 按钮**

# java - 避免更改传播

> ID：11746461
> 
> 赞同：1
> 
> 时间：2012-07-31T18:15:26.040
> 
> 标签：java, model-view-controller, design-patterns

首先抱歉我的英语不好 :D 最近由于软件工程考试，我正在更深入地学习设计模式，我必须设计一个软件系统作为这次考试的项目。

有一个我无法处理的问题：如何将实体类（代表我的应用程序域的数据）与……其他一切分离！

我的意思是，更具体地说，如果我有一个类 Patient（具有自己的私有属性和公共 getter 和 setter 方法），这是一个实体类，我认为到目前为止我做对了：D

所以假设我选择使用 MVC 模式架构来设计我的程序，Patient 类将在 Model 中，对吗？

现在，每个处理该类的视图都会引用它：假设我有三个视图：第一个视图查看所有患者，另一个用于修改患者，最后一个用于注册新患者（实际上还有其他课程我应该提交一些报告，但我认为现在这无关紧要）。

这些类中的每一个都将知道 Patient 的结构以显示其数据，例如，它们将调用其 getter 方法并以某种方式显示数据。

我认为没有办法避免这种情况，因为视图在语义上与它必须显示的数据（=模型）相关联：我的意思是它必须知道数据是字符串、日期还是整数，并且它还必须知道它的语义（它在现实世界中代表什么）；所以我认为仅仅删除对 Patient 类的引用没有多大意义。

现在问题的核心是：如何防止 Patient 类中的更改传播到使用它的所有类（不仅仅是视图）？

我的意思是：假设 String[] Cellular 中的属性 String Cellular 发生了变化，因为需求发生了变化。我将不得不修改：1）数据库/数据库接口 2）患者类 3）（最糟糕的是）每个使用患者的类！

如何避免这种情况？我认为在一个好的项目中，单个类的更改不应传播到使用该类的所有模块的更改链中，但我是初学者，我想不出一种方法来防止这种情况发生。

我什至想不出一种为实体类使用稳定接口的好方法，因为需求的变化会反映接口的变化（而且我不认为接口应该被改变！）。

请帮忙！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T18:30:15.273

想到的第一个评论是，您说您必须更改一堆使用该 Cellular 属性的类，就像这是一件坏事。

这实际上是强类型语言的特性之一。它确保类型在使用该属性的整个系统中保持一致。

例如，如果 Cellular 字段从 String 更改为 String[]，当然您的 DB 模型也应该调整以反映从 1-1 关系到 1-many 关系的变化，因此您的数据访问对象（或 ORM层配置）需要调整以反映变化。编译器不会让您侥幸逃脱，这是一件好事。

另一个评论是，只有使用 Cellular 字段的类才需要调整。但在这里，这是一件好事。因此，如果您有一个收集患者手机号码的用户界面，现在编译器会告诉您您应该真正允许用户收集多个号码。

在设计软件时，花大量时间使模型尽可能正确是至关重要的。并且知道需求会在一定程度上发生变化，不要害怕重构也至关重要。Eclipse、NetBeans 或 IntelliJ 等现代 IDE 可以代表您协助并完成大部分繁忙的重构工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T18:38:40.487

并非所有更改都可以隔离到模型或视图或持久层。但是在您的情况下，您可以使 Patient 模型具有通用的联系字段列表。该视图获取它们的列表并为用户填充一些可编辑的文本框。DatabaseMapper 通常也保留这些字段。

因此，除非 GUI 需要更大幅度地更改，否则可以纯粹在模型中添加 Cellular。除非你知道你需要，否则你不会开始一般地构建它，但你可以重构它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-31T18:40:27.703

对于您的实体类，我认为您应该将接口抽象留在最后，在您定义了所有业务实体并可以推断出它们之间的共同行为模式之后。只有这样你才能推断出它们之间的共同接口。但是您的实体类最终是具体的；试图进一步抽象它们是没有意义的。

最终，对这些具体类的更改将需要更改与它们交互的控制器/视图。不要为此烦恼。一旦您为每个实体定义了所有视图，您就可以开始制定抽象（如果有的话）。

如果您已经定义了具体实体，那么您可以开始抽象化视图。举个金融例子，假设我有一个贸易课程。显然我可以有特定类型的交易，比如 BondTrade、EquityTrade 等。所以我也可以有一个 TradeView，它可以有具体的视图，即 BondTradeView、EquityTradeView 等。你可以有更高层次的抽象，但最终，您将需要定义特定视图的具体类。

[以外观设计模式为例。](http://sourcemaking.com/design_patterns/facade)外观可用于根据您的具体实现创建视图。这是一种统一所有具体实体的方式。它将包含基于您的实体知道要创建什么视图以及如何创建视图的逻辑。这将是一种简化对实体进行的传播更改的方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-31T18:40:57.130

好的，下面的语句：

> 这些类中的每一个都将知道 Patient 的结构以显示其数据，例如，它们将调用其 getter 方法并以某种方式显示数据。

只是半真半假。您的视图不应该知道 a`Patient`是什么。它可能有一些称为`PatientView`它运行的模型的东西。因此，位于模型和视图之间的部分需要执行突变。基本上看起来像这样：

```
public PatientView convertPatient(Patient patient)  
{  
    return new PatientView(patient.foo(),patient.bar(),etc);  
} 
```

函数的契约保证一个`PatientView`对象被返回给调用者，随后这个类是封装它的类定义的接口的一部分。这也具有视图不知道 a`Patient`是什么的优点。

底层模型的任何变化，即驱动整个应用程序的东西，当然会导致某种类型的连锁反应。转换器的使用有助于最大限度地减少接触点，因为您的应用程序的任何部分都不应该真正知道 a`Patient`是什么，并且每个区域之间应该有一个连接器：视图、控制器等，将患者转换为该部分的预期内容应用程序。

# excel - Excel 单元格匹配 - 从工作表中复制其他数据

> ID：11746466
> 
> 赞同：0
> 
> 时间：2012-07-31T18:15:34.323
> 
> 标签：excel

基本上我有一个非常简单的工作表，但我正在努力解决它:(

基本上有几个标题，如“姓名”、“经理”、“信用”

我得到一张包含所有姓名等列表的工作表，并希望有一个宏来检查姓名是否在列表中，然后将信用单元从名为“代理”的工作表复制到名为“信用”的工作表已尝试加载的解决方案，但无济于事。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-01T16:11:00.557

在阅读 lori_m 的评论后查找 LOOKUP 与 VLOOKUP 时，我没有发现任何有关相对性能的信息。大多数情况下，我发现 LOOKUP 仍然在 Excel 中以实现旧版兼容性，而 VLOOKUP 或 HLOOKUP 更灵活。

但是，我确实遇到了从[http://exceluser.com/blog/420/excel%E2%80%99s-vlookup-vs-index-match-functions.html](http://exceluser.com/blog/420/excel%E2%80%99s-vlookup-vs-index-match-functions.html)开始的一系列文章，这些文章表明 INDEX 和 MATCH 函数提供更好的解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-01T00:48:28.037

以您共享的 Excel 文件作为参考，您可以使用以下内容*，前提是您的工作表上的第一列`Agent`按升序排序*。在`C2`工作表的单元格中`Credit`，输入

```
=LOOKUP($A2,Agent!$A:$A,Agent!$B:$B) 
```

然后选择该单元格`C2`并向下拖动右下角。`Credit`这是最简单的版本，但如果在 sheet上找不到来自 sheet 的名称，它会给出奇怪的结果`Agent`。更好的版本是

```
=IF($A2<>LOOKUP($A2,Agent!$A:$A,Agent!$A:$A),"Not Found",LOOKUP($A2,Agent!$A:$A,Agent!$B:$B)) 
```

if 的第一部分检查是否在 sheet 上找到代理名称`Agent`。如果没有，则结果为“未找到”，否则结果与上一个函数中的查找相同。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-31T18:32:08.650

您需要的关键函数是 VLOOKUP，它采用 Lookup_value（要搜索的名称，可以是单元格引用）、Table_array（要查找的范围 - 它在此范围的第一列中搜索 Lookup_value，返回第一个字母顺序match 或 Lookup_value 之后的第一个值，因此必须对列表进行排序，并将结果与​​ Lookup_value 进行比较以查看它们是否真的匹配）和 Col_index_number（第一列为 1 - 它从该列返回值）。

```
=IF(VLOOKUP(A2, Agent!$A:$B,1)=A2,VLOOKUP(A2, Agent!$A:$B,2),"No match") 
```

此示例将在 Agent 工作表的 A 列中查找当前工作表的 A1 中的值，并从 Agent 工作表的相应 B 列中返回值，如果没有则返回“不匹配”。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-31T18:21:59.097

你试过`Lookup`吗？此函数在单个行或列中找到一个值，并将在不同的行或列中对其进行一些匹配。

# objective-c - 检测鼠标下的颜色 (Mac)

> ID：11746471
> 
> 赞同：5
> 
> 时间：2012-07-31T18:16:02.897
> 
> 标签：objective-c, macos, colors, detect

我已经在网上搜索了几个小时，但没有找到任何东西。

我想知道如何获取鼠标指针当前所在像素的颜色。我编写了一个控制台应用程序，所以我没有要覆盖的窗口或其他东西。

更多细节：当我构建和运行程序（ cmd+r ）时，它应该给我一个控制台日志，显示我的鼠标指针当前所在的颜色。那可能吗？

谢谢您的回答！

问候，丹尼尔

PS：我来自德国，只是说（语言错误）

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-31T18:53:32.423

以此[问答](https://stackoverflow.com/questions/4395420/get-the-color-a-pixel-on-the-screen-in-objective-c-cocoa-app)为起点，这是一个功能齐全的命令行程序。您还需要链接到 Cocoa 框架。

```
#import <Foundation/Foundation.h>
#import <Cocoa/Cocoa.h>

int main(int argc, const char * argv[])
{
    @autoreleasepool {

        // Grab the current mouse location.
        NSPoint mouseLoc = [NSEvent mouseLocation];

        // Grab the display for said mouse location.
        uint32_t count = 0;
        CGDirectDisplayID displayForPoint;
        if (CGGetDisplaysWithPoint(NSPointToCGPoint(mouseLoc), 1, &displayForPoint, &count) != kCGErrorSuccess)
        {
            NSLog(@"Oops.");
            return 0;
        }

        // Grab the color on said display at said mouse location.
        CGImageRef image = CGDisplayCreateImageForRect(displayForPoint, CGRectMake(mouseLoc.x, mouseLoc.y, 1, 1));
        NSBitmapImageRep* bitmap = [[NSBitmapImageRep alloc] initWithCGImage:image];
        CGImageRelease(image);
        NSColor* color = [bitmap colorAtX:0 y:0];
        NSLog(@"%@", color);
        [bitmap release];
    }
    return 0;
} 
```

如果你想继续运行，你需要采取额外的措施来创建和驱动运行循环。

# twitter - 如何在桌面应用程序中使用 Spring Social Twitter？

> ID：11746477
> 
> 赞同：4
> 
> 时间：2012-07-31T18:16:55.263
> 
> 标签：twitter, spring-social, spring-social-twitter

我目前正在尝试使用 Spring Social Twitter，并且想知道如何将它用于桌面应用程序，因为您无法提供回调 url。

是否有可能使用用户名和密码进行授权或在没有回调 url 的情况下检索 OAuth 令牌？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T10:39:12.017

检索 OAuth 令牌的另一种方法是运行您自己的 Web 服务，该服务代表您的应用程序执行 OAuth 舞蹈。

如果您可以运行具有（公共和固定）回调 url 的 Web 服务，您可以告诉 twitter，那么您的桌面应用程序可以将新用户引导到该网站进行身份验证。oauth dance 完成后，您的桌面应用程序可以从您的 Web 服务下载 OAuth 令牌并从那时起使用它。

# excel - Excel 宏“运行时错误 '1004”

> ID：11746478
> 
> 赞同：1
> 
> 时间：2012-07-31T18:17:02.310
> 
> 标签：excel, vba

我是脚本新手，我正在尝试改进现有的宏。我录制了一个宏以删除重复项并将其添加到调用其他一些函数的 Main 函数中，但是当我添加我录制的宏时出现此错误：运行时错误“1004”：应用程序定义或对象定义错误.

代码看起来像

```
Sub Main()
Call DuplicateRemove
Call DeleteBlankRows
Call TrimText
End 

Sub DeleteBlankRows()
.
.
End Sub

Sub TrimText()
.
.
End Sub

Sub DuplicateRemove()
Columns("A:A").Select
ActiveSheet.Range("$A$1:$A$95678").RemoveDuplicates Columns:=1, Header:=xlNo
End Sub 
```

谢谢，基兰

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-31T21:41:12.040

您的代码没有任何问题。`Active`如果工作表受密码保护，您只会收到此错误。

`.Select`避免使用and也是一个更好的选择`ActiveSheet`。你的代码可以写成

```
Sub DuplicateRemove()
    Dim ws As Worksheet

    Set ws = Sheets("Sheet1")

    With ws
        If .ProtectContents = True Then
            MsgBox "Worksheet is protected"
            .Unprotect "MYPASSWORD"
            .Range("$A$1:$A$95678").RemoveDuplicates Columns:=1, Header:=xlNo
            .Protect "MYPASSWORD"
        Else
            .Range("$A$1:$A$95678").RemoveDuplicates Columns:=1, Header:=xlNo
        End If
    End With
End Sub 
```

**跟进**

```
Sub DuplicateTest()
    ActiveSheet.Columns(1).RemoveDuplicates Columns:=1, Header:=xlNo
End Sub 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-02-27T12:33:39.257

This error occur if The Microsoft Visual Basic Applications copies and pastes whole row in an Excel 2003 workbook or this error may be occur if the Microsoft copies and pastes a range of 2,516 rows or more rows in an Excel 2003 workbook at this cases [runtime error](http://www.runtimehelp.com) 1004 occurs. To get solution of this error save the workbook and manipulate the code of the macro in which you can save workbook.

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-07-31T18:30:08.007

ActiveSheet.Range("A1:C100").RemoveDuplicates Columns:=Array(1,2), Header:=xlYes

这是我找到的关于您的情况的信息，希望对您有所帮助。

# yql - 从 YQL 获取具有 ID 的类别的完整列表

> ID：11746484
> 
> 赞同：1
> 
> 时间：2012-07-31T18:17:16.600
> 
> 标签：yql

我正在使用 YQL 查询 Local.Search.. 带有 ID 的类别在哪里，我想获取这些类别及其 ID 的完整列表，这可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-09T20:39:50.983

雅虎没有发布带有相应 ID 号的类别列表，因此该列表在任何地方都无法使用（至少在公司之外）。

# java - Howto：在 JAR 文件中定位资源文件，无需预先知道名称和位置

> ID：11746486
> 
> 赞同：0
> 
> 时间：2012-07-31T18:17:29.413
> 
> 标签：java, jar, lookup, manifest.mf, meta-inf

一般问题：在没有固定位置的 JAR 文件中查找/定位资源文件 (document.xml)，甚至文件名也是未知的。

情况：两个 JavaSE 项目，都创建了自己的 JAR 文件。`Jar-A`在 jar 中的某处保存一个 xml 文档（位置未知）。`Jar-B`想要求`JarA`交出文件进行某项操作（例如设置信息）。调用者 `Jar-B`不知道资源/文件是如何被调用的，以及它的当前位置在哪里`Jar-A`。

要求：`Jar-B`应该依赖于资源/文件的固定位置， `Jar-A`因为资源可以在`Jar-A`. `Jar-B`应该询问`Jar-A`文件在哪里以及它正在寻找的文件是如何被调用的。

可能的解决方向：该`META-INF`目录始终包含一个`MANIFETS.MF`带有键/值对的文件。因此，如果我存储一个名为“ResourceLocator”的键和一个类似“org.my.package.ResourceLocator.class”的值，那么`Jar-B`可以找到它可以加载的类来实例化一个定位器对象，该对象可以给出正确的名称和位置它正在寻找的文件，对吗？

资源定位器可用于以这种方式查找更多值。

在 中拥有一个资源定位器对象`Jar-A`，只需要记录引用“事物”的键，但实际实现与外部世界是分离的。

我想知道这是否是处理这种查找的好方法？我已经知道了`Netbeans Lookup API`，但是需要一个类/接口名称来进行查找。这不是我现在正在寻找的。

在搜索未知的资源时如何确保`Jar-A`和保持解耦的任何想法？`Jar-B`

注意：这不是一些服务加载器或扩展机制，因为那将是相反的方式：`Jar-B`需要由`Jar-A`. 这不是这里的情况。`Jar-A`不知道有任何存在`Jar-B`。

希望有人已经遇到过这个“问题”。请分享您的想法...谢谢！

链接到 JAR 规范：[这里](http://docs.oracle.com/javase/7/docs/technotes/guides/jar/jar.html)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T18:22:47.637

JAR 是 ZIP。Java 有不错的原生支持——看起来足够稳固——可以打开 JAR-A 并浏览里面的文件（ZipFile.entries Enumeration。）

假设您可以在文件系统上找到 JAR-A，根据您的描述，我猜测 JAB-B 确切地知道 JAR-A 的位置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T18:54:07.423

Jar-A 在内部使用`getClass().getResource()`或访问资源文件`getClass().getResourceAsStream()`，以更合适的为准。

Jar-B 使用 Jar-A 公开定义的访问方法访问资源文件。换句话说，Jar-A 被添加到 Jar-B 的类路径中，并且 Jar-B 中的一个方法使用`public Resource getMethod()`;访问资源文件。

# php - PHP会话在关闭浏览器时销毁

> ID：11746491
> 
> 赞同：1
> 
> 时间：2012-07-31T18:17:48.350
> 
> 标签：php

> **可能重复：**
> [当用户关闭浏览器而不单击注销时销毁或取消设置会话](https://stackoverflow.com/questions/2839988/destroy-or-unset-session-when-user-close-the-browser-without-clicking-on-logout)

我正在为我的客户实现一个聊天脚本。我面临的问题是，如果用户注销，我可以编程将他的聊天状态结束为离线，因为用户登录时状态设置为 1，但我很困惑，如果用户关闭浏览器怎么办无需注销。在这种情况下，数据库中的状态保持为 1，因为用户尚未注销。

希望你明白这个问题。请帮忙。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T18:21:50.717

假设您正在使用基于 cookie 的会话，请非常积极地设置超时。

[http://www.php.net/manual/en/session.configuration.php#ini.session.cookie-lifetime](http://www.php.net/manual/en/session.configuration.php#ini.session.cookie-lifetime)

您还可以通过 JavaScript 连接到浏览器的卸载事件，并触发对您的服务器的快速 AJAX 请求，从而破坏会话。

[http://eureka.ykyuen.info/2011/02/22/jquery-javascript-capture-the-browser-or-tab-closed-event/](http://eureka.ykyuen.info/2011/02/22/jquery-javascript-capture-the-browser-or-tab-closed-event/)

不过，我不会依赖这个客户端实现——如果浏览器崩溃，或者用户强制关闭它，那可能不会触发事件。考虑到用户，浏览器本身也可能会限制`onunload`事件完成的时间。这两种方法的组合可能是最有效的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-31T18:23:45.583

当会话 cookie 过期或一段时间不活动后，在数据库中设置用户脱机。

您可以对每个请求进行检查。

# php - if 语句 php

> ID：11746492
> 
> 赞同：-4
> 
> 时间：2012-07-31T18:17:52.973
> 
> 标签：php

我的 if 语句有什么问题？

```
$sMasterDID = 85487;
    if($sMasterDID != "78681" OR $sMasterDID != "85487"){
      echo "if";
    }else{
      echo "else";
    } 
```

这应该回显：'else'。正确的？而且不是！

如果我这样做，则 if 语句有效：

```
$sMasterDID = 85487;
    if($sMasterDID != "85487"){
      echo "if";
    }else{
      echo "else";
    } 
```

我还尝试了从数字中删除引号的代码（不起作用）

```
 if($sMasterDID != 78681 OR $sMasterDID != 85487) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-31T18:20:40.207

您必须查看每个单独的语句的评估结果。

```
$sMasterDID = 85487;
$sMasterDID != "78681" //true
$sMasterDID != "85487" //false 
```

在语句中使用时，`if(true OR false)`计算结果为，`if(true)`因为`true OR false`是`true`，所以`echo "if";`被执行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-31T18:20:02.553

你用`OR`错了。`if ($x != '1' OR $x != '2')`将始终评估为`true`. 改为使用`AND`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-31T19:12:06.783

```
$sMasterDID = 85487;
if ($sMasterDID != "78681" OR $sMasterDID != "85487")
    {
    echo "if";
    }
else
    {
    echo "else";
    } 
```

让我们了解您的工作。您执行

第一个子句的方式：'$sMasterDID' 等于 true
第二个子句 '$sMasterDID' 等于 false

你必须这样想
如果第一个子句是真或假，做第一个，否则做第二个；但是当您检查 $sMasterDID 是否与 85487 不同时，它是错误的，因为之前是“$sMasterDID = 85487”。所以，它会做第二个陈述；但是当您放置第一个子句时，询问“$ sMasterDID”是否与 85487 不同，这是真的。

您在 IF 子句中有以下结果：

IF (TRUE) OR (FALSE) 总是结果为 TRUE，所以我们从不运行第二个子句。

明白了吗？

请参阅布尔代数以获得更好的理解。

> OR
> FALSE + FALSE = FALSE
> FALSE + TRUE = TRUE
> TRUE + FALSE = TRUE
> TRUE + TRUE = TRUE
> 
> 记住布尔代数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-31T18:21:05.103

or 运算符不是**排他的 or**。如果您的 if 中的值之一

`$sMasterDID != "78681"`

评估为真，整个语句评估为真。

# javascript - $.ajax + 使成功函数参数化

> ID：11746494
> 
> 赞同：-1
> 
> 时间：2012-07-31T18:17:54.850
> 
> 标签：javascript, jquery, html, ajax

一个愚蠢的问题。

我在我的许多按钮单击、文本更改、下拉值更改等中调用 $.ajax 函数。所以我想使这个函数参数化。下面是我试图使用的代码。

```
function ajaxCall(ajaxUrl, methodName) {
    try {
        $.ajax({
            type: 'POST',
            url: ajaxUrl,
            success: methodName
            },
            dataType: "html"
        });
    }
    catch (e) {
        alert(e.message);
    }
} 
```

在此“methodName”应该是控件应该使用的方法的名称。或者简而言之，当我使用 时`ajaxCall('test.aspx','testMethod')`，控制权应该转移到

```
function testMethod(xmlResponse){
   alert ('Inside testMethod');
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-31T18:24:42.957

*在 JavaScript 中，您可以将函数用作变量，因此只需`ajaxCall`使用 url 和成功处理程序进行调用。*

```
function testMethod (xmlResponse) {
   alert('Inside testMethod');
}

function ajaxCall (ajaxUrl, methodName) {
    try {
        $.ajax({
            url: ajaxUrl,
            type: 'POST',
            dataType: 'html',
            success: methodName
        });
    }
    catch (e) {
        alert(e.message);
    }
}

ajaxCall('test.aspx', testMethod); 
```

# mysql - mysql获取子字符串偏移量（indexOf）？

> ID：11746495
> 
> 赞同：6
> 
> 时间：2012-07-31T18:17:58.700
> 
> 标签：mysql, sql

有没有办法在mysql中获取子字符串的偏移量？

IE

“大家好，我是新手程序员” “大家” offset 6

我在 java/javascript 中寻找 indexOf 的等价物

谢谢！

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-07-31T18:19:43.003

不好意思，自己找的

```
INSTR(str, substr) 
```

# c# - 我需要有关如何在 C# 中绘制 GPS 路径的帮助和想法

> ID：11746497
> 
> 赞同：0
> 
> 时间：2012-07-31T18:18:01.160
> 
> 标签：c#, gps, tracking

正如你所看到的，我想做一个关于足球运动员使用 GPS 跟踪的高级项目，以显示球员正在使用或实时跟踪的路径

我已经学习了 c# 中的基本 gps 功能，但是在从 gps 获取数据后，我对如何在地图或图片上绘制路径有疑问。

硬件部分已经完成，但我陷入困境并想知道如何从 gps 获取数据以绘制玩家的路径

感谢您对我的任何帮助（抱歉英语不好）非常感谢

我设计的项目图片链接：

[http://image.ohozaa.com/view2/weK9gVKBzGZqRxKC](http://image.ohozaa.com/view2/weK9gVKBzGZqRxKC)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T18:24:59.890

想想你在做什么。

*   GPS 数据（来自每个玩家）作为一系列点（纬度/经度？）接收。
*   将这些点转换为您的足球场图像的 X/Y 坐标
*   使用图形 API（例如 GDI / System.Drawing ）在后续点之间绘制线条

如果您使用的是 C#，则可以通过使用 WinForms 以及子类`Control`化和直接绘制到控件的表面来节省时间和麻烦。您需要为每个玩家存储所有最近点的列表（因为您需要不断地重新绘制控件）。

请注意，.NET 中的地理定位功能在这里对您没有帮助，除非您的所有足球运动员都背着绑在背上的笔记本电脑。您需要将小型 GPS 跟踪器连接到每个播放器以及发送数据的小型无线电发射器。一种简单的方法是使用商品蓝牙 GPS 单元，但我不知道蓝牙是否可以在如此小的空间内支持这么多收发器，或者即使信号会从场地的一端到达另一端。最昂贵的方法是编写一个手机应用程序，让每个玩家携带一部智能手机，通过 3G 或 Wifi 连接发送地理定位数据。

请注意，GPS 装置的可用精度往往约为 5m（天气好的时候可能为 2.5m），在室内无用。然后考虑他们首先需要 5 分钟才能获得一个好的锁（手机具有快速的地理定位，因为它们需要手机桅杆的帮助）。足球场不是很大，即使精度为 2.5m，数据也不会很有用。

由于这个原因，在真正的运动中他们不使用 GPS。相反，他们使用更高精度的无线电单元和放置在球场周围的专业发射器/接收器单元。另一种方法是视觉跟踪，但这是一门不成熟的科学（如果两个或更多穿着相同球队颜色的球员相互崩溃，图灵会帮助你）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T19:07:33.123

看着您提供的图片，我想说这样的事情对于使用 Canvas 控件和 Line 类的 WPF 应用程序是可行的。您必须将 GPS 数据转换为原点位于足球场左上角的 (x,y) 坐标。然后您可以使用线段连接后续点。

# java - 如何解决“懒惰初始化角色集合失败”Hibernate异常

> ID：11746499
> 
> 赞同：430
> 
> 时间：2012-07-31T18:18:11.450
> 
> 标签：java, spring, hibernate, jsp, spring-mvc

我有这个问题：

> org.hibernate.LazyInitializationException：未能延迟初始化角色集合：mvc3.model.Topic.comments，没有会话或会话已关闭

这是模型：

```
@Entity
@Table(name = "T_TOPIC")
public class Topic {

    @Id
    @GeneratedValue(strategy=GenerationType.AUTO)
    private int id;

    @ManyToOne
    @JoinColumn(name="USER_ID")
    private User author;

    @Enumerated(EnumType.STRING)    
    private Tag topicTag;

    private String name;
    private String text;

    @OneToMany(mappedBy = "topic", cascade = CascadeType.ALL)
    private Collection<Comment> comments = new LinkedHashSet<Comment>();

    ...

    public Collection<Comment> getComments() {
           return comments;
    }

} 
```

调用模型的控制器如下所示：

```
@Controller
@RequestMapping(value = "/topic")
public class TopicController {

    @Autowired
    private TopicService service;

    private static final Logger logger = LoggerFactory.getLogger(TopicController.class);

    @RequestMapping(value = "/details/{topicId}", method = RequestMethod.GET)
    public ModelAndView details(@PathVariable(value="topicId") int id)
    {

            Topic topicById = service.findTopicByID(id);
            Collection<Comment> commentList = topicById.getComments();

            Hashtable modelData = new Hashtable();
            modelData.put("topic", topicById);
            modelData.put("commentList", commentList);

            return new ModelAndView("/topic/details", modelData);

     }

} 
```

jsp 页面如下所示：

```
<%@page import="com.epam.mvc3.helpers.Utils"%>
<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%>
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c" %>
<%@ page session="false" %>
<html>
<head>
      <title>View Topic</title>
</head>
<body>

<ul>
<c:forEach items="${commentList}" var="item">
<jsp:useBean id="item" type="mvc3.model.Comment"/>
<li>${item.getText()}</li>

</c:forEach>
</ul>
</body>
</html> 
```

查看 jsp 时出现异常。与*c:forEach*循环一致

* * *

## 回答 #1

> 赞同：236
> 
> 时间：2012-07-31T18:33:08.650

如果您知道`Comment`每次检索 a 时都希望看到所有 s ，`Topic`则将字段映射更改为`comments`：

```
@OneToMany(fetch = FetchType.EAGER, mappedBy = "topic", cascade = CascadeType.ALL)
private Collection<Comment> comments = new LinkedHashSet<Comment>(); 
```

默认情况下，集合是延迟加载的，如果您想了解更多信息，请查看[此内容。](https://stackoverflow.com/questions/2990799/difference-between-fetchtype-lazy-and-eager-in-java-persistence)

* * *

## 回答 #2

> 赞同：200
> 
> 时间：2012-08-01T07:26:07.177

根据我的经验，我有以下方法来解决著名的 LazyInitializationException：

**(1) 使用 Hibernate.initialize**

```
Hibernate.initialize(topics.getComments()); 
```

**(2) 使用 JOIN FETCH**

您可以在 JPQL 中使用 JOIN FETCH 语法来显式提取子集合。这有点像 EAGER fetching。

**(3) 使用 OpenSessionInViewFilter**

LazyInitializationException 经常发生在视图层。如果你使用 Spring 框架，你可以使用 OpenSessionInViewFilter。但是，我不建议您这样做。如果使用不当，可能会导致性能问题。

* * *

## 回答 #3

> 赞同：92
> 
> 时间：2016-06-06T13:58:39.003

我知道这是一个老问题，但我想帮忙。您可以将事务注释放在您需要的服务方法上，在这种情况下 findTopicByID(id) 应该有

```
@Transactional(propagation=Propagation.REQUIRED, readOnly=true, noRollbackFor=Exception.class) 
```

可以在[此处找到有关此注释的更多信息](https://stackoverflow.com/questions/10740021/transactionalpropagation-propagation-required)

关于其他解决方案：

```
fetch = FetchType.EAGER 
```

不是一个好的做法，它应该只在必要时使用。

```
Hibernate.initialize(topics.getComments()); 
```

hibernate 初始化程序将您的类绑定到休眠技术。如果您的目标是灵活，那不是一个好方法。

希望能帮助到你

* * *

## 回答 #4

> 赞同：68
> 
> 时间：2015-07-17T18:30:25.423

## 你的问题的根源：

默认情况下，hibernate 会延迟加载集合（关系），这意味着当您`collection`在代码`comments`中`Topic`使用已关闭）。这是导致异常的代码行（您正在加载`comments`集合的位置）：

```
 Collection<Comment> commentList = topicById.getComments(); 
```

您在控制器（`JPA session`已结束）中获得“评论”集合（topic.getComments（）），这会导致异常。此外，如果你`comments`在你的 jsp 文件中得到了这样的集合（而不是在你的控制器中得到它）：

```
<c:forEach items="topic.comments" var="item">
//some code
</c:forEach> 
```

出于同样的原因，你仍然会有同样的例外。

## 解决问题：

因为您只能`FetchType.Eager`在 Entity 类中拥有两个带有（急切获取的集合）的集合，并且因为延迟加载比急切加载更有效，所以我认为这种解决问题的方法比仅仅更改`FetchType`为急切更好：

如果您想初始化集合延迟并使其工作，最好将此代码片段添加到您的`web.xml`：

```
<filter>
    <filter-name>SpringOpenEntityManagerInViewFilter</filter-name>
    <filter-class>org.springframework.orm.jpa.support.OpenEntityManagerInViewFilter</filter-class>
</filter>
<filter-mapping>
    <filter-name>SpringOpenEntityManagerInViewFilter</filter-name>
    <url-pattern>/*</url-pattern>
</filter-mapping> 
```

这段代码的作用是它会增加您的长度，`JPA session`或者如文档所述，使用它是`"to allow for lazy loading in web views despite the original transactions already being completed."`为了让 JPA 会话打开的时间更长一些，因此您可以在 jsp 文件和控制器类中延迟加载集合.

* * *

## 回答 #5

> 赞同：37
> 
> 时间：2016-12-14T11:02:20.843

```
@Controller
@RequestMapping(value = "/topic")
@Transactional 
```

我通过添加解决了这个问题`@Transactional`，我认为这可以使会话打开

* * *

## 回答 #6

> 赞同：29
> 
> 时间：2014-12-04T05:59:03.730

原因是当你使用延迟加载时，会话是关闭的。

有两种解决方案。

1.  不要使用延迟加载。

    `lazy=false`在 XML 中设置或在`@OneToMany(fetch = FetchType.EAGER)`注释中设置。

2.  使用延迟加载。

    `lazy=true`在 XML 中设置或在`@OneToMany(fetch = FetchType.LAZY)`注释中设置。

    并添加`OpenSessionInViewFilter filter`您的`web.xml`

详情见我的[帖子](https://stackoverflow.com/a/27286187/1808417)。

* * *

## 回答 #7

> 赞同：29
> 
> 时间：2018-06-27T06:21:50.307

处理的最佳方法[`LazyInitializationException`](https://vladmihalcea.com/the-best-way-to-handle-the-lazyinitializationexception/)是在查询时获取它，如下所示：

```
select t
from Topic t
left join fetch t.comments 
```

您应该始终避免以下反模式：

*   `FetchType.EAGER`
*   [OSIV（在视图中打开会话）](https://stackoverflow.com/a/37526397/1025118)
*   [`hibernate.enable_lazy_load_no_trans`休眠配置属性](https://stackoverflow.com/a/39723223/1025118)

因此，请确保您的`FetchType.LAZY`关联在查询时或在使用辅助集合的原始`@Transactional`范围内初始化。`Hibernate.initialize`

* * *

## 回答 #8

> 赞同：28
> 
> 时间：2017-02-13T14:17:16.177

该问题是由在休眠会话关闭的情况下访问属性引起的。您在控制器中没有休眠事务。

可能的解决方案：

1.  **在服务层（使用@Transactional）中而不是在控制器中**执行所有这些逻辑。**应该有合适的地方来做这件事，它是应用程序逻辑的一部分，而不是在控制器中（在这种情况下，是加载模型的接口）。服务层中的所有操作都应该是事务性的。即：将此行移至 TopicService.findTopicByID 方法：**

     **集合commentList = topicById.getComments();** 
***   **使用 'eager' 而不是 'lazy'**。现在你没有使用'lazy' ..它不是一个真正的解决方案，如果你想使用lazy，就像一个临时（非常临时）的解决方法。

    *   **在 Controller 中使用 @Transactional**。它不应该在这里使用，您将服务层与表示混合在一起，这不是一个好的设计。*   **使用 OpenSessionInViewFilter**，报告了许多缺点，可能不稳定。**

 ****一般来说，最好的解决方案是1。**

* * *

## 回答 #9

> 赞同：20
> 
> 时间：2012-07-31T20:13:23.063

为了延迟加载集合，必须有一个活动会话。在 Web 应用程序中，有两种方法可以做到这一点。您可以使用[Open Session In View](https://community.jboss.org/wiki/OpenSessionInView?_sscc=t)模式，在该模式中，您使用[拦截器](http://static.springsource.org/spring/docs/2.5.x/api/org/springframework/orm/hibernate3/support/OpenSessionInViewInterceptor.html)在请求开始时打开会话并在结束时关闭它。存在的风险是您必须进行可靠的异常处理，否则您可能会绑定所有会话并且您的应用程序可能会挂起。

处理此问题的另一种方法是在控制器中收集您需要的所有数据，关闭会话，然后将数据填充到模型中。我个人更喜欢这种方法，因为它似乎更接近 MVC 模式的精神。此外，如果您以这种方式从数据库中收到错误，您可以比在视图渲染器中更好地处理它。在这种情况下，您的朋友是[Hibernate.initialize](http://docs.jboss.org/hibernate/orm/3.3/reference/en/html/performance.html#performance-fetching-initialization) (myTopic.getComments())。您还必须将对象重新附加到会话，因为您正在为每个请求创建一个新事务。使用 session.lock(myTopic,LockMode.NONE) 。

* * *

## 回答 #10

> 赞同：12
> 
> 时间：2018-08-01T23:24:38.770

最好的解决方案之一是在 application.properties 文件中添加以下内容： **spring.jpa.properties.hibernate.enable_lazy_load_no_trans=true**

* * *

## 回答 #11

> 赞同：11
> 
> 时间：2015-08-24T14:50:11.363

如果您尝试在实体和 Collection 或 Java 对象列表（例如 Long 类型）之间建立关系，它会像这样：

```
@ElementCollection(fetch = FetchType.EAGER)
    public List<Long> ids; 
```

* * *

## 回答 #12

> 赞同：9
> 
> 时间：2019-10-05T03:54:15.970

你应该有两件事`fetch = FetchType.LAZY`。

```
@Transactional 
```

和

```
Hibernate.initialize(topicById.getComments()); 
```

* * *

## 回答 #13

> 赞同：8
> 
> 时间：2020-04-02T09:24:57.640

这个延迟初始化问题有多种解决方案 -

1) 将关联 Fetch 类型从 LAZY 更改为 EAGER，但这不是一个好的做法，因为这会降低性能。

2）在关联对象上使用 FetchType.LAZY 并在服务层方法中使用事务注释，以便会话保持打开状态，当您调用 topicById.getComments() 时，将加载子对象（注释）。

3) 另外，请尝试在控制器层使用 DTO 对象而不是实体。在您的情况下，会话在控制器层关闭。所以最好在服务层将实体转换为 DTO。

* * *

## 回答 #14

> 赞同：7
> 
> 时间：2015-06-24T10:24:29.547

我发现声明`@PersistenceContext`为`EXTENDED`也解决了这个问题：

```
@PersistenceContext(type = PersistenceContextType.EXTENDED) 
```

* * *

## 回答 #15

> 赞同：6
> 
> 时间：2012-07-31T20:11:56.403

您的列表是延迟加载的，因此未加载列表。打电话上榜是不够的。在 Hibernate.initialize 中使用以初始化列表。如果在列表元素上运行 dosnt 工作并为每个 . 这需要在您从事务范围返回之前。看看[这个](http://www.javalobby.org/java/forums/t20533.html)帖子。
搜索 -

```
Node n = // .. get the node
Hibernate.initialize(n); // initializes 'parent' similar to getParent.
Hibernate.initialize(n.getChildren()); // pass the lazy collection into the session 
```

* * *

## 回答 #16

> 赞同：6
> 
> 时间：2016-02-05T16:02:59.977

为了解决我的问题，它只是缺少这一行

```
<tx:annotation-driven transaction-manager="myTxManager" /> 
```

在应用程序上下文文件中。

`@Transactional`未考虑方法上的注释。

希望答案会对某人有所帮助

* * *

## 回答 #17

> 赞同：5
> 
> 时间：2013-11-07T15:22:57.277

这是我最近遇到的问题，我通过使用解决了

```
<f:attribute name="collectionType" value="java.util.ArrayList" /> 
```

[这里](http://blog.itcrowd.pl/2013/02/jsf-manytomany-and-lazyinitializationex.html)有更详细的描述，这节省了我的时间。

* * *

## 回答 #18

> 赞同：5
> 
> 时间：2016-03-26T10:30:47.723

控制器上的@Transactional 注释丢失

```
@Controller
@RequestMapping("/")
@Transactional
public class UserController {
} 
```

* * *

## 回答 #19

> 赞同：4
> 
> 时间：2018-07-25T09:53:53.243

通过使用 hibernate`@Transactional`注释，如果您从数据库中获取具有延迟获取属性的对象，您可以通过获取这些属性来简单地获取这些属性，如下所示：

```
@Transactional
public void checkTicketSalePresence(UUID ticketUuid, UUID saleUuid) {
        Optional<Ticket> savedTicketOpt = ticketRepository.findById(ticketUuid);
        savedTicketOpt.ifPresent(ticket -> {
            Optional<Sale> saleOpt = ticket.getSales().stream().filter(sale -> sale.getUuid() == saleUuid).findFirst();
            assertThat(saleOpt).isPresent();
        });
} 
```

在这里，在 Hibernate 代理管理的事务中，调用`ticket.getSales()`执行另一个查询以获取销售的事实是因为您明确要求它。

* * *

## 回答 #20

> 赞同：4
> 
> 时间：2019-10-24T08:24:03.913

导致问题的原因是当关闭与数据库的“连接”时代码正在访问惰性 JPA 关系（*持久性上下文*是 Hibernate/JPA 的正确名称）。

在 Spring Boot 中解决它的一种简单方法是定义一个服务层并使用`@Transactional`注解。方法中的这个注释创建了一个事务，该事务传播到存储库层并保持打开持久性上下文直到方法完成。如果您访问事务方法中的集合，Hibernate/JPA 将从数据库中获取数据。

在您的情况下，您只需要使用您`@Transactional`的方法进行注释并强制在该方法中获取集合（例如，通过询问其大小）：`findTopicByID(id)``TopicService`

```
 @Transactional(readOnly = true)
    public Topic findTopicById(Long id) {
        Topic topic = TopicRepository.findById(id).orElse(null);
        topic.getComments().size();
        return topic;
    } 
```

* * *

## 回答 #21

> 赞同：4
> 
> 时间：2021-09-05T13:51:18.890

在第二次执行生成 JWT 令牌的方法后出现此错误。

行*user.getUsersRole().stream().forEachOrdered((ur) -> roles.add(ur.getRoleId()));* 产生了错误。

```
// MyUserDetails.java

@Service
public class MyUserDetails implements UserDetailsService {

  @Override
  public UserDetails loadUserByUsername(String email) {

    /* ERROR
    /* org.hibernate.LazyInitializationException: failed to 
    /* lazily initialize a collection of role: 
    /* com.organizator.backend.model.User.usersRole, 
    /* could not initialize proxy - no Session */
    user.getUsersRole().stream().forEachOrdered((ur) ->
           roles.add(ur.getRoleId())); 
```

就我而言，`@Transacctional`注释解决了它，

```
// MyUserDetails.java

import org.springframework.transaction.annotation.Transactional;

@Service
public class MyUserDetails implements UserDetailsService {

  @Override
  @Transactional // <-- added
  public UserDetails loadUserByUsername(String email) {

    /* No Error */
    user.getUsersRole().stream().forEachOrdered((ur) ->
           roles.add(ur.getRoleId())); 
```

* * *

## 回答 #22

> 赞同：2
> 
> 时间：2015-12-01T05:22:43.877

对于那些使用[Criteria](http://docs.jboss.org/hibernate/orm/3.5/javadocs/org/hibernate/Criteria.html)的人，我发现

```
criteria.setFetchMode("lazily_fetched_member", FetchMode.EAGER); 
```

做了我需要做的一切。

集合的初始获取模式设置为 FetchMode.LAZY 以提供性能，但是当我需要数据时，我只需添加该行并享受完全填充的对象。

* * *

## 回答 #23

> 赞同：2
> 
> 时间：2017-01-27T14:03:12.670

在我的情况下，以下代码是一个问题：

```
entityManager.detach(topicById);
topicById.getComments() // exception thrown 
```

因为它与数据库分离，并且 Hibernate 在需要时不再从字段中检索列表。所以我在分离之前初始化它：

```
Hibernate.initialize(topicById.getComments());
entityManager.detach(topicById);
topicById.getComments() // works like a charm 
```

* * *

## 回答 #24

> 赞同：2
> 
> 时间：2019-12-12T13:24:01.460

不是最好的解决方案，但对于那些`LazyInitializationException`特别面临`Serialization`这个问题的人会有所帮助。在这里，您将检查延迟初始化`null`的属性并对其进行设置。为此创建以下类

```
public class RepositoryUtil {
    public static final boolean isCollectionInitialized(Collection<?> collection) {
        if (collection instanceof PersistentCollection)
            return ((PersistentCollection) collection).wasInitialized();
        else 
            return true;
    }   
} 
```

在您具有延迟初始化属性的 Entity 类中，添加一个如下所示的方法。在此方法中添加所有延迟加载属性。

```
public void checkLazyIntialzation() {
    if (!RepositoryUtil.isCollectionInitialized(yourlazyproperty)) {
        yourlazyproperty= null;
    } 
```

`checkLazyIntialzation()`在您加载数据的所有位置之后 调用此方法。

```
 YourEntity obj= entityManager.find(YourEntity.class,1L);
  obj.checkLazyIntialzation(); 
```

* * *

## 回答 #25

> 赞同：2
> 
> 时间：2020-02-03T11:43:07.003

为了摆脱惰性初始化异常，您在操作分离对象时不应调用惰性收集。

在我看来，最好的方法是使用 DTO，而不是实体。在这种情况下，您可以明确设置要使用的字段。像往常一样就足够了。无需担心类似 jackson`ObjectMapper`或`hashCode`由 Lombok 生成的东西会隐式调用您的方法。

对于某些特定情况，您可以使用注释，即使您在实体中`@EntityGrpaph`也可以进行加载。`eager``fetchType=lazy`

* * *

## 回答 #26

> 赞同：2
> 
> 时间：2021-04-01T13:34:04.510

*这是一个老问题，但以下信息可能会帮助人们寻找答案。*

@VladMihalcea 的回答很有用。您不能依赖`FetchType.EAGER`，而是应该`Topic`在需要时将评论加载到实体中。

如果您没有明确定义查询以便您可以指定 a `join fetch`，那么使用`@NamedEntityGraph`并且您可以在**运行时**`@EntityGraph` **覆盖**`FetchType.LAZY`（`@OneToMany`默认情况下关联使用 LAZY） ，并在**需要**时同时加载注释。这意味着您将评论限制为仅加载真正需要的那些方法（查询）。[JPA定义](https://download.oracle.com/otn-pub/jcp/persistence-2_2-mrel-spec/JavaPersistence.pdf)的实体图：**`Topic`**

 ****> 实体图可以与 find 方法一起使用，也可以用作查询提示来覆盖或增加 FetchType 语义。

您可以根据[此处](https://www.baeldung.com/jpa-entity-graph)的 JPA 示例使用它。或者，如果您使用 Spring Data JPA，那么您可以根据[Spring 提供](https://docs.spring.io/spring-data/jpa/docs/current/reference/html/#jpa.entity-graph)的示例使用它。

* * *

## 回答 #27

> 赞同：1
> 
> 时间：2018-03-16T10:11:10.877

原因是您在关闭服务内的会话后试图在控制器上获取评论列表。

```
topicById.getComments(); 
```

只有当你的休眠会话处于活动状态时，上面才会加载评论列表，我猜你在服务中关闭了它。

**因此，您必须在关闭会话之前获取 commentList。**

* * *

## 回答 #28

> 赞同：1
> 
> 时间：2018-05-23T10:12:58.660

就我而言，我有黑白映射`A`和`B`喜欢

`A`拥有

```
@OneToMany(mappedBy = "a", cascade = CascadeType.ALL)
Set<B> bs; 
```

在`DAO`图层中，如果您没有使用**Fetch Type - Eager**注释映射，则需要对**方法进行注释**`@Transactional`

 *** * *

## 回答 #29

> 赞同：1
> 
> 时间：2018-07-20T10:32:18.337

`comments`模型类中的集合`Topic`是延迟加载的，如果您没有`fetch = FetchType.EAGER`专门注释它，这是默认行为。

您的`findTopicByID`服务很可能正在使用无状态的 Hibernate 会话。[无状态会话](https://docs.jboss.org/hibernate/orm/5.2/javadocs/org/hibernate/StatelessSession.html)没有一级缓存，即没有持久性上下文。稍后当您尝试迭代时`comments`，Hibernate 将抛出异常。

```
org.hibernate.LazyInitializationException: failed to lazily initialize a collection of role: mvc3.model.Topic.comments, no session or session was closed 
```

解决方案可以是：

1.  注释`comments`_`fetch = FetchType.EAGER`

    ```
    @OneToMany(fetch = FetchType.EAGER, mappedBy = "topic", cascade = CascadeType.ALL)   
    private Collection<Comment> comments = new LinkedHashSet<Comment>(); 
    ```

2.  如果您仍然希望延迟加载评论，请使用[Hibernate 的有状态会话](https://docs.jboss.org/hibernate/orm/5.2/javadocs/org/hibernate/Session.html)，以便您稍后能够按需获取评论。

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2018-07-25T06:41:48.883

嗨，所有的帖子都迟到了，希望对其他人有所帮助，提前感谢 @GMK 的这篇帖子 [Hibernate.initialize(object)](http://docs.jboss.org/hibernate/orm/3.3/reference/en/html/performance.html#performance-fetching-initialization)

当懒惰=“真”

```
Set<myObject> set=null;
hibernateSession.open
set=hibernateSession.getMyObjects();
hibernateSession.close(); 
```

现在，如果我在关闭会话后访问“设置”，它会引发异常。

我的解决方案：

```
Set<myObject> set=new HashSet<myObject>();
hibernateSession.open
set.addAll(hibernateSession.getMyObjects());
hibernateSession.close(); 
```

现在即使在关闭 Hibernate 会话后我也可以访问“设置”。

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2018-09-01T17:43:50.880

另一种方法是，您可以使用[TransactionTemplate](https://docs.spring.io/spring/docs/3.0.0.M3/reference/html/ch11s06.html)来包装惰性获取。像

```
Collection<Comment> commentList = this.transactionTemplate.execute
(status -> topicById.getComments()); 
```

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2021-12-27T17:43:30.430

在我的 Spring-Boot 项目`spring.jpa.open-in-view`中，application.properties 中设置为 false。将其设置为 true 解决了问题。********

# mysql - mysql 语法连接两个字段

> ID：11746502
> 
> 赞同：0
> 
> 时间：2012-07-31T18:18:21.340
> 
> 标签：mysql, join

我想将一个表连接到另一个表，其中第一个表中的两个字段中的任何一个都是第二个表的键。

如果我在第一个表中的任何一个字段上得到匹配，第二个表只是有一些我想提取的附加信息。

表网络

```
id | inviter | invitee | status 
```

表用户信息

```
id | userid | name 
```

查询是否没有访问第二个表

```
"SELECT * from network where inviter= '22' OR invitee ='22'" 
```

我认为它类似于以下内容，但无法弄清楚语法：

```
"SELECT n.*,u.* from `network`, n
left join `users`, u on
n.inviter = u.id OR n.invitee= u.id
WHERE n.inviter = '22' or n.invitee= '22'" 
```

非常感谢您的任何建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T18:22:33.090

您的语法几乎是正确的，只是您不希望在表与其别名之间使用逗号`a`或`u`（可选地使用`AS`关键字），并且您需要第二次加入，`userinfo`因为您需要邀请者和被邀请者的不同数据：

```
SELECT
  /* Use column aliases to distinguish inviter/invitee details */
  n.id AS n_id,
  n.status,
  inviter.userid AS inviter_userid,
  inviter.name AS inviter_name,
  invitee.userid AS invitee_userid,
  invitee.name AS invitee_name
FROM
  network AS n
  /* JOIN against `userinfo` twice: once to get inviter, once for invitee */
  /* aliased as inviter/invitee */
  LEFT JOIN userinfo AS inviter ON n.inviter = inviter.userid
  LEFT JOIN userinfo AS invitee ON n.invitee = invitee.userid
WHERE 
  n.inviter = 22
  OR n.invitee = 22 
```

### 更新：

要仅返回匹配的其中一个或另一个，您可以使用语句对其进行修改，以确定它们中的哪一个与子句`CASE`中的值相同：`WHERE`

```
SELECT
  /* Use column aliases to distinguish inviter/invitee details */
  n.id AS n_id,
  n.status,
  /* Return only one name, whichever matches the same value as in WHERE */
  CASE 
    WHEN inviter.userid = 22 THEN inviter.name
    WHEN invitee.userid = 22 THEN invitee.name
  END AS name
FROM
  network AS n
  /* JOIN against `userinfo` twice: once to get inviter, once for invitee */
  /* aliased as inviter/invitee */
  LEFT JOIN userinfo AS inviter ON n.inviter = inviter.userid
  LEFT JOIN userinfo AS invitee ON n.invitee = invitee.userid
WHERE 
  n.inviter = 22
  OR n.invitee = 22 
```

### 更新 2：

好吧，仔细想想，如果你只需要你已经知道的 id 的名称（22），就不需要 2 个连接。您仍然需要`CASE`在子查询中使用，但它只需要返回 id。

```
SELECT
  n.*,
  u.*
FROM (
  SELECT
    id AS n_id,
    status,
    CASE 
      WHEN inviter = 22 THEN inviter 
      WHEN invitee = 22 THEN invitee 
    END AS i_id
  FROM network
  WHERE inviter = 22 OR invitee = 22
) n JOIN userinfo u ON n.i_id = userinfo.userid 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T18:20:13.567

尝试这个：

```
SELECT a.inviter, a.invitee, a.status,b.userid, b.name FROM network a INNER JOIN userinfo b ON a.id = '22' AND b.id = '22'; 
```

要使用多个键进行连接，请尝试以下操作：

```
SELECT SELECT a.inviter, a.invitee, a.status,b.userid, b.name FROM network a INNER JOIN userinfo b ON a.invitee = '22' AND b.userid = '22' OR a.inviter = '22' AND b.userid ='22'; 
```

# bit-manipulation - 如何在 Dart 中进行按位无符号（零填充）右移？

> ID：11746504
> 
> 赞同：8
> 
> 时间：2012-07-31T18:18:23.093
> 
> 标签：bit-manipulation, dart

如何在 Dart 中执行按位无符号右移/零填充右移？

例如这样的事情：

```
foo >>> 2 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-31T20:57:43.957

零填充右移需要特定的整数大小。由于 Dart 中的整数具有任意精度，因此 '>>> 运算符在那里没有意义。

模拟零填充右移的最简单方法是先位和数字。

例子：

```
(foo & 0xFFFF) >> 2 // 16 bit zero-fill shift
(foo & 0xFFFFFFFF) >> 2 // 32 bit shift. 
```

### 2021 年更新：

Dart 整数现在是 64 位的。从 Dart 2.14 开始，`>>>`运算符移动 64 位整数并用 0 填充最高有效位。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2021-08-01T15:59:27.583

从Dart 2.14 开始，现在添加了[三重移位运算符](https://github.com/dart-lang/language/issues/120)，即整数的按位无符号右移。

### `>>>`Dart 中的三重移位运算符

你可以[从 Dart 版本 2.14 开始](https://github.com/dart-lang/language/issues/478#issuecomment-889181121)简单地使用它：

```
var foo = 42;
foo >>> 2; 
```

为了默认为您的应用启用此功能，您必须在以下位置升级您的 SDK 约束`pubspec.yaml`：

```
environment:
  sdk: '>=2.14.0-0 <3.0.0' 
```

* * *

[在文档中了解有关运算符的更多信息](https://api.flutter.dev/flutter/dart-core/int/%3E%3E%3E.html)。

### 飞镖前 2.14

如果你还没有升级到 Dart 2.14，你可以简单地使用这个函数：

```
/// Bitwise unsigned right shift of [x] by [s] bits.
///
/// This function works as `>>>` does starting with Dart 2.14.
int urs(int x, int s) => s <= 0 ? x : (x >> s) & (0x7fffffffffffffff >> (s - 1)); 
```

这是有效的，因为现在 Dart 中的整数总是 64 位的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-03T15:49:22.070

您可以定义一个实用函数来使用：

```
int zeroFillRightShift(int n, int amount) {
  return (n & 0xffffffff) >> amount;
} 
```

假设你有 32 位无符号整数，如果你有也可以。

# node.js - 如何在节点之外使用节点模块？

> ID：11746507
> 
> 赞同：0
> 
> 时间：2012-07-31T18:18:33.137
> 
> 标签：node.js, command-line, npm

我通过 npm 安装了 sass 节点模块，并想用它来编译一些不在节点环境中的 scss 样式表。

理想情况下，我希望能够像 coffeescript 编译器一样使用它

sass -cw somestylesheet.scss

但是任何让我接近那里的东西都会做。

我没有看到任何命令行实用程序。是否有某种标准方法可以用节点做这种事情？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T20:26:24.347

我确定您已经在编写一个小 sass 编译器脚本，但这里有更多背景信息：

要使用 npm 在 node 中全局安装模块，npm 会读取 in 中的`"bin"`哈希`package.json`，以查找映射到其相应脚本的多个全局名称。

这是我从 express 中获取的示例：

```
{
  "name" : "express"
  ...
  "bin": { "express": "./bin/express" },
  ...
} 
```

这告诉 npm 使 express 脚本全局可用，当您安装包时`npm install -g <package-name>`

我检查了[https://github.com/andrew/node-sass/blob/master/package.json](https://github.com/andrew/node-sass/blob/master/package.json)并且它的 package.json 中没有`"bin"`散列，所以你必须自己写一个。

正如@peter-lyons 所说，你启动一个可执行的节点脚本

```
#!/usr/bin/env node

your code 
```

根据您使用的操作系统，您可能还必须使用`chmod +x yourScript`. 然后你应该能够从任何控制台执行你的脚本，如果你把它放在全局路径上，或者如果你把它称为`./yourScript`.

# java - log4j 日志文件未更新

> ID：11746511
> 
> 赞同：0
> 
> 时间：2012-07-31T18:18:55.320
> 
> 标签：java, log4j

我正在使用 apache 的 log4j 在我的应用程序中记录错误。当我启动tomcat服务器时，日志信息信息按预期写入日志文件（当我停止tomcat服务器时，日志信息也写入日志文件）。但是当我开始使用应用程序时，我希望通过应用程序写入的日志信息没有写入日志文件。例如，我给出的输入会给出异常，但 log.error(e,e) 没有写入日志文件。

这就是我使用 Logger 的方式
`static Logger log = Logger.getLogger(MyClass.class);`

`log.info("my message" );`
`log.error(e,e);`

请帮忙

编辑：添加 log4j.properties 文件内容

`log4j.rootLogger =INFO, FILE, stdout log4j.appender.FILE=org.apache.log4j.RollingFileAppender log4j.appender.FILE.File=${catalina.home}/logs/myapp.log log4j.appender.FILE.layout=org.apache.log4j.PatternLayout log4j.appender.FILE.layout.ConversionPattern=%d{ABSOLUTE} %5p\t\t%c{1} :%L - %m%n`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T18:33:21.843

看来你还没有配置你的记录器。请查找`log4j.xml`或`logging.properties`通常位于`TOMCAT_HOME/conf`. 编辑它们以包含您的应用程序的包。

这将帮助您将应用程序级别的日志消息写入服务器（tomcat）的日志文件。

更好的方法是管理您自己的日志记录配置和文件。创建`log4j.xml`文件并将其`WEB-INF/classes`放入您的应用程序中。您可以找到很多示例和教程来帮助您编写`log4j.xml`. 例如这个： http: [//logging.apache.org/log4j/1.2/manual.html](http://logging.apache.org/log4j/1.2/manual.html)

# android - 如何在 Android 设备上查找 AIR 应用程序可用的实际区域？

> ID：11746516
> 
> 赞同：3
> 
> 时间：2012-07-31T18:19:24.493
> 
> 标签：android, actionscript-3, air

有没有办法确定 Android 设备上的 AIR 应用程序可用的实际区域？

例如，在 Kindle Fire **Capabilities.screenResolutionY**上返回 600，而实际上是 580 左右，因为有工具栏。是否有可能以编程方式达到这个值？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T23:26:02.770

使用 stage.stageHeight [http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/display/Stage.html#stageHeight](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/display/Stage.html#stageHeight)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T19:02:06.767

这个问题是相对的。从硬件方面来看，有 600 个像素可用，因此应该可以预期结果。如果您正在为 Kindle Fire 编程，您难道不能只预测 20 像素的工具栏并在需要时从结果中减去 20 吗？这是基于您的项目特定于 Kindle Fire 的假设。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-01T03:11:24.857

我觉得这个问题有点局限。AIR 代码可以（大部分）独立于平台，我建议在编程中允许该方面。考虑到这一点，这与我想出的通用尺寸解决方案一样接近。

```
static public const DEVICE_UNK:int = 0;
static public const DEVICE_WINDOWS:int = 1;
static public const DEVICE_APPLE_IPAD:int = 2;
static public const DEVICE_ANDROID:int = 3;

public var deviceType:Number;
public var _fullWidth:Number;
public var _fullHeight:Number;

deviceType = -1;
if (Capabilities.manufacturer.toLowerCase().indexOf("windows") != -1)
{
    deviceType = DEVICE_WINDOWS;
}
else if (Capabilities.manufacturer.toLowerCase().indexOf("android") != -1)
{
    deviceType = DEVICE_ANDROID;
}
else if (Capabilities.manufacturer.toLowerCase().indexOf("ios") != -1)
{
    deviceType = DEVICE_APPLE_IPAD;
}
else
{
    deviceType = DEVICE_UNK;
} 
```

然后用于`deviceType`在初始化、调整大小或其他任何过程中确定尺寸：

```
switch (deviceType)
{
    case DEVICE_UNK: 
    case DEVICE_WINDOWS: 
        _fullWidth = stage.stageWidth;
        _fullHeight = stage.stageHeight;
        break;
    case DEVICE_ANDROID: 
    case DEVICE_APPLE_IPAD: 
        _fullWidth = Math.max(stage.fullScreenWidth, stage.fullScreenHeight);
        _fullHeight = Math.min(stage.fullScreenWidth, stage.fullScreenHeight);
        break;
    default: 
        trace("Error: invalid deviceType.");
        break;
} 
```

`_fullWidth`然后`_fullHeight`是任何平台上可用空间的当前最大尺寸。

我很想对代码进行任何改进。请不要进行代码优化；我正在寻找更好的方法来确定尺寸。如果您更了解，请发表评论。

# c# - 使用 ??? 拥有 X 线程的简单方法 任务？

> ID：11746523
> 
> 赞同：0
> 
> 时间：2012-07-31T18:19:42.563
> 
> 标签：c#, multithreading

我有一个应用程序承担未知数量的任务。该任务正在阻塞（他们在网络上等待）我需要多个线程来保持忙碌。

有没有一种简单的方法可以让我拥有一个庞大的任务和工作线程列表，当它们空闲时它们会拉出任务？ATM 我只是为每个任务启动一个新线程，这很好，但我想要一些控制，所以如果有 100 个任务，我就没有 100 个线程。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T18:27:46.907

假设您正在处理的网络 I/O 类公开 Begin/End 样式的异步方法，那么您想要做的是使用 TPL [TaskFactory.FromAsync](http://msdn.microsoft.com/en-us/library/dd321311.aspx)方法。正如[TPL TaskFactory.FromAsync vs Tasks with blocking methods](https://stackoverflow.com/questions/5018897/tpl-taskfactory-fromasync-vs-tasks-with-blocking-methods)中所述，FromAsync 方法将在幕后使用异步 I/O，而不是让线程忙于等待 I/O 完成（这实际上不是您想要的）。

异步 I/O 的工作方式是您有一个线程池，可以在结果准备好时处理I/O 的*结果*，因此如果您有 100 个未完成的 I/O，则不会有 100 个线程阻塞等待对于那些 I/O。当整个池都忙于处理 I/O 结果时，后续结果会自动排队，直到有线程空闲来处理它们。像这样保持大量线程等待是可伸缩性灾难 - 线程是非常昂贵的对象，需要保持空闲状态。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T18:26:06.207

这是一个通过线程池管理多个线程的 msdn 示例：

```
using System; 
```

使用 System.Threading；

公共类斐波那契{公共斐波那契（int n，ManualResetEvent doneEvent）{_n = n; _doneEvent = 完成事件；}

```
// Wrapper method for use with thread pool.
public void ThreadPoolCallback(Object threadContext)
{
    int threadIndex = (int)threadContext;
    Console.WriteLine("thread {0} started...", threadIndex);
    _fibOfN = Calculate(_n);
    Console.WriteLine("thread {0} result calculated...", threadIndex);
    _doneEvent.Set();
}

// Recursive method that calculates the Nth Fibonacci number.
public int Calculate(int n)
{
    if (n <= 1)
    {
        return n;
    }

    return Calculate(n - 1) + Calculate(n - 2);
}

public int N { get { return _n; } }
private int _n;

public int FibOfN { get { return _fibOfN; } }
private int _fibOfN;

private ManualResetEvent _doneEvent; 
```

}

公共类 ThreadPoolExample { static void Main() { const int FibonacciCalculations = 10;

```
 // One event is used for each Fibonacci object
    ManualResetEvent[] doneEvents = new ManualResetEvent[FibonacciCalculations];
    Fibonacci[] fibArray = new Fibonacci[FibonacciCalculations];
    Random r = new Random();

    // Configure and launch threads using ThreadPool:
    Console.WriteLine("launching {0} tasks...", FibonacciCalculations);
    for (int i = 0; i < FibonacciCalculations; i++)
    {
        doneEvents[i] = new ManualResetEvent(false);
        Fibonacci f = new Fibonacci(r.Next(20,40), doneEvents[i]);
        fibArray[i] = f;
        ThreadPool.QueueUserWorkItem(f.ThreadPoolCallback, i);
    }

    // Wait for all threads in pool to calculation...
    WaitHandle.WaitAll(doneEvents);
    Console.WriteLine("All calculations are complete.");

    // Display the results...
    for (int i= 0; i<FibonacciCalculations; i++)
    {
        Fibonacci f = fibArray[i];
        Console.WriteLine("Fibonacci({0}) = {1}", f.N, f.FibOfN);
    }
} 
```

}

# c# - 网站授权行为异常

> ID：11746526
> 
> 赞同：2
> 
> 时间：2012-07-31T18:20:00.747
> 
> 标签：c#, asp.net, web-config, authorization

我`forms`在 asp.net4 中使用身份验证。但是授权的行为非常不寻常。
以下是我的 web.config 片段-

```
<authentication mode="Forms">
  <forms loginUrl="Login.aspx" timeout="2880" protection="All" path="/" />
</authentication>
<authorization>
  <deny users="?"/>
  <allow users="*"/>
</authorization> 
```

当我尝试打开任何网页时，我会`Login`按预期重定向到页面。如果关闭我的浏览器，我应该注销，但这并没有发生，尽管我设置`persistentCookie=false`如下
`FormsAuthentication.RedirectFromLoginPage(username, false);`
现在关闭浏览器后，如果再次登录，我被认为是经过身份验证的用户，但如果我`cookie cache`在浏览器中清除，则不会被视为经过身份验证的用户。

我没有在任何地方设置 cookie，我不想要持久性 cookie，而不是为什么会发生这种情况。
如果我遗漏了什么，请告诉我。

**没有人知道与此相关的事情** 我刚刚发现此问题仅出现在 Chrome 21.0 上，而与 Firefox 7.0 或 Opera 11.4 无关（即使会话结束也存在身份验证问题）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T21:00:15.093

当您使用`authentication mode="Forms"`默认存储在 cookie 中的身份验证凭据时。如果您想更改此行为，您可以使用`cookieless="UseUri"`属性，而不是您的凭据将存储在 URL 中。您可以找到更多信息[表单元素进行身份验证](http://msdn.microsoft.com/ru-ru/library/1d3t3c61.aspx)。

**timeout**属性指定 cookie 将被存储多长时间（以分钟为单位），默认为 30。

# ruby-on-rails - 在heroku上运行的生产应用程序的Rails奇怪行为

> ID：11746530
> 
> 赞同：1
> 
> 时间：2012-07-31T18:20:15.743
> 
> 标签：ruby-on-rails, api, heroku

在用户模型中，我有类型点的属性位置。现在我有一个验证码：

```
validates :location, :format => { :with => /\(-?\d+(?:\.\d+)?,-?\d(?:\.\d+)?\)/,
                                    :on => :update,
                                    :if => :location_changed? } 
```

它在本地主机上的控制台中运行良好，但在 heroku 上它返回：

> 由 UsersController#update 处理为*/* 2012-07-31T18:14:37+00:00 app[web.1]: 参数: {"user"=>{"location"=>"(3.545452,2.4353534)"}, “id”=>“self”} 2012-07-31T18:14:37+00:00 app[web.1]: Completed 500 Internal Server Error in 13ms 2012-07-31T18:14:37+00:00 app [web.1]: 2012-07-31T18:14:37+00:00 app[web.1]: NoMethodError (未定义的方法 更新'`location_changed?' for #<User:0x00000004dc29c8>): 2012-07-31T18:14:37+00:00 app[web.1]:
> app/controllers/users_controller.rb:16:in`

实际上它在 heroku 控制台中也很好用，但在 curl 请求中不起作用。

导轨版本 3.2.7。

```
attr_accessible :profile_picture, :password, :location 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T21:17:43.073

它看起来像一个魔术。如果表和服务器重新启动，我会通过娱乐修复它。很奇怪。

# php - 添加到 sqlite3 中的数组并使用 json 传递给 jquery ajax

> ID：11746543
> 
> 赞同：0
> 
> 时间：2012-07-31T18:20:54.397
> 
> 标签：php, jquery, ajax, json, multidimensional-array

我尝试从数据库中填写下拉列表。我查询并将结果添加到数组中。然后我使用 json_encode 将我的数据发送到一个 php 文件。

```
$query="SELECT project FROM main";
$results = $db->query($query);
while ($row_id = $results->fetchArray()) {
       $proj_option[] = "<option value=\"".$row_id['project']."\">".$row_id['project']."</option>\n";
       $pselected=$row_id['project'];
}
$output = array( "proj" => $proj_option);
echo json_encode($output); 
```

在我的 php 文件中，我使用 jquery ajax 来填充下拉列表。

```
$("#turninId").change(function() {

    var user_id = $("#turninId").val();

    $.ajax ( {
      url:"send_input.php",
      type: "POST",
      dataType: "json",
      data:{id_selection: user_id},
      success:function(response) {

        for (var i=0; i<response.proj.length; i++) {
          $("#exp").html(response.proj[i]);
          $("#project").html(response.proj[i]); } });

 }); 
```

这很棒，但我下拉列表中的唯一项目是数据库中的最后一项。例如，我的数据库在 Project 下有以下内容：

```
Project: up, down, low, right 
```

但是我的下拉列表只填充了最后一个条目，“对”。为什么是这样？我该如何解决？

[while 循环](https://stackoverflow.com/questions/6963243/php-json-encode-in-while-loop)中的 PHP json_encode() 类似，我进行了更改，但这里缺少一些东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T18:29:52.283

可以试试这个

```
success:function(response) {

  $.each(response.proj,function(key,value){
      $("#exp").append(value);
      $("#project").append(value);
  });

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T18:27:52.013

每次通过 javascript 循环时，您都会覆盖您的 html。.html() 方法设置标签的innerHTML 属性，因此每次调用它时都会重置html，并且只会显示最后一个。尝试不使用循环，而是将您的响应连接在一起，然后调用 .html()

```
$("#exp").html(response.proj.join(''));
$("#project").html(response.proj.join('')); 
```

# javascript - Javascript 弹出 Google Chrome 扩展

> ID：11746544
> 
> 赞同：-1
> 
> 时间：2012-07-31T18:20:55.430
> 
> 标签：javascript, google-chrome, google-chrome-extension, popup

我可以和一些参考资料，制作一个基本上是 javascript 弹出窗口的 google chrome 扩展。我正在做的是一个共享弹出窗口，我目前将它保存为这样的书签：

```
javascript:window.open ('http://www.example.com/share.php?link='+(location.href), 'newwindow', config='height=200,width=520, toolbar=no, menubar=no, scrollbars=no, resizable=no, directories=no, status=no') 
```

但我很想把它做成一个至少我可以使用的小扩展。

这可能吗，如果是，请添加一些参考。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T19:18:23.323

看看这个页面，[http://code.google.com/chrome/extensions/getstarted.html](http://code.google.com/chrome/extensions/getstarted.html)

我确定是否将其作为谷歌浏览器扩展是最好的计划，但它应该可以工作。

# objective-c - 传入自定义选择器实现

> ID：11746545
> 
> 赞同：2
> 
> 时间：2012-07-31T18:20:55.707
> 
> 标签：objective-c, selector, objective-c-blocks, imp

假设我有两个 Objective-c 类，`LBFoo`并且`LBBar`.

在`LBFoo`我有一个看起来像这样的方法：

```
- (void)doSomethingWithFoo:(NSNumber*)anArgument
{
  if(anArgument.intValue > 2)
    [LBBar doSomethingWithLBBar];
  else
    [LBBar doSomethingElseWithLBBar];
} 
```

相反，我想做的是传递一个`LBBar`没有提前声明的实现。（如在动态覆盖现有的@selector 中`LBBar`）

我知道`IMP`存在一个类型，是否可以将一个传递`IMP`给一个类以更改其选择器实现。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T18:28:57.707

您可以在[Objective-C 运行时](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/ObjCRuntimeRef/Reference/reference.html)`method_setImplementation(Method method, IMP imp)`使用该函数。

如果你想设置一个实例方法，它会像这样工作

```
method_setImplementation(class_getInstanceMethod([yourClass class], @selector(yourMethod)), yourIMP); 
```

如果你想要一个类方法，只需使用`class_getClassMethod`而不是`class_getInstanceMethod`. 论据应该相同。

这里的所有都是它的。请注意，IMP 只是一个 void 函数指针，前 2 个参数是`id self`和`SEL _cmd`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-31T18:53:28.050

您当然可以使用运行时函数来做这样的事情，* 但我建议这*正是引入*[Blocks](http://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/Blocks/Articles/00_Introduction.html)来解决的问题。它们允许你传递一大块可执行代码——你的方法实际上可以接受一个 Block 作为参数并运行它。

这是一个SSCCE：

```
#import <Foundation/Foundation.h>

typedef dispatch_block_t GenericBlock;

@interface Albatross : NSObject 
- (void)slapFace:(NSNumber *)n usingFish:(GenericBlock)block;
@end

@implementation Albatross

- (void)slapFace:(NSNumber *)n usingFish:(GenericBlock)block
{
    if( [n intValue] > 2 ){
        NSLog(@"Cabbage crates coming over the briny!");
    }
    else {
        block();    // Execute the block
    }
}

@end

int main(int argc, const char * argv[])
{

    @autoreleasepool {

        Albatross * p = [Albatross new];
        [p slapFace:[NSNumber numberWithInt:3] usingFish:^{
            NSLog(@"We'd like to see the dog kennels, please.");
        }];
         [p slapFace:[NSNumber numberWithInt:1] usingFish:^{
            NSLog(@"Lemon curry?");
        }];

    }
    return 0;
} 
```

* * *

*请注意，使用`method_setImplementation()`将更改以后每次从任何地方调用该方法时使用的代码——这是一个持久的更改。

# xml - 使用 curl 的 xml-rpc 请求？

> ID：11746551
> 
> 赞同：7
> 
> 时间：2012-07-31T18:21:26.023
> 
> 标签：xml, magento, curl, rpc

我有一个 Magento 服务器，它具有通过 API 公开的各种方法。我正在制作各种客户端模块的原型来调用这个 API。到目前为止，这是成功的。

我刚开始使用 curl 来推送 xml。令人惊讶的是，我什至无法通过 API 登录。这就是我正在做的事情（“登录”方法需要两个字符串，用户名和密码）。

```
curl --data-urlencode @xmlrpc http://domain/api/xmlrpc 
```

xmlrpc 文件的内容

```
<?xml version="1.0"?>
 <methodCall> 
 <methodName>login</methodName>
 <params>
 <param>
 <value>apiUser</value>
 </param>
 <param>
 <value>apiKey</value>
 </param>
 </params>
 </methodCall> 
```

这就是我得到的：

```
<?xml version="1.0" encoding="UTF-8"?>
<methodResponse>
<fault>
<value>
<struct>
<member>
<name>faultCode</name>
<value><int>631</int></value>
</member>
<member>
<name>faultString</name>
<value><string>Failed to parse request</string></value>
</member>
</struct>
</value>
</fault>
</methodResponse> 
```

这个错误是什么意思？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-31T18:35:45.403

而且，像往常一样，我的初学者查询最终是关于一些简单的事情。

```
curl --data @xmlrpc http://domain/api/xmlrpc 
```

代替

```
curl --data-urlencode @xmlrpc http://domain/api/xmlrpc 
```

给了我一个很好的新会话变量，表明我已经登录了！

```
<methodResponse><params><param><value><string>eaab9ac0780f6bc9ba867804</string></value></param></params></methodResponse> 
```

# sharepoint-2010 - 分析网格的 sharepoint 2010 中的 PPS 错误“字符串的长度超过了在 maxJsonLength 属性上设置的值。”

> ID：11746559
> 
> 赞同：1
> 
> 时间：2012-07-31T18:22:00.377
> 
> 标签：sharepoint-2010, ssas, mdx, performancepoint, dashboard-designer

我正在使用性能点并使用连接到分析网格的成员过滤器。在连接公式中，我写了如下内容

```
Drilldownleveltop(
Drilldownleveltop(
Drilldownleveltop(
Drilldownleveltop(
DrilldownLevelTop(TopCount(<<SourceValue>>, 5, [Measures].[Net Cost Global]),
3,,[Measures].[Net Cost Global]),
3,,[Measures].[Net Cost Global]),
3,,[Measures].[Net Cost Global]),
3,,[Measures].[Net Cost Global]),
3,,[Measures].[Net Cost Global]) 
```

但我收到错误消息“使用 JSON JavaScriptSerializer 进行序列化或反序列化时出错。字符串的长度超过了 maxJsonLength 属性上设置的值。”

相同的查询在 sql server 2008 中运行良好，我在每个级别都获得了 top10。请让我知道我应该对其进行哪些更改。

谢谢

# windows-phone-7 - 如何在 Windows Phone 7 中解析 HTML 页面数据？

> ID：11746562
> 
> 赞同：2
> 
> 时间：2012-07-31T18:22:11.077
> 
> 标签：windows-phone-7, xaml, windows-phone-7.1

我想在 Windows Phone 7 应用程序中执行以下两项任务。

1.导航到网页（例如http://www.FlightsInd.com）并获取HTML页面数据。我想确保所有文档数据都已完全下载。

在 C#.Net 中，我使用以下代码执行此操作：

```
WebBrowser objWB = new WebBrowser();
webBrowser1.DocumentCompleted += new WebBrowserDocumentCompletedEventHandler(webBrowser1_DocumentCompleted);
objWB.Navigate("http://www.FlightsInd.com") 
```

一旦触发 DocumentCompleted 事件，这意味着该请求中的所有数据都已下载。

2.解析HTML页面元素数据。

在 C#.Net 中，我使用以下代码执行此操作。

```
 doc = webBrowser1.Document;
       btnElem = doc.GetElementById(streleid); 
```

任何人都可以帮助我处理上述两种实现的等效类/代码吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-02T07:38:36.037

使用[WebBrowser Windows Phone 控件](http://msdn.microsoft.com/en-us/library/ff431812%28v=vs.92%29)

**导航到您的页面**

[browser.Navigate(new Uri("](http://msdn.microsoft.com/en-us/library/ff403407%28v=vs.92%29.aspx) [http://www.FlightsInd.com](http://www.FlightsInd.com) "));

**了解导航已完成并已加载内容**

[WebBrowser.Navigated 事件](http://msdn.microsoft.com/en-us/library/microsoft.phone.controls.webbrowser.navigated%28v=vs.92%29)

[**WebBrowser.LoadCompleted 事件**](http://msdn.microsoft.com/en-us/library/microsoft.phone.controls.webbrowser.loadcompleted%28v=vs.92%29)- 在 WebBrowser 控件加载内容后发生。

[WebBrowser.NavigationFailed 事件](http://msdn.microsoft.com/en-us/library/microsoft.phone.controls.webbrowser.navigationfailed%28v=vs.92%29)- 跟踪导航失败

WebBrowser 类事件按以下顺序引发：Navigating、Navigated 和 LoadCompleted。

**获取 Html 源代码**

WebBrowser Windows Phone 控件包含特殊功能，可将当前显示在 WebBrowser 控件中的 HTML 内容的源保存为字符串：

[字符串 html = browser.SaveToString();](http://msdn.microsoft.com/en-us/library/system.windows.controls.webbrowser.savetostring%28v=vs.95%29.aspx)

**解析 Html**

查看[HTML 敏捷包](http://html-agility-pack.net/?z=codeplex)

[在 C# 中解析 html 的最佳方法是什么？](https://stackoverflow.com/questions/56107/what-is-the-best-way-to-parse-html-in-c)

[解析 HTML 字符串](https://stackoverflow.com/questions/5105379/parsing-html-string)

PS。**或者**，您可以使用[webBrowser.InvokeScript (C#)](http://msdn.microsoft.com/en-us/library/system.windows.controls.webbrowser.scriptnotify%28v=vs.95%29.aspx)和 js eval 的组合来调用任何可以在其中使用*window.external.notify*的 js 命令将结果传递回 C#。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T18:30:05.553

如果我的问题是正确的，您可以使用网络浏览器`isBusy`属性来跟踪它是否仍在下载数据并在它仍然忙碌时休眠。

对于解析 html 文档，您可以使用 NSoup 库来解析 html，就像 jQuery 一样。它是来自 java 的 JSoup 库的一个端口。 [http://www.developerfusion.com/project/98472/nsoup/](http://www.developerfusion.com/project/98472/nsoup/)

此处解释语法：http: [//jsoup.org/cookbook/extracting-data/selector-syntax](http://jsoup.org/cookbook/extracting-data/selector-syntax)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-01T18:33:39.463

如果您拥有要导航到的网页，则可以`window.external.notify(document.documentElement.innerHTML)`在您的 javascript 中使用将文档 html 传递到本机层。然后，您将使用 ScriptNotify 捕获本机代码中的值。

稍微复杂一点，但如果您不拥有该网页，您可以托管自己的网页，使用原始页面打开 iframe，然后从 iframe 获取 html。

有关 window.external.notify 的更多信息，请参见此处：http: [//msdn.microsoft.com/en-us/library/system.windows.controls.webbrowser.scriptnotify (v=vs.95).aspx](http://msdn.microsoft.com/en-us/library/system.windows.controls.webbrowser.scriptnotify(v=vs.95).aspx)

# javascript - JQuery：如何选择表格行而不是单元格内的表格行

> ID：11746564
> 
> 赞同：0
> 
> 时间：2012-07-31T18:22:12.277
> 
> 标签：javascript, jquery

所以我有一个表格，单元格内也有表格，如下所示：

```
<table id='table1'>
   <tr>
       <td>xyz</td>
       <td>
           <table><tr></tr></table>
       </td>
   </tr>
   <tr></tr>
   <tr></tr>
   <tr></tr>
</table> 
```

如何使用 jquery 仅选择“table1”下的那些，而不是内部表下的那些？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-31T18:23:06.427

你可以使用[.children()](http://api.jquery.com/children/)

```
$('#table1').children('tr') 
```

或[子选择器](http://api.jquery.com/child-selector/)

```
$('#table1 > tr') 
```

这些将仅选择直接子元素

`tbody`正如@jonathanlonowski 所说，由于浏览器添加了额外的标记，因此使用它会更安全

```
$('#table1 > tr,#table1 > tbody > tr') 
```

这也可以

```
$('#table1').find('tr:first').siblings().andSelf() 
```

# jquery - jQuery 淡入新的 DIV

> ID：11746573
> 
> 赞同：0
> 
> 时间：2012-07-31T18:22:47.310
> 
> 标签：jquery, jquery-ui

我正在使用使用 jQuery 和 PHP 的 bitrepository.com 很棒的 AJAX 表单：http: [//www.bitrepository.com/a-simple-ajax-contact-form-with-php-validation.html](http://www.bitrepository.com/a-simple-ajax-contact-form-with-php-validation.html)

我希望单击淡入后出现的错误和验证DIV。

添加了以下 jQuery 代码但无济于事（也尝试使用单击/更改功能）：

```
$(document).ready(function(){
    if ($('.notification_error').length > 0) {
        $('.notification_error').fadeTo("slow", 1.0);
    }
}); 
```

任何帮助都会很棒...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T18:34:29.423

鉴于您的代码看起来与您引用的完全一样，您可以将 ajax-complete 回调更改为：

```
$("#note").ajaxComplete(function(event, request, settings){  

   if(msg == 'OK') // Message Sent? Show the 'Thank You' message and hide the form
   {
      result = '<div class="notification_ok">Your message has been sent. Thank you!</div>';
      $("#fields").hide();
   }
   else
   {
      result = msg;
   }
   /* Hide the element, alter the content, and then fade it in */
   $(this).hide().html(result).fadeIn("slow"); 
}); 
```

这将在错误和成功消息中消失。

**更新：**

要仅在第一次淡出元素，您可以将最后一行替换为以下内容：

```
if ($(".notification_error, .notification_ok", this).length === 0) {
    $(this).hide().html(result).fadeIn("slow"); 
} else {
    $(this).html(result);
} 
```

我们所做的是检查是否存在带有 class`notification_error`或的 en 元素`notification_ok`。如果不是（第一次）我们将其淡入，否则我们只是更新内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-31T18:30:41.633

尝试以下操作：

```
$("#clicked_input_id").click(function(){
    $('.notification_error').fadeTo("slow", 1.0);
}); 
```

# c++ - 访问地图数据结构中的结构元素

> ID：11746580
> 
> 赞同：0
> 
> 时间：2012-07-31T18:23:15.140
> 
> 标签：c++, data-structures

我有这个结构，并且映射数据结构如下：

```
#include <map>

struct category {
        int id;
        std::string name;
};

std::map<int, category> categories; 
```

现在，使用类别我想显示结构类别中的元素“名称”。但我无法访问它。任何人都可以帮忙吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T18:25:11.623

你是什​​么意思你不能访问它？

```
categories[0].name; 
```

应该足够了。

# css - 在 CSS 中嵌套 @media 规则

> ID：11746581
> 
> 赞同：63
> 
> 时间：2012-07-31T18:23:21.060
> 
> 标签：css, media-queries

不同浏览器的支持似乎不同..

检查[链接](http://jsfiddle.net/uZnud/2/embedded/result/)

Firefox：黑底白字。

Opera、Chrome、IE9：蓝底黑字。

哪个是正确的，我将如何使其保持一致？

编码

```
@media screen and (min-width: 480px) {

    body{
        background-color:#6aa6cc;
        color:#000;    
    }

    @media screen and (min-width: 768px) {

        body{
            background-color:#000;
            color:#fff;    
        }
    }
} 
```

​</p>

有趣的是，在条件中嵌套媒体查询`@import`似乎确实有效。

例如：

### 索引.html

```
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <title>Media test</title>
    <link rel="stylesheet" type="text/css" href="importer.css" />
</head>
<body>
    <h1>Why is this not consistent.</h1>
</body>
</html> 
```

### 进口商.css

```
@import url(media.css) screen and (min-width: 480px); 
```

### 媒体.css

```
body {
    background-color: #6aa6cc;
    color: #000;
}

@media screen and (min-width:768px) {
    body {
        background-color: #000;
        color: #fff;
    }
} 
```

* * *

## 回答 #1

> 赞同：101
> 
> 时间：2012-07-31T19:04:06.523

对于那些只想回答“哪些浏览器支持`@media`规则嵌套？”的人来说，简短的回答是所有现代浏览器，包括 Firefox、Safari、Chrome（及其衍生产品）和 Microsoft Edge，现在都支持`@media`规则嵌套如[CSS 条件 3](http://www.w3.org/TR/css3-conditional/#processing)中所述。带有嵌套`@media`规则的问题中的代码现在应该可以在任何地方正常工作，除了 Internet Explorer（[不再使用新功能进行更新](https://stackoverflow.com/questions/35184048/what-is-after-internet-explorer-11-on-windows-7-how-well-will-es2016-be-support/35184087#35184087)，这意味着任何版本的 IE 都不会支持此功能）。

[CSS2.1](http://www.w3.org/TR/CSS2/media.html#at-media-rule)中不存在此功能，因为当时只存在媒体类型，您可以简单地用逗号分组，这解释了为什么在第一次提出这个问题时对此的支持非常差。

下面是对原始问题的分析，并考虑到这些历史局限性。

* * *

有一些术语混乱需要澄清，以便我们了解到底发生了什么。

您拥有的代码指的是`@media`规则，而不是媒体查询——媒体查询本身是令牌之后的组件，而规则是由、媒体查询和嵌套在其集合中的规则`@media`组成的整个代码块`@media`的花括号。

当涉及到在 CSS 中使用媒体查询时，这可能会导致许多人感到困惑，以及在您的特定情况下，`@media`导入样式表中的规则即使`@import`伴随着另一个媒体查询也能正常工作。请注意，媒体查询可以同时出现在`@media`和`@import`规则中。它们是相同的东西，但它们被用来以不同的方式限制性地应用样式规则。

现在，这里的实际问题是嵌套`@media`规则[在 CSS2.1 中无效，](http://www.w3.org/TR/CSS2/media.html#at-media-rule)因为您不允许在规则中嵌套*任何*at`@media`规则。然而，CSS3 中的情况似乎完全不同。也就是说，条件规则模块[非常清楚地](http://www.w3.org/TR/css3-conditional/#processing)表明`@media`规则*可以*嵌套，甚至提供了一个示例：

> 例如，使用这组嵌套规则：
> 
> ```
> @media print { /* rule (1) */
>   /* hide navigation controls when printing */
>   #navigation { display: none }
>   @media (max-width: 12cm) { /* rule (2) */
>     /* keep notes in flow when printing to narrow pages */
>     .note { float: none }
>   }
> } 
> ```
> 
> 标记 (1) 规则的条件对于打印介质为真，当显示区域的宽度（对于打印介质为页框）小于或等于时，标记为 (2) 的规则条件为真12厘米。因此，规则“#navigation { display: none }”适用于此样式表应用于打印媒体时，规则“.note { float: none }”仅适用于样式表应用于打印媒体和宽度页框的长度小于或等于 12 厘米。

此外，看起来 Firefox 正在遵循此规范并相应地处理规则，而其他浏览器仍在以 CSS2.1 方式处理它。

[不过，语法模块](http://www.w3.org/TR/css3-syntax/#detailed-grammar)中的语法尚未更新以反映这一点；它仍然不允许在规则中嵌套`@media`规则，就像 CSS2.1 一样。无论如何，该规范都将被重写，所以我想这并不重要。

基本上，CSS3 允许它（等待重写语法模块），但不是 CSS2.1（因为它既不定义媒体查询也不允许嵌套`@media`规则块）。虽然至少有一个浏览器已经开始支持新规范，但我不会说其他浏览器有缺陷；相反，我会说它们只是还没有赶上，因为它们确实符合更旧、更稳定的规范。

最后，你的`@import`作品的原因是因为`@import`能够在媒体查询的帮助下有条件地工作。然而这与`@media`但是，这与您导入的样式表中这些实际上是两个独立的东西，所有浏览器都这样对待。

为了使您的代码在浏览器中一致地工作，您可以使用您的`@import`语句，或者，由于您的两个规则都使用`min-width`，只需删除`@media`规则的嵌套：

```
@media screen and (min-width: 480px) {
    body {
        background-color: #6aa6cc;
        color: #000;
    }
}

@media screen and (min-width: 768px) {
    body {
        background-color: #000;
        color: #fff;
    }
} 
```

# php - VirtueMart - 限制送货到除一个国家以外的所有国家？

> ID：11746585
> 
> 赞同：1
> 
> 时间：2012-07-31T18:23:27.053
> 
> 标签：php, joomla, virtuemart

我需要为一个国家/地区设置运费，而运送到全球所有其他国家/地区的运费更高。标准情况。我的想法：创建两种运输方式。第一个仅适用于该国家，第二个适用于所有其他国家。如何限制第二种方法适用于除一个国家以外的所有国家？或者这种情况有其他解决方案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T05:18:04.617

首先，您应该知道 VirtueMart 支持一次仅使用一种运输方式，因此无法在一个订单中结合使用两种不同的方式。

但是，VirtueMart 可用的一种非商业运输方式称为 Flex2。它的工作方式类似于标准的 Flex 运输模块，除了它允许您定义两个“区域”。第一个区域称为“国内”，而第二个区域称为“国际”。

配置 Flex2 模块时，将您的“一个国家”的名称输入为国内国家保留的位置。默认情况下，所有其他国家/地区将被视为“国际”，并将使用第二组运输参数。

如果您的后续问题（关于将第二种方法限制为除一个以外的所有国家/地区）旨在省略第一部分中指定的国家/地区，您不必担心，因为这就是 Flex2 运输模块的隐含工作方式。

Flex2 仅与 Virtuemart 1.x 和 Joomla 1.5.x 兼容。

# c++ - win7中的垂直回扫编程

> ID：11746588
> 
> 赞同：0
> 
> 时间：2012-07-31T18:23:38.010
> 
> 标签：c++, c

嗨，最近我正在编写一个严格要求等待垂直回扫的同步部分。所以我使用了特权指令来执行此操作：_inp(0x3DA) & 0x08。但是，这个指令是特权的，需要安装 port95NT.exe 才能在我的旧 XP 计算机上正常工作。现在谈到Win7时，出现运行时警告以阻止我执行，我也不能在64位系统上安装port95NT.exe。所以有人有其他想法来检测 64 位 Win7 上垂直回溯中新帧的开始吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-31T20:53:15.690

微软设计了 DirectX 之类的 API，这样开发人员就不必像这样搞乱硬件级别的操作了。现代 Windows 版本可能不再有任何方法可以直接访问该硬件端口。

如果您有可用的工具包，您可以尝试[`WaitForVerticalBlank()`](http://msdn.microsoft.com/en-us/library/aa911354.aspx)使用 DirectDraw API。如果您使用的是 Direct3D，您可以尝试[`D3DPRESENT_INTERVAL_ONE`](http://technet.microsoft.com/en-us/library/bb172585%28v=VS.85%29.aspx)强制`Present()`更新等到垂直同步之后。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-30T18:37:02.480

首先，现代平板确实是这样工作的。每个像素必须定期刷新。有一个行/列频闪和一个垂直刷新率。尽管没有像 CRTS 那样实际“消隐”，但有一个垂直回溯，其中行/列值返回到原点。对于双（或三）缓冲系统，必须在此间隔期间交换缓冲区以避免帧撕裂。此外，所有专业视频应用程序都必须进行帧同步，以提供平滑的帧切换，或者用于与摄像机和其他演播室设备的“枪锁”。

# c# - RDLC的常见尺寸？

> ID：11746594
> 
> 赞同：0
> 
> 时间：2012-07-31T18:23:48.793
> 
> 标签：c#, report, reportviewer, reporting-services

我对使用报告相当陌生，但我想知道是否有常用的大小。我正在考虑使用 8.27001 英寸 x 11.69 英寸，因为我看到大多数人建议打印。我的大部分报告都可以通过浏览器查看，但通常可以打印出来。这会是一个很好的默认值吗？

# c++ - C++ 级联流插入（HW 帮助）

> ID：11746596
> 
> 赞同：4
> 
> 时间：2012-07-31T18:24:07.533
> 
> 标签：c++, stream, filestream

我在之前的堆栈问题中找到了这个潜在的解决方案。我的问题是它没有输出到文件。

该程序终止而没有错误，并且实际上做了它应该做的事情，因为我已经用`cout`.

该程序接受一个 7 位数的电话号码。然后将所有可能用这 7 位数字组成的单词写入文件，尊重标准电话上的字母数字关联。

程序使用两个函数：`main`和`wordGenerator`包含`iostream, fstream, & cstdlib`

`main`：

```
int main()
{
 int phoneNumber[ 7 ] = { 0 }; // holds phone number

 // prompt user to enter phone number
 cout << "Enter a phone number (digits 2 through 9) " << "in the form: xxx-xxxx\n";

 // loop 8 times: 7 digits plus hyphen;
 // hyphen is not placed in phoneNumber
 for ( int u = 0, v = 0; u < 8; u++ )
     {
         int i = cin.get();

         // test if i is between 0 and 9
         if ( i >= '0' && i <= '9' )
             phoneNumber[ v++ ] = i - '0';
         } // end for

 wordGenerator( phoneNumber ); // form words from phone number
} // end main 
```

`wordGenerator`：

```
void wordGenerator( const int * const n )
{
cout << "Some Word Forming Magic is going on!" << endl;

// set output stream and open output file
ofstream outFile("phone.dat");

// letters corresponding to each number
const char * phoneLetters[] = {"___", "___", "ABC", "DEF", "GHI", "JKL", "MNO", "PRS", "TUV", "WXY"};

// terminate if file could not be opened
if ( !outFile )
{
    cerr << "File could not be opened! Program Terminating..." << endl;
    exit(1);
}

 int count = 0; // number of words found

 // output all possible combinations
 for ( int i1 = 0; i1 <= 2; i1++ )
     {
         for ( int i2 = 0; i2 <= 2; i2++ )
             {
                 for ( int i3 = 0; i3 <= 2; i3++ )
                     {
                         for ( int i4 = 0; i4 <= 2; i4++ )
                             {
                                 for ( int i5 = 0; i5 <= 2; i5++ )
                                     {
                                         for ( int i6 = 0; i6 <= 2; i6++ )
                                             {
                                                 for ( int i7 = 0; i7 <= 2; i7++ )
                                                     {
/* I think the next 8 lines is what's not working! */
/* Write a series of cascaded stream insertion operations 
to output a set of seven letters to outFile, followed by a space */

outFile
<< phoneLetters[n[0]][i1]
<< phoneLetters[n[1]][i2]
<< phoneLetters[n[2]][i3]
<< phoneLetters[n[3]][i4]
<< phoneLetters[n[4]][i5]
<< phoneLetters[n[5]][i6]
<< phoneLetters[n[6]][i7]
<< " ";

                                                         if ( ++count % 9 == 0 ) // form rows
                                                             outFile << '\n';
                                                         }
                                                 }
                                         }
                                 }
                         }
                 }
         }

//alert user that wordGenerator has completed
cout << "Writing to file..." << endl;

// output phone number
outFile << "\nPhone number is ";

for ( int i = 0; i < 7; i++ )
    {
        if ( i == 3 )
            outFile << '-';

        outFile << n[ i ];

    } // end for

//print results to screen
cout << count / 9 << " words were created from" << endl;

//close output file
outFile.close();

} // end function wordGenerator 
```

程序运行良好。没有错误，除了没有写入输出文件`phone.dat`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-31T21:29:34.230

我很尴尬写这个。事实证明，代码**一直在工作**。输出文件被保存到`/Users/userName/Library/Developer/Xcode/DerivedData`程序运行后该目录消失。

因此，为了解决这个问题，您必须转到 XCode 的首选项，单击“位置”并将“派生数据”的设置从“默认”更改为“相对”。

我希望这对将来的其他人有所帮助...

# ios - UINavigationBar 中的透明图像

> ID：11746603
> 
> 赞同：0
> 
> 时间：2012-07-31T18:24:32.930
> 
> 标签：ios, uinavigationcontroller, uinavigationbar

当我尝试将其放入 Xcode 时，我在 Photoshop 中做了一个简单的设计，但 NavigationBar 出现了一些问题

我使用此代码更改 UINavigationBar 背景图像（PNG 透明图像）：

```
UINavigationBar *navBar = [[self navigationController]navigationBar];
[navBar setBackgroundImage[UIImageimageNamed:@"navBar2.png"]forBarMetrics:UIBarMetricsDefault] 
```

一切正常，但问题是图像出现在导航栏中没有透明度。

请有人帮我解决我到处搜索但没有任何满意答案的透明度问题
注意！我正在使用 IOS 5

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-31T18:58:30.417

您可以尝试将导航栏设置为半透明。

```
[navBar setTranslucent: YES]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T18:54:02.787

你的故事板中有它吗？尝试将导航栏的样式更改为黑色半透明。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-22T13:41:48.627

您可以做的是将 navigationController 的视图的背景颜色设置为与主视图的背景颜色相同。

```
//Set your view's background color    
[self.view setBackgroundColor:[UIColor colorWithPatternImage:[UIImage imageNamed:@"view_background"]]];

//Set your custom image for the navigationController
[self.navigationController.navigationBar setBackgroundImage:[UIImage imageNamed: @"navigation_bar_image"] forBarMetrics:UIBarMetricsDefault];

//And then set the background color of the navigationController the same as the one of the view
[self.navigationController.view setBackgroundColor:[UIColor colorWithPatternImage:[UIImage imageNamed:@"view_background"]]]; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-12-09T17:57:19.050

```
[self.navigationBar setBackgroundImage:[UIImage new] forBarMetrics:UIBarMetricsDefault];
[self.navigationBar setShadowImage:[UIImage new]];
[self.navigationBar setTranslucent:YES]; 
```

并确保将色调颜色设置为默认值。

# python - SQLAlchemy - 查询显示两个表中都存在记录的结果

> ID：11746610
> 
> 赞同：1
> 
> 时间：2012-07-31T18:24:57.933
> 
> 标签：python, sqlalchemy

我有一个与 item_tiers 表相关的项目表。第二个表包含项目表中项目的库存收据。item_tiers 表中可以有 0 条或多条记录与 items 表中的单个记录相关。如何使用查询仅获取在项目层中有 1 个或多个记录的记录....

结果 = session.query(Item).filter(???).join(ItemTier)

如果 item_tiers 表有一个或多个与 item 相关的记录，则过滤器片段在伪代码中类似于 ...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T19:03:16.997

如果表之间定义了外键，SA 将为您计算连接条件，无需额外的过滤器。

> 有，我真的想多了。感谢您的快速响应。– 厄米纳斯

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-12-28T20:37:04.933

```
results = session.query(Item).join(ItemTier).filter(Item.foreign_key=ItemTier.column_with_keys).all() 
```

# mysql - 1 对多 > 1 对多分组/子查询

> ID：11746613
> 
> 赞同：0
> 
> 时间：2012-07-31T18:25:13.240
> 
> 标签：mysql

我有一个购物车，需要以表格格式列出订单。每个订单可以有多个产品，每个产品可能有多个选项（这些是书本类型的产品，您可以选择不同的封面颜色（免费），或者在上面印上您的名字（额外收费）

![ERD](../Images/b98df4391a3c8b214e85ed10c6f656bf.png)

到目前为止我所拥有的是

```
 select 
order_id,
sum(price_paid * ordered_qty),
group_concat(product_code SEPARATOR ' / ') 
from
orders join  order_lines USING (order_id)
where
DATE_FORMAT(order_date, '%Y%m') >= '201203' and DATE_FORMAT(order_date, '%Y%m') <= '201203' and order_status = 'SHIPPED' and item_status = 'LINESHIPPED'
group by order_id 
order by order_id 
```

这将忽略选项（order_line_options 表）并返回：

```
58  21.98   SKU-12 / SKU-12
59  10.99   SKU-12
60  67.78   SKU-31 / SKU-12 / SKU-56
61  259.45  SKU-98 / SKU-06 / SKU-98
62  9.49    SKU-40 / SKU-36 
```

哪个正确地总结了单位成本 * 数量并在单行中列出了产品代码（重复的产品代码表示订购的不同选项）

我现在需要的是产品中包含的选项，结果如下：

```
58  21.98   SKU-12 (Color: Red, 0.00 - Printname 0.00) / SKU-12  (Color: Blue, 0.00 - Printname 4.95) 
```

仅显示 SKU-12 的第一个订单订购了两次，一次为红色，一次为蓝色，并印有名称，价格为 4.95 美元

我花了一天时间尝试额外的 group by / group_concat 和 sub 查询，但我什至没有接近解决方案，所以任何帮助都会很棒。凯文

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T18:44:05.507

您可能希望在 SELECT 子句中使用两个相关的子查询。我想以下内容应该适合您：

```
select 
order_id,
sum( price_paid 
     * ordered_qty 
     -- add the cost of any subitems for this line
     + IFNULL((select sum(option_cost) 
          from order_line_options olo
         where olo.order_line_id = order_lines.order_line_id),0)
),
--Here product_code
group_concat(
  CONCAT(product_code, 
  ' (', 
  (select group_concat(
          CONCAT(option_name, ': ',
                 option_value, ', '
                 option_cost
                 )
          SEPARATOR '-'
          )
     from order_line_options olo
    where olo.order_line_id = order_lines.order_line_id
    group by olo.order_line_id
   ),
   ')'
  ) -- end of CONCAT() which creates subitem list
  SEPARATOR ' / '
) 
from
orders join  order_lines USING (order_id)
where
  DATE_FORMAT(order_date, '%Y%m') >= '201203' and DATE_FORMAT(order_date, '%Y%m') <=   '201203' and order_status = 'SHIPPED' and item_status = 'LINESHIPPED'
group by order_id 
order by order_id 
```

# php - 如何按自定义日期对 WordPress 查询进行排序？

> ID：11746614
> 
> 赞同：-1
> 
> 时间：2012-07-31T18:25:32.330
> 
> 标签：php, wordpress, sorting

所以我有一个名为“事件”的自定义帖子类型。在每个事件中，我都有一个名为“start_time_date”的自定义字段，它返回一个日期，如“08/01/12”。我将如何对这些帖子进行排序以返回帖子，以便帖子按 start_time_date 升序排序（首先显示更接近当前日期的 start_time_dates）。

这是我当前的代码：

```
<? query_posts("cat=$currentID&showposts=100"); ?>
<? if ( have_posts() ) : ?>
    <? while ( have_posts() ) : the_post(); if (time() < strtotime(get('end_time_date'))) :?>

       <? $originalDate = get('start_time_date'); $newDate = date("M j, Y", strtotime($originalDate)); ?>
       <div class="post">Some Post Data</div>

    <? endif; endwhile; ?>
<? endif; ?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-01T15:14:40.493

使用以 mysql 格式存储日期的元字段，即`2012-08-02`用于该帖子。也许考虑使用 jquery 日期选择器为您呈现这种格式。

保存后，该帖子现在应该在 wp_postmeta 表中有一行。

```
$results = new WP_Query( array( 'meta_key' => 'date', 'orderby'=> 'meta_value' )); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-31T18:32:24.557

您是否尝试过类似的方法：

```
<? query_posts("cat=$currentID&showposts=100&orderby=date&order=asc"); ?> 
```

我不确定`date`数据库列中到底是什么，但就是这样。此外，订单可能需要更改，但我认为这并不重要。

**编辑**

我做了一些更多的研究，`&orderby=date&order=asc`日期和订购是正确的。

对此感到抱歉，您是否阅读过在 WordPress 法典中[使用自定义选择查询显示帖子？](http://codex.wordpress.org/Displaying_Posts_Using_a_Custom_Select_Query)

他们还添加了自定义字段的名称`query_posts('&meta_key=popularity&orderby=meta_value');`在哪里。`meta_key`

在这里找到：[类参考/WP查询](http://codex.wordpress.org/Function_Reference/WP_Query#Custom_Field_Parameters)

# html - i 标签的 Alt 或标题属性

> ID：11746619
> 
> 赞同：86
> 
> 时间：2012-07-31T18:25:46.880
> 
> 标签：html, tags, font-awesome

我使用[font-awesome](http://fortawesome.github.com/Font-Awesome/)并像这样显示他们的字体：

```
<i class="icon-lock"></i> 
```

这将显示一个漂亮的小锁符号。为了让用户知道这到底意味着什么，我尝试添加诸如标题和 alt 之类的属性，但无济于事。

是否有任何属性可以用于`<i>`执行与图像的 alt 和链接的标题相同的任务的标签？

* * *

## 回答 #1

> 赞同：162
> 
> 时间：2012-07-31T18:45:58.047

您可以`title`在元素上使用属性`i`，就像任何元素一样，例如

```
<i class="icon-lock" title="This symbolizes your being locked inside"></i> 
```

它是否有帮助是一个更困难的问题。浏览器通常会在鼠标悬停时将`title`属性值显示为“工具提示”，但为什么用户会将鼠标悬停在图标上？而且这样的工具提示可用性很差；所谓的 CSS 工具提示通常效果更好。

屏幕阅读器可能会赋予用户对属性的可选访问权限`title`，但我不确定他们如何处理内容为空的元素。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2016-01-29T16:39:47.377

随着[WAI-ARIA](https://www.w3.org/TR/wai-aria/complete)的进步，在使用字体图标时，您可能应该使用以下组合来提高可访问性：

*   用于移除元素的隐式本地角色语义的角色[表示。](https://www.w3.org/TR/wai-aria/complete#presentation)如果您（ab）使用具有本机语义的元素来提供图标，这一点尤其重要，因为在您使用[i](https://www.w3.org/TR/html5/text-level-semantics.html#the-i-element)元素的示例中就是这种情况（根据规范，*“代表替代语音中的一段文本或心情 [...]”*）。
*   一个[aria-label](https://www.w3.org/TR/wai-aria/complete#aria-label)提供一个字符串值来标记元素*- 或者 -*如果您可以在浏览器悬停时显示工具提示，则可以使用本机 HTML[标题属性。](https://www.w3.org/TR/html401/struct/global.html#adef-title)
*   *用于隐藏辅助技术生成的内容*的[aria-hidden](https://www.w3.org/TR/wai-aria/complete#aria-hidden)属性（当您使用图标字体系列时，有一个生成的字符 :before of :after）。根据规格：

 *> 仅当隐藏此内容的行为旨在通过删除冗余或无关内容来改善辅助技术用户的体验时，作者才可以谨慎使用*aria-hidden来隐藏辅助技术中可见呈现的内容。*使用 aria-hidden 向屏幕阅读器隐藏可见内容的作者必须确保将相同或等效的含义和功能暴露给辅助技术。

* * *

我不知道您的确切用例，所以我冒昧地使用提供电话号码的更简单的情况。按优先顺序递减，*我*会使用：

```
<span aria-label="Our phone number">
  <span class="icon-phone" aria-hidden="true"></span>
  +33 7 1234576
</span>

(or any variation implying:
  - an `i` element with a `role` presentation attribute
    instead of the inner `span` element
  - a `title` attribute instead of an `aria-label` attribute) 
```

```
<span class="icon-phone" 
  aria-label="Our phone number">+33 7 1234576</span>

(or any variation using `title` instead of `aria-label`) 
```

```
<i class="icon-phone" role="presentation" 
  aria-label="Our phone number">+33 7 1234576</i>

(or any variation using `title` instead of `aria-label`) 
```

请注意*aria-label*和*title*属性应该描述元素的**内容**。不是下一个兄弟元素。所以*我*觉得以下解决方案*不*符合规范（即使大多数可访问性工具实际上具有与电话号码实际上在`span`元素内一样的可观察行为）：

```
<span class="icon-phone" 
  title="Our phone number"></span>+33 7 1234576 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-07-31T18:30:19.520

你应该使用`<span>`或类似的东西。`title=""`如果您正在寻找，您可以使用该属性在悬停时提供一些文本。至于为屏幕阅读器提供可访问性或 SEO 值，您可以添加以下 CSS：

```
.icon-lock{
    text-indent:-99999px;
} 
```

然后像这样写你的标记：

```
<span class="icon-lock">What I want the screen reader to say</span> 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-07-31T18:32:12.343

`<i>`标签用于标记文本。您正在将此标记的语义含义更改为与使用斜体无关的内容（甚至斜体标记也是一个坏主意）。你应该使用 a`SPAN`代替。

斜体元素不支持`alt`属性，`IMG`元素支持。如果您想要一个`ALT`属性，请使用图像。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2018-08-27T19:19:29.087

我认为像图像一样的字体的角色应该保留给 role="img"。这可以与 aria-label="alt-text" 一起使用。它的工作原理是 ARIA 可访问名称算法。请参阅：[使用 Img 角色的 Aria 技术](https://www.w3.org/WAI/GL/wiki/ARIATechnique_usingImgRole_with_aria-label_forCSS-backgroundImage)。*

# .net - 我可以在混合了 32 位和 64 位 dll 的项目上使用 Fitnesse 吗？

> ID：11746620
> 
> 赞同：0
> 
> 时间：2012-07-31T18:25:52.367
> 
> 标签：.net, fitnesse

我目前正在使用 Fitnesse 服务器版本 20111026 来测试一个 64 位项目，该项目包含对编译为 64 位和一些编译为 x86 的 .NET 项目的一些 DLL 的引用。Visual Studio 对此没有问题，但是当我添加引用使用 x86 构建的 dll 的路径时，我从 Fitnesse 收到以下消息：

> System.BadImageFormatException：无法加载文件或程序集“MyDLL.DLL”或其依赖项之一。试图加载格式不正确的程序。

有谁知道如何解决这个问题？

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T20:23:02.523

这是解决方案。

Fitnesse runner 是在 AnyCPU 上构建的，您应该通过以下命令将一个补丁安装到 x86

```
corflags runner.exe /32BIT+ 
```

[这](http://www.codeproject.com/Articles/383138/BadImageFormatException-x86-i-x64)是检查跑步者平台的方法

# mercurial - 关于我的存储库结构的建议

> ID：11746627
> 
> 赞同：1
> 
> 时间：2012-07-31T18:26:10.810
> 
> 标签：mercurial, rcs

我是一名应用数学家，最近加入了一个项目，该项目涉及为我们的科学应用开发生产代码。代码库并不小，它被部署为 Web 应用程序的一部分。

当我加入时，代码在没有修订控制系统的情况下奇迹般地得到了维护。服务器中有一个中央文件夹，研究人员在需要使用代码时可以从中复制。在这个根目录内有一组包含不同版本代码的目录，因此人们将开始使用他们找到的最新版本并使用他们的修改创建一个新版本。

我创建了一个 Mercurial 存储库，向其中添加了所有代码版本，并说服每个人都使用它。然而，自从迁移到 Mercurial 后，我们几乎感觉不到升级版本号的必要性，即使使用困难也`hg copy`能让我们保留修订历史。

在这里，我需要您就维护此代码库的最佳实践提出建议。在 RCS 下将具有不同版本的文件夹保存在存储库中是否有意义？如果我们在 repo 中保留一份代码副本，那么跟踪版本的最常用方法是什么？自述文件？我们是否应该在指定版本的 repo 之外保留代码的快照？保持原样有意义吗？你使用什么策略？

我们的团队是一群科学家，没有人有如何维护这样的 repo 的经验，所以我对通常做的事情很感兴趣。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-31T19:20:15.623

如果您要使用版本控制系统，请忘记那些版本文件夹。完全。Mercurial 会为您做到这一点，存储库是项目所有文件的完整历史记录。

跟踪版本号的常用方法是使用[标签](https://www.mercurial-scm.org/wiki/Tag)。您将带有版本号的标签分配给变更集。

为了帮助你，作为版本控制的“入门指南”，我推荐这本书：[通过示例进行版本控制](http://www.ericsink.com/vcbe/)。它是免费的，从头开始，它讨论 CVCS、DVCS、基础知识、存储库是什么、基本命令等。它还有一些有趣的类比，比如 3D 文件系统：目录 x 文件 x 时间。这本书很有趣，通俗易懂，我强烈推荐它。

我还推荐一些 GUI 软件，例如[TortoiseHg](http://tortoisehg.bitbucket.io/)。在日常使用中，我大部分时间都在控制台中度过，但 GUI 非常方便，特别是在你还不知道所有命令的开始时。最好的部分是图表，你可以看到正在发生的事情的视觉反馈。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T13:10:53.903

[这](http://hginit.com/01.html)是对 Mercurial 的一个很好且快速的介绍，它甚至从谈论如何使用文件夹来保存不同版本开始并不是那么好。

如果您使用 hg copy 命令，我认为您可能走错了路，我从来不需要它；）

教程讲授hg的命令行版本，我个人比较喜欢。当您需要更好地了解您的存储库时，您可以运行“hg serve”并在 Web 浏览器中打开 localhost:8000。我更喜欢 TortoiseHG，但我意识到很多人想要一个纯 GUI 工具。

# c# - 字符串分配神秘问题。变量名影响行为

> ID：11746633
> 
> 赞同：0
> 
> 时间：2012-07-31T18:26:43.803
> 
> 标签：c#, .net, variable-assignment, code-contracts

我在方法中有以下代码：

```
string username = (string)context["UserName"];

string un = (string)context["UserName"]; 
```

问题是第一个字符串“用户名”没有被分配，而第二个被分配了。

更奇怪的是，当我在第一行之后停止调试并将该行复制到立即窗口，删除变量类型声明时，它被成功分配。

我已经重建所有并检查了似乎没问题的项目属性。

`context`变量是 a ，`System.Configuration.SettingsContext`它是一个哈希表。更具体地说，我正在实现一个配置文件提供程序，即`GetPropertyValues`方法。

我正在使用 VS 2012 和 .NET 4.5

**编辑：**

我在我的项目中使用代码契约，它使用编译时代码注入进行运行时检查。我禁用了它，一切正常。我将尝试一一删除合同以找出导致问题的合同。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T20:25:20.417

在调查和禁用合约后，我发现只有在启用运行时合约检查并且出现此合约时才会出现问题：

```
Contract.Ensures(Contract.Result<System.Configuration.SettingsPropertyValueCollection>() != null); 
```

如果我删除这一行，代码就可以工作，所以它看起来像代码合同错误，尽管我无法在测试项目中重新创建它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-01T21:15:54.457

您所看到的类似于我之前看到的代码合同错误。[几个月前](http://social.msdn.microsoft.com/Forums/en-US/codecontracts/thread/56d8e382-1330-492d-919a-e936f1e7096f/)我在这里写了一些关于它的东西。如果你有这个错误，你的方法中可能还有一个 lambda 或 LINQ 表达式，它使用`username`.

为了将来参考，这是我看到的错误：

> 我用同样的方法有一个捕获局部变量的 lambda 表达式，比如说`values`，和一个 Contract.Requires() 表达式检查一些完全不相关的东西。在调试该方法时，调试器会在 Locals 中显示该变量`values`两次，并报告`values`始终为 null 的值，即使显然不是这种情况。
> 
> 重现：
> 
> ```
>  static void Reproduction(string argument)
>   {
>       Contract.Requires(argument != null); // <-- (1)
> 
>       int[] values = new int[1];
>       Debug.Assert(values != null);
> 
>       Func<int, bool> d = i => values[i] >= 0; // <-- (2)
> 
>       Console.WriteLine(values);
>   } 
> ```
> 
> 在分配到之后在此方法中的某处放置一个断点`values`并确保该方法被调用。当调试器遇到断点时，查看 Visual Studio 的 Locals 列表中的重复变量。将鼠标悬停在`values`上面，发现它被报告为`null`is ，这显然不是这种情况。
> 
> 删除合同 (1) 或带有 lambda (2) 的行时，问题就消失了。

# c++ - 使用 UDP 发送加密数据 - Openssl c++

> ID：11746634
> 
> 赞同：0
> 
> 时间：2012-07-31T18:26:49.300
> 
> 标签：c++, sockets, networking, openssl

以下是我的 udp 服务器和客户端的部分代码。我不确定是不是 UDP 的问题是我的输出很奇怪，但总是在第 16 个单词出现问题？

```
define MAX_ENCRYPT_MSG_SIZE 16 
```

在服务器端：

```
char tempStr[MAX_ENCRYPT_MSG_SIZE];

 /***** GET INPUT CODE HERE *****/

int tempLen = strlen(tempStr)+1;

//encrypt msg
ct = aes_encrypt(ci->getEVPCipherEN(),(unsigned char*) tempStr, &tempLen);

//send msg
rc = sendto(*(ci->getSd()), ct, tempLen, 0,(struct sockaddr *) ci->getCliAddr(),*(ci->getCliLen())); 
```

在客户端：

```
int iLen = MAX_ENCRYPT_MSG_SIZE;
char msg[MAX_ENCRYPT_MSG_SIZE];

n = recvfrom(*(ci->getSd()), msg, iLen, 0,(struct sockaddr *) ci->getCliAddr(),ci->getCliLen());

char pt[16];
char *plaintext = (char *)aes_decrypt(ci->getEVPCipherDE(),(unsigned char*) msg, &iLen);
//convert back to only 16 bytes
strcpy(pt,plaintext);
if(plaintext == NULL)
{
    std::cout << "Error" << std::endl;
}       
else
{
    std::cout << pt << std::flush;
} 
```

输出 ：

![客户端的样品输出](../Images/f0e01a6f83bba9637ab99b0aebea0074.png)

提前致谢！:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T18:28:54.520

c字符串到底需要空字节空间吗？是吗？

# delphi - PDevMode 和 DocumentProperties。在 Delphi 7+XE 之间迁移时出错

> ID：11746635
> 
> 赞同：0
> 
> 时间：2012-07-31T18:26:53.183
> 
> 标签：delphi, winapi, pdf, adobe, printers

我在下面有以下功能，用于收集我正在打印的 PDF 的文档属性。出于某种原因，在 Delphi 7（运行 XP）中，这很好用......但是，当我尝试使用 Windows 7 使用 Delphi XE 重新编译时，该功能似乎总是退出失败...... `dwRet = IDOK`！

我注意到我`dwNeeded`在 Delphi 7 中的对象是`7332`，而在 XE 中是`4294967295`！

知道如何快速解决这个问题吗？

```
Function TPrintPDF.GetPrinterDevMode ( pDevice: PChar ): PDevMode;
Var
  pDevModeVar : PDevMode;
  pDevModeVar2 : PDevMode;
  dwNeeded : DWord;
  dwRet : DWord;
Begin

  { Start by opening the printer }
  If (Not OpenPrinter (pDevice, PrinterHandle, Nil))
    Then Result := Nil;

  { Step 1: Allocate a buffer of the correct size }
  dwNeeded := DocumentProperties (0,
                         PrinterHandle, { Handle to our printer }
                         pDevice, { Name of the printer }
                         pDevModevar^, { Asking for size, so these are not used }
                         pDevModeVar^,
                         0); { Zero returns buffer size }

  GetMem (pDevModeVar, dwNeeded);

  { Step 2: Get the default DevMode for the printer }
  dwRet := DocumentProperties (0,
                 PrinterHandle,
                 pDevice,
                 pDevModeVar^, { The address of the buffer to fill }
                 pDevModeVar2^, { Not using the input buffer }
                 DM_OUT_BUFFER); { Have the output buffer filled }

  { If failure, cleanup and return failure }
  If (dwRet <> IDOK) Then Begin
    FreeMem (pDevModeVar);
    ClosePrinter (PrinterHandle);
    Result := Nil;
  End;

  { Finished with the printer }
  ClosePrinter (PrinterHandle);

  { Return the DevMode structure }
  Result := pDevModeVar;

End; { GetPrinterDevMode Function } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T19:28:15.037

以下是我可以在您的代码中看到的问题：

1.  的返回值`DocumentProperties`是一个有符号的 32 位整数。它被声明为`LONG`. 负值表示发生了错误，这就是发生在您身上的事情。只有您看不到负值，因为您已将该值填充到无符号整数中。不幸的是，XE 未能声明`LONG`. 因此，请更改您的代码以使用`Integer`。
2.  返回时您不会检查错误`DocumentProperties`。如果发生错误，则返回负值。确保你检查。
3.  您将第 4 个和第 5 个参数中的随机垃圾传递给`DocumentProperties`. 我怀疑您可以`nil`在第一次调用时同时传递这两个参数`DocumentProperties`。您当然可以`nil`在两次调用函数时传递第 5 个参数，因为您从未设置过`DM_IN_BUFFER`。
4.  当发生错误时，您设置`Result`为`nil`，但您继续执行函数的其余部分。不要那样做。调用 exit 退出函数。分配给不会像在类 C 语言中那样`Result`终止执行。`return`
5.  使用`try/finally`块来确保您调用`CloseHandle`. 这允许你`CloseHandle`只写一次。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T19:16:20.390

这是大卫建议的解决方案……谢谢大卫！

```
{ ---------------------------------------------------------------------------- }

Function TPrintPDF.GetPrinterDevMode                           (         pDevice: PChar                ): PDevMode;

Var
   pDevModeVar       : PDevMode;
   pDevModeVar2      : PDevMode;
   dwNeeded          : Long64;
   dwRet             : Long64;

Begin

  Result := Nil;

  { Start by opening the printer }
  If (OpenPrinter (pDevice, PrinterHandle, Nil)) Then Begin

    Try

      { Step 1: Allocate a buffer of the correct size }
      dwNeeded := DocumentProperties (0,
                                      PrinterHandle,  { Handle to our printer }
                                      pDevice,        { Name of the printer   }
                                      Nil,            { Asking for size, so these are not used }
                                      Nil,
                                      0);             { Zero returns buffer size }

      { Exit if this fails }
      If (dwNeeded < 0)
        Then Exit;

      GetMem (pDevModeVar, dwNeeded);

      { Step 2: Get the default DevMode for the printer }
      dwRet := DocumentProperties (0,
                                   PrinterHandle,
                                   pDevice,
                                   pDevModeVar^,      { The address of the buffer to fill }
                                   pDevModeVar2^,     { Not using the input buffer }
                                   DM_OUT_BUFFER);    { Have the output buffer filled }

      { If failure, cleanup and return failure }
      If (dwRet <> IDOK) Then Begin
        FreeMem (pDevModeVar);
        ClosePrinter (PrinterHandle);
        Result := Nil;
      End;

    { Finished with the printer }
    Finally
      ClosePrinter (PrinterHandle);
    End; { Try }

    { Return the DevMode structure }
    Result := pDevModeVar;

  End; { If we could open the printer }

End; { GetPrinterDevMode Function } 
```

# macos - OS X Mountain Lion 升级后 Vim R 插件损坏

> ID：11746637
> 
> 赞同：3
> 
> 时间：2012-07-31T18:27:02.030
> 
> 标签：macos, r, vim, vi

将 OS X 从 Lion 升级到 Mountain Lion 后，每当我打开 R 文件时都会收到以下警告：

```
Please, set the variable 'g:vimrplugin_term_cmd' in your .vimrc.^@Read the plugin documentation for details. 
```

知道为什么这不起作用吗？Lion 有哪些变化使插件 OS X 无法找到终端？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-31T18:27:02.030

查看 R Vim 插件文档后，似乎 OS X 上 vimrplugin_term 的默认值与 Mountain Lion 中的默认值不同。

将以下行添加到您的 .vimrc 应该可以解决问题：

```
let vimrplugin_term = "/Applications/Utilities/Terminal.app/Contents/MacOS/Terminal" 
```

# mongodb - 获取每个标签的所有对象

> ID：11746639
> 
> 赞同：0
> 
> 时间：2012-07-31T18:27:23.503
> 
> 标签：mongodb, mapreduce, mongodb-shell

我是 mongodbs mapreduce 的新手，当然我现在还没有完全理解它。我有一个问题，我试图解决几天但没有成功。

我收集了一些带有标签字段的帖子。现在我想 mapreduce 一个新的标签集合。每个标签都有一组分配了这个特定标签的所有帖子 ID。

我这样做的尝试之一（这样做不正确）

```
m = function() {
    for (var i in this.tags) {
    emit(this.tags[i], {"ids" : [this._id]});
};
}

r = function(key, emits) {
var total = {ids : []}
for (var i in emits) {
    emits[i].ids.forEach(function(id) {
        total.ids.push(id);
    }
} 
return total;
}; 
```

我知道，我必须以某种方式调整日期，但我就是无法理解它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T20:35:58.723

我认为您在 reduce 函数中缺少一个“)”来关闭 emits[i].ids.forEach()。这是你想要做的吗？

```
r = function (key, values) {
    var total = {ids:[]};
    for (var i in values) {
        values[i].ids.forEach(
            function (id){
                 total.ids.push(id);
            }
        );
    }
    return total;
} 
```

输入

```
{_id:2, tags: ["dog", "Jenna"]}
{_id:1, tags: ["cat", "Jenna"]} 
```

结果：

```
{"results" : [
        {"_id" : "Jenna",
         "value" : {"ids" : [2,1]}
        },
        {"_id" : "cat",
         "value" : {"ids" : [1]}
        },
        {"_id" : "dog",
         "value" : {"ids" : [2]}
        }
    ],
    "timeMillis" : 1,
    "counts" : {
        "input" : 2,
        "emit" : 4,
        "reduce" : 1,
        "output" : 3
    },
    "ok" : 1,
} 
```

# php - Paypal SandBox IPN 总是返回 INVALID

> ID：11746644
> 
> 赞同：11
> 
> 时间：2012-07-31T18:27:48.677
> 
> 标签：php, paypal, paypal-ipn, paypal-sandbox

正如以下答案中的评论之一所述，我尝试按照[本教程](http://www.geekality.net/2011/05/28/php-tutorial-paypal-instant-payment-notification-ipn/)进行操作。所以现在我有以下内容：

* * *

**ipn.php 文件：**

```
<?php

    $ipn_post_data = $_POST;

    $url = 'https://www.sandbox.paypal.com/cgi-bin/webscr';

    // Set up request to PayPal
    $request = curl_init();
    curl_setopt_array($request, array
    (
        CURLOPT_URL => $url,
        CURLOPT_POST => TRUE,
        CURLOPT_POSTFIELDS => http_build_query(array('cmd' => '_notify-validate') + $ipn_post_data),
        CURLOPT_RETURNTRANSFER => TRUE,
        CURLOPT_HEADER => FALSE,
        CURLOPT_SSL_VERIFYPEER => TRUE,
        CURLOPT_CAINFO => 'cacert.pem',
    ));

    // Execute request and get response and status code
    $response = curl_exec($request);
    $status   = curl_getinfo($request, CURLINFO_HTTP_CODE);

    // Close connection
    curl_close($request);

    if($status == 200 && $response == 'VERIFIED')
    {
        $subject = "valid";
        $message = "good";
    }
    else
    {
        $subject = "invalid";
        $message = "bad";
    }

    $to = "oshirowanen@mail.com";
    $from = "me@desktop.com";

    $header  = 'MIME-Version: 1.0' . "\r\n";
    $header .= 'Content-type: text/html; charset=iso-8859-1' . "\r\n";
    $header .= 'To: Oshirowanen <oshirowanen@mail.com>' . "\r\n";
    $header .= 'From: Me <me@desktop.com>' . "\r\n";

    mail($to,$subject,$message,$header);

?> 
```

* * *

**收到的邮件：**

```
Subject "invalid"
Message "bad" 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-08-02T18:38:43.523

编辑：

现在我可以看到您输出的数组，尝试替换它以消除 PHP 数组错误：

```
foreach ($_POST as $key => $value) {
    if (!is_array($value)) {
        $value = urlencode(stripslashes($value));
        $req .= "&$key=$value";
    }
    else if (is_array($value)) {
        $paymentArray = explode(' ', $value[0]);
        $paymentCurrency = urlencode(stripslashes($paymentArray[0]));
        $paymentGross = urlencode(stripslashes($paymentArray[1]));
        $req .= '&mc_currency=' . $paymentCurrency . '&mc_gross=' . $paymentGross;
    }
} 
```

这是完整的编辑代码：

```
// read the post from PayPal system and add 'cmd'
$req = 'cmd=' . urlencode('_notify-validate');

foreach ($_POST as $key => $value) {
    if (!is_array($value)) {
        $value = urlencode(stripslashes($value));
        $req .= "&$key=$value";
    }
    else if (is_array($value)) {
        $paymentArray = explode(' ', $value[0]);
        $paymentCurrency = urlencode(stripslashes($paymentArray[0]);
        $paymentGross = urlencode(stripslashes($paymentArray[1]);
        $req .= '&mc_currency=' . $paymentCurrency . '&mc_gross=' . $paymentGross;
    }
}

$ch = curl_init();
curl_setopt($ch, CURLOPT_URL, 'https://www.paypal.com/cgi-bin/webscr');
curl_setopt($ch, CURLOPT_HEADER, 0);
curl_setopt($ch, CURLOPT_POST, 1);
curl_setopt($ch, CURLOPT_RETURNTRANSFER,1);
curl_setopt($ch, CURLOPT_POSTFIELDS, $req);
curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, 1);
curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, 2);
curl_setopt($ch, CURLOPT_HTTPHEADER, array('Host: www.paypal.com'));
$res = curl_exec($ch);
curl_close($ch);

// assign posted variables to local variables
$item_name = $_POST['item_name'];
$item_number = $_POST['item_number'];
$payment_status = $_POST['payment_status'];
$payment_amount = $_POST['mc_gross'];
$payment_currency = $_POST['mc_currency'];
$txn_id = $_POST['txn_id'];
$receiver_email = $_POST['receiver_email'];
$payer_email = $_POST['payer_email'];

if (strcmp ($res, "VERIFIED") == 0) {
    // check the payment_status is Completed
    // check that txn_id has not been previously processed
    // check that receiver_email is your Primary PayPal email
    // check that payment_amount/payment_currency are correct
    // process payment
}
else if (strcmp ($res, "INVALID") == 0) {
    // log for manual investigation
} 
```

[看看这个](https://cms.paypal.com/cgi-bin/marketingweb?cmd=_render-content&content_ID=developer/library_code_ipn_code_samples)！

编辑：查看 PayPal 故障排除提示：

[https://cms.paypal.com/us/cgi-bin/?cmd=_render-content&content_ID=developer/e_howto_admin_IPNTesting](https://cms.paypal.com/us/cgi-bin/?cmd=_render-content&content_ID=developer/e_howto_admin_IPNTesting)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-03T21:14:35.390

问题是您没有检查 HTTP 响应代码，因此您将“无效主机标头”解释为 PayPal 响应，而它是 Web 服务器响应（对于状态代码 400）。
如果您查看[PayPal 文档](https://cms.paypal.com/uk/cgi-bin/?cmd=_render-content&content_ID=developer/e_howto_admin_IPNImplementation)，有一个与您的代码非常相似的 PHP 示例，因为它使用“fsockopen”、“fputs”和“fgets”函数与 PayPal 服务器进行通信。
但是如果你仔细看“fsockopen”调用后的注释，你可以读到：

```
// Process validation from PayPal 
// TODO: This sample does not test the HTTP response code. All 
// HTTP response codes must be handled or you should use an HTTP 
// library, such as cUrl 
```

这正是您的问题：在解析响应正文之前，您没有检查 HTTP 响应代码是否为 200（OK）。
此外，使用“strtolower”函数是不正确的，因为来自 PayPal 服务器的真实响应总是大写的，如上面引用的示例所示。
即使 PayPal 示例使用“fsockopen”方法，我认为使用[PHP cURL](http://php.net/manual/en/book.curl.php)库来实现您的 IPN 侦听器应该会更好。
还请查看以下答案：

*   [PHP cURL 贝宝沙箱](https://stackoverflow.com/questions/1776827/php-curl-paypal-sandbox)
*   [用于 paypal ipn 的 cURL 或 fsockopen](https://stackoverflow.com/questions/7379428/curl-or-fsockopen-for-paypal-ipn)

但是，如果您真的想使用“fsockopen”函数，则应始终在 POST 请求中指定[“Host”标头字段](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html)，如以下代码片段所示（摘自[PHP 手册](http://php.net/manual/en/function.fsockopen.php)）：

```
<?php
$fp = fsockopen("www.example.com", 80, $errno, $errstr, 30);
if (!$fp) {
    echo "$errstr ($errno)<br />\n";
} else {
    $out = "GET / HTTP/1.1\r\n";
    $out .= "Host: www.example.com\r\n";
    $out .= "Connection: Close\r\n\r\n";
    fwrite($fp, $out);
    while (!feof($fp)) {
        echo fgets($fp, 128);
    }
    fclose($fp);
}
?> 
```

**更新**

这是递归stripslashes / urlencoding的简单函数：

```
<html>
<body>
<pre>
<?

$post = Array (
  "transaction" => Array("USD 20.00"),
  "payment_request_date" => "Sun Aug '05 08:49:20 PDT 2012",
  "return_url" => "http://000.000.000.000/success.php"
);

echo "before myUrlencode...\n";
print_r($post);

function myUrlencode($post) {
  foreach ($post as $key => $val) {
    if (is_array($val)) {
      $post[$key] = myUrlencode($val);
    } else {
      $post[$key] = urlencode(stripslashes($val));
    }
  }
  return($post);
}

echo "\nafter myUrlencode...\n";
print_r(myUrlencode($post));

?>
</pre>
</body>
</html> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-16T09:55:21.977

1.  [使用基本示例代码](https://www.paypal-labs.com/integrationwizard/adaptive/paymenttypes.php)4b让它工作，

2.  从基本示例代码中清除`$ipnNotificationUrl = "";`，因为我有一个我自己添加的值，

3.  在沙盒中创建了卖家账户而不是商业专业账户，

4.  设置卖家账号启用ipn url，

5.  将以下 PHP 5.2[示例代码](https://www.x.com/developers/PayPal/documentation-tools/code-sample/216623)用于 ipn 侦听器

6.  将 2 行添加到侦听器中，如此处所述，[这](http://www.geekality.net/2011/05/28/php-tutorial-paypal-instant-payment-notification-ipn/)2 行如下所示：

7.  [从这里](http://curl.haxx.se/docs/caextract.html)`cacert.pem`将证书下载到我的服务器并将其放在与 ipn 侦听器相同的目录中：

第 6 点中提到的 2 行：

```
CURLOPT_SSL_VERIFYPEER => TRUE,
CURLOPT_CAINFO => 'cacert.pem', 
```

我不知道为什么沙盒业务专业帐户不允许我设置 ipn url，但卖家帐户可以。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-15T22:49:47.237

我不确定你的代码现在到底出了什么问题，但我之前也在苦苦挣扎，我的修复是在标题中添加主机，主机必须是 www.paypal.com。我使用了 fsockopen 方法，现在工作正常。

在 Curl 中，我之前遇到过 ssl 问题。解决方案是把这些行：

```
curl_setopt($curl, CURLOPT_COOKIEJAR, dirname(__FILE__) . "/cookies.txt");
curl_setopt($curl, CURLOPT_COOKIEFILE, dirname(__FILE__) . "/cookies.txt"); 
```

当然文件 cookies.txt 必须存在的地方。而且，我必须运行一个到页面的连接来获取会话数据，然后再发送发布数据。

下面是一个标题，使用 fsockopen 方法对我来说工作正常

```
$header = "POST /cgi-bin/webscr HTTP/1.0\r\n";
$header .= "Host: www.paypal.com\r\n";
$header .= "Content-Type: application/x-www-form-urlencoded\r\n";
$header .= "Content-Length: " . strlen($req) . "\r\n\r\n"; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-03T13:18:22.163

这些链接可能会解决您的问题，

[Paypal：IPN 无效问题](https://stackoverflow.com/questions/5361135/paypal-invalid-ipn-problem)

[http://www.webmasterworld.com/ecommerce/4292847.htm](http://www.webmasterworld.com/ecommerce/4292847.htm)

[Paypal 沙盒 IPN 返回无效](https://stackoverflow.com/questions/1485832/paypal-sandbox-ipn-return-invalid)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-06-04T13:32:59.000

这是 + 字符的问题，它经常被错误地获取，所以我做了这个解决方法，它对我有用。

> payment_data = 2016 年 6 月 4 日星期六 15:11:16 GMT+0200 (CEST)

```
foreach ($_POST as $key => $value) {
if($key !== "payment_date"){
    $req .= '&' . $key . '=' . rawurlencode(html_entity_decode($value, ENT_QUOTES, 'UTF-8'));
}else{
    $req .= '&' . $key . '=' . rawurlencode(str_replace(array('GMT '),array('GMT+'),$value));
}} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-08-09T13:21:34.673

以下是如何避免这些错误...

```
foreach ($_POST as $key => $value) {
     if ($key=='transaction')
          foreach ($value as $key2=>$value2) {
               $value['transaction'][$key2] = urlencode(stripslashes($value2));
     }
     else {
          $value = urlencode(stripslashes($value));
     }
     $req .= "&$key=$value";
 } 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-08-05T00:34:13.293

我终于找到了这个查询的更新（2016 年 8 月 5 日）工作答案。您可以将此代码用作 Sandbox 或 Live 的最终 IPN。有以下考虑：

1.  请务必将您的 IPN 监听器放置到 -> 我的销售工具 -> 即时付款通知部分。
2.  不要在沙箱中使用 IPN 模拟器，它总是会返回 INVALID。
3.  创建并使用一个实际的沙盒按钮，但不要将您的 IPN 侦听器放到显示“在客户完成结帐时将其带到此 URL”的返回页。

这就是全部。我希望这将有所帮助。

这是工作代码：

```
<?php
$post_data = file_get_contents('php://input');
$post_array = explode('&', $post_data);
$dataFromPayPal = array();
foreach ($post_array as $keyval) {
    $keyval = explode ('=', $keyval);
    if (count($keyval) == 2)
        $dataFromPayPal[$keyval[0]] = urldecode($keyval[1]);
}

$req = 'cmd=_notify-validate';
if(function_exists('get_magic_quotes_gpc')) {
    $get_magic_quotes_exists = true;
}
foreach ($dataFromPayPal as $key => $value) {
    if($get_magic_quotes_exists == true && get_magic_quotes_gpc() == 1) {
        $value = urlencode(stripslashes($value));
    } else {
        $value = urlencode($value);
    }
    $req .= "&$key=$value";
}

$ch = curl_init('https://www.sandbox.paypal.com/cgi-bin/webscr');
//use https://www.sandbox.paypal.com/cgi-bin/webscr in case you are testing this on a PayPal Sanbox environment
curl_setopt($ch, CURLOPT_HTTP_VERSION, CURL_HTTP_VERSION_1_1);
curl_setopt($ch, CURLOPT_POST, 1);
curl_setopt($ch, CURLOPT_RETURNTRANSFER,1);
curl_setopt($ch, CURLOPT_POSTFIELDS, $req);
curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, 2);
curl_setopt($ch, CURLOPT_FORBID_REUSE, 1);
curl_setopt($ch, CURLOPT_HTTPHEADER, array('Connection: Close'));

if( !($res = curl_exec($ch)) ) {
    curl_close($ch);
    exit;
}
curl_close($ch);

if (strcmp ($res, "INVALID") == 0) {
        echo "INVALID";
}
else if (strcmp ($res, "VERIFIED") == 0) {
        echo "VALID";
}

?> 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-07-09T12:54:44.697

拉了几个小时的头发，直到我看到伊祖丁的回答。他是对的..日期中的+没有被转移。只是为了测试，我从模拟器中预先填充的字段中删除了它`Verified`，最后得到了一个。

# java - 在 Java/Android 中解析多个 JSON 数组

> ID：11746650
> 
> 赞同：0
> 
> 时间：2012-07-31T18:28:19.703
> 
> 标签：java, android, arrays, json

如果您将多个 JSON 数组传递给 Java（在单个流中），如下所示：

```
[ <-----json objects---->] [ <-----json objects---->]  [ <-----json objects---->] 
```

**你如何在Java中解析？** 有没有办法在*不*将 JSON 数据重写为单个数组的情况下做到这一点？

本质上，我想在解析后达到可以做到这一点的程度。

```
item = json.getString("item");
total = json.getString("total");

items.add(item);
totals.add(total); 
```

一个关键点是第一个数组是项目，第二个数组是总计。items 中的第一个 json 对象对应于总数中的第一个。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T18:36:25.413

我会说您首先需要将此内容转换为有效的 JSON，也许您可​​以先替换`]\s*[`并`],[`在`[`开头和`]`结尾添加。这将是一个有效的 JSON，并且可以被解析为`JSONArray`包含许多`JSONArray`s 的一个。

就像是：

```
String receivedJSON = "[{},{}] [{},{}] [{}]";
String normalized = "[" + receivedJSON.replaceAll("\\]\\s*\\[", "],[") + "]";
new JSONArray(normalized); 
```

# vb.net - SharePoint：由于 Query 引发 GetListItems soapserverException

> ID：11746654
> 
> 赞同：0
> 
> 时间：2012-07-31T18:28:24.277
> 
> 标签：vb.net, web-services, sharepoint, sharepoint-2007

我正在使用 VB.net 设计一个 Windows 窗体应用程序。我试图让应用程序返回特定 SharePoint 列表中的行数。当 II 删除 ndQuery.InnerXml 代码时，一切正常；但是，我想在获得计数之前过滤列表。我要过滤的两列是“Assigned Employee”和“status”。我在 Stack 上查看了许多不同的帖子（[SharePoint SoapServerException 调用 GetListItems Web 服务](https://stackoverflow.com/questions/1079176/sharepoint-soapserverexception-calling-getlistitems-web-service)），但我的异常与查询有关。soapserverException 的详细信息是：“一个或多个字段类型未正确安装。转到列表设置页面删除这些字段：0x81020014。”

我尝试转到关系页面，但无法浏览到它：

```
(url)/Relationships%20List/allitems.aspx 
```

任何人都可以看到查询代码有问题吗？

```
Imports System
Imports System.IO
Imports System.Net
Imports System.Xml
Imports <xmlns="rs">
Public Class Form1

Dim i As Integer

Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click
    Dim listService As New getListItems.Lists
    listService.Credentials = CredentialCache.DefaultCredentials
    listService.Url = "http://(servername)/_vti_bin/Lists.asmx"
    Dim xmlDoc = New System.Xml.XmlDocument()

    Dim ndQuery As XmlNode =
    xmlDoc.CreateNode(XmlNodeType.Element, "Query", "")
    Dim ndViewFields As XmlNode =
        xmlDoc.CreateNode(XmlNodeType.Element, "ViewFields", "")
    Dim ndQueryOptions As XmlNode =
        xmlDoc.CreateNode(XmlNodeType.Element, "QueryOptions", "")

    ndQueryOptions.InnerXml =
        "<IncludeMandatoryColumns>FALSE</IncludeMandatoryColumns>"
    ndViewFields.InnerXml = "<FieldRef Name='Assigned Employee'/><FieldRef Name='Status'/>"
    ndQuery.InnerXml = "<Where><And><Contains><FieldRef Name ='Assigned Employee'/><Value Type='Text'>Engineer</Value></Contains><Contains><FieldRef Name='Status'/><Value Type='Text'>New</Value></Contains></And></Where>"

    Try

        Dim ndListItems As XmlNode =
                listService.GetListItems("Requests", Nothing, ndQuery, _
                ndViewFields, Nothing, ndQueryOptions, Nothing)

        Dim n1 As XmlNode = ndListItems.Item("rs:data")
        Dim a As String = n1.Attributes("ItemCount").InnerText

        'Attempted For each loop, but not needed:
        'Dim listItemCount As String
        'Dim innerXML = New System.Xml.XmlDocument
        'innerXML.LoadXml(ndListItems.InnerXml)
        'Dim rows As XmlNodeList = innerXML.GetElementsByTagName("rs:data")

        'For Each (XmlNode Attribute In rows)
        'Next

        Label1.Text = a

    Catch ex As System.Web.Services.Protocols.SoapException

        Label1.Text = ("Message:" + ControlChars.Lf + ex.Message +
            ControlChars.Lf +
        "Detail:" + ControlChars.Lf + ex.Detail.InnerText +
            ControlChars.Lf +
        "StackTrace:" + ControlChars.Lf + ex.StackTrace)

    End Try
End Sub
End Class 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T12:37:49.460

您可能需要将字段名称中的空格替换为`_x0020_`例如

```
<FieldRef Name='Assigned_x0020_Employee'/> 
```

该`Name`属性采用字段的内部名称，因此请仔细检查您正在使用的名称。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-01T19:36:38.680

过去，当我遇到有趣的“一个或多个字段类型未正确安装”错误时，通常是由于我的 CAML WHERE 标准指示字段属于某种类型而不是某种类型（例如，我指示 Value type= “文本”实际上是一个查找）。

如果您从 U2U 获取 CAML 查询生成器（免费），您可以将其指向您的站点（使用 SharePoint 的内置 Web 服务）并使用其拖放设计器构建您的 CAML 查询。查询在那里工作后，只需单击“编辑”选项卡，它将向您显示 SharePoint 期望的确切 CAML。我的猜测是您会发现字段类型设置不正确。安装完成后，整个过程大约需要 10 分钟。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-03T15:24:36.747

将查询语句分成两部分时，我发现了问题：

```
'ndQuery.InnerXml = "<Where><Eq><FieldRef Name ='Assigned_x0020_Employee'/><Value Type='Text'>Engineer</Value></Eq></Where>"
'ndQuery.InnerXml = "<Where><Eq><FieldRef Name ='Status'/><Value Type='Text'>New</Value></Eq></Where>" 
```

我发现虽然 SP 列表中的一列名为“Assigned Employee”，但实际的 FieldRef Name 只是员工。当我修改代码以包含它时，错误消失了。我把所有时间都花在更改值类型上，而不是查看 FieldRef 名称

最终结论：“一个或多个字段类型未正确安装”错误不仅会在“值类型”不正确时返回，而且在“FieldRef Name”包含错误标签时也会返回。

最终工作代码行：

```
ndQuery.InnerXml = "<Where><And><Eq><FieldRef Name ='Employee'/><Value Type='Text'>Engineer</Value></Eq><Eq><FieldRef Name='Request_x0020_Status'/><Value Type ='Text'>New</Value></Eq></And></Where>" 
```

# ios - 如何阻止浏览器窗口在 iOS Safari 中左右移动？

> ID：11746655
> 
> 赞同：3
> 
> 时间：2012-07-31T18:28:23.677
> 
> 标签：ios

这通常发生在使用表单域之后。一旦我单击输入，然后我离开输入，浏览器窗口就会打开，可以左右移动。

# c++ - 是否可以使用循环对其所有类型执行类方法

> ID：11746661
> 
> 赞同：1
> 
> 时间：2012-07-31T18:28:49.273
> 
> 标签：c++, class, methods, for-loop, foreach

我正在尝试编写一个磁贴引擎，并且我的一个类中有一个方法，我需要一种能够使用一个循环来为该类的所有现有实例执行该方法的方法，例如，如果我有一个 GameObject称为 tile 和另一个称为敌人 是否有一种方法可以为它们两者调用 GameObject::render 而无需在循环中指定它们的名称？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T18:32:03.763

您正在寻找的是[观察者模式](http://en.wikipedia.org/wiki/Observer_pattern)。

基本上，您试图为一个类的多个实例触发一个事件。

您将有一个观察者类，您可以在其中注册要通知的类的所有实例（可能在构造函数中）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-31T18:34:00.553

你必须做一些工作。例如，在 GameObject 类的构造函数中，您可以将指向正在创建的 GameObject 的指针添加到列表中。然后在你的析构函数中，你可以从同一个列表中删除指向被销毁对象的指针。这样你就有了一个指向所有实时游戏对象的指针列表，你可以在需要时循环访问。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-31T19:02:10.107

```
class GamePublisher{
public:
   void Attach(GameObject *);
   void Detach(GameObject *);
   void RenderGameObjects();
   static GamePublisher& GetPublisher();
}

void GamePublisher::RenderGameObjects(){
//This is just an example for simplicity, the syntax my be a little off, assuming you have knowledge of functors.
std::for_each(gameObjectContainer.begin(), gameObjectContainer.end(), render_functor);
}

//somewhere else...
class GameObject{
   public:
     virtual void Render()=0;
}

class Tile : public GameObject
{
   public:
     virtual void Render();//your implementation...
     Tile();
}

Tile::Tile() //: member initilizations...{
   GamePublisher::GetPublisher.Attach(this);
} 
```

您将不得不处理附加/分离，并且取决于多线程将不得不提出或重用一种机制来在多个线程之间处理这个问题。除此之外，我认为这对你有用。祝你好运。

您可以处理与析构函数的分离。

# c# - EF Code First 中的可选外键关系

> ID：11746667
> 
> 赞同：1
> 
> 时间：2012-07-31T18:29:19.830
> 
> 标签：c#, entity-framework

我正在使用实体框架和代码进行项目。这是我的缩短课程

```
public class BenefitsForm : IAnnualForm, IAuditable 
{
    public BenefitsUser UserInfo { get; set; }
    public CoverageLevel Medical { get; set; } //foreign key to CoverageLevels, optional
}

public class MedicalPlan : IHealthPlan
{
    public int Id { get; set; }
    public virtual IList<CoverageLevel> CoverageLevels { get; set; } //list of CoverageLevels, optional
}

public class CoverageLevel
{
    public int Id { get; set; }
    public MedicalPlan MedicalPlan { get; set; } //CoverageLevel foreign key to Medical Plan, optional
} 
```

所以基本上一个医疗计划有 4 个覆盖级别。每个覆盖级别都包含对创建它的计划（在本例中为医疗）的外键引用。此外，每份福利表都可以包含特定的承保级别（参考医疗计划）。

最终目标是能够将覆盖级别放入福利表格中，并且还能够通过执行 form.Medical.MedicalPlan 来查看该覆盖级别所属的医疗计划。我的 Fluent API 应该是什么样的？这就是我到目前为止所拥有的。

```
modelBuilder.Entity<CoverageLevel>().HasOptional(c => c.MedicalPlan)
            .WithMany(p => p.CoverageLevels)
            .HasForeignKey(c => c.MedicalPlan); 
```

福利表格需要什么？我需要在 CoverageLevel 类中引用 BenefitForm 吗？

# python - 如何从元组（或 2 个列表）更新字典

> ID：11746668
> 
> 赞同：4
> 
> 时间：2012-07-31T18:29:28.777
> 
> 标签：python, dictionary

我认为可以按如下方式更新现有字典：

```
nameValuePair = 'myKey=myValue'
d.update(nameValuePair.split('=')) 
```

但是我收到此错误：

```
Traceback (most recent call last):
  File "<pyshell#98>", line 1, in <module>
    d2.update(item.split('='))
ValueError: dictionary update sequence element #0 has length 1; 2 is required 
```

我查看了有关此主题的其他一些 StackOverflow 问题/答案，这让我认为这是可能的。我一定错过了一些基本的东西......

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-31T18:31:24.887

错误消息已经给了你一个提示：你传递的序列中的每个项目的长度必须为 2，这意味着它必须由一个键和一个值组成。

因此，您必须传递 2 元组（-lists，-sequences，...）的元组（列表，序列，...）：

```
// the value passed will be ((myKey, myValue), )
d.update((nameValuePair.split('='), ))
//       ^                        ^ ^
// creates a tuple of 1 element 
```

或者你可以这样做：

```
key, value = nameValuePair.split('=')
d[key] = value 
```

# xpath - Opera 的 Dragonfly 生成 xpath

> ID：11746671
> 
> 赞同：0
> 
> 时间：2012-07-31T18:29:44.870
> 
> 标签：xpath, automation, css-selectors, firebug, opera

我是一名自动化 QA 测试人员，最近发现了 Dragonfly 的强大功能，它是 Opera 的开发者插件。这是一个非常棒的工具，但是我找不到有关 Dragonfly 生成 xpath 查询或 css 选择器的能力的任何信息。这两者对于网络自动化都非常有用。我目前正在使用 Firebug，效果很好。但是我一直在寻找下一个最好的工具，我很想了解更多关于 Dragonfly 的信息。

有谁知道 Dragonfly 是否有能力至少生成 Xpath 查询？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-01T03:06:09.367

去年我也在想同样的事情，Dragonfly 团队的一位成员说[这是计划好的](http://my.opera.com/dragonfly/blog/show.dml/35535932#comment70628402)，但直到 Opera 支持 Clipboard API 才能实现。剪贴板 API 在[Presto 2.10](http://www.opera.com/docs/specs/presto2.10/#m210-294)中被添加到 Opera 。因此，我怀疑我们会在不久的将来看到此功能添加到 Dragonfly。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-07T21:22:57.670

如果您可以生成*CSS 选择器*，那么有一个简单的提示给您。

单击“检查元素”，转到“文档”选项卡侧面菜单中的“布局”选项卡，您将看到如下内容： `html > body.question-page > div.container > div#content > div > div#mainbar > div#question.question > table > tbody > tr > td.postcell > div > div.post-text > p`

* * *

题外话：*无论是 xpath 还是 css 选择器都很难学习，而且两者都最好手动编写，然后生成它们。*

# ember.js - 如何将值和 onclick 处理程序添加到 AnchorTag 的 emberjs 模板

> ID：11746677
> 
> 赞同：3
> 
> 时间：2012-07-31T18:29:57.370
> 
> 标签：ember.js

我的模板中有以下内容

```
<script type="text/x-handlebars">
    {{view ChatApp.SomeAnchor}}
</script> 
```

我在我的 ember 代码中将此定义为自定义视图

```
ChatApp.SomeAnchor = Ember.View.extend({
  tagName: 'a',
  attributeBindings: ['href'],
  href: '#'                                                                                                                                                                       
}); 
```

生成的html是这样的

```
<a id="ember211" class="ember-view" href="#"></a> 
```

我的问题是-如何修改 ember 对象以提供自定义的 onclick 和值，所以它看起来像这样

```
<a id="ember211" onclick="something(); return false;" class="ember-view" href="#">Click This</a> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T18:53:06.717

您能解释一下为什么要在 HTML 中使用内联 javascript 吗？

如果您只想覆盖视图上的点击行为，只需添加一个点击处理程序：

```
ChatApp.SomeAnchor = Ember.View.extend({
  tagName: 'a',
  attributeBindings: ['href'],
  href: '#',
  click:function(){
    //do your thing here.
    return false;
  }                                                                                                                                                                      
}); 
```

# php - PHP 或 JS 模板引擎？（对于同一html的多个块）

> ID：11746683
> 
> 赞同：0
> 
> 时间：2012-07-31T18:30:12.153
> 
> 标签：php, javascript, jquery, mustache, handlebars.js

主要问题在底部以粗体显示，但我将引导您了解我要问的内容和原因。

基本上，我现在一次只为用户做一件事情，并试图让他们选择在一页上显示所有内容。正在使用 PHP 将数据放在 html 中，但有兴趣改进我的代码并想知道带有 javascript 的 handlebars.js 是否更有意义，即使只是为了我自己的理智。

假设用户有一个列表，每个列表旁边都有复选框

```
[x] Option 1
[ ] Option 2
[ ] Option 3
...
[x] Option 20 
```

对于每个选中的框，都会显示一个 html 块，其中包含来自数据库的信息。

现在，我每页只显示一个 html 块。PHP 在同一个页面上，抓取数据，并循环通过两个查询生成的 2 个数组，在 html 中使用内联 php 来生成当前的 html 块。

```
....
<div class="option-wrapper">
    <?php foreach ( $option_list as $option ) : ?>
.... 
```

需要能够在同一页面上生成 1 到 20 次相同的代码块。我想我仍然可以使用 php inline 并遍历整个 html 块来为每个选定的选项创建另一个 html 块。

```
|    Option 1      |  |    Option 20     |
|  Title: Test1    |  |  Title: Test2    | 
```

但我想知道为此目的使用 javascript 模板引擎是否有优势。我已经将 javascript 写入图表数据，目前我隐藏了存储 php 变量的 html 元素（其中 15 个来自两个数组），然后由我的 jQuery 提取。但我已经觉得在 html 中隐藏变量至少感觉是不好的做法。

```
<div id="total-users" style="display:none;"><?php echo $total_users ?></div>
....
var totalUsers = $('#total-users').html(); 
```

**这可能是其中之一，如果你不得不问，这可能是不好的做法类型的问题。但是，老实说，这是不好的做法吗？**

**为了编写更高质量的代码，在 php 抓取所有数据之后使用 json_encode 会更好吗？然后在为每个选定选项克隆的 html 块中使用 javascript 模板引擎（如 handlebars.js）？**

还有一件事，我将来可能希望能够使用每个块中的下拉菜单来切换动态显示的数据，这会改变哪条路线更有意义吗？

还有什么明显的我遗漏或做错了吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T18:46:32.343

我绝对建议使用数据模板。

1- 当用户选择一个选项（或从所有可用选项中提交他们的最终选择）时，进行 AJAX 调用以检索 JSON 对象（您可以在一次 JSON 调用中返回一个对象或所有选项数据，后者首选）。

2- 使用模板（车把、小胡子、下划线等）在成功回调函数中呈现数据。

这将使您的代码更高效，对未来的 UI 请求更灵活（从用户体验的角度来看，您的代码将支持许多不同的实现）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-31T18:47:55.747

如果我理解正确，您从数据库中检索的信息是静态的（也就是说，它不会在每次单击复选框之间发生变化）。

如果以上是真的，我个人会这样做。（虽然只是我的意见）

我会从数据库中获取所有信息（指所有“复选框”）一次，服务器端（PHP）。然后我会把它们放在隐藏的 div 中：

```
<div id="stuffFromDb1" class="hidden" style="display: none">blablabla</div> 
```

然后，当用户单击复选框时，我会显示对应的 div，方法是将 display: none 更改为 display: block。（使用 jQuery 更容易，请参阅[Toggle](http://api.jquery.com/toggle/)。

在我看来，这似乎是最有效的方式，而不是通过 AJAX 或多个“表单”获取信息。

编辑：

与 AJAX 和表单发布相比，我更喜欢这种方法，因为它减少了对服务器的请求数量。除非数据库查询是 CPU 密集型（复杂），否则查询一次数据库通常比查询几次数据库更快，并为用户提供更好的体验。

编辑2：

没有看到代码很难给你答案，但对于 100 或 200 甚至 1000，我敢打赌，一次加载它们比一个一个地加载它们总体上会更快，特别是如果你能做到这一点只做 1查询数据库。

客户端模板系统总是依赖于客户端的速度。在较新的浏览器/新 PC 中，JS 引擎相当快，但对于较旧的 PC/较旧的浏览器，这根本不是真的。复杂的 DOM 操作 + 完成 AJAX 请求所需的时间可能需要相当长的时间，在此期间用户可能无法与页面交互。此外，可能会出现其他问题（AJAX Race Condition 出现在我的脑海中）。

# mysql - Mysql：选择组内的唯一值？

> ID：11746695
> 
> 赞同：-1
> 
> 时间：2012-07-31T18:30:59.427
> 
> 标签：mysql, sql, group-by, distinct

有 3 列 - 类别、材料和品牌。老实说，这不是来自单个表的列，而是使用连接从另外 8 个表查询的结果；）

```
 |   category  |   material   | brand          |
    ----------------------------------------------|
    |  engines    |  product 1   | abb            | -> unique for category "engines"
    |  engines    |  product 2   | wika           | -> unique for category "engines"
    |  engines    |  product 3   | allen-bradley  | -> unique for category "engines"
    |  engines    |  product 5   | wika           |
    |  engines    |  product 6   | e+h            | -> unique for category "engines"
    |  drives     |  product 7   | abb            | -> unique for category "drives"
    |  drives     |  product 8   | wika           | -> unique for category "drives"
    |  drives     |  product 9   | allen-bradley  | -> unique for category "drives"
    |  drives     |  product 10  | e+h            | -> unique for category "drives"
    |  drives     |  product 11  | e+h            | 
```

结果我需要这样的smt：

```
 |   category  |   material   | brand          | concat(category, brand) |
    ----------------------------------------------|-------------------------|
    |  engines    |  product *   | abb            | engines/abb             |
    |  engines    |  product *   | wika           | engines/wika            |
    |  engines    |  product *   | allen-bradley  | engines/allen-brandley  |
    |  engines    |  product *   | e+h            | engines/e+h             |
    |  drives     |  product *   | abb            | drives/abb              |
    |  drives     |  product *   | wika           | drives/wika             |  
    |  drives     |  product *   | allen-bradley  | drives/allen-bradley    |
    |  drives     |  product *   | e+h            | drives/e+h              | 
```

如果我使用“group by”语句（GROUP BY CONCAT()），每 300 个结果的查询时间超过 10 秒，这并不让我高兴。

有人知道如何在组内获取唯一值吗？

升级版：

```
SELECT *, CONCAT(url_alias.alias, '/', LOWER(brand_alias.field_brand_path_value)) as real_url 
FROM `taxonomy_term_hierarchy` as th0
LEFT JOIN `taxonomy_term_hierarchy` as th1 ON th0.tid = th1.parent
LEFT JOIN `taxonomy_term_hierarchy` as th2 ON th1.tid = th2.parent
LEFT JOIN `taxonomy_term_hierarchy` as th3 ON th2.tid = th3.parent
LEFT JOIN `taxonomy_term_hierarchy` as th4 ON th3.tid = th4.parent

LEFT JOIN field_data_field_cat_reference as cat_reference ON    
cat_reference.field_cat_reference_tid IN (th0.tid, th1.tid, th2.tid, th3.tid, th4.tid)
LEFT JOIN node n ON cat_reference.entity_id = n.nid
LEFT JOIN field_data_field_brand_reference as brand_reference ON n.nid = brand_reference.entity_id
LEFT JOIN taxonomy_term_data as td_brand ON brand_reference.field_brand_reference_tid = td_brand.tid
LEFT JOIN field_data_field_brand_path as brand_alias ON td_brand.tid = brand_alias.entity_id
LEFT JOIN url_alias ON CONCAT('taxonomy/term/', th0.tid) = url_alias.source
WHERE 1
GROUP BY CONCAT(url_alias.alias, '/', LOWER(brand_alias.field_brand_path_value)) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T18:47:41.403

尝试：

```
SELECT   a.category, 
         CONCAT(SUBSTRING_INDEX(a.material, ' ', 1), ' *') AS material,
         brand,
         CONCAT(a.category, '/', a.brand) AS concattedval
FROM     (
             [Your Sub-Select Query]
         ) a
GROUP BY a.category, 
         material, 
         a.brand 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-01T10:27:49.863

你可以试试这样

> 选择 substring(new1,0,charindex('/',new1)) 作为类别，'product *' 作为 Material，substring(new1,charindex('/',new1)+1,len(new1)) 作为品牌，new1 from (select distinct Category+'/'+brand as new1 from table) temp

# android - 释放相机时出现“停止人脸检测失败”异常

> ID：11746696
> 
> 赞同：1
> 
> 时间：2012-07-31T18:31:11.217
> 
> 标签：android, face-detection

我在 Galaxy Nexus 上使用新的 API 14+ [FaceDetectionListener](http://developer.android.com/reference/android/hardware/Camera.FaceDetectionListener.html)来检测相机预览中的人脸。一切正常，我可以拿起人脸，但是当我尝试在 SurfaceHolder 被破坏时关闭相机时，我得到一个 RuntimeException ，上面写着“停止人脸检测失败”。我用来设置和停止人脸检测的代码如下所示：

```
public void surfaceChanged( SurfaceHolder holder, int format, int w, int h ) {
    if( isPreviewRunning ) {
        camera.stopPreview();
    }
    initPreview( w, h );
    camera.startPreview();
    if( enableFaceRecognition ) {
        camera.startFaceDetection();
    }
    isPreviewRunning = true;
}

public void surfaceDestroyed( SurfaceHolder holder ) {
    if( camera != null ) {
        if( enableFaceRecognition ) {
            try {
                camera.stopFaceDetection();
            } catch( Exception e ) {
                Log.e( TAG, "Huh?", e );
            }
        }
        cameraConfigured = false;
        camera.stopPreview();
        camera.release();
        camera = null;
    }
} 
```

哦，还有：

```
enableFaceRecognition = camera.getParameters().getMaxNumDetectedFaces() > 0 
```

**编辑：**

这是 logcat 输出：

```
07-31 18:59:47.809: E/Preview(9410): Huh?
07-31 18:59:47.809: E/Preview(9410): java.lang.RuntimeException: stop face detection failed
07-31 18:59:47.809: E/Preview(9410):    at android.hardware.Camera._stopFaceDetection(Native Method)
07-31 18:59:47.809: E/Preview(9410):    at android.hardware.Camera.stopFaceDetection(Camera.java:1138)
07-31 18:59:47.809: E/Preview(9410):    at app.face.Preview.surfaceDestroyed(Preview.java:126)
07-31 18:59:47.809: E/Preview(9410):    at android.view.SurfaceView.updateWindow(SurfaceView.java:517)
07-31 18:59:47.809: E/Preview(9410):    at android.view.SurfaceView.onWindowVisibilityChanged(SurfaceView.java:226)
07-31 18:59:47.809: E/Preview(9410):    at android.view.View.dispatchWindowVisibilityChanged(View.java:5839)
07-31 18:59:47.809: E/Preview(9410):    at android.view.ViewGroup.dispatchWindowVisibilityChanged(ViewGroup.java:945)
07-31 18:59:47.809: E/Preview(9410):    at android.view.ViewGroup.dispatchWindowVisibilityChanged(ViewGroup.java:945)
07-31 18:59:47.809: E/Preview(9410):    at android.view.ViewGroup.dispatchWindowVisibilityChanged(ViewGroup.java:945)
07-31 18:59:47.809: E/Preview(9410):    at android.view.ViewGroup.dispatchWindowVisibilityChanged(ViewGroup.java:945)
07-31 18:59:47.809: E/Preview(9410):    at android.view.ViewGroup.dispatchWindowVisibilityChanged(ViewGroup.java:945)
07-31 18:59:47.809: E/Preview(9410):    at android.view.ViewRootImpl.performTraversals(ViewRootImpl.java:965)
07-31 18:59:47.809: E/Preview(9410):    at android.view.ViewRootImpl.handleMessage(ViewRootImpl.java:2442)
07-31 18:59:47.809: E/Preview(9410):    at android.os.Handler.dispatchMessage(Handler.java:99)
07-31 18:59:47.809: E/Preview(9410):    at android.os.Looper.loop(Looper.java:137)
07-31 18:59:47.809: E/Preview(9410):    at android.app.ActivityThread.main(ActivityThread.java:4424)
07-31 18:59:47.809: E/Preview(9410):    at java.lang.reflect.Method.invokeNative(Native Method)
07-31 18:59:47.809: E/Preview(9410):    at java.lang.reflect.Method.invoke(Method.java:511)
07-31 18:59:47.809: E/Preview(9410):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
07-31 18:59:47.809: E/Preview(9410):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
07-31 18:59:47.809: E/Preview(9410):    at dalvik.system.NativeStart.main(Native Method) 
```

任何想法是什么导致了这个异常？

# ruby-on-rails - RSpec：存根 SFTP - 称为私有方法

> ID：11746699
> 
> 赞同：1
> 
> 时间：2012-07-31T18:31:27.683
> 
> 标签：ruby-on-rails, rspec, mocking, sftp

我正在尝试在模型中剔除 SFTP。这是模型：

```
class BatchTask
  require 'net/sftp'

  def get_file_stream(host, username, password, path_to_dir, filename)
    raise ArgumentError if host.nil? or username.nil? or password.nil? or path_to_dir.nil? or filename.nil?
    file_stream = nil
    Net::SFTP.start(host, username, password) do |sftp|
      sftp.dir.glob(path_to_dir, filename) do |entry|
        # Verify the directory contents
        raise RuntimeError(true), "file: #{path_to_dir}/#{filename} not found on SFTP server" if entry.nil?
        file_stream = sftp.file.open("#{path_to_dir}/#{entry.name}")
      end
    end
    file_stream
  end

end 
```

这是规格：

```
require 'spec_helper'

describe "SftpToServer" do
  let(:ftp) { BatchTask::SftpToServer.new }

 it "should return a file stream" do
    @sftp_mock = mock('sftp')
    @entry = File.stubs(:reads).with("filename").returns(@file)
    @entry_mock = mock('entry')
    @entry_mock.stub(:name).and_return("filename")
    @sftp_mock.stub_chain(:dir, :glob).and_yield(@entry_mock)
    Net::SFTP.stub(:start).and_yield(@sftp_mock)
    @sftp_mock.stub_chain(:file, :open).with("filename").and_yield(@file)

    ftp.get_file_stream("ftp.test.com", "user", "password", "some/pathname", "filename").should be_kind_of(IO)
  end

end 
```

这是堆栈跟踪：

```
NoMethodError in 'SftpToServer should return a file stream'
private method `open' called for #<Object:0x10c572620>
/Users/app/models/batch_task/sftp_to_server.rb:12:in `get_file_stream'
/Users/app/models/batch_task/sftp_to_server.rb:9:in `get_file_stream'
/Users/app/models/batch_task/sftp_to_server.rb:8:in `get_file_stream'
./spec/models/batch_task/sftp_to_server_spec.rb:15: 
```

我用谷歌搜索了这个，但我不明白为什么 RSpec 会将 sftp.file.open 视为私有方法......

提前感谢您的任何想法！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T22:58:13.840

所以，我知道发生了什么——我没有将 open() 方法描述为 @sftp_mock 对象的一部分，所以 @sftp.file.open 看起来像一个私有方法。解决这个问题需要让@sftp_mock.file 返回@sftp_mock，这样它就可以像这样链接到 open() 方法：

```
@sftp_mock.stub!(:file) { @sftp_mock }
@sftp_mock.should_receive(:open).with("some/pathname/filename").and_return(@file) 
```

我也错过了@file 声明......完整的规范文件是：

```
require 'spec_helper'

describe "SftpToServer" do
  let(:ftp) { BatchTask::SftpToServer.new }

 it "should return a file stream" do
    @file = File.new("#{RAILS_ROOT}/spec/files/express_checkout_tdr.csv", "r")
    @sftp_mock = mock('sftp')
    @entry = File.stubs(:reads).with("filename").returns(@file)
    @entry_mock = mock('entry')
    @entry_mock.stub(:name).and_return("filename")
    @sftp_mock.stub_chain(:dir, :glob).and_yield(@entry_mock)
    Net::SFTP.stub(:start).and_yield(@sftp_mock)
    @sftp_mock.stub!(:file) { @sftp_mock }
    @sftp_mock.should_receive(:open).with("some/pathname/filename").and_return(@file)

    ftp.get_file_stream("ftp.test.com", "user", "password", "some/pathname", "filename").should be_kind_of(IO)
  end

end 
```

另一个stackoverflow问题帮助我理解了这个概念：[Stub chain with should_receive](https://stackoverflow.com/questions/4262181/stub-chain-together-with-should-receive)

此外，如果有更好的方法来模拟和存根 SFTP，请随时发表评论。这个规范示例变得有点难看！

# database - 使用插入和外连接的关联名称

> ID：11746700
> 
> 赞同：1
> 
> 时间：2012-07-31T18:31:37.727
> 
> 标签：database, left-join, correlation, sql-insert

我正在尝试运行代码以使用来自不同数据库的不同表中的行从一个表中插入行。
我有这个：

```
INSERT [testDB].[dbo].[table1]
SELECT * FROM 
[sourceDB].[dbo].[table1]
LEFT OUTER JOIN [testDB].[dbo].[table1] 
ON [sourceDB].[dbo].[table1].[PKcolumn] = [testDB].[dbo].[table1].[PKcolumn]
WHERE [testDB].[dbo].[table1].[PKcolumn] IS NULL 
```

但是我被告知要添加相关名称，所以我做了这个：

```
INSERT test
SELECT * FROM 
[sourceDB].[dbo].[table1] as source
LEFT OUTER JOIN 
[testDB].[dbo].[table1] as test
ON 
source.[PKcolumn] = test.[PKcolumn]
WHERE test.[PKcolumn] IS NULL 
```

我最终得到了这个错误消息：

消息 208，级别 16，状态 1，第 1 行无效的对象名称“测试”。

有谁知道我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T18:36:42.810

在第一行中，您应该使用真实的表名，如

`insert into testDB.dbo.table1`

SQLServer 在那个地方不接受别名或相关名称，我通过测试确认了这一点。

但是您可以稍后在查询中使用别名，这样做非常有用，可以避免列来自哪个表的歧义。

此查询中的另一个潜在问题是使用 select *。这会尝试将来自 sourcedb.dbo.table1 和 testdb.dbo.table1 的组合列集插入到 testdb.dbo.table1 中。那是行不通的。

而不是 select * 你可以说...（假设 source 和 test 具有完全相同的列）

```
select source.* 
```

或者您可以调用特定列，如...

```
select source.colA, source.col3, etc.... 
```

我不知道你的专栏名称。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T19:21:48.453

```
INSERT test 
SELECT *
FROM  [sourceDB].[dbo].[table1] as source 
LEFT OUTER JOIN  [testDB].[dbo].[table1] as test 
   ON  source.[PKcolumn] = test.[PKcolumn] 
WHERE test.[PKcolumn] IS NULL 
```

让我们谈谈这有什么问题。首先 select * 将包含源中的所有列并在其中进行测试，这显然比您计划插入的表中的列更多。出于多种原因，在插入语句中使用 select * 是不可接受的。

首先，如果有人改变了列的顺序或表的结构，插入就会中断。其次，当您有这样的连接时，它的列数错误。第三，即使它们具有相同的列，如果它们最初的顺序不同，您也可以将数据放入wearg 列。如果它们是相似的数据类型并且数据适合或可以隐式转换，则数据库不会阻止您这样做。

接下来，您不能使用 select 中的别名作为插入中的目标，您必须引用实际的表名。

最后，在每次插入中不使用列列表是一种非常糟糕的做法。这有助于维护并确保您可以检查列 inteh selct 是否与插入中的列匹配。此外，如果您有自动生成的字段，则必须使用列列表，否则它将尝试插入自动生成的字段并因此出错。

所以你的陈述应该是这样的：

```
INSERT [testDB].[dbo].[table1] (field1, field2, field3)
SELECT source.field1, source.field2, source.field3
FROM  [sourceDB].[dbo].[table1] as source 
LEFT OUTER JOIN  [testDB].[dbo].[table1] as test 
   ON  source.[PKcolumn] = test.[PKcolumn] 
WHERE test.[PKcolumn] IS NULL 
```

或者（可能更有效，您必须在特定情况下进行测试）：

```
INSERT [testDB].[dbo].[table1] (field1, field2, field3)
SELECT source.field1, source.field2, source.field3
FROM  [sourceDB].[dbo].[table1] as source 
WHERE NOT EXISTS (SELECT * FROM testDB].[dbo].[table1] test 
                  WHERE  source.[PKcolumn]=test.[PKcolumn]) 
```

# asp.net - 避免数据绑定 Web 控件中的“魔术字符串”？

> ID：11746703
> 
> 赞同：1
> 
> 时间：2012-07-31T18:31:48.230
> 
> 标签：asp.net, data-binding

有没有办法使用绑定到它们的属性将数据绑定到控件，因此重构和拼写错误不是什么大问题？

例如，`ddl.DataTextField = "FieldName"; ddl.DataValueField = "Id"`我不会将字段名称分配给像 之类的下拉列表，而是假设写`ddl.DataTextField = MyClass.FieldName; ddl.DataValueField = MyClass.Id;`.

编辑：

我正在考虑让我的对象实现一个具有 DataTextField 和 DataValueField（或类似名称）属性的接口，因此，至少，我的 DDL 将始终绑定。

这在 ListViews、GridViews 等情况下无济于事。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T19:11:32.340

我不确定这是否是您的想法，但也许会有所帮助。

```
private void PopulateDropDown( List<MyClass> myClassList )
{
    // Loop through myClassList.
    foreach ( MyClass m in myClassList )
    {
        // Add myClass to the drop down list.
        ListItem item = new ListItem( m.FieldName, m.Id.ToString() );
        ddl.Items.Add( item );
    }
} 
```

# mongodb - Mongo 地图点表示法

> ID：11746704
> 
> 赞同：1
> 
> 时间：2012-07-31T18:31:54.200
> 
> 标签：mongodb

我想构造一个查询，它只返回下面数据结构的类的名称。到目前为止，我最接近的是使用点表示法

```
db.mycoll.find({name:"game1"},{"classes.1.name":true}) 
```

但是这种方法的问题是它只会返回第一个类的名称。请帮助我获取所有三个班级的名称。

我希望我可以使用如下通配符，但我不确定是否存在。

```
db.mycoll.find({name:"game1"},{"classes.$*.name":true}) 
```

数据结构：

```
{
"name" : "game1",
"classes" : {
    "1" : {
        "name" : "warlock",
        "version" : "1.0"
    },
    "2" : {
        "name" : "shaman",
        "version" : "2.0"
    },
    "3" : {
        "name" : "mage",
        "version" : "1.0"
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T20:07:55.857

没有简单的查询可以达到您寻求的结果。MongoDB 对查询子对象或对象数组的支持有限。MongoDB 的基本前提是您正在查询顶级文档。

也就是说，事情正在发生变化，您仍然有一些选择：

1.  使用新的[MongoDB 聚合框架](http://docs.mongodb.org/manual/applications/aggregation/)。这有一个`$project`应该做你正在寻找的操作。
2.  您可以只返回该`classes`字段，然后将它们合并`names`在一起。对于大多数语言来说，这应该是微不足道的。

请注意，目前尚不清楚您在做什么`classes`。这是一个数组还是一个对象？如果它是一个对象，它`classes.1`实际上代表什么？它与 不同`classes.warlock`吗？

# ruby-on-rails - Selenium 测试在 Ubuntu 和 Mac OSX 上的行为是否不同？

> ID：11746705
> 
> 赞同：3
> 
> 时间：2012-07-31T18:31:56.570
> 
> 标签：ruby-on-rails, ruby-on-rails-3, selenium, rspec, selenium-webdriver

我正在与合作伙伴一起开展一个项目，我们都使用不同的操作系统。我们所有的文件，包括那些`Gemfile`都在版本控制之下。以前，我`Rspec`用`Capybara`和编写过测试`selenium-webdriver`。这些测试打开 Firefox 并执行简单的操作、通过并关闭浏览器。

对布局进行了一些不相关的更改`flash[:success]`，现在，我们都更新了 HEAD，测试在我的机器上通过，但在他的机器上失败。

他的浏览器没有从 before 块加载模式框，`click_link "Edit"`因此当测试尝试填写表单时，这些字段仍然隐藏且无法访问。

我试图等待该框，认为它可能过早地填写字段：

```
wait = Selenium::WebDriver::Wait.new(:timeout => 10)
wait.until { page.driver.browser.find_element(:css, "div#edit_news_container").displayed? == true } 
```

相反，我得到了超时，测试仍然失败。

但是，它们在我的机器上运行良好……这是怎么回事？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T20:28:25.310

鉴于布局更改，您可能遇到的是浏览器问题而不是操作系统问题。你们两个使用相同版本的 Firefox 吗？如果没有，将他的版本更改为您的版本可能允许他再次加载模式。

# windows - 如何在 Cygwin（Linux 模拟器）中使用 Eclipse（IDE）？

> ID：11746706
> 
> 赞同：5
> 
> 时间：2012-07-31T18:31:59.190
> 
> 标签：windows, linux, windows-7, cygwin

我提前为这个问题的愚蠢道歉，但我很困惑 h@&! 甚至不知道该问什么了。

对于我的数学论文——也就是说，我不是程序员——我必须编写使用[CVODE 库](https://computation.llnl.gov/casc/sundials/description/description.html)的 C 代码，它是 SUNDIALS 的一部分（你需要所有这些细节吗？）。但是我不能直接在 proram 最终运行的 Gentoo Linux 集群上工作。

根据 SUNDIALS 的网站，CVODE 很少在本机 Windows 环境中编译和使用，但[已使用 Cygwin 使用](https://computation.llnl.gov/casc/sundials/support/faq.html#inst_win)。所以我想在我的 Windows PC 上使用 Cygwin 建立一个 C 编程环境，包括一个 IDE（尤其是调试器）。

我已经在我的 64 位 Windows PC 上安装并执行了基本的 Cygwin（加上一个用于 nano 编辑器的包）。我想使用 Eclipse IDE，它可用于 Linux 和 Windows，并且真的只能在图形界面中使用（我认为）。我想我应该接下来设置 Eclipse（然后是 CVODE）。这就是我现在想要做的。

**我的基本问题是如何设置 Eclipse 以使用 Cygwin？运行 Eclipse 需要哪些 Cygwin 包？**

从文档中，我看到 Cygwin 有一个服务器（Cygserver），但没有图形界面。或者，它可能有一个名为 Cygwin/X 的图形界面。*我是否在 Windows 中设置 Eclipse 以与 Cygserver 通信*，然后在 Windows 中工作，但编译等会在 Cygserver 中进行？或者，*我是否安装 Cygwin/X 并使用 Linux 版本的 Eclipse*，希望它能与 Cygwin/X 一起使用？如果两者都是可能的选择，那就更容易了（我猜是后者）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-31T18:38:36.230

Cygwin 很好，但我时不时遇到问题。我建议您下载[Virtualbox](https://www.virtualbox.org/)或一些类似的 VM 软件，并在其中安装与生产集群上相同的 Linux。然后，您将在开发机器上拥有一个与生产环境相匹配的环境。

现在，在 VM 中安装 eclipse（以及您想要的任何其他东西），您就可以在那里顺利地开发软件，而不必担心像 cygwin 等相关问题。

# css - 不同颜色的身体背景

> ID：11746707
> 
> 赞同：0
> 
> 时间：2012-07-31T18:32:01.547
> 
> 标签：css

我`background-image`为`body`元素设置的图像有问题，但由于页面长度不同，它无法正常工作。有没有办法为每个主要的 HTML 元素添加不同的主体背景颜色？

例如，在这个[网站上](http://nelsonandco.pro/learncenter/)，我需要页眉周围的主体颜色为白色，然后网站的主容器具有灰色渐变，最后页脚具有灰色纯色。

**稍后编辑**：根据 Joseph Silber 的推荐，我阅读了[Full Browser width Bars](http://css-tricks.com/full-browser-width-bars/)文章，并在评论中找到了一个非常简单的解决方案来解决我的问题，您可以在下面的代码或[jsFiddle](http://jsfiddle.net/zPfW2/)上看到：

```
#header {
background: white;
margin: 0 -2000px;
padding: 0 2000px;
}
#main   {
background: green;
margin: 0 -2000px;
padding: 0 2000px;
}
#footer {
background: gray;
margin: 0 -2000px;
padding: 0 2000px;
}
.content {
overflow-x: hidden;
} 
```

**甚至稍后更新：**如果您遇到水平滚动问题，请将该`overflow-x`属性也应用于 html 元素：

```
html, body {
overflow-x: hidden;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T18:58:03.980

我通过创建一个`.content`固定宽度的可重用 div 来做到这一点，并将其放置在每个部分内，如下所示：

```
<div id="header">
    <div class="content">

    </div>
</div>
<div id="main">
    <div class="content">

    </div>
</div>
<div id="footer">
    <div class="content">

    </div>
</div> 
```

将每个部分所需的背景颜色分配给父 div，这将“自然”地延伸到浏览器窗口的宽度：

```
#header {background: #000;}
#main   {background: #ccc;}
#footer {background: #fff;} 
```

然后给出`.content`一个固定的宽度：

```
.content {
    margin: 0 auto;
    width: 960px;
} 
```

# php - 如何从 PHP 中的外部文件创建对象

> ID：11746712
> 
> 赞同：2
> 
> 时间：2012-07-31T18:32:18.307
> 
> 标签：php, file, object, singleton, external

我在一个类中有一个 mySQL 对象，它位于一个外部文件中（从其他几个文件中访问它）。如何从我的文件**dbconnection.php 中获取我的 Singleton 对象：**

```
<?php
class DBConnection {

  private static $instance;

  private function __construct() {
    $user="root";
    $password="";
    $database="klb";
    mysql_connect("localhost",$user,$password);
    @mysql_select_db($database) or die( "Unable to select database");  
 }

  public function __destruct() {
      mysql_close();
 }

  public static function getInstance() {

    if(!self::$instance) {
      self::$instance = new self();
    }

    return self::$instance;
  }

  public function getNaviForCategory($category) {
    $query="SELECT * FROM projects WHERE category=\"$category\"";
    $result=mysql_query($query);
    $num=mysql_numrows($result);
    while ($row = mysql_fetch_object($result)) {
        $title=$row->title;
        $id=$row->id;
        echo "<div class=\"sublink\" data-subsite=\"$id\" data-category=\"$category\" data-title=\"$title\" ><a href=\"#\">$title<br />";
    }
  }

 public function getInfosForProject($id) {
    $query="SELECT * FROM projects WHERE id=\"$id\"";
    $result=mysql_query($query);
    $num=mysql_numrows($result);

    while ($row = mysql_fetch_object($result)) {
        $infos=$row->info;
        echo $infos;
    }
  } 

   private function createTableProjects(){
        $query="CREATE TABLE projects (id int(6) NOT NULL auto_increment,category varchar(30) NOT NULL,title varchar(30) NOT NULL,
        info varchar(200) NOT NULL,text varchar(8000) NOT NULL,PRIMARY KEY (id),UNIQUE id (id))";
        mysql_query($query);
   }
}

?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-31T18:35:28.977

您需要先[`include()`](http://php.net/include)或[`require()`](http://php.net/require)文件：

```
require( 'dbconnection.php'); 
```

然后你可以这样做：

```
$db = DBConnection::getInstance(); 
```

# c++ - mfc 选项卡控制切换选项卡

> ID：11746715
> 
> 赞同：1
> 
> 时间：2012-07-31T18:32:31.343
> 
> 标签：c++, mfc, cdialog

我创建了一个简单的选项卡控件，它有 2 个选项卡（每个选项卡都是一个不同的对话框）。问题是我不知道如何在选项卡之间切换（当用户按下`Titlu Tab1`以显示我为第一个选项卡制作的对话框时，以及当它按下`Titlu Tab2`以显示我的另一个对话框时）。我添加了一个用于更改项目的处理程序，但我不知道我应该如何访问某种索引或子选项卡。

`Tab1.h`并且`Tab2.h`是仅显示带有每个选项卡名称的静态文本的对话框的标题。

我的问题可能有一个明显的答案，但我是 C++ 和 MFC 的真正新手。

这是我的标题：

```
// CTabControlDlg.h : header file
//

#pragma once
#include "afxcmn.h"
#include "Tab1.h"
#include "Tab2.h"

// CCTabControlDlg dialog
class CCTabControlDlg : public CDialog
{
// Construction
public:
   CCTabControlDlg(CWnd* pParent = NULL);   // standard constructor

// Dialog Data
enum { IDD = IDD_CTABCONTROL_DIALOG };

protected:
virtual void DoDataExchange(CDataExchange* pDX);    // DDX/DDV support

// Implementation
protected:
   HICON m_hIcon;

  // Generated message map functions
  virtual BOOL OnInitDialog();
  afx_msg void OnSysCommand(UINT nID, LPARAM lParam);
  afx_msg void OnPaint();
  afx_msg HCURSOR OnQueryDragIcon();
  DECLARE_MESSAGE_MAP()
public:
  CTabCtrl m_tabcontrol1;

  CTab1 m_tab1;
  CTab2 m_tab2;
  afx_msg void OnTcnSelchangeTabcontrol(NMHDR *pNMHDR, LRESULT *pResult);
}; 
```

这是.cpp：

```
// CTabControlDlg.cpp : implementation file
//

#include "stdafx.h"
#include "CTabControl.h"
#include "CTabControlDlg.h"

#ifdef _DEBUG
#define new DEBUG_NEW
#endif

// CAboutDlg dialog used for App About

class CAboutDlg : public CDialog
{
 public:
   CAboutDlg();

 // Dialog Data
  enum { IDD = IDD_ABOUTBOX };

  protected:
  virtual void DoDataExchange(CDataExchange* pDX);    // DDX/DDV support

 // Implementation
 protected:
    DECLARE_MESSAGE_MAP()
 };

 CAboutDlg::CAboutDlg() : CDialog(CAboutDlg::IDD)
 {
 }

 void CAboutDlg::DoDataExchange(CDataExchange* pDX)
 {
   CDialog::DoDataExchange(pDX);
 }

 BEGIN_MESSAGE_MAP(CAboutDlg, CDialog)
 END_MESSAGE_MAP()

 // CCTabControlDlg dialog

 CCTabControlDlg::CCTabControlDlg(CWnd* pParent /*=NULL*/)
   : CDialog(CCTabControlDlg::IDD, pParent)
 {
   m_hIcon = AfxGetApp()->LoadIcon(IDR_MAINFRAME);
 }

 void CCTabControlDlg::DoDataExchange(CDataExchange* pDX)
 {
  CDialog::DoDataExchange(pDX);
  DDX_Control(pDX, IDC_TABCONTROL, m_tabcontrol1);
 }

 BEGIN_MESSAGE_MAP(CCTabControlDlg, CDialog)
  ON_WM_SYSCOMMAND()
  ON_WM_PAINT()
  ON_WM_QUERYDRAGICON()
  //}}AFX_MSG_MAP
  ON_NOTIFY(TCN_SELCHANGE, IDC_TABCONTROL,         &CCTabControlDlg::OnTcnSelchangeTabcontrol) 
    END_MESSAGE_MAP()

   // CCTabControlDlg message handlers

  BOOL CCTabControlDlg::OnInitDialog()
  {
    CDialog::OnInitDialog();

    // Add "About..." menu item to system menu.

    // IDM_ABOUTBOX must be in the system command range.
    ASSERT((IDM_ABOUTBOX & 0xFFF0) == IDM_ABOUTBOX);
    ASSERT(IDM_ABOUTBOX < 0xF000);

    CMenu* pSysMenu = GetSystemMenu(FALSE);
    if (pSysMenu != NULL)
{
    CString strAboutMenu;
    strAboutMenu.LoadString(IDS_ABOUTBOX);
    if (!strAboutMenu.IsEmpty())
    {
        pSysMenu->AppendMenu(MF_SEPARATOR);
        pSysMenu->AppendMenu(MF_STRING, IDM_ABOUTBOX, strAboutMenu);
    }
}

// Set the icon for this dialog.  The framework does this automatically
//  when the application's main window is not a dialog
SetIcon(m_hIcon, TRUE);         // Set big icon
SetIcon(m_hIcon, FALSE);        // Set small icon

// TODO: Add extra initialization here

CTabCtrl* pTabCtrl = (CTabCtrl*)GetDlgItem(IDC_TABCONTROL);

m_tab1.Create(IDD_TAB1, pTabCtrl);

TCITEM item1;
item1.mask      = TCIF_TEXT | TCIF_PARAM;
item1.lParam    = (LPARAM)& m_tab1;
item1.pszText   = _T("Titlu Tab1");
pTabCtrl->InsertItem(0, &item1);

//Pozitionarea dialogului
CRect rcItem;
pTabCtrl->GetItemRect(0, &rcItem);
m_tab1.SetWindowPos(NULL, rcItem.left, rcItem.bottom + 1, 0, 0, SWP_NOSIZE | SWP_NOZORDER );

m_tab1.ShowWindow(SW_SHOW);

// al doilea tab
m_tab2.Create(IDD_TAB2, pTabCtrl);
TCITEM item2;
item2.mask      = TCIF_TEXT | TCIF_PARAM;
item2.lParam    = (LPARAM)& m_tab1;
item2.pszText   = _T("Titlu Tab2");
pTabCtrl->InsertItem(0, &item2);

//Pozitionarea dialogului
//CRect rcItem;
pTabCtrl->GetItemRect(0, &rcItem);
m_tab2.SetWindowPos(NULL, rcItem.left, rcItem.bottom + 1, 0, 0, SWP_NOSIZE | SWP_NOZORDER );

m_tab2.ShowWindow(SW_SHOW);

return TRUE;  // return TRUE  unless you set the focus to a control
  }

  void CCTabControlDlg::OnSysCommand(UINT nID, LPARAM lParam)
  {
if ((nID & 0xFFF0) == IDM_ABOUTBOX)
{
    CAboutDlg dlgAbout;
    dlgAbout.DoModal();
}
else
{
    CDialog::OnSysCommand(nID, lParam);
}
    }

  // If you add a minimize button to your dialog, you will need the code below
  //  to draw the icon.  For MFC applications using the document/view model,
  //  this is automatically done for you by the framework.

  void CCTabControlDlg::OnPaint()
  {
if (IsIconic())
{
    CPaintDC dc(this); // device context for painting

    SendMessage(WM_ICONERASEBKGND, reinterpret_cast<WPARAM>(dc.GetSafeHdc()),   0);

    // Center icon in client rectangle
    int cxIcon = GetSystemMetrics(SM_CXICON);
    int cyIcon = GetSystemMetrics(SM_CYICON);
    CRect rect;
    GetClientRect(&rect);
    int x = (rect.Width() - cxIcon + 1) / 2;
    int y = (rect.Height() - cyIcon + 1) / 2;

    // Draw the icon
    dc.DrawIcon(x, y, m_hIcon);
}
else
{
    CDialog::OnPaint();
}
  }

  // The system calls this function to obtain the cursor to display while the user drags
  //  the minimized window.
  HCURSOR CCTabControlDlg::OnQueryDragIcon()
  {
   return static_cast<HCURSOR>(m_hIcon);
  }

  void CCTabControlDlg::OnTcnSelchangeTabcontrol(NMHDR *pNMHDR, LRESULT *pResult)
  {
// TODO: Add your control notification handler code here
*pResult = 0;

   } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T18:42:18.943

您可以在 MFC 中通过创建父对话框 a`CPropertySheet`和包含的对话框来自动执行此操作`CPropertyPage`。

按照您当前的结构方式，您应该`ShowWindow`为每个对话框执行一个设置，其中一个设置为`SW_SHOW`，另一个设置为`SW_HIDE`在您的`OnTcnSelchangeTabcontrol`函数中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-27T23:02:39.830

您应该添加 Tabcontrol 单击事件并执行以下代码。每个对话框/选项卡的对话框指针 pTab1 和 pTab2。

```
 void CYourClass::OnNMClickTab1(NMHDR *pNMHDR, LRESULT *pResult) 
    {
        pTab1->ShowWindow(SW_HIDE);  
        pTab2->ShowWindow(SW_HIDE);  
        for(int i=0;i<2;i++)
        {
            m_tbCtrl.HighlightItem(i,FALSE); 
        }
        switch(m_tbCtrl.GetCurSel())
        {
            case 0: pTab1->ShowWindow(SW_SHOW);break;
            case 1: pTab2->ShowWindow(SW_SHOW);break;
        }   
        m_tbCtrl.HighlightItem(m_tbCtrl.GetCurSel(),TRUE); 

       *pResult = 0;
    } 
```

# performance - num_conn 和 low_rate / high_rate 之间 Autobench 的区别？

> ID：11746716
> 
> 赞同：0
> 
> 时间：2012-07-31T18:32:48.863
> 
> 标签：performance, scaling, load-testing, httperf, autobench

我正在使用 Autobench 和 httperf 运行负载测试，并且无法理解他们在其网站上提供的示例。该示例使用标志

```
--low_rate 20 --high_rate 40 --rate_step 5 --num_call 10 --num_conn 5000 
```

我知道这将从 20 个连接开始，然后以 5 的速率增加到 40 个，每个连接有 10 个请求。我不明白的是 num_conn 指定的内容。这些是否像 5000 个连接的“池”，其中 20、25、30 等被拉出？还是完全不同的东西？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T21:22:16.110

不管**rate**， autobench 每次测试都会**建立 num_conn 个**连接。随着**速率**的增加，每次测试的持续时间会减少。

**num_conn**指定将建立的连接数。(5000)

**num_call**指定每个连接的调用（请求）数。(10)

**rate**指定每秒的连接数。（最初 20 个）

所以一次测试的总请求数为：**num_conn** * **num_call** (50000)

测试的持续时间是：**num_conn** / **rate**（最初为 250 秒）

测试中每秒的（尝试）请求数为：**num_call** * **rate**（最初为 200）

# erlang - Erlang：节点完全冻结。怎么办？

> ID：11746717
> 
> 赞同：3
> 
> 时间：2012-07-31T18:32:52.933
> 
> 标签：erlang

平台：windows 7 32bit，erlang R15B01。

我开发了一个 erlang 服务器，它同时监听 200 个不同的 tcp 端口（200 个 gen_servers）

经过几分钟的中等负载（少数客户端并行）后，整个节点完全冻结 - 甚至外壳也完全冻结。

如何诊断这个问题？是否有针对此类问题的标准 erlang 方法？（内存消耗很低，所以它不是某种内存泄漏）

**重要编辑**

**werl.exe**下好像没有这个问题。仅在**erl.exe**下。可能与[http://erlang.2086793.n4.nabble.com/erl-exe-dies-but-werl-exe-does-not-on-both-Windows-XP-and-2008R2-with-R14B01-中的相同td3335030.html](http://erlang.2086793.n4.nabble.com/erl-exe-dies-but-werl-exe-does-not-on-both-Windows-XP-and-2008R2-with-R14B01-td3335030.html)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-31T21:31:44.003

If you kill your process with `kill -SIGUSR1 <pid>`, the erlang VM will generate a erlang crash dump file `erl_crash.dump` in the directory the app was started.

Then you can analyze it using the [crash dump viewer](http://www.erlang.org/doc/apps/observer/crashdump_ug.html).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T10:32:18.993

冻结的 erlang shell 可能是由未捕获的退出信号引起的。您可以尝试在 shell 进程中捕获退出（假设它是服务器的父进程），这应该会给您退出原因。请参阅[有关错误的参考手册](http://www.erlang.org/doc/reference_manual/processes.html#errors)

# java - 对象初始化时线程“AWT-EventQueue-0”java.lang.ExceptionInInitializerError 中的异常

> ID：11746718
> 
> 赞同：1
> 
> 时间：2012-07-31T18:32:58.767
> 
> 标签：java

我有一个实例变量，如下所示：

```
PathFinder finder; 
```

（这是使用 Kevin Glass 的 A* 教程，所以 PathFinder 类在同一个文件中，链接在这里：[http](http://cokeandcode.com/index.html?page=tutorials/tilemap2) ://cokeandcode.com/index.html?page=tutorials/tilemap2 ）

无论如何，当我这样做时

```
finder = new AStarPathFinder(currentMap, 1000, true); 
```

我在线程“”AWT-EventQueue-0”java.lang.ExceptionInInitializerError”中得到一个异常。

currentMap 是我的 Map 类的一个实例，是的，它已被初始化。1000 表示将要搜索的最大平铺距离，布尔值表示对角线移动真/假。哦，好吧，我会把构造函数扔给你：

```
public AStarPathFinder(TileBasedMap map, int maxSearchDistance, boolean allowDiagMovement) {
    this(map, maxSearchDistance, allowDiagMovement, new ClosestHeuristic());
} 
```

我知道它与静态初始化器有关，但我不太确定还有什么。哦，我试图在另一个类中初始化同一个 AStarPathFinder 类的实例，我得到了相同的结果。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T18:39:28.283

我阅读了完整的堆栈跟踪，错误是父类和子类中方法的参数不一样，不知何故，IDE 只是没有发出任何通知。

# mysql - 在 Mac 命令行上，如何在文件 foo.sql 中执行 SQL 语句并将结果以制表符分隔的形式导出到另一个文件中？

> ID：11746719
> 
> 赞同：1
> 
> 时间：2012-07-31T18:32:59.520
> 
> 标签：mysql, sql, file

在 Mac 命令行上，

```
$ sql -u foo -pbar db -B -e "SELECT * FROM t" > output.txt 
```

需要输入内联命令。

如何在文件 foo.sql 中执行 SQL 语句，并且仍然以制表符分隔的形式将结果导出到另一个文件中？

## 编辑

当我做

```
mysql -h localhost -u foo -pbar db -B -e "SELECT * FROM t WHERE x='{}' LIMIT 2 INTO OUTFILE '../o.tsv';" 
```

我有错误

```
ERROR 1045 (28000) at line 1: Access denied for user 'foo'@'localhost' (using password: YES) 
```

但奇怪的是，

```
mysql -h localhost -u foo -pbar db 
```

给我mysql命令提示符很好。使用是否`OUTFILE`需要`foo`具有特殊权限的用户？

```
mysql> SELECT * FROM user WHERE User='foo'\G
*************************** 1\. row ***************************
                 Host: localhost
                 User: foo
             Password: *A5DB2D927D6DF94DA5E1CE4B2AEAAB4D8304EA
          Select_priv: N
          Insert_priv: N
          Update_priv: N
          Delete_priv: N
          Create_priv: N
            Drop_priv: N
          Reload_priv: N
        Shutdown_priv: N
         Process_priv: N
            File_priv: N
           Grant_priv: N
      References_priv: N
           Index_priv: N
           Alter_priv: N
         Show_db_priv: N
           Super_priv: N
Create_tmp_table_priv: N
     Lock_tables_priv: N
         Execute_priv: N
      Repl_slave_priv: N
     Repl_client_priv: N
     Create_view_priv: N
       Show_view_priv: N
  Create_routine_priv: N
   Alter_routine_priv: N
     Create_user_priv: N
             ssl_type: 
           ssl_cipher: 
          x509_issuer: 
         x509_subject: 
        max_questions: 0
          max_updates: 0
      max_connections: 0
 max_user_connections: 0
1 row in set (0.01 sec) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T18:51:17.250

做：

```
sql -u foo -pbar db -B -e `cat foo.sql` > output.txt 
```

工作？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T19:18:58.387

设置`File_priv`为true后，它可以工作。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-07-31T18:45:27.473

使用`SELECT [text of query] INTO OUTFILE [filename]`. 这是[文档](http://dev.mysql.com/doc/refman/5.0/en/select-into.html)。如果格式不完全符合您的要求，请参阅文件中的[加载数据](http://dev.mysql.com/doc/refman/5.0/en/load-data.html)语法以了解您可以在文件名之后指定的格式命令。

# c++ - Qt C++ 不能在没有对象的情况下调用成员函数“”

> ID：11746729
> 
> 赞同：1
> 
> 时间：2012-07-31T18:33:55.900
> 
> 标签：c++, qt, function, user-interface

我不断收到此错误：

```
cannot call member function 'QString Load::loadRoundsPlayed()'without object 
```

现在我对 c++ 和 qt 很陌生，所以我不确定这意味着什么。我正在尝试从另一个类调用一个函数来设置一些 lcdNumbers 上的数字。这是包含该功能的 Load.cpp：

```
#include "load.h"
#include <QtCore>
#include <QFile>
#include <QDebug>

Load::Load() //here and down
{}

QString Load::loadRoundsPlayed()
{
    QFile roundsFile(":/StartupFiles/average_rounds.dat");

    if(!roundsFile.open(QFile::ReadOnly | QFile::Text))
    {
        qDebug("Could not open average_rounds for reading");
    }

    Load::roundsPlayed = roundsFile.readAll();
    roundsFile.close();
    return Load::roundsPlayed;
} 
```

这是Load.h：

```
 #ifndef LOAD_H
     #define LOAD_H

    #include <QtCore>

    class Load
    {
    private:
        QString roundsPlayed; //and here
    public:
        Load();
        QString loadRoundsPlayed(); //and here
    };

    #endif // LOAD_H 
```

最后是我调用函数的地方：

```
 #include "mainwindow.h"
     #include "ui_mainwindow.h"
    #include "load.h"
    #include <QLCDNumber>

    MainWindow::MainWindow(QWidget *parent) :
        QMainWindow(parent),
        ui(new Ui::MainWindow)
    {
        ui->setupUi(this);
        MainWindow::startupLoad();
    }

    MainWindow::~MainWindow()
    {
        delete ui;
    }
    void MainWindow::startupLoad()
    {
        ui->roundPlayer_lcdNumber->display(Load::loadRoundsPlayed()); //right here
    } 
```

当我运行它时，我得到了那个错误。我不确定这意味着什么，所以如果有人可以帮助我，我将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-31T18:35:40.100

错误描述很清楚

**不能在没有对象的情况下调用成员函数'QString Load::loadRoundsPlayed()'**

如果不创建类的实例，就不能调用非静态的成员函数。

* * *

查看您的代码，您可能需要这样做：

```
Load load;
ui->roundPlayer_lcdNumber->display(load.loadRoundsPlayed()); //right here 
```

还有另外两个选项：

*   制作`loadRoundsPlayed`静态和`roundsPlayed`静态，如果您不希望它们与具体实例相关联或
*   制作`loadRoundsPlayed`静态并`QString`通过副本返回，这将在函数内部本地创建。就像是

：

```
QString Load::loadRoundsPlayed()
{
    QFile roundsFile(":/StartupFiles/average_rounds.dat");

    if(!roundsFile.open(QFile::ReadOnly | QFile::Text))
    {
        qDebug("Could not open average_rounds for reading");
    }

    QString lRoundsPlayed = roundsFile.readAll();
    roundsFile.close();
    return lRoundsPlayed;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-31T18:38:38.337

因为方法和成员不与类实例关联，所以将其设为静态：

```
class Load
{
private:
    static QString roundsPlayed;
public:
    Load();
    static QString loadRoundsPlayed();
}; 
```

如果您希望它们与实例相关联，则需要创建一个对象并在其上调用方法（在这种情况下不必`static`如此）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-31T18:43:08.917

在`Load::loadRoundsPlayed()`，你应该改变

```
Load::roundsPlayed = roundsFile.readAll(); 
```

到

```
this->roundsPlayed = roundsFile.readAll(); 
```

或者干脆

```
roundsPlayed = roundsFile.readAll(); 
```

这个特定示例不会修复编译器错误，但它说明了您在哪里对语法有一些混淆。当您在函数或变量名称前加上“Load::”时，您是在说您想要属于此类的字段。但是，类的每个对象都将拥有自己在其中声明的变量的副本。这意味着您需要先创建一个对象才能使用它们。同样，函数绑定到对象，因此您再次需要一个对象才能调用成员函数。

另一种选择是制作你的函数`static`，这样你就不需要一个对象来调用它。我强烈建议您了解类的实例函数和静态函数之间的区别，以便在需要时可以适当地使用这两个工具。

# vb.net - 使用 VB.NET 将公式写入 excel 单元格（此代码有什么问题？）

> ID：11746731
> 
> 赞同：0
> 
> 时间：2012-07-31T18:34:01.797
> 
> 标签：vb.net, excel, formula

我想从一个 Excel 工作簿的工作表中总结一个范围并将其写入另一个工作簿。我想出了以下代码，但它不起作用。

1）它打开一个文件打开窗口，要求我选择要更新的工作簿

2）选择工作簿后，它会写入“0”作为值。

代码：

```
Dim xl1 As New Excel.Application
Dim xl2 As New Excel.Application

Dim wb1 As Excel.Workbook
Dim wb2 As Excel.Workbook

Dim st1 As Excel.Worksheet
Dim st2 As Excel.Worksheet

wb1 = xl1.Workbooks.Open("F:\excelsumtest\file1.xlsx")
wb2 = xl2.Workbooks.Open("F:\excelsumtest\file2.xlsx")

st1 = wb1.Worksheets(1)
st2 = wb2.Worksheets(1)

st2.Cells(1, 1).formula = "=Sum(st1!A1:S1)" 
```

干杯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T18:41:21.810

尝试更改此行：

```
wb2 = xl2.Workbooks.Open("F:\excelsumtest\file2.xlsx")
'to this:
wb2 = xl1.Workbooks.Open("F:\excelsumtest\file2.xlsx") 
```

我将两个工作簿绑定到 Excel 应用程序的 1 个实例。这未经测试，但我认为通过这种方式，Excel 会理解它是您尝试插入的 xl1 工作簿中的工作表。

如果没有，您可能必须完全定义您在公式中引用的工作簿。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-10T06:22:10.587

这对我有用：

```
Dim xlsApp As New Microsoft.Office.Interop.Excel.Application 
xlsApp.DisplayAlerts = False 
```

# javascript - 如果不在第一个选项卡中，jQuery Accordion 会缩小 Google 图表

> ID：11746734
> 
> 赞同：1
> 
> 时间：2012-07-31T18:34:09.427
> 
> 标签：javascript, jquery, google-visualization

我有几个不同的[谷歌图表](https://developers.google.com/chart/)，我想把它们放在 jQuery 手风琴的各个部分中。问题是由于某种原因不在手风琴第一部分内的所有图表都较小。手风琴的某些东西正在缩小这些图表。我不希望他们缩小。有谁知道我可以做些什么来防止它们缩小？

请参阅说明问题的示例：http: [//jsfiddle.net/dN3LL/](http://jsfiddle.net/dN3LL/)

谢谢！

**编辑**

因此，根据brandwaffle提供的答案，我认为应该在div折叠成手风琴形式之前渲染图形，所以我只是`$('#accordion').accordion();`在图形完成渲染后立即放置线条，它可以工作！见小提琴：http: [//jsfiddle.net/dN3LL/4/](http://jsfiddle.net/dN3LL/4/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T18:37:41.530

过去，我曾因各种不同的内容而发生过这种情况。我认为问题的发生是因为内容是在折叠的容器中呈现的，所以它默认为尽可能小的尺寸（我在手风琴内部的灵活宽度 div 中也看到了这一点）。我可以为全面解决方案提供的最佳解决方案是将任何谷歌图表生成（或其他内容显示）挂钩到 jQueryUI 手风琴提供的手风琴变化事件：http: [//jqueryui.com/demos/accordion/](http://jqueryui.com/demos/accordion/)

如果您使用accordionchange 事件，Google Chart 将在手风琴切换到正确的部分后自行呈现，这应该可以消除由于图表试图呈现到压扁（即未打开的）容器中而导致的任何问题。对此可能有更好的 CSS 修复，但我还没有找到。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-04-25T17:46:17.923

一种解决方法是，首先加载图表，然后在图表加载完成后运行手风琴代码或在 1-2 秒后运行手风琴代码（setTimeout）

# ios - 如何在 Xcode 4.4 中将部署目标从 iOS 5.1 更改为 4.2

> ID：11746735
> 
> 赞同：2
> 
> 时间：2012-07-31T18:34:12.013
> 
> 标签：ios, xcode, xcode4.4

我正在尝试在 Xcode 4.4 中将部署目标从 5.1 更改为 4.2，但它不起作用

*   我下载了对 4.1-4.2 的调试支持
*   我将架构设置为 armv6 armv7
*   我在 plist armv6 armv7 中设置
*   我不使用故事板

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-31T18:46:23.923

这是一个[已知的错误](http://openradar.appspot.com/11889190)。XCode 4.4 不允许您针对 armv6 架构。你必须降级到 Xcode 4.3.3 才能做到这一点（学会了很难：-/）。您必须从 Apple 开发网站下载 4.3.3。

另外，请确保不要同时运行 4.4 和 4.3.3。我的 mac 半冻结了一个小时，直到我设法强行杀死这两个进程。

更新：此错误已在较新版本的 XCode 中修复。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T20:52:23.030

如果有人仍然受到此问题的影响，它似乎已得到修复。在 Xcode 4.4.1 中我没有这个问题。（具体来说，当我将架构设置为 armv6 armv7 时，我可以为运行 4.2 的 iPhone 3G 构建 - 我没有尝试其他组合。）

# java - Java - 绘制线条粗细为 1 的放大形状

> ID：11746738
> 
> 赞同：4
> 
> 时间：2012-07-31T18:34:28.973
> 
> 标签：java, scale, draw, shape, graphics2d

当您使用`Graphics2D.scale();`和绘制形状时，轮廓粗细也会被缩放。

有没有办法在不缩放线条粗细的情况下绘制它？除了使用上述函数之外，也许还有另一种有效的方法来扩展它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T18:44:34.407

[这个问题类似](https://stackoverflow.com/questions/2974178/cant-draw-thin-lines-with-java2d)。看起来您必须使用 Stroke 对象来设置正确的线宽。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T18:46:24.027

您将不得不将绘图保存为线向量列表，并以各种尺寸缩放和渲染绘图以保持所需的线条粗细。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-31T18:52:37.077

我刚刚找到了解决我自己问题的方法。我不知道它的效率如何，但它按预期工作：

```
Area area = new Area(myShape); //myShape is the shape I want to scale
AffineTransform at = new AffineTransform();
at.scale(2,2);
area = area.createTransformedArea(at);
graphics2d.draw(area); //graphics2d is the Graphics2D instance to do the drawing 
```

也许有人可以告诉我这是否是一个好方法？

# php - 存储加密密钥的安全方式 - PHP

> ID：11746743
> 
> 赞同：1
> 
> 时间：2012-07-31T18:35:10.750
> 
> 标签：php, mysql, encryption

我通过 PHP 使用 openssl 和 mysql 加密。目前，我在php源代码中编写了密钥，但我认为它不是那么安全。如果有人得到源（可能是 FTP），加密就会被破坏。那么，您将如何在 Linux 服务器上存储加密密钥？我不能使用另一个网络服务器来存储密钥。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T18:39:15.777

我假设您使用的是 Apache。

将秘密数据放入环境变量中`/etc/apache2/envvars`，将所有者设置为root，权限设置为400。

攻击者必须破坏服务器才能将他的手放在您的密钥上。

您还可以编写一个脚本，在 Apache 启动时询问密码（很烦人，但更安全）。

请注意，具有 root 访问权限的人将**始终**能够获取您的密钥，而试图向他们隐藏它只是一种安慰剂。

安慰剂溶液：

*   默认情况下使您的应用程序处于空闲状态，直到您将密钥发布到同一应用程序中的 HTTPS 页面，将密钥保存在全局变量中并继续您的业务。您必须考虑 PHP 进程的生命周期（当进程终止时，您必须重新发送密钥）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T18:54:24.460

我相信您最好的（根据您的问题和评论）的赌注是将密钥粘贴在目录空间的某个位置。确保它们不在 www-root 等之下。使用适当的文件权限（取决于您的服务器设置）。

# jquery - jQuery，带文本的向左滑动 div

> ID：11746747
> 
> 赞同：0
> 
> 时间：2012-07-31T18:35:30.863
> 
> 标签：jquery

我正在尝试将#text-slidein div 幻灯片从隐藏状态向左滑动。我一定尝试了所有变体，但无法让它发挥作用。

```
 $(document).ready(function() {
    $("#top-2").animate({
        "top": "0px"
    }, 1500, 'easeOutExpo');
    $("#btm-2").animate({
        "top": "0px"
    }, 1500, 'easeOutExpo', function() {
        $("#top-1").animate({
            "top": "0px"
        }, 1500, 'easeOutExpo');
        $("#btm-1").animate({
            "top": "0px"
        }, 1500, 'easeOutExpo', function() {
            $("#top-3").animate({
                "top": "0px"
            }, 1500, 'easeOutExpo');
            $("#btm-3").animate({
                "top": "0px"
            }, 1500, 'easeOutExpo', function() {
                $("#row-top").animate({
                    "top": "-25"
                }, 1000, 'easeOutExpo');
                $("#row-btm").animate({
                    "top": "25px"
                }, 1000, 'easeOutExpo');
                $("#text-slidein").animate({
                    width: 'toggle'
                }, 350, 1000, function() {
                    $(".fade").fadeOut(1000, function() {
                        $("#menu-nav").fadeIn(1000);
                        $("#news-box").fadeIn(1000);
                    });
                });
            });
        });
    });
}); 
```

我最接近滑块工作的是当我使用以下幻灯片功能时：

```
$("#text-slidein").show('slide', {direction: 'right'}, 2000, function(){ 
```

出于某种原因，使用此代码，滑块将工作一次，然后滑块不会显示，我所看到的只是一个用于滑入的空白区域。

```
$("#text-slidein").show('slide', {direction: 'right'}, 2000, function(){ 
```

我[在 jsfiddle 上有一个示例](http://jsfiddle.net/philoman/SPVXw/5/)

帮助将不胜感激。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T19:08:08.433

您在问题中发布的代码与您在 jsfiddle 中发布的代码不同，关于 jsfiddle 中的代码，问题是您正在调用

```
 $("#text-slidein").show('slide', {
                    direction: 'right'
                }, 2000, function() {
                    $(".fade").fadeOut(1000, function() {
                        $("#menu-nav").fadeIn(1000);
                        $("#news-box").fadeIn(1000);
                    });
                }); 
```

并且 show 的签名是特定于 jQueryUI 的，但没有引用 jQueryUI。当我检查 jQueryUI 它似乎工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T19:09:05.077

[**演示**](http://jsfiddle.net/AsJ2u/)

对您的代码进行了一些更改：

CSS：

```
#text-slidein {
    top: 260px;
    font-family: Arial, Helvetica, sans-serif;
    color: #888;
    font-size: 17px;
    padding: 15px 0;
    width: 0px;
    height:8px;
    position: absolute;
    overflow:hidden;
    margin-left:-800px
} 
```

jQuery：

```
 $("#text-slidein")
            .animate({
                width:800,
                marginLeft:0
          }, 2000, function() {
              $(".fade").fadeOut(1000, function() {
                  $("#menu-nav").fadeIn(1000);
                  $("#news-box").fadeIn(1000);
              });
          }); 
```

# c++ - c++中的有序多线程输出

> ID：11746756
> 
> 赞同：2
> 
> 时间：2012-07-31T18:36:25.400
> 
> 标签：c++, multithreading

在这个简单的例子中如何保证

```
 a->push_back(i) 
```

以线程启动的顺序发生？所以内容将是{1,2,3}。

```
#include <vector>
#include <thread>

void do_stuf(int i,std::vector<int> * a)
{
    //do very long stuff
    a->push_back(i);
}

int main()
{
    std::vector<int> tmp;
    std::thread t1(do_stuf,1,&tmp);
    std::thread t2(do_stuf,2,&tmp);
    std::thread t3(do_stuf,3,&tmp);

    t1.join();
    t2.join();
    t3.join();
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-31T18:49:32.457

一种方法是向线程传递一个指针或引用，指向您希望它们存储结果的位置（并确保它在线程生命周期内保持分配），如下所示：

```
void do_stuf(int i, int* a)
{
    //do very long stuff
    *a = i;
}

int main()
{
    std::vector<int> tmp(3);
    std::thread t1(do_stuf,1,&tmp[0]);
    std::thread t2(do_stuf,2,&tmp[1]);
    std::thread t3(do_stuf,3,&tmp[2]);

    t1.join();
    t2.join();
    t3.join();
} 
```

从您的示例中不清楚您要实现什么，但是您是否看过 std::promise 和 std::future 并弄清楚它们的作用？他们可能是你想要的。

（在这种情况下，vector::push_back 的问题在于它不是线程安全的。如果两个 push_backs 执行重叠，它可能会覆盖相同的元素，或者它可能会重新分配数组以移动所有元素的存储位置。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T18:45:31.080

对不起，我错过了“//做很长的事情”。如果在长动作结束时有一个特殊动作必须以特定顺序完成，您可以简单地将该代码放在 3 个线程的连接后面。

如果必须由该特定线程执行此操作，则可以使用受互斥锁和条件变量保护的共享计数器来表示该计数器已更改。更改计数器时，必须通知所有服务员，因为需要唤醒特定线程。在函数结束时，函数等待计数器具有特定于线程的值。第一个线程正在等待初始值，执行它的操作，递增计数器。第二个线程正在等待计数器成为第二个值等。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-31T18:42:20.693

你可以通过几种方式来解决这个问题。如果你不关心它们完成的顺序，只关心结果的顺序，推送一个带有任务 ID 及其结果的对象，然后按任务 ID 对对象进行排序，并在所有完成后打印。

如果您确实希望他们在上一个任务完成之前不报告，您需要等待上一个任务。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-07-31T18:42:15.303

当线程长进程按照调度顺序完成时，您可以有一个回调来“同步”推回。

旁注，如果您希望在多线程世界中使用 push_back，我将使用列表而不是向量，列表将保留除被删除元素之外的所有内容的迭代器...

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-07-31T18:42:47.650

正如所写，插入可以任意排序。为了确保您订购所需的订单，您基本上需要一个票务系统，其中线程睡眠/旋转直到请求他们的票号。在高层次上，这意味着您向每个线程传递了一条额外的信息（它的票号），具有一个全局共享值，即请求的票号 ID，并且线程代码具有一些确保不执行插入的代码直到全局 ID 等于本地编号。

# google-chrome - 在 Chrome 中使用 css 媒体查询调整窗口大小时浏览器闪烁白色

> ID：11746762
> 
> 赞同：3
> 
> 时间：2012-07-31T18:37:05.320
> 
> 标签：google-chrome, media-queries

在 Chrome 中调整浏览器窗口的大小时，使用单个 CSS 媒体查询声明时出现白色闪烁。如果我删除媒体查询，问题就会消失。有没有人遇到过这个问题？有解决方法吗？

我的媒体查询：

```
@media screen and (min-width: 1200px) {

    /* Styles go here */

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-01T01:13:17.327

经过一番研究并与其他几个人聊天后，我们能够找到解决此 webkit 错误的方法。为了修复白色闪光，我可以使用这些 CSS 声明：

```
-webkit-transform: translateZ(0);
-webkit-perspective: 1000; 
```

我还被告知这也可以绕过 webkit 错误：

```
-webkit-backface-visibility: hidden; 
```

我将这些声明应用于 body 标记，但它对您的工作方式可能不同，具体取决于您的网站。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-31T19:01:48.833

这可能是 chrome 中的一个已知问题。你用的是什么版本。似乎这是按照这个线程修复的；

[http://code.google.com/p/chromium/issues/detail?id=1373](http://code.google.com/p/chromium/issues/detail?id=1373)

# java - 检查数字和字母的密码

> ID：11746764
> 
> 赞同：2
> 
> 时间：2012-07-31T18:37:14.293
> 
> 标签：java, passwords

我的两种密码验证方法有问题。方法 hasDigitsAndLetters 应该检查字符串的所有字符是否都是数字和字母，第二种方法 hasTwoDigits 应该检查传递中是否至少有两个数字，但问题是对于预期的结果 true 他们是 ruturning错误的。如果有人可以提供帮助。这是代码。

```
//check if the whole string consists of digits and letters
    public static boolean hasDigitsAndLetters(String pass)
    {
        for(int i=0; i<pass.length(); i++)
        {
            if(!Character.isLetterOrDigit((i)))
            {
                return false;
            }

        }
        return true;
    }

    // check whether the password has at least 2 digits
    public static boolean hasTwoDigits(String pass)
    {
        int counter = 0;
        for(int i=0; i<pass.length(); i++)
        {
            if(Character.isDigit(i))
            {
                counter ++;
            }

        }
        System.out.println("Number of digits: " + counter);
        if(counter >= 2)
        {
            return true;
        }
        return false;
    } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-31T18:38:26.887

您需要在`i`该字符串的位置传递字符。

```
Character.isLetterOrDigit((pass.charAt(i))) 
```

数字也一样

```
Character.isDigit((pass.charAt(i))) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-31T18:40:22.527

现在您正在检查 i 是数字还是字母，并且 i 是 int。您需要检查位置 i 处的字符。

```
if(Character.isDigit(pass.charAt(i))) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-31T18:39:22.150

您想检查 index 处字符串中的字符`i`，而不是 index 变量本身：

```
Character.isLetterOrDigit(pass.charAt(i)) 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-31T18:39:30.733

您没有检查 中的字符`pass`，您需要将检查更改为：

```
if(!Character.isLetterOrDigit((pass.charAt(i))) 
```

和

```
if(Character.isDigit(pass.charAt(i))) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-31T18:53:28.807

错误是您将位置与字符串进行比较，而不是字符串*中*该位置的字符。但是，我可能不会使用`charAt`...... 在这里保持对职位的明确管理是没有意义的。我建议您改用[String.toCharArray](http://docs.oracle.com/javase/7/docs/api/java/lang/String.html#toCharArray%28%29)。

```
public static boolean isAlphanumeric(final String str) {
  for (char c : str.toCharArray()) {
    if (!Character.isLetterOrDigit(c)) {
      return false;
    }
  }
  return true;
}

public static boolean isBidigital(final String str) {
  int n = 0;
  for (char c : str.toCharArray()) {
    if (Character.isDigit(c)) {
      ++n;
    }
  }
  return n >= 2;
} 
```

# python - 需要帮助实施洪水填充算法

> ID：11746766
> 
> 赞同：10
> 
> 时间：2012-07-31T18:37:17.790
> 
> 标签：python, graphics, python-imaging-library

所以我正在尝试创建一个洪水填充算法，但我不断收到递归错误。该算法似乎具有无限递归，我无法确定原因。我浏览了整个互联网，但找不到解决方案，因为根据大多数消息来源，我的程序似乎是正确的。然而，似乎有什么不对劲。这是代码的编辑版本。错误消息仍然是最大递归。

我能得到一些帮助吗？

```
from PIL import Image, ImageTk
from random import *

w= 75
h= w

flood = Image.new("RGB", (w,h), (0,0,0))

x = 0
y = 0
count = 0

colorlist = []
i = 0

while x < w -1:
    y = 0
    while y < h-1:
        r = random()
        if r < .25:
            flood.putpixel((x,y), (0,0,0))
        else:
            flood.putpixel((x,y), (255,255,255))
        y += 1
    x += 1
x = 0
y = 0
while x < w-1:
    y = 0
    while y < h-1:
        r = random()
        if x == 0 or y == 0 or x == w-1 or y ==h-1:
            flood.putpixel((x,y), (0,0,0))
        y += 1
    x += 1

def floodfill(x,y, d,e,f, g,h,i, image, count):
        count+=1
        (a,b,c) = image.getpixel((x,y))
        if (a,b,c) == (255,255,255):
            (j,k,l) = image.getpixel((x-1,y))
            (m,n,o) = image.getpixel((x+1, y))
            (p,q,r) = image.getpixel((x,y-1))
            (s,t,u) = image.getpixel((x,y+1))
        if count > 990:
            return
        if (a,b,c) == (255,255,255):
            image.putpixel((x,y), (g,h,i))
            floodfill(x-1, y, d,e,f, g,h,i, image, count)
            floodfill(x+1, y, d,e,f, g,h,i, image, count)
            floodfill(x, y-1, d,e,f, g,h,i, image, count)
            floodfill(x, y+1, d,e,f, g,h,i, image,count)

floodfill(2,2, 0,0,0,255,0,0,flood, 0)

flood.save("flood.png")
print("done") 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-31T19:26:52.823

Python 倾向于抛出`maximum recursion depth exceeded`错误，即使算法不会无限递归并且最终会自行停止。有两种解决方案：增加递归限制，或切换到迭代算法。

您可以使用 提高递归限制`sys.setrecursionlimit`。选择一个高于算法最坏情况递归深度的数字。在您的情况下，这将是图像中的像素数，`length * height`.

将您的算法更改为迭代算法相当简单，因为您绘制像素的顺序并不重要，只要您至少获得一次即可。A`set`非常适合保存唯一的无序数据，所以让我们用它来存储我们需要绘制的像素。

```
def floodFill(x,y, d,e,f, g,h,i, image):
    toFill = set()
    toFill.add((x,y))
    while not toFill.empty():
        (x,y) = toFill.pop()
        (a,b,c) == image.getpixel((x,y))
        if not (a,b,c) == (255, 255, 255):
            continue
        image.putpixel((x,y), (g,h,i))
        toFill.add((x-1,y))
        toFill.add((x+1,y))
        toFill.add((x,y-1))
        toFill.add((x,y+1))
    image.save("flood.png") 
```

如果您确实使用迭代方法，请务必在其中进行绑定检查。否则，它可能会永远运行！或者至少在您的硬盘驱动器被一`toFill`组巨大的驱动器填满之前。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-31T19:21:13.173

[为什么不以深度优先的](http://en.wikipedia.org/wiki/Depth-first_search)方式进行泛洪填充，而不是递归呢？递归无论如何都使用隐式堆栈，所以你没有什么可失去的。

是的，正如评论中指出的那样，您应该检查 x 和 y 是否超出范围。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-31T19:32:48.647

这尚未经过测试，但主要基于您提供的代码。`floodfill`它应该可以工作并提供实现算法的替代方法。该功能可能会更有效。

```
import PIL
import random
import collections

WHITE = 255, 255, 255
BLACK = 0, 0, 0
RED = 255, 0, 0

def main(width, height):
    flood = PIL.Image.new('RGB', (width, height), BLACK)
    # Create randomly generated walls
    for x in range(width):
        for y in range(height):
            flood.putpixel((x, y), BLACK if random.random() < 0.15 else WHITE)
    # Create borders
    for x in range(width):
        for y in range(height):
            if x in {0, width - 1} or y in {0, height - 1}:
                flood.putpixel((x, y), BLACK)
    floodfill(50, 25, RED, image)
    # Save image
    image.save('flood.png')

def floodfill(x, y, color, image):
    # if starting color is different from desired color
    #     create a queue of pixels that need to be changed
    #     while there are pixels that need their color changed
    #         change the color of the pixel to what is desired
    #         for each pixel surrounding the curren pixel
    #             if the new pixel has the same color as the starting pixel
    #                 record that its color needs to be changed
    source = image.getpixel((x, y))
    if source != color:
        pixels = collections.deque[(x, y)]
        while pixels:
            x, y = place = pixels.popleft()
            image.putpixel(place, color)
            for x_offset in -1, 1:
                x_offset += x
                for y_offset in -1, 1:
                    y_offset += y
                    new_place = x_offset, y_offset
                    if image.getpixel(new_place) == source:
                        pixels.append(new_place)

if __name__ == '__main__':
    main(100, 50) 
```

# c++ - windows下使用sqlite

> ID：11746768
> 
> 赞同：2
> 
> 时间：2012-07-31T18:37:21.597
> 
> 标签：c++, sqlite, qt, static-libraries

我正在用 Qt 和 sqlite 开发一个应用程序。在 Linux 下工作时我没有遇到任何问题，但现在我必须切换到 Windows 一段时间，而且我遇到了一个简单的问题。

我已经下载了 sqlite 源代码，并将其与 Qt 一起编译为静态库。作为输出，我有三个文件`libsqlite.a`：`shell.o`和`sqlite3.o`. 我坚信这`libsqlite.a`是我的静态库。

现在，我想在我的项目中使用它。在项目目录中，我创建了一个名为 的文件夹`sqlite`，并将文件放入其中。

之后，我试图将库添加到我的项目中。在`.pro`文件中，我添加了这个：

```
LIBS += -L"/sqlite" -l"libsqlite" 
```

但是，我不断收到错误消息：

```
cannot find -llibsqlite 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-31T19:10:07.113

“lib”前缀必须省略。

使用

```
-lsqlite 
```

链接器指令。

PS 另一个可行的选择是将 SQLite 的源代码直接包含到您的项目中。有一个 SQLite“合并”包（仅`sqlite3.c`和`sqlite3.h`文件）。

# string - perl 内插代码

> ID：11746769
> 
> 赞同：3
> 
> 时间：2012-07-31T18:37:27.040
> 
> 标签：string, perl, interpolation

我知道在 perl 中，您可以通过简单地执行以下操作来插入标量：

```
"This is my $string" 
```

但是，我想知道是否有一种方法可以插入要评估的实际 perl 代码？使用 ruby​​ 字符串可以看出我想要什么：

```
"5 + 4 = #{5 + 4}" 
```

它将评估`{}`.

有谁知道在 perl 中执行此操作的方法？谢谢！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-31T18:43:08.703

您可以使用以下技巧：

```
"5 + 4 = @{[ 5 + 4 ]}" 
```

或者，您可以使用[`sprintf`](http://perldoc.perl.org/functions/sprintf.html)：

```
sprintf("5 + 4 = %d", 5 + 4); 
```

这些中的任何一个都会产生所需的字符串。可以说，`sprintf`它比第一个更安全，因为您可以在一定程度上限制插值的类型。然而，第一个在精神上更接近你的愿望。

### 进一步阅读：

*   [为什么 Perl 在字符串插值期间评估 ${...} 中的代码？](https://stackoverflow.com/q/2332815/79061)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-31T18:58:59.407

如果你想在字符串中插入计算，你可以做 3 件事：

1.  使用`@{[]}`. 在第三个括号内，放置您想要的任何表达式。

2.  使用`${\ do {}}`. 将您的表达式放在第二个大括号内。

3.  使用简单的字符串连接: `$targetstring = "$string1".func()."$string2"`，其中`func()`将包含动态内容。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-31T18:44:14.723

```
print "5 + 4 = ", 5 + 4; 
```

只需将其移到引号之外。强迫它在引号内有什么意义吗？

您可以使用 进行更多格式化`printf`，例如：

```
printf "5 + 4 = %s\n", 5 + 4; 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-07-31T18:40:07.223

您可以使用`eval`：

```
eval('$a = 4 + 5'); 
```

请注意，`eval`应该谨慎使用，它非常不安全。

# c++ - 使用线程取消搜索

> ID：11746770
> 
> 赞同：0
> 
> 时间：2012-07-31T18:37:28.680
> 
> 标签：c++, multithreading

我是多线程的新手。我在 unix 上使用 c++。

在下面的代码中，runSearch() 需要很长时间，我希望能够在“cancel == true”后立即终止搜索。函数 cancelSearch 由另一个线程调用。

解决此问题的最佳方法是什么？

谢谢..

------------------这是现有的代码-------------------------

```
 struct SearchTask : public Runnable
    {
        bool cancel = false;

        void cancelSearch()
        {
           cancel = true;
        }

        void run()
        {
            cancel = false;
            runSearch();
            if (cancel == true)
            {
                return;
            }
            //...more steps.
        }
    } 
```

编辑：为了更清楚，说 runSearch() 需要 10 分钟才能运行。1 分钟后，cancel==true，然后我想立即退出 run()，而不是再等 9 分钟让 runSearch() 完成。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T18:40:24.247

您需要在整个搜索操作过程中不断检查标志。像这样的东西：

```
 void run()
    {
        cancel = false;            
        while (!cancel)
        {
            runSearch();
            //do your thread stuff...
        }
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-31T19:07:37.860

您提到您不能修改 runSearch()。使用 pthreads 有一个`pthread_setcancelstate()`函数，但是我不认为这是安全的，尤其是对于需要 RAII 语义的 C++ 代码。

安全线程取消*必须是合作*的。被取消的代码必须知道取消并且能够自行清理。如果代码不是为此而设计的并且只是被终止，那么您的程序可能会表现出未定义的行为。

出于这个原因，C++ 的 std::thread 不提供任何线程取消方法，而是必须使用其他答案所示的显式取消检查来编写代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-31T19:04:18.157

基本上你必须轮询`cancel`各处轮询标志。您可以使用其他技巧，但它们更特定于平台，例如线程取消，或者不像中断那样通用。

并且`cancel`需要是一个原子变量（例如在 std::atomic 中，或者只是用互斥锁保护它）否则编译器可能只是将值缓存在寄存器中而看不到来自另一个线程的更新。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-31T18:45:51.327

创建一个接受动作/委托的通用方法。让每一步都非常小而具体。向通用方法发送您认为是“步骤”的委托/操作。在通用方法中检测取消是否为真，如果为真则返回。因为如果取消步骤很小，线程应该不会花很长时间就死掉。

这是我可以给出的最好的建议，而无需任何步骤的代码。

另请注意：

```
 void run()
{
    cancel = false;
    runSearch();
    while (!cancel)
    {
        //do your thread stuff...
    }
} 
```

不起作用，因为如果您正在做的不是迭代，它将在检查！取消之前运行整个线程。就像我说的那样，如果您可以添加有关这些步骤的更多详细信息，那么向您提供建议会更容易。在处理要停止或终止的线程时，最好的办法是将代码拆分为非常小的步骤。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-31T19:27:13.280

阅读响应是正确的 - 仅仅因为您在线程中调用了阻塞函数并不意味着它神奇地变成了非阻塞调用。该线程可能不会中断程序的其余部分，但它仍然必须等待 runSearch 调用完成。

好的，所以有一些方法可以解决这个问题，但它们不一定可以安全使用。

你可以明确地杀死一个线程。在 Windows 上，您可以使用[TerminateThread](http://msdn.microsoft.com/en-us/library/windows/desktop/ms686717%28v=vs.85%29.aspx) () 来终止线程执行。听起来不错吧？好吧，除了使用起来非常危险——除非你确切地知道所有资源和调用在被杀死的线程中发生了什么，否则你可能会发现自己的应用程序在下一次拒绝正常工作。例如，如果 runSearch 打开一个数据库连接，则 TerminateThread 调用不会关闭它。这同样适用于内存、加载的 dll 以及它们使用的所有内容。它旨在杀死完全无响应的线程，因此您可以关闭程序并重新启动它。

鉴于上述情况以及您不使用它的强烈建议，下一步是以外部方式调用 runSearch - 如果您在单独的进程中运行阻塞调用，则可以更确定地终止该进程你不会搞砸其他一切。进程死了，清除它的内存、它的堆、任何加载的 dll，一切。所以在你的线程中，调用 CreateProcess 并等待句柄。您需要在 IPC 上使用某种表格（最好不要使用共享内存，因为在您终止进程时重置它可能会很麻烦）将结果传输回您的主应用程序。如果您需要终止此进程，请在其句柄上调用[ExitProcess （或](http://msdn.microsoft.com/en-us/library/windows/desktop/ms682658%28v=vs.85%29.aspx)[退出](http://linux.about.com/library/cmd/blcmdln_exit.htm)在 Linux 中）请注意，这些退出调用需要在进程内调用，因此您需要在进程内运行一个线程以进行阻塞调用。您可以在外部终止一个进程，但同样危险 - 不像杀死一个线程那么危险，但您仍然可以偶尔绊倒。（为此使用[TerminateProcess](http://msdn.microsoft.com/en-us/library/windows/desktop/ms686714%28v=vs.85%29.aspx)或[kill](http://linux.die.net/man/1/kill)）

# apache - 为什么我在 Web 服务器上看到目录结构而不是默认索引页面？

> ID：11746771
> 
> 赞同：-4
> 
> 时间：2012-07-31T18:37:40.677
> 
> 标签：apache, configuration

我正在开发一个 Java 应用程序，我必须在其中集成一个 Perl 应用程序的代码。该服务已在 CGI 服务器上提供。

当我将 Perl 文件复制到服务器位置时，应该自动调用索引文件。但是当我测试那个 URL 时，它显示的是目录结构，而不是默认的索引页面。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T19:25:14.483

[您可以使用Apache 文档](http://httpd.apache.org/docs/2.2/mod/mod_dir.html#directoryindex)中描述的 DirectoryIndex 指令更改 Apache 的默认目录列表功能

因此，如果您希望 myprog.pl 运行，而不是查看目录索引，那么您需要一个类似于以下内容的指令：

```
 DirectoryIndex myprog.pl 
```

您的确切指令将相似，但可能因文件路径而异。

# c# - 如何正确对齐 xaml 网格

> ID：11746777
> 
> 赞同：0
> 
> 时间：2012-07-31T18:37:56.293
> 
> 标签：c#, asp.net, wpf, xaml

HI 这个视图需要右对齐，当前是左对齐，需要哪个命令使它右对齐。？

```
<GridViewColumn DisplayMemberBinding="{Binding Unit}"
                                Header="Nursing Unit"
                                Width="70" />
                <GridViewColumn DisplayMemberBinding="{Binding Day}"
                                Header="Day"
                                Width="55" />
                <GridViewColumn DisplayMemberBinding="{Binding Eve}"
                                Header="Eve"
                                Width="55" />
                <GridViewColumn DisplayMemberBinding="{Binding Night}"
                                Header="Night"
                                Width="55" /> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T18:47:10.967

将 Grid 属性 FlowDirection 设置为“RightToLeft”。

# magento - 我在哪里可以找到参考名称以找出将我的块放在哪里？

> ID：11746779
> 
> 赞同：0
> 
> 时间：2012-07-31T18:38:12.170
> 
> 标签：magento

例如，我想将我的块放在产品页面上的描述块之前。我将如何找到这些参考名称？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T18:43:14.387

在 Magento 控制面板中将您设置`Current Configuration Scope`为特定网站。然后，在系统 -> 配置 -> 高级 -> 开发人员 -> 调试下打开模板路径提示并将块名称添加到提示。

之后，当您重新加载页面时，它会告诉您要覆盖哪些块以获得所需的效果。

![开发人员面板（选择特定网站范围后）](../Images/fdc9e61e6bf392bc41b98ae30d502b16.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-31T19:10:59.677

如果我理解正确，根据您的问题和随后的评论，您正在寻找一种将块放置在布局中其他块之前的方法？

如果是这样，布局系统会为您提供块之前和之后的属性，正是为了这个目的。

一般用途是添加一个 before 或 after 属性，其中包含您要定位的块 - before 或 after。

**示例之前**

```
<block type="yourmodule/block_type" name="yourblock" before="the_block_name_to_position_before" /> 
```

**示例之后**

```
<block type="yourmodule/block_type" name="yourblock" after="the_block_name_to_position_before" /> 
```

**位于产品描述之前**

在您的特定场景中，您希望在产品描述块之前放置一个块，由于产品描述块如何包含在布局中，您需要一些额外的 xml：

```
<!-- file: app/design/frontend/your_package/your_theme/layout/local.xml -->
<catalog_product_view>
    <reference name="product.info">
        <block type="yourmodule/block_type" name="yourblock" template="yourmodule/template.phtml" before="product.description">
            <action method="addToParentGroup"><group>detailed_info</group></action>
        </block>
    </reference>
</catalog_product_view> 
```

不过，就您最初的问题而言，这里要注意的重要一点是使用`before`属性进行定位。

# mysql - 禁用mysql缓存

> ID：11746780
> 
> 赞同：2
> 
> 时间：2012-07-31T18:38:14.743
> 
> 标签：mysql, caching

我需要禁用 mysql 查询缓存以测试查询速度。我已经尝试了以下但没有成功

1.  从表中选择 SQL_NO_CACHE col1、col2
2.  将配置变量 query_cache_size 设为 0 并将 'query_cache_type' 设为 OFF，因此所有 qcache 变量都显示为零 SHOW STATUS LIKE '%qcache%'；
    Qcache_free_blocks 0 Qcache_free_memory 0 Qcache_hits 0 Qcache_inserts 0 Qcache_lowmem_prunes 0 Qcache_not_cached 0 Qcache_queries_in_cache 0 Qcache_total_blocks 0

3.使用了'reset query cache'、'flush query cache'、flush tables；也是，但我的查询仍然比第一次运行得更快，这意味着它正在缓存。

4.所有 qcache 变量始终保持为零。我错过了什么？请帮忙。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-31T18:44:38.637

您观察到相同查询的后续执行运行得更快并不一定意味着查询结果正在被缓存，或者查询的后续执行正在从查询缓存中返回。

可能是在第一次执行查询时，必须访问的索引和/或数据块不在 InnoDB 缓冲池或 MyISAM 键缓存中，而必须从磁盘中检索。这些块将保留在 InnoDB 缓冲池和 MyISAM 键缓存中，完全独立于 MySQL 查询缓存。如果这些块仍在内存中，则对这些块的后续访问可以更快地返回。

* * *

通常，您不希望从 InnoDB 缓冲池或 MyISAM 键缓存中刷新块来衡量性能。相反，您希望多次运行查询，并浪费第一次执行的时间。

如果您想在 InnoDB 缓冲池或 MyISAM 键缓存中没有块开始，则关闭并重新启动 MySQL 服务器。

但即使这些块不在 InnoDB 缓冲池或 MyISAM 密钥缓存中，这些块很可能仍然在 OS 文件系统缓存的“内存”中。因此，为了确保您从磁盘读取块，您还需要刷新 OS 文件系统缓存。

* * *

以下是关于 Oracle 的 Tom Kyte (AskTom) 文章的摘录，但同样的推理也适用于其他 RDBMS 系统（包括 MySQL）。

[http://www.oracle.com/technetwork/issue-archive/o43asktom-094944.html](http://www.oracle.com/technetwork/issue-archive/o43asktom-094944.html)

刷新缓存

**问：**有没有办法刷新[缓冲区缓存]？...这对于一个接一个地尝试几种方法的调整练习很重要，但我们希望在不重新启动数据库的情况下减少缓冲区中预先存在的块的影响。

**答：**实际上，重要的是调优工具不能这样做。重要的是运行测试，忽略结果，然后运行两到三遍并平均这些结果。在现实世界中，缓冲区缓存永远不会没有结果。绝不。调整时，您的目标是减少逻辑 I/O (LIO)，因为这样物理 I/O (PIO) 将自行处理。

考虑一下：刷新共享池和缓冲区缓存比不刷新它们更加人为。我怀疑，大多数人似乎对此持怀疑态度，因为它违背了传统智慧。我将向您展示如何执行此操作，但不是为了让您可以将其用于测试。相反，我将用它来证明为什么它是徒劳的，完全是人为的（因此会导致错误的假设）。我刚刚启动了我的电脑，我已经对一个大表运行了这个查询。我“刷新”缓冲区缓存并再次运行它：

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T19:14:08.610

这是在Linux上吗？还可以尝试刷新 OS 磁盘缓存：

```
$ sync && sysctl -w vm.drop_caches = 3 
```

看到[这个帖子](https://stackoverflow.com/questions/11448952/benchmark-mysql-on-ssd-tools-and-strategies/11742722#11742722)

# objective-c - mapView 到 detailView 使用 plist

> ID：11746783
> 
> 赞同：0
> 
> 时间：2012-07-31T18:38:33.577
> 
> 标签：objective-c, ios, mkmapview, mapkit, mkannotation

我目前正在使用 plist 在地图上放置注释，我已经设法做到这一点，但我现在在尝试从地图视图转到详细视图并从 plist 携带信息时遇到问题。

我已经设置了 plist，因此它在地图视图中具有标题和副标题，然后我设置了一个孩子，这将转到我试图在详细视图中访问的信息。

我已经设法使它进入详细视图，但它不包含任何信息，因为我无法计算出执行此操作所需的代码。

我希望这一切都有意义，因为我自己有点困惑。感谢您对此的任何帮助，您将成为救生员（有点）

这是代码

BrewMapViewController.h

```
#import <UIKit/UIKit.h>
#import <MapKit/MapKit.h>

@interface BrewMapViewController : UIViewController <MKMapViewDelegate> {
    IBOutlet MKMapView *map;
    NSInteger CurrentLevel;
    NSString *CurrentTitle;
    NSArray *breweries;
}

@property (nonatomic, retain) NSArray *breweries;
@property (nonatomic, readwrite) NSInteger CurrentLevel;
@property (nonatomic, retain) NSString *CurrentTitle;
@end 
```

BrewMapViewController.h

```
#import "BrewMapViewController.h"
#import "BrewMapAppDelegate.h"
#import "MyAnnotation.h"
#import "ViewController2.h"

@implementation BrewMapViewController

@synthesize breweries, CurrentLevel, CurrentTitle;

// Implement viewDidLoad to do additional setup after loading the view, typically from a nib.
- (void)viewDidLoad {
    [super viewDidLoad];

    NSArray *tempArray = [[NSArray alloc] init];
    self.breweries = tempArray;

    BrewMapAppDelegate *AppDelegate = (BrewMapAppDelegate *)[[UIApplication sharedApplication] delegate];

    self.breweries = [AppDelegate.data objectForKey:@"Hull"];
    //breweries = [[NSArray alloc] initWithContentsOfFile:[[NSBundle mainBundle] 
                                                        // pathForResource:@"test" 
                                                        // ofType:@"xml"]];

    double minLat = [[breweries valueForKeyPath:@"@min.latitude"] doubleValue];
    double maxLat = [[breweries valueForKeyPath:@"@max.latitude"] doubleValue];
    double minLon = [[breweries valueForKeyPath:@"@min.longitude"] doubleValue];
    double maxLon = [[breweries valueForKeyPath:@"@max.longitude"] doubleValue];

    MKCoordinateRegion region;
    region.center.latitude = (maxLat + minLat) / 2.0;
    region.center.longitude = (maxLon + minLon) / 2.0;
    region.span.latitudeDelta = (maxLat - minLat) * 1.05;
    region.span.longitudeDelta = (maxLon - minLon) * 1.05;
    map.region = region;

    for (NSDictionary *breweryDict in breweries){
        MyAnnotation *annotation = [[MyAnnotation alloc] initWithDictionary:breweryDict];
        [map addAnnotation:annotation];

        [annotation release];
    }
    if(CurrentLevel == 0) {
        self.navigationItem.title = @"Map";
    }
    else {
        //self.navigationItem.title = CurrentTitle; 

}

}

- (MKAnnotationView *)mapView:(MKMapView *)mapView viewForAnnotation:(id <MKAnnotation>)annotation{

    if (map.userLocation == annotation){
        return nil;
    }

    NSString *identifier = @"MY_IDENTIFIER";

    MKAnnotationView *annotationView = [map dequeueReusableAnnotationViewWithIdentifier:identifier];
    if (annotationView == nil){
        annotationView = [[[MKAnnotationView alloc] initWithAnnotation:annotation 
                                                       reuseIdentifier:identifier] 
                          autorelease];
        annotationView.image = [UIImage imageNamed:@"beer.png"];

        annotationView.canShowCallout = YES;
        annotationView.rightCalloutAccessoryView = [UIButton buttonWithType:UIButtonTypeDetailDisclosure];

        annotationView.leftCalloutAccessoryView =  [[[UIImageView  alloc] initWithImage:[UIImage imageNamed:@"pretzel.png"]] autorelease];

    }
    return annotationView;
}

- (void)mapView:(MKMapView *)mapView annotationView:(MKAnnotationView *)view calloutAccessoryControlTapped:(UIControl *)control
{
    NSLog(@"tapped");
    ViewController2 *dvController = [[ViewController2 alloc] initWithNibName:@"ViewController2" bundle:[NSBundle mainBundle]];
    [self.navigationController pushViewController:dvController animated:YES];

}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    return YES;
}

- (void)dealloc {
    [breweries release];
    [map release];
    [super dealloc];
}

@end 
```

列表

```
<plist version="1.0">
<dict>
<key>Hull</key>
    <array>
    <dict>
        <key>name</key>
        <string>Wynkoop Brewery</string>
        <key>address</key>
        <string>1634 18th St., Denver, Co 80902</string>
        <key>latitude</key>
        <real>39.753259</real>
        <key>test</key>
        <string>beer.png</string>
        <key>longitude</key>
        <real>-104.99818</real>
        <key>Children</key>
        <array>
            <dict>
                <key>Title</key>
                <string>Testing</string>
            </dict>
        </array>
    </dict>
    <dict>
        <key>name</key>
        <string>Great Divide Brewing</string>
        <key>address</key>
        <string>2201 Arapahoe Street, Denver, CO 80205</string>
        <key>latitude</key>
        <real>39.753486</real>
        <key>longitude</key>
        <real>-104.988736</real>
        <key>Children</key>
        <array>
            <dict>
                <key>Title</key>
                <string>Testing2</string>
            </dict>
        </array>
    </dict>
    <dict>
        <key>name</key>
        <string>Rock Bottom</string>
        <key>address</key>
        <string>1001 16th Street Denver, CO 80265</string>
        <key>latitude</key>
        <real>39.747186</real>
        <key>longitude</key>
        <real>-104.995037</real>
        <key>Children</key>
        <array>
            <dict>
                <key>Title</key>
                <string>Testing3</string>
            </dict>
        </array>
    </dict>
    <dict>
        <key>name</key>
        <string>Brekenridge Brewery</string>
        <key>address</key>
        <string>471 Kalamath Street, Denver, Colorado 80204</string>
        <key>latitude</key>
        <real>39.723629</real>
        <key>longitude</key>
        <real>-105.000237</real>
        <key>Children</key>
        <array>
            <dict>
                <key>Title</key>
                <string>Testing4</string>
            </dict>
        </array>
    </dict>
</array>

</dict>
</plist> 
```

再次感谢您对此的任何帮助，这将非常有帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T19:05:06.627

我假设`MyAnnotation`该类包含有关您需要的注释的所有信息。
它来自 plist 的事实在这一点上无关紧要。

首先，在 中`ViewController2`，为注解添加一个属性：

```
@property (nonatomic, retain) MyAnnotation *annotation; 
```

接下来，在`calloutAccessoryControlTapped`委托方法中，设置属性：

```
- (void)mapView:(MKMapView *)mapView annotationView:(MKAnnotationView *)view calloutAccessoryControlTapped:(UIControl *)control
{
    NSLog(@"tapped");
    ViewController2 *dvController = [[ViewController2 alloc] initWithNibName:@"ViewController2" bundle:[NSBundle mainBundle]];

    dvController.annotation = (MyAnnotation *)view.annotation;

    [self.navigationController pushViewController:dvController animated:YES];
} 
```

在`ViewController2`中，您现在可以使用该`annotation`属性来配置显示。

# jquery - 让 jQuery 的 scrollLeft 工作

> ID：11746789
> 
> 赞同：0
> 
> 时间：2012-07-31T18:38:49.177
> 
> 标签：jquery, scroll

早上好，

我在根据其父级的 scrollLeft 值获取左右动画时遇到问题。

`.section`在里面`.container`，并且当`.container`滚动离开屏幕时，`.section`应该根据 的`scrollLeft`值留在屏幕上`.container`。

我已经设置了一个`.show-me`div 来向自己展示应该将什么设置`left`为`.section`. 它显示了正确的滚动偏移量，当我`left`在 Chrome 中使用 Inspect Element 更改值时，`.section`移动到正确的位置。

但他们不能一起工作。关于发生了什么的任何线索？

我已经尝试了这两种方法：

```
$('.container').scroll(function() {
    offset = $(".container").scrollLeft();
    $(".section").css("left",offset+"px !important");
    $(".show-me").text(offset+"px !important");
}); 
```

和

```
setInterval(function(){
    offset = $(".container").scrollLeft();
    $(".section").css("left",offset+"px !important");
    $(".show-me").text(offset+"px !important");
},1); 
```

而且似乎都不适合我。帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T18:43:25.563

您的问题可能在第一行，您的选择器在开头`$('container')`缺少 a 。`.`我想应该是`$('.container')`。您尝试将滚动事件侦听器应用于不存在的元素。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T19:18:57.723

我已经想通了。

当我`!important`关闭 CSS 属性时它会起作用。我不确定为什么会这样，但确实如此。

谢谢你的回答，克里斯托弗！

# iphone - 如何使用 ARC 在 xcode 中发送邮件

> ID：11746791
> 
> 赞同：-2
> 
> 时间：2012-07-31T18:38:57.973
> 
> 标签：iphone, objective-c, xcode, ipad, frameworks

好的，在网上找到了几个教程。一切都很好，除非按下按钮。我按下将发送电子邮件的按钮，突然有一个信号中止。我观看了两个视频，并在每个视频中重新输入了每个代码两次。为什么会出现信号中断？请帮忙。谢谢！

这是.h文件

```
#import <UIKit/UIKit.h>
#import <QuartzCore/QuartzCore.h>
#import <MessageUI/MFMailComposeViewController.h>

@interface secondViewController : UIViewController <MFMailComposeViewControllerDelegate> {

    IBOutlet UILabel *resultLabel;
}
-(IBAction)switchToFirst:(id)sender;
-(IBAction)openMail:(id)sender;

@end 
```

这是 .m 文件

```
#import "secondViewController.h"
#import "ViewController.h"

@interface secondViewController ()

@end

@implementation secondViewController

-(IBAction)openMail:(id)sender {

    MFMailComposeViewController *composer = [[MFMailComposeViewController alloc] init];
    [composer setMailComposeDelegate:self];
    if ([MFMailComposeViewController canSendMail]) {
        [composer setToRecipients:[NSArray arrayWithObjects:@"", nil]];
        [composer setSubject:@""];
        [composer setMessageBody:@"message" isHTML:YES];
        [composer setModalTransitionStyle:UIModalTransitionStylePartialCurl];
        [self presentModalViewController:composer animated:YES];
    }
    else {

        UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"ERROR" message:@"Can't send your email!" delegate:self cancelButtonTitle:@"Okay" otherButtonTitles:nil, nil];
        [alert show];

    }

}

-(void)mailComposeController:(MFMailComposeViewController *)controller didFinishWithResult:(MFMailComposeResult)result error:(NSError *)error {
    switch (result) {
        case MFMailComposeResultSent:
            resultLabel.text = @"Mail was sent";
            break;

        case MFMailComposeResultSaved:
            resultLabel.text = @"Mail was saved to drafts";
            break;

        case MFMailComposeResultFailed:
            resultLabel.text = @"Mail wasn't able to sent";
            break;

        case MFMailComposeResultCancelled:
            resultLabel.text = @"Mail was Cancelled";
            break;

    }

    [self dismissModalViewControllerAnimated:YES];
}

-(IBAction)switchToFirst:(id)sender {
    ViewController *second = [[ViewController alloc] initWithNibName:nil bundle:nil];
    [self presentModalViewController:second animated:YES];

}

- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
    if (self) {
        // Custom initialization
    }
    return self;
}

- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view from its nib.
    // Set the background image by setting the contents of the view's layer
    UIImage *bg = [UIImage imageNamed:@"iPad iDeaf Assisstant Background.png"];
    self.view.layer.contents = (id) [bg CGImage];

}

- (void)viewDidUnload
{
    [super viewDidUnload];
    // Release any retained subviews of the main view.
    // e.g. self.myOutlet = nil;
}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    return (interfaceOrientation == UIInterfaceOrientationPortrait);
}
@end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T18:45:07.767

如果你有一个用于发送电子邮件的类，你可以在没有 arc 的情况下编译它，只需在项目设置 -> 构建阶段为文件设置标志**-fno-objc-arc**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T19:10:19.513

就像@qegal 说的那样，把所有的`retains`和`releases.`

如果你想保留你拥有的代码，你可以将文件标记为非弧。

要将**任何文件**标记为非弧，您可以在构建阶段设置编译器标志。在左侧的文件窗格中选择您的项目。然后选择您的目标，进入构建阶段，双击您要标记的文件的**编译器标志下方的列，然后输入“fno-objc-arc”。**

# c++ - Windows 中的 SOCK_PACKET

> ID：11746799
> 
> 赞同：1
> 
> 时间：2012-07-31T18:39:38.490
> 
> 标签：c++, c, windows, network-programming

在 Windows 中有 SOCK_PACKET 的替代品吗？
我正在尝试构建一个没有像 winpcap 这样的库的 arp 数据包。
谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T19:31:43.420

您可以使用原始套接字：`SOCK_RAW`. 但是，在发送 ARP 数据包时，您可能需要`AF_PACKET`（地址族，而不是套接字类型）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-01T04:01:18.713

Windows 具有[`SendARP()`](http://msdn.microsoft.com/en-us/library/windows/desktop/aa366358.aspx)发送 ARP 请求的功能。

# objective-c - EXC_BAD_ACCESS 滚动表视图

> ID：11746801
> 
> 赞同：0
> 
> 时间：2012-07-31T18:39:44.170
> 
> 标签：objective-c, ios

当我滚动我的 TableView 时，我得到了 EXC_BAD_ACCESS。我听说像 alloc 这样的东西被称为错误，我不知道。这是我的代码：

```
 -(NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section {
            return [[resultsDictionary objectForKey: @"bills"] count];
        }

        - (UITableViewCell *)tableView:(UITableView *)tableView 
                 cellForRowAtIndexPath:(NSIndexPath *)indexPath {

            // Identifier for retrieving reusable cells.
            static NSString *cellIdentifier = @"MyCellIdentifier";

            // Attempt to request the reusable cell.
            UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:cellIdentifier];

            // No cell available - create one.
            if(cell == nil) {
                cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleSubtitle 
                                              reuseIdentifier:cellIdentifier];
            }

            NSArray *billsArray = [resultsDictionary objectForKey:@"bills"];

            cell.textLabel.text = [NSString stringWithFormat:@"%@", [[billsArray objectAtIndex:indexPath.row] objectForKey:@"name"]];

            return cell;
        } 
```

**编辑**

我认为错误在这里：

*** -[JKArray objectAtIndex:]: 消息发送到释放的实例 0x6a5d030

```
NSString *cellName = [NSString stringWithFormat:@"%@", [[billsArray objectAtIndex:indexPath.row] objectForKey:@"name"]]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T18:47:58.707

它看起来像`resultsDictionary`一个悬空指针。如果您使用 ARC，则需要在某处对其进行强引用。如果您不使用 ARC，则需要将其保留在某个地方。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T20:17:21.267

固定的。我的 billsArray 缺少 'self' 实例，就像在 cellForRowAtIndexPath 方法中一样。谢谢大家。

# sql - 比较两个表中的列时，SQL 'NOT IN' 运算符未给出预期结果

> ID：11746802
> 
> 赞同：0
> 
> 时间：2012-07-31T18:39:51.497
> 
> 标签：sql, sql-server, database

我需要从临时表更新表。因此，我需要比较并找出哪些行不在要从临时表导入的主表中。我的表格如下所示，

```
line_id -> nvarchar(20)
order_no -> nvarchar(20)
line_no ->int 
```

两个表都有相同的字段，但临时表有更多最新记录要带到主表中。我在用;

```
INSERT INTO main_table
  SELECT * FROM temp_table t 
  WHERE t.line_id NOT IN (SELECT line_id FROM main_table) 
```

但条件 `WHERE t.line_id NOT IN (SELECT line_id FROM main_table)`不会带来任何订单行。但是当`order_no`使用 代替 时`line_id`，比较完成并且数字或订单行开始出现。But`order_no`不是唯一键，并且该比较不会返回所需的所有行。

如果您能帮助我，那就太好了..提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T18:51:41.507

Not-in 会带来奇怪的麻烦。这是对同一想法的不同看法。

```
Insert Into main_table
  select t.* 
    from temp_table t
    left outer join main_Table m
      on t.line_id=m.line_id
   where m.line_id is null 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T18:53:54.627

尝试以下操作：

```
INSERT INTO main_table
  SELECT * FROM temp_table t 
  WHERE LTRIM(RTRIMt.line_id)) NOT IN (SELECT LTRIM(RTRIM(line_id)) FROM main_table) 
```

# java - 我可以使用 Tomcat 上下文参数配置 Log4j 吗？

> ID：11746803
> 
> 赞同：0
> 
> 时间：2012-07-31T18:39:52.477
> 
> 标签：java, log4j, tomcat6

我希望能够根据我在其上部署 Java Web 应用程序的服务器以不同级别登录。例如，在我的测试服务器上，我想以 DEBUG 级别登录，而在我的生产服务器上，我想以 WARN 级别登录。目前我的 log4.xml 文件位于我的 WAR 文件中。我希望能够使用 Tomcat 上下文参数配置我的 Web 应用程序的日志记录级别。这可能吗？

我已经看到可以使用环境变量和系统属性。例如，**${catalina.home}**被解释。是否可以使用相同的功能替换 Tomcat 上下文参数值？

例如，这将是 log4j.xml 片段：

```
<level value="${log.level}" 
```

其中**log.level**在 %TOMCAT_HOME%/conf/context.xml 中定义：

```
<Parameter name="log.level" value="DEBUG" /> 
```

我已经尝试了上述方法，但似乎不起作用。Google 没有为我提供任何与在 log4j 配置文件中使用上下文参数相关的信息。我发现[这个 SO question](https://stackoverflow.com/q/201188/364029)使用系统属性做了类似的事情，但它不使用 Tomcat 上下文参数，所以它不是我想要的。log4j 配置中是否提供上下文参数值替换功能？我是否需要探索其他选项，例如使用外部 log4j.xml 文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T20:13:36.170

我不认为 Log4J 本身就可以做到这一点。我记得 Spring Web 框架附带了一个通过 web.xml 配置的侦听器，它可能会做一些类似的事情。如果您真的想要，我认为您可以获取该代码并使用它来创建您想要的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-01T11:59:09.523

我最近一直在使用的一种对日志进行极细粒度控制的方法是 log4 [appender](http://logging.apache.org/log4j/1.2/apidocs/org/apache/log4j/Appender.html)。这比编辑配置文件要多一点工作，但给你带来了难以置信的灵活性。有关如何配置其中之一的快速示例，请[参见](https://stackoverflow.com/questions/11722440/tomcat-filter-log4j-by-logger-name/11722820#11722820)我的答案。

# php - Apache Bench：为什么会有这么多 503？

> ID：11746804
> 
> 赞同：1
> 
> 时间：2012-07-31T18:39:59.593
> 
> 标签：php, linux, performance, apache, apachebench

我在 DreamHost 上运行专用服务器：四核，4GB RAM。

Linux (Debian)、Apache、PHP（使用 XCache 进行操作码缓存）、MySQL。

我查询的 URL 每次都有 18 个 MySQL 查询。

我想知道为什么当我执行“ab -n 500 -c 50 http://< *url* >/”时会得到以下结果：

```
Server Software:        Apache
Server Hostname:        <url>
Server Port:            80

Document Path:          /
Document Length:        162809 bytes

Concurrency Level:      50
Time taken for tests:   12.664 seconds
Complete requests:      500
Failed requests:        377
   (Connect: 0, Receive: 0, Length: 377, Exceptions: 0)
Write errors:           0
Non-2xx responses:      377
Total transferred:      20291876 bytes
HTML transferred:       20147278 bytes
Requests per second:    39.48 [#/sec] (mean)
Time per request:       1266.372 [ms] (mean)
Time per request:       25.327 [ms] (mean, across all concurrent requests)
Transfer rate:          1564.81 [Kbytes/sec] received

Connection Times (ms)
              min  mean[+/-sd] median   max
Connect:        0    0   0.4      0       2
Processing:   194 1190 1617.0    248    6060
Waiting:      194  965 1263.9    248    5190
Total:        194 1190 1617.0    248    6060

Percentage of the requests served within a certain time (ms)
  50%    248
  66%    359
  75%   1555
  80%   2787
  90%   3979
  95%   4709
  98%   5427
  99%   5967
 100%   6060 (longest request) 
```

所有 377 个失败的请求都是 503。这可能是什么原因造成的？在执行此操作时运行`top`，我的处理器飙升至约 24%，但并没有对它征税太多。

我的 CMS 表示，单次加载页面，加载基类需要 0.0017 秒，控制器执行时间需要 0.1711 秒，总执行时间为 0.1731 秒，使用 2.887 MB 内存。

`ab -n 100 -c 10`总是有 0 个失败的请求，但似乎任何有超过 25 个并发连接的东西都有一堆失败的连接。

我预计下周会同时出现大量流量，我怎样才能最好地准备我的服务器？这会保持原样吗？

编辑：来自我的 httpd-mpm.conf 文件，该文件是通过 httpd.conf 包含的

```
<IfModule mpm_worker_module>
    StartServers          4
    MaxClients          600
    MinSpareThreads      50
    MaxSpareThreads      150
    ThreadsPerChild      25
    MaxRequestsPerChild   0
</IfModule> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T20:19:22.223

如果这是 DreamHost 服务器而不是 VPS，那么它们可能正在杀死您的 php 进程，因为您已经用完了 CPU 份额。如果您的某个进程占用过多资源或传入连接过多，它将被终止，并且网络服务器将返回 503。

我不知道这些限制是什么，但[Dreamhost 的某个人在这个线程中解释了](https://discussion.dreamhost.com/thread-120453.html)：

> 您的网站在 DH 上可以处理的内存和连接是有限的。如果您接触到许多使用过多资源的访问者，您将收到 503 错误。也许您的网站在三年后变得太大了？如果没有更多关于访问者数量和使用的软件的信息，我们只能推测。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T22:10:07.620

这可能是由一些不同的事情引起的

1.  您的网络服务器正在达到打开文件限制（检查 ulimit）
2.  如果您使用 FPM，您可能会超出子限制（检查 fpm 配置）
3.  您可能超出连接限制（检查 sysctl.conf）

您应该做的第一件事是检查 nginx 或 apache 日志。

# c# - TcpClient(IPEndPoint localEP)，选择正确的localEp？

> ID：11746809
> 
> 赞同：3
> 
> 时间：2012-07-31T18:40:10.017
> 
> 标签：c#, tcpclient

我快把自己逼疯了。

Microsoft 通过使用构造函数为新的 TCPClient 绑定本地网络适配器和端口提供了一种很棒的方法：

```
TcpClient newClient = new TcpClient(IPEndPoint localEP); 
```

给定一个通用的 remoteEndPoint，无论是 IPv4 还是 IPv6，并假设有许多可能的 localEP，似乎没有一种明智的方法可以在调用之前确定要绑定到哪个 localEP：

```
TcpClient.Connect(IPEndPoint remoteEP) 
```

.net 确实提供了一个无参数的 TcpClient 构造函数，它会在调用 .Connect 时自动确定哪个 localEP 是最好的，但不幸的是它不支持 IPv6 目标。

我的第一个想法是访问 IP 路由表并自己确定要使用哪个适配器，但似乎 .net 也不提供该功能。

**我找到了一个涉及到 GetBestInterface() 的 P.Invoke 的解决方案，但不幸的是我需要能够在 Mono 中部署，所以真的需要一个托管解决方案。**

我的问题/问题是：给定一个已知的 remoteEP，以及所有已知 localEP 的列表，我如何在实例化 tcpClient 时正确选择正确的 localEP，以便连接方法成功。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-31T18:56:53.373

如果您要问的是 localEP 使用什么，您可以使用`new IPEndPoint(IPAddress.Any, myPort)` 这将绑定到本地计算机上的任何可用 IP 地址并使用 port `myPort`。这样一来，任何东西都可以使用它喜欢的任何 IP 连接到计算机。如果您有多个 IP（例如 NIC），它可以连接，如果我有 IPv4 和 IPv6，它可以连接到任何一个。

例如：

```
var client = new TcpClient(new IPEndPoint(IPAddress.Any, myPort)); 
```

但是，你通常可以只使用`new TcpClient();`

# unix - 使用 sudo 运行命令并进入 root (sudo -i) 并运行命令

> ID：11746811
> 
> 赞同：2
> 
> 时间：2012-07-31T18:40:22.573
> 
> 标签：unix, sudo

问题是

运行这两个命令到底有什么区别。

作为根，我制作了一个自定义环境。多变的

```
export A="abcdef" 
```

然后在 root shell

```
sudo -i
echo $A 
```

返回

```
abcdef (as expected) 
```

但是，当我回到普通用户并运行时

```
sudo -i echo $A 
```

它返回空行。

那么当您运行命令 sudo echo $A 时，它是否使用普通用户的环境变量和 shell？

即使我运行 sudo echo $A 也有办法获得 abcdef 吗？

谢谢

* * *

编辑 1

当您说您已将变量 A 作为 root 时，我假设您的意思是您在 root 的 .profile 或类似的东西中执行了此操作。-->（是的！）

* * *

编辑 2

这很有意义，但有一些麻烦。

当我做

```
sudo -i 'echo $A' 
```

我得到
-bash: echo $A: command not found。

但是，当我这样做时

```
su -c 'echo $A' 
```

它回馈

```
abcdef 
```

有什么问题

```
sudo -i 'echo $A' 
```

命令？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-31T20:05:54.613

如果要将环境传递给`sudo`，请使用`sudo -E`：

```
-E    The -E (preserve environment) option indicates to the
      security policy that the user wishes to preserve their
      existing environment variables.  The security policy may
      return an error if the -E option is specified and the user
      does not have permission to preserve the environment. 
```

环境会以交互方式保存，也可以通过您从命令行运行的任何内容保存。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-31T20:20:29.653

当您说您已将变量设置`A`为 root 时，我假设您的意思是您在 root 的 .profile 或类似的东西中执行了此操作。我假设你的意思是普通用户没有`A`设置。在这种情况下，以下适用：

当您运行命令时`sudo -i echo $A`，它首先由本地 shell 解释并被`$A`替换。这导致`sudo -i echo`，这是实际执行的。

你的意思是这样的：

```
sudo -i 'echo $A' 
```

这传递`echo $A`给 sudo shell。

```
~ rnapier$ sudo -i echo $USER
rnapier
~ rnapier$ sudo -i 'echo $USER'
root 
```

* * *

试试这个语法：

```
sudo -i echo '$USER' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-31T20:00:50.827

虽然我无法在我的机器上复制结果，但[sudo 的手册页](http://linux.die.net/man/8/sudo)指定 -i 选项将取消设置/删除一些变量。

```
man sudo 
```

> -i [命令]
> 
> -i（模拟初始登录）选项将目标用户的 passwd(5) 条目中指定的 shell 作为登录 shell 运行。这意味着 shell 将读取特定于登录名的资源文件，例如 .profile 或 .login。如果指定了命令，则将其传递给 shell 执行。否则，将执行交互式 shell。sudo 在运行 shell 之前尝试更改到该用户的主目录。它还初始化环境，保持 DISPLAY 和 TERM 不变，设置 HOME 、 MAIL 、 SHELL 、 USER 、 LOGNAME 和 PATH ，以及 Linux 和 AIX 系统上 /etc/environment 的内容。**所有其他环境变量都被删除。**

所以我会尝试不使用 -i 选项。

# sas - 限制 PROC SQL 中的结果

> ID：11746815
> 
> 赞同：17
> 
> 时间：2012-07-31T18:40:30.353
> 
> 标签：sas, proc-sql

我正在尝试使用 PROC SQL 来查询具有数亿条记录的 DB2 表。在开发阶段，我想对这些记录的任意小子集（比如 1000）运行我的查询。我尝试使用 INOBS 来限制观察结果，但我相信这个参数只是限制了 SAS 正在处理的记录数。我希望 SAS 只从数据库中获取任意数量的记录（然后处理所有记录）。

如果我自己编写 SQL 查询，我会简单地使用`SELECT * FROM x FETCH FIRST 1000 ROWS ONLY ...`（相当于`SELECT TOP 1000 * FROM x`SQL Server 中的）。但是 PROC SQL 似乎没有这样的选项。获取记录需要很长时间。

问题：如何指示 SAS 任意限制**从数据库返回**的记录数。

我读过 PROC SQL 使用 ANSI SQL，它没有任何关于行限制关键字的规范。也许 SAS 不想努力将其 SQL 语法转换为特定于供应商的关键字？没有解决办法吗？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-07-31T19:12:10.937

您是否尝试过`outobs`在您的 中使用该选项`proc sql`？

例如，

```
proc sql outobs=10; create table test
    as
    select * from schema.HUGE_TABLE
    order by n;
quit; 
```

或者，您可以使用 SQL passthrough 来使用 DB2 语法 ( ) 编写查询`FETCH FIRST 10 ROWS ONLY`，尽管这需要您将所有数据存储在数据库中，至少是暂时的。

直通看起来像这样：

```
proc sql;
    connect to db2 (user=&userid. password=&userpw.  database=MY_DB);

    create table test as
    select * from connection to db2 (
        select * from schema.HUGE_TABLE
        order by n
        FETCH FIRST 10 ROWS ONLY
    );
quit; 
```

它需要更多语法并且无法访问您的 sas 数据集，因此如果`outobs`适合您，我会推荐它。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-07-31T19:46:03.493

当 SAS 通过 SAS 语法与数据库对话时，部分查询可以被翻译为等效的 DBMS 语言 - 这称为隐式传递。查询的其余部分由 SAS 进行“后处理”以产生最终结果。取决于 SAS 版本、DBMS 供应商和 DBMS 版本，在某些情况下甚至某些连接/libname 选项，SAS 语法的不同部分在 SAS 和 DBMS 之间是可翻译的/被认为是兼容的，因此发送到由 DBMS 而不是 SAS 执行。

使用 SAS SQL 选项 - INOBS 和 OUTOBS - 我通过不同版本的 SAS 使用 MS SQL 和 Oracle 进行了很多工作，但我还没有看到那些被翻译成 TOP xxx 类型的查询，所以这可能还不支持，虽然当查询只涉及 DMBS 数据（没有连接到 SAS 数据等）时，应该是相当可行的。

所以我认为你只剩下所谓的显式传递 - 特定的 SAS SQL 语法来连接到数据库。这种类型的查询如下所示：

```
proc sql;
    connect to oracle as db1 (user=user1 pw=pasw1 path=DB1);
    create table test_table as
    select *
    from connection to db1
        ( /* here we're in oracle */
                  select * from test.table1 where rownum <20 
                )
    ;
    disconnect from db1;
quit; 
```

在 SAS 9.3 中，可以简化语法 - 如果已经存在 LIBNAME 连接，您可以将其重用于显式传递：

```
LIBNAME ORALIB ORACLE user=...;

PROC SQL;
connect to oracle using ORALIB;
create table work.test_table as
        select *
        from connection to ORALIB (
.... 
```

使用 libname 连接时，请务必在加载数据库时使用 READBUFF（我通常设置 5000 左右）或 INSERTBUFF 选项（1000 或更多）。

要查看是否发生隐式传递，请设置 sastrace 选项：

```
option sastrace=',,,ds' sastraceloc=saslog nostsuffix; 
```

# iphone - iOS应用程序背景的多个图像

> ID：11746816
> 
> 赞同：-1
> 
> 时间：2012-07-31T18:40:37.807
> 
> 标签：iphone, ios, background-image

我见过不同的应用程序，每次在视图背景上打开应用程序时，图像都会发生变化。这是如何实现的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T19:37:58.480

听起来您所看到的是 iOS 系统在将您的应用程序放入后台之前为其制作的缓存屏幕截图。

这是自动处理的，您确实有机会拦截它。

查看此答案，您可以在应用程序进入后台时将图像放在应用程序上，这将被缓存并用于重新启动应用程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T19:33:24.077

将 background_0.png、background_1.png、background_2.png、background_3.png 等添加到您的项目中。

`#define max_image_number 3`

将以下内容添加到您的 viewDidLoad 方法中：

```
-(void)viewDidLoad {  
    [super viewDidLoad];
    [self updatedBackgroundImage];
   [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(updateBackgroundImage) name:UIApplicationWillEnterForegroundNotification object:nil];
}

-(void) updateBackgroundImage{
    NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];

    if (![defaults integerForKey:@"imageNumber"]) {
                [defaults setInteger:0 forKey:@"imageNumber"];
            }

            int i = [defaults integerForKey:@"imageNumber"];

            myUIimageView.image = [UIImage imageNamed:[NSString stringWithFormat:@"background_%d.png",i]];
            i++;

            if (i > max_image_number) {
                [defaults setInteger:0 forKey:@"imageNumber"];

           }else{
                [defaults setInteger:i forKey:@"imageNumber"];
            }
    ...

    } 
```

上面将在 viewController 首次加载以及从后台运行返回时更新图像。我认为这是你所缺少的:)。

请记住停止在 viewDidUnload 方法中侦听通知，您应该进行设置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-31T19:12:42.700

假设您想要更改一个或多个视图的背景图像，具体取决于应用程序的启动。

保存`int x = 0`到 NSUserDefaults。在每次应用程序启动时将其递增 1。当您要呈现视图时，检查该 int 并设置如下背景图像：

```
switch(x%3){// %3 just to make it a bit random
   case 0://set this image; 
         break;
   case 1://set that image
         break;
      //and so on
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-31T19:00:07.457

查看您提到的应用程序的 App Store 中的屏幕截图，看起来`UIImageView`主菜单的视图层次结构的后面只有一个。您可以通过将`UIImage`对象分配给其`image`属性来更改此设置。

# html - 什么可能导致 CSS id 链接的“边框”属性被完全忽略？

> ID：11746821
> 
> 赞同：0
> 
> 时间：2012-07-31T18:40:59.187
> 
> 标签：html, css

我继承了一个非常大的CSS文件，我添加了一个具体`id`如下：

```
#specialLink a, #specialLink a:link, #specialLink a:active, #specialLink a:visited
{
    border:solid 1px #000000; 
    background-color:#CC0000;
} 
```

但是，当我在链接中使用它时，如在 中`<a id="specialLink" href="whatever.htm">Test Link</a>`，它完全忽略了`border`上面的属性，但尊重该`background-color`属性。

我被引导相信`id`CSS 中的标签具有最终优先级，那么是什么导致该`border`属性被完全忽略？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T18:45:46.893

您的选择器不正确。你有：

```
#specialLink a {} 
```

这将匹配作为具有 ID 的元素的*后代*`#specialLink`的锚元素：

```
<div id="specialLink">
    <a href="#">Anchor</a>
</div> 
```

你想要的是：

```
a#specialLink {} 
```

这样选择器将匹配：

```
<a href="#" id="specialLink">Anchor</a> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T18:46:01.630

`#specialLink a`指的`A`是包装元素内的标签，其 ID 为“specialLink”。

要设置您需要单独使用的链接的样式，`#specialLink`因为它已经有一个唯一的 ID。

```
#specialLink {
   ...
} 
```

# amazon-s3 - EC2 和 S3 之间的连接速度非常慢。正常吗？

> ID：11746822
> 
> 赞同：0
> 
> 时间：2012-07-31T18:41:05.403
> 
> 标签：amazon-s3, amazon-ec2, amazon-cloudfront, fuse, s3fs

![在此处输入图像描述](../Images/496bb5ea85ecdaccf6d8a170749e3438.png)我正在尝试为我的网站设置 CDN。

所以，这就是我所做的：

1.  创建 S3 存储桶
2.  基于此测试存储桶创建 CloudFront 分配
3.  使用以下命令将我的测试 s3 存储桶安装在我的 ec2 实例上：

    /usr/bin/s3fs -o allow_other this-is-test-bucket /mnt/s3drivetest/

（我使用本教程在 CentOS 6.3 实例上安装 Fuse 2.9.1 和 s3fs 1.61 - [http://www.itisopen.net/2011/12/CentOS_and_s3fs/](http://www.itisopen.net/2011/12/CentOS_and_s3fs/)）

现在，当我尝试将文件从我的 ec2 复制到这个安装的驱动器“/mnt/s3drivetest/”时，复制所有文件需要很长时间。在 2 小时内复制了包含大量小图像和 css 文件的 40MB 文件夹。大约每秒 5 个文件。

```
cp -Rfv /var/www/website.com/media/ /mnt/s3drivetest/ 
```

正常吗？我试图将同一个文件夹复制到我的 /tmp/ 目录中，它花了 2 秒钟。

另外，这些与文件夹同名的“0字节”文件是什么？请看截图。

**信息：** EC2 实例位于“region=us-east-1”，S3 存储桶位置为“美国标准”。

EC2 实例操作系统：CentOS 6.3

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T21:25:05.847

这很可能不是 S3 的问题，但 s3fs 文件系统实现很慢。[这个问题](https://serverfault.com/questions/396100/s3fs-performance-improvements-or-alternative)还有其他详细信息。

# javascript - 两个数字之间的jQuery除法

> ID：11746823
> 
> 赞同：3
> 
> 时间：2012-07-31T18:41:12.587
> 
> 标签：javascript

你们能帮我解决这个问题吗：

我在 jquery x 和 y 中有两个变量，我在这两个变量之间做一个除法，我假设结果是 2.5 ，但我只想显示 2 from 2.5 ，我该怎么做？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-31T18:44:33.077

如果您只是想截断小数，请使用以下命令：

```
parseInt(2.5); // returns 2 
```

如果您尝试四舍五入到最接近的整数，请使用以下命令：

```
Math.round(2.5); // returns 3 
```

如果您要四舍五入，请使用以下命令：

```
Math.floor(2.5); // returns 2 
```

如果您要四舍五入，请使用以下命令：

```
Math.ceil(2.5); // returns 3 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-31T18:43:28.650

在结果上简单地在 javascript 中使用 parseInt()

```
var x = 12.5;
var y = ​5;

​var result = parseInt(x / y, 10); // the 2nd parameter signifies base-10
alert(result);​ 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-31T18:42:43.993

您根本不需要为此使用 jQuery。只需使用 JavaScript 的[`parseInt()`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/parseInt)方法。

# verilog - 如何在 SystemVerilog 程序块中监视信号

> ID：11746825
> 
> 赞同：3
> 
> 时间：2012-07-31T18:41:14.810
> 
> 标签：verilog, system-verilog

我正在尝试使用 SystemVerilog 学习一些关于测试平台的知识。但是我似乎找不到在程序块内监视 DUT 信号的方法

考虑以下示例。信号“虚拟”是 DUT 的输出并输入到程序块。现在我需要监视程序块中的“dummy”以在“dummy”具有特定值时引发标志“test”。

在一般的模块驱动测试平台中，我会简单地写总是@（虚拟），但程序下不允许总是块。我将如何实现这一目标？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-31T19:37:35.783

您可以像这样编写顺序代码：

```
program test(input dummy);
  initial begin
    ...
    wait(dummy == <something>);
    ...
    @(posedge dummy);
    ...    
  end
endprogram 
```

`always`或者您可以使用`forever`循环模拟构造。

```
program test(input dummy);
  initial begin
    forever begin
      @(posedge dummy);
      if (dummy == <something>) ...
    end 
  end
endprogram 
```

# ruby-on-rails - 找到 id = 1 的 Zombie 并将其存储在变量中

> ID：11746826
> 
> 赞同：2
> 
> 时间：2012-07-31T18:41:20.910
> 
> 标签：ruby-on-rails, ruby

我正在上一个交互式课程 Rails For Zombies

有一个名为 (Zombie) 的数据库表和以下字段

```
id  name    graveyard
1   Ash Glen Haven Memorial Cemetary
2   Bob Chapel Hill Cemetary
3   Jim My Fathers Basement 
```

1.  ruby 中的数据库表是否被视为哈希？
2.  我如何找到 id = 1 的 Zombie 并将其存储在变量中？

我完成了 TryRuby.Org 没有问题。我需要理解这个概念我知道如何毫无问题地使用语言语法只需要理解简单的概念。

非常感谢您的回答。请不要评论，我正在寻求答案。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-31T18:47:01.383

1) 使用 ActiveRecord，您将获得一个 activerecord 对象或一组活动记录对象。然后每个属性都可以作为方法访问：`Zombie.find(1).name`例如

2)`zombie = Zombie.find(1)`

我强烈建议您遵循额外的教程并在这里查看：http: [//guides.rubyonrails.org/active_record_querying.html](http://guides.rubyonrails.org/active_record_querying.html)

祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T18:50:52.690

这取决于您使用的是哪种数据库。如果您使用的是基于内存的键值存储，那么是的，它的行为类似于哈希。考虑到您有一个“数据库表”，我将假设本教程适用于关系数据库，并且可能是 ActiveRecord。这一段的重点是，有很多不同的数据库表现不同。对你来说，不，表本身不是散列。

但是，它类似于哈希，因为事物以唯一的 ID 存储（通常是从 1 开始并为每条记录向上计数的整数。）

因此，要将僵尸 bob 保存在变量中：

`bob = Zombie.find(2)`或者你可以做`bob = Zombie.find_by_name('Bob')`

Find 使用 id 并获取关联的对象，该对象的作用类似于哈希。例如：

`bob[:name]`将返回`"Bob"`

我建议您通读文档以完全了解查询数据库的想法：http: [//guides.rubyonrails.org/active_record_querying.html](http://guides.rubyonrails.org/active_record_querying.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-31T19:15:22.040

在 Rails 中，模型映射到表中，如果您使用的是 RDBMS（例如 mysql、postgresql），则这种映射称为对象关系映射；如果您使用的是 mongodb 等无模式 DBMS，则称为对象映射。所以基本上对于你的僵尸（按照惯例是复数）表会有一个名为 Zombie 的模型（按照惯例是单数）。根据映射器，您的表类型会有所不同。无论映射器是什么，特定记录中的任何字段都可以通过在该对象的点 (.) 之后指定字段来访问。

z = Zombie.find(1) 这将找到 id = 1 的行，这将返回一条绝对不是哈希的记录。

您也可以使用 where 来匹配其他一些字段，例如zombie = Zombie.where(:name => 'Ash')，这将返回一组 name = 'Ash' 的记录，这就像一个数组但不完全是一个数组，您可以使用 each 遍历结果并执行收集、映射等数组操作。

# objective-c - 如何知道用户在 UITableViewCell 中点击的位置？

> ID：11746829
> 
> 赞同：0
> 
> 时间：2012-07-31T18:41:34.717
> 
> 标签：objective-c, ios

我正在编写一个通用的 iOS 应用程序，其中我有一个`UITableView`设置为允许`allowsMultipleSelectionDuringEditing`. 只是为了刷新你的记忆，这意味着表格的每个单元格的左侧都有一个小复选框。当我处于编辑模式时，有没有办法确定用户是点击了小复选框还是点击了单元格的其余部分？我希望根据他们是点击框还是单元格的其余部分来调用不同的方法。例如，

```
if(user tapped checkbox)
{
    foo();
}
else if (user tapped any part of the cell other than checkbox)
{
    foobar();
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T19:26:20.907

我想到了。只需为每个手势识别器添加一个手势识别器`UITableViewCell`并将识别器设置为调用此方法：

```
UITableViewCell *cellTapped = (UITableViewCell *) recognizer.view;
CGPoint tapLocationInContentView = [recognizer locationInView:cellTapped.contentView];
if(tapLocationInContentView.x < 0 )
{
    //Checkbox tapped
}
else 
{
    //Rest of cell tapped
} 
```

# filesystems - 在 NTFS 卷上 CreateHardLink() 失败，错误代码为 1（函数不正确）

> ID：11746830
> 
> 赞同：1
> 
> 时间：2012-07-31T18:41:39.013
> 
> 标签：filesystems, windows-xp, ntfs, hardlink

我们有一个使用 NTFS 硬链接的桌面应用程序。该应用程序已在全球超过 400K 用户 PC 上成功分发和使用。

但是，有一位客户的 CreateHardLink() 函数始终失败，错误代码为 1（函数不正确）。这发生在同一家公司的多台机器上。所有这些机器都运行 Windows XP，并且问题发生在 NTFS 分区上。

我们已要求用户运行 fsutil.exe 以确认卷文件系统实际上是 NTFS，并且“fsutil.exe hardlink create newname.txt existing.txt”无法显示确切的错误消息。

知道是什么原因造成的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-01T12:36:31.097

不正确的功能将表明文件系统不是 NTFS - 我*真的*要确保客户端的 FS 是 NTFS。如果您确定它是 NTFS，我建议直接调用 NTFS 内核驱动程序来找出问题所在。通过 CreateFile() 打开文件并使用参数 FileLinkInformation 调用 NtSetInformationFile()；错误代码应该准确地告诉您出了什么问题。

您需要的指针是 FILE_LINK_INFORMATION 结构 (http://msdn.microsoft.com/en-us/library/windows/hardware/ff540324%28v=vs.85%29.aspx) 和 ZwSetInformationFile (http://msdn. microsoft.com/en-us/library/windows/hardware/ff567096%28v=vs.85%29.aspx），但不能在内核外使用 Zw*，所以使用 Nt* 版本。不过，即使使用 Nt* 函数也有点棘手。

无论如何， fsutil 的正确语法是“fsutil hardlink create”。

罗伯特

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-11-03T19:58:10.350

您可以尝试在这些文件系统上运行 chkdsk，会不会是它们损坏了 MFT 记录？

# uitableview - 将 UISegmentedControl 按钮添加到 UITableViewController 中的工具栏

> ID：11746832
> 
> 赞同：3
> 
> 时间：2012-07-31T18:41:49.420
> 
> 标签：uitableview, uinavigationcontroller, uitoolbar, uisegmentedcontrol

我正在尝试添加一个`UISegmentedControl`显示在视图底部的工具栏。我在一个`UITableViewController`，它嵌入在一个导航控制器中，该控制器嵌入在标签栏控制器中。通常钻取东西。我希望这个工具栏只出现在这个特定的选项卡视图中。我使用故事板。

我尝试在 IB（情节提要）中创建分段控件，配置其项目并将其放置在 viewcontroller 目录中（情节提要中 viewcontroller 下方的灰色条）

[![故事板](../Images/b3971de42ea036f09fb46c1519144b57.png)](https://i.stack.imgur.com/YGAF5.png)

将此分段控件的引用出口添加到我的 viewcontroller.h 然后取消隐藏导航控制器工具栏并尝试添加此项目

```
self.navigationController.toolbarHidden = NO;

UIBarButtonItem *segmentBarItem = [[UIBarButtonItem alloc] initWithCustomView:myOutletSegmentedControl];
self.navigationController.toolbar.items = [NSArray arrayWithObjects:segmentBarItem, nil]; 
```

所以我`myOutletSegmentedControl`的未初始化，即使我在 IB 中完全配置了它。所以以编程方式尝试：

```
self.navigationController.toolbarHidden = NO;

UISegmentedControl *segmentedControl = [[UISegmentedControl alloc] initWithItems:
                                        [NSArray arrayWithObjects:@"a-b",@"b-a",nil]];

[segmentedControl addTarget:self action:@selector(segmentAction:) forControlEvents:UIControlEventValueChanged];
segmentedControl.frame = self.navigationController.toolbar.frame;
segmentedControl.segmentedControlStyle = UISegmentedControlStyleBar;
segmentedControl.momentary = NO;

UIBarButtonItem *segmentBarItem = [[UIBarButtonItem alloc] initWithCustomView:segmentedControl];
self.navigationController.toolbar.items = [NSArray arrayWithObjects:segmentBarItem, nil]; 
```

现在在底部有一个工具栏但没有项目..

我什至尝试在 IB 中创建整个工具栏 -> 子按钮 -> 子分段控件并将其输出，然后执行以下操作：

```
 self.navigationController.toolbar = myNewOutletToolbar; 
```

还是不行。我确实更喜欢使用故事板/IB 来创建我的 UI，但我正在努力解决它......

# sql - 使用 Group By 时出现 SQL 错误：每个 GROUP BY 表达式必须至少包含一个非外部引用的列

> ID：11746835
> 
> 赞同：7
> 
> 时间：2012-07-31T18:42:01.447
> 
> 标签：sql, group-by

在执行我认为是最简单的查询之一时，我遇到了这个错误！我看到其他人在这里也遇到了问题，我查看了我见过的每一个解决方案，但他们的查询涉及更多，所以我很难找出问题所在。我做了一个小虚拟表来说明我的问题。

表名：组测试

```
id  name
1   Mel
2   Lucy
3   Mandy
4   Mel
5   Mandy
6   Mel 
```

我想知道每个名字出现了多少次，以生成如下表格：

```
3 Mel
2 Mandy
1 Lucy 
```

这是我认为应该有效的查询：

```
SELECT Count(id), Name
FROM groupbytest
GROUP BY 'Name' 
```

我得到了错误：

> 每个 GROUP BY 表达式必须至少包含一个不是外部引用的列。

帮助！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-31T18:44:20.373

您在 Name 字段周围有不需要的引号。

```
SELECT Count(id), Name
FROM grouptest
GROUP BY Name 
```

根据您的评论，您需要在`CAST`您的`Name`专栏中：

```
SELECT Count(id), Cast(Name as Varchar(max)) Name
FROM grouptest
GROUP BY Cast(Name as Varchar(max)) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-31T18:44:04.297

失去`'`了`GROUP BY`：

```
SELECT Count(id), Name 
FROM groupbytest 
GROUP BY Name 
```

如果`name`是 a `text`，那么您需要将其转换为`VARCHAR`，但您可能会截断您的列。

```
SELECT Count(id), CAST(Name AS VARCHAR(8000)) AS Name
FROM groupbytest 
GROUP BY CAST(Name AS VARCHAR(8000)) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-31T18:44:00.743

你要：

```
SELECT Count(id), [Name]
FROM groupbytest 
GROUP BY [Name] 
```

`GROUP BY 'Name'`尝试对文字字符串 'Name' 进行分组，而不是 column `Name`。

`Name`也可能是一个保留字，因此它周围的括号，虽然你最好不要调用 column `Name`。

# javascript - e.preventDefault 不适用于 live() 事件

> ID：11746836
> 
> 赞同：0
> 
> 时间：2012-07-31T18:42:10.877
> 
> 标签：javascript, jquery, html

关于这个脚本的一切工作都很好，但除了`e.PreventDefault();`我已经尝试了一切但似乎没有任何工作。我不能`.click()`在这个脚本中使用处理程序，因为它是动态调用的，否则我会尝试这样做。

JS

```
<script>
$('#vote_up').live('click', function(e) {
    e.preventDefault();
    $.post("votes.php", {
        vote: "1",
        item_id: "$item_id",
        type: "$type"
    }, function(data) {
        $('#vote_count').empty().append(data);
    });
});
$('#vote_down').live('click', function(e) {
    e.preventDefault();
    $.post("votes.php", {
        vote: "-1",
        item_id: "$item_id",
        type: "$type"
    }, function(data) {
        $('#vote_count').empty().append(data);
    });
});
    </script> 
```

HTML

```
<div class="vote_box">
    <a href="#" id="vote_up">▲&lt;/a>
    <span id="vote_count">$count</span>
    <a href="#" id="vote_down">▼&lt;/a>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T18:57:24.680

您可以直接返回，`false`这也将防止您的事件被触发时发生的其他一些事件。

```
$('#vote_up').live('click', function(e) {

$.post("votes.php", {
    vote: "1",
    item_id: "$item_id",
    type: "$type"
}, function(data) {
    $('#vote_count').empty().append(data);
});

return false;

}); 
```

# c# - 使用 IEnumerable 和 IQueryable 在通用存储库中

> ID：11746841
> 
> 赞同：9
> 
> 时间：2012-07-31T18:42:19.487
> 
> 标签：c#, linq, entity-framework, repository-pattern

我已经阅读了许多关于实现通用存储库的帖子。我还阅读了许多帖子，这些帖子解释了从我的存储库中公开 IEnumerable 与 IQueryable 之间的区别。

我希望灵活地将我的数据过滤到数据库中（而不是由客户端在内存中过滤），但希望避免为我的所有实体（以及实现这些接口的具体类）定义单独的存储库接口。

到目前为止，我的存储库如下所示：

```
public interface IRepository<T>
{
    IEnumerable<T> GetAll();
    IEnumerable<T> Find(Expression<Func<T, bool>> where);

    void Add(T entity);
    void Attach(T entity);
    void Delete(T entity);
} 
```

具体实现的一个例子是：

```
public class Repository<T> : IRepository<T> where T : class
{
    private DbContext _context;
    private DbSet<T> _entitySet;

    public Repository(DbContext context)
    {
        _context = context;
        _entitySet = _context.Set<T>();
    }

    public IEnumerable<T> GetAll()
    {
        return _entitySet;
    }

    public IEnumerable<T> Find(Expression<Func<T, bool>> where)
    {
        return _entitySet.Where(where);
    }

    public void Add(T entity)
    {
        _entitySet.Add(entity);
    }

    public void Attach(T entity)
    {
        _entitySet.Attach(entity);
    }

    public void Delete(T entity)
    {
        _entitySet.Remove(entity);
    }
} 
```

在这种情况下，我的存储库使用`DbContext`所以我想知道的是它如何与通用接口一起使用：

1.  `IQueryable<T>`源自`IEnumerable<T>`。在我的 find 方法中，我返回一个`IQueryable<T>`对象，但客户端只将其视为`IEnumerable<T>`. 这是否意味着如果我对`IEnumerable<T>`对象执行任何后续查询，它实际上会在数据库上执行操作并且只返回*结果*（因为在这种情况下对象*是 a* `IQueryable`）？或者，
2.  只有`Where`传入方法的子句在数据库上执行，对对象执行的`Find`任何后续查询都在客户端上执行。`IEnumerable<T>`或者，
3.  这些都没有发生，我完全误解了它是如何`IEnumarable<T>`工作`IQueryable<T>`的`Linq`。

**更新：**

我实际上对我在评论中收到的答案感到相当惊讶。我的原始存储库返回了 IQueryable，随后的研究让我相信这是一件坏事（例如，如果我的 viewModel 在其构造函数中接受了一个存储库，它可以调用它想要的任何查询，这使得测试变得更加困难）。

到目前为止，我为此看到的所有解决方案都涉及创建特定于实体的存储库，以便不暴露 IQueryable（我猜唯一的区别是我以通用方式执行此操作）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-31T19:00:08.017

因为您要返回`IEnumerable<T>`所有后续调用将在内存中（本地）完成。

要记住的一件事是 LINQ 使用一组扩展方法进行操作。有一些扩展方法`IQueryable<T>`支持在本地以外的位置执行查询所需的所有必要连接，而扩展方法`IEnumerable<T>`仅在本地工作。

请注意，选择哪一个是基于编译时类型，而不是运行时类型。因此`IQueryable`，转换为 an 的 an`IEnumerable`将被视为`IEnumerable`。这与类通常的工作方式不同（由于多态性），但是它允许调用站点控制如何执行这些操作。

这很有用的一个例子是当您需要获取表中的所有记录然后计算它们时。如果您要获得所有结果，则无需在 SQL 中执行计数。

# c# - 从正则表达式 C# 中的字符串替换空格（x0020）

> ID：11746843
> 
> 赞同：1
> 
> 时间：2012-07-31T18:42:22.183
> 
> 标签：c#, regex, string

我不擅长正则表达式，我认为我很接近。我有一些数据从列表中返回并填充下拉列表。我得到的是*x0200*表示而不是空格。我已经尝试过正则表达式，但我认为我在这里错了。

```
foreach (string field in myViewFields)
{
    SPField myField = list.Fields.GetField(field);
    SPFieldType fieldType = myField.Type;

    System.Diagnostics.Debug.WriteLine(fieldType);

    if (fieldType == SPFieldType.Text || fieldType == SPFieldType.Note)
    {
        var fieldSpace = field;
        fieldSpace = Regex.Replace(fieldSpace, @"[\x20\x27\x2C\.]", "");
        ddlListColumns.Items.Add(fieldSpace);
    }

} 
```

请让我知道我在这里做错了什么。我只想替换这些该死的十六进制空间。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-31T18:50:01.163

使用 String.Replace ：

```
@"my\x0020bar".Replace(@"\x0020", " ") 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-31T18:49:30.667

我想你可以用`string.Replace()`

```
var fieldSpace = field;
string replaced = fieldspace.Replace(@"\x0020"," ");
ddlListColumns.Items.Add(replaced); 
```

# css - 回发后不保留对 CSS 的更改

> ID：11746844
> 
> 赞同：1
> 
> 时间：2012-07-31T18:42:25.240
> 
> 标签：css, asp.net-mvc-3, razor, postback

我有一个循环遍历其模型中的属性并显示一堆复选框的视图。

这些复选框由它们的父级组合在一起，我有一个链接显示/隐藏包装每组复选框的 div（您在代码中看到的 javascript 折叠函数）。

问题是，这些复选框/组绑定到模型，并且在回发后，模型会自行重建 - 如果最终用户折叠了一个组（调用 jquery.hide()），则它不再折叠。

在 MVC 中保留这些 css 更改的正确方法是什么？我需要一个隐藏字段来跟踪他们的可见性吗？我是否需要更新模型对象以拥有一个新属性来说明是否显示该组？

来自网络表单...原谅我的菜鸟。

```
 @for (int y = 0; y < Model.SearchControls.Count; y++)
     {
<div style="margin-top: 3px;">
                        <h2 style="cursor:pointer;" onclick="javascript:Collapse(@y);">@Html.Label(Model.SearchControls[y].DisplayText)</h2>
                        </div>

<div id="@string.Format("domainDiv{0}", @y)" style="display:none;">

                            @for (int z = 0; z < Model.SearchControls[y].DomainControl.Domains.Count; z++)
                            {
                                @Html.CheckBoxFor(x => x.SearchControls[y].DomainControl.Domains[z].Checked)
                                @Html.Label(" " + Model.SearchControls[y].DomainControl.Domains[z].DomainName)
                                @Html.HiddenFor(x => x.SearchControls[y].DomainControl.Domains[z].DomainName)
                                @Html.HiddenFor(x => x.SearchControls[y].DomainControl.Domains[z].DomainID)
                                <br />
                            }
</div> 
```

}

# python - 删除文件中包含多行的行

> ID：11746845
> 
> 赞同：0
> 
> 时间：2012-07-31T18:42:31.720
> 
> 标签：python, excel, file, io

我有一个包含多行 (1008) 的 Excel 文件 (.xls)，我正在寻找与 2010 有任何内容的行。

例如，有一行包含 01/06/2010，因此将删除该行，将单元格留空。

![在此处输入图像描述](../Images/b895b88259b94eb2223854e049b3c94f.png)

对于此示例，所有这些都将被删除。我尝试至少阅读该文件，但我得到了一个丑陋的错误：

```
def Pesquisar():
    nomeArquivo = open('D:/file.xls', 'r')
    for palavraArquivo in nomeArquivo.readlines():
        print palavraArquivo 
```

结果：

```
ÐÏà¡± 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T18:46:33.163

您不能直接读取 excel 文件，因为它不是标准文本文件。您需要使用第三方库，例如[xlrd](http://pypi.python.org/pypi/xlrd)。另一种选择是将 xls 文件导出为 csv 文件或制表符分隔格式，然后使用 python 将它们解析为文本文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T18:46:50.647

Excel 文件使用不适合纯文本解析的特殊格式。

就处理 .xls 格式的库而言，此讨论可能会为您指明正确的方向：[Reading/parsing Excel (xls) files with Python](https://stackoverflow.com/questions/2942889/reading-parsing-xls-files-with-python)

# css - 右侧的 CSS 列，与容器高度相同

> ID：11746853
> 
> 赞同：2
> 
> 时间：2012-07-31T18:43:01.787
> 
> 标签：css, height

我有一个里面有 2 个 div 的容器。一个取容器的左侧，第二个（rightBarItems）应位于右侧，但我希望它的高度与容器的高度相同。基本上，我正在右侧创建一个列。

**HTML：**

```
<div class="container">
        <div class="itemMain"><?php include("itemMain.php"); ?></div>
        <div class="rightBarItems"><?php include("rightBarItems.php"); ?></div>
</div> 
```

**CSS：**

```
.container {
    overflow: hidden;
    background: white;
    padding-right: 20px;
    -webkit-box-shadow: 4px 2px #492409,  -4px 0 2px #492409;
    -moz-box-shadow: 4px 0 2px -6 #492409,  -1px 0 2px #492409;   
    box-shadow: 4px 0 2px  #492409,  -4px 0 2px #492409;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T20:32:42.517

两个干燥的解决方案（他们都有自己的问题）

首先：

1) 相对于容器 2) 定位并浮动左侧元素。3）绝对定位右元素并设置其顶部：0和底部：0，右侧和宽度

当然，这个问题是左边的容器内容应该比右边的大

第二个（如果您可以向 html 添加更多元素）：1）相对于容器的位置 2）浮动右侧和左侧容器 3）创建一个新的 div，它是右侧元素的“bg” 4）绝对位置与上一个方法相同：right:0, top:0, bottom:0 和宽度 5) 必要时调整 z-index

:O

编辑：

后一种解决方案的快速示例：http: [//jsbin.com/ecaced/1](http://jsbin.com/ecaced/1)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T18:46:29.980

`height: auto;`或者`height: 100%;`应该工作。

# web - 通过向另一个站点发送 HTTP POST 请求，如何接收请求的结果？

> ID：11746863
> 
> 赞同：0
> 
> 时间：2012-07-31T18:43:35.763
> 
> 标签：web, http-post

通过向另一个站点发送 HTTP POST 请求，生成并打印出一个值。如何获得价值？

例如，http://www.twiddla.com/new.aspx[接受](http://www.twiddla.com/new.aspx)来自我的网站的 HTTP POST 请求，其中包含我的 Twiddla 用户名。就像我在我的网站上写了这段代码一样，

```
<form action="http://www.twiddla.com/new.aspx" method="post">
<input type="text" id="username" name="username">
<input type="submit" value="Create Meeting"> 
```

通过提交表单，页面被重定向到 twiddla.com/new.aspx 并在该页面中打印出一个数字 ID。我的网站如何获取 ID 并将其保存在数据库中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T18:58:19.923

您可以执行以下操作之一：

*   使用回调（必须由其他网站提供）
*   使用 php 或任何其他语言连接到服务。

# facebook - 如何使用 FQL 获取 `page_fan_adds` 多天

> ID：11746864
> 
> 赞同：0
> 
> 时间：2012-07-31T18:43:50.810
> 
> 标签：facebook, facebook-graph-api, facebook-fql

我可以`page_fan_adds`使用 FQL 获取特定日期的值。

```
SELECT metric, value FROM insights WHERE object_id = XXX AND 
metric = "page_fan_adds" AND end_time = end_time_date("2012-07-20") AND 
period = period("day") 
```

我得到：

```
{"data": [
    {"metric": "page_fan_adds", 
      "value": 1}
]} 
```

但是，使用 Graph API，我可以获取为期一个月的数据：`graph.facebook.com/XXX/insights/page_fan_adds/?since= 1340175600&until=1342767600`. 我得到：

```
{"data": [
  {"id": "XXX/insights/page_fan_adds/day", 
   "name": "page_fan_adds", 
   "period": "day", 
   "values": [
     {"value": 4, 
      "end_time": "2012-06-21T07:00:00+0000"}, 
     {"value": 2, 
      "end_time": "2012-07-20T07:00:00+0000"}
  ], 
  "title": "Daily New Likes", 
  "description": "Daily The number of new people who have liked your Page (Total Count)"}], 
"paging": {
  "previous": "https://graph.facebook.com/XXX/insights/page_fan_adds/?since=1337583600&until=%201340175600", 
  "next": "https://graph.facebook.com/XXX/insights/page_fan_adds/?since=1342767600&until=1345359600"
  }
} 
```

`period`列只能是`day`for `page_fan_adds`。那么如何使用 FQL 获取一个月的数据呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T19:34:10.953

它似乎是通过分别查询所有日期然后聚合它们来做到这一点的唯一方法。

```
SELECT metric, value FROM insights WHERE object_id=XXX AND 
   metric = "page_fan_adds" AND period = period("day") AND (
      end_time = end_time_date("2012-07-20") OR 
      end_time = end_time_date("2012-07-19") OR
      ...
      end_time = end_time_date("2012-06-21")
   ) 
```

尝试`end_time IN`抛出错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-22T20:43:00.423

```
SELECT metric, value FROM insights 
WHERE object_id=XXX 
AND metric = "page_fan_adds" 
AND period = period("day") 
AND end_time in ( 
  end_time_date("2012-07-20"), 
  end_time_date("2012-07-19"), 
  end_time_date("2012-06-21")
) 
```

# silverlight - 在 Silverlight ComboBox 中过滤枚举

> ID：11746865
> 
> 赞同：1
> 
> 时间：2012-07-31T18:43:59.817
> 
> 标签：silverlight, data-binding, combobox, enums

我有一个代表可能配置的枚举。（以下只是一个例子......）

```
public enum ConfigurationType {
    [Description("Minimal Configuration")]
    Minimal = 0,
    [Description("Standard Configuration")]
    Standard,
    [Description("Premium Configuration")]
    Premium
} 
```

现在，我正在使用值转换器（在[此处](http://charlass.wordpress.com/2009/07/29/binding-enums-to-a-combobbox-in-silverlight/)`ConfigurationType`找到）将我的类中的类型属性绑定到 ComboBox以显示描述。这很好用。然而，我想做的是能够动态禁用特定枚举成员的选择，结果是它们不会出现在组合框中。

我曾尝试将此枚举转换为标志枚举，然后绑定到一组标志，但并没有走得太远。关于那个或其他建议的任何指示？

**编辑 - 标志示例**

尝试使用标志时，我将枚举更改为：

```
[Flags]
public enum ConfigurationType {
    [Description("Minimal Configuration")]
    Minimal = 1 << 0,
    [Description("Standard Configuration")]
    Standard = 1 << 1,
    [Description("Premium Configuration")]
    Premium = 1 << 2
}

public ConfigurationType AvailableConfigs = ConfigurationType.Standard | ConfigurationType.Premium; 
```

它实际上适用于能够将这些按位或列表分配给诸如 AvailableConfigs 的变量（如上所示），但是值转换器部分是挂断。我不确定如何实现一个值转换器来获取 AvailableConfigs 中存在的每个标志的描述，并能够转换回一个变量（也是 ConfigurationType），例如 SelectedConfiguration。SelectedConfiguration 的设置器当然会一次只强制执行一个标志。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-01T14:12:51.830

如果您可以在 XAML 中定义可用选项，则可以执行以下操作：

## 在你的 EnumValuesConverter.cs

```
public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
{
    if (value == null)
        return null;
    else
    {
        if (string.IsNullOrEmpty((string)parameter))
        {
            return EnumValueCache.GetValues(value.GetType());
        }
        return EnumValueCache.GetValues(value.GetType()).Where(x => parameter.ToString().Contains(x.ToString()));
    }
} 
```

并与这样使用的 ConverterParameter 绑定：

```
<ComboBox Height="23" HorizontalAlignment="Left" Margin="25,27,0,0" Name="comboBox1" VerticalAlignment="Top" Width="120" 
          ItemsSource="{Binding MyEnumProperty, Converter={StaticResource enumConverter}, ConverterParameter=Minimal-Standard}"
          SelectedItem="{Binding MyEnumProperty, Mode=TwoWay}"/> 
```

它将仅显示使用 ConverterParameter 作为简单字符串过滤器的`Minimal`和选项。`Standard`

如果您需要更动态的东西，请直说。您无法绑定 ConverterParameters（不幸的是），因此需要更多工作。

## 动态属性解决方案

要使用`AvailableConfigs`属性做同样的事情，您需要实现一个 MultiBinding 解决方案（它允许您绑定到多个属性）。

绑定的顺序很重要，因为这将是它们传递给转换器的顺序。

## 例如

```
<ComboBox Height="23" HorizontalAlignment="Left" Margin="25,27,0,0" Name="comboBox2" VerticalAlignment="Top" Width="120" >
    <ComboBox.ItemsSource>
        <MultiBinding Converter="{StaticResource enumConverter}">
            <Binding Path="MyEnumProperty" />
            <Binding Path="AvailableConfigs" />
        </MultiBinding>
    </ComboBox.ItemsSource>
</ComboBox> 
```

**MultiBinding 只是 WPF 的一部分，而不是 Silverlight，所以这里有一些 Silverlight MultiBinding 解决方案：**

*   [http://www.scottlogic.co.uk/blog/colin/2010/05/silverlight-multibinding-solution-for-silverlight-4/](http://www.scottlogic.co.uk/blog/colin/2010/05/silverlight-multibinding-solution-for-silverlight-4/)
*   [http://www.olsonsoft.com/blogs/stefanolson/post/Improvements-to-Silverlight-Multi-binding-support.aspx](http://www.olsonsoft.com/blogs/stefanolson/post/Improvements-to-Silverlight-Multi-binding-support.aspx)

# php - PHP在会话变量中传递数组

> ID：11746869
> 
> 赞同：2
> 
> 时间：2012-07-31T18:44:11.340
> 
> 标签：php, session, variables

我试图让一个数组将会话变量从一个页面传递到另一个页面。我将会话变量设置为等于从我的表单收集的 $_POST 数据。打印用于测试的变量表明它最初是在第 1 页设置的。

第 1 页

```
session_start(); // start up your PHP session! 

if(isset($_POST['submit']))
{

unset($_POST['submit']);
$_SESSION['userdata'] = $_POST;
$userqty=$_POST;
print_r($_SESSION['userdata']); 
```

在第 2 页上，我试图将其设置为等于另一个变量。我再次测试以查看数组是否已传递到第 2 页，但它没有传递，并且我收到一个错误，因为**array_sum**函数没有有效的数组

session_start(); // 启动你的 PHP 会话！

```
$_SESSION['userdata'] = $userqty;

print_r($_SESSION['userdata']);

print_r($userqty;);

$userqty_total=array_sum($userqty); 
```

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-31T18:47:09.937

您正在设置`$_SESSION['userdata']`为 的值`$userqty`，该值未初始化。

将第一行更改为：

```
session_start();
$userqty = $_SESSION['userdata'] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-31T18:50:48.050

签出 php 中的[序列化和反序列化函数。](http://php.net/manual/en/function.serialize.php)

编辑：实际上您不需要将数组转换为字符串并将其转换回数组。您可以按原样使用它。

在第一页：

```
$_SESSION['data'] = $_POST; 
```

在第二页：

```
$temp = $_SESSION['data']; 
```

现在`$temp`有`$_POST`第 1 页的内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2022-02-26T23:02:02.293

在第 1 页：

```
 session_start();
 $array  = array("appel","car","human");
 $_SESSION['array'] = $array ; 
```

在第 2 页中：

```
for ($i = 0; $i < count($nom); $i++) {
        echo $array[$i] . ' ';
   } 
```

# android - Android，如何使应用程序的任务不可关闭？只能通过任务杀死关闭

> ID：11746875
> 
> 赞同：2
> 
> 时间：2012-07-31T18:44:25.007
> 
> 标签：android, taskkill

我正在开发一个必须始终运行并且只能通过任务杀手或类似工具关闭的应用程序。

我在清单中有：

```
android:persistent="true" 
```

虽然按下主页按钮时没有关闭，但我发现它有时会关闭，我不希望这种情况发生。

我用户想要，可以通过从自定义启动器中杀死它或使用任务杀手来关闭应用程序。

有什么建议么？提前致谢

PD：如何使用后退按钮退出应用程序，但不关闭它，我的意思是停止显示应用程序或其任何活动，但应用程序应继续在后台运行。

我写了一个服务，但有些东西不能正常工作我在清单中添加了这个

```
<service android:name=".ONService"></service> 
```

就在应用程序标记结束之前，这是 ONService.java：

```
package com.omninotifier.main;

import android.app.Notification;
import android.app.NotificationManager;
import android.app.Service;
import android.content.Context;
import android.content.Intent;
import android.os.IBinder;

public class ONService extends Service{

@Override
public IBinder onBind(Intent intent) {
    // TODO Auto-generated method stub
    return null;
}

@Override
public void onCreate() {
    // TODO Auto-generated method stub
    //super.onCreate();
}

@Override
public int onStartCommand(Intent intent, int flags, int startId) {
    // TODO Auto-generated method stub
    //return super.onStartCommand(intent, flags, startId);

    return START_STICKY;
}

@Override
public void onDestroy() {
    // TODO Auto-generated method stub

    NotificationManager manager = (NotificationManager)     
getSystemService(Context.NOTIFICATION_SERVICE);
    Notification notification = new Notification(R.drawable.ic_stat_alert,   
getResources().getString(R.string.ServiceDestroyed), System.currentTimeMillis());
    notification.flags = Notification.FLAG_AUTO_CANCEL;
    manager.notify(150, notification);

    super.onDestroy();
}

 } 
```

我启动服务，应用程序启动：

这是应用程序中的主要活动

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

   Intent serviceIntent = new Intent();
   serviceIntent.setAction(".ONService");
   startService(serviceIntent);

//............

} 
```

我应该在服务标签中添加带有操作的意图过滤器以使其正常工作吗？还是其他问题？

问题是它无法启动服务。这是修复：

在清单中

```
<service android:name=".ONService">
<intent-filter android:priority="100">
    <action android:name=".ONService"/>
</intent-filter>
</service> 
```

在调用服务的活动中：

```
Intent serviceIntent = new Intent(".ONService");

startService(serviceIntent); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T19:03:54.357

> 我正在开发一个必须始终运行并且只能通过任务杀手或类似工具关闭的应用程序。

这在严格意义上是不可能的。Android 可以并且最终会摆脱您的进程，以防止草率的开发人员试图拥有“必须始终运行的应用程序”。

如果您的应用程序是前台用户体验的一部分（例如，音乐播放器），您可以拥有一个调用 的服务`startForeground()`，这会降低 Android 摆脱您的进程的几率，只要`Notification`状态栏中有一个你的应用程序。您的应用程序最终仍会终止其进程，尽管它往往需要更长的时间。

或者，您可以自定义构建包含实现您的逻辑的 C 守护程序的 Android 操作系统，并分发包含您定制的 Android 的 ROM 模块。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-31T18:47:29.483

要让您的应用程序在关闭后继续运行，您需要在应用程序内部创建一个服务来执行您希望在后台发生的任何事情。

如果您是开发 Android 应用程序的新手，您可能需要查看以下 Android 服务教程：[http](http://www.vogella.com/articles/AndroidServices/article.html) ://www.vogella.com/articles/AndroidServices/article.html 。此外，我发现 Android 文档非常有帮助。我建议您阅读[API Guide for Services](http://developer.android.com/guide/components/services.html)和[API Reference for the Service class](http://developer.android.com/reference/android/app/Service.html)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-31T18:47:56.663

写一个服务。您的应用程序与服务通信。当您的应用程序退出时，该服务将继续运行。

[http://developer.android.com/reference/android/app/Service.html](http://developer.android.com/reference/android/app/Service.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-31T19:59:03.410

使用 Service、AlarmManager 和 BroadcastReceiver 的组合。AlarmManager 发出一个脉冲，BCReceiver 会根据需要每隔一段时间捕获并启动服务。这将实质上使服务无休止地活着，因为 Android 会看到它会定期被使用。从技术上讲，您的应用程序的生命周期，服务受 androids 控制，但您可以启动服务粘性，这有助于并定期调用它。AlarmManager 非常可靠。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-03-18T07:35:42.180

如果您需要始终运行，请查看 a`Service`和[startForeground](http://developer.android.com/reference/android/app/Service.html#startForeground%28int,%20android.app.Notification%29)。如果您可以让您的服务死掉但重新启动，请查看[onStartCommand](http://developer.android.com/reference/android/app/Service.html#onStartCommand%28android.content.Intent,%20int,%20int%29)和[START_STICKY](http://developer.android.com/reference/android/app/Service.html#START_STICKY)。

# mysql - 使用文件排序和临时优化查询

> ID：11746878
> 
> 赞同：0
> 
> 时间：2012-07-31T18:44:35.270
> 
> 标签：mysql, explain

谁能帮我优化这个查询。运行需要一段时间：

su_pref 表有近 900,000 行

```
SELECT p.mykey,
       p.merchant_name,
       m.merchant_url, 
       p.name,
       p.description,
       p.image_url, 
       p.deep_link,
       p.rrp_price, 
       p.display_price, 
       c.category,
       p.su_parent_name 
FROM su_pref p #
        INNER JOIN su_categoryrefs cr ON p.mykey = cr.mykey 
        INNER JOIN su_categories c ON cr.id = c.id 
        INNER JOIN su_merchants m ON p.merchant_id=m.id 
WHERE 
     cr.id =36 
 ORDER BY p.date_created DESC LIMIT 0,20 
```

这就是我使用 EXPLAIN 时得到的

![在此处输入图像描述](../Images/a34465abb7e11c05b08db6cf6efc43a5.png) 我真的很难理解如何使用 EXPLAIN 来优化查询，所以任何帮助将不胜感激。

这是表定义。su_pref 表很大，所以我去掉了一些字段

```
CREATE TABLE `su_pref` (
  `mykey` varchar(50) NOT NULL,
  `merchant_id` smallint(3) default NULL,
  `merchant_name` varchar(50) NOT NULL default '',
  `brand` varchar(50) default NULL,
  `merchantproductkey` varchar(50) default NULL,
  `upc` varchar(15) default NULL,
  `name` varchar(255) NOT NULL default '',
  `description` varchar(2500) NOT NULL default '',
  `short_description` varchar(500) default NULL,
  `thumb_url` varchar(500) default NULL,
  `image_url` varchar(500) default NULL,
  `deep_link` varchar(1000) default NULL,
  `merchant_link` varchar(255) default NULL,
  `rrp_price` decimal(11,2) default NULL,
  `display_price` decimal(11,2) default NULL,
  `delivery_cost` decimal(11,2) default NULL,
  `price_range` tinyint(1) default NULL,
  `keywords` varchar(500) default NULL,
  `su_parent_name` enum('Women','Men','') NOT NULL,
  `date_created` date default NULL,
  `date_modified` datetime default NULL,
  `wp_featured` varchar(1) default NULL,
  `hp_featured` varchar(1) default NULL,
  `published` varchar(1) default NULL,
  `in_todays_feed` varchar(1) default NULL,
  PRIMARY KEY  (`mykey`),
  KEY `merchant_id` (`merchant_id`),
  KEY `date_created` (`date_created`),
  FULLTEXT KEY `product_search` 
                (`name`,`description`,`short_description`,
                 `keywords`, `product_type`,`colour`,`style`,
                 `material`,`datafeed_category_name`,
                 `datafeed_subcategory_name`,
                 `brand`,`merchant_name`),
  FULLTEXT KEY `name` (`name`,`datafeed_category_name`, 
                       `datafeed_subcategory_name`,`product_type`,`keywords`)
) ENGINE=MyISAM DEFAULT CHARSET=latin1 
```

-

```
CREATE TABLE `su_categories` (
  `id` mediumint(9) NOT NULL,
  `category` varchar(100) NOT NULL,
  `parent_id` tinyint(4) NOT NULL,
  `update_query` varchar(3000) default NULL,
  `url` varchar(150) default NULL,
  `last_update` datetime default NULL,
  PRIMARY KEY  (`id`,`category`,`parent_id`),
  KEY `parent_id` (`parent_id`),
  KEY `category_id` (`id`),
  FULLTEXT KEY `category_name` (`category`)
) ENGINE=MyISAM DEFAULT CHARSET=latin1 
```

-

```
CREATE TABLE `su_categoryrefs` (
  `mykey` varchar(255) NOT NULL,
  `id` smallint(4) NOT NULL,
  PRIMARY KEY  (`mykey`,`id`),
  KEY `id` (`id`)
) ENGINE=MyISAM DEFAULT CHARSET=latin1 
```

-

```
CREATE TABLE `su_merchants` (
  `id` mediumint(9) NOT NULL,
  `merchant_name` varchar(40) NOT NULL,
  `merchant_url` varchar(40) default NULL,
  `merchant_website` varchar(40) default NULL,
  `merchant_description` varchar(2000) default NULL,
  `merchant_featured` varchar(1) default NULL,
  PRIMARY KEY  (`id`),
  UNIQUE KEY `merchant_name` (`merchant_name`)
) ENGINE=MyISAM AUTO_INCREMENT=128 DEFAULT CHARSET=latin1 
```

先感谢您

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T19:13:43.727

~~无法判断每个不合格列是从哪个表返回的，或者 JOIN 谓词中的“merchant_id”是从哪个表引用的，或者 ORDER BY 子句中的 date_created 是从哪个表引用的。（我们可以做出一些猜测，但它们只是猜测而已。~~

~~实际上，第一步是使用 table_name 或最好是表别名来限定所有这些列引用。~~

~~此外，格式化声明以便普通人能够理解它有很大帮助。~~

带有限定列引用的重新格式化语句会有所帮助，并且包含架构定义也有帮助。（我会更新我的答案。）

```
SELECT p.mykey
     , p.merchant_name
     , merchant_url
     , `name`
     , description
     , image_url
     , deep_link
     , rrp_price
     , display_price
     , category
     , su_parent_name
 FROM su_pref p
 JOIN su_categoryrefs cr ON cr.mykey = p.mykey
 JOIN su_categories c    ON c.id     = cr.id
 JOIN su_merchants m     ON m.id     = p.merchant_id
WHERE cr.id = 36
ORDER BY date_created DESC LIMIT 0,20 
```

作为一般的经验法则，最好有一个索引，其中前导列是连接谓词中引用的列。通常，这些是主键和所有外键。

此外，如果是“覆盖索引”（包含查询中引用的所有列的索引），您将在 EXPLAIN 输出中看到“使用索引”；这意味着在不引用数据块的情况下从索引满足查询。

EXPLAIN 似乎显示了一个“colour_id”索引被引用，但该索引中包含哪些列并不明显。（EXPLAIN PLAN 输出图像对我来说太难阅读了。）

* * *

这里有一些建议：

确保你有一个索引

```
ON su_categories (id, category)     -- you do
ON su_merchants (id, merchant_url)  -- never mind this one, it's a small table
ON su_categoryrefs (id, mykey) 
```

我假设表中的`id`列`su_categoryrefs`是外键引用`su_categories.id`，而不是表的主键。（这看起来像一个关系表，它解决了和 'su_preferences` 之间的多对多关系`su_categories`，但我只是在猜测。

# xml - 我想使用coldfusion创建一个多标签电子表格

> ID：11746887
> 
> 赞同：0
> 
> 时间：2012-07-31T18:45:16.663
> 
> 标签：xml, coldfusion

我正在尝试使用 ColdFusion 8 创建一个 Excel 电子表格（具有多个工作表和嵌套表）。虽然我遇到了很多解决方案，但我仍然找不到任何适合我的特定要求的东西，即使电子表格包含多个工作表，每个工作表都将包含嵌套表。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T19:08:59.240

查看 Ben Nadel 整理的 POI 博客文章。[http://www.bennadel.com/projects/poi-utility.htm](http://www.bennadel.com/projects/poi-utility.htm)我用这个，效果很好。很容易设置

# javascript - 我应该将类方法移动到原型吗？

> ID：11746888
> 
> 赞同：3
> 
> 时间：2012-07-31T18:45:25.817
> 
> 标签：javascript, performance, prototype

我有课

```
function Foo(a) {
  this.a = a;
  this.bar = function () {
    console.log(this.a);
  };
  this.buz = function () {
    this.a();
    console.log('bzz');
  };
} 
```

我会有很多此类的实例。我应该将方法移动到原型吗？

```
function Foo(a) {
  this.a = a;
}
Foo.prototype = {
  bar: function () {
    console.log(this.a);
  },
  buz: function () {
    this.a();
    console.log('bzz');
  }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-31T18:47:45.950

是的。这将节省内存，因为每次`shared`实例化类时都会重新创建每个方法，而不是重新创建。

构造函数内部的方法被认为`privileged methods`可以访问`private variables`构造函数内部的方法，并且仅在您需要访问私有变量时才应使用。

[Crockford 谈特权方法](http://www.crockford.com/javascript/private.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-31T18:48:21.760

放置类方法是节省内存的好主意。原型中只有一个方法实例，而不是每个对象中的许多实例。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-31T18:51:16.037

在 JS 的构造函数中定义方法的唯一原因是创建一个“ [Privileged](http://www.crockford.com/javascript/private.html) ”方法。

这个想法是创建一个公开可用的方法，但可以访问私有实例变量。

# java - 如何在组件绘制时创建“请稍候”Swing 对话框

> ID：11746891
> 
> 赞同：4
> 
> 时间：2012-07-31T18:45:31.393
> 
> 标签：java, swing, jfreechart

对 Swing 来说仍然相对较新，但经过几个小时的搜索，我无法在网上找到答案，因此发表了这篇文章（抱歉，如果已经回答但我忽略了它）。

我在 Swing 应用程序中使用 JFreeChart。一些图表相对较重（180k 数据点），JFreeChart 的 ChartPanel 需要大约 6 秒来完成它的第一个 paintComponent()。

因此，我想在组件绘制时在对话框中显示“请稍候”消息（无需使用 SwingWorker 显示进度）。我试图覆盖paintComponent 方法，但不幸的是该消息从未出现在屏幕上（我猜线程直接进入绘制图表，而没有花时间绘制对话框）。

我的代码如下所示：

```
public class CustomizedChartPanel extends ChartPanel{

private static final long serialVersionUID = 1L;
private JDialog dialog = null;
boolean isPainted = false;

public CustomizedChartPanel(JFreeChart chart) { super(chart); }

@Override
public void paintComponent(Graphics g) {
    //At first paint (which can be lengthy for large charts), show "please wait" message
    if (! isPainted){
        dialog = new JDialog();
        dialog.setUndecorated(true);
        JPanel panel = new JPanel();
        panel.add(new JLabel("Please wait"));
        dialog.add(panel);
        dialog.pack();
        GuiHelper.centerDialog(dialog); //Custom code to center the dialog on the screen
        dialog.setVisible(true);
        dialog.repaint();
    }

    super.paintComponent(g);

    if (! isPainted){
        isPainted = true;
        dialog.dispose();
            super.repaint();
        }
}
} 
```

非常感谢任何有关如何解决此问题/最佳实践的指示！

谢谢，托马斯

* * *

更新：

感谢您的提示和辩论：非常有帮助。

我开始使用 invokeLater() 实施建议的解决方案，因为我担心 JLayer 解决方案将无法工作，因为它也在 EDT 上运行。

不幸的是，当invokeLater() 调用paintComponent() 时，我遇到了一个空指针异常。

我的代码如下所示：

```
 @Override
public void paintComponent(Graphics graph) {
    //At first paint (which can be lengthy for large charts), show "please wait" message
    if (! isPainted){
        isPainted = true;
        dialog = new JDialog();
        dialog.setUndecorated(true);
        JPanel panel = new JPanel();
        panel.add(new JLabel("Please wait"));
        panel.add(new JLabel("Please wait !!!!!!!!!!!!!!!!!!!!!!!!!!!!!"));
        dialog.add(panel);
        dialog.pack();
        GuiHelper.centerDialog(dialog); //Custom code to center the dialog on the screen
        dialog.setVisible(true);
        dialog.repaint();
        RunnableRepaintCaller r = new RunnableRepaintCaller(this, graph, dialog);
        SwingUtilities.invokeLater(r);
    }
    else super.paintComponent(graph); //NULL POINTER EXCEPTION HERE (invoked by runnable class)
} 
```

可运行的类是：

```
public class RunnableRepaintCaller implements Runnable{
private ChartPanel target;
private Graphics g;
private JDialog dialog;

public RunnableRepaintCaller(ChartPanel target, Graphics g, JDialog dialog){
    this.target = target;
    this.g = g;
    this.dialog = dialog;
}

@Override
public void run() {
    System.out.println(g);
    target.paintComponent(g);
    dialog.dispose();
}
} 
```

再次，任何指针将不胜感激！

托马斯

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-31T20:04:47.573

这是一个示例和/但它使用 SwingWorker。您应该认真考虑使用它，因为如果操作系统以某种方式使您的框架无效并且您的 JFreeChart 的加载是在 EDT（事件调度线程）上完成的，那么您的 GUI 将看起来冻结。

它还允许您在处理数据时提供更好的用户反馈。（对不起，如果代码有点长，但大多数有趣的代码都在 initUI 和 SwingWorker 中）。

注意：您可以使用 JLayer（如果您使用 Java 7）代替对话框，但在我的示例中这是不必要的。

该代码的灵感来自[http://www.vogella.com/articles/JFreeChart/article.html](http://www.vogella.com/articles/JFreeChart/article.html)

```
/**
 * This code was directly taken from: http://www.vogella.com/articles/JFreeChart/article.html
 * All credits goes to him for this code.
 * 
 * Thanks to him.
 */

import java.util.List;

import javax.swing.JDialog;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JPanel;
import javax.swing.SwingUtilities;
import javax.swing.SwingWorker;

import org.jfree.chart.ChartFactory;
import org.jfree.chart.ChartPanel;
import org.jfree.chart.JFreeChart;
import org.jfree.chart.plot.PiePlot3D;
import org.jfree.data.general.DefaultPieDataset;
import org.jfree.data.general.PieDataset;
import org.jfree.util.Rotation;

public class PieChart extends JFrame {

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {
            @Override
            public void run() {
                initUI();
            }
        });
    }

    protected static void initUI() {
        // First we create the frame and make it visible
        final PieChart demo = new PieChart("Comparison");
        demo.setSize(500, 270);
        demo.setVisible(true);
        // Then we display the dialog on that frame
        final JDialog dialog = new JDialog(demo);
        dialog.setUndecorated(true);
        JPanel panel = new JPanel();
        final JLabel label = new JLabel("Please wait...");
        panel.add(label);
        dialog.add(panel);
        dialog.pack();
        // Public method to center the dialog after calling pack()
        dialog.setLocationRelativeTo(demo);

        // allowing the frame and the dialog to be displayed and, later, refreshed
        SwingWorker<JFreeChart, String> worker = new SwingWorker<JFreeChart, String>() {

            @Override
            protected JFreeChart doInBackground() throws Exception {
                publish("Loading dataset");
                // simulating the loading of the Dataset
                try {
                    System.out.println("Loading dataset");
                    Thread.sleep(2000);
                } catch (InterruptedException e) {
                    e.printStackTrace();
                }
                // This will create the dataset 
                PieDataset dataset = demo.createDataset();
                publish("Loading JFreeChart");
                // simulating the loading of the JFreeChart
                try {
                    System.out.println("Loading JFreeChart");
                    Thread.sleep(2000);
                } catch (InterruptedException e) {
                    e.printStackTrace();
                }
                // based on the dataset we create the chart
                JFreeChart chart = demo.createChart(dataset, "Which operating system are you using?");
                // we put the chart into a panel
                return chart;
            }

            @Override
            protected void process(List<String> chunks) {
                label.setText(chunks.get(0));
                dialog.pack();
                dialog.setLocationRelativeTo(demo);
                dialog.repaint();
            }

            @Override
            protected void done() {
                try {
                    // Retrieve the created chart and put it in a ChartPanel
                    ChartPanel chartPanel = new ChartPanel(this.get());
                    // add it to our frame
                    demo.setContentPane(chartPanel);
                    // Dispose the dialog.
                    dialog.dispose();
                    // We revalidate to trigger the layout
                    demo.revalidate();
                    // Repaint, just to be sure
                    demo.repaint();
                } catch (Exception e) {
                    e.printStackTrace();
                }
            }

        };
        SwingUtilities.invokeLater(new Runnable() {
            @Override
            public void run() {
                     worker.execute();
            }
        });
        dialog.setVisible(true);
    }

    public PieChart(String applicationTitle) {
        super(applicationTitle);
    }

    /** * Creates a sample dataset */

    private PieDataset createDataset() {
        DefaultPieDataset result = new DefaultPieDataset();
        result.setValue("Linux", 29);
        result.setValue("Mac", 20);
        result.setValue("Windows", 51);
        return result;

    }

    /** * Creates a chart */

    private JFreeChart createChart(PieDataset dataset, String title) {

        JFreeChart chart = ChartFactory.createPieChart3D(title, // chart title
                dataset, // data
                true, // include legend
                true, false);
        PiePlot3D plot = (PiePlot3D) chart.getPlot();
        plot.setStartAngle(290);
        plot.setDirection(Rotation.CLOCKWISE);
        plot.setForegroundAlpha(0.5f);
        return chart;

    }

} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-31T18:47:45.257

您可以按照[此处](http://docs.oracle.com/javase/tutorial/uiswing/misc/jlayer.html#animating)`JLayer`的说明使用。这专门用于您想要的繁忙指示器。

此外，您可以保留`JPanel`直到`setEnabled(false)`您的数据完全加载。这可以防止对`JPanel`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-31T18:54:36.233

自从我在 Java 中做任何事情以来已经有很长时间了，但据我所知，该`repaint()`方法实际上并没有导致任何绘图发生。它只是将控件标记为需要尽快重绘。`paint()`如果要立即绘制组件，则需要直接调用该方法。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-07-31T18:55:47.267

您需要在新线程中启动等待对话框。我不知道您是如何创建图表的，但这是一个示例

```
SwingUtilities.invokeLater(new Runnable() {
        public void run() {
             dialog = new JDialog();
             dialog.setUndecorated(true);
             JPanel panel = new JPanel();
             panel.add(new JLabel("Please wait"));
             dialog.add(panel);                
             GuiHelper.centerDialog(dialog); 
             dialog.setVisible(true);

            Thread performer = new Thread(new Runnable() {
                public void run() {
                    dialog.setVisible(false); 
                    //Here the code that prepare the chart                              
                }
        });
        performer.start();
    }
}); 
```

# rest - 有效请求但空数据的正确 REST 响应代码是什么？

> ID：11746894
> 
> 赞同：459
> 
> 时间：2012-07-31T18:45:39.670
> 
> 标签：rest, http, api-design

例如，您运行 GET 请求`users/9`但没有 ID 为 #9 的用户。哪个是最好的响应代码？

*   200 好
*   202 接受
*   204 无内容
*   400 错误请求
*   404 未找到

* * *

## 回答 #1

> 赞同：464
> 
> 时间：2014-11-24T09:42:24.093

我强烈反对 404 支持 204 或 200 有空数据。或者至少应该使用带有 404 的响应实体。

请求已被接收并正确处理 - 它确实触发了服务器上的应用程序代码，因此不能真正说它是客户端错误，因此整个客户端错误代码 (4xx) 类不合适。

更重要的是，404 可能由于多种技术原因而发生。例如，应用程序在服务器上被暂时停用或卸载，代理连接问题等等。

当然，这种情况下存在 5xx 错误类，但实际上受影响的中间件组件通常无法知道错误在他们这边，然后只是假设错误在客户端，然后以 404 响应而不是 500/503。

因此，仅根据状态码，客户端无法区分表示“空结果集”的 404 和表示“出现严重错误，将此错误报告给运维团队”的 404。

这可能是致命的：想象一下您公司的会计服务列出了所有应获得年度奖金的员工。不幸的是，当它被调用时，它会返回一个 404。这是否意味着没有人应该获得奖金，或者应用程序当前因新部署而停机？

-> 对于需要知道所请求的资源确实不存在而不是暂时无法访问的应用程序，因此没有响应实体的 404 几乎是不可行的。

此外，许多客户端框架通过抛出异常来响应 404，并且不再询问任何问题。这迫使客户端开发人员捕获该异常，对其进行评估，然后基于此决定是否将其记录为由例如监视组件拾取的错误或是否忽略它。这对我来说似乎也不漂亮。

404 相对于 204 的优势在于它可以返回一个响应实体，其中可能包含一些关于为什么找不到所请求的资源的信息。但如果这确实相关，那么人们也可以考虑使用 200 OK 响应并以允许有效负载数据中的错误响应的方式设计系统。或者，可以使用 404 响应的有效负载将结构化信息返回给调用者。如果他收到例如 html 页面而不是他可以解析的 XML 或 JSON，那么这是一个很好的指示，表明出现了技术问题，而不是从调用者的角度来看可能是有效的“无结果”回复。或者可以为此使用 HTTP 响应标头。

不过，我仍然更喜欢带有空响应的 204 或 200。这样，请求的技术执行状态与请求的逻辑结果是分开的。2xx 表示“技术执行ok，这是结果，处理它”。

我认为在大多数情况下，应该由客户来决定是否可以接受空结果。尽管技术执行正确，但通过在没有响应实体的情况下返回 404，客户端可以决定将案例视为错误，而这些错误根本就不是错误。

另一个简单的类比：“未找到结果”返回 404 就像在 SQL 查询未返回任何结果时抛出 DatabaseConnectionException。它可以完成工作，但是有很多可能的技术原因会引发相同的异常，然后会被误认为是有效的结果。

另一个角度：从操作的角度来看，404 可能是有问题的。由于它可以指示连接问题而不是有效的服务响应，因此我不希望我的指标/仪表板中可能隐藏应该调查和修复的真正技术问题的“有效” 404 数量波动。

编辑：哇，这引起了很多争议。这是反对 404 的另一个论点：严格从 HTTP 规范 (RFC7231) 的角度来看，404 甚至不意味着资源不存在。这仅意味着服务器没有可用的请求资源的当前表示，这甚至可能只是暂时的。因此，严格按照 HTTP 规范，404 在所请求的事物不存在方面本质上是不可靠的。如果您想传达所请求的事物肯定不存在，请不要使用 404。

* * *

## 回答 #2

> 赞同：335
> 
> 时间：2012-08-01T13:23:47.237

TL;DR：使用`404`

请参阅[此博客](http://benramsey.com/blog/2008/05/http-status-204-no-content-and-205-reset-content/)。它很好地解释了它。

博客评论摘要`204`：

1.  `204 No Content`作为浏览器的响应代码并不是非常有用（尽管根据 HTTP 规范，浏览器确实需要将其理解为“不要更改视图”响应代码）。
2.  `204 No Content` *然而，对于可能想要指示成功而不必返回某些内容的 ajax Web 服务非常有用*。*（特别是在不需要反馈的情况下）`DELETE`。`POST`*

 *因此，您的问题的答案是`404`在您的情况下使用。`204`是一个专门的响应代码，您不应该经常返回到浏览器以响应`GET`.

`204`比和更不合适的其他响应代码`404`：

1.  `200`应该与您成功获取的任何内容一起返回。当您获取的实体不存在时不合适。
2.  `202`当服务器已开始处理对象但对象尚未完全准备好时使用。当然不是这里的情况。您尚未开始，也不会开始构建用户 9 以响应`GET`请求。这打破了各种规则。
3.  `400`用于响应格式错误的 HTTP 请求（例如格式错误的 HTTP 标头、错误排序的段等）。这几乎肯定会由您使用的任何框架处理。除非您从头开始编写自己的服务器，否则您不必处理这个问题。**编辑**：[较新的 RFC](https://stackoverflow.com/a/20215807/456188)现在允许将 400 用于语义上无效的请求。

Wikipedia[对 HTTP 状态码的描述](http://en.wikipedia.org/wiki/List_of_HTTP_status_codes)特别有帮助。您还可以[在 www.w3.org 上查看 HTTP/1.1 RFC2616 文档中的定义](http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html)

* * *

## 回答 #3

> 赞同：98
> 
> 时间：2018-02-12T12:43:14.387

起初，我认为 204 会有意义，但经过讨论，我相信 404 是唯一真正正确的响应。考虑以下数据：

用户：约翰、彼得

```
METHOD  URL                      STATUS  RESPONSE
GET     /users                   200     [John, Peter]
GET     /users/john              200     John
GET     /unknown-url-egaer       404     Not Found
GET     /users/kyle              404     User Not found
GET     /users?name=kyle`        200     []
DELETE  /users/john              204     No Content 
```

*一些背景：*

1.  搜索返回一个数组，它只是没有任何匹配项，但它有内容：**一个空数组**。

2.  404 当然最出名的是请求的服务器不支持的 url，但缺少的资源实际上是相同的。
    即使`/users/:name`与 匹配`users/kyle`，用户 Kyle 也不是可用资源，因此 404 仍然适用。它不是搜索查询，它是**动态 url 的直接引用**，所以是 404。

3.  根据评论中的建议，自定义 404 的消息是帮助 API 使用者更好地区分完整未知路由和缺失实体的另一种方式。

无论如何，我的两分钱:)

* * *

## 回答 #4

> 赞同：31
> 
> 时间：2014-07-22T20:00:30.747

如果预计资源存在，但它可能是空的，我会争辩说，仅获得 200 OK 并带有表示该事物为空的表示可能会更容易。

所以我宁愿让 /things 返回一个带有 {"Items": []} 的 200 OK 而不是一个什么都没有的 204，因为通过这种方式，一个包含 0 个项目的集合可以被视为与一个或里面有更多的项目。

我只是将 204 No Content for PUTs 和 DELETEs 留下，这可能是真的没有有用的表示的情况。

如果 /thing/9 确实不存在，则 404 是合适的。

* * *

## 回答 #5

> 赞同：27
> 
> 时间：2012-07-31T18:47:50.517

在之前的项目中，我使用过 404。如果没有用户 9，则找不到对象。因此 404 Not Found 是合适的。

对于对象存在，但没有数据，204 No Content 将是合适的。我认为在您的情况下，该对象不*存在*。

* * *

## 回答 #6

> 赞同：19
> 
> 时间：2017-08-01T16:25:21.497

问了两个问题。一个在标题中，一个在示例中。我认为这在一定程度上导致了关于哪种回应是适当的争议。

问题标题询问空数据。空数据仍然是数据，但不等于没有数据。所以这建议请求一个结果集，即一个列表，可能来自`/users`. 如果列表为空，它仍然是一个列表，因此 204（无内容）是最合适的。您刚刚要求提供用户列表并提供了一个，它恰好没有内容。

提供的示例改为询问特定对象，用户，`/users/9`. 如果未找到用户 #9，则不返回任何用户对象。你请求了一个特定的资源（一个用户对象），但因为没有找到它而没有得到它，所以 404 是合适的。

我认为解决这个问题的方法是，如果您可以在不添加任何条件语句的情况下以您期望的方式使用响应，则使用 204，否则使用 404。

在我的示例中，我可以遍历一个空列表而不检查它是否有内容，但是我不能在不破坏某些内容或添加检查以查看它是否为空的情况下在空对象上显示用户对象数据。

如果适合您的需要，您当然可以使用空对象模式返回一个对象，但这是另一个线程的讨论。

* * *

## 回答 #7

> 赞同：17
> 
> 时间：2016-11-15T18:47:04.043

总结或简化，

2xx：可选数据：格式良好的 URI：条件不是 URI 的一部分：如果条件是可选的，可以在 @RequestBody 中指定，@RequestParam 应导致 2xx。示例：按名称/状态过滤

4xx：预期数据：格式不正确 URI：标准是 URI 的一部分：如果标准是强制性的，只能在 @PathVariable 中指定，那么它应该导致 4xx。示例：按唯一 ID 查找。

因此对于所问的情况：“users/9”将是 4xx（可能是 404）但是对于“users?name=superman”应该是 2xx（可能是 204）

* * *

## 回答 #8

> 赞同：15
> 
> 时间：2017-03-28T13:21:47.637

根据[w3](https://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html)帖子，

> **200 好**

请求已成功。响应返回的信息取决于请求中使用的方法

> **202 接受**

请求已被接受处理，但处理尚未完成。

> **204 无内容**

服务器已完成请求，但不需要返回实体主体，并且可能希望返回更新的元信息。

> **400 错误请求**

由于语法错误，服务器无法理解该请求。客户端不应该在没有修改的情况下重复请求

> **401未经授权**

该请求需要用户身份验证。响应必须包含一个 WWW-Authenticate 头域

> **404 未找到**

服务器未找到任何与请求 URI 匹配的内容。没有说明这种情况是暂时的还是永久性的

* * *

## 回答 #9

> 赞同：13
> 
> 时间：2018-12-26T11:36:37.447

现有答案没有详细说明的是，无论您使用路径参数还是查询参数，都会有所不同。

*   在路径参数的情况下，该参数是资源路径的一部分。在 的情况下`/users/9`，响应应该是`404`因为找不到该资源。`/users/9`是资源，结果是一元的，或者错误，不存在。这*不是*单子。
*   在查询参数的情况下，该参数不是资源路径的一部分。在 的情况下`/users?id=9`，响应应该是`204`因为`/users`找到了资源但它无法返回任何数据。资源`/users`存在且结果为 n 元，即使为空也存在。如果`id`是唯一的，这*是*一个单子。

是使用路径参数还是查询参数取决于用例。我更喜欢用于强制、规范或标识参数的路径参数和用于可选、非规范或属性参数的查询参数（如分页、排序规则语言环境和其他内容）。在 REST API 中，我`/users/9`不会`/users?id=9`特别使用，因为可能会嵌套获取“子记录”，例如`/users/9/ssh-keys/0`获取第一个公共 ssh 密钥或`/users/9/address/2`获取第三个邮政地址。

我更喜欢使用 404。原因如下：

*   对一元（1 个结果）和 n 元（n 个结果）方法的调用不应无故改变。如果可能的话，我喜欢使用相同的响应代码。预期结果的数量当然是不同的，例如，您希望主体是一个对象（一元）或一个对象数组（n-ary）。
*   对于 n 元，我会返回一个数组，如果没有结果，我不会返回任何集合（无文档），我会返回一个空集合（空文档，如 JSON 中的空数组或 XML 中的空元素）。也就是说，它仍然是 200，但记录为零。除了身体之外，没有理由将这些信息放在电线上。
*   `204`就像一种`void`方法。我不会将它用于`GET`，仅用于`POST`、`PUT`和`DELETE`。`GET`如果标识符是查询参数而不是路径参数，我会例外。
*   没有找到记录之类的`NoSuchElementException`，`ArrayIndexOutOfBoundsException`或者类似的东西，是由客户端使用不存在的 id 引起的，所以，这是一个客户端错误。
*   从代码的角度来看，getting`204`意味着代码中可以避免的额外分支。它使客户端代码复杂化，在某些情况下，它还使服务器代码复杂化（取决于您使用实体/模型单子还是普通实体/模型；我*强烈*建议远离实体/模型单子，它可能会导致令人讨厌的错误，因为您认为操作成功并返回 200 或 204 的 monad，而实际上您应该返回其他东西）。
*   客户端代码更容易编写和理解，如果 2xx 表示服务器完成了客户端请求的操作，而 4xx 表示服务器没有执行客户端请求的操作，这是客户端的错。没有给客户端id请求的记录是客户端的错，因为客户端请求了一个不存在的id。

最后但并非最不重要的一点：一致性

*   `GET /users/9`
*   `PUT /users/9`和`DELETE /users/9`

`PUT /users/9`并且`DELETE /users/9`已经必须`204`在成功更新或删除的情况下返回。那么如果用户 9 不存在，他们应该返回什么？根据所使用的 HTTP 方法，将相同的情况显示为不同的状态代码是没有意义的。

此外，不是规范，而是文化原因：如果`204`用于项目中`GET /users/9`接下来发生的事情是有人认为返回`204`对 n 元方法有好处。这使客户端代码复杂化，因为客户端现在必须专门检查并在这种情况下跳过解码主体，而不是只检查`2xx`然后解码主体。`204`但是客户会做什么呢？创建一个空数组？那为什么不把它放在电线上呢？如果客户端创建空数组，则 204 是一种愚蠢的压缩形式。如果客户端使用`null`，则会打开一个完全不同的蠕虫罐。

* * *

## 回答 #10

> 赞同：10
> 
> 时间：2019-05-22T16:00:26.867

在查看问题后，您不应该使用`404`why？

基于[RFC 7231](https://www.rfc-editor.org/rfc/rfc7231#section-6.3.5)，正确的状态码是`204`

在上面的回答中，我注意到一个小误解：

1.-资源是：`/users`

2.-`/users/8`不是资源，这是：`/users`带有路由参数的资源`8`，消费者可能察觉不到也不知道区别，但发布者知道而且必须知道这一点！...所以他必须为消费者返回准确的响应。时期。

所以：

根据RFC：404是不正确的，因为`/users`找到了资源，但是使用参数执行的逻辑`8`没有找到任何`content`作为响应返回，所以正确的答案是：`204`

这里的重点是：`404`连资源都没有找到处理内部逻辑

`204`是：我找到了资源，执行了逻辑，但我没有使用您在路由参数中给出的标准找到任何数据，所以我无法向您返回任何内容。对不起，请验证您的标准并再次给我打电话。

`200`：好的，我找到了资源，执行了逻辑（即使我没有被迫返回任何东西）拿走它并随意使用它。

`205`：（GET响应的最佳选择）我找到了资源，逻辑已执行，我有一些内容给你，好好利用它，哦顺便说一下如果你要在视图中分享这个请刷新视图显示它。

希望能帮助到你。

* * *

## 回答 #11

> 赞同：10
> 
> 时间：2020-04-05T21:47:25.030

令人遗憾的是，如此简单且定义明确的东西在此线程中变成了“基于意见”。

HTTP 服务器只知道“实体”，它是任何内容的抽象，可以是静态网页、搜索结果列表、其他实体列表、某物的 json 描述、媒体文件等。

每个这样的实体都应该可以通过一个唯一的 URL 来识别，例如

*   /user/9 -- 单个实体：用户 ID=9
*   /users -- 单个实体：所有用户的列表
*   /media/x.mp3 -- 单个实体：名为 x.mp3 的媒体文件
*   /search -- 单个实体：基于查询参数的动态内容

如果服务器通过给定的 URL 找到资源，它的*内容*是什么并不重要——2G 的数据，null，{}，[]——只要它存在，它将是 200。但如果这样的实体是服务器不知道，预计会返回 404“未找到”。

一个困惑似乎来自开发人员，他们认为如果应用程序具有特定路径形状的处理程序，则它不应该是错误。在 HTTP 协议看来，只要服务器上没有与请求的 URL（请求的 MP3 文件、网页、用户对象等），将返回有效内容（空或其他），它必须是 404（或 410 等）。

另一个混淆点似乎是围绕“没有数据”和“没有实体”。前者是关于一个实体的内容，后者是关于它的存在。

示例 1：

*   无数据：/users 返回 200 OK，正文：[] 因为还没有人注册
*   没有实体：/users 返回 404，因为没有路径 /users

示例 2：

*   无数据：/user/9 返回返回 200 OK，正文：{}，因为用户 ID=9 从未输入过他/她的个人数据
*   没有实体：/user/9 返回 404，因为没有用户 ID=9

示例 3：

*   无数据：/search?name=Joe 返回 200 OK []，因为数据库中没有 Joe
*   没有实体：/search?name=Joe 返回 404，因为没有路径 /search

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2019-02-03T15:52:13.193

Twitter 使用带有自定义错误消息的 404，例如“未找到数据”。

参考：[https ://developer.twitter.com/en/docs/basics/response-codes.html](https://developer.twitter.com/en/docs/basics/response-codes.html)

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2019-12-04T01:37:27.917

根据 Microsoft 的说法：[ASP.NET Core Web API 中的控制器操作返回类型](https://docs.microsoft.com/en-us/aspnet/core/web-api/action-return-types?view=aspnetcore-3.0)，向下滚动几乎到底部，您会发现以下关于 404 与数据库中未找到的对象相关的简介。在这里，他们建议 404 适用于空数据。

[![在此处输入图像描述](../Images/9ce0a2ad54d7e4bc9c95101ad238b7ed.png)](https://i.stack.imgur.com/4WSCO.png)

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2018-06-15T15:56:49.633

我想说，两者都不是很合适。正如@anneb 所说的那样，我也认为部分问题来自使用HTTP 响应代码来传输与RESTful 服务相关的状态。REST 服务必须说明的任何关于其自身处理的内容都应通过 REST 特定代码进行传输。

## 1

我认为，如果 HTTP 服务器发现任何准备好响应它发送的请求的服务，它不应该以 HTTP 404 响应——最终，服务器找到了一些东西——除非由服务器明确告知处理请求的服务。

让我们暂时假设以下 URL `http://example.com/service/return/test`：.

*   情况 A 是服务器“只是在文件系统上查找文件”。如果它不存在，`404`是正确的。如果它要求某种服务准确地传递此文件并且该服务告诉它不存在该名称的任何内容，则也是如此。
*   在情况 B 中，服务器不使用“真实”文件，但实际上请求由其他服务处理 - 例如某种模板系统。在这里，服务器不能对资源的存在做出任何声明，因为它对它一无所知（除非处理它的服务告诉它）。

如果服务没有任何明确要求不同行为的响应，HTTP 服务器只能说 3 件事：

*   `503`如果应该处理请求的服务没有运行或没有响应；
*   `200`否则，因为 HTTP 服务器实际上可以满足请求 - 无论服务稍后会说什么；
*   `400`或`404`表示没有这样的服务（与“存在但离线”相反）并且没有找到任何其他服务。

## 2

回到手头的问题：我认为最干净的方法是不使用 HTTP 任何响应代码，而不是之前说的。如果服务存在并响应，则 HTTP 代码应为 200。响应应包含服务返回的状态在单独的标头中 - 在这里，服务可以说

*   `REST:EMPTY`例如，如果它被要求搜索某事。而那项研究却空无一物；
*   `REST:NOT FOUND`如果是专门为某事而问的。“ID-like”——是一个文件名或一个 ID 或条目号 24 等的资源——并且未找到该特定资源（通常，请求了一个特定资源但未找到）；
*   `REST:INVALID`如果发送的请求的任何部分未被服务识别。

（请注意，我在它们前面加上了“REST：”，目的是为了标记这样一个事实，即虽然它们可能与 HTTP 响应代码具有相同的值或措辞，但它们是完全不同的）

## 3

让我们回到上面的 URL 并检查案例 B，其中*service*向 HTTP 服务器指示它自己不处理此请求，而是将其传递给`SERVICE`. HTTP 只提供它返回的内容`SERVICE`，它不知道任何关于它所处理的`return/test`部分的信息`SERVICE`。如果该服务正在运行，HTTP 应该返回`200`，因为它*确实找到了*处理请求的东西。

返回的状态`SERVICE`（如上所述，希望在单独的标题中看到）取决于实际预期的操作：

*   if`return/test`请求特定资源：如果存在，则返回状态为`REST:FOUND`; 如果该资源不存在，则返回`REST:NOT FOUND`；`REST:GONE`如果我们知道它曾经存在并且不会返回，并且`REST:MOVED`如果我们知道它已经进入好莱坞，这可以扩展到返回
*   if`return/test`被认为是搜索或类似过滤器的操作：如果结果集为空，则返回请求类型的空集和状态`REST:EMPTY`；请求类型的一组结果和状态`REST:SUCCESS`
*   if`return/test`不是由`SERVICE`:识别的操作：`REST:ERROR`如果完全错误（例如，像 的错字`retrun/test`），或者`REST:NOT IMPLEMENTED`计划在以后使用，则返回。

## 4

这种区别比将两种不同的东西混合起来要干净得多。如果有的话，它还将使调试更容易，处理也只会稍微复杂一些。

*   如果返回 HTTP 404，服务器会告诉我，“我不知道你在说什么”。虽然我的请求的 REST 部分可能完全没问题，但我在所有错误的地方寻找 par'Mach。
*   另一方面，HTTP 200 和 REST:ERR 告诉我我得到了服务，但是在我对服务的请求中做错了。
*   从 HTTP 200 和 REST:EMPTY，我知道我没有做错任何事情——正确的服务器，服务器找到了服务，正确的请求服务——但是搜索结果是空的。

## 概括

问题和讨论源于这样一个事实，即 HTTP 响应代码被用来表示服务的状态，其结果由 HTTP 提供服务，或者表示某事。这不在 HTTP 服务器本身的范围内。由于这种差异，无法回答问题，所有意见都需要进行大量讨论。

由服务而不是 HTTP 服务器处理的请求的状态真的不应该（RFC 6919）由 HTTP 响应代码给出。HTTP 代码应该 (RFC 2119) 仅包含 HTTP 服务器可以从其自身范围内提供的信息：即，是否找到服务来处理请求。

相反，应该使用一种不同的方式来告诉消费者关于实际处理请求的服务的请求状态。我的建议是通过一个特定的标题来做到这一点。理想情况下，标头的名称及其内容都遵循使消费者可以轻松处理这些响应的标准。

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2019-04-12T19:08:13.853

根据 RFC7231 - page59( [https://www.rfc-editor.org/rfc/rfc7231#page-59](https://www.rfc-editor.org/rfc/rfc7231#page-59) ) 404 状态码响应的定义是：

*6.5.4\. 404 Not Found 404（未找到）状态码表示源服务器没有找到目标资源的当前表示或不愿意透露存在的表示。404 状态码并不表示这种缺乏代表性是暂时的还是永久性的；如果源服务器知道（大概是通过一些可配置的方式）该条件可能是永久性的，则 410（Gone）状态代码优于 404。默认情况下，404 响应是可缓存的；即，除非方法定义或显式缓存控制另有说明（参见 [RFC7234] 的第 4.2.2 节）。*

引起质疑的主要是上述上下文中资源的定义。根据相同的 RFC(7231)，资源的定义是：

*资源：HTTP 请求的目标称为“资源”。HTTP 不限制资源的性质；它仅仅定义了一个可以用来与资源交互的接口。每个资源都由统一资源标识符 (URI) 标识，如 [RFC7230] 的第 2.7 节所述。当客户端构建 HTTP/1.1 请求消息时，它以各种形式之一发送目标 URI，如（[RFC7230] 的第 5.3 节）中定义的。当接收到请求时，服务器为目标资源重建一个有效的请求 URI（[RFC7230] 的第 5.5 节）。HTTP 的一个设计目标是将资源标识与请求语义分离，这可以通过将请求语义赋予请求方法（第 4 节）和一些请求修改头字段（第 5 节）来实现。*

**因此，在我的理解中，不应在成功的 GET 请求中使用 404 状态代码，但结果为空。（例如：特定过滤器没有结果的列表）**

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2020-05-06T15:58:32.047

正如许多人所说，404 具有误导性，它不允许客户端区分请求 uri 是否不存在，或者请求的 uri 是否无法获取请求的资源。

预计 200 状态将包含资源数据 - 因此它不是正确的选择。204 状态完全意味着其他东西，不应用作 GET 请求的响应。

由于某种原因，所有其他现有状态均不适用。

我已经看到这个话题在多个地方被反复讨论。对我来说，很明显，要消除围绕该主题的混淆，需要一个专门的成功状态。类似于“ **209** - 没有资源可显示”。

这将是 2xx 状态，因为找不到 ID 不应被视为客户端错误（如果客户端知道服务器数据库中的所有内容，他们就不需要向服务器询问任何内容，不是吗？）。此专用状态将解决与使用其他状态进行辩论的所有问题。

唯一的问题是：我如何让 RFC 接受它作为标准？

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2020-08-07T09:14:26.663

只是一个在这种情况下多次挣扎的开发人员的补充。您可能已经注意到，当特定资源不存在时，是否返回 404 或 200 或 204 始终是一个讨论。上面的讨论表明，这个主题非常令人困惑并且基于意见（虽然存在一个 http-status-code 标准）。我个人建议，因为我猜它还没有被提及，无论你如何决定在你的 API 定义中记录它。当然，当客户端开发人员使用您的特定“REST”-api 来使用他/她关于 Rest 的知识并期望您的 api 以这种方式工作时，他/她会想到。我猜你看到了陷阱。因此，我使用了一个自述文件，其中我明确定义了在哪些情况下我使用哪些状态码。这并不意味着我使用一些随机定义。我总是尝试使用标准，但为了避免这种情况，我记录了我的用法。客户可能会认为您在某些特定情况下是错误的，但正如文档所记录的那样，无需进行额外讨论，这可以为您和开发人员节省时间。

对 Ops 问题的一句话：当我回想起开始开发后端应用程序并且我在控制器路由中配置了一些错误以便不调用我的控制器方法时，我总是会想到 404 代码。考虑到这一点，我认为如果请求确实在 Controller 方法中到达您的代码，则客户端执行了有效请求并且找到了请求端点。所以这是不使用 404 的指示。如果 db 查询返回未找到，我返回 200 但正文为空。

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2021-02-04T21:29:44.750

**TL;博士：**

*   如果在 找不到用户`/users/9`，则应返回 404。
*   如果在 找不到用户`/users?id=9`，则应返回 204。

**长版：**

在查看了我自己对这些状态代码的使用以及这篇文章中的示例之后，我不得不说，如果在`/users/9`.

在我今天的系统中，我们的 Application Insights 日志充满了数百个已记录的 404 错误，这些错误使我们的日志变得混乱，因为我们决定在`/users/9`没有相关数据的情况下返回 404。但是，这并不意味着我们在设置*响应*时的方法不正确，而是我建议这意味着我们在设置*路由*时的方法不正确。

如果您希望端点获得大量流量并且担心记录太多 404 错误，您应该更改您的路由以符合您想要的状态代码，而不是强制不恰当地使用状态代码。

从那以后，我们决定对我们的代码进行 2 处更改：

1.  通过期待改变我们的工作路线`/users?id=9`
2.  将我们的错误代码更改为 204，这样 404 就不会填满我们的 AI 日志。

归根结底，API 的架构师需要了解他们的 API 将如何使用以及哪种路由适合该用例。

我相信在 的情况下`/users/9`，您请求的资源是用户本身，用户 #9；您要求服务器使用标识为“9”的对象进行响应，该对象恰好存在于其中包含“用户”一词的路径中。如果找不到该对象，您应该得到 404。

但是，如果您调用`/users?id=9`，我觉得您请求的资源是用户控制器，同时还提供了更多的特异性，因此它不会返回所有用户的完整列表。您要求服务器响应特定用户，该用户可以通过查询字符串中定义的 ID 号来识别。因此，如果没有找到数据，我认为 204 将适用，因为即使没有找到数据，控制器也是如此。

查询字符串方法还完成了一些我认为不仅对 API 开发人员而且对客户端开发人员（尤其是初级开发人员或继承此代码或对其进行调用的代码的未来开发人员）都有帮助的事情：

任何参与其中的人都会立即清楚 9 是一个 ID，而不是某个任意数字。在这样一个基本示例中，这一点似乎没有意义，但考虑一个使用 GUID 作为行 ID 或允许您通过人名获取数据的系统，甚至是一个返回特定邮政编码而不是行 ID 信息的系统. 如果所有相关的开发人员一眼就能知道该识别参数是名字、姓氏、全名，还是邮政编码而不是 ID，这对所有相关的开发人员都是有用的。

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2021-12-14T17:58:54.803

该线程中的答案（在撰写本文时为 26 个）完美地说明了开发人员理解他们正在使用的构造的语义是多么重要。

如果没有这种理解，响应状态代码可能并不明显是响应的属性而不是其他属性。这些代码存在于响应的上下文中，并且它们在此上下文之外的含义是未定义的。

响应本身就是请求的结果。该请求对资源进行操作。资源、请求、响应和状态码是 HTTP 的构造，就 HTTP 而言：

> HTTP 提供了一个统一的接口来与资源进行交互（第 2 节），无论其类型、性质或实现如何，都通过表示的操纵和传输（第 3 节）。[来源](https://datatracker.ietf.org/doc/html/rfc7231#section-1)。

换句话说，响应状态码的范围受限于只关心一些目标资源的接口，并处理用于与这些资源交互的消息。服务器应用程序逻辑超出范围，您使用的数据也不重要。

当使用 HTTP 时，它总是与资源一起使用。资源被以太转移或操纵。无论如何，除非我们处于量子世界中，否则资源要么存在，要么不存在，不存在第三态。

如果发出 HTTP 请求以获取（传输）资源的表示（如本问题所示）并且该资源不存在，则响应结果应使用相应的 404 代码指示失败。未达到目标 - 获取表示 - 未找到资源。在 HTTP 的上下文中不应该有对结果的其他解释。

[RFC 7231 Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content](https://datatracker.ietf.org/doc/html/rfc7231)，在这里被多次提及，但主要是作为状态码描述的参考。我强烈建议通读整个文档，而不仅仅是第 6 节，以更好地理解 HTTP 接口及其组件的范围和语义。

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2019-10-25T02:02:50.620

这样的事情可能是主观的，双方都有一些有趣的和各种可靠的论据。但是 [在我看来]**为丢失数据返回 404 是不正确的**。为了清楚起见，这里有一个简化的描述：

*   请求：请问我可以提供一些数据吗？
*   资源（API 端点）：我会在此处为您获取该请求 [发送潜在数据的响应]

没有任何问题，找到了端点，找到了表和列，因此查询数据库并“成功”返回数据！

现在-“成功的响应”是否有数据并不重要，您要求对“潜在”数据的响应，并且具有“潜在”数据的响应已得到满足。Null、empty 等是有效数据。

200 只是意味着我们所做的任何请求都是成功的。我正在请求数据，HTTP/REST 没有出现任何问题，并且由于返回了数据（尽管为空），我的“数据请求”成功。

返回 200 并让请求者处理每个特定场景需要的空数据！

考虑这个例子：

*   请求：查询用户 ID 为 1234 的“违规”表
*   资源（API 端点）：返回响应但数据为空

该数据为空是完全有效的。这意味着用户没有违规行为。这是一个 200，因为它都是有效的，然后我可以这样做：

> 你没有违规，吃蓝莓松饼！

如果您认为这是 404，您在说明什么？找不到用户的违规行为？现在，在语法上这是正确的，但在 REST 世界中它是不正确的，成功或失败与请求有关。可以成功找到该用户的“违规”数据，违规次数为零 - 一个实数表示有效状态。

* * *

[厚颜无耻的笔记..]

在您的标题中，您下意识地同意 200 是正确的回答：

> **有效请求**但空数据的正确 REST 响应代码是什么？

* * *

无论主观性和棘手的选择如何，在选择要使用的状态码时，都需要考虑以下几点：

1.  **一致性**。如果您将 404 用于“无数据”，则*每次*响应均未返回数据时使用它。
2.  **不要将同一状态用于多个含义**。如果您在未找到资源时返回 404（例如 API 端点不存在等），那么*也不*要将它用于没有返回数据。这只会让处理响应变得很痛苦。
3.  **仔细考虑上下文**。什么是“要求”？你说你想要达到什么目的？

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2018-01-10T02:59:59.310

204更合适。特别是当您有一个警报系统来确保您的网站是安全的时，在这种情况下 404 会引起混淆，因为您不知道某些 404 警报是后端错误或正常请求但响应为空。

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2016-07-25T16:23:35.087

使用允许客户端打开它并相应地分叉逻辑的通用枚举对响应内容进行编码。我不确定您的客户如何区分“未找到数据”404 和“未找到网络资源”404？您不希望有人浏览到用户**Z** /9 并让客户端感到疑惑，就好像请求有效但没有返回数据一样。

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2021-07-16T18:11:14.237

根据[w3](https://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html)，我相信以下几点：

**2xx：**

> 此类状态码表示客户端的请求被成功接收、理解和接受。

**4xx：**

> 4xx 类状态码适用于客户端似乎出错的情况。

如果客户端请求`/users`，并且它有要列出的用户，则响应代码将为`200 OK`（客户端请求有效）。

如果客户端请求`/users`并且它没有数据，则响应代码仍然是`200 OK`.
请求的实体/资源是一个*用户列表*，该列表存在，只是其中没有任何用户（`204 No Content`如果给出空响应，可以使用 a ，尽管我认为空列表`[]`会更好）。
客户端请求有效，并且资源确实存在，因此 4xx 响应代码在这里没有意义。

另一方面，如果客户端请求`/users/9`并且该用户不存在，则客户端通过请求不存在的资源（*用户*）而犯了错误。在这种情况下，用 a 回答是有意义的`404 Not Found`。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2021-07-13T16:04:25.297

我不认为 404 是正确的响应。

如果你使用404，你怎么知道是没有找到api或者你的数据库中的记录没有找到？

根据您的描述，我会使用 200 OK，因为您的 api 执行了所有逻辑而没有任何问题。它只是在数据库中找不到记录。所以，这不是 API 问题，也不是数据库问题，这是你的问题，你认为记录存在但它不存在。因此，API 执行成功，数据库查询执行成功，但没有找到任何返回。

因此，在这种情况下，我会使用

200 好

使用空响应，例如数组的 [] 或对象的 {}。

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2020-07-15T11:41:14.227

在这种情况下，以`Ruby on Rails`响应`404 Not Found`。

客户端请求的资源不存在。所以，`404 Not Found`比较合适。

* * *

##### 编辑

我看到，在这种情况下，许多开发人员不喜欢`404 not found`.

如果您不想使用`404`，我认为，您可以使用以下两个响应代码中的任何一个：

*   200 好
*   204 无内容

**如果您使用`200 OK`:**响应正文应该是`empty json`:`[]`或`{}`

**如果你使用`204 OK`:**响应正文应该是空的。

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2016-11-30T03:58:17.547

为什么不使用410？它表明请求的资源不再存在，并且在您的情况下，预计客户端永远不会对该资源提出请求`users/9`。

您可以在此处找到有关 410 的更多详细信息：[https ://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html](https://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html)

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2019-11-25T09:56:07.403

如果您仅仅因为没有响应数据而返回，那么 404 对任何客户端来说都会非常混乱。

对我来说，带有空主体的响应代码 200 足以理解一切都是完美的，但没有符合要求的数据。*

# mysql - 如何从表中选择所有表及其匹配项？

> ID：11746896
> 
> 赞同：0
> 
> 时间：2012-07-31T18:45:48.597
> 
> 标签：mysql, sql

我有两张桌子：

TblAchievements>> [ID, AchName]

TblUsersAchievements>> [UserID, AchID]

我需要的结果是这样的（假设有 4 个成就并且用户 1 已经实现了 1 和 2：

```
 ID     AchName     UserID     AchID
 1      first         1         1
 2      second        1         2
 3      third        NULL      NULL
 4      fourth       NULL      NULL 
```

我尝试了这样的事情：

```
 SELECT 
   tblacheivements.id,
   tblacheivements.achname,
   tbluserachievements.uid,
   tbluserachievements.achid
 FROM
   tbluserachievements
 RIGHT OUTER JOIN tblacheivements ON (tbluserachievements.achid = tblacheivements.id)
 WHERE
   tbluserachievements.uid = 1 OR 
   tbluserachievements.uid IS NULL 
```

它得到了正确的结果，但是当我更改用户时，结果是错误的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T18:54:22.603

您似乎想列出特定用户拥有或没有的所有成就。要过滤`UserID`，但仍保留结果集中的每个成就行，您必须`UserID`在外连接条件中包含选择（将其放在`WHERE`子句中只会选择用户获得成就的行，因为在/`WHERE`之后进行评估.)`FROM``JOIN`

试试这个解决方案：

```
SELECT    *
FROM      tblachievements a
LEFT JOIN tbluserachievements b ON a.id = b.achid AND b.uid = 1 
```

* * *

**额外的：**

根据您的应用程序要求，也许最好简单地使用一个布尔值来指示用户是否已实现它（`1`如果他们做到了，`0`如果没有）：

```
SELECT    a.*, b.achid IS NOT NULL AS achieved
FROM      tblachievements a
LEFT JOIN tbluserachievements b ON a.id = b.achid AND b.uid = 1 
```

这会产生：

```
 id     achname     achieved
 ---------------------------
 1      first       1     
 2      second      1     
 3      third       0   
 4      fourth      0 
```

# magento - 扩展 Magento 模板中的默认布局

> ID：11746898
> 
> 赞同：1
> 
> 时间：2012-07-31T18:45:56.517
> 
> 标签：magento, magento-layout-xml

我正在尝试添加一个扩展我的默认布局的页面。我将内容放在 .phtml 文件中，然后像这样设置布局：

```
<layout version="0.1.0">
    <customlanding_index_index>
        <reference name="root">
            <action method="setTemplate"><template>page/1column.phtml</template></action>
        </reference>
        <block name="content" as="content" type="core/text_list" template="quantumco/customlanding/landing_page.phtml" />
    </customlanding_index_index>
</layout> 
```

不幸的是，这给我的只是没有内容的布局。我假设我错误地插入了内容块，但我不知道如何让它工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T19:04:15.180

引用内容块并将您自己的块添加为子块：

```
<layout version="0.1.0">
    <customlanding_index_index>
        <reference name="root">
            <action method="setTemplate"><template>page/1column.phtml</template></action>
        </reference>
        <reference name="content">
            <block type="core/template" name="landing_page" template="quantumco/customlanding/landing_page.phtml" />
        </reference>
    </customlanding_index_index>
</layout> 
```

如果您的块属于特定类型（我认为它不是基于您提供的代码示例，请替换`core/template`为您的自定义块类型。

# ruby - 高级循环使用？

> ID：11746902
> 
> 赞同：0
> 
> 时间：2012-07-31T18:46:14.687
> 
> 标签：ruby, jekyll, liquid

我试图弄清楚如何适当地使用 Liquid`cycle`和 html blelow。这是一个永无止境的行，最大 3 列 ( `float:left`) 布局。

```
<!-- row -->
<div class="single-post-container">
   <div class="single-post-item">
      <div class="single-post-head">
         <a href="{{ post.url }}" />
         <h6>{{ post.title }}</h6>
      </div>
   </div>
   <div class="single-post-item">
      <div class="single-post-head">
         <a href="{{ post.url }}" />
         <h6>{{ post.title }}</h6>
      </div>
   </div>
   <div class="single-post-item">
      <div class="single-post-head">
         <a href="{{ post.url }}" />
         <h6>{{ post.title }}</h6>
      </div>
   </div>
</div>
<!-- row -->
<div class="single-post-container">
   <div class="single-post-item">
      <div class="single-post-head">
         <a href="{{ post.url }}" />
         <h6>{{ post.title }}</h6>
      </div>
   </div>
   <div class="single-post-item">
      <div class="single-post-head">
         <a href="{{ post.url }}" />
         <h6>{{ post.title }}</h6>
      </div>
   </div>
   <div class="single-post-item">
      <div class="single-post-head">
         <a href="{{ post.url }}" />
         <h6>{{ post.title }}</h6>
      </div>
   </div>
</div> 
```

我能够用这个丑陋的东西让它半工半读（`{{ post.title }}`字面上显示而不是实际的标题）：

```
{% for post in site.posts %}

   column {%cycle '<div class="single-post-container"><div class="single-post-item"><div class="single-post-head"><a href="{{ post.url }}" /><h6>{{ post.title }}</h6></div></div>', '<div class="single-post-item"><div class="single-post-head"><a href="{{ post.url }}" /><h6>{{ post.title }}</h6></div></div>', '<div class="single-post-item"><div class="single-post-head"><a href="{{ post.url }}" /><h6>{{ post.title }}</h6></div></div></div>'%}

{% endfor %} 
```

请帮忙！也许有更好的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T14:26:58.783

标签中的字符串`cycle`没有被处理，因此不会发生液体替换（这就是`{{ post.title }}`字面意思的原因）。

更好的方法可能是这样的：

```
{% for post in site.posts %}
  {% cycle '<div class="single-post-container">', '', '' %}
  <div class="single-post-item">
    <div class="single-post-head">
      <a href="{{ post.url }}" />
      <h6>{{ post.title }}</h6>
    </div>
  </div>
  {% cycle '', '', '</div> %}
{% endfor %} 
```

它只循环开始和结束标签。请注意，`div`如果帖子数不是 3 的倍数，则会中断（保持打开状态）。

基于上述情况，一个更好的解决方案可能是：

```
{% for post in site.posts %}
  {% capture mod_three %}{{ forloop.index0 | modulo: 3 }}{% endcapture %}
  {% if mod_three == '0' %}
    <div class="single-post-container">
  {% endif %}
      <div class="single-post-item">
        <div class="single-post-head">
          <a href="{{ post.url }}" />
          <h6>{{ post.title }}</h6>
        </div>
     </div>
  {% if mod_three == '2' or forloop.last %}
     </div>
  {% endif %}
{% endfor %} 
```

如果帖子的数量不是 3 的倍数（这就是测试的目的），这（理论上，我还没有测试过）不会让 div 保持打开状态`or forloop.last`。

（[这里是一些](http://wiki.shopify.com/UsingLiquid#For_loops)关于特殊`forloop`变量及其属性的文档。）

# c# - HTTPWebRequest 403 禁止

> ID：11746906
> 
> 赞同：0
> 
> 时间：2012-07-31T18:46:28.390
> 
> 标签：c#, httpwebrequest, basic-authentication, httpwebresponse

我正在尝试向服务器形成一个 HttpWebRequest。我已经测试了我正在使用的用户名和密码，并且他们使用目标网站上的登录表单正确地进行了身份验证。

我检查并阅读了 Stack 上关于 403 涉及 HttpWebRequest 的所有其他帖子，并更新了我的代码以具有有效的用户代理、Accept 字段和 ContentType。省略前三个属性之一似乎是人们最常犯的错误。

我的代码在下面并打印“已创建响应远程服务器返回错误：（403）禁止。”

```
{
    HttpWebRequest request = buildRequest(url);        
    print("Response Created");
    try
    {
        using (HttpWebResponse response = (HttpWebResponse)request.GetResponse())
        {
            //Do stuff with the response
        }
    }
    catch (Exception ex)
    {
        print(ex.Message);
    }
    Done.Visible = true;
}

private HttpWebRequest buildRequest(String url)
{
    HttpWebRequest req = (HttpWebRequest)WebRequest.Create(url);
    //I also tried authenticating in the header with no luck.
    //byte[] authBytes = Encoding.UTF8.GetBytes("username:password".ToCharArray());
    //req.Headers["Authorization"] = "Basic " + Convert.ToBase64String(authBytes);
    req.Method = "GET";
    req.Credentials = new NetworkCredential("username","password");
    req.UserAgent = "Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10_6_6; en-us) AppleWebKit/533.20.25 (KHTML, like Gecko) Version/5.0.4 Safari/533.20.27";
    req.PreAuthenticate = true;
    req.Accept = "application/json";
    req.ContentType = "application/json; charset=utf-8";
    req.KeepAlive = true;
    return req;
} 
```

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T18:50:50.873

使用 a`System.Net.CookieContainer`在后续调用中接收和设置 cookie。该`CookieContainer`属性在不同的请求中是有状态的。

[这](http://msdn.microsoft.com/en-us/library/system.net.httpwebrequest.cookiecontainer.aspx)是 MSDN 文档。

```
public SomeClass 
{
    var _cookies = new CookieContainer();

    private HttpWebRequest buildRequest(String url)  
    {  
       HttpWebRequest req = (HttpWebRequest)WebRequest.Create(url);  
       req.CookieContainer = _cookies;
       // omitted rest of code
    }

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T19:17:16.563

您确定网站在登录时没有使用 POST 方法吗？如果没有，那么请忽略此答案。

如果网站在提交数据时使用 POST 方法，您需要在提交之前将数据附加到请求的末尾（您可以使用 Fiddler 轻松检查）：

```
string postDataString = "foo1=bar1&foo2=bar2&foo3=bar3";
//Use whatever encoding is appropriate for the submission
byte[] postData = Encoding.ASCII.GetBytes(postDataString);

//When building your request, set the ContentLength property and append the data
req.ContentLength = postData.Length;

using (Stream dataStream = req.GetRequestStream())
{
    dataStream.Write(postData, 0, postData.Length);
} 
```

# iphone - 应用程序崩溃 - 无法弄清楚原因

> ID：11746911
> 
> 赞同：-1
> 
> 时间：2012-07-31T18:46:34.937
> 
> 标签：iphone, xcode, cocoa-touch, crash

我的应用程序在第一次启动时往往会崩溃，但当我再次启动它时。该应用程序很好。

当我按下按钮时它会崩溃，按钮会播放声音并允许用户更改播放歌曲的音高和 BPM。

这是日志中的崩溃报告

```
This GDB was configured as "x86_64-apple-darwin".Attaching to process 1842.
2012-07-31 19:40:33.437 DubstepDJ[1842:16a03] Error loading /System/Library/Extensions/AudioIPCDriver.kext/Contents/Resources/AudioIPCPlugIn.bundle/Contents/MacOS/AudioIPCPlugIn:  dlopen(/System/Library/Extensions/AudioIPCDriver.kext/Contents/Resources/AudioIPCPlugIn.bundle/Contents/MacOS/AudioIPCPlugIn, 262): Symbol not found: ___CFObjCIsCollectable
  Referenced from: /System/Library/Frameworks/Security.framework/Versions/A/Security
  Expected in: /Applications/Xcode.app/Contents/Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator5.1.sdk/System/Library/Frameworks/CoreFoundation.framework/CoreFoundation
 in /System/Library/Frameworks/Security.framework/Versions/A/Security
2012-07-31 19:40:33.447 DubstepDJ[1842:16a03] Error loading /System/Library/Extensions/AudioIPCDriver.kext/Contents/Resources/AudioIPCPlugIn.bundle/Contents/MacOS/AudioIPCPlugIn:  dlopen(/System/Library/Extensions/AudioIPCDriver.kext/Contents/Resources/AudioIPCPlugIn.bundle/Contents/MacOS/AudioIPCPlugIn, 262): Symbol not found: ___CFObjCIsCollectable
  Referenced from: /System/Library/Frameworks/Security.framework/Versions/A/Security
  Expected in: /Applications/Xcode.app/Contents/Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator5.1.sdk/System/Library/Frameworks/CoreFoundation.framework/CoreFoundation
 in /System/Library/Frameworks/Security.framework/Versions/A/Security
2012-07-31 19:40:33.477 DubstepDJ[1842:16a03] Error loading /System/Library/Extensions/AppleHDA.kext/Contents/PlugIns/AppleHDAHALPlugIn.bundle/Contents/MacOS/AppleHDAHALPlugIn:  dlopen(/System/Library/Extensions/AppleHDA.kext/Contents/PlugIns/AppleHDAHALPlugIn.bundle/Contents/MacOS/AppleHDAHALPlugIn, 262): Symbol not found: ___CFObjCIsCollectable
  Referenced from: /System/Library/Frameworks/Security.framework/Versions/A/Security
  Expected in: /Applications/Xcode.app/Contents/Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator5.1.sdk/System/Library/Frameworks/CoreFoundation.framework/CoreFoundation
 in /System/Library/Frameworks/Security.framework/Versions/A/Security
2012-07-31 19:40:33.483 DubstepDJ[1842:16a03] Error loading /System/Library/Extensions/AppleHDA.kext/Contents/PlugIns/AppleHDAHALPlugIn.bundle/Contents/MacOS/AppleHDAHALPlugIn:  dlopen(/System/Library/Extensions/AppleHDA.kext/Contents/PlugIns/AppleHDAHALPlugIn.bundle/Contents/MacOS/AppleHDAHALPlugIn, 262): Symbol not found: ___CFObjCIsCollectable
  Referenced from: /System/Library/Frameworks/Security.framework/Versions/A/Security
  Expected in: /Applications/Xcode.app/Contents/Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator5.1.sdk/System/Library/Frameworks/CoreFoundation.framework/CoreFoundation
 in /System/Library/Frameworks/Security.framework/Versions/A/Security
2012-07-31 19:40:33.493 DubstepDJ[1842:16a03] Error loading /System/Library/Extensions/AppleHDA.kext/Contents/PlugIns/AppleHDAHALPlugIn.bundle/Contents/MacOS/AppleHDAHALPlugIn:  dlopen(/System/Library/Extensions/AppleHDA.kext/Contents/PlugIns/AppleHDAHALPlugIn.bundle/Contents/MacOS/AppleHDAHALPlugIn, 262): Symbol not found: ___CFObjCIsCollectable
  Referenced from: /System/Library/Frameworks/Security.framework/Versions/A/Security
  Expected in: /Applications/Xcode.app/Contents/Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator5.1.sdk/System/Library/Frameworks/CoreFoundation.framework/CoreFoundation
 in /System/Library/Frameworks/Security.framework/Versions/A/Security
2012-07-31 19:40:33.498 DubstepDJ[1842:16a03] Error loading /System/Library/Extensions/AppleHDA.kext/Contents/PlugIns/AppleHDAHALPlugIn.bundle/Contents/MacOS/AppleHDAHALPlugIn:  dlopen(/System/Library/Extensions/AppleHDA.kext/Contents/PlugIns/AppleHDAHALPlugIn.bundle/Contents/MacOS/AppleHDAHALPlugIn, 262): Symbol not found: ___CFObjCIsCollectable
  Referenced from: /System/Library/Frameworks/Security.framework/Versions/A/Security
  Expected in: /Applications/Xcode.app/Contents/Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator5.1.sdk/System/Library/Frameworks/CoreFoundation.framework/CoreFoundation
 in /System/Library/Frameworks/Security.framework/Versions/A/Security
2012-07-31 19:40:33.508 DubstepDJ[1842:16a03] Error loading /System/Library/Extensions/AppleHDA.kext/Contents/PlugIns/AppleHDAHALPlugIn.bundle/Contents/MacOS/AppleHDAHALPlugIn:  dlopen(/System/Library/Extensions/AppleHDA.kext/Contents/PlugIns/AppleHDAHALPlugIn.bundle/Contents/MacOS/AppleHDAHALPlugIn, 262): Symbol not found: ___CFObjCIsCollectable
  Referenced from: /System/Library/Frameworks/Security.framework/Versions/A/Security
  Expected in: /Applications/Xcode.app/Contents/Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator5.1.sdk/System/Library/Frameworks/CoreFoundation.framework/CoreFoundation
 in /System/Library/Frameworks/Security.framework/Versions/A/Security
2012-07-31 19:40:33.515 DubstepDJ[1842:16a03] Error loading /System/Library/Extensions/AppleHDA.kext/Contents/PlugIns/AppleHDAHALPlugIn.bundle/Contents/MacOS/AppleHDAHALPlugIn:  dlopen(/System/Library/Extensions/AppleHDA.kext/Contents/PlugIns/AppleHDAHALPlugIn.bundle/Contents/MacOS/AppleHDAHALPlugIn, 262): Symbol not found: ___CFObjCIsCollectable
  Referenced from: /System/Library/Frameworks/Security.framework/Versions/A/Security
  Expected in: /Applications/Xcode.app/Contents/Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator5.1.sdk/System/Library/Frameworks/CoreFoundation.framework/CoreFoundation
 in /System/Library/Frameworks/Security.framework/Versions/A/Security
2012-07-31 19:40:42.449 DubstepDJ[1842:16a03] Starting 
```

这是它崩溃的代码

```
- (OSStatus) readFloatsConsecutive:(SInt64)numFrames intoArray:(float**)audio
{
    OSStatus err = noErr;

    if (!mExtAFRef) return -1;

    int kSegmentSize = (int)(numFrames * mExtAFNumChannels * mExtAFRateRatio + .5);
    if (mExtAFRateRatio < 1.) kSegmentSize = (int)(numFrames * mExtAFNumChannels /
        mExtAFRateRatio + .5);

    AudioBufferList bufList;
    UInt32 numPackets = numFrames; // Frames to read
    UInt32 samples = numPackets * mExtAFNumChannels;
    UInt32 loadedPackets = numPackets;

    short *data = (short*)malloc(kSegmentSize*sizeof(short));
    if (!data) {
        NSLog(@"data is nil");
        goto error;
    }

    bufList.mNumberBuffers = 1;
    bufList.mBuffers[0].mNumberChannels = mExtAFNumChannels;
    bufList.mBuffers[0].mData = data; // data is a pointer (short*) to our sample buffer
    bufList.mBuffers[0].mDataByteSize = samples * sizeof(short);

    // Crash occurs on this line:
    **err = ExtAudioFileRead(mExtAFRef, &loadedPackets, &bufList);**
    if (err) goto error;

    if (audio) {
        for (long c = 0; c < mExtAFNumChannels; c++) {
            if (!audio[c]) continue;
            for (long v = 0; v < numFrames; v++) {
                if (v < loadedPackets) audio[c][v] = (float)data[v*mExtAFNumChannels+c] / 32768.f;
                else audio[c][v] = 0.f;
            }
        }
    }

error:
    free(data);
    if (err != noErr) return err;
    if (loadedPackets < numFrames) mExtAFReachedEOF = YES;
    return loadedPackets;
} 
```

我在 Xcode 说 'exc_bad_access' 的行上加粗了部分

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-01T06:05:18.073

您尝试使用的框架有问题。如果它是我看到的内置框架，我认为你的 xCode 有问题。尝试重新安装它。

# python - Django 将异常映射到 HttpResponse

> ID：11746919
> 
> 赞同：0
> 
> 时间：2012-07-31T18:47:08.177
> 
> 标签：python, django

有没有办法将异常映射到 Django 中的 HttpResponse 对象？

例如，我想将我自己的“UnauthorizedException”映射到 HttpResponseForbidden 响应对象，因此当我的视图引发该异常时，而不是自动映射到 500，某些异常可以被视为 401。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-31T18:52:16.723

如果您实现自己的实现该[`process_exception`](https://docs.djangoproject.com/en/1.4/topics/http/middleware/#process-exception)方法的中间件，则可以。一个简单的例子：

```
from django.http import HttpResponseForbidden
from app.exceptions import UnauthorizedException

class UnauthorizedAccessMiddleware(object):
    def process_exception(self, request, exception):
        if isinstance(exception, UnauthorizedException):
           return HttpResponseForbidden("You are not authorized to access that page.") 
```

# python - SQLAlchemy：对象没有属性'_sa_adapter'

> ID：11746922
> 
> 赞同：1
> 
> 时间：2012-07-31T18:47:11.167
> 
> 标签：python, sqlalchemy

我遇到了一个非常奇怪的错误，很难重现：`AttributeError: 'list' object has no attribute '_sa_adapter'`. 它似乎来自一对多的关系，但一切看起来都很好，我不能简单地重现这个错误。如果我单独运行测试套件，就没有错误，它只会在整个测试运行时发生。也许它来自没有正确清洁的东西......

这是完整的堆栈：

```
Traceback (most recent call last):
  File "/Users/ca/[REDACTED].py", line 79, in setUp
    self.client.save()
  File "/Users/ca/[REDACTED].py", line 370, in save
    Session.add(self)
  File "/Users/ca/.pythonbrew/venvs/Python-2.7.3/api/lib/python2.7/site-packages/SQLAlchemy-0.7.5-py2.7-macosx-10.7-x86_64.egg/sqlalchemy/orm/scoping.py", line 113, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/ca/.pythonbrew/venvs/Python-2.7.3/api/lib/python2.7/site-packages/SQLAlchemy-0.7.5-py2.7-macosx-10.7-x86_64.egg/sqlalchemy/orm/session.py", line 1223, in add
    self._save_or_update_state(state)
  File "/Users/ca/.pythonbrew/venvs/Python-2.7.3/api/lib/python2.7/site-packages/SQLAlchemy-0.7.5-py2.7-macosx-10.7-x86_64.egg/sqlalchemy/orm/session.py", line 1238, in _save_or_update_state
    halt_on=self._contains_state):
  File "/Users/ca/.pythonbrew/venvs/Python-2.7.3/api/lib/python2.7/site-packages/SQLAlchemy-0.7.5-py2.7-macosx-10.7-x86_64.egg/sqlalchemy/orm/mapper.py", line 1814, in cascade_iterator
    parent_dict, visited_states, halt_on))
  File "/Users/ca/.pythonbrew/venvs/Python-2.7.3/api/lib/python2.7/site-packages/SQLAlchemy-0.7.5-py2.7-macosx-10.7-x86_64.egg/sqlalchemy/orm/properties.py", line 817, in cascade_iterator
    get_all_pending(state, dict_)
  File "/Users/ca/.pythonbrew/venvs/Python-2.7.3/api/lib/python2.7/site-packages/SQLAlchemy-0.7.5-py2.7-macosx-10.7-x86_64.egg/sqlalchemy/orm/attributes.py", line 775, in get_all_pending
    current = getattr(current, '_sa_adapter')
AttributeError: 'list' object has no attribute '_sa_adapter' 
```

你知道它可能来自哪里吗？

谢谢，

chx

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-06T03:08:32.893

这意味着您正在不恰当地操纵一个仪器化的对象 - 例如说，`myobject.__dict__[somekey] = [1, 2, 3]`. `__dict__`映射对象不支持直接操作。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-03-06T23:23:27.910

旧线程，但对于以后查看的任何人，您要确保您的值正在通过**setattr**，以便 SA 的映射有机会拦截。所以你可以这样做：

```
obj.attr = myval 
```

或者

```
setattr(obj, 'attr', myval) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-03-25T08:57:00.260

我的情况是另一个会话仍在其他线程（调度程序一个）中打开。所以，我让那个线程在作业被激活并且 http 服务器线程像一个魅力一样工作后关闭会话。

# jquery - 使用 Internet Explorer 在 Django 中使用 request.is_ajax() 无法识别 JQuery ajax

> ID：11746932
> 
> 赞同：0
> 
> 时间：2012-07-31T18:47:54.053
> 
> 标签：jquery, ajax, django, internet-explorer

我正在使用 jQuery 为 Django 发送 ajax 请求。要选择响应模板，我正在检查这样的请求：

```
def about(request) :
    context = {'content' : 'about.html',
               'section_nav' : 'about_nav.html'}

    if request.is_ajax() :
        context['ajax'] = True

    return render_to_response('main.html', context) 
```

在 main.html 我检查是否是 ajax 并扩展一个不同的模板。jQuery很简单：

```
$.get('/about/', function(data) {
        $('.article').html(data);
}); 
```

在 Chrome 和 Firefox 中它工作得很好......但 IE9 在 request.is_ajax() 中返回 False 并使用错误的上下文加载页面。我怎样才能克服这个问题，并从 IE（使用 jQuery）发出 ajax 请求并用 django 识别它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T19:02:53.380

尝试使用`$.ajax`而不是`$.get`. 我读过 using`$.ajax`适用于所有浏览器，但`$.get`不会使用 IE 发送 ajax 标头。

还将缓存选项设置为 false。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-30T21:06:05.680

在发出 jQuery ajax 请求时，我发现至少有一个版本的 IE 没有为 django 的请求方法 is_ajax() 发送适当的标头来工作——带有字符串“XMLHttpRequest”的 HTTP_X_REQUESTED_WITH 标头

[https://docs.djangoproject.com/en/dev/ref/request-response/#django.http.HttpRequest.is_ajax](https://docs.djangoproject.com/en/dev/ref/request-response/#django.http.HttpRequest.is_ajax)

要解决此问题，请在 jQuery $.ajax 调用中手动添加标头，即 $.ajax({'headers': {'HTTP_X_REQUESTED_WITH': 'XMLHttpRequest'},...});

# spring - 如何在 Spring-JUnit 测试中设置 JNDI 查找？

> ID：11746939
> 
> 赞同：6
> 
> 时间：2012-07-31T18:48:09.563
> 
> 标签：spring, junit, jndi, initial-context

我正在使用 Maven 3.0.3、Spring 3.1.0.RELEASE 和 JUnit 4.8.1。如何在容器外创建 JNDI 功能（在我的情况下是 JBoss）？我认为 Spring 的 jndiTemplate 可以解决问题（来自我的 testApplicationContext.xml 文件）：

```
<bean id="jndiTemplate" class="org.springframework.jndi.JndiTemplate" lazy-init="true">
        <property name="environment">
            <props>
                <prop key="java.naming.factory.initial">org.jnp.interfaces.NamingContextFactory</prop>
                <prop key="java.naming.provider.url">localhost:1099</prop>
            </props>
        </property>
</bean>

...

<!-- Can't change the below code -->
<bean class="org.springframework.ejb.access.SimpleRemoteStatelessSessionProxyFactoryBean" lazy-init="true" singleton="true" id="skillManager">
    <property name="jndiName">
        <value>customLibSkillManager</value>
    </property>
    <property name="businessInterface">
        <value>customLibx.skills.customLibSkillManager_IF</value>
    </property>
</bean> 
```

但是当我运行我的 JUnit 测试时，我得到了这个异常......</p>

```
Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'skillsValidationManager' defined in class path resource [_module_config/managers/proxies.remote.COMMON.xml]: Invocation of init method failed; nested exception is javax.naming.NoInitialContextException: Need to specify class name in environment or system property, or as an applet parameter, or in an application resource file:  java.naming.factory.initial
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1455)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:519)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)
    at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:294)
    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:225)
    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:291)
    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:193)
    at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveReference(BeanDefinitionValueResolver.java:322)
    ... 58 more
Caused by: javax.naming.NoInitialContextException: Need to specify class name in environment or system property, or as an applet parameter, or in an application resource file:  java.naming.factory.initial
    at javax.naming.spi.NamingManager.getInitialContext(NamingManager.java:645)
    at javax.naming.InitialContext.getDefaultInitCtx(InitialContext.java:288)
    at javax.naming.InitialContext.getURLOrDefaultInitCtx(InitialContext.java:325)
    at javax.naming.InitialContext.lookup(InitialContext.java:392)
    at org.springframework.jndi.JndiTemplate$1.doInContext(JndiTemplate.java:154)
    at org.springframework.jndi.JndiTemplate.execute(JndiTemplate.java:87)
    at org.springframework.jndi.JndiTemplate.lookup(JndiTemplate.java:152)
    at org.springframework.jndi.JndiTemplate.lookup(JndiTemplate.java:178)
    at org.springframework.jndi.JndiLocatorSupport.lookup(JndiLocatorSupport.java:95)
    at org.springframework.jndi.JndiObjectLocator.lookup(JndiObjectLocator.java:105)
    at org.springframework.ejb.access.AbstractRemoteSlsbInvokerInterceptor.lookup(AbstractRemoteSlsbInvokerInterceptor.java:100)
    at org.springframework.ejb.access.AbstractSlsbInvokerInterceptor.refreshHome(AbstractSlsbInvokerInterceptor.java:122)
    at org.springframework.ejb.access.SimpleRemoteSlsbInvokerInterceptor.refreshHome(SimpleRemoteSlsbInvokerInterceptor.java:163)
    at org.springframework.ejb.access.AbstractSlsbInvokerInterceptor.afterPropertiesSet(AbstractSlsbInvokerInterceptor.java:109)
    at org.springframework.ejb.access.SimpleRemoteStatelessSessionProxyFactoryBean.afterPropertiesSet(SimpleRemoteStatelessSessionProxyFactoryBean.java:100)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1514)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1452)
    ... 65 more 
```

我设置了我的 JUnit，是这样的……</p>

```
@RunWith(SpringJUnit4ClassRunner.class)
@ContextConfiguration({ "file:src/test/resources/testApplicationContext.xml" })
public class StandardsParserServiceTest extends AbstractCorrelationsTest { 
```

# opengl - OpenGL：组合平移/旋转/缩放矩阵或将它们分开？

> ID：11746942
> 
> 赞同：0
> 
> 时间：2012-07-31T18:48:23.817
> 
> 标签：opengl, model, matrix

在我的 opengl 应用程序中，我有一个 GameObject 类来描述模型，每个模型都有一个矩阵来描述它的平移/旋转/缩放，每当我想平移/旋转/缩放时，我只需调用类似 Model_Matrix->translate (dx, dy, dz) 直接对模型矩阵进行操作，从而永久改变它。所以首先我想知道，这是正确的方法吗？因为网上很多文章都讲了三个矩阵，平移、旋转和缩放，然后将它们相乘以创建变换矩阵。我只使用一个进行所有计算。

任何人都可以对这个主题有所了解，因为现在，我很困惑

注意：我确实知道一些矩阵数学，但只是一点点

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T20:43:27.590

我建议将转换保持为矩阵（每个对象），因为 - 如果将它们分开保存，则会引入有关执行这些操作的顺序的隐含知识（因此可能会产生不同的结果）。

防止转换的隐式排序对您不利的一种方法是使用一个类，比如 TransformGroup，它可以包含任意数量的 TranslateTransform、RotateTransform 和 ScaleTransform，每个都允许您修改和检查单个属性。要查看此方法的示例，请查看[此处](https://github.com/ananthonline/graffiti/blob/master/Graffiti.Core/Math/TransformGroup.cs)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-16T12:36:27.350

如果您真的只需要矩阵本身，那么简单地维护一个矩阵并没有错。但是，如果您想做诸如相机转换之类的事情，这可能会变得很棘手。

想象一下，您有一个矩阵 A（之前）和一个矩阵 B（之后），并希望您的程序能够将相机（或对象）从 A 视角连续移动到 B 视角。如果您只有一个矩阵来确定每个位置，这很难（特别是，不是由纯矩阵代数唯一确定）。

但是，如果您确实分别维护缩放、旋转和平移，则完全不使用矩阵，而是根据[gluLookAt](http://www.opengl.org/sdk/docs/man/xhtml/gluLookAt.xml)函数维护`eye`,`center`和向量可能是合适的。`up`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-07T18:01:45.210

只有一个矩阵的一个缺点是操作会相互影响。iE 如果你做一个 scale(2,2,2)，而不是一个 translate(2,2,2)，你的模型将在 everey 轴上移动*4*，而不是像你想象的那样移动 2。旋转也有同样的问题，但更难理解；）

下一个问题是 scale() 和 rotate() 总是使用原点，这意味着如果你想旋转或缩放，你必须考虑你当前的平移在哪里，并用这个值进行计算。这很难做到。

要找到如何缩放/平移/旋转的策略，您必须考虑在对象生命的哪个阶段要做什么。建设与后来的运动。

但是，您可以通过将现有的矩阵操作结合在一起来实现“更好的”矩阵操作。IE伪代码

```
scale(float[3] s, float[3] originPoint) 
```

将被实施为

```
translate(-originPoint); scale(s); translate(originPoint); 
```

和

```
rotate(float alpha, float[3] p1, float[3] p2) 
```

将被实施为

```
translate(-p1); rotate(alpha, p2-p1); translate(p1); 
```

而且，根本不使用 scale() 会让生活更轻松。

干杯，弗兰克

# internet-explorer - Grails：IE 选项卡问题

> ID：11746944
> 
> 赞同：0
> 
> 时间：2012-07-31T18:48:25.570
> 
> 标签：internet-explorer

我过去曾问过一个与此非常相似的问题，但答案确实解决了问题。在我正在制作的页面中，有在页面呈现后呈现的模式框。在 Chrome 和 Firefox 中，这些新生成的模态表单上的选项卡工作得很好。然而，在 IE 中，所有的地狱都崩溃了，我真的无法控制。我尝试过设置标签顺序，但无济于事。有没有其他人遇到过这个问题，有人知道这种情况的解决方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-29T14:54:59.363

不久前我找到了答案，现在才报告问题所在。我使用的模态框架 [modalbox.js] 是导致问题的原因。

# c++ - 来自文件像素化的directx网格

> ID：11746946
> 
> 赞同：0
> 
> 时间：2012-07-31T18:48:32.143
> 
> 标签：c++, directx

我在 3d studio max 中设计了一个 3ds 模型，并使用 pandax 导出器将它导出到一个 .x 文件中……但是当我将它加载到我的 c++ 程序时，它全部被像素化和扭曲了。当我在directx查看器（微软工具）中加载它时，一切都好......任何想法和帮助都非常受欢迎！

这是我使用的代码（是的，是来自 microsoft sdk 的代码）！！！

```
 //-----------------------------------------------------------------------------
// File: Meshes.cpp
//
// Desc: For advanced geometry, most apps will prefer to load pre-authored
//       Meshes from a file. Fortunately, when using Meshes, D3DX does most of
//       the work for this, parsing a geometry file and creating vertx buffers
//       (and index buffers) for us. This tutorial shows how to use a D3DXMESH
//       object, including loading it from a file and rendering it. One thing
//       D3DX does not handle for us is the materials and textures for a mesh,
//       so note that we have to handle those manually.
//
//       Note: one advanced (but nice) feature that we don't show here is that
//       when cloning a mesh we can specify the FVF. So, regardless of how the
//       mesh was authored, we can add/remove normals, add more texture
//       coordinate sets (for multi-texturing), etc.
//
// Copyright (c) Microsoft Corporation. All rights reserved.
//-----------------------------------------------------------------------------
#include <Windows.h>
#include <mmsystem.h>
#include <d3dx9.h>
#pragma warning( disable : 4996 ) // disable deprecated warning 
#include <strsafe.h>
#include <D3DX9Mesh.h>
#pragma warning( default : 4996 )

//-----------------------------------------------------------------------------
// Global variables
//-----------------------------------------------------------------------------
LPDIRECT3D9         g_pD3D = NULL; // Used to create the D3DDevice
LPDIRECT3DDEVICE9   g_pd3dDevice = NULL; // Our rendering device

LPD3DXMESH          g_pMesh = NULL; // Our mesh object in sysmem
D3DMATERIAL9*       g_pMeshMaterials = NULL; // Materials for our mesh
LPDIRECT3DTEXTURE9* g_pMeshTextures = NULL; // Textures for our mesh
DWORD               g_dwNumMaterials = 0L;   // Number of mesh materials

//-----------------------------------------------------------------------------
// Name: InitD3D()
// Desc: Initializes Direct3D
//-----------------------------------------------------------------------------
HRESULT InitD3D( HWND hWnd )
{
    // Create the D3D object.
    if( NULL == ( g_pD3D = Direct3DCreate9( D3D_SDK_VERSION ) ) )
        return E_FAIL;

    // Set up the structure used to create the D3DDevice. Since we are now
    // using more complex geometry, we will create a device with a zbuffer.
    D3DPRESENT_PARAMETERS d3dpp;
    ZeroMemory( &d3dpp, sizeof( d3dpp ) );
    d3dpp.Windowed = TRUE;
    d3dpp.SwapEffect = D3DSWAPEFFECT_DISCARD;
    d3dpp.BackBufferFormat = D3DFMT_UNKNOWN;
    d3dpp.EnableAutoDepthStencil = TRUE;
    d3dpp.AutoDepthStencilFormat = D3DFMT_D16;

    // Create the D3DDevice
    if( FAILED( g_pD3D->CreateDevice( D3DADAPTER_DEFAULT, D3DDEVTYPE_HAL, hWnd,
                                      D3DCREATE_SOFTWARE_VERTEXPROCESSING,
                                      &d3dpp, &g_pd3dDevice ) ) )
    {
        return E_FAIL;
    }

    // Turn on the zbuffer
    g_pd3dDevice->SetRenderState( D3DRS_ZENABLE, TRUE );

    // Turn on ambient lighting 
    g_pd3dDevice->SetRenderState( D3DRS_AMBIENT, 0xffffffff );

    return S_OK;
}

//-----------------------------------------------------------------------------
// Name: InitGeometry()
// Desc: Load the mesh and build the material and texture arrays
//-----------------------------------------------------------------------------
HRESULT InitGeometry()
{
    LPD3DXBUFFER pD3DXMtrlBuffer;

    // Load the mesh from the specified file
    if( FAILED( D3DXLoadMeshFromX( L"Tiger.x", D3DXMESH_SYSTEMMEM,
                                   g_pd3dDevice, NULL,
                                   &pD3DXMtrlBuffer, NULL, &g_dwNumMaterials,
                                   &g_pMesh ) ) )
    {
        // If model is not in current folder, try parent folder
        if( FAILED( D3DXLoadMeshFromX( L"..\\Tiger.x", D3DXMESH_SYSTEMMEM,
                                       g_pd3dDevice, NULL,
                                       &pD3DXMtrlBuffer, NULL, &g_dwNumMaterials,
                                       &g_pMesh ) ) )
        {
            MessageBox( NULL, L"Could not find tiger.x", L"Meshes.exe", MB_OK );
            return E_FAIL;
        }
    }

    // We need to extract the material properties and texture names from the 
    // pD3DXMtrlBuffer
    D3DXMATERIAL* d3dxMaterials = ( D3DXMATERIAL* )pD3DXMtrlBuffer->GetBufferPointer();
    g_pMeshMaterials = new D3DMATERIAL9[g_dwNumMaterials];
    if( g_pMeshMaterials == NULL )
        return E_OUTOFMEMORY;
    g_pMeshTextures = new LPDIRECT3DTEXTURE9[g_dwNumMaterials];
    if( g_pMeshTextures == NULL )
        return E_OUTOFMEMORY;

    for( DWORD i = 0; i < g_dwNumMaterials; i++ )
    {
        // Copy the material
        g_pMeshMaterials[i] = d3dxMaterials[i].MatD3D;

        // Set the ambient color for the material (D3DX does not do this)
        g_pMeshMaterials[i].Ambient = g_pMeshMaterials[i].Diffuse;

        g_pMeshTextures[i] = NULL;
        if( d3dxMaterials[i].pTextureFilename != NULL &&
            lstrlenA( d3dxMaterials[i].pTextureFilename ) > 0 )
        {
            // Create the texture
            if( FAILED( D3DXCreateTextureFromFileA( g_pd3dDevice,
                                                    d3dxMaterials[i].pTextureFilename,
                                                    &g_pMeshTextures[i] ) ) )
            {
                // If texture is not in current folder, try parent folder
                const CHAR* strPrefix = "..\\";
                CHAR strTexture[MAX_PATH];
                strcpy_s( strTexture, MAX_PATH, strPrefix );
                strcat_s( strTexture, MAX_PATH, d3dxMaterials[i].pTextureFilename );
                // If texture is not in current folder, try parent folder
                if( FAILED( D3DXCreateTextureFromFileA( g_pd3dDevice,
                                                        strTexture,
                                                        &g_pMeshTextures[i] ) ) )
                {
                    MessageBox( NULL, L"Could not find texture map", L"Meshes.exe", MB_OK );
                }
            }
        }
    }

    // Done with the material buffer
    pD3DXMtrlBuffer->Release();

    return S_OK;
}

//-----------------------------------------------------------------------------
// Name: Cleanup()
// Desc: Releases all previously initialized objects
//-----------------------------------------------------------------------------
VOID Cleanup()
{
    if( g_pMeshMaterials != NULL )
        delete[] g_pMeshMaterials;

    if( g_pMeshTextures )
    {
        for( DWORD i = 0; i < g_dwNumMaterials; i++ )
        {
            if( g_pMeshTextures[i] )
                g_pMeshTextures[i]->Release();
        }
        delete[] g_pMeshTextures;
    }
    if( g_pMesh != NULL )
        g_pMesh->Release();

    if( g_pd3dDevice != NULL )
        g_pd3dDevice->Release();

    if( g_pD3D != NULL )
        g_pD3D->Release();
}

//-----------------------------------------------------------------------------
// Name: SetupMatrices()
// Desc: Sets up the world, view, and projection transform matrices.
//-----------------------------------------------------------------------------
VOID SetupMatrices()
{
    // Set up world matrix
    D3DXMATRIXA16 matWorld;
    D3DXMatrixRotationY( &matWorld, NULL );
    g_pd3dDevice->SetTransform( D3DTS_WORLD, &matWorld );

    // Set up our view matrix. A view matrix can be defined given an eye point,
    // a point to lookat, and a direction for which way is up. Here, we set the
    // eye five units back along the z-axis and up three units, look at the 
    // origin, and define "up" to be in the y-direction.
    D3DXVECTOR3 vEyePt( 10.0f, 200.0f,-500.0f );
    D3DXVECTOR3 vLookatPt( 0.0f, 0.0f, 0.0f );
    D3DXVECTOR3 vUpVec( 0.0f, 1.0f, 0.0f );
    D3DXMATRIXA16 matView;
    D3DXMatrixLookAtLH( &matView, &vEyePt, &vLookatPt, &vUpVec );
    g_pd3dDevice->SetTransform( D3DTS_VIEW, &matView );

    // For the projection matrix, we set up a perspective transform (which
    // transforms geometry from 3D view space to 2D viewport space, with
    // a perspective divide making objects smaller in the distance). To build
    // a perpsective transform, we need the field of view (1/4 pi is common),
    // the aspect ratio, and the near and far clipping planes (which define at
    // what distances geometry should be no longer be rendered).
    D3DXMATRIXA16 matProj;
    D3DXMatrixPerspectiveFovLH( &matProj, D3DX_PI / 4, 1.0f, 1.0f, 1000.0f );
    g_pd3dDevice->SetTransform( D3DTS_PROJECTION, &matProj );
}

//-----------------------------------------------------------------------------
// Name: Render()
// Desc: Draws the scene
//-----------------------------------------------------------------------------
VOID Render()
{
    // Clear the backbuffer and the zbuffer
    g_pd3dDevice->Clear( 0, NULL, D3DCLEAR_TARGET | D3DCLEAR_ZBUFFER,
                         D3DCOLOR_XRGB( 0, 0, 255 ), 1.0f, 0 );

    // Begin the scene
    if( SUCCEEDED( g_pd3dDevice->BeginScene() ) )
    {
        // Setup the world, view, and projection matrices
        SetupMatrices();

        // Meshes are divided into subsets, one for each material. Render them in
        // a loop
        for( DWORD i = 0; i < g_dwNumMaterials; i++ )
        {
            // Set the material and texture for this subset
            g_pd3dDevice->SetMaterial( &g_pMeshMaterials[i] );
            g_pd3dDevice->SetTexture( 0, g_pMeshTextures[i] );

            // Draw the mesh subset
            g_pMesh->DrawSubset( i );
        }

        // End the scene
        g_pd3dDevice->EndScene();
    }

    // Present the backbuffer contents to the display
    g_pd3dDevice->Present( NULL, NULL, NULL, NULL );
}

//-----------------------------------------------------------------------------
// Name: MsgProc()
// Desc: The window's message handler
//-----------------------------------------------------------------------------
LRESULT WINAPI MsgProc( HWND hWnd, UINT msg, WPARAM wParam, LPARAM lParam )
{
    switch( msg )
    {
        case WM_DESTROY:
            Cleanup();
            PostQuitMessage( 0 );
            return 0;
    }

    return DefWindowProc( hWnd, msg, wParam, lParam );
}

//-----------------------------------------------------------------------------
// Name: WinMain()
// Desc: The application's entry point
//-----------------------------------------------------------------------------
INT WINAPI wWinMain( HINSTANCE hInst, HINSTANCE, LPWSTR, INT )
{
    UNREFERENCED_PARAMETER( hInst );

    // Register the window class
    WNDCLASSEX wc =
    {
        sizeof( WNDCLASSEX ), CS_CLASSDC, MsgProc, 0L, 0L,
        GetModuleHandle( NULL ), NULL, NULL, NULL, NULL,
        L"D3D Tutorial", NULL
    };
    RegisterClassEx( &wc );

    // Create the application's window
    HWND hWnd = CreateWindow( L"D3D Tutorial", L"D3D Tutorial 06: Meshes",
                              WS_OVERLAPPEDWINDOW, 100, 100, 300, 300,
                              NULL, NULL, wc.hInstance, NULL );

    // Initialize Direct3D
    if( SUCCEEDED( InitD3D( hWnd ) ) )
    {
        // Create the scene geometry
        if( SUCCEEDED( InitGeometry() ) )
        {
            // Show the window
            ShowWindow( hWnd, SW_SHOWDEFAULT );
            UpdateWindow( hWnd );

            // Enter the message loop
            MSG msg;
            ZeroMemory( &msg, sizeof( msg ) );
            while( msg.message != WM_QUIT )
            {
                if( PeekMessage( &msg, NULL, 0U, 0U, PM_REMOVE ) )
                {
                    TranslateMessage( &msg );
                    DispatchMessage( &msg );
                }
                else
                    Render();
            }
        }
    }

    UnregisterClass( L"D3D Tutorial", wc.hInstance );
    return 0;
} 
```

# asp.net - app_code 目录中的 ASP.NET 跟踪？

> ID：11746947
> 
> 赞同：1
> 
> 时间：2012-07-31T18:48:45.087
> 
> 标签：asp.net, vb.net, debugging, trace

有没有人能够从 app_code 目录中的类中的函数成功执行 Trace.Warn 语句？我没有任何运气，我想知道这是否可能。

（嗯，我确定这是可能的，我只需要弄清楚如何）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T19:07:25.237

是的你可以。

你有没有尝试过：

```
HttpContext.Current.Trace.Warn("message"); 
```

请记住，您必须在 web.config 中启用跟踪

```
<trace enabled="true" pageOutput="true" mostRecent="true"/> 
```

# c# - 在 Web 项目中使用多个 nhibernate 版本

> ID：11746948
> 
> 赞同：0
> 
> 时间：2012-07-31T18:48:46.220
> 
> 标签：c#, asp.net, nhibernate, structuremap

我正在维护一个设计使用 NHibernate 2.1.0.4 的 Web 应用程序。

我正在合并一个使用 StructureMap 并具有更新版本的 NHibernate 3.3.0.4 的程序集。

当我尝试创建会话实例时，我的 Web 应用程序失败了：

```
var sessionFactory = ObjectFactory.GetInstance<ISessionFactory>(); 
```

出现 StructureMap 202 错误。

显然我不能使用旧版本的界面，但我需要为应用程序的其余部分维护旧版本。

如何在不丢失旧版本的情况下合并新版本的程序集？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T20:12:37.623

您不能在同一应用程序中引用同一程序集的两个版本。

# wordpress - 像按钮和像框消失了

> ID：11746950
> 
> 赞同：0
> 
> 时间：2012-07-31T18:48:57.037
> 
> 标签：wordpress, facebook-likebox

讨厌问最有可能是我的错的事情，但我很难过。首先，我绝对不是真正的开发人员或网站设计师。我自愿为一个我自愿加入的非营利组织建立一个新网站，因为我比其他任何人都了解更多（可怕的警告信号）。使用 wordpress（facebook 按钮没有插件）。

原本计划在本周上线，但我离开去吃午饭，回来后，几乎所有的 Facebook 点赞按钮和点赞框都消失了（它们已经启动并运行了大约两周）。当我使用 Chrome Web Developer 检查代码时，我看到代码仍然存在，但显示为灰色。

主页上有一个很好的例子：www.thecarecommunities.com 在页面底部，赞助商徽标和 Twitter 提要之间应该有一个 Like Box。另一个位置在帖子上，例如这里：[http](http://thecarecommunities.com/gala-press-release/) ://thecarecommunities.com/gala-press-release/ 在推特按钮之前应该有一个 Facebook 赞按钮，在推特提要上方的右侧应该有一个赞框。

我是唯一可以访问这些文件的人，我已经仔细检查了标题中的脚本代码，将按钮放置在它们应该在的位置的代码，并且一切都保持原样。如果有人可以帮助找到错误，我将不胜感激。

PS。目前的网站是 www.thecarecommunities.org，所以大部分链接已经设置为切换到 .org 域，所以现在很多都转到 404 页面。

1.  标头中的 SDK 脚本

    ```
    add_action('headway_body_open', 'fb_sdk_script');
    function fb_sdk_script () {
    ?> 
    <div>
    <div id="fb-root"></div>
    <script>(function(d, s, id) {
    var js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) return;
    js = d.createElement(s); js.id = id;
    js.src = "//connect.facebook.net/en_US/all.js#xfbml=1";
    fjs.parentNode.insertBefore(js, fjs);
    }(document, 'script', 'facebook-jssdk'));</script>  
    </div>
    <? 
    ```

2.  喜欢首页 www.thecarecommunities.com 上的框

    ```
    <div class="fb-like-box" data-href="http://www.facebook.com/thecarecommunities"data-width="406" data-height="520" data-show-faces="true" data-stream="false"data-header="true"></div> 
    ```

3.  推特按钮应该在主页顶部的“赞”按钮

    ```
    <div class="fb-like" data-href="http://thecarecommunities.org" data-send="false" data-layout="button_count" data-width="60" data-show-faces="false"></div> 
    ```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T19:23:08.927

有一个对谷歌的调用，加上你脑海中的一个脚本，如下所示：

```
<script gapi_processed="true" type="text/javascript" src="https://apis.google.com/js/plusone.js">
  {"parsetags": "explicit"} 
```

这个脚本标签不是用闭包关闭的。它需要是：

```
<script gapi_processed="true" type="text/javascript" src="https://apis.google.com/js/plusone.js">
  {"parsetags": "explicit"}
 </script> 
```

这会阻止加载 Facebook SDK 的后续脚本标记。

# .htaccess - htaccess 将动态旧文件重定向到新文件

> ID：11746952
> 
> 赞同：0
> 
> 时间：2012-07-31T18:49:01.117
> 
> 标签：.htaccess, url, redirect, dynamic

我已经升级了我的网站并更改了文件的一些位置。一部分是用于创建提要。所以在我以前有这个之前：

```
mydomain/plugins/rss/feed.php?id=187 
```

但现在它变成了：

```
mydomain/feed.php?from=category&id=187 
```

唯一改变的部分是来自变量的 ID 没有改变。我用这个试过：

```
RewriteRule ^plugins/rss/feed.php?id=([0-9]+)$ feed.php?from=category&id=$1 [R=301,L] 
```

但这不起作用......有人知道如何将其重定向到新的吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T19:21:30.230

您无法匹配命令中的查询字符串（ URI 中**?**标记之后的所有内容） `RewriteRule`。但是由于它不需要更改，因此您无需对此进行处理。如果您删除该检查，您的规则应该可以正常工作。尝试将其更改为：

```
RewriteRule ^plugins/rss/feed.php /feed.php?from=category [R=301,L,QSA] 
```

`QSA`需要在此处添加标志以附加任何现有的查询字符串，在本例中为`id=`部分。

# javascript - Javascript：从另一个文件调用函数

> ID：11746955
> 
> 赞同：10
> 
> 时间：2012-07-31T18:49:15.160
> 
> 标签：javascript

我只是 Javascript 的新手，所以当我阅读 Javascript 文档时，我无法理解许多复杂的结构。

这是我正在阅读的 Javascript 代码的简短说明：在我的情况下，有两个主要文件：`Helper.js`和`Circle.js`.

在 Helper.js 中，有一个方法名 : `using:function(param1,param2)`。下面是代码`Circle.js`：

```
Helper.using('py.Figures', function (ns) {

    ns.Circle = function (params) {
        // some additional methods and code here
    }

    ns.Alert = function(){   // for the test purpose
           alert('hello');
    }
}); 
```

在文件 test.html 中，我写了一些这样的代码：

```
<script src="Helper.js"></script>
<script src="circle.js"></script>
<script>
   test = function(){
        py.Figures.Alert();  // calling for testing purpose
   }
</script>
<body onload="test();"></body> 
```

当我在 Chrome 上运行并在控制台中查看时，我遇到了这个错误：

> 未捕获的类型错误：对象 # 没有方法“警报”

这意味着我还没有导入这些类。请告诉我如何从另一个文件调用函数。在我的情况下是：调用`Alert()`

谢谢 ：）

@编辑：我为代码添加了一些链接：

[助手.js](http://pastebin.com/dsaLZKcE)

[Circle.js](http://pastebin.com/3YS76Qv1)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-31T18:56:03.693

你为什么不看看这个答案

[在 javascript 文件中包含 javascript 文件](https://stackoverflow.com/questions/950087/include-javascript-file-inside-javascript-file)

简而言之，您可以使用 AJAX 加载脚本文件或在 HTML 上放置一个脚本标记以包含它（在使用其他脚本功能的脚本之前）。我发布的链接是一个很好的答案，并且有多个示例和两种方法的解释。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-03-18T19:57:32.983

是的你可以。只需检查我的小提琴以获得澄清。出于演示目的，我将代码保存在同一位置。您可以提取该代码，如两个不同的 Javascript 文件中所示，并将它们加载到 html 文件中。

[https://jsfiddle.net/mvora/mrLmkxmo/](https://jsfiddle.net/mvora/mrLmkxmo/)

```
 /******** PUT THIS CODE IN ONE JS FILE *******/

    var secondFileFuntion = function(){
        this.name = 'XYZ';
    }

    secondFileFuntion.prototype.getSurname = function(){
     return 'ABC';
    }

    var secondFileObject = new secondFileFuntion();

    /******** Till Here *******/

    /******** PUT THIS CODE IN SECOND JS FILE *******/

    function firstFileFunction(){
      var name = secondFileObject.name;
      var surname = secondFileObject.getSurname()
      alert(name);
      alert(surname );
    }

    firstFileFunction(); 
```

如果您使用构造函数创建一个对象并尝试从第二个文件中访问该属性或方法，它将使您可以访问另一个文件中存在的属性。

只需注意将这些文件包含在 index.html 中的顺序

# qt - 当内容部分隐藏时，在运行时调整包含 QVBoxLayout 的 QWidget

> ID：11746958
> 
> 赞同：1
> 
> 时间：2012-07-31T18:49:27.200
> 
> 标签：qt, dynamic, resize, runtime, qwidget

在这个应用程序中，会生成一个 HBoxLayouts 列表并将其放入 VBoxLayout 中，以形成一个动态填充的命令列表。每个子列表上方都有一个按钮，可以隐藏其下方的控件。问题：当隐藏子列表时，包含最广泛 VBoxLayout 的小部件的大小不会改变！然后 VBoxLayout 会拉伸以进行补偿。我希望容器小部件在包含较少项目时缩小！它看起来像这样：

问题是，当我在其中一个 PushButtons 下隐藏一个列表时，包含的小部件不会缩小！当可见项目较少时，VBoxLayout 只会扩展:(

这是我如何看待我的小 GUI 的图片。

以下是更广泛的布局设置中的一些代码：

```
scrollArea = new QScrollArea(this);
scrollAreaLayoutWidget = new QWidget(scrollArea);
scrollAreaLayout = new QVBoxLayout(scrollAreaLayoutWidget);
//scrollAreaLayout is filled with all the stuff you see inside the scroll area...
scrollArea->setWidget(scrollAreaLayoutWidget); 
```

我尝试以多种方式更改容器小部件（蓝色框）的 QSizePolicy。我发现了几十个调整大小的问题，但不知何故我没有找到答案。是否有我缺少的神奇自动调整大小设置？让我知道这是否非常模糊或不完整。欢迎任何评论！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T16:49:09.710

事实证明，我所要做的就是创建一个自定义 SLOT，以便在单击隐藏部分 Ui 的按钮时创建一个自定义 SLOT，并在该函数中隐藏相关的小部件。在同一个函数中，我调用`[containerWidget]->adjustSize();`了它，它完全符合我的要求。

# python - 如何在 python 中为每个人更新银行？

> ID：11746962
> 
> 赞同：-2
> 
> 时间：2012-07-31T18:49:40.330
> 
> 标签：python

这就是我到目前为止所拥有的。我想为每个玩家更新银行，但我不知道如何将每个玩家连接到他们的银行？

我希望它看起来像这样：

```
How many players are in the game: 4
Player 1 you have $1000
What is your bet: 65
Player 2 you have $1000
What is your bet: 7
Player 3 you have $1000
What is your bet: 88
Player 4 you have $1000
What is your bet: 8 
```

虽然在一边，代码计算了每个玩家现在在一边有多少，我不希望它被打印出来，只是保存在内存中以备后用。我想我做错了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T18:55:01.777

你有正确的想法，你想使用一个列表，每个玩家都有一个元素。

您可以为每个玩家初始化一个包含 $1000 的列表：

```
bank = [1000] * players 
```

现在，您可以分别更新每个银行：

```
bank[i] = bank[i] - bet
print bank[i] 
```

所以你会有类似的东西：

```
"""
Player limit of up to 7 players. Has to be more than one player.
"""
players = int(raw_input("How many players are in the game: "))
while players == "" or players == 0 or players == 1 or players > 7:
    players = int(raw_input("How many players are in the game: "))
bank = [1000] * players
for i in range (players):
    print "Player " + str(i+1) + " you have " + "$" + str(bank)
    bet = int(raw_input("What is your bet: "))
    while bet <= 0 or bet > 1000:
        bet = int(raw_input("What is your bet: "))

    bank[i] = bank[i] - bet
    print bank[i] 
```

我不完全确定`bankinventory`要跟踪什么。

# r - R中的重叠矩阵

> ID：11746969
> 
> 赞同：8
> 
> 时间：2012-07-31T18:50:24.657
> 
> 标签：r

我有以下数据框

```
id channel
1  a
1  b
1  c
2  a
2  c
3  a 
```

我想创建和重叠矩阵。它基本上是一个方阵，其中行和列标签为 a、b、c，该表中的每个条目显示每个通道共有多少个 id。例如在上面的例子中，矩阵看起来像

```
 a b c
a 3 1 2
b 1 1 1
c 2 1 2 
```

提前非常感谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-31T19:16:55.520

这应该可以解决问题：

```
df <- data.frame(id=c(1,1,1,2,2,3), channel=letters[c(1,2,3,1,3,1)]) # your data

m <- table(df[[1]], df[[2]])   ## Alternatively:  m <- do.call(table, df)
t(m) %*% m
#   a b c
# a 3 1 2
# b 1 1 1
# c 2 1 2 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-31T19:25:32.500

```
library(plyr)
df
  id channel
1  1       a
2  1       b
3  1       c
4  2       a
5  2       c
6  3       a
tb <- table(ddply(df, .(id), function(x) {x$id <- x$channel; expand.grid(x)}))
tb
   channel
id  a b c
  a 3 1 2
  b 1 1 1
  c 2 1 2
names(dimnames(tb)) <- NULL
tb
  a b c
a 3 1 2
b 1 1 1
c 2 1 2 
```

现在一些解释和一些关于矩阵表作为输出的东西`table()`。有一个例子`?table`

```
a <- letters[1:3]
(b <- sample(a))
[1] "b" "c" "a"
table(a, b)
   b
a   a b c
  a 0 1 0
  b 0 0 1
  c 1 0 0 
```

所以它通过位置匹配元素..现在如果我们有

```
 id channel
  1       a
  1       b
  1       c
  2       a
  ... 
```

`id`然后可以通过拆分数据框来显示共享相同的`id`内容，创建列的副本`channel`并获取这两列的所有组合：

```
tbl <- expand.grid(data.frame(x = c("a","b","c"), y = c("a", "b", "c")))
tbl
  x y
1 a a
2 b a
3 c a
4 a b
5 b b
6 c b
7 a c
8 b c
9 c c
table(tbl$x, tbl$y)

    a b c
  a 1 1 1
  b 1 1 1
  c 1 1 1 
```

# android - 从 Google Play 或开发者控制台中删除 .apk

> ID：11746970
> 
> 赞同：7
> 
> 时间：2012-07-31T18:50:24.487
> 
> 标签：android, google-play, apk

所以我做了这个测试应用程序并将它上传到开发者控制台，但是因为它是我的第一个应用程序，所以它的包被命名为 com.myfirstapp.program。现在后来我制作了同一个程序的更好版本，这次它使用了正确的包名，但是谷歌播放不会让我上传我的新程序，因为包名不同。而且我真的不想使用 com.myfirstapp.program。有什么我可以做的吗？我尝试搜索是否可以完全删除我的 apk，但发现这是不可能的，所以我有点卡在这里。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T19:02:59.677

查看有关从 Google Play 取消发布和删除的答案。

[如何从 Android 开发者控制台的应用列表中删除应用](https://stackoverflow.com/questions/11074972/how-remove-application-from-app-listings-on-android-developer-console)

# java - Eclipse for android：R 的问题

> ID：11746973
> 
> 赞同：1
> 
> 时间：2012-07-31T18:50:31.460
> 
> 标签：java, android, eclipse

我正在尝试做一个定位应用程序，现在正处于故障排除阶段。我已经解决了最后两个问题，它们都与 R. blah blah 有关。它说 main 要么不是字段，要么无法解析，并且消息相同，但使用 mapview 而不是 main。下面是我的导入和问题所在的代码行。

代码：

```
 setContentView(R.layout.main);
    mapview = (MapView)findViewById(R.id.mapview); 
```

进口：

```
 import android.R;
    import android.R.layout;
    import android.R.id;
    import android.location.Location;
    import android.location.LocationListener;
    import android.location.LocationManager;
    import android.os.Bundle;
    import android.widget.Toast;

    import com.google.android.maps.GeoPoint;
    import com.google.android.maps.MapActivity;
    import com.google.android.maps.MapController;
    import com.google.android.maps.MapView; 
```

我什么都试过了。我知道人们一直说要取出 android.R，但这就是在 jar 文件中找到 R.layout 和 R.id 的地方。我已右键单击该文件夹并验证了代码。我已经去了 Project/Clean 并做到了。没运气。请帮忙？这是我的第一篇文章，如果格式错误，我很抱歉。我提前感谢你给我的任何帮助。这是我的 main.xml

```
 <?xml version="1.0" encoding="utf-8"?>
    <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
        android:orientation="vertical"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        >
    <TextView android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:text="Waiting for location..."
        android:id="@+id/lblLocationInfo"
    />
    <com.google.android.maps.MapView
        xmlns:android="http://schemas.android.com/apk/res/android"
        android:id="@+id/mapview"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:clickable="true"
        android:apiKey="0vFrUOhHMkbahT9zXqiz_DuNVWfPqlEyqcO8ftg"
    />
    </LinearLayout> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T18:52:48.097

尝试删除该行：

```
import android.R; 
```

然后进行 Build Clean，这可以解决问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-31T19:02:28.210

除非您使用来自 android 的资源，否则您不需要这些行

```
import android.R; 
import android.R.Id;
import android.R.layout; 
```

**删除这些行**

R 正在解析为 androids R 而不是`com.yourpackage.yourproject.R`。

如果不需要，请删除导入。如果您需要在代码中明确说明。前任。

```
ImageView.setDrawable(android.R.ic_menu_search); //uses an android resource

findViewById(R.id.mapView); //uses your resource file

setContentView(R.layout.activity_main); // must have an activity_main.xml file in YourProject/res/layout 
```

**编辑：**

更改以下代码：

```
//import android.R;
//import android.R.layout;    //comment or delete these lines
//import android.R.id;
import android.location.Location;
import android.location.LocationListener;
import android.location.LocationManager;
import android.os.Bundle;
import android.widget.Toast;

import com.google.android.maps.GeoPoint;
import com.google.android.maps.MapActivity;
import com.google.android.maps.MapController;
import com.google.android.maps.MapView;

setContentView(R.layout.activity_main);  //changed main to activity_main
mapview = (MapView)findViewById(R.id.mapview); 
```

**编辑 2**

在 MainActivity.java 的最顶部应该有一行以该行其余部分的内容开头`package`？

在您的 AndroidManifest.xml 中还有一个 package 的条目它说什么？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-31T18:54:42.370

`R.java`这是一个自行生成的文件，您需要重新构建它才能生成它，忽略警告并“构建干净”您的文件

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-31T19:00:59.887

这也可能与您的项目设置有关。当我创建一个新项目时，我通常做的是设置“订购和导出”选项。这样您就不必导入任何 R.* 包。

在 Eclipse 中，右键单击您的项目转到`Properties -> Java Build Path -> Order and Export`. 只需确保 yourprojectname/gen 文件夹位于yourprojectname/src 文件夹**之上。**

# java - Java 输入流大小

> ID：11746978
> 
> 赞同：7
> 
> 时间：2012-07-31T18:51:01.673
> 
> 标签：java, inputstream, nio

我需要在不创建 File 实例的情况下获取 InputStream 的大小（以字节为单位）。有没有办法使用 Java NIO 来做到这一点？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-07-31T18:57:33.663

将军的`InputStream`？您必须不断地阅读和阅读（例如，一遍又一遍地读入同一个缓冲区）计算您已经阅读了多少字节，直到您到达流的末尾。

当然，您将无法读取数据本身......如果您想这样做，您需要在读取数据时保留数据，例如将其复制到`ByteArrayOutputStream`.

（如果您能够在计算长度的同时处理数据，那么就这样做 - 当您使用循环读取它时，每次都读入同一个缓冲区，只需增加一个计数器来记录您的多少”已阅读。您并没有真正向我们提供有关您想对流做什么的任何信息。）

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-31T23:00:22.870

原则上它是不可知的（考虑一个永不停止写作的同行），你也不需要它。只需使用固定大小的缓冲区在循环中读取和写入。NIO 没有提供任何神奇的解决方案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-31T19:57:54.147

几个额外的选项：

根据输入流的*阻塞*性质，您可以在流上调用[available()](http://docs.oracle.com/javase/6/docs/api/java/io/InputStream.html#available%28%29)。

如果流很小，您可以将它们写入[PushbackInputStream](http://docs.oracle.com/javase/6/docs/api/java/io/PushbackInputStream.html)，计算字节数然后倒带。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2013-03-21T12:15:33.603

您可以使用 Utils.java 的 getBytes(inputStream) 获取 InputStream 的大小检查以下链接

[从输入流中获取字节](http://www.java2s.com/Tutorial/Java/0180__File/GetbytesfromInputStream.htm)

# java - Java：神秘的 Java 未捕获异常处理程序 [附代码]

> ID：11746979
> 
> 赞同：8
> 
> 时间：2012-07-31T18:51:03.447
> 
> 标签：java, exception, uncaughtexceptionhandler

发生了一些奇怪的事情。我编写了一个 Java 程序，但我没有采取任何特殊方式处理未捕获的异常。但是当我在 Windows 7 中运行这个特定程序时，在从 main 调用的静态上下文中存在这个未捕获的异常，导致弹出一个窗口，显示异常。我试图编写一个小程序来复制这种效果，但无济于事。一个程序（我完全手工编写）会产生一个弹出窗口，而没有其他程序会这样做。

我想特别跟踪这一点，以便我可以添加使其他 CAUGHT 异常以类似方式显示堆栈跟踪的代码。

我在 IRC 中问过这个问题，但人们告诉我这不会发生。好吧，它确实发生了。下面有一个截图。

我认为我唯一的希望是如果其他人认识到这一点并能告诉我它来自哪里。

谢谢！

![Java 异常](../Images/ab3032a94aab6f6c899d5dd779c063e3.png)

更新：很抱歉延迟获取一些代码。我不得不照顾一个绞痛的婴儿。请注意，这是一个桌面 Java 应用程序。它不是小程序，也不使用 webstart。

这是从获取对话框的程序中复制和粘贴的代码。我会再做一次编辑，让你知道我的同事（谁得到了例外）是否得到了这个案例的对话框。我一直小心地包括导致异常的所有内容。仅缺少 IPAddress 类实现，但这不参与异常，因为直到异常发生后才实际使用它。请注意发生异常的行之前的星号。该行代码与您在屏幕截图中看到的异常相对应。

```
package staticexception;

import java.net.InterfaceAddress;
import java.net.NetworkInterface;
import java.net.SocketException;
import java.util.ArrayList;
import java.util.Collections;
import java.util.Enumeration;
import java.util.List;
import javax.swing.UIManager;

public class StaticException {
    // Don't need this fully implemented.
    public static class IPAddress {

        public static IPAddress getBroadcast(IPAddress mask, IPAddress myip) {
            return new IPAddress();
        }

        public IPAddress() {}

        public IPAddress(int maskval) {}

        public IPAddress(byte[] addr) {}

        public IPAddress mask(IPAddress netmask) {
            return this;
        }

        public int prefixLength() {
            return 0;
        }

    }

    public static class Network {
        public IPAddress broadcast, netmask, ip;
        boolean remember;

        public Network(IPAddress br, IPAddress nm, IPAddress ip) {
            broadcast = br;
            netmask = nm;
            this.ip = ip;
        }

        boolean match(IPAddress ip) {
            IPAddress a = ip.mask(netmask);
            IPAddress b = this.ip.mask(netmask);
            return (a.equals(b));
        }

        @Override
        public String toString() {
            return ip.toString() + "/" + netmask.prefixLength();
        }
    }

    static List<Network> my_networks;

    static void enumerateNetworks() {
        my_networks = new ArrayList<Network>();

        Enumeration<NetworkInterface> nets = null;
        try {
            nets = NetworkInterface.getNetworkInterfaces();
        } catch (SocketException ex) {
            ex.printStackTrace();
        }
        for (NetworkInterface netint : Collections.list(nets)) {
            for (InterfaceAddress address : netint.getInterfaceAddresses()) {
                // *** Exception would occur on the next line when 
                // *** address.getAddress() would return null
                byte[] addr = address.getAddress().getAddress();
                if (addr.length == 4 && addr[0] != 127) {
                    int prefixlen = address.getNetworkPrefixLength();
                    int maskval = -1 << (32 - prefixlen);
                    IPAddress mask = new IPAddress(maskval);
                    //my_netmask = mask;
                    System.out.println("Netmask   = " + mask);

                    IPAddress myip = new IPAddress(addr);
                    //my_ip_address = myip;
                    System.out.println("Local IP  = " + myip);

                    IPAddress broadcast = IPAddress.getBroadcast(mask, myip);
                    System.out.println("Broadcast = " + broadcast);

                    my_networks.add(new Network(broadcast, mask, myip));

                    System.out.print(address.getAddress().getAddress().length + " ");
                    System.out.print(address.getAddress() + " ");
                    System.out.print(address.getAddress().getHostAddress() + " ");
                    System.out.println(address.getNetworkPrefixLength());
                }
            }
        }
    }

    static private void setupNetwork() {
        System.setProperty("java.net.preferIPv4Stack","true");

        enumerateNetworks();

        // ... stuff that would happen after the exception
    }

    public static void main(String[] args) {
        try {         
            UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());     
        } catch (Exception e) {}

        setupNetwork();

        // ... stuff that would happen after the exception
    }
} 
```

第二次更新：我的同事报告说这个程序不会产生对话。这与获得弹出窗口的程序之间的唯一区别是获得弹出窗口的程序是从 AdvancedInstaller 生成的 exe 包装器启动的。除此之外，在 Java 程序中，执行顺序是相同的。我已经用谷歌搜索了这个，据我所知，AdvancedInstaller 根本没有做任何会导致生成此弹出窗口的操作。我不确定它是否可以在不修改 Java 程序的情况下（它没有），因为我不确定您是否可以从 Java 程序之外执行任何操作来实现这一点。除了可能捕获 stderr，但这并不能解释为什么由 AdvancedInstaller 包装的其他程序不'

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-31T18:59:28.003

**第二个答案** （在问题中添加了其他信息后）

[高级安装程序](http://www.advancedinstaller.com/)具有如下所述的“启动失败检查”设置：

> *启动失败检查*
> 
> 任何来自主线程的未捕获异常都会在一个对话框中进行描述，该对话框将允许用户停止应用程序或忽略该异常。此选项仅适用于 GUI 应用程序。

更多信息： http: [//www.advancedinstaller.com/user-guide/java-product-settings.html](http://www.advancedinstaller.com/user-guide/java-product-settings.html)。

**第一个答案**

这高度依赖于上下文，您没有提供足够的信息来获得非常具体的答案。loc2.LoC2.java 可能是自定义或项目特定代码。

不过，通常可以通过以下方式管理（或查询）未捕获的处理程序：

*   `Thread.setDefaultUncaughtExceptionHandler`和
*   `Thread.getDefaultUncaughtExceptionHandler`

更多信息：

*   [http://docs.oracle.com/javase/6/docs/api/java/lang/Thread.UncaughtExceptionHandler.html](http://docs.oracle.com/javase/6/docs/api/java/lang/Thread.UncaughtExceptionHandler.html)

# ruby-on-rails - ActiveRecord Group by 语句未转换为 Time.zone

> ID：11746980
> 
> 赞同：1
> 
> 时间：2012-07-31T18:51:06.030
> 
> 标签：ruby-on-rails, activerecord, time, timezone

我使用下面的查询来计算按天细分的签到次数。

```
Checkin.select("date(created_at) as calendar_day, count(*) as total_checkins").where("user_id = ? AND created_at > ?", user.id, 28.days.ago).group("date(created_at)").order("date(created_at)") 
```

示例输出：

![示例输出](../Images/d2286fb37aaedea26521519a588f5be4.png)

我面临的问题是此查询采用 UTC 格式，并且不会转换为我在 config.time_zone 下的 application.rb 文件中设置的 Time.zone (PST)。在上面的示例中，最后两个签到应该在“2012-07-30”下。

我知道对于其他查询，这种转换可以正常工作。例如：

```
Checkin.last.created_at # Returns in PST 
```

所以一定是上面查询的复杂性。我猜这可能是选择语句。我如何编写以上内容来说明配置的时区？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-30T08:09:53.830

我正在做同样的事情（尽管我按分钟分组）......使用下面的代码适合我......

```
Time.zone.utc_to_local(DateTime.parse(@checkin[:calendar_day])) 
```

我对组中的每个项目执行此操作，然后将数组哈希传递给视图层。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-03-25T04:45:54.117

我在尝试按天对活动进行分组时遇到了同样的问题（这是用于高图表）。我本来想做这样的事情：

```
# Didn't work
counts = Event.where(:created_at => start_date..end_date.end_of_day)
.group("DATE(created_at)").count

return (start_date..end_date).map{ |d| counts[d] } 
```

但是 start_date 和 end_date 在我的本地时区，并且 DATE 函数在 UTC 中。相反，我在 Ruby 中做到了这一点。

```
counts = Event.where(:created_at => start_date..end_date.end_of_day)
.pluck(:id, :created_at)
.group_by{|obj| obj[1].to_date}

return (start_date..end_date).map{ |d| counts[d].try(:size) } 
```

# javascript - 地理位置 onSuccess 回调中的操作

> ID：11746981
> 
> 赞同：0
> 
> 时间：2012-07-31T18:51:08.353
> 
> 标签：javascript, cordova, callback

我正在Phonegap 中编写应用程序，但遇到了一个问题。我正在使用 navigator.geolocation 的 watchPosition 方法。在 onSuccess 回调中，我必须执行许多修改一些全局值的操作。问题是，有时（通常）在前一个回调完成它的工作之前触发一个回调。这会导致严重的数据不一致。我尝试修改“maximumAge”选项（phonegap 中不再支持频率​​）但它没有改变任何东西 - 仍然每秒调用一次 onSuccess 回调。我应该怎么做才能解决这个问题？有什么线索吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-01T08:22:34.447

您是否尝试过跳过一些消息？

```
if(!running)
{ 
 running=true;
..code here...
 running=false
} 
```

# objective-c - iOS 如何实现一个协议的@property

> ID：11746986
> 
> 赞同：4
> 
> 时间：2012-07-31T18:51:26.427
> 
> 标签：objective-c, ios, cocoa

我的理解是协议指定方法名称，而符合该协议的其他人执行方法的实现。

那么协议中声明的属性呢？那是实现一个属性意味着实现它的setter和getter吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-31T19:28:21.120

属性是一个或两个具有特定签名的方法的花哨名称，Objective-C 提供了一个约定，允许您使用替代点`.`语法调用它们。一个协议声明，比如说，一对

```
-(int) foo;
-(void)setFoo:(int)_foo; 
```

方法和声明读写属性的协议：

```
 @property (readwrite) foo; 
```

所以你是绝对正确的，实现一个属性意味着实现一个或两个方法，这取决于你是实现只读、只写还是读写属性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-31T19:38:27.460

正如其他人所说，您只需要实现 getter 和或 setter （取决于属性）。

我要补充一点，你可以合成它们：

> @property (nonatomic, 保留) NSObject * foo;

最终会在：

> @synthesize 富；

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-31T18:52:57.410

协议只是确保对象实现一组方法的东西。例如，如果您要使用一个对象作为您的类的委托，您需要确保它实现了您将要调用的方法。这就是协议的重点。

# google-search-appliance - 为什么使用 OR 时我的 GSA 无法排序？

> ID：11746990
> 
> 赞同：0
> 
> 时间：2012-07-31T18:51:41.257
> 
> 标签：google-search-appliance

在我们的 GSA 中，我试图检索具有“article”或“ooyala”的“XosContentType”元数据标记的文档。为此，我运行以下搜索命令：

```
/search?q=&access=p&output=xml_no_dtd&num=7&start=0&filter=0&requiredfields=(XosContentType%3aarticle%7cXosContentType%3aooyala)&sort=date:D:R:d1 
```

虽然这给了我正确匹配我的必填字段标准的结果，但它们根本没有排序。例如以下是我收到的节点的顺序

```
<FS NAME="date" VALUE="2012-07-13"/>
<FS NAME="date" VALUE="2012-07-25"/>
<FS NAME="date" VALUE="2012-05-23"/>
<FS NAME="date" VALUE="2012-03-10"/>
<FS NAME="date" VALUE="2012-05-15"/> 
```

它就像这样继续下去。如果我只按一个标准搜索，那么一切都会正确排序，但同时使用这两个标准都会失败。

那么我怎样才能让排序正常工作呢？我真的不想自己进行搜索和组合结果，因为这会使分页变得非常复杂。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-01T03:53:36.180

我相信您需要提供一个查询词来按日期排序。尝试将您的必填字段过滤器切换为 inmeta。

看到这个：

[https://groups.google.com/forum/?fromgroups#!topic/Google-Search-Appliance-Help/8oSW7nZBmuw](https://groups.google.com/forum/?fromgroups#!topic/Google-Search-Appliance-Help/8oSW7nZBMuw)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-02T14:12:15.373

您还可以添加查询词

```
site:mywebsite.com 
```

但这只有在您的所有数据都属于同一个域时才有效。

# android - 如何覆盖库项目中的配置文件？

> ID：11746992
> 
> 赞同：2
> 
> 时间：2012-07-31T18:51:50.493
> 
> 标签：android, android-library

我的问题可能看起来有点奇怪；但我只想找到实现它的正确方法。我的麻烦场景如下：

*   我的库项目中有一个默认配置文件。假设它被命名为“a.properties”。
*   我的库项目被一个名为“B”的第三方应用程序项目使用。
*   “B”开发人员厌倦了我的“a.properties”文件，想在某一天覆盖它。

由于他们无权更改位于我的密封 jar 文件中的配置文件，因此他们将在其“res”文件夹文件中的某个位置放置一个新的“a.properties”来替换我的。但是，我的 API 必须以某种方式意识到应该读取新的配置文件，而不是我在库项目的“res”文件夹中获得的配置文件。

您是否认为该配置文件的路径及其名称与他们在库项目中已有的完全相同就足以覆盖该文件？

# sitecore - 作为工作流程的一部分发布别名？

> ID：11746993
> 
> 赞同：0
> 
> 时间：2012-07-31T18:51:52.253
> 
> 标签：sitecore, sitecore6, sitecore-workflow

目前我们有一个具有作者和编辑角色的自定义工作流程，当项目达到最终状态时，工作流程将自动发布项目。两个角色都可以通过转到 Presentation -> Aliases 来创建和编辑页面的别名。

问题是，这些用户都不能发布别名更改，因为别名文件夹位于 /sitecore/system/aliases 中，并且只有管理员用户才能看到此文件夹

当项目被批准时，我如何处理与页面相关的别名以自动发布？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T19:53:07.140

最简单的解决方案可能是专门为角色添加权限到 /sitecore/system/aliases...？这个过程你是手动做的我拿吗？新别名是否也在通过工作流程？

除此之外，您可以创建一个新的工作流操作来查找项目的引用者，然后发布在 /sitecore/system/aliases 中找到的引用者。

编辑：

```
Sitecore.Links.LinkDatabase ld = Sitecore.Globals.LinkDatabase;
Sitecore.Links.ItemLink[] links = ld.GetReferers(myItem);

foreach(Sitecore.Links.ItemLink link in links)
{
    Item sourceItem = link.GetSourceItem();
    //if this item is an alias, publish it
} 
```

# jquery - 为什么 jQuery 验证在发送表单后运行？

> ID：11746995
> 
> 赞同：0
> 
> 时间：2012-07-31T18:52:05.110
> 
> 标签：jquery, forms, validation

我正在尝试使用 jQuery validate 插件验证此表单，但是一旦发现错误它就不会停止 javascript 代码，因此将表单发送到数据库，然后才显示错误。我能做些什么来正确链接这些事件？

```
$("#salvar-cur").live("click", function () {
    var validator = $("#frm_curriculo").validate({
        rules: {
            cur_nome: {
                required: true
            }
            //other options
        },
        messages: {
            cur_nome: {
                required: "*"
            }
            //other options
        }
    });
    if (validator.numberOfInvalids() == 0) {
        alert("Success!")
        var params = $("#frm_curriculo").serialize();
        $.ajax({
            type: "POST",
            url: "controller/ctrl_curriculo.php",
            data: "acao=inserir&" + params,
            dataType: "html",
            contentType: "application/x-www-form-urlencoded",
            success: function () {
                $("#frm_curriculo")[0].reset();
            }
        });
    }
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T18:56:19.203

首先，您在每次点击时重新添加验证器。您真的应该在事件处理程序之外执行此操作。

此外，不是检查，而是`validator.numberOfInvalids()`尝试检查`$("#frm_curriculo").valid()`，这将验证表单并返回`true`or `false`。

另一个注意事项，如果`#salvar-cur`是一个提交按钮，你会想要阻止它的默认操作。

```
$(function(){
    $("#frm_curriculo").validate({
        rules: {
            cur_nome: {
                required: true
            }
            //other options
        },
        messages: {
            cur_nome: {
                required: "*"
            }
            //other options
        }
    });
});

$("#salvar-cur").live("click", function (e) {
    e.preventDefault();
    if ($("#frm_curriculo").valid()) {
        alert("Success!")
        var params = $("#frm_curriculo").serialize();
        $.ajax({
            type: "POST",
            url: "controller/ctrl_curriculo.php",
            data: "acao=inserir&" + params,
            dataType: "html",
            contentType: "application/x-www-form-urlencoded",
            success: function () {
                $("#frm_curriculo")[0].reset();
            }
        });
    }
}); 
```

# google-app-engine - 如何在 Google App Engine 和 Google Cloud SQL 上正确设置多租户应用

> ID：11746996
> 
> 赞同：5
> 
> 时间：2012-07-31T18:52:05.197
> 
> 标签：google-app-engine, multi-tenant, google-cloud-sql

Google App Engine 通过使用命名空间在多租户应用程序方面工作良好。但是，当您使用 Cloud SQL 作为数据持久性机制时，您开始遇到问题。具体来说，如何将不同的数据库连接到每个命名空间。目前，整个应用程序使用的数据库是在实例配置中设置的，因此据我推测，它几乎是硬编码到部署中的。

我确实意识到多租户应用程序背后的确切架构因业务需求而异（或者至少应该是如果要有效扩展），但是我会对一些专门解决使用 Google Cloud 构建多租户应用程序的通用解决方案感到满意SQL。

我试图避免基于多租户列（除非有人可以解释为什么它是云 sql 的本质使我不必担心一切都在一个单一的数据库中）。理想情况下，恕我直言，让一个应用程序使用命名空间 api 附加到不同的数据库（都共享相同的模式）和某种机制来同步所有数据库租户之间的*列表数据。*

我们的其他想法是：

1.  每个租户都有自己的应用程序，因此硬编码数据库.. 同步列表数据（发布者/广播，代理？）的问题。
2.  每个租户都有自己的版本，因此是硬编码的数据库。使用数据存储来存储列表数据。
3.  一个应用程序，一个数据库，基于命名空间的前缀表名（但我们无法弄清楚如何让它动态地与 JPA 一起工作）

我们也不完全反对使用另一个兼容的云 sql 提供程序。

最后，您可能会问为什么要使用 SQL。唯一的原因是多个应用程序能够同时对其进行读取和写入，这是数据存储所不允许的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-01T16:02:40.943

这应该不是问题。应用程序使用的数据库可以在 JDBC 连接 URL 中指定，因此可以在运行时为每个应用程序定义：

c = DriverManager.getConnection("jdbc:google:rdbms://my_instance/my_database");