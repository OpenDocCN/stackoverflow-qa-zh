# StackOverflow 问答 10113000-10113999

# wpf - 如何将放置在 Telerik 的 RowDetailsTemplate 上的按钮绑定到视图的 ViewModel 中的 ICommand

> ID：10113001
> 
> 赞同：0
> 
> 时间：2012-04-11T19:57:34.490
> 
> 标签：wpf, xaml, binding, telerik, telerik-grid

考虑到这段代码：

```
<telerik:RadGridView ItemsSource="{Binding SearchResults}" RowDetailsVisibilityMode="VisibleWhenSelected">
    <telerik:RadGridView.Columns>
        <telerik:GridViewDataColumn Header="First Name" DataMemberBinding="{Binding FirstName}"  />
        <telerik:GridViewDataColumn Header="Last Name" DataMemberBinding="{Binding LastName}"  />
    </telerik:RadGridView.Columns>
    <telerik:RadGridView.RowDetailsTemplate>
        <DataTemplate>
            <Button Command="{Binding OpenView1Command}">Open View 1</Button> <!-- This does not work -->
        </DataTemplate>
    </telerik:RadGridView.RowDetailsTemplate>
</telerik:RadGridView> 
```

OpenView1Command 在我的 ViewModel 中定义。如何使绑定工作？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-11T21:45:25.083

好的，迈克尔，我之前的答案有效，所以 Telerik 没有任何问题，为了证明这一点，我将其编码，复制/粘贴/运行：

XAML：

```
<Window x:Class="Sample.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
     xmlns:telerik="http://schemas.telerik.com/2008/xaml/presentation"
    Height="350" Width="525" 
    x:Name="wnd">

<telerik:RadGridView  ItemsSource="{Binding ViewModel.Items, ElementName=wnd}" 
                      AutoGenerateColumns="False"
                      RowDetailsVisibilityMode="VisibleWhenSelected">
    <telerik:RadGridView.Columns>
        <telerik:GridViewDataColumn Header="Name" DataMemberBinding="{Binding Name}"  />
    </telerik:RadGridView.Columns>
    <telerik:RadGridView.RowDetailsTemplate>
        <DataTemplate>
            <StackPanel Orientation="Horizontal"
                        Margin="10,10,10,10">
                <TextBlock Text="This is my RowDetailsTemplate: " />
                <Button Command="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type Window}}, Path=ViewModel.SomeCommand}">SomeCommand</Button>
            </StackPanel>
        </DataTemplate>
    </telerik:RadGridView.RowDetailsTemplate>
</telerik:RadGridView>
</Window> 
```

后面的代码：

```
using System;
using System.Collections.ObjectModel;
using System.ComponentModel;
using System.Windows;
using Microsoft.Practices.Prism.Commands;

namespace Sample
{
public partial class MainWindow : Window
{
    public ViewModel ViewModel { get; set; }

    public MainWindow()
    {
        ViewModel = new ViewModel();
        ViewModel.PropertyChanged +=(o,e)=> 
        {
            if(e.PropertyName.Equals("Proof"))
            MessageBox.Show("Button Command Binding just worked!");
        };

        InitializeComponent();

    }
}

public class ViewModel : INotifyPropertyChanged
{
    private ObservableCollection<SomeClass> _items;
    private DelegateCommand _someCmd;
    private bool _proof;

    public ObservableCollection<SomeClass> Items
    {
        get
        {
            if (_items == null)
            {
                _items = new ObservableCollection<SomeClass>();
                for (int i = 0; i < 1000; i++)
                    _items.Add(new    SomeClass(string.Format("name {0}", i)));
            }

            return _items;
        }
    }
    public DelegateCommand SomeCommand
    {
        get
        {
            return _someCmd ?? (_someCmd = new DelegateCommand(() =>
                                                                {
                                                                    Console.WriteLine("Booya, binding works!");
                                                                    Proof = true;
                                                                }));
        }
    }

    public bool Proof
    {
        get { return _proof; }
        set
        {
            _proof = value;
            RaisePropertyChanged("Proof");
        }
    }

    private void RaisePropertyChanged(string propertyName)
    {
        if (PropertyChanged != null)
            PropertyChanged(this, new PropertyChangedEventArgs(propertyName));
    }

    public event PropertyChangedEventHandler PropertyChanged;
}

public class SomeClass : INotifyPropertyChanged
{
    private string _name;

    public SomeClass(string name) { _name = name;}

    public string Name
    {
        get { return _name; }
        set
        {
            if (_name == value)
                return;
            _name = value;
            RaisePropertyChanged("Name");
        }
    }

    private void RaisePropertyChanged(string propertyName)
    {
        if(PropertyChanged != null)
            PropertyChanged(this, new PropertyChangedEventArgs(propertyName));
    }

    public event PropertyChangedEventHandler PropertyChanged;
}
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-11T20:27:37.163

我不知道您控件的名称，但是这样的东西应该可以工作。基本上找到祖先类型，并挂钩绑定：

```
 <!--assuming the ViewModel is bound to your view-->
  <UserControl x:Name="YourView"
           xmlns:Views="clr-namespace:YourNameSpace.Views">

             ....
   <DataTemplate>
        <Button Command="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type Views:YourView}}, Path=OpenView1Command}" Open View 1</Button> 
    </DataTemplate> 
```

# java - 是否可以将相同的 BitmapDrawable 分配给多个对象？

> ID：10113004
> 
> 赞同：1
> 
> 时间：2012-04-11T19:57:39.900
> 
> 标签：java, android, bitmap

我创建了一个 BitmapDrawable，稍后我在这样的函数中分配给几个对象（不完全像这样，但为了测试目的，它被剥离了）：

```
Drawable CreateBitmap(int col)
{   Bitmap b = Bitmap.createBitmap(50, 50, Config.ARGB_8888);
    Canvas c = new Canvas(b);
    c.drawColor(col);
    return new BitmapDrawable(b);
} 
```

这有效并为我创建了一个大小为 50 x 50 的 BitmapDrawable，我保存在内存中。然后我将这个 BitmapDrawable 分配给各种按钮、复选框，无论出现什么并需要某种颜色。

我遇到的问题是 BitmapDrawables 以某种方式被截断。看来，如果我将它分配给一个高度为 80 的按钮，然后是一个高度为 160 的按钮，第一个被很好地填充，而后者只被填充了一半。看起来 BitmapDrawable 被设置为它的第一次使用，并且所有后续分配都受它的限制。有时它会立即发生，有时它仅在我切换到另一个选项卡并返回到前一个选项卡时才会发生。

我认为 BitmapDrawable 将在内存中保持 50x50，并且分配给它的对象要么获得具有适当大小的自己的版本（或在渲染时制作调整大小的副本），而不是它以某种方式更改 BitmapDrawable 本身。我承认，我不确定所有这些是如何深入工作的，如果我必须为我分配给它们的每个对象创建单独的 BitmapDrawables 或者我是否可以做其他事情，我将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T20:21:07.837

BitmapDrawable 是一个[Drawable](http://developer.android.com/reference/android/graphics/drawable/Drawable.html)对象，其中包含特定于对象*实例的*[setState](http://developer.android.com/reference/android/graphics/drawable/Drawable.html#setState%28int%5B%5D%29)等方法。所以，不，我不认为 BitmapDrawable 可以轻松共享。（您*可能*能够成功地重用它们，就像 ListView 为列表成员缓存视图一样；但是要求 BitmapDrawable 同时存在于两个或多个地方似乎要求太多了。）

 *** * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T15:51:38.707

你应该看看 BitmapDrawable.mutate()。它将创建drawables常量状态的副本，但仍会在drawables之间共享undelying位图。

```
ImageView imgView1 = findByViewId(R.id.my_image_view_1);
ImageView imgView2 = findByViewId(R.id.my_image_view_2);

BitmapDrawable image = new BitmapDrawable("/path/to/my/bitmap");

imgView1.setImageDrawable(image);
imgView2.setImageDrawable(image.mutate()); 
```

这应该为您提供 2 个不同的状态，而无需复制位图。

这里有一篇很好的文章： [http ://www.curious-creature.org/2009/05/02/drawable-mutations/](http://www.curious-creature.org/2009/05/02/drawable-mutations/)**

# knockout.js - 在 Knockout.JS 中更新视图模型后调用视图函数

> ID：10113006
> 
> 赞同：2
> 
> 时间：2012-04-11T19:57:47.080
> 
> 标签：knockout.js

我使用出色的 Cycle.js 插件创建了一个简单的内容旋转器，它从我的 Knockout.JS 视图模型属性（在本例中为 appViewModel.mediaPlayer）获取它的内容：

例如

```
 var testData = [{ url: "media/1.png" }, { url: "media/2.jpg"}];

    var appViewModel =
    {
        mediaPlayer: new ko.observableArray(testData)
    };

    ko.applyBindings(appViewModel); 
```

这是使用 JQuery Tmpl 在视图中呈现的，例如

```
 <script id="mediaPlayerTemplate" type="text/template">
        <img src=${url} />
    </script>

<div class="adContainer" data-bind="template: {name: 'mediaPlayerTemplate', foreach: mediaPlayer}">
    </div> 
```

要开始图像转换，我只需调用 Cycle 插件方法“cycle”：

```
 $('.adContainer').cycle({
            fx: 'fade',
            timeout: 1000,
            speed: 500
        }); 
```

这很好用，但是当我更新我的视图模型媒体播放器内容时，循环插件停止工作......这不是问题，因为对循环（）的简单调用将再次启动它。

但是，我的问题是，调用 cycle() 以更新视图的最佳位置在哪里？我想我可以订阅 mediaPlayer 更改，只需在需要时调用该方法，但这意味着我必须将 JQuery 元素/视图逻辑放在感觉错误的视图模型中（也许我试图过于纯粹！） .

简而言之，如何在视图模型不知道视图函数的情况下从视图模型触发视图中的函数？在 Silverlight/WPF 中，这可以通过 XAML 中的触发器实现，但我不确定如何使用 Knockout.JS 实现相同的分离

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-11T21:51:30.360

我认为最好使用绑定处理程序来执行此操作，这也将允许您在重新呈现内容时正确处理插件。

您的示例（它将在 5 秒后更改周期）：

[http://jsfiddle.net/nickolsky/uXDUA/2/](http://jsfiddle.net/nickolsky/uXDUA/2/)

**HTML：**

```
<script id="mediaPlayerTemplate" type="text/template">
        <img src=${url} />
    </script>

<div data-bind="template: {name: 'mediaPlayerTemplate', foreach: mediaPlayer}, cycle: { fx: 'fade', timeout: 1000, speed: 500 }, cycleLinked: mediaPlayer">
    </div> 
```

​</p>

**JAVASCRIPT：**

```
ko.bindingHandlers.cycle = {
    init: function (element, valueAccessor, allBindingsAccessor, viewModel) {
        $element = $(element);
        var options = ko.utils.unwrapObservable(valueAccessor()) || {};
        //console.log('cycle_init');
        var _starting = false;

        var _cycle = function() {
            if(_starting) return;
            _starting = true;
            //console.log('cycle_create');
            $element.hide();
            setTimeout(function() { $(element).cycle(options); $element.show(); _starting = false; }, 0);
        };

        var subscription = allBindingsAccessor().cycleLinked.subscribe(_cycle);
        //handle disposal
        ko.utils.domNodeDisposal.addDisposeCallback(element, function () {
            //console.log('cycle_destroy');
            $element.cycle("destroy");
            subscription.dispose();
        });
        _cycle();

    }
};

var testData = [{
    url: "http://cloud.github.com/downloads/malsup/cycle/beach1.jpg"},
{
    url: "http://cloud.github.com/downloads/malsup/cycle/beach2.jpg"}];

var appViewModel = {
    mediaPlayer: new ko.observableArray(testData)
};

ko.applyBindings(appViewModel);

setTimeout(function() {
 appViewModel.mediaPlayer.push({url: "http://cloud.github.com/downloads/malsup/cycle/beach3.jpg"});
appViewModel.mediaPlayer.push({url: "http://cloud.github.com/downloads/malsup/cycle/beach4.jpg"});
    }, 5000);​ 
```

# php - 带有空白用户名和密码的 ldap_bind() 问题

> ID：10113008
> 
> 赞同：0
> 
> 时间：2012-04-11T19:57:55.720
> 
> 标签：php

首先启用 LDAP_bind 匿名。我遇到的问题如下：

这段代码可以正常工作，没有问题：

```
<?php
$ldaprdn  = 'uname';   
$ldappass = 'password';  

$ldapconn = ldap_connect("ldap.example.com")
    or die("Could not connect to LDAP server.");

if ($ldapconn) {
    // binding to ldap server
    $ldapbind = ldap_bind($ldapconn, $ldaprdn, $ldappass);

    if ($ldapbind) {
        echo "LDAP bind successful...";
    } else {
        echo "LDAP bind failed...";
    }
}
?> 
```

无论如何，下面的这个都会返回“成功”

```
 <?php
    $ldaprdn  = '';   
    $ldappass = '';  

    $ldapconn = ldap_connect("ldap.example.com")
        or die("Could not connect to LDAP server.");

    if ($ldapconn) {
        // binding to ldap server
        $ldapbind = ldap_bind($ldapconn, $ldaprdn, $ldappass);

        if ($ldapbind) {
            echo "LDAP bind successful...";
        } else {
            echo "LDAP bind failed...";
        }
    }
    ?> 
```

请注意，此版本中的凭据留空。我不喜欢这样一个事实，即如果将凭据留空，这件事就会让你进去。我做错了什么吗？或者只是这个 ldap_bind() 很复杂。我认为如果我用三个参数调用函数，它不应该默认为匿名。

我可以通过将用户名和密码设置为虚拟值来解决这个问题，以防用户名和密码留空，但这根本不是一个好习惯。请帮忙...

来源：http://php.net/manual/en/function.ldap-bind.php

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T00:29:38.363

您是否正在为 Web 应用程序进行 LDAP 身份验证？如果是这样，这就是你需要做的：

1.  使用特权绑定，使用搜索过滤器中提供的用户名获取用户的 DN（或 UPN，如果使用 Active Directory）。*
2.  如果失败，则用户名不正确，并让用户知道用户名/密码不正确。
3.  如果成功，请获取 DN 并使用该 DN 和提供的密码再次绑定。
4.  现在，这应该成功或失败。

换句话说，不要只使用传入的用户名并尝试使用它进行绑定。

* 如果您提供有关您尝试做什么以及您使用的 LDAP 服务器的更多详细信息，我可以提供更详细的答案。

# vim - vim 用更多文本子替换表达式

> ID：10113009
> 
> 赞同：4
> 
> 时间：2012-04-11T19:57:56.087
> 
> 标签：vim

所以我正在寻找一种方法来采取这样的事情

```
Two words
Three Words Here 
```

并用这个替换它

```
Twowords = myHash["Two words"];
ThreeWordsHere = myHash["Three Words Here"]; 
```

我发现了这个问题，这导致我使用 sub-replace 命令，然后我遇到了这样的事情。

```
%s/\(\([A-z ]\)\+\)/\=substitute(submatch(1), ' ', '', 'g')/ 
```

现在这将得到没有空格的匹配出现，但等号后将没有任何内容。在替换表达式之后添加文本会导致“E51：无效表达式”错误。

我的问题是：有没有办法结束表达式，并向 :s 命令添加更多文本？像这样的东西。

```
%s/\(\([A-z ]\)\+\)/\=substitute(submatch(1), ' ', '', 'g') = myHash["\1"];/ 
```

我找不到任何东西。我查看了 :help sub-replace-\= 和其他在线资源。谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-11T20:38:01.353

你几乎拥有它。

原子之后的所有内容都`\=`必须是表达式，因此您需要将字符串连接在一起并`submatch()`再次使用。使用您已经提供的正则表达式：

```
:%s/\(\([A-z ]\)\+\)/\=substitute(submatch(1), ' ', '', 'g') . ' = myHash["' . submatch(1) . '"];'/ 
```

# wix - 从 Wix 中的 MULTI_SZ 注册表项中读取一行

> ID：10113016
> 
> 赞同：2
> 
> 时间：2012-04-11T19:58:09.017
> 
> 标签：wix, wix3.5

我正在尝试从注册表中读取共享的本地路径，并使用 Wix 将其用于我的安装。我可以从这个注册表键 SYSTEM\CurrentControlSet\Services\LanmanServer\Shares 中找到有关共享的信息，但路径是这个多字符串键中的值之一。您能否让我知道是否可以使用 Wix 从密钥中解析此路径信息，或者是否可以通过更好的方式在 Wix 中获取共享的本地路径而不是从注册表中读取它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-12T06:35:17.767

[除了创作RegistrySearch](http://wix.sourceforge.net/manual-wix3/wix_xsd_registrysearch.htm)元素（指定`raw`为`Type`属性值）并在自定义操作中解析它之外，我认为您没有任何其他选择。

# visual-studio - 在 CMake 中设置 MSVC 运行时

> ID：10113017
> 
> 赞同：46
> 
> 时间：2012-04-11T19:58:17.257
> 
> 标签：visual-studio, cmake

我正在按照 CMake 常见问题解答条目[“如何使用静态运行时构建我的 MSVC 应用程序？”中的说明进行操作。](http://www.cmake.org/Wiki/CMake_FAQ#How_can_I_build_my_MSVC_application_with_a_static_runtime.3F)为一堆嵌套的 CMake 项目集中选择 MSVC 运行时（它们作为 Git 子模块被拉入并使用 CMake 的`find_package()`指令添加到主项目中）。

所以，我写了这个 CMake 宏：

```
macro(configure_msvc_runtime)
  if(MSVC)

    # Default to statically-linked runtime.
    if("${MSVC_RUNTIME}" STREQUAL "")
      set(MSVC_RUNTIME "static")
    endif()

    # Set compiler options.
    set(variables
      CMAKE_C_FLAGS_DEBUG
      CMAKE_C_FLAGS_MINSIZEREL
      CMAKE_C_FLAGS_RELEASE
      CMAKE_C_FLAGS_RELWITHDEBINFO
      CMAKE_CXX_FLAGS_DEBUG
      CMAKE_CXX_FLAGS_MINSIZEREL
      CMAKE_CXX_FLAGS_RELEASE
      CMAKE_CXX_FLAGS_RELWITHDEBINFO
    )
    if(${MSVC_RUNTIME} STREQUAL "static")
      message(STATUS
        "MSVC -> forcing use of statically-linked runtime."
      )
      foreach(variable ${variables})
        if(${variable} MATCHES "/MD")
          string(REGEX REPLACE "/MD" "/MT" ${variable} "${${variable}}")
        endif()
      endforeach()
    else()
      message(STATUS
        "MSVC -> forcing use of dynamically-linked runtime."
      )
      foreach(variable ${variables})
        if(${variable} MATCHES "/MT")
          string(REGEX REPLACE "/MT" "/MD" ${variable} "${${variable}}")
        endif()
      endforeach()
    endif()
  endif()
endmacro() 
```

我在根目录的开头`CMakeLists.txt`（在进行*任何* `add_library()`or`add_executable()`调用之前）调用此宏，并添加一些调试打印：

```
configure_msvc_runtime()
set(variables
  CMAKE_C_FLAGS_DEBUG
  CMAKE_C_FLAGS_MINSIZEREL
  CMAKE_C_FLAGS_RELEASE
  CMAKE_C_FLAGS_RELWITHDEBINFO
  CMAKE_CXX_FLAGS_DEBUG
  CMAKE_CXX_FLAGS_MINSIZEREL
  CMAKE_CXX_FLAGS_RELEASE
  CMAKE_CXX_FLAGS_RELWITHDEBINFO
)
message(STATUS "Initial build flags:")
foreach(variable ${variables})
  message(STATUS "  '${variable}': ${${variable}}")
endforeach()
message(STATUS "") 
```

然后，我运行 CMake 来生成一个 Visual Studio 解决方案，如下所示：

```
cmake -G "Visual Studio 9 2008" ..\.. -DMSVC_RUNTIME=dynamic 
```

我得到以下输出：

```
-- MSVC -> forcing use of dynamically-linked runtime.
-- Initial build flags:
--   'CMAKE_C_FLAGS_DEBUG': /D_DEBUG /MDd /Zi  /Ob0 /Od /RTC1
--   'CMAKE_C_FLAGS_MINSIZEREL': /MD /O1 /Ob1 /D NDEBUG
--   'CMAKE_C_FLAGS_RELEASE': /MD /O2 /Ob2 /D NDEBUG
--   'CMAKE_C_FLAGS_RELWITHDEBINFO': /MD /Zi /O2 /Ob1 /D NDEBUG
--   'CMAKE_CXX_FLAGS_DEBUG': /D_DEBUG /MDd /Zi /Ob0 /Od /RTC1
--   'CMAKE_CXX_FLAGS_MINSIZEREL': /MD /O1 /Ob1 /D NDEBUG
--   'CMAKE_CXX_FLAGS_RELEASE': /MD /O2 /Ob2 /D NDEBUG
--   'CMAKE_CXX_FLAGS_RELWITHDEBINFO': /MD /Zi /O2 /Ob1 /D NDEBUG 
```

现在，问题是当我启动 Visual Studio 并检查“C/C++，代码生成”下的项目属性时，我发现“运行时库”设置与 shell 中打印的选项不一致。在“Release”、“MinSizeRel”和“RelWithDebInfo”配置下，我得到了预期的结果（“Multi-threaded DLL /MD”，但“Debug”配置仍然显示“Multi-threaded /MT”）。

此外，当我强制使用静态链接运行时，我得到类似的结果。如果我跑

```
cmake -G "Visual Studio 9 2008" ..\.. -DMSVC_RUNTIME=static 
```

我得到以下输出：

```
-- MSVC -> forcing use of statically-linked runtime.
-- Initial build flags:
--   'CMAKE_C_FLAGS_DEBUG': /D_DEBUG /MTd /Zi  /Ob0 /Od /RTC1
--   'CMAKE_C_FLAGS_MINSIZEREL': /MT /O1 /Ob1 /D NDEBUG
--   'CMAKE_C_FLAGS_RELEASE': /MT /O2 /Ob2 /D NDEBUG
--   'CMAKE_C_FLAGS_RELWITHDEBINFO': /MT /Zi /O2 /Ob1 /D NDEBUG
--   'CMAKE_CXX_FLAGS_DEBUG': /D_DEBUG /MTd /Zi /Ob0 /Od /RTC1
--   'CMAKE_CXX_FLAGS_MINSIZEREL': /MT /O1 /Ob1 /D NDEBUG
--   'CMAKE_CXX_FLAGS_RELEASE': /MT /O2 /Ob2 /D NDEBUG
--   'CMAKE_CXX_FLAGS_RELWITHDEBINFO': /MT /Zi /O2 /Ob1 /D NDEBUG 
```

然而，所有配置都会为“运行时库”设置生成“多线程/MT”值。

我做错了什么，或者这是 CMake (2.8.7) 中的错误还是什么？

* * *

对于它的价值，如果我生成 Visual Studio 2010 项目文件，我会为“调试”配置获得不同的值，但仍然不是我选择的那个。

在所有情况下，“调试”配置的设置以常规字体显示，而其他配置以粗体显示，暗示这些是覆盖。此外，如果我打开 XML 项目文件，我发现“Debug”配置没有设置“Tool”元素的“RuntimeLibrary”属性，“Name=VCCLCompilerTool”属性。所有其他配置都有明确的设置。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-12T04:37:44.263

似乎我一直在努力，我忘记删除我试图替换的错误 CMake 配置。

在构建脚本的下方，我留下了这个小虫子：

```
set(CMAKE_CXX_FLAGS_DEBUG
  "/DWIN32 /D_WINDOWS /EHsc /WX /wd4355 /wd4251 /wd4250 /wd4996"
  CACHE STRING "Debug compiler flags" FORCE
) 
```

`configure_msvc_runtime()`基本上，我使用未设置 MSVC 运行时的构建标志覆盖了 by 宏的结果。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2019-06-26T15:18:56.693

此功能将随着 cmake-3.15 的发布而得到改进。

*   [`CMAKE_MSVC_RUNTIME_LIBRARY`](https://cmake.org/cmake/help/latest/variable/CMAKE_MSVC_RUNTIME_LIBRARY.html#variable:CMAKE_MSVC_RUNTIME_LIBRARY)
*   [`CMP0091`](https://cmake.org/cmake/help/latest/policy/CMP0091.html)

应该是设置的问题`CMAKE_MSVC_RUNTIME_LIBRARY`，例如（来自文档）设置“多线程静态链接的运行时库，根据配置有或没有调试信息”：

```
set(CMAKE_MSVC_RUNTIME_LIBRARY "MultiThreaded$<$<CONFIG:Debug>:Debug>") 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2016-02-10T23:54:44.620

我采用了您的代码并将其概括为适用于每个现有配置，而不仅仅是适用于 Debug/Release/RelWithDebInfo/MinSizeRel。

我也让它与 gcc 一起工作 - 在[这里查看](https://github.com/onqtam/ucm#ucm_set_runtime)

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2020-05-04T23:27:32.630

这是我想出的一个解决方案，它应该适用于 3.15 之前和之后的 CMake 版本。

```
# This logic needs to be considered before project()
set(_change_MSVC_flags FALSE)
if(WIN32)
  if(CMAKE_VERSION VERSION_LESS 3.15.0)
    set(_change_MSVC_flags TRUE)
  else()
    # Set MSVC runtime to MultiThreaded (/MT)
    cmake_policy(SET CMP0091 NEW)
    set(CMAKE_MSVC_RUNTIME_LIBRARY "MultiThreaded$<$<CONFIG:Debug>:Debug>")
  endif()
endif()

project(MyProj ....)

if(_change_MSVC_flags)
  # Modify compile flags to change MSVC runtime from /MD to /MT
  set(_re_match "([\\/\\-]M)D")
  set(_re_replace "\\1T")
  string(REGEX REPLACE ${_re_match} ${_re_replace}
    CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS}")
  string(REGEX REPLACE ${_re_match} ${_re_replace}
    CMAKE_CXX_FLAGS_DEBUG "${CMAKE_CXX_FLAGS_DEBUG}")
  string(REGEX REPLACE ${_re_match} ${_re_replace}
    CMAKE_CXX_FLAGS_RELEASE "${CMAKE_CXX_FLAGS_RELEASE}")
  string(REGEX REPLACE ${_re_match} ${_re_replace}
    CMAKE_CXX_FLAGS_MINSIZEREL "${CMAKE_CXX_FLAGS_MINSIZEREL}")
  string(REGEX REPLACE ${_re_match} ${_re_replace}
    CMAKE_CXX_FLAGS_RELWITHDEBINFO "${CMAKE_CXX_FLAGS_RELWITHDEBINFO}")
endif() 
```

如果使用其他语言（即`C`），那么也需要添加这些语言。

# sql - 使用左外连接时即使记录不存在也返回行

> ID：10113021
> 
> 赞同：2
> 
> 时间：2012-04-11T19:58:27.903
> 
> 标签：sql

我正在尝试从`RepDailyInfo`表中获取 Dates`RepDailyCollection.IsReceived = 0`以及何时`RepDailyCollection`确实有该特定的记录`RepDailyInfoID`。这在 sql server 2005 中可能吗？

```
Select distinct RepDailyInfo.Date 
from RepDailyInfo 
left outer join RepDailyCollection c 
    on c.RepDailyInfoID = RepDailyInfo.RepDailyInfoID
where c.IsReceived = 0 
    or c.IsReceived = null 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T20:01:00.810

将条件移动到`ON`连接的子句中，否则您需要连接来为`WHERE`子句中要引用的行找到一行：

```
Select distinct RepDailyInfo.Date 
from RepDailyInfo 
left outer join RepDailyCollection c 
    on c.RepDailyInfoID = RepDailyInfo.RepDailyInfoID
    and (c.IsReceived = 0 or c.IsReceived is null) 
```

还要注意`or`在 SQL 中需要使用括号，因为“或”优先于“和”，如果没有括号，您最终会得到“（A 和 B）或 C”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T20:00:35.240

你可能想做

```
where IsNull(c.IsReceived,0) = 0 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-11T20:00:41.030

是的，但是您必须在 join 本身中过滤 join 的右侧：

```
Select distinct RepDailyInfo.Date 
from RepDailyInfo 
left outer join RepDailyCollection c 
    on c.RepDailyInfoID = RepDailyInfo.RepDailyInfoID
   and (c.IsReceived = 0 
    or c.IsReceived is null) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-11T20:00:43.707

该`WHERE`子句在`OUTER JOIN`. 如果您不想要这种行为，请将`WHERE`子句移到 的`ON`子句中`JOIN`，如下所示：

```
select distinct r.date
from RepDailyInfo r
left outer join RepDailyCollection c on c.RepDailyInfoID = r.RepDailyInfoID
    and isnull(c.IsReceived, 0) = 0 
```

# c - 我应该如何开始用 C 或 C++ 编写 FCFS 调度程序？

> ID：10113028
> 
> 赞同：0
> 
> 时间：2012-04-11T19:59:31.013
> 
> 标签：c, algorithm, scheduling, simulator

我被困在我目前的任务上，主要是因为我在很长一段时间没有使用 C 之后对 C 不是很精通。

我们需要制作一个 FCFS（先到先服务）调度算法模拟器，它可以简单地遍历每个流程将发生的所有时间事件，并在它们完成流程和周转时间时打印出来。

我知道这个过程是如何工作的，但是将它实现到 C 或 C++ 程序中让我很困惑，我什至不知道从哪里开始。

我们将从标准输入获取输入，格式如下：

第一行：（# of cpus）（# of processes）（量子大小）

进程行：（ID）（优先级）（提交时间）（所需cpu时间）（需要I/O之前的计算时间）（每次计算的I/O时间）

根据从第一行定义的流程数量，需要更多流程线。

示例输入可能是：

1 1 10

1 1 0 20 5 50

长话短说，任何人都可以向我指出一些可以提供帮助的资源或示例源，其中包括多个 CPU 的可能性。或者，如果你们甚至可以帮助我入门，我将非常感激。我不是要你做整个事情，只是帮助我开始，这样我就会知道从那里去哪里。

谢谢！

编辑：

这是我到目前为止所得到的。这是非常初级的，但到目前为止我只是想完成这件事，就像我说的，我对 C 非常生疏（反正我不是精通它）：

```
int main()
{
    //process *  proc = (process *)malloc(100*sizeof(process));
    process proc[25];
    CPU cp[4];
    int count = 0;
    //int * input = malloc(sizeof(int) * 100);
    int input = 0;
    int cpus = 0;
    int processes = 0;
    int quantum = 0;
    int processLoop = 0;
    int x = 0;

    int id = 0;
    int pri = 0;
    int sub = 0;
    int cptime = 0;
    int compute = 0;
    int itime = 0;
    int complete = 0;

    while(1 == scanf("%d", &input))
    {
            if(count < 0)
                    break;
            if(count == 0)
            {
                    cpus = input;
            }
            else if(count == 1)
            {
                    processes = input;
            }
            else if(count == 2)
            {
                    quantum = input;
            }
            else
            {
                    if(count == 3)
                    {
                            proc[processLoop].ID = input;
                    }
                    else if(count == 4)
                    {
                            proc[processLoop].Priority = input;
                    }
                    else if(count == 5)
                    {
                            proc[processLoop].subTime = input;
                    }
                    else if(count == 6)
                    {
                            proc[processLoop].cpuTime = input;
                    }
                    else if(count == 7)
                    {
                            proc[processLoop].computeTime = input;
                    }
                    else if(count == 8)
                    {
                            proc[processLoop].ioTime = input;
                            proc[processLoop].isCompleted = 0;
                            processLoop++;
                            if(processLoop == processes)
                            {
                                    count = -1;         //Leaves possibility for multiple simulations in one run
                            }
                            else
                            {
                                    count = 2;          //Repeats if multiple processes are detected
                            }
                    }
            }
            count++;

    }

    for(x = 0; x < cpus; x++)
    {
            cpu[x].idle = 0;
    }

    return 0;
} 
```

是的，超级原始且效率不高，但它读取所有数字并以 EOF 或任何非数字出现时结束。也是负数。我将 proc 设置为 25 个数组的原因是因为这是我们的教练所说的数量也会增加的限制。对于 CPU，他说最多将使用四个，所以我只是做了一个数组，主要是因为我对指针很糟糕。

现在我已经将数据放入了我的数组中，我需要按 subTime 对我的 proc 数组进行排序并开始进行实际计算。这部分会有多糟糕，尤其是在我糟糕的设置下？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-12T05:06:09.213

为您实现目标的行动计划：

1.  为进程和 CPU 定义数据结构
2.  扫描所有输入。初始化所有数据结构。
3.  为单 CPU 开发代码。验证它是否正常工作
4.  修改多 CPU 的代码。验证它是否有效

**步骤1：**

为 Process 定义数据结构。对于 C，您可以像这样使用结构：（对于 C++ 使用类）

```
typedef struct process
 {
       int ID;
       int Priority;
       int time_of_submission;
       int cpu_time_required;
       int compute_time_before_IO;
       int IO_time_per_compute;
       int isCompleted; // if 1 means its complete. at start, its value is 0
 }process; 
```

对于 CPU，维护一个数组，它可以告诉你它的空闲或分配了一些进程。

```
typedef struct CPU
 {
       int idle;     // if set to 1, then its idle. 
                     // If set to 0, then its working on a process
       process *next; // points to the process that CPU is executing
                      // points to null if CPU is idle.
 }CPU; 
```

**第2步：**

[使用scanf](http://www.java-samples.com/showtutorial.php?tutorialid=564)扫描所有输入，`process`为所有输入进程填充 ' ' 数组。为了使您的工作更轻松，请`process`根据根据 FCFS 决定调度的字段对 ' ' 数组进行排序。（例如 time_of_submission、所需的 cpu 时间、优先级.. 我将其留给您用于其他领域）

初始化' `CPU`'的数组。

**第三步：** 开发单CPU代码。验证它是否正常工作。

我认为您对多 CPU 方案有疑问。所以暂时不要考虑多 CPU 的概念。在纸上写下单 CPU 的逻辑。创建伪代码。然后从中创建一个 C（或 C++）代码。每当卡在语法上时，请在谷歌上搜索如何做到这一点并继续前进。

**第四步：** 修改多CPU的代码。验证它是否有效

想想多 CPU 会发生什么。

```
Loop over all CPUs. 
    For CPU[i], check its status 

    if its idle
         assign it a process..similar logic as for single CPU case (step 3)
    if its not idle
         if its corresponding process is finished, set status of CPU to idle. 
```

在这里完成后，您可以对其进行修改以具有要考虑的进程的优先级。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-03-12T15:42:34.547

```
#include <iostream>
using namespace std;
//fcfs algorithm in c++

//Here is the simple example involving 3 process;
//All process are assumed to be arrived at same time=0 seconds

int main()
{
    //arrival time of each proces=0;
    //all arive at same time
    //arrival time is assumed to be same
    int process[10]={1,2,3};
    int bt[10]={10,5,8};
    int wt[10];
    int tt[10];
    wt[0]=0;
    //waiting time of each process;

    for(int i=1;i<3;i++){
        wt[i]=bt[i-1]+wt[i-1];

    }
    //turnaround time calculation for each processs
    for(int i=0;i<3;i++){
        tt[i]=wt[i]+bt[i];

    }
    float awt=0;//average waiting time
    float att=0;//average turnaround time;
    for(int i=0;i<3;i++){
        awt=awt+wt[i];
        att=att+tt[i];

    }
    for(int i=0;i<3;i++){
        cout<<"process"<<i+1<<"--->"<<" "<<bt[i]<<" "<<wt[i]<<" "<<tt[i]<<endl;

    }
    cout<<"Awerage waiting time"<<awt/3<<endl;
    cout<<"average turnaround time"<<att/3<<endl;

} 
```

# php - PHP XHTML 严格形式不起作用

> ID：10113041
> 
> 赞同：1
> 
> 时间：2012-04-11T20:00:08.877
> 
> 标签：php, forms, xhtml, xhtml-1.0-strict

我已经尝试了很长时间来弄清楚为什么这个表格不起作用。如果您不输入任何内容，它甚至不会显示错误消息。

我希望这里有人能指出问题所在。

该表单经过 XHTML Strict 验证。

```
<?php

$err = array();

if (isset($_POST['submit'])) {

/* Do the validation */
$uploader_name = $_POST['uploader_name'];
$uploader_mail = $_POST['uploader_mail'];

if (empty($uploader_name)) {
$err[] = "Name is empty.";
}

if (empty($uploader_mail)) {
$err[] = "Mail is empty.";
}

/* If everything is ok, proceed */
if (empty($err)) {

//Do MySQL insert

}

}

echo "<h1>Submit</h1>";

if(!empty($err)) {
echo "<span style='color:red;'>";
foreach ($err as $e) {echo "* $e<br />"; }
echo "</span><br />";
}

echo "
<div>
<form action='' method='post' enctype='text/plain'>
<fieldset>
<legend>Your details</legend>
<label for='uploader_name'>Your name / nickname</label><br />
<input type='text' id='uploader_name' value='$uploader_name' /><br /><br />

<label for='uploader_mail'>Your mail (will not be visible)</label><br />
<input type='text' id='uploader_mail' value='$uploader_mail' /><br /><br />
</fieldset>

<p><input type='submit' id='submit' value='Submit' /></p>
</form>
</div>
";

?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T20:02:23.260

`name`使用atr将字段发送到服务器，而不是`id`. 添加（或替换）带有名称的 id，例如：

```
<input type='submit' name='submit' value='Submit' /> 
```

会产生`$_POST['submit'] == 'Submit'`

UPD：添加，而不是替换。值通过 发送`name`，但另一方面`<label />`'s 使用 's 与表单元素连接`id`。

UPD2：并`enctype`从`<form>`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T20:06:52.430

我建议不要使用`empty`，但是[`isset`](http://php.net/isset)。Empty 接受很多东西是空的。你的支票应该是这样的：

```
if (isset($_POST['foo']) || $_POST['foo'] !== '') {
    $errors[] = 'You need to fill in the foo input';
} 
```

* * *

其他一些提示：

*   在 PHP 中使用单引号，在 HTML 中使用双引号
*   使用连接运算符将引号排除在字符串之外

一个例子：

```
<?php
if (isset($_POST['form_send'])) {
    /* all validation stuff */
}
?>
<form action="post">
  <!-- ... -->
  <input type="text" value="<?php echo $uploader_mail ?>"><br />
  <!-- ... -->
</form> 
```

或者

```
<?php
$name = 'World';
// not...
$hello = "Hello World";
// ...but
$hello = 'Hello '.$name; 
```

* * *

至少，回答你的问题。PHP 寻找`name`属性，而不是`id`属性。

# matlab - `char` 变量的下标赋值维度不匹配错误

> ID：10113042
> 
> 赞同：1
> 
> 时间：2012-04-11T20:00:22.557
> 
> 标签：matlab, char, store, dimension

`??? Subscripted assignment dimension mismatch.`我收到值何时`days`达到的错误，`13`因为第 7 行的 legend_vec 列大小可能达到 13。

```
days = [1     2     3     4     5     6    13];
for i=1:nTime
    legend_vec(i,:)=(['After ',num2str(days(i)),' days']);
end 
```

我怎样才能避免错误并在我存储时存储所有天`legend_vec`？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T20:11:11.790

当您尝试将复合字符串存储到数组中时，它会将其存储为 Ascii 或 Unicode 字符编号的列表。因此，如果我尝试将字符串 'Hello world' 作为数组的第一行插入，那么第一行实际上将是：

```
>>> my_strs = []; 
>>> my_strs(1,:) = "Hello world"
my_strs =

72   101   108   108   111    32   119   111   114   108   100 
```

请注意，这隐含地构成`my_strs`了一个 1×11 数组。如果我尝试添加一个字符串作为第二行，但它没有评估为具有 11 个字符的长度代码，它将给出一个错误：

```
>>> my_strs(2,:) = "Hi there"
error: A(I,J,...) = X: dimensions mismatch 
```

所以你要么需要添加空格来填充你所有天的长度，当它们变成字符串（所以你所有的字符串都有统一的长度），或者做一些更方便的事情，比如将所有字符串存储到一个单元格数组中，它们可以有不同的长度.

要使用元胞数组执行此操作，您可以执行以下操作：

```
>>> my_strs = {};
>>> my_strs{1} = "Hello world"
my_strs =

{
  [1,1] = Hello world
}

>>> my_strs{2} = "Hi there"
my_strs =

{
  [1,1] = Hello world
  [1,2] = Hi there
}

>>> my_strs{1,1}
ans = Hello world
>>> my_strs{1,2}
ans = Hi there 
```

将其映射到您在上述问题中显示的循环中使用的索引约定应该很简单。

**完全披露：**我正在使用 Octave 测试上述代码，因为我个人更喜欢抵制 Matlab。如果您关心为什么会这样，您可以询问元数据或其他内容，但就这个问题而言，我认为 Octave 中的测试不会对正确答案产生任何影响。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-11T20:22:45.933

使用字符串元胞数组。元胞数组（由`{}`字符定义）用于处理不同对象的数组，例如不同的数据类型或不同长度的字符串。

要使用元胞数组，请按如下方式更改代码：

```
days = [1     2     3     4     5     6    13];
for i=1:length(days)
    legend_cell{i,:}=(['After ',num2str(days(i)),' days']);
end 
```

由于这是一种常见用途，因此该`legend`命令可以接受它作为输入。

```
plot(randn(10,7),'.')
legend(legend_cell) 
```

对于其他用途，您可以使用以下符号访问单个字符串：

```
thirdString = legend{3}; 
```

或者，如果您绝对必须有一个矩形字符数组，Matlab 支持以下约定，让您回到开始的位置：

```
legend_vec_in_chararray = char(legend_cell); 
```

该`char`函数将根据需要填充空格以创建矩形数组。

# ruby - 多行字符串格式

> ID：10113043
> 
> 赞同：3
> 
> 时间：2012-04-11T20:00:24.033
> 
> 标签：ruby

尝试在 Ruby 中格式化多行字符串

`heredoc`并且`%q{ }`存在它们包含用于格式化代码的空格的问题。

```
s = %q{Foo
         Bar
         Baz}
puts s 
```

错误地输出以下内容：

```
Foo
          Bar
          Baz 
```

以下作品，但对人物来说有点难看`\`。

```
s = "Foo\n" \
    "  Bar\n" \
    "  Baz"
puts s 
```

以下适用于python：

```
s = ("Foo\n"
     "  Bar\n"
     "  Baz")
print s 
```

Ruby中是否有等价物？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-11T20:32:40.617

建造得很好，但比我想的要危险得多

```
s = %w{ Foo
        Bar
        Baz}

puts s

=> 
Foo
Bar
Baz 
```

如果你想保留第一行的缩进，这个肯定是设计内置的

```
s   = <<-END
        Foo
          Bar
          Baz
      END
puts s

=>
        Foo
          Bar
          Baz 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-11T21:13:19.107

你总是可以做这样的事情：

```
s = ["Foo",
     "  Bar",
     "  Baz"].join("\n")
puts s
=>
Foo
  Bar
  Baz 
```

这样，您可以使用引号来明确区分字符串的开头和结尾，并且缩进空格不会与字符串混淆。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-12T04:25:40.620

[我从The Ruby Way](https://rads.stackoverflow.com/amzn/click/com/0672328844)偷来的一个技巧：

```
class String
  def heredoc(prefix='|')
    gsub /^\s*#{Regexp.quote(prefix)}/m, ''
  end
end

s = <<-END.heredoc
    |Foo
    |  Bar
    |  Baz
    END 
```

# c# - 数字的正则表达式？

> ID：10113044
> 
> 赞同：-6
> 
> 时间：2012-04-11T20:00:32.060
> 
> 标签：c#, regex

我需要一些帮助来找到适合我需要的正则表达式，我想要的是输入可能是任何字符串，正则表达式找到任何和所有整数值并返回它们，比如说

```
string s1 = "This is some string"
string s2 = " this is 2 string"
string s3 = " this is 03 string"
string s4 = "4 this is the 4th string"
string s5 = "some random string: sakdflajdf;la  989230"
string s6 = "3494309 !@# 234234" 
```

现在我想要的是正则表达式返回，

```
for s1 = return null (// nothing)
s2 = return 2
s3 = return 0 and 3 (// may separately as 0 and 3 or together as 03 doesn't matter)
s4 = return 4 and 4 (// it has 4 2 times right?)
s5 = 989230 (// may together as this or separately as 9 8 9 2 3 0 again is unimportant, but what's important is that it should return all integer values)
s6 = 3494309 and 234234 (// again may they be together as this or like this 3 4 9 4 3 0 9 and 2 3 4 2 3 4 that is unimportant, all that is imp is that it should return all integers) 
```

我已经尝试过`[0-9]`和`\d`，`^.*[0-9]+.*$`但它们似乎都不起作用。有人可以帮忙吗？

ps：请参阅[使用正则表达式重命名文件中的更新问题](https://stackoverflow.com/questions/10117237/rename-file-using-regular-expression)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-11T20:02:21.200

连续匹配一个或多个数字的正则表达式是：

```
\d+ 
```

你可以这样应用它：

```
Regex.Matches(myString, @"\d+") 
```

这将返回一个[`MatchCollection`](http://msdn.microsoft.com/en-us/library/system.text.regularexpressions.matchcollection.aspx)对象集合。这将包含匹配的值。

你可以像这样使用它：

```
var matches = Regex.Matches(myString, @"\d+");

if (matches.Count == 0)
  return null;

var nums = new List<int>();
foreach(var match in matches)
{
  nums.Add(int.Parse(match.Value));
}

return nums; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-11T20:03:42.100

我知道这看起来有点容易，但我认为`\d`会做你想做的

我知道你说过你试过这个......要小心的一件事是，如果你使用字符串来表示这一点，你需要忽略转义

```
var pattern = @"\d+"; 
```

# treeview - JavaFx 2.0：获取当前在屏幕上可见的 TreeItems 或 Nodes

> ID：10113045
> 
> 赞同：3
> 
> 时间：2012-04-11T20:00:34.300
> 
> 标签：treeview, javafx, javafx-2

我已经`TreeView<TitledPane>`并且只想显示`TitledPane`.

`TitledPane`如果屏幕上的内容可见，我希望通知一些事件。

`TitledPane`有`expandedProperty()`，所以崩溃了，但我看不到任何东西可以过滤掉 TreeView 上远处且未显示的 TreeItems。

我想到的另一种可能的方法是使用 来检查位于 TitledPane 中的节点的可见性`visibleProperty`，但这似乎不起作用。

`pane.visibleProperty().addListener(new EnhancedListener(pane));`

```
private class EnhancedListener implements ChangeListener<Boolean>
{
    Node parent;
    EnhancedListener(Node parent)
    {
        this.parent = parent;
    }
    @Override
    public void changed(ObservableValue<? extends Boolean> arg0, 
                        Boolean arg1, Boolean arg2) {
        TitledPane p = (TitledPane) parent;
        System.out.println(((Label)p.getContent()).getText()+" " + arg2);
    } 
} 
```

我使用 JavaFX 2.0.3

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-17T00:23:24.763

请参阅此 JavaFX 论坛主题[“ListView Visible Items”](https://community.oracle.com/tech/developers/discussion/2335633/listview-visible-items)和相关的 JavaFX 问题数据库条目[“可滚动组件中的项目可见性应在 API 中”](https://bugs.openjdk.java.net/browse/JDK-8090386)，以请求增强以使其更容易实现您所寻求的。

这`visibleProperty`与添加到场景时是否可以看到项目有关，而不是当前是否正在显示它（例如，如果布局节点的剪辑或滚动当前阻止显示子节点，则子节点节点的 visibleProperty 值仍然可以为 true，即使您当前看不到它）。所以简而言之，正如你所发现的，它在这里对你没有帮助。

上面链接的论坛主题为 提供了以下解决方法`ListView`，您可能能够适应您的`TreeView`情况，但您需要制定一些方法来知道场景中显示的 TreeView 呈现的单元格正在更改以触发“事件”你需要。

```
VirtualFlow vf = ((VirtualFlow)((ListViewSkin)myList.getChildrenUnmodifiable().get(0)).getChildrenUnmodifiable().get(0));
System.out.println(vf.getFirstVisibleCell().getIndex()+", "+vf.getLastVisibleCell().getIndex()); 
```

# windows - DOS和windows之间文本格式的兼容性

> ID：10113054
> 
> 赞同：0
> 
> 时间：2012-04-11T20:01:02.043
> 
> 标签：windows, text, dos

我正在使用在 DOS 中运行的 iperf 工具，所以这里是命令

实际命令:::

```
 iperf -c IP address -w 8M -f m -t 1000 -i 10 -P 4 -y C 
```

输出格式为：

```
 20120411124341,192.168.1.103,49179,192.168.1.102,5001,3,0.0-10.0,25952256,20761804
                 20120411124341,192.168.1.103,49181,192.168.1.102,5001,5,0.0-10.0,33816576,27053260 
```

但是当我尝试使用 > 符号将此格式输出到 .txt 文件时，它不承认回车，它将所有内容转储在一行中，类似于此。

```
 iperf -c IP address -w 8M -f m -t 1000 -i 10 -P 4 -y C > C:\test\a.txt
      20120411124341,192.168.1.103,49179,192.168.1.102,5001,3,0.0-10.0,25952256,2076180420120411124341,192.168.1.103,49181,192.168.1.102,5001,5,0.0-10.0,33816576,27053260 
```

当我尝试将其存储为 .txt 格式时，如何获得实际格式。这是记事本的问题？？？答案表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T20:12:03.343

iperf 使用一个字符（换行）来换行，而基于 Windows 的系统（如记事本）使用 2 个字符（换行、回车）。您应该使用功能更强大的文本编辑器（如 Notepad++），您可以在其中选择换行符以正确显示它。在这里您可以看到有关换行符的更多信息：[http ://en.wikipedia.org/wiki/Newline](http://en.wikipedia.org/wiki/Newline)

# apache - 配置php的错误信息

> ID：10113055
> 
> 赞同：0
> 
> 时间：2012-04-11T20:01:05.820
> 
> 标签：apache, php

我将 PHP 5.4 下载到装有 Windows 8（客户预览版）的计算机上，因为 Windows 上没有 5.4 的安装程序，我必须下载 php.net 提供的 zip 文件。（我正在尝试安装它以用于开发），现在，我编辑了 php.ini 但没有地方告诉 php 我的主目录是 C:\Program files (x86)\PHP 并且我得到启动 apache 后出现此错误消息：

```
[11-Apr-2012 18:54:37 UTC] PHP Warning:  PHP Startup: Unable to load dynamic library 'C:\php\php_curl.dll' - The specified module could not be found. 
```

顺便说一句，我不得不从 apachelounge 下载 php5apache2_4.dll-php-5.4-win32.zip，因为我的 apache 是 2.4 有没有办法纠正这个错误消息？我需要做的就是配置 PHP 以在 C:\Program files (x86)\PHP\ext 中查找它的扩展名

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T20:05:53.387

放

```
extension_dir = "C:\Program files (x86)\PHP\ext" 
```

在你的`php.ini`. 要找出加载了哪个/在哪里找到它，请创建一个名为的文件`info.php`，其中包含以下内容

```
<?php 
phpinfo();
?> 
```

然后浏览到它，例如[http://localhost/info.php](http://localhost/info.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T20:05:42.680

确保文件夹名称中没有空格，然后重试

例如：

在 C:\apache 中安装 apache

在 C:\php 中安装 php

# visual-studio - C++ 嵌套循环动态数组大小

> ID：10113056
> 
> 赞同：0
> 
> 时间：2012-04-11T20:01:19.073
> 
> 标签：visual-studio, c++-cli, clr

我正在尝试创建一个返回数组列表中所有值之和的方法。我在这一行收到错误`sum+= setItem[x][y][z];` 错误是

```
 expression must have pointer-to-object or handle-to-CLI-array type c:\Development\Source\Source\Source.cpp 
```

全功能

```
int getTotal(ArrayList^ set)
{
    int sum = 0;
    for each (Array^ setItem in set)
    {
        for(int x = 0; x< 3; x++)
        {
            for(int y = 0; y < setItem->Length; y++){
                for(int z = 0; z< setItem->Length; z++)
                {
                    sum+= setItem[x][y][z];
                }
            }
        }
    }
    return sum;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-11T20:03:49.453

如果`setItem`是多维数组，则需要不同的语法：尝试：`sum+= setItem[x,y,z];`

# javascript - 如何进行monkeypatch Express 视图查找？

> ID：10113058
> 
> 赞同：1
> 
> 时间：2012-04-11T20:01:30.880
> 
> 标签：javascript, node.js, express

我正在尝试覆盖 Express 视图查找功能，但无法做到。目标是能够在多个目录中查找模板。

我想要做的是，在`bootstrap.js`：

```
function bootstrap(express) {
    var originalLookup = express.View.prototype.lookup;
    express.View.prototype.lookup = function(path) {
        console.log('Requested for', path);
        return originalLookup(path);
    };
};

module.exports = bootstrap; 
```

我的`app.js`代码是：

```
var express = require('express'),
    routes = require('./routes'),
    bootstrap = require('./bootstrap'),
    app = module.exports = express.createServer();

// Configuration
require('./config/environment.js')(app, express);

// Bootstrap
bootstrap(express);

// Routes
require('./config/routes.js')(app);

// Start
app.listen(3000); 
```

在我的`bootstrap.js`代码中， express.View.prototype.lookup 是未定义的。我不明白为什么。我做错什么了？

我刚刚开始使用 node.js 和“高级”Javascript。我不得不承认我有点迷路了。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T20:13:05.173

在当前版本 (2.5.9) 中，它不是 View.prototype.lookup，它只是 View.lookup。

```
~: ) node
> require('express').View
{ [Function: View]
  register: [Function],
  compile: [Function],
  lookup: [Function] }
> require('express').View.lookup
[Function] 
```

# c++ - QTableModel 似乎没有显示在 QMainWindow

> ID：10113061
> 
> 赞同：1
> 
> 时间：2012-04-11T20:01:40.337
> 
> 标签：c++, qt

这是我的代码`MainWindow`：

```
MainWindow::MainWindow(QWidget *parent)
    : QMainWindow(parent)
{
    QSqlDatabase connection = QSqlDatabase::addDatabase("QMYSQL");
    connection.setHostName("localhost");
    connection.setDatabaseName("dbname");
    connection.setUserName("username");
    connection.setPassword("Temp");

    QTableView *view = new QTableView(this);

    view->setMinimumSize(200, 200);

    QSqlTableModel *model = new QSqlTableModel(this, connection);
    model->setTable("users");
    qDebug()  << model->columnCount() << model->rowCount();
    model->setEditStrategy(QSqlTableModel::OnManualSubmit);
    model->select();
    model->removeColumn(0); // don't show the ID

    view->setModel(model);

    view->show();

    this->setWindowTitle("Showing Things");
} 
```

我的`main.cpp`：

```
#include "mainwindow.h"

int main(int argc, char *argv[])
{

    QApplication a(argc, argv);
    MainWindow w;
    w.show();

    return a.exec();
} 
```

我**知道**我的数据库包含数据，我基本上遵循[此处](http://doc.qt.nokia.com/4.7-snapshot/qsqltablemodel.html)详细说明中的示例。

这是我编译和运行时得到的：

![纳达](../Images/12415099f8f6945dd8d1dda37ae75af9.png)

当我期待这样的事情时：

![我想要的是](../Images/f32885d0f825c1ce6e53253b5c33bde5.png)

我**不**明白。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-11T21:14:10.090

根据您发布的代码，您没有打开数据库连接。

`QSqlTableModel`不会为你打开它。

# java - Spring MVC 将文件附加到消息

> ID：10113065
> 
> 赞同：2
> 
> 时间：2012-04-11T20:01:52.943
> 
> 标签：java, spring-mvc

我想通过 Spring mvc 将文件附加到消息中（此文件的路径已在数据库中注册）。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T19:24:11.617

我想这会有所帮助：[http ://static.springsource.org/spring/docs/3.1.x/spring-framework-reference/html/mail.html#mail-javamail-mime-attachments](http://static.springsource.org/spring/docs/3.1.x/spring-framework-reference/html/mail.html#mail-javamail-mime-attachments)

# android - 从路径创建 BitmapDrawable

> ID：10113067
> 
> 赞同：2
> 
> 时间：2012-04-11T20:02:10.653
> 
> 标签：android, bitmap, drawable

我正在尝试创建位图

```
 BitmapDrawable img = new BitmapDrawable(getResources(), "res/drawable/wrench.png");
 Bitmap wrench = img.getBitmap();
 //Bitmap wrench = BitmapFactory.decodeResource(getResources(), R.drawable.wrench);
 canvas.drawColor(Color .BLACK);
 Log.d("OLOLOLO",Integer.toString(wrench.getHeight()));
 canvas.drawBitmap(wrench, left, top, null); 
```

但是当我调用**wrench.getHeight()**时，程序因 NullPoinerException 而失败。（我将文件放在可绘制目录中）我该如何解决我的问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T20:22:58.240

试试这个：

```
 Bitmap bmp = BitmapFactory.decodeResource(getResources(), R.drawable.wrench);  
            Matrix matrix=new Matrix();
            matrix.postScale(0.2f, 0.2f);
            Bitmap dstbmp=Bitmap.createBitmap(bmp,0,0,bmp.getWidth(),
            bmp.getHeight(),matrix,true);
            canvas.drawColor(Color.BLACK);  
            canvas.drawBitmap(dstbmp, 10, 10, null); 
```

“res/drawable/wrench.png”路径无效，因此如果您使用可绘制的图像，请使用 sbcard 中的图像，然后使用`R.drawable.wrench`

*无法获取存储在 drawable 中的图像的确切路径。*

**为什么不？**当您将应用程序编译为 *.apk 文件时，所有资源（好的，除了 /raw 中的资源）也会被编译。您只能使用它们的 R. id 访问它们。

**解决方案？**不是真的，例如，您可以将它们复制到 SD 卡上的某个位置。不，你知道位置:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-11T20:47:43.133

好的...我想我现在可以解决您的问题了。就像我说的，你不能通过路径访问你的drawables，所以如果你想要一个可以通过编程方式构建的drawables的人类可读界面，请在你的类的某个地方声明一个HashMap：

```
private static HashMap<String, Integer> images = null; 
```

然后在你的构造函数中初始化它：

```
public myClass() {
  if (images == null) {
    images = new HashMap<String, Integer>();
    images.put("Human1Arm", R.drawable.human_one_arm);
    // for all your images - don't worry, this is really fast and will only happen once
  }
} 
```

现在访问 -

```
String drawable = "wrench";
// fill in this value however you want, but in the end you want Human1Arm etc
// access is fast and easy:
Bitmap wrench = BitmapFactory.decodeResource(getResources(), images.get(drawable));
canvas.drawColor(Color .BLACK);
Log.d("OLOLOLO",Integer.toString(wrench.getHeight()));
canvas.drawBitmap(wrench, left, top, null); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-11T20:52:38.567

你可以这样做：

```
String imageNameWithoutExtension = "wrench";
int id = getResources().getIdentifier(imageNameWithoutExtension, "drawable", getPackageName());
Bitmap dd = BitmapFactory.decodeResource(getResources(), id);
logo.setImageBitmap(dd); 
```

# php - 用php删除xml属性-xml异常

> ID：10113071
> 
> 赞同：1
> 
> 时间：2012-04-11T20:02:21.637
> 
> 标签：php, xml

我创建了一个解析 xml 文档的 ios 应用程序。如果用户登录，他们的信息将被添加到 xml 文件中。如果用户正在注销或取消登录，我希望能够删除他们。本质上，我需要弄清楚如何删除如下所示的 xml 对象（在本例中为用户）：

```
<users>
    <user>
        <fname>fname1</fname>
        <lname>lname1</lname>
    </user>
    <user>
        <fname>fname2</fname>
        <lname>lname2</lname>
    </user>
</users> 
```

例如，我可能想根据姓氏删除用户，这在我的情况下始终是唯一的......这是我目前拥有的 php，但我完全愿意接受有关以不同方式进行操作的建议

```
$deletefname = $row['fname'];
$deletelname = $row['lname'];
$deleteimageurl = $row['imageURL'];

$xmlUrl = "thefile.xml"; // XML 
$xmlStr = file_get_contents($xmlUrl);
$xml = new SimpleXMLElement($xmlStr);
foreach($xml->users as $user)
{
    if($user[$fname] == $deletefname) {
        $xml=dom_import_simplexml($user);
        $xml->parentNode->removeChild($xml);    
    }
}

$xml->asXML('newfile.xml');
echo $xml; 
```

我对php很不好，我从别人那里拿了这段代码。不是 100% 确定它是如何工作的。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T20:27:18.977

```
<?php 
/*
 * @source_file -- source to your xml document
 * @node_to_remove -- your node
 * Note this will remove an entire user from the source file if the argument (node_to_remove)
   matches a nodes node value
 *
 */
function newFunction($source_file,$node_to_remove) {
    $xml = new DOMDocument();
    $xml->load($source_file);
    $xml->preserveWhiteSpace = false;
    $xml->formatOutput = true; 
    foreach ($xml->getElementsByTagName('users') as $users ) 
    {
        foreach($users->getElementsByTagName('user') as $user) {

            $first_name = $user->getElementsByTagName('fname')->item(0);

            if($first_name->nodeValue == $node_to_remove) {

                $users->removeChild($users->getElementsByTagName('user')->item(0));

            }

        }

    }

    $result = $xml->saveXML();

    return $result;

}

echo newFunction('xml.xml','lname1');
?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-11T21:16:39.367

在开始之前，我会给出一个常见的警告，即 XML 文件不是数据库，您应该使用真正的数据库（mysql、sqlite、xml 数据库）或至少文件锁定（[`flock()`](http://php.net/manual/en/function.flock.php)）或原子写入（写入临时文件）然后[`rename()`](http://php.net/manual/en/function.rename.php)以真名）。如果不这样做，您将遇到一个请求正在读取文件而另一个请求正在写入文件并得到垃圾 XML 的情况。

`SimpleXML`您可以使用或来执行此操作`DOMDocument`，并且使用其中任何一个都可以使用 xpath 或迭代。

下面是`SimpleXMLElement`方法，因为这是您的代码使用的方法。

```
$sxe = simplexml_load_string($xmlstring);
// XPATH
$matches = $sxe->xpath('/users/user[lname="lname2"]');
foreach ($matches as $match) {
    unset($match[0]);
}
// Iteration--slower, but safer if a part of the path is dynamic (e.g. "lname2")
// because xpath literals are very hard to escape.
// be sure to iterate backwards
for ($i=$sxe->user->count()-1; $i >= 0; --$i) {
    if ($sxe->user[$i]->lname=='lname2') {
        unset($sxe->user[$i]);
    }
}

echo $sxe->asXML(); 
```

# java - Java - 为什么没有 OutOfMemoryError？

> ID：10113073
> 
> 赞同：-2
> 
> 时间：2012-04-11T20:02:30.187
> 
> 标签：java, out-of-memory

我正在尝试使用以下代码生成 OutOfMemoryError

```
ArrayList container = new ArrayList();

while (true){
    Integer i = new Integer(1);
    container.add(i);
} 
```

应用程序崩溃但没有打印或转储！这是正常的吗？我应该将一些选项传递给 java 命令吗？如何强制 jvm 打印出此消息？

我这样做是因为我有一个在嵌入式系统上运行的应用程序（使用 cvm）崩溃而没有任何痕迹。我怀疑内存泄漏，所以我想写一个导致内存泄漏的代码，看看jvm输出什么样的消息。这就是为什么我在运行它时编写了该代码，它崩溃了但没有给出任何痕迹，这就是我发布这个问题的原因

埃利

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-11T20:09:50.073

我确实得到了

> 线程“主”java.lang.OutOfMemoryError 中的异常：Java 堆空间

```
ArrayList container = new ArrayList();
while (true) {
    Integer i = new Integer(1);
    container.add(i);
} 
```

如果我在 Integer 构造函数中放入一些东西。否则无法编译。

# performance - 每个事务的连接/断开连接的 Oracle 性能

> ID：10113075
> 
> 赞同：2
> 
> 时间：2012-04-11T20:02:40.373
> 
> 标签：performance, oracle, connect

目前正在尝试优化一些代码，并注意到在每个事务之前都进行了连接，并且在事务结束时调用了断开连接。

在我之前的经验中，我确实注意到调用 connect 很慢。重复这样做可能会非常昂贵......或者是吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-11T20:09:09.310

是的，如果您实际上为每个事务创建和拆除物理连接，除非您有非常长时间运行的事务，否则成本可能会很高。如果您的事务是一百万行的批量加载，则打开和关闭连接的成本可能相当小。另一方面，如果您的事务由插入到表中的单行组成，那么您的大部分时间将花在打开和关闭连接上。

然而，大多数时候，你有一个三层应用程序，其中中间层维护一个连接池，当中间层代码打开和关闭一个连接时，它们实际上是在逻辑连接而不是物理连接上操作. 打开连接从池中取出一个连接，业务层执行事务，然后关闭连接只是将连接返回到池中。从数据库的角度来看，没有打开或关闭任何物理连接。如果您实际上正在处理来自池的连接，则在每个事务上打开和关闭连接是完全正常的，并且假设您的连接池大小合理，则不应产生太多开销。

# ruby-on-rails - 诊断 Rails 应用程序资产预编译错误

> ID：10113076
> 
> 赞同：1
> 
> 时间：2012-04-11T20:02:46.643
> 
> 标签：ruby-on-rails, deployment, capistrano, asset-pipeline

我不太明白为什么我不断收到与我的资产预编译相关的错误。从我能够从在线文档中推断出来的内容，我需要做的就是将 rake 预编译任务添加到我的 deploy.rb 文件中，确保安装了 javascript 运行时 gem，将行 load 'deploy/assets' 添加到当我运行 cap deploy:update 时，我的 capfile 和 capistrano 应该在服务器端预编译我的资产。谁能帮我诊断部署输出中出现的错误消息？提前感谢任何可以帮助我的人！非常感谢！

```
* executing `deploy:assets:precompile'
  * executing "cd /usr/local/www/sites/project.example.ca/releases/20120411192244 && bundle exec rake RAILS_ENV=production RAILS_GROUPS=assets assets:precompile"
    servers: ["project.example.ca"]
    [project.example.ca] executing command
    [project.example.ca] rvm_path=/usr/local/rvm /usr/local/rvm/bin/rvm-shell 'ruby-1.9.2-p290@project' -c 'cd /usr/local/www/sites/project.example.ca/releases/20120411192244 && bundle exec rake RAILS_ENV=production RAILS_GROUPS=assets assets:precompile'
*** [err :: project.example.ca] /usr/local/rvm/rubies/ruby-1.9.2-p290/bin/ruby /usr/local/www/sites/project.example.ca/shared/bundle/ruby/1.9.1/bin/rake assets:precompile:nondigest RAILS_ENV=production RAILS_GROUPS=assets
*** [err :: project.example.ca] 
    command finished in 30843ms
  * executing `deploy:create_symlink'
  * executing `deploy:symlink'
    triggering before callbacks for `deploy:symlink'
  * executing `assets:precompile'
  * executing "cd /usr/local/www/sites/project.example.ca/releases/20120411192244 && bundle exec rake RAILS_ENV=production assets:precompile"
    servers: ["project.example.ca"]
    [project.example.ca] executing command
    [project.example.ca] rvm_path=/usr/local/rvm /usr/local/rvm/bin/rvm-shell 'ruby-1.9.2-p290@project' -c 'cd /usr/local/www/sites/project.example.ca/releases/20120411192244 && bundle exec rake RAILS_ENV=production assets:precompile'
*** [err :: project.example.ca] /usr/local/rvm/rubies/ruby-1.9.2-p290/bin/ruby /usr/local/www/sites/project.example.ca/shared/bundle/ruby/1.9.1/bin/rake assets:precompile:all RAILS_ENV=production RAILS_GROUPS=assets
*** [err :: project.example.ca] 
*** [err :: project.example.ca] /usr/local/rvm/rubies/ruby-1.9.2-p290/bin/ruby /usr/local/www/sites/project.example.ca/shared/bundle/ruby/1.9.1/bin/rake assets:precompile:nondigest RAILS_ENV=production RAILS_GROUPS=assets
*** [err :: project.example.ca] 
    command finished in 45033ms
[Deprecation Warning] This API has changed, please hook `deploy:create_symlink` instead of `deploy:symlink`.
  * executing "rm -f /usr/local/www/sites/project.example.ca/current && ln -s /usr/local/www/sites/project.example.ca/releases/20120411192244 /usr/local/www/sites/project.example.ca/current"
    servers: ["project.example.ca"]
    [project.example.ca] executing command
    [project.example.ca] rvm_path=/usr/local/rvm /usr/local/rvm/bin/rvm-shell 'ruby-1.9.2-p290@project' -c 'rm -f /usr/local/www/sites/project.example.ca/current && ln -s /usr/local/www/sites/project.example.ca/releases/20120411192244 /usr/local/www/sites/project.example.ca/current'
    command finished in 2968ms
 ** transaction: commit 
```

这是我的部署文件：

```
$:.unshift(File.expand_path('./lib', ENV['rvm_path'])) # Add RVM's lib directory to the load path.
require "rvm/capistrano"                  # Load RVM's capistrano plugin.
require "bundler/capistrano"

set :application, "Project"

set :scm, "git"
set :repository,  "ssh://git@server.example.ca/usr/local/git_root/project.git"
set :user, "deploy"

#set :rvm_bin_path, "/usr/local/rvm/bin"
set :rvm_ruby_string, "ruby-1.9.2-p290@project"
set :normalize_asset_timestamps, false

ssh_options[:forward_agent] = true

set :branch, "master"

set :deploy_via, :remote_cache

# If you aren't deploying to /u/apps/#{application} on the target
# servers (which is the default), you can specify the actual location
# via the :deploy_to variable:
set :deploy_to, "/usr/local/www/sites/project.example.ca/"

set :use_sudo, false

set :domain, 'project.example.ca'

role :app, domain
role :web, domain
role :db,  domain, :primary => true

before "deploy:symlink", "assets:precompile"

namespace :assets do
  desc "Compile assets"
  task :precompile, :roles => :app do
    run "cd #{release_path} && bundle exec rake RAILS_ENV=#{rails_env} assets:precompile"
  end
end 
```

这是我的 Capfile：

```
load 'deploy' if respond_to?(:namespace) # cap2 differentiator
Dir['vendor/plugins/*/recipes/*.rb'].each { |plugin| load(plugin) }
load 'config/deploy'
load 'deploy/assets' 
```

这是我的 Gemfile：

```
source 'http://rubygems.org'

gem 'rails', '3.1.3'

# Bundle edge Rails instead:
# gem 'rails',     :git => 'git://github.com/rails/rails.git'

gem 'gravatar_image_tag', '1.0.0.pre2'
gem 'will_paginate', '~> 3.0.2'
gem 'json'
gem 'yaml_db'
gem 'mysql'
gem 'rake'

group :development do
 gem 'rspec-rails', '2.6.1'
 gem 'annotate', '2.4.0'
 gem 'faker', '0.3.1'
end

group :test do
 gem 'rspec-rails', '2.6.1'
 gem 'webrat', '0.7.1'
 gem 'spork', '0.9.0.rc8'
 gem 'factory_girl_rails', '1.0'
end

# Gems used only for assets and not required
# in production environments by default
group :assets do
  gem 'execjs'
  gem 'therubyracer', :platforms => :ruby
  gem 'sass-rails',   '~> 3.1.5'
  gem 'coffee-rails', '~> 3.1.1'
  gem 'uglifier', '>= 1.0.3'
end

gem 'jquery-rails'

# To use ActiveModel has_secure_password
# gem 'bcrypt-ruby', '~> 3.0.0'

# Use unicorn as the web server
# gem 'unicorn'

# Deploy with Capistrano
gem 'capistrano' 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T22:44:44.297

尝试这个：

运行“cd #{release_path} && bundle exec rake RAILS_ENV=#{​​rails_env} assets:precompile 2>/dev/null”

# java - 关于允许许多不同类型的构造函数的最佳实践？

> ID：10113078
> 
> 赞同：3
> 
> 时间：2012-04-11T20:02:54.063
> 
> 标签：java

我有一个名为 RawReader 的类，它读取某些资源的字节，解析它们，然后将文件写入输出目录。

允许将不同的类型作为源和目标传递给构造函数是有意义的。

*   Source: String (of file or URL), URL, File or InputStream
*   目的地：字符串（目录）或文件

但是，如果我重载构造函数，就会给我留下 8 个不同的版本。例如，如果我想添加第三个可选参数，`chunkSize` *我将有 16 个构造函数！*

另一方面，我可以只有两个构造函数接受`(Object, Object)`and `(Object, Object, int)`。如果参数类型不正确，则可以检测到参数类型并引发 IllegalArgumentExceptions。

**在 Java 中通常如何处理这种情况？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-11T20:07:47.817

您可以使用[构建器](http://en.wikipedia.org/wiki/Builder_pattern#Java)：

```
Foo foo = new FooBuilder().setFile(..).setChunkSize().build(); 
```

Where`.build()`调用了一个构造函数，`Foo`该构造函数采用构建器并分配设置的任何变量。像这样的东西：

公共类 Foo {

```
private Foo(FooBuilder builder) {
    //get whatever you can find from the builder to fill the state of Foo
}
public static FooBuilder {
     private String filename;
     private File file;
     private InputStream stream;
     private int chunkSize;
     // getters and setters
     public Foo build() {
         return new Foo(this);
     }
} 
```

}

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-12T01:02:53.100

> 允许将不同的类型作为源和目标传递给构造函数是有意义的。

在一定程度上。然而，提供调用者自己可以轻松提供的转换并没有多大意义，特别是如果它会导致多达八个构造函数。所以：

(a) 你不需要两者`String`和`File`。决定一个，并坚持下去。我会用`File`. 这已经将构造函数的数量除以四。

(b)尽管有先例，但你并不真的需要两者`URL`。`InputStream`摆脱“URL”会将数字除以二。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-11T20:08:52.670

首先一个想法`(Object, Object, int)`很糟糕，不要那样做！您失去了强类型、IDE 辅助和 API 清晰度。

在您的位置上，我会将构造函数限制为您可以采用的最明显/低级输入并提供构建器/工厂方法：

```
RawReader reader = RawReaderBuilder.
  withInput(inputStream).
  withOutput(someFile).
  withChunkSize().
  build(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-11T20:15:06.123

如果你发现你有相同签名的构造函数，你可以使用不同名字的工厂方法：

```
public class Foo {

    public static Foo createForDir(String dir) {
        // create a Foo as you like and return it
    }

    public static Foo createForUrl(String url) {
        // create a Foo as you like and return it
    }
} 
```

# php - 来自密码 PHP 的 3 或 4 个随机密码字符

> ID：10113080
> 
> 赞同：-1
> 
> 时间：2012-04-11T20:03:18.820
> 
> 标签：php, mysql, ajax

我见过一些网站要求用户从他们的密码中随机输入 3 或 4 个字符来访问网站帐户。我想知道如何使用 PHP5、MySQL 和可能的 Ajax 来做到这一点。

所以，如果我有一个标准的登录表单，我会有

```
用户名：
密码：
提交按钮
```

但我想做以下登录表单：

```
用户名：
密码（输入以下字符：） Char 1[] Char 3[] char 7[]
提交按钮
```

字符 1、3 和 7 是随机的，取决于原始密码的长度。

如果您已经完成了这样的脚本并且可以对其有所了解，或者可能有一个完整的工作脚本，我可以看看我将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T20:46:26.020

我最初的想法是从拆分用户密码中选择随机字母，并获取三个随机键索引。这些键索引代表密码中的三个字母。

使用这些键索引，我构建了一个较小的数组，其中键是密码中字符的数字索引，值是字符本身。

```
$password = str_split( "stackoverflow" );
$randChar = array_rand( $password, 3 );

foreach ( $randChar as $key => $val )
  $letters[$val+1] = $password[ $val ]; 
```

此时，我们的`$letters`数组可能看起来像这样：

```
Array
(
  [3] => a
  [5] => k
  [8] => e
) 
```

笔记。这是一个随机集合。使用此集合，您将要求用户提供字符作为位置 3、5 和 8。他们提交的值可以与您随机生成的值进行比较。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-11T20:57:34.200

在登录表单中（使用 jquery）：

```
var passChars = [SOME,SERVER,DEFINED,CHARS]; // some random chars set by server
$('#submit').click(function(){
  $.post("login.php", { user: $('#username').text(), pass: $('#pass').text(), 'chars[]':passChars}, function (data)
  {
    if(data.suc)
      window.location(data.location);
    else
      alert("Try again");
  }, "json");
}); 
```

IN LOGIN.PHP SCRIPT（其中 encrypt_pass 是定义的密码加密函数， LANDING_PAGE 是您希望登录用户成功访问的位置）：

```
$result = mysql_query("SELECT unencrypted_pass, encrypted_pass FROM users WHERE user = '{$_POST['user']}'");
$pass = mysql_fetch_array($result);
for($i = 0; $i<count($_POST['chars']);$i++){
  $pass[0][(int)$_POST['chars'][$i]] = $_POST['pass'][$i];
}
if($pass[1] == encrypt_pass($pass[0])) // success
  echo json_encode(Array("suc"=>true, "location"=>LANDING_PAGE)); 
```

这假设服务器知道您的密码，因此您可以将给定的字符放入字符串中，然后将字符串与加密版本进行比较。这是我可以看到这个工作的唯一方法，因为无法解密密码（如果它们被正确加密）。我想知道这有什么用，但是......

# php - 如何将来自 MySQL 的两行数据放在 RSS 提要中

> ID：10113088
> 
> 赞同：0
> 
> 时间：2012-04-11T20:03:51.053
> 
> 标签：php, mysql, html-table, formatting, rss

我有一个显示 RSS 提要的代码，但它不会显示主要内容。

```
 <?PHP
 include("../config.php");
 #// Timetable Clearup Variabls
$yesterday = strtotime('yesterday');
$yesterdow = date('l',$yesterday);
$order = "SELECT * FROM timetable WHERE day = '$yesterdow' ORDER BY time";
$result = mysql_query($order);
$yesterdayd = date('F jS, Y', time()-86400);

    //SET XML HEADER
    header('Content-type: text/xml');

    //CONSTRUCT RSS FEED HEADERS
    $output = '<rss version="2.0">';
    $output .= '<channel>';
    $output .= "<title>Timetable - {$yesterdayd} </title>";
    $output .= '<description>Timetable.</description>';
    $output .= '<link>http://example.com/</link>';
 ###   $output .= '<copyright>Your copyright details</copyright>';

    //BODY OF RSS FEED
   $output .= '<item>';
        $output .= "<title>Timetable for $yesterdayd</title>";
        $output .= "<description><td>" . htmlspecialchars($row['username']) . "</td><td>" . htmlspecialchars($row['time']) . "</td></description>";
        $output .= '<link>Link to Item</link>';
        $output .= '<pubDate>Date Published</pubDate>';
   $output .= '</item> ';

    //CLOSE RSS FEED
   $output .= '</channel>';
   $output .= '</rss>';

    //SEND COMPLETE RSS FEED TO BROWSER
    echo($output);

?> 
```

我遇到的问题是：

```
 $output .= "<description><td>" . htmlspecialchars($row['username']) . "</td><td>" . htmlspecialchars($row['time']) . "</td></description>"; 
```

我基本上需要将每一行的数据输出到提要中。

这是我可以正常执行的方法（放入表格，这是我想要的格式）：

```
<?php 
include("../config.php");

#// Timetable Clearup Variabls
$yesterday = strtotime('yesterday');
$yesterdow = date('l',$yesterday);

echo "<table width=\"580px\" class=\"board\" border=\>";

$order = "SELECT * FROM timetable WHERE day = '$yesterdow' ORDER BY time";
$result = mysql_query($order);

// Error checking
if (!$result) {
  // output error, take other action
}
else {
  while ($row=mysql_fetch_array($result)){
     // Append all results onto an array
     $rowset[] = $row;
       echo "<tr><td>" . htmlspecialchars($row['username']) . "</td><td>" . htmlspecialchars($row['time']) . "</td></tr>";
  }
}

?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T20:19:57.387

你是什​​么意思你想在表格中显示rss？您要创建 HTML 还是 RSS (XML)？或者，也许您正在谈论将 RSS 转换为 HTML 显示？一种方法是为此使用[XSLT](http://www.w3.org/Style/XSL/)。

在您的 RSS 生成脚本中，您没有`$row`为每个提要项目定义一个变量。您只需要`while($row = mysql_fetch_array($result))`在 rss 项目输出周围放置 - 如下所示：

```
while ($row = mysql_fetch_array($result)) {
    $output .= '<item>';
    $output .= "<title>Timetable for $yesterdayd</title>";
    $output .= "<description><td>" . htmlspecialchars($row['username']) . "</td><td>" . htmlspecialchars($row['time']) . "</td></description>";
    $output .= '<link>Link to Item</link>';
    $output .= '<pubDate>Date Published</pubDate>';
    $output .= '</item>';
} 
```

编辑：重新检查您的代码：您还需要分解`description`标签中的字段。您不应该`td`在其中放置标签 - RSS 元素（通常）并不意味着包含 HTML 标记数据。

像这样的东西（如果这个意思有意义的话）：

```
$output = "<description>
    <username>" . htmlspecialchars($row['username']) . "</username>
    <time>" .     htmlspecialchars($row['time']) . "</time>
</description>"; 
```

# python - 解析 URL 查询字符串的最佳方法

> ID：10113090
> 
> 赞同：72
> 
> 时间：2012-04-11T20:04:07.893
> 
> 标签：python, string, http, webserver

在 python 中，从 URL 查询字符串（例如，通过表单附加到 URL 的数据）中解析数据的最佳方法是什么？我的目标是接受表单数据并将其显示在同一页面上。我研究了几种方法，但这些方法并不完全符合我的要求。

我正在创建一个简单的 Web 服务器，目的是了解套接字。此 Web 服务器仅用于测试目的。

```
GET /?1pm=sample&2pm=&3pm=&4pm=&5pm= HTTP/1.1
Host: localhost:50000
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:11.0) Gecko/20100101 Firefox/11.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-us,en;q=0.5
Accept-Encoding: gzip, deflate
Connection: keep-alive
Referer: http://localhost:50000/?1pm=sample&2pm=&3pm=&4pm=&5pm= 
```

* * *

## 回答 #1

> 赞同：80
> 
> 时间：2016-10-03T23:24:36.197

这是一个使用 python3 的示例`urllib.parse`：

```
from urllib.parse import urlparse, parse_qs
URL='https://someurl.com/with/query_string?i=main&mode=front&sid=12ab&enc=+Hello'
parsed_url = urlparse(URL)
parse_qs(parsed_url.query) 
```

输出：

```
{'i': ['main'], 'enc': [' Hello '], 'mode': ['front'], 'sid': ['12ab']} 
```

python2的注意事项：`from urlparse import urlparse, parse_qs`

参见：[https ://pythonhosted.org/six/#module-six.moves.urllib.parse](https://pythonhosted.org/six/#module-six.moves.urllib.parse)

* * *

## 回答 #2

> 赞同：52
> 
> 时间：2012-04-11T20:11:43.183

urllib.parse 模块是你的朋友：[https ://docs.python.org/3/library/urllib.parse.html](https://docs.python.org/3/library/urllib.parse.html)

查看[urllib.parse.parse_qs](https://docs.python.org/3/library/urllib.parse.html#urllib.parse.parse_qs)（解析查询字符串，即通过 GET 发送到服务器的表单数据或通过 POST 发布的表单数据，至少对于非多部分数据）。还有用于解释多部分数据的[cgi.FieldStorage 。](http://docs.python.org/library/cgi.html)

要解析 HTTP 交互的其余部分，请参阅[RFC2616](http://www.w3.org/Protocols/rfc2616/rfc2616.html)，它是 HTTP/1.1 协议规范。

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2017-10-06T08:05:50.217

如果您需要查询字符串中的唯一键，请使用`dict()`with`parse_qsl()`

```
import urllib.parse
urllib.parse.urlparse('https://someurl.com/with/query_string?a=1&b=2&b=3').query
    a=1&b=2&b=3
urllib.parse.parse_qs('a=1&b=2&b=3');
    {'a': ['1'], 'b': ['2','3']}
urllib.parse.parse_qsl('a=1&b=2&b=3')
    [('a', '1'), ('b', '2'), ('b', '3')]
dict(urllib.parse.parse_qsl('a=1&b=2&b=3'))
    {'a': '1', 'b': '3'} 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2019-06-18T20:38:58.617

内置于 python 2.7

```
>>> from urlparse import parse_qs
>>> parse_qs("search=quint&tags=python")
{'search': ['quint'], 'tags': ['python']} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2021-05-07T11:26:53.427

仅适用于没有导入的一行快速原型 CGI 变量，显然不是最好的，但可能很有用。

```
agrs = dict(item.split('=') for item in env['QUERY_STRING'].split('&') if item) 
```

# c# - 使用 sql server 2005 在 c# dotnet 中自动发送电子邮件通知

> ID：10113092
> 
> 赞同：0
> 
> 时间：2012-04-11T20:04:10.163
> 
> 标签：c#, asp.net, sql-server, sql-server-2005, c#-4.0

我有一个 ERP 应用程序的要求，（应用程序是在 asp.net4.0 中使用 c# 和 sql server 2005 开发的）

每当我们收到来自客户的订单时，我们都会使用唯一的序列号注册订单（序列号是自动生成的主键）现在我们要发送一个通知，基本上是一封电子邮件，说明您的订单已使用序列号注册：XXXXXX。

我能知道什么是最好的解决方案吗？？？？

我必须通过数据库还是通过应用程序发送电子邮件。

请帮我 ！！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T21:03:16.320

您应该使用[`sp_send_db_mail`](http://msdn.microsoft.com/en-us/library/ms190307.aspx)并且绝对不要尝试在 C# 应用程序中实例化一种或另一种“SMTP”类。原因是多方面的，但主要是：

*   您需要确保邮件以**事务**方式传递：调用`sp_send_db_mail`必须放在注册序列号的同一个数据库事务中。如果注册回滚，则永远不会发送邮件。
*   您需要确保**可靠地**传递邮件：如果尝试联系您的传出 SMTP 端点失败，则必须有重试逻辑。呼叫背后的[数据库邮件](http://msdn.microsoft.com/en-us/library/ms175887.aspx)`sp_send_db_mail`确保了这一点，并且还提供跟踪和日志记录以用于故障排除（哪些电子邮件无法传递以及原因）。
*   在您的 HTTP 请求完成后，您需要**异步调用 SMTP。**您不希望您的页面加载变得无响应，因为页面处理正在空闲以响应来自 SMTP 传出中继的响应。`sp_send_db_mail`这也确保了这一点，实际的邮件传递发生*在*您的事务完成之后，并且不以任何方式涉及 C# 客户端。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-11T20:11:46.710

ScottGu 对此有[一篇很棒的文章](http://weblogs.asp.net/scottgu/archive/2005/12/10/432854.aspx)。它有点旧，但他是这样说的：

> .NET 2.0 在 System.Net.Mail 代码命名空间中包含更丰富的电子邮件 API 支持。我看到人们提出了一些关于如何开始使用它的问题。以下是如何将电子邮件从“sender@foo.bar.com”发送给多个电子邮件收件人的简单片段（请注意，To a CC 属性是集合，因此可以处理多个地址目标）：
> 
> ```
> MailMessage message = new MailMessage();
> message.From = new MailAddress("sender@foo.bar.com");
> 
> message.To.Add(new MailAddress("recipient1@foo.bar.com"));
> message.To.Add(new MailAddress("recipient2@foo.bar.com"));
> message.To.Add(new MailAddress("recipient3@foo.bar.com"));
> 
> message.CC.Add(new MailAddress("carboncopy@foo.bar.com"));
> message.Subject = "This is my subject";
> message.Body = "This is the content";
> 
> SmtpClient client = new SmtpClient();
> client.Send(message); 
> ```
> 
> System.Net.Mail 从标准的 .NET 配置系统中读取 SMTP 配置数据（因此对于 ASP.NET 应用程序，您可以在应用程序的 web.config 文件中进行配置）。以下是如何配置它的示例：
> 
> ```
>  <system.net>
>     <mailSettings>
>       <smtp from="test@foo.com">
>         <network host="smtpserver1" port="25" userName="username" password="secret" defaultCredentials="true" />
>       </smtp>
>     </mailSettings>
>   </system.net> 
> ```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-13T01:10:13.647

如果您想以最少的努力发送电子邮件通知，请使用数据库邮件（配置它！）和 sp_send_mail。您将能够发送带有可能查询结果的简单短信作为附件。

如果您需要带有公司徽标图像的丰富 HTML，请构建 .NET Windows 服务（或 ConsoleApp 并安排它）。我建议您使用 Actionmailer.NET Standalone 来使用 MVC 逻辑、模板和 Razor 引擎构建 HTML 消息。使用 Actionmailer.NET Standalone，您可以在不使用 IIS 的情况下拥有它。见： http: [//geeksharp.com/2011/07/06/actionmailer-0-6-released/](http://geeksharp.com/2011/07/06/actionmailer-0-6-released/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-11T20:09:57.683

你绝对可以同时做（只要 SQL 是 2005+）

看到这个讨论：

[SQL 调用 CLR 例程](https://stackoverflow.com/questions/33449/can-you-call-a-webservice-from-tsql-code)

从您的应用程序中发送邮件非常简单：

```
System.Net.Mail.MailMessage message = new System.Net.Mail.MailMessage();
message.To.Add("luckyperson@online.microsoft.com");
message.Subject = "This is the Subject line";
message.From = new System.Net.Mail.MailAddress("From@online.microsoft.com");
message.Body = "This is the message body";
System.Net.Mail.SmtpClient smtp = new System.Net.Mail.SmtpClient("yoursmtphost");
smtp.Send(message); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-11T20:06:55.973

您绝对可以使用 C# 发送电子邮件。这是关于如何做到这一点的非常全面的文章：

[http://www.emailarchitect.net/easeendmail/kb/csharp.aspx](http://www.emailarchitect.net/easendmail/kb/csharp.aspx)

基本上，我所做的是创建一个包装器函数，它使使用为我的环境设计的自定义设置发送电子邮件变得非常简单。例如，您可以创建一个接受新序列号的方法，并根据该序列号查找所有信息。然后，您可以只传递新值并将自动格式化的电子邮件发送给客户。

# silverlight - 用 WrapPanel 绑定 ItemsControl？

> ID：10113093
> 
> 赞同：0
> 
> 时间：2012-04-11T20:04:12.557
> 
> 标签：silverlight, windows-phone-7

我用 WrapPanel 将我的 ItemsControl 设置为：

```
 <ItemsControl Grid.Row="1" Height="200" Width="420" HorizontalAlignment="Center" Name="itemsMarks" VerticalAlignment="Top">
            <ItemsControl.ItemsPanel>
                <ItemsPanelTemplate>
                    <toolkit:WrapPanel HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </ItemsPanelTemplate>
            </ItemsControl.ItemsPanel>
            <ItemsControl.ItemTemplate>
                <DataTemplate>
                    <StackPanel>
                    <Image Margin="1"  
                                VerticalAlignment="Center"
                                Source="Images/markg.png"
                                Width="70"
                                Height="70" />
                        <TextBlock TextWrapping="Wrap" Foreground="Black" Text="{Binding timestamp}" FontSize="14" HorizontalAlignment="Center" />
                    </StackPanel>
                </DataTemplate>
            </ItemsControl.ItemTemplate>
         </ItemsControl> 
```

我的数据是

```
 private class mark_item
    {
        public mark_item()
        {
            this.timestamp= "";
        }
        public string timestamp { get; set; }
    }

    private List<mark_item> marks;

    itemsMarks.ItemsSource = marks; 
```

列表标记已正确创建，WrapPanel 实际上包含列表中的项目数，但 TextBlock 没有设置其 Text 属性。

我错过了什么？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T21:36:31.913

您需要将您的`mark_item`类声明为`public`，而不是`private`。

Silverlight 中的数据绑定只能访问`public`类和属性。通过声明 class `private`，您可以阻止 Silverlight 访问它。

我按原样接受了您的代码，并且看到了您描述的相同行为。中出现了正确数量的项目，`ItemsControl`但缺少文本。我还在 Visual Studio/Visual Web Developer Express 的输出窗口中看到了以下消息。（我省略了堆栈跟踪，因为消息本身足够长）：

> System.Windows.Data 错误：无法从“PrivateClassProblem.MainPage+mark_item”（“PrivateClassProblem.MainPage+mark_item”类型）获取“时间戳”值（“System.String”类型）。BindingExpression: Path='timestamp' DataItem='PrivateClassProblem.MainPage+mark_item' (HashCode=12905972); 目标元素是'System.Windows.Controls.TextBlock'（名称=''）；目标属性是“文本”（类型“System.String”）。 System.MethodAccessException：尝试通过方法“System.Windows.CLRPropertyListener.get_Value()”访问方法“PrivateClassProblem.MainPage+mark_item.get_timestamp()”失败。

当我宣布课程`public`时，问题就消失了。

# delphi - Invalid Pointer Operation - Delphi XE

> ID：10113097
> 
> 赞同：12
> 
> 时间：2012-04-11T20:04:27.950
> 
> 标签：delphi, debugging, exception, delphi-xe

I can't seem to figure this one out. My program compiles and runs successfully, but during debugging only it pops up a message box saying "Invalid Pointer Operation" when shutting the program down. I have painstakingly checked all the FormCloseQuery and FormDestory events for any syntax or logical error. I found none and they execute as expected without any error.

![在此处输入图像描述](../Images/dff0ee2120b63928367cd4989804407b.png)

When I do tell the compiler to break at Invalid Pointer Operation error, it doesn't do anything but hangs up the program. At which point, I had to terminate or kill the process.

How do you figure this one out?

Thanks in advance,

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-04-11T20:30:43.610

An Invalid Pointer exception is thrown by the memory manager when it tries to free invalid memory. There are three ways this can happen.

The most common is because you're trying to free an object that you've already freed. If you turn on FastMM's FullDebugMode, it will detect this and point you directly to the problem. (But make sure to build a map file so it will have the information it needs to create useful stack traces from.)

The second way is if you're trying to free memory that was allocated somewhere other than the memory manager. I've seen this a few times when passing a **string** from a Delphi EXE to a Delphi DLL that wasn't using the shared memory manager feature.

第三种方式涉及直接弄乱指针，可能不适用于您。如果您尝试`FreeMem`使用`Dispose`不指向 FastMM 分配的实际内存块的错误指针，您将收到此错误。

这很可能是第一个。使用FullDebugMode，您会很容易找到问题的根源。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-01-18T15:33:55.107

当您告诉 Delphi 内存管理器释放不属于它的内存时，会发生无效的指针操作。可能发生的方式有以下三种：

*   释放已释放的指针或对象。
*   用于释放由其他内存管理器`FreeMem`（例如`GlobalAlloc`或`CoTaskMemAlloc`）分配的内容。
*   释放未初始化的指针。（这与释放空指针不同，后者是完全安全的。）

在你的程序的某个地方，你正在做这些事情之一。调试器检测到内存管理器抛出的异常，所以做一些调试。从堆栈跟踪中，您应该能够看到您要释放的变量。检查程序的其余部分以了解使用该变量的其他方式。

MadExcept 和 Eureka Log 等工具可以帮助您找到双重释放错误。他们可以跟踪相关指针的分配位置以及第一次释放的位置，这有时足以找出您的错误并停止多次释放。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-09-23T21:07:22.787

可能发生无效指针操作的第四个原因。我有两个指针指向实数数组 [0..1000]，第三个指针是实数数组 [1..200]。用 for i := 0 到 1000 初始化的所有 3 个指针都开始 ptr1^[i]:=0;ptr2^[i]:=0;ptr3^[i]:=0; 结尾; 虽然这种糟糕的编程并没有打扰 Delphi 中的 Pascal，但调用 Dispose 3 个指针中的任何一个都会导致无效的指针操作。修复只是正确初始化第三个指针。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-18T14:28:38.820

在 Delphi 调试期间，我被这种类型的“指示错误”抓住了。

检查您是否有任何启用了“允许函数调用”的监视变量，或者尝试在同一单元（或全局）中显示可能未初始化的其他变量的监视。当在断点处停止时，这可能会导致 Delphi 的调试器尝试通过访问未初始化的指针或变量的函数调用来显示值。导致 AV 的实际变量甚至不在你的观察名单上。

# php - 如何从 jEditable 返回新值

> ID：10113098
> 
> 赞同：1
> 
> 时间：2012-04-11T20:04:38.640
> 
> 标签：php, jquery, mysql, jeditable

在刷新页面之前，我似乎无法从我的 jEditable 表单中获取提交的值以显示在我的网站上。但是，它确实正确更新了 MySQL 数据库。我正在使用 PHP 和 MySQL。

谁能解释我如何使用 jEditable 在不刷新页面的情况下就地更新？

**PHP 操作页面**

```
if($_POST["issue_edit"]){
    mysql_query("UPDATE timeline SET comment='".$_POST["issue_edit"]."' WHERE ticket='".$_POST["id"]."' AND issue='1'");
    echo $_POST["issue_edit"];
    // header("location: ../?".$query.""); 
```

}

**主页**

```
 <script>
                $(document).ready(function() {
                    $('.edit<?php echo $ticket["id"]; ?>').editable('http://www.4dcreative.co.uk/support/tickets/action/index.php', { 
                        type        : 'textarea',
                        cancel      : 'Cancel',
                        submit      : 'OK',  
                        name        : 'issue_edit',
                        onblur      : 'ignore'
                    });
                });
            </script>
            <label>Issue:</label><p class="edit<?php echo $ticket["id"]; ?>" id="<?php echo $ticket["id"]; ?>"><?php 

            while($timeline_stub = mysql_fetch_array($timeline)) {

                if($timeline_stub["type"]=="issue"){
                    echo nl2br($timeline_stub["comment"]);
                }
            }

            ?></p> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-31T15:21:46.867

我不希望输入任何作为`issue_edit`参数传递的文本会丢失......

也许这是 Jeditable 以前版本的行为？事实上，我有一个类似但有点相反的问题，我有许多用户可以输入数字的字段，但我想用“格式化”值更新数字（例如“1,000.00”而不是“1000” ）。

要在不刷新的情况下更新页面——并且在 Jeditable 插件向指定的“提交 URL”发出请求之后——您需要`callback`在调用`editable`插件函数时为选项参数提供一个函数。这是我自己的代码中的一个示例回调函数：

```
function (result) {

    if (result.status == 'Success') {
        thisAmountElement.className += ' success';
        $(thisAmountElement).text(result.formattedAmount);
    }
    else
        thisAmountElement.className += ' danger';
} 
```

在提交 URL 处处理请求的代码返回一个带有`status`and`formattedAmount`属性的 JSON 对象。[该`formattedAmount`属性包含 Jeditable 提交的新金额，但使用相同的服务器端代码格式化页面上的所有其他金额。]

# tridion - 事件系统：如何知道编辑器是否单击了保存或保存并关闭？

> ID：10113100
> 
> 赞同：6
> 
> 时间：2012-04-11T20:04:47.157
> 
> 标签：tridion

在 Tridion 2011 SP1 中，我正在尝试实现一个事件，该事件将在编辑器按下保存并关闭（但不是保存）时自动发布项目。

在正常情况下，这可以在 CheckIn 事件中处理，但因为该项目可能在工作流中，所以没有 CheckIn 事件（目前）。

在 COM 事件中，我们有一个标志 (doneEditing) 来告诉我们编辑器是否按下了保存和关闭与保存。我似乎无法在 TOM.NET Events 中找到类似的选项。

供参考 - 这是到目前为止的代码：

```
[TcmExtension("Publish to Wip Events")]
public class PublishToWip : TcmExtension
{
    public PublishToWip()
    {
        EventSystem.SubscribeAsync<VersionedItem, SaveEventArgs>(PublishItemToWip, EventPhases.TransactionCommitted);
    }
    private void PublishItemToWip(VersionedItem item, SaveEventArgs args, EventPhases phases)
    {
       // Magic goes here
    }
} 
```

我查看了 SaveEventArgs 的选项，但没有找到任何可以为我提供此信息的东西。有小费吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-12T20:03:59.647

好的，在 CM 团队的帮助下，我得到了正确的答案。

使用 CheckInEvent 而不是保存。即使该项目在工作流程中，它仍会在您单击保存并关闭时调用此事件（并且**仅**在您单击保存并关闭时，而不是在您单击保存时）。

这样的事情会让我继续前进：

```
[TcmExtension("Publish to Wip Events")]
public class PublishToWip : TcmExtension
{
    public PublishToWip()
    {
        EventSystem.Subscribe<VersionedItem, CheckInEventArgs>
            (PublishItemToWip, EventPhases.Processed);
    }
    private void PublishItemToWip(VersionedItem item, 
        CheckInEventArgs args, EventPhases phases)
    {

        if (!item.LockType.HasFlag(LockType.InWorkflow)) return;

        if (!item.IsCheckedOut) return;
        // do something now 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-11T20:14:21.023

我过去一直在看这个，但我找不到合适的解决方案。最后我放弃了。

我的想法是有一个 GUI 扩展来拦截 Save 并因此为该项目编写一个 AppData 条目，说明它是 Save 或 SaveClose。然后您的事件系统将读取 AppData 并采取相应措施。

不要忘记清理事件代码中的 AppData。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-04-12T08:02:29.550

为了捕捉项目完成的工作流程，您需要在 Process 上订阅 FinishProcess 事件，而不是在组件上：

```
EventSystem.SubscribeAsync<Process, FinishProcessEventArgs>(FinishProcessHandler, EventPhases.TransactionCommitted, EventSubscriptionOrder.Late); 
```

在事件处理程序中， Process 实例将包含具有版本化项目已完成工作流的主题列表 - 您要发布的主题：

```
private static void FinishProcessHandler(Process process, FinishProcessEventArgs e, EventPhases phase)
{
   foreach (var itemInWorkflow in process.Subjects)
   {
      //publish
   }
} 
```

# javascript - 使用 Sammy.js 时如何移动到页面上的锚点？

> ID：10113103
> 
> 赞同：4
> 
> 时间：2012-04-11T20:04:56.917
> 
> 标签：javascript, javascript-framework, sammy.js

> **可能重复：**
> [如何使用 jQuery 或 Javascript 将 HTML 页面滚动到给定的锚点？](https://stackoverflow.com/questions/3163615/how-to-scroll-html-page-to-given-anchor-using-jquery-or-javascript)

我正在使用 Sammy.js，它处理所有客户端 URL 导航。我想导航到`/page#fragment`，但页面实际上不会去`#fragment`。我怎样才能让它做到这一点，无论是自动的，还是通过编写代码去片段？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T23:12:50.917

Sammy 不会自动触发路由，因此您需要在处理程序中添加：

```
hash = window.location.hash
if(hash != '') { 
    window.location.hash = hash;
} 
```

# php - XSS触发问题

> ID：10113107
> 
> 赞同：1
> 
> 时间：2012-04-11T20:05:29.327
> 
> 标签：php, javascript, xss, zen-cart

因此，我正在处理的其中一个网站显然存在 xss 漏洞。

正常的html是这样的：

```
<form name="contact_us" action="somewhere" method="post">
<div id="contactUsNoticeContent" class="content"></div>
<fieldset id="contactUsForm">
<legend>Contact Us</legend>
<div class="alert forward">* Required information</div>
<label class="inputLabel" for="contactname">Full Name:</label>
<input type="text" name="contactname" size="40" id="contactname"><span class="alert">*
</span><br class="clearBoth">
<label class="inputLabel" for="email-address">Email Address:</label>
<input type="text" name="email" size="40" id="email-address"><span class="alert">*
</span><br class="clearBoth">

<label for="enquiry">Message:<span class="alert">*</span></label>
<textarea name="enquiry" cols="30" rows="7" id="enquiry"></textarea>
</fieldset>

<div class="buttonRow forward"><input type="image"src="an image src" alt="Send Now" 
title=" Send Now "></div>
<div yourface" alt="Back" title=" Back " width="85" height="25"></a></div>
</form> 
```

他们将以下代码作为漏洞发回给我：

```
<input type="text" name="email" value="
<s cript>alert('S AINTL2NvbnRhY3RfdX MuaHRtbD9hY3Rpb249c2VuZ CBlbWFpbA==')
</s cri pt>" s ize="40" id="emailaddress " /><s pan clas s ="alert">*</s pan>
<br clas s ="clearBoth" /> 
```

重绘 $value 的代码是原始帖子数据：

```
 $field = '<input type="' . zen_output_string($type) . '" name="' . 
zen_output_string($name) . '"';
if ( (isset($GLOBALS[$name])) && ($reinsert_value == true) ) {
$field .= ' value="' . zen_output_string(stripslashes($GLOBALS[$name])) . '"';
} elseif (zen_not_null($value)) {
$field .= ' value="' . zen_output_string($value) . '"';
}
if (zen_not_null($parameters)) $field .= ' ' . $parameters;
$field .= ' />'; 
```

我想当提交表单时，应该在页面重新加载时显示警报？我似乎无法触发这个。我认为我需要做的就是在将其重新发布到表单以修复它之前摆脱该值，但现在我有点好奇我做错了什么，我似乎无法触发它。任何人都知道如何重现这个或我做错了什么？

它位于具有已知漏洞的旧 zen cart 框架上。但我想了解它们，而不仅仅是安装补丁。 [禅功能参考](http://www.8tiny.com/source/zencart/nav.html?_functions/index.html)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-07T02:55:35.123

> 它位于具有已知漏洞的旧 zen cart 框架上。但我想了解它们而不仅仅是安装补丁

您的旧网站确实存在已知漏洞。查看修复的一种非常快速的方法是获取新版本的代码（修复了问题）并比较文件。涉及两个文件：

*   /includes/modules/pages/contact_us/header_php.php
*   /includes/templates/NAME_OF_YOUR_TEMPLATE/templates/tpl_contact_us_default.php

与 WinMerge 或您最喜欢的比较工具的快速比较将为您指出差异。

在引导核心代码的其他地方还采取了进一步的系统范围的清理操作，这些操作也处理相关问题。

PS：如果你想要所有这些保护，你真的应该升级到最新版本；）

# php - 将 php 数组传递给 javascript

> ID：10113110
> 
> 赞同：1
> 
> 时间：2012-04-11T20:05:49.653
> 
> 标签：php, javascript

我有一个与 html 相呼应的 php。在其中一个回声中，我有一个调用 javascript 函数的按钮。在这个调用中，我传递了一个 php 变量。但是，当我看到其中一个元素的值在 javascript 中时，我得到了未定义。

有任何想法吗？

Javascript

```
function addrow(innerid, teams){

    alert(teams[1]);} 
```

这是我通过它的方式，这都是在回声中

```
<input type = "button" id = '.$buttonid.'  value = "Agregar" onclick = "addrow(\'' . $leaguesarray[$numofleagues] . '\','.$teamsarray.') 
```

所以我调用 addrow( 带有一个联赛值，并且我还从 php 传递了数组 teamsarray

我决定尝试其他方法，但无法正常工作。

有什么建议么？

```
echo '<script language="javascript">';

for ($size = 0; $size < sizeof($teamsarray);$size++){

    echo "var teamsarray[".$size."] = ".$teamsarray[$size].";\n";

    }

echo 'function addrow(innerid, size){

for (var i = 0;i< size; i++ ){

html = html + "<option value = " + teamsarray[i] + ">"+teamsarray[i]+"</option>";

    }

html = html +"</select>";
}</script>'; 
```

基本上我想要做的是通过 php 回显 javascript。我正在尝试使用从 php 获得的值进行下拉列表。它将使用 addrow 函数动态添加。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T20:36:14.897

听起来您可能正在寻找 json_encode，因此您可能会执行以下操作：

```
if (empty($teamsarray)) $teamsarray = array();
echo '<input type = "button" id = '.$buttonid.'  value = "Agregar" onclick = "addrow(\'' . $leaguesarray[$numofleagues] . '\','.json_encode($teamsarray).'); return false;" />'; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T20:50:49.710

在 javascript 中，数组看起来像：[2,4,6]。php implode 命令可以在这里提供帮助。

```
 $buttonid = 42;
    $leaguesarray[$numofleagues] = 66;
    $teamsarray = array(2,4,6);

    $teams = implode(',',$teamsarray);

    $input = <<<EOT
<input type="button" id="$buttonid" value="Agregar" onclick="addrow($leaguesarray[$numofleagues],[$teams])" />
EOT;
    echo $input . "\n"; 
```

产量：

```
<input type="button" id="42" value="Agregar" onclick="addrow(66,[2,4,6])" /> 
```

我认为这是你想要的。

编辑：

@Dustin Grahams 建议使用 json_encode 是一个很好的建议。将内爆替换为：

```
$teams = json_encode($teamsarray); 
```

并从模板中删除多余的括号。

# sql - 具有经理 ID 和员工 ID 的 Oracle 10 递归

> ID：10113115
> 
> 赞同：1
> 
> 时间：2012-04-11T20:06:06.433
> 
> 标签：sql, oracle, oracle10g

我在这方面遇到了很多麻烦，任何帮助都会很棒。

我在 Oracle 10 中有一个简单的表，看起来像这样

```
Name | EmployeeID |  ManagerID | Title 
```

我需要一个查询来返回给定员工 ID 的所有报告

因此，如果我将员工 ID 传递给 1000，它将遍历直接报告，然后是间接报告等。

我弄乱了递归样本，但似乎没有一个对我有用。我知道我只是没有正确设置它。谢谢你的帮助。

供参考。我正在寻找关于此的 SQL 查询。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T21:15:43.453

首先，让我们设置测试数据...

```
CREATE TABLE EMPLOYEE (
    EMPLOYEE_ID INT PRIMARY KEY,
    MANAGER_ID INT,
    NAME VARCHAR2(20),
    TITLE VARCHAR2(20),
    FOREIGN KEY (MANAGER_ID) REFERENCES EMPLOYEE (EMPLOYEE_ID)
);

INSERT INTO EMPLOYEE(EMPLOYEE_ID, NAME, TITLE) VALUES (1, 'Rob', 'CEO');
    INSERT INTO EMPLOYEE VALUES (2, 1, 'Bob', 'Manager');
        INSERT INTO EMPLOYEE VALUES (3, 2, 'Matilda', 'Secretary');
    INSERT INTO EMPLOYEE VALUES (4, 1, 'Steve', 'Manager');
        INSERT INTO EMPLOYEE VALUES (5, 4, 'John', 'Senior Worker');
            INSERT INTO EMPLOYEE VALUES (6, 5, 'Paul', 'Junior Worker');
        INSERT INTO EMPLOYEE VALUES (7, 4, 'Anny', 'Senior Worker'); 
```

以下查询递归返回 Steve 和他的所有下属：

```
SELECT *
FROM EMPLOYEE
START WITH EMPLOYEE_ID = 4
CONNECT BY PRIOR EMPLOYEE_ID = MANAGER_ID;

EMPLOYEE_ID        MANAGER_ID         NAME                 TITLE                
------------------ ------------------ -------------------- -------------------- 
4                  1                  Steve                Manager              
5                  4                  John                 Senior Worker        
6                  5                  Paul                 Junior Worker        
7                  4                  Anny                 Senior Worker 
```

“翻转”`PRIOR`给了我们史蒂夫的上级：

```
SELECT *
FROM EMPLOYEE
START WITH EMPLOYEE_ID = 4
CONNECT BY EMPLOYEE_ID = PRIOR MANAGER_ID;

EMPLOYEE_ID        MANAGER_ID         NAME                 TITLE                
------------------ ------------------ -------------------- -------------------- 
4                  1                  Steve                Manager              
1                                     Rob                  CEO 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-11T20:57:40.440

像这样的东西应该工作：

```
select lpad(' ', 2*(level-1)) || name as employeename
from employee_table
start with employeeid = 1000
connect by prior employeeid = managerid; 
```

lpad() 函数用于缩进结果，以便您可以看到谁向谁报告。

如果您不想将employeeid 1000 包含在结果中，只需更改：

```
start with employeeid = 1000 
```

至：

```
start with managerid = 1000 
```

# regex - R映射等效？

> ID：10113116
> 
> 赞同：-1
> 
> 时间：2012-04-11T20:06:10.170
> 
> 标签：regex, r

必须是一种避免在 R 中这样做的方法。某种映射函数？基本上，想要指定一系列的grepl条件和一系列的替换。谢谢，

```
hold[grepl('TRAVEL', hold[, "exp_pur_desc"]), "exp_pur_desc"] <- "TRAVEL"
hold[grepl('IN-KIND:', hold[, "exp_pur_desc"]), "exp_pur_desc"] <- "IN-KIND"
hold[grepl('COMPLIANCE', hold[, "exp_pur_desc"]), "exp_pur_desc"] <- "COMPLIANCE"
hold[grepl('MEDIA', hold[, "exp_pur_desc"]), "exp_pur_desc"] <- "MEDIA"
hold[grepl('WATER|FOOD|OFFICE|Office|CLEANING|ALARM', hold[, "exp_pur_desc"]), "exp_pur_desc"] <- "OFFICE"
hold[grepl('DATA', hold[, "exp_pur_desc"]), "exp_pur_desc"] <- "DATA"
hold[grepl('LEGAL', hold[, "exp_pur_desc"]), "exp_pur_desc"] <- "LEGAL"
hold[grepl('EVENT', hold[, "exp_pur_desc"]), "exp_pur_desc"] <- "EVENT"
hold[grepl('CATERING', hold[, "exp_pur_desc"]), "exp_pur_desc"] <- "CATERING"
hold[grepl('PHONE', hold[, "exp_pur_desc"]), "exp_pur_desc"] <- "PHONE"
hold[grepl('EQUIPMENT', hold[, "exp_pur_desc"]), "exp_pur_desc"] <- "EQUIPMENT"
hold[grepl('FUNDRAISING|FINANCE', hold[, "exp_pur_desc"]), "exp_pur_desc"] <- "FUNDRAISING"
hold[grepl('PAYROLL', hold[, "exp_pur_desc"]), "exp_pur_desc"] <- "PAYROLL"
hold[grepl('LIST RENTAL', hold[, "exp_pur_desc"]), "exp_pur_desc"] <- "LIST RENTAL" 
```

编辑：是的，对不起，小轻率。hold 是 data.frame，其中有一列名为“exp_pur_desc”。我可以看到 lapply 或 sapply 使用“switch”等效项。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T21:25:45.970

这是一种方法：

```
strReplace <- function(x, mapFrom, mapTo) {
    for (i in seq_along(mapFrom)) {
        x <- gsub(mapFrom[[i]], mapTo[[i]], x)
    }
    x
}

strReplace(c("Hello cruel world!", "Hello again Tellus!"), # Text
           c("Hello", "world|Tellus"), # words to replace (regular expressions)
           c("Hi", "moon"))            # words to replace with
#[1] "Hi cruel moon!" "Hi again moon!" 
```

...所以在你的情况下：

```
hold<-data.frame(ID=11:12, exp_pur_desc=c('FOOD','FINANCE'))
hold[['exp_pur_desc']] <- strReplace(hold[['exp_pur_desc']],
  c('WATER|FOOD|OFFICE|Office|CLEANING|ALARM', 'FUNDRAISING|FINANCE'),
  c('OFFICE', 'FUNDRAISING'))
hold 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-12T19:14:49.493

这是一个使用`gsubfn`包的选项，这将用“A”替换任何带有“A”的单词，“E”也是如此，任何带有“I”，“O”或“U”的单词都将是替换为“IOU”，任何小写元音都将使用“other”进行替换（这将替换整个字符串，这似乎是所要求的，如果需要其他内容可以修改）：

```
library(gsubfn)

replacements <- list(A='A', E='E', I='IOU', O='IOU', U='IOU', 'other')

gsubfn('^.*?(A|E|I|O|U|a|e|i|o|u).*$', replacements, state.name) 
```

# jquery - IE 中的 JQuery 图像气泡问题

> ID：10113117
> 
> 赞同：0
> 
> 时间：2012-04-11T20:06:13.553
> 
> 标签：jquery, css

我正在尝试实现 Jquery Image Bubbles，如下所示：

[http://www.dynamicdrive.com/dynamicindex4/imagebubbles.htm](http://www.dynamicdrive.com/dynamicindex4/imagebubbles.htm)

但是我在我的小提琴中收到一个 JavaScript 错误：http: [//jsfiddle.net/NinjaSk8ter/hbMzV/](http://jsfiddle.net/NinjaSk8ter/hbMzV/)

已确定将 JavaScript 文件从 dynamicdrive 演示页面加载到 Fiddle 中不起作用。直接复制 JavaScript 确实起作用了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T20:21:09.530

我收到该`imgbubbles`方法不存在的错误。这意味着资源没有被加载到小提琴中。解决方案很简单。

与其尝试将文件从动态驱动域加载到您的页面中，不如将其复制到您的项目文件夹并从那里加载。在您的小提琴中，我将插件的实际源代码拉到了 JavaScript 面板中，这解决了缺少方法的问题。

演示： http: [//jsfiddle.net/hbMzV/13/](http://jsfiddle.net/hbMzV/13/)（在 IE 7 到 10 中测试）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T20:10:13.270

JSLint 说要加入一些分号，如下所示：

```
jQuery(document).ready(function($){
 $('ul#orbs').imgbubbles({factor:3.15, speed:1500});
}); 
```

看起来即使没有它们也能工作。

# c# - 需要从数据库中获取特定信息

> ID：10113118
> 
> 赞同：1
> 
> 时间：2012-04-11T20:06:18.107
> 
> 标签：c#, asp.net-mvc-3, entity-framework, entity-framework-4

我被卡住了，需要一些帮助，我正在使用实体框架并有以下浏览 ActionResult 来创建节目列表：

```
 public ActionResult Browse(string genre)
    {
        var genreModel = db.Genres.Include("Shows")
        .Single(g => g.Name == genre);

        return View(genreModel);
    } 
```

这是节目列表：

```
@foreach (var show in Model.Shows)
{
    <li>
    <a href="@Url.Action("Details", new { id = show.ShowId })"> 
    <img alt="@show.Title" src="@show.ShowArtUrl" /> <span>@show.Title</span> </a>   
    </li>
    } 
```

我需要创建 Details ActionResult ，当用户点击上面显示的带有 ShowId 的链接时将响应它并返回节目的详细信息，有人吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T20:17:16.400

好的，这就是我如何完成您正在尝试做的事情（或者至少是我认为您正在尝试做的事情）。

这是我的观点：

```
@model IEnumerable<DarkRobot.Models.Post>
<p>
@Html.ActionLink("Create New", "Create")
</p>
        <aside class="blogAside">
            <h3>history of words</h3>
            <ul class="linkList">
            @foreach (var item in Model.Reverse())
            {
                string name = item.Title;
                <li><a>@Html.ActionLink(name, "Details", new { id = item.Id }, null)</a></li>
            }
            </ul>
        </aside> 
```

在这里，我有 @Html.Actionlink，它正在获取我拥有的每篇博客文章的 id。因此，当创建链接时，它会将那个值传递给我的另一个视图“详细信息”

控制器处理所有这些东西，所以这里是：

指数：

```
 public ViewResult Index()
    {
        var posts = db.Posts.Include(p => p.Blog).Include(p => p.Comments);
        return View(posts.ToList());
    } 
```

现在详细信息控制器：

```
 public ViewResult Details(int id)
    {
        Post post = db.Posts.Find(id);
        return View(post);
    } 
```

在我的 Details 视图的 ViewResult 中，我确保获取传入的 id 并将其分配给我正在提取的帖子。

让我知道这是否有帮助！

# java - Hibernate + Derby：不支持“BOOLEAN”和“INTEGER”之间的比较

> ID：10113122
> 
> 赞同：4
> 
> 时间：2012-04-11T20:06:31.180
> 
> 标签：java, hibernate, jpa, derby

我在查询 Derby 数据库时遇到问题。我正在使用带有 JPA 的 Hibernate。问题（可能）与布尔列有关。每个查询都以错误结束：

*org.hibernate.exception.SQLGrammarException：不支持“BOOLEAN”和“INTEGER”之间的比较。类型必须具有可比性。字符串类型也必须有匹配的排序规则。如果排序规则不匹配，一个可能的解决方案是将操作数强制转换为默认排序规则（例如 SELECT tablename FROM sys.systables WHERE CAST(tablename AS VARCHAR(128)) = 'T1')*

您可以在下面找到示例代码和配置。简化示例以便于阅读。这是我的 JPA 实体：

```
@Entity
public abstract class Task implements Serializable {

    @Id
    @GeneratedValue(strategy = GenerationType.TABLE)
    protected long id;

    @Column
    protected boolean deleted;

    public long getId() {
        return id;
    }

    public boolean isDeleted() {
        return deleted;
    }

    public void setId(long id) {
        this.id = id;
    }

    public void setDeleted(boolean deleted) {
        this.deleted = deleted;
    }

    @Override
    public int hashCode() {
        return id;
    }

    @Override
    public boolean equals(Object object) {
        if (object == null) {
            return false;
        }

        if (!this.getClass().equals(object.getClass())) {
            return false;
        }

        EntityObject other = (EntityObject) object;

        if (this.id != other.id) {
            return false;
        }

        return true;
    }

    @Override
    public String toString() {
        return "EntityObject[ id=" + id + " ]";
    }
} 
```

我的 JPA 查询：

```
SELECT t FROM Task t WHERE deleted = false 
```

我的 JPA 配置：

```
<persistence-unit name="PU1" transaction-type="JTA">
<provider>org.hibernate.ejb.HibernatePersistence</provider>
<jta-data-source>jdbc/myapp</jta-data-source>
<exclude-unlisted-classes>false</exclude-unlisted-classes>
<properties>
  <property name="hibernate.hbm2ddl.auto" value="update"/>
  <property name="hibernate.dialect" value="org.hibernate.dialect.DerbyDialect"/>
</properties>
</persistence-unit> 
```

怎么了？如何解决？感谢您的任何建议。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-11T22:18:06.160

在 Derby 10.7 中添加了布尔数据类型，您似乎使用的是 10.7 或更高版本，因此您应该使用[`org.hibernate.dialect.DerbyTenSevenDialect`](http://docs.jboss.org/hibernate/orm/4.1/javadocs/org/hibernate/dialect/DerbyTenSevenDialect.html)添加布尔支持的方言。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-23T08:24:42.100

You have to set your boolean as a parameter:

```
String queryString = "SELECT t FROM Task t WHERE t.deleted = :trueValue";
Query query = entityManager.createQuery(queryString);
query.setParameter("trueValue", true);
query.getResultList(); 
```

Hope it will work for you ;)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-21T21:52:51.483

降级没有帮助。这是对我有用的有效解决方案：

```
import java.sql.Types;
import org.hibernate.dialect.DerbyTenSevenDialect;

public class DerbyDialect extends DerbyTenSevenDialect {

    public DerbyDialect() {
        // fix Derby dialect boolean data type mapping error
        registerColumnType(Types.BOOLEAN, "INTEGER");
    }
} 
```

我想最好在方言中配置 'true' 和 'false' 常量映射到 Derby 数据类型，但现在上面已经足够好了。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-12-14T12:55:49.067

使用了 Rafal 的方法但也必须添加

```
@Override
public String toBooleanValueString(boolean bool) {
    return bool ? "1" : "0";
} 
```

在我的方言中。否则它在 Hibernate 4.2.8 下不起作用。

此外，当我的应用程序针对 Oracle 和 Derby 运行时，我无法在 persistence.xml 中明确指定我的方言。所以我为我的方言添加了一个方言解析器：

```
<property name="hibernate.dialect_resolvers" value="...DerbyBoolAsIntDialectResolver"/> 
```

解析器本身：

```
public class DerbyBoolAsIntDialectResolver extends AbstractDialectResolver {
    @Override
    protected Dialect resolveDialectInternal(DatabaseMetaData metaData) throws SQLException {
        String databaseName = metaData.getDatabaseProductName();
        int databaseMajorVersion = metaData.getDatabaseMajorVersion();

        if ( "Apache Derby".equals( databaseName ) ) {
            final int databaseMinorVersion = metaData.getDatabaseMinorVersion();
            if ( databaseMajorVersion > 10 || ( databaseMajorVersion == 10 && databaseMinorVersion >= 7 ) ) {
                return new DerbyBoolAsIntDialect();
            }
        }
        return null;
    }
} 
```

# javascript - 使用模块模式？/ 默认起点？

> ID：10113123
> 
> 赞同：1
> 
> 时间：2012-04-11T20:06:39.187
> 
> 标签：javascript, oop

在下面的消息中，我使用了该模式，它工作正常。message[] 只有一个实例，它是私有的。显示是公开的，因为这就是我使用对象的方式。

关于第二个对象 - 效果

**默认方式，**

我打算将 Effects 更新为这种模式只是因为我想让它成为我编写面向对象 JavaScript 的默认方式。

是否还有其他/更好的事情需要考虑，或者这是编写对象的一个​​很好的起点。

在 C++ 中，默认起点可能是：

```
class MyClass
{
private:
protected:
public:
}; 
```

**此外，潜在的低效率**

效果只是淡入或淡出一个元素。我将计时器设为元素的属性以避免闪烁。这样做只允许为每个元素设置一个不透明度级别。

然而，这让我相信有时我有多个效果实例在同一个元素上运行。他们只是碰巧在做同样的事情，因为他们共享同一个计时器。

```
/**
 *Message
 *  element - holds the element to send the message to via .innerHTML
 *  type - determines the message to send
 */

var Message = ( function () 
{
    var messages = 
    {
        name:         'Please enter a valid name',
        email:        'Please enter a valid email',
        email_s:      'Please enter a valid email.',
        pass:         'Please enter passoword, 6-40 characters',
        url:          'Please enter a valid url',
        title:        'Please enter a valid title',
        tweet:        'Please enter a valid tweet',
        empty:        'Please complete all fields',
        same:         'Please make emails equal',
        taken:        'Sorry, that email is taken',
        validate:     'Please contact <a class="d" href="mailto:me@host.com">support</a> to reset your password',
    };
    var Message = function (element) 
    {
        this.element = element;
    };
    Message.prototype.display = function( type ) 
    {
        this.element.innerHTML = messages[ type ];
        new Effects().fade( this.element, 'down', 4000 );
    };
    return Message;
}()); 
```

**效果**

```
/**
 *Effects - build out as needed
 *  element - holds the element to fade
 *  direction - determines which way to fade the element
 *  max_time - length of the fade
 */

var Effects = function(  ) 
{
    this.fade = function( element, direction, max_time ) 
    {
        element.elapsed = 0;
        clearTimeout( element.timeout_id );
        function next() 
        {
            element.elapsed += 10;
            if ( direction === 'up' )
            {
                element.style.opacity = element.elapsed / max_time;
            }
            else if ( direction === 'down' )
            {
                element.style.opacity = ( max_time - element.elapsed ) / max_time;
            }
            if ( element.elapsed <= max_time ) 
            {
                element.timeout_id = setTimeout( next, 10 );
            }
        }
    next();
    }
}; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T22:42:07.843

这是一种使用内部构造函数实现模块的方法，该构造函数`constructMessage(element)`也公开、私有变量`$messages`和私有函数`internalDisplay(type, effects)`。

请注意，这`effects`是函数的参数`display(type, effects)`。这简化了单元测试，因为您可以传入 mock `Effects`。

代码是在 JavaScript 中处理命名空间和私有成员的常用方法。如您所见，您的“类”可以具有您有选择地向外部公开的私有功能。

最后，模块和“类”名称不是最好的，但对于这个简单的示例来说已经足够了。

```
var MessageModule = MessageModule || (function () {

    function constructMessage(element) {

        var messages = {
            name:         'Please enter a valid name', 
            email:        'Please enter a valid email', 
            email_s:      'Please enter a valid email.', 
            pass:         'Please enter passoword, 6-40 characters', 
            url:          'Please enter a valid url', 
            title:        'Please enter a valid title', 
            tweet:        'Please enter a valid tweet', 
            empty:        'Please complete all fields', 
            same:         'Please make emails equal', 
            taken:        'Sorry, that email is taken', 
            validate:     'Please contact support to reset your password' 
        };

        function internalDisplay(type, effects) {
            element.innerHTML = messages[type];
            effects.fade(element, "down", 4000);
        }

        return {
            display: internalDisplay
        };
    }

    return {
        Message: constructMessage
    };
})();
```

# java - 如何用新信息更新 JDialog？

> ID：10113124
> 
> 赞同：1
> 
> 时间：2012-04-11T20:06:40.013
> 
> 标签：java, swing, repaint, jdialog

我有一个 GUI，它允许用户单击按钮并查看文本文件的内容。问题是文件可能相当大（超过 100,000 行数据）并且可能需要 15 秒以上的时间才能读取并显示在表格中。

文本文件格式示例：

```
*/
    Account ID     : 8 digit number
    Money Charged  : Integer < $10
    Values separated by \t 

/*

Account Id    Money Charged
----------    --------------
731298        3
359412        5
624937        1 
```

因此，当单击按钮时，它会读取每一行并将每个 id 放入地图并增加帐户费用。

完成后，它将在 JDialog 中放置一个带有信息的 JTable。但是，一旦单击该按钮，用户可能会对程序正在做什么感到困惑，因为我在 JDialog 和 JTable 出现之前经历了超过 10-15 秒的延迟。

那么有没有办法让 JDialog 出现一个字符串，让用户知道它正在创建表？（我认为可以使用其中一种 JDialog 方法来完成，例如`repaint()`or`validate`但那些似乎并没有奏效。

这是我认为应该完成的顺序：

```
//Psuedo-code
actionPerformed {
    create frame
    display label that lets user know its creating table
    read text file
    create map and place values
    remove label
    update dialog with table // unsure what to do to update it properly
} 
```

***所以我的总体问题很简单：*** 是否可以通知用户它当前正在计算数据（通过 JDialog 中的 JLabel）并且一旦读取数据，显示 JTable（通过更新 JDialog）？

如果需要，我可以提供来源。不确定它是否真的需要

***编辑***

```
public void actionPerformed(ActionEvent event) {
    JFrame frame = new JFrame();
    JDialog dialog = new JDialog(frame, "Account Charges", true);
    JLabel label = new JLabel("Currently calculating the charges")

    dialog.getContentPane().add(label);       //add waiting label
    dialog.setVisible(true);              
    readData(myFile);                         //read file and create table
    dialog.getContentPane().remove(label);    //waiting label no longer needed
    dialog.getContentPane().add(myJtable);    //update dialog with the table
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-11T20:38:28.677

1)`I have a Gui which allows the user to click a button and view the contents of a text file.`

*   使用 CardLayout，如果您确实需要阻止或提供输入掩码以输入/修改/删除已显示或存在的值，我建议您创建另一个容器

2)`The issue is that the file can be rather large (100,000+ rows of data) and can take upwards of 15 seconds to read and display in a table.`

*   除了内部修订，我不认识任何人，可能想要检查或处理 100k 行，使用 SwingWorker 将 FileIO 填充到 TableModel，并为 JTable 创建分页

3) //伪代码

动作执行{

`create frame`- 不是 JFrame re_use existing `JDialog`，当然更好`CardLayout`

`display label that lets user know its creating table`- 不知道让它成为

`read text file`- 使用带有 JProgressBar 的 SwingWorker，转换数据并将其放入 TableModel，每 50 行使用批处理更新 TableModel fe，查找 JTable 的分页，然后您将只显示所需的行数，而不是 100k，这可能很疯狂:-)

`create map and place values`- 可能没用，因为您将所有必需的信息存储在 TableModel 中

`remove label`- 不知道让它成为

`update dialog with table`- Jtable 可以从 SwinWorker 立即更新，Swing GUI 可以访问所有鼠标或键盘输入，无需等待，也不会延迟 10-15 秒

}

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-11T20:33:16.277

`JDialogs`能够在其中容纳组件，例如您正在谈论的桌子。您可以通过添加/删除进度条和标签等组件的方法简单地告诉用户您在做什么`JDialog's getContentPane`，以便通知他们程序正在运行。

另外，如果我错了，请纠正我，但`repaint()`通常是`java.awt`包使用的一种方法，而不是那么多`javax.swing`……仅在某些情况下。

-- 另一种解决方案 -- 您可以在对话框打开之前告诉用户正在发生的事情。也许在 GUI 或进度条上有一个“当前状态”标签。当文件被完全读取并准备好使用时，您可以打开对话框并快速将值发布到表上。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-11T20:40:14.183

使用您的解决方案的最简单方法是`label.setVisible(false)`在您的操作完成后执行。当然，应该制作您的布局管理器（或其他良好的免费设计），以便当标签变得不可见时其他组件可以正确调整大小/重新定位。通常它应该自动发生。

还有其他方法可以做到，但你会花更多的时间来制作它们。

# php - TCPDF 拆分页面与整个 PDF 一样大

> ID：10113125
> 
> 赞同：1
> 
> 时间：2012-04-11T20:06:46.400
> 
> 标签：php, pdf, pdf-generation, tcpdf

使用 TCPDF 创建 PDF 后，我需要将 PDF 拆分为单个 PDF 页面。这是我正在使用的打印服务所必需的。我可以使用 PDFSAM 应用程序做到这一点。它工作得很好。我只有一个大问题。生成的页面每个为 120 MB，而源 PDF（240 页）总共为 130 MB。这些单页太大，无法通过打印服务进行处理。

我将 pdf 生成代码剥离到最低限度，但仍然有同样的问题。这是代码：

```
$this->_pdf = new TCPDF(PDF_PAGE_ORIENTATION, PDF_UNIT, "A5", true, 'UTF-8', false);
$this->_pdf->AddPage();
$this->_pdf->Image($photo_path, 2, 2, 120, 180);

$this->_pdf->AddPage();
$this->_pdf->Image($photo_path, 2, 2, 120, 180);
... repeated code ... 
```

当我使用 Acrobat Pro 拆分 PDF 时，也会出现同样的问题。

有什么建议吗？在我看来，PDF 中的数据覆盖了所有页面或其他内容。

# sql-server - 从最小到最大或按字母顺序对列中的数据进行排序

> ID：10113130
> 
> 赞同：0
> 
> 时间：2012-04-11T20:06:58.983
> 
> 标签：sql-server, sql-server-2008, database-design, sorting

我想通过使用一列对 SQL Server 2008 中的表进行排序，并通过该列排列整个表。类似于按值排序并将排序扩展到整行的 Excel 函数。

例如表组成如下：

```
ID     NameID     Value1     Value2
0      10210      -1         0 
0      3201       -1         1
1      12051      -1         1
1      11210      -1         0
1      3650       -1         0 
```

如果我想通过使用`NameID`列对表进行排序，我将如何去做？是否只能使用某种`SELECT`查询，我将如何在该视图中编辑它？

使用字符串而不是数字的表格也是如此，是否可以从 AZ 或 ZA 排序？

使用 SQL Server 2008。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T20:09:12.047

试试这个

```
SELECT * 
FROM [Your Table Name]
ORDER BY NameID 
```

你也可以这样做

```
SELECT *
FROM [Your Table Name]
ORDER BY NameID DESC 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-11T20:10:45.057

如果我想使用 NameID 列对表进行排序，我将如何去做？

```
SELECT *
FROM yourTable
ORDER BY NameId ASC 
```

或者

```
SELECT *
FROM yourTable
ORDER BY NameId DESC 
```

是否只能使用某种 SELECT 查询，我将如何在该视图中编辑它？

是的，您需要使用`SELECT`查询来获取数据并对其进行排序。如果你想更新它，那么你会使用一个`UPDATE`语句。

使用字符串而不是数字的表格也是如此，是否可以从 AZ 或 ZA 排序？

是的，`ORDER BY`您的子句`SELECT`将适用于数字或字符串。

# php - 随机顺序的可变内容

> ID：10113131
> 
> 赞同：1
> 
> 时间：2012-04-11T20:06:59.793
> 
> 标签：php

我希望每次刷新或访问页面时，此 PHP 变量的内容都会随机排列。

如

```
$test = 'a, b, c, d, e, f'; 
```

我想要随机获取它的最佳方法，例如

```
$test = 'c, b, d, f, a, e';

$test = 'd, e, c, a, f, b'; 
```

有什么解决办法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-11T20:08:59.083

```
$test = 'a, b, c, d, e, f';
$testArray = explode(', ',$test); //explode to array

shuffle($testArray); //shuffle it up

echo implode(', ', $testArray); //show the shuffledlyness 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-11T20:10:25.690

我建议这样的事情：

```
$content = 'a, b, c, d, e, f';
$content = explode(', ', $content);

shuffle($content);

$content = implode(', ', $content);

echo $content; 
```

* * *

这段代码的作用：

*   [`explode`](http://php.net/explode)用 , 等项创建`a`一个数组`b`。`c`
*   [`shuffle`](http://php.net/shuffle)打乱数组
*   [`implode`](http://php.net/implode)在每个项目之间放一个`, `，所以我们得到原始的随机字符串

# asp.net-mvc-3 - 使用最小值和最大值选择查询汽车价格

> ID：10113134
> 
> 赞同：1
> 
> 时间：2012-04-11T20:07:15.850
> 
> 标签：asp.net-mvc-3, linq, entity-framework

尝试创建一个查询，该查询将显示选定价格范围内的待售汽车。

在控制器中，我有以下有效的查询。

```
public ActionResult index (string searchString)
{
if (!String.IsNullOrEmpty(searchString))

 {
 Car = Car.Where(s => s.Car.CarName.Contains(searchString));

 } 
```

价格的最小值和最大值我无法实施。

```
 public ActionResult index ( int min, int max, string searchString )
    {
       if (!String.IsNullOrEmpty(searchString))

      {

    Car = Car.Where(s => s.Car.CarName.Contains(searchString)
    && s.Price >= min && s.Price <= max).OrderBy(s => s.Price);

  ViewBag.minprice = min;
  ViewBag.maxprice = max; 
```

在视图中，我有一个相应的视图袋（最小和最大）下拉列表。

我收到一个错误：

可选参数必须是引用类型、可空类型或声明为可选参数。参数名称：参数

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T21:29:40.947

据推测，您仍在使用旧 URL 访问索引页面。这个旧的 url 不包含你的操作中需要的 min 和 max 参数，所以它正在爆炸。此外，如果您为索引创建了自定义路由，请确保您已重写它们以包含这两个新参数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-12T00:59:30.070

这听起来像是一个路由问题。在默认路由之前，您需要在 global.asax 页面（RegisterRoutes 方法）中添加类似以下内容。

```
routes.MapRoute(
      "IndexCompare", // Route name
      "{controller}/{action}/{min}/{max}/{searchString}", // URL with parameters
      new
      {
          controller = "{controller}",
          action = "Index",
          min = 0,
          max = 0,
          searchString = UrlParameter.Optional
      } // Parameter defaults
); 
```

所以每次你改变一个动作签名时，你需要确保你有一个匹配它的路由。

# java - 使用 ArrayLists 优化 for 循环

> ID：10113135
> 
> 赞同：6
> 
> 时间：2012-04-11T20:07:18.033
> 
> 标签：java, arraylist

从[这篇](http://developer.android.com/guide/practices/design/performance.html#foreach)文章中，

> 手写计数循环大约快 3 倍

比用于迭代数组列表的增强 for 循环。

首先，“手写计数循环”是什么意思？他们没有明确说明这意味着什么。其次，为什么这仅适用于数组列表而不适用于其他集合？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-11T20:11:25.100

> 首先，“手写计数循环”是什么意思？

我想他们的意思是

```
for(int i=0;i<list.size();i++) {
    list.get(i);
} 
```

> 其次，为什么这仅适用于数组列表而不适用于其他集合？

ArrayList 支持高效的随机访问，移除 Iterator 可以带来小的改进。（或者如果你有一个不做任何其他事情的循环，则相对来说会有很大的改进）

对于其他集合，例如 LinkedList，使用迭代器会更快，因为`get(n)`它更慢。对于 Set 没有`get(n)`

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-06-10T07:25:59.660

这个问题的所有答案（在我写这篇文章时有三个答案）都是错误的。

对于 Android，您不应该对手写循环执行此操作！

```
for(int i=0;i<list.size();i++) {
    list.get(i);
} 
```

以上是错误的！

循环必须如下所示（大小被临时复制到它自己的变量中）：

```
int size = list.size();
for(int i=0;i<size;i++) {
    list.get(i);
} 
```

否则循环的每次迭代都会有一个查找惩罚！如果您仔细阅读问题中链接的文章，您会看到谷歌也推荐这种模式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-11T20:09:45.623

手写计数循环看起来像同一篇文章中的`zero()`循环`one()`：

```
List<Foo> foos = new ArrayList<Foo>();
// populate the list...

for (int i=0; i<foos.size(); i++) {
    Foo foo = foos.get(i);
    // do something with foo
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-11T20:10:46.450

这是一个手写的计数循环。他们的意思是您手动编写了一个循环来计算数组中的每个元素。

```
for (int i = 0; i < mArray.length; ++i) { 
```

考虑到它们的底层实现，这适用于数组列表。因为增强的 for 循环必须通用，它不能假设某些事情；例如索引起点和终点。

# javascript - 在 div ASP.NET 的单击事件的 java 脚本中调用服务器端函数

> ID：10113137
> 
> 赞同：1
> 
> 时间：2012-04-11T20:07:21.950
> 
> 标签：javascript, asp.net, vb.net

我有四个网格视图的网页。每个网格都隐藏在 div 标签下。每当用户单击 div 时，就会显示与 div 对应的数据网格。我只在页面加载时将数据绑定到网格视图，因为数据量很大，我无法在页面上加载数据绑定，因为页面加载时间很长。我正在考虑一种方式，即只有当用户单击相应的 div 标签时，网格视图才会加载数据。

请告诉我我们该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T22:38:24.653

您可以使用 jQuery 中的函数 toggle() 来显示/隐藏 div。

使用 jQuery，您还可以在单​​击 div 时添加事件。这个事件应该触发适当的 jQuery 函数。

[http://api.jquery.com/toggle-event/](http://api.jquery.com/toggle-event/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T20:20:30.783

如第一条评论所述，您需要将网格转换为通过 AJAX 加载以实现此目的。

# meteor - 在meteor.com 上拥有一个子域

> ID：10113138
> 
> 赞同：35
> 
> 时间：2012-04-11T20:07:22.737
> 
> 标签：meteor

如果我将我的应用程序发布到子域，例如：spartan.meteor.com，我是否拥有该子域，或者其他用户可以从我这里获取它吗？如果我可以拥有它，是否有一些文档围绕它？

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2012-04-11T20:10:03.600

您可以为您的应用设置部署密码。

```
$ meteor deploy -P spartan.meteor.com 
```

任何未来的部署（或日志请求）都需要相同的密码。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2014-02-25T17:49:13.003

作为更新：

从 Meteor v0.7.1 开始，这不再相关。如果您还没有流星开发者帐户，系统`meteor deploy <site>`会提示您输入电子邮件地址并向您发送创建密码的链接。然后他们有一些关于授权其他用户在你的应用程序上协作的功能。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-11-25T08:59:18.480

我相信现在是：

```
meteor deploy <site> [--password] 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-12-26T19:04:46.290

您的问题还询问是否有任何文件。可在此处获得： http: [//docs.meteor.com/#meteordeploy](http://docs.meteor.com/#meteordeploy)

它涵盖了更改密码等其他内容。它指定`--password`为命令行选项，但`-P`似乎仍然有效。它暗示了即将到来的 Meteor 帐户。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-06-26T11:40:24.263

我认为这个问题是关于流星部署域（SPARTAN.METEOR.COM）中的子域（SPARTAN）是否是您的财产。

我半年前进行了部署，它仍然存在，所以我认为 Meteor 会不时回收子域，但它们肯定会给你很长一段时间。

# sorting - 在 Solr 中提升布尔字段

> ID：10113144
> 
> 赞同：9
> 
> 时间：2012-04-11T20:07:50.690
> 
> 标签：sorting, solr

是否可以在 Solr 中提升布尔字段以使其获得更高的分数？

我们有一个看起来有点像这样的索引：

*   文档 ID
*   标题
*   描述
*   关键词
*   is_reviewed

搜索时，已审核的文档（即 is_reviewed = true）的权重应高于未审核的文档，而不是完全排除它们。

使用`is_review:true^100`似乎不起作用，并排除未审查的项目，而不是仅仅给它们较低的权重。如果有不同的方法可以实现？谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-11T21:30:02.130

一些查询解析器具有专门用于这种用途的功能。例如，dismax 查询解析器有一个[boost 查询`bq`](http://wiki.apache.org/solr/DisMaxQParserPlugin#bq_.28Boost_Query.29)，它允许您通过将其子句添加到原始查询来提升与查询匹配的文档。还有一个[boost 函数`bf`](http://wiki.apache.org/solr/DisMaxQParserPlugin#bf_.28Boost_Functions.29)，它允许您将分数乘以函数的结果。例如，`is_review`作为这个`bf`参数使用，

*   每个未定义字段的文档的分数`is_review`将乘以 0。
*   每个文档的分数，因此`is_review`=`false`将乘以 1。
*   每个文档的分数`is_review`=`true`将乘以 2。

`is_review:true^100``AND`除非您用作[默认查询运算符](http://wiki.apache.org/solr/SchemaXml#Default_query_parser_operator)，否则不应排除未审查的项目。在这种情况下，您可以尝试替换`is_review:true^100`为`(is_review:true^100 OR is_review:false^0)`.

如果您对 dismax 查询解析器的 boost 功能感兴趣，但想坚持使用默认查询解析器，您可以使用[boost 查询解析器](http://lucene.apache.org/solr/api/org/apache/solr/search/BoostQParserPlugin.html)，它允许您将任何查询的分数与任何函数相乘。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-14T17:16:59.207

# 德鲁巴

这是使用 Drupal CMS 的人的解决方案。

首先，在模式浏览器中的 /solr/admin/schema.jsp 中找到您的字段名称

然后，根据您使用的模块，尝试以下示例：

### Apachesolr 模块

代码示例：

```
/**
 * Implements hook_apachesolr_query_alter().
 */
function hook_apachesolr_query_alter(DrupalSolrQueryInterface $query) {
  $query->addParam('bq', array('is_review' =>
    '(is_review:true^100 OR is_review:false^0)'
  ));
} 
```

### 搜索 Solr API 模块

代码示例：

```
/**
 * Implements hook_search_api_solr_query_alter().
 */
function hook_search_api_solr_query_alter(&$call_args, SearchApiQueryInterface $query) {
  $call_args['params']['bq'][] = '(is_review:true^100 OR is_review:false^0)';
} 
```

# php - HTTP 响应-> 获取确切的字节数，然后关闭连接

> ID：10113148
> 
> 赞同：0
> 
> 时间：2012-04-11T20:08:00.247
> 
> 标签：php, http

我遇到了一个愚蠢的问题：我需要获取一定数量的字节，然后关闭连接。我发现我可以从标头中提取“内容长度”，并使用该长度来确定在断开连接之前我应该​​获得多少字节。但是，看来我犯了一个错误。它只获得 40 个字节，而不是 2428（应该如此）。也许我没有正确使用 fgets() ？

这是代码：

```
private static function Send($URL, $Data) {
            $server = parse_url($URL, PHP_URL_HOST);
            $port = parse_url($URL, PHP_URL_PORT);

            // If the parsing the port information fails, we will assume it's on a default port.
            // As such, we'll set the port in the switch below.
            if($port == null) {
                switch(parse_url($URL, PHP_URL_SCHEME)) {
                    case "HTTP":
                        $port = 80;
                        break;
                    case "HTTPS":
                        $port = 443;
                        break;

                }
            }

            // Check if we are using a proxy (debug configuration typically).
            if(\HTTP\HTTPRequests::ProxyEnabled) {
                $server = \HTTP\HTTPRequests::ProxyServer;
                $port = \HTTP\HTTPRequests::ProxyPort;
            }

            // Open a connection to the server.
            $connection = fsockopen($server, $port, $errno, $errstr);
            if (!$connection) {
                die("OMG Ponies!");
            }
            echo "===========================================================<BR>";
            echo "Connection Open<BR>";
            echo "The Time is " . date("H:i:su", time()) . "<BR>";
            echo "Sending Request<BR>";

            fwrite($connection, $Data);

            echo "Request Sent.";
            echo "The Time is " . date("H:i:su", time()) . "<BR>";
            $responseheader = "";
            $responsebody = "";

            /*
            \HTTP\HTTPRequests::$start = NULL;
            \HTTP\HTTPRequests::$timeout = 10;

            // @todo: Rewrite this. Should keep checking for '/r/n/r/n', then check for a content length header. If found, keep grabbing bytes, then close. If not, then close immediately.
            while(!\HTTP\HTTPRequests::safe_feof($connection, \HTTP\HTTPRequests::$start) && (microtime(true) - \HTTP\HTTPRequests::$start) < \HTTP\HTTPRequests::$timeout)
            {
                $response .= fgets($connection);
            }
            */
            echo "Getting Response<BR>";
            echo "The Time is " . date("H:i:su", time()) . "<BR>";
            while(!feof($connection) && !(strlen(strstr($responseheader,"\r\n\r\n"))>0)) {
                $responseheader .= fgets($connection);
            }

            echo "The Header is fully received at " . date("H:i:su", time()) . "<BR>";
            echo "Header (raw):" . "<BR>";
            echo "/////////////////////////////////////////////<BR>";
            echo $responseheader . "<BR>";
            echo "/////////////////////////////////////////////<BR>";

            if((strlen(strstr($responseheader,"Content-Length:"))>0)) {
                $contentlength = ((int)(\Extract\Extract::GetContentLength($responseheader)));
                //for($i = 0; $i < $contentlength; $i++) {
                    $responsebody .= fgets($connection, $contentlength);
                //}
                echo "The Body is fully received at " . date("H:i:su", time()) . "<BR>";
                echo "Body (raw):" . "<BR>";
                echo "{}{}{}{}{}{}{}{}{}{}{}{}{}{}{}{}{}{}{}{}{}{}{}{}<BR>";
                echo $responsebody . "<BR>";
                echo "{}{}{}{}{}{}{}{}{}{}{}{}{}{}{}{}{}{}{}{}{}{}{}{}<BR>";
                echo "<B>!Content length is " . strlen($responsebody) . ". It should be " . $contentlength . "!</B><BR>";
            }

            echo "Response Received.<BR>";
            echo "The Time is " . date("H:i:su", time()) . "<BR>";
            fclose($connection);

            echo "Connection Closed.<BR>";
            echo "The Time is " . date("H:i:su", time()) . "<BR>";
            echo "Exiting Send() method.<BR>";
            echo "===========================================================<BR>";
            echo "<BR>";

            return $responseheader . $responsebody;
        } 
```

这是输出：

```
===========================================================
Connection Open
The Time is 15:57:29000000
Sending Request
Request Sent.The Time is 15:57:29000000
Getting Response
The Time is 15:57:29000000
The Header is fully received at 15:57:29000000
Header (raw):
/////////////////////////////////////////////
HTTP/1.1 207 Multi-Status Date: Wed, 11 Apr 2012 19:57:18 GMT Server: Apache/2.2.8 (Ubuntu) PHP/5.2.4-2ubuntu5.14 with Suhosin-Patch mod_ssl/2.2.8 OpenSSL/0.9.8g mod_wsgi/2.0 Python/2.5.2 mod_perl/2.0.3 Perl/v5.8.8 X-Powered-By: PHP/5.2.4-2ubuntu5.14 DAV: 1, 2, 3, access-control, calendar-access, calendar-schedule DAV: extended-mkcol, calendar-proxy, bind, addressbook, calendar-auto-schedule Content-Location: /davical/caldav.php/rwr26/home/ ETag: "8378ead7e628deafd91ec99dc180ad74" X-DAViCal-Version: DAViCal/0.9.9; DB/1.2.9 Content-Length: 2428 Keep-Alive: timeout=15, max=100 Connection: Keep-Alive Content-Type: text/xml; charset="utf-8" 
/////////////////////////////////////////////
The Body is fully received at 15:57:29000000
Body (raw):
{}{}{}{}{}{}{}{}{}{}{}{}{}{}{}{}{}{}{}{}{}{}{}{}

{}{}{}{}{}{}{}{}{}{}{}{}{}{}{}{}{}{}{}{}{}{}{}{}
!Content length is 40\. It should be 2428!
Response Received.
The Time is 15:57:29000000
Connection Closed.
The Time is 15:57:29000000
Exiting Send() method.
=========================================================== 
```

我为什么要这样做？显然，我遇到了某种超时错误，这使每个连接保持打开状态 30 秒（是的，整整 30 秒）。所以我写了这段代码来获取确切的字节数，然后关闭。任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-21T00:02:16.583

我更改了内容行“$responsebody .= fgets($connection, $contentlength);” 到“$responsebody .= stream_get_line($connection, $contentlength);”。现在事情很糟糕，并且有效。

# c++ - 在点云数据集中解压缩 RGB 值

> ID：10113153
> 
> 赞同：5
> 
> 时间：2012-04-11T20:08:43.460
> 
> 标签：c++, r, point-clouds

这是关于在 pcl 文件中解压缩编码的 rgb 值。我使用 pcl 文档中描述的过程执行此操作，但我得到的解压 rgb 值并不完全正确。当我用 R 绘制它们时，给出的表示与实际设置中的颜色不对应（我在一定程度上确定问题不在于它用 R 绘制的方式）。

例如，在附加的图像中，划定的区域应该有灰色和蓝色（两把椅子和一张桌子）。![使用 R 中的 rgl 库绘制的未打包 pcl 数据](../Images/9604d0b32e39995e9df1d5b5c5f5d017.png)

源 pcl 文件可在以下位置找到：[https](https://docs.google.com/open?id=0Bz5-HVcDiF6SanBZU0JWVmJwWHM) ://docs.google.com/open?id=0Bz5-HVcDiF6SanBZU0JWVmJwWHM ，解压后颜色值的文件位于： [https ://docs.google.com/open?id=0Bz5 -HVcDiF6SV2pYQ0xUbTAwVmM](https://docs.google.com/open?id=0Bz5-HVcDiF6SV2pYQ0xUbTAwVmM)。以下是用于在 ac plus plus 设置中解压缩颜色值的代码：

```
uint32_t rgbD = *reinterpret_cast<int*>(&kinectValue);

    uint16_t rD = (rgbD >> 16) & 0x0000ff;
    uint16_t gD = (rgbD >> 8)  & 0x0000ff;
    uint16_t bD = (rgbD)       & 0x0000ff; 
```

如果您能告诉我哪里出错了，我将不胜感激。

更新：

以下是我在绘制 3D 值时使用的 R 代码片段：

```
library(rgl)
pcd <- read.table(file.choose(),sep="")
names(pcd) <- c("x","y","z","r","g","b")
plot3d(pcd$x,pcd$y,pcd$z,col=rgb(pcd$r,pcd$g,pcd$b,maxColorValue=255)) 
```

更新：

以下是我用 C++ 读取数据的代码：

```
/*
Reads in a file from Kinect with unpacked color values, filter the color value component and
sends it to be unpacked
*/
int fileRead(){

  string line;
  int lineNum = 0;

  ifstream myfile ("res/OnePerson4.pcd");

  if (myfile.is_open())
  {
    while ( myfile.good() )
    {
      lineNum++;
      getline (myfile,line);

       // Exclude the header information in the kinect file from the unpacking process
      //if(lineNum > 10 && lineNum <20){//This for loop is activated when testing
      if(lineNum > 10){
        //Test code to extract the x,y,z values
        string xyzvalFromKinectStr = line.substr(0,line.find_last_of(' '));
        //cout<<xyzvalFromKinectStr<<"\n";
        //Extract the packed rgb value
        string valFromKinectStr = line.substr(line.find_last_of(' '));
        double kinectVal = ::atof(valFromKinectStr.c_str());
        kinectToRgb(kinectVal, xyzvalFromKinectStr);

      }
    }
    myfile.close();
  }
  else
  {
      cout << "Unable to open file";
  }

  return 0;
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-12T15:17:02.617

这是我的工作解决方案。首先，我运行您的输入`grep`以过滤掉坐标中的 NAN：

```
$ grep -v nan OnePerson4.pcd > OnePerson4.pcd.filtered 
```

然后我通过 C++ 代码提取数据，如下所示：

```
#include <stdio.h>

int main()
{
    if (FILE *f = fopen("OnePerson4.pcd.filtered", "rt"))
    {
        for (;;)
        {
            float x = 0;
            float y = 0;
            float z = 0;
            float color_float = 0;
            if (fscanf(f, "%f %f %f %f", &x, &y, &z, &color_float) != 4)
            {
                break;
            }

            unsigned color = *(unsigned const *)&color_float;
            unsigned r = color & 0xff;
            unsigned g = (color >> 8) & 0xff;
            unsigned b = (color >> 16) & 0xff;
            printf("%f,%f,%f,%d,%d,%d\n", x, y, z, r, g, b);
        }

        fclose(f);
    }

    return 0;
} 
```

*我不知道 RGB 以哪个字节顺序存储，因此您可能必须交换 R 和 B。它通常是 RGB 或 BGR。*

然后我用你的代码来绘制点（我改为`read.table`）`read.csv`：

```
library(rgl)
pcd <- read.csv(file.choose())
names(pcd) <- c("x","y","z","r","g","b")
plot3d(pcd$x,pcd$y,pcd$z,col=rgb(pcd$r,pcd$g,pcd$b,maxColorValue=255)) 
```

这就是我得到的：

![在此处输入图像描述](../Images/a87a7e0ad24722d0fa70c0c6894b6a96.png)

所以我假设问题出在您从 pcd 文件中读取颜色的代码上。其余的对我来说都很好。

**更新：**你的问题是`double`类型。将其更改为`float`，它应该可以工作。尽管`unsigned int`按原样存储`float`至少是有问题的。这很脆弱，并不能保证在您阅读后颜色是正确的。有些位可能已关闭。

另一个注意事项：您可以使用`>>`流运算符从文件中提取数字。这比使用`string`方法手动解析要容易得多。[例如，您可以在此处](http://www.cplusplus.com/doc/tutorial/basic_io/)阅读相关内容。

# android - 模拟器因服务中的 GPS 查找而崩溃

> ID：10113160
> 
> 赞同：1
> 
> 时间：2012-04-11T20:09:05.237
> 
> 标签：android, service, gps, broadcastreceiver, emulation

这让我头疼 - 任何帮助将不胜感激！

我从广播接收器启动服务：

```
public class SMSListener extends BroadcastReceiver {
@Override
public void onReceive (Context context, Intent intent) {
Intent i = new Intent(context, LocationService.class);
context.startService(i); 
}
} 
```

我的 LocationService 代码是：

```
package com.someproject.common;
import java.util.Timer;
import java.util.TimerTask;
import android.app.Service;
import android.content.Context;
import android.content.Intent;
import android.location.Location;
import android.location.LocationListener;
import android.location.LocationManager;
import android.os.Bundle;
import android.os.IBinder;
import android.util.Log;

public class LocationService extends Service {

final String TAG = "GPSlocation";
Timer timer1;
LocationManager lm;

String curPhoneNumber = "";
String curSender = "";
boolean gps_enabled = false;
boolean network_enabled = false;
long startTime = 0;
GPSlocator myLocation = new GPSlocator();

@Override
public IBinder onBind(Intent arg0) {
    return null;
}

@Override
public int onStartCommand(Intent intent, int flags, int startId) {
    Log.e(TAG, "onStartCommand");
    super.onStartCommand(intent, flags, startId);

    if (lm == null)
    lm = (LocationManager) this.getApplicationContext().getSystemService(Context.LOCATION_SERVICE);

    // exceptions will be thrown if provider is not permitted.
    try {gps_enabled = lm.isProviderEnabled(LocationManager.GPS_PROVIDER);          } catch (Exception ex) {}
    try {network_enabled = lm.isProviderEnabled(LocationManager.NETWORK_PROVIDER);  } catch (Exception ex) {
    }

    // don't start listeners if no provider is enabled
    if (!gps_enabled && !network_enabled) {
        Log.i(TAG, "No listeners enabled"); // Raise notification
        return 0;
    }

    if (gps_enabled)
        lm.requestLocationUpdates(LocationManager.GPS_PROVIDER, 0, 0, locationListenerGps);
    if (network_enabled)
        lm.requestLocationUpdates(LocationManager.NETWORK_PROVIDER, 0, 0, locationListenerNetwork);

    timer1 = new Timer();
    timer1.schedule(new GetFinalLocation(), 10000);

    return START_STICKY;
}

class GetFinalLocation extends TimerTask {
    @Override
    public void run() {
        Log.i(TAG, "GetFinalLocation");

        lm.removeUpdates(locationListenerGps);
        lm.removeUpdates(locationListenerNetwork);

        Location net_loc = null, gps_loc = null, final_loc = null;
        if (gps_enabled)                gps_loc = lm.getLastKnownLocation(LocationManager.GPS_PROVIDER);
        if (network_enabled)            net_loc = lm.getLastKnownLocation(LocationManager.NETWORK_PROVIDER);

        // Do something with the location here...
    }
}

@Override
public void onCreate() {
    Log.e(TAG, "onCreate");
    super.onCreate();
}

@Override
public void onDestroy() {
    Log.e(TAG, "onDestroy");
    super.onDestroy();
}

LocationListener locationListenerGps = new LocationListener() {
    public void onLocationChanged(Location location) {
    }

    public void onProviderDisabled(String provider) {
    }

    public void onProviderEnabled(String provider) {
    }

    public void onStatusChanged(String provider, int status, Bundle extras) {
    }
};

LocationListener locationListenerNetwork = new LocationListener() {
    public void onLocationChanged(Location location) {
    }

    public void onProviderDisabled(String provider) {
    }

    public void onProviderEnabled(String provider) {
    }

    public void onStatusChanged(String provider, int status, Bundle extras) {
    }
};

} 
```

该服务被调用，但导致模拟器崩溃。我想知道是否...

1.  来自 BroadcastReceiver 的 Context 调用是正确的。
2.  是否存在内存泄漏，因为似乎从未调用 LocationListeners（而且我从未到达 GetFinalLocation 调用）。
3.  或者以这种方式使用 GPS 存在问题。

我花了一整天的时间解决这个问题，但无法弄清楚！

# sql - RODBC - 一个 sqlQuery() 调用中的多个表

> ID：10113162
> 
> 赞同：0
> 
> 时间：2012-04-11T20:09:07.313
> 
> 标签：sql, r, rodbc

我正在使用 RODBC 将数据从现有 SQL 数据库中提取到 R 中。我正在尝试一次调用多个查询/表。

例如：

`test2=sqlQuery(channel,'select top 10 * from bug; select top 10 * from site')`

这仅返回第一个表。我对这样做很感兴趣，因为我想调用一个更复杂的存储过程，其他合作者正在使用并继续开发......这个过程返回 3 个表（在存储过程 (#) 中设置为临时表，以满足我们的其他数据需求/用途）。

所以，当我调用存储过程时，类似于上面的两个查询场景，它只返回第一个表作为结果。

任何建议的解决方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T15:02:15.230

我认为你不能让它在 RODBC 中工作。据我所知，它需要来自数据库的单个结果集。

但是，您可以修改 SQL 以在单个查询中获取这两个值：

```
SELECT  
  (SELECT COUNT(*)
   FROM   bug) AS bugcount,
  (SELECT COUNT(*)
   FROM   site) AS sitecount; 
```

# css - CSS 圆角和阴影在 IE 或 Chrome 中不起作用

> ID：10113170
> 
> 赞同：0
> 
> 时间：2012-04-11T20:09:43.263
> 
> 标签：css

我正在使用 CSS 圆角和阴影，当我通过 Chrome 在 Visual Studio 中通过调试运行它时，它工作得很好，但是当我将它放在服务器上并尝试通过 Chrome 或 IE 通过服务器访问它时，它既不显示阴影也不显示圆角。Visual Studio 提供的服务器端和虚拟服务器之间有什么不同吗？提前感谢您的帮助。

```
.greenborder
{
border-radius: 15px 15px 15px 15px;padding: 8px; border: 2px solid #7F9F1A;
behavior: url(ie-css3.htc);
background-color :White ;
box-shadow: 10px 10px 5px #888;
} 
```

**更新**

```
-moz-border-radius: 15px; /* Firefox */
-webkit-border-radius: 15px; /* Safari, Chrome */
border-radius: 15px 15px 15px 15px; /* CSS3 */

padding: 8px; 
border: 2px solid #7F9F1A;  
behavior: url(ie-css3.htc);
background-color: White;

-webkit-box-shadow: 10px 10px 5px #888;
-moz-box-shadow: 10px 10px 5px #888;
box-shadow: 10px 10px 5px #888; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T23:03:33.530

你可以使用一个很棒的小工具[Prefixer](http://prefixr.com/index.php)来让你的 CSS 跨浏览器。非常易于使用，为我节省了很多时间。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-11T20:17:19.687

您必须使用此样式以使其跨浏览器兼容：

```
.rounded-corners {
  -moz-border-radius: 10px; /* Firefox */
  -webkit-border-radius: 10px; /* Safari, Chrome */
  border-radius: 10px; /* CSS3 */
} 
```

# javascript - Facebook oauth javascript重定向导致无限循环

> ID：10113178
> 
> 赞同：1
> 
> 时间：2012-04-11T20:10:12.773
> 
> 标签：javascript, facebook, facebook-graph-api, facebook-javascript-sdk, facebook-authentication

如果用户删除了我的应用所需的任何权限，我想将用户重定向到 oauth 页面。

由于某种原因，当我尝试从 FB.api 回调函数重定向时，以下代码会导致无限循环。有什么想法可以解决这个问题吗？

```
var perms           = ['publish_actions', 'email', 'user_birthday', 'user_location'],
    permsString     = perms.join(','),
    permissionsUrl  = 'https://www.facebook.com/dialog/oauth';
    permissionsUrl  += '?client_id=' + config.facebook.appId;
    permissionsUrl  += '&redirect_uri=' + encodeURI(canvasUrl);
    permissionsUrl  += '&scope=' + permsString;

    FB.getLoginStatus(function (response) {

        if (response.status === 'connected') {

            FB.api('/me/permissions', function(response) {

                // using underscore here...
                var keys = _.keys(response.data[0]),
                    diff = _.difference(perms, keys);

                // send the user through the auth again if they've removed any of the perms we need
                if (diff.length) {

                    window.location.href = permissionsUrl; // results in an endless redirect loop
                    // window.location.href = 'http://randomwebsite.com'; // does redirect successfully!!!!
                }
            });
        }

    }, true); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-23T14:40:23.947

自从我这样做已经有一段时间了，但是从记忆中我用这样的方法解决了它：

```
var redirectMe = function (link) {
  window.location.href = link;
};

FB.getLoginStatus(function (response) {
    if (response.status === 'connected') {
        FB.api('/me/permissions', function(response) {
            if (true) {
                redirectMe('http://www.browsehappy.com');
            }
        });
    }
}, true); 
```

# php - 从 mysql 表中选择数据并从另一个表中选择相关数据以加入它们

> ID：10113183
> 
> 赞同：1
> 
> 时间：2012-04-11T20:10:30.007
> 
> 标签：php, mysql

我查看了其他问题和答案，但仍然不明白是什么让我来到这里。

我有一个数据库两个表。让我们说数据库中的 table1 和 table2。

我希望从 table1 中获取所有信息，并且只有 table2 中的一列与 table1 中的正确行重合。

我知道是错误的示例：

```
SELECT table1.*, table2.time_stamp FROM table1, table2 
    WHERE table1.ticket_id=$var AND table1.user_id = table2.user_id 
```

基本上从 table1 中选择数据，然后使用所选表中的值从 table2 中获取相关数据并将它们连接起来以将它们作为一个 mysql_query 输出。我确定它很简单，并且之前已经被问过。

编辑：

我没有收到错误。SQL 只是返回注释。其日志形式为：

```
$sqlResults = mysql_query("SELECT table1.* FROM table1 WHERE table1.ticket_id=$var")

while($rowResult = mysql_fetch_array( $sqlResults )) {

$userID = $rowResult['user_id'];

$sqlResults2 = mysql_query("SELECT table2.time_stamp FROM table2 
    WHERE table2.user_id=$userID")

} 
```

我想将它组合成一个 sql 语句，所以我不必为 table1 的每一行点击 table2

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T20:50:23.523

使用 a`JOIN`将 table2 中的行绑定到 table1 中的行：

```
SELECT t1.*, t2.time_stamp FROM table1 t1 
JOIN table2 t2 ON t1.user_id = t2.user_id
WHERE t1.ticket_id=$var 
```

# c - 是否有编译器指令来替换常量的一部分

> ID：10113184
> 
> 赞同：2
> 
> 时间：2012-04-11T20:10:42.867
> 
> 标签：c, compiler-construction, compiler-directives, preprocessor-directive

我现在正在为微控制器使用嵌入式 C，我发现有时有几个外围设备只有一个字母不同（例如 UARTA、UARTB 等）。除了其他相同的寄存器的字母外，每个外围设备的代码通常都是相同的。例如，设置外围 AI 会执行以下操作：

```
UCA2CTL1 |= UCSWRST;                      // Put state machine in reset
UCA2CTL0 |= UCSYNC+UCCKPL+UCMSB;          // 3-pin, 8-bit SPI slave
// Continue initializing peripheral registers with "A" in name 
```

并且设置外设 BI 具有完全相同的代码，除了寄存器名称由 1 个字母转置：

```
UCB2CTL1 |= UCSWRST;                      // Put state machine in reset
UCB2CTL0 |= UCSYNC+UCCKPL+UCMSB;          // 3-pin, 8-bit SPI slave
// Continue initializing peripheral registers with "B" in name 
```

我希望能够更改目标外围设备，而无需#ifdef/复制/粘贴代码或查找/替换。是否有一些编译器指令或巧妙的技巧可以实现这种行为，这样我只需编写一次代码？我很想只 #define 外围设备中的最后一个字母，但类似的东西似乎危险地徘徊在靠近代码的地方，对我来说很臭。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-11T20:21:31.433

这对你有用吗？

```
#define INITUC(device) \
UC ## device ## 2CTL1 |= UCSWRST; \
UC ## device ## 2CTL0 |= UCSYNC+UCCKPL+UCMSB
...
INITUC(A);
INITUC(B); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-11T20:17:57.510

假设这些常量是`const`而不是`defines`你可以做这样的事情：

```
#define MAKECONST(X) const int X ## 1; \
                     const int X ## 0; \
                     X ## 1 |= UCSWRST; \
                     X ## 0 |= UCSYNC+UCCKPL+UCMSB; 
```

进而：

```
MAKECONST(UCA2CTL)
MAKECONST(UCB2CTL) 
```

请注意，我的示例包括声明，我不知道您是否需要，如果不需要，请省略定义的前两行。例如：

```
#define SETUP(X) X ## 1 |= UCSWRST; \
                 X ## 0 |= UCSYNC+UCCKPL+UCMSB; 
```

# http - 如何制作程序来读取从站点发送的数据包？

> ID：10113185
> 
> 赞同：-2
> 
> 时间：2012-04-11T20:10:42.867
> 
> 标签：http, sockets, web-scraping

我想创建一个程序来与站点交互。

如果我打开站点窗口，我希望程序收集站点将传输给我的所有数据，然后我希望我的程序执行数据分析。

我显然不是在寻找一个完整的解释，但我想知道从哪里开始。

最后，我的问题是：

我使用套接字编程吗？有没有办法将该站点的所有数据包路由到我的程序中并将数据包数据转换为可操作的信息？

还是我必须以另一种方式来做？

编辑：我也对Java有些熟悉

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-04-11T20:17:48.253

你说的是网络代理吗？

这是为 Fiddler 编写自己的脚本的开发人员信息：http: [//fiddler2.com/Fiddler/dev/ScriptSamples.asp](http://fiddler2.com/Fiddler/dev/ScriptSamples.asp)

或者

[http://www.charlesproxy.com/](http://www.charlesproxy.com/)

或者如果您需要详细的数据包信息

[http://www.wireshark.org/](http://www.wireshark.org/)

如果您只了解一点 Java，恕我直言，您不会立即自行完成此操作。

# spring - 为什么 Spring Data JPA 会破坏以前工作的 persistence.xml 文件？

> ID：10113187
> 
> 赞同：2
> 
> 时间：2012-04-11T20:10:45.320
> 
> 标签：spring, jpa, spring-data, persistence.xml

我正在尝试将 Spring Data JPA 添加到我的项目中，以便我可以利用 Repositories 接口。

**采取的步骤 - ApplicationContext.xml：**

*   添加`xmlns:jpa="http://www.springframework.org/schema/data/jpa"`到我的 applicationContext.xml 文件的标签中。

    *   添加`http://www.springframework.org/schema/data/jpa http://www.springframework.org/schema/data/jpa/spring-jpa-1.0.xsd`到`xsi:schemaLocation`我的 applicationContext.xml 文件的标签中的定义

    *   添加`<jpa:repositories base-package="com.myproject.persistence" />`为我的 applicationContext.xml 文件的标记的子项

**采取的步骤 - POM**

```
<dependency>
<groupId>org.springframework.data</groupId>
<artifactId>spring-data-jpa</artifactId>
<version>1.0.3.RELEASE</version>
<exclusions>
<exclusion>
<groupId>commons-logging</groupId>
<artifactId>commons-logging</artifactId>
</exclusion>
</exclusions>
</dependency> 
```

这导致我的服务器抱怨**以前很好的 persistence.xml 配置：**

```
org.xml.sax.SAXParseException; lineNumber: 2; columnNumber: 248; cvc-complex-type.3.1: Value '2.0' of attribute 'version' of element 'persistence' is not valid with respect to the corresponding attribute use. Attribute 'version' has a fixed value of '1.0'. 
```

为什么添加 Spring Data JPA 会突然尝试将 JPA 回归到 1.0？！

完整的 POM 如下。

```
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
    <modelVersion>4.0.0</modelVersion>
    <groupId>com</groupId>
    <artifactId>myproject</artifactId>
    <packaging>war</packaging>
    <version>0.1.0.BUILD-SNAPSHOT</version>
    <name>myproject</name>
    <properties>
        <aspectj.version>1.6.12</aspectj.version>
        <java.version>6</java.version>
        <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
        <roo.version>1.2.1.RELEASE</roo.version>
        <slf4j.version>1.6.4</slf4j.version>
        <spring.version>3.1.0.RELEASE</spring.version>
    </properties>
    <repositories>
        <repository>
            <id>spring-maven-release</id>
            <name>Spring Maven Release Repository</name>
            <url>http://maven.springframework.org/release</url>
        </repository>
        <repository> <id>spring-maven-milestone</id> <name>Spring Maven Milestone 
            Repository</name> <url>http://maven.springframework.org/milestone</url>
        </repository>
        <repository>
            <id>spring-roo-repository</id>
            <name>Spring Roo Repository</name>
            <url>http://spring-roo-repository.springsource.org/release</url>
        </repository>
        <repository>
            <id>java.net.m2</id>
            <url>http://download.java.net/maven/2</url>
        </repository>
        <repository>
            <id>prime-repo</id>
            <url>http://repository.primefaces.org</url>
            <name>PrimeFaces Maven Repository</name>
        </repository>
        <repository>
            <id>JBoss Repo</id>
            <url>https://repository.jboss.org/nexus/content/repositories/releases</url>
            <name>JBoss Repo</name>
        </repository>
    </repositories>
    <pluginRepositories>
        <pluginRepository>
            <id>spring-maven-release</id>
            <name>Spring Maven Release Repository</name>
            <url>http://maven.springframework.org/release</url>
        </pluginRepository>
        <pluginRepository>
            <id>spring-maven-milestone</id>
            <name>Spring Maven Milestone Repository</name>
            <url>http://maven.springframework.org/milestone</url>
        </pluginRepository>
        <pluginRepository>
            <id>spring-roo-repository</id>
            <name>Spring Roo Repository</name>
            <url>http://spring-roo-repository.springsource.org/release</url>
        </pluginRepository>
    </pluginRepositories>
    <dependencies>
        <!-- General dependencies for standard applications -->
        <dependency>
            <groupId>junit</groupId>
            <artifactId>junit</artifactId>
            <version>4.10</version>
            <scope>test</scope>
        </dependency>
        <dependency>
            <groupId>log4j</groupId>
            <artifactId>log4j</artifactId>
            <version>1.2.16</version>
        </dependency>
        <dependency>
            <groupId>org.slf4j</groupId>
            <artifactId>slf4j-api</artifactId>
            <version>${slf4j.version}</version>
        </dependency>
        <dependency>
            <groupId>org.slf4j</groupId>
            <artifactId>jcl-over-slf4j</artifactId>
            <version>${slf4j.version}</version>
        </dependency>
        <dependency>
            <groupId>org.slf4j</groupId>
            <artifactId>slf4j-log4j12</artifactId>
            <version>${slf4j.version}</version>
        </dependency>
        <dependency>
            <groupId>org.aspectj</groupId>
            <artifactId>aspectjrt</artifactId>
            <version>${aspectj.version}</version>
        </dependency>
        <dependency>
            <groupId>org.aspectj</groupId>
            <artifactId>aspectjweaver</artifactId>
            <version>${aspectj.version}</version>
        </dependency>
        <dependency>
            <groupId>javax.servlet</groupId>
            <artifactId>servlet-api</artifactId>
            <version>2.5</version>
            <scope>provided</scope>
        </dependency>
        <dependency>
            <groupId>javax.inject</groupId>
            <artifactId>javax.inject</artifactId>
            <version>1</version>
        </dependency>
        <dependency>
            <groupId>net.sf.flexjson</groupId>
            <artifactId>flexjson</artifactId>
            <version>2.1</version>
        </dependency>
        <dependency>
            <groupId>org.apache.commons</groupId>
            <artifactId>commons-lang3</artifactId>
            <version>3.1</version>
        </dependency>
        <!-- ROO dependencies -->
        <dependency>
            <groupId>org.springframework.roo</groupId>
            <artifactId>org.springframework.roo.annotations</artifactId>
            <version>${roo.version}</version>
            <scope>provided</scope>
        </dependency>
        <!-- Spring dependencies -->
        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-core</artifactId>
            <version>${spring.version}</version>
            <exclusions>
                <exclusion>
                    <groupId>commons-logging</groupId>
                    <artifactId>commons-logging</artifactId>
                </exclusion>
            </exclusions>
        </dependency>
        <dependency>
            <groupId>org.springframework.data</groupId>
            <artifactId>spring-data-jpa</artifactId>
            <version>1.0.3.RELEASE</version>
            <exclusions>
                <exclusion>
                    <groupId>commons-logging</groupId>
                    <artifactId>commons-logging</artifactId>
                </exclusion>
            </exclusions>
        </dependency>
        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-test</artifactId>
            <version>${spring.version}</version>
            <scope>test</scope>
        </dependency>
        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-context</artifactId>
            <version>${spring.version}</version>
        </dependency>
        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-aop</artifactId>
            <version>${spring.version}</version>
        </dependency>
        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-aspects</artifactId>
            <version>${spring.version}</version>
        </dependency>
        <dependency>
            <groupId>mysql</groupId>
            <artifactId>mysql-connector-java</artifactId>
            <version>5.1.18</version>
        </dependency>
        <dependency>
            <groupId>org.hibernate</groupId>
            <artifactId>hibernate-core</artifactId>
            <version>3.6.9.Final</version>
        </dependency>
        <dependency>
            <groupId>org.hibernate</groupId>
            <artifactId>hibernate-entitymanager</artifactId>
            <version>3.6.9.Final</version>
            <exclusions>
                <exclusion>
                    <groupId>cglib</groupId>
                    <artifactId>cglib</artifactId>
                </exclusion>
                <exclusion>
                    <groupId>dom4j</groupId>
                    <artifactId>dom4j</artifactId>
                </exclusion>
            </exclusions>
        </dependency>
        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-jpa</artifactId>
            <version>2.0.8</version>
        </dependency>

        <dependency>
            <groupId>org.hibernate.javax.persistence</groupId>
            <artifactId>hibernate-jpa-2.0-api</artifactId>
            <version>1.0.1.Final</version>
        </dependency>
        <dependency>
            <groupId>org.hibernate</groupId>
            <artifactId>hibernate-validator</artifactId>
            <version>4.2.0.Final</version>
            <exclusions>
                <exclusion>
                    <groupId>javax.xml.bind</groupId>
                    <artifactId>jaxb-api</artifactId>
                </exclusion>
                <exclusion>
                    <groupId>com.sun.xml.bind</groupId>
                    <artifactId>jaxb-impl</artifactId>
                </exclusion>
            </exclusions>
        </dependency>
        <dependency>
            <groupId>javax.validation</groupId>
            <artifactId>validation-api</artifactId>
            <version>1.0.0.GA</version>
        </dependency>
        <dependency>
            <groupId>cglib</groupId>
            <artifactId>cglib-nodep</artifactId>
            <version>2.2.2</version>
        </dependency>
        <dependency>
            <groupId>javax.transaction</groupId>
            <artifactId>jta</artifactId>
            <version>1.1</version>
        </dependency>
        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-jdbc</artifactId>
            <version>${spring.version}</version>
        </dependency>
        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-orm</artifactId>
            <version>${spring.version}</version>
        </dependency>
        <dependency>
            <groupId>commons-pool</groupId>
            <artifactId>commons-pool</artifactId>
            <version>1.5.6</version>
        </dependency>
        <dependency>
            <groupId>commons-dbcp</groupId>
            <artifactId>commons-dbcp</artifactId>
            <version>1.3</version>
            <exclusions>
                <exclusion>
                    <groupId>commons-logging</groupId>
                    <artifactId>commons-logging</artifactId>
                </exclusion>
                <exclusion>
                    <groupId>xml-apis</groupId>
                    <artifactId>xml-apis</artifactId>
                </exclusion>
            </exclusions>
        </dependency>
        <dependency>
            <groupId>com.sun.faces</groupId>
            <artifactId>jsf-api</artifactId>
            <version>2.1.2</version>
        </dependency>
        <dependency>
            <groupId>com.sun.faces</groupId>
            <artifactId>jsf-impl</artifactId>
            <version>2.1.2</version>
        </dependency>
        <dependency>
            <groupId>org.primefaces</groupId>
            <artifactId>primefaces</artifactId>
            <version>3.2</version>
        </dependency>
        <dependency>
            <groupId>org.primefaces.themes</groupId>
            <artifactId>south-street</artifactId>
            <version>1.0.3</version>
        </dependency>
        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-web</artifactId>
            <version>${spring.version}</version>
        </dependency>

        <dependency>
            <groupId>javax.el</groupId>
            <artifactId>el-api</artifactId>
            <version>2.2</version>
            <scope>provided</scope>
        </dependency>
        <dependency>
            <groupId>commons-fileupload</groupId>
            <artifactId>commons-fileupload</artifactId>
            <version>1.2.2</version>
        </dependency>
        <dependency>
            <groupId>commons-io</groupId>
            <artifactId>commons-io</artifactId>
            <version>2.1</version>
        </dependency>
        <dependency>
            <groupId>mysql</groupId>
            <artifactId>mysql-connector-java</artifactId>
            <version>5.1.13</version>
            <classifier />
        </dependency>
        <dependency>
            <groupId>org.hibernate</groupId>
            <artifactId>hibernate-core</artifactId>
            <version>3.6.4.Final</version>
            <classifier />
        </dependency>
        <dependency>
            <groupId>org.hibernate</groupId>
            <artifactId>hibernate-entitymanager</artifactId>
            <version>3.6.4.Final</version>
            <classifier />
            <exclusions>
                <exclusion>
                    <groupId>cglib</groupId>
                    <artifactId>cglib</artifactId>
                </exclusion>
                <exclusion>
                    <groupId>dom4j</groupId>
                    <artifactId>dom4j</artifactId>
                </exclusion>
            </exclusions>
        </dependency>
        <dependency>
            <groupId>org.hibernate.javax.persistence</groupId>
            <artifactId>hibernate-jpa-2.0-api</artifactId>
            <version>1.0.0.Final</version>
            <classifier />
        </dependency>
        <dependency>
            <groupId>org.hibernate</groupId>
            <artifactId>hibernate-validator</artifactId>
            <version>4.1.0.Final</version>
            <classifier />
            <exclusions>
                <exclusion>
                    <groupId>javax.xml.bind</groupId>
                    <artifactId>jaxb-api</artifactId>
                </exclusion>
                <exclusion>
                    <groupId>com.sun.xml.bind</groupId>
                    <artifactId>jaxb-impl</artifactId>
                </exclusion>
            </exclusions>
        </dependency>
        <dependency>
            <groupId>cglib</groupId>
            <artifactId>cglib-nodep</artifactId>
            <version>2.2</version>
            <classifier />
        </dependency>
        <dependency>
            <groupId>commons-pool</groupId>
            <artifactId>commons-pool</artifactId>
            <version>1.5.4</version>
            <classifier />
            <exclusions>
                <exclusion>
                    <groupId>commons-logging</groupId>
                    <artifactId>commons-logging</artifactId>
                </exclusion>
            </exclusions>
        </dependency>
    </dependencies>
    <build>
        <plugins>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-war-plugin</artifactId>
                <version>2.1.1</version>
                <!-- <configuration> <webXml>target/web.xml</webXml> </configuration> -->
            </plugin>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-compiler-plugin</artifactId>
                <version>2.3.2</version>
                <configuration>
                    <source>${java.version}</source>
                    <target>${java.version}</target>
                    <encoding>${project.build.sourceEncoding}</encoding>
                </configuration>
            </plugin>
            <plugin>
                <groupId>org.codehaus.mojo</groupId>
                <artifactId>aspectj-maven-plugin</artifactId>
                <version>1.2</version>
                <!-- NB: do not use 1.3 or 1.3.x due to MASPECTJ-90 and do not use 1.4 
                    due to declare parents issue -->
                <dependencies>
                    <!-- NB: You must use Maven 2.0.9 or above or these are ignored (see 
                        MNG-2972) -->
                    <dependency>
                        <groupId>org.aspectj</groupId>
                        <artifactId>aspectjrt</artifactId>
                        <version>${aspectj.version}</version>
                    </dependency>
                    <dependency>
                        <groupId>org.aspectj</groupId>
                        <artifactId>aspectjtools</artifactId>
                        <version>${aspectj.version}</version>
                    </dependency>
                </dependencies>
                <executions>
                    <execution>
                        <goals>
                            <goal>compile</goal>
                            <goal>test-compile</goal>
                        </goals>
                    </execution>
                </executions>
                <configuration>
                    <outxml>true</outxml>
                    <aspectLibraries>
                        <aspectLibrary>
                            <groupId>org.springframework</groupId>
                            <artifactId>spring-aspects</artifactId>
                        </aspectLibrary>
                    </aspectLibraries>
                    <source>${java.version}</source>
                    <target>${java.version}</target>
                </configuration>
            </plugin>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-resources-plugin</artifactId>
                <version>2.5</version>
                <configuration>
                    <encoding>${project.build.sourceEncoding}</encoding>
                </configuration>
            </plugin>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-surefire-plugin</artifactId>
                <version>2.9</version>
                <configuration>
                    <printSummary>false</printSummary>
                    <redirectTestOutputToFile>true</redirectTestOutputToFile>
                    <excludes>
                        <exclude>**/*_Roo_*</exclude>
                    </excludes>
                </configuration>
            </plugin>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-assembly-plugin</artifactId>
                <version>2.2.1</version>
                <configuration>
                    <descriptorRefs>
                        <descriptorRef>jar-with-dependencies</descriptorRef>
                    </descriptorRefs>
                </configuration>
            </plugin>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-deploy-plugin</artifactId>
                <version>2.7</version>
            </plugin>
            <!-- IDE -->
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-eclipse-plugin</artifactId>
                <version>2.7</version>
                <!-- Note 2.8 does not work with AspectJ aspect path -->
                <configuration>
                    <downloadSources>true</downloadSources>
                    <downloadJavadocs>false</downloadJavadocs>
                    <wtpversion>2.0</wtpversion>
                    <additionalBuildcommands>
                        <buildCommand>
                            <name>org.eclipse.ajdt.core.ajbuilder</name>
                            <arguments>
                                <aspectPath>org.springframework.aspects</aspectPath>
                            </arguments>
                        </buildCommand>
                        <buildCommand>
                            <name>org.springframework.ide.eclipse.core.springbuilder</name>
                        </buildCommand>
                    </additionalBuildcommands>
                    <additionalProjectnatures>
                        <projectnature>org.eclipse.ajdt.ui.ajnature</projectnature>
                        <projectnature>com.springsource.sts.roo.core.nature</projectnature>
                        <projectnature>org.springframework.ide.eclipse.core.springnature</projectnature>
                    </additionalProjectnatures>
                </configuration>
            </plugin>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-idea-plugin</artifactId>
                <version>2.2</version>
                <configuration>
                    <downloadSources>true</downloadSources>
                    <dependenciesAsLibraries>true</dependenciesAsLibraries>
                </configuration>
            </plugin>
            <plugin>
                <groupId>org.codehaus.mojo</groupId>
                <artifactId>tomcat-maven-plugin</artifactId>
                <version>1.1</version>
            </plugin>
            <plugin>
                <groupId>org.mortbay.jetty</groupId>
                <artifactId>jetty-maven-plugin</artifactId>
                <version>8.0.1.v20110908</version>
                <configuration>
                    <webAppConfig>
                        <contextPath>/${project.name}</contextPath>
                    </webAppConfig>
                </configuration>
            </plugin>
        </plugins>
    </build>
</project> 
```

编辑：以下持久性提供程序是 Spring Data JPA 的依赖项之一。我已将它们全部添加到我的 POM 的排除列表中。这不起作用！

在 Spring Data 的 POM 中指定的以下持久性提供程序 - 已将它们**全部**添加到排除列表中。还是坏了。

```
<dependency>
<groupId>org.hibernate</groupId>
<artifactId>hibernate-entitymanager</artifactId>
<version>${hibernate.version}</version>
<optional>true</optional>
</dependency>
<dependency>
<groupId>org.eclipse.persistence</groupId>
<artifactId>org.eclipse.persistence.jpa</artifactId>
<version>${eclipselink.version}</version>
<optional>true</optional>
</dependency>
<dependency>
<groupId>org.apache.openjpa</groupId>
<artifactId>openjpa-persistence-jdbc</artifactId>
<version>${openjpa.version}</version>
<optional>true</optional>
<exclusions>
<exclusion>
<groupId>commons-logging</groupId>
<artifactId>commons-logging</artifactId>
</exclusion>
</exclusions>
</dependency> 
```

根据 Eclipse 的 JPA 依赖项：-

![截屏](../Images/41ee84b2b38e80baaf9dbfae607750e4.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T20:13:26.210

检查类路径上是否没有另一个 JPA jar（由 spring-data 或某些忘记的依赖项（hibernate-jpa）或在您的应用程序服务器中拖动）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T10:05:11.750

错误的依赖是 spring-jpa，它实现了 JPA 1，并优先于你的 JPA 2 实现，这里由 hibernate-jpa-2.0-api 表示。你只是不需要它，因为你已经有了 spring-data-jpa 和 hibernate-jpa-2.0-api。只需从 pom.xml 中删除 spring-jpa 依赖项，就可以了。

# c# - 来自 WCF 服务的 XML 中的非嵌套集合元素

> ID：10113189
> 
> 赞同：1
> 
> 时间：2012-04-11T20:10:47.257
> 
> 标签：c#, .net, wcf, soap

我有一个 WCF 方法，它返回一个包含集合的对象，结果如下所示：

```
<getMetadataResult>
            <a:count>3</a:count>
            <a:index>0</a:index>
            <a:mediaCollection>
               <a:mediaCollection>
                  <a:albumArtURI i:nil="true"/>
                  <a:artist i:nil="true"/>
                  <a:artistId i:nil="true"/>
                  ... 
```

不幸的是，我希望它看起来像这样：

```
 <getMetadataResult>
    <index>0</index>
    <count>3</count>
    <total>3</total>
    <mediaCollection>
      <itemType>other</itemType>
      <id>0001</id>
    </mediaCollection>
    <mediaCollection>
      <itemType>other</itemType>
      <id>0002</id>
    </mediaCollection>
    <mediaCollection>
      <itemType>other</itemType>
      <id>0003</id>
    </mediaCollection>
    .... 
```

（我的结果中有一层额外的“mediaCollection”需要去掉）

我不确定如何在 C# 方面实现这一点，因为在类中像这样“浮动”的集合项的想法没有意义（至少对我来说不是）。

我猜也许有一些命名空间调整或我可以在接口合同中应用的一些属性可能会实现这一点，但由于我不确定如何表达我正在寻找的内容，我很难找到它。

# .net - .NET Windows Forms：如何获取其他正在运行的应用程序信息？

> ID：10113191
> 
> 赞同：2
> 
> 时间：2012-04-11T20:10:59.413
> 
> 标签：.net, winforms, c#-4.0

有没有办法获取有关其他正在运行的应用程序的信息？例如：让我的 Windows 窗体应用程序列出所有正在运行的应用程序及其窗口大小。

火狐：（信息在这里）

记事本：（信息在这里）

我想最终平铺所有打开的窗口。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T20:24:26.433

您应该能够通过使用检索当前机器上运行的进程列表

System.Diagnostics.Process.GetProcesses()

[有关更多信息](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.getprocesses.aspx)，请参阅此 msdn 链接

# ios - 为 iOS 4.3 开发的应用程序是否与 5.1 兼容？

> ID：10113200
> 
> 赞同：0
> 
> 时间：2012-04-11T20:11:34.017
> 
> 标签：ios, xcode, ios4, ios5.1

显然，iOS 的最新版本是 5.1。在过去的几个月里，我一直在开发一个 iPad 应用程序。所以我有一台带有 Snow Leopard 的 iMac。现在看来，iOS 5.1 是 iPad 的最新版本。

我的问题是我为 iOS 4.3 开发的应用程序是否仍然与 iOS 5.1 兼容...？

我还意识到我应该将我的 iMac 更新到 OS Lion 才能安装 XCode 4.3.2？这是唯一支持 iOS 5.1 的版本吗？

感谢您的反馈意见！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T20:12:51.070

是的。所有 iOS 版本都向后兼容。

是的。您需要新的 xcode 才能使用 iOS 5.1 SDK。

# javascript - Ajax Bing Maps 第7版-移动和删除图钉-初学者教程

> ID：10113206
> 
> 赞同：4
> 
> 时间：2012-04-11T20:12:03.147
> 
> 标签：javascript, bing-maps

我目前正在学习这些地图。现在我想创建一个方法来更新我的图钉（如果我已经有图钉的话）。

一种。我尝试使用 setLocation(newLocation) 但不幸的是，当我这样做时，我的客户端代码甚至没有到达（我认为代码语法不正确，但在 chrome 上没有给出错误）

湾。然后我尝试学习如何删除它并创建另一个，但我无法从[http://msdn.microsoft.com/en-us/library/gg427610.aspx](http://msdn.microsoft.com/en-us/library/gg427610.aspx)找到任何资源- 也许我搜索得不够好。

谁能为我提供一些关于如何移动图钉以及如何删除图钉的指南？非常非常感谢大家

```
var loc = new Microsoft.Maps.Location(lat, lon);

var pin = new Microsoft.Maps.Pushpin(loc); 
```

* * *

编辑：部分答案

卸下图钉：

```
if (pin != null)
{
    map.entities.remove(pin)
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-11T20:55:04.757

移动图钉，`setLocation()`确实是您需要使用的功能。您是否尝试从地图上的事件处理程序调用 setLocation？如果是这种情况，则事件处理程序可能没有正确设置，因此它永远不会被调用。但是，如果您已经定义了一个图钉（变量名为 myPushpin）并将其插入到地图中，则执行以下代码将移动它：

```
// Move pushpin to "38.0", "-97.0"
var loc = new Microsoft.Maps.Location(38.0, -97.0);
myPushpin.setLocation(loc); 
```

要查看实际效果，请前往[Ajax Bing Maps v7 交互式 SDK](http://www.bingmapsportal.com/ISDK/AjaxV7#Pushpins7)，通过放置不同的坐标修改屏幕中央下方的蓝色代码，点击运行按钮并查看图钉移动。

要删除已添加到地图的图钉，您需要将其从添加它的 EntityCollection 中删除。例如，如果您只是将 Pushpin 插入到 yourmap.entities 中，您可以通过以下方式将其移除：

```
var index = yourmap.entities.indexOf(myPushpin);
if (index != -1) {
    yourmap.entities.removeAt(index);
} 
```

或者您可以直接删除它而不使用索引：

```
yourmap.entities.remove(myPushpin); 
```

更新：要在用户单击图钉时删除它，您基本上必须首先识别在单击事件处理程序中单击的图钉。图钉可以从传递给单击处理程序的[MouseEventArgs](http://msdn.microsoft.com/en-us/library/gg406731.aspx)对象的目标属性中获取：

```
Microsoft.Maps.Events.addHandler(pushpin, 'click', function (mouseEvent) {
    var pushPinThatWasClicked = mouseEvent.target;
    // Do whatever you want with pushPinThatWasClicked 
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-11-14T13:48:46.317

以下函数可以从地图中删除所有图钉：

```
//remove all the pushpins
function deletePushpin()
{
  for(var i=map.entities.getLength()-1;i>=0;i--) 
  {
      var pushpin= map.entities.get(i); 
      if (pushpin instanceof Microsoft.Maps.Pushpin) { 
        map.entities.remove(pushpin);  
      }
   } 
} 
```

# c++ - C++：将 64 位整数与 32 位整数进行比较是否安全？

> ID：10113208
> 
> 赞同：18
> 
> 时间：2012-04-11T20:12:06.183
> 
> 标签：c++

假设我有 2 个变量：

```
uint64_t a = ...

uint32_t b = ... 
```

比较整数会产生预期的结果，即`(a != b)`或`(b > a)`吗？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-04-11T20:14:20.433

没问题。编译器在比较之前将 32 位提升为 64 位

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-04-11T20:14:39.160

简短的回答 - 是的。在比较之前，“较小”会转换为较大的。

# python - 如何决定何时包装/移植/从头开始写入

> ID：10113218
> 
> 赞同：4
> 
> 时间：2012-04-11T20:12:36.400
> 
> 标签：python, wrapper, porting, smalltalk, pharo

我即将在 Smalltalk (Pharo) 中构建一个项目。还有一个我打算使用的python库。现在，有3个选项：

*   那些 python 库的 Smalltalk 包装器
*   将 python 库移植到 Smalltalk
*   从头开始编写库（在 Smalltalk 中）以用于我的项目

以下是我的查询：

1.  移植/包装的“基本”差异是什么（尚未在任何地方找到令人满意的解释）
2.  如何知道何时使用哪一个（在所有三个中）？
3.  任何可以让我获得进一步帮助/启动项目的资源或指针。

谢谢！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-11T21:05:00.650

## 包装器

用本地语言编写函数，其唯一目的是调用外部库中的函数。目标是尽可能少地使用母语。例如，将数据类型从本地语言翻译成外部库语言等。

当外部库为：

*   用比本地代码更高效的语言编写（例如，从 Python 调用的 C++ 库）
*   大/复杂，翻译耗时或容易出错
*   定期更新；在维护良好的库中，接口（您的包装器所关心的）的更改频率将低于功能的实现；因此，如果您对功能有包装，更新到新版本的库应该相当简单

## 移植

端口只是从一种语言到另一种语言的翻译。一般来说，尽可能保持相同的逻辑。

在以下情况下移植是有意义的：

*   本机语言比外部库更高效
*   该库很简单，并且希望节省包装所涉及的开销
*   打算以母语对移植代码进行和维护更改
*   没有计划以自己的语言使用外部库
*   想要学习一种或两种所涉及的语言

## 改写

将 Re-Write 视为具有大量重构的 Port。目标是利用本地语言的特性以某种方式改进库（效率、可读性等）

在与移植相同的所有场景中，重写都是有意义的。决定是做一个简单的移植还是完全重写通常归结为一个问题：

*   有没有更好的方法来用本地语言实现外部库的功能？

# django - sorl.thumbnail 和 s3 将端口 80 添加到 url 并且即使使用 |safe 也对其进行编码

> ID：10113219
> 
> 赞同：1
> 
> 时间：2012-04-11T20:12:37.840
> 
> 标签：django, templates, amazon-s3, sorl-thumbnail

我的网站上有 sorl.thumbnail 模板标签，但模板总是这样渲染它（这是 img 标签搞砸了）：

```
<li>
    <a href="myamazonurl/screenshots/tl-opening.jpg">
        <img src="myamazonurl:80/cache%2F53%2Ff4%2F53f489f64c64ee345301c55b9f8ed0af.jpg">
    </a>
</li> 
```

从我可以看到保存在数据库中的图像具有正确的路径，并且我的媒体 url 也是正确的，因为图像的链接是 100% 好的。这是我的模板代码：

```
{% load thumbnail %}
{% for galleryImage in app.album.screenshots.all %}

{% thumbnail galleryImage.image "92x92" crop="center" colorspace="GRAY" as im %}
<li>
     <a href="{{ MEDIA_URL }}{{ galleryImage.image }}">
         <img src="{{ im.url|safe }}">
     </a>
 </li>
 {% endthumbnail %}
 {% endfor %} 
```

我已经尝试过对所有内容进行 googleing/stacking，但我不知道更多。我不知道端口来自哪里或在哪里配置它。我需要更聪明的人指出正确的方向:)

如果您需要了解更多信息，请告诉我。

PS galleryImage.image 只是一个普通的图像字段

# regex - 将匹配的 Perl 正则表达式保存为变量

> ID：10113225
> 
> 赞同：3
> 
> 时间：2012-04-11T20:13:01.850
> 
> 标签：regex, perl, scripting

我有一个简单的 Perl 正则表达式，需要将其保存为变量。

如果我打印它：

```
print($html_data  =~ m/<iframe id="pdfDocument" src=.(.*)pdf/g); 
```

它打印我想要保存的内容，但是在尝试保存时：

```
$link = $html_data =~ m/<iframe id="pdfDocument" src=.(.*)pdf/g; 
```

我得到一个 '1' 作为 的值`$link`。我认为这是因为它找到了“1”匹配。但是我该如何保存比赛的内容呢？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-11T20:19:27.127

注意 /g 以获取所有匹配项。这些不可能放入标量中。你需要一个数组。

```
my @links = $html_data =~ m/<iframe id="pdfDocument" src=.(.*)pdf/g; 
```

如果你只想要第一场比赛：

```
my ($link) = $html_data =~ m/<iframe id="pdfDocument" src=.(.*)pdf/; 
```

注意括号（以及缺少现在无用的 /g）。您需要他们在列表上下文中调用 m//。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-11T20:17:46.123

模式的匹配子表达式保存在变量`$1`,`$2`等中。您也可以获取整个匹配的模式 ( `$&`)，但这很昂贵，应该避免。

顺便说一下，这里的行为区别是标量与列表上下文的结果。您应该了解它们，它们有何不同，以及它们如何影响各种 Perl 表达式的行为。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-11T23:02:55.047

来自“perlfunc”文档：

print LIST
打印一个字符串或字符串列表。

所以，`print m//`其中 m// 确定
想要的返回值（wantarray？）是一个列表
（它出现在 m// 没有捕获组的情况下返回 1 或 0 匹配通过
或失败，其中 m//g 返回匹配列表） .

和

`$link`= m// 只能是标量（相对于列表）上下文。
因此，m// 返回匹配结果 1（真）或 0（假）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-09-15T17:48:53.530

我只是写了这样的代码。它可能会有所帮助。它基本上和你的一样，除了我的还有几个括号。

```
my $path = `ls -l -d ~/`;
#print "\n path is $path";
($user) = ($path=~/\.*\s+(\w+)\susers/); 
```

因此，如果您尝试存储整个内容，则此示例中的内容可能是这样的？我不确定，但你可以以我的为例。我正在存储 (\w+) 中的任何内容：

```
($link) = ($html_data =~ (m/<iframe id="pdfDocument" src=.(.*)pdf/g)); 
```

# extjs - 如何在我的 Sencha Touch 应用程序中制作静态 TitleBar？

> ID：10113227
> 
> 赞同：2
> 
> 时间：2012-04-11T20:13:05.720
> 
> 标签：extjs, sencha-touch, sencha-touch-2

我想为我的 Sencha Touch 应用程序创建一个标题栏，它保留在应用程序中的每个视图上。该标题栏将带有我的公司徽标和需要随时随地访问的静态选项菜单。

我可以在每个视图上创建这个标题栏，但这似乎不合逻辑。但是，无论是从文档中还是从几个 Google/StackOverflow 搜索中，我都无法确定如何创建另一个视图（或者它可能不考虑视图）并将其包含在每个视图中。（我正在考虑一种类似于在 PHP 中创建单个文件然后将其包含在许多其他页面上的行为。）

有没有人这样做过，你能分享一个精简的例子吗？或者，有人可以在我可能跳过的文档中指出正确的方向吗？我对 Sencha 和 ExtJS 还很陌生，所以对于退伍军人来说似乎很明显的事情可能就在我的脑海里。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T20:57:49.433

在放置所有视图的主视口中，您可以添加标题栏，您可以这样做的一种方法是

```
mainView = Ext.Viewport.add({
            layout: 'card',
            items: [{
                xtype:'home'
            },{
                xtype:'emContact'
            },{
                xtype: 'titlebar',
                docked: 'top',
                title: 'Navigation',
              }]

        }); 
```

# xml - vb.net 附加 xml 项

> ID：10113229
> 
> 赞同：0
> 
> 时间：2012-04-11T20:13:06.640
> 
> 标签：xml, vb.net

我正在尝试将“列”列表附加到此 xml 文件：

```
<?xml version="1.0" encoding="UTF-8"?>
<Conf>
  <name List="A">
    <columns>1</columns>
    <columns>2</columns>
    <columns>3</columns>
    <columns>4</columns>
    <columns>5</columns>
    <columns>6</columns>
  </name>
  <name List="B">
    <columns>1</columns>
    <columns>2</columns>
    <columns>3</columns>
    <columns>4</columns>
    <columns>5</columns>
    <columns>6</columns>
    <columns>9</columns>
  </name>
</Conf> 
```

到目前为止我所拥有的：

```
 Sub NewNodeInXMLFile(ByVal strPath As String, ByVal PriceList As String, ByVal columns As List(Of String))
        Dim XMLd As New XmlDocument
        XMLd.Load(strPath)
        Dim xmlEl As XmlElement = XMLd.CreateElement("name")
        Dim xmlAttr As XmlAttribute = XMLd.CreateAttribute("List")
        xmlAttr.Value = PriceList
        xmlEl.Attributes.Append(xmlAttr)

        For Each x In columns
            xmlEl.InnerXml = "<columns></columns>"
            xmlEl.Item("columns").InnerText = x
'//what goes in here to append this item?
        Next

        XMLd.DocumentElement.AppendChild(xmlEl)
        XMLd.Save(strPath)
    End Sub 
```

基本上，我知道 for each 中的内容不会附加该项目；它只是要写入列表的最后一个值。有没有办法附加这些项目？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T20:34:11.640

试试这个：

```
For Each x In columns 
    Dim newColumn = XMLd.CreateElement("columns")
    newColumn.Value = x
    xmlEl.AppendChild(newColumn)
Next
xml.GetElementsByTagName("PriceFilesConf")[0].AppendChild(xmlEl); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T20:40:52.803

您应该使用 Linq XElement API。更容易使用。但是用下面的代码替换你的循环代码应该可以工作：

```
For Each x In columns
  Dim newElement as XmlElement = XMLd.CreateElement("columns")
  newElement.InnerText = x
  xmlEl.AppendChild(newElement)
Next 
```

您还需要更改：

`XMLd.DocumentElement.AppendChild(xmlEl)` 到：`XMLd.AppendChild(xmlEl)`

# c# - Crystal 报告未从 sqlite 获取数据

> ID：10113233
> 
> 赞同：0
> 
> 时间：2012-04-11T20:13:13.963
> 
> 标签：c#, .net, wpf, sqlite, crystal-reports

我正在尝试将水晶报告与 sqlite 一起使用。开发环境是 windows x64 和 vs2010 x86+x64。Crystal 报告 64 位已安装并且 sqlite 被用作本地程序集并且未安装在 GAC 中。

现在，如果我尝试使用 sqlite 64 位，它会在从 vs 运行时运行，但如果我打包它，那么它会在尝试访问数据库时崩溃。如果我使用 sqlite 32 位，从 vs 运行时一切运行良好，但是当我尝试打包它时，应用程序本身可以正常访问 sqlite db，但水晶报告部分只是一直显示循环等待动画。

知道这里有什么问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T20:37:43.203

在 Crystal Report 中诊断连接问题非常困难。我建议您尝试使用[ADO.NET (XML)](https://developer-content.emc.com/developer/downloads/CrystalReport_ADO_Dataset.pdf)作为连接数据库的方式。

# iphone - 将核心数据结果排序到 NSFetchedResultsController

> ID：10113234
> 
> 赞同：3
> 
> 时间：2012-04-11T20:13:21.537
> 
> 标签：iphone, objective-c, ios, core-data

我有一个`Tag`带有字符串属性的实体`tagName`。我去获取这个实体中的所有对象到一个`NSFetchedResultsController`，但我希望带有`tagName`“Main”的标签成为第一个对象。这就是我现在正在做的事情：

```
 NSFetchRequest *fetchRequest = [[NSFetchRequest alloc] init];
    NSEntityDescription *entity = [NSEntityDescription 
                                   entityForName:@"Tag" inManagedObjectContext:appDelegate.managedObjectContext];

[fetchRequest setEntity:entity];

NSSortDescriptor *lastDescriptor2 =
[[[NSSortDescriptor alloc] initWithKey:@"tagName" ascending:NO comparator:^NSComparisonResult(NSString* tag1, NSString* tag2) {
    NSLog(@"compare");
    if ([tag1 isEqualToString:@"main"]) return NSOrderedAscending;
    if ([tag2 isEqualToString:@"main"]) return NSOrderedDescending;
    return [tag1 compare:tag2];
}] autorelease];  

[fetchRequest setSortDescriptors:[NSArray arrayWithObject:lastDescriptor2]];
NSFetchedResultsController *theFetchedResultsController = [[NSFetchedResultsController alloc] initWithFetchRequest:fetchRequest managedObjectContext:appDelegate.managedObjectContext sectionNameKeyPath:nil cacheName:nil];
self.fetchedResultsController = theFetchedResultsController;
self.fetchedResultsController.delegate=self;   

if (![[self fetchedResultsController] performFetch:&error]) {
    NSLog(@"Unresolved error %@, %@", error, [error userInfo]);
} 
```

这段代码在我的`viewDidLoad`方法中被调用，并且只被调用一次。第一次调用它时，由于某种原因，这里的 sortDescriptor 不适用——它只是没有被调用（`NSLog`语句也没有出现）。我的结果仅根据`BOOL`我指定的值返回`ascending`- 该块被忽略。

但是当我将一个新`Tag`对象插入到`MOC`并`NSFetchedResultsController`调用更新委托方法时，实际的 sortDescriptor 被应用，并且`NSLog(@"compare")`finally 出现，但只有当我对对象进行更新时！无论我尝试了什么，我都无法将排序应用于初始提取。

有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-20T05:39:49.423

正如您可能已经看到的那样，如果您传递给 NSFetchRequest 的谓词是块谓词，那么您的获取请求将失败。发生这种情况是因为 CoreData 需要将您的谓词转换为 SQL，以便它可以针对数据库运行它。结果是谓词永远不会与获取请求产生的对象进行实际比较。

排序描述符也是如此。执行获取时，获取请求不执行与对象的比较。它作为 SQL 的一部分传递。

您还描述了我上面描述的规则的一个有趣的例外。当你有一个现有的 NSFetchedResultsController 并将一个对象添加到 NSManagedObjectContext 时，NSFetchedResultsController 会通过针对对象评估 NSPredicate 和 NSSortDescriptor 来更新，而不是将它们转换为 SQL。

# django - django - 对如何根据本地用户时间定制日期时间模板表示感到困惑

> ID：10113238
> 
> 赞同：2
> 
> 时间：2012-04-11T20:13:31.640
> 
> 标签：django, django-templates, timezone, django-views, pytz

我是一个 django 新手，几天来一直在看这个时区的东西，我仍然很困惑。我现在有一个以 UTC 格式存储在 postgres 数据库中的时区感知日期时间值。但是，当我在模板上将它呈现给用户时，我希望它在用户的时区中呈现。我在模型中有一个指定用户时区的字段，我可以通过视图中的 field = request.user.get_profile() 获取它（我正在使用 django 配置文件）。但是我仍然不确定如何在模板中使用它来显示用户的本地时间。我试过 {{ value.date_time_field | timezone=field.timezone }} 但这不起作用。

有人建议我应该在视图中解决此问题，而不是尝试在模板中执行此操作。我不知道。

任何帮助是极大的赞赏。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-11T20:19:07.323

Django 终于在 1.4 版本中获得了时区功能。尽管您想确保已安装 pytz。

所有日期时间值都将作为 UTC 存储在数据库中。当您在模板中显示日期时间值时，它将被本地化为“活动”时区。默认情况下，除非您激活其他内容，否则它将使用设置文件中的 TIME_ZONE 设置。

如果你想激活另一个时区，只需调用 timezone.activate。例如：

```
from django.utils import timezone
timezone.activate('US/Pacific') 
```

如果您想自动执行此操作，只需编写一个自定义中间件：

```
from django.utils import timezone

class TimezoneMiddleware(object):
    def process_request(self, request):
        timezone.activate(request.user.get_profile().timezone) 
```

然后确保将您的 TimezoneMiddleware 包含在 settings.py 的 MIDDLEWARE_CLASSES 中。

# c# - 文化特定的 DateTime 字符串在平台之间不一致

> ID：10113239
> 
> 赞同：3
> 
> 时间：2012-04-11T20:13:42.593
> 
> 标签：c#, .net, datetime, cultureinfo, currentculture

我有一个测试应用程序，它允许用户从组合框中选择一种文化，并在多行文本框中显示文化特定日期。代码如下：

```
public partial class Form1 : Form
{
    public Form1()
    {
        InitializeComponent();
        comboBox1.Items.AddRange(
            CultureInfo.GetCultures(CultureTypes.SpecificCultures));
    }

    private void comboBox1_SelectedValueChanged(object sender, EventArgs e)
    {
        CultureInfo selectedCulture = comboBox1.SelectedItem as CultureInfo;
        DateTime currentDate = DateTime.Now;

        textBox1.Text =
            "My Date : " + currentDate.ToString() + Environment.NewLine +
            "Culture Specific Date: " + currentDate.ToString(selectedCulture);
    }
} 
```

我注意到如果选择“ar-SA”，阿拉伯语（沙特阿拉伯），那么当我在不同的机器上运行应用程序时，我会看到不同的结果。

在 Windows 7 机器上，文本框显示：

```
我的日期：2012 年 4 月 11 日下午 4:07:09
文化特定日期：19/05/33 04:07:09 م

```

在 Windows XP 机器上，文本框显示：

```
我的日期：2012 年 4 月 11 日下午 4:07:09
文化特定日期：20/05/33 04:07:09 م

```

如您所见，文化特定日期差了一天。什么可能导致这种差异？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-11T20:19:36.633

I *suspect* this is due to the Windows XP machine not receiving up-to-date [adjustments to the Umm al-Qura calendar](http://www.staff.science.uu.nl/~gent0113/islam/ummalqura_converter.htm#adjust), whereas presumably the Windows 7 box is kept up to date, although I wouldn't *expect* those adjustments to affect the current month. Alternatively, it could be due to this:

> Only recently has more information become available which now makes it possible to reconstruct the calendar adopted on the Arabian Peninsula in the recent past and to predict its future course for many years in advance.

... so maybe the Windows XP implementation is out of date.

(That page agrees that it's currently the 19th, by the way.)

# c# - 为什么使用 ICollection 而不是 IEnumerable 或 List 关于多对多/一对多关系？

> ID：10113244
> 
> 赞同：411
> 
> 时间：2012-04-11T20:14:02.593
> 
> 标签：c#, entity-framework, code-first, icollection

我在教程中看到了很多，导航属性为`ICollection<T>`.

这是实体框架的强制性要求吗？我可以使用`IEnumerable`吗？

`ICollection`使用而不是`IEnumerable`甚至是的主要目的是`List<T>`什么？

* * *

## 回答 #1

> 赞同：482
> 
> 时间：2012-04-11T20:20:12.267

通常，您选择什么取决于您需要访问哪些方法。一般来说 - `IEnumerable<>`（MSDN： http: [//msdn.microsoft.com/en-us/library/system.collections.ienumerable.aspx](http://msdn.microsoft.com/en-us/library/system.collections.ienumerable.aspx)）只需要迭代的对象列表，`ICollection<>`（MSDN：[http:// msdn.microsoft.com/en-us/library/92t2ye13.aspx](http://msdn.microsoft.com/en-us/library/92t2ye13.aspx)）查看需要迭代和修改`List<>`的对象列表，查看需要迭代、修改、排序等的对象列表（参见此处完整列表： http: [//msdn.microsoft.com/en-us/library/6sh2ey19.aspx](http://msdn.microsoft.com/en-us/library/6sh2ey19.aspx)）。

从更具体的角度来看，延迟加载与选择类型有关。默认情况下，Entity Framework 中的导航属性带有更改跟踪并且是代理。为了将动态代理创建为导航属性，虚拟类型*必须*实现`ICollection`.

> 表示关系“多”端的导航属性必须返回实现 ICollection 的类型，其中 T 是关系另一端的对象的类型。-[创建 POCO 代理的要求^(MSDN)](http://msdn.microsoft.com/en-us/library/vstudio/dd468057(v=vs.100).aspx)

[有关定义和管理关系^(MSDN的更多信息)](http://msdn.microsoft.com/en-us/library/vstudio/ee373856(v=vs.100).aspx)

* * *

## 回答 #2

> 赞同：100
> 
> 时间：2012-04-11T20:16:29.070

`ICollection<T>`使用该接口是因为该`IEnumerable<T>`接口不提供添加项、删除项或以其他方式修改集合的方式。

* * *

## 回答 #3

> 赞同：66
> 
> 时间：2012-04-11T20:35:57.757

回答您的问题`List<T>`：

`List<T>`是一个类；指定接口允许更大的实现灵活性。一个更好的问题是“为什么不`IList<T>`呢？”

要回答这个问题，请考虑`IList<T>`增加了什么`ICollection<T>`：整数索引，这意味着项目具有任意顺序，并且可以通过引用该顺序来检索。这在大多数情况下可能没有意义，因为项目可能需要在不同的上下文中以不同的方式排序。

* * *

## 回答 #4

> 赞同：31
> 
> 时间：2016-11-02T11:56:37.950

ICollection 和 IEnumerable 之间有一些基本的区别

*   ***IEnumerable*** - 仅包含 GetEnumerator 方法来获取 Enumerator 并允许循环
*   ***ICollection***包含其他方法：Add、Remove、Contains、Count、CopyTo
*   ***ICollection***继承自 IEnumerable
*   使用 ICollection，您可以使用添加/删除等方法修改集合。您无权对 IEnumerable 做同样的事情。

简单程序：

```
using System;
using System.Collections;
using System.Collections.Generic;

namespace StackDemo
{
    class Program 
    {
        static void Main(string[] args)
        {
            List<Person> persons = new List<Person>();
            persons.Add(new Person("John",30));
            persons.Add(new Person("Jack", 27));

            ICollection<Person> personCollection = persons;
            IEnumerable<Person> personEnumeration = persons;

            // IEnumeration
            // IEnumration Contains only GetEnumerator method to get Enumerator and make a looping
            foreach (Person p in personEnumeration)
            {                                   
               Console.WriteLine("Name:{0}, Age:{1}", p.Name, p.Age);
            }

            // ICollection
            // ICollection Add/Remove/Contains/Count/CopyTo
            // ICollection is inherited from IEnumerable
            personCollection.Add(new Person("Tim", 10));

            foreach (Person p in personCollection)
            {
                Console.WriteLine("Name:{0}, Age:{1}", p.Name, p.Age);        
            }
            Console.ReadLine();

        }
    }

    class Person
    {
        public string Name { get; set; }
        public int Age { get; set; }
        public Person(string name, int age)
        {
            this.Name = name;
            this.Age = age;
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：18
> 
> 时间：2015-03-15T13:57:53.373

我是这样记的：

1.  IEnumerable 有一种方法 GetEnumerator()，它允许读取集合中的值，但不能写入。C# 中的 for each 语句为我们处理了使用枚举器的大部分复杂性。IEnumerable 有一个属性：Current，它返回当前元素。

2.  ICollection 实现了 IEnumerable 并添加了一些额外的属性，其中最常用的是 Count。ICollection 的通用版本实现了 Add() 和 Remove() 方法。

3.  IList 实现了 IEnumerable 和 ICollection，并添加了对项目的整数索引访问（这通常不是必需的，因为排序是在数据库中完成的）。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2012-04-11T20:18:27.323

使用的基本思想`ICollection`是提供一个接口来只读访问一些有限数量的数据。事实上，您有一个[ICollection.Count](http://msdn.microsoft.com/en-us/library/system.collections.icollection.count.aspx)属性。`IEnumerable`更适合您在某些逻辑点、消费者明确指定的某些条件或直到枚举结束时读取的某些数据链。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2014-01-24T18:18:19.753

我过去所做的是使用`IList<Class>`,`ICollection<Class>`或`IEnumerable<Class>`（如果是静态列表）声明我的内部类集合，具体取决于我是否必须在存储库中的方法中执行以下任意数量的操作：*枚举、排序/排序或修改*. 当我只需要对对象进行枚举（并且可能对对象进行排序）时，我会创建一个临时对象`List<Class>`来使用 IEnumerable 方法中的集合。我认为这种做法只有在集合相对较小的情况下才会有效，但总的来说它可能是一种很好的做法，idk。如果有证据表明这不是好的做法，请纠正我。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2016-12-27T00:33:01.370

导航属性通常定义为虚拟的，以便它们可以利用某些实体框架功能，例如延迟加载。

如果导航属性可以包含多个实体（如在多对多或一对多关系中），则其类型必须是可以添加、删除和更新条目的列表，例如 ICollection。

[https://www.asp.net/mvc/overview/getting-started/getting-started-with-ef-using-mvc/creating-an-entity-framework-data-model-for-an-asp-net- mvc-应用程序](https://www.asp.net/mvc/overview/getting-started/getting-started-with-ef-using-mvc/creating-an-entity-framework-data-model-for-an-asp-net-mvc-application)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2019-08-10T18:10:38.480

让我们尝试用/按逻辑跳出框框思考，并清楚地理解您问题中的这三个接口：

当某个实例的类实现了 System.Collection.IEnumerable 接口时，简单来说，我们可以说这个实例既是可枚举的又是可迭代的，这意味着这个实例允许以某种方式在单个循环中 go/get/pass/遍历/迭代/遍历此实例包含的所有项目和元素。

这意味着这也可以枚举此实例包含的所有项目和元素。

实现 System.Collection.IEnumerable 接口的每个类也实现 GetEnumerator 方法，该方法不接受任何参数并返回 System.Collections.IEnumerator 实例。

System.Collections.IEnumerator 接口的实例的行为与 C++ 迭代器非常相似。

当某个实例的类实现了 System.Collection.ICollection 接口时，简单来说，我们可以说这个实例是一些事物的集合。

此接口的通用版本，即 System.Collection.Generic.ICollection，提供更多信息，因为此通用接口明确说明集合中事物的类型。

System.Collections.ICollection 接口继承自 System.Collections.IEnumerable 接口，这一切都是合理、合理、合乎逻辑的，因为理论上每个集合也是可枚举和可迭代的，理论上可以遍历所有项目和元素在每个集合中。

System.Collections.ICollection 接口表示一个可变的有限动态集合，这意味着可以从集合中删除现有项目，并且可以将新项目添加到同一集合中。

这解释了为什么 System.Collections.ICollection 接口具有“添加”和“删除”方法。

因为 System.Collections.ICollection 接口的实例是有限集合，所以“有限”这个词意味着这个接口的每个集合中总是有有限数量的项目和元素。

System.Collections.ICollection 接口的属性 Count 应该返回这个数字。

System.Collections.IEnumerable 接口没有 System.Collections.ICollection 接口所具有的这些方法和属性，因为 System.Collections.IEnumerable 将具有 System.Collections.ICollection 接口所具有的这些方法和属性没有任何意义。

逻辑还说，每个既可枚举又可迭代的实例不一定是集合，也不一定是可变的。

当我说可变的时，我的意思是不要立即认为您可以从可枚举和可迭代的东西中添加或删除某些东西。

例如，如果我刚刚创建了一些有限的素数序列，那么这个有限的素数序列确实是 System.Collections.IEnumerable 接口的一个实例，因为现在我可以在一个循环中遍历这个有限序列中的所有素数并对它们中的每一个做任何我想做的事情，比如将它们中的每一个打印到控制台窗口或屏幕上，但是这个有限的素数序列不是 System.Collections.ICollection 接口的实例，因为这对将合数添加到这个有限的素数序列中。

此外，您希望在下一次迭代中获得与当前迭代中当前素数最接近的较大素数，如果是这样，您也不想从这个有限的素数序列中删除现有素数。

此外，您可能希望在 System.Collections.IEnumerable 接口的 GetEnumerator 方法中使用、编码和编写“yield return”以生成素数，而不是在内存堆上分配任何内容，然后将垃圾收集器 (GC) 分配给两者从堆中释放和释放这块内存，因为这显然既浪费了操作系统内存，又降低了性能。

在调用 System.Collections.ICollection 接口的方法和属性时，应该在堆上进行动态内存分配和释放，而不是在调用 System.Collections.IEnumerable 接口的方法和属性时（虽然 System.Collections.IEnumerable 接口只有1 个方法和 0 个属性）。

根据其他人在此 Stack Overflow 网页中所说的，System.Collections.IList 接口仅表示一个**可排序**的集合，这解释了为什么 System.Collections.IList 接口的方法与 System.Collections.ICollection 接口的方法相比使用索引。

简而言之，System.Collections.ICollection 接口并不意味着它的实例是可订购的，但 System.Collections.IList 接口确实暗示了这一点。

理论上有序集是无序集的特例。

这也是有道理的，并解释了为什么 System.Collections.IList 接口继承了 System.Collections.ICollection 接口。

# python - pyparsing 一种查询格式到另一种

> ID：10113245
> 
> 赞同：4
> 
> 时间：2012-04-11T20:14:13.723
> 
> 标签：python, lucene, pyparsing, pubmed

我很茫然。我一直试图让这个工作好几天了。但是我对此无能为力，所以我想我会在这里咨询你们，看看是否有人能够帮助我！

我正在使用 pyparsing 试图将一种查询格式解析为另一种格式。这不是一个简单的转变，但实际上需要一些大脑:)

当前查询如下：

```
("breast neoplasms"[MeSH Terms] OR breast cancer[Acknowledgments] 
OR breast cancer[Figure/Table Caption] OR breast cancer[Section Title] 
OR breast cancer[Body - All Words] OR breast cancer[Title] 
OR breast cancer[Abstract] OR breast cancer[Journal]) 
AND (prevention[Acknowledgments] OR prevention[Figure/Table Caption] 
OR prevention[Section Title] OR prevention[Body - All Words] 
OR prevention[Title] OR prevention[Abstract]) 
```

并且使用 pyparsing 我已经能够获得以下结构：

```
[[[['"', 'breast', 'neoplasms', '"'], ['MeSH', 'Terms']], 'or',
[['breast', 'cancer'], ['Acknowledgments']], 'or', [['breast', 'cancer'],
['Figure/Table', 'Caption']], 'or', [['breast', 'cancer'], ['Section', 
'Title']], 'or', [['breast', 'cancer'], ['Body', '-', 'All', 'Words']], 
'or', [['breast', 'cancer'], ['Title']], 'or', [['breast', 'cancer'], 
['Abstract']], 'or', [['breast', 'cancer'], ['Journal']]], 'and', 
[[['prevention'], ['Acknowledgments']], 'or', [['prevention'], 
['Figure/Table', 'Caption']], 'or', [['prevention'], ['Section', 'Title']], 
'or', [['prevention'], ['Body', '-', 'All', 'Words']], 'or', 
[['prevention'], ['Title']], 'or', [['prevention'], ['Abstract']]]] 
```

但现在，我不知所措。我需要将上述输出格式化为 lucene 搜索查询。以下是有关所需转换的简短示例：

```
"breast neoplasms"[MeSH Terms] --> [['"', 'breast', 'neoplasms', '"'], 
['MeSH', 'Terms']] --> mesh terms: "breast neoplasms" 
```

但我被困在那里。我还需要能够使用特殊词 AND 和 OR。

所以最后的查询可能是：网格术语：“乳房肿瘤”和预防

谁能帮助我并给我一些关于如何解决这个问题的提示？任何形式的帮助将不胜感激。

由于我使用的是pyparsing，所以我很喜欢python。我已经粘贴了下面的代码，这样你就可以玩它而不必从 0 开始！

非常感谢你的帮忙！

```
def PubMedQueryParser():
    word = Word(alphanums +".-/&§")
    complex_structure = Group(Literal('"') + OneOrMore(word) + Literal('"')) + Suppress('[') + Group(OneOrMore(word)) + Suppress(']')
    medium_structure = Group(OneOrMore(word)) + Suppress('[') + Group(OneOrMore(word)) + Suppress(']')
    easy_structure = Group(OneOrMore(word))
    parse_structure = complex_structure | medium_structure | easy_structure
    operators = oneOf("and or", caseless=True)
    expr = Forward()
    atom = Group(parse_structure) + ZeroOrMore(operators + expr)
    atom2 = Group(Suppress('(') + atom + Suppress(')')) + ZeroOrMore(operators + expr) | atom
    expr << atom2
    return expr 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-12T04:56:08.093

好吧，你已经让自己有了一个不错的开始。但是从这里开始，很容易陷入解析器调整的细节中，而且你可能会在这种模式下好几天。让我们从原始查询语法开始逐步解决您的问题。

当你开始这样的项目时，写一个你想要解析的语法的 BNF。它不必非常严格，事实上，这是一个基于我从你的样本中看到的开始：

```
word :: Word('a'-'z', 'A'-'Z', '0'-'9', '.-/&§')
field_qualifier :: '[' word+ ']'
search_term :: (word+ | quoted_string) field_qualifier?
and_op :: 'and'
or_op :: 'or'
and_term :: or_term (and_op or_term)*
or_term :: atom (or_op atom)*
atom :: search_term | ('(' and_term ')') 
```

`word`这非常接近——我们在and 和`and_op`and`or_op`表达式之间存在一些可能的歧义，因为“and”和“or”确实与单词的定义相匹配。我们需要在实施时加强这一点，以确保“癌症或癌或淋巴瘤或黑色素瘤”被解读为由“或”分隔的 4 个不同的搜索词，而不仅仅是一个大词（我认为这是您当前的解析器会做）。我们还获得了识别运算符优先级的好处——也许不是绝对必要的，但我们现在就开始吧。

转换为 pyparsing 很简单：

```
LBRACK,RBRACK,LPAREN,RPAREN = map(Suppress,"[]()")
and_op = CaselessKeyword('and')
or_op = CaselessKeyword('or')
word = Word(alphanums + '.-/&')

field_qualifier = LBRACK + OneOrMore(word) + RBRACK
search_term = ((Group(OneOrMore(word)) | quoted_string)('search_text') + 
               Optional(field_qualifier)('field'))
expr = Forward()
atom = search_term | (LPAREN + expr + RPAREN)
or_term = atom + ZeroOrMore(or_op + atom)
and_term = or_term + ZeroOrMore(and_op + or_term)
expr << and_term 
```

为了解决 'or' 和 'and' 的歧义，我们在单词的开头放置了一个否定的前瞻：

```
word = ~(and_op | or_op) + Word(alphanums + '.-/&') 
```

为了给结果一些结构，包装在`Group`类中：

```
field_qualifier = Group(LBRACK + OneOrMore(word) + RBRACK)
search_term = Group(Group(OneOrMore(word) | quotedString)('search_text') +
                          Optional(field_qualifier)('field'))
expr = Forward()
atom = search_term | (LPAREN + expr + RPAREN)
or_term = Group(atom + ZeroOrMore(or_op + atom))
and_term = Group(or_term + ZeroOrMore(and_op + or_term))
expr << and_term 
```

现在解析您的示例文本：

```
res = expr.parseString(test)
from pprint import pprint
pprint(res.asList()) 
```

给出：

```
[[[[[[['"breast neoplasms"'], ['MeSH', 'Terms']],
     'or',
     [['breast', 'cancer'], ['Acknowledgments']],
     'or',
     [['breast', 'cancer'], ['Figure/Table', 'Caption']],
     'or',
     [['breast', 'cancer'], ['Section', 'Title']],
     'or',
     [['breast', 'cancer'], ['Body', '-', 'All', 'Words']],
     'or',
     [['breast', 'cancer'], ['Title']],
     'or',
     [['breast', 'cancer'], ['Abstract']],
     'or',
     [['breast', 'cancer'], ['Journal']]]]],
  'and',
  [[[[['prevention'], ['Acknowledgments']],
     'or',
     [['prevention'], ['Figure/Table', 'Caption']],
     'or',
     [['prevention'], ['Section', 'Title']],
     'or',
     [['prevention'], ['Body', '-', 'All', 'Words']],
     'or',
     [['prevention'], ['Title']],
     'or',
     [['prevention'], ['Abstract']]]]]]] 
```

实际上，与解析器的结果非常相似。我们现在可以通过这个结构递归并构建新的查询字符串，但我更喜欢使用解析对象来执行此操作，在解析时通过将类定义为令牌容器而不是`Group`s 来创建，然后向类添加行为以获得我们想要的输出。区别在于我们解析的对象标记容器可以具有特定于被解析的表达式类型的行为。

我们将从一个基本抽象类 开始`ParsedObject`，它将解析的标记作为其初始化结构。我们还将添加一个抽象方法 ，`queryString`我们将在所有派生类中实现它以创建您想要的输出：

```
class ParsedObject(object):
    def __init__(self, tokens):
        self.tokens = tokens
    def queryString(self):
        '''Abstract method to be overridden in subclasses''' 
```

现在我们可以从这个类派生，并且任何子类都可以用作定义语法的解析动作。

当我们这样做时，`Group`为结构添加的 s 会妨碍我们，所以我们将在没有它们的情况下重新定义原始解析器：

```
search_term = Group(OneOrMore(word) | quotedString)('search_text') + 
                    Optional(field_qualifier)('field')
atom = search_term | (LPAREN + expr + RPAREN)
or_term = atom + ZeroOrMore(or_op + atom)
and_term = or_term + ZeroOrMore(and_op + or_term)
expr << and_term 
```

现在我们实现类 for `search_term`，`self.tokens`用于访问输入字符串中的解析位：

```
class SearchTerm(ParsedObject):
    def queryString(self):
        text = ' '.join(self.tokens.search_text)
        if self.tokens.field:
            return '%s: %s' % (' '.join(f.lower() 
                                        for f in self.tokens.field[0]),text)
        else:
            return text
search_term.setParseAction(SearchTerm) 
```

接下来我们将实现`and_term`and`or_term`表达式。两者都是二元运算符，仅在输出查询中产生的运算符字符串不同，因此我们可以只定义一个类并让它们为各自的运算符字符串提供一个类常量：

```
class BinaryOperation(ParsedObject):
    def queryString(self):
        joinstr = ' %s ' % self.op
        return joinstr.join(t.queryString() for t in self.tokens[0::2])
class OrOperation(BinaryOperation):
    op = "OR"
class AndOperation(BinaryOperation):
    op = "AND"
or_term.setParseAction(OrOperation)
and_term.setParseAction(AndOperation) 
```

请注意，pyparsing 与传统解析器略有不同——我们`BinaryOperation`将匹配“a or b or c”作为单个表达式，而不是作为嵌套对“(a or b) or c”。所以我们必须使用 stepping slice 重新加入所有的术语`[0::2]`。

最后，我们添加一个解析动作，通过将所有表达式包装在 () 中来反映任何嵌套：

```
class Expr(ParsedObject):
    def queryString(self):
        return '(%s)' % self.tokens[0].queryString()
expr.setParseAction(Expr) 
```

为方便起见，以下是一个副本/可粘贴块中的整个解析器：

```
from pyparsing import *

LBRACK,RBRACK,LPAREN,RPAREN = map(Suppress,"[]()")
and_op = CaselessKeyword('and')
or_op = CaselessKeyword('or')
word = ~(and_op | or_op) + Word(alphanums + '.-/&')
field_qualifier = Group(LBRACK + OneOrMore(word) + RBRACK)

search_term = (Group(OneOrMore(word) | quotedString)('search_text') + 
               Optional(field_qualifier)('field'))
expr = Forward()
atom = search_term | (LPAREN + expr + RPAREN)
or_term = atom + ZeroOrMore(or_op + atom)
and_term = or_term + ZeroOrMore(and_op + or_term)
expr << and_term

# define classes for parsed structure
class ParsedObject(object):
    def __init__(self, tokens):
        self.tokens = tokens
    def queryString(self):
        '''Abstract method to be overridden in subclasses'''

class SearchTerm(ParsedObject):
    def queryString(self):
        text = ' '.join(self.tokens.search_text)
        if self.tokens.field:
            return '%s: %s' % (' '.join(f.lower() 
                                        for f in self.tokens.field[0]),text)
        else:
            return text
search_term.setParseAction(SearchTerm)

class BinaryOperation(ParsedObject):
    def queryString(self):
        joinstr = ' %s ' % self.op
        return joinstr.join(t.queryString() 
                                for t in self.tokens[0::2])
class OrOperation(BinaryOperation):
    op = "OR"
class AndOperation(BinaryOperation):
    op = "AND"
or_term.setParseAction(OrOperation)
and_term.setParseAction(AndOperation)

class Expr(ParsedObject):
    def queryString(self):
        return '(%s)' % self.tokens[0].queryString()
expr.setParseAction(Expr)

test = """("breast neoplasms"[MeSH Terms] OR breast cancer[Acknowledgments]  
OR breast cancer[Figure/Table Caption] OR breast cancer[Section Title]  
OR breast cancer[Body - All Words] OR breast cancer[Title]  
OR breast cancer[Abstract] OR breast cancer[Journal])  
AND (prevention[Acknowledgments] OR prevention[Figure/Table Caption]  
OR prevention[Section Title] OR prevention[Body - All Words]  
OR prevention[Title] OR prevention[Abstract])"""

res = expr.parseString(test)[0]
print res.queryString() 
```

打印以下内容：

```
((mesh terms: "breast neoplasms" OR acknowledgments: breast cancer OR 
  figure/table caption: breast cancer OR section title: breast cancer OR 
  body - all words: breast cancer OR title: breast cancer OR 
  abstract: breast cancer OR journal: breast cancer) AND 
 (acknowledgments: prevention OR figure/table caption: prevention OR 
  section title: prevention OR body - all words: prevention OR 
  title: prevention OR abstract: prevention)) 
```

我猜你需要收紧一些输出 - 那些 lucene 标签名称看起来很模棱两可 - 我只是在关注你发布的示例。但是您不必对解析器进行太多更改，只需调整`queryString`附加类的方法即可。

作为海报的附加练习：在您的查询语言中添加对 NOT 布尔运算符的支持。

# macos - 在没有 MAMP 的 OS X 上本地安装 wordpress（权限错误）

> ID：10113252
> 
> 赞同：0
> 
> 时间：2012-04-11T20:14:52.397
> 
> 标签：macos, apache, wordpress, permissions, local

我正在尝试在没有安装 MAMP 的情况下使用内置的东西（apache/php）在 Mac 上本地安装 wordpress。基本上我正在关注本教程：

[https://gist.github.com/1500117](https://gist.github.com/1500117)

编辑 httpd.conf 文件并重新启动 apache 后，我在浏览器中收到此错误：

```
Forbidden
You don't have permission to access / on this server. 
```

有任何想法吗？我正在使用雪豹

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T09:58:32.893

好吧，我找到了导致问题的原因。我放置wordpress文件夹的站点文件夹的权限为750，将其更改为751后，现在可以使用了。这是一个适当的解决方案还是我应该继续挖掘？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T22:47:54.683

虽然这里有很多变量需要检查，但最大的两个是服务器根目录（确保所有路径元素的大小写正确）和 WordPress 文件本身的用户权限/所有者。

说了这么多，为什么不在这种情况下使用 MAMP 呢？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-11T22:51:06.050

尝试输入[http://your-host-name/index.php](http://your-host-name/index.php)

如果这样可以解决问题，那么您的 DirectoryIndex 指令（在 httpd.conf 中）需要更改为 DirectoryIndex index.html index.php

如果这不能解决问题，请在控制台中键入 tail -f /var/log/apache2/error_log 并查看终端屏幕，同时在浏览器中点击[http://your-host-name/index.php 。](http://your-host-name/index.php)它可能会告诉您问题所在。如果没有，请将日志文件的最后几行粘贴到此处，我会为您查看。

# javascript - 如何在页面顶部修复导航栏并使其在页面滚动时保留在那里

> ID：10113253
> 
> 赞同：0
> 
> 时间：2012-04-11T20:14:54.700
> 
> 标签：javascript, jquery, html, css, position

当我使用...

```
<div id="stay">
<%= render 'layouts/navbar' %>
</div>

#stay ul.TabNav {
     background: #FFFFFF;
     border-bottom:solid 2px #00E5EE;
     padding:0 0px;
     font-size:13px;
     overflow:hidden;
     background:-moz-linear-gradient(0% 100% 90deg,#FAFAFA, #FFF);
     background:-webkit-gradient(linear, 0% 0%, 0% 100%, from(#FAFAFA), to(#FFF));
     position:relative;
     top:0px;
} 
```

...它完美地固定在顶部..

而且我想让它保持在顶部，这样当页面向下滚动时，它会保持在顶部，并且看起来就像它在滚动时随着页面向下浮动一样。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T20:29:05.197

使用`position: fixed; top: 0;`并确保您的 html 具有 doctype

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T20:18:59.813

我建议你看看这个，并使用一些 jquery 让它保持

这是一个让您入门的教程

[http://net.tutsplus.com/tutorials/html-css-techniques/creating-a-floating-html-menu-using-jquery-and-css/](http://net.tutsplus.com/tutorials/html-css-techniques/creating-a-floating-html-menu-using-jquery-and-css/)

# polymorphism - 变形代码示例

> ID：10113254
> 
> 赞同：38
> 
> 时间：2012-04-11T20:14:57.443
> 
> 标签：polymorphism

我了解[多态](http://en.wikipedia.org/wiki/Polymorphic_code)代码和[变形](http://en.wikipedia.org/wiki/Metamorphic_code)代码的概念，但我最近阅读了这两种代码的 Wikipedia 页面（出于某种原因，我以前没有这样做过！）。现在我真的很想为自己写一些变质的代码。

我是一个不会语言的大师，只是涉足许多语言。我知道一些 PHP、MySQL、c/c++、Java、Bash 脚本、Visual Basic 6、VBScripting、Perl、JavaScript。

任何人都可以提供任何这些语言**的变形代码示例。**我希望看到一个工作示例，即使程序的输出只是“Hello World”，以通过示例了解这是如何发生的（我正在努力理论化如何仅通过心理思考来实现这些技术）。任何语言都可以，这些只是首选语言。

此外，在互联网上搜索仅返回有限数量的 c/c++ 示例（甚至没有完整的工作示例，更多部分代码片段），是因为我建议的其他语言级别不够低，无法拥有强大的功能/制作变形代码所需的灵活性？

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2013-05-04T23:43:47.883

下面是一个我认为会被归类为用 C 编写的变形代码的示例。恐怕我没有太多编写可移植 C 代码的经验，因此可能需要进行一些修改才能在其他平台上编译（I' m 在 Windows 上使用旧版本的 Borland）。此外，它依赖于 x86 的目标平台，因为它涉及一些机器代码生成。理论上它应该可以在任何 x86 操作系统上编译。

**这个怎么运作**

每次程序运行时，它都会生成一个随机修改的自身副本，文件名不同。它还打印出已修改的偏移量列表，以便您可以看到它实际在做什么。

修改过程非常简单。源代码只是用汇编指令序列解释，实际上什么都不做。当程序运行时，它会找到这些序列并随机用不同的代码替换它们（这显然也不做任何事情）。

对于其他人需要能够编译的东西，硬编码偏移列表显然是不现实的，因此序列的生成方式使得它们在通过目标代码的搜索中易于识别，希望不会匹配任何误报.

每个序列都以对某个寄存器的推送操作开始，一组修改该寄存器的指令，然后是弹出操作以将寄存器恢复为其初始值。为简单起见，在原始源中，所有序列都只是`PUSH EAX`、八个`NOP`s 和`POP EAX`。然而，在应用程序的所有后续版本中，序列将完全是随机的。

**解释代码**

我已将代码分成多个部分，因此我可以尝试逐步解释它。如果你想自己编译它，你只需要将所有部分连接在一起。

首先一些相当标准的包括：

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <ctype.h> 
```

接下来我们定义了各种 x86 操作码。这些通常会与其他值组合以生成完整的指令。例如，`PUSH`define( `0x50`) 本身是`PUSH EAX`，但您可以通过添加 0 到 7 范围内的偏移量来导出其他寄存器的值。`POP`和 也是如此`MOV`。

```
#define PUSH 0x50
#define POP  0x58
#define MOV  0xB8
#define NOP  0x90 
```

最后六个是几个两字节操作码的前缀字节。第二个字节对操作数进行编码，稍后将更详细地解释。

```
#define ADD  0x01
#define AND  0x21
#define XOR  0x31
#define OR   0x09
#define SBB  0x19
#define SUB  0x29

const unsigned char prefixes[] = { ADD,AND,XOR,OR,SBB,SUB,0 }; 
```

*`JUNK`*是一个宏，可以在代码中任何我们想要的地方插入我们的垃圾操作序列。正如我之前解释的，它最初只是写出`PUSH EAX`,`NOP`和`POP EAX`. *`JUNKLEN`*是该`NOP`序列中 s 的数量 - 不是序列的全长。

如果您不知道，`__emit__`这是一个将文字值直接注入目标代码的伪函数。如果您使用不同的编译器，我怀疑它可能是您需要移植的东西。

```
#define JUNK __emit__(PUSH,NOP,NOP,NOP,NOP,NOP,NOP,NOP,NOP,POP)
#define JUNKLEN 8 
```

将加载我们的代码的一些全局变量。全局变量不好，但我不是一个特别好的编码器。

```
unsigned char *code;
int codelen; 
```

接下来我们有一个简单的函数，它将我们的目标代码读入内存。我从不释放那段记忆，因为我不在乎。

注意*`JUNK`*在随机点插入的宏调用。您将在整个代码中看到更多这样的内容。您几乎可以在任何地方插入它们，但是如果您使用的是真正的 C 编译器（而不是 C++），如果您尝试将它们放在变量声明之前或之间，它会报错。

```
void readcode(const char *filename) {
  FILE *fp = fopen(filename, "rb");    JUNK;
  fseek(fp, 0L, SEEK_END);             JUNK;
  codelen = ftell(fp);
  code = malloc(codelen);              JUNK;
  fseek(fp, 0L, SEEK_SET);
  fread(code, codelen, 1, fp);         JUNK;
} 
```

另一个简单的函数，用于在修改后再次写出应用程序。对于新文件名，我们只需将原始文件名的最后一个字符替换为每次递增的数字。没有尝试检查文件是否已经存在以及我们没有覆盖操作系统的关键部分。

```
void writecode(const char *filename) {
  FILE *fp;
  int lastoffset = strlen(filename)-1;
  char lastchar = filename[lastoffset];
  char *newfilename = strdup(filename);  JUNK;
  lastchar = '0'+(isdigit(lastchar)?(lastchar-'0'+1)%10:0);
  newfilename[lastoffset] = lastchar;
  fp = fopen(newfilename, "wb");         JUNK;
  fwrite(code, codelen, 1, fp);          JUNK;
  fclose(fp);
  free(newfilename);
} 
```

下一个函数为我们的垃圾序列写出一条随机指令。*reg*参数表示我们正在使用的寄存器 - 将在序列的任一端推送和弹出的内容。*偏移量*是代码中将写入指令的偏移量。*空间*给出了我们在序列中剩下的字节数。

根据我们有多少空间，我们可能会限制我们可以写出哪些指令，否则我们会随机选择它是 a`NOP`还是其他指令`MOV`之一。`NOP`只是一个字节。MOV 是 5 个字节：我们的 MOV 操作码（添加了*reg*参数）和 4 个随机字节，表示移入寄存器的数字。

对于两个字节序列，第一个只是我们随机选择的一个前缀。第二个字节是最低有效 3 位表示主寄存器的范围内的字节`0xC0`-`0xFF`即必须设置为我们*`reg`*参数的值。

```
int writeinstruction(unsigned reg, int offset, int space) {
  if (space < 2) {
    code[offset] = NOP;                         JUNK;
    return 1;
  }
  else if (space < 5 || rand()%2 == 0) {
    code[offset] = prefixes[rand()%6];          JUNK;
    code[offset+1] = 0xC0 + rand()%8*8 + reg;   JUNK;
    return 2;
  }
  else {
    code[offset] = MOV+reg;                     JUNK;
    *(short*)(code+offset+1) = rand();
    *(short*)(code+offset+3) = rand();          JUNK;
    return 5;
  }
} 
```

现在我们有了读回这些指令之一的等效函数。假设我们已经在序列的任一端识别出*`reg`*from `PUSH`and`POP`操作，该函数可以尝试验证给定指令是否*`offset`*是我们的垃圾操作之一，以及主寄存器是否与给定*`reg`*参数匹配。

如果找到有效匹配，则返回指令长度，否则返回零。

```
int readinstruction(unsigned reg, int offset) {
  unsigned c1 = code[offset];
  if (c1 == NOP)
    return 1;                     JUNK;
  if (c1 == MOV+reg)
    return 5;                     JUNK;
  if (strchr(prefixes,c1)) {
    unsigned c2 = code[offset+1]; JUNK;
    if (c2 >= 0xC0 && c2 <= 0xFF && (c2&7) == reg)
      return 2;                   JUNK;
  }                               JUNK;
  return 0;
} 
```

下一个函数是搜索和替换垃圾序列的主循环。它首先在八个字节后（或任何设置的）上查找`PUSH`操作码，然后`POP`在同一寄存器上查找操作码。*`JUNKLEN`*

```
void replacejunk(void) {
  int i, j, inc, space;
  srand(time(NULL));                                 JUNK;

  for (i = 0; i < codelen-JUNKLEN-2; i++) {
    unsigned start = code[i];
    unsigned end = code[i+JUNKLEN+1];
    unsigned reg = start-PUSH;

    if (start < PUSH || start >= PUSH+8) continue;   JUNK;
    if (end != POP+reg) continue;                    JUNK; 
```

如果寄存器结果是`ESP`，我们可以安全地跳过它，因为我们永远不会`ESP`在生成的代码中使用它（堆栈操作`ESP`需要特殊考虑，不值得努力）。

```
 if (reg == 4) continue; /* register 4 is ESP */ 
```

一旦我们匹配了一个看起来很可能的 PUSH 和`POP`组合，我们就会尝试阅读其间的说明。如果我们成功匹配了我们期望的字节长度，我们认为这是一个可以替换的匹配。

```
 j = 0;                                           JUNK;
    while (inc = readinstruction(reg,i+1+j)) j += inc;
    if (j != JUNKLEN) continue;                      JUNK; 
```

然后，我们随机选择 7 个寄存器中的一个（如在我们不考虑之前解释的那样`ESP`），并在序列的任一端写出该寄存器的`PUSH`and`POP`操作。

```
 reg = rand()%7;                                  JUNK;
    reg += (reg >= 4);
    code[i] = PUSH+reg;                              JUNK;
    code[i+JUNKLEN+1] = POP+reg;                     JUNK; 
```

然后我们需要做的就是使用我们的*`writeinstruction`*函数填充中间的空间。

```
 space = JUNKLEN;
    j = 0;                                           JUNK;
    while (space) {
      inc = writeinstruction(reg,i+1+j,space);       JUNK;
      j += inc;
      space -= inc;                                  JUNK;
    } 
```

这里是我们显示刚刚修补的偏移量的地方。

```
 printf("%d\n",i);                                JUNK;
  }
} 
```

最后我们有了主函数。这只是调用前面描述的函数。我们读入代码，替换掉垃圾，然后再写出来。`argv[0]`参数包含应用程序文件名。

```
int main(int argc, char* argv[]) {

  readcode(argv[0]);     JUNK;
  replacejunk();         JUNK;
  writecode(argv[0]);    JUNK;

  return 0;
} 
```

这就是它的全部。

**一些最后的笔记**

运行此代码时，显然您需要确保用户具有在与原始代码相同的位置写出文件的适当权限。然后，一旦生成了新文件，如果您在文件扩展名很重要的系统上，通常需要重命名它，或者如果需要，设置其执行属性。

最后，我怀疑您可能希望通过调试器运行生成的代码，而不是直接执行它并希望获得最好的结果。我发现如果我将生成的文件复制到原始可执行文件上，调试器很乐意让我在查看原始源代码的同时单步执行它。然后，每当您到达代码中的某个点*JUNK*时，您可以弹出到程序集视图并查看已生成的代码。

无论如何，我希望我的解释已经相当清楚，这就是你正在寻找的那种例子。如果您有任何问题，请随时在评论中提问。

**奖金更新**

作为奖励，我想我还会在脚本语言中包含一个变形代码的示例。这与 C 示例完全不同，因为在这种情况下，我们需要修改源代码，而不是二进制可执行文件，我认为这更容易一些。

在这个例子中，我大量使用了 php 的`goto`函数。每行都以一个标签开始，并以`goto`指向下一行的标签结束。这样每一行基本上都是独立的，我们可以愉快地打乱它们，并且仍然让程序像以前一样工作。

条件和循环结构稍微复杂一些，但它们只需要以跳转到两个不同标签之一的条件的形式重写。我在代码中包含了注释标记，循环将尝试使其更容易遵循。

[ideone.com 上的示例代码](http://ideone.com/WbEQkJ)

代码所做的只是回显其自身的洗牌副本，因此您只需将输出剪切并粘贴回源字段并再次运行即可轻松地在 ideone 上对其进行测试。

如果您希望它发生更多变异，那么每次运行代码时都可以很容易地使用一组不同的随机字符串替换所有标签和变量。但我认为最好尽量让事情尽可能简单。这些例子只是为了演示这个概念——我们实际上并不是在试图避免被发现。:)

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2012-08-05T05:03:11.183

***公开可用的变形代码示例受到以下几个因素的限制：***

*   **1) 专长：**变形编码是计算机编程中极为先进的技术。能够编写适合采样的连贯和干净的变形代码的程序员数量非常少。

*   **2）财务激励：**变形编码在商业应用中的用途有限。正因为如此，拥有足够技能来创建变形代码的程序员的数量没有专业的接触/激励来创建/学习变形编码技术。

*   **3) 合法性：**变形编码在强大的病毒创建中有很大的应用。因此，任何创建变形代码的负责任的专业人员在自由分发样本时都会遇到道德问题，因为 ametuer 黑客可能能够使用该代码来增强恶意攻击。相反，任何有能力创建变形代码的黑客都没有动力宣传他的技能，如果他的一次攻击被发现，因为他将根据能力被列入一个非常短的嫌疑人名单。

*   **4) 保密：**最后，也可能是变形代码如此难以找到最现实的原因是因为任何在变形编程方面表现出能力并且未被当局因网络犯罪逮捕的程序员都可能被政府安全机构招募、私人安全公司或反病毒公司以及程序员随后的研究/知识将受到保密协议的约束，以保持竞争优势。

***为什么只有`C/C++`例子？***

您提到仅找到`C/C++`多/变形编程的代码示例，并推断只有接近硬件的语言才能是多/变形的。这对于多/变形代码的最严格定义是正确的。解释语言可以具有多/变形行为，但依赖于静态编译的解释器来执行，因此大部分“运行时签名”是不可变的。只有编译的低级语言才能提供​​计算灵活性以具有高度可变的“运行时间签名”。

这是我编写的一些“多态”PHP 代码。PHP 是一种解释语言而不是编译语言，因此不可能实现真正的多态性。

**PHP代码：**

```
<?php
// Programs functional Execution Section
system("echo Hello World!!\\n");
// mutable malicious payload goes here (if you were devious)

// Programs Polymorphic Engine Section
recombinate();
?>
<?php

function recombinate() {
  $file      = __FILE__;                    //assigns file path to $file using magic constant
  $contents  = file_get_contents($file);    //gets file contents as string
  $fileLines = explode("\n", $contents);    //splits into file lines as string array
  $varLine   = $fileLines[2];               //extracts third file line as string
  $charArr   = str_split($varLine);         //splits third line into char array
  $augStr    = augmentStr($charArr);        //recursively augments char array
  $newLine   = implode("",$augStr);         //rebuilds char array into string
  $fileLines[2] = $newLine;                 //inserts string back into array
  $newContents  = implode("\n",$fileLines); //rebuilds array into single string
  file_put_contents($file,$newContents);    //writes out augmented file
  sleep(1);                                 //let the CPU rest
  $pid = pcntl_fork();                      //forks process
  if($pid) {                                //if in parent:
    exit(0);                                //exit parent process
  }                                         //WARNING: creates 'Zombie' child process
  else {                                    //else in child process
    system("nohup php -f " .$file . " 2> /dev/null"); //executes augmented file
    exit(0);                                //exits exit child process
  }
}

function augmentStr($inArr) {
  if (mt_rand(0,6) < 5) {               //determines mutability
    /*$startIndex & $endIndex define mutable parts of file line as Xs
     * system("echo XXXXX ... XXXXX\\n");
     * 01234567890123            -7654321
     */
    $startIndex  = 13;
    $endIndex    = count($inArr)-7;
    $targetIndex = mt_rand($startIndex,$endIndex);     //choose mutable index
    $inArr[$targetIndex] = getSafeChar(mt_rand(0,62)); //mutate index
    $inArr = augmentStr($inArr);               //recurse
  }
  return $inArr;
}

function getSafeChar($inNum) {      //cannot use escaped characters
  $outChar;                 //must be a standard PHP char
       if ($inNum >=  0 && $inNum <= 9 ) { $outChar = chr($inNum + 48); }
  else if ($inNum >= 10 && $inNum <= 35) { $outChar = chr($inNum + 55); }
  else if ($inNum >= 36 && $inNum <= 61) { $outChar = chr($inNum + 61); }
  else if ($inNum == 62)                 { $outChar = " ";              }
  else                                   { $outChar = " ";              }
  return $outChar;
}

?> 
```

**警告：**创建一个[僵尸进程](http://en.wikipedia.org/wiki/Zombie_process)，知道如何在运行代码之前杀死一个僵尸进程

***信息查找技术：***

[这篇文章](http://www.informit.com/articles/article.aspx?p=366890&seqNum=6)包含比维基百科更具体的信息。但是，本文不包含真正的源代码。如果您愿意接受我的建议，尽管找到示例源代码的可能性很小，但您可能能够找到足够的**学术文档**来创建自己的变形代码。考虑这个开始（[谷歌学者](http://scholar.google.com/scholar?hl=en&q=metamorphic%20code&btnG=&as_sdt=1,50&as_sdtp)）：

在阅读学术文章/论文时，请务必查看文档末尾的来源，因为这些来源也包含有价值的信息。

***祝您在求知过程中好运！***

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-09-29T14:55:58.077

*这个答案未完待续，我会随着时间的推移继续展开，直到这个问题的答案完成*

**脚本示例 - PHP**

我自己制作了 James Holderness 提供的 PHP 脚本的副本，这样我就可以通过演示变质脚本如何工作来亲眼看看。完整的代码写在这里；[http://null.53bits.co.uk/index.php?page=php-goto-replicator](http://null.53bits.co.uk/index.php?page=php-goto-replicator)

简单地说，在最初执行脚本后，它将自身复制到一个具有随机文件名的新文件中，代码行以新的随机顺序排列，然后它分叉一个新进程，该进程正在执行脚本文件的新副本和原始文件复制退出。现在有一个脚本的新副本正在运行，它是原始文件的副本，但文件名随机，并且代码行的顺序不同。这是一个永恒的过程；重新排序和复制，然后执行一个新的实例（进程）杀死前一个。

我的目标是将 James Holderness 的 PHP 答案稍微扩展为一个有效的自我复制和变形代码示例。

这是我想出的原始 PHP 代码；

```
<?php goto a01;
a01: $characters = '0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ';    goto a02;
a02: $randomString = __DIR__."/";                                                       goto a03;
a03: $i = 0;                                                                            goto a04;
a04: if ($i < 10)                                                                       goto a05; else goto a07;
a05:   $randomString .= $characters[rand(0, strlen($characters) - 1)];                  goto a06;
a06:   $i++;                                                                            goto a04;
a07: $randomString .= ".php";                                                           goto a08;
a08: $ARGS=Array("-f",$randomString);                                                   goto a09;
a09: $handle_out = fopen("$randomString", "w");  goto l01;
l01: $filename = __FILE__;                       goto l02;
l02: $contents = file_get_contents($filename);   goto l03;
l03: $lines = explode("\n",$contents);           goto l04;
l04: $collection = array();                      goto l05;
l05: $pattern = '%^[^:]+:.*goto [^;]+;$%';       goto l06;
l06: $i = 0;                                     goto l07;
l07: if ($i < count($lines)-1)                   goto l08; else goto l23;
l08:   $line = $lines[$i];                       goto l09;
l09:   $line = trim($line);                      goto l10;
l10:   if (substr($line,0,2) != '//')            goto l11; else goto l22;
l11:     if (preg_match($pattern, $line) === 1)  goto l12; else goto l13;
l12:       $collection[] = $line;                goto l22;
l13:       shuffle($collection);                 goto l14;
l14:       $j = 0;                               goto l15;
l15:       if ($j < count($collection))          goto l16; else goto l19;
l16:         echo $collection[$j]."\n";          goto l17;
l17:         fwrite($handle_out, $collection[$j]."\n");    goto l18;
l18:         $j++;                               goto l15;
l19:       $collection = array();                goto l20;
l20:       fwrite($handle_out, $line."\n");      goto l21;
l21:       echo $line."\n";                      goto l22;
l22:   $i++;                                     goto l07;
l23: fclose($handle_out);                        goto f01;
f01: $pid = pcntl_fork();                        goto f02;
f02: if ($pid == -1)                             goto f03; else goto f04;
f03:   die("Could not fork a new child\n");      goto f03;
f04: if ($pid)                                   goto f05; else goto f06;
f05:   exit(0);                                  goto f05;
f06: $sid = posix_setsid();                      goto f07;
f07: if ($sid < 0)                               goto f08; else goto f09;
f08:   die("Child posix_setsid error\n");        goto f08;
f09: sleep(10);                                  goto f10;
f10: pcntl_exec(PHP_BINARY, $ARGS);
l24: exit(0);                                    goto l24;
?> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-08-24T16:53:32.810

根据[我](https://stackoverflow.com/questions/10113254/metamorphic-code-examples#comment28203698_16379982)在 2013 年 9 月 29 日的评论：

> 我将在接下来的几周内查看 C 示例并再次更新。我使用 Linux 并且代码不能在 Linux 上运行，所以我的目标是针对 Linux 进行调整，然后将其发布回来。

大约 7 年后的一个月后（照常准时！），由于全球大流行，我终于找到时间将@james-holderness 提供的答案移植到 Linux（并修改为符合 64 位 Intel 标准） .

完整的文章可在以下位置获得，并附有关于同一主题的附加说明和其他一些变体：[https ://github.com/jwbensley/metamorphic_polymorphic/tree/master/meta_001_c](https://github.com/jwbensley/metamorphic_polymorphic/tree/master/meta_001_c)

代码的完整副本也复制如下：

```
#include <ctype.h>     // isdigit()
#include <inttypes.h>  // intN_t, PRIuN, uintN_t
#include <sys/stat.h>  // chmod()
#include <stdio.h>     // fp, fclose(), fopen(), fprintf(), fread(), fseek(),
                       // ftell(), fwrite(), printf(),
                       // SEEK_END, SEEK_SET, stderr
#include <stdlib.h>    // EXIT_FAILURE, EXIT_SUCCESS, free(), malloc()
#include <string.h>    // strchr(), strcmp(), strdup(), strlen()

#define B_PUSH_RAX ".byte 0x50\n\t" // push rax
#define B_PUSH_RBX ".byte 0x53\n\t" // push rbx
#define B_POP_RAX  ".byte 0x58\n\t" // pop rax
#define B_POP_RBX  ".byte 0x5b\n\t" // pop rbx
//#define B_NOP  ".byte 0x90\n\t" // nop
/*
 REX.W + 0x90+r64 == XCHG RAX, r64
 "xchg rax, rax" is NOP (0x90)
 Hackaround by using REX.W flag + opcode 0x87 + r64 to avoid the use of 0x90
*/
#define B_NOP ".byte 0x48,0x87,0xc0\n\t" // REX.W xchg rax,rax

#define H_PUSH     0x50 // push + reg
#define H_POP      0x58 // pop + reg
//#define H_NOP      0x90 // nop
#define H_NOP_0    0x48 // --------------------
#define H_NOP_1    0x87 // REX.W xchg rax,rax |
#define H_NOP_2    0xC0 // --------------------

#define JUNK_ASM __asm__ __volatile__ (B_PUSH_RBX B_PUSH_RAX B_NOP B_NOP B_POP_RAX B_POP_RBX)
#define JUNKLEN 10

int local_rand () {

  /*
    This program has such a short lifetime, srand(time(0)) simply isn't random
    enough within a single execution of the program
  */
  int digit;
  FILE *fp;
  fp = fopen("/dev/urandom", "r");
  fread(&digit, 1, 1, fp);
  fclose(fp);

  return digit;

}

void insert_junk(uint8_t *file_data, uint64_t junk_start) {

  JUNK_ASM;

  /*
  This is the matrix of source and destination register opcodes for Intel.
  For example;
  0xB8 == "mov"
  0xB8 + 0xC0 == 0x178 "mov eax, eax"
  0xB8 + 0xC8 == 0x180 "mov eax, ebx"

      EAX ECX EDX EBX ESP EBP ESI EDI
  EAX C0  C8  D0  D8  E0  E8  F0  F8
  ECX C1  C9  D1  D9  E1  E9  F1  F9
  EDX C2  CA  D2  DA  E2  EA  F2  FA
  EBX C3  CB  D3  DB  E3  EB  F3  FB
  ESP C4  CC  D4  DC  E4  EC  F4  FC
  EBP C5  CD  D5  DD  E5  ED  F5  FD
  ESI C6  CE  D6  DE  E6  EE  F6  FE
  EDI C7  CF  D7  DF  E7  EF  F7  FF
  */

  /*
   The junk assembly instructions use the following pattern so that they can be identified:
   r1 = random register from RAX, RBX, RCX or RDX
   r2 = a different random register from RAX, RBX, RCX, RDX
   push r1
   push r2
   xchg r1, r2
   xchg r1, r2
   pop r2
   pop r1
  */

  uint8_t reg_1 = (local_rand()%4);
  uint8_t reg_2 = (local_rand()%4);

  while(reg_2 == reg_1) {
    reg_2 = (local_rand()%4);
  }

  uint8_t push_r1 = 0x50 + reg_1;
  uint8_t push_r2 = 0x50 + reg_2;

  uint8_t pop_r1 = 0x58 + reg_1;
  uint8_t pop_r2 = 0x58 + reg_2;

  uint8_t nop[3] = {0x48,0x87,0xC0};
  nop[2] += reg_1;
  nop[2] += (reg_2 * 8);

  file_data[junk_start] = push_r1;
  file_data[junk_start + 1] = push_r2;

  file_data[junk_start + 2] = nop[0];
  file_data[junk_start + 3] = nop[1];
  file_data[junk_start + 4] = nop[2];
  file_data[junk_start + 5] = nop[0];
  file_data[junk_start + 6] = nop[1];
  file_data[junk_start + 7] = nop[2];
  file_data[junk_start + 8] = pop_r2;
  file_data[junk_start + 9] = pop_r1;

}

int32_t load_file(uint8_t **file_data, uint32_t *file_len, const char *filename) {

  JUNK_ASM;

  FILE *fp = fopen(filename, "rb");
  if (fp == NULL) {
    fprintf(stderr, "Error opening file %s for reading\n", filename);
    return(EXIT_FAILURE);
  }

  fseek(fp, 0L, SEEK_END);
  if (ftell(fp) < 1) {
    fprintf(stderr, "File %s 0 bytes in length\n", filename);
  } else {
    *file_len = ftell(fp);
  }

  *file_data = malloc(*file_len);
  if (*file_data == NULL) {
    fprintf(stderr, "Failed to malloc space for file\n");
    return(EXIT_FAILURE);
  }

  fseek(fp, 0L, SEEK_SET);
  if (fread((void*)*file_data, *file_len, 1, fp) != 1) {
    fprintf(stderr, "Failed to fread() file %s\n", filename);
    free(file_data);
    return EXIT_FAILURE;
  }
  fclose(fp);

  printf("Loaded %" PRIu32 " bytes from %s\n\n", *file_len, filename);
  return EXIT_SUCCESS;

}

void replace_junk(uint8_t *file_data, uint64_t file_len)
{

  JUNK_ASM;

  for (uint64_t i = 0; i < file_len; i += 1) {

    // Start of the junk ASM
    if (file_data[i] >= H_PUSH && file_data[i] <= (H_PUSH + 3)) {
      if (file_data[i + 1] >= H_PUSH && file_data[i + 1] <= (H_PUSH + 3)) {
        if (file_data[i + 2 == H_NOP_0]) {
          if (file_data[i + 3] == H_NOP_1) {

            printf(
              "Junk found, from offset 0x%" PRIX64 " (%" PRIu64 ") to "
              "0x%" PRIX64 " (%" PRIu64 ")\n",
              i, i, (i + JUNKLEN), (i + JUNKLEN)
            );

            printf("Replaced: ");
            for (uint64_t j = i; j < (i + JUNKLEN); j += 1) {
              printf("0x%" PRIX32 " ", file_data[j]);
            }
            printf("\n");

            insert_junk(file_data, i);

            printf("With: ");
            for (uint64_t j = i; j < (i + JUNKLEN); j += 1) {
              printf("0x%" PRIX32 " ", file_data[j]);
            }
            printf("\n");

            printf("\n");
          }
        }
      }
    }
  }

  printf("All existing junk sequences have been replaced\n\n");
}

int32_t write_file(uint8_t *file_data, uint32_t file_len, const char *filename) {

  JUNK_ASM;

  FILE *fp;  
  int lastoffset = strlen(filename)-1;
  char lastchar = filename[lastoffset];
  char *newfilename = strdup(filename);
  lastchar = '0'+(isdigit(lastchar)?(lastchar-'0'+1)%10:0);
  newfilename[lastoffset] = lastchar; 

  fp = fopen(newfilename, "wb");
  if (fp == NULL){
    fprintf(stderr, "Error opening file %s for writing\n", filename);
    free(newfilename);
    return(EXIT_FAILURE);
  }

  fwrite(file_data, file_len, 1, fp);
  if (ferror (fp))
    fprintf(stderr, "Unable to write to new file %s\n", filename);

  fclose(fp);

  if (chmod(newfilename, S_IRWXU|S_IRGRP|S_IXGRP|S_IROTH|S_IXOTH) != 0) {
    fprintf(stderr, "Unable to chmod file %s\n", newfilename);
    return EXIT_FAILURE;
  }

  printf("Wrote modified binary data to %s\n\n", newfilename);
  free(newfilename);
  return EXIT_SUCCESS;

}

int main(int argc, char* argv[]) {

  JUNK_ASM;

  // Load this file into memory
  uint8_t  *file_data = NULL;
  uint32_t file_len;
  if (load_file(&file_data, &file_len, argv[0]) != EXIT_SUCCESS)
    return EXIT_FAILURE;

  // Replace the existing junk ASM sequences with new ones
  replace_junk(file_data, file_len);

  // Write to disk as new file
  if (write_file(file_data, file_len, argv[0]) != EXIT_SUCCESS) {
    free(file_data);
    return EXIT_FAILURE;
  }

  free(file_data);
  return EXIT_SUCCESS;

} 
```

# c# - 同一 SPROC 的每次迭代执行时间变慢

> ID：10113255
> 
> 赞同：7
> 
> 时间：2012-04-11T20:15:04.777
> 
> 标签：c#, .net, sql-server, performance, connection-pooling

**通过网络**从 C# .Net 应用程序运行**相同**的存储过程会随着每次后续执行而逐渐变慢。它似乎花费了上一次执行时间的**两倍**（达到最大值；请继续阅读）。执行时间逐渐变慢，直到发生 2 个场景中的一个，此时 SPROC 的第一次执行再次“快速”。

 ****1.  如果`SqlConnection`在所有测试期间打开并保持打开状态，则 SPROC 会逐渐变慢，直到运行**任何其他**SPROC**或查询**。
2.  如果`SqlConnection`在每次执行前后打开和关闭一个，SPROC 会逐渐变慢，直到**至少 8 分钟**过去。

这只发生在少数存储过程中。一个是`SELECT`带有 2 的简单查询`JOINs`，（*SPROC 1*）另一个是 1600+ 行 SPROC （*SPROC 2*）。

*SPROC 1*的执行时间似乎永远不会超过 60 秒，而*SPROC 2*的执行时间似乎永远不会超过67 秒。*SPROC 1*初始执行时间不到一秒，*SPROC 2*初始执行时间为 7 秒。

这也仅在 SPROC 使用相同的应用程序运行时才会发生`SqlConnection`。一旦使用了 2 个单独`SqlConnection`的对象，它们的行为与上述相同，但它们是独立的。多次运行 SPROC`SqlConnection1`会逐渐变慢，但第一次运行相同的 SPROC 时`SqlConnection2`，它是“快的”。在 .上多次运行时，它也会变慢`SqlConnection2`。

如果应用程序在安装了 SQL Server 2008 R2（运行 Windows Server 2008）的同一台计算机上运行，​​则不会发生这种情况。执行时间总是一致的。

在 Management Studio 中运行存储过程也不会因每次执行而变慢；它总是一致的。

清除执行计划缓存（在 SQL Server 中）对观察到的行为没有影响。

花了好几天的时间来缩小最初在更大的应用程序中观察到的问题，以便创建一个测试应用程序来轻松测试/重现它。

从我在[这里](http://www.sqlmag.com/article/activex/swimming-in-the-net-connection-pool)阅读的内容来看，有 4 到 8 分钟的超时（`SqlConnection.Close()`在代码中调用之后），此时它会关闭与数据源的数据库连接。这似乎符合我上面提到的场景 2。

这使我相信它与`SqlConnection`使用的（以及与数据源的底层数据库连接）有关，因为在我的情况下启用了连接池，但是**为什么我会观察到这种行为，我该如何解决呢？**

我们正在使用 .Net 2.0 框架，如果这有什么不同的话。

上面列出了很多细节，所以如果我需要澄清任何事情，请告诉我。

唯一有任何相似之处的 Stack Overflow 问题是[this](https://stackoverflow.com/questions/6798039/sql-c-sharp-query-gets-slower-with-each-iteration)，但与我的问题无关。

**编辑：** 启动时在我的 WinForms 测试应用程序中执行以下代码：

```
SqlConnectionStringBuilder connectionStringBuilder = new SqlConnectionStringBuilder();

connectionStringBuilder.DataSource = m_DataSource;
connectionStringBuilder.InitialCatalog = m_InitialCatalog;
connectionStringBuilder.UserID = m_UserID;
connectionStringBuilder.Password = m_Password;
connectionStringBuilder.IntegratedSecurity = false;
connectionString = connectionStringBuilder.ConnectionString;

m_DatabaseConnection = new SqlConnection(connectionString); 
```

然后我有2个按钮；其中一个调用上面提到的*SPROC 1*，另一个调用另一个没有相同减速问题的 SPROC。在任一按钮单击时都会执行以下代码（唯一的区别是 SPROC 名称）：

```
m_DatabaseConnection.Open();
m_DatabaseCommand = new SqlCommand("GetCompanies", m_DatabaseConnection);
m_DatabaseCommand.Parameters.AddWithValue("@StatusID", StatusID);
m_DatabaseCommand.CommandType = CommandType.StoredProcedure;
m_DatabaseCommand.CommandTimeout = 0;

SqlDataAdapter databaseDataAdapter = new SqlDataAdapter(m_DatabaseCommand);
DataSet databaseDataSet = new DataSet();
databaseDataAdapter.Fill(databaseDataSet);
m_DatabaseConnection.Close(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-11T20:31:41.990

这是我调试此问题的想法：

*   在 Dispose 连接后尝试调用 SqlConnection.ClearAllPools() 。如果这解决了问题，那么问题肯定与特定的连接有关。
*   接下来，将 SPROC 包含在显式事务中。
*   接下来，在调用 SPROC 之前调用 SqlConnection.ClearAllPools()。
*   SPROC 返回多少数据？
*   请发布您用于打开连接并执行 SPROC 的 C# 代码。
*   创建一个独立的控制台应用程序来重现您所看到的行为。这将（可能）证明您的应用程序中有问题，因为控制台应用程序可以正常运行。****

# ruby-on-rails - 自定义 options_for_select 输出？

> ID：10113257
> 
> 赞同：0
> 
> 时间：2012-04-11T20:15:21.767
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我有一个看起来像这样`select_tag`的：`options_for_select`

```
<%= select_tag "respondent", options_for_select(1..5, 2) %> 
```

输出：

```
<select id="respondent" name="respondent">
  <option value="1">1</option>
  <option value="2" selected="selected">2</option>
  <option value="3">3</option>
  <option value="4">4</option>
  <option value="5">5</option>
</select> 
```

但我希望它输出的是这样的：

```
<select id="respondent" name="respondent">
  <option value="/arbitrary/page/1">#1</option>
  <option value="/arbitrary/page/2" selected="selected">#2</option>
  <option value="/arbitrary/page/3">#3</option>
  <option value="/arbitrary/page/4">#4</option>
  <option value="/arbitrary/page/5">#5</option>
</select> 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T20:25:02.347

如果您有这样的命名路线，例如`arbitrary_page_path`：

```
<% collection = (1..5).map { |i| ["##{i}", arbitrary_page_path(i)] } %>
<%= select_tag "respondent", options_for_select(collection, arbitrary_page_path(2)) %> 
```

# java - 反转整数数组

> ID：10113258
> 
> 赞同：1
> 
> 时间：2012-04-11T20:15:23.747
> 
> 标签：java

只是好奇，但是当我尝试使用它来反转数组时，它总是会吐出一些不连贯的乱码，而不是反转的数组，例如`[I@43256ea2`. 关于它为什么这样做的任何想法？

```
public class Fiddle {
    public static void main(String[] args) {
        int[] number = {1,2,3,4,5};
        System.out.println(reverse(number));
    }
    public static int[] reverse(int[] a) {
        int[] b = new int[a.length];
        for (int i = 0; i < a.length; i++) {
            b[a.length-1-i] = a[i];
        }
        return b;
    }
} 
```

感谢您对为什么会发生这种情况的任何想法（这可能是因为我忘记了一些东西）。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-11T20:17:00.647

使用实用方法[`java.util.Arrays.toString(int[])`](http://docs.oracle.com/javase/7/docs/api/java/util/Arrays.html#toString%28int%5B%5D%29)：

```
System.out.println(Arrays.toString(reverse(number))); 
```

数组类不会覆盖`Object.toString()`，这意味着它们使用[Object 提供的默认实现](http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html#toString%28%29)，即“ `type@hashcode_in_hex`”。类型的 String 表示`int[]`是`[I`，这就是为什么您会看到这种“不连贯的胡言乱语”。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-11T20:17:19.307

尝试这个：

```
System.out.println(Arrays.toString(reverse(number))); 
```

这是java的“错误”之一 - 你必须使用`Arrays.toString()`否则你会得到默认`toString()`的 from `Object`，它会产生你所看到的输出，

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-11T20:17:51.267

您正在打印数组的哈希值。你应该做类似的事情

```
for(int i: reverse(number)){
  System.out.println(i);
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-11T20:18:53.313

Commons.lang

```
ArrayUtils.reverse(int[] array) 
```

完毕。

# php - Symfony 中的输出转义

> ID：10113262
> 
> 赞同：0
> 
> 时间：2012-04-11T20:16:07.287
> 
> 标签：php, escaping, symfony-1.4, doctrine-1.2

我有一个 Symfony 1.4 和 Doctrine 1.2 项目正在运行，并且在我的一个数据库调用中出现输出转义问题。

问题是，我不是在我的 Doctrine 查询中检索 PHP 对象，而是在 PHP 中检索一个数组。我这样做的原因完全是另一个话题，我们只是说获取 PHP 对象不是解决方案。本质上，查询是两个学说模型之间的内部连接。模型 1 与模型 2 的内部连接，产生的结果可以这样访问：

```
foreach($results as $result)
{
 echo $result['field1']; // accessing results for model 1 
 echo $result['model2']['field1']; // accessing results for model 2 (this inner joins with the model)
} 
```

现在对于上述内容，更具体地说，对于 model2，field1 由 HTML 标记组成，它自然是输出转义的。我需要按原样呈现 HTML 标记！问题出在哪，

如果这是一个规则 Doctrine 对象，一个简单的 $modelObject->getRawValue()->getField(); 将呈现 HTML 标记而不转义它。我不确定如何在 PHP 数组中呈现 HTML 标记？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T20:48:58.557

（从我之前的评论中复制）。我想知道，如果你`print_r($result)`在你的循环中，你可能会发现它被包裹在一个逃逸对象中。如果是这样，您应该也可以`getRawValue()`在其元素上使用吗？

这是有效的，因为转义器对象实现了`Iterator`接口（因此您可以`foreach`对其进行处理）以及`ArrayAccess`（因此它看起来像数组一样工作）。

# perl - MojoX::Session 只有一种传输类型吗？

> ID：10113267
> 
> 赞同：0
> 
> 时间：2012-04-11T20:16:12.793
> 
> 标签：perl, mojolicious

[MojoX::Session](https://www.metacpan.org/module/MojoX%3a%3aSession)只有一种传输类型MojoX [::Session::Transport::Cookie](https://www.metacpan.org/module/MojoX%3a%3aSession%3a%3aTransport%3a%3aCookie)吗？我找不到任何其他运输类型。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T00:18:51.820

到目前为止，看起来[MojoX::Session::Transport](https://www.metacpan.org/module/MojoX%3a%3aSession%3a%3aTransport%3a%3aCookie)只有一个派生类。为什么需要不同的传输类型？当您创建所需内容并将其上传到 CPAN 时，还会有另一个。

# c# - DataGridView 根据 Radio Buttons 过滤数据

> ID：10113268
> 
> 赞同：3
> 
> 时间：2012-04-11T20:16:14.900
> 
> 标签：c#, winforms, c#-4.0, datagridview, radio-button

我有一些单选按钮

一个单选按钮称为 Open Tickets 另一个称为 Closed Tickets

当按下 Open Tickets 按钮时，我想过滤 DataGridView 上显示的数据

关于如何做到这一点的任何建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T20:25:54.043

您可以`datagridview`通过将过滤器应用于您的`BindingSource`. MSDN 有一个如何过滤绑定源的示例。链接和代码如下。

[来自MSDN](http://msdn.microsoft.com/en-us/library/system.windows.forms.bindingsource.filter.aspx)的示例：

```
private void PopulateDataViewAndFilter()
{
    DataSet set1 = new DataSet();

    // Some xml data to populate the DataSet with.
    string musicXml =
        "<?xml version='1.0' encoding='UTF-8'?>" +
        "<music>" +
        "<recording><artist>Coldplay</artist><cd>X&amp;Y</cd></recording>" +
        "<recording><artist>Dave Matthews</artist><cd>Under the Table and Dreaming</cd></recording>" +
        "<recording><artist>Dave Matthews</artist><cd>Live at Red Rocks</cd></recording>" +
        "<recording><artist>Natalie Merchant</artist><cd>Tigerlily</cd></recording>" +
        "<recording><artist>U2</artist><cd>How to Dismantle an Atomic Bomb</cd></recording>" +
        "</music>";

    // Read the xml.
    StringReader reader = new StringReader(musicXml);
    set1.ReadXml(reader);

    // Get a DataView of the table contained in the dataset.
    DataTableCollection tables = set1.Tables;
    DataView view1 = new DataView(tables[0]);

    // Create a DataGridView control and add it to the form.
    DataGridView datagridview1 = new DataGridView();
    datagridview1.AutoGenerateColumns = true;
    this.Controls.Add(datagridview1);

    // Create a BindingSource and set its DataSource property to
    // the DataView.
    BindingSource source1 = new BindingSource();
    source1.DataSource = view1;

    // Set the data source for the DataGridView.
    datagridview1.DataSource = source1;

    //The Filter string can include Boolean expressions.
    source1.Filter = "artist = 'Dave Matthews' OR cd = 'Tigerlily'";
} 
```

# python - python字符串列表列出ast.listeral_eval

> ID：10113270
> 
> 赞同：4
> 
> 时间：2012-04-11T20:16:24.560
> 
> 标签：python

```
>>> import ast
>>> string = '[Small, Medium, Large, X-Large]'
>>> print string
[Small, Medium, Large, X-Large]
>>> string = ast.literal_eval(string)
Traceback (most recent call last):  
    File "<pyshell#26>", line 1, in <module>
         string = ast.literal_eval(string)
    File "C:\Python27\lib\ast.py", line 80, in literal_eval
        return _convert(node_or_string)
    File "C:\Python27\lib\ast.py", line 60, in _convert
        return list(map(_convert, node.elts))
  File "C:\Python27\lib\ast.py", line 79, in _convert
    raise ValueError('malformed string')
ValueError: malformed string 
```

怎么修？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-04-11T20:20:25.107

[`ast.literal_eval()`](http://docs.python.org/library/ast.html#ast.literal_eval)仅接受包含有效 Python 文字结构（字符串、数字、元组、列表、字典、布尔值和`None`）的字符串。

这是一个仅包含以下文字结构的有效 Python 表达式：

```
["Small", "Medium", "Large", "X-Large"] 
```

这不是：

```
[Small, Medium, Large, X-Large] 
```

创建有效字符串的两种方法：

```
string = '["Small", "Medium", "Large", "X-Large"]'
string = "['Small', 'Medium', 'Large', 'X-Large']" 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-11T20:18:04.967

您的字符串不是有效列表。如果是字符串列表，则需要引号。

例如：

```
string = '["Small", "Medium", "Large", "X-Large"]' 
```

# c++ - Oracle Pro*C 预编译器错误 PCC-S-02201

> ID：10113272
> 
> 赞同：2
> 
> 时间：2012-04-11T20:16:38.277
> 
> 标签：c++, oracle, oracle-pro-c

正在转换为使用 Oracle Pro*C 的现有程序在预编译时会导致问题。它从文件系统中读取一个文件，对其进行解析，然后写入几个数据库表。

有一个具有以下定义的方法：

```
void parse_line(inline)
char *inline;
{
// do stuff
} 
```

当我尝试实现它时，我看到：

```
Syntax error at line 162, column 13, file myfile.cp:
Error at line 162, column 13 in file myfile.cp
char *inline;
............1
PCC-S-02201, Encountered the symbol ";" when expecting one of the following:

   ( * const, volatile, an identifier, 
```

据我所知，这个函数声明在语法上是正确的，所以我不得不假设这个预编译器错误是由于其他地方的问题而出现的。

没有在这里粘贴整个程序，有人对我可以开始寻找的几个好地方有任何建议吗？

我的 pcscfg.cfg 看起来像这样：

```
sys_include=($ORACLE_HOME/precomp/public,/usr/include,/usr/lib/gcc-lib/x86_64-redhat-linux/3.2.3/include,/usr/lib/gcc/x86_64-redhat-linux/4.1.1/include,/usr/lib64/gcc/x86_64-suse-linux/4.1.2/include,/usr/lib64/gcc/x86_64-suse-linux/4.3/include)
ltype=short
define=__x86_64__ 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-12T16:56:37.547

该声明无效，因为`inline`它是 C 和 C++ 中的关键字（并且只能用作 C 中的函数说明符）。

*将该变量名更改为其他名称，如果*您编译为 C 而不是 C++ ，则应该通过。我不相信函数定义语法的风格在 C++ 中是可以接受的。

# java - JBoss 5 调度后台任务。一个接一个地执行，破坏了时间表

> ID：10113274
> 
> 赞同：1
> 
> 时间：2012-04-11T20:16:39.913
> 
> 标签：java, jboss5.x, scheduled-tasks

例如，我有两个任务：

```
 <mbean code="org.jboss.varia.scheduler.Scheduler" name=":service=Scheduler">
    <attribute name="StartAtStartup">true</attribute>
    <attribute name="SchedulableClass">Scheduler1</attribute>
    <attribute name="InitialStartDate">NOW</attribute>
    <attribute name="SchedulePeriod">60</attribute>
    <attribute name="InitialRepetitions">-1</attribute>
    <attribute name="FixedRate">false</attribute>
  </mbean>

  <mbean code="org.jboss.varia.scheduler.Scheduler" name=":service=Scheduler2">
    <attribute name="StartAtStartup">true</attribute>
    <attribute name="SchedulableClass">Scheduler2</attribute>
    <attribute name="InitialStartDate">NOW</attribute>
    <attribute name="SchedulePeriod">3600</attribute>
    <attribute name="InitialRepetitions">-1</attribute>
    <attribute name="FixedRate">false</attribute>
  </mbean> 
```

即第一个每分钟安排一次，第二个每小时安排一次。

问题是，如果执行第二个任务需要 5 分钟，那么在此期间第一个任务不会执行，它会等到第二个任务完成。

有没有办法让它们并行工作？或者我应该搬到 Quartz 或其他什么地方？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T20:26:03.403

利用

```
<attribute name="TimerName">jboss:service=TimerNew</attribute> 
```

它将以并行方式启动计划。

# css - 名词项目 CSS 包装器？

> ID：10113276
> 
> 赞同：4
> 
> 时间：2012-04-11T20:16:56.290
> 
> 标签：css

我在任何地方都找不到链接，我搜索了整个 Hacker News（我记得在那里看到了这个项目），但没有运气。

无需从 The Noun Project 等下载图像，您只需包含一个 css 文件并将名词的名称指定为标签下的类或其他内容。这是在外面吗？！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-25T18:34:00.233

也许你的意思是：http: [//nounpack.com](http://nounpack.com)？他们有一个带有许多从名词项目中获取的图标的精灵，然后您可以将它们作为带有 css 的图标包含在内。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-04T20:16:28.197

同意@Nick Silva 的观点，[Font Awesome](http://fontawesome.io/icons/)无疑是轻松“名词项目式”css 的最佳起点。

也就是说，要回答您的问题，要直接使用名词项目图标，您需要自己包装。最好的方法（恕我直言）是使用[字体自定义](http://fontcustom.com/)

Font Custom 是一个命令行工具，用于从 SVG（名词项目图标）生成自定义图标 webfonts (CSS)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-04T00:50:27.867

您可能会想到 Font Awesome，这是一种带有 150 个图标的象形字体，可以与 twitter 引导程序一起使用。

使用 Fort Awesome，您可以在 CSS 标记中链接到 FontAwesome。然后将所需图标的类添加到 HTML 元素。

在我的[jsFiddle 示例](http://jsfiddle.net/xPGMK/)中，我有一个相机并在一些文本旁边玩圈。

缺口

# reflection - 使用 AppDomain.Load(byte[]) 而不从文件加载？

> ID：10113278
> 
> 赞同：0
> 
> 时间：2012-04-11T20:17:05.870
> 
> 标签：reflection, assemblies, appdomain, .net-assembly

我崩溃了……我试图用一个程序集手动加载和卸载域：

```
 var domainInfo = new AppDomainSetup
                            {
                               PrivateBinPath = baseDir
                            };

        _hostedDomain = AppDomain.CreateDomain("Domain", null, domainInfo);
        _hostedDomain.UnhandledException += HostedDomainUnhandledException;
        _hostedDomain.DomainUnload += _hostedDomain_DomainUnload;

        var bytes = File.ReadAllBytes("Facade.dll"); // Loads facade from hosts location.
        _hostedDomain.Load(bytes);

        string asmName = Path.Combine(baseDir, Properties.Settings.Default.AssemblyName);
        bytes = File.ReadAllBytes(asmName);
        var entryPoint = _hostedDomain.Load(bytes); // exception here! 
```

我看到的是：当我尝试加载程序集时，我看到系统从 CurrentDir/assemblyname.dll 加载它（并且失败）。异常：System.IO.FileNotFoundException：

无法加载文件或程序集 Worker，Version=1.0.0.0，Culture=neutral，PublicKeyToken=null' 或其依赖项之一。该系统找不到指定的文件。

LOG：此绑定在默认加载上下文中开始。LOG：使用应用程序配置文件：D:#Development!test\trunk\bin\Debug\Bootstrapper.vshost.exe.Config LOG：使用主机配置文件：LOG：使用来自 C:\Windows\Microsoft.NET\ 的机器配置文件Framework64\v4.0.30319\config\machine.config。LOG：此时未将策略应用于引用（私有、自定义、部分或基于位置的程序集绑定）。日志：正在尝试下载新的 URL 文件：///D:/#Development/!test/trunk/bin/Debug/Worker.DLL。日志：正在尝试下载新的 URL 文件：///D:/#Development/!test/trunk/bin/Debug/Worker/Worker.DLL。日志：正在尝试下载新的 URL 文件：///D:/#Development/!test/trunk/bin/Debug/Worker.EXE。日志：正在尝试下载新的 URL 文件：///D:/#Development/!test/trunk/bin/Debug/Worker/Worker.EXE。

顺便提一句。由于限制，不可能使用 LoadFrom（我遇到了 XML 序列化的问题......）。.NET 在这个例程中做什么？为什么加载和卸载域如此困难？谢谢您的帮助！

# macos - 在两个字符串的第一次出现之间获取文本 [Shell]

> ID：10113283
> 
> 赞同：0
> 
> 时间：2012-04-11T20:17:26.537
> 
> 标签：macos, bash, shell

我有一个看起来像这样的 feed.xml 文件。我想要做的是从这个提要中获取 test.html。（基本上，最上面的项目的 url。）关于如何做到这一点的任何想法？

```
<rss>
<item>
    <title>ABC</title>
    <url>
        test.html
    </url>
</item>
<item>
    <title>CDE</title>
    <url>
        test1.html
    </url>
</item>
</rss> 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T20:29:13.190

如果结构是固定的并且您知道 URL 具有后缀 .html，您可以简单地执行以下操作：

```
 cat <yourfile> | grep ".html" | head -n1 
```

如果你不知道后缀（或者字符串“html”之前可以存在），你可以这样做：

```
 cat <yourfile> | grep -A1 "<url>" | head -n2 | tail -n1 
```

**编辑** 如果结构不固定（即没有换行符），那么这个

```
 cat <yourfile> | grep -o "<url>[^<]*</url>" | head -n1 | cut -d'>' -f2 | cut -d'<' -f1 
```

或者那个

```
 cat <yourfile> | grep -o "<url>[^<]*</url>" | head -n1 | sed -E -e"s#<url>(.*)</url>#\1#" 
```

可能工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-11T21:11:20.957

这可能对您有用：

```
 sed '/<url>/,/<\/url>/{//d;s/ *//;q};d' file.xml 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-11T20:27:58.230

这个 awk 脚本应该可以工作：

```
awk '/<url>/ && url==0 {url=1;next;} {if(url==1) {print;url=2;}}' file 
```

**编辑：**

以下 grep 命令也可能有效：

```
grep -m 1 "^ *<url>" -A1 file | grep -v "<url>" 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-11T20:50:04.380

我建议不要使用基于行的工具，而是使用 xsl 转换从文档中获取您想要的数据，而无需对其格式进行假设。

如果将其保存到`get-url.xsl`：

```
<?xml version="1.0"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:xs="http://www.w3.org/2001/XMLSchema">
        <xsl:output method="text"/>
        <xsl:template match="/">
                    <xsl:value-of select="normalize-space(rss/item/url)"/>
        </xsl:template>
</xsl:stylesheet> 
```

然后你可以像这样得到`url`from的值`feed.xml`：

```
$ xsltproc get-url.xsl feed.xml; echo
test.html
$ 
```

额外`echo`的只是在输出结束后给你一个换行符，使其对交互式 shell 友好。如果您将结果分配给带有`$()`.

# jquery - 如何使用 jquery 查找类并应用样式？

> ID：10113284
> 
> 赞同：1
> 
> 时间：2012-04-11T20:17:29.703
> 
> 标签：jquery, css, height, jquery-ui-accordion

[我在手风琴的jsfiddle](http://jsfiddle.net/patrioticcow/W7e3K/3/)中有这个例子，它只用 css3 制作，没有 js。

**HTML：**

```
<div class="ac-container">
    <div>
        <input id="ac-1" name="accordion-1" type="radio" checked />
        <label for="ac-1">About us</label>
        <article class="ac-small">
            <p id="test_small">test</p> <-- this tag will come from php
        </article>
    </div>
    <div>
        <input id="ac-2" name="accordion-1" type="radio" />
        <label for="ac-2">How we work</label>
        <article class="ac-medium">
            <p id="test_medium">test</p>
        </article>
    </div>
</div>​ 
```

**CSS：**

```
.ac-container input:checked ~ article.ac-small{
    height: 140px;
}
.ac-container input:checked ~ article.ac-medium{
    height: 180px;
}
.ac-container input:checked ~ article.ac-large{
   /* height: 240px;*/
} 
```

我遇到的问题是高度已经设置好了，我用php添加了内容，我不确定有多少内容，所以我需要一个动态高度。

php 将加载 p 标签，所以我可以找到这样的高度：

```
var v = $("#test_small").height();

// add the height to the .ac-small
$('.ac-container input:checked article.ac-small').css("height", v+'px'); 
```

我遇到的问题是css不适用于选择器，我相信选择器`$('.ac-container input:checked article.ac-small')`是错误的或什么的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-11T20:29:07.837

尝试

```
$('.ac-container input:checked').parent('div').children('article.ac-small').css("height", v+'px'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-11T20:21:50.927

你的选择器是错误的。请允许我向您解释该选择器获取的内容：

```
$('.ac-container input:checked article.ac-small') 
```

它将选择存在于元素元素内的已检查输入内的`<article>`具有类的元素。`ac-small``ac-container`

好吧，您不能**在**输入中包含元素...

在`css`你写的选择器右边：

```
.ac-container input:checked ~ article.ac-small{
    height: 140px;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-11T20:41:19.590

**第一：**
您必须将 id 更改为 class

```
var v = $(".ac-small").height(); 
```

**第二：**
如果你想获得输入的兄弟，你必须这样做：
获取容器内的检查输入，当找到它时获取它的文章兄弟，然后设置 css。

```
$('.ac-container').find('input:checked').siblings('article').css("height", v+'px'); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-11T20:23:32.720

您想使用[下一个兄弟选择器](http://api.jquery.com/next-siblings-selector/)。 `~`选择与该选择器匹配的下一个兄弟，而不是具有该选择器的孩子：

```
$('.ac-container input:checked ~ article.ac-small') 
```

你也可以这样写：

```
$('.ac-container').find('input:checked').siblings('article.ac-small') 
```

或更准确地说（对于下一个兄弟姐妹）：

```
$('.ac-container').find('input:checked').nextAll('article.ac-small') 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-11T20:24:39.957

你来做这件事

```
var v = $("#ac-small").height(); 
```

但是您没有任何 id 为“ac-small”的元素。

# security - 在 CouchDB 中，数据库权限如何影响复制？

> ID：10113286
> 
> 赞同：4
> 
> 时间：2012-04-11T20:17:36.290
> 
> 标签：security, couchdb

来自维基：[http ://wiki.apache.org/couchdb/Security_Features_Overview](http://wiki.apache.org/couchdb/Security_Features_Overview)

数据库有“成员”或读者、“管理员”和“服务器管理员”

成员可以阅读、编辑和删除除设计文档之外的数据库文档。管理员可以阅读、编辑和删除文档，包括设计文档。管理员还可以更改他们作为管理员的数据库的成员和管理员，更改修订限制等。服务器管理员可以做各种疯狂的事情。

* _users db 是一个特例，它很棒，至少可以完美地满足我的需求。

我关心的是复制。作为数据库成员，我可以将什么复制到数据库并形成数据库？作为数据库管理员，我可以从数据库中复制什么？

我试图尝试复制并自己弄清楚“成员”和“管理员”可以做什么和不能做什么。似乎任何有权阅读文档的人都可以复制它，除非它是设计文档，否则除了服务器管理员之外没有人可以复制它。最后一部分对我来说似乎是错误的，我离开了吗？

# c - for循环中的数组，C99

> ID：10113307
> 
> 赞同：3
> 
> 时间：2012-04-11T20:19:01.763
> 
> 标签：c, arrays, loops, for-loop

我问过一个关于在 for 循环中声明数组的问题，例如

```
for(i=0;i<=1000;i++){
    float arrayone[(length[i])];
    do a bunch of other stuff
} 
```

基本上，我正在尝试做一个数组，其长度可以根据程序所在的步骤而变化。我不想永久保存数组数据（如arrayone [] []），因为它很大并且有很多步骤。

所以有人告诉我，像这样在这个范围内声明数组是合法的。**但它会在最后尝试存储 1000 个数组副本吗，这是我不想要的吗？**我是一个初学者，所以我不明白这些块真正做的细微差别。

对我来说，另一种选择是在循环之外创建一个数组，该数组具有所需的最大长度，并在每一步都覆盖它。

编辑：数组的用途是：我有一个全局数组。循环中的数组使用该全局数组填充函数结果，以节省计算。数组被操纵，...，...，最后用于更改全局数组。然后他们就不再需要了。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-11T20:23:24.607

> 但它会在最后尝试存储 1000 个数组副本吗，这是我不想要的吗？

不，在每次迭代开始时都会分配一个新数组，并且由于数组在迭代结束时超出范围，届时它将被释放，因此一次只存在一个数组。

这就是自动变量（该数组就是）的意义所在。在声明它们的范围结束时（通常但不总是用大括号分隔），它们会自动释放。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T20:28:37.367

循环的每次迭代完成后，循环内声明的所有变量都将被销毁，包括您的数组。因此，您的阵列只会保留一份副本。

但是，话虽如此，您应该知道在循环之外初始化数组可能会更好，因为您不必每次迭代都在堆栈上分配内存。

如果您像这样动态分配数组（不在您的示例中）：

```
 for(i=0;i<=1000;i++){
      float * arrayone = (float*)malloc(i * sizeof(float));
    } 
```

那么你就有问题了。这里的局部变量是指针，当它被销毁时，您将无法再访问您分配的内存。在这种情况下，您将一次在内存中拥有 1000 个不同的数组。您可以`free`在指针被销毁之前保留您的记忆，但我认为在循环之外声明数组仍然更好。

# svn - svn 存储库布局 - 需要意见

> ID：10113308
> 
> 赞同：1
> 
> 时间：2012-04-11T20:19:01.930
> 
> 标签：svn, visualsvn-server, repository-design

全部 - 我在这里阅读了几篇关于 svn 存储库布局最佳实践的文章，不幸的是，它们都没有帮助我确定最适合我们的路线，所以我想就如何根据这些信息构建存储库征求您的意见：

1.  展望未来，我们的大部分代码将使用 C# 开发并成为 .NET 应用程序。
2.  我们之前的 Web 开发是用 Java 完成的。
3.  我们有一些用 Delphi 开发的非常旧的程序，没有进行太多修改，当我们迁移到新的案例管理系统时，所有的 Delphi 应用程序都将过时。

基于这些信息，您会为所有不同的源代码提供一个存储库，还是为每种类型的源（即一个 Delphi 存储库、一个 Java 和一个 .NET）提供一个存储库？

请记住，在一年左右的时间里，所有的 Delphi 代码和大量的 Java 代码都将过时。这让我认为将它们放在单独的存储库中可能是最好的方法，因为我们不需要在迁移后保留任何代码。

所以，我的问题基本上是每种类型的代码都有一个存储库还是 3 个单独的存储库？

谢谢！莱斯利

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T20:35:34.053

你看过Git吗？您选择 SVN 而不是 Git 有什么原因吗？我之所以这么问，是因为我们大约在一年前进行了过渡，而且是夜以继日。对我们来说，你真的无法将我们现在与 Subversion 和 Git 相比。这是朝着正确方向迈出的一大步。显然那是给我们的，所以你的里程可能会有所不同，尤其是你的开发人员也使用什么。

当我们决定切换到 Git 时，我们的情况略有相似。我们的整个应用程序和在线存在的多个部分都集中在我们的 SVN 存储库中。效果很好，但由于几个不同的原因，我们最终走向了不同的方向，即每个人都可以独立支持自己，并且生活在不同的服务器设置上。在为我们迁移到 Git 之前，有一个巨大的推动力来实现这一点，但我们确实从中受益。我们现在已经将我们的业务流程与我们的主应用程序分开，这使我们的基础设施具有更高的稳定性和安全性。

当前是否需要所有 Java 和 Delphi 代码来维护和运行您的应用程序？如果答案是肯定的，并且在短期内仍然是肯定的，我肯定会把它全部放在一个回购中。如果你走 Git 路线，如果你绝对想单独维护它们，你可以使用分支来帮助你。但是我真的认为将它们存储在单独的存储库中并没有多大好处。一旦你重构了你的代码不再使用它们，你就可以轻松地将它们从 repo 中删除，并且仍然拥有与之关联的所有修订历史记录。

这当然是不知道您的业务和应用程序的所有复杂细节。你会知道在这方面什么是最好的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T20:56:16.007

实际上，关于将什么放入一个存储库的决定应该取决于这些项目/应用程序的相关性，而不是它们使用的语言。不相关的东西不应该在一个存储库中。

因为它是一个迁移，如果你真的想在之后把它扔掉，你可以为新的东西（.net）和旧的东西（java+delphi）有单独的存储库。

当您编写“应用程序”时-也许您应该考虑为新软件提供几个存储库！？将太多内容放入一个存储库会使其灵活性降低。根据您的项目的实际情况，这也可能意味着您最终会得到几个不同的混合存储库......

# objective-c - 调试绑定到 NSManagedObjectContext 的 NSArrayController

> ID：10113313
> 
> 赞同：0
> 
> 时间：2012-04-11T20:19:19.880
> 
> 标签：objective-c, cocoa, core-data, nsmanagedobjectcontext, nsarraycontroller

我有一个带有两个实体 A 和 B 的 NSManagedObjectContext。我有一个 NSArrayController 绑定到 NSManagedObjectContext 和一个 NSTableView。NSArrayController 设置为列出 B 类型的实体。然后数组控制器提供表格视图。

阵列控制器所在的 NIB 由 NSWindowController 调用。在初始化时，我添加了每个对象的一个​​实例，但是当我到达 windowDidLoad 时，托管对象上下文已被填充，但数组控制器为空。

使用 gdb 我可以打印窗口控制器中可见的 MOC 和绑定到数组控制器的 MOC，它们都具有相同的地址。

关于如何调试的任何线索？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T19:33:11.507

删除了 NIB 和控制器并从头开始创建代码。事情似乎完美无缺。我怀疑这是 Xcode 中的错误。

# clojure - 循环如果和直到找到结果然后退出

> ID：10113315
> 
> 赞同：0
> 
> 时间：2012-04-11T20:19:26.333
> 
> 标签：clojure

我不认为按键？下面的功能按我期望的方式工作。首先，这是输入数据。

cmp-val 派生的数据：[“2”“000-00-0000”“TOAST”“FRENCH”“”“M”“26-Aug-99”“”“ALL CARE PLAN”“MEDICAL”]缺少密钥 (ssn)。[“000-00-0000”“吐司”“法式”“B 部分 - 已投保”]

问题是，如果我将输入的 000-00-0000 之一设为其他内容，我应该看到 conj'd 到对数向量上。我没有，而且我没有看到它印有 if-not empty?。

```
(defn is-a-in-b
    "This is a helper function that takes a value, a column index, and a 
     returned clojure-csv row (vector), and checks to see if that value
     is present. Returns value or nil if not present."

    [cmp-val col-idx csv-row]

    (let [csv-row-val (nth csv-row col-idx nil)]
        (if (= cmp-val csv-row-val)
            cmp-val
            nil)))

(defn key-pres?
    "Accepts a value, like an index, and output from clojure-csv, and looks
     to see if the value is in the sequence at the index. Given clojure-csv
     returns a vector of vectors, will loop around until and if the value
     is found."

    [cmp-val cmp-idx csv-data]

    (let [ret-rc 
        (for [csv-row csv-data
                :let [rc (is-a-in-b cmp-val cmp-idx csv-row)]
                :when (true? (is-a-in-b cmp-val cmp-idx csv-row))]
            rc)]
        (vec ret-rc)))

(defn test-key-inclusion
    "Accepts csv-data file and an index, a second csv-data param and an index,
     and searches the second csv-data instances' rows (at index) to see if
     the first file's data is located in the second csv-data instance."

    [csv-data1 pkey-idx1 csv-data2 pkey-idx2]

    (reduce
        (fn [out-log csv-row1]
            (let [cmp-val (nth csv-row1 pkey-idx1 nil)]
                (doseq [csv-row2 csv-data2]
                  (let [temp-rc (key-pres? cmp-val pkey-idx2 csv-row2)]
                      (if-not (empty? temp-rc) 
                          (println cmp-val, " ", (nth csv-row2 pkey-idx2 nil), " ", temp-rc))
                      (if (nil? temp-rc)
                        (conj out-log cmp-val))))))
         []
         csv-data1)) 
```

我想要函数做的是遍历 clojure-csv（向量的向量）返回的数据。如果可以在 csv-row 中的 cmp-idx 位置找到 cmp-val，我希望将其分配给 rc，并终止循环。

如何修复 for 循环，如果没有，我可以使用什么循环机制来完成此操作？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T21:40:31.300

*   你不需要`true?`，它专门检查布尔`true`值；
*   不要重复调用 is-a-in-b；
*   `a-in-b?`用作 fn 名称会更惯用（和可读） ；
*   我建议简化代码，你真的不需要`let`。

代码：

```
(vec (for [csv-row csv-data
           :let [rc (a-in-b? cmp-val cmp-idx csv-row)]
           :when rc)]
        rc)) 
```

但是，这只是对代码风格的一些一般性评论......你在这里实现的只是一个简单的`filter`：

```
(vec (filter #(a-in-b? cmp-val cmp-idx %) csv-data)) 
```

此外，这不仅会返回第一个匹配项，还会返回所有匹配项。如果我没看错你的问题，你只需要找到第一个匹配项？然后使用`some`：

```
(some #(a-in-b? cmp-val cmp-idx %) csv-data) 
```

**更新**

重读您的问题，我觉得您认为`for`这是一个循环构造。它不是——它是一个列表推导，产生一个惰性序列。要编写一个循环来控制何时进行迭代，您必须使用`loop-recur`. 但是在 Clojure 中，您几乎不需要编写自己的循环，除了性能。在所有其他情况下，您可以从`clojure.core`.

# php - DATETIME InnoDB 事务的 NOW() 有保证吗？

> ID：10113317
> 
> 赞同：5
> 
> 时间：2012-04-11T20:19:34.787
> 
> 标签：php, mysql, transactions, innodb

在单个 InnoDB 事务中的 2+ 个查询中使用 NOW() 是否**保证**插入的日期时间值在数据库中是准确的？

换句话说，NOW()，即使您在单个事务中使用它有超过 20 个查询，它是否总是相同的，还是会改变？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-11T20:22:43.327

[显然，它不能保证](http://forums.mysql.com/read.php?97,430329,430329)在整个事务中，但可以从语句更改为语句。您可以使用一种解决方法[，如下所示](http://forums.mysql.com/read.php?97,430329,430620#msg-430620)：

```
BEGIN;
SELECT @now := NOW();
INSERT ... VALUES (..., @now, ...);
INSERT ... VALUES (..., @now, ...);
UPDATE ... @now ...;
COMMIT; 
```

如果您想完全避免这种情况，只需将当前日期和时间设置为 PHP 变量并使用它。

# javascript - 访问表 td 内的 html 选择元素

> ID：10113318
> 
> 赞同：0
> 
> 时间：2012-04-11T20:19:35.410
> 
> 标签：javascript, html

我有以下 html 片段

```
<table>
    <tr>
        <td><select name="day">
        </select></td>
        <td><select name="time">
        </select></td>
        <td><select name="closed" onchange="dosomething(this)">
        </select></td>
    </tr>
</table> 
```

当我改变一些东西时，我想得到一个句柄并对其进行一些操作。我如何在javascript中获得句柄？

```
function closedChanged(object)
{
    try
    {
        var parent=object.parentNode.parentNode;
        var day = parent.getElementsByName("day")[0];
    }
    catch(e)
    {
        alert(e);
    }
} 
```

在这里我收到错误消息，说 HTMLTableRowElement 没有名为 getElementsByName 的方法。还有什么办法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T20:26:31.253

对于这个特定的问题，您不应通过名称访问 DOM 元素，而应通过其 id 访问它们。

```
foo = document.getElementById("someID"); //Its unique 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-11T20:32:02.967

您还可以尝试获取所有选择元素，遍历它们并检查它们的名称：

```
var parent = obj.parentNode.parentNode;
var selects = parent.getElementsByTagName("select");
for (var i = 0; i < selects.length; i++) {
    if (selects[i].name == "day") {
        // selects[i] is the target
    }
} 
```

我确定它类似于 document.getElementsByName() 所做的，但不是先按标签搜索。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-11T20:23:04.400

getElementsByName() 方法访问具有指定名称的所有元素。

当您为每个选择指定不同的名称时，您可以直接访问它。

```
var x=document.getElementsByName("day"); 
```

不需要父母

# java - Java：如何实现一个队列系统来播放音频剪辑？

> ID：10113319
> 
> 赞同：2
> 
> 时间：2012-04-11T20:19:36.167
> 
> 标签：java, audio, queue

第一个问题/在这里发帖，希望我做对了！

使用java，我需要一种方法来以某种方式将音频文件添加到队列中，并在最后一个文件完成后播放下一个文件，因为此时它们只是相互重叠播放。我正在使用 Audiosystem 播放声音文件。

我想使用一个数组来存储等待播放的声音片段，但被难住了，不知道从那里去哪里。

希望有人能帮忙，谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-05T20:47:15.830

```
import javax.sound.midi.*;
import java.io.IOException;
import java.io.InputStream;
import java.io.FileInputStream;
import java.io.FileNotFoundException;

public class MidiPlayer{

  public static void main(String[] args) {
      try {
          Sequencer sequencer = MidiSystem.getSequencer();
          if (sequencer == null)
              throw new MidiUnavailableException();
          sequencer.open();
          FileInputStream is = new FileInputStream("music.mid");
          Sequence Seq = MidiSystem.getSequence(is);
          sequencer.setSequence(Seq);
          sequencer.start();
      } catch (Exception e) {
          e.printStackTrace();
      }
  }
here is a sample code that shows you how to play MIDI files in your java program, hope it helps 
```

# php - 404页面不存在

> ID：10113322
> 
> 赞同：0
> 
> 时间：2012-04-11T20:19:39.063
> 
> 标签：php, codeigniter

我试图弄清楚为什么我在加载页面时现在发现了一个 404 页面。我以为是因为文件结构，但现在我不知道为什么。

myurl.com/mycms/modules/bios/quotes

这是文件结构

```
root
root/mycms
root/mycms/application
root/mycms/application/modules
root/mycms/application/modules/bios/
root/mycms/application/modules/bios/controllers/quotes

<?php

if (!defined('BASEPATH')) exit('No direct script access allowed');

class Quotes extends CI_Controller
{

public function __construct()
{
    parent::__construct();
}

public function index()
{
    //Config Defaults Start
    $msgBoxMsgs = array(); //msgType = dl, info, warn, note, msg
    $cssPageAddons = ''; //If you have extra CSS for this view append it here
    $jsPageAddons = ''; //If you have extra JS for this view append it here
    $metaAddons = ''; //Sometimes there is a need for additional Meta Data such in the case of Facebook addon's
    $siteTitle = ''; //alter only if you need something other than the default for this view.
    //Config Defaults Start

    //examples of how to use the message box system (css not included).
    //$msgBoxMsgs[] = array('msgType' => 'dl', 'theMsg' => 'This is a Blank Message Box...');

    /**********************************************************Your Coding Logic Here, Start*/

    // Checks to see if a session is active for user and shows corresponding view page
    if ($this->kowauth->isLoggedIn())
    {
        $bodyContent = "testing"; //which view file
    }
    else
    {
        redirect('login', 'refresh');
    }
    $bodyType = "full"; //type of template

    /***********************************************************Your Coding Logic Here, End*/

    //Double checks if any default variables have been changed, Start.
    //If msgBoxMsgs array has anything in it, if so displays it in view, else does nothing.
    if (count($msgBoxMsgs) !== 0)
    {
        $msgBoxes = $this->msgboxes->buildMsgBoxesOutput(array('display' => 'show',
            'msgs' => $msgBoxMsgs));
    }
    else
    {
        $msgBoxes = array('display' => 'none');
    }

    if ($siteTitle == '')
    {
        $siteTitle = $this->metatags->SiteTitle(); //reads
    }

    //Double checks if any default variables have been changed, End.

    $this->data['msgBoxes'] = $msgBoxes;
    $this->data['cssPageAddons'] = $cssPageAddons; //if there is any additional CSS to add from above Variable this will send it to the view.
    $this->data['jsPageAddons'] = $jsPageAddons; //if there is any addictional JS to add from the above variable this will send it to the view.
    $this->data['metaAddons'] = $metaAddons; //if there is any addictional meta data to add from the above variable this will send it to the view.
    $this->data['pageMetaTags'] = $this->metatags->MetaTags(); //defaults can be changed via models/metatags.php
    $this->data['siteTitle'] = $siteTitle; //defaults can be changed via models/metatags.php
    $this->data['bodyType'] = $bodyType;
    $this->data['bodyContent'] = $bodyContent;
    $this->data['userData'] = $this->users->getUserByUserID($this->session->userdata('userID'));
    $roster = $this->kowauth->getRosterList($this->data['userData']->usersRolesID);
    $userRoster = array();
    foreach ($roster AS $member)
    {
        $userRoster[$member->id] = $member->rosterName;
    }
    $this->data['userRoster'] = $userRoster;
    $this->data['personalMessages'] = array($this->pmmodel->
        getInboxUnreadMessagesCount($this->session->userdata('userID')), $this->pmmodel->
        getInboxMessagesCount($this->session->userdata('userID')), $this->pmmodel->
        getLast5Messages($this->session->userdata('userID')));
    $this->load->view('cpanel/index', $this->data);
}
}

/* End of file quotes.php */
/* Location: ./application/modules/bios/controllers/quotes.php */ 
```

进程：

```
RewriteEngine On
RewriteBase /
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ index.php?/$1 [L]

RewriteEngine On
RewriteBase /kowmanager
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ index.php?/$1 [L] 
```

我没有任何自定义路线。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T07:40:21.833

通常在使用带有 CI 的模块时，您不需要在 URL 中包含“模块”一词。尝试访问 myurl.com/mycms/bios/quotes 可能是您的 cms 以不同的方式工作，但通常的理论是，您的模块中的任何控制器都可以通过使用模块名称和控制器名称来访问。如果您考虑在没有模块的情况下使用 CI，则不会在 URL 中使用“控制器”一词。

# entity-framework - 带有不公开外键属性的实体的 DbUpdateException

> ID：10113323
> 
> 赞同：8
> 
> 时间：2012-04-11T20:19:45.123
> 
> 标签：entity-framework, entity-framework-4, ef-code-first, entity-framework-4.3

我有一个带有`User`和`Person`实体的实体模型，这样每个实体都`User`必须与 1 准确关联`Person`，并且每个实体都`Person`可以与零或 1 关联`User`。

```
User (0..1) <-------> (1) Person 
```

该关联被流畅地映射。最初我只是在`Person`旁边声明：

```
private class PersonOrm : EntityTypeConfiguration<Person>
{
    internal PersonOrm()
    {
        ToTable(typeof(Person).Name, DbSchemaName.People);

        // has zero or one User
        HasOptional(p => p.User)
            .WithRequired(d => d.Person)
            .Map(d => d.MapKey("PersonId"))
            .WillCascadeOnDelete(false)
        ; 
```

由于我遇到了这个错误，所以我也在`User`旁边添加了相同的映射：

```
private class UserOrm : EntityTypeConfiguration<User>
{
    internal UserOrm()
    {
        ToTable(typeof(User).Name, DbSchemaName.Identity);

        // has exactly 1 Person
        HasRequired(p => p.Person)
            .WithOptional(d => d.User)
            .Map(d => d.MapKey("PersonId"))
            .WillCascadeOnDelete(false); 
```

在应用程序中有一个场景，`User`可以创建一个新的并将其与现有的`Person`. 这是我目前遇到困难的地方。EF 将其视为`User`关系的依赖方，并将`PersonId (FK, int, not null)`列放在`User`表上。我不相信可以在任一实体上使用外键属性来帮助 EF 管理关联（是吗？）。

这是一些尝试处理该场景的失败代码：

```
// find out if Person already exists
var person = context.People.SingleOrDefault(p => p.Emails.Any(
    e => e.Value.Equals(emailAddress, StringComparison.OrdinalIgnoreCase)));

// find out if User already exists
var user = context.Users.SingleOrDefault(
    u => u.Name.Equals(emailAddress, StringComparison.OrdinalIgnoreCase));

if (user == null)
{
    user = new User
    {
        Name = emailAddress,
        IsRegistered = isRegistered,
        Person = person ?? PersonFactory.Create(emailAddress),
        // ignore the PersonFactory.Create, that part works
    };

    context.Entry(user).State = EntityState.Added;
    context.SaveChanges();
} 
```

此代码在`person`为 null 时工作正常（数据库中尚不存在）。但是，当`person`is not null （已经存在于 db 中）并且`user`为 null 时，代码会尝试创建一个新的`User`并将其与现有的`Person`. 调用时`SaveChanges()`，我得到`DbUpdateException`：

> 保存不为其关系公开外键属性的实体时发生错误。EntityEntries 属性将返回 null，因为无法将单个实体标识为异常源。通过在实体类型中公开外键属性，可以更轻松地在保存时处理异常。有关详细信息，请参阅 InnerException。

内部异常是：

> 来自“User_Person”AssociationSet 的关系处于“已删除”状态。给定多重约束，相应的“User_Person_Source”也必须处于“已删除”状态。

这对我来说没有任何意义，因为我没有尝试删除任何内容，而是检查`EntityState`两者`User`并`Person`显示`User`处于`Added`状态，而`Person`处于`Unchanged`状态。我已经重写`SaveChanges()`以证明：

```
public override int SaveChanges()
{
    var userChanges = ChangeTracker.Entries<User>().Single();
    var personChanges = ChangeTracker.Entries<Person>().Single();

    if (userChanges.State == EntityState.Deleted)
        throw new InvalidOperationException("wtf?");

    if (personChanges.State == EntityState.Deleted)
        throw new InvalidOperationException("wtf?");

    return base.SaveChanges();
} 
```

当这段代码执行时，两者都不会`InvalidOperationException`被抛出。再次，`userChanges`处于`Added`状态，`personChanges`处于`Unchanged`状态。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-11T20:29:41.780

我现在真的觉得很傻。在写下这个仔细的问题之后，现在很明显了。

`Person`我正在测试的已经存在，并且已经与`User`不同的`User.Name`. 这就是为什么`user`会出现空值。将`Person.User`属性设置为新属性`User`会导致旧属性`User`进入`Deleted`状态。多哈。

很抱歉浪费了您的时间。我会留下这个问题，除非它同意删除它会更好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-29T15:51:28.347

确保您在映射中定义了关系（实体类型配置）

例如：

this.HasRequired(t => t.QuoteResponse).WithMany(t => t.QuoteResponseItems).HasForeignKey(d => d.QuoteResponseID);

# html - HTML：控制每行的字符数 环境

> ID：10113324
> 
> 赞同：0
> 
> 时间：2012-04-11T20:19:45.997
> 
> 标签：html

我想要以下代码：

```
<pre style="voodoo">123456789</pre> 
```

显示为：

```
123
456
789 
```

（一般来说，我有大量文本，我想在一行中准确显示 n 个字符，其中 n 是任意数字）。

所以我尝试了这个：

```
<pre style="width:3em; word-wrap:break-word;">123456789</pre> 
```

但是 em 并不是这样工作的。和 px 也是如此。我有一个描述字体宽度的单位（尤其是在环境中）？还是我应该更改另一个属性而不是宽度？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T20:24:53.687

[< `pre`>][1] 的全部意义在于保留格式（空白），这与您尝试做的相反！虽然这似乎对我有用

```
<div style="word-wrap: break-word;width:60px">
12345678910123456789
</div>

<pre style="word-wrap: break-word;width:60px">
12345678910123456789
</pre> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T20:39:06.877

以下似乎有效：

```
pre {
    width: 2em;
    word-wrap: break-word;
} 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/N3cqb/)。

尽管我怀疑完美的宽度以及每行字符数与宽度之间的关系似乎有些武断，并且是通过反复试验发现的。所以虽然它有效（至少在 Chromium 17/Ubuntu 11.04 中），但我对它并不特别满意。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-11T20:42:47.617

您可以尝试手动选择适当的 值`width`，但我不确定它在所有浏览器/系统中是否都能正常工作。

顺便说一下`em`“符号m的宽度”，所以它应该做这项工作。但是没有，不知道为什么。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-11T20:43:48.130

这两个都在 Firefox 中工作，但我不知道其他浏览器：

```
<pre wrap width="3" style="word-wrap:break-word;">123456789</pre>
<pre style="width: 3ch; white-space: pre-wrap; word-wrap: break-word;">123456789</pre> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-11T20:49:52.040

您可以使用以下公式计算宽度值

宽度 =（每行符号数）/1.5

例如

每行 9 个符号 / 1.5 = 6em

如果您不使用 font-size-adjust 它将起作用

# ios - 为什么没有在 IOS 中使用 CGRectIntersectsRect 进行碰撞检测？

> ID：10113332
> 
> 赞同：0
> 
> 时间：2012-04-11T20:20:21.737
> 
> 标签：ios, collision-detection, cgrectmake

我有 4 个元素：从屏幕顶部落下的绿球、黄球、橙球和红球

我也有一个元素，蓝球，跟随我的触摸。

所有这些东西都很好用！:D

但是，我想检测绿球何时与蓝球相交

我的蓝色球放置在 viewDidLoad 的视图中，这 4 个球基于调用 onTimer 的 nstimer 放置在视图上。

所有 5 个球都在同一层上创建：

```
[self.view insertSubview:greenImage belowSubview:bottomBar] 
```

我可以检测到红球和绿球何时碰撞：

```
if (CGRectIntersectsRect(greenImage.frame, redImage.frame)) {
                UIAlertView *message = [[UIAlertView alloc] initWithTitle:@"title" message:@"points" delegate:nil cancelButtonTitle:@"cool" otherButtonTitles:nil];
                [message show];
                [message release];
            } 
```

如果我将“redImage”替换为“blueball”，我不会收到警报。我认为这可能是因为它们没有以相同的方法声明。

关于如何检测这种碰撞的任何想法？

谢谢！

**- - 编辑 - -**

使用下面的建议，我正在执行以下操作：

```
 greenImage = [[UIImageView alloc] initWithImage:green];
        greenImage.frame = CGRectMake(startX,0,43,43);
        [self.view insertSubview:greenImage belowSubview:bottomBar];
        [UIView beginAnimations:nil context:greenImage];
        [UIView setAnimationDuration:5 * speed];
        greenImage.frame = CGRectMake(startX, 500.0, 43,43);
        CGFloat r1 = greenImage.frame.size.width * .5;
        CGFloat r2 = blueBall.frame.size.width * .5;
        if(CGPointDistance(greenImage.center, blueBall.center) < (r1 + r2)){
            UIAlertView *message = [[UIAlertView alloc] initWithTitle:@"notice" message:@"hit!" delegate:nil cancelButtonTitle:@"cool" otherButtonTitles:nil];
            [message show];
            [message release];
        } 
```

在这个方法下面我有：

```
CGFloat CGPointDistance(CGPoint p1, CGPoint p2)
{
    return sqrtf((p1.x-p2.x)*(p1.x-p2.x) + (p1.y-p2.y)*(p1.y-p2.y));
} 
```

得到一个错误：

> 'CGPointDistance' 的冲突类型

和一个警告：

> 函数'CGPointDistance'的隐式声明

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T22:16:58.820

要确定两个圆是否相交，您只需查看中心之间的距离是否小于它们的半径之和。例如...

```
CGFloat CGPointDistance(CGPoint p1, CGPoint p2)
{
    return sqrtf((p1.x-p2.x)*(p1.x-p2.x) + (p1.y-p2.y)*(p1.y-p2.y));
} 
```

看起来你的“球”是视图......假设“球”填充框架，半径将是宽度的 1/2......

```
BOOL BallsCollide(UIView *v1, UIView *v2)
{
    CGFloat r1 = v1.frame.size.width * .5;
    CGFloat r2 = v2.frame.size.width * .5;
    return CGPointDistance(v1.center, v2.center) < (r1 + r2);    
} 
```

好的——我已经破解了一个快速样本。你几乎可以把它放到你的视图控制器中。不要将它用于生产...只是作为您如何做东西的示例...您可以将它放在顶部，将控制器的其余部分放在它下面...

```
// I do not recommend using this approach for naything non-trivial,
// but it demonstrates the very simple collision detection for circle shapes.
@interface Ball : UIView {
}
@property (nonatomic, strong) UIColor *origColor;
@property (nonatomic, strong) UIColor *color;
+ (id)ballWithRadius:(CGFloat)radius color:(UIColor*)color;
- (BOOL)doesIntersectWith:(Ball*)ball;
@end
@implementation Ball
@synthesize color = _color;
@synthesize origColor = _origColor;
+ (id)ballWithRadius:(CGFloat)radius color:(UIColor*)color
{
    CGFloat diameter = radius * 2;
    Ball *ball = [[Ball alloc] initWithFrame:CGRectMake(0, 0, diameter, diameter)];
    ball.color = ball.origColor = color;
    ball.backgroundColor = [UIColor clearColor];
    return ball;
}
- (BOOL)doesIntersectWith:(Ball *)ball
{
    // Two circles overlap if the sum of their radii
    // is less than the distance between the two centers.
    CGFloat r1 = self.frame.size.width * .5;
    CGFloat r2 = ball.frame.size.width * .5;
    CGFloat diffX = self.center.x - ball.center.x;
    CGFloat diffY = self.center.y - ball.center.y;
    return (diffX*diffX) + (diffY*diffY) < (r1+r2)*(r1+r2);
}
- (BOOL)containsPoint:(CGPoint)point
{
    // Contains a point if distance from center is less than radius
    CGFloat r = self.frame.size.width *.5;
    CGFloat diffX = self.center.x - point.x;
    CGFloat diffY = self.center.y - point.y;
    return (diffX*diffX) + (diffY*diffY) < r*r;
}
- (void)drawRect:(CGRect)rect
{
    CGContextRef context = UIGraphicsGetCurrentContext();
    [self.color setFill];
    [self.color setStroke];
    CGContextSetLineWidth(context, 1);
    CGContextFillEllipseInRect(context, self.bounds);
}
@end

@interface CollideVC() {
    NSMutableDictionary *activeTouches;
    NSMutableSet *currentCollisions;
}
@end

@implementation CollideVC
- (void)ball:(Ball*)ball touched:(UITouch*)touch
{
    [activeTouches setObject:ball forKey:[NSValue valueWithPointer:(__bridge void*)touch]];
}
- (Ball*)getBallTouchedBy:(UITouch*)touch
{
    return [activeTouches objectForKey:[NSValue valueWithPointer:(__bridge void*)touch]];
}
- (void)stopTouch:(UITouch*)touch
{
    [activeTouches removeObjectForKey:[NSValue valueWithPointer:(__bridge void*)touch]];
}
- (void)ball:(Ball*)ball1 hasCollidedWith:(Ball*)ball2
{
    [currentCollisions addObject:ball1];
    [currentCollisions addObject:ball2];
    ball1.color = ball2.color = [UIColor yellowColor];
    [ball1 setNeedsDisplay];
    [ball2 setNeedsDisplay];
}

// NOTE: You should delegate handling of collisions...
- (void)checkForCollisions
{
    // Should filter those that don't actually need redisplay...
    // For simplicity, all that were or are colliding get it...
    [currentCollisions enumerateObjectsUsingBlock:^(Ball *ball, BOOL *stop) {
        [ball setNeedsDisplay];
        ball.color = ball.origColor;
    }];
    [currentCollisions removeAllObjects];
    NSArray *views = self.view.subviews;
    for (size_t i = 0; i < views.count; ++i) {
        id v = [views objectAtIndex:i];
        if (![v isKindOfClass:[Ball class]]) continue;
        Ball *ball1 = v;
        for (size_t j = i+1; j < views.count; ++j) {
            v = [views objectAtIndex:j];
            if (![v isKindOfClass:[Ball class]]) continue;
            Ball *ball2 = v;
            if ([ball1 doesIntersectWith:ball2]) {
                [self ball:ball1 hasCollidedWith:ball2];
            }
        }
    }
}
- (void)addBallWithRadius:(CGFloat)radius point:(CGPoint)point color:(UIColor*)color
{
    Ball *ball = [Ball ballWithRadius:radius color:color];
    ball.center = point;
    [self.view addSubview:ball];
}

- (void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event
{
    for (UITouch *touch in touches) {
        CGPoint touchLocation = [touch locationInView:self.view];
        for (Ball *ball in self.view.subviews) {
            if ([ball containsPoint:touchLocation]) {
                [self ball:ball touched:touch];
            }
        }
    }
}
- (void)touchesMoved:(NSSet *)touches withEvent:(UIEvent *)event
{
    for (UITouch *touch in touches) {
        // Use relative distance so center does nt jump to tap location.
        CGPoint prev = [touch previousLocationInView:self.view];
        CGPoint curr = [touch locationInView:self.view];
        CGPoint c = [self getBallTouchedBy:touch].center;        
        [self getBallTouchedBy:touch].center = CGPointMake(c.x+curr.x-prev.x, c.y+curr.y-prev.y);
    }
    // NOTE: This does not check the path between the moves, only the new point.
    // So a fast movement "past" the other object will not get detected.
    // If you want to do comple detection, use an existing engine
    [self checkForCollisions];
}
- (void)touchesEnded:(NSSet *)touches withEvent:(UIEvent *)event
{
    for (UITouch *touch in touches) {
        [self stopTouch:touch];
    }
}
- (void)touchesCancelled:(NSSet *)touches withEvent:(UIEvent *)event
{
    [self touchesEnded:touches withEvent:event];
}

- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
    if (self) {
        // Custom initialization
    }
    return self;
}
- (void)viewDidLoad
{
    [super viewDidLoad];
    activeTouches = [NSMutableDictionary dictionary];
    currentCollisions = [NSMutableSet set];
    [self addBallWithRadius:20 point:CGPointMake(110, 100) color:[UIColor blueColor]];
    [self addBallWithRadius:20 point:CGPointMake(200, 200) color:[UIColor redColor]];
    [self addBallWithRadius:20 point:CGPointMake(235, 250) color:[UIColor greenColor]];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T20:27:05.217

也许这会有所帮助，只需对上面的代码进行一些修改。

```
-(CGFloat)CGPointDistance:(CGPoint)p1 p2:(CGPoint)p2
{
    return sqrtf(powf(p1.x - p2.x) + powf(p1.y-p2.y));
}

-(BOOL)DidCollide:(View*)v1 v2:(View*)v2 v1Radius:(CGFloat)v1Radius v2Radius:(CGFloat)v2Radius
{
    CGFloat r1 = v1.frame.size.width * v1Radius;
    CGFloat r2 = v2.frame.size.width * v2Radius;
    return [self PointDistance:v1.center p2:v2.center] < (r1 + r2)
} 
```

并检查碰撞你只是做

```
if([self DidCollide:view1 v2:view2 v1Radius:radius v2Radius:radius])
{
    //do something
} 
```

# sql - ORA-06532: 下标超出限制错误

> ID：10113335
> 
> 赞同：0
> 
> 时间：2012-04-11T20:20:26.837
> 
> 标签：sql, arrays, plsql

我的 pl/sql 过程中出现 ORA-06532 错误。它与我的数组有关，它似乎发生在以“term_1 := ...”开头的行上。选择进入的查询有 7 条记录，因此它应该与我要求的数量相同。我对 SQL 数组有点陌生，所以我可能错过了一些明显的东西。任何帮助表示赞赏，谢谢。

```
DECLARE

listOfTerms      VC50_ARRAY;
term_1           varchar2(30);
term_2           varchar2(30);
term_3           varchar2(30);
term_4           varchar2(30);
term_5           varchar2(30);
term_6           varchar2(30);
term_7           varchar2(30);

BEGIN

SELECT apl.awdp_acad_terms 
BULK COLLECT INTO listOfTerms
FROM fa_years fay 
   JOIN award_periods_ls apl
     ON apl.award_periods_id = fay.award_periods_id 
WHERE (SELECT b.awdp_fa_year as faYear 
      FROM award_periods_ls a 
           JOIN coll18_test.fa_years b ON a.award_periods_id = b.award_periods_id 
     WHERE awdp_acad_terms = v_ug_term) = fay.awdp_fa_year
ORDER BY apl.awdp_acad_terms DESC;

term_1   := listOFTerms(1);     
term_2   := listOFTerms(2);             
term_3   := listOFTerms(3);
term_4   := listOFTerms(4);             
term_5   := listOFTerms(5);             
term_6   := listOFTerms(6);             
term_7   := listOFTerms(7); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T20:42:20.183

我认为你过于复杂了。您的代码相当于：

```
DECLARE

   -- Declare the cursor explicitly.
   cursor c_my_cursor is
     SELECT apl.awdp_acad_terms 
       FROM fa_years fay 
       JOIN award_periods_ls apl
         ON apl.award_periods_id = fay.award_periods_id 
      WHERE ( SELECT b.awdp_fa_year as faYear 
                FROM award_periods_ls a 
                JOIN coll18_test.fa_years b 
                  ON a.award_periods_id = b.award_periods_id 
               WHERE awdp_acad_terms = v_ug_term ) = fay.awdp_fa_year
      ORDER BY apl.awdp_acad_terms DESC;

   -- Create a-user defined type that is the same as a single row in the cursor.
   type t__listOfTerms is table of c_my_cursor%rowtype index by binary_integer;
   -- Initialise a variable that is of data-type t__listofterms.
   t_listofterms t__listofterms;

BEGIN

   open c_my_cursor;
   fetch c_my_cursor bulk collect into t_listofterms;
   close c_my_cursor;

END; 
```

然后，您可以通过索引值引用您类型中的项目，因此`term_1`与`t_listofterms(1)`. 无需创建具有相同值的附加变量；您可以以相同的方式引用它，`length(term1)`并且`length(t_listofterms(1))`也相同。

有很多关于数组处理的资料，但[PSOUG](http://psoug.org/reference/array_processing.html)[和文档](http://docs.oracle.com/cd/E11882_01/appdev.112/e10766/tdddg_subprograms.htm#BABDFGAA)一样很有帮助。

* * *

从您的评论来看，您可能明确引用了该集合，即`something := t_listofterms(7)`. 这假定存在特定数量的行。`Bulk collect`填充从*1*到*n*的集合，其中*n*是查询返回的行数。如果您想用它做某事而不是显式引用，那么循环遍历它通常会更好。就像是，

```
for i in t_listofterms.first .. t_listofterms.last loop

    do_something;

end loop; 
```

# json - jQuery Mobile 中来自 Wordpress JSON 的新闻页面

> ID：10113336
> 
> 赞同：1
> 
> 时间：2012-04-11T20:20:28.360
> 
> 标签：json, wordpress, jquery-mobile

我开始使用 jQuery Mobile 和 PhoneGap。我有一个应用程序，我想显示来自 Wordpress 博客的五个最新帖子，当您单击一个时，它会在新页面中加载该帖子的内容。使用 JSON api 插件，我能够吐出最近帖子的标题列表。

我坚持的是将这些标题制作成链接，这些链接将加载带有各自内容的新页面。我已经阅读了有关动态页面生成的 JQM 文档，但我有点迷茫。

我当前的代码如下所示：

```
var urlNews="http://wordpress-site.com/";
$.getJSON(urlNews,function(json){
        $.each(json.posts,function(i,post){
            $("#recentNews").append(
            '<li><a href="#dont-know-what-to-put-here" class="ui-link">'+post.title+'</a></li>'
         );
      });
      $('#recentNews li:gt(4)').remove();
}); 
```

我尝试从[此处](http://jquerymobile.com/demos/1.1.0-rc.2/docs/pages/page-dynamic.html)的官方文档中调整示例代码，但没有任何运气。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T00:03:08.187

这是我用来显示 Wordpress 博客内容的代码：

```
 var MYBLOG_LIMIT = 7;
var MYWRAPPER_CLASS = 'homeblog';

var WP={open:function(b){var a={posts:function(){var d=MYBLOG_LIMIT;var e=0;var c={all:function(g){var f=b+"/api/get_recent_posts/";f+="?count="+d+"&page="+e+"&callback=?";jQuery.getJSON(f,function(l){var k=l.posts;for(var j=0;j<k.length;j++){var h=k[j];h.createComment=function(i,m){i.postId=h.id;a.comments().create(i,m)}}g(k)})},findBySlug:function(f,h){var g=b+"/api/get_post/";g+="?slug="+f+"&callback=?";jQuery.getJSON(g,function(i){h(i.post)})},limit:function(f){d=f;return c},page:function(f){e=f;return c}};return c},pages:function(){var c={findBySlug:function(d,f){var e=b+"/api/get_page/";e+="?slug="+d+"&callback=?";jQuery.getJSON(e,function(g){f(g.page)})}};return c},categories:function(){var c={all:function(e){var d=b+"/api/get_category_index/";d+="?callback=?";jQuery.getJSON(d,function(f){e(f.categories)})}};return c},tags:function(){var c={all:function(e){var d=b+"/api/get_tag_index/";d+="?callback=?";jQuery.getJSON(d,function(f){e(f.tags)})}};return c},comments:function(){var c={create:function(f,e){var d=b+"/api/submit_comment/";d+="?post_id="+f.postId+"&name="+f.name+"&email="+f.email+"&content="+f.content+"&callback=?";jQuery.getJSON(d,function(g){e(g)})}};return c}};return a}};

var blog = WP.open('http://www.endofphotography.com/');

blog.posts().all(function(posts){
    for(var i = 0; i < posts.length; i++){
        jQuery('.'+MYWRAPPER_CLASS).append(function(){
    return (posts[i].content) ? '<div class="lastpost_title" href="'+posts[i].url+'"><h4>'+posts[i].title+'</h4></div><div href="'+posts[i].url+'">'+posts[i].content+'<br>'+posts[i].date+'</div><br><hr><br>' : '<div href="'+posts[i].url+'"><h4>'+posts[i].date+'</h4></div>';
   });
  }
}); 
```

我遇到了相反的问题，并试图禁用链接。特别是对于图像。我不希望用户在他们的手机上滚动并意外点击链接并将他们发送到应用程序之外。您可以通过在您的 Wordpress 管理员帐户中编辑帖子的 HTML 标记来控制这一点。我是手动完成的。

对于标题，作为一个临时解决方案，因为我不相信默认情况下使用 JSON API 可以点击它们，我会在 Wordpress 编辑器中手动执行类似的操作：

```
 <a href="#YourLink"><h4>Click here to read full article</h4></a> 
```

# dojo - 在 dojo 1.7.2 中进行自定义构建

> ID：10113339
> 
> 赞同：1
> 
> 时间：2012-04-11T20:20:41.237
> 
> 标签：dojo, dojo-build

我需要一些关于我的 Dojo 1.7.2 自定义构建的帮助 - 构建工作正常，但在浏览器中返回错误。

这是我的个人资料文件：

```
dependencies = {
    layers: [
            {
                    // This is a specially named layer, literally 'dojo.js'
                    // adding dependencies to this layer will include the modules
                    // in addition to the standard dojo.js base APIs.
                    name: "dojo.js",
                    dependencies: [
                            "dijit.registry",
                            "dijit.Dialog",
                            "dijit.Tooltip",
                            "dijit.form.Button",
                            "dijit.layout.ContentPane"
                    ]
            }
    ],

    prefixes: [
            [ "dijit", "../dijit" ],
            [ "dojox", "../dojox" ]
    ] 
```

}

我认为我不需要添加“digit.registry”——生成的 dojo.js 文件无论有没有它都不会改变。因为我使用了 digit.byId，所以我使它成为一个依赖项

这是我的构建方式：

```
./build.sh -r --profile profiles/my.profile.js --releaseDir /my/release/directory 
```

然后，我将生成的 dojo.js 包含在我的 html 代码中。当页面加载时，javascript 控制台在尝试使用 digit.byId 执行某些操作时显示错误“_5c4 不是函数”。

当我从 ajax.googleapis.com 加载完整的 Dojo 时，一切正常。

我也应该在 html 中包含 ../dijit/dijit.js 吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T01:19:11.700

检查您的拼写数字-> dijit

# java - Java（仅限 Windows 的问题）：当弹出模态对话框并单击阻止的 JFrame 时，alwaysOnTop JFrame 落在 z 顺序的底部

> ID：10113341
> 
> 赞同：2
> 
> 时间：2012-04-11T20:20:59.063
> 
> 标签：java, swing, jdialog, z-order, modality

我有一个 Java 应用程序，其基本 UI 由两个 JFrame 组成：一个客户区和一个应始终出现在客户区上方的工具面板。为了实现这一点，工具调色板设置为 alwaysOnTop(true)，它在所有情况下都能很好地工作，除了 Windows 独有的一个：当弹出模式 JDialog 时，单击客户区域和/或调色板（两者都是阻塞）导致调色板落在客户区后面。关闭模态对话框后，调色板会重新出现，但它的“始终处于顶部”已经丢失：单击客户区域会遮盖调色板。

这是一个最小的单一源文件演示：

```
// FloatingPaletteExample.java
// 4/11/2012 sorghumking
//
// Demo of a Windows-only issue that has me puzzled: When a modal dialog is
// opened, and user clicks in blocked JFrames (sequence depends on ownership of
// modal dialog: follow the instructions in modal dialog to see the problem
// behavior), the floating tool palette loses its "always on top-ness". 

import javax.swing.*;

import java.awt.BorderLayout;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.event.WindowAdapter;
import java.awt.event.WindowEvent;

public class FloatingPaletteExample {
    public static void main( String [] args ) {
        final JFrame clientAreaJFrame = new JFrame( "client JFrame" ); 
        clientAreaJFrame.addWindowListener( new WindowAdapter() {
            public void windowClosing( WindowEvent windowevent ) {
                clientAreaJFrame.dispose();
                System.exit( 0 );
            }
        });

        clientAreaJFrame.setSize( 800, 600 );
        clientAreaJFrame.setVisible( true );

        final JFrame floatingToolFrame = new JFrame("tool JFrame");
        final JCheckBox ownerCheckbox = new JCheckBox("Owned by tool frame (otherwise, null owner)");
        JButton popModalButton = new JButton("Open Modal Dialog");
        popModalButton.addActionListener( new ActionListener() {
            public void actionPerformed(ActionEvent e) {
                JFrame owner = ownerCheckbox.isSelected() ? floatingToolFrame : null;
                JDialog modalDialog = new JDialog(owner, "Modal Dialog", true);
                final String labelText = ownerCheckbox.isSelected() ? "Click anywhere in the client JFrame." :
                                                                      "Click the tool JFrame, then anywhere in the client JFrame";
                modalDialog.add(new JLabel(labelText));
                modalDialog.pack();
                modalDialog.setLocation(100, 100);
                modalDialog.setVisible(true);
            }
        });
        floatingToolFrame.add(popModalButton, BorderLayout.NORTH);
        floatingToolFrame.add(ownerCheckbox, BorderLayout.SOUTH);

        floatingToolFrame.pack();
        floatingToolFrame.setLocationRelativeTo(clientAreaJFrame);
        floatingToolFrame.setAlwaysOnTop(true);
        floatingToolFrame.setVisible(true);
    }
} 
```

我尝试了 floatingToolFrame.setFocusableWindowState(false)，根据[文档](http://docs.oracle.com/javase/1.4.2/docs/api/java/awt/Window.html#setFocusableWindowState(boolean))，它是“应用程序向 AWT 识别将用作浮动调色板或工具栏的窗口的标准机制”，但行为保持不变。

我确实找到了一种解决方法：在弹出模式对话框之前调用 floatingToolFrame.setAlwaysOnTop(false)，并在关闭后调用 floatingToolFrame.setAlwaysOnTop(true)。但是，在打开模式对话框的任何时候都要求这种包装似乎很荒谬。是的，我可以将 JDialog 子类化并从所述子类派生我的所有对话框以在幕后执行此操作，但同样，为什么这是必要的？

关于如何在没有解决方法的情况下解决此问题的任何想法？我创建始终在顶部的调色板的方法是否完全被误导了？（还有一点需要注意：这似乎与此处描述的问题相反：[Java 6, JFrame stand alwaysontop](https://stackoverflow.com/questions/4014631/java-6-jframe-stuck-alwaysontop)）。

任何想法将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T21:47:22.300

令我非常高兴的是，这个问题似乎在**Java 7 SE**中得到了解决！[上面的示例在7u4 Build b20](http://jdk7.java.net/download.html)上运行正常。

# c# - 如何以编程方式在 asp.net 树视图控件中的子节点上设置 showCheckbox

> ID：10113342
> 
> 赞同：0
> 
> 时间：2012-04-11T20:21:02.447
> 
> 标签：c#, asp.net, treeview

我想弄清楚如何通过代码将复选框设置为 asp.net webform 中的子节点。

我的方法：

```
protected void CreateTreeViewList(System.Web.UI.WebControls.Panel p, ICollection<Agency> a)
        {
            TreeView agencyTreeView = new TreeView();

            var results = a;

            foreach (var item in results)
            {
                TreeNode node = new TreeNode(item.AgencyName);

               // var myagencies = item.SecurityDataShares1;

                Array entityList = Enum.GetValues(typeof(Entities));

                foreach (var ei in entityList)
                {
                   node.ShowCheckBox = true;
                   node.ChildNodes.Add(new TreeNode(ei.ToString()));
               }

                node.ChildNodes.Add(new TreeNode());

                agencyTreeView.Nodes.Add(node);
            }
            p.Controls.Add(agencyTreeView);
        } 
```

这是我对树视图控件的第一次拍摄，所以它可能有点偏离（任何提示将不胜感激）。

我被困在嵌套的 foreach 上，我可以让节点渲染出来（实体列表只是 10 个文本元素的数组）。我似乎无法弄清楚如何分配一个显示文本框

我试过了

```
node.ChildNodes.Add(new TreeNode(ei.ToString()).ShowCheckbox = true); 
```

虽然智能感知支持它，但编译器抛出并出错。

另外作为旁注，我注意到复选框列表将节点显示为链接有没有办法禁用它？

提前致谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T20:50:59.700

经过更多搜索后，我发现了 TreeNodeTypes 属性

将以下行添加到方法的末尾或之前`p.Controls.Add(agencyTreeView)`

为每个子节点添加了复选框

```
agencyTreeView.ShowCheckBoxes = TreeNodeTypes.Leaf; 
```

希望这可以帮助任何有兴趣的人

# c++ - 当通知程序/信号超出范围时，在提升绑定中解除分配回调侦听器对象

> ID：10113346
> 
> 赞同：2
> 
> 时间：2012-04-11T20:21:20.000
> 
> 标签：c++, visual-c++, boost, memory-leaks, boost-signals

我处于将指针保存在向量中的情况，以便我可以使用它们来释放 dtor 中的内存。

我有一个对象监听来自 boost 信号的回调（槽）。这些对象的范围需要大于创建它的方法，因为它应该监听比创建位置晚得多的 boost 信号。所以，我必须在堆中分配内存并立即使用该实例订阅增强信号。

现在，当持有信号的类被销毁时，应该从内存中释放这些对象。现在我的选择是什么，

*   当 boost 信号超出范围并且所有监听 boost:bind 对象被销毁时，boost 是否会释放所有这些对象？

*   共享指针或智能指针会帮助我吗？

*   我是否必须在信令服务中有一个包含所有这些指针的向量才能在其析构函数中释放？有更好的方法吗？

    ```
    void methodA(){

    CallbackHandler* cbHandler=new CallbackHandler(..);    //Allocating in heap as we want to receive boost signals on  
                                                           //this instance even after this method exits
    signalingService.subscribeToCertainSignals(signalType,boost::bind(&CallbackHandler::boostSlotListener,cbHandler,_1));
    }

    // Boost Signal -SignalingService
     boost::signal<void (const std::string &msg)> signal1;
     boost::signal<void (const std::string &msg)> signal2;

     void subscribeToCertainSignals(const std::string& signalType,boost::function<void (const std::string& str)> bindObject){
            this->signal1.connect(bindObject);
            this->signal2.connect(bindObject);

     }
     void sendSignals(A a){
         if(check){
            this->signal1("somestring1");
          }else{
            this->signal1("somestring1");
          } 
    ```

    };

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T21:35:14.817

您可以这样做的一种方法是将`shared_ptr`s 存储到持有信号的对象中的所有侦听器，并将`weak_ptr`s 存储到外部的侦听器。当持有信号的对象被销毁时，每个`shared_ptr`s 中的引用计数将转到`0`并且指向的侦听器将被删除。现在，当您下次尝试锁定`weak_ptr`s 以从持有信号的对象外部访问侦听器时，锁定将失败，因为指针将被删除 - 这很容易检测到，因为`lock`将返回 null `shared_ptr`。

这是一个具体的例子（不幸的是，没有使用 Boost.Signals，只是为了说明这一点）：

```
#include <iostream>
#include <memory>
#include <vector>

class Listener
{
public:
    virtual ~Listener() {}
    virtual void signal() = 0;
};

class Subject
{
private:
    std::vector<std::shared_ptr<Listener> > m_listeners;
public:
    void add_listener(const std::shared_ptr<Listener>& listener)
    {
        m_listeners.push_back(listener);
    }

    void signal_all()
    {
        // Note that you could use "auto it = ..." here in C++11.
        for(std::vector<std::shared_ptr<Listener> >::iterator it=m_listeners.begin(), iend=m_listeners.end(); it!=iend; ++it)
        {
            (*it)->signal();
        }
    }
};

class MyListener : public Listener
{
    void signal()
    {
        std::cout << "Signalled!\n";
    }
};

int main()
{
    std::vector<std::weak_ptr<Listener> > listeners;

    {
        Subject s;  

        std::shared_ptr<Listener> listener(new MyListener);
        s.add_listener(listener);
        listeners.push_back(listener);
        listener.reset();

        s.signal_all();

        // Locking the listener yields the listener here.
        std::cout << listeners[0].lock() << '\n';
    }

    // Locking the listener now yields null because s no longer exists.
    std::cout << listeners[0].lock() << '\n';

    return 0;
} 
```

这输出：

```
Signalled!
<some valid non-null address>
00000000 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-07-12T20:28:31.537

我认为最好使用 boost scoped_connection。该对象专为您正在寻找的东西而设计。

例如，您可以将作用域连接存储在列表中，当列表的所有者死亡时，列表将调用作用域连接的析构函数，并且会自动断开您的对象与信号槽的连接。

在此处阅读详细信息：

[http://www.boost.org/doc/libs/1_46_1/doc/html/boost/signals2/scoped_connection.html](http://www.boost.org/doc/libs/1_46_1/doc/html/boost/signals2/scoped_connection.html)

# mysql - “IN”子句中的子查询

> ID：10113351
> 
> 赞同：6
> 
> 时间：2012-04-11T20:21:40.017
> 
> 标签：mysql, sql, subquery

```
SELECT * FROM `image_appreciations`
WHERE `image_id` IN(SELECT `id` FROM `images` WHERE `user_id` = '1') 
```

是我当前的查询，它返回零结果

```
SELECT `id` FROM `images` WHERE `user_id` = '1' 
```

作为子查询返回大约 8 个 id，其中两个位于

```
SELECT * FROM `image_appreciations`
WHERE `image_id` IN(77,89) 
```

这很好用。但总的来说它失败了。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-11T20:25:25.807

这可以使用`JOIN`. 下面是使用隐式速记语法的示例。

```
SELECT * FROM image_appreciations a, images i
WHERE a.image_id = i.id AND i.user_id = 1 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-11T20:25:13.317

像这样的子查询“应该”工作，奇怪的是它不是。无论如何，您可以尝试使用 a`JOIN`来解决这个问题。

```
SELECT * FROM `image_appreciations`
JOIN `images` ON `image_id` = `id`
WHERE `images`.`user_id` = '1' 
```

# sql - 无法找出此 teradata 脚本中的错误

> ID：10113352
> 
> 赞同：0
> 
> 时间：2012-04-11T20:21:45.520
> 
> 标签：sql, oracle, teradata

脚本如下：

```
SELECT
   CAST(SUBSTR(TRIM(ABU_PTY_CD),4,2) AS CHAR(2)) ABU_PTY_CD,
   ACCTG_PRD_YR_CD,
   ACCTG_PRD_MO_CD ,

   CASE 
       WHEN (OUDS_FAC_CD > ' ' ) THEN CAST (SUBSTR(OUDS_FAC_CD, 1, 5) AS CHAR(5))
       ELSE CAST (COALESCE(CC_PTY_CD, '') AS CHAR(5)) 
   END OUDS_FAC_CD,

   CASE 
       WHEN GL_ACCT_NUM > ' ' THEN CAST (SUBSTR(GL_ACCT_NUM, 1, 12) AS CHAR(12)) 
       ELSE CAST (SAP_ACCT_NUM AS CHAR(12)) 
   END ACCT_NUM,

   CASE
       WHEN LE_PTY_CD > ' ' THEN CAST (LE_PTY_CD AS CHAR(4) )
       ELSE CAST (SUBSTR( COMP_PTY_CD, 1, 4) AS CHAR(4) )
   END COMP_PTY_CD,

   JE_LWR_TIER_RPTG_NUM, 
   LT2_NM, 

   CASE
       WHEN PRD_VAR_CD > ' ' THEN CAST (PRD_VAR_CD AS CHAR(3))
       ELSE CAST (COALESCE(FA_PTY_CD, '') AS CHAR(3))  
   END FA_PTY_CD,

   JE_LN_GLBL_CCY_CD, 
   JE_LN_LC_CD,

   CASE 
       WHEN GL_ACCT_LVL_NUM > ' ' THEN CAST(SUBSTR(GL_ACCT_LVL_NUM,1,10)  AS CHAR(11) ) 
       ELSE CAST(SUBSTR(FNCL_STMT_LN_NUM,1,11) AS CHAR(11) )
   END ACCT_LVL_NUM,

   SUM (JE_LN_GLBL_AMT) JE_LN_GLBL_AMT, 
   DDU_FAC_CD, 
   JE_HDR_DESC, 
   JE_HDR_NUM, 
   JE_GRP_NUM, 
   SOURCE_SYSTEM_ID
FROM   EDW_BI_SL_M1.BFV 
WHERE  CPC_PTY_CD = '00000000SX'
       AND TO_CHAR(RPTG_ACCTG_DT, 'YYYY')  >= TO_CHAR(ADD_MONTHS((CURRENT_DATE),-1),'YYYY')
       AND JE_VERS_NUM in ('200', '001') 
       AND SRC_LDGR_CD <> 'LG'
       AND ACCTG_PRD_MO_CD < 13
GROUP BY ABU_PTY_CD, ACCTG_PRD_YR_CD, ACCTG_PRD_MO_CD, OUDS_FAC_CD, ACCT_NUM, COMP_PTY_CD, JE_LWR_TIER_RPTG_NUM, 
LT2_NM, FA_PTY_CD, JE_LN_GLBL_CCY_CD, JE_LN_LC_CD, ACCT_LVL_NUM, JE_LN_GLBL_AMT, DDU_FAC_CD, JE_HDR_DESC, JE_HDR_NUM, JE_GRP_NUM, 
SOURCE_SYSTEM_ID; 
```

**错误信息：**

3504: 选定的非聚合值必须是关联组的一部分

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T20:52:19.593

您已`JE_LN_GLBL_AMT`在`GROUP BY`子句中包含该列，但这是一个总和值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-12T07:19:58.180

您不能在同一查询的 GROUP BY 子句中使用您在此查询中创建的别名（至少在 Oracle 中）。您要么必须使用以下表达式：

```
...
GROUP BY
CAST(SUBSTR(TRIM(ABU_PTY_CD),4,2) AS CHAR(2)), 
..., 
CASE 
   WHEN GL_ACCT_LVL_NUM > ' ' THEN CAST(SUBSTR(GL_ACCT_LVL_NUM,1,10)  AS CHAR(11) ) 
   ELSE CAST(SUBSTR(FNCL_STMT_LN_NUM,1,11) AS CHAR(11) )
END, 
..., 
SOURCE_SYSTEM_ID 
```

或创建一个子查询，然后使用您的别名进行分组：

```
SELECT ABU_PTY_CD, ...
FROM (
SELECT
   CAST(SUBSTR(TRIM(ABU_PTY_CD),4,2) AS CHAR(2)) ABU_PTY_CD,
   ...
FROM   EDW_BI_SL_M1.BFV 
WHERE  CPC_PTY_CD = '00000000SX'
       AND TO_CHAR(RPTG_ACCTG_DT, 'YYYY')  >= TO_CHAR(ADD_MONTHS((CURRENT_DATE),-1),'YYYY')
       AND JE_VERS_NUM in ('200', '001') 
       AND SRC_LDGR_CD <> 'LG'
       AND ACCTG_PRD_MO_CD < 13
)
GROUP BY ABU_PTY_CD, ACCTG_PRD_YR_CD, ACCTG_PRD_MO_CD, OUDS_FAC_CD, ACCT_NUM, COMP_PTY_CD, JE_LWR_TIER_RPTG_NUM, 
LT2_NM, FA_PTY_CD, JE_LN_GLBL_CCY_CD, JE_LN_LC_CD, ACCT_LVL_NUM, JE_LN_GLBL_AMT, DDU_FAC_CD, JE_HDR_DESC, JE_HDR_NUM, JE_GRP_NUM, 
SOURCE_SYSTEM_ID; 
```

# php - 正确的 PHP 方法在 MySQL DB 中存储特殊字符

> ID：10113355
> 
> 赞同：7
> 
> 时间：2012-04-11T20:21:53.297
> 
> 标签：php, mysql, sql-injection, html-entities, html-encode

使用 PHP，在 MSQUL 数据库中存储特殊字符（如下所示）以避免注入的最佳方法是什么。

```
« " ' é à ù 
```

这就是我现在的做法：

```
$book_text=$_POST['book_text'];
$book_text=htmlentities($book_text, "ENT_QUOTES");
$query=//DB query to insert the text 
```

然后：

```
$query=//DB query to select the text
$fetch=//The fetch of $book_text
$book_text=html_entity_decode($book_text); 
```

这样，我所有的文本都被格式化为 HTML 实体。但是我认为这会占用大量的数据库空间。那么，有没有更好的方法呢？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-11T20:23:35.410

使用`utf8`编码来存储这些值。

为避免**注射**使用`mysql_real_escape_string()`（或准备好的语句）。

为了防止**XSS**使用`htmlspecialchars`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-11T20:45:09.683

听起来您的问题可以概括为使用 PHP 和 MySQL 处理和存储 UTF8。

为了避免 SQL 注入，您应该使用准备好的语句。[mysqli](http://php.net/manual/en/mysqli.quickstart.prepared-statements.php)和[PDO](http://php.net/manual/en/pdo.prepared-statements.php)驱动程序都支持它们。

准备好的语句由驱动程序自动引用，因此您无需担心这一点。

您的数据库表应使用字符集`utf8`和`utf8_general_ci`排序规则创建。这些 my.cnf 设置将确保您的 MySQL 服务器通过以下方式运行 UTF8：

```
[mysqld]
default-character-set=utf8
default-collation=utf8_general_ci
character-set-server=utf8
collation-server=utf8_general_ci
init-connect='SET NAMES utf8'

[client]
default-character-set=utf8 
```

请注意，PHP 通常不知道 UTF-8，因此您应该小心使用其中一个[`iconv`](http://www.php.net/iconv)或[`mbstring`](http://www.php.net/mbstring)库来处理字符串。请参阅[PHPWACT](http://www.phpwact.org/php/i18n/utf-8)以获得良好的概述。

确保 PHP 的内部字符集设置为 unicode

```
iconv_set_encoding('internal_encoding', 'UTF-8');
mb_internal_encoding('UTF-8'); 
```

`<meta>`您还应该通过发送正确的标头或为字符集添加标签来确保浏览器知道编码。

那应该这样做。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-12T05:23:11.630

你的问题是一个很好的混淆集合。你设法混淆了一切。
让我们试着整理一下。

> 使用 PHP，在 MSQUL 数据库中存储特殊字符（如下所示）以避免注入的最佳方法是什么。

这些都是无可比拟的事情。存储特殊字符是一回事，避免注入是另一回事。完全不同的一个。

```
$book_text=htmlentities($book_text, "ENT_QUOTES"); 
```

这是最有趣的部分。尽管它旨在保护您的查询，但它实际上什么也没做。因为您使用数值为 0 的字符串 ENT_QUOTES 而不是常量 ENT_QUOTES ，所以您没有设置任何标志。

但即使你正确设置了这个标志，它也不会自动保护你。因为注入代码可能不包含特殊字符。

为了避免注入，你必须遵循**一整套规则**，而不是一个简单的函数“make_my_data_safe()”。没有魔杖。
有关详细信息，请参阅[**我的答案**](https://stackoverflow.com/a/2995163/285587)。

至于特殊字符，很简单。唯一的问题是没有设置固体特殊字符。不同的环境有*不同*的特殊字符。

*   ' 对数据库和 HTML 有意义
*   <> 仅对 HTML 有意义
*   é àù 仅对 HTML 有意义，取决于编码。

你有你为每种情况使用不同的格式规则。不同的，不是一个适合所有人的。

要将 é à ù 字符与 HTML 一起使用，您必须设置正确的 HTTP 标头。要将 é àù 与数据库一起使用，您必须将表编码设置为 utf8 并将连接编码设置为 utf 8。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-11T20:37:39.827

是的 utf8 编码...

如果您非常担心注射，您也可以使用Prepared Statements...

[http://www.linearchat.co.uk/2011/08/why-prepared-statements-in-mysql-are-a-good-thing/](http://www.linearchat.co.uk/2011/08/why-prepared-statements-in-mysql-are-a-good-thing/)

还

[http://dev.mysql.com/doc/refman/5.0/en/sql-syntax-prepared-statements.html](http://dev.mysql.com/doc/refman/5.0/en/sql-syntax-prepared-statements.html)

# java - 与我的应用共享 Android Play 商店应用链接

> ID：10113356
> 
> 赞同：1
> 
> 时间：2012-04-11T20:21:54.663
> 
> 标签：java, android, hyperlink

我想知道如何将我的应用程序添加到当您在 Android Play 商店中查看应用程序时单击“共享”按钮时出现的应用程序列表。现在，该菜单中存在许多应用程序（从邮件到 SMS、Facebook 等等），并选择其中一个“粘贴”消息：“签出 -”。

我想抓住这个链接并在我的应用程序中使用它。

我知道我应该使用一个接收器，它以某种方式从 Play Store 应用程序和某种过滤器中捕获链接，但从 developer.android.com 上的解释来看，我真的不明白该怎么做。

请帮忙！谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-11T20:29:11.987

像这样编辑您的 AndroidManifest.xml（为您的活动创建一个 Intent 过滤器以接收共享文本）：

```
<activity android:name="com.yourpackage.YourActivity">
    <intent-filter>
        <action android:name="android.intent.action.SEND" />
        <category android:name="android.intent.category.DEFAULT" />
        <data android:mimeType="text/plain"/>
    </intent-filter>
</activity> 
```

在 YourActivity 中，您需要做的就是获得所需的链接：

```
String marketlink = getIntent().getStringExtra(Intent.EXTRA_TEXT); 
```

# android - 如何将触摸坐标与不同屏幕上的游戏板连接起来

> ID：10113357
> 
> 赞同：0
> 
> 时间：2012-04-11T20:21:58.383
> 
> 标签：android, coordinates

我正在将我的游戏从 WP7 移植到 Android。我的游戏是一种“彩色线条”游戏。有一个带有单元格的板（它是静态背景图像的一部分），可以放置球。在 WP7 上，坐标一切正常：所有 WP7 设备的分辨率均为 800*480，我可以轻松定义用户点击了哪个单元格。

但是android有一些问题：在不同的屏幕上我面临不同的分辨率。我的游戏板有一些图形边框，我不知道它们在每个安卓屏幕上的大小。

我不知道如何将 getTouch 事件的坐标连接到板上被触摸的单元格（如上所述，它是分辨率为 800*480 的静态背景图像的一部分）。

另外，我不知道如何找到要放置球的某个单元格的中心坐标。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T11:06:29.013

将事件中的坐标缩放到您的图像。

```
 DisplayMetrics metrics = new DisplayMetrics();
   getWindowManager().getDefaultDisplay().getMetrics( metrics );
   float x = 800 / metrics.widthPixel * event.getX();
   float y = 480 / metrics.heightPixel * event.getY(); 
```

# python - 为什么“对象”类没有用户设置属性

> ID：10113358
> 
> 赞同：7
> 
> 时间：2012-04-11T20:22:08.740
> 
> 标签：python

python 中的每个类都继承自类“对象”。我想知道“对象”类实现的内部机制。为什么不能为“对象”类分配任何用户属性？我确信它与内存管理有关，但是如果用户想自己实现内存管理怎么办，为什么他不能覆盖 python 中的“对象”类？这是基于我的兴趣并想知道哪些可能没有任何程序化应用程序，但很高兴了解语言本身的内部特征。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-11T20:44:58.183

C 中定义的类型永远不能有用户分配的属性。如果要`object`全局替换，则需要遍历存在的每个类，然后替换`__builtin__.object`以捕获所有未来的类创建。即使这样也不可靠，因为旧对象可能绑定在其他地方。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-11T21:45:32.993

这已在 StackOverflow 上进行了讨论，但我无法找到将其链接的讨论。

我想知道的原因是因为我想简化这个例子：

```
class Box(object):
    pass

box = Box()
box.a = "some value"
box.b = 42 
```

在这里，我将`box`其用作一种字典，其中键只能是标识符。我这样做是因为写起来`box.a`比`box["a"]`.

我想这样做：

```
box = object()
box.a = "some value"  # doesn't work 
```

原因是它`object`是 Python 中所有对象的根。具有的任何属性`object`都必须是任何派生类型。如果要创建包含大量对象的大型列表，则希望它们尽可能小，以免内存不足。所以`object`本身是最小的。

编辑：我找到了我想记住的链接：

[python中的结构对象](https://stackoverflow.com/questions/1878710/struct-objects-in-python)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-11T22:06:35.663

[`__slots__`](http://docs.python.org/reference/datamodel.html#slots)如果我必须从第一原理中推导出推理，我可能会从机制的角度来考虑它。某些类只需要很少的属性，并且属性集对于每个实例总是固定的，因此类似用户属性的“dict”能力的灵活性会浪费cpu（查找动态命名的属性）和空间（空字典的开销，很小但非零），如果有大量实例，这确实会增加很多开销。

当然，这正是`__slots__`机制要解决的问题。在对象上为槽中定义的属性分配空间。如果有`__dict__`属性，则可以在其中找到非插槽属性，如果没有`__dict__`属性，则既不会获得动态属性，也不会获得不需要的 dict 对象（它是实例本身之外的附加堆对象）的成本。

至于为什么`object`它本身没有插槽`__dict__`，好吧，即使子类表明他们*不需要*`__dict__`插槽，如果他们继承自一个有 的类，*那么*实例仍然必须有一个`__dict__`; 如果`object`有一个`__dict__`那么绝对每个班级也会付出拥有一个的代价`__dict__`，即使他们不需要它。

反而; 除非子类自己定义了类属性，否则子类会获取`__dict__`（并且，出于类似的原因）。`__weakref__``__slots__`

为什么你需要一个普通的实例`object`？你只需要一袋属性吗？那么使用`dict`. 如果您确实需要某种具有行为和属性的对象，那么无论如何您都在创建子类。

我能想象使用`object()`, 而不是 , 的子类的唯一原因`object`是，当实例的唯一感兴趣的特征是它的身份时。当函数接受参数时会出现这种情况，并且`None`应该将其或其他一些明显的哨兵值理解为与默认值不同：

```
BAR_DEFAULT = object()
def foo(bar=BAR_DEFAULT):
    if bar is BAR_DEFAULT:
        #... 
```

在这种情况下，您既不需要也不需要实例上的属性`object`，

# html - 另一个 div 中的 div（css 定位）

> ID：10113359
> 
> 赞同：3
> 
> 时间：2012-04-11T20:22:21.020
> 
> 标签：html, css, position, css-position

这应该是一个非常简单的。我需要“橙色”div 始终覆盖 100% 的宽度和 100% 的高度。

在那个 div 中，我需要“绿色”div 来填充其父级“橙色”div 的 100% 宽度和高度。

此外，“橙色”div 内必须始终有 10 像素的“填充”。

**调整窗口大小时，每个 div 必须分别“调整大小”，以便没有滚动条。**

[http://jsfiddle.net/URwpA/3/](http://jsfiddle.net/URwpA/3/)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-11T20:34:31.600

第一种方式：

```
#hold {
 position:absolute;
 top:0px;
 left:0px;
 bottom:0px;
 right:0px;
 background:orange;
 padding:10px;
}
#held {
 position:relative;
 width:100%;
 height:100%;
 background:green;
} 
```

第二种方式：

```
#hold {
 position:absolute;
 top:0px;
 left:0px;
 bottom:0px;
 right:0px;
 background:orange;
}
#held {
 position:absolute;
 top:10px;
 left:10px;
 bottom:10px;
 right:10px;
 background:green;
} 
```

编辑：我能想到的实现我认为在评论中要求的布局的唯一方法如下：

```
<html style="height: 100%;">
  <body style="height: 100%;">
    <table style="height: 100%; width: 100%; border: 10px solid orange; background-color: green;">
      <!-- etc... -->
    </table>
  </body>
</html> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T20:31:31.053

我相信你正在寻找这样的东西？

```
#hold {
position:fixed;
background:orange;
width:100%;
height:100%;
padding:10px;
}
#held {
position:relative;
width:100%;
height:100%;
background:green;
} 
```

# c# - 延迟加载导航属性

> ID：10113362
> 
> 赞同：1
> 
> 时间：2012-04-11T20:22:37.350
> 
> 标签：c#, entity-framework, wcf-ria-services

似乎我无法在我的域服务中的 include 上放置 where 子句 - 所以我们正在做一些循环来获取一些查找组所需的数据。

```
 var _lookupGroups = _lookupGroupRepository.All();
        var _lookupValues = _institutionLookupValueRepository.All().Where(x => x.InstitutionID == _userProfile.InstitutionID);

        int i = 0;

        foreach (var _group in _lookupGroups)
        {
            var _values = _lookupValues.Where(x => x.LookupGroupID == _group.LookupGroupID);

            foreach (var _value in _values)
            {
                _group.InstitutionLookupValues.Add(_value);

                i++;
            }

            Console.WriteLine(_group.GroupName + " " + i.ToString());
        }

        return _lookupGroups; 
```

我输入的计数器是为了验证我所看到的——我们迭代的第一组是状态。我的计数器会说 50，但我的导航属性会说 100，显示我们拥有的每个机构的一组 50（我们有 2 组）。所以它正在获取所有查找值并将它们放入导航属性中，即使我的计数器显示为 50。我还删除了元数据文件中的所有包含。

澄清一下：我有附加到lookupGroups的lookupvalues。查找值分配给机构。因此，如果我去获取 STATES 查找组的值，我将获得 50 个查找值。上面的代码。当我运行此行时 _group.InstitutionLookupValues.Add(_value); 我的机构LookupValues = 100（无论机构如何，都采用所有lookupValues）。但我的计数器显示 50。在某个地方，我得到了所有查找值，不确定与特定机构相关联的值。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-11T22:11:11.127

我认为这是由于您正在访问修改后的闭包这一事实造成的，即使不是，您也不应该这样做。线

```
var _values = _lookupValues.Where(x => x.LookupGroupID == _group.LookupGroupID); 
```

可能没有做你认为它正在做的事情（除非它是 C#5）。lambda 是一个委托，闭包将关闭变量，而不是值。这意味着您的代码`_group.LookupGroupID`将始终是枚举器最终迭代的最后一个值，因此您只会过滤 one 上的查找值`_group.LookupGroupID`。

尝试将块更改为：

```
foreach (var _group in _lookupGroups)
{
  var currentGroup = _group;    
  var _values = _lookupValues.Where(x => x.LookupGroupID == currentGroup.LookupGroupID);

  foreach (var _value in _values)
  {
     currentGroup.InstitutionLookupValues.Add(_value);

     i++;
  }

  Console.WriteLine(currentGroup.GroupName + " " + i.ToString());
} 
```

我不确定这是否是问题的原因，但无论如何你都会得到其他奇怪的效果。通过在循环中创建自己的变量，可以避免关闭生成的枚举变量。

看看 Eric Lippert 的文章：[关闭被认为有害的循环变量](http://blogs.msdn.com/b/ericlippert/archive/2009/11/12/closing-over-the-loop-variable-considered-harmful.aspx)。令人惊讶的是，很少有人知道这个问题。

此外，折叠查询可能是个好主意：

```
var _lookupValues = _institutionLookupValueRepository.All().Where(x => x.InstitutionID == _userProfile.InstitutionID); 
```

通过使用`ToList()`，或类似的。否则，您将为 中的每个循环重新评估此查询，`_lookupGroups`如果查询是针对数据库的，或者循环很大，这可能会对性能造成严重影响。

# git - 如何更改大量 github 存储库的默认分支？

> ID：10113363
> 
> 赞同：2
> 
> 时间：2012-04-11T20:22:42.527
> 
> 标签：git, github

我有大量存储库，我想将默认分支从一个分支更改为另一个分支。是的，我可以使用 Web UI 来完成，但如果我可以在脚本中完成，那就太好了。可能的？

更新：

根据github支持，没有办法做到这一点。我已经要求他们添加将默认分支更改为 API 的功能。那显然是最好的办法。

# javascript - 用 Javascript 加载 jQuery 并使用 jQuery

> ID：10113366
> 
> 赞同：90
> 
> 时间：2012-04-11T20:22:49.117
> 
> 标签：javascript, jquery

我使用以下方法将 jQuery 库附加到 dom：

```
 var script = document.createElement('script');
 script.src = 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js';
 script.type = 'text/javascript';
 document.getElementsByTagName('head')[0].appendChild(script); 
```

但是，当我运行时：

```
jQuery(document).ready(function(){... 
```

控制台报错：

```
Uncaught ReferenceError: jQuery is not defined 
```

如何动态加载 jQuery 并在 dom 中使用它？

* * *

## 回答 #1

> 赞同：147
> 
> 时间：2012-04-11T20:28:13.553

这里有一个工作 JSFiddle 和一个小例子，它准确地展示了你在寻找什么*（除非我误解了你的请求）*：http: [//jsfiddle.net/9N7Z2/188/](http://jsfiddle.net/9N7Z2/188/)

这种动态加载javascript的方法存在一些问题。当涉及到非常基础的框架时，例如 jQuery，您实际上可能希望静态加载它们，因为否则，您将不得不编写一个完整的 JavaScript 加载框架......

你可以使用一些现有的 JavaScript 加载器，或者通过观察来编写你自己的加载器`window.jQuery`。

```
// Immediately-invoked function expression
(function() {
  // Load the script
  const script = document.createElement("script");
  script.src = 'https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js';
  script.type = 'text/javascript';
  script.addEventListener('load', () => {
    console.log(`jQuery ${$.fn.jquery} has been loaded successfully!`);
    // use jQuery below
  });
  document.head.appendChild(script);
})();
```

请记住，如果您需要支持***非常***旧的浏览器，例如 IE8，`load`则不会执行事件处理程序。在这种情况下，您需要轮询是否存在`window.jQuery`使用 repeat `window.setTimeout`。这里有一个使用该方法的有效 JSFiddle：http: [//jsfiddle.net/9N7Z2/3/](http://jsfiddle.net/9N7Z2/3/)

有很多人已经完成了你需要做的事情。查看一些现有的 JavaScript 加载器框架，例如：

*   ~~https://developers.google.com/loader/~~（不再记录）
*   ~~http://yepnopejs.com/~~（已弃用）
*   [http://requirejs.org/](http://requirejs.org/)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2014-02-05T15:41:51.290

还有另一种动态加载 jQuery 的方法（[source](http://css-tricks.com/snippets/jquery/load-jquery-only-if-not-present/)）。你也可以使用

```
document.write('<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"><\/script>'); 
```

使用 被认为是不好的做法`document.write`，但为了完整起见，最好提及它。

请参阅[为什么 document.write 被认为是“不好的做法”？](https://stackoverflow.com/questions/802854/why-is-document-write-considered-a-bad-practice)原因。优点是**确实**`document.write`会阻止您的页面加载其他资产，因此无需创建回调函数。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-04-11T20:29:04.483

***[Encosia 的网站建议：](http://encosia.com/3-reasons-why-you-should-let-google-host-jquery-for-you/)***

```
<script type="text/javascript" 
        src="http://www.google.com/jsapi"></script>
<script type="text/javascript">
  // You may specify partial version numbers, such as "1" or "1.3",
  //  with the same result. Doing so will automatically load the 
  //  latest version matching that partial revision pattern 
  //  (e.g. 1.3 would load 1.3.2 today and 1 would load 1.7.2).
  google.load("jquery", "1.7.2");

  google.setOnLoadCallback(function() {
    // Place init code here instead of $(document).ready()
  });
</script> 
```

但即使是他也承认，就最佳性能而言，这与执行以下操作相比是无法比拟的：

```
 <script src="//ajax.aspnetcdn.com/ajax/jQuery/jquery-1.7.2.min.js" type="text/javascript"></script>
    <script type="text/javascript"> window.jQuery || document.write('<script src="js/libs/jquery-1.7.2.min.js">\x3C/script>')</script>
    <script type="text/javascript" src="scripts.js"></scripts>
</body>
</html> 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2017-02-02T22:11:25.020

您需要在 jQuery 完成加载后运行您的代码

```
var script = document.createElement('script'); 
document.head.appendChild(script);    
script.type = 'text/javascript';
script.src = "//ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js";
script.onload = function(){
    // your jQuery code here
} 
```

* * *

或者如果你在异步函数中运行它，你可以`await`在上面的代码中使用

```
var script = document.createElement('script'); 
document.head.appendChild(script);    
script.type = 'text/javascript';
script.src = "//ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js";
await script.onload
// your jQuery code here 
```

如果你想先检查页面中是否已经存在 jQuery，试试[这个](https://stackoverflow.com/a/42013103/3577695)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-11T20:28:03.890

HTML：

```
<html>
  <head>

  </head>
  <body>

    <div id='status'>jQuery is not loaded yet.</div>
    <input type='button' value='Click here to load it.' onclick='load()' />

  </body>
</html> 
```

脚本：

```
 <script>

        load = function() {
          load.getScript("jquery-1.7.2.js");
          load.tryReady(0); // We will write this function later. It's responsible for waiting until jQuery loads before using it.
        }

        // dynamically load any javascript file.
        load.getScript = function(filename) {
          var script = document.createElement('script')
          script.setAttribute("type","text/javascript")
          script.setAttribute("src", filename)
          if (typeof script!="undefined")
          document.getElementsByTagName("head")[0].appendChild(script)
        }

        </script> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-11T20:50:19.447

您收到此错误的原因是 JavaScript 没有等待加载脚本，所以当您运行

```
jQuery(document).ready(function(){... 
```

不能保证脚本已经准备好（永远不会）。

这不是最优雅的解决方案，但它是可行的。本质上，您可以每 1 秒检查一次 jQuery 对象广告在加载您的代码时运行一个函数。我还会添加一个超时（比如运行 20 次后的 clearTimeout）以阻止检查无限期地发生。

```
var jQueryIsReady = function(){
    //Your JQuery code here
}

var checkJquery = function(){
    if(typeof jQuery === "undefined"){
        return false;
    }else{
        clearTimeout(interval);
        jQueryIsReady();
    }
}
var interval = setInterval(checkJquery,1000); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-04-11T22:11:41.770

使用[require.js](http://requirejs.org/)你可以以更安全的方式做同样的事情。您可以只定义对 jquery 的依赖关系，然后在加载依赖项时执行您想要的代码，而不会污染命名空间：

我通常推荐这个库来管理对 Javascript 的所有依赖项。它很简单，可以有效优化资源加载。但是，在将它与 JQuery 一起使用时，您可能需要采取一些[预防措施。](http://requirejs.org/docs/jquery.html)我最喜欢的处理它们的方法在这个[github 存储库](https://github.com/jrburke/require-jquery)中进行了解释，并通过以下代码示例反映出来：

```
<title>jQuery+RequireJS Sample Page</title>
   <script src="scripts/require.js"></script>
   <script>
   require({
       baseUrl: 'scripts',
       paths: {
           jquery: 'https://ajax.googleapis.com/ajax/libs/jquery/1.6.0/jquery.min'
       },
       priority: ['jquery']
    }, ['main']);
    </script> 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-01-17T11:04:25.550

在*DevTools*控制台中，您可以运行：

```
document.getElementsByTagName("head")[0].innerHTML += '<script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"><\/script>'; 
```

[在https://code.jquery.com/jquery/](https://code.jquery.com/jquery/)检查可用的 jQuery 版本。

要检查它是否已加载，请参阅：[Checking if jquery is loaded using Javascript](https://stackoverflow.com/q/7341865/55075)。

# silverlight - IE9 渲染从左到右的标记

> ID：10113367
> 
> 赞同：3
> 
> 时间：2012-04-11T20:22:57.287
> 
> 标签：silverlight, right-to-left

在我的 Silverlight 应用程序中，我使用以下格式字符串以从右到左的语言格式化日期：

```
"dd-MMM-yyyy HH:mm" 
```

月份名称由从右到左的字符组成，这些字符重新排列格式化字符串并在日期中间插入时间。为了解决这个问题，我尝试插入 unicode U+200E 和 U+200F 字符。这在一定程度上有效，但 IE9 正在渲染控制字符！它看起来几乎像一个小“向上箭头”。有没有人遇到过这种情况或知道解决方法？

抱歉，我无法访问此屏幕截图。任何帮助是极大的赞赏！伊恩

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T16:36:59.830

无论您使用什么来显示日期（例如 TextBlock），如果您知道字符串中会有 RTL 字符，则需要设置 FlowDirection = RightToLeft。

# c# - 在 c# 中评估 vb.net rdlc 报告表达式

> ID：10113370
> 
> 赞同：0
> 
> 时间：2012-04-11T20:23:03.757
> 
> 标签：c#, .net, report, rdlc

我需要采用 RDLC 报告文本框中的表达式（例如：`iif(x=1, 'Yes', 'No')`并在 C# 程序中执行它（即在运行时评估它）。

由于 RDLC 报告已经这样做了，有没有人知道负责这样做的类和方法名称？任何其他建议都有帮助，但目标是评估 RDLC 字符串表达式。

# php - PHP：字符串作为代码/数组？

> ID：10113372
> 
> 赞同：0
> 
> 时间：2012-04-11T20:23:11.497
> 
> 标签：php, arrays, string, php-5.3

如何使字符串充当代码？

例如，我希望将此字符串解析为数组，

```
$config = '
    "allowable_tags" => "<p>",
    "span_regex" => null, 
    "allow_nbsp" => true, 
    "allow_class" => false
'; 
```

所以，

```
function tidy($config = null){

    $default = array(
        "allowable_tags" => null,
        "span_regex" => null, 
        "allow_nbsp" => true, 
        "allow_class" => false
    );

    $config = array($config);

    # Loop the array.
    foreach($default as $key => $value)
    {
        # Set the variable.
        $$key = set_variable($config,$key)? set_variable($config,$key):$value;
    }

    return $allowable_tags;
}

var_dump(tidy($config)); 
```

然后我会得到这个结果，

```
<p> 
```

可行吗？

依赖函数，

```
function set_variable($array = array(),$key,$params = array())
{
    # If $params is not an array, let's make it array with one value of former $params.
    if(!is_array($params)) $params = array($params);
    if(!is_array($array)) parse_str($array, $array);

    # When you want a variable to return a boolean, this will return true or false.
    if(in_array('boolean', $params)) return isset($array[$key]) && $array[$key] === true ? true : false;

    # This will regard '0' as a string.
    # Return value or 0 as a string.
    elseif(in_array('zero_to_string', $params)) return isset($array[$key]) && ($array[$key] == '0') ? trim($array[$key]) : null;

    # Return null as string if 'null_to_string' is set.
    elseif(in_array('null_to_string', $params)) return isset($array[$key]) && !empty($array[$key]) ? trim($array[$key]) : 'null';

    # Check if the key is an array.
    elseif(isset($array[$key]) && !empty($array[$key]) && is_array($array[$key])) return isset($array[$key]) && !empty($array[$key]) ? $array[$key] : null;

    # This will regard '0', empty space as falsey.
    # Return value or null.
    else return isset($array[$key]) && !empty($array[$key]) ? trim($array[$key]) : null;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T20:30:03.907

与其制作自定义函数来将配置变量的字符串表示解析为数组，为什么不直接使用 JSON 等现有格式呢？然后你可以简单地调用[json_decode()](http://www.php.net/json_decode)并取回一个数组。此外，如果这是针对用户提交/输入的配置值，则[JSON](http://www.json.org)广为人知，易于学习且有些安全，因为不执行任何代码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-11T20:30:30.593

首先，您如何获得该字符串？

我猜你正在将配置存储在数据库或其他东西中。在这种情况下，您应该使用 PHP 内置方法的序列化。

```
<?php

// normal PHP array
$config = array(
    "allowable_tags" => "<p>",
    "span_regex" => null, 
    "allow_nbsp" => true, 
    "allow_class" => false
);

// array serialized as string
$string = serialize($config);

echo $string ."\n\n";
# => a:4:{s:14:"allowable_tags";s:3:"<p>";s:10:"span_regex";N;s:10:"allow_nbsp";b:1;s:11:"allow_class";b:0;}

// converting serialized string back to array
$array = unserialize($string);

print_r($array);
/*
    Array
    (
        [allowable_tags] => <p>
        [span_regex] => 
        [allow_nbsp] => 1
        [allow_class] => 
    )
*/ 
```

[看到它在ideone上工作](http://ideone.com/PBGnq)

* * *

### 编辑

正如乔纳森库恩所建议的那样，`json_encode()`也`json_decode()`非常适合处理这个问题。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-04-11T20:32:26.817

我不认为这是理想的，但它是一些基础：

```
function str2array($str)
{
    $array = explode(',', $str);
    $rArray = array();
    foreach ($array as $items) {
        $i = explode('=>', $items);
        if (preg_match('/^"*(.*?)"$/', trim($i[1]), $iWithoutQuotes)) {
            $i[1] = $iWithoutQuotes[1];
        }
        $rArray[substr(trim($i[0]), 1, -1)] = trim($i[1]);
    }

    return $rArray;
} 
```

# c++ - 在作为朋友的类中包含头文件

> ID：10113374
> 
> 赞同：6
> 
> 时间：2012-04-11T20:23:19.910
> 
> 标签：c++, class, friend

我想知道您是否必须在将其用作朋友的班级中#include“Class1.h”。例如，授予 Class1 类权限的类的 .h 文件。

```
class Class2 {
   friend class Class1;
} 
```

你需要#include“Class1.h”还是没有必要？同样在 Class2 类中，从未创建或使用 Class1 对象。Class1 只是操纵 Class2 而不是相反。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-11T20:25:09.147

语法是：

```
friend class Class1; 
```

不，你不包括标题。

更一般地说，您不需要包含标头，除非您实际上以某种方式使用类定义（例如，您使用类的实例并且编译器需要知道其中的内容）。如果您只是通过名称引用类，例如您只有一个指向该类实例的指针并且您正在传递它，那么编译器不需要查看类定义 - 告诉它就足够了通过声明该类：

```
class Class1; 
```

这很重要，有两个原因：次要的原因是它允许您定义相互引用的类型（但您不应该！）；主要的一点是它允许您减少代码库中的物理耦合，这有助于减少编译时间。

* * *

要回答 Gary 的评论，请注意编译和链接很好：

```
class X;

class Y
{
    X *x;
};

int main()
{
    Y y;
    return 0;
} 
```

除非您实际使用 X 中的某些东西，否则无需提供 X 的定义。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-03-31T23:49:13.320

不，您不必*“* #include "Class1.h" 在将其用作朋友的班级中。” 您甚至不必转发声明两者的存在`class Class1`。您只需在 Class2 的定义中声明 Class1 为友元即可！（我认为该`friend class Class1`声明本身就是一种“前向声明” `Class1`）：

```
// Inside the definition of Class2, place this (usually
// at the very bottom inside the `private:` section)
friend class Class1; 
```

这是一个完整的工作示例。您可以[在此处运行和测试它](https://onlinegdb.com/ryPrfU-wL)（请注意，运行此示例时有 2 个选项卡——每个文件一个）。

**类2.h**：

```
#pragma once 

class Class2
{
private:
    int _myInt = 123;

    // Declare Class1 as a friend class to Class2 so that Class1 can access all of Class2's private
    // and protected members (as though Class2's members were part of Class1)
    friend class Class1;
}; 
```

**主.cpp**：

```
#include "Class2.h"

#include <stdio.h>

class Class1
{
public:
    int getClass2Int()
    {
        return _class2._myInt;
    }

    void setClass2Int(int val)
    {
        _class2._myInt = val;
    }

private:
    Class2 _class2;
};

int main()
{
    printf("Hello World\n");

    Class1 class1;

    printf("class1.getClass2Int() = %i\n", class1.getClass2Int());
    class1.setClass2Int(700);
    printf("class1.getClass2Int() = %i\n", class1.getClass2Int());

    return 0;
} 
```

输出：

> 你好世界
> class1.getClass2Int() = 123
> class1.getClass2Int() = 700

# 参考：

1.  [https://www.geeksforgeeks.org/friend-class-function-cpp/](https://www.geeksforgeeks.org/friend-class-function-cpp/)
2.  谷歌搜索[“你需要包含头文件来声明朋友类吗？”](https://www.google.com/search?q=do+you+need+to+include+header+file+to+declare+friend+class%3F&oq=do+you+need+to+include+header+file+to+declare+friend+class%3F&aqs=chrome..69i57j69i64.7306j0j7&sourceid=chrome&ie=UTF-8)
3.  [在作为朋友的类中包含头文件](https://stackoverflow.com/questions/10113374/including-header-file-in-class-that-is-a-friend/10113399#10113399)

# java - 在不创建“随机”对象的情况下获取随机值

> ID：10113380
> 
> 赞同：5
> 
> 时间：2012-04-11T20:24:03.117
> 
> 标签：java

我正在编写一个带有十进制字段的类构造函数，它需要由一个随机值初始化。只有一个小领域，我需要创建新`Random`对象。首先它看起来很麻烦，其次可能会出现很多相等的值，以防在一个时间片中创建很多对象（`new Random()`等于`new Random(System.currentTimeMillis())`，并且相等的 timeMillis 需要相等的随机值）。

避免这种情况的最佳方法是什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-11T20:34:48.337

> new Random() 等同于 new Random(System.currentTimeMillis())

不，这不对。在最近的 JDK 中，它是`new Random(seedUniquifier() ^ System.nanoTime());` seedUniquifier() 基于在 static 上运行线性同余生成器的地方`AtomicLong`。因此，`Random`根据需要创建对象实际上是完全安全的。

当然，您始终可以拥有一个`private static Random`字段并在构造函数中使用它。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-11T20:25:29.287

您正在寻找[Math.random](http://docs.oracle.com/javase/6/docs/api/java/lang/Math.html#random%28%29)。这是一个静态方法，`Random`它在第一次调用时隐式初始化一个新对象，然后再使用该对象。因此，您可以获得在所有静态字段初始化之间共享单个`Random`对象的好处，而无需`Random`自己管理对象。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-11T20:43:53.910

您使用的是 Java 7，`Random`它是线程安全的，如文档所述：

> java.util.Random 的实例是线程安全的。但是，跨线程并发使用同一个 java.util.Random 实例可能会遇到争用，从而导致性能下降。考虑改为在多线程设计中使用 ThreadLocalRandom。

所以你*可以*使用：

```
private static final Random random = new Random(); 
```

...或者[`ThreadLocalRandom`](http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/ThreadLocalRandom.html)如果您要从多个线程中使用它，请使用。当然，它仍然不会那么随机[`SecureRandom`](http://docs.oracle.com/javase/7/docs/api/java/security/SecureRandom.html)。基本上根据你的需要调整你的选择。

# c# - 分离一个匿名的 EventHandler

> ID：10113382
> 
> 赞同：1
> 
> 时间：2012-04-11T20:24:16.610
> 
> 标签：c#, memory-leaks, event-handling

> **可能重复：**
> [取消订阅 C# 中的匿名方法](https://stackoverflow.com/questions/183367/unsubscribe-anonymous-method-in-c-sharp) [如何取消注册“匿名”事件处理程序](https://stackoverflow.com/questions/1348150/how-do-i-unregister-anonymous-event-handler)

好的，假设我有以下代码：

```
 private void AttachEvent(AwesomeObject someObject)
    {
        int id = GetCurrentIdValue();
        someUnknownClass.SomeEvent += () => someObject.CreateAwesomeness(id);
    } 
```

（本质上，我只是想说明在[此线程](https://stackoverflow.com/questions/1488099/call-an-eventhandler-with-arguments)中建议的事件处理程序中使用局部变量的必要性）。从内存管理的角度来看，我不能仅仅从 someUnknownClass.SomeEvent 中分离，因为我没有处理程序的句柄。此外，假设 someUnknownClass 是第三方类型，因此我无法在该类中添加任何代码以按照建议在内部分离事件。

我的问题是，如何在仍然能够使用匿名方法作为事件处理程序的同时避免内存泄漏？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T20:29:16.340

这是不可能的，而不是你使用它们的方式。您可以做的是将该方法分配给一个变量，然后*将该*变量用于`+-`事件。但是这样一来，你就会失去闭包通常给你的“自然”感觉。

# python - 处理 Python 模块中的循环依赖关系？

> ID：10113383
> 
> 赞同：7
> 
> 时间：2012-04-11T20:24:16.510
> 
> 标签：python, import, include

这又是一个我在兜圈子里跑来跑去的情况，我快要发疯了。

我希望 Python 首先分析所有文件，以便它从一开始就知道所有标识符（我认为就像 Java 一样）。

我有一个“main.py”和一个“gui.py”。每个文件都包含一个类，该类使用另一个文件中的类。当我尝试运行“main.py”时，解释器导入“gui”，然后在“gui.py”中导入“main”，然后它处理整个主模块并说：“Tee-hee，没有类在 gui.py 中使用给定的名称。”

如何*以最小的麻烦*处理 Python 中的循环依赖关系？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-04-11T20:36:27.987

我想我会将其扩展为答案而不是评论。

值得注意的是，[循环导入通常是糟糕设计的标志](https://stackoverflow.com/questions/1356304/are-circular-class-dependencies-bad-from-a-coding-style-point-of-view)：与其要求语言适合你的设计，为什么不改变那个设计呢？

[在 python 中](http://effbot.org/zone/import-confusion.htm#circular-imports)有解决这个问题的方法：

*   不错的选择：重构代码以不使用循环导入。
*   糟糕的选择：将您的一个`import`语句移动到不同的范围。

但是不，您不能预解析文件。这不是 Python 的工作方式，如果你研究 Python 是如何工作的，原因就很明显了。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-11T21:07:42.747

如果您无法避免循环导入，请将其中一个导入移出模块级范围，并移到使用它的方法/函数中。

文件.py

```
import fileb

def filea_thing():
    return "Hello"

def other_thing():
    return fileb_thing()[:10] 
```

文件b.py

```
def fileb_thing():
    import filea
    return filea.filea_thing() + " everyone." 
```

这样，filea 只会在您调用 fileb_thing() 时被导入，然后它会重新导入 fileb，但由于此时不会调用 fileb_thing，因此您不会一直循环。

正如其他人所指出的，这是一种代码异味，但有时您需要完成某些事情，即使它很丑陋。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-11T20:40:38.833

一般来说，依赖关系应该是一棵树。循环依赖是不可解决的。

但是，解决这个问题的常用方法是在全局命名空间以外的级别对所需模块进行“本地导入”。

# c - 非常量指针上的“赋值丢弃'const'限定符”错误

> ID：10113386
> 
> 赞同：5
> 
> 时间：2012-04-11T20:24:30.597
> 
> 标签：c, pointers, constants

在以下函数中：

```
char *mystrtok(const char *input, const char *delim,char *rest) {
    int i;
    for (i = 0; input[i] != *delim && input[i] != '\0'; ++i) {
        continue;
    }
    char *result = malloc(sizeof(char) * (i + 2));
    memcpy(result, input, i + 1);
    result[i + 1] = '\0';
    if (input[i + 1] != '\0') 
        rest = input + i + 2;
    else
        rest = NULL;
    return result;
} 
```

我得到`assignment discards 'const' qualifier from pointer target type`了 line `rest = input + i + 2`，但是，正如你所看到的，rest 不是一个常量指针。我在这里做错了什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-11T20:26:56.563

`input`是一个指向常量字符的指针，并且您将它分配给一个指向**非常量**字符的指针。[这](http://www.codeguru.com/cpp/cpp/cpp_mfc/general/article.php/c6967/Constant-Pointers-and-Pointers-to-Constants.htm)对你来说可能是一个有趣的阅读。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-11-22T11:17:22.313

您还可以使用 (char*) 类型转换您的“输入”变量，这将解决警告。只是要小心使用像这样的显式转换，以免修改常量本身。

```
rest = (char*)input + i + 2; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-11T20:29:19.503

将原型更改为

```
char *mystrtok(const char *input, const char *delim, const char *rest); 
```

# java - Java并发规范？：所有线程都可以看到同步块内的字段更新吗？

> ID：10113388
> 
> 赞同：3
> 
> 时间：2012-04-11T20:24:38.303
> 
> 标签：java, concurrency, synchronization

假设您有以下代码：

```
private Object lockObject = new Object();
private Integer myValue = new Integer(0);

public void update(){
 synchronized(lockObject){
  System.out.println(myValue);
  myValue++;
 }
} 
```

现在，`myValue`既没有`synchronized`开启也没有标记`volatile`。但是，改变它的唯一方法是使用`update()`方法。[DZone](http://refcardz.dzone.com/refcardz/core-java-concurrency)在核心 java 并发上的 refcard 说，所有线程都可以看到对同步块中的字段的更新。我不确定这是否意味着仅同步对象（lockObject）或任何字段（如 myValue）。

谁能详细说明这一点？谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-11T20:26:53.593

同步块中的所有字段更新都保证对其他线程可见，只要它们在读取之前*也在*同一个对象上同步。只要您同步*所有*对共享可变状态的访问，您应该会看到所有更新。

或者，如果你真的只有一个柜台，使用`AtomicInteger`:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T20:38:20.247

考虑：

1.  在同步块内执行的 Thread1`System.out.println(myValue);`输出 的当前值`myValue`。

2.  在Thread1递增`System.out.println(myValue);` *之前*`myValue`执行的 Thread2将获得与`myValue`步骤 1 中相同的值。

3.  Thread1`myValue`在同步块内递增。

4.  Thread2 执行`System.out.println(myValue);` *可能会*得到 Thread1 设置的新值`myValue`。

# javascript - 如何从 AWS 上托管的外部 Javascript 配置动态解析当前页面路径？

> ID：10113389
> 
> 赞同：0
> 
> 时间：2012-04-11T20:24:38.333
> 
> 标签：javascript, smarty, flowplayer

我已经花了几天时间将我的服务器全部设置为一个管站点。在经历了很多挫折之后，一切都运行良好，除了脚本的专有视频播放器。

处理伪流基本上是非常糟糕的，这对于带宽原因很重要，所以我决定使用 Flowplayer。

我已经确认 Flowplayer 可以工作，除了脚本太乱，我什至无法弄清楚为什么默认设置不起作用（Javascript 调用）

* * *

所以，我求助于使用对象标签。现在它在大多数情况下都可以使用，除了我在一个特定的视频中进行硬编码以进行测试。

我需要的是根据当前视频页面，从 URL 动态确定视频 ID，并在外部 .js 配置中动态设置它。我难住了。为了让事情变得更加混乱（至少对我而言），模板引擎是 Smarty，而 {literal} 标签并没有对我有利，所以我必须将 Flowplayer 配置放在外部 .js 文件中AWS。

这是目标代码： http: [//pastebin.com/P7TrWFGm](http://pastebin.com/P7TrWFGm)

这是外部配置： http: [//pastebin.com/xXhkkKxk](http://pastebin.com/xXhkkKxk)

视频页面 URL 如下：mysite.net/videos/7/example-title.html

视频文件存储如下： mysite.net/vdata/7.flv 其中“7”是视频 ID。

我将不胜感激任何帮助，谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T20:49:58.873

除了标题之外没有其他问题：如何从 AWS 上托管的外部 Javascript 配置动态解析当前页面路径？

我将问题缩短为：如何动态解析当前页面路径？

答案：document.url

[在网络浏览器中获取当前 URL](https://stackoverflow.com/questions/1034621/get-current-url-with-javascript)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-12T04:26:31.960

我得到了它。我回到默认的 Flowplayer 配置并使用 {ldelim} 和 {rdelim} 并完全取出 {literal}{/literal}。效果很好

希望这对将来的某人有所帮助。

谢谢吧

# java - Apache 生成 Web 服务客户端时出现意外的子元素异常

> ID：10113395
> 
> 赞同：7
> 
> 时间：2012-04-11T20:24:58.997
> 
> 标签：java, web-services, exception, axis2

我正在尝试从axis2（版本1.6.1）生成一个带有wsdl2java的webservice客户端。

```
./wsdl2java.sh -uri http://www.ncbi.nlm.nih.gov/entrez/eutils/soap/v2.0/efetch_snp.wsdl 
```

当我调用此服务时，我得到一个异常。

`org.apache.axis2.AxisFault: org.apache.axis2.databinding.ADBException: Unexpected subelement {http://www.ncbi.nlm.nih.gov/soap/eutils/efetch_snp}Rs`

```
 try {
        EFetchSnpServiceStub fetchService = new EFetchSnpServiceStub();
        EFetchSnpServiceStub.EFetchRequest reqIdSnp = new EFetchSnpServiceStub.EFetchRequest();
        reqIdSnp.setId("193925233");
        EFetchSnpServiceStub.EFetchResult resIdSnp = fetchService.run_eFetch(reqIdSnp);
    } catch (Exception e) {
        System.out.println(e.toString());
    } 
```

但是，使用[soaptest](http://soapclient.com/soaptest.html)，我可以在结果中看到Rs Tag。

```
<Rs rsId="193925233" snpClass="snp" snpType="notwithdrawn" molType="genomic" bitField="050000000005000000000100" taxId="3702"> 
```

我该如何解决这个异常？WSDL 不在我的控制之下。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-12T07:17:23.467

**意外子元素**错误主要发生在 ADB 数据绑定类型的 Axis2 中。当 SOAP 响应中的标签序列与 wsdl 形成的 java 类中的属性不同时。

例如，

> 如果响应或请求 XML 必须在序列中具有 a、b、c 元素，而实际 XML 在序列中具有 a、d、c 元素，则 Axis2 会抱怨说它收到了一个名为 d 的意外元素。

可以通过改变wsdl中的标签顺序来解决。

注意：[如果不是这种情况，请在此处查看其他原因](http://blog.mpathirage.com/2009/08/04/reasons-for-unexpected-subelement-exception-in-axis2-data-bindingadb/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-02-12T19:47:28.880

我刚刚遇到了与 NCBI eutils 相同的问题，并通过编辑 wsdl 文件然后在本地重新生成客户端类来解决它。我像你一样使用了soaptest来确切地看到它所期望的，然后让它们匹配起来。就我而言，他们在其 DbInfoType 对象中缺少名为“DbBuild”的元素。

# objective-c - 使用 Objective-C 使用 Tumblr 进行身份验证时出现 Xauth 401 错误

> ID：10113398
> 
> 赞同：0
> 
> 时间：2012-04-11T20:25:08.077
> 
> 标签：objective-c, ios, tumblr, xauth

我一直无法找到让 Objective-C 和 XAuth 为 Tumblr 工作的解决方案。[我发现了许多 Twitter 示例，因此劫持Twitter-XAuth](https://github.com/ericjohnson/twitter-xauth)并将 token_access url 替换为 Tumblr似乎是有意义的。我已经被这个问题困扰了好几个小时，因为我从 Tumblr 得到的所有回报都是在我进行身份验证时出现 401 错误。

该应用程序已在 Tumblr 上注册并启用了 XAuth。

我不知道我做错了什么。

> My Basestring: POST&https%3A%2F%2Fwww.tumblr.com%2Foauth%2Faccess_token&oauth_consumer_key%3D[consumer key]%26oauth_nonce%3D-1943440940%26oauth_signature_method%3DHMAC-SHA1%26oauth_timestamp%3D1334174720%26oauth_version%3D1.0%26x_auth_mode%3Dclient_auth %26x_auth_password%3D[密码]%26x_auth_username%3Dmalcolmbastien%40gmail.com

*对于我的授权标头，NSLog 似乎在转义双引号时打印出 '\' 字符，但我无法判断它们是否存在于请求中。*

> 我的授权标头：{ Authorization = "OAuth oauth_nonce=\"-1943440940\",oauth_signature_method=\"HMAC-SHA1\",oauth_timestamp=\"1334174720\",oauth_consumer_key=\"[consumer key]\",oauth_signature=\ "a2a%2BImFSzi1BCGV2FVzah6RPlVA%3D\",oauth_version=\"1.0\"";

让我知道是否还有其他我应该分享的代码。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T20:26:04.600

这个尚未合并的拉取请求 url 对用户名和密码进行编码。因为 Tumblr 使用电子邮件地址作为用户名，所以它需要对 url 进行编码。

任何想使用 Twitter-xauth 的人都应该检查一下[https://github.com/ericjohnson/twitter-xauth/pull/3](https://github.com/ericjohnson/twitter-xauth/pull/3)

# ruby-on-rails - javascript 文件上的 501 Method Not Found 错误 - 更改名称然后它可以工作 - 为什么？

> ID：10113406
> 
> 赞同：0
> 
> 时间：2012-04-11T20:25:35.403
> 
> 标签：ruby-on-rails, ruby, http, request

我正在开发一个 Ruby on Rails 应用程序，并且有一个名为 jquery.cookie.js 的文件，没有客户端机器下载该文件，因为服务器发回“501 Method Not Implemented”错误。

这不会发生在我的开发机器上。不幸的是，我对这个特定系统非常陌生，并且作为唯一的开发人员（与以前的开发人员没有联系），我什至不知道这可能是什么原因。

我的问题是 - 什么可能导致这个特定的 javascript 文件无法下载？其他的都这样。当我重命名文件（像 jquery.cookee.js 之类的）时，它会毫无问题地下载。显然，我不能将其作为永久解决方案，因为代码中有太多使用它的地方，而且我害怕通过更改它的名称来搞砸其他东西。

想法当然非常受欢迎。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T21:14:32.827

我终于弄明白了——mod_security（apache 的扩展）不断在“jquery.cookie.js”中捕捉到“cookie”这个词，并将该文件标记为潜在威胁，并拒绝提供它。

重命名文件和对它的引用最终是必要的。我宁愿不理会 mod_security 。

# javascript - javascript 或者

> ID：10113407
> 
> 赞同：-1
> 
> 时间：2012-04-11T20:25:43.287
> 
> 标签：javascript, jquery, slideshow

我有以下代码，我使用 php 文件读取文件夹的内容，将其放入数组中，然后使用 Jquery Cycle 插件进行幻灯片放映。

```
<html>
<meta http-equiv="refresh" content="1000"/> 
head>
<title>Media Signage Slideshow</title>
<style type="text/css">
    #myslides {
    width: 370px;
    height: 220px;
    padding: 0;  
    margin:  0 auto;  
} 
     </style>
</head>

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.5/jquery.min.js"></script>

<script type="text/javascript" src="http://cloud.github.com/downloads/malsup/cycle/jquery.cycle.all.latest.js"></script>

<script type="text/javascript">
$(document).ready(function(){
$('#myslides').cycle({
               fx: 'fade',
                speed: 5000,
                timeout: 2000
        });
});
</script>

<script type="text/javascript">

var curimg=0;
function rotateimages(){
galleryarray.sort();
document.getElementById("myslides").setAttribute("src", "images/"+galleryarray[curimg]);
curimg = (curimg+1) % galleryarray.length;
}

window.onload = function(){
setInterval("rotateimages()", 5000);
}
/script>

<script type="text/javascript" language="JavaScript" src="./code.php"></script>
<body>
<div id="myslides">
  <!--<img src="100.jpg" />
  <img src="101.jpg" /> -->
</div>
</body>
</html> 
```

当我改变时：

```
<div id="myslides"> 
```

至

```
<img id="myslides"> 
```

我的幻灯片工作正常，但使用 div id 我什么也看不到。如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T20:29:02.393

图像具有您的 jquery 正在使用的 source 属性，而 div 则没有。这就是为什么 ：）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T20:28:12.440

更改`#myslides`为 a`div`意味着您正在尝试设置`src`一个`div`根本没有实际意义（并且不验证）的元素。你想达到什么目的？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-11T20:31:51.970

看看这部分代码：

```
document.getElementById("myslides").setAttribute("src", "images/"+galleryarray[curimg]); 
```

您无法访问它，因为 DIV 元素没有“src”属性。所以你不能用你的插件为它设置一个图像。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-11T20:34:35.793

如果您出于任何原因需要 div，为什么不将 img 包装在其中？

```
<div><img id="myslides" /><div> 
```

# sql - 如何在 SQL Server 2005 中将相似数据批量复制到两个表中？

> ID：10113414
> 
> 赞同：0
> 
> 时间：2012-04-11T20:26:22.440
> 
> 标签：sql, sql-server-2005, sqlbulkcopy

我已经“继承”了一些我很难使用的代码。该应用程序具有将成员导入成员表的excel导入功能，并被`SqlBulkCopy`使用。

几个月前，添加了一个联结表，并且必须在成员表中添加两个属性，以便应用程序正常工作。没有硬耦合（没有PK、FK——不是我的选择！）。

我不知道如何解决这个问题，因为据我所知你不能批量复制到两个表，你必须分开做。但是如何以最佳方式检索新导入成员的 GUID 属性以及其他属性值 (groupId)（对性能影响低）？

例子：

Excel导入：

```
Name
Email
plus more 
```

表格1

```
name
personID (GUID)
groupID (same for all imported members)
+ other attributes 
```

表2

```
personID (GUID)
groupID (same for all imported members)
+ other 'new' attributes 
```

抱歉，这次我不能提供任何代码：/ 真的希望有人能给我任何建议！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T21:01:06.553

目前尚不清楚您究竟是什么**以及**如何将 Excel 导入的数据存储到这两个表中，以及这些数据的`groupID`来源......

基本上 - 你是对的 - 你不能批量插入到多个表中。所以我的看法是：

`Staging`1）像今天一样从Excel批量插入表格

2）然后插入您需要存储的那些信息，`Table1`并输出您需要将这些位“连接”到位的必要信息`Table1`-`Table2`类似于以下内容：

```
DECLARE @Connection TABLE (GroupID INT, PersonID UNIQUEIDENTIFIER, EMail VARCHAR(500))

INSERT INTO dbo.Table1 (list of columns here)
    OUTPUT Inserted.GroupID, Inserted.PersonID, Inserted.EMail 
        INTO @Connection(GroupID, PersonID, EMail)
    SELECT
       (list of columns here)
    FROM
       dbo.Staging
    WHERE 
       (possibly a condition here???) 
```

这会将行从`Staging`插入到您的`Table1`中，并且在这样做的同时，它将为插入的每一行写出一些信息-`GroupID`和。`PersonID``EMail`

有了这些信息，您应该还可以将您的值插入`Table2`：

```
INSERT INTO dbo.Table2 (GroupID, PersonID, EMail, list of other columns here)
    SELECT
       c.GroupID, c.PersonID, c.EMail,
       (list of other columns from Staging table here)
    FROM @Connection c
    INNER JOIN dbo.Staging s ON c.EMail = s.EMail   -- or use whatever you can use to 
                                                    -- connect the two sets of data
    WHERE (condition) ...... 
```

# parsing - 用“混合换行类型”计算行号的算法

> ID：10113416
> 
> 赞同：4
> 
> 时间：2012-04-11T20:26:31.330
> 
> 标签：parsing, newline

我需要一个特定的描述（一个不会被正则表达式等东西混淆的描述），用于一个可以计算混合换行符的源文件的算法：

```
'\r', '\n', '\r\n', '\n\r' 
```

我目前有以下算法。好吗？：

1.  我确保始终位于第一个换行符类型的“边界”上。

2.  在那个事件中，我比较了当前的字节字符。

3.1。如果是'\n'，我算作结束当前行并开始新行。

3.2\. 如果是'\r'，我读取下一个字符（如果没有超出文本缓冲区的限制）并查看它是否是'\n'。如果是，我将其视为 '\r\n' 换行符。

3.3\. 如果是'\r'，并且下一个字符不是'\n'，我把它算作'\r'产生的换行符；将当前行标记为结束并将其计为新行的开始。

* * *

如果它有用，我需要它来尝试对跨 Web 浏览器复制/粘贴的源文件和/或从具有不同类型换行符的多个文件附加的源文件产生更大的“可移植性”，并且我有我想要的解析工具以确保在所有情况下都具有正确且稳健的行为。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-12T00:08:55.360

该算法应涵盖所有情况的 99.999%。

您可能应该以二进制模式而不是文本模式阅读源代码，以确保没有 I/O 层试图通过将其中一些转换为`'\n'`.

您没有指定您正在使用哪种语言。请注意，在 C 和 C++ 中，`'\n'`它与其他转义字符不同，因为它不能保证具有特定值。的确，在大多数实现中，它将映射到 ASCII 换行符，但使用诸如`'\x0A'`保持代码可移植性之类的东西更安全、更明确。

还有一些其他的换行方案，但它们非常罕见。Unicode 中有一个[NEL](http://www.fileformat.info/info/unicode/char/85/index.htm)字符，用于与最初在 EBCDIC 中的文件（我认为）进行往返兼容。Unicode 还引入了[LINE SEPARATOR](http://www.fileformat.info/info/unicode/char/2028/index.htm)和[PARAGRAPH SEPARATOR](http://www.fileformat.info/info/unicode/char/2029/index.htm)，您可能也希望将它们视为换行符。但是这些非常罕见并且处理起来很复杂，因为它们超出了 ASCII 范围，因此您需要了解您的编码并准备好处理这些问题。

# active-directory - LDAP 在基本 dn 之上添加条目

> ID：10113425
> 
> 赞同：0
> 
> 时间：2012-04-11T20:27:31.050
> 
> 标签：active-directory, ldap

我的目标是将条目从一个 ldap 服务器传输到另一个 - 保留原始的基本 dn，这样我们就不必修改我们的 mac os 邮件客户端（我们有数百个）上的基本 dn 引用。现在，我意识到我们可以进入每台计算机并更改 dn，但我们想避免这种情况。

来源：具有我要保留的 dn 的 LDAP

目标：我要将条目添加到的 Active Directory LDAP

我似乎无法在目标 LDAP 的基本 dn 之上添加条目：

```
dn: dc=odmaster,dc=mhc,dc=org
dc: odmaster
objectclass: domain 
```

目标 LDAP 当前在 dc=odmaster,dc=mhc,dc=org dn 下有几个条目。

当我尝试通过 phpldapadmin 导入以下 .ldif 文件时，我收到以下错误：无法将对象添加到 LDAP 服务器服务器不愿意执行。它也不能通过 ldapadd 命令在终端上运行。

```
dn: ou=users,dc=mhc,dc=org
description: Users
objectclass: organizationalUnit
ou: users 
```

但是当我像这样在基本 dn 下面添加条目时它是成功的：

```
dn: ou=users,dc=odmaster,dc=mhc,dc=org
description: Users
objectclass: organizationalUnit
ou: users 
```

知道为什么我不能在目标 LDAP 上的 dc=mhc,dc=org dn 添加条目吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-12T08:45:56.050

一种可能的答案是服务器数据库命名上下文设置为`dc=odmaster,dc=mhc,dc=org`. 如果是这种情况，LDAP 客户端可能不会在上面添加条目`dc=odmaster`。通过以下方式检查此配置：

*   咨询 LDAP 管理员
*   以编程方式咨询根 DSE

另一种可能性是阻止客户端访问、添加或修改条目的访问控制。

### 也可以看看

*   [根 DSE](http://ff1959.wordpress.com/2011/04/11/the-root-dse-is-that-entry-with-zero-rdns-and-contains-information-about-the-directory-server/)

# html - CSS 2 div大小自动相同高度

> ID：10113435
> 
> 赞同：4
> 
> 时间：2012-04-11T20:28:13.763
> 
> 标签：html, css, size, width

我在 CSS 中有一个问题：

我该怎么做：

![CSS 自动宽度](../Images/f191ef9d84d7c39efb35e27c0860823e.png)

当绿色 div 的内容具有（自动）500px 高度时，红色的高度相同。

当红色的内容具有（自动）700px 高度时，绿色的高度相同。

两者都有任何内容，然后我使用自动高度。

那么我怎样才能使绿色也具有与红色和红色相同的宽度，但“高度：自动；”的内容却不同？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-11T20:55:50.270

首先，阅读[这篇优秀的文章](http://matthewjamestaylor.com/blog/equal-height-columns-cross-browser-css-no-hacks)。然后，检查小提琴：

[http://jsfiddle.net/UnsungHero97/qUT3d/](http://jsfiddle.net/UnsungHero97/qUT3d/)

## HTML

```
<div id="container3">
    <div id="container2">
        <div id="container1">
            <div id="col1">Column 1</div>
            <div id="col2">Column 2</div>
            <div id="col3">Column 3</div>
        </div>
    </div>
</div> 
```

## CSS

```
#container3 {
    float:left;
    width:100%;
    background:green;
    overflow:hidden;
    position:relative;
}
#container2 {
    float:left;
    width:100%;
    background:yellow;
    position:relative;
    right:30%;
}
#container1 {
    float:left;
    width:100%;
    background:red;
    position:relative;
    right:40%;
}
#col1 {
    float:left;
    width:26%;
    position:relative;
    left:72%;
    overflow:hidden;
}
#col2 {
    float:left;
    width:36%;
    position:relative;
    left:76%;
    overflow:hidden;
}
#col3 {
    float:left;
    width:26%;
    position:relative;
    left:80%;
    overflow:hidden;
}​ 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-11T20:33:00.633

我只需将两个 DIVS 包装在另一个 div 中，然后让它们在父 DIV 上碰撞，然后调整父级的大小

像这样的东西......然后使用CSS来格式化它们

```
<div id=parent>
    <div id=child>
      Content....
    </div>
    <div id=child>
      Content....
    </div>
</div> 
```

其他一些解决方案可以在这里列出 [http://www.ejeliot.com/blog/61](http://www.ejeliot.com/blog/61)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-11T20:39:25.027

理想情况下，你会在两个单元格上设置一个最小高度，或者@Taeeril 的回答正确地建议使用 javascript 来等于高度。

这是使用表格显示类型的解决方案[http://jsfiddle.net/SebAshton/Pj7gy/](http://jsfiddle.net/SebAshton/Pj7gy/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-05-16T08:03:05.963

```
Better solution use both javascript and css. 
```

[http://codepen.io/micahgodbolt/pen/FgqLc](http://codepen.io/micahgodbolt/pen/FgqLc)

# java - 应用程序中未引用的 JS 文件

> ID：10113436
> 
> 赞同：0
> 
> 时间：2012-04-11T20:28:20.337
> 
> 标签：java, javascript, jsf

我有 jsp 页面，其中调用了我的 xhtml 页面。我将 xhtml 映射到 facesServlet 并且所有资源 servlet 都处于活动状态，因此如果我点击 xhtml 页面，它可以很好地映射所有 js 和 css 文件。

如果我点击 jsp 页面，那么这些文件不会被引用 firebug 会弹出各种 js 错误。

为了解决这个问题，我将 js 和 css 文件添加到 web 文件夹中，并在 xhtml 和 jsp 页面中包含并尝试了它们，但这些没有被引用，截至目前，如果我直接点击 xhmtl 页面，则文件上传工作正常，但如果我去点击jsp页面然后最终得到js错误，有没有其他方法可以让js文件包含在内。

这是引用我的`js`文件的方式

```
<%@ include file="/common/taglibs.inc" %>

<html>
<head>
    <link rel="stylesheet" href="/css/Main.css" type="text/css">
    <link rel="stylesheet" href="/css/Admin.css" type="text/css">
    <link rel="stylesheet" href="/css/Home.css" type="text/css">
    <script type="text/javascript" src="/js/icefaces/ace-jquery.js"/>
    <script type="text/javascript" src="/js/icefaces/ace-components.js"/>
    <script type="text/javascript" src="/js/icefaces/icepush.js"/>
    <script type="text/javascript" src="/js/icefaces/bridge.js"/>
    <script type="text/javascript" src="/js/icefaces/compat.js"/>
    <script type="text/javascript" src="/js/icefaces/fileEntry.js"/>
    <script type="text/javascript" src="/js/icefaces/jsf.js"/>
    <script type="text/javascript" src="/js/icefaces/icefaces-compat.js"/>

    <!-- BEGIN SCRIPT TO OPEN RIGHT NOW HELP POPUP, THIS SCRIPT INCLUDES THE FUNCTION OPENRN-->
    <
    %@ include file="/js/popupRightNow.inc" %>

    <!-- END SCRIPT TO OPEN RIGHT NOW HELP POPUP, THIS SCRIPT INCLUDES THE FUNCTION OPENRN-->

    <META http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
</head>
<body>
<jsp:include page="/navigation/TopNav.jsp" flush="true"/>

<jsp:include page="/trade_entry/UploadBlotter.xhtml"/>

<!--BEGIN BOTTOM NAV -->
<jsp:include page="/navigation/BottomNav.jsp" flush="true"/>
<!--END BOTTOM NAV -->
</body>
</html> 
```

有什么想法、建议吗？

**更新：**

我需要使用创建新页面，`jsf2`并且我已经创建了`xhtml`页面，但我想获取我的应用程序`header`和`footer`主题，并且现在定义了这些`jsp`我尝试寻找集成`jsp`，`xhtml`但正确地建议不要这样做。

尝试过[如何在 Facelets 页面中包含 JSP 页面？](https://stackoverflow.com/a/6110516/164299)但这也不起作用，因为`my`标签无法识别，所以最后尝试创建`jsp`页面并`xhtml`在其中包含页面，这似乎有效但不是 100%。

因此，就目前而言，如果我`xhtml`直接点击页面，那么它可以工作，但是如果我点击`jsp`带有`header/footer`信息的页面，`icefaces`或者说`jsf`东西不能 100% 工作，希望能够澄清我想要实现的目标。

**更新 2**

来自的 js 文件`javax.faces.resources`在 xhtml 页面上被很好地引用，但在`jsp`页面上没有被引用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-12T01:55:47.553

必须下载那些 JS/CSS 文件的是网络浏览器。不是服务器必须加载/包含那些 JS/CSS 文件。

因此，您指定的路径`src`和`href`属性是相对于当前请求 URL 解析的，如您在浏览器的地址栏中看到的那样。它们不会相对于公共 Web 内容中 JSP 文件的位置进行解析。

所以，如果你碰巧在请求 URL 中有一个上下文路径，像这样

> [http://localhost:8080/somecontextpath/page.jsp](http://localhost:8080/somecontextpath/page.jsp)

then for example your `<link href="/css/Main.css">` would be downloaded by the webbrowser from the following URL

> [http://localhost:8080/css/Main.css](http://localhost:8080/css/Main.css)

while it should *actually* have been

> [http://localhost:8080/somecontextpath/css/Main.css](http://localhost:8080/somecontextpath/css/Main.css)

Fix it accordingly.

```
<link rel="stylesheet" href="${pageContext.request.contextPath}/css/Main.css" type="text/css"> 
```

Or if you're using Facelets

```
<link rel="stylesheet" href="#{request.contextPath}/css/Main.css" type="text/css"> 
```

Or if you're using JSF 2 `<h:outputStylesheet>` (and `<h:outputScript>` components)

```
<h:outputStylesheet name="css/Main.css" /> 
```

*(and put the `/css` and `/js` folders in `/resources` subfolder of public webcontent)*

* * *

By the way, the following line makes absolutely no sense:

```
<jsp:include page="/trade_entry/UploadBlotter.xhtml"/> 
```

You're mixing view technologies here. You can't include the one in the other. Facelets is the successor of JSP. Use the one or the other. You can mix them in 1 webapp, but not in 1 view.

# search - 代理背后的 Twitter 小部件

> ID：10113437
> 
> 赞同：0
> 
> 时间：2012-04-11T20:28:30.050
> 
> 标签：search, twitter, proxy, widget

我正在尝试在服务器位于我公司内部的站点中使用 Twitter 小部件，因此在其代理后面。

我不能直接使用他们提供的代码，因为我无法到达源地址。

```
<script charset="utf-8" src="http://widgets.twimg.com/j/2/widget.js"></script> 
```

我想知道是否可以制作 js 的本地副本，这样我就可以避免这个问题，但是，当我这样做时，我得到：

```
ActionView::WrongEncodingError in Home#index
Your template was not saved as valid UTF-8\. Please either specify UTF-8 as the encoding     for your template in your text editor, or mark the template with its encoding by inserting the following as the first line of the template:

# encoding: <name of correct encoding>. 
```

但是编码已经设置好了。

我对这些东西真的很陌生。请帮忙。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T21:56:22.230

您得到的错误是因为 ruby​​ 需要显式编码才能正确解析非 latin-1 文件。

在每个具有 utf-8 字符的 ruby​​ 文件中，您需要第一行，如示例：

```
# encoding: UTF-8 
```

至于您问题的主要问题，您可以尝试，但可能与推特的通信被阻止。您应该与您的系统管理员联系以尝试访问您的应用程序的 twitter。

# php - Wordpress：自定义循环按月对帖子进行排序...需要帮助提取 post_content .. wpdb

> ID：10113441
> 
> 赞同：0
> 
> 时间：2012-04-11T20:28:42.430
> 
> 标签：php, loops, wordpress

我正在尝试编写一个循环来按月显示帖子。到目前为止进展顺利，我只需要帮助从数据库中提取 post_content。我已经使用 wpdb 成功获取了所有其余的帖子信息。我已经尝试过 post_content 就像 post_title 一样，但它不起作用。

这是我正在处理的示例页面。 [http://asg.websolutionshack.com/events/](http://asg.websolutionshack.com/events/)

```
<div id="events" class="full">`
 <?php 
```

`$months = $wpdb->get_results("SELECT DISTINCT MONTH(post_date) AS month , YEAR(post_date) AS year FROM $wpdb->posts WHERE post_status = 'publish' and post_date <> now() and post_type = 'event' GROUP BY month, year ORDER BY post_date DESC"); $posts = $wpdb->get_results("SELECT id, post_title, post_content, MONTH(post_date) AS month , YEAR(post_date) AS year , DAY(post_date) AS day FROM $wpdb->posts WHERE post_status = 'publish' and post_type = 'event' ORDER BY post_date DESC"); foreach($months as $this_month){ ?>`

```
<div class="month_block">
<h2 class="month"><?php echo date("F", mktime(0, 0, 0, $this_month->month, 1, $this_month->year)); ?> <?php //echo $this_month->year; ?></h2>
<?php for ($i = 0; $i <= count($posts); $i++){?>`

<div class="entry"> 
  <?php if(($this_month->year == $posts[$i]->year)&&($this_month->month == $posts[$i]->month)){?>
  <span><?php echo $posts[$i]->month ?>.<?php echo $posts[$i]->day ?>.<?php echo $posts[$i]->year ?></span><h3><?php echo $posts[$i]->post_title; ?></h3>
   <p><<?php echo $posts[$i]->post_content; ?><a href="<?php echo get_permalink($posts[$i]->id); ?>">Details ></a></p>
  <?php } ?>
</div><!-- entry -->
<?php } ?>
</div><!-- month --> 
```

`

感谢您为我提供的任何见解。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T21:24:39.680

```
<?php the_content( $more_link_text, $stripteaser ); ?> 
```

返回帖子内容。

更多信息[在这里。](http://codex.wordpress.org/Function_Reference/the_content) 还可以在这里查看相关线程[。](http://wordpress.org/support/topic/post_content-with-formatting)

# symfony - 用于继承对象的 Twig instanceof

> ID：10113442
> 
> 赞同：20
> 
> 时间：2012-04-11T20:28:42.747
> 
> 标签：symfony, propel, twig, single-table-inheritance

我正在使用 propel [http://www.propelorm.org/documentation/09-inheritance.html](http://www.propelorm.org/documentation/09-inheritance.html)的以下功能。

我也在使用 Symfony2 和 Twig

我有一个使用上述功能的类结构，看起来像这样

```
class Event {}

class Birthday extends Event {}

class Walking extends Event {} 
```

现在我将一个事件对象传递给一个树枝模板，我想知道它是什么类型的事件

例如，如果是生日，我想显示蛋糕的图像，如果是步行事件，我想显示地图路线。

我不能在 Twig 中使用 instanceof，因为此功能不存在。有谁现在为什么这不存在？有没有办法我可以复制这个功能而不必做类似的事情

```
 public function getType() 
```

在每个班级，或

```
 public function isBirthday() 
```

在事件类中。

我在 github 上找到了这个，但它对我没有用。我已经对他们发表了评论，看看我是否能得到答案。

[https://github.com/fabpot/Twig/issues/553](https://github.com/fabpot/Twig/issues/553)

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2013-09-11T21:30:45.880

我同意这个观点，这`instanceof`不应该出现在模板中。我在这种情况下使用 twig-tests

```
class MyTwigExtension extends TwigExtension
{
    public function getTests ()
    {
        return [
            new \Twig_SimpleTest('birthday', function (Event $event) { return $event instanceof Birthday; }),
            new \Twig_SimpleTest('walking', function (Event $event) { return $event instanceof Walking; })
        ];
    }
} 
```

并且在模板中

```
{% if event is birthday %}{# do something #}{% endif %} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-05-29T10:51:20.507

如果您知道每个继承的对象都有一个唯一的方法，那么实现此目的的间接方法是测试对象的方法。也许你的生日类有一个 getBirthday()，而你的步行类有一个 getMap()？

```
{% if yourobject.methodName is defined %}
   //Stuff that should only output when the object in question has the requested method
{% endif %} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-04-12T10:01:02.847

从架构的角度来看，在模板中使用 instanceof 是不受欢迎的。如果您发现自己处于“需要”它的位置，那么您可能已经发现了架构中的问题。您的 getType 解决方案可能是最好的。您仍然可以将其放入事件基类中并读出实现类的名称。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-01-16T15:19:22.797

另一个解决方案：

```
class Event {
    ...
    public function isInstanceOfBirthday() {
        return $this instanceof Birthday;
    }
} 
```

那么它将适用于任何继承自的类

```
class Birthday extends Event {}

class Walking extends Event {} 
```

然后在你的树枝上：

```
{{ event.isInstanceOfBirthday ? ... something for Birthday instance ... : ... something for Walking instance ... }} 
```

或者

```
{% if event.isInstanceOfBirthday %}
    ... do something for Birthday instance ...
{% else %}
    ... do something for Walking instance ...
{% endif %} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-06-12T09:01:28.837

我有类似的问题，它与酒店软件中的继承有关。我有一个基类“RoomEquipment”，并继承了“Bed”、“ElectricAppliances”......

```
class BaseRoomEquipment {}

class Bed extends BaseRoomEquipment {}

class ElectricAppliances extends BaseRoomEquipment {} 
```

当然，还有一个与 RoomEquipment 有 OneToMany 关系的“Room”类。

在模板上，我只想渲染床，但房间与基础设备有关，包括床和电器。

我没有在树枝模板中进行测试，而是在 Room 类中创建了一个方法 getBeds，仅此而已。

```
class Room {

  private $equipment;

  public getBeds() 
  {
     $res = [];
     foreach($this->getEquipment() as $eq) {
        if ($eq instanceof Bed) $res[] = $eq;
     }
     return $res;
  }

  // Rest of class here....

} 
```

当然，在 Twig 中：

```
<div>
    {% for Bed in Room.beds %}
       {{ Bed.nbPersons }}
    {% endfor %}
</div> 
```

感谢 Property Accessor 组件 - 这是可能的。现在，您的树枝不必检查实例类型，也不必检查

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-01-11T00:08:48.843

我正在尝试创建一个 index.html.twig 列出用户定义的实体，并且只列出已标记为的字段`'addToListing'`所以我到了我不知道我在打印什么的地步。

```
{% for entity in entities %}
    <tr>
        {% for heading in headings %}
            <td><a href="{{ path('document_show', { 'id': entity.id, docType: metaData.className }) }}">{{ attribute(entity, heading) }}</a></td>
        {% endfor %}
    </tr>
{% endfor %} 
```

并且标题恰好是 \DateTime :/ 所以对于这种情况，我需要 | date('format') 或一些更好的解决方案。

对我来说有什么清洁解决方案的建议吗？

# function - matlab 函数

> ID：10113443
> 
> 赞同：1
> 
> 时间：2012-04-11T20:28:53.750
> 
> 标签：function, matlab

helo，我有以下名为 stat.m 的函数

```
function [mean,stdev] = stat(x)
n = length(x)
mean = sum(x)/n
stdev = sqrt(sum((x-mean).^2/n)) 
```

我将 x 定义为一个向量，它是 `[1,2,5,7,9]`

为什么当我键入时`a = stat(x)`，matlab`a = 5`在命令提示符处返回最后一行？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-11T20:36:12.063

如果你想获得两个返回值，你必须这样做：

```
[a, b] = stat(x); 
```

如果您只是这样做`a = stat(x)`，MATLAB 会将其解释为您只需要第一个返回值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-11T20:36:24.797

因为`a`得到第一个参数`mean`

试着叫它`[a,b] = stat(x)`

# scala - Scala HashMap：按插入顺序迭代？

> ID：10113448
> 
> 赞同：5
> 
> 时间：2012-04-11T20:29:08.950
> 
> 标签：scala, hashmap

我一直在环顾四周，但大多数都指向一个java TreeMap。唯一的问题是我不想将任何 Scala 转换为 java 并返回。如果真的没有办法，那我可以接受，但我想听听一些专业人士的意见，只是为了 100% 确定，并在这里提出这个问题，以便将来其他人在遇到类似情况时偶然发现问题。提前致谢。

编辑：

类型：scala.collection.mutable.HashMap[String, String]

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-11T20:32:52.013

通常，Scala`HashMap`不保证原始顺序。

但是，有`LinkedHashMap`，它指出：“该类的迭代器和所有遍历方法按照插入的顺序访问元素。”

您正在处理的确切类型是什么？如果您可以决定使用哪种实现，那么您可以选择一个维护顺序的实现。如果你只是得到了 type 的东西`HashMap`，那么你就不走运了。

# matlab - 使用 MATLAB 从投影矩阵进行反投影

> ID：10113453
> 
> 赞同：0
> 
> 时间：2012-04-11T20:29:25.933
> 
> 标签：matlab, projection-matrix

我有一个 256x256 的投影矩阵。每行都是以相等角度拍摄的投影。我需要使用 matlab 生成带有反投影的原始图像，我对 matlab 并不熟悉。你能建议我任何代码示例或算法吗？我发现了一些类似的代码，我无法使用它们生成原始图像。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T20:33:41.767

[`iradon`](http://www.mathworks.com/help/toolbox/images/ref/iradon.html)如果您有图像处理工具箱，则该命令应该相对简单。如果你不这样做，它会有点困难，因为你需要推出你自己的版本。显然你不能使用它，但是如果我使用它，我会得到一张图像：

```
I = iradon(Pteta',linspace(0,179,size(Pteta,1)); 
```

那么，你怎么能自己做到这一点呢？我会在不给你答案的情况下一路帮助你——这毕竟是功课！

首先，考虑一下你的 0 度投影。想象一下您投影的轴有 1,256 个单位。现在想象这些*坐标*在你的图像上的反向投影，它看起来像这样： ![0 度投影的反投影坐标](../Images/bd14e1474685fa12ec36d666badd145e.png)

同样，假设一个 90 度的投影看起来像这样： ![0 度投影的反投影坐标](../Images/70dcbefb545f8d5f6294b6c4f6963369.png)

很酷，我们可以使用 得到这些矩阵`[X, Y] = meshgrid(1:256);`，但是离轴投影呢？想想沿某个角度线的距离，例如转换极坐标/笛卡尔坐标：

```
theta = 45 % projection angle in degrees
t = X*cosd(theta) + Y*sind(theta); 
```

它有效！

![45 度投影的反投影坐标](../Images/1c8850fe15fae952f5038bc1edce7e89.png)

不过有问题！注意到现在值上升超过 350 了吗？它也有点偏离中心。现在坐标超过了我们投影的长度，因为正方形的对角线比边长。我将留给您解决这个问题，但最终图像将小于初始投影，并且您可能需要使用不同的单位（-127 到 128 而不是 1 到 256）。

现在，您只需索引这些角度的投影，即可在图像上反向投影实际值。但是，这里还有第二个问题，因为这些值不是整数！我们可以对它们进行四舍五入，这称为最近邻插值，但它并没有给出最好的结果。

```
proj = Pteta(angle,:);
% add projection filtering here
t = X*cosd(theta) + Y*sind(theta);
% do some rounding/interpolating to make t all integers
imagesc(proj(t)); 
```

对于我们的偏心版本，这给了我们这个图像，或者类似的东西： ![45度反投影](../Images/b8ca40e68f61b3b781a5ab410f982231.png)

现在你只需要对每个角度都这样做，然后把它们加起来。

# apache - 如何在带有 Haproxy 的 Apache 2.4.1 中使用 mod_deflate？

> ID：10113454
> 
> 赞同：2
> 
> 时间：2012-04-11T20:29:27.350
> 
> 标签：apache, haproxy, mod-deflate

我有一个奇怪的问题，通过 HAproxy 检索 swf 文件时，在我的 Apache 2.4.1 httpd.conf 中包含以下语法会导致“502 Bad Gateway”错误：

```
AddOutputFilterByType DEFLATE text/html text/plain text/xml text/css application/x-javascript text/javascript 
```

当我删除此配置行时，502 Bad Gateway 错误就会消失。

服务器在成功请求时返回这些响应标头：

```
Date: Wed, 11 Apr 2012 20:24:12 GMT
Server: Apache
Connection: close
Transfer-Encoding: chunked
Content-Type: text/html; charset=utf-8

200 OK 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T18:34:09.460

我通过更新到 Apache 2.4.2 修复了这个问题（2.4.1 中有一个 mod_deflate 段错误错误）并添加：

`Header append Vary User-Agent`

线下`AddOutputFilterByType`。

# html - Spotify 播放按钮

> ID：10113456
> 
> 赞同：-1
> 
> 时间：2012-04-11T20:29:30.490
> 
> 标签：html, button, widget, playback, spotify

只是用新的播放按钮寻找一些澄清。我注意到，当您在小部件上点击播放时，它会在实际的 spotify 应用程序中播放歌曲。这是否意味着您需要 spotify 才能使用小部件？如果您点击播放并且没有 Spotify，会发生什么？您是否有计划使小部件独立于应用程序？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-12T11:10:20.110

播放按钮的工作方式与 Spotify 的 Facebook 集成非常相似：

*   曲目在 Spotify 客户端中播放。
*   如果 Spotify 客户端未运行，它将启动。
*   如果未安装，将引导用户完成简化的安装过程。

目前，这是必需的，因为如果没有它，我们将不得不用 JavaScript 编写一个 Spotify 客户端，这 1）很难，2）以纯文本形式提供服务，这不是我们真正想做的事情！:-)

# java - ObjectOutputStream 和 PrintWriter 冲突

> ID：10113460
> 
> 赞同：5
> 
> 时间：2012-04-11T20:30:17.867
> 
> 标签：java

我设置了服务器和客户端，这基本上是一个基本的文本电子邮件系统。我目前正在使用 PrintWriter 在服务器和客户端之间发送文本。我正在尝试创建一个基于附件的系统，为此我使用了 ObjectOutputStream。

```
private static PrintWriter output;
private static ObjectOutputStream outStream;

public ClientHandler(Socket socket) throws IOException
{
    client = socket;
    outStream = new ObjectOutputStream(client.getOutputStream());
    input = new Scanner(client.getInputStream());
    output = new PrintWriter(client.getOutputStream(), true);
} 
```

我目前遇到的问题是，如果我尝试通过输出打印机发送文本，由于某种原因，额外的字符将被添加到发送的文本的开头，这意味着程序无法识别通过打印机传递给客户端的关键字。如果我注释掉 outStream 对象的创建，问题就会停止。

谁能给我任何建议来尝试解决这个冲突问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-11T20:36:04.737

这个额外的文本来自对象输出流。

将 ObjectOutputStream 和 PrintStream 附加到同一个输出流基本上是行不通的。你必须想出一个使用 1 或其他的解决方案。要仅使用 PrintStream，您可能会考虑将您的对象转换为 JSON 或 XML。另一方面，您可以只使用 ObjectOutputStream 并将您的字符串写入 ObjectOutputStream

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T20:46:22.553

扩展您的 ClientHandler 并覆盖构造函数以包含处理文件传输的代码。打开两个端口，一个用于文本，另一个用于文件传输。

```
private static PrintWriter output;

public ClientHandler(Socket socket) throws IOException
{
    client = socket;
    input = new Scanner(client.getInputStream());
    output = new PrintWriter(client.getOutputStream(), true);
}

private static ObjectOutputStream outStream;

public ClientFileHandler(Socket socket) extends ClientHandler throws IOException
{
    client = socket;
    outStream = new ObjectOutputStream(client.getOutputStream());

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-11T20:35:42.530

`ObjectOutputStream`只能用作`ObjectOutputStream`该频道上的一个。`PrintWriter`如果您确实需要，请在另一个插座上使用。

# meteor - 我可以在 Meteor 中使用其他 node.js 库吗？

> ID：10113464
> 
> 赞同：6
> 
> 时间：2012-04-11T20:30:31.250
> 
> 标签：meteor

我正在玩一个想法，想从另一个站点获取一些 json。我发现使用 node.js 的人似乎使用 http.get 来完成此任务，但我发现在 Meteor 中这并不容易。有没有另一种方法可以做到这一点或访问http所以我可以调用get？我想要一个可以从外部来源收集数据的间隔，以增加客户将与之交互的数据。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-29T15:40:55.017

现在使用`Meteor.http`. 首先运行`meteor add http`，然后您可以执行以下操作：

```
// common code
stats = new Meteor.Collection('stats');

// server code: poll service every 10 seconds, insert JSON result in DB.
Meteor.setInterval(function () {
  var res = Meteor.http.get(SOME_URL);
  if (res.statusCode === 200)
    stats.insert(res.data);
}, 10000); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-04-12T22:27:53.243

看起来你可以`require`这样：

```
var http = __meteor_bootstrap__.require('http'); 
```

请注意，这可能仅适用于服务器，因此请确保通过检查`Meteor.is_server`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-11-14T11:19:43.690

`Meteor.http`如果你想处理http，你可以使用。要添加其他 node.js 库，您可以使用[meteorhacks:npm](https://github.com/meteorhacks/npm)

`meteor add meteorhacks:npm`

创建一个`pacakges.json`文件并添加所有必需的包名称和版本。

```
{
  "redis": "0.8.2",
  "github": "0.1.8"
} 
```

# php - 无法在列出用户 php MYSQL 时获得最大日期

> ID：10113465
> 
> 赞同：0
> 
> 时间：2012-04-11T20:30:33.013
> 
> 标签：php, mysql

我有两张桌子，我想得到最后输入的日期。

```
The first table is seeker:

seeker_nic-----username
111-------------ali
222-------------umer
333-------------raza

The second one is requestblood:

id-------seeker_nic-----requireddate
1-------  111 ----------2012/10/9
2 ------- 222-----------2012/5/8
3 ------  111-----------2012/12/12
4 ------- 111-----------2012/11/12
5---------111-----------2012/09/09
6 ------- 222-----------2012/7/9
7 ------- 333 ----------2012/4/4 
```

现在，我想列出用户的最后插入日期，例如..

```
s.no---- username----- requireddate
 1------- ali---------- 2012/09/09
 2------- umer--------- 2012/7/9
 3------- raza--------- 2012/4/4 
```

我正在使用这个查询

```
SELECT seeker.username,bloodrequest.requireddate, 
 max( bloodrequest.bloodrequest_id ) AS maxdate
FROM seeker
JOIN bloodrequest ON seeker.seeker_nic = bloodrequest.seeker_nic
GROUP BY seeker.username 
```

当我在 phpmyadmin 中运行此查询时.. 它列出了所有用户并显示每个用户的第一个插入日期.. 但我想要最后插入的日期......我该怎么办.. 请我需要帮助:(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T20:39:02.167

编辑真实答案：

不是很干净的 sql，但它会给你你正在寻找的结果。我确信有一种方法可以通过 group by 做得更好，但这很有效。:)

```
SELECT s.username,
(
    SELECT br1.requireddate 
    from bloodrequest as br1 
    where br1.bloodrequest_id = 
    (
        select max(br2.bloodrequest_id)
        from bloodrequest as br2 
        where br2.seeker_nic = s.seeker_nic
    )
) as requireddate
FROM seeker as s 
```

# c# - 自动增长 WPF 富文本框

> ID：10113468
> 
> 赞同：2
> 
> 时间：2012-04-11T20:30:47.167
> 
> 标签：c#, wpf, xaml

您可以使用 TextBox 来解决问题：当您设置 AcceptReturn=true 时，TextBox 将随着您添加新的文本行而增长。

是否可以对 RichTextBox 做同样的事情？

我在 WPF 中这样做

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T23:52:46.850

是的。默认情况下，`RichTextBox`接受`return`并将相应地增长。例如，这`RichTextBox`将增长：

```
<Window x:Class="stackoverflow___rich_text_box___accepts_return.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="MainWindow" Height="350" Width="525">
    <StackPanel>
        <RichTextBox/>
    </StackPanel>
</Window> 
```

你必须这样做：

```
<RichTextBox AcceptsReturn="False"/> 
```

让它*不*增长。

# android - Android SQLiteDatabase 返回空（空白）行

> ID：10113470
> 
> 赞同：0
> 
> 时间：2012-04-11T20:30:51.330
> 
> 标签：android

一直在用我正在尝试构建的应用程序拉扯我的头发。我尝试了很多不同的东西、书籍、方法、youtube 教程，我已经数不清了！我正在构建一个显示飞机图片的简单应用程序，然后用户单击以将其添加到学习列表中（通过使用 toast 而不是 listview 进行验证），然后单击另一个按钮以查看此列表。

我有应用程序返回正确的行数，但它们都是空白的！从我读过的内容来看，这意味着这些行是空的，但我一生都无法弄清楚出了什么问题！我将永远欠任何可以帮助的人的债:)

谢谢！这是代码...

（数据库助手/适配器）

```
 package com.atcapp;

import android.content.ContentValues;
import android.content.Context;
import android.database.Cursor;
import android.database.SQLException;
import android.database.sqlite.SQLiteDatabase;
import android.database.sqlite.SQLiteOpenHelper;
import android.util.Log;

public class DatabaseAdapter {

public static final String KEY_ROWID = "_id";
public static final String KEY_NAME = "name";
private static final String TAG = "DatabaseAdapter";

private static final String DATABASE_NAME = "LearntListdb";
private static final String DATABASE_TABLE = "AircraftTable";

private static final int DATABASE_VERSION = 1;
private static final String DATABASE_CREATE = "create table AircraftTable (_id integer primary key         autoincrement, "
        + "name text not null);";

private final Context context;
private DatabaseHelper DBHelper;
private SQLiteDatabase db;

public DatabaseAdapter(Context ctx) {
    this.context = ctx;
    DBHelper = new DatabaseHelper(context);
}

private static class DatabaseHelper extends SQLiteOpenHelper {

    public DatabaseHelper(Context context) {
        super(context, DATABASE_NAME, null, DATABASE_VERSION);
    }

    @Override
    public void onCreate(SQLiteDatabase db) {
        db.execSQL(DATABASE_CREATE);
    }

    @Override
    public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
        Log.w(TAG, "Upgrading database from version " + oldVersion + " to "
                + newVersion + "which will destroy all old data");
        db.execSQL("DROP TABLE IF EXISTS AircraftNames");
        onCreate(db);
    }
}

// ---opens the database---
public DatabaseAdapter open() throws SQLException {
    db = DBHelper.getWritableDatabase();
    return this;
}

// ---closes the database---
public void close() {
    DBHelper.close();
}

// ---insert an aircraft into the database---
public long insertAircraft(String name) {
    ContentValues initialValues = new ContentValues();
    initialValues.put(KEY_NAME, name);
    return db.insert(DATABASE_TABLE, null, initialValues);
}

// ---retrieves all the list---
public Cursor getAllAircraft() {

    Cursor c = db.query(DATABASE_TABLE, new String[] {"_id", "name"}, null, null, null, null, null);
    return c;
} 
```

}

（列出活动）

```
 package com.atcapp;

import android.app.ListActivity;
import android.database.Cursor;
import android.os.Bundle;
import android.widget.SimpleCursorAdapter;

public class DataView extends ListActivity {

private DatabaseAdapter mDbHelper;

@Override
protected void onCreate(Bundle savedInstanceState) {

    super.onCreate(savedInstanceState);

    setContentView(R.layout.aircraftlist);

    mDbHelper = new DatabaseAdapter(this);

    mDbHelper.open();
    fillData();

}

private void fillData(){
    Cursor c = mDbHelper.getAllAircraft();

    startManagingCursor(c);

    String[] from = new String[] {DatabaseAdapter.KEY_ROWID, DatabaseAdapter.KEY_NAME};
    int[] to = new int[] {android.R.id.list};

    SimpleCursorAdapter myList =
            new SimpleCursorAdapter(this, R.layout.list_row, c, from, to);
    setListAdapter(myList);

} 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T20:36:04.360

您需要在 to 数组中提供 textview id。您需要将数据从游标映射到适配器中的视图。

查看您的 list_row 布局并从那里使用 textview id。

# javascript - Mootools 类以元素为参数绑定

> ID：10113472
> 
> 赞同：0
> 
> 时间：2012-04-11T20:30:57.800
> 
> 标签：javascript, mootools

是否可以通过绑定发送绑定到 mootools 类的事件的目标？

IE：

`checkbox.addEvent('change', this.checkBoxChangeAgain(this));`

哪里`this`==`checkbox`

附言。这不起作用：

`checkbox.addEvent('change', this.checkBoxChangeAgain(checkbox));`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T21:47:11.733

它不起作用的原因是通过这样做，`method(this)`您实际上会立即调用它。`method.bind(checkbox)`将装饰函数并将范围更改为稍后调用时的复选框。

为什么不代理呢？

```
var self = this;
checkbox.addEvent('change', function(e) {
    self.checkBoxChangeAgain(this);
});

new Class({
    checkBoxChangeAgain: function(checkbox) {
        this; // instance
        checkbox; // == org checkbox 
    }
}); 
```

默认情况下，事件处理程序的第一个参数是事件，作用域是触发器元素。

因此：

```
checkbox.addEvent('change', this.checkBoxChangeAgain); 
```

将意味着：

```
new Class({
    checkBoxChangeAgain: function(event) {
        this === event.target; 
    }
}); 
```

这意味着您还可以：

```
checkbox.addEvent('change', this.checkBoxChangeAgain.bind(this)); 
```

这将作为：

```
new Class({
    checkBoxChangeAgain: function(event) {
        this != event.target; // true
        event.target === checkbox; // true
        this; // the class instance
    }
}); 
```

我希望这能给你一些想法。此外，在 SO 上搜索 bindWithEvent - 特别是用事件替换绑定。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-12T07:58:55.707

类似于 Dimitar 的答案的工作原理，但使用 Class.Binds，最简单的方法是使用`.pass()` [http://mootools.net/docs/core/Types/Function#Function:pass](http://mootools.net/docs/core/Types/Function#Function:pass)

`this.checkBoxChangeAgain.pass(checkbox)`

# objective-c - 碰撞检测 Objective-C (cocos2d)

> ID：10113473
> 
> 赞同：0
> 
> 时间：2012-04-11T20:31:03.640
> 
> 标签：objective-c, ios, cocos2d-iphone

我正在使用 cocos2d 在objective-c 中制作一个iphone 应用程序，在下面的代码中我尝试检测碰撞然后运行动画。（box1被触摸移动）

当“[self getChildByTag:d]”和“box1”碰撞并重叠时，我得到“JUMP NOW！” 显示，但我没有得到跳跃本身，但是当 box1 从“[self getChildByTag:d]”移开时，就会发生跳跃。

我知道这可能与多次调用该操作有关，但请向我解释到底发生了什么，并请帮助我解决问题！

```
- (void)update:(ccTime)dt { 
    for (int d = lowestAvailableTag; d <= highestAvailableTag; d++) {
      if ([self getChildByTag:d].position.y < (box1.position.y+45)&&             
          [self getChildByTag:d].position.x > (box1.position.x-45) && 
          [self getChildByTag:d].position.x < (box1.position.x+45) ) {

          NSLog(@"JUMP NOW!");

          if ([self getChildByTag:d].position.x < 150) {
             [[self getChildByTag:d] runAction:
              [CCJumpTo actionWithDuration:1.5 
                        position:ccp(240, 140) height:110 jumps:1]];
          }
      }
   }
} 
```

//albar

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T22:08:58.747

您可以添加一些 BOOL 标志来检测是否发生了跳转。喜欢：

```
- (void) update:(ccTime)dt
{
    if( jumpOccured == false )
    {
        BOOL needToJump = // your jump condition
        if( needToJump == true )
        {
            // your jump code

            jumpOccured = true;
        }
    }
} 
```

顺便说一句，如果你有很多可能的碰撞，你可以使用 box2d 来检测它们

# php - 为多域缓存 1 个文件

> ID：10113474
> 
> 赞同：0
> 
> 时间：2012-04-11T20:31:05.593
> 
> 标签：php, caching, cache-control

首先，我对标题感到抱歉。我找不到更好的了。

我有一个由 PHP 脚本生成的图像文件。此脚本（图像）连接到数据库并将其引荐来源网址保存在表中。因为输出图像没有改变，我认为最好缓存它。

但据我所知，如果我在每个页面上缓存 1 个文件（例如[http://www.example.com/img.png.php](http://www.example.com/img.png.php)），浏览器就会从缓存中读取它。这对我的剧本不利。因为在第一次调用时，它会保存引荐来源网址并由浏览器缓存。并且在下一次调用时，在不同的网站（referrer）上，将使用缓存版本，浏览器不会向服务器发送任何请求，最终referrer url不会保存在数据库中。

我可以对浏览器说，请为每个域缓存 1 个图像副本吗？我是说：

> `http://wwww.abc.com/index.html`发送请求以获取我的图像（脚本）
> 
> 浏览器检查它的缓存，但没有找到它。所以从服务器获取它。和 PHP 脚本保存引荐来源网址。
> 
> 用户转到 ABC.COM 的另一个页面。（例如`http://wwww.abc.com/about.html`：）浏览器检查缓存，找到它。所以不会向服务器发送请求以获取文件内容。并且 PHP 脚本不会运行。
> 
> 另一个站点 ( `http://wwww.efg.com/index.html`) 发送请求以获取我的图像（脚本）浏览器检查缓存，但不会找到它。所以发送一个文件内容的请求。和 PHP 脚本运行..........................

可能吗？（对不起，长文，有很多语法问题）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T20:39:40.630

您可以使用重定向页面（未缓存）将引用者保存到您的数据库，然后重定向到缓存的图像。

这样，您总是会受到打击，但实际图像会被缓存。

* * *

在您的 HTML 中，您可以使用：

```
<img src="/image.php"> 
```

并在`image.php`：

```
<?php
    // save the referrer in here

    header('Location: /image.jpg');
?> 
```

并且`/image.jpg`是您的实际图像（可以缓存）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-11T20:47:23.940

首先，想想用户的体验：你真的需要仅仅为了referrer特性而增加页面加载时间吗？此外，您应该知道，许多浏览器/隐私工具配置首先会抑制或不发送`Referer`标头。

如果您确实确定每次都希望加载资源（JavaScript、样式表、图像...），则可以将[`Cache-Control`HTTP 标头](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.9)与资源一起发送以防止缓存。例如，为了防止使用 Apache 服务时的缓存，请在同一目录中`referer.js`添加以下文件（需要）：`.htaccess`[`mod_header`](http://httpd.apache.org/docs/2.4/mod/mod_headers.html#header)

```
<FilesMatch "^referer\.js$">
Header set Cache-Control no-cache
</FilesMatch> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-11T20:36:26.957

似乎是一个计数器，对吗？

AFAIK 你不能完全按照你的解释去做。

但是您始终可以在服务器端“缓存”图像，因此您无需重绘它：

```
<?
/*
  do some stuff
*/
// send an image: the content-type first
header('Content-type: image/png');
// and the image
readfile('myImage.png'); 
```

# java - Google App Engine：在部署期间扫描 JSP 时旋转

> ID：10113477
> 
> 赞同：0
> 
> 时间：2012-04-11T20:31:23.283
> 
> 标签：java, regex, google-app-engine

使用 1.6.4.1 SDK，当我运行 appcfg.sh 时，我得到“5% 扫描 jsp 文件”，然后它永远旋转（我让它在一夜之间运行），消耗了我的一个 CPU 的 100%。起初，我怀疑它与[编译 JSP 问题](https://stackoverflow.com/questions/9469366/compiling-jsps-is-very-slow-while-uploading-on-google-app-engine)相同，但我什至没有做到这一点。它看起来像是 AbstractGlob 和/或 javax.util.Regex 中的某种错误。该项目[在这里](https://github.com/RobertFischer/ERDM-Sign-Up)，以防您想自己复制它。

其他人有这种经验吗？知道可能是什么原因造成的吗？有什么办法可以绕过它，以便我可以上传我的应用程序？

这是来自 kill -QUIT 的堆栈跟踪：

**1)**

```
Full thread dump Java HotSpot(TM) 64-Bit Server VM (20.6-b01-415 mixed mode):

"Timer-0" daemon prio=5 tid=1029d0000 nid=0x10c304000 in Object.wait() [10c303000]
   java.lang.Thread.State: TIMED_WAITING (on object monitor)
    at java.lang.Object.wait(Native Method)
    - waiting on <7f45077b0> (a java.util.TaskQueue)
    at java.util.TimerThread.mainLoop(Timer.java:509)
    - locked <7f45077b0> (a java.util.TaskQueue)
    at java.util.TimerThread.run(Timer.java:462)

"Poller SunPKCS11-Darwin" daemon prio=1 tid=10b078000 nid=0x10c201000 waiting on condition [10c200000]
   java.lang.Thread.State: TIMED_WAITING (sleeping)
    at java.lang.Thread.sleep(Native Method)
    at sun.security.pkcs11.SunPKCS11$TokenPoller.run(SunPKCS11.java:692)
    at java.lang.Thread.run(Thread.java:680)

"Low Memory Detector" daemon prio=5 tid=10b00b800 nid=0x10bd01000 runnable [00000000]
   java.lang.Thread.State: RUNNABLE

"C2 CompilerThread1" daemon prio=9 tid=10b00a800 nid=0x10ba04000 waiting on condition [00000000]
   java.lang.Thread.State: RUNNABLE

"C2 CompilerThread0" daemon prio=9 tid=10b00a000 nid=0x10b901000 waiting on condition [00000000]
   java.lang.Thread.State: RUNNABLE

"Signal Dispatcher" daemon prio=9 tid=10b009000 nid=0x10a704000 waiting on condition [00000000]
   java.lang.Thread.State: RUNNABLE

"Surrogate Locker Thread (Concurrent GC)" daemon prio=5 tid=10b008000 nid=0x10a601000 waiting on condition [00000000]
   java.lang.Thread.State: RUNNABLE

"Finalizer" daemon prio=8 tid=1028d2000 nid=0x10a0ef000 in Object.wait() [10a0ee000]
   java.lang.Thread.State: WAITING (on object monitor)
    at java.lang.Object.wait(Native Method)
    - waiting on <7f44f0e08> (a java.lang.ref.ReferenceQueue$Lock)
    at java.lang.ref.ReferenceQueue.remove(ReferenceQueue.java:118)
    - locked <7f44f0e08> (a java.lang.ref.ReferenceQueue$Lock)
    at java.lang.ref.ReferenceQueue.remove(ReferenceQueue.java:134)
    at java.lang.ref.Finalizer$FinalizerThread.run(Finalizer.java:159)

"Reference Handler" daemon prio=10 tid=1028d1000 nid=0x109fec000 in Object.wait() [109feb000]
   java.lang.Thread.State: WAITING (on object monitor)
    at java.lang.Object.wait(Native Method)
    - waiting on <7f4507570> (a java.lang.ref.Reference$Lock)
    at java.lang.Object.wait(Object.java:485)
    at java.lang.ref.Reference$ReferenceHandler.run(Reference.java:116)
    - locked <7f4507570> (a java.lang.ref.Reference$Lock)

"main" prio=5 tid=102801000 nid=0x100501000 runnable [1004ff000]
   java.lang.Thread.State: RUNNABLE
    at java.lang.Character.codePointAt(Character.java:2335)
    at java.util.regex.Pattern$CharProperty.match(Pattern.java:3344)
    at java.util.regex.Pattern$Curly.match0(Pattern.java:3770)
    at java.util.regex.Pattern$Curly.match(Pattern.java:3744)
    at java.util.regex.Pattern$Curly.match0(Pattern.java:3782)
    at java.util.regex.Pattern$Curly.match(Pattern.java:3744)
    at java.util.regex.Pattern$Curly.match0(Pattern.java:3782)
    at java.util.regex.Pattern$Curly.match(Pattern.java:3744)
    at java.util.regex.Pattern$Curly.match0(Pattern.java:3782)
    at java.util.regex.Pattern$Curly.match(Pattern.java:3744)
    at java.util.regex.Pattern$Curly.match0(Pattern.java:3782)
    at java.util.regex.Pattern$Curly.match(Pattern.java:3744)
    at java.util.regex.Pattern$Slice.match(Pattern.java:3482)
    at java.util.regex.Matcher.match(Matcher.java:1127)
    at java.util.regex.Matcher.matches(Matcher.java:502)
    at com.google.apphosting.utils.glob.AbstractGlob.matches(AbstractGlob.java:48)
    at com.google.apphosting.utils.glob.AbstractGlob.matchesAll(AbstractGlob.java:56)
    at com.google.apphosting.utils.glob.AbstractGlob.matchesAll(AbstractGlob.java:52)
    at com.google.apphosting.utils.glob.GlobIntersector.reorderAndBlendChildren(GlobIntersector.java:95)
    at com.google.apphosting.utils.glob.GlobIntersector.getIntersection(GlobIntersector.java:68)
    at com.google.appengine.tools.admin.AppYamlTranslator$AbstractHandlerGenerator.getGlobPatterns(AppYamlTranslator.java:416)
    at com.google.appengine.tools.admin.AppYamlTranslator$AbstractHandlerGenerator.size(AppYamlTranslator.java:390)
    at com.google.appengine.tools.admin.AppYamlTranslator.translateWebXml(AppYamlTranslator.java:191)
    at com.google.appengine.tools.admin.AppYamlTranslator.getYaml(AppYamlTranslator.java:83)
    at com.google.appengine.tools.admin.Application.generateAppYaml(Application.java:897)
    at com.google.appengine.tools.admin.Application.createStagingDirectory(Application.java:473)
    at com.google.appengine.tools.admin.AppAdminImpl.doUpdate(AppAdminImpl.java:327)
    at com.google.appengine.tools.admin.AppAdminImpl.update(AppAdminImpl.java:52)
    at com.google.appengine.tools.admin.AppCfg$UpdateAction.execute(AppCfg.java:641)
    at com.google.appengine.tools.admin.AppCfg.<init>(AppCfg.java:172)
    at com.google.appengine.tools.admin.AppCfg.<init>(AppCfg.java:69)
    at com.google.appengine.tools.admin.AppCfg.main(AppCfg.java:65)

"VM Thread" prio=9 tid=1028cc800 nid=0x109ee9000 runnable 

"Gang worker#0 (Parallel GC Threads)" prio=9 tid=102802800 nid=0x102401000 runnable 

"Gang worker#1 (Parallel GC Threads)" prio=9 tid=102803000 nid=0x102504000 runnable 

"Gang worker#2 (Parallel GC Threads)" prio=9 tid=102803800 nid=0x102607000 runnable 

"Gang worker#3 (Parallel GC Threads)" prio=9 tid=102804000 nid=0x10270a000 runnable 

"Concurrent Mark-Sweep GC Thread" prio=9 tid=10287f800 nid=0x109bf0000 runnable 
"VM Periodic Task Thread" prio=10 tid=10b01d000 nid=0x10be04000 waiting on condition 

"Exception Catcher Thread" prio=10 tid=102801800 nid=0x1017f9000 runnable 
JNI global references: 1671

Heap
 par new generation   total 19136K, used 13388K [7f3000000, 7f44c0000, 7f44c0000)
  eden space 17024K,  77% used [7f3000000, 7f3cf67e8, 7f40a0000)
  from space 2112K,   5% used [7f42b0000, 7f42cca00, 7f44c0000)
  to   space 2112K,   0% used [7f40a0000, 7f40a0000, 7f42b0000)
 concurrent mark-sweep generation total 63872K, used 4234K [7f44c0000, 7f8320000, 7fae00000)
 concurrent-mark-sweep perm gen total 21248K, used 14477K [7fae00000, 7fc2c0000, 800000000) 
```

**2)**

```
^\2012-04-12 19:03:02
Full thread dump Java HotSpot(TM) 64-Bit Server VM (20.6-b01-415 mixed mode):

"Timer-0" daemon prio=5 tid=1029d0000 nid=0x10c304000 in Object.wait() [10c303000]
   java.lang.Thread.State: WAITING (on object monitor)
    at java.lang.Object.wait(Native Method)
    - waiting on <7f45077b0> (a java.util.TaskQueue)
    at java.lang.Object.wait(Object.java:485)
    at java.util.TimerThread.mainLoop(Timer.java:483)
    - locked <7f45077b0> (a java.util.TaskQueue)
    at java.util.TimerThread.run(Timer.java:462)

"Poller SunPKCS11-Darwin" daemon prio=1 tid=10b078000 nid=0x10c201000 waiting on condition [10c200000]
   java.lang.Thread.State: TIMED_WAITING (sleeping)
    at java.lang.Thread.sleep(Native Method)
    at sun.security.pkcs11.SunPKCS11$TokenPoller.run(SunPKCS11.java:692)
    at java.lang.Thread.run(Thread.java:680)

"Low Memory Detector" daemon prio=5 tid=10b00b800 nid=0x10bd01000 runnable [00000000]
   java.lang.Thread.State: RUNNABLE

"C2 CompilerThread1" daemon prio=9 tid=10b00a800 nid=0x10ba04000 waiting on condition [00000000]
   java.lang.Thread.State: RUNNABLE

"C2 CompilerThread0" daemon prio=9 tid=10b00a000 nid=0x10b901000 waiting on condition [00000000]
   java.lang.Thread.State: RUNNABLE

"Signal Dispatcher" daemon prio=9 tid=10b009000 nid=0x10a704000 waiting on condition [00000000]
   java.lang.Thread.State: RUNNABLE

"Surrogate Locker Thread (Concurrent GC)" daemon prio=5 tid=10b008000 nid=0x10a601000 waiting on condition [00000000]
   java.lang.Thread.State: RUNNABLE

"Finalizer" daemon prio=8 tid=1028d2000 nid=0x10a0ef000 in Object.wait() [10a0ee000]
   java.lang.Thread.State: WAITING (on object monitor)
    at java.lang.Object.wait(Native Method)
    - waiting on <7f44f0e08> (a java.lang.ref.ReferenceQueue$Lock)
    at java.lang.ref.ReferenceQueue.remove(ReferenceQueue.java:118)
    - locked <7f44f0e08> (a java.lang.ref.ReferenceQueue$Lock)
    at java.lang.ref.ReferenceQueue.remove(ReferenceQueue.java:134)
    at java.lang.ref.Finalizer$FinalizerThread.run(Finalizer.java:159)

"Reference Handler" daemon prio=10 tid=1028d1000 nid=0x109fec000 in Object.wait() [109feb000]
   java.lang.Thread.State: WAITING (on object monitor)
    at java.lang.Object.wait(Native Method)
    - waiting on <7f4507570> (a java.lang.ref.Reference$Lock)
    at java.lang.Object.wait(Object.java:485)
    at java.lang.ref.Reference$ReferenceHandler.run(Reference.java:116)
    - locked <7f4507570> (a java.lang.ref.Reference$Lock)

"main" prio=5 tid=102801000 nid=0x100501000 runnable [1004ff000]
   java.lang.Thread.State: RUNNABLE
    at java.util.regex.Pattern$BmpCharProperty.match(Pattern.java:3366)
    at java.util.regex.Pattern$Curly.match0(Pattern.java:3782)
    at java.util.regex.Pattern$Curly.match(Pattern.java:3744)
    at java.util.regex.Pattern$Curly.match0(Pattern.java:3782)
    at java.util.regex.Pattern$Curly.match(Pattern.java:3744)
    at java.util.regex.Pattern$Curly.match0(Pattern.java:3782)
    at java.util.regex.Pattern$Curly.match(Pattern.java:3744)
    at java.util.regex.Pattern$Curly.match0(Pattern.java:3782)
    at java.util.regex.Pattern$Curly.match(Pattern.java:3744)
    at java.util.regex.Pattern$Curly.match0(Pattern.java:3782)
    at java.util.regex.Pattern$Curly.match(Pattern.java:3744)
    at java.util.regex.Pattern$Curly.match0(Pattern.java:3782)
    at java.util.regex.Pattern$Curly.match(Pattern.java:3744)
    at java.util.regex.Pattern$Slice.match(Pattern.java:3482)
    at java.util.regex.Matcher.match(Matcher.java:1127)
    at java.util.regex.Matcher.matches(Matcher.java:502)
    at com.google.apphosting.utils.glob.AbstractGlob.matches(AbstractGlob.java:48)
    at com.google.apphosting.utils.glob.AbstractGlob.matchesAll(AbstractGlob.java:56)
    at com.google.apphosting.utils.glob.AbstractGlob.matchesAll(AbstractGlob.java:52)
    at com.google.apphosting.utils.glob.GlobIntersector.reorderAndBlendChildren(GlobIntersector.java:95)
    at com.google.apphosting.utils.glob.GlobIntersector.getIntersection(GlobIntersector.java:68)
    at com.google.appengine.tools.admin.AppYamlTranslator$AbstractHandlerGenerator.getGlobPatterns(AppYamlTranslator.java:416)
    at com.google.appengine.tools.admin.AppYamlTranslator$AbstractHandlerGenerator.size(AppYamlTranslator.java:390)
    at com.google.appengine.tools.admin.AppYamlTranslator.translateWebXml(AppYamlTranslator.java:191)
    at com.google.appengine.tools.admin.AppYamlTranslator.getYaml(AppYamlTranslator.java:83)
    at com.google.appengine.tools.admin.Application.generateAppYaml(Application.java:897)
    at com.google.appengine.tools.admin.Application.createStagingDirectory(Application.java:473)
    at com.google.appengine.tools.admin.AppAdminImpl.doUpdate(AppAdminImpl.java:327)
    at com.google.appengine.tools.admin.AppAdminImpl.update(AppAdminImpl.java:52)
    at com.google.appengine.tools.admin.AppCfg$UpdateAction.execute(AppCfg.java:641)
    at com.google.appengine.tools.admin.AppCfg.<init>(AppCfg.java:172)
    at com.google.appengine.tools.admin.AppCfg.<init>(AppCfg.java:69)
    at com.google.appengine.tools.admin.AppCfg.main(AppCfg.java:65)

"VM Thread" prio=9 tid=1028cc800 nid=0x109ee9000 runnable 

"Gang worker#0 (Parallel GC Threads)" prio=9 tid=102802800 nid=0x102401000 runnable 

"Gang worker#1 (Parallel GC Threads)" prio=9 tid=102803000 nid=0x102504000 runnable 

"Gang worker#2 (Parallel GC Threads)" prio=9 tid=102803800 nid=0x102607000 runnable 

"Gang worker#3 (Parallel GC Threads)" prio=9 tid=102804000 nid=0x10270a000 runnable 

"Concurrent Mark-Sweep GC Thread" prio=9 tid=10287f800 nid=0x109bf0000 runnable 
"VM Periodic Task Thread" prio=10 tid=10b01d000 nid=0x10be04000 waiting on condition 

"Exception Catcher Thread" prio=10 tid=102801800 nid=0x1017f9000 runnable 
JNI global references: 1709

Heap
 par new generation   total 19136K, used 9948K [7f3000000, 7f44c0000, 7f44c0000)
  eden space 17024K,  58% used [7f3000000, 7f39b6118, 7f40a0000)
  from space 2112K,   0% used [7f40a0000, 7f40a1000, 7f42b0000)
  to   space 2112K,   0% used [7f42b0000, 7f42b0000, 7f44c0000)
 concurrent mark-sweep generation total 63872K, used 4726K [7f44c0000, 7f8320000, 7fae00000)
 concurrent-mark-sweep perm gen total 21248K, used 14489K [7fae00000, 7fc2c0000, 800000000) 
```

**3)**

```
^\2012-04-12 19:03:50
Full thread dump Java HotSpot(TM) 64-Bit Server VM (20.6-b01-415 mixed mode):

"Timer-0" daemon prio=5 tid=1029d0000 nid=0x10c304000 in Object.wait() [10c303000]
   java.lang.Thread.State: WAITING (on object monitor)
    at java.lang.Object.wait(Native Method)
    - waiting on <7f45077b0> (a java.util.TaskQueue)
    at java.lang.Object.wait(Object.java:485)
    at java.util.TimerThread.mainLoop(Timer.java:483)
    - locked <7f45077b0> (a java.util.TaskQueue)
    at java.util.TimerThread.run(Timer.java:462)

"Poller SunPKCS11-Darwin" daemon prio=1 tid=10b078000 nid=0x10c201000 waiting on condition [10c200000]
   java.lang.Thread.State: TIMED_WAITING (sleeping)
    at java.lang.Thread.sleep(Native Method)
    at sun.security.pkcs11.SunPKCS11$TokenPoller.run(SunPKCS11.java:692)
    at java.lang.Thread.run(Thread.java:680)

"Low Memory Detector" daemon prio=5 tid=10b00b800 nid=0x10bd01000 runnable [00000000]
   java.lang.Thread.State: RUNNABLE

"C2 CompilerThread1" daemon prio=9 tid=10b00a800 nid=0x10ba04000 waiting on condition [00000000]
   java.lang.Thread.State: RUNNABLE

"C2 CompilerThread0" daemon prio=9 tid=10b00a000 nid=0x10b901000 waiting on condition [00000000]
   java.lang.Thread.State: RUNNABLE

"Signal Dispatcher" daemon prio=9 tid=10b009000 nid=0x10a704000 waiting on condition [00000000]
   java.lang.Thread.State: RUNNABLE

"Surrogate Locker Thread (Concurrent GC)" daemon prio=5 tid=10b008000 nid=0x10a601000 waiting on condition [00000000]
   java.lang.Thread.State: RUNNABLE

"Finalizer" daemon prio=8 tid=1028d2000 nid=0x10a0ef000 in Object.wait() [10a0ee000]
   java.lang.Thread.State: WAITING (on object monitor)
    at java.lang.Object.wait(Native Method)
    - waiting on <7f44f0e08> (a java.lang.ref.ReferenceQueue$Lock)
    at java.lang.ref.ReferenceQueue.remove(ReferenceQueue.java:118)
    - locked <7f44f0e08> (a java.lang.ref.ReferenceQueue$Lock)
    at java.lang.ref.ReferenceQueue.remove(ReferenceQueue.java:134)
    at java.lang.ref.Finalizer$FinalizerThread.run(Finalizer.java:159)

"Reference Handler" daemon prio=10 tid=1028d1000 nid=0x109fec000 in Object.wait() [109feb000]
   java.lang.Thread.State: WAITING (on object monitor)
    at java.lang.Object.wait(Native Method)
    - waiting on <7f4507570> (a java.lang.ref.Reference$Lock)
    at java.lang.Object.wait(Object.java:485)
    at java.lang.ref.Reference$ReferenceHandler.run(Reference.java:116)
    - locked <7f4507570> (a java.lang.ref.Reference$Lock)

"main" prio=5 tid=102801000 nid=0x100501000 runnable [1004ff000]
   java.lang.Thread.State: RUNNABLE
    at java.util.regex.Pattern$Curly.match0(Pattern.java:3789)
    at java.util.regex.Pattern$Curly.match(Pattern.java:3744)
    at java.util.regex.Pattern$Curly.match0(Pattern.java:3782)
    at java.util.regex.Pattern$Curly.match(Pattern.java:3744)
    at java.util.regex.Pattern$Curly.match0(Pattern.java:3782)
    at java.util.regex.Pattern$Curly.match(Pattern.java:3744)
    at java.util.regex.Pattern$Curly.match0(Pattern.java:3782)
    at java.util.regex.Pattern$Curly.match(Pattern.java:3744)
    at java.util.regex.Pattern$Curly.match0(Pattern.java:3782)
    at java.util.regex.Pattern$Curly.match(Pattern.java:3744)
    at java.util.regex.Pattern$Curly.match0(Pattern.java:3782)
    at java.util.regex.Pattern$Curly.match(Pattern.java:3744)
    at java.util.regex.Pattern$Slice.match(Pattern.java:3482)
    at java.util.regex.Matcher.match(Matcher.java:1127)
    at java.util.regex.Matcher.matches(Matcher.java:502)
    at com.google.apphosting.utils.glob.AbstractGlob.matches(AbstractGlob.java:48)
    at com.google.apphosting.utils.glob.AbstractGlob.matchesAll(AbstractGlob.java:56)
    at com.google.apphosting.utils.glob.AbstractGlob.matchesAll(AbstractGlob.java:52)
    at com.google.apphosting.utils.glob.GlobIntersector.reorderAndBlendChildren(GlobIntersector.java:95)
    at com.google.apphosting.utils.glob.GlobIntersector.getIntersection(GlobIntersector.java:68)
    at com.google.appengine.tools.admin.AppYamlTranslator$AbstractHandlerGenerator.getGlobPatterns(AppYamlTranslator.java:416)
    at com.google.appengine.tools.admin.AppYamlTranslator$AbstractHandlerGenerator.size(AppYamlTranslator.java:390)
    at com.google.appengine.tools.admin.AppYamlTranslator.translateWebXml(AppYamlTranslator.java:191)
    at com.google.appengine.tools.admin.AppYamlTranslator.getYaml(AppYamlTranslator.java:83)
    at com.google.appengine.tools.admin.Application.generateAppYaml(Application.java:897)
    at com.google.appengine.tools.admin.Application.createStagingDirectory(Application.java:473)
    at com.google.appengine.tools.admin.AppAdminImpl.doUpdate(AppAdminImpl.java:327)
    at com.google.appengine.tools.admin.AppAdminImpl.update(AppAdminImpl.java:52)
    at com.google.appengine.tools.admin.AppCfg$UpdateAction.execute(AppCfg.java:641)
    at com.google.appengine.tools.admin.AppCfg.<init>(AppCfg.java:172)
    at com.google.appengine.tools.admin.AppCfg.<init>(AppCfg.java:69)
    at com.google.appengine.tools.admin.AppCfg.main(AppCfg.java:65)

"VM Thread" prio=9 tid=1028cc800 nid=0x109ee9000 runnable 

"Gang worker#0 (Parallel GC Threads)" prio=9 tid=102802800 nid=0x102401000 runnable 

"Gang worker#1 (Parallel GC Threads)" prio=9 tid=102803000 nid=0x102504000 runnable 

"Gang worker#2 (Parallel GC Threads)" prio=9 tid=102803800 nid=0x102607000 runnable 

"Gang worker#3 (Parallel GC Threads)" prio=9 tid=102804000 nid=0x10270a000 runnable 

"Concurrent Mark-Sweep GC Thread" prio=9 tid=10287f800 nid=0x109bf0000 runnable 
"VM Periodic Task Thread" prio=10 tid=10b01d000 nid=0x10be04000 waiting on condition 

"Exception Catcher Thread" prio=10 tid=102801800 nid=0x1017f9000 runnable 
JNI global references: 1709

Heap
 par new generation   total 19136K, used 9956K [7f3000000, 7f44c0000, 7f44c0000)
  eden space 17024K,  58% used [7f3000000, 7f39b81b8, 7f40a0000)
  from space 2112K,   0% used [7f40a0000, 7f40a1000, 7f42b0000)
  to   space 2112K,   0% used [7f42b0000, 7f42b0000, 7f44c0000)
 concurrent mark-sweep generation total 63872K, used 4726K [7f44c0000, 7f8320000, 7fae00000)
 concurrent-mark-sweep perm gen total 21248K, used 14489K [7fae00000, 7fc2c0000, 800000000) 
```

***[编辑]***

当我将 WebXml 映射更改为`security-constraint`from `/**`to`/*`时，问题就解决了。我的理解是这个新的安全约束设置会匹配`/foo`但不匹配`/foo/bar`：对吗？如果是这样，那么我可能有办法绕过这个错误。但它看起来像一个非常讨厌的错误`AbstractGlob`，无论人们在哪里都可以找到该代码......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T04:24:11.580

Java GAE SDK 有一个版本 1.6.4.1... 看起来它解决了其他问题，但它可能值得一试。 [https://groups.google.com/d/msg/google-appengine/V4KHnq2f03Y/X24dzXVJyMQJ](https://groups.google.com/d/msg/google-appengine/V4KHnq2f03Y/X24dzXVJyMQJ)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-11-19T00:36:41.837

当我将安全约束的 WebXml 映射从 /** 更改为 /* 时，问题就解决了。我的理解是，这个新的安全约束设置将匹配 /foo 但不匹配 /foo/bar：对吗？如果是这样，那么我可能有办法绕过这个错误。但它看起来像 AbstractGlob 中的一个非常讨厌的错误，任何人都可以在任何地方找到该代码......

# c# - 扩展枢轴功能

> ID：10113484
> 
> 赞同：0
> 
> 时间：2012-04-11T20:31:48.990
> 
> 标签：c#, linq, pivot

我已经成功使用了这个示例代码。

```
public static Dictionary<TKey1, Dictionary<TKey2, TValue>> PivotLinq<TSource, TKey1,     TKey2, TValue>(
this IEnumerable<TSource> source, Func<TSource, TKey1> key1Selector, Func<TSource,    TKey2> key2Selector,
Func<IEnumerable<TSource>, TValue> aggregate)
{
return source.GroupBy(key1Selector).Select(
x => new
        {
            X = x.Key,
            Y = x.GroupBy(key2Selector).Select(
            z => new
            {
                Z = z.Key,
                V = aggregate(z)
            }
            ).ToDictionary(e => e.Z, o => o.V)
        }
        ).ToDictionary(e => e.X, o => o.Y);
    } 
```

现在我将其扩展如下：

```
public static Dictionary<TKey1,     Dictionary<TKey2,Dictionary<TKey3,Dictionary<TKey4,TValue>>>> PivotLinq<TSource, TKey1,    TKey2,TKey3,TKey4, TValue>(
this IEnumerable<TSource> source, Func<TSource, TKey1> key1Selector, Func<TSource, TKey2> key2Selector, Func<TSource, TKey3> key3Selector, Func<TSource, TKey4> key4Selector,
   Func<IEnumerable<TSource>, TValue> aggregate)
    {
        return source.GroupBy(key1Selector).Select(
        x => new
        {
            X = x.Key,
            Y = x.GroupBy(key2Selector).Select(
            z => new
            {
                Z = z.Key,
                V =z.GroupBy(key3Selector).Select(  // aggregate(z)
                 w => new 
                 {
                     W=w.Key ,
                     B = w.GroupBy(key4Selector).Select(
                      c=> new 
                      {
                          C=c.Key ,
                          D=aggregate(c)
                      }).ToDictionary(e=>e.C, o=>o.D)
                 }
                      ).ToDictionary(e=>e.W, o=>o.B)
            }
                 ).ToDictionary(e=>e.Z , o=>o.V  )
            }).ToDictionary(e=>e.X,o=>o.Y);

        } 
```

但是，聚合函数不会产生所需的结果。有人可以让我知道我要去哪里错了吗？

# java - Java，休眠 getList 不起作用

> ID：10113489
> 
> 赞同：2
> 
> 时间：2012-04-11T20:32:28.537
> 
> 标签：java, hibernate, list

我正在尝试使用hibernate编写一个网站来访问数据库。保存我可以正常工作，但是当我尝试在执行 session.createQuery 调用时调用我的 getList 方法时，代码只是进入 finally 方法而不会引发异常，让我有点困惑！

代码如下：

```
public List<Category> getCategories() {
    //insertCategory();
    System.out.println("in get categories");
    List<Category> result = null;
    Session session = HibernateUtil.getSessionfactory().openSession();
    Transaction transaction = null;
    try {
        transaction = session.beginTransaction();
        Query cats = session.createQuery("from category where is_parent = 1");
        result = cats.list();
        transaction.commit();
        for (java.util.Iterator<Category> it = result.iterator();it.hasNext();){
            Category myCategory = it.next();
            System.out.println(myCategory);
        }
        calculateBlueprintSize(result.size());
    } catch (HibernateException e) {
        // TODO: handle exception
        transaction.rollback();
        e.printStackTrace();
    } catch (Exception ee) {
        ee.printStackTrace();
    } finally {
        session.close();
    }
    return result;
} 
```

我的插入工作正常（现在硬编码只是为了证明我可以连接到数据库）

```
public void insertCategory() {
    Category newCat = new Category();
    newCat.setActive(new Integer(1));
    newCat.setCategoryDescription("my test category");
    newCat.setCategoryName("my cat name");
    newCat.setLastUpdatedDate(new Timestamp(new Date().getTime()));
    newCat.setParent(new Integer(1));
    newCat.setSequence(new Integer(1));
    Session session = HibernateUtil.getSessionfactory().getCurrentSession();
    try {
        session.beginTransaction();

        // user.setUserId(new Long(2));
        session.save(newCat);
        session.getTransaction().commit();
    } finally {
        session.close();
    }

} 
```

这是基于访问 MySQL 数据库。

任何帮助将不胜感激，我找不到任何可以帮助我的东西，而且我是 Hibernate 的新手，所以开始考虑使用带有 ehcache 的本机 sql 切换回 DAO 模式可能是最好的选择......

谢谢

马特

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T21:01:39.307

我相信您`RuntimeException`从`createQuery`电话中得到了一个，因为您将 SQL 名称与 HQL 名称混合在一起。我假设您的表已命名`category`，并且该 `is_parent`列是该表中的一个字段。如果要使用 HQL 查询，则需要使用`Category`实体上的属性名称，即`parent`，而不是`is_parent`。

# javascript - 在javascript中加载一个精灵

> ID：10113491
> 
> 赞同：-1
> 
> 时间：2012-04-11T20:32:36.043
> 
> 标签：javascript, html, loading, sprite

我正在尝试用我计算机上的 Javascript 加载图像，以便我可以为游戏制作精灵。我还没有这个 html 在网络上，并且图像本地保存在我的计算机上。这是否可以作为我正在学习的书从文件夹中加载图像，但我无法加载图像。这是我的一些代码。谢谢，

```
$(document).ready(function(){

    var params ={
        images: 'C:\EclipseWorkspaces\WebTest\images\Luigi.png',
        imagesWidth: 256,
        width: 64,
        height: 64,
        $drawTarget: $('#draw-target')
    };
    var sprite1 = DHTMLSprite(params),
        sprite2 = DHTMLSprite(params);
        sprite2.changeImage(5);

        sprite1.draw(64,64);
        sprite2.draw(352, 192);
        }); 

</script>
</head>
<body>
    <div id="draw-target">
    </div>
</body> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T20:37:59.020

您无法使用 Javascript 访问高清。如果可以的话，这将违反安全规定。您可以通过三种方式加载图像。

1 您可以使用来自网络的图像

2 使用服务器端程序加载图像，然后将其传递给客户端 javascript。

3 您可以使用亲属路径 (../images/myImg.png) 来执行此操作 请查看维基百科中的这篇文章：

[http://en.wikipedia.org/wiki/JavaScript#Security](http://en.wikipedia.org/wiki/JavaScript#Security)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-11T20:46:10.537

使图像路径相对于您存储 html 文件的位置。例如，将您的 index.html 放入`c:\temp`并创建一个文件夹`c:\temp\img`并将所有图像放入其中。然后您可以将图像引用为`img/imagename.jpg`

# c# - DateTime 错误从 0 小时减去

> ID：10113496
> 
> 赞同：0
> 
> 时间：2012-04-11T20:33:03.717
> 
> 标签：c#, datetime, time, subtraction

使用 C# DateTime，我想减去过去 0（或午夜）的时间。但是，这样做时出现错误。我正在尝试创建一个时间线，您可以在其中放大和缩小并滚动浏览时间。我收到以下错误：“添加或减去的值导致无法表示的 DateTime。”

我猜 DateTime 不知道如何从 0 回绕到 23？我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T20:36:31.453

如果`TimeSpan`从 a中减去 a `DateTime`，它将在午夜过后“环绕”：

```
> var d1 = DateTime.Parse("4/11/2012 12:30:00 AM");
> var d2 = d1.Subtract(new TimeSpan(1, 15, 0));
> 
> d2
[4/10/2012 11:15:00 PM] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-11T20:37:40.853

我的猜测是您使用的是从 开始的日期`DateTime.MinValue`。如果您减去 time 使其在 before 之前`DateTime.MinValue`，您将得到该异常。

```
// This is equal to DateTime.MinValue - maybe you're doing this?
DateTime date = new DateTime();
// Bang
date = date.AddHours(-1); 
```

如果您*真的*想要“只是一个时间”的表示，请考虑使用[Noda Time ，这是我的](http://noda-time.googlecode.com)[Joda Time](http://joda-time.sf.net)伪端口，具有比 just 更丰富的类型系统`DateTime`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-06-15T20:17:44.347

从设置为午夜的 TimeSpan 中减去 5 分钟，结果为 -00:05。这导致时间跨度为 23:55 而不是 -00:05。

```
DateTime.Today.Subtract(TimeSpan.FromMinutes(5)).TimeOfDay; 
```

# javascript - DOM 子标记名

> ID：10113497
> 
> 赞同：0
> 
> 时间：2012-04-11T20:33:09.790
> 
> 标签：javascript, dom, tagname

我正在尝试使用 javascript 来遍历成人节点的子节点并根据需要更改属性。代码挂在 elemtree.tagName 上，说明该对象没有该属性。我已经阅读了 DOM 属性，并且 tagName 被声明为 DOM 的属性。为什么会不被认可？

下面的代码：

```
 elemtree = elem.firstChild;
    while (elemtree != null) {
        if (elemtree.tagName.toLowerCase() == "img") {
            elemtree.src = img;
        }
        else {
            elemtree.display = display;
        }
        elemtree = elemtree.nextSibling;
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T20:36:58.357

`elemtree.nextSibling`包括文本节点和注释节点，它们具有[`nodeName`](https://developer.mozilla.org/en/DOM/Node.nodeName)但没有[`tagName`](https://developer.mozilla.org/en/DOM/Element.tagName)属性。

解决方案：

1.  使用[`elem.firstElementChild`](https://developer.mozilla.org/en/DOM/Element.firstElementChild)and[`elemtree.nextElementSibling`](https://developer.mozilla.org/En/DOM/Element.nextElementSibling)代替（可能的浏览器兼容性问题）。
2.  使用`nodeName`而不是`tagName`.
3.  检查是否存在`tagName`先前使用它：

    ```
    if (elemtree.tagName && elemtree.tagName.toLowerCase() == "img") { 
    ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T20:43:25.590

我同意 Rob W 的观点，最好的解决方案是避免没有属性的节点开始，但是您也可以考虑更改：

`if (elemtree.tagName.toLowerCase() == "img")`

至

`if (elemtree.tagName && elemtree.tagName.toLowerCase() == "img")`

这样，如果该属性不存在，它就不会抛出错误。

# jsf - 警告：FacesMessage(s) 已入队，但可能尚未显示

> ID：10113498
> 
> 赞同：7
> 
> 时间：2012-04-11T20:33:12.160
> 
> 标签：jsf, warnings, messages

在我的应用程序中，人脸消息不会在 UI 上呈现，不确定究竟是什么导致了这个问题。在服务器日志中，我看到了这个：

> 警告：FacesMessage(s) 已入队，但可能尚未显示。

出现这种情况的原因是什么？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-11T21:07:28.973

确保您已在页面中放置`<h:message for="...">`或`<h:messages>`标记，另请参阅[JSF 2 消息和消息示例](http://www.mkyong.com/jsf2/jsf-2-message-and-messages-example/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-09-07T20:34:38.043

未显示错误消息的另一个原因可能是错误发生在 JSF 生命周期的 RENDER_RESPONSE 阶段。在这种情况下，可能会记录一条警告，上面写着“FacesMessage(s) 已入队，但可能未显示”。

这种情况的原因是，在渲染响应阶段，组件树被遍历，每个组件被依次渲染。当消息组件完成渲染后发生错误时，无法向其添加另一条消息。

在这种情况下，一个可能的解决方案是将消息组件放在组件树的末尾。另请参阅[此博客](https://itaffinity.wordpress.com/2013/06/08/jsf-displaying-facesmessages-during-render-response-phase/)。

# web-services - 具有不同数据类型的Web服务？

> ID：10113499
> 
> 赞同：0
> 
> 时间：2012-04-11T20:33:15.167
> 
> 标签：web-services, jakarta-ee

我正在编写我的第一个 Web 服务之一，就目前而言它还不错，但是当我尝试创建 sperate 类时：

```
public class Workers {

private String name;
private String surname;
private boolean type;

public String getName() {
    return name;
}

public void setName(String name) {
    this.name = name;
}

public String getSurname() {
    return surname;
}

public void setSurname(String surname) {
    this.surname = surname;
}

public boolean isType() {
    return type;
}

public void setType(boolean type) {
    this.type = type;
}

public Workers(String name, String surname, boolean type) {
    this.name = name;
    this.surname = surname;
    this.type = type;
}

} 
```

而不是像这样在网络服务中使用它：

```
@WebMethod(operationName = "SelectWorker")
public Pracownicy SelectWorker(@WebParam(name = "username") String username,       @WebParam(name = "password") String password) {

   ResultSet rs = null;
   String name = null;
   String surname = null;
   boolean type = false;

    PreparedStatement st = null;
    try {
        Class.forName("com.mysql.jdbc.Driver");
        Connection con = DriverManager.getConnection("db_address", "login", "password");
        System.out.println("connection status: " +con);
        st = con.prepareStatement("select name, surname from clients where login = ? and  passwd= ?");
        st.setString(1, username);
        st.setString(2, password);
        rs = st.executeQuery();

        if (rs.next()) {
           name = rs.getString(2);
           surname=rs.getString(3);
           type = rs.getBoolean(5);
           Workers pr = new Workers(name, surname, type);
           return pr;
        }
    } catch (Exception e) {
        System.out.println("error: " + e.toString());
    }

    return null;
} 
```

方法的主体可以为空或填充代码，没关系 - 我得到同样的错误：

```
Error occurred during deployment: Exception while loading the app    
:java.lang.IllegalStateException: ContainerBase.addChild: start:
org.apache.catalina.LifecycleException: java.lang.RuntimeException: Servlet web 
service endpoint '' failure. 
```

是否只允许 int、string、boolean 等作为返回类型？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T07:47:04.847

你的帖子中没有提供足够的信息......你是如何创建网络服务的（我猜是@WebService），你告诉它是否方法SelectWorker（顺便说一句应该适当地称为selectWorker）并不重要命名约定）是否为空，但是如果正文为空，您的源代码甚至无法编译...

我可以告诉你：int、String、boolean 不是唯一允许的返回类型。当然，您也可以从 Web 服务返回您的类的实例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-21T11:36:18.807

对于未来的谷歌人：

我遇到了同样的错误，并检查了服务器日志并得到了错误：

> 两个类具有相同的 XML 类型名称

我发现这很奇怪，但添加了这个：

```
@XmlType(namespace="someName") 
```

我试图返回我的班级（我选择了相同的班级名称）解决了这个问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-12-04T05:25:54.490

我遇到了这个问题，glassfish 在 Linux 环境中。检查您的 $JAVA_HOME 它应该设置为 jdk

导出 JAVA_HOME=/usr/java/jdk1.7.0_55

/opt/glassfish4/glassfish/bin # echo $JAVA_HOME

/usr/java/jdk1.7.0_55

然后问题就解决了。。

# sql - 返回包含错误数据的所有列 SQL Server 2005 查询

> ID：10113505
> 
> 赞同：0
> 
> 时间：2012-04-11T20:33:38.517
> 
> 标签：sql, sql-server-2005, data-cleaning

我有 15 个 SQL Server 表，每个表大约有 50 列。

其中一些列的行包含引号、逗号和制表符。

我有一个函数可以从给定列名的行中删除所有这些，但我不知道哪些列有问题。

我想要一个 SQL Server 2005 查询，它可以返回具有给定表名的坏数据的**列**名。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-11T21:53:56.987

如果没有某种动态 SQL，您将无法做到这一点。我通常不会跳过这些障碍，而是编写一个生成另一个脚本的脚本。

首先，一个脚本的大纲：

```
declare @cols table (name varchar(500))
...
select * from @cols 
```

然后使用这样的查询来生成一系列语句，这些语句将检查每一列的错误值：

```
SELECT 'IF EXISTS (SELECT * FROM [' + TABLE_NAME + ']' +
    ' WHERE [' + COLUMN_NAME + '] like ''%,%''' +
    ' or [' + COLUMN_NAME + '] like ''%''''%''' +
    ' or [' + COLUMN_NAME + '] like ''%'' + char(9) + ''%'')' +
    ' insert into @cols values (''' + COLUMN_NAME + ''')'
FROM INFORMATION_SCHEMA.COLUMNS
WHERE TABLE_NAME = 'Tablename' and DATA_TYPE in ('char','varchar') 
```

只需运行此查询，然后将结果粘贴到您的脚本中并运行它。您还可以轻松地修改它以同时处理多个表。

# login - 使用设备手动登录用户

> ID：10113510
> 
> 赞同：1
> 
> 时间：2012-04-11T20:33:45.163
> 
> 标签：login, devise, sessionid, manual

任何人都可以给出一个示例或链接到教程如何为用户实现手动登录并获取 session_id。

我正在将一个应用程序从 Rails 2 移植到 Rails 3，它在 RestAuthentication 之前使用。新应用程序使用设计，我已经设法修复了管理员的登录/注销。该应用程序还有一个模型（用户）需要进行身份验证。

我需要获取 session_id 才能在响应中传递它，因为客户端不是浏览器，而是移动设备。

欢迎任何链接、想法和示例。提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-17T18:28:35.123

我使用令牌 ID 而不是会话 ID。每次会话过期或用户注销时都会重新生成令牌。

# mysql - 尽可能使用整数来表示 MySQL 表中的数据总是更好吗？

> ID：10113511
> 
> 赞同：0
> 
> 时间：2012-04-11T20:33:49.057
> 
> 标签：mysql

我有一个表格，其中包含代表投票的行。这些字段是投票本身的 id，投票赞成或反对的事物的 id 以及保持“向上”或向下“的方向字段。将 0 和 1 或 1 和 2 用于“ up”和“down”？以这种方式使用字符串或整数总是更好还是更差？

我听说整数可以使某些表操作更快，但是在这样的上下文中使用整数，你试图表示的真实事物是一个方向，在编码时似乎会引入不必要的复杂性。如果我使用整数，我需要记住哪个数字代表哪个方向，并且我的代码不会自我记录。

任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T20:49:11.070

好吧，我会说应该根据具体情况决定。

当您非常确定这些是属性的少数值时，枚举可以派上用场。

是的，当然，如果您建议引用实际值，您将在 php 中添加一些额外的代码，但如果您确定不会在数据列表中添加右或左方向，那么请使用 ENUM。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T21:29:23.550

在您的情况下，将“UP”和“DOWN”存储为整数并不是一个坏主意，您可以将枚举存储在保存可能投票状态的特定表上。

您可以使用整数 ID 和字符串投票创建一个名为 votes 的表，如下所示：

```
 votes
+------+------+
| id   | vote |
+------+------+
|  0   | UP   |
|  1   | DOWN | 
```

然后在需要时使用名为例如的字段引用投票的 ID `vote_id`：我更喜欢这种方法而不是枚举器，因为它更灵活且可扩展，例如，如果有一天由于某种原因您想添加另一种类型的投票，您可以轻松地做到这一点，而无需触及您的应用程序代码，但实现将是就像在投票表中创建新记录一样简单。

# java - Jackson 中的 readValue 和 readTree：何时使用哪个？

> ID：10113512
> 
> 赞同：32
> 
> 时间：2012-04-11T20:33:55.230
> 
> 标签：java, json, jackson

我刚开始使用 Jackson JSON 库。Jackson 是一个非常强大的库，但它有一个非常广泛的 API。很多事情可以通过多种方式完成。这让您很难在杰克逊找到自己的方式——如何知道什么是正确/最佳的做事方式？

我为什么要使用这个解决方案：

```
String json = "{\"a\":2, \"b\":\"a string\", \"c\": [6.7, 6, 5.6, 8.0]}";
ObjectMapper mapper = new ObjectMapper();
JsonNode node = mapper.readValue(json, JsonNode.class);
if (node.isObject()) {
    ObjectNode obj = mapper.convertValue(node, ObjectNode.class);
    if (obj.has("a")) {
        System.out.println("a=" + obj.get("a").asDouble());
    }
} 
```

通过这样的解决方案：

```
String json = "{\"a\":2, \"b\":\"a string\", \"c\": [6.7, 6, 5.6, 8.0]}";
ObjectMapper mapper = new ObjectMapper();
JsonNode node = mapper.readTree(json);
if (node.isObject()) {
    ObjectNode obj = (ObjectNode) node;
    if (obj.has("a")) {
        System.out.println("a=" + obj.get("a").asDouble());
    }
} 
```

或者超过我使用 JsonFactory 和 JsonParser 遇到的解决方案，甚至更多选项......

似乎 mapper.readValue 是最通用的，可以在很多情况下使用：读取到 JsonNode、ObjectNode、ArrayNode、PoJo 等。那我为什么要使用 mapper.readTree？

将 JsonNode 转换为 ObjectNode 的最佳方法是什么？只是投射到 ObjectNode？或者使用类似 mapper.convertValue 的东西？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-04-12T20:35:58.487

readValue() 可用于任何和所有类型，包括`JsonNode`. readTree() 仅适用于`JsonNode`（树模型）；并为方便起见而添加。

请注意，您永远不想使用您的第一个示例：它相当于将您的节点写为 JSON，然后将其读回——只需转换它。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-04-11T21:16:55.627

读取值可用于您自己的 java 类：

```
public class Foo {
   private int a;
   private String b;
   private double[] c;

   // getters/setters
}

String json = "{\"a\":2, \"b\":\"a string\", \"c\": [6.7, 6, 5.6, 8.0]}";
ObjectMapper mapper = new ObjectMapper();
Foo foo = mapper.readValue(json, Foo.class); 
```

即`readTree`当您不知道对象的确切类型时，您可以选择，`readValue`当您确定对象类型时，您可以选择。

# xpages - XPages onComplete 事件和 UI 中的可见性

> ID：10113513
> 
> 赞同：0
> 
> 时间：2012-04-11T20:34:00.520
> 
> 标签：xpages

为什么我在 8.5.3 Designer 客户端中看不到任何控件的 onComplete 事件？我必须手动输入 this.onComplete？非常感谢它的出现位置的屏幕截图。

非常感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-11T20:49:55.593

不显示那么容易，我不知道IBM为什么要隐藏它。你可以找到它。如果您有一个指定了其他事件的对象。在大纲窗口中，将有一个事件处理程序单击此。然后在属性面板中，您将看到 oncomplete。容易没有。![未完成](../Images/053f3b464878e699086ca731da82db36.png)

# jquery - 表中多列中复选框的jQuery问题

> ID：10113514
> 
> 赞同：0
> 
> 时间：2012-04-11T20:34:02.620
> 
> 标签：jquery

我有一个 HTML 表（使用 ASP:Repeater 控件生成）。我在表中有 2 个复选框列。这两列的标题中都有一个全选复选框。因此，当我们选中 Select All 时，应选中相应列中的所有复选框（很常见的东西。所以我已经处理了）。现在的问题是，当我选中/取消选中 column_1XRow_1 中的复选框时，column_2XRow_1 中的复选框应该启用并选中/禁用和取消选中。

`

```
$(document).ready(function() {
    var $ResubAllChkBx = $('.ResubAll :checkbox');
    var $ResubItmChkBx = $('.ResubItm :checkbox');
    var $LLLCAllChkBx = $('.LLLCAll :checkbox');
    var $LLLCItmChkBx = $('.LLLCItm :checkbox');

    $ResubAllChkBx.change(function() {
        Chk_UnChkResubAll();
    });

    function Chk_UnChkResubAll() {
        if ($ResubAllChkBx.is(':checked')) {
            $ResubItmChkBx.filter(function() { return !this.disabled; }).attr('checked', 'checked');//check only when enabled
        }
        else {
            $ResubItmChkBx.filter(function() { return !this.disabled; }).removeAttr('checked');//check only when enabled
        }
    }
});` 
```

所以基本上 Re sub 是 Col1 & LLLC 是 Col2。

我用纯 JS 代码完成了所有这些工作，但由于页面上的负载，我开始看到 JS 错误“此页面上的脚本......”

如何绕过 col1 和 col2 中的选中/未选中复选框？请帮忙。我需要 jQuery 中的代码。

谢谢博比

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T21:25:06.207

将以下脚本添加到您的 jquery 代码中...

```
$('.ResubItm :checkbox').on('change', function(){    
    if($(this).is(':checked'))
        $(this).siblings('[type=checkbox]').each(function(){
            $(this).attr('checked','checked');
        })
    else
        $(this).siblings('[type=checkbox]').each(function(){
            $(this).attr('checked','');
        })
});

$('.LLLCItm :checkbox').on('change', function(){
    if($(this).is(':checked'))
        $(this).siblings('[type=checkbox]').each(function(){
            $(this).attr('checked','checked');
        })
    else
        $(this).siblings('[type=checkbox]').each(function(){
            $(this).attr('checked','');
        })
}); 
```

# ruby-on-rails - 如何使 Rails 中所有格式的操作过期？(expire_action)

> ID：10113515
> 
> 赞同：0
> 
> 时间：2012-04-11T20:34:08.213
> 
> 标签：ruby-on-rails, caching, ruby-on-rails-3.1

假设我有一个名为的假设控制器`ThingsController`，它公开了两个操作：索引和更新，它们具有以下路由：

> 获取 /things ThingsController#index
> 
> PUT /things/1 ThingsController#update

这两个动作都响应 JSON 格式，所以你有`GET /things.json`并且`PUT things/1.json`

我正在缓存索引操作，更新操作正在使索引操作过期，如下所示：

```
expire_action :action => :index 
```

但是，当更新发生时，它的默认格式会过期，`/things`但不会过期`/things.json`。

我需要做什么才能使`expire_action`所有格式都过期？我似乎在文档中的任何地方都找不到这个。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-11T20:46:36.587

不幸的是，我不知道比明确使每种格式过期更好的方法。

```
expire_action :action => :index
expire_action :action => :index, :format => 'json' 
```

# iphone - 如何触发属性更改的方法？

> ID：10113517
> 
> 赞同：0
> 
> 时间：2012-04-11T20:34:21.607
> 
> 标签：iphone, objective-c, ios

我有一个类 tabBarController ，每次它的 selectedIndex 属性发生变化时，我都想触发一个自定义方法。我该如何做到这一点？

这就是在 h 的实例变量中声明 tabBarController 的方式：

```
BaseViewController *tabBarController; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-11T20:44:58.833

使用 UITabBar 的 `-(void)tabBar:(UITabBar *)tabBar didSelectItem:(UITabBarItem * )item`方法来确定选项卡的索引，从而确定您希望调用的方法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-11T20:45:05.417

这是键值观察的完美候选。基本上，当值更改时，会触发通知并由`observers`您定义的任何想要观察该值以进行任何更改的人拾取。当您建立自己和观察者并实现该`observeValueForKeyPath:`方法时，您可以让它触发您想要的任何方法。

这是一个很好的起点：http: [//developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/KeyValueObserving/KeyValueObserving.html#//apple_ref/doc/uid/10000177-BCICJDHA](http://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/KeyValueObserving/KeyValueObserving.html#//apple_ref/doc/uid/10000177-BCICJDHA)

一开始有点吓人，但如果使用得当，基本上是神奇的。

编辑：没有看到它很简单`UITabBarController`。是的，只需使用委托方法。KVO 对此有点过分了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-11T20:45:05.703

创建一个设置器：

```
- (void)setSelectedIndex:(NSInteger*)integer
{
    // Do stuff
    selectedIndex=integer;
    // Or: [super setSelectedIndex:integer];
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-11T20:45:47.140

使用`delegate`方法`-(void)tabBar:(UITabBar *)tabBar didSelectItem:(UITabBarItem * )item`

# windows-phone-7 - 如何在解析语句 wp7 之外使用类变量

> ID：10113520
> 
> 赞同：0
> 
> 时间：2012-04-11T20:34:33.057
> 
> 标签：windows-phone-7, variables, xml-parsing, class-variables

我正在将 xml 解析成这样的变量

```
void myClient_DownloadStringCompleted(object sender, DownloadStringCompletedEventArgs e)
        {
         if (e.Error == null)
            {
                XElement currencyElements = XElement.Parse(e.Result);

                XNamespace gesmes = "http://www.gesmes.org/xml/2002-08-01";
                XNamespace ns = "http://www.ecb.int/vocabulary/2002-08-01/eurofxref";

                usd=Convert.ToDouble(currencyElements.Descendants(ns +"Cube")
                .Where(x=>x.Attribute("currency")!=null)             
                .Where(x => x.Attribute("currency")
                .Value == "USD")
                .Select(x => new ClassRates
                {
                    usd=Convert.ToDouble(x.Attribute("rate").Value)  
                }));

            else
            {
                textBlock1.Text = e.Error.ToString();
            }
} 
```

这是我的班级 ClassRates

```
public class ClassRates
        {
            public String curName { get; set; }
            public double curRate { get; set; }

            public double usd, jpy, bgn, czk, dkk, 
            gbp, huf, ltl, lvl, pln, ron, sek, chf, nok,
            hrk, rub, try1, aud, brl, cad, cny, hkd, idr, 
            ils, inr, krw, mxn, myr, nzd, php, sgd, thb, zar;
        } 
```

该变量`usd`在解析块之外不可用于计算。这是因为我正在通过类选择项目进行解析吗？有解决办法吗？试图实现一个字典/列表/数组来存储费率但也不起作用，这是我尝试使用字典的版本

```
Dictionary<string, double> rates = new Dictionary<string, double>();
                String xml = e.Result;
                XElement doc = XElement.Parse(xml);
                XNamespace ns = XNamespace.Get("http://www.gesmes.org/xml/2002-08-01");
                XNamespace masterNs = XNamespace.Get("http://www.ecb.int/vocabulary/2002-08-01/eurofxref");

                doc.Element(ns.GetName("Envelope"))
                   .Element(masterNs.GetName("Cube"))
                   .Elements(masterNs.GetName("Cube"))
                   .ToList().ForEach(cube =>
                   {

                       var cubeCurrencies = cube.Descendants(masterNs.GetName("Cube"));

                       cubeCurrencies.ToList().ForEach(currency =>
                       {
                           var country = currency.Attribute("currency").Value;
                           var rate = currency.Attribute("rate").Value;

                           rates.Add(country, double.Parse(rate));
                       });

                   }); 
```

这会导致我找不到 NullReferenceException。欢迎任何想法，

```
 <gesmes:Envelope xmlns:gesmes="http://www.gesmes.org/xml/2002-08-01" xmlns="http://www.ecb.int/vocabulary/2002-08-01/eurofxref">
<gesmes:subject>Reference rates</gesmes:subject>
<gesmes:Sender>
  <gesmes:name>European Central Bank</gesmes:name>
</gesmes:Sender>
<Cube>
  <Cube time="2012-04-12">
    <Cube currency="USD" rate="1.3153"/>
    <Cube currency="JPY" rate="106.54"/>
    <Cube currency="BGN" rate="1.9558"/>
    <Cube currency="CZK" rate="24.803"/>
    <Cube currency="DKK" rate="7.4384"/>
    <Cube currency="GBP" rate="0.82470"/>
    <Cube currency="HUF" rate="296.90"/>
    <Cube currency="LTL" rate="3.4528"/>
    <Cube currency="LVL" rate="0.6989"/>
    <Cube currency="PLN" rate="4.1802"/>
    <Cube currency="RON" rate="4.3745"/>
    <Cube currency="SEK" rate="8.8912"/>
    <Cube currency="CHF" rate="1.2027"/>
    <Cube currency="NOK" rate="7.6100"/>
    <Cube currency="HRK" rate="7.4758"/>
    <Cube currency="RUB" rate="38.7840"/>
    <Cube currency="TRY" rate="2.3664"/>
    <Cube currency="AUD" rate="1.2645"/>
    <Cube currency="BRL" rate="2.4075"/>
    <Cube currency="CAD" rate="1.3132"/>
    <Cube currency="CNY" rate="8.2961"/>
    <Cube currency="HKD" rate="10.2128"/>
    <Cube currency="IDR" rate="12055.30"/>
    <Cube currency="ILS" rate="4.9348"/>
    <Cube currency="INR" rate="67.8550"/>
    <Cube currency="KRW" rate="1500.58"/>
    <Cube currency="MXN" rate="17.2124"/>
    <Cube currency="MYR" rate="4.0360"/>
    <Cube currency="NZD" rate="1.6001"/>
    <Cube currency="PHP" rate="56.176"/>
    <Cube currency="SGD" rate="1.6507"/>
    <Cube currency="THB" rate="40.564"/>
    <Cube currency="ZAR" rate="10.4472"/>
</Cube>
</Cube>
</gesmes:Envelope> 
```

小时

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T18:43:57.177

[http://msdn.microsoft.com/en-us/library/system.runtime.serialization.datacontractserializer%28v=vs.95%29.aspx](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.datacontractserializer%28v=vs.95%29.aspx)

这是反序列化 xml twitter 提要的两种方法的示例。您还需要设置您的类，并可能使用`[DataContract]`和`[DataMember]`属性来装饰它们。

此外，如果您有时间，请为您的 Web 服务查看 json。它的占用空间往往要小得多，这意味着通过线路发送的数据比 xml 少，而且它很容易反序列化。

```
 void myClient_DownloadStringCompleted(object sender, DownloadStringCompletedEventArgs e)
    {
        var tweets = ReadToObject(e.Result);
        var tweets2 = ReadToObject2(e.Result);
    }

    private static statuses ReadToObject(string xml)
    {
        var tweets = new statuses();
        using (var ms = new MemoryStream(Encoding.UTF8.GetBytes(xml)))
        {
            var ser = new DataContractSerializer(typeof(statuses));
            tweets = ser.ReadObject(ms) as statuses;
        }
        return tweets;

    }

    private static statuses ReadToObject2(string xml)
    {
        XmlSerializer ser = new XmlSerializer(typeof(statuses));
        var tweets = new statuses();

        using(var stringReader = new StringReader(xml))
        {
            using (var xmlReader = new XmlTextReader(stringReader))
            {
                tweets = ser.Deserialize(xmlReader) as statuses;
            }
        }
        return tweets;
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T21:50:48.207

`ClassRate`在 中创建一个本地实例`myClient_DownloadStringCompleted`并引用它，而不是在 Linq 查询完成时创建一个新实例。

另外，请重构您的解析代码，以及`ClassRates`. 将Linq语句分开，创建一个可以将货币类型作为参数的解析方法，然后根据它进行查询。

# java - 检查元素是否已经在 J ava 数组中

> ID：10113527
> 
> 赞同：2
> 
> 时间：2012-04-11T20:34:52.527
> 
> 标签：java, arrays

我现在正在进行的项目涉及我从文本文件中读取单词并将它们加载到数组中（最终是二叉树，但这将在稍后完成）。我必须将单词和单词的频率（最初为 1）都加载到数组中，因此我将两个变量都打包到一个 object`WordNode`中。我能够将单词加载到数组中，但是当我尝试检查单词是否已经在数组中时，事情就崩溃了。如果是，我必须将频率增加 1。但是，我的代码甚至不检查单词，而是简单地添加它（我假设它正在检查对变量的引用而不是单词本身）。下面是我的`main`方法和`WordNode`课程。

主要方法：

```
public class Driver {
/////////////// fields ///////////////
public static ArrayUnorderedList<WordNode> wordArray = new ArrayUnorderedList<WordNode>();
public static LinkedBinarySearchTree<WordNode> wordTree = new LinkedBinarySearchTree<WordNode>();   //tree to hold words

/////////////// methods ///////////////
public static void main(String[] args) throws Exception {
    //ask for filename       
    BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
    System.out.println("Enter the name of the file to read from: ");
    Reader file = new FileReader(reader.readLine());

    //read file
    Scanner input = new Scanner(file);

    while(input.hasNext()) {
        //get words from file
        String word = input.next();

        //remove non-word characters and convert to lowercase
        word = word.replaceAll("\\W", "");
        word = word.toLowerCase();

        //create node
        WordNode newWord = new WordNode(word);

        //if word is already in array
        if(wordArray.contains(newWord)) {
            System.out.println("Word is already in array");

            //increment frequency by 1
            int index = wordArray.find(newWord);
            wordArray.list[index].setFrequency(wordArray.list[index].getFrequency() + 1);
            System.out.println(newWord.getWord() + newWord.getFrequency());
        } else {
            System.out.println("Word is not yet in array");

            //add word to tree
            System.out.println(newWord.getWord());
            wordArray.addToRear(newWord);
        }
    }

    //insert into tree

    //perform traversals on tree
} 
```

WordNode 类：

```
public class WordNode {
   protected String word;
   protected WordNode left, right;
   protected int frequency;

   /**
    * Creates a new node with the specified data.
    * @param obj the element that will become a part of the new node
    */
   WordNode(String obj) {
      word = obj;
      left = null;
      right = null;
      frequency = 1;
   }

   /**
    * Gets the word.
    * @return the word
    */
   public String getWord() {
      return word;
   }

   /**
    * Sets the word.
    * @param word the word to set
    */
   public void setWord(String word) {
      this.word = word;
   }

   /**
    * Gets the left.
    * @return the left
    */
   public WordNode getLeft() {
      return left;
   }

   /**
    * Sets the left.
    * @param left the left to set
    */
   public void setLeft(WordNode left) {
      this.left = left;
   }

   /**
    * Gets the right.
    * @return the right
    */
   public WordNode getRight() {
      return right;
   }

   /**
    * Sets the right.
    * @param right the right to set
    */
   public void setRight(WordNode right) {
      this.right = right;
   }

   /**
    * Gets the frequency.
    * @return the frequency
    */
   public int getFrequency() {
      return frequency;
   }

   /**
    * Sets the frequency.
    * @param frequency the frequency to set
    */
   public void setFrequency(int frequency) {
      this.frequency = frequency;
   }
} 
```

ArrayList 类的一些方法：

```
/**
* Returns true if this list contains the specified element.
* @param target the element that the list is searched for
* @return true if the target is in the list, false if otherwise 
*/
public boolean contains(T target) {
    return (find(target) != NOT_FOUND);
}

/**
* Returns the array index of the specified element, or the
* constant NOT_FOUND if it is not found.
* @param target the element that the list will be searched for
* @return the integer index into the array containing the target element, or the NOT_FOUND constant
*/
public int find(T target) {
    int scan = 0, result = NOT_FOUND;
    boolean found = false;

    if (!isEmpty()) {
       while (!found && scan < rear) {
          if (target.equals(list[scan])) {
              found = true;
          } else {
             scan++;
          }
       }
    }

    if (found) {
       result = scan;
    }

    return result;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-11T20:40:29.217

您的代码不起作用的直接原因`ArrayUnorderedList#contains()`可能是依赖于`equals()`确定条目是否在列表中的方法。没有看到类的定义是不可能知道的。

由于您没有提供对 的覆盖`equals()`，因此它使用对象标识（默认来自`Object`），因此每个`WordNode`都与其他的不同`WordNode`。

如果要使用，`ArrayUnorderedList`则必须`WordNode#equals()`以正确的行为实施。

但是，您应该考虑使用`Map<String,Integer>`（或`Map<String,WordNode>`）来存储频率。这会快得多。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T20:46:32.460

您需要在 WordNode 中覆盖 eqauls：

```
public boolean equals(Object o) {
     if(o instanceof WordNode) {
        WordNode temp = (WordNode) o;
        return(temp.getWord().equals(this.word));
     }
     else
         System.out.println("Object o you passed is not a WordNode");
} 
```

这样，如果两个不同的 WordNode 对象具有与 word 字段相同的字符串，则它们被视为相等

如何调用等号：

```
WordNode n1 = new WordNode();
n1.setWord("test");

WordNode n2 = new WordNode();
n2.setWord("test");

System.out.println(n1.equals(n2)); 
```

所以 equals 接收一个 Object 类型的对象，但是当你在 WordNode 上调用 equals 时，你必须提供一个作为 WordNode 实例的对象，否则我所做的转换失败（你的例外），当然验证是否没有意义一个对象等于一个 WordNode

# jquery - 多个元素的jQuery动画回调

> ID：10113528
> 
> 赞同：5
> 
> 时间：2012-04-11T20:35:01.123
> 
> 标签：jquery, callback, jquery-animate

正如您在[此 Fiddle](http://jsfiddle.net/hoffs/Pz5YB/23/)中看到的那样，我一次为多个元素设置动画，这正如我所愿。但在下一步中，我想在所有元素的动画结束后做一些事情。使用完成函数似乎不可能，因为它是为每个完成的动画（3 个元素，3 次完成回调）触发的。jquery `.animate()`API 还说：

> 如果为多个元素设置了动画，则每个匹配的元素都会执行一次回调，而不是对整个动画执行一次。

那么，您知道我可以做些什么来在每个动画完成时触发一个事件吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-29T08:13:40.397

```
...animate(...).promise().done(function(){console.log("animate complete!")}) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T20:44:00.963

好了，刚刚添加了一个简单的计数器 :)

[http://jsfiddle.net/Pz5YB/24/](http://jsfiddle.net/Pz5YB/24/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-11T20:46:11.850

您可以创建一个变量并在每次动画完成时进行计数。如果它等于 3（或您想要的任何数字），请调用另一个函数。看到这个[jsfiddle](http://jsfiddle.net/hoffs/Pz5YB/23/)

```
function animateAll(){
if(flag) return;
flag = true;
 //$('.list-wrapper').scrollLeft(w); // not sure why you need this
 //$('.table-wrapper').scrollLeft(w); // or this
 $('.list-wrapper, .table-wrapper').animate({
     scrollLeft: 2*w,
   }, function(){
       countAni++;
       console.log('finish');
       if(countAni == 3) finishAni()
   }     
 );
 function finishAni(){
     alert('whoohoo ready');   
     flag = false;
 } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-11T21:41:34.357

在您的情况下，您可以查看当前动画：

```
$(':animated').length 
```

并在完成回调时：

```
if($(':animated').length==1)
     console.log('whoohoo ready'); 
```

[http://jsfiddle.net/Pz5YB/25/](http://jsfiddle.net/Pz5YB/25/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-15T23:27:26.440

起初，接受的答案对我来说有点不清楚如何处理不相关的元素。最终我得到了这个答案：

```
 $.when(
     $someElement.animate(...).promise(),
     $someOtherElement.animate(...).promise()
).done(function() {
    console.log("whoohoo ready");
}); 
```

# maven-plugin - sonar maven插件下载文件失败：http://localhost:9000/deploy/jdbc-driver.jar

> ID：10113529
> 
> 赞同：2
> 
> 时间：2012-04-11T20:35:07.807
> 
> 标签：maven-plugin, sonarqube

我尝试下载并安装声纳，然后使用 Maven 声纳插件运行分析。我已经尝试过第一个 Sonar 版本 2.14，现在又尝试了 2.13.1，但我一遍又一遍地遇到同样的错误。

似乎无法从 localhost（声纳服务器）下载 jdbc 驱动程序，因为我收到此错误消息：“无法下载文件：[http://localhost:9000/deploy/jdbc-driver.jar](http://localhost:9000/deploy/jdbc-driver.jar)（无代理） : 读取超时 -> [帮助 1]"

但是，如果我用浏览器访问[http://localhost:9000/deploy/jdbc-driver.jar](http://localhost:9000/deploy/jdbc-driver.jar)，它会毫无问题地下载文件，因此看来声纳服务器工作方式正确，并且 maven 声纳插件做错了我无法弄清楚的事情。

我也尝试将声纳的上下文根更改为 /sonar，但我得到了同样的错误。我已将声纳配置为使用 postgreSQL 而不是嵌入式 Derby 数据库，但仍然没有运气。从浏览器访问声纳就像一个魅力，但我无法运行 mvn sonar:sonar 所以此时我的声纳安装非常没用...... :(

这是使用 -e 选项运行 maven 的堆栈跟踪：

```
[ERROR] Failed to execute goal org.codehaus.mojo:sonar-maven-plugin:2.0:sonar (default-cli) on project betterfarmer-engine: Can not execute Sonar: Fail to download the
file: http://localhost:9000/deploy/jdbc-driver.jar (no proxy): Read timed out -> [Help 1]
org.apache.maven.lifecycle.LifecycleExecutionException: Failed to execute goal org.codehaus.mojo:sonar-maven-plugin:2.0:sonar (default-cli) on project betterfarmer-engi
ne: Can not execute Sonar
        at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:217)
        at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:153)
        at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:145)
        at org.apache.maven.lifecycle.internal.LifecycleModuleBuilder.buildProject(LifecycleModuleBuilder.java:84)
        at org.apache.maven.lifecycle.internal.LifecycleModuleBuilder.buildProject(LifecycleModuleBuilder.java:59)
        at org.apache.maven.lifecycle.internal.LifecycleStarter.singleThreadedBuild(LifecycleStarter.java:183)
        at org.apache.maven.lifecycle.internal.LifecycleStarter.execute(LifecycleStarter.java:161)
        at org.apache.maven.DefaultMaven.doExecute(DefaultMaven.java:319)
        at org.apache.maven.DefaultMaven.execute(DefaultMaven.java:156)
        at org.apache.maven.cli.MavenCli.execute(MavenCli.java:537)
        at org.apache.maven.cli.MavenCli.doMain(MavenCli.java:196)
        at org.apache.maven.cli.MavenCli.main(MavenCli.java:141)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
        at java.lang.reflect.Method.invoke(Method.java:601)
        at org.codehaus.plexus.classworlds.launcher.Launcher.launchEnhanced(Launcher.java:290)
        at org.codehaus.plexus.classworlds.launcher.Launcher.launch(Launcher.java:230)
        at org.codehaus.plexus.classworlds.launcher.Launcher.mainWithExitCode(Launcher.java:409)
        at org.codehaus.plexus.classworlds.launcher.Launcher.main(Launcher.java:352)
Caused by: org.apache.maven.plugin.MojoExecutionException: Can not execute Sonar
        at org.codehaus.mojo.sonar.Bootstraper.executeMojo(Bootstraper.java:118)
        at org.codehaus.mojo.sonar.Bootstraper.start(Bootstraper.java:65)
        at org.codehaus.mojo.sonar.SonarMojo.execute(SonarMojo.java:90)
        at org.apache.maven.plugin.DefaultBuildPluginManager.executeMojo(DefaultBuildPluginManager.java:101)
        at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:209)
        ... 19 more
Caused by: org.sonar.api.utils.SonarException: Fail to download the file: http://localhost:9000/deploy/jdbc-driver.jar (no proxy)
        at org.sonar.api.utils.HttpDownloader.download(HttpDownloader.java:130)
        at org.sonar.batch.bootstrap.ArtifactDownloader.downloadJdbcDriver(ArtifactDownloader.java:58)
        at org.sonar.batch.bootstrap.JdbcDriverHolder.<init>(JdbcDriverHolder.java:43)
        at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
        at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:57)
        at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
        at java.lang.reflect.Constructor.newInstance(Constructor.java:525)
        at org.picocontainer.injectors.AbstractInjector.newInstance(AbstractInjector.java:147)
        at org.picocontainer.injectors.ConstructorInjector$1.run(ConstructorInjector.java:319)
        at org.picocontainer.injectors.AbstractInjector$ThreadLocalCyclicDependencyGuard.observe(AbstractInjector.java:274)
        at org.picocontainer.injectors.ConstructorInjector.getComponentInstance(ConstructorInjector.java:341)
        at org.picocontainer.injectors.AbstractInjectionFactory$LifecycleAdapter.getComponentInstance(AbstractInjectionFactory.java:56)
        at org.picocontainer.behaviors.AbstractBehavior.getComponentInstance(AbstractBehavior.java:64)
        at org.picocontainer.behaviors.Stored.getComponentInstance(Stored.java:91)
        at org.picocontainer.DefaultPicoContainer.getInstance(DefaultPicoContainer.java:689)
        at org.picocontainer.DefaultPicoContainer.getComponent(DefaultPicoContainer.java:638)
        at org.picocontainer.DefaultPicoContainer.getComponent(DefaultPicoContainer.java:663)
        at org.sonar.api.platform.ComponentContainer.getComponentByType(ComponentContainer.java:113)
        at org.sonar.batch.bootstrap.Module.getComponentByType(Module.java:131)
        at org.sonar.batch.bootstrap.BootstrapModule.configure(BootstrapModule.java:63)
        at org.sonar.batch.bootstrap.Module.init(Module.java:49)
        at org.sonar.batch.bootstrap.Module.init(Module.java:41)
        at org.sonar.batch.Batch.<init>(Batch.java:37)
        at org.sonar.maven3.SonarMojo.executeBatch(SonarMojo.java:143)
        at org.sonar.maven3.SonarMojo.execute(SonarMojo.java:136)
        at org.codehaus.mojo.sonar.Bootstraper.executeMojo(Bootstraper.java:113)
        ... 23 more
Caused by: java.net.SocketTimeoutException: Read timed out
        at java.net.SocketInputStream.socketRead0(Native Method)
        at java.net.SocketInputStream.read(SocketInputStream.java:150)
        at java.net.SocketInputStream.read(SocketInputStream.java:121)
        at java.io.BufferedInputStream.fill(BufferedInputStream.java:235)
        at java.io.BufferedInputStream.read1(BufferedInputStream.java:275)
        at java.io.BufferedInputStream.read(BufferedInputStream.java:334)
        at sun.net.www.MeteredStream.read(MeteredStream.java:134)
        at java.io.FilterInputStream.read(FilterInputStream.java:133)
        at sun.net.www.protocol.http.HttpURLConnection$HttpInputStream.read(HttpURLConnection.java:2959)
        at sun.net.www.protocol.http.HttpURLConnection$HttpInputStream.read(HttpURLConnection.java:2953)
        at org.apache.commons.io.IOUtils.copyLarge(IOUtils.java:1262)
        at org.apache.commons.io.IOUtils.copy(IOUtils.java:1236)
        at org.sonar.api.utils.HttpDownloader.download(HttpDownloader.java:125)
        ... 48 more
[ERROR]
[ERROR] Re-run Maven using the -X switch to enable full debug logging.
[ERROR]
[ERROR] For more information about the errors and possible solutions, please read the following articles:
[ERROR] [Help 1] http://cwiki.apache.org/confluence/display/MAVEN/MojoExecutionException 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T06:42:15.950

您的声纳可能未正确安装。

*   服务器日志中没有错误吗？
*   您可以在[http://localhost:9000](http://localhost:9000)浏览 Web 应用程序吗？

我建议从全新安装开始（在与前一个文件夹不同的文件夹中），并在启动新的 Sonar 之前检查您是否没有指向先前安装位置的 env 属性。

# python - 通过传递给脚本的参数通过 UDP 或 TCP 套接字发送十六进制值

> ID：10113530
> 
> 赞同：3
> 
> 时间：2012-04-11T20:35:09.133
> 
> 标签：python, sockets, hex, parameter-passing

我知道为了使用 python 通过 UDP 套接字发送数据，必须采用以下格式 "\x41" = A 。

我有一个 python 脚本 udp_send.py，我想发送一个十六进制值来表示服务器端的寄存器值。

我通过 linux 终端 >>python udp_send.py "\x41" 运行我的脚本。我在 python 脚本中使用 argv[1] 读取了变量。我做了一个 len 检查，它是 3 。它忽略 \ 并将 x、4 和 1 分别作为 1 个字节，而我希望 \x41 仅代表 1 个字节。

然后我试图连接 data="\x"+"41" 但它没有用。

"\x" 被 python 解释为转义。我正在尝试找到一种将十六进制值传递到我的脚本并通过 UDP 套接字发送它的方法？

到目前为止，我已经实现了以下目标。通过 UDP socket 发送在 python 脚本中定义的十六进制值。

```
from socket import *
from sys import *

## Set the socket parameters
host = <ip-define-here>
port = <port-define-here>
buf = 1024
addr = (host,port)

## Create socket
UDPSock = socket(AF_INET,SOCK_DGRAM)

## Send messages
data ='\x41'
#data=argv[1] #commented out
if not data:
    print "No data"
else:
    if(UDPSock.sendto(data,addr)):
        print "Sending message ",data

## Close socket
UDPSock.close() 
```

我在服务器端使用了wireshark，看到了十六进制值41。

只是要清楚“41”（由 2 个字节组成）与 python 中的“\x41”（仅一个字节）不同。

我的简单问题是，如何获取一个字符“41”并将其与“\x”连接以形成“\x41”，以便我可以将它分配给我的 python 脚本中的数据变量，以便我可以将它作为十六进制值 41 发送。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-11T21:09:23.603

在您的代码中，您可以将您的 arg 转换为正确的格式，然后您可以调用它`python udp_send.py 0x41`

```
arg = sys.argv[1]

# intarg = 65 == 0x41
intarg = int(arg, 16)

# now convert to byte string '\x41'
hexstring = struct.pack('B', intarg) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-11T21:01:11.263

你让你的问题比你需要的更复杂。字符已经包含它们的字节值。您应该能够只传递字符串“A”，一切都会正常工作。

首先，python中的'\x41'和'A'没有区别。两者都表示由 byte 组成的一个字符串`0x41`。（或二进制`0100 0001`。任何地方（在 python 中）你可以使用一个，你可以使用另一个。问题来了，因为 shell 在将它传递给 python 之前如何解析你的字符串。shell 看到反斜杠，试图转义下一个字符，失败（因为 \x 不是有效的 shell 转义），`x`通过未转义，然后通过字符`4`和。所以 python 接收由字符和`1`组成的三个字符串。如果你想通过反斜杠通过,你需要转义它,但这不会达到你想要的.然后python将得到一个由字符组成的四字节字符串`x` `4``1``\`, `x`,`4`和`1`. 它的 repr 将是`'\\x4a'`，如果您打印它，它将看起来像`\x4a`.

为了获得单字节值`0x41`，请使用字符`A`。

# c++ - 在 C++ 中保存和加载大数组

> ID：10113531
> 
> 赞同：0
> 
> 时间：2012-04-11T20:35:14.137
> 
> 标签：c++, arrays, file, optimization

我需要将一个大型 3D 整数数组保存到一个文件中，然后在 C++ 中再次加载它。它是 256*256*256 = 16777216 个整数。

保存并再次加载它的最佳方法是什么？我最感兴趣的是快速加载时间。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-11T20:39:10.863

如果数组是在连续内存中分配的（即：您不单独分配每个维度） - 您可以将整个内存块转储到文件中。它需要尽可能多的东西，但这将是最小的开销（即：对整个数据块调用二进制写入）。

如果您在一个系统上保存并在另一个系统上加载，您可能会遇到数据表示问题，在这种情况下，您可能希望序列化数组并将每个值保存在受控事项中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-11T20:49:20.007

您可能对[Boost.Serialization](http://www.boost.org/doc/libs/1_49_0/libs/serialization/doc/index.html)感兴趣，特别是如果您 (1) 希望能够*轻松地*将此类数据存储在磁盘上，(2) 想要一种连贯的方式来保存更复杂的对象，以及 (3) 想要一个可移植的解决方案。

# .net - 如何修复 Visual Studio 编译错误“处理器架构之间的不匹配”？

> ID：10113532
> 
> 赞同：509
> 
> 时间：2012-04-11T20:35:25.153
> 
> 标签：.net, visual-studio

我是 Visual Studio 2010 中项目配置的新手，但我已经做了一些[研究](http://visualstudiohacks.com/articles/visual-studio-net-platform-target-explained/)，但仍然无法完全解决这个问题。我有一个带有引用 C# DLL 的 C++ DLL 的 Visual Studio 解决方案。C# DLL 引用了一些其他 DLL，一些在我的项目中，一些在外部。当我尝试编译 C++ DLL 时，我收到以下警告：

> 警告 MSB3270：正在构建的项目的处理器架构“MSIL”与参考“[internal C# dll]”、“x86”的处理器架构不匹配。

它告诉我去配置管理器来调整我的架构。C# DLL 设置为平台目标 x86。如果我尝试将其更改为其他内容，例如 Any CPU，它会抱怨，因为*它所*依赖的外部 DLL 之一具有平台目标 x86。

当我查看配置管理器时，它将我的 C# DLL 的平台显示为 x86，将我的 C++ 项目的平台显示为 Win32。这似乎是正确的设置；当然，我不希望我的 C++ 项目的项目将平台设置为 x64，这是唯一的其他选项。

我在这里做错了什么？

* * *

## 回答 #1

> 赞同：572
> 
> 时间：2012-04-17T18:04:13.760

这个警告似乎是在新的 Visual Studio 11 Beta 和 .NET 4.5 中引入的，尽管我认为它以前可能是可能的。

首先，这实际上只是一个警告。如果您只是处理 x86 依赖项，它不应该有任何伤害。当您声明您的项目与“任何 CPU”兼容但您依赖于 x86 或 x64 的项目或 .dll 程序集时，Microsoft 只是试图警告您。因为您有 x86 依赖项，所以从技术上讲，您的项目与“任何 CPU”不兼容。要使警告消失，您实际上应该将项目从“任何 CPU”更改为“x86”。这很容易做到，这里是步骤。

1.  转到构建|配置管理器菜单项。
2.  在列表中找到您的项目，在平台下它会显示“任何 CPU”
3.  从下拉列表中选择“任何 CPU”选项，然后选择`<New..>`
4.  在该对话框中，从“New Platform”下拉列表中选择 x86，并确保在“Copy settings from”下拉列表中选择“Any CPU”。
5.  点击确定
6.  您需要为 Debug 和 Release 配置选择 x86。

这将使警告消失，并表明您的程序集或项目现在不再与“任何 CPU”兼容，但现在特定于 x86。如果您正在构建具有 x64 依赖项的 64 位项目，这也适用；您只需选择 x64 即可。

另请注意，如果项目是纯 .NET 项目，通常可以与“任何 CPU”兼容。仅当您引入针对特定处理器架构的依赖项（第 3 方 dll 或您自己的 C++ 托管项目）时，才会出现此问题。

* * *

## 回答 #2

> 赞同：153
> 
> 时间：2012-10-01T11:36:52.357

这是一个非常顽固的警告，虽然它是一个有效的警告，但在某些情况下，由于使用 3rd 方组件和其他原因，它无法解决。我有一个类似的问题，除了警告是因为我的项目平台是 AnyCPU 并且我正在引用为 AMD64 构建的 MS 库。顺便说一下，这是在 Visual Studio 2010 中，似乎是通过安装 VS2012 和 .Net 4.5 引入的。

由于我无法更改我引用的 MS 库，并且我知道我的目标部署环境将永远是 64 位，所以我可以放心地忽略这个问题。

警告呢？微软在回应[Connect 报告](http://connect.microsoft.com/VisualStudio/feedback/details/728995/new-vs2010-project-compiler-warning-since-installing-dotnet4-5-vs2011-beta)时发布了一个选项是禁用该警告。只有非常了解您的解决方案架构并且您完全了解您的部署目标并且知道它在开发环境之外并不是真正的问题时，您才应该这样做。

您可以编辑项目文件并添加此属性组和设置以禁用警告：

```
<PropertyGroup>
  <ResolveAssemblyWarnOrErrorOnTargetArchitectureMismatch>None</ResolveAssemblyWarnOrErrorOnTargetArchitectureMismatch>
</PropertyGroup> 
```

* * *

## 回答 #3

> 赞同：67
> 
> 时间：2012-11-13T23:19:03.957

一个好的经验法则是“打开 DLL，关闭 EXE”，即：

*   **EXE**通过指定 x86 或 x64 以操作系统为目标。
*   **DLL**保持打开状态（即 AnyCPU），因此它们可以在 32 位或 64 位进程中实例化。

当您将 EXE 构建为 AnyCPU 时，您所做的就是将决定使用哪个进程位数的决定推迟到操作系统，这将使 EXE 按自己的喜好进行 JIT。也就是说，x64 操作系统将创建一个 64 位进程，x86 操作系统将创建一个 32 位进程。

将 DLL 构建为 AnyCPU 使它们与任一进程兼容。

有关程序集加载的细节的更多信息，请参见[此处](http://thingsthatshouldbeeasy.blogspot.com/2009/08/anycpu-x86-x64-whats-difference.html)。执行摘要的内容如下：

*   **AnyCPU** – 根据调用进程加载为 x64 或 x86 程序集
*   **x86** – 加载为 x86 程序集；不会从 x64 进程加载
*   **x64** – 加载为 x64 程序集；不会从 x86 进程加载

* * *

## 回答 #4

> 赞同：24
> 
> 时间：2012-04-17T00:57:02.303

> C# DLL 设置为平台目标 x86

这是一个问题，DLL实际上并不能选择进程的位数。这完全由 EXE 项目决定，这是第一个加载的程序集，因此它的平台目标设置是计算和设置进程位数的那个。

DLL 没有选择，它们需要与进程位数兼容。如果它们不是，那么当您的代码尝试使用它们时，您将得到一个带有 BadImageFormatException 的大 Kaboom。

因此，DLL 的一个很好的选择是 AnyCPU，因此它们可以以任何方式工作。这对 C# DLL 很有意义，它们*确实可以*工作。但可以肯定的是，不是您的 C++/CLI 混合模式 DLL，它包含非托管代码，只有当进程在 32 位模式下运行时才能正常工作。您*可以*让构建系统生成有关此的警告。这正是你得到的。只是警告，它仍然可以正常构建。

只是解决问题。将 EXE 项目的平台目标设置为 x86，它不会与任何其他设置一起使用。并且只需将所有 DLL 项目保存在 AnyCPU 上。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2016-11-03T13:19:33.803

我得到了同样的警告，我这样做了：

1.  卸载项目
2.  编辑项目属性，即 .csproj
3.  添加以下标签：

    ```
    <PropertyGroup>
        <ResolveAssemblyWarnOrErrorOnTargetArchitectureMismatch>
            None
        </ResolveAssemblyWarnOrErrorOnTargetArchitectureMismatch>
    </PropertyGroup> 
    ```

4.  重新加载项目

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2017-03-31T12:58:10.590

我今天遇到了这个问题，只是查看 Visual Studio 中的构建配置并没有帮助，因为它显示了未构建的项目和引用的项目的任何 CPU。

然后我查看了引用项目的 csproj 并发现了这个：

```
<PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Release|AnyCPU' ">
<DebugType>pdbonly</DebugType>
<Optimize>true</Optimize>
<OutputPath>bin\Release\</OutputPath>
<DefineConstants>TRACE</DefineConstants>
<ErrorReport>prompt</ErrorReport>
<WarningLevel>4</WarningLevel>
<PlatformTarget>x64</PlatformTarget> 
```

不知何故，这个 PlatformTarget 是在配置更改的中间添加的，IDE 似乎没有看到它。

从引用的项目中删除这一行解决了我的问题。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2019-11-06T15:02:43.177

使用[https://docs.microsoft.com/en-us/visualstudio/msbuild/customize-your-build#directorybuildprops-example](https://docs.microsoft.com/en-us/visualstudio/msbuild/customize-your-build#directorybuildprops-example)：

*   将*Directory.Build.props*文件添加到您的解决方案文件夹
*   将其粘贴在其中：

```
<Project>
 <PropertyGroup>
   <ResolveAssemblyWarnOrErrorOnTargetArchitectureMismatch>None</ResolveAssemblyWarnOrErrorOnTargetArchitectureMismatch>
 </PropertyGroup>
</Project> 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2014-05-04T20:15:15.683

除了 David Sacks 的回答之外，您可能还需要转到为您提供这些警告的项目的`Build`选项卡`Project Properties`并设置`Platform Target`为。`x86`尽管您可能希望如此，但此设置似乎与配置管理器中的设置并不完全同步。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2012-04-23T19:11:59.793

如果您的 C# DLL 具有基于 x86 的依赖项，那么您的 DLL 本身将必须是 x86。我真的没有办法解决这个问题。VS 抱怨将其更改为（例如）x64，因为 64 位可执行文件无法加载 32 位库。

我对 C++ 项目的配置有点困惑。为构建提供的警告消息表明它针对 AnyCPU，因为它报告它针对的平台是 [MSIL]，但您指出该项目的配置实际上是 Win32。本机 Win32 应用程序不应涉及 MSIL - 尽管如果它与 C# 库交互，它可能需要启用 CLR 支持。所以我认为在信息方面存在一些差距。

我能否恭请您查看并发布项目的确切配置以及它们如何相互关联的更多细节？如果可能的话，很乐意提供进一步的帮助。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2012-04-11T21:11:06.743

对于 C# 项目，x86 的目标就像它听起来的那样。它说这个程序集只支持 x86 架构。对于 x64 也是如此。另一方面，任何 CPU 都表示我不在乎哪种架构，我都支持。那么，接下来的 2 个问题是（1）使用这些 dll 的可执行文件的配置是什么？(2) 位数是*多少*您的操作系统/计算机？我问的原因是因为如果您的可执行文件被编译为以 64 位运行，那么它也需要所有依赖项才能在 64 位模式下运行。您的 Any CPU 程序集应该能够被加载，但也许它引用了一些只能在 x86 配置中运行的其他依赖项。如果您计划在 64 位模式下运行可执行文件，请检查所有依赖项和依赖项的依赖项，以确保一切都是“任何 CPU”或“x64”。否则，你会有问题。

在许多方面，Visual Studio 并不容易编译任何 CPU 和各种依赖于体系结构的程序集的混合体。这是可行的，但它通常要求必须为 x86 和 x64 分别编译一个原本是“任何 CPU”的程序集，因为某处的某些依赖项有两个版本。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2014-02-06T18:58:47.280

对于我的项目，我需要能够构建到 x86 和 x64。这样做的问题是，每当您在使用一个引用时添加引用，当您构建另一个引用时它就会抱怨。

我的解决方案是手动编辑 *.csproj 文件，以便像这样的行：

```
<Reference Include="MyLibrary.MyNamespace, Version=1.0.0.0, Culture=neutral, processorArchitecture=x86"/>

<Reference Include="MyLibrary.MyNamespace, Version=1.0.0.0, Culture=neutral, processorArchitecture=AMD64"/>

<Reference Include="MyLibrary.MyNamespace, Version=1.0.0.0, Culture=neutral, processorArchitecture=MSIL"/> 
```

改成这样：

```
<Reference Include="MyLibrary.MyNamespace, Version=1.0.0.0, Culture=neutral"/> 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2012-11-09T22:26:00.363

我之前也遇到过类似的问题，特别是在向现有 x64 解决方案（如 SharePoint）添加测试解决方案时。就我而言，这似乎与某些项目模板默认添加为某些平台这一事实有关。

这是通常对我有用的解决方案：在配置管理器中将所有内容设置为正确的平台（活动配置下拉菜单，通常说调试，是一个很好的方法）和项目平台（在项目属性中），然后构建，然后将所有内容设置回 AnyCPU。有时我必须删除并重新添加一些依赖项（每个项目的属性中的 DLL），有时必须更改“在 32 位或 64 位进程中运行测试”（双击 Local.testsettings 并转到主机）。

在我看来，这只是设置一些东西然后将其设置回去，但幕后可能还有更多我没有看到的事情。不过，它在过去对我来说相当一致。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2014-02-25T12:01:22.930

我有类似的问题，它是由 MS UNIT Test DLL 引起的。我的 WPF 应用程序编译为 x86，但单元测试 DLL（引用的 EXE 文件）为“任何 CPU”。我更改了要为 x86 编译的单元测试 DLL（与 EXE 相同），它已被重新处理。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2015-04-24T15:50:51.457

由于 f.csproj 是基于命令构建的，因此您可能还会收到 MS Fakes 程序集的此警告，该程序集不容易解决。幸运[的是，Fakes xml 允许您在其中添加它](http://www.dotnetdust.blogspot.com/2015/04/how-to-ignore-mismatch-processor.html)。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2015-04-15T15:17:21.000

我解决了这个警告，将“配置管理器”更改为发布（混合平台）。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2015-03-10T11:18:44.833

我的构建中有一个非常相似的警告。我的项目设置为面向 .NET 4.5，在构建服务器上安装了 Windows 8.1 SDK（用于 .NET 4.5.1）。在将我的项目更新为 .NET 4.5.1 之后（对我来说这不是问题，是一个全新的应用程序），我不再收到警告......

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2015-05-20T15:57:55.113

编译 SQL Server 2012 SP1 SSIS 管道脚本任务时，我在 Visual Studio 2012 中收到此警告 - 直到我安装了 SQL Server 2012 SP2。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2017-09-18T07:09:47.977

我在 SQLite 打开连接时遇到了同样的问题，并且使用 Nuget 并安装了项目中使用的组件（SQLite）修复了它！尝试以这种方式安装您的组件并检查结果

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2020-08-30T20:55:21.543

只想为那些在这里找不到答案的人发帖解决了他们的问题。

运行应用程序时，请确保正确设置了解决方案平台下拉菜单。我的在 x86 上，这反过来又导致了我这个问题。

* * *

## 回答 #20

> 赞同：-1
> 
> 时间：2013-10-22T17:40:17.150

There should be a way to make a .NET EXE/DLL AnyCPU, and any unmanaged DLLs it depends on compiled both with x86 and x64, both bundled perhaps with different filenames and then the .NET module dynamically loading the correct one based on its runtime processor architecture. That would make AnyCPU powerful. If the C++ DLL only supports x86 or x64 then AnyCPU is of course pointless. But the bundling both idea I have yet to see implemented as the configuration manager does not even provide a means to build the same project twice with a different configuration/platform for multiple bundling allowing AnyCPU or even other concepts like any configuration to be possible.

# php - 在 PHP 中缩放一系列数字？

> ID：10113536
> 
> 赞同：1
> 
> 时间：2012-04-11T20:35:52.177
> 
> 标签：php, math

我正在开发一些 PHP 代码，它与一个正在时钟上移动物理指针的硬件进行通信。基本上，我有一个介于 000 和 180 之间的数字（分钟）范围，它们对应于伺服位置 000 到 180。

我面临的问题是我现在发现伺服只能移动到 000 到 165 之间的值。

有没有办法将 000 到 180 范围内的给定数字缩放到 000 到 165 范围内？我一直在为此绞尽脑汁，任何帮助将不胜感激。

示例函数：

```
function convertScale($handVal)
{
 //some code to convert scale from 000-180 to 000-165
 return $convertedPos;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-11T20:39:20.350

可以取浮点数吗？

```
function convertScale($handVal)
{
    return $handVal * 165.0 / 180.0;
} 
```

如果不是，希望四舍五入到最接近的整数是可以的：

```
function convertScale($handVal)
{
    return round($handVal * 165.0 / 180.0);
} 
```

*---编辑---*
正如评论中提到的，一个3位数的字符串很容易通过以下方式提供：

```
function convertScale($handVal)
{
    return sprintf ("%03d", round($handVal * 165.0 / 180.0));
} 
```

# csv - 修改 CSV 文件服务器端并另存为新的 CSV？

> ID：10113538
> 
> 赞同：0
> 
> 时间：2012-04-11T20:36:02.817
> 
> 标签：csv

我每小时都会将一些 csv 文件上传到我的服务器。我需要拿走这些，并从中创建其他文件。例如。

test.csv 有 3 列数据。我想完全删除第二列，然后将剩余的 2 列另存为自己的文件。text_changed.csv

在 linux 服务器上开发，但将站点转移到 windows 机器上。

不确定服务器操作系统在这里有多重要。我比任何其他编码语言都更了解 PHP，但我不是专业人士。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T20:43:37.507

CSV 文件只是遵循某些约定的普通文本文件。主要约定是：

*   逗号用于分隔列。
*   如果列（例如 Acme, Inc.）的文本中有逗号，则该列的文本必须用引号括起来。

如果您要自己解析 CSV 文件，还需要完全理解[一些规则。](http://en.wikipedia.org/wiki/Comma-separated_values)

幸运的是，PHP 为读取和处理 CSV 文件提供了一些内置支持。看一下：

[http://php.net/manual/en/function.fgetcsv.php](http://php.net/manual/en/function.fgetcsv.php)

[http://php.net/manual/en/function.fputcsv.php](http://php.net/manual/en/function.fputcsv.php)

您可能还想看看以下项目：

[http://code.google.com/p/php-csv-utils/](http://code.google.com/p/php-csv-utils/)

阅读文档，然后在此处发布更具体的问题。

# php - 如何在php中实现基于倒数计时器的函数调用？

> ID：10113542
> 
> 赞同：1
> 
> 时间：2012-04-11T20:36:08.073
> 
> 标签：php

我正在做一个项目，我必须每小时对数据库进行一些更新。那么我应该为此使用什么.. 我是否应该简单地使用 php，因为更新只会在服务器端完成。或者任何其他比我的方法更好的建议？

请帮忙 ！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T20:39:01.640

创建用于更新的 php 文件。:-)

如果需要，可以使用 php 编写日志文件或数据库。

您可以使用运行 php 文件`CRON JOB`并将其设置为每小时运行一次

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T20:39:03.053

如果你需要每小时完成一些事情，你需要一个调度器。查看 MySQL EVENT、linux cron 或 windows 调度程序。

一些虚拟主机不提供对这些设施的访问。然后，您可以尝试通过在上次运行作业时检查 php 页面来解决问题，并在需要时再次运行它。当然，这仅在您的网站有访问者时才有效 - 没有访问者 = 页面没有被执行。

Drupal 和其他 CMS 在他们的代码中有这个 php-cron-simulator。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-11T20:38:11.407

听起来像是 cron 的工作（假设 *nix）。

# heroku - 我可以在 heroku 中安装 Cruisecontrol.rb 吗？

> ID：10113546
> 
> 赞同：0
> 
> 时间：2012-04-11T20:36:21.397
> 
> 标签：heroku, cruisecontrol.rb

我可以在 heroku 中部署 Cruisecontrol.rb

Cruisecontrol rb 使用 GIT 并运行 shell 命令。

heroku 会允许这样做吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T14:13:03.840

TL;DR：不，你不能。

Heroku 的堆栈通常使用[只读文件系统](https://devcenter.heroku.com/articles/read-only-filesystem)，即使是最近使用新的[临时文件系统](https://devcenter.heroku.com/articles/dyno-isolation#ephemeral_filesystem)的堆栈也不会在 dyno 之间或在 dyno 重新启动之间保留数据。缺乏具有数据持久性的可写文件系统，使得在 Heroku 上运行持续集成变得不可能。

# selenium - 用于 TeamCity 的 Selenium 结果的 XSLT

> ID：10113550
> 
> 赞同：0
> 
> 时间：2012-04-11T20:36:25.753
> 
> 标签：selenium, automated-tests, teamcity

我已经让我们的 TeamCity 构建服务器从命令行成功执行 Selenium 套件，我希望将结果发布回 TeamCity。

是否有用于获取 Selenium 的结果并将其转换为 TeamCity 可以读取的格式的 XSLT？[我在类似的问题](https://stackoverflow.com/a/6571851/3256)中看到了有关使用 nxslt3.exe 执行此操作的内容，但我在任何地方都找不到模板

***注意****：我不能使用 Selenium IDE 的 c# 导出功能，我必须使用 html 模板来执行测试。*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T11:57:20.237

我们的 Play 项目 Selenium 测试也遇到了同样的问题。他们将结果作为测试的 HTML 文件返回，我无法轻松地将其导入 TeamCity。为了解决这个问题，我编写了一个解析器，它解析 HTML 文件并通过服务消息将测试结果输出到 TeamCity。

有关更多信息，请参阅此博客文章：http: [//q42.nl/importing-play-selenium-tests-in-teamcity](http://q42.nl/importing-play-selenium-tests-in-teamcity)或[https://github.com/crunchie84/play-seleniumresults-parser](https://github.com/crunchie84/play-seleniumresults-parser)直接下载工具/源代码

# heroku - 建立我个人的“heroku”或“fluxflex”之类的？

> ID：10113554
> 
> 赞同：2
> 
> 时间：2012-04-11T20:36:35.417
> 
> 标签：heroku, paas

我想（通过实践）了解 heroku、fluxflex 以及所有 PaaS 的工作原理。我的意思是，我如何构建自己的“heroku”、“fluxflex”、GAE ......我需要知道/学习/阅读什么？我见过 appscale，但我想建立自己的。

基本上我想做的是：

*   用户注册
*   他导入/上传一个应用程序（仅允许的框架，例如 django、ror、node），该应用程序已安装。
*   一切都是可扩展的......

问候！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-11T21:08:36.147

谷歌搜索“Heroku 架构”和“Openshift 架构”分别得到了[这个](https://devcenter.heroku.com/articles/architecture-overview)，[这个](http://docs.redhat.com/docs/en-US/OpenShift/2.0/html/User_Guide/chap-User_Guide-OpenShift_Architecture_Overview.html)。[CloudFoundry](http://www.cloudfoundry.com/getinvolved)是托管在 Github 上的开源 PaaS，他们有一个很好的博客来描述 CloudFoundry 的工作原理。希望有帮助。干杯。

# java - 使用 MongoDB 将新数组删除并添加到 JSON 对象中

> ID：10113558
> 
> 赞同：1
> 
> 时间：2012-04-11T20:37:00.997
> 
> 标签：java, json, spring, mongodb

我有 JSON 对象：

> {“_id”：“1”，“_class”：“com.model.Test”，“projectList”：[{“projectID”：“Spring”，“resourceIDList”：[“Mark”，“David”]}， {“projectID”：“MongoDB”，“resourceIDList”：[“Nosa]}

我需要能够删除项目“Spring”的 resourceIDList 并分配一个新的 ResourceIDList。

ResourceIDList 只是列表

每当我尝试使用以下内容时，DB 都没有更新：

```
 Query query = new Query(where("_id").is("1").and("projectID").is("Spring"));    

 mongoOperations.updateMulti( query,new Update().set("ressourceIDList",  populateResources()), Test.class); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T21:53:31.853

替换嵌入文档中匹配 {"projectList.projectID":"Spring"} 的 resourceIDList 可以在 JavaScript shell 中完成，如下所示：（我喜欢从 JS shell 开始，因为它比 Java 更简洁，语法是相对简单。然后可以将 JS 的示例应用于任何语言驱动程序。）

```
> db.collection.update({_id:"1", "projectList.projectID":"Spring"}, {$set:{"projectList.$.resourceIDList":["Something", "new"]}}) 
```

有关使用“$”运算符修改嵌入文档的文档可以在“更新”文档的“$ 位置运算符”部分找到： [http ://www.mongodb.org/display/DOCS/Updating#Updating- The%24positionaloperator](http://www.mongodb.org/display/DOCS/Updating#Updating-The%24positionaloperator) 在“Dot Notation (Reaching into Objects)”文档中有更多关于嵌入文档的信息： [http ://www.mongodb.org/display/DOCS/Dot+Notation+%28Reaching+into+Objects%29](http://www.mongodb.org/display/DOCS/Dot+Notation+%28Reaching+into+Objects%29)

以上可以在Java驱动程序中完成，如下所示：

```
Mongo m = new Mongo("localhost", 27017);
DB db = m.getDB("test");
DBCollection myColl = db.getCollection("collection");
ArrayList<String> newResourceIDList = new ArrayList<String>();
newResourceIDList.add("Something");
newResourceIDList.add("new");
BasicDBObject myQuery = new BasicDBObject("_id", "1");
myQuery.put("projectList.projectID", "Spring");
BasicDBObject myUpdate = new BasicDBObject("$set", new BasicDBObject("projectList.$.resourceIDList", newResourceIDList));
myColl.update(myQuery, myUpdate);
System.out.println(myColl.findOne().toString()); 
```

如果您有多个匹配 {"projectList.projectID" : "Spring"} 的文档，您可以使用 multi = true 选项一次更新它们。使用 Java 驱动程序，它看起来像这样：

```
myColl.update(myQuery, myUpdate, false, true); 
```

上面“false”代表“upsert=false”，“true”代表“multi=true”。这在“更新”命令的文档中进行了解释： [http ://www.mongodb.org/display/DOCS/Updating#Updating-update%28%29](http://www.mongodb.org/display/DOCS/Updating#Updating-update%28%29)

不幸的是，我不熟悉 Spring 框架，所以我无法告诉您如何使用“mongoOperations”类来做到这一点。希望以上内容能增进您对如何在 Mongo 中更新嵌入式文档的理解，并且您将能够完成您需要使用 Spring 完成的工作。

# php - 显示实时页面查看者的数量

> ID：10113561
> 
> 赞同：2
> 
> 时间：2012-04-11T20:37:23.193
> 
> 标签：php, javascript, jquery, ajax, server-side

> **可能重复：**
> [如何使用 java 脚本或 php 计算站点当前访问者](https://stackoverflow.com/questions/4649926/how-to-count-the-site-current-visitors-using-java-script-or-php)

我的网站上有一个嵌入式流，但我想在页面上提取实时观众的数量。有没有办法用 PHP / AJAX 来做到这一点，显示当前查看我的网页的人数？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-11T21:00:39.200

免责声明：很久以前我做过类似的事情，所以这里是丑陋的旧代码（我不会努力使看起来更好/不是当我第一次开始编程时，因为这只是为了让你了解如何做到这一点，而不是用勺子喂任何特定的代码）。

```
$timeout = time() - (20);

$sessid_exist = mysql_query("SELECT sessid FROM bw_sessions WHERE sessid='" . session_id() . "'") or die (mysql_error());
$sessid_check = mysql_num_rows($sessid_exist);

if ($_SESSION['bw_username']) {
                $sql = mysql_query("UPDATE bw_sessions SET timestamp='" . time() . "', username='" . $_SESSION['bw_username'] . "' WHERE sessid='" . session_id() . "'");
} else {
  if($sessid_check > 0){
                $sql = mysql_query("UPDATE bw_sessions SET timestamp='" . time() . "' WHERE sessid='" . session_id() . "'");
              } else {
              $sql = mysql_query("INSERT INTO bw_sessions (id, username, sessid, timestamp, ip)
        VALUES(null, '', '" . session_id() . "', '" . time() . "', '" . $_SERVER['REMOTE_ADDR'] . "')") or die (mysql_error());
          }
}

$sql = mysql_query("SELECT distinct sessid FROM bw_sessions WHERE username='' AND timestamp >= '$timeout' ORDER BY timestamp DESC") or die (mysql_error());
$sql2 = mysql_query("SELECT distinct sessid,username FROM bw_sessions WHERE username!='' AND timestamp >= '$timeout' ORDER BY username DESC") or die (mysql_error());
$num_guests = mysql_num_rows($sql);
$num_reg = mysql_num_rows($sql2);
?>

<font size='1'>Currently Online: <br>
                        <?=$num_guests;?> Guests<br>
                        <?=$num_reg;?> Registered users 
```

您只需要创建一个表并保存 session_id's.. 然后查询该表以获取任何“最近”活动。如果您想要实时更新，请将上面的代码（修改为您的表格设计）放在“online.php”中，并每隔 x 秒通过 jquery 调用它，或者您决定这样做。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-11T20:39:49.187

像[Clicky](http://getclicky.com/)这样的东西应该适合你。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-11T21:10:47.393

如果你在某个地方看到过，它可能是可能的，而且这种东西内置在大多数论坛软件中，并且在很多网站上都有使用，所以它可能并不难。

[这样做的常用方法是从$_SERVER['REMOTE_ADDR']](http://php.net/manual/en/reserved.variables.server.php)获取已连接访问者的 IP，然后将其写入文件，并将所有唯一 IP 相加以找出有多少人已连接。这将需要某种清理功能来删除任何不再连接的 IP。

该脚本在页面加载时运行，并对文件中的访问者进行计数，因此，如果使用 ajax，您会运行一个 PHP 脚本，每隔一段时间轮询该文件以动态更新计数，或者您可以在页面加载时执行此操作，但是 ajax 不是必需的，因为你可以用 PHP 来做。

如果您还不知道如何操作，那么首先要做的是弄清楚如何在[$.ajax](http://api.jquery.com/jQuery.ajax/)中运行 PHP 脚本，然后编写一个统计访问者的函数可能是下一个。

我在搜索这样一个脚本时获得了 2.44 亿次点击，[这里](http://www.roscripts.com/How_many_visitors_online_PHP_script-108.html)和[这里](http://www.sitepoint.com/forums/showthread.php?700163-How-to-Count-Number-of-Visitors-Viewing-My-Site)都有一个。

# php - PDO MySQL：是否使用 PDO::ATTR_EMULATE_PREPARES？

> ID：10113562
> 
> 赞同：127
> 
> 时间：2012-04-11T20:37:33.943
> 
> 标签：php, mysql, pdo

这是我到目前为止所读到的[`PDO::ATTR_EMULATE_PREPARES`](http://www.php.net/manual/en/pdo.setattribute.php)：

1.  [由于 MySQL 的本机准备绕过查询缓存，因此 PDO 的准备模拟性能更好](https://stackoverflow.com/a/5751895)。
2.  [MySQL 的原生 prepare 更好的安全性（防止 SQL 注入）](https://stackoverflow.com/a/1314549)。
3.  [MySQL 的原生 prepare 更适合错误报告](https://stackoverflow.com/questions/3727186/the-way-pdo-parametrized-query-works)。

我不知道这些陈述中的任何一个是否真实。在选择 MySQL 接口时，我最关心的是防止 SQL 注入。第二个问题是性能。

我的应用程序目前使用过程 MySQLi（没有准备好的语句），并且相当多地利用查询缓存。它很少会在单个请求中重用准备好的语句。我开始迁移到 PDO 以获取命名参数和准备好的语句的安全性。

我正在使用`MySQL 5.1.61`和`PHP 5.3.2`

我应该`PDO::ATTR_EMULATE_PREPARES`启用还是不启用？有没有办法兼顾查询缓存的性能和准备好的语句的安全性？

* * *

## 回答 #1

> 赞同：115
> 
> 时间：2012-05-04T19:48:39.450

回答您的疑虑：

1.  MySQL >= 5.1.17 (or >= 5.1.21 for the `PREPARE`and `EXECUTE`statements)[可以在查询缓存中使用准备好的语句](http://dev.mysql.com/doc/refman/5.1/en/query-cache-operation.html)。所以你的 MySQL+PHP 版本可以使用带有查询缓存的准备好的语句。但是，请仔细注意 MySQL 文档中缓存查询结果的注意事项。有很多种查询不能被缓存或者即使被缓存也无用。以我的经验，查询缓存通常并不是一个很大的胜利。查询和模式需要特殊的结构才能最大限度地利用缓存。从长远来看，通常应用程序级缓存最终是必要的。

2.  本机准备对安全性没有任何影响。伪准备语句仍将转义查询参数值，它只是在 PDO 库中使用字符串而不是在 MySQL 服务器上使用二进制协议完成。换句话说，无论您的`EMULATE_PREPARES`设置如何，相同的 PDO 代码都同样容易受到（或不易受到）注入攻击。唯一的区别是参数替换发生在哪里——使用`EMULATE_PREPARES`，它发生在 PDO 库中；没有`EMULATE_PREPARES`，它发生在 MySQL 服务器上。

3.  如果没有`EMULATE_PREPARES`，您可能会在准备时而不是在执行时遇到语法错误；与`EMULATE_PREPARES`您只会在执行时出现语法错误，因为 PDO 直到执行时才向 MySQL 提供查询。请注意，*这会影响您将编写的代码*！特别是如果你正在使用`PDO::ERRMODE_EXCEPTION`！

一个额外的考虑：

*   `prepare()`a （使用本机预准备语句）有固定成本，因此使用本`prepare();execute()`机预准备语句的 a 可能比使用模拟预准备语句发出纯文本查询要慢一些。在许多数据库系统上，a 的查询计划`prepare()`也被缓存，并且可能与多个连接共享，但我认为 MySQL 不会这样做。因此，如果您不为多个查询重用准备好的语句对象，您的整体执行可能会更慢。

**作为最后的建议**，我认为对于旧版本的 MySQL+PHP，您应该模拟准备好的语句，但是对于您最近的版本，您应该关闭模拟。

在编写了一些使用 PDO 的应用程序之后，我制作了一个 PDO 连接功能，它具有我认为最好的设置。您可能应该使用类似的东西或调整您的首选设置：

```
/**
 * Return PDO handle for a MySQL connection using supplied settings
 *
 * Tries to do the right thing with different php and mysql versions.
 *
 * @param array $settings with keys: host, port, unix_socket, dbname, charset, user, pass. Some may be omitted or NULL.
 * @return PDO
 * @author Francis Avila
 */
function connect_PDO($settings)
{
    $emulate_prepares_below_version = '5.1.17';

    $dsndefaults = array_fill_keys(array('host', 'port', 'unix_socket', 'dbname', 'charset'), null);
    $dsnarr = array_intersect_key($settings, $dsndefaults);
    $dsnarr += $dsndefaults;

    // connection options I like
    $options = array(
        PDO::ATTR_ERRMODE => PDO::ERRMODE_EXCEPTION,
        PDO::ATTR_DEFAULT_FETCH_MODE => PDO::FETCH_ASSOC
    );

    // connection charset handling for old php versions
    if ($dsnarr['charset'] and version_compare(PHP_VERSION, '5.3.6', '<')) {
        $options[PDO::MYSQL_ATTR_INIT_COMMAND] = 'SET NAMES '.$dsnarr['charset'];
    }
    $dsnpairs = array();
    foreach ($dsnarr as $k => $v) {
        if ($v===null) continue;
        $dsnpairs[] = "{$k}={$v}";
    }

    $dsn = 'mysql:'.implode(';', $dsnpairs);
    $dbh = new PDO($dsn, $settings['user'], $settings['pass'], $options);

    // Set prepared statement emulation depending on server version
    $serverversion = $dbh->getAttribute(PDO::ATTR_SERVER_VERSION);
    $emulate_prepares = (version_compare($serverversion, $emulate_prepares_below_version, '<'));
    $dbh->setAttribute(PDO::ATTR_EMULATE_PREPARES, $emulate_prepares);

    return $dbh;
} 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2019-11-13T03:47:12.153

我很惊讶没有人提到关闭仿真的最大原因之一。启用仿真后，PDO 将所有整数和浮点数作为*字符串*返回。当您关闭仿真时，MySQL 中的整数和浮点数在 PHP 中变为整数和浮点数。

有关更多信息，请参阅此问题的公认答案：[PHP + PDO + MySQL：如何将 MySQL 中的整数和数字列作为整数和数字在 PHP 中返回？](https://stackoverflow.com/q/20079320/1274625).

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2016-09-29T19:36:22.767

`PDO::ATTR_EMULATE_PREPARES`当您的 PHP未`pdo_mysql`针对`mysqlnd`.

由于 old`libmysql`与某些功能不完全兼容，可能会导致奇怪的 bug，例如：

1.  绑定时丢失 64 位整数的最高有效位`PDO::PARAM_INT`（0x12345678AB 在 64 位机器上将被裁剪为 0x345678AB）
2.  无法进行简单的查询，例如`LOCK TABLES`（它抛出`SQLSTATE[HY000]: General error: 2030 This command is not supported in the prepared statement protocol yet`异常）
3.  需要在下一个查询之前从结果中获取所有行或关闭游标（ with`mysqlnd`或 emulated 会自动为您完成这项工作并且不会与 mysql 服务器不同步）

`libmysql`当迁移到用于`pdo_mysql`模块的其他服务器时，我在我的简单项目中发现了这些错误。也许还有更多的错误，我不知道。我还在新的 64 位 debian jessie 上进行了测试，所有列出的错误都在 I 时出现`apt-get install php5-mysql`，而在 I 时消失`apt-get install php5-mysqlnd`。

When`PDO::ATTR_EMULATE_PREPARES`设置为 true（默认）- 这些错误无论如何都不会发生，因为 PDO 在此模式下根本不使用准备好的语句。因此，如果您使用`pdo_mysql`基于`libmysql`（“mysqlnd”子字符串未出现`pdo_mysql`在 phpinfo 部分的“客户端 API 版本”字段中） - 您不应该`PDO::ATTR_EMULATE_PREPARES`关闭。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2012-05-04T09:06:32.937

我会在您运行 5.1 时关闭 emulate prepares，这意味着 PDO 将利用本机准备好的语句功能。

> PDO_MYSQL 将利用 MySQL 4.1 及更高版本中存在的本机准备语句支持。如果您使用的是旧版本的 mysql 客户端库，PDO 将为您模拟它们。

[http://php.net/manual/en/ref.pdo-mysql.php](http://php.net/manual/en/ref.pdo-mysql.php)

为了准备好命名语句和更好的 API，我放弃了 MySQLi 使用 PDO。

然而，为了平衡，PDO 的执行速度比 MySQLi 慢得可以忽略不计，但需要牢记这一点。当我做出选择时，我就知道这一点，并决定使用更好的 API 和使用行业标准比使用速度快得可以忽略不计的库将您绑定到特定引擎更重要。FWIW 我认为 PHP 团队也看好 PDO 而不是 MySQLi 的未来。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2014-07-15T05:27:44.303

我建议启用真正的数据库`PREPARE`调用，因为仿真无法捕获所有内容..，例如，它会准备`INSERT;`！

```
var_dump($dbh->prepare('INSERT;'));
$dbh->setAttribute(PDO::ATTR_EMULATE_PREPARES, false);
var_dump($dbh->prepare('INSERT;')); 
```

输出

```
object(PDOStatement)#2 (1) {
  ["queryString"]=>
  string(7) "INSERT;"
}
bool(false) 
```

我很乐意对实际有效的代码进行性能打击。

**FWIW**

PHP 版本：PHP 5.4.9-4ubuntu2.4 (cli)

MySQL 版本：5.5.34-0ubuntu0

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2018-06-15T01:10:11.180

> ## 为什么将仿真切换为“假”？
> 
> 这样做的主要原因是让数据库引擎进行准备而不是 PDO 是查询和实际数据是分开发送的，这增加了安全性。这意味着当参数被传递给查询时，尝试向其中注入 SQL 的尝试会被阻止，因为 MySQL 准备好的语句仅限于单个查询。这意味着当在参数中传递第二个查询时，真正的准备好的语句将失败。
> 
> 反对使用数据库引擎进行准备与 PDO 的主要论点是两次访问服务器——一次用于准备，另一次用于传递参数——但我认为增加的安全性是值得的。此外，至少在 MySQL 的情况下，查询缓存从 5.1 版开始就不是问题了。

[https://tech.michaelseiler.net/2016/07/04/dont-emulate-prepared-statements-pdo-mysql/](https://tech.michaelseiler.net/2016/07/04/dont-emulate-prepared-statements-pdo-mysql/)

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2020-07-27T14:55:11.890

作为记录

PDO::ATTR_EMULATE_PREPARES=true

它可能会产生令人讨厌的副作用。它可以将 int 值作为字符串返回。

PHP 7.4，带有 mysqlnd 的 pdo。

### 使用 PDO::ATTR_EMULATE_PREPARES=true 运行查询

列：id
类型：整
数值：1

### 使用 PDO::ATTR_EMULATE_PREPARES=false 运行查询

列：id
类型：字符串
值：“1”

在任何情况下，无论配置如何，十进制值总是返回一个字符串:-(

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-12-27T18:53:24.950

如果您有多个绑定参数，第一个肯定是正确的。我有一个带有 11 个参数的 SQL，并且没有模拟准备它需要 5 秒。启用模拟准备后，它下降到 0.25 秒。

尽管应该为 PHP 7.4.11 解决类似的问题[https://bugs.php.net/bug.php?id=80027 ，但升级到 PHP 7.4.27 后问题仍然存在。](https://bugs.php.net/bug.php?id=80027)

# c++ - 按值传递容器是否会使迭代器无效？

> ID：10113572
> 
> 赞同：7
> 
> 时间：2012-04-11T20:38:10.030
> 
> 标签：c++, iterator, containers

这是一些示例代码：

```
#include <iostream>
#include <vector>

template <typename T>
std::vector<typename T::iterator> f(T t)
{
        std::vector<typename T::iterator> v;
        for (auto i = t.begin(); i != t.end(); ++i)
        {
                v.push_back(i);
        }
        return v;
}

template <typename T>
void print(const std::vector<T>& v)
{
        for (auto i = v.begin(); i != v.end(); ++i)
        {
                std::cout << **i << ' ';
        }
        std::cout << std::endl;
}

int main()
{
        std::vector<int> v{1, 2, 3};
        print(f(v));
        std::vector<std::vector<int>::iterator> itervec = f(v);
        print(itervec);
} 
```

在[ideone](http://ideone.com/JRkCR)上，输出是：

```
1 2 3 
163487776 2 3 
```

**问题**

如果我按预期更改`f(T t)`输出`f(T& t)`。我假设因为我正在使用容器的副本，从技术上讲，我在向量上推回的迭代器与我在 main 中创建的向量不同。它是否正确？我注意到的一件事是按预期`print(f(v));`打印`1 2 3`，但是一旦我将它分配给`itervec`第一个迭代器就变成垃圾，这是否全部依赖于实现？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-11T20:41:51.400

是的，迭代器是*只*对函数中的本地对象有效的迭代器，并且在`v`函数`f`的末尾`f`，`v`超出范围并被销毁，并且迭代器是无效的。

您必须通过引用（或指针或其他）传递向量，以便您存储的迭代器是调用者传入的原始对象的迭代器，而不是存储在局部变量中的临时副本。

您看到的行为是未定义的，因此它恰好正确地打印了前三个和后两个。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-11T20:41:15.970

是的，因为您正在接收一个临时文件并返回该临时文件的迭代器。函数退出后，临时被清理，使迭代器无效。

但是，如果您同时获得了引用`main`并且`print`正在访问**同一个对象**。由于此对象在函数退出后仍然存在，因此迭代器不会失效。

# ruby-on-rails-3 - rSpec 在套件完成后销毁文件

> ID：10113579
> 
> 赞同：8
> 
> 时间：2012-04-11T20:38:40.183
> 
> 标签：ruby-on-rails-3, paperclip, rspec-rails

在我的 rSpec 测试中，我测试了回形针将照片上传到我的系统并使用给定用户保存它们的能力。

这很好，但是在我的测试完成后，我的系统上有所有这些额外的文件。我如何在我的测试套件完成后自动删除它。

谢谢迈克

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-11-09T07:38:18.837

删除整个`test`目录更简单。另外，开销*略*少，更易于阅读。

```
# spec_helper.rb

config.after(:suite) do
  FileUtils.rm_rf(Dir["#{Rails.root}/public/system/test"])
end 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-04T18:55:20.620

我没有使用 Paperclip，但我假设这些文件保存在一个比较固定的位置，例如（随机示例）**tmp/paperclip/photos/**。

如果是这种情况，在您的 spec_helper 中，您可以添加：

```
config.after(:suite) do # or :each or :all
    Dir["#{Rails.root}/tmp/paperclip/**/*"].each do |file|
        File.delete(file)
    end
end 
```

# jquery - 使用 jquery 提取 textarea 值时遇到问题

> ID：10113583
> 
> 赞同：0
> 
> 时间：2012-04-11T20:38:51.000
> 
> 标签：jquery, textarea

我正在尝试使用 jquery 从 textarea 中提取值，但我的调试器一直说我的变量`questVal`未定义。有任何想法吗？这是代码：

```
approveThis:function(event) {
var thisId = parseInt(event.target.id.replace('app', ''));
var questId = thisId;
var questSelect = '#questID' + questId;
var questVal = $(questSelect).val();
$.ajax({
    url:"includes/php/whatifApprove.php",
    data:{ approving:true, idNum:thisId, questionName:questVal }, 
    type:"POST",
    cache:false,
    success: function(data){
        console.log(questVal);
        $('#testMessages').html(data);
    }
});
return false; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T20:40:51.027

您确实没有提供足够的信息，但总的来说，这意味着当您提供

`$(questSelect).val();`

它返回未定义。你没有选择你认为你正在选择的东西。

我会在`approveThis`函数的第一行放置一个调试器，然后逐行执行，确保一切都符合您的预期。

# c# - 比较 Type.GetProperties() 中的 PropertyInfo 和 lambda 表达式

> ID：10113584
> 
> 赞同：11
> 
> 时间：2012-04-11T20:38:56.113
> 
> 标签：c#, reflection, equality

在创建我的测试框架时，我发现了一个奇怪的问题。

我想创建一个静态类，它允许我通过属性比较相同类型的对象，但有可能忽略其中的一些。

我想为此提供一个简单的流利的 API，因此如果给定的对象在除and`TestEqualityComparer.Equals(first.Ignore(x=>x.Id).Ignore(y=>y.Name), second);`之外的每个属性上都相等，则调用 like 将返回 true （不会检查它们是否相等）。`Id``Name`

这是我的代码。当然这是一个微不足道的例子（缺少一些**明显**的方法重载），但我想提取最简单的代码。真实的案例场景有点复杂，所以我真的不想改变方法。

该方法`FindProperty`几乎是来自[AutoMapper library](http://automapper.org/)的复制粘贴。

流式 API 的对象包装器：

```
public class TestEqualityHelper<T>
{
    public List<PropertyInfo> IgnoredProps = new List<PropertyInfo>();
    public T Value;
} 
```

流利的东西：

```
public static class FluentExtension
{
    //Extension method to speak fluently. It finds the property mentioned
    // in 'ignore' parameter and adds it to the list.
    public static TestEqualityHelper<T> Ignore<T>(this T value,
         Expression<Func<T, object>> ignore)
    {
        var eh = new TestEqualityHelper<T> { Value = value };

        //Mind the magic here!
        var member = FindProperty(ignore);
        eh.IgnoredProps.Add((PropertyInfo)member);
        return eh;
    }

    //Extract the MemberInfo from the given lambda
    private static MemberInfo FindProperty(LambdaExpression lambdaExpression)
    {
        Expression expressionToCheck = lambdaExpression;

        var done = false;

        while (!done)
        {
            switch (expressionToCheck.NodeType)
            {
                case ExpressionType.Convert:
                    expressionToCheck 
                        = ((UnaryExpression)expressionToCheck).Operand;
                    break;
                case ExpressionType.Lambda:
                    expressionToCheck
                        = ((LambdaExpression)expressionToCheck).Body;
                    break;
                case ExpressionType.MemberAccess:
                    var memberExpression 
                        = (MemberExpression)expressionToCheck;

                    if (memberExpression.Expression.NodeType 
                          != ExpressionType.Parameter &&
                        memberExpression.Expression.NodeType 
                          != ExpressionType.Convert)
                    {
                        throw new Exception("Something went wrong");
                    }

                    return memberExpression.Member;
                default:
                    done = true;
                    break;
            }
        }

        throw new Exception("Something went wrong");
    }
} 
```

实际比较器：

```
public static class TestEqualityComparer
{
    public static bool MyEquals<T>(TestEqualityHelper<T> a, T b)
    {
        return DoMyEquals(a.Value, b, a.IgnoredProps);
    }

    private static bool DoMyEquals<T>(T a, T b,
        IEnumerable<PropertyInfo> ignoredProperties)
    {
        var t = typeof(T);
        IEnumerable<PropertyInfo> props;

        if (ignoredProperties != null && ignoredProperties.Any())
        {
            //THE PROBLEM IS HERE!
            props =
                t.GetProperties(BindingFlags.Instance | BindingFlags.Public)
                    .Except(ignoredProperties);
        }
        else
        {
            props = 
                t.GetProperties(BindingFlags.Instance | BindingFlags.Public);
        }
        return props.All(f => f.GetValue(a, null).Equals(f.GetValue(b, null)));
    }
} 
```

基本上就是这样。

这里有两个测试片段，第一个有效，第二个失败：

```
//These are the simple objects we'll compare
public class Base
{
    public decimal Id { get; set; }
    public string Name { get; set; }
}
public class Derived : Base
{    }

[TestMethod]
public void ListUsers()
{
   //TRUE
   var f = new Base { Id = 5, Name = "asdas" };
   var s = new Base { Id = 6, Name = "asdas" };
   Assert.IsTrue(TestEqualityComparer.MyEquals(f.Ignore(x => x.Id), s));

   //FALSE
   var f2 = new Derived { Id = 5, Name = "asdas" };
   var s2 = new Derived { Id = 6, Name = "asdas" };
   Assert.IsTrue(TestEqualityComparer.MyEquals(f2.Ignore(x => x.Id), s2));
} 
```

问题出在中的`Except`方法上`DoMyEquals`。

返回的属性`FindProperty`不等于返回的属性`Type.GetProperties`。我发现的不同之处在于`PropertyInfo.ReflectedType`.

*   无论我的对象的类型如何，都`FindProperty`告诉我反射的类型是`Base`.

*   `Type.GetProperties`由返回的属性`ReflectedType`设置为`Base`or `Derived`，具体取决于实际对象的类型。

我不知道如何解决它。我可以检查 lambda 中参数的类型，但在下一步中我想允许像 一样的构造`Ignore(x=>x.Some.Deep.Property)`，所以它可能不会这样做。

任何有关如何比较`PropertyInfo`'s 或如何正确从 lambdas 中检索它们的建议将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-11T21:14:40.527

原因`FindProperty`告诉您反映`Type`的`Base`是因为那是 lambda 将用于调用的类。

你可能知道这一点:)

代替 Type 中的 GetProperties()，你能用这个吗

```
static IEnumerable<PropertyInfo> GetMappedProperties(Type type)
{
  return type
    .GetProperties()
    .Select(p => GetMappedProperty(type, p.Name))
    .Where(p => p != null);
}

static PropertyInfo GetMappedProperty(Type type, string name)
{
  if (type == null)
    return null;

  var prop = type.GetProperty(name);

  if (prop.DeclaringType == type)
    return prop;
  else
    return GetMappedProperty(type.BaseType, name);
} 
```

为了解释更多关于为什么 lambda 实际上直接使用 Base 方法，并且您看到本质上不同的 PropertyInfo，可能会更好地解释查看 IL

考虑这段代码：

```
static void Foo()
{
  var b = new Base { Id = 4 };
  var d = new Derived { Id = 5 };

  decimal dm = b.Id;
  dm = d.Id;
} 
```

这是 b.Id 的 IL

```
IL_002f: callvirt instance valuetype [mscorlib]System.Decimal ConsoleApplication1.Base::get_Id() 
```

和 d.Id 的 IL

```
IL_0036: callvirt instance valuetype [mscorlib]System.Decimal ConsoleApplication1.Base::get_Id() 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-13T05:35:31.380

不知道这是否有帮助，但我注意到两个 PropertyInfo 实例的 MetaDataToken 属性值是相等的，如果两个实例都引用相同的逻辑属性，而不管其中一个的 ReflectedType 是什么。即两个 PropertyInfo 实例的 Name、PropertyType、DeclaringType 和 index 参数都是相等的。

# c++ - 如何使用 CLANG 作为解析器并使用 Python 作为脚本语言来解析 C++ 代码中的宏？

> ID：10113586
> 
> 赞同：14
> 
> 时间：2012-04-11T20:39:02.133
> 
> 标签：c++, python, api, parsing, clang

如果我在某些 C++ 代码中有以下宏：

```
_Foo(arg1, arg2) 
```

我想使用 Python 使用 Clang 和 cindex.py 提供的 Python 绑定来查找该宏的所有实例和范围。我不想直接在代码上使用 Python 中的正则表达式，因为这让我达到了 99%，但不是 100%。在我看来，要达到 100%，您需要使用真正的 C++ 解析器（如 Clang）来处理人们执行语法正确和编译但对正则表达式没有意义的愚蠢事情的所有情况。我需要处理 100% 的情况，并且由于我们使用 Clang 作为我们的编译器之一，因此将它用作此任务的解析器也是有意义的。

鉴于以下 Python 代码，我能够找到 Clang python 绑定知道的似乎是预定义类型，但不是宏：

```
def find_typerefs(node):
    ref_node = clang.cindex.Cursor_ref(node)
    if ref_node:
        print 'Found %s Type %s DATA %s Extent %s [line=%s, col=%s]' % (
            ref_node.spelling, ref_node.kind, node.data, node.extent, node.location.line, node.location.column)

# Recurse for children of this node
for c in node.get_children():
    find_typerefs(c)

index = clang.cindex.Index.create()
tu = index.parse(sys.argv[1])
find_typerefs(tu.cursor) 
```

我想我正在寻找的是一种将原始 AST 解析为我的宏名称的方法`_FOO()`，但我不确定。有人可以提供一些代码让我以宏的名称传递并从 Clang 取回范围或数据吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-06-28T20:44:02.263

您需要将适当的`options`标志传递给`Index.parse`：

```
tu = index.parse(sys.argv[1], options=clang.cindex.TranslationUnit.PARSE_DETAILED_PROCESSING_RECORD) 
```

光标访问者的其余部分可能如下所示：

```
def visit(node):
    if node.kind in (clang.cindex.CursorKind.MACRO_INSTANTIATION, clang.cindex.CursorKind.MACRO_DEFINITION):
        print 'Found %s Type %s DATA %s Extent %s [line=%s, col=%s]' % (node.displayname, node.kind, node.data, node.extent, node.location.line, node.location.column)
    for c in node.get_children():
        visit(c) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-25T19:09:08.400

我曾经写了一个脚本来漂亮地打印你从 libclang 获得的整个 AST，以便查看在哪里可以找到哪些信息。

这是：[https ://gist.github.com/2503232](https://gist.github.com/2503232)

# c++ - 如何用类对象填充数组结构？

> ID：10113594
> 
> 赞同：0
> 
> 时间：2012-04-11T20:39:23.060
> 
> 标签：c++, oop

我有这个结构（数组），我想用 Class 对象填充。完成它的程序是什么。我使用的教程/书籍没有那么详细，我不知道该怎么做。（因为我的尝试失败了）

数组结构 struct.h

```
struct Arr{

    int days;
    int *M;
};
typedef Arr* Array; 
```

结构体.cpp

```
void constr(Array &o){
    //Construct of 1*31 Matrix
    o=new Arr;
    o->days = days;
    o->M = new int[o->days]; 
```

班级

exp.h

```
class Expe {
private:
    int *obj;

public:
    Expe();
    ~Expe();

    void setObj(int ,int ,int ,int ,int ,int);
    void printObj();
    int getObj();
enter code here 
```

exp.cpp

```
Expe::Expe() {
    this->obj=new int[6];
}

Expe::~Expe() {
    delete this->obj;
} 
```

ps：我需要使用我自己的struct vector.h 是不允许的，它必须是动态的

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T20:44:32.613

就像现在的代码一样，您的`Arr`结构可以保存一个整数数组。如果您希望它保存`Expe`对象，您可以将其定义为：

```
struct Arr{
    int days;
    Expe* M;
}; 
```

或者，更好的是，将其设为模板类：

```
template<typename T>
struct Arr
{
    int _size;
    T* M;
}; 
```

我还建议将构造函数移到*内部*而`struct`不是方法中`constr`：

```
template<typename T>
struct Arr
{
    int _size;
    T* M;
    Arr(int size) : _size(size)
    {
        M = new T[size];
    }
    //manage the memory:
    ~Arr()
    {
        delete[] M;
    }
}; 
```

通过使用模板，您可以根据需要进行专业化`Arr`：

```
Arr<int> x(10);  //creates an array of 10 int's
Arr<Expe> y(10); //creates an array of 10 Expe's 
```

附带说明一下，由于这不是 PHP，因此`this->`在类上下文中并不是真正需要的，除非您有一个与成员同名的局部变量，而您没有。

# java - 从特定 jar 导入类文件

> ID：10113598
> 
> 赞同：3
> 
> 时间：2012-04-11T20:39:56.620
> 
> 标签：java

我正在使用 2 个 jars，base.jar 和 derived.jar，我以这种方式订购了类路径：base.jar，然后是 derived.jar

我有一个问题，我在两个 jar 中有一个同名包的类，它是我无法更改的第三方

在代码中我想从derived.jar 导入类而不更改类路径顺序？

我的代码中的导入命令或添加注释是否有一个选项？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T20:42:36.127

如果您使用可预测的 jar 加载顺序编写自己的类加载器 - 是的。但是您应该重命名类/包。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T20:44:58.597

如果它是第三方并且您有源代码，您可以自己重构该类并重建 jar。

# android - 在大型可缩放 ImageView 上动态添加较小的视图？

> ID：10113599
> 
> 赞同：2
> 
> 时间：2012-04-11T20:39:59.917
> 
> 标签：android, android-layout

我有一个大的缩放、平移 ImageView，其中包含一个图像，因为它是位图。我想在用户对其执行 LongClick 操作的地方添加许多较小的视图。这些视图必须定位在固定位置，并且当用户在其下方的大 ImageView 周围缩放或移动时，必须保持粘在该位置。我该怎么办？

（我试图在 Google Maps 上添加标记时获得与 ItemizedOverlay 类相同的功能，但在 ImageView 上。）

# java - 不相关且无用

> ID：10113601
> 
> 赞同：-5
> 
> 时间：2012-04-11T20:40:23.257
> 
> 标签：java, html, string, storage

由于缺乏信息而被删除。请继续前进。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-11T20:41:55.707

在 Java 中，您必须将字符串用双引号括起来。单引号是为单个字符保留的。

**编辑：**你必须像这样逃避你的内部双引号：

`String test = "He said \"yo\".";`

这是你的字符串：

```
String htmldata = "<html><head><meta http-equiv=\"Content-Type\" content=\"text/html;     charset=Utf-8\"><script type=\"text/javascript\" src=\"qrcode.js\"></script><!-- SJIS Support     (optional) --><!--<script type=\"text/javascript\" src=\"qrcode_SJIS.js\"></script>--><script     type=\"text/javascript\" src=\"sample.js\"></script><title name=\"msg\">what</title></head><body    onload=\"update_qrcode()\"><form><title>whatwhatwhat</title><input type=\"hidden\" name=\"msg\" value=\"http://www.bjjbadges.com\"></input></br><center><div id=\"qr\"></div></center></form></body></html>"; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-11T20:43:16.173

您将需要使用双引号来包装整个字符串。您还需要转义字符串中的 " 和任何 \ 字符。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-11T20:43:41.200

Java 字符串被包裹在双引号 ( `""`) 中。如果您的字符串包含双引号，则必须转义它们：`"\""`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-11T20:42:30.337

Java String 应该是双引号。“……”

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-28T09:52:08.447

正如上面许多人提到的，您可以使用`/"`. 但是，如果您真的想以另一种方式解决它，那么在您的 HTML 代码中替换为任何地方，然后使用它`"`。`+(char)34+`

# html - 另一个 div 内的 div 错误地采用父 div 宽度

> ID：10113607
> 
> 赞同：3
> 
> 时间：2012-04-11T20:40:57.453
> 
> 标签：html, layout, css

这是您今天的愚蠢 HTML/CSS 问题....

我有一个包含其他两个 div 的 div。容器设置为 display:box/-webkit-box/etc 以水平堆叠包含的 div。第一个包含的 div 是一些固定的内容，第二个包含一堆其他的小 tile div。

这是一个示例：http: [//jsfiddle.net/dex3703/T2EZy/3/](http://jsfiddle.net/dex3703/T2EZy/3/)

还有一个俗气的图表（请注意，**显示的 1000px 只是一个示例**——在任何 div 容器上都没有设置宽度）：

![俗气的图](../Images/efa7362e2587ed4b4e42467716297b9f.png)

我的问题是第二个包含的 div 采用父级的宽度，所以它总是在浏览器之外延伸。我希望将两个 div 包含在容器内。一切都需要是动态的，因此当浏览器调整内容大小时，内容会正确调整。我不能在容器或第二个 div 上放置固定大小。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T20:58:52.773

如果您不需要使用 display: box，请尝试使用较旧的 float 方法：http: [//jsfiddle.net/gpdV3/](http://jsfiddle.net/gpdV3/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T20:59:13.990

如果你知道父母 in PX not in 100% 。

让我们说你如何输入你的截图“1000px”你的css将会工作

前任：

[点击这里](http://jsfiddle.net/T2EZy/6/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-11T21:16:05.470

既然你知道父母和孩子的大小，它真的很容易。[http://jsfiddle.net/rTL6T/](http://jsfiddle.net/rTL6T/)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-04-11T20:49:51.853

那是因为您通过代码强制设置 div 的宽度（类似于 .MyClass{width:1000px}）。

请看一下这个答案：

[如何使 CSS 宽度填充父级？](https://stackoverflow.com/questions/2232440/css-width-to-fill-parent)

# vb.net - 不存在错误时该怎么办？

> ID：10113608
> 
> 赞同：0
> 
> 时间：2012-04-11T20:40:58.577
> 
> 标签：vb.net

Hiim 对 vb 来说相当新，所以我希望我能正确解释这一点，我遇到的问题是我正在创建一个剧院预订系统，如果没有组合框做同样的事情，我似乎无法获得提交按钮来打开下一个表单。我有四个组合框和一个提交按钮都链接到同一个事件。这样用户就可以选择票的数量，总数将自动显示在总数标签中，当按下提交按钮时，将出现一个新表单，Form3 将出现......

我需要至少选择一个组合框，否则会出现错误提示“请至少选择一张票”，然后如果在按下提交按钮时至少选择了一个，则应该出现下一个表单，但是使用我在选择下拉框时的代码打开一个新表单，我知道我的问题..但我不知道如何得到我想要的。

我的代码如下：

```
Sub ComboBoxes_SelectedIndexChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles ComboBox1.SelectedIndexChanged, ComboBox2.SelectedIndexChanged, ComboBox3.SelectedIndexChanged, ComboBox4.SelectedIndexChanged, Submitbtn.Click
    'Assigned an evet handler to all of the comboboxes then calculates the price and puts in total box

    Dim Totalcombo1, Totalcombo2, Totalcombo3, Totalcombo4, Price As Decimal

    Dim valuecombo1 = (ComboBox1.SelectedIndex + 1)  'finds position of option selected & adds one to get number of tickets
    Dim valuecombo2 = (ComboBox2.SelectedIndex + 1)
    Dim valuecombo3 = (ComboBox3.SelectedIndex + 1)
    Dim valuecombo4 = (ComboBox4.SelectedIndex + 1)

    'if the submit button is selected without there being a value selected from any combobox then error should appear, saying at least 1 ticket should be purchased.
    If (ComboBox2.SelectedIndex = -1) Then
        Totalcombo2 = 0
    Else
        Price = 6.5
        Totalcombo2 = valuecombo2 * Price
    End If

    'determines the ticketprice of combobox 1

    If (ComboBox1.SelectedIndex = -1) Then
        Totalcombo1 = 0
    Else
        Price = 9
        Totalcombo1 = valuecombo1 * Price
    End If
    'determines the ticketprice of combobox 2

    If (ComboBox3.SelectedIndex = -1) Then
        Totalcombo3 = 0
    Else
        Price = 6.5
        Totalcombo3 = valuecombo3 * Price
    End If
    'determines the ticketprice of combobox 3

    If (ComboBox4.SelectedIndex = -1) Then
        Totalcombo4 = 0
    Else
        Price = 6.5
        Totalcombo4 = valuecombo4 * Price
    End If
    'determines the ticketprice of combobox 4

    Try
        If (ComboBox1.SelectedIndex And ComboBox2.SelectedIndex And ComboBox3.SelectedIndex And ComboBox4.SelectedIndex) = -1 Then
            Throw New System.Exception()

        End If

    Catch ex As Exception When (ComboBox1.SelectedIndex And ComboBox2.SelectedIndex And ComboBox3.SelectedIndex And ComboBox4.SelectedIndex) = -1
        MessageBox.Show("Please make at least one ticket selection before continuing. ")

    End Try

    Totallbl.Text = Totalcombo1 + Totalcombo2 + Totalcombo3 + Totalcombo4
    'adds the totals of the ticketprices and then inserts into the Total label

End Sub

Sub SubmitForm_OpenBooking()

    Dim FrmBooking As New Form3
    FrmBooking.Show()

    Me.Hide()
End Sub 
```

任何帮助，无论什么时候，都会有很大的帮助.. iv 一直在这几个小时。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T21:28:49.087

是否缺少某些代码？我看不到对 SubmitForm_OpenBooking 的调用。

无论如何，您需要分离您的逻辑。

1.  您应该从 SelectedIndexChanged 中删除按钮单击事件。我真的很惊讶它的工作原理。
2.  删除 try/catch 部分。它与 SelectedIndexChanged 无关，无论如何您都不应该将它们用于逻辑流。
3.  为 Submit 按钮添加 Validating 事件处理程序，该按钮检查至少已选择一个组合（不要使用异常）。您甚至可以为此添加一个 ErrorProvider。
4.  为提交按钮添加 OnClick 事件处理程序以显示新表单。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T21:28:39.380

您的这部分代码有问题：

```
If (ComboBox1.SelectedIndex And ComboBox2.SelectedIndex And ComboBox3.SelectedIndex And ComboBox4.SelectedIndex) = -1 Then 
```

以这种方式使用 And 不会给出您可能期望的结果。它对 SelectedIndexValues 执行按位与运算。如果要检查所有选定索引的值是否为 -1，您应该这样做：

```
If ComboBox1.SelectedIndex = -1 And ComboBox2.SelectedIndex = -1 And ComboBox3.SelectedIndex = -1 And ComboBox4.SelectedIndex = -1 Then 
```

[使用AndAlso](http://msdn.microsoft.com/en-US/library/cb8x3kfz%28v=vs.100%29.aspx)代替 And也是一个好主意。

此外，没有理由在代码中使用 Try-Catch 子句。只需在 If 语句中显示消息框。

# c# - 这个递归函数如何返回true？

> ID：10113609
> 
> 赞同：1
> 
> 时间：2012-04-11T20:41:02.523
> 
> 标签：c#, function, recursion

这是我的递归函数：

```
public bool controllaSelezioneSottopagina(KPage k_oPaginaAttuale, KPage k_oPaginaSuperiore)
{
    foreach (KPage k_oSottoPagina in k_oPaginaSuperiore.SottoPagine)
    {
        if (k_oSottoPagina.ID == k_oPaginaAttuale.ID)
        {
            return true;
        }
        else
        {
            if (k_oSottoPagina.SottoPagine.Count != 0)
            {
                controllaSelezioneSottopagina(k_oPaginaAttuale, k_oSottoPagina);
            }
        }
    }

    return false;
} 
```

我认为，从我调用它的地方开始，总是错误的（`return false`函数末尾的，将是最后一个返回的结果，永远）。

事实上，有时它会返回 true。

怎么可能？尝试调试...但我无法找出错误...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-11T20:45:43.723

您调用该函数一次，然后它循环，并返回 true 或递归调用自身。只有在遍历所有元素并且条件 (k_oSottoPagina.ID == k_oPaginaAttuale.ID) 从未满足时，它才会返回 false。

现在假设在第一级实际上满足了这个条件（还没有进行递归或所有递归调用都返回）。

您调用该函数一次，它会循环，例如在第一次测试中，此条件为真。然后你会看到一个返回值'true'

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-11T20:50:48.100

我认为这只能在第一次迭代中发生。我的意思是只有第一次比较可能会导致返回 true。递归调用永远不会发生。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-08-20T05:28:07.600

在它确实进入循环的情况下不打印不正确 false 的另一种方法是

```
public bool controllaSelezioneSottopagina(KPage k_oPaginaAttuale, KPage k_oPaginaSuperiore)
{
    foreach (KPage k_oSottoPagina in k_oPaginaSuperiore.SottoPagine)
    {
        if (k_oSottoPagina.ID == k_oPaginaAttuale.ID)
        {
            return true;
        }
        else
        {
            if (k_oSottoPagina.SottoPagine.Count != 0)
            {
                if(controllaSelezioneSottopagina(k_oPaginaAttuale, k_oSottoPagina))
                {
                  return true;
                 }
            }
        }
    }

    return false;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-11T20:45:15.477

你是说这个代码块在第一次调用函数时（第一次通过循环）永远不会是真的？

```
k_oSottoPagina.ID == k_oPaginaAttuale.ID 
```

由于您不返回递归调用的结果，因此您的函数要么破坏堆栈，在某个点通过第一个循环返回 true，要么完成循环并返回 false。

# wpf - 我的应用程序有多个窗口，当鼠标在所有窗口之外指定时间时我想做一些事情

> ID：10113610
> 
> 赞同：-1
> 
> 时间：2012-04-11T20:41:08.497
> 
> 标签：wpf, windows, mouse

我的应用程序有几个窗口。*一旦鼠标在我的所有*窗口之外指定的时间（比如半秒），我想执行某个操作。

对于单个窗口，我会在 MouseLeave 事件中启动一个计时器，并在 MouseEnter 事件中删除该时间，但是我将如何为多个窗口实现这个？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T21:09:15.640

所有 Windows 和页面都可以访问 App。只需启动并取消具有内置延迟的 BackGroundWorker。如果工人完成了，那么做你的事。我用两页测试了这个。

在所有页面上注册一个 MouseEnter 和 MouseLeave

```
 private void MainWindowsMouseLeave(object sender, MouseEventArgs e)
    {
        // MessageBox.Show("MouseLeave");
        tbMouseEnterLeave.Text = "MouseLeave";
        if (App.BackgroundWorkerApp.IsBusy) App.BackgroundWorkerApp.CancelAsync();
        else
        {
            Thread.Sleep(10);
            if (App.BackgroundWorkerApp.IsBusy)App.BackgroundWorkerApp.CancelAsync();
        }
        if (!App.BackgroundWorkerApp.IsBusy) App.BackgroundWorkerApp.RunWorkerAsync();
    }

    private void MainWindowsMouseEnter(object sender, MouseEventArgs e)
    {
        tbMouseEnterLeave.Text = "MouseEnter";
        App.BackgroundWorkerApp.CancelAsync();
    }   

public partial class App : Application
{
    private static System.ComponentModel.BackgroundWorker backgroundWorkerApp = new BackgroundWorker();

    public App()
    {
        backgroundWorkerApp.WorkerSupportsCancellation = true;
        backgroundWorkerApp.DoWork +=
            new DoWorkEventHandler(backgroundWorkerApp_DoWork);
        backgroundWorkerApp.RunWorkerCompleted +=
            new RunWorkerCompletedEventHandler(
        backgroundWorkerApp_RunWorkerCompleted);
    }

    public static System.ComponentModel.BackgroundWorker BackgroundWorkerApp { get { return backgroundWorkerApp; } }

    private void backgroundWorkerApp_DoWork(object sender,
        DoWorkEventArgs e)
    {
        // Get the BackgroundWorker that raised this event.
        BackgroundWorker worker = sender as BackgroundWorker;
        e.Result = ComputeApp(worker, e);
    }

    // This event handler deals with the results of the
    // background operation.
    private void backgroundWorkerApp_RunWorkerCompleted(
        object sender, RunWorkerCompletedEventArgs e)
    {
        // First, handle the case where an exception was thrown.
        if (e.Error != null)
        {
            MessageBox.Show(e.Error.Message);
        }
        else if (e.Cancelled)
        {
            // Next, handle the case where the user canceled 
            // the operation.
            // Note that due to a race condition in 
            // the DoWork event handler, the Cancelled
            // flag may not have been set, even though
            // CancelAsync was called.
            // MessageBox.Show("Cancel");
        }
        else
        {
            // Finally, handle the case where the operation 
            // succeeded.
            // this where you do that thing you want to do
            MessageBox.Show("Complete");            
        }
    }

    string ComputeApp(BackgroundWorker worker, DoWorkEventArgs e)
    {

        // Abort the operation if the user has canceled.
        // Note that a call to CancelAsync may have set 
        // CancellationPending to true just after the
        // last invocation of this method exits, so this 
        // code will not have the opportunity to set the 
        // DoWorkEventArgs.Cancel flag to true. This means
        // that RunWorkerCompletedEventArgs.Cancelled will
        // not be set to true in your RunWorkerCompleted
        // event handler. This is a race condition.

        if (worker.CancellationPending)
        {
            e.Cancel = true;
            return "cancelled";
        }
        for (int i=0; i < 10; i++)
        {
            Thread.Sleep(100);
            if (worker.CancellationPending)
            {
                e.Cancel = true;
                return "cancelled";
            }
        }
        return "complete";
    }

} 
```

# php - 根据 MySQL 输出分配 div 颜色

> ID：10113611
> 
> 赞同：0
> 
> 时间：2012-04-11T20:41:12.710
> 
> 标签：php, mysql

不知道如何表达标题对不起。基本上我有一个评论系统，它的工作原理非常简单，从数据库中选择帖子的 uid，然后从另一个数据库输出与该 UID 相关的评论。

评论系统的本质是每个发帖者都是匿名的，因此，很难跟踪你是否与同一个人交流，因此，我想让评论周围的 div 成为一个特定的颜色，并且该人对该帖子的每条评论都是该颜色。将用户评论联系在一起的唯一因素是 IP 地址。

到目前为止我的代码：

```
$sql = "SELECT * FROM anonpost_com WHERE uid = '$uid' ORDER BY date DESC";

$result = mysql_query($sql) or print ("Can't select entry from table anonpost.<br />" . $sql . "<br />" . mysql_error());

while($row = mysql_fetch_array($result)) {
    $date = date("l F d Y", strtotime($row['date']));
    $comment = stripslashes($row['comment']);
    $uid = ($row['uid']);
    $cid = ($row['cid']);
    $ip = ($row['ip']);

         ?>

<div id="comments" style="border:1px solid <?php echo $colour; ?>;">
<p><?php echo $comment; ?></p>
<h4>by <i>Anonymous</i> on <?php echo $date; ?></h4>
</div>
<?php
}
?> 
```

$colour 来自： $colour = dechex(rand(0,10000000); 但我不确定如何使评论中同一 IP 的每个实例的 $colour 相同...

任何帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T20:54:06.723

我同意 IP 地址可能不是最好的解决方案，但要做到这一点：

```
$sql = "SELECT * FROM anonpost_com WHERE uid = '$uid' ORDER BY date DESC";

$colours = array();
$result = mysql_query($sql) or print ("Can't select entry from table anonpost.<br />" . $sql . "<br />" . mysql_error());

while($row = mysql_fetch_array($result)) {
    $date = date("l F d Y", strtotime($row['date']));
    $comment = stripslashes($row['comment']);
    $uid = ($row['uid']);
    $cid = ($row['cid']);
    $ip = ($row['ip']);
    if (!isset($colours[$ip])) {
        $colours[$ip] = dechex(rand(0,10000000);
    }
    $colour = $colours[$ip];

         ?>

    <div id="comments" style="border:1px solid <?php echo $colour; ?>;">
        <p><?php echo $comment; ?></p>
        <h4>by <i>Anonymous</i> on <?php echo $date; ?></h4>
    </div>
<?php
}
?> 
```

请注意，每次页面加载时颜色都会改变。

# php - Facebook API：用户允许权限，然后将预先存在的照片分享到他们的墙上

> ID：10113614
> 
> 赞同：0
> 
> 时间：2012-04-11T20:41:22.850
> 
> 标签：php, javascript, facebook, facebook-graph-api, facebook-fql

我一直在四处寻找解决问题的方法，但没有运气。

我想模仿“提要”对话框，它允许用户在他们的墙上分享链接。

但是，我希望用户在他们的墙上以全尺寸分享预先存在的照片。

如果有人可以帮助我，那就太棒了。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T23:53:37.830

可以使用 object_attachment 参数。我不确定它是否会出现全尺寸。它看起来像一个链接故事，但图像会弹出打开照片查看器灯箱。

这是宣布它的博客文章：http: [//developers.facebook.com/blog/post/526/](http://developers.facebook.com/blog/post/526/)

# c# - Salesforce SOAP 与 REST

> ID：10113615
> 
> 赞同：5
> 
> 时间：2012-04-11T20:41:28.873
> 
> 标签：c#, .net, salesforce

我一直在构建使用 Saleforce SOAP API 的控制台应用程序，现在需要在 Web 应用程序中使用 Salesforce API。

我是否正确假设 SOAP 更适合非基于 Web 的应用程序，而 REST 更适合 Web 应用程序？

如果我在哪里创建将用于从本地应用程序报告或从我们的网站发布到销售人员的包装器，我是否应该同时公开 REST 和 SOAP api，这取决于应用程序是什么？还是我应该坚持使用一个？如果我只需要选择一个，我应该考虑哪些决定因素？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-11T22:51:40.600

其他答案包含一些很好的一般信息，一些销售人员需要考虑的具体事项是

1) 您可以直接在 SOAP API 中批量更新数据，但您需要使用 Async Bulk API 从 REST 中执行此操作。

2）soap API 包含一些 REST API 中没有的东西，最显着的是 describeLayout、queryAll、getDeleted 和 getUpdated

3) REST API 包含一些 SOAP API 中没有的东西，包括用于 chatter 的 API，以及对最近访问记录列表的访问。

4) REST API 可以访问二进制数据（文件、附件、内容等），而无需 base64 编码/解码的开销。

因此，取决于您的应用程序正在尝试做什么，可能会以一种或另一种方式推动您。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-11T20:59:11.490

我相信，如果您通过 .NET 应用程序使用它，无论它是否是 Web 应用程序，它最终都是个人偏好。

就个人而言，我会选择 SOAP，因为 .NET 有很多内置功能可以使用 SOAP 服务，它为您构建所有方法原型，并且比您自己手工制作 REST 请求更快。.NET 将负责 SOAP 的编组。

至于构建包装器，您必须考虑*您的*目标受众，如果您的目标受众是其他 .NET 应用程序开发人员，那么公开您自己的 WCF 服务可能是一个不错的选择，WCF 还具有用于 SOAP 或 REST 的端点。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-11T22:04:12.547

恕我直言，如果您的问题表明您正在从 .NET 开发解决方案，那么 SOAP 是可行的方法。REST 服务是有益的，因为它们缺乏围绕 SOAP 的大量和工具集要求，并且对于没有访问像 .NET 之类的大量投资工具的引导开发人员来说非常有用。我同意其他评论，即 REST 更接近地反映了底层 HTTP 方法，并且更易于明确地阅读和解析，但这并不是您在 VS 和 .NET 等工具中真正需要关心的事情。

此外，由于您现有的控制台应用程序可能会在某些时候被引入到通信组合中，因此最好让 WCF 灵活地与传输无关，而不是像使用 REST 那样绑定到 HTTP。

所以我真的不认为您能够利用 REST 的优势或受到 SOAP 的缺点的影响，因此使用最适合您现有工具集的高度标准化的选项是有意义的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-11T21:03:08.523

当两者都可用时使用 REST 或 SOAP 的决定通常与：

1.  您用于应用程序的工具和语言
2.  你对这两种风格的熟悉程度
3.  应用程序的性能需求（JSON 有效负载小于 XML 有效负载）

如果“本地”应用程序从服务器端调用服务，那么在其他条件相同的情况下，您至少可以直接从 WSDL 生成 C# 代码，这使得使用 SOAP API 更简单（无需手动编码）。

如果 Web 应用程序需要直接从客户端（浏览器）调用 API，则使用 REST 并使用 JSON。这会简单得多。无论如何，您将无法重用相同的包装器，因此使用两个不同的 API 没有问题，除了学习它们所花费的时间。

如果 API 的 Web 应用程序使用在服务器端（而不是客户端），那么肯定只针对单个 API。如果您想自动生成代码来调用它，则使用 WSDL，否则为简单和高效，请使用 REST。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-11T21:05:04.550

IMO，SOAP 是作为合同类型消息传递架构师创建的标准，即在传递消息时只使用这个“合同”。它足够通用，不包含任何特定技术。

REST 是一种包含 HTTP 的实际方法，它是一种最大限度地利用 GET、POST、PUT 和 DELETE 的方法。

我不会假设一个比另一个更好，它真正归结为使用正确的工具来完成这项工作。我不会区分基于网络的应用程序和非基于网络的应用程序。因为 SOAP 或 REST 对两者都有好处。

这里有几个问题我会首先得到回答：
1）谁是我的目标客户。Microsoft Workshop 客户端，Java，PHP 类型。
2）我想向我的 Api 公开什么类型的（缺乏更好的术语。）“端点”。（JSON、XML、Ajax、POX 或以上所有。）
3) 我的客户将使用此 API 做什么？他们是否已经拥有基于 SOAP 的客户端。如果是这样，SOAP 就是要走的路。
4) REST 将使您考虑您的 URL 设计，从而允许客户端“混搭”数据以构建他们需要的内容。所以，如果你认为这是你想要的。REST 是要走的路。
5) REST 利用 HTTP 中的“GET”，这允许客户端缓存结果。“所谓的条件GET。它允许他们缓存一个大对象，仅通过一个标头（小）询问服务器最后一次更新是否与缓存的内容匹配，如果是的话。不要打扰完整的对象GET，什么缓存的是最新版本。这可以在 SOAP 中完成，但开箱即用，REST 对此更好。

无论如何，希望这能给您提供更好的数据，以便您做出更好的决定。如果一切都失败了，你可以两者都做。但是，您将不得不尝试获得两种类型的服务（不同的方法）和一个代码库。（可能很棘手，但没那么难。）

亲自。我会选择一个，然后如果你需要另一个，就烧掉那座桥并为此支付技术债务。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-13T10:38:28.913

这个聚会迟到了，但只是一个简短的说明：

Salesforce API 并不完全是 RESTful：我称之为 REST-ish。它的某些 REST 接口的 URL 中有类似 SQL 的查询，诸如此类。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-11-17T17:58:02.743

SOAP API：

它是干什么用的？使用 SOAP 将组织的数据与其他应用程序集成。

什么时候使用它？您有需要使用 WSDL 和 XML 数据的预先存在的中间件服务。

协议 SOAP/WSDL 数据格式 XML 通信 同步

休息API：

它是干什么用的？使用 REST 访问组织中的对象。什么时候使用它？您希望利用 REST 架构与您的组织集成。没有 WSDL 要求。非常适合基于浏览器的应用程序、移动应用程序和高度交互的社交应用程序。协议 REST 数据格式 JSON、XML 通信同步

# django - Django使用元模型在表单中隐藏外键

> ID：10113616
> 
> 赞同：4
> 
> 时间：2012-04-11T20:41:38.653
> 
> 标签：django, forms, widget, foreign-keys, hidden

我正在使用 django 在一个食谱网站上工作，并且在我的表单中遇到了外键字段的问题

问题是，当我创建我的食谱时，我需要一个指向创建这个食谱的食谱的外键，但我不希望创建食谱的用户看到 original_cookbook 字段（他们不应该看到）

我相信我需要使用一个小部件（HiddenInput），但我是否对其他网站上给出的示例感到困惑。我的朋友还提到了一些关于在 original_cookbook 视图中设置初始值的内容

tl; dr：我想将 fk 指向用户食谱，同时隐藏 original_cookbook 字段。

相关代码：

形式：

```
class RecipeForm(forms.ModelForm):

    class Meta:
        model = Recipe 
```

模型：

```
class Recipe(models.Model):
    def __unicode__(self):
        return self.name
    original_cookbook = models.ForeignKey(Cookbook)
    #cookbooks = models.ManyToManyField('Cookbook', related_name = 'recipes')
    name = models.CharField(max_length=200)
    author = models.CharField(max_length= 100)
    picture = models.ImageField(upload_to = 'Downloads', blank=True)
    pub_date = models.DateTimeField('date published', auto_now_add=True, blank=True)
    ingredients = models.TextField()
    steps = models.TextField()
    prep_time = models.IntegerField()
    TYPE_CHOICES= (
    ('SW', 'Sandwich'),
    ('AP', 'Appetizers'),
    ('SD', 'Sauces and Dressings'),
    ('SS', 'Soups and Salads'),
    ('VG', 'Vegetables'),
    ('RG', 'Rice, Grains and Beans'),
    ('PA', 'Pasta'),
    ('BR', 'Breakfast'),
    ('MT', 'Meat'),
    ('SF', 'Seafood'),
    ('BP', 'Bread and Pizza'),
    ('DT', 'Desserts'),
    )
    type = models.CharField(max_length = 2, choices=TYPE_CHOICES)

    def index_queryset(self):
        return self.objects.all() 
```

看法：

```
def createrecipe(request):
    if not request.user.is_authenticated():
        return HttpResponseRedirect('/index/')
    else:
        if request.method == 'POST':
            form = RecipeForm(request.POST)
            if form.is_valid():
                recipe = form.save()
                user = request.user
                cookbooks = user.cookbooks
                cookbook = cookbooks.all()[0]
                cookbook.recipes.add(recipe)
                return HttpResponseRedirect('/account')
        else:
            form = RecipeForm()

        return render_to_response('cookbook/createrecipe.html',
                                    {'form':form},
                              context_instance=RequestContext(request)) 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-11T20:48:27.230

添加`exclude = ('original_cookbook',)`到表单的`Meta`类。

然后，在您的`if form.is_valid()`代码中，执行以下操作：

```
....
recipe = form.save(commit=False)
recipe.original_cookbook = whatever_that_is
recipe.save()
... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T20:47:07.907

这在[文档](https://docs.djangoproject.com/en/dev/topics/forms/modelforms/#overriding-the-default-field-types-or-widgets)中得到了回答。

```
from django import forms
class RecipeForm(forms.ModelForm):

    class Meta:
        model = Recipe
        widgets = {'cookbook': forms.HiddenInput 
```

# linq - linq to entity - 如何查询存储为char的日期？

> ID：10113618
> 
> 赞同：0
> 
> 时间：2012-04-11T20:41:47.657
> 
> 标签：linq, entity-framework, entity-functions

在 db 表中，日期以 yyyyMMdd 格式存储在 char(8) 字段中。如何查询日期范围？

我尝试了以下方法，但它不起作用：

```
context.Where(p=> Convert.ToDateTime(p.Date) >= Convert.ToDateTime('20120411');
context.Where(p=> Convert.ToInt32(p.Date) >= Convert.ToInt32('20120411');
context.Where(p=> int.Parse(p.Date) >= int.Parse('20120411'); 
```

从我读到的一种可能的方法是使用 EntityFunctions 类，但我不确定如何构造查询。关于如何做到这一点的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T20:56:43.920

将测试字符串转换为日期：

```
context.Where(p=> Convert.ToDateTime(p.Date) >= DateTime.Parse("2012/04/11 00:00:00"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-12T00:50:22.740

```
context.Where(p=> p.Date.CompareTo("20120411") >= 0); 
```

# c# - 来自字符串的条件方法调用

> ID：10113630
> 
> 赞同：1
> 
> 时间：2012-04-11T20:42:52.340
> 
> 标签：c#, methods, runtime

我有一个带有方法签名的类（MethodsClass）：

```
public double Method() 
```

和一个`DataGrid`与`ComboBoxColumn`。ComboBox 具有 MethodsClass 的所有方法的名称。

在运行时，我需要调用从 ComboBox 中选择的方法。我的反思不是很好，我知道它很慢。我可以使用普通初始化创建 MethodsClass 的实例吗

```
var mClass = new MethodsClass(); 
```

然后以某种方式使用 ComboBox 中的字符串调用我需要的方法。如果不是 - 执行任务的最佳方式是什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T20:50:25.417

您应该创建一个`Dictionary<string, Action<...>>`包含委托（方法名称或 lambda 表达式）来为每个字符串值执行。

这比反射快得多，并且还允许您将字符串值和参数与方法签名分离。

# php - 用于查询目的的精确字符串匹配

> ID：10113634
> 
> 赞同：0
> 
> 时间：2012-04-11T20:43:13.660
> 
> 标签：php, sql

我正在尝试查询某个字符串/单词并查询与其相关的一堆结果，但 SQL 语句存在问题。
例如：当我尝试用当前代码搜索property_code“TA001”时，它会查询回TA001、CTA001、JTA001等。我只想要确切的提交结果。

我尝试用 = 替换 LIKE 函数并删除通配符 %，但不会返回任何结果。任何帮助，将不胜感激。这是代码：

```
<?php

error_reporting(E_ALL);
ini_set('display_errors', '1');
$search_output = "";
if(isset($_POST['searchquery']) && $_POST['searchquery'] != ""){
$searchquery = preg_replace('#[^a-z 0-9]-#i', '', trim(strtoupper($_POST['searchquery'])));
if($_POST['filter1'] == "properties"){
    $sqlCommand = "(SELECT id, property_code, street, street2, city, state, zip FROM properties WHERE property_code LIKE '% $searchquery %')";
} else if($_POST['filter1'] == "vendor"){
    $sqlCommand = "SELECT id, vendor_name FROM vendor WHERE vendor_name LIKE '%$searchquery%'";
} 
    include_once("database.php");
    $query = mysql_query($sqlCommand) or die(mysql_error());
$count = mysql_num_rows($query);
if($count > 1){
    $search_output .= "<hr />$count results for <strong>$searchquery</strong><hr />$sqlCommand<hr />";
    while($row = mysql_fetch_array($query)){
        $id = $row["id"];
        $property_code = $row["property_code"];
        $street = $row["street"];
        $street2 = $row["street2"];
        $city = $row["city"];
        $state = $row["state"];
        $zip = $row["zip"];
        $search_output .= "Item ID: $id: - $property_code, $street, $street2, $city, $state $zip<br />";
            } // close while
} else {
    $search_output = "<hr />0 results for <strong>$searchquery</strong><hr />$sqlCommand";
}
}
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T21:14:14.920

在这一行：

```
 $sqlCommand = "(SELECT id, property_code, street, street2, city, state, zip FROM properties WHERE property_code LIKE '% $searchquery %')"; 
```

您在 '% 和 $searchquery 之间的 LIKE 条件中有一个空格 - 这是问题之一。

如果您只想搜索以 $searchquery 字符串开头的记录，可以这样尝试：

```
if($_POST['filter1'] == "properties"){
$sqlCommand = "SELECT id, property_code, street, street2, city, state, zip FROM properties WHERE property_code LIKE '{$searchquery}%'";
} else if($_POST['filter1'] == "vendor"){
    $sqlCommand = "SELECT id, vendor_name FROM vendor WHERE vendor_name LIKE '{$searchquery}%'";
} 
```

如果你想要完全匹配试试这个：

```
if($_POST['filter1'] == "properties"){
    $sqlCommand = "SELECT id, property_code, street, street2, city, state, zip FROM properties WHERE property_code = '{ $searchquery'";
} else if($_POST['filter1'] == "vendor"){
    $sqlCommand = "SELECT id, vendor_name FROM vendor WHERE vendor_name = '{$searchquery}'";
} 
```

# java - Java JTextArea 未正确填充。请帮忙

> ID：10113635
> 
> 赞同：1
> 
> 时间：2012-04-11T20:43:14.653
> 
> 标签：java, swing, user-interface, awt

有人可以帮助我吗，我今晚有作业，但是有一个绊脚石，因为我似乎没有正确更新 JTextArea。循环自己运行并生成 6 行到控制台，但不会对 GUI 做同样的事情？欢迎任何建议。

```
import java.awt.EventQueue;
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.border.EmptyBorder;
import javax.swing.JButton;
import java.awt.event.ActionListener;
import java.awt.event.ActionEvent;
import javax.swing.JTextArea;

@SuppressWarnings("serial")
public class GUI extends JFrame {

private JPanel contentPane;
private JTextArea textField;

/**
 * Launch the application.
 */
public static void main(String[] args) {
    EventQueue.invokeLater(new Runnable() {
        public void run() {
            try {
                GUI frame = new GUI();
                frame.setVisible(true);
            } catch (Exception e) {
                e.printStackTrace();
            }
        }
    });
}

/**
 * Create the frame.
 */
public GUI() {
    setTitle("Home Improvement");
    setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    setBounds(100, 100, 666, 300);
    contentPane = new JPanel();
    contentPane.setBorder(new EmptyBorder(5, 5, 5, 5));
    setContentPane(contentPane);
    contentPane.setLayout(null);
    textField = new JTextArea();
    textField.setEditable(false);
    textField.setBounds(5, 5, 655, 235);
    contentPane.add(textField);

    JButton btnClear = new JButton("Clear");
    btnClear.addActionListener(new ActionListener() {
        public void actionPerformed(ActionEvent arg0) 
        {
            textField.setText("");
        }
    });
    btnClear.setBounds(543, 243, 117, 29);
    contentPane.add(btnClear);

    JButton btnProcess = new JButton("Process");
    btnProcess.addActionListener(new ActionListener() {
        public void actionPerformed(ActionEvent e) 
        {
            populate(); 

        }
    });
    btnProcess.setBounds(414, 244, 117, 29);
    contentPane.add(btnProcess);
}

public void populate() 
{
    String msg = "Error";
    HomeImprovement[] homeImprove = new HomeImprovement[6];
    double price [] = {500.99,33,90,1599,33,900};
    int isWhat [] = {1,0,0,0,1,1};

    homeImprove[0] = new TileInstaller("The Tile Guy\t");
    homeImprove[1] = new Electrician("Electrons R Us\t");
    homeImprove[2] = new HandyMan("Mr. Handy\t");
    homeImprove[3] = new GeneralContractor("N.B.J. Inc.\t");
    homeImprove[4] = new HandyMan("Mr. Handy(Tile)");
    homeImprove[5] = new GeneralContractor("N.B.J. Inc.(Tile)");

    for(int i=0; i<homeImprove.length; i++)
      {
            if ((isWhat[i] != 1))
            {msg=homeImprove[i].doTheElectric();}
            else
            {msg=homeImprove[i].tileIt();}

        String tmp =    "Company: "+homeImprove[i].getCompanyName() + "\t" +
                        "Final Price: "+ homeImprove[i].computeBid(price[i]) + "\t" +
                        "msg: " + msg + "\n";   

        textField.setText(tmp);
      }

}
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-11T20:45:12.833

尝试为此使用摇摆工人。此可运行对象将在 ui 线程上执行并更新您的 UI。

```
SwingWorker worker = new SwingWorker<ImageIcon[], Void>() {
private String populated = null;
   @Override
   public ImageIcon[] doInBackground() {
      String populated = populate(); //but remove last line and return the result
   }  

   @Override
   public void done() {
      textField.append( populated );
   }
}; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-11T20:46:13.907

你一直在覆盖字符串。

尝试这个：

```
String tmp = "";
for(int i=0; i<homeImprove.length; i++)
{
   if (isWhat[i] != 1)
   {
      msg = homeImprove[i].doTheElectric();
   }
   else
   {
      msg = homeImprove[i].tileIt();
   }

   tmp += "Company: "+homeImprove[i].getCompanyName() + "\t" +
      "Final Price: "+ homeImprove[i].computeBid(price[i]) + "\t" +
      "msg: " + msg + "\n";   

}
textField.setText(tmp); 
```

顺便说一句：我建议改变你的编程风格（我猜你还在学习:-)），换行和缩进不需要任何成本，并且在搜索错误时有很大帮助。

# java - 项目之间的共享对象中的 ClassNotFoundException

> ID：10113643
> 
> 赞同：0
> 
> 时间：2012-04-11T20:43:51.897
> 
> 标签：java, eclipse

我在 Eclipse 中有一个项目，包含 3 个部分：
1\. 客户端
2\. 服务器
3\. 实用程序

在 Utils 中，我已经序列化了名为 Profile 的对象。
我正在尝试将配置文件实例从客户端发送到服务器
，但我得到 ClassNotFoundException。

我关联这个项目的方式是：
我在 Java Build Path -> Projects the Utils 项目中添加到客户端和服务器。
并使用正确的包导入。
我究竟做错了什么？

```
java.lang.ClassNotFoundException: entities.Profile
at java.net.URLClassLoader$1.run(URLClassLoader.java:202)
at java.security.AccessController.doPrivileged(Native Method)
at java.net.URLClassLoader.findClass(URLClassLoader.java:190)
at java.lang.ClassLoader.loadClass(ClassLoader.java:307)
at com.google.appengine.tools.development.IsolatedAppClassLoader.loadClass(IsolatedAppClassLoader.java:176)
at java.lang.ClassLoader.loadClass(ClassLoader.java:248)
at java.lang.Class.forName0(Native Method)
at java.lang.Class.forName(Class.java:247)
at java.io.ObjectInputStream.resolveClass(ObjectInputStream.java:603)
at java.io.ObjectInputStream.readNonProxyDesc(ObjectInputStream.java:1574)
at java.io.ObjectInputStream.readClassDesc(ObjectInputStream.java:1495)
at java.io.ObjectInputStream.readOrdinaryObject(ObjectInputStream.java:1731)
at java.io.ObjectInputStream.readObject0(ObjectInputStream.java:1328)
at java.io.ObjectInputStream.readObject(ObjectInputStream.java:350)
at server.StreetMeetSignServlet.readObject(StreetMeetSignServlet.java:89)
at server.StreetMeetSignServlet.doPost(StreetMeetSignServlet.java:29)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:637)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
at org.mortbay.jetty.servlet.ServletHolder.handle(ServletHolder.java:511)
at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1166)
at com.google.appengine.tools.development.HeaderVerificationFilter.doFilter(HeaderVerificationFilter.java:35)
at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
at com.google.appengine.api.blobstore.dev.ServeBlobFilter.doFilter(ServeBlobFilter.java:60)
at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
at com.google.apphosting.utils.servlet.TransactionCleanupFilter.doFilter(TransactionCleanupFilter.java:43)
at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
at com.google.appengine.tools.development.StaticFileFilter.doFilter(StaticFileFilter.java:122)
at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
at com.google.appengine.tools.development.BackendServersFilter.doFilter(BackendServersFilter.java:97)
at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
at org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:388)
at org.mortbay.jetty.security.SecurityHandler.handle(SecurityHandler.java:216)
at org.mortbay.jetty.servlet.SessionHandler.handle(SessionHandler.java:182)
at org.mortbay.jetty.handler.ContextHandler.handle(ContextHandler.java:765)
at org.mortbay.jetty.webapp.WebAppContext.handle(WebAppContext.java:418)
at com.google.appengine.tools.development.DevAppEngineWebAppContext.handle(DevAppEngineWebAppContext.java:78)
at org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152)
at com.google.appengine.tools.development.JettyContainerService$ApiProxyHandler.handle(JettyContainerService.java:363)
at org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152)
at org.mortbay.jetty.Server.handle(Server.java:326)
at org.mortbay.jetty.HttpConnection.handleRequest(HttpConnection.java:542)
at org.mortbay.jetty.HttpConnection$RequestHandler.content(HttpConnection.java:938)
at org.mortbay.jetty.HttpParser.parseNext(HttpParser.java:755)
at org.mortbay.jetty.HttpParser.parseAvailable(HttpParser.java:218)
at org.mortbay.jetty.HttpConnection.handle(HttpConnection.java:404)
at org.mortbay.io.nio.SelectChannelEndPoint.run(SelectChannelEndPoint.java:409)
at org.mortbay.thread.QueuedThreadPool$PoolThread.run(QueuedThreadPool.java:582) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T22:08:20.507

听起来 Profile 类没有被部署到服务器上。仅仅将 Utils 添加到构建路径是不够的，您实际上需要将编译后的代码发布到您的服务器所期望的任何地方。如果您将 Utils 项目设置为服务器的 Java EE 依赖项，Eclipse 应该会为您执行此操作，尽管有时设置一个脚本来执行此操作是最简单的。

# android - Android - 打开小部件上下文菜单的意图

> ID：10113645
> 
> 赞同：4
> 
> 时间：2012-04-11T20:43:54.847
> 
> 标签：android, android-intent, widget, android-contextmenu

在我的应用程序中，我希望当用户单击按钮时，应用程序会自行关闭并自动打开添加新小部件上下文菜单。我正在做这个：

```
if (viewId == R.id.bt_homeScreen) {
        finish();
        try {
            Intent intent = new Intent(Intent.ACTION_MAIN);
            intent.addCategory(Intent.CATEGORY_HOME);
            startActivity(intent);
        } catch (ActivityNotFoundException e) {
            Toast.makeText(this.getApplicationContext(), getResources().getString(R.string.homeClientAlert), Toast.LENGTH_SHORT).show();
        }
    } 
```

这段代码的问题是我只进入手机主屏幕：

[![http://cdn.androidtapp.com/wp-content/uploads/2009/02/rc33-google-voice-search-for-android-on-home-screen.jpg](../Images/ce89ed4c14f480392d0fe3358e82b1f7.png)](https://i.stack.imgur.com/iaGSe.jpg)
[（来源：[androidtapp.com](http://cdn.androidtapp.com/wp-content/uploads/2009/02/rc33-google-voice-search-for-android-on-home-screen.jpg)）]

我希望当我启动 Intent 时它会转到主屏幕并打开小部件上下文菜单：

[![http://www.taosoftware.co.jp/en/android/calendarwidget/img/choosewidget.png](../Images/77f52188626c866fe4e9acd1bae1f2be.png)](https://i.stack.imgur.com/oqv5D.png)
[（来源：[taosoftware.co.jp](http://www.taosoftware.co.jp/en/android/calendarwidget/img/choosewidget.png)）]

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T22:55:19.810

看看 Commonsware 对这个问题的回答：[Add widget to homescreen from Android application](https://stackoverflow.com/questions/10449884/add-widget-to-homescreen-from-android-application)

您将能够显示小部件选择菜单，但您将无法在普通应用程序中处理该选择。使用 appwidget 选择的应用程序必须实现 AppWidgetHost。主屏幕应用属于这一类，没有普通应用。

# iphone - 如何在 UIWebview 表单中创建键盘的确定按钮？

> ID：10113649
> 
> 赞同：0
> 
> 时间：2012-04-11T20:44:13.350
> 
> 标签：iphone, cocoa, uiview, uiwebview

当您在 iPhone 上单击[网络表单](http://en.wikipedia.org/wiki/Form_%28web%29)时，此蓝色“确定”按钮在 UIWebview 中很常见。

![蓝色确定按钮](../Images/9f458f644510028950fb3aa328b675c0.png)

有没有一种简单的方法可以在代码中重新创建它？或者我将不得不以一种艰难的方式来创造它？

最接近的代码是：

```
 UISegmentedControl *buttonOK = [[UISegmentedControl alloc] initWithItems:[NSArray arrayWithObject:@"OK"]];
    [buttonOK setSegmentedControlStyle:UISegmentedControlStyleBar];
    [buttonOK setTintColor:[UIColor colorWithRed:0.25f green:0.51f blue:0.95f alpha:1.0f]];
    [buttonOK setFrame:CGRectMake(276, 8, 38, 30)]; 
```

但是不一样吗...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-11T21:07:12.577

Web 视图中的按钮使用半透明 UIToolbar 和完成按钮样式：

```
UISegmentedControl* segmentedControl = [[UISegmentedControl alloc] initWithItems:[NSArray arrayWithObjects:@"Previous", @"Next", nil]];
segmentedControl.segmentedControlStyle = UISegmentedControlStyleBar;
segmentedControl.tintColor = [UIColor blackColor];
segmentedControl.momentary = YES;

UIBarButtonItem* segmentedControlItem = [[UIBarButtonItem alloc] initWithCustomView:segmentedControl];
UIBarButtonItem* item = [[UIBarButtonItem alloc] initWithTitle:@"OK" style:UIBarButtonItemStyleDone target:self action:@selector(done:)];
UIBarButtonItem* flexSpace = [[UIBarButtonItem alloc] initWithBarButtonSystemItem:UIBarButtonSystemItemFlexibleSpace target:nil action:NULL];
UIToolbar* toolbar = [[UIToolbar alloc] initWithFrame:CGRectMake(0.0f, 0.0f, 320.0f, 44.0f)];
toolbar.barStyle = UIBarStyleBlack;
toolbar.translucent = YES;
toolbar.items = [NSArray arrayWithObjects:segmentedControlItem, flexSpace, item, nil];
[self.view addSubview:toolbar]; 
```

# iphone - 无法解决的内存泄漏 iPhone

> ID：10113650
> 
> 赞同：1
> 
> 时间：2012-04-11T20:44:15.330
> 
> 标签：iphone, objective-c, memory-leaks

我是 iPhone 编程的新手，我无法解决以下内存泄漏问题。

```
while(numDeckCounter < numDecks){
    int cardCounter=1;
    for (int i =1; i<=52; i++) {
        tempCard = [Card new]; //leaks tool says that this is leaking object
        if(i>=1 && i<=13)
        {
            tempCard.suit = CLUBS;
            tempCard.faceValue = cardCounter;
            [deckArr addObject:tempCard]; //reference count 2
            cardCounter++;
        }
        else if(i>=14 && i<=26)
        {
            tempCard.suit = DIAMONDS;
            tempCard.faceValue = cardCounter;
            [deckArr addObject:tempCard];
            cardCounter++;
        }
        else if(i>=27 && i<=39)
        {
            tempCard.suit = HEARTS;
            tempCard.faceValue = cardCounter;
            [deckArr addObject:tempCard];
            cardCounter++;
        }
        else
        {
            tempCard.suit = SPADES;
            tempCard.faceValue = cardCounter;
            [deckArr addObject:tempCard];
            cardCounter++;
        }
        if(cardCounter ==14){
            cardCounter=1;
        }
        [tempCard release];  //this causes an EXC_BAD_ACCESS -reference count should be 1
    }
    numDeckCounter++;
} 
```

我的印象是向数组中添加一个对象会将其引用计数增加一，然后释放您刚刚添加的对象是安全的，因为在释放数组之前不会释放它，然后释放每个对象在数组中。这是对象最终应该被释放的时候。

当我添加 [tempCard release]; 它使我的应用程序崩溃，因为它无法访问内存位置，因为它已被释放。

从我读过的所有内容来看，我认为我上面所说的都是真的。如果我错了，请有人纠正我。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T00:37:02.773

我在您提供的代码中看不到任何泄漏。（不过，有一些机会可以缩小它，比如将相同的操作移出条件句）。

泄漏工具的输出很难阅读。Card 对象是否有可能泄漏它的 ivars 之一？

不要泄漏，而是对您的产品运行静态分析（产品->分析）。我认为它会标记您代码的不同部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T20:51:04.573

也许尝试`[[Card alloc] init]`代替`[Card new]`. 这只是一个猜测。然而，尝试 IMO 更常用的对象创建方法可能会有所帮助。

看看这个：[使用 alloc init 而不是 new](https://stackoverflow.com/questions/719877/use-of-alloc-init-instead-of-new-objective-c)

您还可以尝试删除所有用于将卡片添加到数组的代码。所以你基本上有：

```
card = [Card new];
[card release]; 
```

这可以帮助您找到与保留对象的数组相关的内存问题吗？

# css - 如何在悬停时为图像添加边框？

> ID：10113652
> 
> 赞同：0
> 
> 时间：2012-04-11T20:44:18.437
> 
> 标签：css, border

我正在尝试在翻转时为图像添加边框。当我翻转图像时，边框不显示。这是我的代码：

```
<script>
$(document).ready(function() {
    $("#imgBorder").hover(
        function() { $(this).addClass("Hover"); },
        function() { $(this).removeClass("Hover"); }
    );
});
</script>
Hover { border: 1px solid #000; }
<div id="imgBorder"><a href="#">link...</a> 
```

为什么悬停时没有出现边框？

另外，有没有办法做到这一点，以便在添加边框时不会重新调整图像大小？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T20:47:19.040

您不需要使用 javascript 在图像翻转上添加悬停。只需将其添加到 css 类即可。

```
<style language="text/css">
.rollOver : hover
{
    border: 1px solid #000;
}
</style>

<div class="rollOver" id="imgBorder">Test</div> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-11T20:48:42.723

首先，要影响图像，您的 jQuery 应该是：

```
$("#imgBorder img").hover(
    function() { $(this).addClass("Hover"); },
    function() { $(this).removeClass("Hover"); }
); 
```

你的 CSS 应该是：

```
.Hover { /* note the period preceding the 'Hover' class-name */
    border: 1px solid #000;
} 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/NykWx/)。

注意：

*   `.string`通过类名选择元素`string`：`<div class="string"></div>`
*   `#string`通过它的 选择一个元素，`id`它等于`string` `<div id="string"></div>`
*   `string`选择 的元素`string`：`<string></string>`

但是您不需要 JavaScript，只需使用：

```
#imgBorder:hover img,
#imgBorder img:hover {
    border: 1px solid #000;
} 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/NykWx/1/)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-11T20:49:17.907

在下面的选择器中，您要定位一个标记名为“Hover”的元素。这不存在。

```
Hover { border: 1px solid #000; } 
```

你想要的是：

```
.Hover { border: 1px solid #000 } 
```

正如这里的其他人已经指出的那样，您不需要 JavaScript，因为您可以使用`:hover`伪类：

```
img { border: 1px solid #FFF }
img:hover { border-color: #000; } 
```

如需进一步阅读，请参阅[http://www.w3.org/TR/CSS2/selector.html#dynamic-pseudo-classes](http://www.w3.org/TR/CSS2/selector.html#dynamic-pseudo-classes)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-11T20:46:58.597

像这样的东西可以在 CSS 中使用，链接如下

```
.rollover_img {
width: 280px;
height: 150px;
background-image: url(land.jpg); 
background-position: top;
-moz-border-radius:10px;
-webkit-border-radius:10px;
border:10px solid #ccc;
font:13px normal Arial, Helvetica, sans-serif;
line-height:18px;
float:left;
margin:0 10px 10px 0;
} 
```

我将引导您到以下链接

[http://aceinfowayindia.com/blog/2010/02/how-to-create-simple-css-image-rollover-effect/](http://aceinfowayindia.com/blog/2010/02/how-to-create-simple-css-image-rollover-effect/)

# c - 创建一个 pcap 文件

> ID：10113653
> 
> 赞同：6
> 
> 时间：2012-04-11T20:44:22.427
> 
> 标签：c, linux, udp, pcap, libpcap

我需要将 UDP 数据包保存到文件中，并希望使用 pcap 格式来重用各种可用的工具（wireshark、tcpdump、...）。[此线程](https://stackoverflow.com/questions/7309773/c-writing-structs-to-a-file-pcap)中有一些信息，但我找不到如何编写全局文件头“struct pcap_file_header”。

```
pcap_t* pd = pcap_open_dead(DLT_RAW, 65535);
pcap_dumper_t* pdumper = pcap_dump_open(pd, filename);

struct pcap_file_header file_hdr;
file_hdr.magic_number = 0xa1b2c3d4;
file_hdr.version_major = 2;
file_hdr.version_minor = 4;
file_hdr.thiszone = 0;
file_hdr.sigfigs = 0;
file_hdr.snaplen = 65535;
file_hdr.linktype = 1;

// How do I write file_hdr to m_pdumper?

while( (len = recvmsg(sd, &msg_hdr, 0)) > 0 )
  pcap_dump((u_char*)m_pdumper, &m_pcap_pkthdr, (const u_char*)&data); 
```

我应该如何编写全局文件头？如果没有可用的特定 pcap 函数，我如何检索文件描述符以使用 write() 插入标头？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-11T20:57:01.730

你不应该写那个标题，`pcap_open_dead`应该为你做。`pcap_dump`如果您想直接写文件而不是使用和朋友，您只需要自己填写并编写该标题。[这里](http://seclists.org/tcpdump/2010/q2/22)有一个简单程序的例子，用这些函数写出一个 pcap 文件。

* * *

**原始答案**，关于直接写入文件：

我不记得它是如何工作的，但是我`redir`前一段时间写了一个补丁，可以写出 pcap 文件，您可以将其用作示例。

你可以在[这个 debian bug](http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=526401)中找到它。（错误链接已修复。）

其中一些是用于伪造以太网和 IP 标头，并且可能不适用于您正在使用的`pcap_dump_open`以及`pcap_dump`上面链接的补丁在不使用任何库的情况下写出`pcap`文件的位置，但无论如何我都会将其留在这里以防万一它有帮助.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-08-12T12:40:38.523

如果你只对 UDP 和 TCP 感兴趣，你应该使用`DLT_EN10MB`而不是`DLT_RAW`（cf [pcap_open_dead 来模拟完整的 UDP 数据包捕获](https://stackoverflow.com/questions/10114739/pcap-open-dead-to-simulate-full-udp-packets-capture)）。

在 WireShak 中编辑时要好得多。

# java - 如果应该加密出口信息的程序崩溃

> ID：10113657
> 
> 赞同：1
> 
> 时间：2012-04-11T20:44:34.247
> 
> 标签：java

假设您有一个在硬盘驱动器上存储消息、地址等的邮件客户端。这些消息位于加密文件中，但当您登录时，它们会被解密，因此您可以访问其中的数据。

当您注销时，这些文件应再次加密。如果成功退出程序，这很容易做到，但是如果有人将计算机断电或程序崩溃，则不会执行加密指令。

有针对这个的解决方法吗？如果您有任何特定于语言的方法来克服这个问题，我正在使用 Java。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-11T20:46:56.413

如果消息没有被提取/保存到磁盘，那么你没有问题。这真的是它应该被处理的方式——全部在内存中，对于这种情况

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-11T20:47:06.767

简单：不要*存储*解密的数据。如果只是为了能够*显示*数据，那么我认为没有理由解密*到磁盘*然后在退出时重新加密。最好将其加密在磁盘上，在内存中解密（按需），然后当进程终止时，一切都很好。

您仍然可能需要担心在加载数据时进程的内存被不恰当地访问，但这是一个更难的攻击向量 - 如果这成为一个问题，您可能已经陷入了一些痛苦。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-11T20:47:27.503

解决方案是永远不要存储未加密的文件。

与其解密磁盘并将其读入您的应用程序，不如将加密文件读入您​​的应用程序，然后在内存中解密。然后，当您断电时，您会丢失数据，就像您没有保存一样，但这就是您所期望的。

# ajax - jQuery ajax 调用重定向到另一个域的域（不遵循）

> ID：10113661
> 
> 赞同：6
> 
> 时间：2012-04-11T20:44:55.017
> 
> 标签：ajax, jquery, cross-domain

这是一个跨域问题，但问题是浏览器（Chrome）似乎没有遵循重定向。相反，jQuery ajax 调用没有返回任何内容，并且出现错误。

我正在尝试使用`jQuery.ajax`，但我使用的 URL 重定向到另一个域。发生这种情况时，我得到一个错误。是否有什么特别需要做的，以便浏览器跟随重定向？

我已经添加`access-control-allow-origin: *`到被重定向到的第二个域的标题中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-14T23:30:06.527

HTTP 重定向页面被视为任何其他 HTTP 页面，因为它也需要访问控制标头。如果您的重定向页面没有它们，浏览器将永远不会检查被重定向到的页面是否具有适当的权限。

与`Location`重定向页面上的标题一起，还添加`Access-Control-Allow-Origin`标题及其相关成分（即`Access-Control-Allow-Methods`等）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T20:48:51.777

获得跨域ajax调用的唯一方法是使用jsonp。

在 jQuery 中，将您的数据类型设置`.ajax()`为“jsonp”。见这里：[http ://api.jquery.com/jQuery.ajax/](http://api.jquery.com/jQuery.ajax/)

如果被重定向到的服务器无法进行 jsonp 响应，它仍然可能无法正常工作。json 响应和 jsonp 响应的区别在于，json 响应是纯 json 字符串，而 jsonp 响应是调用传入 json 字符串的函数的代码。

一个不太破旧的教程：[http ://remysharp.com/2007/10/08/what-is-jsonp/](http://remysharp.com/2007/10/08/what-is-jsonp/)

一个很好的讨论：[谁能用外行的术语解释 JSONP 是什么？](https://stackoverflow.com/questions/3839966/can-any-one-explain-me-what-is-jsonp-in-layman-terms)

# ios - Xcode 4.3.2 给出错误“不能使用 super，因为它是根类”

> ID：10113669
> 
> 赞同：2
> 
> 时间：2012-04-11T20:45:05.657
> 
> 标签：ios, xcode

最近当我更新到 xcode 4.3.2 时，我遇到了许多新问题。在我的应用程序视图控制器 m 文件中，我不断收到错误消息“不能使用 super，因为它是根子句。”

我已经在互联网上看了几个小时，所以任何帮助将不胜感激。

谢谢

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view, typically from a nib.
}

- (void)viewDidUnload
{
    [super viewDidUnload];
    // Release any retained subviews of the main view.
}

- (BOOL)shouldAutorotateToInterfaceOrientation:    (UIInterfaceOrientation)interfaceOrientation
{
    return (interfaceOrientation != UIInterfaceOrientationPortraitUpsideDown);
}

@end 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-19T21:15:04.487

如果您的类继承自另一个自定义类并且如果您在头文件中使用了祖先类 ( ) 的前向声明，但在实现文件中`@class MyAncestorClass`忘记了您的祖先类，也可能会出现此错误。`#import`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-11T21:14:59.257

当你声明你的类时，你可能忘记了超类`@interface`。例如，你做了

```
@interface MyClass
{
    // ... ivars ...
}

// ... methods ...

@end 
```

您希望第一行是：

```
@interface MyClass : NSObject 
```

或您打算使用的任何超类。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-04-29T13:12:06.070

使用此解决方案将有助于您在 phonegap 中遇到此问题

```
#import <Cordova/CDVViewController.h>
#import <Cordova/CDVCommandDelegateImpl.h>
#import <Cordova/CDVCommandQueue.h>

@interface MainViewController : CDVViewController
@end

@interface MainCommandDelegate : CDVCommandDelegateImpl
@end

@interface MainCommandQueue : CDVCommandQueue
@end 
```

# arduino - 您如何观察最低有效位的变化？

> ID：10113675
> 
> 赞同：1
> 
> 时间：2012-04-11T20:45:21.430
> 
> 标签：arduino

我正在使用 Arduino 并开始使用端口寄存器。我喜欢速度的提高和同时更改多个端口的能力。但是，我不知道如何使用端口寄存器观察单个引脚的变化。（我认为它可以用[bitmath](http://www.arduino.cc/playground/Code/BitMath)来完成，但我什至不知道如何开始。）

所以当我检查我的端口寄存器时，我应该得到这样的东西：

```
PINB = B000xxxxx 
```

`x`我的引脚值在哪里。这些引脚中的任何一个都可能发生了变化。我想知道最右边的（最不重要的？）位何时发生了变化。如何使用 bitmath 检查最后一个是否已从 a 切换`0`到 a `1`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-12T18:14:40.233

“Bitmath”确实是问题的答案。在您的情况下：`x & 0x01`将“屏蔽”除最低位之外的所有内容。结果可以与您的意愿进行比较`0`或进行比较。`1`

常见的成语有：

```
x & 0x01    // get only the lowest bit
x & ~0x01   // clear only the lowest bit
x & 0xFE    // same: clear only the lowest bit
x | 0x01    // set the lowest bit (others keep their state) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-15T10:14:40.943

要确定该位是否已更改，您需要先前的值，正如其他人所说，您将其屏蔽掉——

```
int lastValue = PINB & 0x01; 
```

然后在你的代码中你做

```
int currentValue = PINB & 0x01; 
```

获取当前引脚值的 LSB。

要确定您想要“异或”（^）运算符的位是否发生变化——当且仅当两个位不同时，它才是“真”。

```
if (lastValue ^ currentValue) {
  // Code to execute goes here

  // Now save "last" as "current" so you can detect the next change
  lastValue = currentValue;
} 
```

# c# - 防止索引超出范围错误

> ID：10113680
> 
> 赞同：10
> 
> 时间：2012-04-11T20:45:50.070
> 
> 标签：c#

我想为某些条件编写检查，而不必使用 try/catch，并且我想避免出现 Index Out of Range 错误的可能性

```
if (array.Element[0].Object.Length > 0 || array.Element[1].Object.Length > 0) //making sure there's at least one Object array that has values
 {                
    if (array.Element[0].Object[0].Item.Length != 0 || array.Element[1].Object[0].Item.Length != 0) //this is where I check that at least one of the Items (strings) is not empty
       {
           // execute code here
       }
 } 
```

所以我面临的问题是，在第二次检查中，我需要查看我是否有一个不为空的 Item。但是，如果我没有`Element[1]`，我会得到 Index Out of Range 异常。问题是可能有 2 个元素，其中一个（或两者）可能有空对象数组。只有当项目字符串之一不为空时，才必须执行代码。

希望我解释得很好。在任何情况下，我该如何避免出现该异常？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-11T21:17:31.283

好吧，你需要一些更好的[空检查](https://stackoverflow.com/a/4850533/1178921)和一些更谨慎的代码。

```
if (array.Element[0].Object.Length > 0 || array.Element[1].Object.Length > 0) //making sure there's at least one Object array that has values
{                
   if (array.Element[0].Object[0].Item.Length != 0 || array.Element[1].Object[0].Item.Length != 0) //this is where I check that at least one of the Items (strings) is not empty
   {
       // execute code here
   }
} 
```

是不能接受的。

首先，让我们进行空检查

```
if (array != null)
{
    if (array.Element != null) 
```

为简单起见，您可以使用[`&&`](http://msdn.microsoft.com/en-us/library/2a723cdk%28v=vs.71%29.aspx)

```
if (array != null && array.Element != null) 
```

然后，在那个 if 里面，我们使用一个 for 循环（[因为你被困在数组上](https://stackoverflow.com/a/434765/1178921)）并且 null 检查它

```
for (int i = 0; i < array.Element; ++i)
{
    if (array.Element[i] != null && array.Element[i].Object != null)
    { 
```

然后，由于您有嵌套数组，我们再次循环。这称为[嵌套循环](http://www.techotopia.com/index.php/C_Sharp_Looping_-_The_for_Statement)，这通常是不好的做法，我会在一秒钟内向您展示为什么它会起作用。

```
for (int o = 0; o < array.Element[i].Object.length; ++o)
{
    if (array.Element[i].Object[o] != null && !string.IsNullOrEmpty(array.Element[i].Object[o].Item))
    { 
```

现在，由于所有这些丑陋的嵌套循环，我们发现您的 Item 不为空。最重要的是，您可以访问此处的所有潜在值，并且可以根据需要对它们进行分组。以下是我如何将整个事情放在一起以简化。

```
List<string> arrayValues = new List<string>();
if (array != null && array.Element != null)
{
    for (int i = 0; i < array.Element.length; ++i)
    {
        //bool found = false;
        if (array.Element[i] != null && array.Element[i].Object != null)
        {
            for (int o = 0; o < array.Element[i].Object.length; ++o)
            {
                if (array.Element[i].Object[o] != null && !string.IsNullOrEmpty(array.Element[i].Object[o].Item))
                {
                    arrayValues.Add(array.Element[i].Object[o].Item);
                    //if you want to drop out here, you put a boolean in the bottom loop and break and then break out of the bottom loop if true
                    //found = true;
                     //break;
                }
            }
        }
        //if (found)
        //  break;
    }
}
if (arrayValues.Count > 0)
{
    //do stuff with arrayValues
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T20:50:41.397

你能做类似的事情：

```
if(array.Element[0] != null || array.Element[1] != null){
    //execute code
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-11T20:53:54.990

您的代码可能需要重构。

我认为它可以这样工作：

```
var obj = array.Element.FirstOrDefault(x => x.Object.Length > 0);
if (obj != null)
{
  if (obj.Object[0].Item.Length != 0) 
  {
    // do whatever is necessary
  }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-11T21:00:43.583

使用短路将两个测试放在一起，`&&`以便在第一个测试失败时不会发生第二个测试：

```
object element0 = array.Element[0].Object;
object element1 = array.Element[1].Object;

// Ensure at least one Object array has a non-empty value.
if ((element0.Length > 0 && !string.IsNullOrEmpty((string)element0.Object[0].Item))
    || (element1.Length > 0 && !string.IsNullOrEmpty((string)element1.Object[1].Item)))
{
    // ...
} 
```

我假设它`Object[1]`导致了异常——你并不清楚。如果是`Element[1]`导致异常（或两者兼有），那么您需要预先测试数组的长度：

```
if ((array.Element[0].Length != 0 && HasValue(array.Element[0].Object))
    || (array.Element[1].Length > 1 && HasValue(array.Element[1].Object)))
{
    // ...
}

// <summary>
// Returns true if the specified string array contains a non-empty value at
// the specified index.
// </summary>
private bool HasValue(System.Array array, int index)
{
    return array.Length > index && 
        !string.IsNullOrEmpty((string)array.Object[index].Item);
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-11T21:05:15.403

我认为你可以在你的第一个 if Check 之前签入。

```
if (array.Length > 1 && array.Element[0].Object.Length > 0 || array.Element[1].Object.Length > 0) //making sure there's at least one Object array that has values
 {                
    if (array.Element[0].Object[0].Item.Length != 0 || array.Element[1].Object[0].Item.Length != 0) //this is where I check that at least one of the Items (strings) is not empty
       {
           // execute code here
       }
 } 
```

如果您的阵列没有两个元素，这应该只是短路。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-10-16T08:49:23.270

```
for (long i = 0; i <= (output3.Length); i++)
{
    output1.WriteByte(output3[i]); -----> index out of range exception correct it
    output1.WriteByte(output3rx[i]);
} 
```

# c# - 本机 ComboBox 未正确显示选项

> ID：10113681
> 
> 赞同：1
> 
> 时间：2012-04-11T20:45:55.940
> 
> 标签：c#, .net, wpf, windows-phone-7, combobox

**编辑：这似乎** `ListPicker` **是要走的路，但我对详细的** [Microsoft.Phone.Controls.Toolkit ListPicker throws XamlParseException有进一步的问题](https://stackoverflow.com/questions/10155688/microsoft-phone-controls-toolkit-listpicker-throws-xamlparseexception)

我在代码中有以下组合框：

```
<ComboBox x:Name="Result" Grid.Column="6" HorizontalAlignment="Center" VerticalAlignment="Center" Foreground="Black" Background="White">   
    <ComboBoxItem Content="Win" />  
    <ComboBoxItem Content="Place" />  
    <ComboBoxItem Content="Lose" />  
</ComboBox> 
```

但它没有像我预期的那样显示。当您下拉组合框时，选项不会出现，就像空项目一样。见下文：

![在此处输入图像描述](../Images/7bb23b0ca05dc5fe0fe41d36545b47d3.png)

However, when an item is selected, it displays correctly and the correct index/item is returned. 见下文：

![在此处输入图像描述](../Images/31ee53e80f1e906a2247fdb7b02fd2b8.png)

我敢肯定，我错过了一些简单的事情，但无法解决。

编辑：好的，我正在发布完整的代码。我有一个用户控件 OddsRow，它看起来像这样：

```
<UserControl xmlns:toolkit="clr-namespace:Microsoft.Phone.Controls;assembly=Microsoft.Phone.Controls.Toolkit"  x:Class="MojoPinBetOddsCalculator.OddsRow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d"
    FontFamily="{StaticResource PhoneFontFamilyNormal}"
    FontSize="{StaticResource PhoneFontSizeNormal}"
    Foreground="{StaticResource PhoneForegroundBrush}"
    d:DesignHeight="480" d:DesignWidth="480">

    <Grid x:Name="LayoutRoot" Background="{StaticResource PhoneChromeBrush}">
        <Grid.RowDefinitions>
            <RowDefinition Height="70"/>
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="50*"></ColumnDefinition>
            <ColumnDefinition Width="70*"></ColumnDefinition>
            <ColumnDefinition Width="30*"></ColumnDefinition>
            <ColumnDefinition Width="70*"></ColumnDefinition>
            <ColumnDefinition Width="70*"></ColumnDefinition>
            <ColumnDefinition Width="70*" ></ColumnDefinition>
            <ColumnDefinition Width="100*"></ColumnDefinition>
        </Grid.ColumnDefinitions>
        <TextBlock x:Name="RowNumber" Grid.Column="0" VerticalAlignment="Center" HorizontalAlignment="Center"></TextBlock>
        <TextBox x:Name="OddsNumerator" Grid.Column="1" Width="90" Height="70" HorizontalAlignment="Center" TextAlignment="Center" VerticalAlignment="Center" MaxLength="3" InputScope="TelephoneNumber"></TextBox>
        <TextBlock x:Name="Slash" Grid.Column="2" Text="/" HorizontalAlignment="Center" VerticalAlignment="Center"></TextBlock>
        <TextBox x:Name="OddsDenominator" Grid.Column="3" Width="90" Height="70" VerticalAlignment="Center" TextAlignment="Center" MaxLength="3" HorizontalAlignment="Center" InputScope="TelephoneNumber"></TextBox>
        <CheckBox x:Name="EachWay" Grid.Column="4" VerticalAlignment="Center" HorizontalAlignment="Center" Margin="10,0,0,0" />
        <CheckBox x:Name="Place" Grid.Column="5" HorizontalAlignment="Center" VerticalAlignment="Center" BorderThickness="0" Width="71" Margin="10,0,0,0" Padding="0" />
        <ComboBox x:Name="Result" Grid.Column="6" HorizontalAlignment="Center" VerticalAlignment="Center" Foreground="Black" Background="White">
            <ComboBoxItem Content="Win" />
            <ComboBoxItem Content="Place" />
            <ComboBoxItem Content="Lose" />
        </ComboBox>
    </Grid>
</UserControl> 
```

它显示在 MainPage 中，如下所示：

```
<phone:PhoneApplicationPage xmlns:my="clr-namespace:MojoPinBetOddsCalculator"  
    x:Class="MojoPinBetOddsCalculator.MainPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:phone="clr-namespace:Microsoft.Phone.Controls;assembly=Microsoft.Phone"
    xmlns:shell="clr-namespace:Microsoft.Phone.Shell;assembly=Microsoft.Phone"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d" d:DesignWidth="480" d:DesignHeight="768"
    FontFamily="{StaticResource PhoneFontFamilyNormal}"
    FontSize="{StaticResource PhoneFontSizeNormal}"
    Foreground="{StaticResource PhoneForegroundBrush}"
    SupportedOrientations="Portrait" Orientation="Portrait"
    shell:SystemTray.IsVisible="True">

    <!--LayoutRoot is the root grid where all page content is placed-->
    <Grid x:Name="LayoutRoot" Background="Transparent">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!--TitlePanel contains the name of the application and page title-->
        <StackPanel x:Name="TitlePanel" Grid.Row="0" Margin="12,17,0,28">
            <TextBlock x:Name="ApplicationTitle" Text="BET ODDS CALCULATOR" Style="{StaticResource PhoneTextNormalStyle}"/>
            <TextBlock x:Name="PageTitle" Text="calculate" Margin="9,-7,0,0" Style="{StaticResource PhoneTextTitle1Style}"/>
        </StackPanel>
        <!--ContentPanel - place additional content here-->
        <Grid x:Name="ContentPanel" Grid.Row="1" Margin="12,0,12,0" HorizontalAlignment="Stretch">
            <Grid x:Name="Scrollable">
                <ScrollViewer>
                <Grid x:Name="BettingGrid">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"></RowDefinition>
                        <RowDefinition Height="*"></RowDefinition>
                    </Grid.RowDefinitions>
                    <Grid x:Name="BetList">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="30"></RowDefinition>
                            <RowDefinition Height="70"></RowDefinition>
                            <RowDefinition Height="70"></RowDefinition>
                            <RowDefinition Height="70"></RowDefinition>
                            <RowDefinition Height="70"></RowDefinition>
                            <RowDefinition Height="70"></RowDefinition>
                            <RowDefinition Height="70"></RowDefinition>
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="50*"></ColumnDefinition>
                            <ColumnDefinition Width="70*"></ColumnDefinition>
                            <ColumnDefinition Width="30*"></ColumnDefinition>
                            <ColumnDefinition Width="70*"></ColumnDefinition>
                            <ColumnDefinition Width="70*"></ColumnDefinition>
                            <ColumnDefinition Width="70*"></ColumnDefinition>
                            <ColumnDefinition Width="100*"></ColumnDefinition>
                        </Grid.ColumnDefinitions>
                        <TextBlock Text="EW"  Style="{StaticResource PhoneTextNormalStyle}" Grid.Row="0" Grid.Column="4" HorizontalAlignment="Center" />
                        <TextBlock Text="Place"  Style="{StaticResource PhoneTextNormalStyle}" Grid.Row="0" Grid.Column="5" HorizontalAlignment="Center" />
                        <TextBlock Text="Result"  Style="{StaticResource PhoneTextNormalStyle}" Grid.Row="0" Grid.Column="6" HorizontalAlignment="Center" />
                        <my:OddsRow Grid.Row="1" Grid.ColumnSpan="7" Row="1"/>
                        <my:OddsRow Grid.Row="2" Grid.ColumnSpan="7" Row="2"/>
                        <my:OddsRow Grid.Row="3" Grid.ColumnSpan="7" Row="3"/>
                        <my:OddsRow Grid.Row="4" Grid.ColumnSpan="7" Row="4"/>
                        <my:OddsRow Grid.Row="5" Grid.ColumnSpan="7" Row="5"/>
                        <my:OddsRow Grid.Row="6" Grid.ColumnSpan="7" Row="6"/>
                    </Grid>
                    <Grid x:Name="ControlsGrid" Grid.Row="1">
                        <Button x:Name="AddRowButton" Background="#BFFFFFFF" BorderBrush="#BFFFFFFF" Foreground="Black" Content="Add Row" FontSize="16" Click="AddRowButton_Click" Height="70" />
                    </Grid>
                </Grid>
                </ScrollViewer>
            </Grid>
        </Grid>
    </Grid>
</phone:PhoneApplicationPage> 
```

ComboBox 单独工作，OddsRow 的代码也按预期工作......单独工作。组合时，它不显示项目。

OddsRow.xaml.cs

```
public partial class OddsRow : UserControl
{
    private int m_Row;

    public OddsRow()
    {
        InitializeComponent();
    }

    public int Row
    {
        get
        {
            return m_Row;
        }
        set
        {
            m_Row = value;
            RowNumber.Text = m_Row + " - ";
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T21:46:19.203

出于对一切的热爱，请不要使用库存的 ComboBox。使用类似[ListPicker](http://windowsphonegeek.com/articles/listpicker-for-wp7-in-depth)的东西。它将使您的应用程序看起来与 Metro UI 更加一致。

# android - 我应该从哪里开始进行 Android 音频编程？

> ID：10113693
> 
> 赞同：1
> 
> 时间：2012-04-11T20:46:51.170
> 
> 标签：android, audio

我已经在互联网上搜索了一个多星期，现在正在寻找一种在 Android SDK 中操作音频文件的好方法。我的目标是对音频应用特殊效果。有人可以向我指出可以帮助我解决此问题的资源吗？我不得不求助于 StackOverflow，因为它是我所知道的唯一可靠的答案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T22:22:08.077

我假设您的意思是您想对音频文件进行数字处理，即通过某种 DSP 技术来处理字节级别？

如果您想实时操作（即通过麦克风），请查看`android.media.AudioRecord.AudioRecord`. 例如：

```
audioRecord = new AudioRecord(
    MediaRecorder.AudioSource.MIC,
    8000,
    AudioFormat.CHANNEL_IN_STEREO,
    AudioFormat.ENCODING_PCM_16BIT,
    AudioTrack.getMinBufferSize(
        8000,
        AudioFormat.CHANNEL_IN_STEREO,
        AudioFormat.ENCODING_PCM_16BIT)*20);

audioRecord.startRecording();
byte[] readBuffer = new byte[640];
int nbytes = audioRecord.read(readBuffer.getData(),0,readBuffer.length); 
```

这将使您能够访问原始音频数据（在上面的线性 PCM 16 位立体声示例中）。

如果您想读取现有存储的文件（例如从 sdcard 中）并处理音频，请查看`java.io.FileInputStream`. 当然，如果现有文件的格式不是线性 PCM（例如 MP3），那么您可能希望在应用任何 DSP 类型的操作之前将其解码为线性 PCM。 [点击此处](http://www.exampledepot.com/egs/java.io/File2ByteArray.html)查看将文件读入字节数组的示例。 [单击此处](https://stackoverflow.com/questions/9167501/get-pcm-data-from-mp3-file-in-android)获取读取 MP3 文件并获取解​​码的原始 PCM 数据的示例的链接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T21:44:12.150

[Ringdroid](http://code.google.com/p/ringdroid/source/checkout)是开源的，值得一看。不确定这是否符合您的要求。

# java - 禁用遍历键时如何转移自定义组件的焦点？

> ID：10113698
> 
> 赞同：2
> 
> 时间：2012-04-11T20:46:59.263
> 
> 标签：java, swing, focus, jcombobox, key-bindings

我创建了一个`JComboBox`带有自定义弹出窗口的自定义，它实现了`KeyListener`. 我希望从 cmbBox 的弹出窗口中选择一个项目，`Tab`或者`Enter`因此我`setFocusTraversalKeysEnabled(false)`为组合框和弹出窗口设置了。

这种方法的问题是，`KeyListener`当我在容器中使用它时，我必须在组合框中添加另一个以转移焦点。

我可以在我的自定义 JComponent 中触发转移焦点事件（假设）或类似的东西，它将转移其父组件中的焦点，这样我就不必在我使用它的任何地方添加关键侦听器。我用过`transferFocus()`，但它没有转移焦点。

我还没有弄脏[键绑定](http://docs.oracle.com/javase/tutorial/uiswing/misc/keybinding.html)，但是是否有键绑定可以转移焦点？

谢谢

我正在尝试重新创建一个 sscce，但事实证明这很困难。请承受。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T21:05:48.710

Basic Listeners 生命周期即将在真正需要时添加所需的监听器，如果无用则移除监听器

*   我会建议使用 KeyBindings，因为此侦听器是为 Swing JComponents 指定的，并且您可以（肯定与 KeyListener 相同）将此侦听器添加到具体的 JComponent 或其派生类

*   您可以将侦听器添加到 firePopupMenuWillBecomeVisible 上的派生弹出窗口

*   您可以将 ItemListener 添加到派生的 JList

*   可能不是正确的方法，但可以保护[实现到 KeyListener 的所有缺陷](https://stackoverflow.com/a/9991314/714968)，只有 Focus 所有者才能从键盘获取事件，确保 KeyBindings os 的解决方法更加可设置和舒适

注意[请阅读此答案](https://stackoverflow.com/a/10042931/714968)

# vb.net - 从 ReportViewer 控件调用的 SSRS 报表在使用参数调用时不显示报表中的数据

> ID：10113699
> 
> 赞同：0
> 
> 时间：2012-04-11T20:47:00.913
> 
> 标签：vb.net, reporting-services, parameters, ssrs-2008, parameter-passing

你能看看我的编码，让我知道我错过了什么或做错了吗？

我有一个从 ReportViewer 控件调用的 SSRS 报告，并且该控件的 ProcessingMode 是 Remote。该报告的数据集中还有 1 个参数。

在代码中，我放置了一个 MsgBox 以确保代码正在查找参数并返回参数名称。我试图将 10 的值粘贴到 playerID 10 的参数中。该播放器的数据确实存在。

我相信我需要添加更多代码才能完成这项工作，但我不确定还要添加什么。

当代码执行时，会显示报告，但报告中不显示任何数据。

这是编码：

```
Private Sub Form1_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load

    Dim paramList As Generic.List(Of ReportParameter) = New Generic.List(Of ReportParameter)()

    With Me.ReportViewer1
        .ProcessingMode = Microsoft.Reporting.WinForms.ProcessingMode.Remote

        With .ServerReport
            Dim pinfo As ReportParameterInfoCollection = .GetParameters()

            For Each p As ReportParameterInfo In pinfo
                MsgBox(p.Name)
                paramList.Add(New ReportParameter(p.Name, 10))
            Next

            If paramList.Count > 0 Then
                .SetParameters(paramList)
            End If
        End With

        .ShowParameterPrompts = False
    End With
End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T10:44:55.897

找到了一个解决方案，虽然花了一段时间才找到它。

这些代码行将使它工作：

```
Private Sub Form1_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load

    Dim rpParameters = New Microsoft.Reporting.WinForms.ReportParameter

    rpParameters.Name = "PlayerID"
    rpParameters.Values.Add(10)

    Me.ReportViewer1.ShowParameterPrompts = False
    Me.ReportViewer1.ServerReport.SetParameters(rpParameters)
    Me.ReportViewer1.RefreshReport()
End Sub 
```

# perl - 将复杂线拆分为数组

> ID：10113700
> 
> 赞同：0
> 
> 时间：2012-04-11T20:47:02.337
> 
> 标签：perl

我有一个数组，其中元素看起来像这样（包括空格）

```
@array = (
"    795     0|  1",
"      5   135| 17",
"     12   161| 17",
"    244    22| 17",
"     11    25| 17",
"    249   389| 17",
"  22383   443| 17"
); 
```

我需要取出一个元素

```
"    795     0|  1" 
```

并将其拆分为 3 个数字，去掉空格和“|” 在每一行。

```
@new_array =("795","0","1"); 
```

我遇到的问题是数字的空格和大小各不相同。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-11T21:02:58.013

我会使用只匹配数字的正则表达式：

```
#!/usr/bin/perl

use strict ;
use warnings ;
use Data::Dumper ;

my @array = (
"    795     0|  1",
"      5   135| 17",
"     12   161| 17",
"    244    22| 17",
"     11    25| 17",
"    249   389| 17",
"  22383   443| 17"
);

foreach my $item ( @array ) {
  my @tmp = $item =~ m/(\d+)/g ;
  printf "'%s' => %s\n" , $item , Dumper( \@tmp ) ;
} 
```

如果字符串开头没有空格，这也将起作用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-11T20:52:23.400

单程：

```
my ($empty, @array)  = split(/\|?\s+/, "    795     0|  1"); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-12T14:01:18.357

也许像这样更容易和可读的东西可以帮助：

```
#!/usr/bin/perl

use strict;
use warnings;

my @array = (
"    795     0|  1",
"      5   135| 17",
"     12   161| 17",
"    244    22| 17",
"     11    25| 17",
"    249   389| 17",
"  22383   443| 17"
);

my $eggs;

for my $spam (@array) {
    chomp $spam;
    $spam =~ s/^\s*//;
    push @$eggs,  [ split ( /\|?\s+/, $spam ) ];
}

for my $egg (@$eggs) {
    print join (", ", @$egg);
    print "\n";
} 
```

结果是：

```
795, 0, 1
5, 135, 17
12, 161, 17
244, 22, 17
11, 25, 17
249, 389, 17
22383, 443, 17 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-12T03:43:17.270

If you're spacing is truly uniform, you could use Perl's `unpack` to get at the data. See [http://perldoc.perl.org/perlpacktut.html#Packing-Text](http://perldoc.perl.org/perlpacktut.html#Packing-Text)

# python - 如何找到里面的所有文字 使用 BeautifulSoup 的 HTML 页面中的元素

> ID：10113702
> 
> 赞同：3
> 
> 时间：2012-04-11T20:47:04.283
> 
> 标签：python, unicode, html-parsing, beautifulsoup

我需要在 Python 中使用 BeautifulSoup 找到 HTML 文件中段落元素内的所有可见标签。
例如，
`<p>Many hundreds of named mango <a href="/wiki/Cultivar" title="Cultivar">cultivars</a> exist.</p>`
应该返回：
`Many hundreds of cultivars exist.`

PS 某些文件包含需要提取的 Unicode 字符（印地语）。
任何想法如何做到这一点？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-11T20:52:29.170

```
soup.findAll('p') 
```

这是一个[参考](http://www.crummy.com/software/BeautifulSoup/bs3/documentation.html#The%20basic%20find%20method%3a%20findAll%28name,%20attrs,%20recursive,%20text,%20limit,%20%2a%2akwargs%29)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-11T20:56:33.783

这是使用 BeautifulSoup 的方法。这将删除不在 VALID_TAGS 中的所有标签，但保留已删除标签的内容。

```
from BeautifulSoup import BeautifulSoup

VALID_TAGS = ['div', 'p']

soup = BeautifulSoup(value)

for tag in soup.findAll('p'):
    if tag.name not in VALID_TAGS:
        tag.replaceWith(tag.renderContents())

print soup.renderContents() 
```

[参考](https://stackoverflow.com/questions/1765848/remove-a-tag-using-beautifulsoup-but-keep-its-contents)

# postgresql - 在 PostgreSQL 中获取受 UPDATE 影响的行数

> ID：10113706
> 
> 赞同：6
> 
> 时间：2012-04-11T20:47:13.320
> 
> 标签：postgresql

SO和许多博客上都提出了这个问题的变体，但没有一个提供直接的答案。我希望有一个。我正在更新 PostgreSQL 9.0（来自 CodeIgniter，PHP 框架）：

```
$sql_order = "UPDATE meters SET billed=true"; 
$query = $this->db->query($sql_order); 
```

我只需要计算受更新影响的行数，但 PostgreSQL 似乎没有办法做到这一点。该查询现在返回一个布尔值 - true。手册和网络讨论引用`RETURNING`语法、 to`GET DIAGNOSTICS`和默认返回类型 from `UPDATE`。我一直无法让这些工作。有没有一种直接的方法可以让行影响计数，而不必将这个简单的操作嵌入到过程或事务中。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-11T20:54:33.660

在Java中，我会使用以下内容：

```
Statement stmt = connection.createStatement();
int rowsAffected = stmt.executeUpdate("UPDATE ..."); 
```

我相信在 PHP[`pg_affected_rows`](http://php.net/manual/de/function.pg-affected-rows.php)中是这样的。在你的特殊情况下[`$this->db->affected_rows()`](http://codeigniter.com/user_guide/database/helpers.html)

# java - 在 GridWorld 中变形小动物？

> ID：10113716
> 
> 赞同：0
> 
> 时间：2012-04-11T20:47:46.533
> 
> 标签：java, debugging, gridworld

对于这个名为 AntCritter 的新小动物，我重写了 processActors 方法，现在当它应该改变它们的颜色时，它会移除它周围的其他小动物。我已经尝试了一大堆东西，但我无法弄清楚，因为在代码中它直接说如果它是一个 antcritter，就不要删除它。move 方法与 bug 基本相同。

```
public void processActors(ArrayList<Actor> actors)
{
    for(Actor a: actors)
    {
        if(!(a instanceof AntCritter)||!(a instanceof Flower)||!(a instanceof KingCrab))
            a.removeSelfFromGrid();
        if(a instanceof AntCritter)
        {
            setColor(Color.BLUE);
            a.setColor(Color.PINK);
            ((AntCritter) a).move();
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T20:59:28.467

我根本不熟悉 GridWorld，但这是第一个条件：

```
!(a instanceof Flower) 
```

将是什么`true`时候。因此您的语句中的其余条件将永远不会被评估。`a``AntCritter``if`

阅读关于[短路](http://en.wikipedia.org/wiki/Short-circuit_evaluation)评估的更多信息。

# algorithm - Finding the optimal 3D box sizes for a group of 3D rectangular items

> ID：10113717
> 
> 赞同：4
> 
> 时间：2012-04-11T20:47:47.610
> 
> 标签：algorithm, optimization, shipping, calculus

When I say box I am talking about shipping boxes.

I have a number of random sized, small items that I need to pack into as few boxes as possible. I need to know what box sizes are optimal.

*   All items are [rectangular prisms](https://www.google.com/search?q=rectangular%20prisms).
*   It's easy to exclude a box size for an item which is too large to fit.
*   I know the box sizes (they are the available box sizes which I have in-stock)
*   Items can be positioned horizontally or vertically, not diagonal.
*   As many boxes as required can be used. The goal is to use as few boxes as possible.
*   Multiple box sizes may be used to optimally fit the varying-sized items.

What algorithm exists that allows me to calculate the box sizes I need to use for optimal space usage? **To fit the most items into as few boxes as possible.**

The available box sizes come from what I have available, in-stock. You can create a finite number of made up box sizes for example purposes.

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-11T21:24:06.280

This is a generalization of the [Bin packing problem](http://en.wikipedia.org/wiki/Bin_packing_problem), meaning it is NP-Hard.

To see this, imagine all bins and packages have the same width and height, and additionally all bins (but not packages) have the same length. Then it is a one-dimensional problem: we have bins of size V, and packages of size a[1], a[2], ..., a[n]. This simplified case is exactly the Bin-packing problem. Thus, a fast solution to your problem gives us a fast solution to bin-packing, so your problem is at least as hard; and since bin-packing is NP-Hard, so is your problem.

* * *

There are some approximation algorithms available though; for example, it's easy to show that the simple [first-fit](http://en.wikipedia.org/wiki/Bin_packing_problem#First-fit_algorithm) algorithm *(put every item in the first bin that it fits into)* will never do worse than 2x the optimal solution.

The similar "First Fit Decreasing" algorithm *(sort the items in descending order, then put every item in the first bin it fits into)* is even better, guaranteeing to be within about 25% of the optimal solution. There is also another, slightly more complicated algorithm called [MFFD](http://www.sciencedirect.com/science/article/pii/0885064X85900226) which guarantees to be within about 20%.

And of course, with only 7 boxes, you could always just brute-force the solution. This will require about 7^n steps *(where `n` is the number of items)*, so this solution is infeasible with more than a dozen or so items.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-11T21:09:22.123

You have described a variation of the [knapsack problem](http://en.wikipedia.org/wiki/Knapsack_problem). Check out the [wikipedia article](http://en.wikipedia.org/wiki/Knapsack_problem) for more detail about approaches to the problem than could be given here.

# .net - 使用 ItemSource 绑定到 ContextMenu

> ID：10113719
> 
> 赞同：0
> 
> 时间：2012-04-11T20:47:51.157
> 
> 标签：.net, wpf, vb.net

同样的问题：[带有 ItemsSource 的 WPF ContextMenu - 如何在每个项目中绑定到 Command？](https://stackoverflow.com/questions/1580753/wpf-contextmenu-with-itemssource-how-to-bind-to-command-in-each-item)

我尝试如下实现它，但没有骰子。

目前在我的 XAML 中有：

```
<DataGrid.ContextMenu>
            <ContextMenu ItemsSource="{Binding Users}">
                <ContextMenu.ItemTemplate>
                    <DataTemplate>
                        <TextBlock Text="{Binding Path=UID, Converter={StaticResource UserConverter}}"/>
                    </DataTemplate>
                </ContextMenu.ItemTemplate>
                <ContextMenu.ItemContainerStyle>
                    <Style TargetType="MenuItem">
                        <Setter Property="Command" Value="{Binding ReassignFileCommand}" />
                    </Style>
                </ContextMenu.ItemContainerStyle>
            </ContextMenu>
        </DataGrid.ContextMenu> 
```

如果我使用，命令确实有效：

```
 <DataGrid.ContextMenu>
            <ContextMenu>
                <MenuItem Header="Woooo" Command="{Binding ReassignFileCommand}" />
            </ContextMenu>
        </DataGrid.ContextMenu> 
```

**需要更改为（解决方案）：**

```
<Setter Property="Command" Value="{Binding Path=DataContext.ReassignFileCommand, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type ContextMenu}}}" /> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T21:49:19.750

MenuItem 的 DataContext 是来自 Users 集合的对应对象，而不是具有 Users 属性的对象，即 ContextMenu 的 DataContext。您的命令很可能是在该 ContextMenu 数据上下文类中实现的，因此 WPF 找不到它。可以在调试模式下的输出窗口中轻松找到此类绑定错误 (http://blogs.msdn.com/b/wpfsldesigner/archive/2010/06/30/debugging-data-bindings-in-a-wpf-or- silverlight-application.aspx)

您可以通过将命令移动到用户类或将绑定更改为指向正确的类来解决此问题（通过使用 ElementName 或 RelativeSource 绑定到 contextMenu 的数据上下文）

# jquery - 更改提交表单的操作

> ID：10113721
> 
> 赞同：1
> 
> 时间：2012-04-11T20:47:55.913
> 
> 标签：jquery, jqueryform

首先，我将尝试解释我想要做什么：
我有一个动态创建子域的系统，每个子域都有自己的数据库和规则集。在我的主页中，我有一个登录表单，应该用于根据给定的电子邮件访问正确的子域。没关系，但我需要的是：在检查哪个是正确的子域之后，脚本应该如何更改表单操作以登录并重定向到给定的子域？

我的脚本代码是这样的：

```
function myJson(url, postData) {
        Jsondata = $.ajax({
            url : url,
            data : postData,
            type : 'post',
            dataType : 'json',
            async : false
        }).responseText;
        return jQuery.parseJSON(Jsondata);
    }
    $(function() {
        function beforeRequest(formData, jqForm) {
            var url = jqForm.attr('action');
            var data = jqForm.serialize();
            var jsonData = myJson(url, data);
            if (jsonData.success == true) {
                jqForm.attr('action',jsonData.loginUrl);
            } else {
                $("#login-form > .error-tooltip").find('span').empty().text(jsonData.msg).end().fadeIn(300);
                return false;
            }
            return true;
        }
        $("#login-form").submit(function() {
            $(this).ajaxSubmit({
                beforeSubmit : beforeRequest
            });
            return false;
        })
    }) 
```

如果有一种方法可以在没有插件 ajaxForm（根本没有插件）的情况下做到这一点，那将是非常有义务的。我制作的这个脚本，它进行验证，更改表单操作，但它不会重定向。
我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T20:55:50.393

你不能`if`像这样简单地在块中重定向吗

```
if (jsonData.success == true) {
 location.href='your sub domain to redirect to'; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-12T12:43:29.347

我想通了，谢谢我的一个朋友。问题是子域中的登录，它以 302 状态响应，而 jquery ajax 上的成功只需要状态 200，这就是有效的代码：

```
$("#login-form").submit(function(e) {
            e.preventDefault();
            var url = $(this).attr("action");
            var data = $(this).serialize();
            $.ajax({
                url : url,
                data : data,
                type : 'post',
                dataType : 'json',
                beforeSend : function() {
                    $("#login-form > .error-tooltip").fadeOut(300);
                },
                success:function(jsonData){
                    if(jsonData.sucsess == true){
                        $.ajax({
                            url: jsonData.loginSite,
                            data:data,
                            type:'post',
                            complete:function(){
                                window.location = jsonData.site;    
                            }
                        })
                    }else{
                        $("#login-form > .error-tooltip").find('span').empty().text(jsonData.msg).end().fadeIn(300);
                    }
                }
            })
        }) 
```

# .net - 当某个时间帧经过时，从另一个任务启动一个任务线程

> ID：10113722
> 
> 赞同：0
> 
> 时间：2012-04-11T20:48:08.143
> 
> 标签：.net, c#-4.0, task-parallel-library, taskfactory

如何在一定时间 x 秒后从另一个 Task1 启动 ac# 4.0 Task2 (TPL)？

示例场景：

启动计算算法的 Task1。当计算至少需要 X 秒时，启动另一个任务来向用户展示一个不错的动画，而不是阻塞 UI。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T22:01:46.020

开始第一个任务，`Wait(TimeSpan)`以获得结果。如果`Wait`返回`false`，则开始第二个任务。

# javascript - 将拆分后的值从 js 传递到 Django 视图

> ID：10113724
> 
> 赞同：0
> 
> 时间：2012-04-11T20:48:10.693
> 
> 标签：javascript, django, model-view-controller

当我使用 JS 代码拆分某些值时，它会使用“，”分隔符将拆分后的数据发送到视图 我可以更改发送到视图的分隔符“，”吗？我知道拆分函数只接受两个参数 .split(delimiter, limit) 这是 js 代码：

```
$(document).ready(function() {
$('#searchSubmit').click(function() {
    q = $('#q').val().split('\n');
    t = $('#t').val();
    $('#results').html('&nbsp;').load('/?mdhash=' + q + '&type=' + t);
});
});
$(document).ajaxStart(function() {
$('#spinner').show();
}).ajaxStop(function() {
$('#spinner').hide();
}); 
```

这是视图的一部分：

```
def crackit(self, request):
    self.mdhash    = request.GET.get('mdhash', '').split(',')[:15]
    self.type      = request.GET.get('type', '')
    self.api       = request.GET.get('api', '')
    self.clear     = {}
    self.temp      = {}
    self.new       = {}
    self.encrypted = {}
    Remote_ip      = request.META.get('REMOTE_ADDR').split(':')[-1]
    current_path   = request.get_full_path() 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T03:23:48.973

JS`split()`返回一个数组，你想把数组放入字符串中，这很糟糕。您无法确定 JS 究竟如何将数组转换为字符串。因此[`join()`](http://www.w3schools.com/jsref/jsref_join.asp)，在将其连接到 url 之前，数组或从中获取一个元素。您还可以提供任何分隔符`join()`

# apache - mod_proxy：在 8443 上从 apache 代理 tomcat 时，是否需要 tomcat 证书

> ID：10113725
> 
> 赞同：0
> 
> 时间：2012-04-11T20:48:11.993
> 
> 标签：apache, tomcat, ssl, ssl-certificate

我现在开始向我的 web 应用程序添加 SSL 登录页面。我正在使用 apache mod_proxy 代理 tomcat。

一些教程表明我需要为 apache 获取 SSL 证书并将我的登录页面代理到端口 8443 上的 tomcat。

端口 8443 是否自动成为 tomcat 的加密 SSL 端口？我需要一个 apache 证书和一个 tomcat 证书吗？

安迪

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T20:57:39.927

就浏览器而言，Apache Httpd 将“终止”与您的 Web 服务器的 SSL/TLS 连接。它所提供的内容是否实际上来自 Tomcat 对浏览器来说并不重要。在这种情况下，浏览器只能看到 Apache Httpd。如果设置了浏览器可以识别的证书，这就足够了。

除此之外，您可能希望加密 Apache Httpd 和 Tomcat 之间的连接。仅当您不信任两者之间的网络时，这才真正有用（例如，在同一主机上很少有用）。我认为不`mod_proxy_ajp`支持 SSL/TLS，但`mod_proxy_http`确实支持，在这种情况下，您需要配置`SSLProxy*`指令（[请参阅介绍](http://httpd.apache.org/docs/2.2/mod/mod_proxy.html)）：Apache Httpd 在这方面将是一个客户端，在这种情况下，Tomcat 将需要配置一个证书.

如果您不需要加密 Apache Httpd 和 Tomcat 之间的链接，最简单的可能是`mod_proxy_http`用作 Tomcat 纯 HTTP 端口的反向代理（并确保该端口不能被外部访问，通过防火墙例子）。

# vb6 - VB6 声明是否像数组一样工作？

> ID：10113727
> 
> 赞同：0
> 
> 时间：2012-04-11T20:48:19.093
> 
> 标签：vb6

我是 VB 的新手。我正在阅读一些 VB6 代码，我遇到了像这样的声明语句

```
 PQR_SSN(8) As Byte // this probably refers to social security number
  TR_DATA(7) As TransactionDetail 
```

在另一个文件中，定义了 TransactionDetial

```
 Public Type TransactionDetail
  A(0) As Byte  
  B(0) As Byte
  Comment(40) As Byte
  //... etc
  //...
  End Type 
```

TR_DATA(7) 是否意味着它是一个“数组”，可以存储8个TransactionDetail实例？

另外，请考虑评论（40）。我可以像这样访问评论的各个字节吗？

```
 Comment(3) 
```

另外，假设我没有将所有 41 个字节分配给 Comment。那么剩下的字节会包含垃圾值吗？

请帮忙。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T20:55:36.443

是的，TR_DATA(7) 是一个包含 8 个 TransactionDetail 类型元素的数组。

是的，可以通过您展示的单个元素访问 Comments 数组。

未分配的元素*可能*包含垃圾值——我不相信它们——但我不记得 VB 是否有助于预初始化变量。我希望它会对用户有所帮助，并且它将数字变量初始化为 0，将固定长度的字符串初始化为全零，并将对象初始化为 Empty。

找到[这个 web 链接](http://www.1sayfa.com/1024/diger/vb/ch11.htm)，它提供了一些关于 VB6 中数组的有用指导。

也刚刚发现：[VB6 Variable Scope](http://www.vb6.us/tutorials/vb6-variable-scope)；其中说：

> 与许多其他语言不同，VB 不允许您初始化变量。这必须使用可执行语句来完成。但是，每个变量都有一个默认的初始化值。数值变量类型初始化为零，字符串初始化为 ""，布尔值初始化为 False，等等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T13:58:43.783

@Nick：是的，VB 确实如您所想。

@CodeBlue：您的最后一个问题表明您可能想要调查动态数组。如果是这样，我建议您特别调查 Redim 和 Preserve 声明。

# c# - lambda 可以允许另一个对象注入一个动作吗

> ID：10113732
> 
> 赞同：0
> 
> 时间：2012-04-11T20:48:29.763
> 
> 标签：c#, winforms, events, lambda

我想要一个 WinForm`OnLoad`用另一个对象注册事件 - 比如：

```
 SomeObject.RegisterEvent(action => this.OnLoad += (o,e) => action(o,e)); 
```

这可能吗？我不介意在“SomeObject”端为“助手”创建委托或表达式来执行此操作，但我试图弄清楚我的方法签名对于`RegisterEvent(...)`.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T20:53:44.353

RegisterEvent 方法需要如下所示：

```
void RegisterEvent(Action<EventHandler> addEventHandler)
{
    addEventHandler((sender, e) =>
    {
        // loaded
    });
} 
```

*用法：*

```
someObject.RegisterEvent(handler => { this.OnLoad += handler; }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T20:55:05.880

```
 SomeObject.RegisterEvent(action => { this.OnLoad += (o,e) => {action(o,e);}; }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-11T21:05:01.467

如果你真的需要这样的东西（总是一个好问题，通常这样的事情表明设计有点奇怪，但不是必须的），

我会说你应该看看[The Reactive Extensions (Rx)](http://msdn.microsoft.com/en-us/data/gg577609) ...。
它们为处理和触发您自己的“事件”提供了便利，或多或少类似于属性或方法（并且没有委托的典型痛苦，添加/订阅或私有限制等，过于简化了一点）。
......这可能看起来像......

```
someObjectInstance.MyEvent.Subscribe(d=>
{
    // ... your lambda more or less
}); 
```

...并且在类中，如果仅简化一个`Subject<MyEventData> _myEvent;`and `_myEvent.OnNext(data)`（进入您想要从中上升的方法）+ 用于公开该字段的属性（`IObservable<MyEventData> MyEvent {get{return _myEvent;}}`）。

这才是你真正想要的。

您可以从 NuGet 安装它们并在几分钟内使用。尽管对于更棘手的情况有一个学习曲线。

此外，您还可以从未来的活动组合中获益，还有更多。

（不是“其中之一”，只是一项非常好的新技术）

# html - 将html页面的所有元素放到页面的中心

> ID：10113734
> 
> 赞同：-1
> 
> 时间：2012-04-11T20:48:38.860
> 
> 标签：html

我有一个按钮、两个文本框和一些文本。如何将所有这些元素放入页面中心？

```
<body>
        Hello world!
        <p><input TYPE="text" name="textbox1"><p> 
        <p><input TYPE="text" name="textbox2"></p>
        <p><input TYPE="button" VALUE="Enter" ONCLICK="HomeButton()"></p> 
            <script>
                function HomeButton()
                {
                    location.href="registration.html";
                }
            </script>
</body> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-11T20:51:03.090

我会做这样的事情，或者你可以使用外部 CSS 表 :)

```
<!--In your <head> add this-->

<style type="text/css">
body{margin:0;padding:0}
#body{width:800px; margin:auto}
</style>

<!--And here is your body-->

<body>
<div id="body">
CONTENT HERE!
</div>
</body> 
```

这将设置为 800px 的宽度，然后将其对齐在页面的中心

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-11T20:54:33.470

您可以将这些控件放入`div`或使用`<center>`标签或`<body align="center">`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-11T21:06:33.483

使用表格或 div

试试下面的代码

```
<body >
    <table width="100%" border="0">
      <tr>
        <td height="200">&nbsp;</td>
        <td>&nbsp;</td>
      </tr>
      <tr>
      <td width="400px">&nbsp;</td>
        <td> Hello world!
            <p><input TYPE="text" name="textbox1"><p> 
            <p><input TYPE="text" name="textbox2"></p>
            <p><input TYPE="button" VALUE="Enter" ONCLICK="HomeButton()"></p> </td>

      </tr>
    </table>

    </body> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-11T20:51:14.593

尝试这个：

```
<body>
<div style="margin:0 auto;text-align:center;">
        Hello world!
        <p><input TYPE="text" name="textbox1"><p> 
        <p><input TYPE="text" name="textbox2"></p>
        <p><input TYPE="button" VALUE="Enter" ONCLICK="HomeButton()"></p> 
            <script>
                function HomeButton()
                {
                    location.href="registration.html";
                }
            </script>
</div>
</body> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-11T20:53:08.660

看看这个。他们解释了您的问题的解决方案：[http ://www.dynamicsitesolutions.com/css/center-page-content-horizo​​ntally-and-vertically/](http://www.dynamicsitesolutions.com/css/center-page-content-horizontally-and-vertically/)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-04-11T20:53:26.090

放：

```
​body {
    text-align: center;
} 
```

在你的 CSS 中。​JSFiddle：http: [//jsfiddle.net/QXkCn/1/](http://jsfiddle.net/QXkCn/1/)

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2012-04-11T20:53:37.323

为此，只需`<body align="center">` 在此处使用它的外观[Fiddle](http://jsfiddle.net/C5ZE8/)

虽然这不是一个好习惯，但这会奏效，

# iphone - iOS：循环图像的像素

> ID：10113737
> 
> 赞同：3
> 
> 时间：2012-04-11T20:48:45.870
> 
> 标签：iphone, ios, image-processing, uiimage

我有两个相同格式和大小的图像。

我想遍历每个图像的像素并找到最左上角和最右下角的差异坐标。

差异被认为是具有相同坐标的两个像素的像素颜色。

您能否为我提供一个循环通过图像像素并获取其颜色值的示例代码？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-11T21:15:56.603

这对我有用（这是使用 ARC）：

```
- (BOOL) pointInside: (CGPoint) point withEvent: (UIEvent *) event {
    CGRect r = CGRectZero ;

    r.size =[self size] ;

    CGFloat red ;
    CGFloat green ;
    CGFloat blue ;
    CGFloat alpha ;

    if (point.x < 0 || point.x > r.size.width || point.y < 0 || point.y > r.size.height) {
        return NO ;
    }

    [inspector colorAt:point red:&red green:&green blue:&blue alpha:&alpha] ;

    return alpha > 0.01f ;
} 
```

这就是魔法:)

```
// CGImageInspection.h
#import <Foundation/Foundation.h>

@interface CGImageInspection : NSObject

+ (CGImageInspection *) imageInspectionWithCGImage: (CGImageRef) imageRef ;

- (void) colorAt: (CGPoint) location
             red: (CGFloat *) red 
           green: (CGFloat *) green
            blue: (CGFloat *) blue
           alpha: (CGFloat *) alpha ;

@end 
```

以及相应的实现：

```
// CGImageInspection.mm
@interface CGImageInspection ()

- (id) initWithCGImage: (CGImageRef) imageRef ;

@property (assign, nonatomic) CGContextRef  context ;
@property (assign, nonatomic) void *        pixels ;
@property (assign, nonatomic) NSUInteger    bytesPerRow ;
@property (assign, nonatomic) NSUInteger    bytesPerPixel ;

@end

@implementation CGImageInspection

@synthesize context ;
@synthesize pixels ;
@synthesize bytesPerRow ;
@synthesize bytesPerPixel ;

- (void) dealloc {
    if (self.context) {
        ::CGContextRelease(self.context) ;
        self.context = 0 ;
    }

    if (self.pixels) {
        ::free(self.pixels) ;
        self.pixels = 0 ;
    }

    ::NSLog(@"CGImageInspection going away") ;
}

+ (CGImageInspection *) imageInspectionWithCGImage: (CGImageRef) imageRef {
    return [[CGImageInspection alloc] initWithCGImage:imageRef] ;
}

- (id) initWithCGImage: (CGImageRef) imageRef {

    if (self = [super init]) {
        size_t  pixelsWide = ::CGImageGetWidth(imageRef) ;
        size_t  pixelsHigh = ::CGImageGetHeight(imageRef) ;

        self.bytesPerPixel = 4 ;
        self.bytesPerRow = (pixelsWide * self.bytesPerPixel) ;
        int     bitmapByteCount   = (self.bytesPerRow * pixelsHigh) ;

        CGColorSpaceRef colorSpace= ::CGColorSpaceCreateDeviceRGB() ;

        if (colorSpace == 0) {
            return nil ;
        }

        self.pixels = ::calloc(bitmapByteCount, 1) ;
        if (self.pixels == 0) {
            ::CGColorSpaceRelease(colorSpace) ;
            return nil ;
        }

        self.context = ::CGBitmapContextCreate(
            self.pixels
        ,   pixelsWide
        ,   pixelsHigh
        ,   8      // bits per component
        ,   self.bytesPerRow
        ,   colorSpace
        ,   kCGImageAlphaPremultipliedLast | kCGBitmapByteOrder32Big) ;

        if (self.context == 0) {
            ::free(self.pixels) ;
            self.pixels = 0 ;
            ::CGColorSpaceRelease(colorSpace) ;
            return nil ;
        }
        ::CGContextDrawImage(context, (CGRect) {{0, 0}, {pixelsWide, pixelsHigh}}, imageRef) ;
        ::CGColorSpaceRelease(colorSpace) ;
    }

    return self ;

}

- (void) colorAt: (CGPoint) location
             red: (CGFloat *) red 
           green: (CGFloat *) green
            blue: (CGFloat *) blue
           alpha: (CGFloat *) alpha {

    int yy = (int) location.y ;
    int xx = (int) location.x ;

    int byteIndex = (bytesPerRow * yy) + xx * bytesPerPixel ;
    unsigned char * raw = (unsigned char *) self.pixels ;
    raw += byteIndex ;

    *red    = ((CGFloat) (*raw++)) / 255.0f ;
    *green  = ((CGFloat) (*raw++)) / 255.0f ;
    *blue   = ((CGFloat) (*raw++)) / 255.0f ;
    *alpha  = ((CGFloat) (*raw++)) / 255.0f ;
}

@end 
```

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T21:08:30.143

我认为你被否决了，因为根本不清楚你用谷歌搜索过，不知道，也许你做过，而你的 google-fu 今天不工作。我知道我有过这样的日子！

无论如何，[如何获取 iphone 上图像上像素的 RGB 值](https://stackoverflow.com/questions/144250/how-to-get-the-rgb-values-for-a-pixel-on-an-image-on-the-iphone)可能会对您有所帮助。

# javascript - 点击 OpenLayers Map through layer

> ID：10113743
> 
> 赞同：1
> 
> 时间：2012-04-11T20:49:16.913
> 
> 标签：javascript, openlayers, openstreetmap

我的页面上有一张地图。还有一个透明 div，位于地图顶部（使用 CSS）。

是否可以通过这个透明层**拖动地图？**该图层不应该移动，只是它下面的地图。

可以将地图拖到窗口外（请参阅[http://dev.openlayers.org/releases/OpenLayers-2.11/examples/document-drag.html](http://dev.openlayers.org/releases/OpenLayers-2.11/examples/document-drag.html)），但我想**开始在透明层上拖动**。有没有办法做到这一点？

# xcode - 为什么代码签名在 XCode 4.3.2 File-New 中不可用？

> ID：10113751
> 
> 赞同：1
> 
> 时间：2012-04-11T20:49:45.740
> 
> 标签：xcode, ad-hoc-distribution

我正在尝试创建一个临时分发配置文件以首次使用测试飞行。第一步是通过转到 File-New 然后在左侧面板中选择 Code Signing 创建一个权利文件。但是，没有列出代码签名。

![在此处输入图像描述](../Images/32f4de4f3188536fdd2b2209ddde4dd7.png)

我是否必须配置一些东西才能显示此选项？

# javascript - JavaScript：列表未显示

> ID：10113762
> 
> 赞同：0
> 
> 时间：2012-04-11T20:50:24.953
> 
> 标签：javascript, html

我想很简单，但我在这方面完全是新手。我尝试在 PHP 中执行此操作，但后来又重新考虑在 JS 中执行此操作，所以我需要一些帮助。编码：

```
<html>
<head>
    <title>Test</title>
    <script type="text/javascript">
function reply_click(clicked_id)
{
    alert(clicked_id);
    var basketItems=new Array();
    //var i = 0;
    basketItems[1] = clicked_id;

}

</script>
</head>
<body>

    <table height="100%" width="80%" cellspacing="10" cellpadding="10" border="1">
        <tr>
            <td align="center"><input onClick="reply_click(this.name)"  name="shirt" value="shirt" style="width:200px; height:100px;" type="submit"/></td>
            <td align="center"><input onClick="reply_click(this.name)" name="pants" value="pants" style="width:200px; height:100px;" type="submit"/></td>
            <td align="center"><input onClick="reply_click(this.name)"  name="socks" value="socks" style="width:200px; height:100px;" type="submit"/></td>
        <tr>
        <tr>
            <td align="center"><input onClick="reply_click(this.name)" name="dress" value="dress" style="width:200px; height:100px;" type="submit"/></td>
            <td align="center"><input onClick="reply_click(this.name)" name="skirt" value="skirt" style="width:200px; height:100px;" type="submit"/></td>
            <td align="center"><input onClick="reply_click(this.name)" name="topbody" value="topbody" style="width:200px; height:100px;" type="submit"/></td>
        <tr>
        <tr>
            <td align="center"><input onClick="reply_click(this.name)" name="sheets" value="sheets" style="width:200px; height:100px;" type="submit"/></td>
            <td align="center"><input onClick="reply_click(this.name)" name="pillowcover" value="pillowcover" style="width:200px; height:100px;" type="submit"/></td>
            <td align="center"><input onClick="reply_click(this.name)" name="blanket" value="blanket" style="width:200px; height:100px;" type="submit"/></td>
        <tr>        
    </table>

<div style="width:18%; height:40%;position: absolute; top: 20px; right: 10px; border:2px solid;">
<script type="text/javascript">
var counter=0;
for (counter=0; counter<basketItems.length; counter++)
   document.write(basketItems[counter] + "<br>");
</script>
</div>
<br><br><br> 
```

现在我期望会发生什么。我单击按钮，警报出现并单击按钮名称...然后将其添加到列表中。在它之后在 div 标签中显示该列表。怎么了？它只是显示警报，但 div 标签中没有显示任何内容，所以我假设插入数组或打印有问题...

谢谢，

更新：此代码似乎适用于 jsfiddle，但不适用于我的浏览器......任何线索有什么不同？

```
<html>
<head>
    <title>Test</title>
<script type="text/javascript">
var basketItems = [];

function reply_click(clicked_id)
{
    alert(clicked_id);
    basketItems.push(clicked_id);

    var html = '';
    for(var i = 0; i < basketItems.length; i++) {
        html += basketItems[i] + '<br/>';   
    }

    document.getElementById('list').innerHTML = html;
}​
</script>
</head>
<body>

    <table height="100%" width="80%" cellspacing="10" cellpadding="10" border="1">
        <tr>
            <td align="center"><input onClick="reply_click(this.name)"  name="shirt" value="shirt" style="width:200px; height:100px;" type="submit"/></td>
            <td align="center"><input onClick="reply_click(this.name)" name="pants" value="pants" style="width:200px; height:100px;" type="submit"/></td>
            <td align="center"><input onClick="reply_click(this.name)"  name="socks" value="socks" style="width:200px; height:100px;" type="submit"/></td>
        <tr>
        <tr>
            <td align="center"><input onClick="reply_click(this.name)" name="dress" value="dress" style="width:200px; height:100px;" type="submit"/></td>
            <td align="center"><input onClick="reply_click(this.name)" name="skirt" value="skirt" style="width:200px; height:100px;" type="submit"/></td>
            <td align="center"><input onClick="reply_click(this.name)" name="topbody" value="topbody" style="width:200px; height:100px;" type="submit"/></td>
        <tr>
        <tr>
            <td align="center"><input onClick="reply_click(this.name)" name="sheets" value="sheets" style="width:200px; height:100px;" type="submit"/></td>
            <td align="center"><input onClick="reply_click(this.name)" name="pillowcover" value="pillowcover" style="width:200px; height:100px;" type="submit"/></td>
            <td align="center"><input onClick="reply_click(this.name)" name="blanket" value="blanket" style="width:200px; height:100px;" type="submit"/></td>
        <tr>        
    </table>

<div id="list" style="width:18%; height:40%;position: absolute; top: 20px; right: 10px; border:2px solid;">

</div>
</body>
</html> 
```

并且 JS 小提琴链接是：http: [//jsfiddle.net/fVQVy/](http://jsfiddle.net/fVQVy/)作为解决方案发布在这里感谢大家的耐心等待......非常感谢......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T20:57:03.477

试试这个[演示](http://jsfiddle.net/mplungjan/tC8rU/)

```
<html>
<head>
    <title>Test</title>
    <script type="text/javascript">
    var basketItems=[];

function reply_click(clicked_id) {
   var html = "";
   basketItems.push(clicked_id);
   for (var counter=0; counter<basketItems.length; counter++) 
      html += basketItems[counter] + "<br>";
   // or as posted html = basketItems.join('<br/>');
   document.getElementById("result").innerHTML = html;
}

</script>
</head>
<body> 
```

也让它成为一个按钮而不是提交，因为这可能会重新加载页面

```
 <table height="100%" width="80%" cellspacing="10" cellpadding="10" border="1">
        <tr>
            <td align="center"><input onClick="reply_click(this.name)"  name="shirt" value="shirt" style="width:200px; height:100px;" type="button"/></td>
        <tr>        
    </table>

<div id="result" style="width:18%; height:40%;position: absolute; top: 20px; right: 10px; border:2px solid;">

</div>
<br><br><br> 
```

**更新**

以下是如何添加到结果中

```
function reply_click(clicked_id) {
   basketItems.push(clicked_id);
   document.getElementById("result").innerHTML+=clicked_id+'<br/>';
} 
```

**更新处理重复**

```
var basketItems=[];

function reply_click(clicked_id) {
   if (basketItems.indexOf(clicked_id)==-1) basketItems.push(clicked_id);
   document.getElementById("result").innerHTML = basketItems.join("<br>");
}

// handle duplicates
if(!Array.indexOf) {
  Array.prototype.indexOf = function(obj){
    for(var i=0; i<this.length; i++){
      if (this[i]==obj) return i;
    }
    return -1;
  }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-11T20:53:26.177

到`reply_click`调用时，您调用的脚本`document.write`已经执行。

```
<html>
<head>
    <title>Test</title>
    <script type="text/javascript">

    var basketItems = [];
    function reply_click(clicked_id)  {
      // This does not handle duplicate clicks, leave that up to you
      basketItems.push(clicked_id);
      var out = document.getElementById('output');
      out.innerHTML = basketItems.join('<br/>');
    }
</script>
</head>
<body>
    <table height="100%" width="80%" cellspacing="10" cellpadding="10" border="1">
        <tr>
            <td align="center"><input onClick="reply_click(this.name)"  name="shirt" value="shirt" style="width:200px; height:100px;" type="submit"/></td>
            <td align="center"><input onClick="reply_click(this.name)" name="pants" value="pants" style="width:200px; height:100px;" type="submit"/></td>
            <td align="center"><input onClick="reply_click(this.name)"  name="socks" value="socks" style="width:200px; height:100px;" type="submit"/></td>
        <tr>
        <tr>
            <td align="center"><input onClick="reply_click(this.name)" name="dress" value="dress" style="width:200px; height:100px;" type="submit"/></td>
            <td align="center"><input onClick="reply_click(this.name)" name="skirt" value="skirt" style="width:200px; height:100px;" type="submit"/></td>
            <td align="center"><input onClick="reply_click(this.name)" name="topbody" value="topbody" style="width:200px; height:100px;" type="submit"/></td>
        <tr>
        <tr>
            <td align="center"><input onClick="reply_click(this.name)" name="sheets" value="sheets" style="width:200px; height:100px;" type="submit"/></td>
            <td align="center"><input onClick="reply_click(this.name)" name="pillowcover" value="pillowcover" style="width:200px; height:100px;" type="submit"/></td>
            <td align="center"><input onClick="reply_click(this.name)" name="blanket" value="blanket" style="width:200px; height:100px;" type="submit"/></td>
        <tr>        
    </table>

<div id='output' style="width:18%; height:40%;position: absolute; top: 20px; right: 10px; border:2px solid;">

</div> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-11T20:53:47.317

`basketItems`每次调用您的函数时，您的数组都将被初始化为一个空数组，从而覆盖以前的条目。此外，您不是在添加它，而是每次都覆盖第二个条目（键 1）。

将其移出函数，进入全局范围。

**编辑：**给你一个小提琴：http: [//jsfiddle.net/3v4W2/1/](http://jsfiddle.net/3v4W2/1/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-11T21:02:16.867

每次执行 reply_click() 时，您都在重新创建数组。此外，底部的脚本仅在页面加载期间执行一次。请参阅以下工作示例 - [http://jsfiddle.net/fVQVy/](http://jsfiddle.net/fVQVy/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-11T20:52:52.777

您的`document.write`代码在页面加载时执行一次，当时`baskeItems`为空。

如果您想在每次点击时动态更新页面，您应该创建一个更新文档的函数，每次点击时调用该函数

# cakephp - 从外部 ctp 文件中获取块

> ID：10113765
> 
> 赞同：2
> 
> 时间：2012-04-11T20:50:27.370
> 
> 标签：cakephp, view, block, cakephp-2.1

我读[了这个](http://book.cakephp.org/2.0/en/views.html)和[这个](http://mark-story.com/posts/view/view-inheritance-in-cakephp)。但我找不到答案。

我有这个文件，其中存在我的操作视图： **View/MyController/index.ctp**

我也有这个文件 **View/Commons/blocks.ctp**

**Blocks.ctp**文件包括以下内容：

```
$this->start('sidebar1');
echo 'Some content';
$this->end();

$this->start('sidebar2');
echo 'Some content more';
$this->end(); 
```

* * *

所以在“ **index.ctp** ”文件中我想获取**sidebar1**或**sidebar2**。我怎样才能做到这一点？我把它写到**index.ctp**，但没有用。

```
<?php echo $this->fetch('sidebar1'); ?> 
```

这个也没用

```
<?php echo $this->fetch('../View/Commons/blocks.ctp/sidebar1'); ?> 
```

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-12T09:46:59.030

放在 index.ctp 的顶部：

```
$this->extend('Common/blocks.ctp'); 
```

通过块和视图继承，您可以创建基本上类似于标准 Cake 布局文件的“子布局”。因此，您将拥有主 layout.ctp，而控制器操作视图 ctp 将基于通过块“填充”的父视图文件（例如 /Commons/xxxx.ctp）。

块类似于元素，但不那么“正式”，除非您使用“视图继承”功能。它们的标记和数据在您的脚本中创建，可能在多个位置，因此调试/维护它们可能更麻烦（即想象将标记附加到来自多个类的块）。如果您不使用继承，它们也更难重用。

元素更像是可以在任何控制器+动作视图或布局中使用的独立视图文件：所有标记都在一个地方，您只需传入数据。

底线：如果你是 Cake 新手，你可以只用元素就可以过得很好。视图继承可以帮助使视图/布局更加优雅，但代价是一些复杂性。

# mongodb - 使用迭代动态构建 Criteria Block

> ID：10113776
> 
> 赞同：0
> 
> 时间：2012-04-11T20:51:07.377
> 
> 标签：mongodb, grails, grails-orm

我想根据几个过滤器查询属性并动态构建条件

```
Domain Class
PatientAttr {
   def name
   def value
} 
```

**标准建筑规范**

```
 if(filters.size() != 0 ){
        def criteria =  PatientAttr.createCriteria()
        def results = criteria.list{
            for (item in filters){
                def name = item.name
                def filter = item.filter
                and{
                    eq 'name', name
                    if(filter[0] == "lt")
                        lt ('value', filter[1] as Double)
                    else if(filter[0] == "gt")
                        gt ('value', filter[1] as Double)
                    else 
                        between ('value', filter[0] as Double, filter[1] as Double)
                }
            }
        } 
```

我发现只有列表的最后一个“and”语句正在被评估。标准构建器是否允许您动态构建标准？

上面的代码应该等价于这个

```
 def results = criteria.list{
            and{
                eq 'name', "Serum albumin (g/dL)"
                gt 'value', 3.5 as Float
            }
            and{    
                eq 'name', "M-spike (g/dL)"
                gt 'value', 2.3 as Float
            }
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T20:58:53.227

我不知道您为什么会遇到麻烦，但是由于查询的默认连接是`and`，因此根本没有理由在您的示例中使用`and{}`闭包。您上面的查询与以下内容相同：

```
 def results = criteria.list{
        eq 'name', "Serum albumin (g/dL)"
        gt 'value', 3.5 as Float
        eq 'name', "M-spike (g/dL)"
        gt 'value', 2.3 as Float
    } 
```

如果您希望将顶层项目`or`放在一起，则需要将外部块包装在`or{}`闭包中：

```
if(filters.size() != 0 ){
    def criteria =  PatientAttr.createCriteria()
    def results = criteria.list{
        or{
            for (item in filters){
                def name = item.name
                def filter = item.filter
                and{
                    eq 'name', name
                    if(filter[0] == "lt")
                        lt ('value', filter[1] as Double)
                    else if(filter[0] == "gt")
                        gt ('value', filter[1] as Double)
                    else 
                        between ('value', filter[0] as Double, filter[1] as Double)
                }
            }
        }
    } 
```

这将返回一个查询，其结果如下：

> 名称为“血清白蛋白...”且值大于“3.5”
> *或*
> 名称为“M-spike...”且值大于 2.3
> *或等*

希望这会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T22:21:14.987

在你的街区：

```
 def results = criteria.list{
        and{
            eq 'name', "Serum albumin (g/dL)"
            gt 'value', 3.5 as Float
        }
        and{    
            eq 'name', "M-spike (g/dL)"
            gt 'value', 2.3 as Float
        }
    } 
```

你的意思是表达：

```
((name == "Serum albumin (g/dL)") or (value == 3.5))
and
((name == "M-spike (g/dL)") or (value == 3.3)) 
```

那么你的代码应该是：

```
if(filters.size() != 0 ){
    def criteria =  PatientAttr.createCriteria()
    def results = criteria.list{
        and{
            for (item in filters){
                def name = item.name
                def filter = item.filter
                or {
                    eq 'name', name
                    if(filter[0] == "lt")
                        lt ('value', filter[1] as Double)
                    else if(filter[0] == "gt")
                        gt ('value', filter[1] as Double)
                    else 
                        between ('value', filter[0] as Double, filter[1] as Double)
                }
            }
        }
    } 
```

如果你想表达：

```
((name == "Serum albumin (g/dL)") and (value == 3.5))
and
((name == "M-spike (g/dL)") and (value == 3.3)) 
```

那么你的代码应该是：

```
if(filters.size() != 0 ){
    def criteria =  PatientAttr.createCriteria()
    def results = criteria.list{
        and{
            for (item in filters){
                def name = item.name
                def filter = item.filter
                eq 'name', name
                if(filter[0] == "lt")
                    lt ('value', filter[1] as Double)
                else if(filter[0] == "gt")
                    gt ('value', filter[1] as Double)
                else 
                    between ('value', filter[0] as Double, filter[1] as Double)
            }
        }
    } 
```

因为 and 是默认操作，所以可以省略 and 方法。

# arrays - Perl：对数组使用条件

> ID：10113778
> 
> 赞同：2
> 
> 时间：2012-04-11T20:51:23.010
> 
> 标签：arrays, perl, loops, syntax, conditional

所以我首先要说我对 Perl 不是很熟悉。我有一个项目，我在工作中被交给了需要相当多的 Perl 工作。其中大部分是有道理的，但我被困在一个非常简单的问题上。

出于示例目的，我已经简化了我的代码。如果我能让它工作，我可以对项目的其余部分进行编码，但由于某种原因，我似乎无法获得像以下这样简单的东西来为我工作：

```
#!/usr/local/bin/perl
@names = ('Harry','Larry','Moe');
foreach $name (@names){
    if($name == 'Harry'){
        print $name;
    }
} 
```

任何帮助是极大的赞赏！

编辑：仅供参考以上的输出如下：

```
HarryLarryMoe 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-11T20:53:44.977

Perl 中的字符串比较不是用，`==`而是用`eq`. Perl 不会考虑与`13`字符串不同的整数，`'13'`直到您对它们进行操作。[不以任何明显方式（例如`'Harry'`）表示数字的字符串值被强制为数值零](http://perldoc.perl.org/perldata.html#Scalar-values)。因此，`$name=='Harry'`将永远持有，但`$name eq 'Harry'`不会。

查看[`perldoc perlop`](http://perldoc.perl.org/perlop.html)更多信息。

**编辑添加：** 如果您启用了`warnings`编译指示，那么解释器会向您指出这一点。事实上，在您编写的几乎所有 Perl 代码中，它总是一个**好**主意。特别是，这段代码（通过命令行作为单行代码执行）：[`use strict`](http://p3rl.org/strict)[`use warnings`](http://p3rl.org/warnings)`perl -e`

```
use strict;
use warnings;
my @names=("Harry","Larry","Moe");

foreach my $name(@names)
{
  if($name=="Harry")
  {
    print "$name\n";
  }
} 
```

产生输出

```
Argument "Harry" isn't numeric in numeric eq (==) at -e line 7.
Argument "Harry" isn't numeric in numeric eq (==) at -e line 7.
Harry
Argument "Larry" isn't numeric in numeric eq (==) at -e line 7.
Larry
Argument "Moe" isn't numeric in numeric eq (==) at -e line 7.
Moe 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-11T20:56:57.300

之所以这样，是因为您使用数值比较，但应该使用字符串一 ( `eq`)。`$name`并将`Harry`两者都评估为 0，因此您的示例中的比较总是正确的。

# mysql - 为什么在 MySQL 查询中使用 `AS` 而不是写表名？

> ID：10113781
> 
> 赞同：0
> 
> 时间：2012-04-11T20:51:33.320
> 
> 标签：mysql

写作的收获：

```
SELECT m.`iD` FROM `MyTable` AS m 
```

代替：

```
SELECT `MyTable`.`iD` FROM `MyTable` 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-11T20:53:45.613

任何一种形式都是可以接受的。有时你这样做只是为了减少打字量。有时它是必要的，例如在将表与自身连接时。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-11T20:54:00.350

在您的示例中，不多，但是在较大的查询中，在键入时缩写表名会更快、更容易和更简洁。约定首选一个或两个字母别名。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-11T20:53:49.843

写的更短！有时表名可能很神秘，以便您获得更好的可读性。还要在同一个表上成像一个连接，然后有必要使用它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-11T20:57:27.177

主要目的是将列的名称更改为“AS”名称，以便后续结果集处理。假设您有一个函数读取结果集并需要一个名为“FOO”的列，但您的表有一个名为“BAR”的列。

如果你写：

```
SELECT bar from MYTABLE; 
```

结果集将有一个名为“bar”的列。如果你写：

```
SELECT bar from MYTABLE as foo; 
```

然后，结果集将有一个“foo”列。它允许您为列名起别名。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-11T20:58:07.363

在表名的情况下，它可以更容易阅读和输入（由人类）。

该`AS`关键字还可以用于为列名和特别用途的函数命名。这使得从某些查询中获取合理的临时列名成为可能：

```
SELECT columna + columnb as column_sum 
```

# database - 第二范式是什么？

> ID：10113782
> 
> 赞同：3
> 
> 时间：2012-04-11T20:51:33.440
> 
> 标签：database, database-normalization

我对这些的非正式表示是：

**1NF**：表格被划分，因此没有项目会出现超过一次。

**2NF**：？

**3NF**：值只能由主键确定。

我无法从我在网上或书中找到的摘录中理解它。如何区分 1NF 和 2NF？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-11T20:58:08.220

如果每个非主属性在功能上完全依赖于每个键，则关系模式属于 2NF。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-11T21:14:43.163

[维基百科](http://en.wikipedia.org/wiki/Second_normal_form)说：

> 一个表在 2NF 中当且仅当它在 1NF 中并且表的每个非主属性要么依赖于整个候选键，要么依赖于另一个非主属性。

为了解释这个概念，让我们使用一张表来表示根据[Head First SQL](http://books.google.com.pe/books?id=ZO6MF9Ja1zoC&pg=PA330&dq=second%20normal%20form&hl=en&sa=X&ei=U_CFT560DoT48gTxn-jHCA&ved=0CGwQ6AEwCg#v=onepage&q=second%20normal%20form&f=false)改编的玩具清单：

```
TOY_ID| STORE_ID| INVENTORY| STORE_ADDRESS 
```

主键由属性 TOY_ID 和 STORE_ID 组成。如果我们分析非主属性 INVENTORY，我们会看到它同时依赖于 TOY_ID 和 STORE_ID。这很酷。

但另一方面，非主属性STORE_ADDRESS 只依赖于STORE_ID 属性（即与主键属性TOY_ID 无关）。这明显违反了 2NF，所以要向 2NF 投诉，我们的模式必须是这样的：

库存表：`TOY_ID| STORE_ID| INVENTORY`

和一个存储表：`STORE_ID| STORE_ADDRESS`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-05-04T06:54:02.900

某些列是键的一部分（主要或次要）。我们称这些主要属性。

对于第二范式，我们将考虑非主属性，看看是否应该将它们移动到另一个表中。我们可能会发现某些属性不需要完整的键，我们就能够识别它们对至少一个候选键持有什么值。也就是说，有一个候选键，即使该候选键的一列中的值被删除，我们仍然可以在给定候选键的情况下确定该属性的值。

# vb.net - 在时间增量上更改标签

> ID：10113784
> 
> 赞同：0
> 
> 时间：2012-04-11T20:51:38.770
> 
> 标签：vb.net, label, thread-sleep

我正在尝试为事件制作一个每秒更改一次的标签。我目前拥有的内容使线程从“Rock”一直到“Shoot”并跳过“Paper”和“Scissors”。有没有人知道我应该怎么做才能正确显示标签，以便它们都以相等的时间增量显示？任何帮助将非常感激。

```
lblCountdown.Text = "Rock"
System.Threading.Thread.Sleep(1000)
lblCountdown.Text = "Paper"
System.Threading.Thread.Sleep(1000)
lblCountdown.Text = "Scissors"
System.Threading.Thread.Sleep(1000)
lblCountdown.Text = "Shoot!" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T21:00:34.550

如果您从 UI 线程调用它，渲染将锁定直到代码完成，因此您不会看到 Paper 或 Scissors。一种解决方案（不是*最好*的解决方案，而是*一种*解决方案）是在每个. 这将告诉 UI 重绘自己。`Me.Refresh()``Application.DoEvents()``Sleep`

更好的解决方案是使用某种以 1 秒为间隔计时的计时器，该计时器将在另一个线程中运行，从而为更重要的事情释放 UI 线程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T21:57:48.873

计时器和调用将是处理此问题的好方法：

```
Private WithEvents m_tmrGame As New System.Timers.Timer(1000)
Private m_intShouldBeAnEnum As Integer = 1

Private Sub Form1_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load

    m_tmrGame.Start()

End Sub

Private Sub m_tmrGame_Elapsed(ByVal sender As Object, ByVal e As System.Timers.ElapsedEventArgs) Handles m_tmrGame.Elapsed

    Dim strCurrentObject As String = String.Empty

    Select Case m_intShouldBeAnEnum
        Case 1
            strCurrentObject = "Rock"
            m_intShouldBeAnEnum = 2
        Case 2
            strCurrentObject = "Paper"
            m_intShouldBeAnEnum = 3
        Case 3
            strCurrentObject = "Scissors"
            m_intShouldBeAnEnum = 4
        Case 4
            strCurrentObject = "Shoot!"
            m_intShouldBeAnEnum = 1
            m_tmrGame.Stop()
    End Select

    lblCountdown.Invoke(Sub(lblTarget As Label) lblTarget.Text = strCurrentObject, New Object() {lblCountdown})

End Sub 
```

# vector - SVG 与 Raphael 渲染异常？

> ID：10113785
> 
> 赞同：0
> 
> 时间：2012-04-11T20:51:48.883
> 
> 标签：vector, svg, raphael, vector-graphics

我们有一个使用 Raphael 来操作 SVG 的在线设计师。我们正在为此准备一个大型剪贴画库，但遇到了一个非常奇怪的问题。

一些 SVG 遇到了一个问题，它们在浏览器中渲染得很好，但是一旦我们将它们拉入 Raphael，它们就会变得完全无法识别。

**这是显示效果的图像：** ![在此处输入图像描述](../Images/bc2e1f492b886e9b462e5ab450c0d6e6.png)

**这是 svg 的代码（由 .ai 文件中的插图画家导出生成）：**

```
<?xml version="1.0" encoding="utf-8"?>
<!-- Generator: Adobe Illustrator 14.0.0, SVG Export Plug-In . SVG Version: 6.00 Build 43363)  -->
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.0//EN" "http://www.w3.org/TR/2001/REC-SVG-20010904/DTD/svg10.dtd">
<svg version="1.0" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
     width="100px" height="83.641px" viewBox="0 0 100 83.641" enable-background="new 0 0 100 83.641" xml:space="preserve">
<polygon points="58.263,0.056 100,41.85 58.263,83.641 30.662,83.641 62.438,51.866 0,51.866 0,31.611 62.213,31.611 30.605,0 
    58.263,0.056 "/>
</svg> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T21:07:03.123

似乎您将文件导入路径的过程可能存在缺陷，或者应用了一些无法解释的转换。例如，此代码工作正常：

```
var paper = Raphael("paper");
paper.path(
    "M58.263,0.056 L100,41.85 L58.263,83.641 L30.662,83.641 " +
    "L62.438,51.866 L0,51.866 L0,31.611 L62.213,31.611 30.605,0"
).attr( { 'fill': 'black' } ); 
```

见[http://jsfiddle.net/sgMH6/](http://jsfiddle.net/sgMH6/)

你如何将这些文件“拉”到 Raphael 中？你的流程/代码是什么？

**编辑**：更多信息；导入插件是[https://github.com/wout/raphael-svg-import/blob/master/raphael-svg-import.js](https://github.com/wout/raphael-svg-import/blob/master/raphael-svg-import.js)

您正在使用的插件似乎有一个错误的多边形实现例程。这是一种预感，但是，似乎 0 数字没有被正确处理。您的 SVG 图形确实包含一些零坐标。

在函数**Raphael.fn.polygon**中，有一段是这样的：

```
 var d = parseFloat(c[j]);
     if (d)
       poly.push(d); 
```

如果您将其更改为此，它可能对您有用：

```
 var d = parseFloat(c[j]);
    if (!d) d = 0;
    poly.push(d); 
```

这是一个非常基本的修复，它可能会破坏其他东西。无论如何，看看一个修改过的插件修复的工作示例 - [http://jsfiddle.net/pkzGJ/](http://jsfiddle.net/pkzGJ/)；如果这确实是一个错误，您应该将其提交给插件作者。

# php - 使用 PHP 生成 XML 文件

> ID：10113786
> 
> 赞同：1
> 
> 时间：2012-04-11T20:51:53.117
> 
> 标签：php, mysql, xml

我目前有一个 PHP 脚本，它在运行时输出一个 XML 文件（但是作为 feed.php 而不是 feed.xml）我被告知将其添加到我的 .htaccess 中，它应该修复它：

```
AddType application/x-httpd-php .xml 
```

但是由于某种原因，这不起作用。

理想情况下，我希望脚本执行的操作是在运行时生成一个 feed.xml 文件及其内容的输出，而不仅仅是在 php 页面上输出内容。

这是我的代码：

```
<?PHP
 include("../config.php");
 #// Timetable Clearup Variabls
$yesterday = strtotime('yesterday');
$yesterdow = date('l',$yesterday);
$order = "SELECT * FROM timetable WHERE day = '$yesterdow' ORDER BY time";
$result = mysql_query($order);
$yesterdayd = date('F jS, Y', time()-86400);

    //SET XML HEADER
    header('Content-type: text/xml');

    //CONSTRUCT RSS FEED HEADERS
    $output = '<rss version="2.0">';
    $output .= '<channel>';
    $output .= "<title>Timetable - {$yesterdayd} </title>";
    $output .= '<description>Timetable.</description>';
    $output .= '<link>http://site.com/</link>';
 ###   $output .= '<copyright>Your copyright details</copyright>';
 while ($row = mysql_fetch_array($result)) {
    //BODY OF RSS FEED
   $output .= '<item>';
     $output .= "<description><td>" . htmlspecialchars($row['username']) . "</td><td>" . htmlspecialchars($row['time']) . "</td></description>";
   $output .= '</item> ';
 }
    //CLOSE RSS FEED
   $output .= '</channel>';
   $output .= '</rss>';

    //SEND COMPLETE RSS FEED TO BROWSER
    echo($output);

?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-11T20:56:32.637

我建议不要在 .htaccess 中添加 .xml 以使用 PHP 编译器进行处理。而是使用**mod_rewrite**将请求重定向到 .xml 文件到 php 脚本。

例如：

```
RewriteEngine On
RewriteRule ^(.*)\.xml$ /rss_feed.php [L,QSA] 
```

# asp.net-web-api - ASP.NET Web API IQueryable 挑战

> ID：10113787
> 
> 赞同：4
> 
> 时间：2012-04-11T20:51:58.313
> 
> 标签：asp.net-web-api

我想在我的控制器中使用以下模式：

> api/{controller}/{id}/{collection}

*示例：* api/customers/123/addresses

但我想`IQueryable Of T`从相应的 Get 动作返回。我想要这样的东西（简化）：

```
public IQueryable<????> GetCollection(int id, string collection)  
{  
    switch(collection)  
    {  
        case "addresses":  
            return _addresses.AsQueryable();  
            break;  
        case "orders":  
            return _orders.AsQueryable();  
            break;  
        default:  
            throw new Exception(NotSupported);  
    }  
} 
```

这可以做到吗？
推荐的方法是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-30T22:54:38.350

@SLacks 是正确的，您应该返回 `IQueryable<object>`或者`IQueryable<someBaseType>`如果可以返回。

您得到的错误是 DataContract Serializer 的函数。所以你有几个选择。

1.  切换到支持您想要的替代 xml 序列化程序。
2.  切换到一种绕过相关序列化程序的输出形式（例如使用 JSON.net 的 JSON）
3.  教数据契约序列化器如何使用

对于“教学”选项，您可以通过两种方式进行教学。

**(A)**利用`[KnownType(typeof(...))]`属性。这是关于[属性](https://stackoverflow.com/questions/6153093/unexpected-type-serialization-exception)[的帖子`KnownType`](https://stackoverflow.com/questions/6153093/unexpected-type-serialization-exception)。它适用于 WCF，但应该可以帮助您入门。

**(B)**使用数据合同解析器。这篇[文章应该让你开始](http://blogs.msdn.com/b/carlosfigueira/archive/2011/09/21/wcf-extensibility-data-contract-resolver.aspx)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-20T18:51:47.007

扩展@Ebarr 所说的内容，实现此目的的最简单方法是更新您希望能够以这种方式返回的各种类，并让它们从公共基类或接口继承。

例子：

```
[KnownType(typeof(Address))]
[KnownType(typeof(Order))]
public abstract class _BaseObject { }

public partial class Address : _BaseObject { }
public partial class Order : _BaseObject { } 
```

现在你可以让你的控制器方法看起来像：

```
public IQueryable<_BaseObject> GetCollection(int id, string collection) {  
    switch(collection) {  
        case "addresses":  
            return _addresses.AsQueryable();
        case "orders":  
            return _orders.AsQueryable();
        default:  
            throw new NotSupportedException();  
    }  
} 
```

请注意，该`[KnownType]`属性位于`System.Runtime.Serialization`. 您还应该知道，这种方法将导致您对`JSON`序列化的期望 - 但`XML`序列化通常会产生将您的对象显示为基类的标签（因为这是您返回的）而不是子类。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-11T20:53:34.977

只需返回非通用`IQueryable`.
或`IQueryable<object>`通过协方差。

# javascript - 将 ActiveX 转换为所有浏览器兼容的最简单方法是什么

> ID：10113793
> 
> 赞同：0
> 
> 时间：2012-04-11T20:52:29.423
> 
> 标签：javascript, cross-browser, web, activex

我正在处理一些具有 ActiveX 请求的 js 文件。我的工作是让这些文件在所有浏览器中都能正常工作。有没有一种简单的方法可以让文件在所有浏览器中都能正常工作，因为我开始不知所措了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T21:09:37.237

您使用 ActiveX 控件做什么？显然，ActiveX 控件永远不会在*所有*浏览器中工作，因为它们包含本机 x86 代码，尽管[Firefox](http://code.google.com/p/ff-activex-host/)和[Chrome](https://chrome.google.com/webstore/detail/lgllffgicojgllpmdbemgglaponefajn)的一些（仅限 Windows）扩展似乎增加了对 ActiveX 控件的某种支持。

否则，如果您可以摆脱 ActiveX，那么您最好的选择可能是 Java，但话又说回来，这实际上取决于您需要实现的目标；大多数浏览器在访问本地文件时都有严格的限制，而这正是 ActiveX 控件的典型用途。

# jsf - state_saving_method 设置为客户端时转换器未设置值

> ID：10113798
> 
> 赞同：1
> 
> 时间：2012-04-11T20:53:01.503
> 
> 标签：jsf, jsf-2

我面临一个奇怪的问题，当豆子被视域时。当 state_saving_method 设置为 client 时，转换器未将值设置为指定类型。当它设置为“服务器”时它工作得很好，如果 bean 被请求范围并设置为“客户端”也可以正常工作

网页看起来像这样。

```
<h:selectOneMenu value="#{managedBeanState.selectedFoo}" >
    <f:selectItem itemLabel="" />
    <f:selectItems value="#{managedBean.foos)" var="foo" itemLabel="#{foo.name} " itemValue="#{foo}" />
    <f:converter converterId="fooConverter" />
    <p:ajax update="whom" onstart="menuStart();" oncomplete="menuComplete();" />
</h:selectOneMenu>

  <h:selectOneMenu id="whom" value="#{managedBeanState.person}" 
                   disabled="#{empty managedBeanState.selectedFoo}">
    <f:selectItem itemLabel="" />
    <f:selectItems value="#{managedBean.persons)" var="person" itemLabel="#{person.name} " itemValue="#{person}" />
    <f:converter converterId="personConverter" />
    <p:ajax update="email" onstart="menuStart();" oncomplete="menuComplete();" />
</h:selectOneMenu> 
```

转换器类看起来像这样。

```
@FacesConverter(value = "fooConverter", forClass = com.examples.Foo.class)
public class EntityConverter implements Converter {

@Override
public Object getAsObject(FacesContext context, UIComponent c, String value) {
    if (value.isEmpty()) {
        return null;
    }

    try {
        SessionFactory sessionFactory = (SessionFactory) FacesContextUtils.getRequiredWebApplicationContext(FacesContext.getCurrentInstance()).getBean("sessionFactory");
        String[] idAndClassName = value.split(":|_");
        String className = idAndClassName[1];
        String id = idAndClassName[0];
        return sessionFactory.getCurrentSession().load(Class.forName(className), Long.parseLong(id));
    } catch(Exception e) {
        throw new IllegalStateException("Error loading from value:" + value, e);
    }
}

@Override
public String getAsString(FacesContext context, UIComponent c, Object value) {
    if (value == null || StringUtils.isEmpty(value.toString())) {
        return StringUtils.EMPTY;
    }

    return ((Foo) value).getId().toString() + ":" + value.getClass().getName();
}
} 
```

我的 web.xml 看起来像这样

```
<context-param>
    <description>State saving method: 'client' or 'server' (=default). See JSF Specification 2.5.2</description>
    <param-name>javax.faces.STATE_SAVING_METHOD</param-name>
    <param-value>client</param-value>
</context-param>

<context-param>
    <param-name>javax.faces.PARTIAL_STATE_SAVING</param-name>
    <param-value>false</param-value>
</context-param> 
```

我检查了 BalusC[博客](http://balusc.blogspot.com/2011/09/communication-in-jsf-20.html) ，但将 PARTIAL_STATE_SAVING 设置为 false 并没有帮助。我还在调试模式下运行，看到 getAsObject 确实返回了对象，但之后它再也没有调用 setter。因此，当为第二个下拉菜单调用 getter 时，它检查 this disabled="#{empty managedBeanState.selectedFoo}" 它始终为空。

更新：在 JIRA上创建了一个[问题](http://java.net/jira/browse/JAVASERVERFACES-2384)

# webdriver - 在 MBunit 报告导出中包含图像

> ID：10113800
> 
> 赞同：1
> 
> 时间：2012-04-11T20:53:03.480
> 
> 标签：webdriver, mbunit

我们在生成 HTML 报告以及机器可读报告的 CI 系统中执行 MBunit 测试。我想将图像附加到 HTML 报告中。

通过 Gallio.Icarus 运行时，图像显示在执行日志中。不幸的是，它们不适用于 HTML 报告。MBunit 将图像保存在“C:\Users\username\AppData\Local\Temp\Gallio\”中。

背景和目标：我们通过 CI 系统在所有支持的浏览器中运行 WebDriver 测试。当测试失败时，我们会花费大量时间进行调试。一张图说一千个字，所以我会在报告中附上屏幕截图。运行 Icarus 以查看输出将是一个手动过程，这违背了自动化测试的要点。

代码示例：（RemoteScreenShot 实现是[此 java RemoteScreenShot](http://code.google.com/p/selenium-remotewebdriver-screenshot/source/browse/src/main/java/RemoteScreenshot.java)到 C# 的端口）

```
 [SetUp]
    public void SetUp()
    {
        var capabilties = new DesiredCapabilities(new Dictionary<string, object>() {{"browserName", "internet explorer"}});
        // This is a subclass of RemoteWebDriver that supports screenshots.
        _driver = new RemoteScreenShot(new Uri(HubServer), capabilties);
        _google = new GoogleHome(_driver);
    }

    [Test]
    public void TestScreenShot()
    {
        _driver.Navigate().GoToUrl("http://www.google.co.uk");
        var screenShot = ((ITakesScreenshot)_driver).GetScreenshot();
        screenShot.Should().Not.Be.Null();
        using (var stream = new MemoryStream(screenShot.AsByteArray))
        {
            var image = new Bitmap((stream));
            TestLog.Write("Hello");
            TestLog.AttachImage("Screenshot", image);
        }
    } 
```

# iphone - 调试 iOS 中的文件句柄泄漏

> ID：10113802
> 
> 赞同：1
> 
> 时间：2012-04-11T20:53:09.443
> 
> 标签：iphone, ios, xcode, file, file-io

我正在调查一个看起来我们的项目正在泄漏文件句柄的问题。我们的应用程序工作了大约五分钟，但过了一会儿，低级文件打开功能又失败了。如果我手动泄漏文件句柄，我可以使问题发生得更快。

我们的代码库太复杂了，我无法开始逐行手动调试以查看发生了什么，因此我正在寻找某种调试工具来帮助调查此问题。

有任何想法吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T20:58:19.977

您应该使用仪器来跟踪任何泄漏。您构建的任何应用程序都应该真正通过仪器运行它。

[https://developer.apple.com/library/ios/#documentation/DeveloperTools/Conceptual/InstrumentsUserGuide/Introduction/Introduction.html#//apple_ref/doc/uid/TP40004652](https://developer.apple.com/library/ios/#documentation/DeveloperTools/Conceptual/InstrumentsUserGuide/Introduction/Introduction.html#//apple_ref/doc/uid/TP40004652)

提示：使用泄漏分析您的应用程序，您应该能够追踪任何泄漏。

# java - windowbuilder 文本字段不适用于组合框

> ID：10113803
> 
> 赞同：0
> 
> 时间：2012-04-11T20:53:16.317
> 
> 标签：java, combobox, textfield, windowbuilder

我有一个问题，我有一个组合框，该组合框会导致在 textField 中设置文本的操作。这是代码：

```
public class Main extends JFrame implements ActionListener{
   private JPanel contentPane;
   private JTextField textField;
   private JComboBox comboBox;

   //public static void main - nothing much in it except Main frame = new Main();

   public Main() {
    setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    setBounds(100, 100, 563, 407);
    contentPane = new JPanel();
    contentPane.setBorder(new EmptyBorder(5, 5, 5, 5));
    setContentPane(contentPane);
    contentPane.setLayout(null);
    comboBox.addActionListener(frame);
    textField = new JTextField();
    textField.setBounds(42, 99, 445, 235);
    textField.setText("HERE");
    contentPane.add(textField);
    textField.setColumns(10);
    comboBox = new JComboBox();
    comboBox.setModel(new DefaultComboBoxModel(new String[] {"Bob", "Dan ", "Emily"}));
    comboBox.setBounds(42, 48, 140, 29);
    contentPane.add(comboBox);

    /*ONE WAY OF DOING IT: comboBox.addActionListener(new ActionListener() {
    public void actionPerformed(ActionEvent arg0) {
        textField.setText(studentOutputString((String)comboBox.getSelectedItem()));
        textField.setText("BLAH");
    }
});*/
}
    public String studentOutputString(String student){
        String s = student + "is printed.";
        return s;
}

    public void actionPerformed(ActionEvent e) {
        comboBox = (JComboBox) e.getSource();
        String selectedStudent = (String) comboBox.getSelectedItem();
        textField.setText(studentOutputString(selectedStudent));
} 
```

textField 中没有显示任何内容。知道我做错了什么吗？

我重新格式化它并赶上了我过去的线程。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T21:01:58.317

您需要在 ComboBox 上生成一个动作，以便调用动作侦听器并设置 TextField 的文本。尝试在 ComboBox 中选择一个项目

此外，`comboBox.getSelectedItem()`如果除了所选项目的更改之外还有其他事件（例如，在进行选择之前生成了一个事件），则可能返回 null。在这种情况下，您对`student + "is printed."`inside的调用`studentOutputString()`将引发空指针异常

# python - /accounts/login/ 'User' 对象的 AttributeError 没有属性 'user'

> ID：10113804
> 
> 赞同：3
> 
> 时间：2012-04-11T20:53:16.723
> 
> 标签：python, django, authentication

我是 django 的新手，并试图让用户身份验证正常工作。我已经设置了一个非常基本的登录表单并查看但我收到了错误：

```
AttributeError at /accounts/login/ 'User' object has no attribute 'user' 
```

我很困惑，因为我没有尝试访问 User.user
我知道它必须是第一个 else 语句中的内容，因为经过身份验证的用户只是重定向到“/”，因为它应该
是这样的视图：

```
def login(request):
  if request.user.is_authenticated():
    return HttpResponseRedirect("/")
  else:
    if request.method == 'POST':
      username = request.POST['username']
      password = request.POST['password']
      user = authenticate(username=username, password=password)
      if user is not None:
        if user.is_active:
          login(user)
          return HttpResponseRedirect("/")
      return HttpResponse("There was an error logging you in")
    else:
      return render_to_response("registration/login.html", 
                                 context_instance=RequestContext(request)) 
```

在 views.py 第 15 行中引发了错误：如果 request.user.is_authenticated()：

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-11T21:23:30.507

您的视图函数被调用`login`，它需要一个参数，`request`。

在您视图的第 11 行，您调用`login(user)`. 现在，您可能打算将其作为来自 的登录功能`django.contrib.auth`，并且大概您已经从视图顶部的那里导入了它。但是 Python 一次只能使用一个名称：因此，当您命名 view 时`login`，它会覆盖对该名称的现有引用。

这样做的结果是该行调用*您的*视图，而不是登录功能。（这就是为什么你得到那个特定的错误：你的视图的第一行检查`request.user`，`request`取自通常是请求的第一个参数 - 但在你的情况下，你已经`user`作为第一个参数传递了，当然用户没有' t 本身有一个用户参数。）

The solution is to either rename your view to something else, or do `from django.contrib import auth` and call `auth.login(user)` inside your view.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-11T21:13:18.367

login 必须有 2 个参数，request 和 user。如果未给出请求，则登录无法设置 cookie 等。因此，请执行以下操作：

```
login(request, user) 
```

[https://docs.djangoproject.com/en/dev/topics/auth/#django.contrib.auth.login](https://docs.djangoproject.com/en/dev/topics/auth/#django.contrib.auth.login)

# django - 带有构建和 Fabric 的 Django 远程部署

> ID：10113805
> 
> 赞同：1
> 
> 时间：2012-04-11T20:53:24.727
> 
> 标签：django, deployment, fabric, buildout

我正在 djangorecipe 上使用 Django 编写一个 Web 应用程序。我想进行自动部署，发现 Fabric 将是一个完美的解决方案。

不过，我不确定，您如何在构建环境中使用 Fabric。事实证明，关于使用 Fabric 的扩展配方和帖子有点过时（约 2010 年）。有没有人尝试过实施？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-20T17:42:48.427

考虑它的最佳方法是将它们分开对待。

*   Buildout 用于在本地和服务器上设置所有内容。抓取 django 和所有需要的 python 包。甚至可能从模板生成 apache 配置文件。

*   fabric 用于运行远程命令，例如在服务器上检查带有 buildout 的标签，运行 bootstrap 和 buildout 以及重新启动 apache。

Buildout 管理实际目录。Fabric 运行 buildout 并管理 buildout 目录之外的所有内容。奇迹般有效！

（当然你把你的 fabfile.py 放在你的 buildout 目录中。如果你喜欢的话，你可以将 fabric 本身添加到 zc.recipe.egg:scripts 部分以获得本地 bin/fab。）

# mysql - MySQL触发器在插入后更新计数

> ID：10113808
> 
> 赞同：1
> 
> 时间：2012-04-11T20:53:26.660
> 
> 标签：mysql, triggers

我需要一些有关 mysql 触发器的帮助。我目前正在尝试整理一些代码并将一些处理卸载到 mysql 数据库，而不是运行 2 个查询和连接等...

当有人将视频插入数据库时​​，我希望更新类别中的视频计数。

因此，您指定类别 ID。

这是我到目前为止所拥有的，所以任何帮助都会很好，因为我似乎无法正确获取语法。

```
CREATE TRIGGER 'db_videos'.'update_video_count'
AFTER INSERT ON 'videos' FOR EACH ROW
BEGIN
    UPDATE video_cat WHERE video_count = video_count + 1 WHERE video_cat = video_cat;
END; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-12-17T19:33:22.393

尝试以下操作：

```
CREATE TRIGGER 'db_videos'.'update_video_count'
AFTER INSERT ON 'videos' FOR EACH ROW
BEGIN
    UPDATE video_cat vc 
      SET video_count = video_count + 1 
      WHERE NEW.video_cat = vc.video_cat;
END; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-11T20:58:18.737

您的 where 子句重复且模棱两可。如果我理解您的数据模型正确，请尝试：

```
CREATE TRIGGER 'db_videos'.'update_video_count'
AFTER INSERT ON 'videos' FOR EACH ROW
BEGIN
    UPDATE video_cat vc 
      WHERE video_count = video_count + 1 
      and NEW.video_cat = vc.video_cat;
END; 
```

# jquery - 如何在谷歌地图中为相同地址但不同套房绘制标记

> ID：10113813
> 
> 赞同：0
> 
> 时间：2012-04-11T20:53:39.593
> 
> 标签：jquery, google-maps, marker

我知道这没有多大意义，但我有一张地图，绘制了所有地址，但有些地方共享地址，比如 13 号套房有一个医生办公室，33 号套房有一个医学实验室。医生办公室有红色标记，医学实验室有蓝色标记。他们都有完全相同的街道地址。如何在谷歌地图中捕获两者？现在，最新的一个被绘制在地图上。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T20:59:18.343

由于显而易见的原因，Google 地图无法在 2D 屏幕上的完全相同位置显示两个标记：) 您可能希望在构建地图之前将这些标记合并为一个标记。例如，如果您从数据库中提取这些地址，您可以合并共享街道地址的条目，然后生成地图。IIRC您还可以使用自定义标记图像，因此您可以使用50％红色，50％蓝色的图像？

# ruby-on-rails - CanCan 能力通过数据库和 load_resource

> ID：10113827
> 
> 赞同：1
> 
> 时间：2012-04-11T20:54:21.887
> 
> 标签：ruby-on-rails, cancan

我的权限在[CanCan wiki](https://github.com/ryanb/cancan/wiki/Abilities-in-Database)上描述的数据库中定义。我想`:index`只为我的权限表中的 id 授权，但如果没有资源被授权，仍然显示索引页面。

如果我使用`load_and_authorize_resource`，它会根据权限加载资源。如果我没有，`index`则无法访问该操作。我在资源上被拒绝访问。

如果我仍然想允许在`:index`没有授权资源的情况下访问操作，我会看到两个选项：

**选项 1（讨厌它）** ：手动加载索引的资源。

```
class FirmsController < ApplicationController
  load_and_authorize_resource :except => :index

  def index
    @firms = user.permissions.where{action: ["index", "manage", "read"], subject_class: "Firm"}
  end
end 
```

**选项 2（meh）**：为 :index 添加一个具有 id: [] （无）约束的功能，然后用我的数据库权限覆盖它。

```
class Ability
  include CanCan::Ability

  def initialize(user)

    user ||= User.new # guest user (not logged in)

    can :create, Firm
    can :index, Firm, id: []

    user.permissions.each do |permission|
      if permission.subject_id.nil?
        can permission.action.to_sym, permission.subject_class.constantize
      else
        can permission.action.to_sym, permission.subject_class.constantize, :id => permission.subject_id
      end
    end

  end
end 
```

**选项 3？**

你能想出一个更清洁的解决方案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T21:00:39.527

如[文档](https://github.com/ryanb/cancan/wiki/Authorizing-Controller-Actions)中所述，您应该使用辅助方法：

```
 skip_authorize_resource :only => :index 
```

# android - android 创建 google plus like 个人资料图片

> ID：10113828
> 
> 赞同：0
> 
> 时间：2012-04-11T20:54:26.003
> 
> 标签：android, bitmap, google-plus

你好，我想创建一个圆形图像，它有一个小边框，里面加载用户的个人资料图片，就像 google plus android 应用程序一样。问题是我需要将该图像设置为按钮的可绘制顶部，因此我找到了以下代码：

```
public BitmapDrawable putOverlay(Bitmap bitmap, Bitmap overlay) {
    Canvas canvas = new Canvas(bitmap);
    Paint paint = new Paint(Paint.FILTER_BITMAP_FLAG);
    canvas.drawBitmap(overlay, 0, 0, paint);
    return new BitmapDrawable(bitmap);
} 
```

女巫应该将一个位图（用户图片）覆盖在另一个位图（椭圆形）上，但认为a）圆形位图在用户的个人资料图片上，b）用户的个人资料图片太大。任何关于如何做到这一点或我是否至少在正确的方式上的建议都非常感谢。

更新

我已经设法使用此代码显示这两个图像：

```
public BitmapDrawable putOverlay(Bitmap bitmap, Bitmap overlay) {
    int width = overlay.getWidth()-50;
    int height = overlay.getHeight()-50;

    Bitmap b = Bitmap.createScaledBitmap(bitmap, width, height,true);
    Canvas canvas = new Canvas(overlay);
    canvas.save();
    canvas.translate(width,height);
    Matrix matrix = new Matrix();
    canvas.drawBitmap(overlay, matrix, null); 
    canvas.restore();
    canvas.drawBitmap(b,matrix, null);
    BitmapDrawable completeImage = new BitmapDrawable(getResources(),overlay);
    return completeImage;
} 
```

问题是个人资料图片未与圆形图像对齐。就像个人资料图片是从绘制圆形图像的相同 x、y 位置绘制的一样。另请注意，个人资料图片是使用以下方式加载的：

```
bitmap = BitmapFactory.decodeStream((InputStream) new URL(imagepath).getContent()); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T21:03:36.570

使用此代码（首先缩放配置文件图片然后应用覆盖）

```
public BitmapDrawable putOverlay(Bitmap bitmap, Bitmap overlay) {
    Bitmap b = Bitmap.createScaledBitmap(bitmap, overlay.getWidth(), overlay.getHeight(),true);
    Canvas canvas = new Canvas(b);
    Paint paint = new Paint(Paint.FILTER_BITMAP_FLAG);
    canvas.drawBitmap(overlay, 0, 0, paint);
    return new BitmapDrawable(b);
} 
```

我不太明白你在问题中的意思是覆盖在个人资料图片的顶部

# java - 如何在 netbeans 中使用 Play Framework 2.0

> ID：10113832
> 
> 赞同：11
> 
> 时间：2012-04-11T20:54:34.857
> 
> 标签：java, netbeans, playframework-2.0

Play Framework 2.0 似乎对 Netbeans 没有太多/任何支持。我目前只是将它用作编辑器（使用收藏夹选项卡加载文件），但 Netbeans 无法识别任何库/api 有点令人沮丧。

这意味着所有内容都带有红色下划线。

尝试创建一个自由形式的项目需要一个构建文件，所以我也被困在那里。

任何想法表示赞赏...

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-10-24T16:36:47.260

1.  按照正常方式创建一个播放项目。
2.  从 play CLI 中选择`play eclipsify`创建一个 eclipse 项目。
3.  从 netbeans 中，选择`File > Import Project > Eclipse Project`
4.  选择`Import Projects Ignoring Dependencies`
5.  在`Project to Import`中，插入您的播放应用程序的根目录。
6.  在`Destination Folder`中，**还**插入您的播放应用程序的根目录。
7.  按`Finish`。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-10-20T20:33:50.433

使用 eclipse 支持生成一个 eclipse 项目，然后将其导入 NetBeans

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2015-10-28T17:33:35.267

NetBeans 现在具有对 Play Framework 2.3.x 及更高版本的本机支持：http://nbpleasureplugin.com/documentation/installation.html[根本](http://nbpleasureplugin.com/documentation/installation.html)不需要命令行。

最重要的特点是：

*   直接在 IDE 中创建、运行、调试和测试您的应用程序
*   路由文件支持（语法着色、语法错误突出显示、自动完成、代码导航、显示实现代码（不导航到源代码）、当方法不存在时提示创建方法、格式化、标记出现）
*   Scala 模板支持（语法着色、语法错误突出显示、自动完成、代码导航、显示实现代码（不导航到源代码）、格式化、标记出现）
*   依赖管理
*   测试单个文件
*   SBT 文件最小支持
*   配置（格式化缩进、语法着色、要使用的端口、激活器参数等）
*   支持2.3.x及以上的播放版本

注意：我创建了这个插件。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-01-24T14:05:05.217

只是想继续这些其他回应。因为这是我在解决这个问题时的第一个谷歌结果。Play 的当前版本使用“eclipse”命令而不是“eclipsify”命令。此外，它应该从 Play 环境中运行。

导航到您的项目目录：

进入播放环境：`[projectdir] [username]$ play`

使项目黯然失色：`[projectname] $ eclipse`

然后按照投票最多的答案方向导入netbeans。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-07-28T17:27:35.103

以下适用于 Play 2.4 和 NetBeans 8.0.2。在这里发帖是因为无论 Play 版本如何，这个问题都会出现在搜索结果中，并且[官方文档](https://www.playframework.com/documentation/2.4.x/IDE#Netbeans)太简短并且没有提供具体步骤。

先决条件：激活器（用 1.3.5 测试），安装了所有与 scala 相关的可用插件的 NetBeans（在我的情况下，这包括 Play docs 中提到的 nbscala，但不包括 nbsbt）。

1.  > 将 nbsbt 添加到插件定义文件中。您可以使用 ~/.sbt/0.13/plugins/plugins.sbt 中的全局选项或 PROJECT_DIR/project/plugins.sbt 中的项目特定选项：
    > 
    > `// for sbt 0.13.x addSbtPlugin("org.netbeans.nbsbt" % "nbsbt-plugin" % "1.1.4") // for sbt 0.12.x addSbtPlugin("org.netbeans.nbsbt" % "nbsbt-plugin" % "1.0.2")`

    [来自[nbsbt](https://github.com/dcaoyuan/nbsbt) README] 或者，如果您希望将特定于 IDE 的配置与项目的其余部分分开，您可以在`netbeans.sbt`旁边创建一个单独的文件`plugins.sbt`并添加到该文件中。`.gitignore`

2.  在命令行上转到项目根目录并运行激活器，指定您要创建一个 netbeans 配置：

    `$ cd PROJECT_DIR`

    `$ activator netbeans`

    运行 activator 将首先解析所有依赖项（包括 nbsbt），然后创建 NetBeans 文件。`.classpath_nb`作为这个命令的结果，我应该在根目录中看到文件。

3.  最后，只需转到 NetBeans 并简单地执行 File > Open Project...

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-12T10:10:41.830

目前没有对 Netbeans*的本*机支持。

检查Netbeans 部分的[Play 2.0 IDE 文档](http://www.playframework.org/documentation/2.0/IDE)。

[Google Groups 主题](https://groups.google.com/forum/?fromgroups#!topic/play-framework/kdwjTOFpHwE)中也有一些解决方法的建议

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-01-04T11:29:09.253

看看[play2-maven-plugin](http://www.google.com/search?q=play2-maven-plugin)，它为 Play/SBT/Ivy 世界提供了一个很好的 mavenized 接口。然后，一个小的 pom.xml 可以让您利用 NetBeans 的所有 Maven 优点来摆脱那些红色下划线......

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-05-09T08:42:02.997

只需使用命令：`play netbeansify myApp`

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-12-17T11:38:30.157

几天前我也遇到了同样的麻烦。我发现 NetBeans 在其插件库中有一个名为 Pleasure Plugin [ [http://plugins.netbeans.org/plugin/61050](http://plugins.netbeans.org/plugin/61050) ] 的插件，专为 NetBeans 8 设计。

这个插件很棒，因为它会打开 Play 项目并显示所有应按原样划分的包和文件夹。它允许您执行项目，轻松调试后端（只需放置一个断点并在调试模式下运行项目）以及其他功能。

唯一的问题是这个插件有商业许可证，你可以免费试用 30 天。

# iphone - 如何处理 sendAsynchronousRequest:queue:completionHandler：当用户更改屏幕时不再相关的请求

> ID：10113834
> 
> 赞同：1
> 
> 时间：2012-04-11T20:54:46.847
> 
> 标签：iphone, objective-c, ipad, ios5

我有一系列按给定顺序推送到 UINavigationController 的 ViewController。最后一个 ViewController 只是一个控制器，它基本上是自动向用户建议位置。用户会看到一个文本字段，他们可以开始输入位置，并且在表格视图下方将填充建议。这不是什么新鲜事或开创性的。

问题出在该视图控制器中，我正在调用 sendAsynchronousRequest:queue:completionHandler: api 方法来获取与用户输入字符串匹配的位置列表。我担心的是，如果给定的请求需要一段时间才能完成，并且用户通过弹出当前屏幕返回堆栈，而请求仍未返回，我应该如何处理这种情况？

1.  如果当前有任何活动，我认为无法取消请求
2.  我注意到即使我弹出屏幕，我的 completionHandler 块仍然运行并且应用程序不会崩溃并且对 tableview 的引用不是零。那么我可以简单地“不用担心”吗？我只是觉得这不是处理它的正确方法。

非常感谢任何指导。

提前致谢，

-拉尔夫

# c# - Muti-Combobox 错误 C# - 我得到了所有三个相同的值

> ID：10113836
> 
> 赞同：0
> 
> 时间：2012-04-11T20:54:51.167
> 
> 标签：c#, c#-4.0, combobox

我有三个组合框，使用我在项目中创建的相同数据库。

当我在一个组合框中选择一个选项时，它会用相同的东西填充其他三个。我可以得到它，这样我就可以为每个组合框选择不同的选择。

```
// fieldBox1
            // 
            this.fieldBox1.DataBindings.Add(new System.Windows.Forms.Binding("SelectedValue", this.fieldsTableBindingSource1, "FieldName", true));
            this.fieldBox1.DataSource = this.fieldsTableBindingSource1;
            this.fieldBox1.DisplayMember = "FieldName";
            this.fieldBox1.FormattingEnabled = true;
            this.fieldBox1.Location = new System.Drawing.Point(498, 89);
            this.fieldBox1.Name = "fieldBox1";
            this.fieldBox1.Size = new System.Drawing.Size(121, 21);
            this.fieldBox1.TabIndex = 5;
            this.fieldBox1.ValueMember = "FieldName";
            this.fieldBox1.SelectedIndexChanged += new System.EventHandler(this.fieldBox1_SelectedIndexChanged);
            // 
            // fieldsDBDataSet1
            // 
            this.fieldsDBDataSet1.DataSetName = "FieldsDBDataSet1";
            this.fieldsDBDataSet1.SchemaSerializationMode = System.Data.SchemaSerializationMode.IncludeSchema;
            // 
            // fieldsTableBindingSource1
            // 
            this.fieldsTableBindingSource1.DataMember = "FieldsTable";
            this.fieldsTableBindingSource1.DataSource = this.fieldsDBDataSet1;
            // 
            // fieldsTableBindingSource
            // 
            this.fieldsTableBindingSource.AllowNew = false;
            this.fieldsTableBindingSource.DataMember = "FieldsTable";
            this.fieldsTableBindingSource.DataSource = this.fieldsDBDataSet1;
            // 
            // fieldBox2
            // 
            this.fieldBox2.DataBindings.Add(new System.Windows.Forms.Binding("SelectedValue", this.fieldsTableBindingSource, "FieldName", true));
            this.fieldBox2.DataSource = this.fieldsTableBindingSource;
            this.fieldBox2.DisplayMember = "FieldName";
            this.fieldBox2.FormattingEnabled = true;
            this.fieldBox2.Location = new System.Drawing.Point(498, 116);
            this.fieldBox2.Name = "fieldBox2";
            this.fieldBox2.Size = new System.Drawing.Size(121, 21);
            this.fieldBox2.TabIndex = 6;
            this.fieldBox2.ValueMember = "FieldName";
            // 
            // fieldsTableBindingSource2
            // 
            this.fieldsTableBindingSource2.DataMember = "FieldsTable";
            this.fieldsTableBindingSource2.DataSource = this.fieldsDBDataSet1;
            // 
            // fieldBox3
            // 
            this.fieldBox3.DataBindings.Add(new System.Windows.Forms.Binding("SelectedValue", this.fieldsDBDataSet1, "FieldsTable.FieldName", true));
            this.fieldBox3.DataSource = this.fieldsTableBindingSource3;
            this.fieldBox3.DisplayMember = "FieldName";
            this.fieldBox3.FormattingEnabled = true;
            this.fieldBox3.Location = new System.Drawing.Point(498, 140);
            this.fieldBox3.Name = "fieldBox3";
            this.fieldBox3.Size = new System.Drawing.Size(121, 21);
            this.fieldBox3.TabIndex = 7;
            this.fieldBox3.ValueMember = "FieldName";
            // 
            // fieldsTableBindingSource3
            // 
            this.fieldsTableBindingSource3.DataMember = "FieldsTable";
            this.fieldsTableBindingSource3.DataSource = this.fieldsDBDataSet1; 
```

任何帮助都将是重大帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T19:06:20.157

我没有您周围的代码，无法对此进行测试，但我认为这更符合您的要求。您需要定义三个单独的字段来保存 ComboBox 值。我将它们称为 ComboValue1、2 和 3。这三个的下拉源是相同的。

```
// Set up binding sources

// fieldsDBDataSet1
this.fieldsDBDataSet1.DataSetName = "FieldsDBDataSet1";
this.fieldsDBDataSet1.SchemaSerializationMode = System.Data.SchemaSerializationMode.IncludeSchema;

// fieldsTableBindingSource - this is my data source for the ComboBox
this.fieldsTableBindingSource.AllowNew = false;
this.fieldsTableBindingSource.DataMember = "FieldsTable";
this.fieldsTableBindingSource.DataSource = this.fieldsDBDataSet1;

// Set up the ComboBoxes.  Here we make new bindings for the value:
// public Binding(string propertyName, Object dataSource, string dataMember, boolean formattingEnabled);
//   This constructs a binding that SETS propertyName to a value.
//   The value comes from dataMember, a property or member of the object dataSource.
// We also set the matching dataMember as our ValueMember, which must be different for all three boxes.
// To set the dropdown source we use the DisplayMember, which should be the same for all three boxes.

// fieldBox1
this.fieldBox1.DataBindings.Add(new System.Windows.Forms.Binding("SelectedValue", this.fieldsTableBindingSource, "ComboValue1", true));
this.fieldBox1.ValueMember = "ComboValue1";
this.fieldBox1.DataSource = this.fieldsTableBindingSource;
this.fieldBox1.DisplayMember = "FieldName";
this.fieldBox1.FormattingEnabled = true;
this.fieldBox1.Location = new System.Drawing.Point(498, 89);
this.fieldBox1.Name = "fieldBox1";
this.fieldBox1.Size = new System.Drawing.Size(121, 21);
this.fieldBox1.TabIndex = 5;
this.fieldBox1.SelectedIndexChanged += new System.EventHandler(this.fieldBox1_SelectedIndexChanged);

// fieldBox2
this.fieldBox2.DataBindings.Add(new System.Windows.Forms.Binding("SelectedValue", this.fieldsTableBindingSource, "ComboValue2", true));
this.fieldBox2.ValueMember = "ComboValue2";
this.fieldBox2.DataSource = this.fieldsTableBindingSource;
this.fieldBox2.DisplayMember = "FieldName";
this.fieldBox2.FormattingEnabled = true;
this.fieldBox2.Location = new System.Drawing.Point(498, 116);
this.fieldBox2.Name = "fieldBox2";
this.fieldBox2.Size = new System.Drawing.Size(121, 21);
this.fieldBox2.TabIndex = 6;

// fieldBox3
this.fieldBox3.DataBindings.Add(new System.Windows.Forms.Binding("SelectedValue", this.fieldsTableBindingSource, "ComboValue3", true));
this.fieldBox3.ValueMember = "ComboValue3";
this.fieldBox3.DataSource = this.fieldsTableBindingSource;
this.fieldBox3.DisplayMember = "FieldName";
this.fieldBox3.FormattingEnabled = true;
this.fieldBox3.Location = new System.Drawing.Point(498, 140);
this.fieldBox3.Name = "fieldBox3";
this.fieldBox3.Size = new System.Drawing.Size(121, 21);
this.fieldBox3.TabIndex = 7; 
```

# matlab - 将数字附加到数字 - Matlab

> ID：10113837
> 
> 赞同：1
> 
> 时间：2012-04-11T20:54:51.507
> 
> 标签：matlab, numbers, append, digits

我有一列只有`whole numbers`它，我需要`11`在前面附加一个数字（比如） -

```
data = (1:1300000)';
% append 11 to these numbers

newdata = [111 ;  112 ; 113 ; 114 ; ......] 
```

有没有办法在不使用`str2num`（由于速度问题）的情况下做到这一点？谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-11T21:05:28.887

如果你取以 10 为底的对数`data`，你可以找出你需要乘以多少 11，这样你就可以把它变成一个简单的加法。

```
%# create some test data
data = [1 22 123];

%# add 11*10^x to data so that the two ones end up in front of the number
newData = 11*10.^(floor(log10(data))+1)+data

newData =
         111        1122       11123 
```

# svn - SVN开发实践——如何从分支，到合并分支到主干

> ID：10113841
> 
> 赞同：0
> 
> 时间：2012-04-11T20:55:25.240
> 
> 标签：svn, branch

我在一个使用 SVN 的开发团队工作。我们始终保持稳定且可释放的后备箱。所有开发都在分支上完成，然后在准备发布时合并到主干。如果在合并到主干之前需要查看/测试某些内容，我们可以将该分支（可能称为功能分支）部署到开发环境，其他开发人员和/或项目经理可以看到它。这在大多数情况下都很有效。它不适用于当我们有多个不同的分支，它们属于同一个发布周期但不一定相互关联，它们都需要在同一时期合并到主干之前都需要批准. 我们考虑做的是将它们全部合并到一个组合的发布分支中。那么问题是，如果只有一部分合并的分支被批准发布，我们需要在没有这些分支的情况下重做合并，然后再进入主干。我们基本上必须进行两次合并——一次到 dev 或 feature 分支，然后可能第二次将已批准和可发布的分支合并到主干。

有没有更好的方法来做到这一点？我觉得如果我们从单个分支合并到一个特性分支，然后再将这些单独的分支合并到主干，我们可能会遇到问题。我的想法是对的还是这不是问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T08:41:32.243

按照 Aphillippe 的建议，您可以更进一步，从主干创建发布分支，然后为每个单独的[补丁发布](https://stackoverflow.com/questions/3352147/build-version-vs-revision-number/3352369#3352369)进行标记。

这种方法允许在与主干隔离的发布分支上修复任何实时缺陷（这些修复应该合并回主干）。这种隔离使客户能够获得缺陷修复，而无需升级到您的软件的最新版本——这可以使他们免于与“完整”升级相关的潜在大量测试时间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-12T08:26:39.643

这不是[标签](http://svnbook.red-bean.com/en/1.1/ch04s06.html "标签")的用途吗？

在处理单个功能时分支。将它们全部合并回主干进行测试。测试完成后，错误已修复并准备好发布，标记主干。然后每个版本都有一个标签。

我真的不明白主干中只有可发布代码的需要。当然，在主干中永远不会有不可发布的代码几乎是不可能的（如果你原谅双重否定的话）。

# c# - linq到对象

> ID：10113845
> 
> 赞同：0
> 
> 时间：2012-04-11T20:55:40.863
> 
> 标签：c#, linq

有没有办法在查询中将 linq 查询运行到预定义或自定义类中，而无需在外部执行额外操作？

```
class Numbers {
  int number
  bool even
}

...populate numbers class

List<Numbers> bigNumbers = (
    from n in numbers
    where n.number >= 1000000
    select n) 
```

以下引发转换错误。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-11T20:57:37.017

您缺少一个`ToList()`：

```
List<Numbers> bigNumbers = (
    from n in numbers
    where n.number >= 1000000
    select n).ToList(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-11T21:00:25.743

像这样的东西？

```
List<Numbers> bigNumbers = numbers.Where(w => w.number >= 1000000).ToList(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-11T21:00:17.693

`ToList`如果你真的想要它在一个列表中，你需要打电话。

```
List<Numbers> bigNumbers = (
    from n in numbers
    where n.number >= 1000000
    select n)
    .ToList(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-11T21:00:26.057

你很亲密。您已经创建了一个 Linq 查询，但您正试图将查询分配给一个`List<Numbers>`变量。您需要`.ToList()`在最后添加。

```
List<Numbers> bigNumbers = (
     from n in numbers
     where n.number >= 1000000
     select n).ToList(); 
```

# algorithm - 背包算法的变体

> ID：10113849
> 
> 赞同：0
> 
> 时间：2012-04-11T20:56:11.053
> 
> 标签：algorithm, optimization, combinatorics, knapsack-problem

我认为这可能是多重背包问题的一种变体（或者甚至可以简化为它），但我不确定。这是问题所在：

您有一组具有已知值和权重的项目。你还有一套背包，每个背包可以装固定数量的物品（不同的背包可能能装不同数量的物品）。在保持在给定重量下的情况下，最大化背包中物品的总价值。

请注意，单个背包没有重量限制。每个背包只有一个“它可以包含的物品数量”的限制。唯一的其他限制是物品的总重量。

有任何想法吗？？（当然除了蛮力）。提前致谢！:)

编辑：我忘记包括的一个重要限制：

物品不一定要放在任何袋子里。本质上，如果将它们放入不兼容的袋子中，它们的价值就会变为零。您可以想象一个一般情况，其中每个项目的值取决于其包，但在我的情况下，它的值将是 0 或正常值，具体取决于包。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-27T06:39:53.310

这称为运输问题或某些变体为装箱问题。G. Srinivasan 在 youtube 上有一组很好的关于 OR 问题的视频讲座。查看 LEC 13、14 和 15 [http://www.youtube.com/watch?v=Q31jKiEXxdc](http://www.youtube.com/watch?v=Q31jKiEXxdc) - Lec 13

# c# - 使用 Gameboy 打印机启动串行连接 .Net Gadgeteer

> ID：10113855
> 
> 赞同：1
> 
> 时间：2012-04-11T20:56:31.750
> 
> 标签：c#, .net, serial-port, spi, .net-gadgeteer

我一直在从事一个项目，以使用 Microsoft 的 .NET gadgeteer 模块破解和与 Gameboy 打印机通信。到目前为止，我一直在处理硬件（请参阅此线程：[http ://www.tinyclr.com/forum/21/6665/](http://www.tinyclr.com/forum/21/6665/) ://www.tinyclr.com/forum/21/6665/ ）

我已根据需要将打印机连接为 SPI 串行连接，现在我需要开始与打印机交换字节包以开始探索打印。

我试图将一些代码放在一起，但我失败了。我真的不知道如何与打印机交谈。我取得的唯一进展是 SPI 配置，但实际通信超出了我的理解。也许有人无法指出我正确的方向？

这是我试图复制的代码：http: [//milesburton.com/images/e/ec/GBPrinter_Arduino_Alpha_0.01.pde](http://milesburton.com/images/e/ec/GBPrinter_Arduino_Alpha_0.01.pde)

我的主要参考资料是 Thermaldotnet（sparkfun 打印机的库）*github.com/yukimizake/ThermalDotNet*

蜘蛛上的 SPI：*tinyclr.com/forum/21/6621/*

和一个基本的 SPI 示例：*wiki.tinyclr.com/index.php?title=SPI_-_MP3_Decoder*

如何查看字节传输以判断是否有任何实际工作？

到目前为止我所拥有的：

```
using System;
using System.Collections;
using System.Threading;
using Microsoft.SPOT;
using Microsoft.SPOT.Presentation;
using Microsoft.SPOT.Presentation.Controls;
using Microsoft.SPOT.Presentation.Media;
using Microsoft.SPOT.Touch;
using Microsoft.SPOT.Hardware;

using Gadgeteer.Networking;
using GT = Gadgeteer;
using GTM = Gadgeteer.Modules;
using Gadgeteer.Modules.GHIElectronics;

namespace printTherm
{
public partial class Program
{
    static SPI MySPI = null;
    public static void Sub()
    {

        InputPort Therm;
        Therm = new InputPort(Cpu.Pin.GPIO_Pin8, false, Port.ResistorMode.PullUp);

        SPI.Configuration MyConfig =
             new SPI.Configuration(Cpu.Pin.GPIO_Pin8,
             false, 0, 0, true, true, 1000, SPI.SPI_module.SPI1);
        MySPI = new SPI(MyConfig);

        bool exit = false;
        do
        {
            byte[] tx_data = new byte[1];
            byte[] rx_data = new byte[0];
            while (Therm.Read() == true) ;

            tx_data[0] = 0x01;
            tx_data[1] = 0x00;

            MySPI.WriteRead(tx_data, rx_data);

            while (Therm.Read() == false) ;
            byte[] tx_data2 = new byte[28];
            byte[] rx_data2 = new byte[28];
            for (int i = 0; i < 28; i++)
            {
                tx_data2[i] = 0xFF;
                rx_data2[i] = 0x00;
            }
            MySPI.WriteRead(tx_data2, rx_data2);
        } while (exit == false);

        Thread.Sleep(100);
    }

    // This method is run when the mainboard is powered up or reset.   
    void ProgramStarted()
    {

        Debug.Print("Program Started");
    }
}
} 
```

它与上面的代码几乎完全相同，除了我将 Pin 更改为 8 (MISO) 并添加了一些数组内容。在这一点上，我真的要瞎了。以如此贫乏的知识进入这个领域，我感到很抱歉，但任何一点帮助都将不胜感激。

为对此感兴趣的人提供更多资源：完整的音乐屏蔽代码：*code.tinyclr.com/project/330/fez-music-shield/*

文档：*msdn.microsoft.com/en-us/library/ee436313.aspx* 更多文档：*netmf.com/Gadgeteer/docs/GadgeteerCore/2.41.500/html/0d40434b-2a84-2f72-ca4d-b0012535ea58.htm*

对非超链接感到抱歉+在此先感谢！

# elasticsearch - 不同索引的不同提升值

> ID：10113864
> 
> 赞同：1
> 
> 时间：2012-04-11T20:57:05.340
> 
> 标签：elasticsearch

使用 ElasticSearch，我跨多个索引运行查询。但我希望来自不同索引的结果具有不同的权重（我认为 ES 用语中的不同“提升因子”）。

目标是在每个索引**和**每个查询的基础上调整查询结果的排名。我想要对所选索引的结果进行软偏好，而不是对索引进行硬是/否过滤器。

例子：

```
Query results, 3 hits:

1\. doc A, from index Z, score 0.7
2\. doc B, from index Y, score 0.6
3\. doc C, from index Y, score 0.65 
```

我想提升索引 Y（文档 B 和 C）的所有结果，以便他们获得更高的分数。不同的查询需要不同的索引权重。如何在查询 DSL 语法中做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-12T13:22:28.063

没关系，发现 ES 支持开箱即用：

[http://www.elasticsearch.org/guide/reference/api/search/index-boost.html](http://www.elasticsearch.org/guide/reference/api/search/index-boost.html)

# c++ - 是否可以创建一个模仿基本类型的构造函数语义的 C++ 类型？

> ID：10113872
> 
> 赞同：1
> 
> 时间：2012-04-11T20:57:34.837
> 
> 标签：c++, default-constructor

int/double/etc 的构造函数语义。是：

```
int a; // uninitialized
int b = int(); // zero initialized
int c = int(4); // four 
```

是否可以定义具有完全相同行为的类？即，一个同时具有未初始化和已初始化的默认构造函数的构造函数？我相信这是不可能的，目前通过制作一个仅在使用 0 调用时编译的构造函数来解决它，但要确保没有办法完全模仿基本类型。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T21:01:33.800

这是不可能的，因为与内置类型相反，您的类构造函数将**始终**被调用。

如果您真的想做“未初始化”对象（为什么？？？？由于未初始化的变量，您没有足够的错误吗？），您可能不得不使用放置技巧`new`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-11T21:05:39.417

如果没有定义构造函数：

```
struct A { int x; };

A a; // default-initialized (unintialized)
A b = A(); // value-initialized
A c = { 4 }; // four 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-11T21:14:13.500

“未初始化的构造”是矛盾的。

构造中缺少初始化仅是由于错误（未能递归构造整个对象）而发生的。

如果 C++ 类有构造函数，则调用它。如果由于某种原因不能调用它，那么这种情况是错误的（例如传递的错误构造参数与任何构造函数都不匹配）。

C++ 类可以包含基本类型的成员，其构造函数可以忽略初始化这些成员。

这可以用于优化：如果您有一个稍后发生的复杂初始化，您可以避免写入这些成员的开销。

那将是这样做的方法，而不是尝试创建一个可以保持未初始化的整个类。

如果你真的想要，模拟它的一种方法是创建一个没有任何构造函数的 POD（普通旧数据结构），然后使用一些额外的技术，以便可以以保证其初始化的方式使用它。例如从它创建一个派生类来增加构造，或者利用奇怪重复的模板模式等。

然后，如果您不想初始化 POD，您仍然可以直接使用它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-11T21:25:35.490

将始终调用默认承包商。你可以做很多“技巧”，但这取决于你为什么想要这种行为，以及你希望用户代码看起来像什么。您可以定义一个特殊的构造函数，它不对数据成员做任何事情并调用它。或者，你可以做很多不同的事情......一个选择是......

你也可以玩模板...

```
struct uninitialized_ctor {};

class Foo
{
public:
  int x;
  Foo() : x(42)
  {
    std::cout << "Foo::Foo\n";
  }
protected:
  Foo(uninitialized_ctor const &)
  {
    std::cout << "Foo::Foo - uninitialized\n";
  }
};

struct UninitializedFoo : public Foo
{
  UninitializedFoo()
    : Foo(uninitialized_ctor())
  {
    // Does not call base class ctor...
    std::cout << "UninitializedFoo\n";
  }
};

int main(int, char *[])
{
  Foo foo1;
  UninitializedFoo foo2;
  Foo * f1 = new Foo();
  Foo * f2 = new UninitializedFoo();

  std::cout << foo1.x << '\n' << foo2.x << '\n' << f1->x << '\n' << f2->x << '\n';
} 
```

但是——这取决于你的真正目标是什么......以及它如何影响代码的用户......

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-11T21:00:42.327

这是不可能的，无论如何都会调用默认构造函数。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-11T21:27:24.873

聚合类类型基本上具有您喜欢的行为：

```
struct Foo { int a; int b; };

Foo x;   // x.a, x.b uninitialized

Foo * p = new Foo(); // p->x, p->y value-initialized, i.e. zero

Foo y { 1, 2 }; // brace-initialization does what you think

Foo z { };      // brace-initialization can also "fake" value-init for automatics 
```

对于聚合，默认初始化和值初始化递归地传播给成员。

当然，您也可以制作一个非聚合，使成员未初始化：

```
struct Bar
{
    int a;
    int b;
    Bar() : a() { }  // no b!
    Bar(int a_, int b_) : a(a_), b(b_) { }
};

Bar x;   // x.a is value-, x.b is default-initialized 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-04-11T21:32:08.113

也许你可以做这样的事情：

```
template<typename T>
struct uninitialized {
    static_assert(std::is_trivially_destructible<T>::value,"T must have trivial dtor");

    alignas(T) char raw[sizeof(T)];

    template<typename... Us>
    T &initialize(Us &&... us) {
        return *(new (raw) T(std::forward<Us>(us)...));
    }

    T &get() { return reinterpret_cast<T&>(raw); }
}; 
```

微不足道的析构函数是必需的，因为否则您必须跟踪对象是否已构造，以便适当地销毁它。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2012-04-11T21:06:47.147

```
class A { 
public:
    A() {}

};
A* a = (A*)malloc(sizeof(A)); 
```

（孩子们，不要在家里这样做。根本不要这样做！）

# c# - 如何优雅地处理 fxCop 警告“Catch specific Exception than type System.Exception”？

> ID：10113878
> 
> 赞同：1
> 
> 时间：2012-04-11T20:57:49.067
> 
> 标签：c#, exception, try-catch

我发送 httpRequest 并在 try 块中获取 httpResponse。现在我真的不在乎我得到什么类型的异常，原因有几个。

```
try
     {
        var request = WebRequest.Create(new Uri("MyUrl")) as HttpWebRequest;
        request.GetResponse();
     }
catch(Exception)
    {
    } 
```

FxCop 希望我给出特定的异常，所以在我的情况下，我需要创建几个 catch 块，如下所示：

```
NotSupportedException
ArgumentNullException
SecurityException
InvalidOperationException
ProtocolViolationException
NotSupportedException
WebException 
```

我该如何解决这个警告并避免同时编写这么多的 catch 块？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-13T20:21:15.263

[与在该主题上提出的另一个问题](https://stackoverflow.com/questions/136035/catch-multiple-exceptions-at-once)类似，如果您想捕获异常，您必须`throw`在处理程序中有一个 final 以防止出现警告。

从有关此警告的[MSDN 文档中：](http://msdn.microsoft.com/en-us/library/ms182137%28v=vs.80%29.aspx)

> 要修复违反此规则的行为，请捕获更具体的异常，**或将一般异常重新抛出为 catch 块中的最后一条语句。**

也就是说，这对您的情况并没有真正的帮助，因为您想“吞下”异常，而不是重新抛出它。看着这六个特定例外的列表，我无法想象花时间（**认真地像五分钟**）以[最](http://blogs.msdn.com/b/codeanalysis/archive/2006/06/14/631923.aspx) [推荐的](http://blogs.msdn.com/b/codeanalysis/archive/2006/06/17/faq_3a00_-why-does-fxcop-warn-against-catch_2800_exception_29003f00_-_2d00_-part-2-_5b00_nick-guerrera_5d00_.aspx) [方式](http://blogs.msdn.com/b/codeanalysis/archive/2006/06/19/faq_3a00_-why-does-fxcop-warn-against-catch_2800_exception_29003f00_-_2d00_-part-3-_5b00_nick-guerrera_5d00_.aspx)处理每一个例外是一种痛苦的经历。这种情况并不经常发生，WebRequest 只是那些罕见的例子之一。

如果您的应用程序的生命周期很长，那么随着时间的推移，您可能会发现自己为这些异常中的每一个都实现了处理程序。没有人喜欢“发生一般错误 405”的错误消息。这可能不是 KISS，但奠定基础将使您避免捕获所有异常（如`OutOfMemoryException`），并且还可以防止 FxCop 警告（以及挑剔的开发人员的蔑视）。

如果您在应用程序中生成大量 WebRequest，那么下面的帮助程序类可能会很有用，它会抛出一个单一的`WebFetcherException`并且还有更多有用的错误消息。这是一个例子：

```
public static class WebFetcher
{
    public WebResponse FetchFromUrl(Uri uri)
    {
        try
        {
            var request = WebRequest.Create(new Uri("MyUrl")) as HttpWebRequest;
            return request.GetResponse();
        }
        catch (NotSupportedException ex)
        {
            //you could customize the error messages to be more suitable for your
            //application, or leaving room for future error handling
            throw new WebFetcherException(ex.Message, ex);
        }
        catch (ArgumentNullException ex)
        {
            throw new WebFetcherException(ex.Message, ex);
        }
        catch (SecurityException ex)
        {
            throw new WebFetcherException(ex.Message, ex);
        }
        catch (ProtocolViolationException ex)
        {
            throw new WebFetcherException(ex.Message, ex);
        }
        catch (WebException ex)
        {
            throw new WebFetcherException(ex.Message, ex);
        }
        catch (InvalidOperationException ex)
        {
            throw new WebFetcherException(ex.Message, ex);
        }
    }

    public class WebFetcherException : Exception
    {
        public WebFetcherException(string message, Exception inner)
            : base(message, inner)
        { }
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-11T21:02:12.070

您可以停用多个警告，我总是停用此警告 :-)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-11T21:04:02.793

fxCop 警告是建议，而不是命令。

换句话说，您可以自由判断是否遵循 fxCop 提出的指导方针和建议。

之所以有这个特别的建议，是因为您可能希望以不同的方式处理不同类型的错误。如果不是这种情况，您可以[忽略此规则](http://msdn.microsoft.com/en-us/library/bb429303%28VS.80%29.aspx#IgnoringRulesDuringAnalysis)，这样它就不会弄乱您的警告列表。

您比 fxCop 更了解您的业务规则和编码标准。它只是根据可能适用于也可能不适用于您的特定情况的最佳实践提出建议。

更多信息可以在这里找到：http: [//msdn.microsoft.com/en-us/library/bb429303 (VS.80).aspx](http://msdn.microsoft.com/en-us/library/bb429303(VS.80).aspx)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-04-11T20:58:28.870

尝试将其留空

```
try
{
        var request = WebRequest.Create(new Uri("http://localhost:59449/stwebapi/getstatus?userId=" + wwId)) as HttpWebRequest;
        request.GetResponse();
     }
catch
{

} 
```

**需要说这是非常糟糕的设计**，所以最好遵循`FxCop`指导方针，或者至少处理一个异常，并记录它（至少）

# android - 为什么我的IMEI号码在模拟器中总是0000000000000？

> ID：10113880
> 
> 赞同：-1
> 
> 时间：2012-04-11T20:57:50.393
> 
> 标签：android, android-emulator

嗨（抱歉我的英语不好），

我尝试获取 Eclipse 模拟器的 IMEI 号，但它始终为空，虽然我在 3 天前成功获取了“0000000000000”（我不知道我同时更改了什么）

```
private String IMEI = null;

TelephonyManager tm = (TelephonyManager)getSystemService(Context.TELEPHONY_SERVICE);
IMEI = tm.getDeviceId(); // empty 
```

我没有忘记许可。

```
<uses-permission android:name="android.permission.READ_PHONE_STATE" /> 
```

可能是什么问题呢？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T20:59:16.787

模拟器不会分配给它的 IMEI ......这个值可能没问题。在手机上试试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T21:06:14.260

```
TelehponyManager manager = (TelehponyManager)getSystemService(TELEPHONY_SERVICE);
String imei = manager.getDeviceId(); 
```

此代码在真实设备上运行良好，但在模拟器下 IMEI 始终为零且不可配置。

# java - 交付基于 Ant 的 Java 项目时的必要组件

> ID：10113886
> 
> 赞同：0
> 
> 时间：2012-04-11T20:58:13.107
> 
> 标签：java, ant

我有一个 Java 项目。最初我从 .java 和 .class 文件开始。之后我将 Ant 部署到我的项目中，现在我的项目目录中有 dist 和 docs 文件夹，还有 build.xml 。我的问题是在运送这个项目时，哪些文件应该提供给接收者，以便他可以编译和运行它和有没有应该提到的依赖关系。顺便说一句，recepienet 已向我索要源代码和二进制文件。另外，我是否需要担心设置 ant 类路径？，谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T21:15:32.053

您应该向您的客户提供编译和运行程序所需的一切。这意味着至少源代码、所有依赖库文件和构建脚本都被很好地打包了。这是您可以使用的基本布局：

```
src         (all your source code here)
lib         (third party libraries here)
build.xml   (your build script) 
```

确保您可以仅根据布局文件夹中的内容构建项目。然后清理文件夹，将它们压缩到存档中并将存档发送给您的客户。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T21:12:31.843

如果您正在使用 Ant 构建您的项目并且您已经创建了一个`build.xml`文件，那么包含该文件将帮助该人通过指定依赖项等来构建您的项目。

Ant 站点有一个 build.xml 文件的示例。 [http://ant.apache.org/manual/using.html#example](http://ant.apache.org/manual/using.html#example)

# python - __module__ 的语义

> ID：10113892
> 
> 赞同：17
> 
> 时间：2012-04-11T20:58:27.377
> 
> 标签：python

我在模块中动态定义函数，然后更新模块`__all__`和函数的`__name__`属性以匹配模块内部的名称。我想知道更新函数的`__module__`属性以及指向函数将驻留的模块是否是个好主意。文档说`__module__`是：

> 定义函数的模块的名称，如果不可用，则为 None。

创建函数的代码位于不同的模块中，该模块与函数所在的模块几乎无关。该模块中没有对函数的引用。

我已经在邮件列表上进行了一些探索，但是对于它的语义`__module__`是什么以及是否应该将其设置为 None 或函数所在的模块或代码所在的模块创建了功能。暂时搁置它，但有兴趣看看是否有人知道答案。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-17T15:37:30.060

我不会这样做的。将函数从一个模块导入另一个模块是很常见的。该`__module__`属性用于检索定义函数的模块，以读取源代码或有时在脚本中重新导入它。我认为定义是通过静态代码还是动态代码没有太大区别：如果有人想阅读您的函数的源代码，他们应该查看动态创建它的模块。

你可以看看[PEP 3130](http://www.python.org/dev/peps/pep-3130/)。`__module__`尽管它被拒绝了，但它可能会让您比其他地方的单句描述更深入地了解它的目的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-11T21:08:21.703

您通常不必担心`__module__`，有时它用于黑魔法或知道函数来自哪里（示例）调试，但大多数时候每个人都忽略它。如果你真的很担心设置`__module__ = "dynamically_defined_function"`或类似的东西。

# ruby-on-rails - 关于删除方法

> ID：10113895
> 
> 赞同：0
> 
> 时间：2012-04-11T20:58:38.083
> 
> 标签：ruby-on-rails, rails-activerecord

我有一个方法可以在删除父用户时将一条信息的所有权传递给父用户，但我目前在控制器中的 @user.destroy 之前调用它。

有没有办法按照惯例运行删除方法，而不是我目前的做法？像`on_delete: :do_this_method`模型中的东西，是我正在寻找的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T21:10:36.487

只需这样做：

```
 before_destroy :do_this_method 
```

见[这里](http://api.rubyonrails.org/classes/ActiveRecord/Callbacks.html)。

旁注：我建议您始终使用`destroy`而不是`delete`.

# django - django 中是否有一个可以处理 html 的字段？

> ID：10113896
> 
> 赞同：0
> 
> 时间：2012-04-11T20:58:43.420
> 
> 标签：django, forms, html-parsing

我的网站上有一个表单，用户可以使用它来提交文章，但我刚刚考虑过他们可能会使用 html 来嵌入视频。我有一篇文章的正文作为 TextField，但不是我手动解析 html，有什么可以自动完成的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T22:19:14.843

您正在使用的 TextField 是一个不错的选择，不要解析 HTML 文本，将其原始存储在数据库中，并在需要时将其呈现在模板中 - 预览/查看已发布的文章。您应该只为帮助创建格式化文章/嵌入文件等的用户提供一种机制。一个不错的选择是 [TinyMCE](http://www.tinymce.com/)，就我而言，有一些插件可以上传媒体。

# java - 每个客户端模型或 NIO 反应器模式的旧 I/O 线程？

> ID：10113902
> 
> 赞同：15
> 
> 时间：2012-04-11T20:59:01.720
> 
> 标签：java, multithreading, networking, nio

我正在编写多人游戏的服务器端网络。该游戏是一款角色扮演游戏，最大容量为 2000 名玩家，但实际上最多可容纳 300 名玩家，尽管可能更高或更低。在最长的时间里，每次我不得不做涉及大量客户端的网络时，我都坚持使用 NIO，因为它不需要使用数百个线程。最近，我遇到了一个 PowerPoint 演示文稿，其中详细描述了这两种模型，它几乎使每客户端线程模型看起来优于 NIO。我还发现一些地方表明旧的 IO 实际上也可以胜过 NIO。

可以在这里找到 PowerPoint（它有点旧）： http: [//www.mailinator.com/tymaPaulMultithreaded.pdf](http://www.mailinator.com/tymaPaulMultithreaded.pdf)。

我还没有写任何内容，所以如果我不得不改变我的整个网络设计，从头开始对我来说不是问题。我没有时间压力。最初，我正在使用 NIO 设计一个反应器模式实现（选择一个事件，调度一个处理程序来处理该事件）。

更多信息可以在这里找到：[http ://en.wikipedia.org/wiki/Reactor_pattern](http://en.wikipedia.org/wiki/Reactor_pattern)

我的整个反应器实现设计为使用单个线程。因为我读到旧的 IO 可以跑赢，这实际上让我进退两难。我不想设计一个复杂的 NIO 系统，它使用多个线程来充分利用所有 CPU 能力，但我也对让单个应用程序使用 300 多个线程的想法感到畏缩。哪种设计适合我的目的？每个客户端线程的优势在于它真正利用了本质上的所有 CPU 能力，但与此同时，它使系统陷入困境。更不用说，单个线程的堆栈大小占用了大量内存（当乘以几百倍时）。我应该坚持反应堆模式吗？

I know this question is a bit ambiguous, but I feel that I need to ask a question specifically for my situation because I could not find a question on this site nor a website where it addresses an issue of my sort. There was one about a game, but the game was meant to handle tens of thousands of players.

Thanks a lot! If you need any clarification, please ask!

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-11T21:03:24.503

> 我不想设计一个复杂的 NIO 系统，它使用多个线程来充分利用所有 CPU 能力，但我也对让单个应用程序使用 300 多个线程的想法感到畏缩。哪种设计适合我的目的？

我们的 JVM 持续运行超过 500 个线程（现在它们大约为 700 个），峰值在 1000 多个。我认为没有理由认为 800 个线程在某种程度上值得“畏缩”。当你达到 10,000 个线程（作为一个球场数字）时，我会开始担心——如果你在 32 位下运行，可能会更少。当你进入 1000s 时，你当然必须分配更多的内存，但任何低于 1k 的线程都不应该成为问题。[这是一个关于线程创建编号](http://java.dzone.com/articles/java-what-limit-number-threads)的好页面。

*当您有大量*不频繁 IO 的连接时，NIO 效率最高。当涉及到异步通信时，它解决了很多问题，并且您可以使用 NIO 做一些从功能角度来看“旧 IO”无法做到的事情（例如可中断通道和非阻塞 IO），但是单线程处理程序是一个更简单的模型，我并不感到惊讶，它可以在许多配置中胜过 NIO 实现。使用 NIO，您可以在 Java 代码中执行大量操作，这些操作是在 JVM 甚至内核中以本机代码为您完成的。流的多路复用和就绪 IO 的处理都是您使用“旧 IO”模型“免费”（就复杂性而言）获得的所有东西。

我会保持简单并坚持使用每个客户端线程模式，直到您有充分的理由接受复杂性的打击。

# ruby-on-rails - 在 ruby on rails 的数据库字段更新中使用 self

> ID：10113903
> 
> 赞同：1
> 
> 时间：2012-04-11T20:59:05.957
> 
> 标签：ruby-on-rails

我不明白为什么我在`nil`下面收到错误。但是当我添加时，`self`我没有收到错误，并且所有内容都得到了更正。你能向我解释为什么如果我不使用`self`它不起作用？

模型/用户.rb

```
def update_user_email!(new_email)
  email = new_email # When I use self.name = new_email this works
end 
```

控制器/用户控制器

```
def create
  @user = User.new(params[:user])
  @user.update_user_email!(email)
  @user.save
end 
```

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T21:58:21.957

当您在模型内的方法中时，如果您仅使用属性名称，它将把它视为一个变量，其范围仅限于此方法。使用 self.attribute 实际上将访问模型中的基础字段并让您分配值。

作为基本规则，任何时候你在模型中实际赋值时，你都应该使用

```
self.attribute = value 
```

另一方面，我不确定您的代码是否只是示例，但它看起来不像您需要的方法。

在控制器中你可以做

```
@user.email = email 
```

# jquery - 使用 jquery 和 ajax 发送授权标头

> ID：10113911
> 
> 赞同：5
> 
> 时间：2012-04-11T20:59:43.443
> 
> 标签：jquery, json, authentication, get, xmlhttprequest

我在stackoverflow上查看了以下问题，但我尝试做的事情没有运气。

[Ajax 授权请求标头一次又一次地失败](https://stackoverflow.com/questions/9820170/ajax-authorization-request-headers-fails-again-and-again)

[jQuery Ajax 未经授权的 401 错误](https://stackoverflow.com/questions/8847748/jquery-ajax-unauthorized-401-error)

[使用跨域帖子发送凭据？](https://stackoverflow.com/questions/2054316/jquery-sending-credentials-with-cross-domain-posts)

这是我目前拥有的代码：

```
 $(document).ready(function() {
        $.ajax({
            url: 'http://sample.domain.com/script.php?name1=value1&jsonp=?',
            type: 'GET',
            dataType: 'json',
            contentType: "application/json",
            beforeSend: function(xhr) {
                 xhr.setRequestHeader("Authentication", "Basic ZnJvbWFwcGx********uOnRoM24zcmQ1UmgzcjM=") //Some characters have been replaced for security but this is a true BASE64 of "username:password"
            },
            success: function(data){
                alert(data);
            }
        });
    });

</script> 
```

我拥有的子域受 .htpasswd 文件的密码保护。使用 base64 编码中使用的用户名/密码组合，该站点的登录对我来说工作得很好。

我在与 url 所在的域不同的域上运行此脚本，这就是为什么我有 jsonp=? 在网址中

我从浏览器中的控制台得到的响应是： `GET http://sample.domain.com/script.php?name1=value1&jsonp=jsonp1334177732136 401 (Authorization Required)`

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-08-16T20:21:07.660

标题名称是`Authorization`，您正在发送“ `Authentication`”

例如

> 授权：基本 QWxhZGRpbjpvcGVuIHNlc2FtBmU=

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-11T21:59:05.057

JSONP 使用脚本标签代理。它不支持自定义标题。您是否可以控制端点？如果是这样，请考虑启用 CORS，或在 GET 字符串中传递身份验证密钥。

使用 jsonp 时，JQuery 将您的 URL“ajax”请求转换为：

```
<script src="[endpoint]"></script> 
```

然后它写一个随机函数

```
var json9409d0sf0d9s0df90 = function() {
     //some callback logic here.
} 
```

并附加 ?callback=json9409d0sf0d9s0df90

你的服务器然后说

```
echo $_GET['callback] . "(" . $json . ")"; 
```

并将其作为响应发回

```
json9409d0sf0d9s0df90({some: data}); 
```

由浏览器执行并由 jQuery 的神奇处理程序处理，使其像正常的 ajax 回调一样响应。

AFAIK，`<script src=""></script>`资产加载不会采用任何标准浏览器的自定义标题。

# ios - 如何在 AIR IOS 上优化大尺寸 jpeg？(AS3)

> ID：10113914
> 
> 赞同：0
> 
> 时间：2012-04-11T21:00:02.003
> 
> 标签：ios, actionscript-3, optimization, air, flash-cs5

我正在使用 AS3 开发 ipad 游戏。由于游戏的细节问题，我必须在大约 5 个大小为 4800x1800 的背景之间切换。通常，我使用开关功能关闭所有背景电影剪辑的可见性，然后打开我需要的那个，但每次，我的功能第一次工作正常，但第二次破解。我已经追踪并发现它确实是背景可见的开关。之后，我尝试使用 bitmapdata 并重新绘制每个屏幕开始。但更糟糕的是，我第一次测试破解。似乎处理器无法处理如此大的位图数据。任何人都有这样的好方法吗？

P/s：我的游戏在PC上运行完美，没有任何错误，只是在iPad上破解，我已经调试过它在运行switch bg功能时停止了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-11T22:04:27.663

您是否将位图数据细分为较小的图块以进行剔除？如果没有，这绝对是要走的路。您希望您的引擎像拼图一样工作，只将可见拼图的各个部分放在一起。理想情况下，对于像 iOS 这样的平台，您会希望大小约为 250x250 以实现最佳内存管理（基于我所做的一些测试）。恕我直言，4800x1800 的数据集太大而无法作为单个实体处理。

位图平铺的基础知识：http: [//as3adventure.blogspot.com/2011/06/bitmapfill-and-tiles-and-scrolling-it.html](http://as3adventure.blogspot.com/2011/06/bitmapfill-and-tiles-and-scrolling-it.html)

希望这可以帮助！

# android - 不同字符串编码的 split 和 indexOf 问题

> ID：10113916
> 
> 赞同：0
> 
> 时间：2012-04-11T21:00:04.753
> 
> 标签：android, string

出于某种原因，在某些情况下使用 string.split 会出现问题。它必须与文件的编码有关。但是，我确保在 Eclipse 中的 Encoding 下，它在所有情况下都显示为“Default MacRoman”——这是所有代码文件中使用的默认值。

然而，当我将一个字符串从我的一个 java 文件复制到另一个包含该字符串的文件时：

```
"Test String" - while typing this string again "Test String" 
```

它们是有区别的。在第一个中，“”空间编码为 160，而在第二个中，它是 32。

因此，在使用 split 时，我必须确保使用正确编码的“”。

这就是我现在的做法——我认为不是很优雅。

where**`longText`**包含要拆分的文本

```
 char splitChar;
    if (longText.indexOf((char) 32) > 0) {
        splitChar = (char) 32;
    } else
        splitChar = (char) 160;
    String splitCharString = String.format("%c", splitChar);
    String[] tokens = longText.split(splitCharString); 
```

有一个更好的方法吗？

ps 只是将 Eclipse 中文件的编码显式更改为 MacRoman 不起作用

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T21:11:44.850

[160 是不间断空格](http://en.wikipedia.org/wiki/Non-breaking_space)字符的 Latin1（因此是 Unicode）代码点。它不同于普通的空间。

MacRoman 字符集在不同的代码点 (202) 上具有此功能。通常，要编辑 Java 源代码，您应该使用 Unicode 编码，例如 UTF-8。

# jquery - 当用户仍在尝试选择时，如何避免响应选择列表 onchange 事件？

> ID：10113929
> 
> 赞同：4
> 
> 时间：2012-04-11T21:00:41.957
> 
> 标签：jquery, html, javascript-events

我有一个使用 jQuery与`<select>`输入事件关联的处理程序：`change`

```
$('#myList').change(function () {
   //...
}); 
```

当用户`Tab`输入并开始输入时（没有点击打开下拉列表），不同的浏览器表现不同。

*   `Enter`在 Firefox 中，除非用户按下或`Tab`或以其他方式将焦点从选择列表中移开，否则更改事件不会触发。
*   在 IE 和 Chrome 中，当用户键入导致选择列表中的项目发生更改的内容时，就会触发 change 事件。

因为我的`change`函数执行 AJAX 请求，所以我希望避免在用户键入或使用箭头键选择选项时让我的函数执行任何操作。*但是，如果用户使用鼠标选择特定的下拉元素，或者如果用户按下回车*键，我仍然希望触发 change 事件。换句话说，我希望 IE 和 Chrome 表现得像 Firefox。

是否有任何（理想情况下简单的）方法来获得我正在寻找的行为？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T21:32:07.460

编辑：

这应该可以满足您的所有要求 - [http://jsfiddle.net/yfQ3V/4/](http://jsfiddle.net/yfQ3V/4/)

HTML：

```
<select data-value="one">
    <option>one</option>
    <option>two</option>
    <option>three</option>
</select>
<span></span> 
```

JS：

```
var $select = $('select');
var $span = $('span');

var onChange = function () {
    setText();
};

var onKeyDown = function () {
    $select.off('change');
    var keyCode = e.keyCode || e.which;

    if(keyCode == 13 || keyCode == 9) {
        $select.on('change', onChange).change(); 
    }
};

var onBlur = function () {
    if($select.val() != $select.data('value')) {
        setText();
    }
};

var setText = function () {
    var val = $select.val();
    $select.data('value', val);
    $span.text(val + ' - ' + new Date());   
};

$select.on('change', onChange)
       .on('keydown', onKeyDown)
       .on('blur', onBlur); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-04T18:50:24.703

我最终创建了一种方法，该方法将使我的*所有*`<select>`控件都以相同的方式运行，这样我就不必在每种特定情况下都执行一次性的 Javascript。这有点 hacky，但至少我避免了这样的重复代码：

```
$(function() {
    // Make select lists in Chrome and IE behave more like Firefox: when they are focused
    // but not open and the user starts typing, we don't want the "change" event to fire
    // until the user has actually selected the value they want.
    var invokePendingChanges = function () {
        /// <summary>
        /// Event handler which checks "this" select box for a code that shows that changed
        /// events have been ignored. If it finds the code, it will invoke the 'change'
        /// event on the input.
        /// </summary>
        var t = $(this);
        if (t.data('change-pending')) {
            setTimeout(function () {
                t.data('change-pending', false);
                t.change();
            }, 0);
        }
    };
    $('select')
        .keydown(function(e) {
            // If the user hit the enter key, invoke pending changes.
            if (e.which == 13) {
                invokePendingChanges.call(this);
            } else {
                var t = $(this);
                // Be aware that date('events') isn't part of the official API, so it is subject
                // to change with future versions of jQuery.
                var allHandlers = t.data('events');
                var changeHandlers = allHandlers ? allHandlers['change'] : null;
                delete allHandlers['change'];
                t.change(function() {
                    t.data('change-pending', true);
                    return false;
                });

                var revert = function() {
                    allHandlers['change'] = changeHandlers;
                    clearTimeout(timeout);
                    t.off('blur', revert);
                };
                t.on('blur', revert);
                var timeout = setTimeout(revert, 0);
            }
        })
        .blur(invokePendingChanges);
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-20T06:09:39.913

这是我的解决方案，基于 tjscience 的回答。它被实现为一个 jquery 函数，并且在使用不同的处理程序多次绑定到同一个元素时工作。

```
$.fn.dropDownChangeEventThatBehavesLikeFirefox = function (handler) {
/// <summary>The change() event behaviour for select boxes is different between Firefox and other browsers when using the keyboard.
/// Firefox only fires the change event when focus is lost, whereas other browsers fire the change event as soon the user uses the
/// keyboard to scroll through the select box.
/// This method should be used instead of the name jquery change() event to get consistent behaviour between Firefox and
/// other browsers (preferring the Firefox method).
/// </summary>
if ($.browser.mozilla) {
    // Firefox already behaves like we want it to, so get out of here.
    $(this).change(handler);
    return;
}

$(this).each(function () {

    var lastValue = $(this).val();

    $(this)
        .change(function () {
            var $this = $(this);

            handler.apply(this);

            lastValue = $this.val();
        })
        .keydown(function (e) {
            var $this = $(this);

            $this.off('change');
            var keyCode = e.keyCode || e.which;

            if (keyCode == 13 || keyCode == 9) {
                $this.on('change', handler).change();
            }
        })
        .on('blur click', function () {
            var $this = $(this);

            if ($this.val() != lastValue) {
                handler.apply(this);
                lastValue = $this.val();
            }
        });
});
}; 
```

# r - 如何检查向量中的每个元素在R中是否为整数？

> ID：10113933
> 
> 赞同：13
> 
> 时间：2012-04-11T21:00:46.460
> 
> 标签：r, vector, integer

假设我有一个向量 y，我想检查 y 中的每个元素是否为整数，如果不是，则停止并显示错误消息。我试过is.integer(y)，但它不起作用。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-04-11T21:40:16.150

最简单（也是最快！）的事情可能是这样的：

```
stopifnot( all(y == floor(y)) ) 
```

...所以尝试一下：

```
y <- c(3,4,9)
stopifnot( all(y == floor(y)) ) # OK

y <- c(3,4.01,9)
stopifnot( all(y == floor(y)) ) # ERROR! 
```

如果您想要更好的错误消息：

```
y <- c(3, 9, NaN)
if (!isTRUE(all(y == floor(y)))) stop("'y' must only contain integer values") 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-04-11T21:09:37.113

你可以这样做：

```
 y <- c(3,3.1,1,2.3)
   (y - floor(y)) == 0
    [1]  TRUE FALSE  TRUE FALSE 
```

或者

```
 (y - round(y)) == 0 
```

如果你想要一个`TRUE`或`FALSE`整个东西，把它放进去`all()`，例如：

```
 all((y - round(y)) == 0)
    [1] FALSE 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-04-11T21:15:13.483

这是另一种方式（使用与贾斯汀相同的技巧，将每个数字与强制转换为“整数”类型的数字进行比较）：

```
R> v1 = c(1,2,3)
R> v2 = c(1,2,3.5)
R> sapply(v1, function(i) i == as.integer(i))
[1] TRUE TRUE TRUE
R> sapply(v2, function(i) i == as.integer(i))
[1]  TRUE  TRUE FALSE 
```

进行测试：

```
R> all(sapply(v2, function(i) i == as.integer(i)))
[1] FALSE 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-04-11T21:11:40.500

不知道蒂姆的方式或这个方式哪个更快，但是：

```
> x <- 1:5
> y <- c(x, 2.0)
> z <- c(y, 4.5)
> all.equal(x, as.integer(x))
[1] TRUE
> all.equal(y, as.integer(y))
[1] TRUE
> all.equal(z, as.integer(z))
[1] "Mean relative difference: 0.1111111"
> 
```

或者：

```
all((z - as.integer(z))==0) 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-04-11T21:13:55.227

我走了一个完全不同的方向然后蒂姆（我更喜欢他，尽管我的方法适用于混合向量，它是一个带有整数的字符向量等）：

```
int.check <- function(vect) {
    vect <- as.character(vect)
    sapply(vect, function(x) all(unlist(strsplit(x, ""))%in% 0:9))
}

x <- c(2.0, 1111,"x", 2.4)
int.check(x) 
```

编辑：更改了函数，因为它仅适用于字符向量。

**这也适用于类字符的向量，以防您有一个混合了各种数字但已被强制转换为字符的字符向量。**

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-05-07T23:08:30.807

检查以下内容有助于我们在脚本中使用清晰的 if 条件。

```
sff <- 5

if(!(is.integer(sff) == is.character(sff))){ 
  sff
} else {
  "hello"
} 
```

给

```
hello 
```

`sff <- 'a'`结果给出`'a'`。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-11-03T17:09:07.400

如果您有浮点表示错误，请尝试：

```
round( y, TOLERANCE.DIGITS ) %% 1 == 0 
```

在我的应用程序中，我遇到了严重的浮点表示错误，例如：

```
> dictionary$beta[3]
[1] 89
> floor(dictionary$beta[3])
[1] 88
> as.integer( dictionary$beta )[3]
[1] 88
> dictionary$beta[3] %% 1
[1] 1 
```

余数除以一为一。我发现在取整数之前我必须四舍五入。如果您希望将上述 89 计为整数，我认为*所有*这些测试都会失败。“all.equal”函数是处理浮点表示错误的最佳方法，但是：

```
all.equal( 88, 89 ); 
```

在我的情况下，会（并且确实）对整数值检查给出假阴性。

编辑：在基准测试中，我发现：

```
(x == as.integer(x)) 
```

是普遍**表现最好**的。

```
(x == floor(x))
((x - as.integer(x)) == 0) 
```

通常工作得很好，通常也一样快。

```
(x %% 1 <= tolerance) 
```

有效，但不如其他人快

```
!(is.character(all.equal(x, as.integer(x)))) 
```

当向量不是整数时，性能**很差**（当然是因为估计差异会很麻烦）。

```
identical(x, as.integer(x)) 
```

当向量都是整数值时，返回**不正确**的结果（假设问题是为了检查整数值，而不是整数类型）。

# visual-studio - 将代码添加到 EnvironmentEvents 模块

> ID：10113934
> 
> 赞同：1
> 
> 时间：2012-04-11T21:00:49.590
> 
> 标签：visual-studio, visual-studio-2010, macros, development-environment

我希望能够将代码/宏添加到环境事件模块。我该怎么做这样的事情？这是一个帖子，我听说过这样的事情，但我不知道从哪里开始如何做。 [https://stackoverflow.com/a/2112181/1055946](https://stackoverflow.com/a/2112181/1055946)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-12T01:57:24.283

您可以`EnvironmentEvents`使用`Alt`+`F8`打开宏资源管理器，然后在 中打开 Module1 `MyMacros`，这将在`Visual Studio Macro Editor`. `EnvironmentEvents`位于那里。[然后，您可以通过阅读MSDN 文档](http://msdn.microsoft.com/en-us/library/b4c73967.aspx)了解宏。

![在此处输入图像描述](../Images/d7a12dce696e2424bfc6e2f935536c56.png)

# generics - 泛型类型到接口隐式转换

> ID：10113939
> 
> 赞同：0
> 
> 时间：2012-04-11T21:01:07.210
> 
> 标签：generics, c#-4.0, interface, type-conversion, implicit

我知道接口不支持隐式运算​​符，幸运的是我没有尝试这样做。但它很接近，它给了我错误，我不确定解决这个问题的聪明方法是什么......

我有一个主讲者：

```
 public sealed class PersonPresenter : RecordPresenter<IPersonService,PersonOverview,PersonMailMergeSource> 
```

拉取自：

```
 public abstract class RecordPresenter<T, K, U> : BasicRecordPresenter<K>
    where T : IRecordService<K>
    where K : IRecordInfo
    where U : IMailMergeSource<K>, new() 
```

问题是（我知道这很烦人，但我正在解决一个整体）是 IPersonService 实际上是：

```
 public interface IPersonService: IRecordService<PersonInfo> 
```

但没关系。PersonOverview 里面有 PersonInfo 作为 PersonOverview.Person，所以我在 PersonOverview 中创建了这个方便的转换：

```
 public static implicit operator PersonInfo(PersonOverview rhs)
    {
        return rhs.Person;
    } 
```

但是回到 PersonPresenter 它会抛出这个错误：

```
The type 'IPersonService' must be convertible to 'IRecordService<PersonOverview>' in order to use it as a parameter 'T' in the generic class 'RecordPresenter<T,K,U>'. 
```

我这样做是不可能的吗？有没有合适的方法来做到这一点？我注定要失败吗？谢谢！

# html - 如何根据模型项 id 设置 Html id

> ID：10113941
> 
> 赞同：2
> 
> 时间：2012-04-11T21:01:13.783
> 
> 标签：html, asp.net-mvc

我有一些代码，例如：

```
<table>         
    @foreach (var invoiceLine in Model.Invoice.InvoiceLine)) {
        <tr class="subheader">
             <td>
                 <div class="approval">
                     <span>Office sign off:</span>
                          @Html.DisplayFor(modelItem => item.OfficeUser.Name)
                     <span id="officeapprovalspan">@(item.OfficeApproved.HasValue ? (item.OfficeApproved.Value ? "Accepted" : "On Hold") : "Please Approve")</span>
                 </div>
             </td> 
```

好吧，`id="officeapprovalspan"`我想设置它的跨度，以便它是 officapprovalspan"x"，其中 x 是当前项目 invoiceLineId。

因此，当 invoiceLineId=3 理想情况下，我希望跨度 ID 为`id="officeapprovalspan3"`

任何人都知道如何实现这一目标？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-11T21:06:29.817

```
<span id="officeapprovalspan@(invoiceLine.invoiceLineId)">@(item.OfficeApproved.HasValue ? (item.OfficeApproved.Value ? "Accepted" : "On Hold") : "Please Approve")</span> 
```

或者

```
<span id="@("officeapprovalspan" + invoiceLine.invoiceLineId)">@(item.OfficeApproved.HasValue ? (item.OfficeApproved.Value ? "Accepted" : "On Hold") : "Please Approve")</span> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-11T21:03:28.743

怎么样：

```
<span id="officeapprovalspan@invoiceLine.InvoiceLineId"> 
```

# asp.net-mvc - MVCSiteMapProvider - 最近添加的关键字，现在它们填充在 MenuHelper 的链接中

> ID：10113948
> 
> 赞同：3
> 
> 时间：2012-04-11T21:01:29.963
> 
> 标签：asp.net-mvc, asp.net-mvc-3, razor, mvcsitemapprovider

我在我的 MVC3 站点中使用 MVCSiteMapProvider，并且我最近在 mvc.sitemap 中的节点中添加了元关键字和描述

> < mvcSiteMapNode controller="Home" action="Index" title="Home" description=""keywords="home, home page, 欢迎" >

... 例如。

然后我的视图像这样填充它：

> @{ 字符串标题 = ""; 字符串关键字 = ""; 字符串描述 = "";
> 
> ```
>  if (SiteMap.CurrentNode != null)
>   {
>       title = SiteMap.CurrentNode["title"];
>       keywords = SiteMap.CurrentNode["keywords"];
>       description = SiteMap.CurrentNode["description"];
>   } 
> ```
> 
> }
> 
> <标题>>@标题</标题>>
> 
> <meta name="keywords" content="@keywords" />
> 
> <meta name="description" content="@description" />

在我使用的所有页面上：

> @Html.MvcSiteMap().Menu(0, true, true, 1)

自从我开始将内容放入关键字部分以来，菜单中的链接填充如下：

> <a href="/?keywords=home%20%2C%20Home%20Page%2C%20welcome" >首页</a>

我不确定为什么会出现这种情况，我希望它不存在。有人有想法么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-12T09:59:31.923

据我所知，这是一个未记录的 MvcSiteMapProvider 功能。节点上的所有未知属性都作为 RouteValues 默认值插入。要忽略关键字属性，请在 web.config 中编辑站点地图设置并将“关键字”添加到 attributesToIgnore。如果您使用的是默认插入配置，则 MvcSiteMapProvider 应该已经定义了 attributesToIgnore。以下是添加到属性ToIgnore 的关键字的默认设置：

```
<siteMap defaultProvider="MvcSiteMapProvider" enabled="true">
  <providers>
    <clear/>
    <add name="MvcSiteMapProvider"
      type="MvcSiteMapProvider.DefaultSiteMapProvider, MvcSiteMapProvider"
      siteMapFile="~/Mvc.Sitemap"
      securityTrimmingEnabled="true"
      cacheDuration="5"
      enableLocalization="true"
      scanAssembliesForSiteMapNodes="true"
      excludeAssembliesForScan=""
      includeAssembliesForScan=""
      <!-- Added keywords -->
      attributesToIgnore="bling,visibility,keywords"
      nodeKeyGenerator="MvcSiteMapProvider.DefaultNodeKeyGenerator, MvcSiteMapProvider"
      controllerTypeResolver="MvcSiteMapProvider.DefaultControllerTypeResolver, MvcSiteMapProvider"
      actionMethodParameterResolver="MvcSiteMapProvider.DefaultActionMethodParameterResolver, MvcSiteMapProvider"
      aclModule="MvcSiteMapProvider.DefaultAclModule, MvcSiteMapProvider"
      siteMapNodeUrlResolver="MvcSiteMapProvider.DefaultSiteMapNodeUrlResolver, MvcSiteMapProvider"
      siteMapNodeVisibilityProvider="MvcSiteMapProvider.DefaultSiteMapNodeVisibilityProvider, MvcSiteMapProvider"
      siteMapProviderEventHandler="MvcSiteMapProvider.DefaultSiteMapProviderEventHandler, MvcSiteMapProvider"/>
  </providers>
</siteMap> 
```

# php - 想通过 Wordpress 导航菜单直接打开 Shadowbox 画廊

> ID：10113952
> 
> 赞同：1
> 
> 时间：2012-04-11T21:01:54.277
> 
> 标签：php, html, wordpress, shadowbox

我希望能够通过直接单击导航栏中的投资组合链接在 wordpress 中打开我的 shadowbox 画廊。现在它要么打开我制作的包含画廊的投资组合页面，要么单独打开图像（没有阴影框），这是因为我尝试将 html 添加到 wordpress 仪表板中的导航标签。基本上希望能够将此 html 添加到菜单仪表板中的链接，同时拥有一个 PORTFOLIO 链接：

```
<a href="/portfolio_images/fashion/01.jpg" rel="shadowbox[fashion]">
<a href="/portfolio_images/fashion/02.jpg" rel="shadowbox[fashion]"> 
<a href="/portfolio_images/fashion/03.jpg" rel="shadowbox[fashion]"> 
```

谢谢

[带有导航链接的主页](http://www.e-comstudio.com/e-comstudio/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T23:31:21.747

终于想通了这个。这是我使用我使用的主题的方法。

在 Wordpress 仪表板的菜单设置中，确保选中屏幕选项下的链接关系 (XFN)。然后，我添加了一个自定义 URL 菜单项，并将其作为 URL（以我的示例为例）：[http ://www.e-comstudio.com/portfolio_images/fashion/01.jpg](http://www.e-comstudio.com/portfolio_images/fashion/01.jpg)

然后，我在 XFN 框中添加了 shadowbox[fashion]。

我还将图库中的其他图像添加到页面上使用的小部件中：

```
<a href="/portfolio_images/fashion/02.jpg" rel="shadowbox[fashion]"></a>
<a href="/portfolio_images/fashion/03.jpg" rel="shadowbox[fashion]"></a> 
```

您还必须防止 Wordpress 从 XFN 字段中删除 [ ] 括号，这可以通过从 wp-includes/nav-menu.php 中注释/删除此行来完成

$args['menu-item-xfn'] = implode('', array_map('sanitize_html_class', explode('', $args['menu-item-xfn'])));

可能不是最理想的方法，但它成功了！

你可以在这里看到完成的结果，点击投资组合：

[http://www.e-comstudio.com/](http://www.e-comstudio.com/)

# php - 半自动为不安全的 PHP mysql 脚本添加安全性

> ID：10113954
> 
> 赞同：2
> 
> 时间：2012-04-11T21:02:04.183
> 
> 标签：php, mysql, security, automation, notepad++

我有很多文件，其中包括

```
1- mysql_query("update ... $_POST['foo'] ..."); 
```

我想把它变成这个

```
2- $foo = mysql_real_escape_string($_POST['foo']);
3- mysql_query("update ... $foo ..."); 
```

我的想法是打开每个文件，选择文本`$_POST['foo']`（表格 1-）按一个组合键，然后自动使用一些工具：

*   放在我的剪贴板上`mysql_real_escape_string($_POST['foo']);`（用于添加 2-）
*   将 1- 中的文字替换为 3- 中的文字

然后手动写`$foo =`，按ctrl+v生成2-

我正在尝试使用notepad++和一个名为fingertext的插件，并尝试制作一个宏，但没有成功。

有什么建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-11T21:06:30.240

```
$_POST = sanitize($_POST);
$_GET = sanitize($_GET);

    function sanitize($input) {
        if (is_array($input)) {
            foreach($input as $var=>$val) {
                $output[$var] = sanitize($val);
            }
        } else {
            if (get_magic_quotes_gpc()) {
                $input = stripslashes($input);
            }
            $output = mysql_real_escape_string($input);
        }
        return $output;
    } 
```

它并不完美，但是如果您有很多不安全的页面并且需要快速修复以使它们都安全，您可以在连接到 mysql 后放置它。另外，请记住，如果您的查询有未引用的数字变量，您将必须验证它们是数字，或者在查询中使用它们之前对它们进行类型转换。mysql_real_escape_string() 仅适用于引用值（即 blah_column = 'value'，但不适用于 blah_column = value）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-11T21:08:17.887

用手一一更换。如果您关心安全性，请不要进行自动替换。并且至少创建一个函数而不是`mysql_real_escape_string(()`, 使用它。

```
 //just for example, better can be written
function db_escape($var, $type = 'string') 
{
   if($type == 'string') return mysql_real_escape_string($var);
   if($type == 'integer') return (int) $var;
   if($type == 'float') return (float) $var;
} 
```

# html - XML/XSLT 转换逻辑/If 语句/隐藏某行

> ID：10113960
> 
> 赞同：2
> 
> 时间：2012-04-11T21:02:29.657
> 
> 标签：html, xml, xslt

我在使用 XSL 将 XML 的显示格式化为 HTML 时遇到问题。

我有以下 XML：

```
<?xml version="1.0" encoding="ISO-8859-1"?>
<Send_Email>
<Send_Email_lookupID>HIDE_REJECT</Send_Email_lookupID>
<Error_Message>REJECT1</Error_Message> 
<Error_Message>REJECT2</Error_Message>   
<Error_Message>REJECT3</Error_Message>   
</Send_Email> 
```

和 XSL：

```
<?xml version="1.0" encoding="ISO-8859-1"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
<xsl:template match="/">
<html>
<body>
<h2>Result</h2>
<table border="1">
<xsl:for-each select="/Send_Email">
<xsl:if test="not(/Send_Email_lookupID)">
<tr>
<td><xsl:value-of select="*"/></td>
</tr>
</xsl:if>
</xsl:for-each>
</table>
</body>
</html>
</xsl:template>
</xsl:stylesheet> 
```

此行始终是静态的，应隐藏：

```
<Send_Email_lookupID>HIDE_REJECT</Send_Email_lookupID> 
```

下一组行可能每次都不同，但都需要显示。

有谁可以帮我离开这里吗？

提前致谢。

* * *

更新 - 正确的解决方案

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"> 
<xsl:template match="/">
<html>
<body>
<h2>Result</h2> 
<table border="1">
<xsl:for-each select="Send_Email/*[local-name()!='Send_Email_lookupID']"> 
<tr>
<td><xsl:value-of select="."/></td>
</tr>
</xsl:for-each>
</table>
</body>
</html>
</xsl:template>
</xsl:stylesheet> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T21:31:44.740

我假设您想要一个表格，其中每条错误消息都有一行 - 而您正在寻找的是：

```
<?xml version="1.0" encoding="ISO-8859-1"?> 
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"> 

  <xsl:template match="/"> 
    <html> 
      <body> 
        <h2>Result</h2> 
        <table border="1"> 
          <xsl:for-each select="Send_Email/Error_Message"> 
            <tr> 
              <td><xsl:value-of select="."/></td> 
            </tr> 
          </xsl:for-each> 
        </table> 
      </body> 
    </html> 
  </xsl:template> 

</xsl:stylesheet> 
```

`/Send_Email_lookupID`匹配根元素，因为它以`/`- 开头，但在您的 XML 中，具有该名称的元素不是根元素。

如果您不想只匹配除了使用之外的`Error_Message`每个元素：`Send_Email``Send_Email_lookupID`

```
 <xsl:for-each select="Send_Email/*[local-name()!='Send_Email_lookupID']"> 
```

这意味着'`Send_Email`除了那些命名的元素之外的所有元素`Send_Email_lookupID`。

还要注意，`<xsl:value-of select="*"/>`输出包含在当前节点的所有子元素中的`<xsl:value-of select="."/>`文本 - 而输出包含在当前节点中的文本 - 这就是我们在这种情况下想要的。

# php - 从 db 拉出的级联下拉框

> ID：10113971
> 
> 赞同：3
> 
> 时间：2012-04-11T21:03:19.743
> 
> 标签：php, html, ajax

我正在尝试使用 php 和 ajax 从数据库填充两个下拉框。第一个下拉框只有一个选择，但是当您选择它时，它应该填充第二个下拉框，其中包含从数据库中提取的我学校的不同部门。在选择一个部门时，该部门的所有课程都应显示在第三个下拉框中。现在我只是试图让所有部门填充的下拉框，当你点击它时它现在不会填充任何东西。我认为在下拉框中写入部门名称的循环存在问题。这是我的代码

索引.php

```
<html>
    <head>
        <meta http-equiv="Content-Type" 
            content="text/html; charset=iso-8859-1">
        <script language="javascript" type="text/javascript">

            function getXMLHTTP() { //function to return the xml http object
                var xmlhttp=false;    
                try{
                    xmlhttp=new XMLHttpRequest();
                }
                catch(e)    {        
                    try{            
                        xmlhttp= new ActiveXObject("Microsoft.XMLHTTP");
                    }
                    catch(e){
                        try{
                            xmlhttp = new ActiveXObject("Msxml2.XMLHTTP");
                        }
                        catch(e1){
                            xmlhttp=false;
                        }
                    }
                }

                return xmlhttp;
            }

            function getDept() {        

                var strURL="findDept.php";
                var req = getXMLHTTP();

                if (req) {

                    req.onreadystatechange = function() {
                        if (req.readyState == 4) {
                            // only if "OK"
                            if (req.status == 200) {                        
                                document.
                                    getElementById("deptdiv").
                                        innerHTML=req.responseText;
                            } else {
                                alert("There was a problem " +
                                    "while using XMLHTTP:\n" + req.statusText);
                            }
                        }                
                    }            
                    req.open("GET", strURL, true);
                    req.send(null);
                }        
            }
            function getCourse(deptId) {        
            var strURL="findCourse.php?dept="+deptId;
            var req = getXMLHTTP();

            if (req) {
                req.onreadystatechange = function() {
                        if (req.readyState == 4) {
                            // only if "OK"
                            if (req.status == 200) {                        
                                document.
                                    getElementById('coursediv').
                                        innerHTML=req.responseText;
                            } else {
                                alert("There was a problem " +
                                    "while using XMLHTTP:\n" + req.statusText);
                            }
                        }                
                    }            
                    req.open("GET", strURL, true);
                    req.send(null);
                }
            } 
        </script>
    </head>
    <body bgcolor= 'red' >
        <p>
            <font size="8" face="arial" 
                color="black">WELCOME TO SCHEDULE BUILDER</font>
        </p>
        <form method="post" action="" name="form1">
            <table width="60%" border="0" cellspacing="0" cellpadding="0">
                <tr>
                    <td width = "150">Semester</td>
                    <td width="150">
                        <select name="semester onChange="getDept()">
                            <option value="">Select Semester</option>
                            <option value ="1">Spring 2012</option>
                        </select>
                    </td>
                </tr>
                <tr style="">
                    <td>Department</td>
                    <td >
                        <div id="deptdiv">
                            <select name="department">
                                <option>Select Department</option>
                            </select>
                        </div>
                    </td>
                </tr>
                <tr style="">
                    <td>Course</td>
                    <td >
                        <div id="coursediv">
                            <select name="course">
                                <option>Select Department First</option>
                            </select>
                        </div>
                    </td>
                </tr>
                <tr>
                <td>&nbsp;</td>
                <td>&nbsp;</td>
                </tr>
                <tr>
                <td>&nbsp;</td>
                <td>&nbsp;</td>
                </tr>
            </table>
        </form>
    </body>
</html> 
```

findDept.php

```
<?
    $link = mysql_connect("sql2.njit.edu", "sk442_proj", "jZ1MOA0X");
    if (!link) {
        die('Could not connect: ' . mysql_error());
    }
    mysql_select_db("sk442_proj");
    $query="SELECT abbrev FROM department";
    $result=mysql_query($query);
?>
<select name="department" onchange="getCourse(this.value)">
    <option>Select Department</option>
<? while($row=mysql_fetch_array($result)) { ?>
    <option value=$row['abbrev']><?=$row['abbrev']?></option>
<? } ?>
</select> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T23:23:05.130

这是我使用的动态下拉菜单，它可能会有所帮助：

主文件

```
include('pla2.php');
<script>
$(document).ready(function() {
    $('#wait_1').hide();
    $('#drop_1').change(function(){
      $('#wait_1').show();
      $('#result_1').hide();
      $.get("pla2.php", {
        func: "drop_1",
        drop_var: $('#drop_1').val()
      }, function(response){
        $('#result_1').fadeOut();
        setTimeout("finishAjax('result_1', '"+escape(response)+"')", 400);
      });
        return false;
    });
});

function finishAjax(id, response) {
  $('#wait_1').hide();
  $('#'+id).html(unescape(response));
  $('#'+id).fadeIn();
} 
</script>
<select name="drop_1" id="drop_1">

      <option value="" selected="selected" disabled="disabled">Select a Category</option>

      <?php getTierOne(); ?>

    </select> 

    <span id="wait_1" style="display: none;">
    <img alt="Please Wait" src="ajax-loader.gif"/>
    </span>
    <span id="result_1" style="display: none;"></span> 
    <span id="wait_2" style="display: none;">
    <img alt="Please Wait" src="ajax-loader.gif"/>
    </span>
    <span id="result_2" style="display: none;"></span> 
```

pla2.php

```
function getTierOne()
{
    $catresult = mysql_query("SELECT DISTINCT category FROM categories") 
    or die(mysql_error());

      while($tier = mysql_fetch_array( $catresult )) 

        {
           echo '<option value="'.$tier['category'].'">'.$tier['category'].'</option>';
        }

}

//**************************************
//     First selection results     //
//**************************************
if($_GET['func'] == "drop_1" && isset($_GET['func'])) { 
   drop_1($_GET['drop_var']); 
}

function drop_1($drop_var)
{  
    include_once('db.php');
    $result = mysql_query("SELECT DISTINCT level1 FROM categories WHERE category='$drop_var'") 
    or die(mysql_error());

    echo '<select name="drop_2" id="drop_2">
          <option value=" " disabled="disabled" selected="selected">Choose one</option>';

           while($drop_2 = mysql_fetch_array( $result )) 
            {
              echo '<option value="'.$drop_2['level1'].'">'.$drop_2['level1'].'</option>';
            }

    echo '</select>'; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T08:44:05.937

这就是我使用动态选择菜单的方式，我更新了第二个菜单所在的部门，类别是第一个菜单，然后是第二个菜单

```
 ajaxRequest.onreadystatechange = function(){
        if(ajaxRequest.readyState == 4){
            var ajaxDisplay = document.getElementById('brand');
            ajaxDisplay.innerHTML = ajaxRequest.responseText;
        }
    }
    var category = document.getElementById('category').value;
    var queryString = "&category=" + category;
    ajaxRequest.open("GET", "cat_to_brand_special.php?section=cat" + queryString, true);
    var ajaxDisplay = document.getElementById("brand");
    ajaxDisplay.innerHTML = "<p style=\"padding-left:8px; font-size:11px; color:#DD0000\"><img style=\"border: 0px solid\" src='ajax-loader-form.gif'/> Loading...</p>"
    ajaxRequest.send(null); 
```

html部分...

```
 <table><td>
       <div>
          <select id="category" name="category" onchange='ajaxFunction("special_cat")'>  <option value="000">--- Select Category ---</option><?php echo $menu_list?></select>
       </div>
   </td>
   <td>
       <div id="brand">
           <select id='brands' name="brands"><option value="000">--- Select Brand ---</option><?php echo $menu_list_2; ?></select>
       </div>
   </td><table> 
```

将输出的 php 部分

```
 $cat=$_GET['category'];
    $display="<select name=\"brand\">";
    $result=mysql_query("select name from brands where category = '$cat'")
    while($db_fields=mysql_fetch_assoc($result){
        $name=$db_fields['name'];
        $display .= "<option>$name</option>";
    }
    $display .="</select>";
    echo $display; 
```

只是一个你可以使用的例子......

# ios - 从 RemoteIO 录制到 AAC：正在写入数据但文件无法播放

> ID：10113977
> 
> 赞同：7
> 
> 时间：2012-04-11T21:03:48.493
> 
> 标签：ios, ios5, core-audio

我一直在尝试在 iPad 2 上的 iOS 5 中的 renderCallback 中从 RemoteIO 单元直接录制到 AAC。我看到相互矛盾的信息说这是不可能的，而且它是可能的（在[此处](http://atastypixel.com/blog/easy-aac-compressed-audio-conversion-on-ios/)的评论中）。我想要这样做的原因是因为录制到 PCM 需要如此多的磁盘空间来录制任何长度的 - 即使它后来被转换为 AAC。

不过我已经准备好放弃了。我已经浏览了 Google、SO、Core Audio 书籍和 Apple Core-Audio 邮件列表和论坛，并且已经达到了没有出现任何错误的地步——并且正在将*某些*内容录制到磁盘上，但生成的文件无法播放。模拟器和设备上都是这种情况。

所以......如果有人有这方面的经验，我真的很感激朝着正确的方向轻推。设置是 RemoteIO 正在播放 AUSamplers 的输出并且工作正常。

这是我在下面的代码中所做的

*   指定`AudioStreamBasicDescription`remoteIO 单元的格式`kAudioFormatLinearPCM`

*   `ExtAudioFileRef` 通过从 RemoteIO 单元获取指定客户端格式来创建并指定目标格式

*   为 RemoteID 单元指定 renderCallback

*   在renderCallback中， `kAudioUnitRenderAction_PostRender`阶段写入数据

正如我所说，我没有收到任何错误，并且生成的音频文件大小显示正在写入某些内容，但该文件无法播放。也许我的格式搞砸了？

无论如何，这是我在瓶中和/或“Be Here Dragons”旗帜中向任何冒着 Core-Audio 黑暗水域的人传达的信息。

* * *

//尝试播放文件时收到的不愉快的消息：

![在此处输入图像描述](../Images/d1c330e0c85c5a32bedb6bd61d12c4cb.png)

// remoteIO 设置的一部分

```
 // Enable IO for recording

UInt32 flag = 1;
result = AudioUnitSetProperty(ioUnit, 
                              kAudioOutputUnitProperty_EnableIO, 
                              kAudioUnitScope_Input, 
                              kInputBus, // == 1
                              &flag, 
                              sizeof(flag));
if (noErr != result) {[self printErrorMessage: @"Enable IO for recording" withStatus: result]; return;}

// Describe format - - - - - - - - - -
size_t bytesPerSample = sizeof (AudioUnitSampleType);
AudioStreamBasicDescription audioFormat;
memset(&audioFormat, 0, sizeof(audioFormat));
audioFormat.mSampleRate   = 44100.00;
audioFormat.mFormatID     = kAudioFormatLinearPCM;
audioFormat.mFormatFlags    = kAudioFormatFlagIsSignedInteger | kAudioFormatFlagIsPacked;
audioFormat.mFramesPerPacket = 1;
audioFormat.mChannelsPerFrame = 1;
audioFormat.mBitsPerChannel   = 16;
audioFormat.mBytesPerPacket   = 2;
audioFormat.mBytesPerFrame    = 2;

result = AudioUnitSetProperty(ioUnit, 
                              kAudioUnitProperty_StreamFormat, 
                              kAudioUnitScope_Output, 
                              kInputBus, // == 1
                              &audioFormat, 
                              sizeof(audioFormat));

result = AudioUnitSetProperty(ioUnit, 
                              kAudioUnitProperty_StreamFormat, 
                              kAudioUnitScope_Input, 
                              kOutputBus, // == 0
                              &audioFormat, 
                              sizeof(audioFormat)); 
```

// 设置文件和渲染回调的函数

```
 - (void)startRecordingAAC
{

OSStatus result;

NSArray  *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
NSString *documentsDirectory = [paths objectAtIndex:0];
NSString *recordFile = [documentsDirectory stringByAppendingPathComponent: @"audio.m4a"];

CFURLRef destinationURL = CFURLCreateWithFileSystemPath(kCFAllocatorDefault, 
                                                        (__bridge   CFStringRef)recordFile, 
                                                        kCFURLPOSIXPathStyle, 
                                                        false);

AudioStreamBasicDescription destinationFormat;
memset(&destinationFormat, 0, sizeof(destinationFormat));
destinationFormat.mChannelsPerFrame = 2;
destinationFormat.mFormatID = kAudioFormatMPEG4AAC;
UInt32 size = sizeof(destinationFormat);
result = AudioFormatGetProperty(kAudioFormatProperty_FormatInfo, 0, NULL, &size, &destinationFormat);        
if(result) printf("AudioFormatGetProperty %ld \n", result);

result = ExtAudioFileCreateWithURL(destinationURL, 
                                   kAudioFileM4AType, 
                                   &destinationFormat, 
                                   NULL, 
                                   kAudioFileFlags_EraseFile, 
                                   &extAudioFileRef);
if(result) printf("ExtAudioFileCreateWithURL %ld \n", result);

AudioStreamBasicDescription clientFormat;
memset(&clientFormat, 0, sizeof(clientFormat));

result = AudioUnitGetProperty(ioUnit, kAudioUnitProperty_StreamFormat, kAudioUnitScope_Output, 0, & clientFormat, &size);
 if(result) printf("AudioUnitGetProperty %ld \n", result);

result = ExtAudioFileSetProperty(extAudioFileRef,kExtAudioFileProperty_ClientDataFormat,sizeof(clientFormat),&clientFormat);
if(result) printf("ExtAudioFileSetProperty %ld \n", result);

result =  ExtAudioFileWriteAsync(extAudioFileRef, 0, NULL);
if (result) {[self printErrorMessage: @"ExtAudioFileWriteAsync error" withStatus: result];}

result = AudioUnitAddRenderNotify(ioUnit, renderCallback, (__bridge void*)self);
if (result) {[self printErrorMessage: @"AudioUnitAddRenderNotify" withStatus: result];}
} 
```

// 最后，渲染回调

```
static OSStatus renderCallback (void *                       inRefCon,
                            AudioUnitRenderActionFlags * ioActionFlags,
                            const AudioTimeStamp *       inTimeStamp,
                            UInt32                       inBusNumber,
                            UInt32                       inNumberFrames,
                            AudioBufferList *            ioData) 
{

OSStatus result;
if (*ioActionFlags == kAudioUnitRenderAction_PostRender){
    MusicPlayerController* THIS = (__bridge MusicPlayerController *)inRefCon;

       result =  ExtAudioFileWriteAsync(THIS->extAudioFileRef, inNumberFrames, ioData);
       if(result) printf("ExtAudioFileWriteAsync %ld \n", result); 

}
return noErr; 
} 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-04-12T18:01:53.943

所以我终于解决了这个问题！呃，真是个信息寻宝游戏。

无论如何，这是我错过的 ExtAudioFile 文档中的一点（请参阅粗体文本）。我没有设置这个属性。数据正在写入我的 .m4a 文件，但在播放时无法读取。所以总结一下：我有一堆 AUSamplers -> AUMixer -> RemoteIO。RemoteIO 实例上的渲染回调以压缩的 m4a 格式将数据写入磁盘。因此可以动态生成压缩音频（iOS 5/iPad 2）

看起来很健壮 - 我在 rendercallback 中有一些 printf 语句并且写入工作正常。

耶！

> ExtAudioFileProperty_CodecManufacturer 扩展音频文件对象要使用的编解码器的制造商。值是读/写 UInt32。**您必须在设置 kExtAudioFileProperty_ClientDataFormat （第 20 页）属性之前指定此属性，这反过来会触发编解码器的创建。**通过指定 kAppleHardwareAudioCodecManufacturer 或 kAppleSoftwareAudioCodecManufacturer，在 iOS 中使用此属性在硬件或软件编码器之间进行选择。适用于 Mac OS X v10.7 及更高版本。在 ExtendedAudioFile.h 中声明。

```
// specify codec
UInt32 codec = kAppleHardwareAudioCodecManufacturer;
size = sizeof(codec);
result = ExtAudioFileSetProperty(extAudioFileRef, 
                                 kExtAudioFileProperty_CodecManufacturer, 
                                 size, 
                                 &codec);

if(result) printf("ExtAudioFileSetProperty %ld \n", result); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-12T06:25:23.340

您是否在 mpg 4 音频文件的开头编写了所需的魔法 cookie？

您还需要至少在音频单元渲染回调之外写入第一个文件。

添加：

您最后是否正确刷新并关闭了音频文件？（在 AU 回调之外）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-03T14:00:45.837

看起来这不仅仅是为输出音频文件 ID 指定编解码器。

根据此线程：[ExtAudioFileWrite to m4a/aac 在双核设备（ipad 2、iphone 4s）上失败，](https://stackoverflow.com/questions/8719865/extaudiofilewrite-to-m4a-aac-failing-on-dual-core-devices-ipad-2-iphone-4s)例如某些 iPhone 型号（4S），不能很好地与硬件解码器配合使用。

根据我使用 4S 的经验，尝试使用硬件编解码器对 AAC 文件进行编码 a) 有时可以工作，b) 失败并出现错误 -66567 (kExtAudioFileError_MaxPacketSizeUnknown) 或 c) 写出一些样本然后挂起，没有可追溯的错误.

软件编解码器在 iPhone 4S 上运行良好，但性能较慢。

编辑：有些人声称硬件编解码器不喜欢 44.1kHz 采样率。我还没有证实这一点。

# python - 自 1.6.3 以来，使用 nosgae 的 python 测试运行速度非常慢

> ID：10113980
> 
> 赞同：0
> 
> 时间：2012-04-11T21:04:08.150
> 
> 标签：python, unit-testing, google-app-engine, nosetests

正如这个谷歌小组帖子中所问的：

[https://groups.google.com/forum/?fromgroups&hl=en#!topic/google-appengine-python/fQUnsnt-wJ4](https://groups.google.com/forum/?fromgroups&hl=en#!topic/google-appengine-python/fQUnsnt-wJ4)

我不确定 yaml 解析是否是根本原因，但我确信我的测试套件现在需要数倍的时间才能运行。还有其他人遇到这个吗？任何已知的解决方法？

为了仔细检查，我恢复到 sdk 版本 1.6.2，例如，一个测试套件的运行速度提高了 4 倍（约 10 秒对 40 秒）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T16:01:28.167

听起来像[http://code.google.com/p/googleappengine/issues/detail?id=7169](http://code.google.com/p/googleappengine/issues/detail?id=7169)。

# ruby-on-rails - 重构 Form_for 创建多态关联中注释的方法

> ID：10113981
> 
> 赞同：4
> 
> 时间：2012-04-11T21:04:17.210
> 
> 标签：ruby-on-rails, ruby-on-rails-3, polymorphic-associations

我正在处理我的第一个多态关联关系，并且在重构我的 form_for 创建评论时遇到了麻烦。

我尝试通过多态协会 RailsCasts [http://railscasts.com/episodes/154-polymorphic-association?view=asciicast](http://railscasts.com/episodes/154-polymorphic-association?view=asciicast)，但它似乎过时了。

我有两个问题：

1.  如何重写我的 comment_form 部分，以便它适用于任何可评论的内容？我现在拥有它的方式，它只适用于 traveldeals，因为`(:commentable_id => @traveldeal.id)`.

2.  当我创建评论时，commentable_type 为空。什么是commentable_type，我需要在表单中传递它吗？

谢谢！

用户.rb

```
class User < ActiveRecord::Base
  has_many :comments, :dependent => :destroy
end 
```

traveldeal.rb

```
class Traveldeal < ActiveRecord::Base
  has_many :comments, :as => :commentable, :dependent => :destroy
end 
```

评论.rb

```
class Comment < ActiveRecord::Base
  belongs_to :user
  belongs_to :commentable, :polymorphic => true

  validates :user_id, :presence => true
  validates :commentable_id, :presence => true
  validates :content, :presence => true
end 
```

traveldeal_show.html.erb

```
<%= render 'shared/comment_form'  %> 
```

_comment_form.html.erb

```
<%= form_for current_user.comments.build(:commentable_id => @traveldeal.id) do |f| %>
  <%= render 'shared/error_messages', :object => f.object %>

<div>
  <%= f.text_area :content %>
</div>

<%= f.hidden_field :user_id %>
<%= f.hidden_field :commentable_id %>

<div>
  <%= f.submit "Add Comment" %>
</div>
<% end %> 
```

评论控制器.rb

```
class CommentsController < ApplicationController
  before_filter :authenticate, :only => [:create, :destroy]

  def create
    @comment = Comment.new(params[:comment])
    @comment.save
    redirect_to root_path
  end

end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-12T02:23:06.790

Railscast 中唯一注明日期的部分是路线。

要回答您的第一个问题：像在 Railscast 中一样创建您的表单：

```
<%= form_for [@commentable, Comment.new] do |f| %>
  <p>
    <%= f.label :content %><br />
    <%= f.text_area :content %>
  </p>
  <p><%= f.submit "Submit" %></p>
<% end %> 
```

如果您这样做，它将`commentable_type`自动设置。您需要类型，以便知道评论属于哪个模型。请注意，您必须`@commentable`在使用评论表单的方法中进行设置。

例如

```
class TraveldealsController < ApplicationController
  def show
    @traveldeal = @commentable = Traveldeal.find(params[:id])
  end
end 
```

# jsp - 无缓存媒体的 Tomcat 配置

> ID：10113982
> 
> 赞同：0
> 
> 时间：2012-04-11T21:04:39.003
> 
> 标签：jsp, tomcat, no-cache

我基本上需要一个与我发布 的[这个](https://stackoverflow.com/questions/10078168/htaccess-mod-headers-for-no-caching/)问题相同的信息的 Tomcat 解决方案。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T21:27:06.883

您可以编写过滤器或服务器端阀门来添加这些标头，甚至包装响应并在任何情况下添加这些标头。

# android - 硬件组件的移动设备管理？

> ID：10113983
> 
> 赞同：2
> 
> 时间：2012-04-11T21:04:40.890
> 
> 标签：android, camera, microphone, mdm

一直在研究平板电脑的移动设备管理。到目前为止，它们中的许多都提供了我们正在寻找的东西（允许的应用程序、IT 策略执行等）。但是难以管理摄像头和麦克风。找不到在一天中的某些时间和位置禁用它们的功能。

我查看了adroid API，发现与硬件的接口没有问题（通过有多少应用程序访问该信息来证明）。

但是，是否可以创建一个禁用（即没有应用程序可以访问、使用或记录）相机和麦克风的应用程序？

在我的实验中，似乎只有一个应用程序可以在任何给定时间使用相机/麦克风。所以我只是想如果让我的自定义应用程序使用它们并且在满足 IT 策略之前不发布（基于接近度、一天中的时间等）将是一种相对简单的方法。

还是有更好的方法？我知道这是一个开放式问题，但我认为我已经用尽了 OOB MDM 方面的东西，需要转向软件开发。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T06:14:45.823

您可以查看的是 Google 针对相机锁定的官方 Android 设备策略强制执行。但是，此解决方案要求您使用 Google Apps 的付费版本。

***请在此处的设备设置***中找到更多信息：http : [//support.google.com/a/bin/answer.py ?hl=en&answer=1408902](http://support.google.com/a/bin/answer.py?hl=en&answer=1408902)

它还允许应用程序的审核，因此您可以设置规则白名单/黑名单某些应用程序。

**对于自定义解决方案，您可以通过使用策略部分**下的 API 禁用相机来执行相同的操作：http : [//developer.android.com/guide/topics/admin/device-admin.html](http://developer.android.com/guide/topics/admin/device-admin.html)

麦克风没有相同的功能。永久使用麦克风来阻止其他来源的想法虽然可能会阻止它，但总体上是糟糕的设计，并且可能（未经测试）对电池寿命和渲染功能很不利。但理论上你应该能够做到这一点，但我建议彻底调查副作用。

# joomla - joomla2.5.4新模板安装

> ID：10113984
> 
> 赞同：3
> 
> 时间：2012-04-11T21:04:43.813
> 
> 标签：joomla, joomla-template

通过在 joomla 2.5.4 中发现`"Fatal error: Call to a member function setDebug() on a non-object in Z:\home\xxx\www\libraries\joomla\installer\adapters\template.php on line 543"`通过安装新模板找到。

请帮忙！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-11T21:12:03.733

显然，这是已知的错误。

来源： http://joomlacode.org/gf/project/joomla/tracker/?action=TrackerItemEdit&tracker_id=8103&tracker_item_id= [28345](http://joomlacode.org/gf/project/joomla/tracker/?action=TrackerItemEdit&tracker_id=8103&tracker_item_id=28345)

[http://forum.joomla.org/viewtopic.php?f=619&t=708286#p2784057](http://forum.joomla.org/viewtopic.php?f=619&t=708286#p2784057)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-12T17:13:29.967

出现此问题的原因是`discover_install()`library\joomla\installer\adapters\template.php 中的函数中缺少函数调用： `$lang = JFactory::getLanguage();`

将此行添加到此文件中，东西将正常工作；）

干杯/Dzenan

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-16T09:33:38.660

我正在使用 Joomla 2.5.4，并根据我添加的 Stu 提到的错误跟踪器。

```
$lang = JFactory::getLanguage(); 
```

但我将它添加到从文件第 503 行开始的函数中

库\joomla\安装程序\适配器\template.php

```
public function discover_install()
    {
        // Templates are one of the easiest
        // If its not in the extensions table we just add it
        $lang = JFactory::getLanguage();
        $client = JApplicationHelper::getClientInfo($this->parent->extension->client_id); 
```

这就像一个魅力。谢谢 Stu & Dzenan

错误跟踪链接 [http://joomlacode.org/gf/project/joomla/tracker/?action=TrackerItemEdit&tracker_id=8103&tracker_item_id=28345](http://joomlacode.org/gf/project/joomla/tracker/?action=TrackerItemEdit&tracker_id=8103&tracker_item_id=28345)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-24T13:37:34.763

Dzenan 的解决方案对我有用。我加了...

```
$lang = JFactory::getLanguage(); 
```

...到 library\joomla\installer\adapters\template.php 中的第 480 行以及在发现/安装过程中安装的模板。

# wpf - 更改动态绑定列表中单个元素的文本颜色

> ID：10113991
> 
> 赞同：0
> 
> 时间：2012-04-11T21:05:26.350
> 
> 标签：wpf, windows-phone-7, data-binding

目前正在开发一个小型 Windows Phone (7.5) 应用程序，其中一个页面包含一个绑定到元素列表的 ListBox。

```
<ListBox x:Name="MyListBox" 
    ItemsSource="{Binding Path=Listing}" 
    ItemTemplate="{StaticResource MyItemTemplate}" /> 
```

DataTemplate 如下所示，其中“名称”和“描述”是“实体”类的属性：

```
<DataTemplate x:Key="WordTemplate">
    <ListBoxItem Tap="WordTapped">                              
        <StackPanel Orientation="Vertical">
            <TextBlock Width="Auto" 
                     Text="{Binding Name}" 
                     FontSize="{StaticResource PhoneFontSizeLarge}"  
                     VerticalAlignment="Top" 
                     TextWrapping="Wrap"
                     Margin="12, 0, 12, 0" />
            <TextBlock Width="Auto" 
                     Text="{Binding Description}" 
                     Style="{StaticResource PhoneTextSmallStyle}" 
                     VerticalAlignment="Top"
                     TextWrapping="Wrap"                                         
                     Margin="12, 0, 12, 12" />              
        </StackPanel>
    </ListBoxItem>
</DataTemplate> 
```

是否有可能 - 根据名称/描述的实际值 - 更改每个 TextBlock 的字体颜色？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T21:10:21.247

是的，使用 a`ValueConverter`将您的名称和描述转换为画笔：

```
 <phone:PhoneApplicationPage.Resources>
        <Converters:TextToBrushConverter x:Key="yourConverter"/>
    </phone:PhoneApplicationPage.Resources>

    ...
    <TextBlock Width="Auto" 
          Text="{Binding Name}" 
          ...
          Foreground={Binding Name, Converter={StaticResource yourConverter}} /> 
```

转换器：

```
public class TextToBrushConverter : IValueConverter
{
    public object Convert(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
    {
        if ((string)value == "XXX")
        {
            return new SolidColorBrush(Colors.Red);
        }

        return new SolidColorBrush(Colors.Green);
    }

    public object ConvertBack(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
    {
        throw new NotImplementedException();
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T21:09:18.617

如果您在类中创建一个属性，该属性是基于您的名称/描述标签生成的 Brush，并将其绑定到文本块的 Foreground 属性，那应该可以...

或者，如果您想稍微精明一点，而不是向您的 Entity 类添加属性，您可以使用 ValueConverter (http://msdn.microsoft.com/en-us/library/system.windows.data.ivalueconverter。 aspx），让我知道你是否想要一些代码来做到这一点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-11T21:11:24.683

是的，您可以创建自己的绑定转换器并将其用于绑定到前台。

# javascript - jQuery 附加在 IE 上不起作用（始终如一）？

> ID：10113993
> 
> 赞同：2
> 
> 时间：2012-04-11T21:05:31.063
> 
> 标签：javascript, jquery-ui, calendar, append, twitter-bootstrap

我已经构建了一个在 IE 上不起作用的精简示例：http: [//so.demuyt.net/case1/](http://so.demuyt.net/case1/)

( IE8\. jQuery 1.7.1 )

在 IE 中单击一个日期没有任何作用，单击第二个日期将在第一个和第二个选定日期旁边放置一个“绿色药丸”。在 Chrome 中执行此操作将在第一次单击时放置 1 个药丸，在第二次单击时放置 1 个药丸。

我像这样添加一个“药丸”：

```
$("#canvas").append('<span class="label label-success Workcounter ' + date + ' ' + calendarName + '">1</span>'); 
```

我这样定位“药丸”：

```
$(".Workcounter." + date + '.' + calendarName).position( { of : $(".Work-date-highlight."+calendarName+"."+date) , at : "left top" , offset : "3 3" } ); 
```

js 控制台没有错误，我注意到在调试模式下，我会在 Chrome 中看到添加的药丸，而我不会在 IE 中看到它添加（即使我单击第二个日期）。

非常感谢任何帮助或指针，以使 IE 表现得像 Chrome 和 FireFox。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T08:51:38.257

您用来定位元素的行似乎对我造成了问题，请尝试替换：

```
$(".Workcounter." + date + '.' + calendarName).position( { of : $(".Work-date-highlight."+calendarName+"."+date) , at : "left top" , offset : "3 3" } ); 
```

和：

```
var datePos = $(".Work-date-highlight."+calendarName+"."+date).position();

$(".Workcounter." + date + '.' + calendarName).css({
    left: datePos.left - 3,
    top: datePos.top - 3,
    position: 'absolute'
}); 
```

# xcode - Mac OS LION 10.7 应用内购买

> ID：10113994
> 
> 赞同：1
> 
> 时间：2012-04-11T21:05:37.503
> 
> 标签：xcode, in-app-purchase, osx-lion, storekit

我正在测试 Mac OS Lion 上可用的应用内购买新功能，我被困在收据验证部分，我的代码在这部分总是失败，好像我没有连接到沙箱或应用程序收据从未发送给我收据为**“exit(173)”；**应该工作。

这些是我的步骤：

1-为应用程序注册一个明确的应用程序 ID。（[会员中心][1]）。

2-在 iTunes 上添加一个应用程序，其应用程序 ID 为：“准备上传”。

3-添加应用购买产品产品。

5-创建一个测试用户 6-创建、下载和安装一个 Mac 签名证书，该证书使用为应用内购买启用的 App ID7-开发配置配置文件与此证书。（[会员中心][1]）。

7-将供应配置文件添加到 Xcode 观察者。

8-在 Xcode 中 My Target 的 Info 窗格的 Bundle Identifier 字段中输入 App ID 的 Bundle Identifier 部分。

9-用我的证书签署代码。

**注意：**我在 finder 上测试应用程序，而不是 Xcode 调试器。

这是应用程序代码：

标题：

```
#import <Cocoa/Cocoa.h>
#import <StoreKit/StoreKit.h>
@interface AppDelegate : NSObject <NSApplicationDelegate,SKProductsRequestDelegate,SKPaymentTransactionObserver>
{
    NSWindow *window;
    IBOutlet NSTextField *label;
    IBOutlet NSButton *checkox;
}

@property (assign) IBOutlet NSWindow *window;
-(void)request:(SKRequest *)request didFailWithError:(NSError *)error;
- (void)applicationDidFinishLaunching:(NSNotification *)notification;
-(void)requestUpgradeProductsData;
-(void)productsRequest:(SKProductsRequest *)request didReceiveResponse:(SKProductsResponse *)response;
-(IBAction)checkBoxState:(id)sender;
@end 
```

代码：

```
 #import "AppDelegate.h"

 @implementation AppDelegate

 @synthesize window = _window;

-(void)applicationWillFinishLaunching:(NSNotification *)notification
{
    NSLog(@"applicationDidFinishLaunching");
    NSURL *receiptUrl = [[NSBundle mainBundle] appStoreReceiptURL];
    if (![[NSFileManager defaultManager] fileExistsAtPath:[receiptURL path]])
    {
        NSLog(@"no receipt - exit the app with code 173");
        exit(173);
    }
}

-(void)requestUpgradeProductsData
{
    if([SKPaymentQueue canMakePayments])
    {
        SKProductsRequest *request =[[SKProductsRequest alloc]initWithProductIdentifiers:[NSSet setWithObjects:@"com.comany.MyApp.DLC1",@"com.comany.MyApp.DLC2",nil]];
        request.delegate = self;
        [request start];
    }
}

-(void)productsRequest:(SKProductsRequest *)request didReceiveResponse:(SKProductsResponse *)response
{
    int count = response.products.count;
    if(count!=0)
    {
        NSLog(@"COUNT IS NOT ZERO");
    }
    else 
    {
        [label setStringValue:@"NO PRODUCT"];
    }
}

-(IBAction)checkBoxState:(id)sender
{
    [self requestUpgradeProductsData]; 
}
-(void) request:(SKRequest *)request didFailWithError:(NSError *)error
{
    NSLog(error);
}
@end 
```

- 我的代码总是在**“exit(173);”处退出** 如果我删除此检查，我会将我的所有产品都视为无效标识符。-当我用 3d 方证书应用商店签署我的代码时，要求提供登录信息，但是当我用开发证书应用商店签署我的代码时，什么都不做。

谢谢。

[https://developer.apple.com/membercenter/index.action](https://developer.apple.com/membercenter/index.action)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T06:11:55.080

在 Finder 中启动应用程序，这并不意味着您出于某种原因在 xcode 之外启动。

1.  从菜单中选择产品 -> 存档
2.  选择您的应用并选择分发
3.  选择导出为应用程序
4.  因此，现在当您启动导出的应用程序时，该应用程序将在您登录后强制退出并询问您的测试用户帐户。该应用程序将自动为您重新启动。

现在您有一个收据并且能够测试购买。